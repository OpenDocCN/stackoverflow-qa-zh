# StackOverflow 问答 000659000-000659999

# c++ - RegisterDeviceNotification 返回 NULL 但仍收到通知

> ID：659000
> 
> 赞同：1
> 
> 时间：2009-03-18T16:23:41.557
> 
> 标签：c++, winapi, usb, drivers

我正在使用 RegisterDeviceNotification 来监视 USB 设备的更改，使用 WM_DEVICECHANGE 事件。但是，当我调用 RegisterDeviceNotification() 时，它会为通知句柄返回 NULL，这应该表明它失败了。但是 GetLastError() 返回 ERROR_SUCCESS 并且通知实际上会通过。
当我稍后需要取消注册通知然后重新注册时，这会造成真正的麻烦。由于它返回的句柄为 NULL，我实际上无法重新注册。如果我尝试，RegisterDeviceNotification() 就会挂起。

我的代码如下：

```
DEV_BROADCAST_HANDLE   devBrHdr;

::ZeroMemory( &devBrHdr,sizeof( DEV_BROADCAST_HANDLE ) );
devBrHdr.dbch_size = sizeof( DEV_BROADCAST_HANDLE );
devBrHdr.dbch_devicetype = DBT_DEVTYP_HANDLE;
devBrHdr.dbch_handle = m_hDriver;

m_hDevNotify = ::RegisterDeviceNotification( hWnd,&devBrHdr,DEVICE_NOTIFY_WINDOW_HANDLE ); 
```

m_hDriver 是我之前打开的驱动程序的句柄，在连接到设备（USB 条形码扫描仪）时。

有什么想法我在这里做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T18:40:01.307

1.  确保您没有在 和 之间进行另一个 Win32 API`RegisterDeviceNotification`调用`GetLastError`。

2.  检查 的值`devBrHdr.dbch_hdevnotify`。它应该包含由返回的相同句柄`RegisterDeviceNotification`。

3.  值是`m_hDriver`从调用中获得的`CreateFile`吗？

# java - 确保 JButton 可以适合给定长度的字符串

> ID：659003
> 
> 赞同：4
> 
> 时间：2009-03-18T16:24:09.170
> 
> 标签：java, swing

假设我有一个 JButton，并且我希望它足够大以容纳 8 个“M”字符的字符串，而不管实际分配给它的字符串和字体大小，而不使用省略号。

JButton 必须正好有这个大小，不多也不少。使用的布局管理器是 GridBagLayout。

我尝试覆盖 getPreferredSize() 方法并使用字符串和系统的当前字体执行计算。计算给了我一些合理的价值，但是，我不知道如何设置首选大小，以便同时考虑边界。

我试图获取组件的插图，但它们都是 0。

这是我的方法的代码：

```
public void getPreferredSize() {
        Dimension d = super.getPreferredSize();

        // Geometry width indicates how many characters must fit
        char[] pad = new char[propGeometryWidth];
        Arrays.fill(pad, 'M');
        String tmpTemplateString = new String(pad);

        FontMetrics tmpMetrics = getFontMetrics(getFont());
        Rectangle2D tmpR2D = tmpMetrics.getStringBounds(tmpTemplateString, getGraphics());

        int tmpWidth = (int)tmpR2D.getWidth();
        int tmpHeight = (int)(tmpR2D.getHeight() * propGeometryHeight + tmpR2D.getHeight());

        // We need to take into consideration borders and padding!
        Insets insets = getInsets();

        Dimension tmpSize = new Dimension(tmpWidth + insets.left + insets.right, tmpHeight + insets.top + insets.bottom);
        return tmpSize;
} 
```

我觉得这可能与我的组件尚未实现有关，但我完全不确定如何解决这个问题。我是否从错误的角度来处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T16:51:02.193

我认为您实际上可能已经做对了。来自[Javadoc 的`getInsets()`](http://java.sun.com/javase/6/docs/api/javax/swing/JComponent.html#getInsets())：

> 如果此组件上设置了边框，则返回边框的插图；否则调用`super.getInsets`.

`JButton`为我全新创建的插图显示了`java.awt.Insets[top=5,left=17,bottom=5,right=17]`具有默认外观和`java.awt.Insets[top=4,left=16,bottom=4,right=16]`Windows 外观的插图。您是否正在使用自定义外观和感觉？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T17:16:44.877

我找到了我的问题的原因。问题是我有一个面板，里面有一个 JButton，我覆盖了面板上的方法（有一个相对复杂的类层次结构）。然后，当然，面板的插图都设置为 0。在获得按钮的插图后，正如 Mmyers 先生所说，一切都很好。

# php - 使用 Zend_Filter_Input，是先处理过滤器还是验证器？

> ID：659005
> 
> 赞同：1
> 
> 时间：2009-03-18T16:24:39.793
> 
> 标签：php, zend-framework, input, filter, validation

使用 Zend_Filter_Input 时，是先处理过滤器还是验证器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-18T16:42:58.203

来自 Zend\Filter\Input.php：

```
public function isValid($fieldName = null)
{
    $this->_process();
    (...)
}

protected function _process()
{
    if ($this->_processed === false) {
        $this->_filter();
        $this->_validate();
        $this->_processed = true;
    }
} 
```

# javascript - Jquery 鼠标悬停淡入/淡出（最佳实践）

> ID：659006
> 
> 赞同：8
> 
> 时间：2009-03-18T16:24:55.470
> 
> 标签：javascript, jquery

我有工作 Jquery 代码来淡入/淡出问题下方 div 中的描述性文本。问题？解决方案不是很优雅。这是我所拥有的：

```
$("#home").mouseover(function() {
    $("#homeText").fadeIn("slow");
});
$("#homeText").mouseout(function() {
    $("#homeText").fadeOut();
}); 
```

我知道有更好的方法可以做到这一点，我只是不确定它是什么。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-18T16:27:31.937

您可以使用悬停，第一个功能将作用于“悬停”，第二个功能将作用于“悬停”

文档位于此处：[http ://docs.jquery.com/Events/hover](http://docs.jquery.com/Events/hover)

```
$("#home").hover(function(){
    $("#homeText").fadeIn("slow");
},
function(){
    $("#homeText").fadeOut();
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-07T21:06:42.380

3条线怎么样？

```
<script>

    $(function () {

        $('#home').hover(function() {
           $('#homeText').fadeToggle("slow");
        });

    });

    </script> 
```

够优雅吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-16T18:15:07.930

```
$(function () {
    $('#home').hover(function() {
       $('#homeText').fadeIn("slow");
    });
    $('#home').mouseout(function() {
       $('#homeText').fadeOut("slow");
    });
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-18T19:07:09.620

乔恩，好建议！我用作一个更完整的解决方案的起点。仅使用基本悬停来执行此操作仍然会给我留下单个菜单项的悬停调用..很多冗余代码。所以使用你的建议，我想出了这个：

```
$('.topMenu').hover(function()
        {
        $('#_'+this.id).fadeIn("slow");
        },
        function ()
            {
        $('#_'+this.id).fadeOut();      
            });
}); 
```

所有菜单项都被赋予了 topMenu 类和 ID。对应要显示的 div 和菜单项的 id 相同，只是前缀为 _ 示例：...。

关于我们的东西！

...

谢谢！

# css - XXXX 不是“yyyy-color”属性的有效值

> ID：659012
> 
> 赞同：3
> 
> 时间：2009-03-18T16:25:44.407
> 
> 标签：css, visual-studio, visual-studio-2008

Visual Studio 可以帮助您确保 html/xhtml 有效且格式正确。这很好，除非您完全清楚自己在做什么以及为什么要打破这些规则。我真的很想“关闭”验证消息，这些消息告诉我 css 3 命名颜色对于它认为我要定位的 css 版本无效。

我如何让 VS 冷静下来，而不是警告我这些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T16:29:08.673

尝试选项 > 工具 > 文本编辑器 > CSS > CSS 特定。

您可以取消选中以下一项或多项：

*   检测错误
*   检测未知属性
*   检测无效值

# c# - 使用凭证从远程、不受信任的域访问共享文件 (UNC)

> ID：659013
> 
> 赞同：158
> 
> 时间：2009-03-18T16:25:44.767
> 
> 标签：c#, windows, unc, file-sharing

我们遇到了一个需要解决的有趣情况，而我的搜索结果为零。因此，我向 SO 社区寻求帮助。

问题是这样的：我们需要通过远程文件共享/UNC 以编程方式访问不在我们域中且不在受信任的外部域中的共享文件。自然，我们需要向远程机器提供凭据。

通常，可以通过以下两种方式之一解决此问题：

1.  将文件共享映射为驱动器并在那时提供凭据。这通常使用`NET USE`命令或重复的 Win32 函数来完成`NET USE`。
2.  使用 UNC 路径访问文件，就像远程计算机在域上一样，并确保在远程计算机上以本地用户身份复制运行程序的帐户（包括密码）。基本上利用了当用户尝试访问共享文件时 Windows 将自动提供当前用户的凭据这一事实。
3.  不要使用远程文件共享。使用 FTP（或其他方式）传输文件，在本地处理它，然后将其传输回来。

由于各种原因，我们的安全/网络架构师拒绝了前两种方法。第二种方法显然是一个安全漏洞；如果远程计算机受到威胁，则本地计算机现在处于危险之中。第一种方法不能令人满意，因为新安装的驱动器是本地计算机上的其他程序在程序访问文件期间可用的共享资源。尽管这很可能使这个暂时性的，但在他们看来这仍然是一个漏洞。

他们对第三个选项持开放态度，但远程网络管理员坚持使用 SFTP 而不是 FTPS，而 FtpWebRequest 仅支持 FTPS。SFTP**是**对防火墙更友好的选项，我可以使用几个库来实现这种方法，但如果可以的话，我更愿意减少我的依赖关系。

我在 MSDN 中搜索了使用远程文件共享的托管或 win32 方法，但我没有找到任何有用的方法。

所以我问：还有其他方法吗？我是否错过了一个超级秘密的 win32 功能，它可以满足我的需求？还是我必须追求选项 3 的一些变体？

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2009-03-26T00:10:16.847

解决问题的方法是使用名为[WNetUseConnection](http://msdn.microsoft.com/en-us/library/aa385482(VS.85).aspx)的 Win32 API 。
**使用此功能连接到具有身份验证的 UNC 路径，而不是映射驱动器**。

这将允许您连接到远程计算机，即使它不在同一个域中，即使它具有不同的用户名和密码。

使用 WNetUseConnection 后，您将能够通过 UNC 路径访问该文件，就像您在同一个域中一样。最好的方法可能是通过行政内置共享。
示例：\\computername\c$\program files\Folder\file.txt

下面是一些使用 WNetUseConnection 的示例 C# 代码。
注意，对于 NetResource，您应该为 lpLocalName 和 lpProvider 传递 null。dwType 应该是 RESOURCETYPE_DISK。lpRemoteName 应该是 \\ComputerName。

```
using System;
using System.Runtime.InteropServices ;
using System.Threading;

namespace ExtremeMirror
{
    public class PinvokeWindowsNetworking
    {
        #region Consts
        const int RESOURCE_CONNECTED = 0x00000001;
        const int RESOURCE_GLOBALNET = 0x00000002;
        const int RESOURCE_REMEMBERED = 0x00000003;

        const int RESOURCETYPE_ANY = 0x00000000;
        const int RESOURCETYPE_DISK = 0x00000001;
        const int RESOURCETYPE_PRINT = 0x00000002;

        const int RESOURCEDISPLAYTYPE_GENERIC = 0x00000000;
        const int RESOURCEDISPLAYTYPE_DOMAIN = 0x00000001;
        const int RESOURCEDISPLAYTYPE_SERVER = 0x00000002;
        const int RESOURCEDISPLAYTYPE_SHARE = 0x00000003;
        const int RESOURCEDISPLAYTYPE_FILE = 0x00000004;
        const int RESOURCEDISPLAYTYPE_GROUP = 0x00000005;

        const int RESOURCEUSAGE_CONNECTABLE = 0x00000001;
        const int RESOURCEUSAGE_CONTAINER = 0x00000002;

        const int CONNECT_INTERACTIVE = 0x00000008;
        const int CONNECT_PROMPT = 0x00000010;
        const int CONNECT_REDIRECT = 0x00000080;
        const int CONNECT_UPDATE_PROFILE = 0x00000001;
        const int CONNECT_COMMANDLINE = 0x00000800;
        const int CONNECT_CMD_SAVECRED = 0x00001000;

        const int CONNECT_LOCALDRIVE = 0x00000100;
        #endregion

        #region Errors
        const int NO_ERROR = 0;

        const int ERROR_ACCESS_DENIED = 5;
        const int ERROR_ALREADY_ASSIGNED = 85;
        const int ERROR_BAD_DEVICE = 1200;
        const int ERROR_BAD_NET_NAME = 67;
        const int ERROR_BAD_PROVIDER = 1204;
        const int ERROR_CANCELLED = 1223;
        const int ERROR_EXTENDED_ERROR = 1208;
        const int ERROR_INVALID_ADDRESS = 487;
        const int ERROR_INVALID_PARAMETER = 87;
        const int ERROR_INVALID_PASSWORD = 1216;
        const int ERROR_MORE_DATA = 234;
        const int ERROR_NO_MORE_ITEMS = 259;
        const int ERROR_NO_NET_OR_BAD_PATH = 1203;
        const int ERROR_NO_NETWORK = 1222;

        const int ERROR_BAD_PROFILE = 1206;
        const int ERROR_CANNOT_OPEN_PROFILE = 1205;
        const int ERROR_DEVICE_IN_USE = 2404;
        const int ERROR_NOT_CONNECTED = 2250;
        const int ERROR_OPEN_FILES  = 2401;

        private struct ErrorClass 
        {
            public int num;
            public string message;
            public ErrorClass(int num, string message) 
            {
                this.num = num;
                this.message = message;
            }
        }

        // Created with excel formula:
        // ="new ErrorClass("&A1&", """&PROPER(SUBSTITUTE(MID(A1,7,LEN(A1)-6), "_", " "))&"""), "
        private static ErrorClass[] ERROR_LIST = new ErrorClass[] {
            new ErrorClass(ERROR_ACCESS_DENIED, "Error: Access Denied"), 
            new ErrorClass(ERROR_ALREADY_ASSIGNED, "Error: Already Assigned"), 
            new ErrorClass(ERROR_BAD_DEVICE, "Error: Bad Device"), 
            new ErrorClass(ERROR_BAD_NET_NAME, "Error: Bad Net Name"), 
            new ErrorClass(ERROR_BAD_PROVIDER, "Error: Bad Provider"), 
            new ErrorClass(ERROR_CANCELLED, "Error: Cancelled"), 
            new ErrorClass(ERROR_EXTENDED_ERROR, "Error: Extended Error"), 
            new ErrorClass(ERROR_INVALID_ADDRESS, "Error: Invalid Address"), 
            new ErrorClass(ERROR_INVALID_PARAMETER, "Error: Invalid Parameter"), 
            new ErrorClass(ERROR_INVALID_PASSWORD, "Error: Invalid Password"), 
            new ErrorClass(ERROR_MORE_DATA, "Error: More Data"), 
            new ErrorClass(ERROR_NO_MORE_ITEMS, "Error: No More Items"), 
            new ErrorClass(ERROR_NO_NET_OR_BAD_PATH, "Error: No Net Or Bad Path"), 
            new ErrorClass(ERROR_NO_NETWORK, "Error: No Network"), 
            new ErrorClass(ERROR_BAD_PROFILE, "Error: Bad Profile"), 
            new ErrorClass(ERROR_CANNOT_OPEN_PROFILE, "Error: Cannot Open Profile"), 
            new ErrorClass(ERROR_DEVICE_IN_USE, "Error: Device In Use"), 
            new ErrorClass(ERROR_EXTENDED_ERROR, "Error: Extended Error"), 
            new ErrorClass(ERROR_NOT_CONNECTED, "Error: Not Connected"), 
            new ErrorClass(ERROR_OPEN_FILES, "Error: Open Files"), 
        };

        private static string getErrorForNumber(int errNum) 
        {
            foreach (ErrorClass er in ERROR_LIST) 
            {
                if (er.num == errNum) return er.message;
            }
            return "Error: Unknown, " + errNum;
        }
        #endregion

        [DllImport("Mpr.dll")] private static extern int WNetUseConnection(
            IntPtr hwndOwner,
            NETRESOURCE lpNetResource,
            string lpPassword,
            string lpUserID,
            int dwFlags,
            string lpAccessName,
            string lpBufferSize,
            string lpResult
        );

        [DllImport("Mpr.dll")] private static extern int WNetCancelConnection2(
            string lpName,
            int dwFlags,
            bool fForce
        );

        [StructLayout(LayoutKind.Sequential)] private class NETRESOURCE
        { 
            public int dwScope = 0;
            public int dwType = 0;
            public int dwDisplayType = 0;
            public int dwUsage = 0;
            public string lpLocalName = "";
            public string lpRemoteName = "";
            public string lpComment = "";
            public string lpProvider = "";
        }

        public static string connectToRemote(string remoteUNC, string username, string password) 
        {
            return connectToRemote(remoteUNC, username, password, false);
        }

        public static string connectToRemote(string remoteUNC, string username, string password, bool promptUser) 
        {
            NETRESOURCE nr = new NETRESOURCE();
            nr.dwType = RESOURCETYPE_DISK;
            nr.lpRemoteName = remoteUNC;
            //          nr.lpLocalName = "F:";

            int ret;
            if (promptUser) 
                ret = WNetUseConnection(IntPtr.Zero, nr, "", "", CONNECT_INTERACTIVE | CONNECT_PROMPT, null, null, null);
            else 
                ret = WNetUseConnection(IntPtr.Zero, nr, password, username, 0, null, null, null);

            if (ret == NO_ERROR) return null;
            return getErrorForNumber(ret);
        }

        public static string disconnectRemote(string remoteUNC) 
        {
            int ret = WNetCancelConnection2(remoteUNC, CONNECT_UPDATE_PROFILE, false);
            if (ret == NO_ERROR) return null;
            return getErrorForNumber(ret);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：134
> 
> 时间：2013-02-14T08:40:50.337

对于寻求快速解决方案的人，您可以使用`NetworkShareAccesser`我最近写的（基于[此答案](https://stackoverflow.com/a/684040/808723)（非常感谢！））：

**用法：**

```
using (NetworkShareAccesser.Access(REMOTE_COMPUTER_NAME, DOMAIN, USER_NAME, PASSWORD))
{
    File.Copy(@"C:\Some\File\To\copy.txt", @"\\REMOTE-COMPUTER\My\Shared\Target\file.txt");
} 
```

**警告：**请绝对确定调用`Dispose`的那个`NetworkShareAccesser`（即使你的应用程序崩溃了！），否则打开的连接将保留在 Windows 上。`cmd`您可以通过打开提示并输入来查看所有打开的连接`net use`。

**编码：**

```
/// <summary>
/// Provides access to a network share.
/// </summary>
public class NetworkShareAccesser : IDisposable
{
    private string _remoteUncName;
    private string _remoteComputerName;

    public string RemoteComputerName
    {
        get
        {
            return this._remoteComputerName;
        }
        set
        {
            this._remoteComputerName = value;
            this._remoteUncName = @"\\" + this._remoteComputerName;
        }
    }

    public string UserName
    {
        get;
        set;
    }
    public string Password
    {
        get;
        set;
    }

    #region Consts

    private const int RESOURCE_CONNECTED = 0x00000001;
    private const int RESOURCE_GLOBALNET = 0x00000002;
    private const int RESOURCE_REMEMBERED = 0x00000003;

    private const int RESOURCETYPE_ANY = 0x00000000;
    private const int RESOURCETYPE_DISK = 0x00000001;
    private const int RESOURCETYPE_PRINT = 0x00000002;

    private const int RESOURCEDISPLAYTYPE_GENERIC = 0x00000000;
    private const int RESOURCEDISPLAYTYPE_DOMAIN = 0x00000001;
    private const int RESOURCEDISPLAYTYPE_SERVER = 0x00000002;
    private const int RESOURCEDISPLAYTYPE_SHARE = 0x00000003;
    private const int RESOURCEDISPLAYTYPE_FILE = 0x00000004;
    private const int RESOURCEDISPLAYTYPE_GROUP = 0x00000005;

    private const int RESOURCEUSAGE_CONNECTABLE = 0x00000001;
    private const int RESOURCEUSAGE_CONTAINER = 0x00000002;

    private const int CONNECT_INTERACTIVE = 0x00000008;
    private const int CONNECT_PROMPT = 0x00000010;
    private const int CONNECT_REDIRECT = 0x00000080;
    private const int CONNECT_UPDATE_PROFILE = 0x00000001;
    private const int CONNECT_COMMANDLINE = 0x00000800;
    private const int CONNECT_CMD_SAVECRED = 0x00001000;

    private const int CONNECT_LOCALDRIVE = 0x00000100;

    #endregion

    #region Errors

    private const int NO_ERROR = 0;

    private const int ERROR_ACCESS_DENIED = 5;
    private const int ERROR_ALREADY_ASSIGNED = 85;
    private const int ERROR_BAD_DEVICE = 1200;
    private const int ERROR_BAD_NET_NAME = 67;
    private const int ERROR_BAD_PROVIDER = 1204;
    private const int ERROR_CANCELLED = 1223;
    private const int ERROR_EXTENDED_ERROR = 1208;
    private const int ERROR_INVALID_ADDRESS = 487;
    private const int ERROR_INVALID_PARAMETER = 87;
    private const int ERROR_INVALID_PASSWORD = 1216;
    private const int ERROR_MORE_DATA = 234;
    private const int ERROR_NO_MORE_ITEMS = 259;
    private const int ERROR_NO_NET_OR_BAD_PATH = 1203;
    private const int ERROR_NO_NETWORK = 1222;

    private const int ERROR_BAD_PROFILE = 1206;
    private const int ERROR_CANNOT_OPEN_PROFILE = 1205;
    private const int ERROR_DEVICE_IN_USE = 2404;
    private const int ERROR_NOT_CONNECTED = 2250;
    private const int ERROR_OPEN_FILES = 2401;

    #endregion

    #region PInvoke Signatures

    [DllImport("Mpr.dll")]
    private static extern int WNetUseConnection(
        IntPtr hwndOwner,
        NETRESOURCE lpNetResource,
        string lpPassword,
        string lpUserID,
        int dwFlags,
        string lpAccessName,
        string lpBufferSize,
        string lpResult
        );

    [DllImport("Mpr.dll")]
    private static extern int WNetCancelConnection2(
        string lpName,
        int dwFlags,
        bool fForce
        );

    [StructLayout(LayoutKind.Sequential)]
    private class NETRESOURCE
    {
        public int dwScope = 0;
        public int dwType = 0;
        public int dwDisplayType = 0;
        public int dwUsage = 0;
        public string lpLocalName = "";
        public string lpRemoteName = "";
        public string lpComment = "";
        public string lpProvider = "";
    }

    #endregion

    /// <summary>
    /// Creates a NetworkShareAccesser for the given computer name. The user will be promted to enter credentials
    /// </summary>
    /// <param name="remoteComputerName"></param>
    /// <returns></returns>
    public static NetworkShareAccesser Access(string remoteComputerName)
    {
        return new NetworkShareAccesser(remoteComputerName);
    }

    /// <summary>
    /// Creates a NetworkShareAccesser for the given computer name using the given domain/computer name, username and password
    /// </summary>
    /// <param name="remoteComputerName"></param>
    /// <param name="domainOrComuterName"></param>
    /// <param name="userName"></param>
    /// <param name="password"></param>
    public static NetworkShareAccesser Access(string remoteComputerName, string domainOrComuterName, string userName, string password)
    {
        return new NetworkShareAccesser(remoteComputerName,
                                        domainOrComuterName + @"\" + userName,
                                        password);
    }

    /// <summary>
    /// Creates a NetworkShareAccesser for the given computer name using the given username (format: domainOrComputername\Username) and password
    /// </summary>
    /// <param name="remoteComputerName"></param>
    /// <param name="userName"></param>
    /// <param name="password"></param>
    public static NetworkShareAccesser Access(string remoteComputerName, string userName, string password)
    {
        return new NetworkShareAccesser(remoteComputerName, 
                                        userName,
                                        password);
    }

    private NetworkShareAccesser(string remoteComputerName)
    {
        RemoteComputerName = remoteComputerName;               

        this.ConnectToShare(this._remoteUncName, null, null, true);
    }

    private NetworkShareAccesser(string remoteComputerName, string userName, string password)
    {
        RemoteComputerName = remoteComputerName;
        UserName = userName;
        Password = password;

        this.ConnectToShare(this._remoteUncName, this.UserName, this.Password, false);
    }

    private void ConnectToShare(string remoteUnc, string username, string password, bool promptUser)
    {
        NETRESOURCE nr = new NETRESOURCE
        {
            dwType = RESOURCETYPE_DISK,
            lpRemoteName = remoteUnc
        };

        int result;
        if (promptUser)
        {
            result = WNetUseConnection(IntPtr.Zero, nr, "", "", CONNECT_INTERACTIVE | CONNECT_PROMPT, null, null, null);
        }
        else
        {
            result = WNetUseConnection(IntPtr.Zero, nr, password, username, 0, null, null, null);
        }

        if (result != NO_ERROR)
        {
            throw new Win32Exception(result);
        }
    }

    private void DisconnectFromShare(string remoteUnc)
    {
        int result = WNetCancelConnection2(remoteUnc, CONNECT_UPDATE_PROFILE, false);
        if (result != NO_ERROR)
        {
            throw new Win32Exception(result);
        }
    }

    /// <summary>
    /// Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.
    /// </summary>
    /// <filterpriority>2</filterpriority>
    public void Dispose()
    {
        this.DisconnectFromShare(this._remoteUncName);
    }
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-24T19:37:25.980

AFAIK，您无需将 UNC 路径**映射**到驱动器号即可为服务器建立凭据。我经常使用批处理脚本，例如：

```
net use \\myserver /user:username password

:: do something with \\myserver\the\file\i\want.xml

net use /delete \\my.server.com 
```

但是，与您的程序在同一帐户上运行的任何程序仍然能够访问有权访问`username:password`的所有内容。一种可能的解决方案是将您的程序隔离在其自己的本地用户帐户中（UNC 访问权限对于调用 的帐户是本地的`NET USE`）。

**注意：**跨域使用 SMB 并不能很好地利用该技术，IMO。如果安全性如此重要，那么 SMB 缺乏加密这一事实本身就有点令人沮丧。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-24T19:58:02.297

虽然我不了解自己，但我当然希望 #2 是不正确的......我想认为 Windows 不会自动向任何机器提供我的登录信息（至少是我的所有密码！） ，更不用说不属于我的信任的人了。

无论如何，您是否探索过模拟架构？您的代码将与此类似：

```
using (System.Security.Principal.WindowsImpersonationContext context = System.Security.Principal.WindowsIdentity.Impersonate(token))
{
    // Do network operations here

    context.Undo();
} 
```

在这种情况下，`token`变量是一个 IntPtr。为了获取此变量的值，您必须调用非托管 LogonUser Windows API 函数。快速访问[pinvoke.net](http://pinvoke.net/default.aspx/advapi32.LogonUser)为我们提供了以下签名：

```
[System.Runtime.InteropServices.DllImport("advapi32.dll", SetLastError = true)]
public static extern bool LogonUser(
    string lpszUsername,
    string lpszDomain,
    string lpszPassword,
    int dwLogonType,
    int dwLogonProvider,
    out IntPtr phToken
); 
```

用户名、域和密码应该看起来相当明显。查看可以传递给 dwLogonType 和 dwLogonProvider 的各种值，以确定最适合您需要的值。

此代码尚未经过测试，因为我在这里没有可以验证的第二个域，但这应该有望使您走上正轨。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-26T03:59:14.767

而不是 WNetUseConnection，我会推荐[NetUseAdd](http://www.pinvoke.net/default.aspx/netapi32/NetUseAdd.html)。WNetUseConnection 是一个已被 WNetUseConnection2 和 WNetUseConnection3 取代的旧功能，但所有这些功能都会创建一个在 Windows 资源管理器中可见的网络设备。NetUseAdd 相当于在 DOS 提示符下调用 net use 以在远程计算机上进行身份验证。

如果您调用 NetUseAdd，那么后续访问该目录的尝试应该会成功。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-01-09T12:45:05.543

这里是一个最小的 POC 类，去掉了所有的杂物

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;

public class UncShareWithCredentials : IDisposable
{
    private string _uncShare;

    public UncShareWithCredentials(string uncShare, string userName, string password)
    {
        var nr = new Native.NETRESOURCE
        {
            dwType = Native.RESOURCETYPE_DISK,
            lpRemoteName = uncShare
        };

        int result = Native.WNetUseConnection(IntPtr.Zero, nr, password, userName, 0, null, null, null);
        if (result != Native.NO_ERROR)
        {
            throw new Win32Exception(result);
        }
        _uncShare = uncShare;
    }

    public void Dispose()
    {
        if (!string.IsNullOrEmpty(_uncShare))
        {
            Native.WNetCancelConnection2(_uncShare, Native.CONNECT_UPDATE_PROFILE, false);
            _uncShare = null;
        }
    }

    private class Native
    {
        public const int RESOURCETYPE_DISK = 0x00000001;
        public const int CONNECT_UPDATE_PROFILE = 0x00000001;
        public const int NO_ERROR = 0;

        [DllImport("mpr.dll")]
        public static extern int WNetUseConnection(IntPtr hwndOwner, NETRESOURCE lpNetResource, string lpPassword, string lpUserID,
            int dwFlags, string lpAccessName, string lpBufferSize, string lpResult);

        [DllImport("mpr.dll")]
        public static extern int WNetCancelConnection2(string lpName, int dwFlags, bool fForce);

        [StructLayout(LayoutKind.Sequential)]
        public class NETRESOURCE
        {
            public int dwScope;
            public int dwType;
            public int dwDisplayType;
            public int dwUsage;
            public string lpLocalName;
            public string lpRemoteName;
            public string lpComment;
            public string lpProvider;
        }
    }
} 
```

您可以直接使用`\\server\share\folder`w/ `WNetUseConnection`，无需`\\server`事先将其剥离。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-18T16:51:52.583

大多数 SFTP 服务器也支持 SCP，这可以更容易找到库。你甚至可以从你的代码中调用一个现有的客户端，比如[PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/)中包含的 pscp 。

如果您使用的文件类型很简单，例如文本或 XML 文件，您甚至可以编写自己的客户端/服务器实现来使用 .NET Remoting 或 Web 服务之类的东西来操作文件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-12-30T13:39:55.203

我根据[布赖恩](https://stackoverflow.com/a/684040/1194088)参考附上了我的**vb.net 代码**

```
Imports System.ComponentModel

Imports System.Runtime.InteropServices

Public Class PinvokeWindowsNetworking

Const NO_ERROR As Integer = 0

Private Structure ErrorClass

    Public num As Integer

    Public message As String

    Public Sub New(ByVal num As Integer, ByVal message As String)

        Me.num = num

        Me.message = message

    End Sub

End Structure

Private Shared ERROR_LIST As ErrorClass() = New ErrorClass() {

    New ErrorClass(5, "Error: Access Denied"),

    New ErrorClass(85, "Error: Already Assigned"),

    New ErrorClass(1200, "Error: Bad Device"),

    New ErrorClass(67, "Error: Bad Net Name"),

    New ErrorClass(1204, "Error: Bad Provider"),

    New ErrorClass(1223, "Error: Cancelled"),

    New ErrorClass(1208, "Error: Extended Error"),

    New ErrorClass(487, "Error: Invalid Address"),

    New ErrorClass(87, "Error: Invalid Parameter"),

    New ErrorClass(1216, "Error: Invalid Password"),

    New ErrorClass(234, "Error: More Data"),

    New ErrorClass(259, "Error: No More Items"),

    New ErrorClass(1203, "Error: No Net Or Bad Path"),

    New ErrorClass(1222, "Error: No Network"),

    New ErrorClass(1206, "Error: Bad Profile"),

    New ErrorClass(1205, "Error: Cannot Open Profile"),

    New ErrorClass(2404, "Error: Device In Use"),

    New ErrorClass(2250, "Error: Not Connected"),

    New ErrorClass(2401, "Error: Open Files")}

Private Shared Function getErrorForNumber(ByVal errNum As Integer) As String

    For Each er As ErrorClass In ERROR_LIST

        If er.num = errNum Then Return er.message

    Next

    Try

        Throw New Win32Exception(errNum)

    Catch ex As Exception

        Return "Error: Unknown, " & errNum & " " & ex.Message

    End Try

    Return "Error: Unknown, " & errNum

End Function

<DllImport("Mpr.dll")>

Private Shared Function WNetUseConnection(ByVal hwndOwner As IntPtr, ByVal lpNetResource As NETRESOURCE, ByVal lpPassword As String, ByVal lpUserID As String, ByVal dwFlags As Integer, ByVal lpAccessName As String, ByVal lpBufferSize As String, ByVal lpResult As String) As Integer

End Function

<DllImport("Mpr.dll")>

Private Shared Function WNetCancelConnection2(ByVal lpName As String, ByVal dwFlags As Integer, ByVal fForce As Boolean) As Integer

End Function

<StructLayout(LayoutKind.Sequential)>

Private Class NETRESOURCE

    Public dwScope As Integer = 0

    Public dwType As Integer = 0

    Public dwDisplayType As Integer = 0

    Public dwUsage As Integer = 0

    Public lpLocalName As String = ""

    Public lpRemoteName As String = ""

    Public lpComment As String = ""

    Public lpProvider As String = ""

End Class

Public Shared Function connectToRemote(ByVal remoteUNC As String, ByVal username As String, ByVal password As String) As String

    Return connectToRemote(remoteUNC, username, password, False)

End Function

Public Shared Function connectToRemote(ByVal remoteUNC As String, ByVal username As String, ByVal password As String, ByVal promptUser As Boolean) As String

    Dim nr As NETRESOURCE = New NETRESOURCE()

    nr.dwType = ResourceTypes.Disk

    nr.lpRemoteName = remoteUNC

    Dim ret As Integer

    If promptUser Then

        ret = WNetUseConnection(IntPtr.Zero, nr, "", "", Connects.Interactive Or Connects.Prompt, Nothing, Nothing, Nothing)

    Else

        ret = WNetUseConnection(IntPtr.Zero, nr, password, username, 0, Nothing, Nothing, Nothing)

    End If

    If ret = NO_ERROR Then Return Nothing

    Return getErrorForNumber(ret)

End Function

Public Shared Function disconnectRemote(ByVal remoteUNC As String) As String

    Dim ret As Integer = WNetCancelConnection2(remoteUNC, Connects.UpdateProfile, False)

    If ret = NO_ERROR Then Return Nothing

    Return getErrorForNumber(ret)

End Function

Enum Resources As Integer

    Connected = &H1

    GlobalNet = &H2

    Remembered = &H3

End Enum

Enum ResourceTypes As Integer

    Any = &H0

    Disk = &H1

    Print = &H2

End Enum

Enum ResourceDisplayTypes As Integer

    Generic = &H0

    Domain = &H1

    Server = &H2

    Share = &H3

    File = &H4

    Group = &H5

End Enum

Enum ResourceUsages As Integer

    Connectable = &H1

    Container = &H2

End Enum

Enum Connects As Integer

    Interactive = &H8

    Prompt = &H10

    Redirect = &H80

    UpdateProfile = &H1

    CommandLine = &H800

    CmdSaveCred = &H1000

    LocalDrive = &H100

End Enum

End Class 
```

**如何使用它**

```
Dim login = PinvokeWindowsNetworking.connectToRemote("\\ComputerName", "ComputerName\UserName", "Password")

    If IsNothing(login) Then

        'do your thing on the shared folder

       PinvokeWindowsNetworking.disconnectRemote("\\ComputerName")

    End If 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2015-10-27T19:38:36.520

我向 MS 寻求答案。第一个解决方案假定运行应用程序进程的用户帐户有权访问共享文件夹或驱动器（相同域）。确保您的 DNS 已解析或尝试使用 IP 地址。只需执行以下操作：

```
 DirectoryInfo di = new DirectoryInfo(PATH);
 var files = di.EnumerateFiles("*.*", SearchOption.AllDirectories); 
```

如果您想要跨不同域的 .NET 2.0 使用凭据，请遵循以下模型：

```
WebRequest req = FileWebRequest.Create(new Uri(@"\\<server Name>\Dir\test.txt"));

        req.Credentials = new NetworkCredential(@"<Domain>\<User>", "<Password>");
        req.PreAuthenticate = true;

        WebResponse d = req.GetResponse();
        FileStream fs = File.Create("test.txt");

        // here you can check that the cast was successful if you want. 
        fs = d.GetResponseStream() as FileStream;
        fs.Close(); 
```

# python - 从 Python 访问 Microsoft 自动化对象

> ID：659018
> 
> 赞同：4
> 
> 时间：2009-03-18T16:28:03.107
> 
> 标签：python, object, automation

我有一组宏，我已经将它们变成了 excel 中的加载项。宏允许我与另一个程序进行交互，该程序具有所谓的 Microsoft 自动化对象，这些对象可以控制其他程序的操作。例如，我在加载项中有一个过滤工具，用于过滤其他程序提供的列表以匹配 Excel 工作簿中的列表。不过这很慢。我可能在另一个程序中有五万行，并且想要过滤掉所有与 Excel 中的三千行列表不匹配的行。这种类型的匹配大约需要 30-40 分钟。我开始想知道是否有办法用 Python 来代替，因为我怀疑匹配过程可以在几秒钟内完成。

编辑：

谢谢-根据查看哈蒙德的书的建议，我发现了许多资源。但是，尽管我仍在探索，但其中许多似乎已经过时了。例如，哈蒙德的书出版于 2000 年，这意味着写作是在将近十年前完成的。更正我刚刚发现了一个名为 PyWin32 的包，其版本为 2/2009。

这应该让我开始。谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-18T17:22:27.580

您可能需要 win32com 软件包。

这是我在以下网址找到的一个示例：http: [//www.markcarter.me.uk/computing/python/excel.html](http://www.markcarter.me.uk/computing/python/excel.html)，它展示了如何将 com 与 Excel 一起使用。这可能是一个好的开始。

```
# this example starts Excel, creates a new workbook, 
# puts some text in the first and second cell
# closes the workbook without saving the changes
# and closes Excel.  This happens really fast, so
# you may want to comment out some lines and add them
# back in one at a time ... or do the commands interactively

from win32com.client import Dispatch

xlApp = Dispatch("Excel.Application")
xlApp.Visible = 1
xlApp.Workbooks.Add()
xlApp.ActiveSheet.Cells(1,1).Value = 'Python Rules!'
xlApp.ActiveWorkbook.ActiveSheet.Cells(1,2).Value = 'Python Rules 2!'
xlApp.ActiveWorkbook.Close(SaveChanges=0) # see note 1
xlApp.Quit()
xlApp.Visible = 0 # see note 2
del xlApp

# raw_input("press Enter ...") 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-18T16:41:32.607

Mark Hammond 和 Andy Robinson 撰写了关于从 Python 访问 Windows COM 对象[的书。](http://shop.oreilly.com/product/9781565926219.do)

[这](http://books.google.com/books?id=ns1WMyLVnRMC&pg=PA198&lpg=PA198&dq=python+microsoft+automation+objects&source=bl&ots=NVoi1KaePn&sig=U7PW8ttWlZumpqiLrzWSBL8IxSU&hl=en&ei=FyPBSYWUA4mMsAPSptgv&sa=X&oi=book_result&resnum=1&ct=result#PPA198,M1)是一个使用 Excel 的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T16:42:07.473

据我所知，可以在 Windows 上的 Python 中创建 COM 对象（即自动化对象）。然后假设您可以通过自动化获取列表，那么在 python 中执行您想要的操作应该很容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T17:09:48.873

> 但是，尽管我仍在探索，但其中许多似乎已经过时了。

COM是旧的。至少自 1993 年以来，界面就没有改变过。

> 我也没有在 Python.org 网站上看到这个包。我搜索了 COM 包，但没有看到任何有用的东西。

[http://python.net/crew/mhammond/win32/](http://python.net/crew/mhammond/win32/) [http://sourceforge.net/projects/pywin32/](http://sourceforge.net/projects/pywin32/)

最新更新是 2009 年 2 月，其中包括 Python 3.0 支持。

# c# - EntLib 4.0：异常处理应用程序块

> ID：659020
> 
> 赞同：1
> 
> 时间：2009-03-18T16:28:12.217
> 
> 标签：c#, exception-handling, enterprise-library

我刚刚开始使用企业库异常处理块。

好像有点麻烦。

我真的必须做吗

```
 try
 {
     //Do something with a DirectoryInfo object
 }
 catch(DirectoryNotFoundException ex)
 {
   bool rethrow = ExceptionPolicy.Handle(ex, _exceptionPolicyName);

   if(rethrow)
        throw;
 } 
```

我想在哪里处理异常？

或者我应该把顶层包裹在

```
 try
 {
     //Entrypoint code
 }
 catch(Exception ex)
 {
   bool rethrow = ExceptionPolicy.Handle(ex, _exceptionPolicyName);

   if(rethrow)
        throw;
 } 
```

我的印象是我可以用属性来看待这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T16:32:53.830

你需要多少地方来处理异常？

该应用程序块主要用于处理层边界上的异常。例如，您的数据访问层的顶级代码可能会使用它，因此您可以配置是否以及如何记录 DAL 异常、是否包装非 DAL 异常等。但是您的私有内部方法不应处理异常全部。

不，EAL 不做属性。

# php - 如何删除非字母数字字符？

> ID：659025
> 
> 赞同：398
> 
> 时间：2009-03-18T16:29:19.140
> 
> 标签：php, regex, string

我需要从字符串中删除所有不在`a-z A-Z 0-9`集合中或不是空格的字符。

有没有人有这样做的功能？

* * *

## 回答 #1

> 赞同：777
> 
> 时间：2009-03-18T16:30:53.583

听起来您几乎已经知道自己想要做什么，您基本上将其定义为正则表达式。

```
preg_replace("/[^A-Za-z0-9 ]/", '', $string); 
```

* * *

## 回答 #2

> 赞同：183
> 
> 时间：2013-06-17T15:24:06.220

对于 unicode 字符，它是：

```
preg_replace("/[^[:alnum:][:space:]]/u", '', $string); 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2009-03-18T16:41:24.307

[正则表达式](http://en.wikipedia.org/wiki/Regexp)是你的答案。

```
$str = preg_replace('/[^a-z\d ]/i', '', $str); 
```

*   `i`代表不区分大小写。
*   `^`意思是，不开头。
*   `\d`匹配任何数字。
*   `a-z`匹配 和 之间`a`的所有字符`z`。由于该`i`参数，您不必指定`a-z`and `A-Z`。
*   `\d`有空格之后，所以这个正则表达式中允许有空格。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2018-09-04T13:23:59.440

如果您需要支持其他语言，而不是典型的 AZ，您可以使用以下内容：

```
preg_replace('/[^\p{L}\p{N} ]+/', '', $string); 
```

*   `[^\p{L}\p{N} ]`定义了一个*否定*的（它将匹配一个**未定义**的字符）字符类：
    *   `\p{L}`*:任何*语言的信件。
    *   `\p{N}`*:任何*脚本中的数字字符。
    *   `: 一个空格字符。`

`*   `+` *贪婪地*匹配字符类 1 到*无限*次。`

 `这将保留来自其他语言和脚本以及 AZ 的字母和数字：

```
preg_replace('/[^\p{L}\p{N} ]+/', '', 'hello-world'); // helloworld
preg_replace('/[^\p{L}\p{N} ]+/', '', 'abc@~#123-+=öäå'); // abc123öäå
preg_replace('/[^\p{L}\p{N} ]+/', '', '你好世界!@£$%^&*()'); // 你好世界 
```

* * *

^(**注意：**这是一个非常古老但仍然相关的问题。我回答纯粹是为了提供可能对未来访问者有用的补充信息。)

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2014-10-17T10:00:36.977

这是一个非常简单的正则表达式：

```
\W|_ 
```

并根据需要使用（使用正`/`斜杠分隔符）。

```
preg_replace("/\W|_/", '', $string); 
```

使用这个解释正则表达式在做什么的好工具在这里测试它：

[http://www.regexr.com/](http://www.regexr.com/)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2017-10-25T20:27:36.260

```
[\W_]+ 
```

```
$string = preg_replace("/[\W_]+/u", '', $string); 
```

它选择所有非 AZ、az、0-9 并将其删除。

请参阅此处的示例：[https ://regexr.com/3h1rj](https://regexr.com/3h1rj)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-07-26T13:33:51.680

```
preg_replace("/\W+/", '', $string) 
```

你可以在这里测试它：[http ://regexr.com/](http://regexr.com/)

# javascript - javascript 如何将某些内容流式传输给用户？

> ID：659028
> 
> 赞同：0
> 
> 时间：2009-03-18T16:30:38.733
> 
> 标签：javascript, stream

我需要一个 Javascript 示例，它从 url 读取内容并在单击某个按钮时在客户端中创建一个具有相同内容的文件。我也明白不能允许 Javascript 访问本地文件系统（除非你使用 ActiveX 对象）。我不想依赖 ActiveX 对象（因为我的客户端并不总是 IE）。

所以这就是我所做的。我使用标准的 XmlHttpRequest 发出请求并得到我的字节。现在我想我可以将这些内容流式传输给用户，首先打开一个标准对话框（当您尝试从 Internet 下载内容时弹出的框，带有打开/保存/取消之类的选项），然后要求用户保存它某处。

我知道如何阅读部分，有人可以在“如何向用户流式打开确认对话框并流式传输一些内容”上显示一些 javascript/html 示例吗？

PS：不太确定这是否可以在 javascript 中完成，但使用 Javascript 你永远不知道什么是可能的，什么不是:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T17:04:58.073

与其使用 Javascript 流式传输内容（出于明显的安全原因这是不可能的），您需要将浏览器指向一个将返回 ' `Content-Type`' 标头的URL `application/octet-stream`。在大多数情况下，这将迫使浏览器启动“另存为”操作并询问用户如何处理它。

我相信可以在同一页面中使用 iframe 来执行此操作，这样用户就不必离开页面或打开新的选项卡/窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T16:38:32.833

如果我明白你的问题是什么，那么你想使用 JavaScript 来编写数据，就像服务器端脚本（PHP、Python、Java 等）一样，但是在浏览器中？

如果是这样，那么您的要求在浏览器 JavaScript 中是不可能的。

但是，如果出于某种原因您想使用服务器端 JavaScript 执行此操作，那么“流”部分是可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T16:58:58.757

这样看：如果您可以使用 JavaScript 读取/写入用户的计算机，那么没有计算机可以安全地浏览网页。

话虽如此，您无法使用 JavaScript 读取/写入客户端文件。

但是，如果您使用 Flash / Java 小程序，则可以；在这些情况下，嵌入式对象在执行此类操作之前会请求您的许可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T17:31:16.793

您可能想看看[TiddlyWiki](http://www.tiddlywiki.com/)声称它可以将自己写入磁盘......

# html - 为什么人们会这样写 HTML？

> ID：659029
> 
> 赞同：3
> 
> 时间：2009-03-18T16:30:50.167
> 
> 标签：html

我注意到很多人在编写 HTML 时不使用引号。例如：

```
<li class=somename>blabla</li>
instead of
<li class="somename">dkdk</li> 
```

他们从哪里得到这个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-18T16:34:56.337

从[HTML 4.01 规范](http://www.w3.org/TR/html401/intro/sgmltut.html#h-3.2.2)：

> 在某些情况下，作者可以不带任何引号指定属性的值。属性值只能包含字母（az 和 AZ）、数字（0-9）、连字符（ASCII 十进制 45）、句点（ASCII 十进制 46）、下划线（ASCII 十进制 95）和冒号（ASCII 十进制 58）。即使可以消除引号，我们也建议使用引号。

但在 XHTML 中，引号必须是[格式正确的 XML](http://www.w3.org/TR/xml/#sec-well-formed)（另请参阅[XHTML 1.0：与 HTML 4 的差异——必须始终引用属性值](http://www.w3.org/TR/xhtml1/#h-4.4)）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-18T16:34:42.497

在 XHTML 之前，您可以不使用引号；事实上，浏览器已被编码为尽可能宽松。随着 XHTML 的出现，它不再是惯例，但浏览器仍然可以识别它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T16:35:02.683

嗯，这东西有一段历史。HTML i in the wild 是标签汤是有原因的。它与整个“对你接受的东西保持自由”有关。很多人在 XHTML 真正流行之前就开始做网页设计。此外，一些较旧的 HTML WYSIWYG 编辑器可能默认使用这种丑陋的语法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T16:35:13.137

我觉得这完全取决于谁教他们或者他们对编码有多少兴趣。如果你认为你的代码应该看起来很整洁。您将自动开始遵循最佳实践。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T16:35:49.797

人们倾向于用最少的努力做事，所以虽然几乎每个浏览器和解析器都接受第一个版本，但他们继续产生“无效”的 html。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T16:36:01.903

简短的回答是因为不是每个人都关心他们的代码是否遵循良好的实践，或者它是否符合 W3C 提供的官方规范（即可以验证）。

也就是说，有一点你必须称它足够好。请参阅Jeff Atwood[的这篇文章](https://blog.codinghorror.com/html-validation-does-it-matter/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-18T16:37:41.977

很多 WYSIWYG 编辑器不加引号，Visual Studio 中的 IntelliSense 不加标签，如果不需要的话，人们可能会想添加标签有什么意义。毕竟，它们也需要带宽。

我总是使用引号，但除了代码样式以及如果您需要使用类 =“一二三”之类的东西之外，真的没有理由使用它们。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-18T16:37:44.427

也许是因为不完美是很正常的，但完美是不正常的。人的本性，伙计！

# sql - SQL 存储过程：条件返回

> ID：659033
> 
> 赞同：1
> 
> 时间：2009-03-18T16:31:26.297
> 
> 标签：sql, stored-procedures, branch

您好我想创建一个简单的存储过程，它执行以下操作：

伪代码

```
@tempSelect = "SELECT * FROM Table"

if (@Param is NULL) then
 exec @tempSelect
else
 exec @tempSelect + ' WHERE id = ' + @Param + ' 
```

这种方法有效吗？谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-18T16:33:26.463

尝试

```
select *
from table
where id=isnull(@param, id) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T16:34:11.610

Select * from Table where (ID = @Param or @Param is null)

或者

从 ID=Coalesce(@Param, ID) 的表中选择 *

[如果您的目标是效率，请将 * 替换为您要返回的特定字段。]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T16:35:42.137

是的——我当然认为它没有任何问题。你可以让它变得更简单：

```
Set NOCOUNT On;
if (@Param is NULL) 
   Select * From Table;
else 
   Select * From Table Where (ID=@Param); 
```

注意：不过，我可能会拼出这些字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T20:18:01.697

根据具体情况，我可能会使用动态 SQL。

但是，如果 @param 来自用户，您需要记住 SQL 注入，这就是为什么您永远不应该将参数直接添加到您的 sql 中。

在 t-sql 中，它看起来像（在我的脑海中并且未经测试；）：

```
DECLARE @SQL NVARCHAR(MAX)

SET @SQL = N'
  SELECT ...
  FROM   table t
  WHERE  1 = 1' (

IF(@param IS NOT NULL)
  SET @SQL = @SQL + '
    AND t.id = @id'

... possibly more things added to the query ...

EXEC sp_executesql 
   @SQL
, '@id AS INT'
,  @id = @Param 
```

通过这样做，您将获得针对每种情况的优化查询计划（并且通过使用 sp_executesql，也将使用查询缓存）

我会特别避免使用 OR 解决方案，如果您检查使用 OR 生成的查询计划与不使用 OR 生成的查询计划相比，您就会明白为什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-28T02:24:33.033

试试这个代码：

```
CREATE PROCEDURE [dbo].[ProcedureName]
@Param varchar(50)

AS
BEGIN

declare @tempSelect nvarchar(max)  

SET NOCOUNT ON;

set @tempSelect = 'SELECT Col1, Col2 FROM Table where Col1 <> '' '

         if @Param <> '' 
    begin
    set @resultSet = @resultSet +  ''' and Col1='''+@Param1 
    end

EXEC(@resultSet)

END 
```

# c# - XmlReader AppendChild 没有附加相同的子值

> ID：659034
> 
> 赞同：0
> 
> 时间：2009-03-18T16:31:53.317
> 
> 标签：c#, xml

```
XmlElement updateRecipient = doc.CreateElement("UpdateRecipient");
                XmlElement email = doc.CreateElement("EMAIL");
                XmlElement listID = doc.CreateElement("LIST_ID");
                XmlElement column = doc.CreateElement("COLUMN");
                XmlElement name = doc.CreateElement("NAME");
                XmlElement value = doc.CreateElement("VALUE")

                root.AppendChild(body);
                body.AppendChild(updateRecipient);
                updateRecipient.AppendChild(listID);
                listID.InnerText = _listID;
                updateRecipient.AppendChild(email);
                email.InnerText = _email;
                updateRecipient.AppendChild(column);
                column.AppendChild(name);
                name.InnerText = _columnNameFrequency;
                column.AppendChild(value);
                value.InnerText = _actionID.ToString();
                updateRecipient.AppendChild(column);
                column.AppendChild(name);
                name.InnerText = _columnNameStatus;
                column.AppendChild(value); 
```

出于某种原因，我最终在 updateRecipient 元素下只得到一个子列而不是两个。我需要像这样显示在 UpdateRecipient 节点下：

```
<UpdateRecipient>
<LIST_ID>85628</LIST_ID>
<EMAIL>somebody@domain.com</EMAIL>
<COLUMN>
<NAME>Frequency</NAME>
<VALUE>1</VALUE>
</COLUMN>
<COLUMN>
<NAME>Status</NAME>
<VALUE>Opted In</VALUE>
</COLUMN>
</UpdateRecipient> 
```

但到目前为止我只得到一个：

```
<UpdateRecipient>
<LIST_ID>85628</LIST_ID>
<EMAIL>somebody@domain.com</EMAIL>
<COLUMN>
<NAME>Status</NAME>
<VALUE>Opted In</VALUE>
</COLUMN>
</UpdateRecipient> 
```

当它到达第一个 AppendChild(column) 然后是 name 和 value 时，频率显示 find 但后来被 Status 覆盖，我希望它只在下面追加一个新的，我不确定为什么它会覆盖而不是添加另一个标签。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-18T16:43:10.403

问题是您正在重用“列”、“名称”和“值”变量。您需要为第二组创建新的 XmlElements。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T16:39:05.170

我不知道，但尝试以相反的顺序进行。这就是我一直在做的事情。在完成之前，不要将 updateRecipient 附加到根目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T19:53:19.433

以为您可以再次重用现有元素，但您不能..

# .net - .net AppSettings 历史琐事

> ID：659037
> 
> 赞同：1
> 
> 时间：2009-03-18T16:32:41.053
> 
> 标签：.net

我以前经常工作的开发人员之一，一直使用：

```
 ConfigurationSettings.AppSettings["Foo"].ToString() 
```

由于 AppSettings 集合项已经是字符串，这让我有点担心，但我想知道：早在 .net 1.0 和 1.1 的古老时代，集合是否将其项目存储为需要 ToString() 调用的 Object 类型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T16:36:21.230

不，`AppSettings`一直是一个`NameValueCollection`有`string`键有`string`值的。

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection(VS.71).aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-18T16:52:36.667

正如约翰已经提到的，`ConfigurationSettings.AppSettings`是一个`NameValueCollection`将它的项目作为字符串返回的。

就个人而言，我讨厌看到这种代码......人们将 ToString() 调用附加到几乎每个属性，无论它是否首先返回一个字符串。不幸的是，我经常看到它。我的猜测是它让人们感到安慰......不知何故，好像他们正在遵循推荐的编写漂亮代码的指南。:P

他们似乎没有意识到调用`ToString()`Null 对象会引发异常。例如，在您的示例中，如果 Configuration 的 AppSettings 部分中不存在“Foo”键，`NullReferenceException`则代码将抛出 a 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T16:39:12.720

没有 1.1 中的 appsettings 是字符串的 NameValueCollection，我正在查看 vs2003 中的解决方案，并且在获取 appsettings 时我还找到了 ToString()；也许这是开发人员的习惯

# c# - Web 服务无法序列化接口

> ID：659039
> 
> 赞同：9
> 
> 时间：2009-03-18T16:33:15.387
> 
> 标签：c#, web-services, serialization, interface

我有一个这样的界面：

```
public interface IDocument : ISerializable
{
    Boolean HasBeenUploaded { get; set; }
    void ISerializable.GetObjectData(SerializationInfo, StreamingContext) { }
} 
```

从这里继承了三个文档，所有这些文档都可以很好地序列化。但是当创建一个简单的 Web 服务时，它什么都不做，它们可以上传到...

```
public class DCService : System.Web.Services.WebService
{
    [WebMethod]
    public Boolean ReceiveDocument(IDocument document)
    {
        DBIO io = new DBIO();

        return io.InsertIntoDB(document); // does nothing; just returns true
    }
} 
```

我在尝试运行它时得到这个：“无法序列化接口 IDocument”

我不太确定为什么这会是一个问题。我知道[有些人](https://stackoverflow.com/questions/360208/enforcing-serializable-from-an-interface-without-forcing-classes-to-custom-serial)遇到了麻烦，因为他们不想强制子类实现自定义序列化，但我这样做了，到目前为止它已经成功了。

编辑>如果我创建接受实现接口的对象的单独 web 方法，它可以正常工作，但这会削弱客户端/服务器之间的合同（并首先破坏拥有接口的目的）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-18T17:13:31.157

您可能需要对 Web 方法使用 XmlInclude 属性。一个例子可以在[这里](http://www.pluralsight.com/community/blogs/craig/archive/2004/07/08/1580.aspx)找到。我们之前遇到过这个问题，并在客户端上的 Web 服务代理类和某些 Web 服务方法中添加了 XmlInclude 属性。

```
[WebMethod]
[XmlInclude(typeof(MyDocument))]
public Boolean ReceiveDocument(IDocument document)
{
    DBIO io = new DBIO();

    return io.InsertIntoDB(document); // does nothing; just returns true
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:24:52.467

Asp.net 必须能够知道在调用该方法时它将实例化哪个特定类。这就是为什么它在使用特定类定义多个方法时起作用的原因，即调用将告诉您使用哪个类。

考虑您是否希望客户端为任何文档发送相同的信息集，或者您是否确实需要能够为不同的文档发送不同的信息。使用后者，您需要客户端知道实现 IDocument 的类，并且您可以使用 XmlInclude 来完成此操作（如 firefly 发布的那样）。

如果您希望始终发送相同的信息而不是现在发送有关特定类的信息，请使用该信息定义一个类，这就是您在方法中收到的内容。如果您确实需要在服务代码的其余部分中使用 IDocument，请在服务中使用适当的逻辑，使用接收到的数据为您获取 IDocument 实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T00:17:25.137

+1 用于firefly，但是应该注意，XmlInclude 属性可以附加到 Web 服务**类**而不是每个方法（或基类型，这也是一个选项）。我已经测试过了，代码生成的很好，保持了继承结构。

我从他提到的同一个博客的评论部分得到了这个，所以归功于 OP。

顺便说一句，这不是对 firefly 帖子的评论，因为我没有足够的声誉来发表评论

# java - 使用 Java 小程序上传大文件

> ID：659043
> 
> 赞同：4
> 
> 时间：2009-03-18T16:33:37.710
> 
> 标签：java, file-upload, applet

我的任务是通过网络浏览器实现大型（2gb+）文件上传。在评估了各种技术之后，java applet 似乎是前进的方向（只有一个可以提供对本地磁盘的正确访问）。我想知道是否有人可以推荐我们可以用作基础的第 3 方文件上传应用程序？要求是

*   体面的 UI，理想情况下我们想要类似于 facebooks 照片上传器的东西
*   可以处理大 (2gb+) 文件
*   可恢复上传
*   我们将其扩展到我们的需求的来源（不介意支付额外费用）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T16:37:34.347

您可能正在寻找[JUpload](http://jupload.sourceforge.net/)。

更新：不确定它是否具有您希望的 UI，但除非您想像我一样构建自定义解决方案，否则它是您的最佳选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T16:51:35.000

只是一个提示，也许很明显，我不知道：P

以像 2mb 这样的块发送大文件很好，在服务器端，您只需将字节附加到目标文件。服务器知道它需要哪些字节，如果上传被中止并稍后继续，服务器可以发送一条消息，说明从哪些字节开始再次上传文件。然后我们得到可恢复性（这是一个词吗？：P）和大型 HTTP 上传的安全性（因为事实上，我们发送了许多 smuller 上传，并且每个上传都在服务器上检查是否具有正确的大小）。

我们曾经用一个 Java-applet 作为客户端和 PHP 在服务器上编写了一个这样的实现，我会看看我是否可以把它挖掘出来作为你的参考：p

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T16:39:55.060

不是真正的解决方案：根据经验，您可能会遇到以下问题：

*   通过 HTTPs 上传时的问题
*   通过代理上传的问题

只是想让您了解这两种情况，以便您在评估解决方案时进行测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-31T09:59:36.263

希望，你会在这里得到你的问题的解决方案.. [http://jupload.sourceforge.net/](http://jupload.sourceforge.net/)

# sql-server - 在创建临时表之前检查临时表是否存在，如果存在则删除

> ID：659051
> 
> 赞同：730
> 
> 时间：2009-03-18T16:34:33.810
> 
> 标签：sql-server, sql-server-2005, temp-tables, alter-table

我正在使用以下代码检查临时表是否存在，并在再次创建之前删除该表（如果存在）。只要我不更改列，它就可以正常工作。如果我稍后添加一列，它会给出“无效列”的错误。请让我知道我做错了什么。

```
IF OBJECT_ID('tempdb..#Results') IS NOT NULL
    DROP TABLE #Results

CREATE TABLE #Results
(
    Company                CHAR(3),
    StepId                TINYINT,
    FieldId                TINYINT,
)

select company, stepid, fieldid from #Results

--Works fine to this point

IF OBJECT_ID('tempdb..#Results') IS NOT NULL
    DROP TABLE #Results

CREATE TABLE #Results
(
    Company                CHAR(3),
    StepId                TINYINT,
    FieldId                TINYINT,
    NewColumn            NVARCHAR(50)
)

select company, stepid, fieldid, NewColumn from #Results

--Does not work 
```

* * *

## 回答 #1

> 赞同：792
> 
> 时间：2009-03-20T00:28:56.663

我无法重现该错误。

也许我不明白这个问题。

以下在 SQL Server 2005 中对我来说很好用，额外的“foo”列出现在第二个选择结果中：

```
IF OBJECT_ID('tempdb..#Results') IS NOT NULL DROP TABLE #Results
GO
CREATE TABLE #Results ( Company CHAR(3), StepId TINYINT, FieldId TINYINT )
GO
select company, stepid, fieldid from #Results
GO
ALTER TABLE #Results ADD foo VARCHAR(50) NULL
GO
select company, stepid, fieldid, foo from #Results
GO
IF OBJECT_ID('tempdb..#Results') IS NOT NULL DROP TABLE #Results
GO 
```

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2011-08-25T09:03:12.957

声明应该是有序的

1.  表的 Alter 语句
2.  去
3.  选择语句。

如果中间没有“GO”，整个事情将被视为一个单独的脚本，当 select 语句查找该列时，它不会被找到。

使用 'GO' ，它会将脚本中直到 'GO' 的部分视为一个批处理，并将在进入 'GO' 之后的查询之前执行。

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2015-12-13T04:56:47.073

您可以代替`dropping`并重新创建临时表`truncate`并重用它

```
IF OBJECT_ID('tempdb..#Results') IS NOT NULL
    Truncate TABLE #Results
else
    CREATE TABLE #Results
    (
        Company             CHAR(3),
        StepId              TINYINT,
        FieldId             TINYINT,
    ) 
```

如果您正在使用`Sql Server 2016`或`Azure Sql Database`然后使用以下语法删除临时表并重新创建它。更多信息在这里[**MSDN**](https://msdn.microsoft.com/en-us/library/ms173790.aspx)

**句法**

> 删除表 [如果存在] [数据库名称。[模式名称]。| 模式名称。] 表名 [ ,...n ]

**询问：**

```
DROP TABLE IF EXISTS tempdb.dbo.#Results
CREATE TABLE #Results
  (
   Company             CHAR(3),
   StepId              TINYINT,
   FieldId             TINYINT,
  ) 
```

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2017-07-12T07:40:36.077

我认为问题是您需要在两者之间添加 GO 语句以将执行分成批处理。作为第二个删除脚本，即`IF OBJECT_ID('tempdb..#Results') IS NOT NULL DROP TABLE #Results`没有删除临时表作为单个批次的一部分。你能试试下面的脚本吗？

```
IF OBJECT_ID('tempdb..#Results') IS NOT NULL
    DROP TABLE #Results

CREATE TABLE #Results
(
    Company                CHAR(3),
    StepId                TINYINT,
    FieldId                TINYINT,
)

GO

select company, stepid, fieldid from #Results

IF OBJECT_ID('tempdb..#Results') IS NOT NULL
DROP TABLE #Results

CREATE TABLE #Results
(
    Company                CHAR(3),
    StepId                TINYINT,
    FieldId                TINYINT,
    NewColumn            NVARCHAR(50)
)

GO

select company, stepid, fieldid, NewColumn from #Results 
```

* * *

## 回答 #5

> 赞同：52
> 
> 时间：2019-04-27T10:52:24.777

这可以通过一行代码来完成：

```
IF OBJECT_ID('tempdb..#tempTableName') IS NOT NULL DROP TABLE #tempTableName; 
```

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2012-08-31T20:51:31.630

这对我有用： [social.msdn.microsoft.com/Forums/en/transactsql/thread/02c6da90-954d-487d-a823-e24b891ec1b0?prof=required](http://social.msdn.microsoft.com/Forums/en/transactsql/thread/02c6da90-954d-487d-a823-e24b891ec1b0?prof=required)

```
if exists (
    select  * from tempdb.dbo.sysobjects o
    where o.xtype in ('U') 

   and o.id = object_id(N'tempdb..#tempTable')
)
DROP TABLE #tempTable; 
```

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2017-10-05T15:04:29.923

现在，如果您使用的是 SQL Server (2016+) 的新版本之一，则可以使用以下语法。

```
DROP TABLE IF EXISTS schema.yourtable(even temporary tables #...) 
```

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2014-06-06T22:14:13.823

只是我这边的一点评论，因为这`OBJECT_ID`对我不起作用。它总是返回

> `#tempTable 不存在

..即使它**确实**存在。我刚刚发现它以不同的名称（`_`下划线后缀）存储，如下所示：

`#tempTable________`

这对我很有效：

```
IF EXISTS(SELECT [name] FROM tempdb.sys.tables WHERE [name] like '#tempTable%') BEGIN
   DROP TABLE #tempTable;
END; 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2009-03-21T12:16:40.073

[pmac72](https://stackoverflow.com/a/664553/1501497)使用 GO 将查询分解成批次并使用 ALTER。

您似乎正在运行相同的批处理，但在更改后运行了两次： DROP... CREATE... edit... DROP... CREATE..

也许发布您的**确切**代码，以便我们了解发生了什么。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2020-07-10T07:33:58.373

这对我有用，

```
IF OBJECT_ID('tempdb.dbo.#tempTable') IS NOT NULL 
DROP TABLE #tempTable; 
```

这里 tempdb.dbo(dbo is nothing but your schema) 更重要。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2010-03-17T17:53:40.847

当我已经创建临时表时，我通常会遇到这个错误；检查 SQL 语句是否有错误的代码会看到“旧”临时表就位，并在后面的语句中返回对列数的错误计数，就好像临时表从未被删除一样。

在创建具有较少列的版本之后更改临时表中的列数后，删除该表，然后运行您的查询。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2017-03-06T09:17:46.657

我最近看到一个 DBA 做了类似的事情：

```
begin try
    drop table #temp
end try

begin catch 
    print 'table does not exist'
end catch 

create table #temp(a int, b int) 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2021-02-24T05:49:12.143

注意：这也适用于 ## 临时表。

IE

```
IF OBJECT_ID('tempdb.dbo.##AuditLogTempTable1', 'U') IS NOT NULL
DROP TABLE ##AuditLogTempTable1 
```

注意：这种类型的命令只适用于 SQL Server 2016 之后。问问自己 .. 我有任何客户仍在使用 SQL Server 2012 吗？

```
DROP TABLE IF EXISTS ##AuditLogTempTable1 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-05-09T19:54:18.840

我的代码使用了一个`Source`更改的表，以及一个`Destination`必须匹配这些更改的表。

```
-- 
-- Sample SQL to update only rows in a "Destination" Table
--  based on only rows that have changed in a "Source" table
--

--
-- Drop and Create a Temp Table to use as the "Source" Table
--
IF OBJECT_ID('tempdb..#tSource') IS NOT NULL drop table #tSource
create table #tSource (Col1 int, Col2 int, Col3 int, Col4 int)

--
-- Insert some values into the source
--
Insert #tSource (Col1, Col2, Col3, Col4) Values(1,1,1,1)
Insert #tSource (Col1, Col2, Col3, Col4) Values(2,1,1,2)
Insert #tSource (Col1, Col2, Col3, Col4) Values(3,1,1,3)
Insert #tSource (Col1, Col2, Col3, Col4) Values(4,1,1,4)
Insert #tSource (Col1, Col2, Col3, Col4) Values(5,1,1,5)
Insert #tSource (Col1, Col2, Col3, Col4) Values(6,1,1,6)

--
-- Drop and Create a Temp Table to use as the "Destination" Table
--
IF OBJECT_ID('tempdb..#tDest') IS NOT NULL drop Table #tDest
create table #tDest (Col1 int, Col2 int, Col3 int, Col4 int)

--
-- Add all Rows from the Source to the Destination
--
Insert #tDest
Select Col1, Col2, Col3, Col4 from #tSource

--
-- Look at both tables to see that they are the same
--
select *
from #tSource
Select *
from #tDest

--
-- Make some changes to the Source
--
update #tSource
    Set Col3=19
    Where Col1=1
update #tSource
    Set Col3=29
    Where Col1=2
update #tSource
    Set Col2=38
    Where Col1=3
update #tSource
    Set Col2=48
    Where Col1=4

--
-- Look at the Differences
-- Note: Only 4 rows are different. 2 Rows have remained the same.
--
Select Col1, Col2, Col3, Col4
from #tSource
except
Select Col1, Col2, Col3, Col4
from #tDest

--
-- Update only the rows that have changed
-- Note: I am using Col1 like an ID column
--
Update #tDest
    Set Col2=S.Col2,
        Col3=S.Col3,
        Col4=S.Col4
From    (   Select Col1, Col2, Col3, Col4
            from #tSource
            except
            Select Col1, Col2, Col3, Col4
            from #tDest
        ) S
Where #tDest.Col1=S.Col1 

--
-- Look at the tables again to see that
--  the destination table has changed to match
--  the source table.

select *
from #tSource
Select *
from #tDest

--
-- Clean Up
--
drop table #tSource
drop table #tDest 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-12-13T04:34:11.880

是的，“列无效”这个错误是从“从#Results 中选择公司、stepid、fieldid、NewColumn”行引发的。

运行t-sql有两个阶段，

首先，解析，在这个阶段sql server会检查你提交的sql字符串的更正，包括表的列，并优化你的查询以获得最快的检索。

第二，运行，检索数据。

如果表#Results 存在，则解析过程将检查您指定的列是否有效，否则（表不存在）解析将通过您指定的检查列。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-11-01T00:40:16.273

当您更改临时表中的列时，您必须在再次运行查询之前删除该表。（是的，这很烦人。正是你必须做的。）

我一直认为这是因为“无效列”检查是在查询运行之前由解析器完成的，所以它是基于表中的列在它被删除之前......这也是 pnbs 所说的。

# asp.net - 许可时限制 Web 应用程序的使用

> ID：659057
> 
> 赞同：1
> 
> 时间：2009-03-18T16:35:21.530
> 
> 标签：asp.net, sharepoint, web-applications

我只是对我为 SharePoint 创建的 Web 应用程序的许可解决方案做一些最后的润色。我希望能够在许可证无效时阻止页面加载 Web 应用程序内容。我尝试了以下...

```
 protected override void Render(HtmlTextWriter writer)
    {
        if (LicensingInformation.Status == Status.Active)
        {
           base.Render(writer);
        }
    } 
```

但它会杀死页面上的所有内容，我仍然想查看母版页和我创建的用于向用户显示反馈的 jquery 对话框。

有没有人有什么建议？

非常感激

菲尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T16:38:16.983

建议？

*   重定向到“无效的许可页面”
*   为要隐藏的内容设置`Visible`一些控件的属性`Panel`
*   禁用控件的呈现而不是页面的呈现
*   ...

# c - 如何使用指针在数组中显示字符串？

> ID：659064
> 
> 赞同：4
> 
> 时间：2009-03-18T16:36:06.630
> 
> 标签：c, pointers, string

我正在练习使用指针。

我有一个指向 3 个字符串数组的指针：“dog”、“cat”、“rat”。

`for`我可以使用循环和数组打印内容。

但是，我在使用指针算术打印它们时遇到问题。我想增加指向数组中下一个元素的指针。然而，它所做的只是打印狗字母。

### 代码：

```
int main(int argc, char **argv)
{
    char *str[3] = { "DOG", "CAT", "RAT"};
    int i = 0;

    /* display using an array element */
    for(i = 0; i < 3; i++)
    {
    printf("str: %s\n", str[i]);
    }

    /* display using a pointer arthimatic */
    while((*str)++)
    {
    printf("str: %s\n", str);
    }

    getchar();

    return 0;
} 
```

我怎样才能做到这一点？

编辑：

### 代码：

```
while(str)
{
    printf("str: %s\n", *(str++));
} 
```

但是，我收到此错误消息。I值不是必须是某种变量吗？

错误 C2105：“++”需要左值

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-18T16:49:00.403

您首先必须获得一个指针，并且您需要一个何时停止的条件。可以使用最后一个 NULL 指针。所以代码变成了

```
char *str[] = { "DOG", "CAT", "RAT", NULL };
char **elem_p = str;

/* display using a pointer arthimatic */
while(*elem_p) {
    printf("str: %s\n", *elem_p);
    elem_p++;
} 
```

您所做的是增加存储在数组第一个元素中的指针。该指针永远不会很快等于空指针（如果有的话），因此，循环不会停止，直到该指针的内部值溢出或发生其他事情以使其等于空指针。然后，您将指向数组第一个元素的指针传递给`printf`（您传递数组，但编译器会将其转换为指针 - 见下文）。`Printf`会将这些指针的字节解释为字符并打印它们，如果它没有立即崩溃，则会导致垃圾打印出来。

相反，您希望在更高级别递增：不要递增数组的一个元素（指针），而是递增指向元素本身的指针。现在，你做不到

```
str++ 
```

因为`str`是一个数组。它不是指针，即使它可以转换为指针，然后指针将指向它的第一个元素。因此，我们创建了一个最初指向的指针`str[0]`，但又将其全部递增。请注意，我们在打印后递增它，以便我们也打印出第一个元素。

实际上，我想我应该解释为什么你不能这样做`str++`。嗯，`str`是一个数组。数组是占用一定存储量的对象。上面，数组占用 char 指针大小的 4 倍，`4 * sizeof(char*)`. 乍一看像指针的东西是同一类型的元素块。对于寻址元素，编译器可以从表达式中的数组组成一个指针，然后可以使用该指针来寻址数组中的元素。如果你这样做`str++`，编译器将为你创建一个指针。但是那个指针是临时的，只存在一小段时间，唯一的目的是立即用它做某事，但它不能像增加一样被改变。这就是我们创建一个真正的指针变量的原因，然后我们可以增加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T16:44:04.160

您的代码的问题是您正在递增取消引用的指针 str，这为您提供了一个 char * 到数组中的第一个元素（即 dog）。

您应该增加 str 本身，而不是它指向的内容。

但是，在这种情况下，您的循环终止检查将不起作用，因为此时数组中没有元素 str == 0 成立。为了让它工作，您需要向数组中添加第四个元素，即 0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T16:44:52.317

```
(*str)++ 
```

增加 指向的值`s`。您将需要增加指针本身并打印指针的值。请注意， str 不是左值，您也不能增加它。

此外，如果您先递增，则只剩下两个可以打印的合法字符串。之后你调用 UB。

试试这个：

```
int main(void)
{
    /* we have added a sentinel to mark the end of the array */
    char *str[] = { "DOG", "CAT", "RAT", 0 };
    /* since str is an array, you cannot use it to loop, have a walker */
    char **w = str;

    /* display using a pointer arthimatic */
    while(*w)
    {
        printf("str: %s\n", *w++);
    }

    return 0;
} 
```

在 C 中查找运算符优先级和绑定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T16:49:46.893

`str`，作为一个数组，不能递增。

现在，您正在递增`(*str)`，即`str[0]`：该数组的第一个元素。由于此元素是一个指针，因此您正在递增指针，使其引用字符串“DOG”的后续元素。

您需要的是一个可以指向（并因此越过）`str`的元素的指针。由于元素是`char*`，指向它们的指针将是`char**`- 双指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T16:46:21.113

```
while((*str)++)    
{        printf("str: %s\n", str);    } 
```

这增加了*str，它是字母'd'。你不想那样做。你想增加指针。这段代码应该做你想做的事：

```
while((str)++)    
{        printf("str: %s\n", str);    } 
```

# postgresql - 如何使用 utf-8 中的数据库在 Postgres 8.3.x 中进行不区分重音的搜索？

> ID：659076
> 
> 赞同：5
> 
> 时间：2009-03-18T16:38:06.563
> 
> 标签：postgresql, diacritics, case-sensitive

试过 select to_ascii('capo','LATIN1'), to_ascii('çapo','LATIN1') 结果不一样......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T17:06:44.497

看[这里](http://www.laudatio.com/wordpress/2008/11/05/postgresql-83-to_ascii-utf8)。

```
CREATE FUNCTION to_ascii(bytea, name)
RETURNS text STRICT AS 'to_ascii_encname' LANGUAGE internal; 
```

然后像这样使用它：

```
SELECT to_ascii(convert_to('Übermeier', 'latin1'), 'latin1'); 
```

# zend-framework - 在发布失败时使用 zend_dojo 元素触发无效消息

> ID：659084
> 
> 赞同：0
> 
> 时间：2009-03-18T16:39:55.123
> 
> 标签：zend-framework, dojo, zend-form

我在使用 Dojo 元素处理用户验证的 Zend_Form 方面遇到了一些问题。

场景是用户填写表单时，dojo 元素确保格式正确。在表单发布时，如果存在错误（例如数据库中已经存在的电子邮件地址），我的代码会抛出我捕获的异常，然后我想使用 dojo 验证来显示错误，而不是在顶部显示错误消息或表格底部。

我尝试了以下方法：

```
catch(Exception $e){
  $signupForm->populate($formData);
  $signupForm->getElement('email')->setInvalidMessage('email addresss already exists');
  $this->view-form = $signupForm;
} 
```

这会重新显示表单，但不会突出显示 dojo 元素以显示失败的元素。如何做到这一点，或者我将不得不在列表中的某处显示错误消息？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T00:55:15.730

你看过[Zend_Dojo_Form](http://framework.zend.com/manual/en/zend.dojo.form.html)吗？

# mysql - 有没有更快的方法来备份和恢复mysql？

> ID：659089
> 
> 赞同：4
> 
> 时间：2009-03-18T16:41:25.120
> 
> 标签：mysql, backup, database-restore

Sql Server 和 Oracle 拥有像 Idera (Sql Safe) 和 Quest (LiteSpeed) 这样的商业产品，可以显着加快备份和恢复速度。

mysql有这样的商业软件吗？

我正在处理 mysql 中的大量数据，如果我们必须恢复它需要 8-10 个小时。所以我希望转向可以更快地完成的商业产品。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T16:49:51.650

[MySQL 备份和恢复数据库软件 7.0](http://download.cnet.com/MySQL-Backup-Restore-Databases-Software/3000-10254_4-127600.html)就是其中之一，但**恢复备份**主要是一长串 INSERT 语句，因此您可以在此处查看有关提高[INSERT 语句速度的提示](http://dev.mysql.com/doc/refman/5.0/en/insert-speed.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:23:59.007

您可以查看[xtrabackup](http://www.percona.com/docs/wiki/percona-xtrabackup:start)。它仍然是 alpha 版本，但根据[上次发布公告](http://www.mysqlperformanceblog.com/2009/03/13/xtrabackup-03-binaries-and-stream-backup/)，它“在我们的测试中显示出完美的稳定结果”。

没试过就知道性能了，但是好像比mysqldump生成的sql输出还要低级。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T20:07:44.843

如果商业选项适合您，请查看[InnoDB 热备份](http://www.innodb.com/hot-backup/features/)。他们说备份时间与文件复制时间相当，恢复速度更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:06:15.007

在线备份并不完全符合您的要求。现有的 MySQL 工具没有提供其他 DBMS 供应商拥有的很多功能。如果启用 MySQL 二进制日志，则可以进行“时间点”恢复。但是，初始加载仍然需要很长时间。

[http://dev.mysql.com/doc/refman/5.1/en/binary-log.html](http://dev.mysql.com/doc/refman/5.1/en/binary-log.html)

[http://dev.mysql.com/doc/refman/5.1/en/point-in-time-recovery.html](http://dev.mysql.com/doc/refman/5.1/en/point-in-time-recovery.html)

# multithreading - 记录和同步

> ID：659094
> 
> 赞同：3
> 
> 时间：2009-03-18T16:42:30.060
> 
> 标签：multithreading, delphi, synchronization, delphi-2009

我刚刚编写了自己的日志框架（非常轻量级，不需要大型日志框架）。它由一个接口 ILogger 和许多实现该接口的类组成。我有一个问题是 TGUILogger，它将 TStrings 作为日志记录目标并将日志记录与主线程同步，以便列表框的 Items 成员可以用作目标。

```
type
  ILogger = Interface (IInterface)
    procedure Log (const LogString : String; LogLevel : TLogLevel);
    procedure SetLoggingLevel (LogLevel : TLogLevel);
  end;

type    
  TGUILogger = class (TInterfacedObject, ILogger)
  public
    constructor Create (Target : TStrings);
    procedure Log (const LogString : String; LogLevel : TLogLevel);
    procedure SetLoggingLevel (LogLevel : TLogLevel);
  private
    procedure PerformLogging;
  end;

procedure TGUILogger.Log (const LogString : String; LogLevel : TLogLevel);
begin
  TMonitor.Enter (Self);
  try
    FLogString := GetDateTimeString + ' ' + LogString;
    TThread.Synchronize (TThread.CurrentThread, PerformLogging);
  finally
    TMonitor.Exit (Self);
  end;
end;

procedure TGUILogger.PerformLogging;
begin
  FTarget.Add (FLogString);
end; 
```

日志记录有效，但应用程序未正确关闭。它似乎挂在 Classes 单元中。堆栈跟踪：

System.Halt0、System.FinalizeUnits、Classes.Finalization、Classes.FreeExternalThreads、System.TObject.Free、Classes.TThread.Destroy、Classes.TThread.RemoveQueuedEvents

我在这里做错了什么？

编辑：我刚刚在 TThread.StaticSynchronize 的 Delphi 帮助中找到了以下提示

```
Warning: Do not call StaticSynchronize from within the main thread. This can cause 
an infinite loop. 
```

这可能正是我的问题，因为一些日志记录请求来自主线程。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-18T17:51:57.587

如果将 CurrentThreadID 与 MainThreadID 进行比较，则可以选择是否同步。

就个人而言，我选择让 GUI 向日志系统询问最新信息，而不是让线程暂停。否则，您的日志记录会干扰线程的快速操作，从而破坏了拥有它的目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T17:21:14.460

如果您没有找到任何更简单的方法，您可以尝试这样做：

在程序初始化时，（从主线程）让您的日志子系统调用 Windows API 函数 GetCurrentThreadID 并将结果存储在一个变量中。（编辑：系统单元中的 MainThreadID 变量，在启动时会自动为您初始化。谢谢，mghie。）当日志请求进入之后，再次调用 GetCurrentThreadID，并且仅在它来自不同线程时进行同步。

还有其他不涉及 Windows API 的技巧，但它们最终变得更加复杂，特别是如果您有一堆不同的自定义 TThread 后代。不过，基本原则是相同的：在决定是否调用 StaticSynchronize 之前，请先验证您是否在主线程中。

# css - 需要使基于 div 和 css 的页面在 IE 7 中工作

> ID：659103
> 
> 赞同：0
> 
> 时间：2009-03-18T16:44:30.463
> 
> 标签：css, layout, html, internet-explorer-7

我正在开发一个需要使用 div 标签和 css 构建页面的项目。这些页面在 Firefox、Opera、Safari 和 IE 8 中看起来不错，但是我使用 IE7 的客户抱怨 IE 7 中的布局问题。有人可以看看并告诉我如何修复代码，以便它可以在所有浏览器，尤其是 IE 7？链接和css代码如下。谢谢。

主页在这里：（代码如下） [http://www.danieldicenso.20m.com/citybeams/](http://www.danieldicenso.20m.com/citybeams/)

```
/* HOME PAGE CSS CODE */
body {font-size:12px; font-family:"trebuchet MS", verdana, arial, sans-serif; background: #CCCCCC; word-wrap:break-word;}

#wrapper {
    text-align: left;
    margin: 0px auto;
    padding: 0px;
    border:0;
    width: 1000px;
    background: #FFFFFF;
}

#header {
    margin: 0 0 15px 0;
    background: #ffffff;
}

#side-a {
    float: left;
    width: 300px;
}

#side-b {
    float: right;
    width: 300px;
}

#content { 
    float: left;
    width: 400px;
}

#footer {
    clear: both;
    background: #ffffff;
}

.curvy2 {
    position:relative;
    width:250px;
    color:#000;
    margin-top: 1em;
    margin-right: auto;
    margin-bottom: 1em;
    margin-left: auto;
    background-color: #99FF99;
    background-image: url(bl.gif);
    background-repeat: no-repeat;
    background-position: left bottom;

}
#ctl, #cbl, #ctr, #cbr {position:absolute; width:20px; height:20px; color:#327734; background:#fff; background-image:url(metalgreen2.jpg); overflow:hidden; font-style:normal; z-index:1;}
#ctl {top:0; left:0;}
#cbl {bottom:0; left:0;}
#ctr {top:0; right:0;}
#cbr {bottom:0; right:0;}
.curvy em b {position:absolute; font-size:150px; font-family:arial; color:#327834; line-height:40px; font-weight:normal;}
#ctl b {left:-8px;}
#ctr b {left:-25px;}
#cbl b {left:-8px; top:-17px;}
#cbr b {left:-25px; top:-17px;}
.curvy p {position:relative; z-index:100; padding:5px 10px;}

.bl {
    width: 330px;
    background-color: #99ff99;
    background-image: url(bl.gif);
    background-repeat: no-repeat;
    background-position: 0 100%;
}
.br {background: url(br.gif) 100% 100% no-repeat}
.tl {background: url(tl.gif) 0 0 no-repeat}
.tr {background: url(tr.gif) 100% 0 no-repeat; padding:10px}
.clear {font-size: 1px; height: 1px} 

.bl2 {
    width: 330px;
    background-color: #ffffff;
    background-image: url;
    background-repeat: no-repeat;
    background-position: 0 100%;
}
.br2 {background: url100% 100% no-repeat}
.tl2 {background: url 0 0 no-repeat}
.tr2 {background: url 100% 0 no-repeat; padding:10px}
.clear2 {font-size: 1px; height: 1px
} 

#navmenu {
    position: relative;
    left: 16px;
    top: 0px;
    width: 712px;
    height: 22px;
    z-index: 2;
    background: #99FF99;
    text-align: center;
    padding: 0px;
    }

body,td,th {
    color: #000000;
}
a:link {
    color: #003333;
}
a:visited {
    color: #000066;
}
a:active {
    color: #FF0000;
}

--------------------

Sign-up page is here:  (CSS Code below)
http://www.danieldicenso.20m.com/citybeams/signuppage.html

/* SIGNUP PAGE CSS CODE */
body {font-size:12px; font-family:"trebuchet MS", verdana, arial, sans-serif; background: #CCCCCC; word-wrap:break-word;}

#wrapper {
    text-align: left;
    margin: 0px auto;
    padding: 0px;
    border:0;
    width: 1000px;
    background: #FFFFFF;
}

#header {
    margin: 0 0 15px 0;
    background: #ffffff;
}

#side-a {
    float: left;
    width: 100px;
}

#side-b {
    float: right;
    width:100px;
}

#content { 
    float: left;
    width: 800px;
}

#footer {
    clear: both;
    background: #ffffff;
}

.curvy2 {
    position:relative;
    width:250px;
    color:#000;
    margin-top: 1em;
    margin-right: auto;
    margin-bottom: 1em;
    margin-left: auto;
    background-color: #99FF99;
    background-image: url(bl.gif);
    background-repeat: no-repeat;
    background-position: left bottom;

}
#ctl, #cbl, #ctr, #cbr {position:absolute; width:20px; height:20px; color:#327734; background:#fff; background-image:url(metalgreen2.jpg); overflow:hidden; font-style:normal; z-index:1;}
#ctl {top:0; left:0;}
#cbl {bottom:0; left:0;}
#ctr {top:0; right:0;}
#cbr {bottom:0; right:0;}
.curvy em b {position:absolute; font-size:150px; font-family:arial; color:#327834; line-height:40px; font-weight:normal;}
#ctl b {left:-8px;}
#ctr b {left:-25px;}
#cbl b {left:-8px; top:-17px;}
#cbr b {left:-25px; top:-17px;}
.curvy p {position:relative; z-index:100; padding:5px 10px;}

.bl {
    width: 330px;
    background-color: #99ff99;
    background-image: url(bl.gif);
    background-repeat: no-repeat;
    background-position: 0 100%;
}
.br {background: url(br.gif) 100% 100% no-repeat}
.tl {background: url(tl.gif) 0 0 no-repeat}
.tr {background: url(tr.gif) 100% 0 no-repeat; padding:10px}
.clear {font-size: 1px; height: 1px} 

.bl2 {
    width: 330px;
    background-color: #ffffff;
    background-image: url;
    background-repeat: no-repeat;
    background-position: 0 100%;
}
.br2 {background: url100% 100% no-repeat}
.tl2 {background: url 0 0 no-repeat}
.tr2 {background: url 100% 0 no-repeat; padding:10px}
.clear2 {font-size: 1px; height: 1px} 

#navmenu {
    position: relative;
    left: 16px;
    top: 0px;
    width: 712px;
    height: 22px;
    z-index: 2;
    background: #99FF99;
    text-align: center;
    padding: 0px;
}
.signupfield {
    float: none;
    width:480px;
    color:#000;
    margin-top: 1em;
    margin-right:1 em;
    margin-bottom: 1em;
    position: relative;
    left: 75px;
    background-color: #99FF99;
    background-image: url(bl.gif);
    background-repeat: no-repeat;
    background-position: left bottom;   
}
----------------------------------

Reviews page example is here: (CSS code below)
http://www.danieldicenso.20m.com/citybeams/reviewers.html

/* REVIEW PAGE CSS CODE */
body {font-size:12px; font-family:"trebuchet MS", verdana, arial, sans-serif; background: #CCCCCC; word-wrap:break-word;}

#wrapper {
    text-align: left;
    margin: 0px auto;
    padding: 0px;
    border:0;
    width: 1000px;
    background: #FFFFFF;
}

#header {
    margin: 0 0 15px 0;
    background: #ffffff;
}

#side-a {
    float: left;
    width: 50px;
}

#side-b {
    float: right;
    width: 200px;
}

#content { 
    float: left;
    width: 750px;
}

#footer {
    clear: both;
    background: #ffffff;
}

.curvy2 {
    position:relative;
    width:250px;
    color:#000;
    margin-top: 1em;
    margin-right: auto;
    margin-bottom: 1em;
    margin-left: auto;
    background-color: #99FF99;
    background-image: url(bl.gif);
    background-repeat: no-repeat;
    background-position: left bottom;

}
#ctl, #cbl, #ctr, #cbr {position:absolute; width:20px; height:20px; color:#327734; background:#fff; background-image:url(metalgreen2.jpg); overflow:hidden; font-style:normal; z-index:1;}
#ctl {top:0; left:0;}
#cbl {bottom:0; left:0;}
#ctr {top:0; right:0;}
#cbr {bottom:0; right:0;}
.curvy em b {position:absolute; font-size:150px; font-family:arial; color:#327834; line-height:40px; font-weight:normal;}
#ctl b {left:-8px;}
#ctr b {left:-25px;}
#cbl b {left:-8px; top:-17px;}
#cbr b {left:-25px; top:-17px;}
.curvy p {position:relative; z-index:100; padding:5px 10px;}

.bl {
    width: 330px;
    background-color: #99ff99;
    background-image: url(bl.gif);
    background-repeat: no-repeat;
    background-position: 0 100%;
}
.br {background: url(br.gif) 100% 100% no-repeat}
.tl {background: url(tl.gif) 0 0 no-repeat}
.tr {background: url(tr.gif) 100% 0 no-repeat; padding:10px}
.clear {font-size: 1px; height: 1px} 

.bl2 {
    width: 330px;
    background-color: #ffffff;
    background-image: url;
    background-repeat: no-repeat;
    background-position: 0 100%;
}
.br2 {background: url100% 100% no-repeat}
.tl2 {background: url 0 0 no-repeat}
.tr2 {background: url 100% 0 no-repeat; padding:10px}
.clear2 {font-size: 1px; height: 1px} 

#navmenu {
    position: relative;
    left: 16px;
    top: 0px;
    width: 712px;
    height: 22px;
    z-index: 2;
    background: #99FF99;
    text-align: center;
    padding: 0px;
    }
.signupfield {
    position:relative;
    width:480px;
    color:#000;
    margin-top: 1em;
    margin-right: auto;
    margin-bottom: 1em;
    margin-left: -120px;
    background-color: #99FF99;
    background-image: url(bl.gif);
    background-repeat: no-repeat;
    background-position: left bottom;

}

body,td,th {
    color: #000000;
}
a:link {
    color: #003333;
}
a:visited {
    color: #000066;
}
a:active {
    color: #FF0000;
}
#selectionbar {
    position: relative;
    left: 0px;
    top: 0px;
    width: 750px;
    height: 22px;
    z-index: 2;
    background: #ffffff;
    padding: 0px;
}
#selectionbartwo {
    position: relative;
    left: 0px;
    top: -10px;
    width: 750px;
    height: 22px;
    z-index: 2;
    background: #ffffff;
    padding: 0px;
}

#selectionbarthree {
    position: relative;
    left: 0px;
    top: -10px;
    width: 750px;
    height: 22px;
    z-index: 2;
    background: #ffffff;
    padding: 0px;
}

#dividerline {
    position: relative;
    left: 0px;
    top: -4px;
    width: 750px;
    height: 1px;
    z-index: 2;
    background: #ffffff;
    padding: 0px;
}
#results {
    position: relative;
    left: 55px;
    top: -14px;
    width: 600px;
    height: 1px;
    z-index: 2;
    background: #ffffff;
    padding: 0px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-18T17:09:06.020

如果默认边距和填充确实是您的问题，正如 Ryan 所建议的那样，您可以使用以下语句强制每个元素具有相同的基本边距和填充：

```
* {
   margin: 0px;
   padding: 0px;
} 
```

请注意，这也可能会破坏您在其他浏览器中的布局，但至少它们都会以完全相同的方式被破坏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T16:53:41.500

IE7 的边距和填充的默认值和行为与​​其他浏览器不同。快速查看 IE7 中的页面表明这可能是您的大部分问题所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T08:46:56.467

不要使用

```
*{margin: 0px;padding: 0px;} 
```

您不想为实际需要默认值的 html 元素重写整个站点。

使用[CSS 重置](http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/)

使用 xhtml 和 css 有效代码

并修复[常见错误](http://www.positioniseverything.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T08:52:33.117

您可以强制您的 IE8 像 IE7 一样呈现页面并自己检查布局。阅读：http: [//blogs.msdn.com/ie/archive/2008/08/27/introducing-compatibility-view.aspx](http://blogs.msdn.com/ie/archive/2008/08/27/introducing-compatibility-view.aspx)

利用：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /> 
```

但仅用于调试

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T17:09:58.840

您可以尝试使用 padding 来偏移 navmenu，而不是使用 position:relative 和 left。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T08:58:34.363

要测试您的页面在 IE7 中的外观而无需使用元标记技巧或类似方法，您可以从此处下载虚拟沙盒浏览器：[http](http://www.xenocode.com/browsers/) ://www.xenocode.com/browsers/非常适合测试 Web 应用程序。

# iis - 经典 ASP 站点更新后神秘出现需要 NT 身份验证？

> ID：659105
> 
> 赞同：1
> 
> 时间：2009-03-18T16:44:52.707
> 
> 标签：iis, asp-classic

开发人员将他们的代码从暂存站点（需要身份验证）发布到实时公共站点（不应该），突然现场站点需要身份验证（这不好）。

他们无权更改服务器上的任何设置，并且没有从实时站点上的代码调用到暂存站点上的任何内容，我可以找到。（不会忘记调用暂存站点上的图像或任何东西）

该小组是否可以想到某些可能已被删除/更改的文件可能导致这种情况发生？我也检查了这个问题 - [通过 IIS 在 ASP Classic 中进行 HTTP 身份验证] - 但没有使用这些方法。

App是Classic ASP，IIS6.0服务器。安全设置 - 在实时站点上允许匿名访问。匿名 Internet 用户帐户允许对站点所在目录进行读取访问 - 用户无法更改服务器上的目录或站点权限。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T17:00:02.703

在 IIS 中关闭匿名访问时，用户将受到挑战。什么是安全设置？没有这些信息，我们将无能为力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T17:01:53.307

文件是否保留了从它们复制的文件夹中的安全权限？重置文件的权限。

您是否使用由四部分组成的 URL 来访问该站点 ( [http://www.somesite.com/](http://www.somesite.com/) )？这将默认为 Internet 区域而不是 Intranet，提示进行身份验证。

# apache-flex - 等待 SWFLoader 加载 swf 文件

> ID：659106
> 
> 赞同：1
> 
> 时间：2009-03-18T16:44:58.900
> 
> 标签：apache-flex, flash, swfloader

目前我正在开发一个大量使用外部 SWF 的应用程序 (Flex)。我想创建一个静态方法，它将文件名作为参数并返回包装在其他类中的 SWF。

```
public static function getSWFWrapperFromFile(path:string):SWFWrapper {
   var loader:SWFLoader = new SWFLoader();
   loader.addListener(Event.COMPLETE, onLoad);
   loader.load(path);
   // If I create new SWFWrapper object here and try to assign it the loader.content  I get null reference

  } 
```

但是，使用这种方法，由于非阻塞 load() 和 onLoad 处理程序的需要，我无法将逻辑封装在一个函数中。调用加载方法后是否有可能强制延迟？或者也许还有另一种更好的方法？

谢谢你，阿朗佐

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T15:54:44.720

显示列表是为异步加载精心设计的。您会注意到 Loader 是一个 DisplayObject 派生类，因此可以直接放在显示列表中。当它的内容被加载时，它将成为 Loader 的子节点。因此，如果 SWFWrapper 是 DisplayObject 派生的，您只需在代码末尾执行以下操作：

```
 var wrapper:SWFWrapper = new SWFWrapper();
wrapper.addChild(loader);
return wrapper; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T19:02:09.680

就像其他人说的，你不能那样做。但是，看看[BulkLoader](http://code.google.com/p/bulk-loader/) AS3 库，它可以减轻您同时管理多个加载器并等待它们完成的负担。它有据可查，并且只需要几行即可使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T16:55:19.593

您需要等到您的`Loader`对象完成。尝试添加事件处理程序。是的，当你有多个装载机并且必须等到最后一个装载机完成后，整个事情变得模糊不清。但是，如果您要使用 SWFLoader，情况就是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T16:56:12.760

在 Flash 中，你不能阻塞一个方法——你总是必须使用 onLoad 处理程序来加载数据。（as3 执行模型是单线程的，如果你阻塞在一个方法中，程序的其余部分将不会被执行）

# language-agnostic - 构造变量嵌套循环的好方法是什么？

> ID：659117
> 
> 赞同：3
> 
> 时间：2009-03-18T16:48:07.553
> 
> 标签：language-agnostic, refactoring, coding-style, nested-loops

假设您正在使用一种具有可变长度数组的语言（例如 with `A[i]`for all `i`in `1..A.length`）并且必须编写一个例程，该例程采用`n`( `n : 1..8`) 可变长度数组中的可变长度数组`n`，并且需要调用每个可能长度`n`的项目数组，其中第一个是从第一个数组中选择的，第二个是从第二个数组中选择的，依此类推。

如果您想要将具体的东西可视化，请想象您的例程必须获取如下数据：

```
[ [ 'top hat', 'bowler', 'derby' ], [ 'bow tie', 'cravat', 'ascot', 'bolo'] ... ['jackboots','galoshes','sneakers','slippers']] 
```

并进行以下过程调用（以任何顺序）：

```
try_on ['top hat', 'bow tie', ... 'jackboots']
try_on ['top hat', 'bow tie', ... 'galoshes']
 :
try_on ['derby','bolo',...'slippers'] 
```

这有时被称为中文菜单问题，并且 for fixed`n`可以很简单地编码（例如 for `n`= 3，在伪代码中）

```
procedure register_combination( items : array [1..3] of vararray of An_item)
    for each i1 from items[1]
        for each i2 from items[2]
            for each i3 from items[3]
                register( [ii,i2,i3] ) 
```

但是如果`n`可以变化，给出如下签名：

```
procedure register_combination( items : vararray of vararray of An_item) 
```

编写的代码包含一个丑陋的 case 语句，我用一个更简单的解决方案替换了它。但我不确定这是重构它的最佳（当然也不是唯一）方法。

你会怎么做？聪明和令人惊讶是好的，但清晰和可维护更好——我只是通过这段代码，不想被回调。简洁、清晰*和*聪明将是理想的。

编辑：在其他人有机会回应之后，我将在今天晚些时候发布我的解决方案。

Teaser：我试图推销递归解决方案，但他们不接受，所以我不得不坚持在 HLL 中编写 fortran。

我选择的答案，发布在下面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T17:00:18.350

递归算法

```
procedure register_combination( items )
        register_combination2( [], items [1:] )

procedure register_combination2( head, items)
    if items == []
        print head
    else
       for i in items[0]
           register_combination2( head ++ i, items [1:] ) 
```

或者与优化的尾部调用相同，使用数组作为索引，并增加最后一个索引直到它达到相应数组的长度，然后向上进行增量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T16:55:42.353

递归。

或者，更好的是，尝试使用类似堆栈的结构和 while 语句来消除递归。

对于您所说的问题（调用带有可变参数的函数），它完全取决于您正在编码的编程语言；其中许多允许传递可变参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T17:50:35.897

因为他们反对递归（不要问），而我反对凌乱的案例陈述（事实证明，这是隐藏[了一个错误](https://stackoverflow.com/questions/666820/whats-wrong-with-this-algorithm)），所以我选择了这个：

```
procedure register_combination( items : vararray of vararray of An_item)
    possible_combinations = 1
    for each item_list in items
        possible_combinations = possible_combinations * item_list.length
    for i from 0 to possible_combinations-1
        index = i
        this_combination = []
        for each item_list in items
            item_from_this_list = index mod item_list.length
            this_combination << item_list[item_from_this_list]
            index = index div item_list.length
        register_combination(this_combination) 
```

基本上，我计算出有多少组合，为每个组合分配一个数字，然后循环遍历产生相应组合的数字。我怀疑这不是一个新把戏，但值得知道。

它更短，适用于列表长度的任何实际组合（如果有超过 2^60 个组合，它们还有其他问题），不是递归的，也没有[错误](https://stackoverflow.com/questions/666820/whats-wrong-with-this-algorithm)。

# .net - 如何增加.NET 的堆大小？

> ID：659119
> 
> 赞同：21
> 
> 时间：2009-03-18T16:48:09.907
> 
> 标签：.net, memory

.NET 中是否存在与`java -Xmx`内存大小分配相对应的内容？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-18T16:56:40.730

[该线程](http://bytes.com/groups/net-c/683386-how-set-max-heap-size-c)看起来正是您想要的。

如果我正确地阅读了 MVP 的帖子，那么在 32 位系统上，无论如何你都被限制为 1.5GB 堆大小，一旦进程开始，你就会得到所有这些。在 64 位系统上，您的堆基本上是无限的，我认为任何主流服务器或 PC 都无法容纳 64 位进程可以处理的物理内存。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-08-05T15:19:26.160

据我所知，没有简单的方法可以使用 CLR 控制 .Net 应用程序的堆大小。

@Dave 答案中的链接只回答了一半的问题。当我研究了同样的问题时，响应是“堆增长到使用所有可用内存”，好像这是您想要控制最大堆大小的唯一原因。

在（通常是 Java）服务器环境中，您不希望表现不佳的应用程序以牺牲其他托管应用程序为代价来占用内存。一个简单的解决方案是限制应用程序可用于其堆的内存量。这是通过 Java 的 -Xmx 参数完成的，因此您可以保证应用程序不会使用超出计划的内容，例如 -Xmx256M。由于在初始化期间在堆上分配内存会减慢应用程序的启动速度，Java 使用 -Xms 参数来允许在初始化期间执行大量对象创建的应用程序以一大块堆开始，而不是 JVM 不断调整堆的大小去。

.Net的CLR没有这个能力。我怀疑这是因为 .Net 的 CLR 不是虚拟机。CLR 恰好是一个 API（相当全面，我可能会补充），它充当本机 .dll 的适配器，在内存管理方面，它等同于一种更像可执行文件的方法。

我已经问过有关 SharePoint 开发的这个问题，并且确实听说可以通过使用称为 Web 应用程序的 IIS 模块来控制堆大小，从而您可以告诉 IIS 限制给定 Web 应用程序的内存。我想知道这是否是因为 IIS 具有替换/覆盖 new()/malloc()/etc 的自定义例程，因此可以为客户端应用程序提供这种类型的控制。这意味着独立的 .Net 应用程序不走运，除非您想用 C++ 编写自定义内存管理器并为 .Net 创建接口

底线是 CLR 程序使用托管进程实施的任何内存管理策略/控制。这就是为什么您必须从 IIS 中控制 C# 网页的内存使用情况，因为 IIS 实际上是一个主机进程，它为 CLR 代码执行提供环境。

# javascript - 带有 Html 基本标记的 URL 哈希

> ID：659120
> 
> 赞同：11
> 
> 时间：2009-03-18T16:48:21.403
> 
> 标签：javascript, html, hash, base-tag

## window.location.hash

使用链接进行 javascript 操作时，我通常会执行以下操作：

```
<a href="#">Link Text</a> 
```

这样，当有人在页面加载之前单击链接时，不会发生任何可怕的事情。

## Html 基本标签

在我当前的项目中，我使用相同的构造，但带有一个基本标记：

```
<html>
<head>
    <base href="http://example.com/" />
</head>
<body>
    <a href="#">Link Text</a>
</body>
</html> 
```

但是，如果页面 url 是：

```
http://example.com/dir/page 
```

单击链接导航到

```
http://example.com/# 
```

而不是

```
http://example.com/dir/page# 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-18T16:49:50.230

删除您的`base`标签或将您的`href`属性更改为完全合格。您正在观察的是`base`与`a`元素混合时的预期行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T17:38:56.120

如果您倾向于使用 a 标签，另一种解决方案是不使用 # 作为 href 目标（当您不指定时，它会导致跳转到页面顶部，我认为这是不受欢迎的）。你可以做的是：

```
<a href="javascript:">Some Link that Goes nowhere</a> 
```

确实，除非您正在做一些需要成为标签的事情，否则跨度将是您最好的选择：

CSS：

```
.generic_link {
  text-decoration:underline;
}
.generic_link:hover {
  text-decoration:none;
} 
```

HTML：

```
<span class="generic_link">Something that really isn't a link</span> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T16:51:33.457

如果没有适合非 javascript 用户的 URL，则不要使用`<a>`. `<a>`标签用于链接到其他页面。

任何可见的 HTML 元素都可以有一个 onclick 并且不会有你描述的这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T16:50:39.073

返回`false`事件`onclick`以禁用链接：

```
<a href="#" onclick="doSomething(); return false">Link Text</a> 
```

（这只是你如何内联的一个例子。但尽量避免内联声明并使用[渐进增强](http://en.wikipedia.org/wiki/Progressive_Enhancement)技术。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-11T00:07:11.790

```
<html>
<head>
    <base href="http://example.com/" />
</head>
<body>
    <a href="./dir/page#">Link Text</a>
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-24T11:44:45.807

我过去也有同样的问题。
我有一个我想为空的链接，以链接到当前页面。
如果没有[基本的 html 元素](http://www.w3schools.com/tags/tag_base.asp)，这将只是一个`a`带有`href="#"`.

我的示例没有使用`base`html 元素，

```
<li>
    <a href="#"><div>The text of my Link</div></a>
</li> 
```

与我找到的解决方案相同的示例，

```
<li style="cursor: pointer !important;">
    <a href="#" style="pointer-events: none;"><div>The text of my Link</div></a>
</li> 
```

## 此解决方案仅使用 css 禁用链接。

使用第一个 css 规则`cursor: pointer !important;`，我确保此链接将具有正确的（对于我的情况）指针图标。
使用第二条规则`pointer-events: none;`，我确保此链接不可点击。[您可以在此链接](https://css-tricks.com/almanac/properties/p/pointer-events/)
之后找到有关此规则的更多信息。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-12-30T02:33:51.927

您可以简单地从标签中删除`href`属性。`<a>`

```
<a href="#"> => <a> 
```

# syntax - 如何在一行中混合绑定（<-）和赋值（let）？（在哈斯克尔）

> ID：659129
> 
> 赞同：9
> 
> 时间：2009-03-18T16:50:31.867
> 
> 标签：syntax, haskell, syntactic-sugar

这是关于 Haskell 中的语法糖。一个简单的 Haskell 程序：

```
main = do
  args <- getArgs
  let first = head args
  print first 
```

我在第一行 ( ) 中使用绑定，在第二行 ( `args <- getArgs`) 中使用纯赋值`let first = ...`。是否有可能将它们合并成一个可读的单行？

我知道我可以重写绑定“去糖”：

```
main = do
  first <- getArgs >>= ( return . head )
  print first 
```

但是有没有更好的方法，而不用 (>>=) 弄乱一行并返回？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-20T00:25:31.367

`liftM``head`一切都很好，但我们不要忘记模式匹配：

```
main = do { arg:_ <- getArgs; print arg } 
```

或者如果你喜欢布局

```
main = do
    arg : _ <- getArgs
    print arg 
```

如果可能，大多数 Haskeller 更喜欢模式匹配而不是`head`和`tail`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-20T19:26:11.423

还有一种可能：

```
main = putStr . head =<< getArgs 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-18T17:16:36.110

这个怎么样？

```
import Control.Monad

main = do
   first <- liftM head getArgs
   print first 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-18T17:24:03.113

也可以像这样使用`ap`函数（带有 type `Monad m => m (a -> b) -> m a -> m b`）：

```
import System
import Control.Monad

main :: IO ()
main = do line <- return head `ap` getArgs
          putStrLn line 
```

这有一个简单的优点，如果您的函数需要几个参数，您可以`ap`在每个参数之间使用，而您不需要使用`liftM2`等`liftM3`。对于`f::a -> b -> c -> d`您编写的函数

```
return f `ap` arg1 `ap` arg2 `ap` arg3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T00:08:56.697

如何绑定和返回混乱？

`main = getArgs >>= (return.head) >>= print`

或者

`main = liftM head getArgs >>= print`

# oop - 当状态不可变时，静态类是否合适？

> ID：659148
> 
> 赞同：2
> 
> 时间：2009-03-18T16:55:14.447
> 
> 标签：oop, static, object-design

假设我有一个名为的简单类`WebsterDictionary`，它有一个可以接受一个词并返回其定义的函数。也许还有另一个函数可以接受定义并返回一个单词。该类一直被许多客户使用。

为了便于查找，该类包含一个成员变量，它是一个内存字典，用于存储单词及其相关定义。假设字典**一旦被初始化就永远不会改变**——它是恒定的并且不会因实例而变化。

这是静态类的好人选吗？我一直在读静态类应该是无状态的......但是这个类有状态（内存字典）对吗？

**编辑：**另外，如果这确实成为一个静态类，我什么时候初始化 Dictionary 因为不再有构造函数？每次调用其中一个静态方法时，我是否会检查对 Dictionary 的引用是否为空？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T17:01:30.313

当功能不需要可替换时（例如，用于测试），静态类是合适的。如果您可能想使用存根或模拟，您应该创建一个适当的接口，然后用单例实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T17:06:33.450

为了扩展其他人的答案，当您只需要一个类的一个实例时，静态类或单例很有用*。*当数据不可变时，这更容易实现。因此，您可能希望为此使用静态类。但它不一定是你想要使用的自动的情况。

我的建议是问自己一个问题：如果我实例化多个这些对象，世界会崩溃吗？如果是这样，请使用单例或静态类。否则，请使用常规课程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T17:08:00.030

静态类可能是您想要的（请参阅其他答案）。但是不要错误地称你的字典为“不可变的”。

*在您使用短语的意义上，*不可变并不意味着“在运行时永远不会改变” ，因为您的 Dictionary 实际上在运行时确实*会*发生变化；在您必须创建它之后，您还必须添加项目。即使在这一点上，您也可能*打算*不再改变它，但有*可能*改变它。您的意图不会在任何地方强制执行。

真正的不可变对象在创建后*无法*更改，无论您如何尝试。相反，当您需要对象的变体时，您必须创建一个具有所需属性的新实例。

您可以在某种意义上将静态类视为只有一个实例。对于依赖于为每个状态更改创建新实例的模式，这可能不是最佳选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T16:57:45.470

你可以选择单例或静态类。我可能会选择单身人士，但我认为在这种特殊情况下，这主要是一个偏好问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T16:59:27.010

当只存在一个“实例”时，静态类是合适的，在这种情况下，单例模式可能更合适，也可能不合适（取决于细节）。对于需要多个实例的不可变对象，静态类当然是不合适的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T17:00:22.123

您正在寻找的可能是单例？

静态类不需要有状态（它可以有静态成员作为它的一部分，它可以是它的状态的一部分）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-18T17:03:34.050

这听起来很像您在描述[**Monostate 模式**](http://c2.com/cgi/wiki?MonostatePattern)：您希望`WebsterDictionary`每个人都可以共享相同的模式。碰巧 the`WebsterDictionary`也是不可变的，但这是一个正交问题：只是使其无法更新（例如，通过使用只读包装器）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-18T17:23:21.227

正如您所说，该类持有某种形式的全局状态，即使它是只读的。采用 Singleton 方法可以清楚地表明它正在保存数据。

如果您使用依赖注入，您可以让它注入单例实例，而不是让所有类都具有获取实例的代码。这意味着其他类不会与 Singleton 方法相关联，并且如果您可以在测试时更轻松地替换它（结合接口以启用用测试模拟替换）。

# .net - 设置 .net 登录页面有多困难/耗时？

> ID：659164
> 
> 赞同：1
> 
> 时间：2009-03-18T16:58:26.030
> 
> 标签：.net, login, forms-authentication, single-sign-on

我们正在开发一种 SSO 解决方案，该解决方案允许用户通过 .net 登录，然后最终访问 PHP 应用程序。我在 PHP 端工作，经过大量工作，我已经对 .net 使用用户名和票证到期日期设置的 cookie 进行了解码、解析和其他操作。

至少我*认为*我有。我现在的困难是 .net 开发人员现在太忙了，无法设置生成这些 cookie 的测试登录页面，以便我可以真正进行测试。我想知道设置这个测试页面需要多长时间。我的感觉是它不应该花很长时间，但我从来没有做过。（上帝禁止我像一个客户告诉开发人员“应该只需要一个小时左右。”）

我只是想知道我应该合理地期待什么。简单的登录创建一个formsauth票并将登录的用户发送到我的测试页面。FWIW，他们已经为当前正在使用的 .net 应用程序设置了任意数量的登录页面。

编辑：为了澄清，我不会实施这个。我想知道.net 开发人员这样做需要多长时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-18T17:02:43.023

[这](http://www.devhood.com/Tutorials/tutorial_details.aspx?tutorial_id=85)是 ASP.NET 中表单身份验证的配置方面的演练。如果您可以在 Web 表单上编写一个包含两个文本框的页面和一个按钮，那么您可以完成剩下的工作。如果你从不做任何 ASP.NET，我会预算两个小时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T17:00:54.293

如果您使用[ASP.NET Membership Provider](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)，它几乎可以为您完成所有工作（包括登录表单本身）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-18T17:02:46.737

如果您之后的所有工作都是创建表单身份验证票证，那么这一行代码将完成：

```
FormsAuthentication.SetAuthCookie("Username", False) 
```

第二个参数表示您是否希望 cookie 是永久的。

如果您正在寻找您的 asp.net 开发人员实现您描述的登录页面需要多少努力的量化，答案应该少于 15 分钟。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-18T17:12:30.630

如果您没有登录数据库，可以使用内置的 sql 提供程序，这是您的配置方法：http: [//msdn.microsoft.com/en-us/library/6e9y4s5t.aspx](http://msdn.microsoft.com/en-us/library/6e9y4s5t.aspx)。

如果您确实有数据，则可以实现[自定义成员资格提供程序](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.aspx)并且仅实现 ValidateUser 方法。您可以将其余部分留给 NotImplementedException 并在需要时实现更多功能：

```
public override bool ValidateUser(string username, string password)
{
   //return true or false;
} 
```

即使您不使用具有最终实现的那个，您也可以将其用作一种快速方法。您可以在需要的地方扩展大多数其他部分，并且您使用 PHP 创建的唯一依赖项是身份验证票证，其中任何一个都使用该票证（也可以直接通过 FormsAuthentication）。

对于最终实现，您要确保密码得到正确保护，即在保存到数据库时进行哈希处理。使用内置提供程序，您可以自动完成。对于您的自定义代码，有一些简单的类可以为您执行此操作。

**更新 1：** 提供这样的时间估计真的很难。每个项目，开发人员等的时间差异很大。也就是说，走会员路线，在短短几个小时内进行测试是合理的，当然测试它确实有效（如果走自定义提供程序路线，这假设数据库就位，并且您有一些东西可以使登录变得简单）。如果您设置它只是为了测试它如何与 PHP 集成，我会使用内置提供程序，只需运行 sql 脚本来创建数据库，设置配置，添加登录页面/控件，测试它然后你很好，在这种情况下说一个小时。现在，这是一种自动模式，一种随心所欲的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T17:14:13.543

ASP.NET Forms-based Authentication is fairly easy to get started with and you can find a [tutorial](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/default.aspx) on the [ASP.NET QuickStart Tutorials](http://quickstarts.asp.net/QuickStartv20/aspnet/Default.aspx) website. You want to look at the section on [Forms-based Authentication](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/formsauth.aspx). If you require a more sophisticated solution then take a look at the [Membership and Role Manager](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/membership.aspx).

# c++ - 以图形化的方式编写 C++？

> ID：659166
> 
> 赞同：4
> 
> 时间：2009-03-18T16:58:40.333
> 
> 标签：c++, graphical-programming

我正在考虑设计一个允许人们以图形方式开发 C++ 代码的应用程序的可能性。当我发现 Scratch 时，我感到很惊讶（参见[网站](http://scratch.mit.edu/)和[教程视频](http://info.scratch.mit.edu/Support/Videos)）。

我相信大多数 C++ 都可以用图形表示，但预处理器指令和可能的函数指针除外。

您认为哪些 C++ 特性可以（或不）由图形项目表示？这样的应用程序有什么优点和缺点？它比“普通”C++ 简单多少？

**回顾和更多：**

*优点：*

*   直觉的
*   简单的小型应用程序
*   有助于避免拼写错误

*缺点：*

*   对于大型（中型？）大小的应用程序可能变得不可读
*   对于有经验的程序员来说，手动编码更快
*   C++ 对于这种方法来说太复杂了

考虑到我们 - 在我的工作中 - 已经有相当多的现有 C++ 代码，我并不是在寻找一种全新的编程方式。我正在考虑另一种与遗留代码完全兼容的编程方式。人们将用于新代码的某种“病毒语言”，并有望最终用于替换现有代码（在可能有用的地方）。

**您如何看待这种病毒式方法？**

当谈到手动与图形编程时，我倾向于同意你的答案。这就是为什么，理想情况下，我会找到一种方法让用户始终在打字和图形编程之间进行选择。逐行解析器（+部分解释器）可能能够将键入的代码转换为图形设计。这*是*可能的。让我们都祈祷吧。

**提供我应该仔细考虑和分析的打字和图形编程功能是否有注意事项？**

我已经研究过模板类（以及更普遍的类型级 C++）及其图形表示。有关模板类的图形表示的示例，请参见[那里。](http://www.freeimagehosting.net/image.php?c8e4dc91ae.png)框表示类或类模板。第一个顶部节点是类本身，接下来的（如果有的话）是类中的 typedef 指令。底部节点是模板参数。当然，边缘将类连接到用于实例化的模板参数。我已经有了一个原型来处理这种类型级别的图表。

**如果你觉得这种表示模板类的方式是完全错误的，不要犹豫，说出来为什么！**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-18T17:01:46.847

就像我喜欢 Scratch 一样，对于有经验的程序员来说，使用文本编辑器编写代码仍然比拖动块*要*快得多，这已经在任何数量的图形编程环境中一次又一次地得到证明。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-19T11:04:40.817

**编写代码**是开发人员一天中最简单的部分。我认为我们不需要更多帮助。阅读、理解、维护、比较、注释、记录和验证是我们仍然缺乏的地方——尽管有大量的工具和框架。

* * *

剖析你的优点：

****对于小型应用程序来说****直观**而简单- 将其替换为“误导性”。它看起来很简单，但实际上并非如此：只要它简单，VB.NET 就更简单。当它变得复杂时，视觉设计就会成为阻碍。**

 ****帮助避免拼写错误**——这就是良好的风格、一致性和最重要的智能感知。当事情不再简单时，无论如何你需要的东西。

* * *

**错误级别**

你的想法是错误的：C++ 语句不是可重用的、健壮的组件，它们更像是一大袋需要*正确*组合的齿轮。具有复杂性和例外（规则）的 C++ 甚至不是特别适合。

如果您想让事情变得简单，您需要更高级别的可重用组件。即使你有这些，将它们连接在一起也并不简单。尽管经过多年的奋斗，并在许多环境中进行了多次尝试，但这有时会奏效，但往往会失败。

* * *

**病毒**- 关于该要求，您是正确的 IMO：允许增量采用。这与源代码和可视化表示之间的平滑切换密切相关，这反过来可能意味着您必须能够从修改后的源代码生成可视化表示。

* * *

**IDE 支持**- 这是大多数以语言为中心的方法误入歧途的地方。现代 IDE 不仅仅是文本编辑器和编译器。用断点、数据检查等调试你的图表怎么样？分析器、泄漏检测器等是否会突出显示图表中的节点？源代码管理会给我昨天图表与今天图表的视觉差异吗？

* * *

也许你正在做一些事情，尽管我所有的“不”：一种更好的*可视化*代码的方法，一种在其上放置不同过滤器的方法，以便我看到我需要看到的内容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-18T17:09:54.020

C++ 的早期版本最初是为了编译成 C 而编写的，然后 C 被正常编译。

听起来您所描述的是一种编译为 C++ 的图形语言，然后将正常编译。

因此，实际上您不是在创建图形 C++，而是在创建一种恰好是图形的新语言。这没有错，但不要让 C++ 限制你所做的事情，因为最终你可能希望将图形语言直接编译为机器代码，甚至编译为[CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)、[Java ByteCode](http://en.wikipedia.org/wiki/Java_bytecode)或其他任何你喜欢的东西。

您可能想要查看的其他图形语言是[LabVIEW ，以及更普遍的](http://en.wikipedia.org/wiki/LabVIEW)[可视化编程语言](http://en.wikipedia.org/wiki/Category:Visual_programming_languages)类别。

祝你工作顺利。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-18T17:08:17.987

**非平凡程序的复杂性通常太高而无法用图形符号表示，而图形符号的信息量很低。**除非您的方法在某些方面明显不同，否则我怀疑这是否基于过去的努力是否有价值。

因此，实际上，他将仅用于教学目的和非常简单的程序。但对于这样的产品来说，这仍然是一个很好的目标市场。有时人们难以掌握基本原理，而视觉模型可能只是帮助点击的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T17:06:47.303

我更喜欢热键而不是图形菜单和按钮。
我认为图形开发工具也会发生同样的事情。许多人会更喜欢手动编码。

但是，源代码可视化工具 - 应该是件好事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-18T17:09:42.243

> 您认为哪些 C++ 功能可以 [...] 由图形项目表示？

面向对象设计。因此，类、继承、多态性、可变性、常量性等。还有模板。

> 这样的应用程序的优点和缺点是什么？

初学者开始编写程序可能更容易。对于有经验的人来说，它可能会摆脱编程的无聊部分。

想想任何其他代码生成器。他们为您创建了一个框架来编写更多涉及的部分。它们还会导致代码臃肿（想想任何所见即所得的 HTML 编辑器）。

在我看来，最大的挑战是任何这样的 UI 都必然会阻碍用户的想象力。

> 它比“普通” c++ 简单多少？

当您经历大量代码生成器典型的错误时，这可能是一种真正的痛苦。

此外，由于生成了大量代码，您不知道发生了什么——调试变得困难。

此外，对于有经验的人来说，发现生成的代码不符合他们喜欢的编码风格可能会有些恼火。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-18T17:15:12.043

有趣的想法。我怀疑我会使用它。我更喜欢在纯文本编辑器中编码，甚至不是 IDE，对于棘手的问题，我更喜欢在纸上。我认识的大多数真正有经验的程序员都是这样工作的，也许是因为我们在不同的环境中长大，但我认为这也是因为我们对编程的看法。随着您获得更多经验，您开始*在脑海中*看到代码，比任何 GUI 工具向您显示的更清晰。

至于你的问题，我会提名模板作为尝试很好地代表的更难/更有趣的事情之一。它们无处不在，并携带您在设计工具时无法访问的信息。以一种有用的方式将其传递给用户应该是一个有趣的挑战。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-18T18:17:17.773

我喜欢这个想法，但我怀疑事情会变得过于复杂而无法以图形方式表示。

但是，鉴于最近的工作经验；将这样的图形界面提供给非技术人员用于创建基本的拖放程序会很有用，让我自己可以自由地进行一些“适当的”编程；-) 如果它可以完成以下工作允许不熟练的人构建功能性的东西可能是一件非常好的事情（即使编程逻辑逃脱了他们）

在这样一个系统中，使用文字 C++ 代码更容易定义您想要做什么，而不是让用户界面妨碍您。对于知道需要编写的精确代码但仅限于设计 GUI 的会话程序员来说，这可能会令人沮丧。我特别考虑了一个更常见的应用程序，例如 html 编辑器/设计器，他们允许新手在根本不知道任何 html 的情况下构建他们的网站。

看看这样的系统如何处理内存的动态分配以及随着时间的推移程序的不同状态将会很有趣。我怀疑有一些非常基本的编程概念可能难以用图形表示..多态..？虚拟类、链接列表、堆栈/循环队列。我想知道你如何在没有巨大显示屏的帮助下成功地解释图像压缩算法（例如 jpg）。

我还想知道这样的系统是否会达到如此低的水平，以及您是否会处理抽象的概念，而编译器是否会找到做某事的最佳方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-29T23:32:55.473

我一直在研究一种新的模型驱动软件开发范例，名为 ABSE ( [http://www.abse.info](http://www.abse.info) )，它支持最终用户编程：它是一个基于模板的系统，可以用转换代码进行补充。我还有一个 IDE（名为 AtomWeaver）实现了目前处于 pre-alpha 阶段的 ABSE。

使用 AtomWeaver，作为专家/架构师，您可以构建知识模板，然后开发人员（或最终用户，如果您使元模型更简单）可以通过构建块“组装”系统，然后在表单中填充模板参数风格的编辑器。

最后，按下“生成”按钮将创建建筑师/专家指定的最终系统。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-18T17:07:45.633

我很惊讶你认为函数指针会是一个特殊的问题。与指针有什么关系呢？

编程语言可以由节点的层次结构表示 - 这正是编译器将其变成的。非常奇怪的是，用于编辑程序的 UI 仍然是一个被解析的字符序列，因为编辑器中的自由度远远大于可用的允许选择集。但是智能感知有助于大大减少这个问题。

C++ 作为这样一个系统的基础是一个奇怪的选择。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-18T17:09:15.207

我认为这种 IDE 的主要问题是生成的代码很容易变得难以维护。

这发生在德尔福身上。它是开发某种应用程序的一个非常好的工具，但是，当我们开始在组件之间添加复杂的关系、开始添加设计模式等时，代码会增长到无法维持的规模。

我相信这也是因为图形工具没有应用 MVC 的概念（或者如果他们这样做，它只是 IDE 理解的方式）。

它对于原型和不会增长的非常小的应用程序非常有帮助，否则它可能会给开发人员带来混乱

# hibernate - Hibernate：不将 SessionFactory 绑定到 JNDI 名称可以吗？

> ID：659167
> 
> 赞同：3
> 
> 时间：2009-03-18T16:58:45.780
> 
> 标签：hibernate, jndi, sessionfactory

有一种方法可以在 hibernate.cfg.xml 文件中设置 SessionFactory 的 JNDI 名称。但是，如果我没有明确使用 JNDI 查找在我的 Web 应用程序中获取我的 SessionFactory，是否可以不给它一个 JNDI 名称？

我问的原因是，如果我没有设置我的 JNDI 名称，我的 JUnit 测试将运行良好。但是，如果我只通过在 hibernate.cfg.xml 的 sessionfactory 标记中指定“名称”来设置它，它首先会说：

```
WARN  [WebApp:SessionFactoryObjectFactory.addInstance] Could not bind factory to JNDI 
```

并抛出异常：

```
javax.naming.NoInitialContextException:Need to specify class name in environment or system property, or as an appletparameter, or in an application resource file: 
```

所以我的解决方法是从我的 hibernate.cfg.xml 中删除 JNDI 名称，但不知道这是否会导致其他问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T20:58:14.237

我会说大多数时候都可以，但您也可以考虑为您的 JUnit 测试使用不同的 hibernate.cfg.xm。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T16:11:25.017

如果删除属性名称，在配置文件中使用 value = "sessionFactory" 就可以了。

# iphone - App Delegate 中的 Mac OSX/iPhone 错误处理？

> ID：659174
> 
> 赞同：5
> 
> 时间：2009-03-18T17:00:57.473
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, error-handling

我很好奇，你们大多数人如何处理来自服务器的 HTTP Forbidden 或 5xx 类型请求等错误？或者说在你的 UIViewController 中抛出了一个异常？您是否通常将错误冒泡到 App Delegate 并在此时处理一般的“窗口”级错误？您是否将错误直接耦合到 UIViewController 中？如果您有几个 UIViewController，它们都与一个通用的 NSURLConnection 包装器对话，并且连接因某些 HTTP 4xx 或 HTTP 5xx 类似错误而失败。您通常会将错误冒泡到 App Delegate 以便它可以从应用程序的该部分呈现 UIAlertView 吗？

只是想知道您为 Mac OSX/iPhone 错误处理技术使用的解决方案。

谢谢一堆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T17:12:34.030

您当前的视图控制器应该负责发送任何错误消息并处理结果。

最后一部分是这里的关键。如果您遇到 HTTP 错误并使用“重试”选项将消息传递给您的应用程序委托，则响应需要一直返回到控制器。这一切都变得有点恶心。

现在您可能希望在您的应用程序中创建一个通用类/视图来处理您可能遇到的所有错误，但这仍然应该由遇到错误的控制器呈现（以模态方式），就是这样应该接收委托响应的控制器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T06:27:19.300

为了从网络错误中正确恢复，控制器可能需要也可能不需要知道是否存在错误，但是对于 iPhone 开发，我发现拥有一个能够理解进出控制器的所有通信的核心通信类很有用。系统，并在检测到故障时直接发出警报。这样一来，如果用户切换选项卡或以其他方式在应用程序中移动，您可以防止出现过多的失败通知，并且只生成一条消息，以便用户可以理解为什么屏幕没有更新。

# java - 如何使用自定义 NamingStrategy 在 Eclipse 中配置 Hibernate Tools HQL 编辑器

> ID：659178
> 
> 赞同：4
> 
> 时间：2009-03-18T17:01:44.010
> 
> 标签：java, eclipse, ide, jboss-tools, hibernate-tools

我已经在 Eclipse Ganymede 中安装了 Hibernate Tools 3.2.4.GA。安装它的主要驱动力是能够以交互方式发出 HQL 查询。

我已经配置了我们所有的映射文件、hibernate.properties 等，它显示了我们所有的实体和映射，并且能够从数据库中读取表列表。它似乎没有使用我在配置中指定的自定义命名策略，因此我无法查询任何内容。动态 SQL 预览中的查询是正确的，但表名除外。

我配置命名策略的方式是右键单击休眠配置并选择“编辑配置”在“选项”选项卡中“浏览”以获取命名策略。Eclipse 能够找到命名策略并为我自动完成它，这表明它在类路径中。然后我点击确定，仍然有问题。

我是否在休眠工具的命名策略配置中遗漏了某些内容（现在会出现 jboss 工具）或者它是否损坏？

或者，是否有另一个工具可以用来（在 Eclipse 中或在 Eclipse 之外）针对我的数据库发出 HQL 语句并能够看到结果？

**更新** 问题出在 NamingStrategy 实现中。它在每个表的前面添加一个字符串，并将驼峰大小写更改为所有带下划线的小写。不幸的是，在实现中，字符串是通过spring注入的，并没有默认设置。在休眠工具中没有发生弹簧注入，并且由于没有默认值，因此字符串为空。它已被更改为具有默认值（与我们当前的 spring 配置匹配）并且它现在正在工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T08:18:25.710

我没有在 Eclipse 中使用 Hibernate Tools。但这是针对您的数据库发出 HQL 语句的替代解决方案。

有一个名为**HQE** Hibernate Query Editor 的工具。Hibernate Query Editor (HQE) 是一个简单的应用程序，旨在简化为 Hibernate 编写 HQL/SQL 查询的工作。它具有简单的功能，例如语法突出显示和其他编辑内容。

有关[HQE](https://hqe.dev.java.net/)的更多信息 可以在[这里找到 https://hqe.dev.java.net/](https://hqe.dev.java.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-13T23:54:51.820

您可能会查看我的插件，该插件可以轻松创建简单的 hqls。 [http://fast-code.sourceforge.net/](http://fast-code.sourceforge.net/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-08-25T03:13:20.357

使用 myeclipse 配置 hibernate，您可以获得各种选项。这可能会帮助 [http://www.skill-guru.com/blog/tag/hibernate-and-eclipse-tutorial/](http://www.skill-guru.com/blog/tag/hibernate-and-eclipse-tutorial/)

# c# - 如何从 C# 中的年份和周数中获取月份数？

> ID：659183
> 
> 赞同：12
> 
> 时间：2009-03-18T17:03:07.127
> 
> 标签：c#, datetime

正如标题所说，给定年份和周数，我如何获得月份数？

编辑：如果一周跨越两个月，我想要一周的第一天所在的月份。

编辑（2）：这就是我获得周数的方式：

```
CultureInfo.CurrentCulture.Calendar.GetWeekOfYear(DateTime.Now, CalendarWeekRule.FirstDay, DayOfWeek.Monday); 
```

我只是想反其道而行之。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-18T17:12:55.463

如果您假设一周定义的第一天与一年中的第一天是同一天，那么这将起作用：

```
int year = 2000;
int week = 9;
int month = new DateTime(year, 1, 1).AddDays(7 * (week - 1)).Month; 
```

显然，一个*真正*的答案将取决于您如何定义一周的第一天，以及当一周重叠多个时，您如何定义一周如何落入一个月。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-18T18:04:25.917

这就是我最终做的事情：

```
static int GetMonth(int Year, int Week)
{
    DateTime tDt = new DateTime(Year, 1, 1);

    tDt.AddDays((Week - 1) * 7);

    for (int i = 0; i <= 365; ++i)
    {
        int tWeek = CultureInfo.CurrentCulture.Calendar.GetWeekOfYear(
            tDt, 
            CalendarWeekRule.FirstDay, 
            DayOfWeek.Monday);
        if (tWeek == Week)
            return tDt.Month;

        tDt = tDt.AddDays(1);
    }
    return 0;
} 
```

我更喜欢更简单的东西，但它有效:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-18T17:04:40.337

它不也取决于星期几吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-12-22T13:13:50.657

这应该可以提供帮助

```
 public int getMonth(int weekNum, int year)
 {
     DateTime Current = new DateTime(year, 1, 1);
     System.DayOfWeek StartDOW = Current.DayOfWeek;
     int DayOfYear = (weekNum * 7) - 6; //1st day of the week

     if (StartDOW != System.DayOfWeek.Sunday) //means that last week of last year's month
     {
         Current = Current.AddDays(7 - (int)Current.DayOfWeek);
     }
     return Current.AddDays(DayOfYear).Month;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T17:12:06.887

您可能面临的另一个问题是，大多数年份不是从一周的开始开始的，这会改变一切。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-01-28T07:06:35.747

假设：

1.  星期日是一周的第一天。
2.  部分周仍算作第 1 周
3.  将开始和结束月份输出为整数数组。

    ```
    public int[] getMonth(int weekNum, int year)
    {

        DateTime StartYear = new DateTime(year, 1, 1);
        System.DayOfWeek StartDOW = StartYear.DayOfWeek;
        DateTime DayOfYearWeekStart = default(DateTime);
        DateTime DayOfYearWeekEnd = default(DateTime);
        int x = 0;
        if ((StartDOW == System.DayOfWeek.Sunday)) {
            DayOfYearWeekStart = StartYear.AddDays((weekNum - 1) * 7);
            DayOfYearWeekEnd = DayOfYearWeekStart.AddDays(6);
        } else {
            for (x = 0; x <= 7; x += 1) {
                if (StartYear.AddDays(x).DayOfWeek == DayOfWeek.Sunday) {
                    break; // TODO: might not be correct. Was : Exit For
                }
            }

            if (weekNum == 1) {
                DayOfYearWeekStart = StartYear;
                DayOfYearWeekEnd = StartYear.AddDays(x - 1);
            } else if (weekNum > 1) {
                DayOfYearWeekStart = StartYear.AddDays(((weekNum - 2) * 7) + x);
                DayOfYearWeekEnd = DayOfYearWeekStart.AddDays(6);
            }

        }

        int[] Month = new int[2];
        Month[0] = DayOfYearWeekStart.Month;
        Month[1] = DayOfYearWeekEnd.Month;

        return Month;
    } 
    ```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-18T17:04:54.953

你不能。您至少需要第一周开始的那一天（或一周开始的时间）才能获得准确的答案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-18T17:08:25.117

你不能。一周可能从一个月开始，在另一个月结束。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-18T17:10:16.267

我认为您假设“周”是连续 7 天的任何组。它不是。给定年（2008 年），周（5），您可能在 1 月或 2 月，这取决于您的“周”何时开始。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-26T16:12:20.203

在 .NET 3.0 及更高版本中，您可以使用[`ISOWeek`-Class](https://docs.microsoft.com/en-us/dotnet/api/system.globalization.isoweek)。

```
public static int MonthOfFirstDay(int year, int week)
{
    return ISOWeek.ToDateTime(year, week, DayOfWeek.Monday).Month;
} 
```

请注意，这一年可能不合适，因为一年的第一周可能已经在前一年的 12 月底开始。例如，2020 年的第一周从 2019 年 12 月 30 日星期一开始。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-06-27T11:12:32.727

```
// Calculate the week number according to ISO 8601

    public static int Iso8601WeekNumber(DateTime dt)
    {
            return  CultureInfo.CurrentCulture.Calendar.GetWeekOfYear(dt, CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Monday);
    }

// ...

DateTime dt = DateTime.Now;

// Calculate the WeekOfMonth according to ISO 8601
int weekOfMonth = Iso8601WeekNumber(dt) - Iso8601WeekNumber(dt.AddDays(1 - dt.Day)) + 1; 
```

# sql - SQL Server - 停止或中断 SQL 脚本的执行

> ID：659188
> 
> 赞同：364
> 
> 时间：2009-03-18T17:04:20.570
> 
> 标签：sql, sql-server, scripting, exit

有没有办法立即停止 SQL 服务器中 SQL 脚本的执行，比如“break”或“exit”命令？

我有一个脚本在开始插入之前进行一些验证和查找，如果任何验证或查找失败，我希望它停止。

* * *

## 回答 #1

> 赞同：416
> 
> 时间：2009-04-29T23:43:23.703

**[raiseerror](http://msdn.microsoft.com/en-us/library/ms178592.aspx)方法_**

```
raiserror('Oh no a fatal error', 20, -1) with log 
```

这将终止连接，从而停止脚本的其余部分运行。

请注意，`WITH LOG`要以这种方式工作，需要 20 或更高的严重性级别和选项。

这甚至适用于 GO 语句，例如。

```
print 'hi'
go
raiserror('Oh no a fatal error', 20, -1) with log
go
print 'ho' 
```

会给你输出：

```
hi
Msg 2745, Level 16, State 2, Line 1
Process ID 51 has raised user error 50000, severity 20\. SQL Server is terminating this process.
Msg 50000, Level 20, State 1, Line 1
Oh no a fatal error
Msg 0, Level 20, State 0, Line 0
A severe error occurred on the current command.  The results, if any, should be discarded. 
```

请注意，未打印“ho”。

注意事项：

*   这仅在您以 admin（'sysadmin' 角色）身份登录时有效，并且也使您没有数据库连接。
*   如果您不是以管理员身份登录，则 RAISEERROR() 调用本身将失败*，脚本将继续执行*。
*   使用 sqlcmd.exe 调用时，将报告退出代码 2745。

参考：[http ://www.mydatabasesupport.com/forums/ms-sqlserver/174037-sql-server-2000-abort-whole-script.html#post761334](http://www.mydatabasesupport.com/forums/ms-sqlserver/174037-sql-server-2000-abort-whole-script.html#post761334)

**noexec 方法**

另一种适用于 GO 语句的方法是`set noexec on`. 这会导致脚本的其余部分被跳过。它不会终止连接，但您需要`noexec`在执行任何命令之前再次关闭。

例子：

```
print 'hi'
go

print 'Fatal error, script will not continue!'
set noexec on

print 'ho'
go

-- last line of the script
set noexec off -- Turn execution back on; only needed in SSMS, so as to be able 
               -- to run this script again in the same session. 
```

* * *

## 回答 #2

> 赞同：201
> 
> 时间：2009-03-18T17:23:19.433

只需使用 RETURN （它可以在存储过程的内部和外部工作）。

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2010-04-07T06:13:39.770

如果可以使用 SQLCMD 模式，那么咒语

```
:on error exit 
```

（包括冒号）将导致 RAISERROR 实际停止脚本。例如，

```
:on error exit

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SOMETABLE]') AND type in (N'U')) 
    RaisError ('This is not a Valid Instance Database', 15, 10)
GO

print 'Keep Working' 
```

将输出：

```
Msg 50000, Level 15, State 10, Line 3
This is not a Valid Instance Database
** An error was encountered during execution of batch. Exiting. 
```

批次将停止。如果没有打开 SQLCMD 模式，你会得到关于冒号的解析错误。不幸的是，它并不是完全防弹的，就好像脚本在没有 SQLCMD 模式的情况下运行一样，SQL Managment Studio 甚至可以轻松克服解析时间错误！不过，如果您从命令行运行它们，这很好。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-03-18T17:07:12.763

我不会使用 RAISERROR——SQL 有可用于此目的的 IF 语句。进行验证和查找并设置局部变量，然后使用 IF 语句中的变量值使插入有条件。

您不需要检查每个验证测试的可变结果。您通常可以只使用一个标志变量来确认所有条件都已通过：

```
declare @valid bit

set @valid = 1

if -- Condition(s)
begin
  print 'Condition(s) failed.'
  set @valid = 0
end

-- Additional validation with similar structure

-- Final check that validation passed
if @valid = 1
begin
  print 'Validation succeeded.'

  -- Do work
end 
```

即使您的验证更复杂，您也应该只需要在最终检查中包含几个标志变量。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-11-19T16:21:15.520

在 SQL 2012+ 中，您可以使用[THROW](https://msdn.microsoft.com/en-us/library/ee677615.aspx)。

```
THROW 51000, 'Stopping execution because validation failed.', 0;
PRINT 'Still Executing'; -- This doesn't execute with THROW 
```

来自 MSDN：

> 引发异常并将执行转移到 TRY...CATCH 构造的 CATCH 块...如果 TRY...CATCH 构造不可用，则结束会话。设置引发异常的行号和过程。严重性设置为 16。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2011-10-25T12:27:31.450

我使用事务成功扩展了 noexec 开/关解决方案，以全有或全无的方式运行脚本。

```
set noexec off

begin transaction
go

<First batch, do something here>
go
if @@error != 0 set noexec on;

<Second batch, do something here>
go
if @@error != 0 set noexec on;

<... etc>

declare @finished bit;
set @finished = 1;

SET noexec off;

IF @finished = 1
BEGIN
    PRINT 'Committing changes'
    COMMIT TRANSACTION
END
ELSE
BEGIN
    PRINT 'Errors occured. Rolling back changes'
    ROLLBACK TRANSACTION
END 
```

显然编译器“理解” IF 中的@finished 变量，即使出现错误并且执行被禁用。但是，仅当未禁用执行时，该值才设置为 1。因此，我可以相应地很好地提交或回滚事务。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-03-18T17:27:14.947

您可以将 SQL 语句包装在 WHILE 循环中，并在需要时使用 BREAK

```
WHILE 1 = 1
BEGIN
   -- Do work here
   -- If you need to stop execution then use a BREAK

    BREAK; --Make sure to have this break at the end to prevent infinite loop
END 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2016-12-09T15:21:25.497

[您可以使用GOTO](https://msdn.microsoft.com/en-us/library/ms180188.aspx)语句更改执行流程：

```
IF @ValidationResult = 0
BEGIN
    PRINT 'Validation fault.'
    GOTO EndScript
END

/* our code */

EndScript: 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2010-08-24T14:02:13.647

进一步 refinig Sglasses 方法，上面的行强制使用 SQLCMD 模式，如果不使用 SQLCMD 模式，则终止脚本，或者使用`:on error exit`在任何错误时退出
[CONTEXT_INFO](http://msdn.microsoft.com/en-us/library/ms187768.aspx)用于跟踪状态。

```
SET CONTEXT_INFO  0x1 --Just to make sure everything's ok
GO 
--treminate the script on any error. (Requires SQLCMD mode)
:on error exit 
--If not in SQLCMD mode the above line will generate an error, so the next line won't hit
SET CONTEXT_INFO 0x2
GO
--make sure to use SQLCMD mode ( :on error needs that)
IF CONTEXT_INFO()<>0x2 
BEGIN
    SELECT CONTEXT_INFO()
    SELECT 'This script must be run in SQLCMD mode! (To enable it go to (Management Studio) Query->SQLCMD mode)\nPlease abort the script!'
    RAISERROR('This script must be run in SQLCMD mode! (To enable it go to (Management Studio) Query->SQLCMD mode)\nPlease abort the script!',16,1) WITH NOWAIT 
    WAITFOR DELAY '02:00'; --wait for the user to read the message, and terminate the script manually
END
GO

----------------------------------------------------------------------------------
----THE ACTUAL SCRIPT BEGINS HERE------------- 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-03-18T17:07:52.870

这是一个存储过程吗？如果是这样，我认为您可以只做一个返回，例如“返回NULL”；

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-03-18T17:18:54.997

我建议您将适当的代码块包装在 try catch 块中。然后，您可以使用严重性为 11 的 Raiserror 事件，以便根据需要中断到 catch 块。如果您只想引发错误但在 try 块中继续执行，则使用较低的严重性。

有道理？

干杯，约翰

[编辑以包括 BOL 参考]

[http://msdn.microsoft.com/en-us/library/ms175976(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms175976(SQL.90).aspx)

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2009-03-18T18:28:46.950

我`RETURN`一直在这里使用，在脚本中工作或`Stored Procedure`

`ROLLBACK`如果你在其中，请确保你的事务，否则`RETURN`立即会导致一个未提交的未提交事务

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-03-18T21:10:16.127

这些都不适用于“GO”语句。在此代码中，无论严重性是 10 还是 11，您都会得到最终的 PRINT 语句。

**测试脚本：**

```
-- =================================
PRINT 'Start Test 1 - RAISERROR'

IF 1 = 1 BEGIN
    RAISERROR('Error 1, level 11', 11, 1)
    RETURN
END

IF 1 = 1 BEGIN
    RAISERROR('Error 2, level 11', 11, 1)
    RETURN
END
GO

PRINT 'Test 1 - After GO'
GO

-- =================================
PRINT 'Start Test 2 - Try/Catch'

BEGIN TRY
    SELECT (1 / 0) AS CauseError
END TRY
BEGIN CATCH
    SELECT ERROR_MESSAGE() AS ErrorMessage
    RAISERROR('Error in TRY, level 11', 11, 1)
    RETURN
END CATCH
GO

PRINT 'Test 2 - After GO'
GO 
```

**结果：**

```
Start Test 1 - RAISERROR
Msg 50000, Level 11, State 1, Line 5
Error 1, level 11
Test 1 - After GO
Start Test 2 - Try/Catch
 CauseError
-----------

ErrorMessage
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Divide by zero error encountered.

Msg 50000, Level 11, State 1, Line 10
Error in TRY, level 11
Test 2 - After GO 
```

完成这项工作的唯一方法是编写不带`GO`语句的脚本。有时这很容易。有时这是相当困难的。（使用类似的东西`IF @error <> 0 BEGIN ...`。）

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-03-18T17:05:27.930

你可以使用[RAISERROR](http://msdn.microsoft.com/en-us/library/ms178592.aspx)。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2012-06-27T08:40:44.163

这是我的解决方案：

...

```
BEGIN
    raiserror('Invalid database', 15, 10)
    rollback transaction
    return
END 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2015-09-07T06:58:18.527

您可以使用 GOTO 语句。试试这个。这对你有用。

```
WHILE(@N <= @Count)
BEGIN
    GOTO FinalStateMent;
END

FinalStatement:
     Select @CoumnName from TableName 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-31T13:52:18.187

谢谢你的答案！

`raiserror()`工作正常，但您不应该忘记该`return`语句，否则脚本将继续没有错误！（因此 raiserror 不是“throwerror” ;-)）当然，如果需要，还可以进行回滚！

`raiserror()`很高兴告诉执行脚本的人出了点问题。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-07-05T07:34:31.370

如果您只是在 Management Studio 中执行脚本，并且想要在第一个错误时停止执行或回滚事务（如果使用），那么我认为最好的方法是使用 try catch 块（SQL 2005 及更高版本）。如果您正在执行脚本文件，这在 Management Studio 中效果很好。存储过程也可以始终使用它。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-05-28T11:34:12.163

将其包含在 try catch 块中，然后执行将转移到 catch。

```
BEGIN TRY
    PRINT 'This will be printed'
    RAISERROR ('Custom Exception', 16, 1);
    PRINT 'This will not be printed'
END TRY
BEGIN CATCH
    PRINT 'This will be printed 2nd'
END CATCH; 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-01-03T22:59:16.023

回到过去，我们使用以下...效果最好：

```
RAISERROR ('Error! Connection dead', 20, 127) WITH LOG 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-04-28T23:01:50.750

非常感谢这里的所有其他人和我读过的其他帖子。但是在@jaraics 回答之前，没有什么能满足我的所有需求。

我见过的大多数答案都忽略了多批次的脚本。他们忽略了 SSMS 和 SQLCMD 中的双重用法。我的脚本在 SSMS 中完全可以运行——但我想要 F5 预防，这样他们就不会意外删除现有的一组对象。

`SET PARSEONLY ON`工作得很好，可以防止不需要的 F5。但是你不能用 SQLCMD 运行。

另一件让我慢了一段时间的事情是，当出现错误时，批处理将如何跳过任何进一步的命令——所以我`SET NOCOUNT ON`被跳过了，因此脚本仍然运行。

无论如何，我稍微修改了 jaraics 的答案：（在这种情况下，我还需要一个数据库才能从命令行激活）

```
-----------------------------------------------------------------------
-- Prevent accidental F5
-- Options:
--     1) Highlight everything below here to run
--     2) Disable this safety guard
--     3) or use SQLCMD
-----------------------------------------------------------------------
set NOEXEC OFF                             -- Reset in case it got stuck ON
set CONTEXT_INFO  0x1                      -- A 'variable' that can pass batch boundaries
GO                                         -- important !
if $(SQLCMDDBNAME) is not null
    set CONTEXT_INFO 0x2                   -- If above line worked, we're in SQLCMD mode
GO                                         -- important !
if CONTEXT_INFO()<>0x2 
begin
    select 'F5 Pressed accidentally.'
    SET NOEXEC ON                          -- skip rest of script
END
GO                                         -- important !
-----------------------------------------------------------------------

< rest of script . . . . . >

GO
SET NOEXEC OFF
print 'DONE' 
```

# flash - 检测 ActionScript 3.0 中是否允许全屏显示？

> ID：659191
> 
> 赞同：6
> 
> 时间：2009-03-18T17:04:57.887
> 
> 标签：flash, actionscript-3, fullscreen, flashvars

如果 allowfullscreen 参数为假，我想删除全屏按钮。
      `param value="true" name="allowfullscreen"`

有谁知道是否可以检测到该值？loaderInfo.parameters 上没有其他 flashvars。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T20:10:54.163

你要的会员是

```
stage.displayState 
```

它可以像这样分配：

```
import flash.display.StageDisplayState;

....

stage.displayState = StageDisplayState.FULL_SCREEN;
stage.displayState = StageDisplayState.NORMAL; 
```

我推荐阅读：

[http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000352.html](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000352.html)

[编辑：

哦，伙计，完全误解了你的问题。]

经过一些测试后，您似乎可以使用异常机制对其进行测试，而不会出现任何可察觉的闪烁：

```
try
{
    stage.displayState = StageDisplayState.FULL_SCREEN;
    stage.displayState = StageDisplayState.NORMAL;
} catch ( error:SecurityError ) {
// your hide button code            
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-21T17:10:01.063

AS3 解决方案

您可以通过舞台属性检查是否允许全屏，例如我的情况

```
try {
    if (btn.stage["allowsFullScreen"]) { // if this fails, then its not allowed
        // do full screen allow code here
        btn.alpha = 1; // show since its allowed
    }
} catch (error:Error) { // full scrren not allowed
    btn.alpha = 0.5; // dim since it cant be used
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T20:25:51.257

实际上，文档不清楚如何在 ActionScript 3 中检测到是否允许全屏模式。

他们唯一提到的是，如果您确实尝试切换到全屏模式并且不允许这样做，那么您将得到一个异常，您可以捕获该异常。这不会轻易让您隐藏或显示全屏模式按钮。

可能有办法，但众所周知，“livedocs”不完整或简短。

~~您可以通过查看根对象的参数来读取默认为 false 的“全屏”参数值：~~

 ~~```
var keyStr:String;
var valueStr:String;
var paramObj:Object = LoaderInfo(this.root.loaderInfo).parameters;
for (keyStr in paramObj) {
valueStr = String(paramObj[keyStr]);
//do something with this information
} 
```~~ 

~~编辑：您注意到它不会在 flashvars 中返回。~~

 ~~* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T09:39:33.423

您无法检测嵌入是否将 allowfullscreen 设置为 false/true。

不幸的是，您需要等到用户单击按钮才能捕获最终错误，从而禁用该按钮。

仍然...您必须处于非常特殊的环境中才能要求 flashplayer 在*您*可能编辑它时自行评估此值。如果嵌入由需要能够决定是否应允许全屏模式的第三方处理。如果是这种情况，只需添加一个额外的 flash-var（例如 fullscreenButton=false）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T12:02:03.733

我能想到的唯一方法是通过 ExternalInterface 调用 JavaScript 函数。您可以轻松地从 JavaScript 读取 Flash 嵌入参数，但我想如果您可以将 JS 插入到您的电影嵌入的 HTML 中，您宁愿更改参数而不是尝试找出它是什么。

`stage.displayState = StageDisplayState.FULL_SCREEN;`除此之外，除了只能由用户事件触发的事实之外，Jotham 的解决方案似乎还可以。

> 全屏模式响应用户的鼠标点击或按键而启动；没有用户输入，电影无法更改 Stage.displayState。（[http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/display/Stage.html#displayState](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/display/Stage.html#displayState)）

您应该有第二个按钮，当按下该按钮时，它将运行 Jotham 的代码。我会选择登录按钮或用户无论如何都会按下的任何其他按钮。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-07T17:13:02.383

可悲的是，上面的帖子不起作用。一个瑞士法郎：

```
package {
    import flash.display.Sprite;
    import flash.display.StageDisplayState;
    import flash.events.Event;
    import flash.events.MouseEvent;

    public class Tester extends Sprite {
        public function Tester() {
            trace("Display States: Full="+StageDisplayState.FULL_SCREEN+"; Normal="+StageDisplayState.NORMAL);
            trace( "- Display State? "+stage.displayState);
            trace( "- Full Screen Enabled? "+(stage.hasOwnProperty("displayState")) );
            stage.addEventListener( MouseEvent.CLICK, function(evt:Event=null):void {
                trace("Attempting to change to FullScreen...");
                try {
                    stage.displayState = StageDisplayState.FULL_SCREEN;
                    trace("Success!");
                    stage.displayState = StageDisplayState.NORMAL;
                } catch(e:*) {
                    trace("Fail! "+e);
                }
            });
        }

    }
} 
```

将在禁用全屏时跟踪：

```
Display States: Full=fullScreen; Normal=normal
- Display State? normal
- Full Screen Enabled? true
Attempting to change to FullScreen...
Fail! SecurityError: Error #2152: Full screen mode is not allowed. 
```

问题是`Full Screen Enabled? true`部分。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-06-14T22:03:57.147

我相信我们可以通过试听来检查这种能力

```
_root.stage.addEventListener(FullScreenEvent.FULL_SCREEN, onFullScreenListenter); 
```

从我尝试在严格的安全设置主机中允许全屏模式的测试中，它将返回空异常。我猜是因为 FullScreenEvent 不存在。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-04-14T15:51:29.453

**编辑：这现在已经过时了（是 FP 8.5 / 9 的 hack）**

以下将检测您的播放器是否具有全屏可用性（谢谢@mrdoob）：

```
var hasFullscreen:Boolean = (stage.hasOwnProperty("displayState")) 
```

# .net - Sql Workflow Persistence Service 不保存工作流状态

> ID：659193
> 
> 赞同：1
> 
> 时间：2009-03-18T17:05:05.170
> 
> 标签：.net, persistence, workflow-foundation

大家好，

我在这里处理一个非常奇怪的情况。我开发了一个状态机工作流程，直到今天它都运行良好。现在，Sql Workflow Persistence Service 不会保存工作流状态。没有任何例外，只是它不保存状态。流程正常进入事件驱动活动，通过本文[链接](http://msdn.microsoft.com/en-us/library/ms734764(VS.85).aspx)，这是必须保存工作流状态的条件之一（它之前一直在做的很好）。

Sql Workflow Persistence Service 的配置如下：

```
 <workflowRuntime name="WorkfolwServiceHostRuntime" validateOnCreate="true"
        enablePerformanceCounters="true">
        <services>
          <add 
            type="System.Workflow.Runtime.Hosting.SqlWorkflowPersistenceService, 
                System.Workflow.Runtime, Version=3.0.00000.0, Culture=neutral, 
                PublicKeyToken=31bf3856ad364e35" 
             connectionString="Data Source=svr; 
               Initial Catalog=WorkflowPersistence; user id=User;password=Pass; 
               Trusted_Connection=False" LoadIntervalSeconds="1" 
               UnLoadOnIdle="true"/>

        </services>
      </workflowRuntime> 
```

问题可能是因为还有一个应用程序托管工作流运行时并使用相同的工作流持久性数据库。如果允许或不允许，我找不到任何信息。

我看不出发生这种情况的任何其他原因，因此我将不胜感激任何建议。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T22:09:02.173

通常，工作流在空闲时会持续存在。它持续多久还取决于诸如轮询间隔（您在创建`SQLPersistenceService`并将其附加到运行时时提供的时间间隔）等因素。此外，工作流使用的所有内容，尤其是。ExternalDataEvent 参数和事件应标记为`Serializable`。

关于处理异常，您应该将 FaultHandlersActivity 添加到您的工作流中，并且捕获的异常将保存在与 FaultHandlersActivity 一起公开的 Fault 属性中。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T15:30:07.667

好的，最后，我发现了问题所在。在第一篇文章中，我写道，起初一切正常，但经过一些小改动，不应该影响工作流的持久化，Sql Workflow Persistence Service 无法将状态保存在数据库中。

我没有提到我将工作流公开为 WCF 服务，事实证明这对于解决这个问题至关重要。我向所有试图解决这个缺乏信息的人道歉。

我使用了指向方法 WCF 服务合同的接收活动。该方法具有复杂类型的返回值：

```
[DataContract]
public class ServiceCallInfo
{
    int code;
    [DataMember]
    public int Code
    {
        get { return code; }
        set { code = value; }
    }
    string message;

    [DataMember]
    public string Message
    {
        get { return message; }
        set { message = value; }
    }
} 
```

我将该返回值绑定到工作流的新属性。

```
public static DependencyProperty ReturnInfoProperty = DependencyProperty.Register("ReturnInfo", typeof(my.mynamespace.ServiceCallInfo), typeof(my.mynamespace.StandardContractingWorkflow));

    [DesignerSerializationVisibilityAttribute(DesignerSerializationVisibility.Visible)]
    [BrowsableAttribute(true)]
    [CategoryAttribute("Parameters")]
    public my.mynamespace.ServiceCallInfo ReturnInfo
    {
        get
        {
            return ((my.mynamespace.ServiceCallInfo)(base.GetValue(my.mynamespace.ReturnInfoProperty)));
        }
        set
        {
            base.SetValue(my.mynamespace.ReturnInfoProperty, value);
        }
    } 
```

如果我只在工作流代码中的某处实例化此属性，Workflow Runtime 将无法保存状态，如果我不这样做，该状态将被正确保存！我假设，由于某种原因，Workflow Runtime 无法序列化（或使用 Sql Workflow Persistence Service 保存状态所做的任何事情）工作流状态，因为这个属性。

也许是因为 ServiceCallInfo 类的定义，也许是别的什么......我希望有更多知识和经验的人能够说出真正的原因......

然而，这个问题被解决了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T05:43:18.443

实际上，您不需要删除这些变量，只需将 NonSerialized 属性放在其上

# delphi - Delphi：降序类中具有相同名称的属性

> ID：659196
> 
> 赞同：4
> 
> 时间：2009-03-18T17:05:38.587
> 
> 标签：delphi, inheritance, properties

在一个文件中，我有一个带有 ID 属性的基类：

```
type
  TBase = class(TObject)  
  private  
    FID: integer;  
  public  
    property ID: integer read FID write SetID;  
  end; 
```

在第二个文件中，我有另一个类，从 TBase 下降。出于偶然、无知或其他原因，创建了一个与现有属性/字段同名的新属性/字段。

```
type
  TSub = class(TBase)
  private
    FID: Longword;
  public     
    property ID: Longword read FID write FID;
  end; 
```

第二个 ID 字段当然是重命名的，但为什么编译器允许这样做呢？
在代码中访问 ID 时 - 使用哪个 ID 字段？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-18T17:22:43.880

Delphi 允许它“隐藏”您的旧属性并引入具有相同名称但操作不同的属性。例如，我使用它为特定类或记录创建自己的类型安全 TList 后代：

```
type
  TMyList = class(TList)
  private
    function GetItem(Index: Integer): TMyObject;
    procedure SetItem(Index: Integer; Value: TMyObject);
  public
    property Items[Index: Integer]: TMyObject read GetItem write SetItem;
  end;

  function TMyList.GetItem(Index: Integer): TMyObject;
  begin
    Result := TMyObject(inherited Items[Index]);
  end;

  procedure SetItem(Index: Integer; Value: TMyObject);
  begin
    inherited Items[Index] := Value;
  end; 
```

当然，有了 Delphi 2009 和泛型，现在就容易多了。

您访问的 ID 取决于您呼叫 ID 的位置。

```
procedure TSub.Foo;
begin
  ID := 5; //TSub.ID
  inherited ID := 6 //TBase.ID
end;

procedure TBase.FooBar;
begin
  ID := 5; //TBase.ID
end;

var
  Sub: TSub;
  Base: TBase;
begin
  Sub := TSub.Create;
  try
    Sub.ID := 1; //assign 1 to TSub.ID
    TBase(Sub).ID := 2; //assign 2 to TBase.ID
    WriteLn(Sub.ID); //writes 1
    WriteLn(TBase(Sub).ID); //writes 2
    Base := Sub;
    WriteLn(Base.ID); //writes 2
  finally
    Sub.Free;
  end;
end; 
```

# php - filter_var 是个好方法吗？

> ID：659197
> 
> 赞同：41
> 
> 时间：2009-03-18T17:05:50.723
> 
> 标签：php, security

`filter_var`过滤数据有什么好处吗？它会过滤什么样的不良数据？我确实使用`mysql_real_escape_string`，但我想知道添加`filter_var`是否有帮助？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-18T17:24:53.423

如果可能，为了防止 SQL 注入，请使用准备好的语句。如果不是，请对字符串使用 mysql_real_escape_string，对整数使用 (int) 强制转换或 intval()，对浮点数使用 (float) 或 floatval()，对要在 LIKE 语句中使用的字符串使用 addcslashes($input, '%_')。当试图转义要在 RLIKE 语句中使用的字符串时，事情会变得更加复杂。

对于过滤 HTML 内容，最好的方法是 strip_tags（不传递 $allowable_tags），但是......您可能不喜欢/不想要它，在这种情况下，最实惠的解决方案是：

```
$escaped = htmlspecialchars($input, ENT_QUOTES, $your_charset); 
```

更可靠的解决方案是使用[HTML Purifier之类的库](http://htmlpurifier.org/)

过滤器功能还可以，但其中一些比过滤器更像验证器。根据您的需要，您可能会发现其中一些很有用。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-18T17:28:08.517

您可以`filter_var`通过将其与[`FILTER_*`constants](http://www.php.net/manual/en/filter.filters.php)一起使用来进行调整。听起来您正在寻找数据的[清理](http://uk3.php.net/manual/en/filter.filters.sanitize.php)（实际上是调整数据以使其安全*）而不是[验证](http://uk3.php.net/manual/en/filter.filters.validate.php)（检查数据是否安全）。

不同的过滤器可以帮助完成不同的任务。虽然`mysql_real_escape_string`清理数据以防止 SQL 注入是可以的，但对于输出可能包含 HTML 的数据却没有好处。这是我用于日常任务的几个过滤器：

*   `FILTER_SANITIZE_SPECIAL_CHARS`- 用于显示（而不是删除）HTML 代码、防止 XSS 攻击和将符号转换为 HTML 实体。
*   `FILTER_SANITIZE_STRING`带有`STRIP_LOW/HIGH`标志 - 实际上删除了 HTML（请参阅 参考资料`strip_tags`）。
*   `FILTER_SANITIZE_URL`- 使 URL 安全*。
*   `FILTER_SANITIZE_EMAIL`- 使电子邮件地址安全，尽管我更喜欢在存储地址之前使用它的验证表亲。

> *我使用安全松散，我认为你永远不能太确定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-04T15:06:25.773

这完全取决于您所说的有效网址或有效电子邮件的含义。

例如`a@b-.c`- 好吧，您可以过滤要排除的顶级域，`.c`但顶级域的列表不是恒定的。而且所有字符都是有效的。尽管这看起来很奇怪并且几乎可以肯定是无效的，但许多正则表达式过滤器也会对其进行验证。

如果在链接中显示或使用电子邮件`a@b-.c`或 URL `http://.`，即使它们无处可去，它们也不会造成伤害。

我认为问题的一部分是你想要你的过滤器有多松的问题。如果最关心的是**XSS**或**SQL 注入**或以其他方式防止危险输入，则该值是否可用可能无关紧要，因此这种过滤器可能会起作用。

如果您想确保该值不仅安全而且可用，那将是一个棘手的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T17:09:27.610

这真的取决于你想要做什么，如果不知道具体情况，我无法真正回答。此处列出了可能的过滤器及其效果：[过滤器类型](http://php.net/manual/en/filter.filters.php)

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2009-03-31T04:45:39.733

仅仅基于一些小的测试，我得出的结论是`filter_var`'s 的常数是不可信的。

例如：

```
filter_var('a@b-.c', FILTER_VALIDATE_EMAIL); // valid
filter_var('http://.', FILTER_VALIDATE_URL); // valid
filter_var('a@b-.c', FILTER_SANITIZE_EMAIL); // a@b-.c
filter_var('http://.', FILTER_SANITIZE_URL); // http://. 
```

这些显然是无效值，但 pass`filter_var`的常量。不要相信`filter_var`。

# javascript - 如何在 Stack Overflow 中显示弹出消息

> ID：659199
> 
> 赞同：103
> 
> 时间：2009-03-18T17:06:12.017
> 
> 标签：javascript, jquery, html, css

我想添加一条弹出消息，例如当我未登录并尝试使用投票按钮时出现在 Stack Overflow 上的消息。

实现这一目标的最佳方法是什么？是否使用 jquery 库完成？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-03-18T17:13:21.453

**编辑**：下面的代码显示了当您获得新徽章时如何复制屏幕顶部显示的栏，首先来到网站等。对于当您尝试评论太快时获得的悬停对话框，请投票对于您自己的问题等，请查看[这个问题](https://stackoverflow.com/questions/758906/how-would-i-implement-stackoverflows-hovering-dialogs)，我将在其中展示如何执行此操作，或者直接转到[示例](http://jsbin.com/oqale)。

* * *

下面是 Stackoverflow 的做法：

这是标记，最初是隐藏的，因此我们可以将其淡入：

```
<div id='message' style="display: none;">
    <span>Hey, This is my Message.</span>
    <a href="#" class="close-notify">X</a>
</div> 
```

以下是应用的样式：

```
#message {
    font-family:Arial,Helvetica,sans-serif;
    position:fixed;
    top:0px;
    left:0px;
    width:100%;
    z-index:105;
    text-align:center;
    font-weight:bold;
    font-size:100%;
    color:white;
    padding:10px 0px 10px 0px;
    background-color:#8E1609;
}

#message span {
    text-align: center;
    width: 95%;
    float:left;
}

.close-notify {
    white-space: nowrap;
    float:right;
    margin-right:10px;
    color:#fff;
    text-decoration:none;
    border:2px #fff solid;
    padding-left:3px;
    padding-right:3px
}

.close-notify a {
    color: #fff;
} 
```

这是javascript（使用jQuery）：

```
$(document).ready(function() {
    $("#message").fadeIn("slow");
    $("#message a.close-notify").click(function() {
        $("#message").fadeOut("slow");
        return false;
    });
}); 
```

瞧。根据您的页面设置，您可能还希望在显示时编辑 body margin-top。

[这是它的实际演示。](http://jsbin.com/owuje)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-18T17:10:25.470

同时签[出 jQuery UI 对话框](http://docs.jquery.com/UI/Dialog)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-18T17:07:08.410

我使用[jqModal](http://dev.iceburg.net/jquery/jqModal/)，易于使用，您可以实现一些很棒的效果

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-18T17:10:52.973

使用 AJAX 控件工具包中的[ModalPopup](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ModalPopup/ModalPopup.aspx)是获得此效果的另一种方法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-02-27T16:04:05.840

这是我通过查看 StackOverflow 源代码发现的。希望为某人节省一些时间。showNotification 函数用于所有这些弹出消息。

```
var showNotification=function(jClicked,msg){master.showErrorPopup(jClicked.parent(),msg)};
var showFadingNotification=function(jClicked,msg){master.showErrorPopup(jClicked.parent(),msg,true)};

//master...
showErrorPopup: function (e, h, f) {
    var g = $('<div class="error-notification supernovabg"><h2>' + h + "</h2>" + (f ? "" : "(click on this box to dismiss)") + "</div>");
    var i = function () {
        g.fadeOutAndRemove()
    };
    $(e).append(g);
    g.click(i).fadeIn("fast");
    setTimeout(i, (f ? Math.max(2500, h.length * 40) : 1000 * 30))
} 
```

css

```
.error-notification{z-index:1;cursor:pointer;display:none;position:absolute;padding:15px;-moz-box-shadow:2px 2px 5px #000;-webkit-box-shadow:2px 2px 5px #000;box-shadow:2px 2px 5px #000;}
.error-notification a{color:inherit;text-decoration:underline;}
.error-notification li{font-size:110%;padding-top:3px;}
.supernovabg{color:#fff !important;background-color:#fe7a15 !important;} 
```

他们如何使用消息的长度来设置淡入淡出超时，这很酷。我没有意识到所有（非淡化风格）消息实际上在 30 秒后淡出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-27T22:47:14.513

检查[引导程序](http://twitter.github.com/bootstrap/)。有一些弹出效果，模态，过渡，警报，一切都基于`javascript`和`css`。

# advertisement-server - 保护第三方广告

> ID：659209
> 
> 赞同：0
> 
> 时间：2009-03-18T17:07:54.913
> 
> 标签：advertisement-server

我想改用安全的 Apache 网络服务器。我做了一些测试，我可以让我的 AdServer 服务到 HTTPS://，因为广告是由我托管的，adtag 是我的，clickthru 也是我的。

但是所有 3rd 方标签都会弹出“内容不安全......”框......我可以保护它吗？

我真的找不到任何成功做到这一点的人，而且我认为你不能......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T16:02:02.900

您应该可以向第三方索要安全标签。99% 的反对者应该能够做到这一点。我确信 Atlas 和 Doubleclick 都可以生成安全标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T10:03:40.793

> 但是所有 3rd 方标签都会弹出“内容不安全......”框......我可以保护它吗？

仅当您使用通过 HTTPS 提供广告的广告网络时。一切都必须是 HTTPS，包括脚本、iframe 和最终使用的图像。许多网络不给你这种能力，但你必须与你正在使用的特定提供商核实。

从理论上讲，您可以通过让广告内容看起来来自您的服务器来停止错误消息，这实际上是作为代理，但是：

*   大多数广告网络都会对此持怀疑态度；看起来您正在实施点击欺诈，并且
*   它实际上并不“安全”——这些错误不会无缘无故出现！如果您的服务器和广告网络之间存在中间人，他们可以将脚本等内容注入您的广告源，通过类似 XSS 的攻击危及您网站的自身安全。

# c# - 将程序集转换为字节 []

> ID：659219
> 
> 赞同：3
> 
> 时间：2009-03-18T17:09:39.933
> 
> 标签：c#, .net, assemblies

我正在尝试将使用 ICodeCompiler 编译的程序集转换为字节 []。我怎样才能做到这一点？还有什么是将这个程序集传输到某个远程位置（客户端）的最安全方法？请注意，对称密钥加密是不可能的。

更新：这个呢？

```
 BinaryFormatter formatter = new BinaryFormatter();
        MemoryStream assemblyStream = new MemoryStream();
        formatter.Serialize(assemblyStream, loAssembly); 
```

如何传输 byte[] ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T17:13:43.997

上次我检查文件通常以字节形式存储在硬盘上。

那么你的确切问题是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T17:15:58.140

使用基于 Stream 的方法重载之一将程序集保存到 MemoryStream 实例。然后，您可以从 MemoryStream 中读取 byte[] 流。

-Oisin

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T17:23:30.587

回答传输问题，这取决于您的偏执程度和您所处的确切情况。您可以选择多种加密方案（[维基百科](http://en.wikipedia.org/wiki/Cryptography)对此有很多详细信息），以及传输选项你可能有空。发送硬拷贝，还是通过网络发送？电子邮件、ftp、ssh ftp？转移与您有什么关系 - 即在您的手和目的地之间转移的哪个时间点，您认为安全可能被破坏？转帐前后如何？一旦您知道这些具体问题是什么，您将能够更有效地解决什么定义为您“最安全”的问题。

# documentation - 比较和对比轻量级标记语言

> ID：659227
> 
> 赞同：89
> 
> 时间：2009-03-18T17:10:40.913
> 
> 标签：documentation, markdown, markup, restructuredtext, textile

请找出最流行的轻量级标记语言并比较它们的优缺点。这些语言应该是技术散文的通用标记，例如文档（例如，Haml 不算在内）。

另请参阅：[Markdown 与 ReStructuredText](https://stackoverflow.com/questions/34276/markdown-versus-restructuredtext)

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-03-18T17:21:29.517

我知道在更大的编程和技术社区中常用的三种主要语言：Textile、Markdown 和 reStructuredText。这三个都可以在几个小时内学会，或者在附近的备忘单上“飞翔”。

### 纺织品

*   由 Redmine 和 Ruby 社区使用
*   目前在 Stack Overflow 上标记了 113 个问题
*   与 HTML 最相似，但可读性最低的源代码
*   所有三种语言的最简单的嵌套列表
*   非程序员或不了解 HTML 的人无法理解
*   非常适合复杂的短文档（带有链接、嵌套列表、代码、自定义 HTML）；例如：简短的文档、操作方法、博客或 CMS 内容
*   [语法参考](http://redcloth.org/hobix.com/textile/)

### 降价

*   似乎没有母语“社区”，但......
*   在 Stack Overflow 上标记了 1274 个问题*
*   强调源代码的可读性，类似于电子邮件传统
*   简单的 HTML 嵌入（您只需输入标签）
*   除了嵌入 HTML 没有办法制作表格
*   如果你知道 Stack Overflow，你就已经知道了
*   如果您已经了解 reStructuredText，则易于学习
*   <address@example.com> 格式的自动电子邮件地址混淆（带尖括号）
*   [语法参考](http://daringfireball.net/projects/markdown/syntax)

### reStructuredText (AKA ReST)

*   流行于 Python 社区
*   在 Stack Overflow 上标记了 285 个问题
*   如果你问我，对空格和对齐有点挑剔
*   列表（尤其是嵌套列表）和段落似乎总是打架
*   非程序员可读
*   唯一可以构建目录的格式（通过 Python 参考实现中的扩展）
*   直接转换为其他格式，如 PDF 和 XML
*   非常适合包含大量散文的大型文档（例如，作为用户手册的 docbook 的替代品）
*   [语法参考](http://docutils.sourceforge.net/docs/user/rst/quickref.html)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-25T22:52:45.913

你也可以考虑[asciidoc](http://www.methods.co.nz/asciidoc/)

*   相对可读的标记
*   直接的命令行使用
*   有些人可能会认为它在语法方面相对“挑剔”（相对于灵活）
*   docbook 和 (x)html 输出

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-07-27T14:20:56.530

[关于轻量级标记语言](http://en.wikipedia.org/wiki/Lightweight_markup_language)的 Wikipedia 页面对各种选项进行了很好的比较，并显示了常用语法（标题、粗体、斜体等）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-06-08T13:18:58.470

我试图在这里涵盖所有各种轻量级标记语言：

[http://www.subspacefield.org/~travis/static_blog_generators.html](http://www.subspacefield.org/~travis/static_blog_generators.html)

如您所见，它从“我如何制作安全博客”开始——即生成静态 HTML 的博客，然后我发现自己陷入了标记语言、模板系统等。

**更新**

我只重新关注具有 python 实现的 LWML，它们在这里：

[http://www.subspacefield.org/~travis/python_lightweight_markup_languages.html](http://www.subspacefield.org/~travis/python_lightweight_markup_languages.html)

到目前为止，我已经尝试过 markdown 和 ReST，除了嵌入在其他页面中的 HTML 片段之外，我更喜欢后者。表格、交叉引用、间接链接等...

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-07-18T16:45:24.300

文件？[氧气](http://www.doxygen.nl/)怎么样？
我已经将它用于我需要记录的一些 c/c++ 项目。甚至你可以像 doxygen 作者用于 doxygen 文档一样“滥用”它

# php - 使用 php sleep() 函数是一个好主意，可以通过繁重的脚本来降低 CPU 负载吗？

> ID：659229
> 
> 赞同：9
> 
> 时间：2009-03-18T17:10:56.827
> 
> 标签：php, sleep

我有一个“生成网站”命令，它解析所有表格以将整个网站重新发布到固定的 html 页面中。这是一个繁重的过程，至少在我的本地机器上（CPU 上升）。在生产服务器上，到目前为止这似乎不是问题，但我想保留它的未来证明。因此，我正在考虑在繁重脚本的每个步骤之间使用 php sleep() 函数，以便服务器有时间在繁重的步骤之间“喘口气”。

这是个好主意还是没用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-18T17:17:02.023

如果您正在运行 php5，并且它在 CGI（而不是 mod_php）模式下使用，那么您可以考虑使用`proc_nice`。

这可能允许“生成网站”命令使用尽可能多的 CPU，而没有其他人试图使用该站点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:42:08.807

我根本不会在生产服务器上这样做，我之前遵循的步骤：

1.  租用低成本的 PHP 服务器 - 或获得适当的开发服务器设置来复制生产

2.  所有动态文件都被复制到 DEV - 他们甚至不需要在生产中

3.  运行 HTMLizer 脚本 - 不睡觉就烧掉它

4.  验证输出，然后将其 RSYNC 到实时服务器 - 备份实时目录，以便您可以安全地回退

无论如何，自从 Caching / Memcaching 加快速度以来，我根本不必这样做 - 使用 Zend Framework 和 Zend Cache，你基本上有一个动态等效于你需要自动执行的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T17:15:30.967

我认为这是个好主意。睡眠意味着重复比较滴答声，直到某个时期出现。睡眠操作对 CPU 的开销应该更低。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T17:25:05.340

这取决于您将调用它多少次以及调用多长时间。您需要在快速输出与低 CPU 使用率之间取得平衡。

简而言之：是的，它会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-22T23:38:22.000

根据任务，我认为它不会对您有所帮助。

只有在您不断循环并等待用户输入或触发信号时，睡眠才会真正有用。

在这种情况下，为了尽快完成工作，您也可以省略 sleep 命令，从而减少任务时间并为其他进程更快地释放 CPU 时间。

上面的一些海报可能能够更好地帮助您进行代码优化。

# c++ - 交叉赋值运算符？

> ID：659231
> 
> 赞同：3
> 
> 时间：2009-03-18T17:11:49.600
> 
> 标签：c++

现在是我第一个问题的时候了。如何在两个类之间交叉赋值运算符？

```
class B;

class A {
public:
A &operator = ( const B &b );
friend B &B::operator = ( const A &a ); //compiler error
};

class B {
public:
B &operator = ( const A &a );
friend A &A::operator = ( const B &b );
}; 
```

我搜索了如何转发声明一个成员函数，例如：

```
class B;
B &B::operator = ( const A &a ); //error 
```

但我什么也没找到。而且我不想让班级彼此成为完全的朋友。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T17:28:49.827

没有办法前向声明成员函数。我不确定是否有比这更优雅的方式来获得你想要的东西（我从来没有理由做这样的事情），但是让第二类成为非成员函数会起作用那是两个班级的朋友，并将复制委托给它。请注意， operator= 本身不能是非成员，但这样的事情应该可以工作：

```
class B;

class A {
public:
  A& operator = ( const B &b );
  friend B& do_operator_equals ( B& b, const A& b);
};

class B {
public:
  B &operator = ( const A &a );
  friend A& A::operator = ( const B &b );
  friend B& do_operator_equals ( B& b, const A& a);
}; 
```

然后在你的实现文件中

```
A& A::operator= (const B& b) {
   // the actual code to copy a B into an A
   return *this;
}

B& B::operator= (const A& a) {
   return do_operator_equals(*this, a);
}

B& do_operator_equals(B& b, const A& a) {
  // the actual code to copy an A into a B
  return b;
} 
```

**编辑：**把 A 和 B 弄反了，哎呀。固定的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:03:11.380

编译器错误的原因是循环依赖。您的每个 operator=() 函数都需要了解另一个类中的 operator=() 函数，因此无论您以哪种顺序定义类，总会出现错误。

这是一种解决方法。它不是很优雅，但它会做你想做的事：

```
class A;
class B;

A & set_equal(A & a, const B & b);
B & set_equal(B & a, const A & a);

class A
{
    private:
        int x;
    public:
        A & operator=(const B & b) { return set_equal(*this, b); }
        friend B & set_equal(B & b, const A & a);
        friend A & set_equal(A & a, const B & b);
};

class B
{
    private:
        int y;
    public:
        B & operator=(const A & a) { return set_equal(*this, a); }
        friend A & set_equal(A & a, const B & b);
        friend B & set_equal(B & b, const A & a);
};

A & set_equal(A & a, const B & b) { a.x = b.y; return a; }
B & set_equal(B & b, const A & a) { b.y = a.x; return b; } 
```

你也可以通过继承来解决这个问题。

**编辑：**这是一个使用继承的例子。如果复制过程只需要访问 A 和 B 共享的一些公共数据，这将起作用，如果 = 运算符根本没有任何意义，这似乎很可能。

```
class A;
class B;

class common
{
    protected:
        int x;
        void copyFrom(const common & c) { x = c.x; }
};

class A : public common
{
    public:
        A & operator=(const common & c) { copyFrom(c); return *this; }
};

class B : public common
{
    public:
        B & operator=(const common & c) { copyFrom(c); return *this; }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T17:33:38.737

你为什么希望他们首先成为朋友？
这似乎是你写它的方式是不可能的。解决方案可能是根本不让他们成为朋友。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-03-18T17:33:03.917

您不转发声明成员函数，而是转发声明类。

```
class B;  // DECLARE class B but don't define its contents

class A { // ... uses B as above
};

class B { // ... now you define the class.
}; 
```

请参阅[C++ 常见问题解答第 39 节](http://www.parashift.com/c++-faq-lite/misc-technical-issues.html)。

# c# - 这是单一职责原则的一个例子吗？

> ID：659232
> 
> 赞同：6
> 
> 时间：2009-03-18T17:11:52.627
> 
> 标签：c#, design-patterns, solid-principles

我制作了以下代码示例来学习如何使用泛型方法签名。

为了同时获得 Customer 和 Employee 的**Display() 方法**，我实际上开始用 Person 抽象类替换我的**IPerson****接口**。

 **但后来我停了下来，想起了一个播客，其中 Bob 叔叔告诉 Scott Hanselman**单一职责原则**，其中你应该有很多小类，每个类都做一件特定的事情，即 Customer 类不应该有**Print()**和**Save ()**和**CalculateSalary()**方法，但您应该有一个***CustomerPrinter 类*** 和一个***CustomerSaver 类***和一个***CustomerSalaryCalculator 类***。

这似乎是一种奇怪的编程方式。然而，**摆脱我的界面也感觉不对**（因为有很多 IoC 容器和 DI 示例固有地使用它们）所以我决定尝试单一责任原则。

因此**，以下代码与我过去编写的代码不同**（我会使用 Display() 方法创建一个抽象类并摆脱接口），但基于我听说的关于解耦和 SOLID 原则的内容，**这个新的编码方式**（接口和 PersonDisplayer 类） **我认为这是正确的方法**。

我想**听听其他人**在这个问题上是否有同样的想法，或者是否经历过这个问题的积极或消极影响（例如，数量庞大的班级，每个班级都在做一件特定的事情，等等）。

```
using System;

namespace TestGeneric33
{
    class Program
    {
        static void Main(string[] args)
        {
            Container container = new Container();
            Customer customer1 = container.InstantiateType<Customer>("Jim", "Smith");
            Employee employee1 = container.InstantiateType<Employee>("Joe", "Thompson");
            Console.WriteLine(PersonDisplayer.SimpleDisplay(customer1));
            Console.WriteLine(PersonDisplayer.SimpleDisplay(employee1));
            Console.ReadLine();
        }
    }

    public class Container
    {
        public T InstantiateType<T>(string firstName, string lastName) where T : IPerson, new()
        {
            T obj = new T();
            obj.FirstName = firstName;
            obj.LastName = lastName;
            return obj;
        }
    }

    public interface IPerson
    {
        string FirstName { get; set; }
        string LastName { get; set; }
    }

    public class PersonDisplayer
    {
        private IPerson _person;

        public PersonDisplayer(IPerson person)
        {
            _person = person;
        }

        public string SimpleDisplay()
        {
            return String.Format("{1}, {0}", _person.FirstName, _person.LastName);
        }

        public static string SimpleDisplay(IPerson person)
        {
            PersonDisplayer personDisplayer = new PersonDisplayer(person);
            return personDisplayer.SimpleDisplay();
        }
    }

    public class Customer : IPerson
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string Company { get; set; }
    }

    public class Employee : IPerson
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public int EmployeeNumber { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-18T17:39:10.517

我喜欢将[单一职责原则视为](http://en.wikipedia.org/wiki/Single_responsibility_principle)[职责分离的](http://en.wikipedia.org/wiki/Separation_of_duties)一种实现。在我像你一样开始分班之前，我试着想想每个班级应该负责什么。

您的类非常简单，并且非常适合具有您提到的实现`Print()`和`Save()`功能的抽象类。我倾向于保留该设计而不是您当前的设计。

但是，如果打印和保存是可能以不同方式执行的更复杂的任务，则需要一个专用`Printer`或`Saver`类，因为现在该责任更加复杂。创建一个新类的“复杂性”阈值是非常主观的，将取决于具体情况，但最终，代码只是我们低等人类理解的抽象，所以让它最直观。

你`Container`的课有点误导。它实际上并不“包含”任何东西。它实际上实现了[工厂方法模式](http://en.wikipedia.org/wiki/Factory_method)，并将受益于被命名为工厂。

此外，您`PersonDisplayer`的永远不会被实例化，并且可以通过静态方法提供其所有功能，那么为什么不将其设为静态类呢？诸如打印机或保存程序之类的[实用程序类](http://en.wikipedia.org/wiki/Utility_pattern)是静态的并不少见。除非您需要具有不同属性的打印机的单独实例，否则请使其保持静态。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-18T17:28:45.987

我认为你在正确的轨道上。不过，我并不完全确定 Container 类。我通常会坚持使用更简单的解决方案，即对这些对象使用“new”，除非您对该接口有一些业务驱动的需求。（从这个意义上说，我不认为“整洁”是业务需求）

但是将“成为”客户责任与“展示客户”分开是很好的。坚持这一点，这是对 SOLID 原则的很好的解释。

就个人而言，我现在已经*完全*停止在这种代码中使用任何类型的静态方法，我依靠 DI 在正确的地点和时间获取所有正确的服务对象。一旦你开始进一步阐述 SOLID 原则，你会发现你正在制作更多的课程。尝试使用这些命名约定以保持一致。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T17:22:23.197

好吧，我以前从未听说过这种“单一责任原则”，但在我看来，你通过拥有这些 CustomerPrinter 类和 CustomerSaver 类所做的只是将类转换回结构，并取消面向对象一切。

例如，这意味着如果需要以不同方式打印不同的客户类型，则需要在 CustomerPrinter 类中使用不同的案例。但据我了解，OO 组织以及使用继承树和所有这些的要点之一是消除 CustomerPrinter 知道如何打印所有内容的需要：客户知道如何打印自己。

在任何情况下，我都不相信严格遵循这些范式。例如，我不确定在您的情况下接口和抽象类之间的区别是什么。但话又说回来，我是 C++ 程序员而不是 C# 程序员......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T17:44:14.717

几点注意事项：

*   一般来说，SRP 都很好，显示格式与数据的分离也是如此。
*   考虑显示等。我宁愿从服务方面考虑，即 PersonDisplayer 是单一的、无状态的并提供字符串 Display(IPerson) 功能。恕我直言，仅提供显示的特殊类包装器并没有提供任何优势。
*   但是，如果您为 wpf 使用数据绑定，则您可能有一个 DisplayablePerson 类，如果 Person 发生更改，该类将传播 PropertyChanged。您可以将 DisplayablePerson 对象放入 ObservableCollection 并将其用作某些列表控件的 ItemsSource。
*   您需要 Container 做什么，是否仅用于实例化和配置实例？然后尝试 Customer customer1 = new Customer{FirstName="Jim", LastName="Smith"};

*   附带说明一下，我已经尝试了几次 object.Method < SomeType>(...) 调用，因为它似乎是最快和最简单的解决方案。但是，一段时间后，我总是在那个问题上遇到麻烦，最终得到了 object.Method(Type someTypeType, ...)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T18:15:45.080

您可能会看看[IFormattable](http://msdn.microsoft.com/en-us/library/system.iformattable.aspx)和[IFormatProvider](http://msdn.microsoft.com/en-us/library/system.iformatprovider.aspx)。

该框架具有用于支持的格式化类。

# ruby-on-rails - Ruby on Rails ActiveRecord 条件验证（以及更多..）

> ID：659240
> 
> 赞同：1
> 
> 时间：2009-03-18T17:12:47.960
> 
> 标签：ruby-on-rails, validation, activerecord, iframe, upload

我有一个验证多个属性（包括回形针图像附件）的**产品模型，如下所示：**

```
validates_presence_of :name
validates_format_of :name, :with => /^([a-zA-Z0-9\ \-]{3,128})$/i
...
has_attached_file :image

validates_attachment_presence :image
validates_attachment_content_type :image, :content_type => ["image/jpeg", "image/png", "image/gif"] 
```

一切正常。我现在想要的是使用 javascript制作一个*（不显眼的）隐藏 iframe 就地上传脚本。*我的问题是我不能在没有其余数据的情况下仅上传图像，因为它将无法验证（不存在名称），而且我无法在没有图像的情况下发送表单的其余部分（同样的，验证失败）。

所以基本上我需要（并且不知道如何实现）是根据当前正在进行的操作（上传图像或编辑其他数据）有条件地应用模型验证。

我希望我足够清楚。任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T18:19:44.447

[Railscasts](http://railscasts.com/episodes/41-conditional-validations)有一个关于条件验证的精彩视频截屏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-15T05:57:45.453

我讨厌为了得到一个简单的答案而不得不浏览视频。事实上，我认为博客条目优于简单的教程视频，仅仅是因为它是可搜索的。这是一个简单的纯文本案例，供其他人查看：

要仅验证 create 操作的密码是否存在，请执行以下操作：

```
validates_presence_of :password, :on => :create 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-06T20:37:28.527

对彼得 D 的评论。

非常感谢你。我目前无法观看该屏幕投射（尽管我打算）并且正在寻找一个快速、简短的答案。

将您的建议纳入我拥有的模型中，并且运行良好。（虽然我怀疑在某些时候我需要在更改密码时进行更新验证。不过，我现在将其视为“技术债务”，以便继续前进。）

我添加的一点：

```
validates :password, :presence => true, :confirmation => true, :on => :create 
```

# java - 您将如何更改文件中的单个字节？

> ID：659244
> 
> 赞同：7
> 
> 时间：2009-03-18T17:13:25.947
> 
> 标签：java

使用 Java 更改文件中单个字节的最佳方法是什么？我已经以多种方式实现了这一点。一个使用所有字节数组操作，但这对可用内存量高度敏感，并且不会扩展到超过 50 MB 左右（即，我无法分配 100MB 的 byte[] 而不会出现 OutOfMemory 错误）。我还以另一种可行的方式实现了它，并且可以扩展，但感觉很hacky。

如果您是 java io 专家，并且必须处理非常大的文件（200-500MB），您会如何处理这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-18T17:16:14.927

我会使用[RandomAccessFile](http://java.sun.com/j2se/1.4.2/docs/api/java/io/RandomAccessFile.html)，寻找我想要更改的位置并写入更改。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-18T17:16:33.083

如果我只想更改一个字节，我就不会费心将整个文件读入内存。我会使用[`RandomAccessFile`](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html),[`seek`](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html#seek(long))到有问题的字节，[写入](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html#writeByte(int))它，然后关闭文件。

# vim - vim 的树状结构插件

> ID：659249
> 
> 赞同：5
> 
> 时间：2009-03-18T17:14:29.360
> 
> 标签：vim

有谁知道 vim 的一些插件，它可以像今天的许多记事应用程序一样启用树状记事组织。例如，类似的东西[会](http://screenshots.en.softonic.com/en/scrn/67000/67366/3_mempad01.jpg)根据左边的树在目录结构中创建另一个文件，以便将多个文件放在一起，在一棵树下，但仍然可以查看它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T08:33:49.307

看看[VimOutliner](https://github.com/vimoutliner/vimoutliner)。

引自网站：

> 什么是 VimOutliner？
> 
> Vim Outliner 是一个 vim 插件，它可以将强大的 vim 编辑器变成 GrandView、More 和 MaxThink 等强大的大纲工具。它对键盘手友好且速度非常快。如果您可以触摸打字，则可以以您想像的速度快速勾勒。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T17:22:21.400

您可以查看“DotOutlineTree：帮助您编辑结构化文本”。

[http://www.vim.org/scripts/script.php?script_id=1225](http://www.vim.org/scripts/script.php?script_id=1225)

“Viki/Deplate : Vim 的个人 wiki”

[http://www.vim.org/scripts/script.php?script_id=861](http://www.vim.org/scripts/script.php?script_id=861)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T18:08:44.613

您可以只使用 NerdTree，[http](http://www.vim.org/scripts/script.php?script_id=1658) ://www.vim.org/scripts/script.php?script_id=1658 - “树浏览器插件”，无论如何单独使用它并从那时起处理文件。创建目录就像 :!mkdir 目录一样简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T17:21:49.733

这是在 vim 中以树状方式记笔记的一种有点费力的方法：

[http://www.youtube.com/watch?v=XPC3YQCID8k](http://www.youtube.com/watch?v=XPC3YQCID8k)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-11T08:22:36.187

vimwiki[插件](http://code.google.com/p/vimwiki/)对（嵌套）列表和清单有一些漂亮的功能。当然，还有更多与 wiki 相关的功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-11T01:08:57.880

你应该试试 voom 插件[http://www.vim.org/scripts/script.php?script_id=2657](http://www.vim.org/scripts/script.php?script_id=2657) 最好。

# javascript - 请检查我的 Javascript 代码段。这是 FB Mobwars 的油脂猴脚本

> ID：659257
> 
> 赞同：-1
> 
> 时间：2009-03-18T17:16:09.887
> 
> 标签：javascript, greasemonkey

嘿伙计们，我正在通过开发greasemonkey 脚本来练习我的Javascript 编程，理论上它会改进我的javascript 编码，因为它是原始的javascript。

所以现在，我正在为 Mobwars facebook 编写一个脚本。这是一个游戏，你可以杀人、偷东西、制造怪物等等。

为了更好地理解这一点，这是页面的屏幕截图：

[alt text http://www.picamatic.com/show/2009/03/18/08/11/2877480_703x486.png](http://www.picamatic.com/show/2009/03/18/08/11/2877480_703x486.png) 我要做的是扫描页面，获取作业名称并显示它给用户。

我想要获取 Mugging、House Burgary、Stoplight Car Theft 等文本

文本具有设置为银色的颜色属性。

看看我的代码，我在 Firebug 中尝试过，但它甚至没有发出警报..

```
var jobs = {};

jobs.scan = function() {
    var tagHolder = {};
    var availJobs = {};
    var jobContents = dom.get("app8743457343_content");
    var rData = dom.getElementsByClass(rowData, jobContents, "tr");
    for(var i = 0; i < rData.length; i++) {
        var rChildren = rData[i].childNodes;
        for(var j = 0; j < rChildren.length; j++) {
            if(rChildren[j].tagName === "B") {
                tagHolder.push(rChildren[j]);
            }
        }
        for(var k = 0; k < tagHolder.length; k++) {
            if (tagHolder[k].color == "silver") {
                availJobs.push(tagHolder[k].textContent);
            }
        }
    }
    return alert(availJobs[0]);
}

jobs.scan(); 
```

告诉我代码有什么问题。我会调整这段代码，如果我设法修复它，我会在这里再次报告。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T17:46:14.480

你有自定义的“getElementsByClass”函数吗？DOM 没有 getElementsByClass 方法。也许您正试图从其他地方借用代码而没有意识到这一点？

互联网上有很多 getElementsByClass 方法可用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-15T20:41:53.953

+1 for ybo, your answer was spot on given the information available. I had a quick look at the relevant markup from the Mob Wars page, and it looks like this:

```
<div id="app8743457343_content" fbcontext="db6ca1f1773e">
 ...
   <b style="font-size: 15px; color: silver;">Mugging</b>
 ... 
```

I modified your solution based on the actual markup to:

```
// ==UserScript==
// @name          Mob Wars Job List
// @namespace     namespace
// @description   Script to summarise available Mob Wars jobs.
// @include       http://apps.facebook.com/mobwars/jobs/
// @require       http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js
// ==/UserScript==

$(document).ready(function() {
var jobs = {};
jobs.scan = function() {
    var availJobs = new Array();
    $("#app8743457343_content b").each(function() {
        if ($(this).css("color") == "silver")
            availJobs.push($(this).text());
    });
    return alert("Available jobs:\n" + availJobs.join('\n'));
}
jobs.scan();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T18:12:58.113

对 Perchik +1，如果您不提供您使用的函数的定义，以及它应该运行的 html，我们真的无法帮助您检查您的代码。

无论如何，我仍然看到你可以改变的两件事。第一个是将数组初始化为数组，而不是空对象。`push`如果您的变量不是数组，则不能使用该方法：

```
var tagHolder = new Array();
var availJobs = new Array(); 
```

第二个是使用 jQuery 或任何其他可以让您的生活更轻松的 javascript 库。在 GreaseMonkey 中，您可以使用`@require`：

```
// ==UserScript==
// @name           Script Name
// @namespace      namespace
// @include        http://www.website.net/*
// @require        http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js
// ==/UserScript== 
```

**当您将**脚本添加到 GreaseMonkey 时`@required`会检索脚本：如果您想使用它，您必须删除您的脚本并重新加载它。GreaseMonkey 然后将保留脚本的本地副本并在需要时加载它们。**`@required`**

 **使用 jQuery，您的代码将如下所示：

```
var jobs = {};

jobs.scan = function() {
    var tagHolder = new Array();
    var availJobs = new Array();
    $("#app8743457343_content b").each(function() {
        tagHolder.push(this);
        if ($(this).attr("color") == "silver")
            availJobs.push($(this).text());
    });
    return alert(availJobs[0]);
}

jobs.scan(); 
```

# asp.net - ASP.net：Sqldatasource 和 Session 变量

> ID：659265
> 
> 赞同：2
> 
> 时间：2009-03-18T17:18:00.240
> 
> 标签：asp.net

```
<asp:HiddenField ID="hfDualInitials" runat="server" Visible="false" OnInit="hfDualInitials_OnInit" />
    <asp:SqlDataSource ID="sdsStoreNo" runat="server" ConnectionString="<%$ ConnectionStrings:ConnStr %>"
        SelectCommand="select * from AccountCancellation_Process 
                       where store_num in (select distinct storeno from franchisedata where initials in (@DualInitials))
                       order by CustomerName ASC" >
        <SelectParameters>
            <asp:ControlParameter ControlID="hfDualInitials" DbType="String" Name="DualInitials" />
        </SelectParameters>                     
    </asp:SqlDataSource> 
```

我有一个带有上述选择命令和以下代码的 Sqldatasource 来设置隐藏字段值

```
Protected Sub hfDualInitials_OnInit(ByVal sender As Object, ByVal e As EventArgs)        
    Dim _DualInitials As String = "('P2','7T')"
    Session.Add("DualInitials", _DualInitials)
    Me.hfDualInitials.Value = Session("DualInitials")
End Sub 
```

我正在用 ('P2','7T') 模拟会话，它将传递给上面的 sql 命令。当我运行查询时：

```
select * from AccountCancellation_Process where store_num in (select distinct storeno from franchisedata where initials in ('P2','7T')) 
```

它返回一些数据，但在我的 Sqldatasource 选择命令中。它什么也不返回。我的猜测是因为（@DualInitials）中的首字母（）已经在隐藏字段中，但是如果我删除（）并且只有@DualInitials。我会得到“'@DualInitials' 附近的语法不正确。”

有谁知道任何解决方法或我哪里弄错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T17:55:27.437

查看[ADO.NET TableAdapter 参数](https://stackoverflow.com/questions/649838/ado-net-tableadapter-parameters)问题的答案。

您有一个带有字符串参数的查询，而不是数组参数。因此，当您通过“（'P2'，'7T'）”时，您认为最终查询是

```
WHERE initials IN ('P2', '7T') 
```

实际上它是

```
WHERE initials IN ('(''P2'', ''7T'')') 
```

如果它只是两个首字母，那么只需使用 OR 语句重写。否则，除了其他线程中提到的那些之外，我不知道好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-10T23:04:48.243

如果不运行示例，我无法确定，但是呢？

```
WHERE initials IN (<%=Eval(@DualInitials)%>) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T19:45:12.837

您不能像这样在 SQL 中对 IN 语句进行参数化。您将不得不使用 SQL 的字符串连接（不好）或其他一些技术，例如解析分隔字符串。

# printf - cout 和 printf 的缓冲区和输出序列

> ID：659266
> 
> 赞同：1
> 
> 时间：2009-03-18T17:18:28.367
> 
> 标签：printf, buffer, cout

我知道今天 cout 和 printf 有缓冲区，据说缓冲区有点像堆栈，从右到左获取 cout 和 printf 的输出，然后从上到下将它们输出（到控制台或文件）。像这样，

```
a = 1; b = 2; c = 3;
cout<<a<<b<<c<<endl;
buffer：|3|2|1|<-   (take “&lt;-” as a poniter)

output：|3|2|<-     (output 1)
        |3|<-       (output 2)
        |<-         (output 3) 
```

然后我在下面写一个代码，

```
#include <iostream> 
using namespace std; 
int c = 6;
int f() 
{   
    c+=1; 
    return c; 
} 

int main() 
{ 
     int i = 0; 
     cout <<"i="<<i<<" i++="<<i++<<" i--="<<i--<<endl; 
     i = 0;
     printf("i=%d i++=%d i--=%d\n" , i , i++ ,i-- );

     cout<<f()<<" "<<f()<<" "<<f()<<endl; 
     c = 6;
     printf("%d %d %d\n" , f() , f() ,f() );
     system("pause");
     return 0; 
} 
```

VS2005下，输出为

```
i=0 i++=-1 i--=0
i=0 i++=-1 i--=0
9 8 7
9 8 7 
```

在 g++( (GCC) 3.4.2 (mingw-special)) 下，输出为，

```
i=0 i++=0 i--=1
i=0 i++=-1 i--=0
9 8 7
9 8 7 
```

看起来缓冲区就像一个堆栈。但是，我今天阅读了**C++ Primer Plus**，据说 cout 从左到右工作，每次返回一个对象（cout），所以“这就是让您通过插入连接输出的功能”。但是从左到右的方式无法解释 cout< 输出 9 8 7 现在我对 cout 的缓冲区如何工作感到困惑，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-18T17:21:30.887

输出：

```
printf("i=%d i++=%d i--=%d\n" , i , i++ ,i-- ); 
```

未指定。这是 C++ 的一个常见缺陷：未指定参数评估顺序。

cout 情况并非如此：它使用链式调用（序列点），而不是单个函数的参数，因此评估顺序从左到右定义良好。

**编辑：** David Thornley 指出上述代码的行为实际上是**[undefined](http://www.devx.com/tips/Tip/12684)**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T17:20:39.313

这不是错误，也与输出缓冲无关。

`i--`当and`i++`操作作为同一个函数调用的参数被多次调用时，并没有定义它们的执行顺序。

为了详细说明（并且可能是正确的）Iraimbilanja 提到的“序列点”，该`cout`版本相当于：

```
(((cout << a) << b) << c) 
```

实际上，它实际上是三个独立的函数调用，每个函数的参数都按顺序计算，即使它写得像一条语句。

`<<`运算符是真的，`ostream& operator<<(ostream& os, int)`所以另一种写法是：

```
operator<< ( operator<< ( operator<< ( cout, a ), b ), c ) 
```

由于对于外部调用，它没有（AFAIK）定义评估两个参数的顺序，因此右侧“c”参数（或在您的情况下为“ `i--`”）完全有可能在评估左侧参数之前发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T17:31:59.397

如果可能，请尝试更新到 gcc >= 4。我刚刚在 4.0.1 上运行它，它执行得很好。

# c# - 明智的猫头鹰会正确混淆 wpf 项目吗？

> ID：659267
> 
> 赞同：0
> 
> 时间：2009-03-18T17:18:29.693
> 
> 标签：c#, wpf, obfuscation, owl, wise

我们正在从 windows 窗体迁移到 wpf 以用于我正在开发的下一个版本的产品。我们正在使用明智的猫头鹰来进行混淆，我想知道是否有人有这方面的经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-28T15:34:30.513

是的，它可以做到。您需要将不想绑定的所有内容标记为不混淆，但它可以工作。

# c++ - 为什么数组有特殊的new和delete？

> ID：659270
> 
> 赞同：11
> 
> 时间：2009-03-18T17:19:59.300
> 
> 标签：c++, arrays, memory-management, new-operator

使用`delete`而不是有什么问题`delete[]`？

在分配和释放数组的背后是否发生了一些特别的事情？

为什么它会不同于`malloc`和免费？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-18T17:21:43.133

使用创建的对象`new[]`必须使用`delete[]`. 使用`delete`在数组上是未定义的。

使用 malloc 和 free 你有一个更简单的情况。只有 1 个函数可以释放您分配的数据，也没有调用析构函数的概念。混淆只是因为`delete[]`和 delete 看起来相似。实际上它们是两个完全不同的功能。

使用 delete 不会调用正确的函数来删除内存。它应该调用`delete[](void*)`，但它调用`delete(void*)`. 出于这个原因，您不能依赖使用`delete`分配的内存`new[]`

[请参阅此 C++ 常见问题解答](http://www.parashift.com/c++-faq-lite/freestore-mgmt.html#faq-16.13)

> [16.13] 删除`[]`某些内置类型（char、int 等）的数组时可以删除吗？
> 
> 不！
> 
> 有时程序员认为 `[]`in`delete[] p`唯一存在，因此编译器将为数组中的所有元素调用适当的析构函数。由于这个原因，他们假设一些内置类型的数组，例如`char`or`int`可以在 `delete`没有`[]`. 例如，他们假设以下是有效代码：
> 
> ```
> void userCode(int n)  {
>     char* p = new char[n];
>     ...
>     delete p; // ← ERROR! Should be delete[] p !
> } 
> ```
> 
> 但是上面的代码是错误的，它会在运行时造成灾难。特别是，被调用的 代码`delete p`是`operator delete(void*)`，但被调用的代码 `delete[] p`是`operator delete[](void*)`。后者的默认行为是调用前者，但允许用户用不同的行为替换后者（在这种情况下，他们通常也会替换 operator 中相应的新代码`new[](size_t)`）。如果他们替换了`delete[]`代码，使其与删除代码不兼容，并且您调用了错误的代码（即，如果您说`delete p`而不是`delete[] p`），那么您可能会在运行时遇到灾难。

**为什么`delete[]`首先存在？**

无论你做 x 还是 y：

```
 char * x = new char[100]; 
 char * y = new char; 
```

两者都存储在`char *`类型变量中。

我认为决定的原因`delete`，并`delete[]`伴随着一长串有利于 C++ 效率的决定。这样就没有强制的价格来查找正常删除操作需要删除多少。

拥有 2`new`并且`new[]`似乎只有逻辑才能拥有`delete`，`delete[]`无论如何都是对称的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-18T17:22:11.433

不同之处在于`delete`只会删除整个内存范围，但只会为 1 个对象调用析构函数。 `delete[]`将删除内存并为每个对象调用析构函数。如果您不使用`delete[]`数组，那么将资源泄漏引入应用程序只是时间问题。

**编辑**更新

根据标准，传递分配给`new[]`to的对象`delete`是未定义的。**可能**的行为是它会像我描述的那样运行。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-18T19:23:13.840

Stroustrup在第 10.3 到 10.5.1 节的“C++ 的设计和演变”中谈到了分离`new`/`new[]`和delete[]` 运算符的原因：`delete/`

*   **10.3 数组分配**- 讨论他们想要一种方法来允许使用与分配单个对象不同的方案来分配对象数组（即，从单独的存储中分配数组）。`new`添加和的数组版本`delete`是解决此问题的方法；
*   **10.5.1 解除分配数组**- 讨论仅使用单个`delete`运算符解除分配数组的问题是，需要比指针更多的信息来确定指针是指向数组的第一个元素还是只指向数组的第一个元素到单个对象。`delete[]`运算符用于处理数组，而不是“使分配和释放单个对象的常见情况复杂化” 。这符合“不为不使用的东西付费”的一般 C++ 设计理念。

这个决定是否是一个错误是有争议的——无论哪种方式都有很好的论据，但我们拥有我们所拥有的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-18T18:09:35.173

这个要求的原因是历史性的，因为`new type`和`new type [size]`返回不同的东西需要不同的清理。

考虑这段代码

```
Foo* oneEntry = new Foo;
Foo* tenEntries = new Foo[10]; 
```

它们都返回一个`Foo*`指针，不同之处在于第二次调用将导致 Foo 构造函数被调用 10 倍，并且大约有 10 倍的内存。

所以现在你想释放你的对象。

对于单个对象，您可以调用 delete - 例如`delete oneEntry`。这将调用对象析构函数并释放内存。

但问题是—— oneEntry 和 tenEntries 都只是`Foo`指针。编译器不知道它们是指向一个、十个还是一千个元素。

当您使用`delete []`. 这告诉编译器“这是一个对象数组，计算出计数然后将它们全部销毁”。

真正发生的是`new type [size]`编译器秘密地将“大小”存储在其他地方。当您调用 delete[] 时，它知道该秘密值存在，因此它可以找出该内存块中有多少对象并销毁它们。

然后您可能会问的问题是“为什么编译器不总是存储大小？”

这是一个很好的问题，它可以追溯到 C++ 的早期。人们希望对于内置类型（char、int、float 等），以下内容对 C++ 有效；

```
int* ptr = new int;
free(ptr);

int* ptr = (int*)malloc(sizeof(int) * someSize);
delete ptr; 
```

这背后的原因是人们期望人们提供返回动态分配内存的库，而这些库的用户将无法知道是否使用 free/delete。

这种对兼容性的渴望意味着数组的大小不能作为数组本身的一部分存储，而必须保存在其他地方。由于这种开销（请记住，这可以追溯到 80 年代初），因此决定只为数组而不是单元素进行此簿记。因此数组需要一个特殊的删除语法来查找这个值。

原因`malloc`/`free`没有这个问题是他们只是处理内存块，不必担心调用构造函数/析构函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T17:38:02.893

`new`和`delete`不同`malloc`的`free`是`malloc`，`free`只分配和释放内存；他们不叫ctors或dtors。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-18T18:26:54.803

至于标题中的“为什么”：C++ 的设计目标之一是不存在任何隐藏成本。C++ 也是在每个内存字节仍然比今天重要得多的时候开发的。语言设计者也喜欢正交性：如果你用`new[]`（而不是`new`）分配内存，你应该用`delete[]`.

我认为没有任何*技术*原因`new[]`不能在内存块的标题中粘贴“我是一个数组”标志以供`delete`（不再`delete[]`）查看。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-18T17:26:30.080

当你`new[]`用来分配一个数组时，你实际上是在告诉 C++ 数组的大小。当您使用 时`malloc`，您是在告诉它分配了多少内存。在前一种情况下，根据数组的大小进行释放是没有意义的。在这种情况下，确实如此。但是由于数组的指针与单个对象的指针之间没有区别，因此需要一个单独的函数。

# asp.net - 在 asp.net 中引用 jquery 的最佳方法是什么？

> ID：659272
> 
> 赞同：8
> 
> 时间：2009-03-18T17:20:37.350
> 
> 标签：asp.net, jquery

我观看了 Stephen Walther 的 pdc 会话，在演示文稿中他引用了 JQuery js 文件，如下所示：

```
<asp:ScriptManager id="sm1" runat="server">
<Scripts>
    <asp:ScriptReference Path="~/Scripts/JQuery.js" />
</Scripts>
</asp:ScriptManager> 
```

以上述方式而不是仅在页面的头部使用链接是否有优点或缺点。

他还将以下内容放入示例页面的 javascript 部分以运行 JQuery：

```
<script type="text/javascript">

function pageLoad()
{
   $(":text").css("background-color","yellow");
}
</script> 
```

上面需要pageLoad吗？他提到它来自 Microsoft AJAX 库，它等待 DOM 完成加载，但我认为 JQuery 中的 $ 符号只是等待 DOM 完成加载的简写。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-18T17:24:44.563

$(document).ready() 和 pageLoad() 不一样！

[http://encosia.com/2009/03/25/document-ready-and-pageload-are-not-the-same/](http://encosia.com/2009/03/25/document-ready-and-pageload-are-not-the-same/)

来自文章：

pageLoad() 在 DOM 完成加载后被调用。但这并不是调用 pageLoad() 的唯一点：在**每次**部分回发之后也会调用它。

对于应该**运行一次**的初始化代码，$(document).ready() 是理想的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-18T17:32:00.973

使用 ScriptManager，ASP.NET 可以创建单个复合脚本以减少浏览器请求的数量，并且如果浏览器支持它，还可以压缩脚本。

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
    <CompositeScript>
        <Scripts>
            <asp:ScriptReference Path="~/Scripts/Script1.js" />
            <asp:ScriptReference Path="~/Scripts/Script2.js" />
            <asp:ScriptReference Path="~/Scripts/Script3.js" />
        </Scripts>
    </CompositeScript>
</asp:ScriptManager> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-18T17:32:41.283

如果您正在查看如何引用 jQuery 文件，这就是我正在做的事情：

```
<script type="text/javascript" src="Scripts/jquery.js"></script> 
```

由于您的页面上有 ScriptManager，因此您还可以访问 PageLoad。

```
function pageLoad() {
    //MSAJAX Stuff...  If Needed
}

$(document).ready(function() {
    $.datepicker.setDefaults($.datepicker.regional[$("#<%= hfCultureAbbreviation.ClientID %>").val()]);
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-18T17:31:40.240

以这种方式通过 ScriptManager 添加脚本具有使用 CompositeScript 轻松连接+缩小文件的优点。不幸的是，这意味着它们将通过 ScriptResource.axd 在页面上被引用，我一直认为这是一个非常丑陋的解决方案。

[我对将榨汁机之](http://www.cjohansen.no/en/ruby/juicer_a_css_and_javascript_packaging_tool)类的东西集成到我的构建过程中更感兴趣，但是为了方便起见，您无法击败 ScriptManager。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-18T17:35:43.943

不要忘记注册 Intellisense 文件！有时可以很方便。

# asp.net-mvc - 可编辑的“GridView”，如 ASP.NET MVC 中的控件

> ID：659303
> 
> 赞同：3
> 
> 时间：2009-03-18T17:26:09.177
> 
> 标签：asp.net-mvc, gridview

我正在尝试在视图中使用以下代码构建一个可编辑的 GridView 控件（订单列）：

```
<table>
    <tr>
        <th>
            Name
        </th>
        <th>
            Order
        </th>
        <th>
            <img alt="Save order" src="<%= Url.Content("~/Content/minisave.png") %>" />
        </th>
        <th></th>
    </tr>

<% foreach (var item in Model) { %>

    <tr>
        <td>
            <%= Html.Encode(item.Name) %>
        </td>
        <td colspan="2">
            <%= Html.TextBox("Order", item.Order, new { size = "3" }) %>
        </td>
        <td>
            <%= Html.ActionLink("Edit", "Edit", new { id=item.id }) %> |
            <%= Html.ActionLink("Details", "Details", new { id=item.id })%>
        </td>
    </tr>

<% } %>

</table> 
```

结果表如下所示：

![替代文字](https://i561.photobucket.com/albums/ss59/segaco/EditableTable.png)

**问题是**：我如何在我的控制器中接收这些数据？我需要桌子周围的表格标签吗？我如何知道哪个 Order 值属于哪个记录？

**几个额外的问题**：如果您看到我将 size 属性添加到输入选项卡的代码，但是当浏览器呈现它时，输入更大，我该如何解决？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T17:46:20.470

我以前做过。我通过将 ID 作为名称的一部分以及围绕整个表格的表格来做到这一点。这样，控制器从所有行中提取所有数据并像电子表格一样一次更新所有数据。

这适用于工作单元，您编辑页面并保存它，当然您需要考虑如何应对您的锁定策略，无论是乐观还是悲观。

然而，现在更好的选择可能是使用 ajax 来提交特定的值，有点像 Google 电子表格，也许吧？

# database - 您可以从 Cognos 8.3 中导出包装信息（ERD 或其他数据模型）吗？

> ID：659325
> 
> 赞同：1
> 
> 时间：2009-03-18T17:30:50.553
> 
> 标签：database, export, packages, cognos, erd

我想知道是否有办法从普通用户级别或框架级别从 Cognos 8 导出包信息。

例如，我想要 cognos 在数据库上指向的字段名称，我想要数据类型，当您右键单击数据元素时 cognos 使用的描述等。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T17:51:53.670

答案似乎是[肯定的，任何支持 CWM](http://www.cognos.com/pdfs/issue_papers/ip_integration_with_c8bi.pdf)（通用仓库模型）的东西，但至于*如何*......

一个建议：询问 IBM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T23:32:17.373

（不幸的是，我现在不在工作计算机旁）但是 Cognos 将所有内容保存在 .xml 文件中。我有一个漂亮的 xml 打印机，我在编辑前后在 model.xml 上使用它，这样我就可以使用 windiff 来查看模型中的确切变化。我还多次在 model.xml 上使用 xml 编辑器进行全局搜索和替换。

话虽如此，我不确定您可以直接从 model.xml 推断出多少数据库模式，但我怀疑您是否有一个可以读取和遍历 model.xml 并连接到数据库以描述对象的脚本，你可以得到你需要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-07T11:52:34.690

Powerdesigner 15 似乎是从 xmi 模型导入的。

# sql - 在 TSQL 的块中使用动态游标？

> ID：659337
> 
> 赞同：0
> 
> 时间：2009-03-18T17:33:01.423
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我有以下 TSQL 代码：

```
-- 1\. define a cursor
DECLARE c_Temp CURSOR FOR
    SELECT name FROM employees;

DECLARE @name varchar(100);
-- 2\. open it
OPEN c_Temp;
-- 3\. first fetch
FETCH NEXT FROM c_Temp INTO @name;
WHILE @@FETCH_STATUS = 0
BEGIN
  print @name;
  FETCH NEXT FROM c_Temp INTO @name; -- fetch again in a loop
END
-- 4\. close it
.... 
```

我只在循环块中使用名称值。在这里我必须

1.  定义一个游标变量，
2.  打开它，
3.  取两次和
4.  关闭它。

在 PL/SQL 中，循环可以是这样的：

```
FOR rRec IN (SELECT name FROM employees) LOOP
  DBMS_OUTPUT.put_line(rRec.name);
END LOOP; 
```

它比我的 TSQL 代码简单得多。无需定义游标。它是动态创建的，可在循环块中访问（很像 C# for 循环）。不确定 TSQL 中是否有类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T17:44:32.830

这些方面的东西可能对你有用，尽管它取决于有一个 ID 列或其他一些唯一标识符

```
Declare @au_id Varchar(20)
Select @au_id = Min(au_id) from authors

While @au_id IS NOT NULL
Begin
            Select au_id, au_lname, au_fname from authors Where au_id = @au_id
            Select @au_id = min(au_id) from authors where au_id > @au_id
End 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:44:03.577

游标在 Sql Server 中是邪恶的，因为它们确实会降低性能 - 我喜欢的方法是使用带有 auto inc ID 列的表变量（> = Sql Server 2005）：

```
Declare @LoopTable as table (
     ID int identity(1,1),
     column1 varchar(10),
     column2 datetime
)
insert into @LoopTable (column1, column2)
select name, startdate from employees

declare @count int
declare @max int
select @max = max(ID) from @LoopTable 
select @count = 1

while @count <= @max
begin
   --do something here using row number '@count' from @looptable
   set @count = @count + 1
end 
```

它看起来很冗长，但是在任何情况下都可以使用，并且应该比光标轻得多

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T18:12:58.393

由于您来自经常使用游标的 Oracle 背景，您可能不知道在 SQl Server 中游标是性能杀手。根据您实际在做什么（当然不仅仅是打印变量），可能会有一个更快的基于集合的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T23:00:40.353

在某些情况下，也可以使用这样的技巧：

```
DECLARE @name VARCHAR(MAX)

SELECT  @name = ISNULL(@name + CHAR(13) + CHAR(10), '') + name
FROM    employees

PRINT   @name 
```

对于员工姓名列表。

它也可以用来制作逗号分隔的字符串，只需将**+ CHAR(13) + CHAR(10)** 替换为**+ ', '**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T00:12:09.580

为什么不简单地使用 select 语句返回记录集。我假设对象是复制和粘贴 UI 中的值（基于您只是打印输出的事实）？在 Management Studio 中，您可以从网格中复制和粘贴，或按 +T，然后运行查询并将结果作为纯文本消息选项卡的一部分返回。

如果您通过应用程序运行它，应用程序将无法访问打印的语句，因为它们没有在记录集中返回。

# c# - 提供者与Oracle客户端版本不兼容

> ID：659341
> 
> 赞同：165
> 
> 时间：2009-03-18T17:34:20.203
> 
> 标签：c#, asp.net, oracle, odp.net, oracleclient

我正在尝试在我的 ASP.net 项目上使用**Oracle ODP.NET 11g (11.1.0.6.20) Instant Client**作为**数据提供程序**，但是当我运行 aspx 页面时，我得到一个“*提供程序与版本不兼容Oracle 客户端的*“错误消息。任何帮助，将不胜感激。

我在 Visual Studio 2005 中引用了 Data Provider，后面的代码如下所示：

```
using Oracle.DataAccess.Client;
..

OracleConnection oOracleConn = new OracleConnection();
oOracleConn.ConnectionString =
    "Data Source=MyOracleServerName;" +
    "Integrated Security=SSPI";
oOracleConn.Open();

//Do Something

oOracleConn.Close(); 
```

页面的错误如下所示：

```
Exception Details: Oracle.DataAccess.Client.OracleException: The provider is not compatible with the version of Oracle client

Source Error: 
Line 21: 
Line 22: 
Line 23:             OracleConnection oOracleConn = new OracleConnection();
Line 24:             oOracleConn.ConnectionString =
Line 25:                 "Data Source=MyOracleServerName;" +

[OracleException (0x80004005): The provider is not compatible with the version of Oracle client]
   Oracle.DataAccess.Client.OracleInit.Initialize() +494
   Oracle.DataAccess.Client.OracleConnection..cctor() +483

Stack Trace: 
[TypeInitializationException: The type initializer for 'Oracle.DataAccess.Client.OracleConnection' threw an exception.]
   Oracle.DataAccess.Client.OracleConnection..ctor() +0
   Boeing.IVX.Web.RoyTesting.Page_Load(Object sender, EventArgs e) in C:\Documents and Settings\CE218C\Desktop\IVX.Net\Web\IVX\RoyTesting.aspx.cs:23
   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +15
   System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +33
   System.Web.UI.Control.OnLoad(EventArgs e) +99
   System.Web.UI.Control.LoadRecursive() +47
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1436 
```

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-08-11T03:14:58.060

我一直在进一步研究这个问题，你只需要从同一个下载版本的 ODP.Net 中获取所有适当的 DLL，并将它们放在与你的 Exe 文件相同的文件夹中，因为 ODP.Net 对不混合很挑剔版本号。

我在这里解释了如何做到这一点：http: [//splinter.com.au/using-the-new-odpnet-to-access-oracle-from-c](http://splinter.com.au/using-the-new-odpnet-to-access-oracle-from-c) 这里是它的要点：

*   下载ODP.Net
*   解压文件
*   解压里面的所有JAR
*   抓取这些刚刚解压缩的 dll：
    *   oci.dll（从“oci.dll.dbl”重命名）
    *   Oracle.DataAccess.dll
    *   oraociicus11.dll
    *   OraOps11w.dll
    *   orannzsbb11.dll
    *   oraocci11.dll
    *   ociw32.dll（从“ociw32.dll.dbl”重命名）
*   将所有 DLL 与 C# 可执行文件放在同一个文件夹中

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-07-24T05:37:56.937

对于初学者，您应该“忽略”这里所有的 x86/x64 讨论，而是尝试使用 ODP.NET 托管驱动程序（如果您使用的是 .Net v4+）：

[https://www.nuget.org/packages/Oracle.ManagedDataAccess/](https://www.nuget.org/packages/Oracle.ManagedDataAccess/)

[https://www.nuget.org/packages/Oracle.ManagedDataAccess.EntityFramework/](https://www.nuget.org/packages/Oracle.ManagedDataAccess.EntityFramework/)

[Oracle ODP.net 托管与非托管驱动程序](https://stackoverflow.com/questions/17583289/oracle-odp-net-managed-vs-unmanaged-driver)

避免所有“非托管”什么DLL什么架构问题！:D（大约是 Oracle 的时间）。

***NuGet 包（也适用于 11g）：***

[![在此处输入图像描述](https://i.stack.imgur.com/i7l0w.png)](https://i.stack.imgur.com/i7l0w.png)

***旧/手动方法：***

有关如何转换为使用*托管*库的信息：

*   首先，这是*托管*与*非托管*的代码比较：http : [//docs.oracle.com/cd/E51173_01/win.122/e17732/intro005.htm#ODPNT148](http://docs.oracle.com/cd/E51173_01/win.122/e17732/intro005.htm#ODPNT148)
*   确保您已下载*ODP.NET，仅托管驱动程序 Xcopy 版本*
*   从下载的 zip 文件中，复制并粘贴到您的项目目录中：
    *   *Oracle.ManagedDataAccessDTC.dll*
    *   *Oracle.ManagedDataAccess.dll*
*   添加对*Oracle.ManagedDataAccess.dll的引用*
*   确保您的 exe与两个 dll 一起发布（添加到 VS2010中的*应用程序文件夹）*

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-03-18T20:42:26.320

我只安装了**.NET 2.0 (11.1.0.6.20) 的 Oracle 数据提供程序，**没有安装**Oracle Instant Client (11.1.0.6.0)**。

我刚刚安装它，错误消失了！

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-05-29T04:38:41.123

这可能是由针对 32 位 Oracle 客户端运行 64 位 .NET 运行时引起的。如果您的服务器在 64 位上运行应用程序，则可能会发生这种情况。它将使用 64 位运行时运行 .NET 应用程序。您可以在 VS 中设置项目的 CPU 标志以在 32 位运行时中运行。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2014-08-20T19:31:43.840

让我们做一些总结：

错误消息**“提供程序与 Oracle 客户端的版本不兼容”**可能由多种原因引起。

*   您没有安装 Oracle 客户端。在这种情况下，错误消息确实具有误导性。

    Oracle Instant Client 中不包含用于 .NET 的 Oracle Data Provider（ODP.NET，即文件`Oracle.DataAccess.dll`），它必须单独安装（从[32 位 Oracle 数据访问组件 (ODAC)](http://www.oracle.com/technetwork/database/windows/downloads/utilsoft-087491.html)或[64 位 Oracle 数据访问组件下载（ ODAC）下载](http://www.oracle.com/technetwork/database/windows/downloads/index-090165.html)）或者您必须在 Oracle Universal Installer (OUI) 中选择相应的选项。

    请注意，当安装 Oracle Data Provider >= 12.1 时，提供程序不会自动注册到 GAC。如果需要，您必须手动注册，请参阅 Oracle Doc [2272241.1](https://support.oracle.com/knowledge/Oracle%20Database%20Products/2272241_1.html)。

*   ODP.NET 的版本与安装的 Oracle 客户端版本不匹配。您甚至必须检查次要版本号！例如，`Oracle.DataAccess.dll`版本**4.112.3.0与 Oracle 客户端****11.2.0.4**不兼容。仔细检查 ODP.NET 和 Oracle 客户端的版本。您可以使用[sigcheck](https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck)和`oraociei*.dll`/或`OraOps*w.dll`获取 Oracle 客户端的版本。

    请注意不同的编号方案。文件版本**4.112.3.0**表示：**.NET Framework 版本 4，Oracle 版本**11.2.0.3.x。

    有 ODP.NET 版本“1.x”、“2.x”和“4.x”。这些数字与 Microsoft .NET Framework 版本 1.0.3705/1.1.4322、2.0.50727 和 4.0.30319 相关。在 Oracle Client 11.1 之前版本“1.x”可用。Oracle Client 11.2 引入了版本“4.x”

*   ODP.NET 的架构（32 位或 64 位）与您的应用程序架构不匹配。32 位应用程序仅适用于 32 位 Oracle Client/ODP.NET，而 64 位应用程序则需要 64 位 Oracle Client/ODP.NET。（除非您使用**ODP.NET 托管驱动程序**）

*   .NET Framework 版本不匹配。例如，如果您使用 Target .NET Framework 2.0 编译应用程序，则不能使用 ODP.NET 4.x 版。.NET Framework 目标版本必须等于或高于 ODP.NET 的版本。

*   您的开发机器上的版本`Oracle.DataAccess.dll`（即编译时加载的版本）高于目标机器上的版本。

*   请注意，`Oracle.DataAccess.dll`可能从[GAC](https://en.wikipedia.org/wiki/Global_Assembly_Cache)加载，默认情况下优先于任何本地提供的文件。

**解决方案**

*   考虑使用 ODP.NET 托管驱动程序，它可以从 Oracle 页面下载：[64-bit Oracle Data Access Components (ODAC) Downloads](http://www.oracle.com/technetwork/database/windows/downloads/index-090165.html)。在那里您只需将`Oracle.ManagedDataAccess.dll`文件复制到您的应用程序目录，不需要其他任何东西。它适用于 32 位和 64 位。

*   在你的`*.csproj`，分别。`*.vbproj`像这样编辑您对 ODP.NET 的引用：

    ```
    <Reference Include="Oracle.DataAccess">
      <SpecificVersion>False</SpecificVersion>
      <Private>False</Private>
    </Reference> 
    ```

    `Version=...`类似or的属性`processorArchitecture=...`不是必需的。~~您的应用程序将根据所选架构和目标 .NET 框架~~ ~~加载正确`Oracle.DataAccess.dll`~~（前提是它已正确安装） -> 未 100% 验证

*   如果您不知道目标机器上的 Oracle 客户端版本（例如，它可能是您客户的机器）： 转到上面提到的下载页面并下载 Oracle 数据访问组件的最低**XCopy**版本。提取 zip 并将`Oracle.DataAccess.dll`文件复制到本地计算机。在你的 VS 项目中引用这个（很可能是过时的）DLL。此 DLL 的版本是您的应用程序可以使用的最低版本的 ODP.NET。当您运行您的应用程序时，GAC 中的发布者策略将重定向到实际安装的版本。

*   我不认为采用单个 DLL 并将它们复制到某些文件夹是一种聪明的方法。它可能在“裸机”机器上工作，但如果您的目标机器安装了任何 Oracle 产品，则版本不匹配的风险很高。从您的机器上卸载所有 Oracle 产品并进行全新安装。看看[如何卸载/完全删除 Oracle 11g（客户端）？](https://stackoverflow.com/questions/8450726/how-to-uninstall-completely-remove-oracle-11g-client)它为了得到一台真正干净的机器。

*   如果您必须同时使用 32 位和 64 位应用程序，请按照以下说明在一台机器上安装这两个版本：

假设：Oracle Home 被调用`OraClient11g_home1`，Client Version 是 11gR2。

*   可选择删除任何已安装的 Oracle 客户端

*   下载并安装 Oracle x86 Client，例如进入`C:\Oracle\11.2\Client_x86`

*   下载 Oracle x64 客户端并将其安装到不同的文件夹中，例如`C:\Oracle\11.2\Client_x64`

*   打开命令行工具，转到文件夹 %WINDIR%\System32，通常`C:\Windows\System32`并创建指向`ora112`文件夹的符号链接`C:\Oracle\11.2\Client_x64`（见下文）

*   更改为文件夹 %WINDIR%\SysWOW64，通常`C:\Windows\SysWOW64`并创建指向`ora112`文件夹的符号链接`C:\Oracle\11.2\Client_x86`，（见下文）

*   修改`PATH`环境变量，将所有条目替换为`C:\Oracle\11.2\Client_x86`和`C:\Oracle\11.2\Client_x64`，`C:\Windows\System32\ora112`分别为其`\bin`子文件夹。注意：`C:\Windows\SysWOW64\ora112`一定不能在 PATH 环境中。

*   如果需要，将`ORACLE_HOME`您的环境变量设置为`C:\Windows\System32\ora112`

*   打开您的注册表编辑器。将注册表值设置`HKLM\Software\ORACLE\KEY_OraClient11g_home1\ORACLE_HOME`为`C:\Windows\System32\ora112`

*   将注册表值设置`HKLM\Software\Wow6432Node\ORACLE\KEY_OraClient11g_home1\ORACLE_HOME`为`C:\Windows\System32\ora112`(not `C:\Windows\SysWOW64\ora112`)

*   你完成了！现在您可以无缝地使用 x86 和 x64 Oracle 客户端，即 x86 应用程序将加载 x86 库，x64 应用程序加载 x64 库而无需对您的系统进行任何进一步的修改。

创建符号链接的命令：

```
cd C:\Windows\System32
mklink /d ora112 C:\Oracle\11.2\Client_x64
cd C:\Windows\SysWOW64
mklink /d ora112 C:\Oracle\11.2\Client_x86 
```

一些注意事项：

*   两个符号链接必须具有相同的名称，例如`ora112`.

*   如果您想在之后手动安装 ODP.NET，请注意选择合适的文件夹进行安装。

*   尽管它们的名称文件夹`C:\Windows\System32`包含 x64 库，但`C:\Windows\SysWOW64`包含 x86（32 位）库。不要混淆。

*   也许将`TNS_ADMIN`环境变量（`TNS_ADMIN`注册表中的条目）设置为一个公共位置是一个明智的选择，例如`TNS_ADMIN=C:\Oracle\Common\network`.

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-06-07T21:22:53.617

经过几个小时的故障排除后，我发现这个问题是由于我的项目 bin 目录中有 Oracle.DataAccess.dll (v4.0)，但运行时还从 GAC 加载了 Oracle.DataAccess.dll (v2.x)。删除并读取项目引用中的 Oracle.DataAccess 条目为我解决了这个问题。

在我的情况下，这里提到的其他文件似乎不是必需的。

# 更新

“提供程序与 Oracle 客户端的版本不兼容”错误的根本原因是（通常）托管程序集试图加载与版本不匹配的非托管库。看来您可以通过在 web.config [^(1中指定库路径来强制 Oracle 驱动程序使用正确的库)](http://docs.oracle.com/cd/E20434_01/doc/win.112/e23174/featConfig.htm#BABCBFDJ "配置文件支持")

```
<configuration>
  <oracle.dataaccess.client>
    <settings>
      <add name="DllPath" value="C:\oracle\bin"/>
      <!-- ... -->
    </settings>
  </oracle.dataaccess.client>
</configuration> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-02-04T17:30:21.833

在目标机器上安装 ODP.Net，它应该可以解决问题......复制 dll 看起来不是一个好主意......

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-03-03T19:10:08.467

对于 Oracle 11g (11.1.0.7.20)，我必须将以下 dll 与我的 Exe 一起添加才能工作。

1.  oci.dll
2.  OraOps11w.dll
3.  oraociicus11.dll（非常大，接近 30mb）
4.  Oracle.DataAccess.dll

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-12-08T20:49:50.307

TLDR 版本：

*   请改用 12c [100% 托管提](https://stackoverflow.com/questions/17583289/oracle-odp-net-managed-vs-unmanaged-driver/17618179#17618179)​​供程序。
*   如果必须使用旧提供程序，则需要将 Oracle.DataAccess.dll 指向正确版本的非托管 Oracle 客户端 Dll。如果您的机器上安装了多个 Oracle 客户端，这可能很简单，例如在您的应用程序配置中包含“DllPath”配置变量（见下文），但您可能还需要安装一个新的 Oracle 客户端来指向。

完整版本：

首先，让我们确保我们了解旧的非托管提供程序（不是新的 12c 100% 托管提​​供程序）的组件。它由两部分组成：

1.  托管的 .net 组件 - Oracle.DataAccess.dll
2.  非托管（非.net）客户端

简单地说，Oracle.DataAccess.dll 几乎只是一个包装器，将 .net 指令转换为非托管客户端的 ORACLE-NET 指令。

也就是说，当您加载 Oracle.DataAccess 时，它会按照一个顺序尝试定位它需要的非托管客户端 dll。从[Oracle 文档](http://docs.oracle.com/cd/E16655_01/win.121/e17732/InstallODP.htm)：

> Oracle.DataAccess.dll 根据以下顺序搜索依赖的非托管 DLL（例如 Oracle 客户端）：
> 
> 1.应用程序或可执行文件的目录。
> 
> 2.由应用程序配置或web.config指定的DllPath设置。
> 
> 3.machine.config指定的DllPath设置。
> 
> 4.Windows Registry指定的DllPath设置。
> 
> HKEY_LOCAL_MACHINE\Software\Oracle\ODP.NET\version\DllPath
> 
> 5.Windows PATH 环境变量指定的目录。

因此，在您的情况下，您的应用程序遵循上述过程并找到了一个路径，其中包含相对于您正在使用的 Oracle.DataAccess.dll 程序集太旧的未管理 dll。

可能只是那台机器上唯一安装的 Oracle 客户端太旧了。但是，如果您在机器上安装了多个客户端，并且首先在不同但较旧的安装中找到了未管理的文件，那么这就会发挥作用。如果是后者，简单的做法是在您的配置中使用 dllPath 配置变量并将其指向正确的 Oracle Home Bin 文件夹：

```
<configuration>
  <oracle.dataaccess.client> 
    <add key="DllPath" value="c:\oracle\product\1.1.0-xcopy-dep\BIN"/>
  </oracle.dataaccess.client>
</configuration> 
```

如果要安装客户端的新副本，[xcopy 版本](http://www.brothersincode.com/post/Oracle-ODPnet-xcopy-deployment-for-aspnet.aspx)是最小的，包含“即时客户端”并将上面的 DllPath 指向这个新位置。但是任何 oracle 客户端安装都可以。

但是如果你想避免所有这些非托管客户端解析的东西，看看你是否可以更新你的应用程序以使用 100% 托管提​​供程序——它确实只是一两个托管程序集，而不依赖于非托管文件。

如果它安装在您的 bin 目录和 GAC 中，您也可能没有加载您认为的 Oracle.DataAccess.dll，但我认为这是不太可能的情况。有关详细信息，请参阅[程序集解析过程](https://blogs.msdn.microsoft.com/pranav_rastogi/2010/10/17/asp-net-assembly-loading-from-gac-or-bin/)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-18T18:06:45.553

在我看来，虽然您有带有 Oracle 即时客户端的 ODP，但 ODP 可能正在尝试使用实际的 Oracle 客户端。你的机器上是否也安装了标准的 Oracle 客户端？我记得甲骨文对同一台机器上的多个客户端非常挑剔。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-08-05T14:50:38.827

我有同样的问题。编译应用程序后，我删除了（忘记了我已经删除了）oraociei11.dll。它在尝试执行时给出了这个错误。所以当它找不到 oraociei11.dll 的 dll 时，它会显示这个错误。可能还有其他情况会出现此错误，但这似乎是其中之一。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-04-12T15:54:52.187

还要寻找 IIS 应用程序池 Enable 32-bit true or false flag，当你看到这个消息时，一些 oracle 论坛给我指点了这个！

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-03-19T00:01:50.573

我有同样的问题，但在我的情况下，我不能只将 dll 复制到 bin 文件夹中，然后我只能“重新绑定”程序集版本。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <runtime>    
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Oracle.DataAccess" publicKeyToken="89B483F429C47342" culture="neutral"/>
        <bindingRedirect oldVersion="2.112.2.0" newVersion="2.112.1.0"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration> 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-05-31T16:36:18.330

这是我为解决这个持续了 3 个小时的问题所做的工作：

1.  在位于我的 Oracle 主页下，`C:\oracle\product\11.2.0`我有一个文件夹，名为`client_1`我以前安装`ODP.NET`Windows 64 位的位。

2.  后来在尝试使用 Visual Studio 2012 调试我的 ASP.NET Web API 应用程序时，我不断收到此错误消息：***The provider is not compatible with the version of Oracle client***。

3.  搜索谷歌我发现这是因为我使用的是`ODP.NET`64 位。然后我抓住`ODP.NET`了 Windows 32 位并安装了它，但我一直收到相同的错误消息。

4.  **解决方案：**删除文件夹`client_1`并重新安装`ODP.NET`32 位。安装程序在某种程度上混合了 64 位版本和 32 位版本的位。去搞清楚...

5.  现在我又开心起来了，我可以开一个新的`OracleConnection`. 最后！:)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-12-19T14:09:15.567

对于仍然遇到此问题的任何人：基于这篇文章

[http://oradim.blogspot.com/2009/09/odpnet-provider-is-not-compatible-with.html](http://oradim.blogspot.com/2009/09/odpnet-provider-is-not-compatible-with.html)

我发现我的服务器缺少 Microsoft C++ Visual Runtime Library - 因为安装了 Visual Studio，所以我在我的开发机器上拥有它。我从这里下载并安装了（当前）最新版本的库：

[http://www.microsoft.com/en-us/download/details.aspx?id=13523](http://www.microsoft.com/en-us/download/details.aspx?id=13523)

运行设置，C# 的 oracle 调用成功了！

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2015-01-15T10:52:36.813

我没有走上获得新 DLL 的道路。我们有一堆现有的项目运行良好，只有我的新项目让我头疼，所以我决定尝试其他的。

我的项目使用的是内部开发的 Internal.dll，它依赖于 Oracle.DataAccess.dll `v4.112.3.0`。出于某种原因，在发布时，Visual Studio 总是上传`v4.121.0.0`，即使它没有在任何配置文件中明确指定。这就是为什么我得到一个错误。

所以我所做的是：

1.  将 Internal.dll 从一个成功运行的项目复制到我的网站`/bin`（只是为了安全起见）。
2.  将 Oracle.DataAccess.dll 从成功运行的项目之一复制到我网站的`/bin`.
3.  从我的网站添加对它们的引用。
4.  最后 Oracle.DataAccess 参考出现在 中`myWebSite.csproj`，但它显示了错误的版本：`v4.121.0.0`而不是`v4.112.3.0`.
5.  我手动更改了 中的引用`myWebSite.csproj`，因此现在显示为：

    ```
    <Reference Include="Oracle.DataAccess, Version=4.112.3.0, Culture=neutral, PublicKeyToken=89b483f429c47342, processorArchitecture=x86">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>bin\Oracle.DataAccess.dll</HintPath>
    </Reference> 
    ```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-09-21T08:33:06.960

如果您有多个 oracle 客户端，或者有时如果您引用不同的版本，则在使用非托管 oracle 引用时可能会发生此问题。
有两种方法可以解决它：

1.  第一个也是快速的解决方案是删除非托管引用并使用 NuGet 中的托管引用 请参阅此之前使用此选项[ODP.NET 托管驱动程序和非托管驱动程序之间的差异](https://docs.oracle.com/database/121/ODPNT/intro004.htm#ODPNT8146)

2.  第二种解决方案是修复项目非托管目标版本，如下所示：

*   首先检查oracle项目参考版本（从项目参考/（依赖项>程序集）> Oracle.DataAccess右键单击>属性）：

    [![在此处输入图像描述](https://i.stack.imgur.com/m3slR.png)](https://i.stack.imgur.com/m3slR.png)

    [![在此处输入图像描述](https://i.stack.imgur.com/ls6Lv.png)](https://i.stack.imgur.com/ls6Lv.png)

然后检查oracle GAC版本

*   从运行 ( `Win`+ `R`) "%windir%\Microsoft.NET\assembly"到 gac
    [![在此处输入图像描述](https://i.stack.imgur.com/lAVmb.png)](https://i.stack.imgur.com/lAVmb.png)

*   检查与您的项目平台匹配的平台

    [![在此处输入图像描述](https://i.stack.imgur.com/zQ9sB.png)](https://i.stack.imgur.com/zQ9sB.png)

*   检查您的目标平台（右键单击您的项目>属性）

    [![在此处输入图像描述](https://i.stack.imgur.com/YOnRj.png)](https://i.stack.imgur.com/YOnRj.png)

*   从 gac 文件夹搜索到 Oracle.DataAccess

    [![在此处输入图像描述](https://i.stack.imgur.com/Y9Dv2.png)](https://i.stack.imgur.com/Y9Dv2.png)

*   右键单击 Oracle.DataAccess > 属性 > 详细信息并检查版本

    [![在此处输入图像描述](https://i.stack.imgur.com/YSvcU.png)](https://i.stack.imgur.com/YSvcU.png)

*   如果您发现版本不同，这是一个问题，要解决它，我们需要重定向程序集版本（在启动项目中转到配置文件并添加以下部分）

```
<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Oracle.DataAccess" publicKeyToken="89b483f429c47342" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-5.0.0.0" newVersion="4.121.2.0" />
      </dependentAssembly>
</assemblyBinding> 
```

像这样 [![在此处输入图像描述](https://i.stack.imgur.com/rHQlf.png)](https://i.stack.imgur.com/rHQlf.png)

oldVersion ：应该涵盖您的项目版本 newVersion ：GAC 版本 publicKeyToken ：来自 GAC

[![在此处输入图像描述](https://i.stack.imgur.com/FAMNu.png)](https://i.stack.imgur.com/FAMNu.png)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-03-18T18:03:43.580

IIS/IWAM 用户是否对 Oracle 目录具有权限？您可以使用其他应用程序（例如 Excel 或 Access）连接到此数据源吗？

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-11-10T09:01:14.743

我们遇到了同样的问题，因为网络共享上的 Oracle.Data.dll 程序集由我们的 DBA 更新。从项目中删除引用，然后再次添加它解决了问题。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-05-03T14:38:32.907

只需两步即可解决此问题。

1.  转到应用程序池的高级设置并将“启用 32 位应用程序”标志设置为 True。
2.  确保您的 Bin 中的所有 Dll 现在都是 32 位版本...

祝你好运。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2016-12-02T20:59:05.157

我在安装 Oracle Data Tools for Visual Studio 2015 后遇到了这个问题，然后与 Oracle 争了一个小时。我决定再次尝试重新安装 Oracle 客户端，而不是像文件复制、配置更改等那样弄得一团糟，这对我有用。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2020-01-07T13:08:03.423

我遇到了类似的问题，根本原因是 GAC 有 2 个 oracle.dataaccess 版本，即 v4.0_4.112.2.0 和 v4.0_4.112.4.0 。我的应用程序指的是 v4.0_4.112.2.0 ，所以当我从 GAC 中删除 v4.0_4.112.4.0 时，它运行良好。

GAC 路径：C:\Windows\Microsoft.NET\assembly\GAC_64\Oracle.DataAccess

前 ： [![在此处输入图像描述](https://i.stack.imgur.com/2m47P.png)](https://i.stack.imgur.com/2m47P.png)

后 ： [![在此处输入图像描述](https://i.stack.imgur.com/Qw4gD.png)](https://i.stack.imgur.com/Qw4gD.png)

要删除版本，只需从 GAC 中删除相应的文件夹即可。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-05-21T02:31:53.123

最近我不得不处理一个较旧的项目，其中解决方案和所有包含的项目都针对 x32 平台。我继续尝试在所有地方复制 Oracle.DataAccess.dll 和所有其他建议的 Oracle 文件，但每次都碰壁。最后，头上的灯泡亮了（8 小时后 :)），并要求检查已安装的 ODAC 组件及其平台。我已经安装了所有 64 位 (x64) ODAC 客户端，但没有安装 32 位 (x32)。安装了 32 位 ODAC，问题就消失了。

*如何检查已安装 ODAC 的版本：查看文件夹 C:\Windows\assembly。“处理器架构”属性将通知平台安装的 ODAC。*

八小时是灯泡点亮的很长一段时间。难怪我总是不得不在工作中挣扎:)。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-08-29T10:53:55.767

克里斯的解决方案也对我有用。但是，我确实收到了一条以下错误消息：

```
Could not load file or assembly 'Oracle.DataAccess' or one of its dependencies. An attempt was made to load a program with an incorrect format. 
```

显然，在 Oraclish 的外语中，这意味着您的程序要么针对所有平台，要么针对 32 位机器。只需将项目属性中的目标平台更改为 64 位，并希望获得最好的结果。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2015-08-17T16:52:42.207

我对 Oracle.DataAccess.dll v4.121.2.0 有同样的问题。带 2 个家庭安装（32 位和 64 位版本）。32 位版本工作，64 位版本没有。

就我而言（经过 2 天的尝试），我发现问题出在 64 位家庭版本的权限上。**该版本中的许多目录**具有专门覆盖的权限，其中“Authenticated Users”角色没有“读取”访问权限，默认情况下在父目录上设置。这些子目录包括“bin”、“network/admin”、“nls”、“oracore”、“RDBMS”和可能的其他目录。我通过从 sysinternals 过滤掉“进程监视器”（Procmon.exe）实用程序中的“访问被拒绝”结果找到了它们。一旦权限从父目录继承到这些子目录，一切就开始工作了。

我没有覆盖整个 oracle 主目录的权限，所以我一次只做一个目录，但我想如果你不太担心安全性，你可以在整个相应的 oracle 主目录上重置它。

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2013-04-18T19:50:46.417

*   在 64 位计算机上，将“msvcr71.dll”从 C:\Windows\SysWOW64 复制到应用程序的 bin 目录。
*   在 32 位计算机上，将“msvcr71.dll”从 C:\Windows\System32 复制到应用程序的 bin 目录。

[http://randomdevtips.blogspot.com/2012/06/provider-is-not-compatible-with-version.html](http://randomdevtips.blogspot.com/2012/06/provider-is-not-compatible-with-version.html)

* * *

## 回答 #27

> 赞同：-3
> 
> 时间：2017-04-20T21:45:32.963

这里有很多理论答案，但这里有一个工作示例，其中包含可以立即复制、粘贴和测试的代码：

1.  我安装了 Oracle Express 数据库**OracleXE112**，它已经附带了一些预装的演示表。
2.  当您启动安装程序时，系统会要求您输入**密码**。我输入“xxx”作为密码。（不用于生产）
3.  我的服务器在机器**192.168.1.158上运行**
4.  在服务器上，您必须明确允许访问 Windows**防火墙**中的 TNSLSNR.exe 进程。此过程侦听端口 1521。如果您从以下代码中收到超时错误，请检查您的防火墙。
5.  **选项 A：**对于 C#（.NET2 或 .NET4），您可以下载**ODAC11**，您必须从中将 Oracle.DataAccess.dll 添加到您的项目中。此外，此 DLL 依赖于：OraOps11w.dll、oci.dll、oraociei11.dll (130MB!)、msvcr80.dll。这些 DLL 必须与 EXE 位于同一目录中，或者您必须在以下位置指定 DLL 路径：`HKEY_LOCAL_MACHINE\SOFTWARE\Oracle\ODP.NET\4.112.4.0\DllPath`. 在 64 位机器上另外写入`HKLM\SOFTWARE\Wow6432Node\Oracle\...`
6.  **选项 B：**如果您已下载**ODAC12**，则需要 Oracle.DataAccess.dll、OraOps12w.dll、oci.dll、oraociei12.dll（160MB！）、oraons.dll、msvcr100.dll。注册表路径是`HKEY_LOCAL_MACHINE\SOFTWARE\Oracle\ODP.NET\4.121.2.0\DllPath`
7.  **选项 C：**如果您不想要超过 100 MB 的巨大 DLL，您应该下载 ODP.NET_Managed12.xxxxxxxx.zip，您可以在其中找到`Oracle.ManagedDataAccess.dll`只有 4 MB 的纯托管 DLL，可在 32 位和 64 位进程中运行以及不依赖于其他 DLL 并且不需要任何注册表项。
8.  以下 C# 代码适用于我**，无需在服务器端进行任何配置**（只是默认安装）：

```
使用 Oracle.DataAccess.Client；
或者
使用 Oracle.ManagedDataAccess.Client；

……

字符串 oradb = "数据源 =(DESCRIPTION="
    +“（地址列表=（地址=（协议=TCP）（主机=192.168.1.158）（端口=1521）））”
    + "(CONNECT_DATA=(SERVER=DEDICATED)));"
    + "用户ID=SYSTEM;密码=xxx;";

使用 (OracleConnection conn = new OracleConnection(oradb))
{
    conn.Open();
    使用 (OracleCommand cmd = new OracleCommand())
    {
        cmd.Connection = 连接；
        cmd.CommandText = "从 DBA_DATA_FILES 中选择 TABLESPACE_NAME";

        使用 (OracleDataReader dr = cmd.ExecuteReader())
        {
            而 (dr.Read())
            {
                listBox.Items.Add(dr["TABLESPACE_NAME"]);
            }
        }
    }
}
```

# perl - 为什么在 mod_perl 中加载我的 Perl 模块会导致 Apache 挂起？

> ID：659342
> 
> 赞同：3
> 
> 时间：2009-03-18T17:34:28.563
> 
> 标签：perl, apache, mod-perl

我有一个 mod_perl 程序，它实现了它自己的处理函数（即它不使用 Apache::Registry）。

我有一个使用 Parse::RecDescent 编写的解析器模块。

几个月来，我一直在另一个类似的 mod_perl 程序中成功使用解析器模块，没有任何问题。

简单地在我的新 mod_perl 程序中“使用”解析器模块（即不引用模块中的函数）会导致 Apache 服务器产生子进程，直到它达到最大限制。注释掉“use”语句解决了这个问题（但显然我没有使用解析器）。

我怀疑包含库正在做一些导致 Apache 生命周期在它结束之前挂起的事情。我相信这是在记录阶段*之后*发生的，因为发送了响应并且更新了日志。

有人对我有任何线索吗？我不知所措。

--菲尔--

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T18:11:25.590

所以，我解决了这个问题，但不明白为什么它会起作用。这让我有点沮丧，但我很感激问题已经消失。

在我接受 derobert 的建议并跟踪过程之前，我决定将库加载移动到 mod_perl 启动文件，瞧，问题解决了。

有趣的是，我花了一天的时间才达到我对问题的理解足以提出关于 SO 的问题，然后一旦我达到了这一点，一个简单的事情就解决了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T17:47:57.783

我没有给你答案（就我个人而言，我使用 fastcgi ...），但我可以建议一种方法：将 strace、ltrace、gdb 等附加到 apache 子进程并查看它挂在哪里。您可能需要使用调试符号重新构建 apache、mod_perl 甚至 perl 以从 gdb 获得合理的输出。

# java - 如何找到类路径上具有特定方法注释的所有类？

> ID：659349
> 
> 赞同：12
> 
> 时间：2009-03-18T17:35:38.857
> 
> 标签：java, spring, annotations

我想在 Java 中实现一个基于注解的初始化机制。具体来说，我定义了一个注释：

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface Initialization {

/**
 * If the eager initialization flag is set to <code>true</code> then the
 * initialized class will be initialized the first time it is created.
 * Otherwise, it will be initialized the first time it is used.
 * 
 * @return <code>true</code> if the initialization method should be called
 *         eagerly
 */
boolean eager() default false;

} 
```

另外，我有一个界面：

```
public interface SomeKindOfBasicInterface {} 
```

我想`SomeKindOfBasicInterface`在我的类路径上找到该类的每个实现，该类在`@Initialization`方法上有注释。我正在查看 Spring 的`MetaDataReader`工具，这看起来像是在执行此操作时推迟加载其他实现的最佳方式`SomeKindOfBasicInterface`......但我不确定如何像我描述的那样进行搜索。有小费吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-22T22:20:05.043

您可以使用[Reflections](https://github.com/ronmamo/reflections)，这是一个 Java 运行时元数据分析工具。我用它来获取给定类型的所有子类型，但它也可以处理您的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T17:55:17.080

我基本上会创建一个[BeanPostProcessor](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/BeanPostProcessor.html)实现，可能基于[CommonAnnotationBeanPostProcessor](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/context/annotation/CommonAnnotationBeanPostProcessor.html)。然后我设置了[组件扫描](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-scanning-autodetection)，它扫描类路径并选择所有符合您的规范的bean。初始化 bean 时，您的后处理器将运行。

我知道我假设您正在寻找豆类。如果不是这种情况，您可能必须自己扫描类路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T18:22:49.260

您可以使用[javassist](http://www.csg.is.titech.ac.jp/~chiba/javassist/)查找类中的注释，甚至在加载它们之前，但您需要直接读取 .class 文件，这可能意味着您自己打开一个 JAR 等等。您还需要知道在哪里寻找类。您不能只向运行时询问`BasicInterface`.

# .net - 使用后删除临时文件

> ID：659351
> 
> 赞同：14
> 
> 时间：2009-03-18T17:36:12.897
> 
> 标签：.net, windows, temporary-files

我需要在我的 Windows Forms .NET 3.5 应用程序中处理一些临时文件。这些文件是在一个外部应用程序中打开的，当然它可以运行比我自己的程序更长的时间。

是否有任何最佳实践来确保随时清理这些临时文件，以避免用户的硬盘充满不再需要的“垃圾”文件？或者甚至 Windows 会自动处理这个问题吗？

一个很好的例子是任何邮件客户端：当您在任何应用程序中打开一个附件时，它通常被写入一个打开的临时文件。有没有办法弄清楚这些文件如何管理清理？

使用 Google 向我展示了许多清理和调整工具来手动清理临时目录，但我不想强迫用户这样做。:-)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-18T17:41:02.510

在 .NET 中，您可以使用`[TempFileCollection](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.tempfilecollection.aspx)`该类来管理一组要由您的应用程序清理的临时文件（请注意，它相当隐藏在 CodeDom 命名空间中）。显然，您不能删除任何不属于您自己的文件，因为这些文件可能仍被另一个应用程序打开（删除它们可能会导致严重问题）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-18T19:01:46.247

清理临时文件的责任应该在创建它们的应用程序上。这很容易。我使用一个看起来像这样的类：

```
public class TempFile : IDisposable
{
    public TempFile()
    { this.path = System.IO.Path.GetTempFileName(); }

    public void Dispose()
    { File.Delete(path); }

    private string path;
    public string Path { get { return path; } }
} 
```

如果您需要清理另一个应用程序的临时文件，它需要一些与您的通信的方法。至少它应该能够提供信号量。然而，这样做的复杂性大于让原始应用程序处理自己的文件的复杂性。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-18T17:40:21.327

如果您尝试确定性地清除临时文件类型文件夹的内容，则可能会删除其他进程正在使用的文件。Windows 操作系统提供了一些工具，允许用户在卷的可用磁盘空间达到某个阈值时删除这些文件。

现在，如果您可以确定在使用特定临时文件后将不再需要它，那么删除该特定文件没有任何不利之处。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T11:04:56.273

我们有一个类似的文件生命周期问题——（winforms）应用程序可以从中央存储库中获取一个文档供用户查看，但用户应该能够关闭我们的应用程序而不影响他们正在查看的文件。出于安全考虑，需要清理文档文件，以免它们放置太久。

我们使用的解决方案是在用户的隔离存储区域中创建一个具有日期派生名称的文件夹，并将其用作今天的缓存。在应用程序关闭和启动时，我们检查以前过时的缓存文件夹并删除它们（和内容）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T17:47:32.323

我相信当用户注销时它们会被删除。

回到人们每天关闭电脑的时代，这可能是一个完美的解决方案。

现在，人们可能会在几个月内不注销，因此依赖它可能不是一个好主意。

此外，如果他们在不关闭机器的情况下关闭机器，那么文件也不会被删除。

您可以使用文件系统监视器来监视您编写的文件，并等待一段时间不活动（10 分钟、1 小时、1 天或其他任何时间），然后删除该文件。

但这并不适用于所有事情。一些程序可能有一个文件“打开”，但可能没有锁定底层文件。如果发生这种情况，那么您将无法知道何时可以安全地删除该文件。

但是，我认为您可能会忽略这个问题。无论如何，大多数人可能都有多余的硬盘空间，所以他们可能不太可能遇到它。如果他们这样做了，我认为 Windows 会弹出一个磁盘空间不足的对话框，让他们可以选择清除临时目录，这将解决问题。

**更新：**

我认为 Windows Update 大约会每月重新启动一次用户的计算机，因此在发生这种情况时应该清除临时文件。

不能保证不会有问题，但在实践中我认为应该很少见。

**更新 2：**

在评论的提示下，我去实际测试了这个，看起来 Windows 在用户注销时不会删除临时文件。但是，我仍然说，在 OP 的情况下，这不是一个真正的问题。当它出现问题时（因为磁盘空间不足），Windows 会提示用户删除临时文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-06T19:20:55.597

在 ASP.NET 中使用临时文件时，请使用 PAGE_DISPOSED 事件删除您在页面中创建的任何临时文件。否则，您最终可能会与直到 DISPOSED 才放手的组件发生争用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-19T14:03:46.207

我使用这个解决方案（非常可靠）：

```
using System.IO;
using System.Reflection;

namespace Konard.Helpers
{
    public static partial class TemporaryFiles
    {
        private const string UserFilesListFilenamePrefix = ".used-temporary-files.txt";
        static private readonly object UsedFilesListLock = new object();

        private static string GetUsedFilesListFilename()
        {
            return Assembly.GetEntryAssembly().Location + UserFilesListFilenamePrefix;
        }

        private static void AddToUsedFilesList(string filename)
        {
            lock (UsedFilesListLock)
            {
                using (var writer = File.AppendText(GetUsedFilesListFilename()))
                    writer.WriteLine(filename);
            }
        }

        public static string UseNew()
        {
            var filename = Path.GetTempFileName();
            AddToUsedFilesList(filename);
            return filename;
        }

        public static void DeleteAllPreviouslyUsed()
        {
            lock (UsedFilesListLock)
            {
                var usedFilesListFilename = GetUsedFilesListFilename();

                if (!File.Exists(usedFilesListFilename))
                    return;

                using (var listFile = File.Open(usedFilesListFilename, FileMode.Open))
                {
                    using (var reader = new StreamReader(listFile))
                    {
                        string tempFileToDelete;
                        while ((tempFileToDelete = reader.ReadLine()) != null)
                        {
                            if (File.Exists(tempFileToDelete))
                                File.Delete(tempFileToDelete);
                        }
                    }
                }

                // Clean up
                using (File.Open(usedFilesListFilename, FileMode.Truncate)) { }
            }
        }
    }
} 
```

每次您需要临时文件使用时：

```
var tempFile = TemporaryFiles.UseNew(); 
```

确保在应用程序关闭或崩溃后删除所有临时文件

```
TemporaryFiles.DeleteAllPreviouslyUsed(); 
```

在应用程序开始时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-06T19:28:26.050

*   您可以创建一个临时文件，在其中您可以继续写入过程中创建的文件名，在处理结束时您可以（前提 - 实现 IDisposable 并）在操作完成后在 Disponse 方法中删除。

*   另一种方法是编写独立的进程，每个间隔执行清理。

*   在文件末尾附加日期，并在具有该日期的那一天结束时删除，进程将在末尾生成带有新日期的新文件。

*   divo tempfilecollection 类给出的一个很好的建议。

希望能帮助到你。

# jquery - jQuery：多元素选择

> ID：659361
> 
> 赞同：1
> 
> 时间：2009-03-18T17:38:35.323
> 
> 标签：jquery, css-selectors

我正在使用 jQuery 1.3.2：

```
<script src="../../Scripts/jquery-1.3.2.js" type="text/javascript"></script> 
```

我有以下html：

```
 <div id="container-div">
        <div id="package_1">
            <div>Package_1</div>
            <div id="package-content"></div>
        </div>
        <div id="package_2">
          <div>Package_2</div>
          <div id="package-content"></div>
        </div>
    </div> 
```

我正在尝试使用 jQuery 选择器选择所有“包内容”元素。我以为我可以执行以下操作，但它没有按预期工作：

```
$('#package-content') 
```

这只是返回列表中的第一个元素——这是我对 getElementById("package-content") 的期望，但我认为 jQuery 会返回一个包含所有元素的数组。我对 div id 的 jQuery 选择器的理解中缺少什么？

我编写了以下测试来弄清楚发生了什么，但除了证明它只是选择第一个元素之外，它对我的​​理解没有帮助。

```
alert($('#container-div').find('#package-content').size()); // = 2
alert($('#package-content').size()); // = 1
alert($('#package-content').parent().attr('id')); // = package_1

$("#package-content").each(function() {
    alert('parent: ' + $(this).parent().attr('id') + ' child: ' + $(this).attr('id')); = parent: package_1 child: package-content
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-18T17:41:26.393

**id**应该是标识特定元素的唯一值。你不能有两个相同的 div。你可以尝试使用一个**类**，`$('.package-content')`而不是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T17:43:45.530

使 package-content 成为一个类，您仍然可以在这些 div 上使用 id，但最好的做法是使 id 具有唯一性

```
<div id="container-div">
    <div id="package_1">
        <div>Package_1</div>
        <div id="pc1" class="package-content"></div>
    </div>
    <div id="package_2">
      <div>Package_2</div>
      <div id="pc2" class="package-content"></div>
    </div>
</div> 
```

然后使用类选择器：

```
$(".package-content") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T17:42:03.710

`id`属性旨在是唯一的。尝试将`class`属性设置为`package-content`并将选择器更改为`.package-content`而不是`#package-content`.

# asp.net - 如何让visual studio 2008 ASP.NET 设计器更快？

> ID：659366
> 
> 赞同：2
> 
> 时间：2009-03-18T17:39:27.820
> 
> 标签：asp.net, visual-studio-2008, performance, designer

用于 asp.net 应用程序的 Visual Studio 设计器通常非常慢，我想知道是否有任何设置提示或指南以便变得更好。

当我尝试在设计或源视图中进行更改时，通常会注意到该问题，尤其是在源视图中，它可能会在几秒钟内无响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T17:45:53.700

以安全模式启动时，您注意到有什么不同吗？

```
devenv.exe /SafeMode 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T21:26:05.263

我假设您已经安装了针对 VS2008 ASP.Net Designer 性能问题的修补程序？[关联](http://weblogs.asp.net/scottgu/archive/2008/02/08/vs-2008-web-development-hot-fix-roll-up-available.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T21:41:36.957

当我第一次安装 Visual Studio Team System 2008 开发版时，我遇到了一个非常相似的问题。我对 VS 设计视图有疑问，无法切换到“拆分视图”

参考下面的 ASP.NET 线程[链接](http://forums.asp.net/t/1191630.aspx)，看看这些信息是否有帮助..（警告：它很长）。

# php - 在 PHP 中解析大 XML

> ID：659369
> 
> 赞同：2
> 
> 时间：2009-03-18T17:40:36.647
> 
> 标签：php, xml

我需要在 PHP 中解析相当大的 XML（比如 300 MB）。我怎样才能最有效地做到这一点？

特别是，我需要找到特定的标签并将它们的内容提取到一个平面 TXT 文件中，仅此而已。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-18T17:51:09.287

您可以使用 PHP 的[xml 解析器函数，使用](http://php.net/manual/en/book.xml.php)[基于 SAX](http://en.wikipedia.org/wiki/Simple_API_for_XML)的老式解析方法读取和解析 XML 块。

使用这种方法，您可以解析的文档大小没有真正的限制，因为您只需一次读取和解析一个缓冲区满的文件。解析器将触发事件以指示它已找到标签、数据等。

手册中有一个[简单](http://www.php.net/manual/en/example.xml-structure.php)的示例，显示了如何获取标签的开始和结束。出于您的目的，您可能还想使用[xml_set_character_data_handler](http://www.php.net/manual/en/function.xml-set-character-data-handler.php)以便您也可以选择标签之间的文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T17:46:45.010

最有效的方法是创建静态 XSLT 并使用[`XSLTProcessor`](http://www.php.net/manual/en/class.xsltprocessor.php). 方法名称有点误导。即使你想输出纯文本，[`transformToXML()`](http://www.php.net/manual/en/xsltprocessor.transformtoxml.php)如果你需要 is 作为字符串变量，或者[`transformToURI()`](http://www.php.net/manual/en/xsltprocessor.transformtouri.php)你想写一个文件，你应该使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T17:50:40.833

如果是一次或几次工作，我会使用[XML Starlet](http://xmlstar.sourceforge.net/)。但是，如果您真的想在 PHP 端进行操作，那么我建议您将其预解析为更小的块，然后对其进行处理。如果您通过[DOM](http://php.net/DOM)将其作为一大块加载，则会占用**大量**内存。还可以使用 CLI 端 PHP 脚本来加快速度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T18:01:09.233

这就是 SAX 的设​​计目的。SAX 在读取小数据缓冲区并在遇到元素、字符数据等时触发事件的内存占用较低。

如何使用 SAX 并不总是很明显，我不是第一次使用它，但本质上你必须保持自己的状态并查看你在文档结构中的位置，所以通常你会结束使用变量描述您在文档的哪个部分，例如当您遇到特定的开始/结束元素时设置的 inFoo、inBar 等。

[这里](http://www.joemarini.com/tutorials/tutorialpages/listoflinks.php)有一个 sax 解析器的简短描述和示例

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T19:35:29.130

拉解析是要走的路。这样它就可以节省内存并且易于处理。我一直在处理 50 Mb 或更大的文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T17:47:51.200

根据您的内存要求，您可以加载它并[使用 XSLT](http://us.php.net/xslt)（消耗内存的路由）对其进行解析，或者您可以创建一个[只进游标](http://us.php.net/manual/en/book.xmlreader.php)并自己遍历树，打印您正在寻找的值（内存有效的路线）。

# tfs - TFS-工作项

> ID：659373
> 
> 赞同：0
> 
> 时间：2009-03-18T17:41:03.557
> 
> 标签：tfs

我有一个要求，但我无法找出解决方案。任何形式的帮助表示赞赏。

我们已经定制了流程模型。

问题。

我有 FactTable 说 Release，Release 有 Project，项目内部会有不同的状态，开发-生产-QA。我需要做的是生成一个查询，该查询将为我提供针对特定项目、选定阶段和选定版本的所有缺陷。

这可能吗？我们可以在 TFS 中编写子查询吗？

我将不胜感激提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-08T11:52:30.077

您可以将发布视为团队项目集合，然后将项目视为团队项目。对于开发-生产-QA 阶段，您可以使用区域或创建自定义工作项字段“阶段”，可报告属性为“维度”。

现在您可以使用 wither TFS_Analysis 即 Cube 或 TFS_Warehouse 来获取您的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T20:58:15.040

如果我必须这样做，我会进行迭代：开发、生产和 QA。

然后迭代显示无处不在，从简单的查询到 TFS 仓库！

# c++ - Windows 中的线程有什么好的初学者教程吗？C++

> ID：659376
> 
> 赞同：5
> 
> 时间：2009-03-18T17:42:04.897
> 
> 标签：c++, windows, multithreading

寻找解释 Windows 线程的好网站或书籍，最好是初学者。也许有一个示例程序要运行，等等......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T17:59:45.867

您需要 Charles Petzold 编写的[Programming Windows](https://rads.stackoverflow.com/amzn/click/com/157231995X)的第 20 章“多任务和多线程”。

它还涵盖了相关的内容，例如同步和事件。

这本书是经典之作，并且可能是很好地理解 Windows Win32 编程如何与 C++ 一起工作的最佳方法之一。

否则，您可以在[此 MSDN 页面上开始 CreateThread](http://msdn.microsoft.com/en-us/library/ms682453(VS.85).aspx)。

对于更便携的解决方案，[增强线程](http://www.boost.org/doc/libs/1_38_0/doc/html/thread.html)也是另一种方法。结合 boost::bind 和几个 boost 同步对象，它构成了一个非常强大的线程库。

# c# - 为什么我的表格在 ASP.NET 中没有内容？

> ID：659377
> 
> 赞同：1
> 
> 时间：2009-03-18T17:42:11.837
> 
> 标签：c#, .net, asp.net, html

我在 GetData.cs 类中建立了一个表

```
public Table  BuildTable()
{
    Table tButtons = new Table();
    TableRow tRow = new TableRow();
    TableCell tCell = new TableCell();
    long lColumn = 0;
    long lPreviousColumn = 0;
    long lRow = 0;
    long lPreviousRow = 0;
    long lLanguage = 0;
    long lPreviousLanguage=0;
    OpenConnection();
    ButtonData();
    Int32 lRowOrd = aReader.GetOrdinal("RowNumber");
    Int32 lColOrd = aReader.GetOrdinal("ColumnNumber");
    Int32 lLangOrd = aReader.GetOrdinal("Language");
    Int32 lLabelOrd = aReader.GetOrdinal("Label");

    while (aReader.Read())
    {

        lRow = IsDbNull(aReader,lRowOrd);//first get our column number
        lColumn = IsDbNull(aReader,lColOrd);//first get our column number
        lLanguage = IsDbNull(aReader,lLangOrd);//first get our column number
        if (lPreviousRow != lRow)//we have a new row 
        {
            if (lPreviousRow != 0)//then we are working on one and need to save it before moving on
            {
                tButtons.Rows.Add(tRow);//add the new row to the table
            }
            lPreviousRow = lRow;//remember the value for next time
            tRow = new TableRow();
            tRow.Visible = true;
            //*******put the category titles in here somewhere
        }
        if (lPreviousColumn != lColumn)//we have a new column
        {
            if (lPreviousColumn != 0)//then we are working on one and need to save it before moving on
            {
                tRow.Cells.Add(tCell);//add the new cell to the row
            }
            lPreviousColumn = lColumn;//remember the value for next time
            //*******add the cell colors
            if (lPreviousLanguage != lLanguage)//we have a new column
            {
                lPreviousLanguage = lLanguage;//remember the value for next time
                tCell.Text = IsDbNull(aReader,lLabelOrd,"");
                //*******add the languages to properties
            }
            tCell = new TableCell();
            tCell.Visible=true;
        }
    }
    CloseConnection();
    tButtons.Visible=true;
    return tButtons;
} 
```

在我的 Default.aspx.cs 页面中，我有

```
GetData Buttons = new GetData();//create a reference to the class
ButtonTable = Buttons.BuildTable();
OutPut.Text = ButtonTable.Rows.Count.ToString(); 
```

在 Default.aspx 中

```
<asp:Table runat="server" ID="ButtonTable" />   
<asp:Label runat="server" ID="OutPut" /> 
```

输出显示 4 行，但表为空。

```
<table id="ButtonTable" border="0"></table> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T17:57:06.980

> 我到底错过了什么？

显然，很多。[在您的标记中，您已经声明了System.Web.UI.WebControls.Table](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.table.aspx)的一个实例。在您的 Page 类实例中，这将有一个变量名“ButtonTable”。它还将自动添加到[Page.Controls](http://msdn.microsoft.com/en-us/library/system.web.ui.control.controls.aspx)集合中。当页面要被渲染时，Controls 集合将被迭代并依次渲染。

在您的 default.aspx.cs 代码中，您只是将 ButtonTable 引用指向*不同的 Table 控件*- 但您不会影响 Page.Controls 集合。当渲染时间到来时，将渲染标记中定义的（空白）表 - 而不是 BuildTable 调用的结果。

所有这一切都是一个相当冗长的“你做错了”。*为什么*您希望您的表格构建代码在一个单独的类中的答案将阐明“正确的方式”。但是 - 我无意冒犯 - 我认为您需要先学习 ASP.NET 背后的基础知识，然后再继续学习。

话虽这么说，最直接的解决方法（但可能*不是您真正想要*的）是将表添加到 Controls 集合中，以便呈现：

```
GetData Buttons = new GetData();//create a reference to the class
ButtonTable = Buttons.BuildTable();
this.Controls.Add(ButtonTable);
OutPut.Text = ButtonTable.Rows.Count.ToString(); 
```

请注意，它将与您的标记定义的 ButtonTable 分开呈现，因此将放置*在*Output 标签之后。那是因为它是在输出标签之后添加的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:00:58.797

我真的建议你：

*   在调试器中逐行运行，看看发生了什么
*   重构它，代码很难阅读。添加更多评论并不能解决这个问题。
*   考虑您想要实现的目标并检查它是否适合将数据绑定到像 ListView 这样的控件。

也就是说，您的代码：

```
GetData Buttons = new GetData();
ButtonTable = Buttons.BuildTable(); // this is what's wrong
OutPut.Text = ButtonTable.Rows.Count.ToString(); 
```

只是在页面中分配控件不是这样做的方法。将返回的表添加到控件集合中，或者更改 BuildTable 以接收它将加载信息的表。永远不要直接分配给 asp.net 页面的控件，一旦我不得不调试一些非常奇怪的问题的代码，并且开发人员将 null 分配给在 asp.net 期间搞砸的控件（而不是控件的属性）渲染周期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T17:52:09.287

ButtonTable = Buttons.BuildTable();

你在里面做什么？

# html - IE7输入问题

> ID：659382
> 
> 赞同：0
> 
> 时间：2009-03-18T17:44:03.487
> 
> 标签：html, internet-explorer-7

我在html中有以下代码：

```
<div>
  <div style="float:left;margin:0.5em">
    <span class="title">Label1</span><br/>
    <input type="text" name="name1" size="8" />
  </div>
  <div style="float:left;margin:0.5em">
    <span class="title">Label2</span><br/>
    <input type="text" name="name2" size="12" />
  </div>
  <div style="float:left;margin:0.5em">
    <span class="title">Label3</span><br/>
    <input type="text" name="name3" size="12" />
  </div>
  <div style="float:left;margin:0.5em">      
    <span class="title">Label4</span><br/>
    <select name="name4">
      <option value="m">value1</option>
      <option value="f">value2</option>
    </select>
  </div>
  <div style="float:left;margin:0.5em">
    <span class="title">Label5</span><br/>
    <input type="text" name="name5" size="8" />
  </div>
</div> 
```

在 Mozilla Firefox 和 Google Chrome 中看起来不错： [firefox 和 chrome 看起来 http://jakub.sturc.info/data/so-labeled-inputs-chrome.png](http://jakub.sturc.info/data/so-labeled-inputs-chrome.png)

但是在 Internet Explorer 7 中，它的格式有点不正确： [格式错误的 IE7 看起来 http://jakub.sturc.info/data/so-labeled-inputs-ie7.png](http://jakub.sturc.info/data/so-labeled-inputs-ie7.png)

您有任何提示如何强制 IE 呈现所需的输出吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T17:47:26.957

因为您没有使用重置 css，所以我建议您使用一种快捷方式，即在包装 div 上将边距更改为填充，这将在浏览器之间保持一致。

不是最好的技术，但在你的情况下最简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T20:33:36.433

我认为理查德给了你正确的答案，这似乎有效：

```
<div style="float:left;padding:0.5em">
<span class="title">Label1</span><br/>
<input type="text" name="name1" size="8" />
</div> 
```

问题一定是 IE 没有将边距应用于 span 标签，但由于某种原因确实应用了填充。

# sql-server - 为什么 MS SQL Mgmt Studio Express 总是忘记我的密码？

> ID：659384
> 
> 赞同：9
> 
> 时间：2009-03-18T17:44:25.200
> 
> 标签：sql-server, passwords, ssms

我已经使用这个工具了，我在登录对话框中检查了保存密码框，但它不起作用。有时会持续几天，然后密码就会消失。几乎每次我加载这个东西时，我都必须再次追踪密码并输入它。数据库中是否有一些密码规则会导致这种情况？这让我快疯了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T18:05:06.087

这里也一样。改用[蟾蜍](http://www.toadsoft.com/toadsqlserver/toad_sqlserver.htm)。吸的少了。它可以排序，这是我发现 Mgmt Studio 中缺少的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:31:57.990

我有同样的问题，我的一些同事也有。搜索告诉我，有些人有同样的问题，有些人根本没有遇到过。

Microsoft 已经意识到这一点已有两年或更长时间了，但到目前为止，它似乎还不是一个解决方案……

[MSDN 论坛“SQL Server Management Studio 2005 忘记密码？”](http://social.msdn.microsoft.com/Forums/en-US/sqltools/thread/e40a3a81-748c-4a26-9fa3-9945b7a98be0/)

这里有人为什么通过输入服务器名称而不是在下拉列表中选择它来获得一些运气。（我自己还没有尝试过。）：

[eggheadcafe “Management Studio 忘记密码（“更改连接”）”](http://www.eggheadcafe.com/conversation.aspx?messageid=29988803&threadid=29988794)

这是一个 10/2006 的错误报告，由于它是重复的，因此已关闭，但我无法找到原始错误报告...

[Microsoft Connect：“注册的服务器属性中未记住‘记住密码’选项”](https://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=124842)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-24T16:25:57.677

现在是 2015 年，我对 SQL Server 2012 Management Studio 也有同样的问题。

如果您不打算修复某些内容，请删除它。

我想知道他们是否在微软有 PsyOps 项目……哈哈 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-28T14:58:42.677

这是我多年来一直使用的解决方法。它要求我每天早上在启动 SSMS 之前在桌面上运行批处理文件快捷方式。首先，您必须拥有一组良好的登录名和密码。这需要你找到你想要被记住的任何和所有联系。完成此操作后，复制“SqlStudio.bin”文件，其中包含“SqlStudio - Copy.bin”的登录名和密码。现在您可以运行以下批处理文件，我称之为“PwdFixSSMS.bat”。这是批处理脚本并将第三行中的“YOURNAME”更改为您的目录，通常是您的登录名。希望这可以帮助;

```
@echo off

REM:: fixes lost passwords in SqlStudio (SSMS) Then Open program (optional)

cd C:\Documents and Settings\"YOURNAME"\Application Data\Microsoft\SQL Server Management Studio\11.0

copy "SqlStudio - Copy.bin" SqlStudio.bin

rem:: Start "" "C:\Program Files (x86)\Microsoft SQL     Server\110\Tools\Binn\ManagementStudio\Ssms.exe"

start %comspec% /c "mode 60,10&title My Popup&color 1e&echo.&echo. Restored SMSS Password File SqlStudio.bin %date%&echo.&echo.&timeout /T 2" 
```

# jquery - 将数据从 JQuery 传递到控制器动作

> ID：659386
> 
> 赞同：1
> 
> 时间：2009-03-18T17:44:52.300
> 
> 标签：jquery, asp.net-mvc, ajax

我必须对我的控制器操作方法做任何特别的事情来接受/绑定来自 .ajax() 调用的数据吗？

控制器动作 -

```
public class TestController : Controller
{
    public JsonResult GetTestJsonData(Metadata data)
    {
        return new JsonResult { Data = data };
    }
} 
```

jQuery 调用 -

```
<script type="text/javascript">
    $(document).ready(function() {
        $.ajax({
            type: "POST",
            url: "GetTestJsonData",
            data: "{ data: {Name:'joe'}}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function(msg) {
                alert("Name = " + msg.Name);
            }
        });
    });
</script> 
```

我希望这个页面会以“joe”的名字发出警报。我将 json 数据从客户端传递到控制器操作，然后操作将其传递回客户端。这只是我正在尝试做的一个简单示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T18:13:39.127

您的代码可能适用于一个简单的示例，因为您没有解析任何内容，但是如果您想将 JSON 转换为控制器操作上的真实对象，那么您需要告诉 MVC 如何进行。

有一篇关于编写 JsonFilterAttribute 的博客文章，它使用 Json.NET 对传入的 JSON 进行反序列化并将其转换为对象。

[http://blogger.forgottenskies.com/?p=252](http://blogger.forgottenskies.com/?p=252)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T18:40:30.230

其他答案需要自定义活页夹，但如果这超出了您的应用程序范围，还有另一种方法。如果您的 JSON 属性与 ActionResult 方法上的参数匹配（即它不是一个复杂的 JSON 对象），则无需对 POST 进行反序列化。

```
<script type="text/javascript">
    $(document).ready(function() {
        $.ajax({
                type: "POST",
                url: "GetTestJsonData",
                data: "{ name:'joe', id:1, age:18 }",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function(msg) {
                        alert("Name = " + msg.Name);
                }
        });
    });
</script> 
```

以下 ActionResult 可以使用它：

```
public ActionResult GetTestJsonData(string name, int id, int age)
{
  Metadata data = new Metadata(name, id, age);

  return Json(data);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T18:21:55.843

编写一个可以理解 JSON 的自定义 ModelBinder。您可以使用 JSON 库将其反序列化为您的对象，然后将其返回。

然后你的动作变成：

```
public ActionResult GetTestJsonData([JsonBinder] Metadata data)
{
   return Json(data);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T03:47:06.433

我一直在使用 System.Web.Script.Serialization 命名空间中的 JavaScriptSerializer 类来实现这一点并取得了巨大的成功，而且再简单不过了。关键是您传递给控制器​​方法的 javascript json 对象需要与您尝试将其序列化到的 .NET 对象具有相同的结构。例如，假设这是您控制器中的目标 .NET 对象。

```
class TestObject {
    public string Name {get;set;}
    public int Age {get;set;}
} 
```

然后您的 JavaScript 对象将如下所示...

```
{Name: 'Lunchy', Age: 28} 
```

然后在您的控制器中，看起来像这样，（假设您在将 javascript 对象传递给控制器​​之前对其进行字符串化。我使用 JSON.stringify(jsObj) 方法）。

```
public JsonResult TestSerialization(string jsonString)
{
    var jss = new JavaScriptSerializer();
    TestObject to = jss.Deserialize<TestObject>(jsonString);

    return Json(TestObject);
} 
```

这是未经测试的代码，我特别不确定我的 json 对象语法，但希望你能明白。另请注意，MSDN 可能会显示 JavaScriptSerializer 类已被标记为已弃用，但这已被收回。它实际上是 MVC 框架用来进行 json 序列化的类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-11T11:54:40.457

自从您解决此问题以来已经很长时间了，但是我的回答希望**将来可以通过类似的过程对您有所帮助**。

我不能直接谈论有关您已接受的答案的问题（因为链接博客上的所有代码链接到今天都已失效），但由于它使用 Json.Net，我猜该解决方案使用该技术将字符串发送到操作方法，然后在操作方法本身中使用 Json.NET 对其进行解析。

这些技术绕过了强大的 Asp.net MVC 2+ 自动模型状态验证功能。

我写了一篇博客文章，直接解决了这个问题，并提供了使事情按预期工作的最简单的方法。

**我建议您阅读它以供将来参考：**
[Sending complex JSON objects to Asp.net MVC using jQuery](http://erraticdev.blogspot.com/2010/12/sending-complex-json-objects-to-aspnet.html)

# deployment - cab 文件中的快捷方式图标

> ID：659405
> 
> 赞同：1
> 
> 时间：2009-03-18T17:48:33.537
> 
> 标签：deployment, compact-framework, cab

如何在cab文件中放置快捷方式图标？任何人都可以对此有所了解吗？我在网上搜索并没有找到任何有关此的信息，除了声称智能设备项目中使用的图标被自动拉入驾驶室。好吧，事实并非如此。它被拉了一次，之后当我更改图标时它仍然显示一个旧图标。

有什么线索吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T18:15:36.343

快捷方式图标是应用程序本身的图标，因此您无需“添加”一个。请记住，WinMo/Pocket PC 会为“开始”菜单缓存该图标，因此如果您的应用程序开始时有不同的图标，那么您可能必须软重置设备以获取开始菜单以选择新的图标。

# c# - 企业库强命名指导包

> ID：659408
> 
> 赞同：2
> 
> 时间：2009-03-18T17:49:35.407
> 
> 标签：c#, .net, asp.net, vb.net, enterprise-library

对于我的生活，我找不到 Enterprise Library 4.1 的 Enterprise Library Strong Naming Guidance Package 下载

我需要这个来签署程序集以将它们添加到 GAC。

有人知道我在哪里可以找到它吗？我在 www.codeplex.com/entlib 或 www.codeplex.com/entlibcontrib 网站上的任何地方都找不到它。

帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T17:54:09.780

据此[，](http://msdn.microsoft.com/en-us/library/dd203099.aspx)运送的二进制文件已经命名为强，所以你应该[好好去](http://msdn.microsoft.com/en-us/library/dd203283.aspx)。

编辑：如果您修改了源代码，请使用[本指南](http://msdn.microsoft.com/en-us/library/dd140121.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T21:36:41.427

指导包已签入 EntLibContrib： [http ://entlibcontrib.codeplex.com/SourceControl/ListDownloadableCommits.aspx](http://entlibcontrib.codeplex.com/SourceControl/ListDownloadableCommits.aspx)

请参阅变更集 18160

# java - 无法从 NetBeans 提交到 Subversion

> ID：659411
> 
> 赞同：2
> 
> 时间：2009-03-18T17:50:13.860
> 
> 标签：java, svn, netbeans

当我在 Java 中更改某些界面内容（例如菜单项的内容）并保存它们时，提交选项不会启用。NetBeans 不知道已产生更改，因此我无法提交它们。我怎样才能提交它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T18:08:13.913

你可以从控制台提交吗？

在项目的根目录中尝试*svn stat*，它应该会显示已在文件名附近使用 M 修改的文件。如果您能看到它们，请运行*svn ci*以提交所有更改。

**也许**（而且只是也许），svn 故意忽略这些文件，以检查这是否属实，从项目根目录中的控制台 svn propedit svn:ignore .(<- 这个点是必要的) 运行以检查该目录/文件/文件扩展名被忽略。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:18:26.837

1.  [您使用的是 Netbeans 6 还是更高版本？](http://wiki.netbeans.org/FaqSubvesionRequirements) 如果没有，您需要告诉 Netbeans svn 可执行文件在哪里（请参阅链接和[相关的常见问题解答](http://wiki.netbeans.org/NetBeansUserFAQ#section-NetBeansUserFAQ-VersionControlSystems)）。

2.  您确定您的 subversion 存储库正在与您的工作站的当前时间视图同步的机器上运行（例如，通过[ntp](http://www.ntp.org/)同步）？如果时间足够不同步，则 subversion 模块可能缺少更新，因此没有标记更改。

3.  此外，您应该检查以确保您具有与 subversion 存储库的活动有效连接。您可以轻松地对刚刚编辑的文件执行此操作：右键单击该文件的编辑器选项卡，然后选择 Subversion -> Diff 或 Show Changes 或 Search History。如果其中任何一个失败，则您的 IDE 由于某种原因失去了与 SVN 的连接。

4.  另一种可能性是您没有成功进行真正的结帐：如果`.svn`未正确配置子目录，则菜单项肯定会被禁用。我建议您右键单击项目（在项目下）并尝试显示更改。如果这不成功，则说明您没有有效的 Subversion 签出，并且 Netbeans 选项肯定不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T18:09:10.273

如果出于某种原因 netbeans 不允许您提交，我建议您从命令行执行，或使用[TortoiseSVN之类的程序](http://tortoisesvn.tigris.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T18:12:41.000

了解自上次提交/更新以来发生了什么变化是 Subversion 的责任。如果 NetBeans 的 Subversion 接口不允许提交，那么它可能是 Netbeans 中的一个错误。从技术上讲，应该没有理由禁用提交按钮 - 即使没有任何更改，Subversion 也不会阻止您提交。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-09T05:34:01.803

右键单击标记为红色的文件，选择解决冲突

并尝试现在提交...

# entity-framework - 在实体框架中构建堆栈

> ID：659414
> 
> 赞同：1
> 
> 时间：2009-03-18T17:51:38.070
> 
> 标签：entity-framework, stack

我的模型中的一种实体（我们称之为 E1）需要能够将其与另一种实体类型（E2）的关系视为堆栈。反过来，该其他​​实体需要能够看到 E2 位于堆栈顶部的所有第一类型的相关实体，以及 E2 在 E1 的堆栈内的每种情况。

这对我来说听起来并不那么清楚，所以让我尝试演示一下：

E1 实体：**foo** { stack: *quux* , *plugh* , *glurp* }, **bar** { stack: *plugh* , *glurp* }, **baz** { stack: *quux* , *plugh* }

E2 实体：**quux** { top: `null`; 在：*foo*，*baz* }，**plugh** { 顶部：*baz*；在：*foo*，*bar*，*baz* }，**glurp** { 顶部：*bar*；在：*foo*，*bar* }

现在，我有一个数据库表，其中包含 E1 和 E2 的键列，以及用于存储 E2 在堆栈中的位置的 int。Entity Framework 将此表视为自己的实体，而不是 E1 和 E2 之间关系的一部分，这会使查询复杂化，并且只会导致一些简单丑陋的代码。

我知道我做错了，但有可能做到这一点吗？如果是这样，怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T18:07:28.673

因此，如果我们将您的关系表称为 R，则每个 E1“包含”多个 R（它是堆栈，按 R.position 排序）并且每个 E2 以两种方式包含多个 R：具有 R.position == R.e1.top 的那些和那些这不成立）。

*   那是对的吗？
*   您如何跟踪顶部？当堆栈更改时（例如，e1.top 是恒定的），您是更新 E1 的所有 Rs，还是将其存储在每个 E1 中？
*   将 Rs 链接起来是否有意义（给他们一个“下一个指针”而不是一个“位置”）
*   你需要随机访问堆栈吗？
*   E2 真的需要了解他们不在顶部的情况吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:48:34.953

因为这是一个非常奇特的情况，所以没有支持它的构建。但是你可以让它看起来不错。

现在，假设您的连接表称为 E1E2，您就有了类似的东西。

```
public partial class E1
{
   public Guid Id { get; set; }
   public IQueryable<E1E2> Stack { get; }
}

public partial class E2
{
   public Guid Id { get; set; }
   public IQueryable<E1E2> In { get; }
}

public partial class E1E2
{
   public E1 E1 { get; set; }
   public E2 E2 { get; set; }
   public Int32 Position { get; set; }
} 
```

作为 hoc，我无法想出更好的解决方案来将其映射到数据库。为了使使用尽可能智能，只需向实体添加一些属性和方法。这很容易，因为实体 a 生成为部分类。

使用以下内容扩展 E1 类。

```
public partial class E1
{
   public IQueryable<E2> NiceStack
   {
      get { return this.Stack.Select(s => s.E2).OrderBy(s => s.Position); }
   }

   public void Push(E2 e2)
   {
      this.Stack.Add(
         new E1E2
         {
            E2 = e2,
            Position = this.Stack.Max(s => s.Position) + 1
         });
   }

   public E2 Pop()
   {
      return this.Stack.
         Where(s => s.Position == this.Stack.Max(s => s.Position).
         Select(s => s.E2).
         Single();
   }
} 
```

使用以下内容扩展 E2 类。

```
public partial class E2
{
   public IQueryable<E1> NiceIn
   {
      get { return this.In.Select(i => i.E1); }
   }

   public IQueryable<E1> NiceTop
   {
      get
      {
         return this.In.
            Where(i => i.Position == i.E1.Stack.Max(s => s.Position)).
            Select(i => i.E1);
      }
   }
} 
```

到此为止。现在应该可以围绕这些实体编写相当不错的代码了。代码中可能存在一些错误，但想法应该很清楚。我省略了代码以确保在访问时加载相关属性。您可以进一步将原始属性设为私有并将它们隐藏起来。也许您不应该包含 NiceStack 属性，因为它允许随机访问。或者，也许您想添加更多扩展 - 也许让 NiceTop 可写，将 E2 实例推送到插入到 E2 实例的 NiceTop 中的 E1 实例的堆栈上。但这个想法保持不变。

对 Single() 的调用不适用于普通的实体框架；而是使用 ToList().Single() 切换到 LINQ to Object 或使用 First() 但 first() 不保留确切的语义。

# python - Python 序列命名约定

> ID：659415
> 
> 赞同：2
> 
> 时间：2009-03-18T17:51:50.783
> 
> 标签：python, naming-conventions, sequence

由于在 python 中没有显式键入，我希望能够使用命名约定来区分序列和非序列。我已经用 python 编程了一段时间，但我仍然没有找到任何逻辑/实用的方式来命名序列。当然，我翻遍了大名鼎鼎的[PEP8](http://www.python.org/dev/peps/pep-0008/)，并在 google 上做了一些研究，似乎公认的约定是在变量名的末尾添加字母“s”。

假设我们有一个“权重值”序列，因此序列的变量名应该是*weights*。到目前为止，这很好，但是在某些情况下，某些单词以“s”结尾并且恰好是命名不是序列的变量的更合乎逻辑的方式。或者假设您将权重序列本身存储在一个序列中。“s”命名约定将命名变量*weightss*，这很难看。我确信序列有更好的命名约定。

你会建议什么样的序列命名约定？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-18T18:00:41.310

一般来说，避免这种行为。来自[PEP8的通知](http://www.python.org/dev/peps/pep-0008/)

> 愚蠢的一致性是小精灵的妖精

这正是调用变量`weightss`要做的事情。所以通常让你的变量描述它们是什么，而不是根据一些命名约定：

```
weights = [44, 66, 88]
weight_groups = [[44, 66, 88], ...] 
```

等等

从[PEP8](http://www.python.org/dev/peps/pep-0008/)的同一部分：

> 但最重要的是：知道何时不一致——有时风格指南并不适用。如有疑问，请使用您的最佳判断。查看其他示例并决定什么看起来最好。不要犹豫，问！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-18T18:03:23.363

> “s”命名约定将命名变量权重，这很难看。我确信序列有更好的命名约定。

我认为您所描述的约定应被解释为“只要您有某物的列表，请通过将其复数来明确它是一个列表”。例如，如果您有一个草实例列表，您可以调用 this `grasses`，而不是`grasss`。我不认为它是按字面意思理解的。

PEP 总是建议您采用自己的方法，如果这种方法更具可读性和实用性的话。正如[**阿里所提到**](https://stackoverflow.com/questions/659415/python-sequence-naming-convention/659439#659439)的，PEP 的指导原则之一是你不应该成为愚蠢一致性的牺牲品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T17:55:36.720

无论你的小心脏想要什么......

开个玩笑，但我不会挂断电话的。如果它很难看，请做一些事情以使其更具可读性`seq_weight`，例如`seq_weights`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T17:55:50.183

为什么不只是`thing_list`or `thing_seq`？

# windows - Server 2008 VPS 提供商

> ID：659422
> 
> 赞同：5
> 
> 时间：2009-03-18T17:53:58.237
> 
> 标签：windows, windows-server-2008, vps

我正在寻找一种服务于 Windows Server 2008 的价格合理且可靠的 VPS 解决方案。
用例是为 asp.net mvc 站点项目运行持续集成构建服务器。

有什么建议么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-29T11:27:00.860

我现在正在调查 VPS 解决方案，并编制了一份清单和定价。对于 Server 2008，我不推荐任何低于 1 GB 的 RAM。请注意，下面的某些项目表示 Server 2003，但也有 2008 选项可用。

> [http://vpsland.com/xlwin.html](http://vpsland.com/xlwin.html)
> 80 美元 - 1024MB RAM，40 GB 磁盘，1000 GB 带宽，2 个 IP，Server 2003 Enterprise
> 
> [http://liquidweb.com](http://liquidweb.com)
> 90 - 1024 MB RAM，100 GB 磁盘，700 GB 带宽，4 个 IP（每个额外 0.5 美元），Server 2003
> 
> [http://www.solarvps.com/products-win.php](http://www.solarvps.com/products-win.php) (Virtuozzo)
> 73.50 美元 - 1056 MB RAM，50 GB 磁盘，800 GB 带宽，5 个 IP（每个额外 1 美元），Server 2003 管理
> 73.50 美元 - 1184 MB RAM，60 GB 磁盘，600 GB 带宽，5 个 IP（每个额外 1 美元），Server 2003 管理
> 40 - 768 MB RAM，50 GB 磁盘，600 GB 带宽，5 个 IP（每个额外 1 美元），Server 2003 未管理
> 
> [http://kickassvps.com/services/windows_2008.php](http://kickassvps.com/services/windows_2008.php) (Virtuozzo)
> $90 - 1920MB RAM、40 GB 磁盘、400 GB 带宽、2 个 IP、Server 2008 Enterprise 64 位
> 
> [http://fullcontrol.net/](http://fullcontrol.net/) (Hyper-V)
> 79 美元 - 1GB RAM，40 GB 磁盘，1000 GB 带宽，2 个 IP，Server 2008 标准 32 位（x64 + 10
> 美元）89 美元 - 1GB RAM，40 GB 磁盘， 1000 GB 带宽，8 个 IP，Server 2008 标准 32 位（x64 + 10 美元）
> 
> [https://www.webspacedepot.com/vps_plans_windows.php](https://www.webspacedepot.com/vps_plans_windows.php) (Hyper-V)
> $26.93 - 1024MB RAM, 90 GB 磁盘, 1000GB 带宽, 2 IPs, Server 2003/2008, 2 CPU cores
> $36.93 - 1536MB RAM, 130 GB 磁盘, 1100GB 带宽，2 个 IP，Server 2003/2008，2 个 CPU 内核
> $50.93 - 2048MB RAM，200 GB 磁盘，1200GB 带宽，5 个 IP，Server 2003/2008，3 个 CPU 内核
> 
> [http://www.servebyte.com/windows.html](http://www.servebyte.com/windows.html) (xen)
> $50 - 1GB RAM, 80 GB 磁盘, 480GB 带宽, 3 个 IP, Server 2003, 2.0 GHz cpu 周期 $90 - 2GB RAM, 160 GB 磁盘, 1024GB 带宽, 4 个 IP，Server 2003，2.5 GHz CPU 周期

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T18:04:00.460

1.  Hyper-V 领域中最实惠的解决方案（比 Virtuozzo 更强大的解决方案）： [WebSpaceDepot](https://www.webspacedepot.com/vps_plans_windows.php)
2.  基于 Parallels Virtuozzo 技术的非常实惠的 VPS 与受人尊敬的供应商： [KickAss VPS](http://www.kickassvps.com/services/windows_vps/plans.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-18T04:21:06.180

[myhosting.com](http://myhosting.com)提供 2 个 Windows Server 2008 Hyper-V VPS 计划。快速设置，到目前为止非常稳定。 [http://myhosting.com/virtual-server-hosting/windows-plans.aspx](http://myhosting.com/virtual-server-hosting/windows-plans.aspx)

*   39.95 美元 - 512MB、25GB
*   69.95 美元 - 1GB、50GB

# unit-testing - 正确性定义不明确时进行测试？

> ID：659433
> 
> 赞同：4
> 
> 时间：2009-03-18T17:57:20.757
> 
> 标签：unit-testing, language-agnostic, automated-tests, data-mining

我通常会尝试对任何可以轻松定义正确行为的代码使用单元测试，这些代码给出了一些相当小的、定义良好的输入集。这对于捕获错误非常有效，我一直在我的个人通用函数库中这样做。

然而，我写的很多代码都是数据挖掘代码，基本上是在大型数据集中寻找重要的模式。在这种情况下，正确的行为通常没有很好的定义，并且依赖于人类不容易预测的许多不同的输入（即数学不能合理地手工完成，这就是我使用计算机首先解决问题）。这些输入可能非常复杂，以至于几乎不可能提出合理的测试用例。识别值得测试的边缘情况非常困难。有时算法甚至不是确定性的。

通常，我会尽我所能通过使用断言进行完整性检查并创建一个具有已知模式的小玩具测试用例，并非正式地查看答案是否至少“看起来合理”，而不一定是客观正确的。有没有更好的方法来测试这些案例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T18:05:50.843

我认为您只需要基于少量数据编写单元测试，以确保您的代码完全按照您的意愿执行。如果这给你一个合理的数据挖掘算法是一个单独的问题，我认为不可能通过单元测试来解决它。您的代码有两个“级别”的正确性：

1.  您的代码正确地实现了给定的数据挖掘算法（这个东西你应该单元测试）
2.  您实现的数据挖掘算法是“正确的”——解决了业务问题。这是一个非常开放的问题，它可能既取决于算法的某些参数，也取决于实际数据（不同的算法适用于不同类型的数据）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T18:07:15.130

当面对这样的情况时，我倾向于构建一个或多个*存根*数据集，以反映现实生活中数据的适当潜在复杂性。我经常与客户一起这样做，以确保我抓住了复杂性的本质。

然后我可以将它们编码为一个或多个数据集，这些数据集可以用作进行非常具体的单元测试的基础（有时它们更像是带有存根数据的集成测试，但我认为这不是一个重要的区别）。因此，虽然您的算法可能对“通用”数据集有“模糊”结果，但这些算法几乎总是对特定数据集有一个正确的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T18:06:25.693

嗯，有几个答案。首先，正如您所提到的，进行一个小型案例研究，然后手工计算。既然你写了算法，你就知道它应该做什么，所以你可以在有限的情况下做。

另一种是将程序的每个组件分解为可测试的部分。如果A调用B调用C调用D，并且你知道A、B、C、D都给出正确答案，那么你测试A->B、B->C和C->D，那么你可以合理地确定 A->D 给出了正确的响应。

此外，如果有其他程序可以做您想做的事情，请尝试获取他们的数据集。或者你可以使用测试数据的开源项目，看看你的应用程序是否给出了类似的结果。

测试数据挖掘代码的另一种方法是获取一个测试集，然后引入您正在寻找的类型的模式，然后再次测试，看看它是否会从旧模式中分离出新模式。

而且，经过验证的真实情况，手动浏览您自己的代码，看看代码是否按照您的意图执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T03:23:18.977

确实，这里的挑战是：因为您的应用程序旨在以一种智能的方式执行一项模糊的、非确定性的任务，您希望实现的目标是应用程序在发现这些模式方面变得比人类更好。这很棒，很强大，很酷……但是如果你成功了，那么任何人都很难说，“在这种情况下，答案应该是 X。”

事实上，理想情况下，计算机会说：“不是真的。我明白你为什么这么想，但是考虑一下这里的 4.2 TB 信息。你读过它们了吗？基于这些，我认为答案应该是 Z。 "

如果你真的成功实现了最初的目标，最终用户有时可能会说，“Zowie，你是对的。这是一个更好的答案。你找到了一个可以让我们赚钱的模式！（或者为我们省钱，或者任何）。”

如果这样的事情永远不会发生，那你为什么要让计算机首先检测这些模式呢？

所以，我能想到的最好的事情就是让现实生活帮助你建立一个测试场景列表。如果过去曾发现一种模式确实很有价值，那么请进行“单元测试”，看看您的系统在给定类似数据时是否发现了它。我用引号说“单元测试”是因为它可能更像是一个集成测试，但您仍然可以选择使用 NUnit 或 VS.Net 或 RSpec 或您正在使用的任何单元测试工具。

对于其中一些测试，您可能会以某种方式尝试“模拟”4.2 TB 的数据（您不会真正模拟数据，但在更高级别上，您会模拟从该数据得出的一些结论）。对于其他人，也许您有一个“测试数据库”，其中包含一些数据，您希望从中检测到一组模式。

此外，如果你能做到，如果系统能够在它检测到的模式背后“描述其推理”，那就太好了。这将让业务用户仔细考虑应用程序是否正确的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-18T04:19:41.663

这很棘手。这听起来类似于围绕我们的文本搜索引擎编写测试。如果你继续努力，你会想出一些办法：

*   从一个小的、简化但具有合理代表性的数据样本开始，并测试这样做的基本行为
*   与其断言输出正是某个答案，不如弄清楚它的重要性。例如，对于我们的搜索引擎，我不太关心文档列出的确切顺序，只要三个关键的在结果的第一页。
*   当你做一个小的、增量的改变时，弄清楚它的本质是什么，并为此编写一个测试。尽管整体计算需要许多输入，但对代码库的个别更改应该是可隔离的。例如，我们发现某些文档没有出现，因为某些关键字中存在连字符。我们创建了测试来测试这是否符合我们的预期。
*   看看像 Fitness 这样的工具，它允许你在一段代码中抛出大量数据集，并对结果进行断言。这可能比更传统的单元测试更容易理解。
*   我已经回到产品负责人那里，说“我无法理解这将如何运作。我们怎么知道它是否正确？” 也许她/他可以清楚地阐明定义模糊的问题的本质。这对我来说*非常有效*，而且我已经说服人们放弃功能，因为它们无法解释。
*   要有创意！

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-18T18:05:48.910

最终，你必须决定你的程序应该做什么，然后进行测试。

# perl - 如何下载 Yahoo Groups？

> ID：659434
> 
> 赞同：6
> 
> 时间：2009-03-18T17:58:13.703
> 
> 标签：perl, scripting, download, screen-scraping

我想下载一些雅虎群组（文件、照片、消息、成员列表），我找到了这些脚本：

*   [http://freshmeat.net/projects/grabyahoogroup/](http://freshmeat.net/projects/grabyahoogroup/)
*   [http://sourceforge.net/project/showfiles.php?group_id=62034](http://sourceforge.net/project/showfiles.php?group_id=62034)

我已经从 CPAN 下载了 ActivePerl 和所需的模块（没什么花哨的；它们很容易找到）。我已经设法安装了它们，但是当我运行脚本时，在它告诉我我已成功登录后出现错误：“在 yahoogroups_files.pl 行的模式匹配 (m//) 中使用未初始化的值 $cells 244，第 2 行。”

我猜雅虎改变了页面的布局或其他东西，但我自己无法更新脚本。当谈到 Perl 和了解 Yahoo 生成页面的方式时，我是一个新手，我只知道一些基本的 C++。我想说我并不懒惰，我会尝试自己修复它，但我需要你的帮助：提示，建议，任何东西。

PS：我已经联系了作者，但他不愿意更新脚本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T19:27:15.110

您将需要以下领域的知识：

*   使用 html 解析器

*   http知识（get/post/head）

*   网页抓取

我建议您专注于[WWW::Mechanize](http://search.cpan.org/dist/WWW-Mechanize/)因为它能够完成所有这些事情（以及更多）

编辑：另一种解决方案（不需要编程），是这样的：使用浏览器登录 yahoo 组，存储 cookie，然后运行 ​​wget ，将存储的 cookie 作为参数传递。这样，您将很快完成任务。

在硬盘上找到浏览器的 cookies.txt 文件，然后像这样调用 wget（如果我没记错的话）：

```
wget --load-cookies path_to_cookie_file -r -w 60 网站
```

完整的手册页可以在[这里找到](http://linux.about.com/od/commands/l/blcmdl1_wget.htm)

EDIT2：另一种选择是使用[WebDriver](http://code.google.com/p/webdriver/)来自动化 firefox。您可以使用[本文](http://ssscripting.wordpress.com/2009/02/24/how-to-scrape-data-from-sites-you-cant-log-into/)作为如何完成此操作的指南。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T21:12:14.797

通过文件名，我假设您正在使用此处找到的 Yahoo Group 存档器：http: [//sourceforge.net/projects/grabyahoogroup/](http://sourceforge.net/projects/grabyahoogroup/)

我针对 SubEthaEdit 组运行了文件脚本，效果很好。所有下载的文件都没有发生事故。

查看代码，如果 $cells 为空，则在 while 循环中处理 html 表时似乎会出错。

考虑到代码在我测试时确实有效，因此该组文件的列表可能发生了一些事情。您需要尝试输出 $content 并找出 243 上的正则表达式在何处以及为何无法处理该 html。

编辑：如果您不介意发布正在发生的群组，我相信我自己或这里的其他人可以尝试并自行排除故障。当问题无法复制时，很难确定发生了什么。另外，试试我做的同一个小组，看看它是否适合你。如果可行的话，你正在尝试的小组肯定有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-25T16:00:55.577

Was tinkering on this a while ago to backup my girlfriend's group messages and files from uni. Upon debugging on the latest scripts I've found out that there seems to be a bug on `group_domain` declaration (theres also a group declaration bug that i've found on `yahoo2maildir.pl` of the same project, see `$request`)

```
($group_domain) = $url =~ /\/\/(.*?groups.yahoo.com)\//; 
```

in this case, i've overwritten the $request var under the function `sub download_folder()` with

```
from <br>
$request = GET "http://$group_domain/group/$group/files$sub_folder/";
<br> to <br>
$request = GET "http://**groups.yahoo.com/group/$user_group**/files$sub_folder/"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T16:33:26.490

不知道它是否会对您有所帮助，但这是我为使消息下载工作所做的工作：

```
http://sourceforge.net/forum/forum.php?thread_id=3283915&forum_id=209170 
```

（我只用了message-download，没看file-download）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-27T22:59:53.537

grabyahoogroup 在最新版本中运行良好，可以在 svn repo 中找到：

[http://grabyahoogroup.svn.sourceforge.net/viewvc/grabyahoogroup/trunk/yahoo_group/](http://grabyahoogroup.svn.sourceforge.net/viewvc/grabyahoogroup/trunk/yahoo_group/)

sourceforge.net/projects/grabyahoogroup/files/ 上的版本有错误，对我不起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-23T09:34:31.580

出于原因，截至 2019/09

[https://github.com/csaftoiu/yahoo-groups-backup](https://github.com/csaftoiu/yahoo-groups-backup)

......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-01T15:06:41.207

我一直在寻找一种从 Yahoo Groups 收集消息/对话的工具！我终于找到了**可以转换您的 Yahoo! 的工具。**在努力尝试自己制作并在互联网上到处搜索之后，将**消息分组为 MBOX 格式。**

# 下载工具

以下两个都是 Google Chrome 扩展。

*   由 Sam Hobbs (2015) 发布的[用于下载会员的 Chrome 扩展。](http://yahoogroupedia.pbworks.com/w/page/79909487/Chrome%20Application%20to%20Download%20Members)
*   [用于下载 Mark Fletcher 发布的消息的 Chrome 应用程序](http://yahoogroupedia.pbworks.com/w/page/93006447/Chrome%20Application%20To%20Download%20Messages)（2016 年 1 月）。

# 纯字符串到 Base64 二进制数据

在 2010 年 9 月 16 日之后的某个时间（至少对我而言），检索到的消息不再是纯文本，而是 Base 64 二进制数据 (ASCII)。使用这个[瑞士转换器工具](http://www.percederberg.net/tools/text_converter.html)可以让您按原样读取数据。

### MBOX 格式的示例内容

`VGhlIHF1aWNrIGJyb3duIGZveCBqdW1wcyBvdmVyIHRoZSBsYXp5IGRvZy4=`

### 转换后的示例结果

`The quick brown fox jumps over the lazy dog.`

# sql-server - 在多个位列上创建索引的最佳实践是什么？

> ID：659435
> 
> 赞同：1
> 
> 时间：2009-03-18T17:58:17.243
> 
> 标签：sql-server, sql-server-2005, indexing

再会，

在 SQL Server 2005 中，我有一个表很多列，包括一些布尔（位）列。例如，表“Person”具有列 ID 和列 HasItem1、HasItem2、HasItem3、HasItem4。这个表有点大，所以我想创建索引以获得更快的搜索结果。

我知道在位列上创建索引不是一个好主意，所以我考虑使用包含所有位列的索引。但是，问题是，所有这些位列可能在查询中，也可能不在查询中。由于索引列的顺序在索引中很重要，而且我不知道查询中将使用哪些列，我应该如何处理呢？

顺便说一句，已经有我无法删除的聚集索引。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T18:21:28.530

我建议这可能不是一个好主意。尝试索引具有非常低基数的字段通常不会使查询更快，并且您还需要维护索引的开销。

如果您通常使用另一个字段搜索您的一个位字段，那么这两个字段上的复合索引可能会使您受益。

如果您要在位字段上创建复合索引，那么这将有所帮助，但前提是提供了索引开头的复合字段。如果您没有在复合索引中包含第一个值，那么该索引可能根本不会被使用。

例如，如果在 90% 的查询中使用 bita，在 70% 中使用 bitd，在 20% 中使用 bitb 和 c，那么 (bita, bitd, bitb, bitc) 上的复合索引可能会产生一些好处，但至少对于10% 的查询甚至 40% 的索引很可能不会被使用。

最好的建议可能是尝试使用相同的数据量和数据基数，然后查看执行计划的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T18:22:07.827

我不知道很多关于 sql server 的细节，但通常索引具有非唯一数据的列并不是很有效。在某些 RDBMS 系统中，优化器无论如何都会忽略唯一性低于特定百分比的索引，因此该索引甚至可能不存在。

使用复合索引或多列索引会有所帮助，但仅在过滤器约束与索引的内置顺序相同的特定情况下。如果您的索引包含“field1，field2”并且您正在搜索“field2， field1' 或其他一些组合，则可能不使用索引。您可以为要优化的每个特定搜索案例添加一个索引，这就是我能想到的所有事情。如果您的数据不是很独特，即使在考虑了所有位字段之后，索引也可能被忽略。

例如，如果您有 3 个位字段，则您只是将数据分成 8 个不同的组。如果表中有合理数量的行，将其分段为 8 不会非常有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T18:34:10.027

我不知道 2005，但在 SQL Server 2000 中（来自联机丛书）：“位类型的列上不能有索引。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:12:53.243

如何使用校验和？

将一个名为 mysum 的 int 字段添加到您的表中并执行此操作

```
UPDATE checksumtest SET mysum = CHECKSUM(hasitem1,hasitem2,hasitem3,hasitem4) 
```

现在你有了一个代表位组合的值。

在搜索查询中执行相同的校验和计算并匹配 mysum。

这可能会加快速度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T02:35:18.747

您应该重新审视数据库的设计。您应该创建一个桥实体和一个主 Items 表（如果没有的话），而不是创建一个包含字段 HasItem1 到 HasItem# 的表。桥实体（表）person_items 将具有（至少）两个字段：`person_id and item_`id。

以这种方式设计数据库不会将您锁定在仅根据列定义处理*N个项目的数据库中。*您可以将任意数量的项目添加到主项目表中，并将所需数量的项目与所需数量的人关联起来。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T00:08:46.890

奇怪的是，SQL 用 person_id 和 item_id 和 BitValue 查询大表会更容易，然后用 Item1, Item2, ... Item *N*搜索单个表会更容易。

# php - 我应该通过 BrainBench 设计模式认证吗？

> ID：659443
> 
> 赞同：2
> 
> 时间：2009-03-18T18:01:49.980
> 
> 标签：php, design-patterns

我在 Brainbehch 找到了[设计模式认证](http://www.brainbench.com/xml/bb/common/testcenter/taketest.xml?testId=426)。

我从通过它的人那里听说，有许多特定于语言的模式问题，主要来自 Java 和 C++。

我认为这个认证可以：

*   强迫我提高我在面向对象设计和设计模式方面的技能；
*   改进和构建我对该领域的知识；
*   对我的知识给出真实的估计，这本身就是有用的问题

我对这个认证的唯一困惑是我必须学习 C++/Java 语言特定的设计模式，而我主要做 PHP 开发并且不想切换到 C++/Java。

我熟悉 Java 和 C++ 语法，阅读了很多关于不同主题的书籍以及这种编程语言的代码片段。

我认为，如果我在认证时通过了除语言特定模式之外的所有概念，那将不是很好，因为这些概念将获得相当低的结果。

在这种特殊情况下，您会推荐什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-18T18:06:14.400

这是个人观点，但是在设计模式之类的东西中获得“认证”有点像获得“认证”你是一名职业篮球运动员。如果你有资格，没有证书就很明显，如果你没有经验，你无论如何也拿不到证书。

**理解设计模式的最佳方式是获得真正的实践经验，了解它们何时适用，何时不适用。**唉，如果不从事真正的软件项目，您将无法做到这一点。如果您觉得您的常规工作无法提供足够的技术挑战以使其可行，请考虑加入开源项目或开始您自己的项目。

当人们建议您使用特定的设计模式时，通常会尝试将方形钉安装到圆孔中。您需要一定程度的经验和能力来评估它们是否正确。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-27T11:59:10.443

认证的目的是验证您是否具备知识和技能。

在我看来，brainbench 在其他与语言无关的学科中添加语言特定测试的测试时犯了一个错误。

虽然我是 C++ 专家，但我在 Java 方面的经验有限。我参加了这个 OO 设计模式测试，发现 40 个问题中有 13 个是关于特定于 java 的模式（我显然从未使用过）。那是 1/3 的问题是针对单一语言的！（还有 1 个关于 C++ 语言特定模式的问题）。在我看来，特定于 java 的问题应该在特定于 java 的测试中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T18:26:50.293

我真的同意约翰关于认证的“有用性”的观点，但如果你尝试，它肯定不会让你成为更差的程序员。

不要太在意偏离php太多。首先，当然，php 与 java 和 c++ 非常相似，但设计模式总是很值得了解。即使是特定语言的人；他们将使您对语言和设计过程有更好的理解，这反过来将使您成为更好的程序员。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-21T09:10:58.163

设计模式有两个主要好处。首先，它们为您提供了一种使用经过验证的解决方案来解决与软件开发相关的问题的方法。该解决方案有助于以最小的耦合开发高度内聚的模块。它们隔离了系统需求中可能存在的可变性，使整个系统更易于理解和维护。其次，设计模式让设计师之间的沟通更加高效。

如果这个认证可以迫使你去学习它们或者可以激发你的动力，我认为这个认证对你很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T18:31:03.810

如果它花费你任何钱做 - 那么不。我不认为他们值得他们写在纸上。

# asp.net-mvc - Subsonic 类在 ASP.NET MVC 项目中放在哪里？

> ID：659444
> 
> 赞同：2
> 
> 时间：2009-03-18T18:01:56.890
> 
> 标签：asp.net-mvc, subsonic

我过去构建过 ASP.NET webform 项目，在生成 Subsonic 类时，我所在的团队将我们的业务层/DAL 对象放入 Project.Framework 项目中。

这仍然是推荐的结构，还是应该将 Subsonic 类直接放入 MVC Web 项目中的 /Model 文件夹？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T01:00:06.340

它不应该放在 Model 文件夹中（我认为 Model 文件夹应该只用于仅用于视图的类，并且不会在应用程序的其余部分中使用）。

它应该进入一个单独的程序集可能是**Project.Core**或**Project.Data**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T18:06:38.533

我不会将 Subsonic 类直接放在 MVC 项目中。由于您没有使用 ASP.NET，因此现在没有理由进行更改。

我什至不会将控制器留在 MVC Web 项目中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T22:30:45.480

您*可以*将它们放入模型中，稍后将它们移动到自己的项目中，但现在将它们放入自己的项目中并没有更多的工作，所以我会这样做。

# php - php中有哪些好的分布式队列管理器？

> ID：659455
> 
> 赞同：10
> 
> 时间：2009-03-18T18:05:53.527
> 
> 标签：php, queue, distributed

我正在一个图像处理网站上工作，而不是让冗长的工作阻止用户浏览器，我希望所有命令都能快速返回一个工作 ID，并让后台任务完成实际工作。然后可以使用 id 来检查状态和结果（即处理图像的 url）。我找到了很多用于 ruby​​、java 和 python 的分布式队列管理器，但我对这些语言的了解还不够多，无法使用它们。

我自己的测试是使用共享 mysql 数据库对作业进行排队，将它们锁定到工作人员，并将它们标记为已完成（将返回数据保存在数据库中）。这只是一个凌乱的原型，整个过程我都觉得自己好像在重新发明轮子（而且不是很优雅）。php 中是否存在我可以使用的东西（或者我可以与 RESTfully 交谈？）？

阅读更多，我发现我正在寻找的是一个具有 php api 的排队系统，它不必用 php.ini 编写。我只找到了与 Amazon 的 SQS 一起使用的类，但这不仅不是免费的，而且有时还很隐蔽（超过一分钟才能显示一条消息）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T18:54:39.807

你试过 ActiveMQ 吗？它提到通过 Stomp 协议支持 PHP。详细信息可在[activemq 站点上](http://activemq.apache.org/cross-language-clients.html)找到。

我已经从您描述的数据库方法中获得了很多里程，所以我不会太担心。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T18:44:44.417

你对服务器有完全的控制权吗？

在这种情况下，MySQL 队列可能会很好。有一个不断运行的 PHP 脚本（在无限的 while 循环中），查询 MySQL 数据库中的新“任务”并在其间进行 sleep() 以减少空闲时间的负载。

当每个任务完成后，在数据库中标记它并移动到下一个。

为了防止脚本崩溃/存在（PHP 内存溢出等）时整个事情停止，例如，您可以将它放在[inittab](http://en.wikipedia.org/wiki/Init)中（如果您使用 Linux 作为服务器），init 将自动重新启动它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T01:52:14.080

Zend_Framework 有一个队列类，有许多 Mysql-backed、SQS 和其他一些后端的实现。

就个人而言，我最近在[BeanstalkD](http://xph.us/software/beanstalkd/)上取得了出色的成绩，它也有一个 PHP 客户端。我只是用 JSON 序列化一些数据以投入其中，这些数据会被解码并在工作人员上运行。

# windows - 是什么导致 xcopy 告诉我访问被拒绝？

> ID：659463
> 
> 赞同：21
> 
> 时间：2009-03-18T18:07:11.543
> 
> 标签：windows, cmd, xcopy

我们其中一个解决方案的构建后任务使用 xcopy 将文件移动到构建工件的公共目录中。出于某种原因，在我的计算机上（以及我测试的 VM 上），xcopy 失败并显示“拒绝访问”。这是我为尝试隔离问题所做的工作：

*   我尝试了普通副本；这行得通。
*   我仔细检查了所有有问题的文件都不是只读的。
*   我检查了源文件夹和目标文件夹的权限；我对两者都有完全的控制权。
*   我尝试从命令行调用 xcopy，以防 VS 构建过程锁定了文件。
*   我使用 Unlocker 和 Process Explorer 确定源文件上没有锁。

除了涉及计算机的偏执阴谋论来抓我之外，我错过了什么？这发生在我的开发机器和干净的 VM 上，但*不会*发生在项目中的其他任何人身上。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-07-23T14:17:35.860

> /r = 使用此选项覆盖目标中的只读文件。如果您在要覆盖目标中的只读文件时不使用此选项，系统将提示您“拒绝访问”消息，并且 xcopy 命令将停止运行。

这是我对这个错误的解决方案。

[来源](http://pcsupport.about.com/od/commandlinereference/p/xcopy-command.htm)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-18T19:48:13.080

问题解决了; 有两块拼图。

/O 开关需要在 Vista 上提升。此外，我注意到 xcopy 在 Vista 中已被弃用，取而代之的是 robocopy。现在我正在和我们的构建工程师讨论这个问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-05-12T00:29:40.267

您需要以管理员身份运行 XCOPY，没有办法解决这个问题。

如果您不想以管理员身份运行副本，则必须改用[ROBOCOPY](http://en.wikipedia.org/wiki/Robocopy)。

但是请注意，使用 ROBOCOPY 时使用该`/COPYALL`开关非常诱人，该开关也会复制审核信息并需要“管理审核用户权限”，这再次邀请您以管理员身份运行作为快速解决方案。如果您不想以管理员身份运行副本，**请不要使用**（`/COPYALL`或 `/Copy:DATSOU`）开关。而是使用`/Copy:DATSO`, 因为 U 代表审计。

另请注意，如果您从 NTFS 复制到 FAT 文件系统，则无法“将 NTFS 安全性复制到目标目录/文件”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T18:13:17.723

通常发生这种情况是因为有另一个进程锁定了文件。我敢打赌，您的机器与其他机器具有不同数量的内核/不同的速度。尝试插入一些睡眠，看看它是否能解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-05T21:50:36.393

如果您可以在 Windows 资源管理器中删除该文件，请尝试使用提升的命令提示符。不知道为什么 Windows 资源管理器不在这里请求权限，以通过 cmd 进行需要管理员权限的删除操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-02T06:05:43.193

如果要将文件复制到 IIS 文件夹，则需要以管理员身份运行批处理文件。

# asp.net-mvc - 使用 IIS 6.0 路由到 mvc asp.net 中的空白请求

> ID：659465
> 
> 赞同：0
> 
> 时间：2009-03-18T18:07:26.677
> 
> 标签：asp.net-mvc, authentication, iis-6, routing

我正在尝试使用以下 url 连接到我发布的网站。 [http://www.mywebsite.com/](http://www.mywebsite.com/) 我不断收到：传入的请求与任何路由都不匹配。这是我的路由规则：

```
routes.MapRoute(
                "Default",                                              // Route name
                "{controller}.aspx/{action}/{id}",                           // URL with parameters
                new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
            );

            routes.MapRoute(
                "Default2",                                              // Route name
                "/",                           // URL with parameters
                new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
            ); 
```

我正在使用身份验证：

```
<authentication mode="Forms" >
            <forms loginUrl="~/Home.aspx/Index"
                    protection="All"
                    timeout="300"/>
        </authentication> 
```

当我没有通过身份验证时，它会转到正确的页面，但是当我通过身份验证时，它会引发上述错误。我正在使用 IIS 6.0 并执行整个重写 url 解决方法选项。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T20:10:11.717

`"/"`将“Default2”路由更改为`""`：

```
routes.MapRoute("Default2", "", new { ... }); 
```

如果您在 IIS6 上，还请确保您已遵循本指南：[http](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx) : //haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx文件。`Default.aspx`

# svn - 如何将 SVN diff 应用于 Git？

> ID：659467
> 
> 赞同：53
> 
> 时间：2009-03-18T18:07:37.033
> 
> 标签：svn, git, version-control, patch

我的项目在 2 个存储库中。一个在 SVN 下，一个在 Git 下。每当我在 SVN 中更改某些内容时，我都想对 Git 存储库做同样的事情。

假设我对 SVN 存储库进行了更改，生成了修订版 125。我将如何将这些相同的更改应用到我的 Git 存储库（假设我的 Git 存储库是最新的修订版 124）。

谢谢你。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-03-18T18:17:49.647

我实际上做了/寻找的是：

```
cd /path/to/svn/repo
svn diff -r 125 > /tmp/patch.diff
cd /path/to/git/repo
patch -p0 < /tmp/patch.diff 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-18T18:13:07.270

尝试：

```
svn diff | patch -d /path/to/git/repo -p0 
```

查看`svn help diff`是否要导出特定修订的差异。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-07-29T10:44:54.197

如果您要在 SVN 中生成补丁并稍后使用 Git 应用它，请不要忘记使用[`--git`命令行选项](http://svnbook.red-bean.com/en/1.8/svn.ref.svn.html#svn.ref.svn.sw.git)：

> `--git`
> 
> 为 svn diff 启用特殊输出模式，旨在与流行的 Git 分布式版本控制系统交叉兼容。

例如，运行

`svn diff --git -r 125 > /tmp/patch.diff`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-03-16T15:32:08.050

为什么没有人喜欢 git-svn？我不能假设没有人知道这件事。

有 git-svn（以及 git-hg 和 git-cvs 和 git-bzr afaict）。至少使用 git-svn 你可以简单地做

```
git svn clone --stdlayout http://myrepo/root here 
```

使用 -s ( `--stdlayout`) 假定标准主干/分支/标签/布局，但您可以使用任何方式 ( `man git-svn`)。

映射是双向的，因此您可以像使用本机 (git) 远程一样进行推送和拉取。无话可问。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-21T12:12:08.167

除了使用上面提到的补丁之外，您还可以考虑设置一个[提交后挂钩](http://svnbook.red-bean.com/en/1.4/svn.ref.reposhooks.post-commit.html)，这样您就不必在每次提交新内容时都这样做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-29T09:16:49.907

以下对我有用。

资料来源：[如何使用 Git 创建和应用补丁](https://ariejan.net/2009/10/26/how-to-create-and-apply-a-patch-with-git/)

**首先，看看补丁有哪些变化**。您可以使用 git apply 轻松完成此操作

```
git apply --stat fix_empty_poster.patch 
```

请注意，此命令**不会**应用补丁，而只会显示有关它将做什么的统计信息。使用您喜欢的编辑器查看补丁文件后，您可以看到实际的更改。

**接下来，您对补丁会有多麻烦感兴趣**。Git 允许您在实际应用补丁之前对其进行测试。

```
git apply --check fix_empty_poster.patch 
```

**如果您没有收到任何错误，则可以干净地应用补丁**。否则你可能会看到你会遇到什么麻烦。

为了应用补丁，我将使用 git am 而不是 git apply。这样做的原因是 git am 允许您签署已应用的补丁。这可能对以后的参考有用。

```
git am --signoff < fix_empty_poster.patch

Applying: Added specs to test empty poster URL behaviour
Applying: Added poster URL as part of cli output 
```

好的，补丁已干净应用，您的主分支已更新。当然，再次运行测试以确保没有损坏。

*在你的 git log 中，你会发现提交消息包含一个“Signed-off-by”标签。Github 和其他人将读取此标签，以提供有关提交如何在代码中结束的有用信息。*

# pixel-bender - 像素弯曲器白色到透明

> ID：659476
> 
> 赞同：1
> 
> 时间：2009-03-18T18:11:21.050
> 
> 标签：pixel-bender

当我运行以下像素弯曲代码时：

```
input image4 src;
output float4 dst;

// How close of a match you want
parameter float threshold
<
  minValue:     0.0;
  maxValue:     1.0;
  defaultValue: 0.4;
>;

// Color you are matching against.
parameter float3 color
<
  defaultValue: float3(1.0, 1.0, 1.0);
>;

void evaluatePixel()
{
  float4 current = sampleNearest(src, outCoord());
  dst = float4((distance(current.rgb, color) < threshold) ? 0.0 : current);
} 
```

我收到以下错误消息：

错误：（第 21 行）：':'：错误的操作数类型不存在操作':'，它采用'const float' 类型的左操作数和'4-component vector of float' 类型的右操作数（或有是不可接受的转换）

请指教

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T18:17:55.840

从错误消息中，我觉得 Pixel Bender 不支持三元 (?:) 运算符。将其扩展为 if 语句：

```
if (distance(current.rgb, color) < threshold)
    dst = float4(0.0);
else
    dst = float4(current); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T18:20:57.203

我不熟悉 Pixel Bender，但我猜问题是三元`?:`运算符的最后两个参数必须是相同的类型：

```
A = condition ? B : C 
```

`B`并且`C`必须具有相同的类型，该类型必须与`A`. 在这种情况下，看起来您正在尝试制作`float4`s，因此您应该这样做：

```
dst = (distance(current.rgb, color) < threshold) ? float4(0.0) : current; 
```

这样最后两个参数 (`float4(0.0)`和`current`) 都具有 type `float4`。

# java - 谁有用于在 OS X 下构建 Eclipse 3.5M6 的功能性 build.properties 文件？

> ID：659479
> 
> 赞同：0
> 
> 时间：2009-03-18T18:12:13.527
> 
> 标签：java, eclipse, macos

我想尝试修改 Eclipse 标准功能，所以我想在 OS X 10.5 下构建 Eclipse。我已经下载了源码包，解压后发现我需要填写一个 build.properties 文件，我已经这样做了（Java 6 作为默认的 JVM）

```
J2SE-1.4=/System/Library/Frameworks/JavaVM.framework/Versions/1.4/
J2SE-1.5=/System/Library/Frameworks/JavaVM.framework/Versions/1.5/
JavaSE-1.6=/Library/Java/Home/ 
```

然后调用它

```
./build -os macosx -ws cocoa -arch x86 
```

它构建了 ecj.jar 并调用了 ant，然后该 ant 失败并出现来自 javac 任务的数千条错误消息。最能说明问题的是

```
 [javac] The type java.lang.Object cannot be resolved. It is indirectly referenced from required .class files 
```

因为它对我来说清楚地表明没有正确选择适当的库。

有没有人可以帮助 OS X 的功能性 build.properties 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T20:28:35.327

这些属性需要指定用于该环境的实际引导类路径。仅指向 jre 的根目录是不够的，您需要列出实际的 *.jar 文件。

例子：

```
J2SE-1.5=/System/Library/Frameworks/JavaVM.framework/Versions/1.5/Classes/classes.jar:\
/System/Library/Frameworks/JavaVM.framework/Versions/1.5/Classes/jsse.jar:\
/System/Library/Frameworks/JavaVM.framework/Versions/1.5/Classes/charsets.jar 
```

# c# - Linq To Sql - 未引发 ChangeConflictException。为什么？

> ID：659485
> 
> 赞同：0
> 
> 时间：2009-03-18T18:12:58.533
> 
> 标签：c#, .net, database, linq, linq-to-sql

我试图通过更改两个不同浏览器中的记录来强制发生 ChangeConflictException。这在过去对我有用。但现在它只是不会抛出异常。

最后一位获胜。

我已经检查了我正在更新的实体的列属性，并且每列都设置为始终检查。

有什么我可以寻找的吗？

我没有扩展这个数据上下文或对任何属性进行任何修改。

谢谢。

# 编辑

这是一个 ASP.net 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T18:42:21.740

你确定这不是正在发生的事情：

1.  浏览器 A 加载实体 X
2.  浏览器 B 加载实体 X
3.  浏览器 A 提交表单
4.  浏览器 A 再次加载实体 X，更改属性并再次存储
5.  浏览器 B 提交表单
6.  浏览器 B 再次加载实体 X，更改属性并再次存储

这里的关键点是实体在回发时重新加载（HTTP = 无状态），并且在 6）中您实际上正在加载 4）所做的更改并覆盖它们。Linq2Sql 不会“标记”您的表单，您必须手动执行此操作。

您在评论中写道您有另一个可以运行的应用程序。如果那是一个 Windows 应用程序，那么情况就完全不同了，因为该实体很可能不会再次重新加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T18:16:56.277

这是一个竞赛条件。考虑您可能正在检索信息、更新并发送到数据库。如果第一个将更改提交到数据库，则在第二个检索信息之前，您不会遇到冲突。

**更新：**关于无法做到这一点的评论。您可以这样做，您使用 Attach 方法，但您需要保留任何您希望它检查并发性的原始值。检查这些：

[linq2sql-update-object-not-created-in-datacontext](https://stackoverflow.com/questions/371439/linq2sql-update-object-not-created-in-datacontext)

[如何在不加载整个行的情况下更新 linq 中的单列](https://stackoverflow.com/questions/221475/how-to-update-a-single-column-in-linq-without-loading-the-entire-row)

这肯定是 linq 数据源下正在发生的事情。

# concurrency - 悲观与乐观并发（锁定与反馈）

> ID：659489
> 
> 赞同：6
> 
> 时间：2009-03-18T18:13:37.003
> 
> 标签：concurrency, locking, editing, multi-user

我正在使用以下标准构建应用程序：

*   工作项目：需要用户通过网络手动工作的项目（短一页表格）
*   多个用户工作“工作项”
*   每个用户都有一个“工作项”队列
*   有一个搜索允许用户查看“工作项”并将“工作项”分配给他们的队列
*   用户可以将“工作项”从其他人的队列中分配给自己

**注意：“工作项”只工作一次。这不是一个 wiki 页面，它更像是一个匹配的练习，只能由一个用户执行一次。一旦“工作项”工作完成，它就会从系统中消失（除了一些审计/报告），有点像错误跟踪系统**

你认为哪个选项更好？你能引用任何支持你观点的主流应用程序吗？

选项1：

*   当用户 A 去查看或工作“工作项”时，“工作项”被锁定。
*   当用户 A 打开“工作项”后，其他用户进入“工作项”时，他们将只能看到“工作项”。他们不能写。
*   锁定在 n 分钟后到期，此时另一个用户可以锁定“工作项”。

选项 2：

*   任何用户都可以在不锁定的情况下拉起“工作项”。
*   如果用户 A 通过提交表单来处理“工作项”而用户 B 处理相同的“工作项”，则用户 A 的工作将在数据库中生效，并且用户 B 将被告知他们的更改没有生效，因为另一个用户已修改“工作项”。

我个人喜欢选项 2。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-18T18:23:10.803

听起来你在谈论[悲观](http://en.wikipedia.org/wiki/Concurrency_control)的诗句[乐观](http://en.wikipedia.org/wiki/Optimistic_concurrency_control)的并发控制。

两者都被广泛使用，我个人觉得乐观并发更容易处理，但这取决于您自己的要求和使用情况。如果编辑（和潜在的冲突）很常见，那么悲观并发控制可能是合适的，如果不是，那么乐观并发将更快更简单地使用。

如果您想在 SQL Server 中查看使用[RowVersion](http://msdn.microsoft.com/en-us/library/ms182776.aspx)数据类型的代码示例（这就是我目前正在使用的），请告诉我，不过这很简单：

*   所有表都包含 RowVersion 列
*   所有 SELECT 查询都包含此列（用于可以修改的数据）
*   所有 UPDATE 或 DELETE 查询都包含 WHERE RowVersion = @RowVersion。这是乐观的部分，如果返回 0 行，那么其他人已经触及了该行，不会发生更新，所以告诉用户。注意：如果行已更新，则还应返回 RowVersion 的新值。这也适用于 INSERT 查询，就像您在插入后返回标识列的 Id 一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T18:26:21.387

> 不知道如何用简单的术语来描述表单，但它不是社区页面，它是一次性的。假设，假设用户必须将名称 John DOEE 与以下 John Doe Jon Do 之一匹配。一旦成功，编辑就完成了。在我们的例子中，我们不需要仅仅

考虑到该评论，我会选择选项 1。考虑到这些更改是一次性更改，允许多人进行同一个更改没有任何好处。你只是在浪费第二个人的时间。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-18T18:17:22.423

我个人会选择选项 2 - 另外，如果适用（例如，这些编辑在较长的文本上），则用户 B 有责任合并编辑。给 B 一个这样做的工具。

# filter - 有没有办法查看我在fogbugz工作过的所有案例

> ID：659493
> 
> 赞同：6
> 
> 时间：2009-03-18T18:15:15.893
> 
> 标签：filter, filtering, case, fogbugz

假设我们有以下情况：

1.  Jen Ninja（姓氏很棒的开发人员）喜欢查看以下列表视图过滤器：

    分配给 Jen Ninja 且状态为 Active 的所有未决案例

2.  Jen Ninja 被分配了一堆案例（其中一些是错误，其中一些是功能）。

3.  Jen 看着她的过滤列表并看到它们。没问题。

4.  Jen Ninja 敲定了她所有的案例，然后将它们分配给各种 QA 人员。

5.  发布前两天，Jen 的老板在这里问“你做过的所有事情是什么？”

6.  Jen 的记忆力不错，但看到 Fogbugz 说她在做什么会更舒服。

Jen 如何更改她的过滤器，以便她可以自信地回答这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T18:31:03.547

这出乎意料地困难。按名称搜索不起作用，因为“分配给”和“解决者”等项目不会被搜索，即使当您在屏幕上显示案例时也会显示它们。通常，我（作为开发人员）在每个 FogBugz 案例中都被列为“解决者”，所以我最接近的是对我被列为解决者的所有案例（打开和关闭）进行搜索。在单独的搜索中，我会查找我关闭它的所有 Closed 案例（你不能同时进行 Resolved 和 Closed ，否则你只会得到我同时 Resolved 和 Closed 的案例）。

我认为在 FogBugz 中让这一切*变得简单*的唯一方法是让 Jen“订阅”她处理的每个案例。如果她这样做，那么很容易生成列表：只需显示她订阅的所有案例。

乔尔有时会经常光顾这些部分，所以也许你会让他发表评论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-06T16:37:43.143

您可以使用自定义搜索语法来创建自定义过滤器

```
 editedby:me OR assignedto:me 
```

我将此与活动状态相结合，以查找我之前编辑或已分配给我的任何活动案例。

请参阅[FogBugz 帮助](http://help.fogcreek.com/7480/search-syntax-and-the-search-axis?se_found=1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T18:50:10.147

您可以通过选择过滤器->特殊->查看者->我并将其与分配给->我组合并确保将案例设置为全部来获得所需的内容。

# winforms - 表单数据绑定 - 数据集未更新？

> ID：659502
> 
> 赞同：0
> 
> 时间：2009-03-18T18:17:52.937
> 
> 标签：winforms, data-binding, dataset, bindingsource, tableadapter

我有一个表单（实际上是紧凑框架），其中包含几个字段、一个日期和一个字符串等。两个 TextBox 控件都绑定到 BindindSource 中的属性。

BindindSource 有一个 DataSet 作为其 DataSource 属性，而 DataMember 是 SQL CE 数据库中的一个表。

当我想添加一个新行时，我调用 bindingSource.AddNew()，然后调用 bindingSource.MoveLast()。表单显示默认值（在 DataSet 中定义），我可以编辑所有字段。

为了保存表单，我调用 bindingSource.EndEdit() 并使用 TableAdapter 方法将 DataSet 行中的值插入到数据库中。日期进入数据库，字符串没有。相反，保存的是字符串的默认值，而不是我在文本框中键入的值。

当我在调用 EndEdit() 后检查 DataSet 表行中的数据时，日期字段会使用表单中的数据进行更新，而字符串则不会。

奇怪的是，当我使用相同的表单（不调用 AddNew）编辑现有行时，字符串字段被更新并保持得很好。所以这只发生在对 BindingSource 调用 AddNew() 之后。我错过了什么？我应该从哪里开始寻找？

不幸的是，代码有点太多，无法在此处发布。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T18:41:35.347

我发现了问题 - 我不小心在 BindingSource 中为 TextBox 的 Tag 和 Text 属性选择了同一列。我认为发生的事情是先写回文本，然后再写回标签，并且由于标签没有更新，它覆盖了修改后的值。

# sql - 有没有一种简单的方法来查询节点的子节点？

> ID：659504
> 
> 赞同：9
> 
> 时间：2009-03-18T18:18:00.270
> 
> 标签：sql, tree, nested-set-model

我最近一直在使用[嵌套集模型](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)中的废话。我喜欢为几乎所有有用的操作和视图设计查询。我坚持的一件事是如何选择节点的直接子代（并且*只有*子代，而不是进一步的后代！）。

老实说，我确实知道一种方法 - 但它涉及无法管理的 SQL 数量。我确信有一个更直接的解决方案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-18T18:39:53.367

你读过你发的文章吗？它在“查找节点的直接下属”标题下

```
SELECT node.name, (COUNT(parent.name) - (sub_tree.depth + 1)) AS depth
FROM nested_category AS node,
    nested_category AS parent,
    nested_category AS sub_parent,
    (
        SELECT node.name, (COUNT(parent.name) - 1) AS depth
        FROM nested_category AS node,
        nested_category AS parent
        WHERE node.lft BETWEEN parent.lft AND parent.rgt
        AND node.name = 'PORTABLE ELECTRONICS'
        GROUP BY node.name
        ORDER BY node.lft
    )AS sub_tree
WHERE node.lft BETWEEN parent.lft AND parent.rgt
    AND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt
    AND sub_parent.name = sub_tree.name
GROUP BY node.name
HAVING depth <= 1
ORDER BY node.lft; 
```

但是，我所做的（这是作弊）是将嵌套集与邻接列表结合在一起——我在表中嵌入了一个“parent_id”，因此我可以轻松地询问节点的子节点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T09:40:00.007

在我看来，如果没有子查询或父列冗余，这应该很容易实现！例如，给定父母的左右是已知的：

```
SELECT child.id
FROM nodes AS child
LEFT JOIN nodes AS ancestor ON
    ancestor.left BETWEEN @parentleft+1 AND @parentright-1 AND
    child.left BETWEEN ancestor.left+1 AND ancestor.right-1
WHERE
    child.left BETWEEN @parentleft+1 AND @parentright-1 AND
    ancestor.id IS NULL 
```

也就是说，“从相关节点的所有后代中，选择它们与节点之间没有祖先的节点”。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-01-15T15:51:35.233

**这个更好更小**

用户“bobince”几乎拥有它。我想通了并让它为我工作，因为我比大多数人有更多的 MySQL 经验。但是，我明白为什么 bobince 的回答可能会吓跑人们。他的询问不完整。您需要先将 parent_left 和 parent_right 选择到 mysql 变量中。

下面的两个查询假定您的表已命名`tree`，您的左列已命名`lft`，右列已命名`rgt`，并且您的主键已命名`id`。更改这些值以满足您的需要。此外，检查第一个 select 语句。您会看到我正在查找节点 5 的直接后代。更改数字 5 以查找您想要的任何节点的子节点。

我个人认为这是一个比迄今为止提出的其他查询更时尚、更性感、更有效的查询。

```
SELECT `lft`, `rgt` INTO @parent_left, @parent_right FROM efm_files WHERE `id` = 5;
SELECT `child`.`id`
FROM `tree` AS `child`
LEFT JOIN `tree` AS `ancestor` ON
    `ancestor`.`lft` BETWEEN @parent_left+1 AND @parent_right-1 AND
    `child`.`lft` BETWEEN `ancestor`.`lft`+1 AND `ancestor`.`rgt`-1
WHERE
    `child`.`lft` BETWEEN @parent_left+1 AND @parent_right-1 AND
    `ancestor`.`id` IS NULL 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-01T03:33:01.910

我知道我在做一个死灵帖子，但这是我的看法。

为什么不在嵌套集中包含“深度”列？深度列将指示项目的“级别”。

因此，要选择项目的直接子项，只需执行

`select c.*
from tree as p
join tree as c on (c.left > p.left and c.right < p.right and c.depth = p.dept + 1) where p.id = @parentID`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-09T07:54:36.653

我也会选择深度专栏。但是使用

```
SELECT Child.Node, Child.LEFT, Child.RIGHT
FROM Tree AS Child, Tree AS Parent
WHERE
        Child.Depth = Parent.Depth + 1
        AND Child.LEFT > Parent.LEFT
        AND Child.RIGHT < Parent.RIGHT
        AND Parent.LEFT = 1  -- Given Parent Node Left Index 
```

[维基百科](http://en.wikipedia.org/wiki/Nested_set_model#Variations)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-01T01:41:30.730

我发现[Wikipedia 链接](http://en.wikipedia.org/wiki/Nested_set_model)具有很好的最小化答案版本以及选定的答案。

```
SELECT DISTINCT Child.Name
FROM ModelTable AS Child, ModelTable AS Parent 
WHERE Parent.Lft < Child.Lft AND Parent.Rgt > Child.Rgt  -- associate Child Nodes with ancestors
GROUP BY Child.Name
HAVING MAX(Parent.Lft) = @parentId  -- Subset for those with the given Parent Node as the nearest ancestor 
```

而且，你们中的任何人都尝试用 Linq 来表达它，请点击链接：[https ://stackoverflow.com/a/25594386/361100](https://stackoverflow.com/a/25594386/361100)

# winforms - 是什么导致一个窗口直到在 Vista 中按 Alt-Tabbed 才能出现在任务栏中？

> ID：659506
> 
> 赞同：7
> 
> 时间：2009-03-18T18:19:03.543
> 
> 标签：winforms, windows-vista, taskbar

当我们的应用程序在 Windows Vista 中以编程方式启动（通过 MSI 安装程序中的自定义操作或启动新实例时）时（也发生在 Windows 7 Beta 中），它不会出现在任务栏中并且没有焦点。Alt-tab 键将使其正确显示在任务栏中并留在那里。

这是什么原因造成的？我之前在其他一些应用程序中也看到过这种情况，但不知道为什么。Out 应用程序是 .NET WinForms 应用程序。从来没有在 XP 中看到过这种情况，只有 Vista 和 7

编辑：好吧，这似乎是唯一一次可重复发生的情况是当它由安装程序运行时，我相信它还会发生其他时间，但我可能只是疯了。发布代码有点复杂，因为我们处理各种命令行启动参数，它会在实际启动主应用程序之前启动一个登录表单等。

有没有人必须处理过这种情况并解决了这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T12:58:49.803

尝试检查您的主申请表“表单边框”属性。如果它是 ToolWindow（Fixed 或 Sizable），请尝试将其更改为 FixedDialog 例如。这解决了我的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-03T22:28:54.320

G.So 的回答让我找到了解决问题的方法，这是因为我的表单从启动时就相当大，但在加载无效时设置为无边界。

如果有人对我如何设法将开关保持在无边界状态并让它在任务栏中弹出而没有任何肮脏的黑客行为感兴趣..这里是..

在表单的“显示”事件上从表单中创建一个新事件，并将用于切换到无边框的代码行放在这里。问题解决了 ：）

```
 private void Form1_Shown(object sender, EventArgs e)
    {
         this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.None;
    }

    and for the lazy ones ;) >>>>

    this.Shown += new EventHandler(Form1_Shown); 
```

再次感谢 G.So 首先清除可能导致此问题的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-28T23:00:24.630

通常的原因是您的主应用程序窗口没有让 Windows 知道它是主应用程序窗口（而不是工具窗口或对话框）的窗口样式。因此，Windows 必须根据应用程序的启动方式等进行猜测。

如果您的窗口与其他不存在此问题的窗口的窗口样式，请使用 Spy++ 比较窗口样式（尤其是扩展样式）。你错过了`WS_EX_APPWINDOW`风格吗？是否有任何其他样式/扩展样式与其他顶级窗口不同？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-29T19:15:03.517

我也纠结于这个问题，发现就像之前的评论者所说，表单的 Load() 事件中不能有任何改变 FormBorderStyle 属性的东西。将任何改变它的东西移动到 Shown() 事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T18:21:28.373

> 从来没有在 XP 中看到过这种情况，只有 Vista 和 7

也许这是Vista中的一个错误......？

如果您调用 SetForegroundWindow()（或 .Net 中的等价物）会发生什么？

**编辑**

我的意思当然是“BringWindowToTop()”。

或者两者都做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T18:49:55.310

好吧，一种解决方案是使用这样的[hack](http://www.vbaccelerator.com/home/VB/Code/Libraries/Windows/Forcing_a_Window_to_Show_in_the_TaskBar/article.asp)。这真的不是它的目的。

通常，窗口是否在任务栏中的决定取决于它使用的边框样式。我链接到的文章提供了更多细节。文章关于窗口是否拥有所有者的评论很可能与您的问题高度相关，因为当安装程序启动时，窗口可能会以某种方式获得不同的所有者。

那篇文章是用 VB 编写的，但它都基于 API 调用，因此它提供的信息与语言无关。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-03T08:56:41.693

我们遇到了同样的问题，并通过将表单属性 showintaskbar 属性设置为 true 来修复它。

奇怪的是所有 Windows 操作系统的运行应用程序的方式都不相同！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-11T07:47:22.867

我们在 Windows 8 中也遇到了同样的问题。有时表单正确接收焦点，但只有大约 30% 的时间。

我们尝试了不同的解决方案，但实际上可行的解决方案如下：

```
private void OnFormShown(object sender, EventArgs e)
{
    // Tell Windows that the Form is a main application window
    this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;

    // Even if true, enforce the fact that we will the application on the taskbar
    this.ShowInTaskbar = true;

    // Put the window to the front and than back
    this.BringToFront();
    this.TopMost = true;
    this.TopMost = false;

    // 'Steal' the focus.
    this.Activate();
} 
```

此外，我们还确保在 Load 事件期间不设置表单的标题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-02T16:41:26.197

在我们的情况下，这可以追溯到在`Load`事件中更改表单的文本属性。

将其放入 a 后`BeginInvoke`，不再发生这种奇怪的行为。

希望这对其他人有帮助。

例子

```
private void Form_Load(object sender, EventArgs e)
{
    ...
    ...
    ...
    // this needs to be inside a BeginInvoke otherwise it messes with the taskbar visibility
    this.BeginInvoke(new Action(() =>
        {
            this.Text = "Something new";
        }));
    ...
    ...
    ...
} 
```

# javascript - 如何切换选择多个复选框，如 GMail？

> ID：659508
> 
> 赞同：91
> 
> 时间：2009-03-18T18:19:43.010
> 
> 标签：javascript, gmail

在 GMail 中，用户可以单击电子邮件列表中的一个复选框，按住 Shift 键，然后选择第二个复选框。JavaScript 然后将选择/取消选择两个复选框之间的复选框。

我很好奇这是怎么做到的？这是 JQuery 还是一些基本（或复杂）的 JavaScript？

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2009-03-18T18:35:35.890

我写了一个使用 jquery 的独立演示：

```
$(document).ready(function() {
    var $chkboxes = $('.chkbox');
    var lastChecked = null;

    $chkboxes.click(function(e) {
        if (!lastChecked) {
            lastChecked = this;
            return;
        }

        if (e.shiftKey) {
            var start = $chkboxes.index(this);
            var end = $chkboxes.index(lastChecked);

            $chkboxes.slice(Math.min(start,end), Math.max(start,end)+ 1).prop('checked', lastChecked.checked);
        }

        lastChecked = this;
    });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<html>
<head>
</head>
<body>
    <input type="checkbox" id="id_chk1" class="chkbox" value="1" />Check 1<br/>
    <input type="checkbox" id="id_chk2" class="chkbox" value="2" />Check 2<br/>
    <input type="checkbox" id="id_chk3" class="chkbox" value="3" />Check 3<br/>
    <input type="checkbox" id="id_chk4" class="chkbox" value="4" />Check 4<br/>
    <input type="checkbox" id="id_chk5" class="chkbox" value="5" />Check 5<br/>
    <input type="checkbox" id="id_chk6" class="chkbox" value="6" />Check 6<br/>
    <input type="checkbox" id="id_chk7" class="chkbox" value="7" />Check 7<br/>
</body>
</html>
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-03-18T18:25:56.880

这是通过相当简单的 javascript 完成的。

他们跟踪最后一个复选框的 id，当另一个复选框被选中时，他们使用[shiftKey 事件属性](https://developer.mozilla.org/en-US/docs/DOM/event.shiftKey)来查看在单击复选框时是否保留了 shift。如果是这样，他们将两者之间的每个复选框的[选中属性设置为 true。](https://developer.mozilla.org/en-US/docs/DOM/HTMLInputElement)

要确定何时选中一个框，他们可能会在复选框上使用[onclick](https://developer.mozilla.org/en-US/docs/DOM/element.onclick)事件

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-06-20T15:09:54.430

最近，我编写了一个 jQuery 插件来提供该功能等等。

包含插件后，您只需要使用以下代码片段初始化复选框的上下文：

```
$('#table4').checkboxes({ range: true }); 
```

这是文档、演示和下载的链接：[http ://rmariuzzo.github.io/checkboxes.js/](http://rmariuzzo.github.io/checkboxes.js/)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-01-27T05:08:31.563

似乎我可以在网上找到的每个答案都完全依赖于 jQuery。JQuery 增加了很少的功能。这是一个不需要任何框架的快速版本：

```
function allow_group_select_checkboxes(checkbox_wrapper_id){
    var lastChecked = null;
    var checkboxes = document.querySelectorAll('#'+checkbox_wrapper_id+' input[type="checkbox"]');

    //I'm attaching an index attribute because it's easy, but you could do this other ways...
    for (var i=0;i<checkboxes.length;i++){
        checkboxes[i].setAttribute('data-index',i);
    }

    for (var i=0;i<checkboxes.length;i++){
        checkboxes[i].addEventListener("click",function(e){

            if(lastChecked && e.shiftKey) {
                var i = parseInt(lastChecked.getAttribute('data-index'));
                var j = parseInt(this.getAttribute('data-index'));
                var check_or_uncheck = this.checked;

                var low = i; var high=j;
                if (i>j){
                    var low = j; var high=i; 
                }

                for(var c=0;c<checkboxes.length;c++){
                    if (low <= c && c <=high){
                        checkboxes[c].checked = check_or_uncheck;
                    }   
                }
            } 
            lastChecked = this;
        });
    }
} 
```

然后在需要时对其进行初始化：

```
allow_group_select_checkboxes('[id of a wrapper that contains the checkboxes]') 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-09-24T04:08:43.257

[从http://abcoder.com/javascript/jquery/simple-check-uncheck-all-jquery-function/](http://abcoder.com/javascript/jquery/simple-check-uncheck-all-jquery-function/) 得到这个解决方案**（现在已经死了）**：

**JavaScript 和 HTML 代码**

```
var NUM_BOXES = 10;

// last checkbox the user clicked
var last = -1;

function check(event) {
  // in IE, the event object is a property of the window object
  // in Mozilla, event object is passed to event handlers as a parameter
  if (!event) { event = window.event }
  var num = parseInt(/box\[(\d+)\]/.exec(this.name)[1]);
  if (event.shiftKey && last != -1) {
     var di = num > last ? 1 : -1;
     for (var i = last; i != num; i += di) {
        document.forms.boxes['box[' + i + ']'].checked = true;
     }
  }
  last = num;
}

function init() {
  for (var i = 0; i < NUM_BOXES; i++) {
    document.forms.boxes['box[' + i + ']'].onclick = check;
  }
}
```

```
<body onload="init()">
    <form name="boxes">
    <input name="box[0]" type="checkbox">
    <input name="box[1]" type="checkbox">
    <input name="box[2]" type="checkbox">
    <input name="box[3]" type="checkbox">
    <input name="box[4]" type="checkbox">
    <input name="box[5]" type="checkbox">
    <input name="box[6]" type="checkbox">
    <input name="box[7]" type="checkbox">
    <input name="box[8]" type="checkbox">
    <input name="box[9]" type="checkbox">
    </form>
</body>
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-10-14T17:41:05.943

好吧，这篇文章很老了，但这是我刚刚遇到的一个解决方案： [jQuery Field Plug-In](http://www.pengoworks.com/workshop/jquery/field/field.plugin.htm)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-10-21T18:17:45.717

受所提供的精美答案的启发，这是一个普通的 JavaScript 版本，`Array.prototype`用于强制节点列表使用数组函数，而不是`for`循环。

```
(function () { // encapsulating variables with IIFE
  var lastcheck = null // no checkboxes clicked yet

  // get desired checkboxes
  var checkboxes = document.querySelectorAll('div.itemslist input[type=checkbox]')

  // loop over checkboxes to add event listener
  Array.prototype.forEach.call(checkboxes, function (cbx, idx) {
    cbx.addEventListener('click', function (evt) {

      // test for shift key, not first checkbox, and not same checkbox
      if ( evt.shiftKey && null !== lastcheck && idx !== lastcheck ) {

        // get range of checks between last-checkbox and shift-checkbox
        // Math.min/max does our sorting for us
        Array.prototype.slice.call(checkboxes, Math.min(lastcheck, idx), Math.max(lastcheck, idx))
          // and loop over each
          .forEach(function (ccbx) {
            ccbx.checked = true
        })
      }
      lastcheck = idx // set this checkbox as last-checked for later
    })
  })
}())
```

```
<div class="itemslist">
  <input type="checkbox" name="one"   value="1">
  <input type="checkbox" name="two"   value="2">
  <input type="checkbox" name="three" value="3">
  <input type="checkbox" name="four"  value="4">
  <input type="checkbox" name="five"  value="5">
</div>
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-07-04T13:32:09.367

我从@BC 获取了 jQuery 版本。并将其转换为 ES6 版本，因为代码实际上非常优雅地解决了问题，以防万一有人仍然偶然发现这个......

```
function enableGroupSelection( selector ) {
  let lastChecked = null;
  const checkboxes = Array.from( document.querySelectorAll( selector ) );

  checkboxes.forEach( checkbox => checkbox.addEventListener( 'click', event => {
    if ( !lastChecked ) {
      lastChecked = checkbox;

      return;
    }

    if ( event.shiftKey ) {
      const start = checkboxes.indexOf( checkbox );
      const end   = checkboxes.indexOf( lastChecked );

      checkboxes
        .slice( Math.min( start, end ), Math.max( start, end ) + 1 )
        .forEach( checkbox => checkbox.checked = lastChecked.checked );
    }

    lastChecked = checkbox;
  } ) );
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-03-07T14:04:55.433

我真的很喜欢 gyo 的示例并添加了一些代码，因此它适用于所有具有相同名称的复选框。

我还添加了一个 MutationObserver，因此事件也可以在新添加的复选框上处理。

```
$(document).ready(function() {
    var previouslyClicked = {};

    var rangeEventHandler = function(event) {
        if (event.shiftKey && previouslyClicked[this.name] && this != previouslyClicked[this.name]) {
            var $checkboxes = $('input[type=checkbox][name='+this.name+']').filter(':visible');
            var start = $checkboxes.index( this );
            var end = $checkboxes.index( previouslyClicked[this.name] );
//              console.log('range', start, end, this, previouslyClicked[this.name]);
            $checkboxes.slice(Math.min(start,end), Math.max(start,end)+ 1).prop('checked', previouslyClicked[this.name].checked);
        } else {
            previouslyClicked[this.name] = this;
        }
    };

    if ("MutationObserver" in window) { // https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver/MutationObserver to refresh on new checkboxes
        var mutationCallback = function(mutationList, observer) {
            mutationList.forEach((mutation) => {
                mutation.addedNodes.forEach((node) => {
                    if (node.nodeName == 'INPUT' && node.type == 'checkbox') {
                        $(node).on('click.selectRange', rangeEventHandler);
                    }
                });
            });
        };

        var observer = new MutationObserver(mutationCallback);
        observer.observe(document, {
            childList: true,
            attributes: false,  // since name is dynamically read
            subtree: true
        });
    }

    $('input[type=checkbox][name]').on('click.selectRange', rangeEventHandler);
});
```

```
<html>
<head>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <div>
    First:
    <input type="checkbox" name="first">
    <input type="checkbox" name="first">
    <input type="checkbox" name="first">
    <input type="checkbox" name="first">
    <input type="checkbox" name="first">
  </div>
  <div>
    Second:
    <input type="checkbox" name="second">
    <input type="checkbox" name="second">
    <input type="checkbox" name="second">
    <input type="checkbox" name="second">
    <input type="checkbox" name="second">
  </div>
</body>
</html>
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-04-17T09:38:23.507

*   找到了更好的解决方案，它适用于选择和取消选择复选框。

*   使用核心 javascript 和 Jquery。

```
$(document).ready(function() {
    var $chkboxes = $('.chkbox');
    var lastChecked = null;

    $chkboxes.click(function(e) {
        if(!lastChecked) {
            lastChecked = this;
            return;
        }

        if(e.shiftKey) {
            var start = $chkboxes.index(this);
            var end = $chkboxes.index(lastChecked);

            $chkboxes.slice(Math.min(start,end), Math.max(start,end)+ 1).prop('checked', e.target.checked);

        }

        lastChecked = this;
    });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<html>
    <head>
    </head>
    <body>
        <input type="checkbox" id="id_chk1" class="chkbox" value="1" />Check 1<br/>
        <input type="checkbox" id="id_chk2" class="chkbox" value="2" />Check 2<br/>
        <input type="checkbox" id="id_chk3" class="chkbox" value="3" />Check 3<br/>
        <input type="checkbox" id="id_chk4" class="chkbox" value="4" />Check 4<br/>
        <input type="checkbox" id="id_chk5" class="chkbox" value="5" />Check 5<br/>
        <input type="checkbox" id="id_chk6" class="chkbox" value="6" />Check 6<br/>
        <input type="checkbox" id="id_chk7" class="chkbox" value="7" />Check 7<br/>
    </body>
</html>
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-25T07:11:21.367

这是我编写和使用的 jquery 解决方案：

*   所有复选框都有相同的类命名`chksel`
*   为了更快地进行个人选择，班级将执行名为`chksel_index`
*   每个`checkbox`都有一个名为`rg`包含相同索引的属性

    ```
    var chksel_last=-1;
    $('.chksel').click(function(ev){
       if(ev.shiftKey){var i=0;
          if(chksel_last >=0){
            if($(this).attr('rg') >= chksel_last){
             for(i=chksel_last;i<=$(this).attr('rg');i++){$('.chksel_'+i).attr('checked','true')}}
            if($(this).attr('rg') <= chksel_last){for(i=$(this).attr('rg');i<=chksel_last;i++){$('.chksel_'+i).attr('checked','true')}}
          }  
          chksel_last=$(this).attr('rg');
       }else{chksel_last=$(this).attr('rg');} 
    ```

    })

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-08-04T12:56:17.857

这也是另一个类似于 Outlooks 多选的实现..

```
 <script type="text/javascript">

function inRange(x, range)
{
    return (x >= range[0] && x <= range[1]);
}

$(document).ready(function() {
    var $chkboxes = $('.chkbox');
    var firstClick = 1;
    var lastClick = null;
    var range = [];

    $chkboxes.click(function(e) {
        if(!e.shiftKey && !e.ctrlKey) {

            $('#index-' + firstClick).prop('checked', false);

            firstClick = $chkboxes.index(this) + 1;

            if (firstClick !== null && firstClick !== ($chkboxes.index(this)+1)) {
                $('#index-' + firstClick).prop('checked', true);
            }
        } else if (e.shiftKey) {
            lastClick = $chkboxes.index(this) + 1;
            if ((firstClick < lastClick) && !inRange(lastClick, range)) {
                for (i = firstClick; i < lastClick; i++) {
                    $('#index-' + i).prop('checked', true);
                }
                range = [firstClick, lastClick];
            } else if ((firstClick > lastClick) && !inRange(lastClick, range)) {
                for (i = lastClick; i < firstClick; i++) {
                    $('#index-' + i).prop('checked', true);
                }
                range = [lastClick, firstClick];
            } else if ((firstClick < lastClick) && inRange(lastClick, range)) {
                for (i = 1; i < 100; i++) {
                    $('#index-' + i).prop('checked', false);
                }

                for (i = firstClick; i < lastClick; i++) {
                    $('#index-' + i).prop('checked', true);
                }
                range = [firstClick, lastClick];
            }else if ((firstClick > lastClick) && inRange(lastClick, range)) {
                for (i = 1; i < 100; i++) {
                    $('#index-' + i).prop('checked', false);
                }

                for (i = lastClick; i < firstClick; i++) {
                    $('#index-' + i).prop('checked', true);
                }
                range = [lastClick, firstClick];
            }
        }
    });
}); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-02-12T09:46:34.010

这个解决方案对我有用，也适用于 DataTables [https://jsfiddle.net/6ouhv7bw/4/](https://jsfiddle.net/6ouhv7bw/4/)

```
<table id="dataTable">

<tbody>
<tr>
<td><input type="checkbox"></td>
</tr>

<tr>
<td><input type="checkbox"></td>
</tr>

<tr>
<td><input type="checkbox"></td>
</tr>

<tr>
<td><input type="checkbox"></td>
</tr>
</tbody>
</table>

<script>
$(document).ready(function() {
   var $chkboxes = $('#dataTable');
var $range = '#dataTable tbody';
var $first = false;
var $indexWrapp = 'tr';
var lastChecked = null;
var $checkboxes = 'input[type="checkbox"]';

$chkboxes.on('click',$checkboxes,function(e) {

    if ($first===false) {

        lastChecked = $(this).closest($indexWrapp).index();
        lastCheckedInput = $(this).prop('checked');
        $first=true;
        return;
    }

    if (e.shiftKey) {

        var start = lastChecked;
        var end =  $(this).closest($indexWrapp).index();

       $( $range+' '+$indexWrapp).each(function() {
          $currIndex=$(this).index();
          if( $currIndex>=start && $currIndex<=end ){
              $(this).find($checkboxes).prop('checked', lastCheckedInput);
          }

       })
    }

     lastCheckedInput = $(this).prop('checked');
     lastChecked = $(this).closest($indexWrapp).index();
});
</script> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-31T08:46:57.900

这是优雅的实现。想法是将第一个选择的输入存储到 lastChecked 变量中，当用户使用 shiftKey 选择输入字段时，我们将运行一个循环并切换 inBetween(boolean) 并将所有复选框标记为真值。灵感来自韦斯博斯。

```
let checkboxes= document.querySelectorAll('.wrapper input[type="checkbox"]');
let lastChecked;

function logic(e)
{
let inBetween= false;   
if(e.shiftKey)
{
  checkboxes.forEach(checkbox=>{
    if(checkbox===this  || checkbox===lastChecked)
    {
      inBetween =!inBetween;
    }
    if(inBetween) checkbox.checked=true;

  })             
}
 lastChecked= this;   
}

checkboxes.forEach((checkbox,i) => checkbox.addEventListener('click',logic)); 
```

```
.wrapper{
 display: flex;
 flex-direction: column;
} 
```

```
<div class="wrapper">
  <input type="checkbox" name="one">
  <input type="checkbox" name="two">
  <input type="checkbox" name="three">
  <input type="checkbox" name="four">
  <input type="checkbox" name="five">
</div> 
```

# javascript -

> ID：659510
> 
> 赞同：-2
> 
> 时间：2009-03-18T18:19:45.693
> 
> 标签：javascript, jquery, css

我有一个带有标题 id 的 h2 元素，并且我有以下脚本：

```
<script type="text/javascript">
$(document).ready(function(){

   $("#title").css("background-color","red");   

)};
</script> 
```

背景颜色没有改变，我不知道为什么？

```
<html>
<head>
<title>Table Sorter</title>
<script type="text/javascript" src="/js/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="/js/jquery.tablsorter.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){

$("#title").css("background-color","red");  

)};
</script>
</head>

<body>
<h2 id="title">Table Sorter</h2>
</body>
</html>

<script type="text/javascript">
$(document).ready(function()
{
    $("#title").css("background-color","red");
    $("#myTable").tablesorter();
}
);
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-18T18:34:08.873

代替

```
<link type="text/javascript" src="/js/jquery-1.3.2.min.js"/> 
```

和

```
<script type="text/javascript" src="/js/jquery-1.3.2.min.js"></script> 
```

您的 jQuery 函数中的右括号也有语法错误。他们应该是

```
$(document).ready(function(){
  $("#title").css("background-color","red");
}); 
```

如果那*仍然*不能解决您的问题，请在此处设置警报...

```
$(document).ready(function(){
  alert("Howdy!");
}); 
```

如果您没有看到警告消息，则说明您的 jQuery 脚本未加载，这意味着 SRC 属性中的相对路径不正确。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T18:54:58.230

看来你又犯了一个错字：

```
<title>Table Sorter</table>
                     ^^^^^ 
```

替换`table`为`title`：

```
<title>Table Sorter</title> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T18:25:58.223

你能在没有 jQuery 的情况下让它工作吗？尝试：

```
document.getElementById("title").style.backgroundColor = "#F00"; 
```

而不是您当前的脚本。如果这不起作用，请检查您的 HTML 格式是否正确。

更新：既然您已经发布了 HTML，我可以看到您需要使用脚本标签而不是链接标签来导入 jQuery

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T18:29:17.747

代替

```
<link type="text/javascript" src="/js/jquery-1.3.2.min.js"/> 
```

和

```
<script type="text/javascript" src="/js/jquery-1.3.2.min.js"/> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T18:43:07.493

干得好。其他人指出了您遇到的一些小问题，例如在需要脚本标签的地方使用链接标签等。此代码对我有用：

```
<html>
  <head>
    <title>Table Sorter</title>
    <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
        $("#title").css("background-color","red");
      });
    </script>
  </head>
  <body>
    <h2 id="title">Table Sorter</h2>
  </body>
</html> 
```

看起来你的代码中有一个错字，在你的 $(document).ready 部分的末尾，你有 )}; 代替 }）;。如果您使用 Firefox，您可以打开错误控制台并查看任何 Javascript 错误或警告。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T18:39:58.953

好的，我想通了，我不知道为什么会这样。在 JQuery 脚本标签下方，我有另一个脚本标签：

```
<script type="text/javascript" src="/js/jquery.tablsorter.min.js"/> 
```

当我删除上述内容时，它起作用了。但我不知道为什么？

# .net - WPF：如何冻结 ListView 标题行，使其不会滚动到屏幕外

> ID：659512
> 
> 赞同：11
> 
> 时间：2009-03-18T18:20:44.817
> 
> 标签：.net, wpf, listview, header, gridviewcolumn

我是 WPF 开发的新手，我有一个 ListView，我想冻结标题行，以便在用户滚动列表时它不会滚动到屏幕外。我继承的 xaml 代码如下所示：

```
<ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
  <DockPanel>
    <forms:BindableGrid DockPanel.Dock="Top" [code snipped] >
    <ListView.View>
      <GridView>
        <GridViewColumn Header="ColA" DisplayMemberBinding="{Binding ColA}" />
        <GridViewColumn Header="ColB" DisplayMemberBinding="{Binding ColB}" />
           [etc] 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-18T19:32:03.290

`ListView`已经这样做了 - 它有一个只`ScrollViewer`滚动项目而不是标题的内部。

问题是你的外部`ScrollViewer`告诉它的孩子（the `DockPanel`）它有无限的可用空间，而 the`DockPanel`告诉它的孩子，所以你`ListView`最终占用了显示所有项目所需的空间，而内部`ScrollViewer`则没有出现。

如果你拿走你的外层`ScrollViewer`，`ListView`应该会发现它的空间有限，而内层`ScrollViewer`就会出现。

这显然会影响你的其他东西`DockPanel`，所以我会看看会发生什么，然后从那里开始。

# javascript - 我想使用 .childNodes 迭代表，然后找到标签。我的代码不起作用！

> ID：659521
> 
> 赞同：0
> 
> 时间：2009-03-18T18:22:24.610
> 
> 标签：javascript

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T18:28:00.137

你*可以*打一场精彩的战斗，并尝试让这个怪物在所有浏览器上运行......

或者，你可以试试[jQuery](http://www.jquery.com)！这既有趣又简单，所有酷孩子都在这样做！

```
var text = $('tr.rowData').find('b').filter(function() {
    return $(this).css('color') == 'silver';
}).text();
alert(text); 
```

多田！

**编辑**：说真的，如果你想用原始的 javascript 来做，这在 IE 和 Firefox 上对我有用：

```
var text;
var bs = document.getElementsByTagName("b");
for(var x = 0; x < bs.length; x++) {
    if(bs[x].style.color == 'silver') {
        text = bs[x].innerHTML;
        break;
    }
}
alert(text); 
```

它只是抓取文档中的所有粗体元素并检查哪个具有银色。显然，这不是*超级*有效，而且我不确定您的用例。我确实在您的代码中看到您首先获取对`jobContents`元素的引用。我不确定这是从哪里来的，因为您没有发布标记的那部分，但如果`<b>`最终将在此元素内，您可以更改此行：

```
var bs = document.getElementsByTagName("b"); 
```

对此：

```
var bs = jobContents.getElementsByTagName("b"); 
```

然后它将 1) 加快速度，2) 确保你得到你想要的。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T18:34:07.733

您的代码没有深入到树中。您至少需要 4 级以上的 childNode "for" 循环才能到达 "B" 标记。如果你走这条路，那么你可能应该做一个递归函数来搜索你的“B”标签。

# ruby-on-rails - 如何让 Rails 返回具有正确数据类型而不是字符串的 SUM(columnName) 属性？

> ID：659523
> 
> 赞同：4
> 
> 时间：2009-03-18T18:22:55.857
> 
> 标签：ruby-on-rails, activerecord

假设查询如下形式

```
operatingExpenses = Expense.find(:all,
      {:select=>"categories.activityType, categories.name heading, sum(amount) totalAmount",
      :joins => "inner join expense_categories categories on category_id = categories.id ",
      :group => "categories.activityType, categories.name",
      :order => "categories.activityType, totalAmount DESC"}
      ) 
```

现在金额被定义为数据库模式中的十进制字段。例如 Rails 迁移中的定义是

```
create_table :expenses do |table|
  table.column :created_at, :timestamp, :null=>false
  table.column :description, :string, :limit=>100, :null=>false
  table.column :amount, :decimal, :scale=>2, :precision=>10, :null=>false
  table.column :category_id, :integer, {:null=>false, :default =>1} 
end 
```

现在查询返回的记录集未能通过以下断言

```
assert_equal 800, operatingExpenses[1].totalAmount

<800> expected but was <"800.00">. 
```

为什么 Sum/aggregate 列返回为字符串，而不是与汇总数据库列相同的数据类型？我想避免洒水`.to_s`或`.to_f`到处去解决这个问题。有任何想法吗 ？

我试图在这条彩虹的尽头得到一个像这样的现金流列表 - （对于指定的日期范围......上面列出的查询的附加条件）。

```
 cat Type      Heading      TotalAmount 
|  Operating |  ExpCatX001  | 4000 |
|            |  ExpCatX002  |  200 |
|  Financing |  ExpCatX003  | 1000 |
|  Investing |  ExpCatX004  | 4234 |
|            |  ExpCatX005  |  201 | 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T20:49:35.793

对于基本上需要整个自定义 SQL 语句的自定义查询（您上面的发现并没有完全从您那里抽象出来），我喜欢建立一个快速的小新模型来表示新信息。IE

```
class OperatingExpenseReportDatum
  attr_accessor :type, :heading, :total

  def initialize(row)
    # set values from row, like
    @total = row["total"].to_f
  end
end 
```

然后在模型中写入一个辅助方法，例如：

```
class Expense < AR::Base
  ...
  def self.operating_expenses
    rows = connection.select_all "SQL STATEMENT HERE"
    rows.map { |row| OperatingExpenseReportDatum.new(row) }
  end
end 
```

那么你的报告生成就很好了：

```
#controller
@expenses = Expense.operating_expenses

#view
<% @expenses.each do |expense| %>
  <%= expense.type %>: <%= expense.total %>
<% end %> 
```

或类似的东西。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T18:38:34.277

活动记录正在尝试返回根据查询结果构建的“费用”对象。但是费用对象没有 totalAmount 字段，所以据 ActiveRecord 所知，这是未请求的“奖金数据”。它可以把它扔掉，但它会为你保留它，它可以使用最宽容的类型假设。

我的建议：

*   不要这样做；这不是活动记录应该工作的方式；细节的总和属于将它们卷起来的任何东西；它本身不是一个细节对象。
*   如果您必须将其视为详细信息，请为该字段命名，`amount`以便 ActiveRecord 知道如何处理它。
*   如果您必须将总计作为自己的字段，请在您的 Expense 模型中添加一个访问器，如下所示：

    ```
    def total_amount
        totalAmount.to_f
        end 
    ```

    并像这样使用它：`operatingExpenses[1].total_amount`在您的代码中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T18:46:27.550

因为有了`:select`Rails，您无法告诉它（或驱动程序）绑定结果集字段的本机类型（一旦全部检索到 - 尽管大多数驱动程序*不会*在内部知道列 SQL 类型are) -- 所以全部记录为字符串，SQL类型信息一般都扔掉了。这始终适用于所有领域。您必须手动执行转换 ( `to_f`)，就像 Rails 的`ActiveRecord.instantiate`方法必须在内部一样，当您使用`ActiveRecord.find`不带`:select`or的 plain 时`:joins`（并且它必须填充非字符串属性。）

您可以通过查看数据库驱动程序的`select_raw`方法来确认这一点。

干杯，V。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T08:14:05.047

只需执行`find_by_sql`并应用`SUM`小数列：

```
operating_expenses = Expense.find_by_sql ['SELECT cat.activityType, cat.name heading, SUM(exp.amount) AS amount FROM expenses exp JOIN expense_categories cat ON exp.category_id = cat.id GROUP BY cat.id, cat.activityType, cat.name, exp.id ORDER BY cat.activityType, amount DESC'] 
```

在 operating_expenses 的“金额”列下，您将自动转换为小数。

**注意**：cat.id 和 exp.id 需要遵守 SQL 标准。

# c# - Sql Server 2005 - 在 Asp.net c# 中超时

> ID：659529
> 
> 赞同：0
> 
> 时间：2009-03-18T18:24:26.837
> 
> 标签：c#, asp.net, sql-server-2005

我正在使用 Asp.Net c# 和 Sql Server 2005。我正在使用 Masterpage 和内容页面。当我调试我的代码时，它给出了错误::

**窗口 Internet Explorer SYS.WEBFORMS.PAGEREQUESTMANAGER TIMEOUTEXCEPTION：服务器请求超时。**

任何机构请帮帮我？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T18:28:23.147

您有一个 ajax 请求需要很长时间才能完成。如果您可以隔离请求并分享它正在尝试做的事情，那将会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T18:30:25.810

这是一个 Ajax 错误 - 您是否只在调试时收到错误？如果要增加此超时，请将脚本管理器的 AsyncPostBackTimeout 设置为较大的值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T18:27:47.297

如果您坐在那里太久试图单步执行您的 ajax 请求，就会发生这种情况。要么增加超时时间，要么加快工作速度。

顺便说一句，我相信超时设置默认为 90 秒。 [有关更多信息，请参阅此](http://w3ka.blogspot.com/2008/02/ajax-timeout-problem-by-asyncronous.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T18:28:07.157

我在该错误消息中没有*立即*看到任何明显的迹象，表明这是一个超时的 SQL 服务器请求，而不是任何其他类型的“服务器请求”。但是，如果是这样，请在您的 SQL 服务器上安装一个分析器以查看哪个请求需要很长时间 - 并确定它是否只是需要加速的查询、死锁或类似的东西。

另一种可能性是它是连接池 - 如果您没有正确关闭连接，您可能会超时等待它们返回到池中。如果是这种情况，您显然不会在 SQL 分析器中看到该请求。

# c# - JIT 如何知道在哪里寻找 csc.exe？

> ID：659531
> 
> 赞同：2
> 
> 时间：2009-03-18T18:25:27.990
> 
> 标签：c#, .net, jit

JIT 如何知道在哪里寻找 csc.exe？此外，其他 .NET 语言（如 IronRuby）如何处理这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-18T18:27:57.437

csc.exe 生成 IL 代码。JIT 从 IL 代码生成机器代码，如果我错了请纠正我，但我认为 JIT 与 csc.exe 没有任何关系

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-18T18:50:01.237

`csc.exe`将 C# 源代码编译为 MSIL。JIT 编译器是 CLR 的一部分并在 中实现`mscorjit.dll`，它位于当前的 CLR (2.0 atm) 中。

# c# - 为什么我不应该为我的字段添加前缀？

> ID：659552
> 
> 赞同：49
> 
> 时间：2009-03-18T18:30:47.353
> 
> 标签：c#, field, naming-conventions, hungarian-notation

我从来都不是匈牙利符号的粉丝，除非你在做一些非常低级的编程，否则我一直觉得它毫无用处，但是在我从事的每个 C++ 项目中，都强制执行了某种匈牙利符号策略，并且使用一些“不是真正的匈牙利语”前缀作为字段的 m_，静态的 s_，全局的 g_ 等等。

很快我就意识到它在 C# 中是多么无用，并逐渐开始放弃我所有的旧习惯......但是'm_'的东西。我仍然在私有字段上使用 m_ 前缀，因为我真的发现能够区分参数、本地和字段非常有用。

[MSDN 上字段页面](https://msdn.microsoft.com/en-us/library/ta31s3bc%28v=VS.71%29.aspx)的命名约定说我不应该，但没有说明原因（例如，Google 的约定通常倾向于合理化他们的规定）。

是否有我不应该这样做的原因，或者这只是风格问题。如果是后者，前缀通常被认为是一种不好的风格吗？我可以期待其他代码库工作人员的负面反应吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-03-18T18:51:49.097

我喜欢成员字段的下划线前缀。大多数情况下，我喜欢它，因为这样，我的所有成员字段都按字母顺序显示在屏幕顶部向导栏中的方法之前。

![向导栏](https://farm4.static.flickr.com/3457/3365364077_4d39c8f6e5.jpg)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-03-18T18:35:04.143

当你应该：

*   当你的项目编码指南说你应该

当你不应该：

*   当你的项目编码指南说你不应该

如果您还没有任何指导方针，您可以自由选择您或您的团队想要并感觉最舒服的任何内容。就我个人而言，在编写 C++ 代码时，我倾向于`m_`为成员使用，它确实有帮助。当用其他语言编码时，尤其是那些没有真正类的语言（如 Javascript、Lua）我不会。

简而言之，我不相信有“正确”和“错误”的方式。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-18T18:38:55.837

C# 3.0 中的自动实现属性特性以一种或另一种方式减少了对这种约定的需求。而不是写

```
string m_name;
public string Name { get { return m_name; } } 
```

或者

```
string _Name;
public string Name { get { return _Name; } } 
```

（或任何其他约定），您现在可以编写

```
public string Name { get; private set; } 
```

由于您不再需要显式的后备存储变量，因此您不再需要为其命名；从而避免了整个讨论。

显然，当您确实需要显式后备存储（例如执行验证）时，此参数不适用。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-18T18:53:05.160

正如一些人所暗示的那样，MS 指南说：

> 不要为字段名称使用前缀。例如，不要使用 g_ 或 s_ 来区分静态字段和非静态字段。

我碰巧同意这一点。前缀使您的代码看起来很丑陋，并用无关紧要的字符浪费空间。话虽如此，通常使用字段来支持字段和属性具有相同名称的属性（私有字段为驼峰大小写，属性为帕斯卡大小写）。在 VB 中，这不起作用，因为 VB 不区分大小写。在这种情况下，我建议使用单个 _ 前缀。不多也不少。它看起来更干净，恕我直言。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-03-18T19:24:17.847

我已经尝试过 m_、s_，只是 _，根本没有前缀。我已经决定只对所有静态和实例变量使用 _。我认为区分静态变量和实例变量并不重要。理论上听起来不错，实际上它不会产生问题。

一位同事曾经提出了一个令人信服的论点来消除所有前缀，我们在一个项目上进行了尝试，它的效果比我预期的要好。我把它带到了我的下一个项目，并对它“干扰”了 Intellisense 感到恼火。当您有以下情况时

```
int foo;
public int Foo
{
  get { return foo; }
} 
```

开始键入 foo 将建议实例变量和属性。用下划线前缀变量消除了烦人的双重建议，所以我切换回只使用_。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-03-18T18:37:05.340

我尝试遵循[MSDN .NET 库指南](http://msdn.microsoft.com/en-us/library/ms229042.aspx)。它们包括一个[命名指南](http://msdn.microsoft.com/en-us/library/ms229002.aspx)部分。

显然，这些是您的项目指南的次要内容。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-03-18T18:48:22.410

我更喜欢用下划线而不是“m”来标记属性支持字段（尽管正如已经提到的 .NET 3.0+ 减少了自动属性的需要）。一方面，当我开始使用它们时，它会将它们放在 InteliSense 列表的顶部。

我承认我需要重新了解 MSDN 上的指南，这些天事情变化得如此之快。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-03-18T18:50:31.500

使用像 resharper 这样的工具，真的没有理由使用前缀。此外，如果您编写简短的方法，您应该能够非常快速地判断 var 的来源。最后，我想我不会真正看到区分静态与否的必要性，因为如果您尝试做一些您无法做的事情，resharper 会再次将其标记为红线。即使没有重新锐化器，您也可能会被编译器保存。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-03-18T18:36:12.957

出于与您陈述的相同原因，我总是在成员变量前面加上**m_**和在静态变量前面加上**s_ 。**有些人用下划线作为成员变量的前缀，但我总是觉得这看起来有点奇怪（但这只是个人喜好）。

与我一起工作的大多数人都使用 m_/s_ 前缀。我真的认为你使用什么并不重要，只要你保持一致。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-03-18T18:41:02.100

我从不使用它们。它鼓励草率的编码。MSDN 编码指南，就是它所在的地方。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-03-18T19:08:54.127

正如@John Kraft 提到的，没有“正确”的答案。MattJ 是最接近的——您应该始终遵循公司的风格指南。在罗马的时候，以及所有这些。

至于我个人的看法，既然这里需要，我投票你`m_`完全放弃。

我相信最好的风格是所有成员都是`PascalCased`，无论可见性如何（这意味着甚至`private`成员），并且所有论点都是`camelCased`. 我不会打破这种风格。

我可以理解为属性后备存储字段添加前缀的愿望；毕竟你必须区分字段和属性，对吧？我同意，你必须。但是使用后修复。

使用. `m_MyProperty`_ `_MyProperty`_ `MyPropertyValue`它更容易阅读和理解，而且——更重要的是——它与智能感知中的原始属性名称接近。

最终，这就是我更喜欢后缀的原因。如果我想`MyPropertyValue`使用智能感知访问，你（通常）输入“ `My <down-arrow> <tab>`”，因为那时你已经足够接近`MyProperty`并且`MyPropertyValue`在列表中。如果你想`m_MyProperty`使用智能感知访问，你必须输入“ `m_My <tab>`”。

在我看来，这是关于击键经济的。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2010-05-03T23:37:25.050

以下是使用 _（而不是 m_）的几个原因。

(1) 尽管有 MS 的命名指南，但许多 BCL 人还是这样做了。（查看他们的[博客](https://blogs.msdn.microsoft.com/bclteam/)。）这些人编写了框架，所以他们有一些值得效仿的好习惯。MSDN 上一些最有用的示例代码是由他们编写的，因此使用下划线约定。这是一个事实上的行业标准。

(2) 单个下划线是一种明显但不显眼的方式，通过简单地阅读源代码来消除方法和类级变量的歧义。它可以帮助人们在阅读新（或旧）代码***时一目了然***。是的，您可以将鼠标悬停在 IDE 中查看它，但我们不应该被迫这样做。您可能想在文本编辑器中阅读它，或者我敢说，在纸上。

(3) 有人说您不需要任何前缀，因为方法会很短，稍后如果需要，您可以将字段更改为自动实现的属性。但在现实世界中，方法只要需要就可以，并且字段和属性之间存在重要差异（例如序列化和初始化）。

脚注： m_ 中成员的“m”在我们这里的使用中是多余的，但它是小写的，因为许多旧命名约定中的一个想法是类型名称以大写开头，而实例名称以小写开头。这不适用于.NET，所以它是双重冗余的。此外，匈牙利表示法有时对旧的 C 编译器很有用（例如整数或指针转换和算术），但即使在 C++ 中，它在处理类时也没有用处。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-03-18T18:47:43.053

我习惯的是私有属性有小下划线 f.ex“字符串_名称”。公众得到了“名字”。并且方法中的输入变量得到小写字母“void MyMethod(string name)”。

如果你有 static const 通常用大写字母写。`static const MYCONST = "hmpf"`.

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-03-18T18:47:50.510

C++ 和 C# 之间有一个重要区别：工具支持。当您遵循既定指南（或常见变体）时，您将获得 C++ 从未有过的深度工具支持。遵循标准允许工具进行比您原本能够做的更深入的重构/重命名操作。Resharper 做到了这一点。所以坚持使用既定标准之一。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-03-18T19:09:59.630

我从不这样做，原因是我[试图]保持我的方法简短。如果我可以在屏幕上看到整个方法，我可以看到参数，我可以看到本地，所以我可以知道类拥有什么，什么是参数或本地。

我通常会使用特定的符号来命名我的参数和本地变量，但并非总是如此。如果不是不一致，我什么都不是。我依赖于我的方法很短这一事实，并试图阻止他们在应该只做 X 的时候做 X、Y 和 Z。

无论如何，这是我的两分钱。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-03-18T19:39:18.967

我相信我会因此而受到抨击，但就这样吧。

它被称为 Microsoft 的 .NET 库指南，但实际上是[Brad Abrams 的](https://blogs.msdn.microsoft.com/brada/2005/01/26/ok-i-give-here-are-a-set-of-internal-coding-guidelines/)观点（[在此处记录](https://blogs.msdn.microsoft.com/brada/2005/01/26/internal-coding-guidelines/)）——还有其他有正当理由的观点。

人们倾向于接受大多数人的观点，而不是对特定风格有充分的理由。

重要的一点是评估为什么使用特定样式以及为什么它比另一种样式更受欢迎 - 换句话说，选择一种样式不仅仅是因为每个人都说这是要做的事情 - 自己思考。

不使用旧式匈牙利语的基本原因是使用的缩写对于每个团队都不同并且难以学习 - 这很容易通过不使用缩写来解决。

随着可用开发工具的变化，样式应该更改为最有意义的样式 - 但每个样式项都有充分的理由。

以下是我的风格指南以及我的理由——我一直在寻找改进我的风格的方法，以创建更可靠、更易于维护的代码。

变量命名约定

我们对变量命名约定都有自己的看法。有许多不同的样式将有助于生成易于维护的高质量代码 - 任何支持有关变量的基本基本信息的样式都可以。特定命名约定的标准应该是它有助于生成可靠且易于维护的代码。不应该使用的标准是： 丑陋的微软（即布拉德艾布拉姆斯）说不要使用那种风格 - 微软并不总是产生最可靠的代码，只是看看 Expression Blend 中的错误。在阅读代码时，变量名称应立即传达有关该变量的三个基本事实，这一点非常重要：它的作用域它的类型清楚地了解它用于作用域：Microsoft 建议完全依赖 IntelliSense。IntelliSense 很棒；但是，人们根本不会将鼠标悬停在每个变量上以查看其范围和类型。假设一个变量在它不在的范围内可能会导致重大错误。例如，如果引用变量作为参数传入并且在本地范围内进行了更改，则该更改将在方法返回后保留，这可能是不需要的。如果在本地范围内修改了字段或静态变量，但有人认为它是局部变量，则可能会导致意外行为。因此，能够只查看一个变量（而不是鼠标悬停）并立即知道它的范围是非常重要的。如果引用变量作为参数传入并在本地范围内更改，则更改将在方法返回后保留，这可能是不需要的。如果在本地范围内修改了字段或静态变量，但有人认为它是局部变量，则可能会导致意外行为。因此，能够只查看一个变量（而不是鼠标悬停）并立即知道它的范围是非常重要的。如果引用变量作为参数传入并在本地范围内更改，则更改将在方法返回后保留，这可能是不需要的。如果在本地范围内修改了字段或静态变量，但有人认为它是局部变量，则可能会导致意外行为。因此，能够只查看一个变量（而不是鼠标悬停）并立即知道它的范围是非常重要的。

建议使用以下表示范围的样式；但是，任何样式都是完全可以的，只要它清楚一致地指示变量的范围： m_ 字段变量 p_ 传递给方法的参数 s_ 静态变量局部变量 类型：如果认为他们正在使用特定类型，则可能会发生严重错误他们实际上是在使用不同的类型——同样，我们根本不会将鼠标悬停在任何变量上来确定它的类型，我们只是假设我们知道它的类型是什么，这就是错误是如何产生的。

缩写：缩写是邪恶的，因为它们对不同的开发人员可能意味着不同的东西。一位开发人员可能认为前导小写“s”表示字符串，而另一位开发人员可能认为它表示有符号整数。缩写是懒惰编码的标志 - 花一点额外的时间并输入全名，以使必须维护代码的开发人员清楚。例如，“str”和“string”之间只有三个字符的区别——让代码易于维护并不需要更多的努力。

内置数据类型的通用且清晰的缩写仅是可接受的，但必须在团队内部进行标准化。

自记录代码：为变量名称添加清晰的描述可以让其他开发人员轻松阅读和理解代码 - 使名称易于理解，以便团队经理无需成为开发人员即可阅读和理解代码。

变量名称部分的顺序：推荐的顺序是作用域类型描述，因为：IntelliSense 将对所有相似作用域进行分组，并且在每个作用域内 IntelliSense 将对所有相似类型进行分组，这使得查找变得容易 - 尝试以其他方式查找变量这使得它非常容易查看和理解范围以及查看和理解类型 这是一种相当常见的样式，易于理解 它将通过 FxCop

示例： 下面是几个示例： m_stringCustomerName p_stringCustomerDatabaseConnectionString intNumberOfCustomerRecords 或 iNumberOfCustomerRecords 或 integerNumberOfCustomerRecords 这些简单的规则将显着提高代码的可靠性和可维护性。

控制结构单行语句 所有控制结构（if、while、for 等）单行语句都应该用大括号括起来，因为很容易添加新语句而不会意识到给定语句属于控制结构，该控制结构将在不产生任何编译时错误的情况下破坏代码逻辑。

**方法异常包装** 所有方法都应该用一个外部 try-catch 包装，它可以捕获、提供一个地方来恢复、识别、定位、记录，并做出是否抛出的决定。导致我们的应用程序崩溃的是意外异常 - 通过包装捕获所有未处理异常的每个方法，我们保证识别和记录所有异常，并防止我们的应用程序崩溃。这需要更多的工作，但结果非常值得付出努力。

**压痕** 压痕不是主要问题；但是，建议使用四个空格而不使用制表符。如果打印代码，第一个打印机选项卡通常默认为 8 个空格。不同的开发人员倾向于使用不同的标签大小。Microsoft 的代码通常缩进 4 个空格，因此如果使用任何 Microsoft 代码并且使用 4 个空格以外的空格，则需要重新格式化代码。四个空格使它变得简单和一致。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-03-18T20:17:25.333

除非我坚持使用 vi 或 Emacs 来编辑代码，否则我的 IDE 会为我处理成员的差异显示，因此我很少使用任何特殊约定。这也适用于使用 I 为接口添加前缀或使用 C 为类添加前缀。

请有人解释接口上 I 前缀的 .NET 样式。:)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-03-18T18:49:12.923

每当我有选择的时候，我从不使用任何匈牙利疣。这是额外的打字，并没有传达任何有意义的信息。任何好的 IDE（我根据这个特性的存在来定义“好”，等等）将允许您对静态成员、实例成员、成员函数、类型等有不同的语法突出显示。没有理由让您的包含可由 IDE 提供的信息的代码。这是不将注释掉的旧代码弄乱代码的必然结果，因为您的版本控制系统应该对这些内容负责。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-03-18T18:59:17.220

最好的方法是与你的同事就一个标准达成一致，并坚持下去。它不一定是对每个人都最有效的方法，只是同意一种方法比你实际同意的方法更重要。

我们为代码标准选择的是使用 _ 作为成员变量的前缀。原因之一是它可以很容易地在智能感知中找到局部变量。

在我们就该标准达成一致之前，我使用了另一个标准。我根本没有使用任何前缀，而是写`this.memberVariable`在代码中以表明我使用的是成员变量。

使用 C# 3 中的属性简写，我发现我使用了很多不那么显式的成员变量。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-03-18T20:33:07.760

最接近官方指南的是[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)，这是一种来自 Microsoft 的工具，它可以自动分析您的源文件并检测与推荐的编码风格的违规行为，并且可以在 Visual Studio 和/或 MSBuild 等自动构建中运行。

我们在我们的项目中使用它，它确实有助于使开发人员之间的代码样式和布局更加一致，尽管要注意它确实需要*相当*多的时间来适应！

回答你的问题 - 它不允许任何匈牙利符号，也不允许任何前缀`m_`（事实上，它根本不允许使用下划线）。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-03-18T22:18:41.377

我不再使用那种风格了。它旨在帮助您快速了解变量的使用方式。较新的开发环境可让您通过将鼠标悬停在变量上来查看该信息。如果您使用那些较新的工具，对它的需求就会消失。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-03-19T14:12:41.270

还可能从*C++ 编码标准*（**Sutter、Herb**和**Alexandrescum Andrei**，2004 年）中获得一些见解。项目#0 的标题是“不要为小事出汗。（或：知道什么不应该标准化。）”。

他们通过说“如果您无法决定自己的命名约定，请尝试...私有成员变量**likeThis_** ...”，稍微触及了这个特定问题（请记住，前导下划线的使用受 C++ 中非常具体的规则的约束）。

然而，在到达那里之前，他们强调一定程度的一致性“......重要的不是设置规则，而是要与文件中已经使用的样式保持一致......”

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-03-20T14:44:47.497

在 C/C++ 中这种表示法的好处是可以更轻松地查看符号的类型，而无需搜索声明。这些样式出现在 Intellisense 和“Go to Definition”出现之前——我们经常不得不在不知道有多少头文件中寻找声明。在一个大型项目中，这可能是一个很大的烦恼，在查看 C 源代码时已经够糟糕了，但在使用混合的汇编+源代码和原始调用堆栈进行取证时更糟糕。

当面对这些现实时，即使有维护开销，使用 m_ 和所有其他匈牙利规则也开始变得有意义，因为在查看不熟悉的代码时只需查找符号类型就可以节省多少时间。现在我们当然有了 Intellisense 和“Go to Definition”，因此该命名约定的主要节省时间的动机不再存在。我认为这样做没有多大意义，我通常会尝试遵循 .NET 库指南，只是为了保持一致并可能获得更多的工具支持。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-03-18T19:34:09.807

如果您没有根据特定准则进行编码，则应继续使用您的实际`m_`符号，并在项目编码准则要求时更改它。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-03-18T23:02:40.427

发挥作用。

*   不要使用全局变量。
*   不要使用静态变量。
*   不要使用成员变量。

如果你真的需要，但只有你真的需要，使用一个且只有一个变量来访问你的应用程序/环境。

# perl - elsif 在 Perl 中是如何工作的？

> ID：659553
> 
> 赞同：4
> 
> 时间：2009-03-18T18:30:48.630
> 
> 标签：perl, conditional

为什么 Perl 有 'elsif' 而没有 'elseif'？

我正在做这样的事情：

```
$somevariable = 0;
if ($idcount==5) 
{
    # Do something
    if (somestatement is true) # 1 
    {
        $somevariable = 1;
    }
}
elsif ($idcount > 1 && somevariable = 0)
{
    # Do something else here
} 
```

代码永远不会出现在 elsif 语句中。在这种情况下`idcount`实际上是 5，所以它涉及到第一个 if 语句。但是内部`if`陈述（1）不正确，所以`$somevariable`仍然是 0。既然`idcount`是 5，它也应该成立，`elsif`因为`$idcount`它大于 1 并且`$somevariable`仍然是 0。

也许我只是累了，没有看到明显的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-18T18:32:55.740

不，`elsif`只有在前面的 if/elsif 条件都不为真的情况下，任何东西才有机会被执行，这就是它的“else”部分。

如果您希望两者都被评估，只需将其设为 an`if`而不是`elsif`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-18T18:55:08.823

```
elsif ($idcount > 1 && somevariable = 0) 
```

应该：

```
elsif ($idcount > 1 && $somevariable == 0) 
```

赋值运算符返回分配的值 0，等于 false，因此逻辑和 '&&' 总是失败。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-18T19:15:30.957

以下是[Llama 书](http://oreilly.com/catalog/9780596520106/ "骆驼书")如何回答 elsif 与 elseif 的问题：

> “因为拉里是这么说的。”

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-19T02:21:37.173

在任何 if-elsif-else 构造中，您只执行条件为真的第一个分支。一旦该分支执行，程序会在整个 if-elsif-else 之后继续执行。

如果你想用可能的多个分支来做某事，你可以用多个`if`块构建你自己的 case-like 语法。Perl 5.10有一个`given-when`构造，但它已退回到实验状态，可能会从语言中删除。

至于 的拼写`elsif`，涉及到几个因素。

在 C 中，你写

```
if( ... ) {
   ... }
else if ( ... ) { 
```

这有时会导致“悬空其他”问题。如果你已经开始但没有完成`if-else if`在另一个之前插入一个正确的但不同的`if`，你已经通过悬空的 else 将两者结合起来。拉里·沃尔不喜欢这样，所以他将“else if”组合成一个词，“elseif”。然而，这对拉里来说很奇怪，因为规则是“i 在 e 之前，除了 c 之后，......”，所以他通过取出“e”使其只是“elsif”来解决这个问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-18T18:38:52.467

我看不出你的困惑与 perl 使用“elsif”而不是“else if”或“elseif”这一事实有什么关系。在我曾经使用过的每一种语言中，从 1970 年代之前的 FORTRAN 到 Java，以及一路走来的诸如 Easytreive 之类的“亮点”，如果你执行“if cond ... else ...” else 之后的东西不会如果原始“cond”为真，则不会被执行。这就是“其他”的意思。

在您的情况下，“cond”是“（$idcount == 5）”，您已经说过这是真的，而因为它是真的而没有被执行的else部分是“if（$idcount> 1 && $somevariable == 0) ..."。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-19T03:32:52.620

Perl 有 elsif，因为 perl 不允许 C 风格的“else if”不带括号。相反，你需要有类似的东西：

```
if (x) {

}
else {
  if(y) {

  }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-18T18:50:39.800

Perl 中的“elsif”与其他语言中的“elseif”、“else if”和“elif”完全相同。这只是拼写的问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-18T19:41:54.390

## 这是问题中发布的内容的等价物。

```
use strict;
use warnings;

$somevariable = 0;
if ($idcount==5) 
{
  # do something
  if ( 1 )
  {
    $somevariable = 1;
  }
}
else
{
  if ($idcount > 1 && somevariable == 0) # this line was wrong in the question
  {
    # do something else here
  }
} 
```

### 或者

```
use Modern::Perl;

$somevariable = 0;
given($idcount){
  when( 5 ){
    # do something
    if ( 1 ){
      $somevariable = 1;
    }
  }
  when( $_ > 1 && $somevariable == 0 ){
    # do something else here
  }
} 
```

`use Modern::Perl;` 是相同的 `use strict;` `use warnings;` `use 5.010;`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-18T18:51:20.250

如果你要使用`if...elsif`任何语言，你的条件应该是互斥的。您的示例中的两个条件可能同时为真，因此您应该将其分解为两个单独的`if`语句。

# asp.net - Visual Studio 调试器。ASP.NET ImageButton Click 事件未触发

> ID：659564
> 
> 赞同：1
> 
> 时间：2009-03-18T18:32:32.417
> 
> 标签：asp.net, visual-studio

在调试模式下单击按钮时，页面会重新加载，但不会到达单击事件内部的断点。但是，page_load 中的断点可以正常工作。

基本上，就好像按钮的点击事件中的代码没有被执行。

我将该站点检查到源代码控制中，另一位开发人员在他的计算机上进行了尝试。点击事件在那里工作得很好，捕捉到了里面的断点。

我在我的电脑上尝试了另一个网站，它也有同样的问题。所以它是特定于我的计算机的，而不是特定于任何站点的。

是否有一些我可能错误地更改了可能导致点击事件在调试时停止工作的设置？

任何帮助，将不胜感激。

已编辑：此问题发生在我在调试器中运行的所有站点上，并且按钮不是动态创建的。

编辑：添加断点时没有任何问题的迹象。我认为这不是断点问题，我认为这是点击事件未触发的问题。我将相同的代码放在另一台开发人员机器上，并且在该机器上调试时单击事件运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T03:36:54.870

如果它特定于您的机器，并且在所有事情都失败之后，我会在 Visual Studio 上进行修复。当事情变得奇怪并且通常有效时，我不得不这样做几次。但请记住先用尽所有其他途径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T18:36:19.663

按钮是如何创建的？如果它是动态添加到页面中的，请记住这必须在加载事件*之前*完成，否则事件将不会被连接起来。这是我听到的关于这种事情的最常见的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T18:42:01.647

当您将断点放在 button_click 事件中时，它是否说“不会加载符号”或“源文件不同”？

如果是这样，您已经修改了代码文件并构建了二进制文件（与使用的站点不同）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T22:00:04.417

在我的 Page_Load 事件中，我会检查 IsPostBack 属性以确保它实际上是一个帖子而不是获取。我将验证 Controls 集合是否已填充，并且所有控件 ID 与 Request.Forms.Keys 中的 ID 匹配。

提出此建议的原因是，如果您在浏览器中有任何附加组件或花哨的代理弄乱了提交的表单并且修改了输入名称，则不会为这些控件触发事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T03:42:22.877

当我记得类似的事情时，我会采取行动：

我已将应用程序从 vs2005 升级到 vs2008，并且我的按钮代码单击在 2005 年有效，但在 2008 年，我需要在声明的末尾添加一个“句柄”限定符，如下所示：

```
Sub btnSave_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnSave.Click 
```

无论出于何种原因，2005 年的代码不需要它，但 2008 年的代码需要它，而且我隐约记得有你所描述的相同症状。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T21:12:09.647

所以看起来我测试的所有点击事件都是图像按钮，而我的本地机器上没有图像。由于某种原因，当图像丢失时，click 事件不会触发。

# python - 当作为函数调用时，将额外的查找链接添加到 easy_install 的正确方法是什么？

> ID：659575
> 
> 赞同：1
> 
> 时间：2009-03-18T18:37:52.483
> 
> 标签：python, setuptools

我需要调用 easy_install 作为从一堆服务器安装一些 Python 鸡蛋的函数。确切地说，我安装什么以及从哪里获取它是在运行时确定的：例如，我使用哪些服务器取决于计算机的地理位置。

由于我不能保证任何单个服务器始终可用，因此决定我的脚本需要检查多个服务器。有些地方有禁止的网络过滤，所以我需要检查一个 UNC 路径。其他位置需要我检查混音，如下例所示：

```
myargs = ['-vv', '-m', '-a', '-f', '//filesrver/eggs http://webserver1/python_eggs  http://webserver2/python_eggs, 'myproject==trunk-99']
setuptools.command.easy_install.main( myargs ) 
```

当我不提供 find-links 选项 (-f) 时，它似乎工作得很好（在这种情况下，它只是从 distutils.cfg 中获取默认值），当我尝试指定一个额外的 find-links 选项时，我得到的是：

```
Traceback (most recent call last):
  File
"D:\workspace\pythonscripts_trunk\javapy_egg\Scripts\test_javapy.py",
line 20, in ?
result = pyproxy.requireEgg( eggspec , True, hosts )
File
"d:\workspace\pythonscripts_trunk\javapy_egg\src\calyon\javapy\pyproxy.py", line 141, in requireEgg
pkg_resources.require(eggname)
File "d:\python24\lib\site-packages\setuptools-0.6c9-py2.4.egg\pkg_resources.
py", line 626, in require
needed = self.resolve(parse_requirements(requirements))
File "d:\python24\lib\site-packages\setuptools-0.6c9-py2.4.egg\pkg_resources.py", line 524, in resolve
raise DistributionNotFound(req)  # XXX put more info here
pkg_resources.DistributionNotFound: myproject==trunk-99 
```

有人可以确认正确的方法吗？例如，我是在参数中使用 Windows 还是 UNIX 斜杠？必须使用什么字符来分隔多个 URL？

我在 Windows32 上使用 setuptools 0.6c9

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T20:04:42.437

引用：

```
myargs = ['-vv', '-m', '-a', '-f', '//filesrver/eggs http://webserver1/python_eggs http://webserver2/python_eggs, 'myproject==trunk-99']

setuptools.command.easy_install.main( myargs ) 
```

我看到的第一个问题是您在要查看的服务器列表的末尾缺少一个单引号。

此外，通常最好用双引号将每个 URL 括起来，以确保它们每个都被解释为单个项目。

我不确定你在用这个参数做什么`'myproject==trunk-99'`，但是你上面写的方式，easy_install 将它解释为一个包名（[参见文档](http://peak.telecommunity.com/DevCenter/EasyInstall#packaging-others-projects-as-eggs)）。

您可能想要删除它，`myproject==`因为它只是在寻找项目名称，而不是布尔值或关键字参数。

另外，我认为您的意思是使用`-v`参数而不是不存在的`-vv`.

您使用空格分隔 URL/服务器列表是正确的。正斜杠适用于 Unix 和 Windows。

像这样的东西应该适合你：

```
myargs = ['-v', '-m', '-a', '-f', '"//filesrver/eggs/" "http://webserver1/python_eggs/" "http://webserver2/python_eggs/"', 'trunk-99']
setuptools.command.easy_install.main( myargs ) 
```

# c++ - 用什么替换巨大的 switch 语句？

> ID：659581
> 
> 赞同：17
> 
> 时间：2009-03-18T18:38:59.173
> 
> 标签：c++, templates, switch-statement, chain-of-responsibility

我有一个解析一些模板文件的代码，当它找到一个占位符时，它用一个值替换它。就像是：

```
<html>
<head>
    <title>%title%</title>
</head>
<body bgcolor="%color%">
...etc. 
```

在代码中，解析器找到那些，调用这个函数：

```
string getContent(const string& name)
{
    if (name == "title")
        return page->getTitle();
    else if (name == "color")
        return getBodyColor();
    ...etc.
} 
```

然后用返回值替换原来的占位符。

在实际情况下，它不是一个虚拟网页，并且可能出现许多 (50+) 个不同的占位符。

我的代码是 C++，但我猜任何语言都存在这个问题。我猜这更多是关于算法和面向对象设计的。唯一重要的是必须编译它，即使我想要我不能有任何动态/评估代码。

我虽然关于实施责任链模式，但它似乎不会改善这种情况。

更新：我也担心另一个线程中的[这个评论](https://stackoverflow.com/questions/482804/what-are-the-known-gotchas-with-regards-to-the-chain-of-responsibilty-pattern/482894#482894)。我应该关心它吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-18T18:41:46.250

使用将标签名称映射到标签处理程序的字典。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-18T18:43:55.543

你想[用 polymorphism 替换条件](http://www.refactoring.com/catalog/replaceConditionalWithPolymorphism.html)。大致：

```
string getContent(const string& name) {
    myType obj = factory.getObjForName(name);
    obj.doStuff();
} 
```

doStuff 重载的地方。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-18T18:44:31.687

你考虑过 XSLT 吗？它非常适合这种事情。我开发了一个内容管理系统，它做了完全相同的事情，并发现 XSLT 非常有效。解析器为您做了很多工作。

更新：Steven 的评论提出了一个重要的观点——如果你决定走 XSLT 路线，你会希望你的模板是有效的 XHTML。另外-我会为您的替换令牌使用不同的分隔符。不太可能自然发生的事情。我用了#!PLACEHOLDER#！在我的 CMS 中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-18T19:01:27.043

i'll combine 3 ideas:

1.  (from Steven Hugig): use a factory method that gets you a different class for each selector.
    *   (from Neil Butterworth): inside the factory, use a dictionary so you get rid of the big `switch(){}`.
    *   (mine): add a `setup()` method to each handler class, that adds itself (or a new class instance) to the dictionary.

explaining a bit:

*   make an abstract class that has a `static` dict, and methods to register an instance with a selector string.
*   on each subclass the `setup()` method registers itself with the superclass' dict
*   the factory method is little more than a dictionary read

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-18T18:44:45.133

Rather than parsing, have tried just reading the template into a string and then just performing replaces.

```
fileContents = fileContents.Replace("%title%", page->getTitle());
fileContents = fileContents.Replace("%color%", getBodyColor()); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-18T19:31:17.533

As ["Uncle" Bob Martin mentioned in a previous podacast with Joel and Jeff](http://itc.conversationsnetwork.org/shows/detail4012.html), pretty much anything you come up with is going to essentially be reproducing the big switch statement.

If you feel better implementing one of the solutions selected above, that's fine. It may make your code prettier, but under the covers, it's essentially equivalent.

The important thing is to ensure that there is only one instance of your big switch statement. Your switch statement or dictionary should determine which class handles this tag, and then subsequent determinations should be handled using polymorphism.

# jquery-ui - 如何调整 jQuery DatePicker 控件的大小

> ID：659588
> 
> 赞同：196
> 
> 时间：2009-03-18T18:40:37.673
> 
> 标签：jquery-ui

我第一次使用 jQuery DatePicker 控件。我已经让它在我的表单上工作，但它大约是我想要的两倍大，大约是 jQuery UI 页面上演示的 1.5 倍。我是否缺少一些简单的设置来控制大小？

**编辑：**我找到了一条线索，但它带来了新的问题。在 CSS 文件中，它声明组件将根据父元素的字体大小进行缩放。他们建议设置

```
body {font-size: 62.5%;} 
```

使 1em = 10px。这样做给了我一个大小合适的日期选择器，但显然它弄乱了我网站的其余部分（我目前有字体大小：.9em）。

我尝试在我的文本框周围放置一个 DIV 并设置它的字体大小，但它似乎忽略了这一点。因此，必须有某种方法通过更改其父项的字体来缩小日期选择器，但我如何在不弄乱我网站的其余部分的情况下做到这一点？

* * *

## 回答 #1

> 赞同：390
> 
> 时间：2009-03-18T21:54:31.153

您不必在 jquery-ui css 文件中更改它（如果更改默认文件可能会令人困惑），添加就足够了

```
div.ui-datepicker{
 font-size:10px;
} 
```

在 ui 文件之后加载的样式表中

如果在声明中的 ui-datepicker 之后提到了 ui-widget，则需要 div.ui-datepicker

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-08-19T16:03:25.070

我无法添加评论，所以这是参考 Keijro 接受的答案。我实际上将以下内容添加到我的样式表中：

```
 div.ui-datepicker {
    font-size: 62.5%;
} 
```

它也很有效。这可能比 10px 的绝对值更可取。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-04-22T01:32:30.090

不确定是否有人建议以下方式，如果是，请忽略我的评论。我今天对此进行了测试，它对我有用。通过在控件显示之前调整字体大小：

```
$('#event_date').datepicker({
    showButtonPanel: true,
    dateFormat: "mm/dd/yy",
    beforeShow: function(){    
           $(".ui-datepicker").css('font-size', 12) 
    }
}); 
```

使用回调函数 beforeShow

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-18T21:48:25.210

我在 ui.theme.css 中更改了以下行：

```
.ui-widget { font-family: Trebuchet MS, Tahoma, Verdana, Arial, sans-serif; font-size: 1.1em; } 
```

到：

```
.ui-widget { font-family: Trebuchet MS, Tahoma, Verdana, Arial, sans-serif; font-size: 12px; } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-12-20T20:35:25.730

添加

```
div.ui-datepicker, .ui-datepicker td{
 font-size:10px;
} 
```

在 ui 文件之后加载的样式表中。这也将调整日期项目的大小。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-06-11T16:29:31.007

对我来说，这是最简单的解决方案：我在 jquery 自定义 css 文件`font-size:62.5%;`的第一个标签中添加了 ：`.ui-datepicker`

前：

```
.ui-datepicker { width: 17em; padding: .2em .2em 0; display: none;} 
```

后：

```
.ui-datepicker { width: 17em; padding: .2em .2em 0; display: none; font-size:62.5%; } 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-07-19T20:42:49.297

我正在尝试这些示例但没有成功。显然页面上的其他样式表正在为不同的标签设置默认字体大小。如果你调整 ui-datepicker 你正在改变一个 div。如果更改 div，则需要确保该 div 的内容继承该大小。这最终对我有用：

```
<style type="text/css">
.ui-datepicker-calendar tr, .ui-datepicker-calendar td, .ui-datepicker-calendar td a, .ui-datepicker-calendar th{font-size:inherit;}
div.ui-datepicker{font-size:16px;width:inherit;height:inherit;}
.ui-datepicker-title span{font-size:16px;}
</style> 
```

祝你好运！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-05T19:21:38.843

我正在使用输入来收集和显示日历，并且能够调整我一直在使用此代码的日历的大小：

```
div.ui-datepicker, .ui-datepicker input{font-size:62.5%;} 
```

它就像一个魅力。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-07-24T08:36:46.090

`$('.ui-datepicker').css('font-size', $('.ui-datepicker').width() / 20 + 'px');`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-05-15T13:18:38.303

这对我有用，看起来很简单......

```
$(function() {
  $('#inlineDatepicker').datepicker({onSelect: showDate, defaultDate: '01/01/2010'});
});

<div style="font-size:75%";>
<div id="inlineDatepicker"></div>
</div> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-03-17T06:50:12.750

```
with out changing the css file you can also change the calendar size  by putting the the following code in to ur <head>.....</head> tag:

<head>
<meta charset="utf-8" />
<title>jQuery UI Datepicker - Icon trigger</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
<link rel="stylesheet" href="/resources/demos/style.css" />
<style type="text/css">
.ui-widget { font-family: Lucida Grande, Lucida Sans, Arial, sans-serif; font-size: 0.6em; }
</style>

<script>

$(function() {

$( "#datepicker" ).datepicker({
//font-size:10px;
 //numberOfMonths: 3,

showButtonPanel: true,
showOn: 'button',
buttonImage: "images/calendar1.gif",
buttonImageOnly: true
});
});
</script>

</head> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-07-03T23:32:30.403

我尝试了使用回调函数 beforeShow 的方法，但发现我还必须设置行高。我的版本看起来像：

```
beforeShow: function(){$j('.ui-datepicker').css({'font-size': 11, 'line-height': 1.2})} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-02-24T19:59:22.373

更改日历大小的最佳位置是在 jquery-ui.css 文件中

```
/* Component containers
----------------------------------*/
.ui-widget {
    font-family: Verdana,Arial,sans-serif;
    font-size: .7em; /* <--default is 1.1em */
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-05-07T08:41:06.073

此代码适用于日历按钮。使用“行高”会增加数字的大小。

```
/* Change Size */
<style>
    .ui-datepicker{
        font-size:16px;
        line-height: 1.3;
    }
</style> 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-08-12T11:14:23.577

您可以按如下方式更改 jquery-ui-1.10.4.custom.css

```
.ui-widget
{
    font-family: Lucida Grande,Lucida Sans,Arial,sans-serif;
    font-size: 0.6em;
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-06-02T18:58:09.183

另一种方法：

```
$('.your-container').datepicker({
    beforeShow: function(input, datepickerInstance) {
        datepickerInstance.dpDiv.css('font-size', '11px');
    }
}); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-10-20T14:15:43.080

`$('div.ui-datepicker').css({ fontSize: '12px' });`如果我们在之后调用它就可以工作 `$("#DueDate").datepicker();`

[小提琴](http://jsfiddle.net/wdncaewx/)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-11-11T22:04:50.893

Jacob Tsui 解决方案非常适合我：

```
$('#event_date').datepicker({
    showButtonPanel: true,
    dateFormat: "mm/dd/yy",
    beforeShow: function(){ 
        $(".ui-datepicker").css('font-size', 12)
    }
}); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-02-20T13:55:53.027

我们可以在默认的“ **jquery-ui.css** ”文件中进行更改，如下所示：

```
div.ui-datepicker {
font-size: 80%; 
} 
```

但是，不建议更改默认的“ **jquery-ui.css** ”文件，因为它可能已在项目的其他地方使用过。更改默认文件中的值可以更改已使用它的其他网页中的日期选择器字体。

我使用下面的代码来改变“字体大小”。我把它放在 datepicker() 被调用之后，如下所示。

```
<script>
        $(function () {
            $( "#datepicker" ).datepicker();
            $("div.ui-datepicker").css("font-size", "80%")
        });
</script> 
```

希望这可以帮助...

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-03-18T19:46:07.967

我想我找到了——我必须进入 CSS 文件并直接更改 datepicker 控件的字体大小。一旦你知道它就很明显，但一开始会感到困惑。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-09-23T19:34:53.843

打开 ui.all.css

最后放

```
@import "ui.base.css";
@import "ui.theme.css";

div.ui-datepicker {
font-size: 62.5%; 
} 
```

去 ！

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-08-25T16:43:30.523

为了让它在带有 Rails 3.1 的 Safari 5.1 中工作，我必须添加：

```
.ui-datepicker, .ui-datepicker a{
 font-size:10px;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-01-18T16:06:50.617

我让日期选择器出现在模式中，并且由于左侧的“日期显示容器”，日历部分不在视图中，所以我添加了：

```
.datepicker-date-display {
  display: none;
}

.datepicker-calendar-container {
  max-height: 21em;
}
.datepicker-day-button {
  line-height: 1.2em;
}

.datepicker-table > thead > tr > th {
  padding: 0;
} 
```

# collaborative-filtering - 开源协同过滤框架

> ID：659599
> 
> 赞同：15
> 
> 时间：2009-03-18T18:42:49.150
> 
> 标签：collaborative-filtering

我想知道是否存在任何开源框架可以帮助我在我的网站中包含以下类型的功能：

1) 如果我正在查看一个特定的产品，我想看看我可能感兴趣的其他产品。除了我正在查看的产品之外，可以通过计算例如我所在地区的其他人（或我的个人资料的任何其他特征）购买的东西来推断此信息。有点像 Amazon.com 的做法。

2) 根据个人资料推断人们之间的关系，在网站上相互互动（例如通过评论彼此的帖子），根据最常浏览的区域使用网站，共同购买的产品等。

我不是在寻找具有此功能的开源网站，而是在寻找对象模型之类的东西，我可以向其中提供有关用户及其对网站的使用的信息，包括有关关系的规则，然后在稍后向它提出问题（1 ) 和 (2) 以上。

任何指向白皮书/有关最佳方法的一般信息的指针，或任何相关链接也将真正有所帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T10:52:27.707

（我是 Taste 的开发者，现在是[Apache Mahout](http://mahout.apache.org/)的一部分）

1）你在这里真的要求两件事：a）推荐我可能喜欢的项目 b）喜欢与我目前正在看的东西相似的项目。

事实上，Mahout Taste 就是要回答 a)。它所做的一切都支持这样的系统。查看[文档](http://cwiki.apache.org/confluence/display/MAHOUT)以开始使用，并向 mahout-user@apache.org 提出任何问题。

特别是对于 1b)，Mahout 有两个答案：

如果您只对与当前项目相似的项目感兴趣，您将对`ItemSimilarity`Mahout ( `org.apache.mahout.cf.taste.similarity.ItemSimilarity`) 及其实现中的抽象感兴趣，例如`PearsonCorrelationSimilarity`. 根据一组用户项目评级，这可以告诉您任何两个项目之间的估计相似度。然后，您只需选择最相似的项目。事实上，看看 Mahout 中的 TopItems 类，它可以快速为您解决这个问题。

但是，您也可以通过计算推荐来组合 a) 和 b)，然后应用 Rescorer 实现，然后优先选择与当前查看的项目相似的项目。

2) 是的，同样，您会对`UserSimilarity`抽象、实现等感兴趣。这将根据项目评级推断相似性。然而，Mahout 并不能帮助您通过例如查看用户行为来推断这些*评级。*这是特定于域的，由您决定。

听起来令人困惑——阅读文档并随时在 mahout-user@apache.org 上跟进，我可以告诉你更多信息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-13T18:03:12.467

我正在研究同一个主题，因为我正在[开展一个项目](https://sites.google.com/a/whosyourballot.org/design/technical-notes)，以帮助人们决定如何对加州复杂的投票措施进行投票。以下是我发现的一些开源协同过滤引擎：

*   [伏谷](http://sourceforge.net/projects/vogoo/)(PHP)
*   [act_as_recommendable](http://github.com/maccman/acts_as_recommendable/tree/master) (Ruby on Rails)
*   [Mahout（以前的 Taste）](http://lucene.apache.org/mahout/)（Java）

[这里](http://www.searchenginecaffe.com/2007/03/open-source-collaborative-filtering-and.html)也有这些引擎的一个很好的概述。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T16:23:26.710

还有[Duine](http://www.duineframework.org/)框架和[OpenSlopeOne](http://code.google.com/p/openslopeone/)。但在我看来，Mahout 仍然是最好的。您可以在此处找到有关开源推荐系统的调查：

[http://girlincomputerscience.blogspot.com.br/2012/11/open-source-recommendation-systems.html](http://girlincomputerscience.blogspot.com.br/2012/11/open-source-recommendation-systems.html)

希望能帮助到你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-12T07:43:25.850

您可以[在此处找到](https://github.com/grahamjenson/list_of_recommender_systems)**推荐系统列表**

# iphone - Objective C HTML 转义/取消转义

> ID：659602
> 
> 赞同：74
> 
> 时间：2009-03-18T18:43:23.593
> 
> 标签：iphone, html, objective-c, cocoa-touch, escaping

想知道是否有一种简单的方法可以在 Objective C 中执行简单的 HTML 转义/取消转义。我想要的是类似这样的伪代码：

```
NSString *string = @"&lt;span&gt;Foo&lt;/span&gt;";
[string stringByUnescapingHTML]; 
```

哪个返回

```
<span>Foo</span> 
```

希望也能取消转义所有其他 HTML 实体，甚至 Ӓ 之类的 ASCII 代码。

Cocoa Touch/UIKit 中是否有任何方法可以做到这一点？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2010-05-16T11:02:03.357

查看我的[NSString 类别的 XMLEntities](http://github.com/mwaterfall/MWFeedParser/blob/master/Classes/NSString+XMLEntities.m)。有一些方法可以解码 XML 实体（包括所有 HTML 字符引用）、编码 XML 实体、剥离标签以及从字符串中删除换行符和空格：

```
- (NSString *)stringByStrippingTags;
- (NSString *)stringByDecodingXMLEntities; // Including all HTML character references
- (NSString *)stringByEncodingXMLEntities;
- (NSString *)stringWithNewLinesAsBRs;
- (NSString *)stringByRemovingNewLinesAndWhitespace; 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2011-03-02T05:48:47.897

[来自Google Toolbox for Mac](http://code.google.com/p/google-toolbox-for-mac/#Google_Toolbox_for_Mac)的另一个 HTML NSString 类别
尽管名称如此，但它也适用于 iOS。

[http://google-toolbox-for-mac.googlecode.com/svn/trunk/Foundation/GTMNSString+HTML.h](http://google-toolbox-for-mac.googlecode.com/svn/trunk/Foundation/GTMNSString+HTML.h)

```
/// Get a string where internal characters that are escaped for HTML are unescaped 
//
///  For example, '&amp;' becomes '&'
///  Handles &#32; and &#x32; cases as well
///
//  Returns:
//    Autoreleased NSString
//
- (NSString *)gtm_stringByUnescapingFromHTML; 
```

而且我只需要在项目中包含三个文件：header、implementation 和`GTMDefines.h`.

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-03-18T18:51:47.630

此[链接](http://discussions.apple.com/message.jspa?messageID=8064367#8064367)包含以下解决方案。Cocoa CF 具有 CFXMLCreateStringByUnescapingEntities 函数，但在 iPhone 上不可用。

```
@interface MREntitiesConverter : NSObject <NSXMLParserDelegate>{
    NSMutableString* resultString;
}

@property (nonatomic, retain) NSMutableString* resultString;

- (NSString*)convertEntitiesInString:(NSString*)s;

@end

@implementation MREntitiesConverter

@synthesize resultString;

- (id)init
{
    if([super init]) {
        resultString = [[NSMutableString alloc] init];
    }
    return self;
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)s {
        [self.resultString appendString:s];
}

- (NSString*)convertEntitiesInString:(NSString*)s {
    if (!s) {
        NSLog(@"ERROR : Parameter string is nil");
    }
    NSString* xmlStr = [NSString stringWithFormat:@"<d>%@</d>", s];
    NSData *data = [xmlStr dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];
    NSXMLParser* xmlParse = [[[NSXMLParser alloc] initWithData:data] autorelease];
    [xmlParse setDelegate:self];
    [xmlParse parse];
    return [NSString stringWithFormat:@"%@",resultString];
}

- (void)dealloc {
    [resultString release];
    [super dealloc];
}

@end 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2010-09-16T15:50:05.660

这是我所做的一个令人难以置信的组合解决方案，但是如果您想简单地转义字符串而不担心解析，请执行以下操作：

```
-(NSString *)htmlEntityDecode:(NSString *)string
    {
        string = [string stringByReplacingOccurrencesOfString:@"&quot;" withString:@"\""];
        string = [string stringByReplacingOccurrencesOfString:@"&apos;" withString:@"'"];
        string = [string stringByReplacingOccurrencesOfString:@"&lt;" withString:@"<"];
        string = [string stringByReplacingOccurrencesOfString:@"&gt;" withString:@">"];
        string = [string stringByReplacingOccurrencesOfString:@"&amp;" withString:@"&"]; // Do this last so that, e.g. @"&amp;lt;" goes to @"&lt;" not @"<"

        return string;
    } 
```

我知道这绝不是优雅的，但它可以完成工作。然后，您可以通过调用来解码元素：

```
string = [self htmlEntityDecode:string]; 
```

就像我说的，它很hacky，但它有效。如果要对字符串进行编码，只需反转 stringByReplacingOccurencesOfString 参数即可。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-02-20T07:30:50.290

在 iOS 7 中，您可以使用 NSAttributedString 的导入 HTML 功能将 HTML 实体转换为 NSString。

例如：

```
@interface NSAttributedString (HTML)
+ (instancetype)attributedStringWithHTMLString:(NSString *)htmlString;
@end

@implementation NSAttributedString (HTML)
+ (instancetype)attributedStringWithHTMLString:(NSString *)htmlString
{
    NSDictionary *options = @{ NSDocumentTypeDocumentAttribute : NSHTMLTextDocumentType,
                               NSCharacterEncodingDocumentAttribute :@(NSUTF8StringEncoding) };

    NSData *data = [htmlString dataUsingEncoding:NSUTF8StringEncoding];

    return [[NSAttributedString alloc] initWithData:data options:options documentAttributes:nil error:nil];
}

@end 
```

然后在您想要清理实体的代码中：

```
NSString *cleanString = [[NSAttributedString attributedStringWithHTMLString:question.title] string]; 
```

这可能是最简单的方法，但我不知道它的性能如何。您可能应该非常确定您的“清理”内容不包含任何`<img>`标签或类似的东西，因为此方法将在 HTML 到 NSAttributedString 转换期间下载这些图像。:)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-01-05T02:04:46.467

这是一个中和所有字符的解决方案（通过使它们成为其 unicode 值的所有 HTML 编码实体）......根据我的需要使用它（确保来自用户但放置在 webview 内部的字符串不能有任何XSS 攻击）：

界面：

```
@interface NSString (escape)
- (NSString*)stringByEncodingHTMLEntities;
@end 
```

执行：

```
@implementation NSString (escape)

- (NSString*)stringByEncodingHTMLEntities {
    // Rather then mapping each individual entity and checking if it needs to be replaced, we simply replace every character with the hex entity

    NSMutableString *resultString = [NSMutableString string];
    for(int pos = 0; pos<[self length]; pos++)
        [resultString appendFormat:@"&#x%x;",[self characterAtIndex:pos]];
    return [NSString stringWithString:resultString];
}

@end 
```

使用示例：

```
UIWebView *webView = [[UIWebView alloc] init];
NSString *userInput = @"<script>alert('This is an XSS ATTACK!');</script>";
NSString *safeInput = [userInput stringByEncodingHTMLEntities];
[webView loadHTMLString:safeInput baseURL:nil]; 
```

您的里程会有所不同。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-09-09T16:44:04.153

编码和解码 HTML 或 XML 字符串的侵入性最小且最轻量级的方法是使用[GTMNSStringHTMLAdditions CocoaPod](https://cocoapods.org/pods/GTMNSStringHTMLAdditions)。

它只是 Google Toolbox for Mac NSString 类别`GTMNSString+HTML`，去掉了对`GTMDefines.h`. 因此，您只需添加一个 .h 和一个 .m，就可以开始了。

例子：

```
#import "GTMNSString+HTML.h"

// Encoding a string with XML / HTML elements
NSString *stringToEncode = @"<TheBeat>Goes On</TheBeat>";
NSString *encodedString = [stringToEncode gtm_stringByEscapingForHTML];

// encodedString looks like this now:
// &lt;TheBeat&gt;Goes On&lt;/TheBeat&gt;

// Decoding a string with XML / HTML encoded elements
NSString *stringToDecode = @"&lt;TheBeat&gt;Goes On&lt;/TheBeat&gt;";
NSString *decodedString = [stringToDecode gtm_stringByUnescapingFromHTML];

// decodedString looks like this now:
// <TheBeat>Goes On</TheBeat> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-05-31T18:00:28.330

这是一个易于使用的 NSString 类别实现：

*   [http://code.google.com/p/qrcode-scanner-live/source/browse/trunk/iphone/Classes/NSString%2BHTML.h](http://code.google.com/p/qrcode-scanner-live/source/browse/trunk/iphone/Classes/NSString%2BHTML.h)
*   [http://code.google.com/p/qrcode-scanner-live/source/browse/trunk/iphone/Classes/NSString%2BHTML.m](http://code.google.com/p/qrcode-scanner-live/source/browse/trunk/iphone/Classes/NSString%2BHTML.m)

它远未完成，但您可以从此处添加一些缺失的实体：[http ://code.google.com/p/statz/source/browse/trunk/NSString%2BHTML.m](http://code.google.com/p/statz/source/browse/trunk/NSString%2BHTML.m)

用法：

```
#import "NSString+HTML.h"

NSString *raw = [NSString stringWithFormat:@"<div></div>"];
NSString *escaped = [raw htmlEscapedString]; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-19T05:12:52.737

上面的 MREntitiesConverter 是一个 HTML 剥离器，而不是编码器。

如果你需要一个编码器，去这里：[Encode NSString for XML/HTML](https://stackoverflow.com/questions/803676/encode-nsstring-for-xml-html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-21T01:50:05.820

MREntitiesConverter 不适用于转义格式错误的 xml。它会在一个简单的 URL 上失败：

[http://www.google.com/search?client=safari&rls=en&q=fail&ie=UTF-8&oe=UTF-8](http://www.google.com/search?client=safari&rls=en&q=fail&ie=UTF-8&oe=UTF-8)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-02-26T19:09:00.667

如果您需要生成文字，您可以考虑使用这样的工具：

[http://www.freeformatter.com/java-dotnet-escape.html#ad-output](http://www.freeformatter.com/java-dotnet-escape.html#ad-output)

为您完成工作。

另请参阅[此答案](https://stackoverflow.com/a/22050827/411401)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-11T16:28:08.363

这个最简单的解决方案是创建一个类别，如下所示：

这是该类别的头文件：

```
#import <Foundation/Foundation.h>
@interface NSString (URLEncoding)
-(NSString *)urlEncodeUsingEncoding:(NSStringEncoding)encoding;
@end 
```

这是实现：

```
#import "NSString+URLEncoding.h"
@implementation NSString (URLEncoding)
-(NSString *)urlEncodeUsingEncoding:(NSStringEncoding)encoding {
    return (NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,
               (CFStringRef)self,
               NULL,
               (CFStringRef)@"!*'\"();:@&=+$,/?%#[]% ",
               CFStringConvertNSStringEncodingToEncoding(encoding));
}
@end 
```

现在我们可以简单地做到这一点：

```
NSString *raw = @"hell & brimstone + earthly/delight";
NSString *url = [NSString stringWithFormat:@"http://example.com/example?param=%@",
            [raw urlEncodeUsingEncoding:NSUTF8Encoding]];
NSLog(url); 
```

此答案的学分转到以下网站：-

```
http://madebymany.com/blog/url-encoding-an-nsstring-on-ios 
```

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2011-02-18T10:21:55.797

为什么不直接使用？

```
NSData *data = [s dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];
NSString *result = [[[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding] autorelease];
return result; 
```

菜鸟问题，但就我而言，它有效......

* * *

## 回答 #14

> 赞同：-5
> 
> 时间：2013-09-08T19:13:56.250

> 这是我几年前发布的旧答案。我的目的不是提供一个“好的”和“受人尊敬的”解决方案，而是一个在某些情况下可能有用的“hacky”解决方案。请不要使用此解决方案，除非没有其他方法。
> 
> 实际上，它在许多情况下都可以正常工作，因为 UIWebView 正在完成所有工作。你甚至可以注入一些 javascript（这可能是危险的和/或有用的）。表现应该很糟糕，但实际上并没有那么糟糕。

还有一个必须提到的解决方案。只需创建一个`UIWebView`，加载编码的字符串并取回文本。它转义标签“<>”，还解码所有 html 实体（例如“>”），它可能在其他人不这样做的地方工作（例如使用西里尔字母）。我认为这不是最好的解决方案，但如果上述解决方案不起作用，它会很有用。

下面是一个使用 ARC 的小例子：

```
@interface YourClass() <UIWebViewDelegate>

    @property UIWebView *webView;

@end

@implementation YourClass 

- (void)someMethodWhereYouGetTheHtmlString:(NSString *)htmlString {
    self.webView = [[UIWebView alloc] init];
    NSString *htmlString = [NSString stringWithFormat:@"<html><body>%@</body></html>", self.description];
    [self.webView loadHTMLString:htmlString baseURL:nil];
    self.webView.delegate = self;
}

- (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error {
    self.webView = nil;
}

- (void)webViewDidFinishLoad:(UIWebView *)webView {
    self.webView = nil;
    NSString *escapedString = [self.webView stringByEvaluatingJavaScriptFromString:@"document.body.textContent;"];
}

- (void)webViewDidStartLoad:(UIWebView *)webView {
    // Do Nothing
}

@end 
```

# sharepoint - 在 WSS 3.0 中自定义 default.master

> ID：659611
> 
> 赞同：1
> 
> 时间：2009-03-18T18:47:27.670
> 
> 标签：sharepoint, wss

有谁知道如何为 WSS 3.0 站点自定义母版页（即 default.master）？实际上，我已经知道如何自定义母版页（即通过 SharePoint Designer 或文本编辑器），我更感兴趣的是学习如何告诉 WSS 3.0 使用我自定义的母版页。

我已经用我的自定义版本重命名了 default.master 并且可以正常工作，但是它为所有 WSS 站点设置了它。我希望能够为网站集 A 使用版本 A 的母版页，并为其他网站集使用单独的母版页。

请注意，我不是指 MOSS 2007。我已经知道如何为 MOSS 2007 设置母版页。但我似乎不知道如何为 WSS 3.0 设置它。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T18:29:36.620

您需要更改表示站点的 SPWeb 对象的 MasterUrl 属性。执行此操作的一个好方法是创建一个 SharePoint 功能，该功能在激活时设置属性，而在停用时恢复原始值。Feature.xml 可能如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Feature  Id="8651CC66-FEB1-4255-B7E9-0DFE24367DAB"
          Title="My Master Page"
          Scope="Web"              
          SolutionId="06D3B01F-0C26-457a-BFA5-A1B0BC8D4225"
          ReceiverAssembly="MyAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9e95445247029289"
          ReceiverClass="MyFeatureReceiver"
          xmlns="http://schemas.microsoft.com/sharepoint/">
  <ElementManifests>
    <ElementManifest Location="Masterpage.xml"/>
    <ElementFile Location="my.master"/>
  </ElementManifests>
  <Properties>
    <Property Key="MyMaster" Value="my.master" />
  </Properties>
</Feature> 
```

Masterpage.xml 文件将您的母版页上传到图库：

```
 <?xml version="1.0" encoding="utf-8" ?>
 <Elements xmlns="http://schemas.microsoft.com/sharepoint/">
   <Module Name="UploadMaster" Url="_catalogs/masterpage" >
     <File Url="my.master" Type="GhostableInLibrary" IgnoreIfAlreadyExists="True"/>
    </Module>
 </Elements> 
```

将此功能与包含 MyFeatureReceiver 类的 MyAssembly.dll 一起包含在 WSP 解决方案中，如下所示：

```
public class MyFeatureReceiver : SPFeatureReceiver
{
  public override void FeatureActivated(SPFeatureReceiverProperties properties)
  {
    SPWeb web = (SPWeb)properties.Feature.Parent;
    web.MasterUrl = properties.Definition.Properties["MyMaster"].Value;
    web.Update();      
  }

  public override void FeatureDeactivating(SPFeatureReceiverProperties properties)
  {
    SPWeb web = (SPWeb)properties.Feature.Parent;
    web.MasterUrl = "default.master";
    web.Update();      
  }

  public override void FeatureInstalled(SPFeatureReceiverProperties properties)
  {
  }

  public override void FeatureUninstalling(SPFeatureReceiverProperties properties)
  {
  }
} 
```

最后，部署解决方案并在您的站点上激活该功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T19:44:36.957

WSS 页面使用母版页，就像常规 Web 应用程序一样。但是，如果 MasterPageFile 属性是一个标记，则该值设置为“~default.master”。在页面的 PreInit 方法中，此标记将替换为对母版页的实际引用。

您可以将 ~default.master 的值更改为您喜欢的任何值。但更好的解决方案是做与 SharePoint 相同类型的事情。

我向我的 SharePoint 网站添加了一个 HttpHandler。该处理程序附加到 PreRequestHandlerExecute 方法，并在 SharePoint 开始呈现页面之前更改母版页文件属性的值。

在 web.config 的 httpModules 部分添加一行，如下所示：

然后创建一个这样的类：

命名空间 MyClassLibrary.Utility { 公共类 MasterPageHttpModule : IHttpModule { public void Init(HttpApplication context) { context.PreRequestHandlerExecute += new EventHandler(context_PreRequestHandlerExecute); }

```
 void context_PreRequestHandlerExecute(object sender, EventArgs e)
    {
        bool useCustomMasterPages = Convert.ToBoolean(ConfigurationManager.AppSettings["ShowCustomMasterPages"].ToString());
        if (useCustomMasterPages)
        {
            Page page = HttpContext.Current.CurrentHandler as Page;
            if (page != null)
            {
                page.PreInit += new EventHandler(page_PreInit);
            }
        }
    }

    void page_PreInit(object sender, EventArgs e)
    {
        bool useThreeColumnMaster = Convert.ToBoolean(ConfigurationManager.AppSettings["UseThreeColumnMasterOnDefaultPage"].ToString());

        try
        {
            Page page = sender as Page;
            if (page != null && SPContext.Current != null)
            {
                string url = page.Request.Url.AbsolutePath.ToLower();
                if (url.IndexOf("/public/") > -1)
                {
                    if (url.IndexOf("sitemap.aspx") == -1)
                    {
                        page.MasterPageFile = "~/_catalogs/masterpage/edge_con.master";
                    }
                    else
                    {
                        page.MasterPageFile = "";
                    }
                }
                else if (url.IndexOf("default.aspx") > -1)
                {
                    if (useThreeColumnMaster)
                    {
                        page.MasterPageFile = "~/_catalogs/masterpage/edge_con.master";
                    }
                    else
                    {
                        page.MasterPageFile = "~/_catalogs/masterpage/edge.master";
                    }
                }
                else if (url.IndexOf("sitemap.aspx") > -1)
                {
                    //
                    //  Sitemap pages should not have a master page
                    //
                    page.MasterPageFile = "";
                    page.Controls.Clear();
                }
                else if (url.IndexOf("/admin/") > -1)
                {
                    page.MasterPageFile = "~/_catalogs/masterpage/edge.master";
                }
                else if (url.IndexOf("/member/") > -1)
                {
                    page.MasterPageFile = "~/_catalogs/masterpage/edge.master";
                }
                else if (url.IndexOf("/supplier/") > -1)
                {
                    page.MasterPageFile = "~/_catalogs/masterpage/edge.master";
                }
                else if (page.MasterPageFile == "~masterurl/default.master")
                {
                    page.MasterPageFile = "~/_catalogs/masterpage/edge.master";
                }
            }
        }
        catch (Exception exception)
        {
            LogWriter logWriter = new LogWriter();
            logWriter.WriteToLog("Could  not set master page: " + exception.Message, LogType.MasterPage, DateTime.Now);
        }
    }

    public void Dispose()
    {
    }
} 
```

}

现在您正在动态选择母版页。

# c# - 在 C# 中将鼠标光标移出屏幕

> ID：659613
> 
> 赞同：1
> 
> 时间：2009-03-18T18:47:44.677
> 
> 标签：c#, wpf, windows, mouse-cursor

我有一个高度为 2000 的 wpf 窗口，实际桌面高度约为 1000。显然，大约一半的窗口不在屏幕上。即使窗口延伸到屏幕下方，鼠标也不会向下移动到该区域。我确实希望此内容不在屏幕上，并且如果鼠标位于该位置的元素上方，我希望鼠标能够在其上移动并单击元素。我不想更改我的屏幕分辨率，因为某些内容绝对必须不在屏幕上。不知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-18T18:51:24.463

光标定界不是由应用程序完成的，而是由 Windows 本身完成的。据我所知，没有办法让您的光标指向屏幕外。

您可以通过做许多游戏所做的来模拟您想要的。不要绘制 Windows 光标，在您的应用程序窗口中绘制自定义光标。强制真实光标（未绘制）停留在监视器的中心。每次用户移动真实光标时，相应地移动应用程序的光标并将真实光标重新放置到屏幕中心。

这会给您带来您想要的错觉，但我认为 WPF 无法处理此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:50:53.280

Windows 中没有离屏光标位置。我认为鼠标受屏幕分辨率的限制，即使窗口不是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T14:57:08.660

我认为这是可能的。[该程序](http://www.maxivista.com/)将允许使用辅助计算机作为额外的监视器。有几个程序可以让您知道鼠标光标所在的坐标。例如[AutoIt](http://www.autoitscript.com/site/autoit/)很容易做到这一点。

![在此处输入图像描述](https://i.stack.imgur.com/XD5bE.png)

当您安装 autoit 时，它附带了这个实用程序，可以让您知道您放置鼠标的坐标。当我进行屏幕截图时，鼠标没有出现，但我在鼠标所在的位置画了一个蓝点。注意坐标是 710, 1464。现在我的屏幕分辨率是 1200 * 1920（我的显示器是旋转的）。因此，使用 Autoit，我可以通过执行类似的操作来定位鼠标光标

![在此处输入图像描述](https://i.stack.imgur.com/Kz3Tm.png)

当我运行该 autoit 程序时，它会将鼠标移动到该位置。这个问题的答案似乎是正确的，因为我无法将鼠标向右移动超过 1200。**换句话说，执行 MouseMove(2500,800) 将导致鼠标移动到 1200,800。**现在**有趣**的部分是**我为什么能够将鼠标移动到（2500,800）！如果我使用[这个程序](http://www.maxivista.com/)**换句话说`MouseMove(2500,800)`，现在执行与 Autoit 一起工作，并且鼠标实际上移动到另一台计算机（必须运行 maxivista）。**maxivista 表明有一种方法可以将鼠标移动到屏幕分辨率之外**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T15:29:40.077

如果您查看[MaxiVista](http://www.maxivista.com/pics/screenshots/vista_devicemanager_en.gif)的屏幕截图，您会发现显示设备管理器的屏幕截图：

[设备管理器 http://www.maxivista.com/pics/screenshots/vista_devicemanager_en.gif](http://www.maxivista.com/pics/screenshots/vista_devicemanager_en.gif)

如您所见，他们*只是*编写了一个虚拟显示适配器，它提供了自己的显示大小。因此，窗口将被告知可用大小，例如 2560x1600 是可能的，并允许所有窗口和鼠标的这些边界。现在由显示驱动程序将此虚拟屏幕的右侧部分转发到当前的真实显示适配器，以便在每个物理设备上显示右侧部分。

# php - 创建一个从某个站点下载所有链接的 PHP 文件

> ID：659619
> 
> 赞同：0
> 
> 时间：2009-03-18T18:49:40.177
> 
> 标签：php, download, stream

我最近将附加组件“DownThemAll”安装到我的 Firefox 中，当我看到它下载大量 pk3 文件（开源第一人称射击游戏的地图文件）时，我想知道我是否可以用 PHP 做同样的事情。

这就是我的想法：

```
foreach(glob("http://www.someaddress.ext/path/*.pk3") as $link) {
  //do something to download...
} 
```

是的，就我所知。我想知道是否要通过流来启动下载...我真的不知道如何处理这些材料，这不是我通常用 PHP 做的，但它引发了我的兴趣。

那么有没有人知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T18:55:01.507

我会把你引向正确的方向。

[用于下载的cURL](http://is.php.net/manual/en/function.curl-exec.php)和用于获取链接中所有路径的正则表达式。

但请注意，网站上的链接可能是相对链接。所以你需要检查一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T21:50:50.850

这将做到（或至少有帮助）：

```
$pageRaw = fread_url('www.example.com');

//link extraction regex        
preg_match_all ("/a[\s]+[^>]*?href[\s]?=[\s\"\']+".
                "(.*?)[\"\']+.*?>"."([^<]+|.*?)?<\/a>/",
                $pageRaw, &$matches);

$matches = $matches[1];

foreach($matches as $link)
{    
    echo $link. '<br />';
}

//falls back to fopen if curl is not there
function fread_url($url,$ref="")
{
    if(function_exists("curl_init")){
        $ch = curl_init();
        $user_agent = "Mozilla/4.0 (compatible; MSIE 5.01; ".
                      "Windows NT 5.0)";
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_USERAGENT, $user_agent);
        curl_setopt( $ch, CURLOPT_HTTPGET, 1 );
        curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 );
        curl_setopt( $ch, CURLOPT_FOLLOWLOCATION , 1 );
        curl_setopt( $ch, CURLOPT_FOLLOWLOCATION , 1 );
        curl_setopt( $ch, CURLOPT_URL, $url );
        curl_setopt( $ch, CURLOPT_REFERER, $ref );
        curl_setopt ($ch, CURLOPT_COOKIEJAR, 'cookie.txt');
        $html = curl_exec($ch);
        curl_close($ch);
    }
    else{
        $hfile = fopen($url,"r");
        if($hfile){
            while(!feof($hfile)){
                $html.=fgets($hfile,1024);
            }
        }
    }
    return $html;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T18:54:48.747

这不是一个小问题。但是，如果您可以访问“系统”命令，则可以使用[wget](http://www.gnu.org/software/wget/manual/wget.html)来完成此任务。它提供递归下载功能来跟踪整个页面的链接，您可以控制它应该跟踪链接的深度等等。它还支持身份验证，以及包括 http 和 ftp 在内的多种协议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:31:59.373

来自 php fread 文档：

```
// For PHP 5 and up
$handle = fopen("http://www.example.com/", "rb");
$contents = stream_get_contents($handle);
fclose($handle); 
```

或者你可以使用：

```
$aaa = file_get_contents('http://www.example.com/'); 
```

所以：

1.  包含链接列表的下载页面
2.  解析链接列表（[使用正则表达式](http://www.the-art-of-web.com/php/parse-links/)）
3.  将每个链接的内容下载并写入 (fwrite) 到 HDD。

提示：检查每个函数的 php 文档，有很多很好的例子。

# reporting-services - SSRS 2005 保存报告参数

> ID：659624
> 
> 赞同：2
> 
> 时间：2009-03-18T18:50:16.183
> 
> 标签：reporting-services, reportingservices-2005

我使用 SSRS 2005 报告已经有一段时间了，我收到了一些请求，要求个人用户能够保存他们在下次运行报告时使用的参数。这可行吗？它是“我的报告”角色的一部分吗？有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T18:53:24.023

我不知道这是否可以使用报告管理器完成，但您始终可以使用 URL 参数并以这种方式传递，然后只需给他们一个链接即可将他们带到他们的报告（或将其呈现为 PDF或其他格式，如果您愿意）并且已经传入了参数。

这是一个链接，可将您带到许多有关报告[URL 访问](http://msdn.microsoft.com/en-us/library/ms153586.aspx)的 MSDN 文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T18:54:49.027

我认为您将不得不停止使用内置 UI 并构建自己的报表前端来做到这一点。我一直以这种方式使用 RS，它并没有那么复杂。

# path - 如何使用 CMD 从文件路径中获取文件夹路径

> ID：659647
> 
> 赞同：162
> 
> 时间：2009-03-18T18:56:22.347
> 
> 标签：path, cmd

我需要包含 cmd 文件的文件夹的路径。有了`%0`我可以得到文件名。但是如何获取文件夹名称？

```
c:\temp\test.cmd >> test.cmd 
```

PS我的当前目录！=脚本的文件夹。

* * *

## 回答 #1

> 赞同：331
> 
> 时间：2009-03-18T19:06:22.477

对于文件夹名称和驱动器，您可以使用：

```
echo %~dp0 
```

您可以使用不同的修饰符获得更多信息：

```
%~I         - expands %I removing any surrounding quotes (")
%~fI        - expands %I to a fully qualified path name
%~dI        - expands %I to a drive letter only
%~pI        - expands %I to a path only
%~nI        - expands %I to a file name only
%~xI        - expands %I to a file extension only
%~sI        - expanded path contains short names only
%~aI        - expands %I to file attributes of file
%~tI        - expands %I to date/time of file
%~zI        - expands %I to size of file

The modifiers can be combined to get compound results:
%~dpI       - expands %I to a drive letter and path only
%~nxI       - expands %I to a file name and extension only
%~fsI       - expands %I to a full path name with short names only 
```

这是来自“for /?”的复制粘贴 提示符下的命令。希望能帮助到你。

### 有关的

[前 10 个 DOS 批处理技巧（是的，DOS 批处理...）](http://weblogs.asp.net/jgalloway/archive/2006/11/20/top-10-dos-batch-tips-yes-dos-batch.aspx)显示了[batchparams.bat](http://gist.github.com/53402)（链接到源代码作为要点）：

```
C:\Temp>batchparams.bat c:\windows\notepad.exe
%~1     =      c:\windows\notepad.exe
%~f1     =      c:\WINDOWS\NOTEPAD.EXE
%~d1     =      c:
%~p1     =      \WINDOWS\
%~n1     =      NOTEPAD
%~x1     =      .EXE
%~s1     =      c:\WINDOWS\NOTEPAD.EXE
%~a1     =      --a------
%~t1     =      08/25/2005 01:50 AM
%~z1     =      17920
%~$PATHATH:1     =
%~dp1     =      c:\WINDOWS\
%~nx1     =      NOTEPAD.EXE
%~dp$PATH:1     =      c:\WINDOWS\
%~ftza1     =      --a------ 08/25/2005 01:50 AM 17920 c:\WINDOWS\NOTEPAD.EXE 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2012-11-08T16:48:34.623

接受的答案很有帮助，但如果您不使用传入的值，如何从路径中检索文件名并不是很明显。我能够从这个线程中解决这个问题，但如果其他人不那么幸运，这是如何完成的：

```
@echo off
setlocal enabledelayedexpansion enableextensions

set myPath=C:\Somewhere\Somewhere\SomeFile.txt
call :file_name_from_path result !myPath!
echo %result%
goto :eof

:file_name_from_path <resultVar> <pathVar>
(
    set "%~1=%~nx2"
    exit /b
)

:eof
endlocal 
```

现在该`:file_name_from_path`函数可以在任何地方使用来检索值，而不仅仅是用于传入的参数。如果参数可以以不确定的顺序传递到文件中，或者根本没有将路径传递到文件中，这将非常有用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-02-26T22:38:38.493

为了将这些分配给变量，请确保不要在等号之前或之后添加空格：

```
set filepath=%~dp1
set filename=%~nx1 
```

那么你应该没有问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-04-29T16:40:17.633

如果有人想要另一种方法......

如果它是路径中的最后一个子目录，则可以使用此单行：

```
cd "c:\directory\subdirectory\filename.exe\..\.." && dir /ad /b /s 
```

这将返回以下内容：

```
c:\directory\subdirectory 
```

.... 回退到上一个目录。/ad 只显示目录 /b 是一个裸格式列表 /s 包括所有子目录。这用于获取要打印的目录的完整路径。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-09-22T13:52:08.617

我在循环中遇到了同样的问题，我想在同一目录中提取 zip 文件，然后删除 zip 文件。问题是 7z 需要输出文件夹，所以我必须获取每个文件的文件夹路径。这是我的解决方案：

```
FOR /F "usebackq tokens=1" %%i IN (`DIR /S/B *.zip` ) DO (
  7z.exe x %%i -aoa -o%%i\..
) 
```

%%i 是完整的文件名路径，%ii\.. 只是返回父文件夹。

希望能帮助到你。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-12-04T00:59:33.770

如果 Wadih 接受的答案对您不起作用，请尝试`echo %CD%`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-29T14:50:23.490

这与一些经过编辑的示例 cmd 放在一起

```
@Echo off

Echo ********************************************************
Echo *  ZIP Folder Backup using 7Zip                        *
Echo *  Usage: Source Folder, Destination Drive Letter      *
Echo *  Source Folder will be Zipped to Destination\Backups *
Echo ********************************************************
Echo off

set year=%date:~-4,4%
set month=%date:~-10,2%
set day=%date:~-7,2%
set hour=%time:~-11,2%
set hour=%hour: =0%
set min=%time:~-8,2%

SET /P src=Source Folder to Backup: 
SET source=%src%\*
call :file_name_from_path nam %src%
SET /P destination=Backup Drive Letter:
set zipfilename=%nam%.%year%.%month%.%day%.%hour%%min%.zip
set dest="%destination%:\Backups\%zipfilename%"

set AppExePath="%ProgramFiles(x86)%\7-Zip\7z.exe"
if not exist %AppExePath% set AppExePath="%ProgramFiles%\7-Zip\7z.exe"

if not exist %AppExePath% goto notInstalled

echo Backing up %source% to %dest%

%AppExePath% a -r -tzip %dest% %source%

echo %source% backed up to %dest% is complete!

TIMEOUT 5

exit;

:file_name_from_path <resultVar> <pathVar>
(
    set "%~1=%~nx2"
    exit /b
)

:notInstalled

echo Can not find 7-Zip, please install it from:
echo  http://7-zip.org/

:end
PAUSE 
```

# java - Windows 上的 Java 堆栈跟踪

> ID：659650
> 
> 赞同：7
> 
> 时间：2009-03-18T18:58:20.547
> 
> 标签：java, jstack

我需要获取在使用 Windows 的客户端计算机上运行的 JVM 进程的堆栈跟踪。

客户端安装了 JRE，但没有安装 JDK。

我想使用 JStack，但它没有安装，我们无法在客户端机器上安装 JDK。我还尝试使用 Java Webstart Session 中的 AdaptJ 堆栈跟踪产品，但这不起作用，因为我们远程进入并收到关于不是以指定 PID 启动应用程序的会话的错误。

本质上，我想要一种在不安装 JDK 的情况下安装 JStack 的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T18:59:38.703

您可能想要使用专为此目的而设计的[SendSignal 。](http://www.latenighthacking.com/projects/2003/sendSignal/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-18T19:35:56.837

JDK 和相关工具无论是否“安装”都可以正常工作，如果您只是将其压缩并解压缩到一个临时目录，您应该能够运行 jstack。（无需修改 PATH 或 JAVA_HOME）。只要确保您使用与您的客户端运行应用程序的 JRE 对应的相同版本即可。至少在 JConsole 的情况下，如果版本不同，它似乎会大惊小怪。我不确定 jstack 的行为是否相同。

我并不是说这是理想的解决方案，只是它会起作用。我认为 jdigital 和 Eddie 的建议是更好的首选，即使这不应该像运行安装程序那样干扰现有的 java 安装，客户也可能不同意。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-24T16:23:28.183

jstack 和 jps 是 JDK 的 tools.jar 的一部分。还需要 attach.dll 将 jstack 附加到进程。

当然 tools.jar 和 attach.dll 不是 JRE 的一部分。

为了让 jstack 在没有 JDK（主要是 Windows）的系统上工作，我通常会执行以下操作。

1.  从 JDK 复制 tools.jar 和 attach.dll 并放入目标系统上的某个位置。示例：到 c:\temp\jstack
2.  编写一个 bat 脚本以使用 JRE 手动调用它。

例如，创建一个bat文件jstack.bat：

```
set JRE=c:\jrefolder
"%JRE%\bin\java" -classpath "c:\temp\jstack\tools.jar" -Djava.library.path="c:\temp\jstack" sun.tools.jstack.JStack %* 
```

同样对于 jps，创建一个包含以下内容的 jps.bat。

设置 JRE=c:\jrefolder

```
"%JRE%\bin\java" -classpath "c:\temp\jstack\tools.jar" -Djava.library.path="c:\temp\jstack" sun.tools.jps.Jps %* 
```

用法：

```
jstack.bat -l <pid> 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-18T19:05:49.017

您可以通过远程访问使用[JConsole吗？](http://java.sun.com/javase/6/docs/technotes/guides/management/jconsole.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-12T02:30:32.913

要获得仅包含 JRE 的线程转储，您需要来自相同 Java 版本的 JDK 的 tools.jar 和 attach.dll。将其安装在某处并将它们复制到 jre 中。必须是同一个版本！

如果您需要转储在系统帐户下运行的进程，您可以使用 Windows sysinternals psexec.exe 来访问该进程。将其复制到 JRE bin 或路径中的某个位置。

此批处理文件将堆栈转储写入具有日期时间文件名的文件，因此可以轻松获取和比较多个跟踪。

线程.bat

```
:: Creates a thread dump for the tomcat6.exe process 
:: saved in a timestamped filename and views it!
:: Jim Birch 20111128 rev 2015-10-12

::Required the following files to be placed in the jre/bin folder:
:: attach.dll  - From the Java JDK  (must be the same version)
:: tools.jar   - ditto
:: psexec.exe  - from Windows sysinternals

::cd to jre/bin
d:
cd \application\jre\bin

::build datetime filename
rem datetime from wmi.exe
for /f "tokens=2 delims==" %%I in ('wmic os get localdatetime /format:list') do set dt0=%%I
rem  datetime string as YYYY-MM-DD-hhmmss
set dt=%dt0:~0,4%-%dt0:~4,2%-%dt0:~6,2%-%dt0:~8,6%
set ff=td-%dt%.txt
echo filename: %ff%

::PID of the process by named exe, eg, tomcat6    
for /F "tokens=2" %%I in ('TASKLIST /NH /FI "IMAGENAME eq tomcat6.exe"' ) DO SET PID=%%I
echo pid: %PID%

::combine above with jstack command
psexec -s jstack.exe -l %PID%  >>  %ff%

:: view result
start %ff%

::insert pause to debug or timer to review script operation
::ping localhost -n 20 >nul
::pause 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-05T15:51:43.367

如果您想使用 JDK 的板载工具，并且还想拥有一个最小（即不包括复制整个 JDK）和方便（即不使用自定义调用`.bat`）的解决方案，这对我有用（尝试过Java 1.8):

创建一个空文件夹（`$DEST`如下）并将以下文件（来自 JDK `$JDK_HOME`）复制`bin`到`lib`文件夹中，如下所示：

```
Source                          -> Destination

$JDK_HOME/bin/jps.exe           -> $DEST/bin/jps.exe
$JDK_HOME/bin/jstack.exe        -> $DEST/bin/jstack.exe
$JDK_HOME/bin/jli.dll           -> $DEST/bin/jli.dll
$JDK_HOME/jre/bin/attach.dll    -> $DEST/bin/attach.dll
$JDK_HOME/lib/tools.jar         -> $DEST/lib/tools.jar 
```

然后 ZIP 并将其复制到运行兼容 JRE 的目标机器上。

您现在应该能够像从原始 JDK 中运行它们一样从该文件夹中运行`jps`它们`jstack`。`bin`

# jquery - CSS 过渡

> ID：659652
> 
> 赞同：2
> 
> 时间：2009-03-18T18:58:45.007
> 
> 标签：jquery, css, transitions

我一直在构建我的网站的 iphone 优化版本，并一直试图让动画工作/过渡工作。

我查看了 iui/ciui 等。但对于我需要的东西，它们似乎有点矫枉过正。我正在使用 jquery 并构建了大部分功能，除了我无法让 .animate 顺利工作，所以我正在尝试 css 转换。

我有一个 div，当单击 div 中的对象时，我希望 div 向左转换页面（标准 iPhone UI）。据我了解，您不能将 css 转换应用于父元素 onclick，因此我添加了一个带有 jquery 的类，并且该类中包含 css 转换。

这行得通，除了我可以开始工作的唯一 css 转换是

```
-webkit-transform: 翻译(-330px, 0);
```

而且我看不到为此添加过渡时间的方法，因此最终与.hide（）一样有效。有任何想法吗？

我真的无法弄清楚其他转换是如何工作的。喜欢

```
-webkit-transition-property：左；
  -webkit-transition-duration：4s；

```

我将如何指定左多远（实际上我是负数）。此外，这似乎不是在 add-class 上触发的。

我查看了[http://webkit.org/specs/CSSVisualEffects/CSSTransitions.html](http://webkit.org/specs/CSSVisualEffects/CSSTransitions.html)，但无法根据该文档弄清楚如何执行此操作。

谢谢皮特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T22:27:16.707

看看[Surfin 的 Safari 博客](http://webkit.org/blog/)：

*   [发表关于 CSS 动画](http://webkit.org/blog/324/css-animation-2/)的文章。

*   [发表关于 CSS 过渡](http://webkit.org/blog/138/css-animation/)的文章。

*   [发布有关 CSS 转换](http://webkit.org/blog/130/css-transforms/)的信息。

我不完全确定 iPhone 是否支持所有这些技术，但可能性很高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T21:53:15.353

你能不能只使用标准的 css 定位和可能的 jquery 动画？如果不是，也许[这](http://developer.apple.com/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html#//apple_ref/doc/uid/TP30001266-VisualEffects)有帮助？

# php - 安全的 PHP 文件上传

> ID：659657
> 
> 赞同：0
> 
> 时间：2009-03-18T19:00:46.517
> 
> 标签：php, apache, .htaccess, security, file-upload

我正在尝试在我们的新站点上开发一个文件上传模块，允许您将*任何*文件上传到我们的服务器。上传的文件被上传到`/files`，其中下面的.htaccess 防止用户执行即.php 文件：

```
<Files *.*>
ForceType applicaton/octet-stream
</Files> 
```

这会触发浏览器下载窗口（至少在 FF 和 Safari 中），但是假设文件不会使用这种方法在服务器上运行是否安全？如果没有，您将如何实施这样的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T19:02:56.650

我认为最安全的做法是限制对目录的 100% Web 访问，并有一个脚本，`download.php`通过它传递一个文件 id，然后获取适当的文件并将其输出到浏览器。但是，我很确定您所拥有的将起作用并且是安全的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T08:49:40.580

> 使用这种方法假设文件不会在服务器上运行是否安全？

有点，但这取决于您的配置中存在哪些其他指令；也许还有其他规则设置允许 PHP 文件运行。如果启用 PHP 的唯一方法是在文件类型上键入 PHP 处理程序，那应该会停止 PHP 执行。

但是，停止 PHP 执行只是您的担忧之一。如果人们上传包含活动内容的文件，例如 HTML 或 Flash——即使文件类型表明它是一张无辜的图像——他们可以通过跨站点脚本 (XSS) 控制您网站上其他用户的会话。有关此问题的一些讨论，请参阅[阻止人们通过表单上传恶意 PHP 文件。](https://stackoverflow.com/questions/602539/stop/602904#602904)

使用 Content-Disposition 始终触发下载框的“download.php”界面，再加上将文件存储在“1234.dat”等非用户提供的文件名下，更加安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T19:04:19.533

我认为你实际上想要这个：

```
<Directory /path/to/files>
    SetHandler default-handler
</Directory> 
```

您所拥有的可能在实践中有效，因为服务器默认配置为不执行任何操作，除非明确告知这样做，但它并不能真正保证不会执行任何操作。`ForceType`只是设置静态文件的内容类型（我不确定，但我怀疑它会影响可执行脚本）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T19:49:12.733

支持 Paolo 的回答，将您的文件目录移出可访问的路径。然后，您可以使用 PEAR 的[HTTP_Download](http://pear.php.net/manual/en/package.http.http-download.intro.php)模块编写 download.php 脚本来提供文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T19:11:51.137

我同意 Paolo，他的方式更安全。总是存在有人利用您的 PHP 文件来执行上传的文件的问题。不好的例子：

```
include_once("/modules/".$_GET["module"].".php"); 
```

有人经过的地方`module=../Files/exploit`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T09:23:42.433

为了获得最大的安全性，您应该使用 no-exec 标志从单独的分区挂载包含上传文件的文件夹。

# ruby - 此 Ruby 代码是否查找标识符或与它们关联的值？

> ID：659660
> 
> 赞同：1
> 
> 时间：2009-03-18T19:01:46.327
> 
> 标签：ruby, syntax, identifier

我一直试图[从一篇博客文章](http://www.randomhacks.net/articles/2007/01/20/13-ways-of-looking-at-a-ruby-symbol)中理解这个示例 Ruby 代码，该文章说它使用符号 :DEFAULT、:say 和 :@message “查找标识符”。但据我所知，它不是查找标识符，而是查找与这些标识符关联的值。我认为标识符是变量、方法等的名称。所以标识符应该是“ **DEFAULT** ”、“ **say** ”和“ **message** ”？程序的输出如下。

另外，为什么需要查找标识符？

```
class Demo
  # The stuff we'll look up.
  DEFAULT = "Hello"
  def initialize
    @message = DEFAULT
  end
  def say() @message end

  # Use symbols to look up identifiers.
  def look_up_with_symbols
    [Demo.const_get(:DEFAULT),
     method(:say),
     instance_variable_get(:@message)]
  end
end

dem = Demo.new
puts dem.look_up_with_symbols 
```

当我运行代码时，我得到这个输出：

```
Hello
#<Method: Demo#say>
Hello 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T21:17:37.840

示例代码使用符号来获取三件事：`DEFAULT`const 的值（通过 访问`:DEFAULT`）、方法对象（通过 访问`:say`）和实例变量的值（通过 访问`:@message`）。这三个对象都不是使用符号定义的，但您可以使用符号来访问它们。

It's a fairly trivial example. The larger point is that symbols can be used to refer to constants, methods, and instance variables, if for some reason you don't want to refer to them directly via their identifiers. I see this most often used in metaprogramming.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T21:12:18.667

是的，这些查找各种标识符的值。

我不确定您到底要做什么，但是如果您需要将符号 (:DEFAULT) 转换为字符串 ("DEFAULT")，请使用 to_s (:DEFAULT.to__s)。如果您想查找所有可能的标识符，则取决于您要查找的内容。

```
myobject.methods  # show a list of instance methods an object has (like "say" above)
myobject.instance_variables  # show a list of instance variables an object has (like "@message" above)
myobject.class.constants  # show a list of class level constants (like "DEFAULT" above) 
```

在调试或尝试新的 API 时，我从这些方法中获得了最大的收益。我可能在生产代码中使用这些的唯一原因是输出对象的某种自动字符串表示（XML、HTML、CSV）。

# c# - 每个程序员都制作的软件

> ID：659663
> 
> 赞同：5
> 
> 时间：2009-03-18T19:02:44.000
> 
> 标签：c#

我正在寻找一个个人项目。“每个程序员”* 都会做的一种。原因是大多数开发人员倾向于从事具有所有其他开发人员都感兴趣的特定特征的个人项目。像这样的软件：

*   错误跟踪器（制作了一个）
*   CMS（制作一个）
*   博客引擎（还没有做；不想做）
*   UI“库”和图形“引擎”（通常用于游戏开发人群）
*   密码管理程序

我想做点什么

*   乐趣
*   有趣的
*   不是特别具有挑战性（我的工作很困难——或者不够晦涩）
*   无论如何都不必是原创的
*   最好是应用程序（即不是网站）
*   不是硬核学习体验，这完全是为了在工作之外获得乐趣

话虽如此，我发现“有趣”和“具有挑战性”这两个词对开发人员的含义不一定与对其他人的含义相同（而且通常是可以互换的——我不是在寻找简单或琐碎的东西）。“学习”部分也是如此，我喜欢并希望解决问题，但我不会进入设计方法或学习全新的 API 和语言来做到这一点。

我问是因为我认为某些项目或项目类型会出于特定原因吸引开发人员。我不声称知道这些原因是什么，我也不在乎，但我确实理解它们的存在，并且作为开发人员，建议的项目很可能会吸引我。

如果有帮助，我的背景或首选媒体，无需背诵我的简历，是用于 windows/tablet pcs 的 c# 开发；xna; 数据库设计/编程；

*“每一个”，我的意思是，“很多”。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-18T19:06:42.697

您有 XNA 经验和 DB 经验。

为数据库开发一个可视化工具，该工具具有视觉吸引力并且使挖掘数据更容易。

这可以从一个简单的浏览工具开始，最终发展为一个成熟的数据库管理应用程序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-18T19:51:50.137

[如果你还没有写过，那么将Conway 的生命游戏的](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)实现拼凑起来总是一个有趣的挑战。这也是那种一旦你完成就会导致看似无休止的修补的项目（“我将再添加一个功能......”）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-18T19:10:26.133

玩图形总是很有趣，尝试编写一个程序来绘制一个谢尔宾斯基三角形。这是一个相当简单的分形生成。我曾经制作了一个屏幕保护程序，将它们绘制在屏幕上随机的位置和颜色。

如果您正在寻找更实用的东西，请尝试编写电子邮件或 RSS 客户端。学习在低级别与 SMTP/POP3 交互非常有趣。RSS 也是如此，它至少会让您接触到网络、GUI 和 XML 设计。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-18T21:56:46.780

也许写一个编译器？我认为每个艺术家/工匠都应该在某个时候学习如何构建他们的艺术或工艺工具。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-23T13:01:03.420

> 我正在寻找一个个人项目。“每个程序员”* 都会做的一种。

编写自己的脚本语言解释器怎么样？这是一件很常见的事情，通常不仅是一种高学历的体验，而且还很有趣。

一旦你完成了一些工作，你就会开始对编程有完全不同的想法，它会改变你的思维方式！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-18T19:34:51.130

为您选择的纸笔 rpg 编写一个字符生成器。

它应该能够在 2 种模式下使用：Build-A-Character（让您从头开始构建角色）和 Generate-An-NPC（根据一些指导方针，它将生成一个体面的 NPC）。

这实际上是我一直在研究的一个项目，我发现它很有趣。YMMV，尤其是如果您不经常玩游戏。

编辑 - 我想我会给出一些我觉得很有趣的理由。

1.  这是我和我的朋友们实际使用的东西
2.  它帮助我更好地理解游戏，知道什么样的决定才能成为一个好角色
3.  随机字符生成中有一些（有限的）AI（主要是带有一些随机跳跃的简单决策树）
4.  它总体上相当简单，对于一个人的开发团队来说是一个合理的项目。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-18T19:31:53.320

数独游戏（或连接四、线索等）。主要依赖于逻辑而不是人工智能（如国际象棋）的东西。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-18T20:20:44.123

光线追踪器怎么样？如果你用蛮力做所有事情，这可能非常简单。它们写起来很有趣，并且会导致许多有趣的问题。编写光线追踪器符合您的所有标准 =)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-20T14:54:04.773

我一直很喜欢写一个小物理模拟器或规范的 mandlebrot / julia 集合生成器（任何人都可以并行扩展 :)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-18T19:06:44.287

每个开发人员都是不同的。大约三年前，我在其他网站上准确地询问了您的问题。它什么也没带来，因为我们都有不同的兴趣。

也许是做一个专注于你喜欢的网站？就像大学内的一个小社区或你的其他同事？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-18T19:07:54.423

为了学习 Ruby，我最近为我在我的程序中使用的基于 XML 的自定义语言制作了一个迷你 DSL/XML 生成器。我只是将一些真实的文本转换成它的 XML 表示。这只是一个有趣的小项目，从长远来看并没有带来太多好处，但帮助我学习了这门语言。

所以...我建议尝试创建一个 DSL。这种体验实际上可以证明是无价的，因为 DSL 非常有用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-18T19:20:12.727

编写一个由人工智能虚拟生物填充的 3D 环境，在公共服务器上实现，我们都可以使用基于 WPF 的客户端访问该环境。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-18T19:21:36.747

个人“有趣”与“困难”强烈重叠，所以我有点不知所措......

...但也许您应该**对您可能有的非编程兴趣并尝试解决该领域中的一个简单问题**。

我的一个朋友曾经建立了一个模型铁路数据库，这样人们就可以跟踪他们拥有的火车。他试图卖掉它，结果并不顺利，但它既简单又有趣。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-18T20:13:05.623

为什么不自己滚动

1.  Web MVC 框架或
2.  网页模板系统或
3.  持久性框架（如果您制作 OR-mapper，则 +1）或
4.  基于拦截器的面向方面的框架

但是，哦，那是 2000 年代初期的罪过。

那么有什么云淡风轻的吗？:)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-18T21:58:02.673

尝试使用编译器/解释器时，我总是很开心。我开始在我自己的 Javascript 交互式 shell 上进行可悲的尝试（我之前没有编译器/解释器的经验或知识，只是想尝试一下）。现在我要开始从头开始编写我自己的词法分析器/解析器了。

就个人而言，我发现编译器和解释器很有趣。如果您愿意，您也可以使用它们或它们的组件作为其他项目创意的开始。此外，您可以使用您选择的任何语言与他们一起玩，因此如果您想学习或使用新语言并且不确定要专注于做什么，这可能不是一个坏的项目。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-03-18T21:42:11.153

在开始我现在的工作之前，我很开心地编写了一个音频播放器（如 winamp / WMP）来学习 .NET。有免费的库可以读取 MP3 文件（和其他音频格式），这样就可以避免复杂的部分；）

音频播放器不太复杂，适合学习线程、UI 和使用文件系统。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-18T19:33:28.747

某种GPS追踪器？我从来没有做过，但我相信很多开发者都会这样做。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-18T21:00:11.173

为与 iPhone 竞争的 Windows 移动设备编写触摸屏游戏。也许像，'Squash the Bug'之类的。小鸡喜欢那种东西。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-18T21:10:58.747

搜索一个好的 Flash 益智游戏并为它实现一个求解器 :)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-03-18T21:34:09.173

就个人而言，它基于您自己的喜好。对我来说，这是一个成绩册计划。由于我一直有老师朋友，他们总是希望我更新它。所以我先是用Pascal写的，后来想学C，所以写了一个C版本，然后是C++版本等等。

我女儿在打篮球，所以我想记分，当时我有一个掌上电脑，所以我为它写了一个小应用程序。

我的 $.02

# sharepoint - SharePoint 列表和表单

> ID：659665
> 
> 赞同：1
> 
> 时间：2009-03-18T19:03:19.303
> 
> 标签：sharepoint, forms, moss

对于专门使用 SharePoint 或 MOSS 2007 的用户。你如何处理表格？比如说你想要一个提交联系信息的表单。我还没有在生产中使用它，但我目前正在为我需要的表单创建一个列表，然后根据需要修改列表添加项目表单。我不确定这将如何转化为公共匿名用户环境。有什么建议么？

谢谢，

柯蒂斯·雪莉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T21:02:36.987

表单可以是自定义列表（添加了您自己的字段的列表）、自定义 ASPX 页面（ASP.NET 开发）到 InfoPath Forms Services（仅限 MOSS Enterprise）。

如果您不喜欢开箱即用的外观/感觉，您还可以使用列表创建自己的新表单和编辑表单（SharePoint Designer 可以帮助您解决此问题）。

如果您想防止匿名用户发送垃圾邮件，我推荐使用 CAPTCHA 方法。这里有 3 个可以看（我们最近实现了第一个）：

*   [http://nanddeepnachan.blogspot.com/2008/06/captcha-for-sharepoint-blog.html](http://nanddeepnachan.blogspot.com/2008/06/captcha-for-sharepoint-blog.html)
*   [http://blogs.msdn.com/pranab/archive/2008/12/09/sharepoint-2007-moos-wss-custom-captcha-antispam-field.aspx](http://blogs.msdn.com/pranab/archive/2008/12/09/sharepoint-2007-moos-wss-custom-captcha-antispam-field.aspx)
*   [http://captcha.biz/doc/asp.net/2.0/asp.net-captcha-sharepoint.html](http://captcha.biz/doc/asp.net/2.0/asp.net-captcha-sharepoint.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T20:20:04.220

这个问题真的很棘手。对于必须处理垃圾邮件和可用性的面向公众的网站，最好编写自定义表单。在 SharePoint 中托管自定义表单并不是一项主要内容，并且有关于[如何让代码](http://www.andrewconnell.com/blog/articles/UsingCodeBehindFilesInSharePointSites.aspx)正常工作的信息。

现在我想起来了，[SharePoint 社区工具包](http://cks.codeplex.com/CKS)不得不解决一些关于博客帖子评论的问题。

# vb.net - 我可以用常量替换 vbLf 和 Chr() 吗？

> ID：659666
> 
> 赞同：2
> 
> 时间：2009-03-18T19:04:19.470
> 
> 标签：vb.net

我们正在尝试减少在启动期间加载的程序集的数量，最容易减少的程序之一是 Microsoft.VisualBasic 程序集。里面有很多很容易替换的东西，比如 Left()，但我正在努力寻找替换 vbLf 和 Chr() 的好方法。vbCrLf 很容易用 Environment.NewLine 替换，但是我们有一些地方可以为基于 Unix 的系统生成内容，该系统只需要换行符。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-18T19:25:00.530

我需要首先指出，这可能根本没有充分的理由。所有内置 .Net 程序集（包括 Microsoft.VisualBasic.dll）始终可用于所有 .Net 程序，并且在程序中使用或不使用任何这些程序集对程序的内存占用量影响*为零。*您甚至可以毫无问题地使用 C# 程序中的 Microsoft.VisualBasic.dll。唯一可能遇到问题的情况是库的单声道实现。因此，除非您考虑在某个时候移植到单声道，否则您可能正在旋转轮子。

那说：

**铬（）：**

```
Function Chr(Byval CharCode As Integer) as Char
    Return Convert.ToChar(CharCode)
End Function 
```

**vbLf**

```
Const vbLf As Char = Chr(10) ''// of course calling your own Chr implementation 
```

这假定为 ASCII，但如果您的代码需要单行馈送，这是一个非常安全的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T19:14:13.643

~~`Public Const vbLf As String = ChrW(10)`~~

```
Public Const vbLf As String = Convert.ToChar(10) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T14:45:16.030

```
 ControlChars.Lf 
```

这是一个常数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:18:02.013

[`Chr`](http://msdn.microsoft.com/en-us/library/613dxh46.aspx)是一种相当复杂的方法（在[Reflector](http://www.red-gate.com/products/reflector/)中查看）。

在它的基础上，它使用[`Convert.ToChar()`](http://msdn.microsoft.com/en-us/library/system.convert.tochar.aspx)，但它对不同字符范围的检查和不同行为做了更多的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T19:34:31.053

假设您使用的是 VB.NET，删除对 Microsoft.VisualBasic 类的显式调用不会删除对程序集的引用。VB.NET 编译器代表您使用其中的一些函数[链接文本。](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.compilerservices.aspx)您可以使用[/vbruntime-](http://msdn.microsoft.com/en-us/library/bb531259.aspx)开关进行编译，但我不建议将它用于任何重要的应用程序。

# sql-server - ALTER TABLE 具有以编程方式确定的常量 DEFAULT 值

> ID：659669
> 
> 赞同：8
> 
> 时间：2009-03-18T19:05:20.187
> 
> 标签：sql-server, tsql, default, alter-table

我正在尝试将列（MSSQL 2005）添加到具有另一个表（部门）的主键的默认约束的表（员工）中。然后我将把这个列作为那个表的 FK。本质上，如果没有提供 DepartmentID，这将根据部门名称将新员工分配到基础部门。
这不起作用：

```
DECLARE     @ErrorVar       INT
DECLARE     @DepartmentID       INT

SELECT      @DepartmentID = DepartmentID
FROM        Department
WHERE       RealName = 'RocketScience'

ALTER TABLE     [Employee]
ADD             [DepartmentID] INT NULL
CONSTRAINT      [DepartmentIDOfAssociate] DEFAULT (@DepartmentIDAssociate)
SELECT @ErrorVar = @@Error
IF (@ErrorVar <> 0)
BEGIN
    GOTO FATAL_EXIT
END 
```

生产、测试​​和开发数据库已经不同步，DepartmentName = 'RocketScience' 的 DepartmentID 可能相同也可能不同，所以我不想只说 DEFAULT（某个数字）。无论我以哪种方式解决问题，我都会不断收到“ALTER TABLE 语句中不允许使用变量”。
这样做的正确方法是什么？我也尝试过嵌套 select 语句，它得到“在这种情况下不允许子查询。只允许标量表达式。”

此外，真正棒的是我可以在一个语句中填充列值，而不是执行

{ALTER null}
{Update values}
{ALTER not null}

步骤。我读了一些关于 WITH VALUES 命令的内容，但无法让它工作。谢谢！！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-18T21:39:30.347

接受的答案效果很好（谢谢marc_s），但在我考虑了一段时间后，我决定走另一条路。
主要是因为服务器上必须有一个函数，我认为每次添加员工时都会调用该函数。
如果后来有人弄乱了该功能，那么没有人可以进入员工，原因也不会很明显。（即使这不是真的，那么服务器上仍然有不需要存在的额外功能）

我所做的是将命令动态地组装在一个变量中，然后使用 EXECUTE 命令调用它。

不仅如此，由于我使用了带 NOT NULL 的 DEFAULT 关键字，表被重新填充，我不必运行多个命令来完成它。我碰巧找到了那个...

```
DECLARE     @ErrorVar                   INT
DECLARE     @DepartmentIDRocketScience          INT
DECLARE     @ExecuteString                  NVARCHAR(MAX)

SELECT          @DepartmentIDRocketScience = DepartmentID
FROM            Department
WHERE           RealName = 'RocketScience'

SET @ExecuteString = ''
SET @ExecuteString = @ExecuteString + 'ALTER TABLE      [Employee] '
SET @ExecuteString = @ExecuteString + 'ADD              [DepartmentID] INT NOT NULL '
SET @ExecuteString = @ExecuteString + 'CONSTRAINT       [DF_DepartmentID_RocketScienceDepartmentID] DEFAULT ' +CAST(@DepartmentIDAssociate AS NVARCHAR(MAX))
EXECUTE (@ExecuteString)
SELECT @ErrorVar = @@Error
IF (@ErrorVar <> 0)
BEGIN
    GOTO FATAL_EXIT
END 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-18T19:14:20.400

您可以将代码包装到一个存储函数中以查找您的部门 ID，并在您的 DEFAULT 约束语句中使用它：

```
CREATE FUNCTION dbo.GetDepartment()
RETURNS INT
AS
BEGIN
  DECLARE         @DepartmentID           INT

  SELECT          @DepartmentID = DepartmentID
  FROM            Department
  WHERE           RealName = 'RocketScience'

  RETURN @DepartmentID
END 
```

进而：

```
ALTER TABLE     [Employee]
ADD                     [DepartmentID] INT NULL
CONSTRAINT      [DepartmentIDOfAssociate] DEFAULT (dbo.GetDepartment()) 
```

这有帮助吗？

马克

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-20T13:40:28.747

如果在添加列后应用外键约束，则可以在更改表时使用任何值作为默认值。然后，您可以使用变量值运行更新语句。

```
ALTER TABLE Employee 
ADD DepartmentID INT NOT NULL
Default -1;

UPDATE Employee
SET Employee.DepartmentID = @DepartmentID
WHERE DepartmentID = -1;

ALTER TABLE Employee 
ADD CONSTRAINT fk_employee_to_department FOREIGN KEY (DepartmentID) 
REFERENCES Department; 
```

# css - 使用 CSS 在视口中垂直居中

> ID：659677
> 
> 赞同：19
> 
> 时间：2009-03-18T19:07:16.093
> 
> 标签：css, layout, center, viewport, styling

我希望`<div>`在视口（浏览器窗口）中垂直居中，而不使用 Javascript（仅限纯 HTML 和 CSS）。我有几个限制：

*   **`div`必须在视口中垂直居中。** 我见过的方法只支持在 another 中居中`<div>`，这不是我想要的。
*   的高度`div`是未知的。

其他约束：

*   `div`必须向右对齐。
*   `div`具有恒定的宽度。
*   `div`必须支持填充。
*   其他元素将放置在网页上。`div`充当菜单。
*   div 必须支持背景颜色/图像。

这让我接近我想要的，但不完全是：

```
#nav {
    position: fixed;
    right: 0;
    top: 50%;
} 
```

但是，导航的*顶部*在中间，而不是导航的*中间*。

是否有一些技术可以让我以`div`这些约束为中心？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2017-02-27T17:34:16.143

What's that? Taking **8 years** to get the answer to a problem is too much?

Well, better late than never!

You got *really* close to the solution. I'd do it with [`transform: translate()`](https://developer.mozilla.org/en/docs/Web/CSS/transform#translate()):

```
#nav {
    position: fixed;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
} 
```

According to [Can I use?](http://caniuse.com/#feat=transforms2d), it is supported by everything except for IE8- and Opera Mini (which, to be honest, is a pretty good support).

I'd recommend you overkill it a bit and just add all of the vendor prefixes (just to make sure!):

```
#nav {
    position: fixed;
    right: 0;
    top: 50%;

    -webkit-transform: translateY(-50%);
       -moz-transform: translateY(-50%);
        -ms-transform: translateY(-50%);
         -o-transform: translateY(-50%);
            transform: translateY(-50%);
} 
```

Here's a snippet to show it to you in action:

```
#nav {
    right: 0;
    top: 50%;
    position: fixed;
    -webkit-transform: translateY(-50%);
       -moz-transform: translateY(-50%);
        -ms-transform: translateY(-50%);
         -o-transform: translateY(-50%);
            transform: translateY(-50%);

    background-color: #ccc;
    padding: 20px;
}
```

```
<div id="nav">
    ABC<br/>
    DEFGH<br/>
    IJKLMNO<br/>
    PQRS<br/>
    TUVWXYZ
</div>
```

Hopefully it's still relevant to you! (who am I kidding, it's been *8 years*)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-02-13T12:50:08.837

您可以将其用作解决方案之一。

```
 <style>
   #containter {
     height: 100vh; //vh - viewport height
     display: flex;
     flex-direction: column;
     align-items: center; 
     justify-content: center;
   }
   #content {}
  </style>

 <div id="containter">
  <div id="content">
    any text<br>
    any height<br>
    any content, for example generated from DB<br>
    everything is vertically centered
 </div>
</div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-27T11:04:57.423

> If the item is set to `position: fixed` or `position: absolute`:
> 
> ```
> top: 50%; left: 50%; transform: translate(-50%, -50%) 
> ```
> 
> If the item is set to `position: relative`, use:
> 
> ```
> margin-top: 50%; margin-left: 50%; transform: translate(-50%, -50%) 
> ```

(More info at [the source](https://www.inflectra.com/support/knowledgebase/kb234.aspx).)

* * *

## Example:

Run the snippet and then resize this page (or rotate device). The box stays centered in the "snippet viewport".

```
.myContainer {  
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  border: 5px solid RebeccaPurple;
}

.myThing {
  width: 100px;
  height: 100px;
  background-color: CornflowerBlue;
}
```

```
<div class="myContainer">
  <div class="myThing myContents">
  </div>
</div>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:13:30.870

最简单的方法是不使用 a `div`- 将 a`table`用于一行和一个单元格。可悲的是，CSS 不支持垂直对齐，你会发现自己在墙上和天花板上编码来完成它。

我理解反对我刚才提出的语义论点——在大多数情况下，我是语义标记的支持者。但是，我也相信使用正确的工具来完成正确的工作。我相信在这种情况下最好牺牲一点纯度以获得一个可行的简单解决方案。

# asp.net - 会话和应用程序池：存储和显示图像的 ASP.NET 应用程序

> ID：659685
> 
> 赞同：0
> 
> 时间：2009-03-18T19:10:19.097
> 
> 标签：asp.net, session, image, file

我有一个 .NET 应用程序，它允许用户将图像上传到 webapp 中的目录，然后查看它们。问题是当我在 webapp 目录中上传或删除图像时会话丢失。当我添加图像时，应用程序池似乎正在被回收，而不仅仅是配置或 cs 文件。

我已经在很多教程中看到过这种技术，我想知道它是否确实适用于正确的服务器设置，或者它是否是一种完全有缺陷的技术。

如果我手动将图像添加到子目录或手动删除它，会话仍然存在。如果我通过 Visual Studio 将图像添加到子目录，则会话仍然存在，但如果我通过 Visual Studio 将其删除，则会话将丢失。

如果我将图像上传到 webapp 之外的文件夹，那么我无法在 img 标签中显示它们。

我很想听听您可能会采取什么解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T19:24:53.680

尝试将 Session 存储在状态外的进程中。您可以通过在“管理工具”的“服务”屏幕中启动“ASP.Net 状态服务”，然后在 web.config 中使用此行来执行此操作：

```
<sessionState
            mode="StateServer"
            stateConnectionString="tcpip=127.0.0.1:42424"
            cookieless="false"
            timeout="20" /> 
```

这将允许您的会话持续存在，即使您重置了 IIS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T01:21:29.410

我会检查事件日志以确保您正在做的事情不会使 AppPool 崩溃

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T19:43:39.657

您可以将图像 ID 等信息存储在 asp:HiddenField 中或作为 .Attribute[] 存储在控件中。例如，当我需要将按钮绑定到列表中的特定项目时，我会为按钮提供一个反映相关项目 ID 的属性。我将 HiddenFields 用于没有关联控件的其他信息（即帖子 ID 等）。

# wpf - 将 Nullable 值绑定到 WPF ComboBox 的问题

> ID：659688
> 
> 赞同：5
> 
> 时间：2009-03-18T19:10:46.617
> 
> 标签：wpf, combobox, data-binding

我将 WPF ComboBox 绑定到 MyEnum 类型的可为空属性？（其中 MyEnum 是枚举类型）

我正在以编程方式填充 ComboBox 项目，如下所示：

```
// The enum type being bound to 
enum MyEnum { Yes, No }

// Helper class for representing combobox listitems
// (a combination of display string and value)
class ComboItem {
  public string Display {get;set}
  public MyEnum? Value {get;set}
}

private void LoadComboBoxItems()
{
  // Make a list of items to load into the combo
  var items = new List<ComboItem> {
    new ComboItem {Value = null, Display = "Maybe"},
    new ComboItem {Value = MyEnum.Yes, Display = "Yes"},
    new ComboItem {Value = MyEnum.No, Display = "No"},};

  // Bind the combo's items to this list.
  theCombo.ItemsSource = items;
  theCombo.DisplayMemberPath = "Display";
  theCombo.SelectedValuePath = "Value";
} 
```

同样在代码隐藏中，我将 DataContext 设置为一个类的实例，该类的属性名为 MyEnum? 类型的 TheNullableProperty（无论如何都用于此示例）。

TheCombo 的 SelectedValue 的绑定在我的 XAML 文件中完成。

```
<ComboBox 
  Name="theCombo" 
  SelectedValue="{Binding Path=TheNullableProperty,
                          UpdateSourceTrigger=PropertyChanged}"/> 
```

**问题：**

当绑定属性的值最初为非空时，组合框会正确显示该值。

但是当绑定属性的值最初为 null 时，组合框是空白的。

看起来数据绑定的每个方面都在工作，除了第一次显示组合框时空值的表示。

例如：您可以从下拉列表中选择 Maybe，并且绑定属性正确设置为 null。只是初始加载失败了。也许我最初需要手动设置 SelectedValue ......

# 我最终做了什么

*   通过将可空枚举转换为字符串（enum.ToString 或“null”）的转换器，将隐藏的文本块数据绑定到底层可空枚举值。
*   使用“ComboItems”加载组合框，每个“ComboItems”都有一个字符串标签（显示在组合中）和一个字符串值，该值等于作为字符串的枚举值（空值是“null”）。
*   将组合框数据绑定到文本块。

    ```
    /// <summary>
    /// Convert from EnumeratedType? to string (null->"null", enum values->ToString)
    /// </summary>
    public class EnumConverter<T> : IValueConverter where T:struct 
    {
      public static string To(T? c)
      {
        if (c == null)
          return "null";
        return c.ToString();
      }

      public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
      {
        return To((T?)value);
      }

      public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
      {
        var s = (string) value;
        if (s == "null")
          return null;
        return (T?)Enum.Parse(typeof(T), s);
      }
    }

    public class MyEnumConverter : EnumConverter<MyEnum>
    {
    }

    public class ComboItem
    {
      public string Value { get; set; }
      public string Label { get; set; }

      public ComboItem(MyEnum? e, string label)
      {
        Value = MyEnumConverter.To(e);
        Label = label;
      }
    }

    static IEnumerable<ComboItem> GetItems()
    {
      yield return new ComboItem(null, "maybe");
      yield return new ComboItem(MyEnum.Yes, "yup");
      yield return new ComboItem(MyEnum.No, "nope");
    }

    private void SetupComboBox()
    {
      thecombo.ItemsSource = GetItems().ToList();
    } 
    ```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-21T20:23:21.260

您不能在 WPF（至少 3.5 SP1）中设计绑定到空值。这意味着在 Source 获取 Null 作为值时，您的 Binding 将自动中断并且即使您为 Source 指定了有效值也不会工作。您需要通过值转换器为您的绑定提供一些“心跳”机制。因此，转换器将空值转换为目标的某个“未定义”（非空），并且能够将您的“未定义”转换回空值......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T19:51:47.440

**让null**`ComboBox`成为or的有效值似乎有很多问题，因为[这里](https://stackoverflow.com/questions/659688/problem-with-binding-nullable-value-to-wpf-combobox)、[这里](https://stackoverflow.com/questions/518579/why-cant-i-select-a-null-value-in-a-combobox)和[这里](https://stackoverflow.com/questions/422078/datatemplate-with-targetnullvalue-in-a-listbox)`ListBox`都提出了类似的问题。

对于其中任何一个，都没有一个绝妙的、杀死食人魔的答案。

我自己的建议是添加`Maybe`为`MyEnum`. 我知道这只是一个例子，但是如果所有带有 a 的东西都可以为`MyEnum`空，那么也许`MyEnum`应该有一个`Undefined`成员（或类似的东西），无论如何这在枚举中很常见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-23T23:43:26.993

我在网上找到了这个解决方案，我认为这很漂亮。我不完全理解实现——这是一些非常严肃的 .NET 功夫——但从我作为用户的角度来看，它很棒。试试看：

[http://philondotnet.wordpress.com/2009/09/18/how-to-select-null-none-in-a-combobox-listbox-listview/](http://philondotnet.wordpress.com/2009/09/18/how-to-select-null-none-in-a-combobox-listbox-listview/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-19T17:00:26.407

[DependencyProperty.UnsetValue 字段](http://msdn.microsoft.com/en-us/library/system.windows.dependencyproperty.unsetvalue.aspx)

```
using System;

using System.Globalization;
using System.Windows;
using System.Windows.Data;

namespace MyConverters
{
  [ValueConversion(typeof(DateTime), typeof(String))]
  public class StringToIntConverter : IValueConverter
  {
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
      int number;

      return int.TryParse(value.ToString(), out number) ? number : DependencyProperty.UnsetValue;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
      return value.ToString();
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-26T15:55:35.173

这是这个问题的一个非常简单的解决方案：

不要在 ItemsSource 中使用值为 null 的项目，而是使用 DbNull.Value 作为项目或项目的 value 属性。

我在这里详细描述了这种方法：[https ://stackoverflow.com/a/44170898/6713814](https://stackoverflow.com/a/44170898/6713814)

# javascript - 重新排序项目算法

> ID：659692
> 
> 赞同：2
> 
> 时间：2009-03-18T19:12:20.403
> 
> 标签：javascript, html, reorderlist

因此，我有一个 html 表：

```
up | dn
[ ]  Item 1
[x]  Item 2
[ ]  Item 3
[ ]  Item 4
[x]  Item 5
[ ]  Item 6
[ ]  Item 7 
```

如果选中 2 & 5 并单击向上，结果是：

```
up | dn
[x]  Item 2
[x]  Item 5
[ ]  Item 1
[ ]  Item 3
[ ]  Item 4
[ ]  Item 6
[ ]  Item 7 
```

如果我点击 dn，结果是：

```
up | dn
[ ]  Item 1
[ ]  Item 3
[ ]  Item 4
[ ]  Item 6
[x]  Item 2
[x]  Item 5
[ ]  Item 7 
```

换句话说，项目按所选方向分组，然后沿该方向移动一行。有人有一个很好的算法吗？我确信我可以毫不费力地写一些东西，但它似乎应该是“在那里”的那种东西......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T19:29:48.413

我认为我倾向于使用剪切和粘贴的方法，因为 js 框架使得移动 DOM 片段相对容易。

*   获取检查项目的行
*   获取 {top} 最多检查项目的索引
*   删除行并将它们插入到 {index-1} 的表中
*   （当然顶部可能是底部，并且 index-1 更复杂，具体取决于方向以及我们是否已经处于极端）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T19:21:10.553

这看起来像是一个多键排序任务。您可以使用[jQuery UI 的 Sortable](http://jqueryui.com/demos/sortable/)界面之类的东西。您的排序条件类似于：a.selected <=> b.selected && a.index <=> b.index。

忽略：*您想使用[Fisher Yates Shuffle algorithm](http://en.wikipedia.org/wiki/Knuth_shuffle)。*

# java - 序列化 C 结构以由 Java 等反序列化的最佳方法

> ID：659693
> 
> 赞同：6
> 
> 时间：2009-03-18T19:12:34.147
> 
> 标签：java, c, xml, serialization

目前，我正在使用 fread()/fwrite() 将 C/C++ 结构中的一些数据保存并加载到文件中。这在这个 C 应用程序中工作时工作得很好（每当结构更改以将 sizeof() 参数更新为 fread()/fwrite() 时，我都可以重新编译），但是如何在不事先知道的情况下将该文件加载到其他程序中C结构的sizeof()s？

特别是，我编写了另一个 Java 应用程序，它可以可视化该 C 结构二进制文件中包含的数据，但我想要一个关于如何读取该二进制文件的通用解决方案。（每当 C 结构发生变化时，我都不必手动将 sizeof()s 放入 Java 应用程序源代码中......）

我正在考虑序列化为某种文本或 XML，但我不确定从哪里开始（如何在 C 中序列化，然后如何在 Java 和未来可能的其他语言中反序列化），如果那样建议在这里结构的一个成员是一个浮点数组，它可以以二进制格式上升约 50 MB（我有数百个这样的数据文件要读取和写入）。

C 结构很简单（没有严重的嵌套或指针引用），如下所示：

```
struct MyStructure {
    char *title;
    int id;
    int param1;
    int param2;
    float *data;
} 
```

最容易变化的部分是参数整数。

我在这里有什么选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-18T19:19:02.073

[您可以使用javadoc 中详细描述的](http://docs.oracle.com/javase/7/docs/api/index.html?java/io/DataInput.html)Java 的 DataInput/DataOutput 格式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-18T19:22:19.897

如果您可以控制这两个代码库，则应考虑使用[Protocol Buffers](http://code.google.com/apis/protocolbuffers/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-18T23:08:46.030

看看 JSON。[http://www.json.org](http://www.json.org)。如果你从 javascript 开始，这将是一个很大的帮助。我不知道java支持有多好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T19:27:06.453

如果您的结构不会改变（很多），并且您的数据格式非常一致，您可以将值写入 CSV 文件或其他一些普通格式。

这可以在 Java 中轻松读取，您不必担心序列化为 XML。有时走简单是最简单的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T20:08:35.230

看看[Resin 的 Hessian/Burlap 服务](http://hessian.caucho.com)。您可能不需要整个服务，只需要 API 的一部分和对有线协议的理解。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-18T23:49:15.323

如果：

*   您的数据本质上是一大堆浮点数；
*   您能够在每一端将运行的所有可能环境（=机器/OS/C编译器的组合）中测试写入/读取过程；
*   性能很重要。

那么我可能会继续以你正在做的方式从 C 中写入数据（可能会稍作修改——见下文），然后将问题转化为你如何从 Java 中读取数据。

要从 Java 中读回数据，请使用[ByteBuffer](http://www.javamex.com/tutorials/io/bytebuffer_reading_writing.shtml)。从本质上讲，从数据中提取字节块，在它们周围包装一个 ByteBuffer，然后使用 get()、getFloat()、getInt() 等方法。NIO 包还具有“包装”缓冲区，例如 FloatBuffer，从我所做的测试来看，它在读取大量相同类型的数据时似乎要[快 20% 。](http://www.javamex.com/tutorials/io/nio_buffer_performance.shtml)

现在，您必须注意的一件事是字节顺序。在 Java 中，您需要在开始读取数据之前在缓冲区上调用 order(ByteOrder.LITTLE _ ENDIAN) 或 order(ByteOrder.BIG _ ENDIAN)。要决定使用哪一个，我建议在流的最开始，写入一些已知的 16 字节值（例如 255 = 0x00ff）。然后从 Java 中取出这两个字节并检查顺序（0xff、0x00 或 0x00、0xff）以查看您是小端还是大端。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-18T19:21:21.660

一种可能性是创建带有标题、ID、参数等的小型 XML 文件，然后*引用*（通过文件名）包含浮动数据的位置。假设浮点数据没有什么特别之处，并且 Java 和 C 使用相同的浮点格式，您可以使用DataInputStream 的[readFloat](http://java.sun.com/javase/6/docs/api/java/io/DataInputStream.html) [()](http://java.sun.com/javase/6/docs/api/java/io/DataInputStream.html#readFloat())读取该文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-18T20:18:59.480

我喜欢 CSV 和“协议缓冲区”的答案（不过，就我所知，协议缓冲区可能与 YAML 非常相似）。

如果您需要紧密打包的大量数据记录，您可以考虑这样做：

创建描述当前文件结构的文本文件头：记录大小（类型????）和字段名称/大小。读取并解析标头，然后使用低级别的二进制 I/O 操作来加载每个记录的字段，呃，对象的属性或我们今年所说的任何内容。

这使您能够稍微更改结构并使其具有自我描述性，同时仍允许您在比 XML 允许的更小的空间中打包大量内容。

TMTOWTDI，我猜。

# asp.net-mvc - ASP.Net MVC 路由和 PreRequestHandler

> ID：659694
> 
> 赞同：1
> 
> 时间：2009-03-18T19:12:42.370
> 
> 标签：asp.net-mvc, routing, prerequesthandler

我正在尝试在 Application_PreRequestHandlerExecute() 方法中实例化服务并验证当前用户，然后在 global.asax.cs 类的* Application_PostRequestHandlerExecute() 方法中处理此服务。我在此过程中需要的一项是 orgname，它附加在我的 url 路由的开头。我已经映射了一条看起来像这样的路线“{orgName}/{controller}/{action}/{id}”

所以我的问题是，在 ASP.Net MVC 应用程序中，是否可以在 Application_PreRequestHandlerExecute() 事件中访问任何路由信息（或以某种方式访问​​我的实例中的“orgname”）？如果这是不可能的，是否有其他方法可以连接到 MvcHandler 并做类似的事情（也许我应该构建一个自定义过滤器？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T21:04:36.173

您需要“RequestContext”来查找所有路由值。除了在控制器内部，我不知道有任何其他方法可以获取它们。

你应该实现一个“ActionFilterAttribute”，然后用它装饰你的控制器。

ActionFilter 有方法

```
//     Called after the action method executes.
public virtual void OnActionExecuted(ActionExecutedContext filterContext);
//     Called before the action method executes.
public virtual void OnActionExecuting(ActionExecutingContext filterContext); 
```

你可以在里面做各种有趣的事情。

# jsp - 防止页面显示

> ID：659704
> 
> 赞同：0
> 
> 时间：2009-03-18T19:16:05.247
> 
> 标签：jsp

我有一个 jsp 页面 login.jsp，它检查用户名和密码，并在提交时转发到另一个页面 display.jsp。我需要做的就是当我在浏览器中点击退格键或后退按钮时，我应该显示相同的 display.jsp 而不是返回到 login.jsp。请帮助我任何想法和代码片段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T19:28:31.817

下面是一些您可以放入 login.jsp 的代码，如果用户已经登录，它将强制重定向到您的显示 JSP。您只需填写测试和要重定向到的 URL。

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>

<%-- If user is not logged in or is not an admin, dispatch to the login page --%>
<c:if test="${some test for 'user is logged in'}">
  <c:redirect url="/display/jsp/path.jsp"/>
</c:if> 
```

# perl - 您如何在 Perl 中标记/标记/拆分分隔字符串？

> ID：659705
> 
> 赞同：13
> 
> 时间：2009-03-18T19:16:25.463
> 
> 标签：perl, split, token

您如何将字符串（例如“a:b:c:d”）拆分为标记以便在 Perl 中进行解析？

（例如使用拆分？）

最重要的是寻找清晰，直接的答案（但之后添加任何有趣的信息花絮）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-18T19:20:33.287

是的，[分裂](https://perldoc.perl.org/functions/split.html)是你想要的。

```
@tokens = split(/:/, "a:b:c:d");
foreach my $token (@tokens) {
    ....
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-18T19:18:26.160

您可以使用拆分。您也可以将它与正则表达式一起使用。

```
 my @tokens = split(/:/,$string); 
```

对于更高级的解析，我推荐[Parse::RecDescent](http://search.cpan.org/dist/Parse-RecDescent/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-19T10:55:35.863

还可以通过在命令行提示符下键入来查看 perl 附带的文档：

```
perldoc -f split 
```

要搜索常见问题，请使用

```
perldoc -q split 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-18T19:19:19.343

如果你有：

```
$a = "a:b:c:d";
@b = split /:/, $a; 
```

然后你得到：

```
@b = ("a", "b", "c", "d") 
```

一般来说，这就是 split 的工作方式：

```
split /PATTERN/,EXPR 
```

哪里`PATTERN`可以有很多正则表达式。您不仅限于简单的标记，例如 ' `:`'

# ruby - 你知道我可以在应用程序中使用的任何 ruby 词法分析器吗？

> ID：659706
> 
> 赞同：3
> 
> 时间：2009-03-18T19:17:47.303
> 
> 标签：ruby, parsing

我需要尽可能多的编程语言的词法分析器，而且我需要用 ruby​​ 编写它们。你知道任何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T21:06:38.397

[RACC](http://i.loveruby.net/en/projects/racc/)对您有用吗？

您可以将它与[REX](http://raa.ruby-lang.org/project/rex/)结合以生成您的词法分析器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-24T18:03:27.613

RACC 不是词法分析器。它是一个解析器生成器。REX 是一个词法分析器，它是现成的，它是 lex 的 ruby​​ 实现。

还有另一个用于 ruby​​ 的词法分析器。我认为它被称为 ruby​​-lex。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T12:21:15.413

这可能不适合你，但我可以建议你看看[Pygments](http://pygments.org/) for Python 吗？我知道它可能超出了您的问题范围，但是该工具支持[大量语言](http://pygments.org/languages/)，并且它提供了一个命令行工具，因此您可以从 Ruby 中调用它。

Albino 是一个小型 Rub​​y 包装器，用于使用来自 Ruby 的 Pygments：http: [//gist.github.com/82824](http://gist.github.com/82824)

# algorithm - 简单文件的事务实现

> ID：659710
> 
> 赞同：1
> 
> 时间：2009-03-18T19:18:48.500
> 
> 标签：algorithm, database-design, transactions

我是为嵌入式系统编写应用程序的团队的一员。该应用程序经常遭受由电力短缺引起的数据损坏。我认为实施某种交易会阻止这种情况的发生。一种情况包括在写入一些额外的存储（事务日志）之前复制文件的区域。其他的可能性是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T01:37:17.623

数据库使用多种技术来确保正确地保存状态。

1.  DBMS 通常保留一个复制的控制文​​件——多个设备上的多个同步副本。两个就够了。更多，如果你是偏执狂。控制文件提供了一些用于定位其他文件及其预期状态的关键参数。控制文件可以包括“数据库版本号”。

2.  每个文件都有多种形式的“版本号”。很多时候，它是纯格式加上一些异或补码，因此可以简单地检查两个版本号是否具有正确的关系，并匹配控制文件的版本号。

3.  所有事务都写入事务日志。然后将事务日志写入数据库文件。

4.  在写入数据库文件之前，原始数据块被复制到“前映像日志”或回滚段，或类似的。

5.  当块被写入文件时，序列号被更新，块被从事务日志中删除。

您可以阅读有关可靠性的 RDBMS 技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T10:11:47.597

有很多方法可以做到这一点；通常唯一需要的假设是小写（<4k）是原子的。例如，下面是 CouchDB 的做法：

*   一个 4k 标头包含 BTree 根的文件偏移量，其中包含所有数据。
*   该文件是仅附加的。当需要更新时，将更新写入文件末尾，然后是任何修改过的 BTree 节点，直到并包括根。然后，刷新数据，将根节点的新地址写入头部。

如果程序在写入更新时但在写入标头之前终止，则文件末尾的额外数据将被丢弃。如果写入头部后失败，则写入完成，一切正常。因为该文件是仅附加的，所以这些是唯一的失败场景。这还具有提供无读锁的多版本并发控制的优点。

当文件过长时，只需读出所有“实时”数据并将其写入新文件，然后删除原始文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-11T17:26:12.133

您可以通过使用文件系统周围的现有事务管理器（例如[XADisk](http://xadisk.java.net/) ）来避免自己实现此类事务日志。

旧链接不再可用，[这里](https://github.com/avh4/xadisk)有一个 github repo 。

# user-interface - 同一订单中的多个付款选项

> ID：659714
> 
> 赞同：1
> 
> 时间：2009-03-18T19:19:58.217
> 
> 标签：user-interface, user-experience

我要求能够在同一个订单中接受不同形式的付款 - 即不仅仅是通常的信用卡或贝宝用于整个事情，但也许贝宝用于一件物品，检查另一件。我知道这听起来很疯狂，但这个要求有充分的商业理由，所以我不能只是推后。

目前我能想到的实现它的最佳方式是拥有一个中心页面，您可以在其中通过打开新窗口为每个付款“启动”多个流程。我想不出一种在线性流程中执行此操作的方法，例如，您不能保证用户会从贝宝回来，因此您将完全失去该用户。

是否有任何人都可以想到的更简洁的方法，或者任何人都可以向我指出一个网站的例子，该网站做了类似的事情以获得灵感？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T13:39:55.947

就个人而言，我会这样做：

1.  让用户以通常的方式填满他们的篮子
2.  允许他们将付款类型和金额添加到列表中（几乎是第二个篮子）
3.  当篮子中的付款余额时，开始处理付款
4.  对于外部站点，请尝试使用顶部有进度指示器的框架。

在理想世界中，它不会是线性的。但是很多用户可能会丢失生成的窗口，或者对并行性感到困惑。

最好坚持已建立的 IxD 原则并依赖良好的反馈。从一开始就赋予用户控制权并保持透明。

最后，以最直接的方式（例如贝宝）开始支付流程，以减少用户放弃。（COD 应该排在最后！）

希望这可以帮助，

汤姆

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T19:31:20.530

即使同时打开多个窗口，也不能保证用户将完成所有支付方式。因此，您很可能会失去一些用户或付款。请务必发送自动电子邮件跟进以减少此问题。电子邮件可能包含指向您的支付提供商的链接，以便轻松访问其未完成的支付操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T19:32:08.093

这是一个难题，但是您必须为多少个支付处理器去异地？应该只是贝宝。

无论如何，我会在一页上为用户提供所有付款选项，并让他们填写每个处理器或付款类型的金额。然后下一页将列出他们选择的那些、每个的金额，以及“完成此付款”的链接。

该链接将在新窗口中打开。

您必须拥有良好的后端和 javascript，以及用户警告，以便在处理每次付款时更新付款页面。考虑使用弹出对话框来显示付款已完成，或者订单已闲置超过 10-30 分钟而未完成付款。

此外，考虑发送电子邮件并让用户通过电子邮件中的链接完成付款。每次付款完成时发送一封新电子邮件，如果所有付款都已完成并且订单正在推进，则发送最后一封电子邮件。

对于需要剩余付款的未完成订单，一小时后发送一封电子邮件，一天后发送电子邮件，这也使他们可以选择为剩余部分选择不同的付款方式。

电子邮件不是最好的（由于改变主意而失去更多订单），但它对您正在考虑的交易类型有好处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:21:59.740

如果可能，只需根据用户的付款选择将您的订单分成单独的较小订单。

并且不要线性地这样做。如果有的话，您可以在单独的窗口中打开每个支付处理器，以便您保持存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-08T23:54:52.227

我会采取一种方法，将整个订单分解为每种必要付款方式的子订单。您可以加载 PayPal 部分、支票部分等并单独处理它们。对用户而言，了解他们的每种支付方式收取的费用很重要，因此在这种情况下，将整个订单按支付方式细分（而不是显示为统一订单）是有意义的。

如果总是强制使用任何付款方式的某个项目子集，那么实施将是最容易的。如果这因用户而异，或者当订单达到一定数量时，情况可能会变得更加复杂。你能更具体地说明你的方法吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-06T16:48:21.903

# 处理多笔订单付款

1.  为用户提供使用您的任何付款类型为待处理订单付款的选项。
2.  让用户指定一个 ( `Amount`<= `[Order Total]`- `[Payments Received]`)，如果这是您的要求的一部分。
3.  如果在您处理完付款后订单仍处于待处理状态（请参阅下文），请将它们带回第 1 步进行冲洗并重复。

## 如何存储和处理每笔付款：

使用`Payments`表存储所有订单付款，`PaymentMethod`used 及其`Amount`及其`CurrencyCode`.

1.  收到订单付款后，将付款存储起来，并将**所有收到的金额加总并转换为您的基础**货币**`[Payments Received]`**。
2.  如果**`[Payments Received]`>=`[Order Total]`**，将订单标记为已**付款**。或者，如果处理双重换算的外汇汇率，请检查它是否*在足够小的保证金范围内正确*，例如 0.5%。
3.  或者，将任何多付的款项转换为客户的预付信用。

# java - 测试失败时，Selenium 无法杀死浏览器

> ID：659715
> 
> 赞同：1
> 
> 时间：2009-03-18T19:20:10.307
> 
> 标签：java, firefox, browser, junit, selenium

在测试失败的情况下，如何设置 Selenium 以终止测试浏览器页面？

目前，当运行 Selenium 测试用例并且测试失败时，浏览器页面保持打开状态，当大量测试失败时会导致问题。有趣的是，当测试通过时，情况并非如此。

有什么建议吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T01:24:31.100

你当然应该调用 selenium.stop() :) 听起来你需要一个 try/finally 块

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T05:40:10.380

无论如何，根据我的经验，它并不是那么简单（我是 selenium 和 JUnit 的新手）。这取决于故障是如何发生的以及您如何处理它。JUnit 应该在测试失败时自动调用 tearDown() ，并且 selenium.stop() 应该在其中。但是，有时不会调用 tearDown()，例如当 setUp() 中发生错误时，或者在发生故障时您正在做一些事情。

# encoding - url-safe 和 filename-safe base64 的最佳候选填充字符是什么？

> ID：659717
> 
> 赞同：1
> 
> 时间：2009-03-18T19:20:28.963
> 
> 标签：encoding, base64, padding

官方 base64 的填充字符是 '='，在 URL 中使用时可能需要进行百分比编码。我正在尝试找到最好的填充字符，以便我的编码字符串既可以是 url 安全的（我将使用编码的字符串作为参数值，例如 id=encodedString）和文件名安全的（我将使用编码的字符串直接作为文件名）。

点 ('.') 是一个受欢迎的候选者，它是 url 安全的，但它并不完全是文件名安全的：[Windows 不允许文件名以尾随 dot 结尾](http://msdn.microsoft.com/en-us/library/aa365247.aspx)。

'！' 似乎是一个可行的选择，虽然我用谷歌搜索过，我从未见过有人将它用作填充字符。有任何想法吗？谢谢！

**更新**：我已经在我的自定义 base64 编码中将“+”替换为“-”（减号）并将“/”替换为“_”（下划线），因此“-”或“_”不再可用于填充字符.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T22:41:41.423

最好的解决方案（我上个月在一个电子邮件发送网站上解决了这个问题）是根本不使用填充字符 (=)

存在填充字符的唯一原因是因为“懒惰”的解码器。您可以非常轻松地添加缺少的 = -> 只需在文本上执行 %4 并从 4 中减去您得到的数字，这就是您需要在字符串结尾添加多少 =。这是C#代码：

```
 var pad = 4 - (text.Length % 4);
    if (pad < 4)
        text = text.PadRight(text.Length + pad, '='); 
```

此外，大多数这样做的人都对用其他 URL 安全字符替换 + 和 / 感兴趣......我建议：

*   替换为 - / 替换为 _

不使用 。因为它会在不同的系统/Web 服务器上产生疯狂的结果（例如，在 IIS Base64 编码的字符串不能以 . 结尾或 IIS 将搜索文件）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T19:26:28.200

URI 中的[RFC 2396](http://www.ietf.org/rfc/rfc2396.txt)未保留字符是：

```
"-" | "_" | "." | "!" | "~" | "*" | "'" | "(" | ")" 
```

不过，值得指出的是，微软的文章还说“不要假设区分大小写”。也许你应该坚持以 16 或 32 为基数？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-06T14:54:06.587

维基[百科](http://en.wikipedia.org/wiki/Base64#URL_applications)文章指出；

> 存在用于 URL 变体的修改后的 Base64，其中不会使用填充“=”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:22:36.870

我会选择 '-' 或 '_'
它们是 URL 和文件安全的，它们看起来或多或少像填充

# apache-flex - 我应该将我的 .txt 文件保存在哪里以包含在 Flex 应用程序中？

> ID：659722
> 
> 赞同：0
> 
> 时间：2009-03-18T19:21:30.740
> 
> 标签：apache-flex, actionscript-3

我正在开发一个 flex 应用程序，到目前为止我有 Flash 和 AS3 的经验。我有需要使用 URLLoader 请求的文本文件，所以我将它放在与 SWF 相同的目录中

```
deploy > maps > map1.txt 
```

但是当运行 SWF 时出现以下错误

```
*** Security Sandbox Violation ***
SecurityError: Error #2148: SWF file file:///Users/him/Documents/Clients/Geekery/Bounce/deploy/Bounce.swf cannot access local resource /maps/map1.txt. Only local-with-filesystem and trusted local SWF files may access local resources.
    at flash.net::URLStream/load()
    at flash.net::URLLoader/load()
    at com.geekery.Bounce::BounceMap()
    at Bounce/loadMap()
    at Bounce() 
```

这对我来说似乎很奇怪。我应该在一个特殊的地方保存这样的文件吗？或者有什么方法可以让文件从与 SWF 相同的目录中加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-05T22:47:44.373

您需要的是一个*crossdomain.xml*来为同一服务器上的 .swf 应用程序设置权限。更多信息在下面的链接

[跨域策略文件规范](http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html)

[加载策略文件（）](http://livedocs.adobe.com/flex/2/langref/flash/system/Security.html#loadPolicyFile%28%29)

如果这不是您真正想要的，那么您可以选择 [Embed] 解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T23:37:29.330

您使用的是相对网址还是绝对网址？你试过`loader.load( new URLRequest( 'maps/map1.txt' ) )`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T23:58:56.830

如果文件是静态的，您可以使用 @Embed 标记来执行此操作。请参阅[此示例](http://blog.flexexamples.com/2007/07/24/embedding-eternal-files-using-embed/)。

# database - 列存储：比较基于列的数据库

> ID：659725
> 
> 赞同：6
> 
> 时间：2009-03-18T19:21:41.677
> 
> 标签：database, r

我一直在努力将 SQL Server 变成某种东西，坦率地说，它永远不会。我的分析工作需要一个数据库引擎。DB 需要快速，并且不需要典型数据库（SQL Server、Oracle、DB2 等）中的所有日志记录和其他开销

昨天我在 Money:Tech 会议上听了[Michael Stonebraker 的演讲，](http://itc.conversationsnetwork.org/shows/detail4009.html)我一直在想，“我并不是真的疯了。有更好的方法！” 他谈到使用[列存储](http://en.wikipedia.org/wiki/Column-oriented_DBMS)而不是面向行的数据库。我访问了[列商店](http://en.wikipedia.org/wiki/Column-oriented_DBMS)的 Wikipedia 页面，看到了一些开源项目（我喜欢）和一些商业/开源项目（我不完全理解）。

我的问题是：在应用分析环境中，基于列的不同数据库有何不同？我应该怎么想他们？有人对基于多列的系统有实际经验吗？我可以利用我对这些数据库的 SQL 经验还是我必须学习一门新语言？

我最终会将数据提取到 R 中进行分析。

**编辑：**我被要求澄清我到底想要做什么。所以，这是我想做的一个例子：创建一个有 400 万行和 20 列的表（5 个维度，15 个事实）。创建 5 个聚合表，计算每个事实的最大值、最小值和平均值。将这 5 个聚合加入到起始表中。现在计算每行与平均值的百分比偏差、最小值的百分比偏差和最大值的百分比偏差，并将其添加到原始表中。此表数据不会每天都有新行，它会被完全替换并重复该过程。如果必须停止该过程，上天禁止。还有原木……哦，原木！:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-07-29T09:59:55.180

简短的回答是，对于分析数据，列存储往往更快，所需的调整更少。

行存储，传统的数据库架构，擅长插入少量行、就地更新行和查询少量行。在行存储中，这些操作可以通过一个或两个磁盘块 I/O 来完成。

分析数据库通常一次加载数千条记录；有时，就像您的情况一样，他们会重新加载所有内容。它们往往是非规范化的，所以有很多列。并且在查询时，他们经常读取表中很大比例的行，但只读取其中的少数列。因此，从 I/O 的角度来看，将同一列的值存储在一起是有意义的。

事实证明，这为数据库提供了进行值压缩的巨大机会。例如，如果一个字符串列的平均长度为 20 个字节，但只有 25 个不同的值，那么数据库可以将每个值压缩到大约 5 位。列存储数据库通常可以在不解压缩数据的情况下运行。

通常在计算机科学中存在 I/O 与 CPU 时间的权衡，但在列存储中，I/O 改进通常会改善引用的局部性，减少缓存分页活动，并允许更大的压缩因子，因此 CPU 也有所提高。

列存储数据库还倾向于具有其他面向分析的功能，例如位图索引（另一种情况，更好的组织允许更好的压缩、减少 I/O 并允许更高效的 CPU 算法）、分区和物化视图。

另一个因素是是否使用大规模并行 (MMP) 数据库。有 MMP 行存储和列存储数据库。MMP 数据库可以扩展到数百或数千个节点，并允许您存储大量数据，但有时会出现妥协，例如较弱的事务概念或非 SQL 查询语言。

我建议您尝试一下 LucidDB。（免责声明：我是 LucidDB 的提交者。）它是开源列存储数据库，针对分析应用程序进行了优化，还具有其他功能，例如位图索引。它目前只在一个节点上运行，但有效地利用了多个核心，并且可以毫不费力地处理合理的数据量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-29T13:47:39.597

400 万行乘以 20 列乘以 8 字节的双精度为 640 mb。根据 R 为每个对象创建三个临时副本的经验法则，我们得到大约 2 GB。按照今天的标准，这并不多。

因此，这应该可以在合适的 64 位机器上的内存中实现，该机器具有“相当”数量的 ram（比如 8 gb 或更多）。安装 Ubuntu 或 Debian（可能在服务器版本中）可以在几分钟内完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-14T23:30:32.277

我对 Infobright 社区版有一些经验——专栏或。db，基于mysql。

临：

*   您也可以使用 R 中的 mysql 接口/odbc mysql 驱动程序
*   对大量数据选择进行足够快的查询（由于 KnowledgeGrid 和数据包）
*   用于 ETL（talend、kettle）的非常快速的本机数据加载器和连接器
*   优化了我（我认为我们大多数人）使用的操作（按因素水平选择，加入等）
*   用于优化存储 R 因子变量的特殊“查找”选项；）（好的，具有相对较小级别数/行数的 char/varchar 变量）
*   开源软件
*   付费支持选项
*   ?

缺点：

*   社区版中没有插入/更新操作（还没有？），仅通过本机数据加载器/ETL 连接器加载数据
*   没有 utf-8 官方支持（整理/排序等），计划在 2009 年第三季度推出
*   聚合查询中没有函数 fe select month (date) from ...)，计划在 2009 年 7 月（？），但由于列存储，我更喜欢简单地为每个聚合级别（周数、月份、.. 。） 我需要
*   不能作为存储引擎安装在现有的 mysql 服务器上（因为自己的优化器，如果我理解正确的话），但如果需要，您可以在不同的端口上安装 Infobright 和 mysql
*   ?

简历：日常分析任务的良好 FOSS 解决方案，我认为您的任务也是如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-19T21:58:45.537

这是我的 2 美分：SQL 服务器不能很好地扩展。我们尝试使用 SQL 服务器实时存储财务数据（即 100 个品种的价格变动）。它在前 2 周工作得很好——然后随着数据库大小的增加，它变得越来越慢，最后停了下来，太慢了，无法在收到每个价格时插入。我们试图通过每晚将数据从活动数据库移动到离线存储来解决这个问题，但最终该项目被放弃了，因为它不起作用。

底线：如果您计划存储大量数据（> 1GB），则需要适当扩展的东西，这可能意味着列数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T20:33:17.527

它看起来像实现更改（以列优先顺序排列的二维数组，而不是行优先顺序），而不是接口更改。

思考“战略”模式，而不是整个范式转变。当然，我从未使用过这些产品，所以它们实际上可能会迫使你改变范式。不过，我不知道为什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T21:43:51.430

如果您描述 [1] 您的具体目标和 [2] 您在使用 SQL Server 时遇到的问题，我们可能会更好地帮助您做出明智的决定。

# java - 在eclipse中分离编辑器

> ID：659728
> 
> 赞同：20
> 
> 时间：2009-03-18T19:21:59.803
> 
> 标签：java, eclipse

有没有办法从主 Eclipse 窗口中分离编辑器？我知道 netbeans 可以做到这一点，但到目前为止，我还无法弄清楚如何使用 eclipse 来做到这一点（如果可能的话）。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-18T19:32:13.633

选择：窗口 | 新窗户

似乎是分离编辑器的紧密替代品。此命令创建一个新的“主 eclipse 窗口”，以便可以打开文件，而不能打开文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T16:37:35.820

使用 Eclipse Juno，您可以将编辑器拖出主窗口以将其分离。

# iphone - 团队环境中的 iPhone ad hoc 分发

> ID：659731
> 
> 赞同：7
> 
> 时间：2009-03-18T19:22:56.697
> 
> 标签：iphone

我是一名开发多个 iPhone 应用程序的开发人员。我是我们 Apple 开发门户团队的管理员。我们团队的代理不是开发人员。我了解只有代理才能请求临时部署证书，并准备应用程序以进行临时分发。

我假设代理可以生成证书并将它们传递给我，以便我可以为临时分发配置和构建应用程序，但我读过关于在 xCode 中使用多个证书的恐怖故事。只是在设备上设置开发测试就足够复杂了！

有没有人处理过这个问题？在 xCode 中使用多个证书有哪些陷阱？我想我还需要在我的钥匙串中有代理的公钥和私钥。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T00:53:19.427

这不是一场噩梦，它只会让人有点困惑，特别是如果你给你的个人资料起无用的名字，比如“分发资料”。如果您希望在您的计算机上拥有多组配置文件、证书和密钥，请确保对它们进行命名，以便您知道什么与什么相配和属于什么。

不久前，我在这方面发布了一些[建议。](http://www.benzado.com/blog/iphonedev-good-practices)

My number one piece of advice is to give your private keys descriptive names. Fortunately, you can do this at any time in Keychain Access. By default they are simply named "Private Key" and if you lose the certs you'll have to resort to some `openssl` geekery to figure out which key goes with which.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T06:21:54.053

主要问题是您需要代理导出他们用来在门户上生成证书请求的私钥。该门户网站上有备份和传输该私钥的说明……只有当您的系统上有该密钥时，您才能使用他们为 Ad-Hoc 创建的证书。

在这一点上，整个过程的文档都非常好，但是您必须非常非常仔细地阅读它们，并按照令人毛骨悚然的步骤进行操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T14:11:33.007

您应该使用单独的开发和分发证书；您实际上为它们设置了不同的配置。当您使用几个不同的开发证书时，“噩梦”就来了。如果有人在调试配置上触及证书设置，则必须手动设置（当然，这很麻烦）。

所以不，团队代理给你他的分发证书和私钥没有问题（你需要两者）。不过，他需要意识到，Apple 会让他对你的包裹分发负责。

# python - Python：如何添加 RSA 填充？

> ID：659737
> 
> 赞同：4
> 
> 时间：2009-03-18T19:24:04.807
> 
> 标签：python, encryption, rsa

我一直在查看大多数 python 加密库，我决定使用 PyCrypto 或 M2Crypto。
我已经放弃了 ezPyCrypto，因为它只支持 MD5 进行签名和 Keyczar，因为它还不够成熟。

所以我读到如果未正确填充要加密的文本（或签名哈希），RSA 很容易受到多种攻击。
这是什么意思？
PyCrypto 或 M2Crypto 都没有提到这件事，谷歌也没有发现任何相关的东西。这些库会自动添加 paddign 吗？怎么能说出来？

如果上面的答案是否定的，那么什么被认为是适当的填充？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T17:52:53.760

PyCrypto 没有添加提到的填充。
M2Crypto 相反。

M2Crypto 建立在 openSSL 之上，主要支持你需要的一切，仍然保持更新，同时 PyCrypto 发出几个弃用警告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T07:02:35.157

**随机**填充的原因之一可能是，如果将完全相同的消息发送给几个人（三个），那么具有低指数（假设为 3）的“书本”RSA 可以很简单地被破解。

因此，您最好通过之前对您的消息应用某种随机（但可逆）转换来确保您不会发送完全相同的消息。

也许这就是 padding 的意义所在！？

编辑：我查看了维基百科。我所说的叫做哈斯塔德的攻击。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T05:28:53.667

我最近努力解决加密问题……这篇文章有助于解释填充是什么：

[http://www.di-mgt.com.au/cryptopad.html](http://www.di-mgt.com.au/cryptopad.html)

（方法一似乎对我来说最容易实现）

如果需要，我可以分享一些代码片段。

PS 这个文件在帮助创建安全密钥方面也派上了用场（谷歌为它） PBKDF2.py - PKCS#5 v2.0 Password-Based Key Derivation

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:26:03.850

不完全确定，但如果您在 RSA 消息中添加随机组件，它可以防止字典攻击

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T14:59:01.243

首先，您应该使用 AES，因为它是事实上的标准。

AES 以 16 字节的块大小加密字节。显然，这适用于任何大型数据。但它的最后一点，显然可能小于 16 个字节。

对于最后一个块，您需要对其进行填充，典型的填充是通过 PCKS7 完成的，这非常简单。

假设您有一个字符串：“icecream”作为最后一个块。

`"icecream"`是8个字节，所以你需要另外8个字节来做一个块

So what you do is simply append the character 8(not '8') 8 times

```
"icecream\x08\x08\x08\x08\x08\x08\x08\x08" 
```

Would be your resultant string. Now you go ahead an encrypt the data.

Remember that while decrypting, you'll need to catch this last block, and strip the padding before using it.

# iis - IIS 6.0 / Windows 2003 和 IIS 7.0 / Windows 2008 之间的区别

> ID：659739
> 
> 赞同：2
> 
> 时间：2009-03-18T19:24:18.393
> 
> 标签：iis, iis-7, iis-6, windows-server-2008, windows-server-2003

我目前正在考虑为我的一些开发测试获得一个 VPS。我找到了一些价格便宜的 VPS，这很适合我，因为它只会用作沙盒。

到目前为止，我知道可以毫无问题地在 windows 2003 上安装 .Net 3.5，如果我是正确的，也可以将 IIS6 用于我的所有开发，包括 asp.net mvc。

如果有任何东西会阻止我使用 IIS6，我会在这里寻找。我查看了谷歌，显然 IIS 7 的主要内容是插件的模块化设计。这应该不是太大的问题，因为我的大多数开发人员都是供个人使用的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T19:30:53.433

（IIS 上的 PHP 在 IIS6 上运行良好）

我们的开发人员正在使用 .NET 3.5 针对 Win2k3 / IIS6 服务器进行所有开发，并且没有遇到任何可以使用 IIS7 修复的问题。这可能很好，因为我还没有建立一个 2k8 服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T23:14:27.643

对于开发人员，我认为 IIS7 添加的主要内容是集成托管管道，它允许您为 IIS 编写 .NET 代码而不是 ISAPI 过滤器。

共享配置、FastCGI、缓存改进等。我认为更多的是管理功能。有用，但不会真正影响您的开发时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T19:27:01.990

IIS7 将提供更快的服务，但 IIS6 应该能够完成您需要的一切（除非您需要在 IIS 上运行 PHP 或类似的东西）。

# database - NHibernate 有什么好的逆向数据库工程师工具？

> ID：659743
> 
> 赞同：1
> 
> 时间：2009-03-18T19:25:43.430
> 
> 标签：database, nhibernate, mapping

有谁知道对 NHibernate 的映射和业务类进行逆向工程的好工具？NHibernate 最适合全新开发，但我们还需要使用大型遗留数据库。我已经尝试过 NGen，它确实可以，但它会执行整个数据库，并且您无法选择单个表或映射到存储过程，它会将 UNIQUEIDENTIFIER 映射到 UNIQUEIDENTIFIER（应该是 GUID）。

我们确实有公司预算，因此该工具不一定是免费的。我知道 Frans 说过下一个版本的 LLBLGen 将为 NHibernate 和其他第 3 方提供支持（LL 会成为统治它们的唯一生成器吗？），但那是第 4 季度或更晚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T19:29:52.797

我们专门使用 LLBLGen 并喜欢它。由于我们也使用遗留数据库，因此它非常适合。也许 Alpha 版或 Beta 版会更早推出？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T23:32:00.887

我以前使用过[MyGeneration](http://sourceforge.net/projects/mygeneration/)和 NHibernate。不幸的是，我不能对设置/配置过程说太多，因为我从另一个开发人员那里继承了这些文件。我知道你告诉它运行哪个数据库，然后它返回一个数据库对象列表（对于某些表和视图，不确定存储过程）。然后，您选择要为其生成映射的对象并单击一个按钮，该按钮使用模板引擎生成映射和/或类。

# tfs - 如何将 TFS 源代码从一个团队项目迁移到另一个团队项目？

> ID：659750
> 
> 赞同：0
> 
> 时间：2009-03-18T19:27:50.133
> 
> 标签：tfs

我们决定为我们的团队项目使用不同的模板，并希望将所有源移动到该团队项目下。我们不关心迁移工作项，但如果可能，我们希望保留源文件的版本历史记录。我在代码 plex 上尝试了 TFS 到 TFS 迁移工具，它似乎只移动了每个源文件的最新版本。

我们在 TFS 2008 上，团队项目在同一台服务器上。

编辑：看起来移动功能可能会起作用。我已经看到一些关于这是否会移动给定文件的所有历史记录的担忧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T23:10:56.260

如果您从 TFS 中进行移动，则应将其注册为要保存在历史记录中的另一个操作。即使跨项目移动，您的其他历史记录也应保持不变。

# ruby - Ruby 符号不是垃圾收集的！？那么，使用String不是更好吗？

> ID：659755
> 
> 赞同：10
> 
> 时间：2009-03-18T19:28:57.760
> 
> 标签：ruby, performance, memory, garbage-collection, symbols

如果您在循环中创建 10,000 个字符串，则必须进行大量垃圾收集，这会占用大量资源。

如果你对符号做同样的事情，你会创建[不能被垃圾回收](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/164890)的对象。

哪个更糟？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T11:44:27.867

如果您在循环中引用相同的符号，则不必每次都重新创建该对象，即

```
while i < 10000
  i += 1
  :im_using_this_symbol_here
end 
```

现在，如果您在此处使用字符串，则该字符串将被重新创建 10K 次。通常，在您几乎将文字视为常量或键的情况下使用符号。对我来说一个很好的例子是

```
link_to "News", :action => 'news' 
```

代替

```
link_to "News", "action" => 'news' 
```

在您的应用程序中一遍又一遍地重复使用操作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-18T19:32:23.040

由于符号几乎总是通过文字创建的，因此这里内存爆炸的可能性不大。它们的行为在很大程度上是由它们的用法所要求的：每次你引用一个符号时，它都是同一个。

同样，字符串在 Ruby 中必须是唯一的。这是由于它们的使用方式 - 文本处理等。

根据语义决定使用哪一个，不要过早优化。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-25T16:34:07.803

如果您使用的是 Ruby 2.2.0 或更高版本，通常应该可以动态创建大量符号，因为它们将根据[Ruby 2.2.0-preview1 公告](https://www.ruby-lang.org/en/news/2014/09/18/ruby-2-2-0-preview1-released/)进行垃圾收集，该公告提供了[有关新符号 GC](https://bugs.ruby-lang.org/issues/9634)。但是，如果您将动态符号传递给某种将其转换为 ID（C 源代码中使用的内部 Ruby 实现概念）的代码，那么在这种情况下，它将被固定并且永远不会被垃圾收集。我不确定这种情况发生的频率有多高。

在决定是否使用符号或字符串时，您应该考虑：

*   符号在创建后不能更改。
*   符号没有很多字符串有的方法，比如`start_with?`
*   符号可以非常有效地相互比较以获得相等性。
*   根据[Symbol docs](https://ruby-doc.org/core/Symbol.html) ，符号应该代表某物的名称。我不会使用它们来存储任何不能被视为名称的东西。

# language-agnostic - 什么是（或应该是）虚函数调用的圈复杂度？

> ID：659759
> 
> 赞同：3
> 
> 时间：2009-03-18T19:30:26.537
> 
> 标签：language-agnostic, switch-statement, virtual-functions, code-metrics, cyclomatic-complexity

[圈复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)为理解给定函数的难易程度或包含错误的潜力提供了一个粗略的衡量标准。在我读过的实现中，通常所有基本的控制流构造（if、case、while、for 等）都会将函数的复杂度增加 1。在我看来，圈复杂度旨在确定“通过程序源代码的线性独立路径的数量”虚拟函数调用也应该增加函数的圈复杂度，因为在运行时将调用哪个实现的模糊性（调用在路径中创建另一个分支执行）。

但是，如果函数包含等效的 switch 语句（每个“case”关键字一个点，实现相关虚函数的层次结构中的每个类一个 case 关键字），对函数进行相同的惩罚，感觉过于苛刻，因为虚函数调用通常被认为是更好的编程实践。

虚函数调用的圈复杂度成本应该是多少？我不确定我的推理是反对将圈复杂度作为度量的效用，还是反对使用虚函数或不同的东西。

编辑：在人们的回应之后，我意识到它不应该增加圈复杂性，因为我们可以认为虚函数调用等同于对包含大量 switch 语句的全局函数的调用。即使该函数会得到一个坏分数，它在程序中只存在一次，而直接用 switch 语句替换每个虚拟函数调用会导致多次成本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T19:32:52.477

圈复杂度通常不适用于函数调用边界，而是函数内度量。因此，虚拟调用不计入非虚拟静态函数调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T19:39:52.273

虚函数调用不会增加圈复杂度，因为“将调用哪个实现的歧义”在函数调用之外。一旦设置了对象值，就没有歧义了。我们确切地知道将调用哪些方法。

```
BaseClass baseObj = null;
// this part has multiple paths & add to CC
if (x == y)
     baseObj = new Derived1();
else
     baseObj = new Derived2();

// this part has one path and does not add to the CC
baseObj.virtualMethod1();
baseObj.virtualMethod2();
baseObj.virtualMethod3(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T19:45:12.587

> 虚函数调用也应该增加函数的圈复杂度，因为在运行时调用哪个实现的模糊性

*啊，但它在运行时*并不模棱两可（除非你正在做元编程/猴子补丁）；它完全由接收器的类型/类别决定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:42:57.350

我不是圈复杂度的忠实拥护者，但在这种情况下，您正在调用一个函数。它将做大致相同的事情（除非类层次结构设计真的搞砸了），但根据调用它的不同会有一些变化。事情是，如果你调用任何函数，你可以根据你传入的参数获得一些不同的行为，这不计入 CC 中。

因此，我完全忽略了这个成本。

# java - 从 Java 运行外部程序，读取输出，允许中断

> ID：659796
> 
> 赞同：16
> 
> 时间：2009-03-18T19:38:21.963
> 
> 标签：java, multithreading

我想从 Java 启动一个进程，读取它的输出，并获取它的返回码。但是在它执行时，我希望能够取消它。我首先启动该过程：

```
ProcessBuilder pb = new ProcessBuilder(args);
pb.redirectErrorStream(true);
Process proc = pb.start(); 
```

如果我调用 proc.waitFor()，在进程退出之前我什么都做不了。所以我假设我需要这样的东西：

```
while (true) {
  see if process has exited
  capture some output from the process
  decide if I want to cancel it, and if so, cancel it
  sleep for a while
} 
```

这是正确的吗？有人可以给我一个如何在 Java 中执行此操作的示例吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-18T20:19:20.243

这是我认为你想要做的一个例子：

```
ProcessBuilder pb = new ProcessBuilder(args);
pb.redirectErrorStream(true);
Process proc = pb.start();

InputStream is = proc.getInputStream();
InputStreamReader isr = new InputStreamReader(is);
BufferedReader br = new BufferedReader(isr);

String line;
int exit = -1;

while ((line = br.readLine()) != null) {
    // Outputs your process execution
    System.out.println(line);
    try {
        exit = proc.exitValue();
        if (exit == 0)  {
            // Process finished
        }
    } catch (IllegalThreadStateException t) {
        // The process has not yet finished. 
        // Should we stop it?
        if (processMustStop())
            // processMustStop can return true 
            // after time out, for example.
            proc.destroy();
    }
} 
```

你可以改进它:-) 我现在没有真实的环境来测试它，但你可以[在这里](http://www.java-tips.org/java-se-tips/java.util/from-runtime.exec-to-processbuilder.html)找到更多信息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-10-25T16:08:26.917

我建议检查[Apache Commons Exec](http://commons.apache.org/exec/)以避免重新创建轮子。它具有一些不错的功能，例如在同步执行与异步执行之间进行选择，以及生成*看门狗*进程的标准解决方案，可以帮助在执行被卡住的情况下超时。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-18T20:20:33.407

像这样的辅助类可以解决问题：

```
public class ProcessWatcher implements Runnable {

    private Process p;
    private volatile boolean finished = false;

    public ProcessWatcher(Process p) {
        this.p = p;
        new Thread(this).start();
    }

    public boolean isFinished() {
        return finished;
    }

    public void run() {
        try {
            p.waitFor();
        } catch (Exception e) {}
        finished = true;
    }

} 
```

然后，您将完全按照您的描述实现循环：

```
Process p = Runtime.getRuntime().exec("whatever command");
ProcessWatcher pw = new ProcessWatcher(p);
InputStream output = p.getInputStream();
while(!pw.isFinished()) {
    processOutput(output);
    if(shouldCancel()) p.destroy();
    Thread.sleep(500);
} 
```

根据您想要销毁进程的条件，您可能希望在单独的线程中执行此操作。否则，您可能会在等待更多程序输出处理时阻塞，并且永远无法真正选择销毁它。

**编辑**：麦克道尔在下面的评论中是 100% 正确的，所以我将完成的变量设置为 volatile。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-20T10:18:54.760

这个怎么样（看看它在[jcabi-heroku-maven-plugin](https://github.com/yegor256/jcabi/blob/master/jcabi-heroku-maven-plugin/src/main/java/com/jcabi/heroku/maven/plugin/Git.java)中是如何工作的）：

```
/**
 * Wait for the process to stop, logging its output in parallel.
 * @param process The process to wait for
 * @return Stdout produced by the process
 * @throws InterruptedException If interrupted in between
 */
private String waitFor(final Process process) throws InterruptedException {
    final BufferedReader reader = new BufferedReader(
        new InputStreamReader(process.getInputStream())
    );
    final CountDownLatch done = new CountDownLatch(1);
    final StringBuffer stdout = new StringBuffer();
    new Thread(
        new VerboseRunnable(
            new Callable<Void>() {
                @Override
                public Void call() throws Exception {
                    while (true) {
                        final String line = reader.readLine();
                        if (line == null) {
                            break;
                        }
                        System.out.println(">> " + line);
                        stdout.append(line);
                    }
                    done.countDown();
                    return null;
                }
            },
            false
        )
    ).start();
    try {
        process.waitFor();
    } finally {
        done.await();
        IOUtils.closeQuietly(reader);
    }
    return stdout.toString();
} 
```

附言。现在，此实现可作为[jcabi-log](http://www.jcabi.com/jcabi-log/threads-VerboseProcess.html)工件中的[`com.jcabi.log.VerboseProcess`](http://www.jcabi.com/jcabi-log/apidocs-0.5.4/com/jcabi/log/VerboseProcess.html)类使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T20:21:35.557

是什么让您决定终止进程——异步事件（例如来自用户的输入）或同步事件（例如，该进程已完成您希望它执行的操作）？我猜是前者——来自用户的输入让你决定取消子进程。

另外，您希望子流程产生多少输出？如果它很多，那么如果您没有足够快地从其输出流中读取，则子进程可能会阻塞。

您的情况可能会有所不同，但似乎您可能需要至少两个不同的线程——一个决定是否取消进程，一个处理子进程的输出。

在这里查看更多详细信息：http: [//java.sun.com/developer/JDCTechTips/2005/tt0727.html#2](http://java.sun.com/developer/JDCTechTips/2005/tt0727.html#2)

# java - 正则表达式：查找给定字符串附近的数字

> ID：659798
> 
> 赞同：0
> 
> 时间：2009-03-18T19:38:58.763
> 
> 标签：java, regex

我正在尝试找到一种好方法来捕获距给定字符串不超过 N 个字符的数字。

例如，如果字符串是“年龄”并且 N=4 必须找到

```
"Age 5" => 5
"My age is 10 and I my name is John" => 10
"My age is almost 5 and I my name is Mary" => null 
```

在最后一种情况下，数字与“年龄”分开超过 4 个字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T19:40:51.130

关于什么

```
age[^0-9]{0,4}[0-9]+ 
```

如果您想捕获可能找到的数字：

```
age[^0-9]{0,4}([0-9]+) 
```

?

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T19:42:36.027

类似于以下内容：

```
age[^\d]{,4}(\d+) 
```

这意味着“年龄后跟 0 到 4 个非数字后跟一个或多个数字......捕获数字”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T19:45:07.267

```
[Aa]ge[\D]{,N}(\d+) 
```

然后获取第一组的内容（$1）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T19:55:54.870

在这里扩展其他答案，如果您需要它在任一方向的 5 个字符内：

```
/((\d+)\D{,4})?age(\D{,4}(\d+))?/i 
```

然后：

```
if(matches[2] != null)
{
  if(matches[4] != null)
    return max(matches[2], matches[4]);  //or however you want to resolve this..
  else
    return matches[2];
}
return matches[4]; 
```

# ruby - Ruby - 在类中获取非祖先方法的数组

> ID：659811
> 
> 赞同：10
> 
> 时间：2009-03-18T19:41:31.473
> 
> 标签：ruby, inheritance, methods

我想创建一个类，该类具有一个方法，该方法调用不在超类中的所有其他方法。

有没有办法可以使用 obj.methods 来仅获取非祖先方法？还是有另一种方法可以完全做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-05-14T17:19:41.410

该标准`instance_methods`允许您指定是否要包含超类方法：

```
class Foo
  def bar
  end
end

Foo.instance_methods(false) # => [:bar] 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-18T20:40:20.723

我不确定您在这里真正想要做什么，也不确定您所说的“全部”是指哪些方法，但如果问题是您如何确定哪些类的实例方法没有被继承，那么 .instance_methods 的组合.ancestors 可以为您提供该信息。在这里，使用 Array 作为示例类：

```
Array.instance_methods.sort                                                                         
=> ["&", "*", "+", "-", "<<", "<=>", "==", "===", "=~", "[]", "[]=", "__id__", "__send__", "all?", "any?", "assoc", "at", "class", "clear", "clone", "collect", "collect!", "compact", "compact!", "concat", "delete", "delete_at", "delete_if", "detect", "display", "dup", "each", "each_index", "each_with_index", "empty?", "entries", "eql?", "equal?", "extend", "fetch", "fill", "find", "find_all", "first", "flatten", "flatten!", "freeze", "frozen?", "grep", "hash", "id", "include?", "index", "indexes", "indices", "inject", "insert", "inspect", "instance_eval", "instance_of?", "instance_variable_get", "instance_variable_set", "instance_variables", "is_a?", "join", "kind_of?", "last", "length", "map", "map!", "max", "member?", "method", "methods", "min", "nil?", "nitems", "object_id", "pack", "partition", "pop", "private_methods", "protected_methods", "public_methods", "push", "rassoc", "reject", "reject!", "replace", "respond_to?", "reverse", "reverse!", "reverse_each", "rindex", "select", "send", "shift", "singleton_methods", "size", "slice", "slice!", "sort", "sort!", "sort_by", "taint", "tainted?", "to_a", "to_ary", "to_s", "transpose", "type", "uniq", "uniq!", "unshift", "untaint", "values_at", "zip", "|"]

Array.ancestors
=> [Array, Enumerable, Object, Kernel]

Array.instance_methods.sort - Array.ancestors.map {|a| a == Array ? [] : a.instance_methods}.flatten
=> ["&", "*", "+", "-", "<<", "<=>", "[]", "[]=", "assoc", "at", "clear", "collect!", "compact", "compact!", "concat", "delete", "delete_at", "delete_if", "each", "each_index", "empty?", "fetch", "fill", "first", "flatten", "flatten!", "index", "indexes", "indices", "insert", "join", "last", "length", "map!", "nitems", "pack", "pop", "push", "rassoc", "reject!", "replace", "reverse", "reverse!", "reverse_each", "rindex", "shift", "size", "slice", "slice!", "sort!", "to_ary", "transpose", "uniq", "uniq!", "unshift", "values_at", "|"] 
```

如果您只想从超类中排除方法，而不是包含的方法，那么还有 .superclass。

```
Array.superclass
=> Object

Array.instance_methods.sort - Array.superclass.instance_methods
=> ["&", "*", "+", "-", "<<", "<=>", "[]", "[]=", "all?", "any?", "assoc", "at", "clear", "collect", "collect!", "compact", "compact!", "concat", "delete", "delete_at", "delete_if", "detect", "each", "each_index", "each_with_index", "empty?", "entries", "fetch", "fill", "find", "find_all", "first", "flatten", "flatten!", "grep", "include?", "index", "indexes", "indices", "inject", "insert", "join", "last", "length", "map", "map!", "max", "member?", "min", "nitems", "pack", "partition", "pop", "push", "rassoc", "reject", "reject!", "replace", "reverse", "reverse!", "reverse_each", "rindex", "select", "shift", "size", "slice", "slice!", "sort", "sort!", "sort_by", "to_ary", "transpose", "uniq", "uniq!", "unshift", "values_at", "zip", "|"] 
```

这有帮助吗？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-01-10T01:38:22.670

obj1.class.instance_methods - obj1.class.superclass.instance_methods

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-18T20:19:03.207

```
class MassiveCall
  def method1
    puts "calling method1"
  end

  def method2
    puts "calling method2"
  end

  def method3
    puts "calling method3"
  end

  def one_method_to_rule_them_all
    # skip one_method_to_rule_them_all to avoid infinite recursion:
    methods = self.class.instance_methods(false) - ["one_method_to_rule_them_all"]
    methods.each do |method_name|
      self.send(method_name)
    end
  end
end

master = MassiveCall.new
master.one_method_to_rule_them_all 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-14T17:07:38.223

我在这里可能不太清楚，但是使用`owner`呢？

```
methods = obj.methods.map { |sym| obj.method(sym) }.
own_methods = methods.find_all { |mth| mth.owner == obj.class }

own_methods.each do |mth|
  mth.to_proc.call
end 
```

# .net - System::Windows::Forms::Form::ShowDialog()

> ID：659825
> 
> 赞同：0
> 
> 时间：2009-03-18T19:44:59.500
> 
> 标签：.net, c++, forms, showdialog

我有 2 个表单设置

当我从串口接收数据时，我的第一个表单将使用 ShowDialog() 方法调用另一个表单

ShowDialog() 抛出带有附加信息“DragDrop 注册未成功”的 InvalidOperation

关于如何解决这个问题的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T19:56:24.947

俗气的谷歌搜索答案......但它似乎解决了你的问题：

[http://social.msdn.microsoft.com/forums/en-US/vbgeneral/thread/269b8950-2ef9-483f-8124-e2725ffd5d83/](http://social.msdn.microsoft.com/forums/en-US/vbgeneral/thread/269b8950-2ef9-483f-8124-e2725ffd5d83/)

# python - 使用额外选项反转 Django URL

> ID：659832
> 
> 赞同：14
> 
> 时间：2009-03-18T19:45:58.513
> 
> 标签：python, django

假设我有一个如下所示的 URLconf，`'foo'`并且`'bar'`是`page_slug`.

```
urlpatterns = patterns('',
    (r'^page/(?P<page_slug>.*)/', 'myapp.views.someview'),
) 
```

然后，我可以使用下面的方法重建 URL，对吧？

```
>>> from django.core.urlresolvers import reverse
>>> reverse('myapp.views.someview', kwargs={'page_slug': 'foo'})
'/page/foo/'
>>> reverse('myapp.views.someview', kwargs={'page_slug': 'bar'})
'/page/bar/' 
```

但是如果我把我的 URLconf 改成这个呢？

```
urlpatterns = patterns('',
    (r'^foo-direct/', 'myapp.views.someview', {'page_slug': 'foo'}),
    (r'^my-bar-page/', 'myapp.views.someview', {'page_slug': 'bar'}),
) 
```

我期待这个结果：

```
>>> from django.core.urlresolvers import reverse
>>> reverse('myapp.views.someview', kwargs={'page_slug': 'foo'})
'/foo-direct/'
>>> reverse('myapp.views.someview', kwargs={'page_slug': 'bar'})
'/my-bar-page/' 
```

但是，这会引发`NoReverseMatch`异常。我怀疑我正在尝试做一些不可能的事情。关于更明智的方式来完成我想要的任何建议？

命名 URL 不是一个选项，因为我不希望链接到这些的其他应用程序需要了解 URL 结构的细节（封装和所有这些）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-05-18T00:52:50.947

您应该尝试命名您的 urlconfs。例子：

```
urlpatterns = patterns('',
    url(r'^foo-direct/', 'myapp.views.someview', {'page_slug': 'foo'}, name='foo-direct'),
    url(r'^my-bar-page/', 'myapp.views.someview', {'page_slug': 'bar'}, name='bar-page'),
) 
```

然后只需编辑你的反向，你应该让它工作。

```
>>> from django.core.urlresolvers import reverse
>>> reverse('foo-direct', kwargs={'page_slug': 'foo'})
'/foo-direct/'
>>> reverse('bar-page', kwargs={'page_slug': 'bar'})
'/my-bar-page/' 
```

更多信息：[Django Docs](http://docs.djangoproject.com/en/1.2/topics/http/urls/#id2)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-18T20:17:11.247

这就是我们所做的。

urls.py 有这样的模式

```
url(r'^(?P< datarealm >.*?)/json/someClass/(?P<object_id>.*?)/$', 'json_someClass_resource', ), 
```

views.py 像这样反向调用

```
 object = SomeModel.objects.get(...)
    url= reverse('json_someClass_resource', kwargs={'object_id':object.id,'datarealm':object.datarealm.name}) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-18T22:24:25.870

命名网址应该是一个选项。您的案例在 Django 参考中突出显示：

[http://docs.djangoproject.com/en/dev/topics/http/urls/?from=olddocs#id2](http://docs.djangoproject.com/en/dev/topics/http/urls/?from=olddocs#id2)

我不确定设计师是否留下了另一种解决方法。他们希望命名的网址能够覆盖它。

我可以离题一下封装吗？谢谢。主要原因有两个：

1.  抽象——没有人*愿意*看到细节
2.  安全性——任何人*都不应*看到细节

至于 1，你可以在 python 中获得相当多的里程，Django 就是一个很好的例子。至于2，它是一种解释语言。要么你在它写的地方运行它，要么你正在运送已编译的 .pyc 文件。如果这真的是你正在做的，那么编译 url conf。

最后，与 url 结构相比，让其他应用了解功能似乎更少封装。但如果你真的不同意，我认为你必须自己实现一个更灵活的反向方法。

# random - 简单的随机英文句子生成器

> ID：659838
> 
> 赞同：20
> 
> 时间：2009-03-18T19:48:41.377
> 
> 标签：random, generator, markov-chains

我需要一个简单的随机英语句子生成器。我需要用我自己的话来填充它，但它需要能够造出更长的句子，至少遵循英语规则，即使它们没有意义。

我希望那里有数以百万计的人，所以与其重新发明轮子，我希望你知道一个来源，或者一种可以给我足够信息的资源，我不必去寻找我的生疏的英语技能。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-18T19:55:36.353

您正在寻找用于英语句子的[马尔可夫链的实现。](http://en.wikipedia.org/wiki/Markov_chain)

快速谷歌搜索“马尔可夫链句子生成器”返回：

*   [http://www.jwz.org/dadadodo/](http://www.jwz.org/dadadodo/)
*   [http://code.google.com/p/lorem-ipsum-generator/](http://code.google.com/p/lorem-ipsum-generator/)
*   [http://kartoffelsalad.googlecode.com/svn-history/r9/trunk/lib/markov.py](http://kartoffelsalad.googlecode.com/svn-history/r9/trunk/lib/markov.py)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-09-07T22:02:35.683

我知道这是一个老问题，但是当我通过 Google 找到它时，我认为除了马尔可夫链之外，还值得一提诸如[Context Free Grammars之类的东西。](http://eli.thegreenplace.net/2010/01/28/generating-random-sentences-from-a-context-free-grammar/)

我对马尔可夫链的理解是，它们仅根据“当前”项目的概率创建“下一个”项目。也许我错了，但我不明白这将如何确保结果符合语法规则。

例如，我通常看到建议使用马尔可夫链作为创建“英语发音”单词的一种方式。如果您使用来自英语单词数据集的字母创建马尔可夫链，则输出将是听起来像英语的单词，但不一定是真实单词。我相信句子也是如此——你可以生成一些听起来不错的东西，但它可能不是一个语法正确的句子。

上下文无关语法（或者可能还有正则语法？）可能是更好的候选者，因为它们根据定义的规则集生成句子。正如原始问题所要求的那样，用您自己的话来填充它会很容易。缺点是您需要自己定义这些规则，而不是依赖数据集。自从我使用语法生成英语句子以来已经有很长时间了，所以我不记得获得良好/多样的回应有多难。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-18T19:51:48.780

您也许可以使用/修改[CS Paper Generator](http://pdos.csail.mit.edu/scigen/)的一部分。

# c# - 我需要 Dispose() 或 Close() 一个 EventWaitHandle 吗？

> ID：659840
> 
> 赞同：25
> 
> 时间：2009-03-18T19:49:18.803
> 
> 标签：c#, .net, multithreading, synchronization

如果我使用`EventWaitHandle`(or `AutoResetEvent`, ) 在线程之间进行同步，那么当我完成它时是否`ManualResetEvent`需要调用该事件句柄上的`Close()`or方法？`Dispose()`

`EventWaitHandle`继承自`WaitHandle`，实现`IDisposable`. 如果我没有`IDisposable`在任何包含`EventWaitHandle`. 所以这表明我确实需要调用它。

但是，这些 MSDN 使用示例都没有调用`Dispose()`或`Close()`：

[http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle(VS.80).aspx) [http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent( VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent(VS.80).aspx) [http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent(VS.80).aspx)

这只是微软无视自己建议的一个例子吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-24T20:04:42.513

an 的一次性资源`EventWaitHandle`实际上是 a `SafeHandle`（包装在 a 中`SafeWaitHandle`）。*实现一个终结器，最终确保释放必要的资源，因此在这种情况下*`SafeHandle`让垃圾收集器/终结器线程处理它应该是安全的。

 *`Dispose()`但是，在不再需要资源时显式调用总是一个好主意。

[简而言之C# 3.0 中](http://www.albahari.com/nutshell/)的线程章节状态

> 这种做法（可以说）对于等待句柄是可以接受的，因为它们的操作系统负担很轻（异步委托完全依赖这种机制来释放它们`IAsyncResult`的等待句柄）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-18T19:51:09.000

您需要明确处置它们。Close() 更适合他们，因为它确实调用了 Dispose()。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-18T19:59:56.670

来自 MSDN 的类定义：

```
public class EventWaitHandle : WaitHandle
public abstract class WaitHandle : MarshalByRefObject, IDisposable 
```

所以是的，你必须因为 WaitHandle 是 IDisposable。如果您不这样做，FxCop 会认为这是违反规则的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-26T15:08:04.583

Close 方法在内部处理它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-24T09:50:36.223

[MSDN 说](https://docs.microsoft.com/en-us/dotnet/api/system.threading.waithandle.dispose?view=net-6.0)：

> 在释放对 WaitHandle 的最后引用之前，请始终调用 Close 或 Dispose()。否则，它正在使用的资源将不会被释放。

`WaitHandle`因此，在我看来，当它们继承时，您也应该处理`EventWaitHandle`(or `AutoResetEvent`, `ManualResetEvent`)

# asp.net - 带有正则表达式验证器回发问题的 ASP.Net FileUpload 控件

> ID：659842
> 
> 赞同：2
> 
> 时间：2009-03-18T19:49:41.313
> 
> 标签：asp.net, regex, validation, controls

我正在尝试使用 .Net FileUpload 控件和 Regex Validator 将文件名限制为 JPG、GIF 或 PNG 扩展名。回发后，文件名从控件中消失（如预期的那样），但这似乎导致验证器触发并显示其错误文本。

任何人都可以提出解决方案或更好的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T17:55:42.537

只需使用具有以下 javascript 函数的自定义验证器：

```
function UploadFileCheck(source, arguments)
{
    var sFile = arguments.Value;
    arguments.IsValid = 
       ((sFile.endsWith('.jpg')) ||
        (sFile.endsWith('.jpeg')) ||
        (sFile.endsWith('.gif')) ||
        (sFile.endsWith('.png')));
} 
```

自定义验证器代码：

```
<asp:CustomValidator ID="cvalAttachment" runat="server" ControlToValidate="upAttachment" SetFocusOnError="true" Text="*" ErrorMessage="Invalid: File Type (allowed types: jpg, jpeg, gif, png)" ClientValidationFunction="UploadFileCheck"></asp:CustomValidator> 
```

这应该是您在客户端发回之前停止它的全部需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T14:38:52.283

使用自定义验证器进行此检查并在处理上传的方法中调用 Page.IsValid，如果文件没有有效的扩展名，它将停止处理上传。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-08T23:13:42.123

JavaScript 没有“endsWith”，因此请将此代码用于自定义验证器：

`function UploadFileCheck(source, arguments) { var sFile = arguments.Value; arguments.IsValid = ((sFile.match(/\.jpe?g$/i)) || (sFile.match(/\.gif$/i)) || (sFile.match(/\.bmp$/i)) || (sFile.match(/\.tif?f$/i)) || (sFile.match(/\.png$/i))); }`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T07:01:28.640

Using custom validator is way too long. Instead you can simply set the **IsValid** property of the RegularExpression in the click event of your upload button.

[http://blogs.cametoofar.com/post/aspnet-regular-expression-validator-firing-after-postback.aspx](http://blogs.cametoofar.com/post/aspnet-regular-expression-validator-firing-after-postback.aspx)

# mysql - MySQL：总 GROUP BY WITH ROLLUP 好奇心

> ID：659845
> 
> 赞同：22
> 
> 时间：2009-03-18T19:50:57.613
> 
> 标签：mysql

我有两个疑问。其中一个对我有意义，另一个没有。第一：

```
SELECT gender AS 'Gender', count(*) AS '#'
    FROM registrations 
    GROUP BY gender WITH ROLLUP 
```

这给了我这个：

```
Gender       #
Female      20
Male        19
NULL        39 
```

所以，我得到了计数和总计数。我所期望的。下一个：

```
SELECT c.printable_name AS 'Country', count(*) AS '#' 
    FROM registrations r 
    INNER JOIN country c ON r.country = c.country_id 
    GROUP BY country WITH ROLLUP

Country         #
Denmark         9
Norway         10
Sweden         18
United States   1
Uzbekistan      1
Uzbekistan     39 
```

结果相同。但是为什么我得到乌兹别克斯坦的总数？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-19T08:23:52.060

> 但是为什么我得到乌兹别克斯坦的总数？

因为您没有选择要分组的项目。如果你说：

```
GROUP BY c.printable_name 
```

你会得到预期的NULL。但是，您按不同的列进行分组，因此 MySQL 不知道 printable_name 正在参与汇总组，并在*所有*注册的连接中从该列中选择任何旧值。（因此您可能会看到乌兹别克斯坦以外的其他国家。）

这是 MySQL 允许在 GROUP BY 查询中选择什么的更广泛问题的一部分。例如，您可以说：

```
SELECT gender FROM registrations GROUP BY country; 
```

即使国家和性别之间没有直接的因果关系（也称为“功能依赖”），MySQL 也会很乐意从每个国家/地区为注册选择一个性别值。其他 DBMS 将拒绝上述命令，理由是不能保证每个国家只有一种性别。(*)

现在，这个：

```
SELECT c.printable_name AS 'Country', count(*) AS '#' 
FROM registrations r 
INNER JOIN country c ON r.country = c.country_id 
GROUP BY country 
```

没关系，因为 r.country 和 c.printable_name 之间存在功能依赖关系（假设您已正确地将 country_id 描述为 PRIMARY KEY）。

然而，MySQL 的 WITH ROLLUP 扩展在其工作方式上有点小题大做。在最后的汇总行阶段，它遍历整个预分组结果集以获取其值，*然后*将分组列设置为 NULL。**它也不会将对该列具有功能依赖关系的其他列清空。**它可能应该，但 MySQL 目前并不真正了解有关函数依赖的全部内容。

因此，如果您选择 c.printable_name，它将显示它随机选择的任何国家名称值，如果您选择 c.country_id，它将显示它随机选择的任何国家 ID——即使 c.country_id 是加入标准，所以必须是与 r.country 相同，为 NULL！

你可以做些什么来解决这个问题：

*   改为按 printable_name 分组；如果 printable_names 是唯一的，应该没问题，或者
*   选择“r.country”以及 printable_name，并检查其是否为 NULL，或者
*   忘记 WITH ROLLUP 并单独查询最终总和。这会慢一点，但它也符合 ANSI SQL-92，因此您的应用程序可以在其他数据库上运行。

(*: MySQL 有一个 SQL_MODE 选项[ONLY_FULL_GROUP_BY](http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html#sqlmode_only_full_group_by)应该可以解决这个问题，但它走得太远了，只允许你从 GROUP BY 中选择列，而不是对 GROUP BY 有功能依赖的列。所以它会让有效查询也会失败，因此通常无用。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-13T16:22:13.100

```
SELECT ifnull(c.printable_name, "Total Registration = ") AS 'Country', count(*) AS '#' 
FROM registrations r 
INNER JOIN country c ON r.country = c.country_id 
GROUP BY country WITH ROLLUP; 
```

这将打印“<strong>Total Registration = 39”，并且将是最后一行/记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T20:08:04.747

因为当您使用 JOIN 方法时，数组的以下 NULL 元素将具有前一个 NOT NULL 元素的值。但我不确定。这就是我在 PHP 中使用它时的经验。

嗯...还有另一个问题... **“国家”不能是因为它是表的名称**。所以换别的东西。然后最后一个结果将显示 NULL。这是我的建议：

```
$result = mysql_query("SELECT c.printable_name AS 'countryp', count(*) AS '#'
FROM registrations r, country c WHERE r.country = c.country_id
GROUP BY countryp WITH ROLLUP");

while($row = @mysql_fetch_array($result)) {
  $r1 = $row["countryp"];
  $r2 = $row["#"];
  if ($r1 == NULL) $r1 = 'Total';
  echo "$r1 $r2<br />";
} 
```

# python - 在python中检查文件属性

> ID：659847
> 
> 赞同：2
> 
> 时间：2009-03-18T19:51:17.317
> 
> 标签：python

我想使用 python 检查目录中每个文件的存档位。到目前为止，我有以下内容，但我无法让它正常工作。该脚本的想法是能够查看所有具有存档位的文件。

谢谢

```
# -*- coding: latin-1 -*-
import os , win32file, win32con
from time import *
start = clock()

ext = [ '.txt' , '.doc' ]

def fileattributeisset(filename, fileattr):
    return bool(win32file.GetFileAttributes(filename) & fileattr)

for root, dirs, files in os.walk('d:\\Pruebas'):
    print ("root", root)    
    print ("dirs", dirs)
    print ("files", files)
    for i in files:
        if i[ - 4:] in ext: 
            print('...', root, '\\', i, end=' ')
            fattrs = win32file.GetFileAttributes(i)
            if fattrs & win32con.FILE_ATTRIBUTE_ARCHIVE:
                print('A isSet',fattrs)
        #print( fileattributeisset(i, win32con.FILE_ATTRIBUTE_ARCHIVE)) 
    print ('####') 
```

编辑：所有文件似乎都有存档位，做'attrib'表明所有文件都没有属性位。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-18T21:37:52.877

从 os.walk 返回的文件列表不是完全限定的路径，所以当你调用

```
win32file.GetFileAttributes(i) 
```

它找不到文件并返回错误代码；恰好是-1。所以操作

```
fattrs & win32con.FILE_ATTRIBUTE_ARCHIVE 
```

总是正确的。

您需要将根连接到文件名，以便 GetFileAttributes 成功：

```
fattrs = win32file.GetFileAttributes(os.path.join(root, i)) 
```

Also, when you are checking the extension, it is probably better to use `os.path.splitext(path)` to retrieve the extension rather than relying on them be 3 characters long as you do.

# c++ - 如何在 NetBeans 中使用 Microsoft C++ 编译器？

> ID：659857
> 
> 赞同：9
> 
> 时间：2009-03-18T19:54:37.947
> 
> 标签：c++, visual-c++, netbeans, ide

我想知道是否可以将 Microsoft 的 C++ 编译器和链接器与 NetBeans IDE 一起使用？如果是这样，最好的方法是什么。

PS我对Mingw不感兴趣。

**编辑：**是否可以让 NetBeans 进行错误解析（以便我可以单击错误并让 NetBeans 打开正确的文件）、智能感知等？我知道 NetBeans 可以使用 g++ make 文件。为什么不使用nmake？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T22:48:51.197

我目前正在编写一个插件/工具链来在 Netbeans 上使用 Visual C++。[您可以在 source](https://sourceforge.net/projects/vcc4n/) forge或[NetBeans 插件](http://plugins.netbeans.org/plugin/42519/?show=true)
上 找到名为 VCC4N 的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T15:01:21.043

老实说，我总是在 ide（例如 code::blocks、monodevelop、anjuta）或编辑器（实际上总是 scite）中进行业余编码，并*通过**makefile*（手写、cmake、自动制作）。

 *编译时这不是真正的问题：F7（或其他一些 F 键）与（alt+tab，up，enter），其中（alt+tab）和（up）几乎同时按下时间，但我获得了最多全屏编译器报告的巨大好处，而且我经常在终端中测试我的程序。此外，它使我的代码更加独立于 IDE（曾经尝试从 code::blocks 获取生成文件以用于分发目的？）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T14:50:30.540

Visual Studio 编译器称为 cl.exe，链接器称为 link.exe。这些存在于特定的视觉工作室目录中。在 Visual Studio > 项目属性 > C++ > 命令行中，或通过禁用“抑制横幅”选项，您可以找到 Visual Studio 运行的命令。您可以从 netbeans 内部调用这些命令行。

将所有文件名放入要编译的列表中可能会更加棘手。为此，您需要一个构建系统。您可以尝试使用 Visual Studio 使用的相同机制，但很抱歉我的知识在那里失败。或者，您可以使用 CMake 或其他一些构建系统。然后，无论何时添加/删除源文件，都必须更新 CMakelist.txt 才能编译。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-07T10:16:34.257

您可以从 netbeans 获得语法突出显示、代码图形等，而无需安装我认为的编译器（不确定，您可能需要 cygwin 或 mingw 进行解析）。您必须做的是至少创建一个空的 makefile。如果你想使用微软的编译器，那么你需要：

a) 自己编写 makefile 以使用 cl 编译所有内容 b) 从 makefile 中调用带有项目名称的 msdev，它将编译所有内容 b) 从 makefile 中调用 scons 之类的东西来编译所有内容

我使用 netbeans 开发跨平台软件，但此时，我实际上并没有从 netbeans 运行构建。

# asp.net - ASP.Net MVC Json 结果：传递给控制器 方法的参数问题

> ID：659858
> 
> 赞同：3
> 
> 时间：2009-03-18T19:54:47.790
> 
> 标签：asp.net, jquery, asp.net-mvc, json

我在获取返回 JsonResult 以接受通过 JQuery getJSON 方法传递的参数的控制器方法时遇到问题。

当 getJSON 方法调用的第二个参数（“数据”）为空时，我正在处理的代码可以正常工作。但是当我尝试在那里传递一个值时，似乎控制器方法甚至从未被调用过。

在这个例子中，我只想使用一个整数。运行良好的 getJSON 调用如下所示：

```
$.getJSON(”/News/ListNewsJson/”, null, ListNews_OnReturn); 
```

控制器方法是这样的：

```
public JsonResult ListNewsJson(int? id)
{
    …
    return Json(toReturn);
} 
```

通过在 ListNewsJson 方法中设置断点，我看到当 getJSON 的 data 参数为 null 时调用此方法，但是当我将其替换为值时，例如 3：

```
$.getJSON(”/News/ListNewsJson/”, 3, ListNews_OnReturn); 
```

…控制器方法/断点永远不会被命中。知道我做错了什么吗？

我还应该提到，如果我通过浏览器手动访问地址（“/News/ListNewsJson/3”），控制器方法可以正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T20:01:41.173

getJSON 需要一组键/值对，而不是裸值，因此您需要使用 { id: 3 } 来传递 id 值。不幸的是，这将变成 /News/ListNewsJson/?id=3 这不是你想要的。我建议只是将值附加到 Url 以在路由表单中构造它。我还假设该值实际上来自一个变量，所以我以这种形式编写了它。如果它可能为 null，那么您需要做一些更复杂的事情来制定 Url，这样才有意义。

```
var id = '3';
$.getJSON(”/News/ListNewsJson/” + id, ListNews_OnReturn); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-22T03:08:35.507

我知道这是一个较旧的线程，但你为什么不使用 MVC Url.Action() 助手？这将确保您的路线是正确的。

```
$.getJSON('<%=Url.Action("ListNewsJson", "News") %>/' + id, ListNews_OnReturn); 
```

当然，如果 id 值来自 ViewData，您可以使用 Url.Action() 辅助方法的第三个参数来传递具有 id 属性的匿名类型，MVC 将创建所需的 URL。否则，如果值来自 javascript 函数，则在 javascript 中连接它。

高温高压

# sharepoint - 使用同一页面上另一个 Web 部件的值过滤内容查询 Web 部件

> ID：659864
> 
> 赞同：1
> 
> 时间：2009-03-18T19:58:08.390
> 
> 标签：sharepoint, moss, web-parts

我的页面上有一个内容查询 Web 部件，它汇总了我网站集中所有子网站中的所有联系人列表。这很好用。我希望能够通过让用户单击页面顶部的 aphhabet 字母列表来动态过滤联系人汇总。点击A，查看以A开头的联系人等...

我在页面上添加了各种过滤器 Web 部件，但看不到如何过滤 CQWP 的结果。连接菜单没有太大帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T21:57:39.790

您不能像那样使用 OOB 过滤器 webpart 或 CQWP。

您可以做的是扩展 CQWP 并为其添加一些功能 - 请查看 codeplex.com 上的[增强内容查询 Web 部件](http://www.codeplex.com/ECQWP)以获得灵感。

然后将单击的字母发送到 QueryString 并让您的扩展 CQWP 从查询字符串中读取过滤器值 - 这将执行得非常好

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T21:53:49.813

一般来说，这种事情需要一些发展。这是一个来源：

[http://www.andrewconnell.com/blog/archive/2008/02/18/Subclassing-the-Content-Query-Web-Part-Adding-Dynamic-Filtering.aspx](http://www.andrewconnell.com/blog/archive/2008/02/18/Subclassing-the-Content-Query-Web-Part-Adding-Dynamic-Filtering.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-28T21:43:43.280

我不建议您使用 cqwp .... 而是尝试使用 dataview Web 部件，它允许您使用查询字符串参数过滤内容而无需编码。

# python - 多处理：在进程之间共享一个大的只读对象？

> ID：659865
> 
> 赞同：123
> 
> 时间：2009-03-18T19:58:46.253
> 
> 标签：python, multiprocessing

[通过多](http://docs.python.org/library/multiprocessing.html)处理生成的子进程是否共享程序中先前创建的对象？

我有以下设置：

```
do_some_processing(filename):
    for line in file(filename):
        if line.split(',')[0] in big_lookup_object:
            # something here

if __name__ == '__main__':
    big_lookup_object = marshal.load('file.bin')
    pool = Pool(processes=4)
    print pool.map(do_some_processing, glob.glob('*.data')) 
```

我正在将一些大对象加载到内存中，然后创建一个需要使用该大对象的工作人员池。大对象是只读访问的，我不需要在进程之间传递它的修改。

我的问题是：大对象是否加载到共享内存中，就像我在 unix/c 中生成一个进程一样，还是每个进程都加载自己的大对象副本？

更新：进一步澄清 - big_lookup_object 是一个共享查找对象。我不需要将其拆分并单独处理。我需要保留一份。我需要拆分它的工作是读取许多其他大文件并根据查找对象查找这些大文件中的项目。

进一步更新：数据库是一个很好的解决方案，memcached 可能是一个更好的解决方案，磁盘上的文件（搁置或 dbm）可能会更好。在这个问题中，我对内存解决方案特别感兴趣。对于最终解决方案，我将使用 hadoop，但我想看看我是否也可以拥有本地内存版本。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-18T20:06:08.807

> 通过多处理生成的子进程是否共享程序中先前创建的对象？

Python < 3.8[否，Python ≥ 3.8 是](https://docs.python.org/3/library/multiprocessing.shared_memory.html#module-multiprocessing.shared_memory)。

进程有独立的内存空间。

**解决方案 1**

为了充分利用拥有大量工人的大型结构，请执行此操作。

1.  将每个工作人员写成一个“过滤器”——从 读取中间结果`stdin`，执行工作，将中间结果写入`stdout`.

2.  将所有工作人员连接为管道：

    ```
    process1 <source | process2 | process3 | ... | processn >result 
    ```

每个进程读取、工作和写入。

这是非常有效的，因为所有进程都是同时运行的。写入和读取直接通过进程之间的共享缓冲区。

* * *

**解决方案 2**

在某些情况下，你有一个更复杂的结构——通常是一个*扇出*结构。在这种情况下，您有一个有多个孩子的父母。

1.  父级打开源数据。父母分叉了许多孩子。

2.  父级读取源代码，将部分源代码分配给每个同时运行的子级。

3.  当父母到达终点时，关闭管道。孩子得到文件的结尾并正常完成。

儿童部分写起来很愉快，因为每个孩子都只是简单地阅读`sys.stdin`。

父母在生成所有孩子和正确保留管道方面有一点花哨的步法，但这还不错。

*扇入*是相反的结构。许多独立运行的进程需要将它们的输入交错到一个公共进程中。收集器不那么容易编写，因为它必须从许多来源中读取。

通常使用`select`模块从许多命名管道中读取，以查看哪些管道有待处理的输入。

* * *

**解决方案 3**

共享查找是数据库的定义。

解决方案 3A – 加载数据库。让工作人员处理数据库中的数据。

[解决方案 3B——使用werkzeug](http://werkzeug.pocoo.org/) （或类似的）创建一个非常简单的服务器，以提供响应 HTTP GET 的 WSGI 应用程序，以便工作人员可以查询服务器。

* * *

**解决方案 4**

共享文件系统对象。Unix OS 提供共享内存对象。这些只是映射到内存的文件，以便交换 I/O 而不是更多的约定缓冲读取。

您可以通过多种方式从 Python 上下文中执行此操作

1.  编写一个启动程序，(1) 将你原来的巨大对象分解成更小的对象，(2) 启动工作人员，每个工作人员都有一个更小的对象。较小的对象可以是腌制的 Python 对象，以节省一点点文件读取时间。

2.  编写一个启动程序，该程序 (1) 读取您的原​​始巨大对象并使用操作写入一个页面结构的字节编码文件，`seek`以确保通过简单的查找可以轻松找到各个部分。这就是数据库引擎所做的——将数据分成页面，通过`seek`.

生成有权访问此大型页面结构文件的工作人员。每个工人都可以找到相关的部分并在那里工作。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-03-18T23:17:12.623

### 通过多处理生成的子进程是否共享程序中*先前*创建的对象？

这取决于。对于全局只读变量，通常可以考虑（除了消耗的内存），否则不应该。

[multiprocessing](http://docs.python.org/dev/library/multiprocessing.html#multiprocessing-programming)的文档说：

`Better to inherit than pickle/unpickle`

> 在 Windows 上，来自多处理的许多类型需要是可挑选的，以便子进程可以使用它们。但是，通常应该避免使用管道或队列将共享对象发送到其他进程。相反，您应该安排程序，以便需要访问在其他地方创建的共享资源的进程可以从祖先进程继承它。

`Explicitly pass resources to child processes`

> 在 Unix 上，子进程可以使用在父进程中使用全局资源创建的共享资源。但是，最好将对象作为参数传递给子进程的构造函数。
> 
> 除了使代码（可能）与 Windows 兼容之外，这还确保只要子进程还活着，该对象就不会在父进程中被垃圾收集。如果在父进程中对对象进行垃圾收集时释放了某些资源，这可能很重要。

`Global variables`

> 请记住，如果在子进程中运行的代码尝试访问全局变量，那么它看到的值（如果有）可能与调用 Process.start() 时父进程中的值不同.

### 例子

在 Windows 上（单 CPU）：

```
#!/usr/bin/env python
import os, sys, time
from multiprocessing import Pool

x = 23000 # replace `23` due to small integers share representation
z = []    # integers are immutable, let's try mutable object

def printx(y):
    global x
    if y == 3:
       x = -x
    z.append(y)
    print os.getpid(), x, id(x), z, id(z) 
    print y
    if len(sys.argv) == 2 and sys.argv[1] == "sleep":
       time.sleep(.1) # should make more apparant the effect

if __name__ == '__main__':
    pool = Pool(processes=4)
    pool.map(printx, (1,2,3,4)) 
```

与`sleep`：

```
$ python26 test_share.py sleep
2504 23000 11639492 [1] 10774408
1
2564 23000 11639492 [2] 10774408
2
2504 -23000 11639384 [1, 3] 10774408
3
4084 23000 11639492 [4] 10774408
4 
```

没有`sleep`：

```
$ python26 test_share.py
1148 23000 11639492 [1] 10774408
1
1148 23000 11639492 [1, 2] 10774408
2
1148 -23000 11639324 [1, 2, 3] 10774408
3
1148 -23000 11639324 [1, 2, 3, 4] 10774408
4 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-03-18T20:45:37.997

[S.Lott](https://stackoverflow.com/questions/659865/python-multiprocessing-sharing-a-large-read-only-object-between-processes/659888#659888)是正确的。Python 的多处理快捷方式有效地为您提供了一个单独的、重复的内存块。

实际上，在大多数 *nix 系统上，使用对 will 的较低级别调用`os.fork()`会为您提供写时复制内存，这可能是您的想法。AFAIK，理论上，在最简单的程序中，您可以从该数据中读取而无需复制。

然而，在 Python 解释器中事情并不是那么简单。对象数据和元数据存储在同一个内存段中，因此即使对象永远不会更改，诸如该对象的引用计数器之类的递增操作也会导致内存写入，从而导致复制。几乎所有的 Python 程序所做的不仅仅是“print 'hello'”，都会导致引用计数增加，因此您可能永远不会意识到写时复制的好处。

即使有人确实设法破解了 Python 中的共享内存解决方案，尝试跨进程协调垃圾收集可能会非常痛苦。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-18T20:44:52.350

如果您在 Unix 下运行，由于[fork 的工作方式](http://unixfaq.blogspot.com/2008/08/whats-difference-between-fork-and-vfork.html)，它们可能共享同一个对象（即，子进程具有单独的内存，但它是写时复制的，因此只要没有人修改它就可以共享它）。我尝试了以下方法：

```
import multiprocessing

x = 23

def printx(y):
    print x, id(x)
    print y

if __name__ == '__main__':
    pool = multiprocessing.Pool(processes=4)
    pool.map(printx, (1,2,3,4)) 
```

并得到以下输出：

```
$ ./mtest.py
23 22995656
1
23 22995656
2
23 22995656
3
23 22995656
4

```

当然，这并不能*证明*没有制作副本，但是您应该能够通过查看输出来验证您的情况，`ps`以查看每个子进程正在使用多少实际内存。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-18T20:14:54.823

不同的进程有不同的地址空间。就像运行解释器的不同实例一样。这就是 IPC（进程间通信）的用途。

为此，您可以使用队列或管道。如果您想稍后通过网络分发进程，您也可以使用 rpc over tcp。

[http://docs.python.org/dev/library/multiprocessing.html#exchanging-objects-between-processes](http://docs.python.org/dev/library/multiprocessing.html#exchanging-objects-between-processes)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-18T21:35:08.517

与多处理本身没有直接关系，但从您的示例来看，您似乎可以只使用[搁置](http://docs.python.org/library/shelve.html)模块或类似的东西。“big_lookup_object”真的必须完全在内存中吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-20T02:36:02.260

不可以，但您可以将数据作为子进程加载，并允许它与其他子进程共享数据。见下文。

```
import time
import multiprocessing

def load_data( queue_load, n_processes )

    ... load data here into some_variable

    """
    Store multiple copies of the data into
    the data queue. There needs to be enough
    copies available for each process to access. 
    """

    for i in range(n_processes):
        queue_load.put(some_variable)

def work_with_data( queue_data, queue_load ):

    # Wait for load_data() to complete
    while queue_load.empty():
        time.sleep(1)

    some_variable = queue_load.get()

    """
    ! Tuples can also be used here
    if you have multiple data files
    you wish to keep seperate.  
    a,b = queue_load.get()
    """

    ... do some stuff, resulting in new_data

    # store it in the queue
    queue_data.put(new_data)

def start_multiprocess():

    n_processes = 5

    processes = []
    stored_data = []

    # Create two Queues
    queue_load = multiprocessing.Queue()
    queue_data = multiprocessing.Queue()

    for i in range(n_processes):

        if i == 0:
            # Your big data file will be loaded here...
            p = multiprocessing.Process(target = load_data,
            args=(queue_load, n_processes))

            processes.append(p)
            p.start()   

        # ... and then it will be used here with each process
        p = multiprocessing.Process(target = work_with_data,
        args=(queue_data, queue_load))

        processes.append(p)
        p.start()

    for i in range(n_processes)
        new_data = queue_data.get()
        stored_data.append(new_data)    

    for p in processes:
        p.join()
    print(processes) 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2015-12-07T21:37:24.883

对于 Linux/Unix/MacOS 平台，forkmap 是一个快速而简单的解决方案。

# c# - C# 是否支持基于索引的排序？

> ID：659866
> 
> 赞同：9
> 
> 时间：2009-03-18T19:58:47.110
> 
> 标签：c#, indexing, sorting

**是否有任何内置的 C# 支持进行索引排序？**

更多详细信息：
我有几组数据存储在单个通用双列表中。这些列表的长度总是相等，并保存相应的数据项，但是这些列表动态地来来去去，所以我不能将相应的数据项干净地存储在一个类或结构中。（我也在处理一些遗留问题。）

我需要能够从任何一个数据集中对这些键控进行排序。

我认为最好的方法是添加一个间接级别，并使用基于索引的排序。这种类型已经使用了多年。

基于索引的排序的快速定义**：**
制作“索引”，一个与列表长度相同的连续整数数组，然后排序算法对整数列表进行`anylist[index[N]]`排序，以便按排序顺序给出 anylist 的第 N 项。列表本身永远不会重新排序。

是否有任何内置的 C# 支持进行索引排序？我一直找不到它......我找到的所有东西都会重新排序集合本身。我的猜测是支持存在，但我还没有找到正确的地方。

我在 Windows 下使用 C#.NET 3.5。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-18T20:23:33.213

设置索引数组后，您可以使用自定义`Comparison<T>`比较数据数组中相应项目中的值的自定义对其进行排序：

```
Array.Sort<int>(index, (a,b) => anylist[a].CompareTo(anylist[b])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T20:46:34.873

以下代码实现了索引排序。注意 ToArray() 调用克隆数据数组。如果省略，数据数组也会排序。

```
static void Main(String[] args)
{
   Int32[] data = new Int32[] { -6, 6, 5, 4, 1, 2, 3, 0, -1, -2, -3, -4, -5 };

   Int32[] indices = Enumerable.Range(0, data.Length).ToArray();

   Array.Sort(data.ToArray(), indices);

   foreach (Int32 index in indices)
   {
       Console.Write(String.Format("{0} ", data[index]));
   }

   Console.ReadLine();
} 
```

输出如预期。

```
-6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 
```

# c# - 在哪里指定基类使用的标志

> ID：659870
> 
> 赞同：0
> 
> 时间：2009-03-18T20:00:35.797
> 
> 标签：c#, architecture

我有一个名为 Request.cs 的基类

在这个类中，我有以下私有字段：

```
protected string _requestURI = xxpConfig.xxEndpoint;
protected string _requestURIAuthBased = xxConfig.xxEndpoint + "?SessionID="; 
```

端点只是一个字符串，例如“ [http://SomeThridPartyAPIURIEndPoint](http://SomeThridPartyAPIURIEndPoint) ”

在这个类中，我有一个名为 SendRequest 的方法。

例如，子类代表某些 API 调用：

UpdateCustomerRequest.cs（继承 Request.cs） DeleteCustomerRequest.cs（继承 Request.cs）

等等。

Request 类有一个名为 SendRequest 的方法，它接受 URI 并完成发送 API 请求的工作。

某些类型的 API 调用需要传递 sessionID，而另一些则不需要。URI 中的唯一区别是添加了一个名为 sessionID 的参数。

因此，我试图找出为每种类型的 API 调用（子类）设置“标志”的最佳和最有效的方法，因为每种 API 调用可能需要也可能不需要 auth 格式的 URI 与常规。因此，在我的基类中，我可以检查是否需要在我的 Request.SendMethod 中使用 _requestURI 与 _requestURIAuthBased 来获取我将要调用的子类来进行 API 调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T20:13:46.700

如果我按照您的要求进行操作，那么我能想到的最好方法是遵循 EventArgs 类的模型。所有事件处理程序都采用 EventArgs 对象，但是，有时会传递派生类：

```
 public class RequestArgs { } 
 public class Request 
 {  // ...
     void virtual SendRequest(RequestArgs args);
 }

 // ----------------------------

 public class UpdateArgs : RequestArgs 
 { 
      public string SessionID {get; set;}
 }  

 class UpdateCustomerRequest : Request
 {  // ...
     void SendRequest(RequestArgs args)
     {
        UpdateArgs updateArgs = args as UpdateArgs ;
       // :
     }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T20:19:04.113

在基类中创建一个属性

```
...

// base class
abstract string RequestURI { get; };

// class that needs auth
override string RequestURI { get { return _requestURIAuthBased; } }

// class that dosn't needs auth
override string RequestURI { get { return _requestURI; } }

.... 
```

# java - 编组时如何防止 JAXB 绑定 @XmlRootElement 的超类方法？

> ID：659872
> 
> 赞同：10
> 
> 时间：2009-03-18T20:01:04.000
> 
> 标签：java, xml, inheritance, annotations, jaxb

我有一个被注释为`@XmlRootElement`with的类`@XmlAccessorType(XmlAccessType.NONE)`。我遇到的问题是超类的方法正在被绑定，当我不希望它们被绑定并且无法更新类时。我希望有一个注释可以放在根元素类上以防止这种情况发生。

例子：

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.NONE)
public class Person extends NamedObject {

    @XmlElement
    public String getId() { ... }

} 
```

我希望只有注释的方法`@XmlElement`会`Person`被绑定和编组，但超类的方法也都被绑定了。生成的 XML 然后包含太多信息。

如何防止超类的方法被绑定而不必注释超类本身？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-06-18T04:56:34.090

根据这个 StackOverflow 帖子： [如何忽略超类？](https://stackoverflow.com/questions/1386192/jax-b-how-can-i-ignore-a-superclass)

JAX-B 不可能在不修改超类的情况下忽略超类。引用该帖子的相关部分：

> Update2：我[在 java.net 上找到了](http://forums.java.net/jive/thread.jspa?threadID=13932&tstart=0) 一个类似问题的线程。该线程产生了一个[增强请求](https://jaxb.dev.java.net/issues/show%5Fbug.cgi?id=133)，该请求被标记为 [另一个问题](https://jaxb.dev.java.net/issues/show%5Fbug.cgi?id=216)的副本，这导致了@XmlTransient 注释。对这些错误报告的评论让我相信这在当前规范中是不可能的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-22T01:40:22.357

只需添加

```
@XmlAccessorType(XmlAccessType.NONE) 
```

在每个超类声明（和类本身）之前。

在你的情况下：

```
@XmlAccessorType(XmlAccessType.NONE)
class NamedObject{
    [ ... ]
} 
```

请记住，这必须为每个超类真正完成，在处理巨大的类依赖树时经常被遗忘。

当然，接口不需要任何 JAXB 注释。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-19T10:01:37.477

我知道这个问题已经很老了，但是如果你的超类与其子类在同一个包中，那么有一种解决方案可以工作。

在你的包中创建一个`package-info.java`并插入

```
@XmlAccessorType(XmlAccessType.NONE)
package my.package.with.classes; 
```

显然，它在包中的所有类上设置了 XmlAccessType.NONE。我自己，我在我们的域模型的每个包中都使用它。因此，我很安全。但是，如果您的课程“遥不可及”，如果它在 JDK 中，请使用[[JAX-B] 如何忽略超类中接受的答案中的解决方案？](https://stackoverflow.com/questions/1386192/jax-b-how-can-i-ignore-a-superclass).

我希望它对任何像我一样偶然发现这个问题的人都有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T16:50:31.420

我面临着完全相同的问题。我的超类不处理任何 JAXB 注释（它不是必须的），我希望我的子类在编组时不包含超类属性。

在超类上添加 XmlAccesorType 不是解决方案，因为我无法修改超类。

还有其他解决方案吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-27T14:12:08.190

[用MOXy](http://wiki.eclipse.org/EclipseLink/UserGuide/MOXy)替换您的 JAX-B 实现，您可以做任何您想做的事情。它有大量超越普通 JAX-B 的扩展，其中一个允许您忽略继承的属性等。它还支持将 JAX-B 注释移动到 XML 映射文件，因此您可以保留多组映射.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-20T09:35:39.080

我找到了一个解决方案，但根据您想要做什么，它可能对您不起作用，是覆盖您想要忽略的 getter 并让它们 return `null`。JAXB 规范以及扩展的实现忽略包含空值的字段。请注意，如果您仍然需要能够使用子类访问超类值本身，您可能需要添加一个不是 getter 的辅助访问器方法并相应地调整您的代码。

# c - char * 函数在 C 中无法正确显示

> ID：659873
> 
> 赞同：2
> 
> 时间：2009-03-18T20:01:14.233
> 
> 标签：c, char

```
#include <time.h>
#include <stdio.h>
#include <stdlib.h>

char *czas()
{
  time_t rawtime;
  struct tm * timeinfo;
  char buffer [80];
  time ( &rawtime );
  timeinfo = localtime ( &rawtime );
  strftime (buffer,80,"Now it's %I:%M%p.",timeinfo);
  return buffer;
}

int main()
{
printf("%s",czas());
system("PAUSE");
} 
```

我不知道为什么，但这个程序的结果只是“按任意键（...）”。我也尝试将其打印为 %c 但它仍然无法正常工作。这个程序有什么问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-18T20:07:55.090

您正在返回一个指向局部变量（“缓冲区”）的指针，这是无效的，我很惊讶您没有收到有关它的警告。

当函数退出时，所有局部变量都不再存在（称为超出范围），它们的内存将用于其他目的。您正在返回一个指向此内存的指针，但不能保证现在会有什么。

在这种情况下，似乎在 printf 调用时内存包含一个 0 ，它被视为空字符串。这实际上是非常幸运的，您很容易以打印垃圾或程序崩溃而告终。

要解决此问题，您可以将缓冲区传递给 czas，或者让 czas 在堆上分配一个缓冲区，稍后您可以释放该缓冲区。我会推荐前者，因为它与几乎所有库函数的工作方式一致。它还避免了调用者稍后必须释放指针的内存分配。

例如：

```
size_t czas(char* buffer, size_t buffer_size)
{
    time_t rawtime;
    struct tm * timeinfo;

    time ( &rawtime );
    timeinfo = localtime ( &rawtime );
    return strftime (buffer, buffer_size,"Now it's %I:%M%p.",timeinfo);
}

int main()
{
    char buffer [80];
    if (czas(buffer, 80))
    {
      printf("%s\n",buffer);
    }
    else
    {
      printf("Call to czas failed");
    }
    system("PAUSE");
} 
```

更新：我没有注意到 strftime 采用了大小参数，我已经更新了代码以使用它并正确地从 strftime 传回结果。因此，这更加健壮，您不会意外溢出缓冲区。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-18T20:03:58.843

该语句在 csas 的堆栈中分配`char buffer [80];`。`buffer`将其替换为对`malloc`( `char *buffer = malloc (80)`) 的调用，您应该会没事的。稍后您必须自己释放缓冲区。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-18T20:06:17.437

函数中的返回缓冲区应该在堆栈之外的某个地方。由于您已将自动变量声明为固定大小的数组，因此它位于堆栈上。您返回一个指向它的指针，但是，随后的函数调用可以“乱涂乱画”该空间。

任何一个：

*   使用静态缓冲区，并实现函数不可重入
*   用 malloc() 分配一个缓冲区，然后记得在调用者中释放它

这两种选择都有缺点。在我列举它们之前，您将有 17 个答案:-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-18T20:03:29.097

因为 buffer 是一个局部变量，当函数返回时会消失 - 你看到的是未定义的行为。一个快速而肮脏的解决方法是使缓冲区静态，以便它在函数调用后挂起 - 更改：

```
char buffer [80]; 
```

到：

```
static char buffer [80]; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-18T20:22:27.223

不要使用静态缓冲区，除非您确定永远不会在多线程代码中使用它，并且在使用第一个答案之前永远不会调用它两次。

Malloc 是一种选择，但强制调用者释放被调用者分配的内存可能会留下未解决的所有权问题，并消除使用除堆内存之外的任何内容作为缓冲区的可能性。

在我看来，你最好的选择是修改 Andrew Grant 的建议，但也要传递缓冲区的长度：

```
char *czas(char *buffer, size_t bufferLength)
{
  time_t rawtime;
  struct tm * timeinfo;
  time ( &rawtime );
  timeinfo = localtime ( &rawtime );
  strftime (buffer, bufferLength, "Now it's %I:%M%p.",timeinfo);
  return buffer;
}

int main()
{
   char buffer [80];
   printf("%s",czas(buffer, sizeof(buffer)));
   system("PAUSE");
} 
```

或者

```
#define TIME_BUFFER_LENGTH 80
int main()
{
   char *buffer = malloc(TIME_BUFFER_LENGTH);
   if (buffer)
       printf("%s",czas(buffer, TIME_BUFFER_LENGTH));
   free(buffer);
   system("PAUSE");
} 
```

这使得跟踪潜在的内存泄漏和缓冲区溢出变得更加容易。您可以查看`czas`并看到，只要参数正确，该函数就不会溢出任何缓冲区或泄漏任何内存。接下来，您可以查看任一版本，`main`并看到没有内存泄漏，并且传递给 czas 的参数是正确的（bufferLength 参数准确地指定了缓冲区指向的空间量。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T20:04:14.133

您调用 czas() 但返回后，czas 创建的缓冲区不再存在。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-18T20:04:15.693

您正在返回分配在堆栈上的“缓冲区”。但是一旦函数返回，堆栈的那部分就不再有效。

在堆上为返回的字符串分配内存或使用 std::string 作为返回值。

# apache - 如何隐藏单个域下的分布式服务器？

> ID：659874
> 
> 赞同：1
> 
> 时间：2009-03-18T20:01:24.640
> 
> 标签：apache, debian

我目前在不同的服务器上托管我公司的网站和博客，通过不同的域名访问 - www.example.com 和 www.example.net。这样我就可以让我们的合作伙伴访问博客服务器，而不会影响我们主服务器的安全性。但是，我们的 SEO 人员现在要求将博客放在我们的主服务器上，例如 www.example.com/blog。

我想保持当前的服务器分离，而不是将两者放在同一台服务器上。有什么好的方法可以将它们分开，但将它们都放在一个域名下？子域也是可以接受的（blog.example.com）。

我的主要网站服务器是一个运行 Apache 2 的 Debian 机器，我对它具有完全的 root 访问权限。博客服务器由 Hostgator 运行，我的访问权限有限。

编辑：谢谢大家。在这种特殊情况下，我不想*再次*转移博客，而且我无法轻松访问 DNS 记录，所以我选择了 mod_proxy，它就像一个魅力。不过，我希望我能给你所有的“首选答案”状态，因为你所有的信息都很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T20:11:58.980

子域很容易：只需在 DNS 中创建一条 A 记录，将 blog.example.com 映射到博客服务器的 IP 地址，并在 DNS 中创建另一个 A 记录，将 www.example.com 映射到主网站服务器（这后者的记录可能已经存在）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T20:16:40.327

SEO 人员会对 blog.example.com 感到满意吗？从 SEO 的角度来看是不一样的，但对他来说可能已经足够了。我在一家公司工作，其中 SEO 至少是我们工作的 1/3，这就是我们的设置：blog.example.com 和 www.example.com。

如果您坚持将博客放在您的盒子之外，您可以尝试将花哨的和代理请求发送到 /blog 到第二台服务器，但我认为您可以找到一种安全的方式来共享空间。像这样的代理可能会很烦人，而且它基本上会使您的博客的延迟加倍。

在你的盒子上给博客的人一个帐户；不要给他们root/特殊权限。如果你能侥幸逃脱，甚至不要给他们 SSH 访问权限——只要给他们一个 FTP 登录名（确保他们不能访问 /var/www），也许是一个 mysql 帐户或其他什么东西。（如您所见，这一切都取决于博客人们需要多少控制/权力。）

然后，只需对博客根目录建立一个符号链接，这样他们就可以写到 /home/blog/www 之类的受限区域，并且仍然将其包含在网站中：

```
ln -s ~blog/www /var/www/blog 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T20:16:53.930

如果由于某种原因无法使用子域，您可以使用[Apache 的 mod_proxy 模块](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html)将 /blog 的请求代理到您的第二台服务器。

# php - 如果 php mysql 客户端与 mysql 服务器版本不匹配会出现什么问题？

> ID：659877
> 
> 赞同：1
> 
> 时间：2009-03-18T20:02:05.167
> 
> 标签：php, mysql, phpmyadmin

我有两个 mysql 服务器 5.1.32 和 5.0.77 安装（同一台机器，os x leopard）。我的 php mysql 扩展是针对 5.0.77 编译的（这是最简单的事情，我是在安装 5.1.32 后完成的）。我正在使用 5.1.32 安装，因为那是我编译我的 python MySQLdb 扩展时所针对的。如果有的话，我不会在 php 中编码。我的php安装主要使用的是phpmyadmin。phpmyadmin 以这种方式针对 5.1.32 mysql 服务器工作，但显示警告：

“您的 PHP MySQL 库版本 5.0.77 与您的 MySQL 服务器版本 5.1.32 不同。这可能会导致不可预知的行为。”。

我的问题。我可以期待这种设置的 phpmyadmin 会出现任何严重问题吗？

我正在使用最新版本的 phpmyadmin，它通过 tcp 连接（不是套接字文件）进行连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T20:09:29.020

你不应该有任何问题，所有的查询都是通过 TCP 发送的，它们都是非常标准的。

我认为唯一不好的是你不能使用ceratin功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T20:12:57.293

如果开发人员受人尊敬，在较新的服务器版本上使用较旧的客户端版本不应该导致任何软件出现问题。

根据开发人员的政策，使用较新的客户端版本和较旧的服务器版本可能会导致问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T21:25:54.107

您应该没问题，但是两个版本之间的某些功能/错误/怪癖可能会有所不同。我建议查看 MySQL 从 5.0.77 到 5.1.32 的变更日志（如果有时间的话，可以查看过去）。

在 MySQL 4.11 和更高版本之间存储的 MySQL 用户密码存在问题，连接到低于该版本的版本。既然你已经这么远了，我敢肯定不是这样。作为参考，这是一个简单的修复方法，涉及使用 OLD_PASSWORD() 更新用户密码。

# visual-studio - 在 Visual Studio 中运行 MSIL

> ID：659878
> 
> 赞同：3
> 
> 时间：2009-03-18T20:02:08.427
> 
> 标签：visual-studio, visual-studio-2005, cil

我们有 Visual Studio 2005。

我可以使用“ilasm”从命令行成功运行 MSIL 程序。

我希望能够在 VS 中运行这些。

从其他帖子和搜索中，我知道您需要创建一个“控制台应用程序”类型的项目？（他们暗示 VS 可以处理 MSIL，但我找不到任何具体的“如何”。）

“控制台应用程序”提供标准 Program.cs

```
using System;
using System.Collections.Generic;
using System.Text;

    namespace AddNumbers
    {
        class Program
        {
            static void Main(string[] args)
            {

            }
        }
    } 
```

然后我将我的 .il 文件（添加两个数字）添加到项目中。该项目成功构建，当我运行它时它什么也不做，并且我在 .il 文件中设置的断点不会被触发。不足为奇，因为 .il 文件没有被调用。

有些人可以提供一个逐步的方法来让它工作吗？

我还想知道我需要将什么命名空间添加到 .il 文件，以及是否可以将参数传递给 .il 文件以及（如果可以）如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T20:04:01.060

您将需要某种 ILASM MSBuild 任务。

您需要为 ILASM 启用行号和调试选项。

这是一个[完整的例子](http://msdn.microsoft.com/en-us/library/microsoft.build.utilities.tooltask.generatefullpathtotool(VS.80).aspx)，由 MSDN 提供。

# sql - 通过 JSP 的 SQL Server/T-SQL：“无法绑定多部分标识符 XX.YY”

> ID：659882
> 
> 赞同：0
> 
> 时间：2009-03-18T20:03:57.503
> 
> 标签：sql, sql-server, tsql, jsp, jdbc

我收到错误：

```
 the multi-part identifier "IC.industry" could not be bound 
```

通过 JDBC 从 JSP 页面进行此 SQL 查询时：

```
select C.company, C.shname, C.fullname, count(d_to_c.designer)
from companies C
     left join ind_to_c IC on C.company = IC.company
     left join d_to_c on C.company= d_to_c.company
where IC.industry = ?
group by C.company, C.shname, C.fullname
order by C.shname 
```

我正在尝试将其作为准备好的语句运行，在`stmt.setObject(1, 7)`运行之前通过（例如）设置参数`stmt.executeQuery()`。

现在，奇怪的是：如果我使用`?`刚才提到的并设置参数执行此操作，我会收到“无法绑定”错误。但是，如果我只是更改查询并将数字 7 硬编码到查询的文本中，它就可以工作！

所以它与绑定该参数有关*。*

但我似乎无法弄清楚是什么。

有人吗？

**更新**：根据请求，表定义`ind_to_c`：

```
 industry - int(11)
 company - int(11) 
```

（只是一个定义行业和公司之间m2m关系的表格）

**更新 2**：同样根据请求，完整的 JSP 代码。我不得不把它从对数据库连接抽象的调用中提取出来（我们用它来存储准备好的语句等）。

// conn 已被初始化为 db 连接对象。

```
int parent_id = 7;
PreparedStatement ps = conn.prepareStatement("select C.company, C.shname, C.fullname, count(d_to_c.designer) from companies C left join ind_to_c IC on C.company = IC.company left join d_to_c on C.company = d_to_c.company where IC.industry = ? group by C.company, C.shname, C.fullname order by C.shname");
ps.setObject(1, parent_id);
ResultSet rs = null;
rs = ps.executeQuery(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T20:43:12.743

行业的数据类型是什么？如果您改用特定于类型的绑定方法，会有所不同`stmt.setInt(1,7)`吗？

***编辑：***也，与问题无关，但您可能应该`C.cid`从`SELECT`. T-SQL 的某些变体会推断您希望按该列进行分组，因为它不是聚合函数的主题，即使您没有在`GROUP BY`子句中指定它。

回到主题，您可以发布表定义`ind_2_c`吗？错误的性质似乎表明它没有名为 的列`industry`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T20:17:31.807

您是否尝试过传递命名参数（即：@industry）而不是问号？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T13:37:31.510

也许我只是想在这里简单一点，因为我不太了解 JSP，但它不仅可以工作：

```
int parent_id = 7;
PreparedStatement ps = conn.prepareStatement("select C.company, C.shname, C.fullname, count(d_to_c.designer) from companies C left join ind_to_c IC on C.company = IC.company left join d_to_c on C.company = d_to_c.company where IC.industry = ? group by C.company, C.shname, C.fullname order by C.shname");

ps.setInt(1, parent_id );

ResultSet rs = null;
rs = ps.executeQuery(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T14:54:07.163

我从您的评论中看到您只能使用 SetObject。

但是为什么你传递一个对象数组而不是单个对象呢？（如果我正确阅读 Java）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T19:04:17.333

我升级到更新的 2.0 版 MS-SQL JDBC 驱动程序，它神奇地工作了。

# c# - 从 .NET 中的字符串获取 URL 参数

> ID：659887
> 
> 赞同：293
> 
> 时间：2009-03-18T20:05:12.460
> 
> 标签：c#, .net, url, parsing, parameters

我在 .NET 中有一个字符串，它实际上是一个 URL。我想要一种简单的方法来从特定参数中获取值。

通常，我只会使用`Request.Params["theThingIWant"]`，但这个字符串不是来自请求。我可以像这样创建一个新`Uri`项目：

```
Uri myUri = new Uri(TheStringUrlIWantMyValueFrom); 
```

我可以`myUri.Query`用来获取查询字符串……但显然我必须找到一些正则表达式来拆分它。

我是否遗漏了一些明显的东西，或者除了创建某种正则表达式等之外，没有内置的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：581
> 
> 时间：2009-03-18T20:19:57.700

使用返回的类的静态`ParseQueryString`方法。`System.Web.HttpUtility``NameValueCollection`

```
Uri myUri = new Uri("http://www.example.com?param1=good&param2=bad");
string param1 = HttpUtility.ParseQueryString(myUri.Query).Get("param1"); 
```

[在http://msdn.microsoft.com/en-us/library/ms150046.aspx](http://msdn.microsoft.com/en-us/library/ms150046.aspx)查看文档

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-03-18T20:27:24.233

这可能是你想要的

```
var uri = new Uri("http://domain.test/Default.aspx?var1=true&var2=test&var3=3");
var query = HttpUtility.ParseQueryString(uri.Query);

var var2 = query.Get("var2"); 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2013-11-22T00:56:48.990

如果出于某种原因您不能或不想使用`HttpUtility.ParseQueryString()`.

这是为了对“格式错误”的查询字符串有一定的容忍度，即`http://test/test.html?empty=`成为具有空值的参数。如果需要，调用者可以验证参数。

```
public static class UriHelper
{
    public static Dictionary<string, string> DecodeQueryParameters(this Uri uri)
    {
        if (uri == null)
            throw new ArgumentNullException("uri");

        if (uri.Query.Length == 0)
            return new Dictionary<string, string>();

        return uri.Query.TrimStart('?')
                        .Split(new[] { '&', ';' }, StringSplitOptions.RemoveEmptyEntries)
                        .Select(parameter => parameter.Split(new[] { '=' }, StringSplitOptions.RemoveEmptyEntries))
                        .GroupBy(parts => parts[0],
                                 parts => parts.Length > 2 ? string.Join("=", parts, 1, parts.Length - 1) : (parts.Length > 1 ? parts[1] : ""))
                        .ToDictionary(grouping => grouping.Key,
                                      grouping => string.Join(",", grouping));
    }
} 
```

**测试**

```
[TestClass]
public class UriHelperTest
{
    [TestMethod]
    public void DecodeQueryParameters()
    {
        DecodeQueryParametersTest("http://test/test.html", new Dictionary<string, string>());
        DecodeQueryParametersTest("http://test/test.html?", new Dictionary<string, string>());
        DecodeQueryParametersTest("http://test/test.html?key=bla/blub.xml", new Dictionary<string, string> { { "key", "bla/blub.xml" } });
        DecodeQueryParametersTest("http://test/test.html?eins=1&zwei=2", new Dictionary<string, string> { { "eins", "1" }, { "zwei", "2" } });
        DecodeQueryParametersTest("http://test/test.html?empty", new Dictionary<string, string> { { "empty", "" } });
        DecodeQueryParametersTest("http://test/test.html?empty=", new Dictionary<string, string> { { "empty", "" } });
        DecodeQueryParametersTest("http://test/test.html?key=1&", new Dictionary<string, string> { { "key", "1" } });
        DecodeQueryParametersTest("http://test/test.html?key=value?&b=c", new Dictionary<string, string> { { "key", "value?" }, { "b", "c" } });
        DecodeQueryParametersTest("http://test/test.html?key=value=what", new Dictionary<string, string> { { "key", "value=what" } });
        DecodeQueryParametersTest("http://www.google.com/search?q=energy+edge&rls=com.microsoft:en-au&ie=UTF-8&oe=UTF-8&startIndex=&startPage=1%22",
            new Dictionary<string, string>
            {
                { "q", "energy+edge" },
                { "rls", "com.microsoft:en-au" },
                { "ie", "UTF-8" },
                { "oe", "UTF-8" },
                { "startIndex", "" },
                { "startPage", "1%22" },
            });
        DecodeQueryParametersTest("http://test/test.html?key=value;key=anotherValue", new Dictionary<string, string> { { "key", "value,anotherValue" } });
    }

    private static void DecodeQueryParametersTest(string uri, Dictionary<string, string> expected)
    {
        Dictionary<string, string> parameters = new Uri(uri).DecodeQueryParameters();
        Assert.AreEqual(expected.Count, parameters.Count, "Wrong parameter count. Uri: {0}", uri);
        foreach (var key in expected.Keys)
        {
            Assert.IsTrue(parameters.ContainsKey(key), "Missing parameter key {0}. Uri: {1}", key, uri);
            Assert.AreEqual(expected[key], parameters[key], "Wrong parameter value for {0}. Uri: {1}", parameters[key], uri);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-03-18T20:11:07.923

看起来你应该循环`myUri.Query`并从那里解析它的值。

```
 string desiredValue;
 foreach(string item in myUri.Query.Split('&'))
 {
     string[] parts = item.Replace("?", "").Split('=');
     if(parts[0] == "desiredKey")
     {
         desiredValue = parts[1];
         break;
     }
 } 
```

但是，如果不对一堆格式错误的 URL 进行测试，我不会使用此代码。它可能会在某些/所有这些上中断：

*   `hello.html?`
*   `hello.html?valuelesskey`
*   `hello.html?key=value=hi`
*   `hello.html?hi=value?&b=c`
*   ETC

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2011-09-27T17:14:56.373

@Andrew 和 @CZFox

我有同样的错误，发现原因是参数一实际上是：`http://www.example.com?param1`而不是`param1`人们所期望的。

通过删除之前的所有字符并包括问号可以解决此问题。所以本质上该`HttpUtility.ParseQueryString`函数只需要一个有效的查询字符串参数，该参数只包含问号后的字符，如：

```
HttpUtility.ParseQueryString ( "param1=good&param2=bad" ) 
```

我的解决方法：

```
string RawUrl = "http://www.example.com?param1=good&param2=bad";
int index = RawUrl.IndexOf ( "?" );
if ( index > 0 )
    RawUrl = RawUrl.Substring ( index ).Remove ( 0, 1 );

Uri myUri = new Uri( RawUrl, UriKind.RelativeOrAbsolute);
string param1 = HttpUtility.ParseQueryString( myUri.Query ).Get( "param1" );` 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-06-15T12:40:03.833

您也可以使用以下解决方法使其与第一个参数一起使用：

```
var param1 =
    HttpUtility.ParseQueryString(url.Substring(
        new []{0, url.IndexOf('?')}.Max()
    )).Get("param1"); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2021-05-16T08:30:53.930

您可以只使用**Uri**来获取查询字符串列表或查找特定参数。

```
Uri myUri = new Uri("http://www.example.com?param1=good&param2=bad");
var params = myUri.ParseQueryString();
var specific = myUri.ParseQueryString().Get("spesific");
var paramByIndex = = myUri.ParseQueryString().Get(1); 
```

您可以从这里找到更多信息：[https ://docs.microsoft.com/en-us/dotnet/api/system.uri?view=net-5.0](https://docs.microsoft.com/en-us/dotnet/api/system.uri?view=net-5.0)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-18T20:20:14.423

使用 .NET Reflector 查看 .NET 的`FillFromString`方法`System.Web.HttpValueCollection`。这为您提供了 ASP.NET 用来填充`Request.QueryString`集合的代码。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-12-01T03:58:02.950

或者如果您不知道 URL（为了避免硬编码，请使用`AbsoluteUri`

例子 ...

```
 //get the full URL
        Uri myUri = new Uri(Request.Url.AbsoluteUri);
        //get any parameters
        string strStatus = HttpUtility.ParseQueryString(myUri.Query).Get("status");
        string strMsg = HttpUtility.ParseQueryString(myUri.Query).Get("message");
        switch (strStatus.ToUpper())
        {
            case "OK":
                webMessageBox.Show("EMAILS SENT!");
                break;
            case "ER":
                webMessageBox.Show("EMAILS SENT, BUT ... " + strMsg);
                break;
        } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-04-27T15:49:03.063

单行 LINQ 解决方案：

```
Dictionary<string, string> ParseQueryString(string query)
{
    return query.Replace("?", "").Split('&').ToDictionary(pair => pair.Split('=').First(), pair => pair.Split('=').Last());
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-12-06T11:27:53.677

如果您想在默认页面上获取您的 QueryString。默认页面表示您当前的页面网址。你可以试试这段代码：

```
string paramIl = HttpUtility.ParseQueryString(this.ClientQueryString).Get("city"); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-02-28T15:19:38.933

这实际上非常简单，对我有用:)

```
 if (id == "DK")
        {
            string longurl = "selectServer.aspx?country=";
            var uriBuilder = new UriBuilder(longurl);
            var query = HttpUtility.ParseQueryString(uriBuilder.Query);
            query["country"] = "DK";

            uriBuilder.Query = query.ToString();
            longurl = uriBuilder.ToString();
        } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-07-05T04:50:40.857

对于任何想要遍历字符串中的所有查询字符串的人

```
 foreach (var item in new Uri(urlString).Query.TrimStart('?').Split('&'))
        {
            var subStrings = item.Split('=');

            var key = subStrings[0];
            var value = subStrings[1];

            // do something with values
        } 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2015-01-06T11:43:08.173

```
HttpContext.Current.Request.QueryString.Get("id"); 
```

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2016-05-17T14:29:28.373

我用了它，它运行得很好

```
<%=Request.QueryString["id"] %> 
```

# asp.net-2.0 - 将 ASP.NET 2.0 FormView - CheckBox 或 RadioButton 绑定到 Oracle CHAR(1) Y/N

> ID：659897
> 
> 赞同：0
> 
> 时间：2009-03-18T20:10:22.697
> 
> 标签：asp.net-2.0

Oracle 9i 没有 BOOLEAN 数据类型。ASP.NET 中的复选框是布尔控件，不是吗？

因此，在 Oracle 表中使用具有 Y 或 N 值的 CHAR(1) 列，如何绑定到 ASP.NET 2.0 Web 表单上的 CheckBox 或 CheckBoxList 或 RadioButton 或 RadioButtonList 控件？

我正在使用 VB，'特别是因为我是个菜鸟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-05T16:09:58.977

我会将值设置为 1 或 0 并具有 int 数据类型

# c# - 从代理后面使用 BugzScout.net 的困难

> ID：659898
> 
> 赞同：4
> 
> 时间：2009-03-18T20:10:35.240
> 
> 标签：c#, proxy, fogbugz, bugzscout

我正在尝试使用 Fogbugz 的 BugzScout 来自动向我的 Fogbugz on demand 帐户提交未经处理的应用程序异常。我已经为它编写了一个包装类，一切看起来都很时髦——在我的盒子上。在生产环境中测试相同的代码，在需要身份验证的代理后面，我除了问题什么都没有。

我开始修改 BugzScout 代码以使其通过代理进行身份验证，在尝试了通过 Google 搜索建议的许多不同方法后，找到了一个可行的方法！但是现在我收到了来自 Fogbugz 本身的“主动拒绝连接”错误，我不知道该怎么办。

这是 BugzScout 通过 .net WebClient 连接以提交新案例的代码，以及我为处理我们的代理所做的修改。我在做什么会导致 Fogbugz 拒绝我的请求？为了便于阅读，我已经从程序中删除了所有与 Web 客户端无关的代码。

```
public string Submit(){         
        WebClient client = new WebClient();
        WebProxy proxy = new WebProxy();
        proxy.UseDefaultCredentials = true;            
        client.Proxy = proxy;            
        Byte[] response = client.DownloadData(fogBugzUrl);
        string responseText = System.Text.Encoding.UTF8.GetString(response);
        return (responseText == "") ? this.defaultMsg : responseText;
    } 
```

网址正确，案例填写正确 - 已验证。

编辑：附加信息。

*   按需使用 Fogbugz。
*   完整使用 FogBugz.net 代码，仅添加这些

```
       WebProxy 代理 = 新的 WebProxy();
       proxy.UseDefaultCredentials = true;            
       client.Proxy = 代理；
```

*   尝试连接到[https://oursite.fogbugz.com/scoutsubmit.asp](https://oursite.fogbugz.com/scoutsubmit.asp)和[http://oursite.fogbugz.com//scoutsubmit.asp](http://oursite.fogbugz.com//scoutsubmit.asp)时发生错误（除了一个说端口 443，另一个说端口 80，显然)
*   我对 Web 身份验证一无所知，所以我无法告诉您我使用的是哪种类型 - 如果您告诉我在哪里查看，我很乐意为您回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-23T12:40:28.823

从 Fogbugz 获得修复 - 这是通过代理身份验证的适当网络代码，而不是使用 Bugzscout 进行错误身份验证。

```
WebRequest.DefaultWebProxy.Credentials = CredentialCache.DefaultNetworkCredentials;
WebRequest request = WebRequest.Create(fogBugzUrl);
request.ContentType = "application/x-www-form-urlencoded";
request.Method = "POST";
request.Proxy.Credentials = CredentialCache.DefaultNetworkCredentials;     
Stream requestStream = request.GetRequestStream();
requestStream.Write(bytes, 0, bytes.Length);
requestStream.Close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T22:48:12.323

您的 fogbugzUrl 是否使用 HTTP 基本身份验证？是 SSL（按需托管吗？）

主动拒绝连接的消息将来自 Web 服务器本身，而不是真正的 FogBugz。

你能发布HTTP状态码吗？

如果您使用 FogBugz On Demand，需要注意的一件事是您必须使用 https:// 网址（而不是 http 网址）。

# mysql - 如何删除mysql数据库中的重复记录？

> ID：659906
> 
> 赞同：13
> 
> 时间：2009-03-18T20:12:44.690
> 
> 标签：mysql, ruby-on-rails, ruby

使用 rails 或 mysql 查询删除 mysql 数据库中重复记录的最佳方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-18T20:16:02.683

您可以通过以下方式将不同的记录复制到新表中：

```
 select distinct * into NewTable from MyTable 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-06-16T08:47:13.263

这是没有特定语言的另一个想法：

```
rs = `select a, b, count(*) as c from entries group by 1, 2 having c > 1`
rs.each do |a, b, c|
  `delete from entries where a=#{a} and b=#{b} limit #{c - 1}`
end 
```

* * *

**编辑：**

[感](https://stackoverflow.com/users/13447/olaf)谢奥拉夫的“有”提示:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-18T21:11:16.873

好吧，如果它是一张小桌子，你可以从 Rails 控制台做

```
class ActiveRecord::Base
  def non_id_attributes
    atts = self.attributes
    atts.delete('id')
    atts
  end
end

duplicate_groups = YourClass.find(:all).group_by { |element| element.non_id_attributes }.select{ |gr| gr.last.size > 1 }
redundant_elements = duplicate_groups.map { |group| group.last - [group.last.first] }.flatten
redundant_elements.each(&:destroy) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-09-15T20:20:27.500

## 检查重复条目：

```
SELECT DISTINCT(req_field) AS field, COUNT(req_field) AS fieldCount FROM 
table_name GROUP BY req_field HAVING fieldCount > 1 
```

## 删除重复查询：

```
DELETE FROM table_name 
USING table_name, table_name AS vtable 
WHERE 
    (table_name.id > vtable.id) 
AND (table_name.req_field=req_field) 
```

替换**req_field**和**table_name** - 应该可以正常工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-18T20:54:57.880

SQL 新手 :-) 这是一个经典问题——在面试中经常被问到:-) 我不知道它是否适用于 MYSQL，但它适用于大多数数据库——

```
> create table t(
>     a char(2),
>     b char(2),
>     c smallint )

> select a,b,c,count(*) from t
> group by a,b,c
> having count(*) > 1
a  b  c
-- -- ------ -----------
(0 rows affected)

> insert into t values ("aa","bb",1)
(1 row affected)

> insert into t values ("aa","bb",1)
(1 row affected)

> insert into t values ("aa","bc",1)
(1 row affected)

> select a,b,c,count(*) from t group by a,b,c having count(*) > 1
a  b  c 
-- -- ------ -----------
aa bb      1           2
(1 row affected) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-13T08:14:31.897

如果您在表 (EMP) 中有 PK (id) 并且想要较旧地删除具有名称列的重复记录。对于大数据，以下查询可能是不错的方法。

```
DELETE t3
FROM (
        SELECT t1.name, t1.id
        FROM (
                SELECT name
                FROM EMP
                GROUP BY name
                HAVING COUNT(name) > 1
        ) AS t0 INNER JOIN EMP t1 ON t0.name = t1.name
) AS t2 INNER JOIN EMP t3 ON t3.name = t2.name
WHERE t2.id < t3.id; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-14T10:25:56.293

假设我们有一个表名**tbl_product**并且字段**p_pi_code**和**p_nats_id**在最大计数中存在重复，然后首先创建一个新表从现有表中插入数据......
即从**tbl_product**到**newtable1**如果还有其他内容，然后从**newtable1**到**newtable2**

```
CREATE TABLE `newtable2` (                                  
            `p_id` int(10) unsigned NOT NULL auto_increment,         
            `p_status` varchar(45) NOT NULL,                         
            `p_pi_code` varchar(45) NOT NULL,                        
            `p_nats_id` mediumint(8) unsigned NOT NULL,              
            `p_is_special` tinyint(4) NOT NULL,                      
             PRIMARY KEY (`p_id`)                                   
      ) ENGINE=InnoDB;

INSERT INTO newtable1 (p_status, p_pi_code, p_nats_id, p_is_special) SELECT 
    p_status, p_pi_code, p_nats_id, p_is_special FROM tbl_product group by p_pi_code;

INSERT INTO newtable2 (p_status, p_pi_code, p_nats_id, p_is_special) SELECT 
    p_status, p_pi_code, p_nats_id, p_is_special FROM newtable1 group by p_nats_id; 
```

之后，我们看到该领域的所有重复性都被删除了

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-18T21:02:51.370

我最近不得不[在 Oracle 上这样做](https://stackoverflow.com/questions/644975/deleting-a-lot-of-data-in-oracle)，但在 MySQL 上的步骤是一样的。这是很多数据，至少与我习惯使用的数据相比，所以我的重复数据删除过程相对重量级。我将它包括在这里，以防其他人遇到类似的问题。

我的重复记录有不同的 ID、不同的`updated_at`时间、可能不同的`updated_by`ID，但所有其他列都相同。我想保留任何重复集的最新更新。

我结合使用 Rails 逻辑和 SQL 来完成它。

**第一步：**使用模型逻辑运行 rake 脚本来识别重复记录的 ID。ID 保存在文本文件中。

**第二步：**创建一个包含一列的临时表，从文本文件中加载要删除的 ID。

**第三步：**创建另一个临时表，其中包含我要删除的所有记录（以防万一！）。

```
CREATE TABLE temp_duplicate_models 
  AS (SELECT * FROM models 
  WHERE id IN (SELECT * FROM temp_duplicate_ids)); 
```

**第四步：**实际删除。

```
DELETE FROM models WHERE id IN (SELECT * FROM temp_duplicate_ids); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-19T07:14:54.067

您可以使用：

[http://lenniedevilliers.blogspot.com/2008/10/weekly-code-find-duplicates-in-sql.html](http://lenniedevilliers.blogspot.com/2008/10/weekly-code-find-duplicates-in-sql.html)

获取重复项，然后通过 Ruby 代码或 SQL 代码删除它们（我会在 SQL 代码中执行，但这取决于你 :-)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-07-30T22:20:02.777

如果您的表有 PK（或者您可以轻松地给它一个），您可以使用以下查询指定表中任意数量的列相等（限定为重复）（可能看起来有点乱，但它作品）：

```
DELETE FROM table WHERE pk_id IN(
   SELECT DISTINCT t3.pk_id FROM (
       SELECT t1.* FROM table AS t1 INNER JOIN (
           SELECT col1, col2, col3, col4, COUNT(*) FROM table
           GROUP BY col1, col2, col3, col4 HAVING COUNT(*)>1) AS t2
       ON t1.col1 = t2.col1 AND t1.col2 = t2.col2 AND t1.col3 = t2.col3 AND
       t1.col4 = t2.col4)
   AS t3, (
       SELECT t1.* FROM table AS t1 INNER JOIN (
           SELECT col1, col2, col3, col4, COUNT(*) FROM table
           GROUP BY col1, col2, col3, col4 HAVING COUNT(*)>1) AS t2
       ON t1.col1 = t2.col1 AND t1.col2 = t2.col2 AND t1.col3 = t2.col3 AND
       t1.col4 = t2.col4)
   AS t4
   WHERE t3.col1 = t4.col1 AND t3.pk_id > t4.pk_id 
```

)

这将保留输入数据库的第一条记录，删除“最新”重复项。如果要保留最后一条记录，请将 > 切换为 <。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-08-24T00:01:00.000

在MySql中，当我放类似的东西时

```
delete from A where IDA in (select IDA from A ) 
```

mySql 说了类似“你不能在删除操作的选择部分使用同一张表”。

我只需要删除一些重复的记录，并且我已经成功使用了这样的 .php 程序

```
<?php
...
$res = hacer_sql("SELECT MIN(IDESTUDIANTE) as IDTODELETE 
FROM `estudiante` group by `LASTNAME`,`FIRSTNAME`,`CI`,`PHONE`
HAVING COUNT(*) > 1 )");
while ( $reg = mysql_fetch_assoc($res) ) {
   hacer_sql("delete from estudiante where IDESTUDIANTE = {$reg['IDTODELETE']}");
}
?> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-10-13T12:24:52.380

我在用`Alter Table`

```
ALTER IGNORE TABLE jos_city ADD UNIQUE INDEX(`city`); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-12-11T05:50:55.503

我在上面使用@krukid 的答案在大约 70,000 个条目的表上执行以下操作：

```
rs = 'select a, b, count(*) as c from table group by 1, 2 having c > 1'

# get a hashmap
dups = MyModel.connection.select_all(rs)

# convert to array
dupsarr = dups.map { |i|  [i.a, i.b, i.c] }

# delete dups
dupsarr.each do |a,b,c|
    ActiveRecord::Base.connection.execute("delete from table_name where a=#{MyModel.sanitize(a)} and b=#{MyModel.sanitize(b)} limit #{c-1}")
end 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-04-17T19:45:49.447

这是我想出的rails解决方案。可能不是最有效的，但如果它是一次性迁移，则没什么大不了的。

```
distinct_records = MyTable.all.group(:distinct_column_1, :distinct_column_2).map {|mt| mt.id}
duplicates = MyTable.all.to_a.reject!{|mt| distinct_records.include? mt.id}
duplicates.each(&:destroy) 
```

首先，按确定唯一性的所有列进行分组，示例显示 2 但您可能或多或少

其次，选择该组的倒数...所有其他记录

第三，删除所有这些记录。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-09-21T13:05:33.217

首先对要删除重复项的列进行分组。但我不是用分组来做的。我正在写自我加入。

您不需要创建临时表。

删除除一条记录外的重复项：在此表中，它应该具有自动增量列。我刚刚遇到的可能的解决方案：

```
DELETE n1 FROM names n1, names n2 WHERE n1.id > n2.id AND n1.name = n2.name 
```

如果您想保留具有最低自动增量 id 值的行或

```
DELETE n1 FROM names n1, names n2 WHERE n1.id < n2.id AND n1.name = n2.name 
```

如果要保留具有最高自动增量 id 值的行。

您可以交叉检查您的解决方案，再次找到重复项：

```
SELECT * FROM `names` GROUP BY name, id having count(name) > 1; 
```

如果返回 0 结果，则查询成功。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-01-31T07:58:45.790

```
Delete t1 from table1 inner join table1 t2 where t1.id < t2.id and t1.name = t2.name 
```

有关更多详细信息，请查看以下 YouTube 链接：

[https://youtu.be/cNGktcS_qGU](https://youtu.be/cNGktcS_qGU)

# java - 在整数值上同步

> ID：659915
> 
> 赞同：37
> 
> 时间：2009-03-18T20:15:47.520
> 
> 标签：java, synchronization

> **可能重复：**
> [在java中增加锁数量的最佳方法是什么](https://stackoverflow.com/questions/12890586/what-is-the-best-way-to-increase-number-of-locks-in-java)

假设我想基于一个整数 id 值进行锁定。在这种情况下，有一个函数可以从缓存中提取一个值，如果该值不存在，则执行相当昂贵的检索/存储到缓存中。

现有代码未同步，可能会触发多个检索/存储操作：

```
//psuedocode
public Page getPage (Integer id){
   Page p = cache.get(id);
   if (p==null)
   {
      p=getFromDataBase(id);
      cache.store(p);
   }
} 
```

我想做的是同步id上的检索，例如

```
 if (p==null)
   {
       synchronized (id)
       {
        ..retrieve, store
       }
   } 
```

不幸的是，这不起作用，因为 2 个单独的调用可以具有相同的 Integer id 值但不同的 Integer 对象，因此它们不会共享锁，并且不会发生同步。

有没有一种简单的方法可以确保您拥有相同的 Integer 实例？例如，这是否有效：

```
 syncrhonized (Integer.valueOf(id.intValue())){ 
```

Integer.valueOf() 的 javadoc 似乎暗示您可能会获得相同的实例，但这看起来不像是保证：

> 返回一个表示指定 int 值的 Integer 实例。如果不需要新的 Integer 实例，则通常应优先使用此方法而不是构造函数 Integer(int)，因为此方法可能会通过缓存频繁请求的值来显着提高空间和时间性能。

那么，除了更复杂的解决方案（例如保持锁定对象的 WeakHashMap 键控到 int 之外）如何获得保证相同的 Integer 实例的任何建议？（这并没有错，似乎必须有一个明显的单线比我错过的）。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-18T20:22:33.637

您真的不想在 上同步`Integer`，因为您无法控制哪些实例相同以及哪些实例不同。Java 只是不提供这种跨不同 JVM 可靠的工具（除非您在小范围内使用整数）。如果你真的必须在一个整数上同步，那么你需要保留一个 Map 或 Set of Integer，这样你就可以保证你得到你想要的确切实例。

更好的办法是创建一个新对象，可能存储在`HashMap`由 键控的 a 中`Integer`，以进行同步。像这样的东西：

```
public Page getPage(Integer id) {
  Page p = cache.get(id);
  if (p == null) {
    synchronized (getCacheSyncObject(id)) {
      p = getFromDataBase(id);
      cache.store(p);
    }
  }
}

private ConcurrentMap<Integer, Integer> locks = new ConcurrentHashMap<Integer, Integer>();

private Object getCacheSyncObject(final Integer id) {
  locks.putIfAbsent(id, id);
  return locks.get(id);
} 
```

为了解释这段代码，它使用`ConcurrentMap`，它允许使用`putIfAbsent`. 你可以这样做：

```
 locks.putIfAbsent(id, new Object()); 
```

但是随后您会产生（小）为每次访问创建对象的成本。为了避免这种情况，我只是将 Integer 本身保存在`Map`. 这能达到什么目的？为什么这与仅使用 Integer 本身有什么不同？

当您执行 a `get()`from a`Map`时，会将键与`equals()`（或至少使用的方法等效于 using `equals()`）进行比较。相同值的两个不同 Integer 实例将彼此相等。因此，您可以将任意数量的不同 Integer 实例`new Integer(5)`作为参数传递给`getCacheSyncObject`，并且您将始终只返回包含该值的传入的第一个实例。

您可能不想同步的原因是`Integer`……如果多个线程在`Integer`对象上同步，您可能会陷入死锁，因此当它们想要使用不同的锁时会无意中使用相同的锁。您可以通过使用

```
 locks.putIfAbsent(id, new Object()); 
```

版本，因此每次访问缓存都会产生（非常）小的成本。这样做，您可以保证此类将在没有其他类将同步的对象上进行同步。总是一件好事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-18T20:20:45.513

`Integer.valueOf()`仅返回有限范围内的缓存实例。你没有指定你的范围，但一般来说，这是行不通的。

但是，我强烈建议您不要采用这种方法，即使您的值在正确的范围内。由于这些缓存`Integer`实例可用于任何代码，因此您无法完全控制同步，这可能会导致死锁。这与人们试图锁定`String.intern()`.

最好的锁是私有变量。由于只有您的代码可以引用它，因此您可以保证不会发生死锁。

顺便说一句，使用 a`WeakHashMap`也行不通。如果作为键的实例未被引用，它将被垃圾回收。如果它被强引用，你可以直接使用它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-18T20:40:18.553

使用线程安全的映射，例如`ConcurrentHashMap`. 这将允许您安全地操作地图，但使用不同的锁来进行真正的计算。通过这种方式，您可以使用单个地图同时运行多个计算。

使用`ConcurrentMap.putIfAbsent`，但不是放置实际值，而是使用`Future`具有计算量轻结构的 a 。可能是`FutureTask`执行。运行计算，然后运行`get`结果，这将线程安全地阻塞直到完成。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-18T20:39:25.513

在 Integer 上使用同步听起来设计上确实是错误的。

如果您需要仅在检索/存储期间单独同步每个项目，您可以创建一个 Set 并将当前锁定的项目存储在那里。换句话说，

```
// this contains only those IDs that are currently locked, that is, this
// will contain only very few IDs most of the time
Set<Integer> activeIds = ...

Object retrieve(Integer id) {
    // acquire "lock" on item #id
    synchronized(activeIds) {
        while(activeIds.contains(id)) {
            try { 
                activeIds.wait();   
            } catch(InterruptedExcption e){...}
        }
        activeIds.add(id);
    }
    try {

        // do the retrieve here...

        return value;

    } finally {
        // release lock on item #id
        synchronized(activeIds) { 
            activeIds.remove(id); 
            activeIds.notifyAll(); 
        }   
    }   
} 
```

商店也是如此。

底线是：没有一行代码可以完全按照您的需要解决这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T20:26:21.770

以 Integer 对象为键的 ConcurrentHashMap 怎么样？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-18T20:30:55.363

您可以查看[此代码](http://illegalargumentexception.blogspot.com/2008/04/java-synchronizing-on-transient-id.html)以从 ID 创建互斥锁。该代码是为字符串 ID 编写的，但可以很容易地为整数对象进行编辑。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-18T20:55:41.577

[请参阅Java 并发实践](http://jcip.net/)中的第 5.6 节：“构建高效、可扩展的结果缓存”。它处理您要解决的确切问题。特别是，检查记忆模式。

[![替代文字](https://i.stack.imgur.com/QxJbq.jpg)](https://i.stack.imgur.com/QxJbq.jpg)
[（来源：[umd.edu](http://www.cs.umd.edu/class/fall2008/cmsc433/jcipMed.jpg)）]

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-19T00:24:24.210

从各种答案中可以看出，给这只猫剥皮的方法有很多种：

*   Goetz 等人保留 FutureTasks 缓存的方法在这种情况下非常有效，因为您“无论如何都在缓存某些东西”，所以不要介意构建 FutureTask 对象的映射（如果您确实介意映射增长，至少修剪它很容易并发）
*   作为对“如何锁定 ID”的一般回答，Antonio 概述的方法的优点是，在添加/删除锁映射时很明显。

您可能需要注意 Antonio*实现*的一个潜在问题，即 notifyAll() 将在*所有*ID 可用时*唤醒*等待所有 ID 的线程，这在高争用下可能无法很好地扩展。原则上，我认为您可以通过为每个当前锁定的 ID 设置一个 Condition 对象来解决这个问题，这就是您等待/发出信号的东西。当然，如果实际上在任何给定时间等待的 ID 很少超过一个，那么这不是问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-19T03:48:18.213

史蒂夫，

您提出的代码在同步方面存在很多问题。（安东尼奥也是如此）。

总结一下：

1.  您需要缓存一个昂贵的对象。
2.  您需要确保当一个线程进行检索时，另一个线程也不会尝试检索相同的对象。
3.  对于所有试图获取对象的 n 线程，只有 1 个对象被检索并返回。
4.  对于请求它们不相互竞争的不同对象的线程。

实现这一点的伪代码（使用 ConcurrentHashMap 作为缓存）：

```
ConcurrentMap<Integer, java.util.concurrent.Future<Page>> cache = new ConcurrentHashMap<Integer, java.util.concurrent.Future<Page>>;

public Page getPage(Integer id) {
    Future<Page> myFuture = new Future<Page>();
    cache.putIfAbsent(id, myFuture);
    Future<Page> actualFuture = cache.get(id);
    if ( actualFuture == myFuture ) {
        // I am the first w00t!
        Page page = getFromDataBase(id);
        myFuture.set(page);
    }
    return actualFuture.get();
} 
```

笔记：

1.  java.util.concurrent.Future 是一个接口
2.  java.util.concurrent.Future 实际上并没有 set() 而是查看实现 Future 的现有类以了解如何实现自己的 Future（或使用 FutureTask）
3.  将实际检索推送到工作线程几乎肯定是一个好主意。

# c# - 动态 LINQ

> ID：659932
> 
> 赞同：2
> 
> 时间：2009-03-18T20:20:17.010
> 
> 标签：c#, xml, linq, dynamic

我有一个这样定义的 XML 文档

**XML 文件**

```
<TABLE>
    <RECORD>
        <PAGENUMBER> 1 Of 1</PAGENUMBER>
        <OtherFields1>..</OtherFields1>
        <OtherFields2>..</OtherFields2>
    </RECORD>
    <RECORD>
        <PAGENUMBER> 1 Of 2</PAGENUMBER>
        <OtherFields1>..</OtherFields1>
        <OtherFields2>..</OtherFields2>
    </RECORD>
    <RECORD>
        <PAGENUMBER> 2 Of 2</PAGENUMBER>
        <OtherFields1>..</OtherFields1>
        <OtherFields2>..</OtherFields2>
    </RECORD>
    <RECORD>
        <PAGENUMBER> 1 Of 1</PAGENUMBER>
        <OtherFields1>..</OtherFields1>
        <OtherFields2>..</OtherFields2>
    </RECORD>
</TABLE> 
```

我正在尝试创建一个动态查询，我可以在其中将“字段名”、“操作数”、“值”放入配置中，LINQ 可以基于它构建谓词。

**配置文件**

```
<CLAUSES>
    <CLAUSE name="PAGENUMBER" operand="!=">Page 1 Of 1</CLAUSE>
    <CLAUSE name="OtherFields1" operand="!=">String.Empty</CLAUSE>
</CLAUSES> 
```

这是我现在使用的 LINQ

**LINQ 查询**

```
 XDocument jobXML = XDocument.Load(JobFile);

        List<ClauseObj> clauses = new List<ClauseObj>();
        clauses.Add(new ClauseObj { Field = "PAGENUMBER", Operand = "!=", Value = " Page 1 Of 1" });

        var q = jobXML.Descendants("RECORD").AsEnumerable();

        foreach (var c in clauses)
        {
            switch (c.Operand)
            {
                case "!=":
                    q = q.Where(r => r.Element(c.Field).Value != c.Value);
                    break;
            }
        } 
```

我怎样才能让它“动态地”读取 where 子句并指定要返回的字段名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T20:26:36.637

查看[动态 Linq 查询示例](http://msdn.microsoft.com/en-us/library/bb397982.aspx)。他们在那里有一个类，为 Where 和 Order By 添加了各种扩展方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T20:34:55.713

```
string clause = "PAGENUMBER";
string operand = "!=";
string value= " Page 1 Of 1";

  var q = from r in jobXML.Descendants("RECORD")
                 select new
                 {
                     PAGENUMBER = (string)r.Element("PAGENUMBER"),
                     OtherFields1 = (string)r.Element("OtherFields1")
                 }

   switch(operand)
   {
       case "!=":
          q = q.Where(r=> r.Element(clause).Value != value);
          break;
       case "etc":
   }

   var list = q.ToList(); 
```

# c# - Lambda 问题

> ID：659942
> 
> 赞同：0
> 
> 时间：2009-03-18T20:23:45.520
> 
> 标签：c#, .net, lambda

我正在尝试在 C# 3 中学习 lambda，并想知道如何使用 lambdas 编写此函数：

假设您有一组 Point3 值。

对于这些点中的每一个，p：

创建一个新的 p，其中 .Y 是：

```
Math.Sin ((center - p).Length * f) 
```

center 和 f 是要提供给函数的外部变量。Point3 类型也将有一个接受 x、y、z 值的构造函数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-18T20:26:52.830

输入集合是`source`，输出集合是`result`：

```
IEnumerable<Point3> source = ...

IEnumerable<Point3> result = source.Select(p => new Point3(p.x, Math.Sin ((center - p).Length * f), p.z); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T20:28:04.077

```
List<Point> oldList = .....;
List<Point> newList = List<Point> ();
double center = ...;
double f = ....;

oldList.ForEach(p=> 
   newList.Add(new Point(p.X, Math.Sin ((center - p).Length * f), p.Z));); 
```

# c# - Linq To Sql 和 ASP.NET 的并发性

> ID：659945
> 
> 赞同：7
> 
> 时间：2009-03-18T20:24:04.647
> 
> 标签：c#, .net, sql-server, linq, linq-to-sql

在 ASP.net 应用程序中使用 LINQ to SQL 时检查并发问题的最佳方法是什么。

在我的应用程序中，我从数据库中检索记录并在可编辑的文本框中显示字段。然后数据上下文被丢弃。

我应该如何保存实体对象以便我可以使用 L2Sql 的内置并发功能？我无法在会话中保存对象并将其重新附加到新的数据上下文：l2s 抱怨该对象不是新的。

LinqDataSource 设法以某种方式做到这一点。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T20:40:51.067

Linq2Sql 中乐观并发的工作方式是存储原始值并在插入时比较它们。

如果您丢弃数据上下文，则会丢失原始值。

我通常做的是在我要保存时再次从数据库中加载对象，然后使用表单中的值修改该对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T20:28:58.050

Linq To SQL 默认支持[乐观并发控制](http://msdn.microsoft.com/en-us/library/bb399373.aspx)。

您可以更改表中每个字段的[UpdateCheck属性：](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.updatecheck.aspx)

![](https://dl.getdropbox.com/u/35146/stackoverflow/linq-concurrency.jpg)

> 在 LINQ to SQL 对象模型中，当以下两个条件都为真时，就会发生乐观并发冲突：
> 
> *   客户端尝试将更改提交到数据库。
> *   自客户端上次读取它们以来，已在数据库中更新了一个或多个更新检查值。

# database - 用于后代关系的最佳数据结构是什么？

> ID：659946
> 
> 赞同：0
> 
> 时间：2009-03-18T20:24:25.363
> 
> 标签：database, data-structures, tree, parent-child

必须有一个标准的数据结构来保存例如狗的繁殖信息、植物遗传杂交和复杂的人际关系。

有人可能认为这将是一个简单的树形结构，但是每个后代的两个（或更多，对于基因工程）父母的组合，每个父母集多个不同的后代，父母的多次移动（种马与许多其他马交配），收养等使这成为一个非常分散的结构。

我希望有人以前解决过这个问题。我应该研究什么资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T20:27:15.637

我认为你所拥有的只是一个简单的关系数据库，其中主要关系是“child_of”、“direct_descendant”等。

当然，这里的特定数据结构是非循环的，您可能想要执行标准 SQL 引擎通常不支持的传递查询（...的后代的后代）。

因此，如果您想在内存中执行此操作，可以使用有向无环图 (DAG)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T20:30:32.040

闻起来像[DAG](http://en.wikipedia.org/wiki/Directed_acyclic_graph)。如果有向和无环的限制太大，您可能需要查看[图论数据结构](http://en.wikipedia.org/wiki/Graph_theory#Graph-theoretic_data_structures)。

使用图来解决抽象问题，顶点代表实体，边代表关系。

# winforms - 数据绑定 WinForms 表单 - 如何格式化日期？

> ID：659949
> 
> 赞同：2
> 
> 时间：2009-03-18T20:25:09.730
> 
> 标签：winforms, data-binding, datetime, compact-framework, formatting

我在 TextBox 控件中有一个带有日期值的表单。该表单使用 BindingSource 对 DataSet 和 SQL 2005 CE 数据库进行数据绑定。我在哪里控制日期的格式？例如，在沿途的属性中，我没有看到去除时间部分的可能性。

我当然可以在数据库中执行此操作并传递一个字符串而不是 DateTime，但这是解决方法而不是解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-18T20:35:05.603

您可以处理事件**Binding.Format**事件来格式化日期。与其对应的**Binding.Parse**来解析来自 TextBox 的输入。

例如

```
TextBox.DataBindings["Text"].Format += new ConvertEventHandler(FormatDateEventHandler);
...
private void FormatDateEventHandler (object sender, ConvertEventArgs e)
{
    if (! Convert.IsDBNull (e.Value))
    {
        e.Value = ((DateTime)e.Value).ToString ("d", CultureInfo.CurrentCulture);
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-06T11:07:45.813

使用设计器，选择您的文本框，单击属性选项卡，选择 (DataBindings) - 高级。

在这里，您可以选择日期时间数据类型，并可选择仅删除日期或时间等。

# php - 是否应该在 Form 对象或模型中进行验证？

> ID：659950
> 
> 赞同：4
> 
> 时间：2009-03-18T20:25:15.953
> 
> 标签：php, zend-framework, validation, zend-validate

这个问题主要针对PHP中的Zend，当然也适用于其他语言和框架，所以欢迎大家提出意见。

我最近才使用 Zend 框架，虽然它并不完美，但我玩得很开心。然而，让我发疯的一件事是，我看到的大多数使用 Zend 的人的例子[都是在特殊形式的对象](http://framework.zend.com/manual/en/zend.form.advanced.html)中进行验证，而不是在模型中。我认为这是不好的做法，因为数据可以通过表单输入以外的其他方式进入系统，这意味着验证器必须弯曲和扭曲才能验证其他输入，或者验证必须在第二个地方完成，并且逻辑重复。

我发现了一些与我有同样感受的人的其他帖子和博客，但是 Zend 的开发人员做出了这个选择是有原因的，其他人似乎毫无问题地使用它，所以我想得到一些反馈从这里的社区。

正如我所说，这主要适用于 Zend，尽管我认为从整体上看待问题很重要，而不是在 Zend 框架的范围内工作，因为 Zend 的设计目的是让您可以尽可能多地使用或尽可能少地使用，如你所愿。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T20:46:08.807

好吧，验证可以在许多不同的级别上完成，通常它们都不是“最好的”。当然，模型可以填充不是来自表单的无效数据，但我们也可以创建其数据不进入任何模型的表单。

此外，模型中的直接验证通常没有与我们的表单呈现系统集成，如果我们想要显示错误消息并使用用户输入的数据重新填充表单，就会出现问题。

这两种解决方案都有各自的优缺点。如果有一个系统可以确保我们最终必须在某个级别完成验证，那将是完美的。如果表单不验证某些数据，那么模型会验证，反之亦然。不幸的是，我还没有听说过这样的库，但我必须指出，框架中的验证器异常地是与源无关的。您可以将 POST 数据传递给它们，但同样可以对从正确解析的 CSV、MYSQL 数据库等中检索到的信息进行处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T21:00:47.490

重要的是要记住，与应用程序相关的数据验证并不总是与与数据库模式相关的数据验证相同。

考虑一个简单的注册表单，其中用户使用用户名和密码创建一个帐户。您对密码执行验证是因为您希望它的长度为 X 个字符并且包含字符类型（或其他）的良好组合。

但这与验证数据库插入的数据无关，因为您不会存储纯文本密码 - 您将以某种方式存储它们的哈希值（md5、md5 + salt 等）。相反，您可以确保您有一个 32 个字符的十六进制字符串，以便它很可能是正确创建的 MD5 哈希。

此密码示例不是唯一的场景，只是本主题中的一个很好的解释。

那么答案是什么？我不认为有任何一种万能的解决方案。有时您会想要（需要？）两次验证数据。有时你会在模型中只做一次。尽可能将其与您的应用程序的需求相匹配。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-18T21:21:02.920

这是一个非 zend 特定的答案，但是我相信模型应该对其自身数据的有效性负责。如果是这种情况，则验证属于模型，但这可能并不总是可以实现，并且可能需要在视图中执行验证，但是我认为这应该是模型中执行的验证的补充，而不是替代为了它。

仅在视图中进行验证的问题在于，在某些时候您可能需要另一个视图来查看您的数据。您的站点可能会变得流行，并且客户要求使用基于 XML 的 API 来生成他们自己的视图。然后，您是否依赖客户来验证数据？

即使您不必提供 API，一些客户可能希望自定义视图足够不同以保证页面的完全不同版本，您现在再次在重复的视图中进行验证。

我认为理想的情况是让您的模型进行验证，但使验证结果可用于视图读取并再次呈现页面并显示验证结果。

如果您想立即将验证数据显示给用户等，我认为让视图进行验证是完全合理的，但数据有效性的最终决定应取决于模型。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T10:59:44.073

也许您应该看看[Matthew Weier O'Phinney](http://weierophinney.net/matthew/)（Zend 框架的主要开发人员之一）在您的模型中使用 Zend_Form 以了解他对这个问题的看法[。](http://weierophinney.net/matthew/archives/200-Using-Zend_Form-in-Your-Models.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T20:34:07.150

我不知道 Zend。但。

您的模型必须接收有效数据。模型及其方法不应该一次又一次地检查数据。当然应该有一些函数可以进行实际验证，它们应该从 gui 验证或其他数据输入位置调用。

您可以在模型方面做的最好的事情是对所有数据调用“断言”，以确保在开发时间验证已被取代。

代码（UI、模型、实用程序）的较低级别应该存在较少的验证和检查代码。那样的话，同样的验证很有可能会被调用不止一个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T00:35:51.140

将美学验证放在表单中，将业务规则验证放在模型中怎么样。

以注册表为例。

该表单将确保电子邮件字段被修剪并包含有效的电子邮件，密码/确认密码字段相同，并且用户选中了我同意条款复选框。

注册模型将确保电子邮件尚未在表格中被占用，并对密码进行加盐和哈希处理。

这就是我通常将两者分开的方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T14:09:19.813

用户输入应在输入时进行验证，因为它特定于输入形式（即，进行一些表单验证 - 确保应该有数字的文本框是数字）。

业务逻辑可能应该在模型上进行验证，因为它是特定于模型的（即确保他们尚未预订同一个房间或类似的东西）。

在模型级别验证它的问题是模型可能以不同的方式使用。一种情况的正确输入可能不是另一种情况的正确输入。

另一个问题是您通常需要一些上下文相关的验证，例如在输入错误的表单控件周围显示一个红色框。

模型或数据库可能会做一些额外的验证，以确保用户代码没有做完全错误的事情（约束等）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-15T10:41:32.073

Peter Bailey 的密码示例非常出色。用户模型只能验证，如果设置了密码（因为它不是作为纯文本存储，而是作为哈希存储），而输入验证可以确保原始纯文本密码符合安全要求（字符数，... ）。因此，您需要：模型验证和表单/输入验证，最好是作为单独的、可重用的组件，而不是直接在臃肿的控制器操作中。

将输入验证视为白名单验证（“接受已知良好”），将模型验证视为黑名单验证（“拒绝已知不良”）。白名单验证更安全，而黑名单验证可防止您的模型层过度受限于非常特定的用例。

无效的模型数据应始终导致抛出异常（否则应用程序可以继续运行而不会注意到错误），而来自外部来源的无效输入值并非意料之外，而是很常见（除非您的用户从不犯错误）。

另见：[https ://lastzero.net/2015/11/form-validation-vs-model-validation/](https://lastzero.net/2015/11/form-validation-vs-model-validation/)

# asp.net - 我应该从 Web 服务中获得什么类型的性能？

> ID：659962
> 
> 赞同：0
> 
> 时间：2009-03-18T20:27:40.347
> 
> 标签：asp.net, wcf, web-services, soap

我应该从 Web 服务中获得什么类型的性能？我有一个应用程序在一个简单的 GetServerTime() 方法上平均每秒调用 2 到 7 次。此方法仅从服务器返回一个日期。我正在使用 WCF 并通过 SSL 进行调用。我知道这个问题确实是相对的，但我只是在寻找一些大概的数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T21:55:40.760

答案非常“取决于”。

这里有一些基于给定 CPU / 内存等场景的真实测试结果：

[http://msdn.microsoft.com/en-us/library/ms978411.aspx](http://msdn.microsoft.com/en-us/library/ms978411.aspx)

它显示二进制 TCP 服务在每秒请求方面的性能更高，但 HTTP Web 服务在响应时间与用户负载方面做得很好……我会让你阅读和消化全部细节。

# networking - 专门用于 P2P 网络的并行 IP 地址空间？

> ID：659967
> 
> 赞同：0
> 
> 时间：2009-03-18T20:28:54.637
> 
> 标签：networking, ip-address, protocols, network-protocols, p2p

我想这样做是因为它会使对等位置在我的 p2p 网络中更加有效，因为我知道所有地址都将成为该网络的一部分。

在保持与当前传输层协议（如 SCTP）和当前在大互联网上使用的硬件兼容的同时，我如何才能做到这一点？

谢谢， 安德烈亚斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T20:49:40.903

我建议使用 IPv6。

*   有足够的地址空间，您可以创建多达 2^40 个“唯一单播”范围，每个范围都有 16 位子网和 64 位主机 ID。

*   UDP、TCP 和 SCTP 等协议已经在它之上运行

*   它已经拥有主要的操作系统支持。

见[http://www.rfc-editor.org/rfc/rfc4193.txt](http://www.rfc-editor.org/rfc/rfc4193.txt)

不鼓励密集填充 40 位唯一 ID。使用 RFC 中提到的随机生成方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T20:45:52.660

简单地说，你不能。IPv4 IP 由 IANA 分配给五个主要的 IP 注册机构：ARIN（北美）、RIPE（欧洲）、APNIC（亚太地区）、LACNIC（拉丁美洲/加勒比）和 AfriNIC（非洲）。然后，这些注册中心将这些信息分发给 ISP。

为本地网络保留了一些块，但这些块不能在公共 Internet 上路由……它们必须被封装；这就是 VPN 的工作方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T04:51:50.253

拥有这种功能的最佳方式可能是使用名称查找服务，甚至是协议本身中的对等发现服务。

事实是，无论您做什么，很可能无论如何您都必须让您的应用程序在 IP 协议之上执行额外的工作，因为 IP 协议本身仅支持 1 个地址空间，您需要添加另一层添加一个独立的地址空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T20:39:56.887

看起来您正试图在 P2P“世界”内创建一个网络。因此，所有使用 P2P 应用程序的用户都会有第二个 IP 地址，比如 Alice 有 10.0.2.40，该应用程序的另一个用户 Bob 可以使用它来访问 Alice。对？

考虑到这一点，您似乎希望在每个客户端上设置一个 VPN 并使用某种路由表修改，因此 VPN 仅用于 P2P 程序分配的地址空间（比如 10.xxx网络）。

但是这样做存在问题..例如，您永远找不到每个人都可以免费使用的地址空间。家庭路由器使用 192.168.xx，公司网络或爱好者（如我）使用 10.xxx，而 172.something 被其他系统管理员用于我确定的东西。

免责声明：不是网络天才，我在这里推测。

# database - 为什么不建议将数据库和 Web 服务器放在同一台机器上？

> ID：659970
> 
> 赞同：145
> 
> 时间：2009-03-18T20:29:58.563
> 
> 标签：database, security, networking, infrastructure, hardware-infrastructure

听了 Scott Hanselman 对 Stack Overflow 团队的采访（[第 1 部分](http://www.hanselminutes.com/default.aspx?showID=152)和[第 2](http://www.hanselminutes.com/default.aspx?showID=153)部分），他坚持认为 SQL 服务器和应用程序服务器应该在不同的机器上。这是否只是为了确保如果一台服务器受到威胁，则两个系统都无法访问？安全问题是否超过了两台服务器的复杂性（额外成本、两者之间的专用网络连接、更多维护等），尤其是对于一个小型应用程序，其中任何一块都没有使用过多的 CPU 或内存？即使有两台服务器，其中一台服务器受损，攻击者仍然可以通过删除数据库或弄乱应用程序代码来造成严重破坏。

如果性能不是问题，为什么会有这么大的问题？

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2009-03-18T20:48:20.423

1.  安全。您的 Web 服务器位于 DMZ 中，可通过公共互联网访问并从匿名用户那里获取不受信任的输入。如果您的 Web 服务器受到威胁，并且您在连接到数据库时遵循了最低权限规则，那么您的应用程序可以通过数据库 API 执行的操作就是最大的暴露。如果您在两者之间有一个业务层，那么您在攻击者和您的数据之间就多了一步。另一方面，如果您的数据库位于同一台服务器上，则攻击者现在拥有对您的数据和服务器的 root 访问权限。
2.  可扩展性。保持您的 Web 服务器无状态可以让您轻松地水平扩展您的 Web 服务器。水平扩展数据库服务器*非常*困难。
3.  表现。2 个盒子 = 2 倍 CPU、2 倍 RAM 和 2 倍磁盘访问主轴。

话虽如此，我当然可以看到合理的案例，这些观点都不重要。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-03-18T21:44:44.843

这并不重要（您可以*非常*愉快地在同一台机器上使用网络/数据库运行您的网站），这只是扩展中最简单的一步。

这正是 StackOverflow 所做的 - 从运行 IIS/SQL Server 的单台机器开始，然后当它开始变得负载很重时，购买了第二台服务器并将 SQL 服务器移到上面。

如果性能不是问题，不要浪费钱购买/维护两台服务器。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-03-18T20:39:38.463

另一方面，参考另一个博客 Scott（Watermasyck，来自 Telligent）——他们发现大多数用户可以通过将数据库与网站放在同一台机器上来加速网站（使用 Telligent 的社区服务器）。但是，在他们的客户的情况下，通常 db 和 web 服务器是该机器上唯一的应用程序，并且网站不会对机器造成太大压力。然后，不必通过网络发送数据的效率更多地弥补了增加的压力。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-18T20:38:01.523

汤姆在这一点上是正确的。其他一些原因是它不具有成本效益并且存在额外的安全风险。

Web 服务器与数据库服务器有不同的硬件要求。具有大量内存和非常快的磁盘阵列的数据库服务器表现更好，而 Web 服务器只需要足够的内存来缓存文件和频繁的数据库请求（取决于您的设置）。关于成本效益，两台服务器不一定会更便宜，但是性能/成本比应该更高，因为您不必让不同的应用程序竞争资源。出于这个原因，您可能不得不花更多的钱购买一台服务器，该服务器既能满足两者的需求，又能提供与 2 台专用服务器相当的性能。

安全问题是，如果单台机器受到攻击，网络服务器和数据库都容易受到攻击。有了两台服务器，您就有了一些喘息的空间，因为第二台服务器仍然是安全的（至少在一段时间内）。

此外，还有一些可扩展性的好处，因为您可能只需要维护一些由一堆不同的 Web 应用程序使用的数据库服务器。这样，您可以减少应用升级或补丁以及进行性能调整的工作。我相信有一些服务器管理工​​具可以使这些任务更容易（在单机情况下）。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-03-18T20:33:11.350

我认为最大的因素是性能。Web 服务器/应用程序代码和 SQL Server 都会在内存中缓存经常请求的数据，并且通过在相同的内存空间中运行它们会降低缓存性能。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-03-18T20:45:02.490

安全是一个主要问题。理想情况下，您的数据库服务器应该位于防火墙后面，只打开执行数据访问所需的端口。您的 Web 应用程序应该使用 SQL 帐户连接到数据库服务器，该帐户具有足够的权限让应用程序运行，仅此而已。例如，您应该删除允许删除对象的权限，并且您肯定不应该使用诸如“sa”之类的帐户进行连接。

如果您的 Web 服务器因劫持而丢失（即完全升级为管理员权限），最坏的情况是您的应用程序的数据库可能会受到损害，但不是整个数据库服务器（如果数据库服务器和 Web 服务器是同一台机器）。如果你已经加密了你的数据库连接字符串并且黑客不够精明来解密它们，那么你失去的只是网络服务器。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-03-18T20:48:26.303

尚未提及的一个因素是负载平衡。如果您开始将 Web 服务器和数据库视为独立的机器，您可以优化网络往返次数，并且随着需求的增加添加第二个 Web 服务器或第二个数据库引擎变得更加容易。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2012-01-11T13:54:58.703

我同意 Daniel Earwicker 的观点——安全问题存在很大缺陷。

如果您有一个带有网络服务器的单框设置，并且上面只有该网络服务器的数据库，如果该网络服务器受到威胁，您将丢失网络服务器和该特定应用程序的数据库。

这与您在 2 台服务器设置中丢失网络服务器时所发生的情况完全相同。您丢失了 Web 服务器，只丢失了该特定应用程序的数据库。

在您有 2 个服务器设置的情况下，“维护数据库服务器的其余部分的完整性”的论点是无关紧要的，因为在第一种情况下，与所有其他应用程序（如果有的话）相关的所有其他数据库服务器也不会受到影响- 就像它们一样，被托管在其他地方。

同样，对于 Kev 提出的问题“驻留在数据库服务器上的所有其他数据库怎么样？你失去的只是一个数据库。

*   如果您在一台服务器上托管应用程序和数据库，您将只在该服务器上托管与该应用程序相关的数据库。因此，与多服务器设置相比，单服务器设置不会丢失任何额外的数据库。

相比之下，在 2 服务器设置中，攻击者可以访问 Web 服务器，并通过代理，对数据库服务器的有限权限（在最佳情况下），他们可以通过携带其他应用程序的数据库处于危险之中出慢速、内存密集型查询或最大化数据库服务器上的可用存储空间。通过将应用程序分离到它们自己的关注点中，就像虚拟化一样，您还可以出于安全目的以积极的方式隔离它们。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-03-18T20:43:38.220

我可以从第一手经验说，将 Web 服务器和数据库放在不同的机器上通常是一个好主意。如果您有一个资源密集型应用程序，它很容易导致机器上的 CPU 周期达到峰值，从而使机器停止运行。但是，如果您的应用程序对数据库的使用有限，那么让它们共享服务器可能没什么大不了的。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-03-18T21:22:15.210

哇，没有人提出这样一个事实：如果您以 5k 美元的价格购买 SQL Server，您可能希望将其用于 Web 应用程序之外的更多用途。如果您使用快递，也许您不在乎。我看到 SQL 服务器为 20 到 30 个应用程序运行数据库，因此将它放在网络服务器上并不明智。

其次，取决于服务器是为谁服务的。我为金融公司和政府工作。因此，我们在只使用存储过程并限制从网络服务器到 SQL 的端口的屁股方法中使用了一种疯狂的痛苦。因此，如果网络应用程序被黑客入侵。黑客唯一能做的就是调用 sprocs，因为网络服务器上的用户帐户被锁定，只能查看/调用 DB 上的 sprocs。所以现在黑客必须弄清楚如何进入数据库。如果它在网络服务器上运行良好，那么它很容易访问。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-03-18T20:37:37.780

这取决于应用程序和目的。当高可用性和性能不重要时，不将数据库和 Web 服务器分开也不错。特别是考虑到性能提升 - 如果应用程序进行大量数据库查询，可以通过将其全部保持在同一系统上来消除大量网络负载，从而保持较低的响应时间。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-03-18T22:04:18.040

我听了那个播客，很有趣，但安全论点对我来说毫无意义。如果您攻破了服务器 A，并且该服务器可以访问服务器 B 上的数据，那么您立即可以访问服务器 B 上的数据。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-03-18T20:34:21.533

我认为这是因为这两台机器通常需要以不同的方式进行优化。除此之外，我不知道，我们在同一台机器上使用服务器数据库运行我们所有的应用程序——当然我们不是面向公众的——但我们没有遇到任何问题。

我无法想象有太多人关心一台机器在两者上都受到损害，因为如果不是数据库内的模式，Web 应用程序通常至少可以不受限制地访问数据。

对别人可能说的话感兴趣。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-10-20T13:06:26.347

数据库许可证并不便宜，而且通常按 CPU 收费，因此通过分离 Web 服务器，您可以降低数据库许可证的成本。

例如，如果您有 1 台服务器同时处理包含 8 个 CPU 的 Web 和数据库，则您必须支付 8 个 CPU 许可证。但是，如果您有两台服务器，每台服务器都有 4 个 CPU，并在一台服务器上运行数据库，那么您只需支付 4 个 CPU 许可证

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-18T20:47:36.103

另一个问题是，数据库喜欢占用所有可用内存并保留它以备不时之需。您可以强制它限制内存，但这会大大降低数据访问速度。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-09-19T22:03:47.610

认为通过在 Web 服务器上运行数据库服务器可以获得真正的性能提升是一个有缺陷的论点。

由于数据库服务器采用查询字符串并返回结果集，实际从数据服务器流向 Web 服务器的数据相对较少，但处理查询和生成结果集所需的马力相对较大。因此，围绕数据传输时间优化性能是围绕错误的事情进行优化。

在安全性方面，将数据服务器与 Web 服务器放在不同的盒子上是有好处的。拥有这样的设置并不是安全的全部和全部，但它是朝着正确方向迈出的一步。

关于可扩展性，添加 Web 服务器并将它们放入集群以处理增加的流量很容易且相对便宜。添加数据服务器并将它们集群起来并不是那么容易和便宜。此外，Web 服务器和数据服务器具有不同的硬件需求，因此多个盒子有助于提高可扩展性。

如果您从小规模开始并且只有一个盒子，那么使用虚拟机是一个不错的方法。在一台主机上的不同 VM 中运行 Web 服务器和数据服务器，您可以以一个大盒子的价格获得单独盒子的所有收益。

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2009-03-18T21:58:26.323

操作系统是另一个考虑因素。虽然您的数据库可能需要更大的内存空间，因此需要 UNIX，但您的 Web 服务器 - 或者更具体地说是您的应用服务器，因为您只提到了两层 - 可能是基于 .Net 的，因此需要 Windows。

* * *

## 回答 #18

> 赞同：-7
> 
> 时间：2013-03-10T23:41:10.370

行！事情就是这样，将您的数据库服务器安装在另一台机器上并将您的应用程序安装在 Web 服务器上会更安全。然后，您可以使用 Web 链接将您的应用程序连接到数据库。谢谢它。

# mysql - 检索每个的唯一值和计数

> ID：659978
> 
> 赞同：19
> 
> 时间：2009-03-18T20:32:32.257
> 
> 标签：mysql, count, unique, duplicates

有没有一种简单的方法来检索列中所有唯一值的列表，以及该值出现的次数？

示例数据集：

```
A
A
A
B
B
C 
```

...将返回：

```
A  |  3
B  |  2
C  |  1 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-18T20:33:29.977

使用分组：

```
select value, count(*) from table group by value 
```

使用 HAVING 进一步减少结果，例如仅出现超过 3 次的值：

```
select value, count(*) from table group by value having count(*) > 3 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-18T20:34:06.353

```
SELECT id,COUNT(*) FROM file GROUP BY id 
```******~~**`