# StackOverflow 问答 12148000-12148999

# c - 从 recv 返回填充有二进制数据的缓冲区

> ID：12148007
> 
> 赞同：2
> 
> 时间：2012-08-27T19:05:51.370
> 
> 标签：c, sockets, binary, recv, tmp

假设我有一个函数可以轻松地用二进制数据填充缓冲区，我怎样才能使该函数返回所述缓冲区以供进一步使用？

我目前这样做的方式是让它写入缓冲区（基于recv的内容长度字段）写入一个临时文件，然后返回该临时文件的名称，这样我就可以将tmp文件读入内存。

但是，如果我可以直接返回数据而不是将其写入 tmp 文件并使用它，那就太好了。唯一的问题是，如果我返回二进制数据，我无法知道缓冲区的大小（它不是静态的）所以我的问题是：是否有一种方法可以返回这个二进制数据以及它的大小，或者我有什么办法可以使用它？

还是我最好的选择只是坚持使用 tmp 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:11:19.527

您可以使用与 socket recv 相同的 API。调用者提供缓冲区和最大长度，函数返回实际接收长度。

[http://linux.die.net/man/2/recv](http://linux.die.net/man/2/recv)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:20:31.673

在 C 中，您可以使用 a`struct`将一堆数据项封装在一起，然后将其传递给您的函数，例如：

```
/* Describes single I/O buffer */
struct buf {
    char* data; /* pointer to dynamically allocated memory */
    size_t mem_size; /* allocation size */
    size_t data_len; /* how much data is in the buffer */
    struct buf* next; /* can be used for buffer chaining */
};

/* Returns 0 on success, -1 on error */
int read_data( int sockfd, struct buf* pb ); 
```

或者使用值返回参数，例如：

```
/* buffer receives data, len tells buffer length on input, and
 * how much was read on success. */
int read_data( int sockfd, char* buffer, size_t* len ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T19:29:06.683

嗯 - 临时文件的优点确实是 - 更简单的内存管理。在许多成熟/现代的操作系统上 - 像 /tmp 这样的短期文件的开销非常小（而且你作为开发人员的时间很昂贵）。如果您对文件大小有某种想法 - 一种非常常见的方法如下所示。

但究竟你想要什么取决于内存管理。而且很容易重新发明轮子。

避免这种情况的一个好方法是使用类似[http://apr.apache.org/](http://apr.apache.org/) APR Commons - 即 apr_socket_recv() 和相关的内存管理 (http://apr.apache.org/docs/apr/1.4/ group_ *apr* _network__io.html#gaa6ee00191f197f64b5a5409f4aff53d1)。一般来说，这是一个长期的胜利。

德。

```
// On entry:
//     buffp - pointer to NULL or a malloced buffer.
//     lenp - pointer for the length; set to 0 or the length of the malloced buffer.
// On exit
//     return value < 0 for a fault, 0 for a connection close and > 0 for
//     the number of bytes read.
//     buffp will be filled out with the buffer filled; lenleftp with the bytes left
//     (i.e not yet used). 
//     If post call *buffp != NULL you need to release/clean memory.
//
ssize_t sockread(..., unsigned char * * buffp , ssize_t * lenleftp) {
      if (!buffp || !lenleftp)
           return -1; // invalid params

      // claim memory as needed.
      if (*buffp == 0) {
           *lenleftp = 16K;
           *buffp = malloc(*lenleftp);
      }

      if (!*buffp || !*lenleftp)
          return -2; // invalid params

      ssize_t used = 0;
      while(1) {
         ssize_t l = recv(..., *buffp, *lenleftp - used, ..);
         if (l < 0) {
            // ignore transient errors we can retry without much ado.
            if (errno == EAGAIN || errno == EINTR) 
                continue;

            free(*buffp); *buffp = *lenleftp = NULL;

            // report a fail.
            return -3;
         }
         // we simply assume that a TCP close means we're done.
         if (l == 0)
            break;

         used += l;

         // increase buffer space as/when needed.
         //
         if (used >= lenleftp) {
               *lenleftp += 32K;
               *buffp = realloc(lenleftp);
         };
   }

   // we're assuming that a read == 0-- i.e. tcp stream done means
   // we're done with reading.
   //
   *lenleftp -= used;
   return used;
} 
```

# django - django 使用 modelform 更新用户配置文件

> ID：12148008
> 
> 赞同：0
> 
> 时间：2012-08-27T19:05:52.763
> 
> 标签：django, django-forms

# 视图.py

```
def profile(request,nav="profile",template="profile.html",context = {},extra_context = None):
    if request.POST:
        if 'profileFormSubmit' in request.POST:
            pform = UserProfileForm(request.POST,instance = request.user)
            if pform.is_valid():
                user = pform.save()

                return redirect(profile,nav="account")
            else:
                context['data'] ={'nav_menu': ['account','profile','reviews','favourites'],
                'cur_nav':nav}
                context['pform'] = pform
                context['rform'] = PartialSignupForm()
                context['lform'] = LoginForm()
                context['aform']  = AccountsForm()
                return render_to_response(template,context,context_instance = RequestContext(request))
        else:
            return redirect(profile,nav="profile")

    else:
        context['rform'] = PartialSignupForm()
        context['lform'] = LoginForm()
        context['aform']  = AccountsForm()

        context['pform'] = UserProfileForm(instance = request.user)
        context['data'] ={'nav_menu': ['account','profile','reviews','favourites'],
               'cur_nav':nav}
        context['reviews'] = request.user.review_set.all()
        if extra_context is not None:
            context.update(extra_context)
        return render_to_response(template,context,context_instance = RequestContext(request)) 
```

# 表格.py

```
class UserProfileForm(forms.ModelForm):
    sex = forms.CharField(max_length = 20,label="I am :",widget=forms.Select(choices=SEX_CHOICES,attrs = {'class':''}),required = False)
    first_name = forms.CharField(max_length = 50,widget = forms.TextInput(attrs={'placeholder':'Please enter your real name.','class':''}),required = False)
    last_name = forms.CharField(max_length = 50,widget = forms.TextInput(attrs={'placeholder':'Enter last name.','class':''}),required = False)
    location = forms.CharField(max_length = 50,widget = forms.TextInput(attrs={'placeholder':'Enter your current location','class':''}),required = False)
    def clean_first_name(self):
        first_name = self.cleaned_data['first_name']
        if first_name == '':
            raise forms.ValidationError("This field is required.")
        return first_name
    def clean_phone(self):
        phone = self.cleaned_data['phone']
        if phone == '':
            raise forms.ValidationError("This field is required.")
        return phone

    def clean_last_name(self):
        last_name = self.cleaned_data['last_name']
        if last_name == '':
            raise forms.ValidationError("This field is required.")
        return last_name

    def clean_profession(self):
        profession = self.cleaned_data['profession']
        if profession == "":
            raise forms.ValidationError("Select a valid option.")
        return profession

    def clean_sex(self):
        sex = self.cleaned_data['sex']
        if sex == "":
            raise forms.ValidationError("Select a valid option.")
        return sex
    def clean_location(self):
        location = self.cleaned_data['location']
        if location == "":
            raise forms.ValidationError("This field is required.")
        return location

    def __init__(self,*args,**kw):
        super(UserProfileForm,self).__init__(*args,**kw)
        self.phone = self.instance.get_profile().phone
        self.profession = self.instance.get_profile().profession
        self.sex = self.instance.get_profile().sex
        self.location = self.instance.get_profile().location        

    def save(self,*args,**kw):
        self.instance.first_name = self.cleaned_data.get("first_name")
        self.instance.last_name = self.cleaned_data.get("last_name")
        profile = self.instance.get_profile()
        profile.sex = self.cleaned_data.get("sex")
        profile.location = self.cleaned_data.get("location")
        profile.profession = self.cleaned_data.get("profession")
        profile.phone = self.cleaned_data.get("phone")
        profile.save()
        self.instance.save()
        return self.instance

    class Meta:
        model = User
        #fields = ('username','email','password','confirm_password','first_name','last_name','sex','phone','profession')
        fields = ('first_name','last_name','phone','sex','profession','location') 
```

# 模型.py

```
class UserProfile(models.Model):
    user = models.OneToOneField(User)
    phone = models.CharField(max_length = 40,blank=False,default = "")
    location = models.CharField(max_length = 100,blank=False,default = "")
    sex = models.CharField(max_length =  10,blank = False,default = "")
    profession = models.CharField(max_length =  50,blank = False,default = "") 
```

# 怀疑

我无法理解，当我呈现要编辑的配置文件表单时，只有名字和姓氏在那里，但是当我填写详细信息并提交表单时，它对用户配置文件进行了更改，但重新加载配置文件表单不是使用 userprofile 表单的值启动的，只设置了 first_name 和 last_name 值，我知道该表单是用户模型表单，但是当我使用用户配置文件值启动它时，我没有得到预期的结果，请帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T22:38:27.723

在`UserProfileForm`,

```
class Meta:
   model = User 
```

需要更改为

```
class Meta:
   model = UserProfile 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-28T19:28:29.820

正如 Karthikr 所说，您的表单正在加载来自用户模型（名字/姓氏）的值，而不是来自用户配置文件的值。如果您希望出现正确的值，则需要根据正确的模型（在本例中为 UserProfile）启动表单。

# assembly - 了解 x86 MOV 语法

> ID：12148010
> 
> 赞同：5
> 
> 时间：2012-08-27T19:06:00.827
> 
> 标签：assembly, x86, ida, mov

我认为这是一个很容易（也许很容易）回答的问题，但经过近两个小时的谷歌搜索后，我已经三振了。我很确定我的问题是因为我只是不明白语法在做什么。

我正在查看 IDA 中的一些反汇编代码，但我不知道以下内容在做什么：

```
mov dl, byte_404580[eax] 
```

如果我跳到`byte_404580`我发现`.data:00404580 byte_404580 db 69h`告诉我该值为`0x69`. 但我不明白这是如何使用的。

让我提供此代码出现的上下文：

```
mov eax, 0x73             ; Move hex 73 to EAX
and eax, 0x0F             ; Keep lower half of EAX
mov dl, byte_404580[eax]  ; MAGIC 
```

上面假设`EAX`最初是 0x73，我得到`DL`=0x76。我尝试改变 的值`EAX`以找到一些模式，但我无法弄清楚发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T20:20:17.083

此语法用于表示内存寻址，类似于 C 的数组语法 ( `array[index]`)。您的示例等效于计算表达式`0x404580 + (eax & 0x0F)`，将其视为地址，并从该地址中获取一个字节。这表明位于的数据`0x404580`是一个字节数组（最有可能的`0x10`元素，基于掩码）。

如果这回答了您的问题，您可以在此处停止阅读。

* * *

如果您进入 Options > General 并将“Show Opcode Bytes”设置为非零值，您将看到指令字节的实际值，并能够与处理器文档交叉引用它们以了解正在发生的事情。这通常不是必需的，但它可以是教育性的。例如：

```
mov dl, byte_404580[eax] 
```

可以表示为一个字节序列：

```
8A 14 05 80 45 40 00 
```

使用[Intel 的体系结构手册第 2A 卷](http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html)，可以将其解码如下：

```
8A - instruction opcode for MOV r8, r/m8 - determines the operand sizes

14 - the Mod R/M byte:
         | 00010100b
     Mod | 00
     R/M |      100
     Reg |   010

     Mod R/M combination 00-100 is specified as "followed by the SIB byte".
     Reg 010 stands for register DL/DX/EDX, the destination operand.

05 - the SIB byte:
           | 00000101b
     Scale | 00
     Index |   000
     Base  |      101

     This combination is specified as [scaled value of EAX] + a 32 bit displacement.

80 45 40 00 - the displacement itself, 0x404580 
```

将这些加在一起，您将得到：

该指令从寄存器中取出一个字节`EAX + 0x404580`并将其移动到`DL`寄存器中。

* * *

IDA 使用此信息来推断在 处有一个字节大小的值数组，`0x404580`如果该位置还没有名称，则尝试命名该位置，尝试调整该位置的命名项目的大小以跨越正确数量的字节（它不一定知道这个数组中有多少元素，所以它实际上并没有在那里创建一个数组）并将显示的表达式转换为`byte_404580[eax]`.

# java - 如何在 Java 中使用 XPath 作为节点访问 CDATA？

> ID：12148011
> 
> 赞同：3
> 
> 时间：2012-08-27T19:06:05.417
> 
> 标签：java, xpath, cdata

在以下 XML 上使用[此在线 XPath 测试器](http://www.xpathtester.com/)

```
<a>foo <![CDATA[ MyCData]]>  baz</a> 
```

使用 XPath 表达式`/a/text()`，我得到了所有的文本

```
foo <![CDATA[ MyCData]]>  baz 
```

（这被构造为三个节点，我们可以看到 using `/a/text()[2]`，它返回`baz`。）

但是，对于 *javax.xml.xpath.XPath，根本**不*返回CData 和最后一个文本节点。我得到一个带有 的节点`foo`，文本的其余部分`<![CDATA[ MyCData]]> baz`不可用。不管 XPath 如何处理 XML 结构，如果我们根本无法访问节点，这就是一个 bug。

但是，如果我在*DocumentBuilderFactory上设置**isCoalescing(true)*，它会将所有文本和 CData 节点连接为一个。我可能最终会使用它，但它会将 CData 转换为输出中的转义文本，这看起来很难看，即使它是标准允许的。此外，我希望能够将 CData 单独作为某种节点来处理，无论是“只是”一个文本节点，还是某种特殊类型的 CData 节点。

 *顺便说一句，如果 CData 是其父元素的*唯一内容，并且前面没有空格或其他文本，则普通的 text-content XPath 会成功检索它，即使**isCoalescing*的默认值 ( *false* ) 也是如此。因此，我们看到 Java XPath 总是返回第一个，并且只返回第一个文本节点。

当我检查我的 DOM 文档的完整 DOM 树时，默认使用*isCoalescing*，我发现 CData 部分表示为它自己的类型为*cdata-section*的节点，这很好，但是如何在 XPath 中访问这个节点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T08:17:13.520

恐怕在线 XPath 测试仪弄错了。根据 XPath 数据模型，`<a>`元素具有单个文本节点子节点，其字符串值为`"foo MyCDATA baz"`; 没有第二个文本节点，因此对第二个文本节点的请求不应返回任何内容。

XPath 数据模型认为 CDATA 只是一种方便的输入数据的方式，以避免转义特殊字符；CDATA 的存在不会影响 XML 的含义或信息内容，因此它不能用于应用程序。*

# html - CSS3 的哪些部分是 GPU 加速的？

> ID：12148012
> 
> 赞同：13
> 
> 时间：2012-08-27T19:06:12.637
> 
> 标签：html, css, gpu

我一直在阅读一些参考资料，例如“X 是 GPU 加速”和“Y 不是 GPU 加速”，但我找不到完整的列表。**CSS3**的哪些部分是 GPU 加速的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T19:28:41.423

对，这是个很有意思的话题，而且确实取决于浏览器+显卡。我一直想对此进行一些研究，所以这里有一个快速总结。

## Webkit（Safari、Chrome、iOS、Android）

在Webkit中，[AnimationBase.cpp](http://trac.webkit.org/browser/trunk/Source/WebCore/page/animation/AnimationBase.cpp)曾经指定过，但是好像动了！嗬！好吧，无论如何，如果您搜索代码`ACCELERATED_COMPOSITING`，您会找到它。

具体来说，如果某些东西与其中之一匹配，那么它可以被加速（至少在 Chromium 中）：

*   图层具有 3D 或透视变换 CSS 属性
*   层由使用加速视频解码的元素使用
*   层由具有 3D 上下文或加速 2D 上下文的元素使用
*   层用于复合插件
*   图层的不透明度使用 CSS 动画或使用动画 webkit 变换
*   图层使用加速 CSS 过滤器
*   层有一个后代，它是一个合成层
*   图层有一个具有较低 z-index 的同级，该同级具有一个合成图层（换句话说，该图层呈现在合成图层的顶部）

[资源](http://www.chromium.org/developers/design-documents/gpu-accelerated-compositing-in-chrome)

* * *

## 壁虎 (火狐)

在 Gecko 中，[https://wiki.mozilla.org/Platform/GFX/HardwareAcceleration](https://wiki.mozilla.org/Platform/GFX/HardwareAcceleration)解释了他们的计划/实现，就像 IE 一样，在 XP 上的选项更加有限，但如果正确支持显卡，其他所有操作系统都会获得一些加速. Firefox 4（我认为！）为文本、画布和转换添加了加速。

* * *

## 三叉戟 (IE)

IE10 似乎几乎所有硬件都加速了。[http://blogs.msdn.com/b/ie/archive/2011/04/26/understanding-differences-in-hardware-acceleration-through-paintball.aspx](http://blogs.msdn.com/b/ie/archive/2011/04/26/understanding-differences-in-hardware-acceleration-through-paintball.aspx)

它非常快，所以我并不怀疑他们的说法！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T19:08:48.480

没有讨论任何有关 GPU 加速的 CSS3 规范。相反，由每个浏览器制造商或在特定硬件上实现浏览器的公司来决定他们将 GPU 用于 CSS3 的哪些部分。而且，这可以很容易地从一个设备更改为下一个设备。

例如，大约一年前（我没有更多最新信息），3d 转换在 iPhone3 上是 GPU 加速的，但不是 2d 转换。但是，我预计 iPhone3s 或 iPhone4 或未来的 iPhone5 的信息可能会完全不同。

# android - Android：控制外部显示器（例如投影仪）

> ID：12148017
> 
> 赞同：1
> 
> 时间：2012-08-27T19:06:28.520
> 
> 标签：android, projector, external-display

我正在寻找一种使用安卓平板电脑来控制外部屏幕的方法。更具体地说，我希望我的应用程序在平板电脑上显示一个视图，并在外部设备（例如投影仪）上显示第二个视图。我在阅读中还没有遇到过这样做的方法，但我不确定我是否在问正确的问题。这样的事情可能吗？[这个答案](https://stackoverflow.com/a/8556889/1286571)似乎表明它可能是，至少对于某些硬件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T04:32:28.843

有点晚了……但现在有了答案。

到目前为止，一些供应商特定..我认为“私有”API 可以做到这一点。但从 API 级别 17 开始，android 正式支持外显功能。

您可以使用 API 级别 17 中的“android android.app.Presentation”类来实现此目的。

请参阅以下链接了解更多详情。
[http://developer.android.com/about/versions/android-4.2.html](http://developer.android.com/about/versions/android-4.2.html)

# jsf - Servlet Faces Servlet 的 Servlet.service() 抛出异常：java.lang.NullPointerException JSF

> ID：12148019
> 
> 赞同：2
> 
> 时间：2012-08-27T19:06:47.597
> 
> 标签：jsf, jsf-2, primefaces

是否有解决以下错误的方法。当我单击命令按钮时，它会调用 java 脚本来设置 topic_body、topic_url 的值，并通过命令按钮将值提交给服务器中的方法。我不确定需要纠正什么来阻止错误。

**XHTML**

```
<h:form prependId="false" id="testForm">
        <h:inputHidden value="#{topicBean.topicVO.body}" id="topic_body">
        </h:inputHidden>
        <h:inputHidden value="#{topicBean.topicVO.videoAudioUrl}" id="topic_vaurl" >
        </h:inputHidden>
        <h:inputHidden value="#{topicBean.topic_guid}" id="topic_guid">
        </h:inputHidden>
                <p:commandButton id="shareeButton" action="#{topicController.createTopic}" onclick="javascript:renderElement();">
                Share
                <f:ajax execute="@form" render="@form"></f:ajax>
                </p:commandButton>
            </h:form> 
```

**Javascript**

```
function  renderElement(){
           var textarea_content = $('textarea#wall').val();
           $('#topic_body').val(textarea_content);
           if (textarea_content != '') {
               var sitetitle = $('label.title').html();
               if (sitetitle == null) {
                   sitetitle = ' ';
               }
.......
......
..

} 
```

**JSF 豆**

```
@ManagedBean(name = "topicBean")
@SessionScoped
public class TopicBean extends BaseMB implements Serializable {
    /**
     *
     */
    private static final long serialVersionUID = 1L;
    private final static Logger logger = Logger.getLogger(CircleBean.class.toString());
    private TopicVO topicVO = new TopicVO();
    private long topic_guid =0;
    public TopicBean(){
        logger.info("****************************Start TopicBean Constructor****************************************");
        logger.info("****************************End TopicBean Constructor****************************************");

    } 
```

**JSF 方法**

```
@ManagedBean(name = "topicController")
@RequestScoped
public class TopicController  extends BaseMB implements Serializable {

    /**
     *
     */
    private static final long serialVersionUID = 1L;
    private final static Logger logger = Logger
            .getLogger(CircleController.class.toString());
    TopicBean topicBean;

    public void createTopic(){
        logger.info("*******************Inside creatTopic********************");
        topicBean = (TopicBean) FacesUtils.getManagedBean("topicBean");
        ITopicService topicService = (ITopicService) ServiceLocator
                .getService("TOPICSERVICE");
         topicBean.setTopic_guid(topicService.createTopic(topicBean.getTopicVO(), userSession));

        logger.info("*******************Inside creatTopic********************");
    } 
```

**错误**

```
14:44:20,335 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/emyed-web].[Faces Servlet]] (http--127.0.0.1-8080-3) Servlet.service() for servlet Faces Servlet threw exception: java.lang.NullPointerException
    at com.sun.faces.mgbean.BeanManager$ScopeManager$SessionScopeHandler.handle(BeanManager.java:575) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.mgbean.BeanManager$ScopeManager.pushToScope(BeanManager.java:458) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.mgbean.BeanManager.createAndPush(BeanManager.java:410) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.mgbean.BeanManager.create(BeanManager.java:269) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.el.ManagedBeanELResolver.resolveBean(ManagedBeanELResolver.java:244) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.el.ManagedBeanELResolver.getValue(ManagedBeanELResolver.java:116) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.zreflect.emyed.filter.EmyEdAccessFilter.hasLoggedIn(EmyEdAccessFilter.java:113) [emyed-ui-1.0.jar:]
    at com.zreflect.emyed.filter.EmyEdAccessFilter.doFilter(EmyEdAccessFilter.java:84) [emyed-ui-1.0.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:280) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.13.Final.jar:]
    at org.jboss.as.jpa.interceptor.WebNonTxEmCloserValve.invoke(WebNonTxEmCloserValve.java:50) [jboss-as-jpa-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:897) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:626) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:2039) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_25]

enter code here 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T19:41:39.440

根据堆栈跟踪，

```
java.lang.NullPointerException
    at com.sun.faces.mgbean.BeanManager$ScopeManager$SessionScopeHandler.handle(BeanManager.java:575) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.mgbean.BeanManager$ScopeManager.pushToScope(BeanManager.java:458) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.mgbean.BeanManager.createAndPush(BeanManager.java:410) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.mgbean.BeanManager.create(BeanManager.java:269) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.el.ManagedBeanELResolver.resolveBean(ManagedBeanELResolver.java:244) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.el.ManagedBeanELResolver.getValue(ManagedBeanELResolver.java:116) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.zreflect.emyed.filter.EmyEdAccessFilter.hasLoggedIn(EmyEdAccessFilter.java:113) [emyed-ui-1.0.jar:]
    at com.zreflect.emyed.filter.EmyEdAccessFilter.doFilter(EmyEdAccessFilter.java:84) [emyed-ui-1.0.jar:] 
```

您有一个`Filter`类`EmyEdAccessFilter`正在尝试使用 解析特定于 JSF 的 EL 表达式`ValueExpression`，其唯一目的很可能是查找会话范围的 JSF 托管 bean 或其应该代表登录用户的属性。`FacesContext`但是这个 EL 解析失败了，因为servlet 过滤器内部没有方法。应该由`FacesContext`来创建`FacesServlet`，但是在过滤器运行的那一刻，`FacesServlet`根本没有运行，因此`FacesContext.getCurrentInstance()`返回`null`，因此您的代码会中断。

总而言之，这不是在过滤器中检查会话范围的 JSF 托管 bean 的正确方法。

在 JSF 的保护下，会话范围的托管 bean 存储为 的属性，`HttpSession`托管 bean 名称作为会话属性名称。您可以将它们作为 servlet 过滤器中的会话属性以“常规方式”访问。例如

```
@Override
public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {
    HttpServletRequest request = (HttpServletRequest) req;
    HttpServletResponse response = (HttpServletResponse) res;
    HttpSession session = request.getSession(false);
    UserManager userManager = (session != null) ? (UserManager) session.getAttribute("userManager") : null;

    if (userManager == null || !userManager.isLoggedIn()) {
        response.sendRedirect(request.getContextPath() + "/login.xhtml"); // No logged-in user found, so redirect to login page.
    } else {
        chain.doFilter(req, res); // Logged-in user found, so just continue request.
    }
} 
```

Where`UserManager`代表您的会话范围的 JSF 托管 bean。

### 也可以看看：

*   [在任何 Servlet 相关类中按名称获取 JSF 托管 bean](https://stackoverflow.com/questions/2633112/jsf-get-managed-bean-by-name/2633733#2633733)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-03T21:38:11.557

还要检查@ManagedProperty 是否正确。例如：

```
@ManagedProperty(value = "#{user_ejb}")
UserEJB userEJB; 
```

或@Inject

# jakarta-mail - 使用 Java 发送电子邮件的 DataContentHandler 强制转换异常

> ID：12148029
> 
> 赞同：2
> 
> 时间：2012-08-27T19:07:29.750
> 
> 标签：jakarta-mail, dotcloud

*从我部署*的Dotcloud 应用程序`java.lang.ClassCastException: gnu.mail.handler.MultipartMixed cannot be cast to javax.activation.DataContentHandler`发送电子邮件时出现此异常（从我的*本地*计算机它工作正常）。之前用过Spring的javamail，还是不行。然后我找到[了这个建议](http://answers.dotcloud.com/question/334/java-mail-crashes)，但仍然没有成功。

 **我正在使用 Gmail SMTP。配置是在我的 Java 邮件发件人类中以编程方式完成的。我还在 dotcloud.yml 文件中声明了相同的配置参数。

我无法弄清楚我错过了什么。有人有类似的问题吗？你是怎么解决的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:15:58.123

您可能想尝试使用此备用 Java 服务运行您的代码（它是使用自定义 API 重新实现 dotCloud Java 服务）：[https ://github.com/jpetazzo/jetty-on-dotcloud](https://github.com/jpetazzo/jetty-on-dotcloud)

它提供了更大的灵活性，这意味着您应该能够禁用冲突的邮件库。如果您愿意走这条路，请不要犹豫，从 dotCloud 的支持中获得帮助！**

# xcode - 由于IBUIScreenMetrics initWithCoder:]：无法打开接口生成器：无法识别的选择器发送到实例

> ID：12148030
> 
> 赞同：0
> 
> 时间：2012-08-27T19:07:30.030
> 
> 标签：xcode, ios4, ipad

我已经用 xcode 3.2.6 构建了一个项目并将该项目发送给我的合作伙伴。他正在使用更高版本的xcode 4.4，并修改interface builder文件并更改编码。在他将项目发回给我后，由于 IBUIScreenMetrics initWithCoder:]:unrecognized selector send to instance 0x1b109790，我无法打开界面生成器。我想知道根本原因是什么以及如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T09:50:20.910

我也面临同样的问题。

我使用以下方法解决了它。

![xib 配置](../Images/89fde5fddae00c5958ce635c9757c5bd.png)

在 xib 的文件检查器中，从组合框中选择“Interface Builder 3.1”。

在此之后，我可以在 xcode 3.2.6 中打开 xib。

# asp.net - 整数列表到逗号分隔的字符串

> ID：12148045
> 
> 赞同：6
> 
> 时间：2012-08-27T19:08:43.770
> 
> 标签：asp.net, vb.net, .net-3.5

我已经尝试了几种方法，每次尝试时都会出错。

这是使用带有 asp.net(forms) 和 vb.net 的 .net 3.5。

例子：

```
Dim _registrations = New List(Of Integer)

Dim regList As String

Dim ListOfReg = _registrations.convertall(Of String)(Function(i As Integer) i.ToString())

regList = String.Join(",", ListOfReg.ToArray()) 
```

**错误信息：**

`Overload resolution failed because no Public 'convertall' can be called with these arguments: 'Public Function ConvertAll(Of String)(converter As System.Converter(Of Integer,String)) As System.Collections.Generic.List(Of String)': Argument matching parameter 'converter' cannot convert from 'VB$AnonymousDelegate_0(Of Integer,String)' to 'Converter(Of Integer,String)'.`

其他尝试：

```
regList = String.Join(",", (_registrations.Select(Function(reg) reg.ToString()).ToArray())) 
```

**错误信息：**

`Public member 'Select' on type 'List(Of Integer)' not found.`

任何帮助表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-27T19:47:22.810

这应该可以，我猜是选择中的方括号？

.NET 3.5 解决方案

```
Dim integers As List(Of Integer) = New List(Of Integer)
integers.Add(1)
integers.Add(2)
integers.Add(3)

Dim commas As String = String.Join(",", integers.[Select](Function(i) i.ToString()).ToArray())

MessageBox.Show(commas) 
```

下面是.NET 4.0解决方案

```
Dim integers As List(Of Integer) = New List(Of Integer)
        integers.Add(1)
        integers.Add(2)
        integers.Add(3)

        Dim commas As String = String.Join(",", integers.ToArray)

        MessageBox.Show(commas) 
```

# c# - C# Linq/XML - 找不到文件

> ID：12148048
> 
> 赞同：0
> 
> 时间：2012-08-27T19:08:53.073
> 
> 标签：c#, xml, linq

所以我在将我的游戏转换为 XML/Linq 时遇到了麻烦，我需要这样做，因为项目已经扩展。这似乎是一个简单的问题，但是我加载到我的内容中的 XML 文件却没有找到。如果我尝试从目录加载 XML 文件，它可以正常工作，但是如何从项目中包含的内容文件加载？

我是否需要以某种方式应用 Content.Load 才能访问该文件，或者以不同的方式标记该文件？我目前已将标志设置为内容（未编译），内容导入器是 XML 内容 - XNA 框架，内容处理器 - 无需处理，复制到输出目录 - 始终复制。

谢谢您的帮助。我觉得有点笨，不得不问。我在有问题的行旁边放了 3 z。再次感谢！

```
class GameObject
{
    public string objectType;
    public string objectID;
    public bool isActive;
}
struct option
{
    public string optionName;
    public string type;
    public string command;
}
class TitleScreen : GameObject
{
    XDocument TitleData;
    public int totalOptions;
    List<option> optionsShared = new List<option>();
    int currentDrawObject;
    public void Init(string TitleID)
    {
        objectType = "TitleScreen";
        objectID = "Title";
        isActive = true;
zzz            TitleData = XDocument.Load("TitleData.xml");   zzz
        var options = 
            from x in TitleData.Descendants("option")
            select new
            {
                type = x.Descendants("otype").First().Value,
                optionName = x.Descendants("oname").First().Value,
                command = x.Descendants("ocommand").First().Value
            };
        foreach (var x in options)
        {
            optionsShared.Add( new option 
            {optionName = x.optionName,
            type = x.type,
            command = x.command
            });
        }
        foreach (var option in options)
        {
            totalOptions += 1;
        }
    }
    public void Draw(SpriteBatch sb, SpriteFont sf)
    {
        currentDrawObject = 0;
        sb.Begin();
        foreach (var option in optionsShared)
        {
            currentDrawObject += 1;
            sb.DrawString(sf, option.optionName, new Vector2(50, 100 * currentDrawObject), Color.White);
        }
        sb.End();
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:21:33.180

您必须将您的 xml 文件“TitleData.xml”标记为内容并始终复制。

如果您在输出中的特定文件夹中设置此 xml，请小心，您将必须指定路径

```
TitleData = XDocument.Load(@"yourfolder\TitleData.xml"); 
```

在调试模式下，您可以看到设置断点应用程序路径以了解如何获得好的路径

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T19:23:00.403

你需要做这样的事情

```
 XmlDocument xdoc = new XmlDocument();
 xdoc.Load(Environment.CurrentDirectory + "\\TitleData.xml"); 
```

将`Environment.CurrentDirectory`给出项目的位置。如果文件在同一个项目文件夹中，您可以使用它。

# comments - 支持和反对在编码时评论与先编码后评论的争论

> ID：12148049
> 
> 赞同：-4
> 
> 时间：2012-08-27T19:09:04.883
> 
> 标签：comments

支持和反对在编写代码时评论代码与稍后再写所有评论的论点是什么？在写代码之前写注释怎么样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:12:21.680

我认为在编码时写评论是非常重要的，但这不应该阻止你稍后再去澄清事情。

**编码时写评论**

*   你以后可能不会回去做。
*   你可能不会记得你为什么做了你所做的事情。
*   如果您必须研究一种技术或算法，那么“引用您的来源”是一个好主意。

**编码后写评论**

*   您将从一个全新的角度看待代码，也许会更深入地了解哪些部分不是很清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-30T12:24:18.803

代替注释为变量、类、方法等编写具有非常描述性名称的代码。

在大多数情况下，更喜欢测试来记录代码的意图，而不是注释。

评论一写就立即产生“与代码同步”的问题。

我曾经评论过很多。现在，如果有的话，我会非常谨慎地使用评论。如果是这样，通常是针对不明确的异常边缘情况，或者由于相当模糊的原因不应该重构的代码，尽管看起来应该如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T19:12:23.910

在删除之前说明显而易见的事情。

1.  忘记代码块的目的
2.  自我困惑

复杂的代码，例如循环和函数的高级算法 其他开发人员将无法理解代码 - 包括自己以后的使用 也占用内存，性能到想要改进时..可以做

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-21T21:04:32.203

中。

*在编写代码时，*您可以最好地理解代码的每一行。

# wordpress - 仅前端版本的初始化钩子？

> ID：12148050
> 
> 赞同：8
> 
> 时间：2012-08-27T19:09:09.257
> 
> 标签：wordpress, conditional-statements

我正在尝试在我的主题中构建一个功能，该功能依赖于在发送标头之前执行的操作。所以很自然地我像这样挂入了 Init 钩子：

```
add_action('init', 'my_function'); 
```

但问题是我只希望 my_function 在用户不查看管理部分或登录页面时运行。

那么我可以使用什么钩子，它只是前端，但在发送标头之前运行。[查看 API 参考](http://codex.wordpress.org/Plugin_API/Action_Reference)，似乎没有，显然条件在运行时的早期不起作用。

因此，除了搜索 /wp-admin/ 和 /wp-login/ 的 URL（这对我来说似乎很笨拙）之外，我无法弄清楚。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-04-15T23:29:46.240

将你的动作的钩子和函数包装在一个`if(!is_admin()){}`

像这样：

```
if(!is_admin()) {
  //Style
  add_action('init', 'style');

  function style()
  {
      wp_enqueue_style('style', THEMEROOT . '/css/your.css');
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T18:07:11.787

这是我的做法。使用`wp`动作钩子已经足够晚来提供对查询和条件的访问，但仍然发生在模板设置之前。

```
<?php
function my_function() {
    if ( ! is_admin() && ! is_login_page() ) {
        // Enqueue scripts, do theme magic, etc.
    }
}

add_action( 'wp', 'my_function' );

function is_login_page() {
    return in_array($GLOBALS['pagenow'], array('wp-login.php', 'wp-register.php'));
} 
```

**编辑：**我误解了标题的含义（我在想`wp_head`……最近主题编码太多了！）。我现在假设您正在尝试击败`send_headers`行动：

```
function my_function() {
    if ( 'index.php' == $GLOBALS['pagenow'] ) {
        // Pre-header processing on the front-end
    }
}

add_action( 'wp_loaded', 'my_function' ); 
```

它不是超级优雅，但至少它是简洁的。而且[它似乎很可能会继续工作](http://core.trac.wordpress.org/ticket/11871#comment:5)，这总是好消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-08T09:06:42.963

这里有一些很好很酷的解决方案，希望大家会喜欢。

```
function my_func(){
 if ( !is_admin())
 {

 // add code here for show only in front-end or create another function outside this block and call that function here.
 }
 else
 {
 // add code here for show only in admin or create another function outside this block and call that function here.
}}add_action ('init', 'my_func'); 
```

就是这样，使用并看到魔法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-08T16:46:33.507

我只针对前端（不是管理员）的解决方案也是检查引用者，因为有一些 ajax 调用直接指向非`/wp-admin`url 序列，并且`is_admin()`不固定。看来他正在查看这段 URL。

```
// Skip for admin
if ( is_admin() || ( $_SERVER['HTTP_REFERER'] && strpos( $_SERVER['HTTP_REFERER'], 'wp-admin' ) !== false ) ) {
    return;
} 
```

# android - IOS 安卓镜像

> ID：12148053
> 
> 赞同：0
> 
> 时间：2012-08-27T19:09:18.827
> 
> 标签：android, iphone, ipad

我目前正在开发一个网站，我很想在我的网页上使用一些应用商店的图片。如果我使用来自 iTunes 和 android 市场的图像，你们知道是否有任何问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:45:29.580

如果您谈论的是从这些商店购买的图像，那么在您的网站上使用它是没有问题的。如果您尝试使用这些商店上显示的不用于销售的图像或横幅，则可能需要合法的所有者许可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:19:50.593

我认为这没有问题，因为这两个市场都有这些用于“在市场上下载”的图像，也许您甚至可以在每个市场的开发者网站上获得此代码。

# ruby - 需要在 Mac OS X Mountain Lion 上安装 Ruby 1.9.3

> ID：12148054
> 
> 赞同：2
> 
> 时间：2012-08-27T19:09:20.153
> 
> 标签：ruby, bash, installation, rvm, ruby-1.9.3

我在 Mac OS X Lion 上运行了 Ruby 1.9.3（我不得不使用 RVM，因为正常的家庭 brew 安装不起作用）然后安装 Mountain Lion（或其后续更新）导致不再安装 Ruby 1.9.3 + 所有的 gem 都被卸载了，我又回到了 Ruby 1.8.7

我安装了最新的 XCode 版本（4.4.1），并且我尝试了来自类似 StackOverflow 问题的多种不同建议，但均未成功。

我想要的是一个全新的开始（如果可能的话），我想建议如何完全卸载我安装的任何与 Ruby 和 RVM 相关的垃圾并重新开始！那么也许我可以在安装 Ruby 1.9.3 方面获得帮助

但我可以让你知道我目前正在做的事情正在失败......

*   执行`ruby -v`结果`ruby 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin12.0]`

*   执行`rvm -v`结果`rvm 1.15.7 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]`

*   执行`brew upgrade ruby`结果： http: [//pastebin.com/KetSau7k](http://pastebin.com/KetSau7k)

*   执行`rvm install 1.9.3`结果： http: [//pastebin.com/8YKg4wXb](http://pastebin.com/8YKg4wXb) - 当我按下`q`退出时，它继续尝试安装并失败......

从源代码安装 Ruby 到：/Users/markmcdonnell/.rvm/rubies/ruby-1.9.3-p194，这可能需要一段时间，具体取决于您的 CPU...

```
ruby-1.9.3-p194 - #downloading ruby-1.9.3-p194, this may take a while depending on your connection...
ruby-1.9.3-p194 - #extracted to /Users/markmcdonnell/.rvm/src/ruby-1.9.3-p194 (already extracted)
ruby-1.9.3-p194 - #configuring 
Error running ' ./configure --prefix=/Users/markmcdonnell/.rvm/rubies/ruby-1.9.3-p194 --enable-shared --disable-install-doc --with-libyaml --with-opt-dir=/Users/markmcdonnell/.rvm/usr ', please read /Users/markmcdonnell/.rvm/log/ruby-1.9.3-p194/configure.log
There has been an error while running configure. Halting the installation. 
```

*   我也尝试过`rvm install 1.9.3 --with-gcc=clang`，但是在您已经看到的初始消息之后（我按下`q`退出消息并继续安装）然后它告诉我`You requested building with 'clang' but it is not in your path.`

我还安装了许多其他的东西，并执行了一些命令来尝试安装这个破旧的 Ruby 1.9.3，但没有一个起作用 - 因此我认为我可能需要从头开始（如果可能的话？）。

任何安装此程序的帮助（以及一些清理工作）以及对不太了解 Bash/CLI 的人的解释将不胜感激！

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:14:03.740

获取 ruby​​（和 rails）的最简单方法是使用[http://railsinstaller.org](http://railsinstaller.org) - 它将安装所有必需的库和 ruby​​（使用 rvm）。

RVM 中也有安装二进制红宝石的新选项：

```
rvm install 1.9.3 --binary 
```

它可能会向您显示缺少的库列表 - 您需要安装它们并重试。

二进制红宝石的完整列表可在此处获得：[https ://github.com/wayneeseguin/rvm/blob/master/config/remote](https://github.com/wayneeseguin/rvm/blob/master/config/remote)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T07:52:46.127

答案实际上来自@kitcambridge（在推特上），他建议虽然我下载了最新的 XCode，但我需要打开 XCode，然后进入其首选项区域并查找“下载”选项卡，然后我可以在其中下载“命令行工具” ' 安装后修复了一些问题，例如缺少库/链接。

这对我有用。但如果没有，那么我认为下一个最佳解决方案是按照@mpapis 的建议尝试 Rails 安装程序——尽管我不构建 Rail 应用程序，但它似乎仍然是一个很好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T19:28:17.690

您可能需要关注 Yehuda Katz 的 tokaido，这是他正在开发的 OSX 二进制安装程序。它还有更多内容，可能最好在这里阅读[http://yehudakatz.com/2012/04/13/tokaido-my-hopes-and-dreams/](http://yehudakatz.com/2012/04/13/tokaido-my-hopes-and-dreams/)和github repo在这里
[https：/ /github.com/tokaido/tokaidoapp#readme](https://github.com/tokaido/tokaidoapp#readme)

# eclipse - 在eclipse中创建gwt模块

> ID：12148056
> 
> 赞同：2
> 
> 时间：2012-08-27T19:09:23.487
> 
> 标签：eclipse, gwt

我观看了展示如何在 NetBeans 中创建 GWT 库的[教程](http://www.youtube.com/watch?v=QJR1Zw9j-rk)……我试图找到一些关于如何使用 Eclipse 创建 GWT 模块的特定教程示例。我找不到任何东西。这似乎是非常具体的或一些信息:(

所以我的问题是如何使用 Eclipse 创建 GWT 模块（因此，gwt 项目可导入 lib jar）？

PS> GWT 2.3

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:33:15.880

*   如果你想使用 Maven，你可以从一些 GWT 原型创建一个新的 Maven 模块。
*   如果您不熟悉 Maven，可以安装[GWT 插件](https://developers.google.com/web-toolkit/usingeclipse)，然后通过 Eclipse 新建项目向导创建新的 gwt 模块。
*   另一种选择是使用[webAppCreator](https://developers.google.com/web-toolkit/doc/latest/RefCommandLineTools#webAppCreator)脚本，它是命令行中 GWT 的一部分。

# java - 使用连接后需要调用 java.net.HttpURLConnection.disconnect() 吗？

> ID：12148057
> 
> 赞同：1
> 
> 时间：2012-08-27T19:09:26.987
> 
> 标签：java, android, http, httpurlconnection

我`java.net.HttpURLConnection`在 Android (API 16) 上使用。我使用`connect()`然后从连接`getInputStream()`中获取`InputStream`读取数据。在我使用`InputStream`（即消费数据）之后，我`close()`就可以了。

问题是：这是否也关闭了底层证券`HttpURLConnection`（好像通过调用`disconnect()`它）？我的猜测不是，但我只是想确认一下。更普遍的问题是：当连接不再有用时，我是否需要调用 java.net.HttpURLConnection.disconnect() ？

问题是我有一种方法可以打开一个`HttpURLConnection`给定的主机。签名是：`InputStream OpenHttpConnection(String stringURL, String method)`。这将返回一个`InputStream`，调用者使用它从连接中读取数据，但是如果我`disconnect()`从该方法的主体中调用，那么 将`InputStream`关闭并变得无用（我已经确认了这一点）。但是，另一方面，如果当我从调用者调用 , 时连接没有关闭`close()`，`InputStream`那么我将有一个连接浪费资源。

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T19:18:49.100

如果底层流仍然打开，调用`disconnect()`确实会关闭它们，但它还会将连接的资源释放回连接池，所以当你能够（并完成连接）时调用它仍然是一个好主意，即使你是在别处离散地关闭流。

# php - 未找到 cakeDC 评论插件元素

> ID：12148058
> 
> 赞同：0
> 
> 时间：2012-08-27T19:09:28.380
> 
> 标签：php, cakephp, plugins, cakedc

对于那些对 cakeDC 评论插件有经验的人，我能得到一些指导吗？

我的视图页面上的输出是这样的：

```
Element Not Found: Elements/Commentscomments/tree/main.ctp 
```

我知道它找不到正确的文件夹，因为在查找文件时缺少正斜杠。

添加到此页面的查看代码是：

```
<div id="post-comments">
    <?php $this->CommentWidget->options(array('allowAnonymousComment' => false));?>
    <?php echo $this->CommentWidget->display();?>
</div> 
```

我该如何解决这个问题？在修复路径问题方面，我不知道要寻找什么或在哪里寻找。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:14:02.103

据我所知，cakeDC 创建的这个插件还没有完全移植到 2.X 上。我已经在

```
public function display(){} controller found in the CommentWidgetHelper.php file. 
```

`$this->element()`您还需要调整其他一些调用。如果不更改这些项目，它不会从评论插件中正确读取它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-05T11:00:10.977

我发现这个提交为我解决了这个问题：[https ://github.com/CakeDC/comments/commit/75cf8085fa96d1491cb31d2eed10b2ce18331e99](https://github.com/CakeDC/comments/commit/75cf8085fa96d1491cb31d2eed10b2ce18331e99)

# css - VS2010 CSS自动格式化不起作用

> ID：12148060
> 
> 赞同：1
> 
> 时间：2012-08-27T19:09:33.253
> 
> 标签：css, visual-studio-2010

我正在使用 VS2010，并且正在处理我想自动格式化的 Style .css 文件，但它不起作用......为什么？键命令是 ctrl+k, ctrl+f 它说：它们的组合键 (ctrl+k, ctrl+f) 绑定到当前不可用的命令（格式选择）。

有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T19:17:14.143

使用 Ctrl + K、Ctrl + D。在 Microsoft Visual Web Developer Express 2010 中为我工作。

# maven - 在多模块 Maven 项目中组装任意文件

> ID：12148064
> 
> 赞同：0
> 
> 时间：2012-08-27T19:09:48.963
> 
> 标签：maven, maven-assembly-plugin

我正在尝试为一个大型（超过 100 个模块）多模块 Maven 项目创建一个程序集。

一些（但不是全部）模块具有需要包含在最终程序集中的各种文件，但我很难弄清楚如何将它们放在那里。

这是一个典型模块的布局：

```
+- pom.xml
+- src
|  +- main
|     +- java
|        +- ...
|     +- resources
|        +- ...
|     +- scripts
|        +- ... 
```

这个模块有 JAR 打包，所以主要的工件是一个 JAR 文件。

这是最终组装的所需格式：

```
+- bin
|  +- <union of all files from src/main/scripts in the various modules>
+- lib
|  +- <union of all JAR files produced by the various modules> 
```

*我知道如何完成装配结构的**lib**部分，但我不知道如何完成**bin**部分。*

[这篇博文](http://www.sonatype.com/people/2008/04/how-to-share-resources-across-projects-in-maven/)似乎建议每个模块都应该创建自己的程序集（本质上是一个程序集片段），然后这些程序集将由我的实际程序集组件聚合在一起。

这是在Maven中完成的方式吗？它似乎非常重量级和缓慢。有没有不同/更好的方法？

在回答之前，请记住以下事实：

1.  该项目使用平面模块结构（如果重要的话）。更改为嵌套结构不是一种选择。
2.  我无法将脚本合并到一个模块中。即使我可以有其他任意文件也需要打包到最终程序集中，这些文件不能合并到一个地方（我使用脚本作为一个简单的例子来说明问题）。
3.  是的，我认为 100 个模块太多了，但我无法控制。
4.  鉴于模块数量众多，我更喜欢不需要修改每个 POM 的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T16:42:38.880

不幸的是，除了创建一个程序集之外，我找不到更好的答案。看起来我们将编写我们自己的 Maven 插件来处理这个要求，因为考虑到我们的情况，使用程序集的程序集太麻烦了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:27:00.167

不是每个模块都有自己的程序集，而是创建一个名为`assembly`（名称是任意的）的单独模块，并让您的程序集描述符使用相对路径从其他模块中获取任意文件。IE

```
<files>
    <file>
      <source>../config-module/target/sample-config.xml</source>
      <outputDirectory>configs</outputDirectory>
    </file>
</files> 
```

该路径`../config-module`假定您具有该名称的模块。我还假设您从目录中获取`sample-config.xml`文件，`target/`而不是从`src/main/whatever`目录中获取。

请注意，如果您的“任意文件”是每个模块（即 WAR）生成的 Maven 工件，那么可能有更多的惯用方式来完成上述操作。请参阅： [Maven：完整参考 - “最佳实践”](http://www.sonatype.com/books/mvnref-book/reference/assemblies-sect-best-practices.html)

# ruby-on-rails - 一切都需要路线命名吗？

> ID：12148065
> 
> 赞同：0
> 
> 时间：2012-08-27T19:09:52.817
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes

很多时候，在 Rails 项目中，我有一个“内容”控制器，其中包含杂项页面，例如关于我们页面、联系我们页面和介绍页面等。

我通常会做类似的事情

```
match '/content/:action', :controller => 'content' 
```

在 routes.rb 文件中，但我不知道如何在我的视图中引用它。

引用它们的预期方式是什么？是吗：

```
= link_to "Help", '/dashboard/help' 
```

或者我是否需要为这些事情中的每一个创建一个命名路线？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:27:40.720

不，您不需要命名路线，但这是惯例。您也可以执行以下操作：

```
<%= link_to "Help", {controller: 'dashboard', action: 'help' } %></li> 
```

在路线文件中，它看起来像：

```
match '/help', to: 'dashboard#help' 
```

只要你以某种方式映射它，即使这样做`resources :dashboard`也会奏效。如需更多帮助，[请参阅 Rails 中的路由指南](http://guides.rubyonrails.org/routing.html)。您还可以使用该`rake routes`命令列出所有路线，它将列出如下路线：

```
 help        /help(.:format)                static_pages#help
     about        /about(.:format)               static_pages#about
   contact        /contact(.:format)             static_pages#contact 
```

这意味着，在这种情况下，您可以使用 help_path、about_path 和 contact_path。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-27T19:26:27.717

是的，您最好使用创建命名路由

```
:as => "dashboard_help" 
```

在您的路线中，您将拥有

```
link_to "Help", :dashboard_help_path 
```

# python - 8,000,000 条记录的高效内存存储 (Python)

> ID：12148067
> 
> 赞同：2
> 
> 时间：2012-08-27T19:09:58.640
> 
> 标签：python, hbase, thrift, in-memory-database

我有一个需要加载到内存中的人员记录数据库，因为它们会以各种顺序被多次访问。到目前为止，我只是为每条记录实例化了一个 Python 对象。但是现在我有 8,000,000 条记录可以使用，我没有足够的内存来使用这种简单的方法。

在一个平面文件中，每条记录最多只占用 500 字节，没有压缩（压缩时更少）。所以整个数据集在磁盘上小于 4 GB。但是，一旦 Python 将每条记录作为对象加载，我估计将使用 40 GB 的 RAM。我的机器只有 12 GB 的 RAM。

我正在考虑将 C 与我的 Python 程序集成，并将每个记录存储为 C 中的结构。这听起来像是一个好的解决方案吗？或者有没有更好的方法在 Python 中紧凑地存储记录，不需要与 C 接口？

**更新：**我使用的数据库是 Hbase (http://hbase.apache.org/)，在 Hadoop 上运行。通过 Thrift (http://thrift.apache.org/) 连接到 Python。

**更新 2：**我需要以许多不同的顺序访问数据库中的所有记录，这些顺序是在运行时确定的。我想，在每次迭代中，我可以对数据库进行 8,000,000 次查询，但我认为这可能会很慢。

**更新 3：**我认为没有一种存储行的好方法，以便可以按顺序访问它们。我在下一次迭代中需要记录的顺序（我的程序是一个迭代机器学习算法），由上一次迭代期间线性代数投影到数据矩阵的特定特征向量上确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:12:38.320

这是数据库的完美用例。您可以将其存储在磁盘上并根据需要进行查询，而不是将所有内容都存储在内存中。

[sqllite3](http://docs.python.org/library/sqlite3.html)是一个很好且简单的选择。您可能对诸如[SQLAlchemy](http://www.sqlalchemy.org/)之类的对象关系映射器 (ORM) 特别感兴趣，它使使用数据库类似于使用 Python 对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T11:03:18.580

听起来 numpy[结构化数组](http://docs.scipy.org/doc/numpy/user/basics.rec.html)在这里可以很好地工作。与使用 python 对象相比，它使用的内存要少得多，并且 numpy 对它们提供了许多快速方便的操作。此外，数组可以是内存映射文件，有时很有用。

数据库是否是一个好的选择（正如其他人所建议的那样）取决于您的算法以及数据大小。在许多情况下 numpy 是更好的解决方案（工作更少，效率更高等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:18:58.903

我同意该线程中的其他人的观点，即数据库将是首选工具，但如果您坚持在内存中查看[http://www.memsql.com/](http://www.memsql.com/)（尽管我从未使用过它）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T19:15:24.503

根据所需的性能和用例，可能有很多方法可以处理此问题，但您可能并不需要将所有数据都保存在内存中。一种明显的方法是使用真正的数据库引擎，例如[`sqlite`](http://docs.python.org/library/sqlite3.html)or [`mysql`](http://sourceforge.net/projects/mysql-python/)。一种更易于实现但可能慢得多的方法是[`shelve`](http://docs.python.org/library/shelve.html).

# maven - 如何在 org.apache.maven.AbstractMavenLifecycleParticipant 中使用 Aether

> ID：12148070
> 
> 赞同：1
> 
> 时间：2012-08-27T19:10:04.440
> 
> 标签：maven, maven-3, maven-plugin, aether

我按照这个示例将所需的依赖项注入到我的 AbtractMavenLifecyleParticipant 中：

*   [http://www.sonatype.com/people/2011/01/how-to-use-aether-in-maven-plugins/](http://www.sonatype.com/people/2011/01/how-to-use-aether-in-maven-plugins/)

*   [http://maven.apache.org/examples/maven-3-lifecycle-extensions.html](http://maven.apache.org/examples/maven-3-lifecycle-extensions.html)

'afterProjectsRead' 被完美地调用，但 repoSystem、repoSession 和 remoteRepos 总是'null'。

如何从 AbstractMavenLifecyleParticipant 中获取这些对象？

```
import org.apache.maven.AbstractMavenLifecycleParticipant;
import org.apache.maven.MavenExecutionException;
import org.apache.maven.execution.MavenSession;
import org.codehaus.plexus.component.annotations.Component;
import org.sonatype.aether.RepositorySystem;
import org.sonatype.aether.RepositorySystemSession;
import org.sonatype.aether.repository.RemoteRepository;

@Component(role = AbstractMavenLifecycleParticipant.class, hint = "skipper")
public class ModuleSkipperLifecycleParticipant extends AbstractMavenLifecycleParticipant {

    /**
     * @component
     */
    private RepositorySystem repoSystem;

    /**
     * @parameter default-value="${repositorySystemSession}"
     * @readonly
     */
    private RepositorySystemSession repoSession;

    /**
     * @parameter default-value="${project.remotePluginRepositories}"
     * @readonly
     */
    private List<RemoteRepository> remoteRepos;

    @Override
    public void afterProjectsRead(MavenSession session) throws MavenExecutionException {
        super.afterProjectsRead(session);

        System.out.println("repoSession: " + repoSession);
        System.out.println("repoSystem: " + repoSystem);
        System.out.println("remoteRepos: " + remoteRepos);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:43:38.207

这就是我们在[jcabi-aether](http://www.jcabi.com/jcabi-aether/)中的做法：

```
final File repo = this.session.getLocalRepository().getBasedir();
final Collection<Artifact> deps = new Aether(this.getProject(), repo).resolve(
  new DefaultArtifact("junit", "junit-dep", "", "jar", "4.10"),
  JavaScopes.RUNTIME
); 
```

也许您可以只使用该库，而不是自己编写它..

# c++ - 删除烦人的突出显示 Netbeans 7.2 C++

> ID：12148073
> 
> 赞同：23
> 
> 时间：2012-08-27T19:10:29.953
> 
> 标签：c++, netbeans, highlight, netbeans-7.2

每当我写一个变量的名字时，我都会得到这个烦人的 IDK green or yellow highlight 。它是什么 ？如何摆脱它？
图片在这里：
![在此处输入图像描述](../Images/6be7a4b90b7faabb284121893214bc1c.png)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-09T15:38:14.357

我知道这是一个老问题，但我认为我的发现可能对其他人有所帮助。:)

我遇到了同样烦人的问题，无论如何我都无法使用此处提到的工具->字体和颜色选项删除突出显示。

实际上起作用的是工具->编辑器->突出显示并关闭“在插入符号下标记符号的出现”。

![在此处输入图像描述](../Images/640ab1f33d082446d008c6f96d1f7714.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-10-10T16:26:50.273

您可以在工具 → 选项 → 字体和颜色中更改背景颜色。在这里您选择语言：“C++”和类别：“标记出现次数”。选择不同的背景颜色并快乐！

![NetBeans 6.9.1 选项/字体和颜色窗口的屏幕截图](../Images/92035c15f209bb7e0f866799a5a719e6.png)

这对我来说也很烦人。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-27T19:15:34.597

只需取消选择我刚刚用黑色边框“突出显示”的图标

或键入 Alt+Shift+H

![在此处输入图像描述](../Images/35bc1e6b79fec6c2a09822d7729602bd.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-11T09:12:23.980

我在使用 PHP 时遇到了完全相同的问题。

工具 -> 选项 -> 字体和颜色，然后选择您的语言，它应该在那里......

（在 php 中，变量的名称是“Mark Occurences”）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-10-01T23:03:42.847

[![netbeans黄色高亮错误](../Images/a3e624d6b053b807a358d81ec6318d35.png)](https://i.stack.imgur.com/TfHYF.png) 我在 Netbeans 8.0.2 上遇到了这个烦人的问题，这就是我逐步解决的方法：

1) 工具 > 选项

2) 编辑器 > 突出显示

3) 选择语言示例 - PHP

4）取消选中“在插入符号下标记符号的出现”选项

5) 在应用更改以删除所有现有标记之前，取消选中“保留标记”选项。（我发现选中此选项会保留现有的突出显示）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-15T05:37:19.247

根据[这个论坛](https://forums.netbeans.org/post-88796.html)，为了手动编辑文件以更改“标记出现”颜色，您可以在此存档中查找要编辑的文件（应该适用于其他语言。链接论坛使用 Groovy）：

```
\.netbeans\7.0\modules\org-netbeans-modules-[LANGUAGE NAME]-editor.jar 
```

寻找这个文件：

```
\org\netbeans\modules\[LANGUAGE NAME]\editor\resources\FontColors.xml 
```

Ctrl+F for`mark-occurrences`然后将`bgcolor`值编辑为您想要的值。

# session - 回收 IIS 应用程序池是否会导致正在进行的会话出现问题？

> ID：12148074
> 
> 赞同：3
> 
> 时间：2012-08-27T19:10:34.893
> 
> 标签：session, iis, iis-7, application-pool

我在 Windows 2008 x64 服务器、ASP.NET MVC 和 .NET 框架 4 上使用 IIS 7.5。

如果我在我的 Web 应用程序运行并且用户登录时回收应用程序池，1) 用户的会话和相关数据是否会被破坏，他们是否必须重新登录？而且，在我回收时正在进行的请求会失败，还是 IIS 会在执行回收之前完成这些请求？

在使用应用程序时回收我的 Web 应用程序的应用程序池有什么负面影响？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T22:04:55.970

如果您在内存中进行会话管理，那么您可能会遇到一些问题。如果您正在进行适当的会话管理（例如，在数据库中），那么用户应该没问题。当新应用程序出现并开始将内容加载到内存中以服务请求时，您将遇到速度变慢。

正在进行的请求有机会完成，但机会有限（默认情况下它们有 90 秒）。

**回收的缺点基本上分为两类：**

1.  您必须将所有内容重新加载到内存中（这需要时间，在此期间用户正在等待）。

2.  长时间运行的请求将被终止（默认情况下，应用程序池有 90 秒的时间来完成其业务，例如长文件上传/下载可能必须重新启动，因为它与回收重叠）。

# css - 不能用“none”覆盖背景颜色，只能用“inherit”

> ID：12148088
> 
> 赞同：6
> 
> 时间：2012-08-27T19:11:27.060
> 
> 标签：css, windows-8

我试图从 Windows 8 ListView 控件中的 .win-container 元素（图块）中删除白色背景，以让背景显示出来。当我跟踪样式时，我可以看到白色背景正在应用以下规则......

```
.win-listview :not(.win-footprint).win-container 
```

所以我为此写了自己的规则......

```
.win-listview :not(.win-footprint).win-container {
    background-color: none;
} 
```

但这没有用。

一位朋友帮我弄清楚我可以使用...

```
.win-listview :not(.win-footprint).win-container {
    background-color: inherit;
} 
```

这很好用。谁能告诉我为什么会这样？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-27T19:22:44.963

`none`是`background-image`属性的值，而不是`background-color`。由于它不是 的有效值`background-color`，因此忽略该声明，系统将继续使用默认的白色背景绘制您的图块。如果你想给你的瓷砖一个透明的背景，你需要使用`background-color: transparent`：

```
.win-listview :not(.win-footprint).win-container {
    background-color: transparent;
} 
```

（您也可以使用`background: none`, 但再次`none`用`background-image`隐含`transparent`的 for表示`background-color`。）

`background-color: inherit`只需告诉您的瓷砖采用（或[继承](http://www.w3.org/TR/CSS21/cascade.html#inheritance)`ListView`）与包含它们相同的背景颜色。这可能会或可能不会有没有明显背景颜色的明显效果。但是，它与具有透明背景不同（除非它`ListView`本身也具有透明背景，在您的情况下它可能没有）。

# vba - 处理下拉列表中较长的值

> ID：12148090
> 
> 赞同：0
> 
> 时间：2012-08-27T19:11:33.703
> 
> 标签：vba, excel

我有一个 excel 形式的下拉列表，由于下拉列表的长度限制，其中的值不适合单行。有解决方案吗？

我可以增加下拉列表的宽度并在两行而不是一行中显示更长的值吗？

任何建议表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T22:00:23.650

我不知道这种行为是否是您想要的，但这可以让您了解可能的情况

```
Option Explicit

Dim origColWidth As Double

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Const avgcharperStdColumn As Long = 8 'avg characters in col width 8.43
Const defaultColumnWidth As Double = 8.43 'Default column width

Dim dataValCell As Range
Dim cellVal As Validation
Dim splitString() As String
Dim newColWidth As Double
Dim i As Long
Dim maxStrLength As Long

    'Set cell with data validation
    Set dataValCell = Sheet1.Range("G5") 'Define which cell contains validation

    'Check selection intersects required cell
    'Also check only 1 cell is selected
    If Not Intersect(Target, dataValCell) Is Nothing _
        And Target.Rows.Count = 1 And Target.Columns.Count = 1 Then

        'capture current width to allow reset
        origColWidth = Target.ColumnWidth

        'access the validation list in the cell
        Set cellVal = dataValCell.Validation

        'Split the contents into an array and cycle to find longest string
        splitString = Split(cellVal.Formula1, ",")
        For i = LBound(splitString) To UBound(splitString)
            If Len(splitString(i)) > maxStrLength Then maxStrLength = Len(splitString(i))

        Next i

        'VERY crude method to calc how many chars fit column - needs more work :)
        newColWidth = (maxStrLength / avgcharperStdColumn) * defaultColumnWidth
        If newColWidth > origColWidth Then
            dataValCell.ColumnWidth = newColWidth
        End If

    'if variable set and not intersecting validation cell then reset column width
    ElseIf origColWidth > 0 Then
        dataValCell.ColumnWidth = origColWidth

    End If

End Sub 
```

# python - 如何使用 Python 测试服务器速度

> ID：12148092
> 
> 赞同：0
> 
> 时间：2012-08-27T19:11:35.677
> 
> 标签：python

我正在尝试测试我的服务器的速度，并将其与第三方服务器（包括 Facebook、Tumblr 和 Google）进行比较。我需要构建一个包含至少 100 个请求的报告，我决定用 Python 来做这件事。

我的想法是我将图像上传到 Facebook，然后重新下载它（因为 Facebook 修改了我上传的图像）并将其上传到其他第三方服务器以及我自己的服务器。我为每个服务器请求文件 x 次，Python 将打印每次请求所花费的时间。

这是我的脚本：

```
from time import time
from urllib import urlopen

# vars
url = raw_input("Please enter the URL you want to test: ")

for i in range(0,100):
    start_time = time()
    pic = urlopen(url)

    if pic.getcode() == 200:
        delta_time = time() - start_time
        print "%d" % (delta_time * 100)
    else:
        print "error"
print "%d requests made. File size: %d B" % (i, len(pic.read())) 
```

我不擅长 Python，所以我不确定我是否做得对。

**这是最好的方法吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:36:00.500

有许多可用的[HTTP 性能测试工具](https://www.google.com/search?q=http+performance+testing+tools)。我建议您在创建自己的之前尝试其中之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T03:25:44.073

[正如Lev Levitsky](https://stackoverflow.com/questions/12148092/how-to-test-server-speed-with-python#comment16253356_12148092)所指出的，这个问题实际上属于[代码审查](https://codereview.stackexchange.com/)。我最初按预期发布的代码，我正在寻找的只是有关如何改进它的指导。

[这是关于代码审查的这个问题。](https://codereview.stackexchange.com/questions/15113/rapidly-requesting-a-file-from-a-server)

# python - 就地快速排序实现

> ID：12148093
> 
> 赞同：0
> 
> 时间：2012-08-27T19:11:39.537
> 
> 标签：python, algorithm, data-structures

我正在尝试按照[http://en.wikipedia.org/wiki/Quicksort中的说明实现就地快速排序](http://en.wikipedia.org/wiki/Quicksort)

下面是python代码，分区函数没有按预期工作。

```
def swap(array, index1, index2):
    tmp = array[index1]
    array[index1] = array[index2]
    array[index2] = tmp

def partition(array, left, right, pivotIndex):
    pivotValue = array[pivotIndex]
    swap(array, pivotIndex, right)
    storeIndex = left
    for i in range(left, right - 1):
        if array[i] < pivotValue:
            swap(array, i, storeIndex)
            storeIndex = storeIndex + 1
            print array, i
    swap(array, storeIndex, right)
    return storeIndex

def quicksort(array, left ,right):
    if right > left:
        print left, right
        pivotIndex = left
        pivotNewIndex = partition(array, left, right, pivotIndex)
        quicksort(array, left, pivotNewIndex - 1)
        quicksort(array, pivotNewIndex + 1, right)

if __name__ == '__main__':
    array = [3,7,8,5,2,1,9,5,4]
    partition(array, 0, len(array) - 1, 3) # 5 is pivot
    print array # expecting all the elements to the left of pivot value(5) will be lesser or equal. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:26:10.463

您需要进行至少 2 个修复：

```
def partition(array, left, right, pivotIndex):
    pivotValue = array[pivotIndex]
    swap(array, pivotIndex, right)
    storeIndex = left
    for i in range(left, right):    # range doesn't include right element already
        if array[i] <= pivotValue:  # need to check for equality (not really necessary for the sorting routine)
            swap(array, i, storeIndex)
            storeIndex = storeIndex + 1
            print array, i
    swap(array, storeIndex, right)
    return storeIndex 
```

`range(left, right)`返回一个像这样的项目列表`[left, left + 1, ..., right - 1]`，所以没有必要用 生成一个列表`range(left, right -1)`，因为这样我们不仅要跳过列表的最后一个元素（pivot 所在的位置），还要跳过最后一个元素（即`right - 2`）。

如果期望`partition`pivot左边的元素应该小于或*等于*之后，我们应该在数组遍历时的比较中体现出来（`array[i] <= pivotValue`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-01T09:24:02.920

使用更少的变量和干净的方法不是更好的方法吗

#!/usr/bin/python

```
Array = [1,2,3,4,5,4,3,23,4,5,4,3,2,1,2,3,4,3,4,1,412,2,4]

def swap(a,i,j):
    temp=a[i]
    a[i]=a[j]
    a[j]=temp

def partition(a, left, right):

    pivotIndex=right
    for i in range(left,right):
        if a[i] > a[pivotIndex]:
            swap(a,i,pivotIndex)

    return pivotIndex

def quicksort(array , left,right):

    if left<right:
        pivotIndex=partition(array,left,right)
        quicksort(array, left, pivotIndex-1)
        quicksort(array, pivotIndex+1, right)

def main():
    quicksort(Array, 0 , len(Array) -1)   
    print (Array )

main() 
```

# java - 在 Java 中按 GridFS 上的 uploadDate 排序

> ID：12148094
> 
> 赞同：0
> 
> 时间：2012-08-27T19:11:47.080
> 
> 标签：java, mongodb, gridfs

GridFS 默认存储文件名和uploadDate。MongoDB Java 驱动程序允许您通过 String Id 和 DBObject 查询来查找。如何按文件名查找文件，按uploadDate 排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:58:41.907

我假设您正在使用`GridFS`MongoDB Java 驱动程序中的类。正如您所提到的，它有两个方法`.find(DBObject query)`和`.find(String filename)`，它们都返回 a `List<GridFSDBFile>`。

最好使用该`GridFS.find(String filename)`方法并`uploadDate`在客户端进行排序（例如 use `Collections.sort()`）。顺便说一句，您可以使用`ObjectID`代替`uploadDate`. 由于`ObjectID`包含创建时间作为最高有效位，因此返回的文件自然应该按`uploadDate`升序排序。依赖的唯一缺点`ObjectID`是它只有秒精度，所以`uploadDate`如果你需要亚秒精度，你必须对它进行排序。

您可以`.find()`在结果实例上`db.fs.files DBCollection`应用该`.sort()`方法`DBCursor`，但排序应该足够便宜，可以在客户端进行。收到 sorted`DBCursor`后，您可以查询`GridFS`各个文件。但是，您最终不得不`GridFS.find(ObjectID)`单独打电话，这可能会降低效率。

# wpf - 为什么我的 xaml 只显示一个没有任何内容的普通窗口

> ID：12148097
> 
> 赞同：1
> 
> 时间：2012-08-27T19:11:58.577
> 
> 标签：wpf, windows, visual-studio-2010, xaml

我是 WPF、Xaml 的新手，并且是 C# 初学者！我一直在研究这个，我不知道为什么下面的 xaml 只显示一个普通的窗口。没有按钮，没有标题，没有内容。我会很感激你的指导。如果问我为什么必须使用 MediaChecker，我是按照 Stack Overflow 以下帖子中的示例进行的：

[如何从一个 Xaml 文件导航到另一个 Xaml 文件？](https://stackoverflow.com/questions/2834028/how-do-i-navigate-from-one-xaml-file-to-another)

提前致谢。

```
<Window x:Class="MediaCheckerWPF.AboutBox" 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Title="About Media Checker" Height="300" Width="400" ResizeMode="NoResize" 
    ShowInTaskbar="False">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="28" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="200" />
        </Grid.ColumnDefinitions>
        <Label Grid.Row="0" Grid.Column="0" Content="Name:"/>
        <Label Grid.Row="1" Grid.Column="0" Content="E-Mail:"/>
        <Label Grid.Row="2" Grid.Column="0" Content="Comment:"/>
        <Button Grid.Column="1" Grid.Row="0" HorizontalAlignment="Right" 
            MinWidth="80" Margin="3" Content="START"  />
        <Button Grid.Column="1" Grid.Row="3" HorizontalAlignment="Right" 
            MinWidth="80" Margin="3" Content="STOP"  />

    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:21:43.427

检查 App.xaml 中的 StartupUri

```
<Application x:Class="GabeTexFilestImport.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             StartupUri="MainWindow.xaml">
    <Application.Resources>

    </Application.Resources>
</Application> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T02:20:19.560

您拥有的 XAML 渲染得很好。如果你得到一个空白窗口，那么我怀疑它与其他事情有关，例如启动一个不同的窗口。

仔细检查您的标签的[StartupUri](http://msdn.microsoft.com/en-us/library/system.windows.application.startupuri.aspx)属性是否正确`Window`启动`<Application>``App.xaml`

```
<Application x:Class="MediaCheckerWPF.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             StartupUri="AboutBox.xaml">
    <Application.Resources>

    </Application.Resources>
</Application> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-18T18:29:56.200

如果系统非常慢，我也注意到会发生这种情况。比如说，您正在达到最大内存消耗，这会减慢您的系统。在这种情况下，我看到 xaml 窗口出现但完全空白，没有控件，没有最小值，最大值，关闭按钮，没有标题。

# java - 从字符串创建对象

> ID：12148099
> 
> 赞同：2
> 
> 时间：2012-08-27T19:12:00.713
> 
> 标签：java

我知道如果我在其中，`PHP`我将能够创建一个对象，如下所示：

```
// class Name
$var = "Name";
$my_name = new $var("John", "Doe"); 
```

现在，我想在`Java`. 我有一个文件，我需要根据从文件中读取的行来解析和生成对象。例如：

```
2235:org.powertac.common.TariffSpecification::8::addRate::9
2235:org.powertac.common.Tariff::8::new::8
2235:org.powertac.common.TariffSpecification::10::new::1::PRODUCTION
2236:org.powertac.common.Rate::11::new
2236:org.powertac.common.Rate::11::withValue::0.015
2236:org.powertac.common.Rate::11::setTariffId::10
2236:org.powertac.common.TariffSpecification::10::addRate::11
2236:org.powertac.common.Tariff::10::new::10
2247:org.powertac.common.RandomSeed::12::init::DistributionUtilityService::0::model::-7651755067434358
2257:org.powertac.genco.Genco::13::new::nsp1a::true::true
2258:org.powertac.genco.Genco::13::new::nsp1a
2258:org.powertac.genco.Genco::15::new::nsp1b::true::true 
```

那么我应该使用默认值创建一个类型`Rate`为 ( `new`) 的对象。因此，解析该行会产生： `"org.powertac.common.Rate"`( `String`) 并且我想创建一个`org.powertac.common.Rate`对象。我怎么能做到？我知道这是一个懒惰的评估......我怎样才能创建类似的东西`Java`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:15:23.903

使用 Java[反射](http://docs.oracle.com/javase/tutorial/reflect/TOC.html)API：

```
String className = "org.powertac.common.Rate";
String ctorArg = "8";
Class<Rate> clazz = (Class<Rate>) Class.forName(className);
Constructor<Rate> ctor = clazz.getConstructor(String.class);
Rate rate = ctor.newInstance(ctorArg); 
```

然后，如果您想使用反射[调用方法：](http://docs.oracle.com/javase/tutorial/reflect/member/methodInvocation.html)

```
String methodName = "setTariffId";
String methodArg = "1";
Method setTariffId = clazz.getMethod(methodName, String.class);
setTariffId.invoke(rate, methodArg); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:16:54.263

在 Java 中使用一些预先存在的序列化/反序列化解决方案可能更容易，但这里有一些适用于基于 String 的方法的方法：

```
Class<?> rateClass = class.getClassLoader().loadClass("org.powertac.common.Rate");
Constructor<?> constructor = rateClass.getConstructor(String.class);

Rate rate = (Rate)constructor.newInstance("Value") 
```

所以在这种情况下：

```
2258:org.powertac.genco.Genco::15::new::nsp1b::true::true 
```

您将执行以下操作：

```
String className = "org.powertac.genco.Genco";
Object[] args = {"nsp1b", true, true};

Class<?> rateClass = getClass().getClassLoader().loadClass(className);
Constructor<?> constructor = rateClass.getConstructor(String.class, boolean.class, boolean.class);

Object deseraliazed = constructor.newInstance(args); 
```

您可能希望将类型与构造函数值一起存储。

# java - 在 JSON 对象中排列元素？

> ID：12148107
> 
> 赞同：0
> 
> 时间：2012-08-27T19:12:33.970
> 
> 标签：java, json

我正在用 Java 编写一个程序，我需要在其中编辑 JSON 输入，然后通过 POST 将其重新提交到不同的系统。在我的代码中，我使用了一个具有键值对的 HashMap，在其中我将 JSONArray 更新为新的视频类型。该代码似乎工作正常，但我的代码输出不同的顺序，我不知道为什么。

当我使用我的 Java 代码处理 JSON 代码时，输​​出如下所示：

```
 {
    "TransformType": {
        "encodeOptions": [
            {
                "types": [
                    "MPEG"
                ],
                "title": "Convert to MPEG"
            }
        ],
        "processType": "encode"
    }
} 
```

系统期望的输出如下所示：

```
{
    "TransformType": {
        "processType": "encode",
        "encodeOptions": [
            {
                "types": [
                    "MPEG"
                ],
                "title": "Convert to MPEG"
            }
        ]
    }
} 
```

我的代码很简单：

```
HashMap<String,String> newTypesMap = new HashMap<String,String>();

    if (TransformTypeObj.has("encodeOptions")) {

        JSONArray encodingOptionsArr = TransformTypeObj.getJSONArray("encodeOptions");

        for( int i = 0; i < encodingOptionsArr.length(); i++ ) {

             JSONObject encodeOptObj = encodeOptionsArray.getJSONObject(i); 
             JSONArray typesArr = encodeOptObj.getJSONArray("types");

             for (int h = 0; h < typesArr.length(); h++) {
                    String oldtype = typesArr.getString(h).toString();
                    String newType = newTypesMap.get(oldtype);
                    typesArr.put(h, newType);
            }
         } 
    } 
```

我无法编辑或查看此第三方系统，但显然顺序很重要。我将我的 Java 输出编辑为“正确”格式并进行了手动发布，系统接受了它。如果我尝试使用我的 java 代码输出，我会收到一条错误消息：

```
Java.lang.RuntimeException: com.jacksonmedia.data.api.marshalling.MarshallingException: array element type mismatch 
```

我认为这与对象的顺序有关。如何使“processType”JSONString 成为 TransformType 对象中的第一个元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:21:03.513

而不是`HashMap`使用`LinkedHashMap`which 保留插入顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:18:20.503

我假设您使用的是来自 json.org 的 JSONObject impl。不幸的是，JSONObject 不保留内部元素的顺序（它在内部使用 HashMap）。您可以找到另一个保留顺序的 JSON 库。或者，您可以获取源并更改 JSONObject 以在内部使用 LinkedHashMap 并改用您的自定义实现。

# html - 跨度中的 CSS 固定宽度

> ID：12148108
> 
> 赞同：0
> 
> 时间：2012-08-27T19:12:34.227
> 
> 标签：html, css

我需要一个固定跨度的示例：跨度[中的CSS固定宽度](https://stackoverflow.com/questions/257505/css-fixed-width-in-a-span)

引用：

```
<li><span></span> The lazy dog.</li>
<li><span>AND</span> The lazy cat.</li>
<li><span>OR</span> The active goldfish.</li> 
```

作者想要：

```
 The lazy dog.
AND The lazy cat.
OR  The active goldfish. 
```

但是，如果我长期离开部分：

```
 The lazy dog.
ANDDDDDDDDDDDDDD The lazy cat.
OR               The active goldfish. 
```

但我真的需要：

```
 The lazy dog.
ANDDDDDDDDDDDDDD The lazy cat.
              OR The active goldfish. 
```

可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T19:34:22.087

像这样的东西对你
有用 尝试模仿表格显示

```
li{
   display:table-row;        
}
li span{
   display:table-cell;
   text-align:right;
   padding-right:5px;
} 
```

[演示](http://jsfiddle.net/unloco/3kjfz/2/)

# c# - 从 .Net 将简单数据插入 Excel 文件的最简单方法

> ID：12148111
> 
> 赞同：7
> 
> 时间：2012-08-27T19:12:37.097
> 
> 标签：c#, .net, excel

我有一个 10 列和 1-20 行的 excel 文件。我需要插入 1-20 行各种数据元素。

我想知道是否有一种方法可以将一些标签放入 excel 文件中，以便可以找到并替换它们。将列标记为“名称”的东西。这样在代码中我只能说：

`Name[0] = object.name;`

我不确定这种确切的方法是否可行，但我真的不需要任何繁重的工作，而且我宁愿不对单元格位置进行硬编码，因为 excel 文件可能会随着时间而改变。

我还必须在行中添加一个隐藏的“ID”单元格。我想我以后可以过那座桥。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-27T19:54:48.100

使用 ADO.NET 很容易在 Excel 工作表中添加一行

```
string fileName = @"D:\test.xlsx"; 
string connectionString = String.Format(@"Provider=Microsoft.ACE.OLEDB.12.0;" + 
        "Data Source={0};Extended Properties='Excel 12.0;HDR=YES;IMEX=0'", fileName); 

using(OleDbConnection cn = new OleDbConnection(connectionString))
{
    cn.Open();
    OleDbCommand cmd1 = new OleDbCommand("INSERT INTO [Sheet1$] " + 
         "([Column1],[Column2],[Column3],[Column4]) " + 
         "VALUES(@value1, @value2, @value3, @value4)", cn);
   cmd1.Parameters.AddWithValue("@value1", "Key1");
   cmd1.Parameters.AddWithValue("@value2", "Sample1");
   cmd1.Parameters.AddWithValue("@value3", 1);
   cmd1.Parameters.AddWithValue("@value4", 9);
   cmd1.ExecuteNonQuery();
} 
```

上面的代码假定您有第一行的标题，其中 Column1... 作为列名。此外，代码使用 Excel 2007 或 2010 的 ACE OleDB 提供程序，而不是 Microsoft.Jet.OleDb.4.0。

编辑：要引用命名范围，您可以将 sql 命令更改为这个

```
 OleDbCommand cmd1 = new OleDbCommand("INSERT INTO [yourNamedRange] " + 
                        "VALUES(@value1, @value2, @value3, @value4)", cn); 
```

唉，我找不到引用各个列的方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-27T19:34:58.490

```
 private Excel.Application app = null;
    private Excel.Workbook workbook = null;
    private Excel.Worksheet worksheet = null;
    private Excel.Range workSheet_range = null;
    private const int FIRTSCOLUMN= 0 //Here const you will use to select good column
    private const int FIRSTROW= 0
    private const int FIRSTSHEET= 1

    app = new Excel.Application();
    app.Visible = true;
    workbook = app.Workbooks.Add(1);
    worksheet = (Excel.Worksheet)workbook.Sheets[FIRSTSHEET];
    addData(FIRSTROW,FIRTSCOLUMN,"yourdata");

 public void addData(int row, int col, string data)
    {
        worksheet.Cells[row, col] = data;

    } 
```

# objective-c - 财产不保留 (ARC)

> ID：12148113
> 
> 赞同：4
> 
> 时间：2012-08-27T19:12:38.527
> 
> 标签：objective-c, properties, delegates, automatic-ref-counting, protocols

我有一个以表单样式显示的模式视图控制器。它有一个委托协议。我正在实现该协议并在演示之前分配一个委托，但即使该属性很强大，它也会丢失。欢迎任何可能的原因。谢谢！

这是属性声明，一样强。

```
@protocol SDStoreViewDelegate <NSObject>
// Methods
@end

@interface SDStoreViewController : UIViewController

@property (strong, nonatomic) id <SDStoreViewDelegate> delegate;

@end 
```

这是创建对象和设置委托的地方。

```
SDStoreViewController *store = [[SDStoreViewController alloc] init];
[store setDelegate:self];

NSLog(@"1 %@",store.delegate); // Returns Object as expected

[self presentViewController:store animated:YES completion:^{
    NSLog(@"3 %@",store.delegate); // Returns Object as expected
}];

NSLog(@"4 %@",store.delegate); // Returns Object as expected 
```

这是 SDStoreViewController 的 viewDidLoad。它已经失去了它的代表

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    NSLog(@"3 %@",_delegate); //  Returns NULL
} 
```

这是解雇只是因为委托被称为它不是NULL。

```
- (void)dismiss:(id)sender
{
    NSLog(@"5 %@",_delegate); // Returns NULL

    [self.delegate aMethod];
} 
```

**更新**

我已经使用了`weak`和`strong`引用。我也使用了`self.delegate`和`_delegate`来访问该属性。作为一点，`aMethod`回调没有通过，这促使这项侦探工作找到了它迷路的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:26:08.503

首先，该`delegate`属性**必须始终是** `weak`，`unsafe_unretained`否则`ARC`不能解除分配具有彼此强指针的类。

```
@property (weak, nonatomic) id <SDStoreViewDelegate> delegate; 
```

或者

```
@property (unsafe_unretained, nonatomic) id <SDStoreViewDelegate> delegate; 
```

* * *

您为什么不尝试`delegate`通过 getter 到达该属性？像这样：

```
NSLog(@"4 %@",self.delegate); 
```

代替

```
NSLog(@"4 %@",_delegate); 
```

* * *

还有一个额外的问题：您的方法是否在该行中被调用？

```
[self.delegate aMethod]; 
```

如果答案是肯定的，你没有丢失你的`delegate`，如果答案是否定的，你在哪里设置你的`delegate`其他地方？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:19:57.330

在实现文件中添加一个 set 和 get 方法。就在合成功能旁边。

```
@synthesize delegate = _delegate;
- (id)delegate{
    return _delegate; // Add a breakpoint here
}
- (void) setDelegate:(id) delegate {
    if (_delegate != delegate){
        _delegate = delegate; // Add a breakpoint here
    }
} 
```

还要在方法中放置一个断点，`initWithCoder:`看看它是否正确进入那里。

# c++ - void f() = 0 是虚拟方法吗？

> ID：12148114
> 
> 赞同：1
> 
> 时间：2012-08-27T19:12:44.033
> 
> 标签：c++, methods, virtual, abstract-class, derived-class

这里有点菜鸟怀疑（我的另一个：P）

关于我正在阅读的一本书：

*   一个抽象基类（**ABC**）是通过纯虚方法的声明来实现的。
*   使方法成为纯虚方法的原因在于`= 0`声明的末尾。
*   您可以这样声明：`virtual void f() = 0;`这样您就不需要在 ABC 中定义它，但是派生类必须实现它自己的版本。
*   但是你也可以像这样声明一个虚方法：`void f() = 0;`这样你需要在 ABC 中定义方法，派生类可以这样使用它。ABC 需要这种方法，其方法都通常由其派生类应用。

**如果以上所有观点都是正确的**，我不明白的是：什么是虚拟方法？

因为`void f() = 0;`对我来说看起来像是一种常规方法。ABC 将定义它，而派生对象将使用 ABC 的定义，就像任何其他公共方法一样。是否有对这两个实例具有吸引力的虚拟方法定义？

> 纯虚函数或纯虚方法是需要由非抽象派生类实现的虚函数

这个定义是从这个站点的另一个问题中挑选出来的。所以我的猜测是我正在阅读的书是错误的？`void f() = 0;`声明该类是 ABC 但它不是纯虚拟方法。有人可以证实这一点或向我解释吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-27T19:14:34.827

```
void f() = 0; 
```

除非基类定义`f()`为`virtual`. 例如：

```
class A
{
public:
   virtual void f() = 0;
};

class B : A
{
   void f() = 0;
} 
```

以上是合法的，因为`f()`本质上是`virtual`. 否则，没有。

**tl; dr**您不能将非虚拟方法声明为纯方法，但是方法可以是虚拟的，而无需显式指定`virtual`关键字（通过继承）。我希望这就是这本书所说的，否则我倾向于说这是一个~~蹩脚的~~坏书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:20:01.663

如果一个**函数**（C++ 没有方法）被标记`virtual`或者覆盖了基类中的一个虚函数，那么它就是虚函数。一个虚函数可以用`= 0`; 标记为“纯虚函数”。这意味着不必定义该函数，并且直接从该类派生的类也是抽象类，除非它们覆盖该函数（以及任何其他纯虚函数）。覆盖函数也可以`= 0`用来使覆盖器成为纯虚拟的。

# javascript - 类中对象的奇怪问题（John Resig 简单继承）

> ID：12148115
> 
> 赞同：0
> 
> 时间：2012-08-27T19:12:48.517
> 
> 标签：javascript, inheritance, canvas

这是小提琴

这个有效

[http://jsfiddle.net/P72UR/](http://jsfiddle.net/P72UR/)

这个没有

[http://jsfiddle.net/j86TA/1/](http://jsfiddle.net/j86TA/1/)

抱歉，我包含了这么多代码只是想让测试尽可能接近。

第二个是使用一个对象来保存 x 和 y 值。第一个不是。

这可能是一个函数绑定问题，但我不完全确定。

我有这个代码：

```
 (function createClouds() {

        var Cloud = Class.extend({

            size: 0,
            alpha: 0,

            x: 0,
            y: 0,

            pos: {
                x: 0,
                y: 0
            },

            init: function (x, y, size, alpha) {

                this.x = x;
                this.y = y;
                this.size = size;
                this.alpha = alpha;

console.log(this.x) // this prints a random number.  all good

            },

            update: function (time) {

            },

            draw: function (ctx) {

                ctx.fillStyle = 'rgba(255, 255, 255, ' + this.alpha + ')';
                ctx.beginPath();
                ctx.fillRect(this.x, this.y, this.size, this.size);
                ctx.closePath();
                ctx.fill();
            }
        });

        sg.Cloud = Cloud;

    })(); 
```

然后我基本上是在画布上用随机点创建这个对象。

```
 for (var i = 0; i < 20; i++) {

        var x = sg.util.getRandomInt(0, sg.currentGame.width);
        var y = sg.util.getRandomInt(0, sg.currentGame.height - 260);
        var size = sg.util.getRandomInt(20, 200);
        var alpha = sg.util.getRandomNumber(.1, .6);

        sg.createEntity(new sg.Cloud(x, y, size, alpha));
    } 
```

sg.createEntity 将此实体添加到数组中；

然后我调用一个方法。

```
 for (var i = 0; i < sg.entities.length; i++) {
                sg.entities[i].draw(this.context);
            } 
```

这会吸引所有实体。

以上工作正常。我得到随机分数。

如果我改变这个。

```
 (function createClouds() {

        var Cloud = Class.extend({

            size: 0,
            alpha: 0,

            x: 0,
            y: 0,

            pos: {
                x: 0,
                y: 0
            },

            init: function (x, y, size, alpha) {

                this.pos.x = x;
                this.pos.y = y;
                this.size = size;
                this.alpha = alpha;

console.log(this.pos.x) //this prints a random number;
console.log(this.pos) //inspecting this object shows same points.

            },

            update: function (time) {

            },

            draw: function (ctx) {

                ctx.fillStyle = 'rgba(255, 255, 255, ' + this.alpha + ')';
                ctx.beginPath();
                ctx.fillRect(this.pos.x, this.pos.y, this.size, this.size);
                ctx.closePath();
                ctx.fill();
            }
        });

        sg.Cloud = Cloud;

    })(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:31:42.203

这是因为`.extend()`对基础对象进行了浅拷贝，但`.pos`它是一个对象，因此复制它会导致对自身的更多引用而不是新实例。

以下是发生的情况的一个小示例：

```
var a = { x: 0 }, b = a;

b.x = 4;

console.log(a.x); // prints 4 
```

我不确定如何解决它，因为它似乎不是为了正确处理对象属性。

# android - 使用 RGB565 配置加载位图

> ID：12148118
> 
> 赞同：0
> 
> 时间：2012-08-27T19:12:57.657
> 
> 标签：android, bitmap

我正在从我的资产文件夹中使用首选配置 RGB565 加载我的位图并记录它们的格式配置，但我总是得到 ARGB8888。我确定我的一些位图配置是 RGB565 但我认为它们覆盖了像 ARGB8888 位图这样的区域.如何使用自己的格式加载它们？

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inPreferredConfig = Config.RGB_565;
Bitmap bitmap = BitmapFactory.decodeStream(in,null,options);
Log.d("a", fileName+" "+bitmap.getConfig().name()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:37:15.883

您不会总是以这种方式获得 RGB565 - 它取决于编码（它是首选编码）

加载位图后，您可以创建一个新位图并将其复制到那里......因为您正在有效地重新编码图像。

```
Bitmap maskBitmap = Bitmap.createBitmap( orig.getWidth(), orig.getHeight(), Bitmap.Config.RGB_565 );
Canvas c = new Canvas();
c.setBitmap(maskBitmap);
Paint p = new Paint();
p.setFilterBitmap(true); // possibly not nessecary as there is no scaling
c.drawBitmap(orig,0,0,p);
orig.recycle(); 
```

然后你可以使用 maskBitmap 作为加载的位图。

# javascript - 在初始查询/表格绘制时仅提取一列 Google 电子表格

> ID：12148119
> 
> 赞同：0
> 
> 时间：2012-08-27T19:13:00.183
> 
> 标签：javascript, dom-events, google-docs, google-docs-api

我试过搜索这个，并没有在这里找到任何类似的问题。

我可能遗漏了一些明显的东西——我真的是一个网页设计师，被要求做我从未学过的编程东西......

基本上，我的用户选择查询运行良好，请参见此处：[http ://umbc.edu/_bwtech/api2.html](http://umbc.edu/_bwtech/api2.html)

但是当页面第一次加载时，它会加载我所有的表格列——但我只希望它拉出第一列。

我以为我在这里工作：http: [//umbc.edu/_bwtech/api6.html](http://umbc.edu/_bwtech/api6.html) 但是用户查询不再有效。

对于用户选择的查询，如何仅绘制一列而不会失去对整个表中数据的访问权限？

如果我在这里复制代码更容易，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T14:47:43.957

我想到了！

我只需要移动我的位置：

// 应用查询语言语句。query.setQuery('SELECT A');

在 sendAndDraw 函数之外。

最终的JS如下：

```
var isFirstTime = true;
var options = {'showRowNumber': true};
var data;
var queryInput;

// To see the data that this visualization uses, browse to
// http://spreadsheets.google.com/pub?key=rYQm6lTXPH8dHA6XGhJVFsA
var query = new google.visualization.Query(
    'https://docs.google.com/a/umbc.edu/spreadsheet/ccc?key=0Akd-rqu1ZR70dDYxUEtFdGVadENqN09kT01pdklRbXc&pli=1#gid=0');

 // Apply query language statement.
query.setQuery('SELECT A');

function sendAndDraw() {
  // Send the query with a callback function.
  query.send(handleQueryResponse);
}

function handleQueryResponse(response) {
  if (response.isError()) {
    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
  data = response.getDataTable();
  var table = new google.visualization.Table(document.getElementById('querytable'));
  table.draw(data, {'showRowNumber': false});
  if (isFirstTime) {
  init();
  }
}

function setQuery(queryString) {
  // Query language examples configured with the UI
  query.setQuery(queryString);
  sendAndDraw();
  queryInput.value = queryString;
}

google.setOnLoadCallback(sendAndDraw);

function init() {
  isFirstTime = false;
  (new google.visualization.Table(document.getElementById('table'))).draw(data, options);
  queryInput = document.getElementById('display-query');
}

function setQueryFromUser() {
  setQuery(queryInput.value);
} 
```

# css - 如何避免使用 CSS 进行中间链接自动换行？

> ID：12148121
> 
> 赞同：18
> 
> 时间：2012-08-27T19:13:09.737
> 
> 标签：css

我的导航区域有一个水平显示的项目列表，但它包含中间链接，就像这样

```
| This is Item One | This is Item Two | This is Item Three | This is
Item Four | This is Item Five | 
```

当我希望它像这样包装时：

```
| This is Item One | This is Item Two | This is Item Three  
| This is Item Four | This is Item Five | 
```

我尝试`whitespace: nowrap`在我的链接项 (li a) 上使用声明，但这只会使第二行（包装的）完全消失。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-27T19:16:11.050

我相信您正在寻找的是[white-space 属性](http://www.w3schools.com/cssref/pr_text_white-space.asp)：

```
.menu a {
    white-space: nowrap;
} 
```

另一种选择是分配固定宽度并将每个菜单项浮动到左侧。

```
.menu a {
    display: block;
    float: left;
    width: 200px;
} 
```

当然，CSS 会因您的 HTML 而异。我建议您将菜单放在无序列表中，并将这些样式应用于列表项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-27T20:09:13.153

在没有您的任何样式和标记可供我使用的情况下，这是我可以提供的最佳解决方案（因为这是对您的问题到底是什么的疯狂猜测）：

您需要做的就是应用`display:inline-block`到适当的`<a>`标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-23T22:53:54.603

*我意识到这是一个老问题，但是由于从未接受过答案，因此在今天的情况下，这是一个答案：*

如今，您可以通过将父级设置为`display: flex`并将其应用于子级来解决此问题`white-space: nowrap`。flex 布局处理链接组的换行，并防止链接本身进行换行。

```
<div class="link-group">
  <a class="link">First Link</a>
  <a class="link">Second Link</a>
  <a class="link">Third Link</a>
  <a class="link">Fourth Link</a>
</div> 
```

```
/* parent */
.link-group {
  display: flex;
  flex-wrap: wrap;
}

/* child */
.link {
  white-space: nowrap;
} 
```

# json - 调用 JsonpRequestBuilder.requestObject() 时出现超时异常

> ID：12148123
> 
> 赞同：1
> 
> 时间：2012-08-27T19:13:24.593
> 
> 标签：json, gwt

我在调用`JsonpRequestBuilder`请求时遇到超时异常。

我也是参考[问题](https://stackoverflow.com/questions/2404359/gwt-jsonprequestbuilder-timeout-issue)，但我每次都收到超时异常。

我的入口点类是

```
package com.dips.restcalls.client;

import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.jsonp.client.JsonpRequestBuilder;
import com.google.gwt.user.client.rpc.AsyncCallback;

public class RequestClass implements EntryPoint {

        @Override
        public void onModuleLoad() {
                // TODO Auto-generated method stub
            private static final String JSON_URL = "http://www.flickr.com/services/rest/?method=flickr.test.echo&format=json&api_key=XXXXXXXXXXX";

            JsonpRequestBuilder builder = new JsonpRequestBuilder();
            builder.setTimeout(1000);
            builder.setCallbackParam("jsonCallback");
            builder.requestObject(JSON_URL, new AsyncCallback<T>() {
                @Override
                public void onFailure(Throwable caught) {
                    // TODO Auto-generated method stub
                    System.out.println("Fails...."+ caught);
                }

                @Override
                public void onSuccess(T result) {
                    // TODO Auto-generated method stub
                    System.out.println("Sucess...");
                }
            });

        }

    } 
```

你可以从[这里获取 flickr json url](http://www.flickr.com/services/api/response.json.html)

我的 JavaScriptObject 类是

```
package com.dips.restcalls.client;

import com.google.gwt.core.client.JavaScriptObject;

public class T extends JavaScriptObject {

    public T() {
        // TODO Auto-generated constructor stub
    }
} 
```

在 Firebug 中，我得到 json 响应，但是在控制台中，我每次都得到 Timeout Exception。请帮我。

# java - CRUD 返回的最佳实践

> ID：12148124
> 
> 赞同：1
> 
> 时间：2012-08-27T19:13:26.033
> 
> 标签：java, crud

在 CRUD 操作中返回对象的最佳实践是什么（如果有的话）。就我而言，对于 Java。

例如，对于 CREATE 我想返回对象，它的 ID ...？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-27T19:16:56.047

*   *create* - 创建的对象。我知道，我知道它通常是同一个对象，但它既方便又优雅。

*   *更新*- 也返回相同的对象。在某些框架中，例如 JPA，更新的对象可以是不同的实例，而不是提供的实例。

*   *restore* - 显然是您要恢复的对象。如果您正在恢复列表，请考虑实现分页 - 获取偏移量/最大值并返回包含在`Page`对象中的列表，其中包含一些额外的元数据，例如条目总数。

*   *删除*- 这里没有什么可以返回的，`void`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:24:03.310

没有真正定义的最佳实践集，但这里列出了我如何使用 CRUD procs：

创建：不传入数据或传入一些数据（例如，为新用户提供姓名、地址、电子邮件地址等）并获取新插入记录的新对象或主键。

阅读：传递可以识别单个记录或一组记录的内容（例如，很可能是一个主键，如一个人的 id 或电子邮件地址）。

更新：传入所有要更新的数据。如果不更新数据，请确保允许传入空值，如果值为空，则跳过更新该列。

删除：传入一个标识符（例如一个人的 id 或电子邮件地址）并且没有返回任何内容（无效）或指示删除成功的布尔值。

# sql-server-2008 - 从插入语句返回 ID

> ID：12148125
> 
> 赞同：4
> 
> 时间：2012-08-27T19:13:25.580
> 
> 标签：sql-server-2008

> **可能重复：**
> [获取插入行标识的最佳方法？](https://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row)

我有一个 INSERT 语句，例如

```
INSERT INTO PATIENT_PROFILE(PATIENT_NAME, OTHER_NAME, AGE, SEX, PHONE_NO, MOB_NO,          CAT_NAME, ADDRESS)
VALUES(@PAT_NAME, @OTHER_NAME, @AGE, @SEX, @PHONE, @MOB, @CAT_NAME, @ADD) 
```

现在我想获取 PATIENT_PROFILE 中存在的患者 ID。有什么方法可以让插入语句返回 PATIENT_ID？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:21:36.547

使用[Scope_Identity()](http://msdn.microsoft.com/en-us/library/ms190315.aspx)

所以：

```
declare @IdInserted int
INSERT INTO PATIENT_PROFILE(PATIENT_NAME, OTHER_NAME, AGE, SEX, PHONE_NO, MOB_NO,          CAT_NAME, ADDRESS)
VALUES(@PAT_NAME, @OTHER_NAME, @AGE, @SEX, @PHONE, @MOB, @CAT_NAME, @ADD)
set @IdInserted = Scope_Identity() 
```

# certificate - 复杂等级中的证书长度

> ID：12148129
> 
> 赞同：0
> 
> 时间：2012-08-27T19:13:53.007
> 
> 标签：certificate, complexity-theory

> 试图决定一种语言的成员资格的非确定性机器会被呈现一个提示（称为“见证”或“证书”），该提示（称为“见证”或“证书”）可以证明成员（没有为语言之外的元素提供这样的见证；定义是不对称的）。

那么，如果一个非确定性算法可以在 O(f(n)) 时间内解决问题，这是否意味着证书的长度为 f(n)？输入大小为n？

此外，如果存在可以在 O(f(n)) 时间内验证证书的算法 A，这如何意味着存在可以在 O(f(n)) 时间内解决问题的非确定性算法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:51:01.450

恕我直言：

*   *那么，如果一个非确定性算法可以在 O(f(n)) 时间内解决问题，这是否意味着证书的长度为 f(n)？*

**不**

*   *输入大小为n？*

**是的**

*   *此外，如果存在可以在 O(f(n)) 时间内验证证书的算法 A，这如何意味着存在可以在 O(f(n)) 时间内解决问题的非确定性算法？*

**这里没有暗示。声明是，如果非确定性算法可以在 O(f(n)) 中解决问题，并且可以在 O(g(n)) 中验证解决方案（如果需要，可以使用证书或白度），并且 f 和 g 是多项式, 比问题是 NP 难。（不一定是 NP 完全的）**

# jquery - jquery 选择器选择查找 imgs 但不是子 div 中的图像

> ID：12148132
> 
> 赞同：1
> 
> 时间：2012-08-27T19:14:40.113
> 
> 标签：jquery, css

我有以下样式的html：

```
<div>
   <div><img /><img /></div>
   <textarea />
</div>
<div>
   <img />
</div>
<div>
   <textarea />
</div> 
```

我注意到以前使用的选择器将无法正常工作。

```
$(item).find("input[type!='checkbox'],textarea,img").andSelf().csS("height", x); 
```

因为它选择了 imgs 和 subdiv。

什么是 jquery 命令不搜索“div”标签的子级以允许它选择所有文本区域、输入 NOT checkbocs 和子 imgs（不在 div 中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:19:04.160

但是，您可以使用`...textarea,>img")...`正在折旧的。我会这样做：

```
$(item).find("input[type!='checkbox'],textarea").css("height",x)
    .end().children("img").andSelf().css("height",x); 
```

# windows-7 - 如何使 .cmd 文件的 txt 输出在文件名中包含当前日期和时间？

> ID：12148137
> 
> 赞同：1
> 
> 时间：2012-08-27T19:14:52.593
> 
> 标签：windows-7, windows-xp, cmd

我有一个脚本可以扫描计算机以查找某个注册表项。我想在扫描创建的文本文件后将其包含在文件名中的日期和时间（本地计算机的日期可以）。我发现了一些似乎可以做到这一点的示例，但要么我不明白他们的答案，要么他们没有将其包含在文件名中。

请，如果您给出答案来解释允许日期在文件名中的每个部分是什么。我看过有关令牌和索引的东西，但我不明白它们是什么，但我对脚本非常陌生，并且正在尝试了解这一点。

以下是我的脚本到目前为止的代码。

```
@echo off

Setlocal
::Test Script
echo This script is used to find a registry setting.(Actual registry patch has been changed for use as an example)
set /p c= Input computer name and push enter: 
set stamp=%date% at %time%
set DateTime=%stamp

call :screen
call :log

pause

:screen
echo.
echo Computer name: %c%
reg query "\\%c%\HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Registry Folder\Registry Folder2\" /V "Registry Key" | FIND "Registry Key"
echo.
goto :eof

:log
echo.
echo Registry value for %c% on %stamp% >TextFile.txt
reg query "\\%c%\HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Registry Folder\Registry Folder2\" /V "Registry Key" | FIND "Registry Key" >>TextFile.txt
echo.
goto :eof 
```

如您所见，我更改了我正在寻找的实际注册表项。老实说，任何命令都可以放在那里，因为我专注于尝试找出如何使正在创建的文本文件在文件名中具有正确的时间戳。

操作系统：Windows XP 和 Windows 7 注意：请原谅我无法给出我正在使用的脚本语言的确切名称，因为我知道如何引用它的唯一方法是“Windows 命令行脚本”......我甚至不知道这是否正确。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T20:39:37.497

我主要是在同事的帮助下找到了答案，还有一些是在各种堆栈溢出帖子的帮助下找到的。我不仅关心看到答案，还关心命令到底发生了什么。

下面将 DateTime 变量设置为 yyyymmdd_hhmmss 中的本地日期和时间 此代码在您的脚本中被正确使用。

```
for /f "skip=1" %%c in ('wmic os get LocalDateTime') do set DateTime=%%c
set DateTime=%DateTime:~0,8%_%DateTime:~8,6% 
```

* * *

说明：如果您在 cmd 中运行以下命令

```
wmic os get LocalDateTime 
```

你得到的输出（不同的数字取决于你这样做的日期/时间）：

```
LocalDateTime
20120829151726.702000-300 
```

现在我们需要格式化它。为此，我只关心日期和时间。第二行包含格式为 yyyymmddhhmmss 的日期和时间，并带有一些额外的 gobbly goop。我们显然不想要第一行，也不想要 .702000-300。

要删除它，我们需要格式化。通过使用**"skip=1"**，您将跳过第一行。:~#,# 可帮助您选择要使用的字符（实际上不要使用 # 字符，我只是将其用作占位符，因此您知道那里有一个数字）。第一个 # 是您的起始值，第二个 # 是起始值之后的字符数。我们想使用前 8 个字符作为日期 (yyymmdd)，因此我们将起始值设为 0（第一个 #），第二个 # 作为 8。

然后我添加下划线和 6 个字符所需的信息（hhmmss）。

在您的脚本中，您现在可以拥有调用 DateTime 变量的代码。

```
echo Hello!>>BestFileEver_%DateTime%.txt 
```

现在带有单词 hello 的文本文件将具有以下文件名：

```
BestFileEver_20120829_153326.txt 
```

现在显然数字会根据您执行此操作的时间而有所不同。

# java - 应用程序级别的安全远程密码协议

> ID：12148144
> 
> 赞同：4
> 
> 时间：2012-08-27T19:15:23.607
> 
> 标签：java, jakarta-ee, security, srp-protocol

我正在编写一个 Java EE 应用程序，它允许新用户自己注册，然后通过 Internet 登录。我将凭据存储在一个数据库中。

现在，有几种方法可以做到这一点，例如：

*   发送用户名和密码，最好通过 TLS/SSL 连接
*   发送用户名和密码的哈希码，最好通过 TLS/SSL 连接
*   使用安全远程密码协议（最好通过 TLS/SSL 连接？）

阅读一些文章，似乎安全远程密码协议（SRP）是要走的路。

但是随后阅读其他一些文章，似乎这仅用于某些低级层，例如 TLS/SSL 本身。

我仍然认为，建议在应用程序级别使用安全远程密码协议。

这个对吗？还是有一些很好的理由说明应用程序级别不需要这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:00:21.780

有一些权衡需要考虑。首先，当且仅当客户端正确验证服务器的 SSL 证书时，通过 SSL 链接发送原始密码是相当安全的。但是，即使执行了正确的 SSL 证书验证，将原始密码发送到服务器也不是完全理想的。被黑的服务器可能会暴露用户的密码。由于密码经常在其他地方重复使用，这种暴露具有潜在的严重影响。

SRP 的一个优点是它避免了这两个问题。用户的密码永远不会离开他们的机器，并且不需要正确的 SSL 证书验证。SRP 的相互验证属性使 SSL 证书变得多余。事实上，一些应用程序利用这一点来完全避免与正确的 SSL 证书管理相关的麻烦。他们只是在服务器上使用匿名的自签名证书仅用于数据加密目的，并将身份验证留给应用程序级 SRP。

具体到您的问题，我认为 SRP 对低级和应用程序级使用的适用性确实取决于您的应用程序。它在这两个领域都可以很好地发挥作用，但它最适合使用的地方实际上归结为您正在使用的特定设计约束集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-22T22:45:11.743

人们应该使用 SRP over TLS/SSL，因为它们是免费的。

如果您的用户通过网络注册或重置他们的 SRP 密码验证器，那么您需要加密连接；因为验证者应该保密，以免受到离线暴力攻击。TLS/SSL/HTTPS 非常适合这个。它们非常成熟，加密所有数据，并提供服务器证书保护，试图确保浏览器不会与欺骗服务器通信。

SRP 意味着您的用户进行身份验证的密码不会跨网络。如果您的用户通过公司网络代理使用公司提供的计算机，那么 HTTPS 可能会被[解密和监控](https://www.bluecoat.com/products/proxysg-secure-web-gateway)。Hearbleed 漏洞还表明配置良好的 HTTPS 可能会出现问题。笔记本电脑制造商故意在他们出售的带有[Superfish](http://www.theguardian.com/technology/2015/mar/09/lenovo-superfish-third-party-apps)的笔记本电脑上破坏 HTTPS，以便他们可以将广告注入加密页面。[法国政府部署的](http://www.theregister.co.uk/2013/12/10/french_gov_dodgy_ssl_cert_reprimand/)根证书可能遭到破坏窥探员工。即使有完美的加密设置，应用程序也可能会意外地将密码泄露到日志中；而 SRP 使用随机输入进行一次性密码证明。因此，SRP 保护密码不离开客户端机器，这本质上比让密码进入两台机器上的内存（可能泄露的地方）更安全。

结果是人们应该同时使用 SRP 和 HTTPS/TLS/SSL。

# .net - 使用 NCrunch 运行测试时如何查看控制台输出？

> ID：12148153
> 
> 赞同：6
> 
> 时间：2012-08-27T19:15:41.757
> 
> 标签：.net, visual-studio, unit-testing, ncrunch

我不知道它是否已实现，但在“输出”窗口中有 NCrunch 输出选项。

![在此处输入图像描述](../Images/b763979277b26b10dbb7c3da3d3a6140.png)

在您运行测试时，TestDriven.NET 已经在执行此操作，我意识到它在快速尝试时很有用。有没有办法让它在 NCrunch 中工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T14:28:06.740

检查 NCrunch 测试窗口。我遇到了同样的问题，但后来注意到“测试”窗口正在显示我的`Console.WriteLine`呼叫输出。

# ios - 创建 UIView 的临时副本

> ID：12148155
> 
> 赞同：2
> 
> 时间：2012-08-27T19:15:54.107
> 
> 标签：ios, uiview

我想复制现有的 UIView 及其所有子视图。复制的视图将用作动画的一部分，之后将不再需要它。

我注意到 UIView 没有实现 copyWithZone。有没有一种基于现有视图创建视图的简单方法？还是我需要使用提供给原始视图的参数手动设置视图？

或者，创建视图图像并将其用于我的动画会更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T19:19:05.617

您确定需要整个视图层次结构吗？您可以使用 -[CALayer renderInContext:] 将视图渲染为图像并使用它吗？

# php - Wordpress cforms插件验证码图像不显示

> ID：12148157
> 
> 赞同：0
> 
> 时间：2012-08-27T19:15:56.470
> 
> 标签：php, javascript, wordpress, captcha

我正在为 Wordpress 使用 cformsII 表单插件。使用 firebug 进行调试时，我看到以下 uri 无法导航到（404 错误）：

```
.../wp-content/plugins/cforms/cforms-captcha.php?ts=2&c1=4&c2=5&ac=abcdefghijkmnpqrstuvwxyz23456789&i=i&w=115&h=25&c=000066&l=000066&f=font4.ttf&a1=-12&a2=12&f1=17&f2=19&b=1.gif 
```

我已经验证 wp-content（包括子目录和文件）具有适当的`777`权限。此外，我证实我可以`1.gif`毫无问题地导航到。最后，我验证了 GD 库也已安装。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T14:32:42.883

它最终成为验证码脚本损坏的问题。能够更换以纠正问题。谢谢各位。

# c# - 使用还是不使用 ReleaseMouseCapture()？

> ID：12148158
> 
> 赞同：1
> 
> 时间：2012-08-27T19:15:59.383
> 
> 标签：c#, wpf

使用在代码中工作的方法可能很好，但不确切知道幕后发生的事情并不是一种很好的感觉。诸如空缺或不完整的工作之类的费用。

我碰巧找到`ReleaseMouseCapture()`并在一个方法（`OnMouseUp`事件）中使用过，因为这似乎是必要的，但我注意到使用或不使用此方法至少不会影响我的应用程序的视觉部分

你能告诉我什么时候应该使用它吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:26:44.470

[MSDN 说：](http://msdn.microsoft.com/en-us/library/ms771301.aspx)

`When an object captures the mouse, all mouse related events are treated as if the object with mouse capture perform the event, even if the mouse pointer is over another object.`

取决于你正在做什么，它可能有意义，也可能没有意义。我们需要更多信息。但归结为，捕获它的对象将侦听并接收来自鼠标的所有事件。这样你可以更好地组织你的鼠标逻辑。例如，在屏幕上拖动一个对象将是完美的，因为对象本身将获取所有鼠标事件。

但是，如果你只是在使用`ReleaseCaptureMouse`，那么不确定你为什么要使用它。你在`CaptureMouse`任何地方使用吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T19:27:42.007

每当我编写代码捕获鼠标时，我都会使用它，完成后需要释放鼠标捕获。

一个典型的例子是拖放控件。当我开始拖动操作时，有时我希望应用程序或控件捕获鼠标，以便将鼠标所做的任何移动都发送到特定的应用程序或控件，而不管鼠标的实际位置如何。当用户释放鼠标按钮时，我需要释放鼠标捕获，以便应用程序/控件停止接收它不感兴趣的鼠标事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T19:27:00.447

你只需要在`ReleaseMouseCapture`你打电话的情况下打电话`CaptureMouse`，所以在你的情况下，听起来你不需要它。

捕获鼠标意味着即使鼠标移动到控件边界之外，控件也会收到鼠标消息。它用于诸如拖放之类的事情，其中​​拖放将发生在控件之外。

# string - 在 txt 文件中搜索一行并删除批处理文件中的后续 13 行

> ID：12148159
> 
> 赞同：0
> 
> 时间：2012-08-27T19:16:00.770
> 
> 标签：string, text, batch-file, line

我有一些 txt 文件，我需要一个批处理文件来搜索特定行，然后从 txt 文件中删除该行和随后的 13 行。

txt文件的示例是：

```
<section1>
line1
line2
line3

<section2>
line1
line2
line3
line4
line5

<section3>
line1
line2
line3
line4
line5
line6
line7
line8

etc. 
```

我需要搜索的行是`<section2>`，然后删除以下内容：

```
<section2>
line1
line2
line3
line4
line5 
```

所以结束了：

```
<section1>
line1
line2
line3

<section3>
line1
line2
line3
line4
line5
line6
line7
line8

etc. 
```

`line1`我还需要在其他部分之后编辑一些行，例如编辑`<section3>`说`editline1`

所以它会找到`<section3>`字符串并改变第 1 行，如下所示

```
<section3>
editline1
line2
line3
line4
line5
line6
line7
line8 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:43:05.237

```
@echo off
  set fnam="%~1"
  set outnam="%~dpn1.out"
  set search4="%~2"
  set section=.
  for /f "tokens=*" %%x in ('type %fnam%') do call :work %fnam% "%%x"
  MOVE /Y %outnam% %fnam%
goto :eof

:work
  set "line=%~2"
  if "%line:~0,1%%line:~-1%"=="<>" (
    if "%section%" neq "." echo.>> %outnam%
    set "section=^%line:~,-1%^>"
    set "line=^%line:~,-1%^>"
  )
  if NOT "%section:~1,-2%>"==%search4% echo %line%>> %outnam% 
```

像这样称呼它：

```
section filename.txt "<section2>" 
```

# php - wordpress 使用帖子缩略图和摘录查询特定类别的帖子

> ID：12148163
> 
> 赞同：-3
> 
> 时间：2012-08-27T19:16:27.683
> 
> 标签：php, html, wordpress, loops, wordpress-theming

> **可能重复：**
> [Wordpress 数组显示来自特定类别的帖子并显示帖子摘录和特色](https://stackoverflow.com/questions/12133784/wordpress-array-to-show-post-from-certain-category-and-show-post-excerpt-and-fea)

大家好，在编写 WP 主题的过程中。我在主页上有一个滑块来显示“新闻”类别中的最新帖子。我已经研究了如何在来自猫的滑块中显示帖子，但我不知道如何包含帖子特征图像，除了. 有人可以请教。

这是我正在进行的 WP 网站。这是“最新消息”滑块。

[http://www.garyrevell.co.uk/student-i-wp/](http://www.garyrevell.co.uk/student-i-wp/)

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:34:32.017

您可以通过将这段代码包含在您希望图像出现的位置的循环中来添加特色图像：

```
<?php if ( has_post_thumbnail()) : ?><?php the_post_thumbnail(); ?><?php endif; ?> 
```

您可以通过将`the_content()`函数替换为`the_exerpt()`.

假设您的循环中有这段代码：

```
<?php the_content(); ?> 
```

你将用这个替换它：

```
<?php the_exerpt(); ?> 
```

除了添加和替换之外，还有更多内容，但我认为这可以帮助您入门。

希望这会有所帮助=]。

**您应该将所有内容都放在循环中。**

这是一个完整的循环，其中包含标题、缩略图和要在您的部分中使用的内容...

```
<?php $my_query = new WP_Query('category_name=news&posts_per_page=1');
while ($my_query->have_posts()) : $my_query->the_post();
$do_not_duplicate = $post->ID; ?>

<h2 id="yourTitle"><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></h2>
<div id="yourImage">
<?php if ( has_post_thumbnail()) : ?><a href="<?php the_permalink() ?>" title="<?php the_title(); ?>"><?php the_post_thumbnail(); ?></a>
</div>
<p id="yourContent"><?php the_exerpt(); ?></p>

<?php endwhile;?> 
```

在这里，我们告诉查询显示您的新闻类别帖子并仅显示 1 个帖子`('category_name=news&posts_per_page=1')`

# python - builtins.TypeError：读取文件对象必须返回纯字符串：Xpath 中的错误 - python

> ID：12148166
> 
> 赞同：0
> 
> 时间：2012-08-27T19:16:35.277
> 
> 标签：python, xml, parsing, lxml

这是我的代码：

```
import os
os.chdir('d:/py/xml/')

from lxml import etree
from io import StringIO

#----------------------------------------------------------------------
def parseXML(xmlFile):
    """
    Parse the xml
    """
    f = open(xmlFile)
    xml = f.read()
    f.close()

    tree = etree.parse(StringIO(xml))
    context = etree.iterparse(StringIO(xml))
    for action, elem in context:
        if not elem.text:
            text = 'None'
        else:
            text = elem.text
        print (elem.tag + ' => ' + text)

if __name__ == "__main__":
    parseXML("example.xml") 
```

我正在尝试在下面提取此 xml 文件：

```
 <?xml version="1.0" ?>
<zAppointments reminder="15">
    <appointment>
        <begin>1181251680</begin>
        <uid>040000008200E000</uid>
        <alarmTime>1181572063</alarmTime>
        <state></state>
        <location></location>
        <duration>1800</duration>
        <subject>Bring pizza home</subject>
    </appointment>
    <appointment>
        <begin>1234360800</begin>
        <duration>1800</duration>
        <subject>Check MS Office website for updates</subject>
        <location></location>
        <uid>604f4792-eb89-478b-a14f-dd34d3cc6c21-1234360800</uid>
        <state>dismissed</state>
  </appointment>
</zAppointments> 
```

遇到这个错误，不知道我做错了什么，请帮忙。

***builtins.TypeError：读取文件对象必须返回纯字符串***

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:54:56.287

```
import os
os.chdir('d:/py/xml/')

from lxml import etree
#from io import StringIO

#----------------------------------------------------------------------
def parseXML(xmlFile):
    """
    Parse the xml
    """
    f = open(xmlFile)
    #xml = f.read()
    #f.close()

    #tree = etree.parse(StringIO(xml))
    context = etree.iterparse(f)
    for action, elem in context:
        if not elem.text:
            text = 'None'
        else:
            text = elem.text
        print (elem.tag + ' => ' + text)

if __name__ == "__main__":
    parseXML("example.xml") 
```

所以这是最终代码，以防万一有人需要，谢谢Blckknght

# objective-c - mutableCopy 和 ARC 导致我出现内存问题？

> ID：12148172
> 
> 赞同：0
> 
> 时间：2012-08-27T19:16:57.810
> 
> 标签：objective-c, ios5, automatic-ref-counting

我有一个财产：

```
@property (nonatomic, strong) NSMutableArray *tagsList; 
```

我这样分配它：

```
self.tagsList = [[managedObjectContext executeFetchRequest:tagRequest error:&tagerror] mutableCopy]; 
```

我是使用 ARC 的新手，这是一个转换后的项目。从我读过的内容来看，这种行为可能是我遇到一些内存问题的原因。

这是这里的情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:21:40.557

不，这正是 ARC 的优势所在。您不必关心发布该副本。

# c# - 如何在另一个中使用 XNA Spritefont 文件的一个元素？

> ID：12148175
> 
> 赞同：1
> 
> 时间：2012-08-27T19:17:05.510
> 
> 标签：c#, xml, xna

希望有一个`Spritefont`命名的父母`regular`并拥有它的“孩子”，`bold`并`italic`使用相同的`<Style>`属性。

因此，不是`<Style>`默认文件中的 (ln ~40ish) 行`SpriteFont`，而是应该从以下内容中提取的`<Style>`内容`defaultFont.spritefont`：

```
<Style><xi:include href="defaultFont.spritefont" xpointer="xpointer('//Style')" xmlns:xi="http://www.w3.org/2003/XInclude"/></Style>
//instead of 
<Style>Bold</Style> 
```

不幸的是，我得到了我`Style is missing error`是否删除了这`<Style>`条线，这让我相信 XNA 正在寻找一条`<Style>regular/bold/etc<Style>`线，或者我的替换工作不正常。

我需要做什么才能让我的 C# XNA 项目项目允许我`Spritefont`在编译之前在另一个 xml 文件中使用一个元素？

# gnuplot - gnuplot：时间序列总是在午夜标记；从文件中读取条宽

> ID：12148176
> 
> 赞同：0
> 
> 时间：2012-08-27T19:17:12.083
> 
> 标签：gnuplot, time-series

我希望 gnuplot 将不规则的时间序列绘制为条形图，但我的条形图始终放置在日期边界（午夜标记）处，好像时间信息被忽略了（例如，前两个条目在午夜彼此重叠显示）。日子间隔得足够宽，这不是酒吧太挤的问题。样本数据：

```
07/09/2012-00:00 1 741 0.50
07/09/2012-12:00 2 3087 0.50
07/12/2012-00:00 1 2011 0.33
07/12/2012-08:00 2 814 0.33
07/12/2012-16:00 2 99 0.33 
```

下面是相关的 gnuplot 代码。xtics 设置只是为了美观，它们与问题无关。

```
set xdata time
set timefmt "%m/%d/%y-%H:%M"
set xtics format "%m/%d"
set xtics "07/08/2012-00:00", 2*172800 ,"08/28/2012-00:00"
plot FILE using 1:3:2 with boxes lc variable 
```

两个独立但相关的问题：1）我可以从 x 轴标签中删除前导零（即 7/8，而不是 07/08）以节省空间（“%m”和“%d”总是给我前导零） ? 2）我可以根据文件中的数据改变条的宽度（在这种情况下，我希望第 4 列是标准条宽度的分数乘数）？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:37:24.400

你的时间格式不对。你想要`%Y`（4 位数的年份）而不是`%y`（2 位数的年份）。

为了指定宽度，您需要 4 列数据：

```
plot FILE using x_column:y_column:x_width:linestyle w boxes lc variable 
```

其中 x_width 是以秒为单位的框的宽度（因为这是时间轴上的单位）。

# php - 如何在一个集合中比较 Magento 中的 2 个不同字段

> ID：12148180
> 
> 赞同：4
> 
> 时间：2012-08-27T19:17:20.097
> 
> 标签：php, magento

我正在尝试将产品价格与 Magento 系列中的销售价格进行比较。具体来说，试图找到销售价格大于或等于其基本价格的所有产品。

从逻辑上讲，我试图将字段名称放入`addAttributeToFilter`调用中：

```
->addAttributeToFilter('special_price', array('gteq' => 'special_price')); 
```

但这没有用。有没有一种好方法可以做到这一点，不需要我让每件产品都有销售价格来手动检查销售价格是否大于或等于其基本价格？

解决方案

这很奇怪，并且显示了 Magento 集合有时是多么奇怪。事实证明，仅仅因为你`->addAttributeToSelect('price')`加入了你的调用链，并不意味着你能以一种很好的方式获得价格。所以我必须做的是放入一个条件，以便我可以在查询的其他部分访问它。我选择了`->addAttributeToFilter('price', array('gteq' => 0))`。我必须以特价做同样的事情。

然后当涉及到 where 条件时，我仍然无法使用简单的名称访问价格和特价，所以我不得不使用它们的表值，所以我的 where 语句最终是`$products->getSelect()->where('_table_special_price.value >= _table_price.value');`

最后，这就是我的整个链条的样子（那里有一些自定义属性）：

```
$products = Mage::getModel('catalog/product')
->getCollection()
->addAttributeToSelect('id')
->addAttributeToSelect('name')
->addAttributeToSelect('price')
->addAttributeToSelect('special_price')
->addAttributeToFilter('price', array('gteq' => 0))
->addAttributeToFilter('special_price', array('gteq' => 0))
->addAttributeToFilter('visibility', 4)
->addAttributeToFilter('discontinued', array('neq' => 1))
->addAttributeToFilter('status', 1)
; 
```

$products->getSelect()->where(' `_table_special_price`. `value`>= `_table_price`. `value`');

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T19:59:54.347

尝试这个：

```
->addAttributeToFilter('special_price', array ('gteq' => new Zend_Db_Expr('price') ) ); 
```

如果它不起作用，您可以这样做：

```
->getSelect()->where("special_price >= price"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-24T04:56:06.377

不得不做类似的事情。

除了获取 special_price >= price 的产品外，它还演示了一种查询计算字段的策略（排除价格以 .09 或 .05 结尾的产品）。

此外，它还演示了如何对（大）集合进行分页，从而最大限度地减少内存使用等。可能对您有用。

```
$products = Mage::getModel('catalog/product')
        ->getCollection()
        ->addAttributeToSelect('*')
        ->addAttributeToFilter('status', 1)
        ->addAttributeToFilter('price', array('neq' => '-1')) // Easy way to join price EAV tables to select
        ->addAttributeToFilter('special_price', array('neq' => '-1')); 

$price = 'at_price.value';
$special_price = 'at_special_price.value';

$price_cents = new Zend_Db_Expr("({$price} - FLOOR({$price})) * 100");
$special_price_cents = new Zend_Db_Expr("({$special_price} - FLOOR({$special_price})) * 100");

$allProducts->getSelect()
    ->where("(
        {$price_cents} != 9 OR 
        {$special_price_cents} != 5
    ) AND 
    {$special_price_cents} >= {$price_cents}");

// You can see the query by uncommenting this part    
//echo "\r\n\r\n";
//echo $allProducts->getSelect();
//echo "\r\n\r\n";

$products->setPageSize(100);

$pages = $products->getLastPageNumber();
$currentPage = 1;
do {    
    $products->setCurPage($currentPage);
    $products->load();

    foreach ($products as $_product) {
        echo "Product: ID-" . $_product->getId() . ", price-" . $_product->getPrice() . ", special price-" . $_product->getSpecialPrice() . "\r\n";
        echo "Memory used: " . memory_get_usage() . " / " . memory_get_peak_usage() . "\r\n";

    }

    $currentPage++;
    //make the collection unload the data in memory so it will pick up the next page when load() is called.
    $allProducts->clear();
} while ($currentPage <= $pages); 
```

# html - 两个具有相同名称的字段创建字符串而不是数组？

> ID：12148181
> 
> 赞同：0
> 
> 时间：2012-08-27T19:17:21.863
> 
> 标签：html, arrays

我有两个同名的字段 name="s[]"，但这会创建一个数组，我不需要数组而是想构造一个字符串。

我正在使用这些字段向 wordpress 提交搜索查询，如果我将使用一个数组，我将不得不与 wordpress 核心混淆，这是我不想要的。所以我唯一的选择是从两个字段创建 1 个单个字符串并将其提交给查询。

你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:25:23.823

我认为有两种选择：

*   将表单提交到不同的页面，该页面重定向到正常的 WordPress 搜索页面

*   使用 JavaScript捕获`onSubmit`事件并重写/添加到表单数据

我更喜欢选项 1，因为它适用于不使用 JavaScript 的浏览器。如果您选择选项 2，那么您甚至不应该向没有 JavaScript 的浏览器显示您的双字段搜索界面。

# c# - HtmlAgilityPack 保存过程不放开文件

> ID：12148184
> 
> 赞同：1
> 
> 时间：2012-08-27T19:17:40.830
> 
> 标签：c#, process, html-agility-pack

我通过重写 Render 方法并使用 HtmlAgilityPack 来保存网站的一些呈现的 html。这是代码：

```
protected override void Render(HtmlTextWriter writer)
{
    using (HtmlTextWriter htmlwriter = new HtmlTextWriter(new StringWriter()))
    {
        base.Render(htmlwriter);
        string output= htmlwriter.InnerWriter.ToString();
        var doc = new HtmlDocument();
        doc.LoadHtml(output);
        doc.Save(currDir + "\\" + reportDir + "\\dashboardTable.html");
    }
} 
```

但是，某些进程不会放开保存的文件，我无法从服务器中删除它。有谁知道会导致这种情况的 HtmlAgilityPack 问题？

任何建议表示赞赏。

问候。

编辑：

我已经尝试了两种建议的方法。我无法确定它们是否是解决方案，因为由于无法删除的文件，我的应用程序在服务器上被冻结。但是，当我在自己的机器上使用这些解决方案时，呈现的 HTML 不再保存为 HTML 表格，而是像这样：

```
INCIDENT MANAGEMENT
Jul '12     F'12
Trend   F'12    2011
(avg)
Severe Incidents (Sev1/2):  3       2.1 4.16
Severe Avoidable Incidents (Sev1/2):    1       1.3 1.91
Incidents (Sev3):   669     482 460.92
Incidents (Sev4) - No business Impact:  1012        808 793
Proactive Tickets Opened:   15      19.3    14
Proactive Tickets Resolved/Closed:  14      17.3    11
CHANGE MANAGEMENT
Total Planned Changes:  531     560 583.58
Change Success Rate (%):    99.5        99.4    99
Non-Remedial Urgent Changes:    6       11  47.08
PROBLEM MANAGEMENT
New PIRs:   2       1.4 2
Closed PIRs:    0       2   3
Overdue Action items:   2       3.2 0
COMPLIANCE MEASUREMENTS
    Jul Trend   Jun
Total Number of Perimeter Devices:  250     258
Perimeter Devices - Non Compliant:  36      31
Total Number of Internal Devices:   6676        6632
Internal Devices - Non Compliant:   173     160
Unauthorized Perimeter Changes: 0       0
Unauthorized Internal Changes   0       0
LEGEND

ISP LINKS
July    June    Trend
SOC CPO DRP SOC CPO DRP
40% 34% 74%     39% 35% 74%     
BELL MPLS HEAD ENDS
July    June    Trend
SOC CPO SOC CPO
8%  5%  7%  10% 8%  5.5%    7%  10% 
ENTERPRISE NETWORK (# of issues called out)
July    June    Trend
CORE    FW/DMZ  CORE    FW/DMZ
1       0       1       0   
US & INTL (# of issues called out)
July    June    Trend
US  Intl    US  Intl
2   2   2   3   
LINE OF BUSINESS    BELL WAN MPLS
<>  50%-65% >65%    <>  50%-65% >65%    Trend
Retail: 2272    0   1   2269    4   0   
Business Banking:   59  1   0   60  0   0   
Wealth: 122 2   0   121 2   1   
Corporate:  51  0   0   49  2   0   
Remote ATM: 280 0   0   280 0   0   
TOOLS
Version Currency    Vulnerability Status    Health Status
Key Messages: 
```

其中仅保存了文本数据，并且缺少所有 HTML 和 CSS。如果我只使用 doc.Save() ，我会得到网站上显示的表格的精确表示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:32:13.123

试试这个。也许 Save 方法没有关闭底层流。

```
using( FileStream stream = File.OpenWrite( currDir + "\\" + reportDir + "\\dashboardTable.html" ) ){
    doc.Save(stream);
    stream.Close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:32:11.157

**编辑**

根据@LB 的评论，似乎 HtmlAgilityPack 确实使用了`using`我的示例中的块，因此它将确保流被关闭。

因此，正如我在原始答案末尾所建议的那样，这一定是服务器环境问题

**原始答案**

这可能是 HtmlAgilityPack 的某种错误 - 您可能希望将其报告给开发人员。

但是，为了消除这种可能性，您可能需要考虑显式控制`StreamWriter`文件的创建，以便您自己显式关闭它。替换这一行：

```
doc.Save(currDir + "\\" + reportDir + "\\dashboardTable.html"); 
```

具有以下内容：

```
using (StreamWriter fileWriter = new StreamWriter(currDir + "\\" + reportDir + "\\dashboardTable.html"))
{
  doc.Save(fileWriter);
  fileWriter.Close();
} 
```

如果即使进行此更改后问题仍然存在，则表明您的服务器环境存在问题，而不是 HtmlAgilityPack 存在问题。顺便说一句，要测试此更改是否会产生影响，您应该从干净的服务器环境开始，而不是在删除相关文件时已经遇到问题的环境。

# spring - Spring MVC 到 Spring REST 教程的误区

> ID：12148185
> 
> 赞同：0
> 
> 时间：2012-08-27T19:17:48.820
> 
> 标签：spring, model-view-controller, rest

我已经开发了一个 Spring MVC-Hibernate 应用程序，如此[处](http://krams915.blogspot.in/2011/01/spring-mvc-3-hibernate-annotations.html)所述。

现在我正在尝试修改此代码以创建一个 REST 应用程序，如此[处](http://www.javacodegeeks.com/2010/06/spring-3-restful-web-services.html)所述。

我已将`Jackson`库添加到类路径并添加了`@XmlRootElement`.

```
@XmlRootElement(name = "persons")
public class Person implements Serializable { 
```

但是，如果我`application/json`提出请求，那么我仍然可以取回`html`代码。

**我做错了什么/忘了做什么？**

我的控制器：

```
 @RequestMapping(value = "/persons", method = RequestMethod.GET)
    @ResponseBody
    public String getPersons(Model model) {

        logger.info("Received request to show all persons");

        // Retrieve all persons by delegating the call to PersonService
        List<Person> persons = personService.getAll();
        model.addAttribute("persons", persons);

        return "personspage";
    } 
```

更改了控制器，但出现错误：t

```
ype Status report

message /Buddies/WEB-INF/jsp/main/persons/1.jsp

description The requested resource (/Buddies/WEB-INF/jsp/main/persons/1.jsp) is not available. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:34:27.480

您的控制器应如下所示：

```
@RequestMapping(value = "/persons/{id}", method = RequestMethod.GET)
@ResponseBody
public Person getPerson(@PathVariable int id) {
    Person person = personService.getPersonById(id);
    return person;
} 
```

如果要返回`Person`对象列表，则需要一个额外的包装器对象，请参阅：[Using JAXB to unmarshal/marshal a List<String>](https://stackoverflow.com/questions/1603404)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:25:31.873

您可能在 spring 配置中缺少[AnnotationMethodHandlerAdapter](http://static.springsource.org/spring/docs/3.0.x/reference/mvc.html)和 messageConverter。

# java - 如何传递包含带有空格的目录作为 Java 参数的 bash 参数？

> ID：12148186
> 
> 赞同：1
> 
> 时间：2012-08-27T19:17:53.693
> 
> 标签：java, linux, bash, shell

我目前正在尝试制作一个 bash 脚本，该脚本以归档文件的路径作为参数来执行 Java 主类。我想确保它可以处理该路径中的空格，这让我有点头疼。

我想将该路径设置为环境变量并在执行主类时调用它，因此脚本如下所示：

```
export ArgPath='/Foo Path/foo.zip'

$JAVA_HOME/bin/java -cp ./foo.jar foopackage.main -a $ArgPath 
```

不幸的是，当我在 Bash 中执行此操作时，命令如下所示：

```
/foo_Java_Home/bin/java -cp ./foo.jar foopackage.main -a /Foo Path/foo.zip 
```

Java 参数不能有空格。Java 将“/Foo”和“Path/foo.zip”视为两个单独的参数。好吧，这不是问题。Java 可以处理带空格的参数。我需要找到一些方法来获得双引号或单引号。我将尝试在路径周围转义双引号。脚本现在看起来像这样：

```
export ArgPath='\"/Foo Path/foo.zip\"'

$JAVA_HOME/bin/java -cp ./foo.jar foopackage.main -a $ArgPath 
```

Bash 给了我这个...

```
/foo_Java_Home/bin/java -cp ./foo.jar foopackage.main -a '\"/Foo' 'Path/foo.zip\"' 
```

...这仍然导致 Java 将它们视为两个单独的参数（更不用说它无论如何都不能作为单个参数工作）。我已经尝试过使用单引号、双引号和转义单引号/双引号/空格的所有组合和排列我能想到的。有什么方法可以提供所需的输出

```
'/Foo Path/foo.zip' 
```

或“/Foo 路径/foo.zip”

在巴什？就此而言，是否有可能让 Bash 接受任意字符串文字，而无需在此类情况下尝试向其添加任何内容？转义字符似乎不起作用，因此如果可能的话，这可能是唯一的选择。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T19:19:15.167

在命令调用中用双引号将变量括起来：

```
export ArgPath='/Foo Path/foo.zip'

$JAVA_HOME/bin/java -cp ./foo.jar foopackage.main -a "$ArgPath" 
```

请注意，这通常适用于调用任何命令（不仅仅是 Java）。如果参数包含空格（等），请将其括在引号中（单引号或双引号）。当参数在变量中时，使用双引号。

# javascript - d3.js yaxis 未正确绘制所有刻度

> ID：12148188
> 
> 赞同：1
> 
> 时间：2012-08-27T19:17:59.447
> 
> 标签：javascript, d3.js

我有一个像

```
[{ name: "a", value: 5000},
{ name: "b", value: 6000},
{ name: "c", value: 7000},
{ name: "d", value: 4000}] 
```

我尝试使用 name 和 value 列使用两个不同的 yaxis 组件绘制 yaxis。但是，值 yaxis 似乎缺少最后一个值之一（“名称”yaxis 标签有 4 个刻度，“值”yaxis 标签有 3 个刻度）。请参阅以下小提琴：

[http://jsfiddle.net/namit101/AmHhg/73/](http://jsfiddle.net/namit101/AmHhg/73/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:36:51.133

正如您所说，它不会绘制 3 个刻度。轴组件使用插值。该组件按预期工作，您只是没有正确使用它。您应该在条形顶部有单独的标签。尝试更改此小提琴中的值：http: [//jsfiddle.net/AmHhg/81/](http://jsfiddle.net/AmHhg/81/)

由于轴分量在值之间进行插值，因此如果您有两次相同的值（第 2 和第 3 条），那么它只显示一次是有意义的......

在第一种情况下（第一个栏），栏正在改变它的值，所以当我们有相同的值时我们实际上看不到它......

在此处阅读有关轴的更多信息：[https](https://github.com/mbostock/d3/wiki/SVG-Axes) ://github.com/mbostock/d3/wiki/SVG-Axes 。还可以尝试查看 Bob Monteverde 的 NVD3 轴组件。

要解决这个问题：如果您实际上不想使用轴而是使用标签，只需在每个条形顶部添加标签，而不是像 Mike Bostock 和 Scott Murray（左对齐）的条形教程中那样让它们自动显示。

# php - MSSQL 和 PHP 回显相同信息的重复行

> ID：12148190
> 
> 赞同：1
> 
> 时间：2012-08-27T19:18:10.510
> 
> 标签：php, sql-server

我对标题感到抱歉，因为我不确定我的问题是在 PHP 还是 MSSQL 查询中。我很确定它是php。

我正在修复一个访问两个不同 MSSQL 表的 PHP 页面。该页面运行良好，直到我们进行了系统范围的更改，创建了新的部门 ID 并因此创建了一些新的部门名称。

我现在几乎完全解决了这个问题，除了一件小事。当您单击列出所有部门时，它会列出所有部门，并且每个链接下都有正确的个人。

问题是它在该部门名称中列出了每个人的链接，例如，如果业务部门中有 10 个人，我们有十个业务链接，并且所有链接下都有相同的信息。

我想做到，所以每个部门只有一个链接。这两个表是目录（涉及的列是显示名称和部门）和部门（涉及的列是名称和 ID）

有人可以告诉我我需要在哪里更改它，以便它只打印一个到每个部门的链接吗？是我的 SQL 查询还是 PHP 的问题？

这是代码

```
function listDepts() {

$query = "SELECT directory.Lastname, directory.Firstname, directory.email, 
directory.phone, directory.Office, directory.Department, departments.id, 
 departments.name FROM directory FULL JOIN departments ON 
directory.Department=departments.id  ORDER BY name";

$result = mssql_query($query);

echo "<h3>Please select a department:</h3>\n";
echo "<ul>\n";

for ($i=0; $i<mssql_num_rows($result); ) {
    $info = mssql_fetch_assoc($result);
    echo "<li><a href=\"dept.php?dept=$info[id]\">$info[name]</a></li>\n";
}

echo "</ul>\n\n";

} 
```

其他查询

```
function displayResults($query) {

$result = mssql_query($query);

if (mssql_num_rows($result) > 0) {

    for ($i=0; $i<mssql_num_rows($result); $i++) {
        $info = mssql_fetch_assoc($result);

        if ($info[dept_name] != $last_dept) {
            if ($i > 0) {
                echo "</table>\n\n";
            }

            echo "<h3><a href=\"$info[dept_url]\">$info[dept_name]</a></h3>\n\n";
            echo "<table id=\"directory_table\">\n";
            echo "<tr>\n";
            echo "<th>Name</th>\n";
            echo "<th>E-mail</th>\n";
            echo "<th>Phone</th>\n";
            echo "<th>Office</th>\n";
            echo "<th>Title</th>\n";
            echo "</tr>\n";
        }

        if (!$info[dept_name] && $i==0) {
            echo "<table id=\"directory_table\">\n";
            echo "<tr>\n";
            echo "<th>Name</th>\n";
            echo "<th>E-mail</th>\n";
            echo "<th>Phone</th>\n";
            echo "<th>Office</th>\n";
            echo "<th>Title</th>\n";
            echo "</tr>\n";
        }

        if ($i % 2 == 0) {
            echo "<tr class=\"even\">\n";
        } else {
            echo "<tr class=\"odd\">\n";
        }

        echo "<td>";
        echo ($info[Firstname]) ? "$info[Firstname]" . " " . "$info[Lastname]" : "&nbsp;";
        echo "</td>\n";

        echo "<td>";
        echo ($info[email]) ? "<a href=\"mailto:$info[email]\">$info[email]</a>" : "&nbsp;";
        echo "</td>\n";

        echo "<td>";
        echo ($info[phone]) ? "$info[phone]" : "&nbsp;";
        echo "</td>\n";

        echo "<td>";
        echo ($info[office]) ? "$info[office]" : "&nbsp;";
        echo "</td>\n";

        echo "<td>";
        echo ($info[title]) ? "$info[title]" : "&nbsp;";
        echo "</td>\n";

        $last_dept = $info[dept_name];
    }

    echo "</table>\n\n";

} else {
    echo "<p>No results found.</p>\n\n";
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:21:22.933

如果您只使用这两个字段：

```
echo "<li><a href=\"dept.php?dept=$info[id]\">$info[name]</a></li>\n"; 
```

为什么不直接进行选择查询：

```
SELECT DISTINCT 
    name 
FROM 
    departments 
ORDER BY 
    name 
```

你没有使用桌子上的任何东西`directory`，所以你不需要从桌子上拿任何东西。

如果您有多个部门，请尝试：

```
echo "<li><a href=\"dept.php?dept=$info[name]\">$info[name]</a></li>\n"; 
```

然后更新您的部门代码以搜索部门中具有该名称的员工。

部门代码：

```
$theSQL = "SELECT * FROM directory WHERE department IN (SELECT id FROM departments WHERE name='$department') ORDER BY Lastname"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:26:24.503

在每次迭代结束时的 for 循环中，需要评估 $i。它应该像

```
for ($i=0; $i<mssql_num_rows($result); $i++) 
```

另一种（通常）循环的方式是

```
$query = mssql_query('your_query');
while ($row = mssql_fetch_assoc($query)){
  echo "<li><a href=\"dept.php?dept=$row['id']\">$row['name']</a></li>\n";
} 
```

# ios - 摆脱这 3 个 Cocos2D 分析器警告？

> ID：12148191
> 
> 赞同：3
> 
> 时间：2012-08-27T19:18:10.963
> 
> 标签：ios, null, cocos2d-iphone, warnings, analyzer

我讨厌应用程序中任何地方的警告，因此我修复了所有其他 Cocos2D 分析器警告，除了这三个我不知道如何解决的警告。

无论如何，希望这里可以帮助我解决这 3 个警告！**带有警告的那一行是前面带有注释的那一行，上面写着“这条线”**

***一个***函数调用参数是一个未初始化的值

```
-(void)update:(ccTime)time
{
    int i, j;

    Tile *tileArray = (Tile*)tiles;

    for( i = 0; i < gridSize_.x; i++ )
    {
        for( j = 0; j < gridSize_.y; j++ )
        {
            //This Line tileArray->position = ccpMult( ccp(tileArray->delta.x, tileArray->delta.y), time);
            [self placeTile:ccg(i,j) tile:*tileArray];
            tileArray++;
        }
    }
} 
```

***二***'*'的左操作数是垃圾值

```
// color
                p->color.r += (p->deltaColor.r * dt);
                p->color.g += (p->deltaColor.g * dt);
                //This Line p->color.b += (p->deltaColor.b * dt);
                p->color.a += (p->deltaColor.a * dt); 
```

***三***赋值为垃圾或未定义

```
void cc_pointerswap(void* a, void* b, size_t width)
{
    void* tmp;
    tmp = *(void**)a;
   //This Line *(void**)a = *(void**)b;
    *(void**)b = tmp;
} 
```

# php - 为什么 PHP 不支持多线程？

> ID：12148193
> 
> 赞同：5
> 
> 时间：2012-08-27T19:18:20.553
> 
> 标签：php, multithreading, language-design

我到处都读到 PHP 不支持多线程，但有一些解决方法。但是*为什么*PHP 不支持多线程呢？对于服务器端脚本语言，这似乎是一个明显的遗漏。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-27T19:40:41.123

阅读此 URL，我认为它对您很有帮助。

PHP 多线程 – 伪造它

[http://w-shadow.com/blog/2007/08/20/php-multithreading-faking-it/](http://w-shadow.com/blog/2007/08/20/php-multithreading-faking-it/)

PHP 本身并不真正支持多线程，但有一些方法可以实现“假”多线程。这是我在 PHPClasses.org 时事通讯中看到的——

[多线程模拟](http://www.phpclasses.org/package/3953-PHP-Emulate-threads-using-separate-HTTP-requests.html)。

请注意，此类旨在用于网络服务器，而不是从命令行（或类似）运行 PHP 脚本。如果您使用 PHP 作为独立的脚本语言，请查看本文末尾的一些替代方案。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-27T19:21:15.963

几年后编辑：您可以使用`pthreads`PHP 多线程，但您真的想要吗？

我不确定是否`pthreads`可以在许多托管环境中使用。坦率地说，我并不急于找出答案。

对于许多应用程序来说，PHP 的最大优势之一是它的隔离性：一个进程，一个请求。多处理通常通过在请求期间排队作业并在其他地方执行来完成。例如，Laravel 有“队列”： [https ://laravel.com/docs/5.7/queues](https://laravel.com/docs/5.7/queues)

* * *

因为 PHP 在编写时并没有考虑到多线程，因此添加它需要付出巨大的努力（基本上是 100% 重写）。

有人会说 PHP 简直是一大堆： http: [//me.veekun.com/blog/2012/04/09/php-a-fractal-of-bad-design/](http://me.veekun.com/blog/2012/04/09/php-a-fractal-of-bad-design/)。从这个角度来看，不包括线程也就不足为奇了。

# java - 如何在 Eclipse 中使用 JAR 中的类

> ID：12148195
> 
> 赞同：5
> 
> 时间：2012-08-27T19:18:37.957
> 
> 标签：java, eclipse, reference, jar, classpath

我有两个 jar 文件 - jar1 和 jar2。它们都位于 C:\Eclipse projects\ 中，我已将它们的路径添加到环境变量 CLASSPATH 中，如下所示

```
.;C:\Program Files\Java\jre6\lib\ext\QTJava.zip;C:\Eclipse projects\stdlib.jar;C:\Eclipse projects\algs4.jar 
```

这 ”。;” 一开始就在那里，所以我离开了他们。然后我将 jar 从它们的位置 C:\Eclipse projects\ 添加到项目中，它们显示为引用库。但是，当我尝试从 jar 中实例化一个类时，它无法识别它。我也无法导入 jar（导入 jar1）。

在我尝试在项目中添加一个 lib 文件夹并在那里添加罐子之后。之后，我再次将它们添加为引用（因此它们不会在引用库中出现两次），但是，我仍然无法使用内部类。任何帮助都感激不尽。

更新：我的结果一定有问题。没有任何建议对我有用。这是包含所有步骤的视频：screencast.com/t/gC81YzCsLY0e

**解决方案**在我的项目中，我有一个名为 TestProject 的包，似乎这些 jar 需要一个默认包。删除 TestProject 包并使用 defaultPackage 后，添加外部 JAR 后一切正常，如下所述。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-23T09:18:31.707

我今天遇到了和你一样的问题，网上没有答案可以解决。不过，我最后修好了。

其实设置没有问题，通过“Add External JARs”导入这些jar就对了。真正的问题是你的java代码的位置/包。我发现您必须将 .java 文件放在默认包中。例如，如果您将 java 代码放入 com.xxx.yyy.ccc 之类的包中，则会出现错误，下图显示了您应该使用的正确位置/包（参见 WTF.java）。完成后，您的程序将能够运行。

![在此处输入图像描述](../Images/388b21a5b7c49b6008b78f1b5d85d3bf.png)

但是，这就是我解决问题的方法，我不确定这是否适用于所有人..

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-12T16:02:33.823

为什么不使用这两个 JAR——stdlib-package.jar 和 algs4-package.jar。

并在代码页下方（[http://algs4.cs.princeton.edu/code/](http://algs4.cs.princeton.edu/code/)）

问：如果我使用命名包来构造我的代码，编译器将无法再访问 stdlib.jar 或 algs4.jar 中的库。为什么不？

A. stdlib.jar 和 algs4.jar 中的库位于“默认”包中。在 Java 中，您不能从命名包访问默认包中的类。如果您需要将我们的库与命名包一起使用，您可以使用以下包版本：stdlib-package.jar 和 algs4-package.jar。

警告：如果您正在学习 Princeton COS 226 或 Coursera, Algorithms, Part I 或 II，您必须使用我们图书馆的默认软件包版本以方便评分。

显示我的测试成功： ![显示我的测试成功](../Images/cdd799863cbb559bd7f4caeefc0a89cc.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-27T19:26:32.730

在 Eclipse 中，右键单击项目->属性->Java 构建路径->添加外部 JAR（如果 jar 在项目文件夹内，则添加 JAR），然后选择您的 jar 文件。从现在开始，您可以使用您添加的 jar 的内部类。当您开始使用它们时，Eclipse 将导入它们。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-27T19:31:51.403

如果您的项目中有一个包含 JAR 文件的文件夹：

1.  右键单击项目>构建路径>配置构建路径；
2.  在“库”选项卡上单击添加 JAR，搜索并选择要使用的 JAR 文件。

如果您在项目之外的任何其他地方有您的 JAR 文件：

1.  右键单击项目>构建路径>配置构建路径；
2.  在“库”选项卡上单击添加外部 JAR，搜索并选择要使用的 JAR 文件。

# iphone - 带标题的自定义文本字段

> ID：12148198
> 
> 赞同：0
> 
> 时间：2012-08-27T19:18:43.450
> 
> 标签：iphone, uitextfield

我正在开发一个 iPhone 应用程序并尝试创建一个带有标题的自定义 TextField，如下图所示。![在此处输入图像描述](../Images/fac6158432209e2e775325c181ec6087.png)

正如您从图像中看到的，标签由用户输入或从数据库中读取的值更改。除了名称之外，还有其他文本字段。

我不确定我应该如何实现这个自定义文本字段？

我认为将带有“名称：”文本的图像放置到文本字段的背景并在其上放置“标签”值的一种方法是放置只有边框的图像并在其上插入“名称：标签”文本。

这些方法是否合适，或者是否有其他最佳方法可用？

编辑：图像上的边框是文本字段的边框；“名称：标签”也在文本字段上方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:49:22.013

Simply put another label with the desired text behind or beside the label or text field that is going to be filled. You can set the `font` and `textColor` and even the `alpha` according to your taste.

Make sure that if they overlap (which they should not!) the `backgroundColor` property of the label is set to `[UIColor clearColor]`.

You could subclass `UITextField` like this:

```
@interface LabeledTextField : UIView
@property (nonatomic, strong) UILabel *label;
@property (nonatomic, strong) UITextField *textField;
@end

#define kPercentWidth 0.5
@implementation LabeledTextField
-initWithCoder:(NSCoder)aDecoder {
   self = [super initWithCoder:aDecoder];
   if (self) {
      CGRect f = self.frame;
      _label = [[UILabel alloc] initWithFrame:CGRectMake(0,0,
               f.size.width*kPercentWidth,f.size.height)];
      _textField = [[UITextField alloc] initWithFrame:CGRectMake(0,0,
               f.size.width*(1-kPercentWidth),f.size.height)];
      [self addSubView:_label]; 
      [self addSubView:_textField];
   }
   return self;
}
@end 
```

You could then use it like this: insert a `UIView` into your storyboard view controller and change the class to your `LabeledTextField`. This would ensure `initWithCoder` is called. Otherwise, you might have to put the init code into its own `setup` function and call it from your override of `initWithFrame`. Make sure you wire up the view with your outlet

```
// .h
#include LabeledTextField.h
//...
@property (nonatomic, strong) IBOutlet LabeledTextField *labeledTextField;

// .m, in some method
labeledTextField.textField.text = @"editable text";
labeledTextField.label.text = @"non-editable text"; 
```

Similarly, you could modify all properties of the label and text field, including colors, fonts etc.

# ruby-on-rails - Ruby on Rails 3 友谊

> ID：12148199
> 
> 赞同：0
> 
> 时间：2012-08-27T19:18:46.413
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我正在尝试按照以下链接构建一个友谊系统：[如何在 Rails 3 中为社交网络应用程序实现友谊模型？](https://stackoverflow.com/questions/5612736/how-to-implement-a-friendship-model-in-rails-3-for-a-social-networking-applicati). 然而代码似乎已经过时了，我可能会改变它，我想做的只是建立一个关系，但这似乎不起作用。

所以这里是我的创作

```
 #Send a friendship request
  def create
    Friendship.request(@customer, @friend)
    redirect_to friendships_path
  end 
```

然后从技术上讲，它将调用位于模型中的方法请求，该模型已在上一篇文章中实现。

```
 def self.request(customer, friend)
    unless customer == friend or Friendship.exists?(customer, friend)
      transaction do
        create(:customer => customer, :friend => friend, :status => 'pending')
        create(:customer => friend, :friend => customer, :status => 'requested')
      end
    end
  end 
```

我也将这些添加到模型中

```
attr_accessible :status, :customer_id, :friend_id, :customer, :friend 
```

然而，友谊并没有建立起来。有什么理由不呢？我称关系已跟随

```
<%= link_to "Add friend", friendships_path(:friend_id => customer), :method => :post %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:24:56.340

您需要将@customer 和@friend 分开。在您的链接中，您将 :friend_id 设置为客户，而您从不设置 @customer id。

尝试这个：

```
def create
  @customer = current_account
  @friend = Account.find(params[:friend_id])
  Friendship.request(@customer, @friend)
  redirect
end 
```

在你需要的 link_to 中：

```
<%= link_to "Add Friend", friendships_path(:friend_id => friend),: method => :post %> 
```

# tomcat - 哪个 AS 更适合 EJB-2 应用程序，客户端代码将驻留在 tomcat6 中

> ID：12148208
> 
> 赞同：0
> 
> 时间：2012-08-27T19:19:39.927
> 
> 标签：tomcat, jboss, ejb

我是 EJB 的新手。我想用 EJB2 做一些实验。我已经安装了 tomcat 6 作为容器。我能够用它构建简单的 Web 应用程序。现在我想开发一个驻留在 tomcat 中的客户端，并与驻留在 Jboss AS 中的 EJB 交互。

请告诉我从哪里下载应用程序服务器以及哪个版本？我正在使用 eclipse Galileo 作为 IDE。

我确实需要知道如何使用应用服务器配置我的 tomcat。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:34:09.720

相信我，您*不想*尝试 EJB 2。避免像瘟疫这样的东西！

如果您想尝试 EJB，请使用 EJB 3。这是一种完全不同的技术，不会试图让您发疯。

JBoss AS 7.1 或 GlassFish 3.1 是很好的入门服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T19:23:01.250

我会推荐[JBoss 7.1（社区版）](http://www.jboss.org/jbossas/downloads/)并且绝对使用**EJB-3**而不是**EJB-2**。

# php - 在 PHP 的 OOP 编程中设置我的类的正确方法是什么？

> ID：12148211
> 
> 赞同：5
> 
> 时间：2012-08-27T19:19:50.963
> 
> 标签：php, mysql, database, oop, design-patterns

让我从一个小小的介绍开始。我正在学习PHP中的OOP。我也研究过设计模式，但还没有完全掌握不同类型的概念。我正处于这样一个阶段，每隔几个月我就会意识到我做事的方式不对，必须改变我的风格。**这太令人沮丧了。**因此，我想一劳永逸地找出正确的做事方式。我已尝试全面阅读有关以下主题的 Stackoverflow：

ORM
数据映射器
Singleton
Globals 是邪恶的
一切相关

但是，我仍然不清楚一些事情。我以清晰简洁的方式在这里发布我的代码，希望人们能够指出好的做法和坏的做法**。**我会在最后列出我所有的问题。

**请不要重复关闭，我已经诚实地搜索了几乎所有关于该主题的问题，但我仍然想知道一些我无法澄清的事情。对不起，它太长了，但我已经尝试组织它，所以它应该读得很好！**

我将首先发布我的数据库类的要点。

***数据库.php***

```
<?php 

class DatabaseMySQL{

    private static $dbh;

    public function __construct(){
        $this->open_connection();
    }

    public function open_connection(){
        if(!self::$dbh){
            return (self::$dbh = new PDO(DB_TYPE.':host='.DB_HOST.';dbname='.DB_NAME, DB_USER,DB_PASSWORD)) ? true : false;
        }
        return true;
    }

    public function query($sql, $params=array()){
        $this->last_query = $sql;
        $stmt = self::$dbh->prepare($sql);
        $result = $stmt->execute($params);  
        return $result ? $stmt : $stmt->errorInfo();
    }

    public function fetch_all($results, $class_name=''){
        return $results->fetchAll(PDO::FETCH_CLASS, $class_name);
    }

}

?> 
```

这是我的数据库类文件。此类允许我创建任意数量的此类实例，并且它将重用已实例化的 PDO 对象，该对象存储为该类的静态属性。它还使用 PDO 从结果集中获取数据，以将数据作为指定类的对象获取。

我拥有的下一个文件是我的所有其他类都继承自的类。我称它为 MainModel。我不知道这是否符合惯例。

***主模型.php***

```
<?php

abstract class MainModel{

    protected static $table;

    public function __construct($array=array()){
        $this->assign_known_properties($array);
    }

    public function assign_known_properties($array){
        foreach($array as $key=>$value){
            $this->$key = $value;
        }
    }

    public static function find_by_id($id){
        $db = new DatabaseMySQL();
        self::intialise_table_name();
        $id = (int) $id;
        $sql = "SELECT * FROM ".static::$table." ";
        $sql .= "WHERE id = {$id} ";    
        $result = self::find_by_sql($sql);      
        return array_shift($result);
    }

    public static function find_all(){
        $db = new DatabaseMySQL();
        self::intialise_table_name();
        $sql = "SELECT * FROM ".self::$table." ";
        return self::find_by_sql($sql);
    }

    public static function fetch_as_objects($results){
        $db = new DatabaseMySQL();
        $called_class = get_called_class();
        $results = $db->fetch_all($results, $called_class);
        return $results;
    }

    public static function find_by_sql($sql){
        $db = new DatabaseMySQL();
        $results = $db->query($sql);
        return $results ? self::fetch_as_objects($results) : false; 
    }

    public static function intialise_table_name(){
        $called_class = get_called_class();
        static::$table = strtolower($called_class).'s';
    }

    public function get_table_fields(){
        self::intialise_table_name();
        $sql = "SHOW FIELDS FROM ".static::$table." ";
        return self::find_by_sql($sql);
    }

    public function set_table_details(){
        $fields = $this->get_table_fields();
        $total = count($fields);
        $array = array();
        foreach($fields as $object){
            $array [] = $object->Field;
        }
        $this->table_details = array('objects'=>$fields,'array'=>$array,'total'=>$total);
        $this->set_placeholders_for_new_record();
        $this->set_properties_as_array();
        $this->set_properties_as_array(true);
    }

    public function set_properties_as_array($assoc=false){
        $array = array();
        if (!$assoc){
            foreach($this->table_details['array'] as $field){
                if(isset($this->$field)){
                    $array [] = $this->$field;
                }else{
                    $array [] = NULL;
                }
            }
            $this->table_details['values'] = $array;
        }else{
            foreach($this->table_details['array'] as $field){
                if(isset($this->$field)){
                    $array[$field] = $this->$field;
                }else{
                    $array [$field] = NULL;
                }
            }
            $this->table_details['assoc_values'] = $array;
        }
    }

    public function set_placeholders_for_new_record(){
        $string = '';
        for($i=0; $i<$this->table_details['total']; $i++){
            $string .= '? ';
            if(($i+1) != $this->table_details['total'] ){
                $string .= ", ";
            }
        }
        $this->table_details['placeholders'] = $string;
    }

    public function create(){
        $db = new DatabaseMySQL();
        $this->set_table_details();
        $sql = "INSERT INTO ".static::$table." ";
        $sql .= " VALUES({$this->table_details['placeholders']}) ";
        $result = $db->query($sql, $this->table_details['values']);

        // If array is returned then there was an error.
        return is_array($result) ? $result : $db->insert_id();
    }

    public function update(){
        $db = new DatabaseMySQL();
        $this->set_table_details();
        $sql = "UPDATE ".static::$table." ";
        $sql .= " SET ";
            $count = 1;
            foreach($this->table_details['array'] as $field){
                $sql .= "{$field} = :{$field} ";
                if($count < $this->table_details['total']){
                    $sql .= ", ";
                }
                $count++;
            }

        $sql .= " WHERE id = {$this->id} ";
        $sql .= " LIMIT 1 ";
        $result = $db->query($sql, $this->table_details['assoc_values']);
        return $result;
    }

    public function save(){
        return isset($this->id) ? $this->update() : $this->create();
    }
}

?> 
```

总结这个文件。我使用静态方法`find_by_id($int)`来动态生成被调用类的对象。我正在使用后期静态绑定来访问被调用类的名称，并使用`$stmt->fetchAll(PDO::FETCH_CLASS, $class_name)`数据库中的数据自动转换为对象来实例化这些对象。

在每个静态方法中，我都会实例化 DatabaseMySQL 类的一个实例。在每个静态方法中，我`$table`通过获取类的名称并将其附加`s`到它来动态设置要在 SQL 查询中使用的正确静态名称。因此，如果我的班级是`User`，那将使表名`users`。

在我的构造函数中，我放置了一个可选数组，可用于在创建对象时插入一些变量作为对象的属性。这样，一切都是动态完成的，这让我进入了项目的最后阶段。我的继承类。

***用户.php***

```
class User extends MainModel{

} 
```

***问题.php***

```
class Question extends MainModel{

} 
```

我现在做的很简单。我可以说：

```
$user = new User(array('username'=>'John Doe'));
echo $user->username; // prints *John Doe*
$user->save(); // saves (or updates) the user into the database. 
```

我可以通过对用户的静态调用来检索用户。

```
$user = User::find_by_id(1);
echo $user->username; // prints users name 
```

所以现在我的问题：

*   1) 你会给这个设计模式起什么名字（如果它甚至是一个）。数据映射器？依赖注入？领域模型（无论是什么）？数据访问层？

*   2) 就目前而言，这种实现是否被认为结构良好？

*   3）如果它很好，我应该注意我的代码中缺少的命名约定吗？

*   4）如果它被认为是好的，你介意指出你特别喜欢什么，这样我就知道你一定要保留哪个部分？

*   5）如果您认为这不好，您是否愿意详细解释为什么会这样？

*   6) 我的对象的所有方法 my , 是否应该与 my 属于同一类，`create`它们仅`update`被静态调用并实际返回对象。如果他们应该在两个不同的班级，我该怎么做？`delete``find_by_id``find_all`

*   7）为什么其他人都在使用`$load->('UserClass')`像mappers这样的函数和花哨的词，而我一次都不需要它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:05:59.690

您提出的解决方案称为“ [Active Record](http://en.wikipedia.org/wiki/Active_record_pattern) ”；对于优点和缺点，您可以阅读 Martin Fowler 的《企业架构模式》一书，以及您可以在 Internet 上找到的许多对话。

Fwiw，我个人的观点是，这是构建数据库驱动应用程序的完美方式，其中主要业务逻辑是读取和写入数据库；在构建更复杂的业务逻辑时，它往往会变得有点负担。

此外，Stack Overflow 不适用于“请讨论这个话题”风格的问题 - 它适用于有客观真实答案的答案。因此，您的问题 1 适合，但其他问题并不适合 SO...

# ios - iphone错误的PJSIP构建

> ID：12148218
> 
> 赞同：2
> 
> 时间：2012-08-27T19:20:09.137
> 
> 标签：ios, xcode, pjsip

我在这里学习教程：

`http://trac.pjsip.org/repos/wiki/Getting-Started/iPhone`

但是我在构建项目时总是遇到编译器错误。

基本上做了之后：

赶紧跑：

```
$ cd /path/to/your/pjsip/dir
$ ./configure-iphone
$ make dep && make clean && make 
```

这些命令似乎运行良好。我在项目的主文件夹中运行它们。然后我`ipjsua.xcodeproj`使用 Xcode打开`pjproject/pjsip-apps/src/ipjsua`并构建项目。

我得到：

```
ld: library not found for -lgsmcodec-arm-apple-darwin9
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

在我也收到不同的库链接器错误之前。

任何人都可以发布一个很好的教程吗？

# installation - 松鼠sql客户端设置文件夹位置

> ID：12148222
> 
> 赞同：16
> 
> 时间：2012-08-27T19:20:32.360
> 
> 标签：installation, squirrel-sql

我在 Windows 7 64 位机器上安装了 squirrel 客户端 3.4.0。

我看到一个松鼠客户端设置文件夹

> “.squirrel-sql”

创建于：

> C:\用户\阿尤斯曼\

有什么方法可以指定文件夹位置在我的松鼠安装位置，即

> “C:\tools\dumps\Squirrel-3.4.0”

地点？

我想这样做的原因是让我的松鼠在机器之间轻松移动；我可以只转储应用程序，我将准备好在任何机器上运行。

还有没有安装的 Squirrel-sql 发行版；而只是一个简单的 zip 文件，我可以解压缩到任何位置并开始工作？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-28T06:18:36.703

**关于 SQuirreL 的本地设置目录：**

SQuirrel SQL 是一个用 Java 编写的应用程序，它使用 Java 系统属性`user.home`来存储本地配置文件。默认情况下，此 Java 属性指向用户的主目录。您可以通过以下步骤进行更改：

在文本编辑器中打开 squirrel-sql.bat 并导航到文件末尾。最后一行应该以“start”SQuirreL SQL Client”开头——你必须更改这一行。`-Duser.home=PathToStoreTheSquirrelConfigDir`在 -Xmx 参数之后添加并确保新参数与其他参数用空格分隔。

这里有一个例子：

```
 -Xmx256m -Duser.home=C:/temp -Dsun.java2d.noddraw=true 
```

请注意，我使用的是斜杠而不是反斜杠！

现在您可以将现有的 .squirrel-sql 目录移动到新位置。例如`C:\temp\.squirrel-sql`

现在，如果您启动 SQuirreL SQL，它将使用新的存储位置。您可以在 SQuirrel 的全局属性中验证这一点（请参阅 SQuirreL 路径部分）

**关于 SQuirreL 的安装程序版本：**

SQuirreL SQL 还提供纯 zip 而不是安装程序版本。 [这是最新稳定版本的链接](http://sourceforge.net/projects/squirrel-sql/files/1-stable/3.4.0-plainzip/)

SQuirreL 提供 3 个包（基本包、标准包、可选包）。它们之间的区别在于打包的插件。我使用可选包 - 但标准包也可以。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-02-21T06:49:01.257

您可以使用 Squirrel-Parameter `--user-settings-dir`，但`-Duser.home`必须使用实际的 Squirrel-Settings-Directory 取消链接另一个答案，例如包含所有 xml-Settings 文件以及文件夹日志和插件的那个。

您可以直接在 .jar / main-class 上使用该参数，也可以在`squirrel-sql.bat`or`squirrel-sql.sh`文件上使用该参数，因此您无需编辑这些参数。

例子：

```
C:\dev\squirrel-sql\squirrel-sql-3.9.0\squirrel-sql.bat --user-settings-dir=C:\dev\squirrel-sql\squirrel-sql-settings 
```

这是来自松鼠手册，奇怪的是，我找不到它的在线资源（只有一个过时的），但是在松鼠安装文件夹中，例如`squirrel-sql-3.9.0/doc/quick_start.html`

# perl - 如何从 CPAN 中删除模块？

> ID：12148224
> 
> 赞同：13
> 
> 时间：2012-08-27T19:20:51.740
> 
> 标签：perl, module, cpan

几年前，我向 CPAN 上传了一个模块，该模块可能对任何人都没有用或没有用过。它解决的问题很简单，没有很好地解决，代码让我尴尬。

我怎样才能删除它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-27T19:40:12.993

登录到您的[PAUSE](https://pause.perl.org/)帐户，然后有一个菜单项可以删除您的文件。这些文件将被安排在 3 天后删除（让您改变主意），并且可能在此之后的另一天将更改传播到所有 CPAN 镜像。

按照设计，这不会从[BackPAN](http://backpan.perl.org/)中删除您的文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T12:31:48.503

*2021 年更新*2015 年左右的某个时候，PAUSE 改变了他们管理元数据的方式，不跟踪不是从发布本身派生的元数据。这些选项几年前已经从 PAUSE 界面中消失了（尽管我无法通过查看提交消息来确定它）。

这不像大多数人真的做过任何事情。标记“可以删除”并不意味着它会被删除。

除了删除您仍然可以执行的所有文件之外，如果您需要额外的帮助，您可以写信给管理员。

* * *

[您可以通过在 PAUSE 中将](https://pause.perl.org/pause/authenquery?ACTION=delete_files)文件标记为删除来从 CPAN 中删除文件。这只会将它们从 PAUSE 维护的主存储库中删除。它不会向宇宙发送信号以删除所有已创建的副本。

[如果您已经在模块列表中注册了它，您可以通过编辑模块元数据](https://pause.perl.org/pause/authenquery?ACTION=edit_mod)将其生命周期设置为“可以从数据库中删除” 。这不会立即删除它，但可以在下一次 PAUSE 执行数据库清理时将其删除。

这不会使代码从世界上消失。它不会出现在主 CPAN 服务器上，但它仍然可以出现在镜像站点和[BackPAN](http://backpan.cpan.org)中。

但是，不要对糟糕的代码感到绝望。每个人在 CPAN 的某个地方都有令人尴尬的代码。即使代码不完整或有错误，对于其他有相关问题的人来说，它也可能是一个很好的起点。

我建议您将其保留在 CPAN 上，但将主要维护者更改为 ADOPTME，这是我们用于失去维护者的模块的 PAUSE ID。如果您在模块列表中注册了它，您还可以通过[编辑模块元数据](https://pause.perl.org/pause/authenquery?ACTION=edit_mod)在支持级别下将其标记为“已放弃” 。

# java - 将 java 项目（我在其中使用 JLayer 1.0.1 播放 mp3）转换为可运行的 jar 文件

> ID：12148225
> 
> 赞同：3
> 
> 时间：2012-08-27T19:20:56.023
> 
> 标签：java, swing, audio, jlayer

我构建了一个 java 项目，并使用（JLayer 1.0.1）播放 mp3 音频。当我用 eclipce 测试我的项目时，我发现它可以 100% 正常工作，并且 JLayer 1.0.1 库可以有效地播放我的 mp3 文件。但是当我将它转换为可运行的 jar 文件时，它可以与**NO SOUND OR AUDIO**一起使用。看来我的程序无法访问 Jlayer 1.0.1 库。所以现在，我需要你的帮助来解决这个问题。 *非常感谢*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:15:26.223

这可能是 JRE 问题（Eclipse 使用的 JRE 可能与您的系统使用的 JRE 不同），也可能是打包问题。

使用 Eclipse 打包时，请确保将所有库与类打包在一起。为此，请选择“将所需库提取到生成的 JAR”选项。

另一种选择是运行您的 JAR 设置类路径：（`java -cp yourjar.jar;yourlib1.jar;yourlib2.jar com.your.package.YourMainClass`请注意，';' 是平台相关的）而不是`java -jar yourjar.jar`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T20:15:31.167

您可以执行以下操作来测试您的应用程序：将项目导出为常规 jar，并将其与 JLayer.jar 和其他依赖项一起复制到目录中。然后，创建一个批处理文件（在 Windows 上为 .bat，在 Linux 上为 .sh），其中包含如下内容：

```
java -cp yourjar.jar;JLayer.jar;other_jars FullPathToYourClass 
```

`FullPathToYourClass`类似的东西在哪里`com.something.else.ClassName` 还要注意Linux上的分隔符是：

一旦你看到它工作，你就可以开始做一个构建脚本来自动完成上述工作。我建议您为此构建一个 Ant build.xml 文件。

# jquery - 可变高度侧边栏滚动跟随

> ID：12148226
> 
> 赞同：0
> 
> 时间：2012-08-27T19:20:56.377
> 
> 标签：jquery, scroll, sidebar, cart

在我正在开发的网站上，我正在使用滚动关注来滚动带有页面的购物车/项目菜单。我正在使用此代码 $(function() {

```
var $sidebar   = $('.sidebar-scroll'),
    $window    = $(window),
    $footer    = $('.footer'), // use your footer ID here
    offset     = $sidebar.offset(),
    foffset    = $footer.offset(),
    threshold  = foffset.top - $sidebar.height(); // may need to tweak
    topPadding = 200;

$window.scroll(function() {
    if ($window.scrollTop() > threshold) {
        $sidebar.stop().animate({
            marginTop: threshold
        });
    } else if ($window.scrollTop() > offset.top) {
        $sidebar.stop().animate({
            marginTop: $window.scrollTop() - offset.top + topPadding
        });
    } else {
        $sidebar.stop().animate({
            marginTop: 0
        });
    }
});

}); 
```

问题是因为我的侧边栏是一个菜单，它的高度是可变的，这取决于用户选择添加到购物车的内容。如何修改此代码，以便我的菜单不会越过页脚，但仍可以相应地调整大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T13:57:34.847

我通过使用**内容**作为高度参考而不是页脚来重新编写您的代码。

工作演示：http: [//jsfiddle.net/tF8Dj/](http://jsfiddle.net/tF8Dj/)

```
var $sidebar   = $('aside'),
    $content   = $('#content');

if ($sidebar.length > 0 && $content.length > 0) {
    var $window    = $(window),
        offset     = $sidebar.offset(),
        timer;

    $window.scroll(function() {
        clearTimeout(timer);
        timer = setTimeout(function() {
            if ($content.height() > $sidebar.height()) {
                var new_margin = $window.scrollTop() - offset.top;
                if ($window.scrollTop() > offset.top && ($sidebar.height()+new_margin) <= $content.height()) {
                    // Following the scroll...
                    $sidebar.stop().animate({ marginTop: new_margin });
                } else if (($sidebar.height()+new_margin) > $content.height()) {
                    // Reached the bottom...
                    $sidebar.stop().animate({ marginTop: $content.height()-$sidebar.height() });
                } else if ($window.scrollTop() <= offset.top) {
                    // Initial position...
                    $sidebar.stop().animate({ marginTop: 0 });
                }
            }
        }, 100); 
    });
} 
```

该示例假设您有一个侧边栏和内容。计时器是为性能而存在的。

希望这对你有用！

编辑：我还找到了一个带有 jquery 插件的[Tuts+ 教程。](http://net.tutsplus.com/tutorials/javascript-ajax/spotlight-constrained-stickies-with-jquer/)

# php - 如何获得使用 unlink() 的权限？

> ID：12148229
> 
> 赞同：14
> 
> 时间：2012-08-27T19:21:04.023
> 
> 标签：php

我创建了一个站点，它具有上传文件的功能，并且该文件被上传到服务器

我只是 php 的新手，我下载了 xampp，然后运行我在本地机器上创建的这个站点。我的网站是这样的，您上传一个文件，然后该文件将上传到服务器，但是当我尝试 unlink() 时，因为当我尝试将文件名删除到数据库时，我也想删除服务器上的该图片，而是我收到一个错误，上面写着**"Permission denied"**。

**问题：** 如何获得使用 unlink(); 的权限？

我只使用 xampp 在我的本地机器上运行它

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-27T19:24:52.233

发生权限被拒绝错误是因为您尝试删除文件而没有足够/正确的权限来执行此操作。

为此，您必须使用超级用户帐户或者是上传文件的同一用户。

您可以从命令行转到该目录并检查为该文件设置的权限。

最简单的解决方案是以管理员/root 身份登录并删除文件。

这是另一个解决方法：

```
// define if we under Windows
$tmp = dirname(__FILE__);
if (strpos($tmp, '/', 0)!==false) {
  define('WINDOWS_SERVER', false);
  } else {
  define('WINDOWS_SERVER', true);
}
  $deleteError = 0;
  if (!WINDOWS_SERVER) {
    if (!unlink($fileName)) {
      $deleteError = 1;
    }
  } else {
    $lines = array();
    exec("DEL /F/Q \"$fileName\"", $lines, $deleteError);
  }
  if ($deleteError) {
    echo 'file delete error';
  } 
```

还有更多：[PHP Manual, unlink(), Post 106952](http://www.php.net/manual/en/function.unlink.php#106952)

我建议，总是首先检查 PHP 手册（如果您的问题涉及 PHP），只需转到您遇到问题的功能页面，然后单击`CTRL+F`搜索浏览器并输入，例如，，`Windows`因此，在您的情况下，您会找到至少 7 个相关帖子或非常接近您正在寻找的帖子。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-27T19:28:04.437

阅读此网址

[如何使用 Unlink() 函数](https://stackoverflow.com/questions/11463581/unlink-function)

我[在函数 unlink() 的注释中找到了这些信息](http://br.php.net/manual/pt_BR/function.unlink.php)

在 Windows 系统和 Apache 下，拒绝访问文件是取消链接文件的常见错误。要删除文件，您必须更改文件的所有者。一个例子：

```
<?php 

chown($TempDirectory."/".$FileName,666); //Insert an Invalid UserId to set to Nobody Owern; 666 is my standard for "Nobody" 
unlink($TempDirectory."/".$FileName); 

?> 
```

所以尝试这样的事情：

```
$Path = './doc/stuffs/sample.docx';

chown($Path, 666);

if ( unlink($Path) )
    echo "success";
else
    echo "fail"; 
```

**编辑 1**

尝试在路径中使用它：

```
$Path = '.'.DIRECTORY_SEPARATOR.'doc'.DIRECTORY_SEPARATOR.'stuffs'.DIRECTORY_SEPARATOR.'sample.docx'; 
```

# .net - 在应用程序中添加自定义用户操作逻辑日志的最佳方法

> ID：12148230
> 
> 赞同：1
> 
> 时间：2012-08-27T19:21:08.720
> 
> 标签：.net, sql-server, logging

我即将启动一个应用程序，我必须在其中添加“自定义用户操作逻辑日志”。

例如，如果用户访问“员工模块”，然后转到“个人信息”并且他更改了名字，那么我应该在 dd/mm/yyyy 在 hh:mm:ss 记录用户更改了个人信息

如果用户向员工添加了新的依赖，那么我应该记录用户添加了新的依赖操作，依此类推。

所以基本上它不会成为修改了哪些字段、原始值等的审计跟踪......它是一个**基本的操作日志**。并且动作将被定制。所以并不是所有的动作都会被记录下来。

有谁知道哪种数据库结构足够灵活，可以为整个应用程序和模块做到这一点，以及使用哪种日志框架：log4net 或 Microsoft 的企业库？

非常感谢您的帮助！

# .net - 无法在 Visual Studio 2012 的 .NET 4.0 应用程序上使用 ClickOnce 发布

> ID：12148234
> 
> 赞同：11
> 
> 时间：2012-08-27T19:21:29.450
> 
> 标签：.net, visual-studio, .net-4.0, clickonce, visual-studio-2012

我安装了 Visual Studio 2012 并发布了我们的一个应用程序，它针对 .NET 4.0 框架。由于这些机器上的设置，我们目前无法定位 4.5。我们还使用“从与我的应用程序相同的位置下载先决条件”功能。

从 Visual Studio 2012 进行部署时，出现以下错误：

> 要在先决条件对话框中启用“从与我的应用程序相同的位置下载先决条件”，您必须将项目“Microsoft .NET Framework 4（x86 和 x64）”的文件“DotNetFX40\dotNetFx40_Full_x86_x64.exe”下载到本地计算机。有关详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=239883](http://go.microsoft.com/fwlink/?LinkId=239883)。

如果您转到该链接，它会告诉您导航到 Package.xml 文件，并找到实际先决条件的链接。就我而言，它应该转到[http://go.microsoft.com/fwlink/?linkid=182805](http://go.microsoft.com/fwlink/?linkid=182805)。它使用该链接下载了一个名为 dotNetFx40_Full_setup.exe 的包。我把它放在`/Packages/DotNetFX40`文件夹里。

当尝试从 Visual Studio 2012 再次发布时，我遇到了同样的错误。它似乎不喜欢这个文件。

如果我现在使用 Visual Studio 2010 将相同的应用程序发布到相同的位置，它仍然可以正常工作。

我怎样才能让它与 Visual Studio 2012 一起工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T15:23:00.610

我遇到了同样的问题。

将下载到 C:\Program Files\Microsoft SDKs\Windows\v8.0A\Bootstrapper\Packages\DotNetFX40 目录的 dotNetFx40_Full_setup.exe 文件重命名为 dotNetFx40_Full_x86_x64.exe。

执行此操作后，我能够成功发布我的应用程序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-15T17:51:32.730

我相信您可以从以下位置下载正确的安装程序**dotNetFx40_Full_x86_x64.exe**：

[http://www.microsoft.com/en-us/download/details.aspx?id=17718](http://www.microsoft.com/en-us/download/details.aspx?id=17718)

（而不是按照 Brian 的建议重命名 .NET Framework 4 安装程序）。将其放在`C:\Program Files\Microsoft SDKs\Windows\v8.0A\Bootstrapper\Packages\DotNetFX40`目录中。我在 .NET 客户端配置文件设置中遇到了[类似的问题。](https://stackoverflow.com/questions/15436991/in-visual-studio-2012-where-does-clickonce-publish-expect-to-find-the-net-4-c/15438677#15438677)在我的情况下，按照 Microsoft MSDN 帮助，我误入了错误的安装程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-14T20:09:30.767

我有一个类似的问题。

[MSDN 文档http://msdn.microsoft.com/en-us/library/ms165429(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/ms165429%28v=vs.110%29.aspx)中指定的注册表项指向目录 c:\Program Files (x86)\Microsoft SDKs\Windows \v7.0A\Bootstrapper\ 作为不正确的包目录。

Visual Studio 2012 在 C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\Bootstrapper\Packages 目录中寻找包。乍一看，包似乎在包目录中，但只有包文件夹在那里，每个包文件夹中都缺少可执行文件。例如，DotNetFX40Client 子目录位于 packages 文件夹中，但 DotNetFX40Client 文件夹中缺少文件 dotNetFx40_Client_x86_x64.exe。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-16T14:20:44.150

Visual Studio 2012 破坏了 ClickOnce 安装程序，如果您甚至让 Visual Studio 2012 更新您的应用程序而不告诉您它不再受支持的话。

如果您设法像以前一样升级您的解决方案，您会发现 ClickOnce 实际上发布得很好。只是先决条件无法安装，因此导致安装失败。如果您仍然拥有 Visual Studio 2012 从未接触过的代码的 Visual Studio 2010 副本，即使您通过源代码管理使用 Visual Studio 2012 编写的代码更新代码，您仍然可以通过该副本进行构建。只要该构建保持不变，它就会继续工作，但如果 Visual Studio 2012 专门获得了该副本上的任何 ClickOnce 文件，它将无法找到依赖项。

我决定利用它仍然发布和构建一个自定义工具的事实，只要它可以构建，它就可以安装和运行任何 ClickOnce 应用程序。它可以安装到任何位置，根据需要提升，安装任何列出的先决条件（开发人员控制），并创建桌面和开始菜单条目，然后运行更新程序，像 ClickOnce 那样执行智能更新（只更新必要的文件以避免过多的带宽使用）。我还在调试环境中内置了更新源选择器。

这只需要将两个 EXE 文件放入发布文件夹，然后从第三方安装程序安装，而不是 ClickOnce 安装程序。这给了我更多的功能（我可以让它做我想做的事，多线程安装程序/更新程序，开发人员回滚的降级功能）以及更改更新程序（主题）或安装完成方式的自由。

对于那些看到我的执行顺序是“假 exe 快捷方式”---> 更新程序 ---> exe 的人，您会注意到这实际上会破坏固定，因为您会固定更新程序，而不是 EXE 文件，所以我使应用程序仅使用“/updated”参数运行，如果不存在，应用程序本身必须运行同一文件夹中存在的更新程序 EXE 文件（仅显示是否有要更新的文件），然后更新并使用正确的命令参数再次启动原始 EXE 文件。固定现在工作，因为您只打开 EXE 文件。（这也提供了通过将命令参数放入 TargetPath 来跳过更新的能力，并且最重要的是最终用户一无所知，因为它是后台进度并且安装程序是专业的和品牌的）。

# google-chrome - 是否有适用于 Firefox 的 Google Chrome Frame 版本？

> ID：12148237
> 
> 赞同：4
> 
> 时间：2012-08-27T19:21:35.520
> 
> 标签：google-chrome

有没有类似 Firefox 的 Google Chrome Frame 的东西？（这将允许您在 FireFox 中使用 Chrome 渲染引擎？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:55:06.217

我唯一看到的是使用[ETab 在 IE Explorer 中托管 Google Chrome Frame 的级联序列。](http://www.youtube.com/watch?v=7Ir2yA10OGs)

# eclipse - GMF 显示图示例

> ID：12148243
> 
> 赞同：1
> 
> 时间：2012-08-27T19:21:48.623
> 
> 标签：eclipse, uml, eclipse-emf, eclipse-emf-ecore, eclipse-gmf

如何在 Eclipse 中的视图中显示 GMF 图，文件格式为“*.ecorediag”？图表不应该是可编辑的。

是否有一个简单的示例视图可以从“/home/diagrams/test.ecorediag”加载图表

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T23:59:36.717

GMF 图（包括 ecorediag）在“org.eclipse.gmf.runtime.diagram.ui.parts.DiagramGraphicalViewer”的帮助下在编辑器上呈现。

因此，完成这项工作的最少代码

```
DiagramGraphicalViewer viewer = new DiagramGraphicalViewer();
viewer.createControl(composite);

RootEditPart root = EditPartService.getInstance().createRootEditPart(
                diagram);
viewer.setRootEditPart(root);
viewer.setEditPartFactory(new EcoreEditPartProvider());

viewer.getControl().setBackground(ColorConstants.listBackground);

viewer.setContents(diagram); 
```

# mysql - mysql：添加具有重复主键的整数值

> ID：12148244
> 
> 赞同：1
> 
> 时间：2012-08-27T19:21:48.410
> 
> 标签：mysql

我想在我管理的数据库的表中重新分配一些值。

```
Firstname(varchar), Lastname(varchar), Date(date), Icecream_consumed(int) 
```

其中 Firstname、Lastname 和 Date 的组合构成此表的主键。更改此表的结构不是一种选择。

数据库中共有 80 个 Firstname 和 LastName 的唯一组合，但我想将该数字降低到 5，并将 Icecream_consumed 总数较小的一些记录添加到总数最高的记录中。这样只有前 5 个 FirstName 和 LastName 组合具有所有 Icecream_consumed 计数。

例如，如果我执行查询：

```
 SELECT Firstname, Lastname, SUM(Icecream_consumed) 
    FROM table_name 
GROUP BY Firstname, Lastname 
ORDER BY SUM(Icecream_consumed); 
```

我希望它只有 5 个结果，而不是 80 个。如何在不手动更新每条记录的情况下修改表中的记录以反映这一点？一个简单的更新将不起作用，因为它将插入具有相同主键的现有记录存在的位置。

编辑：我注意到列 ID 有点模棱两可。所以我从这个例子中删除了它。

EDIT2：这是一个例子：

现存的：

**名字，姓氏，总和（Icecream_consumed）**

```
John  Doe   1500
Joe   Doe   1400
Alex  Foo   1111
John  Foo   1000
Ben   Foo    999
Sue   Cool   500
Bill  Smith  200
Ben   Smith  150 
```

我想更改表格，以便与 sue、cool、bill smith 和 ben smith 关联的 sum(icecream_consumed) 值与 john doe 关联，这样只有 5 个结果可见。但是，如果我尝试将所有记录更新为 sue cool 成为 john doe，则会与主键发生冲突，因为它们都可能具有相同日期的 icecream_consumed 值。结果可能如下所示：

```
John  Doe   2000
Joe   Doe   1600
Alex  Foo   1261
John  Foo   1000
Ben   Foo    999 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:59:19.093

SQL Fiddle 上的工作示例：[http ://sqlfiddle.com/#!2/0e8ab/1](http://sqlfiddle.com/#!2/0e8ab/1)

因为如果子选择与更新中的子选择是同一个表，MySql 无法在更新语句中运行子选择，因此您需要首先将数据临时复制到另一个表中 - 所以**当数据仍在进入数据库时​​不要运行**它不是原子操作。您需要先关闭所有使用数据库的应用程序。

```
-- Create a copy of the data 
CREATE TABLE table_name_copy SELECT * FROM table_name;

-- Update the rows with the most Icecream_consumed to have the total 
UPDATE table_name t1 SET t1.Icecream_consumed = (
    SELECT SUM(t2.Icecream_consumed) 
    FROM table_name_copy t2 
    WHERE t2.Firstname = t1.FirstName AND t2.Lastname = t1.Lastname
)
WHERE id = (
    SELECT id 
    FROM table_name_copy t2 
    WHERE t2.Firstname = t1.FirstName AND t2.Lastname = t1.Lastname
    ORDER BY Icecream_consumed DESC LIMIT 1
);

-- Delete the other rows that don't have the new totalled Icecream_consumed 
DELETE FROM table_name
WHERE id != (
    SELECT t2.id 
    FROM table_name_copy t2 
    WHERE t2.Firstname = table_name.FirstName AND t2.Lastname = table_name.Lastname
    ORDER BY Icecream_consumed DESC LIMIT 1
);

-- Remove the copied table
DROP TABLE table_name_copy; 
```

# objective-c - 将精灵移动到触摸点，触摸时间越长，速度越快

> ID：12148245
> 
> 赞同：0
> 
> 时间：2012-08-27T19:21:49.653
> 
> 标签：objective-c, cocos2d-iphone, physics-engine

如何将精灵移动到 x 轴上的接触点，增加速度.x。触摸的时间越长速度越快，那么当它进入一定范围的触摸点或用户松开手指时，再放慢速度？

我有一个带有速度值的播放器类设置，它在更新方法中更新，但不确定如何在触摸方法中获得所需的行为？

干杯，

刘易斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:51:21.620

这应该让你进入球场（实例变量并将其添加为可触摸将在 init 中，让我知道你是否也需要那个片段）：

```
- (BOOL) ccTouchBegan: (UITouch *) touch
            withEvent: (UIEvent *) event
{
    _touchBeganAt = [self convertTouchToNodeSpace:touch];
    _velocityChangeSpeed = 1;
}

 - (void) ccTouchEnded: (UITouch *) touch
            withEvent: (UIEvent *) event
{
    _velocityChangeSpeed = -1;
}

- (void) update:(ccTime)delta
{
    velocityThreshold = 1; //? You can tune this
    distanceThreshold = 1; //? Same

    _sprite.velocity += _velocityChangeSpeed;

    //So it comes to a complete stop, as opposed to moving backwards
    if(_sprite.velocity < velocityThreshold)
        _velocityChangeSpeed = 0;

    float distanceFromTouchedPoint = ABS(_sprite.position.x - _touchBeganAt.x);
    if(distanceFromTouchedPoint < distanceThreshold)
        _velocity = 0;
} 
```

# c - 作业 - C 位拼图 - 使用 C 位操作执行 %（无循环、条件、函数调用等）

> ID：12148246
> 
> 赞同：4
> 
> 时间：2012-08-27T19:22:06.753
> 
> 标签：c, bit-manipulation

我完全被困在如何做这个家庭作业问题上，并寻找一两个提示让我继续前进。我仅限于 20 次操作（`=`不计入这 20 次）。

我应该填写一个看起来像这样的函数：

```
 /* Supposed to do x%(2^n).
       For example: for x = 15 and n = 2, the result would be 3.

       Additionally, if positive overflow occurs, the result should be the
       maximum positive number, and if negative overflow occurs, the result
       should be the most negative number.
     */
    int remainder_power_of_2(int x, int n){

      int twoToN = 1 << n;

      /* Magic...? How can I do this without looping? We are assuming it is a
         32 bit machine, and we can't use constants bigger than 8 bits
         (0xFF is valid for example).
         However, I can make a 32 bit number by ORing together a bunch of stuff.
         Valid operations are: << >> + ~ ! | & ^
       */

      return theAnswer;
    } 
```

我在想也许我可以`twoToN`向左移动......直到我以某种方式检查（没有if / else）它比x大，然后向右移动一次......然后用x异或它......和重复？但我只有20个手术！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:29:30.693

**提示：**在十进制系统中，以 10 的幂为模，您只需保留最后几位数字并将其他数字设为空即可。例如 12345 % 100 = 00045 = 45。好吧，在计算机中数字是二进制的。所以你必须清空二进制数字（位）。因此，请查看各种位操作运算符 ( `&`, `|`, `^`) 来执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T19:34:32.920

由于二进制是基数 2，余数 mod 2^N 由值的最右边位精确表示。例如，考虑以下 32 位整数：

```
00000000001101001101000110010101 
```

这具有 3461525 的二进制补码值。余数 mod 2 恰好是最后一位 (1)。余数 mod 4 (2^2) 正好是最后 2 位 (01)。余数 mod 8 (2^3) 正好是最后 3 位 (101)。通常，余数 mod 2^N 正好是最后 N 位。

简而言之，您需要能够获取您的输入数字，并以某种方式对其进行屏蔽以仅获取最后几位。

提示：假设您使用的是 mod 64。二进制中 64 的值是：

```
00000000000000000000000001000000 
```

您感兴趣的模数是最后 6 位。我将为您提供一系列可以将该数字转换为掩码的操作（但我不会告诉您它们是什么，您可以自己弄清楚它们：D）

```
00000000000000000000000001000000 // starting value
11111111111111111111111110111111 // ???
11111111111111111111111111000000 // ???
00000000000000000000000000111111 // the mask you need 
```

这些步骤中的每一个都等同于可以在 int 类型上执行的一个操作。你能弄清楚它们吗？你能看到如何简化我的步骤吗？:D

另一个提示：

```
00000000000000000000000001000000 //  64
11111111111111111111111111000000 // -64 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:11:24.217

因为你的除数总是二的幂，所以很容易。

```
uint32_t remainder(uint32_t number, uint32_t power)
{
    power = 1 << power;
    return (number & (power - 1));
} 
```

假设您输入数字为 5，除数为 2

```
`000000000000000000000000000000101`数字
和
`00000000000000000000000000000001` 除数 - 1
=
`000000000000000000000000000000001` 余数（我们所期望的）

```

假设您输入数字为 7，除数为 4

```
`00000000000000000000000000000111`号码
和
`00000000000000000000000000000011` 除数 - 1
=
`00000000000000000000000000000011` 余数（我们所期望的）

```

这只适用于除数是 2 的幂（除数 = 1 除外），因此请谨慎使用。

# php - ReferenceMany 对象的按需加载

> ID：12148248
> 
> 赞同：3
> 
> 时间：2012-08-27T19:22:29.863
> 
> 标签：php, mongodb, doctrine, doctrine-orm, odm

我是 ORM 的新手，但已经对其可能性印象深刻。

在设计类似 Facebook 的消息系统（允许多用户聊天的消息线程）时，我遇到了一个我不知道如何解决的问题。

在我用 DocumentManager::find(...) 加载 MessageThread 后，我得到了包含所有消息的整个 MessageThread 对象。由于内存限制，这可能不是一个好主意。

所以我的问题是，是否有一种方法，如何按需动态加载消息，所以我得到 MessageThread 对象，但是在访问消息属性时，它们可能会以 50 条消息的形式动态加载？

谢谢你。

这些是 User、Message 和 MessageThread 类。

使用 Doctrine MongoDB ODM

```
class User {
    /** @Id */
    protected $id;  
}

class Message
{
    /** @Id */
    protected $id;

    /** @ReferenceOne(targetDocument="User") */
    protected $sender;

    /** @String */
    protected $body;

    /** @Date */
    protected $sent;

    /** @EmbedMany */
    protected $read;
}

class MessageThread
{
     /** @Id */
     protected $id;

     ...

     /** @ReferenceMany(targetDocument="User") */
     protected $participants;

     //Maybe EmbedMany is better in this case
     /**
     * @ReferenceMany(
     *      targetDocument="Message",
     * )
     */
     protected $messages;

     ...
} 
```

# java - 我在 Java 中保存的文本文件出现错误

> ID：12148256
> 
> 赞同：3
> 
> 时间：2012-08-27T19:23:03.543
> 
> 标签：java, file, text, stream, writer

我正在创建一个保存第一个 X 素数的程序，但是当我将其保存`ArrayList`到文本文件时，列表完全错误。这是我的代码：

```
import java.util.Scanner;
public class Class1
{
  // This method tests whether a given number is prime or not.
   public boolean isPrime ( int num )
 {
boolean prime = true;
int limit = (int) Math.sqrt ( num );  

for ( int i = 2; i <= limit; i++ )
{
  if ( num % i == 0 )
  {
    prime = false;
break;
  }
}

return prime;
}

public static void main ( String[] args )
 {
  Class1 ob1=new Class1();
System.out.println("Where do you want to stop?");
Scanner scan = new Scanner(System.in);
int y = scan.nextInt();
for ( int i = 2; i <= y; i++ )
{
  if ( ob1.isPrime ( i ) )
System.out.println ( i );
  }
 }
 }

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.Writer;
import java.util.ArrayList;
import java.util.List;

 public class Output {
    public static void main(String args[]) throws IOException {
 Class1 obj = new Class1();OutputStream outputstream = new FileOutputStream("write.txt");
 Writer writer1 = new OutputStreamWriter(outputstream);

 try{

 int max =100;
  List<Integer> record = new ArrayList<Integer>(max);

  // Going write in this file

  for ( int i = 2; i <= max; i++ )
  {
   if ( obj.isPrime ( i ) )
    System.out.println ( i );
    record.add(i);

    } 
   for(Integer str: record){
   writer1.write(str);
    }

    }catch(IOException e){

    }finally{writer1.close();}
    }

   } 
```

这就是文本文件的样子：

```
!"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\ 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-27T19:25:06.090

您正在调用`Writer.write(int)`，它将整数解释为 Unicode 代码点。用于 `str.toString()`将参数强制转换为字符串。在你这样做之后，你可能也会希望有一些换行符。我建议将所有内容包装在 a 中`PrintWriter`并`println`在其上使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:30:24.937

有两个问题。一是上面 Marko 指出的代码点问题。

另一个是

```
if ( obj.isPrime ( i ) )
    System.out.println ( i );
    record.add(i); 
```

您的 if 语句仅涵盖 system.out.println - 它也不涵盖 record.add 因为它没有括号。

考虑一下：

```
if ( obj.isPrime ( i ) ) { // notice the curly bracket
    System.out.println ( i );
    record.add(i);
} // notice the curly bracket 
```

# ruby-on-rails - Rails 与非标准外键正确关联

> ID：12148259
> 
> 赞同：0
> 
> 时间：2012-08-27T19:23:43.090
> 
> 标签：ruby-on-rails, associations

我有两张桌子：

```
Languages: id, name, abbreviation
Post: id, title, language 
```

Post.language 连接到 Language.abbreviation。

如何设置模型以便正确调用：

```
@post.language.name 
```

并收到它所连接的语言的名称？

我开始的是：

```
Post> 
  belongs_to :language

Language>
  has_many :posts, :foreign_key => "abbreviation" 
```

但这似乎没有正确连接。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:39:02.857

我会将 language_id 存储在 Post 模型中，而不是缩写。您可以在表单中连接缩写以显示缩写，但将 language_id 存储在数据库中。

# mysql - 为什么 MySQLDump 在导入/恢复文件时会向终端写入数据

> ID：12148264
> 
> 赞同：1
> 
> 时间：2012-08-27T19:24:17.940
> 
> 标签：mysql, mysqldump

我正在尝试使用以下命令（在 Windows 上，版本 5.xx）恢复/导入 MySQLdump 文件：

```
mysqldump -u root -p --all-databases < myfile.sql 
```

然而，在处理过程中，命令提示符窗口开始疯狂地发出哔哔声。是否可以删除 mysqldump 命令的输出（我假设是导致这种声音发生的原因）？有问题的文件略大于 200MB。

我查看了标志，似乎只有 --verbose 可以帮助我。但是，它似乎无法在命令提示符窗口中停止输出（但添加更多输出？）。

**编辑#1**

已删除的一个答案建议通过管道输出 /dev/null。我在 Windows 上，我不知道什么是等价的。如果我将它通过管道传输到一个实际文件，我实际上几乎是将我的转储复制到另一个文件？**为什么还原首先输出到提示符？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T19:26:50.727

我想你真的打算跑

```
mysqldump -u root -p --all-databases > myfile.sql 
```

（您的重定向是错误的方式）

mysqldump 写入文件。要从该文件导入，您将使用

```
mysql -u root -p < myfile.sql 
```

# python - “BlogPostResource”对象没有“请求”属性

> ID：12148265
> 
> 赞同：1
> 
> 时间：2012-08-27T19:24:34.823
> 
> 标签：python, django, django-rest-framework

我正在学习 Django REST Framework 并研究这个例子；

[http://django-rest-framework.org/examples/blogpost.html](http://django-rest-framework.org/examples/blogpost.html)

但是当我尝试打开时出现此错误`http://localhost:8000/blog-post/`

```
AttributeError at /blog-post/
'BlogPostResource' object has no attribute 'request'
Request Method: POST
Request URL:    http://localhost:8000/blog-post/
Django Version: 1.4.1
Exception Type: AttributeError
Exception Value:    
'BlogPostResource' object has no attribute 'request'
Exception Location: /Users/wolfiem/PycharmProjects/TestRestApi/TestApp/resources.py in url, line 16
Python Executable:  /System/Library/Frameworks/Python.framework/Versions/2.7/Resources/Python.app/Contents/MacOS/Python
Python Version: 2.7.2
Python Path:    
['/Users/wolfiem/PycharmProjects/TestRestApi',
 '/Library/Python/2.7/site-packages/pexpect-2.4-py2.7.egg',
 '/Library/Python/2.7/site-packages/pythondialog-2.7-py2.7.egg',
 '/Library/Python/2.7/site-packages/pymongo-2.2.1-py2.7-macosx-10.7-intel.egg',
 '/Library/Python/2.7/site-packages/riak-1.4.1-py2.7.egg',
 '/Library/Python/2.7/site-packages/pip-1.1-py2.7.egg',
 '/Library/Python/2.7/site-packages/MySQL_python-1.2.3-py2.7-macosx-10.8-intel.egg',
 '/usr/local/lib/python2.7/site-packages',
 '/opt/local/bin',
 '/Library/Python/2.7/site-packages',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/PyObjC'] 
```

这些是我的示例文件：

资源.py

```
from djangorestframework.resources import ModelResource
from djangorestframework.resources import reverse
from TestApp.models import BlogPost,Comment

class BlogPostResource(ModelResource):
    """
    A Blog Post has a *title* and *content*, and can be associated with zero or more comments.
    """
    model = BlogPost
    fields = ('created','title','slug','content','url','comments')
    ordering = ('-created',)

    def url(self, instance):
        return reverse('blog-post',
                        kwargs = {'key':instance.key},
                        request=self.request)

    def comments(self, instance):
        return reverse('comments',
                        kwargs = {'blogpost':instance.key},
                        request=self.request)

class CommentResource(ModelResource):
    """
    A Comment is associated with a given Blog Post and has a *username* and *comment*, and optionally a *rating*.
    """
    model = Comment
    fields = ('username','comment','created','rating','url','blogpost')
    ordering = ('-created',)

    def blogpost(self, instance):
        return reverse('blog-post',
                        kwargs={'key':instance.blogpost.key},
                        request=self.request) 
```

模型.py

```
from django.db import models
from django.template.defaultfilters import slugify
import uuid

def uuid_str():
    return str(uuid.uuid1())

# Create your models here.

RATING_CHOICES = ((0, 'Awful'),
    (1, 'Poor'),
    (2, 'OK'),
    (3, 'Good'),
    (4, 'Excellent'))

MAX_POSTS = 10

class BlogPost(models.Model):
    key = models.CharField(primary_key=True, max_length=64, default=uuid_str(), editable=False)
    title = models.CharField(max_length=128)
    content = models.TextField()
    created = models.DateTimeField(auto_now_add=True)
    slug = models.SlugField(editable=False,default='')

    def encode(self):
        return self.encode('utf8')

    def save(self, force_insert=False, force_update=False, using=None):
        """
        Save
        """
        self.slug = slugify(self.title)
        super(self.__class__,self).save()
        for obj in self.__class__.objects.order_by('-created')[MAX_POSTS:]:
            obj.delete()

class Comment(models.Model):
    blogpost = models.ForeignKey(BlogPost,editable=False,related_name='comments')
    username = models.CharField(max_length=128)
    comment = models.TextField()
    rating = models.IntegerField(blank=True,null=True,choices=RATING_CHOICES,help_text='How did you rate this post?')
    created = models.DateTimeField(auto_now_add=True) 
```

网址.py

```
from django.conf.urls import patterns, url
from djangorestframework.views import ListOrCreateModelView,InstanceModelView
from TestApp.resources import BlogPostResource,CommentResource

# Uncomment the next two lines to enable the admin:
# from django.contrib import admin
# admin.autodiscover()

urlpatterns = patterns('',
    # Examples:
    # url(r'^$', 'TestRestApi.views.home', name='home'),
    # url(r'^TestRestApi/', include('TestRestApi.foo.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
    # url(r'^admin/', include(admin.site.urls)),
#    url(r'^restframework', include('djangorestframework.urls', namespace='djangorestframework')),
    url(r'^$', ListOrCreateModelView.as_view(resource=BlogPostResource), name='blog-post-root'),
    url(r'^(?P<key>[^/]+)/$', InstanceModelView.as_view(resource=BlogPostResource), name='blog-post'),
    url(r'^(?P<blogpost>[^/]+)/comments/$',ListOrCreateModelView.as_view(resource=CommentResource), name='comments'),
    url(r'^(?P<blogpost>[^/]+)/comments/(?P<id>[^/]+)/$', InstanceModelView.as_view(resource=CommentResource)),
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T20:54:39.540

我发现了问题。我已经编辑了如下的行。

```
def url(self, instance): 
```

作为

```
def url(self,request,instance): 
```

# ios - AV Framework前置摄像头问题

> ID：12148266
> 
> 赞同：1
> 
> 时间：2012-08-27T19:24:42.477
> 
> 标签：ios, video, camera, avfoundation

您好我正在使用 AV 框架尝试访问前置摄像头...

这是我这样做的代码..

```
+ (AVCaptureDevice *)camera
{
 NSArray *devices = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];

for (AVCaptureDevice *device in devices) {

    if ([device position] == AVCaptureDevicePositionFront) {
        NSLog(@"Device Position is :%i",device.position);
        return device;

    }

}

return nil;
} 
```

NSLog 告诉我我在第二个位置，但是我屏幕上显示的视频仍然来自后面……有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:32:29.007

```
- (AVCaptureDevice *)frontFacingCameraIfAvailable
{
    NSArray *videoDevices = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];

        AVCaptureDevice *captureDevice = nil;

for (AVCaptureDevice *device in videoDevices) 
{
   if (device.position == AVCaptureDevicePositionFron 
      {
            captureDevice = device;
            break;
        }
    }
//  couldn't find one on the front, so just get the default video device.
    if (!captureDevice)
    {
        captureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    }
    return captureDevice;
}

AVCaptureDevice *captureDevice = nil;  

if(frontCamera == true){  
    captureDevice = [self frontFacingCameraIfAvailable];  
}

captureInput = [AVCaptureDeviceInput   
            deviceInputWithDevice:captureDevice   
            error:nil]; 
```

# javascript - 当您有“包含”的新数据时，更新/刷新 Page-Mod 的最佳方法是什么？

> ID：12148271
> 
> 赞同：2
> 
> 时间：2012-08-27T19:25:15.650
> 
> 标签：javascript, arrays, widget, firefox-addon, firefox-addon-sdk

我有一个`page-mod`使用数组作为包含字段的数据。我希望能够使用 来添加/删除数组中的数据`splice`，并进行`page-mod`刷新。这是我的代码：

```
//APIs:
var store = require("simple-storage");
var pageMod = require("page-mod");
var self = require("self");

//Array for Include:
store.storage.sites = ["*.example.com","*.google.com","*.org"];

//Page-mod code:
myPageMod = pageMod.PageMod({
  include: store.storage.sites,
  contentScriptWhen: 'start',
  contentScriptFile: [self.data.url("nicEdit-latest.js"),
                      self.data.url("pagedit.js")]
});

//Code to change array
function deleteItem(index) {
  store.storage.sites.splice(index,1);
}); 
```

现在我需要一种方法来更新`page-mod`as 的一部分`deleteItem`，以便它不再适用于新删除的站点。

我尝试将其`page-mod`放入一个函数并调用该函数。我也尝试过更新数组然后`myPageMod.include = store.storage.sites`，但这也没有做任何事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T08:04:37.783

`page-mod`有一个[`include`属性](https://developer.mozilla.org/en-US/Add-ons/SDK/High-Level_APIs/page-mod#include)，一个当前包含规则的列表。您可以对其调用`add()`和`remove()`方法，例如：

```
function addItem(rule) {
  store.storage.sites.push(rule);
  myPageMod.include.add(rule);
}

function deleteItem(index) {
  myPageMod.include.remove(store.storage.sites.splice(index,1));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T04:14:46.980

我认为如果您使用变量来引用您的 pagemod，您应该能够更改它。

```
var myPageMod = pageMod.PageMod({
  include: store.storage.sites,
  contentScriptWhen: 'start',
  contentScriptFile: [self.data.url("nicEdit-latest.js"),
                      self.data.url("pagedit.js")]
});

function deleteItem(index) {
  myPageMod.include = store.storage.sites.splice(index,1);
}); 
```

# symfony - symfony 中的资产文件在防火墙后面？

> ID：12148272
> 
> 赞同：5
> 
> 时间：2012-08-27T19:25:16.280
> 
> 标签：symfony, symfony-2.1, fosuserbundle, assetic

我有简单的登录页面和安全设置，如下所示：

```
firewalls:
    main:
        pattern: ^/
        form_login:
            provider: fos_userbundle
            csrf_provider: form.csrf_provider
            use_referer: true
            always_use_default_target_path: true
            default_target_path: /
        logout:       true
        anonymous:    true

access_control:
    - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/register, role: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/, role: ROLE_ADMIN } 
```

在我的 base.html.twig 文件中，我有

```
{% stylesheets '@BrStgCcBundle/Resources/public/css/bootstrap.css' %}
    <link rel="stylesheet" href="{{ asset_url }}" />
{% endstylesheets %} 
```

并且仅当我在应用程序中获得授权时才包含这些文件。因此，登录后系统会找到此资产，但之前没有，当我按照资产生成的链接时，我被重定向到登录页面。

在视图中，链接如下所示：

```
<link rel="stylesheet" href="/app_dev.php/css/026adfc_bootstrap_1.css" /> 
```

该文件存在于驱动器上，当登录时调用时，未登录时显示正确的 CSS，它将我重定向到登录页面。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-28T08:15:58.200

我还发现如果添加到以下内容会有所帮助`security.yml`：

```
firewalls:
    dev:
        pattern:    ^/(_profiler|_wdt|css|js|assets)
        security:   false 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-27T21:24:45.510

这很正常。您是说根目录下的所有内容（模式：^/）都位于主防火墙之后，并且要访问这些文件，您需要成为管理员（路径：^/，角色：ROLE_ADMIN）。所以需要另外设置一条规则，说css目录可以匿名访问：

```
- { path: ^/css, role: IS_AUTHENTICATED_ANONYMOUSLY } 
```

# linux - dpkg remove 停止进程

> ID：12148273
> 
> 赞同：2
> 
> 时间：2012-08-27T19:25:22.587
> 
> 标签：linux, packages, uninstallation, dpkg, init.d

我目前正在运行 Ubuntu 12.04。我创建了一个 debian 包，该包目前已成功安装并启动了三个新进程。我还通过在 /etc/init.d 中放置以下脚本使这三个进程在运行时启动：

```
# This example is from http://www.debian-administration.org/article/Making_scripts_run_at_boot_time_with_Debian
#  Also used http://wiki.debian.org/LSBInitScripts/

### BEGIN INIT INFO
# Provides:          bleh
# Required-Start:    $remote_fs $syslog $network
# Required-Stop:     $remote_fs $syslog $network
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: Start daemon at boot time
# Description:       Enable service provided by daemon.
### END INIT INFO

# Carry out specific functions when asked to by the system
case "$1" in
  start)
    cd //opt/bleh
    attrf=.gatewayattributes

    if [ ! -z "$1" ]
    then
  echo "[gateway]" >> $attrf
    echo "activationKey = $1" >> $attrf
fi

./bleh1 -n &
./bleh2 &
python bleh3 &

    ;;
  stop)
cd //opt/bleh
/usr/bin/pkill -f ./bleh1 -n
    /usr/bin/pkill -f bleh3
    kill -9 $(pidof bleh2)
    rm -rf logs
    ;; 
```

该脚本确实在运行时启动了三个进程，但由于某种原因，我实际上无法使用启动/停止命令，如 sudo /etc/init.d bleh.sh stop。

更大的问题是使用以下命令删除此软件包：sudo dpkg -r bleh

实际上并没有停止这三个进程，它只是尝试删除我安装在我的 opt 文件夹中的 bleh 目录。另外，我的 bleh 目录中有一个文件夹没有被删除，它给了我一个警告说明：正在删除 bleh ... dpkg：警告：删除 bleh 时，目录 '/opt/bleh/logs' 不为空，所以没有删除.

除非您具有 SU 特权，否则该日志目录中的文件是只读的，但我不明白这应该是什么问题，因为我在该 dpkg -r 命令上调用 sudo。

如果我再次运行 sudo dpkg -r bleh，它表明没有与 bleh 匹配的已安装包，这意味着它认为它已成功删除已安装的包，即使现有的日志目录和三个仍在运行的进程也是如此。

对不起，我知道这很长，但我真的需要一些帮助..提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:55:59.187

按照Debian 新维护者指南的[建议](http://www.debian.org/doc/manuals/maint-guide/dother.en.html#initd)，请使用`dh_installinit`（当然，使用 debhelper 构建整个软件包）。默认情况下，这将添加脚本以启动和停止包安装和删除。

辅助文件（例如配置）通常在`purge`（例如`dpkg -P`）状态下被删除。要自己处理这个问题，您需要一个`deconfigure`脚本。

此外，最好使用`start-stop-daemon`代替`&`，这对于适当的守护进程来说是不够的。

# internet-explorer - Internet Explorer 中的 Selenium WebDriver 单击问题

> ID：12148274
> 
> 赞同：7
> 
> 时间：2012-08-27T19:25:22.893
> 
> 标签：internet-explorer, selenium, webdriver, selenium-webdriver, xpath

在多个 Windows 7 测试工作站上使用 Selenium WebDriver。

Button 的 FireBug Html 如下：

```
<input type="submit" style="border-color:Black;border-width:1px;border-style:solid;
font-family:tahoma,arial;font-size:0.7em;" id="UserPassword1_LoginButton" 
onclick="javascript:WebForm_DoPostBackWithOptions(new  WebForm_PostBackOptions(&quot;UserPassword1$LoginButton&quot;, 
&quot;&quot;, true, &quot;UserPassword1&quot;, &quot;&quot;, false, false))" value="Log      In" name="UserPassword1$LoginButton"> 
```

Selenium C# 代码片段如下：

```
try
        {
            // Click on the button identified by Id
            IWebElement query = Driver.FindElement(By.Id(strControl));
            query.Click();
        } 
```

在某些 Windows 测试工作站上，按钮单击方法工作得很好。在其他 Windows 7 测试工作站上，单击按钮不会按下按钮，按钮只是突出显示。

我也看到过类似的问题，有时我必须包括两个：

```
query.Click(); 
```

连续命令以使按钮按下。

我们一直在尝试找出不同环境之间的不同之处，但没有提出任何解决方案。

有关如何解决此问题或是否有人对此问题有解决方案的任何想法。

谢谢

乔

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-27T19:48:28.937

你还没有说你看到问题的浏览器是什么，但我将使用我的心理调试能力来推断你可能在谈论 Internet Explorer。IE 驱动程序存在已知的挑战。

一组挑战是您需要将浏览器的缩放级别设置为 100%，否则 IE 驱动程序无法计算坐标才能正确点击。当单击在一台机器上而不是另一台机器上工作时，通常会出现这种情况，并且记录在[项目 wiki](http://code.google.com/p/selenium/wiki/InternetExplorerDriver)中。

另一类问题特别涉及[窗口焦点](http://jimevansmusic.blogspot.com/2012/06/whats-wrong-with-internet-explorer.html)。一种替代方法是仅对 IE 驱动程序使用模拟事件。这种方法有其自身的缺陷，但它可能适用于您的情况。由于您提到您使用的是 C#，因此这里是用于禁用本机事件的 .NET 绑定的代码。

```
InternetExplorerOptions options = new InternetExplorerOptions();
options.EnableNativeEvents = false;
IWebDriver driver = new InternetExplorerDriver(options); 
```

# javascript - Highcharts 如何在设置数据处显示加载动画

> ID：12148276
> 
> 赞同：13
> 
> 时间：2012-08-27T19:25:24.633
> 
> 标签：javascript, jquery, highcharts

我有highcharts图形。当我创建我的页面时，我显示空图形（我没有设置数据属性并且只有图形的标题，它们内部是空的。）我从服务器异步获取数据并调用

> 设置数据（）

回调函数。但是用户看到一个空页面，我想为他们显示一个加载图像。这：[http](http://api.highcharts.com/highcharts#loading) ://api.highcharts.com/highcharts#loading对我不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-27T19:36:35.350

我按照给定 URL 中的说明进行了操作：

```
function updateGraphic(url, chartName) {
    chartName.showLoading();
    $.getJSON(url, function(data){
        chartName.series[0].setData(data);
        chartName.hideLoading();
    });
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-01-20T14:49:11.300

“正在加载..”这个词似乎太业余了。改用那个技巧

```
var chart = new Highcharts.Chart(options);
chart.showLoading('<img src="/images/spinner.gif">');

$.getJSON(url, function(data){
       //load data to chart
       chart.hideLoading();
}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-11T13:16:52.300

这是一个简单的部分，我总是用来显示加载。

假设这是我们的容器

```
<div id='container'>
  <img id="spinner" src="/assets/chart_loader.gif"/>
</div> 
```

这是一段 ajax，它负责在 getJson 为图表启动时显示并在它停止时隐藏。

```
$(document).ajaxStart ->
  $("#spinner").show()

$(document).ajaxComplete ->
  $("#spinner").hide() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-16T07:38:19.613

[您可以使用此插件JQuery Block UI](http://malsup.com/jquery/block/)为每个页面全局定义

和用法是

```
 jQuery(document).ready(function ($) {
        $.ajaxSetup({ cache: false });
        $(document).ajaxStart(function () {
        $('body').block({
            message: '<h3><img alt="" class="GifIcon" src="Images/319.gif" />Please wait Data is Loading From Server ...... </h3>'
        });
    });
    $(document).ajaxStop(function () {
        $('body').unblock();
    });

}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-26T17:45:23.470

修改highcharts的css类：

```
.highcharts-loading {
  display: flex;
  align-items: flex-start;
  justify-content: center;
}

.highcharts-loading-inner {
  border: 8px solid #f3f3f3;
  border-top: 8px solid #252222;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  animation: spin 2s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
} 
```

基于：[How TO - CSS 加载器](https://www.w3schools.com/howto/howto_css_loader.asp)

# vba - Powerpoint 2007 在嵌入式图表对象的数据表上断开链接

> ID：12148277
> 
> 赞同：0
> 
> 时间：2012-08-27T19:25:29.180
> 
> 标签：vba, powerpoint, powerpoint-2007

我想断开嵌入式图表对象数据表中的链接。此代码更新链接，但我需要断开链接。谢谢

```
pptWorkbook.UpdateLink pptWorkbook.LinkSources(1) 
```

PS。您如何在没有错误消息的情况下更新多个链接源。？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T22:02:07.000

我想我通过简单地分配一个`vbnullstring`或`""`作为链接解决了这个问题，然后它出现在链接对话框中`NULL` （所以我正在考虑从 Excel 粘贴的图表，这就是嵌入式图表的意思；因为如果你的问题是没有意义的意思是“本机” ppt2007+ 图表对象）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T15:04:55.067

取消组合表示图表的形状。这会破坏链接，将图表转换为矢量（即 EMF/WMF）图形。

# javascript - 按顺序异步加载JS脚本（等待上一个完成）

> ID：12148279
> 
> 赞同：1
> 
> 时间：2012-08-27T19:25:35.800
> 
> 标签：javascript, html

我正在尝试在我的项目中使用[GoogleMaps.InfoBox](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/)，但在加载此脚本之前，必须加载 GoogleMaps API。

现在我有这段代码来加载所有内容：

```
/**
 * Load scripts asynchronously
 */
function loadScript() {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "http://maps.googleapis.com/maps/api/js?key=-MY-KEY-&sensor=true&callback=initialize";
    document.body.appendChild(script);
    var scriptInfoBox = document.createElement("script");
    scriptInfoBox.type = "text/javascript";
    scriptInfoBox.src = "http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/src/infobox_packed.js";
    document.body.appendChild(scriptInfoBox);
} 
```

但并非总是比 GoogleMaps.InfoBox 加载 GoogleMaps API。

**如何加载 JS 排序，等待完成前一个？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T19:49:09.917

您可以使用`load`脚本的事件：

```
function loadScript(callback) {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "http://maps.googleapis.com/maps/api/js?key=-MY-KEY-&sensor=true&callback=initialize";
    document.body.appendChild(script);
    script.onload = function() {
        var scriptInfoBox = document.createElement("script");
        scriptInfoBox.type = "text/javascript";
        scriptInfoBox.src = "http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/src/infobox_packed.js";
        document.body.appendChild(scriptInfoBox);
        scriptInfoBox.onload = callback;
    };
} 
```

但是，您需要稍微调整代码以使其[像这样跨浏览器安全](https://stackoverflow.com/q/1929742/1048572)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:31:11.573

只需在之前使用常规脚本标签`</body>`。

```
<script src="http://maps.googleapis.com/maps/api/js?key=-MY-KEY-&sensor=true&callback=initialize"></script>
<script src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/src/infobox_packed.js"></script> 
```

默认情况下，浏览器会按照它们出现的顺序执行脚本。

# java - 带字符的掩码字符串

> ID：12148281
> 
> 赞同：7
> 
> 时间：2012-08-27T19:25:36.553
> 
> 标签：java

嘿家伙，我试图找到一种隐藏字符串的方法，但我发现的代码只适用于我的应用程序......有没有办法隐藏字符串中的字符`*`或者`-`如果有人可以解释

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-27T19:32:46.087

这是用来做密码的吗？考虑以下：

```
class Password {
    final String password; // the string to mask
    Password(String password) { this.password = password; } // needs null protection
    // allow this to be equal to any string
    // reconsider this approach if adding it to a map or something?
    public boolean equals(Object o) {
        return password.equals(o);
    }
    // we don't need anything special that the string doesnt
    public int hashCode() { return password.hashCode(); }
    // send stars if anyone asks to see the string - consider sending just
    // "******" instead of the length, that way you don't reveal the password's length
    // which might be protected information
    public String toString() {
        StringBuilder sb = new StringBuilder();
        for(int i = 0; < password.length(); i++) 
            sb.append("*");
        return sb.toString();
    }
} 
```

或者对于刽子手方法

```
class Hangman {
    final String word;
    final BitSet revealed;
    public Hangman(String word) {
        this.word = word;
        this.revealed = new BitSet(word.length());
        reveal(' ');
        reveal('-');
    }
    public void reveal(char c) {
        for(int i = 0; i < word.length; i++) {
            if(word.charAt(i) == c) revealed.set(i);
        }
    }
    public boolean solve(String guess) {
        return word.equals(guess);
    }
    public String toString() {
         StringBuilder sb = new StringBuilder(word.length());
         for(int i = 0; i < word.length; i++) {
             char c = revealed.isSet(i) ? word.charAt(i) : "*";
         }
         return sb.toString();
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-27T19:37:22.963

只需创建一个与原始字符数相同的字符串，而是使用您的“混淆”字符。

```
String x = "ABCD";

String output = "";
for (int i = 0; i < x.length(); i++) {
    output += "*";
} 
```

或者，您可以使用`x.replaceAll("\\S", "*")`，它也可以保留空格。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-01T16:17:48.487

有几种方法可以实现这一点，这取决于您的应用程序。

如果您想一举用另一个字符掩盖所有字符，您可以使用以下`String#replaceAll(String regex, String replacement)`方法：[http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceAll(java. lang.String,%20java.lang.String)](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceAll(java.lang.String,%20java.lang.String))。

这涉及使用正则表达式，因为`regex`您将使用`[\s\S]`它将匹配任何空白或非空白字符。因为`replacement`您使用常规字符串，而不是 RegEx。在这种情况下，如果你想要一个星号，使用“*”，连字符“-”，非常简单。

除了`@Roddy of the Frozen Pea`and`@djc391`之外，这里的所有其他方法都运行良好，所以这就是我正确回答的原因。

祝你好运

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T19:49:45.900

你可以很容易地实现这样的事情：

```
public class MaskedString
{
    private String data;

    public MaskedString(String data){this.data = data;}
    public void append(char c){data += c;}
    public void setData(String data){this.data = data;}

    public String getMasked()
    {
        StringBuilder sb = new StringBuilder();
        for(int i=0; i<data.length(); i++)
            sb.append('*');
        return sb.toString();
    }

    public String getString()
    {
        return data;
    }
} 
```

你明白了:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-12T02:47:10.287

我的实现：

```
public static String maskString(String s, int x) {
    int n = s.length()/x;
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < s.length(); i++) {
      if (n >= 1 && (i < n || i >= (s.length() - n))) {
        sb.append(s.charAt(i));
      }
      else {
        sb.append("*");
      }
    }
    return sb.toString();
  } 
```

# jquery - 重新启动事件监听器 javascript/jquery

> ID：12148284
> 
> 赞同：1
> 
> 时间：2012-08-27T19:25:45.083
> 
> 标签：jquery, ajax, javascript-events

我有一个页面，其中内容是通过 ajax 引入的。我遇到的问题是在内容加载后添加相关的事件侦听器。有没有办法告诉浏览器再次从头运行所有脚本？

下面是一个从页面头部运行的简单代码示例，显然任何通过 AJAX 引入的匹配 '.RRCustomizeBox .customize' 的新 html 元素都不会有以下点击事件。

例如：

```
_vvdCMS.kklsRegions = {

    init: function (){
        $(document).ready(function(){

            $('.RRCustomizeBox .customize').click( function(){
                _vvdCMS.kklsRegions.showRRCustoms(this);
            });

        });
    },

    showRRCustoms: function(obj) {
        var objParent = $(obj).parent();
        objParent.find('.RRCustomizeBoxForm').fadeIn(700);
    }
}
_vvdCMS.kklsRegions.init(); 
```

感谢您的任何提示，

约翰

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T19:27:27.280

您可以将所有初始化代码放在一个函数中，并从两个位置调用该函数：

1.  在 document.ready()
2.  加载新内容后

例如：

```
function initDynamicEventHandlers() {
    // set up your event handlers here
}

$(document).ready(initDynamicEventHandlers);

$(whatever).load(url, initDynamicEventHandlers) 
```

您必须确保任何未被替换的内容都不会安装多个事件处理程序。

* * *

或者，第二个选项，对于某些类型的逻辑（如鼠标和键事件），您可以使用委托事件处理并在附加到未替换的静态父对象后安装事件处理，并且事件处理将在不更改的情况下工作您的动态内容在下面发生变化。

为此，您使用以下委托形式`.on()`：

```
$(static parent object selector).on('click', dynamic object selector, fn) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-12T19:28:34.870

这可能为时已晚，但这就是我需要 ajax 时所做的。

```
$(document).ready(function () {
$(document.body).on('click', '.Selector_S', function () { function_F(event, this) })
}

function function_F(event, d){
...do sth here...
} 
```

而且您根本不需要重新启动事件侦听器或在 ajax 函数中编写任何内容。

# wpf - 如何将 IsHitTestVisible 设置为设置为 false 的子对象的 True？

> ID：12148286
> 
> 赞同：11
> 
> 时间：2012-08-27T19:25:46.607
> 
> 标签：wpf, layout, hittest

我有一条消息在边框内并显示在 MDI 客户区前面。因为它只是一条消息，所以我将它设置`IsHitTestVisible`为 false。为方便起见，我还在其中包含了一个按钮，因此用户只需单击该按钮即可开始新图表。

但是，由于边框`IsHitTestVisible`设置为`False`，它会缩短`True`按钮的值，因此用户无法单击按钮。

也就是说，如何使控件对鼠标不可见，同时仍允许其子级之一接收鼠标事件？

这是一个屏幕截图：

![在此处输入图像描述](../Images/307382d70830219d2773025370847bdc.png)

我们希望带有文本的蓝色区域在命中测试中不可见，但我们希望按钮仍然能够被按下。想法？（是的，我已经知道将这两个项目堆叠在一个网格中，但这与布局相混淆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:44:43.713

AFAIK你不能。但是，您可以使用 IsEnabledProperty 来做到这一点，并且仍然需要一些解决方法。您必须像这样创建自己的按钮：

**2013 年 9 月 1 日编辑：**

```
 public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();
        DataContext = this;
    }

    private void ButtonBase_OnClick(object sender, RoutedEventArgs e)
    {
        MessageBox.Show("hello");
    }
}

public class MyButton : Button
{
    static MyButton()
    {
        IsEnabledProperty.OverrideMetadata(typeof(MyButton),
        new UIPropertyMetadata(true,(o, args) => { },(o, value) => value));
    }
} 
```

XAML：

```
<BorderIsEnabled="False">
    <wpfApplication2:MyButton Margin="61,95,88,100" Click="ButtonBase_OnClick">Open a new diagram</wpfApplication2:MyButton>
</Border> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T07:40:33.460

好的，看起来问题不能按要求解决，因此看起来我们必须恢复到分层方法。在这种情况下，为了补偿文本变化，您必须将按钮的垂直对齐方式设置为底部，并确保在边框的底部边缘或 TextBlock 的底部边缘有额外的填充）以确保标签始终浮动在按钮。您使用相同的原则管理两者的边距/填充。

这将为我们提供我们所追求的东西，但看起来很麻烦。同样，我希望有某种方法可以指定 IsHitTestVisible（或 IsEnabled），并以某种方式将它们（及以下）重新确立为行为的所有者。一个人可以做梦。在那之前……层层叠叠！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-18T18:37:29.097

**免责声明：**它看起来不会解决 OP 的确切问题，但我会将其保留在这里，因为它可能对其他有类似问题的人有所帮助。

单击网格不应在网格上注册任何鼠标事件。

```
<Grid Background="{x:Null}">
   <Button/>
<Grid/> 
```

**编辑：当您希望背景可见时，我会建议：**为了演示，我在边框上设置 cursor="hand"

```
<Canvas>
    <Border Height="300" Width="300" Background="Red" Cursor="Hand" IsHitTestVisible="False"/>
    <Button Content="click"/>
</Canvas> 
```

或者

```
<Grid>
    <Border  Background="Red" Cursor="Hand" IsHitTestVisible="False" />
    <Button Content="click" HorizontalAlignment="Center"/>
</Grid> 
```

这两种情况的诀窍是控件（按钮）不是 IsHitTestVisible="False" 的父控件的子控件，它只是与背景控件重叠

# meteor - 发布任意数据并自动更新 HTML

> ID：12148287
> 
> 赞同：2
> 
> 时间：2012-08-27T19:25:53.507
> 
> 标签：meteor

如何发布任意数据？这就是我想要完成的，给出以下模板：

```
<head>
  <title>Test</title>
</head>

<body>
  {{> hello}}
</body>

<template name="hello">
  <h1>{{greeting}} World!</h1>
</template> 
```

我想`greeting`在设定的时间间隔内动态更新，使用`Meteor.setInterval`. 文档中的所有示例似乎都`Collections`差不多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T03:33:21.100

您可以使用 Meteor Session 变量作为反应数据源，以便模板自动重新呈现 ( [http://docs.meteor.com/#session_set](http://docs.meteor.com/#session_set) )。尝试这个：-

```
if (Meteor.is_client) {

  // Use 'greeting' Session variable as a reactive data source
  Session.set('greeting', 0);

  Template.hello.greeting = function () {
    return "Welcome to test: " + Session.get('greeting');
  };

  Meteor.setInterval(function() {
    Session.set('greeting', Session.get('greeting') + 1);
  }, 1000);
}

if (Meteor.is_server) {
  Meteor.startup(function () {
    // code to run on server at startup
  });
} 
```

**更新：**显示挂钩到`streams`包中。示例有效，但使用后果自负

```
if (Meteor.is_client) {
  // Use client from stream package
  sc = new Meteor._Stream('/sockjs');
  sc.on('message', function(payload) {
    var msg = JSON.parse(payload);

    // Set session variable so template reacts
    Session.set('greeting', JSON.stringify(msg.data));
  });

  // Use 'greeting' Session variable as a reactive data source
  Template.hello.greeting = function () {
    return Session.get('greeting');
  };
}

if (Meteor.is_server) {
  // Use server from stream package
  ss = new Meteor._StreamServer();

  // register handler for socket connection
  ss.register(function (socket) {
    var data = {socket: socket.id, connected: new Date()}
    var msg = {msg: 'data', data: data};

    // Send message to all sockets
    _.each(ss.all_sockets(), function(socket) {
      socket.send(JSON.stringify(msg));
    })
  });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-01T14:04:38.027

您好，请查看这个新的[Streams 包](http://meteorhacks.com/introducing-meteor-streams.html)。您可以简单地将它用于您的用例

```
sc = new Meteor.Stream('hello');

if(Meteor.isServer) {
  Meteor.setInterval(function() {
    sc.emit('a_random_message', 'Random Message: ' + Random.id());
  }, 2000);

  Meteor.permissions.read(function() { return true });
}

if(Meteor.isClient) {
  sc.on('a_random_message', function(message) {
    Session.set('a_random_message', message);
  });

  Template.hello.greeting = function () {
    return Session.get('a_random_message');   
  };
} 
```

# android - 在 android 应用程序中使用 X509 证书

> ID：12148294
> 
> 赞同：1
> 
> 时间：2012-08-27T19:26:17.047
> 
> 标签：android, security, certificate

我正在开发一个使用公钥证书对发送到服务器的消息进行签名的 android 应用程序。当用户登录时，他会收到一个 x509 证书。现在，当他想向服务器发送消息时，他必须使用证书公钥对消息进行签名，并将其与消息一起发送到服务器。我是安全新手，我不知道该怎么做。这些是我的一些问题：

1.  如何将证书安全地存储在手机中，以便我的应用程序可以使用它来签署发送到服务器的消息？

2.  我还计划在某个时候进行一次密钥轮换。因此，服务器会将更新后的证书发送给用户，我的应用程序必须更新存储在手机中的证书。

如果您能指出我需要仔细处理的教程或任何问题，那将非常有帮助。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T07:26:07.627

您应该问自己的第一个问题是您是要签名还是加密您的消息。如果您要签名（= 向收件人证明您的消息在传输过程中没有被更改，并且还证明发件人确实是您的应用程序），那么您应该使用私钥签名并让服务器与公共验证签名钥匙。如果要加密消息，则应使用**服务器的**公钥对其进行加密，并让服务器使用其私钥对其进行解密。

第二个问题是证书的传输：如果您担心中间人篡改您的应用程序的消息，那么这个攻击者也可以拦截您发送到应用程序的证书并因此签署他的消息。

要回答您的问题：

1.  我能想到的将任何东西安全地存储在手机上的唯一方法（这样即使攻击者获得了 root 权限也无法访问它）是使用未存储在设备上但必须由用户输入的用户密码对其进行加密。每次访问证书时的用户。

2.  如果您设法将一个证书安全地发送到设备（我怀疑您可以），那么您可以通过在服务器端使用旧证书的公钥加密新证书并将其发送到设备来执行密钥轮换。在那里，您可以使用私钥对其进行解密。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T14:04:50.803

这真的取决于你的目标是什么。如果目标是断言一个有效的经过身份验证的用户发送了请求，那么使用公钥签名不是要走的路。为了确定发件人是您认为的那个人，您使用私钥签名并使用公钥进行验证。但是，根据您的环境，保持私钥私有的客户端可能是个问题。

如果您的目标只是防篡改，那么也许 HMAC（键控哈希）可能是一种更有效的方法。

# c++ - C ++加速多个 substr() 或等效函数调用以解析大字符串

> ID：12148296
> 
> 赞同：4
> 
> 时间：2012-08-27T19:26:24.507
> 
> 标签：c++, string, performance, data-structures, substr

我正在尝试解析从文件加载到内存中的大字符串。我正在使用可变长度的滑动窗口解析 DNA 序列（存储为字符串）。问题是字符串太大了，需要很长时间才能遍历它们。我不知道这是否可能，但有可能以某种方式加快速度吗？

我的意思是我希望 I/O 主宰我的应用程序，所以我将逐行读取转换为一次将整个文件读入内存，但在测试我的代码后，我发现它大部分时间都在这样的循环中：

```
size_t currentCharNumber = 0;
int16_t windowSize = 50;
//seq is a string of length 249250621
while(seq.length() - currentLinePos < windowSize)
{
   string temp = seq.substr(currentLinePos, windowSize);
   //do stuff to temp
   ++currentLinePos;
} 
```

将序列从文件加载到内存只需要几秒钟，但解析序列需要大约 30 分钟（即使在注释掉 substr() 调用下面的处理之后）。有什么我遗漏的东西会增加很多开销，还是可能是由于我的数据大小？

提一下我可以忽略带有 ATCG 以外的字符的子字符串会有所帮助吗？我的意思是我在我的代码中做这个过滤，但只有在我从 substr 获取字符串之后。

这是我第一次发帖，我的 C++ 有点生疏。任何反馈将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T19:30:02.250

您可能需要考虑从使用 a`string`来保持滑动窗口切换到使用`std::deque<char>`. 该`deque`类型针对在任一端插入和删除值进行了优化，因此在这里是一个很好的候选者。您可以首先将前 50 个字符加载到 中`deque`，然后可以像这样调整循环：

```
/* Initialize the window to the first windowSize characters. */
std::deque<char> window(seq.begin(), seq.begin() + windowSize);

/* Repeatedly process each window. */
for (size_t i = windowSize; i < seq.length(); ++i) {
    /* Do something to window */

    /* Drop the first character from the window, then add the next character
     * of the sequence.
     */
    window.pop_front();
    window.push_back(seq[i]);     
} 
```

这使得构建每个窗口的时间为 O(1) 而不是 O(k)，其中`k`是窗口中的字符数。这可能会大大减少运行时间，因为窗口中的字符数非常大。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T19:29:58.897

您可以通过两个指向原始字符串的指针来分隔滑动窗口并使用它，而不是将整个范围复制到单独的字符串中。如果`std::string`施工是开销，请避免。

`std::string`您也可以每次都重复使用相同的实例（假设窗口大小是恒定的），但它仍然会花费您一次复制操作（尽管对于小窗口/长度比而言，这可能可以忽略不计）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-27T19:31:19.423

调用`std::string::substr`可能会导致过多的动态内存分配，并且至少会复制缓冲区。通常，您可以`substr`通过更改算法以使用字符串分隔迭代器来减少对的需求。

# session - telnet 后Expect 失去连接并且不发送任何后续的“expect send”命令

> ID：12148302
> 
> 赞同：0
> 
> 时间：2012-08-27T19:26:34.690
> 
> 标签：session, tcl, telnet, expect

我有一个自动的 telnet 会话.. 我的问题有点令人困惑，但我试着用例子来解释....

示例1：

```
spawn telnet 172.23.144.180 2068
after 2000
send "\r"

expect "loader>"
send "boot n7000-s2-kickstart.6.1.1.66.gbin n7000-s2-dk9.6.1.1.66.gbin\r"
### HERE I NEED TO WAIT FOR 3 MINUTES FOR MY EXPECT STRING ####
### SO IM SETTING TIME OUT ###
set timeout 180

### AFTER 3 MIN ### 
expect "Feature poap enabled/disabled"
send "yes\r"

expect "Do you want to enforce secure password standard (yes/no)"
send "yes\r" 
```

发生了什么，场景 1：它永远等待不向控制台发送任何内容（我在控制台上看到“ `Feature poap enabled/disabled`”日志）。

发生了什么，场景 2：如果我给 " `after 180000`" 即睡 3 分钟；而不是“ `set timeout 180`”：无论如何，脚本都会发送“ `yes`”，即第一个“ `expect send`”..

我希望我的脚本仅在我看到“”时才发送“是” `Feature poap enabled/disabled`......有人可以帮我这样做吗？

我进行了更多研究，发现只有 telnet 进程才会发生这种情况..不是常规进程（即不是 telnet）

```
package require Expect
set timeout 180
expect "Feature poap enabled/disabled"
send "Yes\r" 
```

工作正常; 在 180000 之后也可以正常工作...

帮助表示赞赏..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T00:54:58.120

使用 exp_internal 1 并发现无论期望的字符串是什么......它都会搜索给定的字符串几秒钟......然后打印“expect：timed out”并发送。在我的情况下是“yes” ......所以我使用 set timeout -1 它工作正常..它将永远等待字符串..这有点我需要..谢谢大家投入.. -</p>

# c# - 命名参数的评估顺序

> ID：12148310
> 
> 赞同：7
> 
> 时间：2012-08-27T19:26:55.587
> 
> 标签：c#, named-parameters, operator-precedence

> **可能重复：**
> [传递给方法时是否按顺序评估参数？](https://stackoverflow.com/questions/7359996/are-parameters-evaluated-in-order-when-passed-into-a-method)

说我有

`void foo (int x, int y)`

并通过以下方式调用它：

`foo(y: genNum(), x: genNum())`

在这种情况下，C# 是否保证 x 和 y 的评估顺序？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-27T19:32:39.940

根据[规范](http://msdn.microsoft.com/en-us/library/ms228593.aspx)，参数总是从左到右进行评估。不幸的是，在 C# 4.0 的某些极端情况下存在一些错误。请参阅 Eric Lippert 的帖子，[参数在传递给方法时是否按顺序评估？](https://stackoverflow.com/questions/7359996/are-parameters-evaluated-in-order-when-passed-into-a-method)更多细节。

顺便说一句，这可能是不好的做法。如果要保证计算参数的顺序，请先将结果捕获到局部变量中，然后将结果传递给使用方法，例如：

```
int capturedY = genNum(); //It is important that Y is generated before X!
int capturedX = genNum();
foo(capturedX, capturedY); 
```

我想不出一个很好的理由不那样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T19:37:31.467

*这不是答案，只是为了显示副作用。*

```
public void Test()
{
    foo(y: genNum(), x: genNum());
}

int X=0;
int genNum()
{
    return ++X;
}

void foo(int x, int y)
{
    Console.WriteLine(x);
    Console.WriteLine(y);
} 
```

**输出：**

```
2
1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T19:40:25.990

根据 [C# In Depth – Optional Parameters and Named Arguments](http://codebetter.com/2011/01/11/c-in-depth-optional-parameters-and-named-arguments-2/)：

> ...第二个调用颠倒了参数的顺序，但结果仍然相同，因为参数是按名称而不是位置与参数匹配的。

在您的情况下， first 将被执行`y`并且 after `x`，因为它首先出现在函数声明中（从左侧开始）。

事实上，它实际上就像第二个参数一样，是实现命名参数的 C# 编译器的实现细节。

# delphi - Delphi Now() 函数返回错误值

> ID：12148312
> 
> 赞同：7
> 
> 时间：2012-08-27T19:27:24.690
> 
> 标签：delphi, datetime, delphi-2007

我有基于 DirectX 的应用程序。最近我发现`Now()`从图形引擎的主循环中调用该函数时返回错误的值。它给出了在引擎初始化之前调用的一个值，以及在启动图形时在我的应用程序中调用的另一个值（通常前后相差 2-3 分钟）。

我发现该`Now()`函数是 Windows API`GetLocalTime()`函数的包装器。任何人都可以指出什么会影响这个函数的返回值？我在应用程序的主循环中大量使用`timeGetTime()`函数，这可能是问题的根源吗？我还需要`CheckSyncronize()`在主循环中使用函数...

有任何想法吗？我没有线索... :(

主循环代码：

```
 procedure Td2dCore.System_Run;
    var
        l_Msg: TMsg;
        l_Point: TPoint;
        l_Rect : TRect;
        l_Finish: Boolean;
    begin
        if f_WHandle = 0 then
        begin
            System_Log('Engine was not started!');
            Exit;
        end;

        if not Assigned(f_OnFrame) then
        begin
            System_Log('Frame function is not assigned!');
            Exit;
        end;

        // MAIN LOOP
        l_Finish := False;
        while not l_Finish do
        begin
            // dispatch messages
            if PeekMessage(l_Msg, 0, 0, 0, PM_REMOVE) then
            begin
                if l_Msg.message = WM_QUIT then
                    l_Finish := True;
                DispatchMessage(l_Msg);
                Continue;
            end;

            GetCursorPos(l_Point);
            GetClientRect(f_WHandle, l_Rect);
            MapWindowPoints(f_WHandle, 0, l_Rect, 2);
            f_MouseOver := f_MouseCaptured or (PtInRect(l_Rect, l_Point) and (WindowFromPoint(l_Point) = f_WHandle));
            if f_Active or f_DontSuspend then
            begin
                repeat
                    f_DeltaTicks := timeGetTime - f_Time0;
                    if f_DeltaTicks <= f_FixedDelta then
                        Sleep(1);
                until f_DeltaTicks > f_FixedDelta;
                //if f_DeltaTicks >= f_FixedDelta then
                begin
                    f_DeltaTime := f_DeltaTicks / 1000.0;

                    // if delay was too big, count it as if where was no delay
                    // (return from suspended state for instance)
                    if f_DeltaTime > 0.2 then
                        if f_FixedDelta > 0 then
                            f_DeltaTime := f_FixedDelta / 1000.0
                        else
                            f_DeltaTime := 0.01;

                    f_Time := f_Time + f_DeltaTime;

                    f_Time0 := timeGetTime;

                    if(f_Time0 - f_Time0FPS < 1000) then
                        Inc(f_FPSCount)
                    else
                    begin
                        f_FPS := f_FPSCount;
                        f_FPSCount := 0;
                        f_Time0FPS := f_Time0;
                    end;

                    f_OnFrame(f_DeltaTime, l_Finish);
                    if Assigned(f_OnRender) then
                        f_OnRender();
                    ClearQueue;
                    {
                    if (not f_Windowed) and (f_FixedFPS = D2D_FPS_VSYNC) then
                        Sleep(1);
                    }
                end;
                {
                else
                    if (f_FixedDelta > 0) and (f_DeltaTicks+3 < f_FixedDelta) then
                        Sleep(1);
                }
            end
            else
                Sleep(1);
            CheckSynchronize;
        end;
    end; 
```

`f_OnFrame()`Now() 在函数的某处被调用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-01T08:28:44.187

最后我找到了解决方案。`D3DCREATE_FPU_PRESERVE`在创建 D3D 设备时，我需要指定 th标志`D3D.CreateDevice`。

否则，没有该标志，所有浮点运算都以单精度执行。由于它`TDateTime`是一个简单`Double`的`Now()`函数，它由简单地将日期值添加到时间值组成，这一切都被 DirectX“智能”覆盖搞砸了。

问题解决了。这确实是一个棘手的问题。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:28:05.817

我曾经在 OpenGL 和模拟器和 MapObjects 中遇到过这些问题。时间顺序被发现是设备之间的差异。这里有两个链接可能会对这个主题有所启发：

[http://delphi.about.com/od/windowsshellapi/a/delphi-high-performance-timer-tstopwatch.htm](http://delphi.about.com/od/windowsshellapi/a/delphi-high-performance-timer-tstopwatch.htm) Zarko Gajic 的文章对我必须为串行接口构建的计时器提供了帮助。我使用此代码示例的变体来提取储罐传感器的数据。

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms644900%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644900%28v=vs.85%29.aspx) 这是有关在您的软件中使用高端计时器的微软信息。通常，计时器将循环退出并不同步。本文介绍了两个计时器，高分辨率计时器和可等待计时器对象。高分辨率是我用于模拟器的计时器变体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T10:08:47.193

据我从代码中了解到，您正在做出决定

```
 f_DeltaTicks := timeGetTime - f_Time0; 
```

f_Time0 变量在循环的稍后阶段被初始化。

```
 f_Time0 := timeGetTime; 
```

可能存在一个简单的错误，即 f_Time0 在第一次进入循环时未按照您想要/要求的方式进行初始化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-11T14:14:02.183

如果您使用的是 DirectX，最好在需要时打开数学准确性，并在不需要时将其关闭。

```
uses Math;

var pm: TFPUPrecisionMode;
begin
   pm: = GetPrecisionMode;
   try
     SetPrecisionMode (pmExtended)
.
.
.
   finally
     SetPrecisionMode (pm);
   end
end; 
```

Direct X 和一些显卡驱动需要这个并且可能会抛出错误：Invalid floating point operation

# sql-server - 存储过程中多个选择查询中的行数 - T-SQL

> ID：12148314
> 
> 赞同：0
> 
> 时间：2012-08-27T19:27:31.917
> 
> 标签：sql-server, tsql

即使数据库有匹配的记录，以下存储过程也不会返回任何内容。`Rowcount`是问题吗？有人请帮忙吗？

```
ALTER PROCEDURE [dbo].[Usp_get_product_rates]
  -- Add the parameters for the stored procedure here
  @pcat1 CHAR(3),
  @pcat2 CHAR(3),
  @pcat3 CHAR(1)
AS
  BEGIN
      -- SET NOCOUNT ON added to prevent extra result sets from
      -- interfering with SELECT statements.
      SET NOCOUNT ON

      SELECT b.pcat1,
             b.pcat2,
             pcat3,
             rate1,
             rate2
      FROM   Product_Rates AS a
             JOIN Master_Rates AS b
               ON a.pon = b.pon
      WHERE  b.pcat1 = @pcat1
             AND b.pcat2 = @pcat2
             AND pcat3 = 'P'

      IF @@RowCount = 0
        BEGIN
            SELECT b.npa,
                   b.nxx,
                   blockid,
                   Inter_state_rate,
                   Intra_state_rate
            FROM   Rates_STF2 AS a
                   JOIN TPM AS b
                     ON a.pon = b.pon
            WHERE  b.pcat1 = @pcat1
                   AND b.pcat2 = @pcat2
                   AND pcat3 = '@pcat3'
        END
  END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:07:45.107

可能会改变这个

```
pcat3 = '@pcat3' 
```

对此

```
pcat3 = @pcat3 
```

在你的 where 子句中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:34:59.723

我认为你应该这样做：

```
If NOT Exists (select 1 from Product_Rates as a join Master_Rates as b on a.pon = b.pon where b.pcat1 = @pcat1 and b.pcat2 = @pcat2 and  pcat3 = 'P' )  
BEGIN
    select b.npa,b.nxx,blockid,Inter_state_rate,Intra_state_rate from Rates_STF2 as a join TPM
    as b on a.pon = b.pon  
    where b.pcat1 = @pcat1 and b.pcat2 = @pcat2 and  pcat3 = @pcat3
END 
```

# javascript - 在javascript中创建对象的动态数组

> ID：12148317
> 
> 赞同：0
> 
> 时间：2012-08-27T19:28:01.910
> 
> 标签：javascript, arrays

我想用这样的行创建数组：

```
 dateMetric : [{date : DatNoDuplicate[i] , ClickCount : 0 , Retweet : 0 , LikeCount : 0 , ShareCount : 0, Tweet : 0, CommentCount: 0, SumMetric: 0}, 
           {date : DatNoDuplicate[i] , ClickCount : 0 , Retweet : 0 , LikeCount : 0 , ShareCount : 0, Tweet : 0, CommentCount: 0, SumMetric: 0}, 
          ] 
```

但是行中的属性（ClickCount，Retweet，LikeCount，ShareCount，Tweet，CommentCount）将从其他数组中定义，

数组 nameMetric 包含此行名称(( ClickCount, Retweet, LikeCount, ...)

因此，如果在 nameMetric 中有元素（likeNumber，TweetNumber，.....），则数组 dateMetric 将包含如下行：

日期度量

```
 date : DatNoDuplicate[i] , likeNumber: 0 , TweetNumber: 0 , ... , SumMetric: 0}) 
```

请帮忙，如果没有很好地解释，我可以重新提出问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:37:37.100

试试这个：http: [//jsfiddle.net/8cetN/](http://jsfiddle.net/8cetN/)

您可以查找您的名称数组来定义每个行对象的属性：

```
var nameMetric = ["ClickCount", "Retweet", "LikeCount", "ShareCount", "Tweet", "CommentCount", "SumMetric"];

var numRows = 4;
var dateMetric = [];

for (var i=0; i<numRows; i++) {

    var row ={};

    nameMetric.forEach(function(name){

        row[name] = 0; // Look up and place the actual value here.   

    });       

    dateMetric.push(row); 

}

console.log(JSON.stringify(dateMetric)); 
```

# performance - 如何加快更新许多单元格的 OpenOffice Calc 宏？

> ID：12148323
> 
> 赞同：4
> 
> 时间：2012-08-27T19:28:20.890
> 
> 标签：performance, openoffice-calc, openoffice-basic

我有一个 OpenOffice Calc 宏（在 Basic 中），它将活动工作表中的所有数字四舍五入到给定的小数位数。处理 9000 行电子表格的 100 行大约需要 4 秒。每行有 35 列，其中 19 列是数字。

我怎样才能使它执行得更快？这是我为 OpenOffice 编写的第一个宏，因此很可能有我从未听说过的更快的方法。这是我的代码：

```
Dim oFunction as Object 

' Round all Value cells (cells that do not contain Text or Functions) on the current sheet to as many decimal places as user requests.
Sub RoundUsedCells

Dim  oSheet As Object, oUsedRange as Object, oCursor as Object, oCell As Object
Dim row, column,lastRow, lastColumn
Dim places$, placesToRound
Dim roundedValue as Double

' Ask user how many decimal places to round
places$ = InputBox ("Round to how many places (leave blank to cancel)?")
if (places$ is Nothing or places$ = "") then
    ' Do nothing.
else
    placesToRound = CInt(places$)

    ' Get the currently active sheet.
    oSheet = thiscomponent.getcurrentcontroller.activesheet

    ' Create a one cell range at the origin,
    ' then create a cursor that allows us to extend the range to include all the "used" cells.
    ' The cursor will then allow us to find out how large is that used range.
    oUsedRange = oSheet.getCellRangeByPosition(0,0,0,0)
    oCursor = oSheet.createCursorByRange(oUsedRange)
    oCursor.GotoEndOfUsedArea(false)    

    ' Obtain the last rows and colums in the "used" range from the cursor.
    lastRow = oCursor.RangeAddress.EndRow  
    lastColumn = oCursor.RangeAddress.EndColumn 

    ' Loop through all cells from the origin (0,0) to the last used column and row.
    for row = 0 to lastRow
        if (row mod 50 = 0) then
            StatusBar "Rounding row " + (row + 1) + " of " + (lastRow + 1) + "..."
        endif
        for column = 0 to lastColumn
            oCell = oSheet.getCellByPosition(column, row)
            Select Case oCell.Type 
                Case com.sun.star.table.CellContentType.VALUE
                   ' Only round value cells. Skip over empty cells, formuls and text.
                   roundedValue = Round(oCell.Value, placesToRound)
                   if (roundedValue <> oCell.Value) then
                        oCell.Value = roundedValue
                   endif
                Case com.sun.star.table.CellContentType.EMPTY 
                Case com.sun.star.table.CellContentType.TEXT       
                Case com.sun.star.table.CellContentType.FORMULA

            End Select  
        next column
    next row
    StatusBar "Rounding complete."
endif
End Sub

' Obtain access to worksheet functions, such as the "round" function.
Sub InitRound 
    if (oFunction is Nothing) then
        oFunction = createUnoService("com.sun.star.sheet.FunctionAccess") 
    endif
End Sub 

' Round the value to the given number of places after the decimal.
Function Round(value, decimalPlaces) 
   InitRound() 
   Dim args( 1 to 2 ) As Variant 
   args(1) = value 
   args(2) = decimalPlaces 
   Round = oFunction.callFunction( "round", args() ) 
End Function

global vStatusBarText as string '=text that is been displayed on the statusbar
sub StatusBar(optional vNewText, optional vAddText) 'set or add text to the statusbar, nothing = clear&reset it.
   if isError(vNewText) then
      if isError(vAddText) then 'clear statusbar
         vStatusBarText=""
      else 'add text to the previous statusbar
         vStatusBarText=vStatusBarText & vAddText 
      endif
   else
      if isError(vAddText) then 'use new text
         vStatusBarText=vNewText
      else 'use new text and add the other text as well
         vStatusBarText=vNewText & vAddText
      endif
   endif
   vStatusBarText=right(vStatusBarText,int(ThisComponent.CurrentController.VisibleArea.Width/150)) 'Select last part that could be displayed.
   if isNull(ThisComponent.CurrentController) then exit sub 'Because the last XEventListener-event can't be written to the statusbar, because it's no longer there!
   if vStatusBarText="" then 'reset statusbar
      ThisComponent.CurrentController.StatusIndicator.Reset
   else 'change the text in the statusbar
      ThisComponent.CurrentController.StatusIndicator.Start(vStatusBarText,0)
   endif
end sub 
```

更新：我重写了 Round 以不调用 Calc，这使速度翻了一番。它仍然太慢了。必须比每秒 50 行好得多。

```
Function Round2(value, decimalPlaces) as Double
    Round2 = Int(value * 10 ^ decimalPlaces + 0.5) / 10 ^ decimalPlaces
   'Dim multiplier as Double, bigValue as Double
   'multiplier = 10 ^ decimalPlaces
   'bigValue = (value * multiplier) + 0.5
   'Round2 = CDbl( CLng(bigValue) ) / multiplier  
End Function 
```

更新 2：

找到了一种在宏执行期间禁用自动更新和屏幕刷新的方法，这再次将速度提高了三倍（现在是每秒 200 行）：

```
myDoc = ThisComponent
myDoc.lockControllers()
myDoc.addActionLock()
' --- modify your cells here ---
myDoc.removeActionLock()
myDoc.unlockControllers() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-13T17:07:34.890

我的计时测试表明您最大的问题是您一次访问一个单元格。我的测试表明，有两种方法可以显着增加此类操作。

最有效的方法是使用一些本地工具来做到这一点；例如，将显示样式设置为以特定格式显示，如果可能的话，将在指定点处舍入显示。

下一个最佳解决方案是以块的形式获取数据并以块的形式更新数据。您用于获取数据的方法将取决于数据的一致性。例如，getDataArray() 和 setDataArray() 可能比一次查看一个单元格快 100 倍（至少）。这里有两种不同的可能方法：

getData() 将获取数值数据作为嵌套的值序列（数组中的数组）。

getDataArray() 与 getData() 相同，但可以包含 String 或 Double。

# ms-access - 您如何在 Access 2010 中的各个子窗体中保持记录的一致性？

> ID：12148328
> 
> 赞同：1
> 
> 时间：2012-08-27T19:28:36.183
> 
> 标签：ms-access, ms-access-2010, subform

我有一个表单被分成多个不同的子表单，我想在不改变我正在查看的记录的情况下自由切换。更具体地说，我在“基本信息”选项卡上选择要修改的记录，然后当我切换到其他选项卡时——比如我的“成本”选项卡——我希望选择相同的记录。如何在 Access 2010 中执行此操作？如何使用弹出菜单来做到这一点？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T00:58:59.390

Access（实际上是大多数软件）中最常见的方法是使用选项卡控件。

因此，您使用一个主记录构建表单的顶部，然后对于几个子表单，您只需放入一个选项卡控件。这是访问屏幕截图：

![在此处输入图像描述](../Images/b9c0055cb23e536ea13fb4b404bb3a86.png)

这是另一个 Access 屏幕截图：

![在此处输入图像描述](../Images/0edf6bbc2098dfcd91a71dc4cda3df07.png)

当我单击另一个选项卡时，您会看到：

![在此处输入图像描述](../Images/c2991de23f69f871db536d0085286f36.png)

因此，您在选项卡控件上显示的子表单可以是固定表单，甚至可以是连续表单——这确实是您的选择。

这确实是一个非常基本和常见的设置。如前所述，好的部分是这样的 UI 不需要您编写任何代码。如前所述，您可以在添加的每个选项卡后面自由放置控件，但您也可以在每个选项卡后面自由放置子表单以显示该子信息。表单的“main”部分不会改变，可以继续显示“main”reocrd信息。

请注意，我们谈论的是使用选项卡控件。像这个：

![在此处输入图像描述](../Images/35d9c3ed78555888e362237af1e81fd8.png)

# python - 芹菜/烧瓶；从开发到生产

> ID：12148332
> 
> 赞同：4
> 
> 时间：2012-08-27T19:28:53.603
> 
> 标签：python, web-services, web-applications, flask, celery

我有一个烧瓶应用程序，我使用 celery 作为任务队列。我有一个通过如下所示的小脚本运行良好的开发版本：

```
from celery import Celery
from settings import REDIS_URL as redis_url

from tasks import *

celery = Celery('my_tasks',
                broker = redis_url,
                backend = redis_url )

if __name__ == "__main__":
    celery.start() 
```

这对于开发目的来说效果很好，但是现在我已经开始研究是否要改进它以进行部署，并开始阅读有关 celeryd 等的信息。

如果上述内容仅用于测试和开发以及如何在生产环境中使用 celery，则最简单的问题是开始。我还将几个烧瓶应用程序集成到一个更大的应用程序中，每个应用程序都有自己的类似于上面的脚本。如何为此提炼 celery 目前还不是很清楚，我对其他在生产环境中使用烧瓶部署 celery 的人的意见很感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:26:48.857

我认为你需要对这个脚本进行适当的妖魔化，在官方文档网站上有很好的文档：http: [//celery.github.com/celery/cookbook/daemonizing.html](http://celery.github.com/celery/cookbook/daemonizing.html)

我真的建议你看看这个工作的主管（妖魔化像你这样的脚本需要不超过 5 分钟）。

# backbone.js - 使用主干管理服务器错误响应

> ID：12148333
> 
> 赞同：19
> 
> 时间：2012-08-27T19:28:58.953
> 
> 标签：backbone.js, error-handling

我想知道在新模型、更新模型或删除模型上管理服务器错误响应的最佳方法。此时服务器返回一个http状态码#400。但是Backbone中的默认错误处理程序没有显示错误。

我怎样才能显示这些错误？

当服务器端验证失败时，服务器返回 http 错误标头可以吗？（也许更好地返回带有 status='ERROR' 消息的成功响应）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-27T23:30:43.713

如果您返回的 http 状态不是 2XX，那么您已经完成了一半的工作。:-) 基本上，您可以做的就是将您想要的任何内容作为响应发回。

例如，您可能只发回如下内容：

```
// Send back http status 500
echo 'Could not save, server error'; 
```

500 状态将触发 Backbone 错误回调，并且您的响应是一个 jqXHR 对象。在上面的示例中，您可以通过在错误回调中执行类似的操作来获取消息。

```
model.save({},{
    error: function(model, response) {
        console.log(response.responseText);
    }
}); 
```

这是获取有关服务器端发生的错误的一些数据/消息的最简单方法。当然，您可以创建更复杂的数据以从服务器返回：

```
// I'm using SLIM RESTful framework...
$dataOut = array('error'=>'Validation type', 'message'=>'Did not validate');
$response->body(json_encode($dataOut)); 
```

以同样的方式，您可以像这样访问该响应：

```
model.save({},{
    error: function(model, response) {
        var responseObj = $.parseJSON(response.responseText);
        console.log('Type: ' + responseObj.error + ' Message: ' + responseObj.message);
    }
}); 
```

或类似的规定。

因为传递给错误回调的响应是 jqXHR 对象，所以您可以完全访问它的所有可能要使用的属性：

```
E.g.
response.readyState
response.status
response.statusText // etc. 
```

Backbone 只需要从服务器返回的 http 状态就可以完成它的工作。

# android - 迁移到 GCM 但仍有 C2DM 注册 ID

> ID：12148334
> 
> 赞同：0
> 
> 时间：2012-08-27T19:29:04.713
> 
> 标签：android, android-c2dm, google-cloud-messaging

我正在将我的 android 应用程序从 C2DM 迁移到 GCM。我有服务器端设置来接收两者，并指示 GCM 与 C2DM 的 ID，然后在服务器端，我根据注册的服务通过适当的服务发送出去。

我遇到的问题是应用程序正在向我的服务器注册为 GCM（应用程序更新以在意图中使用新的发件人 ID。）但是不幸的是，它传递给服务器以获取注册 ID 的 ID 实际上是旧的 C2DM ID。

作为此迁移的一部分（在应用程序代码中），我需要做些什么来确保我获得一个新的 (GCM) ID，而不是继续使用现有的 C2DM 注册 ID。这对我来说很容易测试和重现，并且每次都能得到一致的结果（来自 GCM 服务器的 MisMatchedSenderId）。我需要先注销 C2DM id 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T13:17:45.100

您必须更新您的客户端代码以发送 Google API 项目 ID 而不是电子邮件地址作为发件人 ID。

[GCM 入门指南](http://developer.android.com/guide/google/gcm/gs.html)中提供了有关如何获取 Google API 项目 ID 的说明。

这是我从[迁移指南](http://developer.android.com/guide/google/gcm/c2dm.html#client)复制的示例代码更改：

```
Intent registrationIntent = new Intent("com.google.android.c2dm.intent.REGISTER");
// sets the app name in the intent
registrationIntent.putExtra("app", PendingIntent.getBroadcast(this, 0, new Intent(), 0));
registrationIntent.putExtra("sender", senderID);
startService(registrationIntent);
```

在我的例子中，senderID 实际上是从 strings.xml 中读取的，所以我必须用 Google API 项目 ID 替换那里的电子邮件地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T17:44:30.517

我们能够找出问题所在，因为该设备已经有一个注册 ID（c2dm），它甚至没有尝试使用新的 senderId（用于 gcm）访问注册服务器，因此它使用的是旧的 c2dm 注册ID。感谢您的评论

# php - 我需要遍历一个 JSON 数组 - 不知道该怎么做 - 已经搜索但仍然无法获得线索

> ID：12148338
> 
> 赞同：0
> 
> 时间：2012-08-27T19:29:28.127
> 
> 标签：php, javascript, jquery, json

我有一个从 php 获取的 JSON 数组：

```
"{\"GUINNESS\":[\"Food\",\"Gifting\",\"Merchandise\"]}" 
```

在 Jquery 我有 -

```
$.getJSON("menu_processing.php",function(json) {
  $.each(json,function(index,val) {
 $("ul.navlist").append('<li id="'+index+'" class="list">'+val+'</li>');    
    });  

}); 
```

我想将吉尼斯作为顶层，并将嵌套数组作为子层处理 -

我在想类似的事情：

```
$.each(json,function(index,val) {
    // print the top level 
    $.each(json,function(key,val) {
        // print the sub level
});}); 
```

但我仍然不知道如何在 jquery 中解决这个问题 - 非常感谢任何帮助或指针。我试着在这里搜索一些东西，但没有任何线索让我知道如何去做。我什至在 jquery 的正确轨道上吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:32:58.663

`$.getJSON`为您解析 JSON。要获取`GUINNESS`对象的属性 - 数组 - 您可以使用普通的[点表示法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Member_Operators)：

```
$.getJSON("menu_processing.php",function(json) {
    var ul = $("ul.navlist");
    $.each(json.GUINNESS, function(i, val) {
//             ^^^^^^^^^
        ul.append('<li class="list">'+val+'</li>');    
    });
}); 
```

如果您不知道顶部对象中的属性名称（如`"GUINESS"`），您可以使用 double each（或更简单的 for 循环），正如您猜对的那样：

```
$.getJSON("menu_processing.php",function(json) {
    var ul = $("ul.navlist");
    $.each(json, function(name, val) {
        // name === "GUINNESS"
        // val is the array
        $.each(val, function(name, subval) {
            ul.append('<li class="list">'+subval+'</li>');    
    });
}); 
```

与普通循环语法相同：

```
// …
    for (var name in json) {
        var val = json[name];
        for (var i=0; i<val.length; i++) {
            var subval = val[i];
            // do something
        }
    }
// … 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:34:31.093

你想遍历 json.GUINESS 属性，它是一个数组，而不是 json，它是一个被 .getJSON 方法解析后的对象：

```
$.each(json.GUINESS, function (index, val) {
    $('ul.navlist').append('<li id="' + index + '" class="list">' + val + '</li>');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T19:33:29.887

只需将 JSON 变量重新分配为`GUINNESS`值；

```
$.getJSON("menu_processing.php",function(json) {
    json = json.GUINNESS
    $.each(json,function(index,val) {
        $("ul.navlist").append('<li id="'+index+'" class="list">'+val+'</li>');    
    });  
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T19:49:34.633

尝试这样的事情：

```
$.each(json, function() {
    // You access the values using this.somearraykey
    if(isArray(this.somearraykey)){ // If you need to check if it is a multidimentional array
        $items = [];

        // More iterating
        $.each(this.somevalue, function(){
            // Push the values into some structure
            $items.push('<li id="' + this.whatever + '">' + this.somevalue + ' ' + this.someothervalue'</li>');
        });

        $joined = '<ul>' + $items.join('') + '</ul>';
    } else{
        $joined  = '';
    }

    $newitem = [];
    $newitem.push('<li>' + this.someotherarraykey + $joined + '</li>'); // push, push.. 
    $('#placeholderOrWhatever').html('<ul>' + $newitem.join('') + '</ul>');
}); 
```

您应该关注的事情（至少就我而言）是`.push`（数组推送）和`.join`

**编辑：**您当然需要此功能才能使其工作：

```
function isArray(what) {
    return Object.prototype.toString.call(what) === '[object Array]';
} 
```

# c# - 如何将 Excel 列 A、B 和 C 读入 C# 数据结构（向量、数组、列表？）

> ID：12148340
> 
> 赞同：0
> 
> 时间：2012-08-27T19:29:30.610
> 
> 标签：c#, input

我正在自学使用 Visual C# 2010，但我不知道使用什么数据结构来存储 Excel 工作表中的 3 列数据。

A 列包含人的姓名（字符串），B 列包含人的年龄（整数），C 列包含人的电话号码（字符串）。如何将其存储到 C# 中的数据结构中？

在 C++ 中，我记得创建了一个可以容纳一堆不同数据类型的向量......我如何在 C# 中做同样的事情？我读过 C# 中不使用向量。我应该使用数组还是列表？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:39:51.047

C++ 的概念`vector`在功能上大致等同于`List<T>`C# 中的泛型类。

正如 SLaks 所说，最好的解决方案是，如果您知道类型并且每组三列都是表中的一个“行”，那么最好的解决方案是创建一个包含 A、B 和 C 列的简单类，然后创建一个列表那些：

```
public class ExcelData
{
   public string PersonName {get;set;}
   public int Age {get;set;}
   public string PhoneNumber {get;set;}
}

public List<ExcelData> fromExcel = new List<ExcelData>();

fromExcel.Add(new ExcelData
                  {
                     PersonName = "Joe Smith", 
                     Age = 34, 
                     PhoneNumber = "(123) 456-7890"
                  }); 
```

如果您使用的是 .NET 4（因为您使用的是 VS 2010，所以您应该使用），有一个 class `Tuple`，它有几个通用重载和一个静态帮助器来创建它们：

```
public List<Tuple<string, int, string>> fromExcel = new List<Tuple<string, int, string>>();

...

fromExcel.Add(Tuple.Create("Joe Smith", 34, "(123) 456-7890")); 
```

好处是内置的、灵活的类；缺点是元组非常通用，因此它的列名也同样通用；项目 1、项目 2 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:33:06.193

您可以创建自己的课程

```
public class Person
{
    public string name {get; set;}
    public int age {get; set;}
    public string phone {get; set;}
} 
```

并使用此类的 ArrayList 或 List。您还可以在此处了解如何读取 Excel 数据：[如何使用 C# 读取 Excel 文件的数据？](https://stackoverflow.com/questions/657131/how-to-read-data-of-an-excel-file-using-c)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T19:42:11.860

您需要做的是阅读一些可用于此类操作的库命令。我包括了一些我在下面使用的样式，以及手动设置框内容等。有几种方法可以做你想做的事。向量仍然存在于 C# 中。我建议将信息存储在向量或数组中，然后遍历该向量或数组以填充您的 Excel 工作表。（复合格式很可能是最简单的）

希望这会有所帮助！干杯!

```
//using Microsoft.Office.Interop.Excel;

/*
                //WRITE DATA FROM TABLES TO AN EXCEL SHEET
                Application excelapp = new Application();

                excelapp.Visible = true;
                //Range range = excelapp.Application.get_Range("A1", "C1"); 

                _Workbook workbook = (_Workbook)(excelapp.Workbooks.Add(Type.Missing));
                _Worksheet worksheet = (_Worksheet)workbook.ActiveSheet;

                worksheet.Cells[1, 1].Style.Font.Bold = true;

                worksheet.Cells[1, 1] = "Brochure Fares";
                worksheet.Cells[1, 2] = "Cruise Only Fares";
                worksheet.Cells[1, 3] = "Port, Security & Handling";

                //worksheet.Cells.Style.Font.Bold = false;

                //worksheet.Cells[1,1].Style.Selection = "Check Cell";
                //worksheet.Range("B1").Selection = "Check Cell"; 
                worksheet.Cells[1, 1].ColumnWidth = 20;
                worksheet.Cells[1, 2].ColumnWidth = 20;
                worksheet.Cells[1, 3].ColumnWidth = 25;

                //worksheet.get_Range("A1", "D1").VerticalAlignment.Center = true; 
                //worksheet.get_Range("A1", "C1").VerticalAlignment = ; 
                //worksheet.Cells[1,1].VerticalAlignment.Center = true;

                //worksheet.Cells[1, 1].mergeandcenter = true;
                //worksheet.Cells[1, 1].wraptext = true; 

                excelapp.UserControl = true;

                workbook.SaveAs(@"TestSheet");
                workbook.Close();
                excelapp.Visible = false; 
                */ 
```

# android - 将 onPostExecute 结果传递给新的 Activity

> ID：12148341
> 
> 赞同：1
> 
> 时间：2012-08-27T19:29:35.920
> 
> 标签：android, json, android-activity

我使用异步调用编写了一个启动活动，以从 URL 下载 JSON。`onPostExecute`结果我得到了JSON 。 现在我需要将该 JSON 传递给一个新活动以解析并以`listView`. 我是否需要在通过 JSON 之前或之后开始该新活动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:37:15.617

您可以在开始新活动之前使用`putExtra`in使生成的 JSON 可用于新活动。`onPostExecute`

```
Intent intent = new Intent(this, yourClass.class);
intent.putExtra("json", json);
// Now start your activity 
```

然后，您可以通过调用`getString`新活动来获取 json。

```
Bundle extras = getIntent().getExtras();
jsonString = extras.getString("json"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:38:33.557

从 JSON 对象（字符串、int 等）中提取数据后，将其作为额外对象传递给意图

```
Intent intent = new Intent(view.getContext(),ResultsActivity.class);
intent.putExtra("extraname", "extravalue");
intent.putExtra("extraname2", 9.99);
startActivity(intent); 
```

然后在您新创建的活动上

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_results);
String extra = getIntent().getStringExtra("extraname") //returns null if nothing
Double extra2 = getIntent().getDoubleExtra("extraname2") 
```

# python - 多列表排序，每列自定义排序

> ID：12148343
> 
> 赞同：0
> 
> 时间：2012-08-27T19:29:58.630
> 
> 标签：python

我有一个多列数据表，每一行都是唯一的，我想知道如何根据多列对其进行排序。[如果按字母顺序排序，这里](http://www.saltycrane.com/blog/2007/12/how-to-sort-table-by-columns-in-python/)已经描述了一个解决方案。但是，我需要根据存储在另一个列表中的自定义顺序对每一列进行排序，而不是按字母排序。例如，如果我的表是

```
mytable = [
    ('A1', 'B1', 'C1'),
    ('A1', 'B2', 'C2'),
    ('A2', 'B2', 'C1'),
    ('A2', 'B2', 'C2')
] 
```

我可能希望第一列排序 ['A2','A1']，第二列排序 ['B1','B2']，第三列排序 ['C2','C1' ]。正确的结果是

```
mytable = [
    ('A2', 'B2', 'C2'),
    ('A2', 'B2', 'C1'),
    ('A1', 'B1', 'C1'),
    ('A1', 'B2', 'C2')
] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:36:48.097

这将满足您的需求：

```
orderings = (
    ('A2', 'A1'),
    ('B1', 'B2'),
    ('C2', 'C1')
)

orders = [dict([(v, i) for i, v in enumerate(o)]) for o in orderings]

mytable.sort(key=lambda r: tuple(o[c] for c, o in zip(r, orders))) 
```

在实践中，列可能不会全部排序，或者可能按左右顺序以外的优先级排序。这可以通过为每个索引附加一个索引并相应地调整算法来解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:35:39.550

Python 默认按字典顺序对元组进行排序。这意味着您需要做的就是编写一个再次返回元组的键函数。示例代码：

```
order_a = {"A1": 1, "A2": 0}
order_b = {"B1": 0, "B2": 1}
order_c = {"C1": 1, "C2": 0}

def key(t):
    return order_a[t[0]], order_b[t[1]], order_c[t[2]]

mytable.sort(key=key) 
```

（我在这里使用字典而不是列表来定义顺序，因为这将为大量可能值带来更好的性能。）

# c++ - #pragma once 的便携式替代品

> ID：12148348
> 
> 赞同：10
> 
> 时间：2012-08-27T19:30:35.040
> 
> 标签：c++, c, pragma

有人可以告诉我`#pragma once`为各种编译器提供指令支持的解决方法吗？

我想在我的标题中使用如下内容：

```
#if _MSC_VER > ... || __GNUC__ > ... || ...

#pragma once

#endif 
```

也许它已经存在于提升源或您的代码中？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-27T19:32:10.037

使用[包括警卫](https://stackoverflow.com/a/10990521/275567)：

```
#ifndef MY_HEADER_H
#define MY_HEADER_H

// ...

#endif    // MY_HEADER_H 
```

有时你会看到这些结合使用`#pragma once`：

```
#pragma once

#ifndef MY_HEADER_H
#define MY_HEADER_H

// ...

#endif    // MY_HEADER_H 
```

`#pragma once`得到相当[广泛的支持](http://en.wikipedia.org/wiki/Pragma_once#Portability)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-27T19:31:15.337

`#pragma once`是包含警卫的非标准替代方案：

```
#ifndef HEADER_H
#define HEADER_H

//contents of header

#endif 
```

两者都确保标题内容不会在同一个翻译单元中多次粘贴。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-01-28T00:28:28.427

我自己喜欢使用传统**的包含警卫**（如接受的答案所建议的那样）。这实际上并没有那么多工作，而且您获得了 100% 可移植性的好处。如果您正在编写库、发布代码示例等，最好使用老式语法以避免其他人遇到麻烦。

也就是说，这里的其他人也指出，*绝大多数*现代编译器都尊重该`#pragma once`指令，因此您在自己的项目中使用它的可能性相对较小。

维基百科有一个支持该指令的编译器列表：

[https://en.wikipedia.org/wiki/Pragma_once#Portability](https://en.wikipedia.org/wiki/Pragma_once#Portability)

# python - 在numpy中使用旋转矩阵有效地旋转一组点

> ID：12148351
> 
> 赞同：23
> 
> 时间：2012-08-27T19:30:57.667
> 
> 标签：python, numpy, rotation, vectorization

我有一个存储在 numpy 数组中的 3D 点列表，`A`其中 shape`(N,3)`和旋转矩阵`R`shape `(3,3)`。我想就地计算`R.x`每个点`x`的点积。`A`天真地我可以这样做：

```
for n in xrange(N):
    A[n,:] = dot(R, A[n,:]) 
```

有没有办法通过本机 numpy 调用对其进行矢量化？如果重要的话，N 大约是几千。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-27T19:41:25.070

您可以将 A 与旋转矩阵的转置相乘：

```
A = dot(A, R.T) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-12-09T11:02:18.963

在 Aapo Kyrola 的（正确）答案中添加了一些小的更新/澄清点。首先，使用最近添加的矩阵乘法运算符可以稍微简化矩阵乘法的语法`@`：

```
A = A @ R.T 
```

`A`此外，您可以通过在乘法之前进行转置，然后转置结果来安排标准形式的转换（首先是旋转矩阵） ：

```
A = (R @ A.T).T 
```

您可以通过以下断言检查两种形式的转换是否产生相同的结果：

```
np.testing.assert_array_equal((R @ A.T).T, A @ R.T) 
```

# linux - postgresql-contrib 安装后 dblink.sql 不存在

> ID：12148355
> 
> 赞同：4
> 
> 时间：2012-08-27T19:31:03.433
> 
> 标签：linux, postgresql, centos

在我将 dblink.sql 执行到我的两个 Postgres 数据库后不久，我就能够成功地将 postgresql-contrib 安装到我的一台服务器上。安装 postgresql-contrib 后，我在以下位置找到了 dblink.sql：

```
/usr/share/pgsql/contrib/dblink.sql 
```

现在，我正在尝试在另一台服务器上做同样的事情。然而，在安装 postgresql-contrib 之后，我找不到任何 db.sql 实例。两台服务器都运行 CentOS 6.2 和 PostgreSQL 9.1，尽管第二台服务器上的 PostgreSQL 安装位于另一个目录中：

```
PGENGINE=/usr/pgsql-9.1/bin
PGPORT=5432
PGDATA=/var/lib/pgsql/9.1/data
PGLOG=/var/lib/pgsql/9.1/pgstartup.log 
```

当我执行“定位 dblink”时，我收到以下信息：

```
[root@dev-postgres dblink]# locate dblink
/usr/lib/debug/usr/pgsql-9.1/lib/dblink.so.debug
/usr/pgsql-9.1/share/man/man3/dblink.3
/usr/pgsql-9.1/share/man/man3/dblink_build_sql_delete.3
/usr/pgsql-9.1/share/man/man3/dblink_build_sql_insert.3
/usr/pgsql-9.1/share/man/man3/dblink_build_sql_update.3
/usr/pgsql-9.1/share/man/man3/dblink_cancel_query.3
/usr/pgsql-9.1/share/man/man3/dblink_close.3
/usr/pgsql-9.1/share/man/man3/dblink_connect.3
/usr/pgsql-9.1/share/man/man3/dblink_connect_u.3
/usr/pgsql-9.1/share/man/man3/dblink_disconnect.3
/usr/pgsql-9.1/share/man/man3/dblink_error_message.3
/usr/pgsql-9.1/share/man/man3/dblink_exec.3
/usr/pgsql-9.1/share/man/man3/dblink_fetch.3
/usr/pgsql-9.1/share/man/man3/dblink_get_connections.3
/usr/pgsql-9.1/share/man/man3/dblink_get_notify.3
/usr/pgsql-9.1/share/man/man3/dblink_get_pkey.3
/usr/pgsql-9.1/share/man/man3/dblink_get_result.3
/usr/pgsql-9.1/share/man/man3/dblink_is_busy.3
/usr/pgsql-9.1/share/man/man3/dblink_open.3
/usr/pgsql-9.1/share/man/man3/dblink_send_query.3
/usr/src/debug/postgresql-9.1.4/contrib/dblink
/usr/src/debug/postgresql-9.1.4/contrib/dblink/dblink.c 
```

...没有 dblink.sql。有谁知道我可以在这里做什么？我是否必须以某种方式构建 sql 文件？如果是这样，你知道我该怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T22:27:19.500

它应该在 9.1 中作为扩展捆绑在一起

[http://www.postgresql.org/docs/current/static/contrib.html](http://www.postgresql.org/docs/current/static/contrib.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T06:02:01.190

Just as a note, the shift to the extension system in 9.1 is a much needed change, but it causes a lot of headaches for many people actually trying to support multiple versions of PostgreSQL while relying on contrib modules. We have struggled with this on LedgerSMB 1.3 for months.

A lot of stuff can change between major versions of the software. I highly recommend following the release notes in major versions *carefully* before updating or just assuming everything will be the same. These are long, complicated documents but they ought to give you an idea of where you will run into problems and where you need to further check the new docs. If you are testing a deployment first (always a good idea!) it will also give you a much better idea of where to spend extra effort testing.

# css - 复制时浮动内容似乎堆叠 - CSS

> ID：12148356
> 
> 赞同：0
> 
> 时间：2012-08-27T19:31:07.693
> 
> 标签：css, css-float, fluid-layout

这是一个小提琴：http: [//jsfiddle.net/Kd4De/2/](http://jsfiddle.net/Kd4De/2/)。

我已经将内容复制了 3 次，如您所见，它似乎`into`在每次复制时都相互堆叠。我的预期效果是让每个重复看起来都与前一个完全相同（都具有相同的宽度）。

我有一种感觉，因为我只浮动一个`div`而不是另一个，但这是确保非浮动的流体宽度所必需的`div`。

如何解决此问题以确保每个重复项之间的一致性同时保持流动性（即，如果我动态更改 to 的宽度`.dynamo_shop_holder`，`90%`则内容会动态更改以适应？我根本不想使用 JavaScript。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:57:09.760

```
overflow: hidden; 
```

the overflow attribute tells the browser how to display content that goes beyond the bounds of the container. Some browsers render the content strangely and assume that the parent div has a set height or if empty no height, causing the child or floated divs to appear outside and in your case stack. Overflow hidden is supposed to hide anything that flows outside of the container, but in these cases it allows that parent container to recognize the content that should be within it and display correctly.

I can't see the jsfiddle so not sure what your display looks like, but often overflow: hidden or overflow:auto will allow the divs to correctly handle the contained content.

# javascript - 外部 js 文件中的谷歌分析

> ID：12148359
> 
> 赞同：0
> 
> 时间：2012-08-27T19:31:12.337
> 
> 标签：javascript, google-analytics

我知道谷歌明确建议在头脑中调用内联分析。但是，在外部文件中调用它有什么潜在的陷阱吗？

我已经为 chrome 安装了 Google Analytics Debugger，一切正常。我在页面头部的外部 js 文件中调用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:43:33.670

这并不是*谷*歌所建议的。

基本上，您可以尽早实例化 GA —— 这就是说：

```
var _gaq = _gaq || []; 
```

其余部分，您可以在页面底部加载。

您甚至可以将其`_gaq =...;`放在页面顶部的外部文件中，然后将其余部分放在底部。

目标是这样的：

Google 一开始就将 _gaq 设为数组。然后您使用数组的`.push(...);`方法将跟踪添加到数组（实际上，您只是添加字符串数组）。

当您在页面底部添加代码的第二部分时，它将数组内部的数据保存`_gaq`到保存数组中。然后它变成`_gaq`了一个真实的程序，`.push(...);`从现在开始，在页面上，实际上发送数据等等。

并且在完整文件的初始加载时，`_gaq`将运行推送指令数组并将其转换为服务器调用。

他们建议从`_gaq`页面开始尽可能高的位置，这样您就可以将基于用户的跟踪添加到页面、按钮或其他任何东西……这样当程序最终***加载***到页面底部时，您通过 GA 添加的所有操作`_gaq.push(["_method", "data"]);`将在运行时被 GA 跟踪，因此您不会错过任何事件。

现在，您不想将代码的`_gaq =...`一部分和代码***的***脚本下载部分都放在页面顶部。下载脚本需要一段时间。GA 的做法是正确的，并且是异步加载的，这非常完美……但是您仍然可以通过将后半部分移动到页面底部（或将其放在外部脚本中）来清理它.

所以答案最终是，是的，感觉 100% 自由地将 GA 代码移动到外部脚本中，这不会改变它的运行方式。

但是您仍然应该考虑将外部脚本留`_gaq=...`在顶部（这样如果您正在跟踪自定义事件的用户行为，您可以在页面准备好后立即执行此操作 - 但是为什么将其放在外部脚本中，什么时候加载和执行需要时间，而实际分配需要几微秒，即使在慢速浏览器上也是如此？）。

然后将脚本调用向下移动页面（或将其移动到页面底部引用的外部文件中）。

# java - 无法找到主类。程序将会退出。来自 Eclipse 的错误

> ID：12148371
> 
> 赞同：-2
> 
> 时间：2012-08-27T19:32:03.050
> 
> 标签：java

这个主题的所有以前的帖子都没有帮助我。我正在尝试执行一个简单的 Hello World 程序并出现错误`"Coluld Not Find The Main Class. Program Will Exit"`。请在下面找到我的代码

```
package java.examples;

public class Hello_World {

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        System.out.println("Hello World");
    }

} 
```

我在带有 JDK 1.6.0_16 的 64 位 Windows 7 操作系统上使用 Eclipse Indigo SR2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:09:15.057

您不能将类放在`java.`包中，也不能放在`java.`. 这可以保护核心语言不被以可能破坏核心语言的方式扩展。

使用“重构”将类移动到不同的包中，例如`org.yourname`. 然后您可以从菜单中选择文件，并“作为文件运行”，或者将类设置为项目的“主”类并通过按菜单按钮栏中的启动器按钮运行。

错误不明显（而且似乎是错误的）的原因是您可以编译`java`包和子包中的类；但是，当 JVM 运行时，类加载器将拒绝加载。因此，在您尝试运行它之前，该类似乎没问题。包的重命名应该可以解决您的大部分问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:47:18.817

这与您的实际代码无关。相反，您需要为您的项目设置主类。我个人使用 netbeans，所以我不确定这些步骤是否有帮助。

但是我右键单击我的项目，转到属性。然后运行，并将主类设置为我的主方法。

# firefox - Firefox 渲染：相同的版本，相同的操作系统，不同的结果

> ID：12148378
> 
> 赞同：0
> 
> 时间：2012-08-27T19:32:15.027
> 
> 标签：firefox, layout, render

我正在测试一个站点，并且在相同的操作系统上使用相同的 Firefox 版本得到不同的结果。

此[屏幕截图](https://dl.dropbox.com/u/13663835/firefox.png)在橙色按钮上显示了其中一些问题。它同时显示了在 Windows 7 上全新安装 Firefox 的同一页面的结果（最上面的一个在 Windows Virtual PC 上运行）。

渲染引擎可能有不同的设置吗？你知道为什么会这样吗？有没有办法解决它？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T06:50:37.913

很有可能，图形硬件加速在虚拟机中不可用。这使得 Firefox 使用 GDI 而不是 DirectWrite 进行文本渲染，这意味着文本没有亚像素定位并且字体指标略有不同。因此，如果按钮大小取决于文本的渲染大小，则按钮将出现不同的大小。

您应该能够在`about:support`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:45:11.667

我对虚拟机的体验是，虚拟显示器通常比物理显示器小。当虚拟显示器不处于全屏模式时，自然会有窗框等，因此虚拟显示器自然会变得更小，以适应物理显示器。我不熟悉为什么会这样，但我相信我有时会看到大小略有不同，即使在“全屏模式”下，也就是屏幕截图中使用的模式。

因此，如果虚拟显示器上的按钮实际上更宽，我会感到有些惊讶。“Windows 7”与“Windows 7 (Windows Virtual PC)”的标签是否有可能在屏幕截图上反转？或者，251 与 256 像素标签是否相反？

# svg - 如何在 SVG 中将 90º 旋转文本居中

> ID：12148380
> 
> 赞同：6
> 
> 时间：2012-08-27T19:32:16.897
> 
> 标签：svg, d3.js

使用 D3，我想要一个旋转 -90º 并以 Y 轴为中心的 Y 轴标签。我认为这将是小菜一碟，并写了以下内容：

```
// Y Axis Label
svg.append('svg:text')
    .attr('class', 'y label')
    .attr('text-anchor', 'middle')
    .attr('y', 0)
    .attr('width', height)
    .attr('transform', 'translate(-' + yAxisSpacing + ',' + height + ') rotate(-90)')
    .text('Y Axis Label') 
```

`height`在这种情况下是图表的高度（svg 占据的垂直区域）。上面的代码将`<text>`在图表的左下角呈现一个元素，然后将文本相对于左下角的点居中。`width`不会改变，因此它*不是*居中而是从svg的左下角运行。

我猜想如果`width`等于`height`图表的 ，那么其中的文本将垂直居中。情况似乎并非如此 - 或者 -`display:block`我需要在 SVG 中设置一些魔法类型属性才能在元素`width`上工作。`<text>`

这应该怎么做？

* * *

根据回复，我使用 javascript 路由并将上面的行修改为 (height/2)...

```
.attr('transform', 'translate(-' + yAxisSpacing + ',' + height / 2 + ') rotate(-90)') 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T06:36:22.037

属性对 SVG 1.1 中的`width`<text> 没有影响。文本将围绕由`x`and`y`属性定义的 x,y 位置居中（由于 text-anchor=middle）（如果您不指定它们，它们默认为 0）。之后应用该`transform`属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T22:27:18.500

您可以使用 CSS 转换来做到这一点。将此添加到您的 CSS（通过[http://css3please.com](http://css3please.com/)）：

```
-webkit-transform: rotate(90deg); 
   -moz-transform: rotate(90deg); 
    -ms-transform: rotate(90deg); 
     -o-transform: rotate(90deg); 
        transform: rotate(90deg); 
           filter: progid:DXImageTransform.Microsoft.Matrix(/* IE6–IE9 */
                 M11=6.123031769111886e-17, M12=-1, M21=1, M22=6.123031769111886e-17, sizingMethod='auto expand');
             zoom: 1; 
```

这里的工作示例 - 查看“css”选项卡：http: [//livecoding.io/3492918](http://livecoding.io/3492918)

# android - 覆盖图像以在 Android 应用程序中制作教程

> ID：12148381
> 
> 赞同：32
> 
> 时间：2012-08-27T19:32:25.573
> 
> 标签：android, overlay, showcaseview

在许多应用程序中，我看到有一个欢迎屏幕或教程，通过在活动顶部覆盖解释来解释应用程序的工作原理。例如，在 Android 本身中，带有“让自己回家”的欢迎屏幕。

我想知道可以使用哪些技术。

*编辑*：“让自己回家”的截图 ![在此处输入图像描述](../Images/329996fbb98b63a435a7118a43a738a6.png) ![在此处输入图像描述](../Images/106541533f1e6ae64a8d3358ab7de2b3.png)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-22T23:46:15.720

现在有 3 种选择来显示活动的一些教程：

*   [amlcurran / ShowcaseView](https://github.com/amlcurran/ShowcaseView)
*   [EspianDev / ShowcaseView](https://github.com/Espiandev/ShowcaseView)
*   [stephanenicolas / RoboDemo](https://github.com/stephanenicolas/RoboDemo)

第一个是3个中最好的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-06T15:46:56.410

是这个吗？[https://github.com/Espiandev/ShowcaseView](https://github.com/Espiandev/ShowcaseView)

> ShowcaseView (SCV) 库旨在通过独特且有吸引力的叠加层向用户突出和展示应用程序的特定部分。这个库非常适合指出用户的兴趣点、手势或晦涩但有用的项目......
> 
> 该库基于冰淇淋三明治和果冻豆启动器中的“Cling”视图...
> 
> 要使用 ShowcaseView，请使用 Builder 模式。
> 
> 举个例子：
> 
> ```
> new ShowcaseView.Builder(this)
>     .setTarget(new ActionViewTarget(this, ActionViewTarget.Type.HOME))
>     .setContentTitle("ShowcaseView")
>     .setContentText("This is highlighting the Home button")
>     .hideOnTouchOutside()
>     .build(); 
> ```
> 
> 您可以使用样式来自定义 ShowcaseView 的外观。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T23:07:53.070

从你的屏幕截图来看，这看起来像是`Activity`一套可以使用的......

```
@android:style/Theme.Translucent 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T20:01:54.320

听起来像一个弹出窗口或对话框。两者应该有类似的效果。

# javascript - 根据屏幕宽度将表格单元格或列表项移动到第二行

> ID：12148384
> 
> 赞同：1
> 
> 时间：2012-08-27T19:32:34.803
> 
> 标签：javascript, jquery, css, css-tables, fluid-layout

我的问题很简单。

首先，看一下这段代码：

[http://jsfiddle.net/Jk8Nr/](http://jsfiddle.net/Jk8Nr/)

我所拥有的只是一个非常简单的表格，带有一些填充、边框、文本对齐。

如果您访问上面的 jsFiddle，您可以增加结果窗口的宽度，并且所有表格项都将轻松放置。但是，如果您减小所述窗口的宽度，我希望表格单元格按顺序移动第二行，以便不需要横向滚动。

我不介意用`<ul><li>`这个代替表格，但我确实希望能够做到这一点。

如果有人熟悉解决方案，请告诉我。我不介意使用 jQuery/JS/CSS，但我不熟悉其他的东西。

## 更新

这是带有工作解决方案的更新的 jsFiddle：

[http://jsfiddle.net/Jk8Nr/3/](http://jsfiddle.net/Jk8Nr/3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:37:44.883

添加

```
border-collapse: separate; 
```

到你的 TABLE 风格

和

```
display: inline-block; 
```

到您的 TD/TH 风格...

干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:45:25.893

我强烈建议为此使用列表，您认为合适的顺序或无序；如果只是因为语义（导航菜单是您可能希望去的页面列表），而`table`应该以表格格式显示数据。也就是说，我建议：

```
<header>
    <ul>
        <li>Home</li>
        <li>Gallery</li>
        <li>Location</li>
        <li>Rates</li>
        <li>Contact</li>
    </ul>
</header>​ 
```

使用 CSS：

```
header ul {
    width: 100%;
    font-size: 0; /* to remove the white-space gaps between the li elements */
    text-align: center; /* to center the list, amend as appropriate */
}

header ul li {
    font-size: 16px; /* to explicitly reset the font-size and
                        override that of the parent */
    display: inline-block; /* to allow for wrapping */
    width: 19%; /* a baseline width, if the monitor is wide enough to allow it */
    min-width: 7em; /* a minimum width, if the 19% of the width of the ul is less than
                       7em, the li elements will wrap to the next line, rather than
                       becoming too small to be functional */
    border: 1px solid #000;
    -webkit-box-sizing: border-box; /* To explicitly include the border in the width
                                       of the element */
    -moz-box-sizing: border-box;
    -o-box-sizing: border-box;
    -ms-box-sizing: border-box;
    box-sizing: border-box;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Jk8Nr/4/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T19:44:38.810

请使用一些这样的语义标记：

```
<header>
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">Gallery</a></li>
            <li><a href="#">Location</a></li>
            <li><a href="#">Rates</a></li>
            <li><a href="#">Contact</a></li>
        </ul>
</header> 
```

然后使用 css 媒体查询为您的页面设置小屏幕样式。

```
header ul {
    width: 100%;
    font-size: 0;
    text-align: center;
}

header ul li {
    font-size: 16px;
    display: inline-block;
    width: 19%;
    min-width: 7em;
    border: 1px solid #000;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -o-box-sizing: border-box;
    -ms-box-sizing: border-box;
    box-sizing: border-box;
}
@media all and (max-width: 564px) and (min-width: 100px){
    header ul li {
        width:100%;
        display:block;
    }
} 
```

这是一个小提琴[http://jsfiddle.net/Jk8Nr/6/](http://jsfiddle.net/Jk8Nr/6/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T19:57:18.347

I agree with the other posters suggesting you use a list instead of a table. You can then use a media query to force a wrap at a given device-width if you want that level of control over the layout. Here's an example setting a breakpoint at 600px (markup then css)

```
<header>
    <ul>
        <li>Home</li>
        <li>Gallery</li>
        <li>Location</li>
        <li>Rates</li>
        <li>Contact</li>
    </ul>
</header>​

ul {
    width:100%;
}
li {
    width:118px;
    float:left;
    clear:left;
    padding:5px 0;
    border: 1px solid #000; 
    border-bottom:none; 
    text-align:center;            
}
li:last-child {
    border-bottom:1px solid #000;
}

@media (min-width:600px) {
    li {
        clear:none;
        border-bottom:1px solid #000;        
        border-right:none;
    }
    li:last-child {
        border-right: 1px solid #000;
    }
} 
```

[http://jsfiddle.net/Jk8Nr/8/](http://jsfiddle.net/Jk8Nr/8/) ​</p>

# hadoop - Hadoop 上的代理框架

> ID：12148385
> 
> 赞同：0
> 
> 时间：2012-08-27T19:32:36.417
> 
> 标签：hadoop, simulation, agent, genetic-programming

我正在考虑使用 Hadoop 编写一个基于代理的简单框架。这是一个我已经玩了很长时间的想法（但还没有深入思考）。

我想使用它的目标应用程序是遗传编程。想法是我会产生很多代理，让他们执行一项任务，评估他们的遗传适应性，然后繁殖它们，然后重复整个练习。

我想知道人们是否对使用 Hadoop 进行此操作有任何直接的想法/批评。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:57:34.377

我认为您应该研究 hadoop 2.0 的 YARN。它使您能够运行任何不限制您使用 MR 范式的任意逻辑

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:37:34.870

这取决于您的代理如何真正适合 map/reduce 方法。如果代理产生的结果将在减少阶段被消耗并且新的作业将被启动 - 你可以使用 Hadoop。如果你的代理依赖于彼此的结果 - 你可能想尝试一下 Storm ( [https://github.com/nathanmarz/storm/wiki](https://github.com/nathanmarz/storm/wiki) )

# java - 变量未初始化 - 虽然我是？

> ID：12148387
> 
> 赞同：0
> 
> 时间：2012-08-27T19:32:44.923
> 
> 标签：java, arrays, string, variables

**已回答**

Mike 建议我在

```
default:
break; 
```

开关的一部分。我给它加了一个例外，其他的就不用改了。代码现在成功运行。**多谢你们！**

* * *

**为可读性编辑：**

错误：“描述资源路径位置类型局部变量消息可能尚未初始化 TweetFragment.java /Offline Twitter/src/com/deadpixels/offline/twitter 第 78 行 Java 问题”

对于线：

```
int handleStartsAt = messages[i].indexOf('@'); 
```

同样的错误在第 80 行发生了两次，即：

```
ph = messages[i].substring(handleStartsAt, messages[i].length()); 
```

至于你的问题，

```
default:
break; 
```

添加了行，因为 int 推文类型只能是 0、1 或 2。该函数在受控环境中调用，这样我确信调用不会返回异常。

**编辑结束。**

我正在尝试创建一个返回字符串数组的方法。此字符串数组的大小将根据作为参数传递给方法的消息类型而改变。我在完成这项工作时遇到了一些问题，因为显然我没有初始化我的变量；虽然，我想我是。

我遇到问题的变量是“消息”数组。

请记住，我不能声明以下内容：

```
String [] messages = new String [arrayLength]; 
```

在调用的这一点上，我不知道数组的长度。我不能这样做：

```
String [] messages = null; 
```

因为在此之后，我会遇到运行时错误，尽管在编译时没有收到警报。

另外，为了澄清，我会认为：

```
messages = OfflineTwitter.mentions; 
```

上面的行将初始化变量，“OfflineTwitter.mentions”是一个数组，仅存储在不同的类中。

这是代码片段。

```
public String[] getHandles (int tweetType) {

    int arrayLength = 0;
    String [] handles;
    String [] messages;

    switch (tweetType) {
    case 0:
        arrayLength = OfflineTwitter.mentions.length;
        messages = OfflineTwitter.mentions;
        break;
    case 1:
        arrayLength = OfflineTwitter.directMessages.length;
        messages = OfflineTwitter.directMessages;
        break;
    case 2:
        arrayLength = OfflineTwitter.allTweets.length;
        messages = OfflineTwitter.allTweets;
    default:
        break;
    }

    handles = new String [arrayLength];

    for (int i = 0; i < arrayLength; i++) {
        int handleStartsAt = messages[i].indexOf('@');
        String ph = "";
        ph = messages[i].substring(handleStartsAt, messages[i].length());
        int handleEndsAt = ph.indexOf(":");
        String sender = ph.substring(0, handleEndsAt);
        handles[i] = sender;
    }

    return handles;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:34:39.223

如果`tweetType < 0 || tweetType > 2`那时

```
default:
    break; 
```

已达到不为 赋值`messages`。

您需要在`default`分支中分配一个值，或者`throw`一个异常，或者`return`使数组在第一次使用时被初始化。

也许将其更改为

```
default:
    throw new IllegalArgumentException("Invalid tweet type : " + tweetType); 
```

或者理想情况下更改`tweetType`为 an`enum`以便您可以详尽地涵盖所有情况。

```
enum TweetType {
  MENTIONS,
  DIRECT_MESSAGES,
  ALL_MESSAGES,
  ;
} 
```

并更改`int tweetType`为`TweetType tweetType`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-27T19:36:27.627

`for`你的循环逻辑有问题。将数组设置为`null`可以很好地解决编译错误。发布生成的错误堆栈跟踪以获得更多帮助。

# amazon-s3 - 如何使用 AWS S3 存储用户上传的图片？

> ID：12148390
> 
> 赞同：7
> 
> 时间：2012-08-27T19:32:54.403
> 
> 标签：amazon-s3, amazon-web-services

我正在创建一个 iPhone 应用程序来允许用户上传和分享照片。目前上传的照片存储在我订阅的 1and1 云服务器中。现在我想试试 AWS。我订阅了免费套餐 AWS Linux EC2 并设置了 php/mysql。我的问题是，出于可扩展性的目的，我应该在哪里存储用户图片：EC2 还是 S3？以及如何将 EC2 与 S3 连接，以便用户上传的照片将存储在 S3 中？我的理解是，当用户将照片上传到我的 EC2 实例时，它会存储在 EC2 中，并且由于我只有 5GB 空间，它很快就会填满空间。

由于对 AWS 的了解有限，我的问题可能听起来很奇怪，但我们将不胜感激任何帮助和建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T19:38:22.267

您应该将图片存储在 S3 中，存储在 EC2 实例中的数据不是持久的。使用 AWS 开发工具包将数据上传到 S3。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-27T19:36:28.193

对于这个用例，我将使用 S3。

为图片使用 S3 支持的优势在于，您可以轻松地使用以 S3 作为源[的 Amazon 的 Cloud Front CDN](http://aws.amazon.com/cloudfront/)（您也可以使用您的 EC2 实例，但这涉及更多工作）。

> 以及如何将 EC2 与 S3 连接，以便用户上传的照片将存储在 S3 中

PHP 有一个 S3 API

[http://aws.amazon.com/sdkforphp/](http://aws.amazon.com/sdkforphp/)

# sql - 在树中查找叶子的 SQL 查询

> ID：12148394
> 
> 赞同：0
> 
> 时间：2012-08-27T19:33:15.580
> 
> 标签：sql, activerecord, tree

我在通过 parent_id 列链接的 Postgres 中存储一棵树。我想找到树的叶子，比如那些没有子元素的元素。这是我到目前为止的查询：

```
where("id NOT IN ( SELECT parent_id FROM elements WHERE parent_id IS NOT NULL )") 
```

有没有更好的方法来编写这个查询？我试图想出一种方法来处理它，因为我听说它更有效，但无法想出任何东西。另外，有没有办法在没有原始 SQL 的情况下使用 ActiveRecord 来做到这一点？

**更新：** 这是架构：

```
 Column   |            Type             |     Modifiers      
------------+-----------------------------+--------------------
 id         | character varying(36)       | not null
 user_id    | character varying(36)       | not null
 parent_id  | character varying(36)       | 
 title      | character varying(255)      | 
 created_at | timestamp without time zone | not null
 updated_at | timestamp without time zone | not null
Indexes:
    "index_elements_on_id" UNIQUE, btree (id)
    "index_elements_on_parent_id" btree (parent_id)
    "index_elements_on_user_id" btree (user_id) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:04:47.027

该技术称为“排除连接”。

```
select e.* from elements e
left outer join elements leafs
on e.id = leafs.parent_id
where leafs.parent_id is null 
```

# ms-access - 最后和倒数第二个记录的 GROUP BY

> ID：12148395
> 
> 赞同：1
> 
> 时间：2012-08-27T19:33:15.773
> 
> 标签：ms-access, group-by, subquery

我已经为此苦苦挣扎了很长时间...我正在尝试在 Access 中编写一条 SQL 语句，以从名为`Cleaning`.

样本原始数据：

```
Premises_No Date_Cleaned
1           12-Jun
1           15-Jul
1           14-Aug
2           15-Jan
2           18-Feb
2           17-Apr
2           14-May
2           06-Jun
2           11-Jul
2           16-Aug
6           10-Dec
6           12-Jan
6           20-Feb
6           13-Mar
6           15-Apr
6           15-May
6           11-Jun
6           13-Jul
6           10-Aug 
```

所以执行的 SQL 将产生：

```
Premises_No MostRecent  2ndMostRecent
1           14-Aug          15-Jun
2           16-Aug          11-Jul
6           10-Aug          13-Jul 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:38:12.690

```
SELECT last.Premises_No, last.LastCleaned, secondlast.SecondLastCleaned
FROM
(
SELECT c1.Premises_No as Premises_No, Max(c1.Date_Cleaned) AS LastCleaned
FROM Cleaning c1 group by c1.Premises_No
)
as last
LEFT JOIN
(
SELECT c2.Premises_No as Premises_No, Max(c2.Date_Cleaned) AS SecondLastCleaned
FROM Cleaning c2 where c2.Date_Cleaned < (Select Max(c3.Date_Cleaned) FROM Cleaning c3 WHERE c3.Premises_No= c2.Premises_No)
GROUP BY c2.Premises_No
)
as
secondlast
ON last.Premises_No=secondlast.Premises_No 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:20:20.310

```
SELECT 前提_id，SUM(s.[1st]) AS [1st]，SUM(s.[2nd]) AS [2nd]
从 （
    SELECT 前提_id，MAX(date_cleaned) AS [1st]，NULL AS [2nd]
    从清洁
    GROUP BY 前提_id
    联盟
    SELECT 前提 ID，NULL AS [1st]，MAX(date_cleaned) AS [2nd]
    从清洁
    左连接
    (
        SELECT 前提_id，MAX(date_cleaned) AS [1st]，NULL AS [2nd]
        从清洁
        GROUP BY 前提_id
    ) AS t ON 清洁.前提_id = t.前提_id 和清洁.date_cleaned t.date_cleaned
    GROUP BY 前提_id
) 年代

```

# eclipse - Eclipse Debug 作为远程 Java 应用程序断点未命中

> ID：12148404
> 
> 赞同：4
> 
> 时间：2012-08-27T19:34:14.807
> 
> 标签：eclipse, gwt, tomcat, remote-debugging

这是使您处于理智边缘的问题之一。

我在 Windows XP 32 位上运行 Eclipse Java EE Indigo。我正在尝试在 tomcat 6 上调试 gwt 客户端服务应用程序。我正在使用 JDK1.6.0_32

我正在尝试调试我的应用程序的服务器端。我设置断点，在本地将客户端作为 Web 应用程序启动，然后将服务作为远程 Java 应用程序进行调试（标准（套接字附加）本地主机，8000，正确的来源）。我已验证我正在使用正确的调试设置运行服务器（dt_socket、8000、catalina.bat jpda start）

断点没有被击中。没什么，不。Eclipse 不会挂起线程，并且代码会继续通过断点。让这更令人困惑的是昨天断点工作，没有我改变任何东西，而今天早上他们没有。

我试过重新启动、清理和刷新。谷歌搜索该问题会发现 2009 年 Java 较早版本的大多数问题。

编辑：即使在属性中选择了该选项，Eclipse 也会给出错误“由于缺少行号而无法安装断点”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:04:15.460

由于代码的服务端是使用 ant 构建的。我必须确保 .xml 文件设置为 debug = "true"。我仍然收到有关缺少行的错误消息，但断点有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:27:17.133

如果您尝试使用 telnet 访问机器，它会响应吗？

```
telnet localhost 8000 
```

该端口可能在防火墙上被阻止。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T04:30:56.523

您可能需要指定是否需要行号，请参阅我们的 javac 任务：

```
<javac encoding="utf-8"
       ...
       debug="true" debuglevel="lines,vars,source"
       ... >
       ...
</javac> 
```

# android - 是否可以通过 Android 电子邮件客户端中的视口调整图像大小？

> ID：12148408
> 
> 赞同：1
> 
> 时间：2012-08-27T19:34:30.377
> 
> 标签：android, html, email, html-email

我有一封 html 电子邮件，其中使用 HTC Android 设备将 625 像素的横幅图像截断为正确的尺寸。我试图更改视口但没有成功。

```
 <meta name="viewport" content="width=device-width" /> 
```

我的理解是因为使用针对特定尺寸的媒体查询的大量设备尺寸可能会导致意外问题。

这在默认电子邮件客户端中是否可行，如果可以，有人可以推荐替代方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:59:58.573

您是否尝试过使用媒体查询？

```
<style type="text/css">
@media only screen and (max-device-width: 480px) {
body img.banner {max-width: 300px !important; height: auto !important;}
}
</style> 
```

拥有一类“横幅”的形象对我来说总是成功的。

# android - onDraw 方法被不断调用

> ID：12148411
> 
> 赞同：1
> 
> 时间：2012-08-27T19:34:33.030
> 
> 标签：android, ondraw

我已经查看了有关此的其他问题，但没有一个适用于我的情况。我在自定义视图中的 onDraw 方法被不断调用，大约每 0.3 秒一次。

我有一个自定义视图，它绘制了建筑物内部的地图。该视图大于视图区域，因此我将自定义视图包装在自定义 ScrollView 和 Horizo​​ntalScrollView 中。onDraw 方法很大，这里就不贴了。但是我已经从 onDraw 中删除了所有代码，它没有改变任何东西。

如果我取消使用两个滚动视图，onDraw 只会被调用一次，并且只有在我捏缩放地图时才会再次调用。

编辑：在完整的自定义滚动类中添加。垂直滚动类与此相同。

```
public class SCEHorizontalScrollViewBase extends HorizontalScrollView {
private GestureDetector mGestureDetector;

private String TAG = this.getClass().getName();

public SCEHorizontalScrollViewBase(Context context, AttributeSet attrs) {
    super(context, attrs);
    mGestureDetector = new GestureDetector(context, new XScrollDetector());
    setFadingEdgeLength(10);
}

@Override
public boolean onInterceptTouchEvent(MotionEvent ev) {
    Log.d(TAG, "onInterceptTouchEvent");
    return super.onInterceptTouchEvent(ev) && mGestureDetector.onTouchEvent(ev) && ev.getPointerCount()==1;
}

// Return false if we're scrolling in the Y direction  
class XScrollDetector extends SimpleOnGestureListener {
    @Override
    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) {
        Log.d(TAG, "onScroll");
        super.onScroll(e1, e2, distanceX, distanceY);
        if(Math.abs(distanceY) < Math.abs(distanceX)) {
            return true;
        }
        return false;
    }
} 
```

}

还添加了布局文件。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_height="match_parent"
android:layout_width="match_parent" >

<mobile.base.SCEScrollViewBase
    android:fillViewport="true"
    android:id="@+id/warehouseScrollWidget"
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:scrollbarFadeDuration="999999"
    android:scrollbarStyle="outsideOverlay" >

    <mobile.base.SCEHorizontalScrollViewBase
        android:fillViewport="true"
        android:id="@+id/warehouseHorizontalScrollWidget"
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:scrollbarFadeDuration="999999"
        android:scrollbarStyle="outsideOverlay" >

        <mobile.base.widgets.SCEWidgetWarehouseView
            android:id="@+id/WarehouseView"
            android:layout_height="wrap_content"
            android:layout_width="wrap_content" />
    </mobile.base.SCEHorizontalScrollViewBase>
</mobile.base.SCEScrollViewBase>
</RelativeLayout> 
```

从我的日志中我得到了这个。

```
08-27 15:28:32.376: mobile.base.SCEHorizontalScrollViewBase(21571): requestLayout
08-27 15:28:32.376: mobile.base.widgets.SCEWidgetWarehouseView(21571): requestLayout
08-27 15:28:32.386: mobile.base.SCEScrollViewBase(21571): requestLayout
08-27 15:28:32.386: mobile.base.SCEHorizontalScrollViewBase(21571): requestLayout
08-27 15:28:32.386: mobile.base.SCEScrollViewBase(21571): requestLayout
08-27 15:28:32.416: mobile.base.widgets.SCEWidgetWarehouseView(21571): onMeasure set 972.5,1765.0
08-27 15:28:32.416: mobile.base.widgets.SCEWidgetWarehouseView(21571): onMeasure set 972.5,1765.0
08-27 15:28:32.456: mobile.base.widgets.SCEWidgetWarehouseView(21571): onMeasure set 972.5,1765.0
08-27 15:28:32.456: mobile.base.widgets.SCEWidgetWarehouseView(21571): onMeasure set 972.5,1765.0
08-27 15:28:32.476: mobile.base.SCEScrollViewBase(21571): onDraw
08-27 15:28:32.486: mobile.base.SCEHorizontalScrollViewBase(21571): onDraw
08-27 15:28:32.486: mobile.base.widgets.SCEWidgetWarehouseView(21571): onDraw
08-27 15:28:32.877: mobile.base.SCEScrollViewBase(21571): onDraw
08-27 15:28:32.877: mobile.base.SCEHorizontalScrollViewBase(21571): onDraw
08-27 15:28:32.877: mobile.base.widgets.SCEWidgetWarehouseView(21571): onDraw
08-27 15:28:33.117: mobile.base.SCEScrollViewBase(21571): onDraw
08-27 15:28:33.117: mobile.base.SCEHorizontalScrollViewBase(21571): onDraw
08-27 15:28:33.117: mobile.base.widgets.SCEWidgetWarehouseView(21571): onDraw 
```

有什么想法为什么要这样做？它以前没有这样做，发生了一些变化，我不知道是什么。以前屏幕滚动得相当快，现在几乎不动了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:20:20.863

这可能与滚动视图中的列表视图是一个坏主意这一事实有关。或者至少他们曾经是。它与android的底层架构有关。Romain Guy 就这个事实对这篇文章发表了评论[我怎样才能将 ListView 放入 ScrollView 而不会崩溃？](https://stackoverflow.com/questions/3495890/how-can-i-put-a-listview-into-a-scrollview-without-it-collapsing)

所以我没有答案，我会冒险发生某种无效导致重绘。

我唯一的解决方案可能是将您的代码移动到其他地方并作为其他触发器的结果调用它。或者将代码包装为仅每 1000 次调用执行一次。

# ruby-on-rails - 在 Windows 上的封闭网络中安装 Ruby on Rails

> ID：12148420
> 
> 赞同：0
> 
> 时间：2012-08-27T19:35:00.267
> 
> 标签：ruby-on-rails, ruby, windows

我是 RoR 的 nb，我使用了 windows 安装程序，它安装得很好。问题是当 RoR 试图访问[http://rubygems.org](http://rubygems.org)时，它无法到达那里。

所以我的问题是我可以在哪里更改它获取信息的位置，我可以单独下载这些 gem 并将它们放置到 RoR 获取的目录中吗？

我很感激我这几天在这方面遇到的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:47:51.347

您可能在代理后面。尽管您的 Web 浏览器和其他各种应用程序可能已设置为通过代理工作，但 RubyGems 不是。

如果您知道您的 http 代理地址和端口，您可以将其作为命令行参数传递给 Ruby Gems。

尽管我建议将您的代理设置为系统变量，但您可能没有该选项，因为我目前的工作地点也没有该选项。

```
gem install rails --http-proxy=https://your.proxy.address:portnumber 
```

[RubyGems 手册](http://docs.rubygems.org/read/chapter/13#page51)中的相关信息。

编辑：

有一种方法可以手动下载和安装 gem。这可能既麻烦又烦人，但这是可能的。

转到[RubyGems.org](http://rubygems.org/)并使用搜索功能找到您需要的 gem。对于此示例，我将使用设计。在设计页面上[有](http://rubygems.org/gems/devise)一个下载链接。下载 gem 并`cd`进入该位置。如果将其保存到`C:\manual_gems`，则`cd C:\manual_gems`。

Devise 的当前版本是 2.1.2。因此，一旦您进入该文件夹，您将 gem 保存到：

```
gem install devise-2.1.2.gem 
```

麻烦的部分来了。您会注意到一个错误，指出它需要依赖项。RubyGems 页面还提供了依赖项列表。在最终能够安装 gem 之前，您必须对每个依赖项都遵循相同的过程。

例如，Devise 需要 Warden，而 Warden 又需要 ActionPack、ActiveSupport、Rack-SSL、Rake、RDoc 和 Thor（如果您有 Rails，您可能已经安装了它们）。这是 RubyGems 和 Bundler 为您处理的递归之旅。

一切就绪后，您可以在 Rails 应用程序中修改 GemFile 以指向本地 gem。我尚未对其进行测试，但在关于该主题的[类似 SO 问题](https://stackoverflow.com/questions/4487948/how-can-i-specify-a-local-gem-in-my-gemfile)上有一个可接受的答案，它提供了以下解决方案：

```
gem 'devise', path: 'path/to/devise' 
```

同样，很麻烦，但是如果您真的想在您所暗示的那样有限的环境中启动并运行 Rails 应用程序，那么这应该可以工作或让您顺利进行。

# iphone - 如何在 sizeThatFits 之前调用 layoutSubviews？

> ID：12148421
> 
> 赞同：9
> 
> 时间：2012-08-27T19:35:17.630
> 
> 标签：iphone, ios, cocoa-touch, uiview

当我调用`sizeToFit`我的一个视图时，我注意到 iOS 框架首先调用`sizeThatFits`，然后再调用`layoutSubviews`该视图。这对我来说是有问题的，因为 my 中的计算`sizeThatFits`取决于 my 的结果`layoutSubviews`。在下面的例子中，一个子视图被调整`layoutSubviews`并且这个子视图的高度被用于`sizeThatFits`. 目前我的代码不起作用，顺序颠倒了。

在我的视图控制器的 viewDidLoad 中：

```
UIView* header = [[MyHeader alloc] init];
[header sizeToFit];
self.tableView.tableHeaderView = header;
[header release]; 
```

在我看来：

```
- (void) layoutSubviews {
    [super layoutSubviews];
    [self.subView sizeToFit];
}

- (CGSize) sizeThatFits:(CGSize)size {
    return CGSizeMake(
        self.frame.size.width,
        self.subView.frame.size.height
    );
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-11T17:08:19.647

无论您以何种顺序调用事物，您都希望您的视图始终执行正确的事情（tm）。为此，我建议将计算视图和子视图所需高度的代码放在单独的方法中。这些方面的东西：

```
- (void)updateSubviewDimensions
{
    [self.subview sizeToFit];
    // possibly much more code
}

- (void) layoutSubviews {
    [super layoutSubviews];
    [self updateSubviewDimensions];
}

- (CGSize) sizeThatFits:(CGSize)size {
    [self updateSubviewDimensions];
    return CGSizeMake(
        self.frame.size.width,
        self.subView.frame.size.height
    );
} 
```

这样，您不必依赖在调用之前记住调用某个方法`sizeToFit`，但您的视图将始终执行您想要的操作。另外，当您在几个月后查看它时（或让不同的开发人员查看它），您的代码将不那么脆弱并且更容易理解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-11T17:19:34.997

如果您`sizeThatFits:`要求布局准确，那么您需要强制布局（请参见下面的代码。）但我认为这是设计不佳的，因为您的布局没有考虑“大小”。

```
- (CGSize) sizeThatFits:(CGSize)size {

    [self setNeedsLayout];
    [self layoutIfNeeded];

    return CGSizeMake(
        self.frame.size.width,
        self.subView.frame.size.height
    );
} 
```

更好的方法可能是为您的子视图使用自动布局，然后用于`systemLayoutSizeFittingSize:`确定您的视图所需的大小（vs. `sizeThatFits:`）

如果您不能或不想使用自动布局，那么您应该考虑为实际布局和布局计算使用单独的代码路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-11T16:57:27.037

您是否尝试过调用`layoutIfNeeded`视图强制`layoutSubviews`？尽管名称具有误导性，但这是立即触发的方式`layoutSubviews`。`sizeToFit`尝试在或之前调用它`sizeThatFits`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-17T00:52:33.637

这里的问题是子视图在调用 layoutSubviews 之前没有尺寸。这与自定义表格视图单元格中的相同。

要解决这个问题，您需要更改逻辑或自己进行数学运算以获得明确的维度，而不依赖于自动的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-27T19:40:44.010

你不能只在`-layoutSubviews`方法而不是`-sizeThatFits:`方法中更改子视图的框架吗？

# python - 带有标题的reST图像网格？

> ID：12148428
> 
> 赞同：2
> 
> 时间：2012-08-27T19:36:04.103
> 
> 标签：python, python-sphinx, restructuredtext

作为这个[问题](https://stackoverflow.com/questions/10219634/image-grid-in-restructuredtext-sphinx)的扩展：如何使用 Sphinx 和 reStructuredText 在每个网格图像下添加描述？

例如，一张桌子，三个图像，每个图像下方都有一个标题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T10:57:54.240

我不确定仅使用 figure 指令是否可行，[就像使用 image 指令一样](https://stackoverflow.com/a/10229407/623518)。然而，虽然看起来很可怕，但你可以将这三个数字放在一张桌子上。例如，下面的 reStructuredText

```
+-----------------------------------------+-----------------------------------------+-----------------------------------------+
| .. figure:: http://placehold.it/150x150 | .. figure:: http://placehold.it/150x150 | .. figure:: http://placehold.it/150x150 |
|   :alt: map to buried treasure          |   :alt: map to buried treasure          |   :alt: map to buried treasure          |
|                                         |                                         |                                         |
|   This is the caption of the figure (a  |   This is the caption of the figure (a  |   This is the caption of the figure (a  |
|   simple paragraph).                    |   simple paragraph).                    |   simple paragraph).                    |
+-----------------------------------------+-----------------------------------------+-----------------------------------------+ 
```

生产

![上述reStructuredText产生的一行三图的表格](../Images/4cf54f181f7f31fef94468c9943b63bf.png)

# ios - iOS 游戏工具包回合制比赛程序化复赛

> ID：12148430
> 
> 赞同：7
> 
> 时间：2012-08-27T19:36:09.373
> 
> 标签：ios, game-center

我有一个使用游戏中心和 GKTurnbasedMatch 的 2 人 iOS 回合制游戏。

有没有办法在比赛结束后以编程方式重新匹配对手？

我想让玩家一键式地开始彼此的新比赛。

如果没有一键式方法，有哪些潜在的替代方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T03:04:37.380

事实上，Game Center 似乎忽略了一个*完整*的程序化解决方案。痛苦，毫无疑问。在您的 @selector(doRematchTap)... 或等效项中尝试以下操作：

```
 NSMutableArray *playerIds = [NSMutableArray array];
    GKTurnBasedParticipant *otherPlayer = /* Get the other player some way */;
    GKTurnBasedParticipant *myParticipant = /* Get yourself a very similar way*/;

    [playerIds addObject:myParticipant.playerID];
    if (otherPlayer.playerID) {
        [playerIds addObject:otherPlayer.playerID];
    }// sanity check

    GKMatchRequest *request = [[GKMatchRequest alloc] init];
    request.playersToInvite = playerIds;
    request.minPlayers = 2;
    request.maxPlayers = 2;

    GKTurnBasedMatchmakerViewController *tbmcv = [[GKTurnBasedMatchmakerViewController alloc] initWithMatchRequest:request];
    tbmcv.showExistingMatches = NO;
    tbmcv.turnBasedMatchmakerDelegate = /* Your normal delegate for the callbacks */;

    [self presentViewController:tbmcv
                       animated:YES
                     completion:^{
                      }]; 
```

重要的是要注意 showExistingMatches = NO，这会将视图控制器直接跳转到匹配模式，并预先选择了正确的用户（看起来），而不是显示用户现有的匹配项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T12:45:02.327

我没有完整的解决方案，但给你一个想法：

每个玩家都有一个唯一的玩家 ID，如果你在

`didReceiveData:(NSData *)data fromPlayer:(NSString *)playerID`

现在您可以以编程方式开始新比赛并邀请该玩家。系统会询问他是否想要复赛，然后您可以再次比赛。

我知道这不是很多代码或具体建议，但也许它足以在[GameKit 类参考](http://developer.apple.com/library/ios/#documentation/GameKit/Reference/GameKit_Collection/_index.html)中找到其余信息。

我想知道你是否可以解决它，告诉我你是否做到了，祝你好运！

**编辑：**

我在[参考资料](http://developer.apple.com/library/ios/#DOCUMENTATION/NetworkingInternet/Conceptual/GameKit_Guide/Users/Users.html#//apple_ref/doc/uid/TP40008304-CH8-SW6)中搜索并发现了这一点：

```
- (void) loadPlayerData: (NSArray *) identifiers 
```

我自己没有尝试过，但是如果你将他的标识符存储在一个数组中并将它传递给这个函数，你应该再次以这种方式获取玩家。

我希望他们在 iOS6 中为 Game Center 带来了一些变化，你可以以自己的方式以编程方式进行比赛......

# javascript - 使用谷歌搜索小工具搜索所有 tk 网站也许

> ID：12148431
> 
> 赞同：0
> 
> 时间：2012-08-27T19:36:10.127
> 
> 标签：javascript, web-applications, blogs

我想搜索所有带有 .TK 域扩展名的 TK 域或网站，但我唯一能找到的是这个博客：

[搜索所有 Dot TK 网站](http://searchtksites.blogspot.com)。

我无法理解它是如何工作的，它有一个问题是它只显示 50,000 个结果中的 10 页结果。

但是，如果有人知道任何替代方案，或者我怎样才能制作这样的博客，那就太好了。

我在网上搜索了很多，但找不到任何相关的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:58:11.010

如果要搜索所有 .TK 域，请搜索`site:*.tk`.

**[例子](http://www.google.com/search?q=site%3A%2a.tk)**

# wpf - 更改 XamDatGrid 的筛选器属性

> ID：12148432
> 
> 赞同：0
> 
> 时间：2012-08-27T19:36:14.627
> 
> 标签：wpf, mvvm, infragistics, xamdatagrid

我正在尝试在 XamDataGrid 中将过滤器设置更改为“包含”而不是“开始于”，是否有任何属性可以实现该功能？

经过大量研究后我无法找到它，如果有人可以帮助我找到我错过的东西，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:52:46.703

如果您更愿意在 ViewModel 中进行过滤，这里有一个示例来演示您将如何使用`ICollectionView`：

```
public class TestViewModel : INotifyPropertyChanged
{
    private string _filterText;
    private List<string> _itemsList;

    public TestViewModel()
    {
        _itemsList = new List<string>() { "Test 1", "Test 2", "Test 3" };
        this.Items = CollectionViewSource.GetDefaultView(_itemsList);
        this.Items.Filter = FilterItems;
    }

    public ICollectionView Items { get; private set; }

    public string FilterText
    {
        get { return _filterText; }
        set
        {
            _filterText = value;
            Items.Refresh();
            this.RaisePropertyChanged("FilterText");
        }
    }

    private bool FilterItems(object item)
    {

        return this.FilterText == null || item.ToString().Contains(this.FilterText);
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    private void RaisePropertyChanged(string propName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propName));
    }
    #endregion
} 
```

然后在您的视图中，您只需将 DataBind 绑定`TextBox`到 FilterText 属性，并将`ItemsSource`或 Grid 绑定到 Items 属性（此处使用 ListBox 进行演示）：

```
<TextBox x:Name="ItemsFilter" Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Left" Width="100" Margin="10" VerticalAlignment="Center"/>
<ListBox x:Name="ItemsList" ItemsSource="{Binding Items}" Grid.Row="1" Width="200" Margin="10" HorizontalAlignment="Left"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:46:01.297

得到我需要的财产，谢谢大家。

事情是这样的，

```
 <igDP:Field Name="Description">
                                <igDP:Field.Settings>
                                    <igDP:FieldSettings
AllowGroupBy="True"
AllowEdit="True"
AllowRecordFiltering="True"
FilterOperatorDefaultValue="Contains"/>                                        
                                </igDP:Field.Settings>    
                            </igDP:Field> 
```

# java - Timer Task 中的 run() 方法未执行 - Android

> ID：12148433
> 
> 赞同：1
> 
> 时间：2012-08-27T19:36:17.017
> 
> 标签：java, android

InputStream 和 OutputStream 声明：

```
public OutputStream out = null; 
public InputStream inputStr = null; 
```

onCreate() 代码启动 TimerTask：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
Log.e(LOG_TAG, "Start Repeat Timer");
    TimerTask task = new RepeatingTask();
    Timer timer = new Timer();
    timer.scheduleAtFixedRate(task, 0, 3000);
    Log.e(LOG_TAG, "Started Repeat Timer");
    out = socket.getOutputStream();
    inputStr = socket.getInputStream();
} 
```

定时器任务代码：

```
public class RepeatingTask extends TimerTask {
     //private int len = 0; 
     //private byte[] input = new byte[len];

     public RepeatingTask() {
            Log.e(LOG_TAG, "In RepeatingTask()");
            Log.e(LOG_TAG, "Before inputJSON String");

            String hello = "hello world";
            //String inputJSON = getStringFromBuffer(new InputStreamReader(socket.getInputStream()));
            try {
                inputJSON = ConvertByteArrayToString(readBytes(inputStr));
                sendBytes(ConvertStringToByteArray(inputJSON), 0, ConvertStringToByteArray(inputJSON).length);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            //Convert 
            Log.e(LOG_TAG, "After inputJSON String:" + inputJSON); 

         //LOOK HERE FIRST  
         //inputJSON is what is received back from the server - Take the inputJSON 
         //String and use regular expressions HERE to remove all the other characters in the 
         //string except the payload JSON.
         //refreshViewModels(inputJSON);
     }

     @Override
     public void run() { 
          /*try {
              Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON");
              //outputstrwr.write(outputJSONserv);  //UNCOMMENT IF NEED TO SEND DATA TO GET JSON BACK
              //inputJSON = ConvertByteArrayToString(getBytesFromInputStream(inputStr));
              inputJSON = ConvertByteArrayToString(getFileBytes(inputStr));
          } catch (IOException e) {
              // TODO Auto-generated catch block
              e.printStackTrace();
          }

          Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON2:" + inputJSON);
          refreshViewModels(inputJSON);*/

      try {
          Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON");
          //outputstrwr.write(outputJSONserv);  //UNCOMMENT IF NEED TO SEND DATA TO GET JSON BACK
          //byte[] = myByteArray = readBytes(inputStr);
          sendBytes(ConvertStringToByteArray(outputJSONserv), 0, ConvertStringToByteArray(outputJSONserv).length);
          //sendBytes(myByteArray, 0, myByteArray.length);
          Log.e(LOG_TAG, "AFTER SENDING DATA");
          //inputJSON = ConvertByteArrayToString(getBytesFromInputStream(inputStr));
              inputJSON = ConvertByteArrayToString(readBytes(inputStr));
              Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON2:" + inputJSON);
      } 
      catch (IOException e) {
              // TODO Auto-generated catch block
              e.printStackTrace();
      }

      Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON3:" + inputJSON);
      refreshViewModels(inputJSON); 
     }
} 
```

inputStr 是一个 InputStream，用于读取字节并将它们转换为字符串。

ConvertByteArrayToString() 只是将 Byte Array 转换为 String， ConvertStringToByteArray() 将 String 转换为 Byte[]，以便可以使用 sendBytes(byte[], int, int) 发送数据。

我试图弄清楚为什么我的代码卡在这个 try/catch 语句中而没有抛出任何异常：

```
 try {
                inputJSON = ConvertByteArrayToString(readBytes(inputStr));
                sendBytes(ConvertStringToByteArray(inputJSON), 0, ConvertStringToByteArray(inputJSON).length);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } 
```

这是我的 sendBytes() 方法：

```
public void sendBytes(byte[] myByteArray, int start, int len) throws IOException {
    if (len < 0)
        throw new IllegalArgumentException("Negative length not allowed");
    if (start < 0 || start >= myByteArray.length)
        throw new IndexOutOfBoundsException("Out of bounds: " + start);
    // Other checks if needed.

    // May be better to save the streams in the support class;
    // just like the socket variable.
    OutputStream out = socket.getOutputStream(); 
    DataOutputStream dos = new DataOutputStream(out);

    dos.writeInt(len);
    if (len > 0) {
        dos.write(myByteArray, start, len);
    }
} 
```

这是我的 readBytes() 方法：

```
public byte[] readBytes(InputStream in) throws IOException {
    // Again, probably better to store these objects references in the support class
    in = socket.getInputStream();
    DataInputStream dis = new DataInputStream(in);

    int len = dis.readInt();
    byte[] data = new byte[len];
    if (len > 0) {
        dis.readFully(data);
    }
    return data;
} 
```

下面是 ConvertByteArrayToString() 和 ConvertStringToByteArray() 方法的代码：

```
public String ConvertByteArrayToString(byte[] b) { 
    // byte[] to string
    String input = new String(b);
    return input;
}

public byte[] ConvertStringToByteArray(String str) { 
    // string to byte[]
    byte[] bytes = str.getBytes();
    return bytes;
} 
```

这是我看到的 logcat 输出：

```
 E/AndroidClient(17109): Start Repeat Timer
 E/AndroidClient(17109): Before inputJSON String
 D/WindowManager(  110): Home Key Test: false :false 
```

任何正确方向的帮助或指示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:39:21.197

I hope this helps, I have your code like this and seems to be working,

```
package com.example.stackoverflow;

import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;
import java.util.Timer;
import java.util.TimerTask;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;

public class MainActivity extends Activity {
   private static final String LOG_TAG = "TEMP";
   InputStream inputStr;
   String inputJSON = null;
   Socket socket = new Socket();
   String outputJSONserv = "asdasd";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Log.e(LOG_TAG, "Start Repeat Timer");
    TimerTask task = new RepeatingTask();
    Timer timer = new Timer();
    timer.scheduleAtFixedRate(task, 0, 3000);
    Log.e(LOG_TAG, "Started Repeat Timer");
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public class RepeatingTask extends TimerTask {
    // private int len = 0;
    // private byte[] input = new byte[len];

    public RepeatingTask() {
        Log.e(LOG_TAG, "In RepeatingTask()");
        Log.e(LOG_TAG, "Before inputJSON String");

        try {
            inputJSON = ConvertByteArrayToString(readBytes(inputStr));
            sendBytes(ConvertStringToByteArray(inputJSON), 0,
                    ConvertStringToByteArray(inputJSON).length);
        } catch (IOException e) {
            e.printStackTrace();
        }
        // Convert
        Log.e(LOG_TAG, "After inputJSON String:" + inputJSON);

        // LOOK HERE FIRST
        // inputJSON is what is received back from the server - Take the
        // inputJSON
        // String and use regular expressions HERE to remove all the other
        // characters in the
        // string except the payload JSON.
        // refreshViewModels(inputJSON);
    }

    @Override
    public void run() {
        /*
         * try { Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON");
         * //outputstrwr.write(outputJSONserv); //UNCOMMENT IF NEED TO SEND
         * DATA TO GET JSON BACK //inputJSON =
         * ConvertByteArrayToString(getBytesFromInputStream(inputStr));
         * inputJSON = ConvertByteArrayToString(getFileBytes(inputStr)); }
         * catch (IOException e) { // TODO Auto-generated catch block
         * e.printStackTrace(); }
         * 
         * Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON2:" + inputJSON);
         * refreshViewModels(inputJSON);
         */

        try {
            Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON");
            // outputstrwr.write(outputJSONserv); //UNCOMMENT IF NEED TO
            // SEND DATA TO GET JSON BACK
            // byte[] = myByteArray = readBytes(inputStr);
            sendBytes(ConvertStringToByteArray(outputJSONserv), 0,
                    ConvertStringToByteArray(outputJSONserv).length);
            // sendBytes(myByteArray, 0, myByteArray.length);
            Log.e(LOG_TAG, "AFTER SENDING DATA");
            // inputJSON =
            // ConvertByteArrayToString(getBytesFromInputStream(inputStr));
            inputJSON = ConvertByteArrayToString(readBytes(inputStr));
            Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON2:" + inputJSON);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        Log.e(LOG_TAG, "IN REPEATINGTHREAD-INPUTJSON3:" + inputJSON);
        //refreshViewModels(inputJSON);
    }
}

public void sendBytes(byte[] myByteArray, int start, int len)
                                                             throws IOException {
    if (len < 0)
        throw new IllegalArgumentException("Negative length not allowed");
    if (start < 0 || start >= myByteArray.length)
        throw new IndexOutOfBoundsException("Out of bounds: " + start);
    // Other checks if needed.

    // May be better to save the streams in the support class;
    // just like the socket variable.

    OutputStream out = socket.getOutputStream();
    DataOutputStream dos = new DataOutputStream(out);

    dos.writeInt(len);
    if (len > 0) {
        dos.write(myByteArray, start, len);
    }
}

public byte[] readBytes(InputStream in) throws IOException {
    // Again, probably better to store these objects references in the
    // support class
    in = socket.getInputStream();
    DataInputStream dis = new DataInputStream(in);

    int len = dis.readInt();
    byte[] data = new byte[len];
    if (len > 0) {
        dis.readFully(data);
    }
    return data;
}

public String ConvertByteArrayToString(byte[] b) {
    // byte[] to string
    String input = new String(b);
    return input;
}

public byte[] ConvertStringToByteArray(String str) {
    // string to byte[]
    byte[] bytes = str.getBytes();
    return bytes;
} 
```

}

and here is the logcat output:

> 08-27 14:26:15.515: E/TEMP(23005): Start Repeat Timer 08-27 14:26:15.515: E/TEMP(23005): In RepeatingTask() 08-27 14:26:15.515: E/TEMP(23005): Before inputJSON String 08-27 14:26:15.523: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:15.523: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:15.523: W/System.err(23005): at java.net.Socket.getInputStream(Socket.java:339) 08-27 14:26:15.523: W/System.err(23005): at com.example.stackoverflow.MainActivity.readBytes(MainActivity.java:129) 08-27 14:26:15.523: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.(MainActivity.java:50) 08-27 14:26:15.523: W/System.err(23005): at com.example.stackoverflow.MainActivity.onCreate(MainActivity.java:29) 08-27 14:26:15.523: W/System.err(23005): at android.app.Activity.performCreate(Activity.java:4465) 08-27 14:26:15.523: W/System.err(23005): at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 08-27 14:26:15.523: W/System.err(23005): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 08-27 14:26:15.523: W/System.err(23005): at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981) 08-27 14:26:15.523: W/System.err(23005): at android.app.ActivityThread.access$600(ActivityThread.java:123) 08-27 14:26:15.523: W/System.err(23005): at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147) 08-27 14:26:15.523: W/System.err(23005): at android.os.Handler.dispatchMessage(Handler.java:99) 08-27 14:26:15.523: W/System.err(23005): at android.os.Looper.loop(Looper.java:137) 08-27 14:26:15.523: W/System.err(23005): at android.app.ActivityThread.main(ActivityThread.java:4424) 08-27 14:26:15.523: W/System.err(23005): at java.lang.reflect.Method.invokeNative(Native Method) 08-27 14:26:15.523: W/System.err(23005): at java.lang.reflect.Method.invoke(Method.java:511) 08-27 14:26:15.523: W/System.err(23005): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 08-27 14:26:15.523: W/System.err(23005): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551) 08-27 14:26:15.523: W/System.err(23005): at dalvik.system.NativeStart.main(Native Method) 08-27 14:26:15.523: E/TEMP(23005): After inputJSON String:null 08-27 14:26:15.523: E/TEMP(23005): Started Repeat Timer 08-27 14:26:15.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:15.531: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:15.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:15.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:15.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:15.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:15.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:15.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:15.578: D/libEGL(23005): loaded /system/lib/egl/libGLES_android.so 08-27 14:26:15.578: D/libEGL(23005): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so 08-27 14:26:15.578: D/libEGL(23005): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so 08-27 14:26:15.585: D/libEGL(23005): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so 08-27 14:26:15.609: D/OpenGLRenderer(408): Flushing caches (mode 1) 08-27 14:26:15.632: D/OpenGLRenderer(408): Flushing caches (mode 0) 08-27 14:26:15.687: D/OpenGLRenderer(23005): Enabling debug mode 0 08-27 14:26:15.914: I/ActivityManager(179): Displayed com.example.stackoverflow/.MainActivity: +498ms 08-27 14:26:18.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:18.531: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:18.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:18.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:18.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:18.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:18.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:18.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:21.523: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:21.523: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:21.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:21.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:21.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:21.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:21.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:21.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:23.781: I/ActivityManager(179): No longer want com.android.keychain (pid 22891): hidden #16 08-27 14:26:24.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:24.531: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:24.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:24.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:24.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:24.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:24.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:24.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:27.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:27.531: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:27.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:27.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:27.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:27.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:27.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:27.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:29.828: D/dalvikvm(19877): GC_CONCURRENT freed 470K, 5% free 13211K/13767K, paused 4ms+3ms 08-27 14:26:30.179: D/Finsky(19877): [1] 5.onFinished: Installation state replication succeeded. 08-27 14:26:30.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:30.531: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:30.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:30.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:30.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:30.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:30.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:30.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:33.523: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:33.523: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:33.523: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:33.523: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:33.523: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:33.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:33.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:33.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:36.523: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:36.523: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:36.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:36.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:36.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:36.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:36.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:36.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:39.523: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:39.523: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:39.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:39.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:39.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:39.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:39.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:39.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:42.523: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:42.531: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:42.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:42.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:42.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:42.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:42.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:42.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:45.523: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:45.531: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:45.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:45.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:45.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:45.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:45.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:45.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:48.523: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:48.523: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:48.523: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:48.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:48.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:48.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:48.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:48.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:51.117: D/dalvikvm(366): GC_CONCURRENT freed 443K, 5% free 13141K/13703K, paused 6ms+3ms 08-27 14:26:51.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:51.531: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:51.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:51.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:51.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:51.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:51.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:51.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:54.523: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:54.523: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:54.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:54.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:54.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:54.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:54.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:54.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null 08-27 14:26:57.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON 08-27 14:26:57.531: W/System.err(23005): java.net.SocketException: Socket is not connected 08-27 14:26:57.531: W/System.err(23005): at java.net.Socket.checkOpenAndCreate(Socket.java:645) 08-27 14:26:57.531: W/System.err(23005): at java.net.Socket.getOutputStream(Socket.java:381) 08-27 14:26:57.531: W/System.err(23005): at com.example.stackoverflow.MainActivity.sendBytes(MainActivity.java:117) 08-27 14:26:57.531: W/System.err(23005): at com.example.stackoverflow.MainActivity$RepeatingTask.run(MainActivity.java:88) 08-27 14:26:57.531: W/System.err(23005): at java.util.Timer$TimerImpl.run(Timer.java:284) 08-27 14:26:57.531: E/TEMP(23005): IN REPEATINGTHREAD-INPUTJSON3:null

# clojure - 使用 iText 和 clojure 从 PDF 中提取页面

> ID：12148436
> 
> 赞同：2
> 
> 时间：2012-08-27T19:36:20.610
> 
> 标签：clojure, itext

我正在尝试通过翻译我在此处找到的 splitPDF 方法使用 clojure 从 pdf 中提取单个页面[http://viralpatel.net/blogs/itext-tutorial-merge-split-pdf-files-using-itext-jar/](http://viralpatel.net/blogs/itext-tutorial-merge-split-pdf-files-using-itext-jar/)

我不断收到此错误

**IOException 流关闭 java.io.FileOutputStream.writeBytes (:-2)**

这可以防止我在 repl 仍然打开时打开文档。关闭 repl 后，我就可以访问该文档。

为什么我会收到错误消息？

我如何解决它 ？

我怎样才能使它更clojurey？

```
(import '(com.itextpdf.text Document)
            '(com.itextpdf.text.pdf PdfReader PdfWriter PdfContentByte PdfImportedPage BaseFont)
            '(java.io File FileInputStream FileOutputStream InputStream OutputStream))

(defn extract-page [src dest pagenum]
  (with-open  [ d (Document.) 
                os (FileOutputStream. dest)]
    (let [ srcpdf (->> src FileInputStream. PdfReader.)
           destpdf  (PdfWriter/getInstance d os)]
         (doto d
            (.open )
            (.newPage ))
          (.addTemplate 
                (.getDirectContent destpdf)
                (.getImportedPage destpdf srcpdf pagenum) 0 0)))) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T09:37:17.630

您忘记关闭文档：

```
(close. d) 
```

以下代码有效：

```
(import '(com.itextpdf.text Document)
            '(com.itextpdf.text.pdf PdfReader PdfWriter PdfContentByte PdfImportedPage BaseFont)
            '(java.io File FileInputStream FileOutputStream InputStream OutputStream))

(defn extract-page [src dest pagenum]
  (with-open  [ is (FileInputStream. src)
                os (FileOutputStream. dest)]
    (let [ srcpdf (PdfReader. src)
           d (Document.)
           destpdf  (PdfWriter/getInstance d os)]
         (doto d
            (.open )
            (.newPage ))
         (println "Number of pages" (.getNumberOfPages srcpdf))
         (.addTemplate 
                (.getDirectContent destpdf)
                (.getImportedPage destpdf srcpdf pagenum) 0 0)
         (.close d)))) 
```

编辑：

如果您有兴趣，我发现使用 apache pdfbox 更容易。

```
(import '(org.apache.pdfbox.pdmodel PDDocument)
        '(org.apache.pdfbox.util PDFTextStripper)
        '(java.io File OutputStreamWriter FileOutputStream BufferedWriter))

(defn convert-to-text [src dest]
  (with-open [ pd (PDDocument/load (File. src))
               wr (BufferedWriter. (OutputStreamWriter. (FileOutputStream. (File. dest))))]
    (let [ stripper (PDFTextStripper.)]
      (println "Number of pages" (.getNumberOfPages pd))
      (.writeText stripper pd wr)))) 
```

# asp-classic - ASP 中的 ASP 与 HTML

> ID：12148437
> 
> 赞同：0
> 
> 时间：2012-08-27T19:36:26.307
> 
> 标签：asp-classic, safari

我有一个 ASP 数组，例如 byteCompareArray(36,2)。第一列可以包含 1 到 9 之间的任何整数。第二个只有 1 或 2。我有第二个变量，例如 bytID_Compare，它可以保存从 1 到 36 的任何整数 - 但通常从 1 开始并向上移动到 36。我使用这些来比较两个图像，被命名的图像，color1.pgn，color2.pgn，color3.pgn等。因此：

```
 <img src="Color1.png">      - works

   <img src="Color<%=trim(bytCompareArray(1,1))%>.png">         - works 
```

但

```
 <img src="Color<%=trim(bytCompareArray(bytID_Compare,1))%>.png">         - fails

  <img src="Color<%=trim(bytCompareArray(<%=bytID_Compare%>,1))%>.png">    - fails

  <img src="Color<%=trim(bytCompareArray%>(<%=bytID_Compare%>,1)).png">    - fails 
```

有什么建议么。这个想法是使用数组对 9 个图像中的每一个进行所有 36 次比较（8 + 7 + 6 + 5 + 4 + 3 + 2 + 1 = 36）。谢谢。瑞克

它失败了，因为它给了我一个损坏的图像图标。如果我单击该图标并要求它“在新窗口（或选项卡）中打开图像”它会这样做 - 直到现在我才意识到。现在我们走得更远了。我一直在 Safari 中进行测试 - 它在 Safari 中失败。它适用于 Chrome 和 Firefox。所以现在的问题只是为什么它在 Safari 中失败了？那么，有没有办法让它在 Safari 中工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-23T21:17:25.397

尝试 `<img src="Color<%=trim(bytCompareArray(cint(bytID_Compare),1))%>.png">` 数组下标需要整数变量，如果 bytID_Compare 是任何其他格式，它将不接受。除此之外，第一个示例看起来不错。

由于嵌套的 ASP 标记，第二个示例不起作用。

第三个示例不起作用，因为 trim(bytCompareArray 本身没有被 ASP 验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T08:53:37.433

```
<img src="Color<%=trim(bytCompareArray(1,1))%>.png"> 
```

相当于

```
<img src="Color<% Response.Write (trim(bytCompareArray(1,1))) %>.png"> 
```

线条

```
<img src="Color<%=trim(bytCompareArray(<%=bytID_Compare%>,1))%>.png"> 
```

和

```
<img src="Color<%=trim(bytCompareArray%>(<%=bytID_Compare%>,1)).png"> 
```

有嵌套 <%= %> 标签

您应该重写这些行以遵循工作行的格式，如下所示

```
<img src="Color<%=trim(bytCompareArray(bytID_Compare,1))%>.png"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T06:17:35.160

如果您说在新选项卡中打开图像可以正常工作，这听起来像是缓存问题。

尝试将一些更改的值附加到图像 URL：

```
<img src="Color<%=trim(bytCompareArray(bytID_Compare,1))%>.png?t=<%=CLng(Timer())%>" /> 
```

这将附加将每秒更改的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-17T07:13:53.653

我认为这

```
<img src="Color<%=trim(bytCompareArray(bytID_Compare,1))%>.png"> 
```

应该管用。

检查 byteID_Compare 在 1 到 36 范围内的值是否正确。查看源以查找 src 是否具有正确的链接。还可以尝试添加不包括域名的完整路径，例如

```
<img src="/Images/Color<%=trim(bytCompareArray(bytID_Compare,1))%>.png">. 
```

如果图像在根文件夹中，请尝试以下操作

```
<img src="/Color<%=trim(bytCompareArray(bytID_Compare,1))%>.png"> 
```

希望这可以帮助...

# c# - HtmlAgilityPack XPath 错误

> ID：12148441
> 
> 赞同：3
> 
> 时间：2012-08-27T19:36:36.163
> 
> 标签：c#, xpath, html-agility-pack

我正在尝试使用 C# + XNA 和 HtmlAgilityPack 解析网页，但是当尝试根据这篇文章[HTML Agility pack - 解析表中的示例解析表格时](https://stackoverflow.com/questions/655603/html-agility-pack-parsing-tables)

我遇到了一些非常奇怪的问题。这是我在另一篇文章中稍作修改的代码：

```
foreach (HtmlNode table in doc.DocumentNode.SelectNodes("//table"))
{
    spriteBatch.DrawString(font, table.Id, new Vector2(0, num * 16), Color.Black);
    num++;
    foreach (HtmlNode row in table.SelectNodes("tr"))
    {
        spriteBatch.DrawString(font, "row", new Vector2(0, num * 16), Color.Black);
        num++;
        foreach (HtmlNode cell in row.SelectNodes("th|td"))
        {
            spriteBatch.DrawString(font, "cell: " + cell.InnerText, new Vector2(0, num * 16), Color.Black);
        }
    }

} 
```

但是，当我用断点点击第一行时，我收到了一个奇怪的错误，我在这里截取了我的问题的屏幕截图： ![http://i.imgur.com/JxzJ9.png](../Images/539abcda7b6857005b3245de74b4b550.png)

但是，如果我删除断点，当我点击第二个 foreach 循环时，我只会收到 NullReferenceException 错误。我假设我没有返回任何带有 XPath 的实际表，但第一个错误让我感到困惑。如果这只是一个 Xpath 问题，我会花更多时间尝试了解如何使用它。

这是我要解析的网页：

```
<div class="page">
    <header>

        <nav>
            <ul id="menu">
                <li><a href="/">Home</a></li>
                <li><a href="/Home/About">About</a></li>
                <li><a href="/Score">Scoreboard</a></li>
            </ul>
        </nav>
    </header>
    <section id="main">

<h2>High Scores</h2>
<div id="grid">
<table class="grid">
<thead>
<tr class="head">
<th scope="col">
    <a href="/Score?sort=Name&amp;sortdir=ASC">Name</a>
</th>

<th scope="col">
    <a href="/Score?sort=Points&amp;sortdir=DESC">Points</a>
</th>

<th scope="col">
    <a href="/Score?sort=Date&amp;sortdir=ASC">Date</a>
</th>
</tr>
</thead>

<tbody>
<tr>
    <td>sec_goat</td>
    <td>10</td>
    <td>9/8/1980 12:00:00 AM</td>
</tr>

<tr class="alt">
    <td>tankorsmash</td>
    <td>100</td>
    <td>10/10/2010 12:00:00 AM</td>
</tr>

<tr>
    <td>sec_goat</td>
    <td>1000</td>
    <td>8/12/2012 12:00:00 AM</td>
</tr>

<tr class="alt">
    <td>tankorsmash</td>
    <td>10000</td>
    <td>12/12/2012 12:00:00 AM</td>
</tr>

<tr>
    <td>sec_goat</td>
    <td>100000</td>
    <td>1/1/2013 12:00:00 AM</td>
</tr>

<tr class="alt">
    <td>tankorsmash</td>
    <td>1000000</td>
    <td>9/18/2012 12:00:00 AM</td>
</tr>

<tr>
    <td>bob</td>
    <td>99999999</td>
    <td>9/8/1980 12:00:00 AM</td>
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T08:33:25.667

如果您使用以下代码，它将按预期工作：

```
var doc = new HtmlDocument();
doc.LoadHtml(HTML);
foreach (HtmlNode table in doc.DocumentNode.SelectNodes("//table"))
{
    foreach (HtmlNode row in table.SelectNodes("//tr"))
    {
        foreach (HtmlNode cell in row.SelectNodes("th|td"))
        {
            //don't use .ChildNodes[1] in real code, only works for <th>.
            Debug.WriteLine(cell.ChildNodes[1].InnerHtml); 
        }
    }
} 
```

如您所见，我将 XPath 语句从“tr”更改为“//tr”。如果您有兴趣更熟悉 XPath 语法，我会向您推荐这个页面：[http ://www.w3schools.com/xpath/xpath_syntax.asp](http://www.w3schools.com/xpath/xpath_syntax.asp)

# c# - 在asp中修剪mp4文件

> ID：12148444
> 
> 赞同：0
> 
> 时间：2012-08-27T19:36:41.623
> 
> 标签：c#, asp.net, video, mp4

我需要编写一个 ASP 处理程序，它将返回一个修剪过的 mp4 视频文件。我将指定文件名、开始时间和结束时间。

现在我只有返回整个视频文件的处理程序。问题是如何将其切成碎片。

```
public void ProcessRequest(HttpContext context)
{
    fileName = context.Request.QueryString["filename"];
    start = float.Parse(context.Request.QueryString["start"]);
    end = float.Parse(context.Request.QueryString["end"]);

    context.Response.ContentType = "video/mp4";
    context.Response.WriteFile("~/videofile.mp4");
} 
```

我已经阅读了一些关于 MP4 文件、标题等的主题，但这并不容易。如果我找到一种方法来计算单个帧的字节数。但是如何使用可变比特率来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:42:32.187

如果您可以运行系统命令来运行命令行实用程序（如 ffmpeg）为您剪切文件。这是最简单的方法。

```
 ffmpeg -i input-file -ss <start time> -t <duration>  -acodec copy -vcodec copy out.mp4 
```

否则，以编程方式修剪 mp4 太麻烦了。让ffmpeg为你做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T10:32:53.753

我设法使用基于 MediaInfo 获取的元数据的简单计算来复制文件的某些部分。

我复制整个标题，然后复制部分视频和音频流。但这仅在我从视频开头开始时才有效。当我希望它在 2 秒后启动时，文件已完全损坏。

此外，标头元数据表明它仍然是原始持续时间，即使它只有 4 秒。

寻找也相当不准确。视频比应有的时间长约 10%。

也许有一些方法可以在流中找到搜索点？

# c - 如何在C中散列双链表节点？

> ID：12148447
> 
> 赞同：3
> 
> 时间：2012-08-27T19:36:51.397
> 
> 标签：c, linked-list, hash

我正在实现一个数据结构；项目在范围内的双链表。我想在 O(1) 中查找一个项目是否存在。为此，我想散列键将是项目和值将是节点的节点。

在 Java 中，有内置函数来支持这种特性。

**编辑：** 简而言之，我想要 C 中的 hashMap 之类的东西。

我应该怎么做才能在 C 中实现它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:39:01.177

如果您将项目存储在链接列表中，那么也将它们存储在哈希中以进行遏制测试似乎......不是最理想的。只需使用哈希表开始，如果您需要它不支持的操作（O(1) 包含测试），请停止使用链表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T05:21:33.847

创建一个名为“buckets”的数组，其中包含键和值，以及用于创建链表的可选指针。

当您使用键访问哈希表时，您使用自定义哈希函数处理该键，该函数将返回一个整数。然后你取结果的模数，这就是你的数组索引或“桶”的位置。然后你用存储的密钥检查未散列的密钥，如果匹配，那么你找到了正确的位置。

否则，您就发生了“冲突”，必须爬过链表并比较键，直到匹配为止。（注意一些实现使用二叉树而不是链表来解决冲突）。

查看这个快速哈希表实现：

[http://attractivechaos.awardspace.com/khash.h.html](http://attractivechaos.awardspace.com/khash.h.html)

# java - Apache POI 选择一个单元格多个对象

> ID：12148452
> 
> 赞同：0
> 
> 时间：2012-08-27T19:37:23.433
> 
> 标签：java, apache, apache-poi

我想提供一张桌子，如图所示。在列中应选择天数。他们可以在图片中看到我已经将天数作为列表，但是，添加我想在单元格中选择 2 3 天。对我来说现在这行不通。我只能在牢房中选择一天。

![在此处输入图像描述](../Images/62dee011157b9107cb05d3b32bc07b38.png)

我的代码看起来如此。

```
 static void addDayChooserConstraint2Cell(Sheet sheet, int rowNumber,
        int columnNumber) {
    DataValidationHelper dvHelper = sheet.getDataValidationHelper();
    DataValidationConstraint dvConstraint = dvHelper
            .createExplicitListConstraint(daysOfWeek());
    CellRangeAddressList addressList = new CellRangeAddressList(1, rowNumber,   columnNumber, columnNumber);
    DataValidation validation = dvHelper.createValidation(dvConstraint,
            addressList);
    validation.setShowErrorBox(true);
    sheet.addValidationData(validation);
}

static String[] daysOfWeek(){
    String[] daysOfWeek=new String[]{
            "MONDAY",
            "TUESDAY",
            "WEDNESDAY",
            "THURSDAY",
            "FRIDAY",
            "SATURDAY", 
            "SUNDAY"
    };
    return daysOfWeek;
} 
```

你可以在图片中看到，我只能选择一天。我想在一个单元格中选择超过 1 天 ![在此处输入图像描述](../Images/6e413c61d91082b927396a2859176bc8.png)

我也有一个可视化的 BASIC 代码 gefindet。我可以将此代码更改为 Apache poi 吗？

我想这样做 ![在此处输入图像描述](../Images/c166f900bee197c30097c08fdcce7c32.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T02:37:44.743

```
//this might help u
CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);
DVConstraint dvConstraint = DVConstraint .createExplicitListConstraint(new String[] { "Ann", "Ben", "Cam" });
DataValidation dataValidation = new HSSFDataValidation(addressList,dvConstraint);
dataValidation.setSuppressDropDownArrow(false);
sheet.addValidationData(dataValidation); 
```

# c - dlopen 会为具有相同文件的两个调用产生相同的句柄吗？

> ID：12148454
> 
> 赞同：8
> 
> 时间：2012-08-27T19:37:30.110
> 
> 标签：c, linux, plugins, shared-libraries

如果我在同一个应用程序运行中对同一个库/文件使用 dlopen 两次，它会在两种情况下产生相同的句柄吗？对此有什么保证吗（一个简短的实验表明它至少在我的盒子上是这样）？

我目前正在玩一个小插件系统（出于好奇），如果对这种观察到的行为有某种保证，我可以使用这个地址作为插件的键来防止重复加载。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-27T19:40:23.480

是的。[dlopen(3)](http://linux.die.net/man/3/dlopen) linux手册页说：

> ```
>  If the same library is loaded again with dlopen(), the same file 
>    handle is returned. The dl library maintains reference counts for 
>    library handles, so a dynamic library is not deallocated until 
>    dlclose() has been called on it as many times as dlopen() 
>    has succeeded on it. 
> ```

顺便说一句，在 Linux 系统上，您可以 dlopen 很多（数十万个）共享库，正如我的示例[manydl.c](http://starynkevitch.net/Basile/manydl.c)所示。主要限制是地址空间。所以实际上，不用担心`dlclose`-ing 的东西是可能的。

^(（除非你的 dlopen-ed 共享库有奇怪的或消耗资源的构造函数或析构函数）)

^(2017 年 12 月新增：)

请注意，相关的是传递给`dlopen`. 因此，如果您使用`"./foo.so"`and `"././foo.so"`（或 符号链接`"../foosymlink.so"`在哪里），dlopen-ed 句柄是不同的，并且在某些情况下，可能会发生该共享库的两个实例的奇怪行为。 `foosymlink.so``foo.so`

^(2019 年 6 月添加：)

另请阅读 Drepper 的[*如何编写共享库*](https://www.akkadia.org/drepper/dsohowto.pdf)论文（它也很好地解释了如何*使用*它们！）。

# php - 使用 PHP 获取 MySQL table.column 命名记录

> ID：12148457
> 
> 赞同：0
> 
> 时间：2012-08-27T19:37:33.560
> 
> 标签：php, mysql

例如：

我有正常的列名：

> 从...中选择**列**

我在 PHP 中检索它的方式：

```
$var = $row["column"]; 
```

我想知道的是如何检索以列和表命名的列记录：

> 选择**table.column**从...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:43:13.807

它的工作方式完全相同，它不会以表格为前缀。

因此，如果您执行`SELECT table.* FROM`...，并且其中一个列名是 tacos。你还是可以的`$row['tacos']`。

现在，如果您正在执行多个表（连接），如果它们具有相同的名称（例如“id”）可能会变得不明确。所以你可以给它们起别名`SELECT table.column as new_name FROM`......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:43:58.667

您不会使用*table.column*返回它们。也许使用别名？可以在表/字段名称部分之间使用分隔符。

```
SELECT column AS tableName_ColumnName FROM.... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T19:58:21.153

在我看来，您正在尝试从多个表中进行选择，这可以通过使用连接来完成：

假设您有 3 个表，您需要通过唯一 ID 从所有表中获取信息。您可以通过使用左连接来完成此操作：

```
SELECT a.uniqid, a.testingDate, a.testscore, a.testresults,b.email_addy, b.phone1, c.testlevel as tlevel 
FROM Tbl1 a
LEFT JOIN Tbl2 b
ON a.Tbl1 = b.Tbl2 
LEFT JOIN Tbl3 c
on a.Tbl1 = c.Tbl3 
```

然后，您可以像往常一样提取信息： $var = $row['testingdate']

# java - 我应该如何调用类静态初始化？

> ID：12148460
> 
> 赞同：2
> 
> 时间：2012-08-27T19:37:37.170
> 
> 标签：java, static, annotations, initialization

我有许多 GUI 元素类型，并在 GUI 加载后直接在代码中使用它们。除非 GUI 加载器需要知道现有元素来创建它们，否则这将是可以的。

```
public final class VerticalBox extends Element {

    ...

    private static final ElementType type;
    static {
        type = ElementType.register("VerticalBox",
                new ElementType.ICreator() {
                    @Override
                    public Element create(GUI gui) {
                        return new VerticalBox(gui);
                    }
                });
    }

    @Override
    public ElementType getType() {
        return type;
    }
} 
```

最简单的方法是在每个元素类中创建静态`init`函数，但我需要为每个元素类调用`init`它们。

我在 JavaEE 中看到了一些注释，但它们似乎以相反的方式工作。我可以`annotations`从得到一切`class`，但不能`classes`从`annotation`。我在这个话题上做了很多谷歌搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T09:49:01.870

也许你对[这个答案](https://stackoverflow.com/questions/4107498/how-to-build-a-list-of-classes-annotated-with-my-custom-annotation)感兴趣，或者，如果你的类被分成几个你想保持独立的 jar，那么[ServiceLoader 机制](http://docs.oracle.com/javase/6/docs/api/index.html?java/util/ServiceLoader.html)可能对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:40:30.857

你想在这里使用某种依赖注入，它将按需初始化。值得一看的是 Spring Framework，或者 Google Guice，或者 Pico Container。

在大多数情况下，使用静态块是个坏主意，因为您无法完全控制它们，而且它会使单元测试变得非常复杂 - 测试的顺序确实很重要。

# jquery - 带撇号的 JSON 值

> ID：12148468
> 
> 赞同：6
> 
> 时间：2012-08-27T19:38:23.400
> 
> 标签：jquery, json, coldfusion, apostrophe

我有一个包含 JSON 字符串的 rel 属性的元素，例如：

```
rel='{"id":"#id#","name":"#name#"}' 
```

然后，在我的 javascript 代码中，我`$.parseJSON`用来解析这些数据。这可以正常工作 - 除了`name`包含撇号的情况。我尝试过使用`jsStringFormat`冷融合`replace`，用转义的单引号等替换所有单引号，但我似乎无法找到正确的解决方案。我知道这可能很简单，但是如何让代码使用 json 正确传递带有撇号/单引号的值？

此代码有效，但消除了我想保留的撇号：

```
rel='{"id":"#id#","name":"#replace(name,"'","","all")#"}' 
```

这不起作用：

```
rel='{"id":"#id#","name":"#replace(name,"'","\'","all")#"}' 
```

也没有：

```
rel='{"id":"#id#","name":"#replace(name,"'","\\\'","all")#"}' 
```

或者：

```
rel='{"id":"#id#","name":"#replace(name,"'","&quot;","all")#"}' 
```

或者：

```
rel='{"id":"#id#","name":"#jsStringFormat(name)#"}' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T20:10:27.680

在玩了很多之后，我终于得到了这个工作:)

```
rel='{"id":"#id#","name":"#replace(name,"'","&##39;","all")#"}' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T11:47:04.450

您遇到的问题是因为您在两种情况下处理字符串。您需要确保字符串在两者中都是安全的。

**JSON字符串：**

使代码 JSON 安全的最简单方法是使用[SerializeJSON 函数](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-79fa.html)将 ColdFusion 对象转换为有效的 JSON。

因此，您的代码可能变为：

```
rel='#SerializeJSON({"id"=Variables.id,"name"=Variables.name})#' 
```

**HTML 属性字符串：**

您需要处理的下一个上下文是您希望字符串成为有效的 html 属性值。

[在 ColdFusion 10 中，您可以使用EncodeForHTMLAttribute 函数](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WS932f2e4c7c04df8f-6f7941141353e2963af-7ffe.html)来处理这个问题。

```
rel='#EncodeForHTMLAttribute(SerializeJSON({"id"=Variables.id,"name"=Variables.name}))#' 
```

如果您使用的是 CF10 之前的东西，那么使用 ESAPI 编码器是您最好的选择。（这包含[在 ColdFusion 某些版本的补丁中](http://www.petefreitag.com/item/788.cfm)）

```
rel='#CreateObject("java", "org.owasp.esapi.ESAPI").encoder().encodeForHTMLAttribute(SerializeJSON({"id"=Variables.id,"name"=Variables.name}))#' 
```

我个人使用辅助 CFC 来处理 CF9 中的 ESAPI 编码器，因此 CreateObject 只被调用一次，并在其方法的所有用途中重复使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T19:45:21.870

在 JavaScript 中，用 . 转义字符串中的单引号`\`。

在 HTML 中，您应该真正使用双引号作为属性，并转义双引号，例如：

```
rel="{&quot;id&quot;:&quot;#id#&quot;,&quot;name&quot;:&quot;#name#&quot;}" 
```

# powershell - Powershell脚本：读取AD属性并设置为环境变量

> ID：12148469
> 
> 赞同：1
> 
> 时间：2012-08-27T19:38:25.570
> 
> 标签：powershell, active-directory, environment-variables

我的一些旧应用程序有问题，我需要从 AD 设置环境变量（万岁）

我对 PS 脚本很陌生，所以我可以使用一些帮助。

在我的广告中，我已经`departmentNumber`用信息填充了属性，这部分工作正常。

现在我需要创建一个登录脚本，该脚本从当前用户（属性： `departmentNumber`，派生自：）读取此字段，`inetOrgPersonUser`并将其设置为名为`AFDELING`.

我知道这可以使用 VB 脚本来完成，但我更喜欢 PS。谁能帮我解决这个问题？

在此先感谢您的帮助，

彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:29:47.910

在 PowerShell 中使用环境变量涉及特殊变量`$Env`，不幸的是，您需要使用 .NET 方法来设置环境变量，因为不存在 cmdlet（至少从 v2 开始）：

```
[Environment]::SetEnvironmentVariable("AFDELING", "DeptNo", "User") 
```

第一个字符串参数是变量名，第二个是值，第三个基本上是为变量请求的持久性级别：`Machine`，`User`或者`Process`- 机器和用户都将在重新启动后继续存在，并且未来的应用程序将可以访问它们，尽管您将需要使用管理帐户运行 PowerShell 才能修改机器级变量。

获取用户信息应该同样容易。您可以通过多种方式访问​​ Active Directory，但在您的情况下最简单的方法之一是使用[System.DirectoryServices.DirectoryEntry](http://msdn.microsoft.com/en-us/library/system.directoryservices.directoryentry.aspx)类：

```
$de = New-Object System.DirectoryServices.DirectoryEntry
$DeptNo = $de.Properties["departmentNumber"] 
```

这应该从域控制器查询当前用户记录，并将 departmentNumber 属性的值分配给 $DeptNo 变量。然后，您可以将该变量弹出到第一个示例中的第二个参数中。

# magento - 谷歌结帐与 magento 的集成

> ID：12148477
> 
> 赞同：1
> 
> 时间：2012-08-27T19:39:11.733
> 
> 标签：magento, google-checkout, magento-1.7

我正在尝试将 Google Checkout 添加到我的 magento 1.7.0.0 商店。我已经追踪了这个问题，并且在发布到谷歌服务器时似乎失败了，因为当我尝试阅读响应时它是错误的。

我得到的错误是：**Google Checkout：Google Checkout 服务器的响应无效**

我正在使用 magento 1.7、带有沙箱凭据的谷歌沙箱、经过验证的银行帐户、未经检查的数字签名购物车，但我在我的开发机器上使用自签名证书和 API 版本 2.2。

问题发生在 app/code/core/Mage/GoogleCheckout/Model/Api/Xml/Abstract.php 第 174、175 行

```
$http = new Varien_Http_Adapter_Curl();
$http->write('POST', $url, '1.1', $headers, $xml);
$response = $http->read(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T06:26:58.357

不是`PHP`开发者~

这是*沙盒* `server to server`（购物车）POST 吗？查看：

*   您在标头中使用*[沙盒凭据](https://developers.google.com/checkout/developer/Google_Checkout_XML_API#https_auth_scheme)*；
*   您要发布到您要发送的 xml的*[沙盒 url](https://developers.google.com/checkout/developer/Google_Checkout_XML_API#urls_for_posting)*

注意 - 取消选中“数字购物车”仅意味着您的帐户*也*将接受 HTML API 购物车 POST，但这并不意味着*如果直接向 Google 发送 FORM 邮件，*您可以在没有数字签名的情况下发送 XML - re：在 XML API 中，您[有 2发送`XML`数据](https://developers.google.com/checkout/developer/Google_Checkout_XML_API#create_checkout_cart)的选项：

1.  直接`HTML FORM`POST 到 Google（必须包括签名），或者；
2.  服务器到服务器 POST 到 Google（必须使用基本身份验证凭据）

您还可以检查您的*沙盒集成控制台*以获取详细的错误消息：

`Tools -> Integration Console`

嗯...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T20:45:51.383

它是本地环境存在问题。问题要么是 Google 无法通信，要么是我的 tld 以 .dev 结尾。谷歌可能出于这个原因拒绝了该请求。

# objective-c - 设置子视图帧大小

> ID：12148478
> 
> 赞同：0
> 
> 时间：2012-08-27T19:39:13.127
> 
> 标签：objective-c, xcode

这就是我将 XIB 视图加载为子视图的方式：

```
UIViewController *nameController = [[NameSubViewController alloc] initWithNibName:@"NameSubViewController" bundle:nil];
UIView *subView = [nameController view];
[self.view addSubview:subView]; 
```

但随后它占据了整个屏幕。如何使子视图帧大小与 XIB 相同？(320 x 350)

像 CGRect 50, 50, 320, 350

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:46:33.693

明白了，必须在 NameSubViewController viewDidLoad 中设置大小，而不是 MainViewController init。

# file - 提取 .bin 文件

> ID：12148483
> 
> 赞同：1
> 
> 时间：2012-08-27T19:39:32.357
> 
> 标签：file, extract, bin

所以我的电脑上有一本旧字典，很旧，我找不到它的开发者或网站的任何踪迹（我猜它甚至还没有作为官方软件发布）。我有一个个人项目，我可能需要翻译其中的一些词（大约 200-300），我看到包含数据库/文件列表的数据文件夹内，但我无法提取或读取这些文件。有什么方法可以将这些 .bin 文件提取或转换为文本格式或可读的格式。我使用了一些工具，例如（酒精 120%、isobuster、magiso、Izarc），但没有运气。我不断收到错误消息，说它不是有效的 cd 图像文件。

所以我在想这种类型的 .bin 文件可能不像你可以挂载和读取的 .bin 或 .iso cd 文件，在这种情况下可能还有其他东西。

如果您有任何信息，请回复您的建议。

十分感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:57:54.430

`.bin`是那些被过度使用的扩展之一，并且可能是任何东西......文件最初来自什么？您是否需要转换这些单词并将它们存储回原始文件（以转换后的形式），然后期望原始应用程序正常工作？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:42:16.193

您可以尝试使用字符串实用程序从文件中提取字符串。它随任何 Linux 发行版一起提供，如果你在 Windows 上，你可以从[Windows Sysinternals](http://technet.microsoft.com/en-us/sysinternals/bb897439.aspx)获得它。

如果你很幸运并且单词没有被编码，你也许可以得到你正在寻找的数据。

# html - CSS 固定宽度 li 和固定跨度

> ID：12148484
> 
> 赞同：0
> 
> 时间：2012-08-27T19:39:40.967
> 
> 标签：html, css

我在这里写了问题：[CSS fixed width in span](https://stackoverflow.com/questions/12148108/css-fixed-width-in-span)

并且仅使用'text-align：right;'就有解决方案。但现在：

```
 The lazy dog.
ANDDDDDDDDDDDDDD The lazy cat.
              OR The active goldfish. 
```

如果我有很长的权利部分：

```
 The lazy dog.
ANDDDDDDDDDDDDDD The lazy cat lazy cat lazy cat lazy cat
very lazy cat lazy cat very.
              OR The active goldfish. 
```

这确实是个问题，我需要：

```
 The lazy dog.
ANDDDDDDDDDDDDDD The lazy cat lazy cat lazy cat lazy cat
                 very lazy cat lazy cat very.
              OR The active goldfish. 
```

那么，可以使用 span 和 ul-li 吗？

这是示例：http: [//jsfiddle.net/gBdMf/](http://jsfiddle.net/gBdMf/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:43:45.907

考虑使用定义列表而不是无序列表。

见：[http ://www.the-art-of-web.com/css/format-dl/](http://www.the-art-of-web.com/css/format-dl/)

并且：[http ://www.css-101.org/articles/glossary-and-table-format/definition-list.php](http://www.css-101.org/articles/glossary-and-table-format/definition-list.php)

# svn - SVN 与修订号合并抓取太多文件

> ID：12148485
> 
> 赞同：3
> 
> 时间：2012-08-27T19:39:46.617
> 
> 标签：svn

我正在使用 SVN 1.6 版，并且在使用命令行合并时遇到了很多问题。我正在尝试将单个修订版（我们称之为修订版#5）从一个分支合并到另一个分支。

我正在使用命令行进行合并。我在要合并的分支中进行了 CD，并且正在尝试以下命令：

*   svn 合并 -r4:5 FROMBRANCH 。
*   svn 合并 -r4:5 FROMBRANCH
*   svn 合并 -c5 FROMBRANCH 。
*   svn 合并 -c5 FROMBRANCH

这些命令似乎都不能正常工作。每次我发出合并命令然后执行“svn 状态”时，我都会得到一个很长的文件列表。该列表包括修订版 #5 中的文件，以及我不想合并的许多其他文件。

（注意：我一直在确保没有使用“svn status”在本地更改任何文件。我还一直在使用“svn revert .-R”在每次合并尝试后恢复更改）

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:48:15.607

“svn status”显示的文件的长列表可能是由于“ **mergeinfo** ”属性更新。

正如[这里](http://blogs.collab.net/subversion/2009/11/where-did-that-mergeinfo-come-from/)解释的那样， 当合并到 <target branch> 时，Subversion 会更新 <target branch> 的所有子树中的现有 mergeinfo，这些子树具有 mergeinfo 属性集。

这种意外行为已在 Subversion 1.7 中得到解决

> （来自**Subversion 1.7**更新日志）
> 
> 如果子树不受合并影响，则合并不再在子树（具有自己的显式合并信息）上记录合并信息（描述合并）。对于拥有大量具有显式合并信息的子树的用户，这应该会大大减少虚假 svn:mergeinfo 属性更改的数量。
> 
> 如果正在合并的更改包含 svn:mergeinfo 修改，这些仍将被应用，就像任何其他属性修改一样。因此，如果要合并的更改本身是使用 1.5 或 1.6 客户端执行的另一个合并的结果，则仍然可能发生过多的子树合并信息更改。仅由 1.7 客户端创建和维护的新分支将获得最佳结果。

# php - PHP $_GET 没有正确读取我的 AJAX URL

> ID：12148488
> 
> 赞同：0
> 
> 时间：2012-08-27T19:39:55.600
> 
> 标签：php, ajax, get

我不确定问题是什么，但我的猜测是 $_GET 变量不会正确读取我的 ajax URL，因为我的深层链接插件。

最终 URL 类似于：/dashboard.php#/projectSetup.php?mode=edit&getJobNumber=2012-30

这是我的PHP：

```
$getJobNumber = $_GET['getJobNumber'];
$mode = $_GET["mode"]; 
```

当我回显 $mode 或 $getJobNumber 时，我没有得到结果。我认为这个问题与 URL 的格式有关。注意 2 个 .php 文件和中间的 #。

如果有人知道解决方法，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:42:29.800

你完全正确。url后面的任何内容`#`都被视为“文档片段”，不会发送到服务器。

[在URL RFC](http://www.ietf.org/rfc/rfc1738.txt)中对“片段”进行“查找” ，您将很快看到`#`在您的 url 中使用其他任何内容通常与 Internet 不兼容。

# c# - Linq to Sql 一般帮助 - 插入语句

> ID：12148495
> 
> 赞同：0
> 
> 时间：2012-08-27T19:40:39.330
> 
> 标签：c#, linq-to-sql, insert

我目前正在尝试在 Web 服务中创建一个新订单（如下所示），然后发送该数据以将新行插入数据库。出于某种原因，我的 DBML / 数据上下文不允许我使用 InsertOnSubmit。

有任何想法吗？我已经有大约 7 个月没有使用过 Linq to Sql 了。

提前致谢。

```
[WebMethod]
    public string InsertOrderToDatabases()
    {
        //Start Data Contexts ------
        DataContext db = new DataContext(System.Configuration.ConfigurationManager.AppSettings["RainbowCMSConnectionString"]);
        DataContext dcSqlOES = new DataContext(System.Configuration.ConfigurationManager.AppSettings["OESConnectionString"]);

        //Get table from local database
        Table<Schedule> Schedule = db.GetTable<Schedule>();

        //Find last order number in databases
        var lastOrderNumber = from lOrder in Schedule
                              orderby lOrder.templ_idn descending
                              select lOrder.templ_idn;

        int firstOrderID;
        var firstOrder = lastOrderNumber.FirstOrDefault();
        firstOrderID = firstOrder.Value + 1;

        qrOrder qrOrd = new qrOrder
        {
            .... data in here creating a new order

        };

        //TODO: fix below with an insert on submit
        if (qrOrd != null)
        {
        //    **Schedule.InsertOnSubmit(qrOrd);**
        }
        //db.GetTable<Schedule>().InsertOnSubmit(qrOrd);

        try
        {
            //Submit the changes to the database
            db.SubmitChanges();
            return "Orders were sent to the databases.";
        }
        catch ()
        {

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:48:05.040

根据您的回复，您似乎使用了错误的表，或者可能是错误的数据类型。我还注意到，当您声明局部`Schedule`变量时，您将其声明为 type `Table<Schedule>`，这意味着它应该包含`Schedule`实体，而不是`qrOrder`实体。

[`Table<TEntity>.InsertOnSubmit`](http://msdn.microsoft.com/en-us/library/bb763516.aspx)期望传入一个特定的强类型实体。在您的情况下，它是期望`Web_Service.Schedul‌e`的，但您试图传入一个`qrOrder`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:45:21.013

```
 Schedule.InsertOnSubmit(qrOrd); 
```

该行将不处理向连接实体提交更改，试试这个

```
 db.Schedule.InsertOnSubmit(qrOrd);
    db.SubmitChanges(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T19:47:28.593

你可以试试

```
db.GetTable(typeof(Schedule)).InsertOnSubmit(qrOrd); 
```

或者

```
 db.GetTable(qrOrd.GetType()).InsertOnSubmit(qrOrd); 
```

# embedded - 在中断中调用 LPC17xx 睡眠模式和软件复位错误

> ID：12148501
> 
> 赞同：1
> 
> 时间：2012-08-27T19:41:05.007
> 
> 标签：embedded, microcontroller

我的睡眠模式和 NVIC_reset() 都有问题，也就是软件重置。

问题出现在两个完全不同的板上，都带有 LPC1769 uC。

如果我在 main() 或其他函数（中断例程除外）中进入睡眠模式，则睡眠模式可以正常工作。uC 也通过 EINT0 上的外部中断唤醒。重置函数在主函数中也能很好地完成它的工作。

但是，当在中断例程中调用睡眠模式或复位请求时，麻烦就开始了。似乎进入了睡眠模式，但 uC 不再唤醒。

例如，使用 EINT1 进入睡眠模式并使用 EINT0 唤醒：

```
void EINT0_IRQHandler(void)
{
  EXTI_ClearEXTIFlag(0);
}

void EINT1_IRQHandler(void)
{
    EXTI_ClearEXTIFlag(1);
    CLKPWR_Sleep();
} 
```

有人知道为什么这不能正常工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:52:57.603

你检查过你的中断优先级吗？

> 34.3.5.2.1 从 WFI 唤醒或退出时休眠
> 通常，处理器只有在检测到具有足够优先级的异常以导致异常进入时才会唤醒。

# python - 同一个 @property 可以在 SQLAlchemy 中同时呈现标量和集合行为吗？

> ID：12148503
> 
> 赞同：0
> 
> 时间：2012-08-27T19:41:11.700
> 
> 标签：python, database, orm, properties, sqlalchemy

我正在转换一个库以使用[SQLAlchemy](http://www.sqlalchemy.org/)作为数据存储。我喜欢 PickleType 列的灵活性，但它在酸洗 SA 对象（表行）时似乎效果不佳。即使我在 unpickling 时重载 setstate 和 getstate 以进行查询+会话合并，也没有跨越该 pickle 边界的引用完整性。这意味着我无法查询对象集合。

```
class Bar(Base):
    id = Column(Integer, primary_key=True)
    __tablename__ = 'bars'
    foo_id = Column(Integer, ForeignKey('foos.id'), primary_key=True)

class Foo(Base):
    __tablename__ = 'foos'
    values = Column(PickleType)
    #values = relationship(Bar)  # list interface (one->many), but can't assign a scalar or use a dictionary
    def __init__(self):
        self.values = [Bar(), Bar()]

        # only allowed with PickleType column
        #self.values = Bar()
        #self.values = {'one' : Bar()}
        #self.values = [ [Bar(), Bar()], [Bar(), Bar()]]

# get all Foo's with a Bar whose id=1
session.query(Foo).filter(Foo.values.any(Bar.id == 1)).all() 
```

一种解决方法是实现我自己的可变对象类型，如此[处所示](https://github.com/ccat/sqlalchemy_examples/blob/master/mutable_example/mutable_alwayUpdate.py#L51)。我想象有某种扁平化方案，它遍历集合并将它们附加到更简单的 one->many 关系。也许扁平列表可能必须是腌制集合对象的弱引用？

跟踪更改和引用听起来并不有趣，而且我在其他任何地方都找不到任何人腌制 SA 行的例子（也许表明我的设计不好？）。有什么建议吗？

**编辑1**：经过一些[讨论](https://groups.google.com/d/msg/sqlalchemy/ERtGy5NCtqc/x4PsnsOyGwYJ)，我简化了请求。我正在寻找一个可以作为标量或集合的单一**属性**。这是我的（失败的）尝试：

```
from sqlalchemy import MetaData, Column, Integer, PickleType, String, ForeignKey, create_engine
from sqlalchemy.orm import relationship, Session
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm.collections import attribute_mapped_collection

# from http://www.sqlalchemy.org/trac/browser/examples/vertical
from sqlalchemy_examples.vertical import dictlike_polymorphic as dictlike

metadata = MetaData()
Base = declarative_base()
engine = create_engine('sqlite://', echo=True)
Base.metadata.bind = engine
session = Session(engine)

class AnimalFact(dictlike.PolymorphicVerticalProperty, Base):
    """key/value attribute whose value can be one of several types"""
    __tablename__ = 'animalfacts'
    type_map = {#str: ('string', 'str_value'),
                list: ('list', 'list_value'),
                tuple: ('tuple', 'tuple_value')}
    id = Column(Integer, primary_key=True)
    animal_id = Column(Integer, ForeignKey('animal.id'), primary_key=True)
    key = Column(String, primary_key=True)
    type = Column(String)
    #str_value = Column(String)
    list_value = relationship('StringEntry')
    tuple_value = relationship('StringEntry2')

class Animal(Base, dictlike.VerticalPropertyDictMixin):
    __tablename__ = 'animal'
    _property_type = AnimalFact
    _property_mapping = 'facts'

    id = Column(Integer, primary_key=True)
    name = Column(String)
    facts = relationship(AnimalFact, backref='animal',
                          collection_class=attribute_mapped_collection('key'))

    def __init__(self, name):
        self.name = name

class StringEntry(Base):
    __tablename__ = 'stringentry'
    id = Column(Integer, primary_key=True)
    animalfacts_id = Column(Integer, ForeignKey('animalfacts.id'))
    value = Column(String)

    def __init__(self, value):
        self.value = value

class StringEntry2(Base):
    __tablename__ = 'stringentry2'
    id = Column(Integer, primary_key=True)
    animalfacts_id = Column(Integer, ForeignKey('animalfacts.id'))
    value = Column(String)

    def __init__(self, value):
        self.value = value

Base.metadata.create_all()

a = Animal('aardvark')
a['eyes'] = [StringEntry('left side'), StringEntry('right side')]  # works great
a['eyes'] = (StringEntry2('left side'), StringEntry2('right side'))  # works great
#a['cute'] = 'sort of'  # failure 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:59:59.490

PickleType 确实是一种解决边缘情况的 hacky 方法，在这种情况下，您有一些任意对象，您只想推开。可以肯定的是，当您使用 PickleType 时，您将放弃任何关系优势，包括能够过滤/查询它们等。

因此，将 ORM 映射对象放在 Pickle 中基本上是一个糟糕的主意。

如果您想要一个标量值的集合，请结合使用传统映射和 relationship() 与 association_proxy。请参阅[http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/associationproxy.html#simplifying-scalar-collections](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/associationproxy.html#simplifying-scalar-collections)。

“或字典”。使用attribute_mapped_collection： [http ://docs.sqlalchemy.org/en/rel_0_7/orm/collections.html#dictionary-collections](http://docs.sqlalchemy.org/en/rel_0_7/orm/collections.html#dictionary-collections)

“字典加标量”：结合attribute_mapped_collection和association_proxy：[http ://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/associationproxy.html#proxying-to-dictionary-based-collections](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/associationproxy.html#proxying-to-dictionary-based-collections)

**编辑1**：嗯，你在那里挖掘了一个非常深奥和复杂的例子。Association_proxy 是一种更简单的方法来解决您希望对象像标量一样行为的这些情况，所以这就是，没有“垂直”示例的所有疯狂样板，我会避免使用它，因为它真的太复杂了。您的示例似乎未决定主键样式，因此我使用了复合版本。代理+复合不能混合在一个表中（它可以，但它的关系不正确。键应该是标识行的最小单位 - [http://en.wikipedia.org/wiki/Unique_key](http://en.wikipedia.org/wiki/Unique_key)是一个很好的顶级阅读有关此的各种主题）。

```
from sqlalchemy import Integer, String, Column, create_engine, ForeignKey, ForeignKeyConstraint
from sqlalchemy.orm import relationship, Session
from sqlalchemy.orm.collections import attribute_mapped_collection
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.ext.associationproxy import association_proxy

Base = declarative_base()

class AnimalFact(Base):
    """key/value attribute whose value can be either a string or a list of strings"""
    __tablename__ = 'animalfacts'

    # use either surrogate PK id, or the composite animal_id/key - but
    # not both.   id/animal_id/key all together is not a proper key.
    # Personally I'd go for "id" here, but here's the composite version.

    animal_id = Column(Integer, ForeignKey('animal.id'), primary_key=True)
    key = Column(String, primary_key=True)

    # data
    str_value = Column(String)
    _list_value = relationship('StringEntry')

    # proxy list strings
    list_proxy = association_proxy('_list_value', 'value')

    def __init__(self, key, value):
        self.key = key
        self.value = value

    @property
    def value(self):
        if self.str_value is not None:
            return self.str_value
        else:
            return self.list_proxy

    @value.setter
    def value(self, value):
        if isinstance(value, basestring):
            self.str_value = value
        elif isinstance(value, list):
            self.list_proxy = value
        else:
            assert False

class Animal(Base):
    __tablename__ = 'animal'

    id = Column(Integer, primary_key=True)
    name = Column(String)
    _facts = relationship(AnimalFact, backref='animal',
                          collection_class=attribute_mapped_collection('key'))
    facts = association_proxy('_facts', 'value')

    def __init__(self, name):
        self.name = name

    # dictionary interface around "facts".
    # I'd just use "animal.facts" here, but here's how to skip that.
    def __getitem__(self, key):
        return self.facts.__getitem__(key)

    def __setitem__(self, key, value):
        self.facts.__setitem__(key, value)

    def __delitem__(self, key):
        self.facts.__delitem__(key)

    def __contains__(self, key):
        return self.facts.__contains__(key)

    def keys(self):
        return self.facts.keys()

class StringEntry(Base):
    __tablename__ = 'myvalue'
    id = Column(Integer, primary_key=True)
    animal_id = Column(Integer)
    key = Column(Integer)
    value = Column(String)

    # because AnimalFact has a composite PK, we need
    # a composite FK.
    __table_args__ = (ForeignKeyConstraint(
                        ['key', 'animal_id'],
                        ['animalfacts.key', 'animalfacts.animal_id']),
                    )
    def __init__(self, value):
        self.value = value

engine = create_engine('sqlite://', echo=True)
Base.metadata.create_all(engine)

session = Session(engine)

# create a new animal
a = Animal('aardvark')

a['eyes'] = ['left side', 'right side']

a['cute'] = 'sort of'

session.add(a)
session.commit()
session.close()

for animal in session.query(Animal):
    print animal.name, ",".join(["%s" % animal[key] for key in animal.keys()]) 
```

# java - 在Java窗口中嵌入c++ opengl窗口

> ID：12148505
> 
> 赞同：1
> 
> 时间：2012-08-27T19:41:14.700
> 
> 标签：java, jna, hwnd, user32, setparent

我正在尝试在 java 窗口中嵌入一个 c++ opengl 窗口。我可以通过套接字将 opengl 窗口的 HWND 发送到 java 窗口。我宁愿不使用 JNI，因为我想要 2 个单独的进程（为什么不重要）。我进行了搜索，发现这可以通过使用 User32 的函数 SetParent(HWND childWindow, HWND parentWindow) 来实现。但是，我无法正确使用它或找不到使用 User32 的步骤。所以这可能是与[在 JPanel 中嵌入 HWND（窗口句柄）](https://stackoverflow.com/questions/4809713/embed-hwnd-window-handle-in-a-jpanel)相关的问题，这正是我想要做的，但我无法重现解决方案，因为我无法使用 User32（无法解决）甚至如果我进行了以下导入： import com.sun.jna.Library; 导入 com.sun.jna.Native；导入com.sun.jna.Platform；进口com。

我也无法使用 WComponentPeer，但我没有对该主题进行太多搜索。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T14:54:57.177

您需要来自 JNA 的 platform.jar 的[User32](http://twall.github.com/jna/3.4.1/javadoc/com/sun/jna/platform/win32/User32.html#SetParent%28com.sun.jna.platform.win32.WinDef.HWND,%20com.sun.jna.platform.win32.WinDef.HWND%29)接口映射。

请参阅[这些说明](https://github.com/twall/jna/blob/master/www/GettingStarted.md)以开始使用。

# nsurl - 通过 [NSData dataWithContentsOfURL:...] 读取文件后，文件的 AccessDate 未更改

> ID：12148507
> 
> 赞同：8
> 
> 时间：2012-08-27T19:41:22.717
> 
> 标签：nsurl

我正在文件系统中缓存一些用户信息。然后阅读使用

```
NSData *cachedMessagesData = [NSData dataWithContentsOfURL:fileDirectoryForUserInfoCache]; 
```

但是，当我使用 Property 键检查访问时间时，我需要知道每个缓存文件的访问时间：

```
NSArray *filesInUserInfoCacheDirectory = [self.fileManager contentsOfDirectoryAtURL:self.cacheDirectoryForUserInfo includingPropertiesForKeys:[NSArray arrayWithObjects:@"NSURLCreationDateKey", @"NSURLContentAccessDateKey", nil] options:NSDirectoryEnumerationSkipsHiddenFiles error:nil];

NSDate *accessDate = [[[filesInUserInfoCacheDirectory lastObject] resourceValuesForKeys:[NSArray arrayWithObject:@"NSURLContentAccessDateKey"] error:nil] objectForKey:@"NSURLContentAccessDateKey"]; 
```

我发现访问日期与文件创建日期相同。通过 [NSData dataWithContentOfURL:...] 读取文件不会更改文件的访问时间属性。

谁能告诉我为什么？有没有办法读取文件以更新访问时间？提前非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T09:51:15.263

回答我自己的问题。我终于不得不工作了一点。NSURL 文件的访问日期属性在读取文件后无法更新，它的日期始终与 NSURL 文件的创建日期相同。一种解决方法是每次读取后覆盖文件，然后更新访问日期。但这对我来说听起来很奇怪。

另一种方法是使用 NSURL 文件的修改日期属性。这个属性可以通过 FileManager 的 API setAttributes: ofItemAtPath: 来设置。每次读取文件后，我都设置了修改日期属性，而不是实际修改文件。然后稍后通过 NSURL API resourceValuesForKeys: 读回这个 NSDate 对象。

```
[self.fileManager setAttributes:[NSDictionary dictionaryWithObject:[NSDate date] forKey:NSFileModificationDate] ofItemAtPath:[fileDirectoryForUserInfoCache path] error:nil]; 
```

# java - 显示矩形位置的 0.01 差异？

> ID：12148509
> 
> 赞同：0
> 
> 时间：2012-08-27T19:41:28.330
> 
> 标签：java, swing, graphics2d

今天我需要通过使用双精度或浮点数来定位元素，从而在屏幕上可视化一个大型数据集。使用像素时，我可以使用以下代码简单地绘制一个矩形：

```
gimg.draw(new Rectangle2D.Double(1, 1, 50, 50)); 
```

但是当我尝试使用以下代码绘制两个矩形时，会出现问题。

```
gimg.setColor(Color.white);
gimg.draw(new Rectangle2D.Double(1.0, 1.0, 50, 50));
gimg.setColor(Color.gray);
gimg.draw(new Rectangle2D.Double(1.1, 1.1, 50.1, 50.1)); 
```

这两个矩形是相互重叠的，换句话说，你看不到一个白色和一个灰色的矩形，因为灰色的矩形被绘制在白色的矩形上。

我使用的是 0.1 增量。经过一些测试后，我似乎能够在使用 0.5 增量时查看部分矩形。这里的问题只是我还需要使位置仅相差 0.01 的矩形可见。

我怀疑我在这里遗漏了一些非常重要的东西。任何人都可以向我伸出援助之手吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T19:45:01.163

您应该考虑使用 0.1 : 1 比例，因为像素不能分成十分之一（或任何分数）而不会失去准确性/可呈现性。想象一下你屏幕上的小像素——你试图将一条 1px 的线分成 10 个*可区分*的部分。不幸的是，这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T19:54:34.447

虽然您不能将像素“拆分”成分数，但您可以使用跨越 2 个像素的“模糊”线条绘制矩形。（不幸的是，这将使用比您现在使用的更复杂的代码。）但是，在这种情况下，我认为您需要退后一步，考虑您正在使用的数据的特征以及类型这意味着您希望人们从该数据中提取。

即使可以在屏幕上以微米精度定位矩形，您的用户也无法更好地辨别数据背后的含义，因为*这个*矩形比*那个*矩形更向右 0.0001 毫米。

也许您需要找到比位于屏幕上不同位置的矩形更好的可视化效果。也许您可以利用不同的颜色或颜色强度来传达数据的某些方面。如果不确切知道你在做什么，就不可能说更具体的东西。

# wcf - 缓慢的猎豹没有在 app.config 中转换端点标签

> ID：12148511
> 
> 赞同：1
> 
> 时间：2012-08-27T19:41:32.247
> 
> 标签：wcf, windows-services, app-config, slowcheetah

我喜欢 SlowCheetah，但在我的 app.config 中转换端点时遇到了一些问题。我希望也许有人可以看一下，看看我错过了什么或过去遇到过这个问题。

app.config 默认值

```
 <connectionStrings>

    <add name="MyEntities" connectionString="metadata=res://*/RFPModel.csdl|res://*/RFPModel.ssdl|res://*/RFPModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=developmentServer;initial catalog=databaseName;integrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings>

  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_IMasterEngineService" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None" realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://DevelopmentServer/WebServices/MasterEngine/MasterEngineService.svc" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IMasterEngineService" contract="OverlayFarEnd.IMasterEngineService" name="BasicHttpBinding_IMasterEngineService" />
    </client>
  </system.serviceModel>

</configuration> 
```

发布的转换是：

```
<?xml version="1.0" encoding="utf-8" ?>
<!-- For more information on using transformations 
     see the web.config examples at http://go.microsoft.com/fwlink/?LinkId=214134\. -->

<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">

  <connectionStrings>
    <add name="MyEntities" connectionString="metadata=res://*/RFPModel.csdl|res://*/RFPModel.ssdl|res://*/RFPModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=releaseServer;initial catalog=databaseName;integrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient"  xdt:Transform="Replace" xdt:Locator="Match(name)" />
  </connectionStrings>

  <endpoint address="http://productionServer/WebServices/MasterEngine/MasterEngineService.svc" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IMasterEngineService" contract="OverlayFarEnd.IMasterEngineService" name="BasicHttpBinding_IMasterEngineService"  xdt:Transform="Replace" xdt:Locator="Match(name)">
  </endpoint>

</configuration> 
```

我做的是正常的，创建配置并确保在构建之前我处于正确的配置/环境中，但无论我做什么，即使选择发布环境/配置，它也会保持相同的开发服务器。

有任何想法吗？

-- 更新 -- 根据请求，尝试：

```
<?xml version="1.0" encoding="utf-8" ?>
<!-- For more information on using transformations 
     see the web.config examples at http://go.microsoft.com/fwlink/?LinkId=214134\. -->
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
  <system.serviceModel>
    <client>
      <endpoint address="http://productionServer/WebServices/MasterEngine/MasterEngineService.svc" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IMasterEngineService" contract="OverlayFarEnd.IMasterEngineService" name="BasicHttpBinding_IMasterEngineService"  xdt:Transform="Replace" xdt:Locator="Match(name)" />
    </client>
  </system.serviceModel>

  <connectionStrings>
    <add name="MyEntities" connectionString="metadata=res://*/RFPModel.csdl|res://*/RFPModel.ssdl|res://*/RFPModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=databaseName;initial catalog=dash;integrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient"  xdt:Transform="Replace" xdt:Locator="Match(name)" />
  </connectionStrings>

</configuration> 
```

没用

-再次更新---

首先尝试了您对 connectionString 的建议..无济于事

```
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">

  <connectionStrings>
    <add name="MyEntities" connectionString="metadata=res://*/RFPModel.csdl|res://*/RFPModel.ssdl|res://*/RFPModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=databaseName;initial catalog=dash;integrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient"  xdt:Transform="Replace" xdt:Locator="Match(name)" />
  </connectionStrings>

  <client>
      <endpoint address="productionServerName/WebServices/MasterEngine/MasterEngineService.svc" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IMasterEngineService" contract="OverlayFarEnd.IMasterEngineService" name="BasicHttpBinding_IMasterEngineService"  xdt:Transform="Replace" xdt:Locator="Match(name)" />
    </client>

</configuration> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T14:55:44.613

在我的第一条评论中提出建议后，这对我有用：

*它应该是 system.serviceModel/client/endpoint，而不是 configuration/endpoint。*

## 网页配置

```
<?xml version="1.0"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=152368
  -->

<configuration>
  <appSettings>
    <add key="webpages:Version" value="1.0.0.0"/>
    <add key="ClientValidationEnabled" value="true"/>
    <add key="UnobtrusiveJavaScriptEnabled" value="true"/>
  </appSettings>

  <system.web>
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies>
    </compilation>

    <authentication mode="Windows">

    </authentication>

    <pages>
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages"/>
      </namespaces>
    </pages>
  </system.web>

  <system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>

  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_IMasterEngineService" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None" realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://DevelopmentServer/WebServices/MasterEngine/MasterEngineService.svc" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IMasterEngineService" contract="OverlayFarEnd.IMasterEngineService" name="BasicHttpBinding_IMasterEngineService" />
    </client>
  </system.serviceModel>

</configuration> 
```

## Web.Debug.config

```
<?xml version="1.0"?>

<!-- For more information on using web.config transformation visit http://go.microsoft.com/fwlink/?LinkId=125889 -->

<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
  <!--
    In the example below, the "SetAttributes" transform will change the value of 
    "connectionString" to use "ReleaseSQLServer" only when the "Match" locator 
    finds an atrribute "name" that has a value of "MyDB".

    <connectionStrings>
      <add name="MyDB" 
        connectionString="Data Source=ReleaseSQLServer;Initial Catalog=MyReleaseDB;Integrated Security=True" 
        xdt:Transform="SetAttributes" xdt:Locator="Match(name)"/>
    </connectionStrings>
  -->
  <system.web>
    <!--
      In the example below, the "Replace" transform will replace the entire 
      <customErrors> section of your web.config file.
      Note that because there is only one customErrors section under the 
      <system.web> node, there is no need to use the "xdt:Locator" attribute.

      <customErrors defaultRedirect="GenericError.htm"
        mode="RemoteOnly" xdt:Transform="Replace">
        <error statusCode="500" redirect="InternalError.htm"/>
      </customErrors>
    -->
  </system.web>

  <system.serviceModel>
    <client>
      <endpoint address="http://productionServer/WebServices/MasterEngine/MasterEngineService.svc" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IMasterEngineService" contract="OverlayFarEnd.IMasterEngineService" name="BasicHttpBinding_IMasterEngineService"  xdt:Transform="Replace" xdt:Locator="Match(name)" />
    </client>
  </system.serviceModel>

</configuration> 
```

## 和预览转换比较窗口：

![转换比较](../Images/2f3b61c1df18991375f8c6ff5ebcff98.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T09:00:33.983

尝试 SetAttributes 转换：

```
 <system.serviceModel>       
        <client>           
            <endpoint name="BasicHttpBinding_IMasterEngineService"
address="http://productionServer/WebServices/MasterEngine/MasterEngineService.svc"
binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IMasterEngineService"
contract="OverlayFarEnd.IMasterEngineService" name="BasicHttpBinding_IMasterEngineService"
xdt:Transform="SetAttributes(address)" xdt:Locator="Match(name)"/>
        </client>
    </system.serviceModel> 
```

您可以使用逗号分隔的属性值，您需要更改这些值。虽然只有很差的例子，但希望[这个](http://msdn.microsoft.com/en-us/library/dd465326.aspx)链接会有所帮助。

# knockout.js - 将计算的 observable 添加到数组中的项目

> ID：12148513
> 
> 赞同：0
> 
> 时间：2012-08-27T19:41:49.283
> 
> 标签：knockout.js

在 KnockoutJS 中，我尝试将计算出的 observables 添加到数组的每个项目中：

```
for (var i = 0; i < items().length; i++) {
    var item = items()[i];
    item.valid = ko.computed(function() {
        var valid = true;
        valid = valid && item.firstName() && item.firstName().length > 0;
        valid = valid && item.lastName() && item.lastName().length > 0;
        return valid;
    });
} 
```

这总是会更新所有出现的`valid()`，并且仅适用于数组的最后一项。

我认为这是一种上下文问题，但我不明白。

完整的代码可以在[这个 jsfiddle](http://jsfiddle.net/AlexZeitler/ftaXe/6/)中找到。

### 更新

[我在这里](http://www.underwatergorilladome.com/how-to-use-knockouts-computed-observables-with-the-mapping-plugin/)找到了基于映射选项的解决方案。

[可以在此处](http://jsfiddle.net/AlexZeitler/PAhPq/2/)找到基于该解决方案的 jsfiddle 。

唉，这需要针对来自 AJAX 的不同数据（根据是否需要有效属性）以不同方式调用映射。

映射完成后有没有办法有效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:03:39.263

我更新了你的小提琴，以展示一个更清晰的例子：

[http://jsfiddle.net/JasonMore/s9Rmp/2/](http://jsfiddle.net/JasonMore/s9Rmp/2/)

这是我现在用于映射的实时代码片段。它可能会帮助您前进。DisplayViewModel 是最终被绑定的父视图模型。

```
// helpers

var dateConvert = {
    create: function (options) {
        return new Date(parseInt(options.data.substr(6)));
    }
};

var viewModelConvert = function (viewModelType) {
    return {
        create: function (options) {
            return new viewModelType(options.data);
        }
    }
};

// View Models

var layoutViewModel = function (data) {
    var self = this;

    ko.mapping.fromJS(data, {}, this);

    this.ShowText = ko.computed(function () {
        var val = self.ValueType();
        return val !== contentType.Image && val !== contentType.Html;
    });

};

var zoneViewModel = function (data) {
    var self = this;

    ko.mapping.fromJS(data,
        {
            'Layouts': viewModelConvert(layoutViewModel)
        }, this);
};

var presentationViewModel = function (data) {
    var self = this;

    // Mapping
    ko.mapping.fromJS(data,
        {
            'Zones': viewModelConvert(zoneViewModel)
        }, this);
};

var eventViewModel = function (data) {
    var self = this;

    ko.mapping.fromJS(data,
        {
            'Presentations': viewModelConvert(presentationViewModel),
            'EndDateTime': dateConvert,
            'StartDateTime': dateConvert
        }, this);
};

var fontViewModel = function (data) {
    var self = this;

    ko.mapping.fromJS(data, {}, this);

    this.fontFace = ko.computed(function () {
        return "@font-face {font-family: '" + self.Name() + "'; src:url('" + settings.fontUrl + self.FileName() + "')}";
    });
};

var displayViewModel = function (data) {
    var self = this;

    this.init = function () {

    };

    ko.mapping.fromJS(data,
        {
            'Events': viewModelConvert(eventViewModel),
            'Fonts': viewModelConvert(fontViewModel)
        }, this);
}; 
```

# css - 将 Segoe UI Light 下载到 Web 应用程序中

> ID：12148514
> 
> 赞同：1
> 
> 时间：2012-08-27T19:41:57.633
> 
> 标签：css, fonts

我怎么可能让**Segoe UI Light**用作使用 Sass/CSS 的 Rails 3.2 Web 应用程序的字体。

我已经研究了很多，似乎他们[在这里只提供](http://www.ascendercorp.com/font/segoe-ui/)*Segoe UI Mono*字体（一种完全不同的字体）

我过去一直在为一些 Google Web 字体使用**@import**方法，我想知道我怎么可能对 Segoi UI Light 字体做同样的事情/或者是否有不同的方法来下载/在我的应用程序。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T00:16:23.753

您可以使用[http://www.fontsquirrel.com/fontface/generator](http://www.fontsquirrel.com/fontface/generator)等在线网络字体转换器将 ttf 字体转换为多种网络兼容格式。

但是，我认为，您无权在网站上分发 Segoe UI，因此您只能将其用于非公共私人项目。

# solr - 为什么 Solr 返回被否定的结果？

> ID：12148515
> 
> 赞同：0
> 
> 时间：2012-08-27T19:42:00.113
> 
> 标签：solr

考虑以下 Solr 查询：

```
text:linux -img_src:jpg -img_src:jpeg -img_src:youtube 
```

Solr 仍在返回`img_src`字段中包含否定项的结果：

```
 <doc>
    <str name="img_src">
      http://lh3.ggpht.com/-zek96i2kouM/R9HZD2U-d9I/AAAAAAAAC7Q/Zf_QHmiL10w/Stress.jpg
    </str>
  </doc>
  <doc>
    <str name="img_src">
      http://lh3.ggpht.com/-zek96i2kouM/R9HZD2U-d9I/AAAAAAAAC7Q/Zf_QHmiL10w/Stress.jpg
    </str>
  </doc>
  <doc>
    <str name="img_src">
      http://farm9.staticflickr.com/8436/7787223734_5962d16624.jpg
    </str>
  </doc>
  <doc>
    <str name="img_src">
      http://farm8.staticflickr.com/7246/7787084482_8ee833cc45.jpg
    </str>
  </doc> 
```

显然我做错了什么。那可能是什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:02:21.583

我遇到了类似的问题。我相信我使用[过滤器查询](http://wiki.apache.org/solr/CommonQueryParameters#fq)来达到预期的结果，例如：

```
 ?q=text:linux&fq=-img_src:jpg&fq=-img_src:jpeg&fq=-img_src:youtube 
```

# html - 标签和标签有 什么区别 标签？

> ID：12148517
> 
> 赞同：8
> 
> 时间：2012-08-27T19:42:06.037
> 
> 标签：html

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-27T19:44:14.020

语义。`<ins>`标签表示在首次发布后插入的内容。该`<u>`标签仅用于下划线，没有任何意义。

参考：[`<ins>`](http://www.w3.org/wiki/HTML/Elements/ins),[`<u>`](http://www.w3.org/wiki/HTML/Elements/u)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-27T20:10:58.270

官方差异取决于您选择视为官方的 HTML 规范或草案。

在 HTML 4.01 规范中，`u`意味着带下划线的文本样式，而`ins`意味着其内容已“插入 [...] 相对于不同版本的文档（例如，在立法者需要查看更改的立法草案中）。`ins`未指定渲染；相反，描述了一些可能的渲染。实际上，浏览器大多使用下划线。还有一种形式上的语法差异，`u`它只允许文本级内容，而`ins`也可能包含块。

在 HTML5 草案中，`ins`本质上是相似的，但措辞不同，并且有一个明确的建议，或者可能是（半）建议，默认渲染使用下划线（参见[10.3.4 Phrasing content](http://www.w3.org/TR/html5/rendering.html#phrasing-content-1) there）。之前从草案中`u`排除，现在添加，但具有虚构的含义：“u 元素表示一段文本，具有未明确表达但明确呈现的非文本注释，例如将文本标记为中文文本中的专有名称（中文专有名称标记），或将文本标记为拼写错误。” 如果这对您没有意义，那么您不是唯一一个。并且`u`具有作为建议或推荐的默认渲染的下划线。

在实践中，效果基本相同，只是`ins`一些旧浏览器会忽略标签。一些异国情调的浏览器可以使用不同的渲染。我没有看到任何浏览器、搜索引擎或任何其他相关软件对两者进行区分的证据；它们的“语义差异”没有实际影响。

`ins`但是，在某种意义上，除了插入的文本之外，我不会使用任何东西，只是因为某些未来的浏览器可能会以某种方式处理它，这对插入的文本有意义，但不是其他方式。`ins`仅用于下划线不会有明显的好处：`u`标记更短，支持更广泛。再说一次，您应该在网页上为文本（链接除外）加下划线的情况很少见。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-27T19:44:03.790

`ins`是一个语义标签：它表示已插入的元素（另请参见`del`删除的元素），同时`u`为引擎提供将元素渲染为下划线的指令。

一些引擎可能决定呈现`ins`为，`u`但您可以使用“语义”来决定以其他方式呈现它（使用 CSS）。说到 CSS，它渲染`<u>`无用，只会让样式维护变得更加困难，就像`<b>`,`<center>`等等。

至于其他版本标签，`del`它并没有被广泛使用，也不清楚为什么应该这样。

参考 ：

[http://www.w3.org/TR/html-markup/ins.html](http://www.w3.org/TR/html-markup/ins.html)

[http://www.w3.org/TR/html-markup/del.html](http://www.w3.org/TR/html-markup/del.html)

[http://www.w3.org/TR/html-markup/u.html](http://www.w3.org/TR/html-markup/u.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-27T19:58:54.100

1.  `ins`有一个含义：此文本是在以后插入的。
2.  `u`没有任何意义，它只是告诉浏览器在上面加一些下划线。（尽管 CSS 可以像任何其他元素一样覆盖它，但该元素自 4.0 以来一直毫无意义的原因之一）
3.  `ins`是在 4.0 中引入的，并且仍然是最新的。
4.  `u`至少在 2.0 中引入（HTML1.0 从未真正停止工作，因此 2.0 是第一个真正的标准），并在 4.0 中弃用
5.  `u`是内联的，所以`<p><u>this is valid</u></p>`但是`<u><p>this makes no sense</p></u>`. `ins`是极少数既可以是块又可以是内联的元素之一（在 5.0 中，还有一些内联元素被赋予了这种状态），所以`<p><ins>this is valid</ins></p><ins><p>this is also valid</p></ins>`.
6.  `ins`有一个可选`cite`属性，给出文档的 URI（或文档中的片段，可能与它所在的文档相同）解释更改，并`datetime`以[W3 日期时间格式](http://www.hackcraft.net/web/datetime/#w3cdtf)给出更改的日期。

因此：

1.  如果下划线表示添加的内容，请使用`ins`.
2.  如果您想指示添加的内容，但不是通过下划线，请使用`ins`并使用 CSS 来更改它的显示方式。
3.  永远不要使用`u`。HTML 的历史是一场噩梦，我们正试图从中醒来。
4.  如果您出于其他原因想要下划线，那么要么选择最符合您的意思的元素，使用`div`或者`span`如果您真的不能做得更好，然后使用 CSS 来给它加下划线。

# batch-file - 如何使批处理文件等待另一个批处理文件然后继续文件的其余部分

> ID：12148524
> 
> 赞同：1
> 
> 时间：2012-08-27T19:42:38.563
> 
> 标签：batch-file, cmd

```
@echo off
goto start
:start

if exist console.ccmf (
PAUSE
ren console.ccmf console.bat
ping 123.45.67.89 -n 1 -w 500 > nul
START /wait console.bat
ren console.bat console.ccmf
goto exit
) 
```

我真的很想找到一种不使用 vbs 脚本的方法。只是为了填写...这是一个重命名程序然后启动它的程序。目的是当所述文件关闭时，它会重命名为原来的名称并退出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T01:17:03.993

使用该`CALL`功能。`Start`真正用于启动窗口程序并打开另一个控制台，CALL 停留在已经打开的一个控制台窗口中。

```
@echo off
goto start

:start
if exist console.ccmf (
    PAUSE
    ren console.ccmf console.bat
    ping 123.45.67.89 -n 1 -w 500 > nul
    CALL console.bat
    ren console.bat console.ccmf
    goto exit
) 
```

# c# - 没有从c#中的字符串中获取第三个字符

> ID：12148525
> 
> 赞同：-1
> 
> 时间：2012-08-27T19:42:42.000
> 
> 标签：c#, int

在这里，如果我的用户名是 Rus7AE，那么我想取数值，即右起第三个字符。te 7\. 下面的代码没有返回值 7 吗？

studentA 由第 5-7 个标准组成 studentB 由第 8-10 个标准组成 studentC 由第 5-10 个标准组成，这是公共组，但不包含来自 studentA 和 studentB 的相同值

```
private void authcheck()
        {
            username = Session["stud"].ToString();
            schlName = Session["stuschname"].ToString();

        string value = username.ToString();
        int groupName = Convert.ToInt32(value[value.Length - 3]);            

        Session["grpName"] = groupName.ToString();
} 
```

我怎样才能得到倒数第三个值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:46:30.413

您正在尝试将字符转换为数值，这不会给出预期的结果。

尝试

```
int groupName = int.Parse(value.Substring(value.Length - 3, 1)); 
```

如果您可能会收到不是这种格式的数据，请查看[int.TryParse](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)。

Convert.ToInt32 不起作用，因为它根据当前编码获取字符的实际值并将其转换为字符。例如，

```
int val = Convert.ToInt32('7'); 
```

产生 55，这是 '7' 的 ASCII 或 UTF-8 代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T19:51:38.987

您没有得到倒数第三个值，因为条件错误

```
if
    5-7
else if
    8-10
else if 
    5-10 
```

在这种情况下，最后一个永远不会被击中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T19:53:11.330

因为你的组号中可以有“10”（正如我在你的代码中看到的那样），也许还有更多的两位数（11、12、13 等），我们应该在这里使用正则表达式......

```
var regex = new Regex(@"\w+(\d+)\w+");

int groupNumber;
var match = regex.Match(subjectString);
if(!match.Success || !match.Groups[1].Success || !int.TryParse(match.Groups[1].Value, out groupNumber))
    throw new Exception("Student has no group!?!?");

string groupName = null;
switch(groupNumber){
    case 5:
    case 6:
    case 7:
        groupName = "studentA";
    break;

    case 8:
    case 9:
    case 10:
        groupName = "studentB";
    break;

    case 1:
    case 2:
    case 3:
    case 4:
        groupName = "studentC";
    break;

    default:
        throw new Exception("invalid group number");
} 
```

# android - 如何检查是否单击了 LinearLayout

> ID：12148526
> 
> 赞同：0
> 
> 时间：2012-08-27T19:42:49.610
> 
> 标签：android, android-layout, android-linearlayout

这是我的 xml 文件，你可以看到它被线性布局嵌套了很多次。

* * *

> 我想要实现的是，当我单击 llOptionA（第一个线性布局）区域时，我会收到一个 toast 通知。

* * *

我还在 llOptionA.setonclickListener() 上祝酒，但是当我单击文本时，它什么也不做。

然后我还在他们每个人上设置了 onclicklisteners，给了我不同的祝酒词-> svTest，layout_inner，tvOptionA。而且我到处点击查看哪个部分显示哪个吐司。

```
 <LinearLayout
            android:id="@+id/llOptionA"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:background="#ff00ff"
            android:paddingLeft="30dp"
            android:paddingRight="30dp"
            android:paddingTop="5dp" >

            <HorizontalScrollView
                android:id="@+id/svTest"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent" >

                <LinearLayout
                    android:id="@+id/layout_inner"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:orientation="vertical" >

                    <TextView
                        android:id="@+id/tvOptionA"
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:maxLines="1"
                        android:text="A - Option A "
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:textColor="#ffffff"
                        android:textStyle="bold" />
                </LinearLayout>
            </HorizontalScrollView>
        </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T19:48:44.967

**首先**，默认情况下，即使您设置了 OnClickListener，LinearLayout 也不侦听单击事件。您还需要将此属性添加到您的 LinearLayout `llOptionA`：

```
android:clickable="true" 
```

**其次**，单击从最高级别 TextView 开始`tvOptionA`，然后一直向下运行，直到 View 使用此事件。因此，在它到达`llOptionA`您的 Horizo​​ntalScrollView 之前，它会拦截默认 OnTouchListener 中的点击，并且不会将其传递给您的`llOptionA`……您可以在 Horizo​​ntalScrollView 中使用 OnTouchListener 侦听点击事件以调用适当的方法。

**第三**，也许这是一个简化的布局，但 LinearLayout`layout_inner`只有一个孩子，因此没有必要，你可以简单地使用这个：

```
<LinearLayout ...>
    <HorizontalScrollView ...>
        <TextView .../>
    </HorizontalScrollView>
</LinearLayout> 
```

当然`llOptionA`只有一个孩子，所以你可以更简化它：

```
<HorizontalScrollView ...>
    <TextView .../>
</HorizontalScrollView> 
```

* * *

**从评论添加**

以下是如何将它们组合在一起：

```
public class Example extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        LinearLayout linearLayout = (LinearLayout) findViewById(R.id.llOptionA);
        linearLayout.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                toast();
            }
        });

        HorizontalScrollView hsv = (HorizontalScrollView) findViewById(R.id.svTest);
        hsv.setOnTouchListener(new OnTouchListener() {
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                if(event.getAction() == MotionEvent.ACTION_UP)
                    toast();
                return false;
            }
        });
    }

    public void toast() {
        Toast.makeText(this, "Click", Toast.LENGTH_SHORT).show();
    }
} 
```

# jquery - 我可以从 AJAX 延迟回调中访问 Deferred 对象吗？

> ID：12148528
> 
> 赞同：2
> 
> 时间：2012-08-27T19:42:52.977
> 
> 标签：jquery

有什么方法可以从 ajax 的成功回调中访问内部 Deferred 对象？我希望能够将抽象的 ajax 调用传递给函数，但能够将该函数调用包装在 $.when() 中并使用 reject() 和 resolve() 将参数传递回我的 done() 和fail() 回调如下：

```
 $.when(makeCall())
 .done(function(data){
     //do something with data
  })
 .fail(function(message){
     //show error
  });

 function makeCall(){
     return $.ajax({
         url : //some url,
         success : function(data){
              if(!data.someCondition){
                 //i'd like to reject the internal deferred here
                 //and send it back an error message to my
                 //the callers fail method like reject('message')
              }
              else{
                 //i'd like to resolve the deferred here and 
                 //pass back the data to the callers done
                 //method like resolve(data)
              }
         }
     });
 } 
```

现在我将 makeCall() 包装在另一个 Deferred 对象中，并在 ajax 回调中解决或拒绝该对象，但感觉我应该能够在没有额外的 Defered 包装器的情况下做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:49:46.050

不，当时它已经解决或被拒绝。您必须创建自己的 deferred 才能获得此功能。

```
$.when(makeCall())
 .done(function(data){
     //do something with data
  })
 .fail(function(message){
     //show error
  });

 function makeCall(){
     var def = $.Deferred();
     $.ajax({
         url : //some url,
         success : function(data){
              if(!data.someCondition){
                 // reject it
                 def.rejectWith(data.someCondition);
              }
              else{
                 // resolve it
                 def.resolveWith(data);
              }
         }
     });
     return def.promise();
 } 
```

**编辑：**对不起，我没有意识到这已经是您尝试并试图避免的。问题是在成功回调中，延迟对象已经被解决了。到时候就无法撤消了。

**编辑：**
如果发生错误，让您的服务器返回错误状态代码而不是 200 不是更有意义吗？此时，您可以将响应文本解析为 json 并适当地处理错误，而不会比正常情况下更容易弄乱延迟对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T04:51:18.683

我需要这样做以防止出现竞争情况 - 我想完全忽略一些响应

一旦我发现我不能拒绝原来的延期我最终做了这样的事情。不理想，但可以满足我的需要。当然，即使我能够拒绝延迟（或创建我自己的），这也可能不是我想要的，因为它也不是真正的失败条件。

```
function makeCall()
{
     return $.ajax({
         url : //some url,
         success : function(data)
         {
              if (!data.someCondition)
              {
                 data.ignore = true;
              }
         }
     });
 }

 makeCall().done(function(data) 
 {
      if (data.ignore) 
      {
          return;
      }
 }); 
```

# mysql - 期间的动态数据透视表，连接 2 个表

> ID：12148530
> 
> 赞同：0
> 
> 时间：2012-08-27T19:43:02.607
> 
> 标签：mysql, sql, pivot-table

我已经搜索并尝试解决这个难题，所有帮助将不胜感激......

我们使用在线时间表，每个位置都会记录自己的出勤率。工资月为下个月的 23 日至 22 日。

第一个表“员工”，我只需要员工的姓名，姓氏和员工编号（有超过一百名员工和员工离职，定期任命新员工）这里是一个例子：

```
employee_id employee_surname employee_first_name
SAL010  Briel   Stephanus
SAL021  Kwaza   Nakedi
SAL032  Motshabi    Kotsamere
SAL034  Nkonwana    Sibusiso
SAL056  Van Wyk Ben 
```

第二张表“empl_attendance”保存员工考勤数据，每天更新，empl_attendance_total是重要字段，但如果员工由于某种原因不上班，该字段为“0”，则sql必须输出empl_attendance_start 中的描述，例如“OFF”：

```
empl_attendance_date employee_id empl_attendance_start empl_attendance_stop empl_attendance_total location_id
2012/08/23  SAL034  06:00   18:00   11  Middelkraal
2012/08/24  SAL034  06:00   18:00   11  Middelkraal
2012/08/25  SAL034  06:00   18:00   11  Middelkraal
2012/08/26  SAL010  06:00   18:00   11  Middelkraal
2012/08/23  SAL021  18:00   06:00   11  Middelkraal
2012/08/24  SAL021  18:00   06:00   11  Middelkraal
2012/08/25  SAL021  AWOL        0   Middelkraal
2012/08/23  SAL032  OFF     0   Middelkraal
2012/08/24  SAL032  OFF     0   Middelkraal
2012/08/23  SAL056  18:00   06:00   11  Middelkraal 
```

这里 location_id 很重要，因为位置是从上一页预先选择的。所需的输入如下所示，从当月 23 日到下个月 22 日开始。期间也在上一页中选择：

```
employee_id employee_surname    employee_first_name 2012/08/23  2012/08/24  2012/08/25  2012/08/26
SAL010  Briel   Stephanus   11  OFF 11  11
SAL021  Kwaza   Nakedi  11  11  AWOL    11
SAL032  Motshabi    Kotsamere   OFF OFF 8   8
SAL034  Nkonwana    Sibusiso    11  11  11  OFF
SAL056  Van Wyk Ben 11  AWOL    8   8 
```

我第一次使用数据透视表，我的日期每个月都在变化，员工可能会在任何给定时间改变......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:20:04.827

不幸的是，MySQL 没有`PIVOT`函数，因此您需要使用带有`CASE`语句的聚合函数来获得最终结果。

要进行硬编码，您将使用这样的东西（未经测试）：

```
select e.id,
  e.surname,
  e.firstname,
  max(case when a.dt = '2012-08-23' then a.total end) '2012-08-23'
from employee e
inner join attendance a
  on e.id = a.emp_id
group by e.id, e.surname, e.firstname 
```

但是，如果您不知道这些值，那么您将需要使用与此类似的准备好的语句（未经测试）：

```
SET @sql = NULL;
    SELECT
      GROUP_CONCAT(DISTINCT
        CONCAT(
          'MAX(case when yourdate = ''',
          yourdate,
          ''' then a.total END) AS ',
          yourdate
        )
      ) INTO @sql
    FROM
      Results;
    SET @sql = CONCAT('SELECT e.id,
                        e.surname,
                        e.firstname, ', @sql, ' 
                      from employee e
                      inner join attendance a
                        on e.id = a.emp_id 
                      group by e.id, e.surname, e.firstname');

    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt; 
```

这是一个动态枢轴的工作示例：

[在mysql中选择动态列](https://stackoverflow.com/questions/11899647/select-dynamic-columns-in-mysql/11899874#11899874)

# forms - 来自数据库表的 atk4 简单下拉列表

> ID：12148531
> 
> 赞同：1
> 
> 时间：2012-08-27T19:43:09.733
> 
> 标签：forms, atk4

我想从具有 2 列 id 和 name 的表“accountgroups”中填充一个下拉列表。首次加载时，下拉列表的第一行应为空白或“--选择帐户组--”。一旦用户选择了项目（即显示字段“名称”和值字段“id”），我想在提交表单时获取 id 和名称值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-08T14:31:36.503

可能（你的帖子有一年半的时间）你已经解决了你的问题，但无论如何我想为这个问题贡献“我的 2 美分”。我环顾四周（文档、论坛等），都没有找到解决同一问题的其他方法。我的解决方案（经过测试和工作）是这样的（请让我知道效率不够）：

```
>>>>>>>>>>>>>>>>>>>>> ON MODEL
class Model_Offices extends Model_Table {
    public $entity_code='Offices';
    function init(){
        parent::init();
        $this->addField('ID')->ReadOnly(True);
        $this->addField('OfficeName');
    }

    function GetAll() {
        $r=array();
        $AllOffices = $this->SetModel('Offices');
        foreach($AllOffices as $OneOffice) {
            $r[$OneOffice['ID']]=$OneOffice['OfficeName'];
        }
        return $r;
    }
}

>>>>>>>>>>>>>>>>>>>> ON PAGE

        $m=$this->Add('Model_Offices');
        $form->addField('dropdown','Office')->SetValueList($m->GetAll()) ; 
```

麦克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T02:14:03.147

您需要先为您的表创建一个模型：

```
class Model_AccountGroups extends Model_Table {
    public $table='accountgroups';
    function init(){
        parent::init();
        $this->addField('name');
    }
}

$form->addField('dropdown','account_id')->setModel('AccountGroups');

if($form->isSubmitted()){
    $form->js()->univ()->alert('Selected ID='.$form->get('account_id'))->execute();
} 
```

# ios - UIView 组动画

> ID：12148535
> 
> 赞同：0
> 
> 时间：2012-08-27T19:43:29.770
> 
> 标签：ios, animation, core-animation, uiviewanimation

我正在尝试实现以下动画：

```
 yourSubView.transform = CGAffineTransformMakeScale(0.01, 0.01);
[UIView animateWithDuration:0.4 delay:0 options:UIViewAnimationOptionCurveEaseOut animations:^{ 
//change time duration according to requirement
// animate it to the identity transform (100% scale)
yourSubView.transform = CGAffineTransformIdentity;
} completion:^(BOOL finished){
// if you want to do something once the animation finishes, put it here
}]; 
```

结合子视图的一些运动。我知道在核心动画中你可以组合动画，但你怎么能在 UIView 动画中做到这一点？

我可以将此代码从 UIView 动画转换为核心动画吗？

```
yourSubView.transform = CGAffineTransformMakeScale(0.01, 0.01);
[UIView animateWithDuration:0.4 delay:0 options:UIViewAnimationOptionCurveEaseOut animations:^{ 
//change time duration according to requirement
// animate it to the identity transform (100% scale)
yourSubView.transform = CGAffineTransformIdentity;
} completion:^(BOOL finished){
// if you want to do something once the animation finishes, put it here
}]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T19:48:16.547

您可以通过更改多个动画属性来组合动画。例如，您还可以设置 yourSubView.alpha，然后更改动画块内的 alpha。它将比例和 alpha 变化结合在一起。

要进行简单的翻译，请在您的动画块中尝试：

```
yourSubView.transform = CGAffineTransformTranslate(CGAffineTransformIdentity, 100.0, 100.0); 
```

这应该将比例设置回身份，同时在 x 和 y 方向移动 100px。

对于核心动画，[使用 CAAnimationGroup 将两个核心动画分组会导致一个 CABasicAnimation 无法运行](https://stackoverflow.com/questions/2120068/grouping-two-core-animations-with-caanimationgroup-causes-one-cabasicanimation-t)，这应该可以帮助您入门。您将使用 CAAnimationGroup 来组合多个动画，并且可以做一些漂亮的事情，包括 3D 旋转。

缩放：

```
CAKeyframeAnimation *scale = [CAKeyframeAnimation animationWithKeyPath:@"transform.scale"];
[scale setValues:[NSArray arrayWithObjects:[NSNumber numberWithFloat:0.01f],[NSNumber numberWithFloat:1.0f],nil]];
[scale setKeyTimes:[NSArray arrayWithObjects:[NSNumber numberWithFloat:0.0],[NSNumber numberWithFloat:0.4f],nil]];

[mySubview.layer addAnimation:scale forKey:@"myScale"]; 
```

# c# - 在 mvc 和类似架构中，控制器和视图之间的典型间接级别是什么？

> ID：12148540
> 
> 赞同：0
> 
> 时间：2012-08-27T19:43:38.863
> 
> 标签：c#, model-view-controller, indirection

所以说我为主菜单“页面”制作了一个控制器，MainMenu 是直接由标签和按钮等单独的视图元素组成，还是会引用诸如 MainMenuView 之类的具有这些元素的类？还是只是将事件发送到事件系统以与视图进行通信？或者是其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T04:52:50.430

按钮和标签很可能位于 中`View`，尽管标签可能来自`Controller`. 通常 a`View`只是 html 脚手架，其中`View`包含的数据`Model`由`Controller`. 所以对于一个主菜单，它可能只是到其他部分的链接和标签，所以可能不会有`Model`它，`Controller`只会返回`View`.

所以如果有人去`SomeMVCSite.com/home/index`，`Index Action`就会被叫进来`Home Controller`。将`Home Controller`根据 a 从数据库中检索数据`Model`并返回`View`+ 数据。

# c# - 如何将 ExpressionStatementSyntax 转换为 ParenthesizedExpressionSyntax（在表达式周围加上括号）

> ID：12148552
> 
> 赞同：1
> 
> 时间：2012-08-27T19:44:21.633
> 
> 标签：c#, roslyn

假设我在语法树中有 `"".GetType()`which is `ExpressionStatementSyntax`（或者可能是`InvocationExpressionSyntax`），我想把它变成`("".GetType())`，也就是说我想把我的 `ExpressionStatementSyntax`节点变成`ParenthesizedExpressionSyntax`节点。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:31:38.363

```
using System;
using System.Linq;
using Roslyn.Compilers;
using Roslyn.Compilers.CSharp;

class Program
{
    static void Main(string[] args)
    {
        var oldRootNode = Syntax.ParseCompilationUnit(
            "class C { void M() { \"\".GetType(); } }");
        var oldStatementNode = oldRootNode.DescendantNodes().OfType<ExpressionStatementSyntax>().First();
        var oldExpressionNode = oldStatementNode.Expression;
        var newExpressionNode = Syntax.ParenthesizedExpression(oldExpressionNode);
        var newRootNode = oldRootNode.ReplaceNode(oldExpressionNode, newExpressionNode);
        Console.WriteLine(oldRootNode.ToString());
        Console.WriteLine(newRootNode.ToString());
    }
} 
```

# mysql - SQL ORDER BY 两列，以较高者为准

> ID：12148555
> 
> 赞同：5
> 
> 时间：2012-08-27T19:44:35.993
> 
> 标签：mysql, sql

我有一张看起来像这样的桌子

```
ITEM_NAME     | NUM_SOLD | NUM_VIEWS
Apple         |       50 |        75
Orange        |       40 |        85
Pear          |       80 |        70
Cherry        |       15 |        60 
```

我想按最后两列**中**最高的数字对其进行排序。

所以上表的排序如下：

```
ITEM_NAME     | NUM_SOLD | NUM_VIEWS
Orange        |       40 |        85
Pear          |       80 |        70
Apple         |       50 |        75
Cherry        |       15 |        60 
```

你可以看到，通过我输入的数字，它们大多是按 排序的`NUM_VIEWS`，但是因为`Pear`它的`NUM_SOLD`值高于任何一个`Apple`值，所以它在`Orange`和之间排序`Apple`。

这个 Apple and Pear 示例是我无法正常工作的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-27T19:46:34.153

```
ORDER BY GREATEST(num_sold, num_views) 
```

（参见[*MySQL 5.6 参考手册*](http://dev.mysql.com/doc/refman/5.6/en/comparison-operators.html#function_greatest)[`GREATEST(value1,value2,...)`的第 12.3.2 节“比较函数和运算符”](http://dev.mysql.com/doc/refman/5.6/en/comparison-operators.html#function_greatest)*。）*

 ** * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-27T19:50:46.557

```
order by
case when num_sold>num_views 
     then num_sold 
     else num_views 
end 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-01-14T12:33:03.130

正如其他用户所提到的，使用 GREATEST 功能是最合适的。但是，我要补充一点，如果您的列默认为 NULL 或可能包含 NULL 值，您可能需要将您的值[合并为零。](http://dev.mysql.com/doc/refman/5.6/en/comparison-operators.html#function_coalesce)

这是因为**GREATEST 如果传递的任何值为 NULL**（[mysql best() docs](http://dev.mysql.com/doc/refman/5.6/en/comparison-operators.html#function_greatest)）将返回 NULL，因此通过将任一列中具有 NULL 值的所有那些推到降序的底部来影响您的 ORDER BY 子句。

如果您的计数默认*为零*，那么它会很好，但如果它们默认为空，或者您需要此方法用于具有空值的任何其他表，那么这将是必需的。在处理通常具有 NULL 默认值的日期时，我发现了这一点。

```
ORDER BY GREATEST(
    COALESCE(NUM_SOLD, 0),  # returns the column value or zero if null
    COALESCE(NUM_VIEWS, 0)
) 
```

*注意：我没有足够的积分将其放在评论中，但我认为它对于答案来说足够有价值。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T19:49:39.190

我通常会使用 IF 语句

```
IF @a > @b
BEGIN
  SELECT Col1, Col2, ... FROM Table1 Where... ORDER BY Col1
END
ELSE
BEGIN
  SELECT Col1, Col2, ... FROM Table1 Where... ORDER BY Col2
END 
```*

# r - 替换 R 中的行

> ID：12148564
> 
> 赞同：3
> 
> 时间：2012-08-27T19:45:11.183
> 
> 标签：r, comments, rscript

在 R 中，我正在使用 csv 读取带有注释的文件

```
read.data.raw = read.csv(inputfile, sep='\t', header=F, comment.char='') 
```

该文件如下所示：

```
#comment line 1
data 1<tab>x<tab>y
#comment line 2
data 2<tab>x<tab>y
data 3<tab>x<tab>y 
```

现在我使用提取未注释的行

```
comment_ind = grep( '^#.*', read.data.raw[[1]])
read.data = read.data.raw[-comment_ind,] 
```

这让我：

```
 data 1<tab>x<tab>y
 data 2<tab>x<tab>y
 data 3<tab>x<tab>y 
```

我正在通过一些单独的脚本修改这些数据，该脚本维护行数/列数，并希望将其放回原始读取数据（带有用户评论）并像这样将其返回给用户

```
#comment line 1
modified data 1<tab>x<tab>y
#comment line 2
modified data 2<tab>x<tab>y
modified data 3<tab>x<tab>y 
```

由于我在 read.data 中提取的数据保留了行名 row.names(read.data)，所以我尝试了

```
original.read.data[as.numeric(row.names(read.data)),] = read.data 
```

但这不起作用，我得到了一堆 NA/s

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:41:06.260

这是做你想做的吗？

```
read.data.raw <- structure(list(V1 = structure(c(1L, 3L, 2L, 4L, 5L),
   .Label = c("#comment line 1", "#comment line 2", "data 1", "data 2", 
   "data 3"), class = "factor"), V2 = structure(c(1L, 2L, 1L, 2L, 2L), 
   .Label = c("", "x"), class = "factor"), V3 = structure(c(1L, 2L, 1L,
   2L, 2L), .Label = c("", "y"), class = "factor")), .Names = c("V1", 
   "V2", "V3"), class = "data.frame", row.names = c(NA, -5L))

comment_ind = grep( '^#.*', read.data.raw[[1]])
read.data <- read.data.raw[-comment_ind,]
# modify V1
read.data$V1 <- gsub("data", "DATA", read.data$V1)
# rbind() and then order() comments into original places
new.data <- rbind(read.data.raw[comment_ind,], read.data)
new.data <- new.data[order(as.numeric(rownames(new.data))),] 
```

# ios - 水平和垂直分页UIScrollView，即多方向分页

> ID：12148566
> 
> 赞同：1
> 
> 时间：2012-08-27T19:45:17.440
> 
> 标签：ios, cocoa-touch, user-interface, uiscrollview

我正在寻找能够处理多向分页的自定义组件或迷你框架！通过同时支持水平和垂直分页的方式实现多方向！

我实际上想像分组的 UITableView 那样显示数据，按各个部分和行分组。考虑以下数据示例：

Section-A：第 1 行、第 2 行、第 3 行

B 部分：第 1 行

C 部分：第 1 行，第 2 行

这显然是分组 UITableView 的标准用例，没有什么特别的，对吧？

我想要完成的是，将上述数据显示为分页视图！因此，即当我水平分页时，分页是基于部分的，我从 A 部分移动到 B 部分等！当我垂直翻页时，我通过一个部分的单个“行”等“翻页”！我希望你们明白这一点！

从技术上讲，这显然可以通过嵌套 2 个启用分页的 UIScrollView 来实现，通过垂直或水平分页限制单个 UIScrollView。然后以正确的方式用数据（即视图）填充滚动视图等。

另一个要求是具有动态或半动态行为！通过事后添加“部分”和“行”的可能性来实现动态化。就像 UITableView 的实际行为一样，具有“单元”重用等！（半动态意味着我不需要动态“行”插入/删除等，只需一个简单的“reloadData”就足够了）

所以我例如查看了他的 SoloComponents 的 Andrey Vits [ATPagingView](https://github.com/andreyvit/SoloComponents-iOS)！ATPagingView 看起来像是解决我的问题的有前途的基础！我想扩展功能以适应我的要求，但想先征求有关 stackoverflow 的建议！

那么你们对这些人怎么看呢？这实际上是网格组件的用例吗？

是否有一个组件或框架已经满足我的需求，或者直到现在才需要多向分页视图！;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T12:14:36.837

现在我正在为自己试验 ATPagingView，我发现它对其目的非常有用。它提供了一种具有单元重用的无限分页解决方案，并且只需 2 个委托方法即可轻松设置。

为什么不将单个 ATPagingView 实例包装到一个“父”UIScrollView 中，其中每个 ATPagingView 代表您的用例中的一个“部分”！在每个 ATPagingView 中，您都会将页面作为“行”。您可以将外部（即父级）UIScrollView 设置为仅水平页面，并将单个 ATPagingViews 设置为垂直滚动。

您需要外部 UIScrollView 中的一些样板代码（例如 numberOfSections 等）来管理“内部”ATPagingViews，但我认为这将是一种可行的方法。

# html - 从 Chrome 的 x-webkit-speech 语音识别中抓取音频

> ID：12148571
> 
> 赞同：3
> 
> 时间：2012-08-27T19:45:28.067
> 
> 标签：html, google-chrome, webkit

文本输入字段中的 x-webkit-speech 属性可在 Google Chrome 浏览器中启用语音识别。

```
<input type="text" x-webkit-speech /> 
```

音频被发送到谷歌。有没有办法将录制的音频在发送到 Google 的服务器之前将其发送到其他地方？这是修改 Chrome 源代码的一种方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:05:23.800

不要认为你可以（轻松）抓住它。安全问题恕我直言。

作为替代方案，您可以使用闪光灯（用户必须允许麦克风录音）

# android - 钛使用带有 imageView 的borderRadius 设置

> ID：12148574
> 
> 赞同：0
> 
> 时间：2012-08-27T19:45:31.907
> 
> 标签：android, ios, titanium

我希望 imageView“图像”属性周围有一个边框。但是，在 android 系统上，这不起作用 - 至少在开发人员视图中不起作用。

发生的是图像显示，没有边框。我认为它以某种方式位于边框的“顶部”......有没有办法在 imageView 图像上设置边框？

不，我不一定控制图像......所以我不能只是手动添加边框！另外，我的意思是：

```
var theImage = Ti.UI.createimageView({
    borderRadius: 5,
    ....
});
theImage.image = "xyz"; 
```

其中，在上述情况下，没有观察到边界半径！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T05:38:18.873

这仅适用于完整的 ImageView 覆盖图像。

这不适用于 imageView 对象中的图像属性

这适用于 backgroundImage 属性

你试试这个代码这当然可以工作（真的）

```
var theImage = Ti.UI.createimageView({
    borderRadius: 5,
    ....
});

theImage.backgroundImage = "xyz.jpg"; 
```

试试这个 N 享受 Titanium SDK...干杯...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:18:35.177

你是在定义`borderWidth`属性吗？

如果是这样，则图像可能位于边界上。因此，只需尝试`theImage`使用圆形边框添加到另一个视图，如下所示：

```
var theImageContainer = Ti.UI.createView({
    borderColor  : 'red',
    borderRadius  : 5
    borderWidth : 3
    ... Positioning and size stuff etc...
});

theImageContainer.add(theImage); 
```

有点黑客，但这可能是钛的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-05T11:12:02.330

也许新的 SDK 在此期间解决了这个问题。但我建议用视图包装图像并将边框应用于包装器。像这样的东西：

```
var wrapper = Ti.UI.createView({
     width: Ti.UI.SIZE, 
     height: Ti.UI.SIZE, 
     borderRadius: 5, 
     borderWidth: 2, 
     borderColor: 'red',
});
var img = Ti.UI.createImageView({
    image: '...',
    width: 50,
    height: 50,
});
wrapper.add(img); 
```

# openjpa - OpenJPA 审计功能

> ID：12148576
> 
> 赞同：0
> 
> 时间：2012-08-27T19:45:43.307
> 
> 标签：openjpa, auditing

我有一个 Web 服务，它将持久化和删除数据库中的数据。我想在数据库中跟踪哪些用户名触及了数据库的哪些行。在每个表中都有用于存储用户名的列（如果您愿意，请更新列）。表上还有触发器，它们将获取事务的用户 ID，并使用尝试插入的用户名和密码更新该表。有没有办法在开放的 JPA 中获取用户名（将从客户端传递）并更新某种 JPA 对象，以便当 JPA 持久化数据时，该用户名将被扔到表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:54:10.653

最简洁的方法之一是为您的实体实现一个通用的[“映射”超类](http://www.objectdb.com/api/java/jpa/MappedSuperclass)，并使用带有[`@PrePersist`](http://openjpa.apache.org/builds/1.1.0/docs/jpa_overview_pc_callbacks.html)注释的方法来填充字段。

```
@MappedSuperclass
public class AuditedEntity {
    @Id protected Integer id;
    protected String lastUpdatedBy;

    // Setters and getters here

    @PreUpdate
    @PrePersist
    public void onChange() {
        String user = .... // Do whatever is needed to get the current user
        setLastUpdatedBy(user);
    }
}

@Entity
public class Employee extends AuditedEntity {
    // ....
} 
```

另一种选择是使用单独的侦听器：

```
public interface AuditedEntity {
    public static void setLastUpdatedBy(String username);
}

@Entity
@EntityListeners({ MyLogger.class, ... })
public class Employee implements AuditedEntity {
    // ...
}

public class MyLogger {
    @PreUpdate
    @PrePersist
    public void onChange(Object o) {
        if(o instanceof AuditedEntity) {
            String user = .... // Do whatever is needed to get the current user
            ((AuditedEntity) o).setLastUpdatedBy(user);
        }
    }

    @PostPersist
    @PostUpdate
    public void logChange(Object o) {
        // Log the successful operation
    }
} 
```

# scala - 如何通过谓词将序列分成两部分？

> ID：12148581
> 
> 赞同：132
> 
> 时间：2012-08-27T19:46:27.473
> 
> 标签：scala

如何通过谓词将序列拆分为两个列表？

替代方案：我可以使用`filter`and `filterNot`，或编写自己的方法，但没有更好的更通用（内置）方法吗？

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2012-08-27T19:50:10.273

通过使用`partition`方法：

```
scala> List(1,2,3,4).partition(x => x % 2 == 0)
res0: (List[Int], List[Int]) = (List(2, 4),List(1, 3)) 
```

* * *

## 回答 #2

> 赞同：146
> 
> 时间：2012-08-28T03:20:08.350

很好，这`partition`正是您想要的——还有另一种方法也使用谓词将列表一分为二：`span`.

第一个，[分区](http://www.scala-lang.org/api/current/index.html#scala.collection.Seq@partition(p:A=>Boolean):(Repr,Repr))将所有“真实”元素放在一个列表中，其他元素放在第二个列表中。

[span](http://www.scala-lang.org/api/current/index.html#scala.collection.Seq@span(p:A=>Boolean):(Repr,Repr))会将所有元素放在一个列表中，直到某个元素为“假”（就谓词而言）。从那时起，它将把元素放在第二个列表中。

```
scala> Seq(1,2,3,4).span(x => x % 2 == 0)
res0: (Seq[Int], Seq[Int]) = (List(),List(1, 2, 3, 4)) 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-08-27T23:30:16.650

您可能想看看[scalex.org](http://scalex.org) - 它允许您通过签名在 scala 标准库中搜索函数。例如，键入以下内容：

```
List[A] => (A => Boolean) => (List[A], List[A]) 
```

你会看到**partition**。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-12-01T22:49:50.053

如果你需要一些额外的东西，你也可以使用 foldLeft。当分区没有削减它时，我只是写了一些这样的代码：

```
val list:List[Person] = /* get your list */
val (students,teachers) = 
  list.foldLeft(List.empty[Student],List.empty[Teacher]) {
    case ((acc1, acc2), p) => p match {
      case s:Student => (s :: acc1, acc2)
      case t:Teacher  => (acc1, t :: acc2)
    }
  } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-26T09:55:33.180

我知道我可能会迟到，并且有更具体的答案，但你可以充分利用`groupBy`

```
val ret = List(1,2,3,4).groupBy(x => x % 2 == 0)

ret: scala.collection.immutable.Map[Boolean,List[Int]] = Map(false -> List(1, 3), true -> List(2, 4))

ret(true)
res3: List[Int] = List(2, 4)

ret(false)
res4: List[Int] = List(1, 3) 
```

如果您需要将条件更改为非布尔值，这会使您的代码更具前瞻性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-15T23:07:15.920

如果要将列表拆分为 2 个以上的部分，并忽略边界，则可以使用类似这样的内容（如果需要搜索整数，请修改）

```
def split(list_in: List[String], search: String): List[List[String]] = {
  def split_helper(accum: List[List[String]], list_in2: List[String], search: String): List[List[String]] = {
    val (h1, h2) = list_in2.span({x: String => x!= search})
    val new_accum = accum :+ h1
    if (h2.contains(search)) {
      return split_helper(new_accum, h2.drop(1), search) 
    }
    else {
    return accum
    }
  }
  return split_helper(List(), list_in, search)
}

// TEST

// split(List("a", "b", "c", "d", "c", "a"), {x: String => x != "x"}) 
```

# c# - 插件注册无需实例化插件类

> ID：12148605
> 
> 赞同：0
> 
> 时间：2012-08-27T19:48:01.307
> 
> 标签：c#, .net, design-patterns, plugins

我需要为我们的应用程序（.NET、WinForms 3.5）设计一个简单的插件框架。

扩展点将是用户可以使用插件“挂钩”的几个应用程序事件/场景，以执行特定操作。

我希望这个工作的方式是：

1.  有一个*插件*文件夹，用户将在其中放置插件 DLL（包含从特定基类派生的类型/以某种方式标记的程序集）。

2.  让我的应用程序插件系统找到这些文件并注册它们以供以后使用。

3.  在正确的时间调用正确的插件（例如：OnException、OnLog 等）。

如果我将在注册时创建插件对象（新建），则 DLL 将被加载到进程内存中。

我正在寻找一种简单的方法来进行注册，并且只在需要时“懒惰地”加载插件程序集（如果需要的话）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:53:21.747

您有几个选项 - 如果可以，您可以要求每个插件提供一个清单或其他描述自身的文件，然后您可以检查所有清单并在必要时加载适当的插件。这避免了检查程序集，但它确实需要清单和程序集之间的一致性，这可能很棘手。

否则，正如您所指出的，检查插件程序集会将其加载到内存中。我发现避免这种情况的唯一方法是将它们加载到单独`AppDomain`的`AppDomain`. 在某处有一个为 PRISM 执行此操作的示例（我可以尝试追踪它），但我不确定您使用的是什么框架（MEF、MAF、PRISM、IoC 等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T13:24:14.767

除了在新的 AppDomain 中加载每个候选程序集、反映其类型并最终卸载 AppDomain 的替代方法，您可以尝试[Mono.Cecil](http://www.mono-project.com/Cecil#Documentation)。然后你将不得不做这样的事情：

```
AssemblyDefinition ad = AssemblyDefinition.ReadAssembly(assemblyPath); 

foreach (TypeDefinition td in ad.MainModule.GetTypes()) 
{ 
    if (td.BaseType != null && td.BaseType.FullName == "MyNamespace.MyAddInBase") 
    {         
        return true; 
    } 
} 
```

然后，您可以使用[Assembly.LoadForm](http://msdn.microsoft.com/en-us/library/f8c4tzhc.aspx)加载正确的程序集，最后使用适合您需要的[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)重载创建加载项实例。

# ruby-on-rails-3.2 - Rails 生成器没有生成正确的测试模板

> ID：12148611
> 
> 赞同：2
> 
> 时间：2012-08-27T19:48:23.537
> 
> 标签：ruby-on-rails-3.2, generator, minitest, specifications

我的项目住在这里：[https ://github.com/jonesdeini/ICanHazSandvich](https://github.com/jonesdeini/ICanHazSandvich)

我正在使用 minitest-rails add 进行设置我无法让生成器生成正确的测试模板。

来自我的 application.rb：

```
config.generators do |g|
  g.test_framework :mini_test, :spec => true, :fixture => false
end 
```

即使使用“g.test_framework nil”，我仍然会生成相同的测试模板：

输出：

```
rails g model Foo
    invoke  active_record
    create    db/migrate/20120827160129_create_foos.rb
    create    app/models/foo.rb
    invoke    test_unit
    create      test/unit/foo_test.rb
    invoke      factory_girl
    create        test/factories/foos.rb 
```

即使使用“rails g model Foo --spec”，也会生成相同的文件。我正在使用 rails 3.2.8 和 ruby​​-1.9.3-p194

谢谢你的帮助！

宝石文件：

```
group :development, :test do
  gem 'factory_girl_rails'
  gem 'minitest-rails'
  gem 'minitest-rails-capybara'
 end 
```

编辑：

已为此问题提交拉取请求 [https://github.com/thoughtbot/factory_girl_rails/pull/68](https://github.com/thoughtbot/factory_girl_rails/pull/68)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:17:12.613

问题是`factory_girl_rails`宝石。该 railtie 假设为`rspec`or `test_unit`，并且其配置与您的配置冲突。这是我将如何解决这个问题：

将依赖项更改为文件中的`factory_girl`gem `Gemfile`：

```
group :development, :test do
  gem 'factory_girl'
  gem 'minitest-rails'
  gem 'minitest-rails-capybara'
end 
```

将您的应用配置为在`config/application.rb`文件中使用 FactoryGirl：

```
config.generators do |g|
  g.test_framework :mini_test, spec: true, fixture: false,
                               fixture_replacement: :factory_girl
end 
```

嗯，这并不完全正确。我将如何真正解决它是完全删除 FactoryGirl，但这是对另一个问题的答案......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T10:32:48.187

`factory_girl_rails`维护者已经修复了gem 强制使用的问题`Test::Unit`，但是这还没有过滤到`rubygems.org`.

如果您更新 Gemfile 以包含：

```
group :development, :test do
  gem 'factory_girl_rails', :git => "git://github.com/thoughtbot/factory_girl_rails.git"
end 
```

一切都应该很好！

# html - 在 epub 中忽略了多个 @font-face

> ID：12148614
> 
> 赞同：2
> 
> 时间：2012-08-27T19:48:35.393
> 
> 标签：html, css, fonts, epub

我正在使用`ebook-convert`来自 calibre 项目的嵌入字体生成 EPUB 文件。当我在 HTML 中声明多个字体时，它工作正常：

```
<html>
<head>
<style type="text/css">
@font-face{
font-family: "test";
font-style: normal;
font-weight: normal;
font-variant: normal;
src: url(fonts/EBGaramond12-Regular.otf);
}
@font-face{
font-family: "test";
font-style: italic;
font-weight: normal;
font-variant: normal;
src: url(fonts/EBGaramond12-Italic.otf);
}
body{
font-family: "test";
}
</style>
</head>
<body>
This is a test with <i>italic</i>.
</body>
</html> 
```

产生：

![HTML中的字体](../Images/090af1003a1b60cdd3e136faba746069.png)

但是当我将它转换为 EPUB 时，我只得到了整个文档的第一个字体：

![EPUB 中的相同代码](../Images/e5b325d607ee7cb8953efb0c1095161d.png)

我检查了EPUB。字体已正确嵌入，并且包含 CSS。由于我使用“test”作为字符串来识别字体，因此不会与我的系统字体发生冲突。

EPUB有什么问题？我是否声明字体错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:12:41.607

这篇[关于 epub 字体的博文](http://blog.threepress.org/2009/09/16/how-to-embed-fonts-in-epub-files/)可能会有所帮助

# cocoa - 如何链接 NSView 来模拟分页？

> ID：12148617
> 
> 赞同：0
> 
> 时间：2012-08-27T19:48:56.560
> 
> 标签：cocoa, pagination, nsview, chain

我想将几个视图链接在一起，并让内容自动从一个视图流到下一个视图。想想文本容器是如何工作的，以及它们的内容如何跨越容器。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:44:18.213

您可以使用管理一组容器视图的布局管理器从头开始构建类似的东西。

此代码旨在垂直调整容器的大小以容纳其子视图：

```
+ (void)setAndArrangeSubviews:(NSArray *)subviews inView:(NSView *)superview {
    [superview setSubviews:subviews];

    NSRect superviewFrame = [superview frame];
    CGFloat y = superviewFrame.size.height;
    for (NSView *subview in subviews) {
        NSRect subviewFrame = [subview frame];
        subviewFrame.origin.y = (y -= subviewFrame.size.height);
        [subview setFrame:subviewFrame];
    }
} 
```

你可以调整它来完成你想要的：在容器中排列子视图直到它满了，然后在下一个容器中排列剩余的视图。

如果您只需要垂直堆叠视图，这似乎是一种很简单的方法来完成您想要的。

这个[相关问题](https://stackoverflow.com/questions/8227078/any-layout-geometry-management-for-cocoa)的答案是指 10.7 中的一个名为[Cocoa Auto Layout](http://developer.apple.com/library/mac/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html#//apple_ref/doc/uid/TP40010853-CH1-SW1)的特性，它可能会提供一种更自动化的方式来完成此任务，如果您需要以 2D 的形式布置它们，这可能值得研究。

# redirect - Lighttpd 单个子域重定向/重写

> ID：12148620
> 
> 赞同：1
> 
> 时间：2012-08-27T19:49:03.880
> 
> 标签：redirect, rewrite, subdomain, lighttpd

我正在使用 lighttpd，我想将子域重定向到常规 url，但保持子域显示在浏览器中。

例如，如果我有以下网址：[http](http://blog.test.com/) ://blog.test.com/ ...

我想将其重定向到：[http](http://test.com/blog/) ://test.com/blog/ ...

但仍将 blog.test.com/... 显示为浏览器中的 URL。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:27:00.103

你需要`proxy-core.rewrite-request`这样的东西：

```
 $HTTP["host"] =~ "blog.test.com" {
    proxy-core.rewrite-request = (
      "_uri" => ( ".*" => "/blog/$1" ),
      "Host" => ( ".*" => "test.com" ),
    )
  } 
```

跳转到[doc](http://redmine.lighttpd.net/projects/1/wiki/Docs_ModProxyCore)`proxy-core.rewrite-request`的部分。

# sharepoint - 如何创建将动态更新其子站点的 sharepoint 2010 模板

> ID：12148626
> 
> 赞同：0
> 
> 时间：2012-08-27T19:49:26.133
> 
> 标签：sharepoint, templates, sharepoint-2010

我最近在 Sharepoint 2010 中创建了一个站点，并将其保存为模板。我可以将此模板应用于新网站，这很棒。然后我可以将新数据单独添加到每个站点。但是，我的问题是，如果我想在每个子站点上更改某些内容，则必须手动完成。有什么方法可以创建一个动态工作的模板，以便我可以对原始站点进行更改，并且所有子站点都将继承这些更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T07:48:07.317

如果您已使用全局部署的模板部署了新网站集，并且您使用 SharePoint 设计器更改了该模板，那么您应该不会遇到任何问题，并且更改将自动应用于子网站，除非您更改母版页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T00:04:37.017

不幸的是，不是您的要求。创建站点时，它使用站点模板，包括您自己的自定义站点模板。创建站点后，无法将站点模板重新应用到该现有站点。您可以使用 PowerShell 更新一系列现有站点，但命令会变得相当复杂。

# jquery - 包括 jquery 中断选项卡，不包括 jquery 会阻止我的程序执行

> ID：12148640
> 
> 赞同：0
> 
> 时间：2012-08-27T19:50:39.693
> 
> 标签：jquery, tabs

我用 jquery 实现了一些独立运行良好的代码。我想让代码呈现的内容成为使用 EasyTabs 的选项卡之一。（或者任何tab插件，stereotab都有同样的问题）。

我的问题是，一旦我包含 jquery，选项卡就会全部中断，并且每个选项卡中的所有信息都会显示在当前选项卡上。

例如，您可以在此处下载 easytabs 使用的演示：http: [//jspkg.com/packages/easytabs](http://jspkg.com/packages/easytabs)

如果您打开 demo.html 并包含以下行：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```

选项卡打破并呈现一页上的所有内容。

是什么赋予了？

# asp.net - 在 ASP.NET 中生成新的 SessionId

> ID：12148647
> 
> 赞同：6
> 
> 时间：2012-08-27T19:51:07.913
> 
> 标签：asp.net

登录时我想生成一个新的 SessionId。我找到[了一种可行的解决方案](https://stackoverflow.com/questions/1368403/generating-a-new-asp-net-session-in-the-current-httpcontext/4420114#4420114)，但它需要一些相当骇人听闻的东西，并且要求应用程序具有完全信任安全策略设置。

有没有其他方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T20:11:51.747

看起来这样有效：

```
Session.Abandon();
Response.Cookies.Add(new HttpCookie("ASP.NET_SessionId", "")); 
```

通过清除该 cookie，将在服务器上创建一个具有新会话 ID 的新会话。

（参考：[微软支持](http://support.microsoft.com/kb/899918)）

编辑：这是一个使用 AJAX（使用 jQuery）在不刷新页面的情况下调用服务器代码的示例 - 它调用了两次，一次是删除第一个会话，一次是生成一个新会话。可能有更好的方法，但这确实有效。

```
function newSession() {
    jQuery.ajax({
        type: "POST",
        url: "WebForm1.aspx/ClearSession",
        data: "{}",
        dataType: "json",
        contentType: "application/json; charset=utf-8",
        success: function () {
            jQuery.ajax({
                type: "POST",
                url: "WebForm1.aspx/NewSession",
                data: "{}",
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function () { console.log("Success!"); },
                error: function (x, y, z) {
                    console.log("Failure!");
                }
            });
        },
        error: function (x, y, z) {
            console.log("Failure!");
        }
    });
} 
```

在代码隐藏（对于 WebForms - 您也可以使用 MVC 控制器执行此操作）：

```
[WebMethod]
public static void ClearSession()
{
    HttpContext.Current.Session.Abandon();
    HttpContext.Current.Response.Cookies.Add(new HttpCookie("ASP.NET_SessionId", ""));
}

[WebMethod]
public static void NewSession()
{
    HttpContext.Current.Session["x"] = 123;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-25T17:48:12.827

我目前正在考虑基于配置的解决方案，而不是基于代码的解决方案。我将配置 Web 服务器或负载平衡器以去除仅包含登录页面的 cookie 的请求和响应标头。删除请求标头的“cookie”标头和响应标头的“set-cookie”。

对登录页面的每个请求（GET 或 POST）都将不包含 cookie 信息，从而迫使 ASP.NET 创建一个新会话和（更重要的是）一个新会话 ID。

它比在登录时强制创建新会话效率低，但在您无法修改代码的情况下，该技术可能很有用。

# jquery - 用于 Google-Plus 的 jQuery 插件，例如输入字段

> ID：12148648
> 
> 赞同：0
> 
> 时间：2012-08-27T19:51:14.400
> 
> 标签：jquery, google-plus

我很确定你可以帮助我！我很确定我曾经看到一个用于增强输入字段的 jQuery 插件，例如 Google Plus 使用它们：

（还不能发布图片，也许有人可以编辑这个？谢谢！） [Google Plus 输入字段](http://i.stack.imgur.com/o7AnP.png)

可悲的是，我再也找不到它了。你们中有人知道这个（或另一个插件）吗？具体来说，我正在寻找一种可能性，可以为多个输入值创建一个动态输入字段（在一个字段中，请参见屏幕截图）。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:53:55.757

我认为您正在寻找[jQuery tokenInput](http://loopj.com/jquery-tokeninput/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:55:34.307

它被称为 jQuery Autocomplete（多个）。

[文档](http://jqueryui.com/demos/autocomplete/#multiple)

[这是一个在线演示](http://net.tutsplus.com/tutorials/javascript-ajax/how-to-use-the-jquery-ui-autocomplete-widget/)

# directx - 着色器有奇怪的输入值

> ID：12148649
> 
> 赞同：0
> 
> 时间：2012-08-27T19:51:18.977
> 
> 标签：directx, shader, directx-11, sharpdx

我当前的问题如下：我尝试使用集成的 Primtive-Rendering（Sprite 和 PrimtiveBatch 合二为一）创建一个 SpriteBatch。

目前 Visual Studio 11 的调试器显示有一行渲染。IA-Stage 是正确的，所以 VertexShader-Stage 是正确的。但我没有得到任何输出。

我用调试器运行它，发现着色器具有异常巨大的值。

我正在传递两个顶点：20,20（位置）和 80、80（位置），它们都是黑色的。ConstantBuffer 有三个矩阵：World（用于手动对象变换）、View 和 Projection。

在代码中，它们都是正确的：M11 = 0.00215749722，依此类推。在着色器中，它看起来像这样：

位置 = x = 200000.000000000，y = 200000.000000000，z = 0.000000000，w = 0.000000000（#1 顶点的位置）

```
 Projection[0] = x = 22.000000000, y = 0.000000000, z = 0.000000000, w = 0.000000000
    Projection[1]   x = 0.000000000, y = -45.000000000, z = 0.000000000, w = 0.000000000
    Projection[2]   x = 0.000000000, y = 0.000000000, z = 10000.000000000, w = 0.00000 0000
    Projection[3]   x = 0.000000000, y = 0.000000000, z = 0.000000000, w = 10000.000000000 
```

最后，XYZW 的输出结果（位置）为 0。在它之前是 413,-918 或类似的东西。我不知道为什么，但现在结果总是 0...

这很奇怪，我完全被困住了：-/

谢谢R

# javascript - 在 JS Metro App 中取消基本身份验证的登录屏幕

> ID：12148651
> 
> 赞同：0
> 
> 时间：2012-08-27T19:51:27.413
> 
> 标签：javascript, windows-8, microsoft-metro

我有一个相当简单的 WinJS Metro 应用程序，它会在从 web 服务获取一些 JSON 数据之前询问用户的用户名和密码。

我使用 jQuery.ajax() 来获取数据，并正确设置了基本身份验证标头。但是，如果用户输入了错误的凭据，并且服务器返回 401，metro 运行时会显示登录屏幕。除非用户在运行时提供的登录屏幕上按下“取消”，否则不会调用传递给 jQuery.ajax() 函数的错误处理程序。

我希望程序处理失败的登录尝试，有没有办法抑制运行时登录屏幕？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:27:30.343

不确定您在做什么，但是如果用户提供了错误的用户名/密码，以下代码会正确触发错误处理程序：

```
 var userInfo = getCurrentUserInfo();
    $.ajax({
        url: URL,
        dataType: 'json',
        success: jsonCallback,
        username: userInfo.username,
        password: userInfo.password,
        error: function (jqXHR, textStatus, errorThrown) {
            errorHandler(jqXHR, textStatus, errorThrown);
        }
    } 
```

您是自己提供用户名/密码，还是等待系统的登录对话框出现？恐怕一旦出现，就像您说的那样，在用户取消之前无法返回您的代码。

# c# - 列表视图分组

> ID：12148652
> 
> 赞同：1
> 
> 时间：2012-08-27T19:51:32.077
> 
> 标签：c#, .net, linq

我遇到过这个教程

[http://mattberseth.com/blog/2008/01/building_a_grouping_grid_with.html](http://mattberseth.com/blog/2008/01/building_a_grouping_grid_with.html)

但是我正在努力用 C Sharp 编写 LinqDataSource 查询。

```
var o = (from c in x group c by c.Date into cc select new { Group = cc.Key, ItemCount = cc.Count() }); 
```

以上很好，但是如何根据我发布的链接中的 LinqDataSource 将“It as Items”添加到上述查询中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:08:42.013

我在您的查询中添加了代码

```
 var o = 
    (from c in x 
     group c by c.Date into cc 
     select new { Group = cc.Key, ItemCount = cc.Count() });

    foreach (var grp in o)
    {
        Console.WriteLine("\nCategoryID Key = {0}:", grp.Key);
        foreach (var item in grp)
        {
            Console.WriteLine("\t{0}", item.Items);//Replace with your property
        }
    } 
```

您可以使用 yield 来枚举

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T01:08:37.350

该`group`子句创建`IGrouping`s。An`IGrouping`基本上是`IEnumerable`带有键的 an，因此访问它的项目就像访问 an`IEnumerable`的项目一样。此语句使用`ToList()`，但您也可以使用`AsEnumerable()`or `ToArray()`：

```
var o = from c in x 
        group c by c.Date into cc 
        select new { Group = cc.Key, Items = cc.ToList(), ItemCount = cc.Count() }; 
```

# sql - 即席 2x2 列联表 SQL Server 2008

> ID：12148653
> 
> 赞同：1
> 
> 时间：2012-08-27T19:51:38.270
> 
> 标签：sql, sql-server, tsql, statistics

我正在研究在 SQL Server 2008 中创建[列联表](http://en.wikipedia.org/wiki/Contingency_tables)的方法。它们不一定必须出现在 2x2 典型矩阵中。我只是想知道是否有人可以看到比我更好的解决方案。

![在此处输入图像描述](../Images/42c7a8a79236c5020950e5abecd557f8.png) 为了清楚起见，请参阅图片。为简单起见，红色字母是方块的名称。标签 X+ 表示 X 存在于该单元格中，反之亦然。

我将用它们所代表的表格中的方框字母标记我的查询

```
A

       select count(*) from 
    (

    select distinct p.patientid
        from Patient as p
        inner join icdpatient as picd on picd.patientid = p.patientid
        and picd.admissiondate = p.admissiondate
        and picd.dischargedate = p.dischargedate
        inner join tblicd as t on t.icd_id = picd.icd_id
        where t.icdText like '%x%' 
    ) as t
    inner join 
    (
    select distinct p.patientid
        from Patient as p
        inner join icdpatient as picd on picd.patientid = p.patientid
        and picd.admissiondate = p.admissiondate
        and picd.dischargedate = p.dischargedate
        inner join tblicd as t on t.icd_id = picd.icd_id
        where t.icdText like '%y%'
    ) as s on s.patientid=t.patientid 
```

* * *

```
B
select count(*) from 
(

select distinct p.patientid
    from Patient as p
    inner join icdpatient as picd on picd.patientid = p.patientid
    and picd.admissiondate = p.admissiondate
    and picd.dischargedate = p.dischargedate
    inner join tblicd as t on t.icd_id = picd.icd_id
    where t.icdText like '%x%' 
) as t
left join 
(
select distinct p.patientid
    from Patient as p
    inner join icdpatient as picd on picd.patientid = p.patientid
    and picd.admissiondate = p.admissiondate
    and picd.dischargedate = p.dischargedate
    inner join tblicd as t on t.icd_id = picd.icd_id
    where t.icdText like '%y%'
) as s on s.patientid=t.patientid
where s.patientid is null 
```

* * *

```
C
select * from 
(

select distinct p.patientid
    from Patient as p
    inner join icdpatient as picd on picd.patientid = p.patientid
    and picd.admissiondate = p.admissiondate
    and picd.dischargedate = p.dischargedate
    inner join tblicd as t on t.icd_id = picd.icd_id
    where t.icdText like '%x%' 
) as t
right join 
(
select distinct p.patientid
    from Patient as p
    inner join icdpatient as picd on picd.patientid = p.patientid
    and picd.admissiondate = p.admissiondate
    and picd.dischargedate = p.dischargedate
    inner join tblicd as t on t.icd_id = picd.icd_id
    where t.icdText like '%y%'
) as s on s.patientid=t.patientid
where t.patientid is null 
```

D 这个我有点不确定，但我想我会做类似的事情

```
declare @d int
set @d = (select count(distinct p.patientid) from Patient as p) - b -c 
```

这旨在找到整个人口，并仅用 X 和仅用 y 减去那些

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:57:16.287

是的！有更简单的方法。假设您的加入不会产生重复的患者：

```
select (case when t.icdText like '%x%' then 'X' else 'NO-X' end) as X,
       (case when t.icdText like '%y%' then 'Y' else 'NO-Y' end) as Y,
       count(*) as cnt
from Patient p inner join
     icdpatient picd
     on picd.patientid = p.patientid and
        picd.admissiondate = p.admissiondate and
        picd.dischargedate = p.dischargedate inner join
     tblicd t
     on t.icd_id = picd.icd_id
group by  (case when t.icdText like '%x%' then 'X' else 'NO-X' end),
           (case when t.icdText like '%y%' then 'Y' else 'NO-Y' end) 
```

否则将 count(*) 替换为：

```
count(distinct patientid) 
```

这应该为您提供列联表所需的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-08T22:09:36.740

这是另一种方式：

```
select      RRTGotAlert         = case RRTGotAlert when 0 then 'N' when 1 then 'Y' end
            ,TZ_OnPilotUnit_N   = sum(TZ_OnPilotUnit_N)
            ,TZ_OnPilotUnit_Y   = sum(TZ_OnPilotUnit_Y)
from        (select     RRTGotAlert
                        ,TZ_OnPilotUnit_N = [0]
                        ,TZ_OnPilotUnit_Y = [1]
            from        #analysis
            pivot       (count(Encounter) for TZ_OnPilotUnit in ([0],[1])) pvt) got_alert
group by    case RRTGotAlert when 0 then 'N' when 1 then 'Y' end
order by    case RRTGotAlert when 0 then 'N' when 1 then 'Y' end 
```

# android - ListFragment 缺少分隔线

> ID：12148657
> 
> 赞同：3
> 
> 时间：2012-08-27T19:51:54.173
> 
> 标签：android, android-listview, android-listfragment

我正在修改我现有的应用程序以使用 ListFragment 而不是 ListView。

我无法使用 JAVA 设置分隔符。不抛出异常。ListFragment 显示时没有分隔线。

```
 public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        setRetainInstance(true);
        setHasOptionsMenu(true);

        lv = getListView();  
        lv.setTextFilterEnabled(true);
        lv.setCacheColorHint(Color.TRANSPARENT);
        lv.setFastScrollEnabled(true);
        lv.setDividerHeight(1);

        lv.setDivider(getActivity().getResources().getDrawable(android.R.color.black));

        lv.setBackgroundDrawable(getResources().getDrawable(R.drawable.merge)); //white background
        lv.setScrollingCacheEnabled(false);
        lv.setSmoothScrollbarEnabled(false);    

        setListAdapter(new IconicAdapter());

      } 
```

我究竟做错了什么？非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T20:59:03.897

你应该在 lv.setDivider(getActivity().getResources().getDrawable(android.R.color.black)); 之后使用 lv.setDividerHeight(1)

所以反转它们：

```
lv.setDivider(getActivity().getResources().getDrawable(android.R.color.black));
lv.setDividerHeight(1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T19:57:54.827

您的分隔线不能只是一种颜色，因为它还需要一个宽度。您正在检索一个可绘制对象，但实际上是在抓取一种颜色。您应该创建一个可绘制的线条并将其放在您的可绘制文件夹中，该文件夹的定义如下：

```
<?xml version="1.0" encoding="utf-8"?>  
<selector xmlns:android="http://schemas.android.com/apk/res/android">
  <item>
    <shape android:shape="line">
        <stroke android:color="#000000" android:width="1dp"  />
    </shape>
  </item>
</selector> 
```

# ios - IOS App以调试器错误结束，只是（lldb）

> ID：12148659
> 
> 赞同：3
> 
> 时间：2012-08-27T19:52:15.577
> 
> 标签：ios, debugging, ios-simulator, lldb

我的应用程序现在可以在 iOS 模拟器上完美运行，但在运行结束时，调试器只会出现浅蓝色“（lldb）”错误。就是这样'为什么？我该怎么做才能让它不发生。

PS我使用ARC模式编写了这个程序，

![这是错误的屏幕截图](../Images/d6d39ab8824e50ebdcb76729c4c3e5ac.png)

如果我自己运行模拟器，我的 .app 会在 .app 结束并从正在运行的应用程序列表中删除时准确地冻结模拟器。

这是我的冷冻模拟器的截图

![](../Images/aff2a58d02b7baeca5b85a4d5e97a59d.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T22:28:07.440

根据屏幕截图、（lldb）调试器、屏幕截图左侧的调试信息以及您的描述，我会说您在某处添加了一个断点，而您只是没有注意到它。当您的代码到达断点时，它会立即停止进一步执行代码并引入调试器（在本例中为 lldb）。

我几乎可以肯定情况就是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-17T16:51:47.293

转到产品->方案->编辑方案并取消选中“调试可执行文件”祝你好运

# php - XML 到数组？[PHP]

> ID：12148662
> 
> 赞同：8
> 
> 时间：2012-08-27T19:52:25.070
> 
> 标签：php, xml, arrays

好吧，我在将 xml 更改回数组时遇到了问题....如果每个 xml 都遵循相同的格式，但每个 XML 都不同，除了`<Formula>`标签、公式名和 movespeed ex：

```
<Formula>
<formulaname>Basic</formulaname>
<movespeed>1</movespeed>
<str>4</str>
<dex>3</dex>
<int>1</int>
<will>2</will>
</Formula> 
```

或者

```
<Formula>
<formulaname>Basic</formulaname>
<movespeed>1</movespeed>
<box>4</box>
<chicken>3</chicken>
<ducks>1</ducks>
<cereal>2</cereal>
</Formula> 
```

我试过的：

```
$xml = simplexml_load_file("test.xml");
print_r($xml); 
```

这实际上是`prints`一些东西，但我无法超越它，甚至`echo`它..

```
foreach($xml->text as $string) { 
  print_r($string);
  echo 'attributes: '. $string->attributes() .'<br />';
} 
```

没用，本来是为了，`strings`但没有一个是`strings`...

```
foreach ($xml->Formula as $element) {
  foreach($element as $key => $val) {
   echo "{$key}: {$val}";
  } 
```

也没有工作，我需要这样的东西才能工作，所以我可以使用来自的值，`array`而不知道究竟该值将被称为什么..

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-08-04T07:23:01.390

这是您最好的选择，它应该消除所有 SimpleXMLElement 对象，而只给您数组：

```
$xml = simplexml_load_file("test.xml");
$xml_array = unserialize(serialize(json_decode(json_encode((array) $xml), 1)));
print_r($xml_array); 
```

使这之间的区别：

* * *

![带有 SimpleXMLElement 对象的数组](../Images/8154a7f030c499a09bdd306433f4dd7a.png)

* * *

还有这个：

* * *

![所有数组 - 不与 SimpleXMLElement 对象混合](../Images/8845b40c015a2662560c5d19476b1156.png)

* * *

希望对您有所帮助... :)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-27T19:59:50.667

您不能通过在节点本身上使用 foreach 来访问子节点，您需要使用`.children()`：

```
$s =<<<EOS
<root>
<Formula>
<formulaname>Basic</formulaname>
<movespeed>1</movespeed>
<box>4</box>
<chicken>3</chicken>
<ducks>1</ducks>
<cereal>2</cereal>
</Formula>
</root>
EOS;

$xml = simplexml_load_string($s);

foreach ($xml->Formula as $element) {
    foreach($element->children() as $key => $val) {
        echo "{$key}: {$val}";
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-27T21:31:05.327

对于您的示例，此代码就足够了：

```
$xml = simplexml_load_file('formula.xml');
$arr = (array) $xml;
var_dump($arr); 
```

并且您的 xml 进入数组
formula.xml 包含您的 xml

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-17T15:26:04.570

如果在同一个节点中有 cdata 和 and 属性，使用上述方法将省略属性。

尝试使用此方法：

```
function xml2array($xmlObject, $out = [])
{
    foreach($xmlObject->attributes() as $attr => $val)
        $out['@attributes'][$attr] = (string)$val;

    $has_childs = false;
    foreach($xmlObject as $index => $node)
    {
        $has_childs = true;
        $out[$index][] = xml2array($node);
    }
    if (!$has_childs && $val = (string)$xmlObject)
        $out['@value'] = $val;

    foreach ($out as $key => $vals)
    {
        if (is_array($vals) && count($vals) === 1 && array_key_exists(0, $vals))
            $out[$key] = $vals[0];
    }
    return $out;
}
$xml = simplexml_load_string($xml_string, 'SimpleXMLElement', LIBXML_NOCDATA);
$arr = xml2array($xml); 
```

# jquery - 在 alert() 之后重定向到另一个页面？

> ID：12148663
> 
> 赞同：0
> 
> 时间：2012-08-27T19:52:40.710
> 
> 标签：jquery, alert

> **可能重复：**
> [Javascript 关闭警报框](https://stackoverflow.com/questions/463368/javascript-close-alert-box)

嗨，我想问一下是否有可能有一个 id `#myID`，点击它会弹出一个警告框，几秒钟后**不**点击`OK`警告按钮，它会重定向到另一个页面？这是我的代码：

```
 $('#myID).click(function(){
     alert('Ta-da! Do not click the OK button just wait for a few seconds before it redirects to other page.');  
 }) 
```

不知何故，这就是我想要的。那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:01:36.783

使用自定义对话框：如果您的站点中还没有任何插件，例如 jQuery ui，则可以使用自定义对话框。

```
var dialog = $('<div id="dialog"> You are going away, Bye Bye </div>');
dialog.css({
    position:'fixed',
    top: 100,
    left: '50%',
    width: '200px',
    'margin-left': '-100px',
    'z-index' : 99999,
    border: '1px solid #444444',
    'background-color' : '#FFFFF'
    });
$('body').append(dialog); 
```

[http://jsfiddle.net/R7qSR/](http://jsfiddle.net/R7qSR/)

# foreach - 来自 stdClass 对象的 Foreach 循环

> ID：12148664
> 
> 赞同：0
> 
> 时间：2012-08-27T19:52:44.150
> 
> 标签：foreach, stdclass

对于这个数组

```
stdClass Object
(
    [YearsResult] => stdClass Object
        (
            [years] => stdClass Object
                (
                    [year] => Array
                        (
                            [0] => 2013
                            [1] => 2012
                            [2] => 2011
                            [3] => 2010
                            [4] => 2009
                            [5] => 2008
                            [6] => 2007
                            [7] => 2006
                            [8] => 2005
                            [9] => 2004
                            [10] => 2003
                            [11] => 2002
                            [12] => 2001
                            [13] => 2000
                            [14] => 1999
                            [15] => 1998
                        )

                )

        )

) 
```

运行 foreach 循环以获取年份值的正确方法是什么？我已经尝试了我能找到/想到的所有可能的方法，我最后一次尝试是

```
foreach ($result->YearsResult->years->year as $test) {
     echo $test->year;
} 
```

什么都不返回。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T19:59:44.520

$result->YearsResult->years->year 是你想要的数组。所以 $test 是数组元素。

```
echo $test; 
```

# sockets - 在 PowerShell 中通过 UDP 发送和接收数据

> ID：12148666
> 
> 赞同：12
> 
> 时间：2012-08-27T19:52:49.580
> 
> 标签：sockets, powershell, udp

我正在尝试使用 PowerShell 编写脚本来测试和应用程序。测试应该包括通过 UDP 向远程服务器发送一个字符串，然后从该服务器读取响应并对结果进行处理。我需要的唯一帮助是脚本的中间两个（“发送字符串”，然后是“接收响应”）步骤：

1.  在端口 UDP 5000 上将字符串“ABCDEFG”发送到服务器 10.10.10.1
2.  从服务器 10.10.10.1 接收响应

我对 PowerShell 比较熟悉，但这是我第一次处理套接字，所以我处于陌生的水域，我似乎无法理解我在帖子中找到的几个示例。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T21:57:33.123

前段时间，我编写了一个简单的 PowerShell 脚本来发送 UDP 数据报。请参阅：[http](http://pshscripts.blogspot.co.uk/2008/12/send-udpdatagramps1.html) ://pshscripts.blogspot.co.uk/2008/12/send-udpdatagramps1.html ，这将使您走到一半。不过，我从来没有做过另一半，也没有写过服务器端！

> ```
> <#  
> .SYNOPSIS 
>     Sends a UDP datagram to a port 
> .DESCRIPTION 
>     This script used system.net.socckets to send a UDP 
>     datagram to a particular port. Being UDP, there's 
>     no way to determine if the UDP datagram actually 
>     was received.  
>     for this sample, a port was chosen (20000). 
> .NOTES 
>     File Name  : Send-UDPDatagram 
>     Author     : Thomas Lee - tfl@psp.co.uk 
>     Requires   : PowerShell V2 CTP3 
> .LINK 
>     http://www.pshscripts.blogspot.com 
> .EXAMPLE 
> #> 
> 
> ### 
> #  Start of Script 
> ## 
> 
> # Define port and target IP address 
> # Random here! 
> [int] $Port = 20000 
> $IP = "10.10.1.100" 
> $Address = [system.net.IPAddress]::Parse($IP) 
> 
> # Create IP Endpoint 
> $End = New-Object System.Net.IPEndPoint $address, $port 
> 
> # Create Socket 
> $Saddrf   = [System.Net.Sockets.AddressFamily]::InterNetwork 
> $Stype    = [System.Net.Sockets.SocketType]::Dgram 
> $Ptype    = [System.Net.Sockets.ProtocolType]::UDP 
> $Sock     = New-Object System.Net.Sockets.Socket $saddrf, $stype, $ptype 
> $Sock.TTL = 26 
> 
> # Connect to socket 
> $sock.Connect($end) 
> 
> # Create encoded buffer 
> $Enc     = [System.Text.Encoding]::ASCII 
> $Message = "Jerry Garcia Rocks`n"*10 
> $Buffer  = $Enc.GetBytes($Message) 
> 
> # Send the buffer 
> $Sent   = $Sock.Send($Buffer) 
> "{0} characters sent to: {1} " -f $Sent,$IP 
> "Message is:" 
> $Message 
> # End of Script 
> ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-11-22T17:43:11.937

这是我的代码：

```
$client = new-object net.sockets.udpclient(0)

write-host "You are $(((ipconfig) -match 'IPv').split(':')[1].trim()):$($client.client.localendpoint.port)"

$peerIP = read-host "Peer IP address"
$peerPort = read-host "Peer port"

$send = [text.encoding]::ascii.getbytes("heyo")
[void] $client.send($send, $send.length, $peerIP, $peerPort)

$ipep = new-object net.ipendpoint([net.ipaddress]::any, 0)
$receive = $client.receive([ref]$ipep)

echo ([text.encoding]::ascii.getstring($receive))

$client.close() 
```

它执行以下操作：

1.  创建具有自动分配端口 (0) 的 UDPClient。
2.  获取本地 IP 地址和 UDPClient 自动分配的端口并将其打印给用户。
3.  从用户那里检索对等方的 IP 地址和端口。
4.  将字符串“heyo”从 ASCII 编码转换为字节数组并将其发送给对等方。（我**相信**它会一直放在对等端，直到它被“接收”，即使是几秒钟。）
5.  创建一个从任何 IP 地址和任何端口 (0) 获取 UDP 数据包的 IPEndPoint。
6.  接收从对等方发送的任何数据作为一个新的字节数组，并以该 IPEndPoint 作为参考参数（现在存储接收到的数据包的来源）。
7.  将接收到的字节数组转换为 ASCII 编码的字符串并打印出来。
8.  关闭 UDPClient。（确保这样做；否则，资源将持续存在（直到您重新启动 PS）！）

该脚本的美妙之处在于它非常简单明了，您可以将它与`localhost`/ `127.0.0.1`（在两个单独的 PowerShell 窗口中）或外部 IP 地址一起使用，如果它是本地 IP 地址，您将已经知道，因为本地脚本会为您打印出 IP。

请注意，UDPClient 有一个 SendAsync 和一个 ReceiveAsync，但它们没有超时。有些人为此制定了复杂的解决方法，但您也可以只使用 PowerShell`Start-Job`和其他`*-Job`命令，并在单独运行的代码中放置一个接收循环。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-12-01T17:00:29.127

Thomas 刚刚给了你**客户端**，下面是一个简单的**服务器端**代码：

```
$port = 2020
$endpoint = new-object System.Net.IPEndPoint ([IPAddress]::Any,$port)
$udpclient = new-Object System.Net.Sockets.UdpClient $port
$content = $udpclient.Receive([ref]$endpoint)
[Text.Encoding]::ASCII.GetString($content) 
```

*   您可以在客户端为您的机器使用 IP 127.0.0.1 进行测试，打开 2 个 powershell 窗口（一个用于客户端，另一个用于服务器端）。

*   对于超过 1 个数据包，您可以使用以下代码：

    ```
     $port = 2020
      $endpoint = New-Object System.Net.IPEndPoint ([IPAddress]::Any, $port)
      Try {
          while($true) {
              $socket = New-Object System.Net.Sockets.UdpClient $port
              $content = $socket.Receive([ref]$endpoint)
              $socket.Close()
              [Text.Encoding]::ASCII.GetString($content)
          }
      } Catch {
          "$($Error[0])"
      } 
    ```

# debugging - 如何调试包含在 libtool 脚本中的程序？

> ID：12148668
> 
> 赞同：14
> 
> 时间：2012-08-27T19:52:54.870
> 
> 标签：debugging, gdb, libtool

我有一个项目涉及

*   共享库即：`mylib.so`
*   使用这些共享库的（测试）程序，即：`test_mylib`

当我尝试运行`gdb`时`test_mylib`，它会打印：

```
"test_mylib": not in executable format: File format not recognized 
```

当我`.libs/test_mylib`直接使用真正的程序（）时，它仍然抱怨：

```
.libs/test_mylib: can't load library 'libhello.so.0' 
```

如何运行 gdb 来调试我的程序？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-27T19:52:54.870

这是我几天前遇到的问题，目前还没有关于 SO 的通用答案。只有特殊情况。这是我在此页面上找到的答案：[http ://www.gnu.org/software/libtool/manual/html_node/Debugging-executables.html](http://www.gnu.org/software/libtool/manual/html_node/Debugging-executables.html)

在安装程序之前，系统不知道到哪里寻找共享对象。它们通常位于`.libs`其源文件夹的子目录中。

Libtool 会生成一个方便的脚本，以便在实际安装完成之前进行调试（谁想在之前安装有问题的软件*，**之后*调试它？）

幸运的是，生成的脚本为此提供了帮助：

```
libtool --mode=execute gdb test_mylib 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-05-18T14:44:16.377

libtool 文档推荐的解决方案是在开发过程中使用*静态链接*，正如我所描述的：[Build libtool application with static linking to local components](https://stackoverflow.com/q/37191903/86967)

为此，请使用脚本的[`--disable-shared`](https://www.gnu.org/software/libtool/manual/html_node/Static_002donly-libraries.html)选项。`./configure`

例如：

```
./configure --enable-debug --disable-shared 
```

现在生成的可执行文件是直接可执行的二进制文件，而不是 libtool 脚本。

这具有将构建时间大致减半的额外好处。

# android - 三星 Galaxy SIII 的问题 - Camera.onPictureTaken() 返回交错图像而不是正确的捕获图像

> ID：12148675
> 
> 赞同：2
> 
> 时间：2012-08-27T19:53:09.823
> 
> 标签：android, android-camera, galaxy

我们有一个利用后置“摄像头”捕捉物品图像的应用程序。到目前为止，我们测试过的所有设备都可以正常拍摄图像，直到三星 Galaxy SIII (S3)。

仅在三星 Galaxy SIII 上，我们观察到 Camera.onPictureTaken() 返回的原始图像似乎是隔行扫描的，而不是正确的捕获图像。调试每个相机参数设置，确定以下参数设置器导致问题。如果我们没有在参数上显式设置图片大小（），那么它会按预期工作：

```
parameters.setPictureSize(targetPictureSize); 
```

默认参数.getPictureSize() 返回 [w,h]=[3264, 2448]

'targetPictureSize' 是根据从下面返回的最接近的匹配大小确定的，在这种情况下，我们使用 [w,h]=[1600, 1200] 大小作为 'targetPictureSize'

```
camera.getParameters().getSupportedPictureSizes(); 
```

有人知道原因和解决方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T19:33:54.273

`camera.setParameters`当您在预览处于活动状态时使用与之前配置的（或默认值）不同的图片大小进行调用时，似乎会发生此问题。解决方法是在开始预览或停止预览之前先设置好图片大小，设置好参数，然后重新开始预览。

```
parameters.setPictureSize(1600, 1200);
...
camera.stopPreview();
camera.setParameters(parameters);
camera.startPreview(); 
```

技术说明：

隔行扫描的原因似乎是从相机返回的图像以默认分辨率 (3264x2448) 捕获，但标记为您使用 setPictureSize 指定的分辨率。结果，当显示此类图像时，来自捕获图像的每一行像素都被显示为（默认分辨率/指定分辨率）像素行。对于 1600x1200 的图片尺寸，这将导致图像出现隔行扫描，而在其他分辨率（例如 640x480）下，图像将完全损坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:44:54.377

我想这不会有一个好的答案或理由。我只能责怪三星没有正确实现 Camera.getParameters().setPictureSize()。

以下是我通过检查 S3 型号名称而不是调用 setPictureSize() 的解决方法

```
 // Source - http://en.wikipedia.org/wiki/Samsung_Galaxy_S_III
       String s3ModelNames[] = { "XXXXXXXXXXXXXXXX", // Place holder
                "SAMSUNG-SGH-I747", // AT&T
                "SAMSUNG-SGH-T999", // T-Mobile
                "SAMSUNG-SGH-N064", // Japan
                "SAMSUNG-SCH-R530", // US Cellular
                "SAMSUNG-SCH-I535", // Verizon
                "SAMSUNG-SPH-L710", // Sprint
                "SAMSUNG-GT-I9300", // International
                "SGH-I747", // AT&T
                "SGH-T999", // T-Mobile
                "SGH-N064", // Japan
                "SCH-R530", // US Cellular
                "SCH-I535", // Verizon
                "SPH-L710", // Sprint
                "GT-I9300"  // International
       };

       List<String> s3ModelList = Arrays.asList(s3ModelNames);

       if (s3ModelList.contains(deviceModel)) {
          // DEVICE SPECIFIC WORK AROUND for Samsung Galaxy S3
          // SKIP calling parameters.setPictureSize() Samsung Galaxy SIII phone (Confirmed on AT&T, Verizon, Sprint) due the Camera image are interlaced when setPictureSize() are set to other than default.
       } 
```

# asp.net-mvc-3 - .Net Web 应用程序性能问题

> ID：12148678
> 
> 赞同：0
> 
> 时间：2012-08-27T19:53:20.400
> 
> 标签：asp.net-mvc-3, performance, iis-6

我在 Windows Server 2003 上有一个使用 IIS 6 的 MVC3 C# .Net Web 应用程序。

我们遇到了一些性能问题。主要针对页面的初始加载。

我已将应用程序编译为发布模式，并且性能比在调试中要好得多。但是，页面的第一次加载仍然很慢，而且如果页面处于休眠状态一段时间，并且用户重新使用该应用程序，页面再次加载缓慢。在我看来，运行时编译正在进行中，一旦编译，对象会在一段时间后超时。

我可以做些什么来加快初始页面加载和扩展的休眠页面加载？

有没有办法在某个时间间隔自动模拟和加载页面？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T19:57:35.693

您正在经历 IIS 中应用程序池的加载和卸载。将您的 Web 应用程序想象成您计算机上的任何桌面应用程序。实际打开程序需要时间，但是一旦打开 -> 程序中的操作运行得很快。因此，当您第一次访问 Web 应用程序时，IIS 会在应用程序池中启动应用程序。

您看到的第二项是 IIS 在一段时间不活动（默认 20 分钟）后卸载应用程序池。在默认期限之后，应用程序池处于卸载状态。当请求进入您的应用程序时，IIS 必须再次启动应用程序，然后才能为请求提供服务。

至于当用户第一次点击 Web 应用程序时，你真的无法做任何事情来加快速度，它会发生。每当您更改 web.config 或更改 Bin 文件夹中的项目时，IIS 都会回收应用程序池。

对于空闲超时问题，您可以调整 IIS 等待它卸载应用程序池的时间（我相信最多 29 小时）。

[IIS 6 - 应用程序池超时更改](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/83b35271-c93c-49f4-b923-7fdca6fae1cf.mspx?mfr=true)

[[IIS 7 - 应用程序池超时更改]](http://technet.microsoft.com/en-us/library/cc771956%28v=ws.10%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:16:45.457

您可以预编译您的页面以加快初始加载时间。

有关详细信息，请参阅此 MSDN 部分： [ASP.NET 网站预编译](http://msdn.microsoft.com/en-us/library/ms228015%28v=vs.85%29)

弄乱应用程序超时（通过将其设置为非常大的值）可能会适得其反，因为它会禁用休眠应用程序的自动回收。

# grails - 从 Config.groovy 在 resources.xml 中配置 Spring Integration XML

> ID：12148681
> 
> 赞同：1
> 
> 时间：2012-08-27T19:53:25.837
> 
> 标签：grails, groovy, spring-integration

我有一个 Grails 应用程序，它有一些小的 UI 组件和域访问，但大多数情况下它正在运行一个 Spring 集成过程来轮询和阅读电子邮件并处理结果。

我希望能够根据环境配置电子邮件目标。

我有以下 Spring Integration XML 片段`resources.xml`：

```
<mail:inbound-channel-adapter id="imapAdapter"
          store-uri="imaps://myEmailAddress:myPassword@imap.gmail.com/INBOX"
          java-mail-properties="javaMailProperties"
          channel="receiveEmailChannel"
          should-delete-messages="false"
          should-mark-messages-as-read="true"
          auto-startup="true">
    <int:poller max-messages-per-poll="1" fixed-rate="15" time-unit="SECONDS">
    </int:poller>
</mail:inbound-channel-adapter> 
```

我有以下环境特定的配置片段`Config.groovy`：

```
environments {
    development {
        email.store.ui = 'imaps://myDevEmailAddress:myDevPassword@imap.gmail.com/INBOX'
    }
    test {
        email.store.ui = 'imaps://myTestEmailAddress:myTestPassword@imap.gmail.com/INBOX'
    }
    production {
        email.store.ui = 'imaps://myProdEmailAddress:myProdPassword@imap.gmail.com/INBOX'
    }
} 
```

如何将`email.store.ui`定义与 in`Config.groovy`中的`store-ui`属性联系起来`resources.xml`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:11:49.323

Grails 设置了从`PropertyPlaceholderConfigurer`中获取值的a `Config.groovy`，因此正常的 Spring 属性占位符语法应该可以工作

```
store-uri="${email.store.ui}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:11:57.627

我想我应该读到页面底部...答案在第[15.5 节属性占位符配置中](http://grails.org/doc/latest/guide/spring.html#propertyPlaceholderConfiguration)

我只需要：

```
<mail:inbound-channel-adapter id="imapAdapter"
          store-uri="${email.store.ui}"
          java-mail-properties="javaMailProperties"
          channel="receiveEmailChannel"
          should-delete-messages="false"
          should-mark-messages-as-read="true"
          auto-startup="true">
    <int:poller max-messages-per-poll="1" fixed-rate="15" time-unit="SECONDS">
    </int:poller>
</mail:inbound-channel-adapter> 
```

谢谢你的推动。

# java - 使用 java AWT 确定标题 windows 7 的大小

> ID：12148683
> 
> 赞同：0
> 
> 时间：2012-08-27T19:53:28.480
> 
> 标签：java, awt

是他们使用 Java AWT 确定窗口标题大小的一种方法。我刚刚使用（开始->控制面板->显示->个性化->窗口颜色->高级外观设置更改了本地Windows 7机器上的标题大小。在下拉列表中选择标题大小并将其设置为50。

任何有关使用 Java AWT 确定标题大小的输入都会非常有帮助。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:16:00.887

[在这里](http://docs.oracle.com/javase/7/docs/technotes/guides/swing/1.4/w2k_props.html)，您可以找到 Windows GUI 的属性列表以及如何检索它们。我希望你能在这个列表中找到合适的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:43:42.490

执行此操作的代码如下：

```
Integer i = (Integer) Toolkit.getDefaultToolkit().getDesktopProperty   
("win.frame.captionHeight");
System.out.println(i.intValue()); 
```

# java - “寻找共同祖先”的变体

> ID：12148687
> 
> 赞同：6
> 
> 时间：2012-08-27T19:54:03.447
> 
> 标签：java, algorithm, data-structures

我最近接受了电话采访。它涉及对问题进行编码作为过程的一部分。
问题是 the 的一个变体，`Find the most closest common ancestor of a tree`但有一个*转折*。这棵树很像图，即可以连接子节点。例子：

```
 A   
   /  
  B 
  | \ 
  C  E  
  |  |  
  D  F  
  \  /  
   G 
```

在这种情况下，给定这棵树和节点`F`以及`D`由此产生的最接近的公共 ansestor 将是`B`. 第二个转折是树以数组的形式呈现。要实现的方法具有以下输入：
`public String getCA(String[] nodes, String[][] parentNodes, String targetNode1, String targetNode2)`
在此示例中`nodes`=`{"G", "F", "E", "D", "C", "B", "A"}`和`parentNodes`=`{{"F","D"},{"E"}, {"B"}, {"C"}, {"B"}, {"A"}, null}`
基本上对于`nodes[i]`父级是`parentNodes[i]`.
老实说，我完全惊慌失措（本来就很紧张），花了*很*长时间才找到答案。
虽然我认为这是递归解决的，但我以某种方式提出了一个迭代解决方案，据我所知，它是可行的：我将节点推入队列，然后首先为第一个目标节点走上路径，然后是第二个节点。一旦我找到一个已经遇到的节点，我就会认为它是解决方案（添加了注释以清除问题）。

```
public String getCA(String[] nodes, String[][] parentNodes, String targetNode1, String targetNode2) {  
        if(nodes == null || parentNodes == null){  
            throw new IllegalArgumentException();  
        }  

        Map<String, String[]> map = new HashMap<String, String[]>();  
        for(int i = 0; i < nodes.length; i++){  
            map.put(nodes[i], parentNodes[i]);  
        }  
        //These are the parents visited as we go up  
        Set<String> parentsSeen = new HashSet<String>();  
        parentsSeen.add(targetNode1);  

        Queue<String> path = new LinkedList<String>();  
        String[] parents = map.get(targetNode1);  
        //The root is the common parent  
        if(parents == null){  
            return targetNode1;  
        }   

        //Build the path up  
        for(String parent:parents){  
            path.add(parent);  
        }  
        while(!path.isEmpty()){  
            String currentParent = path.remove();  
            parentsSeen.add(currentParent);  
            parents = map.get(currentParent);  
            if(parents == null){  
                continue;   
            }  
            for(String parent:parents){  
                path.add(parent);  
            }  
        }  

        parents = map.get(targetNode2);  
        //It is the root, so it is the common parent  
        if(parents == null){  
            return targetNode2;  
        }  
        //Start going up for the targetNode2\. The first parent that we have already visited is the common parent  
        for(String parent:parents){  
            if(parentsSeen.contains(parent)){  
                return parent;  
            }  
            path.add(parent);  
        }  

        while(!path.isEmpty()){  
            String currentParent = path.remove();  
            if(parentsSeen.contains(currentParent)){  
                return currentParent;  
            }             
            parents = map.get(currentParent);  
            if(parents == null){  
                continue;  
            }  
            for(String parent:parents){  
                path.add(parent);  
            }  
        }  
        return null;            
    } 
```

我没有接到前进的电话。现在由于我是“自学成才”的事实，我有兴趣了解我是如何在这里搞砸的。由于这是技术问题，我相信这不是主观问题，希望我能从有经验的人那里得到帮助。
那么作为同事程序员，您将如何处理问题以及如何评估我的解决方案？我需要做什么来提高我的技能？
你可以尽可能的直截了当。只要我能理解出了什么问题并学会了我就满足了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T03:58:46.927

我什至不清楚这里的“最接近”是什么意思。考虑下图：

```
 I
   /\
  /  \
 /    \
H      E
|\    /|
| \  / |
G  \/  D
|  /\  |
| /  F C
|/    \|
A      B 
```

这里有 A 和 B 的 2 个共同祖先，H 和 E。H 与 A 和 B 的距离为 2。E 与 A 的距离为 1，但与 B 的距离为 3。我该选择哪个？

此外，无论您对该问题的回答是什么，从一个中找到一组祖先，然后从另一个进行 BFS 是行不通的。找到 A 的所有祖先，然后从 B 做 BFS，首先找到 H，找到 B 的所有祖先，然后从 A 做 BFS，首先找到 E。作为对手，我可以切换 A 和 B 以使您的算法无论您做出什么选择都会失败（选择 2/2 还是 1/3 更好）。

所以正确的算法必须比仅仅一个祖先集计算加上一个 BFS 更复杂。除非你告诉我如何做出选择，否则我不确定我能否确定一个正确的算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:21:59.483

非常好的问题，你真的很努力写这个。我很抱歉接受采访，我知道当这样的事情发生时一定很沮丧。让我们看看问题所在。

想到的一个想法是：您可以递归地向上直到从两个目标节点到达根节点并构建两个列表。最后，只需在两个列表中找到第一个公共节点。

```
public static List<String> visitUpwards(Map<String, String[]> mapping, String current) {
    List<String> list = new ArrayList<String>();
    list.add(current);
    if(mapping.get(current) == null) return list;
    else {           
       for(String s: mapping.get(current)) {              
          list.addAll(visitUpwards(mapping, s));                            
       }
       return list;
    }
} 
```

**编辑**：再想一想，这不是一个好主意，因为它基本上是向上进行 DFS 搜索，因此很难找到第一个共同祖先。一个更好的主意是为每个目标运行 BFS（这可能看起来类似于您的解决方案：D）：

```
public static Set<String> BFS(Map<String, String[]> mapping, String node) {
    Queue<String> queue = new LinkedList<String>();
    Set<String> result = new LinkedHashSet<String>();
    queue.add(node);
    while(!queue.isEmpty()) {
        String current = queue.remove();
        result.add(current);
        if(mapping.get(current) != null)
            for(String s: mapping.get(current)) {
                queue.add(s);
            }
    }
    return result;
} 
```

然后使用另一张地图找到第一个共同祖先：

```
Set<String> list1 = BFS(mapping, "D");      
Set<String> list2 = BFS(mapping, "G");
System.out.println(list1);
System.out.println(list2);

Map<String, Boolean> src = new HashMap<String, Boolean>();

for(String s: list1) {
    src.put(s, true);
}

for(String s: list2) {
    if(src.get(s) != null && src.get(s)) {
        System.out.println(s);
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:10:21.407

一个更优化的解决方案可能是使用布尔数组进行簿记。每个节点一个。将它们全部初始化为*false*。访问节点时将它们设置为*true 。*就像你今天所做的那样，交替向上“树”。一旦你来到一个已经访问过的节点（在数组中设置为*true*），那么你就找到了共同的祖先。

编辑：更好的方法是为每个原始节点设置一个具有唯一标识符的整数数组。如果有循环我们需要知道谁已经访问过该节点，那可能是我们自己。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T19:59:32.540

我不能告诉你为什么公司没有给你回电话。但是，通过将代码提取到更小、更有意义的方法中，您的代码将受益匪浅，而不是使用具有所有详细、低级逻辑的单个大方法。尽管我还没有尝试编译您的代码并在一些测试用例上运行它，但仅从快速阅读来看，我根本不相信代码是正确的。最接近的评论祖先可能是`targetNode1` *or* `targetNode2`（例如，如果`targetNode2`是 的父级`targetNode1`）。（我想这取决于你如何定义“最近的共同祖先”的细节——你应该澄清在这种情况下它的含义。）

*   使用从节点到父节点的映射是一个好主意。但是您可以将构建该映射的代码提取到一个具有有意义名称的小方法中。
*   您可以定义一个通过图形实现广度优先搜索的方法（这基本上就是您在这里所做的）。`targetNode1`在和上使用相同的方法`targetNode2`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T01:42:04.960

考虑您的图表的以下变化...

```
 A
              |
          X---B---Y
           \ / \ /
            C   E  
            |   |
            D   F
             \ /
              G 
```

`nodes`=`{"G", "F", "E", "D", "C", "B", "A", "X", "Y"}`

`parentNodes`=`{{"F","D"},{"E"}, {"Y","B"}, {"C"}, {"X","B"}, {"A"}, null, {"B"}, {"B"}}`

我认为您的程序在到达节点时会遇到困难，`"C"`因为它有两个父节点要探索。您要么需要使用递归算法，要么使用迭代算法为未探索的节点管理某种堆栈。

由于您似乎对迭代有偏见，您可以尝试类似以下的操作：

创建一个数组（或类似的数据结构）。每个数组元素包含三个信息：

```
 nodeName: string - name of a node from your `nodes` string
 pathLength[2]: integer -  array of minimum path length from refrence node (1 or 2). 
```

创建堆栈。每个堆栈元素包含​​三个信息：

```
 nodeName: string - name of a node to "explore"
 lengthToHere: integer - length of path from reference node to `nodeName`
 pathNumber: integer - 1 for first reference node, 2 for second. 
```

算法：

```
 Initialize array with nodeName from nodes and set each pathLength to "infinity"
 Push both starting reference nodes onto the stack: 

       push("F", 0, 1)
       push "D", 0, 2)

Repeat until stack is empty:
  - pop(nodeName, lengthToHere, pathNumber)
  - update pathLength[pathNumber] of element having nodeName in array with minimum of
            its current value and lengthToHere
  - for each parent of nodeName push(parent, lengthToHere + 1, pathNumber) 
```

一旦评估了来自起始参考节点的所有路径，堆栈就为空。如果有一个共同的祖先，则给定 nodeName 的两个 pathLength 值都将小于无穷大。将这些值加在一起，给出到这个共同祖先的总路径长度。报告总和最小的 nodeName。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-28T08:44:39.963

对于给定的目标节点`x`并`y`执行以下操作：

*   将`x`其所有祖先添加到 set `S`。
*   检查是否`y`在`S`，如果不是，则检查其父母`y`是否在`S`，如果不是，则检查其父母是否在`S`，依此类推。

运行时间为 O(n)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-28T16:47:33.190

我可能误解了一些东西，但我认为您算法的这一部分可能会浪费大量时间研究节点：

```
 while(!path.isEmpty()){  
        String currentParent = path.remove();  
        parentsSeen.add(currentParent);  
        parents = map.get(currentParent);  
        if(parents == null){  
            continue;   
        }  
        for(String parent:parents){  
            path.add(parent);  
        }  
    } 
```

这看起来像是对树的广度优先搜索，但由于孩子有多个父母，您最终可能会多次搜索相同的节点。

您可以通过添加对 parentsSeen 集的检查来停止浪费时间：

```
 while(!path.isEmpty()){  
        String currentParent = path.remove();  
        if (parentsSeen.contains(currentParent)) {
            continue;
        }
        parentsSeen.add(currentParent);  
        parents = map.get(currentParent);  
        if(parents == null){  
            continue;   
        }  
        for(String parent:parents){  
            path.add(parent);  
        }  
    } 
```

# python - PyQt4 - 如何在不同的可调用对象之间共享变量？

> ID：12148690
> 
> 赞同：0
> 
> 时间：2012-08-27T19:54:08.930
> 
> 标签：python, pyqt4

因此，我希望我的 GUI 窗口从用户那里收集数据，并在用户确认已做出选择后打开指定的文本文件。我创建了一个全局字典来存储用户输入的信息，但我不知道如何将此字典发送到下一个函数调用。我不断收到错误“未定义全局名称'fileName'”。请帮忙！！

示例代码：

```
class guiFindFiles(QtGui.QWidget):  
fileName = {}

def __init__(self, parent=None):
    QtGui.QWidget.__init__(self, parent)

    #Create window
    self.setFixedSize(400,180)
    self.setWindowTitle("Choose the files to use")
    self.setAttribute(QtCore.Qt.WA_DeleteOnClose)
...

    #Connect all the signals and slots
    self.connect(self.qFileButton, QtCore.SIGNAL("clicked()"), self.loadFile)
    self.connect(self.lhButton, QtCore.SIGNAL("clicked()"), self.loadFile)
    self.connect(self.oldQButton, QtCore.SIGNAL("clicked()"), self.loadFile)
    self.connect(self.oldQCB, QtCore.SIGNAL("stateChanged(int)"), self.status)
    self.connect(self.run, QtCore.SIGNAL("rejected()"),self.close)
    self.connect(self.run, QtCore.SIGNAL("accepted()"),self.goForth)

def loadFile(self):                     
    selFile = QtGui.QFileDialog.getOpenFileName()

    if self.sender() == self.qFileButton:
        fileName["currentQ"]=selFile
        self.qFileTF.setText(selFile)
    elif self.sender() == self.lhButton:
        self.lhFileTF.setText(selFile)
        fileName["currentLH"]=selFile
    else:
        self.oldQTF.setText(selFile)    
        fileName["oldQ"]=selFile

def goForth(self):
    print fileName[0]
    self.close() 
```

错误消息：

Traceback（最近一次调用最后一次）：文件“qDis.py”，第 80 行，在 loadFile 文件名 [“currentQ”]=selFile NameError：未定义全局名称“文件名”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:42:30.927

在您的`loadFile`方法中，您正在寻找`fileName`，*即*未在您的函数或模块的其余部分中定义的 loval 变量，因此`NameError`.

很可能，您打算使用`self.fileName`，*即*您之前定义的类属性。

同样的评论和建议适用于您的其他方法`goForth`。

作为旁注：你真的需要`fileName`成为一个类属性吗？它不能只是您在`__init__`方法中定义的实例属性吗？

# .net - 如何正确处理 WCF 数据服务的 JSON 日期格式问题

> ID：12148692
> 
> 赞同：2
> 
> 时间：2012-08-27T19:54:15.047
> 
> 标签：.net, json, wcf-data-services

我已经实现了这样的 WCF 数据服务服务：

```
[System.ServiceModel.ServiceBehavior(IncludeExceptionDetailInFaults = true)]
public class SampleService : DataService<SampleDatabase>
{
    // This method is called only once to initialize service-wide policies.
    public static void InitializeService(DataServiceConfiguration config)
    {

        // TODO: set rules to indicate which entity sets and service operations are visible, updatable, etc.
        // Examples:
        config.SetEntitySetAccessRule("SampleData", EntitySetRights.All);
        // config.SetServiceOperationAccessRule("MyServiceOperation", ServiceOperationRights.All);
        config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V2;
        config.UseVerboseErrors = true;
    }
} 
```

但是，正如其他地方所记录的那样，框架 JSON 序列化代码没有正确格式化日期。日期未以有效的 ISO 格式输出。更令人惊讶的是，WCF 不会往返输出日期。所以它输出一个看起来像这样的日期：“/Date(1325376000000)/”，但不接受相同的值作为有效日期作为回报。

Hanselman 有如何为 WebAPI 修复它： [http ://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx](http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx)

我发现了 MVC 序列化的类似修复： [http ://www.dalsoft.co.uk/blog/index.php/2012/01/10/asp-net-mvc-3-improved-jsonvalueproviderfactory-using-json -网/](http://www.dalsoft.co.uk/blog/index.php/2012/01/10/asp-net-mvc-3-improved-jsonvalueproviderfactory-using-json-net/)

我们的客户指定了 MVC3 和 .NET 4，所以我认为 WebAPI 已经过时了，所以我想为 .NET 4 中的 MVC3 + WCF 数据服务解决这个问题。我从上述修复中的理解是，最好的修复是使用 JSON.NET 将序列化/反序列化覆盖为 .NET 和 Javascript 都可以理解的 ISO 格式。但是我找不到任何关于为此覆盖 JSON 序列化的指导。

如何专门针对 .NET 4 中的 WCF 数据服务解决此问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:44:47.903

在 OData V3 中，详细 JSON 中的日期时间也是使用 ISO 格式编写的。为此，您必须安装 WCF Data Services 5.0（实现 OData V3），在服务器上允许 V3 并修改客户端以请求 V3（因为 V2 有效负载将具有旧格式以实现向后兼容性）。要强制使用 V3 有效载荷格式，客户端可以发送 MinDataServiceVersion: 3.0; 标题。

注意：旧格式实际上是往返的，但它使用了棘手的 JSON 转义。实际格式是`\/Date(12345678)\/`（这在语义上是相同的`/Date(12345678)/`，但在线路上看起来不同）。不幸的是，浏览器中的 JSON 序列化代码无法生成这样的字符串。

# tsql - T-SQL 将多行转换为短 SMS 文本字符串/消息

> ID：12148694
> 
> 赞同：0
> 
> 时间：2012-08-27T19:54:36.817
> 
> 标签：tsql, sms, sp-send-dbmail

我正在尝试从相同的数据创建一条简短的 SMS 消息和一封完整格式的电子邮件。出于文本电子邮件的目的，如何将 2 行从 at 转换为 SQL 字符串。

我的表中只有 4 行，我使用自己的标准为它们分配“好”或“坏”的评级。完全格式化的电子邮件将显示所有四行，但 SMS 只需要显示坏的。

我可能会使用 sp_send_dbmail 发送两封电子邮件，有些人可能希望使用 Outlook 将 SMS 发送到他们的手机而不是 SMS 文本，而其他人将在他们的手机上使用不同的警报系统并在他们的设备上阅读电子邮件。

这是我想做的一个例子。@htmlEmailText 工作正常，因为它使用“FOR XML”子句。

```
if @format = 'EMAIL' 
    begin 
        SET @SMSEmailText = 
            'BizTalk Feed Alert ' + 
            CAST (( 
            SELECT Airline, 'Feed=' + ST.Feed, 'MinutesSinceLastMessage=' + MinutesSinceLastMessage 
               where Rating = 'BAD') 
                ) AS NVARCHAR(MAX) )
                ;
        SET @htmlEmailText =
            N'<H1>BizTalk Feed Alert</H1>' +
            N'<table border="1">' +
            N'<tr>' + 
            N'<th>Rating</th>' +
            N'<th>Airline</th>' +
            N'<th>Feed</th>' +
            N'<th>MinutesSinceLastMessage</th>' +
            N'<th>AlertMinutes</th>' +
            N'<th>LocalDateTimeLastMsgRcvd</th>' +
            N'<th>CountMessageInLastHour</th>' +
            N'<th>AvgCountPerSameHour</th>' +
            CAST ( ( SELECT td = Rating,       '',
                            td = Airline, '',
                            td = ST.Feed, '',
                            td = MinutesSinceLastMessage, '',
                            td = AlertMinutes, '',
                            td = LocalDateTimeLastMsgRcvd, '', 
                            td = CountMessageInLastHour, '', 
                            td = AvgCountPerSameHour, ''
                      from @StatsTable ST 
                      left outer join @CountTable CT on ST.Feed = CT.Feed 
                      left outer join @AvgTable AT on ST.Feed = AT.Feed 
                      FOR XML PATH('tr'), TYPE 
            ) AS NVARCHAR(MAX) ) +
            N'</table>' 
            ;
    end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:31:35.670

您可以声明一个`nvarchar(max)`变量来保存行，然后像这样连接它们：

```
DECLARE @BadText nvarchar(max)
SET @BadText = ''
SELECT @BadText = @BadText + Airline + '; Feed=' + ST.Feed + '; ' +  
    'MinutesSinceLastMessage=' + MinutesSinceLastMessage 
WHERE Rating = 'BAD'

SET @SMSEmailText = 
        'BizTalk Feed Alert ' + @BadText 
```

现在，您还需要将任何`ints`/`floats`转换`nvarchars`为，并且您必须根据自己的喜好调整格式，但这应该可以。

# jquery - 元素上的淡出/淡入图像

> ID：12148702
> 
> 赞同：0
> 
> 时间：2012-08-27T19:55:45.610
> 
> 标签：jquery, css, image, fade

我目前有一个覆盖了图像的 div，我目前正在使用以下代码淡出图像以显示下面元素中的文本：

```
$(".Content_Frame_Image").hover(
function() {
$(this).stop().animate({"opacity": "0"}, "slow");
},
function() {
$(this).stop().animate({"opacity": "1"}, "slow");
}); 
```

然而，因为我只是让它不可见，我无法获得在下面工作的链接，你可以在这里看到一个示例[http://playing.everythingcreative.co.uk](http://playing.everythingcreative.co.uk)

如果我使用淡出方法，那么它不会在悬停时淡入...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:57:33.337

这是怎么回事：

```
$(".Content_Frame_Container")
    .each(function(){
        $(this).find('.Content_Frame_Image');
    })
    .hover( 
        function(){
            $(this).find('.Content_Frame_Image').stop().fadeOut('slow');
        }, 
        function(){
            $(this).find('.Content_Frame_Image').stop().fadeIn('slow');
        }
    ); 
```

使用 chrome dev-tools 对其进行了测试——应该可以很好地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:04:11.043

如果您需要使用 opacity 而不是 fadeOut，请在动画之后使用回调函数：

```
$(".Content_Frame_Image").hover(
function() {
    $(this).stop().animate({"opacity": "0"}, "slow", function() {
        //move the element off-screen
        $(this).css({
            'position' : 'absolute',
            'left' : '-9999px'
        });
    });
},
function() {
    //move it back first
    $(this).css({
        'position' : 'absolute',
        'left' : '0'
    });
    $(this).stop().animate({"opacity": "1"}, "slow");
}); 
```

# python - ImageShack API 和 Python

> ID：12148707
> 
> 赞同：0
> 
> 时间：2012-08-27T19:56:12.543
> 
> 标签：python, api, imageshack

我想开始编写我的第一个简单应用程序只是为了学习，但我遇到了一些问题——ImageShack API。对于我想创建这个 API 的程序会有很大帮助，但我使用的是 Python 语言，我不知道它真的能用吗？我是编程的初学者，所以我仍然不知道很多东西。也许编程语言无关紧要？请帮忙。

伊格纳斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T22:07:58.697

Python 有很多很棒的库，使其在这种类型的应用程序中非常有用。我一般会说大多数语言可以做大多数事情，但语言确实有它们的长处，并且由于内置库和其他可用的插件，Python 除了易于学习之外，对于 Web 界面等非常强大.

此外，还有很多关于如何将 Python 与基于网站的解决方案接口的信息，这里有一些地方可以帮助您入门：

[美丽汤](http://www.crummy.com/software/BeautifulSoup/)

[Python 中的 Web 编程](http://wiki.python.org/moin/WebProgramming)

[图片hack.py](http://www.void.gr/kargig/blog/2007/09/15/imageshackpy/)

# redis - django-celery celerybeat 周期性任务每 5 秒运行一次，无论间隔如何

> ID：12148708
> 
> 赞同：0
> 
> 时间：2012-08-27T19:56:19.173
> 
> 标签：redis, celery, django-celery

尽管有一些项目使用 celerybeat 和 django-celery，但我以前从未遇到过这个问题。我使用redis作为后端。

出于某种原因，周期性任务每 5 秒运行一次，无论间隔设置为多少。我知道节拍调度程序确实会查看 django-celery 调度程序，因为当我禁用任务时，它会停止运行。但是，无论我将其设置为每 3 小时运行一次......还是每 5 分钟......任务都会继续每 5 秒运行一次。

关于有什么问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T03:21:42.133

显然，这是 celery 团队正在解决的一个新问题。

[https://github.com/celery/celery/issues/943#issuecomment-8146492](https://github.com/celery/celery/issues/943#issuecomment-8146492)

# security - 一般安全性：可以通过我的网站访问我的数据库吗？

> ID：12148711
> 
> 赞同：1
> 
> 时间：2012-08-27T19:56:27.347
> 
> 标签：security

这是我的基本设置...

我有一个网站，将用于员工登录，并提交时间表表单、购买等内容。该网站是用一些基本的 HTML 编写的，然后在后端有一些 PHP 来运行一些 SQL 查询来拉/发送与网站托管在同一服务器上的 Microsoft Access 数据库的一些信息。

我的问题是……如果有人获得了登录网站的员工密码，他们查看我的数据库内容有多容易？老实说，我没有直觉或线索来指导我，所以我正在寻求帮助。目前设置这里真的没有保护，所以如果很容易访问数据库，我想要一些关于如何保护它的指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:58:33.183

> 如果有人获得了登录网站的员工密码，那么他们查看我的数据库内容有多容易？

这一切都取决于权限和连接字符串。与我在下面发布的内容相同的风险适用于上述场景，但是拥有有效的凭据肯定可以***更容易***地访问数据库。

即使他们没有得到某人的密码，如果该网站易受 SQL 注入攻击，某人也有可能访问您的数据库。

有太多变量无法完全涵盖在此论坛上保护您的数据库。但这里有几个很好的起点。

*   [SQL 注入的一般概述](https://www.owasp.org/index.php/SQL_Injection)（您将面临的事情之一。）
*   [OWASP 2010 年十大漏洞列表](https://www.owasp.org/index.php/Top_10_2010-Main)（每隔几年更新一次，OWASP 网站是安全信息的必读内容）
*   [IBM 对安全 PHP 编码的建议](http://www.ibm.com/developerworks/opensource/library/os-php-secure-apps/index.html)。

最后，***我知道您说您使用的是 PHP，而不是 ASP.NET，***但无论如何我都会建议使用以下链接。它不仅仅是代码，包括威胁建模、常见风险等。即使您不是 .NET 开发人员，它也是一个极好的资源。

*   [构建安全的 ASP.NET 应用程序：身份验证、授权和安全通信](http://msdn.microsoft.com/en-us/library/ff649211.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T19:59:37.463

您应该问自己的第一个问题是用户是否有可能影响您发送到数据库的 SQL 查询。这是最危险的情况。

# c# - C# 归并排序性能

> ID：12148712
> 
> 赞同：9
> 
> 时间：2012-08-27T19:56:34.070
> 
> 标签：c#, algorithm, sorting, mergesort

只是一个简短的说明，这不是家庭作业。我只是想重温我的算法。我在 C# 中使用 MergeSort，我编写了一个可以基于泛型进行排序的递归方法：

```
class SortAlgorithms
{

    public T[] MergeSort<T> (T[] unsortedArray) where T : System.IComparable<T>
    {
        T[] left, right;
        int middle = unsortedArray.Length / 2;

        left = new T[middle];
        right = new T[unsortedArray.Length - middle];

        if (unsortedArray.Length <= 1)
            return unsortedArray;

        for (int i = 0; i < middle; i++)
        {
            left[i] = unsortedArray[i];
        }

        for (int i = middle; i < unsortedArray.Length; i++)
        {
            right[i - middle] = unsortedArray[i];
        }

        left = MergeSort(left);

        right = MergeSort(right);

        return Merge<T>(left, right);
    }

    private T[] Merge<T> (T[] left, T[] right) where T : System.IComparable<T>
    {
        T[] result = new T[left.Length + right.Length];

        int currentElement = 0;

        while (left.Length > 0 || right.Length > 0)
        {
            if (left.Length > 0 && right.Length > 0)
            {
                if (left[0].CompareTo(right[0]) < 0)
                {
                    result[currentElement] = left[0];
                    left = left.Skip(1).ToArray();
                    currentElement++;
                }
                else
                {
                    result[currentElement] = right[0];
                    right = right.Skip(1).ToArray();
                    currentElement++;
                }
            }
            else if (left.Length > 0)
            {
                result[currentElement] = left[0];
                left = left.Skip(1).ToArray();
                currentElement++;
            }
            else if (right.Length > 0)
            {
                result[currentElement] = right[0];
                right = right.Skip(1).ToArray();
                currentElement++;
            }
        }

        return result;
    }
} 
```

这行得通，但速度很慢。我已经使用 System.Diagnostic.StopWatch 来检查 Array.Sort（它使用 QuickSort 算法）的性能，以与我的 MergeSort 进行比较，并且差异如此之大，我想知道我是否实施了这个错误。任何意见？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-27T20:02:52.017

我不是 C# 程序员，但问题可能出在使用这样的语句吗？

```
left = left.Skip(1).ToArray(); 
```

这可能以强制底层数组的深层副本的方式实现。如果是这样，这会将合并的性能从 O(n) 降低到 O(n ² )，立即将生成的合并排序的性能从 O(n log n) 降低到 O(n ² )。

（这是因为重复从

> T(1) = O(1)
> 
> T(n) ≤ 2T(n / 2) + O(n)

有解 T(n) = O(n log n)，到

> T(1) = O(1)
> 
> T(n) ≤ 2T(n / 2) + O(n ² )

有解 T(n) = O(n ² )。)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:02:20.463

您不断地以中间数组的形式分配内存。考虑重用原始数组的方向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:13:44.073

正如其他两个答案所说，您正在到处创建新数组，为此花费大量时间和内存（我猜，您的大部分时间和几乎所有内存使用）。

再说一遍，我要补充一点，所有其他相等的递归往往比迭代慢，并使用更多的堆栈空间（甚至可能导致溢出，而​​问题足够大，而迭代不会）。

然而。合并排序非常适合多线程方法，因为您可以让不同的线程处理第一批分区的不同部分。

因此，如果我玩这个，我接下来的两个实验将是：

1.  对于分区的第一部分`MergeSort`，我不会递归调用，而是启动一个新线程，直到每个核心都有一个线程在运行（在超线程的情况下，我应该按物理核心还是虚拟核心执行，本身就是我要试验的东西）。
2.  完成后，我会尝试重新编写递归方法以在没有递归调用的情况下做同样的事情。

处理完这`ToArray()`件事后，看看多线程方法如何首先将工作分配给最佳数量的内核，然后让每个内核迭代地完成其工作，这确实会非常有趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T00:05:30.223

首先，这里有一个类似问题的简化解决方案的链接：[Java 合并排序，“合并”步骤应该用队列还是数组完成？](https://stackoverflow.com/questions/12062861/java-mergesort-should-the-merge-step-be-done-with-queues-or-arrays/12065121#12065121)

您的解决方案很慢，因为您反复分配新的子数组。内存分配比大多数其他操作更昂贵（您有分配成本、收集成本和缓存局部性丢失）。通常这不是问题，但如果您尝试编写严格的排序例程，那么它很重要。对于归并排序，您只需要一个目标数组和一个临时数组。

将线程分叉以并行化仍然比这贵几个数量级。因此，除非您有大量数据要排序，否则不要分叉。

正如我在上面的答案中提到的，加快合并排序的一种方法是利用输入数组中的现有顺序。

# python - Python if 语句，不能连接 'str' 和 'instance' 对象

> ID：12148713
> 
> 赞同：2
> 
> 时间：2012-08-27T19:56:38.503
> 
> 标签：python, if-statement, xml-parsing

我的问题是我想检查一个名为的 xml 变量中的一个变量，`xmlauthor`并且我想检查它上面是否基本上写了一些东西。我该怎么做？这是我到目前为止所写的：

```
for num in ic : 
    xmlauthor = dom.getElementsByTagName("author")[0]

    if not xmlauthor: 
        content += "***Changes by:"  + xmlauthor + "*** \n \n"
    else:
        content += "***Changes are made Anonumously** \n \n" 
```

这是我在控制台上遇到的错误

```
content += "***Changes by:"  + xmlauthor + "*** \n\n" 
TypeError: cannot concatenate 'str' and 'instance' objects 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-27T20:01:44.587

假设您正在使用[xml.dom](http://docs.python.org/library/xml.dom.html)：`getElementsByTagName`不返回字符串列表，而是返回[Element](http://docs.python.org/library/xml.dom.html#dom-element-objects)对象列表，因此您无法连接`xmlauthor`到行中的字符串

```
 content += "***Changes by:"  + xmlauthor + "*** \n \n" 
```

您可以通过将其更改为：

```
 content += "***Changes by:"  + xmlauthor.childNodes[0].nodeValue + "*** \n \n" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T21:24:30.813

下一次的一些提示：

*   当您遇到类似的错误`TypeError: cannot concatenate 'str' and 'instance'`时，您可以从检查错误发生的位置开始。你在哪里向字符串添加一些东西？
*   一旦您确定了问题所在（回溯无论如何都会为您提供行号），您可能需要检查您尝试添加到字符串中的对象的类型（在您的示例中，它是`xmlauthor`.A`print type(xmlauthor)`应该给您大量的信息。
*   特别是，它可能会让您对对象是什么有所了解。在您的示例中，我们可以假设它是`xml.dom`模块中定义的某个对象。文档对此有何评论？你可以去看看[docs.python.org](http://docs.python.org)，或者你可以试试`help(your_object)`.
*   是你期待的对象吗？可能不是。有没有更有趣的东西，比如这个对象的方法或属性可以解决你的问题？再一次，去检查文档，或者只是尝试`dir(your_object)`找到它可以提供的内容。
*   也许它毕竟不是您需要的，或者您无法理解文档。那么在 SO 上提问是个好主意。但也只有那时。

有一个直接的答案当然很好，但是了解哪里出了问题更好，你会同意的。

# java - 创建正则表达式来解析文件 - Java

> ID：12148714
> 
> 赞同：4
> 
> 时间：2012-08-27T19:56:47.080
> 
> 标签：java, regex

我有一个我想以以下格式解析的日志文件：

```
225:org.powertac.common.Competition::0::new::game-0
287:org.powertac.common.Competition::0::withSimulationBaseTime::1255132800000
288:org.powertac.common.Competition::0::withTimezoneOffset::-6
288:org.powertac.common.Competition::0::withLatitude::45
289:org.powertac.common.Competition::0::withBootstrapTimeslotCount::336
289:org.powertac.common.Competition::0::withBootstrapDiscardedTimeslots::24
290:org.powertac.common.Competition::0::withMinimumTimeslotCount::1400
290:org.powertac.common.Competition::0::withExpectedTimeslotCount::1440
291:org.powertac.common.Competition::0::withTimeslotLength::60
291:org.powertac.common.Competition::0::withSimulationRate::720
292:org.powertac.common.Competition::0::withTimeslotsOpen::24
292:org.powertac.common.Competition::0::withDeactivateTimeslotsAhead::1
300:org.powertac.du.DefaultBrokerService$LocalBroker::1::new::default broker
300:org.powertac.du.DefaultBrokerService$LocalBroker::1::setLocal::true
2074:org.powertac.common.RandomSeed::2::init::CompetitionControlService::0::game-setup::5354386935242895562
2157:org.powertac.common.TimeService::null::setCurrentTime::2009-10-10T00:00:00.000Z
2197:org.powertac.common.RandomSeed::3::init::AccountingService::0::interest::-8975848432442556652
2206:org.powertac.common.RandomSeed::4::init::TariffMarket::0::fees::-6239716112490883981
2213:org.powertac.common.msg.BrokerAccept::null::new::1
2214:org.powertac.common.msg.BrokerAccept::null::new::1::null
2216:org.powertac.common.RandomSeed::5::init::org.powertac.du.DefaultBrokerService::0::pricing::8741252857248937781
2226:org.powertac.common.TariffSpecification::6::new::1::CONSUMPTION
2231:org.powertac.common.Rate::7::new
2231:org.powertac.common.Rate::7::withValue::-0.5
2232:org.powertac.common.Rate::7::setTariffId::6 
```

模式如下：对于一个新对象：

```
<id>:<classname>::<order_of_execution>::<new>::<args> 
```

对于方法调用：

```
 <id>:<classname>::<order_of_execution>::<method_name>::<args> 
```

对于内部类：

```
 <id>:<classname$innerclass>::<order_of_execution>::<method_name or new>::<args> 
```

`init`来电：

```
 <id>:<classname>::<order_of_execution>::<init>::<args> 
```

我想要一个处理所有情况的正则表达式，并且我将能够检索每个值，如案例中所示。如果我想创建一个新对象，那么我会`Reflection`使用`Java`. 因此，例如：

```
2231:org.powertac.common.Rate::7::new 
```

将被解析为“2231”、“org.powertac.common.Rate”、“7”、“new”、args = {}。我怎么能想出这样的正则表达式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:16:00.577

将 a[`Matcher`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html)与捕获组一起使用：

```
String s = "225:org.powertac.common.Competition::0::new::game-0";
Pattern p = Pattern.compile("([^:]+):([^:]+)::([\\d]+)::([^:]+)::(.+)");
Matcher m = p.matcher(s);
if (m.find()) {
  String id = m.group(1);
  String className = m.group(2);
  int orderOfExecution = Integer.valueOf(m.group(3));
  String methodNameOrNew = m.group(4);
  String[] arguments = m.group(5).split("::");
} 
```

或者更简单的方法，使用[`java.util.Scanner`](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html), 将分隔符设置为`::?`：

```
Scanner scanner = new Scanner(s);
scanner.useDelimiter("::?");
int id = scanner.nextInt();
String className = scanner.next();
int orderOfExecution = scanner.nextInt();
String methodNameOrNew = scanner.next();
scanner.useDelimiter("$").skip("::");
String[] arguments = scanner.next().split("::"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:03:59.350

不要试图将所有这些都塞进一个正则表达式中。为每个模式创建一个正则表达式，并且对于每一行，将其与每个正则表达式匹配，直到找到匹配的模式。然后你可以相应地解析。

伪代码：

```
for line in file:
    if re.match(patNew, line):
        parseNew(line)
    elif re.match(patMethod, line):
        parseMethod(line)
    ... 
```

要匹配的正则表达式`<id>:<classname>::<order_of_execution>::<new>::<args>`如下所示：

```
([0-9]+):(.*?)::([0-9]+)::(new)(?:::(.*))? 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-27T20:10:01.283

由于值是用冒号分隔的，并且本身不能包含冒号，因此不需要转义或引用，所以您只需要一个简单的

```
(.*):(.*)::(.*)::(.*)::(.*) 
```

如果 args 应该是可选的，请使用

```
(.*):(.*)::(.*)::([^:]*)(?:::(.*))? 
```

这些值在组 1 到 5 中。例如，要确定日志条目是否是构造函数调用，请检查组 4 是否等于“new”。

# php - MySQL 数据库设计 - 签入系统

> ID：12148715
> 
> 赞同：0
> 
> 时间：2012-08-27T19:56:55.687
> 
> 标签：php, mysql

我希望从你那里得到一点数据库设计知识:)

我正在尝试为办公楼建立一个签到系统。

会发生什么：

1.  关于 A 楼炸弹威胁的代码被调用。
2.  指定的用户应该扫描分配给他们的一个或多个区域。
3.  然后，用户将检查他们的区域。（未检查，检查 - 没问题，检查 - 问题）

我需要构建一个界面来拉取所有传入的提交。

```
Users
---------------
id | name | username | password

Buildings
---------------
id | name

Sections
---------------
id | building_id | name

Assignments
---------------
id | section_id | user_id 
```

所以这个整体设计可以将用户分配到部分（多对多）和部分到建筑物（一对一）

我遇到的问题是存储实际提交的内容，同时以后能够轻松地检索它们。

我希望能够以允许用户更新答案的方式存储提交。查看旧答案。提交新答案。

非常感谢任何建议。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:34:49.803

我认为您还需要一个事件和响应表。

事件将是日期时间和任何细节（炸弹威胁 - 寻找背包）。

输入事件后，系统应预先填写响应表，所有分配的响应值为未选中。当每个人回复时，您添加他们的回复和回复的日期时间。您可以通过对其运行查询并提取按 assignmentID 分组、按事件过滤的最大响应日期时间来了解尚未检查的内容。

之后，您可以对所有响应运行日志，以分析诸如谁响应最快之类的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T12:41:11.817

我建议添加以下表格：

a) 威胁

*   ID
*   威胁日期
*   描述
*   用于捕获威胁元数据的其他列

b) 威胁状态

*   ID
*   威胁ID
*   checker_id（检查的人可能并不总是被分配的人）
*   section_id
*   地位
*   datechecked（假设它可能并不总是在同一天也适用于午夜检查），notes（如果有的话），
*   building_id（复制此列以加快查找速度，这样您就不必加入部分来查找建筑物）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:53:53.950

从您所在的位置，我会添加一个报告表，用于需要响应的报告。这当然包括一个 ID、报告生成时间的日期/时间字段、一个状态字段（例如，收到的报告、确定不需要响应的报告、正在进行的响应、已联系的紧急服务、响应完成），可能还有一个事件标题的短字段（“炸弹威胁”）和描述的自由文本字段（“未知男性来电者在 MDT 上午 10:23 打电话给前台并说在建筑物中放置了一枚大炸弹地下室 B. 前台接待员 J. Random 在上午 10:28 收到的报告。”）

然后，您还需要一个答案表。这将至少包括其自己的唯一 ID、事件 ID、做出响应的用户的用户 ID、被响应的部分 ID、记录响应的日期/时间、“响应类型”字段（例如，响应待定、响应中、未发现问题、发现潜在问题/推荐紧急服务联系人），以及允许响应者输入有关其响应的更多详细信息的自由文本字段。

由于这是紧急响应日志，您可能需要考虑对其他记录进行修改/补充以反映更新，而不是覆盖或更新现有记录，但这取决于您和您的用户的要求。该系统还允许您通过记录进行直接更新，并且任何一种方式都可以轻松地让您提取用户先前对问题的响应的日志。

# extjs4 - Ext.grid.panel 上的关键事件

> ID：12148716
> 
> 赞同：3
> 
> 时间：2012-08-27T19:57:05.443
> 
> 标签：extjs4

> **可能重复：**
> [ExtJS 4 及其新的 MVC：网格：如何处理键？](https://stackoverflow.com/questions/6941037/extjs-4-and-its-new-mvc-grid-how-to-handle-keys)

我需要将键监听器添加到 Ext.grid.Panel（即空格键监听器，左，右）。实际上我需要在 Panel 上捕获 'keyup' 或其他一些与关键相关的事件。我尝试了一切，但没有成功。有人有什么想法吗？我正在使用 Extjs 4。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T23:49:36.333

如果一个组件不直接暴露关键事件，你需要做一些工作。这可能不是解决此问题的最佳方式，但这是一个开始。

第一个技巧是知道某些 DOM 元素（例如`div`，除非它们具有选项卡索引）不会触发键事件。所以做这样的事情：`grid.getEl().set({tabindex: "0"})`让事情滚动起来。

现在您的网格元素将触发关键事件。下一步是添加一个针对您的网格的 KeyMap。有几种方法可以做到这一点，但这是一个很好的方法：

```
grid.getEl().addKeyMap({
    eventName: "keyup",
    binding: [{
        key: Ext.EventObject.SPACE,
        fn:  function(){ console.log("Space key pressed"); }
    },{
        key:   [Ext.EventObject.LEFT, Ext.EventObject.RIGHT],
        shift: true,
        fn:    function(){ console.log("Left or right pressed while pressing shift"); }
    }]
}); 
```

基本上，`binding`是一组对象，它们指定一个或多个要侦听的键和要触发的函数。如果您查看[Ext.util.KeyMap](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.util.KeyMap)文档，您可以了解更多信息。

注意`eventName`上面的使用。您可以为每个 KeyMap 设置一种类型的事件。因此，如果您想同时绑定 keydown 和 keyup 事件，则需要在同一个元素上使用两个 KeyMap。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T23:47:35.277

对于初学者，请查看[KeyMap](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.util.KeyMap)。

# c# - WCF 回调错误取决于参数

> ID：12148719
> 
> 赞同：0
> 
> 时间：2012-08-27T19:57:32.493
> 
> 标签：c#, wcf, nhibernate, fluent-nhibernate, wcf-callbacks

这是我的问题。如果我这样调用我的回调：

```
clients[computerID].PrintLabelCallback(label); 
```

通道故障，我在客户端收到 CommunicationFault 异常。调用是一种方式，不会导致服务器端出现问题。

但是，如果我这样称呼它：

```
label.EntryLocation = null;
label.EntryUser = null;
label.ResultLine = null;
label.Printer = null;
label.Type = null;
clients[computerID].PrintLabelCallback(label); 
```

其中 EntryLocation、EntryUser 等是我定义的类。我不必取消基本类型，如`String`, `int`。那些穿越电线的人没有发生任何事故。似乎双方都使用了相同的类型，所以我不确定这是失败的地方。

什么可能导致这种情况？我将如何解决它？

编辑：这是我的班级和相关领域的定义。

```
[DataContract(IsReference = true), JsonObject(IsReference = false), Serializable]
public partial class Label : Interfaces.IRQSObject
{

    /// <summary>
    /// The location where the Label was created. 
    /// </summary>
    [DataMember(EmitDefaultValue = false)]
    public virtual Location EntryLocation { get; set; }

    /// <summary>
    /// The user that Generated the Label
    /// </summary>
    [DataMember(EmitDefaultValue = false)]
    public virtual User EntryUser { get; set; }

    /// <summary>
    /// The printer that this label will be printed out at 
    /// </summary>
    [DataMember(EmitDefaultValue = false)]
    public virtual LabelPrinter Printer { get; set; }

    /// <summary>
    /// The Type of the label
    /// </summary>
    [DataMember(EmitDefaultValue = false)]
    public virtual LabelType Type { get; set; }

    [DataMember(EmitDefaultValue = false)]
    public virtual ResultLine ResultLine { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:06:04.093

我想一个或多个类还没有准备好进行**序列化**。

您可能需要使用属性标记类以及需要通过该属性`[DataContract]`的电线发送的所有成员`[DataMember]`

像这样：

```
[DataContract]
public class PurchaseOrder
{
    [DataMember]
    public Address BillTo {get; set;}
    [DataMember]
    public Address ShipTo {get; set;};
} 
```

看看这篇 MSDN 文章：[序列化和反序列化](http://msdn.microsoft.com/en-us/library/ms731073.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:26:20.310

事实证明，我的问题与我提供的信息几乎完全无关。我正在使用 NHibernate，在这种情况下，我忘记`Detach`了在我的回调中传递它之前的对象。这是实际错误（用 找到`svclog`）：

> 不需要输入数据合同名称为“LocationProxy:http://schemas.datacontract.org/2004/07/”的“LocationProxy”。考虑使用 DataContractResolver 或将任何静态未知的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将它们添加到传递给 DataContractSerializer 的已知类型列表中。

WCF 抱怨当我将标签附加到对象图时添加的神奇 NHibernate 属性。

# c - RSA_public_encrypt 和结构 openssl

> ID：12148722
> 
> 赞同：0
> 
> 时间：2012-08-27T19:57:39.260
> 
> 标签：c, unix, struct, openssl

用 RSA 加密文本填充仅包含 char 数组的结构的最佳方法是什么？现在我的结构是这样的：

```
typedef struct s {
    char a[20];
    char b[10];
    char c[1024];
}pack; 
```

我想像这样改变结构定义

```
 typedef struct s {
        char *a;
        char *b;
        char *c;
    }pack; 
```

然后打电话

```
RSA_public_encrypt 
```

将加密后的字符串保存在临时变量中，使用 RSA_public_encrypt 的返回值对 struct 的字段进行 malloc，现在才将字符串从临时变量复制到 struct 字段。还有另一种简单的方法可以做到这一点吗？

# php - 您如何在已经回显内容的回显中回显变量

> ID：12148729
> 
> 赞同：0
> 
> 时间：2012-08-27T19:57:58.667
> 
> 标签：php, echo

有没有办法回显一个已经回显的变量，我尝试这样做，但它没有回显它

```
if (logged_in() === true) {
            echo
            '

<li ><a href="#">',$user_data['username'],'</a>
<ul>
    <li><a href="../social.php">socail</a></li>
    <li><a  href="../my/pictures.php">my pictures</a></li>
    <li><a  href="../profile.php">profile</a></li>
    <li><a href="../logout.php">logout</a></li>
</ul>   ';
        } else {
            include'cpages/cmain/menuforms/formsmenu.php';

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:59:57.407

```
 if (logged_in() === true) {
            echo
            '

<li ><a href="#">'.$user_data['username'].'</a>
<ul>
    <li><a href="../social.php">socail</a></li>
    <li><a  href="../my/pictures.php">my pictures</a></li>
    <li><a  href="../profile.php">profile</a></li>
    <li><a href="../logout.php">logout</a></li>
</ul>   ';
        } else {
            include'cpages/cmain/menuforms/formsmenu.php';

        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:00:05.380

你是说串联吗？

```
<li ><a href="#">' . $user_data['username'] . '</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:03:49.150

你连接字符串错误，你应该使用点：

**编辑**

经过一番谷歌搜索后，我发现用逗号连接显然也可以，我不知道......

```
 echo "text".$variable."text".$variable2; //and so on. 
```

**编辑 2**

显然，echo 可以采用多个参数，当您通过用逗号分隔值来传递值时会发生这种情况。然后它不是真正的字符串连接，用户 ACJ 指出了这一点。

但是，在这种情况下，我仍然会使用 HEREDOC 或将字符串连接到一个变量，然后将其回显。

需要注意的是您是否正确转义了双引号和单引号，这是处理长字符串时的常见问题，尤其是包含 html 的字符串。

此外，您可能想查看 Heredoc：

```
$variable = <<<EOT 
    Place your multiline string here 
    and dont forget to end it with the same as you started it.
EOT; //Must not be indented 
```

您还应该查看这个问题：[Best practice working with long strings in PHP](https://stackoverflow.com/questions/1848945/best-practices-working-with-long-multiline-strings-in-php)

好的，所以要真正解决您的问题，假设您已经检查过 logged_in() 的计算结果确实为`true`，那么我能想到的唯一问题是 $user_data 不包含名为`username`.

我首先通过在文件顶部调用以下命令来启用 error_reporting：

```
error_reporting(E_ALL | E_STRICT) //reports all errors. 
```

然后你应该很快就知道你的代码出了什么问题，因为它在我的电脑上运行得很好。

# c# - 当我覆盖 CreateParams 时，RichTextBox 不显示所有数据

> ID：12148731
> 
> 赞同：3
> 
> 时间：2012-08-27T19:58:07.643
> 
> 标签：c#, rtf

我[发现](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/194f563c-205f-41a1-9582-4f03fd3a53c2/)了一些由 NoBugz ( [Hans Passant](https://stackoverflow.com/users/17034/hans-passant) ) 编写的旧代码，如果我理解的话，它会强制 Richtextbox 使用 RTF 5.0 而不是 4.0。基本上它只是一个继承`RichTextBox`和覆盖`CreateParams`属性的类

```
private static IntPtr moduleHandle;

[DllImport("kernel32.dll", CharSet = CharSet.Auto)]
static extern IntPtr LoadLibrary(string lpFileName);

protected override CreateParams CreateParams
{
    get
    {
        if (moduleHandle == IntPtr.Zero)
        {
            moduleHandle = LoadLibrary("msftedit.dll");
            if ((long)moduleHandle < 0x20) throw new Win32Exception(Marshal.GetLastWin32Error(), "Could not load Msftedit.dll");
        }
        CreateParams createParams = base.CreateParams;
        createParams.ClassName = "RichEdit50W";
        if (this.Multiline)
        {
            if (((this.ScrollBars & RichTextBoxScrollBars.Horizontal) != RichTextBoxScrollBars.None) && !base.WordWrap)
            {
                createParams.Style |= 0x100000;
                if ((this.ScrollBars & ((RichTextBoxScrollBars)0x10)) != RichTextBoxScrollBars.None)
                {
                    createParams.Style |= 0x2000;
                }
            }
            if ((this.ScrollBars & RichTextBoxScrollBars.Vertical) != RichTextBoxScrollBars.None)
            {
                createParams.Style |= 0x200000;
                if ((this.ScrollBars & ((RichTextBoxScrollBars)0x10)) != RichTextBoxScrollBars.None)
                {
                    createParams.Style |= 0x2000;
                }
             }
        }
        if ((BorderStyle.FixedSingle == base.BorderStyle) && ((createParams.Style & 0x800000) != 0))
        {
            createParams.Style &= -8388609;
            createParams.ExStyle |= 0x200;
        }
        return createParams;
    }
} 
```

当我执行此覆盖时，我无法让我的 RTF 显示超过第一行。例如

```
string rtf = @"{\rtf1\ansi\deff0{\fonttbl{\f0 Arial;}{\f1 Courier New;}}\viewkind4\uc1\pard\lang1033\f0\fs20 {\pard\f0\ul\b Activated Partial Thromboplastin Time\b0 : Collected: "
                 + @"8/21/2012 4:15:00 AM\ulnon\f0\par}\par\pard\lang1033\f0\fs20 {\trowd"
                 + @"\trql\trgaph100\trrh280\trleft0\intbl"
                 + @"\cellx4000"
                 + @"\cellx9500"
                 + @"Activated Partial Thromboplastin Time\cell"
                 + @"36.8 Seconds\cell"
                 + @"\intbl\row}";
CustomRtb cRtb = new CustomRtb();
cRtb.Rtf = rtf;//Only the first line shows in the form... 
```

新标准是对 Rtf 错误的宽容度大大降低还是什么？我需要 5.0 提供的更漂亮的表格格式

**更新**
如果我改变数据会显示

`+ @"\trql\trgaph100\trrh280\trleft0\intbl"`

到

`+ @"\trql\trgaph100\trrh280\trleft0"`

* * *

经过进一步测试，我发现 RTF 在 MS Word 中看起来不错。事实上，我们的代码使用 MsftEdit 生成 RTF，如下所示：

`{\*\generator Msftedit 5.41.21.2510;}`. 我在 Word 中打开实际的 RTF，它看起来不错。我使用此代码，它与我在 word 中看到的非常匹配。我只需要删除一些边框。我将不得不做一些更深入的挖掘，以了解为什么 Msftedit 生成的 RTF 在表格中稍微不对齐。但是，是的，总的来说，这个问题超出了我在 SO 中可以做的范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T12:42:03.947

在代码中手工制作 RTF 并不是一件容易的事。您必须注意那些转义字符和空格也变得非常重要。

解决这个问题的最简单方法是对其进行逆向工程。打开 Microsoft Word，创建一个表格，将其格式化为您喜欢的格式，然后将其复制粘贴到您的 CustomRtb 控件中并查看它生成的结果 RTF 代码：

```
private string Sample() {
  StringBuilder sb = new StringBuilder();
  sb.Append(@"{\rtf1\ansi\deff0");
  sb.Append(@"{\fonttbl{\f0\fswiss\fprq2\fcharset0 Arial;}");
  sb.Append(@"{\f1\froman\fprq2\fcharset0 Times New Roman;}{\f2\fnil\fcharset0 Microsoft Sans Serif;}}");
  sb.Append(@"{\*\generator Msftedit 5.41.21.2510;}");
  sb.Append(@"\viewkind4\uc1\pard\sa200\sl276\slmult1\lang1033\ul\b\f0\fs20");
  sb.Append(@" Activated Partial Thromboplastin Time\b0 : Collected:8/21/2012 4:15:00 AM\par");
  sb.Append(@"\trowd\trgaph108\trleft-108\trbrdrl\brdrs\brdrw10 \trbrdrt\brdrs\brdrw10");
  sb.Append(@" \trbrdrr\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trpaddl108\trpaddr108\trpaddfl3\trpaddfr3");
  sb.Append(@"\clbrdrl\brdrw10\brdrs\clbrdrt\brdrw10\brdrs\clbrdrr\brdrw10\brdrs\clbrdrb\brdrw10\brdrs");
  sb.Append(@" \cellx4680\clbrdrl\brdrw10\brdrs\clbrdrt\brdrw10\brdrs\clbrdrr\brdrw10\brdrs\clbrdrb\brdrw10\brdrs");
  sb.Append(@" \cellx9468\pard\intbl\ulnone Actived Partial Thromboplastin Time");
  sb.Append(@" \cell\pard\intbl\qr 36.8 Seconds\cell\row\pard\sa200\sl276\slmult1\par");
  sb.Append(@"\pard\f2\fs17\par");
  sb.Append(@"}");

  return sb.ToString();
} 
```

如您所见，RTF 代码可能会变得很啰嗦。这创建了一行带有粗体和下划线的文本，然后是一个带有边框单元格的两列表格，第二个单元格右对齐。

# spring - Java Spring jaxb webServiceTemplate

> ID：12148744
> 
> 赞同：1
> 
> 时间：2012-08-27T19:59:00.230
> 
> 标签：spring, jaxb, unmarshalling

我的问题很简单。

对于解组，我想编写自定义解组器，但对于编组，我有 wsdl

我有以下方法返回解组对象，但我希望 xml 字符串与我的解组对象一起使用，请快速帮助。

```
Bean wsdlBean = (wsdlBean)webServiceTemplate.marshalSendAndReceive(results); 
```

我想要这样的东西

```
String xmlStr = webServiceTemplate.marshalSendAndReceive(results); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:20:17.793

您可以使用`WebServiceTemplate.sendSourceAndReceiveToResult(Source source, Result result)`- API 在[这里](http://static.springsource.org/spring-ws/site/apidocs/org/springframework/ws/client/core/WebServiceTemplate.html#sendSourceAndReceiveToResult%28javax.xml.transform.Source,%20javax.xml.transform.Result%29)；

只需将 Result 定义为 StringResult，将 Source 定义为 StringSource：

```
StringSource source = new StringSource(content);
StringResult result = new StringResult(new StringWriter());

wsTemplate.sendSourceAndReceiveToResult(source, result);

..result.getWriter().toString(); 
```

# c# - 检查 OleDb 表中是否存在列

> ID：12148745
> 
> 赞同：2
> 
> 时间：2012-08-27T19:59:16.183
> 
> 标签：c#, ms-access, oledb

我正在尝试检查列是否存在，如果不存在，请添加它。我已经尝试了几个解决方案，包括[这个](https://stackoverflow.com/questions/133031/how-to-check-if-column-exists-in-sql-server-table)，但是 Access db 的语法不正确。

这是我到目前为止所拥有的：

```
 public void Update(string task, string dbPath, string tableName = "Frames")
    {
        OleDbConnection db = new OleDbConnection("Provider=Microsoft.JET.OLEDB.4.0;data source=" + dbPath);
        db.Open();

        OleDbCommand command = db.CreateCommand();
        command.CommandText = "COL_LENGTH('Frames','SetNumber')";
        Debug.WriteLine(command.ExecuteReader());

        /*
        string[] restrictions = new string[] {null, null, tableName};

        DataTable dtColumns = db.GetOleDbSchemaTable(OleDbSchemaGuid.Columns, restrictions);

        foreach (DataColumn column in dtColumns.Columns)
        {
            Debug.WriteLine(column.ColumnName);
        }*/

    } 
```

我也尝试使用 GetOleDbSchemaTable 但它没有返回正确的表或其他东西。我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T20:08:37.070

要检查数据表中是否存在列，您可以使用 OleDbConnection 的 GetSchema 方法

```
public void Update(string task, string dbPath, string colName, string tableName = "Frames") 
{ 
    using(OleDbConnection db = new OleDbConnection("........"))
    {
        db.Open(); 
        var schema = db.GetSchema("COLUMNS"); 
        var col = schema.Select("TABLE_NAME='" + tableName + 
                   " AND COLUMN_NAME='" + colName + "'" 

        if(col.Length > 0)
           // Column exist
        else
           // Column doesn't exist
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T20:06:40.553

你的方法`GetOleDbSchemaTable`是要走的路。模式表的每一行都包含表中单个列的信息，模式表的每一列代表它的一个属性。因此，循环遍历模式表的行，而不是列！

```
foreach (DataRow row in dtColumns.Rows) { // <== dtColumns.Rows
                                          //     (NOT dtColumns.Columns)
    string columnName = (string)row["COLUMN_NAME"];
    ....
} 
```

您的方法会产生模式表本身的列名。

# perl - perl 比较文件以查找其中一个文件中缺少的行

> ID：12148749
> 
> 赞同：-1
> 
> 时间：2012-08-27T19:59:35.367
> 
> 标签：perl

```
/* format of the files:123|0|15454215|desc|11/30/2012|N|Y|
open FILE1, "/home/1.txt" or die $!;
open FILE2, "/home/2.txt" or die $!;

while (<FILE2>) {
  @old_item = split(/\|/);
  if (<FILE1> !~ /$old_item[0]\|$old_item[1]\|$old_item[2]/) {
    print "$old_item[0]|$old_item[1]|$old_item[2]|$old_item[3]|$old_item[4]|$old_item[5]|$old_item[6]|DE|\n";
  }
} 
```

我在这里做的是打开两个文件，然后比较它们以找到第一个而不是第二个的任何行，然后输出包含一些新旧信息的行。

但是发生的事情是，一旦它找到不在第二个文件中但在第一个文件中的行，它就会开始打印每一行。我做错了什么，有没有更简单的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T20:01:19.293

为什么不使用`diff -u`或一些这样的？如果您需要 Perl 解决方案，请查看[Algorithm::Diff](http://search.cpan.org/perldoc?Algorithm%3a%3aDiff)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:05:15.077

我认为发生的事情是，因为您正在逐行读取每个文件，所以额外的一行会导致所有行都关闭（因为其中一个文件将在其计数中提前一行，可以这么说）。如果您仍想为此编写自己的 perl 代码，则将文件加载到数组中并以这种方式进行比较可能会有所帮助，仅在需要时才增加索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-18T10:50:38.820

perl 中有一个用于比较两个文件的模块。

ALgorithm::Diff 模块，

Algorithm::Diff - 计算两个文件/列表之间的“智能”差异，它将逐行比较两个文件并对其进行全面检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T20:04:14.063

查看您的数据会很有用。但是做一个有根据的猜测..用调试器遍历这个，我想你会看到发生了什么，一旦你找到一个缺失的行，你就会跳到*两个*流的下一行输入。

现在，对于其余的输入，您遇到了一个不相上下的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-27T20:04:26.893

发生这种情况的原因是它发现了一条线不再同步的差异。

您将不得不添加一些代码来搜索匹配的行以重新同步文件阅读器。

# javascript - 防止 Jquery 中的二次点击操作

> ID：12148752
> 
> 赞同：1
> 
> 时间：2012-08-27T19:59:39.933
> 
> 标签：javascript, jquery

我有一个列表，列表中的每个项目都有一个 div。如果您单击列表项，我希望它执行某些操作（例如： alert("Clicked outside Div"); ），但我还希望在单击列表中的 div 时执行操作（例如：alert("Clicked在 div");.

但是，当我单击 div 时执行该操作时，它还会立即执行与单击列表项相关的操作。是否可以防止这种行为，以便仅显示在 Div 中单击？

```
<ul id="coll-selected-list" class="droptrue sort-drop">
       <li class="sortedli">
             <div class="sel-display-on" style="display: inline; float:left; width: 30px;">xx</div>
             Call Type
       </li>
</ul>

$('.sel-display-on').click(function () {
        alert("Clicked in Div");
    });
$('.sortedli').click(function () {
        alert("Clicked outside Div");
    }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-27T20:00:30.930

```
$('.sel-display-on').click(function (e) {
    e.stopPropagation();
    alert("Clicked in Div");
}); 
```

当您单击 div 时，您的单击事件会冒泡并触发列表项上的单击事件。用于[`e.stopPropagation();`](http://api.jquery.com/event.stopPropagation/)抵消这种行为。

**[jsFiddle 示例](http://jsfiddle.net/j08691/BDSJc/)**

# regex - 只有一位小数的正则表达式

> ID：12148753
> 
> 赞同：1
> 
> 时间：2012-08-27T19:59:41.277
> 
> 标签：regex, ipad, ios5

我想验证特定值的文本字符串：

1.  除小数外的所有数字。
2.  小数点不能是第一个或最后一个字符。
3.  它可以有任意位数，但只有一位小数。

我试图找到一个参考来描述下面的面具，因为它不符合我的需要。

```
NSString *myRegex = @"^\\d+(?:[:](?:[0-5]?\\d)|\\.\\d)$"; 
```

请引导我查看描述上述字符的文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:01:27.263

那是一个[正则表达式](http://www.regular-expressions.info/)。

怎么样：

```
NSString *myRegex = @"^\d+(\.\d+)?$"; 
```

您是否考虑过逗号、美元符号、负号或正号？如果允许，那么您可能应该尝试使用 iOS 库方法将字符串解析为数字。

# javascript - 创建多个实例时，jquery 小部件共享数据

> ID：12148764
> 
> 赞同：4
> 
> 时间：2012-08-27T20:00:21.440
> 
> 标签：javascript, jquery, jquery-plugins, widget

我创建了一个 jquery 小部件并且一切正常，直到我需要另一个实例。那时我注意到两个实例共享相同的数据。该插件应该跟踪在表中检查了哪些行，因此我不必每次需要使用它们时都计算它们。如果我在两个表上实例化小部件，请单击一个表上的一行 - 两个表将具有相同的数据。两个表都会发生这种情况。我只创建了几个 jquery 小部件，所以我不确定这是如何发生的，但我已经逐步完成了代码并且可以看到它正在发生。

好像我错误地使用了小部件工厂。提前感谢您的帮助！

这是小部件代码。

```
$.widget('ui.selectAndFilter', {
_init: function () {

},
_create: function () {
    var self = this;
    self.options.$mainTable = $(self.element).addClass(this.options.cssWidgetClass);

    self.options.$mainTable.find('tbody tr').bind('click', function (e) {
        self._onClick(e, $(this), false);
        //Need to determine what todo with last param - redrawTables
    });
},
options: {
    cssWidgetClass: 'select-and-filter',
    cssSelectedClass: 'selected',
    $mainTable: {},
    childTables: [],
    canMultiSelect: false,
    clickFinishedCallbacks: [],
    minCount: 1
},
destroy: function () {
    $(this.element).removeClass(this.options.cssWidgetClass);
},
_checkedIds: [],    
checkRow: function ($tr) {
    if ($.isDigit($tr))
        $tr = $(this.options.$mainTable.find('tbody tr:eq(' + $tr + ')'));
    if ($tr.length) {
        var id = $tr.addClass(this.options.cssSelectedClass).find(':checkbox').attr('checked', true).val();
        this._addId(id);
    }
    return this;
},
_uncheckRow: function ($tr) {
    if ($tr.length) {
        var id = $tr.removeClass(this.options.cssSelectedClass).find(':checkbox').attr('checked', false).val();
        return this._removeId(id);
    }
},
uncheckAllRows: function () {
    var self = this;
    this.options.$mainTable.find('tr.' + this.options.cssSelectedClass).each(function () {
        self._uncheckRow($(this));
    });
    return self;
},
_removeId: function (id) {
    this._checkedIds.splice(this._checkedIds.indexOf(id), 1);
    return this._checkedIds;
},
_addId: function (id) {
    if (this._checkedIds.indexOf(id) == -1)
        this._checkedIds.push(id);
    return this._checkedIds;
},
_onClick: function (event, $tr, redrawTables) {
    if ($tr.hasClass(this.options.cssSelectedClass) && this._checkedIds.length > this.options.minCount) {
        this._uncheckRow($tr);
    } else {
        if (!this.options.canMultiSelect) {
            this.uncheckAllRows();
        }
        this.checkRow($tr);
    }

    this.redrawTables();
    this._trigger('click');

},
redrawTables: function () {
    $.each(this.options.childTables, function () {
        this.fnDraw();
    });
},
checkedIds: function () {
    return this._checkedIds;
}

}); 
```

然后是实例化它们的代码。

```
tables['schedule'].selectAndFilter({canMultiSelect:selectMulti, childTables: redrawTables});
tables['start'].selectAndFilter({canMultiSelect: selectMulti})
tables['batch'].selectAndFilter({minCount:0}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T20:27:48.120

问题是 _checkedIds 数组对于小部件来说是全局的，而不是在单独的上下文中。

在 _create 方法中添加了这一行：

```
this._checkedIds = []; 
```

并从小部件中删除了这一行：

```
_checkedIds: [], 
```

# c++ - C++11 正则表达式匹配 - 我无法让它正常工作

> ID：12148767
> 
> 赞同：0
> 
> 时间：2012-08-27T20:00:29.030
> 
> 标签：c++, regex, c++11

```
bool match=0;
string pattern, domain="sub1.example.org";
while(res->next())
{
   pattern.append("(.+\\.)?");
   pattern.append(res->getString(1));
   std::regex RE(pattern);
   cout << pattern << "-" << domain << endl;
   pattern.clear();
   if((match=regex_match(domain, RE)))
      break;
} 
```

上面那个不匹配，尽管输出是这样的：

```
(.+\.)?example.org-sub1.example.org
(.+\.)?example.orgg-sub1.example.org
(.+\.)?sdasd.com-sub1.example.org 
```

我想我太困了或其他什么，有人可以帮帮我吗？

编辑：gcc 4.6.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:29:18.490

GNU libstdc++ 的实现`<regex>`不完整。请参阅[手册](http://gcc.gnu.org/onlinedocs/libstdc++/manual/status.html#status.iso.2011)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:21:14.520

看起来像是实现中的一个错误。我得到了相同的结果，但是如果我删除了“？” 从它匹配的正则表达式。当后者成功时，我想不出任何理由说“其中的 0 或 1”而不是“其中的 1”会失败。

# c# - 使用容器类时出错

> ID：12148769
> 
> 赞同：0
> 
> 时间：2012-08-27T20:00:37.680
> 
> 标签：c#, class

使用容器的类在 AmountList 和 PGRow 上抛出一个错误，上面写着`AmountList is inaccessible due to its protection level`

编码

```
public virtual ActionResult getAjaxPGs(string SP = null, string PG = null)
{

    if (SP != null)
    {

        Container container = new Container();
        var PGList = from x in db.PG_mapping
                     where x.PG_SUB_PROGRAM == SP 
                     select x;

        container.PARow = PGList.Select(x => new { x.PG }).Distinct().ToArray();

       container.AmountList = from x in db.Spend_Web
                        where x.PG == PG
                        group x by new { x.ACCOUNTING_PERIOD, x.PG, x.Amount } into pggroup
                        select new { accounting_period = pggroup.Key.ACCOUNTING_PERIOD, amount = pggroup.Sum(x => x.Amount) };

      return Json(container, JsonRequestBehavior.AllowGet);
    }

    return View();
}

public class Container
{
    Array PARow;
    Array AmountList;

} 
```

我尝试将课程公开，我是否必须做其他事情才能使课程可以访问`getAjaxPGs`？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:03:27.320

默认情况下，[类成员是`private`](http://msdn.microsoft.com/en-us/library/ba0a1yw2.aspx)- 只有类本身可以访问。

如果您想从类外部访问它们（或者`internal`如果需要访问的代码只存在于同一个程序集中），则需要将它们声明为公共的。

```
public class Container
{
    public Array PARow;
    public Array AmountList;
} 
```

注意：以上（对字段的公共访问）被认为是不好的做法 - 您应该为此使用属性。

```
public class Container
{
    public Array PARow {get; set;}
    public Array AmountList {get; set;}
} 
```

# r - 在使用 xtable() 生成的表中将负数的颜色更改为红色？

> ID：12148770
> 
> 赞同：17
> 
> 时间：2012-08-27T20:00:43.257
> 
> 标签：r, knitr, xtable

我正在用 knitr 用 R 写报告。我正在使用 xtable() 在报告中生成表格。我的一张表包括负数和正数。我想将负数的颜色更改为红色。我怎样才能做到这一点？显然，一个简单的解决方案是更改 xtable 生成的乳胶代码，但请注意，我有一个自动报告，数字可以随新数据集而改变，我不想手动设置颜色。

这是一个简单的代码：

```
\documentclass{article}
\begin{document}
<<simpleExamp, results=tex, echo=FALSE>>=
library(knitr)
library(xtable)
testMatrix <- matrix(c(sample(-10:10,10)), ncol = 2)
xtable(testMatrix)
@
\end{document} 
```

如何使负数变为红色？感谢您的帮助。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-27T20:16:12.010

您可以使用`capture.output()`来捕获由（隐式）调用打印的行`print.xtable()`。然后应用`gsub()`到输出，使用围绕每个负数的模式和替换`\textcolor{red}{}`。最后，使用`cat()`with`sep="\n"`将修改后的行写入`*.tex`文件。

```
\documentclass{article}
\begin{document}
<<simpleExamp, results="asis", echo=FALSE>>=
library(knitr)
library(xtable)
testMatrix <- matrix(c(sample(-10:10,10)), ncol = 2)
## I added the following three lines
xt <- capture.output(xtable(testMatrix))
xt_mod <- gsub("(\\s|^)(-\\d*)", "\\1\\\\textcolor{red}{\\2}", xt)
cat(xt_mod, sep="\n")
@
\end{document} 
```

（另请注意，我替换为`results=tex`knitr **'**更喜欢'并且它将更快地处理。）`results="asis"`

 *** * *

**编辑：**添加结果表的图像。（以 SO 就绪的形式获取它需要对代码进行一些调整，这也包括在下面。）

![在此处输入图像描述](../Images/585a266088cd64fc5e9271b4c05211ff.png)

```
\documentclass{standalone}
\renewenvironment{table}{}{}% Ignore `table` environment in standalone mode.
\begin{document}
<<simpleExamp, results="asis", echo=FALSE>>=
library(knitr)
library(xtable)
cat("\\Huge\n\n")
testMatrix <- matrix(c(sample(-10:10,10)), ncol = 2)
## I added the following three lines
xt <- capture.output(print.xtable(xtable(testMatrix), table.placement=NULL))
xt_mod <- gsub("(\\s|^)(-\\d*)", "\\1\\\\textcolor{red}{\\2}", xt)
cat(xt_mod, sep="\n")
@
\end{document} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-30T14:40:48.653

复制 Josh O'Brien 的答案，稍作调整以用小数为表格着色：

```
\documentclass{article}
\begin{document}
<<simpleExamp, results="asis", echo=FALSE>>=
library(knitr)
library(xtable)
testMatrix <- matrix(c(sample(-10:10,10)), ncol = 2)*1.1
## I added the following three lines
xt <- capture.output(xtable(testMatrix))
xt_mod <- gsub("(\\s|^)(-\\d\\.\\d*)", "\\1\\\\textcolor{red}{\\2}", xt)
cat(xt_mod, sep="\n")
@
\end{document} 
```**

# java - Java TelnetClient InputStream 打开后关闭

> ID：12148771
> 
> 赞同：1
> 
> 时间：2012-08-27T20:00:57.810
> 
> 标签：java, inputstream, telnet

我正在使用 Apache Commons TelnetClient 为某些交换机创建自动 telnet 接口。如果我直接从机器远程登录到交换机，连接似乎永远不会超时。随机地，在 Java 程序中，连接似乎与 InputStream 一起立即关闭。我试图建立一个检查连接失败并尝试再次建立连接，但如果它第一次失败，它总是失败。

```
import org.apache.commons.net.telnet.TelnetClient;

  public String connect()
  {
     String errorMessage = null;
     tcConnectionHandle = new TelnetClient();
     tcConnectionHandle.setDefaultTimeout(iTimeOutMilliseconds);

     try
     {
        tcConnectionHandle.connect(strConnectionIP, intConnectionPort);
        osOutput = tcConnectionHandle.getOutputStream();
        isInput = tcConnectionHandle.getInputStream();
        int availableBytes = isInput.available();

        while(availableBytes <= 0)
        {
           tcConnectionHandle = null;
           isInput = null;
           osOutput = null;
           Thread.sleep(500);
           tcConnectionHandle = new TelnetClient();
           Thread.sleep(500);
           tcConnectionHandle.setDefaultTimeout(iTimeOutMilliseconds);
           Thread.sleep(500);
           tcConnectionHandle.connect(strConnectionIP, intConnectionPort);
           Thread.sleep(500);
           osOutput = tcConnectionHandle.getOutputStream();
           Thread.sleep(500);
           isInput = tcConnectionHandle.getInputStream();
           Thread.sleep(500);
           availableBytes = isInput.available();
           System.out.println("reopened: " + availableBytes);
        }
     }
     catch(InterruptedException iX)
     {
        errorMessage = "Could not establish connection. " + iX.getLocalizedMessage();
     }
     catch(SocketException sX)
     {
        errorMessage = sX.getMessage();
     }
     catch(IOException ioX)
     {
        errorMessage = ioX.getMessage();
     }

     return errorMessage;
  } 
```

如果我忽略`Thread.sleep(500)`它，它将永远不会有任何可用字节。暂停时，结果为 20，但是，如果我尝试使用`isInput.read()`它将返回 -1，这意味着 InputStream 已关闭。

我正在寻找一种方法来捕获连接失败并再次尝试连接。它发生得太频繁以至于不能再试一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T13:47:50.317

我认为附加到 TelnetClient 的 InputStream 随机处于关闭状态。即使我创建了一个新的 TelnetClient 对象并稍后重新连接到同一个 Telnet 服务器，在该状态下任何读取它的尝试都会导致通信失败。这没有任何意义，但我决定尝试一种新方法，而不是弄清楚 TelnetClient 类中发生了什么。

我通过使用`implements TelnetInputListener`这个类解决了这个问题。InputStream 在被调用时偶尔为空`telnetInputAvailable()`，但我现在可以通过对函数的特定调用不做任何事情来从中恢复。

```
public String connect()
{
   String errorMessage = null;
   tcConnectionHandle = new TelnetClient();
   tcConnectionHandle.setDefaultTimeout(iTimeOutMilliseconds);
   tcConnectionHandle.registerInputListener(this);

   try
   {
      tcConnectionHandle.connect(strConnectionIP, intConnectionPort);
      osOutput = tcConnectionHandle.getOutputStream();
      isInput = tcConnectionHandle.getInputStream();
   }
   catch(SocketException sX)
   {
      errorMessage = sX.getMessage();
   }
   catch(IOException ioX)
   {
      errorMessage = ioX.getMessage();
   }

   return errorMessage;
}

public Matcher waitForRegularExpression(String regularExpression)
{
   Matcher matcher;
   Pattern pattern = Pattern.compile("(?s)" + regularExpression);
   StringBuilder warningLog = new StringBuilder();

   synchronized(sbInputBuffer)
   {
      matcher = pattern.matcher(sbInputBuffer.toString());

      while(!matcher.find())
      {
         try
         {
            int inputBufferSize = sbInputBuffer.length();
            sbInputBuffer.wait(iTimeOutMilliseconds);

            if(inputBufferSize == sbInputBuffer.length())
            {
               warningLog.append("Did not find pattern and no new input.");
               logWarning(warningLog.toString());
               return null;
            }
         }
         catch(InterruptedException intX)
         {
            warningLog.append("Interrupted waiting on input. ").append(intX.getLocalizedMessage());
         }

         matcher = pattern.matcher(sbInputBuffer.toString());
      }

      sbInputBuffer.delete(0, matcher.end()-1);
   }

   if(!warningLog.toString().isEmpty())
   {
      logWarning(warningLog.toString());
   }

   return matcher;
}

@Override
public void telnetInputAvailable()
{
   synchronized(sbInputBuffer)
   {
      StringBuilder warningLog = new StringBuilder();
      int readBytes = -2;

      if(isInput != null)
      {
         try
         {
            readBytes = isInput.read();

            if(readBytes > 0)
            {
               sbInputBuffer.append((char)readBytes);
            }

            sbInputBuffer.notify();
         }
         catch(IOException ioX)
         {
            warningLog.append("Failed for IO: ").append(ioX.getLocalizedMessage()).append(" - input so far: ")
               .append(sbInputBuffer.toString()).append("\nRead bytes: ").append(readBytes).append("\n");
            logWarning(warningLog.toString());
         }
      }
   }
} 
```

# jquery - 用于淡入/淡出 div 背景的 jQuery 替代方案

> ID：12148772
> 
> 赞同：1
> 
> 时间：2012-08-27T20:01:12.133
> 
> 标签：jquery, html, css, transition

以下代码有 2 个单独`<div>`的元素，每个元素内部都有一个图像。当我将鼠标悬停在任一 div 上时，背景颜色会淡入然后淡出 - 完美！！

我有这个网页在 Firefox 中运行良好，但是它在 IE 中无法发挥作用，所以我想知道是否有实现相同功能的 jQuery 版本？

**如果有帮助，这是一个 jsfiddle：http: [//jsfiddle.net/mcgarriers/NJe63/](http://jsfiddle.net/mcgarriers/NJe63/)**

```
<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title></title>

    <style type="text/css">
    .box, .box2 {
        float:left;
        width:200px;
        height:200px;
        background:blue;
        -webkit-transition: background 1s;
    }
    .box:hover {
        background:red;
        transition: background 1s;;
        -moz-transition: background 1s;; /* Firefox 4 */
        -webkit-transition: background 1s;; /* Safari and Chrome */
        -o-transition: background 1s;; /* Opera */
    }
    .box2:hover {
        background:black
    }
    </style>

</head>
<body>

    <div class="box">
        <img src="http://www.internetlearningsociety.com/images/logos/google_logo3.jpg" />
    </div>

    <div class="box2">
        <img src="http://www.internetlearningsociety.com/images/logos/google_logo3.jpg" />
    </div>

</body>

</html> 
```

jQuery有没有一种简单的方法来复制我试图用上面做的事情？

非常感谢您的任何指点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:19:21.260

如果您使用 jQuery UI，您可以使用[animate来完成此操作](http://jqueryui.com/demos/animate/)

```
$('.box').mouseenter(function(){
  $(this).stop().animate({ backgroundColor: "red" }, 1000);
}).mouseleave(function(){
    $(this).stop().animate({ backgroundColor: "blue" }, 1000);
});

$('.box2').mouseenter(function(){
  $(this).stop().animate({ backgroundColor: "black" }, 1000);
}).mouseleave(function(){
    $(this).stop().animate({ backgroundColor: "blue" }, 1000);
});; 
```

[http://jsfiddle.net/NJe63/1/](http://jsfiddle.net/NJe63/1/)

**编辑：**

​只需添加`.children('img').hide()` `.children('img')show()`到末尾

```
$('.box').mouseenter(function(){
  $(this).stop().animate({ backgroundColor: "red" }, 1000).children('img').show();
}).mouseleave(function(){
    $(this).stop().animate({ backgroundColor: "blue" }, 1000).children('img').hide();
});

$('.box2').mouseenter(function(){
  $(this).stop().animate({ backgroundColor: "black" }, 1000).children('img').show();
}).mouseleave(function(){
    $(this).stop().animate({ backgroundColor: "blue" }, 1000).children('img').hide();
});; 
```

[http://jsfiddle.net/NJe63/2/](http://jsfiddle.net/NJe63/2/)

您可以对图像使用淡入淡出

```
$('.box').mouseenter(function() {
    $(this).children('img').stop(true,true).fadeIn(1000);
}).mouseleave(function() {
    $(this).children('img').stop(true,true).fadeOut(1000);
});

$('.box2').mouseenter(function() {
    $(this).children('img').stop(true,true).fadeIn(1000);

}).mouseleave(function() {
    $(this).children('img').stop(true,true).fadeOut(1000);
}); 
```

[http://jsfiddle.net/NJe63/3/](http://jsfiddle.net/NJe63/3/)

您可以使用 opacity 淡入和淡出图像。但由于 google 徽标作为子元素在内部，它会随之淡入/淡出。

[http://jsfiddle.net/NJe63/5/](http://jsfiddle.net/NJe63/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:03:59.193

除了 css3 之外，不能淡入或淡出背景图像，这在 oldIE 中不受支持。唯一的解决方法是将图像放在透明 div 后面并淡入和淡出这些图像（或具有图像背景的 div）。

# python - 从配置文件中读取 IP 地址不起作用

> ID：12148773
> 
> 赞同：-1
> 
> 时间：2012-08-27T20:01:15.813
> 
> 标签：python, ftp

我是 Python 的新手，正在尝试从配置文件 params.ini 中读取 IP 和登录信息。ini文件的内容是：

```
[Login]
FtpIP = 1.1.x.x
UID = anonymous
PWD = r@ee.com

[Directory]
Upload Directory = /
Home Directory = C:/Users/MyDocuments/Python/FilesUpload/** 
```

我写的代码是：

```
import ftplib
import configparser

config = configparser.ConfigParser()
config.sections()

config.read('params.ini')

ftp = ftplib.FTP()
TargetIP = config.get('Login','FtpIP')
print (TargetIP)
ftp.connect(TargetIP) 
```

我收到此错误：

```
socket.error: [Errno 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond* 
```

如果我直接在代码中输入 IP，那么它就可以工作。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T06:28:42.240

你能试试这个

```
try:
   ftp = ftplib.FTP(config.get('Login','FtpIP'))
   ftp.login(config.get('Login','UID'), config.get('Login','PWD'))
except ftplib.all_errors, e:
   print str(e) 
```

# ruby-on-rails - 将布尔参数传递给rails控制器？

> ID：12148774
> 
> 赞同：4
> 
> 时间：2012-08-27T20:01:17.327
> 
> 标签：ruby-on-rails, controller, parameter-passing

我有一个带有名为 :published 的布尔值的 post 对象。控制器中 index 的定义如下所示：

```
def index
  @posts = Post.all

  respond_to do |format|
    format.html # index.html.erb
    format.json { render json: @posts }
  end
end 
```

这链接到该页面：

```
<%= link_to 'All posts', posts_path %> 
```

假设我想要只显示 post.published 的帖子的选项？是真的。

*   我是否应该在控制器中使用单独的方法来处理仅显示 :published 帖子的情况？
*   我可以更改索引方法来处理传递给它的参数吗？
*   link_to 会是什么样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:05:09.577

理论上，对于按关键字/类别过滤结果，可以通过参数在同一个控制器中显示逻辑。我会这样：

```
<%= link_to 'All posts', posts_path(:published => true) %> 
```

然后在您的控制器/索引操作中：

```
def index
  @posts = Post.all
  @posts = @posts.where(:published => true) if params[:published].present?
  ... 
```

为了重构您的代码，我将在模型中限定方法，例如：

```
scope :published, where(:published => true) 
```

然后在您的控制器中，您可以拥有：

```
@posts = @posts.published if params[:published].present? 
```

有关链接/模型范围的更多信息：http: [//guides.rubyonrails.org/active_record_querying.html#scopes](http://guides.rubyonrails.org/active_record_querying.html#scopes)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:47:38.487

To keep it really simple (no scopes), just do the following

```
def index
  @posts = if params[:published].present?
    Post.where(:published => true)
  else
    Post.all
  end
... 
```

And then to add the link with params do

```
%= link_to 'Published Posts', posts_path(:published => true) %> 
```

# jquery - Rails 应用程序中的 jQuery 不会读取包含空格的值。我如何让它解释这些值？

> ID：12148778
> 
> 赞同：1
> 
> 时间：2012-08-27T20:01:37.280
> 
> 标签：jquery, ruby-on-rails

我正在尝试使用 jQuery 自动更新我的 Rails 应用程序中的相关选择框。它适用于没有像“Barahona”或“Manzanillo”这样的空格的值，但是当我尝试像“Puerto Plata”或“Santo Domingo”这样的东西时它会失败。

这是我选择“Puerto Plata”时来自控制台的错误。

```
Uncaught Error: Syntax error, unrecognized expression: optgroup[label=Puerto Plata] 
```

我正在使用从 Railscasts #88 采用并在此处列出的 jQuery 来选择一个端口，然后过滤泊位以仅列出来自该端口的泊位。

这是jQuery：

```
jQuery ->
  berths = $('#voyage_berth_id').html()
  console.log(berths)
  $('#voyage_port_id').change ->
    port = $('#voyage_port_id :selected').text()
    options = $(berths).filter("optgroup[label=#{port}]").html()
    console.log(options)
    if options
      $('#voyage_berth_id').html(options)
      $('#voyage_berth_id').parent().show()
    else
      $('#voyage_berth_id').empty()
      $('#voyage_berth_id').parent().hide() 
```

这是视图：

```
 <%= f.label :port_id %>
  <%= f.collection_select :port_id, Port.order(:name), :id, :name  %>
  <%= f.label :berth_id %>
  <%# f.collection_select :berth_id, Berth.order(:name), :id, :name  %>
  <%= f.grouped_collection_select :berth_id, Port.order(:name), :berths, :name, :id, :name  %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:33:51.353

您可能希望在带有空格的标签周围使用单引号。所以你的表情会变成这样。

```
options = $(berths).filter("optgroup[label='#{port}']").html() 
```

# google-maps-api-3 - 谷歌地图多个信息窗口不起作用

> ID：12148783
> 
> 赞同：1
> 
> 时间：2012-08-27T20:02:20.773
> 
> 标签：google-maps-api-3, google-maps-markers, infowindow

我尝试使用 javascript 将多个标记和信息窗口添加到谷歌地图。下面是代码：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Google Maps Multiple Markers</title>
<script
    src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script src="http://maps.google.com/maps/api/js?sensor=false"
    type="text/javascript"></script>
</head>
<body>
    <div id="map" style="width: 500px; height: 400px;"></div>
    <script type="text/javascript">
        var locations = [ '1961 East Mall Vancouver BC',
                '2366 Main Mall Vancouver BC', '2053 Main Mall, Vancouver, BC ' ];

        var map = new google.maps.Map(document.getElementById('map'), {
            zoom : 14,
            center : new google.maps.LatLng(49.26526, -123.250541),
            mapTypeId : google.maps.MapTypeId.ROADMAP
        });

        var infowindow = new google.maps.InfoWindow();

        var marker, i;

        for (i = 0; i < locations.length; i++) {

            var geocoder = new google.maps.Geocoder();
            geocoder
                    .geocode(
                            {
                                'address' : locations[i]
                            },
                            function(results, status) {
                                if (status == google.maps.GeocoderStatus.OK) {
                                    map.setCenter(results[0].geometry.location);
                                    marker = new google.maps.Marker({
                                        map : map,
                                        position : results[0].geometry.location
                                    });
                                } else {
                                    alert('Geocode was not successful for the following reason: '
                                            + status);
                                }
                            });

            //add info window
            google.maps.event.addListener(marker, 'click',
                    (function(marker, i) {
                        return function() {
                            infowindow.setContent(locations[i]);
                            infowindow.open(map, marker);
                        }
                    })(marker, i));
            //end of adding info window

        }//end of for loop
    </script>
</body>
</html> 
```

（感谢[Google Maps JS API v3 - 简单的多标记示例](https://stackoverflow.com/questions/3059044/google-maps-js-api-v3-simple-multiple-marker-example)）

问题是：除非我评论

```
 //add info window
            google.maps.event.addListener(marker, 'click',
                    (function(marker, i) {
                        return function() {
                            infowindow.setContent(locations[i]);
                            infowindow.open(map, marker);
                        }
                    })(marker, i));
            //end of adding info window 
```

单击时，我只会得到一个没有信息窗口弹出窗口的标记。

如果我在代码块上方发表评论，我会得到三个标记，但也不会弹出信息窗口。

我在哪里犯错了？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:27:57.697

地理编码器是异步的，您需要在地理编码器回调中添加信息窗口。当前，它在定义任何标记之前运行。我想你会得到一个javascript错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T23:43:46.893

这有效：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Google Maps Multiple Markers</title>
<script
    src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script src="http://maps.google.com/maps/api/js?sensor=false"
    type="text/javascript"></script>
</head>
<body>
    <div id="map" style="width: 500px; height: 400px;"></div>
    <script type="text/javascript">
        var locations = [ '1961 East Mall Vancouver BC',
                '2366 Main Mall Vancouver BC', '2053 Main Mall, Vancouver, BC ' ];
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom : 14,
            center : new google.maps.LatLng(49.26526, -123.250541),
            mapTypeId : google.maps.MapTypeId.ROADMAP
        });
        var infowindow = new google.maps.InfoWindow();
        var marker;
        var i;

        $(document).ready(function() {
            initialize();
        });

        function initialize(){
            setMarkers(map,locations);
        }

        function setMarkers(map, address) {
            for ( var i = 0; i < address.length; i++) {
                setMarker(map, address[i])
            }
        }

        function setMarker(map, address) {
            geocoder = new google.maps.Geocoder();
            geocoder
                    .geocode(
                            {
                                'address' : address
                            },
                            function(results, status) {
                                if (status == google.maps.GeocoderStatus.OK) {
                                    map.setCenter(results[0].geometry.location);
                                    var marker = new google.maps.Marker(
                                            {
                                                position : results[0].geometry.location,
                                                map : map
                                            });
                                    google.maps.event.addListener(marker,
                                            "click", function() {
                                                infowindow.setContent(address);
                                                infowindow.open(map, marker);
                                            });
                                } else {
                                    alert("Geocode was not successful for the following reason: "
                                            + status);
                                }

                            });
        }
    </script>
</body>
</html> 
```

感谢[谷歌地图多个信息窗口不起作用](https://stackoverflow.com/questions/12148783/google-map-multiple-inforwindow-does-not-work)

# ruby - 使用正则表达式在第一个逗号之前提取文本

> ID：12148784
> 
> 赞同：43
> 
> 时间：2012-08-27T20:02:25.310
> 
> 标签：ruby, regex

我想从以下字符串中提取第一个逗号（名字和姓氏）之前的文本：

```
John Smith, RN, BSN, MS
Thom Nev, MD
Foo Bar, MD,RN 
```

我尝试使用正则表达式：

```
(.*)\s(.*),\s 
```

但这并不适用于所有情况。如何做到这一点？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-08-27T20:04:54.123

匹配从字符串开头到第一个逗号的所有内容：

```
^(.+?), 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-08-27T20:07:53.727

怎么样：`yourString.split(",")[0]`

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2018-04-17T23:54:19.303

```
^([^,])+ 
```

这个正则表达式在 Sublime 中为我工作。它选择了第一个逗号之前的所有内容。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-08-27T20:04:27.960

以下情况如何：

```
[^,]* 
```

`[^,]*`意思是“匹配任意数量的非逗号字符”，我认为这正是你在这里想要做的。您可能希望将其锚定到字符串 iwth 的开头`^`，如下所示：

```
^[^,]* 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-08-27T20:10:38.000

您必须使用非贪婪的正则表达式运算符，尝试：`(.+?),`而不是：`(.+),`。请注意，当使用贪婪运算符时，您将匹配最后一个逗号之前的所有内容，而不是第一个。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-10-17T09:31:48.423

```
^[a-zA-Z0-9]+ 
```

..使用这个...这是获得第一个逗号分隔值的正确答案

# ruby-on-rails-3 - Rails Find_by_id 引发异常

> ID：12148785
> 
> 赞同：2
> 
> 时间：2012-08-27T20:02:31.033
> 
> 标签：ruby-on-rails-3, exception, activerecord, impressions

我被引导相信 Object.find 和 Object.find_by_id 之间的区别在于 find 会引发**RecordNotFound**异常，而 find_by_id 如果什么也没找到，则简单地返回 nil 。

但是，在我的 Rails 3 应用程序中，如果我尝试使用伪造的 id 搜索我的 Uploads 模型，我会得到：

> **在 UploadsController#show 中的 ActiveRecord::RecordNotFound**
> 
> 找不到 id=59 的上传
> 
> **要求**
> 
> **参数：**
> 
> {"id"=>"59"}

这是搞砸的代码行：

```
@upload = Upload.find_by_id(params[:id]) 
```

我正在使用 Rails 3.1.3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:14:29.563

要抛出 404 错误，它需要是

```
Upload.find_by_id!(params[:id]) 
```

感叹号是魔法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:22:47.733

事实证明，这是我正在使用的[印象派 gem](https://github.com/charlotte-ruby/impressionist)的一个问题，因为它被挂接到了我的 Upload show 操作中，并在我有机会处理它之前尝试执行它自己的查找。

# ios - 如何避免 3rd 方框架之间的重复符号

> ID：12148787
> 
> 赞同：7
> 
> 时间：2012-08-27T20:02:34.467
> 
> 标签：ios, frameworks, llvm

我有点进退两难。我在我的项目中添加了 2 个框架，所以碰巧两者都使用 JSONKit。所以当我编译我的项目时，我会在这两个框架之间得到重复的符号。

我必须将 -ObjC -all_load 添加到我的构建设置中，否则由于某些类别未编译，我会遇到运行时错误（崩溃）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T19:13:14.993

当您链接静态库时，链接器会将所有符号嵌入到您的最终二进制文件中。（这就是为什么它被命名为*static*。）实际上没有很好的方法来去除特定的符号，因为源符号和新嵌入的符号之间没有区别。即使您可以剥离重复的符号，也没有人可以确定重复的符号是相同的版本。如果一个库使用了修改版本的`JSONKit`库，当你用其他版本替换它时，它会被破坏。

唯一的方法是获取`.a`没有重复符号的文件或获取源并自己编译它们。如果库制造者不是白痴，他们应该提供一些没有嵌入符号的库版本。如果没有这样的东西，我强烈建议不要使用那个库。因为它不关心符号冲突，这意味着它是由真正的新手制作的，这意味着它充满了问题。

# quartz-2d - 10.8 CGRegisterScreenRefreshCallback 的替换

> ID：12148790
> 
> 赞同：1
> 
> 时间：2012-08-27T20:02:59.210
> 
> 标签：quartz-2d

Apple 在使弃用易于遵守方面做得很糟糕，因为大约 90% 的时间他们在文档中没有提供替代建议（最常用的 API 除外）。

10.8 弃用了大量 Quartz Display api，包括 CGRegisterScreenRefreshCallback。有谁知道我们现在应该使用什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:38:16.660

Apple says CGDisplayStream, not that there's any documentation to that effect (or any documentation for Display Stream, for that matter).

# c++ - 显示控制台和 win32 GUI

> ID：12148791
> 
> 赞同：2
> 
> 时间：2012-08-27T20:02:59.353
> 
> 标签：c++, user-interface, console

我正在使用 MinGW 处理代码块，并且我有一个已经从事了一段时间的编码项目。我一直在使用的项目是控制台应用程序，而我的调试功能依赖于打印到控制台。

但是，最近，我尝试实现 windows 'GetOpenFileName()' 函数来拉出一个打开的文件框，这样用户打开文件会容易得多。但是，当在包含头文件的控制台应用程序中使用项目时，MinGW 编译器就像找不到函数一样。但是我发现将项目更改为 win32 GUI 允许编译器找到该函数（我不完全理解为什么，但这只是我）。

问题是这样的：我试图将调试信息输出到控制台，但当然现在应用程序是 win32 GUI，控制台不显示，因此我看不到调试信息，我无法将其切换回控制台应用程序否则 Windows 打开文件框代码将无法编译。如何既显示控制台又允许项目正确编译 Windows GUI 代码？

我无法更改调试功能或使用不同的调试功能，因为它们被写入所有类以帮助回溯错误，并且至少有 43 个文件，其中大多数使用调试功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T22:03:34.757

因此问题似乎不是由项目类型引起的，而是由设置/编译器选项引起的。编译器可以很好地找到函数声明，但链接器现在抱怨，因为它找不到定义。

为了解决这个问题，您需要链接到正确的库（如 MSDN 文档中所述，它是`comdlg32.lib`）。

* * *

在 CodeBlocks 中，您可以通过以下方式执行此操作：

1.  转到**项目**菜单并单击**构建选项**。
2.  单击**链接器设置**选项卡。
3.  单击**添加**。
4.  键入**comdlg32**并按 OK。
5.  单击确定保存更改并退出。

现在，您的项目将在构建时链接到该库。如果您希望所有程序（项目与否）链接到该库，您可以将步骤 1 替换为以下步骤：

1.  转到**Settings**菜单并单击**Compiler and Debugger**。

其余的从那里开始是一样的，但在全球范围内。

* * *

对于它的价值，如果您使用原始命令行构建，您可以添加`-lcomdlg32`选项以产生相同的效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:07:52.267

用于[`AllocConsole`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681944%28v=vs.85%29.aspx)在 GUI 应用程序中创建控制台。

# javascript - D3 气泡图

> ID：12148794
> 
> 赞同：6
> 
> 时间：2012-08-27T20:03:18.073
> 
> 标签：javascript, json, charts, d3.js

我是 D3 的新手，除非我使用确切的示例数据，否则我很难使用气泡图：

*   [https://github.com/mbostock/d3/blob/master/examples/bubble/bubble.js](https://github.com/mbostock/d3/blob/master/examples/bubble/bubble.js)
*   [https://github.com/mbostock/d3/blob/master/examples/data/flare.json](https://github.com/mbostock/d3/blob/master/examples/data/flare.json)

具体来说，我遇到了麻烦

```
.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; }); 
```

我无法运行让这部分代码与其他示例一起使用。

这是我正在使用的 JSON 数据的一个子集：

```
{
"name": 301,
"children": [
    {
        "resourceid": "11",
        "creator_uid": "301",
        "owner": "Tom",
        "name": "Omega",
        "created_time": "2012-03-07 20:07:11",
        "items": "4"
    },
    {
        "resourceid": "188",
        "creator_uid": "301",
        "owner": "Tom",
        "name": "Nexus",
        "created_time": "2012-03-31 00:04:56",
        "items": "14"
    }
  ]
} 
```

我可以将半径设置为“项目”，但我希望

```
.data(bubble.nodes(json) 
```

分发节点，但我收到 dx 为 NULL 的错误。鉴于气泡示例的示例数据，我不确定气泡示例如何创建 dx 和 dy

有人可以详细解释一下吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-28T12:28:42.963

使用气泡图时，数据必须展平。在您链接的示例中，调用了一个名为“类”的函数，对于每个节点，该函数将类作为新对象返回，其`value`属性包含大小。（您上面的代码建议您省略了此调用）。

稍后，对该函数的调用`bubble.nodes`使用`value`由 classes 函数创建的每个对象的属性（被推送到单个数组中）来计算 x 和 y（这又在 transform 函数中使用）。有关 pack 功能的更多信息，请参阅[d3 文档](https://github.com/mbostock/d3/wiki/API-Reference#pack)。同样`nodes`的函数还计算`r`稍后使用的半径（as）。

正是这种调用`nodes`决定了气泡图的完整布局。示例中的其余代码都是关于在函数计算的结果指定的位置构造必要的 SVG 元素，例如圆和文本`nodes`。

所以不能直接把json数据传给bubble.nodes函数，除非满足特定要求（比如有`value`属性）。

[这](http://jsfiddle.net/xsafy/)是 jsfiddle.net 上的一个工作示例。

# asp.net-mvc - Visual Studio - 无法解析此引用

> ID：12148797
> 
> 赞同：0
> 
> 时间：2012-08-27T20:03:27.500
> 
> 标签：asp.net-mvc, visual-studio-2012

我在笔记本电脑上的 Visual Studio 2012 中创建了一个 ASP.NET MVC 项目，在没有问题的情况下对其进行了一些工作，然后将其签入源代码管理。我已经在我的主桌面机器（一个全新的 Git 克隆）上检查了它，它不会编译，说明缺少各种引用（其中一个是 entityframework.dll）。回顾我的笔记本电脑，这些 DLL 位于我项目的“bin”文件夹中（出于明显的原因，我没有将其添加到源代码管理中）。在我的笔记本电脑上，如果我重命名我的 bin 文件夹，我会得到相同的编译错误。我不提交我的 bin 文件夹中的某些 DLL 文件是否不正确？当然，这些 DLL 应该在编译时复制到 bin 目录中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:10:43.057

您应该查看库引用在项目文件中的存储位置。如果项目引用了 bin 目录中的副本，那么您的项目设置不正确。

您应该在源代码控制树中维护一个库目录，该目录与任何其他依赖项一样签入。

bin 目录应该只输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:06:58.723

桌面可能找不到要从中复制的文件夹。

您应该使用 NuGet 添加引用（如果您还没有），并将包文件夹包含在源代码管理中。（或启用包还原）

# c# - 使用 FastActivator 代替 Activator.CreateInstance()

> ID：12148799
> 
> 赞同：0
> 
> 时间：2012-08-27T20:03:51.757
> 
> 标签：c#, reflection, instantiation, reflection.emit

尝试使用此处显示的类作为 Activator.CreateInstance() [http://codeblocks.codeplex.com/wikipage?title=FasterActivator%20Sample的示例](http://codeblocks.codeplex.com/wikipage?title=FasterActivator%20Sample)

```
 public static List<T> SortedCollection<T>(SPListItemCollection items, ListSortType sortType, List<Vote> votes) where T : IVotable
    {
        var returnlist = new List<T>();
        var functionCreator = FastActivator.GenerateFunc<Func<SPListItem, List<Vote>, T>>();

        for (int i = 0; i < items.Count; i++) { returnlist.Add(functionCreator(items[i], votes)); }
        }
        switch (sortType)
        {
            case ListSortType.Hot:
                returnlist.Sort((p1, p2) => p2.HotScore.CompareTo(p1.HotScore));
                break;
            case ListSortType.Top:
                returnlist.Sort((p1, p2) => p2.VoteTotal.CompareTo(p1.VoteTotal));
                break;
            case ListSortType.Recent:
                returnlist.Sort((p1, p2) => p2.CreatedDate.CompareTo(p1.CreatedDate));
                break;
        }
        return returnlist;
    } 
```

错误在for循环中，得到MethodAccessException：

`.Post__041c49eec0a6466da11894b0455b1162(Microsoft.SharePoint.SPListItem, System.Collections.Generic.List`1)`

**出现错误的控制台应用程序（要求 FastActivator 类位于同一命名空间中）：**

```
namespace testcase
{
    class Program
    {
        static void Main(string[] args)
        {
            var vote1 = new Vote() {ItemID=1};
            List<Vote> votes = new List<Vote>();
            votes.Add(vote1);

            List<string> strings = new List<string>();
            strings.Add("test");
            List<Post> posts = Post.SortedCollection<Post>(strings, ListSortType.Hot, votes);
        }
    }

    internal interface IVotable
    {
        double HotScore { get; set; }
        double VoteTotal { get; set; }
        DateTime CreatedDate { get; set; }
    }
    internal class SCO : IVotable
    {
        public double HotScore { get; set; }
        public double VoteTotal { get; set; }
        public DateTime CreatedDate { get; set; }

        public SCO(string item, List<Vote> votes)
        {
            VoteTotal = 10;
            HotScore = 10;
            CreatedDate = DateTime.Now;
        }

        public static List<T> SortedCollection<T>(List<string> items, ListSortType sortType, List<Vote> votes) where T : IVotable
        {
            var returnlist = new List<T>();
            Type genericType = typeof(T);
            var functionCreator = FastActivator.GenerateFunc<Func<string, List<Vote>, T>>();

            for (int i = 0; i < items.Count; i++) { returnlist.Add(functionCreator(items[i], votes)); }
            switch (sortType)
            {
                case ListSortType.Hot:
                    returnlist.Sort((p1, p2) => p2.HotScore.CompareTo(p1.HotScore));
                    break;
                case ListSortType.Top:
                    returnlist.Sort((p1, p2) => p2.VoteTotal.CompareTo(p1.VoteTotal));
                    break;
                case ListSortType.Recent:
                    returnlist.Sort((p1, p2) => p2.CreatedDate.CompareTo(p1.CreatedDate));
                    break;
            }
            return returnlist;
        }
    }

    class Vote
    {
        public double ItemID { get; set; }
    }
    class VoteMeta
    {
        public double UpVotes { get; set; }
        public double DownVotes { get; set; }
        public string CurrentUserVoteClass { get; set; }
    }
    internal enum ListSortType { Hot, Top, Recent };

    class Post : SCO
    {
        public string Summary { get; set; }
        public Uri Link { get; set; }

        public Post(string item, List<Vote> votes)
            : base(item, votes)
        {
            Summary = "Summary";
            Link = new UriBuilder("http://www.google.com").Uri;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:05:02.410

您可能在某处有一个非公共构造函数。没有[明确指定](https://stackoverflow.com/questions/3763612/default-visibility-for-c-sharp-classes-and-members-fields-methods-etc)命名空间成员的可见性使其成为内部的，而不是公共的。[这些](http://pastebin.com/eZY2tgKy)修改使您的示例程序正常工作。请注意，动态方法位于动态生成的程序集中，因此无法访问内部成员。

# c# - 使用单个 TransactionScope 包装大量数据库更新时出现异常

> ID：12148802
> 
> 赞同：2
> 
> 时间：2012-08-27T20:03:58.820
> 
> 标签：c#, linq-to-sql, transactionscope

我收到异常“与当前连接关联的事务已完成但尚未释放。必须先释放事务，然后才能使用连接执行 SQL 语句。” 当我使用 TransactionScope 包装在多次调用 UpdateItem 子例程中发生的大量数据库更新时。有人可以帮助理解此错误的含义以及重组代码的正确方法，同时保留在 foreach 中的任何内容失败时保留回滚的能力（引发异常）

```
static void Foo()
{    
    using (TransactionScope transactionScope = new TransactionScope())
    {
        foreach (var item in items)
        {
            UpdateItem(item);
        }

        transactionScope.Complete(); 
    }
}

static void UpdateItem(string item)
{
    using (MyDataContext db = new MyDataContext)
    {
        :
    :
    db.Table1.InsertOnSubmit();
    :
    db.SubmitChanges();
    :
    :
    db.ExecuteCommand(); // I get the exception here
    :
    db.Table2.InsertOnSubmit();
    :
    db.SubmitChanges();
    :   
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:26:49.350

A`TransactionScope`超时。当它被击中时，事务被回滚。指定更大的超时值。

# java - JAXB 如何创建具有不同属性值的重复元素

> ID：12148807
> 
> 赞同：3
> 
> 时间：2012-08-27T20:04:18.693
> 
> 标签：java, xml, xsd, jaxb

我正在尝试使用 JAXB 输出以下 XML：

```
<ScreenData step="1" description="My descriotion">
    <element name="name1" type="type1" value="value1"/>
    <element name="name2" type="type2" value="value2"/>
</ScreenData> 
```

为此，我使用以下代码：

```
screenData.getElement().add(element);
        element.setName("name1");
        element.setType("type1");
        element.setValueAttribute("value1");

        screenData.getElement().add(element);
        element.setName("name2");
        element.setType("type2");
        element.setValueAttribute("value2"); 
```

这就是输出：

```
<ScreenData step="1" description="My First XML">
                <element name="name2" type="type2" value="value2"/>
                <element name="name2" type="type2" value="value2"/>
            </ScreenData> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:07:12.670

您需要确保创建单独的`Element`. 目前，您似乎要添加两次相同的实例。

```
 Element element1 = new Element();
    screenData.getElement().add(element1);
    element1.setName("name1");
    element1.setType("type1");
    element1.setValueAttribute("value1");

    Element element2 = new Element();
    screenData.getElement().add(element2);
    element2.setName("name2");
    element2.setType("type2");
    element2.setValueAttribute("value2"); 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/09/jaxb-collection-properties.html](http://blog.bdoughan.com/2010/09/jaxb-collection-properties.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:07:58.630

您必须创建一个集合或一个列表。

```
 List<MyClass> l= new ArrayList<MyClass>();

    myClass = new MyClass();
    myClass.setAttr("attr1");

    l.add(myClass);

    myClass2 = new MyClass();
    myClass2.setAttr("attr2");

    l.add(myClass2); 
```

# php - WSOD 在 Drupal 7 中使用 Drupal 6 模块代码？

> ID：12148815
> 
> 赞同：0
> 
> 时间：2012-08-27T20:05:00.397
> 
> 标签：php, module, drupal-7, drupal-views, wsod

这是我在 Drupal 6 中完美运行的代码，但在 Drupal 7.15 和视图 7.x-3.3 中给了我一个空白的白页 WSOD；

```
<?php

function ajaxview_menu() {

  $items = array();

  $items['replies'] = array(
    'title' => 'Replies',
    'page callback' => 'ajaxview_replies',
    'description' => 'Replies',
    'access arguments' => array('access content'),
    'type' => MENU_CALLBACK,
  );

  return $items;
}

function ajaxview_replies($nid) {
  $node = node_load($nid);
  $viewName = 'Replies'; 
  $display_id = 'default'; 
  $myArgs = array($nid); 
  print views_embed_view($viewName, $display_id, $myArgs);
 exit();
} 
```

发生了什么变化，我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T09:40:48.907

抱歉，这是一个愚蠢的错误。

$viewName 的机器名称是“回复”而不是“回复”。

嗬！

# ms-access - 如何使用 SQLExpress 2008 在 Win7 64b 上安装 Microsoft.ACE.OLEDB.12.0

> ID：12148820
> 
> 赞同：1
> 
> 时间：2012-08-27T20:05:17.090
> 
> 标签：ms-access, 64-bit, sql-server-express, bit

我在 32b XP 上运行 VSExpress 2010 C# 和 SQLExpress 2008。由于失败，我现在使用的是 64 位 Win7。我已经重新安装了 VSExpress C# (64b)。我安装了 SQLExpress (64b)，但是我的应用程序使用 Microsoft.ACE.OLEDB.12.0 驱动程序连接到 Office 2007 (32b) 数据库。我无法在 SQLExpress (64b) 上加载 Microsoft.ACE.OLEDB.12.0。

我需要做什么才能让 Microsoft.ACE.OLEDB.12.0 在 SQLExpress 中再次工作？我需要运行 32 位版本吗？（我已经下载了它，但是在安装它时遇到了问题，所以我在卸载所有 SQLExpress 时询问）

谢谢您的帮助。（我看到很多类似的问题得到解决，但找不到针对我的具体问题的解决方案）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:28:52.723

我认为[这篇文章](https://stackoverflow.com/questions/2899201/microsoft-ace-oledb-12-0-64x-sql-server-and-86x-office)有您正在寻找的答案——下载 64 位版本的 ACE OLE DB 驱动程序。但是，显然它还需要安装 64 位版本的 Office。

否则，请安装支持 WoW 的 32 位版本的 SQL Server 2008 Express。转到此下载页面并下载`SQLEXPR_x86_ENU.exe`（注意：文件名中**没有的那个）。** `32`它应该安装在 64 位系统上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T10:52:01.353

我遇到了同样的问题，无法安装 64 版本，因为我也安装了 32 位 office（所以 64 位安装终止）。我将程序的构建更改为 x86 而不是 AnyCPU，并且 32 位 ACE 的工作[方式与此 Stack Overflow 问题中给出的一样](https://stackoverflow.com/questions/11179905/the-microsoft-ace-oledb-12-0-provider-is-not-registered-on-the-local-machine)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-11T22:27:02.030

如果您尝试使用 32 位版本，您可能需要安装 32 位版本的 Microsoft Office 数据库引擎。但是，如果您安装了 64 位 office，这将显示一条消息，指出已安装 64 位。

如果您使用“/PASSIVE”命令行参数安装 Microsoft Office 数据库引擎，它将在没有提示的情况下安装，然后您可以使用 32 位 ACE.OleDB.12 驱动程序。

请注意，在某些情况下，这可能会导致 Office 64 位出现并发症。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-25T18:03:31.423

我必须安装 Access 2007 Runtime 来解决这个问题。这里：[https ://www.microsoft.com/en-us/download/details.aspx?id=4438](https://www.microsoft.com/en-us/download/details.aspx?id=4438)

# sql-server - 为什么我们需要定义 odbc 连接来连接到 sql server（但并非总是如此）

> ID：12148823
> 
> 赞同：2
> 
> 时间：2012-08-27T20:05:33.990
> 
> 标签：sql-server, odbc, cognos

当我打开 sql server management studio 并连接到 sql server 数据库时，它连接正常。但是当我尝试在 cognos 管理中定义到同一个 sql server 的连接，然后尝试通过本地框架管理器测试连接时，它说连接失败。我需要在我的控制面板中定义一个 odbc 连接才能工作。所以我的问题是..为什么 sql server management studio 不需要 odbc 连接，但 cognos 需要它？我也听说ms access需要它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T13:44:55.313

这取决于您在 Cognos Administration 中创建的数据源的类型。如果选择 ODBC 作为数据源类型，它将尝试使用 ODBC 进行连接。您可能想要选择适当的 SQL Server 数据源类型。

# asp.net - 如何在 runat="server" 表格元素中包含 thead？

> ID：12148825
> 
> 赞同：19
> 
> 时间：2012-08-27T20:05:43.867
> 
> 标签：asp.net, visual-studio-2010, upgrade, visual-studio-2012, web-site-project

我正在将一个大型网站项目从 Visual Studio 2010 升级到 2012。在我的整个项目中，我都有具有该属性`table`的元素。`runat="server"`其中许多都包含其中的`thead`元素。当我在 2012 年打开它并尝试构建时，我收到以下错误：

```
Value of type 'System.Web.UI.HtmlControls.HtmlGenericControl' cannot be converted to 'System.Web.UI.HtmlControls.HtmlTableRow' 
```

删除`runat="server"`属性或注释掉`thead`它会修复它。仅注释掉其中的`tr`元素`thead`并不能修复它。这是一个重现问题的简化示例：

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="Test.aspx.vb" Inherits="Test" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <table id="Example" runat="server">
            <thead>
                <tr>
                    <th>test</th>
                </tr>
            </thead>
        </table>
    </div>
    </form>
</body>
</html> 
```

错误发生在`table`元素打开的地方。

如何在不执行以下操作之一的情况下解决此问题？

*   删除`runat="server"`属性
*   移除`thead`元素
*   将其更改为`asp:table`元素

对解释 2012 年的不同做法导致此问题的人进行额外投票。

**更新：**

该问题不会出现在 Web*应用程序*中，只会出现在网站中。

该项目实际上并没有升级，只是我的开发环境。在这两种情况下，我都使用 4.0 框架

我尝试使用 4.5 框架，但没有帮助。

2012 年 9 月 10 日：我有一个 Microsoft 支持的未决案例。他们的开发团队正在研究它。

2012 年 10 月 24 日：由于 .NET 4.5 取代了 4.0，我也无法再在 VS 2010 中编译。我遇到的问题纯粹是 .NET - 而不是 Visual Studio。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T03:59:49.970

现已提供此问题的修复程序。 [http://support.microsoft.com/kb/2750149](http://support.microsoft.com/kb/2750149)用于 Windows 8 和[http://support.microsoft.com/kb/2750147](http://support.microsoft.com/kb/2750147)用于 Windows 7 平台。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T20:55:39.243

Microsoft 已确认这是一个错误。他们将为它创建一个热修复程序，并将修复程序包含在下一个服务包中。听起来这不是一个高优先级，因此热修复可能需要一段时间。

2012 年 10 月 1 日更新：Microsoft 支持人员联系了我，并说这将在即将到来的热修复中“很快”修复。

2012-11-28 更新：Visual Studio 2012 Update 1 没有解决这个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-04T18:14:56.200

对于部分解决方案，您可以将该`<th>`前端代码移至后端代码。那应该解决编译问题。虽然不知道如何处理`<tbody>`标签。如果您现在查看页面的 HTML，我怀疑它们是否会呈现。 [这就是为什么。](https://stackoverflow.com/questions/2052003/htmltable-htmltablerow-htmltablecell-creating-thead-tbody-and-tfoot)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-01T11:03:46.103

简单的解决方案删除标签 tbody 和 thead，对我来说有效。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-04T14:00:20.457

我没有VS 2012；现在，但您应该尝试以下操作

1.  你能验证更改 DOCTYPE。（过渡、框架集、1.1 或 html 5 等）
2.  将整个表格放入 asp:placeholder

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-09-26T06:26:09.027

是的，它是 Visual Studio 2012 中的一个错误，从下面提到的链接应用补丁对我有用：http: [//www.microsoft.com/en-us/download/details.aspx?id=36359](http://www.microsoft.com/en-us/download/details.aspx?id=36359)

对于当前/正在迁移的正在运行的项目，删除标签不会解决它。这样，我们必须更改每个 aspx 页面。

# php - 如何在 PHP 中的所有换行符之前和之后将字符串包装在 span 中？

> ID：12148830
> 
> 赞同：1
> 
> 时间：2012-08-27T20:06:05.480
> 
> 标签：php, string, function

搜索后，我发现 PHP 函数
在字符串中的所有换行符之前插入

```
nl2br(); 
```

**例子：**

```
<?php
   echo nl2br("This is an example\r\n where line breaks\r\n added", false);
?> 
```

以上代码输出：

```
This is an example<br\>
where line breaks<br\> 
added 
```

我想要输出而不是 <br/> 我将在所有换行符之前和之后用标签包装字符串

**上面代码的示例输出用 span 包装字符串**

```
<span>This is an example</span>
<span>where line breaks</span> 
<span>added</span> 
```

是否存在PHP函数？或自定义 PHP 函数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:10:06.603

您可以在“\r\n”上执行“爆炸”，并使用连接的跨度遍历每个值。

就像是

```
$values = explode("\r\n", "one\r\ntwo\r\nthree\r\nfour")
$newvalues = ""

foreach($values as $value){
    $newvalues = $newvalues . "<span>" . $value . "</span>"
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:11:20.483

```
 $str = "This is an example\r\n where line breaks\r\n added";
    $str = explode("\r\n",$str);
    foreach($str as $key => $value) {
       echo "<span>".$value."</span>";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:13:09.577

使用`file()`. 它将整个文件作为一个数组返回，每个都是一个新行。遍历那里并添加您的跨度。不是最好的方法，但如果您有很多文件要执行此操作，它与任何其他解决方案一样简单。否则，只需在分隔符上爆炸。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T20:18:20.993

此函数仅基于 CRLF 或 LF 拆分字符串，然后将其包装到`<span>`标签中，应用适当的转义（重要）：

```
function nl2span($str)
{
    $r = '';
    foreach (preg_split("/\r?\n/", $str) as $line) {
        $r .= '<span>' . htmlspecialchars($line). '</span>';
    }
    return $r;
} 
```

如果您的行尾*始终*为CRLF，您可以将 替换`preg_split()`为更传统的`explode("\r\n", ...)`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-27T20:35:26.440

```
$string = "This is an example\r\n where line breaks\r\n added";
var_dump($string); 
// string(46) "This is an example
// where line breaks
// added"
array_map(function($s){echo sprintf('<span>%s</span>', trim($s));}, explode("\r\n", $string));
// <span>This is an example</span>
// <span>where line breaks</span>
// <span>added</span> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-23T10:53:05.467

这很有用：

```
function nl2span( $str) {
    return '<span>' . implode( '</span><span>', explode( "\r\n", $str ) ) . '</span>';
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-27T20:11:29.077

```
function splitToSpans($string) {
    $lines = explode('\r\n', $string);
    $finalString = '';
    foreach ($lines as $line) {
        $finalString .= '<span>' . $line . '</span>';
    }
    return $finalString;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-27T20:11:35.020

就像是：

```
$strout = '';
$lines = explode(PHP_EOL, $input);
foreach ($lines as $line) {
    $strout .= "<span>$line</span>";
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-27T20:14:04.557

选项1：

```
<?php
$string = "Line 1
Line 2
Line 3";
$string = preg_replace('/^(.*)$/m', '<span>$1</span>', $string);
echo $string; 
```

选项 2：

```
<?php
$string = "Line 1\r\nLine 2\r\nLine 3";
$string = array_map(function($value) {
    return "<span>$value</span>";
}, explode("\r\n", $string));
echo implode("\r\n", $string); 
```

# mysql - 仅当组中的每条记录都满足 MySQL 中的特定条件时，如何选择分组记录？

> ID：12148835
> 
> 赞同：1
> 
> 时间：2012-08-27T20:06:23.150
> 
> 标签：mysql, select, group-by, having

我正在使用`MySQL 5.0.88/Coldfusion8`并且我有一个包含基于条形码/EAN 的产品的表。

所以一个大小为 123 的产品在`S,M,L,XL`表中会有 4 条记录

```
 product size  ean              qty    disregard_inventory
 123     S     1111111111111     5     0
 123     M     1111111111112     7     0
 123     L     1111111111113     1     0
 123     XL    1111111111114     2     0 
```

现在我正在像这样搜索这张表：

```
 SELECT count(a.id) AS total_records, a.disregard_inventory, a.qty
      FROM artikelstammdaten a
      ...
  GROUP BY a.style
  HAVING sum(a.qty) != 0 OR (a.disregard_inventory = 1) 
```

这可以正常工作并选择所有**未售罄的产品（所有 eans 的总和 > 0）/始终可用**

我现在想添加一个功能，以便用户可以搜索**每个尺寸至少有 1pc 的**产品。在这种情况下，样式 123

```
 123   S   1
   123   M   0
   123   L   12
   123   XL  9 
```

`size M`由于已售罄，因此不会包含在结果集中。

但是我无法让它工作。这就是我所拥有的（产生垃圾）：

```
 GROUP BY a.style
  <cfif form.select_type EQ "running_sizes">
  HAVING a.qty!= 0 OR ( a.disregard_inventory = 1 )
  <cfelse>
  HAVING sum(a.bestand) != 0 OR (a.disregard_inventory = 1) 
  </cfif> 
```

**问题**：
是否有可能进行分组，`style`并且仅`style`在每个底层证券`ean`的数量 > 0 时才包括在内？如果是这样，谢谢指点！

**编辑：**
这是我正在测试的完整查询：

```
 SELECT count(a.id) AS gesamt_datensaetze, a.nos, a.nos_anzeige, a.bestand, SUM(a.bestand>0) AS what
       FROM artikelstammdaten a

        WHERE a.aktiv = "ja"
        AND a.firma LIKE "some_company" 

        // groups by seller_id, style
        GROUP BY a.iln, a.artikelnummer
        HAVING sum(a.bestand) != 0 OR (a.nos = "ja" AND a.nos_anzeige = "ja")   
        AND ( SUM(a.bestand > 0) = COUNT(*)) 
```

**解决方案：**
括号缺失：

```
HAVING (( sum(a.bestand) != 0 ) OR (a.nos = "ja" AND a.nos_anzeige = "ja" ))
AND  ( SUM(a.bestand > 0) = gesamt_datensaetze  ) 
```

这行得通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:10:46.010

您可以使用子查询上的连接来完成此操作。基本上，加入可用数量为零的产品 ID 集，然后仅返回不匹配的结果。

```
SELECT count(a.id) AS total_records, a.disregard_inventory, a.qty
FROM artikelstammdaten a

LEFT JOIN (
    SELECT DISTINCT id
    FROM artikelstammdaten
    WHERE qty = 0
) b
ON b.id = a.id

WHERE b.id IS NULL
...

GROUP BY a.style
HAVING sum(a.qty) != 0 OR (a.disregard_inventory = 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:14:47.093

我建议以下查询：

```
SELECT COUNT(a.id) AS total_records, a.disregard_inventory, a.qty
    FROM artikelstammdaten a
    ...
GROUP BY a.style
HAVING (SUM(a.qty) != 0 OR (a.disregard_inventory = 1))
       AND (SUM(qty>0) = total_records) 
```

`total_records`我添加到查询中的最后一个条件允许仅当此产品的尺码数 ( ) 等于此产品的可用尺码数( )时才返回样式`SUM(qty>0)`。
`qty>0`将返回 0（当产品在给定尺寸不可用时，或 1（当它可用时）。因此`SUM(qty>0)`将返回介于 0 和尺寸总数之间的整数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:14:50.763

我认为你应该检查 MIN(a.qty)：

```
select product from t group by product having min(qty)>0 
```

# c++ - 无需设置环境即可使用 boost

> ID：12148837
> 
> 赞同：0
> 
> 时间：2012-08-27T20:06:30.600
> 
> 标签：c++, boost

有没有办法在没有设置环境的情况下使用 C++ boost 库？

我正在尝试使用`boost::split`但由于`boost::split`找不到其他依赖文件而出现错误。

我知道如何使用 CMake/VS 设置环境，但这只是一个轻量级的实用程序，所以没有必要这样做。

有没有办法`boost`即时使用库？

我知道很多提升只是标题，但我收到了以下错误，这让我感到困惑：

`C:\Development\Libraries\boost_1_50_0\boost\algorithm\string.hpp:18:60: fatal error: boost/algorithm/string/std_containe rs_traits.hpp: No such file or directory compilation terminated.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:13:14.820

好吧，显然这仅适用于仅标头库。你需要更多的东西来链接文件附带的 boost-libraries。

现在，我正在这样做：我使用了一些 boost 头库，没有使用任何链接库，而且我不需要为此做任何准备。除了 boost 包含一些带有 <filename> 而不是“filename”的头文件，因此您必须将 boost 库目录添加到包含文件的搜索路径中。不需要其他任何东西。

编辑：除了可能对您的警告设置进行调整。不幸的是，boost 不是“警告清除”，这与我的 -Werror 和 /WX 开关冲突。我不得不全局禁用一些警告，因为它们太多了（并且警告编译指示不适用于所有平台上的预编译头文件），并在 boost 头文件中修复了一些。

# visual-studio-2010 - Visual Studio 2010 智能感知方法顺序

> ID：12148838
> 
> 赞同：3
> 
> 时间：2012-08-27T20:06:33.063
> 
> 标签：visual-studio-2010, intellisense

我正在用 C++ 编写。Visual Studio 2010 智能感知按字母顺序显示方法。有没有办法让它以原始顺序（它们在源代码中出现的顺序）显示方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:11:53.337

从[另一个问题](https://stackoverflow.com/questions/3391332/is-there-a-way-to-change-the-order-of-constructors-listed-in-intellisense-in-vis)的[答案](https://stackoverflow.com/a/3391360/873644)：

> 在 Visual Studio 的 Intellisense 中无法控制排序。如果您确实有多个构造函数（或方法），那么在智能感知方面，您唯一真正的控制是使用带有相应 EditorBrowsableState 的 EditorBrowsable。这允许您在智能感知中隐藏构造函数（或方法），或者仅以“高级”模式显示它，但不允许您重新排序它们。

# c++ - 对任意大的位数组或数字的位操作

> ID：12148839
> 
> 赞同：6
> 
> 时间：2012-08-27T20:06:33.080
> 
> 标签：c++, data-structures, bit-manipulation

我有一个非常简单的问题：在 C++ 中，是否有一种内置或直接的方法可以将大量（~1000）位（或布尔值）分组到单个标签中，以便内置位运算符的功能与它们的基本功能一样?

例如，`long`你可能会写：

```
unsigned long maximum = ~0; 
```

或者可以使用：

```
somenum>>; 
```

对于任意大小的内存块，是否有类似的方法可以做到这一点？

如果没有，有什么好的选择？我想到了 bit `<vectors>`、 a C`union`等，但这些似乎都需要手写例程来进行各种位操作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T20:07:21.237

是的！它被称为**[`std::bitset`](http://en.cppreference.com/w/cpp/utility/bitset)**并且就是这样做的。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:53:05.317

此外，[`boost::dynamic_bitset`](http://www.boost.org/doc/libs/1_51_0/libs/dynamic_bitset/dynamic_bitset.html)根据要求可能会有用。我希望它是标准的，而不是`std::vector<bool>`hack

# cross-compiling - 为什么 libtool 寻找 .lib 文件而不是 .a 文件？

> ID：12148842
> 
> 赞同：1
> 
> 时间：2012-08-27T20:06:48.070
> 
> 标签：cross-compiling, libtool, expat-parser, fontconfig

我正在使用 Mingw-w64 为 Windows 交叉编译[Fontconfig](http://freedesktop.org/wiki/Software/fontconfig)（主机是 Ubuntu 12.04 64 位）。该过程包括以下步骤：

1.  编译并安装构建依赖项（Freetype 和 eXpat）。

2.  运行`./configure`：

    ```
    ./configure --host=i686-win64-mingw32 --prefix=/usr/i686-w64-mingw32 
    ```

3.  该`./configure`过程完成没有错误，我运行`make`：

    ```
    make 
    ```

4.  不幸的是，这里出了点问题：

    ```
    ...
      CCLD   libfontconfig.la
    i686-w64-mingw32-gcc: error: /usr/i686-w64-mingw32/lib/libexpat.lib:
        No such file or directory 
    ```

如您所见，`libtool`正在寻找`libexpat.lib`一些奇怪的原因（**不**存在）而不是`libexpat.a`（**确实**存在）。

这里发生了什么？

* * *

**编辑：**为了让事情更混乱，这些相同的步骤在 Ubuntu 12.10 (Quantal) 上完美运行。我不知道为什么它在 12.04（精确）上失败了。上述命令的A`diff`输出在包含上述错误的行之前没有任何区别。

* * *

**进一步编辑：**我提取了正在运行的生成错误的原始命令：

```
/bin/bash ../libtool --silent --tag=CC --mode=link i686-w64-mingw32-gcc -O2 -ve
rsion-info 7:2:6 -no-undefined -export-symbols fontconfig.def -o libfontconfig.l
a -rpath /usr/i686-w64-mingw32/lib fcatomic.lo fcblanks.lo fccache.lo fccfg.lo 
fccharset.lo fcdbg.lo fcdefault.lo fcdir.lo fcformat.lo fcfreetype.lo fcfs.lo fc
init.lo fclang.lo fclist.lo fcmatch.lo fcmatrix.lo fcname.lo fcpat.lo fcserializ
e.lo fcstat.lo fcstr.lo fcxml.lo ftglue.lo -L/usr/i686-w64-mingw32/lib -lfreetyp
e -L/usr/i686-w64-mingw32/lib -lexpat 
```

调用`i686-w64-mingw32-gcc`变为：

```
--------------------------------------------------------------------------------
i686-w64-mingw32-gcc -shared .libs/libfontconfig-1.dll.def .libs/fcatomic.o .lib
s/fcblanks.o .libs/fccache.o .libs/fccfg.o .libs/fccharset.o .libs/fcdbg.o .libs
/fcdefault.o .libs/fcdir.o .libs/fcformat.o .libs/fcfreetype.o .libs/fcfs.o .lib
s/fcinit.o .libs/fclang.o .libs/fclist.o .libs/fcmatch.o .libs/fcmatrix.o .libs/
fcname.o .libs/fcpat.o .libs/fcserialize.o .libs/fcstat.o .libs/fcstr.o .libs/fc
xml.o .libs/ftglue.o -L/usr/i686-w64-mingw32/lib /usr/i686-w64-mingw32/lib/libfr
eetype.dll.a /usr/i686-w64-mingw32/lib/libexpat.lib -O2 -o .libs/libfontconfig-1
.dll -Wl,--enable-auto-image-base -Xlinker --out-implib -Xlinker .libs/libfontco
nfig.dll.a 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T02:56:52.167

所以事实证明，问题根本不在于 Fontconfig，而在于 eXpat。用于构建 eXpat 的环境没有安装 Mingw-w64 的 C++ 编译器，并且由于某种原因导致文件名为`libexpat.a`而不是`libexpat.dll.a`.

[一旦我在安装了g++-mingw-w64![安装 g++-mingw-w64](../Images/9c0ca64d07fa4569c5ceecf38294a9aa.png)](https://packages.ubuntu.com/search?keywords=g%2B%2B-mingw-w64)包的情况下重试了构建，它就成功了。

顺便说一句，Quantal 构建成功而 Precise 构建失败的原因是因为[g++-mingw-w64![安装 g++-mingw-w64](../Images/9c0ca64d07fa4569c5ceecf38294a9aa.png)](https://packages.ubuntu.com/search?keywords=g%2B%2B-mingw-w64)不是[mingw-w64![安装 mingw-w64](../Images/9c0ca64d07fa4569c5ceecf38294a9aa.png)](https://packages.ubuntu.com/search?keywords=mingw-w64)对 Precise 的依赖，而是成为对 Quantal 的依赖。

# mongodb - MongoDB：在具有多个条件的数组中查找值

> ID：12148845
> 
> 赞同：8
> 
> 时间：2012-08-27T20:06:58.817
> 
> 标签：mongodb

我有以下文件：

```
{_id : 1, numbers : [-1000, 1000]}
{_id : 2, numbers : [5]} 
```

我正在尝试获取一个查询，该查询将在 numbers 数组中找到一个值介于 -10 和 10 之间的文档（在本例中为 _id ：2）。但是，当我尝试以下操作时：

```
db.foo.find({numbers : $and : [{$gt : -10},{$lt : 10}]}) 
```

它返回所有文件。没有map-reduce这可能吗？谢谢，-JWW

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-27T20:24:43.390

您可以使用 $elemMatch 来检查数组中的元素是否与指定的匹配表达式匹配。

在这种情况下，您可以使用它来获取一个文档，其 numbers 数组的元素介于 -10 和 10 之间：

```
 db.foo.find( { numbers : { $elemMatch : { $gt : -10 , $lt : 10 } } } ); 
```

这只会返回 _id : 2 文档。

# javascript - 在 Html5 画布上绘制带有滚动条的可缩放时间线

> ID：12148852
> 
> 赞同：4
> 
> 时间：2012-08-27T20:07:24.130
> 
> 标签：javascript, user-interface, html5-canvas, timeline

我的 Web 项目需要时间线。像[这样](http://vorg.github.com/timeline.js/examples/cssAnimation.html)的东西- 我阅读了这个时间线的代码，但由于没有足够的文档记录而无法理解。

我的问题是所有这些背后的数学（不是与画布的交互）。
我[已经](https://stackoverflow.com/questions/10374273/scrollbar-math-formula-bug) [阅读](https://stackoverflow.com/questions/10257421/custom-scrollbar-maths-in-jquery-javascript?rq=1) [了](http://csdgn.org/inform/scrollbar-mechanics "由于某种原因，此页面仅在 IE 中打开")几篇关于滚动条数学的文章，但没有一篇文章谈到缩放。
一些 [文章](http://digitalarts.bgsu.edu/faculty/bonniem/Spring11/artc4330_1/notes/notes35.html)建议保存具有非常大宽度值的画布元素 - 并仅显示 [View Port](http://en.wikipedia.org/wiki/Viewport "维基百科消歧页面")。
我认为这不是正确的方法 - 我只想绘制正确的视口。

在我的项目中，我有很多`n`点。
每个点都保存以秒为单位的时间值，但并非所有点都在 Viewp 端口内。

考虑到当前的缩放级别，我该如何计算：

*   应该画哪些点，在哪里画？*   拇指的大小和位置是多少？*   关于这样的事情的任何文章/教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:09:05.693

您也许可以使用[Flot](http://code.google.com/p/flot/)之类的东西来处理点的放置以及缩放和平移。[这是](http://people.iola.dk/olau/flot/examples/navigate.html)一个例子。

还有很多其他的绘图库，[这里有一个很好的列表](https://stackoverflow.com/questions/1890434/javascript-library-for-drawing-graphs-over-timelines-zoomable-and-selectable)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T19:20:06.783

您总是拥有 Raphealjs.com，这是最常用的 SVG 库之一，您可以使用它编写自己的 js 来生成时间线。

# ruby-on-rails - Ruby on rails 为智能手机制作应用程序

> ID：12148853
> 
> 赞同：0
> 
> 时间：2012-08-27T20:07:24.017
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我想构建一个在后端 Ruby on Rails 中使用的应用程序。然而，我的问题在于缺乏我在上面找到的信息。我的目标不仅仅是创建一个网站，而是一个与之交互的应用程序，就像我的 android facebook 应用程序一样，当按下菜单时，我会得到像注销等按钮。

我想知道他们是否存在关于如何构建应用程序但使用 Rails 的教程，或者我应该废弃我的整个网站并在 php 中完成。我正在寻找指南和教程。提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:10:58.550

您可以在任何平台上构建应用程序，并使用 HTTP 请求（如 AJAX）使其与基于 Rails 的服务器交互。
您可以使用 JSON 或 XML 来回发送信息；您可能需要为应用程序使用一组新的操作。

没有理由使用 PHP。 *曾经*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T20:14:54.697

您最初的问题有点不清楚，但如果您希望使用 Ruby（以及类似于 Ruby on Rails 的结构）创建移动应用程序，那么您可能会对[Rhomobile](http://www.motorola.com/Business/US-EN/Business+Product+and+Services/Software+and+Applications/RhoMobile+Suite)感兴趣。它是一个跨平台的移动应用程序框架，使用 Ruby 作为其后端代码，并遵循类似于（旧）Ruby on Rails 版本的结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T12:40:39.487

根据我对您问题的了解，您希望使用 的健壮性`Ruby`来开发本机应用程序（而不仅仅是另一个反映网站的应用程序）。

我所知道的最好的事情是`RubyMotion`。令人遗憾的是成本（`$200`）。但随后您将完成您的任务。

# javascript - 无法更改谷歌图表工具的背景

> ID：12148858
> 
> 赞同：0
> 
> 时间：2012-08-27T20:07:53.403
> 
> 标签：javascript, google-visualization

我到处寻找，但似乎无法更改 Google 图表表格的背景颜色。我尝试修改 css 并更改 javascript 属性但没有成功。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:34:46.637

使用 cssClassNames 选项。方法如下：http: [//jsfiddle.net/cama8/](http://jsfiddle.net/cama8/)

```
var cssClassNames = {
    'headerRow': 'italic-darkblue-font large-font bold-font',
    'tableRow': 'beige-background',
    'oddTableRow': 'beige-background',
    'selectedTableRow': 'orange-background large-font',
    'hoverTableRow': '',
    'headerCell': 'gold-border',
    'tableCell': '',
    'rowNumberCell': 'underline-blue-font'};

     var table = new google.visualization.Table(document.getElementById('table_div'));
     table.draw(data, {showRowNumber: true, 'cssClassNames': cssClassNames}); 
```

# c++ - 是否有一个调试器可以让我后退代码？

> ID：12148862
> 
> 赞同：8
> 
> 时间：2012-08-27T20:08:13.820
> 
> 标签：c++, c, debugging

> **可能重复：**
> [双向（或反向）调试](https://stackoverflow.com/questions/522619/bidirectional-or-reverse-debugging)

我查看了 Omniscient Debugger ( [http://www.lambdacs.com/debugger/ODBDescription.html](http://www.lambdacs.com/debugger/ODBDescription.html) )，但它特定于 Java。对于本机应用程序，即 C/C++，是否有任何具有相同功能的调试器？

我还没有说清楚。我想打破虚假数据值/代码路径，然后“回滚”，向后调试，直到在代码/逻辑/设计中找到错误。

我知道我可以“向前”一步一步地调试，我想向后做同样的事情，所以调试器需要在每一步中保存它的上下文。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T00:10:46.090

除了检查 x86 目标上已经提到的过去指令的堆栈跟踪之外，较新的 gdb 还支持[记录的程序执行和后退](http://sourceware.org/gdb/wiki/ProcessRecord/Tutorial)，这应该非常接近您正在寻找的内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-28T00:17:07.400

> *   [http://sources.redhat.com/gdb/news/reversible.html](http://sources.redhat.com/gdb/news/reversible.html)
> 
> GDB 7.0 版（2009 年 9 月到期）将是 gdb 的第一个支持反向调试的公开版本（能够使被调试的程序单步执行并反向继续）

附录：

Visual Studio 2010 及更高版本支持“历史调试”（“IntelliTrace”）：

*   [http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/06/16/how-does-vs2010-historical-debugging-work.aspx](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/06/16/how-does-vs2010-historical-debugging-work.aspx)

*   [http://msdn.microsoft.com/en-us/library/dd264915%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/dd264915%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-27T20:13:18.160

我认为您应该将 GDB 用于 C/C++。您有一些堆栈跟踪选项，您将能够在程序中设置断点并逐步运行它。

查看[http://www.cs.cmu.edu/~gilpin/tutorial/#3.5](http://www.cs.cmu.edu/~gilpin/tutorial/#3.5) 或在网上查找其他教程。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T10:52:27.347

`gdb`有命令`up n`和`down n`选择（`n`）帧`up`或`down`。

可能这会有所帮助。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-08-27T20:15:38.703

建议使用 linux [`GDB`](ftp://ftp.gnu.org/pub/old-gnu/Manuals/gdb/html_node/gdb_42.html)，而 Windows[`windbg`](http://msdn.microsoft.com/en-us/library/windows/hardware/ff539042%28v=vs.85%29.aspx)更好。

# node.js - 简单的 socket.io 示例不起作用

> ID：12148865
> 
> 赞同：0
> 
> 时间：2012-08-27T20:08:23.467
> 
> 标签：node.js, socket.io

这是服务器文件

```
var io = require('socket.io').listen(7000);

io.sockets.on('connection', function(socket) {
    console.log("### new connection ###");
}); 
```

这是给客户的

```
$j(document).ready(function() {
    var socket = io.connect('http://address.net:7000');
    console.log(socket);
}); 
```

服务器启动正确，没有任何错误。我从 node_modules 复制并附加到我的站点 <head> 部分文件“socket.io.min.js”文件，用于从 dist 文件夹中的客户端。

当我运行我的网站时，服务器的输出中没有任何### 新连接###。为什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-14T14:46:51.907

问题已解决。这是关于 socket.io 连接函数中的错误服务器地址。

# python - 从可迭代实现 django OR 查询的最佳实践方法？

> ID：12148869
> 
> 赞同：3
> 
> 时间：2012-08-27T20:08:37.257
> 
> 标签：python, django, django-models

我正在实施一个一次性数据导入器，我需要在其中搜索现有的 slug。蛞蝓在一个数组中。将数组转换为`OR`查询的公认最佳实践方式是什么？

我想出了以下方法，它有效，但感觉代码太多，无法完成这么简单的事情。

```
# slug might be an array or just a string
# ex:
slug = [ "snakes", "snake-s" ] # in the real world this is generated from directory structure on disk

# build the query
query = MyModel.objects
if hasattr(slug, "__iter__"):
    q = Q()
    for s in slug:
        q = q.__or__(Q(slug=s))
    query = query.filter(q)
else:
    query = query.filter(slug=slug) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T20:31:39.630

```
slug = ["snakes", "snake-s" ] # in the real world this is generated from directory structure on disk

# build the query
query = MyModel.objects
if hasattr(slug, "__iter__"):
    q_list = []
    for s in slug:
        q_list.append(Q(slug=s))
    query = query.filter(reduce(operator.or_, q_list))
else:
    query = query.filter(slug=slug) 
```

*   `q_list = []`创建 Q 子句列表
*   `reduce(operator.or_, q_list)`使用 or 运算符内爆列表

阅读： http: [//www.michelepasin.org/techblog/2010/07/20/the-power-of-djangos-q-objects/](http://www.michelepasin.org/techblog/2010/07/20/the-power-of-djangos-q-objects/)

@MostafaR - 如果我们愿意，我们当然可以将我的整个代码块压缩成一行（见下文）。不过，在那个级别上，它的可读性已经不高了。仅仅因为它没有被简化和混淆就说代码不是“Pythonic”是愚蠢的。可读的代码是国王恕我直言。同样重要的是要记住我的回答的目的是展示`reduce`操作员的技术。我的其余答案只是在原始问题的上下文中展示该技术。

```
result = MyModel.objects.filter(reduce(operator.or_, [Q(slug=s) for s in slug])) if hasattr(slug, "__iter__") else MyModel.objects.filter(slug=slug) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:30:05.247

```
result = MyModel.objects.filter(slug__in=slug).all() if isinstance(slug, list) else MyModel.objects.filter(slug=slug).all() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:28:03.847

我相信在这种情况下，您应该像这样使用 django 的[`__in`字段查找](https://docs.djangoproject.com/en/1.4/ref/models/querysets/#in)：

```
slugs = [ "snakes", "snake-s" ]
objects = MyModel.objects.filter(slug__in=slugs) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-27T20:23:19.087

您发布的代码在很多方面都不起作用（但我不确定它是否应该是更多的伪代码？），但据我了解，这可能会有所帮助：

```
MyModel.objects.filter(slug__in=slug) 
```

应该做的工作。

# geocoding - 从 nominatim 获取道路类型

> ID：12148872
> 
> 赞同：3
> 
> 时间：2012-08-27T20:08:59.687
> 
> 标签：geocoding, openstreetmap, nominatim

有没有办法通过 nominatim 从请求中获取对象所在的道路类型？

**例如**

[http://nominatim.openstreetmap.org/reverse?format=xml&lat=52.5487429714954&lon=-1.81602098644987&zoom=18&addressdetails=1](http://nominatim.openstreetmap.org/reverse?format=xml&lat=52.5487429714954&lon=-1.81602098644987&zoom=18&addressdetails=1)

确实为我提供了大量信息。但是，地址所在的道路上没有任何信息。想要获得类似：农村道路甚至只是等级*N*（其中*N*代表等级等级。）我希望我在寻找什么是可以理解的：）提前谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T17:33:04.203

Nominatim 用于搜索*地址*，您可能希望使用[OverpassAPI](http://wiki.openstreetmap.org/wiki/Overpass_API)查询给定坐标周围的道路：

```
http://overpass.osm.rambler.ru/cgi/interpreter?data=[out:json];way[highway](52.52,-1.82,52.55,-1.81);out; 
```

然后选择与您的坐标最匹配的那个，然后查看*高速公路 =*值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-05T18:56:50.383

您可以使用**`format=jsonv2`**代替`format=xml`或`format=json`。

`format=jsonv2`将下一个字段添加到响应中：`place_rank`, **`category`**, **`type`**, `importance`, `addresstype`.

我将此信息添加到[Nominatim 反向地理编码文档中。](https://wiki.openstreetmap.org/wiki/Nominatim#Reverse_Geocoding)

当类别标签包含值**`highway`**时，**`type`**标签显示道路类型。

`highway types`在[OpenStreetMap 高速公路标签](http://wiki.openstreetmap.org/wiki/Key:highway)上查找更多信息

# android - Eclipse ADB 服务器中面临的问题没有 ACK

> ID：12148873
> 
> 赞同：5
> 
> 时间：2012-08-27T20:09:07.830
> 
> 标签：android, eclipse

我收到了这个错误......而且我的 Eclipse 没有运行任何项目

```
[2012-08-28 01:35:50 - adb] ADB server didn't ACK
[2012-08-28 01:35:50 - adb] * failed to start daemon * 
```

这是我在 android 控制台中收到的

```
The connection to adb is down, and a severe error has occured.
You must restart adb and Eclipse.
Please ensure that adb is correctly located at 'C:\Program Files (x86)\Android\android-sdk\platform-tools\adb.exe' and can be executed. 
```

谁能告诉我该怎么做？？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-27T20:19:08.023

尝试使用任务管理器杀死 adb.exe，然后重新启动 Eclipse。

如果这不起作用，请尝试将 adb 添加到您的 CLASSPATH 中，然后重新启动 Eclipse。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T15:35:14.647

在任务管理器中查看 adb.exe 的路径，可能不是 SDK 路径中的那个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-27T20:21:16.193

尝试删除 .android/avd 下的所有现有 AVD 并重新启动您的 eclispe .. 创建一个新的 avd 并运行您的程序...当我收到此错误时，这通常对我有用

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-07T10:09:46.063

去任务管理器杀死 adb.exe 进程，然后重新启动 Eclipse。

# ruby-on-rails-3 - f.select 在 Rails 3.1 中显示值

> ID：12148878
> 
> 赞同：0
> 
> 时间：2012-08-27T20:09:33.840
> 
> 标签：ruby-on-rails-3

我有以下内容，但是在编辑记录时它不会显示当前值。需要改变什么来纠正这个

```
 <%= f.select :name, options_for_select([["Select Name", ""], "James", "John", "Richard", "Mike", "Peter"]), :class => 'small-input' %> 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T23:25:01.863

只需使用：

```
= f.select :your_field, options_for_select(array_list_of_possibilities, selected_value), :prompt => "select a name : " 
```

看看： [http ://apidock.com/rails/v3.2.8/ActionView/Helpers/FormOptionsHelper/select](http://apidock.com/rails/v3.2.8/ActionView/Helpers/FormOptionsHelper/select)

# msdeploy - TFS 部署错误目的地不可到达

> ID：12148889
> 
> 赞同：2
> 
> 时间：2012-08-27T20:10:26.240
> 
> 标签：msdeploy

我正在为自动部署配置 1 个新的 DEV 和 1 个新的 QA 服务器。我让 DEV 部署工作。我的问题是部署到 QA 给了我以下错误。

我们的构建服务器包含控制器和放置文件夹。发出 Invoke deploy 命令时会发生错误。我已确保 Web 管理服务正在 Web 服务器上运行。

什么可能导致以下错误消息？

```
Error Code: ERROR_DESTINATION_NOT_REACHABLE
More Information: Could not connect to the destination computer ("myWebServer"). 
On the destination computer, make sure that Web Deploy is installed and that the 
required process ("Web Deployment Agent Service") is started.
Error: The remote server returned an error: (404) Not Found.
Error count: 1. 
```

这是我的部署命令：

```
\\myBuildServer\Builds\MyApp - Deploy to QA\myApp - Deploy to QA_20120827.1\_PublishedWebsites\AppName.UI.Web_Package\Appname.UI.Web.deploy.cmd /M:http://myWebAddress/MsDeployAgentService/ /U:myDomain\tfsUID /P:MyPassword "-setParam:name='IIS Web Application Name',value='MyWebAppName'" /Y 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T22:53:20.697

如果您使用的是 IIS 7，请确保 WMSvc 已安装（添加或打开 Windows 功能）正在运行，它已正确配置并在 IIS 管理器中的“管理服务”下启用，并且端口 8172 已打开 - 尝试远程登录它。

如果是 IIS 6，请安装 Web 部署代理。

对于使用 WMSvc 的 IIS 7，您应该使用`http://svr:8172/MsDeploy.axd`，对于 MsDepSvc，您已经在使用正确的 URL（请参阅您的 /M 参数）。

我发现整个远程发布完全是胡扯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-17T20:34:12.377

安装 Web Deploy 时，请确保选择自定义并检查所有组件。这就是为我解决问题的原因。

[![在此处输入图像描述](../Images/04a3f0edee065825b099d4f4d4a1e343.png)](https://i.stack.imgur.com/2jVM5.png)

来源：[无法到达指定虚拟机上的 Web 部署端点](https://port135.com/2019/07/29/could-not-reach-the-web-deploy-endpoint-specified-virtual-machine/)

# c++ - 使用模板

> ID：12148896
> 
> 赞同：0
> 
> 时间：2012-08-27T20:10:51.577
> 
> 标签：c++, templates

[我有来自stackoverflow问题](https://stackoverflow.com/questions/2781899/how-to-find-whether-an-element-exists-in-stdmap)的这段代码：

```
template <typename K, typename V>
bool   exists_in(std::map<K,V> const& haystack, K const& needle) 
{
   return haystack.find(needle) != haystack.end();
} 
```

作为模板的新用户，我仍然了解这里发生了什么。只是，我似乎无法应用它。

我已经定义

```
class     Varinfo;                            // meta information about vars
std::map<std::string,VarInfo*>    g_varMap;   // a map between var names and meta-info 
```

在我的主要 c++ 代码中，我有这样的声明：

```
// various other uses of g_varMap that don't cause errors then

if ( exists_in( g_VarMap, "fred" ) ) 
```

产生此错误。

```
undefined reference to `bool exists_in<std::basic_string<char, 
std::char_traits<char>, std::allocator<char> >, 
VarInfo*>(std::map<std::basic_string<char, std::char_traits<char>, 
std::allocator<char> >, VarInfo*, std::less<std::basic_string<char, 
std::char_traits<char>, std::allocator<char> > >, 
std::allocator<std::pair<std::basic_string<char, std::char_traits<char>, 
std::allocator<char> > const, VarInfo*> > > const&, std::basic_string<char, 
std::char_traits<char>, std::allocator<char> > const&)' 
```

我完全不明白。

有人能告诉我为什么这是抱怨吗？我缺少什么模板知识？我已经尝试了对返回并发送到 exists_in() 的变量的各种转换操作，包括 std::string("fred")。没有任何帮助。有些只是产生了更多无意义的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:25:24.213

未定义的引用意味着它无法在任何目标文件中找到定义。这是一个链接器错误。您需要在头文件中定义模板方法，而不是在单独的 cpp 文件中。

你的代码看起来不错，我做了一个粗略的近似，你可以在这里看到： http: [//codepad.org/UvgeTIoC](http://codepad.org/UvgeTIoC)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:27:07.787

如果您的功能在呼叫点之前可用，您将没有问题。请记住，它是模板代码，因此必须直接或间接包含完整的实现：

```
#include <map>
#include <iostream>

template <typename K, typename V>
bool   exists_in(std::map<K,V> const& haystack, K const& needle) 
{
   return haystack.find(needle) != haystack.end();
}

int main()
{
  std::map<int, int> m{{1,1},{2,2}};
  std::cout << std::boolalpha;
  std::cout << exists_in(m,2) << "\n";
} 
```

输出`true`。

# javascript - 两个提交按钮，但第一个返回空

> ID：12148898
> 
> 赞同：-2
> 
> 时间：2012-08-27T20:10:54.197
> 
> 标签：javascript, html

我有第一个选择选项

```
 <form id="infform" method="post">
      <select id="infmenu" name ="infmenu" size="1" class="select"  >
        <option value="0" >Please Select your article</option>
        <option value="3"  selected='selected' > value 1</option>
        <option value="2"  > value 2</option>
        <option value="18"  > value 3</option>
        <option value="16"  > value 4</option>
     </select>
   <input type="hidden" name="hiddenselect" value="3" />
  </form> 
```

第二个是

```
 <form action="" method="POST" id="form0">
        <input type="text" name="date0" class="tcal" value="" readonly="readonly" /><br />
        <input type="image"   src="../submit.png"/>
        <input type="hidden" name="submit0" />
     </form> 
```

这是我的 javascript

```
 function displayv() {
    var singleValues = $("select option:selected").text();
    $("#hiddenselect").val(singleValues);

    $("select > option:first").prop("disabled", "disabled")
  }

$(document).ready(function(){
    $("select").change(function() {
        displayv();
    });
    displayv();

    $("select#infmenu").change(function() {
        $("#infform").submit();    
    });
}); 
```

现在，当我选择第一个选项时，页面刷新并且我得到了选择的值。当我提交第二次提交时，页面刷新并且第一个选择选项返回空`Please Select your article`。

那么应该如何解决这个问题。

编辑：这是我在它们之间处理的 php。

```
 if (isset($_POST['infmenu'])){

  $infmenu = $_POST['infmenu']; 
     // some sql of updating here
    }

  if (isset($_POST['submit0'])){
     //some updating sql here
      } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:35:10.707

我不太清楚你的问题到底是什么。

如果您说在提交第二个表单时没有看到您选择的项目值，那么这是正常的和预期的。您有两个独立的表单，因此当您提交第二个表单时，第一个表单的数据不会发送到服务器。

提交按钮 /image 仅发送其自己表单中的输入数据，而不是来自您的 html 正文标记中的任何其他表单的数据。

编辑添加：您可以：

*   有一个表单标签而不是两个
*   修改您的 jquery 以便它将选择值放入第二个表单的隐藏字段以及第一个表单的隐藏字段中。然后在提交第二个表单时，让您的 PHP 脚本读取隐藏字段值，并在呈现 HTML 时使用该值来决定哪个选项具有 selected 属性。
*   当 select 的值发生变化时，使用带有一些 JavaScript 的 cookie 来设置 cookie
*   使用 Ajax 进行部分提交 - 假设服务器在处理第二个表单时不需要知道选择项的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:16:12.137

没有`action=""`分配给第一个按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T10:23:08.900

你有两种形式。

当你在第二个表单中点击提交时，当然第一个表单的数据没有提交。

此外，第二种形式的提交按钮没有名称，因此如果单击该按钮，您可能无法在 PHP 中进行评估。但这是一个不同的故事

您应该将两种形式合二为一。

如果它们在您的页面上相距太远。你应该用php在第二种形式的隐藏字段中保存选择框的值

# tridion - Tridion - 事件系统对象没有被销毁

> ID：12148901
> 
> 赞同：6
> 
> 时间：2012-08-27T20:11:03.323
> 
> 标签：tridion, tridion-2011

我创建了一个具有订阅事件的事件处理程序的`TcmExtension`名称。此事件的目的是安排发布相关工作流主题的所有依赖项（即页面）。`WorkflowEventSystem``FinishProcess`

我遇到的问题是，即使事件在正确的时间触发（工作流程过程已完成），并且应该安排发布的所有项目都是，`PublishScheduler`事件创建的对象似乎永远不会消失范围，因此 WorkflowEventSystem 对象也没有。

关于事件系统的工作原理，我是否遗漏了一些东西会导致这些对象永远存在？我在下面包含了我认为相关的代码（总结了一些部分）。谢谢你的帮助。

这是大部分实际的 TcmExtension：

```
public class WorkflowEventSystem : TcmExtension
{
    public WorkflowEventSystem()
    {
        this.Subscribe();
    }

    public void Subscribe()
    {
        EventSystem.Subscribe<ProcessInstance, FinishProcessEventArgs>(ScheduleForPublish, EventPhases.All);
    }
} 
```

`ScheduleForPublish`创建一个`PublishScheduler`对象（我创建的类）：

```
private void ScheduleForPublish(ProcessInstance process, FinishProcessEventArgs e, EventPhases phase)
{
    if(phase == EventPhases.TransactionCommitted)
    {
        PublishScheduler publishScheduler = new PublishScheduler(process);
        publishScheduler.ScheduleForPublish(process);
        publishScheduler = null;  // worth a try
    }
} 
```

该`ScheduleForPublish`方法看起来与此类似：

```
public void ScheduleForPublish(ProcessInstance process)
{
    using(Session session = new Session("ImpersonationUser"))
    {
        var publishInstruction = new PublishInstruction(session);
        // Set up some publish Instructions

       var publicationTargets = new List<PublicationTarget>();
       // Add a PublicationTarget here by tcm id

       IList<VersionedItem> itemsToPublish = new List<VersionedItem>();
       // Add the items we want to publish by calling GetUsingItems(filter)
       // on the workflow process' subject

       //Publish the items
       PublishEngine.Publish(itemsToPublish.Cast<IdentifiableObject>(), publishInstruction, publishTargets);
    }    
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-28T04:26:58.967

类的生命周期管理`TcmExtension`非常简单：

1.  当您调用您指定`Subscribe`的`TcmExtension`对象时，它会被添加到订阅的内部列表中

2.  当您稍后调用`Unsubscribe`同一个`TcmExtension`对象时，将从订阅列表中删除

由于你从不调用`Unsubscribe`你`WorkflowEventSystem`的永远不会被删除，因此永远不会被.NET 垃圾收集。并且由于您`WorkflowEventSystem`持有`PublishScheduler`对其创建的实例的引用，因此该实例也将永远不会被清理。

自定义的正确样板`TcmExtension`是：

```
public class WorkflowEventSystem : TcmExtension, IDisposable
{
    EventSubscription _subscription;

    public WorkflowEventSystem()
    {
        this.Subscribe();
    }

    public void Subscribe()
    {
         _subscription = EventSystem.Subscribe<ProcessInstance, 
             FinishProcessEventArgs>(ScheduleForPublish, EventPhases.All);
    }

    public void Dispose()
    {
        _subscription.Unsubscribe();
    }
} 
```

Nuno 在本文中还给出了一个更长的示例（处理多个订阅者）：http: [//nunolinhares.blogspot.nl/2012/07/validating-content-on-save-part-1-of.html](http://nunolinhares.blogspot.nl/2012/07/validating-content-on-save-part-1-of.html)

# javascript - 使用自定义选项从控制台运行 JSlint？

> ID：12148904
> 
> 赞同：0
> 
> 时间：2012-08-27T20:11:12.980
> 
> 标签：javascript, jquery, jslint, static-code-analysis, javascript-debugger

在上一个问题[中，在 .js 文件上运行 JSLint，从 chrome 或 firefox 的调试控制台中，](https://stackoverflow.com/q/11884224/1577343)我学习了如何从控制台或节点运行 JSLint。

有没有办法运行 JSLint（来自 JavaScript 代码，如对上述问题的答案）**，但使用自定义选项**，例如对于包含 jQuery 的代码（[使用 JQuery 的 Javascript 的 JSLint 验证](https://stackoverflow.com/q/10557583/1577343)）选项*假设浏览器*和以 jQuery 和 $ 作为参数的选项*预定义部分？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:29:47.710

将带有选项的对象作为第二个参数传递给`JSLINT`. 全局变量可以定义为字符串数组并分配给`predef`所述选项对象的属性。

从[JSLint 源代码](https://github.com/douglascrockford/JSLint/blob/master/jslint.js#L28-L42)：

> `JSLINT`是一个全局函数。它需要两个参数。
> 
> ```
> var myResult = JSLINT(source, option); 
> ```
> 
> 第一个参数是字符串或字符串数​​组。如果它是一个字符串，它将在`'\n'`or上分割`'\r'`。如果是字符串数组，则假设每个字符串代表一行。源可以是 JavaScript 文本、HTML 文本、JSON 文本或 CSS 文本。
> 
> 第二个参数是控制 JSLINT 操作的选项的可选对象。大多数选项都是布尔值：它们都是可选的，默认值为 false。选项之一`predef`可以是名称数组，用于声明全局变量，也可以是其键用作全局名称的对象，其布尔值确定它们是否可分配。

# winapi - WM_NCHITTEST 不改变鼠标光标

> ID：12148906
> 
> 赞同：1
> 
> 时间：2012-08-27T20:11:18.063
> 
> 标签：winapi, nonclient, layered-windows, nonclient-area

我有一个分层窗口 (WS_EX_LAYERED)，它实现了自定义 NCHITTEST 和 NCCALCSIZE，以使我的窗口的客户端矩形与窗口矩形相同。我的窗户尺寸和油漆正确；当光标靠近窗口的底部边缘时，我可以从 WM_NCHITTEST 返回 HTBOTTOM 以导致从底部开始垂直调整窗口大小类型的操作。但是，我没有得到垂直调整大小光标。有没有办法解决这个问题而不必实现 WM_SETCURSOR 并测试指针的位置与窗口的边缘？

这是我的代码片段：

```
case WM_NCCALCSIZE:                   
    // Bypass DefWindowProc, so the Window Rect == Client Rect
    return 0;
case WM_NCHITTEST:  {            
    RECT w;
    ::GetWindowRect(hwnd, &w);  
    // Compare the mouse X/Y vs the rect of the window to detect
    // resizing from the bottom edges
    int r = HTCLIENT;
    int x = GET_X_LPARAM(lParam);
    int y = GET_Y_LPARAM(lParam);            
    if (w.bottom - y < 10) {
         // If I was not using NCHITTEST, I should get a verticle resize pointer here
        if (x - w.left < 10)
            r = HTBOTTOMLEFT;
        else if (w.right - x < 10)
            r = HTBOTTOMRIGHT;
        else
            r = HTBOTTOM;
    }   
    return r;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:41:37.887

You need to handle the WM_SETCURSOR message - the low-order word of lParam specifies the hit-test code.

For instance,

```
case WM_SETCURSOR:
    switch (LOWORD(lParam))
    {
        case HTBOTTOM:
            SetCursor(LoadCursor(0, IDC_SIZENS));
            return 0;
            }
        }
    }
    return DefWindowProc(hWnd, uMsg, wParam, lParam); 
```

# emacs - 在 Emacs 中使用 BBDB 忽略邮件列表邮件中的地址

> ID：12148907
> 
> 赞同：1
> 
> 时间：2012-08-27T20:11:18.270
> 
> 标签：emacs, email-headers, bbdb, bbdb-3

我想将 bbdb 配置为*不在*邮件列表邮件中自动通知地址。我正在尝试使用`X-Mailing-List`and`X-Mailman-Version`标头，因为它们似乎始终出现在我阅读的所有邮件列表中，但它似乎不起作用（即 bbdb 仍然提供从包含这些标头的邮件中保存电子邮件地址）。 .. 我究竟做错了什么？

```
(setq bbdb-ignore-message-alist
      '((("X-Mailman-Version" "X-Mailing-List") . ".*"))) 
```

顺便说一句，我正在使用[`bbdbv3`](http://savannah.nongnu.org/projects/bbdb/).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T19:34:09.050

查看我的 BBDB 手册副本，您似乎需要先设置`bbdb/mail-auto-create-p`（将其设置为`bbdb-ignore-some-messages-hook`），然后再设置`bbdb-ignore-some-messages-alist`（注意“-some”）。请参阅[第 1.7.3 节：预定义的挂钩](http://bbdb.sourceforge.net/bbdb.html#SEC61)。

# javascript - 动态添加 id 到输入字段

> ID：12148913
> 
> 赞同：1
> 
> 时间：2012-08-27T20:11:36.787
> 
> 标签：javascript, dynamic, html-table, rows

当我单击添加时，如何为表内的每个字段动态添加一个 ID？例如，始终显示的第一行将是 checkbox0、input0、select0，单击添加按钮时下一行的 id 将是 checkbox1、input1、select1 等。

下面是我的代码：

```
 <HTML>
  <HEAD>
  <TITLE> Add/Remove dynamic rows in HTML table </TITLE>
  <SCRIPT language="javascript">
  function addRow(tableID) {
    var table = document.getElementById(tableID);
    var rowCount = table.rows.length;
    var row = table.insertRow(rowCount);

    alert("rowCount " +rowCount);
    alert("row " +row);
    var colCount = table.rows[0].cells.length;
    for(var i=0; i<colCount; i++) {
      var newcell = row.insertCell(i);
      newcell.innerHTML = table.rows[0].cells[i].innerHTML;
      //alert(newcell.childNodes);
      switch(newcell.childNodes[0].type) {
        case "text":
          newcell.childNodes[0].value = "";
          break;
        case "checkbox":
          newcell.childNodes[0].checked = false;
          break;
        case "select-one":
          newcell.childNodes[0].selectedIndex = 0;
          break;
     }
   }
 }

  </SCRIPT>
 </HEAD>
 <BODY>
 <INPUT type="button" value="Add Row" onclick="addRow('dataTable')" />

   <TABLE id="dataTable" width="350px" border="1">
  <TR>
 <TD><INPUT type="checkbox" name="chk"/></TD>
<TD><INPUT type="text" name="txt"/></TD>
<TD>
 <SELECT name="country">
 <OPTION value="in">India</OPTION>
 <OPTION value="de">Germany</OPTION>
 <OPTION value="fr">France</OPTION>
 <OPTION value="us">United States</OPTION>
<OPTION value="ch">Switzerland</OPTION>
 </SELECT>
</TD>
   </TR>
   </TABLE>
 </BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T20:21:45.423

这可以解决问题

```
 switch(newcell.childNodes[0].type) {
    case "text":
      newcell.childNodes[0].value = "";
      newcell.childNodes[0].id = "input" + rowCount;
      break;
    case "checkbox":
      newcell.childNodes[0].checked = false;
      newcell.childNodes[0].id = "checkbox" + rowCount;      
      break;
    case "select-one":
      newcell.childNodes[0].selectedIndex = 0;
      newcell.childNodes[0].id = "select" + rowCount;       
      break;
 } 
```

[jsFiddle 演示](http://jsfiddle.net/tcCAG/1/)

**编辑**

正如@bfavaretto 所指出的，您需要删除`select`单元格上的前导空格

```
<TD><SELECT name="country">
    <OPTION value="in">India</OPTION>
    <OPTION value="de">Germany</OPTION>
    <OPTION value="fr">France</OPTION>
    <OPTION value="us">United States</OPTION>
    <OPTION value="ch">Switzerland</OPTION>
  </SELECT>
</TD> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:28:14.497

即使知道你没有说你可以使用 jQuery，我还是用它发布了一个解决方案。看一看。

**HTML：**

```
<table>
    <tbody id="tableBody">
    </tbody>
</table> 
```

**JavaScript：**

```
var $tableBody = $( "#tableBody" );

for ( var i = 0; i < 10; i++ ) {
    var $row = $( "<tr></tr>" );
    var $textInput = $( "<input type='text' id='text_" + i + "'/>" );
    var $checkbox = $( "<input type='checkbox' id='check_" + i + "'/><span> Checkbox " + i + "</span>" );
    $row.append( $( "<td></td>" ).append( $textInput ) );
    $row.append( $( "<td></td>" ).append( $checkbox ) );
    $tableBody.append( $row );
} 
```

jsFiddle：http: [//jsfiddle.net/davidbuzatto/C8CRW/](http://jsfiddle.net/davidbuzatto/C8CRW/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:26:07.840

尝试这个：

```
 function setIds() {
        var id = 0;
        for (var i = 0; i < document.getElementsByTagName("input").length; i++) {
            if (document.getElementsByTagName("input")[i].type == "text") {
                document.getElementsByTagName("input")[i].id = "text_" + id;
                id++;
            }

        }
    } 
```

并将其添加到您的第一个函数的末尾。

# sql - 使用 SQL 查询在 Postgresql 中获取函数、序列、类型等的定义

> ID：12148914
> 
> 赞同：28
> 
> 时间：2012-08-27T20:11:43.117
> 
> 标签：sql, postgresql, ddl

我需要 PostgreSQL 数据库对象的创建脚本。

我无权访问 pg_dump。所以我必须使用 SQL 查询来获取所有内容。我怎么能这样做？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-27T20:31:00.287

要获取函数的定义，请使用`pg_get_functiondef()`：

```
select pg_get_functiondef(oid)
from pg_proc
where proname = 'foo'; 
```

检索索引、视图、规则等的定义也有类似的功能。有关详细信息，请参阅手册：[http ://www.postgresql.org/docs/current/static/functions-info.html](http://www.postgresql.org/docs/current/static/functions-info.html)

获取用户类型的定义有点棘手。您将需要查询`information_schema.attributes`：

```
select attribute_name, data_type
from information_schema.attributes
where udt_schema = 'public'
  and udt_name = 'footype'
order by ordinal_position; 
```

从那你需要重新组装`create type`语句。

有关更多详细信息，您需要阅读系统目录的文档：[http ://www.postgresql.org/docs/current/static/catalogs.html](http://www.postgresql.org/docs/current/static/catalogs.html)

但是，如果它们返回相同的信息，您应该更喜欢`information_schema`视图。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-27T22:45:22.183

你会发现[**`psql -E`**](http://www.postgresql.org/docs/current/interactive/app-psql.html)在你寻求这些查询的过程中很有帮助。
它显示`psql`执行其反斜杠命令时使用的查询 - 就像`\df+ myfunc`有关此功能的详细信息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-06-03T23:39:06.687

这是使用 pg_get_functiondef 的完整示例查询：

```
WITH funcs AS (
  SELECT
    n.nspname AS schema
    ,proname AS sproc_name
    ,proargnames AS arg_names
    ,t.typname AS return_type
    ,d.description
    ,pg_get_functiondef(p.oid) as definition
  FROM pg_proc p
    JOIN pg_type t on p.prorettype = t.oid
    JOIN pg_description d on p.oid = d.objoid
    JOIN pg_namespace n on n.oid = p.pronamespace
  WHERE n.nspname = 'some_schema_name_here'
)
SELECT *
FROM funcs
;; 
```

请注意，您显然应该指定架构名称，（如果您使用的是该架构，则为“公共”）

# sql-server - Sql Server 2005 内存分配

> ID：12148917
> 
> 赞同：0
> 
> 时间：2012-08-27T20:11:54.540
> 
> 标签：sql-server, sql-server-2005, memory

如何找出为 SQL Server 2005 分配的最大和最小内存？我的 sql 服务器似乎已经用尽了我盒子上的内存，并且似乎没有进行任何垃圾收集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T23:09:19.537

除非受到来自操作系统的压力，否则 SQL Server 不会释放内存。这是设计使然

阅读这些主题

[http://social.msdn.microsoft.com/Forums/en-US/sqldatabaseengine/thread/90d5422f-c924-4211-9323-7373e9d5ad1f/](http://social.msdn.microsoft.com/Forums/en-US/sqldatabaseengine/thread/90d5422f-c924-4211-9323-7373e9d5ad1f/)

[https://serverfault.com/questions/108192/how-do-i-get-sql-server-to-release-its-memory](https://serverfault.com/questions/108192/how-do-i-get-sql-server-to-release-its-memory)

但是，您可以在 SQL Server 2008 中分配 MAX 内存。我希望 SQL Server 2005 也是如此。右键单击 SSMS 中的服务器实例并转到属性。然后是内存。

通常建议分配 MAX 内存略小于服务器的物理内存。阅读上述线程以获取详细信息。

![在此处输入图像描述](../Images/3f5a5f3ff8c66670bb5b9eb4998ad4b6.png)

# c# - 是否可以将路径转换为形状？

> ID：12148918
> 
> 赞同：1
> 
> 时间：2012-08-27T20:11:55.960
> 
> 标签：c#, wpf

所以我基本上有一个堆栈面板，我正在使用一个 foreach 循环来遍历孩子，所有孩子都是“路径”格式，但有些是线条，有些是椭圆（或者至少在转换为路径之前） )

我的问题是，我怎么知道哪些是直线，哪些是椭圆？，我正在使用 isMouseOver 事件来检查鼠标是否在 Ellipses 上，以使它们在 MouseDown 上相应更改

```
private void GraphPanel_PreviewMouseDown(object sender, MouseButtonEventArgs e)
    {
        foreach (var x in GraphPanel.Children)
        {

                if (((Path)x).IsMouseOver)
                {
                    var converter = new System.Windows.Media.BrushConverter();
                    var brush = (Brush)converter.ConvertFromString("#FFB1D100");
                    ((Path)x).Stroke = brush;
                    ((Path)x).StrokeThickness = 8;
                }
                else
                {

                    ((Path)x).Stroke = Brushes.Black;
                    ((Path)x).StrokeThickness = 4;
                }
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T21:02:00.590

您可以检查[Path.Data](http://msdn.microsoft.com/en-us/library/system.windows.shapes.path.data.aspx)属性的类型，该属性是派生自[Geometry](http://msdn.microsoft.com/en-us/library/system.windows.media.geometry.aspx)的类。

除了一些复杂的几何类型之外，基本的派生几何类型是[EllipseGeometry](http://msdn.microsoft.com/en-us/library/system.windows.media.ellipsegeometry.aspx)、[LineGeometry](http://msdn.microsoft.com/en-us/library/system.windows.media.linegeometry.aspx)和[RectangleGeometry](http://msdn.microsoft.com/en-us/library/system.windows.media.rectanglegeometry.aspx)。

```
Path path = (Path)x;
Geometry geometry = path.Data;
if (geometry is EllipseGeometry)
{
    ...
}
else if (geometry is LineGeometry)
{
    ...
}
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T20:34:07.893

这可能不是最有效的方法，但这是我想出来的

```
if((Path)x).Data.ToString() == "System.Windows.Media.EllipseGeometry"){} 
```

# c# - 时间：2019-01-02 标签：c#mongodb large file inside a document

> ID：12148921
> 
> 赞同：1
> 
> 时间：2012-08-27T20:12:13.150
> 
> 标签：c#, mongodb, gridfs

我不完全确定 GridFS 在 MongoDB 中是如何工作的。我目前看到的所有示例都只涉及抓取文件并通过 api 将其上传到数据库，但我想知道

a) 您可以在典型的 JSON 样式文档中嵌入大文件，还是必须将它们存储在自己特殊的 GridFS 集合或数据库中？

b）我如何处理这种情况，其中我有一个对象，其中有一些典型的字段，字符串整数等，但也有附件文件的集合，可以是从小 txt 文件到相当大的视频文件的任何内容？

例如

```
class bug
{
    public int Id { get; protected set; }
    public string Name { get; protected set; }
    public string Description { get; protected set; }
    public string StackTrace { get; protected set; }
    public List<File> Attachments { get; protected set; } //pictures/videos of the bug in action or text files with user config data in it etc.
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T09:25:56.187

> a) 您可以在典型的 JSON 样式文档中嵌入大文件，还是必须将它们存储在自己特殊的 GridFS 集合或数据库中？

如果文件大小不超过 16mb 的 mongodb 文档大小限制，您可以这样做。但是您将需要序列化/反序列化并自己做另一项额外的工作。

> b）我如何处理这种情况，其中我有一个对象，其中有一些典型的字段，字符串整数等，但也有附件文件的集合，可以是从小 txt 文件到相当大的视频文件的任何内容？

如果您最终决定将附件存储在 mongodb 中，最好使用 gridfs。您可以在 gridfs 中简单地存储文件，但在`Attachments`该文件的集合存储 id 和任何元数据（文件名、大小等）中。然后您可以通过内部附件集合中的 id 轻松获取文件内容。

mongodb gridf 是 mongodb 之上的一个简单层，它可以将大文件拆分为块并将它们存储在 mongodb 中，也可以从块中读取文件。要开始使用 c# 和 gridfs，请阅读[此](https://stackoverflow.com/questions/4988436/mongodb-gridfs-with-c-how-to-store-files-such-as-images/4990536#4990536)答案。

# ruby-on-rails - 在数组中搜索特定项

> ID：12148922
> 
> 赞同：2
> 
> 时间：2012-08-27T20:12:15.227
> 
> 标签：ruby-on-rails, ruby

我有一个对象数组，我需要找到与特定条件匹配的最后一个元素。我试着用 来做`each_reverse`，但结果代码太多了：

```
matching_item = nil

items.reverse_each do |item|
  if (item.type_id == 10)
    matching_item = item
    break
  end
end 
```

有没有可能让它更短？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T20:19:28.953

尝试：

```
matching_item = items.reverse.find{ |i| i.type_id == 10 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:17:57.097

我可能会使用[`Array#select`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-select)并返回最后一场比赛：

```
matching_item = items.select {|i| i.type_id == 10}.last 
```

`.last`如果您决定要所有匹配项，请省略：

```
matching_items = items.select {|i| i.type_id == 10} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:46:43.270

```
items.reverse_each.detect{|item| iterm.type_id == 10}
#or
items[items.rindex{|item| item.type_id == 10}] 
```

# php - 如何获得组中最后一张海报的fbid？（PHP Facebook API）

> ID：12148923
> 
> 赞同：0
> 
> 时间：2012-08-27T20:12:17.473
> 
> 标签：php, facebook, api

我有一个向我的小组发送帖子的脚本。

```
$attachment = array('message' => $message, 'link' => $link );
try 
    $result = $facebook->api("/$sendTo/feed/",'post', $attachment);

} catch (FacebookApiException $e) {
echo "error";
} 
```

$sendTo 保存组的 fbid，

需要添加什么代码以便脚本检查组，如果最后一篇文章（最近的一篇）是由我的 fbid ($myfbid) 发布的，那么不要发布消息？

任何帮助，将不胜感激，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T11:01:36.403

# asp.net - 当 CustomError 设置为“On”或“RemoteOnly”时，运行状况监控不会记录错误

> ID：12148926
> 
> 赞同：2
> 
> 时间：2012-08-27T20:12:40.030
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, health-monitoring

我正在使用 Health Monitoring 来捕获所有错误并将它们发送到电子邮件。虽然它在开发环境中工作，但当我在 Prod 中部署它时却没有。唯一的区别是“customerrors”设置为“on/off”。所以，我再次验证了它，当自定义错误设置为“On/RemoteOnly”时，它似乎不会记录。以下是我有问题的配置的一部分。

这个问题有解决方法吗？谢谢。

```
<healthMonitoring enabled="true">
  <eventMappings>
    <clear />
    <add name="All Errors" type="System.Web.Management.WebBaseErrorEvent"
     startEventCode="0" endEventCode="2147483647" />
  </eventMappings>

  <providers>
    <clear />

    <add
     name="SimpleMailWebEventProvider"
     type="System.Web.Management.SimpleMailWebEventProvider"
     to="dev@net"
     from="de@net"
     buffer="false"
    />
  </providers>

  <rules>
    <clear />

    <add name="All Errors Default" eventName="All Errors" provider="SimpleMailWebEventProvider"
profile="Default" minInstances="1" maxLimit="Infinite" minInterval="00:00:00" />
  </rules>
</healthMonitoring> 
```

--update 这是 MVC3 项目

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T21:44:02.140

在 ASP.NET MVC 3 项目中，您将在`HandleError`默认情况下注册一个全局操作过滤器`global.asax.cs`：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new HandleErrorAttribute());
} 
```

此属性应用于*每个*控制器操作，如果`customErrors`设置为`On`仅显示自定义错误页面，并且控制器操作中发生的异常被标记为已处理。ASP.NET 运行状况监视不再看到此异常并且无法记录它。

[此处](http://weblogs.asp.net/awilinsk/archive/2008/12/11/handleerrorattribute-and-health-monitoring.aspx)、[此处](http://aspnetresources.com/blog/health_monitoring_webforms_vs_mvc)和[此处](http://mattfrear.com/2011/01/28/mvc3-logging-exceptions/)描述了将 Health Monitoring 与`HandleError`属性和自定义错误页面一起使用的方法：

您创建一个派生自以下的自定义错误属性`HandleError`：

```
public class HandleErrorHealthMonitoringAttribute : HandleErrorAttribute
{
    public override void OnException(ExceptionContext filterContext)
    {
        // Do the default, i.e. show custom error page if custom errors are on
        base.OnException(filterContext);

        // Suppress raising the health monitoring event below if custom errors
        // are off. In that case health monitoring will receive the exception
        // anyway and raise the event
        if (!filterContext.HttpContext.IsCustomErrorEnabled)
            return;

        // Raise health monitoring event
        var errorEvent = new GenericWebRequestErrorEvent(
            "Unhandled exception occurred.", this,
            WebEventCodes.WebExtendedBase + 1, filterContext.Exception);

        errorEvent.Raise();
    }
} 
```

然后注册这个属性而不是 default `HandleError`：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new HandleErrorHealthMonitoringAttribute());
} 
```

`GenericWebRequestErrorEvent`是从 base 派生的自定义错误事件`WebRequestErrorEvent`。它不做任何自定义，只存在因为`WebRequestErrorEvent`没有任何`public`构造函数，所以我们不能使用`var errorEvent = new WebRequestErrorEvent(...)`：

```
public class GenericWebRequestErrorEvent : WebRequestErrorEvent
{
    public GenericWebRequestErrorEvent(string message, object eventSource,
        int eventCode, Exception exception) :
        base(message, eventSource, eventCode, exception)
    {
    }

    public GenericWebRequestErrorEvent(string message, object eventSource,
        int eventCode, int eventDetailCode, Exception exception) :
        base(message, eventSource, eventCode, eventDetailCode, exception)
    {
    }
} 
```

请注意，您将收到一封标题为`MyNamespace.GenericWebRequestErrorEvent`而不是的电子邮件，`System.Web.Management.WebRequestErrorEvent`并且事件代码将始终为`100001`(= `WebEventCodes.WebExtendedBase + 1`)。

# mobile - Code 不适用于 Safari 手机

> ID：12148933
> 
> 赞同：0
> 
> 时间：2012-08-27T20:13:22.480
> 
> 标签：mobile, vector, svg

我的 SVG 图像有问题。

以下代码适用于所有浏览器，但不适用于 safari mobile。（我使用IOS模拟器）。

你知道为什么吗？我没有找到解决方案，因为我见过的所有其他图像都使用相同的语法。

```
 <svg version="1.1" id="logo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
     width="150px" height="125px" viewBox="0 0 150 125" enable-background="new 0 0 150 125" xml:space="preserve">
<path fill="none" stroke="#E26161" d="M1.295,1"/>
<path fill="none" stroke="#E26161" d="M1.295,125"/>
<path fill="none" stroke="#000000" d="M-9.681-16.75"/>
<path fill="none" stroke="#000000" d="M93.751,21.722"/>
<path fill="none" stroke="#000000" d="M151.887,123.541"/>
<path fill="none" stroke="#000000" d="M77.072,62.437"/>
<path fill="none" stroke="#000000" d="M2.328,1.391"/>
<path fill="none" stroke="#E26161" d="M77.072,62.437"/>
<path fill="none" stroke="#E26161" d="M1.295,0.667"/>
<line fill="none" stroke="#E26161" x1="149.043" y1="125" x2="149.043" y2="0"/>
<line fill="none" stroke="#E26161" x1="75.022" y1="62.5" x2="149.043" y2="0"/>
<line fill="none" stroke="#111111" x1="1" y1="124.938" x2="75.022" y2="62.437"/>
<line fill="none" stroke="#E26161" x1="1" y1="0" x2="75.28" y2="62.906"/>
<line fill="none" stroke="#E26161" x1="1" y1="125" x2="1" y2="0"/>
</svg> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T04:32:36.327

看起来你`U+200B`在结束时有一个隐形字符`</svg>`。删除它，它应该可以工作。

# java - 我将如何使用 GSON（多维数组）解码这个 JSON？

> ID：12148935
> 
> 赞同：3
> 
> 时间：2012-08-27T20:13:57.550
> 
> 标签：java, android, json, gson

我正在使用 GSON 解码从我们的服务器返回的 JSON 字符串。我没有遇到任何问题，直到我遇到了来自 API 的这个特定的 JSON 返回。返回格式如下：

**"成功":1,"错误":[],"数据":{"524":{"id":"524"}, "525":{"id":"525"}}**

对于其他返回，我将数据作为我自己创建的类的数组，但对于这个返回，它表示它是一个对象而不是数组。那么我应该如何格式化我的课程呢？

***编辑：我遇到的问题是“524”和“525”字段不是静态名称。它们取决于用户的凭据是什么。可能有字段 323、324、325 或单个字段 123。这完全取决于。我将如何动态处理这个问题？

**已解决*** 我必须`<String, Object>`在我的自定义类中将“数据”设为哈希图。然后在第一次解码之后，我把“数据”变成了一个 Object [] 类型的数组。然后对于每个 Object[i]，我将其转换为 JSON 字符串。之后，我使用 gson.fromJson() 将其转换为我最初想要的样子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:22:03.160

如果 API 给出的结果不一致，而您最终找不到这样做的原因，则一种选择是将对象解析为 GSON `JSONObject o = gson.fromJson(String)`，然后将数据转换为列表（如果它不是一个列表）`o.getElement("data").isList()`， ETC..

完成后，您可以通过`gson.fromJson(JSONObject,Class)`. 另一种方法是有两个类，每个实例一个，但如果这是拥有两个不同类的唯一原因，这似乎很草率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:27:57.477

GSON 是正确的。来自服务器的回复`data`是对象，其中两个成员也是对象。要成为数组`data`应该有方括号`[]`而不是花括号`{}`。更多关于 JSON 格式[的信息在这里](http://www.json.org/)。

服务器格式已更改，或者您尝试了另一个 API 版本，或者有人在服务器端犯了错误。

# php - PHP 毫米 (mm) 到英寸 (in) 和千克 (kg) 到 磅 (lb) 转换

> ID：12148937
> 
> 赞同：2
> 
> 时间：2012-08-27T20:14:05.833
> 
> 标签：php

嗨，我正在尝试将毫米 (mm) 转换为英寸 (in)，将千克 (kg) 转换为磅 (lb) 在 PHP 中转换。有什么功能可以做到这一点吗？我该怎么做？谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-27T20:18:18.470

您可以非常轻松地编写自己的函数。

```
function mmToIn ($val) {
  return $val * 0.0393701
}

function kgToLb ($val) {
  return $val * 2.20462
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:21:18.017

我认为您需要为这些操作编写自己的代码（因为我从未听说过任何内置函数可以执行您想要的操作）。

第一：[https ://www.google.com/search?q=mmimeter+to+inches](https://www.google.com/search?q=millimeter+to+inches)

第二：

```
function mil_to_inc($mil) {
   $inc = 0.0393700787;
   return $mil * $inc;
}

// example
$_5_mil_to_inc = mil_to_inc(5); // will give you 0.196850394 etc.. 
```

# mysql - 使用文件排序的 MYSQL 性能变慢

> ID：12148943
> 
> 赞同：17
> 
> 时间：2012-08-27T20:14:49.453
> 
> 标签：mysql, performance, database-performance, filesort

我有一个简单的 mysql 查询，但是当我有很多记录（当前为 103,0000）时，性能真的很慢，它说它正在使用文件排序，我不确定这是否是它很慢的原因。有没有人有任何建议来加快它？或使用文件排序停止它？

MYSQL 查询：

```
SELECT *    
FROM adverts
WHERE (price >= 0)
    AND (status = 1)
    AND (approved = 1)
ORDER BY date_updated DESC 
LIMIT 19990, 10 
```

解释结果：

```
id   select_type   table   type    possible_keys    key    key_len    ref    rows   Extra 
1    SIMPLE        adverts range   price            price  4          NULL   103854 Using where; Using filesort 
```

这是广告表和索引：

```
CREATE TABLE `adverts` (
  `advert_id` int(10) NOT NULL AUTO_INCREMENT,
  `user_id` int(10) NOT NULL,
  `type_id` tinyint(1) NOT NULL,
  `breed_id` int(10) NOT NULL,
  `advert_type` tinyint(1) NOT NULL,
  `headline` varchar(50) NOT NULL,
  `description` text NOT NULL,
  `price` int(4) NOT NULL,
  `postcode` varchar(7) NOT NULL,
  `town` varchar(60) NOT NULL,
  `county` varchar(60) NOT NULL,
  `latitude` float NOT NULL,
  `longitude` float NOT NULL,
  `telephone1` varchar(15) NOT NULL,
  `telephone2` varchar(15) NOT NULL,
  `email` varchar(80) NOT NULL,
  `status` tinyint(1) NOT NULL DEFAULT '0',
  `approved` tinyint(1) NOT NULL DEFAULT '0',
  `date_created` datetime NOT NULL,
  `date_updated` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `expiry_date` datetime NOT NULL,
  PRIMARY KEY (`advert_id`),
  KEY `price` (`price`),
  KEY `user` (`user_id`),
  KEY `type_breed` (`type_id`,`breed_id`),
  KEY `headline_keywords` (`headline`),
  KEY `date_updated` (`date_updated`),
  KEY `type_status_approved` (`advert_type`,`status`,`approved`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-27T20:20:59.707

问题是 MySQL 在执行查询时只使用一个索引。如果您在`WHERE`子句中添加一个使用 3 个字段的新索引，它将更快地找到行。

```
ALTER TABLE `adverts` ADD INDEX price_status_approved(`price`, `status`, `approved`); 
```

根据 MySQL 文档[ORDER BY Optimization](http://dev.mysql.com/doc/refman/5.5/en/order-by-optimization.html)：

> 在某些情况下，MySQL 不能使用索引来解析 ORDER BY，尽管它仍然使用索引来查找与 WHERE 子句匹配的行。这些情况包括：
> 用于获取行的键与 ORDER BY 中使用的键不同。

这就是你的情况。正如 的输出`EXPLAIN`告诉我们的那样，优化器使用键`price`来查找行。但是，`ORDER BY`是在`date_updated`不属于 key 的字段上`price`。

要更快地找到行并更快地对行进行排序，您需要添加一个索引，其中包含子句`WHERE`中使用的所有字段和`ORDER BY`子句：

```
ALTER TABLE `adverts` ADD INDEX status_approved_date_updated(`status`, `approved`, `date_updated`); 
```

用于排序的字段必须位于索引中的最后一个位置。包含`price`在索引中是没有用的，因为查询中使用的条件会返回一个范围的值。

如果`EXPLAIN`仍然显示它正在使用文件排序，您可以尝试强制 MySQL 使用您选择的索引：

```
SELECT adverts.*
FROM adverts
FORCE INDEX(status_approved_date_updated)
WHERE price >= 0
AND adverts.status = 1
AND adverts.approved = 1
ORDER BY date_updated DESC 
LIMIT 19990, 10 
```

通常不需要强制索引，因为 MySQL 优化器通常会做出正确的选择。但有时它会做出错误的选择，或者不是最佳选择。您将需要运行一些测试以查看它是否提高了性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T21:26:34.423

删除周围的刻度`'0'`- 它目前可能会阻止使用索引，但我不确定。尽管如此，它还是更好的风格，因为价格是`int`类型而不是字符列。

```
SELECT adverts .*    
FROM adverts
WHERE (
price >= 0
)
AND (
adverts.status = 1
)
AND (
adverts.approved = 1
)
ORDER BY date_updated DESC 
LIMIT 19990 , 10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T22:04:06.943

您的`WHERE`条件使用`price`, `status`,`approved`进行选择，然后`date_updated`用于排序。

所以你需要一个**包含**这些字段的索引；我建议按此顺序对 , 和 ,`approved`进行索引`status`。`price``date_updated`

一般规则是首先放置 WHERE 等式，然后是范围（大于、小于或等于、介于等），最后对字段进行排序。（请注意，省略一个字段可能会降低索引的可用性，甚至无法用于此目的）。

```
CREATE INDEX advert_ndx ON adverts (approved, status, price, date_updated); 
```

这样，只有在发挥了`LIMIT`它的魔力之后才需要访问表数据，并且您只会缓慢检索少量记录。

我还将删除任何不需要的索引，这将加速`INSERT`s 和`UPDATE`s。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T20:37:24.270

MySQL 不使用键`date_updated`进行排序，而只是使用在子句中使用的`price`键。`WHERE`您可以尝试使用索引提示：

[http://dev.mysql.com/doc/refman/5.1/en/index-hints.html](http://dev.mysql.com/doc/refman/5.1/en/index-hints.html)

添加类似的东西

```
USE KEY FOR ORDER BY  (date_updated) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-27T21:46:07.003

我有两个建议。首先，删除 where 子句中零周围的引号。那行应该是：

```
price >= 0 
```

其次，创建这个索引：

```
CREATE INDEX `helper` ON `adverts`(`status`,`approved`,`price`,`date_created`); 
```

这应该允许 MySQL 仅使用索引来查找 LIMIT 子句指定的 10 行。Filesort 本身并不是一件坏事……需要处理的行数是。

# ruby-on-rails - 调用 active_record 错误 - 无法在 Ruby on Rails 中加载文件

> ID：12148945
> 
> 赞同：1
> 
> 时间：2012-08-27T20:14:52.257
> 
> 标签：ruby-on-rails, ruby, oracle

当我尝试运行时`rails generate scaffold test`，总是显示以下错误

```
C:\Lab\railapps\dbtest>rails generate scaffold test
      invoke  active_record
C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `require': Please install the oracle_enhanced_adapter: `gem install activerecord-oracle_enhanced-adapter` (cannot load such file -- active_record/connection_adapters/oracle_enhanced_adapter) (LoadError)
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport-3.2.1/lib/active_support/dependencies.rb:251:in `block in require'" 
```

我当时确实安装了`oci8`gem `activerecord-oracle-enhanced-adapter`。你能帮我看看吗？非常感谢。

版本信息

```
C:\Lab\railapps\dbtest>gem list ruby-oci8

*** LOCAL GEMS ***

ruby-oci8 (2.1.2 ruby x86-mingw32, 2.0.6) 
```

C:\Lab\railapps\dbtest>gem list activerecord-oracle_enhanced-adapter

```
*** LOCAL GEMS ***

activerecord-oracle_enhanced-adapter (1.4.1) 
```

配置下的database.yml

```
development:
  adapter: oracle_enhanced
  database: cvrman.cablevision.com
  username: ruby
  password: ruby 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:36:44.170

我的猜测是`activerecord-oracle_enhanced-adapter`并且`oci8`不在您的 Gemfile 中。Ruby on Rails 现在默认使用[Bundler](http://gembundler.com/)来管理依赖项。

尝试添加以下行：

```
 gem "activerecord-oracle_enhanced-adapter"
   gem "oci8" 
```

到您的 Gemfile（位于项目目录的根目录）并运行`bundle install`. 然后尝试构建你的脚手架。

# javascript - 如何解压缩（解压缩）NodeJS 请求的模块 gzip 响应正文？

> ID：12148948
> 
> 赞同：75
> 
> 时间：2012-08-27T20:15:11.823
> 
> 标签：javascript, node.js, express, zlib

如何在请求的模块响应中解压缩压缩后的正文？

我在网上尝试了几个例子，但似乎没有一个有效。

```
request(url, function(err, response, body) {
    if(err) {
        handleError(err)
    } else {
        if(response.headers['content-encoding'] == 'gzip') {    
            // How can I unzip the gzipped string body variable?
            // For instance, this url:
            // http://highsnobiety.com/2012/08/25/norse-projects-fall-2012-lookbook/
            // Throws error:
            // { [Error: incorrect header check] errno: -3, code: 'Z_DATA_ERROR' }
            // Yet, browser displays page fine and debugger shows its gzipped
            // And unzipped by browser fine...
            if(response.headers['content-encoding'] && response.headers['content-encoding'].toLowerCase().indexOf('gzip') > -1) {   
                var body = response.body;                    
                zlib.gunzip(response.body, function(error, data) {
                    if(!error) {
                        response.body = data.toString();
                    } else {
                        console.log('Error unzipping:');
                        console.log(error);
                        response.body = body;
                    }
                });
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-10-08T07:07:32.830

我也无法获得工作请求，因此最终改用 http。

```
var http = require("http"),
    zlib = require("zlib");

function getGzipped(url, callback) {
    // buffer to store the streamed decompression
    var buffer = [];

    http.get(url, function(res) {
        // pipe the response into the gunzip to decompress
        var gunzip = zlib.createGunzip();            
        res.pipe(gunzip);

        gunzip.on('data', function(data) {
            // decompression chunk ready, add it to the buffer
            buffer.push(data.toString())

        }).on("end", function() {
            // response and decompression complete, join the buffer and return
            callback(null, buffer.join("")); 

        }).on("error", function(e) {
            callback(e);
        })
    }).on('error', function(e) {
        callback(e)
    });
}

getGzipped(url, function(err, data) {
   console.log(data);
}); 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-10-11T13:20:30.853

尝试添加`encoding: null`您传递给的选项`request`，这将避免将下载的正文转换为字符串并将其保存在二进制缓冲区中。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-09-26T18:20:50.080

就像@Iftah 说的那样，设置`encoding: null`.

完整示例（更少的错误处理）：

```
request = require('request');
zlib = require('zlib');

request(url, {encoding: null}, function(err, response, body){
    if(response.headers['content-encoding'] == 'gzip'){
        zlib.gunzip(body, function(err, dezipped) {
            callback(dezipped.toString());
        });
    } else {
        callback(body);
    }
}); 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2016-07-26T06:29:49.957

实际上 request 模块处理 gzip 响应。为了告诉请求模块解码回调函数中的body参数，我们必须在选项中将'gzip'设置为true。让我用一个例子来解释一下。

## 例子：

```
var opts = {
  uri: 'some uri which return gzip data',
  gzip: true
}

request(opts, function (err, res, body) {
 // now body and res.body both will contain decoded content.
}) 
```

注意：您在“响应”事件中获得的数据不会被解码。

这对我有用。希望它也适用于你们。

我们在使用请求模块时经常遇到的类似问题是 JSON 解析。让我解释一下。如果您希望请求模块自动解析正文并在正文参数中为您提供 JSON 内容。然后你必须在选项中将 'json' 设置为 true。

```
var opts = {
  uri:'some uri that provides json data', 
  json: true
} 
request(opts, function (err, res, body) {
// body and res.body will contain json content
}) 
```

参考：[https ://www.npmjs.com/package/request#requestoptions-callback](https://www.npmjs.com/package/request#requestoptions-callback)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-05-02T16:46:41.813

如[https://gist.github.com/miguelmota/9946206](https://gist.github.com/miguelmota/9946206)所示：

截至 2017 年 12 月，request 和 request-promise 都开箱即用地处理它：

```
var request = require('request')
  request(
    { method: 'GET'
    , uri: 'http://www.google.com'
    , gzip: true
    }
  , function (error, response, body) {
      // body is the decompressed response body
      console.log('server encoded the data as: ' + (response.headers['content-encoding'] || 'identity'))
      console.log('the decoded data is: ' + body)
    }
  ) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-05-28T02:42:44.553

在尝试了不同的 gunzip 方法并解决了与编码有关的错误后，我制定了一个更[完整的答案。](http://samwize.com/2014/05/27/node-dot-js-request-module-with-gzip-slash-gunzip/)

希望这对您也有帮助：

```
var request = require('request');
var zlib = require('zlib');

var options = {
  url: 'http://some.endpoint.com/api/',
  headers: {
    'X-some-headers'  : 'Some headers',
    'Accept-Encoding' : 'gzip, deflate',
  },
  encoding: null
};

request.get(options, function (error, response, body) {

  if (!error && response.statusCode == 200) {
    // If response is gzip, unzip first
    var encoding = response.headers['content-encoding']
    if (encoding && encoding.indexOf('gzip') >= 0) {
      zlib.gunzip(body, function(err, dezipped) {
        var json_string = dezipped.toString('utf-8');
        var json = JSON.parse(json_string);
        // Process the json..
      });
    } else {
      // Response is not gzipped
    }
  }

}); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-04-11T14:29:53.237

这是我的两分钱。我遇到了同样的问题，并找到了一个很酷的库，名为`concat-stream`：

```
let request = require('request');
const zlib = require('zlib');
const concat = require('concat-stream');

request(url)
  .pipe(zlib.createGunzip())
  .pipe(concat(stringBuffer => {
    console.log(stringBuffer.toString());
  })); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-02-21T07:58:22.633

这是一个对响应进行压缩的工作示例（使用 node 的请求模块）

```
function gunzipJSON(response){

    var gunzip = zlib.createGunzip();
    var json = "";

    gunzip.on('data', function(data){
        json += data.toString();
    });

    gunzip.on('end', function(){
        parseJSON(json);
    });

    response.pipe(gunzip);
} 
```

完整代码：[https ://gist.github.com/0xPr0xy/5002984](https://gist.github.com/0xPr0xy/5002984)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-02-13T22:09:19.873

我正在使用节点获取。我得到了`response.body`，我真正想要的是`await response.text()`。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-05-06T10:41:03.740

使用替代方法[`got`](https://github.com/sindresorhus/got)，`request`您可以简单地执行以下操作：

```
got(url).then(response => {
    console.log(response.body);
}); 
```

需要时会自动处理解压缩。

# python - 尝试使用 django 美味派发帖时出现 404 错误

> ID：12148954
> 
> 赞同：1
> 
> 时间：2012-08-27T20:15:30.123
> 
> 标签：python, django, tastypie

这是我的 api.py

```
# myapp/api.py

from django.contrib.auth.models import User
from tastypie.authorization import Authorization
from tastypie import fields
from tastypie.resources import ModelResource, ALL, ALL_WITH_RELATIONS
from links.models import Link

class UserResource(ModelResource):

    class Meta:
        queryset = User.objects.all()
        resource_name = 'users'
        excludes = ['email', 'password', 'is_active', 'is_staff', 'is_superuser']
        allowed_methods = ['post','get']
        fields = ['username']

        def obj_create(self, bundle, request=None, **kwargs):
            try:
                bundle = super(CreateUserResource, self).obj_create(bundle, request, **kwargs)
                bundle.obj.set_password(bundle.data.get('password'))
                bundle.obj.save() 
            except IntegrityError:
                raise BadRequest('That username already exists')
            return bundle 
```

在 python shell 上输入：

```
 r = requests.post("http://localhost:8000/api/users/username=Puck") 
```

并得到 404 作为错误响应。如何使用帖子创建新用户？

网址.py

```
from django.conf.urls import patterns, include, url
from django.conf.urls.defaults import *
from links.api import LinkResource
from links.api import UserResource
from tastypie.api import Api
# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

v1_api = Api(api_name='v1')
v1_api.register(UserResource())
v1_api.register(LinkResource())

urlpatterns = patterns('',
    # Examples:

    # Uncomment the admin/doc line below to enable admin documentation
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
    url(r'^admin/', include(admin.site.urls)),
     (r'^api/', include(v1_api.urls)),
) 
```

网址架构：

```
^admin/
^api/ ^(?P<api_name>v1)/$ [name='api_v1_top_level']
^api/ ^(?P<api_name>v1)/ ^(?P<resource_name>link)/$ [name='api_dispatch_list']
^api/ ^(?P<api_name>v1)/ ^(?P<resource_name>link)/schema/$ [name='api_get_schema']
^api/ ^(?P<api_name>v1)/ ^(?P<resource_name>link)/set/(?P<pk_list>\w[\w/;-]*)/$ [name='api_get_multiple']
^api/ ^(?P<api_name>v1)/ ^(?P<resource_name>link)/(?P<pk>\w[\w/-]*)/$ [name='api_dispatch_detail']
^api/ ^(?P<api_name>v1)/ ^(?P<resource_name>users)/$ [name='api_dispatch_list']
^api/ ^(?P<api_name>v1)/ ^(?P<resource_name>users)/schema/$ [name='api_get_schema']
^api/ ^(?P<api_name>v1)/ ^(?P<resource_name>users)/set/(?P<pk_list>\w[\w/;-]*)/$ [name='api_get_multiple']
^api/ ^(?P<api_name>v1)/ ^(?P<resource_name>users)/(?P<pk>\w[\w/-]*)/$ [name='api_dispatch_detail']
The current URL, api/v1/users/username=Puck, didn't match any of these. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:39:48.340

您要访问的网址是：

```
http://localhost:8000/api/v1/users/?username=Puck 
```

既然你声明了`api_name='v1'`.

# wordpress - 在 wordpress 中删除帖子后保留自定义字段

> ID：12148964
> 
> 赞同：0
> 
> 时间：2012-08-27T20:16:13.540
> 
> 标签：wordpress, custom-post-type

我创建了一些自定义字段，以便更轻松地将特定列表项添加到 wordpress 中的某个部分，然后我删除了帖子并且自定义字段消失了。

有谁知道在删除他们创建**的原始帖子后如何保留自定义字段？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T09:39:48.077

您应该使用自定义元框。
在此您可以指定您的值，以便每个帖子都可以访问这些值：
[http ://codex.wordpress.org/Function_Reference/add_meta_box](http://codex.wordpress.org/Function_Reference/add_meta_box)

# c++ - C++ 中的 goto 和 RAII

> ID：12148965
> 
> 赞同：6
> 
> 时间：2012-08-27T20:16:27.800
> 
> 标签：c++, goto

> **可能重复：**
> [转到块外：是否调用析构函数？](https://stackoverflow.com/questions/3179936/goto-out-of-a-block-do-destructors-get-called)

我知道 C 和 C++ 中的 goto 运算符在几乎所有情况下都是无用的，但我只想通过兴趣知道这个问题的答案，它没有实际意义。

C++ 标准是否保证在这种情况下必须正确调用对象的析构函数？

```
#include <iostream>

class Foo
{
public:
   Foo() { std::cout << "Foo::Foo() \n"; }
   ~Foo() { std::cout << "Foo::~Foo() \n"; }
};

int main()
{
   {
      std::size_t i = 0;
      _1:
      Foo instance;
      if (!++i)
      {
         goto _1;
      }
   }

   {
      Foo instance;
      goto _2;
   }

   _2:
   ;
} 
```

[http://liveworkspace.org/code/06031e6​​699c8fddda94b8594ccab1387](http://liveworkspace.org/code/06031e6699c8fddda94b8594ccab1387)

goto 和 C++ RAII 的其他 stange 情况呢？

如果您可以在此处发布 C++ 标准的引用，那将是非常酷的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T20:19:53.350

是的。自动对象保证在超出范围时被破坏。使用退出范围这一事实`goto`对此规则没有影响。

我能想到的唯一不成立的情况是，如果使用[std::longjmp](http://en.cppreference.com/w/cpp/utility/program/longjmp)退出范围（在这种情况下，如果有任何带有析构函数的对象，行为是未定义的）。

# n3376

## 6.6 跳转语句：[stmt.jump]

### 第 2 段

> 从范围退出时（无论如何完成），已在该范围内构建的具有自动存储持续时间 (3.7.3) 的对象将按其构建的相反顺序销毁。[注：对于临时性，见 12.2。—end note] 转移出循环，转移出块，**或返回具有自动存储持续时间的初始化变量**涉及销毁具有自动存储持续时间的对象，这些对象在转移点范围内但不在转移点范围内. （参见 6.7 中的转移到块）。[注意：但是，可以终止程序（例如，通过调用 std::exit() 或 std::abort() (18.5)）而不会破坏具有自动存储持续时间的类对象。——尾注]

# php - 包括选择性地还是全局地？

> ID：12148966
> 
> 赞同：1
> 
> 时间：2012-08-27T20:16:29.353
> 
> 标签：php, performance, include, server-side-includes

带着这个问题，我的目标是更好地理解 PHP 的内部工作原理。

假设您有一个 50K 的库。该库加载了一堆方便的函数，您可以在这里和那里使用。还假设您网站的 10% 的页面需要/使用这些功能。但是您的主页肯定需要它。

现在，问题是......您是否应该使用指向该库的全局包含 - 全面 - 以便所有页面（包括不需要库的 90% ）都可以获得它，或者您是否应该有选择地添加仅包括您需要的页面上的参考？

在回答这个问题之前，让我指出“为什么”我问这个问题......

当您包含该引用时，PHP 可能正在缓存它。所以我担心的性能打击可能是一次性的，而不是每次。一旦那*一次*不碍事，后续的负载可能不会像人们想象的那么糟糕。这完全是因为 PHP 部署的智能缓存机制——我对此并不深入了解，因此问题......

既然首页无论如何都需要那个库，那么为什么不让那个库在记忆中保持**温暖和新鲜**，并让它全面服务呢？

在回答这个问题时，请严格从缓存/性能的角度来处理这个问题，而不是从方便的角度来避免讨论转向编程风格和注意事项。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:21:48.407

我非常感谢您对性能的担忧。

简短的回答是，为了获得最佳性能，我可能有条件地将文件仅包含在需要它的页面上。

PHP 的操作码缓存将以缓存形式维护两个包含文件，因此您不必担心在使用其他类型的缓存时保持缓存“温暖”。缓存将一直保留，直到存在内存限制（不是 50K 脚本的问题）、更新源文件、手动清除缓存或重新启动服务器。

也就是说，操作码（PHP 字节码）缓存只是 PHP 解析过程的一部分。每次运行脚本时，都会处理字节码以构建在脚本中定义和可选使用的函数、类、对象和其他实例变量。这一切加起来。

在这种情况下，一个简单的更改就可以显着提高性能。保持绿色，每个周期都很重要:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:21:00.183

测量一下，你就知道了。

缓存在第一次命中后可能会受益，因为操作系统也会缓存它，但只保存 I/O 命中（当然，这不是什么）。但是，您仍然会受到处理的影响。如果您将 50K 的代码包含在“Hello World”页面中，即使您不执行任何代码，您仍然会为加载和解析这 50K 的源代码付出 CPU 和内存的代价。这部分处理很可能不会以任何方式缓存。

总的来说，今天的 CPU 非常便宜，因此它可能不“值得保存”。但这就是为什么您需要实际测量它，以便您自己决定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:27:29.207

我认为您所指的缓存是来自 APC 之类的操作码缓存？所做的只是防止 PHP 每次都需要解释源代码。您仍然会为您正在使用的每个包含或要求受到一些打击。一种范例是废弃程序函数并使用通过`__autoload()`. 这为大型应用程序提供了一种简单的按需使用策略。也同意威尔的观点，如果您担心，您应该衡量这一点。过早的优化永远不会有帮助。

# c - 全局变量似乎不占用任何内存空间

> ID：12148967
> 
> 赞同：7
> 
> 时间：2012-08-27T20:16:34.803
> 
> 标签：c, memory, global-variables

我想准确了解全局变量在我的程序中的存储位置。在堆栈上？在堆上？别的地方？

所以为此我写了这个小代码：

```
int global_vector[1000000];
int main () {
    global_vector[0] = 1; // just to avoid a compilation warning
    while(true); // to give me time to check the amount of RAM used by my program
    return 0;
} 
```

无论我做多大`global_vector`，该程序只使用非常少量的 RAM。我不明白这是为什么。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T20:18:59.967

这完全取决于实现，但通常全局变量存储在与堆栈和堆分开的特殊内存段中。该内存可以作为可执行文件本身内部的固定大小缓冲区分配，也可以分配在操作系统启动时分配给程序的段中。

您没有看到内存使用量上升的原因可能与操作系统如何处理虚拟内存有关。作为优化，除非您实际使用它，否则操作系统实际上不会为该巨型阵列的程序提供任何内存。尝试将程序更改为对数组的全部内容进行 for 循环，看看这是否会导致 RAM 使用率上升。（编译器中的优化器也有可能正在消除巨大的数组，因为它几乎完全未被使用。放置一个循环来读取/写入所有值也可能会迫使编译器保留它）。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-27T20:18:31.307

优化器可能会完全删除数组，因为您从不使用它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-27T20:34:28.360

没有给定显式初始化程序的全局变量（例如本例中的您的变量）默认初始化为 0。它们被放置在称为[.bss 段](http://en.wikipedia.org/wiki/.bss)的内存区域中，并且没有额外的数据存储在目标文件/可执行文件中，指示数据的初始值（与显式初始化的数据不同，它的初始值必须存储在某处） .

When the OS loads the program, it reads in the descriptions of all of the segments and allocates memory for that. Since it knows that the .bss segment is initialized to all 0's, it can do a sneaky trick to avoid having to actually allocate tons of memory and then initialize it to all 0's: it allocates *address space* for the segment in the process's page table, but all of the pages point to the same page, filled with 0's.

That single zero-page is also set to read-only. Then, if and when the process writes to some data in the .bss segment, a page fault occurs. The OS intercepts the page fault, figures out what's going on, and then actually allocates unique memory for that page of data. It then restarts the instruction, and the code continues on its merry way as if the memory had been allocated all along.

So, the end result is that if you have a zero-initialized global variable or array, each page-sized chunk of data (typically 4 KB) that never gets written to will never actually have memory allocated for it.

Note: I'm being a little fuzzy here with the word "allocated". If you dig into this sort of thing, you're likely to encounter words such as "reserved" and "committed". See [this question](http://en.wikipedia.org/wiki/.bss) and [this page](http://msdn.microsoft.com/en-us/library/ms810627.aspx) for more info on those terms in the context of Windows.

# html - 用于错误报告的 XML / HTML 电子邮件模板

> ID：12148971
> 
> 赞同：0
> 
> 时间：2012-08-27T20:17:00.293
> 
> 标签：html, xml, vb.net, templates

我想创建一个带有占位符的 XML 或 HTML 模板，以便在发生异常时在运行时交换异常报告变量。我喜欢到目前为止我所拥有的模板和行为，但目前它们都是硬编码的，太糟糕了。

这是我拥有的代码示例...

```
'Styling (Outlook does not follow CSS standards >:-( )
body = "<html><head>" & _
        "<style type=""text/css"">" & _
        "   * {font:12px Arial, Helvetica, sans-serif;}" & _
        "   table {border-collapse:collapse;}" & _
        "   table.grid td {padding:0 7px;border:solid #ccc 1px;}" & _
        "   .bold {font-weight:bold;padding-right:12px;}" & _
        "</style></head><body>"

'Partial template
body &= "<table><tr><td class=""bold"">Error:</td><td>" & ex.Message & "</td></tr>" & _
        "<tr><td class=""bold"">Exception:</td><td>" & ex.GetType().FullName & "</td></tr>" & _
        "<tr><td class=""bold"">Source:</td><td>" & ex.Source & "</td></tr>" & _
        "<tr><td class=""bold"">Request Url:</td><td>" & Request.Url.ToString & "</td></tr></table><br />" 
```

注意`ex.Message`变量等。我想将所有 HTML 代码与每个错误变量的占位符一起移动到一个单独的文件中（XML 或 HTML，取决于推荐的内容，XML 我想像？）。然后加载模板，替换变量并即时发送电子邮件。这样做的最佳做法是什么？

*另外，请不要尝试修复我的 CSS，这不是这个问题的目的。Outlook 不遵循标准（看图），这就是我必须这样做的方式。*

谢谢。;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:39:11.740

我认为你几乎是在正确的道路上。步骤是：

*   将模板提取到资源文件中（资源扩展名为 .xml，.html 是实际的资源类型）。
*   用标记替换变量连接；所以会是：（...）`<tr><td class="bold">Source:</td><td>{exSource}</td></tr>`（...）
*   为 String 对象创建一个扩展方法以“增强” `String.Format`，因此您可以执行类似的操作

    ```
    ' Load the resourceFile and put content into formattedBody
    Dim formattedBody as String = templateBody.FormatWith(New With{.exSource = ex.Source}) 
    ```

关于如何实现的`FormatWith`，请看[这里](http://james.newtonking.com/archive/2008/03/29/formatwith-2-0-string-formatting-with-named-variables.aspx)。这个[答案](https://stackoverflow.com/a/159126/666104)也可能对您有所帮助。

# c++ - 在 Qt Gui 中如何让按钮在每次点击时随机出现

> ID：12148975
> 
> 赞同：0
> 
> 时间：2012-08-27T20:17:32.043
> 
> 标签：c++, qt

好吧，有什么方法可以让这个程序在每次单击按钮时随机更改变量 x 和 y 我是编程新手...

```
#include <QtGui/QApplication>
#include "mainwindow.h"
#include <QtGUI>
#include <QWidget>
#include <cstdlib>
#include <ctime>
int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    QWidget *window = new QWidget;

    srand(time(0));
    int x = 1+(rand()%900);
    int y = 1+(rand()%400);

    QPushButton *MainInter = new QPushButton("Push me!",window);

    QPropertyAnimation *animation = new QPropertyAnimation(MainInter, "pos");
    animation->setDuration(0);
    animation->setEndValue(QPoint(x,y));

    Object::connect(MainInter,SIGNAL(released()),animation,SLOT(start()));

    window->resize(900,500);
    window->show();

    return a.exec();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:46:09.393

您可以做的是，您可以创建自己的自定义 SLOT ，而不是`released()`将按钮的信号直接连接到动画SLOT。`start()`然后将按钮连接到它，处理动作并调用动画。

首先阅读如何创建自定义 QWidget，而不是在`main()`. [简单的例子在这里](http://zetcode.com/gui/qt4/customwidget/)

自定义小部件可能如下所示：

**小部件.h**

```
#ifndef WIDGET_H
#define WIDGET_H

#include <QWidget>

class QPushButton;
class QPropertyAnimation;

class MyWidget : public QWidget
{
    Q_OBJECT
public:
   MyWidget(QWidget *parent = 0);

private:
    QPushButton *button;
    QPropertyAnimation *animation;

public slots:
    void randomizeAnim();
};

#endif // WIDGET_H 
```

**小部件.cpp**

```
#include "widget.h"
#include <QPushButton>
#include <QPropertyAnimation>
#include <ctime>

MyWidget::MyWidget(QWidget *parent) :
    QWidget(parent)
{
    button = new QPushButton("Push me!", this);
    animation = new QPropertyAnimation(button, "pos");
    animation->setDuration(0);

    QObject::connect(button, SIGNAL(released()), this, SLOT(randomizeAnim()));
}

void MyWidget::randomizeAnim()
{
    srand(time(0));
    int x = 1+(rand()%900);
    int y = 1+(rand()%400);

    animation->setEndValue(QPoint(x,y));
    animation->start();

} 
```

现在您`main.cpp`可以简化为样板代码：

```
#include <QApplication>
#include "widget.h"

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    QWidget *window = new MyWidget;
    window->resize(900,500);
    window->show();

    return a.exec();
} 
```

每次单击时，您的自定义插槽都会处理动作并执行动画。

# java - 如何设置连接属性？

> ID：12148976
> 
> 赞同：5
> 
> 时间：2012-08-27T20:17:47.603
> 
> 标签：java, oracle, jdbc

我可以使用 JDBC 驱动程序和以下 Java 代码很好地连接到 Oracle 11.2 数据库：

```
 import java.sql.*;
  import javax.sql.DataSource;
  import javax.naming.Context;
  import javax.naming.InitialContext;
  import javax.naming.NamingException;
  import oracle.jdbc.OracleTypes;
  ...
  Connection conn=null;

  // connect to database
  Context context = new InitialContext();
  DataSource ds = (DataSource)context.lookup("jdbc/myPool");
  conn = ds.getConnection(); 
```

但现在我需要将选项设置`SetFloatAndDoubleUseBinary`为 true。请参阅此处的第 4-16 页

[http://docs.oracle.com/cd/E14072_01/java.112/e10589.pdf](http://docs.oracle.com/cd/E14072_01/java.112/e10589.pdf)

所以我尝试从这里遵循示例：

[http://docs.oracle.com/cd/E11882_01/java.112/e16548/urls.htm](http://docs.oracle.com/cd/E11882_01/java.112/e16548/urls.htm)

我将代码修改为：

```
 import java.sql.*;
  import java.util.Properties;
  import javax.sql.DataSource;
  import javax.naming.Context;
  import javax.naming.InitialContext;
  import javax.naming.NamingException;
  import oracle.jdbc.OracleTypes;
  ...
  Connection conn=null;

  // set connection properties
  Properties info = new java.util.Properties();
  info.put ("SetFloatAndDoubleUseBinary","true");

  // connect to database
  Context context = new InitialContext();
  DataSource ds = (DataSource)context.lookup("jdbc/myPool");
  conn = ds.getConnection(info); 
```

我收到以下编译错误：

```
myClass.java:1145: cannot find symbol
symbol  : method getConnection(java.util.Properties)
location: interface javax.sql.DataSource
          conn = ds.getConnection(info);
                   ^ 
```

任何人都知道我可以如何正确设置`SetFloatAndDoubleUseBinary`这里？

更新 1

更改为：

```
 import java.sql.*;
  import java.util.Properties;
  import javax.sql.DataSource;
  import javax.naming.Context;
  import javax.naming.InitialContext;
  import javax.naming.NamingException;
  import oracle.jdbc.OracleTypes;
  import oracle.jdbc.*;       // NEW
  import oracle.jdbc.pool.*;  // NEW
  ...
  Connection conn=null;

  // set connection properties
  Properties info = new java.util.Properties();
  info.put ("SetFloatAndDoubleUseBinary","true");

  // connect to database
  Context context = new InitialContext();
  DataSource ds = (DataSource)context.lookup("jdbc/myPool");
  ((OracleDataSource)ds).setConnectionProperties(info); // NEW
  conn = ds.getConnection();                    // NEW 
```

给出以下运行时错误：

`stack trace: java.lang.ClassCastException: com.sun.gjc.spi.jdbc40.DataSource40 cannot be cast to oracle.jdbc.pool.OracleDataSource`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:41:46.560

The `DataSource` is usually configured on the application server. For example, in `Glassfish` you could set this property in the admin console like this:

![enter image description here](../Images/a73b0186b1e68e4dc54e530797c8652b.png)

and then just call

`ds.getConnection()` from your client code.

**Edit:**

If you want to get access to the implementation class of `javax.sql.DataSource`, you should use [DataSource#unwrap](http://docs.oracle.com/javase/6/docs/api/java/sql/Wrapper.html#unwrap(java.lang.Class)) method rather than simple cast.

For example:

```
DataSource ds = (DataSource) ctx.lookup("jdbc/MyPool");
OracleDataSource oracleDS = ds.unwrap(OracleDataSource.class) 
```

Make sure, you have your jdbc driver jar on classpath.

But then your code will be non-portable, if you wish to switch to another database vendor in the future.

**Edit 2:**
Also, for `Glassfish`, refer to the [Configuring Specific JDBC Connection Pool Features](http://docs.oracle.com/cd/E18930_01/html/821-2416/ggndx.html#SJSASEEAGgktdi) of Oracle Administration Guide.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:29:48.693

这种形式的`getConnection()`特定于更通用的接口`OracleDataSource`并且不存在于更通用的`DataSource`接口中。

解决方法很简单，替换这一行：

```
DataSource ds = (DataSource)context.lookup("jdbc/myPool"); 
```

有了这个：

```
OracleDataSource ds = (OracleDataSource)context.lookup("jdbc/myPool"); 
```

当然，这意味着从现在开始，您的应用程序将仅适用于 Oracle 数据库。根据您的需要，这可能是也可能不是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:31:34.727

除了亚历克斯的评论，我会尝试

```
 conn = ds.getConnection();
 conn.setClientInfo("SetFloatAndDoubleUseBinary","true"); 
```

# wcf-data-services - WCF 数据服务 - 请求错误

> ID：12148977
> 
> 赞同：6
> 
> 时间：2012-08-27T20:17:49.110
> 
> 标签：wcf-data-services

我在 LINQ to SQL 数据上下文之上做一个简单的 WCF 数据服务。我的 svc.cs 文件非常简单。但是，当我从 VS2012 运行它时，我得到一个没有更多信息的通用“请求错误”。我该如何解决/解决它？

```
using System;
using System.Collections.Generic;
using System.Data.Services;
using System.Data.Services.Common;
using System.Linq;
using System.ServiceModel.Web;
using System.Web;
using MyApp.Business.Pmw.DataAccess;

namespace MyApp.DataService
{
    public class SystemData : DataService<PmwModelDataContext>
    {
        // This method is called only once to initialize service-wide policies.
        public static void InitializeService(DataServiceConfiguration config)
        {
            config.SetEntitySetAccessRule("SysParam", EntitySetRights.ReadMultiple);            
            // TODO: set rules to indicate which entity sets and service operations are visible, updatable, etc.
            // Examples:
            // config.SetEntitySetAccessRule("MyEntityset", EntitySetRights.AllRead);
            // config.SetServiceOperationAccessRule("MyServiceOperation", ServiceOperationRights.All);
            config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-27T21:41:33.013

如果您`[ServiceBehavior(IncludeExceptionDetailInFaults=true)]`在服务上设置属性并设置`config.UseVerboseErrors`为`true`，您将在客户端收到更清晰的错误消息。请务必在投入生产之前删除这些设置，因为它们可能会导致无意的信息泄露：

```
[ServiceBehavior(IncludeExceptionDetailInFaults = true)]
public class FileService : DataService<FileContext>
{
    public static void InitializeService(DataServiceConfiguration config)
    {
        config.UseVerboseErrors = true;
        config.SetEntitySetAccessRule("*", EntitySetRights.AllRead);
        config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3;
    }
} 
```

# magento - 无需登录即可比较 magento 中的产品

> ID：12148981
> 
> 赞同：1
> 
> 时间：2012-08-27T20:18:15.080
> 
> 标签：magento

在我登录我的帐户之前，我无法比较 magento 中的产品。我尝试寻找解决方案，但找不到任何东西。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-07T11:52:11.110

1）从管理端系统->配置->高级->系统启用这里设置只为访问者启用日志。

如果这部分被禁用，那么 '$this->_logCondition->isVisitorLogEnabled()' 返回 0。这就是为什么在表 'catalog_compare_item' 中没有插入数据。

2) 从 .xml 文件 (app/etc/local) 启用以下事件

```
 <controller_action_predispatch>
            <observers><log><type>enabled</type></log></observers>
        </controller_action_predispatch>
        <controller_action_postdispatch>
            <observers><log><type>enabled</type></log></observers>
        </controller_action_postdispatch>
        <customer_login>
            <observers><log><type>enabled</type></log></observers>
        </customer_login>
        <customer_logout>
            <observers><log><type>enabled</type></log></observers>
        </customer_logout>
        <sales_quote_save_after>
            <observers><log><type>enabled</type></log></observers>
        </sales_quote_save_after>
        <checkout_quote_destroy>
            <observers><log><type>enabled</type></log></observers>
        </checkout_quote_destroy> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-07T09:19:40.977

```
Run below commands in phpmyadmin.

TRUNCATE dataflow_batch_export;
TRUNCATE dataflow_batch_import;
TRUNCATE log_customer;
TRUNCATE log_quote;
TRUNCATE log_summary;
TRUNCATE log_summary_type;
TRUNCATE log_url;
TRUNCATE log_url_info;
TRUNCATE log_visitor;
TRUNCATE log_visitor_info;
TRUNCATE log_visitor_online;
TRUNCATE report_viewed_product_index;
TRUNCATE report_compared_product_index;
TRUNCATE report_event;
TRUNCATE index_event;
TRUNCATE catalog_compare_item; 
```

在清除缓存并硬刷新您的浏览器之后。希望这会对您有所帮助。

# jquery - 在 jQuery 插件中存储实例化变量

> ID：12148986
> 
> 赞同：0
> 
> 时间：2012-08-27T20:18:27.627
> 
> 标签：jquery

我编写了一个插件来验证我工作的网络中的表单。这里的问题是我们的一些页面有多个表单并且全局变量被覆盖。我会尽我所能举一个例子。代码本身太长而无法粘贴。

我知道这段代码是非常错误的，但我正在尝试衡量使用该代码的多个实例而不会使事情变得太复杂的最佳方法。

jQuery插件：

```
(function($){

    methods = { 
        'method1': function(){
            alert('form: ' + globals.form_name ); 
        }
    }

    $.fn.validationplugin = function() {
        globals.form_id = $(this).attr('id');
    }(jQuery);

    var globals = {}

}(jQuery); 
```

html调用：

```
<form id="form1"></form>
<form id="form2"></form>

<script type="text/javascript">
    $('#form1').validationplugin();
    $('#form2').validationplugin();
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:24:25.293

对表单标识使用数组：

```
var globals = {
  form_id: []
}; 
```

该插件可以使用单个元素或多个元素调用，因此您必须获取每个元素的标识。还`this`从函数返回，以便可以链接插件。另外，最后你不想要`(jQuery)`，因为它会调用函数并将返回值分配为插件：

```
$.fn.validationplugin = function() {
  return this.each(function(i, el){
    globals.form_id.push($(el).attr('id'));
  });
}; 
```

现在，当调用中有多个元素时，它也可以工作：

```
$('#form1,#form2').validationplugin(); 
```

考虑是否可以使用对元素的引用而不是它们的标识，那么它也适用于没有标识的表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:53:56.133

我最终这样做了......

```
$.fn.validate = function(){

    var formnametest = $(this).attr('id');

    if( !($.validate.globals[ formnametest ]) ){
        globals(formnametest);
    }
}

function globals(formnametemp){
    $.validate.globals[ formnametemp ]  = {
        'mobile': false,
        'mobileoffset': -115,
        'bubbleanimationtime': 500,
        'bindblur': true,
        'zindex': null
    }
}

$.validate = { 
    globals:{}
}; 
```

我创建了一个函数 globals()，它将添加我的默认全局变量的一个新实例，并为其命名与表单相同。唯一的后果是我不得不通过我的所有函数传递当前表单的名称，我试图避免这种情况，但这一切都很好。感谢@Guffa，您的意见帮助我正确看待事情。

稍后要引用这些全局变量中的任何一个，只需： $.validate.globals[ currentform ].propertynamehere

似乎啰嗦，但这正是我需要的结果。:)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-27T20:27:22.430

我假设您将多次针对同一元素调用插件，并希望在这些调用之间关联数据。如果不是这种情况，那么您根本就不需要“全局变量”。正如@Felix Kling 在评论中所说，只需使用局部变量即可。

但是，如果您需要跟踪可以在多次调用插件之间持久化的数据，您可以这样做：

```
(function($){

    var globals=[],
        instances=[];

    $.fn.validationplugin = function() {
        this.each(function() {
            var current,
                index = $.inArray(this,instances));

            if (index!==-1) {
                current = globals[index];
            } else {
                instances.push(this);
                current = {};
                globals.push(current);
            }
            current.form_id = $(this).attr('id');
            ... 
        }
    };
}(jQuery); 
```

这将缓存与传递给插件的每个 DOM 元素关联的对象。如果在同一元素上对插件进行后续调用，则将在该后续调用中使用相同的全局对象。

您也可以只使用 jquery`data`将数据与任何 DOM 元素相关联，尽管它可能不如自己缓存它有效。

# php - 为什么我的 SQL 查询中出现此错误

> ID：12148988
> 
> 赞同：1
> 
> 时间：2012-08-27T20:18:28.530
> 
> 标签：php, sql

尝试此查询时：

```
 UPDATE l1_a
 SET l1_a.goals_for = l1_a.goals_for + l1_results.score1
 FROM l1_results, l1_a
 WHERE l1_results.team1 = l1_a.team_id; 
```

我得到错误：

```
 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM l1_results, l1_a WHERE l1_results.team1 = l1_a.team_id' at line 3 
```

l1_a 包含goals_for 和team_id

l1_results 包含 score1（这是多少个进球）和 team1（这是 team_id）

我的查询有问题吗？我已经仔细检查了所有列和表都是查询中的正确名称

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T20:21:05.673

声明这[`documentation for UPDATE`](http://dev.mysql.com/doc/refman/5.6/en/update.html)是多表`UPDATE`语句的语法：

```
Multiple-table syntax:

UPDATE [LOW_PRIORITY] [IGNORE] table_references
    SET col_name1={expr1|DEFAULT} [, col_name2={expr2|DEFAULT}] ...
    [WHERE where_condition] 
```

试试这个：

```
 UPDATE l1_results, l1_a
 SET l1_a.goals_for = l1_a.goals_for + l1_results.score1
 WHERE l1_results.team1 = l1_a.team_id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:20:55.360

您正在结合选择和更新语法。更新语句中没有`from`。

试试这个：

```
UPDATE l1_a
SET l1_a.goals_for = l1_a.goals_for + 
  (select l1_results.score1 
  from l1_results 
  where l1_results.team1 = l1a.team_id) 
```

如果 l1_results 中没有记录，您可能会清空数据。最好添加一个 IFNULL：

```
UPDATE l1_a
SET l1_a.goals_for = l1_a.goals_for + IFNULL(
  (select l1_results.score1 
  from l1_results 
  where l1_results.team1 = l1a.team_id), 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T20:38:47.340

改变

```
UPDATE l1_a
SET l1_a.goals_for = l1_a.goals_for + l1_results.score1
FROM l1_results, l1_a
WHERE l1_results.team1 = l1_a.team_id; 
```

到

```
UPDATE l1_a
SET l1_a.goals_for = l1_a.goals_for + l1_results.score1
WHERE l1_results.team1 = l1_a.team_id; 
```

你不需要 FROM l1_results, l1_a

# java - 字符串拆分方法行为

> ID：12148991
> 
> 赞同：5
> 
> 时间：2012-08-27T20:18:35.747
> 
> 标签：java, string, split

我不明白为什么以下输出有意义。

空字符串的字符串拆分方法返回长度为 1 的字符串数组

`String[] split = "".split(",");`
`System.out.println(split.length);`
返回长度为 1 的字符串数组

`String[] split = "Java".split(",");`
`System.out.println(split.length);`
返回长度为 1 的字符串数组

怎么区分？？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-27T20:21:50.663

从[文档中](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String,%20int%29)：

> 此方法返回的数组包含此字符串的每个子字符串，这些子字符串由与给定表达式匹配的另一个子字符串终止或以字符串结尾终止。

要回答您的问题，它会执行预期的操作：返回的子字符串在输入字符串的末尾终止（因为`,`找不到）。该文档还指出：

> 如果表达式与输入的任何部分都不匹配，则结果数组只有一个元素，即这个字符串。

请注意，这是第一个语句的结果。这不是 Java 开发人员添加的额外情况，以防无法找到搜索字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:21:39.903

这个我也打 它返回的是字符串，但不包括拆分字符。如果您不想获取任何字符串，请使用 StringTokenizer：

```
StringTokenizer st = new StringTokenizer(someString,',');
int numberOfSubstrings = st.countTokens(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T20:21:08.050

它返回原始字符串（在本例中为空字符串），因为没有 , 进行拆分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T20:23:00.607

它返回一个，因为您正在测量拆分数组的大小，其中包含一个元素：一个空字符串。

# glsl - （未使用的）GLSL 制服/进/出是否有助于注册压力？

> ID：12148992
> 
> 赞同：3
> 
> 时间：2012-08-27T20:18:47.773
> 
> 标签：glsl

我不知道制服在记忆中是如何表示的。

制服似乎可以占用宝贵的寄存器空间，但它们最终会传入/通过/传出到全局内存中，对吧？

当制服未使用时，情况是否会发生变化？编译器可以优化它们吗？--在这种情况下，我将无效 (-1) 作为绑定位置，所以我假设是的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T20:40:47.450

Uniforms are represented in whatever manor the GLSL compiler and OpenGL implementation deem fit. Some implementations make certain uniforms actual constants within the assembly, such that changing a uniform is actually patching the assembly in-situ. Some have special memory for uniforms.

It's all hardware dependent.

Compilers are allowed to optimize uniforms out; this is where the term "active uniform" comes from. The OpenGL API for querying uniform information only works for active uniforms: those that are actually detected to be in-use by the compiler.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T20:34:59.093

首先，GLSL 规范并没有说明其概念的实际实现，因此以下阐述当然可以理解为“可以是任何方式，但现在通常是这样”。

至于我（可能是有限的）关于图形硬件的知识，制服通常存在于所谓的常量内存中，它是全局设备内存的一部分（并且在较新的硬件上甚至应该被缓存），因为它们不能被着色器更改无论如何程序，并且对于程序的所有调用都是全局的（可以并且应该在不同的多处理器上并行运行）。因此它们本身不占用任何每个多处理器的寄存器空间。

您也是对的，GLSL 编译器可以（并且通常会）优化掉任何未使用的统一（以及属性），但前提是这些不用于任何可能的执行分支，当然。因此，您在获得统一位置时所经历的`-1`是完全有效（并且通常是所需）的行为。

# c# - 提供过滤器后如何在 asp:grid 中加载数据？

> ID：12148993
> 
> 赞同：0
> 
> 时间：2012-08-27T20:18:47.440
> 
> 标签：c#, asp.net, gridview

从两个列表`asp:grid`过滤后，我必须加载数据。`asp:dropdown`例如以下是下拉列表：

```
<asp:DropDownList ID="ddlb" runat="server" AutoPostBack="True" 
                    CssClass="ddlb" Width="100px" DataSourceID="SqlDataSource3" 
                    DataTextField="MonthYearName" DataValueField="MonthYear" 
                    onselectedindexchanged="Changed">
                </asp:DropDownList>

                <asp:SqlDataSource ID="SqlDataSource3" runat="server" 
                    ConnectionString="<%$ ConnectionStrings:ProdDB %>" SelectCommand="# some sql query">
                </asp:SqlDataSource>

<asp:DropDownList ID="asd" runat="server" AutoPostBack="True" 
                    CssClass="ddlb" Width="100px" DataSourceID="SqlDataSource4" 
                    DataTextField="MonthYearName" DataValueField="MonthYear" 
                    onselectedindexchanged="SelectedIndexChanged">
                </asp:DropDownList>

                <asp:SqlDataSource ID="SqlDataSource4" runat="server" 
                    ConnectionString="<%$ ConnectionStrings:ProdDB %>" SelectCommand="# some queries">
                </asp:SqlDataSource> 
```

现在，当我加载页面时。它显示了上面定义的下拉列表。我想知道的是“我应该如何`aspx grid`使用上述两个下拉过滤器加载数据？”。

例如，我`A`从第一个下拉列表中选择选项，然后根据它过滤结果，数据将显示`grid`等等......

请告诉我应该如何将网格与这两个下拉列表连接起来？

我应该如何过滤它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:50:24.227

在页面上放置一个网格和两个下拉菜单。放置 SQL 数据源

为sql数据源选择命令提供两个参数

将该sqldatasource附加到gridview

将 SQLDataSource 的两个参数绑定到两个 Dropdown 框。