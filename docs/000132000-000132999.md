# StackOverflow 问答 000132000-000132999

# sharepoint - 部署自定义内容类型、表单、cqwp 和 xsl

> ID：132030
> 
> 赞同：2
> 
> 时间：2008-09-25T07:57:51.363
> 
> 标签：sharepoint, moss, content-type, cqwp

现在我有一个 Visual Studio 项目，其中包含我制作的自定义内容类型。它还包含制作共享点解决方案 (wsp) 文件和生成此文件的脚本所需的所有文件。

现在，我想做两件事。

首先，我想为内容类型创建一个自定义显示表单并将其包含在我的解决方案中，以便在我部署我的解决方案时自动部署它。如何将其包含在我的解决方案中并让我的内容类型使用它？

其次，您可以使用 CQWP 查询此类型。我考虑过导出它，添加更多常见的视图字段，然后修改用于呈现它的 XSL。如何将其包含到我的解决方案中，以便也部署它。我知道我可以在所有设置完成后导出 CQWP webpart，并将其作为功能包含在我的项目中。但是 XSL 呢？

期待看到你的建议，加油。

按照第一个答案中的描述进行。像魅力一样工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-28T22:14:31.720

使用[STSDev](http://www.codeplex.com/stsdev)创建解决方案包。这应该有助于创建 WSP。自定义表单、CQWP webpart 和 .xls 文件也应该可以在项目中部署。

要部署 xslt，您的功能将具有

`<ElementManifest Location="mywebpartManifest.xml">`

然后这指向一个文件，例如

```
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
  <Module Name="Yourfile.xslt" Url="Style Library" Path="" RootWebOnly="TRUE">
    <File Url="yourfile.xslt" Type="GhostableInLibrary" />
  </Module>
</Elements> 
```

对于网络部分：

```
<Module Name="myWebpart" List="113" Url="_catalogs/wp" RootWebOnly="FALSE">
   <File Url="myWebpart.webpart" Type="GhostableInLibrary" />
</Module> 
```

现在该文件需要包含在解决方案 manifest.xml 中。这是从 STSDev 项目自动完成的。

例如

```
<Resources>
    <Resource Location="SimpleFeature\Feature.xml"/> 
```

实际的模式是：

[地点](http://msdn.microsoft.com/en-us/library/aa544502.aspx)

[解决方案](http://msdn.microsoft.com/en-us/library/ms442108.aspx)

[特征](http://msdn.microsoft.com/en-us/library/ms414322.aspx)

[以及指向其他有问题的人的链接](http://social.msdn.microsoft.com/Forums/en-US/sharepointecm/thread/335399ea-f07f-43a5-a4e2-21d88ba2743e/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T08:07:40.487

但是，您将表单和 .xsl 部署到文件夹结构的哪个位置？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T11:28:17.653

我已按照您的指南进行操作，尽管它将 xslt 部署到 12 Hive 中的功能，但它没有将其放置在正确的样式库文件夹中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-16T19:57:20.227

您需要停用/重新激活该功能。这将为您提供与复制文件相关的任何错误消息。

# email - 从 WSH 发送到/邮件收件人

> ID：132038
> 
> 赞同：0
> 
> 时间：2008-09-25T08:00:12.497
> 
> 标签：email, wsh

我正在尝试在 Windows 脚本主机中实现与 Windows Send To/Mail Recipient 相同的功能。`Outlook.Application`除了实例化和直接调用其方法的步骤外，在谷歌上没有找到任何有用的东西。

我需要走与 Windows 相同的路径，因为安装了 Outlook 和 Lotus Notes 的混合，我认为执行某种测试并决定与哪个对象交谈并不好......

我发现实际的工作是由 完成的`sendmail.dll`，在注册表下定义了一个处理程序`HKEY_CLASSES_ROOT\CLSID\{9E56BE60-C50F-11CF-9A2C-00A0C90A90CE}`。我想以某种方式使用这个 dll 或模拟它所做的相同步骤。

感谢您的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T09:32:36.003

Windows 中发送到菜单的内容是 C:\Documents and Settings\username\SendTo 文件夹中的一堆文件（通常是链接）。您需要在此处添加您的脚本 - 或指向它的链接。

对于您的脚本，您可以检查是否存在某些注册表项来检测 Outlook 和 Lotus Notes。

或者，如果您不关心消息是否显示在已发送的项目中，只需使用 CDOSYS.NewMail 将消息直接发送到 SMTP 服务器。

[CDOSYS 文档](http://msdn.microsoft.com/en-us/library/aa505938.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-16T15:53:33.583

[我在 2003 年的CodeProject](http://www.codeproject.com/KB/shell/sendtomail.aspx)上发现了一项可能相关的项目。

# c++ - 如何通过 C++ 程序发送电子邮件？

> ID：132039
> 
> 赞同：2
> 
> 时间：2008-09-25T08:00:26.507
> 
> 标签：c++, email, gcc

如何从 C++ 发送电子邮件？我可以使用一个好的跨平台（MS Windows、Linux 等）库吗？我正在使用 GCC（MS Windows 上的 cygwin）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T09:03:13.407

查看[C 客户端](http://www.washington.edu/imap/)

*   阿帕奇许可证
*   非常成熟的图书馆（Pine 电子邮件阅读器、UW-IMAP 服务器等的制造商）
*   支持 IMAP、POP、SMTP 和 NNTP
*   Unix 和 Windows

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T08:08:22.133

看看[VMime](http://sourceforge.net/projects/vmime/)。

> VMime 是一个一体化的 Internet 邮件库。这个设计精良、功能强大的 C++ 类库允许您解析/构建/修改 MIME 消息。使用消息模块，您可以非常轻松地连接到 POP3/IMAP/SMTP/Maildir，并且使用相同的代码！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T08:28:21.947

查看 jwSMTP - 一个跨平台的 SMTP 类。

[http://johnwiggins.net/jwsmtp/](http://johnwiggins.net/jwsmtp/)

# algorithm - 图像存档 VS 图像条

> ID：132040
> 
> 赞同：1
> 
> 时间：2008-09-25T08:00:29.343
> 
> 标签：algorithm, optimization, image-archive

我注意到很多游戏/应用程序（在移动版本中很常见）将大量图像打包到图像条中。我认为这样做的好处是使程序更整洁（文件系统 - 明智）并减少（卸载）安装时间。在应用程序运行期间，整个图像条被分配并从 FS 复制到 RAM。相反，图像可以存储在图像存档中，并在运行时解压缩到 RAM 中的多个图像结构中。

在我看来，图像条带方法效率较低，因为缓存性能较差，而且即使使用最佳矩形打包算法，条带中存储的图像之间也会有空白空间，从而造成 RAM 的浪费。

与使用图像存档文件相比，使用图像条有什么优势？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T08:26:45.880

如果片段中的图像可能同时出现，缓存将不会像您想象的那样成为一个问题——即，它们都是动画的一部分。就打包算法而言，大多数通用算法产生类似的效率水平——为了大幅提高打包效率，您通常必须编写一个针对所涉及的数据集进行优化的算法。

与任何类型的优化（缓存或打包）通常情况一样，在证明它是一个问题之前不要担心它，然后您需要在对上下文有很好的理解的情况下解决问题。

# java - 用于提供静态内容的 Servlet

> ID：132052
> 
> 赞同：150
> 
> 时间：2008-09-25T08:04:28.353
> 
> 标签：java, jsp, servlets, jakarta-ee

我在两个不同的容器（Tomcat 和 Jetty）上部署了一个 webapp，但是它们用于提供静态内容的默认 servlet 有不同的方式来处理我想要使用的 URL 结构（[详细信息](http://issues.apache.org/bugzilla/show_bug.cgi?id=42411)）。

因此，我希望在 webapp 中包含一个小 servlet 来提供它自己的静态内容（图像、CSS 等）。servlet 应具有以下属性：

*   没有外部依赖
*   简单可靠
*   支持[`If-Modified-Since`](http://www.freesoft.org/CIE/RFC/1945/58.htm)标头（即自定义[`getLastModified`](http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/http/HttpServlet.html#getLastModified(javax.servlet.http.HttpServletRequest))方法）
*   （可选）支持 gzip 编码、etags、...

这样的 servlet 在某处可用吗？我能找到的最接近的是servlet book 中的[示例 4-10](http://www.unix.org.ua/orelly/java-ent/servlet/ch04_04.htm#ch04-35758)。

**更新：**我想使用的 URL 结构——如果你想知道的话——很简单：

```
 <servlet-mapping>
            <servlet-name>main</servlet-name>
            <url-pattern>/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
            <servlet-name>default</servlet-name>
            <url-pattern>/static/*</url-pattern>
    </servlet-mapping> 
```

所以所有请求都应该传递给主 servlet，除非它们是针对`static`路径的。问题是 Tomcat 的默认 servlet 不考虑 ServletPath（因此它会在主文件夹中查找静态文件），而 Jetty 会（因此它会在`static`文件夹中查找）。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2010-08-27T07:36:52.483

我想出了一个稍微不同的解决方案。这有点hack-ish，但这是映射：

```
<servlet-mapping>   
    <servlet-name>default</servlet-name>
    <url-pattern>*.html</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.jpg</url-pattern>
</servlet-mapping>
<servlet-mapping>
 <servlet-name>default</servlet-name>
    <url-pattern>*.png</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.css</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.js</url-pattern>
</servlet-mapping>

<servlet-mapping>
    <servlet-name>myAppServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

这基本上只是将所有内容文件按扩展名映射到默认 servlet，并将其他所有内容映射到“myAppServlet”。

它适用于 Jetty 和 Tomcat。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-05-07T21:00:08.520

在这种情况下，不需要完全自定义实现默认 servlet，您可以使用这个简单的 servlet 将请求包装到容器的实现中：

```
 package com.example;

import java.io.*;

import javax.servlet.*;
import javax.servlet.http.*;

public class DefaultWrapperServlet extends HttpServlet
{   
    public void doGet(HttpServletRequest req, HttpServletResponse resp)
        throws ServletException, IOException
    {
        RequestDispatcher rd = getServletContext().getNamedDispatcher("default");

        HttpServletRequest wrapped = new HttpServletRequestWrapper(req) {
            public String getServletPath() { return ""; }
        };

        rd.forward(wrapped, resp);
    }
} 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-09-23T18:24:55.683

我使用[FileServlet](http://balusc.blogspot.com/2009/02/fileservlet-supporting-resume-and.html)取得了不错的效果，因为它支持几乎所有的 HTTP（etag、分块等）。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2015-05-01T17:03:10.640

# 静态资源 servlet 的抽象模板

部分基于2007 年的[这篇博客](http://balusc.blogspot.com/2007/07/fileservlet.html)，这是一个现代化且高度可重用的 servlet 抽象模板，它正确处理缓存、`ETag`和`If-None-Match`（`If-Modified-Since`但不支持 Gzip 和 Range；只是为了保持简单；Gzip 可以通过过滤器或通过容器配置）。

```
public abstract class StaticResourceServlet extends HttpServlet {

    private static final long serialVersionUID = 1L;
    private static final long ONE_SECOND_IN_MILLIS = TimeUnit.SECONDS.toMillis(1);
    private static final String ETAG_HEADER = "W/\"%s-%s\"";
    private static final String CONTENT_DISPOSITION_HEADER = "inline;filename=\"%1$s\"; filename*=UTF-8''%1$s";

    public static final long DEFAULT_EXPIRE_TIME_IN_MILLIS = TimeUnit.DAYS.toMillis(30);
    public static final int DEFAULT_STREAM_BUFFER_SIZE = 102400;

    @Override
    protected void doHead(HttpServletRequest request, HttpServletResponse response) throws ServletException ,IOException {
        doRequest(request, response, true);
    }

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        doRequest(request, response, false);
    }

    private void doRequest(HttpServletRequest request, HttpServletResponse response, boolean head) throws IOException {
        response.reset();
        StaticResource resource;

        try {
            resource = getStaticResource(request);
        }
        catch (IllegalArgumentException e) {
            response.sendError(HttpServletResponse.SC_BAD_REQUEST);
            return;
        }

        if (resource == null) {
            response.sendError(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        String fileName = URLEncoder.encode(resource.getFileName(), StandardCharsets.UTF_8.name());
        boolean notModified = setCacheHeaders(request, response, fileName, resource.getLastModified());

        if (notModified) {
            response.sendError(HttpServletResponse.SC_NOT_MODIFIED);
            return;
        }

        setContentHeaders(response, fileName, resource.getContentLength());

        if (head) {
            return;
        }

        writeContent(response, resource);
    }

    /**
     * Returns the static resource associated with the given HTTP servlet request. This returns <code>null</code> when
     * the resource does actually not exist. The servlet will then return a HTTP 404 error.
     * @param request The involved HTTP servlet request.
     * @return The static resource associated with the given HTTP servlet request.
     * @throws IllegalArgumentException When the request is mangled in such way that it's not recognizable as a valid
     * static resource request. The servlet will then return a HTTP 400 error.
     */
    protected abstract StaticResource getStaticResource(HttpServletRequest request) throws IllegalArgumentException;

    private boolean setCacheHeaders(HttpServletRequest request, HttpServletResponse response, String fileName, long lastModified) {
        String eTag = String.format(ETAG_HEADER, fileName, lastModified);
        response.setHeader("ETag", eTag);
        response.setDateHeader("Last-Modified", lastModified);
        response.setDateHeader("Expires", System.currentTimeMillis() + DEFAULT_EXPIRE_TIME_IN_MILLIS);
        return notModified(request, eTag, lastModified);
    }

    private boolean notModified(HttpServletRequest request, String eTag, long lastModified) {
        String ifNoneMatch = request.getHeader("If-None-Match");

        if (ifNoneMatch != null) {
            String[] matches = ifNoneMatch.split("\\s*,\\s*");
            Arrays.sort(matches);
            return (Arrays.binarySearch(matches, eTag) > -1 || Arrays.binarySearch(matches, "*") > -1);
        }
        else {
            long ifModifiedSince = request.getDateHeader("If-Modified-Since");
            return (ifModifiedSince + ONE_SECOND_IN_MILLIS > lastModified); // That second is because the header is in seconds, not millis.
        }
    }

    private void setContentHeaders(HttpServletResponse response, String fileName, long contentLength) {
        response.setHeader("Content-Type", getServletContext().getMimeType(fileName));
        response.setHeader("Content-Disposition", String.format(CONTENT_DISPOSITION_HEADER, fileName));

        if (contentLength != -1) {
            response.setHeader("Content-Length", String.valueOf(contentLength));
        }
    }

    private void writeContent(HttpServletResponse response, StaticResource resource) throws IOException {
        try (
            ReadableByteChannel inputChannel = Channels.newChannel(resource.getInputStream());
            WritableByteChannel outputChannel = Channels.newChannel(response.getOutputStream());
        ) {
            ByteBuffer buffer = ByteBuffer.allocateDirect(DEFAULT_STREAM_BUFFER_SIZE);
            long size = 0;

            while (inputChannel.read(buffer) != -1) {
                buffer.flip();
                size += outputChannel.write(buffer);
                buffer.clear();
            }

            if (resource.getContentLength() == -1 && !response.isCommitted()) {
                response.setHeader("Content-Length", String.valueOf(size));
            }
        }
    }

} 
```

将它与以下表示静态资源的接口一起使用。

```
interface StaticResource {

    /**
     * Returns the file name of the resource. This must be unique across all static resources. If any, the file
     * extension will be used to determine the content type being set. If the container doesn't recognize the
     * extension, then you can always register it as <code>&lt;mime-type&gt;</code> in <code>web.xml</code>.
     * @return The file name of the resource.
     */
    public String getFileName();

    /**
     * Returns the last modified timestamp of the resource in milliseconds.
     * @return The last modified timestamp of the resource in milliseconds.
     */
    public long getLastModified();

    /**
     * Returns the content length of the resource. This returns <code>-1</code> if the content length is unknown.
     * In that case, the container will automatically switch to chunked encoding if the response is already
     * committed after streaming. The file download progress may be unknown.
     * @return The content length of the resource.
     */
    public long getContentLength();

    /**
     * Returns the input stream with the content of the resource. This method will be called only once by the
     * servlet, and only when the resource actually needs to be streamed, so lazy loading is not necessary.
     * @return The input stream with the content of the resource.
     * @throws IOException When something fails at I/O level.
     */
    public InputStream getInputStream() throws IOException;

} 
```

您所需要的只是从给定的抽象 servlet 扩展并`getStaticResource()`根据 javadoc 实现该方法。

# 从文件系统服务的具体示例：

这是一个具体示例，它通过`/files/foo.ext`本地磁盘文件系统中的 URL 提供服务：

```
@WebServlet("/files/*")
public class FileSystemResourceServlet extends StaticResourceServlet {

    private File folder;

    @Override
    public void init() throws ServletException {
        folder = new File("/path/to/the/folder");
    }

    @Override
    protected StaticResource getStaticResource(HttpServletRequest request) throws IllegalArgumentException {
        String pathInfo = request.getPathInfo();

        if (pathInfo == null || pathInfo.isEmpty() || "/".equals(pathInfo)) {
            throw new IllegalArgumentException();
        }

        String name = URLDecoder.decode(pathInfo.substring(1), StandardCharsets.UTF_8.name());
        final File file = new File(folder, Paths.get(name).getFileName().toString());

        return !file.exists() ? null : new StaticResource() {
            @Override
            public long getLastModified() {
                return file.lastModified();
            }
            @Override
            public InputStream getInputStream() throws IOException {
                return new FileInputStream(file);
            }
            @Override
            public String getFileName() {
                return file.getName();
            }
            @Override
            public long getContentLength() {
                return file.length();
            }
        };
    }

} 
```

# 从数据库服务的具体示例：

这是一个具体的示例，它通过一个 URL 提供服务，例如`/files/foo.ext`通过一个 EJB 服务调用从数据库中返回您的具有`byte[] content`属性的实体：

```
@WebServlet("/files/*")
public class YourEntityResourceServlet extends StaticResourceServlet {

    @EJB
    private YourEntityService yourEntityService;

    @Override
    protected StaticResource getStaticResource(HttpServletRequest request) throws IllegalArgumentException {
        String pathInfo = request.getPathInfo();

        if (pathInfo == null || pathInfo.isEmpty() || "/".equals(pathInfo)) {
            throw new IllegalArgumentException();
        }

        String name = URLDecoder.decode(pathInfo.substring(1), StandardCharsets.UTF_8.name());
        final YourEntity yourEntity = yourEntityService.getByName(name);

        return (yourEntity == null) ? null : new StaticResource() {
            @Override
            public long getLastModified() {
                return yourEntity.getLastModified();
            }
            @Override
            public InputStream getInputStream() throws IOException {
                return new ByteArrayInputStream(yourEntityService.getContentById(yourEntity.getId()));
            }
            @Override
            public String getFileName() {
                return yourEntity.getName();
            }
            @Override
            public long getContentLength() {
                return yourEntity.getContentLength();
            }
        };
    }

} 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-09-25T12:14:08.017

我最终滚动了自己的`StaticServlet`. 它支持`If-Modified-Since`, gzip 编码，并且应该能够从战争文件中提供静态文件。这不是很困难的代码，但也不是完全微不足道的。

代码可用：[StaticServlet.java](http://bruno.defraine.net/StaticServlet.java)。随意发表评论。

**更新：** Khurram询问`ServletUtils`. `StaticServlet`它只是一个带有辅助方法的类，我用于我的项目。您需要的唯一方法是`coalesce`（与 SQL 函数相同[`COALESCE`](http://en.wikipedia.org/wiki/Null_(SQL)#COALESCE)）。这是代码：

```
public static <T> T coalesce(T...ts) {
    for(T t: ts)
        if(t != null)
            return t;
    return null;
} 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2011-02-17T22:48:10.193

从上面的示例信息来看，我认为整篇文章都是基于 Tomcat 6.0.29 及更早版本中的错误行为。请参阅[https://issues.apache.org/bugzilla/show_bug.cgi?id=50026](https://issues.apache.org/bugzilla/show_bug.cgi?id=50026)。升级到 Tomcat 6.0.30 和 (Tomcat|Jetty) 之间的行为应该合并。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2012-01-28T14:45:43.043

试试这个

```
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.js</url-pattern>
    <url-pattern>*.css</url-pattern>
    <url-pattern>*.ico</url-pattern>
    <url-pattern>*.png</url-pattern>
    <url-pattern>*.jpg</url-pattern>
    <url-pattern>*.htc</url-pattern>
    <url-pattern>*.gif</url-pattern>
</servlet-mapping> 
```

编辑：这仅对 servlet 2.5 规范及更高版本有效。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2008-09-25T08:22:39.197

我遇到了同样的问题，我通过使用 Tomcat 代码库中的“默认 servlet”代码解决了这个问题。

[https://github.com/apache/tomcat/blob/master/java/org/apache/catalina/servlets/DefaultServlet.java](https://github.com/apache/tomcat/blob/master/java/org/apache/catalina/servlets/DefaultServlet.java)

[DefaultServlet](http://tomcat.apache.org/tomcat-5.5-doc/default-servlet.html)是为 Tomcat 中的静态资源（jpg、html、css、gif 等）提供服务的 servlet 。

这个 servlet 非常高效，并且具有您在上面定义的一些属性。

我认为此源代码是启动和删除您不需要的功能或依赖项的好方法。

*   可以删除对 org.apache.naming.resources 包的引用或将其替换为 java.io.File 代码。
*   对 org.apache.catalina.util 包的引用可能只是可以在源代码中复制的实用程序方法/类。
*   可以内联或删除对 org.apache.catalina.Globals 类的引用。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-08-28T09:53:18.660

我在网上找到了关于一些解决方法的很棒的教程。它简单高效，我在几个项目中使用了 REST urls 样式方法：

[http://www.kuligowski.pl/java/rest-style-urls-and-url-mapping-for-static-content-apache-tomcat,5](http://www.kuligowski.pl/java/rest-style-urls-and-url-mapping-for-static-content-apache-tomcat,5)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-09-23T18:19:10.053

我通过扩展 tomcat [DefaultServlet](http://tomcat.apache.org/tomcat-5.5-doc/default-servlet.html) ( [src](http://svn.apache.org/repos/asf/tomcat/trunk/java/org/apache/catalina/servlets/DefaultServlet.java) ) 并覆盖 getRelativePath() 方法来做到这一点。

```
package com.example;

import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import org.apache.catalina.servlets.DefaultServlet;

public class StaticServlet extends DefaultServlet
{
   protected String pathPrefix = "/static";

   public void init(ServletConfig config) throws ServletException
   {
      super.init(config);

      if (config.getInitParameter("pathPrefix") != null)
      {
         pathPrefix = config.getInitParameter("pathPrefix");
      }
   }

   protected String getRelativePath(HttpServletRequest req)
   {
      return pathPrefix + super.getRelativePath(req);
   }
} 
```

...这是我的 servlet 映射

```
<servlet>
    <servlet-name>StaticServlet</servlet-name>
    <servlet-class>com.example.StaticServlet</servlet-class>
    <init-param>
        <param-name>pathPrefix</param-name>
        <param-value>/static</param-value>
    </init-param>       
</servlet>

<servlet-mapping>
    <servlet-name>StaticServlet</servlet-name>
    <url-pattern>/static/*</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-09-27T11:54:16.400

要为 Spring 应用程序以及 /favicon.ico 以及 Spring 的 AbstractUrlBasedView 将请求的 /WEB-INF/jsp/* 中的 JSP 文件提供所有请求，您只需重新映射 jsp servlet 和默认 servlet：

```
 <servlet>
    <servlet-name>springapp</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>

  <servlet-mapping>
    <servlet-name>jsp</servlet-name>
    <url-pattern>/WEB-INF/jsp/*</url-pattern>
  </servlet-mapping>

  <servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>/favicon.ico</url-pattern>
  </servlet-mapping>

  <servlet-mapping>
    <servlet-name>springapp</servlet-name>
    <url-pattern>/*</url-pattern>
  </servlet-mapping> 
```

我们不能依赖 jsp servlet 的标准映射上的 *.jsp url 模式，因为在检查任何扩展映射之前，路径模式 '/*' 已匹配。将 jsp servlet 映射到更深的文件夹意味着它首先匹配。匹配 '/favicon.ico' 恰好发生在路径模式匹配之前。更深的路径匹配或完全匹配将起作用，但没有扩展匹配可以使其超过 '/*' 路径匹配。将“/”映射到默认 servlet 似乎不起作用。你会认为确切的 '/' 会击败 springapp 上的 '/*' 路径模式。

上述过滤器解决方案不适用于来自应用程序的转发/包含 JSP 请求。为了使它工作，我必须直接将过滤器应用到 springapp，此时 url 模式匹配是无用的，因为进入应用程序的所有请求也会进入它的过滤器。因此，我向过滤器添加了模式匹配，然后了解了“jsp”servlet，发现它不会像默认 servlet 那样删除路径前缀。这解决了我的问题，这并不完全相同但足够普遍。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-01-08T10:04:21.280

检查 Tomcat 8.x：如果根 servlet 映射到“”，静态资源可以正常工作。对于 servlet 3.x，它可以通过`@WebServlet("")`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-17T21:19:30.067

使用 org.mortbay.jetty.handler.ContextHandler。您不需要像 StaticServlet 这样的附加组件。

在码头家，

$ cd 上下文

$ cp javadoc.xml 静态.xml

$ vi 静态.xml

...

```
<Configure class="org.mortbay.jetty.handler.ContextHandler">
<Set name="contextPath">/static</Set>
<Set name="resourceBase"><SystemProperty name="jetty.home" default="."/>/static/</Set>
<Set name="handler">
  <New class="org.mortbay.jetty.handler.ResourceHandler">
    <Set name="cacheControl">max-age=3600,public</Set>
  </New>
 </Set>
</Configure> 
```

将 contextPath 的值设置为您的 URL 前缀，并将 resourceBase 的值设置为静态内容的文件路径。

它对我有用。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-06-27T06:15:55.097

请参阅 JSOS 中的静态文件：[http ://www.servletsuite.com/servlets/staticfile.htm](http://www.servletsuite.com/servlets/staticfile.htm)

# python - 显示正在运行的 Python 应用程序的堆栈跟踪

> ID：132058
> 
> 赞同：367
> 
> 时间：2008-09-25T08:06:06.087
> 
> 标签：python, debugging, stack-trace, traceback

我有这个 Python 应用程序时不时卡住，我不知道在哪里。

有没有办法向 Python 解释器发出信号以向您显示正在运行的确切代码？

某种即时堆栈跟踪？

***相关问题：***

*   [从 Python 代码中的方法打印当前调用堆栈](https://stackoverflow.com/questions/1156023/print-current-call-stack-from-a-method-in-python-code)
*   [检查正在运行的进程在做什么：打印未检测的 Python 程序的堆栈跟踪](https://stackoverflow.com/questions/6849138/check-what-a-running-process-is-doing-print-stack-trace-of-an-uninstrumented-py)

* * *

## 回答 #1

> 赞同：338
> 
> 时间：2008-09-25T13:38:45.257

我有用于这种情况的模块 - 一个进程将运行很长时间，但有时会因为未知和不可重现的原因而卡住。它有点hacky，仅适用于unix（需要信号）：

```
import code, traceback, signal

def debug(sig, frame):
    """Interrupt running process, and provide a python prompt for
    interactive debugging."""
    d={'_frame':frame}         # Allow access to frame object.
    d.update(frame.f_globals)  # Unless shadowed by global
    d.update(frame.f_locals)

    i = code.InteractiveConsole(d)
    message  = "Signal received : entering python shell.\nTraceback:\n"
    message += ''.join(traceback.format_stack(frame))
    i.interact(message)

def listen():
    signal.signal(signal.SIGUSR1, debug)  # Register handler 
```

要使用它，只需在程序启动时调用 listen() 函数（您甚至可以将其粘贴在 site.py 中以让所有 python 程序都使用它），然后让它运行。在任何时候，使用 kill 或在 python 中向进程发送 SIGUSR1 信号：

```
 os.kill(pid, signal.SIGUSR1) 
```

这将导致程序在当前位置中断到 python 控制台，向您显示堆栈跟踪，并让您操作变量。使用 control-d (EOF) 继续运行（但请注意，您可能会在发出信号时中断任何 I/O 等，因此它不是完全非侵入性的。

我有另一个脚本做同样的事情，除了它通过管道与正在运行的进程通信（以允许调试后台进程等）。在这里发布有点大，但我已将其添加为[python 食谱食谱](http://code.activestate.com/recipes/576515/)。

* * *

## 回答 #2

> 赞同：151
> 
> 时间：2008-09-29T00:44:13.467

安装信号处理程序的建议很好，我经常使用它。例如，默认情况下[bzr](http://bazaar-vcs.org/)会安装一个 SIGQUIT 处理程序，该处理程序会调用`pdb.set_trace()`以立即将您放入[pdb](http://docs.python.org/lib/module-pdb.html)提示符。（有关详细信息，请参阅[bzrlib.breakin](https://bazaar.launchpad.net/%7Ebzr-pqm/bzr/bzr.dev/view/head:/bzrlib/breakin.py)模块的源代码。）使用 pdb，您不仅可以获取当前堆栈跟踪（使用`(w)here`命令），还可以检查变量等。

但是，有时我需要调试一个我没有先见之明的进程来安装信号处理程序。在 linux 上，您可以将 gdb 附加到进程并使用一些 gdb 宏获取 python 堆栈跟踪。将[http://svn.python.org/projects/python/trunk/Misc/gdbinit](http://svn.python.org/projects/python/trunk/Misc/gdbinit)放入`~/.gdbinit`，然后：

*   附上gdb：`gdb -p` *`PID`*
*   获取 python 堆栈跟踪：`pystack`

不幸的是，它并不完全可靠，但它在大多数情况下都有效。

最后，附加`strace`通常可以让您很好地了解进程正在做什么。

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2010-04-02T23:23:47.080

我几乎总是在处理多个线程，而主线程通常做的不多，所以最有趣的是转储所有堆栈（这更像是 Java 的转储）。这是基于[此博客](http://bzimmer.ziclix.com/2008/12/17/python-thread-dumps/)的实现：

```
import threading, sys, traceback

def dumpstacks(signal, frame):
    id2name = dict([(th.ident, th.name) for th in threading.enumerate()])
    code = []
    for threadId, stack in sys._current_frames().items():
        code.append("\n# Thread: %s(%d)" % (id2name.get(threadId,""), threadId))
        for filename, lineno, name, line in traceback.extract_stack(stack):
            code.append('File: "%s", line %d, in %s' % (filename, lineno, name))
            if line:
                code.append("  %s" % (line.strip()))
    print("\n".join(code))

import signal
signal.signal(signal.SIGQUIT, dumpstacks) 
```

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2015-04-26T18:22:20.033

获取*未准备好的 python 程序的堆栈跟踪，在**没有调试符号*的股票 python 中运行可以使用[pyrasite](http://pyrasite.readthedocs.org/)完成。在 Ubuntu Trusty 上对我来说就像一个魅力：

```
$ sudo pip install pyrasite
$ echo 0 | sudo tee /proc/sys/kernel/yama/ptrace_scope
$ sudo pyrasite 16262 dump_stacks.py # dumps stacks to stdout/stderr of the python program 
```

（向@Albert 致敬，他的回答包含指向此的指针以及其他工具。）

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2008-09-25T08:29:32.643

```
>>> import traceback
>>> def x():
>>>    print traceback.extract_stack()

>>> x()
[('<stdin>', 1, '<module>', None), ('<stdin>', 2, 'x', None)] 
```

您还可以很好地格式化堆栈跟踪，请参阅[文档](http://docs.python.org/lib/module-traceback.html)。

**编辑**：要模拟 Java 的行为，如 @Douglas Leeder 所建议的，添加以下内容：

```
import signal
import traceback

signal.signal(signal.SIGUSR1, lambda sig, stack: traceback.print_stack(stack)) 
```

到应用程序中的启动代码。`SIGUSR1`然后您可以通过发送到正在运行的 Python 进程来打印堆栈。

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2008-09-25T08:27:16.923

[**traceback**](https://docs.python.org/2/library/traceback.html)模块有一些不错的功能，其中包括： print_stack：

```
import traceback

traceback.print_stack() 
```

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2013-04-26T22:18:58.280

你可以试试[faulthandler 模块](http://docs.python.org/dev/library/faulthandler.html)。使用安装它`pip install faulthandler`并添加：

```
import faulthandler, signal
faulthandler.register(signal.SIGUSR1) 
```

在您的程序开始时。然后将 SIGUSR1 发送到您的进程（例如：）以将`kill -USR1 42`所有线程的 Python 回溯显示到标准输出。[阅读文档](http://docs.python.org/dev/library/faulthandler.html)以获取更多选项（例如：登录文件）和其他显示回溯的方式。

该模块现在是 Python 3.3 的一部分。对于 Python 2，请参阅[http://faulthandler.readthedocs.org/](http://faulthandler.readthedocs.org/)

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2009-03-06T12:49:11.137

真正帮助我的是[spiv 的提示](https://stackoverflow.com/questions/132058/getting-stack-trace-from-a-running-python-application/147114#147114)（如果我有声誉点，我会投票并评论）从一个*未准备*好的Python 进程中获取堆栈跟踪。[除了在我修改 gdbinit 脚本](http://lists.osafoundation.org/pipermail/chandler-dev/2007-January/007519.html)之前它没有工作。所以：

*   下载[http://svn.python.org/projects/python/trunk/Misc/gdbinit](http://svn.python.org/projects/python/trunk/Misc/gdbinit)并放入`~/.gdbinit`

*   ~~编辑它，更改`PyEval_EvalFrame`为`PyEval_EvalFrameEx`~~[编辑：不再需要；截至 2010 年 1 月 14 日，链接文件已经有此更改]

*   附上gdb：`gdb -p PID`

*   获取 python 堆栈跟踪：`pystack`

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2008-09-25T08:24:24.997

*python -dv yourscript.py*

这将使解释器在调试模式下运行，并为您提供解释器正在做什么的踪迹。

如果你想交互式地调试代码，你应该像这样运行它：

*python -m pdb yourscript.py*

这告诉 python 解释器使用作为 python 调试器的模块“pdb”运行你的脚本，如果你运行它，解释器将以交互模式执行，就像 GDB

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2011-03-31T16:30:51.250

我会将此作为评论添加到[haridsv 的回复](https://stackoverflow.com/questions/132058/getting-stack-trace-from-a-running-python-application/2569696#2569696)中，但我缺乏这样做的声誉：

我们中的一些人仍然坚持使用早于 2.6 的 Python 版本（Thread.ident 需要），所以我得到了在 Python 2.5 中工作的代码（尽管没有显示线程名称），如下所示：

```
import traceback
import sys
def dumpstacks(signal, frame):
    code = []
    for threadId, stack in sys._current_frames().items():
            code.append("\n# Thread: %d" % (threadId))
        for filename, lineno, name, line in traceback.extract_stack(stack):
            code.append('File: "%s", line %d, in %s' % (filename, lineno, name))
            if line:
                code.append("  %s" % (line.strip()))
    print "\n".join(code)

import signal
signal.signal(signal.SIGQUIT, dumpstacks) 
```

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2012-01-26T13:57:38.473

看看[`faulthandler`](http://docs.python.org/3.3/whatsnew/3.3.html#faulthandler)Python 3.3 中的新模块。[`faulthandler`PyPI](https://pypi.python.org/pypi/faulthandler/)上提供了用于 Python 2 的反向移植。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2020-04-01T16:07:26.837

它可以用优秀[的 py-spy](https://pypi.org/project/py-spy/)来完成。它是*Python 程序的采样分析器*，因此它的工作是附加到 Python 进程并对其调用堆栈进行采样。因此，您需要做的就是转储进程`py-spy dump --pid $SOME_PID`中所有线程的调用堆栈。`$SOME_PID`通常它需要升级权限（读取目标进程的内存）。

这是一个线程化 Python 应用程序的示例。

```
$ sudo py-spy dump --pid 31080
Process 31080: python3.7 -m chronologer -e production serve -u www-data -m
Python v3.7.1 (/usr/local/bin/python3.7)

Thread 0x7FEF5E410400 (active): "MainThread"
    _wait (cherrypy/process/wspbus.py:370)
    wait (cherrypy/process/wspbus.py:384)
    block (cherrypy/process/wspbus.py:321)
    start (cherrypy/daemon.py:72)
    serve (chronologer/cli.py:27)
    main (chronologer/cli.py:84)
    <module> (chronologer/__main__.py:5)
    _run_code (runpy.py:85)
    _run_module_as_main (runpy.py:193)
Thread 0x7FEF55636700 (active): "_TimeoutMonitor"
    run (cherrypy/process/plugins.py:518)
    _bootstrap_inner (threading.py:917)
    _bootstrap (threading.py:885)
Thread 0x7FEF54B35700 (active): "HTTPServer Thread-2"
    accept (socket.py:212)
    tick (cherrypy/wsgiserver/__init__.py:2075)
    start (cherrypy/wsgiserver/__init__.py:2021)
    _start_http_thread (cherrypy/process/servers.py:217)
    run (threading.py:865)
    _bootstrap_inner (threading.py:917)
    _bootstrap (threading.py:885)
...
Thread 0x7FEF2BFFF700 (idle): "CP Server Thread-10"
    wait (threading.py:296)
    get (queue.py:170)
    run (cherrypy/wsgiserver/__init__.py:1586)
    _bootstrap_inner (threading.py:917)
    _bootstrap (threading.py:885) 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2011-08-28T21:30:38.647

在 Solaris 上，您可以使用 pstack(1) 无需更改 python 代码。例如。

```
# pstack 16000 | grep : | head
16000: /usr/bin/python2.6 /usr/lib/pkg.depotd --cfg svc:/application/pkg/serv
[ /usr/lib/python2.6/vendor-packages/cherrypy/process/wspbus.py:282 (_wait) ]
[ /usr/lib/python2.6/vendor-packages/cherrypy/process/wspbus.py:295 (wait) ]
[ /usr/lib/python2.6/vendor-packages/cherrypy/process/wspbus.py:242 (block) ]
[ /usr/lib/python2.6/vendor-packages/cherrypy/_init_.py:249 (quickstart) ]
[ /usr/lib/pkg.depotd:890 (<module>) ]
[ /usr/lib/python2.6/threading.py:256 (wait) ]
[ /usr/lib/python2.6/Queue.py:177 (get) ]
[ /usr/lib/python2.6/vendor-packages/pkg/server/depot.py:2142 (run) ]
[ /usr/lib/python2.6/threading.py:477 (run)
etc. 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2012-04-15T20:28:10.047

我一直在寻找调试线程的解决方案，多亏了haridsv，我在这里找到了它。我使用使用 traceback.print_stack() 的稍微简化的版本：

```
import sys, traceback, signal
import threading
import os

def dumpstacks(signal, frame):
  id2name = dict((th.ident, th.name) for th in threading.enumerate())
  for threadId, stack in sys._current_frames().items():
    print(id2name[threadId])
    traceback.print_stack(f=stack)

signal.signal(signal.SIGQUIT, dumpstacks)

os.killpg(os.getpgid(0), signal.SIGQUIT) 
```

为了我的需要，我还按名称过滤线程。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2013-06-24T08:03:31.333

如果您使用的是 Linux 系统，请使用`gdb`Python 调试扩展（可以是 in`python-dbg`或`python-debuginfo`package）的强大功能。它还有助于多线程应用程序、GUI 应用程序和 C 模块。

运行你的程序：

```
$ gdb -ex r --args python <programname>.py [arguments] 
```

这指示`gdb`准备`python <programname>.py <arguments>`和`r`取消它。

现在当你程序挂起时，切换到`gdb`控制台，按下`Ctr+C`并执行：

```
(gdb) thread apply all py-list 
```

[在此处](http://wiki.python.org/moin/DebuggingWithGdb)和[此处](http://fedoraproject.org/wiki/Features/EasierPythonDebugging)查看[示例会话](https://code.google.com/p/spyderlib/wiki/HowToDebugDeadlock)和更多信息。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2012-04-06T18:49:30.193

我将一些附加到正在运行的 Python 进程中并注入一些代码以获取 Python shell 的工具组合在一起。

见这里：[https ://github.com/albertz/pydbattach](https://github.com/albertz/pydbattach)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-01-29T01:28:29.677

值得一看[Pydb](http://bashdb.sourceforge.net/pydb/)，“一个松散地基于 gdb 命令集的 Python 调试器的扩展版本”。它包括信号管理器，可以在发送指定信号时负责启动调试器。

一个 2006 Summer of Code 项目着眼于在名为[mpdb](http://svn.python.org/projects/sandbox/trunk/pdb/)的模块中向 pydb 添加远程调试功能。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2014-05-01T09:40:07.037

[pyringe](https://github.com/google/pyringe)是一个调试器，可以与正在运行的 python 进程交互、打印堆栈跟踪、变量等，而无需任何先验设置。

虽然我过去经常使用信号处理程序解决方案，但在某些环境中重现问题通常仍然很困难。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2021-08-06T19:18:23.160

从 Austin 3.3 开始，您可以使用该`-w/--where`选项发出当前堆栈跟踪。见[https://stackoverflow.com/a/70905181/1838793](https://stackoverflow.com/a/70905181/1838793)

[![在此处输入图像描述](https://i.stack.imgur.com/B6vFQ.png)](https://i.stack.imgur.com/B6vFQ.png)

如果您想查看正在运行的 Python 应用程序以查看类似 top 的 fashon 中的“实时”调用堆栈，您可以使用 austin-tui ( [https://github.com/p403n1x87/austin-tui](https://github.com/p403n1x87/austin-tui) )。您可以从 PyPI 安装它，例如

```
pipx install austin-tui 
```

请注意，它需要 austin 二进制文件才能工作（[https://github.com/p403n1x87/austin](https://github.com/p403n1x87/austin)），但是您可以使用以下命令附加到正在运行的 Python 进程

```
austin-tui -p <pid> 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-04-27T00:54:57.780

您可以使用[PuDB](https://pypi.python.org/pypi/pudb)，一个带有 curses 接口的 Python 调试器来执行此操作。只需添加

```
from pudb import set_interrupt_handler; set_interrupt_handler() 
```

到您的代码并在您想要中断时使用 Ctrl-C。如果您错过它并想再试一次，您可以继续`c`并再次中断多次。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-04-18T12:31:10.410

我在 GDB 阵营中使用 python 扩展。关注[https://wiki.python.org/moin/DebuggingWithGdb](https://wiki.python.org/moin/DebuggingWithGdb)，意思是

1.  `dnf install gdb python-debuginfo`或者`sudo apt-get install gdb python2.7-dbg`
2.  `gdb python <pid of running process>`
3.  `py-bt`

还要考虑`info threads`和`thread apply all py-bt`。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-01-16T20:47:57.340

如何调试**控制台中**的任何功能：

****在使用 pdb.set_trace()**的地方**创建函数**，然后创建要调试的函数。**

 **```
>>> import pdb
>>> import my_function

>>> def f():
...     pdb.set_trace()
...     my_function()
... 
```

然后调用创建函数：

```
>>> f()
> <stdin>(3)f()
(Pdb) s
--Call--
> <stdin>(1)my_function()
(Pdb) 
```

调试愉快:)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2020-08-07T12:41:51.983

您可以使用[hypno](https://pypi.org/project/hypno/)包，如下所示：

```
hypno <pid> "import traceback; traceback.print_stack()" 
```

这会将堆栈跟踪打印到程序的标准输出中。

或者，如果您不想将任何内容打印到标准输出，或者您无权访问它（例如守护程序），您可以使用[madbg](https://github.com/kmaork/madbg)包，它是一个允许您附加到正在运行的 python 调试器python 程序并在您当前的终端中调试它。它类似于`pyrasite`and `pyringe`，但更新，不需要 gdb，并`IPython`用于调试器（这意味着颜色和自动完成）。

要查看正在运行的程序的堆栈跟踪，您可以运行：

```
madbg attach <pid> 
```

在调试器外壳中，输入： `bt`

免责声明 - 我写了两个包

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-25T09:06:39.747

我不知道有什么类似于[java 对 SIGQUIT 的响应](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/stack.html)，因此您可能必须将其构建到您的应用程序中。也许您可以在另一个线程中创建一个服务器，该服务器可以在响应某种消息时获得堆栈跟踪？

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-25T09:09:54.670

没有办法挂钩到正在运行的 python 进程并获得合理的结果。如果进程锁定，我会做些什么来连接 strace 并试图弄清楚到底发生了什么。

不幸的是，通常 strace 是“修复”竞争条件的观察者，因此输出在那里也无用。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-09-16T06:44:42.513

使用检查模块。

> > > import inspect help(inspect.stack) 模块检查中函数堆栈的帮助：

stack(context=1) 返回调用者框架上方堆栈的记录列表。

我觉得它确实很有帮助。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2014-12-14T02:16:25.313

在 Python 3 中，pdb 将在您第一次在调试器中使用 c(ont(inue)) 时自动安装信号处理程序。之后按 Control-C 会让你回到那里。在 Python 2 中，这是一个即使在相对较旧的版本中也应该工作的单行代码（在 2.7 中测试，但我将 Python 源代码检查回 2.4 并且看起来还不错）：

```
import pdb, signal
signal.signal(signal.SIGINT, lambda sig, frame: pdb.Pdb().set_trace(frame)) 
```

如果您花费任何时间调试 Python，pdb 是值得学习的。该界面有点迟钝，但任何使用过类似工具（例如 gdb）的人都应该熟悉。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-04-28T06:15:05.903

如果您需要使用 uWSGI 执行此操作，它内置了[Python Tracebacker](http://uwsgi-docs.readthedocs.org/en/latest/Tracebacker.html)，只需在配置中启用它即可（编号附在每个工作人员的名称上）：

```
py-tracebacker=/var/run/uwsgi/pytrace 
```

完成此操作后，您只需连接到套接字即可打印回溯：

```
uwsgi --connect-and-read /var/run/uwsgi/pytrace1 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2020-05-23T16:59:38.833

在代码运行的地方，您可以插入这个小片段以查看格式良好的打印堆栈跟踪。它假定您`logs`在项目的根目录中有一个名为的文件夹。

```
# DEBUG: START DEBUG -->
import traceback

with open('logs/stack-trace.log', 'w') as file:
    traceback.print_stack(file=file)
# DEBUG: END DEBUG --! 
```

# postgresql - 如何检查我是否只删除了所需的数据？

> ID：132070
> 
> 赞同：1
> 
> 时间：2008-09-25T08:10:16.357
> 
> 标签：postgresql, constraints, referential-integrity, pg-dump

我有一个非常大的数据库（在 PostgreSQL 上运行），其中包含许多具有复杂关系的表（外键、删除级联等）。我需要从多个表中删除一些数据，但我不确定由于级联删除而真正从数据库中删除的数据量。

如何检查我不会删除不应删除的数据？

我有一个测试数据库 - 只是真实数据库的副本，我可以在其中做我想做的事:)

我唯一的想法是前后转储数据库并检查它。但是看起来不太舒服。另一个想法 - 转储数据库的一部分，正如我认为的那样，它不应该受到我的 DELETE 语句的影响，并在数据删除之前和之后检查这部分。但我认为没有简单的方法可以做到这一点（有数百个表，删除应该与其中的 10 个一起使用）。有什么办法吗？

任何其他想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T08:23:43.453

您可以查询 information_schema 以绘制有关如何在数据库中定义约束的图片。然后你就会知道删除时会发生什么。这不仅对这种情况有用，而且总是有用。

类似的东西（用于约束）

```
select table_catalog,table_schema,table_name,column_name,rc.* from
information_schema.constraint_column_usage ccu, 
information_schema.referential_constraints rc 
where ccu.constraint_name = rc.constraint_name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T11:58:41.847

使用 psql，启动一个事务，执行你的删除操作，然后运行你能想到的任何检查查询。然后，您可以回滚或提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T08:15:35.393

如果担心键悬空（即：指向已删除的记录），则在您的测试数据库上运行删除，然后使用查询查找现在指向无效目标的任何键。（当你这样做时，你还可以确保应该不受影响的部分没有改变）

更好的解决方案是花时间映射删除级联，以便您知道会发生什么 - 了解数据库的工作方式非常有价值，因此在此特定删除之外花费的精力将很有用。

而且，无论您多么确定在进行重大更改之前备份数据库！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T08:57:05.900

感谢您的回答！

Vinko，您的回答对我非常有用，我将研究它。

实际上，就我而言，比较记录删除前后的表计数并检查哪些表受其影响就足够了。

它是通过下面描述的简单命令完成的

```
psql -U U_NAME -h`hostname` -c '\d' | awk '{print $3}' > tables.list

for i in `cat tables.list `; do echo -n "$i: " >> tables.counts; psql -U U_NAME -h`hostname` -t -c "select count(*) from $i" >> tables.counts; done

for i in `cat tables.list `; do echo -n "$i: " >> tables.counts2; psql -U U_NAME -h`hostname` -t -c "select count(*) from $i" >> tables.counts2; done

diff tables.counts tables.counts2 
```

# matlab - 你最喜欢的 MATLAB/Octave 编程技巧是什么？

> ID：132092
> 
> 赞同：73
> 
> 时间：2008-09-25T08:19:30.750
> 
> 标签：matlab, octave

我想每个人都会同意 MATLAB 语言不漂亮，或者特别一致。但是没关系！我们仍然必须使用它来完成工作。

你最喜欢的让事情变得更简单的技巧是什么？让我们每个答案都有一个，这样人们可以在他们同意的情况下投票。另外，试着用一个例子来说明你的答案。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-14T19:06:58.057

使用内置分析器查看我的代码的热门部分在哪里：

```
profile on
% some lines of code
profile off
profile viewer 
```

或仅使用内置`tic`并`toc`获得快速计时：

```
tic;
% some lines of code
toc; 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-10T17:05:44.217

使用逻辑数组直接提取矩阵中满足特定条件的元素：

```
x = rand(1,50) .* 100;
xpart = x( x > 20 & x < 35); 
```

现在 xpart 仅包含 x 中位于指定范围内的那些元素。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-09-25T12:03:11.727

通过在帮助注释中添加“SEE ALSO”行，可以快速访问其他功能文档。首先，您必须在第一行注释中包含所有大写的函数名称。做你通常的评论标题的东西，然后把 SEE ALSO 放在逗号分隔的其他相关函数列表中。

```
function y = transmog(x)
%TRANSMOG Transmogrifies a matrix X using reverse orthogonal eigenvectors
%
% Usage:
%   y = transmog(x)
%
% SEE ALSO
% UNTRANSMOG, TRANSMOG2 
```

当您在命令行中键入“help transmog”时，您将在此注释标题中看到所有注释，并带有指向列出的其他功能的注释标题的超链接。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-09-25T11:57:23.223

使用单个冒号将矩阵转换为向量。

```
x = rand(4,4);
x(:) 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-10-14T19:20:28.887

[向量化循环](http://www.mathworks.com/support/tech-notes/1100/1109.html)。有很多方法可以做到这一点，在你的代码中寻找循环并看看它们如何被向量化是很有趣的。向量运算的性能惊人地快！

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2008-12-19T22:08:51.620

匿名函数，原因如下：

1.  为一次性使用创建一个快速函数，例如 3x^2+2x+7。（见下面的清单）这对于像`quad`和`fminbnd`以函数作为参数的函数很有用。它在脚本（不以函数头开头的.m 文件）中也很方便，因为与真正的函数不同，您不能包含子函数。
2.  对于[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))——尽管匿名函数有一点限制，因为似乎没有办法在其中进行赋值以改变状态。

.

```
% quick functions
f = @(x) 3*x.^2 + 2*x + 7;
t = (0:0.001:1);
plot(t,f(t),t,f(2*t),t,f(3*t));

% closures (linfunc below is a function that returns a function,
% and the outer functions arguments are held for the lifetime
% of the returned function.
linfunc = @(m,b) @(x) m*x+b;
C2F = linfunc(9/5, 32);
F2C = linfunc(5/9, -32*5/9); 
```

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2009-04-08T13:14:36.973

Matlab 的[bsxfun](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/bsxfun.html)、[arrayfun](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/arrayfun.html)、[cellfun](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/cellfun.html)和[structfun](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/structfun.html)非常有趣，并且经常节省循环。

```
M = rand(1000, 1000);
v = rand(1000,    1);
c = bsxfun(@plus, M, v); 
```

例如，此代码将列向量 v 添加到矩阵 M 的每一列。

但是，在应用程序的性能关键部分，您应该将这些函数与普通的 for 循环进行基准测试，因为通常循环仍然更快。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2008-12-19T21:28:07.630

[图形中公式的 LaTeX 模式](http://www.mathworks.com/access/helpdesk/help/techdoc/creating_plots/f0-4741.html#f0-28104)：在最近的版本之一（R2006？）中，您`,'Interpreter','latex'`在函数调用的末尾添加附加参数，它将使用 LaTeX 渲染。这是一个例子：

```
t=(0:0.001:1);
plot(t,sin(2*pi*[t ; t+0.25]));
xlabel('t'); 
ylabel('$\hat{y}_k=sin 2\pi (t+{k \over 4})$','Interpreter','latex');
legend({'$\hat{y}_0$','$\hat{y}_1$'},'Interpreter','latex'); 
```

不确定他们何时添加它，但它在 text()、title()、xlabel()、ylabel()、zlabel() 甚至 legend() 函数中与 R2006b 一起使用。只需确保您使用的语法没有歧义（因此对于 legend()，您需要将字符串指定为元胞数组）。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2009-10-23T06:55:54.550

使用 xlim 和 ylim 绘制垂直和水平线。例子：

1.  在 y=10 处画一条水平线：

    `line(xlim, [10 10])`

2.  在 x=5 处绘制垂直线：

    `line([5 5], ylim)`

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2008-09-25T08:21:34.207

这是一个简单的例子：

我发现逗号分隔的列表语法对于构建函数调用非常有用：

```
% Build a list of args, like so:
args = {'a', 1, 'b', 2};
% Then expand this into arguments:
output = func(args{:}) 
```

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2008-12-19T21:25:41.070

这里有一堆不时有用的非显而易见的函数：

*   `mfilename`（返回当前运行的 MATLAB 脚本的名称）
*   `dbstack`（让您可以访问 matlab 函数堆栈的名称和行号）
*   `keyboard`（停止执行并将控制权交给调试提示；这就是为什么在调试提示中有一个 K`K>>`
*   `dbstop error`（自动使您进入调试模式，在触发错误的行停止）

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2008-09-28T22:13:05.220

使用 nargin 设置可选参数的默认值，使用 nargout 设置可选输出参数。快速示例

```
function hLine=myplot(x,y,plotColor,markerType)
% set defaults for optional paramters
if nargin<4, markerType='none'; end
if nargin<3, plotColor='k'; end

hL = plot(x,y,'linetype','-', ...  
              'color',plotColor, ...
              'marker',markerType, ...
              'markerFaceColor',plotColor,'markerEdgeColor',plotColor);

% return handle of plot object if required
if nargout>0, hLine = hL; end 
```

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2008-09-25T08:21:39.357

从 Matlab 调用 Java 代码

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2009-01-08T05:25:37.707

我喜欢使用函数句柄有很多原因。一方面，它们是我在 MATLAB 中发现的最接近指针的东西，因此您可以为对象创建类似引用的行为。你也可以用它们做一些简洁（更简单）的事情。例如，替换 switch 语句：

```
switch number,
  case 1,
    outargs = fcn1(inargs);
  case 2,
    outargs = fcn2(inargs);
  ...
end
%
%can be turned into
%
fcnArray = {@fcn1, @fcn2, ...};
outargs = fcnArray{number}(inargs); 
```

我只是觉得像这样的小东西很酷。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2008-09-25T12:34:15.410

cellfun 和 arrayfun 用于自动 for 循环。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-01-23T19:04:43.457

了解您的[轴属性](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/axes_props.html)！您可以设置各种东西来调整默认绘图属性以执行您想要的操作：

```
set(gca,'fontsize',8,'linestyleorder','-','linewidth',0.3,'xtick',1:2:9); 
```

（例如，设置 fontsize 为 8pt，所有新行的 linestyles 都为实心，宽度为 0.3pt，xtick 点为 [1 3 5 7 9]）

[Line](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/line_props.html)和[figure](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/figure_props.html)属性也很有用，但我发现自己最常使用轴属性。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2008-10-14T19:14:29.540

哦，反转一个数组

```
v = 1:10;
v_reverse = v(length(v):-1:1); 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2008-09-26T10:50:22.097

用于操作数组的冒号运算符。

@ScottieT812，提到一个：展平数组，但是还有选择数组位的所有其他变体：

```
 x=rand(10,10);
flattened=x(:);
Acolumn=x(:,10);
Arow=x(10,:);

y=rand(100);
firstSix=y(1:6);
lastSix=y(end-5:end);
alternate=y(1:2:end); 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2008-12-19T22:14:20.143

赋值左侧的条件参数：

```
t = (0:0.005:10)';
x = sin(2*pi*t);
x(x>0.5 & t<5) = 0.5;
% This limits all values of x to a maximum of 0.5, where t<5
plot(t,x); 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2009-04-08T13:40:54.740

在使用 min、max、mean、diff、sum、any、all 等聚合函数时，请严格指定维度

例如这一行：

```
reldiff = diff(a) ./ a(1:end-1) 
```

可能很好地计算向量中元素的相对差异，但是如果向量退化为只有一个元素，则计算失败：

```
>> a=rand(1,7);
>> diff(a) ./ a(1:end-1)

ans =
   -0.5822   -0.9935  224.2015    0.2708   -0.3328    0.0458

>> a=1;
>> diff(a) ./ a(1:end-1)
??? Error using ==> rdivide
Matrix dimensions must agree. 
```

如果您为函数指定正确的维度，则此行将返回一个空的 1×0 矩阵，这是正确的：

```
>> diff(a, [], 2) ./ a(1, 1:end-1)

ans =

   Empty matrix: 1-by-0

>> 
```

最小函数也是如此，它通常计算矩阵上列的最小值，直到矩阵仅包含一行。- 然后它将返回该行的最小值，除非维度参数另有说明，并且可能会破坏您的应用程序。

我几乎可以向您保证，因此设置这些聚合函数的维度将为您以后节省相当多的调试工作。

至少对我来说是这样。:)

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2010-10-14T09:19:22.680

为了能够快速测试一个功能，我`nargin`这样使用：

```
function result = multiply(a, b)
if nargin == 0 %no inputs provided, run using defaults for a and b
    clc;
    disp('RUNNING IN TEST MODE')
    a = 1;
    b = 2;
end

result = a*b; 
```

稍后，我添加了一个单元测试脚本来测试不同输入条件的函数。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2008-10-14T19:11:26.800

使用 ismember() 合并由文本标识符组织的数据。当您分析条目（在我的情况下为公司符号）来来去去的不同时期时很有用。

```
%Merge B into A based on Text identifiers
UniverseA = {'A','B','C','D'};
UniverseB = {'A','C','D'};

DataA = [20 40 60 80];
DataB = [30 50 70];

MergeData = NaN(length(UniverseA),2);

MergeData(:,1) = DataA;

[tf, loc] = ismember(UniverseA, UniverseB);

MergeData(tf,2) = DataB(loc(tf));

 MergeData =

20    30
40   NaN
60    50
80    70 
```

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2011-04-28T04:13:31.677

询问“为什么”（有助于让我在凌晨 3 点从 Matlab 运行时失败调试恍惚状态中惊醒……）

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2008-12-19T21:41:11.350

使用命令直接从脚本（而不是交互式）执行 Simulink 模型`sim`。您可以执行诸如从工作区变量中获取参数之类的操作，并`sim`在循环中重复运行以模拟某些内容，同时改变参数以查看行为如何变化，并使用您喜欢的任何图形命令绘制结果。比尝试以交互方式执行此操作要容易得多，并且在可视化结果时，它为您提供比 Simulink“示波器”块更大的灵活性。（虽然你不能用它来查看模拟运行时实时发生的事情）

要知道的一个非常重要的事情是命令的`DstWorkspace`和`SrcWorkspace`选项[`simset`](http://www.mathworks.com/access/helpdesk/help/toolbox/simulink/slref/simset.html)。这些控制“To Workspace”和“From Workspace”块获取和放置结果的位置。`Dstworkspace`默认为当前工作区（例如，如果您`sim`从函数内部调用，“To Workspace”块将显示为可从同一函数内访问的变量）但`SrcWorkspace`默认为基本工作区，如果您想封装对您的调用，`sim`您将想要设置`SrcWorkspace`为`current`有一个干净的界面来提供/检索模拟输入参数和输出。例如：

```
function Y=run_my_sim(t,input1,params)
% runs "my_sim.mdl" 
% with a From Workspace block referencing I1 as an input signal
% and parameters referenced as fields of the "params" structure
% and output retrieved from a To Workspace block with name O1.
opt = simset('SrcWorkspace','current','DstWorkspace','current');
I1 = struct('time',t,'signals',struct('values',input1,'dimensions',1));
Y = struct;
Y.t = sim('my_sim',t,opt);
Y.output1 = O1.signals.values; 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2008-12-19T21:45:37.923

`[c,h]=contour`带有和的等高线图`clabel(c,h,'fontsize',fontsize)`。我通常使用该`fontsize`参数来减小字体大小，这样数字就不会相互碰撞。这对于查看 2-D 函数的值非常有用，而无需处理 3D 图形。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-11-12T15:43:44.387

矢量化：

```
function iNeedle = findClosest(hay,needle)
%FINDCLOSEST find the indicies of the closest elements in an array.
% Given two vectors [A,B], findClosest will find the indicies of the values
% in vector A closest to the values in vector B.
[hay iOrgHay] = sort(hay(:)');  %#ok must have row vector

% Use histogram to find indices of elements in hay closest to elements in
% needle. The bins are centered on values in hay, with the edges on the
% midpoint between elements.
[iNeedle iNeedle] = histc(needle,[-inf hay+[diff(hay)/2 inf]]); %#ok

% Reversing the sorting.
iNeedle = iOrgHay(iNeedle); 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2011-06-27T11:27:11.257

[`persistent`](http://www.mathworks.com/help/techdoc/ref/persistent.html)运行在线算法时使用（静态）变量。它可以加快贝叶斯机器学习等领域的代码速度，在这些领域中，模型会针对新样本进行迭代训练。例如，为了计算独立的对数似然，我最初从头开始计算对数似然，并通过将先前计算的对数似然和附加的对数似然相加来更新它。

我没有给出更专业的机器学习问题，而是给出一个我[从这里](http://undergraduate.csse.uwa.edu.au/units/CITS1005/lectures/topic10.pdf)获取的一般在线平均代码：

```
function av = runningAverage(x)
% The number of values entered so far - declared persistent.
persistent n;
% The sum of values entered so far - declared persistent.
persistent sumOfX;
if x == 'reset' % Initialise the persistent variables.
    n = 0;
    sumOfX = 0;
    av = 0;
else % A data value has been added.
    n = n + 1;
    sumOfX = sumOfX + x;
    av = sumOfX / n; % Update the running average.
end 
```

然后，调用将给出以下结果

```
runningAverage('reset')
ans = 0
>> runningAverage(5)
ans = 5
>> runningAverage(10)
ans = 7.5000
>> runningAverage(3)
ans = 6
>> runningAverage('reset')
ans = 0
>> runningAverage(8)
ans = 8 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2009-10-01T22:27:26.997

- 您可以创建一个名为 startup.m 的初始化文件的 Matlab 快捷方式。在这里，我为我的 Matlab 会话定义了格式、输出精度和绘图参数（例如，我使用更大的绘图轴/字体大小，以便在我将它们放在演示文稿中时可以清楚地看到 .fig。）来自其中一位开发人员的博客文章[http://blogs.mathworks.com/loren/2009/03/03/whats-in-your-startupm/](http://blogs.mathworks.com/loren/2009/03/03/whats-in-your-startupm/)。

- 您可以使用“加载”功能加载整个数字 ascii 文件。这不是特别快，但可以快速完成原型设计工作（这不应该是 Matlab 的座右铭吗？）

- 如前所述，冒号运算符和矢量化是救命稻草。螺旋环。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2009-04-08T13:56:33.970

令我惊讶的是，虽然人们提到了索引数组的逻辑数组方法，但没有人提到 find 命令。

例如，如果 x 是一个 NxMxO 数组

x(x>20) 通过生成 NxMxO 逻辑数组并使用它来索引 x 工作（如果您有大型数组并且正在寻找一个小子集，这可能会很糟糕

x(find(x>20)) 的工作原理是生成满足 x>20 的 x 的索引列表（即 1xwhatever），并通过它索引 x。根据我的经验，应该更多地使用“查找”。

更多我称之为“技巧”的东西

如果你不知道你需要的大小，你可以增长/追加到数组和单元格数组，通过使用 end + 1 （也适用于更高的维度，只要切片的维度匹配 - 所以你会在这种情况下，必须将 x 初始化为 [] 以外的其他值）。不适用于数值，但适用于小型动态列表（或元胞数组），例如解析文件。

例如

```
>> x=[1,2,3]
x = 1 2 3
>> x(结束+1)=4
x = 1 2 3 4

```

另一个很多人不知道的想法是适用于任何 dim 1 阵列，所以继续这个例子

```
>> for n = x;disp(n);end
     1
     2
     3
     4

```

这意味着如果您只需要 x 的成员，您就不需要索引它们。

这也适用于单元格数组，但有点烦人，因为当它遍历它们时，元素仍然包裹在一个单元格中：

```
>> for el = {1,2,3,4};disp(el);end
    [1]
    [2]
    [3]
    [4]

```

因此，要获取元素，您必须为它们下标

```
>> for el = {1,2,3,4};disp(el{1});end
     1
     2
     3
     4

```

我不记得是否有更好的方法。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2010-12-22T02:33:52.537

> x=repmat([1:10],3,1); % 说，x 是一个示例数据数组
> 
> l=x>=3；% l 是一个逻辑向量（1s/0s），用于突出显示数组中满足特定条件的那些元素。
> 
> N=sum(sum(l));% N 是满足给定条件的元素个数。

干杯——快乐的脚本！

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2011-07-25T13:30:42.140

这是我经常使用的：

`% useful abbreviations`

 ````
flat=@(x) x(:);

% print basic statistics
stats=@(x) sprintf('mean +/- s.d. \t= %f +/- %f\nmin, max \t\t= %f, %f\nmedian, mode \t= %f, %f', ...
    mean(flat(x)), std(flat(x)), min(flat(x)), max(flat(x)), median(flat(x)), mode(flat(x)) );

nrows=@(x) size(x,1);
ncols=@(x) size(x,2);
nslices=@(x) size(x,3);

% this is just like ndims except it returns 0 for an empty matrix and
% ignores dimensions of size 0.
ndim=@(x) length(find(size(x))); 
````  `这些缩写对于在图像的小区域中查找像素值的平均值和标准偏差很有用。我会使用以下逻辑：

`phantomData = phantom();`

 ````
stats( phantomData(50:80, 50:80) ) 
````  `如果我想将图像的大小放在标题中怎么办？

`imagesc( phantomData );`

 ````
title( sprintf('The image size is %d by %d by %d.', nrows(phantomData), ncols(phantomData), nslices(phantomData)) ) 
````  `# gcc - 如何用谷歌搜索--depend？

> ID：132105
> 
> 赞同：5
> 
> 时间：2008-09-25T08:23:39.943
> 
> 标签：gcc, search-engine

我们从第三方供应商处收到的最新生成文件包含带有 --depend 于构建规则结束的规则，所以我想我会在 Google 上查找它，但尽我所能，我无法说服它显示任何具有确切字符的页面 --depend

我试过用引号“--depend”包围它：我试过高级搜索：我试过反斜杠“\-\-depend”（徒劳）希望有某种未发布的正则表达式搜索可用的。

我错过了一些非常明显的东西吗？

请注意，这不是关于 --depend 做什么的问题，我知道，这是关于您如何在 Google 上搜索非常精确、面向程序员的文本的问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T08:39:00.890

您可以在 Google 代码搜索中指定文字符号，但不能在 Google Web 搜索中指定。

例子;

[Google 代码搜索 +"--depend"](http://www.google.com/codesearch?hl=en&lr=&q=%2B%22--depend%22&sbtn=Search)

[Google 网页搜索 +"--depend"](http://www.google.com/search?hl=en&q=%2B%22--depend%22&btnG=Search)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T09:25:59.037

此问题的原因是令牌开头的减号表示您希望将其从搜索中排除。

这就是您可以过滤掉与您想要的真正无关的非常受欢迎的结果的方法。

例如，尝试搜索“哇”。然后尝试搜索“哇-魔兽”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T08:29:20.257

我记得在[某处读过](http://www.caliban.org/ruby/APIs_Reference.html)谷歌的网络搜索不会索引非字母数字字符，将它们视为单词分隔符，所以这是不可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T08:32:34.277

我在搜索“语法规则”时遇到了同样的问题。你会认为他们现在已经解决了这个问题。

# windows - Windows XP 是否支持带有 AES256 的 TLS1.1？

> ID：132113
> 
> 赞同：2
> 
> 时间：2008-09-25T08:27:09.077
> 
> 标签：windows, security

Windows XP SP3 中是否包含 TLS 1.1 支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T08:55:47.730

仅在 Windows Vista 中不包含 TLS 1.1 支持。

# c++ - Heisenbug：WinApi 程序在某些计算机上崩溃

> ID：132116
> 
> 赞同：9
> 
> 时间：2008-09-25T08:27:40.980
> 
> 标签：c++, debugging, winapi, crash, gdi

请帮忙！我真的束手无策。我的程序是一个小小的个人笔记管理器（谷歌搜索“cintanotes”）。在某些计算机上（当然我不拥有它们），它在启动后因未处理的异常而崩溃。这些计算机没有什么特别之处，只是它们往往具有 AMD CPU。

环境：Windows XP、Visual C++ 2005/2008、原始 WinApi。

这是关于这个“Heisenbug”的肯定：

1) 崩溃仅发生在 Release 版本中。

2) 一旦我删除所有与 GDI 相关的东西，崩溃就会消失。

3) BoundChecker 没有任何抱怨。

4) 写日志显示崩溃发生在声明局部 int 变量时！怎么可能？内存损坏？

任何想法将不胜感激！

**更新：我已经设法在“故障”PC 上调试了该应用程序。结果：**

“CintaNotes.exe 中 0x0044a26a 处未处理的异常：0xC000001D：非法指令。”

和代码中断

0044A26A cvtsi2sd xmm1,dword ptr [esp+14h]

**所以似乎问题出在“代码生成/启用增强指令集”编译器选项中。它被设置为“/arch:SSE2”并且在不支持 SSE2 的机器上崩溃。我已将此选项设置为“未设置”，并且该错误消失了。呸！**

非常感谢大家的帮助！！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T08:46:59.983

> 4) 写日志显示崩溃发生在声明局部 int 变量时！怎么可能？内存损坏？

可执行文件/程序集中的底层代码是什么？int 的声明根本不是代码，因此不会崩溃。您是否以某种方式初始化 int ？

要查看发生崩溃的代码，您应该执行所谓的事后分析。

## Windows 错误报告

如果你想分析崩溃，你应该得到一个崩溃转储。一种选择是注册 Windows 错误报告 - 需要一些钱（您需要一个数字代码签名 ID）和一些表格填写。有关更多信息，请访问[https://winqual.microsoft.com/](https://winqual.microsoft.com/)。

## 直接从客户那里获取用于 WER 的故障转储

另一种选择是与一些正在经历崩溃的用户取得联系，并直接从他那里获得用于 WER 的崩溃转储。用户可以在将崩溃发送给 Microsoft 之前单击技术详细信息来执行此操作 - 可以在此处检查崩溃转储文件的位置。

## 你自己的小型转储

另一种选择是注册您自己的异常处理程序，处理异常并在您希望的任何地方编写一个小型转储。详细说明可以在[Code Project Post-Mortem Debugging Your Application with Minidumps 和 Visual Studio .NET 文章中](http://www.codeproject.com/KB/debug/postmortemdebug_standalone1.aspx)找到。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T08:38:13.093

所以当配置是 DEBUG 配置时它不会崩溃？与 RELEASE 配置有很多不同：1.) 全局变量的初始化 2.) 生成的实际机器代码等。

所以第一步是找出 RELEASE 模式下每个参数的确切设置与 DEBUG 模式相比。

-广告

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T08:43:52.173

> 1) 崩溃仅发生在 Release 版本中。

这通常表明您依赖于某些无法保证的行为，但在调试版本中恰好是正确的。例如，如果您忘记初始化变量，或访问超出范围的数组。确保您已打开所有编译器检查 (/RTCsuc)。还要检查依赖函数参数的评估顺序（不能保证）。

> 2) 一旦我删除所有与 GDI 相关的东西，崩溃就会消失。

也许这暗示你在 GDI 相关的东西上做错了什么？例如，您是否在释放 HANDLE 后使用它们？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T10:09:38.833

下载[适用于 Windows 的调试工具](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)包。正确设置符号路径，然后在 WinDbg 下运行您的应用程序。在某些时候，它会因访问冲突而中断。然后你应该运行命令“！analyze -v”，它非常聪明，应该给你一个关于哪里出了问题的提示。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T08:37:49.927

大多数 heisenbugs / release-only bugs 是由于控制流依赖于从未初始化的内存/过时的指针/缓冲区结束的读取，或竞争条件，或两者兼而有之。

尝试覆盖您的分配器，以便它们在分配时将内存清零。问题是否会消失（或变得更具重现性？）

> 写日志显示崩溃发生在声明本地 int 变量时！怎么可能？内存损坏？

堆栈溢出！;)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T08:46:39.157

对我来说听起来像是堆栈损坏。我最喜欢的追踪工具是[IDA Pro](http://hex-rays.com/idapro/)。当然，您无权访问用户的机器。

一些内存检查器很难发现堆栈损坏（如果确实如此）。我认为最可靠的方法是运行时分析。

这也可能是由于异常路径中的损坏，即使异常已被处理。您是否在打开“捕获第一机会异常”的情况下进行调试？你应该尽可能长。在许多情况下，它确实会在一段时间后变得烦人。

您能否向这些用户发送您的应用程序的检查版本？查看[Minidump](http://msdn.microsoft.com/en-us/library/ms680369(VS.85).aspx) 处理该异常并写出转储。然后使用[WinDbg](http://en.wikipedia.org/wiki/Windbg)进行调试。

另一种方法是编写非常详细的日志。创建一个“记录每个操作”选项，并要求用户将其打开并将其发送给您。将内存转储到日志中。查看 MSDN 上的“_CrtDbgReport()”。

祝你好运！

编辑：

回复您的评论：局部变量声明中的错误对我来说并不奇怪。我已经看到很多了。这通常是由于堆栈损坏。

例如，堆栈上的某些变量可能会超出其边界。在那之后，所有的地狱都崩溃了。然后堆栈变量声明会引发随机内存错误、虚拟表损坏等。

每当我长时间看到这些时，我都不得不去 IDA Pro。 **详细的运行时反汇编调试**是我所知道的唯一真正可靠的东西。

许多开发人员使用 WinDbg 进行这种分析。这就是为什么我还建议使用 Minidump。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T09:05:24.773

> 4) 写日志显示崩溃发生在声明局部 int 变量时！怎么可能？内存损坏

我发现许多“奇怪的崩溃”的原因是取消引用`this`所述对象的成员函数内部的损坏。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T09:08:24.423

试试 Rational (IBM) PurifyPlus。它捕获了许多 BoundsChecker 没有捕获的错误。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T10:02:26.477

崩溃说明了什么？访问冲突？例外 ？这将是解决这个问题的进一步线索

使用 PageHeap.exe 确保没有先前的内存损坏

确保没有堆栈溢出（CBig array[1000000]）

确保您没有未初始化的内存。

此外，一旦为进程生成调试符号（与创建调试版本不同），您也可以在调试器中运行发布版本。逐步检查您是否在调试器跟踪窗口中收到任何警告。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-25T12:40:24.943

"4) 写日志显示崩溃发生在声明局部 int 变量时！怎么可能？内存损坏？

这可能表明硬件实际上有故障或被推得太紧。看看他们是否超频了他们的电脑。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-26T07:32:59.793

当我得到这种类型的东西时，我尝试通过 gimpels PC-Lint（静态代码分析）运行代码，因为它会检查 BoundsChecker 的不同类别的错误。如果您使用的是 Boundschecker，请打开内存中毒选项。

你提到AMD CPU。您是否调查过崩溃的机器上是否有类似的显卡/驱动程序版本和/或配置？它总是在这些机器上崩溃还是偶尔崩溃？也许在这些机器上运行系统信息工具，看看它们有什么共同点，

# java - 如何在 Struts with Tiles 中获取真实的请求 URL？

> ID：132118
> 
> 赞同：13
> 
> 时间：2008-09-25T08:28:19.823
> 
> 标签：java, servlets, struts, tiles

当您将 Tiles 与 Struts 一起使用并执行...

```
request.getRequestURL() 
```

...您获得的 URL 例如`/WEB-INF/jsp/layout/newLayout.jsp`，而不是用户输入/单击的真实 URL，例如`/context/action.do`.

在较新的 Struts 版本 1.3.x 及更高版本中，您可以使用[javaranch 中提到的解决方案](http://saloon.javaranch.com/cgi-bin/ubb/ultimatebb.cgi?ubb=get_topic&f=58&t=012300)并使用 request 属性获取真实 URL [`ORIGINAL_URI_KEY`](http://struts.apache.org/1.x/apidocs/org/apache/struts/Globals.html#ORIGINAL_URI_KEY)。

但是如何在 Struts 1.2.x 中做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-07-21T11:12:01.207

我使用它，它也适用于 Spring：

```
<% out.println(request.getAttribute("javax.servlet.forward.request_uri")); %> 
```

如果您还需要查询字符串（由[matchew 提供](https://stackoverflow.com/users/638649/matchew)）：

```
<% out.println(request.getAttribute("javax.servlet.forward.query_string")); %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-14T18:43:24.587

当您从 view/jsp/tiles 层查询 request.getRequestURL() 时，它已经是另一个重写的请求。

正如 Mwanji Ezana 提到的，最合适的方法是将其保存到动作执行阶段的单独属性中。您可能希望借助 Struts2 中的拦截器自动执行此过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T11:04:11.167

这适用于 Struts 1.2

```
private String getOriginalUri(HttpServletRequest request) {
    String targetUrl = request.getServletPath();
    if (request.getQueryString() != null) {
        targetUrl += "?" + request.getQueryString();
    }
    return targetUrl;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T20:10:08.920

我不知道 Struts 1.2.x 是否有类似的 Globals 常量，但您至少可以通过两种方式创建自己的常量：

*   在 Action 中获取原始请求 URL 并将其设置在请求中，然后从 JSP 中调用它
*   使用 Servlet 过滤器来做同样的事情

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-14T12:06:14.193

您只需要在您的操作中执行此操作：

```
 request.getAttribute("javax.servlet.forward.request_uri") 
```

# c - 是什么让 pthread 失效了？

> ID：132121
> 
> 赞同：2
> 
> 时间：2008-09-25T08:29:15.330
> 
> 标签：c, linux, multithreading, pthreads, procfs

我正在使用当前创建后台线程 (PTHREAD_DETACHED) 然后调用 pthread_exit(0) 的多线程程序（使用 pthreads）。我的问题是该进程随后被列为“已失效”，奇怪的是似乎在 /proc 中并不“真正存在”（这破坏了我的调试策略）

我希望满足以下要求：

*   程序应该循环运行函数 A 和函数 B 一次
*   给定程序 /proc/$pid/exe 的 PID，/proc/$pid/maps 和 /proc/$pid/fd 必须是可访问的（当进程失效时，它们都是空链接或无效链接）
*   必须可以像往常一样使用 CTRL+C 和 CTRL+Z 暂停/中断程序

*编辑：*我犹豫要更改程序的界面，以使 A 在“主”线程中，而 B 在衍生线程中（它们目前以另一种方式）。它会解决问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T12:08:01.720

您可以挂起等待信号的主进程的执行，或者不要分离等待其终止的线程（使用默认的**PHTREAD_CRATE_JOINABLE**`pthread_join()` ） 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T08:36:50.553

有没有理由你不能反过来做：让主线程运行循环，并在后台线程中完成一次性任务？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T14:08:02.347

不是最优雅的设计，但也许你可以在退出之前阻止主线程：

```
 while(1) {
       pause();
 } 
```

然后，您可以为 SIGINT 和 SIGTERM 安装中断循环的信号处理程序。最简单的方法是：exit(0) :-)。

# .net - 是否值得花时间学习 Visual Studio 宏系统（使用创建）？

> ID：132128
> 
> 赞同：1
> 
> 时间：2008-09-25T08:32:00.283
> 
> 标签：.net, visual-studio, macros

我使用 Visual Studio 已经很长时间了，但我从未使用过的一个功能是宏系统。我看到一个帖子，有人提到他使用宏（没有详细说明）所以我想知道花时间学习如何创建宏真的值得吗？

如果是这样，你做什么样的东西？

有类似的帖子，但我试图将这个问题更多地倾向于：值得学习吗？如果可能和/或值得的话，我更倾向于知道某些东西是如何工作的，而不是仅仅使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T08:34:38.297

宏不难学，可以让你的生活更轻松！

有关宏的有趣应用，请参阅此[问题](https://stackoverflow.com/questions/80564/visual-studio-how-to-trigger-an-alarm-when-a-breakpoint-is-hit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T08:37:07.103

您使用宏来简化重复性任务。也就是说，如果您发现自己定期执行 5 或 6 个单独的任务，那么可能值得将其转换为宏，以便您只需单击按钮即可完成。

如果您使用 C++，其他可能感兴趣的事情是从 .cpp 文件切换到 .h 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T08:40:30.373

是的！

虽然我没有太多使用它们 - 学习 VS 宏很容易，所以“投资”很少，你会得到一个可以使用的新工具。

# c# - Visual Studio 生成的服务引用中的 XML 命名空间问题

> ID：132131
> 
> 赞同：2
> 
> 时间：2008-09-25T08:32:54.947
> 
> 标签：c#, .net, wcf, web-services

我正在连接到由第三方提供商托管的 Web 服务。我已经在我的项目中向 Web 服务添加了一个服务引用，VS 已经生成了所有需要的引用和类。

我正在连接这段代码（客户端名称和方法匿名）：

```
 using (var client = new Client())
 {
     try
     {
         client.Open();
         var response = client.Method(...);
         return response.Status;
     }
     catch (SoapException ex)
     {
         throw CreateServiceException(ex);
     }
     finally
     {
          client.Close();
     }
 } 
```

到达 client.Open() 时，我收到一条异常消息：

> 命名空间“”中的顶部 XML 元素“_return”引用了不同的类型 System.Boolean 和 Service.Status。使用 XML 属性为元素或类型指定另一个 XML 名称或命名空间。

在reference.cs 中，我可以看到“_return”变量用

```
[System.ServiceModel.MessageBodyMemberAttribute(Namespace="", Order=0)] 
```

wsdl、生成的服务引用或我的代码是否有问题？

**更新：**将服务生成为老式 Web 服务可以解决问题。我目前已将 Sixto 的答案标记为已接受，但我仍然很好奇可能导致问题的原因以及服务生成器的任何参数是否可以解决原始问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T19:25:09.590

如果您能够创建服务引用，那么 WSDL 是有效的。异常消息是说您的 _return 存在命名空间/类型歧义问题。生成的代码可能在某些上下文中将其用作布尔值，而在另一个上下文中用作 Service.Status 类型。

在调用服务方法之前我不会调用 ClientBase.Open 方法，因为我从未见过需要它。我总是酌情调用 Close & Abort 方法。Open 方法基本上只是将客户端的状态更改为不再可配置。我不确定这将如何触发生成的类中的代码，因为它是一个继承的方法。我会尝试删除该行，看看您是否得到相同的异常。否则，如果您还没有这样做，请在生成的代码中搜索所有使用 _return 的地方，看看您是否可以手动排序出合适的类型。您可能需要为每个上下文使用不同的名称。

Another way to troubleshoot the WSDL is to create a Web Reference (assuming it’s an HTTP based service) and see if the generate code works as expected. If it does work, go with the ASMX client unless you have a need for WCF proxy capabilities.

# user-interface - 用户界面 - 下拉

> ID：132132
> 
> 赞同：4
> 
> 时间：2008-09-25T08:33:32.370
> 
> 标签：user-interface

设计界面的最佳方法是什么，以便由于大小限制而被截断的非常长的下拉值不会造成非常糟糕的用户体验。我的问题是针对 Web 应用程序的。

能否请您发送您的建议。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T08:37:12.033

一种选择是使用带有回发 (AJAX) 的 'type-ahead' 来减小列表的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T08:36:42.860

您可以使用带有列表/网格的另一个窗口（div？），而不是下拉列表。对于一般用户来说，它非常直观。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T08:42:14.457

好吧，我在这种情况下所做的是：

1.  使用自动完成（以便用户可以开始输入并更快地获得预期的选项）。
2.  具有固定长度的下拉菜单，例如 30 个字符。现在，如果下拉列表的值更长，我只需将其截断为 25，并在末尾添加一个“...”。悬停在此值上将使全文显示为“标题”或类似名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T08:57:09.100

下拉列表中的每个项目都有一个工具提示，因此当用户将鼠标指针悬停在某个项目上时，他仍然可以看到该项目的完整描述。

或让您的下拉列表宽度自动调整为列表中最长的描述。

# php - PHP - 安全什么是最好的方法？

> ID：132134
> 
> 赞同：7
> 
> 时间：2008-09-25T08:34:20.153
> 
> 标签：php, security

保护使用`PHP`外部攻击开发的 Intranet 网站的最佳方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-25T13:43:47.880

这是一个令人震惊的发人深省的问题，我很惊讶你没有得到更好的答案。

## 概括

您为面向外部的应用程序所做的一切，然后是一些。

## 思考过程

如果我对您的理解正确，那么您是在问一个*很少*有开发人员会问自己的问题。大多数公司的纵深防御都很差，一旦攻击者进入，他就进入了。显然你想把它提升一个层次。

那么，我们在考虑什么样的攻击呢？
如果我是攻击者并且我正在攻击您的 Intranet 应用程序，那么我必须以某种方式访问​​您的网络。这可能不像听起来那么困难 - 我可能会尝试鱼叉式网络钓鱼（将电子邮件定位到您组织中的个人，包含恶意软件附件或安装恶意软件的网站的链接）以在内部机器上安装木马。

一旦完成此操作（并控制了内部 PC），我将尝试对任何 Internet 应用程序进行的所有相同攻击。

然而，这并不是故事的结局。我有更多选择：如果我有您用户的一台 PC，那么我很可能能够使用键盘记录器来收集用户名和密码，以及查看您所有电子邮件中的姓名和电话号码。
有了这些，我也许可以直接登录您的应用程序。我什至可以学习管理员用户名/密码。即使我不这样做，一份姓名和电话号码列表以及对公司术语的感觉也让我在社交工程方面获得了不错的机会，让我在公司内部更广泛地访问。

## 建议

*   首先，在所有技术解决方案之前：**在安全方面培训您的用户**

保护 Web 应用程序的常见答案：

*   使用多重身份验证
    *   例如用户名/密码和某种伪随机数小工具。
*   清理您的所有输入。
    *   以防止跨站点脚本和 SQL 注入。
*   使用 SSL（也称为 HTTPS）。
    *   这是一个痛苦的设置（编辑：实际上这正在改进），但它可以提供更好的安全性。
*   坚持“职责分离”和“最小特权”的原则
    *   换句话说，通过确保所有用户只拥有完成他们的工作（而不是其他人的工作）所需的权限，您可以确保他们具有绝对最低限度的破坏能力。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-25T08:36:37.247

如果它在内部网络上，为什么甚至可以从外部访问应用程序？至少应该有防火墙规则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T08:41:11.837

最好的办法？禁用直接外部访问！

如果员工*需要*使用它（例如外联网风格的网站），您应该让他们进入 VPN。通过 VPN，您有更多的身份验证选项，其中大多数比让您的 Intranet 服务器从 Internet 访问更安全.

另一种选择（仅在数据是公共安全的情况下才有效）是安排您的 Intranet 服务器将数据**推**送到可从外部访问的另一台服务器。我说推送是因为您真的不希望此服务器访问您的网络。让您的网络服务器完成工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T08:47:45.503

保护它的最佳方法是什么？不要将其连接到网络。让您的用户通过运行 Mosaic 的单个控制台实际进入有人看守的房间。

哦，你想让它易于使用吗？

1.  始终验证可能来自不可信来源的每一个输入。
2.  不要相信任何数据源。
3.  存储密码时，**始终**存储密码的加密哈希。
4.  存储密码时，**切勿**直接存储密码。
5.  切勿收集或存储您实际上不需要的任何数据。
6.  永远不要让自己被诱惑添加额外的花里胡哨。
7.  阅读[Bruce Schneier](http://en.wikipedia.org/wiki/Bruce_Schneier)撰写的关于安全和加密的所有内容。

如果你忘记了这些简单的规则，你会发现你的应用程序出现在各地报纸的头版，就像雅虎邮箱一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T12:51:20.767

如果可能，我会回应 @Oli 并支持 VPN 方法。但是，如果出于任何原因您需要比这更多的任意访问权限，则应使用 SSL 来保护任何身份验证。除了密码身份验证/IP 地址身份验证之外，还值得研究将 SSL 与客户端证书一起使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T08:40:52.477

您只能允许来自 php 应用程序本身的内部 IP 访问。也不要忽视通常的安全和最佳实践。输入验证和输出编码（仅限白名单）、具有散列密码的用户帐户等。

# html - IE6 在隐藏的 div 中显示组件（当它们应该隐藏时！）

> ID：132136
> 
> 赞同：1
> 
> 时间：2008-09-25T08:35:35.110
> 
> 标签：html, css, internet-explorer, internet-explorer-6, rendering

有谁知道 IE6 是否曾经使用 hidden 错误呈现页面`divs`？我们目前有几个`divs`显示在页面的同一空间中，一次只显示一个并隐藏所有其他。

问题是隐藏的`divs`组件（特别是选项菜单）有时会显示出来。如果页面被滚动，从视图中移除组件，然后向下滚动，那么应该隐藏的组件就会消失。

我们如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T08:41:34.723

您可以使用的一种技巧是将 div 移到屏幕外：

```
MyDiv.style.left = "-1000px"; 
```

然后在你想展示的时候把它放回原来的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T08:48:01.977

它们是如何隐藏的？使用`display:none;`或`visibility:hidden;`？他们是绝对定位的吗？IE6 有一个 z-Index 问题，有几个技巧可以解决它。

# asp.net - 具有构建功能和源代码控制的 Asp.net 托管服务提供商

> ID：132139
> 
> 赞同：4
> 
> 时间：2008-09-25T08:35:47.543
> 
> 标签：asp.net, version-control, continuous-integration, hosting

您能否推荐一个具有持续集成（cctray – nant 构建）和源代码控制设施 (svn) 的 asp.net 3.5 托管服务提供商？

我的要求是这样的：

*   我签入到托管服务提供商空间上的一个 svn 分支（比如中继）。
*   服务器上的 CruiseControl.NET 启动构建。
*   我在我的cctray 上看到成功/失败。
*   成功后，我的同行会访问网站（例如[http://trunk.mywebsite.com](http://trunk.mywebsite.com)）并查看更改

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T17:32:07.690

我还必须推荐一个 VPS，因为我还没有看到安装了编译器的共享主机提供商。

在代码存储库方面，[Assembla.com](http://www.assembla.com/)提供免费的 svn 托管，它们还提供了一种启动构建过程的方法，允许您指定在签入时发布的 URL。这个 URL 可以启动一个脚本，该脚本会提取最新的代码并构建它。[您可以在此处](http://blog.assembla.com/assemblablog/tabid/12618/bid/2916/Running-builds-from-Assembla-repositories.aspx)找到有关如何设置的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T08:55:58.400

共享托管服务提供商没有。如果服务消耗过多的处理器/内存，您可能不得不使用 VPS，或者甚至可能是专用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T00:05:49.370

我同意这里的每个人。对于每个自定义需求，在 VPS / 专用服务器上执行您的要求会更便宜。你可能会找到你需要的东西，但成本很高。

# language-agnostic - 循环终止条件

> ID：132164
> 
> 赞同：6
> 
> 时间：2008-09-25T08:42:06.607
> 
> 标签：language-agnostic, for-loop, conditional, correctness

这些`for`循环是算法形式正确性证明的第一个基本示例。它们具有不同但等效的终止条件：

```
1   for ( int i = 0; i != N; ++i )

2   for ( int i = 0; i < N; ++i ) 
```

差异在后置条件中变得很明显：

*   `i == N`第一个给出了循环终止后的有力保证。

*   第二个只给出了循环终止后的弱保证`i >= N`，但你会很想假设`i == N`.

如果由于任何原因增量`++i`更改为类似`i += 2`，或者如果`i`在循环内被修改，或者如果`N`为负数，则程序可能会失败：

*   第一个可能会陷入无限循环。它在有错误的循环中提前失败。调试很容易。

*   第二个循环将终止，并且在稍后的某个时间，由于您对`i == N`. 它可能会在远离导致错误的循环的地方失败，从而难以追溯。或者它可以默默地继续做一些意想不到的事情，这更糟糕。

您更喜欢哪种终止条件，为什么？还有其他考虑吗？为什么许多知道这一点的程序员拒绝应用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T08:57:54.403

我倾向于使用第二种形式，只是因为这样我可以更确定循环将终止。即，通过在循环内更改 i 来引入非终止错误会更加困难。

当然，它还有一个稍微懒惰的优势，那就是少输入一个字符；）

我还要争辩说，在具有合理范围规则的语言中，由于 i 在循环构造内声明，它不应该在循环外可用。这将减轻对 i 在循环结束时等于 N 的任何依赖...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T08:45:34.573

我们不应该孤立地查看计数器 - 如果出于任何原因有人更改了计数器的递增方式，他们将更改终止条件和结果逻辑（如果 i==N 需要）。

我更喜欢第二个条件，因为它更标准并且不会导致无限循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T08:45:30.873

在 C++ 中，`!=`为了通用性，首选使用测试。C++ 中的迭代器有多种概念，例如[输入迭代器](http://www.sgi.com/tech/stl/InputIterator.html)、[前向迭代器](http://www.sgi.com/tech/stl/ForwardIterator.html)、[双向迭代器](http://www.sgi.com/tech/stl/BidirectionalIterator.html)、[随机访问迭代器](http://www.sgi.com/tech/stl/RandomAccessIterator.html)，每一个都扩展了前一个迭代器的新功能。为了`<`工作，需要随机访问迭代器，而`!=`只需要输入迭代器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T08:45:54.273

如果你信任你的代码，你可以做任何一个。

如果您希望您的代码可读且易于理解（从而更宽容地从您必须假设为笨拙的人更改），我会使用类似的东西；

```
for ( int i = 0 ; i >= 0 && i < N ; ++i) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T08:46:14.243

我总是使用#2，因为这样你就可以确定循环将终止......之后依赖它等于 N 是依赖于副作用......你不是更好地使用变量 N 本身吗？

[编辑]对不起......我的意思是＃2

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T08:49:58.883

我认为大多数程序员都使用第二个，因为它有助于弄清楚循环内部发生了什么。我可以看一下，并且“知道”我将从 0 开始，并且肯定会小于 N。

第一个变体没有这种品质。我可以看一下，我所知道的是，我将从 0 开始，并且永远不会等于 N。不太有帮助。

不管你如何终止循环，在循环外使用循环控制变量时要非常小心。在您的示例中，您（正确地）在循环内声明 i ，因此它不在循环外的范围内，并且其值的问题没有实际意义......

当然，第二个变体还有一个优点，那就是我见过的所有 C 引用都使用它:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T09:20:56.843

如果在循环外使用 i，在 c# 中使用上述任何一种都会导致编译器错误

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T09:23:02.377

我有时更喜欢这个：

```
for (int i = 0; (i <= (n-1)); i++) { ... } 
```

这个版本直接显示了我可以拥有的值的范围。我对检查范围的下限和上限的看法是，如果你真的需要这个，你的代码有太多的副作用，需要重写。

另一个版本：

```
for (int i = 1; (i <= n); i++) { ... } 
```

帮助您确定调用循环体的频率。这也有有效的用例。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T08:49:23.470

一般来说，我更喜欢

```
for ( int i = 0; i < N; ++i ) 
```

对生产中的错误程序的惩罚似乎不那么严重，您不会让线程永远卡在 for 循环中，这种情况可能非常危险且难以诊断。

另外，一般来说，我喜欢避免使用这种循环，而使用更具可读性的 foreach 样式循环。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T08:50:33.763

我更喜欢使用#2，只是因为我尽量不在 for 循环之外扩展 i 的含义。如果我要跟踪这样的变量，我会创建一个额外的测试。有人可能会说这是多余或低效的，但它提醒读者我的意图：**在这一点上，我必须等于 N**

@timyates - 我同意不应该依赖副作用

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T08:59:31.683

我认为您很好地说明了两者之间的区别。不过，我确实有以下评论：

*   这不是“与语言无关”，我可以看到您的示例使用 C++，但是有些语言不允许您修改循环内的循环变量，而其他语言不能保证索引的值在之后可用循环（有些人两者都做）。

*   您已经在其中声明了`i` 索引，`for`所以我不会赌`i`循环后的值。这些示例有点误导，因为它们暗示这`for`是一个明确的循环。实际上它只是一种更方便的写作方式：

    ```
    // version 1
    { int i = 0;
      while (i != N) {
        ...
        ++i;
      }
    } 
    ```

    请注意`i`块之后的未定义方式。

如果程序员知道以上所有内容，就不会对 的值进行一般假设，`i`并且足够明智地选择`i<N`作为结束条件，以确保最终满足退出条件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-17T01:06:29.370

对于一般的编程工作，我更喜欢

```
for ( int i = 0; i < N; ++i ) 
```

至

```
for ( int i = 0; i != N; ++i ) 
```

因为它不容易出错，尤其是在代码被重构时。我曾看到这种代码不小心变成了无限循环。

这个论点提出“你会很想假设 i == N”，我不相信这是真的。我从来没有做过这样的假设，也没有见过其他程序员做出这样的假设。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-10-17T15:27:11.850

从形式验证和自动终止分析的角度来看，我非常喜欢#2 ( `<`)。很容易跟踪某些变量的增加（对于某些非负数之前`var = x`，之后）。然而，最终成立并不那么容易。为此，需要推断出在每一步中都会精确地增加，这（在更复杂的示例中）可能会由于抽象而丢失。`var = x+n``n``i==N``i``1`

如果您考虑以 2 ( `i = i + 2`) 递增的循环，则这个一般概念会变得更容易理解。为了保证终止，现在需要知道，而在用作条件`i%2 == N%2`时这无关紧要。`<`

# windows-vista - Vista Serial 以编程方式

> ID：132166
> 
> 赞同：0
> 
> 时间：2008-09-25T08:42:57.807
> 
> 标签：windows-vista

如何获取已安装的 Vista 系统的序列号？还有一个工具可以做同样的事情，所以我可以验证我的结果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T08:47:59.480

工具快速列表：

[http://pcsupport.about.com/od/productkeysactivation/tp/topkeyfinder.htm](http://pcsupport.about.com/od/productkeysactivation/tp/topkeyfinder.htm)

[http://magicaljellybean.com/keyfinder/](http://magicaljellybean.com/keyfinder/)

[http://techblissonline.com/find-product-key-cd-ley-windows-vista-xp-office-2007-sql-server-produkey/](http://techblissonline.com/find-product-key-cd-ley-windows-vista-xp-office-2007-sql-server-produkey/)

# regex - 如何使用正则表达式在 SimpleTest 中编写 AssertTags 测试？

> ID：132186
> 
> 赞同：2
> 
> 时间：2008-09-25T08:46:28.563
> 
> 标签：regex, unit-testing, cakephp, simpletest

我希望测试一个将生成`lorem ipsum`文本的函数，但它是在 html 标记中执行的。所以我不能提前知道文本内容，但我知道 html 结构。这就是我想要测试的。也许文本的长度在一定的范围内。所以我想知道的是 assertTags 是否可以通过以下方式解释：

```
Result = "<p>Some text</p>";
Expected = array( 
   '<p' ,
   'regex',
   '/p'
);
assertTags(resutl, expected) 
```

我正在将 SimpleTest 与 CakePHP 一起使用，但我认为这应该是一个普遍的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T10:21:51.283

```
$expected = array(
    '<p',
    'preg:/[A-Za-z\.\s\,]+/',
    '/p'
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T09:58:38.750

扩展 SimpleExpectation 类，然后在断言语句中使用新的 Expectation 类

见：[http ://www.lastcraft.com/expectation_documentation.php#extending](http://www.lastcraft.com/expectation_documentation.php#extending)

给出的示例用于验证 IP 地址，但应该适用于您的问题：

```
class ValidIp extends SimpleExpectation {

  function test($ip) {
    return (ip2long($ip) != -1);
  }

  function testMessage($ip) {
    return "Address [$ip] should be a valid IP address";
  }
} 
```

然后在你的测试中

```
$this->assert(new ValidIp(),$server->getIp()); 
```

# php - PHP：在 $_SESSION 中存储“对象”

> ID：132194
> 
> 赞同：192
> 
> 时间：2008-09-25T08:48:18.153
> 
> 标签：php, session, object

我刚刚发现我实际上可以**在 $_SESSION 中存储对象，**我觉得这很酷，因为当我跳转到另一个页面时，我仍然有我的对象。现在，在我开始使用这种方法之前，我想知道它是否真的是一个好主意，或者是否存在**潜在的陷阱**。

我知道，如果我有一个单一的入口点，我就不需要这样做，但我还没有到那里，所以我没有单一的入口点，我真的很想保留我的对象，因为我没有不要那样失去我的状态。（现在我还读到我应该对无状态站点进行编程，但我还不明白这个概念。）

**简而言之**：在会话中存储对象可以吗，有什么问题吗？

* * *

编辑：

*临时总结*：到目前为止，我知道**重新创建**对象可能会更好，即使它涉及再次查询数据库。

进一步的答案可能会更**详细地说明这方面**！

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-02-05T15:39:38.090

我知道这个话题已经过时了，但是这个问题不断出现，并且没有让我满意：

无论您将对象保存在 $_SESSION 中，还是根据隐藏在表单字段中的数据重建它们，或者每次从数据库中重新查询它们，您都在使用状态。HTTP 是无状态的（或多或少；但请参阅 GET 与 PUT），但几乎任何人关心的 Web 应用程序都需要在某处维护状态。表现得好像将国家推入角落和缝隙相当于某种理论上的胜利是错误的。国家就是国家。如果您使用状态，您将失去无状态所获得的各种技术优势。除非你事先知道你应该为此失眠，否则这不是失眠的事情。

我对汉克·盖伊提出的“双重打击”论点所获得的祝福感到特别困惑。OP 是否在构建分布式负载均衡的电子商务系统？我的猜测是否定的；我将进一步假设序列化他的 $User 类或其他任何东西不会使他的服务器无法修复。我的建议：使用对您的应用程序敏感的技术。$_SESSION 中的对象很好，但须遵守常识性预防措施。如果您的应用程序突然变成在流量服务方面与亚马逊相媲美的东西，您将需要重新调整。这就是生活。

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2008-09-25T08:49:56.573

只要在调用 session_start() 时，PHP 已经遇到了类声明/定义，或者可以通过已安装的自动加载器找到，就可以了。否则它将无法从会话存储中反序列化对象。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-09-25T08:51:51.280

HTTP 是无状态协议是有原因的。会话将状态焊接到 HTTP。根据经验，避免使用会话状态。

更新：在 HTTP 级别没有会话的概念；服务器通过给客户端一个唯一的 ID 并告诉客户端在每次请求时重新提交它来提供这一点。然后服务器使用该 ID 作为 Session 对象的大哈希表的键。每当服务器收到请求时，它都会根据客户端随请求提交的 ID 从会话对象的哈希表中查找会话信息。所有这些额外的工作都是对可扩展性的双重打击（HTTP 是无状态的一个重要原因）。

*   Whammy One：它减少了单个服务器可以做的工作。
*   重击之二：这使得扩展变得更加困难，因为现在您不能只将请求路由到任何旧服务器 - 它们并不都有相同的会话。您可以将具有给定会话 ID 的所有请求固定到同一服务器。这并不容易，而且是单点故障（不是针对整个系统，而是针对大部分用户）。或者，您可以在集群中的所有服务器之间共享会话存储，但现在您有更多的复杂性：网络附加内存、独立会话服务器等。

鉴于所有这些，您在会话中输入的信息越多，对性能的影响就越大（正如 Vinko 指出的那样）。正如 Vinko 指出的那样，如果您的对象不可序列化，则会话将行为不端。因此，根据经验，避免在会话中放置超过绝对必要的内容。

@Vinko您通常可以通过在您发回的响应中嵌入您正在跟踪的数据并让客户端重新提交它来解决服务器存储状态的问题，例如，将数据发送到隐藏的输入中。如果您*真的*需要服务器端状态跟踪，它可能应该在您的后备数据存储中。

（Vinko 补充说：PHP 可以使用数据库来存储会话信息，并且让客户端每次重新提交数据可能会解决潜在的可扩展性问题，但会带来一大堆安全问题，您必须注意现在客户端控制所有您的国家）

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-09-25T08:52:23.213

*   无法序列化（或包含不可序列化成员）的对象不会像您期望的那样从 $_SESSION 中出来
*   巨大的会话给服务器带来了负担（每次序列化和反序列化大量状态的成本很高）

除此之外，我没有看到任何问题。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-25T09:03:43.593

以我的经验，对于比具有某些属性的 StdClass 更复杂的东西通常不值得。反序列化的成本一直高于在给定会话存储标识符的情况下从数据库重新创建。这看起来很酷，但（一如既往）分析是关键。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-25T09:01:04.957

我建议不要使用 state ，除非你绝对需要它。如果您可以在不使用会话的情况下重建对象，请执行此操作。在您的 Web 应用程序中拥有状态会使应用程序的构建更加复杂，对于每个请求，您都必须查看用户处于什么状态。当然，有时您无法避免使用会话（例如：用户必须在会话期间保持登录状态）网络应用程序）。最后，我建议让您的会话对象尽可能小，因为它会影响序列化和反序列化大对象的性能。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-25T08:55:27.857

您必须记住资源类型（例如数据库连接或文件指针）不会在页面加载之间持续存在，您需要在不可见的情况下重新创建这些资源类型。

还要考虑会话的大小，取决于它的存储方式，您可能有大小限制或延迟问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-02-10T23:44:51.180

我也会在升级软件库时提出——我们升级了我们的软件，旧版本的对象与 V1 软件的类名在会话中，新软件在尝试构建会话中的对象时崩溃了——作为 V2软件不再使用那些相同的类，它找不到它们。我们必须放入一些修复代码来检测会话对象，如果找到则删除会话，重新加载页面。最初最大的痛苦是当它第一次被报告时你正在重新创建这个错误（太熟悉了，“好吧，它对我有用”:) 因为它只影响最近进出新旧系统的人 - 但是，很好我们在发布之前确实找到了它，因为我们所有的用户肯定会在他们的会话中拥有旧的会话变量，并且可能会导致所有人崩溃，

Anyway, as you suggest in your amendment, I also think it's better to re-create the object. So maybe just storing id and then on each request pulling the object from the database, is better/safer.

# operating-system - 什么是服务器的最佳操作系统？

> ID：132195
> 
> 赞同：1
> 
> 时间：2008-09-25T08:49:17.747
> 
> 标签：operating-system

您认为 Web 服务器的最佳操作系统是什么？

如果可能，请列举优点和缺点，如果有任何...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T08:54:05.673

使用您拥有管理员帐户的操作系统。

Linux 的主流风格是稳定性的绝佳选择，但如果没有人知道如何照顾它，那就不是一个好主意。您可以命名的任何其他平台也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T08:57:45.963

如果语言是 PHP，则使用 Linux 系统。Windows 也支持它，但在我看来，Linux 是大多数人用于 PHP 的，因此有更多文档可以使用 PHP 设置一个像样的 Linux 服务器。

我不知道要使用哪种 Linux 发行版，但我相信有人会这样做:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T08:51:14.760

我会说[CentOS](http://www.centos.org/) - 以稳定性着称。我曾经担任托管服务提供商的管理员 - 我们使用它并且从未遇到过问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T11:57:14.067

就个人而言，我更喜欢 Solaris 或 BSD 以获得稳定性。但是，Linux 和 Windows 都更易于操作，并提供更多标准功能，但可靠性略低。

选择你最了解的，你会得到最好的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T08:50:39.457

这实际上取决于网络服务器的功能。它应该提供哪些服务？是否应该有一个主页，应该是什么语言，等等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T08:52:52.933

Linux 或 Windows 都可以很好地完成这项工作。如果你是为自己做这件事，那么 Linux 是一条更简单的路线，因为有很多免费的选择。

如果您代表一家不介意支付费用的公司提出要求，那么这实际上取决于员工的经验。

# java - 分布式处理：JTA 的 C++ 等价物

> ID：132210
> 
> 赞同：1
> 
> 时间：2008-09-25T08:53:13.883
> 
> 标签：java, c++, transactions, distributed

我正在开发一个关键任务解决方案，其中数据完整性至关重要，性能紧随其后。如果数据被塞满，那将是灾难性的。

因此，我正在寻找 JTA（Java 事务 API）的 C/C++ 版本。有谁知道任何支持分布式事务的 C 或 C++ 库？是的，我用谷歌搜索了它......不成功。

我不想被告知没有，我需要实现[Distributed TP: The XA Specification](http://www.opengroup.org/pubs/catalog/c193.htm)指定的协议。

请帮忙！

* * *

编辑（回应 kervin）：如果我需要跨多个数据库服务器插入记录并且我需要原子地提交它们，那么像 Oracle 之类的产品将为此提供解决方案。如果我编写了自己的消息队列服务器并且我想以原子方式将消息提交到多个服务器，我将需要 JTA 之类的东西来确保我不会填充事务的原子性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T08:58:06.367

Encina、DCE-RPC、TUXEDO、可能是 CORBA（虽然我不太建议使用 CORBA）、MTS（再次，嗯）。

这些是分布式事务处理所需的东西。

[Encina](http://www.zois.co.uk/tpm/encina.html)曾经有很多关于其基于 DCE 的系统的优秀文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-14T07:18:44.283

Oracle Tuxedo 是这个领域中重达 800 磅的大猩猩，实际上是大部分 XA 规范的基础。它提供分布式事务管理，每秒可以处理数百个数千个请求。

更多信息：[http ://www.oracle.com/tuxedo](http://www.oracle.com/tuxedo)

此外，如果您喜欢 SCA（服务组件体系结构），还有一个名为 SALT 的 Tuxedo 附加产品，它提供了一个用于 C++、Python、Ruby 和 PHP 编程的 SCA 容器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T09:22:33.173

有数百个。严重地。

就一般地区而言。查看[面向服务的架构](http://en.wikipedia.org/wiki/Service-oriented_architecture)，大多数新产品都在该领域问世。例如。[RogueWave HydraSCA](http://roguewave.com/products/hydra/hydrasca.php)

我会从简单的 Rogue Wave Suite 开始，然后在查看该设计后看看是否需要[Enterprise Service Bus 。](http://en.wikipedia.org/wiki/Enterprise_service_bus)

这可能很大程度上取决于您的设计要求和预算。

# java - 处理命令行参数和 Spring

> ID：132231
> 
> 赞同：39
> 
> 时间：2008-09-25T08:59:36.067
> 
> 标签：java, spring, command-line

当我编写解析命令行参数的 Spring 命令行应用程序时，如何将它们传递给 Spring？我是否想让我的 main() 结构化，以便它首先解析命令行参数然后初始化 Spring？即便如此，它如何将保存已解析参数的对象传递给 Spring？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-09-25T18:12:21.153

我能想到的两种可能。

1）设置静态参考。（静态变量，虽然通常不受欢迎，但在这种情况下是可以的，因为只能有 1 个命令行调用）。

```
public class MyApp {
  public static String[] ARGS; 
  public static void main(String[] args) {
    ARGS = args;
      // create context
  }
} 
```

然后，您可以通过以下方式引用 Spring 中的命令行参数：

```
<util:constant static-field="MyApp.ARGS"/> 
```

或者（如果您完全反对静态变量），您可以：

2) 以编程方式将参数添加到应用程序上下文中：

```
 public class MyApp2 {
   public static void main(String[] args) {
     DefaultListableBeanFactory beanFactory = new DefaultListableBeanFactory();

        // Define a bean and register it
     BeanDefinition beanDefinition = BeanDefinitionBuilder.
       rootBeanDefinition(Arrays.class, "asList")
       .addConstructorArgValue(args).getBeanDefinition();
     beanFactory.registerBeanDefinition("args", beanDefinition);
     GenericApplicationContext cmdArgCxt = new GenericApplicationContext(beanFactory);
     // Must call refresh to initialize context 
     cmdArgCxt.refresh();

     // Create application context, passing command line context as parent
     ApplicationContext mainContext = new ClassPathXmlApplicationContext(CONFIG_LOCATIONS, cmdArgCxt);

     // See if it's in the context
     System.out.println("Args: " + mainContext.getBean("args"));
   }

   private static String[] CONFIG_LOCATIONS = new String[] {
     "applicationContext.xml"
   };

 } 
```

解析命令行参数留给读者作为练习。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-01-15T12:41:38.673

看看我的 Spring-CLI 库 - 在[http://github.com/sazzer/spring-cli](http://github.com/sazzer/spring-cli) - 作为这样做的一种方式。它为您提供了一个自动加载 spring 上下文的主类，并能够使用 Commons-CLI 自动解析命令行参数并将它们注入到您的 bean 中。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-01-27T07:46:44.180

从 Spring 3.1 开始，其他答案中建议的任何自定义代码都不需要。检查[CommandLinePropertySource](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/env/CommandLinePropertySource.html)，它提供了一种将 CL 参数注入上下文的自然方式。

如果您是一位幸运的 Spring Boot 开发人员，您可以利用[SpringApplication](http://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/SpringApplication.html)为您提供以下事实的事实进一步简化您的代码：

> 默认情况下，类将执行以下步骤来引导您的应用程序：
> 
> ...
> 
> 注册一个 CommandLinePropertySource 以将命令行参数公开为 Spring 属性

如果您对 Spring Boot 属性解析顺序感兴趣，请查阅[此页面](https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-20T00:57:06.180

您还可以将 Object 数组作为第二个参数传递，该数组`getBean`将用作构造函数或工厂的参数。

```
public static void main(String[] args) {
   Mybean m = (Mybean)context.getBean("mybean", new Object[] {args});
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-28T16:29:27.653

考虑以下类：

```
public class ExternalBeanReferneceFactoryBean 
    extends AbstractFactoryBean
    implements BeanNameAware {

    private static Map<String, Object> instances = new HashMap<String, Object>();
    private String beanName;

    /**
     * @param instance the instance to set
     */
    public static void setInstance(String beanName, Object instance) {
        instances.put(beanName, instance);
    }

    @Override
    protected Object createInstance() 
        throws Exception {
        return instances.get(beanName);
    }

    @Override
    public Class<?> getObjectType() {
        return instances.get(beanName).getClass();
    }

    @Override
    public void setBeanName(String name) {
        this.beanName = name;
    }

} 
```

随着：

```
/**
 * Starts the job server.
 * @param args command line arguments
 */
public static void main(String[] args) {

    // parse the command line
    CommandLineParser parser = new GnuParser();
    CommandLine cmdLine = null;
    try {
        cmdLine = parser.parse(OPTIONS, args);
    } catch(ParseException pe) {
        System.err.println("Error parsing command line: "+pe.getMessage());
        new HelpFormatter().printHelp("command", OPTIONS);
        return;
    }

    // create root beanFactory
    DefaultListableBeanFactory beanFactory = new DefaultListableBeanFactory();

    // register bean definition for the command line
    ExternalBeanReferneceFactoryBean.setInstance("commandLine", cmdLine);
    beanFactory.registerBeanDefinition("commandLine", BeanDefinitionBuilder
        .rootBeanDefinition(ExternalBeanReferneceFactoryBean.class)
        .getBeanDefinition());

    // create application context
    GenericApplicationContext rootAppContext = new GenericApplicationContext(beanFactory);
    rootAppContext.refresh();

    // create the application context
    ApplicationContext appContext = new ClassPathXmlApplicationContext(new String[] { 
        "/commandlineapp/applicationContext.xml"
    }, rootAppContext);

    System.out.println(appContext.getBean("commandLine"));

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T10:39:58.680

这是一个为 Main 方法引导 spring 的示例，只需像往常一样获取传递的参数，然后使您在 bean 上调用的函数（在这种情况下为 deployer.execute()）将它们作为字符串或通过您认为合适的任何格式.

```
public static void main(String[] args) throws IOException, ConfigurationException {
    Deployer deployer = bootstrapSpring();

    deployer.execute();
}

private static Deployer bootstrapSpring()
{
    FileSystemXmlApplicationContext appContext = new FileSystemXmlApplicationContext("spring/deployerContext.xml");

    Deployer deployer = (Deployer)appContext.getBean("deployer");
    return deployer;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-20T15:34:17.260

我不确定您到底要达到什么目标，也许您可​​以添加一些有关命令和参数的外观以及您期望从应用程序获得什么结果的详细信息。

我认为这不是您所需要的，但它可能会帮助其他读者：Spring 支持使用双连字符从命令行接收属性（例如`java -jar app.jar --my.property="Property Value"` ，查看此文档以获取更多信息： [https ://docs.spring.io/spring -boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-command-line-args](https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-command-line-args)

# php - 在 PHP4 中用于 XML 解析/读取的内容

> ID：132233
> 
> 赞同：2
> 
> 时间：2008-09-25T09:00:10.417
> 
> 标签：php, xml, web-services

不幸的是，我必须在`PHP4`服务器上使用较旧的 Web 应用程序；它现在需要解析大量的`XM`L 来调用`webservices (custom protocol, no SOAP/REST)`；

在`PHP5`我会使用`SimpleXML`但不可用的情况下；`Dom XML`在中有`PHP4`，但在 中不再是默认值`PHP5`。

还有哪些其他选择？我正在寻找一种在`PHP5`迁移后仍然有效的解决方案。

如果`XML`可以使用模式进行验证，那将是一个很好的附加条件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T09:01:24.923

有一个 simpleXML backport 可用：[http ://www.ister.org/code/simplexml44/index.html](http://www.ister.org/code/simplexml44/index.html)

如果您可以安装它，那么这将是最好的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T09:21:21.740

我会支持[Rich Bradshaw](https://stackoverflow.com/questions/132233/what-to-use-for-xml-parsing-reading-in-php4#132238)关于 simpleXML backport 的建议，但如果这不是一个选项，那么[xml_parse](http://ie2.php.net/manual/en/function.xml-parse.php)将在 PHP4 中完成这项工作，并且在迁移到 5 后仍然可以工作。

```
$xml = ...; // Get your XML data
$xml_parser = xml_parser_create();

// _start_element and _end_element are two functions that determine what
// to do when opening and closing tags are found
xml_set_element_handler($xml_parser, "_start_element", "_end_element");

// How to handle each char (stripping whitespace if needs be, etc
xml_set_character_data_handler($xml_parser, "_character_data");  

xml_parse($xml_parser, $xml); 
```

这里有一个关于在 PHP4 中解析 XML 的很好的[教程](http://www.developertutorials.com/tutorials/php/parsing-xml-using-php4-050816/page4.html)，可能对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T14:35:35.573

我肯定会推荐 SimpleXML backport，只要它的性能足以满足您的需求。xml_parse 的演示看起来很简单，但根据我的经验，它很快就会变得非常棘手。内容处理程序函数不会获取有关解析器在树中位置的任何上下文信息，除非您跟踪它并在开始和结束标记处理程序中提供它。所以你要么为每个开始/结束标签调用函数，要么抛出全局变量来跟踪你在树中的位置。

显然，SimpleXML 反向移植会慢一些，因为它是用 PHP 编写的，并且必须在可用之前解析整个文档，但编码的简单性足以弥补这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T11:25:19.167

如果你可以使用 xml_parse，那就去吧。它健壮、快速并且与 PHP5 兼容。然而，它不是 DOM 解析器，而是更简单的基于事件的解析器（[也称为 SAX 解析器](http://en.wikipedia.org/wiki/Simple_API_for_XML)），因此如果您需要访问树，则必须自己将流编组为树。这很容易做到；使用 s 堆栈，并将项目推送到它`start-element`并弹出`end-element`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T09:02:45.670

它可能有点草根，但如果它适用于您正在使用的数据，您可以使用 XSLT 将您的 XML 转换为可用的东西。显然，一旦您升级到 PHP5，XSLT 仍然可以工作，您可以随时迁移到 DOM 解析。

安德鲁

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-22T15:26:13.257

也许还可以考虑查看 PEAR 中可用的 XML 包，特别是*XML_Util*、*XML_Parser*和*XML_Serializer* ...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-02T10:25:17.597

带有 parse_into_struct 的 XML Parser 变成了树数组结构：

```
<?php
/**
 * What to use for XML parsing / reading in PHP4
 * @link http://stackoverflow.com/q/132233/367456
 */

$encoding = 'US-ASCII';
         // https://gist.github.com/hakre/46386de578619fbd898c
$path     = dirname(__FILE__) . '/time-series-example.xml';

$parser_creator = 'xml_parser_create'; // alternative creator is 'xml_parser_create_ns'

if (!function_exists($parser_creator)) {
    trigger_error(
        "XML Parsers' $parser_creator() not found. XML Parser "
        . '<http://php.net/xml> is required, activate it in your PHP configuration.'
        , E_USER_ERROR
    );
    return;
}

$parser = $parser_creator($encoding);
if (!$parser) {
    trigger_error(sprintf('Unable to create a parser (Encoding: "%s")', $encoding), E_USER_ERROR);
    return;
}

xml_parser_set_option($parser, XML_OPTION_CASE_FOLDING, 0);
xml_parser_set_option($parser, XML_OPTION_SKIP_WHITE, 1);

$data = file_get_contents($path);
if ($data === FALSE) {
    trigger_error(sprintf('Unable to open file "%s" for reading', $path));
    return;
}
$result = xml_parse_into_struct($parser, $data, $xml_struct_values);
unset($data);
xml_parser_free($parser);
unset($parser);

if ($result === 0) {
    trigger_error(sprintf('Unable to parse data of file "%s" as XML', $path));
    return;
}

define('TREE_NODE_TAG', 'tagName');
define('TREE_NODE_ATTRIBUTES', 'attributes');
define('TREE_NODE_CHILDREN', 'children');

define('TREE_NODE_TYPE_TAG', 'array');
define('TREE_NODE_TYPE_TEXT', 'string');
define('TREE_NODE_TYPE_NONE', 'NULL');

/**
 * XML Parser indezies for parse into struct values
 */
define('XML_STRUCT_VALUE_TYPE', 'type');
define('XML_STRUCT_VALUE_LEVEL', 'level');
define('XML_STRUCT_VALUE_TAG', 'tag');
define('XML_STRUCT_VALUE_ATTRIBUTES', 'attributes');
define('XML_STRUCT_VALUE_VALUE', 'value');

/**
 * XML Parser supported node types
 */
define('XML_STRUCT_TYPE_OPEN', 'open');
define('XML_STRUCT_TYPE_COMPLETE', 'complete');
define('XML_STRUCT_TYPE_CDATA', 'cdata');
define('XML_STRUCT_TYPE_CLOSE', 'close');

/**
 * Tree Creator
 * @return array
 */
function tree_create()
{
    return array(
        array(
            TREE_NODE_TAG        => NULL,
            TREE_NODE_ATTRIBUTES => NULL,
            TREE_NODE_CHILDREN   => array(),
        )
    );
}

/**
 * Add Tree Node into Tree a Level
 *
 * @param $tree
 * @param $level
 * @param $node
 * @return array|bool Tree with the Node added or FALSE on error
 */
function tree_add_node($tree, $level, $node)
{
    $type = gettype($node);
    switch ($type) {
        case TREE_NODE_TYPE_TEXT:
            $level++;
            break;
        case TREE_NODE_TYPE_TAG:
            break;
        case TREE_NODE_TYPE_NONE:
            trigger_error(sprintf('Can not add Tree Node of type None, keeping tree unchanged', $type, E_USER_NOTICE));
            return $tree;
        default:
            trigger_error(sprintf('Can not add Tree Node of type "%s"', $type), E_USER_ERROR);
            return FALSE;
    }

    if (!isset($tree[$level - 1])) {
        trigger_error("There is no parent for level $level");
        return FALSE;
    }

    $parent = & $tree[$level - 1];

    if (isset($parent[TREE_NODE_CHILDREN]) && !is_array($parent[TREE_NODE_CHILDREN])) {
        trigger_error("There are no children in parent for level $level");
        return FALSE;
    }

    $parent[TREE_NODE_CHILDREN][] = & $node;
    $tree[$level]                 = & $node;

    return $tree;
}

/**
 * Creator of a Tree Node
 *
 * @param $value XML Node
 * @return array Tree Node
 */
function tree_node_create_from_xml_struct_value($value)
{
    static $xml_node_default_types = array(
        XML_STRUCT_VALUE_ATTRIBUTES => NULL,
        XML_STRUCT_VALUE_VALUE      => NULL,
    );

    $orig = $value;

    $value += $xml_node_default_types;

    switch ($value[XML_STRUCT_VALUE_TYPE]) {
        case XML_STRUCT_TYPE_OPEN:
        case XML_STRUCT_TYPE_COMPLETE:
            $node = array(
                TREE_NODE_TAG => $value[XML_STRUCT_VALUE_TAG],
                // '__debug1' => $orig,
            );
            if (isset($value[XML_STRUCT_VALUE_ATTRIBUTES])) {
                $node[TREE_NODE_ATTRIBUTES] = $value[XML_STRUCT_VALUE_ATTRIBUTES];
            }
            if (isset($value[XML_STRUCT_VALUE_VALUE])) {
                $node[TREE_NODE_CHILDREN] = (array)$value[XML_STRUCT_VALUE_VALUE];
            }
            return $node;

        case XML_STRUCT_TYPE_CDATA:
            // TREE_NODE_TYPE_TEXT
            return $value[XML_STRUCT_VALUE_VALUE];

        case XML_STRUCT_TYPE_CLOSE:
            return NULL;

        default:
            trigger_error(
                sprintf(
                    'Unkonwn Xml Node Type "%s": %s', $value[XML_STRUCT_VALUE_TYPE], var_export($value, TRUE)
                )
            );
            return FALSE;
    }
}

$tree = tree_create();

while ($tree && $value = array_shift($xml_struct_values)) {
    $node = tree_node_create_from_xml_struct_value($value);
    if (NULL === $node) {
        continue;
    }
    $tree = tree_add_node($tree, $value[XML_STRUCT_VALUE_LEVEL], $node);
    unset($node);
}

if (!$tree) {
    trigger_error('Parse error');
    return;
}

if ($xml_struct_values) {
    trigger_error(sprintf('Unable to process whole parsed XML array (%d elements left)', count($xml_struct_values)));
    return;
}

// tree root is the first child of level 0
print_r($tree[0][TREE_NODE_CHILDREN][0]); 
```

输出：

```
Array
(
    [tagName] => dwml
    [attributes] => Array
        (
            [version] => 1.0
            [xmlns:xsd] => http://www.w3.org/2001/XMLSchema
            [xmlns:xsi] => http://www.w3.org/2001/XMLSchema-instance
            [xsi:noNamespaceSchemaLocation] => http://www.nws.noaa.gov/forecasts/xml/DWMLgen/schema/DWML.xsd
        )

    [children] => Array
        (
            [0] => Array
                (
                    [tagName] => head
                    [children] => Array
                        (
                            [0] => Array
                                (
                                    [tagName] => product
                                    [attributes] => Array
                                        (
                                            [srsName] => WGS 1984
                                            [concise-name] => time-series
                                            [operational-mode] => official
                                        )

                                    [children] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [tagName] => title
                                                    [children] => Array
                                                        (
                                                            [0] => NOAA's National Weather Service Forecast Data
                                                        )

                                                )

                                            [1] => Array
                                                (
                                                    [tagName] => field
                                                    [children] => Array
                                                        (
                                                            [0] => meteorological
                                                        )

                                                )

                                            [2] => Array
                                                (
                                                    [tagName] => category
                                                    [children] => Array
                                                        (
                                                            [0] => forecast
                                                        )

                                                )

                                            [3] => Array
                                                (
                                                    [tagName] => creation-date
                                                    [attributes] => Array
                                                        (
                                                            [refresh-frequency] => PT1H
                                                        )

                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-02T06:51:17Z
                                                        )

                                                )

                                        )

                                )

                            [1] => Array
                                (
                                    [tagName] => source
                                    [children] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [tagName] => more-information
                                                    [children] => Array
                                                        (
                                                            [0] => http://www.nws.noaa.gov/forecasts/xml/
                                                        )

                                                )

                                            [1] => Array
                                                (
                                                    [tagName] => production-center
                                                    [children] => Array
                                                        (
                                                            [0] => Meteorological Development Laboratory
                                                            [1] => Array
                                                                (
                                                                    [tagName] => sub-center
                                                                    [children] => Array
                                                                        (
                                                                            [0] => Product Generation Branch
                                                                        )

                                                                )

                                                        )

                                                )

                                            [2] => Array
                                                (
                                                    [tagName] => disclaimer
                                                    [children] => Array
                                                        (
                                                            [0] => http://www.nws.noaa.gov/disclaimer.html
                                                        )

                                                )

                                            [3] => Array
                                                (
                                                    [tagName] => credit
                                                    [children] => Array
                                                        (
                                                            [0] => http://www.weather.gov/
                                                        )

                                                )

                                            [4] => Array
                                                (
                                                    [tagName] => credit-logo
                                                    [children] => Array
                                                        (
                                                            [0] => http://www.weather.gov/images/xml_logo.gif
                                                        )

                                                )

                                            [5] => Array
                                                (
                                                    [tagName] => feedback
                                                    [children] => Array
                                                        (
                                                            [0] => http://www.weather.gov/feedback.php
                                                        )

                                                )

                                        )

                                )

                        )

                )

            [1] => Array
                (
                    [tagName] => data
                    [children] => Array
                        (
                            [0] => Array
                                (
                                    [tagName] => location
                                    [children] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [tagName] => location-key
                                                    [children] => Array
                                                        (
                                                            [0] => point1
                                                        )

                                                )

                                            [1] => Array
                                                (
                                                    [tagName] => point
                                                    [attributes] => Array
                                                        (
                                                            [latitude] => 40.00
                                                            [longitude] => -120.00
                                                        )

                                                )

                                        )

                                )

                            [1] => Array
                                (
                                    [tagName] => moreWeatherInformation
                                    [attributes] => Array
                                        (
                                            [applicable-location] => point1
                                        )

                                    [children] => Array
                                        (
                                            [0] => http://forecast.weather.gov/MapClick.php?textField1=40.00&textField2=-120.00
                                        )

                                )

                            [2] => Array
                                (
                                    [tagName] => time-layout
                                    [attributes] => Array
                                        (
                                            [time-coordinate] => local
                                            [summarization] => none
                                        )

                                    [children] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [tagName] => layout-key
                                                    [children] => Array
                                                        (
                                                            [0] => k-p24h-n4-1
                                                        )

                                                )

                                            [1] => Array
                                                (
                                                    [tagName] => start-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-02T08:00:00-07:00
                                                        )

                                                )

                                            [2] => Array
                                                (
                                                    [tagName] => end-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-02T20:00:00-07:00
                                                        )

                                                )

                                            [3] => Array
                                                (
                                                    [tagName] => start-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-03T07:00:00-08:00
                                                        )

                                                )

                                            [4] => Array
                                                (
                                                    [tagName] => end-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-03T19:00:00-08:00
                                                        )

                                                )

                                            [5] => Array
                                                (
                                                    [tagName] => start-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-04T07:00:00-08:00
                                                        )

                                                )

                                            [6] => Array
                                                (
                                                    [tagName] => end-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-04T19:00:00-08:00
                                                        )

                                                )

                                            [7] => Array
                                                (
                                                    [tagName] => start-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-05T07:00:00-08:00
                                                        )

                                                )

                                            [8] => Array
                                                (
                                                    [tagName] => end-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-05T19:00:00-08:00
                                                        )

                                                )

                                        )

                                )

                            [3] => Array
                                (
                                    [tagName] => time-layout
                                    [attributes] => Array
                                        (
                                            [time-coordinate] => local
                                            [summarization] => none
                                        )

                                    [children] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [tagName] => layout-key
                                                    [children] => Array
                                                        (
                                                            [0] => k-p24h-n5-2
                                                        )

                                                )

                                            [1] => Array
                                                (
                                                    [tagName] => start-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-01T20:00:00-07:00
                                                        )

                                                )

                                            [2] => Array
                                                (
                                                    [tagName] => end-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-02T09:00:00-07:00
                                                        )

                                                )

                                            [3] => Array
                                                (
                                                    [tagName] => start-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-02T19:00:00-07:00
                                                        )

                                                )

                                            ...

                                            [10] => Array
                                                (
                                                    [tagName] => end-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-06T08:00:00-08:00
                                                        )

                                                )

                                        )

                                )

                            [4] => Array
                                (
                                    [tagName] => time-layout
                                    [attributes] => Array
                                        (
                                            [time-coordinate] => local
                                            [summarization] => none
                                        )

                                    [children] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [tagName] => layout-key
                                                    [children] => Array
                                                        (
                                                            [0] => k-p12h-n9-3
                                                        )

                                                )

                                            [1] => Array
                                                (
                                                    [tagName] => start-valid-time
                                                    [children] => Array
                                                        (
                                                            [0] => 2013-11-01T17:00:00-07:00
                                                        )

                                                )
                                    ... 
```

# c - C的隐藏特征

> ID：132241
> 
> 赞同：141
> 
> 时间：2008-09-25T09:02:06.717
> 
> 标签：c, hidden-features

我知道所有 C 编译器实现背后都有一个标准，所以不应该有隐藏的特性。尽管如此，我确信所有 C 开发人员都有他们一直使用的隐藏/秘密技巧。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2008-09-25T14:08:29.740

GCC 编译器的更多技巧，但您可以向编译器提供分支指示提示（在 Linux 内核中很常见）

```
#define likely(x)       __builtin_expect((x),1)
#define unlikely(x)     __builtin_expect((x),0) 
```

见： http: [//kerneltrap.org/node/4705](http://kerneltrap.org/node/4705)

我喜欢的是它还为某些功能增加了一些表现力。

```
void foo(int arg)
{
     if (unlikely(arg == 0)) {
           do_this();
           return;
     }
     do_that();
     ...
} 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2008-09-25T14:31:30.573

```
int8_t
int16_t
int32_t
uint8_t
uint16_t
uint32_t 
```

这些是标准中的一个可选项目，但它必须是一个隐藏的特性，因为人们在不断地重新定义它们。我工作过的一个代码库（现在仍然这样做）有多个重新定义，所有这些都具有不同的标识符。大多数时候它与预处理器宏有关：

```
#define INT16 short
#define INT32  long 
```

等等。它让我想把我的头发拉出来。 ***只需使用该死的标准整数类型定义！***

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2008-09-25T14:37:22.057

逗号运算符没有被广泛使用。它当然可以被滥用，但它也可能非常有用。这种用法是最常见的：

```
for (int i=0; i<10; i++, doSomethingElse())
{
  /* whatever */
} 
```

但是您可以在任何地方使用此运算符。观察：

```
int j = (printf("Assigning variable j\n"), getValueFromSomewhere()); 
```

每个语句都会被计算，但表达式的值将是最后一个被计算的语句的值。

* * *

## 回答 #4

> 赞同：63
> 
> 时间：2008-10-01T00:34:59.980

**将结构初始化为零**

```
struct mystruct a = {0}; 
```

这将使所有结构元素归零。

* * *

## 回答 #5

> 赞同：62
> 
> 时间：2008-09-25T10:29:18.160

函数指针。您可以使用函数指针表来实现，例如，快速间接线程代码解释器 (FORTH) 或字节码分派器，或模拟类似 OO 的虚拟方法。

然后是标准库中隐藏的宝石，例如 qsort()、bsearch()、strpbrk()、strcspn() [后两者对于实现 strtok() 替换很有用]。

C 的一个错误特征是有符号算术溢出是未定义的行为（UB）。因此，每当您看到诸如 x+y 之类的表达式都是有符号整数时，它可能会溢出并导致 UB。

* * *

## 回答 #6

> 赞同：52
> 
> 时间：2008-09-25T11:21:37.427

多字符常量：

```
int x = 'ABCD'; 
```

这设置`x`为`0x41424344`（或`0x44434241`，取决于架构）。

**编辑：**这种技术是不可移植的，特别是如果你序列化 int。但是，创建自记录枚举可能非常有用。例如

```
enum state {
    stopped = 'STOP',
    running = 'RUN!',
    waiting = 'WAIT',
}; 
```

如果您正在查看原始内存转储并且需要确定枚举的值而无需查找它，这会使它变得更加简单。

* * *

## 回答 #7

> 赞同：44
> 
> 时间：2008-09-25T10:44:09.560

我从未使用过[位域](http://en.wikipedia.org/wiki/Bit_field)，但它们对于超低级的东西听起来很酷。

```
struct cat {
    unsigned int legs:3;  // 3 bits for legs (0-4 fit in 3 bits)
    unsigned int lives:4; // 4 bits for lives (0-9 fit in 4 bits)
    // ...
};

cat make_cat()
{
    cat kitty;
    kitty.legs = 4;
    kitty.lives = 9;
    return kitty;
} 
```

这意味着`sizeof(cat)`可以小到`sizeof(char)`。

* * *

合并了[Aaron](https://stackoverflow.com/users/14153/aaron)和[leppie](https://stackoverflow.com/users/15541/leppie)的评论，谢谢大家。

* * *

## 回答 #8

> 赞同：37
> 
> 时间：2008-09-25T09:12:30.093

[像Duff's Device](http://en.wikipedia.org/wiki/Duffs_device)这样的交错结构：

```
strncpy(to, from, count)
char *to, *from;
int count;
{
    int n = (count + 7) / 8;
    switch (count % 8) {
    case 0: do { *to = *from++;
    case 7:      *to = *from++;
    case 6:      *to = *from++;
    case 5:      *to = *from++;
    case 4:      *to = *from++;
    case 3:      *to = *from++;
    case 2:      *to = *from++;
    case 1:      *to = *from++;
               } while (--n > 0);
    }
} 
```

* * *

## 回答 #9

> 赞同：37
> 
> 时间：2008-09-25T09:20:57.747

C 有一个标准，但并非所有 C 编译器都完全兼容（我还没有看到任何完全兼容的 C99 编译器！）。

也就是说，我更喜欢的技巧是那些不明显且可跨平台移植的技巧，因为它们依赖于 C 语义。它们通常是关于宏或位算术的。

例如：在不使用临时变量的情况下交换两个无符号整数：

```
...
a ^= b ; b ^= a; a ^=b;
... 
```

或“扩展 C”来表示有限状态机，例如：

```
FSM {
  STATE(x) {
    ...
    NEXTSTATE(y);
  }

  STATE(y) {
    ...
    if (x == 0) 
      NEXTSTATE(y);
    else 
      NEXTSTATE(x);
  }
} 
```

这可以通过以下宏来实现：

```
#define FSM
#define STATE(x)      s_##x :
#define NEXTSTATE(x)  goto s_##x 
```

不过，总的来说，我不喜欢那些聪明但使代码阅读起来不必要地复杂的技巧（如交换示例），我喜欢那些使代码更清晰并直接传达意图的技巧（如 FSM 示例） .

* * *

## 回答 #10

> 赞同：33
> 
> 时间：2008-09-25T14:15:22.843

我非常喜欢在 C99 中添加的指定初始化程序（并且在 gcc 中支持了很长时间）：

```
#define FOO 16
#define BAR 3

myStructType_t myStuff[] = {
    [FOO] = { foo1, foo2, foo3 },
    [BAR] = { bar1, bar2, bar3 },
    ... 
```

数组初始化不再依赖于位置。如果更改 FOO 或 BAR 的值，数组初始化将自动对应于它们的新值。

* * *

## 回答 #11

> 赞同：28
> 
> 时间：2009-06-22T04:01:19.323

C99 有一些很棒的任意顺序结构初始化。

 `````
struct foo{
  int x;
  int y;
  char* name;
};

void main(){
  struct foo f = { .y = 23, .name = "awesome", .x = -38 };
} 
````  `* * *

## 回答 #12

> 赞同：27
> 
> 时间：2008-09-25T10:16:48.597

匿名结构和数组是我最喜欢的。（参见[http://www.run.montefiore.ulg.ac.be/~martin/resources/kung-f00.html](http://www.run.montefiore.ulg.ac.be/~martin/resources/kung-f00.html)）

```
setsockopt(yourSocket, SOL_SOCKET, SO_REUSEADDR, (int[]){1}, sizeof(int)); 
```

或者

```
void myFunction(type* values) {
    while(*values) x=*values++;
}
myFunction((type[]){val1,val2,val3,val4,0}); 
```

它甚至可以用来实例化链表......

* * *

## 回答 #13

> 赞同：24
> 
> 时间：2008-09-25T09:10:07.260

嗯...我认为 C 语言的优点之一是它的可移植性和标准性，所以每当我在当前使用的实现中发现一些“隐藏的技巧”时，我尽量不使用它，因为我尽量保持我的尽可能标准和可移植的 C 代码。

* * *

## 回答 #14

> 赞同：24
> 
> 时间：2008-09-29T00:27:06.007

gcc 有许多我喜欢的 C 语言扩展，可以在[这里](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/index.html#toc_C-Extensions)找到。我最喜欢的一些是[函数属性](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/Function-Attributes.html#Function-Attributes)。一个非常有用的例子是格式属性。如果您定义了一个采用 printf 格式字符串的自定义函数，则可以使用它。如果您启用此函数属性，gcc 将对您的参数进行检查，以确保您的格式字符串和参数匹配，并根据需要生成警告或错误。

```
int my_printf (void *my_object, const char *my_format, ...)
            __attribute__ ((format (printf, 2, 3))); 
```

* * *

## 回答 #15

> 赞同：24
> 
> 时间：2009-06-22T11:10:14.113

当我第一次看到时“震惊”我的（隐藏的）功能是关于 printf 的。此功能允许您使用变量来格式化格式说明符本身。寻找代码，你会看到更好：

```
#include <stdio.h>

int main() {
    int a = 3;
    float b = 6.412355;
    printf("%.*f\n",a,b);
    return 0;
} 
```

* 字符实现了这个效果。

* * *

## 回答 #16

> 赞同：19
> 
> 时间：2008-10-22T15:01:23.133

编译时断言，[这里已经讨论过了](https://stackoverflow.com/questions/174356/ways-to-assert-expressions-at-build-time-in-c)。

```
//--- size of static_assertion array is negative if condition is not met
#define STATIC_ASSERT(condition) \
    typedef struct { \
        char static_assertion[condition ? 1 : -1]; \
    } static_assertion_t

//--- ensure structure fits in 
STATIC_ASSERT(sizeof(mystruct_t) <= 4096); 
```

* * *

## 回答 #17

> 赞同：16
> 
> 时间：2010-05-08T08:22:58.173

**常量字符串连接**

我很惊讶没有在答案中看到它，因为我知道的所有编译器都支持它，但许多程序员似乎忽略了它。有时它真的很方便，不仅在编写宏时。

我在当前代码中的用例：我`#define PATH "/some/path/"`在配置文件中有一个（实际上它是由 makefile 设置的）。现在我想构建完整的路径，包括打开资源的文件名。它只是去：

```
fd = open(PATH "/file", flags); 
```

而不是可怕的，但很常见：

```
char buffer[256];
snprintf(buffer, 256, "%s/file", PATH);
fd = open(buffer, flags); 
```

请注意，常见的可怕解决方案是：

*   三倍长
*   不太容易阅读
*   慢得多
*   将其设置为任意缓冲区大小限制时功能较弱（但您将不得不使用更长的代码来避免这种情况，而没有常量字符串的连接）。
*   使用更多的堆栈空间

* * *

## 回答 #18

> 赞同：15
> 
> 时间：2008-10-17T08:54:17.637

好吧，我从未使用过它，我不确定我是否会向任何人推荐它，但我觉得如果不提及 Simon Tatham 的[协同程序技巧，这个问题将是不完整的。](http://www.chiark.greenend.org.uk/~sgtatham/coroutines.html)

* * *

## 回答 #19

> 赞同：12
> 
> 时间：2008-10-16T09:56:18.260

结构分配很酷。许多人似乎没有意识到结构体也是值，并且可以被赋值，没有必要使用`memcpy()`，当一个简单的赋值就可以了。

例如，考虑一些虚构的 2D 图形库，它可能定义一个类型来表示（整数）屏幕坐标：

```
typedef struct {
   int x;
   int y;
} Point; 
```

现在，你做一些看起来“错误”的事情，比如编写一个函数，创建一个从函数参数初始化的点，然后返回它，如下所示：

```
Point point_new(int x, int y)
{
  Point p;
  p.x = x;
  p.y = y;
  return p;
} 
```

这是安全的，只要（当然）使用结构赋值按值复制返回值：

```
Point origin;
origin = point_new(0, 0); 
```

通过这种方式，您可以编写非常干净且面向对象的代码，所有这些都使用普通的标准 C。

* * *

## 回答 #20

> 赞同：12
> 
> 时间：2009-06-11T11:14:49.373

初始化数组或枚举时，您可以在初始化列表中的最后一项之后放置一个逗号。例如：

```
int x[] = { 1, 2, 3, };

enum foo { bar, baz, boom, }; 
```

这样做是为了如果您自动生成代码，则无需担心消除最后一个逗号。

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2008-09-25T09:30:28.207

奇怪的向量索引：

```
int v[100]; int index = 10; 
/* v[index] it's the same thing as index[v] */ 
```

* * *

## 回答 #22

> 赞同：9
> 
> 时间：2008-09-25T09:26:19.873

C 编译器实现了几个标准之一。但是，拥有标准并不意味着语言的所有方面都已定义。 [例如， Duff 的 device](http://en.wikipedia.org/wiki/Duff's_device)是一个最受欢迎的“隐藏”功能，它已经变得如此流行，以至于现代编译器具有特殊用途的识别代码，以确保优化技术不会破坏这种常用模式的预期效果。

通常，当您在编译器使用的任何 C 标准的锋利边缘上运行时，不鼓励隐藏功能或语言技巧。许多这样的技巧在一个编译器到另一个编译器中都不起作用，并且这些类型的功能通常会从给定制造商的编译器套件的一个版本到另一个版本失败。

破坏 C 代码的各种技巧包括：

1.  依赖于编译器如何在内存中布局结构。
2.  关于整数/浮点数的*字节顺序*的假设。
3.  关于功能 ABI 的假设。
4.  关于堆栈帧增长方向的假设。
5.  关于语句中执行顺序的假设。
6.  关于函数参数中语句执行顺序的假设。
7.  对 short、int、long、float 和 double 类型的位大小或精度的假设。

每当程序员对大多数 C 标准中都指定为“编译器相关”行为的执行模型进行假设时，就会出现其他问题和问题。

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2010-10-31T11:35:20.527

使用 sscanf 时，您可以使用 %n 找出应该继续阅读的位置：

```
sscanf ( string, "%d%n", &number, &length );
string += length; 
```

显然，您不能添加另一个答案，所以我将在此处添加第二个答案，您可以使用“&&”和“||” 作为条件：

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
   1 || puts("Hello\n");
   0 || puts("Hi\n");
   1 && puts("ROFL\n");
   0 && puts("LOL\n");

   exit( 0 );
} 
```

此代码将输出：

```
你好
ROFL
```

* * *

## 回答 #24

> 赞同：8
> 
> 时间：2008-09-25T09:06:39.590

使用 INT(3) 在代码处设置断点是我一直以来的最爱

* * *

## 回答 #25

> 赞同：8
> 
> 时间：2008-09-26T20:18:15.857

我最喜欢的 C 的“隐藏”特性是在 printf 中使用 %n 来写回堆栈。通常 printf 根据格式字符串从堆栈中弹出参数值，但 %n 可以将它们写回。

[在此处](http://doc.bughunter.net/format-string/exploit-fs.html)查看第 3.4.2 节。会导致很多讨厌的漏洞。

* * *

## 回答 #26

> 赞同：8
> 
> 时间：2009-06-11T22:19:12.537

Gcc (c) 有一些您可以启用的有趣功能，例如嵌套函数声明，以及 ?: 运算符的 a?:b 形式，如果 a 不为假，则返回 a。

* * *

## 回答 #27

> 赞同：8
> 
> 时间：2009-11-11T13:42:11.187

使用枚举进行编译时假设检查：愚蠢的示例，但对于具有编译时可配置常量的库非常有用。

```
#define D 1
#define DD 2

enum CompileTimeCheck
{
    MAKE_SURE_DD_IS_TWICE_D = 1/(2*(D) == (DD)),
    MAKE_SURE_DD_IS_POW2    = 1/((((DD) - 1) & (DD)) == 0)
}; 
```

* * *

## 回答 #28

> 赞同：8
> 
> 时间：2010-11-26T16:06:32.350

我最近发现了 0 个位域。

```
struct {
  int    a:3;
  int    b:2;
  int     :0;
  int    c:4;
  int    d:3;
}; 
```

这将给出一个布局

```
000aaabb 0ccccddd 
```

而不是没有 :0;

```
0000aaab bccccddd 
```

0 宽度字段表示应在下一个原子实体 ( `char`)上设置以下位域

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2008-10-22T18:00:24.647

C99 风格的变量参数宏，又名

```
#define ERR(name, fmt, ...)   fprintf(stderr, "ERROR " #name ": " fmt "\n", \
                                  __VAR_ARGS__) 
```

这将像

```
ERR(errCantOpen, "File %s cannot be opened", filename); 
```

这里我还使用了 stringize 运算符和字符串常量连接，其他我非常喜欢的功能。

* * *

## 回答 #30

> 赞同：6
> 
> 时间：2008-09-25T14:23:20.423

可变大小的自动变量在某些情况下也很有用。这些是在 nC99 中添加的，并且在 gcc 中支持了很长时间。

```
void foo(uint32_t extraPadding) {
    uint8_t commBuffer[sizeof(myProtocol_t) + extraPadding]; 
```

您最终会在堆栈上获得一个缓冲区，为固定大小的协议标头和可变大小的数据留出空间。您可以使用 alloca() 获得相同的效果，但这种语法更紧凑。

在调用此例程之前，您必须确保 extraPadding 是一个合理的值，否则您最终会破坏堆栈。在调用 malloc 或任何其他内存分配技术之前，您必须彻底检查参数，所以这并不罕见。

* * *

## 回答 #31

> 赞同：5
> 
> 时间：2008-09-26T06:56:18.197

我喜欢你可以制作的可变大小的结构：

```
typedef struct {
    unsigned int size;
    char buffer[1];
} tSizedBuffer;

tSizedBuffer *buff = (tSizedBuffer*)(malloc(sizeof(tSizedBuffer) + 99));

// can now refer to buff->buffer[0..99]. 
```

也是现在在 ANSI C 中的 offsetof 宏，但我第一次看到它时却是一个魔法。它基本上使用地址运算符 (&) 将空指针重铸为结构变量。

* * *

## 回答 #32

> 赞同：5
> 
> 时间：2010-05-05T13:39:51.353

GCC 中的 Lambda（例如匿名函数）：

```
#define lambda(return_type, function_body) \
    ({ return_type fn function_body fn }) 
```

这可以用作：

```
lambda (int, (int x, int y) { return x > y; })(1, 2) 
```

扩展为：

```
({ int fn (int x, int y) { return x > y } fn; })(1, 2) 
```

* * *

## 回答 #33

> 赞同：5
> 
> 时间：2010-05-26T15:38:24.310

我喜欢`__LINE__`和`__FILE__`。见这里： http: [//gcc.gnu.org/onlinedocs/cpp/Standard-Predefined-Macros.html](http://gcc.gnu.org/onlinedocs/cpp/Standard-Predefined-Macros.html)

* * *

## 回答 #34

> 赞同：4
> 
> 时间：2009-06-22T14:44:48.157

要清除输入缓冲区，您不能使用`fflush(stdin)`. 正确的方法如下：`scanf("%*[^\n]%*c")` 这将丢弃输入缓冲区中的所有内容。

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2008-09-25T09:14:22.443

早期版本的 gcc 会在源代码中遇到“#pragma”时尝试运行游戏。另请参见[此处](http://everything2.com/e2node/%2523pragma)。

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2008-09-25T11:57:47.747

我曾经在一段代码中看到过这个，然后问它做了什么：

```
 hexDigit = "0123456789abcdef"[someNybble]; 
```

另一个最喜欢的是：

```
 unsigned char bar[100];
unsigned char *foo = bar;
unsigned char blah = 42[foo]; 
```

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2008-09-25T19:10:38.033

使用不寻常的类型转换进行类型转换。虽然没有隐藏功能，但它非常棘手。

例子：

如果你想知道编译器如何存储浮点数，试试这个：

```
uint32_t Int;
float flt = 10.5; // say

Int = *(uint32_t *)&flt;

printf ("Float 10.5 is stored internally as %8X\n", Int); 
```

或者

```
float flt = 10.5; // say

printf ("Float 10.5 is stored internally as %8X\n", *(uint32_t *)&flt); 
```

注意类型转换的巧妙使用。将变量的地址（此处为 &flt）转换为所需的类型（此处为 (uint32_t * )）并提取其内容（应用 '*'）。

这也适用于表达的另一面：

```
*(float *)&Int = flt; 
```

这也可以使用联合来完成：

```
typedef union
{
  uint32_t Int;
  float    flt;

} FloatInt_type; 
```

* * *

## 回答 #38

> 赞同：3
> 
> 时间：2009-10-28T10:28:57.673

我是在 15 年以上的 C 编程之后才发现的：

```
struct SomeStruct
{
   unsigned a : 5;
   unsigned b : 1;
   unsigned c : 7;
}; 
```

位域！冒号后面的数字是成员需要的位数，成员被打包成指定的类型，所以如果 unsigned 是 16 位，上面的内容如下所示：

```
xxxc cccc ccba aaaa 
```

斯基兹

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2008-09-25T12:49:09.260

不是真正的隐藏功能，但在我看来，它就像巫毒教一样，我第一次看到这样的东西：

```
 void callback(const char *msg, void *data)
{
    // do something with msg, e.g.
    printf("%s\n", msg);

    return;
    data = NULL;
} 
```

这种构造的原因是，如果你用 -Wextra 编译它并且没有“data = NULL;”-line，gcc 将发出关于未使用参数的警告。但是对于这条无用的行，您不会收到警告。

编辑：我知道还有其他（更好的）方法可以防止这些警告。只是觉得很奇怪，我第一次看到这个。

* * *

## 回答 #40

> 赞同：2
> 
> 时间：2010-03-24T10:48:34.317

intptr_t 用于声明指针类型的变量。C99 特定并在 stdint.h 中声明

* * *

## 回答 #41

> 赞同：2
> 
> 时间：2011-01-07T04:38:18.783

[Steve Webb](https://stackoverflow.com/questions/132241/hidden-features-of-c/2914468#2914468)指出了`__LINE__`and`__FILE__`宏。它让我想起了在我之前的工作中，我是如何破解他们的内存日志记录的。

我正在使用没有端口可将日志信息从设备传递到用于调试的 PC 的设备。可以使用断点停止并使用调试器了解程序的状态，但没有关于系统跟踪的信息。

由于对调试日志的所有调用实际上都是一个全局宏，因此我们将该宏更改为将文件名和行号转储到全局数组中。该数组包含一系列文件名和行号，显示调用了哪些调试调用，给出了执行跟踪的一个公平概念（虽然不是实际的日志消息）。可以通过调试器暂停执行，将这些字节转储到本地文件中，然后使用脚本将此信息映射到代码库。这之所以成为可能，是因为我们有严格的编码准则，所以我们可以在一个文件中对日志机制进行更改。

* * *

## 回答 #42

> 赞同：2
> 
> 时间：2012-01-15T04:15:30.273

在将变量与文字进行比较时，最好将文字放在运算符的**左侧**，`==`以确保当您错误地使用赋值运算符时编译器会出错。

```
if (0 == count) {
    ...
} 
```

乍一看可能看起来很奇怪，但它可以避免一些头痛（比如如果你碰巧输入`if (count = 0)`错误）。

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2008-09-29T00:39:33.277

## 注册变量

我曾经用**`register`**关键字声明一些变量来帮助加快速度。这将提示 C 编译器使用 CPU 寄存器作为本地存储。这很可能不再需要，因为现代 C 编译器会自动执行此操作。

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2009-01-13T11:26:43.273

**摘录**：

> 在此页面中，您将找到一系列有趣的 C 编程问题/谜题，列出的这些程序是我从朋友那里收到的电子邮件转发，一些我在一些书籍中读到的，一些来自互联网，还有一些来自我的 C 编码经验。

[http://www.gowrikumar.com/c/index.html](http://www.gowrikumar.com/c/index.html)

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2009-06-21T23:29:01.030

假设您有一个具有相同类型成员的结构：

```
struct Point {
    float x;
    float y;
    float z;
}; 
```

您可以将其实例转换为浮点指针并使用数组索引：

```
Point a;
int sum = 0, i = 0;
for( ; i < 3; i++)
    sum += ((float*)a)[i]; 
```

非常基本，但在编写简洁的代码时很有用。

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2009-06-22T06:24:02.270

这是 gcc 中的三个不错的：

```
__FILE__ 
__FUNCTION__
__LINE__ 
```

* * *

## 回答 #47

> 赞同：1
> 
> 时间：2011-01-07T04:19:06.637

函数指针的大小不是标准的。至少在 K&R 书中没有。即使它谈论其他类型指针的大小，但（我认为）`sizeof`函数指针是未定义的行为。

也是`sizeof`编译时运算符，我看到很多人在在线论坛上询问`sizeof`是函数还是运算符。

我看到的一个错误如下（一个简化的例子）：

```
int j;
int i;
j = sizeof(i++) 
```

不会像在编译时评估的`i`那样执行增量。`sizeof`程序员打算在一个语句中破解这两种操作，增量`i`和计算。`sizeof`

C 中的运算符优先级控制关联顺序而不是评估顺序。例如，如果您有三个函数`f`, `g`，`h`每个函数都返回一个`int`，它们的表达式如下：

```
f() + g() * h() 
```

C 标准没有给出关于这些函数的评估顺序的规则。的结果`g`和`h`将在添加 的结果之前相乘`f`。如果函数共享状态并且计算取决于这些函数的评估顺序，这可能会导致错误。这可能会导致可移植性问题。

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2009-06-22T05:02:00.537

可变大小的结构，在其他地方的常见解析器库中可见。

```
结构体
{
  诠释一个;
  诠释 b;
  字符 b[1]; // 使用 [0] 不再正确
             // 必须在结尾
};

字符 *str = "abcdef";
int len = strlen(str);
结构 foo *bar = malloc(sizeof(foo) + len);

strcpy(bar.b, str); // 试着阻止我！

```

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2009-06-22T06:28:39.797

像这样包装 malloc 和 realloc：

```
#ifdef _DEBUG
#define mmalloc(bytes)                  malloc(bytes);printf("malloc: %d\t<%s@%d>\n", bytes, __FILE__, __LINE__);
#define mrealloc(pointer, bytes)        realloc(pointer, bytes);printf("realloc: %d\t<%s@%d>\n", bytes, __FILE__, __LINE__);
#else //_DEBUG
#define mmalloc(bytes)                  malloc(bytes)
#define mrealloc(pointer, bytes)        realloc(pointer, bytes) 
```

事实上，这是我的全部武器（BailIfNot 适用于 OO c）：

```
#ifdef _DEBUG
#define mmalloc(bytes)                  malloc(bytes);printf("malloc: %d\t<%s@%d>\n", bytes, __FILE__, __LINE__);
#define mrealloc(pointer, bytes)        realloc(pointer, bytes);printf("realloc: %d\t<%s@%d>\n", bytes, __FILE__, __LINE__);
#define BAILIFNOT(Node, Check)  if(Node->type != Check) return 0;
#define NULLCHECK(var)          if(var == NULL) setError(__FILE__, __LINE__, "Null exception", " var ", FATAL);
#define ASSERT(n)               if( ! ( n ) ) { printf("<ASSERT FAILURE@%s:%d>", __FILE__, __LINE__); fflush(0); __asm("int $0x3"); }
#define TRACE(n)                printf("trace: %s <%s@%d>\n", n, __FILE__, __LINE__);fflush(0);
#else //_DEBUG
#define mmalloc(bytes)                  malloc(bytes)
#define mrealloc(pointer, bytes)        realloc(pointer, bytes)
#define BAILIFNOT(Node, Check)  {}
#define NULLCHECK(var)          {}
#define ASSERT(n)               {}
#define TRACE(n)                {}
#endif //_DEBUG 
```

这是一些示例输出：

```
malloc: 12      <hash.c@298>
trace: nodeCreate <hash.c@302>
malloc: 5       <hash.c@308>
malloc: 16      <hash.c@316>
malloc: 256     <hash.c@320>
trace: dataLoadHead <hash.c@441>
malloc: 270     <hash.c@463>
malloc: 262144  <hash.c@467>
trace: dataLoadRecursive <hash.c@404> 
```

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2009-06-22T06:28:55.147

我刚读了这篇[文章](http://beerpla.net/2009/06/21/hidden-features-of-perl-php-javascript-c-c-c-java-ruby-python-and-others-collection-of-incredibly-useful-lists/)。它有一些 C 和其他几种语言的“隐藏特性”。

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2009-06-22T06:38:22.383

面向对象的 C 宏：您需要一个构造函数 (init)、一个析构函数 (dispose)、一个相等 (equal)、一个复制器 (copy)，以及一些用于实例化的原型 (prototype)。

使用声明，您需要声明一个常量原型以进行复制和派生。然后你可以做`C_OO_NEW`。如果需要，我可以发布更多示例。LibPurple 是一个带有回调系统的大型面向对象的 C 代码库（如果你想看到一个正在使用的）

```
#define C_copy(to, from) to->copy(to, from)

#define true 1
#define false 0
#define C_OO_PROTOTYPE(type)\
void type##_init (struct type##_struct *my);\
void type##_dispose (struct type##_struct *my);\
char type##_equal (struct type##_struct *my, struct type##_struct *yours); \
struct type##_struct * type##_copy (struct type##_struct *my, struct type##_struct *from); \
const type type##__prototype = {type##_init, type##_dispose, type##_equal, type##_copy

#define C_OO_OVERHEAD(type)\
        void (*init) (struct type##_struct *my);\
        void (*dispose) (struct type##_struct *my);\
        char (*equal) (struct type##_struct *my, struct type##_struct *yours); \
        struct type##_struct *(*copy) (struct type##_struct *my, struct type##_struct *from); 

#define C_OO_IN(ret, type, function, ...)       ret (* function ) (struct type##_struct *my, __VA_ARGS__);
#define C_OO_OUT(ret, type, function, ...)      ret type##_##function (struct type##_struct *my, __VA_ARGS__);

#define C_OO_PNEW(type, instance)\
        instance = ( type *) malloc(sizeof( type ));\
        memcpy(instance, & type##__prototype, sizeof( type ));

#define C_OO_NEW(type, instance)\
        type instance;\
        memcpy(&instance, & type ## __prototype, sizeof(type));

#define C_OO_DELETE(instance)\
        instance->dispose(instance);\
        free(instance);

#define C_OO_INIT(type)         void type##_init (struct type##_struct *my){return;}
#define C_OO_DISPOSE(type)      void type##_dispose (struct type##_struct *my){return;}
#define C_OO_EQUAL(type)        char type##_equal (struct type##_struct *my, struct type##_struct *yours){return 0;}
#define C_OO_COPY(type)         struct type##_struct * type##_copy (struct type##_struct *my, struct type##_struct *from){return 0;} 
```

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2009-06-22T07:49:12.833

我喜欢 typeof() 运算符。它像 sizeof() 一样工作，因为它是在编译时解析的。它不返回字节数，而是返回类型。当您需要将变量声明为与其他变量相同的类型时，这很有用，无论它可能是什么类型。

```
typeof(foo) copy_of_foo; //declare bar to be a variable of the same type as foo
copy_of_foo = foo; //now copy_of_foo has a backup of foo, for any type 
```

这可能只是一个 gcc 扩展，我不确定。

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2009-06-22T16:29:08.947

使用 NaN 进行链式计算/错误返回：

//#include <stdint.h>
static uint64_t iNaN = 0xFFF8000000000000;
const double NaN = *(double *)&iNaN; // 安静的 NaN

内部函数可以将 NaN 作为错误标志返回：它可以安全地用于任何计算，并且结果将始终为 NaN。

注意：测试 NaN 很棘手，因为 NaN != NaN... 使用 isnan(x)，或者自己滚动。
如果 x 为 NaN，则 x!=x 在数学上是正确的，但往往会被某些编译器优化

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2012-01-19T17:18:53.260

格式字符串中经常被遗忘的`%n`说明`printf`符有时非常实用。%n 返回 printf 格式化其输出时使用的假想光标的当前位置。

```
int pos1, pos2;
 char *string_of_unknown_length = "we don't care about the length of this";

  printf("Write text of unknown %n(%s)%n text\n", &pos1, string_of_unknown_length, &pos2);
  printf("%*s\\%*s/\n", pos1, " ", pos2-pos1-2, " ");
  printf("%*s", pos1+1, " ");
  for(int i=pos1+1; i<pos2-1; i++)
    putc('-', stdout);
  putc('\n', stdout); 
```

将有以下输出

```
Write text of unknown (we don't care about the length of this) text
                      \                                      /
                       -------------------------------------- 
```

当然有点做作，但在制作漂亮的报告时可以有一些用途。

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2012-02-09T23:29:45.937

在 switch 中使用 while(0) 怎么样，这样你就可以使用像 break 这样的 continue 语句 :-)

```
void sw(int s)
{
    switch (s) while (0) {
    case 0:
        printf("zero\n");
        continue;
    case 1:
        printf("one\n");
        continue;
    default:
        printf("something else\n");
        continue;
    }
} 
```

* * *

## 回答 #56

> 赞同：-1
> 
> 时间：2012-01-18T01:30:03.200

在 Visual Studio 中，您可以突出显示自己定义的类型。

为此，在文件夹“Commom7/IDE”中创建一个名为“usertype.dat”的文件。该文件的内容应该是您要突出显示的类型。例如：

//usertype.dat 的内容

```
int8_t
int16_t
int32_t
int64_t
uint8_t
uint16_t
uint32_t
uint64_t
float32_t
float64_t
char_t 
```

# c++ - 卸载 DLL 时的内存泄漏是否会导致主机进程泄漏？

> ID：132242
> 
> 赞同：10
> 
> 时间：2008-09-25T09:02:30.240
> 
> 标签：c++, winapi, dll, memory-management, crt

考虑这种情况：

```
dll = LoadDLL()
dll->do()

...
void do() {
    char *a = malloc(1024);
}
...

UnloadDLL(dll); 
```

此时，调用 malloc() 时分配的 1k 是否会再次可供宿主进程使用？DLL 静态链接到 CRT。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T10:12:57.153

1.  操作系统跟踪的进程使用的内存适用于整个进程，而不是特定于 DLL。

2.  内存由操作系统以块的形式提供给程序，称为堆

3.  堆管理器（malloc / new 等）进一步划分块并将其分发给请求代码。

4.  只有在分配新堆时，操作系统才会检测到内存增加。

5.  当 DLL 静态链接到 C 运行时库 (CRT) 时，将编译具有 DLL 代码调用的 CRT 函数的 CRT 的私有副本并将其放入 DLL 的二进制文件中。Malloc也包含在其中。

6.  每当静态链接 DLL 中的代码尝试分配内存时，就会调用 malloc 的这个私有副本。

7.  因此，只有这个 malloc 副本可见的私有堆是由这个 malloc 从操作系统获取的，它分配这个私有堆中的代码请求的内存。

8.  **当 DLL 卸载时，它会卸载其私有堆，并且当整个堆返回给操作系统时，这种泄漏不会被注意到**。

9.  但是，如果 DLL 是动态链接的，则内存由 malloc 的单个共享版本分配，对以共享模式链接的所有代码都是全局的。

10.  由这个全局 malloc 分配的内存来自一个堆，该堆也是用于在动态 aka 共享模式中链接的所有其他代码的堆，因此很常见。因此，来自该堆的任何泄漏都会成为影响整个过程的泄漏。

编辑 - 添加了链接场景的描述。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T10:00:02.397

你说不出来。这取决于您的静态和动态 CRT 的实现。它甚至可能取决于分配的*大小*，因为有 CRT 将大分配转发给操作系统，但为小分配实现自己的堆。

泄漏的 CRT 的问题当然是泄漏。不泄漏的 CRT 的问题是可执行文件可能合理地期望使用内存，因为 malloc 的内存应该在调用 free 之前保持可用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T09:38:56.957

来自 MSDN[跨 DLL 边界传递 CRT 对象的潜在错误](http://msdn.microsoft.com/en-us/library/ms235460(VS.80).aspx)

> CRT 库的每个副本都有一个单独且不同的状态。因此，文件句柄、环境变量和语言环境等 CRT 对象仅对分配或设置这些对象的 CRT 副本有效。当 DLL 及其用户使用 CRT 库的不同副本时，您不能将这些 CRT 对象传递到 DLL 边界并期望它们在另一端被正确拾取。
> 
> 此外，由于 CRT 库的每个副本都有自己的堆管理器，因此在一个 CRT 库中分配内存并将指针跨过 DLL 边界传递以由 CRT 库的不同副本释放是堆损坏的潜在原因。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-04-12T18:29:54.423

实际上，标记的答案是不正确的。那就是有泄漏。虽然每个 dll 实现自己的堆并在关机时释放它在技术上是可行的，但大多数“运行时”堆（静态或动态）都是 Win32 进程堆 API 的包装器。

除非特别注意保证不是这种情况，否则 dll 将在每个加载、执行、卸载周期泄漏分配。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T09:26:59.370

可以做一个测试，看看是否有内存泄漏。您运行一个简单的测试 30 次，每次分配 1 MB。你应该很快弄清楚。

有一件事是肯定的。如果您在 DLL 中分配了内存，您还应该在那里（在 DLL 中）释放该内存。

例如你应该有这样的东西（简单但直观的伪代码）：

```
dll = DllLoad();

ptr = dll->alloc();

dll->free(ptr);

DllUnload(dll); 
```

必须这样做，因为 DLL 的堆与原始进程（加载 dll）不同。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-25T09:26:54.160

不，你不会泄漏。

如果您混合 dll 模型（静态、动态），那么如果您在 dll 中分配内存，您最终可能会出现内存错误，您可以在不同的模型中释放（或在 exe 中释放）

这意味着静态链接的 CRT 创建的堆与不同 dll 的 CRT 不同。

如果您与 CRT 的动态版本链接，那么您将有泄漏，因为堆在所有动态链接的 CRT 之间共享。这意味着您应该始终将您的应用程序设计为使用动态 CRT，或者确保您永远不会跨 dll 边界管理内存（即，如果您在 dll 中分配内存，请始终提供一个例程以在同一个 dll 中释放它）

# c# - 有没有办法在 C# 的对象初始化程序块中使用扩展方法

> ID：132245
> 
> 赞同：7
> 
> 时间：2008-09-25T09:02:51.677
> 
> 标签：c#, linq, extension-methods, initializer

下面的简单演示捕获了我正在尝试做的事情。在实际程序中，我必须使用对象初始化程序块，因为它正在读取 LINQ to SQL 选择表达式中的列表，并且有一个值我想从数据库中读取并存储在对象上，但是对象没有我可以为该值设置的简单属性。相反，它有一个 XML 数据存储。

看起来我无法在对象初始化程序块中调用扩展方法，也无法使用扩展方法附加属性。

那么我对这种方法不走运吗？唯一的选择似乎是说服基类的所有者针对这种情况对其进行修改。

我有一个现有的解决方案，其中我将 BaseDataObject 子类化，但这也存在在这个简单示例中没有出现的问题。对象作为 BaseDataObject 持久化和恢复 - 强制转换和测试会变得复杂。

```
public class BaseDataObject
{

    // internal data store
    private Dictionary<string, object> attachedData = new Dictionary<string, object>();

    public void SetData(string key, object value)
    {
        attachedData[key] = value;
    }

    public object GetData(string key)
    {
        return attachedData[key];
    }

    public int SomeValue { get; set; }
    public int SomeOtherValue { get; set; }

}

public static class Extensions
{
    public static void SetBarValue(this BaseDataObject dataObject,
                                        int            barValue)
    {
        /// Cannot attach a property to BaseDataObject?
        dataObject.SetData("bar", barValue);
    }
}

public class TestDemo
{

    public void CreateTest()
    {
        // this works
        BaseDataObject test1 = new BaseDataObject 
        { SomeValue = 3, SomeOtherValue = 4 };

        // this does not work - it does not compile
        // cannot use extension method in the initialiser block
        // cannot make an exension property  
        BaseDataObject test2 = new BaseDataObject { SomeValue = 3, SomeOtherValue = 4, SetBarValue(5) };
    }
} 
```

答案之一（来自 mattlant）建议使用流畅的界面样式扩展方法。例如：

```
// fluent interface style
public static BaseDataObject SetBarValueWithReturn(this BaseDataObject dataObject, int barValue)
{
    dataObject.SetData("bar", barValue);
    return dataObject;
}

// this works
BaseDataObject test3 = (new BaseDataObject { SomeValue = 3, SomeOtherValue = 4 }).SetBarValueWithReturn(5); 
```

但这会在 LINQ 查询中工作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T09:13:19.873

对象初始化器只是需要一个聪明的编译器的语法糖，并且在当前的实现中你不能在初始化器中调用方法。

```
var x = new BaseDataObject { SomeValue = 3, SomeOtherValue = 4 }; 
```

会让编译器变成这样：

```
BaseDataObject tempObject = new BaseDataObject();
tempObject.SomeValue = 3;
tempObject.SomeOtherValue = 4;
BaseDataObject x = tempObject; 
```

不同之处在于不能有任何同步问题。变量 x get 立即分配了完全分配的 BaseDataObject，在初始化期间您不能弄乱对象。

您可以在创建对象后调用扩展方法：

```
var x = new BaseDataObject { SomeValue = 3, SomeOtherValue = 4 };
x.SetBarValue() 
```

您可以将 SetBarValue 更改为可以在初始化期间分配的 get/set 属性：

```
public int BarValue
{
    set
    {
        //Value should be ignored
    }
} 
```

或者，您可以子类化/使用外观模式将方法添加到您的对象中：

```
public class DataObjectWithBarValue : BaseDataObject
{
    public void BarValue
    {
        set
        {
            SetData("bar", value);
        }
        get
        {
            (int) GetData("bar");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T09:16:54.077

不，但你可以这样做......：

```
BaseDataObject test2 = (new BaseDataObject { SomeValue = 3, SomeOtherValue = 4}).SetBarValue(5); 
```

并且让您的扩展程序像 Linq 一样返回对象。

编辑：这是一个好主意，直​​到我重新阅读并看到基类是由第三人开发的：也就是你没有代码。这里的其他人已经发布了正确的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T09:33:52.427

更好的是：

```
public static T SetBarValue<T>(this T dataObject, int barValue)
        where T : BaseDataObject 
    {
        dataObject.SetData("bar", barValue);
        return dataObject;
    } 
```

并且您可以对 BaseDataObject 的派生类型使用此扩展方法来链接方法而无需强制转换，并在推断为 var 字段或匿名类型时保留真实类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T09:41:38.617

```
 static T WithBarValue<T>(this T dataObject, int barValue)
        where T : BaseDataObject 
 {  dataObject.SetData("bar", barValue);    
    return dataObject;
 }

var x = new BaseDataObject{SomeValue=3, OtherValue=4}.WithBarValue(5); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T09:34:43.410

是否有可能扩展课程？然后，您可以轻松添加所需的属性。

如果做不到这一点，您可以创建一个具有类似属性的新类，这些属性只需回调您感兴趣的类的私有实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T21:01:02.183

对，从回答者那里学到了“有没有办法在 C# 的对象初始化程序块中使用扩展方法？”的简短回答。是“**不**” 。

我最终解决我面临的问题的方式（与我在这里提出的玩具问题类似，但更复杂）是一种混合方法，如下所示：

我创建了一个子类，例如

```
public class SubClassedDataObject : BaseDataObject
{
    public int Bar
    {
        get { return (int)GetData("bar"); }
        set { SetData("bar", value); }
    }
} 
```

在 LINQ 中运行良好，初始化块看起来像

```
 SubClassedDataObject testSub = new SubClassedDataObject
    { SomeValue = 3, SomeOtherValue = 4, Bar = 5 }; 
```

但我一开始不喜欢这种方法的原因是这些对象被放入 XML 并以 BaseDataObject 的形式返回，而回滚将是一件烦人的事情，不必要的数据副本，并且会放置两个副本游戏中的同一个物体。

在其余代码中，我忽略了子类并使用了扩展方法：

```
 public static void SetBar(this BaseDataObject dataObject, int barValue)
    {
        dataObject.SetData("bar", barValue);
    }
    public static int GetBar(this BaseDataObject dataObject)
    {
        return (int)dataObject.GetData("bar");
    } 
```

而且效果很好。

# wpf - 布局之间项目的WPF动画？

> ID：132251
> 
> 赞同：4
> 
> 时间：2008-09-25T09:04:32.217
> 
> 标签：wpf, layout, animation

我有两种不同的方式在 WPF 应用程序中显示项目。第一个使用 WrapPanel，第二个使用垂直 StackPanel。通过在两种类型之间切换主机面板，我可以在两种显示我的项目的方式之间切换。这确实有效，但您会在布局中获得实例更改。

相反，我希望子项在两个布局之间进行动画处理，以便为用户提供良好的平滑效果。有什么想法可以实现吗？我是否需要改为使用 Canvas 并手动计算儿童的位置？那将是一个真正的痛苦！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T09:32:38.547

查看 IdentityMine 的[Blendables Layout](http://www.blendables.com/products/productsLayoutmix.aspx)中的 SwitchPanel，并阅读 WPF 博士在 CodeProject 上关于[概念儿童的文章](http://www.codeproject.com/KB/WPF/ConceptualChildren.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T14:36:20.903

我在 codeproject 上发布了另一个解决方案，它是免费的，可以使用[WPF 布局到布局转换](http://www.codeproject.com/Articles/466118/WPF-Layout-to-Layout-Transitions)

# java - 何时加载来自插件依赖项的 plugin.xml 文件？

> ID：132263
> 
> 赞同：1
> 
> 时间：2008-09-25T09:07:16.063
> 
> 标签：java, eclipse-plugin, rcp, plugin.xml

我 vahe eclipse rcp 应用程序。在我的插件 AI 中使用 3rd 方插件 B。在插件 B 中有 plugin.xml 和一些扩展。在我的插件中，AI 为插件 B 中定义的扩展添加了一些扩展，并且可以正常工作。

现在我尝试覆盖插件 A 中 B 的某些扩展中的一些值。现在，当我运行应用程序时，有时它使用旧值（来自插件 B 中的 plugin.xml），有时它使用我的新值（来自插件 A plugin.xml ）。它在应用程序的一次执行中是一致的，但从执行到执行会发生变化。

获取这些值的代码在插件 B 中，我不想更改它。看起来像这样：

```
IExtensionPoint extensionPoint = Platform.getExtensionRegistry().getExtensionPoint("org.jbpm.gd.common.xmlMappings");
IExtension[] extensions = extensionPoint.getExtensions(); 
```

我如何确保我的价值观会被使用？

我认为设置正确加载 plugin.xml 文件的顺序很重要，所以我的 plugin.xml 将是最后一个，我的值将覆盖他们的值，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T13:19:38.750

Eclipse 不保证看到扩展的顺序。此外，加载特定插件的时间没有保证的生命周期。如果你想要保证，你需要手动实现它，这可能需要更改插件 B。

# eclipse - 更好的 Eclipse 浏览器？

> ID：132265
> 
> 赞同：3
> 
> 时间：2008-09-25T09:08:37.840
> 
> 标签：eclipse, eclipse-plugin

有谁知道一个免费的 Eclipse 网络浏览器插件，它比内置浏览器更好？我搜索但找不到任何东西。我知道Tasktop有一个，但它不是免费的......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-17T11:05:19.547

它是（2010 年）： [https ://marketplace.eclipse.org/content/eclipse-advanced-browser](https://marketplace.eclipse.org/content/eclipse-advanced-browser)

现在与[http://marketplace.eclipse.org/content/j-office-java-fx-office#.U0-y8HB5B74](http://marketplace.eclipse.org/content/j-office-java-fx-office#.U0-y8HB5B74) ( [http://www.joffice.eu](http://www.joffice.eu) )集成

现在你只能做这样的事情：[https ://stackoverflow.com/a/9056165/2288169](https://stackoverflow.com/a/9056165/2288169)

# linker - 致命错误 C1900：“P1”版本“20060201”和“P2”版本“20050411”不匹配

> ID：132270
> 
> 赞同：3
> 
> 时间：2008-09-25T09:10:42.030
> 
> 标签：linker

我用 VIsual Studio 2005 Express Edition 编译我的项目，并得到这个链接错误。谁能建议如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-29T07:51:04.550

我从 Microsoft 下载了 VS2005 Service Pack 1，安装它并解决了问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T12:26:55.460

MSDN：[致命错误 C1900](http://msdn.microsoft.com/en-us/library/ks07be9f(VS.80).aspx)说：

“在编译器的各种传递中运行的工具不匹配*。number1*和*number2*指的是文件上的日期。例如，在传递 1 中，编译器前端运行 (c1.dll)，在传递 2 中，编译器后端运行 (c2.dll)。文件上的日期必须匹配，如果不匹配，请重新安装并使用每个工具的当前版本。”

转到添加/删除程序，选择 Visual Studio 2005 Express Edition，单击更改/删除，然后执行修复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T09:24:17.490

[在http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1512436&SiteID=1](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1512436&SiteID=1)上提出并回答了这个确切的问题。

尝试重新安装。它似乎是安装了错误的服务包。

# c# - Active Directory：检索用户信息

> ID：132277
> 
> 赞同：10
> 
> 时间：2008-09-25T09:16:34.107
> 
> 标签：c#, active-directory

我有一个使用我们的 Active Directory 针对 Windows 身份验证运行的 Web 应用程序。我有一个新要求，即从 Active Directory 条目中提取一些个人信息。获取此信息的最简单方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-25T09:35:09.367

通过 DirectoryEntry 直接访问用户似乎是最直接的方法。以下是我从我的第一个 AD 相关项目中学到的一些与 AD 相关的花絮：

*   在 URI 中，将 LDAP 写成小写。否则你会得到一个神秘的错误。我花了一天多的时间在这个令人沮丧的问题上......
*   要清除单值属性，请将其设置为空字符串，而不是 null。Null 导致异常。
*   要清除多值属性，请使用*DirectoryEntry.Property.Clear()*方法。
*   Active Directory 架构参考将说明值将是哪种数据类型以及它是多值还是单值。
*   您不需要在 Directoryentry 上手动 RefreshCache()，但如果您曾经使用它并指定要缓存的属性，请知道它将来不会自动检索任何其他属性。
*   绝对可以在您使用 System.DirectoryServices 中的类的任何时候引发 COMException。留意那些尝试块。不要假设任何事情都是安全的。

如果您不知道它的路径（您不会，只需让他登录），您可能需要使用 DirectorySearcher 来获取用户的目录条目。使用它相当容易，但要注意 LDAP 语法中的怪癖；即，必须对非 ASCII（和其他？）字符进行编码。您使用的搜索字符串可能类似于：*(&(sAMAccountName=whatever)(class=user))*。这不是我的想法，可能有点不正确。

[Active Directory 架构参考](http://msdn.microsoft.com/en-us/library/ms675085(VS.85).aspx)将很有用。请务必了解架构可以修改和扩展（例如，安装 Exchange 将向用户添加邮箱信息）。

[AD Explorer](http://technet.microsoft.com/en-us/sysinternals/bb963907.aspx)是一个有用的工具，可用于调试和低级 AD 数据管理。当我知道要设置哪个属性但在 AD 管理工具中找不到正确的对话框时，我发现它很有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T09:37:12.700

您可能会发现以下代码片段作为入门非常有用。

```
public static bool IsUserInGroup(string lanid, string group)
{
    DirectoryEntry entry = new DirectoryEntry("LDAP://" + LDAPPATH);
    if(entry != null)
    {
        entry.Username=@"LDAPUSER";
        entry.Password="LDAPPASSWORD";
        DirectorySearcher srch = new DirectorySearcher(entry);
        srch.Filter = String.Format("(&(objectClass=person)(sAMAccountName={0}))", lanid);
        srch.PropertiesToLoad.Add("memberOf");

        SearchResult result = srch.FindOne();
        if(result != null)
        {
            if(result.Properties.Contains("memberOf"))
            {
                string lookfor = String.Format("cn={0},", group.ToLower());
                foreach(string memberOf in result.Properties["memberOf"])
                {
                    if(memberOf.ToLower().StartsWith(lookfor))
                        return true;
                }
            }
        }
        return false;
    }
    throw new Exception(String.Format("Could not get Directory lanid:{0}, group{1}",   lanid, group));
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-25T09:44:55.817

一个很好的参考：[Howto: (Almost) Everything In Active Directory via C#](http://www.codeproject.com/KB/system/everythingInAD.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T09:23:45.777

看看 System.DirectoryServices 命名空间：

[System.DirectoryServices 命名空间](http://msdn.microsoft.com/en-us/library/system.directoryservices.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T09:20:55.360

我使用标准 LDAP 库从 Active Directory 服务器检索信息，但您必须验证您需要的数据是否可通过 LDAP 服务器的模式获得。通常，您可以获得存储在 InetOrganizationalPerson 中的任何信息以及与它们所属的组相关的大部分信息。

# asp.net-mvc - 是否有关于将 Subsonic 与 Asp.Net MVC 框架一起使用的任何提示/技巧？

> ID：132280
> 
> 赞同：9
> 
> 时间：2008-09-25T09:16:55.213
> 
> 标签：asp.net-mvc, subsonic

有没有人使用 Subsonic 和 asp.net mvc 框架？如果是这样，你能告诉我们一些你的经历吗？有没有可以分享的技巧和窍门？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T22:56:00.317

如果您计划进行数据库优先设计，并且不需要任何映射（即您可以控制数据库命名），那么 SubSonic 是一个不错的选择。

它直截了当，不会对你隐藏太多。同样，对于高级场景，我必须避开它并执行原始 sql（或 sproc）。

如果您正在寻找更好的数据库对象抽象，更接近您的问题域的东西，那么我会看看 NHibernate 或 Castle ActiveRecord。这为您希望对象模型的外观提供了更大的灵活性，并且您可以使用强大的查询 API。

这些都与 ASP.NET MVC 无关，只是在 Web 项目中使用对象。无论如何，我建议将实体放在单独的类库项目中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-26T15:24:34.843

我完全同意 Ben *SubSonic*是一个*ORM*并且与 MVC 概念配合得很好，但没有任何将它与*MVC*联系起来的东西。

对于小型项目或您已经拥有数据库并且不太关心域的项目，那么*SubSonic*非常棒，可以让您快速启动并运行。

但是，如果您的项目更大或更具体​​，您的数据库是事后考虑的，那么您应该使用像*NHibernate*这样的工具。

FYI [Summer of *NHibernate*](http://www.summerofnhibernate.com/)*是关于NHibernate*入门的精彩截屏系列

 *# web-services - 是否有一种标准方法可以向您的 Web API 验证应用程序？

> ID：132282
> 
> 赞同：5
> 
> 时间：2008-09-25T09:18:09.360
> 
> 标签：web-services, authentication, standards

我正在考虑构建一个简单的 Web 应用程序，该应用程序将公开一个 API，该 API 允许第三方（好吧，由我编写，但这不是重点）应用程序查询和修改存储在网站上的用户特定数据。

显然，我不想让应用程序能够在未经用户同意的情况下获取用户特定的信息。我想要某种应用程序身份验证，其中用户允许他们运行的应用程序使用 Web API 访问他们的信息。

有没有一种标准的方法来实现这一点，或者每个应用程序（即[rememberthemilk](http://rememberthemilk.com)）只是专门为他们制定了一个定制的解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T09:19:11.497

[OAuth](http://oauth.net/)对您有用吗？这就是它旨在解决的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T09:23:46.320

如果数据在 Internet 上传输，请注意通过 HTTPS 访问您的 Web 服务。人们煞费苦心地验证他们的 Web 服务，但随后使它们容易受到网络嗅探的攻击。

# java - SVNkit 无法创建 SVNRepository

> ID：132293
> 
> 赞同：13
> 
> 时间：2008-09-25T09:22:13.173
> 
> 标签：java, svn, svnkit

我正在尝试使用 SVNkit 在两个 svn url 上运行差异。问题是我在`diff.doDiff`被调用时收到错误。

> org.tmatesoft.svn.core.SVNException: svn: Unable to create SVNRepository object for ' [http://svn.codehaus.org/jruby/trunk/jruby/src/org/jruby/Finalizable.java](http://svn.codehaus.org/jruby/trunk/jruby/src/org/jruby/Finalizable.java)' 在 org.tmatesoft.svn.core.internal.wc.SVNErrorManager.error(SVNErrorManager.java:40) 在 org.tmatesoft.svn.core.internal.wc.SVNErrorManager.error(SVNErrorManager.java:55) 在 org. tmatesoft.svn.core.io.SVNRepositoryFactory.create(SVNRepositoryFactory.java:199) 在 org.tmatesoft.svn.core.wc.DefaultSVNRepositoryPool.createRepository(DefaultSVNRepositoryPool.java:213) 在 org.tmatesoft.svn.core.wc。 SVNClientManager.createRepository(SVNClientManager.java:242) 在 org.tmatesoft.svn.core.wc.SVNBasicClient.createRepository(SVNBasicClient.java:231) 在 org.tmatesoft.svn.core.wc.SVNDiffClient.doDiffURL(SVNDiffClient.java:第769章）

我已经仔细检查了 URL（我可以在 TortoiseSVN 客户端中打开它们）。有人可以帮我知道发生了什么吗？我已经发布了我在下面运行的代码。

```
SVNClientManager manager = SVNClientManager.newInstance(SVNWCUtil.createDefaultOptions(false), user, pass);

SVNDiffClient diff = manager.getDiffClient();
    //ISVNDiffStatusHandler diffStatus = new ISVNDiffStatusHandler();

try {
SVNURL oldURL = SVNURL.parseURIDecoded(url);    
diff.doDiff(SVNURL.parseURIDecoded(url), SVNRevision.create(oldVersion), SVNURL.parseURIDecoded(url), SVNRevision.HEAD, false, false, System.out);
} catch (SVNException e) {
// TODO Auto-generated catch block
e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-25T14:20:34.440

您是否调用了以下静态方法？

> DAVRepositoryFactory.setup();

这需要在访问任何`http://`存储库和类似内容之前调用

> SVNRepositoryFactoryImpl.setup();

应该用于`svn://`存储库。

# java - 上次资源优化

> ID：132295
> 
> 赞同：1
> 
> 时间：2008-09-25T09:22:37.680
> 
> 标签：java, application-server, jta, 2phase-commit

我正在编写一个不支持两阶段提交的资源适配器。我知道有一种优化技术叫做：“最后的资源优化”。

在 JBoss 上，您的 XAResource 类应该实现 LastResource 以便进行优化。

我的问题是：如何在 WebLogic、WebSpehre、Glassfish 等中做到这一点......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T15:53:11.113

Weblogic：**AFAIK**（可能是非常错误的）只有 JDBC 驱动程序可以与 LRO 一起使用，这**纯粹是一项管理任务**。当驱动程序不支持 XA 时，可以将其配置为与 LRO 一起使用：*“如果要启用来自数据源的非 XA JDBC 连接以模拟使用 JTA 参与全局事务，请选择此选项”*。

本质上，LRO 容忍没有准备阶段的资源，并且只能提交或回滚。因此，如果 XA 事务中只有一个这样的资源，我们可能首先尝试准备所有其他资源，然后提交该 LRO 一个，然后，如果成功，则提交其他资源，否则回滚其他资源。

你看，声明任何接口都没有特殊需要。这是一种可以与任何非 XA 资源一起使用的算法。我不确定为什么 JBoss 有它，但我不希望其他服务器有类似的东西。

# .net - 有没有一种简单的方法可以将 Delphi 2009 中的 Win32 应用程序移植到 .NET？

> ID：132299
> 
> 赞同：3
> 
> 时间：2008-09-25T09:23:16.103
> 
> 标签：.net, delphi, delphi-2009

我们希望从 Delphi 7.0 迁移到 Delphi 2009，以跟上现代 IDE 和当前技术。我们的目标平台是.NET。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T09:40:54.500

请记住，D2009 是 win32 版本，而不是 .net。我想你想做一个两步的路径，首先移动到 D2009 然后移动到 .net ？

幸运的是，delphi 是一个非常稳定的平台，将旧应用程序转换为最新版本要容易得多，但您需要考虑不同的事情。

如果您的应用程序使用 BDE 访问 Db，则将其转换为使用其他技术，如 ADO 或 DBX。

如果您使用第 3 方组件，请确保存在 D2009 和/或 .NET 版本

一个非常微妙的方面是字符串处理。如果您“通常”使用字符串，您应该没有什么大问题，但是如果您像在 C 中那样使用字符串作为“字节缓冲区”，那么您必须小心并尝试重写这些部分。一条经验法则是“尝试摆脱代码中的所有 PChar”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T10:10:39.080

我将采用从 D2007 到 D2009 的字符串处理的 Unicode 情况 - 此步骤中涉及的更改可能会对您的应用程序产生很大影响（只有您可以告诉这一点）。此外，您还需要考虑您正在使用哪些第三方工具/库/组件。并不是所有的东西都跳到了 D2009，而且很可能一些不太受欢迎的组件可能永远不会跳到 D2009。

一个更明智的路径可能是**将 D7 迁移到 D2007**（这是一条成熟的路径，基本上没有痛苦，有很多胜利和有价值的改进）。然后，您将处于一个现代、稳定、最新、受支持的 Delphi 平台中，您可以从中更好地评估跳转到 .Net。

我自己对最后阶段的看法会与其他一些评论相呼应，请注意——除非你从 .Net 中获得了一些巨大的胜利，否则我不明白你为什么会离开 Delphi。随着各种运行时和服务包的现代需求，我认为 Delphi 正在成为Win32 开发**越来越** ***可行*** **的相关**工具。要么将代码从 D7 升级到 D2007/D2009，要么直接从 D7 跳转到 .Net；做一个然后另一个似乎有点奇怪！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T09:39:12.837

从 Delphi 7 迁移到 Delphi 2009 可能是直截了当的，只有微小的变化（例如最近讨论的从 ANSI 到 Unicode 字符串的迁移）。不过，迁移到 .NET 并不是那么简单。虽然有一个 VCL.NET 使得迁移 GUI 成为可能，但其他严重的事情将无法正常工作。因此，您可能会想到拥有 Win32 代码和 .NET 代码，通过 COM 将它们组合在一起。（我希望你已经了解 COM，否则这可能不是一个选项；-)）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T10:01:25.060

[Delphi 2009](http://www.codegear.com/products/delphi/win32 "CodeGear 德尔福 2009")仅针对 Win32。对于 .NET，您可以使用带有用于 .NET 的 Delphi 个性的[RAD Studio 2007](http://www.codegear.com/products/radstudio "CodeGear RAD 工作室 2007")，并且将简单的 VCL 应用程序移植到以 .NET 2.0 框架为目标的 VCL.NET 应该相当容易。但是，如果您使用任何第三方组件和库，您也必须检查他们的 .NET 替代品。

如果您发现这工作量太大，或者如果您想针对最新的 .NET 框架，您最好使用 Microsoft 的 Visual Studio 和 C# 从头开始​​重写您的项目。

免责声明：我没有将 Delphi Win32 项目移植到 .NET 的经验，所以这只是我的拙见。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T09:43:08.600

移植绝非易事。然而，Delphi 和 .NET 之间的语义非常接近，因为它们的首席架构师都是 Anders Hejlsberg。您很可能需要将 Win32 VCL 调用替换为等效的 VCL.NET 内容。

您可能想要升级到 CodeGear RAD Studio，因为这将使您拥有一个适用于 Delphi 和 .NET 语言（主要是 C#）的 IDE。

很多时候，当我从一种技术转移到另一种技术时，我能够更换控制装置。例如，我能够用它们的 ADO.NET 替代品替换 BDE 数据库控件，而无需真正更改代码。最终，您拥有代码并且比我们任何人都了解更多。

当您对 Win32 可执行文件有很好的支持时，为什么要针对 .NET 框架？Delphi 已经是该行业的一小部分，而带有 .NET 的 Delphi 甚至更小。Delphi 在 .NET 世界中始终是二等公民。Delphi 已经是一流的 Win32 公民。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T11:00:21.347

按照上面 Giacomo 的回答，如果您使用的是 BDE，那么我可以建议 MicroOlap 的 DAC [http://www.microolap.com/](http://www.microolap.com/) - 这将为您节省大量时间，而不必将您的代码转换为其他东西。我正在使用 PostgresDAC，这个产品非常稳定和快速。

# sql-server-2000 - 链接服务器性能和选项

> ID：132305
> 
> 赞同：9
> 
> 时间：2008-09-25T09:25:33.227
> 
> 标签：sql-server-2000, linked-server

在工作中，我们有两台服务器，一台正在运行一个很多人使用的应用程序，它有一个 SQL Server 2000 后端。很长一段时间以来我一直可以自由地查询它，但不能向它添加任何东西，例如存储过程或额外的表。

这导致我们将第二个 SQL Server 链接到第一个 SQL Server，而我构建了一个存储过程库，该库使用链接服务器从双方查询数据。其中一些查询花费的时间比我想要的要长。

有人可以给我一些关于使用链接服务器的好文章吗？我对找出两者之间正在传输的数据特别感兴趣，因为通常大多数 sql 语句都可以远程执行，但我感觉它可能正在传输完整的表，它通常只是一个小的 final 的连接本地表。

另外我目前有什么链接服务器选项：

*   校对兼容 True
*   数据访问真
*   RPC 真
*   Rpc 输出真
*   使用远程整理 False
*   排序规则名称（空白）
*   连接超时 0
*   查询超时 0

**编辑：**

只是想我会更新这篇文章，我使用了带有动态参数的 openqueries 一段时间来提高性能，谢谢你的提示。但是，当您最终处理字符串时，这样做会使查询更加混乱。终于在今年夏天，我们将 SQL Server 升级到 2008 并实现了实时数据镜像。老实说，对于我的任务，开放查询的速度已经接近本地查询的速度，但镜像确实使 sql 更容易处理。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-27T05:53:25.940

避免连接到链接的服务器表。

可以为您的连接使用四部分命名，但成本更高。您的联接可能包含可用于限制来自链接服务器的数据集并使用索引列的条件。

例子：

```
SELECT loc.field1, lnk.field1
FROM MyTable loc
INNER JOIN RemoteServer.Database.Schema.SomeTable lnk
  ON loc.id = lnk.id
  AND lnk.RecordDate = GETDATE()
WHERE loc.SalesDate = GETDATE() 
```

此查询还在连接中应用一个条件，链接服务器可以在计算连接之前使用该条件。

推荐的方法是使用 OPENQUERY。

通过使用 OPENQUERY 避免连接，本地服务器只发送要远程执行的查询，而不是发送一组用于连接的 ID。

使用该链接检索一组数据并在本地执行计算。要么使用临时表（用于临时查询），要么在夜间作业中将行插入到永久表中。

如果在喜欢的服务器中设置了远程事务协调器，开始事务可能会失败。使用它会消耗更多的资源。

还要考虑到您正在访问运行应用程序的生产服务器，虽然您没有指定它，但我认为可以安全地假设它正在使用大量事务并进行插入和更新。您正在从应用程序中夺走资源。

您的目的似乎是将数据用于报告目的。您的服务器可以设置为具有简单日志而不是完整日志，从而提高效率。

您还将避免由于链接服务器上的数据移动而取消您的查询。始终注意为查询和表提示（如 NOLOCK）设置适当的隔离级别。

请！切勿将 OPENQUERY（或任何链接服务器）放在循环中！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T14:02:54.840

当您使用链接服务器进行此类连接时，重要的是让您立即连接到的服务器（“本地”）成为拥有最多数据的服务器，其中链接服务器仅提供一小部分数据，否则，是的，它将提取执行连接所需的尽可能多的数据。

替代方法包括将数据的子集复制到临时表中，并完成尽可能多的工作以缩小结果和链接服务器可以执行的任何预处理，然后在“本地”端进行连接。

您可能会发现，您可以通过反转操作方式轻松提高性能，连接到您无法控制的服务器（他们需要为您创建链接服务器），然后通过链接连接到您的服务器。如果您需要对必须创建存储过程的数据进行主要工作 - 然后将数据推送到您的服务器并在那里使用您的存储过程。

在某些情况下，我只是让链接服务器每晚创建这种摘要，然后将其推送到本地服务器，然后本地服务器通过连接执行其工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-26T23:19:27.043

**皇家之痛**

我们曾经在我们的商店有几个链接服务器，结果就是*这样一个 PITA*。

首先，存在与您描述的类似的严重性能问题。当我看到网络 I/O 统计信息时，我感到很震惊。尽管付出了所有努力，但我们未能提示 SQL Server 采取合理的行为。

另一个问题是存储过程将这些链接的服务器名称硬编码在任何地方，无法覆盖它们。因此，开发人员无法在他们的开发沙箱上轻松测试任何涉及链接服务器的功能。这是创建通用单元测试套件的主要障碍。

最后，我们完全放弃了链接服务器，并将数据同步转移到了 Web 服务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T09:30:23.793

涉及跨链接服务器的半连接的查询往往效率不高。您最好使用[OPENQUERY](http://msdn.microsoft.com/en-us/library/aa276848(SQL.80).aspx)将数据填充到本地临时表中，然后从那里处理它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-26T21:38:19.580

几年前，我在 SQL 2000 中编写了一个远程链接服务器应用程序，并遇到了与您描述的相同的性能问题。为了获得最佳性能，我最终多次重写了我的存储过程。

我广泛使用临时表。我发现将大量远程数据检索到临时表中，然后加入它、操作它等成本更低。正如您所描述的那样，将本地连接到远程表非常慢。

Display Execution Plan 和 Display Estimated Execution Plan 往往会有所帮助，尽管我看不懂很多东西。

我不知道是否真的有一种有效的方法可以使用远程服务器执行这些查询，因为 SQL Server 在针对链接服务器时似乎无法利用其正常优化。您可能会觉得您正在转移整个表格，因为事实上这就是正在发生的事情。

我想知道复制方案是否适合您。通过在本地服务器上保存数据，您应该能够编写将按需要执行的正常查询。

我不知道有什么好文章可以指点你。当我编写更复杂的 SQL Server 应用程序时，我开始认为我需要更好地了解 SQL Server 在底层是如何工作的。为此，我们购买了由 Kalen Delaney 编辑的 MS Press Inside Microsoft SQL Server 2005 系列。第 1 卷：存储引擎绝对是开始的地方，但我还没有深入了解它。由于我最近的几个项目没有涉及 SQL Server，因此我对它的研究变得松懈。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T15:29:43.680

您是否有可能在服务器上设置单独的数据库而不是使用链接服务器？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T15:04:14.983

我建议在游标循环中使用动态开放查询，而不是链接连接。这是我能够复制 MS Access 的链接联接性能（至少对于单个远程表）的唯一方法

，ms sql 中的常规链接联接效率太低，因为它专门在巨大的表中提取所有内容。

-- 我想知道游标循环中的开放查询有什么不好？如果操作正确，则不会出现锁定问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-20T07:10:44.887

这是一个非常慷慨的问题，可能有很多解决方案。但正如我们目睹的许多用户说他们已经尝试了一切。

解决我的问题的是..

我将 sql server 2000 从 sp2 升级到 SP4，如果您已经在 sql server 2000 上安装了 sp4，则运行 Instcat.sql。根据我的经验，我可以向您保证，如果您对所有其他解决方法感到筋疲力尽，这肯定会奏效。

谢谢， Mithalesh mithalesh.gupta@gmail.com

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-03T15:30:16.267

动态 SQL 和函数可用于绕过硬编码名称问题。例如，我正在尝试一个实现，其中输入'cpi.cpi'（目的CPI，子目的默认）的函数ufn_linkedDatabase（@ purpose nvarchar（255））返回'[SERVER-NAME.DOMAIN.LCL，2000]。 [CPI]' 在生产环境中（我们使用 SQL Server 的备用端口号，我不知道为什么，包括链接服务器名称）。然后在@template varchar(max) 中组装一条SQL 命令，表达式@{cpi.cpi} 表示链接的服务器和数据库，然后@workstring = REPLACE(@template, N'@{cpi.cpi}', 。 ..) . 函数实际获取数据库名称的方式与过程是分开的——查找表很好。

问题 - 执行 OPENQUERY()，至少除非链接服务器选项“排序规则兼容”设置为“true”，否则可能会更好，以便可以在链接服务器上执行更多任务 - 即使在快速网络上也很重要，而且我们的服务器机房内部网络速度相当快 - 要执行 OPENQUERY()，我可能需要分别处理 'cpi.cpi.server' 和 'cpi.cpi.database' 和 'cpi.cpi.server.database'。而且，我最终可能会使用这种设计编写一个应用程序，在这种情况下，它是过度设计的。尽管如此，这意味着函数本身不必是任何花哨的工作。

无论如何，在问题上投入快速网络硬件可能是更便宜的答案。

# encoding - 如何更正文件的字符编码？

> ID：132318
> 
> 赞同：56
> 
> 时间：2008-09-25T09:31:22.963
> 
> 标签：encoding, utf-8, character-encoding, text-files, codepages

我有一个 ANSI 编码的文本文件，它不应该被编码为 ANSI，因为有 ANSI 不支持的重音字符。我宁愿使用 UTF-8。

数据可以正确解码还是在转码中丢失？

我可以使用哪些工具？

这是我所拥有的示例：

```
Ã§ Ã© 
```

我可以从上下文中看出（café应该是cafe）这些应该是这两个字符：

```
ç é 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-12-18T06:15:40.223

使用 Notepad++ 执行以下步骤

1-复制原文

2-在记事本++中，打开新文件，更改编码->选择您认为原始文本遵循的编码。尝试编码“ANSI”，因为有时某些程序会将 Unicode 文件读取为 ANSI

3-粘贴

4-然后通过再次转到同一菜单来转换为 Unicode：编码->“在 UTF-8 中编码”（不是“转换为 UTF-8”），希望它会变得可读

上述步骤适用于大多数语言。您只需要在粘贴到 notepad++ 之前猜测原始编码，然后通过相同的菜单转换为基于 Unicode 的替代编码，以查看内容是否变得可读。

大多数语言以 2 种编码形式存在： 1- 旧的 ANSI (ASCII) 形式，只有 8 位，最初被大多数计算机使用。8 位仅允许 256 种可能性，其中 128 位是常规拉丁字符和控制字符，最后 128 位的读取方式因 PC 语言设置而异 2- 新的 Unicode 标准（最多 32 位）为每个字符提供唯一代码在所有当前已知的语言中，还有更多。如果文件是 unicode，则应该在任何安装了该语言字体的 PC 上都能理解。请注意，即使 UTF-8 上升到 32 位，并且与 UTF-16 和 UTF-32 一样广泛，它也尝试将拉丁字符保持在 8 位，以节省磁盘空间

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-25T18:31:45.693

编辑：在进入更复杂的解决方案之前消除一个简单的可能性：您是否尝试在正在读取文件的文本编辑器中将字符集设置为 utf8？这可能只是有人向您发送您在设置为 cp1252 的编辑器中阅读的 utf8 文件的情况。

仅举两个示例，这是通过单字节编码的镜头读取 utf8 的情况，可能是 iso-8859-1、iso-8859-15 或 cp1252 之一。如果您可以发布其他问题角色的示例，则应该可以进一步缩小范围。

由于对字符的目视检查可能会产生误导，因此您还需要查看底层字节：您在屏幕上看到的 § 可能是 0xa7 或 0xc2a7，这将决定您必须进行的字符集转换类型。

您是否可以假设您的所有数据都以完全相同的方式被扭曲 - 它来自同一个来源并经历了相同的转换序列，例如，您的文本中没有一个 é，它总是一种§？如果是这样，可以通过一系列字符集转换来解决问题。如果您可以更具体地了解您所处的环境和您正在使用的数据库，那么这里的某人可能会告诉您如何执行适当的转换。

否则，如果问题字符仅出现在数据中的某些位置，则必须根据“没有作者打算在其文本中放置 Ã§，因此每当您看到它，替换为ç”。后一种选择风险更大，首先是因为那些关于作者意图的假设可能是错误的，其次是因为你必须自己发现每个问题字符，如果有太多文本需要目视检查或者如果它是书面的，这可能是不可能的在你不熟悉的语言或书写系统中。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-25T12:40:30.093

当您看到 Ã§ 和 Ã© 之类的字符序列时，通常表明 UTF-8 文件已被以 ANSI（或类似格式）读取的程序打开。Unicode 字符，例如：

U+00C2 带抑扬
符的拉丁文大写字母 A U+00C3 带波浪号的拉丁文大写字母 A
U+0082 此处允许中断
U+0083 此处无中断

由于 UTF-8 使用的可变字节策略，它倾向于出现在 ANSI 文本中。[这个策略在这里](http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8)解释得很好。

对您来说的好处是这些奇怪字符的出现使查找和替换不正确转换的实例相对容易。

我相信，由于 ANSI 总是每个字符使用 1 个字节，因此您可以通过简单的搜索和替换操作来处理这种情况。或者更方便的是，使用包含违规序列和所需字符之间的表映射的程序，如下所示：

â€œ ->“ # 应该是一个开头的双花引号
â€？-> ” # 应该是双引号

任何给定的文本，假设它是英文的，都会有相对少量的不同类型的替换。

希望有帮助。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-25T09:34:30.897

从命令行使用 vim：

```
vim -c "set encoding=utf8" -c "set fileencoding=utf8" -c "wq" filename 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-25T09:43:13.140

使用 iconv - 请参阅[在字符集之间转换文本文件的最佳方式？](https://stackoverflow.com/questions/64860/best-way-to-convert-text-files-between-character-sets)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-06-29T13:42:37.527

在崇高的文本编辑器中，文件->使用编码重新打开->选择正确的编码。

一般会自动检测编码，如果没有，可以使用上面的方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T09:50:19.720

如果您在文件中看到问号或者重音符号已经丢失，那么返回 utf8 将无助于您的事业。例如，如果咖啡厅变成了咖啡厅 - 单独更改编码将无济于事（并且您需要原始数据）。

你能在这里粘贴一些文字，这将有助于我们肯定回答。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-23T19:26:01.897

我找到了一种自动检测文件编码的简单方法 - 将文件更改为文本文件（在 Mac 上将文件扩展名重命名为 .txt）并将其拖到 Mozilla Firefox 窗口（或文件 -> 打开）。Firefox 将检测编码 - 您可以在 View -> Character Encoding 下查看它的结果。

一旦我知道正确的编码，我就使用 TextMate 更改了文件的编码。文件 -> 使用编码重新打开并选择您的编码。然后 File -> Save As 并将编码更改为 UTF-8 并将行结尾更改为 LF （或任何你想要的）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-01-28T11:47:27.457

我在寻找中文字符的代码页问题的解决方案时发现了这个问题，但最后我的问题只是 Windows 无法在 UI 中正确显示它们的问题。

如果其他人有同样的问题，您可以通过将 Windows 中的本地更改为中国然后再返回来解决它。

我在这里找到了解决方案：

[http://answers.microsoft.com/en-us/windows/forum/windows_7-desktop/how-can-i-get-chinesejapanese-characters-to/fdb1f1da-b868-40d1-a4a4-7acadff4aafa?page=2&auth= 1](http://answers.microsoft.com/en-us/windows/forum/windows_7-desktop/how-can-i-get-chinesejapanese-characters-to/fdb1f1da-b868-40d1-a4a4-7acadff4aafa?page=2&auth=1)

还赞成加布里埃尔的回答，因为在记事本++中查看数据是让我了解 Windows 的原因。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T09:47:41.740

然后是稍旧的[重新编码](http://directory.fsf.org/project/recode/)程序。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T10:09:38.770

有些程序会尝试检测像[chardet](http://chardet.feedparser.org/)这样的文件的编码。然后您可以使用 iconv 将其转换为不同的编码。但这要求原始文本仍然完好无损，并且不会丢失任何信息（例如通过删除重音符号或整个重音字母）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-06-26T19:36:55.717

在 OS X[上 Synalyze 它！](http://www.synalysis.net)允许您以不同的编码显示文件的某些部分（ICU 库支持所有这些编码）。一旦您知道源编码是什么，您就可以通过剪贴板复制整个文件（字节）并插入到选择目标编码（UTF-8 或任何您喜欢的）的新文档中。

使用 UTF-8 或其他 Unicode 表示时非常有用的是[UnicodeChecker](http://earthlingsoft.net/UnicodeChecker/)

# java - 存储对象以通过 x,y 坐标定位

> ID：132319
> 
> 赞同：17
> 
> 时间：2008-09-25T09:31:47.597
> 
> 标签：java, tree, spatial, quadtree

我正在尝试确定一种存储一组对象的快速方法，每个对象都有一个 x 和 y 坐标值，以便我可以快速检索某个矩形或圆形内的所有对象。对于小型对象集（约 100 个），简单地将它们存储在列表中并遍历它的简单方法相对较快。然而，对于更大的群体来说，这预计会很慢。我也尝试将它们存储在一对 TreeMaps 中，一个按 x 坐标排序，一个按 y 坐标排序，使用以下代码：

```
xSubset = objectsByX.subSet( minX, maxX );
ySubset = objectsByY.subSet( minY, maxY );
result.addAll( xSubset );
result.retainAll( ySubset ); 
```

这也有效，并且对于较大的对象集更快，但仍然比我想要的慢。部分问题还在于这些对象四处移动，并且需要重新插入此存储中，这意味着将它们从树/列表中删除并重新添加到树/列表中。我不禁认为那里必须有更好的解决方案。我正在用 Java 实现它，如果它有什么不同的话，尽管我希望任何解决方案都将以有用的模式/算法的形式出现。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-25T10:37:32.807

[四叉树](http://en.wikipedia.org/wiki/Quadtree)似乎解决了我问的具体问题。 [Kd-Trees](http://en.wikipedia.org/wiki/Kd-tree)是一种更通用的形式，适用于任意数量的维度，而不仅仅是两个维度。

如果要存储的对象有一个边界矩形，而不仅仅是一个简单的点，[R-Trees也可能很有用。](http://en.wikipedia.org/wiki/R-tree)

这些类型结构的通用术语是[空间索引](http://en.wikipedia.org/wiki/Spatial_index)。

[Quadtree](http://openmap.bbn.com/doc/api/com/bbn/openmap/util/quadtree/QuadTree.html)和[R-Tree](http://jsi.sourceforge.net/)有一个 Java 实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T09:51:29.203

通用术语是[空间索引](http://en.wikipedia.org/wiki/Spatial_index)。我想你应该根据[现有的实现](http://www.cs.sunysb.edu/~algorith/implement/quadtree/implement.shtml)来选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T09:34:00.617

[四叉树](http://openmap.bbn.com/doc/api/com/bbn/openmap/util/quadtree/QuadTree.html)是通常用于此的[结构。](http://en.wikipedia.org/wiki/Quadtree)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T09:36:39.067

看看[Kd 树](http://en.wikipedia.org/wiki/Kd-tree)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-30T18:38:58.233

C# 中的简单 QuadTree 实现（易于翻译成 java） [http://www.codeproject.com/KB/recipes/QuadTree.aspx](http://www.codeproject.com/KB/recipes/QuadTree.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T14:46:40.553

您可以将所有 x 线放在一个地图中，将 y 线放在另一个地图中，并让地图值指向对象。

```
 TreeMap<Integer, TreeMap<Integer, Point>> xMap = new TreeMap<Integer, TreeMap<Integer, Point>>();
        for (int x = 1; x < 100; x += 2)
            for (int y = 0; y < 100; y += 2)
                {
                    Point p = new Point(x, y);
                    TreeMap<Integer, Point> tempx = xMap.get(x);
                    if (tempx == null)
                        {
                            tempx = new TreeMap<Integer, Point>();
                            xMap.put(x, tempx);
                        }
                    tempx.put(y, p);
                }
        SortedMap<Integer, TreeMap<Integer, Point>> tempq = xMap.subMap(5, 8);
        Collection<Point> result = new HashSet<Point>();
        for (TreeMap<Integer, Point> smaller : tempq.values())
            {
                SortedMap<Integer, Point> smallerYet = smaller.subMap(6, 12);
                result.addAll(smallerYet.values());
            }
        for (Point q : result)
            {
                System.out.println(q);
            }
    } 
```

# c++ - 使用迭代器获取向量的索引

> ID：132323
> 
> 赞同：5
> 
> 时间：2008-09-25T09:33:22.693
> 
> 标签：c++, indexing, vector, iterator

当迭代向量的元素时，最好使用迭代器而不是索引（请参阅[为什么使用迭代器而不是数组索引？](https://stackoverflow.com/questions/131241/why-use-iterators-instead-of-array-indices)）。

```
std::vector<T> vec;
std::vector<T>::iterator it;
for ( it = vec.begin(); it != vec.end(); ++it )
{
   // do work
} 
```

但是，可能需要在循环体中使用索引。在这种情况下，考虑到性能和灵活性/可扩展性，以下哪一项更可取？

1.  恢复到索引循环

    ```
    标准::向量向量；
    尺寸_t我;
    对于 ( i = 0; i < vec.size(); ++i )
    {
       // 使用我
    }

    ```

2.  计算偏移量

    ```
    标准::向量向量；
    std::vector::iterator it;
    对于 (它 = vec.begin(); 它!= vec.end(); ++it)
    {
       size_t i = 它 - vec.begin();
       // 使用我
    }

    ```

3.  使用 std::distance

    ```
    标准::向量向量；
    std::vector::iterator it;
    对于 (它 = vec.begin(); 它!= vec.end(); ++it)
    {
       size_t i = std::distance(vec.begin(), it);
       // 使用我
    }

    ```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-25T09:59:47.937

如果您打算仅使用向量，则可能需要切换回索引循环，因为它比迭代器循环更清楚地传达了您的意图。但是，如果您的程序在未来的演变可能导致容器的变化，您应该坚持使用迭代器并使用 std::distance，它保证可以与所有标准迭代器一起使用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T09:36:35.447

使用 std::distance 更通用一点，因为它适用于所有迭代器，而不仅仅是随机访问迭代器。它应该和它一样快 - vec.begin() 在随机访问迭代器的情况下。

它 - vec.begin() 基本上是指针算术。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-25T14:07:08.760

[`std::distance(vec.begin(), it)`](http://www.sgi.com/tech/stl/distance.html)假设`it`它指向`vec`.

卡尔

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-25T09:37:56.897

恢复到索引循环。

基本上在 90% 的情况下，迭代器是优越的，这是 10% 的情况之一。通过使用迭代器，您会使代码更复杂，因此更难理解，而使用迭代器的全部原因首先是为了简化代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T11:42:24.787

您缺少一个解决方案：保留索引以备不时之需，但不要将其用作循环条件。也适用于列表，并且成本（每个循环）是 O(n) 和一个额外的寄存器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T13:16:19.570

出于未来发展的原因，我总是倾向于使用迭代器。

在上面的示例中，如果您可能决定将 std::vector 替换为 std::set （可能您需要一个唯一的元素集合），使用迭代器和 distance() 将继续有效。

我很确定任何性能问题都会被优化到可以忽略不计的程度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T16:11:29.897

对于向量，我总是使用整数方法。向量中的每个索引与数组查找的速度相同。如果我要大量使用该值，我会为它创建一个引用，以方便起见。

理论上，向量迭代器可能比索引稍快，因为它们使用指针算法来遍历列表。但是，通常我发现可读性值得最小的运行时差异。

I use iterators for other container types, and sometimes when you don't need the loop variable. But if you need the loop variable, you're not doing anything except making your loop harder to type. (I cannot wait for c++0x's auto..)

# java - 使用 Apache HttpClient，为什么我的连接超时不起作用？

> ID：132326
> 
> 赞同：11
> 
> 时间：2008-09-25T09:34:02.100
> 
> 标签：java, httpclient

在调用 doGetConnection() 时，我的 httpclient 实现偶尔会引发异常。但是，我设置了以下超时

```
_moHttpClient.setHttpConnectionFactoryTimeout(30000); 
```

看起来我的超时时间几乎没有被接收。还有其他地方我需要设置超时以确保这种行为不会再次发生

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T10:51:35.910

你会抛出什么异常？

不要忘记您有**两个**超时来更改/检查。从`HttpConnectionParams`

```
setConnectionTimeout()
setSoTimeout() 
```

因此您可以控制等待连接到服务器的时间，以及在超时之前对套接字的操作需要多长时间。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T09:36:01.410

```
 HttpConnectionManagerParams cmparams = new HttpConnectionManagerParams();
    cmparams.setSoTimeout(10000);
    cmparams.setTcpNoDelay(true);
    HttpConnectionManager manager = new SimpleHttpConnectionManager();
    manager.setParams(cmparams);
    params = new HttpClientParams();
    params.setSoTimeout(5000);
    client = new HttpClient(params, manager); 
```

我想知道为什么我有两个不同的 SoTimeouts 集。也许我试图找出哪个实际上是活跃的，因为我在使用它时遇到了和你一样的问题。

以上是我们现在的实时代码，但我不能说它是否有效是因为它是正确的，还是因为天意对我微笑（而另一端通常总是可用的）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T09:59:22.570

> cmparams.setSoTimeout(10000);

这个默认适用于所有 HttpClient。

> params.setSoTimeout(5000);

而这个是针对特定的 httpclient 的。

# f# - F# 中的全文搜索引擎示例？

> ID：132329
> 
> 赞同：3
> 
> 时间：2008-09-25T09:34:36.170
> 
> 标签：f#, functional-programming, full-text-search

有没有关于如何在 F# 中构建全文搜索引擎的好例子（网站或书籍）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T09:55:25.950

你想自己写这个吗？还是您只需要该功能？

如果您需要该功能，支持全文搜索的嵌入式/内存数据库可能会解决问题。由于它是 .Net，我推荐[SQLite ADO.Net Provider](http://sqlite.phxsoftware.com/)作为开源竞争者。它非常好（在任何其他提供者之前支持 LINQ、设计时支持等），并且 FTS 支持正在非常积极的开发中。我认为谷歌正在努力。还有[VistaDB 数据库](http://www.vistadb.net)。我现在主要用那个。它应该有 FTS 支持。完全是.Net，这给了它一些集成优势。

如果您必须自己做，请查看有关[信息检索](http://en.wikipedia.org/wiki/Information_retrieval)的书籍。我读过一些，但不知道从人群中脱颖而出。亚马逊可能会在那里提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-12T02:34:15.453

我只用几行代码在 F# 中编写了一个搜索引擎。您可以在我的海报中阅读相关内容并访问完整的实现

[Stefan Savev 的主页](http://www.ccs.neu.edu/home/savev)

基本思想如下面的代码所示，但实际上比代码本身还需要更多的解释。这些也可以在我的网站上找到。

此代码在磁盘上创建文档集合的索引。索引在外部存储器中完成。

```
1\. 让 create_postings in_name tmp_dir out_name =
2\. 让 process_doc (doc_id, doc_text) =
3\. doc_text |> 标记化 |> 停用词 |> 词干
4a。|> 列表.count
4b。|> ListExt.map(fun (word, tf) -> (word, (doc_id, tf))
5\. in_name
6\. |> as_lines
7\. |> Seq.map_concat extract_docs
8\. |> Seq.map_concat process_doc
9a。|> External.group_by (fun (w, _) -> w)
9b。（有趣（_，docid_and_tf）-> docid_and_tf）
9c。(有趣的 lst -> (List.length lst, lst))
9d。tmp_dir
9e。(外部.ElemDesc())
10\. |> 输出out_name

```

# xml - xml 文件的最大大小

> ID：132330
> 
> 赞同：6
> 
> 时间：2008-09-25T09:34:39.993
> 
> 标签：xml

对于 xml 文件的最大大小，您的经验法则是什么。

如果我问最大记录数，例如一条记录有 10 个值怎么办？另一个条件是我们从网络加载它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-25T09:35:55.387

我的规则是，**如果做我想做的事情太慢，那么它就太大了**，你的数据可能需要移动到其他格式......数据库或类似的。

遍历 XML 节点或使用 XPath 可能是一条狗。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T09:46:54.177

这可能不是您想听到的，但是...如果您正在考虑 XML 文件的大小，您可能应该使用数据库而不是文件（即使它们不是平面文件，而是像 XML 一样结构化）。数据库经过高度优化，可有效存储大量数据。检索数据的最佳算法在数据库的代码库中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T09:38:06.833

没有。但是，文件的最大大小取决于您使用的文件系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-24T07:06:07.980

**XML 文件大小**没有**限制，** 但它需要**内存 (RAM)**作为**XML 文件的文件大小**，因此**XML 文件**解析大小过长会**影响性能**。 建议使用**[SAX for .NET](http://saxdotnet.sourceforge.net/)**来解析长 XML 文档以增加**XML 大小。**

 ***** * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T09:39:12.900

我认为您不应该对数据的最大大小有一个经验法则，无论是 XML 还是其他任何东西。如果您需要存储数 GB 的数据，则存储该数据。不同之处在于您使用什么 API 来处理该数据。但是，如果您的数据集非常大，XML 可能不是您的最佳选择。在这些情况下，关系或 XML 数据库可能会比单个 XML 文件更好地工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T09:44:43.183

我认为这取决于上下文、文件来自/生成的位置、您将如何处理它、它必须通过的任何连接的带宽、系统 RAM 大小等？

你的背景是什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T10:03:25.290

即使并非所有解析器都将整个文件读入内存，但如果您真的需要经验法则，我会说不大于可用内存的一半。任何更大的东西都可能太慢了:)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2017-10-12T21:32:07.647

我在 2010 年参与了一个项目，当时我不得不将报纸网站从 Typo 3 迁移到 Drupal 7，当时最快的方法是将所有内容导出为 xml，然后将它们解析为 drupal(Xpath)。我们尝试一次性完成，但我们在 4Gigs 上遇到了问题。所以我们每年划分 xml，让每个文件的解析时间更少，文件大小以 MB 为单位，这很好。其他读数表明最大文件可能取决于您的内存。

# php - 在 PHPUnit 中测试表单输入

> ID：132342
> 
> 赞同：5
> 
> 时间：2008-09-25T09:37:54.493
> 
> 标签：php, unit-testing, phpunit

`$_GET`测试和`$_POST`输入的最佳方法是`PHPUnit`什么？

我有一个清理输入的类，并希望在处理虚假数据时检查它是否正常工作。有没有一种简单的方法来设置表单变量，`PHPUnit`或者我应该将验证传递给提供表单变量的辅助类/函数以便间接测试它们？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-25T22:57:41.917

看一下[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)的思想。简而言之，您应该为代码提供所需的内容，而不是获取所需的数据...这是一个示例：

没有依赖注入的例子

```
function sanitize1() {
  foreach($_POST as $k => $v) {
    // code to sanitize $v
  }
}

sanitize1(); 
```

依赖注入示例

```
function sanitize2(array &$formData) {
  foreach($formData as $k => $v) {
    // code to sanitize $v
  }
}

sanitize2($_POST); 
```

看到不同？在您的 PHPUnit 测试中，您可以传递`sanitize2()`您选择的关联数组；您已经注入了依赖项。而`sanitize1()`与`$_POST`. `$_POST`并且`$_GET`无论如何都是 assoc 数组，因此在您的生产代码中您可以传递`$_GET`或传递`$_POST`给您的函数，但在您的单元测试中，您会硬编码一些预期的数据。

单元测试示例：

```
function testSanitize() {
  $fakeFormData = array ('bio' => 'hi i\'m arin', 'location' => 'San Francisco');
  sanitize($fakeFormData);
  // assert something
} 
```

# java - Java中类的双重泛型约束：扩展ConcreteClass & I

> ID：132353
> 
> 赞同：12
> 
> 时间：2008-09-25T09:41:11.740
> 
> 标签：java, generics, constraints

有没有办法在 Java 中定义一个类似于以下 C# 泛型约束的泛型约束？

```
class Class1<I,T> where I : Interface1, Class2 : I 
```

我正在尝试这样做：

```
class Class1<I extends Interface1, T extends I & Class2> 
```

但是编译器抱怨“Class2”部分：类型参数不能跟随其他界限。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T10:02:09.583

这段代码在这里编译得很好：

```
interface Interface1 {}

class Class2 {}

class Class1<I extends Interface1, T extends Class2 & Interface1> {} 
```

当你只假设*Interface1*时，为什么你需要在那里输入*I*？（你在课堂上不会知道更多关于*I*的信息，而不是它扩展了*Interface1*）

 **** * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T12:32:18.067

我能看到的解析 Java 代码的最简单方法是使 Class2 成为接口。

您不能将类型参数限制为扩展多个类或类型参数。此外，您不能在此处使用 super 。

# c++ - 如何将文件内容读入 istringstream？

> ID：132358
> 
> 赞同：41
> 
> 时间：2008-09-25T09:42:11.720
> 
> 标签：c++, optimization, memory, stream, stringstream

为了提高从文件读取的性能，我试图将一个大（几 MB）文件的全部内容读入内存，然后使用 istringstream 访问信息。

我的问题是，读取这些信息并将其“导入”到字符串流中的最佳方式是什么？这种方法的一个问题（见下文）是，在创建字符串流时，缓冲区会被复制，内存使用量会加倍。

```
#include <fstream>
#include <sstream>

using namespace std;

int main() {
  ifstream is;
  is.open (sFilename.c_str(), ios::binary );

  // get length of file:
  is.seekg (0, std::ios::end);
  long length = is.tellg();
  is.seekg (0, std::ios::beg);

  // allocate memory:
  char *buffer = new char [length];

  // read data as a block:
  is.read (buffer,length);

  // create string stream of memory contents
  // NOTE: this ends up copying the buffer!!!
  istringstream iss( string( buffer ) );

  // delete temporary buffer
  delete [] buffer;

  // close filestream
  is.close();

  /* ==================================
   * Use iss to access data
   */

} 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-09-25T09:52:08.000

`std::ifstream`有一个方法`rdbuf()`，它返回一个指向 a 的指针`filebuf`。然后，您可以将其“推送”`filebuf`到您的`stringstream`：

```
#include <fstream>
#include <sstream>

int main()
{
    std::ifstream file( "myFile" );

    if ( file )
    {
        std::stringstream buffer;

        buffer << file.rdbuf();

        file.close();

        // operations on the buffer...
    }
} 
```

编辑：正如 Martin York 在评论中所说，这可能不是最快的解决方案，因为`stringstream`'s`operator<<`将逐个字符地读取 filebuf。您可能想检查他的答案，他像以前一样使用`ifstream`'`read`方法，然后将`stringstream`缓冲区设置为指向先前分配的内存。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2008-09-26T10:29:20.103

好的。我并不是说这会比从文件中读取更快

但这是一种创建缓冲区的方法，在将数据读入缓冲区后，直接将其用作字符串流的源。

**注意**值得一提的是 std::ifstream 是缓冲的。它以（相对较大的）块的形式从文件中读取数据。对缓冲区执行流操作，仅在需要更多数据时才返回文件进行另一次读取。因此，在将所有数据吸入内存之前，请确认这是一个瓶颈。

```
#include <fstream>
#include <sstream>
#include <vector>

int main()
{
    std::ifstream       file("Plop");
    if (file)
    {
        /*
         * Get the size of the file
         */
        file.seekg(0,std::ios::end);
        std::streampos          length = file.tellg();
        file.seekg(0,std::ios::beg);

        /*
         * Use a vector as the buffer.
         * It is exception safe and will be tidied up correctly.
         * This constructor creates a buffer of the correct length.
         *
         * Then read the whole file into the buffer.
         */
        std::vector<char>       buffer(length);
        file.read(&buffer[0],length);

        /*
         * Create your string stream.
         * Get the stringbuffer from the stream and set the vector as it source.
         */
        std::stringstream       localStream;
        localStream.rdbuf()->pubsetbuf(&buffer[0],length);

        /*
         * Note the buffer is NOT copied, if it goes out of scope
         * the stream will be reading from released memory.
         */
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T12:52:24.977

这对我来说似乎是过早的优化。处理过程中完成了多少工作。假设一个现代化的桌面/服务器，而不是嵌入式系统，在初始化期间复制几 MB 的数据相当便宜，尤其是与首先从磁盘读取文件相比。我会坚持你所拥有的，在系统完成时对其进行测量，并确定潜在的性能提升是否值得。当然，如果内存紧张，这是在一个内部循环中，或者是一个经常被调用的程序（比如每秒一次），这会改变平衡。

# performance - 谷歌怎么能这么快？

> ID：132359
> 
> 赞同：89
> 
> 时间：2008-09-25T09:42:55.387
> 
> 标签：performance, algorithm

使 Google 能够如此快速地提供查询服务的技术和编程决策是什么？

每次我搜索某些东西（每天几次）时，我总是惊讶于他们如何在接近或不到 1 秒的时间内提供结果。他们可以采用什么样的配置和算法来实现这一点？

**旁注：**这是一种压倒性的想法，即使我要放置一个桌面应用程序并在我的机器上使用它，也可能不会像谷歌那样快一半。我说继续学习。

* * *

以下是提供的一些很好的答案和建议：

*   [谷歌平台](http://en.wikipedia.org/wiki/Google_platform)
*   [地图缩减](http://labs.google.com/papers/mapreduce.html)
*   [精心设计的算法](http://research.google.com/pubs/papers.html)
*   硬件 - 集群农场和大量廉价计算机
*   缓存和负载平衡
*   [谷歌文件系统](http://research.google.com/archive/gfs-sosp2003.pdf)

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-09-25T10:09:41.157

延迟被磁盘访问杀死。因此，有理由相信用于回答查询的所有数据都保存在内存中。这意味着数千台服务器，每台服务器都复制许多分片中的一个。因此，搜索的关键路径不太可能触及他们的任何旗舰分布式系统技术 GFS、MapReduce 或 BigTable。这些将用于粗略地处理爬虫结果。

搜索的方便之处在于，不需要高度一致的结果或完全最新的数据，因此不会因为更新的搜索结果可用而阻止 Google 响应查询。

因此，一种可能的架构非常简单：前端服务器处理查询，对其进行规范化（可能通过去除停用词等），然后将其分发到拥有该部分查询空间的任何副本子集（另一种架构是将数据由网页上传，因此每次查询都需要联系每个副本集之一）。可能会查询很多很多副本，并且最快的响应获胜。每个副本都有一个索引映射查询（或单个查询术语）到文档，它们可以用来非常快速地在内存中查找结果。如果不同的结果来自不同的来源，前端服务器可以在输出 html 时对它们进行排名。

请注意，这可能与 Google 实际所做的有很大不同——他们将设计出这个系统的生命，因此在奇怪的区域可能会有更多的缓存、奇怪的索引和某种时髦的负载平衡方案以及其他可能的差异.

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-09-25T09:47:22.613

把它放在一个答案中有点太多了。 [http://en.wikipedia.org/wiki/Google_platform](http://en.wikipedia.org/wiki/Google_platform)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-09-25T14:14:29.680

我发现有趣的一个事实是，Google 实际上是由生物信息学运营的（'好吧，我觉得这很有趣，因为我是一个 bioinf...thingy）。让我解释。

早期的生物信息学面临着快速搜索巨大字符串中的小文本的挑战。对我们来说，“巨弦”当然是 DNA。通常不是单个 DNA，而是来自不同物种/个体的几个 DNA 的数据库。小文本是蛋白质或它们的基因对应物，一个基因。计算生物学家最初的大部分工作仅限于寻找基因之间的同源性。这样做是为了通过注意与已知基因的相似性来确定新发现基因的功能。

现在，这些 DNA 字符串确实变得非常大，并且（有损！）搜索必须非常有效地完成。因此，大多数现代字符串查找理论都是在计算生物学的背景下发展起来的。

然而，很久以前，传统的文本搜索已经用尽了。需要一种允许在亚线性时间内搜索大字符串的新方法，即无需查看每个单个字符。发现这可以通过预处理大字符串并在其上构建特殊的索引数据结构来解决。已经提出了许多不同的这种数据结构。每个都有自己的优点和缺点，但有一个特别值得注意，因为它允许在恒定时间内进行查找。现在，按照 Google 运营的数量级，这不再严格正确，因为必须考虑跨服务器的负载平衡、预处理和其他一些复杂的东西。

但本质上，所谓的*q-gram 索引*允许在恒定时间内进行查找。唯一的缺点：数据结构变得非常大。本质上，为了允许查找最多*q个字符的字符串（因此得名），它需要一个表，该表对于**q*个字母的每个可能组合都有一个字段（即*q* ^(*S*)，其中*S*是字母表的大小，比如 36 (= 26 + 10))。此外，被索引的字符串中的每个字母位置都必须有一个字段（或者在 google 的情况下，对于每个网站）。

为了减轻庞大的规模，谷歌可能会使用多个索引（事实上，他们*这样做*是为了提供拼写纠正等服务）。最上面的不适用于字符级别，而是在单词级别。这减少了*q*但它使*S*无限大，因此他们将不得不使用散列和冲突表来处理无限数量的不同单词。

在下一级，这些散列字将指向其他索引数据结构，而这些索引数据结构又将散列指向网站的字符。

长话短说，这些*q* -gram 索引数据结构可以说是 Google 搜索算法中最核心的部分。不幸的是，没有很好的非技术论文来解释*q* -gram 索引是如何工作的。我所知道的唯一一篇描述了这种索引如何工作的出版物是……唉，我的[学士论文](http://madrat.net/my/bachelor/thesis.pdf)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-06T10:44:22.013

以下是提供的一些很好的答案和建议：

*   [谷歌平台](http://en.wikipedia.org/wiki/Google_platform)
*   [地图缩减](http://labs.google.com/papers/mapreduce.html)
*   [精心设计的算法](http://research.google.com/pubs/papers.html)
*   硬件 - 集群农场和大量廉价计算机
*   缓存和负载平衡
*   [谷歌文件系统](http://research.google.com/archive/gfs-sosp2003.pdf)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-25T09:49:21.517

他们已经实现了在大量硬件上运行的良好的分布式算法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-25T09:53:27.590

最重要的延迟之一是网络服务器将您的查询发送到网络服务器，并返回响应。这种延迟受光速的限制，即使是谷歌也必须遵守。但是，他们在世界各地都有数据中心。结果，到其中任何一个的平均距离都较低。这可以降低延迟。当然，差异以毫秒为单位，但如果响应必须在 1000 毫秒内到达，这很重要。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-31T22:18:52.223

每个人都知道这是因为[他们使用鸽子](http://www.google.com/technology/pigeonrank.html)，当然！

哦，是的，还有 Mapreduce。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-25T09:49:45.417

他们几乎在自定义文件系统上的数千台 PC 上缓存了 Internet 的本地副本。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-25T09:50:31.140

谷歌聘用最优秀的人才。一些 IT 领域最聪明的人在谷歌工作。他们几乎有无限的钱可以投入到硬件和工程师身上。

他们对正在执行的任务使用高度优化的存储机制。

他们拥有地理位置优越的服务器场。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-31T18:58:07.930

一个通用列表的尝试（这不取决于您是否可以访问 Google 的内部工具）：

1.  **并行化**请求（例如，将单个请求分解为更小的集合）
2.  **异步**（尽可能地异步，例如不会阻塞用户的请求）
3.  **内存**/cache（磁盘I/O慢，尽量保留在内存中）
4.  **预计算**（事先做尽可能多的工作，不要等待用户要求数据/处理）
5.  关心你**的前端 HTML**（见 Yslow 和朋友）

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-25T09:51:14.820

你可以在[谷歌研究主页](http://research.google.com/pubs/papers.html)上找到一些关于一些谷歌人写的研究论文的指针。您应该从[google 文件系统](http://research.google.com/archive/gfs-sosp2003.pdf)和[map/reduce 算法](http://www.google.com/search?lr=&ie=UTF-8&oe=UTF-8&q=MapReduce%3A+Simplified+Data+Processing+on+Large+Clusters+Dean+Ghemawat)的解释开始，以尝试了解 google 页面背后发生了什么。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-02T19:52:27.040

这个链接它也非常有用 [谷歌查询的幕后花絮](http://blogoscoped.com/archive/2008-07-08-n70.html)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-25T09:44:34.697

硬件。

很多很多的硬件。他们使用大量的商用 PC 集群作为他们的服务器场。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-25T09:47:43.267

创伤小马是对的。用于负载平衡/缓存的大量服务器和智能架构，瞧，您可以在 1 秒内运行查询。网上有很多描述谷歌服务架构的文章。我相信你可以通过谷歌找到它们:)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-08T15:44:32.507

HenryR 可能是正确的。

Map Reduce 对搜索本身没有任何作用，仅用于索引。查看[此对 Map Reduce 发明者的视频采访](http://research.google.com/roundtable/MR.html)。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-11-26T18:29:42.757

另一个原因似乎是他们在 TCP 慢启动算法上作弊。

[http://blog.benstrong.com/2010/11/google-and-microsoft-cheat-on-slow.html](http://blog.benstrong.com/2010/11/google-and-microsoft-cheat-on-slow.html)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-25T09:48:24.467

以及可以利用硬件功能的[算法。](http://research.google.com/pubs/papers.html)比如[mapreduce](http://labs.google.com/papers/mapreduce.html)。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-25T09:50:25.930

[如果您对有关 google 集群如何工作的更多详细信息感兴趣，我会建议他们的HDFS](http://hadoop.apache.org/core/)的这个开源实现。

它基于谷歌的[Mapreduce](http://labs.google.com/papers/mapreduce.html)。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-25T16:57:55.200

1.  多级数据存储、处理和检索

2.  上述任务的高效分发（100 台机器中的 100 台）

3.  存储原始数据和处理结果的良好框架

4.  检索结果的好框架

您在问题摘要中的所有链接总结了所有这些是如何完成的

# .net - 反转正则表达式匹配

> ID：132367
> 
> 赞同：1
> 
> 时间：2008-09-25T09:46:28.077
> 
> 标签：.net, regex

我将如何反转 .NET 正则表达式匹配？我只想提取匹配的文本，例如我想从 HTML 文件中提取所有 IMG 标签，但只提取图像标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T09:48:53.687

这与反转正则表达式无关。只需搜索相关的文本并将其放在一个组中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T13:54:05.080

我和 David H. 在一起：反转意味着您*不*想要匹配项，而是匹配项周围的文本，在这种情况下，Regex 方法 Split() 将起作用。这就是我的意思：

```
static void Main(string[] args)
{
    Regex re = new Regex(@"\sthe\s", RegexOptions.IgnoreCase);

    string text = "this is the text that the regex will use to process the answer";

    MatchCollection matches = re.Matches(text);
    foreach(Match m in matches)
    {
        Console.Write(m);
        Console.Write("\t");
    }

    Console.WriteLine();

    string[] split = re.Split(text);
    foreach (string s in split)
    {
        Console.Write(s);
        Console.Write("\t");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T09:49:46.570

不明白你的意思。您是在谈论[捕获组](http://www.regular-expressions.info/brackets.html)吗？

# iis - 如何获得 SSL 负载平衡？

> ID：132383
> 
> 赞同：5
> 
> 时间：2008-09-25T09:49:47.477
> 
> 标签：iis, ssl, dns, load-balancing

我必须将我的 ASP.NET 应用程序部署到两个单独的 IIS 服务器中。我的应用程序通过 HTTPS/TLS 运行。我的 ASP 代码必须处理客户端 SSL 证书，这意味着我不能使用简单的正向负载均衡器，因为我永远不会从 nginx 或 Apache 负载均衡器获得这样的证书。

据我了解，在 Microsoft 世界中没有通用（开源或免费）的负载平衡解决方案，尤其是 SSL。

我听说过简单的 DNS 平衡，我的域名将绑定到多个 ISS 服务器，每个新客户端（会话）都会获得一个服务器的 IP，这样我就可以获得简单的平衡和 SSL 支持。

现在，我只是在乞求部署，知道你对这种平衡的看法真的很有趣，或者可能会得到一些建议。

谢谢！

* * *

至于我，除了 DNS 平衡之外，我找不到其他 HTTPS 解决方案。我只是别无选择。

？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-26T14:31:04.987

Windows NLB 绝对是您的解决方案 - 它位于每个 IIS 服务器的网络堆栈中，并在成员服务器之间分发 TCP 请求。NLB 与 SSL 流量一起使用，因为它通过 TCP 端口而不是流量的内容进行分发。

您需要在每台服务器上安装相同的 SSL 证书，但除此之外，配置很简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T13:08:50.290

我已经成功地在 Linux 上使用了[keepalived 。](http://www.keepalived.org/)这是一个简单的工具，可以管理[http://linuxvirtualserver.org](http://www.linuxvirtualserver.org)负载平衡器，您可以对负载平衡机器和多台服务器进行故障转移。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-04T19:13:26.880

Zen Load Balance 是一个免费的、非常简单的解决方案。[http://sourceforge.net/projects/zenloadbalancer/](http://sourceforge.net/projects/zenloadbalancer/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T09:53:57.700

基于 DNS 的负载平衡应该会让你走很长一段路。[单击此处](http://content.websitegear.com/article/load_balance_dns.htm)查看有关该主题的文章。有关 IIS/ASP 世界中负载平衡的概述，[请转到此处](http://www.microsoft.com/technet/archive/itsolutions/ecommerce/deploy/duwwsr.mspx?mfr=true)。

Windows 网络负载平衡可能是适合您的解决方案，[在这里您会找到](http://networkloadbalancing.blogspot.com/)很多关于它的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T09:56:00.270

我们使用[Cisco Local Director](http://en.wikipedia.org/wiki/Cisco_LocalDirector)，他们似乎处理得很好。

我没有使用纯软件解决方案进行负载平衡，但[平衡](http://sourceforge.net/projects/balance/)可能工作正常。我只将它用于纯粹的 1:1 端口转发。

与 DNS 平衡相比，使用平衡/LD 方法的优势在于，您可以轻松地使用它将服务器从池中取出（用于升级、部署、调试等）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T10:34:23.343

根据您的预算有多少，有很多解决方案。

您可以在 Windows Server 上使用 Windows 网络负载平衡，无需额外费用。设置起来相当简单，不会妨碍客户端证书。

# php - php - proc_open（或其他有效的函数）

> ID：132384
> 
> 赞同：0
> 
> 时间：2008-09-25T09:50:03.153
> 
> 标签：php, passwd, proc-open

我需要通过浏览器执行一些命令行。我需要在命令行中做的是：

```
$login
<login name>
<password>
$passwd
<old password>
<new password>
<retype new password> 
```

那么，我该如何使用该[`proc_open`](http://www.php.net/manual/en/function.proc-open.php)功能来做到这一点？或者我应该使用另一个功能来做到这一点？

* * *

亚当赖特，我试过你的例子，但我无法更改用户密码。我是否需要在脚本中做任何其他事情（除了定义 $user、$userPassword 和 $newPassword）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T12:19:50.343

[http://pecl.php.net/package/PAM](http://pecl.php.net/package/PAM)可能是您可以使用的东西。
它有一个功能`bool pam_chpass(string $username, string $oldpassword, string $newpassword [, string &$error ])`。
但我从未使用过它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T15:49:49.730

在互联网上使用 PHP 脚本找到了这个[更改 Linux 或 UNIX 系统密码。](http://www.cyberciti.biz/tips/change-linux-or-unix-system-password-using-php-script.html)

关于如何创建一个用户可以更改自己的系统密码的网站的非常详细的描述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T11:52:25.607

您不需要发出登录来更改用户的密码，只需将他们的名字提供给 passwd。使用 popen （因为我们不需要在这个小例子中阅读），比如

```
$pp = popen("passwd ${user}", "w");
fwrite($pp, $oldPassword . '\n');
fwrite($pp, $newPassword . '\n');
fwrite($pp, $newPassword . '\n');
pclose($pp); 
```

如果您想阅读响应，请使用 proc_open，然后从您提供的标准输出句柄中读取。

我希望这一切都得到了很好的保护，并且您对用户名进行了*很多*清理。

# debugging - 在 SQLAnalyzer 中传递时间戳参数以调试存储过程

> ID：132390
> 
> 赞同：0
> 
> 时间：2008-09-25T09:50:58.923
> 
> 标签：debugging, sql-server-2000

您好我正在尝试通过 SQL Analyzer 调试存储过程，其中一个参数是时间戳数据类型。如果我想将 0x00000001410039E2 作为参数传递，我该怎么做？当我通过 0x00000001410039E2 时，我得到一个字符串截断错误，当我只通过 1410039E2 时，我得到 0x1410039E20000000？

编辑：@Frans 是的，这是可行的，但我的问题是，在 SQLAnalyzer 中，当我在值文本框中输入值时右键单击并调试时，我收到错误消息：

```
[Microsoft][ODBC SQL Server Driver]String data, right truncation 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T11:14:52.717

调试输入屏幕要求您输入十六进制值。您不必在该值前面输入 0x。

只需输入 00000001410039E2 即可。

# lua - 在 Lua 中取回 os.execute 的输出

> ID：132397
> 
> 赞同：50
> 
> 时间：2008-09-25T09:53:27.233
> 
> 标签：lua

当我在 Lua 中执行“os.execute”时，控制台会快速弹出，执行命令，然后关闭。但是有没有办法只使用标准 Lua 库来取回控制台输出？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-11-28T21:19:22.327

如果你有 io.popen，那么这就是我使用的：

```
函数 os.capture(cmd, raw)
  本地 f = 断言（io.popen（cmd，'r'））
  本地 s = assert(f:read('*a'))
  f:关闭（）
  如果原始则返回 s 结束
  s = string.gsub(s, '^%s+', '')
  s = string.gsub(s, '%s+$', '')
  s = string.gsub(s, '[\n\r]+', ' ')
  返回
结尾

```

如果您没有 io.popen，那么您的系统上可能没有 popen(3)，并且您处于深酸奶中。但是所有的 unix/mac/windows Lua 端口都会有 io.popen。

（`gsub`业务去掉前导和尾随空格并将换行符转换为空格，这大致是 shell 对其`$(...)`语法所做的。）

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-27T08:56:01.633

我想你想要这个[http://pgl.yoyo.org/luai/i/io.popen](http://pgl.yoyo.org/luai/i/io.popen) io.popen。但它并不总是被编译进去。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T10:11:05.397

我不具体了解 Lua，但您通常可以运行以下命令：

```
comd >comd.txt 2>&1 
```

将输出和错误捕获到文件 comd.txt，然后使用语言文件 I/O 函数将其读入。

如果语言本身不提供捕获标准输出和错误，我会这样做。

# regex - RegexBuddy 的免费替代品

> ID：132405
> 
> 赞同：40
> 
> 时间：2008-09-25T09:55:13.500
> 
> 标签：regex

是否有任何好的替代方案可以支持以不同风格编写正则表达式并允许您对其进行测试？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-09-25T12:27:38.827

以下是线程中提到的 Regex 工具的列表：

[调节器](http://sourceforge.net/projects/regulator/)

[快递](http://www.ultrapico.com/Expresso.htm)

[.NET 正则表达式设计器](http://www.netregex.com/)

[正则表达式教练](http://www.weitz.de/regex-coach/)

[larsolavtorvik 在线工具](http://regex.larsolavtorvik.com/)

[正则表达式伙伴](http://regexpal.com/)

[正则表达式工作台](http://blogs.msdn.com/ericgu/archive/2003/07/07/52362.aspx)

[红色的](http://www.rubular.com/)

[雷吉](https://github.com/samsouder/reggy/)

[正则表达式](http://gskinner.com/RegExr/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-25T13:33:06.410

优秀且免费的[Rad Software 正则表达式设计](http://www.radsoftware.com.au/regexdesigner/)器没有出现在上面的列表中，但它当然值得一看。

对不同“风格”的支持是有限的，但就编写和测试实际的正则表达式而言，它很好，内置帮助也非常有用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-29T21:29:44.147

Expresso 在我的名单上名列前茅。

# java - Oracle 10g Web 应用程序中的 JAXB 2

> ID：132409
> 
> 赞同：3
> 
> 时间：2008-09-25T09:56:01.313
> 
> 标签：java, oracle, oracle10g, jaxb, classpath

我有一个使用[JAXB 2](https://javaee.github.io/jaxb-v2/)的 Web 应用程序。在[Oracle 10g 应用服务器](https://www.oracle.com/technetwork/middleware/ias/overview/index.html)上部署时，我一尝试编组 XML 文件就会出错。事实证明，Oracle 将[JAXB 1](https://github.com/javaee/jaxb-v1)包含在一个偷偷改名为“xml.jar”的 jar 中。

如何强制我的 webapp 使用我部署的 jaxb jar 的版本，`WEB-INF/lib`而不是 Oracle 强制进入类路径的版本，最好是通过配置而不是在我的代码中弄乱类加载器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T10:05:53.287

我假设您使用以前的 BEA Weblogic Server？

您可以将 weblogic.xml 文件添加到您的 WEB-INF，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE weblogic-web-app PUBLIC "-//BEA Systems, Inc.//DTD Web Application 8.1//EN" "http://www.bea.com/servers/wls810/dtd/weblogic810-web-jar.dtd">
<weblogic-web-app>
    <container-descriptor>
   <prefer-web-inf-classes>true</prefer-web-inf-classes>
    </container-descriptor>
</weblogic-web-app> 
```

（在回复评论时，我还没有足够的声誉:-)）

确实，DLL 地狱，因为它是“全有或全无”。似乎还有另一种更有条件的方式，描述为[here](http://forums.bea.com/thread.jspa?threadID=300003449)。虽然我自己没有试过那个...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T20:55:29.013

如果您仍在使用 Oracle 的 OC4J，则将他们的 orion-application.xml 包含在您的 EAR 的 META-INF 中。它应该看起来像......

```
<?xml version="1.0" encoding="UTF-8"?>
<orion-application>
    <imported-shared-libraries>
        <remove-inherited name="skip.this.package"/>
    </imported-shared-libraries>
</orion-application> 
```

...您要跳过的包裹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T09:58:52.993

使用与您的 Oracle 实例不同的 JVM，并确保它们的库不在您的类路径中。

# java - 将算法 C 转换为 Python

> ID：132411
> 
> 赞同：9
> 
> 时间：2008-09-25T09:56:43.433
> 
> 标签：java, python, c, sandbox, code-translation

我想将一些 C 代码翻译成 Python 代码或字节码。有问题的 C 代码是我所说的纯算法代码：独立于平台，没有 I/O，只有算法和内存中的数据结构。

一个例子是正则表达式库。翻译工具将处理库源代码并生成可在**沙盒**环境中运行的功能等效的 Python 模块。

您可以推荐哪些具体的方法、工具和技术？

* * *

*注意：Python C 扩展或 ctypes**不是一个选项**，因为环境是沙盒的。*

*另一个注意事项*：看起来有一个[C-to-Java-bytecode 编译器](http://www.axiomsol.com/)，他们甚至将 libjpeg 编译为 Java。Java 字节码+VM 与 CPython 字节码+VM 的区别太大了吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-25T10:12:54.317

坦率地说，在不遭受疯狂的性能损失的情况下，没有办法机械地和有意义地将 C 转换为 Python。众所周知，Python 的速度远不及 C 的速度（使用当前的编译器和解释器），但更糟糕的是 C 擅长的东西（位摆弄、整数数学、内存块的技巧） Python 的速度非常慢，而Python擅长的东西你不能直接用C来表达。因此，直接翻译效率会特别低，甚至到了荒谬的地步。

一般来说，更好的方法确实是将 C 保留为 C，并将其包装在 Python 扩展模块中（使用[SWIG](http://www.swig.org)、[Pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)、[Cython](http://cython.org)或[手动编写包装器）或使用](http://docs.python.org/ext)[ctypes](http://docs.python.org/lib/module-ctypes.html)直接调用 C 库。C 的所有优点（和缺点）对于已经是 C 或您以后添加的内容，以及 Python 的所有便利（和缺点）对于 Python 中的任何代码。

这不能满足您的“沙盒”需求，但您应该意识到无论如何您都不能特别好地对 Python 进行沙盒；这需要大量的努力和 CPython 的修改，如果你忘记了某个地方的一个小洞，你的监狱就会被打破。如果你想对 Python 进行沙盒化，你应该首先对整个过程进行沙盒化，然后 C 扩展也可以被沙盒化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-07-28T11:09:45.267

使用 indent(1) 和 ctopy(1)... 在 pypy 上获得额外的信用测试速度... 对于奖励信用使用 pyastra 生成汇编代码。

无论使用哪种语言，您都必须牺牲在运行时空间 (CPU) 或内存空间 (RAM) 之间存储各种构造和函数的输出。

如果你想看看我在说什么，请查看伟大的语言枪战

这是一个例子，想使用浮点数学而不使用浮点数？

```
x * 1,000,000 = a
y * 1,000,000 = b
a {function} b = result
result / 1,000,000 = z 
```

不要陷入困境，变得原始，如果必须的话，使用穴居人数学。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T10:25:45.470

最快的方法（就程序员的努力，而不是效率而言）可能涉及使用现有的编译器将 C 编译为简单的东西（例如 LLVM），并且：

*   在 Python 中解释（过高的性能损失）
*   将其转换为 Python（巨大的性能损失）
*   将其转换为 Python 字节码（很大的性能损失）

直接将 C 转换为 Python 是可能的（并且可能产生比上述方法更快的代码），但您实际上是在编写 C 编译器后端，这是一项艰巨的任务。

编辑，事后诸葛亮：一种可能更加快速和肮脏的方法是获取 C 代码的解析树，将其转换为 Python 数据结构并在 Python 中解释它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T17:51:26.330

用纯 Python 写一个 C 解释器？;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T20:29:33.023

我会亲自使用一个工具从 C 代码中提取一个 uml sheme，然后用它来生成 python 代码。

从这个问题开始，我开始摆脱不必要的 C 风格结构，然后用 python 代码填充这些方法。

我认为这将是更安全、最有效的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T10:00:14.003

为什么不保留 C 代码并[创建一个](http://www.python.org/doc/ext/intro.html)可以导入到正在运行的 Python 环境中的 Python C 模块？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T10:07:47.620

首先，我会考虑用 Pythonic 的优点包装现有的 C 库，以提供 Python 模块形式的 API。我会看看 swig、ctypes、pyrex 以及这些天里的其他任何东西。C 库本身将保持不变。节省工作。

但是，如果我真的必须编写基于 C 的原始 Python 代码，我不会使用任何工具，只有我的大脑。C 允许太多有趣的指针技巧、宏聪明的东西等等，即使有人向我指出了一个自动化工具，我也永远不会相信。

我提到了 Pyrex——这是一种类似于 C 语言但也面向 Python 的语言。我没有做太多，但它可能比编写纯 python 更容易，因为你是以 C 作为指南开始的。

从 IDL（科学家喜欢使用的数据语言，而不是其他 IDL）等更受限制、更驯服的语言转换是很困难的，需要手动和脑力劳动。C？忘了它吧，直到 UFO 人给我们他们花哨的软件工具，这些工具比我们最先进的技术领先一千年！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T10:16:49.487

任何自动翻译都会因为不使用 Python 的强大功能而受到影响。如果直接翻译成 Python，C 类型的程序代码运行速度会非常慢，您需要使用更多 Python 优化代码来分析和替换整个部分。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-25T18:52:54.737

您始终可以编译 C 代码，并在 python 中使用 ctypes 加载库。

# java - 用于根据 NMTOKEN 验证字符串的 Java 实用程序

> ID：132432
> 
> 赞同：1
> 
> 时间：2008-09-25T10:05:23.553
> 
> 标签：java, xml, utilities

我有一些生成 XML 文档的应用程序代码，然后根据 XML 模式对其进行验证。该模式使用 NMTOKEN 类型，有时生成的 XML 包含非法 NMTOKEN 的字符串值（例如，它们包含空格或奇怪的标点符号）。当然，Xerces 模式验证可以捕获它，但我想在我自己的代码中更早地捕获它，并更优雅地处理它。

我打算编写自己的 isValidNMTOKEN 方法，并根据模式规范检查每个字符是否有效，但我希望有一个现有的实用程序可以为我做这件事。

有点像 XML 的 commons-lang。遗憾的是，xml.apache.org/commons 中没有任何用处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T14:37:28.423

来自 Aachie Axis（Web 服务框架）的 org.apache.axis.types.NMToken 具有静态 isValid(String) 方法，可能是您需要的（或者可能超出您的需要）。

[Axis API 中的 NMToken](http://ws.apache.org/axis/java/apiDocs/org/apache/axis/types/NMToken.html)

# asp.net - 如何从 ASP.NET 中的会话 id 获取用户信息？

> ID：132437
> 
> 赞同：2
> 
> 时间：2008-09-25T10:07:34.407
> 
> 标签：asp.net, session-state, single-sign-on

在 asp.net 应用程序中，我想使用 web 服务返回与作为参数传递的会话 id 关联的用户名。我们目前正在使用 InProc 会话存储。

是否有可能做到这一点 ？

编辑：我想要做的是获取关于另一个会话而不是当前会话的信息。我不是想得到 SessionID，我已经得到了。我正在尝试获取与给定 SessionID**关联的用户信息。**

谢谢，

马修·G。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-25T11:52:06.120

您可能会使用会话 ID 创建一个“假”cookie，并使用它向您的 Web 服务发出请求，这样 Web 服务就会误以为您是会话的一部分，从而使您能够从中读取任何信息。听起来很像黑客，虽然:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T11:53:53.730

就像是：

```
HttpSessionState ss = HttpContext.Current.Session;
HttpContext.Current.Response.Write(ss.SessionID); 
```

这将获得当前的 sessionID。

# java - Java 是移动应用开发的最佳语言吗？

> ID：132440
> 
> 赞同：2
> 
> 时间：2008-09-25T10:08:14.840
> 
> 标签：java, mobile

我想知道使用除 Java 之外的其他任何东西进行移动应用程序开发有什么好处。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T10:12:43.537

我确实认为是的，Java 是最常用的设备语言，但有两个例外：

*   Windows 移动应用程序，通常使用 C++ 构建，但未来将更多地构建在 .NET 框架上。

*   iPhone 应用程序，使用 Cocoa 和 Objective-C。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T10:10:30.733

Java 是最普遍的，仅此一点，它就是您的最佳选择。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T10:16:29.783

您必须使用您打算支持的电话供应商将提供的任何内容。由于大多数提供 Java，但只有一些提供其他东西，如果您想支持一系列手机，您可能需要至少在其中一些手机上使用 Java。

您的客户（无论是内部客户还是外部客户）将需要决定支持哪些手机，然后您需要根据支持的手机做出决定。

您必须以不同的编程语言发布版本并非完全不可能，这可能会使代码重用更具“挑战性”。这一切都取决于您的要求。这个网站上没有人能告诉你他们是什么:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T11:07:43.530

这真的取决于你想要做什么。

Java虽然无处不在，但确实存在速度劣势。此外，它不像在桌面空间中那样“编写一次，随处运行”，因为不同的制造商，甚至不同的设备都安装了不同的 java 子集，每个子​​集都包含不同的 API。

使用本机代码将更有效，但更难移植。它提供了设备功能的更直接表示，而无需虚拟机 API 的沙盒。

或者，您可以使用像 C 这样的语言，它虽然不是严格可移植的，但可以在许多设备上实现，只需稍作调整，同时保留这种语言的许多速度优势。（S60/Symbian 上的 OpenC）、Palm 上的 C 等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T13:50:46.537

这取决于您对移动领域的未来的看法。如果 iPhone 和 iPod 一样流行，那么不，Java 可能不是最佳选择。

需要考虑的一件事是，在某些时候可能不再有 iPod Nano 这样的东西，也许 Touch 将是唯一可用的 iPod。在这种情况下，每一个 iPod 都将支持 Apple 的 iPhone OS，而 iPhone OS 移动设备的数量将远远超过 Java。

五年后，也许“Cocoa vs. Android”将是新的 Mac vs. PC。在这种情况下，Java 可能和 Cocoa 一样好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T10:13:17.917

我能想到的唯一原因是您不需要目标设备上的 Java 运行时。

例如，Palm 允许您使用 C 编写代码并直接与 ROM 中的操作系统例程对话。C 代码无需运行时直接编译为机器语言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T14:13:01.727

在为这样一个微不足道的问题提供推测性答案之前，还需要回答其他变量。想要开发什么样的电话应用程序。例如，您可以将 xhtml 用于不需要连接到手机核心功能的东西。当您需要连接到手机软件或硬件时，您可以使用 java、python、c++、windows mobile 或块 android 上的新手。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-08T19:15:06.573

如果你想支持多部手机，Java 是最好的，但是 J2ME 是一个有限的环境。如果您正在进行自制开发，那么就为您自己的手机使用的任何东西进行开发，对于商业开发，Java 是最普遍的（并且有些公司可以将 Java 移植到其他平台）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-11-01T17:52:13.883

使用本机代码的优点之一是您更接近硬件，在手机上，这意味着您可能能够利用未暴露给运行 Java 应用程序的虚拟机的功能，承诺与典型的 Java Mobile 实现相比，Android 的一切都更加暴露

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-21T03:40:21.840

最好是去诺基亚、苹果微软或谷歌网站或whaterver，看看有哪些开发者工具和资源可用，然后选择你想为他们开发的工具和资源非常好，因为优秀的移动应用程序开发者可以帮助增加他们的市场份额.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-10-21T04:03:07.793

取决于您要编写的应用程序。

如果它是一个简单的服务/数据提供者，我会通过 jqTouch、jQuery Mobile 或[http://www.sencha.com/](http://www.sencha.com/)等框架使用 HTML 和 CSS， 因为它们将在大多数智能手机上运行，​​您可以将它们打包成二进制应用程序使用类似[http://www.phonegap.com/](http://www.phonegap.com/) 这将允许使用 HTML5 进行滑动、GPS、本地文件存储

如果您需要数据库、运动感应、蓝牙、游戏类型的应用程序，那么您可以查看 [http://monotouch.net/](http://monotouch.net/) http://monodroid.net/

这使您可以编写 c# .net 代码并部署到任何平台上，您应该涵盖 windows mobile、android 和 iPhone。

还有[http://rhomobile.com/](http://rhomobile.com/) 允许您使用 Ruby 为所有移动平台编写应用程序。

# java - 由于 MS SQL 中 UNIQUE 约束的非标准行为，Spring/Hibernate 的解决方法

> ID：132444
> 
> 赞同：3
> 
> 时间：2008-09-25T10:09:15.073
> 
> 标签：java, sql-server, hibernate, spring

索引上有一个 UNIQUE 数据库约束，它不允许多个记录具有相同的列。

有一段代码，由 Hibernate (v2.1.8) 管理，执行两次 DAO
`getHibernateTemplate().save( theObject )`
调用，结果将两条记录输入到上面提到的表中。

如果此代码在没有事务的情况下执行，则会产生 INSERT、UPDATE，然后是另一个 INSERT 和另一个 UPDATE SQL 语句，并且工作正常。显然，顺序是先插入包含 DB NULL 的记录，然后用适当的数据更新它。

如果此代码在包装在单个 Spring 事务中的 Spring (v2.0.5) 下执行，则会导致两个 INSERTS，然后由于上述 UNIQUE 约束而立即出现异常。

由于与 ANSI SQL 不兼容，此问题仅在[MS SQL](http://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=299229)上表现出来。它在 MySQL 和 Oracle 上运行良好。不幸的是，我们的解决方案是跨平台的，必须支持所有数据库。

拥有这些技术堆栈，对于给定问题，您首选的解决方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-28T12:22:53.983

您可以尝试在两次保存之间刷新休眠会话。这可能会强制 Hibernate 在第二次插入之前执行第一次更新。

另外，当你说hibernate用插入插入NULL时，你的意思是每一列都是NULL，还是只是ID列？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-26T07:53:15.187

I have no experience in Hibernate, so I don't know if you are free to change the DB at your will or if Hibernate requires a specific DB structure you cannot change.

If you can make changes then you can use this workaround in MSSQL tu emulate the ANSI behaviour :

drop the unique index/constraint

define a calc field like this:

```
alter table MyTable Add MyCalcField as 
case when MyUniqueField is NULL 
      then cast(Myprimarykey as MyUniqueFieldType) 
      else MyUniqueField end 
```

add the unique constraint on this new field you created.

Naturally this applies if MyUniqueField is not the primary key! :)

You can find more details in [this article at databasejournal.com](http://www.databasejournal.com/features/mssql/article.php/3711501)

# c# - 直接铸造与'as'运营商？

> ID：132445
> 
> 赞同：806
> 
> 时间：2008-09-25T10:09:18.537
> 
> 标签：c#, casting

考虑以下代码：

```
void Handler(object o, EventArgs e)
{
   // I swear o is a string
   string s = (string)o; // 1
   //-OR-
   string s = o as string; // 2
   // -OR-
   string s = o.ToString(); // 3
} 
```

这三种类型的施法有什么区别（好吧，第三种不是施法，但你明白了）。应该首选哪一个？

* * *

## 回答 #1

> 赞同：932
> 
> 时间：2008-09-25T10:16:26.240

```
string s = (string)o; // 1 
```

如果不是. 则抛出[InvalidCastException](https://msdn.microsoft.com/en-us/library/system.invalidcastexception)。否则，分配给，即使是。`o``string``o``s``o``null`

```
string s = o as string; // 2 
```

分配`null`给`s`if `o`is not a`string`或 if `o`is `null`。因此，您不能将它与值类型一起使用（`null`在这种情况下，运算符永远不会返回）。否则，分配`o`给`s`。

```
string s = o.ToString(); // 3 
```

如果是 则导致[NullReferenceException](https://msdn.microsoft.com/en-us/library/system.nullreferenceexception)。将返回的任何内容分配给，无论是什么类型。`o``null``o.ToString()``s``o`

* * *

大多数转换使用 1 - 它简单明了。我几乎从不使用 2 ，因为如果某些类型不正确，我通常希望会发生异常。我只看到使用错误代码（例如返回 null = 错误，而不是使用异常）的糟糕设计的库需要这种返回空类型的功能。

3 不是强制转换，只是一个方法调用。当您需要非字符串对象的字符串表示时使用它。

* * *

## 回答 #2

> 赞同：396
> 
> 时间：2008-09-25T10:31:28.453

1.  `string s = (string)o;`当某件事 *绝对*应该是另一件事时使用。
2.  `string s = o as string;`当某事*可能是*另一件事时使用。
3.  `string s = o.ToString();`当您不关心它是什么但只想使用可用的字符串表示时使用。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-09-25T10:16:50.593

这实际上取决于您是否知道是否`o`是一个字符串以及您想用它做什么。如果您的评论意味着这`o`确实是一个字符串，我更喜欢直接`(string)o`演员 - 它不太可能失败。

使用直接转换的最大优点是，当它失败时，你会得到一个[InvalidCastException](http://msdn.microsoft.com/en-us/library/system.invalidcastexception.aspx)，它几乎可以告诉你出了什么问题。

使用`as`运算符，如果`o`不是字符串，`s`则设置为`null`，如果您不确定并想要测试，这很方便`s`：

```
string s = o as string;
if ( s == null )
{
    // well that's not good!
    gotoPlanB();
} 
```

但是，如果您不执行该测试，您将在稍后使用`s`并引发[NullReferenceException 。](http://msdn.microsoft.com/en-us/library/system.nullreferencetexception.aspx)一旦它们发生在野外，这些往往更常见，也*更难*追踪，因为几乎每一行都会取消引用一个变量并可能抛出一个变量。另一方面，如果您尝试转换为值类型（任何原语，或诸如[DateTime](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)之类的结构），则必须使用直接转换 - 这`as`不起作用。

在转换为字符串的特殊情况下，每个对象都有一个，因此如果不为 null 并且您认为该方法可能会执行您想要的操作`ToString`，则您的第三个方法可能没问题。`o``ToString`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-25T10:41:43.170

如果您已经知道它可以转换为什么类型，请使用 C 样式转换：

```
var o = (string) iKnowThisIsAString; 
```

请注意，只有使用 C 风格的强制转换才能执行显式类型强制。

如果您不知道它是否是所需的类型，并且如果是，您将使用它，请使用*as*关键字：

```
var s = o as string;
if (s != null) return s.Replace("_","-");

//or for early return:
if (s==null) return; 
```

注意**as**不会调用任何类型转换操作符。仅当对象不为 null 并且本机为指定类型时，它才会为非 null。

使用 ToString() 获取任何对象的人类可读的字符串表示，即使它不能转换为字符串。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-25T11:17:27.030

当您使用 FindControl 方法时， as 关键字在 asp.net 中很好用。

```
Hyperlink link = this.FindControl("linkid") as Hyperlink;
if (link != null)
{
     ...
} 
```

这意味着您可以对类型化变量进行操作，而不必`object`像使用直接强制转换一样对其进行强制转换：

```
object linkObj = this.FindControl("linkid");
if (link != null)
{
     Hyperlink link = (Hyperlink)linkObj;
} 
```

这不是一件大事，但它节省了代码行和变量赋值，而且它更具可读性

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-25T10:15:32.670

'as' 基于 'is'，它是一个关键字，在运行时检查对象是否是多态兼容的（基本上是否可以进行强制转换），如果检查失败则返回 null。

这两个是等价的：

使用“作为”：

```
string s = o as string; 
```

使用“是”：

```
if(o is string) 
    s = o;
else
    s = null; 
```

相反，c 风格的转换也在运行时进行，但如果不能进行转换，则会引发异常。

只是补充一个重要的事实：

'as' 关键字仅适用于引用类型。你不能这样做：

```
// I swear i is an int
int number = i as int; 
```

在这些情况下，您必须使用强制转换。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-08-15T18:36:54.803

根据在此页面上运行的实验：http: [//www.dotnetguru2.org/sebastienros/index.php/2006/02/24/cast_vs_as](http://www.dotnetguru2.org/sebastienros/index.php/2006/02/24/cast_vs_as)

（此页面有时会出现一些“非法引荐来源”错误，因此请刷新）

结论是，“as”运算符通常比强制转换更快。有时快很多倍，有时只是快一点。

我个人认为“as”也更具可读性。

因此，由于它更快且“更安全”（不会抛出异常），并且可能更易于阅读，我建议始终使用“as”。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-25T10:31:39.170

2 对于转换为派生类型很有用。

假设**a**是动物：

```
b = a as Badger;
c = a as Cow;

if (b != null)
   b.EatSnails();
else if (c != null)
   c.EatGrass(); 
```

将获得**最少**的演员阵容。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-25T10:17:50.810

"(string)o" 将导致 InvalidCastException，因为没有直接强制转换。

"o as string" 将导致 s 成为空引用，而不是引发异常。

“o.ToString()” 本身不是任何类型的转换，它是一种由对象实现的方法，因此以一种或另一种方式，由 .net 中的每个类对实例“做某事”调用它的类并返回一个字符串。

不要忘记，为了转换为字符串，还有 Convert.ToString(someType instanceOfThatType) 其中 someType 是一组类型之一，本质上是框架的基本类型。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-09-25T04:47:48.387

看来他们两个在概念上是不同的。

**直接铸造**

类型不必严格相关。它有各种口味。

*   **自定义隐式/显式转换：**通常会创建一个新对象。
*   **值类型隐式：**复制而不丢失信息。
*   **值类型显式：**副本和信息可能会丢失。
*   **IS-A 关系：**改变引用类型，否则抛出异常。
*   **相同类型：** “铸造是多余的”。

感觉就像该对象将被转换为其他东西一样。

**AS 运算符**

类型有直接关系。如：

*   引用类型：**IS-A 关系**对象始终相同，只是引用发生了变化。
*   值类型：**复制**装箱和可为空的类型。

感觉就像您将以不同的方式处理对象。

**样品和 IL**

```
 class TypeA
    {
        public int value;
    }

    class TypeB
    {
        public int number;

        public static explicit operator TypeB(TypeA v)
        {
            return new TypeB() { number = v.value };
        }
    }

    class TypeC : TypeB { }
    interface IFoo { }
    class TypeD : TypeA, IFoo { }

    void Run()
    {
        TypeA customTypeA = new TypeD() { value = 10 };
        long longValue = long.MaxValue;
        int intValue = int.MaxValue;

        // Casting 
        TypeB typeB = (TypeB)customTypeA; // custom explicit casting -- IL:  call class ConsoleApp1.Program/TypeB ConsoleApp1.Program/TypeB::op_Explicit(class ConsoleApp1.Program/TypeA)
        IFoo foo = (IFoo)customTypeA; // is-a reference -- IL: castclass  ConsoleApp1.Program/IFoo

        int loseValue = (int)longValue; // explicit -- IL: conv.i4
        long dontLose = intValue; // implict -- IL: conv.i8

        // AS 
        int? wraps = intValue as int?; // nullable wrapper -- IL:  call instance void valuetype [System.Runtime]System.Nullable`1<int32>::.ctor(!0)
        object o1 = intValue as object; // box -- IL: box [System.Runtime]System.Int32
        TypeD d1 = customTypeA as TypeD; // reference conversion -- IL: isinst ConsoleApp1.Program/TypeD
        IFoo f1 = customTypeA as IFoo; // reference conversion -- IL: isinst ConsoleApp1.Program/IFoo

        //TypeC d = customTypeA as TypeC; // wouldn't compile
    } 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-25T11:05:43.113

```
string s = o as string; // 2 
```

是首选，因为它避免了双重转换的性能损失。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-04-03T14:28:13.900

如果我可以添加一些东西，所有给出的答案都很好：要直接使用字符串的方法和属性（例如 ToLower），您不能编写：

```
(string)o.ToLower(); // won't compile 
```

你只能写：

```
((string)o).ToLower(); 
```

但你可以改写：

```
(o as string).ToLower(); 
```

该`as`选项更具可读性（至少在我看来）。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-10-17T12:11:02.687

我想提请注意*as*运算符的以下细节：

[https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/as](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/as)

> 请注意，as 运算符仅执行引用转换、可为空的转换和装箱转换。as 运算符不能执行其他转换，例如用户定义的转换，而应使用强制转换表达式来执行。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-08-03T07:34:30.523

`string s = (string) o;`如果在您的应用程序的逻辑上下文中`string`是唯一有效的类型，请使用直接强制转换。通过这种方法，您将获得`InvalidCastException`并实现[快速失败](https://en.wikipedia.org/wiki/Fail-fast)的原则。如果使用运算符，您的逻辑将受到保护，不会进一步传递无效类型或获取 NullReferenceException `as`。

如果逻辑需要几种不同的类型转换`string s = o as string;`并检查它`null`或使用`is`运算符。

C# 7.0 中出现了新的很酷的功能，以简化强制转换并检查[模式匹配](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-7#pattern-matching)：

```
if(o is string s)
{
  // Use string variable s
}

or

switch (o)
{
  case int i:
     // Use int variable i
     break;
  case string s:
     // Use string variable s
     break;
 } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-06-23T01:31:48.503

当试图获取可能为空的任何（任何类型）的字符串表示时，我更喜欢下面的代码行。它很紧凑，它调用 ToString()，并正确处理空值。如果 o 为 null，s 将包含 String.Empty。

```
String s = String.Concat(o); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-10-13T20:21:25.407

由于没有人提到它，因此最接近 Java 的 instanceOf 关键字是：

```
obj.GetType().IsInstanceOfType(otherObj) 
```

# ruby-on-rails - TestMailer 参数错误数量错误

> ID：132449
> 
> 赞同：2
> 
> 时间：2008-09-25T10:10:05.070
> 
> 标签：ruby-on-rails, ruby, ar-mailer

我在发送电子邮件时遇到了一个奇怪的问题。我得到了这个例外：

```
ArgumentError (wrong number of arguments (1 for 0)):
/usr/lib/ruby/gems/1.8/gems/activerecord-2.1.1/lib/active_record/base.rb:642:in `initialize'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.1.1/lib/active_record/base.rb:642:in `new'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.1.1/lib/active_record/base.rb:642:in `create'
/usr/lib/ruby/gems/1.8/gems/ar_mailer-1.3.1/lib/action_mailer/ar_mailer.rb:92:in `perform_delivery_activerecord'
/usr/lib/ruby/gems/1.8/gems/ar_mailer-1.3.1/lib/action_mailer/ar_mailer.rb:91:in `each'
/usr/lib/ruby/gems/1.8/gems/ar_mailer-1.3.1/lib/action_mailer/ar_mailer.rb:91:in `perform_delivery_activerecord'
/usr/lib/ruby/gems/1.8/gems/actionmailer-2.1.1/lib/action_mailer/base.rb:508:in `__send__'
/usr/lib/ruby/gems/1.8/gems/actionmailer-2.1.1/lib/action_mailer/base.rb:508:in `deliver!'
/usr/lib/ruby/gems/1.8/gems/actionmailer-2.1.1/lib/action_mailer/base.rb:383:in `method_missing'
/app/controllers/web_reservations_controller.rb:29:in `test_email' 
```

在我的 web_reservations_controller 我有一个简单的方法调用

```
TestMailer.deliver_send_email 
```

我的 TesMailer 是这样的：

```
class TestMailer < ActionMailer::ARMailer
  def send_email
    @recipients = "xxx@example.com"
    @from = "xxx@example.com"
    @subject = "TEST MAIL SUBJECT"
    @body = "<br>TEST MAIL MESSAGE"
    @content_type = "text/html"
  end
end 
```

你有什么主意吗？

谢谢！罗伯托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-26T07:09:25.807

问题在于 ar_mailer 用于存储消息的模型。您可以在回溯中看到异常来自 ActiveRecord::Base.create 调用初始化时。通常，ActiveRecord 构造函数需要一个参数，但在这种情况下，您的模型似乎没有。ar_mailer 应该使用名为 Email 的模型。你的 app/models 目录中有这个类吗？如果是这样，初始化是否覆盖了任何内容？如果您要覆盖初始化，请务必为其提供参数并调用 super。

```
class Email < ActiveRecord::Base
  def initialize(attributes)
    super
    # whatever you want to do
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T12:42:02.553

检查 email_class 是否设置正确：[http ://seattlerb.rubyforge.org/ar_mailer/classes/ActionMailer/ARMailer.html#M000002](http://seattlerb.rubyforge.org/ar_mailer/classes/ActionMailer/ARMailer.html#M000002)

也不要使用实例变量。尝试：

```
class TestMailer < ActionMailer::ARMailer
  def send_email
    recipients "roberto.druetto@gmail.com"
    from "roberto.druetto@gmail.com"
    subject "TEST MAIL SUBJECT"
    content_type "text/html"
  end
end 
```

来自文档： body 方法具有特殊行为。它需要一个散列，该散列生成一个实例变量，该变量以散列中的每个键命名，其中包含该键指向的值。

所以像这样的东西添加到上面的方法中：

```
body :user => User.find(1) 
```

将允许您`@user`在模板中使用。

# visual-studio - Visual Studio 2008 中选择的关键字突出显示

> ID：132452
> 
> 赞同：5
> 
> 时间：2008-09-25T10:11:03.430
> 
> 标签：visual-studio, syntax-highlighting

不久前，我设法让 Visual Studio 2008 (C++) 进入一种状态，如果我要选择一个关键字（或任何与此相关的符号），通过双击或突出显示它，该符号的所有其他实例当前文件中的内容也会突出显示。

这是一个非常有用的功能。

从那以后它就消失了，我不知道如何找回它。

请帮忙。

@Sander - 就是这样。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T10:17:33.103

我想你已经安装了[RockScroll](http://www.hanselman.com/blog/IntroducingRockScroll.aspx)。它还在图形滚动条中点亮它们（它的主要功能）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-29T13:07:19.800

我使用[MetalScroll](http://code.google.com/p/metalscroll/)，它就像 RockScroll 一样更好；它不会干扰 Resharper（VS 必备），并且您可以将其设置为仅在双击时按住“alt”时突出显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-23T16:18:48.503

Mikhail Nasyrov有一个叫做“ **WordLight ”的东西。**Visual Studio 2008 的加载项，它突出显示所有出现的选定文本。它搜索并突出显示当前在文本编辑器中选择的子字符串。可以在下面的链接 [WordLight中找到](https://marketplace.visualstudio.com/items?itemName=MikhailNasyrov.WordLight)

[https://marketplace.visualstudio.com/items?itemName=MikhailNasyrov.WordLight](https://marketplace.visualstudio.com/items?itemName=MikhailNasyrov.WordLight)

# asp.net - 是否可以在 ASP.NET 中上传整个文件夹？

> ID：132465
> 
> 赞同：1
> 
> 时间：2008-09-25T10:15:34.170
> 
> 标签：asp.net, file-upload

asp.net 中的文件上传控件不允许我选择文件夹，只能选择文件。有什么方法可以选择文件夹（显然不使用文件上传控件）。

为什么我要选择文件夹基本上是将其整个路径存储在数据库表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T10:27:10.177

HTML`<input type=file>`元素仅支持单个文件上传。如果要上传多个文件，则必须使用 3rd 方组件 - 通常用 Flash 编写。

这里有一个例子： http: [//www.codeproject.com/KB/aspnet/FlashUpload.aspx](http://www.codeproject.com/KB/aspnet/FlashUpload.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T10:21:05.420

不，浏览文件是客户端功能，有关文件路径的唯一信息是它们的名称。是因为安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T10:23:23.870

我不认为 HTML 支持你正在尝试做的事情。也许作为一种解决方法，您可以让他们在文件夹中选择一个文件，然后在处理它时砍掉文件名，但老实说那是一团糟。

要求他们粘贴或在文本框中键入路径。这里的问题是您无法检查拼写错误。

我说你应该重新考虑你想要做什么。

# java - 如何在 Java 中执行字符串差异？

> ID：132478
> 
> 赞同：56
> 
> 时间：2008-09-25T10:20:39.977
> 
> 标签：java, diff

我需要在 Java 字符串之间执行差异。我希望能够使用原始字符串和差异版本重建字符串。有没有人用Java做过这个？你用什么图书馆？

```
String a1; // This can be a long text
String a2; // ej. above text with spelling corrections
String a3; // ej. above text with spelling corrections and an additional sentence

Diff diff = new Diff();
String differences_a1_a2 = Diff.getDifferences(a,changed_a);
String differences_a2_a3 = Diff.getDifferences(a,changed_a);    
String[] diffs = new String[]{a,differences_a1_a2,differences_a2_a3};
String new_a3 = Diff.build(diffs);
a3.equals(new_a3); // this is true 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-09-25T10:41:37.537

这个库似乎可以解决问题：[google-diff-match-patch](https://github.com/google/diff-match-patch)。它可以根据差异创建补丁字符串并允许重新应用补丁。

**编辑**：另一个解决方案可能是[https://code.google.com/p/java-diff-utils/](https://code.google.com/p/java-diff-utils/)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-09-25T10:22:22.983

Apache Commons 有字符串差异

org.apache.commons.lang.StringUtils

```
StringUtils.difference("foobar", "foo"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-18T08:36:27.573

[java diff utills](https://github.com/dnaumenko/java-diff-utils)库可能很有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T10:46:16.153

正如 Torsten 所说，您可以使用

org.apache.commons.lang.StringUtils;

```
System.err.println(StringUtils.getLevenshteinDistance("foobar", "bar")); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T14:36:44.540

如果您需要处理大量数据之间的差异并有效地压缩差异，您可以尝试使用 xdelta 的 Java 实现，它反过来为二进制差异实现 RFC 3284 (VCDIFF)（也应该使用字符串）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T10:40:02.300

使用[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)并从算法建立的矩阵中提取编辑日志。维基百科文章链接到几个实现，我确信其中有一个 Java 实现。

[Levenshtein 是最长公共](http://en.wikipedia.org/wiki/Longest_common_subsequence_problem)子序列算法的一个特例，您可能还想看看。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-12T14:58:11.917

Apache Commons Text 现在有[StringsComparator](https://commons.apache.org/proper/commons-text/apidocs/org/apache/commons/text/diff/StringsComparator.html)：

```
StringsComparator c = new StringsComparator(s1, s2);
c.getScript().visit(new CommandVisitor<Character>() {

    @Override
    public void visitKeepCommand(Character object) {
        System.out.println("k: " + object);
    }

    @Override
    public void visitInsertCommand(Character object) {
        System.out.println("i: " + object);
    }

    @Override
    public void visitDeleteCommand(Character object) {
        System.out.println("d: " + object);
    }
}); 
```

* * *

## 回答 #8

> 赞同：-7
> 
> 时间：2016-11-29T18:30:26.300

```
public class Stringdiff {
public static void main(String args[]){
System.out.println(strcheck("sum","sumsum"));
}
public static String strcheck(String str1,String str2){
    if(Math.abs((str1.length()-str2.length()))==-1){
        return "Invalid";
    }
    int num=diffcheck1(str1, str2);
    if(num==-1){
        return "Empty";
    }
    if(str1.length()>str2.length()){
        return str1.substring(num);
    }
    else{
        return str2.substring(num);
    }

}

public static int diffcheck1(String str1,String str2)
{
    int i;
    String str;
    String strn;
    if(str1.length()>str2.length()){
        str=str1;
        strn=str2;
    }
    else{
        str=str2;
        strn=str1;
    }
    for(i=0;i<str.length() && i<strn.length();i++){
            if(str1.charAt(i)!=str2.charAt(i)){
                return i;
            }
    }
        if(i<str1.length()||i<str2.length()){
            return i;
        }

    return -1;

   }
   } 
```

# python - 正则表达式删除条件注释

> ID：132488
> 
> 赞同：5
> 
> 时间：2008-09-25T10:23:33.400
> 
> 标签：python, regex

我想要一个可以匹配 HTML 源页面中的条件注释的正则表达式，所以我只能删除那些。我想保留常规评论。

我也想避免使用 .*? 如果可能的话。

文字是

```
foo

<!--[if IE]>

<style type="text/css">

ul.menu ul li{
    font-size: 10px;
    font-weight:normal;
    padding-top:0px;
}

</style>

<![endif]-->

bar 
```

我想删除`<!--[if IE]>`和`<![endif]-->`

**编辑：**这是因为 BeautifulSoup 我想删除这些标签。BeautifulSoup 无法解析并给出不完整的来源

**EDIT2：** [如果 IE] 不是唯一的条件。还有更多，我没有所有可能组合的列表。

**EDIT3：** Vinko Vrsalovic 的解决方案有效，但 beautifulsoup 失败的实际问题是条件注释中的流氓注释。喜欢

```
<!--[if lt IE 7.]>
<script defer type="text/javascript" src="pngfix_253168.js"></script><!--png fix for IE-->
<![endif]--> 
```

注意到`<!--png fix for IE-->`评论了吗？

虽然我的问题已经解决，但我很想为此获得一个正则表达式解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T10:34:45.323

```
>>> from BeautifulSoup import BeautifulSoup, Comment
>>> html = '<html><!--[if IE]> bloo blee<![endif]--></html>'
>>> soup = BeautifulSoup(html)
>>> comments = soup.findAll(text=lambda text:isinstance(text, Comment) 
               and text.find('if') != -1) #This is one line, of course
>>> [comment.extract() for comment in comments]
[u'[if IE]> bloo blee<![endif]']
>>> print soup.prettify()
<html>
</html>
>>> 
```

带有 bf4 的 python 3：

```
from bs4 import BeautifulSoup, Comment
html = '<html><!--[if IE]> bloo blee<![endif]--></html>'
soup = BeautifulSoup(html, "html.parser")
comments = soup.findAll(text=lambda text:isinstance(text, Comment) 
               and text.find('if') != -1) #This is one line, of course
[comment.extract() for comment in comments]
[u'[if IE]> bloo blee<![endif]']
print (soup.prettify()) 
```

如果您的数据让 BeautifulSoup 感到困惑，您可以事先[修复](http://www.crummy.com/software/BeautifulSoup/documentation.html#Sanitizing%20Bad%20Data%20with%20Regexps)它或[自定义](http://www.crummy.com/software/BeautifulSoup/documentation.html#Customizing%20the%20Parser)解析器，以及其他解决方案。

编辑：根据您的评论，您只需根据需要修改传递给 findAll 的 lambda（我修改了它）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-26T04:51:12.020

在我看来，您只需要担心*下层隐藏*的注释（以 开头的注释`<!--`），并且您不需要匹配单词`if`及其后面的空格之外的任何内容。这应该做你想要的：

```
"<!--\[if\s(?:[^<]+|<(?!!\[endif\]-->))*<!\[endif\]-->" 
```

中间的那个烂摊子是为了满足你不使用的欲望`.*?`，但我真的认为这不值得付出努力。如果`.*?`您使用 Re.S 标志集编译正则表达式或将其包装在`(?s:...)`. 例如：

```
"(?s:<!--\[if\s.*?<!\[endif\]-->)" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T10:46:16.233

这是您需要的：

```
<!(|--)\[[^\]]+\]>.+?<!\[endif\](|--)> 
```

它将过滤掉各种条件注释，包括：

```
<!--[if anything]>
    ...
<[endif]--> 
```

和

```
<![if ! IE 6]>
    ...
<![endif]> 
```

* * *

> **EDIT3**：Vinko Vrsalovic 的解决方案有效，但 beautifulsoup 失败的实际问题是条件评论中的流氓评论。喜欢
> 
> 注意到评论了吗？
> 
> 虽然我的问题已经解决，但我很想为此获得一个正则表达式解决方案。

这个怎么样：

```
(<!(|--)\[[^\]]+\]>.*?)(<!--.+?-->)(.*?<!\[endif\](|--)>) 
```

对该正则表达式进行替换，留下 \1\4（或 $1$4）作为替换。
*我知道它有.*？和.+？在其中，请参阅我对这篇文章的评论。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T20:42:26.703

我会简单地选择：

```
import re

html = """fjlk<wb>dsqfjqdsmlkf fdsijfmldsqjfl fjdslmfkqsjf<---- fdjslmjkqfs---><!--[if lt IE 7.]>\
<script defer type="text/javascript" src="pngfix_253168.js"></script><!--png fix for IE-->\
<![endif]-->fjlk<wb>dsqfjqdsmlkf fdsijfmldsqjfl fjdslmfkqsjf<---- fdjslmjkqfs--->"""

# here the black magic occurs (whithout '.')
clean_html = ''.join(re.split(r'<!--\[[^¤]+?endif]-->', html))

print clean_html

'fjlk<wb>dsqfjqdsmlkf fdsijfmldsqjfl fjdslmfkqsjf<---- fdjslmjkqfs--->fjlk<wb>dsqfjqdsmlkf fdsijfmldsqjfl fjdslmfkqsjf<---- fdjslmjkqfs--->' 
```

注意：[^¤] 将匹配任何不是 '¤' 的字符。这非常有用，因为它速度极快，并且可以在任何键盘上找到此字符。但诀窍是它真的很难输入（没有人会错误地输入它）并且没有人使用它：它是一种通用的货币设计字符。

但是，如果您不想使用 ¤，您可以使用 chr(7) 生成“系统铃声”字符，该字符不可打印且无法在网页中找到 ;-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T10:31:59.870

@Benoit

小修正（多行打开）：

```
 "<!--\[if IE\]>.*?<!\[endif\]-->" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T10:27:06.653

不要为此使用正则表达式。你会对包含开始标签的评论感到困惑，并且会做错事。HTML 不是正则的，尝试使用单个正则表达式修改它会失败。

为此使用 HTML 解析器。BeautifulSoup 是一个很好的、简单的、灵活的和坚固的，能够处理现实世界的（意味着无可救药的破碎的）HTML。使用它，您可以查找所有评论节点，检查它们的内容（如果您愿意，可以使用正则表达式*）*并在需要删除它们时删除它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T10:32:39.307

这适用于 Visual Studio 2005，其中没有行跨度选项：

`\<!--\[if IE\]\>{.|\n}*\<!\[endif\]--\>`

# language-agnostic - 为改变而设计

> ID：132489
> 
> 赞同：6
> 
> 时间：2008-09-25T10:23:54.117
> 
> 标签：language-agnostic

我很确定我们中的大多数人都熟悉项目启动后需求发生变化的概念，随着客户对事物如何运作的了解越少，您与他们的合作越密切，这就越成为一个问题。

那么我该如何设计一个系统（特别是一个网站，但一般建议在这里可能是最好的）以便可以进行小的更改，是否有任何编程策略可以解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-25T10:31:41.790

所有正常的 oo 原则都适用于此，减少耦合，增加内聚，不要重复自己等。这将确保您拥有灵活且可扩展的代码库。

除此之外，不要试图抢占变革。在任何地方都应用 YAGNI（你不会需要它）。只构建您知道用户需要的东西。不要建造你认为你会需要的东西。你更有可能猜错，然后你有一堆可能只是阻碍的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T10:26:10.867

我认为最重要的是确保您拥有一个全面的测试套件。这样，您就可以在需要时自信地进行更改，并知道何时发生故障。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T10:36:18.223

没有使用 PHP 的经验，请稍加注意。

但这一切都是为了知道改变**会**到来。因此，当您在编写代码并开始想要破解某些东西以完成它们时，请**停下来**思考“如果我需要再次更改它怎么办？”。

现在，我知道 php 是一种脚本语言，但是您必须能够从代码库中提取代码，对吗？这是最好的做法，让 UI（网页）尽可能轻，在大多数情况下只需要 1 或 2 次方法调用。

如果您有花哨的渲染逻辑，请将其库化。创建一个可能很常见的漂亮外观？看看*可能会*发生什么变化（配色方案等），将其库化。您已经将所有核心代码放入库中，对吧？;)

如果您一直致力于构建您的*图书馆*，那么当更改请求出现时，您需要做的就是“为它找到合适的书”。我们所做的很酷的是，如果这本书写得好，您可以轻松为其添加注释；）

这基本上是我目前正在做的工作，我的“项目”是构建未来应用程序将使用的平台，所以这确实是我的主要关注点。:)

## 更新

[Mendelt](https://stackoverflow.com/questions/132489/designing-for-change#132516)在应用 YAGNI 时提出了一个很好的观点，通过以上所有内容，不要只是将东西写到库中，而是如果你想一想你刚刚创建的性感小桌子（因为客户想要它）*可能*会再次使用，那么是时候考虑让它更有用了。一次性客户端的一些晦涩功能应该临时完成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T11:07:58.037

好吧，我会尝试从另一端解决这个问题：

**与客户/用户进行更多沟通。**

我自己也去过那里，编写不需要或没有正确沟通的东西，并且不得不重做大量代码。*通过更多的沟通，或者更确切地说：通过更多的正确*沟通，它会被阻止。

除此之外：允许用户更改颜色并时不时询问他们，在哪里放置按钮以及他们对这种“高度控制”感到满意的概率是相当不错的。然后他们不希望你重做真正的功能。是的，我对此很讽刺。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T10:30:53.180

我建议为您选择的语言使用久经考验的框架。大多数*优秀的*框架将被设计为适应多种场景。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T10:34:54.480

首先，您应该确定具有高变化概率的方面。这些方面应该“抽象出来”。一个经典的例子是您网站的风格（即通过 css）。但是你甚至可以定义一个展示网页特定元素的“presenter”类。

困难的是对变化概率做出正确的估计。但这取决于你:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-27T11:19:49.900

这就是框架发挥作用的地方。

如果所有基线、背景、一切照旧都在框架中，那么您的应用程序就是扩展、特殊情况和附加组件。

该框架已经为改变而设计和构建。你的东西是框架设计接受的变化。

When change occurs, you will respond to change with some combination of modifying the framework configuration and rewriting your stuff that plugs into the framework. You cope with change by *not* focusing on the default, background stuff. Delegate that to someone else -- the framework authors.

# vb.net - 最佳实践：潜在的巨大 Winform 网格？

> ID：132496
> 
> 赞同：2
> 
> 时间：2008-09-25T10:26:27.247
> 
> 标签：vb.net, winforms, visual-studio-2008, grid

我正在 VB.NET 2008 中编写一个管理软件部署的应用程序，并且我想显示一个“部署概述”网格。

网格将填充每个应用程序的名称（第一行）和每个工作站的名称（第一列）。剩余的单元格将根据相应的软件标题是否已正确安装、安装失败或未部署来填充。

将这些信息呈现给最终用户的最佳方式是什么？应用程序是否可以“处理”可能有一千个复选框，或者以某种方式“所有者绘制”网格会更好吗？

我可能还需要能够单击任何这些单元格以查看和/或设置其他属性。

非常感谢您的帮助。

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T10:49:51.420

我在尝试显示超过 10000 行时使用了 .NET 的 GridDataView，使用虚拟模式没有任何问题，但是那里有很好的产品，它们在加载大量数据方面也非常好，例如[Developer express](http://www.devexpress.com/) XtraGrid 和[Telerik](http://www.telerik.com/products/winforms/controls/gridview/overview.aspx)的 RadGridView。

唯一的挑战是让 UAT 人员对来自数千行的所有噪音感到满意。

# java - Web服务客户端和ssl

> ID：132498
> 
> 赞同：0
> 
> 时间：2008-09-25T10:27:03.843
> 
> 标签：java, web-services, ssl, client

我有一个使用 Http 协议调用 Web 服务的 Java 客户端。当我尝试使用 Https 协议时，我不断收到此错误 java.io.IOException: DerInputStream.getLength(): lengthTag=127, too big。

有什么想法可以解决吗？谢谢达米安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T13:48:17.890

由于美国在加密技术方面的出口法规，您不能开箱即用地使用强加密。您的错误看起来像您（或您的框架）正在尝试使用强加密，而框架的其他部分不允许它。

可以在[此处](http://www.codecomments.com/archive253-2004-4-173117.html)找到与您的案例相似的案例的讨论。一个好的加密提供者是[BouncyCastle](http://www.bouncycastle.org/java.html)。需要一些阅读，但让它发挥作用并不难。

祝你好运，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T14:32:45.797

您确定将 HTTPS 客户端连接到通过 HTTPS（TLS/SSL）而不是 HTTP 进行通信的服务器端口吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T11:11:32.390

您必须从客户端传递密钥库类型。这个错误应该会消失。

# c# - 如何仅使用一个额外的整数变量对整数列表进行排序？

> ID：132501
> 
> 赞同：2
> 
> 时间：2008-09-25T10:27:18.900
> 
> 标签：c#, java, algorithm, sorting, puzzle

如何仅使用一个变量对值列表进行排序？

编辑：根据@Igor 的评论，我重新命名了这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T13:23:49.053

## C中的解决方案：

```
#include <stdio.h>

int main()
{
    int list[]={4,7,2,4,1,10,3};
    int n;  // the one int variable

    startsort:
    for (n=0; n< sizeof(list)/sizeof(int)-1; ++n)
        if (list[n] > list[n+1]) {
            list[n] ^= list[n+1];
            list[n+1] ^= list[n];
            list[n] ^= list[n+1];
            goto startsort;
        }

    for (n=0; n< sizeof(list)/sizeof(int); ++n)
        printf("%d\n",list[n]);
    return 0;
} 
```

输出当然与 Icon 程序的相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T12:41:52.023

我怀疑我正在为你做作业，但嘿，这是一个有趣的挑战。这是[Icon](http://en.wikipedia.org/wiki/Icon_(programming_language))中的解决方案：

```
procedure mysort(thelist)
    local n # the one integer variable
    every n := (1 to *thelist & 1 to *thelist-1) do
    if thelist[n] > thelist[n+1] then thelist[n] :=: thelist[n+1]
    return thelist
end

procedure main(args)
    every write(!mysort([4,7,2,4,1,10,3]))
end 
```

输出：

```
1
2
3
4
4
7
10 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T11:47:00.703

您可以为每个可能的列表大小生成/编写大量排序网络。在排序网络中，您使用单个变量进行交换操作。

我不建议您在软件中执行此操作，但仍然可以。

这是 C 中所有 n 到 4 的排序例程

```
// define a compare and swap macro 
#define order(a,b) if ((a)<(b)) { temp=(a); (a) = (b); (b) = temp; }

static void sort2 (int *data)
// sort-network for two numbers
{
  int temp;
  order (data[0], data[1]);
}

static void sort3 (int *data)
// sort-network for three numbers
{
  int temp;
  order (data[0], data[1]);
  order (data[0], data[2]);
  order (data[1], data[2]);
}

static void sort4 (int *data)
// sort-network for four numbers
{
  int temp;
  order (data[0], data[2]);
  order (data[1], data[3]);
  order (data[0], data[1]);
  order (data[2], data[3]);
  order (data[1], data[2]);
}

void sort (int *data, int n)
{
  switch (n)
    {
    case 0:
    case 1:
      break;
    case 2:
      sort2 (data);
      break;
    case 3:
      sort3 (data);
      break;
    case 4:
      sort4 (data);
      break;
    default:
      // Sorts for n>4 are left as an exercise for the reader
      abort();
    }
} 
```

显然，您需要为每个可能的 N 设置一个排序网络代码。

更多信息在这里：

[http://en.wikipedia.org/wiki/Sorting_network](http://en.wikipedia.org/wiki/Sorting_network)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T13:35:17.323

在java中：

```
import java.util.Arrays;

/**
 * Does a bubble sort without allocating extra memory
 *
 */
public class Sort {
    // Implements bubble sort very inefficiently for CPU but with minimal variable declarations
    public static void sort(int[] array) {
        int index=0;
        while(true) {
            next:
            {
                // Scan for correct sorting. Wasteful, but avoids using a boolean parameter
                for (index=0;index<array.length-1;index++) {
                    if (array[index]>array[index+1]) break next;
                }
                // Array is now correctly sorted
                return;
            }
            // Now swap. We don't need to rescan from the start
            for (;index<array.length-1;index++) {
                if (array[index]>array[index+1]) {
                    // use xor trick to avoid using an extra integer
                    array[index]^=array[index+1];
                    array[index+1]^=array[index];
                    array[index]^=array[index+1];
                }
            }
        }
    }

    public static void main(final String argv[]) {
        int[] array=new int[] {4,7,2,4,1,10,3};
        sort(array);
        System.out.println(Arrays.toString(array));
    }
} 
```

实际上，通过使用[Nils 提出](https://stackoverflow.com/questions/132501/how-do-i-sort-a-list-of-integers-using-only-one-additional-integer-variable#132783)的技巧，您甚至可以消除剩余的一个 int 分配——尽管这当然会添加到堆栈中......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T12:34:22.353

在红宝石中： [1, 5, 3, 7, 4, 2].sort

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T10:29:01.517

你不知道，它已经排序了。（由于问题含糊不清，我假设变量是对象的同义词）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T12:05:38.043

如果您有一个列表`(1 5 3 7 4 2)`和一个变量`v`，您可以交换列表的两个值，例如 3 和 7，首先将 3 分配给`v`，然后将 7 分配给 3 的位置，最后将 的值分配给`v`原始位置7\. 之后，您可以重复使用`v`以进行下次交换。为了排序，您只需要一个算法来告诉交换哪些值。[例如，您可以在http://en.wikipedia.org/wiki/Sorting_algorithm](http://en.wikipedia.org/wiki/Sorting_algorithm)中寻找合适的算法。

# php - 如何在 Eclipse PDT 中重新格式化多行注释？

> ID：132504
> 
> 赞同：10
> 
> 时间：2008-09-25T10:27:52.750
> 
> 标签：php, eclipse, comments, eclipse-pdt, reformat

在`Eclipse PDT`，`Ctrl-Shift-F`重新格式化代码。但是，它根本不修改评论。有没有办法将参差不齐的多行注释重新格式化为每行 80 个字符（或其他）？

即转换

```
// We took a breezy excursion and 
// gathered Jonquils from the river slopes.  Sweet Marjoram grew 
// in luxuriant 
// profusion by the window that overlooked the Aztec city. 
```

至

```
// We took a breezy excursion and gathered Jonquils 
// from the river slopes.  Sweet Marjoram grew in 
// luxuriant profusion by the window that overlooked 
// the Aztec city. 
```

（我认为这也适用于常规 Eclipse。）

**更新**结果`Eclipse`in `Java`mode 将重新格式化上面的行，但前提是它们是 /* */ 样式的注释。它将缩短 // 太长的线，但不会将太短的线连接在一起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T11:13:23.467

您可能需要配置 Java 格式化程序以包含注释。

首选项 -> Java -> 代码样式 -> 格式化程序 -> 编辑... -> 评论

确保启用“启用 XXX 评论格式”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T22:34:50.883

我从来没有真正能够让 Eclipse 格式化程序*按照*我想要的方式格式化我的代码，这只是我遇到的几个缺点之一。我听说 Jalopy 格式化程序要好得多。Eclipse 插件同时提供商业[版](http://www.triemax.com/)和[免费版。](http://jalopy.sourceforge.net/)我听说商业版更复杂（免费版的开发似乎已经停滞），但我个人并没有真正使用过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T06:46:07.633

我的解决方案涉及使用 vrapper 插件（免费）： http: [//vrapper.sourceforge.net/home/](http://vrapper.sourceforge.net/home/)它为您提供文本编辑器中的 vim 支持。

安装 vrapper 插件后，您可以按**v**进入*可视模式*，突出显示您的多行评论，然后按**G+Q**自动格式化评论，使行宽为 80 列（默认）。您可以更改默认列宽，但您需要阅读 vrapper 插件的文档。干杯!

# .net - 给定日期范围（开始日期和结束日期），我如何计算天数，不包括 .Net 中指定的一周中的几天？

> ID：132507
> 
> 赞同：2
> 
> 时间：2008-09-25T10:29:11.763
> 
> 标签：.net, date

我正在创建一个 UI，允许用户选择一个日期范围，并勾选或取消勾选该日期范围内适用的星期几。

日期范围控件是`DateTimePickers`，星期几是`CheckBoxes`

这是 UI 的模型：

`From Date: (dtpDateFrom)`
`To Date: (dtpDateTo)`

`[y] Monday, [n] Tuesday, [y] Wednesday, (etc)`

显示总天数的最佳方式是什么，不仅基于日期范围，还基于一周中勾选（或选定）的天数？

循环浏览日期范围是我唯一的选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T10:44:00.700

这是我将如何处理它：

*   查找第一个和最后一个日期的星期几（dow）
*   将第一天向前移动到与最后一天相同的道琼斯指数。要包括的商店移动天数
*   计算第一个和最后一个之间的周数
*   计算一周中包含的天数 * 周数 + 包含的移动天数

作为伪代码：

```
 moved = start + end_dow - start_dow
 extras = count included days between start and moved
 weeks = ( end - moved ) / 7
 days = days_of_week_included * weeks + extras 
```

这将花费恒定的时间，无论开始日期和结束日期相距多远。

实现此算法的细节取决于您使用的语言和库。在可能的情况下，我使用 C++ 和 boost::date_time 来处理这类事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T10:37:20.763

循环不是您唯一的选择 - 您可以执行[减法](http://msdn.microsoft.com/en-us/library/8ysw4sby.aspx)来计算总天数，并为包含这些日子之一的每周“跳过”日期范围内的每个“跳过”日期减去一个。当您确定一天是否落在范围开始或结束的部分周之一并添加`#weeks * skipped days in a week`时，您的代码将比仅计算时更复杂，但如果您期望有巨大的日期范围，它可能会表现得更好。

如果我是你，我会编写简单的循环选项，如果结果分析表明它是一个瓶颈，我会重写它。

# c# - .NET 配置 (app.config/web.config/settings.settings)

> ID：132544
> 
> 赞同：163
> 
> 时间：2008-09-25T10:39:09.290
> 
> 标签：c#, .net, asp.net, vb.net, configuration

我有一个 .NET 应用程序，它具有用于调试和发布版本的不同配置文件。例如，调试 app.config 文件指向已启用调试的开发[SQL Server](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)，而发布目标指向实时 SQL Server。还有其他设置，其中一些在调试/发布时有所不同。

我目前使用两个单独的配置文件（debug.app.config 和 release.app.config）。我在项目上有一个构建事件，说明如果这是一个发布构建，则将 release.app.config 复制到 app.config，否则将 debug.app.config 复制到 app.config。

问题是应用程序似乎从 settings.settings 文件中获取其设置，所以我必须在 Visual Studio 中打开 settings.settings ，然后提示我设置已更改，因此我接受更改，保存 settings.settings 并拥有重建以使其使用正确的设置。

是否有更好/推荐/首选的方法来达到类似的效果？或者同样，我是否完全错误地处理了这个问题，是否有更好的方法？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-01-07T22:09:41.957

任何可能因环境而异的配置都应该存储在**机器级别**，而不是**应用程序级别**。[（有关配置级别的更多信息。）](http://msdn.microsoft.com/en-us/library/1xtk877y.aspx)

这些是我通常在机器级别存储的配置元素类型：

*   [应用程序设置](http://msdn.microsoft.com/en-us/library/ms228154.aspx)
*   [连接字符串](http://msdn.microsoft.com/en-us/library/bf7sd233.aspx)
*   [零售=真](http://msdn.microsoft.com/en-us/library/ms228298.aspx)
*   [SMTP 设置](http://msdn.microsoft.com/en-us/library/ms164240.aspx)
*   [健康监测](http://msdn.microsoft.com/en-us/library/bb398933.aspx)
*   [托管环境](http://msdn.microsoft.com/en-us/library/ms228159.aspx)
*   [机器钥匙](http://msdn.microsoft.com/en-us/library/w8h3skw9.aspx)

**当每个环境（developer、integration、test、stage、live）在​​c:\Windows\Microsoft.NET\Framework64\v2.0.50727\CONFIG**目录下都有自己独特的设置，那么你就可以在不同环境之间提升你的*应用代码*了构建后的修改。

显然，机器级 CONFIG 目录的内容在与您的应用程序不同的存储库或不同的文件夹结构中获得版本控制。您可以通过智能使用[configSource](http://msdn.microsoft.com/en-us/library/system.configuration.sectioninformation.configsource.aspx)使您的 .config 文件对源代码控制更加友好。

我在 25 多家不同公司的 200 多个 ASP.NET 应用程序上从事这项工作已有 7 年了。（不是想吹牛，只是想让你知道我从未见过这种方法*不起作用*的情况。）

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-08-26T08:44:02.030

这可能会帮助一些处理 Settings.settings 和 App.config 的人：在 Visual Studio（在我的例子中是 Visual Studio 2008）中编辑 Settings.settings 网格中的任何值时，请注意“属性”窗格中的 GenerateDefaultValueInCode 属性。

如果将 GenerateDefaultValueInCode 设置为 True（此处默认为 True！），则默认值将编译到 EXE（或 DLL）中，当您在纯文本编辑器中打开文件时，您可以发现它嵌入在文件中。

我正在开发一个控制台应用程序，如果我在 EXE 中默认，该应用程序总是忽略放置在同一目录中的配置文件！一场噩梦，整个互联网上都没有这方面的信息。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-09-25T10:57:29.060

这里有一个相关的问题：

[改进您的构建过程](https://stackoverflow.com/questions/14893/improving-your-build-process)

配置文件附带了一种覆盖设置的方法：

```
<appSettings file="Local.config"> 
```

无需检入两个（或更多）文件，您只需检入默认配置文件，然后在每台目标机器上放置一个 Local.config，其中只有 appSettings 部分具有该特定机器的覆盖。

如果您使用的是配置部分，则等效为：

```
configSource="Local.config" 
```

当然，从其他机器制作所有 Local.config 文件的备份副本并将它们检查到某个地方是一个好主意，但不是作为实际解决方案的一部分。每个开发人员都在 Local.config 文件上放置一个“忽略”，这样它就不会被签入，这会覆盖其他所有人的文件。

（您实际上不必将其称为“Local.config”，这正是我使用的）

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-09-25T11:12:24.890

从我正在阅读的内容来看，听起来您正在使用 Visual Studio 进行构建过程。您是否考虑过改用 MSBuild 和[Nant](http://nant.sourceforge.net/)？

Nant 的 xml 语法有点奇怪，但是一旦你理解了它，做你提到的事情就变得很简单了。

```
<target name="build">
    <property name="config.type" value="Release" />

    <msbuild project="${filename}" target="Build" verbose="true" failonerror="true">
        <property name="Configuration" value="${config.type}" />
    </msbuild>

    <if test="${config.type == 'Debug'}">
        <copy file=${debug.app.config}" tofile="${app.config}" />
    </if>

    <if test="${config.type == 'Release'}">
        <copy file=${release.app.config}" tofile="${app.config}" />
    </if>

</target> 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-25T10:57:02.540

在我看来，您似乎可以从[Visual Studio 2005 Web 部署项目](http://msdn.microsoft.com/en-us/asp.net/aa336619.aspx)中受益。

有了它，您可以告诉它根据构建配置更新/修改 web.config 文件的部分。

请查看[Scott Gu 的这篇博客文章，](http://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)以获得快速概述/示例。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-25T11:36:25.130

我们曾经使用 Web 部署项目，但后来迁移到了 NAnt。我们目前直接在构建脚本中嵌入配置值并通过 xmlpoke 任务将它们注入到我们的配置文件中，而不是分支和复制不同的设置文件：

```
 <xmlpoke
    file="${stagingTarget}/web.config"
    xpath="/configuration/system.web/compilation/@debug"
    value="true"
  /> 
```

无论哪种情况，您的配置文件都可以具有您想要的任何开发人员值，并且它们可以在您的开发环境中正常工作，而不会破坏您的生产系统。我们发现开发人员在测试时不太可能随意更改构建脚本变量，因此与我们尝试过的其他技术相比，意外的错误配置很少见，尽管仍然有必要在过程的早期添加每个变量，以便默认情况下，dev 值不会被推送到 prod。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-25T10:46:20.460

我现在的雇主通过首先将开发级别（调试、阶段、实时等）放入 machine.config 文件中解决了这个问题。然后他们编写代码来获取并使用正确的配置文件。这解决了应用程序部署后连接字符串错误的问题。

他们最近刚刚编写了一个中央 web 服务，它从 machine.config 值中的值发送回正确的连接字符串。

这是最好的解决方案吗？可能不是，但它适用于他们。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-25T11:14:20.113

对我有用的解决方案之一是使用 WebDeploymentProject。我的站点中有 2/3 个不同的 web.config 文件，并且在发布时，取决于所选的配置模式（发布/暂存/等），我将复制 Web.Release.config 并将其重命名为 web.config。在 AfterBuild 事件中配置，并删除我不需要的那些（例如 Web.Staging.config）。

```
<Target Name="AfterBuild">
    <!--Web.config -->
    <Copy Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' " SourceFiles="$(SourceWebPhysicalPath)\Web.Release.config" DestinationFiles="$(OutputPath)\Web.config" />
    <Copy Condition=" '$(Configuration)|$(Platform)' == 'Staging|AnyCPU' " SourceFiles="$(SourceWebPhysicalPath)\Web.Staging.config" DestinationFiles="$(OutputPath)\Web.config" />
    <!--Delete extra files -->
    <Delete Files="$(OutputPath)\Web.Release.config" />
    <Delete Files="$(OutputPath)\Web.Staging.config" />
    <Delete Files="@(ProjFiles)" />
  </Target> 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-25T12:28:17.563

您会在这里找到另一个解决方案：[在 ASP.NET 中的 Development/UAT/Prod 环境之间切换配置的最佳方式？](https://stackoverflow.com/questions/132885/best-way-to-switch-configuration-between-developmentuatprod-environments-in-asp#132934)它使用 XSLT 转换 web.config。

还有一些使用 NAnt 的好例子。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-06-18T21:42:15.683

我们的项目有同样的问题，我们必须维护 dev、qa、uat 和 prod 的配置。以下是我们遵循的（仅适用于您熟悉 MSBuild）：

将 MSBuild 与 MSBuild 社区任务扩展一起使用。它包括“XmlMassUpdate”任务，一旦你给它正确的节点开始，它就可以“大规模更新”任何 XML 文件中的条目。

实施：

1) 您需要有一个配置文件，其中包含您的开发环境条目；这是您的解决方案中的配置文件。

2）您需要有一个“Substitutions.xml”文件，其中仅包含每个环境不同的条目（主要是 appSettings 和 ConnectionStrings）。不会在环境中更改的条目不需要放在此文件中。它们可以存在于解决方案的 web.config 文件中，不会被任务触及

3) 在您的构建文件中，只需调用 XML 批量更新任务并提供正确的环境作为参数。

请参见下面的示例：

```
 <!-- Actual Config File -->
    <appSettings>
        <add key="ApplicationName" value="NameInDev"/>
        <add key="ThisDoesNotChange" value="Do not put in substitution file" />
    </appSettings>

    <!-- Substitutions.xml -->
    <configuration xmlns:xmu="urn:msbuildcommunitytasks-xmlmassupdate">
      <substitutions>
        <QA>
           <appSettings>
            <add xmu:key="key" key="ApplicationName" value="NameInQA"/>
           </appSettings>            
        </QA>
        <Prod>
          <appSettings>
            <add xmu:key="key" key="ApplicationName" value="NameInProd"/>
          </appSettings>            
        </Prod>
     </substitutions>
    </configuration>

<!-- Build.xml file-->

    <Target Name="UpdateConfigSections">
            <XmlMassUpdate ContentFile="Path\of\copy\of\latest web.config" SubstitutionsFile="path\of\substitutionFile" ContentRoot="/configuration" SubstitutionsRoot="/configuration/substitutions/$(Environment)" />
        </Target> 
```

根据什么环境将“$Environment”替换为“QA”或“Prod”。你正在建设。请注意，您应该使用配置文件的副本而不是实际的配置文件本身，以避免任何可能的不可恢复的错误。

只需运行构建文件，然后将更新的配置文件移动到您的部署环境，就完成了！

要获得更好的概述，请阅读以下内容：

[http://blogs.microsoft.co.il/blogs/dorony/archive/2008/01/18/easy-configuration-deployment-with-msbuild-and-the-xmlmassupdate-task.aspx](http://blogs.microsoft.co.il/blogs/dorony/archive/2008/01/18/easy-configuration-deployment-with-msbuild-and-the-xmlmassupdate-task.aspx)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-26T12:32:22.540

和你一样，我也设置了“多”app.config - 例如 app.configDEV、app.configTEST、app.config.LOCAL。我看到了一些很好的替代方案，但如果你喜欢它适合你的方式，我会添加以下内容：

我
`<appSettings>`
`<add key = "Env" value = "[Local] "/>` 在标题栏中将每个应用程序都添加到 UI 中：来自 ConfigurationManager.AppSettings.Get("Env");

我只是将配置重命名为我的目标（我有一个项目有 8 个应用程序，其中有很多数据库/wcf 配置针对 4 个事件）。要通过 clickonce 部署到每个项目中，我更改了项目中的 4 个设置然后开始。（这我很想自动化）

我唯一的问题是记住在更改后“全部清除”，因为旧配置在手动重命名后“卡住”。（我认为这会解决你的 setting.setting 问题）。

我发现这真的很好用（有一天我会有时间看看 MSBuild/NAnt）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-05-24T17:38:22.727

它上面写着 asp.net，那么为什么不将您的设置保存在数据库中并使用自定义缓存来检索它们呢？

我们这样做的原因是（对我们而言）更新连续数据库比获得连续更新生产文件的权限更容易。

**自定义缓存示例：**

```
public enum ConfigurationSection
{
    AppSettings
}

public static class Utility
{
    #region "Common.Configuration.Configurations"

    private static Cache cache = System.Web.HttpRuntime.Cache;

    public static String GetAppSetting(String key)
    {
        return GetConfigurationValue(ConfigurationSection.AppSettings, key);
    }

    public static String GetConfigurationValue(ConfigurationSection section, String key)
    {
        Configurations config = null;

        if (!cache.TryGetItemFromCache<Configurations>(out config))
        {
            config = new Configurations();
            config.List(SNCLavalin.US.Common.Enumerations.ConfigurationSection.AppSettings);
            cache.AddToCache<Configurations>(config, DateTime.Now.AddMinutes(15));
        }

        var result = (from record in config
                      where record.Key == key
                      select record).FirstOrDefault();

        return (result == null) ? null : result.Value;
    }

    #endregion
}

namespace Common.Configuration
{
    public class Configurations : List<Configuration>
    {
        #region CONSTRUCTORS

        public Configurations() : base()
        {
            initialize();
        }
        public Configurations(int capacity) : base(capacity)
        {
            initialize();
        }
        public Configurations(IEnumerable<Configuration> collection) : base(collection)
        {
            initialize();
        }

        #endregion

        #region PROPERTIES & FIELDS

        private Crud _crud; // Db-Access layer

        #endregion

        #region EVENTS
        #endregion

        #region METHODS

        private void initialize()
        {
            _crud = new Crud(Utility.ConnectionName);
        }

        /// <summary>
        /// Lists one-to-many records.
        /// </summary>
        public Configurations List(ConfigurationSection section)
        {
            using (DbCommand dbCommand = _crud.Db.GetStoredProcCommand("spa_LIST_MyConfiguration"))
            {
                _crud.Db.AddInParameter(dbCommand, "@Section", DbType.String, section.ToString());

                _crud.List(dbCommand, PopulateFrom);
            }

            return this;
        }

        public void PopulateFrom(DataTable table)
        {
            this.Clear();

            foreach (DataRow row in table.Rows)
            {
                Configuration instance = new Configuration();
                instance.PopulateFrom(row);
                this.Add(instance);
            }
        }

        #endregion
    }

    public class Configuration
    {
        #region CONSTRUCTORS

        public Configuration()
        {
            initialize();
        }

        #endregion

        #region PROPERTIES & FIELDS

        private Crud _crud;

        public string Section { get; set; }
        public string Key { get; set; }
        public string Value { get; set; }

        #endregion

        #region EVENTS
        #endregion

        #region METHODS

        private void initialize()
        {
            _crud = new Crud(Utility.ConnectionName);
            Clear();
        }

        public void Clear()
        {
            this.Section = "";
            this.Key = "";
            this.Value = "";
        }
        public void PopulateFrom(DataRow row)
        {
            Clear();

            this.Section = row["Section"].ToString();
            this.Key = row["Key"].ToString();
            this.Value = row["Value"].ToString();
        }

        #endregion
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-09-10T07:12:46.600

## 网络配置：

当您想在 IIS 上托管应用程序时，需要 Web.config。Web.config 是 IIS 的强制配置文件，用于配置它在 Kestrel 前如何作为反向代理运行。如果你想在 IIS 上托管它，你必须维护一个 web.config。

## 应用设置.json：

对于与 IIS 无关的所有其他内容，您可以使用 AppSetting.json。AppSetting.json 用于 Asp.Net Core 托管。ASP.NET Core 使用“ASPNETCORE_ENVIRONMENT”环境变量来确定当前环境。默认情况下，如果您在未设置此值的情况下运行应用程序，它将自动默认为生产环境并使用“AppSetting.production.json”文件。当您通过 Visual Studio 进行调试时，它将环境设置为 Development，因此它使用“AppSetting.json”。请参阅此网站以了解如何在 Windows 上设置托管环境变量。

## 应用程序配置：

App.config 是 .NET 使用的另一个配置文件，主要用于 Windows 窗体、Windows 服务、控制台应用程序和 WPF 应用程序。当您通过控制台应用程序启动 Asp.Net Core 托管时，还会使用 app.config。

* * *

### TL;博士

配置文件的选择取决于您为服务选择的托管环境。如果您使用 IIS 来托管您的服务，请使用 Web.config 文件。如果您使用任何其他托管环境，请使用 App.config 文件。请参阅[使用配置文件配置服务文档](https://docs.microsoft.com/en-us/dotnet/framework/wcf/configuring-services-using-configuration-files) 并查看[ASP.NET Core 中的配置。](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration/?view=aspnetcore-2.1#host-vs-app-configuration)

# multithreading - 如何在 EclipseMe 中调试多线程 midlet 应用程序？

> ID：132563
> 
> 赞同：1
> 
> 时间：2008-09-25T10:46:31.550
> 
> 标签：multithreading, debugging, java-me, midlet, eclipseme

在 EclipseMe 中调试多线程 midlet 时，断点仅适用于主线程，但不适用于其他线程。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-21T11:54:38.210

胡乱猜测，有没有试过把 Thread.sleep() 放到主线程中，看看调试器是否进入了其他线程！

# xml - XML中的元素和节点有什么区别？

> ID：132564
> 
> 赞同：392
> 
> 时间：2008-09-25T10:47:53.623
> 
> 标签：xml, xmlnode

我正在使用 XML 使用 Java，我想知道；元素和节点有什么区别？

* * *

## 回答 #1

> 赞同：279
> 
> 时间：2008-09-25T10:52:44.237

Node 对象是整个 DOM 的主要数据类型。

节点可以是元素节点、属性节点、文本节点或“节点类型”一章中解释的任何其他节点类型。

XML 元素是从（包括）元素的开始标记到（包括）元素的结束标记的所有内容。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2008-11-18T03:57:15.193

不同的 W3C 规范定义了不同的“节点”类型集。

因此，[**DOM 规范**](http://www.w3.org/TR/1998/REC-DOM-Level-1-19981001/level-one-core.html#ID-1590626202)定义了以下类型的节点：

*   `Document`-- `Element`(最多一个), `ProcessingInstruction`, `Comment`,`DocumentType`
*   `DocumentFragment` -- `Element`, `ProcessingInstruction`, `Comment`, `Text`, `CDATASection`,`EntityReference`
*   `DocumentType`- 没有小孩
*   `EntityReference` -- `Element`, `ProcessingInstruction`, `Comment`, `Text`, `CDATASection`,`EntityReference`
*   `Element`-- `Element`, `Text`, `Comment`, `ProcessingInstruction`, `CDATASection`,`EntityReference`
*   `Attr`-- `Text`,`EntityReference`
*   `ProcessingInstruction` - 没有小孩
*   `Comment`- 没有小孩
*   `Text`- 没有小孩
*   `CDATASection`- 没有小孩
*   `Entity`-- `Element`, `ProcessingInstruction`, `Comment`, `Text`, `CDATASection`,`EntityReference`
*   `Notation`- 没有小孩

[**XML Infoset**](http://www.w3.org/TR/xml-infoset/#infoitem)（由 XPath 使用）有一组较小的节点：

*   文档信息项*   元素信息项*   属性信息项*   处理指令信息项*   未扩展的实体参考信息项*   字符信息项*   评论信息项*   文件类型声明信息项*   未解析的实体信息项*   符号信息项*   命名空间信息项

XPath 具有以下节点类型：

*   根节点
*   元素节点
*   文本节点
*   属性节点
*   命名空间节点
*   处理指令节点
*   评论节点

**您的问题**“*元素和节点之间有什么区别*”的答案是：

***`An element is a type of node. Many other types of nodes exist and serve different purposes.`***

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-09-25T10:51:21.633

Node 是 DOM 树的一部分，Element 是 Node 的一种特殊类型

例如 `<foo> This is Text </foo>`

您有一个 foo 元素（它也是一个节点，因为 Element 继承自 Node）和一个文本节点“这是文本”，它是 foo 元素/节点的子节点

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2008-09-25T10:51:32.647

一个节点可以是许多不同种类的东西：一些文本、评论、元素、实体等。元素是一种特定类型的节点。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-09-25T11:07:16.167

如各种 XML[规范](http://www.w3.org/TR/2006/REC-xml11-20060816/#sec-logical-struct)中所述，an`element`是由开始标记和结束标记以及其间的内容或空元素标记（没有内容或结束标记）组成的标记。换句话说，这些都是元素：

```
<foo> stuff </foo>
<foo bar="baz"></foo>
<foo baz="qux" /> 
```

尽管您听到“节点”的含义大致相同，但它并没有根据 XML 规范进行精确定义。它通常用于指代诸如 DOM 之类的事物的节点，这些节点可能与 XML 密切相关，或者使用 XML 来表示它们。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-04-03T16:16:50.700

xml 文档由嵌套元素组成。一个元素从它的*开始标签*开始，到它的*结束标签*结束。您可能已经在 html 中看到`<body>`过。`</body>`开始标签和结束标签之间的所有内容都是元素的*内容*。如果一个元素是由一个自闭合标签（例如`<br/>`）定义的，那么它的内容是空的。

打开标签也可以指定*属性*，例如。`<p class="rant">`. 在此示例中，属性*名称*为“class”，其*值为*“rant”。

**XML 语言没有“节点”之类的东西**。[阅读规范](http://www.w3.org/TR/REC-xml/)，这个词不会出现。

有些人非正式地使用“节点”这个词来表示元素，这令人困惑，因为一些解析器还赋予这个词一个技术含义（识别“文本节点”和“元素节点”）。确切的含义取决于解析器，因此除非您说明正在使用的解析器，否则该词的定义不明确。**如果您的意思是元素，请说 'element'**。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-09-25T10:50:52.367

节点是元素和属性（基本上也是所有其他 XML 表示）的基类。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-09-25T11:15:29.360

**元素**是唯一可以具有子节点和属性**的节点。**

*文档也有子节点，但*
*没有属性，没有文本，只有一个子元素。*

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-09T23:31:46.353

一个节点[定义](http://www-01.ibm.com/software/globalization/terminology/n.html)为：

> 文档中有效、完整结构的最小单位。

或作为：

> 树视图中的对象，用作保存相关对象的容器。

现在它们有许多不同类型的节点，如元素节点、属性节点等。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-02-26T06:05:19.393

现在我知道，元素是节点之一

这里的所有节点类型“ [http://www.w3schools.com/dom/dom_nodetype.asp](http://www.w3schools.com/dom/dom_nodetype.asp) ”

元素在开始标签和结束标签之间

所以文本节点是一个节点，而不是一个元素。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T10:51:47.390

元素是一种节点，属性、文本等也是如此。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2016-09-02T05:51:39.423

XML 元素是一个 XML 节点，但具有其他元素，例如属性。

```
<a>Lorem Ipsum</a>  //This is a node

<a id="sample">Lorem Ipsum</a>  //This is an element 
```

* * *

## 回答 #13

> 赞同：-7
> 
> 时间：2014-07-23T10:27:17.813

节点和元素相同。每个元素都是一个节点，但并不是每个节点都必须是一个元素。

# javascript - “Suckerfish 之子”CSS 菜单 - 子菜单在 IE7 中未关闭

> ID：132566
> 
> 赞同：3
> 
> 时间：2008-09-25T10:48:42.810
> 
> 标签：javascript, suckerfish, css

尽管我最有说服力的呼声与此相反，但我最近被迫实施了一个水平下拉导航系统，所以我选择了我能找到的最友好的一个 - [Suckerfish 之子](http://www.htmldog.com/articles/suckerfish/dropdowns/)。

我在机器上的各种浏览器中进行了测试，一切似乎都很好。但是，一些（但不是全部！）IE7 用户遇到了一个问题，即子菜单在悬停后没有关闭。最烦人的是，受影响的用户正在使用与我完全相同的 IE7 版本（7.0.5730.13），在同一操作系统上使用相同的隐私和安全设置（我什至让他们发送 Internet 选项中选项卡的屏幕截图） (XP)。我无法验证 Vista 是否受到影响。

显然尝试调试这个问题是一场噩梦，因为我无法复制它，所以我想知道这里是否有人可以并且可能知道如何解决它。我在这里设置了一个示例页面：

> [http://x01.co.uk/menu_test/](http://x01.co.uk/menu_test/)

此外，在我也尝试解决但没有成功的子项目的翻转时会出现烦人的闪烁，因此也将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T12:47:47.267

这是在 IE7 中出现的问题，当页面的另一部分具有焦点时（即，您单击某个位置，然后将鼠标悬停在菜单上）。这似乎是 :hover 伪类的问题。

将 hasLayout 触发器添加到 :hover 样式应该可以解决问题。

```
#nav li:hover {
  position: static;
} 
```

还有其他解决方案。这里有一篇关于这个问题的精彩文章：

[Suckerfish 的黏糊糊的儿子](http://css-class.com/articles/explorer/sticky/index.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T10:57:43.100

为了测试，为什么不从 MS 自己下载 Vista IE7 VPC 映像？

[http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF)

虽然不确定这个错误。记得有类似的问题，我认为是因为你需要一个 JS。将尝试找出

# mysql - 安装mysql问题

> ID：132585
> 
> 赞同：0
> 
> 时间：2008-09-25T10:53:47.667
> 
> 标签：mysql, ruby-on-rails, mysql.sock

从 2008 年 1 月开始运行 OS X Leopard 和 MacBook Pro。

我曾经从一个包中运行 mysql 服务器，但随后 rails 开始警告我应该从 gem 安装 mysql： gem install mysql

它不起作用，我收到以下错误消息：构建本机扩展。这可能需要一段时间... 错误：安装 mysql 时出错：错误：无法构建 gem 原生扩展。

/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb 安装 mysql 检查 -lmysqlclient 中的 mysql_query() ... 不检查 -lm 中的 main() ... 是检查对于 -lmysqlclient 中的 mysql_query() ... 不检查 -lz 中的 main() ... 是 ... snip ... Gem 文件将继续安装在 /Library/Ruby/Gems/1.8/gems/mysql-2.7 中供检查。

## 结果记录到 /Library/Ruby/Gems/1.8/gems/mysql-2.7/gem_make.out

然后我根据朋友的建议尝试了另一种方法，并尝试按照[http://hivelogic.com/articles/2007/11/installing-mysql-on-mac-os-x](http://hivelogic.com/articles/2007/11/installing-mysql-on-mac-os-x)上的出色说明进行操作， 但现在遇到了新的尝试运行“mysql -u root”时出现问题

我得到的信息是：

## ERROR 2002 (HY000): 无法通过套接字 '/tmp/mysql.sock' 连接到本地 MySQL 服务器 (2)

我已经用谷歌搜索了我的心，试图解决这两个问题并感到卡住了。感谢阅读和帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-25T11:20:48.693

对于第一个问题 - 我想 Ruby gem 正在安装 ruby​​ MySQL 接口/驱动程序，而不是 MySQL 服务器本身。它可能不存在，或者在标准脚本找不到的地方。

第二条消息表明 MySQL 服务器没有运行。尝试再次启动它，或检查任何日志/消息以获取有关它可能无法启动的一些迹象

# windows - IE6 + IE7 在干净的 XP 安装上

> ID：132588
> 
> 赞同：4
> 
> 时间：2008-09-25T10:54:51.330
> 
> 标签：windows, internet-explorer

我们需要在 IE6 和 IE7 中测试一个网站。我们已经在实际的 Windows 机器上出现了运行在 vmware 下不可见的错误（？！），所以我们有一台实际的 Windows 笔记本电脑来执行此操作 - 但只有一台。是否可以并排安装 IE6 和 IE7，以使它们绝对、肯定地表现得与只有其中一个时完全一样？如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T11:14:14.060

官方认可的方式是使用微软提供的 Virtual PC 安装和 VPC 镜像。您不需要额外的 Windows 许可证来运行这些。

[http://blogs.msdn.com/ie/archive/2006/11/30/ie6-and-ie7-running-on-a-single-machine.aspx](http://blogs.msdn.com/ie/archive/2006/11/30/ie6-and-ie7-running-on-a-single-machine.aspx)

[http://www.microsoft.com/downloads/details.aspx?FamilyId=6D58729D-DFA8-40BF-AFAF-20BCB7F01CD1&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=6D58729D-DFA8-40BF-AFAF-20BCB7F01CD1&displaylang=en)

[http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T11:01:02.233

看看[http://tredosoft.com/Multiple_IE](http://tredosoft.com/Multiple_IE)。[请记住，Microsoft ( http://blogs.msdn.com/cwilso/archive/2006/02/01/522281.aspx](http://blogs.msdn.com/cwilso/archive/2006/02/01/522281.aspx) )不支持并排运行，并且不能保证它们绝对可以正常工作顺便说一句 - Windows 更新很容易破坏某些东西，有时人们会发现条件注释不能正常工作。我只能建议你试一试，看看你的进展如何。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T11:22:48.750

如果您可以在 Web 上发布您的页面，您可以尝试[http://browsershots.org/](http://browsershots.org/) 当我必须使用地球上几乎所有浏览器测试新布局时，我总是使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T10:56:49.810

我发现唯一真正可靠的方法是使用 Virtual PC 并在其上有一个带有 IE6 的图像，多个 IE 或 IETester 并不总是与原始版本完全相同

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T18:30:21.563

Virtual PC 2007 是 VPC 的最新版本。如果您运行的是 Windows Vista，则应使用较新的版本。Vista 不支持 VPC 2004。

[Virtual PC 2007 SP1 的下载页面](http://www.microsoft.com/downloads/details.aspx?FamilyId=28C97D22-6EB8-4A09-A7F7-F6C7A1F000B5&displaylang=en)

[Microsoft Virtual VPC 主页](http://www.microsoft.com/windows/products/winfamily/virtualpc/default.mspx)，您可以在其中找到最新版本的 VPC

# java - Web 服务可以返回流吗？

> ID：132590
> 
> 赞同：28
> 
> 时间：2008-09-25T10:55:38.177
> 
> 标签：java, web-services, cxf

我一直在写一个小应用程序，它可以让人们上传和下载文件给我。我已经向这个应用程序添加了一个 Web 服务，以这种方式提供上传/下载功能，但我不太确定我的实现将如何处理大文件。

目前上传和下载方法的定义如下所示（使用 Apache CXF 编写）：

```
boolean uploadFile(@WebParam(name = "username") String username,
    @WebParam(name = "password") String password,
    @WebParam(name = "filename") String filename,
    @WebParam(name = "fileContents") byte[] fileContents)
    throws UploadException, LoginException;

byte[] downloadFile(@WebParam(name = "username") String username,
    @WebParam(name = "password") String password,
    @WebParam(name = "filename") String filename) throws DownloadException,
    LoginException; 
```

所以文件被上传和下载为一个字节数组。但是，如果我有一个大小愚蠢的文件（例如 1GB），这肯定会尝试将所有这些信息放入内存中并使我的服务崩溃。

所以我的问题是 - 是否可以返回某种流？我想这不会非常独立于操作系统。虽然我知道 Web 服务背后的理论，但我仍然需要了解一些实际信息。

为任何输入干杯，李

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-25T11:02:25.617

是的，Metro 可以。请参阅[大型附件](https://metro.java.net/guide/ch06.html#large-attachments)示例，它看起来像您想要的那样。

> JAX-WS RI 支持以流方式发送和接收大型附件。
> 
> *   在编程模型中使用 MTOM 和 DataHandler。
> *   将 DataHandler 转换为 StreamingDataHandler 并使用其方法。
> *   确保调用 StreamingDataHandler.close() 并关闭 StreamingDataHandler.readOnce() 流。
> *   在客户端启用 HTTP 分块。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T10:59:16.950

[Stephen Denne](https://stackoverflow.com/q/132618/16800)有一个满足您要求的 Metro 实现。在简要说明为什么会出现这种情况后，我在下面提供了答案。

大多数使用 HTTP 作为消息协议构建的 Web 服务实现都与 REST 兼容，因为它们只允许简单的发送-接收模式，仅此而已。这极大地提高了互操作性，因为所有各种平台都可以理解这种简单的架构（例如，Java Web 服务与 .NET Web 服务通信）。

如果你想保持这一点，你可以提供分块。

```
boolean uploadFile(String username, String password, String fileName, int currentChunk, int totalChunks, byte[] chunk); 
```

如果您没有以正确的顺序获得块（或者您可以只要求块以正确的顺序出现），这将需要一些步法，但这可能很容易实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T11:05:41.693

当您使用标准化的 Web 服务时，发送方和接收方确实依赖于从一方发送到另一方的 XML 数据的完整性。这意味着 Web 服务请求和应答仅在发送最后一个标签时才完成。考虑到这一点，Web 服务不能被视为流。

这是合乎逻辑的，因为标准化的 Web 服务确实依赖于 http 协议。那个是“无状态的”，会说它的工作方式类似于“打开连接......发送请求......接收数据......关闭请求”。无论如何，连接将在最后关闭。所以像流这样的东西不打算在这里使用。或者他在 http 之上分层（如 Web 服务）。

很抱歉，但据我所知，不可能在网络服务中进行流式传输。更糟糕的是：根据 Web 服务的实现/配置，byte[] - 数据可能会被转换为 Base64 而不是 CDATA-tag，并且请求可能会变得更加臃肿。

PS：是的，正如其他人所写，“chuinking”是可能的。但这不是流式传输；-) - 无论如何，它可能会对您有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T11:59:27.740

对于 WCF，我认为可以将消息上的成员定义为流并适当地设置绑定 - 我已经看到 wcf 与 Java Web 服务对话的这项工作。

您需要在 httpTransport 配置中设置 transferMode="StreamedResponse" 并使用 mtomMessageEncoding（需要在配置中使用自定义绑定部分）。

我认为一个限制是，如果你想流式传输，你只能拥有一个消息正文成员（哪种有意义）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-23T11:21:10.403

[Apache CXF](https://cxf.apache.org/)支持发送和接收流。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-14T16:12:02.803

对于那些认为不可能提供流式 Web 服务的人，我不想打破它，但实际上，所有 http 请求都是基于流的。每个对网站执行 GET 的浏览器都是基于流的。对 Web 服务的每次调用都是基于流的。是的，所有。我们在实现服务或页面的级别上没有注意到这一点，因为较低级别的架构正在为您处理 - 但它正在完成。

您是否曾经在浏览器中注意到有时可能需要一段时间才能获取一个页面 - 浏览器只是不停地显示沙漏？那是因为浏览器正在等待流。

流是必须在实际数据之前发送 mime/types 的原因——它只是一个字节流到浏览器，如果你不先告诉它它是什么，它就无法识别照片。这也是为什么您必须在发送之前传递二进制文件的大小 - 浏览器将无法判断图像在哪里停止并且页面再次拾取。

对客户端来说，这只是一个字节流。如果您想自己证明这一点，只需在处理请求的任何时候获取输出流并关闭（）它。你会炸毁一切。浏览器将立即停止显示沙漏，并显示“找不到”或“服务器连接重置”或其他类似消息。

很多人不知道所有这些东西都是基于流的，这表明有多少东西已经分层。有些人会说太多的话——我就是其中之一。

祝你好运，快乐发展——放松肩膀！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T11:02:25.523

一种方法是添加一个**uploadFileChunk** (byte[] chunkData, int size, int offset, int totalSize) 方法（或类似的方法），该方法上传部分文件，然后服务器将其写入磁盘。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T11:06:13.720

请记住，Web 服务请求基本上可以归结为单个 HTTP POST。

如果您查看 .NET 中的 .ASMX 文件的输出，它会准确显示 POST 请求和响应的样子。

正如@Guvante 所提到的，分块将是最接近你想要的东西。

我想您可以实现自己的 Web 客户端代码来处理 TCP/IP 并将内容流式传输到您的应用程序中，但这至少可以说是复杂的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T11:13:38.913

我认为使用简单的[servlet](http://commons.apache.org/fileupload/streaming.html)来完成这项任务会更容易，或者有什么理由不能使用 servlet？

例如，您可以使用[Commons](http://commons.apache.org/fileupload/)开源库。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T11:59:14.810

Java的[RMIIO](http://openhms.sourceforge.net/rmiio/)库提供了跨 RMI 处理 RemoteInputStream - 我们只需要 RMI，尽管您应该能够调整代码以在其他类型的 RMI 上工作。这可能对您有所帮助——特别是如果您可以在用户端拥有一个小型应用程序。开发该库的明确目的是能够限制推送到服务器的数据大小，以避免您描述的那种情况 - 通过填满 ram 或磁盘有效地进行 DOS 攻击。

使用 RMIIO 库，服务器端可以决定它愿意提取多少数据，使用 HTTP PUT 和 POST，客户端可以做出决定，包括它推送的速率。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-08-08T15:39:23.240

是的，网络服务可以进行流式传输。我使用 Apache Axis2 和 MTOM 创建了一个 Web 服务，以支持从 XML 呈现 PDF 文档。由于生成的文件可能非常大，因此流式传输很重要，因为我们不想将其全部保存在内存中。查看 Oracle 关于[流式 SOAP 附件的文档。](http://download.oracle.com/docs/cd/E12840_01/wls/docs103/webserv_adv/mtom.html)

或者，您可以自己做，tomcat 将创建 Chunked 标头。这是流式传输的弹簧控制器功能的示例。

```
 @RequestMapping(value = "/stream")
        public void hellostreamer(HttpServletRequest request, HttpServletResponse response) throws CopyStreamException, IOException  
{

            response.setContentType("text/xml");
            OutputStreamWriter writer = new OutputStreamWriter (response.getOutputStream());
            writer.write("this is streaming");
            writer.close();

    } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-04-02T19:02:16.930

“处理 TCP/IP 并将内容流式传输到您的应用程序中”实际上并不难。试试这个...

```
class MyServlet extends HttpServlet
{
    public void doGet(HttpServletRequest request, HttpServletResponse response)
    {
        response.getOutputStream().println("Hello World!");
    }
} 
```

这就是它的全部。在上面的代码中，您已经响应了从浏览器发送的 HTTP GET 请求，并向该浏览器返回了文本“Hello World！”。

请记住“Hello World！” 不是有效的 HTML，因此您最终可能会在浏览器上遇到错误，但这确实是它的全部。

祝您发展顺利！

罗德尼

# c# - 如何在 C# 中实现 const 正确性？

> ID：132592
> 
> 赞同：11
> 
> 时间：2008-09-25T10:56:07.957
> 
> 标签：c#, c++, const-correctness

> **可能重复：**
> [C# 中的“const 正确性”](https://stackoverflow.com/questions/114149/const-correctness-in-c-sharp)

我已经编写 C++ 多年，但对 C# 还是很陌生。在学习 C# 时，我发现[const](http://en.csharp-online.net/const,_static_and_readonly)关键字的使用比在 C++ 中要受限得多。AFAIK，[例如](http://andymcm.com/csharpfaq.htm#6.8)，没有办法向函数 const 声明参数。我对我可能会无意中更改我只能通过测试检测到的函数参数（可能是复杂的数据结构）的想法感到不舒服。

你如何处理这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T10:59:08.947

Stan Lippman 有一篇关于这个问题的优秀博客文章：[A question of const](http://blogs.msdn.com/slippman/archive/2004/01/22/61712.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T11:06:34.407

如果重要，我会使用不可变对象。或者，至少，我使用我的属性设置器中的逻辑。

# java - War 文件的 Maven 依赖项排除，但包含测试

> ID：132597
> 
> 赞同：2
> 
> 时间：2008-09-25T10:57:12.837
> 
> 标签：java, deployment, maven-2

我有一个用于 Web 服务的 Maven POM 文件。对于其中一个依赖项，我必须为 jar 文件指定几个排除项，这些 jar 文件已经保存在 Web 应用程序服务器的更高级别（所有 Web 应用程序都可以访问，而不仅仅是这个特定的）。这种排除的一个示例是包含我的 JDBC 驱动程序的 JAR。

示例（带有虚构细节）：

```
<dependency>
    <groupId>mygroup</groupId>
     <artifactId>myartifact</artifactId>
     <version>1.0.0</version>
     <exclusions>
         <!--The jdbc driver causes hot-deployment issues-->
         <exclusion>
             <groupId>db.drivers</groupId>
             <artifactId>jdbc</artifactId>
         </exclusion>
     </exclusions>
 </dependency> 
```

我遇到的问题是我的测试需要 JDBC 驱动程序。我的测试目前失败，因为它们无法加载 JDBC 驱动程序。

如何配置 POM，以便我的测试可以访问排除的部分，但不包含在我的 WAR 文件中？

**更新：**我无法对 mygroup.myartifact 的 POM 进行更改，因为它被许多其他项目所依赖，并且此排除要求对于我的项目来说是独一无二的。

**更新 2：**看来我在这个问题的措辞上做得很差。Lars 下面的解决方案非常适合一个排除项（如示例所示），但是在我的实际场景中，我有多个排除项，并且为每个排除项添加额外的依赖项似乎很臭。似乎可行的解决方案是将显示的依赖项的范围设置为*编译*，然后创建第二个依赖项，该依赖项是相同的工件（mygroup.myartifact），没有排除项，范围设置为*test*。由于 Lars 既正确回答了我措辞不佳的问题，也将我引向了实际解决方案的方向，因此我将他的回复标记为答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T11:08:48.503

在依赖项中使用“范围”标签。

```
<scope>test</scope> 
```

[http://maven.apache.org/pom.html#Dependencies](http://maven.apache.org/pom.html#Dependencies)

编辑：如果我正确理解您的配置，您需要添加的 scope=test 应该添加到 mygroup.myartifact POM 中。这样，您可以使用包含的 jdbc jar 测试该工件，但总是当其他 POMS 想要包含 mygroup.myartifact 时，它们不会将 jdbc 作为传递依赖项包含在内。

第二次编辑：好的，如果您不控制要包含的 POM - 像您已经完成的那样进行排除，然后将 jdbc 添加为新依赖项，范围 = test。

# c# - 使用 HttpModule 处理异常

> ID：132607
> 
> 赞同：5
> 
> 时间：2008-09-25T11:00:22.190
> 
> 标签：c#, asp.net, exception-handling, httpmodule

我们正在审查该公司的一个系统的异常处理，并发现了一些有趣的事情。

大多数代码块（如果不是全部）都在 try/catch 块内，并且在 catch 块内抛出了一个新的 BaseApplicationException - 这似乎来自企业库。我在这里有点麻烦，因为我看不到这样做的好处。（任何时候发生异常都会抛出另一个异常）其中一位已经使用该系统一段时间的开发人员说这是因为该类负责发布异常（发送电子邮件和类似的东西），但他不太确定。在花了一些时间浏览代码之后，我很有信心地说，它所做的就是收集有关环境的信息，而不是发布它。

我的问题是： - 将所有代码包装在 try { } catch { } 块中而不是抛出新异常是否合理？如果是，为什么？有什么好处？

我个人的看法是，使用 HttpModule，注册 Application 事件的 Error 事件，并在模块内做必要的事情会容易得多。如果我们沿着这条路走，我们会错过什么吗？有什么缺点吗？

非常感谢您的意见。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T12:35:48.357

**从不**¹ `catch (Exception ex)`。^(第 2)期。您无法处理可能捕获的所有不同类型的错误。

如果您无法处理或提供额外信息（供后续异常处理程序使用），切勿^(3捕获异常派生类型。)显示错误消息**与***处理*错误不同。

从我的头顶来看，有几个原因：

*   捕捉和重新投掷是昂贵的
*   你最终会丢失堆栈跟踪
*   您的代码中的信噪比较低

如果您知道如何处理**特定**异常（并将应用程序重置为错误前状态），请捕获它。（这就是为什么它被称为*异常* ***处理***。）

要处理未捕获的异常，请侦听适当的事件。在使用 WinForms 时，您需要倾听`System.AppDomain.CurrentDomain.UnhandledException`，并且 - 如果您这样做`Threading`-`System.Windows.Forms.Application.ThreadException.`对于 Web 应用程序，也有类似的机制 ( `System.Web.HttpApplication.Error`)。

至于在您的应用程序（非）特定异常（即`throw new MyBaseException(ex);`）中包装框架异常：完全没有意义，而且气味难闻。⁴

* * *

***编辑***

¹ *Never*是一个非常苛刻的词，尤其是在工程方面，正如@Chris 在评论中指出的那样。当我第一次写这个答案时，我承认我的原则很高。

^(2,3)见¹。

⁴ If you don't bring anything new to the table, I still stand by this. If you have caught `Exception ex` as part of a method that you know could fail in any number of ways, I believe that the current method should reflect that in it's signature. And as you know, exceptions is not part of the method signature.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T12:07:26.833

如果我正确地阅读了这个问题，我会说实现一个 try / catch 来拦截异常（你没有提到 - 它是捕获所有异常，还是只捕获一个特定的异常？）并抛出不同的异常通常是一件坏事.

## 缺点：

至少你会丢失堆栈跟踪信息——你将看到的堆栈只会扩展到引发新异常的方法——你可能会在这里丢失一些好的调试信息。

如果您正在捕获异常，您将面临掩盖关键异常的风险，例如带有不太关键的异常的 OutOfMemory 或 StackOverflow，从而使进程继续运行，而它可能应该被拆除。

## 可能的优势：

在某些非常特殊的情况下，您可以采用一个没有太多调试价值的异常（例如从数据库返回的一些异常），并用一个添加更多上下文的异常进行包装，例如您正在处理的对象的 id。

然而，在几乎所有情况下，这是一种难闻的气味，应谨慎使用。

通常，只有在您可以在该位置执行一些现实的事情时，您才应该捕获异常——即恢复、回滚、执行 B 计划等。如果您对此无能为力，就让它沿着链条向上传递. 只有在该位置有特定且有用的数据可以增加原始异常并因此有助于调试时，您才应该捕获并抛出一个新异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T11:54:55.350

我来自思想流派，应该使用 try/catch 块并且不会重新抛出异常。如果您执行的代码可能会出错，那么应该对其进行处理、记录并返回一些内容。重新抛出异常仅用于在应用程序生命周期的后期重新登录。

这是一篇关于如何使用 HttpModule 处理异常的有趣帖子：http: [//blogs.msdn.com/rahulso/archive/2008/07/13/how-to-use-httpmodules-to-troubleshoot-your-asp- net-application.aspx](http://blogs.msdn.com/rahulso/archive/2008/07/13/how-to-use-httpmodules-to-troubleshoot-your-asp-net-application.aspx)和[http://blogs.msdn.com/rahulso/archive/2008/07/18/asp-net-how-to-write-error-messages-into-a-text-file-using-一个简单的httpmodule.aspx](http://blogs.msdn.com/rahulso/archive/2008/07/18/asp-net-how-to-write-error-messages-into-a-text-file-using-a-simple-httpmodule.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T11:58:26.590

查看[ELMAH](http://code.google.com/p/elmah/)。它做你所说的。很好。

当我创建库时，我尝试始终为调用者提供减少数量的异常来处理。例如，考虑一个连接到 sql 数据库的 Repository 组件。理论上可以抛出大量异常，从 sql 客户端异常到无效转换异常。其中许多都有明确的文档记录，可以在编译时进行说明。因此，我尽可能多地捕获它们，将它们放在一个异常类型中，例如 RepositoryException，然后让该异常汇总调用堆栈。

原始异常被保留，因此可以诊断原始异常。但是我的调用者只需要担心处理单个异常类型，而不是用大量不同的 catch 块乱扔他们的代码。

当然，这也存在一些问题。最值得注意的是，如果调用者可以处理其中一些异常，他们必须在 RepositoryException 中找到根，然后打开内部异常的类型来处理它。它不如为单个异常类型使用单个 catch 块干净。不过，我认为这不是什么大问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T12:00:59.937

听起来抛出的异常不应该作为异常实现。

无论如何，我会说，因为这个 BaseApplicationException 是一个通用的通用异常，所以最好抛出更特定于上下文的异常。因此，当您尝试从数据库中检索实体时，您可能需要 EntityNotFoundException。这样，当您调试时，您不必搜索内部异常和堆栈跟踪来找到真正的问题。如果此 BAseApplicationException 正在收集有关异常的信息（例如跟踪内部异常），那么这应该不是问题。

只有当我无法更接近代码中实际发生异常的位置时，我才会使用 HttpModule。您并不真正想要一个 HttModule OnError 事件，它是一个巨大的 switch 语句，具体取决于 BaseApplicationexception 的错误信息。

总而言之，当您可以给出更具体的异常来立即告诉您问题的根源时，抛出不同的异常是值得的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T12:02:34.910

根据我的经验，捕获异常，将错误添加到 Server (?) 对象。这将允许 .NET 做它需要做的任何事情，然后显示你的异常。

# .net - 显示 ContextMenuStrip 而不在任务栏中显示

> ID：132612
> 
> 赞同：7
> 
> 时间：2008-09-25T11:01:08.723
> 
> 标签：.net, c++, winforms

我发现，当我为 contextmenustrip（右键单击菜单）执行 show() 方法时，如果位置超出了它所属的表单的位置，它也会显示在任务栏上。

我正在尝试在单击通知图标时创建一个右键单击菜单，但是由于菜单悬停在系统托盘上方而不是在表单内（因为右键单击时可以最小化表单）它会显示在任务栏上一些奇怪的原因

这是我目前的代码：

```
private: System::Void notifyIcon1_MouseClick(System::Object^  sender, System::Windows::Forms::MouseEventArgs^  e) {

if(e->Button == System::Windows::Forms::MouseButtons::Right) {

        this->sysTrayMenu->Show(Cursor->Position);

    }
} 
```

我需要设置哪些其他选项，以便它不会在任务栏上显示空白进程。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T12:10:58.337

尝试将您的菜单分配给 NotifyIcon 的 ContextMenuStrip 属性，而不是在鼠标单击处理程序中显示它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-28T10:15:51.497

没有反射的最好和正确的方法是：

```
{
  UnsafeNativeMethods.SetForegroundWindow(new HandleRef(notifyIcon.ContextMenuStrip, notifyIcon.ContextMenuStrip.Handle));
  notifyIcon.ContextMenuStrip.Show(Cursor.Position);
} 
```

其中**UnsafeNativeMethods.SetForegroundWindow**是：

```
public static class UnsafeNativeMethods
{
  [DllImport("user32.dll", CharSet = CharSet.Auto, ExactSpelling = true)]
  public static extern bool SetForegroundWindow(HandleRef hWnd);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-15T15:54:32.487

假设您有 2 个上下文菜单项：`ContextMenuLeft`和`ContextMenuRight`. 默认情况下，您已经从 NotifyIcon 属性中分配了其中一个。在调用之前`Left Button Click`，只需更改它们，显示上下文菜单，然后再次更改它们。

```
NotifyIcon.ContextMenuStrip = ContextMenuLeft; //let's asign the other one
MethodInfo mi = typeof(NotifyIcon).GetMethod("ShowContextMenu", BindingFlags.Instance | BindingFlags.NonPublic);
mi.Invoke(NotifyIcon, null);
NotifyIcon.ContextMenuStrip = ContextMenuRight; //switch back to the default one 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-07T03:53:00.673

我遇到的问题是我的菜单可以通过双击*和*通知图标获得。

右键单击通知图标时，没有任务栏按钮，但是当我手动 Show(Cursor.Position) 时，它会显示一个任务栏按钮。

# c# - 如何在 .NET 中检索已登录/已连接用户的列表？

> ID：132620
> 
> 赞同：32
> 
> 时间：2008-09-25T11:02:36.723
> 
> 标签：c#, .net, windows-services, login

这是场景：

您有一个 Windows 服务器，用户通过 RDP 远程连接到该服务器。您希望您的程序（作为服务运行）知道当前连接的用户。这可能包括也可能不包括交互式控制台会话。

请注意，这**与**仅检索当前交互式用户不同。

我猜有某种对终端服务的 API 访问来获取这些信息？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-25T11:42:51.633

这是我对这个问题的看法：

```
using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;

namespace EnumerateRDUsers
{
  class Program
  {
    [DllImport("wtsapi32.dll")]
    static extern IntPtr WTSOpenServer([MarshalAs(UnmanagedType.LPStr)] string pServerName);

    [DllImport("wtsapi32.dll")]
    static extern void WTSCloseServer(IntPtr hServer);

    [DllImport("wtsapi32.dll")]
    static extern Int32 WTSEnumerateSessions(
        IntPtr hServer,
        [MarshalAs(UnmanagedType.U4)] Int32 Reserved,
        [MarshalAs(UnmanagedType.U4)] Int32 Version,
        ref IntPtr ppSessionInfo,
        [MarshalAs(UnmanagedType.U4)] ref Int32 pCount);

    [DllImport("wtsapi32.dll")]
    static extern void WTSFreeMemory(IntPtr pMemory);

    [DllImport("wtsapi32.dll")]
    static extern bool WTSQuerySessionInformation(
        IntPtr hServer, int sessionId, WTS_INFO_CLASS wtsInfoClass, out IntPtr ppBuffer, out uint pBytesReturned);

    [StructLayout(LayoutKind.Sequential)]
    private struct WTS_SESSION_INFO
    {
      public Int32 SessionID;

      [MarshalAs(UnmanagedType.LPStr)]
      public string pWinStationName;

      public WTS_CONNECTSTATE_CLASS State;
    }

    public enum WTS_INFO_CLASS
    {
      WTSInitialProgram,
      WTSApplicationName,
      WTSWorkingDirectory,
      WTSOEMId,
      WTSSessionId,
      WTSUserName,
      WTSWinStationName,
      WTSDomainName,
      WTSConnectState,
      WTSClientBuildNumber,
      WTSClientName,
      WTSClientDirectory,
      WTSClientProductId,
      WTSClientHardwareId,
      WTSClientAddress,
      WTSClientDisplay,
      WTSClientProtocolType
    }

    public enum WTS_CONNECTSTATE_CLASS
    {
      WTSActive,
      WTSConnected,
      WTSConnectQuery,
      WTSShadow,
      WTSDisconnected,
      WTSIdle,
      WTSListen,
      WTSReset,
      WTSDown,
      WTSInit
    }

    static void Main(string[] args)
    {
      ListUsers(Environment.MachineName);
    }

    public static void ListUsers(string serverName)
    {
      IntPtr serverHandle = IntPtr.Zero;
      List<string> resultList = new List<string>();
      serverHandle = WTSOpenServer(serverName);

      try
      {
        IntPtr sessionInfoPtr = IntPtr.Zero;
        IntPtr userPtr = IntPtr.Zero;
        IntPtr domainPtr = IntPtr.Zero;
        Int32 sessionCount = 0;
        Int32 retVal = WTSEnumerateSessions(serverHandle, 0, 1, ref sessionInfoPtr, ref sessionCount);
        Int32 dataSize = Marshal.SizeOf(typeof(WTS_SESSION_INFO));
        IntPtr currentSession = sessionInfoPtr;
        uint bytes = 0;

        if (retVal != 0)
        {
          for (int i = 0; i < sessionCount; i++)
          {
            WTS_SESSION_INFO si = (WTS_SESSION_INFO)Marshal.PtrToStructure((System.IntPtr)currentSession, typeof(WTS_SESSION_INFO));
            currentSession += dataSize;

            WTSQuerySessionInformation(serverHandle, si.SessionID, WTS_INFO_CLASS.WTSUserName, out userPtr, out bytes);
            WTSQuerySessionInformation(serverHandle, si.SessionID, WTS_INFO_CLASS.WTSDomainName, out domainPtr, out bytes);

            Console.WriteLine("Domain and User: " + Marshal.PtrToStringAnsi(domainPtr) + "\\" + Marshal.PtrToStringAnsi(userPtr));

            WTSFreeMemory(userPtr); 
            WTSFreeMemory(domainPtr);
          }

          WTSFreeMemory(sessionInfoPtr);
        }
      }
      finally
      {
        WTSCloseServer(serverHandle);
      }

    }

  }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-01T01:56:05.263

如果您不想自己处理 P/Invokes，另一种选择是使用[Cassia](https://github.com/danports/cassia)库：

```
using System;
using System.Security.Principal;
using Cassia;

namespace CassiaSample
{
    public static class Program
    {
        public static void Main(string[] args)
        {
            ITerminalServicesManager manager = new TerminalServicesManager();
            using (ITerminalServer server = manager.GetRemoteServer("your-server-name"))
            {
                server.Open();
                foreach (ITerminalServicesSession session in server.GetSessions())
                {
                    NTAccount account = session.UserAccount;
                    if (account != null)
                    {
                        Console.WriteLine(account);
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-25T11:17:43.490

好的，我自己的问题的一种解决方案。

您可以使用 WMI 检索正在运行的进程的列表。您还可以查看这些进程的所有者。如果您查看“explorer.exe”的所有者（并删除重复项），您最终应该会得到一个登录用户列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T11:23:47.843

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;

namespace TerminalServices
{
    class TSManager
    {
    [DllImport("wtsapi32.dll")]
    static extern IntPtr WTSOpenServer([MarshalAs(UnmanagedType.LPStr)] String pServerName);

    [DllImport("wtsapi32.dll")]
    static extern void WTSCloseServer(IntPtr hServer);

    [DllImport("wtsapi32.dll")]
    static extern Int32 WTSEnumerateSessions(
        IntPtr hServer, 
        [MarshalAs(UnmanagedType.U4)] Int32 Reserved,
        [MarshalAs(UnmanagedType.U4)] Int32 Version, 
        ref IntPtr ppSessionInfo,
        [MarshalAs(UnmanagedType.U4)] ref Int32 pCount);

    [DllImport("wtsapi32.dll")]
    static extern void WTSFreeMemory(IntPtr pMemory);

    [StructLayout(LayoutKind.Sequential)]
    private struct WTS_SESSION_INFO
    {
        public Int32 SessionID;

        [MarshalAs(UnmanagedType.LPStr)]
        public String pWinStationName;

        public WTS_CONNECTSTATE_CLASS State;
    }

    public enum WTS_CONNECTSTATE_CLASS
    {
        WTSActive,
        WTSConnected,
        WTSConnectQuery,
        WTSShadow,
        WTSDisconnected,
        WTSIdle,
        WTSListen,
        WTSReset,
        WTSDown,
        WTSInit
    } 

    public static IntPtr OpenServer(String Name)
    {
        IntPtr server = WTSOpenServer(Name);
        return server;
    }
    public static void CloseServer(IntPtr ServerHandle)
    {
        WTSCloseServer(ServerHandle);
    }
    public static List<String> ListSessions(String ServerName)
    {
        IntPtr server = IntPtr.Zero;
        List<String> ret = new List<string>();
        server = OpenServer(ServerName);

        try
        {
        IntPtr ppSessionInfo = IntPtr.Zero;

        Int32 count = 0;
        Int32 retval = WTSEnumerateSessions(server, 0, 1, ref ppSessionInfo, ref count);
        Int32 dataSize = Marshal.SizeOf(typeof(WTS_SESSION_INFO));

        Int32 current = (int)ppSessionInfo;

        if (retval != 0)
        {
            for (int i = 0; i < count; i++)
            {
            WTS_SESSION_INFO si = (WTS_SESSION_INFO)Marshal.PtrToStructure((System.IntPtr)current, typeof(WTS_SESSION_INFO));
            current += dataSize;

            ret.Add(si.SessionID + " " + si.State + " " + si.pWinStationName);
            }

            WTSFreeMemory(ppSessionInfo);
        }
        }
        finally
        {
        CloseServer(server);
        }

        return ret;
    }
    }
} 
```

# asp.net - 将 ListItems 从通用列表添加到 DropDownList

> ID：132643
> 
> 赞同：10
> 
> 时间：2008-09-25T11:09:42.680
> 
> 标签：asp.net, drop-down-menu, listitem

我有一个这个 aspx 代码：（示例）

```
<asp:DropDownList runat="server" ID="ddList1"></asp:DropDownList> 
```

有了这个代码隐藏：

```
List<System.Web.UI.WebControls.ListItem> colors = new List<System.Web.UI.WebControls.ListItem>();
colors.Add(new ListItem("Select Value", "0"));
colors.Add(new ListItem("Red", "1"));
colors.Add(new ListItem("Green", "2"));
colors.Add(new ListItem("Blue", "3"));
ddList1.DataSource = colors;
ddList1.DataBind(); 
```

输出如下所示：

```
<select name="ddList1" id="ddList1">
    <option value="Select Value">Select Value</option>
    <option value="Red">Red</option>
    <option value="Green">Green</option>
    <option value="Blue">Blue</option>
</select> 
```

我的问题是：为什么我的值（数字）消失了，文本用作值和文本？我知道如果我使用该`ddList1.Items.Add(New ListItem("text", "value"))`方法它可以工作，但出于其他原因我需要使用通用列表作为数据源。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T11:12:59.147

因为 DataBind 方法仅在设置了 DataValueField 属性时才绑定值。如果在调用 DataBind 之前将 DataValueField 属性设置为“Value”，则您的值将出现在标记上。

更新：您还需要将 DataTextField 属性设置为“文本”。这是因为数据绑定和手动添加项目的工作方式不同。数据绑定不知道 ListItem 类型的存在，并通过评估数据源中的项目来生成标记。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T11:30:26.423

这是执行数据绑定的方法。您可以准确地看到发生了什么：

```
protected internal override void PerformDataBinding(IEnumerable dataSource)
{
    base.PerformDataBinding(dataSource);
    if (dataSource != null)
    {
        bool flag = false;
        bool flag2 = false;
        string dataTextField = this.DataTextField;
        string dataValueField = this.DataValueField;
        string dataTextFormatString = this.DataTextFormatString;
        if (!this.AppendDataBoundItems)
        {
            this.Items.Clear();
        }
        ICollection is2 = dataSource as ICollection;
        if (is2 != null)
        {
            this.Items.Capacity = is2.Count + this.Items.Count;
        }
        if ((dataTextField.Length != 0) || (dataValueField.Length != 0))
        {
            flag = true;
        }
        if (dataTextFormatString.Length != 0)
        {
            flag2 = true;
        }
        foreach (object obj2 in dataSource)
        {
            ListItem item = new ListItem();
            if (flag)
            {
                if (dataTextField.Length > 0)
                {
                    item.Text = DataBinder.GetPropertyValue(obj2, dataTextField, dataTextFormatString);
                }
                if (dataValueField.Length > 0)
                {
                    item.Value = DataBinder.GetPropertyValue(obj2, dataValueField, null);
                }
            }
            else
            {
                if (flag2)
                {
                    item.Text = string.Format(CultureInfo.CurrentCulture, dataTextFormatString, new object[] { obj2 });
                }
                else
                {
                    item.Text = obj2.ToString();
                }
                item.Value = obj2.ToString();
            }
            this.Items.Add(item);
        }
    }
    if (this.cachedSelectedValue != null)
    {
        int num = -1;
        num = this.Items.FindByValueInternal(this.cachedSelectedValue, true);
        if (-1 == num)
        {
            throw new ArgumentOutOfRangeException("value", SR.GetString("ListControl_SelectionOutOfRange", new object[] { this.ID, "SelectedValue" }));
        }
        if ((this.cachedSelectedIndex != -1) && (this.cachedSelectedIndex != num))
        {
            throw new ArgumentException(SR.GetString("Attributes_mutually_exclusive", new object[] { "SelectedIndex", "SelectedValue" }));
        }
        this.SelectedIndex = num;
        this.cachedSelectedValue = null;
        this.cachedSelectedIndex = -1;
    }
    else if (this.cachedSelectedIndex != -1)
    {
        this.SelectedIndex = this.cachedSelectedIndex;
        this.cachedSelectedIndex = -1;
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T11:34:20.190

如果您正在构建 ListItems，则无需首先使用 DataBind()。

只需将它们添加到您的 DropDownList 中：

```
 ddList1.Items.Add(new ListItem("Select Value", "0"));
ddList1.Items.Add(new ListItem("Red", "1"));
ddList1.Items.Add(new ListItem("Green", "2"));
ddList1.Items.Add(new ListItem("Blue", "3")); 
```

当您已经有一个可以用作数据源的集合/数据对象（通常是 DataTable 或 DataView）时，DataBind() 很有用，方法是设置 DataTextField 和 DataValueField（如 buyutec 所写）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T10:41:03.203

“如果你正在构建 ListItems，你首先不需要使用 DataBind()。”

直接添加到下拉列表是一种简单的方法（并且给出了正确的示例代码）但是假设您有一个无序的数据源并且您希望对列表项进行排序。

实现此目的的一种方法是创建 ListItem 的通用列表，然后在将数据绑定到列表之前使用继承的排序方法。

给猫剥皮有很多方法...

# css - 溢出：隐藏和显示：无有什么区别

> ID：132649
> 
> 赞同：14
> 
> 时间：2008-09-25T11:11:01.697
> 
> 标签：css, overflow, hidden

溢出：隐藏和显示：无有什么区别？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-25T11:17:16.953

例子：

```
.oh
{
  height: 50px;
  width: 200px;
  overflow: hidden;
} 
```

如果这个类的块中的文本比这个小框可以显示的更大（更长），超出的部分将被隐藏。您只会看到文本的开头。

`display: none;`只会隐藏块。

请注意，您还`visibility: hidden;`隐藏了块的内容，但块仍将在布局中，四处移动。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-25T11:17:08.810

`display: none`从页面中删除元素，页面的流程就像它根本不存在一样。

`[overflow: hidden](http://www.d.umn.edu/itss/support/Training/Online/csstips/overflow.html)`：

> CSS `overflow: hidden`属性可用于根据浏览器窗口的宽度显示或多或少的元素。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-25T11:13:56.523

溢出：隐藏只是说如果文本在这个元素之外流动，滚动条就不会显示。display:none 表示该元素未显示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T11:20:03.017

溢出的简单示例：隐藏[http://www.w3schools.com/Css/tryit.asp?filename=trycss_pos_overflow_hidden](http://www.w3schools.com/Css/tryit.asp?filename=trycss_pos_overflow_hidden)

如果您在该页面上编辑 CCS，您可以看到溢出属性（可见 | 隐藏 | 滚动 | auto ）之间的区别 - 如果您将 display: none 添加到 css，您将看到整个内容块消失。

基本上它是一种控制布局和元素“流”的方式 - 如果您允许用户输入（例如来自 CMS 字段），以在固定大小的块中呈现，您可以调整溢出属性以阻止框的大小增加，因此破坏页面布局。（相反， display: none 阻止元素显示，因此整个页面重新调整）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T17:30:05.467

默认情况下，HTML 元素的高度与包含其内容的要求一样高。

如果你给一个 HTML 元素一个固定的高度，它可能不足以容纳它的内容。因此，例如，如果您有一个具有固定高度和蓝色背景的段落：

```
<p>This is an example paragraph. It has some text in it to try and give it a reasonable height. In a separate style sheet, we’re going to give it a blue background and a fixed height. If we add overflow: hidden, we won’t see any text that extends beyond the fixed height of the paragraph. Until then, the text will “overflow” the paragraph, extending beyond the blue background.</p>

p {
    background-color: #ccf;
    height: 20px;
} 
```

段落中的文本将超出段落的底部边缘。

该`overflow`属性允许您更改此默认行为。因此，如果您添加`overflow: hidden`：

```
p {
    background-color: #ccf;
    height: 20px;
    overflow: hidden;
} 
```

然后您将看不到段落底部边缘之外的任何文本。它将被剪裁到段落的固定高度。

`display: none`只会使整个段落（视觉上）消失，蓝色背景等等，就好像它根本没有出现在 HTML 中一样。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T11:16:38.110

假设您有一个`div`尺寸为 100 x 100 像素的

然后，您将一大堆文本放入其中，例如溢出 div。如果使用`overflow: hidden;`，则不会显示适合 100x100 的文本，并且不会影响布局。

`display: none`完全不同。它呈现页面的其余部分，*就好像*它`div`仍然可见一样。即使有溢出，也会被考虑在内。它只是为 留出空间`div`，但不渲染它。如果两者都设置：`display: none; overflow: hidden;`则不会显示，文本不会溢出，并且页面将呈现为好像不可见`div`的仍然存在。

为了使`div`完全不影响渲染，`display: none; overflow: hidden;`则应设置两者，并执行诸如 set 之类的操作`height: 0;`。或者使用`width`，或者两者都使用，那么页面将被呈现，就好像 div 根本不存在一样。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T11:18:57.323

display:none 表示该标签根本不会出现在页面上（尽管您仍然可以通过 dom 与它进行交互）。其他标签之间不会有空间分配给它。溢出隐藏意味着标签以一定的高度呈现，并且任何会导致标签扩展以呈现它的文本等都不会显示。我认为您要问的是可见性：隐藏。这意味着与 display none 不同，标签是不可见的，但在页面上为它分配了空间。所以例如

```
<span>test</span> | <span>Appropriate style in this tag</span> | <span>test</span> 
```

显示：无将是：

测试 | | 测试

可见性：隐藏将是：

测试 | | 测试

在可见性：隐藏标签被渲染，它只是在页面上看不到。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T11:22:27.487

溢出：隐藏 - 隐藏内容的溢出，与溢出相反：自动在固定大小的 div 上显示滚动条，其内部内容大于其大小

display: none - 隐藏一个元素，它完全不参与内容布局

PS这两者没有区别，完全不相关

# c++ - 如何禁用#pragma 警告？

> ID：132667
> 
> 赞同：50
> 
> 时间：2008-09-25T11:14:19.533
> 
> 标签：c++, warnings, pragma

在开发 C++ 应用程序时，我不得不使用第三方库，它会产生大量与正在使用的无害 #pragma 指令相关的警告。

```
../File.hpp:1: warning: ignoring #pragma ident
In file included from ../File2.hpp:47,
                 from ../File3.hpp:57,
                 from File4.h:49, 
```

使用 GNU C++ 编译器时是否可以禁用这种警告？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2008-09-25T11:30:07.517

我相信你可以编译

```
-Wno-unknown-pragmas 
```

压制这些。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-25T14:02:07.573

在 GCC 中，使用 -Wno-unknown-pragmas 编译

在 MS Visual Studio 2005 中（这个问题没有用 gcc 标记，所以我添加它以供参考），您可以在项目设置->C/C++->高级中全局禁用。在“禁用特定警告”中输入 4068

或者您可以将其添加到任何文件以在本地禁用警告

```
#pragma warning (disable : 4068 ) /* disable unknown pragma warnings */ 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-25T11:30:34.380

也许看到[GCC Diagnostic Pragmas](http://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html#Diagnostic-Pragmas)？或者，在这种情况下，您可以使用启用的[选项组合](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options)，不包括.`-Wall``-Wunknown-pragmas`

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-04-14T18:28:19.480

我知道这个问题是关于 GCC 的，但是对于希望尽可能便携的人来说：

大多数可以发出此警告的编译器都有一种方法可以从命令行（异常：PGI）或代码（异常：DMC）禁用警告：

*   海合会：`-Wno-unknown-pragmas`/`#pragma GCC diagnostic ignored "-Wunknown-pragmas"`
*   [铿锵声](https://en.wikipedia.org/wiki/Clang)：`-Wno-unknown-pragmas`/`#pragma clang diagnostic ignored "-Wunknown-pragmas"`
*   [英特尔 C/C++ 编译器](https://en.wikipedia.org/wiki/Intel_C%2B%2B_Compiler)：`-diag-disable 161`/`#pragma warning(disable:161)`
*   [PGI](https://en.wikipedia.org/wiki/The_Portland_Group#Compilers)：`#pragma diag_suppress 1675`
*   [MSVC](https://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B)：`-wd4068`/`#pragma warning(disable:4068)`
*   TI：`--diag_suppress,-pds=163`/`#pragma diag_suppress 163`
*   [IAR C/C++ 编译器](https://en.wikipedia.org/wiki/IAR_Systems#IAR_Embedded_Workbench)：`--diag_suppress Pe161`/`#pragma diag_suppress=Pe161`
*   [数字火星 C/C++ 编译器](https://en.wikipedia.org/wiki/Digital_Mars)：`-w17`
*   克雷：`-h nomessage=1234`

您可以将其中的大部分组合到一个宏中以在您的代码中使用，这就是我在[Hedley](https://nemequ.github.io/hedley/)[`HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS`](https://nemequ.github.io/hedley/api-reference.html#HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS)中为宏所做的

```
#if HEDLEY_HAS_WARNING("-Wunknown-pragmas")
#  define HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS _Pragma("clang diagnostic ignored \"-Wunknown-pragmas\"")
#elif HEDLEY_INTEL_VERSION_CHECK(16,0,0)
#  define HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS _Pragma("warning(disable:161)")
#elif HEDLEY_PGI_VERSION_CHECK(17,10,0)
#  define HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS _Pragma("diag_suppress 1675")
#elif HEDLEY_GNUC_VERSION_CHECK(4,3,0)
#  define HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS _Pragma("GCC diagnostic ignored \"-Wunknown-pragmas\"")
#elif HEDLEY_MSVC_VERSION_CHECK(15,0,0)
#  define HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS __pragma(warning(disable:4068))
#elif HEDLEY_TI_VERSION_CHECK(8,0,0)
#  define HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS _Pragma("diag_suppress 163")
#elif HEDLEY_IAR_VERSION_CHECK(8,0,0)
#  define HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS _Pragma("diag_suppress=Pe161")
#else
#  define HEDLEY_DIAGNOSTIC_DISABLE_UNKNOWN_PRAGMAS
#endif 
```

请注意，Hedley 可能拥有比此答案更完整的信息，因为我可能会忘记更新此答案，因此如果您不想只使用 Hedley（它是一个公共域 C/C++ 标头，您可以轻松放入您的项目) 您可能希望使用 Hedley 作为指南，而不是上面的信息。

版本检查可能过于悲观，但有时很难获得关于专有编译器过时版本的好信息，我宁愿安全也不愿后悔。同样，赫德利的信息可能更好。

许多编译器还可以将警告推送/弹出到堆栈上，因此您可以推送，然后在包含您无法控制的代码之前禁用它们，然后弹出，以便*您的*代码仍然会触发有问题的警告（因此您可以清理它）。Hedley 中也有相应的宏：[`HEDLEY_DIAGNOSTIC_PUSH`](https://nemequ.github.io/hedley/api-reference.html#HEDLEY_DIAGNOSTIC_PUSH)/ [`HEDLEY_DIAGNOSTIC_POP`](https://nemequ.github.io/hedley/api-reference.html#HEDLEY_DIAGNOSTIC_POP)。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-07-27T11:11:00.970

就我而言，我在[MinGW下使用](https://en.wikipedia.org/wiki/MinGW)[Qt](https://en.wikipedia.org/wiki/Qt_%28software%29)。我需要在我的*.PRO*文件中以另一种方式设置标志：

 *```
QMAKE_CXXFLAGS_WARN_ON += -Wno-unknown-pragmas 
```

# css - CSS 中的字体大小 - % 还是 em？

> ID：132685
> 
> 赞同：116
> 
> 时间：2008-09-25T11:18:07.543
> 
> 标签：css, fonts, font-size

在 CSS 中设置字体大小时，我应该使用百分比值 ( `%`) 还是`em`? 你能解释一下优点吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-09-25T11:22:14.383

[A List Apart](http://alistapart.com/articles/howtosizetextincss)上有一篇关于网页排版的非常好的文章。

他们的结论：

> 以 em 为单位调整文本大小和行高，并在正文中指定百分比（以及 Safari 2 的一个可选警告），可在当今常用的所有浏览器中提供准确、可调整大小的文本。这是一种您可以放入工具包中的技术，并将其用作在 CSS 中调整文本大小的最佳实践，以满足设计人员和读者的需求。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-25T11:20:13.903

来自[http://archivist.incutio.com/viewlist/css-discuss/1408](http://archivist.incutio.com/viewlist/css-discuss/1408)

> %：一些浏览器不处理字体大小的百分比，而是将 150% 解释为 150px。（例如，一些 NN4 版本。）IE 也有嵌套元素百分比的问题。似乎 IE 使用相对于视口而不是相对于父元素的百分比。还有一个问题（尽管根据 W3C 规范是正确的），在 Moz/Ns6 中，您不能使用相对于没有指定高度/宽度的元素的百分比。
> 
> em：有时浏览器使用错误的参考尺寸，但在相对单位中，它是问题最少的一个。你可能会发现它有时被解释为 px。
> 
> pt：分辨率差别很大，不宜用于显示。不过，它对于打印使用来说是相当安全的。
> 
> px：屏幕上唯一可靠的绝对单位。但是，它可能在打印中被错误地解释，因为一个点通常由几个像素组成，因此一切都变得非常小。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-25T11:21:14.353

两者都相对于它的大小调整字体大小。1.5em 与 150% 相同。唯一的优势似乎是可读性，选择你最喜欢的。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2018-07-18T14:00:37.063

当您不将其用于字体大小时，真正的区别就很明显了。设置 a `padding`of`1em`与 不同`100%`。`em`总是相对于字体大小。但`%`可能与字体大小、宽度、高度以及我不知道的其他一些事情有关。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-11-12T16:22:23.833

鉴于（几乎？）所有的浏览器现在都调整了整个页面的大小，而不仅仅是文本，之前的`px`vs. `%`vs. `em`s 在可访问字体大小方面的问题相当没有实际意义。

所以，答案是这可能无关紧要。使用任何对你有用的东西。

> `%`很好，因为它允许相对调整大小。
> 
> `px`很好，因为在使用它时管理期望相当容易。
> 
> `em`当也用于布局元素时可能很有用，因为它可以允许与文本大小相关的比例大小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T11:23:54.003

正如 Galwegian 所提到的，px 是最可靠的网页排版，因为您在页面上所做的所有其他事情都主要参考计算机显示器进行布局。绝对尺寸的问题是**某些**浏览器 (IE) 不会缩放网页上的像素值元素，因此当您尝试*放大*/缩小时，除了这些元素之外的所有内容都会进行调整。

我不知道 IE8 是否正确处理了这个问题，但是所有其他浏览器供应商都可以很好地处理像素，并且用户需要放大/缩小文本仍然是少数情况（SO 上的这个文本框可能是例外）。如果你想变得很脏，你总是可以添加一个 javascript 函数来增大你的文本大小，并为用户提供一个“小”/“大”按钮。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-12T12:52:20.780

关于 css 单位`%`和`em`.

据我了解（至少在理论上/概念上，但可能不是这两个单元如何在浏览器中实现）这两个单元是等价的，即如果你将你的`em`值乘以`100`然后`em`用`%`它替换应该是同一件事吗？

如果 em 和 % 之间确实存在一些真正的区别，那么有人可以解释它（或提供解释的链接）吗？

（我想将我的这条评论添加到它所属的位置，即在答案下方缩进，`"Liam, answered Sep 25 '08 at 11:21"`因为我也想知道为什么他的答案被否决了，但我不知道如何把我的评论放在那里，因此不得不写这个“线程全局”回复）

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-25T12:04:25.920

[雅虎用户界面库 (](http://developer.yahoo.com/yui/) [http://developer.yahoo.com/yui/](http://developer.yahoo.com/yui/) ) 有一组很好的基本 css 类，用于“重置”浏览器特定设置，以便显示网站的基础对所有人都是相同的（支持）浏览器。

使用 YUI 时，应该使用百分比。

# asp.net - “经典” ASP.NET 页面和 Microsoft MVC 可以共存于同一个 Web 应用程序中吗？

> ID：132687
> 
> 赞同：13
> 
> 时间：2008-09-25T11:19:11.863
> 
> 标签：asp.net, asp.net-mvc

我正在考虑今天晚些时候为我们正在启动的一个新应用程序尝试 MVC，但我很好奇它是全有还是全无，或者我是否仍然可以像 2006 年那样同时使用 viewstate 和其他拐杖...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T11:36:10.513

是的，您可以将 Web 表单页面和 MVC 视图混合在一个 Web 应用程序项目中。如果您有一个已经构建的应用程序并且您想将您的应用程序从 webforms 迁移到 mvc，这可能会很有用。

不过，您需要确保没有任何 web 表单页面进入标准 ASP.NET MVC 应用程序的“视图”目录中。不能直接通过 url 请求“视图”目录中的页面（或视图）。

如果您是从头开始应用程序，则将两者混合使用几乎没有什么好处。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T11:23:04.193

是的。MVC 只是 IHttpHandler 接口的不同实现，因此经典的 ASP.NET 和 ASP.NET MVC 页面可以在同一个应用程序中共存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T17:36:39.723

正如您可能已经注意到上述答案，是的，这是很有可能做到的。

我实际上不得不在我当前的项目中这样做。我能够获得批准将 MVC 添加到我们的应用程序中，但仅限于管理部分（以限制影响访问我们网站的当前成员的风险）。

我遇到的最大问题是将我的网站转换为 Web 应用程序，但一旦完成，事情就很简单了，将 MVC 与我们的经典代码隐藏网页并排添加。

对我来说，诀窍是让我的 MVC 页面看起来尽可能与我的代码隐藏页面相似，这样过渡看起来尽可能无缝。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T13:15:15.617

我目前正在做一个新项目。虽然我想一路走 MVC 路线，但某些项目要求不允许我这样做。

这些要求之一是从客户端有一个分组网格。个人选择了 Telerik Rad-Grid。虽然他们可能正在支持 MVC，但目前还没有。

所以这意味着我必须有一个混合解决方案。暂时直到 RadGrid 完全支持 MVC。
虽然我们正处于这个过渡时期，但我认为在第三方控制的支持赶上之前，可能会有更多的混合项目出现。

问候

弥敦道

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T11:50:40.087

您需要确保您的 MVC 路由不与您的 Web 窗体页面冲突，以便对 .aspx 页面的请求不会作为参数等路由到控制器操作。

有关如何避免这种情况的详细信息，请参阅Phil Haack 的[这篇博客文章。](http://haacked.com/archive/2008/07/14/make-routing-ignore-requests-for-a-file-extension.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-19T04:54:43.457

Yes, it is very much possible for MVC pages to coexist with asp.net web forms. I implemented that in my existing asp.net application for adding new features. We need to make sure of referring the MVC DLLs, registering routing tables for URL routing and configuring the assemblies and namespaces in Web.config file.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-25T11:25:01.367

如果您将 MVC 与其他方法混合使用，您并没有真正从中受益。MVC 的目的是让你减少耦合并增加内聚，如果你的代码只有一半在这样做，那么另一半不可避免地会限制你的开发周期。

所以，我想虽然有可能，但我认为这不值得。一路走或者根本不走。

# visual-studio - 在 Visual Studio 中，如何在项目属性中给出 .lib 文件的相对路径

> ID：132697
> 
> 赞同：9
> 
> 时间：2008-09-25T11:21:03.247
> 
> 标签：visual-studio, relative-path

我正在使用 Visual Studio 构建一个项目。该项目依赖于另一个项目生成的 lib 文件。这个项目是我正在构建的实际项目的父目录。

更清楚地说，我有一个“ParentDir”，它下面有两个子目录 Project1 和 Project2。现在 Project1 依赖于 Project2 生成的 lib。

在 Project1 的属性中，我尝试使用 $(SolutionDir)/../ParentDir/Project2/Debug 提供相对路径，但这似乎不起作用。

你能告诉我哪里出错了，或者建议实现这一目标的正确方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T11:25:29.057

将依赖项目添加到您的解决方案中，并使用项目属性将其设置为其他项目的依赖项。然后它就神奇地起作用了;)。

解决方案只是描述一组相关（互连）项目及其之间关系的文件，因此这是正确的做法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T12:10:31.037

您当前的目录是您的 $(ProjectDir)，即 .vcproj 文件所在的位置。

因此，只需编写 ../Project2/Debug 即可。

更好的是，为所有配置编写 ../Project2/$(ConfigurationName)

因此，您将始终链接到该库的正确版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T06:39:59.123

我认为当“..”放置在路径字符串中间的某个位置时，Visual Studio 不会正确扩展相对路径。它只知道如何扩展..{sub-path}。

# visual-studio - Visual Studio bin\debug 文件夹中的 PDB 文件

> ID：132719
> 
> 赞同：11
> 
> 时间：2008-09-25T11:26:32.860
> 
> 标签：visual-studio, build-process, pdb-files

我有一个由多个项目组成的 Visual Studio (2008) 解决方案，并非所有项目都在同一个命名空间中。当我构建解决方案时，顶层项目**TopProject**使用的所有 DLL 文件都被复制到*TopProject\bin\debug*文件夹中。但是，相应的 .pdb 文件仅针对其他一些项目进行复制。这是一种痛苦，例如在使用[NDepend](http://www.ndepend.com/)时。

Visual Studio 如何决定将哪些 .pdb 文件复制到更高级别的 bin\debug 文件夹中？我怎样才能让 Visual Studio 也复制其他人？

* * *

参考如下：所有的 DLL 文件都复制到一个中心位置，没有它们的 PDB 文件。**TopProject** *只*引用了这些复制的 DLL 文件；然而，DLL 文件本身显然知道它们的 PDB 文件在哪里，并且（其中大多数）被`debug`正确复制到文件夹中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-25T11:30:07.470

来自[MSDN](http://msdn.microsoft.com/en-us/library/yd4f8bd1(VS.71).aspx)：

> 程序数据库 (PDB) 文件包含调试和项目状态信息，允许增量链接程序的调试配置。当您使用 /ZI 或 /Zi 编译 C/C++ 程序或使用 /debug 编译 Visual Basic/C#/JScript .NET 程序时，将创建 PDB 文件。

所以看起来这里的“问题”（因为没有更好的词）是你的一些 DLL 是在调试模式下构建的（因此会发出 PDB 文件），而有些是在发布模式下构建的（因此不会发出 PDB文件）。如果是这种情况，它应该很容易修复——进入每个项目并更新其构建设置。如果您没有对命令行选项进行任何调整，这将是默认情况。

但是，如果不是这样，它会变得更加棘手。也许你们都处于发布或调试模式。现在您需要查看每个项目的命令行编译选项（在项目属性中指定）。如果需要调试器，请将它们相应地更新为 /debug，如果不需要，则将其删除。

**编辑以响应编辑**

是的，DLL 文件“知道”它们有 PDB 文件，并且有它们的路径，但这并不意味着太多。正如其他人所提到的，仅将 DLL 文件复制到给定目录不会解决此问题。您还需要 PDB 文件。

在 Windows 中复制单个文件，除了某些“捆绑”类型的文件（我不知道微软对此的说法，但“完整的 HTML 包”是概念）不会复制关联的文件。DLL 文件不是以“捆绑”方式组装的，因此复制它们会留下它们的 PDB 文件。

我想说您将拥有的唯一答案是更新您将 DLL 文件获取到这些中心位置的过程，并包含 PDB 文件......不过，我很想被证明是错误的！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T11:44:57.980

首先，永远不要假设任何事情。清理解决方案，在调试模式下重建它，并检查是否创建了所有 PDB 文件。如果不是，那是你的问题。

如果它们已创建，并且它们并未全部被复制，则可以通过创建一个构建后事件来解决此问题，该事件将 PDB 文件手动复制到所需位置。当然，这只是一种解决方法。

我能想到的唯一另一件事是您的解决方案文件已损坏。您可以将 .sln 作为 XML 文件打开并检查内容。检查按预期运行的项目的配置，并将它们与未按预期运行的项目进行比较。如果您没有看到任何内容，则必须在项目级别重复此操作。比较工作的 .csproj（或其他）项目文件和非工作的项目文件。

* * *

**编辑以响应编辑**：

如果您只是手动复制内容，那么也可以手动复制 PDF 文件。我相信 DLL 文件不应该“知道”任何关于 PDB 文件的信息。只需将它们放在目标目录中，然后去喝杯咖啡。放松。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T12:07:33.213

清洁溶液时检查它是否已真正清洁。

我已经看到 Visual Studio 将文件留在`bin\debug`目录中，即使在清理之后也是如此。删除`bin\debug`所有项目上的目录并重建。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T12:09:54.033

正如其他帖子所说，您可能遇到编译器/损坏问题。

但是，正如 Will 所说，如果 PDB 文件正在创建，但没有显示在您想要的位置，请创建一个构建后步骤。这是我为解决方案中的每个项目定义的构建后步骤。它确保所有输出文件都复制到一个公共目录中。

如果您的项目文件位于 \SolutionDir\ProjDir 中，则构建后步骤的第一行会将输出文件复制到 \Solution\Bin\Release 或 \Solution\Bin\Debug。如果这是调试版本，则第二行复制 PDB 文件。我不会为发布版本复制 PDB 文件。

因此，\SolutionDir\Bin 现在将所有输出文件包含在一个位置。

```
xcopy /r /y $(TargetPath) $(ProjectDir)..\$(OutDir)
if $(ConfigurationName) == Debug xcopy /r /y $(TargetDir)$(TargetName).pdb $(ProjectDir)..\$(OutDir) 
```

# asp.net - 无法反映方法“XYZ”

> ID：132720
> 
> 赞同：8
> 
> 时间：2008-09-25T11:27:17.990
> 
> 标签：asp.net, web-services, exception, reflection

我们使用了第三方 Web 服务并尝试从 ASP.NET Web 应用程序调用它。但是，当我实例化 Web 服务时，会引发以下 System.InvalidOperationException 异常：

> 无法反映方法“ABC.XYZ”。System.InvalidOperationException：无法反映方法“ABC.XYZ”。---> System.InvalidOperationException：命名空间“ [http://mysoftware.com/ns](http://mysoftware.com/ns) ”中的 XML 元素“MyDoc ”引用了一个方法和一个类型。使用 WebMethodAttribute 更改方法的消息名称或使用 XmlRootAttribute 更改类型的根元素。

据我所知，Web 服务中的方法和类型之间似乎存在一些歧义。任何人都可以澄清这个异常的可能原因吗？我能做些什么来纠正这个问题，或者我应该去网络服务所有者纠正吗？

编辑：Visual Studio 2008 已经创建了代理类。不幸的是，我无法提供 wsdl 的链接，因为它是本地安装的第三方应用程序的 Web 服务。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-12-02T19:19:32.123

我今天早些时候遇到了同样的问题。原因是 - 由 Visual Studio 生成并作为参数传递给其中一种方法的类没有默认的无参数构造函数。一旦我添加了它，错误就消失了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-13T15:32:51.777

似乎问题归结为 VS 和用 Java 编写的 Web 服务之间的数据类型问题。

最终通过手动编辑由 VS 创建的类和模式文件来修复它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T18:48:47.150

当我使用 3rd 方网络服务时，我遇到了完全相同的问题。此实例中的问题是参考文件中的 mustUndertand 属性正在寻找一个布尔值，而命名空间属性正在寻找一个字符串。

通过查看引用，我能够识别有问题的属性并简单地将“覆盖”添加到方法签名中。

不理想，因为任何时候更新服务都必须这样做，但我找不到任何其他方法。

要查找参考文件，请从解决方案资源管理器中选择“所有文件”

希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T11:50:43.627

我猜该服务发出或提供的 wsdl 不是 wsdl.exe 或 serviceutil 可以理解的形式 - 您可以发布 wsdl 或链接到它吗？

你是如何创建代理类的？

此外，您可能想尝试根据 wsdl 模式验证 wsdl 以检查其有效

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-02T01:26:04.947

在我的情况下，由于在方法返回的类中，我未能公开默认的无参数构造函数，因此出现“方法无法反映”错误。

我在 VB.NET 中工作。在我的返回类中，我声明了一个带有几个参数的“New(..)”方法（因为这就是我想在我的代码中使用它的方式）。但是通过这样做，我抑制了 VB 在幕后添加的默认（隐藏）无参数 New() 构造函数。显然，Web 服务处理程序要求无参数构造函数可用。一旦我在我的类中添加了一个无参数的 New() 构造函数，它就一切正常了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T13:26:22.213

我收到了同样的消息，但我的消息是由于缺少 System.Runtime.Serialization.dll 引起的，因为我试图在仅安装 .NET 2.0 的机器上运行 3.5 应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-10T05:52:04.727

我有同样的问题，但我发现其中一个`WebMethod`参数有一个类型的成员，`interface`这就是为什么`VS`不能序列化它。这是尝试下载`disco`文件时的例外

> System.InvalidOperationException: Cannot serialize member 'Leopard.JobDespatchParameters.SendingUser' of type 'Leopard.Interfaces.IUser', see inner exception for more details. ---> System.NotSupportedException: Cannot serialize member Leopard.JobDespatchParameters.SendingUser of type Leopard.Interfaces.IUser because it is an interface.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-12T11:11:55.123

Old thread but I had a different issue, Maybe of help to someone. referenced dlls were mixed up between two versions on data layer and service layer that caused the problem.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-22T14:39:46.013

Another scenario where this error can happen: I simply had another web method with the same name (but different parameters)in my web service that slipped in during a code merge. After I deleted the old method it worked.

# scrum - Sprint 累积流程图

> ID：132724
> 
> 赞同：4
> 
> 时间：2008-09-25T11:28:33.603
> 
> 标签：scrum, diagram

谁能给我一些关于如何阅读累积流程图的提示。我不确定它告诉我什么样的事情。

# delphi - delphi 变量是否默认初始化为一个值？

> ID：132725
> 
> 赞同：107
> 
> 时间：2008-09-25T11:28:58.063
> 
> 标签：delphi, variables, initialization

我是 Delphi 的新手，我一直在运行一些测试来查看默认情况下初始化的对象变量和堆栈变量：

```
TInstanceVariables = class
  fBoolean: boolean; // always starts off as false
  fInteger: integer; // always starts off as zero
  fObject: TObject; // always starts off as nil
end; 
```

这是我习惯于其他语言的行为，但我想知道在 Delphi 中依赖它是否安全？例如，我想知道它是否可能取决于编译器设置，或者可能在不同的机器上以不同的方式工作。依赖对象的默认初始化值是否正常，或者您是否在构造函数中显式设置所有实例变量？

至于堆栈（过程级）变量，我的测试表明未初始化的布尔值是真的，未初始化的整数是 2129993264，未初始化的对象只是无效的指针（即不是 nil）。我猜规范是在访问它们之前总是设置过程级变量？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-09-25T11:41:38.347

是的，这是记录在案的行为：

*   对象字段始终初始化为 0、0.0、''、False、nil 或任何适用的值。

*   全局变量也总是初始化为 0 等；

*   局部引用计数* 变量总是初始化为 nil 或 '';

*   本地非引用计数* 变量未初始化，因此您必须先分配一个值才能使用它们。

我记得[Barry Kelly](https://stackoverflow.com/users/3712/barry-kelly)在某处为“引用计数”写了一个定义，但再也找不到它了，所以同时应该这样做：

> 引用计数 == 本身是引用计数的，或者直接或间接包含引用计数的字段（用于记录）或元素（用于数组），例如：`string, variant, interface` 或包含此类类型的*动态数组*或*静态数组。*

笔记：

*   `record`本身不足以成为引用计数
*   我还没有用泛型试过这个

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-25T15:58:33.033

没有显式初始化程序的全局变量在可执行文件的 BSS 部分中分配。它们实际上并不占用 EXE 中的任何空间；BSS 部分是操作系统分配并清零的特殊部分。在其他操作系统上，也有类似的机制。

您可以依赖零初始化的全局变量。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-09-25T11:33:12.017

类字段默认为零。这已记录在案，因此您可以依赖它。本地堆栈变量是未定义的，除非字符串或接口，这些设置为零。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-01-30T13:30:56.060

顺便说一句（因为您是 Delphi 新手）：全局变量可以在声明它们时直接初始化：

```
var myGlobal:integer=99; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-25T12:03:05.690

这是 Ray Lischners Delphi in a Nutshell [Chapter 2的一句话](http://oreilly.com/catalog/delphi/chapter/ch02.html)

> “当Delphi第一次创建一个对象时，所有的字段一开始都是空的，也就是说，指针被初始化为nil，字符串和动态数组都是空的，数字的值为零，布尔字段为False，Variants被设置为Unassigned。 （详见第 5 章的 NewInstance 和 InitInstance。）"

确实需要初始化范围内的局部变量......我认为上面的评论“全局变量已初始化”是可疑的，直到提供参考 - 我不相信。

编辑... Barry Kelly 说您可以依赖它们进行零初始化，并且由于他在 Delphi 编译器团队中，我相信这是 :) 谢谢 Barry。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-25T11:42:22.900

全局变量和对象实例数据（字段）始终初始化为零。Win32 Delphi中没有初始化过程和方法中的局部变量；在您在代码中为它们分配值之前，它们的内容是未定义的。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-25T11:57:51.303

即使一种语言确实提供了默认初始化，我也不认为你应该依赖它们。初始化为一个值可以让其他可能不了解语言中默认初始化的开发人员更加清楚，并防止跨编译器出现问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-25T14:27:33.347

来自 Delphi 2007 帮助文件：

ms-help://borland.bds5/devcommon/variables_xml.html

> “如果您没有显式初始化全局变量，编译器会将其初始化为 0。”

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-25T14:46:04.767

我对给出的答案有点不满。Delphi 将全局变量和新创建对象的内存空间清零。虽然这*通常*意味着它们已初始化，但在一种情况下它们不是：具有特定值的枚举类型。如果零不是合法值怎么办？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-08-05T13:56:03.483

新引入的（自 Delphi 10.3 起）内联变量使初始值的控制更加容易。

```
procedure TestInlineVariable;
begin
  var index: Integer := 345;
  ShowMessage(index.ToString);
end; 
```

# python - 关于从 Perl 切换到 Python 的演示文稿

> ID：132734
> 
> 赞同：-1
> 
> 时间：2008-09-25T11:31:52.970
> 
> 标签：python, perl, programming-languages

短篇故事：

我正在寻找关于从 Perl 切换到 Python 的演示文稿/好文章。

更长的故事：

我是硬件设计组的程序员/嵌入式硬件工程师。几年前，我说服我的同事使用 Perl 编写脚本（而不是奇怪的批处理文件、Excel、Matlab 和 TCL 混合）。从那时起，我自己已经从 Perl 切换到 Python，并且对这种变化感到非常高兴。我想以某种方式说服我的同事跟随我的道路，但我需要好的观点来说服他们。这些不能像更好的反射设施那样是沉重的程序员巫术（与我不同，这里的大多数人都是 EE 毕业生而不是程序员）。

有任何想法吗 ？关于该主题的好文章/演示文稿？也许有人已经做过并且可以分享技巧。

笔记：

[这个线程](https://stackoverflow.com/questions/132310/why-do-you-like-python)有点在同一主题上，但不太符合我的要求。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-25T15:30:03.337

当两种语言具有相似的功能时，将大量代码从一种相似的语言重写为另一种没有任何好处。也许您应该专注于编写更好的 perl 代码。也许学习使用 perltidy，或者购买 Perl Best Practices 和 Perl Medic 的副本，然后将它们分发给您的同事。如果你担心 Perl 不像 Python 那样纯粹是面向对象的，那么请使用[Moose](http://search.cpan.org/dist/Moose/)（我会反驳说，与 Perl 相比，Python 在函数式编程部门中缺乏）。

针对下面的评论，我还要说，没有必要强迫您的同事学习并快速掌握一种与您已经在使用的语言具有相似功能的语言。

现在，如果您的公司需要的某些库或此类库在 Python 中可用（或远远优于），而在 Perl 中不可用（或质量低得多），那么请继续切换或添加另一种语言。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-25T16:49:47.670

我认为您需要的第一个答案是“我为什么要他们切换到 Python？”的答案，这是只有您可以提供的答案。

从你帖子的语气来看，我倾向于怀疑它可能只是“哦！我发现了这种很酷的新语言并想与大家分享它的酷炫！” 或者，或者，“我*终于*可以用它来摆脱 Perl 的魔掌了……”如果是这样，那你为什么要关心其他人的个人喜好是否与你的一样呢？如果只是“我们都接触彼此的代码”的问题，那为什么你的个人偏好要超过其他人呢？

如果，OTOH，您认为通过切换有实际的技术原因和显着的好处，那么您需要具体地确定这些好处（演示它们的实际 Python 代码是一种方法，但不是唯一的方法）并将它们展示给您的同事，看看您是否可以说服他们这是一个很好的转变。

请小心，以免最终导致从“批处理文件、Excel、Matlab 和 TCL 的奇怪混合”转变为 Perl、Python 以及接下来引起您兴趣的任何其他语言的奇怪混合。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-25T11:38:54.420

与 Perl 相比，您更喜欢 Python 的原因是什么？是什么让你如此开心？你的同事对 Perl 不满意吗？如果是这样，那么 Perl 是什么让他们感到困难并且在 Python 中可能会更好地工作？

说服他们的唯一方法是向他们展示可能的好处。恕我直言，这些往往是非常主观和个人的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-25T18:50:34.773

对不起。我很生气你把 Perl 当作基本的。和 Python 一样是进化的下一步。现在我已经把它从我的胸口拿走了。

评估两者的特征（和限制）差异。Perl 有常量、多行匿名函数和[autovivification](http://en.wikipedia.org/wiki/Autovivification)，但 python 有更好的默认面向对象。

评估您的团队/朋友转换的成本/收益。拥有不同语言的专业化可能对您的团队有好处，或者可能会浪费资源。

[消除Perl](http://blog.timbunce.org/2008/07/30/perl-myths-oscon-2008/)和[Python](http://www.secnetix.de/olli/Python/block_indentation.hawk)背后的神话。

当然，享受您使用的任何语言。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-25T11:51:49.647

![替代文字](https://imgs.xkcd.com/comics/python.png)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-25T11:52:05.403

如果您无法改变非技术经理对如何从一种语言更改为另一种语言的想法，那么您就没有资格建议更改或领导更改。

你必须有正当的理由说明它比现有的更好——而且“我更喜欢语法”或“谷歌使用它”在财务上甚至技术上都不是正当理由。

这是一个如此巨大的转变，您需要在自己的脑海中知道为什么这样做是有意义的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-25T13:15:54.267

如何说服人们 Python 比 Perl 更好？

在 Python 中比在 Perl 中更成功。

当他们问你为什么如此成功时，警告他们必须跳出框框思考。在揭示您成功的秘诀之前，请确保他们确实想要改进。【有些人不想进步，就想发牢骚；尽量不要启用它们。]

在你更成功之前，你没有什么可展示的。“说服他们的好处”是你个人的成功故事。

**启动“拯救 Python** ”时刻的私人列表。在您的实际组织中实际获胜的每个 Python 救援都是无可争辩的。

每天，您都想寻找一个整洁、可写博客的成功故事。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-25T18:35:23.000

Eric S. Raymond 写[了一篇有趣的文章/文章，讲述了他使用 Python 的经历，](http://www.linuxjournal.com/article/3882)非常受欢迎。

在编写工作代码时：

> 当您编写工作代码的速度几乎与您可以键入的速度一样快并且您的失误率接近于零时，这通常意味着您已经掌握了该语言。但这没有任何意义，因为它仍然是第一天，我经常停下来查找新的语言和库功能！
> 
> 这是我的第一个线索，在 Python 中，我实际上正在处理一个非常好的设计。大多数语言在其设计中都内置了如此多的摩擦和笨拙，以至于您在失误率下降到接近零之前很久就了解了它们的大部分功能集。Python 是我用过的第一个逆转这一过程的通用语言。

关于元类黑客：

> 如果说我很惊讶，那肯定是轻描淡写。当简单技术的实现第一次完全按照预期工作时，这已经足够了不起了。但是我的第一个元类 hack 是从一个冷门开始的六天后的一门新语言？即使我们规定我是一个相当有才华的黑客，这也是对 Python 设计的清晰和优雅的惊人证明。
> 
> 我根本不可能在 Perl 中发动这样的政变，即使我在该语言方面的经验水平要高得多。正是在这一点上，我意识到我可能将 Perl 抛在了后面。

对于任何听说过 Raymond 的人以及任何编写过 Python 的人来说，绝对值得一读。他有很多 perl 经验（以及很多一般的编码经验），所以他对 Python 的热情洋溢的评论背后有一些分量。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T13:50:12.997

询问您的同事是否仍然可以阅读几个月前编写的 Perl 脚本，或者他们是否可以阅读和理解彼此的脚本。Python 的一个关键点是它非常易读。还向他们展示，他们如何在 Python 中完成 Perl 中的所有好事情。向他们展示 Python 文档。向他们展示 Python OO 与 Perl 相比如何更好地集成到该语言中。

如果您向您的经理建议，请提及如何更容易维护的部分。他可能会要求每个人现在都切换。

# c++ - 为什么我应该使用内联代码？

> ID：132738
> 
> 赞同：31
> 
> 时间：2008-09-25T11:32:51.440
> 
> 标签：c++, optimization, inline-functions, tradeoff

我是一名 C/C++ 开发人员，这里有几个问题一直困扰着我。

*   “常规”代码和内联代码之间有很大区别吗？
*   主要区别是什么？
*   内联代码只是宏的“形式”吗？
*   选择内联代码时必须做什么样的权衡？

谢谢

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-09-25T13:43:43.763

## 表现

正如之前的答案所建议的那样，使用`inline`关键字可以通过内联函数调用使代码更快，通常以增加可执行文件为代价。“内联函数调用”只是意味着在相应地填写参数之后，用函数的实际代码替换对目标函数的调用。

但是，现代编译器非常擅长在设置为高度优化时自动内联函数调用*而无需用户提示。*实际上，编译器通常比人类*更*擅长确定什么调用内联以获得速度增益。

**`inline`为了提高性能而显式声明函数（几乎？）总是不必要的！**

此外，如果它适合他们，编译器可以*并且将* **忽略**该`inline`请求。如果对函数的调用不可能内联（即使用非平凡递归或函数指针），而且如果函数太大而无法获得有意义的性能增益，编译器就会这样做。

## 一种定义规则

`inline`但是，使用关键字声明内联函数[有其他效果](http://en.cppreference.com/w/cpp/language/inline)，实际上可能*需要*满足单一定义规则 (ODR)：C++ 标准中的这条规则规定，给定符号可以声明多次，但只能定义一次. 如果链接编辑器（=链接器）遇到几个相同的符号定义，它将产生错误。

这个问题的一种解决方案是通过声明它来确保编译单元不会导出给定符号，方法是给定符号内部链接`static`。

但是，通常最好改为标记函数`inline`。这告诉链接器将此函数的所有定义跨编译单元合并为一个定义，具有一个地址和共享的函数静态变量。

例如，考虑以下程序：

```
// header.hpp
#ifndef HEADER_HPP
#define HEADER_HPP

#include <cmath>
#include <numeric>
#include <vector>

using vec = std::vector<double>;

/*inline*/ double mean(vec const& sample) {
    return std::accumulate(begin(sample), end(sample), 0.0) / sample.size();
}

#endif // !defined(HEADER_HPP) 
```

```
// test.cpp
#include "header.hpp"

#include <iostream>
#include <iomanip>

void print_mean(vec const& sample) {
    std::cout << "Sample with x̂ = " << mean(sample) << '\n';
} 
```

```
// main.cpp
#include "header.hpp"

void print_mean(vec const&); // Forward declaration.

int main() {
    vec x{4, 3, 5, 4, 5, 5, 6, 3, 8, 6, 8, 3, 1, 7};
    print_mean(x);
} 
```

请注意，这两个`.cpp`文件都包含头文件，因此包含`mean`. 尽管文件保存时包含防止双重包含，但这将导致同一函数的两个定义，尽管在不同的编译单元中。

现在，如果您尝试链接这两个编译单元 - 例如使用以下命令：

```
⟩⟩⟩ g++ -std=c++11 -pedantic main.cpp test.cpp 
```

你会收到一条错误消息“duplicate symbol __Z4meanRKNSt3__16vectorIdNS_9allocatorIdEEEE”（这是我们函数的错误[名称](https://en.wikipedia.org/wiki/Name_mangling)`mean`）。

但是，如果您取消注释`inline`函数定义前面的修饰符，则代码会正确编译和链接。

*函数模板*是一种特殊情况：它们*始终*是内联的，无论它们是否以这种方式声明。这并不意味着编译器会内联*调用*它们，但它们不会违反 ODR。对于在类或结构中定义的成员函数也是如此。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-25T12:10:46.107

> *   “常规”代码和内联代码之间有很大区别吗？

是和不是。不，因为内联函数或方法与常规函数或方法具有完全相同的特征，最重要的是它们都是类型安全的。是的，因为编译器生成的汇编代码会有所不同；对于常规函数，每次调用都将转换为几个步骤：将参数压入堆栈，跳转到函数，弹出参数等，而对内联函数的调用将被其实际代码替换，例如宏。

> *   内联代码只是宏的“形式”吗？

**不**！宏是简单的文本替换，可能会导致严重错误。考虑以下代码：

```
#define unsafe(i) ( (i) >= 0 ? (i) : -(i) )

[...]
unsafe(x++); // x is incremented twice!
unsafe(f()); // f() is called twice!
[...] 
```

使用内联函数，您可以确定参数将在函数实际执行之前进行评估。它们还将进行类型检查，并最终转换为匹配形式参数类型。

> *   选择内联代码时必须做什么样的权衡？

通常，使用内联函数时程序执行应该更快，但二进制代码更大。有关更多信息，您应该阅读[GoTW#33](http://www.gotw.ca/gotw/033.htm "GoTW#33")。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-25T11:36:29.373

内联代码本质上像宏一样工作，但它是实际的真实代码，可以进行优化。非常小的函数通常适合内联，因为与方法所做的少量实际工作相比，设置函数调用（将参数加载到适当的寄存器中）所需的工作成本很高。使用内联，无需设置函数调用，因为代码直接“粘贴”到任何使用它的方法中。

内联会增加代码大小，这是它的主要缺点。如果代码太大以至于无法放入 CPU 缓存中，则可能会严重降低速度。您只需要在极少数情况下担心这一点，因为您不太可能在很多地方使用一种方法，增加的代码会导致问题。

总而言之，内联非常适合加速被多次调用但不会在太多地方调用的小方法（不过，100 个地方仍然可以 - 您需要进入非常极端的示例才能获得任何显着的代码膨胀）。

编辑：正如其他人指出的那样，内联只是对编译器的建议。如果它认为你在发出愚蠢的请求，比如内联一个巨大的 25 行方法，它可以自由地忽略你。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-25T11:40:08.677

*   “常规”代码和内联代码之间有很大区别吗？

是的 - 内联代码不涉及函数调用，并将寄存器变量保存到堆栈中。每次“调用”它都会使用程序空间。因此，总体而言，执行所需的时间更少，因为处理器中没有分支，也没有保存状态、清除缓存等。

*   内联代码只是宏的“形式”吗？

宏和内联代码有相似之处。最大的区别是内联代码被专门格式化为一个函数，因此编译器和未来的维护者有更多的选择。具体来说，如果你告诉编译器优化代码空间，或者未来的维护者最终扩展它并在代码中的许多地方使用它，它可以很容易地变成一个函数。

*   选择内联代码时必须做什么样的权衡？

    *   宏：代码空间使用率高，执行速度快，如果“函数”很长，则难以维护
    *   功能：代码空间占用少，执行速度慢，易于维护
    *   内联函数：代码空间使用率高、执行速度快、易于维护

*需要注意的是，寄存器保存和跳转到函数确实会占用代码空间，所以对于非常小的函数，内联**可以**比函数占用更少的空间。*

-亚当

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T11:38:35.887

这取决于编译器......
假设你有一个愚蠢的编译器。通过指示必须内联函数，它将在每次调用时放置函数内容的副本。

优点：没有函数调用开销（放参数、推送当前PC、跳转到函数等）。例如，在大循环的中心部分可能很重要。

不便之处：膨胀生成的二进制文件。

是宏吗？不是真的，因为编译器仍然会检查参数的类型等。

那么智能编译器呢？如果他们“感觉”函数太复杂/太大，他们可以忽略 inline 指令。也许他们可以自动内联一些琐碎的函数，比如简单的 getter/setter。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T11:41:18.767

内联与宏的不同之处在于它是对编译器的提示（编译器可能决定不内联代码！）并且宏是在编译之前生成的源代码文本，因此被“强制”内联。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T11:40:04.667

将函数标记为内联意味着编译器可以*选择*将其包含在调用它的“内联”中，如果编译器选择这样做的话；相比之下，宏将*始终*就地展开。内联函数将设置适当的调试符号，以允许符号调试器跟踪它的来源，而调试宏则令人困惑。内联函数必须是有效函数，而宏......好吧，不要。

决定声明一个函数内联在很大程度上是一种空间权衡——如果编译器决定内联它，你的程序会更大（特别是如果它不是静态的，在这种情况下，至少需要一个非内联副本供使用任何外部物体）；事实上，如果函数很大，这可能会导致性能下降，因为缓存中的代码较少。然而，一般性能提升只是您摆脱了函数调用本身的开销。对于作为内部循环的一部分调用的小函数，这是一个有意义的权衡。

如果您信任您的编译器，请随意标记内部循环中使用的小函数`inline`；编译器将负责在决定是否内联时做正确的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T11:37:48.667

如果您在 fe C++ 中将代码标记为内联，那么您也在告诉您的编译器代码应该内联执行，即。该代码块将“或多或少”插入到调用它的位置（从而消除堆栈上的推送、弹出和跳转）。所以，是的......如果功能适合这种行为，建议使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T11:38:31.770

“内联”就像 2000 年的“注册”一样。不要打扰，编译器可以比您更好地决定要优化的内容。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T11:43:13.367

通过内联，编译器在调用点插入函数的实现。您正在做的是消除函数调用开销。但是，不能保证您的所有内联候选者实际上都会被编译器内联。但是，对于较小的函数，编译器总是内联的。因此，如果您有一个被多次调用但只有有限数量的代码（几行）的函数，您可以从内联中受益，因为函数调用开销可能比函数本身的执行花费更长的时间。

一个很好的内联候选的典型例子是简单具体类的 getter。

```
CPoint
{
  public:

    inline int x() const { return m_x ; }
    inline int y() const { return m_y ; }

  private:
    int m_x ;
    int m_y ;

}; 
```

一些编译器（例如 VC2005）有一个积极内联的选项，使用该选项时你不需要指定'inline' 关键字。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T11:56:40.400

我不会重复上述内容，但值得注意的是，虚函数不会被内联，因为调用的函数是在运行时解析的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-25T11:57:56.857

内联通常在优化级别 3 启用（在 GCC 的情况下为 -O3）。在某些情况下（如果可能），它可以显着提高速度。

程序中的显式内联可以以增加代码大小为代价来提高速度。

你应该看看哪个是合适的：代码大小或速度，并决定你是否应该将它包含在你的程序中。

您可以只打开第 3 级优化并忘记它，让编译器完成他的工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T12:13:29.563

你是否应该内联的答案归结为速度。如果你在一个紧密的循环中调用一个函数，而且它不是一个超级大的函数，而是一个在调用函数上浪费了很多时间的函数，那么让这个函数内联，你会得到很多好处你的钱。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-25T12:28:00.950

首先，内联是对编译器内联函数的请求。因此，编译器是否使其内联取决于编译器。

1.  何时使用？当一个函数的行数很少（对于所有访问器和修改器）但不是递归函数时
2.  优点？不涉及调用函数调用所花费的时间
3.  编译器是否内联了它自己的任何函数？是的，当一个函数在类的头文件中定义时

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-25T12:56:46.357

内联是一种提高速度的技术。但是在你的情况下使用探查器来测试它。我发现 (MSVC) 内联并不总是可以交付，当然也不会以任何壮观的方式交付。运行时间有时会减少几个百分点，但在稍有不同的情况下会增加几个百分点。

如果代码运行缓慢，请使用分析器查找故障点并解决这些问题。

我已经停止向头文件添加内联函数，它增加了耦合，但回报很少。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-25T13:20:39.263

内联代码更快。无需执行函数调用（每个函数调用都需要一些时间）。缺点是您不能将指针传递给内联函数，因为该函数并不真正作为函数存在，因此没有指针。此外，该函数不能导出到公共（例如，库中的内联函数在链接到库的二进制文件中不可用）。另一个是二进制文件中的代码部分会增长，如果你从不同的地方调用函数（因为每次生成函数的副本而不是只有一个副本并总是跳到那里）

通常您不必手动决定是否应内联函数。例如，GCC 将根据优化级别 (-Ox) 和其他参数自动决定。它将考虑诸如“功能有多大？”之类的事情。（指令数量），在代码中调用它的频率，通过内联二进制文件会变大多少，以及其他一些指标。例如，如果一个函数是静态的（因此无论如何都不会导出）并且只在您的代码中调用一次并且您从不使用指向该函数的指针，那么 GCC 很可能会决定自动内联它，因为它不会产生负面影响（只内联一次二进制文件不会变大）。

# javascript - jQuery - 在新图像上运行函数

> ID：132750
> 
> 赞同：4
> 
> 时间：2008-09-25T11:37:04.830
> 
> 标签：javascript, jquery, zooming

我是 jQuery 新手，所以这个问题的答案可能很简单：

我有一个图像，我想用它做几件事。当用户单击“缩放”图标时，我正在运行“图像工具”插件 ( [http://code.google.com/p/jquery-imagetool/](http://code.google.com/p/jquery-imagetool/) ) 以加载更大版本的图像。该插件在图像周围创建一个新的 div 并允许用户平移。

当用户单击替代图像时，我将删除旧图像并加载新图像。

当用户单击替代图像，然后单击缩放按钮时，问题就出现了 - imagetool 插件创建了新的 div，但图像出现在它之后......

代码如下：

```
// Product Zoom (jQuery)
$(document).ready(function(){
$("#productZoom").click(function() {

    // Set new image src
    var imageSrc = $("#productZoom").attr("href");
    $("#productImage").attr('src', imageSrc);   

    // Run the imagetool plugin on the image
    $(function() {
        $("#productImage").imagetool({
            viewportWidth: 300,
            viewportHeight: 300,
            topX: 150,
            topY: 150,
            bottomX: 450,
            bottomY: 450
        });
    });
    return false;
});
});

// Alternative product photos (jQuery)
$(document).ready(function(){
$(".altPhoto").click(function() {

    $('#productImageDiv div.viewport').remove();
    $('#productImage').remove();

    // Set new image src
    var altImageSrc = $(this).attr("href");

    $("#productZoom").attr('href', altImageSrc);

    var img = new Image();
    $(img).load(function () {
        $(this).hide();
        $('#productImageDiv').append(this);
        $(this).fadeIn();
    }).error(function () {
        // notify the user that the image could not be loaded
    }).attr({
        src: altImageSrc,
        id: "productImage"
        });

    return false;       
});
}); 
```

在我看来，imagetool 插件一旦被替换为新图像就无法再看到#productImage 图像......所以我认为这与绑定有关？如因为页面加载后新图像添加到dom中，iamgetool插件无法再正确使用它......是这样吗？如果是这样，任何想法如何处理它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T14:14:07.137

嘿！我自己整理的...

事实证明，如果我完全删除包含的 div，然后用 .html 重写它，imagetool 插件会再次识别它。

有兴趣的人的修改代码：

```
$(document).ready(function(){

  // Product Zoom (jQuery)
  $("#productZoom").click(function() {

    $('#productImage').remove();
    $('#productImageDiv').html('<img src="" id="productImage">');

    // Set new image src
    var imageSrc = $("#productZoom").attr("href");
    $("#productImage").attr('src', imageSrc);   

    // Run the imagetool plugin on the image
    $(function() {
        $("#productImage").imagetool({
            viewportWidth: 300,
            viewportHeight: 300,
            topX: 150,
            topY: 150,
            bottomX: 450,
            bottomY: 450
        });
    });

    return false;
  });

  // Alternative product photos (jQuery)
  $(".altPhoto").click(function() {

    $('#productImageDiv div.viewport').remove();
    $('#productImage').remove();

    // Set new image src
    var altImageSrc = $(this).attr("href");

    // Set new image Zoom link (from the ID... is that messy?)
    var altZoomLink = $(this).attr("id");

    $("#productZoom").attr('href', altZoomLink);

    var img = new Image();
    $(img).load(function () {
        $(this).hide();
        $('#productImageDiv').append(this);
        $(this).fadeIn();
    }).error(function () {
        // notify the user that the image could not be loaded
    }).attr({
        src: altImageSrc,
        id: "productImage"
        });

    return false;       
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T11:48:48.063

您可以尝试将**productZoom.click()**函数抽象为命名函数，然后在更改为备用图像后重新绑定它。就像是：

```
// Product Zoom (jQuery)
$(document).ready(function(){
$("#productZoom").click(bindZoom);

// Alternative product photos (jQuery)
$(".altPhoto").click(function() {

        $('#productImageDiv div.viewport').remove();
        $('#productImage').remove();

        // Set new image src
        var altImageSrc = $(this).attr("href");

        $("#productZoom").attr('href', altImageSrc);

        var img = new Image();
    $(img).load(function () {
                $(this).hide();
        $('#productImageDiv').append(this);
        $(this).fadeIn();
    }).error(function () {
        // notify the user that the image could not be loaded
    }).attr({
                src: altImageSrc,
                id: "productImage"
                });
        $("#productZoom").click(bindZoom);
        return false;

});  
});

function bindZoom() {
        // Set new image src
        var imageSrc = $("#productZoom").attr("href");
        $("#productImage").attr('src', imageSrc);       

        // Run the imagetool plugin on the image
        $(function() {
                $("#productImage").imagetool({
                        viewportWidth: 300,
                        viewportHeight: 300,
                        topX: 150,
                        topY: 150,
                        bottomX: 450,
                        bottomY: 450
                });
        });
        return false;
} 
```

此外，将您的两个 ready() 块滚动到同一个块中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T12:10:52.317

首先，我有一个问题，是 .altPhoto 链接还是图片？因为如果它的图像那么这条线是错误的

```
var altImageSrc = $(this).attr("href"); 
```

它应该是

```
var altImageSrc = $(this).attr("src"); 
```

这是我一眼就能找到的唯一东西

# java - JSP 应用程序中的不同布局和 i18n

> ID：132754
> 
> 赞同：1
> 
> 时间：2008-09-25T11:37:54.860
> 
> 标签：java, model-view-controller, jsp, tomcat

我在 Tomcat 中有一堆 JSP 文件和后端。我有 3 个不同版本的 JSP，内部逻辑相同，但布局不同。所以如果我改变一些逻辑，我需要修复三个 JSP 文件。

这种情况的正确解决方案是什么？我想到了一些 XML 和 XSLT 堆栈：后端只提供 XML 格式的数据，而且对于每个布局，我都有 XSLT 可以发挥一些作用。

试想一下，您需要在 JSP 中提供各种语言的 stackoverflow。逻辑相同，但布局不同。

你能给我指出一些方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T11:47:39.063

这通常通过使用一些模板引擎来解决 - 您创建较小的页面片段，然后向模板引擎声明某些视图应该由这些部分组成，以某种方式组合在一起。

Struts tile 是 Java 世界中的经典示例，但与 Java 和其他语言中更现代的框架相比，它确实变得陈旧和粗糙。Tapestry 和 Wicket 是两个更现代的（虽然没有使用过）。

不过，对于只有 3 个页面，应用整个 Web 框架可能有点过头了，但是如果您的网站增长...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T12:00:47.100

使用没有任何名声的普通旧 JSP：

1）使用控制器进行处理，只使用jsp显示数据

2) 使用 jsp 包含指令将页眉、导航、菜单、页脚和其他必要的公共/共享元素包含到所有这些布局中。

或/和：

在 web.xml 中使用以下内容

```
 <jsp-property-group>
        <url-pattern>/customers/*</url-pattern>
        <include-prelude>/shared/layout/_layout_customers_top.jsp</include-prelude>
        <include-coda>/shared/layout/_layout_customers_bottom.jsp</include-coda>
    </jsp-property-group> 
```

url 模式确定哪些 jsp 获取哪些 jsp 片段（Ruby on Rails 中的部分）附加到顶部/底部。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T12:14:09.843

了解 MVC（模型视图控制器）以及 JSP 应该是它的视图部分并且不应该包含任何逻辑的想法。逻辑属于模型类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T11:46:05.667

看看瓷砖。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-26T09:29:14.117

这是一个非常经典的问题领域，有很多概念和框架试图解决这个问题（MVC 框架，如 Struts 和 JSF，SessionBeans 等等）。由于我怀疑您并不是真正的 Java 企业“传道者”，因此我将给您 2 个简单的建议。

1.  您的 JSP 中显然有很多冗余代码。将此代码提取到“真正的”Java 类中，并在所有 JSP 上使用它们。这样，您将能够在一个地方修改业务逻辑，冗余将不再是一个问题。

2.  看看级联样式表 (CSS)。这是最先进的网页布局方式。如果您有精心设计的 html + CSS，您甚至可能不需要针对不同布局使用不同的 JSP。

问候

# asp.net - 当用户离开页面时，如何在 ASP.NET 中保存页面中的信息？

> ID：132764
> 
> 赞同：1
> 
> 时间：2008-09-25T11:40:41.267
> 
> 标签：asp.net, page-lifecycle

在我们的 CMS 中，我们有一个地方可以让用户玩弄他们的网站层次结构——移动页面、添加和删除页面等。

我们使用拖放来实现移动页面。

每个动作都必须保存在数据库中，并导出为许多 HTML 文件。如果我们每一步都这样做，它会减慢用户的速度。因此，我们认为最好让用户随心所欲地玩耍，将每个更改保存到 DB，但仅在他们离开页面时 - 将更改导出到 HTML 文件。

我们曾考虑让用户在准备好提交更改时单击“发布”按钮，但我们担心用户不会记得这样做，因为从他们的角度来看，一旦他们将页面移动到新地方 - 动作完成。按钮的另一个问题是它与站点其他部分的行为不一致（例如，当用户在页面内移动文本时，更改会自动保存，因为只有 1 个 HTML 文件需要更新）

那么我们如何在离开页面时自动保存用户更改呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T11:43:12.930

当用户使用 javascript 离开页面时，您应该警告用户。

来自[http://www.siafoo.net/article/67](http://www.siafoo.net/article/67)：

现代浏览器有一个名为 window.beforeunload 的事件，当任何会导致页面卸载的事件发生时都会立即触发该事件。这包括单击链接、提交表单或关闭选项卡或窗口。

访问此页面以获取大多数浏览器中的示例：

[http://www.webreference.com/dhtml/diner/beforeunload/bunload4.html](http://www.webreference.com/dhtml/diner/beforeunload/bunload4.html)

我认为不先询问用户就保存页面是不好的做法，这不是正常网页的工作方式。

样本：

```
<SCRIPT LANGUAGE="JavaScript1.2" TYPE="text/javascript">
<!--
function unloadMess(){
    mess = "Wait! You haven't finished."
    return mess;
}

function setBunload(on){
    window.onbeforeunload = (on) ? unloadMess : null;
}

setBunload(true);
//-->
</SCRIPT> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T11:44:54.967

我能想到的最简单的方法是每次用户使用 Ajax 移动项目时存储页面信息（例如，使用 UpdatePanel、onUpdated 事件，让它触发一些更新用户页面配置的脚本。

或者 - .Net 的 WebParts 实现自动执行此操作，无需程序员干预（除非您想更改存储引擎，它默认使用本地 mdb。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T11:47:52.683

使用“发布”复选框/按钮，当用户以一种导致他们离开的方式与页面交互时，如果未选中该框/未单击按钮，则询问他们是否要发布。请注意，您可能不希望或无法提示用户执行某些操作（关闭浏览器、访问他们的收藏夹菜单等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T12:39:51.263

我会强迫他们点击发布等按钮。那是一个“培训”问题。

在他们离开时自动保存更改可能会产生其他影响。例如，如果用户打开记​​录并玩弄它并且无意更改它，他们会关闭它，例如 word 文档、excel 等。. 我会让你的网站模仿那个模型。

您还必须记住，Web 是一个断开连接的环境，并不要求所有 Web 应用程序都像 Windows 应用程序一样运行。

如果用户没有单击发布/保存按钮，则不会保存更改，这取决于他们记住要做的事情。

# windows - 如何在批处理文件中回显换行符？

> ID：132799
> 
> 赞同：728
> 
> 时间：2008-09-25T11:50:24.720
> 
> 标签：windows, batch-file, newline

如何从批处理文件输出中插入换行符？

我想做类似的事情：

```
echo hello\nworld 
```

这将输出：

```
hello
world 
```

* * *

## 回答 #1

> 赞同：635
> 
> 时间：2008-09-25T11:51:10.570

采用：

```
echo hello
echo:
echo world 
```

* * *

## 回答 #2

> 赞同：514
> 
> 时间：2008-09-25T11:52:13.127

`echo hello & echo.world`

这意味着您可以将`& echo.`换行定义为常量`\n`。

* * *

## 回答 #3

> 赞同：150
> 
> 时间：2008-11-06T18:43:45.197

在这里，创建一个 .bat 文件，其中包含以下内容：

```
@echo off
REM Creating a Newline variable (the two blank lines are required!)
set NLM=^

set NL=^^^%NLM%%NLM%^%NLM%%NLM%
REM Example Usage:
echo There should be a newline%NL%inserted here.

echo.
pause 
```

您应该看到如下输出：

```
There should be a newline
inserted here.

Press any key to continue . . . 
```

显然，您只需要 REM 语句之间的代码。

* * *

## 回答 #4

> 赞同：108
> 
> 时间：2010-06-26T08:11:06.430

cmd/bat-files 中有一个标准功能`echo:`可以写入空白行，它模拟 cmd 输出中的新行：

```
@echo off
echo line1
echo:
echo line2 
```

或者

```
@echo line1 & echo: & echo line2 
```

上面引用的 cmd 文件的输出：

```
line1

line2 
```

* * *

## 回答 #5

> 赞同：77
> 
> 时间：2011-06-16T23:52:05.353

像肯的答案，但使用延迟扩展。

```
setlocal EnableDelayedExpansion
(set \n=^
%=Do not remove this line=%
)

echo Line1!\n!Line2
echo Works also with quotes "!\n!line2" 
```

首先创建一个换行符并将其分配给 \n 变量。
这是因为行尾的插入符号试图转义下一个字符，但如果这是一个换行符，它将被忽略并且下一个字符被读取并转义（即使这也是一个换行符）。
然后您需要第三个换行符来结束当前指令，否则第三行将附加到 LF 变量。
即使批处理文件的行尾以 CR/LF 结尾，也只有 LF 很重要，因为 CR 在解析器的这个阶段被删除。

使用延迟扩展的优点是根本没有特殊字符处理。
`echo Line1%LF%Line2`将失败，因为解析器在单个换行符处停止解析。

更多解释
[见 SO：Vista/DOS 批处理 (.bat) 文件中](https://stackoverflow.com/questions/69068/long-commands-split-over-multiple-lines-in-vista-dos-batch-bat-file/4455750#4455750)
[的多行长命令拆分 SO：Windows 命令解释器 (CMD.EXE) 如何解析脚本？](https://stackoverflow.com/questions/4094699/how-does-the-windows-command-interpreter-cmd-exe-parse-scripts/4095133#4095133)

**编辑：避免`echo.`**

这不能回答问题，因为问题是关于`echo`可以输出多行的单行。

但是，尽管其他答案建议使用`echo.`创建新行，但应该注意这`echo.`是最糟糕的，因为它非常慢并且可能完全失败，因为 cmd.exe 搜索名为的文件`ECHO`并尝试启动它。

对于只打印一个空行，您可以使用其中一个

```
echo,
echo;
echo(
echo/
echo+
echo= 
```

但是应该避免使用`echo.`, `echo\`or ，因为它们可能真的很慢，这取决于脚本执行的位置，比如网络驱动器。`echo:`

* * *

## 回答 #6

> 赞同：44
> 
> 时间：2014-07-16T23:50:53.890

`echo.`说够了。

如果您需要在一行中使用它，请使用`&`. 例如，

```
echo Line 1 & echo. & echo line 3 
```

将输出为：

```
Line 1

line 3 
```

**现在，说你想要一些更花哨的东西，...**

```
set n=^&echo.
echo hello %n% world 
```

输出

```
hello
world 
```

然后，`%n%`只要你想在 echo 语句中换行，就输入 a 。这更接近您`\n`在各种语言中的使用。

**分解**

`set n=`设置变量`n`等于：

`^`取消下一个符号：

`&`意味着在同一行上执行另一个命令。我们不关心错误级别（它是一个大声喊叫的回声语句），所以`&&`不需要。

`echo.`继续 echo 语句。

所有这些都有效，因为您实际上可以创建代码变量，并在其他命令中使用它们。它有点像 ghetto 函数，因为批处理并不是最先进的 shell 脚本语言。这仅适用于批处理对变量的不良使用，而不是自然地在整数、字符、浮点数、字符串等之间指定。

如果你很狡猾，你可以让它与其他东西一起工作。例如，使用它来回显选项卡

```
set t=^&echo.     ::there are spaces up to the double colon 
```

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2009-08-09T01:00:23.033

回显某些内容以重定向到文件时，多个回显命令将不起作用。我认为也许“>>”重定向器是一个不错的选择：

```
回声你好>温度
回声世界>>温度

```

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2014-09-02T00:09:25.303

如果需要将结果保存到文件中，可以使用：

```
(echo a & echo: & echo b) > file_containing_multiple_lines.txt 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2010-03-05T16:47:45.737

就像 Grimtron 建议的那样 - 这是一个定义它的快速示例：

```
@echo off
set newline=^& echo.
echo hello %newline%world 
```

### 输出

```
C:\>test.bat
hello
world 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2011-09-20T17:06:29.143

你也可以这样做，

```
(for %i in (a b "c d") do @echo %~i) 
```

输出将是，

```
a
b
c d 
```

请注意，当将其放入批处理文件时，'%' 应加倍。

```
(for %%i in (a b "c d") do @echo %%~i) 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2013-04-22T04:56:19.490

如果有人来这里是因为他们希望从 MINGW make makefile 中回显一个空白行，我使用

`@cmd /c echo.`

简单地使用`echo.`会导致可怕的`process_begin: CreateProcess(NULL, echo., ...) failed.`错误消息。

我希望这至少可以帮助其他人:)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-09-30T15:24:49.650

Ken 和 Jeb 解决方案运行良好。

但是新行仅使用 LF 字符生成，我需要 CRLF 字符（Windows 版本）。

为此，在脚本的最后，我将 LF 转换为 CRLF。

例子：

```
TYPE file.txt | FIND "" /V > file_win.txt
del file.txt
rename file_win.txt file.txt 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-02-08T09:51:44.760

如果需要在可以传递给变量的字符串文字中使用著名的 \n，可以编写如下*Hello.bat*脚本中的代码：

```
@echo off
set input=%1
if defined input (
    set answer=Hi!\nWhy did you call me a %input%?
) else (
    set answer=Hi!\nHow are you?\nWe are friends, you know?\nYou can call me by name.
)

setlocal enableDelayedExpansion
set newline=^

rem Two empty lines above are essential
echo %answer:\n=!newline!% 
```

这样，多行输出可以在一个地方准备好，甚至在其他脚本或外部文件中，并在另一个地方打印。

换行符保存在*换行*变量中。它的值必须在*echo*行展开**后被替换，所以我使用***setlocal enableDelayedExpansion*来启用在执行时展开变量的感叹号。并且执行将*\n*替换为*换行内容（在**help set*中查找语法）。我们当然可以使用*!newline！*在设置*答案*时，但*\n*更方便。它可能从外部传递（尝试*Hello R2\nD2*），没有人知道保存换行符的变量的名称（是的，*Hello C3!newline!P0***********工作方式相同）。**********

 ***上面的示例可以细化为子程序或独立批处理，使用如下`call:mlecho Hi\nI'm your comuter`：

```
:mlecho
setlocal enableDelayedExpansion
set text=%*
set nl=^

echo %text:\n=!nl!%
goto:eof 
```

请注意，额外的反斜杠不会阻止脚本解析 \n 子字符串。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-12-16T20:31:49.090

要批量开始一个新行，您所要做的就是添加“echo [”，如下所示：

```
echo Hi!
echo[
echo Hello! 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-10-05T12:03:56.960

为什么不使用子字符串/替换空间`echo;`？

```
set "_line=hello world"
echo\%_line: =&echo;% 
```

*   结果：

```
hello
world 
```

*   或者，将 \n 替换为`echo;`

```
set "_line=hello\nworld"
echo\%_line:\n=&echo;% 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2021-06-07T17:49:04.383

对于具有[虚拟终端序列](https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences)的 Windows 10，存在高度控制光标位置的方法。

要定义转义序列 0x1b，可以使用以下命令：

```
@Echo off
 For /f %%a in ('echo prompt $E^| cmd')Do set \E=%%a 
```

要在字符串之间输出一个换行符：

```
<nul set /p "=Hello%\E%[EWorld" 
```

要输出替换为整数的`n`换行符：`n`

```
<nul set /p "=%\E%[nE" 
```

许多

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2021-11-26T03:44:03.427

请注意，根据[*控制台虚拟终端序列使用光标定位的所有解决方案，光标定位*](https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences#cursor-positioning)：

| 顺序 | 代码 | 描述 | 行为 |
| --- | --- | --- | --- |
| ESC [ <n> E | CNL | 光标下一行 | 从当前位置向下移动 <n> 行 |

仅***在未到达控制台窗口底部***时才起作用。

在底部没有剩余空间可以向下移动光标，因此它只是向左移动（使用`CR`of `CRLF`）并且之前打印的行从头开始被覆盖。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2021-11-26T09:16:53.453

经过一个不眠之夜并阅读了此处的所有答案，阅读了很多[SS64 > CMD](https://ss64.com/nt/)并经过大量尝试和错误后，我发现：

# （几乎）终极解决方案

## TL;博士

... 对于早期采用者。

| 重要的！ |
| --- |
| **使用支持 Unicode 的 C&P 文本编辑器，例如 Notepad++！** |

### 设置换行环境变量...

#### ...在当前 CMD 会话中

| 重要的！ |
| --- |
| **不要编辑 ' ' 和 ' ' 之间的*任何*内容！`=``^`**（中间有一个角色，虽然你看不到。这里和编辑模式都没有。C&P 在这里工作。） |

```
:: Sets newline variables in the current CMD session
set \n=​^&echo:
set nl=​^&echo: 
```

#### ...对于当前用户

| 重要的！ |
| --- |
| **不要编辑（第二个）之间的任何内容*'*`␣</code>' and '`^`'!`** `(There's a character in between though you don't see it. Neither here nor in edit mode. C&P works here.)` |

```
:: Sets newline variables for the current user [HKEY_CURRENT_USER\Environment]
setx \n ​^&echo:
setx nl ​^&echo: 
```

#### ...对于本地机器

| 重要的！ |
| --- |
| **不要编辑（第二个）之间的任何内容*'*`␣</code>' and '`^`'!`** `(There's a character in between though you don't see it. Neither here nor in edit mode. C&P works here.)` |

```
:: Sets newline variables for the local machine [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment]
setx \n ​^&echo: /m 
setx nl ​^&echo: /m 
```

## 为什么几乎？

它不适用于同一*打印行中**未配对*（打开和关闭）的双引号，除非唯一未配对的双引号是文本的最后一个字符，例如：

 **   作品：（在每条*印刷线*`""echo %\n%...after "newline". Before "newline"...%\n%...after "newline"`中配对）

**   有效：（`echo %\n%...after newline. Before newline...%\n%...after newline"`唯一不成对的双引号是最后一个字符）

    *   不起作用：（`echo "%\n%...after newline. Before newline...%\n%...after newline"`双引号不在同一*印刷行中**配对*）

     *完全双引号文本的解决方法（受[*Windows batch: echo without new line*](https://stackoverflow.com/q/7105433/1744774)启发）：

    ```
    set BEGIN_QUOTE=echo ^| set /p !="""
    ...
    %BEGIN_QUOTE%
    echo %\n%...after newline. Before newline...%\n%...after newline" 
    ```** 

 **它适用于完全单引号的文本，例如：

```
echo '%\n%...after newline. Before newline...%\n%...after newline' 
```

#### 附加值：转义字符

| 笔记 |
| --- |
| ' ' 后面有一个字符，`=`但您在这里看不到它，但在编辑模式下。C&P 在这里工作。 |

```
:: Escape character - useful for color codes when 'echo'ing
:: See https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences#text-formatting
set ESC= 
```

有关颜色，另请参见[https://imgur.com/a/EuNXEar](https://imgur.com/a/EuNXEar)和[https://gist.github.com/gerib/f2562474e7ca0d3cda600366ee4b8a45](https://gist.github.com/gerib/f2562474e7ca0d3cda600366ee4b8a45)。

#### 第二个附加值：轻松获取 Unicode 字符

按关键字获取 87,461 个 Unicode 字符 (AToW) 的绝佳页面：[https](https://www.amp-what.com/) ://www.amp-what.com/ 。

# 原因

*   [肯的​​答案](https://stackoverflow.com/a/269819/1744774)中的版本显然有效（我没有尝试过），但不知何故......嗯......你看：

    ```
    set NLM=^

    set NL=^^^%NLM%%NLM%^%NLM%%NLM% 
    ```

*   从[user2605194](https://stackoverflow.com/a/24792710/1744774)和[user287293](https://stackoverflow.com/a/2388384/1744774)`=`的答案派生的版本（在 ' ' 和 ' '之间没有任何内容`^`）：

    ```
    set nl=^&echo:
    set \n=^&echo: 
    ```

    `echo`部分工作，但由于要编辑的行开头的变量而失败：

    ```
    > echo %\n%Hello%\n%World!
    echo   & echo:Hello & echo:World!
    echo is ON.
    Hello
    World 
    ```

    由于第一个的空白参数`echo`。

*   所有其他人或多或少都`echo`明确地调用了 3 。

*   我喜欢短的单行字。

# 背后的故事

为了防止`set \n=^&echo:`此处的答案中的建议回显空白（以及打印其状态），我首先记得`Alt`+`2``5``5`用户是在 Novell 是一个广泛使用的网络并使用[437](https://en.wikipedia.org/wiki/Code_page_437)和[850](https://en.wikipedia.org/wiki/Code_page_850)之类的代码页时。但是现在 Unicode 中的 0d255/0xFF 是[›Ÿ‹（带分音符号的拉丁文小写字母 Y）](https://en.wikipedia.org/wiki/Diaeresis_(diacritic))。

然后我记得[Unicode](https://en.wikipedia.org/wiki/Whitespace_character#Unicode)中的[空格](https://www.amp-what.com/unicode/search/space)比普通的 0d32/0x20 多，但它们都被认为是空格并导致与 ›␣‹ 相同的行为。

但还有更多：*零宽度空格*和不被视为空格的连接符*。*它们的问题是，你不能对它们进行 C&P，因为它们的宽度为零，没有什么可供选择的。所以，我复制了一个接近其中之一的*头发空间*（U+200A），它就在*零宽度空间*（U+200B）之前到 Notepad++，打开它的 Hex-Editor 插件，找到它的位表示`E2 80 8A`并更改它到`E2 80 8B`. 成功！`\n`我有一个在我的环境变量中不可见的非空白字符。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-06-02T15:35:47.180

这对我有用，不需要延迟扩展：

```
@echo off
(
echo ^<html^> 
echo ^<body^>
echo Hello
echo ^</body^>
echo ^</html^>
)
pause 
```

它像这样写输出：

```
<html>
<body>
Hello
</body>
</html>
Press any key to continue . . . 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-07-18T13:22:07.423

您可以使用`@echo`（@echo + [space] + [insecable space]）

注意：不可分割的空间可以通过 Alt+0160 获得

希望能帮助到你 ：）

[编辑] 嗯，你是对的，我需要它在 Makefile 中，它在那里完美运行。我想我的答案不适用于批处理文件......我的错。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-04-30T04:04:44.933

简单的

```
set nl=.
echo hello
echo%nl%
REM without space ^^^
echo World 
```

结果：

```
hello
world 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-10-31T19:19:20.857

请注意，这在控制台中不起作用，因为它会模拟转义键并清除线路。

使用此代码，替换`<ESC>`为 0x1b 转义字符或使用[此 Pastebin 链接](https://pastebin.com/xLWKTQZQ)：

```
:: Replace <ESC> with the 0x1b escape character or copy from this Pastebin:
:: https://pastebin.com/xLWKTQZQ

echo Hello<ESC>[Eworld!

:: OR

set "\n=<ESC>[E"
echo Hello%\n%world! 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2022-01-31T21:34:00.707

在肯的答案中添加一个变体，显示环境变量的设置值，其中包含新行。

我们使用这种方法将错误条件附加到 VAR 中的字符串，然后在所有错误检查结束时输出到文件作为所有错误的摘要。

这不是完整的代码，只是一个示例。

```
@echo off
SETLOCAL ENABLEDELAYEDEXPANSION
:: the two blank lines are required!
set NLM=^

set NL=^^^%NLM%%NLM%^%NLM%%NLM%
:: Example Usage:

Set ErrMsg=Start Reporting:
:: some logic here finds an error condition and appends the error report
set ErrMsg=!ErrMsg!!NL!Error Title1!NL!Description!NL!Summary!NL!

:: some logic here finds another error condition and appends the error report
set ErrMsg=!ErrMsg!!NL!Error Title2!NL!Description!NL!Summary!NL!

:: some logic here finds another error condition and appends the error report
set ErrMsg=!ErrMsg!!NL!Error Title3!NL!Description!NL!Summary!NL!

echo %ErrMsg%
pause
echo %ErrMsg% > MyLogFile.log 
```

日志和屏幕输出如下所示...

[![脚本的日志输出](https://i.stack.imgur.com/3X0G9.png)](https://i.stack.imgur.com/3X0G9.png)

[![脚本的屏幕输出](https://i.stack.imgur.com/F8OGE.png)](https://i.stack.imgur.com/F8OGE.png)

# reporting-services - 授予用户 ' 的权限不足以执行此操作。(rsAccessDenied)"}

> ID：132812
> 
> 赞同：105
> 
> 时间：2008-09-25T11:52:19.757
> 
> 标签：reporting-services, reporting, reportingservices-2005

我使用 SSRS (2005) 创建了一个报表模型并发布到本地服务器。但是，当我尝试为使用报告生成器发布的模型运行报告时，我收到以下错误。

> 报告执行错误：授予用户的权限不足以执行此操作。(rsAccessDenied)

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2011-06-20T06:23:16.060

这是因为您运行报表生成器的用户没有权限，只需授予该用户或组运行报表生成器的权限即可。请访问这篇[文章](http://www.gotknowhow.com/articles/reportserver-permissions-granted-are-insufficient-for-performing-this-operation-rsaccessdenied)

或快捷方式：

1.  使用“以管理员身份运行”启动 Internet Explorer
2.  打开[http://localhost/reports](http://localhost/reports)
3.  转到属性选项卡 (SSRS 2008)
4.  安全性->新角色分配
5.  添加 DOMAIN/USERNAME 或 DOMAIN/USERGROUP
6.  检查报告生成器

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-06-09T06:40:10.583

我知道这是很久以前的事了，但是您（或任何其他新来者）可以通过以下方式解决此问题

1.  将 [Domain\User] 添加到**Administrator**、**IISUser**、**SQLReportingUser**组
2.  **删除SSRS 配置工具中的**加密密钥****
***   在 SSRS 配置工具中重新运行**数据库更改***   **从 SSRS 配置工具打开**WebServiceUrl ( **[http://localhost/reportserver](http://localhost/reportserver)** )*   **手动**创建报告文件夹***   转到已创建文件夹的属性**并将这些角色添加**到安全性（**builtin\users、builtin\Administrator、domain\user**）*   **部署**您的报告并解决您的问题****

 ***** * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-07-06T15:40:00.037

右键单击 Microsoft BI -> 单击以管理员身份运行 -> 打开现有的 SSRS 报告或创建新的 SSRS 报告，然后在编译完成后部署您的报告，您将收到一个用于查看报告的 Web URL。复制该 URL 并粘贴到 Web 浏览器（以管理员身份运行），您将获得报告视图。您可以使用 Internet Explorer，这对于 Web 服务来说是必不可少的

如果是错误的意思，请原谅我，因为我确实喜欢这样，所以我只是写了。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-08-26T11:58:43.577

确保您已使用 SQL Reporting Services 配置配置了对 URL [http://localhost/reports的访问权限。](http://localhost/reports)去做这个：

1.  打开 Reporting Services 配置管理器 -> 然后连接到报表服务器实例 -> 然后单击报表管理器 URL。
2.  在 Report Manager URL 页面中，单击 Advanced 按钮 -> 然后在 Report Manager 的 Multiple Identities 中单击 Add。
3.  在 Add a Report Manager HTTP URL 弹出框中，选择 Host Header 并输入：localhost
4.  单击确定以保存您的更改。
5.  [现在使用 Run as Administator 启动/运行 Internet Explorer...（注意：如果您在http://localhost/reports](http://localhost/reports)时没有在左上角看到“站点设置”链接，可能是因为您不是以管理员身份运行 IE，或者您尚未将计算机“域\用户名”分配给报告服务角色，请参阅接下来的几个步骤中如何执行此操作。）
6.  然后转到：[http://localhost/reports](http://localhost/reports) （您可能需要使用计算机的用户名和密码登录）
7.  您现在应该被定向到 SQL Server Reporting Services 的主页：[http://localhost/Reports/Pages/Folder.aspx](http://localhost/Reports/Pages/Folder.aspx)
8.  在主页中，单击属性选项卡，然后单击新建角色分配
9.  在组或用户名文本框中，添加错误消息中的“域\用户名”（在我的情况下，我添加了：DOUGDELL3-PC\DOUGDELL3 用于“域\用户名”，在您的情况下，您可以找到域\username 为您的计算机在 rsAccessDenied 错误消息中）。
10.  现在检查所有复选框；浏览器、内容管理器、我的报告、发布者、报告生成器，然后单击确定。
11.  您的域\用户名现在应该被分配给角色，这些角色将使您能够访问将报表部署到报表服务器。如果您使用 Visual Studio 或 SQL Server Business Intelligence Development Studio 将报表部署到本地报表服务器，您现在应该可以了。
12.  希望这可以帮助您解决 Reports Server rsAccessDenied 错误消息...

只是为了让您知道本教程是在装有 SQL Server Reporting Services 2008 的 Windows 7 计算机上完成的。

参考文章：[http ://techasp.blogspot.co.uk/2013/06/how-to-fix-reporting-services.html](http://techasp.blogspot.co.uk/2013/06/how-to-fix-reporting-services.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-03-31T17:03:48.957

您还可以确保应用程序池中的身份具有正确的权限。

1.  转到 IIS 管理器

2.  单击应用程序池

3.  确定要部署报告的站点的应用程序池

4.  检查身份是否设置为具有管理员权限的某个服务帐户或用户帐户

5.  您可以通过停止池、右键单击它并选择高级设置来更改身份...

在流程模型下是身份字段

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-01-31T19:00:56.760

**我使用了以下步骤，它对我有用。**

打开 Reporting Services 配置管理器 -> 然后连接到报表服务器实例 -> 然后单击报表管理器 URL。

在 Report Manager URL 页面中，单击 Advanced 按钮 -> 然后在 Report Manager 的 Multiple Identities 中单击 Add。

在 Add a Report Manager HTTP URL 弹出框中，选择 Host Header 并输入： localhost 单击 OK 保存更改。

然后：

1.  复制了报表服务器 URL
2.  以管理员身份运行 Google chrome/Internet Explorer
3.  将 URL 粘贴到地址栏中，然后按 Enter。

**它在 Internet Explorer 和 Google Chrome 上运行良好，但不适用于 mozilla Firefox。**

如果 Firefox 要求输入用户名和密码，我会提供它，但它不起作用。我是管理员，拥有完全的权利。

我已经完成了 1 个更改集“用户帐户控制设置”以从不通知。

**如果您在从 Visual Studio 部署此报告时遇到此类异常，请执行以下操作：**

1.  使用管理员权限打开 Google chrome/Internet Explorer。
2.  在其中打开报表服务器 URL。

3.单击“新角色分配”添加，然后输入用户名并选择角色。[![在此处输入图像描述](https://i.stack.imgur.com/likyD.png)](https://i.stack.imgur.com/likyD.png)

4.  点击确定。
5.  现在从 Visual Studio 部署报告，它将工作并在指定的服务器上部署报告。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-08-24T23:22:56.550

我有 SQL2008 / Windows 2008 Enterprise，这是我必须做的以纠正`rs.accessdenied`、404、401 和 503 错误：

*   将 NT 用户添加到 SQL 报表服务器用户和 IIS_USR 组
*   我将 SQL 报告服务更改为本地帐户（它是具有本地管理员的域）
*   我删除了 Reporting Services 配置中的加密密钥（列表中的最后一个选项卡）
*   然后它起作用了。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-12-09T21:34:26.127

在报告管理器中的站点设置>配置系统级角色定义>检查执行报告定义选项，然后创建系统用户组，在服务器属性中的连接到您的报告服务数据库中授予对该组的访问权限，然后添加一个组并允许访问权限为系统用户...它应该工作

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-07-09T07:03:06.400

以管理员身份打开 Internet Explorer。

打开报告网址`http://machinename/reportservername`

然后在“文件夹设置”中授予所需用户组的权限。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-05-22T18:57:45.890

旧但相关的问题。我通过登录报告服务器解决了 2012 年的问题，并且：

*   浏览到[http://localhost/reports/](http://localhost/reports/)
*   单击右上角的“站点设置”（仅在登录报表服务器时可用）
*   转到“安全”选项卡，然后单击“新角色分配”
*   将我的 DOMAIN\USERNAME 添加为系统管理员

不能说我对这个解决方案感到满意，但我需要一些行之有效的东西。希望这对其他人有帮助。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-04-25T13:51:23.573

设置 SSRS 2016 后，我 RDP 进入服务器 (Windows Server 2012 R2)，导航到报告 URL ( [https://reports.fakeserver.net/Reports/browse/](https://reports.fakeserver.net/Reports/browse/) ) 并创建了一个文件夹标题 FakeFolder；一切似乎都运行良好。然后我断开与服务器的连接，浏览到相同的 URL，以相同的用户身份登录，并遇到以下错误。

> 授予用户“fakeserver\mitchs”的权限不足以执行此操作。

很困惑，我几乎尝试了此页面上建议的所有解决方案，但在导航到 URL 并进行身份验证时，仍然无法在本地和外部创建相同的行为。然后我单击 FakeFolder 的省略号，单击管理，单击安全（在屏幕左侧），然后将自己添加为具有完全权限的用户。与服务器断开连接后，我浏览到[https://reports.fakeserver.net/Reports/browse/FakeFolder](https://reports.fakeserver.net/Reports/browse/FakeFolder)，并且能够查看文件夹的内容而不会遇到权限错误。但是，当我单击主页时，我收到了权限错误。

就我的目的而言，这已经足够好了，因为其他任何人都不需要浏览到根 URL，所以每当我需要在 SSRS 中进行更改以首先连接到服务器然后浏览到报告 URL 时，我都会在心里记下.

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-02-23T01:31:35.863

问题：

错误 rsAccessDenied：授予用户“用户\用户”的权限不足以执行此操作。

解决方案：

单击“文件夹设置”>“新角色分配”，然后在“组或用户名文本框”中键入“用户\用户”。选中您希望用户拥有的角色复选框。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-03-12T10:20:52.457

对我有用的是：

```
Open localhost/reports
Go to properties tab (SSRS 2008)
Security->New Role Assignment
Add DOMAIN/USERNAME or DOMAIN/USERGROUP
Check Report builder 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-01-14T14:00:32.690

报表可能想要访问 AD 用户（或 AD 组）访问权限不足的 DataSource 或 DataView。

确保检查以下 URL：

*   `http://REPORTSERVERNAME/Reports/Pages/Folder.aspx?ItemPath=%2fDataSources`
*   `http://REPORTSERVERNAME/Reports/Pages/Folder.aspx?ItemPath=%2fDataSets`

然后选择`Folder Settings`

[![文件夹设置](https://i.stack.imgur.com/kuHQI.png)](https://i.stack.imgur.com/kuHQI.png)

（或适当的个人`DataSource`或`DataSet`）并选择`Security`。用户组需要有`Browser`权限。

[![在此处输入图像描述](https://i.stack.imgur.com/yTdyU.png)](https://i.stack.imgur.com/yTdyU.png)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-10-24T14:29:47.873

我知道这是很久以前的事了，但可能对任何其他新人有帮助，

我决定在请求 SSRS 报告时传递用户名、密码和域，所以我创建了一个实现 IReportServerCredentials 的类。

```
 public class ReportServerCredentials : IReportServerCredentials   
{
    #region  Class Members
        private string username;
        private string password;
        private string domain;
    #endregion

    #region Constructor
        public ReportServerCredentials()
        {}
        public ReportServerCredentials(string username)
        {
            this.Username = username;
        }
        public ReportServerCredentials(string username, string password)
        {
            this.Username = username;
            this.Password = password;
        }
        public ReportServerCredentials(string username, string password, string domain)
        {
            this.Username = username;
            this.Password = password;
            this.Domain = domain;
        }
    #endregion

    #region Properties
        public string Username
        {
            get { return this.username; }
            set { this.username = value; }
        }
        public string Password
        {
            get { return this.password; }
            set { this.password = value; }
        }
        public string Domain
        {
            get { return this.domain; }
            set { this.domain = value; }
        }
        public WindowsIdentity ImpersonationUser
        {
            get { return null; }
        }
        public ICredentials NetworkCredentials
        {
            get
            {
                return new NetworkCredential(Username, Password, Domain);
            }
        }
    #endregion

    bool IReportServerCredentials.GetFormsCredentials(out System.Net.Cookie authCookie, out string userName, out string password, out string authority)
    {
        authCookie = null;
        userName = password = authority = null;
        return false;
    }
} 
```

在调用 SSRS Reprots 时，输入以下代码

```
 ReportViewer rptViewer = new ReportViewer();
 string RptUserName = Convert.ToString(ConfigurationManager.AppSettings["SSRSReportUser"]);
        string RptUserPassword = Convert.ToString(ConfigurationManager.AppSettings["SSRSReportUserPassword"]);
        string RptUserDomain = Convert.ToString(ConfigurationManager.AppSettings["SSRSReportUserDomain"]);
        string SSRSReportURL = Convert.ToString(ConfigurationManager.AppSettings["SSRSReportURL"]);
        string SSRSReportFolder = Convert.ToString(ConfigurationManager.AppSettings["SSRSReportFolder"]);

        IReportServerCredentials reportCredentials = new ReportServerCredentials(RptUserName, RptUserPassword, RptUserDomain);
        rptViewer.ServerReport.ReportServerCredentials = reportCredentials;
        rptViewer.ServerReport.ReportServerUrl = new Uri(SSRSReportURL); 
```

SSRSReportUser、SSRSReportUserPassword、SSRSReportUserDomain、SSRSReportFolder 在 web.config 文件中定义。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-03-11T22:57:08.883

这对我有用--转到报告管理器，检查站点设置-> 安全性-> 新角色分配-> 添加用户

-另外，转到报表管理器中的数据集 -> 您的报表数据集 -> 安全 -> 新角色分配 -> 添加具有所需角色的用户。

谢谢！

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-07-26T17:54:49.860

就像 Nasser 一样，我知道这是不久前的事，但我想为将来遇到此问题的任何人发布我的解决方案。

我设置了报表，以便它使用 SharePoint 上托管的数据连接库中的数据连接。我的问题是我没有“批准”数据连接，因此其他用户可以使用它。

要寻找的另一件事是确保该数据连接库的权限也允许读取选择用户。

希望这迟早会对某人有所帮助！

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-09-25T18:07:22.733

对于 SQL Reporting Services 2012 - SP1 和 SharePoint 2013。

我遇到了同样的问题：授予用户“[AppPoolAccount]”的权限不足以执行此操作。

我进入服务应用程序设置，单击密钥管理，然后单击更改密钥并让它重新生成密钥。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-01-05T10:05:44.923

感谢分享。挣扎了 1.5 天后，发现 Report Server 配置了错误的域 IP。它配置了离线的备份域 IP。我在未列出域名的用户组配置中确定了这一点。更改 IP 并重新启动报告服务器。问题解决了。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-05-03T07:02:47.017

尽管管理员组的现有成员身份，但以管理员身份运行 BIDS。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-09-04T02:23:03.460

对我有用的是：

*   进入网站设置
*   单击“配置站点范围的安全性”
*   单击顶部栏中的“新角色分配”按钮
*   将新角色命名为“所有人”
*   在可用角色中，仅授予它“系统用户”
*   点击“申请”

应该这样做，

祝你好运！

# c# - ThreadStatic 对象的确定性处理

> ID：132830
> 
> 赞同：10
> 
> 时间：2008-09-25T11:55:11.183
> 
> 标签：c#, .net, multithreading, dispose, thread-static

[ThreadStatic 属性](https://stackoverflow.com/questions/9033?#13932)将静态变量声明为每个线程唯一。您知道正确处理此类变量的简单模式吗？

我们在 ThreadStatic 之前使用的是 ThreadContextManager。每个线程都被分配了一个 ThreadContext，它保留了所有线程特定的信息。我们产生了一些线程并让它们工作。然后，当它们都完成后，我们释放了 ThreadContentManager，如果它们是 IDisposable，它会依次释放所有上下文。

我看不到将这种模式转换为 ThreadStatic 对象的直接方法。这些对象最终会被处理掉，因为线程死掉了，所以没有任何东西引用它们。但是，我们尽可能倾向于确定性处置。

**更新**

我并没有真正直接控制线程——我使用的是 Microsoft CCR，它有一个执行任务的 ThreadPool。完成所有任务后，我将处理 Dispatcher（它包含线程池）。问题是 - 我没有机会“在线程的主要功能结束时”做任何事情 - 所以我不能在线程运行结束时手动处理事情。我可以以某种方式从线程外部访问线程的静态对象吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T12:02:55.940

您仍然可以使用等效的 ThreadContextManager 类来处理处置。产生的线程处理这个“管理器”对象，然后取出它知道的所有其他线程静态对象。

我更喜欢使用相对较少的线程静态对象，而是使用上下文对象。这将线程特定的状态保留在几个地方，并使这样的模式更容易。

**更新：**要处理线程池情况，您可以创建一个基本“任务”对象，该对象是您传递给线程池的对象。它可以执行您的代码所需的任何通用初始化，调用“真实”任务，然后执行所需的任何清理。

# batch-file - 使用批处理文件进行自动化测试：

> ID：132857
> 
> 赞同：2
> 
> 时间：2008-09-25T11:59:57.350
> 
> 标签：batch-file, automated-tests, dos

我的测试套件有以下布局：

测试套件1.cmd：

1.  运行我的程序
2.  检查其返回结果
3.  如果返回结果不为 0，则将错误转换为文本输出并中止脚本。如果成功，写出成功。

在我的单个 .cmd 文件中，我用不同的输入调用我的程序大约 10 次。

问题是我运行 10 次的程序每次都需要几个小时才能运行。

有没有办法让我并行化我的程序的所有这 10 次运行，同时仍然以某种方式检查返回结果并提供正确的输出文件，同时仍然使用**单个**.cmd 文件和单个输出文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T12:06:03.217

假设它们不会通过写入相同的文件等方式相互干扰：

test1.cmd

```
:: intercept sub-calls.
  if "%1"=="test2" then goto :test2

:: start sub-calls.
  start test1.cmd test2 1
  start test1.cmd test2 2
  start test1.cmd test2 3

:: wait for sub-calls to complete.
:loop1
  if not exist test2_1.flg goto :loop1
:loop2
  if not exist test2_2.flg goto :loop2
:loop3
  if not exist test2_3.flg goto :loop3

:: output results sequentially
  type test2_1.out >test1.out
    del /s test2_1.out
    del /s test2_1.flg
  type test2_2.out >test1.out
    del /s test2_2.out
    del /s test2_2.flg
  type test2_3.out >test1.out
    del /s test2_3.out
    del /s test2_3.flg

  goto :eof
:test2

:: Generate one output file
  echo %1 >test2_%1.out
  ping -n 31 127.0.0.1 >nul: 2>nul:

:: generate flag file to indicate finished
  echo x >test2_%1.flg 
```

这将启动三个并发进程，每个进程都回显它的序列号，然后等待 30 秒。

全部带有一个 cmd 文件和（最终）一个输出文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T12:04:48.930

可以通过“启动”可执行文件/命令在批处理文件中并行运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T12:06:34.463

视窗：

您创建一个基本上调用的批处理文件：

```
start TestSuite1.cmd [TestParams1]
start TestSuite1.cmd [TestParams2] 
```

等等，本质上是分叉新的命令行，

如果应用程序可以处理并发用户（即使它是同一个用户），并且您的 TestSuite1.cmd 能够处理参数，这将起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T12:03:45.860

尝试命令**start**，它会产生一个新的命令提示符，您可以发送任何您希望它运行的命令。

我将使用它来生成运行测试的批处理文件，然后使用 >> 附加到 output.txt 中：

```
testthingie.cmd >> output.txt 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T12:11:51.020

You will need to start the script with different parameters *on different machines* because whatever makes the program take so long for a task (IO, CPU time) will be in even shorter supply when multiple instances of your program run at once.

Only exception: the run time is cause by the program putting itself to sleep.

# visio - 如何将操作添加到 visio (2003)

> ID：132860
> 
> 赞同：1
> 
> 时间：2008-09-25T12:00:09.907
> 
> 标签：visio, shapesheet

在 visio shapesheet 中，可以添加操作。我想创建一个操作来更新另一个单元格的值（控件的位置）。怎么可能做到这一点。是需要单独的宏，还是可以直接指定？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T17:57:27.350

您不需要插件或宏，您可以在 Shapesheet 中执行此操作。

在 Shapesheet 中查找 Action 部分。如果你没有找到它，请右键单击并添加它。在 Action 部分中添加一行。将单元格设置为：

```
Action = SETF(GetRef(Controls.Row_1),"2 in.")+SETF(GetRef(Controls.Row_1.Y),"2 in.")
Menu = "Move Control" 
```

将 Row_1 更改为您的控制行的名称。您也可以更改“2 英寸”。对您计算新位置的单元格的引用。

要了解更多信息，请参阅：

[MSDN：快捷菜单命令](http://msdn.microsoft.com/en-us/library/aa200979(office.10).aspx)

[Bill Morein 的：认识 Shapesheet 函数：Setf](http://blogs.msdn.com/wmorein/archive/2006/08/09/693527.aspx)

# ruby - 我安装了一个 gem，但 require 'gemname' 不起作用。为什么？

> ID：132867
> 
> 赞同：63
> 
> 时间：2008-09-25T12:01:13.993
> 
> 标签：ruby, rubygems

我真正要问的问题是为什么 require 不采用 gem 的名称。另外，如果没有，最简单的方法是找到需要该死的东西的秘密咒语！？

例如，如果我已经`memcache-client`安装了，那么我必须使用它来要求它

```
require 'rubygems'
require 'memcache' 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-09-27T20:11:33.600

我的系统似乎也不知道 RubyGems 的存在——除非我告诉它。'require' 命令被 RubyGems 覆盖，因此它可以加载 gem，但除非您已经需要 RubyGems，否则它不知道如何执行此操作。所以如果你自己写，你可以这样做：

```
require 'rubygems'
require 'gem-name-here' 
```

如果您正在运行其他人的代码，您可以在命令行上执行以下操作：

```
ruby -r rubygems script.rb 
```

此外，Ruby 还使用一个环境变量来确定它应该在启动时加载什么：

```
export RUBYOPT=rubygems 
```

（来自[http://www.rubygems.org/read/chapter/3](http://www.rubygems.org/read/chapter/3) [。Orion Edwards](https://stackoverflow.com/users/234/orion-edwards)向我指出了环境变量的事情）

（但是，如果“require 'rubygems' 对您不起作用，则此建议的帮助有限：）

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-09-25T12:23:49.367

您需要包含的文件没有标准。但是，您可以尝试并使用一些常用的约定：

*   该文件通常与 gem 同名。所以`require mygem` 会起作用。
*   通常该文件是 gem 的 lib 子目录中唯一的 .rb 文件，因此，如果您可以获得 gem 的名称（也许您在 2.1 之前的 rails 项目中遍历 vendor/gems），那么您可以检查 `#{gemname}/lib`. rb 文件，如果只有一个，这是一个很好的选择

如果所有这些都有效，那么您所能做的就是查看 gem 的目录（您可以通过运行`gem environment | grep INSTALLATION | awk '{print $4}'`并查看 lib 目录来找到该目录，您可能需要阅读文件并希望有注释说明该怎么做

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-25T12:05:18.430

require 必须映射到 ruby​​ 路径中的文件。您可以通过运行“gem environment”（查找安装目录）找到 gem 的安装位置：

```
kburton@hypothesisf:~$ gem environment
RubyGems Environment:
  - RUBYGEMS VERSION: 1.2.0
  - RUBY VERSION: 1.8.7 (2008-08-08 patchlevel 71) [i686-linux]
  - INSTALLATION DIRECTORY: /usr/local/ruby/lib/ruby/gems/1.8
  - RUBY EXECUTABLE: /usr/local/ruby/bin/ruby
  - EXECUTABLE DIRECTORY: /usr/local/ruby/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86-linux
  - GEM PATHS:
     - /usr/local/ruby/lib/ruby/gems/1.8
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://gems.rubyforge.org/
kburton@editconf:~$ 
```

然后，您可以查找您尝试要求的特定 .rb 文件。此外，您可以打印 $: from irb 的内容以查看 ruby​​ 将搜索模块的路径列表：

```
kburton@hypothesis:~$ irb
irb(main):001:0> $:
=> ["/usr/local/ruby/lib/ruby/site_ruby/1.8", "/usr/local/ruby/lib/ruby/site_ruby/1.8/i686-linux", "/usr/local/ruby/lib/ruby/site_ruby", "/usr/local/ruby/lib/ruby/vendor_ruby/1.8", "/usr/local/ruby/lib/ruby/vendor_ruby/1.8/i686-linux", "/usr/local/ruby/lib/ruby/vendor_ruby", "/usr/local/ruby/lib/ruby/1.8", "/usr/local/ruby/lib/ruby/1.8/i686-linux", "."]
irb(main):002:0> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-01-12T02:59:26.463

Rails 的人们也应该记得在安装 gem 后**重新启动 rails 服务器**

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-25T12:04:15.030

仅当您使用**gem**安装 gem 时才需要包含“rubygems” 。否则，秘密咒语将是点燃**irb**并尝试不同的组合。此外，您可以将**-I**选项传递给 ruby​​ 解释器，以便在**LOAD_PATH**中包含 gem 的安装目录。请注意，**$LOAD_PATH**是一个数组，这意味着您可以从脚本中向其中添加目录。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T21:36:20.320

> 我真正要问的问题是为什么 require 不采用 gem 的名称。

安装 gem 会将文件放到您的系统上。它没有对这些文件将被调用什么做出任何声明。
[正如 laurie 指出的那样](https://stackoverflow.com/questions/132867/i-have-a-gem-installed-but-require-gemname-does-not-work-why#132970)，它们的命名方式有几种约定，但没有什么可以强制执行的，不幸的是，许多 gem 作者并没有遵守它们。

> 另外，如果没有，最简单的方法是找到需要该死的东西的秘密咒语！？

阅读您的 gem 的文档？
我发现谷歌搜索`rdoc gemname`通常会找到[你的 gem 的官方 rdocs](http://dareddevelopment.com/rdoc/memcache-client-1.5.0/rdoc/)，它通常会告诉你如何使用它。

Memcache 可能不是最好的例子，因为他们假设您将从 Rails 中使用它，并且“要求”已经为您完成，但我见过的大多数其他例子都有显示正确“要求”的示例咒语

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-05-08T02:11:24.843

我遇到了这个问题，因为我使用 rvm 并且试图使用错误版本的 ruby​​。有问题的 gem 需要 1.9.2，我已将 2.0.0 设置为默认值！也许是一个愚蠢的错误，但到达此页面的其他人可能会犯这个错误。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-27T04:37:02.180

我刚刚遇到的一个问题是实际构建的 gem 没有包含它应该具有的所有文件。

问题`files`是 gemspec 中存在语法错误，但在构建过程中没有引发错误。

只需在此处添加此内容，以防其他人遇到相同的问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-06-10T00:53:34.097

也可能是 gem 名称不匹配：

例如 `dummy-spi-0.1.1/lib/spi.rb`应该命名`dummy-spi-0.1.1/lib/dummy-spi.rb`

那么你就可以

```
require 'dummy-spi' 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-01T16:14:45.747

自从安装 OS X Lion 后，我也遇到了这个问题，发现即使我运行以下代码，我仍然会收到警告消息。 `require 'rubygems'` `require 'nokogiri'`

我尝试了在这里和网络上发布的大量解决方案，但最后我的解决方案是简单地按照[http://martinisoftware.com/2009/07/31/nokogiri-on-leopard.html](http://martinisoftware.com/2009/07/31/nokogiri-on-leopard.html)上的说明重新安装LibXML 和 LibXSLT 来自源代码，但确保我安装的 LibXML 版本与 Nokogiri 所期望的版本相匹配。

一旦我这样做了，警告就消失了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-08T12:00:58.980

观察 gem 的来源并检查`lib`目录。如果没有`rb`文件，则必须指向`rb`子目录中的 gem 主文件：

```
require 'dir/subdir/file' 
```

为`/lib/dir/subdir/file.rb`.

# version-control - 如何提高开发团队的 Joel Test 分数？

> ID：132872
> 
> 赞同：7
> 
> 时间：2008-09-25T12:02:13.443
> 
> 标签：version-control

[Joel Test](http://www.joelonsoftware.com/articles/fog0000000043.html)是一个很好的著名列表，它检查了每个软件公司应该关注的一些必要条件。

他们是：

1.  你使用源代码控制吗？
2.  您可以一步构建吗？
3.  你做日常构建吗？
4.  你有错误数据库吗？
5.  在编写新代码之前你会修复错误吗？
6.  你有最新的时间表吗？
7.  你有规格吗？
8.  程序员有安静的工作环境吗？
9.  您是否使用金钱可以买到的最好的工具？
10.  你有测试人员吗？
11.  新候选人在面试时会写代码吗？
12.  你做走廊可用性测试吗？

一个月前我到达那里时，我现在的公司得分为 0（我说是零）。现在我们“自豪地”实现了 3 项 - 源代码控制、一步构建和每日构建。但我正在尝试做更多（错误数据库、维基、安静的条件、更好的采访......）！

你的公司呢？有多少命中？列出你将做些什么来实现更多！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T12:13:36.460

我目前的项目：1 Y, 2 N, 3 N, 4 Y, 5 N, 6 N, 7 N, 8 N, 9 N, 10 Y, 11 N, 12 N
总分：3

你猜怎么着，很烂。开发团队一直在努力争取 2、3 和 5，但从未得到管理层的批准。操作软件漏洞百出，以至于黑客修复需要花费所有时间，并且不允许任何人进行这些“低优先级”类型的活动。

有趣的是，这个项目在 CMMI 5 级公司。去展示它的价值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T12:28:59.230

*   你使用源代码控制吗？

当然，我根本无法理解公司为什么看不到一个像样的源代码控制系统的必要性。我们正在使用 SVN。总分：1分。

*   您可以一步构建吗？

我们的构建过程至少需要 5 个步骤，尽管我们多次讨论了实现神奇的 1 步构建的方法，但我们还没有找到时间来实现该场景。总分：1分。

*   你做日常构建吗？

是的。如前所述，它们不是自动创建的，但我们将每日构建合并到我们每天执行的代码审查步骤中。总分：2分。

*   你有错误数据库吗？

是的，我们公司为此目的使用 Mantis。总分：3分。

*   在编写新代码之前你会修复错误吗？

不幸的是没有。新功能似乎比错误修正更重要。直到那时，它们肯定需要修复。这通常为时已晚。总分：3分。

*   你有最新的时间表吗？

我们一直在更新时间表，使用燃尽图来估计我们完成的时间。总分：4分。

*   你有规格吗？

我们有一些规范，但我不会将我们的项目称为规范完整。在我们公司这里有很大的改进空间。总分：4分。

*   程序员有安静的工作环境吗？

是的，我们的公司大楼位于一个安静的街区，同一个房间不超过 2 或 3 个开发商。总分：5分。

*   您是否使用金钱可以买到的最好的工具？

没有。总分：5分。

*   你有测试人员吗？

我们最近才实施了一个由三名测试人员组成的整个 QA 部门。总分：6分。

*   新候选人在面试时会写代码吗？

我们的团队没有太大的波动，但面试包含一些与编码相关的问题，候选人必须编写一些示例类等。总分：7 分。

*   你做走廊可用性测试吗？

不，很遗憾不是，但这是个好主意。总分：7分

总而言之，我认为还有很大的改进空间，但与我们合作的其他公司相比，7 分可能不是最差的分数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T12:05:00.567

现在，如果我们知道这个错误，我们有时会达到第 5 位，而且在 99% 的时间里，我们会达到第 5 位。

明天，我将开会推动 1、4、5、6 和 7。我认为你唯一能做的就是选择一两个然后去追求那些。设置一些东西，开始使用它们，并向其他人展示你的生活有多轻松/更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T12:12:53.793

一 (1) 个。我们有源代码控制。但它是一家小型初创公司，所以我仍然寄予厚望。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-25T12:35:10.510

当前公司在大多数项目中，有些更糟（更糟！）
1：Y，2：Y，3：Y，4：Y，5：N，6：N，7：通常，8：N，9：N， 10:N, 11:N, 12:N

对我来说，目前公司的大问题是 10 和 11。

尽管我们拥有 100 多名开发人员的开发资源，而不是一名专业测试人员，但我们没有专门的测试资源！你猜怎么着？测试不好，我对我们生产的应用程序的质量感到惊讶，这证明了我们一些开发团队的质量。

我们的面试过程糟透了。我们最近聘请的一位开发人员只有 C 和卫星光接收器的嵌入式代码背景。请记住，我们是 microsoft/.NET/VB6/SQL Server。他对任何描述或 WinForms 开发的数据库都没有经验。
当我询问他是如何被录用的时，面试小组中的技术负责人告诉我，人员禁止他问技术问题，因为当那个人被邀请参加面试时，他没有被告知这将是一个技术面试！

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-09-24T15:48:10.867

我对#11 感觉很复杂。一方面，我认为一些随意的面试白板问题可能会产生很大的误导。候选人并不总是期待它，他们很紧张并被要求在观众面前编码。呸！另一方面，我觉得您可以通过简短的计算机测验来了解某人如何适合您的组织。

如果您使用临时服务和临时雇用，如果您对他们的早期工作进行代码审查，这是否算数？然后工作就变成了测验。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-09-24T15:58:11.660

乔尔测试的问题在于，即使达到 12 也并不意味着你在为一家好公司工作。虽然如果你是零，你可能不是。

我目前有一个运行 7 的客户，这意味着理论上他们的表现还不错。事实上，由于其他问题（糟糕的架构、缺乏管理支持等），它们仍然被严重搞砸了。

# asp.net - 在 ASP.NET 中的 Development/UAT/Prod 环境之间切换配置的最佳方式？

> ID：132885
> 
> 赞同：10
> 
> 时间：2008-09-25T12:04:27.557
> 
> 标签：asp.net, configuration

在开发我的 Web 应用程序时，我需要在 3 个不同的环境之间切换 - 开发、UAT 和 Prod。我的所有 3 个配置文件中都有不同的数据库连接。我已经看到通过更改所有引用然后重新构建解决方案来手动切换这些设置，并且还使用预处理器指令完成。是否有一种基于某些变量的简单方法来执行此操作，以便每次部署到新环境时都不必修改配置？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-25T12:08:27.597

在我看来，您似乎可以从[Visual Studio 2005 Web 部署项目](http://msdn.microsoft.com/en-us/asp.net/aa336619.aspx)中受益。

有了它，您可以告诉它根据构建配置更新/修改 web.config 文件的部分。

请查看[Scott Gu 的这篇博客文章，](http://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)以获得快速概述/示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T12:14:22.137

我非常喜欢使用 MSBuild，尤其是 MSBuild 社区任务 ( [http://msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/) )，并且有一个 XSLT 任务可以使用适当的连接字符串设置等来转换 web.config。

我把这些任务放在手边：

```
<Target Name="Configs">
<Xslt RootTag="" Inputs="web.config" Output="Web.$(COMPUTERNAME).config" Xsl="web.config.$(COMPUTERNAME).xslt" Condition="Exists('web.config.$(COMPUTERNAME).xslt')" /> 
```

显然，这不是你所追求的 100%，这样每个开发人员都可以拥有自己的 web.config。

但是没有理由不能使用上述原则来拥有多个应用正确 XSLT 的构建配置。

我的 XSLT 看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<!-- Dev -->
<xsl:template match="/configuration/connectionStrings/add[@name='MyConnectionString']/@connectionString">
    <xsl:attribute name="connectionString">Data Source=MyServer;Initial Catalog=MyBD;User ID=user;password=pwd</xsl:attribute>
</xsl:template>
<xsl:template match="node()">
    <xsl:copy>
        <xsl:apply-templates select="@*"/>
        <xsl:apply-templates/>
    </xsl:copy>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T12:06:12.280

Scott Hanselman 提出了一种方法来做到这一点：

[http://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx](http://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-10T23:28:37.717

在构建过程中，您始终可以使用 NAnt + NAnt.Contrib 修改 web.config。NAnt 具有允许您更新 xml 文件的 xmlpeek 和 xmlpoke 任务。

例如

<xmlpoke 文件="${dist.dir}/Web.config" xpath="/configuration/applicationSettings/MyProj.Web.Properties.Settings/setting[@name = 'MyProj_Web_Service']/value" value="http:// /${AppServer}/Service.asmx" />

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T12:09:14.520

我采用了[Jean Paul Boodhoo](http://blog.jpboodhoo.com/AutomatingYourBuildsWithNAntPart6.aspx)更改配置的方法。总体思路是拥有一个或多个 TOKENIZED 配置模板文件，而不是配置文件本身。然后，您有一个构建脚本任务，该任务将标记替换为单个本地属性文件中的值。此属性文件包含配置中的所有差异，并且每个工作副本都是唯一的。

这个系统对我来说效果很好，一旦开始设置就可以轻松管理环境变化。

# java - 从 DTD 生成 XML 绑定代码的最佳方法是什么？

> ID：132895
> 
> 赞同：1
> 
> 时间：2008-09-25T12:06:48.567
> 
> 标签：java, xml, binding, schema, dtd

大多数 Java-XML 绑定框架和代码生成器都需要 XML 模式定义。您能否建议从 DTD 生成绑定代码的最佳方法。

我知道 JAXB 2 中的 XJC 支持 DTD，但它被认为是实验性的。

本着 Stack Overflow 的精神，请为每个答案提供一个建议 - 投赞成票或反对票，而不是重复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T12:21:33.820

将 DTD 转换为模式（许多在线和离线工具可用）。这一步应该是无损的。现在将此模式与您最喜欢的 Java-XML 绑定框架和/或需要模式定义的代码生成器一起使用。

# mysql - 如何将 mysqldump 的输出拆分为较小的文件？

> ID：132902
> 
> 赞同：50
> 
> 时间：2008-09-25T12:08:05.520
> 
> 标签：mysql, migration

我需要将整个表从一个 MySQL 数据库移动到另一个。我没有对第二个的完全访问权限，只有 phpMyAdmin 访问权限。我只能上传（压缩）小于 2MB 的 sql 文件。但是第一个数据库表的 mysqldump 的压缩输出大于 10MB。

有没有办法将 mysqldump 的输出拆分成更小的文件？我不能使用 split(1)，因为我不能 cat(1) 将文件返回到远程服务器上。

还是我错过了另一种解决方案？

**编辑**

第一张海报建议的 mysqldump 的 --extended-insert=FALSE 选项会生成一个 .sql 文件，然后可以将其拆分为可导入的文件，前提是使用合适的 --lines 选项调用 split(1)。通过反复试验，我发现 bzip2 将 .sql 文件压缩了 20 倍，因此我需要弄清楚有多少行 sql 代码大致对应于 40MB。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-03-30T19:37:16.673

此 bash 脚本将一个数据库的转储文件拆分为每个表的单独文件，并使用[csplit](http://linux.die.net/man/1/csplit)命名并相应地命名它们：

```
#!/bin/bash

####
# Split MySQL dump SQL file into one file per table
# based on https://gist.github.com/jasny/1608062
####

#adjust this to your case:
START="/-- Table structure for table/"
# or 
#START="/DROP TABLE IF EXISTS/"

if [ $# -lt 1 ] || [[ $1 == "--help" ]] || [[ $1 == "-h" ]] ; then
        echo "USAGE: extract all tables:"
        echo " $0 DUMP_FILE"
        echo "extract one table:"
        echo " $0 DUMP_FILE [TABLE]"
        exit
fi

if [ $# -ge 2 ] ; then
        #extract one table $2
        csplit -s -ftable $1 "/-- Table structure for table/" "%-- Table structure for table \`$2\`%" "/-- Table structure for table/" "%40103 SET TIME_ZONE=@OLD_TIME_ZONE%1"
else
        #extract all tables
        csplit -s -ftable $1 "$START" {*}
fi

[ $? -eq 0 ] || exit

mv table00 head

FILE=`ls -1 table* | tail -n 1`
if [ $# -ge 2 ] ; then
        # cut off all other tables
        mv $FILE foot
else
        # cut off the end of each file
        csplit -b '%d' -s -f$FILE $FILE "/40103 SET TIME_ZONE=@OLD_TIME_ZONE/" {*}
        mv ${FILE}1 foot
fi

for FILE in `ls -1 table*`; do
        NAME=`head -n1 $FILE | cut -d$'\x60' -f2`
        cat head $FILE foot > "$NAME.sql"
done

rm head foot table* 
```

基于[https://gist.github.com/jasny/1608062](https://gist.github.com/jasny/1608062)
和[https://stackoverflow.com/a/16840625/1069083](https://stackoverflow.com/a/16840625/1069083)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-09-25T12:16:05.517

首先转储模式（它肯定适合 2Mb，不是吗？）

```
mysqldump -d --all-databases 
```

并恢复它。

之后仅在单独的插入语句中转储数据，因此您可以拆分文件并恢复它们，而无需在远程服务器上连接它们

```
mysqldump --all-databases --extended-insert=FALSE --no-create-info=TRUE 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-02-25T12:49:00.373

有一个出色的[mysqldumpsplitter](http://kedar.nitty-witty.com/blog/mydumpsplitter-extract-tables-from-mysql-dump-shell-script)脚本，它在从 mysqldump 中提取时提供了大量选项。

我会在这里复制食谱以选择您的案例：

> 1）从mysqldump中提取单个数据库：
> 
> `sh mysqldumpsplitter.sh --source filename --extract DB --match_str database-name`
> 
> 上面的命令将从指定的“文件名” sql 文件为指定的数据库创建 sql，并将其以压缩格式存储到 database-name.sql.gz。
> 
> 2）从mysqldump中提取单个表：
> 
> `sh mysqldumpsplitter.sh --source filename --extract TABLE --match_str table-name`
> 
> 上面的命令将从指定的“文件名”mysqldump 文件为指定的表创建 sql，并将其以压缩格式存储到 database-name.sql.gz。
> 
> 3）从mysqldump中提取匹配正则表达式的表：
> 
> `sh mysqldumpsplitter.sh --source filename --extract REGEXP --match_str regular-expression`
> 
> 上面的命令将从指定的“文件名”mysqldump 文件中为匹配指定正则表达式的表创建 sql，并将其以压缩格式存储到单独的 table-name.sql.gz。
> 
> 4）从mysqldump中提取所有数据库：
> 
> `sh mysqldumpsplitter.sh --source filename --extract ALLDBS`
> 
> 上面的命令将从指定的“文件名”mysqldump 文件中提取所有数据库，并将其以压缩格式存储到单独的 database-name.sql.gz 中。
> 
> 5）从mysqldump中提取所有表：
> 
> `sh mysqldumpsplitter.sh --source filename --extract ALLTABLES`
> 
> 上面的命令将从指定的“文件名”mysqldump 文件中提取所有表，并将其以压缩格式存储到单独的 table-name.sql.gz 中。
> 
> 6）从mysqldump中提取表列表：
> 
> `sh mysqldumpsplitter.sh --source filename --extract REGEXP --match_str '(table1|table2|table3)'`
> 
> 上面的命令将从指定的“文件名”mysqldump 文件中提取表，并将它们以压缩格式存储到单独的 table-name.sql.gz 中。
> 
> 7）从压缩的mysqldump中提取数据库：
> 
> `sh mysqldumpsplitter.sh --source filename.sql.gz --extract DB --match_str 'dbname' --decompression gzip`
> 
> 上述命令将使用 gzip 解压 filename.sql.gz，从“filename.sql.gz”中提取名为“dbname”的数据库并将其存储为 out/dbname.sql.gz
> 
> 8) 以未压缩格式从压缩的 mysqldump 中提取数据库：
> 
> `sh mysqldumpsplitter.sh --source filename.sql.gz --extract DB --match_str 'dbname' --decompression gzip --compression none`
> 
> 上面的命令将使用 gzip 解压缩 filename.sql.gz 并从“filename.sql.gz”中提取名为“dbname”的数据库并将其存储为普通 sql out/dbname.sql
> 
> 9）从不同文件夹的mysqldump中提取所有表：
> 
> `sh mysqldumpsplitter.sh --source filename --extract ALLTABLES --output_dir /path/to/extracts/`
> 
> 上述命令将从指定的“文件名”mysqldump 文件中提取所有表，并将压缩格式的表提取到单独的文件中，table-name.sql.gz 存储在 /path/to/extracts/ 下。如果不存在，该脚本将创建文件夹 /path/to/extracts/。
> 
> 10) 从一个数据库中提取一个或多个表以进行完全转储：
> 
> 假设您有一个包含多个数据库的完整转储，并且您想从一个数据库中提取几个表。
> 
> 提取单个数据库：`sh mysqldumpsplitter.sh --source filename --extract DB --match_str DBNAME --compression none`
> 
> 提取所有表`sh mysqldumpsplitter.sh --source out/DBNAME.sql --extract REGEXP --match_str "(tbl1|tbl2)"`，尽管我们可以使用另一个选项在单个命令中执行此操作，如下所示：
> 
> `sh mysqldumpsplitter.sh --source filename --extract DBTABLE --match_str "DBNAME.(tbl1|tbl2)" --compression none`
> 
> 上面的命令将从当前目录中文件夹“out”下的 sql 格式的 DBNAME 数据库中提取 tbl1 和 tbl2。
> 
> 您可以按如下方式提取单个表：
> 
> `sh mysqldumpsplitter.sh --source filename --extract DBTABLE --match_str "DBNAME.(tbl1)" --compression none`
> 
> 11）从特定数据库中提取所有表：
> 
> `mysqldumpsplitter.sh --source filename --extract DBTABLE --match_str "DBNAME.*" --compression none`
> 
> 上面的命令将以 sql 格式从 DBNAME 数据库中提取所有表并将其存储在“out”目录下。
> 
> 12）列出mysqldump文件的内容
> 
> `mysqldumpsplitter.sh --source filename --desc`
> 
> 上面的命令将列出转储文件中的数据库和表。

您可以稍后选择加载文件：zcat filename.sql.gz | mysql -uUSER -p -hHOSTNAME

*   此外，一旦您提取了您认为更大的单个表，您可以使用带有行数的 linux split 命令来进一步拆分转储。 `split -l 10000 filename.sql`

*   也就是说，如果这是您的需要（更频繁地出现），您可以考虑使用[mydumper](https://launchpad.net/mydumper)，它实际上会创建您不需要拆分的单独转储！

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-25T16:15:19.530

您说您无权访问第二台服务器。但是，如果您对表所在的第一台服务器具有 shell 访问权限，则可以按表拆分转储：

```
for T in `mysql -N -B -e 'show tables from dbname'`; \
   do echo $T; \
   mysqldump [connecting_options] dbname $T \
   | gzip -c > dbname_$T.dump.gz ; \
   done
```

这将为每个表创建一个 gzip 文件。

将 mysqldump 的输出拆分为单独文件的另一种方法是使用 --tab 选项。

```
mysqldump [connecting options] --tab=directory_name dbname 
```

其中*directory_name*是空目录的名称。此命令为每个表创建一个 .sql 文件，其中包含 CREATE TABLE 语句，以及一个 .txt 文件，其中包含要使用 LOAD DATA INFILE 恢复的数据。不过，我不确定 phpMyAdmin 是否可以根据您的特定限制处理这些文件。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-01-22T03:39:41.713

迟到的回复，但正在寻找相同的解决方案，并从以下网站发现以下代码：

```
for I in $(mysql -e 'show databases' -s --skip-column-names); do mysqldump $I | gzip > "$I.sql.gz"; done 
```

[http://www.commandlinefu.com/commands/view/2916/backup-all-mysql-databases-to-individual-files](http://www.commandlinefu.com/commands/view/2916/backup-all-mysql-databases-to-individual-files)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-08-03T13:04:56.413

我最近创建了[sqlsplit.com](http://sqlsplit.com)。试试看。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-12-28T01:54:55.823

我写了一个新版本的 SQLDumpSplitter，这次使用了一个合适的解析器，允许像 INSERTs 这样的好东西被分割到文件中，它现在是多平台的：[https ://philiplb.de/sqldumpsplitter3/](https://philiplb.de/sqldumpsplitter3/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-10-07T15:08:59.663

您不需要 ssh 访问您的任何一个服务器。只是一个 mysql[dump] 客户端就可以了。使用 mysql[dump]，您可以转储数据库并再次导入。

在您的 PC 中，您可以执行以下操作：

$ mysqldump -u originaluser -poriginalpassword -h originalhost originaldatabase | mysql -u newuser -pnewpassword -h newhost newdatabase

你就完成了。:-)

希望这可以帮助

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T12:20:14.120

您可以通过运行 mysqldump 转储单个表`mysqldump database table1 table2 ... tableN`

如果没有一张桌子太大，那就足够了。否则，您将不得不开始拆分较大表中的数据。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-02-19T13:47:35.057

我会推荐实用程序 bigdump，你可以在这里获取它。[http://www.ozerov.de/bigdump.php](http://www.ozerov.de/bigdump.php) 这会错开转储的执行，尽可能接近您的极限，一次执行整行。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-11-02T09:16:52.640

您可以通过 AWK 拆分现有文件。它非常快速和简单

让我们按 'tables' 拆分表转储：

```
cat dump.sql | awk 'BEGIN {output = "comments"; }
$data ~ /^CREATE TABLE/ {close(output); output = substr($3,2,length($3)-2); }
{ print $data >> output }'; 
```

或者您可以按“数据库”拆分转储

```
cat backup.sql | awk 'BEGIN {output="comments";} $data ~ /Current Database/ {close(output);output=$4;} {print $data>>output}'; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-11-21T02:52:13.803

试试这个：[https](https://github.com/shenli/mysqldump-hugetable) ://github.com/shenli/mysqldump-hugetable 它将数据转储到许多小文件中。每个文件包含少于或等于 MAX_RECORDS 条记录。您可以在 env.sh 中设置此参数。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-10-04T19:53:40.447

我编写了一个 Python 脚本来将单个大型 sql 转储文件拆分为单独的文件，每个文件用于每个 CREATE TABLE 语句。它将文件写入您指定的新文件夹。如果未指定输出文件夹，则会在同一目录中创建一个与转储文件同名的新文件夹。它逐行工作，无需先将文件写入内存，因此非常适合大文件。

[https://github.com/kloddant/split_sql_dump_file](https://github.com/kloddant/split_sql_dump_file)

```
import sys, re, os

if sys.version_info[0] < 3:
    raise Exception("""Must be using Python 3\.  Try running "C:\\Program Files (x86)\\Python37-32\\python.exe" split_sql_dump_file.py""")

sqldump_path = input("Enter the path to the sql dump file: ")

if not os.path.exists(sqldump_path):
    raise Exception("Invalid sql dump path.  {sqldump_path} does not exist.".format(sqldump_path=sqldump_path))

output_folder_path = input("Enter the path to the output folder: ") or sqldump_path.rstrip('.sql')

if not os.path.exists(output_folder_path):
    os.makedirs(output_folder_path)

table_name = None
output_file_path = None
smallfile = None

with open(sqldump_path, 'rb') as bigfile:
    for line_number, line in enumerate(bigfile):
        line_string = line.decode("utf-8")
        if 'CREATE TABLE' in line_string.upper():
            match = re.match(r"^CREATE TABLE (?:IF NOT EXISTS )?`(?P<table>\w+)` \($", line_string)
            if match:
                table_name = match.group('table')
                print(table_name)
                output_file_path = "{output_folder_path}/{table_name}.sql".format(output_folder_path=output_folder_path.rstrip('/'), table_name=table_name)
                if smallfile:
                    smallfile.close()
                smallfile = open(output_file_path, 'wb')
        if not table_name:
            continue
        smallfile.write(line)
    smallfile.close() 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-25T12:18:52.033

尝试 csplit(1) 根据正则表达式将输出切割成单个表（匹配我认为的表边界）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-06-16T20:30:23.650

查看 SQLDumpSplitter 2，我只是使用它成功拆分了 40MB 转储。您可以通过以下链接获取它：

[sqldumpsplitter.com](http://sqldumpsplitter.com)

希望这有帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-11-16T00:49:15.040

这个[脚本](http://gadelkareem.com/2012/11/16/use-mysqldump-to-create-separate-files-and-directories-for-databases-and-tables/)应该这样做：

```
#!/bin/sh

#edit these
USER=""
PASSWORD=""
MYSQLDIR="/path/to/backupdir"

MYSQLDUMP="/usr/bin/mysqldump"
MYSQL="/usr/bin/mysql"

echo - Dumping tables for each DB
databases=`$MYSQL --user=$USER --password=$PASSWORD -e "SHOW DATABASES;" | grep -Ev "(Database|information_schema)"`
for db in $databases; do
    echo - Creating "$db" DB
    mkdir $MYSQLDIR/$db
    chmod -R 777 $MYSQLDIR/$db
    for tb in `$MYSQL  --user=$USER --password=$PASSWORD -N -B -e "use $db ;show tables"`
        do 
            echo -- Creating table $tb
            $MYSQLDUMP --opt  --delayed-insert --insert-ignore --user=$USER --password=$PASSWORD $db $tb | bzip2 -c > $MYSQLDIR/$db/$tb.sql.bz2
    done
    echo
done 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-02-07T21:27:03.920

我创建了 MySQLDumpSplitter.java，与 bash 脚本不同，它可以在 Windows 上运行。它可以在这里[https://github.com/Verace/MySQLDumpSplitter](https://github.com/Verace/MySQLDumpSplitter)获得。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-06-22T19:39:41.210

澄清@Vérace 的答案：

我特别喜欢互动方式；您可以在 Eclipse 中拆分一个大文件。我在 Windows 中成功尝试了一个 105GB 的文件：

只需将 MySQLDumpSplitter 库添加到您的项目中： [http ://dl.bintray.com/verace/MySQLDumpSplitter/jar/](http://dl.bintray.com/verace/MySQLDumpSplitter/jar/)

关于如何导入的快速说明：

```
- In Eclipse, Right click on your project --> Import
- Select "File System" and then "Next"
- Browse the path of the jar file and press "Ok"
- Select (thick) the "MySQLDumpSplitter.jar" file and then "Finish"
- It will be added to your project and shown in the project folder in Package Explorer in Eclipse
- Double click on the jar file in Eclipse (in Package Explorer)
- The "MySQL Dump file splitter" window opens which you can specify the address of your dump file and proceed with split. 
```

# servlets - 在 Websphere 6.1 中强制使用 Https

> ID：132921
> 
> 赞同：0
> 
> 时间：2008-09-25T12:12:10.380
> 
> 标签：servlets, https, websphere, rad

我想知道如何强制使用 Http 请求页面的用户使用安全的 https 版本？

我使用 Websphere 6.1 作为我的应用程序服务器，使用 Rad 7 作为我的开发环境

谢谢达米安

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T12:48:43.660

您可以在应用程序中而不是在服务器配置中执行此操作的一种方法是使用[过滤器](http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/Filter.html)（在您的 web.xml 中指定）来检查`ServletRequest.getScheme()`是“http”还是“https”，并将用户重定向到适当的 URL（使用`HttpServletResponse.sendRedirect(String url)`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-03T11:58:03.723

您可以在 web.xml 中添加以下条目，它将确保所有请求都转换为 https

```
<!--********************************
   *** SSL Security Constraint  ***
   *****************************-->
   <security-constraint>
       <web-resource-collection>
           <web-resource-name>SSL</web-resource-name>
           <url-pattern>/*</url-pattern>
       </web-resource-collection>
       <user-data-constraint>
           <transport-guarantee>CONFIDENTIAL</transport-guarantee>
       </user-data-constraint>
   </security-constraint>

<!--********************************* --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T12:29:40.587

Websphere 不是一个完整的 http 服务器。它确实具有“传输链”，其作用类似于 HTTP 服务器。

通常你会在前面放置一个 HTTP 服务器。IBM 提供了 IHS（IBM HTTP Server），它是一个经过轻微修改的 Apache HTTP Server。HTTP 服务器使用 httpd.conf 文件进行配置。在那里，您以这样一种方式添加重定向，即对 http 的请求被重定向到 https。

也许您可以提供一些有关您的基础架构的详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-26T19:25:01.757

我同意。我认为使用过滤器可以实现这一点。这是我为负载平衡和端口重定向编写的过滤器，但应该很容易弄清楚如何对其进行编辑以满足您的需求。

公共类 RequestWrapperFilter 实现过滤器 {

```
public void doFilter(ServletRequest servletRequest,
        ServletResponse servletResponse, FilterChain filterChain)
        throws IOException, ServletException {

    HttpServletRequest httpRequest = (HttpServletRequest) servletRequest;
    HttpServletResponse httpResponse = (HttpServletResponse) servletResponse;

    String requestWrapperClassName = (String) (httpRequest
            .getAttribute(LoadBalancerRequestWrapper.class.getName()));

    String initiatingServerName = httpRequest.getServerName();

    if (requestWrapperClassName == null
            && initiatingServerName.equals(loadBalancerHostName)) {

        httpRequest = new LoadBalancerRequestWrapper(AuthenticationUtil
                .getHttpServletRequest(httpRequest));
    }

    filterChain.doFilter(httpRequest, httpResponse);
} 
```

}

```
/**
 * The custom implementation of the request wrapper. It simply overrides the
 * getScheme() and getServerPort() methods to perform the redirect
 * filtering.
 * 
 * 
 */
private static class LoadBalancerRequestWrapper extends
        HttpServletRequestWrapper {

    /**
     * Default Constructor. Simply declares the Wrapper as injected.
     * 
     * @param httpServletRequest
     *            the app-server HttpServletRequest.
     * 
     */
    public LoadBalancerRequestWrapper(HttpServletRequest httpServletRequest) {
        super(httpServletRequest);
    }

    /**
     * The overridden scheme.
     * 
     */
    public final String getScheme() {
        if (loadBalancerHttpScheme.equals(EMPTY_STRING)) {
            return super.getScheme();
        }

        return loadBalancerHttpScheme;
    }
} 
```

}

# c# - 为什么温莎城堡会抓住短暂的物体？

> ID：132940
> 
> 赞同：30
> 
> 时间：2008-09-25T12:16:08.730
> 
> 标签：c#, castle-windsor

最近我注意到我的应用程序似乎正在消耗永远不会被释放的内存。在使用 CLRProfiler 进行分析后，我发现我正在使用的 Castle Windsor 容器正在固定对象。这些对象在配置 xml 中使用 Lifestyle="transient" 属性声明。

我发现如果我明确调用`IWindsorContainer.Release(hangingObject)`，它将删除它的引用。

虽然这会导致问题，但我没想到CastleWindsor 使用瞬态生活方式对象会保留引用并有效地造成泄漏。在所有适当的地方插入显式的 Release 调用将是一项相当平凡且容易出错的任务。

你有没有看到这个问题，你对如何解决这个问题有什么建议吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-03T12:07:13.413

我认为这里的答案遗漏了一个关键点——这种行为可以通过发布策略开箱即用地配置——[在此处查看](http://www.castleproject.org/container/documentation/trunk/advanced/releasepolicy.html)城堡项目网站上的文档。

在许多情况下，特别是在您的容器在托管应用程序的生命周期中存在的情况下，并且瞬态组件确实不需要跟踪（因为您正在处理调用代码或已注入服务的组件中的处置）然后您只需将发布策略设置为`NoTrackingReleasePolicy`实现并完成即可。

在 Castle v 1.0 之前，我相信 Component Burden 将被实施/引入 - 这将有助于缓解其中一些问题以及围绕注入依赖项的处置等。

**编辑：**

查看以下帖子，了解有关组件负担的更多讨论。

[组件负担 - Davy Brions](http://elegantcode.com/2008/12/14/the-component-burden/)

在 Windsor Container的[官方 2.0 版本](http://ayende.com/Blog/archive/2009/05/05/castle-windsor-2.0-rtm-released.aspx)中也实现了组件负担。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T17:44:43.760

需要注意的一件事是，这似乎已在 Castle Trunk 中修复。在 r5475 中，Hammett 将 MicroKernel 中的默认发布策略更改为`LifecycledComponentsReleasePolicy`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T12:39:38.830

您可以在容器中的对象上设置单例或瞬态的生活方式。我理解的单例对象应该持续应用程序的生命周期，但我不明白这种行为对于瞬态对象的用处是一样的！

定制的生活方式可以通过实施来创建`ILifestyleManager`。也许可以适当地实施这一点来创造一种`ReallyTransient`生活方式！

# macos - 如何将任务设置为每隔一段时间运行一次？

> ID：132955
> 
> 赞同：100
> 
> 时间：2008-09-25T12:20:01.030
> 
> 标签：macos, shell, time, cron, scheduled-tasks

如何每隔 30 分钟运行一次脚本？我认为不同的操作系统有不同的方法。我正在使用 OS X。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2008-09-25T13:43:27.990

只需使用**launchd**。它是一个非常强大的启动器系统，同时它是 Mac OS X 的标准启动器系统（当前的 OS X 版本没有它甚至无法启动）。对于那些不熟悉`launchd`（或不熟悉 OS X）的人来说，它就像`init`, `cron`, `at`, SysVinit ( `init.d`) `inetd`,`upstart`和`systemd`. 借用所有这些项目的概念，同时提供您在其他地方可能找不到的东西。

每个服务/任务都是一个文件。文件的位置取决于以下问题：“该服务应该何时运行？” 和“服务需要哪些特权？”

系统任务转到

```
/Library/LaunchDaemons/ 
```

无论是否有任何用户登录到系统，它们是否都应运行。它们将以“root”权限启动。

如果他们只在**任何**用户登录时运行，他们去

```
/Library/LaunchAgents/ 
```

并将以刚刚登录的用户的权限执行。

如果它们仅在**您**登录时运行，它们会转到

```
~/Library/LaunchAgents/ 
```

其中 ~ 是您的 HOME 目录。这些任务将以您的权限运行，就像您通过命令行自己启动它们或通过双击 Finder 中的文件一样。

请注意，也存在`/System/Library/LaunchDaemons`and `/System/Library/LaunchAgents`，但像往常一样，下面的所有内容`/System`都由 OS X 管理。您不应将任何文件放在那里，也不应更改任何文件，除非您真的知道自己在做什么。在 Systems 文件夹中乱搞可能会使您的系统无法使用（使其进入甚至拒绝再次启动的状态）。这些是 Apple 放置`launchd`在引导期间启动和运行系统、根据需要自动启动服务、执行系统维护任务等任务的目录。

每个`launchd`任务都是 PLIST 格式的文件。它应该有反向域名表示法。例如，您可以命名您的任务

```
com.example.my-fancy-task.plist 
```

这个 plist 可以有各种选项和设置。单手书写不适合初学者，因此您可能需要像[LaunchControl](https://www.soma-zone.com/LaunchControl/)（免费）或[Lingon](http://www.peterborgapps.com/lingon/)（商业，14.99 美元）这样的工具来创建您的任务。

举个例子，它可能看起来像这样

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>Label</key>
    <string>com.example.my-fancy-task</string>
    <key>OnDemand</key>
    <true/>
    <key>ProgramArguments</key>
    <array>
        <string>/bin/sh</string>
        <string>/usr/local/bin/my-script.sh</string>
    </array>
    <key>StartInterval</key>
    <integer>1800</integer>
</dict>
</plist> 
```

此代理将每 1800 秒（每 30 分钟）运行一次 shell 脚本 /usr/local/bin/my-script.sh。您还可以在某些日期/时间运行任务（基本上，launchd 可以做 cron 可以做的所有事情），或者您甚至可以禁用“OnDemand”导致launchd 保持进程永久运行（如果它退出或崩溃，launchd 将立即重新启动它） . 您甚至可以限制一个进程可以使用多少资源。

**更新：** *尽管`OnDemand`仍受支持，但已弃用。新设置名为`KeepAlive`，这更有意义。`OnDemand`它可以有一个布尔值，在这种情况下，它与（将其设置为`false`表现得好像`OnDemand`是，反之亦然）完全相反`true`。伟大的新功能是，它还可以有一个字典值而不是布尔值。如果它有一个字典值，你有几个额外的选项可以让你更精细地控制在哪些情况下任务应该保持活动状态。例如，只要程序以零退出代码终止，只要磁盘上的某个文件/目录存在，仅当另一个任务也处于活动状态，或者仅当网络当前已启动时，它才会保持活动状态。*

您还可以通过命令行手动启用/禁用任务：

```
launchctl <command> <parameter> 
```

命令可以是`load`或`unload`, 加载或再次卸载它，在这种情况下参数是文件的路径。Or 命令可以是`start`or `stop`，以启动或停止这样的任务，在这种情况下，参数是标签 ( `com.example.my-fancy-task`)。其他命令和选项也存在。

**更新：** *尽管`load`, `unload`, `start`, and `stop`do 仍然有效，但它们现在已成为传统。新命令是`bootstrap`、`bootout`、`enable`和`disable`，语法和选项略有不同。一个很大的区别是它`disable`是持久的，所以一旦服务被禁用，它将保持禁用状态，即使在重新启动后，直到您再次启用它。您也可以使用`kickstart`它来立即运行任务，而不管它是如何被配置为运行的。*

*新旧命令之间的主要区别在于它们按“域”分隔任务。系统有域，每个用户也有。因此，同样标记的任务可能存在于不同的域中，并且`launctl`仍然可以区分它们。甚至同一用户的不同登录和不同 UI 会话也有自己的域（例如，同一用户可能曾经在本地登录，一次通过 SSH 远程登录，并且可能为任一会话运行不同的任务），每个正在运行的进程也是如此。因此`com.example.my-fancy-task`，您现在将使用`system/com.example.my-fancy-task`or`user/501/com.example.my-fancy-task`来标识任务，而不是 ，其中 501 是特定用户的用户 ID。*

请参阅[plist 格式](https://en.wikipedia.org/wiki/Property_list)和[`launchctl`命令行工具](https://ss64.com/osx/launchctl.html)的文档。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2013-10-25T11:50:39.773

您可以使用非常方便的 plist 生成器：http: [//launched.zerowidth.com/](http://launched.zerowidth.com/)（无需购买任何东西……）

它会给你一个 shell 单行程序来注册一个新的预定作业与已经推荐的**launchd**

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-25T12:30:48.790

在 MacOSX 上，您至少有以下选项：

*   带有“运行脚本”操作的重复 iCal 警报
*   [发射](http://developer.apple.com/macosx/launchd.html)
*   cron ([链接 1](http://lists.apple.com/archives/Macos-x-server/2003/Apr/msg01528.html)，[链接 2](http://www.macosxhints.com/article.php?story=2001020700163714) )

从个人经验来看，cron是最可靠的。当我测试时，launchd 有许多错误和怪癖。iCal 警报仅在您登录时运行（但这可能是您喜欢的）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-10-24T14:01:22.800

您可以使用 cron 来安排任务。

```
crontab -e 
```

作业按以下格式指定。

```
* * * * *  command to execute
│ │ │ │ │
│ │ │ │ └─── day of week (0 - 6) (0 to 6 are Sunday to Saturday, or use names; 7 is Sunday, the same as 0)
│ │ │ └──────── month (1 - 12)
│ │ └───────────── day of month (1 - 31)
│ └────────────────── hour (0 - 23)
└─────────────────────── min (0 - 59) 
```

例子：

```
0 12 * * *  cd ~/backupfolder && ./backup.sh 
```

安装 cron 任务后，您可以使用 crontab -l 列出您的任务。

```
crontab -l 
```

如果您想了解更多关于 cron 调度表达式的信息，您可以访问

[https://crontab.guru](https://crontab.guru) [https://ole.michelsen.dk/blog/schedule-jobs-with-crontab-on-mac-osx.html](https://ole.michelsen.dk/blog/schedule-jobs-with-crontab-on-mac-osx.html)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-25T16:10:45.047

正如 Mecki 指出的那样，launchd 将是解决这个问题的方法。launchd 有一个名为[Lingon](http://www.peterborgapps.com/lingon/)的 GUI 界面，您可能想查看它，而不是手动编辑 launchd 文件：

> Lingon 是一个图形用户界面，用于为 Mac OS X Leopard 10.5 创建编辑启动配置文件。
> 
> [剪断...]
> 
> 在这个版本中编辑配置文件比以往任何时候都容易，它有两种不同的模式。基本模式在非常简单的界面中提供最常用的设置，而专家模式则可以直接在文本中添加所有设置或通过菜单插入它们。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-06-10T05:35:40.290

MAC OS 有一个**Automator** Tool，它与windows中的**Task Scheduler**相同。使用 Automator，您可以每天安排任务，并将任务与重复的日历事件链接，以便在每天指定的时间运行脚本。参考链接[以在 Mac OS 中每天运行脚本](http://automationtesttricks.blogspot.in/2016/06/automating-selenium-automation-scripts.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-25T14:31:47.250

对于苹果脚本，我设置了一个特殊的 iCal 日历并使用警报定期运行它们。对于命令行工具，我使用 launchd。

# windows - 什么是 Windows 版本的 cron？

> ID：132971
> 
> 赞同：289
> 
> 时间：2008-09-25T12:23:51.957
> 
> 标签：windows, cron, scheduling, scheduled-tasks

[谷歌搜索](http://www.google.com/search?ie=UTF-8&oe=UTF-8&sourceid=navclient&gfns=1&q=windows+cron)出现了与 cron 执行相同功能的软件，但没有内置在 Windows 中。

我正在运行 Windows XP Professional，但任何版本的 Windows 的建议都可能对某人有所帮助。

还有一种方法可以以编程方式或通过命令行调用此功能（基于答案称为任务计划程序）？

* * *

## 回答 #1

> 赞同：302
> 
> 时间：2008-09-25T12:24:26.683

对于最初的问题，询问 Windows XP（和 Windows 7）：[Windows 任务计划程序](https://technet.microsoft.com/en-us/library/cc748993(v=ws.11).aspx)

对于命令行使用，您可以使用[AT 命令](http://technet.microsoft.com/en-us/library/bb726974.aspx)进行调度。

对于较新的 Microsoft 操作系统版本，Windows Server 2012 / Windows 8，请查看[schtasks](http://technet.microsoft.com/en-us/library/cc725744.aspx)命令行实用程序。
如果使用 PowerShell，则[Windows PowerShell 中的计划任务 Cmdlet](https://technet.microsoft.com/en-us/library/jj649816(v=wps.630).aspx)用于编写脚本。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-25T12:26:44.790

Windows " [AT" 命令与 cron 非常相似](http://www.ss64.com/nt/at.html)。它可以通过命令行获得。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-25T12:25:04.857

使用 Windows 任务计划程序按时间和日期安排任务。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-06-26T17:32:59.727

[pycron](https://github.com/kipe/pycron)在 Windows 上非常接近。支持以下条目：

```
1    Minute (0-59)
2    Hour (2-24)
3    Day of month (1-31)
4    Month (1-12, Jan, Feb, etc)
5    Day of week (0-6) 0 = Sunday, 1 = Monday etc or Sun, Mon, etc)
6    User that the command will run as
7    Command to execute 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-25T12:26:10.737

'at' 命令。

> “AT 命令计划命令和程序在指定时间和日期在计算机上运行。计划服务必须运行才能使用 AT 命令。”

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-25T12:55:46.420

[Zcron](http://www.z-cron.com/)可免费供个人使用。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-25T12:28:14.803

最接近的等价物是 Windows 计划任务（控制面板 -> 计划任务），尽管它们与 cron 相去甚远。

（对我而言）最大的不同是它们需要一个用户登录到 Windows 框，以及一个用户帐户（带有密码和所有密码），如果您的本地安全策略需要定期更改密码，这会使事情成为一场噩梦。我还认为，就设置项目运行的时间间隔而言，它不如 cron 灵活。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-25T12:30:44.203

> 还有一种方法可以以编程方式调用此功能（基于答案称为任务计划程序）[...]？

MSDN 上的任务调度程序[API](http://msdn.microsoft.com/en-us/library/aa383614.aspx)。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-25T12:38:13.157

如果您喜欢好的 ol' cron，[CRONw](http://cronw.sourceforge.net/)是您的最佳选择。

```
Supported systems

* Windows 2000 (any version)    works
* Windows XP (SP 2)             works
* Windows Server 2003           works
* Windows NT 4 (SP 6)           should work but not tested
* Windows 3.11, Windows 95,
  Windows 98, Windows ME,
  Windows XP beneath SP2        not supported by design 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-06-23T08:39:19.560

不完全是 Windows 版本，但是您可以使用 Cygwin 的 crontab。有关安装说明，请参见此处：[此处](http://linuxbites.wordpress.com/2010/06/28/starting-crontab-in-cygwin/)。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2012-09-10T04:51:42.797

有适用于 Windows 的[NNCron](http://www.nncron.ru/)。IT 可以安排作业定期运行。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-25T12:27:50.200

除了 Windows 任务计划程序，您还可以在 Windows 上使用“at”。除了它具有命令行界面这一事实之外，我不确定它与任务计划程序有何不同。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-10-16T22:15:39.773

At 命令现已弃用

你可以使用[SCHTASKS](https://msdn.microsoft.com/en-us/library/windows/desktop/bb736357(v=vs.85).aspx)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-08-16T18:02:18.753

1.  您可以使用 PowerShell 中的 Scheduled-Tasks [API](https://docs.microsoft.com/en-us/powershell/module/scheduledtasks)以及 config.json 文件进行参数输入。我猜最小限制是 5 分钟。通过 API 创建非常基本的计划任务的示例[教程](https://www.youtube.com/watch?v=izlIJTmUW0o)

2.  您也可以通过 cmd 使用 schtasks.exe。在执行 schtasks.exe /Create /? 时，我可以看到分钟修饰符限制为 1 分钟。无论如何，现在不推荐使用 AT。

[![在此处输入图像描述](https://i.stack.imgur.com/frSfi.png)](https://i.stack.imgur.com/frSfi.png)

无论如何，我正在研究一种表现得像 CRON 的工具。如果成功我会在这里更新。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-11-09T12:51:32.403

[在https://github.com/mgefvert/Cronical](https://github.com/mgefvert/Cronical)查看优秀的 Cronical 程序

它是一个 .NET 程序，可以读取[带有类 unix cron 行的文本文件](https://github.com/mgefvert/Cronical/blob/master/Binaries/cronical.dat)。使用非常方便。如果 stdout 就像 unix cron 一样，它将发送电子邮件。它甚至支持充当服务运行器。

# java - 你如何强制一个 maven MOJO 在构建结束时只执行一次？

> ID：132976
> 
> 赞同：10
> 
> 时间：2008-09-25T12:24:30.660
> 
> 标签：java, maven-2, maven-plugin, mojo

我有一个 MOJO 我想执行一次，并且只有在反应堆中最后一个项目的测试阶段之后才能运行一次。

使用：

```
if (!getProject().isExecutionRoot()) {
        return ;
} 
```

在 execute() 方法的开头意味着我的 mojo 被执行一次，但是在构建的最开始 - 在所有其他子模块之前。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-26T01:50:15.403

我为此找到的最佳解决方案是：

```
/**
 * The projects in the reactor.
 *
 * @parameter expression="${reactorProjects}"
 * @readonly
 */
private List reactorProjects;

public void execute() throws MojoExecutionException {

    // only execute this mojo once, on the very last project in the reactor
    final int size = reactorProjects.size();
    MavenProject lastProject = (MavenProject) reactorProjects.get(size - 1);
    if (lastProject != getProject()) {
        return;
    }
   // do work
   ...
} 
```

这似乎适用于我测试过的小型构建层次结构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-13T08:25:34.610

最好的解决方案是通过扩展您的类来依赖生命周期扩展`org.apache.maven.AbstractMavenLifecycleParticipant`（另请参见[https://maven.apache.org/examples/maven-3-lifecycle-extensions.html](https://maven.apache.org/examples/maven-3-lifecycle-extensions.html)`afterSessionEnd` ），其中添加了一个方法[https://issues .apache.org/jira/browse/MNG-5640](https://issues.apache.org/jira/browse/MNG-5640)（在 Maven 3.2.2 中修复）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-28T12:18:41.497

有一个[Sonatype 博客条目](http://www.sonatype.com/people/2009/05/how-to-make-a-plugin-run-once-during-a-build/)描述了如何执行此操作。最后一个要运行的项目将是根项目，因为它将包含对其余项目的模块引用。因此，您需要在 mojo 中进行测试，以检查当前项目的目录是否与启动 Maven 的目录相同：

```
boolean result = mavenSession.getExecutionRootDirectory().equalsIgnoreCase(basedir.toString()); 
```

在引用的条目中有一个非常全面的示例，说明如何在您的 mojo 中使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T12:44:42.173

**如果您使用@aggregator**标签并将您的 mojo 绑定到以下生命周期阶段之一，我认为您可能会得到您需要的东西：

*   准备包
*   包裹
*   预集成测试
*   集成测试
*   整合后测试
*   核实
*   安装
*   部署

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-19T11:11:54.730

自 Maven 3.x 以来，使用 session.getEventDispatcher() 的解决方案不再有效。整个事件已在此提交中删除：[https ://github.com/apache/maven/commit/505423e666b9a8814e1c1aa5d50f4e73b8d710f4](https://github.com/apache/maven/commit/505423e666b9a8814e1c1aa5d50f4e73b8d710f4)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-26T10:00:25.500

查看[maven-monitor API](http://maven.apache.org/ref/2.2.1/apidocs/org/apache/maven/monitor/event/package-summary.html)

您可以将 EventMonitor 添加到调度程序，然后捕获 'reactor-execute' 事件的 END：这是在一切完成后调度的，即即使在您看到 BUILD SUCCESSFUL/FAILED 输出之后。

这是我最近使用它在最后打印摘要的方式：

```
/**
 * The Maven Project Object
 *
 * @parameter expression="${project}"
 * @required
 * @readonly
 */
protected MavenProject project;

/**
 * The Maven Session.
 *
 * @parameter expression="${session}"
 * @required
 * @readonly
 */
protected MavenSession session;

...

@Override
public void execute() throws MojoExecutionException, MojoFailureException
{
    //Register the event handler right at the start only
    if (project.isExecutionRoot())
        registerEventMonitor();
    ...
}

/**
 * Register an {@link EventMonitor} with Maven so that we can respond to certain lifecycle events
 */
protected void registerEventMonitor()
{
    session.getEventDispatcher().addEventMonitor(
            new EventMonitor() {

                @Override
                public void endEvent(String eventName, String target, long arg2) {
                    if (eventName.equals("reactor-execute"))
                        printSummary();
                }

                @Override
                public void startEvent(String eventName, String target, long arg2) {}

                @Override
                public void errorEvent(String eventName, String target, long arg2, Throwable arg3) {}

            }
    );
}

/**
 * Print summary at end
 */
protected void printSummary()
{
    ...
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-06T02:40:59.837

你可以使用 mavensession 来解决这个问题

```
public boolean isThisTheLastProject() {
        return session.getProjectDependencyGraph().getSortedProjects().
                get(session.getProjectDependencyGraph().getSortedProjects().size()-1).getArtifactId().equalsIgnoreCase(project.getArtifactId());
    } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-25T12:31:05.717

通常，这是配置问题。您可能必须为 mojo 设置一个项目，并使其依赖于所有其他项目。或者，您可以通过使其依赖于所有其他子项目来强制其中一个子项目位于最后。

# python - “==”和“is”有区别吗？

> ID：132988
> 
> 赞同：629
> 
> 时间：2008-09-25T12:27:09.733
> 
> 标签：python, reference, equality, semantics

我的[Google-fu](https://english.stackexchange.com/questions/19967/what-does-google-fu-mean)让我失望了。

在 Python 中，以下两个相等性测试是否等效？

```
n = 5
# Test one.
if n == 5:
    print 'Yay!'

# Test two.
if n is 5:
    print 'Yay!' 
```

这是否适用于您将要比较实例的对象（`list`比如说）？

好的，所以这种回答我的问题：

```
L = []
L.append(1)
if L == [1]:
    print 'Yay!'
# Holds true, but...

if L is [1]:
    print 'Yay!'
# Doesn't. 
```

那么`==`测试值在哪里`is`测试以查看它们是否是同一个对象？

* * *

## 回答 #1

> 赞同：1060
> 
> 时间：2008-09-25T12:32:37.473

`is``True`如果两个变量指向同一个对象（在内存中），`==`如果两个变量引用的对象相等，则返回。

```
>>> a = [1, 2, 3]
>>> b = a
>>> b is a 
True
>>> b == a
True

# Make a new copy of list `a` via the slice operator, 
# and assign it to variable `b`
>>> b = a[:] 
>>> b is a
False
>>> b == a
True 
```

在您的情况下，第二个测试仅有效，因为 Python 缓存了小整数对象，这是一个实现细节。对于较大的整数，这不起作用：

```
>>> 1000 is 10**3
False
>>> 1000 == 10**3
True 
```

字符串文字也是如此：

```
>>> "a" is "a"
True
>>> "aa" is "a" * 2
True
>>> x = "a"
>>> "aa" is x * 2
False
>>> "aa" is intern(x*2)
True 
```

请同时查看[这个问题](https://stackoverflow.com/questions/26595/is-there-any-difference-between-foo-is-none-and-foo-none)。

* * *

## 回答 #2

> 赞同：362
> 
> 时间：2009-07-06T06:22:52.760

有一个简单的经验法则可以告诉您何时使用`==`or `is`。

*   `==`是为了*价值平等*。当您想知道两个对象是否具有相同的值时使用它。
*   `is`是供*参考平等*。当您想知道两个引用是否引用同一个对象时使用它。

通常，当您将某物与简单类型进行比较时，您通常会检查*值是否相等*，因此您应该使用`==`. 例如，您的示例的目的可能是检查 x 是否具有等于 2 ( `==`) 的值，而不是是否`x`字面上指的是与 2 相同的对象。

* * *

还有一点需要注意：由于 CPython 参考实现的工作方式，如果您错误地使用`is`比较整数上的引用相等性，您将得到意想不到且不一致的结果：

```
>>> a = 500
>>> b = 500
>>> a == b
True
>>> a is b
False 
```

这几乎是我们所期望的：`a`并且`b`具有相同的值，但是是不同的实体。但是这个呢？

```
>>> c = 200
>>> d = 200
>>> c == d
True
>>> c is d
True 
```

这与之前的结果不一致。这里发生了什么？事实证明，出于性能原因，Python 的参考实现将 -5..256 范围内的整数对象缓存为单例实例。下面是一个例子来证明这一点：

```
>>> for i in range(250, 260): a = i; print "%i: %s" % (i, a is int(str(i)));
... 
250: True
251: True
252: True
253: True
254: True
255: True
256: True
257: False
258: False
259: False 
```

这是不使用的另一个明显原因`is`：当您错误地将其用于值相等时，该行为留给实现。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2018-01-05T19:33:55.397

> ## `==`Python和`is`Python之间有区别吗？

是的，它们有一个非常重要的区别。

**`==`**: 检查相等性 - 语义是等效对象（不一定是同一个对象）将测试为相等。正如[文档所说](https://docs.python.org/3/reference/expressions.html#value-comparisons)：

> 运算符 <、>、==、>=、<= 和 != 比较两个对象的值。

**`is`**：检查身份 - 语义是对象（保存在内存中）*是*对象。同样，[文档说](https://docs.python.org/3/reference/expressions.html#is-not)：

> 对象身份的运算符`is`和测试：当且仅当和是同一个对象时为真。使用该函数确定对象身份。产生逆真值。`is not``x is y``x``y``id()``x is not y`

因此，身份检查与检查对象 ID 的相等性相同。那是，

```
a is b 
```

是相同的：

```
id(a) == id(b) 
```

where`id`是返回一个整数的内置函数，该整数“保证在同时存在的对象中是唯一的”（参见 参考资料`help(id)`），并且 where`a`和`b`是任意对象。

## 其他使用说明

您应该将这些比较用于它们的语义。用于`is`检查身份和`==`检查相等性。

所以一般来说，我们`is`用来检查身份。当我们检查一个只应该在内存中存在一次的对象时，这通常很有用，在文档中称为“单例”。

用例`is`包括：

*   `None`
*   枚举值（使用 enum 模块中的枚举时）
*   通常是模块
*   通常是类定义产生的类对象
*   通常由函数定义产生的函数对象
*   任何其他应该只在内存中存在一次的东西（通常都是单例）
*   一个你想要的特定对象

通常的用例`==`包括：

*   数字，包括整数
*   字符串
*   列表
*   套
*   字典
*   自定义可变对象
*   在大多数情况下，其他内置的不可变对象

再次，一般用例`==`是，您想要的对象可能不是*同一个*对象，而是可能是*等价*的对象

### PEP 8个方向

PEP 8，标准库的官方 Python 风格指南也提到[了两个用例`is`](https://www.python.org/dev/peps/pep-0008/#programming-recommendations)：

> 与单例的比较`None`应该总是使用`is`or `is not`，而不是相等运算符。
> 
> `if x`另外，当你真正的意思时要小心写作`if x is not None`——例如，当测试一个默认为的变量或参数是否`None` 被设置为其他值时。另一个值可能具有在布尔上下文中可能为假的类型（例如容器）！

## 从身份推断平等

如果`is`为真，则*通常*可以推断出相等性——从逻辑上讲，如果一个对象是它自己，那么它应该测试为与它自己等价。

在大多数情况下，这个逻辑是正确的，但它依赖于`__eq__`特殊方法的实现。正如[文档](https://docs.python.org/3/reference/expressions.html#value-comparisons)所说，

> `==`相等比较 (和)的默认行为`!=`基于对象的标识。因此，具有相同身份的实例的相等比较导致相等，而具有不同身份的实例的相等比较导致不平等。这种默认行为的动机是希望所有对象都应该是自反的（即 x 是 y 意味着 x == y）。

并为保持一致性，建议：

> 平等比较应该是自反的。换句话说，相同的对象应该比较相等：
> 
> `x is y`暗示`x == y`

我们可以看到这是自定义对象的默认行为：

```
>>> class Object(object): pass
>>> obj = Object()
>>> obj2 = Object()
>>> obj == obj, obj is obj
(True, True)
>>> obj == obj2, obj is obj2
(False, False) 
```

反证词通常也是正确的——如果某些东西测试为不相等，您通常可以推断它们不是同一个对象。

由于可以自定义相等性测试，因此这种推断并不总是适用于所有类型。

### 一个例外

一个值得注意的例外是`nan`- 它总是测试为不等于自身：

```
>>> nan = float('nan')
>>> nan
nan
>>> nan is nan
True
>>> nan == nan           # !!!!!
False 
```

检查身份比检查相等（可能需要递归检查成员）要快得多。

但它不能代替相等，您可能会发现不止一个对象是等价的。

请注意，比较列表和元组的相等性将假定对象的身份相等（因为这是一种快速检查）。如果逻辑不一致，这可能会产生矛盾 - 因为它是`nan`：

```
>>> [nan] == [nan]
True
>>> (nan,) == (nan,)
True 
```

## 一个警示故事：

问题是试图用来`is`比较整数。您不应假设整数的实例与通过另一个引用获得的实例相同。这个故事解释了原因。

一位评论者的代码依赖于小整数（-5 到 256 包括在内）在 Python 中是单例这一事实，而不是检查是否相等。

> 哇，这可能会导致一些阴险的错误。我有一些代码可以检查 a 是否为 b，因为 a 和 b 通常是很小的数字，所以可以按我的意愿工作。该错误仅在今天发生，经过六个月的生产，因为 a 和 b 终于大到不能被缓存。– gwg

它在开发中起作用。它可能已经通过了一些单元测试。

它在生产中工作 - 直到代码检查大于 256 的整数，此时它在生产中失败。

这是一个生产失败，可能在代码审查或样式检查器中发现。

让我强调一下：*[不要`is`用来比较整数。](https://stackoverflow.com/a/28864111/541136)*

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2008-09-25T12:31:12.533

`==`确定值是否相等，同时`is`确定它们是否是完全相同的对象。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2018-01-19T22:21:25.820

# `is`和有什么区别`==`？

`==`并且`is`是不同的比较！正如其他人已经说过的那样：

*   `==`比较对象的值。
*   `is`比较对象的引用。

在 Python 中，名称指的是对象，例如在这种情况下`value1`，`value2`指的是`int`存储值的实例`1000`：

```
value1 = 1000
value2 = value1 
```

[![在此处输入图像描述](https://i.stack.imgur.com/WLzXy.png)](https://i.stack.imgur.com/WLzXy.png)

因为`value2`指的是同一个对象`is`，并且`==`会给出`True`：

```
>>> value1 == value2
True
>>> value1 is value2
True 
```

在以下示例中，名称`value1`和`value2`引用不同的`int`实例，即使两者都存储相同的整数：

```
>>> value1 = 1000
>>> value2 = 1000 
```

[![在此处输入图像描述](https://i.stack.imgur.com/IJgBI.png)](https://i.stack.imgur.com/IJgBI.png)

因为存储了相同的值（整数）`==`will be `True`，这就是为什么它通常被称为“值比较”。但是`is`会返回`False`，因为这些是不同的对象：

```
>>> value1 == value2
True
>>> value1 is value2
False 
```

## 什么时候用哪个？

通常`is`是一个更快的比较。这就是为什么 CPython 缓存（或者可能*重用*是更好的术语）某些对象，如小整数、一些字符串等。但这应该被视为可能（即使不太可能）在任何时候更改而不会发出警告的*实现细节。*

您应该**只在以下情况下使用`is`**：

*   想要检查两个对象是否真的是同一个对象（不仅仅是同一个“值”）。一个示例是，如果*您*使用单例对象作为常量。

*   想要将值与[Python*常量*](https://docs.python.org/library/constants.html)进行比较。Python中的常量是：

    *   `None`
    *   `True`¹
    *   `False`¹
    *   `NotImplemented`
    *   `Ellipsis`
    *   `__debug__`
    *   类（例如`int is int`或`int is float`）
    *   内置模块或第 3 方模块中可能有额外的常量。例如[`np.ma.masked`](https://docs.scipy.org/doc/numpy/reference/maskedarray.baseclass.html#numpy.ma.masked)来自 NumPy 模块）

在**所有其他情况下，您应该使用它`==`**来检查是否相等。

## 我可以自定义行为吗？

`==`其他答案中尚未提及某些方面：它是[Pythons "Data model"](https://docs.python.org/3/reference/datamodel.html#data-model)的一部分。这意味着可以使用该[`__eq__`](https://docs.python.org/reference/datamodel.html#object.__eq__)方法自定义其行为。例如：

```
class MyClass(object):
    def __init__(self, val):
        self._value = val

    def __eq__(self, other):
        print('__eq__ method called')
        try:
            return self._value == other._value
        except AttributeError:
            raise TypeError('Cannot compare {0} to objects of type {1}'
                            .format(type(self), type(other))) 
```

这只是一个人为的例子来说明该方法是真正被调用的：

```
>>> MyClass(10) == MyClass(10)
__eq__ method called
True 
```

请注意，默认情况下（如果`__eq__`在类或超类中找不到其他实现）`__eq__`使用`is`：

```
class AClass(object):
    def __init__(self, value):
        self._value = value

>>> a = AClass(10)
>>> b = AClass(10)
>>> a == b
False
>>> a == a 
```

`__eq__`因此，如果您想要“更多”而不仅仅是自定义类的参考比较，那么实现它实际上很重要！

另一方面，您不能自定义`is`检查。*如果您*有相同的参考，它将始终进行比较。

## 这些比较是否总是返回布尔值？

因为`__eq__`可以重新实现或覆盖，所以不限于 return`True`或`False`. 它*可以*返回任何东西（但在大多数情况下它应该返回一个布尔值！）。

例如对于 NumPy 数组，`==`将返回一个数组：

```
>>> import numpy as np
>>> np.arange(10) == 2
array([False, False,  True, False, False, False, False, False, False, False], dtype=bool) 
```

但是`is`支票总是会返回`True`或`False`！

* * *

¹正如 Aaron Hall 在评论中提到的：

通常，您不应执行任何`is True`或检查，因为通常在将*条件*隐式转换为布尔值（例如在语句中）`is False`的上下文中使用这些“检查” 。因此，进行比较**和**隐式布尔转换比仅仅进行布尔转换所做的工作更多——并且您将自己限制为布尔值（这不被认为是 pythonic）。*`if``is True`*

 ***就像 PEP8 提到的：

> 不要将布尔值与`True`或`False`使用`==`.
> 
> ```
> Yes:   if greeting:
> No:    if greeting == True:
> Worse: if greeting is True: 
> ```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2008-09-25T17:15:38.323

他们**完全不同**。 `is`检查对象身份，同时`==`检查相等性（一个取决于两个操作数类型的概念）。

`is`" " 似乎可以正确处理小整数（例如 5 == 4+1），这只是一个幸运的巧合。这是因为[CPython 通过将整数设置为单例来优化范围（-5 到 256）内的整数的存储](https://docs.python.org/2/c-api/int.html#c.PyInt_FromLong)。这种行为完全依赖于实现，并且不能保证在所有形式的次要转换操作下都保持不变。

例如，Python 3.5 也使短字符串成为单例，但对它们进行切片会破坏这种行为：

```
>>> "foo" + "bar" == "foobar"
True
>>> "foo" + "bar" is "foobar"
True
>>> "foo"[:] + "bar" == "foobar"
True
>>> "foo"[:] + "bar" is "foobar"
False 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-09-25T12:31:57.757

[https://docs.python.org/library/stdtypes.html#comparisons](https://docs.python.org/library/stdtypes.html#comparisons)

`is`身份 `==`测试 平等测​​试

每个（小）整数值都映射到单个值，因此每 3 是相同且相等的。这是一个实现细节，不是语言规范的一部分

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-25T12:34:18.920

你的答案是正确的。运算符比较两个对象的`is`身份。运算符比较两个对象的`==`值。

对象的身份一旦创建就永远不会改变；您可能会将其视为对象在内存中的地址。

您可以通过定义`__cmp__`方法或[丰富的比较](https://docs.python.org/reference/datamodel.html#basic-customization)方法（如`__eq__`.

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-07-06T06:20:00.237

查看 Stack Overflow 问题*[Python 的“is”运算符对整数的行为异常](https://stackoverflow.com/questions/306313)*。

它主要归结为“ `is`”检查它们是否是同一个对象，而不仅仅是彼此相等（256 以下的数字是一种特殊情况）。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-07-29T20:17:41.880

简而言之，`is`检查两个引用是否指向同一个对象。`==`检查两个对象是否具有相同的值。

```
a=[1,2,3]
b=a        #a and b point to the same object
c=list(a)  #c points to different object 

if a==b:
    print('#')   #output:#
if a is b:
    print('##')  #output:## 
if a==c:
    print('###') #output:## 
if a is c:
    print('####') #no output as c and a point to different object 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-07-06T08:50:52.663

正如 John Feminella 所说，大多数时候您将使用 == 和 != 因为您的目标是比较值。我只想对你在剩下的时间里会做什么进行分类：

NoneType 只有一个实例，即 None 是单例。因此`foo == None`，`foo is None`意思相同。但是`is`测试更快，Pythonic 约定是使用`foo is None`.

如果您正在做一些自省或处理垃圾收集或检查您定制的字符串实习小工具是否正常工作等，那么您可能有`foo`is的用例`bar`。

True 和 False 也是（现在）单例，但没有用例 for`foo == True`也没有用例`foo is True`.

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-02-01T15:56:52.980

正如这篇文章中的其他人详细回答了比较对象或变量之间的区别`==`和比较的问题`is`，我将主要**强调**可以给出不同结果**的字符串**`is`之间的比较，我会敦促程序员谨慎使用它们。`==`

 **对于字符串比较，请确保使用`==`而不是`is`：

```
str = 'hello'
if (str is 'hello'):
    print ('str is hello')
if (str == 'hello'):
    print ('str == hello') 
```

出去：

```
str is hello
str == hello 
```

**但**在下面的例子中`==`，`is`会得到不同的结果：

```
str2 = 'hello sam'
    if (str2 is 'hello sam'):
        print ('str2 is hello sam')
    if (str2 == 'hello sam'):
        print ('str2 == hello sam') 
```

出去：

```
str2 == hello sam 
```

**结论与分析：**

小心使用`is`来比较字符串。由于`is`用于比较对象，并且在 Python 3+ 中，每个变量（例如字符串）都解释为对象，让我们看看上面的段落中发生了什么。

在 python 中，有一个[`id`](https://www.geeksforgeeks.org/id-function-python/#:%7E:text=id()%20is%20an%20inbuilt,the%20same%20id()%20value.)函数可以显示对象在其生命周期内的唯一常量。此 id 在 Python 解释器的后端使用`is`关键字来比较两个对象。

```
str = 'hello'
id('hello')
> 140039832615152
id(str)
> 140039832615152 
```

但

```
str2 = 'hello sam'
id('hello sam')
> 140039832615536
id(str2)
> 140039832615792 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-03-07T08:05:20.210

他们中的大多数人已经回答了这一点。就像一个附加说明（基于我的理解和实验，但不是来自记录的来源），声明

> == 如果变量引用的对象相等

从上面的答案应该被理解为

> == 如果变量引用的对象相等且对象属于同一类型/类

. 我根据以下测试得出了这个结论：

```
list1 = [1,2,3,4]
tuple1 = (1,2,3,4)

print(list1)
print(tuple1)
print(id(list1))
print(id(tuple1))

print(list1 == tuple1)
print(list1 is tuple1) 
```

这里列表和元组的内容相同，但类型/类不同。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-08-08T12:30:33.620

Python is 和 equals(==) 的区别

> is 运算符可能看起来与相等运算符相同，但它们并不相同。
> 
> is 检查两个变量是否指向同一个对象，而 == 符号检查两个变量的值是否相同。
> 
> 因此，如果 is 运算符返回 True，则等式肯定为 True，但相反的结果可能为 True，也可能不是 True。

这是一个示例来演示相似性和差异。

```
>>> a = b = [1,2,3]
>>> c = [1,2,3]
>>> a == b
True
>>> a == c
True
>>> a is b
True
>>> a is c
False
>>> a = [1,2,3]
>>> b = [1,2]
>>> a == b
False
>>> a is b
False
>>> del a[2]
>>> a == b
True
>>> a is b
False 
```

> ```
> Tip: Avoid using is operator for immutable types such as strings and numbers, the result is unpredictable. 
> ```************************`````**