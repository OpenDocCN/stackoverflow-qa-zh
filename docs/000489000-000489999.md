# StackOverflow 问答 000489000-000489999

# windows - 处理网络驱动器文件 I/O 可能出现的错误

> ID：489001
> 
> 赞同：2
> 
> 时间：2009-01-28T19:33:58.067
> 
> 标签：windows, networking, file, error-handling

我正在尝试通过网络驱动器（可能通过 WAN 或 VPN）使本地 C++ Windows 应用程序尽可能可靠的文件 I/O...

我需要能够处理哪些可能的错误情况？

如何在测试中模拟这些错误情况？

如何获取有关特定错误的详细信息？例如，如果`fopen()`失败，是否会`errno`告诉我我需要知道的一切，或者我是否需要获得`GetLastError()`价值？

如何可靠地区分“网络驱动器访问功能齐全但文件不存在”和网络或服务器的各种问题？

我在桌面上注意到的一个特殊错误情况（不是特定于我们正在开发的应用程序）是有时第一次尝试访问网络驱动器上的文件会失败，但它可能会导致驱动器重新连接背景，因为后续连接有效。我不知道是什么原因造成的。这是我想要正确处理的那种错误情况的一个例子。

**编辑：**这是一个遗留的分布式应用程序，它使用网络共享上的文件在节点之间进行通信。某些节点可能无人看管，因此可能无法将错误传递给最终用户。长期目标是切换到更好的协议，但短期内我想让文件 I/O 尽可能可靠。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T22:23:30.080

我相信你是从错误的角度来处理这个问题的。应用程序本身几乎无法改善本质上是网络文件系统驱动程序的问题，也许除了实现网络 I/O 本身之外。话虽如此，您最好还是根据自己的需要选择合适的网络文件系统。在维基百科上查看[这个](http://en.wikipedia.org/wiki/List_of_file_systems#Distributed_file_systems)。

通常，您的应用程序应该表现得像本地存储的文件一样。不要太努力地处理网络问题。但是，如果您选择的网络文件系统是好的，那么这些问题可以自动得到缓解。

所以我会说你应该解决检查*errno*以防出现错误。如果写入远程文件失败（如果网络文件系统本身无法处理），可能会回退到本地存储。

# sql-server - SQL 优化：一张表有多少列？

> ID：489003
> 
> 赞同：21
> 
> 时间：2009-01-28T19:35:27.143
> 
> 标签：sql-server, database-design

在最近的一个项目中，我看到了一个 50 到 126 列的表格。

一个表应该每个表包含更少的列，还是将它们分成一个新表并使用关系更好？优缺点都有什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-28T19:55:37.493

通常，最好先设计表以对数据要求进行建模并满足规范化规则。 **然后**担心优化，例如存储一行需要多少页等。

我同意这里的其他海报，即大量列是一个*潜在*的危险信号，表明您的表未正确规范化。但在这种情况下可能没问题。从你的描述我们无法判断。

无论如何，仅仅因为大量的列让您感到不安而将表格拆分并不是正确的补救措施。这真的会导致任何缺陷或性能瓶颈吗？你需要测量以确保，而不是假设。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-28T20:08:21.240

我发现的一个很好的经验法则就是随着项目的继续，表是否会增加行数，

例如：

在我正在进行的一个项目中，最初的设计者决定将站点权限作为列包含在用户表中。

所以现在，随着网站上新功能的实施，我们不断添加更多栏目。显然这不是最优的。更好的解决方案是拥有一个包含权限的表和一个用户之间的连接表以及分配给他们的权限。

但是，对于其他更多的档案信息，或者根本不需要增长或需要缓存/最小化页面/可以有效过滤的表，只要不妨碍，拥有一个大表就不会造成太大的伤害项目的维护。

至少这是我的看法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T19:37:53.597

通常过多的列指向不正确的规范化，但是如果没有关于您的要求的更多详细信息，就很难判断。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-28T19:44:56.483

我可以想象可能需要拥有这么多或更多列的时间。例如，如果您必须对数据进行非规范化和缓存 - 或者对于具有许多属性的行类型。我认为关键是要避免 select * 并确保您正在索引正确的列和组合。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-28T20:01:09.430

如果您有一个详细说明数据库中数据的对象，您会拥有一个包含 120 个字段的对象，还是会查看数据以提取逻辑上可区分的数据？您可以将 Address 数据与 Customer 数据内联，但将其删除并将其放入 Addresses 表中是有意义的，即使它与 Person 保持 1:1 映射。

接下来，您可能需要记录他们以前的地址，并且通过将其拆分，您已经消除了重构系统的一个主要问题。

是否有任何字段在多行中重复？即，是否复制了客户的详细信息，每张发票一个？在这种情况下，Customers 表中应该有一个客户条目，Invoices 表中应该有 n 个条目。

您不需要修复损坏的规范化的一个地方是您有一个事实表（用于审计等），其目的是聚合数据以运行分析。然而，这些表通常是从正确规范化的表中填充的（例如，一夜之间）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-28T19:39:23.030

听起来您有潜在的标准化问题。

如果你真的想要，你可以为这些列（有点极端）或相关列组中的每一个创建一个新表，并将它加入到每条记录的 ID 上。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T19:39:46.230

如果人们使用大量“Select * from GiantTableWithManyColumns”，它肯定会影响性能......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-28T19:53:37.620

以下是 SQL Server 2005 的官方统计数据 [http://msdn.microsoft.com/en-us/library/ms143432.aspx](http://msdn.microsoft.com/en-us/library/ms143432.aspx)

请记住，这些是最大值，不一定是可用性的最佳值。

考虑将 126 列拆分为多个部分。例如，如果它是某种“人”表，您可以拥有

个人 ID、AddressNum、AddressSt、AptNo、省、国家、邮政编码、电话、手机、传真

但是你可以把它分成 Person ID、AddressID、PhoneID

地址 ID、AddressNum、AddressSt、AptNo、省、国家、邮政编码

电话号码、电话、手机、传真

在第二个中，您还可以通过让所有具有相同地址的人具有相同的 addressId 而不是一遍又一遍地复制相同的文本来避免数据复制。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-28T19:47:48.600

SharePoint 中的[UserData](http://msdn.microsoft.com/en-us/library/ms998711.aspx)表有 201 个字段，但设计用于特殊目的。
在我看来，普通的桌子不应该这么宽。

您可能可以再规范化一些。并阅读网上一些关于表格优化的帖子。

不知道多一点就很难说。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-09T07:40:41.943

好吧，我不知道 sql 中可能有多少列，但我非常确定的一件事是，当你设计表时，每个表都是一个实体，这意味着每个表都应该包含关于一个人、一个地方的信息，一个事件或一个对象。所以直到在我的生活中，我都不知道一个东西可能有这么多的数据/信息。

您应该注意的第二件事是，有一种称为规范化的方法，它基本上用于将数据/信息划分为子部分，以便可以轻松维护数据库。我认为这将清除您的想法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-22T22:17:20.110

我处于类似的位置。是的，确实存在这样一种情况，在我的例子中，规范化表有大约 90 个列：一个工作流应用程序，它跟踪一个案例除了每个状态的变量属性之外还可以具有的许多状态。因此，随着每个案例（由记录表示）的进展，最终会为该案例填写所有列。现在在我的情况下，有 3 个逻辑分组（15 cols + 10 cols + 65 cols）。那么我是将它保存在一个表中（索引是 CaseID），还是拆分为通过一对一关系连接的 3 个表？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-25T12:55:20.313

表中的列1（合并发布）246

表 2（SQL Server 快照或事务发布）中的列数 1,000

表 2 中的列（Oracle 快照或事务性发布） 995

在一个表中，我们最多可以有 246 列

[http://msdn.microsoft.com/en-us/library/ms143432.aspx](http://msdn.microsoft.com/en-us/library/ms143432.aspx)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-01-28T19:45:06.453

一个表应该有尽可能少的列......

在 SQL Server 中，表存储在页上，8 页是一个范围

在 SQL Server 中，一个页面可以容纳大约 8060 字节，页面上可以容纳的数据越多，返回数据所需的 IO 就越少

您可能想要规范化（AKA 垂直分区）您的数据库

# .net - 在 _layouts 下从 ASP.NET 运行 STSADM

> ID：489006
> 
> 赞同：2
> 
> 时间：2009-01-28T19:36:53.613
> 
> 标签：.net, asp.net, sharepoint, sharepoint-2007

是否可以从位于 _layouts 文件夹中的 ASP.NET 应用程序运行 STSADM？

我已在[此页面](http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/517c92c8-ebe5-42c7-bfb3-bde0c12fda2f/#page:2)上复制了此代码。

当它运行时，返回消息是**Access Denied**。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T19:45:30.493

如果您正在尝试这样做，您可能需要授予对相关 SharePoint 应用程序的 ASP.NET 应用程序池帐户的访问权限以执行 stsadm。或者，如果您正在模拟帐户，则发送给有问题的模拟用户。您还需要为其运行的所有 SharePoint 内容（SQL Server、SharePoint 内容等）授予应用程序池帐户附带权限

注意：这可能会带来各种风险，从 Internet/Intranet 运行 STSADM 可以做各种我不敢想的事情。非常警惕对 stsadm 命令执行的注入攻击以及提升特权以执行没有业务的 stsadm 的人。你能想出一个更好的方法来做你想做的事吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T23:01:28.613

Process.Start 将导致 STSADM[在 ASPNET 工作进程帐户下运行](http://www.codinghorror.com/blog/archives/000133.html)

因此，如果您授予此帐户使用 STSADM 的权限，那么您必须确保您的网页正确限制了可以执行的操作以及由谁执行

+10 为 tekiegreg 的 CAUTION 评论 - 如果你弄错了它可能会变成核！

也许更好的方法是使用对象模型[Microsoft.SharePoint.Administration](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.aspx)作为大多数可以通过 STSADM 完成的事情都可以通过 WSSv3 的对象模型完成

这将有几个优点 1）不解析 console.out 字符串 2）您应该能够[模拟经过身份验证的用户](http://support.microsoft.com/kb/306158)，以便 STSADM/SharePoint 负责确定允许用户执行的操作。

# apache-flex - Flex：如何创建一个全新的组件？

> ID：489024
> 
> 赞同：5
> 
> 时间：2009-01-28T19:44:06.423
> 
> 标签：apache-flex, user-interface

我想为 Flex 开发一个网络图应用程序 - 想象一下将节点放在 Canvas 上并通过链接将它们连接起来。节点应具有可编辑的文本和其他 UI 组件。

我试图找到从头开始创建全新 UI 组件的示例，但我所能找到的只是扩展现有组件的简单示例：例如，扩展 Button 的 RedButton 或具有状态的 ComboBox从中选择。

我的主要问题是，**什么 ActionScript 方法定义了组件的绘制？** Java 的 paint() 方法的 ActionScript 等价物是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T19:55:20.503

您想创建一个覆盖 updateDisplayList 方法的组件，并在其中进行绘图：

```
override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
{
  super.updateDisplayList( unscaledWidth, unscaledHeight );

  // The drawing API is found on the components "graphics" property
  graphics.clear();
  graphics.lineTo( 0, unscaledWidth );
  // etc
} 
```

更多信息可以在这里找到： http://livedocs.adobe.com/flex/3/html/help.html?content= [ascomponents_advanced_3.html](http://livedocs.adobe.com/flex/3/html/help.html?content=ascomponents_advanced_3.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T19:57:37.970

如果您需要自定义组件的示例，我建议您查看[flexlib项目。](http://code.google.com/p/flexlib/)

[这里](http://livedocs.adobe.com/flex/3/html/help.html?content=ascomponents_advanced_1.html)的 livedocs 有很好的一般信息

尽管您可以在 MXML 和 ActionScript 中创建自定义组件，但我建议您在 ActionScript 中实现它们。

简而言之，这是您需要做的：

> 在 ActionScript 中创建自定义组件时，您必须重写 UIComponent 类的方法。您实现了基本的组件结构、构造函数以及 createChildren()、commitProperties()、measure()、layoutChrome() 和 updateDisplayList() 方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T20:08:14.517

我建议阅读 Peter Ent 关于创建自定义组件的 5 部分教程系列。 [这](http://weblogs.macromedia.com/pent/archives/2007/10/component_class.html)是第 1 部分的链接。

[还推荐有关ItemRenderers](http://weblogs.macromedia.com/pent/archives/2008/03/itemrenderers_p.html)和[ItemEditors](http://weblogs.macromedia.com/pent/archives/2008/05/itemeditors_-_p.html)的教程系列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T01:44:02.360

Kazoun 和 Lott 编写的 Programming Flex 2 第 19 章展示了构造事件模型和刷新事件模型。

简而言之，Flex 组件结构假定您具有影响其外观的对象属性。它允许属性修改器通过继承的 invalidateProperties() 方法使组件的“内容”（例如文本）无效，而不是立即应用更改。当属性更改将改变组件的大小时，还调用 invalidateSize()，当需要重新绘制事物时调用 invalidateDisplayList()（而不是仅仅使用不同的文本）。

这种失效模型优化了组件的工作。它不会测量自己，除非它知道它改变了大小；它不会放置和绘制自己，除非自上次更新布局以来调用了 invalidateDisplayList() ；并且它不会将其属性的值移动到其子组件中，除非它知道这些值已更改。

干杯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T04:04:11.343

典型的行为是对现有组件进行子类化，主要是因为已经为您完成了实现这么多最典型类型组件功能的大量工作——您只需要知道哪个组件最类似于您的组件想创造。（考虑到有多少，这本身就是一个挑战。）

[但是，如果您愿意，您可以简单地通过扩展UIComponent](http://livedocs.adobe.com/flex/3/langref/index.html?mx/core/IUIComponent.html&mx/core/class-list.html) （这将为您提供所有基线内容） “从头开始”创建一个非常简单的UIComponent ，或者我想，如果您*真的*想要极简主义，并且您'迎接挑战，你可以只实现[IUIComponent](http://livedocs.adobe.com/flex/3/langref/index.html?mx/core/IUIComponent.html&mx/core/class-list.html)，并手动定义每个接口方法。如果您确实选择走第二条路线，请帮自己一个忙，[听听这次谈话](http://tv.adobe.com/#vi+f15384v1002)首先——这是对 Flex 组件架构的深入讨论，由 Flex 团队的一位工程师提供。我经常强烈推荐它；它非常好，它阐明了许多组件开发细节，但这些细节仍然没有得到很好的记录。如果您要构建您所描述的那种非平凡的自定义组件，那么非常有价值的东西。

希望能帮助到你。祝你好运！

# sql - 我可以在 TSQL 中使用 WITH 两次来过滤像我的示例那样的结果集吗？

> ID：489026
> 
> 赞同：16
> 
> 时间：2009-01-28T19:44:35.440
> 
> 标签：sql, sql-server, common-table-expression

我需要做这样的事情，但 SQL Server 2008 不喜欢它。我的查询实际上比这更复杂，我意识到这不是完成我正在做的事情的最佳方式，但我的重点是 WITH 语句的功能，而不是 select 和 where 语句。

> WITH stuff1 AS（从 startdate > 0 的员工中选择名称、开始日期、id）
> 
> WITH stuff2 AS（从 stuff1 中选择名称、开始日期、id）
> 
> select * from stuff2 where id > 10

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-28T21:01:15.457

我一直这样做：

```
WITH stuff1 AS (
    SELECT name
           ,startdate
           ,id
    FROM employees
    WHERE startdate > 0
)
,stuff2 AS (
    SELECT name
           ,startdate
           ,id
    FROM stuff1
)
SELECT *
FROM stuff2
WHERE id > 10 
```

据我所知，我还没有达到 CTE 的极限。

您唯一不能做的事情（这将非常有用）是在单独`SELECT`的 s 中重用 CTE：

```
WITH stuff1 AS (
    SELECT name
           ,startdate
           ,id
    FROM employees
    WHERE startdate > 0
)
,stuff2 AS (
    SELECT name
           ,startdate
           ,id
    FROM stuff1
)
SELECT *
FROM stuff2
WHERE id > 10
;
SELECT *
FROM stuff2
WHERE id < 10 
```

说。相反，您必须再次复制并粘贴整个 CTE 链。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T20:14:38.687

您也许可以对我们进行一系列子查询。或嵌套在 CTE 中的子查询。

使用 Northwind 的子查询示例：

```
SELECT * FROM 
    (SELECT * FROM
        (SELECT * FROM dbo.Employees WHERE Country = 'USA') as TableFiltered1
     ) AS TableFilterd2 WHERE City = 'Seattle' 
```

您可以使用两个 CTE，但可能不是您想要的方式，请参阅：
[http ://www.4guysfromrolla.com/webtech/071906-1.shtml](http://www.4guysfromrolla.com/webtech/071906-1.shtml)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-01-28T19:46:06.263

不，正如我前几天发现的那样，您只能在声明中包含一个 CTE。

*编辑*： WITH 语句是一个通用表表达式，非常方便的功能。

# networking - 套接字 API accept() 函数是如何工作的？

> ID：489036
> 
> 赞同：136
> 
> 时间：2009-01-28T19:47:27.290
> 
> 标签：networking, sockets, tcp

套接字 API 是 TCP/IP 和 UDP/IP 通信（即我们所知道的网络代码）的事实标准。但是，它的核心功能之一，`accept()`有点神奇。

借用一个半正式的定义：

> accept() 在服务器端使用。它接受接收到的来自远程客户端创建新 TCP 连接的传入尝试，并创建一个与此连接的套接字地址对关联的新套接字。

换句话说，`accept`返回一个新的套接字，服务器可以通过它与新连接的客户端进行通信。旧的套接字（`accept`被调用）在同一个端口上保持打开状态，监听新的连接。

如何`accept`工作？它是如何实施的？关于这个话题有很多困惑。许多人声称接受打开一个新端口，您通过它与客户端通信。但这显然不是真的，因为没有打开新端口。您实际上可以通过同一个端口与不同的客户端进行通信，但是如何？当多个线程调用`recv`同一个端口时，数据怎么知道去哪里？

我猜这与客户端地址与套接字描述符相关联的内容类似，并且每当数据通过时`recv`，它都会被路由到正确的套接字，但我不确定。

很高兴能彻底解释这种机制的内部工作原理。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-01-28T19:51:18.810

您的困惑在于认为套接字是由服务器 IP 标识的：服务器端口。实际上，套接字由四组信息唯一标识：

**`Client IP : Client Port`和`Server IP : Server Port`**

因此，虽然服务器 IP 和服务器端口在所有接受的连接中都是不变的，但客户端信息是允许它跟踪所有内容的原因。

澄清事情的例子：

假设我们有一个服务器`192.168.1.1:80`和两个客户端，`10.0.0.1`并且`10.0.0.2`.

`10.0.0.1`在本地端口上打开一个连接`1234`并连接到服务器。现在服务器有一个套接字，标识如下：

```
10.0.0.1:1234 - 192.168.1.1:80 
```

现在`10.0.0.2`在本地端口上打开一个连接`5678`并连接到服务器。现在服务器有两个套接字，标识如下：

```
10.0.0.1:1234 - 192.168.1.1:80  
10.0.0.2:5678 - 192.168.1.1:80 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2009-03-05T16:35:51.553

只是为了添加用户“17 of 26”给出的答案

套接字实际上由 5 个元组组成——（源 ip、源端口、目标 ip、目标端口、协议）。这里的协议可以是 TCP 或 UDP 或任何传输层协议。该协议在数据包中由 IP 数据报中的“协议”字段标识。

因此，服务器上的不同应用程序可能必须在完全相同的 4 元组上与同一客户端通信，但协议字段不同。例如

服务器端的 Apache 正在通话（TCP 上的 server1.com:880-client1:1234）和魔兽世界正在通话（UDP 上的 server1.com:880-client1:1234）

即使所有其他 4 个字段相同，客户端和服务器都会处理此问题，因为在两种情况下 IP 数据包中的协议字段都不同。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-30T11:04:43.453

当我学习这个时，让我感到困惑的是，这些术语`socket`和`port`暗示它们是物理的，而实际上它们只是内核用来抽象网络细节的数据结构。

因此，数据结构被实现为能够将来自不同客户端的连接分开。至于它们是*如何*实现的，答案是 a.) 没关系，sockets API 的目的恰恰是实现不重要，或者 b.) 看看。除了强烈推荐的 Stevens 书籍提供了一种实现的详细描述之外，还可以查看 Linux 或 Solaris 或 BSD 中的源代码。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-28T20:01:53.907

正如其他人所说，套接字由 4 元组（客户端 IP、客户端端口、服务器 IP、服务器端口）唯一标识。

在服务器 IP 上运行的服务器进程维护一个活动套接字的数据库（这意味着我不关心它使用什么样的表/列表/树/数组/魔术数据结构）并侦听服务器端口。当它接收到消息（通过服务器的 TCP/IP 堆栈）时，它会根据数据库检查客户端 IP 和端口。如果在数据库条目中找到客户端 IP 和客户端端口，则将消息传递给现有的处理程序，否则将创建一个新的数据库条目并生成一个新的处理程序来处理该套接字。

在 ARPAnet 的早期，某些协议（一种是 FTP）会监听指定端口的连接请求，并以切换端口进行回复。该连接的进一步通信将通过切换端口。这样做是为了提高每个数据包的性能：当时计算机的速度要慢几个数量级。

# .net - .NET mshtml：如何传递 BSTR SAFEARRAY？

> ID：489048
> 
> 赞同：2
> 
> 时间：2009-01-28T19:51:33.600
> 
> 标签：.net, com, interop, mshtml

Microsoft.mshtml.dll 程序集中的 mshtml.HTMLDocumentClass 类有一个方法：

```
public virtual void write(params object[] psarray); 
```

暂时避免真正的问题，您将使用什么代码来调用**write()**？你会使用：

```
String html = "<html><body>Hello, world!</body></html>";
mshtml.HTMLDocumentClass doc;
...
doc.write(html); 
```

或者你会使用：

```
String html = "<html><body>Hello, world!</body></html>";
mshtml.HTMLDocumentClass doc;
...
object[] params = new Object[1];
params[0] = html;
doc.write(params); 
```

因为这两个都抛出异常。（类型不匹配。0x80020005）

**HTMLDocumentClass.write**方法实际上来自IHTMLDocument2[接口](http://msdn.microsoft.com/en-us/library/aa752639(VS.85).aspx)，它被记录为：

> IHTMLDocument2::write 方法
> 
> 将一个或多个 HTML 表达式写入指定窗口中的文档。
> 
> **句法**
> 
> ```
> HRESULT write(
>    SAFEARRAY *psarray
> ); 
> ```
> 
> **参数**
> 
> psarray
> 
> ```
>  [in] A **BSTR** that specifies the text and HTML tags to write. 
> ```

所以实际上 write 方法需要一个指向 SAFEARRAY 的指针，即使 Microsoft 的**Microsoft.mshtml**互操作程序集将**write**方法定义为采用常规数组：

```
public virtual void write(params object[] psarray); 
```

忽略 mshtml 互操作声明，我必须构造一个**SAFEARRAY**对象（对象数组），用 BSTR 字符串（字符串）填充它，并将其填充到必须是对象数组的参数中。

* * *

注意：我不确定**params**关键字的含义。它用于指示可变数量的参数。

这是否意味着它可以采用多个数组参数？

```
object[] array1 = new Object[1];
array1 [0] = alpha;
object[] array2 = new Object[1];
array2 [0] = bravo;
object[] array3 = new Object[1];
array3 [0] = charlie;
object[] array4 = new Object[1];
array4 [0] = delta;

doc.write(array1, array2, array3, array4); 
```

还是 object[] 是传递多个参数的方法，并且您必须逐字创建一个数组？

```
object[] params = new Object[4];
params[0] = alpha;
params[1] = bravo;
params[2] = charlie;
params[3] = delta;
doc.write(params); 
```

或者 array[] 只是一个诱饵，你真的通过了：

```
doc.write(alpha, bravo, charlie, delta); 
```

* * *

当我最初从本机 Win32 应用程序中使用此代码时，BSTR 被放置在 SAFEARRAY 中。在基于 IDispatch 的自动化中，一切都在数组中。在这种情况下，后期绑定代码：

```
doc.write(html); 
```

由编译器转换为 SAFEARRAY，其中第零个元素包含 BSTR 字符串（这是一个长度前缀的 unicode 字符串）。

我的问题变成了尝试构建 SAFEARRAY、将字符串转换为 BSTR、将 BSTR 放入 SAFEARRAY 的第零个元素以及将包含 SAFEARRAY 的变量传递给仅接受对象数组（object [ ]）。

**这是真正的问题：**如何创建 BSTR SAFEARRAY？

* * *

> 微软.mshtml
> 
> C:\Program Files\Microsoft.NET\Primary Interop Assemblies\Microsoft.mshtml.dll

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T20:23:58.870

[`IHTMLDocument2`](http://msdn.microsoft.com/en-us/library/aa752574%28v=vs.85%29.aspx)TLBIMP/VS.NET创建的接口的write方法声明不正确。它应该是：

```
void Write([In, MarshalAs(UnmanagedType.SafeArray)] object[] psarray); 
```

您必须在代码中定义此接口，然后使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T20:48:34.187

params 关键字表示你可以在这个地方提供多个参数，它会自动分组。例如，如果我有这样的功能：

```
public int SumNumbers(params int[] value)
{
       //Logic.
} 
```

那么我可以这样称呼它：

```
int myValue = SumNumbers(1,2,3,4,5,6,7,8,9,10); 
```

数组是自动构建的。所以假设，你可以打电话

```
mshtml.HTMLDocumentClass doc;
...
doc.write('H','I',' ','M','O','M'); 
```

它会起作用。虽然不是很实用。我想你试过打电话

```
doc.write(myString.ToCharArray()); 
```

? 我对 SAFEARRAYS 一无所知，但您可能也不必知道，这取决于编译器如何帮助/阻碍这里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T11:47:35.623

它以这种方式就像一个魅力：

```
[Guid("332C4425-26CB-11D0-B483-00C04FD90119")]
[ComImport]
[TypeLibType((short)4160)]
[InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIDispatch)]
internal interface IHTMLDocument2
{
    [DispId(1054)]
    void write([MarshalAs(UnmanagedType.BStr)] string psArray); //modified 
    //void write([MarshalAs(UnmanagedType.SafeArray, SafeArraySubType = VarEnum.VT_VARIANT)] object[] psarray); //instead of 
```

# c# - 如何向我的 C# 字典添加一个 Python 风格的 Get() 方法，该方法采用默认值？

> ID：489051
> 
> 赞同：0
> 
> 时间：2009-01-28T19:53:12.007
> 
> 标签：c#, dictionary, default-value

如果在字典中找不到我指定的键，我希望能够指定要返回的默认值。

例如

```
int default = 5;
string key = "MyKey";
int foo = myDictionary.GetValue(key, default); 
```

if `key`is in`myDictionary` `foo`应该保存字典中的值，否则它将保存`5`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T19:53:56.043

[我在这里](http://gen5.info/q/2008/07/17/the-semantics-of-dictionaries-maps-and-hashtables/)找到了一段代码，它通过向 IDictionary 添加扩展方法很好地完成了这项工作：

```
using System.Collections.Generic;

namespace MyNamespace {
    public static class DictionaryExtensions {
        public static V GetValue<K, V>(this IDictionary<K, V> dict, K key) {
            return dict.GetValue(key, default(V));
        }

        public static V GetValue<K, V>(this IDictionary<K, V> dict, K key, V defaultValue) {
            V value;
            return dict.TryGetValue(key, out value) ? value : defaultValue;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T20:29:20.293

最好的方法是使用 TryGetValue，一种可能的方法是：

```
 int default = 5;
    string key = "MyKey"; 
    int foo = 0;
    defaultValue = 5;
    (myDictionary.TryGetValue(key, out foo))?return foo: return defaultValue; 

```

如果您尝试获取不存在的值，则 TryGetValue 将返回 false，这意味着您使用了该子句的第二部分。

您还可以决定将 foo 设置为默认值，使用 TryGetValue 并在任何情况下返回 foo。

# language-agnostic - 如何动态配置应用程序？

> ID：489052
> 
> 赞同：4
> 
> 时间：2009-01-28T19:53:15.610
> 
> 标签：language-agnostic, configuration

当我说“配置”时，我的意思是在哪里保存那些可能经常变化的值（常数值，如税率或类似的东西），然后当你需要更改它们时，你不想重新编译你的应用程序。

在哪里保存这些值？数据库？XML 文件？平面文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T19:57:58.313

这取决于这些变化的频率以及是谁或什么改变了它们。对于某些特定于应用程序的设置，最好使用 XML 或配置文件，其中开发人员负责更新它。对于其他“商业”值（如汇率、税率等），最好将它们保存在数据库中，并为用户（而非开发人员）提供更新的 UI。

它还取决于有多少应用程序依赖于该值，例如，如果多个应用程序依赖于某些设置（例如电子邮件服务器地址），最好将它放在数据库中，因为它可以从任何机器轻松访问应用程序正在运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T19:55:23.420

我将 INI 文件用于潜在的用户可配置文件，将 BIN 文件用于在运行之间保存会话状态的数据。

但是，这在很大程度上取决于您正在开发的应用程序类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T19:56:12.670

这取决于您的应用程序是如何架构的。您可以以可以更改配置位置的方式设计您的应用程序。只需注入提供程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T19:59:13.287

如果数据是结构化的，通常我使用 Ini 文件或 XML。

对于已经使用数据库并且您不希望用户轻松更改数据的应用程序，您可以使用数据库。

除非您想为用户混淆数据，否则我几乎从不使用二进制数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T09:20:58.000

无论应用程序如何，您都可能至少有 3 个配置数据来源：

1.  命令行标志，通常用于引导您的运行时环境，例如，查找配置文件、设置调试标志、包含路径、类路径等
2.  配置文件，可能不止一个可以相互覆盖。这些通常引导您的应用程序：连接字符串、缓存设置、特定于构建的设置等
3.  控制数据库中的数据。时区、转换率、稳定的显示值等。这些数据也应该在数据库中进行版本控制（如“数据版本”字段，而不是存在于版本控制系统中）。当您发现需要更改新版本的设置时，对其进行版本控制会省去很多麻烦，但是如果您更改旧版本，旧版本就会中断。

通常，在运行时更改的任何内容都应该进入数据库。任何敏感且很少更改的内容都应该进入配置文件，任何黑客都应该在命令行上进行（--[no]enable-bug-287438-hack 在您需要时非常方便）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T02:39:40.877

我更喜欢平面`ini`文件的简单性。这是一个您可能会发现有用的示例[`Setting`类。](https://stackoverflow.com/questions/577782/where-to-store-configuration-information/597835#597835)

# wpf - 在 WPF 中使用 RenderTransform 增加 DataTemplate 的大小

> ID：489053
> 
> 赞同：2
> 
> 时间：2009-01-28T19:53:33.253
> 
> 标签：wpf, layout

我正在使用一个 DataTemplate 动画 RenderTransform 以在鼠标悬停时增加其大小。我遇到的问题是，当动画生效时，放大的列表框项目出现在其他项目的后面。有没有办法从我的 DataTemplate 中控制列表框项的 ZIndex 以使其始终位于其他项之上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T08:14:33.053

zIndex 仅适用于托管在 Canvas 内的元素。因此，您可以将整个列表框控件包装在画布中，然后将 Canvas.zIndex 设置为 99，作为您用于执行转换的 Trigger 的一部分。但是我无法让它工作。

唯一可行的其他选项是使用 LayoutTransform 而不是 RenderTransform，因为这会将其他项目移开，因为在放置项目之前计算转换。这意味着不需要设置任何 zIndex，但这取决于您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T23:45:38.947

您可以使用触发器从模板设置模板化元素的 ZIndex。通过 VisualTree 解析找出模板化的父控件，如下所示

{RelativeSource FindAncestor,AncestorType=...

# windows - 如何使用 Windows API 从麦克风录制 wav 声音？

> ID：489061
> 
> 赞同：3
> 
> 时间：2009-01-28T19:55:06.620
> 
> 标签：windows, winapi, audio

如何使用 Windows API 从麦克风录制 wav 声音？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T02:59:43.813

您可以使用一系列 waveInXXX Windows API 来录制音频。（即waveInOpen、waveInPrepareHeader、waveInAddBuffer、waveInStart...）这些将以“原始”PCM 格式录制音频，然后您可以将其放入WAV 文件中。（WAV 文件基本上可以只是一个“包含”原始 PCM 音频的 RIFF 文件容器）。

这是 MSDN 参考页面：[使用波形音频设备录制](https://msdn.microsoft.com/en-us/library/windows/desktop/dd798631%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T15:52:40.300

查看所有 MSDN 示例 (WSDK)，当然，始终是唯一可靠的示例

# c# - .NET WinForms 应用程序中的异常何时可以被吃掉而不会被捕获或冒泡到 Windows 异常？

> ID：489071
> 
> 赞同：5
> 
> 时间：2009-01-28T19:57:57.283
> 
> 标签：c#, winforms, unhandled-exception

在我们代码的几个地方，我们注意到如果在调试器下运行，它会显示代码中有一个未处理的异常，但是如果在调试器之外运行，它会完全忽略异常，就好像它被捕获一样。我们有一个异常处理程序，它会弹出一个错误提交对话框，该对话框连接到 Application.ThreadException 和 AppDomain.CurrentDomain.UnhandledException 并且这些似乎都没有捕获它们。我们还记录了我们的异常，日志中没有任何内容。

这有哪些可能的原因？

编辑：似乎它不依赖于异常抛出的类型，而是它被抛出的位置。只需添加以下内容即可对此进行测试：

```
throw new Exception("Test Exception"); 
```

它会显示在调试器下，但不会显示在外面，所以在我们的例子中，它不是 ThreadAbortedException 或任何依赖于它的特定类型的异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T20:03:33.997

有一些特殊的异常不会冒泡或捕获，听起来您正在处理其中之一：请参阅[ThreadAbortException](http://msdn.microsoft.com/en-us/library/system.threading.threadabortexception.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T21:58:21.270

发现可能发生这种情况的一个地方是 UnhandledException 事件处理程序中是否存在异常。一个简单的查看方法是：在 Form.Load 事件处理程序中抛出任何旧异常。在 Application.ThreadException 事件中放置类似于以下内容的内容：

```
static void Application_ThreadException(object sender, System.Threading.ThreadExceptionEventArgs e)
{
     string b = null;
     int i = b.Length;
} 
```

在调试器下，它会显示您的异常未被用户代码处理，然后它会在 ThreadException 处理程序中显示空引用异常，但如果您在调试器之外运行它，它只会像处理一样吞下异常.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T20:10:14.187

如果您尝试从创建控件的不同线程修改 Windows 窗体控件的属性，如果附加了调试器，则会收到[InvalidOperationException](http://msdn.microsoft.com/en-us/library/system.invalidoperationexception(VS.80).aspx)，但否则会被静默忽略。

可以在此处找到有关此问题的更多信息：

[http://msdn.microsoft.com/en-us/library/ms171728(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms171728(VS.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T20:16:32.833

您的代码是从框架中调用的。

有时，框架将其调用包装在异常处理程序中。

因此，如果您的代码中有异常，它可能（如果框架中有异常处理程序）被框架捕获并忽略。

也许调试器将其显示为“未处理”，因为尽管框架中有处理程序，但您的代码中没有处理程序？或者，因为框架中的处理程序有些奇怪，例如它是一个非托管的结构化异常处理程序？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T22:41:46.127

您使用的是 .Net 1.0/1.1 吗？在从 1.1 到 2.0 的过渡过程中，行为发生了巨大变化。在此之前，您创建的线程或 ThreadPool 线程上引发的异常将被框架静默吞下，线程将退出。值得庆幸的是，此行为现已得到修复。

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms228965.aspx)：

> ## 从以前的版本更改
> 
> 最重要的变化与托管线程有关。在 .NET Framework 版本 1.0 和 1.1 中，公共语言运行库在以下情况下为未处理的异常提供了支持：
> 
> *   线程池线程上没有未处理的异常。当一个任务抛出一个它没有处理的异常时，运行时将异常堆栈跟踪打印到控制台，然后将线程返回到线程池。
>     
>     
> *   在使用 Thread 类的 Start 方法创建的线程上不存在未处理的异常。当在此类线程上运行的代码抛出它无法处理的异常时，运行时会将异常堆栈跟踪打印到控制台，然后优雅地终止线程。
>     
>     
> *   终结器线程上没有未处理的异常。当终结器抛出它不处理的异常时，运行时会将异常堆栈跟踪打印到控制台，然后允许终结器线程继续运行终结器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-04T12:04:51.183

Kind of a stretch here, but could it be that you just have set your debugger to break when an exception is thrown, and not only for the unhandled ones?

# sql - Informix 中的 group_concat

> ID：489081
> 
> 赞同：4
> 
> 时间：2009-01-28T20:00:22.210
> 
> 标签：sql, informix

在 Informix 的 SQL 中查找将模拟 MySQL`group_concat`功能的查询。

MySQL`group_concat`所做的是创建组中所有成员的枚举。

所以数据如下：

```
orderid:itemName:price
      1:Paper   :10
      1:Pen     :5
      2:Sugar   :15 
```

和以下查询：

```
select group_concat(itemName), sum(price)
from order_details
group by orderid 
```

会产生：

```
items    :price
Paper,Pen:15
Sugar    :15 
```

在 Informix 中实现这一目标的最有效方法是什么？我们一定要使用存储过程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T19:23:08.580

您必须定义一个用户定义的聚合来执行此操作。这有四个部分 - 四个功能（在[IDS 12.10 信息中心](http://www-01.ibm.com/support/knowledgecenter/SSGU8G_12.1.0/com.ibm.welcome.doc/welcome.htm)搜索[CREATE AGGREGATE](https://www.ibm.com/support/knowledgecenter/SSGU8G_12.1.0/com.ibm.sqls.doc/ids_sqs_0358.htm)）：

1.  初始化程序 (INIT)
2.  迭代器 (ITER)
3.  结合（结合）
4.  终结器（最终）

这是大写字母的官方术语，它是适度直观的。考虑计算平均值。

1.  初始化器：设置 sum = 0; N = 0
2.  迭代器：set sum += x; N++
3.  组合器：设置 sum = sum1 + sum2；设置 N = N1 + N2
4.  终结器：result = sum / N -- N=0（零除）检查

组合器用于组合并行执行的中间结果；每个并行执行都从迭代器开始并生成中间结果。当并行执行完成时，单独的值集与组合器组合。

您可以在 IDS 中编写类似的代码 - 使用存储过程或 C 或 Java UDR。

请参阅 SO 问题[Show a one to many relationship as 2 columns — 1 个唯一行（ID 和逗号分隔列表）](https://stackoverflow.com/questions/715350/show-a-one-to-many-relationship-as-2-columns-1-unique-row-id-comma-separated)，用于在 Informix 中实现的基于字符串的 GROUP_CONCAT() 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T22:22:59.113

Informix 中当然没有内置函数来执行此操作。其他主流RDBMS有没有这么奇葩的聚合功能？按查询中未选择的列排序有点可疑，但分组？这对我来说是一个新的。

您必须编写存储过程或 UDR 来生成这样的数据集。老实说，我不会在数据库中尝试这样做。它看起来像是最适合此输出的使用者（即应用程序/webapp/report-writer 等）的任务。

# vb.net - 我可以为指定的 Session 变量设置不同于其他 Session 变量的 Session 超时吗

> ID：489091
> 
> 赞同：1
> 
> 时间：2009-01-28T20:01:54.593
> 
> 标签：vb.net, asp.net-2.0

我想在 .Net Web 应用程序中的特定会话变量上设置超时，但不理会其他会话变量。这可能吗？

例子：

我有 5 个会话变量

会话(var1) 会话(var2) 会话(var3) 会话(var4) 会话(var5)

我想将其设置为 Session(var1) 到 Session(var4) 的超时时间为 8 小时（480 分钟），但 Session(var5) 的超时时间为 20 分钟。可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T20:07:40.323

您需要使用 Session 的替代品进行存储。asp.net 的缓存框架可能是最接近的替代方案。请参阅[将项目添加到缓存](http://msdn.microsoft.com/en-us/library/18c1wd61(VS.71).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T20:17:30.630

您可以提供自己的[HttpSessionStateBase](http://msdn.microsoft.com/en-us/library/system.web.httpsessionstatebase.aspx)实现，您的版本会知道当它们从会话中刷新时它可以存储和更改的不同内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T20:18:34.777

您可以通过在此变量（或关联的时间戳字段）中创建时间戳字段来实现此功能。时间戳将标记变量失效的时间。当然，您必须在代码中手动处理时间戳（每次点击更新它，并在它变得无效时将其从会话中删除）。

# regex - 如何确定一个正则表达式是否与另一个正则表达式正交？

> ID：489095
> 
> 赞同：15
> 
> 时间：2009-01-28T20:02:49.177
> 
> 标签：regex, fsm

我想我的问题最好用一个（简化的）例子来解释。

正则表达式 1：

```
^\d+_[a-z]+$ 
```

正则表达式 2：

```
^\d*$ 
```

正则表达式 1**永远不会**匹配正则表达式 2 匹配的字符串。因此，假设正则表达式 1与正则表达式 2*正交*。

正如许多人问我所说的*正交*是什么意思，我将尝试澄清它：

令*S1*为正则表达式 1 匹配的（无限）字符串集。 *S2*是正则表达式 2 匹配的字符串集。*如果*S1 和 S2 的交集为空，则正则表达式 2 与正则表达式 1 正交。正则表达式 ^\d_a$ 不会是**正交**的，因为字符串 '2_a' 在集合 S1**和**S2 中。

如果两个正则表达式相互正交，如何以编程方式确定？

最好的情况是一些实现如下方法的库：

```
/**
 * @return True if the regex is orthogonal (i.e. "intersection is empty"), False otherwise or Null if it can't be determined
 */
public Boolean isRegexOrthogonal(Pattern regex1, Pattern regex2); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T20:38:55.330

“正交”是指“交叉点是空集”我接受吗？

我会为交集构造正则表达式，然后转换为正常形式的正则语法，看看它是否是空语言......

再说一次，我是理论家...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-01T17:09:59.003

> 我会为交集构造正则表达式，然后转换为正常形式的正则语法，看看它是否是空语言......

这似乎是用大炮射麻雀。为什么不直接构建产品自动机并检查是否可以从初始状态到达接受状态？这也将立即在交集处为您提供一个字符串，而无需先构造正则表达式。

> 得知有多项式时间解决方案我会有点惊讶，而得知它等同于停止问题我一点也不惊讶。

我只知道一种方法，它涉及从正则表达式创建 DFA，这是指数时间（在退化的情况下）。它可以还原为停机问题，因为一切都可以，但是停机问题*不能*还原为*它*。

> 如果是最后一个，那么您可以使用任何 RE 都可以转换为有限状态机的事实。如果两个有限状态机具有相同的节点集，则它们是相等的，并且连接这些节点的弧线相同。
> 
> 因此，鉴于我认为您使用的正交定义，如果您将 RE 转换为 FSM 并且这些 FSM 不相等，则 RE 是正交的。

这是不正确的。您可以有两个在边缘标记的多图意义上是非同构的 DFA (FSM)，但接受相同的语言。此外，如果不是这种情况，您的测试将检查两个正则表达式是否接受不*相同*，而 OP 想要不*重叠*的语言（空交集）。

* * *

另外，请注意 \1, \2, ..., \9 结构不是规则的：它不能用连接、联合和 *（Kleene 星号）表示。如果你想包括反向替换，我不知道答案是什么。同样有趣的是，上下文无关语言的相应问题是不可判定的：没有算法可以采用两个上下文无关文法 G1 和 G2 并返回真当且仅当 L(G1) ∩ L(g2) ≠ Ø。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-05-23T16:01:56.093

这个问题发布已经两年了，但我很高兴地说，现在只需在此处调用“genex”程序即可确定：[https ://github.com/audreyt/regex-genex](https://github.com/audreyt/regex-genex)

```
$ ./binaries/osx/genex '^\d+_[a-z]+$' '^\d*$'
$ 
```

空输出意味着没有匹配两个正则表达式的字符串。如果它们有任何重叠，它将输出整个重叠列表：

```
$ runghc Main.hs '\d' '[123abc]' 
1.00000000      "2"
1.00000000      "3"
1.00000000      "1" 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-01T16:36:59.647

fsmtools可以在有限状态机[上](http://www.research.att.com/~fsmtools/fsm/)执行各种操作，您唯一的问题是将正则表达式的字符串表示形式转换为 fsmtools 可以使用的格式。对于简单的情况，这绝对是可能的，但在存在诸如look{ahead,behind}之类的高级功能时会很棘手。

您可能还会看看[OpenFst](http://www.openfst.org/)，尽管我从未使用过它。不过，它支持交叉点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T08:46:55.413

> \1, \2 位的优点...这是上下文无关的，因此无法解决。次要观点：并非一切都可以归结为停止......例如程序等效...... – Brian Postow

[我正在回复评论]

IIRC，`a^n b^m a^n b^m`不是上下文无关的，因此`(a\*)(b\*)\1\2`也不是，因为它是相同的。`{ ww | w ∈ L }`即使 L 是“nice”，ISTR也不是“nice”，因为它是`regular`,中的一个很好`context-free`。

我修改了我的声明：*RE*中的所有内容都可以归结为停止问题；-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-09T23:30:35.977

我终于找到了我正在寻找的图书馆：

[dk.brics.automaton](http://www.brics.dk/automaton/)

用法：

```
/**
 * @return true if the two regexes will never both match a given string
 */
public boolean isRegexOrthogonal( String regex1, String regex2 ) {
   Automaton automaton1 = new RegExp(regex1).toAutomaton();
   Automaton automaton2 = new RegExp(regex2).toAutomaton();
   return automaton1.intersection(automaton2).isEmpty();
} 
```

应该注意的是，该实现不支持也不能支持复杂的 RegEx 功能，如反向引用。请参阅介绍[dk.brics.automaton](http://www.brics.dk/automaton/)的博客文章[“A Faster Java Regex Package”](http://weblogs.java.net/blog/tomwhite/archive/2006/03/a_faster_java_r.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T20:17:33.173

您也许可以使用[Regexp::Genex](http://search.cpan.org/~bowmanbs/Regexp-Genex-0.07/lib/Regexp/Genex.pm)之类的东西来生成测试字符串以匹配指定的正则表达式，然后在第二个正则表达式上使用测试字符串来确定这两个正则表达式是否正交。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-28T20:23:14.020

在某些情况下，证明一个正则表达式与另一个正则表达式正交可能是微不足道的，例如相同位置的互斥字符组。对于除了最简单的正则表达式之外的任何其他表达式，这都是一个不平凡的问题。对于带有组和反向引用的严肃表达，我什至会说这可能是不可能的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-28T20:44:29.373

我相信[kdgregory](https://stackoverflow.com/questions/489095/how-to-determine-if-a-regex-is-orthogonal-to-another-regex#489191)是正确的，您使用 Orthogonal 来表示[Complement](http://en.wikipedia.org/wiki/Complement_(set_theory))。

它是否正确？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-28T20:46:50.087

首先让我说我不知道​​如何构建这样的算法，我也不知道有任何实现它的库。但是，得知任意复杂性的一般正则表达式不存在这样的情况，我一点也不感到惊讶。

每个正则表达式都定义了可以由表达式生成的所有字符串的正则语言，或者如果您愿意，可以定义正则表达式“匹配”的所有字符串。将语言视为一组字符串。在大多数情况下，该集合将无限大。您的问题询问正则表达式给出的两组的交集是否为空。

至少在第一个近似值上，我无法想象在不计算集合的情况下回答这个问题的方法，对于无限集合来说，这需要比你更长的时间。我认为可能有一种方法可以计算有限的集合并确定何时对模式进行了超出其他正则表达式的要求，但这并不简单。

例如，只需考虑简单的表达式`(ab)*`和`(aba)*b`。什么算法会决定`abab`从第一个表达式生成然后停止，而不检查`ababab`,`abababab`等，因为它们永远不会工作？您不能只生成字符串并检查直到找到匹配项，因为当语言不相交时，这永远不会完成。我无法想象在一般情况下会有什么效果，但是在这种事情上有些人比我好得多。

总而言之，这是一个难题。得知有多项式时间解决方案我会有点惊讶，而得知它等同于停止问题我一点也不惊讶。虽然，鉴于正则表达式不是图灵完备的，但似乎至少有可能存在解决方案。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-28T20:56:46.183

我会做以下事情：

*   使用如下结构将每个正则表达式转换为 FSA：

    ```
    struct FSANode
    {
        bool accept;
        Map<char, FSANode> links;
    }
    List<FSANode> nodes;
    FSANode start; 
    ```

请注意，这不是微不足道的，但对于简单的正则表达式来说应该不是那么困难。

*   创建一个新的组合节点，如：

    ```
    class CombinedNode
    {
        CombinedNode(FSANode left, FSANode right)
        {
            this.left = left;
            this.right = right;
        }

        Map<char, CombinedNode> links;
        bool valid { get { return !left.accept || !right.accept; } }

        public FSANode left;
        public FSANode right;
    } 
    ```

根据左侧和右侧的相同字符构建链接，您将获得两个 FSANode，它们构成一个新的 CombinedNode。

然后从CombinedNode(leftStart, rightStart)开始，找到spanning set，如果有无效的CombinedNode，则该set不是“正交的”。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-01T17:21:24.457

将每个正则表达式转换为 DFA。从一个 DFA 的接受状态创建一个到第二个 DFA 的开始状态的 epsilon 转换。通过添加 epsilon 转换，您实际上已经创建了 NFA。然后将 NFA 转换为 DFA。如果起始状态不是接受状态，并且接受状态是可达的，那么这两个正则表达式不是“正交的”。（因为它们的交叉点是非空的。）

有将正则表达式转换为 DFA 以及将 NFA 转换为 DFA 的已知过程。您可以查看 Sipser 的“计算理论导论”之类的书来了解这些过程，或者只是在网上搜索。毫无疑问，许多本科生和研究生必须为一个或另一个“理论”课这样做。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-01T17:51:02.417

我说得太早了。我在原始帖子中所说的内容不会奏效，但是如果您可以将正则表达式转换为 DFA 形式，那么您可以尝试执行此操作。

您可以在我在第一篇文章中提到的书中找到该过程：Sipser 的“计算理论导论”第 2 版。它在第 46 页，脚注中有详细信息。

该过程将为您提供一个新的 DFA，它是两个 DFA 的交集。如果新的 DFA 具有可到达的接受状态，则交集是非空的。

# usability - 显示非规范化数据的可用性解决方案

> ID：489096
> 
> 赞同：3
> 
> 时间：2009-01-28T20:03:12.703
> 
> 标签：usability, user-experience, hci

我有一个典型的阻抗不匹配，其中数据以标准化方式存储：

```
客户 | 年份 | 价值
--------------------------
富 2007 9000000
富 2008 10000000
酒吧 2008 20000000
富 2009 12000000
酒吧 2009 15000000

```

但是用户以非规范化的方式消费、可视化和理解它：

```
客户 | 2007年价值| 2008年价值| 2009年价值
---------------------------------------------
富 9000000 10000000 12000000
酒吧 - 20000000 15000000

```

这一切都很好——我有各种解决方案可以在渲染和持久性之间旋转和取消旋转数据。然而，在现实世界的情况下，非规范化渲染有几十列，这变得难以使用并且让人难以理解。

请记住，用户目前以非规范化的方式探索数据，并且我不想弄乱他们的思维导图来尝试改变这一点，有哪些策略可以更好地呈现宽表格数据？我知道这不是一个新问题，但我不知道在哪里寻找好的见解。

我不是在寻找特定于任何一种演示环境的答案。无论是在 Web 浏览器还是电子表格中，掌握广泛的数据表示只是一项心理上的困难任务，我正在寻找一般策略或表示转变——或指向资源的指针——来减轻这种困难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T20:37:57.720

一张照片可以走很长的路。数据图表可以为人们提供他们通常正在寻找的东西——模式和异常。对于非规范化数据表，我建议在显示所有值的每一行上添加一个火花图。通过这种方式，向下查看列表可以看到不同的值是如何变化的。

以下是人们在数据中使用内联图表来提供硬数字可视化的一些示例：http:
[//s.wsj.net/public/resources/images/P1-AL682_OILFIE_20080521185242.gif](http://s.wsj.net/public/resources/images/P1-AL682_OILFIE_20080521185242.gif)
[http://mjsbigblog.com/wp-内容/上传/2008/02/billboardupdate020908.png](http://mjsbigblog.com/wp-content/uploads/2008/02/billboardupdate020908.png)
[http://www.economist.com/images/20041009/CUS756.gif](http://www.economist.com/images/20041009/CUS756.gif)

Edward Tufte 有一些关于数据可视化的特殊指南，请在他的维基百科页面上[查看华尔街股票示例的迷你图。](http://en.wikipedia.org/wiki/Edward_Tufte)

# javascript - 使用 OpenLaszlo / javascript 从秒有效地计算 MM:ss 格式显示的分钟和秒？

> ID：489105
> 
> 赞同：2
> 
> 时间：2009-01-28T20:08:01.740
> 
> 标签：javascript, openlaszlo

我目前正在使用以下基于网络示例的函数，它每秒调用一次以通过视频流显示当前进度。

我可以做些什么来提高效率吗？

```
function secondstominutes(secs){

var s;
if(secs > 60){
  var min = Math.floor(secs / 60);
  s = min < 10 ? "0" : "";
  s += min +":";
  secs = secs - min * 60;
} else {
  s = "00:";
}

if(secs < 10){
  s+= "0" + Math.floor(secs);
} else {
  s += Math.floor(secs);
}
return s;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T20:21:18.250

```
function secondstominutes(secs)
{
   var mins = Math.floor(secs / 60);
   secs = secs % 60;

   return (mins < 10 ? "0" + mins : mins) 
          + ":"
          + (secs < 10 ? "0" + secs : secs);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T20:19:41.017

是的，它可以更简单一些，并且使用更少的 Math.floor、局部变量等。这是我的提议：

```
function secondstominutes(secs)
{
   return (Math.floor(secs/60))+":"+secs%60;
} 
```

这将给出如下结果：

0:1 1 秒 0:10 10 秒 1:1 61 秒

等等

如果你想要空格等，可以这样做：

```
function formatZero(number)
{
   return (number>9) ? number : "0"+number;
}

function secondstominutes(secs)
{
   return formatZero((Math.floor(secs/60)))+":"+formatZero(secs%60);
} 
```

而这个是用于强迫性的单线功能 ppls ;)

```
function secondstominutes(secs)
{
   return ((arguments[1]=(Math.floor(secs/60)))<10?"0":"")+arguments[1]+":"+((arguments[2]=secs%60)<10?"0":"") + arguments[2];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T22:39:58.267

[bobwienholt](https://stackoverflow.com/users/24257/)的版本紧凑、快速、清晰，与我实现它的方式非常相似。为了好玩，我对一些不同的解决方案进行了一些分析，我发现这有点快，但是它不是很清楚，并且在语句中做了一个半隐藏的赋值：

```
function secondstominutes(secs)
{
    var m = (secs / 60) | 0;

   return (m < 10 ? "0" + m : m) 
          + ":"
          + ( ( secs %= 60 ) < 10 ? "0" + secs : secs);
} 
```

解释：

```
var m = (secs / 60) | 0; 
```

将秒除以 60 并将结果与​​ 0 进行二进制“或”。二进制“或”将值转换为整数，并通过与 0 进行或运算，返回结果的整数部分而无需修改。这比调用*Math.floor()*更快，但不太清楚。由于它被转换为整数，因此您将任何电影的长度限制为 2147483647 分钟 ≈ 35791394 小时 ≈ 1491308 天 ≈ 4085 年。

```
( secs %= 60 ) 
```

这是做*(secs = secs % 60)*的简写形式。它将*secs*的值除以 60 并分配*secs*提醒（例如 61 % 60 = 1）。通过分析，我发现将计算放在 return 语句中而不是放在一行中要快一些。

```
(m < 10 ? "0" + m : m) 
```

这将计算第一条语句*m < 10*，如果为真，则执行第二条语句*"0" + m*否则执行第三条：*m*。英文：如果*m*小于 10，则在开头添加一个零，否则按原样返回该值。

# python - 给定一个 rpm 包名称，查询 yum 数据库以获取更新

> ID：489113
> 
> 赞同：6
> 
> 时间：2009-01-28T20:12:07.130
> 
> 标签：python, rpm, yum

我想用一个 3 行 Python 脚本来执行此操作，但 yum Python API 是难以理解的。这甚至可能吗？

为“yum list package-name”编写一个包装器是唯一的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T02:36:40.443

[http://fpaste.org/paste/2453](http://fpaste.org/paste/2453)

这里有很多 yum api 的例子和一些入门指南：

[http://yum.baseurl.org/#DeveloperDocumentationExamples](http://yum.baseurl.org/#DeveloperDocumentationExamples)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T03:41:55.133

正如 Seth 所指出的，您可以使用更新 API 来询问是否有可用的更新。对于接近“yum 列表”的内容，您可能想要使用 doPackageLists()。例如。

```
import os, sys
import yum

yb = yum.YumBase()
yb.conf.cache = os.geteuid() != 1
pl = yb.doPackageLists(patterns=sys.argv[1:])
if pl.installed:
    print "Installed Packages"
    for pkg in sorted(pl.installed):
        print pkg
if pl.available:
    print "Available Packages"
    for pkg in sorted(pl.available):
        print pkg, pkg.repo
if pl.reinstall_available:
    print "Re-install Available Packages"
    for pkg in sorted(pl.reinstall_available):
        print pkg, pkg.repo 
```

# sql - 如何在 MySQL 中对两个结果集中的列求和

> ID：489116
> 
> 赞同：0
> 
> 时间：2009-01-28T20:12:38.940
> 
> 标签：sql, mysql, database

我有下表：

评分：

```
ID | post_id | rating_type 
```

rating_type 字段为“thumb-up”或“thumb-down”。我想得到一个结果集，告诉我评价最高的帖子是什么。以下查询为我提供了一个结果集，其中包含每个唯一 post_id 的赞成票数。

```
SELECT COUNT(post_id) as number_up, post_id FROM wp_sp_post_ratings WHERE rating_type = 'thumb-up' GROUP BY post_id 
```

这太棒了！对于拇指向下的评分类型，我可以做类似的事情。但是，我需要的是获得总评分，其中每个竖起大拇指给一个帖子一分，每个大拇指向下给一个帖子一个负分。然后，我需要按总评分排序。所以，假设我们有以下内容：

帖子 1 有 3 票赞成和 2 票反对 帖子 2 有 14 票赞成和 33 票反对 帖子 3 有 4 票赞成和 0 票反对

我希望看到如下结果集：

```
post_id | total_rating
3 | 4
1 | 1
2 | -19 
```

我不知道该怎么做。我已经在文档和谷歌上猛烈抨击了大约 2 个小时，所以我希望 SO 可以成为我的救星。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T20:19:21.563

```
SELECT SUM(CASE WHEN rating_type = 'up' THEN 1 WHEN rating_type = 'down' THEN -1 END CASE)
FROM posts
GROUP BY post_id 
```

PS 最好将赞成票和反对票保留为数字（+1 和 -1）而不是字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T20:22:29.700

最初，为什么不直接将竖起大拇指存储为 1 并将大拇指向下存储为 -1 呢？Quassnoi 的案例陈述更快......

# unit-testing - 为什么 Microsoft.VisualStudio.TestTools.UnitTesting.Assert.Equals() 存在？

> ID：489117
> 
> 赞同：15
> 
> 时间：2009-01-28T20:12:44.633
> 
> 标签：unit-testing, mstest

MSDN 文档中 Assert.Equals() 的说明：请勿使用此方法。

就是这样，完整的解释。呃……好吧，但是……为什么会在那里？它是早期版本的框架中已弃用的方法吗？应该只由其他 Microsoft 程序集使用的东西？

它只是让我更想使用它，知道我不应该这样做。;-)

有人知道吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-28T20:16:16.310

.Equals 继承自对象。它被列为“请勿使用此方法”，因此用户不会将其与 AreEqual 方法混淆。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T20:17:17.980

.NET 中的所有对象都派生自[Object](http://msdn.microsoft.com/en-us/library/system.object_members(VS.80).aspx)。

对象有一个 .Equals() 方法。

显然，此特定对象的 .Equals() 方法没有做任何有用的事情，因此文档警告您它没有做任何有用的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T06:45:58.970

它在 2008 年（可能是 SP1）被更改为在调用时未通过测试，因此意外使用它的人被告知他们**真的**不应该使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-30T12:13:32.920

`Assert.Equals`，就像它的基础类方法一样`Object.Equals`，对于比较对象非常有用。但是，这两种方法都不适用于独立检测和报告或单元测试中的错误，因为`Object.Equals`如果值不相等，则返回布尔值而不是抛出。如果在单元测试中这样使用，这是一个问题：

```
Assert.Equals(42, ComputeMeaningOfLife()); 
```

除了这个单元测试可能运行太久的问题:-)，即使 Compute 方法提供了错误的结果，这个测试也会默默地成功。正确使用的方法是`Assert.AreEqual`，它不返回任何内容，但如果参数不相等则抛出异常。

`Assert.Equals`已添加，因此上面示例中的代码不会退回到`Object.Equals`单元测试并默默地中性化单元测试。相反，当从单元测试中调用时，`Assert.Equals`总是会抛出一个异常，提醒您不要使用它。

# mysql - MySQL - 错误 1045 - 访问被拒绝

> ID：489119
> 
> 赞同：50
> 
> 时间：2009-01-28T20:12:52.403
> 
> 标签：mysql, linux, passwords, mysql-error-1045

以某种方式，当我尝试通过命令行访问 MySQL 时，我设法得到了这个错误：

```
[root@localhost ~]# mysql -u root -p
Enter password:
ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES) 
```

我曾尝试使用此 HowTo 重置密码，但没有任何运气。

我已经完全卸载了 mysql 并重新安装，但我仍然被要求输入密码。我不知道为什么会这样！

有人可以帮我获得 MySQL 的默认安装。

## 环境

Fedora Core 10，完全根访问，Apache 和 PHP 已安装

感谢您的任何帮助！！

## 编辑

对于所有想为自己节省几个小时“咳血”的人——当你卸载 MySQl 时，会完全删除所有遗留下来的东西。如果您不这样做，它将永远不会是全新安装。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-01-28T21:39:13.477

如果您确实设置了 root 密码并且您刚刚丢失/忘记了它：

1.  停止 MySQL
2.  使用 skip-grant-tables 选项手动重新启动它：`mysqld_safe --skip-grant-tables`

3.  现在，打开一个新的终端窗口并运行 MySQL 客户端：`mysql -u root`

4.  使用此 MySQL 命令手动重置 root 密码：`UPDATE mysql.user SET Password=PASSWORD('password') WHERE User='root';` 如果您使用的是 MySQL 5.7（在终端中使用 mysql --version 检查），则命令为：

    ```
    UPDATE mysql.user SET authentication_string=PASSWORD('password')  WHERE  User='root'; 
    ```

5.  使用此 MySQL 命令刷新权限：`FLUSH PRIVILEGES;`

来自[http://www.tech-faq.com/reset-mysql-password.shtml](http://www.tech-faq.com/reset-mysql-password.shtml)

（也许这不是你所需要的，Abs，但我认为它可能对将来遇到这个问题的人有用）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-28T20:15:42.193

尝试不使用任何密码进行连接：

```
mysql -u root 
```

我相信最初的默认设置是没有 root 帐户的密码（显然应该尽快更改）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-20T11:19:29.157

使用此命令检查可能的输出

```
mysql> select user,host,password from mysql.user; 
```

输出

```
mysql> select user,host,password from mysql.user;
+-------+-----------------------+-------------------------------------------+
| user  | host                  | password                                  |
+-------+-----------------------+-------------------------------------------+
| root  | localhost             | *8232A1298A49F710DBEE0B330C42EEC825D4190A |
| root  | localhost.localdomain | *8232A1298A49F710DBEE0B330C42EEC825D4190A |
| root  | 127.0.0.1             | *8232A1298A49F710DBEE0B330C42EEC825D4190A |
| admin | localhost             | *2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19 |
| admin | %                     |                                           |
+-------+-----------------------+-------------------------------------------+
5 rows in set (0.00 sec) 
```

1.  在此用户中，尽管您已授予权限，但不允许管理员从其他主机登录。原因是用户 admin 没有被任何密码识别。
2.  再次使用 GRANT 命令授予用户 admin 密码

    ```
    mysql> GRANT ALL PRIVILEGES ON *.* TO 'admin'@'%' IDENTIFIED by 'password' 
    ```

然后检查 GRANT LIST 输出会像他的

```
mysql> select user,host,password from mysql.user;

+-------+-----------------------+-------------------------------------------+
| user  | host                  | password                                  |
+-------+-----------------------+-------------------------------------------+
| root  | localhost             | *8232A1298A49F710DBEE0B330C42EEC825D4190A |
| root  | localhost.localdomain | *8232A1298A49F710DBEE0B330C42EEC825D4190A |
| root  | 127.0.0.1             | *8232A1298A49F710DBEE0B330C42EEC825D4190A |
| admin | localhost             | *2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19 |
| admin | %                     | *2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19 |
+-------+-----------------------+-------------------------------------------+
5 rows in set (0.00 sec) 
```

如果需要允许所需用户（例如用户“admin”）登录，则使用一次 GRANT 命令并执行该命令。

现在应该允许用户登录。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-02T02:41:01.827

当前的 root 密码必须为空。然后在“新的root密码”下输入您的密码并确认。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-23T18:52:49.353

我有同样的错误，但这是因为`password_expired`设置为`Y`. [您可以按照与当前接受的答案](https://stackoverflow.com/a/489502/1237044)相同的方法解决该问题，但改为执行 MySQL 查询：

```
UPDATE mysql.user SET password_expired = 'N' WHERE User='root'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-25T17:12:45.233

1.  转到mysql控制台
2.  输入使用mysql；
3.  UPDATE mysql.user SET Password= PASSWORD ('') WHERE User='root' FLUSH PRIVILEGES; 退出密码 ('') 必须为空
4.  然后去 wamp/apps/phpmyadmin../config.inc.php
5.  查找 $cfg ['Servers']['$I']['password']='root';
6.  将 ['password'] 替换为 ['your old password']
7.  保存文件
8.  重新启动所有服务并转到 localhost/phpmyadmin

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-05T20:38:47.633

我无法连接到 MySql 管理员。我通过创建另一个用户并分配所有权限来修复它。

我用那个新用户登录，它工作。

# windows - 获取用户的电子邮件地址？

> ID：489121
> 
> 赞同：15
> 
> 时间：2009-01-28T20:13:25.567
> 
> 标签：windows, email

有没有办法通过 Win32 或 .NET 从 Windows 中获取用户的电子邮件地址？是否有包含此信息的注册表项或 API？

编辑：我有一个应用程序，如果我们的应用程序失败，我会向我的公司发送电子邮件，并且我想获得一个返回电子邮件地址，以便我们可以回复经历崩溃的那个人。我目前正在获取用户名，但这可能与电子邮件名称不匹配。显然我可以让用户输入他的电子邮件地址，但是如果我至少可以尝试获取电子邮件地址并让用户验证返回的电子邮件地址是否正确，那么界面会更友好一些。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T21:44:27.227

我认为这有意义的唯一方法是在 Windows Active Directory 环境中。在这种情况下，您可以查询 AD 并查看是否有与用户帐户关联的电子邮件地址。这肯定适用于 MS Exchange，也可能适用于其他企业电子邮件系统。对于 .Net，您可以使用[System.DirectoryServices](http://msdn.microsoft.com/en-us/library/system.directoryservices.aspx)命名空间中的类。对于 Win32，您可以使用[ADSI](http://msdn.microsoft.com/en-us/library/aa772218(VS.85).aspx) API。您必须阅读 AD 并创建合适的查询以满足您的要求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T20:17:29.583

您是否将您的电子邮件地址保存在系统的某个位置？没有标准的地方可以寻找。我总是依赖于用户使用的应用程序（Outlook、Outlook Express、TuhunderBird）。

获取用户电子邮件地址的最佳方法是询问他。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T20:17:31.427

让我回答你这个问题：你在安装 Windows 时输入过你的电子邮件地址吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-08-28T18:14:01.253

您可以尝试将枚举中的`NameUserPrincipal`常量与函数一起使用。 [`EXTENDED_NAME_FORMAT`](http://msdn.microsoft.com/en-us/library/ms724268%28v=vs.85%29.aspx)[`GetUserNameEx`](http://msdn.microsoft.com/en-us/library/ms724435%28v=vs.85%29.aspx)

> NameUserPrincipal 用户主体名称（例如，someone@example.com）。

但我只建议在提示用户时将其用作预填地址。

如果信息不可用`GetLastError`，它很有可能会失败。`ERROR_NONE_MAPPED`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T20:20:28.660

我认为简单的答案是否定的……当然，电子邮件地址将存储在他们的电子邮件程序中，例如 Outlook。

你想达到什么目的？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-08-19T12:36:58.743

Windows 将使用过的电子邮件帐户存储在“ `UserExtendedProperties`”键中

```
HKEY_CURRENT_USER\Software\Microsoft\IdentityCRL 
```

因此，您可以使用以下代码获取电子邮件帐户：

```
#include <windows.h>
#include <stdio.h>
#include <tchar.h>

#define MAX_KEY_LENGTH 255
#define MAX_VALUE_NAME 16383

void GetDefaultEmailAddress()
{
    HKEY key;
    TCHAR    achKey[MAX_KEY_LENGTH];   // buffer for subkey name
    DWORD    cbName;                   // size of name string 
    TCHAR    achClass[MAX_PATH] = TEXT("");  // buffer for class name 
    DWORD    cchClassName = MAX_PATH;  // size of class string 
    DWORD    cSubKeys = 0;               // number of subkeys 
    DWORD    cbMaxSubKey;              // longest subkey size 
    DWORD    cchMaxClass;              // longest class string 
    DWORD    cValues;              // number of values for key 
    DWORD    cchMaxValue;          // longest value name 
    DWORD    cbMaxValueData;       // longest value data 
    DWORD    cbSecurityDescriptor; // size of security descriptor 
    FILETIME ftLastWriteTime;      // last write time 

    DWORD i, retCode;

    TCHAR  achValue[MAX_VALUE_NAME];
    DWORD cchValue = MAX_VALUE_NAME;

    if (RegOpenKeyEx(HKEY_CURRENT_USER, L"Software\\Microsoft\\IdentityCRL\\UserExtendedProperties", NULL, KEY_READ, &key) == ERROR_SUCCESS)
    {
        // Get the class name and the value count. 
        retCode = RegQueryInfoKey(
            key,                    // key handle 
            achClass,                // buffer for class name 
            &cchClassName,           // size of class string 
            NULL,                    // reserved 
            &cSubKeys,               // number of subkeys 
            &cbMaxSubKey,            // longest subkey size 
            &cchMaxClass,            // longest class string 
            &cValues,                // number of values for this key 
            &cchMaxValue,            // longest value name 
            &cbMaxValueData,         // longest value data 
            &cbSecurityDescriptor,   // security descriptor 
            &ftLastWriteTime);       // last write time 

        // Enumerate the email accounts subkeys, until RegEnumKeyEx fails.

        if (cSubKeys)
        {
            wprintf(TEXT("\nNumber of email accounts used: %d\n"), cSubKeys);

            for (i = 0; i < cSubKeys; i++)
            {
                cbName = MAX_KEY_LENGTH;
                retCode = RegEnumKeyEx(key, i,
                    achKey,
                    &cbName,
                    NULL,
                    NULL,
                    NULL,
                    &ftLastWriteTime);
                if (retCode == ERROR_SUCCESS)
                {
                    wprintf(TEXT("(%d) %s\n"), i + 1, achKey);
                }
            }
        }
    }
} 
```

当涉及用于电子邮件的桌面应用程序（即 MAPI 客户端）时，为了枚举这些客户端而查找的位置`Software\Clients\Mail`是`HKEY_LOCAL_MACHINE. You will find there all installed [MAPI clients][1].`. 您还可以通过查看以下内容来确定默认值：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Clients\Mail\Default. 
```

另见：[文章和工具/源代码下载](https://www.codeproject.com/Articles/1257005/How-to-find-users-email-address)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T20:18:17.040

电子邮件地址可以用于 gmail 等基于 Web 的客户端，也可以是域电子邮件地址。无论哪种方式，实施都必须基于用户电子邮件设置的细节。所以简短的回答是“不”，至少没有“一刀切”的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T20:18:53.013

Windows 中可能存储了一些电子邮件地址，但要获取用户的实际电子邮件地址，您必须让他们输入，并确保在使用前向他们发送激活电子邮件以确保其握手。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-21T03:42:54.620

我知道这是一个老问题，但如果你像我一样来到这里，根据超级用户的这个答案

[https://superuser.com/questions/836220/get-email-address-of-current-logged-in-user](https://superuser.com/questions/836220/get-email-address-of-current-logged-in-user)

在 CMD 运行时`whoami /upn`

它为用户主体提供通常是默认电子邮件的

[https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/whoami](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/whoami)

# c++ - 矢量和倾倒

> ID：489123
> 
> 赞同：1
> 
> 时间：2009-01-28T20:15:16.797
> 
> 标签：c++, vector

据我所知，向量保证是连续的，我可以向它写入一大块内存并用它发送 fwrite。我需要做的就是确保我调用 .resize() 来强制它成为我需要的最小长度，然后我可以将它用作普通的 char 数组？这段代码是否正确

```
v.resize(numOfElements);
v.clear(); //so i wont get numOfElements + len when i push back
vector<char>v2;
v2.resize(numOfElements*SizeOfType);
while(...)
{
...
v.push_bacK(x); 
}
compress(&v2[0], len, &v[0], len);
fwrite(&v2[0], ....) 
```

请注意，我从不推回或弹出 v2，我只调整一次大小并将其用作 char 数组。这会安全吗？如果我也倾倒了 v 那也是安全的（我确实推回并清除，我可能会倾倒它进行测试）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T20:22:57.313

```
v.resize(numOfElements);
v.clear(); //so i wont get numOfElements + len when i push back 
```

好吧，上面的代码片段实际上是在分配和创建元素，只是为了再次销毁它们。它实际上与以下内容相同：

```
v.reserve(numOfElements); 
```

只是这段代码更快。因此，`v.size() == 0`在这两种情况下，`v.capacity()` *也可能与* `numOfElements`两种情况相同（尽管*不能保证*）。然而，在第二种情况下，容量*至少为 numOfElements*，这意味着内部缓冲区将不会被重新分配，直到您将这么多元素推送到向量中。请注意，在这两种情况下，如果您尝试访问任何元素都是*无效*的 - 因为实际上包含零个元素。

除此之外，我在您的代码中没有发现问题。它是安全的，我会鼓励它使用它而不是原始的`new`，或者`malloc`因为它提供了额外的安全性。但是，我不确定您所说的“转储 v”是什么意思。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T20:31:45.390

事实上，std::vector 保证是连续的，以便与 C 数组布局兼容。但是，您必须知道向量的许多操作会使指向其元素的所有指针无效，因此您最好坚持一种使用方式：避免在向量上混合指针算术和方法调用。

除此之外是完全正确的，除了第一行：你想要的是

```
v.reserve(numOfElements); 
```

这将分配足够的空间来存储`numOfElements`到向量中，而

```
v.resize(numOfElements); 
```

将执行以下操作：

```
// pseudo-code
if (v.size() < numOfElements)
    insert (numOfElements - size) elements default 
    constructed at the end of the vector

if (v.size() > numOfElements)
    erase the last elements so that size = numOfElements 
```

总而言之，在 a 之后，`reserve`您确定向量**容量**优于或等于 numOfElements，在 a 之后，`resize`您确定向量**大小**等于 numOfElements。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T21:08:27.657

对于这样的事情，我个人会使用像 STLSoft's 这样的类`auto_buffer<>`：

*   [http://www.synesis.com.au/software/stlsoft/doc-1.9/classstlsoft_1_1auto__buffer.html](http://www.synesis.com.au/software/stlsoft/doc-1.9/classstlsoft_1_1auto__buffer.html)

作为免责声明 - 我不使用实际的 STLSoft 库版本，我改编了自己的非常相似的模板 - 我从 Matthew Wilson（STLSoft 作者）的书[“不完美的 C++”](http://www.synesis.com.au/publishing/imperfect/cpp/)开始。

当我真的只想要一个普通的 C 数组时，我发现它很有用，但大小在运行时必须是动态的。`auto_buffer<>`比普通的旧数组更安全，但是一旦你构建了它，你就不用担心有多少元素 - 它总是你用什么来构建它，就像一个数组一样（所以它比`vector<>`- which有时是合适的）。

主要的缺点`auto_buffer<>`是它不是标准的并且不在 Boost 中，因此您必须将一些 STLSoft 合并到您的项目中或推出您自己的版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T20:42:08.677

是的，您使用 char 向量作为读取原始输入的缓冲区。

```
// dynamically allocates a buffer of 10,000 char as buffer
std::vector<char>   data(10000);

fread(&data[0], sizeof(char),data.size(),fp); 
```

不过，我不会使用它直接将任何非 POD 数据类型读入向量中。

您可能会使用向量作为写入源。
但我会非常小心你如何读回它（序列化它可能更容易）。

```
fwrite(&data[0], sizeof(char),data.size(),fp); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T20:42:38.723

你用resize替换reserve()，你也可以替换

```
vector<char> v2 
```

和

```
vector<Type> v2 
```

这应该会稍微简化代码。

坦率地说，这是我见过的最奇怪的向量用法，但它可能会起作用。您确定不想使用 new char[size] 和 boost 中的某种自动指针吗？

# sql-server - 为什么从 SQL Server 2000 升级到 2005 会导致查询速度变慢？

> ID：489137
> 
> 赞同：2
> 
> 时间：2009-01-28T20:18:51.923
> 
> 标签：sql-server, asp.net-1.1

将数据库从 SQL Server 2000 升级到 SQL Server 2005 会导致查询速度变慢的常见原因有哪些？这来自具有数百个表的 ASP.NET 1.1 应用程序，所有内容都已编入索引，并且似乎在旧版本上运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T20:25:06.840

您确定您的所有索引都在升级后幸存下来吗？硬件有什么区别吗？您是否使用 SQL Profiler 来确定哪些查询运行速度较慢以尝试追踪问题？

可能有很多事情。如果没有具体的查询示例和其他信息，我认为任何人都无法提供太多帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T20:27:06.337

升级后，您需要做的第一件事是使用全扫描更新统计信息并重建索引，否则您将获得次优计划

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T20:27:59.923

您可能希望通过查看最麻烦的查询的执行计划来重新评估您的索引。SQL 2005 查询优化器可能会提出完全不同的执行计划。

您还应该确保更新整个数据库的统计信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T20:36:52.743

一些东西...

1.  你用的是什么服务包？
2.  您是否应用了任何其他修补程序或 CU？
3.  升级过程中是否将 db 兼容级别从 80 更改为 90？

如果您使用服务器端游标，请注意从 SQL Server 2000 升级到 SQL Server 2005 后可能会出现一些性能问题。如果您遇到这种情况，有几个修补程序可能会有所帮助。只需搜索 SQL Server 2005 修补程序和服务器端光标。

除此之外，请务必在升级、重建索引和更新统计信息后检查数据库完整性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T21:35:23.347

我们刚刚从 2000 Ent SP4 升级到 2005 Std 64 位 SP2 后遇到了这个问题，它也是一个更强大的服务器（2 个 4 核，32GB RAM）

SELECT 查询在 2000 年花费了 2~3 秒，在 2005 年花费了 20 多分钟（但仍未完成）重新构建所有索引，sp_updatestats，结果相同。很奇怪，除了 NOLOCK 没有使用任何索引提示 虽然 2005 机器上的数据库仍然处于 8.0 兼容模式

在我们测试时恢复到另一个 2005 年的盒子

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T20:48:12.237

确保您正在运行的查询和存储过程没有使用任何索引提示。就像其他人提到的那样，优化器在 2000 年和 2005 年之间发生了变化，因此这些提示可能不再有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T20:49:59.677

此外，如果所有其他方法都失败了，则在 SP2 累积更新 6 中解决的 2005 优化器中存在一个错误（并且需要应用 2 个跟踪标志）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T21:06:48.283

你没有说你正在运行哪个版本。

但是，如果您刚刚从 2000 标准版或企业版转移到 2005 快捷版；Express 版仅使用一个处理器。我只是上周发生了这种情况；我的一个查询从本来就很慢的 1.5 秒变成了 55 秒！我运行了查询计划，唯一的区别是并行操作。无法相信速度差异。

# ruby - Ruby 1.8：Hash#sort 不返回散列而是返回数组（更好的方法？）

> ID：489139
> 
> 赞同：1
> 
> 时间：2009-01-28T20:18:53.637
> 
> 标签：ruby, hash, ruby-1.8

在 Ruby 1.8 的某些场景中。如果我有一个哈希

```
# k is name, v is order
foo = { "Jim" => 1, "bar" => 1, "joe" => 2}
sorted_by_values = foo.sort {|a, b| a[1] <==> b[1]}
#sorted_by_values is an array of array, it's no longer a hash!
sorted_by_values.keys.join ',' 
```

我的解决方法是`to_hash`为 Array 类制作方法。

```
class Array
  def to_hash(&block)
    Hash[*self.collect { |k, v|
      [k, v]
    }.flatten]
  end
end 
```

然后我可以执行以下操作：

```
sorted_by_values.to_hash.keys.join ',' 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T20:36:13.197

根据定义，哈希是无序的。不可能有排序哈希之类的东西。您最好的选择可能是使用 collect 从排序数组中提取键，然后对结果进行连接

```
sortedByValues = foo.sort {|a, b| a[1] <==> b[1]}
sortedByValues.collect { |a| a[0] }.join ',' 
```

# sql - 位域的 SQL 逻辑与运算符

> ID：489140
> 
> 赞同：0
> 
> 时间：2009-01-28T20:19:21.140
> 
> 标签：sql, bit-manipulation

我有 2 个具有多对多关系的表；一个个体可以属于许多组。一个组可以有许多个人。

个人基本上只有他们的主键 ID

组有一个主键 ID、IndividualID（与个人表中的 ID 相同）和一个位标志，用于表明该组是否是个人的主要组

理论上，组表中任何给定个体的所有条目（除一个条目外）都应将该位标志设置为 false，因为每个个体必须恰好有 1 个主组。

我知道对于我当前的数据集，这个假设不成立，并且我有一些个人将所有组的主要标志设置为 false。

我无法生成将这些人返回给我的查询。

我得到的最接近的是：

SELECT * FROM Individual i LEFT JOIN Group g ON g.IndividualID = i.ID WHERE g.IsPrimaryGroup = 0

但是比 SUM 或 MAX 更进一步是行不通的，因为该字段是位字段，而不是数字。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T20:25:20.397

不知道您的数据...但是.... LEFT JOIN 是 INNER JOIN

当您将 WHERE 更改为 AND 时会发生什么

```
SELECT * FROM Individual i 
LEFT JOIN Group g ON g.IndividualID = i.ID 
AND g.IsPrimaryGroup = 0 
```

在这里尝试运行这个....当然未经测试，因为您没有提供任何充足的数据

```
SELECT SUM(convert(int,g.IsPrimaryGroup)), i.ID 
FROM Individual i 
LEFT JOIN [Group] g ON g.IndividualID = i.ID 
AND g.IsPrimaryGroup = 0
GROUP BY i.ID
HAVING COUNT(*) > 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T20:35:30.907

如果您需要进行 SUM 和 MAX，请尝试不要使用位字段 - 改用 TINYINT。另外，据我所知，位字段不能被索引，所以你会在你的连接中失去一些性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T20:56:49.460

更新：让它与子选择一起使用。从主要组为假的组中选择个人ID，并且个人ID NOT IN（从主要组为真的组中选择个人ID）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T20:23:48.340

您需要将 IsPrimaryGroup 条件包含在 JOIN 子句中。此查询查找没有设置 PrimaryGroup 的所有个人：

```
SELECT * FROM Individual i
LEFT OUTER JOIN Group g ON g.IndividualID = i.ID AND g.IsPrimaryGroup = 1
WHERE g.ID IS NULL 
```

但是，解决问题的理想方法（就关系数据库而言）是在 Individual 表中拥有 PrimaryGroupID。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T20:58:33.433

```
SELECT COUNT(bitflag),individualId 
FROM Groups
WHERE bitflag = 1
GROUP BY individualId
ORDER BY SUM(bitFlag)
HAVING COUNT(bitFlag) <> 1 
```

这将为您提供每个人以及他们拥有多少个主要群体

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T21:00:28.033

我不知道从性能的角度来看这是否是最佳的，但我相信这些方面的东西应该可以工作。我使用 OrgIndividual 作为个人和集团之间的解析表的名称。

SELECT DISTINCT(i.IndividualID)
FROM
  Individual i INNER JOIN OrgIndividual oi
    ON i.IndividualID = oi.IndividualID AND oi.PrimaryOrg = 0
  LEFT JOIN OrgIndividual oip
    ON oi.IndividualID = oip.IndividualID AND oi.PrimaryOrg = 1
WHERE
  oi2.IndividualID一片空白

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T21:25:01.133

```
SELECT IndividualID
FROM Group g
WHERE NOT EXISTS (
    SELECT NULL FROM Group
    WHERE PrimaryOrg = 1
    AND IndividualID = g.IndividualID)
GROUP BY IndividualID 
```

# javascript - 上下文无关的 JavaScript 测试框架

> ID：489150
> 
> 赞同：11
> 
> 时间：2009-01-28T20:21:43.943
> 
> 标签：javascript, unit-testing, testing, frameworks

我正在寻找一个可以在任何上下文中轻松使用的 JavaScript 测试框架，无论是浏览器、控制台、XUL 等。

是否有这样的框架，或者有一种方法可以轻松地改造现有框架，使其与上下文无关？

编辑：测试框架不应**绑定**到任何其他框架，例如 jQuery 或 Prototype.js，也不应依赖于存在的 DOM（或文档对象）。我正在寻找测试**纯 JavaScript**的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T21:14:40.570

好的，这是我刚刚根据一些早期工作酿造的东西。我希望这能满足您的需求。

## [jsUnity](http://jsunity.com/)

轻量级通用 JavaScript 测试框架

> **jsUnity**是一个与上下文无关的轻量级通用 JavaScript 测试框架。它不依赖于任何浏览器功能，因此可以在 HTML、ASP、WSH 或任何其他使用 JavaScript/JScript/ECMAScript 的上下文中运行。

## HTML 中的示例用法

```
<pre>
<script type="text/javascript" src="../jsunity.js"></script>
<script type="text/javascript">
function sampleTestSuite() {
    function setUp() {
        jsUnity.log("set up");
    }

    function tearDown() {
        jsUnity.log("tear down");
    }

    function testLessThan() {
        assertTrue(1 < 2);
    }

    function testPi() {
        assertEquals(Math.PI, 22 / 7);
    }
}

// optionally wire the log function to write to the context
jsUnity.log = function (s) { document.write(s + "</br>"); };
var results = jsUnity.run(sampleTestSuite);
// if result is not false,
// access results.total, results.passed, results.failed
</script>
</pre> 
```

上面的输出：

```
找到 2 个测试
设置
拆除
[通过] testLessThan
设置
拆除
[失败] testPi：实际值与预期不符：[预期] 3.141592653589793，[实际] 3.142857142857143
1 次测试通过
1 次测试失败

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-02T19:02:00.097

[茉莉花](http://pivotal.github.com/jasmine/)看起来很有趣。

根据开发人员的说法，之所以编写它是因为没有其他 JS 测试框架能够在单一产品中满足他们的所有需求，并且不需要 DOM、jQuery 或`window`对象之类的东西是明确的设计点之一。

我正在考虑将它与[env.js](http://www.envjs.com/)和 Rhino/SpiderMonkey/V8/等一起使用。为我的 Web 应用程序编写客户端测试，这些测试可以在与 Python 单元测试相同的所有情况下轻松运行。（`setup.py test`、BuildBot 等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T04:43:42.880

您可能想查看[YUI Test](http://developer.yahoo.com/yui/yuitest/)。如果没有 DOM，它应该可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T20:46:01.603

这些在启用 javascript 的地方运行。

[脚本式单元测试](http://wiki.github.com/madrobby/scriptaculous/unit-testing)

[QUnit](http://docs.jquery.com/QUnit)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T00:44:06.797

JsUnit[有](https://github.com/pivotal/jsunit)帮助吗？它被设计为在浏览器中运行，但看起来相对抽象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-22T12:41:32.980

还有[JSpec](http://visionmedia.github.com/jspec/)

> JSpec 是一个极小但非常强大的测试框架。利用自己的自定义语法和预处理器，JSpec 可以以其他 JavaScript 测试框架无法做到的方式运行。这包括许多有用的速记文字、非常直观/可读的语法，以及不污染核心对象原型。
> 
> JSpec 也可以通过多种方式运行，例如通过支持 Rhino 的终端，通过使用 DOM 或控制台格式化程序的浏览器，或者最后使用在后台运行浏览器的 Ruby JavaScript 测试框架，向终端报告.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-19T11:35:58.970

我刚刚[让 Hudson CI 运行 JasmineBDD](http://skaug.no/ingvald/2010/10/javascript-unit-testing.html)，至少对于纯 JavaScript 单元测试。

# asp.net-mvc - ASP.NET MVC 升级指南

> ID：489151
> 
> 赞同：2
> 
> 时间：2009-01-28T20:21:55.537
> 
> 标签：asp.net-mvc

我有一个使用最新测试版开发的小型 ASP.NET MVC 应用程序。

[什么是升级到昨天发布](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)的 RC 的易于遵循的分步指南？

我必须应用哪些关键更改才能使其在新版本中运行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T20:25:02.847

阅读[发行说明](http://go.microsoft.com/fwlink/?LinkID=137661&clcid=0x409)，那里列出了要遵循的步骤。

为方便起见，在此重复。

Beta 版和 RC 版之间没有太多变化。但是，您需要在安装 Beta 版本后对您的应用程序进行一些更改。当您尝试使用最新版本编译应用程序时，这些更改中的大部分都是显而易见的，因此我们没有列出所有可能的更改。以下列表描述了您必须进行的一些更改。

*   更新对以下程序集的引用以指向 RC 版本：
*   System.Web.Abstractions.dll
*   System.Web.Routing.dll
*   系统.Web.Mvc.d

ll 注意 如果您运行的是 ASP.NET 3.5 SP1，则只需更新 System.Web.Mvc 程序集引用。

默认情况下，这些程序集位于以下文件夹中：

%ProgramFiles%\Microsoft ASP.NET\ASP.NET MVC RC

*   进行这些更改后，编译您的应用程序并解决所有编译错误。大多数错误将是前面列出的重大更改之一的结果。
*   更新 Views 文件夹中的 Web.config 文件部分以匹配以下示例。（更改的元素以粗体显示。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T20:24:09.103

我认为[发行说明](http://go.microsoft.com/fwlink/?LinkID=137661&clcid=0x409)有一个相当好的指南。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T09:32:15.043

发行说明中没有提到一些问题。阅读本文了解更多信息：
[http ://forums.asp.net/t/1377139.aspx](http://forums.asp.net/t/1377139.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T07:16:28.980

您还确保将以下标记添加到您的 web.config 文件中：

```
<system.web.extensions/> 
```

我花了很多功夫才弄明白，因为它没有记录在案。

# java - Java/Groovy 中的电子表格解析器

> ID：489154
> 
> 赞同：4
> 
> 时间：2009-01-28T20:22:52.303
> 
> 标签：java, parsing, groovy, spreadsheet

您好我正在寻找在 Groovy 中解析电子表格（xls/ods）。我一直在为 Ruby 使用 Roo 库，并希望在 Groovy 中尝试相同的任务，因为 Java 已经安装在我使用的开发服务器上，我希望将服务器上的技术数量保持在一个简单的核心少数.

我知道 ods 格式是压缩的 XML，因此可以这样解析，但我想使用电子表格概念而不是 XML 概念来处理文件。

处理 xls 文件的能力并不重要，但可以让我不必将多个 xls 文件保存到 ods（因为这是为了解析来自客户端的数据）。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T20:29:41.137

我建议使用[Apache POI](http://poi.apache.org/)访问 .xls 文件。

我从未使用过 .ods 格式，因此没有关于该格式的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T20:39:30.757

还有[JExcelAPI](http://jexcelapi.sourceforge.net/)，它有一个漂亮、干净、简单的界面（大部分）。

虽然不能帮助您处理 ODS 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T12:41:01.370

看看“odftoolkit”怎么样？[http://odftoolkit.openoffice.org/](http://odftoolkit.openoffice.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T04:02:01.680

[Groovy in Action](http://www.manning.com/koenig/)有一章名为“Windows 上的 Groovy”，讨论了使用[Scriptom](http://groovy.codehaus.org/COM+Scripting)、Groovy/COM 桥（在幕后使用[JACOB](http://sourceforge.net/projects/jacob-project/)）来访问包括 Excel 在内的多个 Windows 应用程序。

正如 Amit 所指出的，对于 OpenOffice，您可以使用[ODF Toolkit 。](http://odftoolkit.openoffice.org/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T22:01:20.093

我[支持 jdmichal](https://stackoverflow.com/questions/489154/spreadsheet-parser-in-java-groovy#489187)对[Apache POI](http://poi.apache.org)的投票。我已选择它作为我们选择处理 Excel 文件输入 (.XLS) 的库。如果您决定要支持该项目，该项目也正在研究 .XLSX 文件格式。根据您的规范，我认为您不想将内容转换为 CSV，而且您似乎已经建立了输入和输出路径。对于没有乐于处理 CSV 到 Excel 转换的任何人来说，它可能会有点冒险。我花了几个小时处理 Excel 将字符串数据转换为数字数据所产生的问题。[您可以在POI 案例研究页面](http://poi.apache.org/casestudies.html)上查看有关此效果的其他证词. 除了这些问题，我根本不想亲自处理这些输入。我宁愿投入编程工作并简化未来的工作流程。

我也没有处理过 ODF，也没有计划在我当前的项目中支持它。您可能想查看[OpenOffice.org ODF Toolkit Project](http://odftoolkit.org)。

祝你好运，玩得开心，-D。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-13T00:09:40.763

我建议您看一下[SimpleXlsBuilder 和 SimpleXlsSlurper](http://github.com/yellowsnow/GroovyUtils/tree/master/xls/)，它们都基于 apache POI，并且可以以简洁的方式满足您读取和写入 Excel 97 电子表格的基本需求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T20:57:37.740

如果您的电子表格足够简单 - 没有图表和其他嵌入内容 - 您应该简单地将电子表格转换为[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)。

优点：

*   xls 和 ods 都将生成相同的 CSV - 您只需处理一种输入类型。
*   您不必弄乱（开放）Office 的新版本。
*   处理纯文本总是比其他晦涩的格式更有趣。

缺点：

*   我能想到的一个 - 找到一个从 xls 和 odf 到 csv 的可靠转换器。不应该太难 - OpenOffice 有一个内置的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T21:25:46.983

几件事：

1) 我同意使用 CSV 格式可以简化一些开发工作。[OpenCSV](http://opencsv.sourceforge.net/)可以帮助处理 CSV 文件。还有其他很好的 Java CSV 解析器。请记住，由于 Groovy 与 Java 的无与伦比的集成，Groovy 可以使用任何可用于 Java 的东西。

2) 我知道您说过您想避免处理 XML，但是[Groovy 使 XML 处理变得](http://groovy.codehaus.org/Processing+XML)非常简单。

# asp.net - 如何最小化 ASP.NET 页面的重量？

> ID：489159
> 
> 赞同：5
> 
> 时间：2009-01-28T20:23:55.470
> 
> 标签：asp.net, optimization, seo

我严重依赖 Web 门户中的嵌套母版页，这会导致 ASP.NET 为其创建的控件生成巨大的 ID 标签，例如：“ctl00_ctl00_MainBody_ctl00_lblDescription”

对于我创建的 lblDescription 标签。

有什么办法可以减少这种混乱吗？

除了删除视图状态之外，还有什么其他技术（抱歉是笼统的）来减少页面重量？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-28T20:32:58.023

*   看看[Yslow](http://developer.yahoo.com/yslow/)并按照它告诉你的去做（我会从这里开始）
*   关闭视图状态
*   使用[jsmin](http://www.crockford.com/javascript/jsmin.html)减小 JavaScript 文件的大小
*   [减小 CSS 的大小](http://dimebrain.com/2008/03/a-better-css-mi.html) ^(（死链接）)
*   使用标准 gzip/deflate 压缩来[压缩您的响应](http://terrapinstation.wordpress.com/2008/06/12/aspnet-http-comression-and-reducing-response-size/)
*   使用[ASP.NET MVC](http://www.asp.net/mvc/)将为您提供更小的 ID

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T20:27:40.080

尽可能使用 HTML 控件。HTML 控件。`runat="server"`它们更轻，因为除非您指定属性，否则它们没有服务器端对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T20:32:17.980

我不知道如何删除客户端 ID 膨胀，但一些使您的页面更小的一般提示是：

*   将任何 .js/ .css 压缩并合并到一个文件中。
*   在页面顶部包含 css，在底部包含 js（实际上不会让它变小，但 UI 会加载得更快）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T20:32:39.257

在您使用标签的情况下，请确保您确实需要使用标签（它会在标签中生成文本`<span>`。您可以使用 a`Literal`代替。

`EnableViewState="False"`在不需要的控件上设置（或在整个页面/网站上）

如果您尝试更改由 ASP.NET 生成的晦涩的 id，那么您无能为力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T20:45:05.817

*   启用 IIS 静态/动态压缩
*   对控件和页面使用缓存
*   Ajax 内容加载 - 当您希望比优先级较低的内容更快地查看主要内容时，它会有所帮助

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T15:15:27.550

Terrapin 有一些很好的建议，但它们非常理想化。如果您正在寻找更适用于您当前情况的解决方案，请查看控制适配器。

[CSS 友好的](http://www.codeplex.com/cssfriendly)适配器将为您做很多工作，将您的 ASP.NET 控件从大型丑陋、长 id 命名的表转换为更简洁、名称更短的 div。

我过去曾使用过它们，它们确实可以产生巨大的影响。除此之外，在任何不需要它的控件上关闭视图状态。符合正确的 CSS/HTML，它将产生另一个显着的差异。

祝你好运！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T15:31:37.877

要最小化 ASP.NET 页面的权重，您还可以使用 SessionPageStatePersister 覆盖（Page 类的）PageStatePersister 属性。[请参见此处](http://blog.sb2.fr/post/2008/12/25/Storing-ViewState-On-Server-Instead-Of-Client-With-ASPNET.aspx)的示例。这样，Viewstate 将保存在服务器端的 Session 对象中，从而减小了客户端 html 页面的大小。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-09T22:29:28.817

尤其是在中继器、ListViews 和 GridViews 中，将您的控件命名为简短的名称。

这在上下文中应该是显而易见的（产品列表）

如果中继器中只有一个 HyperLink，则将其命名为**hl**。您不需要调用这些控件 HyperLinkProduct。

```
<asp:Repeater id="rptProducts" runat="server">
    <ItemTemplate>
       <asp:HyperLink id="hl" runat="server" NavigateUrl='<%# Eval("URL") %>'>
            <%# Eval("Name") %>
       </asp:HyperLink>
       <asp:Image id="img" runat="server" ImageUrl='<%# Eval("ImageUrl") %>' />
    </ItemTemplate>
</asp:Repeater> 
```

这将呈现如下内容：

```
<a id="ctl00_rptProducts_ctrl0_hl" href="/products.aspx?id=5">
  Product Name
</a>
<img id="ctl00_rptProducts_ctrl0_img" src="images/5.png"/> 
```

将这些 ID 名称乘以 100，如果您使用长描述性名称，您的 ID 开始占用更多空间。如果您的中继器名称良好，那么在中继器内部，短 ID 应该足够清晰。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-09T22:38:01.213

使用[CSS Sprites](http://www.google.com/search?hl=en&q=css+sprites)可以通过减少请求数量来加速您的页面。这是[我找到](http://www.websiteoptimization.com/speed/tweak/css-sprites/)[的几篇](http://css-tricks.com/css-sprites-what-they-are-why-theyre-cool-and-how-to-use-them/) [文章。](http://ajaxian.com/archives/css-spriting-without-background-image)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-28T20:32:27.167

我想如果你不顾一切地在不重新设计你的页面的情况下这样做（并且其他明智的想法都不起作用;）），你可以这样做：

编写一个 http 模块，在页面发送到客户端时动态解析和提取具有较短、可识别的唯一 id 的 id，并将它们存储在应用程序范围的哈希表中。然后，在回程中对传入数据执行相反的步骤。

至少，这是我会尝试的。我不确定它与某些 html 和/或 javascript 结构的播放效果如何，但我认为可以做到。我怀疑这样做会很痛苦，特别是如果较短的唯一 ID 碰巧与任何合法的非 ID 值发生冲突。

编辑：刚刚记得。你也需要处理 ViewState ......（这需要被解码、修复和重新编码。看起来很麻烦 :) 但是话又说回来，如果你要遇到那个麻烦，你可以通过覆盖加载/保存视图状态方法更好地压缩视图状态...几年前我使用该方法将一些大页面（200K 的 html）减少到大约 30K。事实上，在 ViewState 上使用自定义压缩通常足以显着减小页面大小。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-28T20:34:08.647

使用 html/css 设置页面样式，避免使用表格进行布局，在创建标签时指定 id，越短越好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-28T20:38:05.580

正如您所提到的，关闭视图状态很好。我还注意到 ASP.NET 树控件会生成大量 HTML（如果您有相当数量的节点）。我最终编写了自己的树控件，它生成标准树控件的 1/4 的 HTML。所以你可以寻找这样的控件，特别糟糕，然后编写你自己的控件。

# jquery - jQuery UI 是否缺少状态？

> ID：489164
> 
> 赞同：1
> 
> 时间：2009-01-28T20:24:39.210
> 
> 标签：jquery, jquery-ui, jquery-ui-plugins

jQuery UI 小部件似乎具有非活动、活动和悬停状态，但缺少抑郁（单击并按住）状态。这是疏忽吗？几乎每一个我能想到的现代 UI 都有一个沮丧的状态。有没有人添加这样的状态？如果是这样，您必须接触哪些代码？

* * *

编辑：我应该说的是悬停和点击状态看起来是一样的。应该有另一种状态，以便您可以看到您在悬停后单击了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T20:37:48.857

在 HTML/CSS 中，活动状态适用于“当用户激活元素时。例如，在用户按下鼠标按钮并释放它的时间之间”。（CSS 2.1 第[5.11.3 节](http://www.w3.org/TR/CSS21/selector.html#dynamic-pseudo-classes)）在按钮的情况下，这将是按下状态。

我只是假设这也适用于 jQuery UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T00:19:25.290

不要忘记在你的 CSS 中，你可以组合伪选择器：

```
a:link {
    color: blue;
}
a:hover {
    color: green;
}
a:visited {
    color: purple;
}
a:active {
    /* link is active */
    color: red;
}
a:visited:hover {
    /* hovering on a visited link */
    color: pink;
}
a:active:hover {
    /* hovering on an active link */
    color: black;
}
a:visited:active:hover {
    color: fuchsia;
} 
```

`a:active`和之间有一个明确的区别`a:active:hover`：一个链接可以通过使用键盘切换到它来激活。虽然它不是 100% 万无一失，但处于活动状态和悬停状态会表明用户已按下链接。改变边框样式会给你想要的效果。唯一的错误是如果链接变为活动状态，然后用户将鼠标悬停在它上面而不点击，它仍然会变得沮丧。

试试这个 CSS 看看我的意思：

```
a {
    padding: 5px 10px;
    background-color: gray;
    border-color: gray;
    border-style: outset;
}
a:active:hover {
    border-style: inset;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T21:11:35.277

看来是故意的。请注意，在 Themeroller 中有一个可点击的：活动状态设置区域，但它不像 css 活动状态。jQuery UI 1.7 包的快速 grep 显示没有 :active 的样式。看起来他们设计了 ui 状态来为其小部件提供视觉提示，将 :active 留给开发人员使用。

# java - 形成 JAXP 模式的错误 (javax.xml.validation.Schema)

> ID：489169
> 
> 赞同：0
> 
> 时间：2009-01-28T20:25:58.803
> 
> 标签：java, xml, validation, xsd

我们使用 JAXB 2.x 从一个庞大的模式系统（42 个 XSD 文件）生成数据对象。整个过程运行良好，没有问题。但他们弃用（并从实现中删除）整个 JAXB 验证框架，取而代之的是 JAXP 验证框架。（这些都位于`javax.xml.validation`包装中。）

我将所有文件按依赖顺序提供给`javax.xml.validation.SchemaFactory`，并验证它们的顺序正确。问题是一个文件正在生成关于不知道来自另一个文件中定义的命名空间的引用的错误。它基本上就像导入失败一样。（我不完全确定，因为根据 XML Schema 规范，导入失败不是错误。所以我无法验证导入是否失败；它不会产生警告或错误。这不会让你大吃一惊吗？）我知道这发生在哪个文件中，因为如果我注释掉一个引用，它就会停止抱怨。这是基本代码：

```
import javax.xml.transform.Source;

final java.util.ArrayList<Source> xsdSources =
    new java.util.ArrayList<Source>();
/* POPULATE THE LIST WITH ALL THE XSDS IN DEPENDENCY ORDER.
   THAT IS, FILES WITH NO DEPENDENCIES APPEAR IN LOWER INDEX.
   I USE javax.xml.transform.stream.StreamSource, GIVING IT
   STREAMS FROM java.util.jar.JarFile#getInputStream(JarEntry). */

final javax.xml.validation.SchemaFactory schemaFactory =
    javax.xml.validation.SchemaFactory.newInstance(
        javax.xml.XMLConstants.W3C_XML_SCHEMA_NS_URI);
schemaFactory.setErrorHandler(new SchemaErrorHandler());
return schemaFactory.newSchema(xsdSources.toArray(new Source[]{})); 
```

错误处理程序给出的唯一错误是那些指示未找到引用的错误。以下是相关文件的 XSD 依赖项列表：

```
xsds/import/foo/thing.xsd (<xsd:element name="thing">...</xsd:element>)
xsds/import/foo/otherthing.xsd (<xsd:include schemaLocation="thing.xsd"/>)
xsds/import/foo/all.xsd (<xsd:include schemaLocation="otherthing.xsd"/>)
xsds/mystuff/main.xsd (<xsd:import namespace="foonamespace" schemaLocation="../import/foo/all.xsd/>) 
```

该`main.xsd`文件有这样的行，会引发关于未知引用的错误：

```
<xsd:element xmlns:foo="foonamespace" ref="foo:thing"/> 
```

错误和堆栈跟踪如下所示：

```
org.xml.sax.SAXParseException: src-resolve: Cannot resolve the name 'foo:thing' to a(n) 'element declaration' component.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:195)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(ErrorHandlerWrapper.java:131)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:384)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.reportSchemaErr(XSDHandler.java:2537)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.reportSchemaError(XSDHandler.java:2528)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.getGlobalDecl(XSDHandler.java:1472)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDElementTraverser.traverseLocal(XSDElementTraverser.java:160)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.traverseLocalElements(XSDHandler.java:2049)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.parseSchema(XSDHandler.java:582)
    at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaLoader.loadSchema(XMLSchemaLoader.java:552)
    at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaLoader.loadGrammar(XMLSchemaLoader.java:519)
    at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaLoader.loadGrammar(XMLSchemaLoader.java:485)
    at com.sun.org.apache.xerces.internal.jaxp.validation.XMLSchemaFactory.newSchema(XMLSchemaFactory.java:210) 
```

`main.xsd`以几乎完全相同的方式对其他文件执行类似的操作，并且它们都可以正常工作。知道为什么这个特定的可能会出错吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T15:24:43.337

您从 java.util.jar.JarFile#getInputStream(JarEntry) 创建的源是否具有基本 URL，以便可以解析模式中的相对 URL，并且所有模式都在同一个 JAR 中？

你试过在文件系统上做吗？如果它在文件系统或分解的类路径中工作，请尝试参考我对另一个问题的[回答](https://stackoverflow.com/questions/764772/jax-ws-loading-wsdl-from-jar/863561#863561)，以获取有关如何使其在 JAR 内部工作的详细信息。

# c# - 发现接口依赖

> ID：489171
> 
> 赞同：4
> 
> 时间：2009-01-28T20:26:27.257
> 
> 标签：c#, interface, dependencies

我已经接管了一个非常大的（> 2M SLOC）软件项目的维护，所有这些都是用 C# 编写的。文档很少。我现在想要对具有公共接口（大约 400 个）的模块进行更改，但我不知道解决方案中的所有其他模块（总共大约 50 个）可能正在使用这个公共接口。

对于这种情况，您将如何创建接口依赖关系使用树？代码库太大，无法简单地浏览 Project Explorer 并阅读源代码。您使用了哪些工具或方法来创建这种类型的依赖关系分析树？

我不想购买任何工具。诸如 Class View 之类的 Visual Studio 工具似乎不能很好地处理这种规模的项目。我曾考虑编写自己的 sed/awk/perl-ish 脚本，该脚本简单地遍历源代码并使用模式匹配来构建我自己的依赖项/接口使用数据库，但如果有的话，我不想做一些艰难的事情一个简单的方法。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T20:30:24.147

您可能应该购买[NDepend 之](http://www.ndepend.com/)类的东西。

如果有另一个免费工具可以提供类似的价值，我会推荐它。但是，我真的相信 NDepend 是您最好的选择。有了这么大的代码库，400 美元的工具很快就能收回成本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T23:14:53.470

我认真地建议只找到一个现有的工具来做到这一点。您永远无法将整个事情手动整理好，使用工具节省的时间肯定会支付工具本身的成本。

一个同事遇到了这个问题——他的经理不会为分析器付费，所以他们花了 5 天的时间来优化程序的错误部分。使用分析器，他在半天之内发现并解决了问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T20:29:58.950

我知道您说过您不想购买工具，但[CodeRush](http://www.devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/)功能齐全且可免费使用一个月（之后只需 250 美元，您就可以获得 refactor pro！这太棒了）。它用一个非常漂亮的查找所有引用窗口替换了 Shift+F12。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T22:32:15.477

直接依赖的简单解决方案，右键单击界面并选择“查找所有引用”。您也可以在每个方法的基础上执行此操作。

要了解更改会导致多少代码**中断**，您可以将 [Obsolete(true,"Testing The change")] 添加到您计划更改的接口上的方法中并触发重建。这将导致某些部分无法构建。跳到这些部分并用 [Obsolete(false, "Limited Change")] 标记它们，如果你觉得这是对该类的一个小改动，并且你可以修复它而不会对这个类的消费者产生任何影响，如果你认为改为这个会对类的消费者造成重大问题，您可以将其标记为 [Obsolete(true, "Cascade")] 并处理*其*后果。

最终，您的解决方案将完全构建，否则您将遇到很多错误，以至于很明显，更改是如此具有侵入性，以至于真正掌握效果的唯一方法是开始真正尝试。

这种方法的好处是您可以进行级联而不需要实际处理*如何*处理它，只需您需要并粗略评估它是否会触发后续更改。一旦你很高兴你已经映射了更改，你就会在你的 IDE 中有一个现成的警告列表，可以在你正确更改界面时进行更改（并且构建*确实*失败了）。

这依赖于不将警告视为错误，您可能不得不暂时放松构建设置。

在新的源代码更新中完成所有这些操作，这样如果您想再试一次，就可以回滚部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T22:38:01.673

就像一个提示：当您要构建自己版本的此类工具时，您也可以使用反射对已编译的程序集执行此操作。

.NET 为您提供了加载程序集和查询 System.Reflection 命名空间中的所有接口、类型、方法和属性所需的一切。这样，您就不必担心自己使用 sed/awk/perl 解析源代码（这并非易事，因为您需要解析命名空间和继承）。

（注意：您不会直接使用反射获得的是程序集依赖于动态加载的程序集，例如通过 Assembly.Load 加载。如果在您的项目中使用它，则必须实现特殊处理）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T20:54:15.877

我不知道您的项目是如何设置的，但是在这里我们拥有的每个模块都有一个版本号。当我们需要对模块进行更改时，我们会创建一个新版本。想要使用新接口的客户端代码链接到更新的模块并删除对旧项目的引用。使用不同的版本，更改 API 不会产生意外的副作用；客户端代码必须明确地做某事。

此外，我们有一个实用程序（以某种方式）爬取所有项目并报告其中任何一个项目是否使用了不是最新版本的模块。很容易检查（即使使用 Microsoft VSS！）哪些项目引用了过时的模块。

# c# - Writing XML with C#

> ID：489173
> 
> 赞同：3
> 
> 时间：2009-01-28T20:27:04.120
> 
> 标签：c#, xml, file-io

My C# is a bit rusty and I've never written XML with it before. I'm having trouble getting the XML to write to a file if I attempt to write anything other than elements. Here is the test code that I have:

```
var guiPath = txtGuiPath.Text;
MessageBox.Show("Dumping File: " + guiPath);

try
{
    var writer = new XmlTextWriter("client_settings.xml", null);
    writer.WriteStartDocument();
    writer.WriteComment("Config generated on 01/01/01");
    writer.WriteStartElement("Config");
    writer.WriteStartElement("GuiPath");
    writer.WriteString(guiPath);
    writer.WriteEndElement();
    writer.WriteEndElement();
    writer.WriteEndDocument();
    writer.Close();
} catch (Exception ex) {
    MessageBox.Show(ex.Message);
}
MessageBox.Show("Finished Dumping"); 
```

If guiPath is blank I get the following XML:

```
<?xml version="1.0"?>
<!--Config generated on 01/01/01-->
<Config>
    <GuiPath />
</Config> 
```

but if there is any text inside guiPath then nothing gets written to the file. I can even delete the client_settings.xml file and fire this code off over and over and the XML file never gets generated unless guiPath is empty. Passing something like "This is a test" to WriteString() works as well.

**Update**

Since I'm trying to write out a system path, that seems to be the problem. If I strip out all the backslashes it will write the resulting string correctly, but if I pass it to WriteString or WriteCData the XML will not write at all.

**Update 2**

Turns out that the reason I was having so many problems is because the XML file was being generated in whatever path guiPath was set to, not into the directory that the app was running from (so to me it looked like it wasn't being generated at all). So, if I had guiPath set to 'C:\Program Files\externalApp\appName.exe', it was saving the XML file as 'C:\ProgramFiles\externalApp\client_settings.xml' instead of in the startup folder for the app. Why, I don't know. I started passing Application.StartupPath and appended the filename to that and it works great now.

Thanks for all the help!

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-28T20:34:12.390

You might want to examine the API in System.Xml.Linq. It's a bit of a more flexible approach to generating and writing XML. Writing your document might go roughly like this:

```
XDocument document = new XDocument();
document.Add(new XComment("Config generated on 01/01/01"));
document.Add(new XElement("Config", new XElement("GuiPath", guiPath)));

// var xmlWriter = new XmlTextWriter("client_settings.xml", null);
// document.WriteTo(xmlWriter);

// thanks to Barry Kelly for pointing out XDocument.Save()
document.Save("client_settings.xml"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T20:29:27.190

Why not create a simple class to hold all the data you need and then serialize it using XmlSerializer, rather than manually generating it line by line? You can even use the attributes in System.Xml.Serialization to control the output if you need:

```
using System;
using System.IO;
using System.Windows.Forms;
using System.Xml.Serialization;

namespace Foo
{    
    [XmlRoot(ElementName = "Config")]
    public class Config
    {        
        public String GuiPath { get; set; }

        public Boolean Save(String path)
        {
            using (var fileStream = File.Open(path, FileMode.OpenOrCreate, FileAccess.ReadWrite))
            {
                try
                {
                    var serializer = new XmlSerializer(typeof(Config));
                    serializer.Serialize(fileStream, this);
                    return true;
                }
                catch(Exception ex)
                {
                    MessageBox.Show(ex.Message);
                    // Other exception handling here
                    return false;
                }
            }
        }

        public static Config Load(String path)
        {
            using (var fileStream = File.Open(path, FileMode.Open, FileAccess.Read))
            {
                try
                {
                    var serializer = new XmlSerializer(typeof(Config));
                    return (Config)serializer.Deserialize(fileStream);
                }
                catch(Exception ex)
                {
                    MessageBox.Show(ex.Message);
                    // Other exception handling here
                    return null;
                }
            }
        }
    }
} 
```

This way you don't have to worry about manually encoding strings if they have odd characters - the serializer will do that for you.

This also has the added benefit of being able to be serialized back into the class so you can have strongly typed access to the structure, if you ever need to do that.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T20:33:50.830

Hmm, seems likely that the "real" `guiPath` contains characters that are breaking XML validation and the XmlTextWriter with it.

May I suggest you try `.WriteCData()` (instead of `.WriteString()` that is)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T20:36:15.600

What do you want the output to be? If you were looking for something like:

```
<?xml version="1.0"?>
<!--Config generated on 01/01/01-->
<Config>
    GuiPath="c:\some\path\here\"
</Config> 
```

Then you need to change your WriteString to:

```
writer.WriteAttributeString("GuiPath", guiPath); 
```

Or, if you wanted:

```
<GuiPath>c:\some\path\here\</GuiPath> 
```

Then you need to write

```
writer.WriteElementString("GuiPath", guiPath); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T20:50:33.870

Nobody else has mentioned it, but I think I had better: **strongly** consider using the `using` statement when working with `IDisposable` implementations such as `XmlTextWriter` etc.

This is important not just for closing resources, such as the underlying stream or text writer, but also to make sure any buffers have been flushed, and to make sure any remaining unclosed elements are closed.

So, when you see [mquander's anwser](https://stackoverflow.com/questions/489173/writing-xml-with-c#489208), consider this instead:

```
using (var xmlWriter = new XmlTextWriter("client_settings.xml", null))
{
    // ...
} 
```

Similarly, in [Daniel's answer](https://stackoverflow.com/questions/489173/writing-xml-with-c#489186), don't blindly swallow exceptions, and strongly consider using the `using` statement on the return value of `File.Open` (which probably ought to be `File.OpenText` to be idiomatic, but there are many other shortcomings in style with Daniel's answer at the time of writing).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T20:35:24.213

I would use the System.XML.Linq.XElement class

Note sure about the comment but the Config part would go something like this.

```
XElement root = new XElement("Config");
root.Add(new XElement("GuiPath", guiPath);
root.Save("client_settings.xml"); 
```

**Edit:** mquander's example is better. Look at that.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-28T21:15:05.257

You need to escapify the contents before writing them out, to make sure that they're valid strings. I don't know of a .NET routine to do it automatically, unfortunately -- the question has been asked here before.

# sql-server - 查找存储在 LUN 上的数据库的可用驱动器空间

> ID：489181
> 
> 赞同：1
> 
> 时间：2009-01-28T20:28:55.427
> 
> 标签：sql-server, tsql

我们有许多数据库，它们的文件存储在驱动器中各自的挂载点上

```
（例如 Z:\dbname_db\dbname_db.mdf 和 Z:\dbname_log\dbname_log.ldf）

```

我正在寻找的是一种找到挂载点可用空间的方法。

```
    EXEC xp_cmdshell 'fsutil volume diskfree Z:\dbname_db'

```

但是该服务没有以管理员身份运行，因此 fsutil 将无法工作。

我将如何去做，存储过程是最有效的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:14:40.203

xp_fixeddrives 不会显示安装点的信息，只会显示普通的固定驱动器。

以下链接有一个 CLR 过程，它将使用性能计数器返回安装点的容量和可用空间。

[http://weblogs.sqlteam.com/tarad/archive/2007/12/18/60435.aspx](http://weblogs.sqlteam.com/tarad/archive/2007/12/18/60435.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T16:25:53.570

嗨，请参阅下面的脚本，它将显示 Fxied 和挂载卷的总大小和可用空间。要运行这个 sxcript 启用 WMIC（转到 DOS 类型 WMIC，这将首次安装 WMIC）和 XP_CMDShell。

```
SET ARITHIGNORE ON
SET NOCOUNT ON
GO

DECLARE @dsize VARCHAR(20)
DECLARE @SQL NVARCHAR(500)

SET @sql = 'xp_cmdshell ''fsutil volume diskfree ' --+'D:'''+''

CREATE TABLE #Dletter (
    Drive VARCHAR(50),
    )

CREATE TABLE #Size (Sinfo VARCHAR(250))

CREATE TABLE #DriveInfo (
    Drive VARCHAR(30),
    TotalSize REAL,
    Freesize REAL
    )

--set @x='xp_cmdshell''wmic volume get capacity,caption,freespace'''
INSERT INTO #Dletter
EXEC xp_cmdshell 'wmic volume where drivetype="3" get caption'

SET ROWCOUNT 1

DELETE
FROM #Dletter

SET ROWCOUNT 0

DELETE
FROM #Dletter
WHERE drive IS NULL
    OR len(drive) < 4

UPDATE #dletter
SET drive = replace(drive, ' ', '')

--delete from #Dletter where Drive like'R:\%'
--delete from #Capacity where Dcapacity is null or len(Dcapacity)<15 
--delete from #dletter where
-- convert(int,substring(drive,len(drive)-1,len(drive)))=5
--SELECT Row_Number() OVER (order by Drive asc) as RowNumber,drive from #Dletter
DECLARE @dv VARCHAR(30)

DECLARE dx CURSOR
FOR
SELECT *
FROM #dletter

OPEN dx

FETCH NEXT
FROM dx
INTO @dv

WHILE @@fetch_status = 0
BEGIN
    SET @sql = @sql + @dv + ''''

    --  print @sql
    INSERT INTO #Size
    EXEC sp_executesql @sql

    DELETE
    FROM #size
    WHERE sinfo IS NULL
        OR sinfo LIKE 'Total # of avail free bytes  :%'

    --select Drive from #dletter
    --insert into #DriveInfo(Drive,TotalSize,Freesize)
    SELECT @dv AS Drive,
        convert(REAL, substring(sinfo, isnull(charindex(':', sinfo), 0) + 2, len(isnull(sinfo, 0)))) / 1024 / 1024 / 1024 AS Size
    INTO #rama
    FROM #size
    ORDER BY 2 ASC

    DECLARE @d VARCHAR(30)
    DECLARE @s REAL
    DECLARE @cntr INT

    SET @cntr = 1

    DECLARE x CURSOR
    FOR
    SELECT *
    FROM #rama
    ORDER BY 2 DESC

    OPEN x

    FETCH NEXT
    FROM x
    INTO @d,
        @s

    WHILE @@fetch_status = 0
    BEGIN
        IF @cntr = 1
        BEGIN
            INSERT INTO #Driveinfo (
                Drive,
                Totalsize
                )
            VALUES (
                @d,
                @s
                )
                --print convert(char,@cntr)+' '+convert(varchar,@d)+'TotalSize:'+convert(varchar, @s)
        END

        IF @cntr = 2
        BEGIN
            UPDATE #DriveInfo
            SET Freesize = @s
            WHERE drive = @d
                --print convert(char,@cntr)+' '+convert(varchar,@d)+'FreeSize:'+convert(varchar, @s)
        END

        FETCH NEXT
        FROM x
        INTO @d,
            @s

        SET @cntr = @cntr + 1
    END

    CLOSE x

    DEALLOCATE x

    DROP TABLE #rama

    DELETE
    FROM #size

    SET @Cntr = 1

    FETCH NEXT
    FROM dx
    INTO @dv

    --print @sql
    SET @sql = 'xp_cmdshell ''fsutil volume diskfree ' --+'D:'''+''
END

CLOSE dx

DEALLOCATE dx

SELECT Drive,
    convert(DECIMAL(10, 2), TotalSize) AS "TotalSize(GB)",
    convert(DECIMAL(10, 2), FreeSize) AS "FreeSize(GB)"
FROM #DriveInfo
ORDER BY drive

DROP TABLE #Dletter

DROP TABLE #size

DROP TABLE #DriveInfo 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T20:35:07.630

跑步时会发生什么

```
exec master..xp_fixeddrives 
```

# javascript - 服务器端验证，如何将错误传递给在 MVC 中查看？

> ID：489188
> 
> 赞同：4
> 
> 时间：2009-01-28T20:29:41.340
> 
> 标签：javascript, asp.net-mvc, error-handling

使用 .net MVC，我正在处理表单发布的操作中进行一些服务器端验证。

将错误传递回视图的好技术是什么？

我正在考虑创建一个错误集合，然后将该集合添加到我的 ViewData 中，然后以某种方式编织一些 javascript（使用 jQuery）来显示错误。

如果 jQuery 有一些自动显示错误的方式，那就太好了，因为这是一种常见的模式。

你做什么工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T20:40:07.153

您希望按照@Mehrdad 的指示将错误添加到 ModelState 中。

```
...
catch (ArgumentOutOfRangeException e)
{
    ModelState.AddModelError( e.ParamName, e.Message );

    result = View( "New" );
} 
```

并在您的视图中包含 ValidationSummary

```
<%= Html.ValidationSummary() %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T20:32:27.167

`ViewData.ModelState`旨在将状态信息（错误）从控制器传递到视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T20:52:50.217

不太确定它是否是您正在寻找的东西，但在[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)上有一个非常易于使用的 jquery 表单验证插件。它会自动以红色显示错误消息。

当然，您仍然需要进行服务器端验证，并将错误传回。tvanfosson 在他的回答中向您展示了如何。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T08:39:46.623

我使用内置`ModelState`对象保存我的验证错误。验证是在绑定中完成的，也可以通过手动添加错误来支持手动完成，如下所示：

`ModelState.AddModelError("LastName","Last name can't be Doe")`.

为了支持 ajax 表单发布场景，我对 ModelStateDictionary 做了一个扩展方法`GetErrors()`，它返回一个轻量`ModelStateErrorsDTO`对象（模型状态验证错误的扁平化版本，适合 json 序列化）。

当表单发布是 ajax 请求时，我会返回一个 json serialized `ModelStateErrorsDTO`。

在 jquery 方面，我编写了一个辅助函数，它使用默认的 mvc css 类将验证错误放置在相关输入字段旁边，即 `input-validation-error`.

这样，您将能够使用验证消息制作不显眼的 ajaxform。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-28T20:51:08.627

是的，这是个好方法，但无论如何您都可以将错误消息放入您自己的 ViewData["key"] = "Error on page...bla...bla...bla..."

```
<% if (!string.IsNullOrEmpty(ViewData["key"]+"")) { %>

<div>
Yor customized error template
</div

<% } %> 
```

# mysql - 具有大小问题的唯一字段

> ID：489193
> 
> 赞同：0
> 
> 时间：2009-01-28T20:31:25.127
> 
> 标签：mysql, unique

我有一个 mysql 数据库，我正在尝试将 url 和唯一 id 放入两个单独的字段中。其中一个网址有时超过 800 个字符。我尝试创建 id 和 url 的唯一索引，这样我就不会多次链接到同一个 url/id 组合，但我收到有关索引字段长度的错误。

我目前将 url 存储为 varchar。我应该使用博客吗？或者是其他东西？这将如何影响 UNIQUE 索引？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T20:34:19.473

将 URL 保留在一个`TEXT`字段中，将`MD5`URL 的哈希保留在另一列中，并在哈希列上创建唯一索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T20:34:34.823

我相信 varchar 的大小限制是 255。您应该将类​​型 varchar 更改为 text。

# java - Java中的广度优先搜索

> ID：489204
> 
> 赞同：2
> 
> 时间：2009-01-28T20:33:03.283
> 
> 标签：java, arraylist, breadth-first-search

我必须在 Java 中运行广度优先搜索以获取作业。我有一个 5x5 的瓷砖网格（总共 24 个 - 1 个瓷砖是“空白的”）。搜索的重点是通过向上、向下、向左或向右移动“空白”来重新排列拼贴，最终将拼贴重新排列为正确的顺序。

为了进行这个搜索，我创建了一个 Arraylist 'queue'。我有一个方法可以获取这个数组列表索引 0 处的状态，找到可以遵循的每个合法移动，然后将它们分别添加到数组列表的末尾。

从理论上讲，这一直持续到最终找到“目标状态”。问题是，当我运行搜索时，“队列”数组列表继续变得越来越大。今天我让它运行了几个小时，仍然没有找到解决方案。

这表明我可能以错误的方式解决了这个解决方案，并且有一种更好的方法可以让我在 Java 中进行广度优先搜索。我知道我的解决方案确实有效（最终），因为当我使用与目标状态相差不大的开始状态时，找到正确的路径并不需要太长时间。但是，我已经获得了一个可以使用的开始状态，不幸的是，它与目标状态相去甚远！！！

任何提示或提示将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T20:47:42.817

首先，我肯定会使用实际的 Queue 对象而不是 ArrayList。这是 Queue 接口上的 Java API 页面：http: [//java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html) - 您可以在该页面上看到有很多实现者队列，如果你不知道该选择什么，一个简单的 LinkedList 就可以了。ArrayList 将对性能产生巨大影响，因为它只是从末尾快速删除，如果您从数组中的其他任何位置删除，它必须将所有内容都**向下**移动一个（**慢**！）。你会在最后排队并在开始时出队，因此**慢**！

现在您没有明确提到您在完成项目后将它们出列（删除它们），所以我认为您是，因为这是原因之一。

您是否必须专门使用广度优先搜索？如果我计算正确，有 25 个！（阶乘）组合，所以这是 15511210043330985984000000 个组合，理论上这意味着如果您进行广度优先搜索，您的算法可能永远不会完成。不允许深度优先搜索吗？如果您必须使用广度优先搜索，那么让它更快的唯一方法是修剪掉不可能导致最佳解决方案的状态。不知道你会怎么做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T20:49:55.900

没有重复检查的广度优先搜索肯定会给您提供您所看到的结果。事实上，证明你实现的算法*永远不会*终止是相当简单的。不过请随意等待... :-)

您需要的是一个辅助数据结构（最好是 a `Set`）来存储预先检查的位置。因此，您的部分代码将如下所示：

```
public Queue<Position> queue = new LinkedList<Position>();
public Set<Position> done = new HashSet<Position>();

public Position[] findPath(Position start, Position goal) {
    if (done.contains(start)) return null;

    done.add(start);
    // add subsequent states to `queue`
    ...
} 
```

正如其他答案中提到的，在这种情况下，深度优先搜索是一个更好的解决方案*。*假设该`goal`位置是可到达的，它应该为除了最人为的位置之外的所有位置产生指数级的优越搜索时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T20:42:32.670

乍一看，您最终可能会出现重复的状态，因此您的图表中会出现循环。您可能需要寻找某种方法来确定两个州是否相同以及您之前是否已经访问过一个州。

编辑：抛开算法限制，也许有一个公式可以将块 X 在位置 Y 移动到位置 Z 而不会干扰任何其他图块。鉴于此，您可以计算所需的所有转换。我现在只是在思考这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T20:39:19.870

虽然它可能不在你的任务范围内，但有一种算法可以解决这种类型的谜题。基本上，除了最后两行之外，每行都有两个动作，最后两行有两个动作。使用这种方法可以获得更快的解决方案。

不幸的是，由于这是一项任务，毫无疑问，您应该进行蛮力搜索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T20:47:07.607

我已经完成了“蛮力搜索”——问题是，对于 5x5 网格，有太多的组合需要永远进行。我在上班时让它运行... 8 小时后，它仍在运行，队列数组列表大小高达 100k 不同的状态，我的电脑听起来像是要过热并爆炸哈哈

我知道我的代码有效（最终，就像我说的那样），所以我很乐意提交它。我只是担心找到解决方案所需的时间，并想知道是否有更好的方法，而不是使用 arraylist 创建队列。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T20:49:29.927

我认为这个练习的想法是让你意识到深度优先搜索是解决这个特定难题的更好方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T20:51:59.763

我实际上必须为两者编写代码。所以我即将进入深度优先搜索。在我这样做之前，我只是想确保我不会因为编写需要永远和一天才能找到解决方案的代码而被嘲笑！！！！！！！！！！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T20:56:40.300

你没有说你是否检查这个，但听起来你没有修剪周期。

首先，假设您没有将移动表示为向某个方向移动空白方块，而是提供了移动的瓷砖编号。（它保证是唯一的。）现在假设一个合法的移动是“3” - 将瓷砖＃3移动到空白空间。结果是一个新的电路板布局。从那里开始的合法举动是再次移动瓷砖 3，现在你又回到了开始的地方。

滑块拼图很容易有更大的周期。如果有一个 2x2 网格，其中 1-2-3-empty，那么有效的移动序列是 1-2-3-1-2-3-1-2-3-1-2-3 - 它发送给你回到开始。

如果您的搜索没有检查和修剪重复的棋盘，广度优先搜索仍将终止（前提是没有错误，并且没有奇偶校验错误（？）使您的棋盘无法解决） - 存在一个正确的解决方案，即 N 步在长度上，您将花费有限的时间来处理 K 移动的每个序列，因此您最终会得到 N 和您的解决方案。但是，每次移动长度的时间呈指数增长（每个棋盘最多 4 次移动）。你可能在记忆中挣扎。

不幸的是，检查重复板状态的蛮力方法是在您到达时存储每个板，这也会很快耗尽内存 - 尽管可能不如您当前的方法快。事实上，对于仅 5x5 的板来说，它可能是令人满意的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-28T21:06:43.073

也许是目标导向的深度优先搜索。首先解决 9 个边缘图块，将拼图缩小为 4x4 网格。然后解决其中的 7 个边缘图块，减少到 3x3 网格，这对于您的原始算法来说应该很容易挑选。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-28T21:08:42.993

我目前的做法如下：

*   2个数组列表；排队和访问
*   开始状态自动添加到已访问的数组列表中
*   从一开始就获得所有可能的合法移动，并将每个移动与存储在已访问数组列表中的移动进行比较。
*   那些不创建“已访问”状态的合法移动将添加到队列中。
*   获取数组列表索引 0 处的状态，并重复该过程。

我从以前的答案中看到，我可能应该将数组列表更改为不同的集合。但我正在检查状态是否重复。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-28T21:27:40.893

好的，接下来的事情是，如果我要做你的访问列表，我会使用一个 Set （可能是一个[TreeSet](http://java.sun.com/j2se/1.5/docs/api/java/util/TreeSet.html)），它会自动对状态进行排序，以便搜索以前是否访问过新状态会快得多。

您需要做的就是让您的状态类实现[Comparable](http://java.sun.com/j2se/1.5/docs/api/java/lang/Comparable.html)接口。（希望你已经预料到了这样的事情并把它变成了一门课）。如果您还不知道，使用此接口的 compareTo 方法，您可以定义对象的排序顺序，这当然会被访问的 Set 使用。从那里您可以设置 compareTo 方法，使其像字符串比较一样工作，除了您的瓷砖。

因此，为了清楚起见，如果每个图块都分配了一个字母，并且列出了每个州的图块，我们可能会这样：

```
State 1: ABCDEFGHIJKLMNOP
State 2: BCADEFGHIJKLMNOP 
```

自然状态 1 将按顺序排在第一位。因此，只需将 compareTo 机制推断为适用于磁贴到磁贴（我确定你的磁贴有 ID 或索引或其他东西不是吗？），你就会有一个排序的访问列表。然后，当您调用visited.contains(state) 时，程序将能够非常快速地计算出一个状态是否已被访问。

# delphi - Delphi 历史 - 源代码控制

> ID：489213
> 
> 赞同：1
> 
> 时间：2009-01-28T20:35:17.927
> 
> 标签：delphi, version-control

在阅读了一些关于为单个开发人员使用源代码控制的优势的帖子后，在我看来，主要优势是我将对源文件的所有更改进行备份。Delphi 有一个内置的历史功能，默认情况下会执行此操作。

这真的是一样的还是我应该使用“真正的”源代码控制工具？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-28T20:54:29.447

history 函数不会无限期地维护历史，你可能有一天会删除 __history 目录，无论是因为你认为它很粗糙，还是因为你正在归档项目等。

如果您曾经发布过您的源代码——即将它发送给第三方——您将希望能够跟踪您实际发布的内容。在源代码控制系统中，标签可以帮助解决这个问题；然后，分支可以让您将补丁应用于先前发布的版本，而无需进行扭曲，例如以不同程度的进步维护具有相同源代码的多个目录。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-29T03:09:47.927

我有一系列关于版本控制的帖子，从[http://sourceitsoftware.blogspot.com/2008/07/starting-out-with-delphi-and-subversion.html](http://sourceitsoftware.blogspot.com/2008/07/starting-out-with-delphi-and-subversion.html)开始。我不回答您的问题，但在稍后设置版本控制时可能会有所帮助。

在我的脑海中，使用 vcs 的独立开发人员（我就是其中之一）的主要优势是：

*   异地备份（我使用网络托管设施）
*   我可以轻松查看整个更改历史记录（delphi 是逐个文件的，这在发现构建 125 和 126 之间引入的错误时无济于事）
*   能够维护应用程序的不同版本并轻松合并它们之间的更改（即我正在一个分支中处理 v4，但我可以轻松地将我为 v3 所做的错误修复合并到另一个分支中）
*   使进行推测性编程变得更容易。即我可以尝试一些东西，如果它不起作用，我可以轻松地恢复我的更改以恢复到工作版本
*   提供审核日志/更改历史记录。当我发布新版本时，我可以将更改历史记录复制/粘贴到自述文件中

这有点像单元测试。进入需要一些时间，但一旦你进入，它会让生活变得更轻松。

AFAIC 是关于专业的。我不会为不使用 vcs 的公司工作，在雇用不使用 vcs 的程序员之前我会仔细考虑。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T20:53:42.490

Delphi 的历史是有限的（我认为是 10 或 25 份？）。那么，当您想进一步返回时会发生什么？

版本控制还允许您拥有更改集，例如在 SVN 中，您可以查看同时签入的其他文件。

此外，缺少源代码控制的所有其他优点：分支、合并、标记等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T21:12:11.613

您应该将源代码保存在源代码控制系统中，delphi 历史记录功能太有限，无法防止灾难性的硬件故障。

但是，delphi 历史功能仍然非常有用。当您在源代码控制中保留较大的更改时，您可以保留 delphis 历史中最近更改的简短历史。我已将 delphi 设置为为每个文件保留 90 个历史记录条目，如果我正在编辑单个文件，这通常会为我提供 90 分钟的最新工作历史记录。您可以使用它来比较您最近所做的事情，恢复您认为不应该真正删除但您在上次签入后编写的旧代码，如果您的 pas/dfm 已损坏，则恢复最近的副本等等.

因此，请将您的代码保存在源代码控制系统中（在另一台计算机上，最好是在另一个物理位置），但不要忘记 delphi 历史，因为它很有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-28T21:57:01.863

我是单身开发者，现在使用 Tortoise SVN 已经有一段时间了，发现它很有用。我在笔记本电脑上进行开发，并在另一台计算机上拥有存储库，因此我在另一台计算机上备份了我的代码（我也会不时备份我的笔记本电脑）。我还发现我可以将我的代码检查到另一台计算机上并编译（在安装了一些第三方零碎之后），这让我感到很欣慰。

另一个明显的优势是存储库中的源历史记录，但大多数情况下我一直在使用 _History，因为我通常只想撤销微小的更改——我还没有做任何真正不称职的事情——但这只是时间问题;-)

我还没有进入分支/分叉我的代码，但我想我可能会在需要时开始调查这个（我有信心）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T20:47:03.097

delphi 历史是否有你的源代码的物理备份？

你确定你**永远不会**让其他团队成员处理相同的代码吗？

Delphi 历史记录是否向您展示了谁对代码进行了更改？

这些只是我能想到的几个问题。如果您对他们的回答是肯定的，那么也许 delphi 历史对您来说就足够了。

# winforms - 文本框与标签

> ID：489220
> 
> 赞同：4
> 
> 时间：2009-01-28T20:36:39.390
> 
> 标签：winforms, user-interface

我正在用 C# 开发一个 winForm 应用程序，我遇到了一些一直困扰我的事情。

**在向用户显示数据时使用标签或文本框是更好的做法吗？**

诸如姓名、电话号码等之类的东西。我的直觉说要使用文本框并将其设置为只读，直到我需要允许从该特定位置进行编辑。计划未来，就像它一样。

作为一名年轻的*Lone Wolf*开发人员，我非常感谢这里的任何见解。两者都有优点和缺点吗？还有什么我没有想到的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-28T20:43:40.017

要考虑的一件有用的事情是文本框中的文本是可选择的，因此您的用户可以更轻松地复制/粘贴内容。

过早的优化（如使用标签，因为它们更轻量级）应该让位于防御性编程，正如您所怀疑的那样，这可以在未来节省您的时间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-08-04T23:16:03.307

您可能需要允许用户复制文本......这是我使用文本框然后让它们看起来像标签的唯一原因（只读和透明背景，没有边框）。

事实上，Windows 中的“属性”对话框使用文本框允许您复制文本。

请注意，我说的是“只读”......不是“禁用”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-28T20:47:01.460

对于用户可以编辑的数据（无论是否在当前上下文中启用），我总是使用我根据需要启用/禁用的文本框。对于纯粹是信息性的数据，即在当前上下文中不会为用户提供更改它的选项，那么这就是我使用标签的地方。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-28T20:39:12.177

表明一个值是动态的是这里的关键。通常，文本框可以很容易地识别这就是使用它的原因。如果您可以使用标签来做到这一点，那将是首选。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-28T20:39:53.707

对于静态文本，我总是使用标签——如果我不需要它，为什么要使用更重的控件？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-28T20:43:48.050

标签是要走的路。

未启用的文本框的问题是用户希望有某种方法可以启用它。如果他们找不到允许编辑的地方，那么他们认为软件有问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T20:39:09.417

除非需要编辑数据，否则请使用标签。您确实应该使用最适合所显示信息的任何标签。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-28T20:43:48.893

有时，您的用户可能希望能够突出显示和复制静态文本（地址、电话号码等）。据我所知，标签不能突出显示，而只读文本框可以。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-28T20:47:51.800

我认为这是一个你需要停止成为程序员并开始成为用户的地方。将事物视为系统的用户，而不是开发人员。看看哪一个让您作为用户感觉更舒服。如有必要（并且可能），请询问未参与开发过程且不太了解编程技术的人。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-28T20:44:37.080

我同意d03boy。文本框推断该值是可编辑的。标签推断仅显示形式。这有点多的工作。恕我直言，您希望您的应用程序与其他基于 Windows 的应用程序相匹配，以使您的应用程序感觉尽可能专业。

我会遵循查看/编辑表单显示模型。

# regex - XSLT 2.0，替换功能：如何用大写替换匹配组？

> ID：489232
> 
> 赞同：2
> 
> 时间：2009-01-28T20:39:40.727
> 
> 标签：regex, xslt, xpath, replace, uppercase

如果我的 XSL 文件中有以下元素：

```
<xsl:value-of select="replace(lower-case(@name), '_([a-z0-9])', '$1')" /> 
```

例如，从“get_polygene_lubricants”中可以生成“getpolygenelubricants”。

我想要做的是用字母的大写变体替换“_”之后的第一个字母。我用谷歌搜索，阅读文档，但我无法在 XSLT 中找到任何解决方案来进行简单的替换。

也许有人知道在 XSLT 2.0 中是否可行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T21:09:43.020

**已编辑**：根据原始海报的说明，由下划线分隔的第一个字符串不应将其首字母大写。

**此解决方案不使用递归，应该更有效**。

**这是新的解决方案**：

```
string-join(
            (for  $i in 1 to count(tokenize(.,'_')),
                  $s in tokenize(.,'_')[$i],
                  $fl in substring($s,1,1),
                  $tail in substring($s,2)
               return
                  if($i eq 1)
                   then $s
                   else concat(upper-case($fl), $tail)
             ),
                        ''
           ) 
```

结果现在完全符合要求：

```
underLinedString 
```

**下面是旧的解决方案**。

**replace() 函数假设你有一个固定的替换**——因此它不是解决这个问题的最佳工具。

**这是一个单行 XPath 2.0 解决方案**（它当然可以用作 XSLT 2.0 转换的一部分:)）：

```
string-join(
            (for $s in tokenize(.,'_'),
                 $fl in substring($s,1,1),
                 $tail in substring($s,2)
               return
                 concat(upper-case($fl), $tail)
             ),
            ''
           ) 
```

**当我们在这样的 XSLT 2.0 转换中使用上述表达式时**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xsl:template match="/">
     <xsl:sequence select=
      "string-join(
                   (for $s in tokenize(.,'_'),
                    $fl in substring($s,1,1),
                    $tail in substring($s,2)
                  return
                concat(upper-case($fl), $tail)
                   ),
                   ''
                  )

      "/>
    </xsl:template>
</xsl:stylesheet> 
```

并将其应用于此 XML 文档：

```
<t>under_lined_String</t> 
```

**the wanted result is produced**:

```
UnderLinedString 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T20:47:07.903

您可以使用模板执行此操作，递归调用自身以遍历字符串中的字符。这个模板应该有一个位置参数，从 1 开始，每次调用模板都会增加。找到 '_' 时，使用 translate(1.0) 或 upper-case(2.0) 将下一个字符转换为大写

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-01T03:53:36.877

Although already answered, here's my solution:

```
<xsl:template name="camel-case">
  <xsl:param name='value'/>
  <xsl:analyze-string regex="^(.)" select="$value">
    <xsl:matching-substring><xsl:value-of select="upper-case(regex-group(1))"/></xsl:matching-substring>
    <xsl:non-matching-substring>
      <xsl:analyze-string regex="[_-](.)" select=".">
        <xsl:matching-substring><xsl:value-of select="upper-case(regex-group(1))"/></xsl:matching-substring>
        <xsl:non-matching-substring><xsl:value-of select="."/></xsl:non-matching-substring>
      </xsl:analyze-string>
    </xsl:non-matching-substring>          
  </xsl:analyze-string>
</xsl:template> 
```

Use:

```
<xsl:call-template name="camel-case">
  <xsl:with-param name='value' select="."/>
</xsl:call-template> 
```

# winforms - 根据数据库角色的用户菜单？

> ID：489233
> 
> 赞同：1
> 
> 时间：2009-01-28T20:39:41.320
> 
> 标签：winforms, menu, c#-2.0, roles

我需要你的一些编程经验。这是问题：

当用户登录 WinForms 应用程序 (C#.NET) 时，如何根据数据库中的角色动态分配定义的菜单（不同的菜单取决于登录到我的应用程序的用户）？

提前感谢您的支持、时间和分享您的知识，这真的很有帮助。

有高手吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T21:10:32.597

您可以使用 IS_MEMBER('role') t-sql 函数来检测他们拥有的角色。我可能会将它包装在一个存储过程中，并将我关心的角色作为一组记录返回（即，用户拥有的所有我关心的角色）。

然后你只需使用如下代码：

```
if (loginEntity.IsAdmin)
{
    MenuItem adminMenu = new MenuItem();
    adminMenu.Text = Resources.AdminMenuText;
    mainMenu.MenuItems.Add(adminMenu);

    item = new MenuItem();
    item.Text = Resources.ManageUsers;
    item.Click += UserAdminClick;
    adminMenu.MenuItems.Add(item);

...
} 
```

创建菜单的地方。（我的 loginEntity 对象在这里调用了一个类似的函数，并为我关心的每个角色设置了一个位变量。）代码生成一个新的顶级菜单（假设 mainMenu 已经定义），然后是它下面的“用户管理”项，所有假设当前用户具有管理员角色（例如，'securityadmin'）。

# .net - 帮助识别公共 DLL 的哪些部分仅由一个项目使用的工具？（。网）

> ID：489237
> 
> 赞同：0
> 
> 时间：2009-01-28T20:41:33.407
> 
> 标签：.net, static, analysis

我们小组有一个“工具库”DLL，我们的几个内部项目（都是 C#）都在使用它。我产生了一种直觉，即大部分工具库仅由其中一个项目使用——让我们称该项目为“项目 A”。是否有任何 .NET 工具可以检查工具 DLL 和所有项目（可能是项目 EXE），并枚举工具库中确实仅由项目 A 使用的所有方法和类？我认为一些重构是有序的（将工具库的一部分移回项目 A 自己的代码库），这样的列表听起来会很有帮助。

由于反思，我不认为一个工具可以 100% 正确地完成这项工作。但是假设我知道我们的项目都没有使用任何巧妙的反射技术调用工具库；他们只使用应该适合静态分析的正常方法调用来调用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T20:48:50.160

听起来[NDepend](http://www.ndepend.com/)工具可以为您确定这一点。此外，为了快速检查您是否在 Visual Studio 中使用[ReSharper](http://www.jetbrains.com/resharper/)，您可以右键单击项目引用中的 dll 并选择“查找相关代码”，这将列出单个项目中的用法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T22:19:48.200

对于从使用/使用的角度来看的详尽列表，按每个类型/命名空间（或方法，如果你真的想要）细分，[NDepend](http://www.ndepend.com/)可能是最好的选择。您可以获得一个[免费的受限版本](http://www.ndepend.com/NDependDownload.aspx)，它应该能够做到这一点。

查询将基于[IsUsedBy](http://www.ndepend.com/CQL.htm#_Toc200950392)和[IsUsing](http://www.ndepend.com/CQL.htm#_Toc200950389)

如果每个项目都有一个单独的命名空间（比如说 Foo.A 和 Foo.B）

```
SELECT TYPES WHERE IsUsedBy "Foo.A" 
```

和

```
SELECT TYPES WHERE IsUsedBy "Foo.B" 
```

你会得到一份很好的列表，列出了每个人正在使用的类型。将结果放入电子表格表中，共享/分离的内容将很好地删除

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T20:47:42.893

[.NET Reflector](http://www.red-gate.com/products/reflector/) - 从技术上讲不会给你一个列表，但如果你将所有的 DLL/Exes 加载到其中，你可以对你认为只在一个地方使用的每种类型使用“分析”功能，它会确认或显示给你其他使用该类型的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T20:49:06.493

假设项目 A 中引用了工具库 DLL，您可以使用 Resharper 中的“查找用法”功能，它会告诉您所引用的程序集（在本例中为您的工具库）正在被使用的任何地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T20:49:30.440

这里只是一个建议......我相信可以写一个，但除非你有大量的 dll，否则你可能不必这样做。我会试试这个：

*   获得[“反射器”](http://www.red-gate.com/products/reflector/)

    *   打开它 ：）
    *   将所有 DLL 添加到列表中
    *   去你关心的课程/方法
    *   右键点击
    *   选择“分析”
    *   您应该在分析器中获得一个条目，显示“取决于”和“被使用”
*   创建一个新的解决方案

    *   包括所有现有项目
    *   使用“查找所有引用”命令右键单击工具项目中的方法，查看谁在使用它们。
    *   如果只有一个，那么你知道

希望这可以帮助。

# firefox - 有没有办法以编程方式将 Firefox 书签导出到 XBEL 和从 XBEL 导出？

> ID：489249
> 
> 赞同：0
> 
> 时间：2009-01-28T20:43:58.207
> 
> 标签：firefox, bookmarks, xbel

Firefox 允许最终用户将书签导出为 XBEL 书签交换格式。但我想以编程方式：

1.  导出部分（不是全部）书签和
2.  将 xbel 书签导入 Firefox。

最好使用网络语言，以便我可以从网络服务器运行脚本。

任何人都可以提出解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T21:10:33.377

除了写一个[firefox 扩展](http://lifehacker.com/software/programming/how-to-build-a-firefox-extension-264490.php)，我认为你做不到。可以访问导航器的唯一语言是 JavaScript，而浏览器旨在防止 JS 访问它们（出于安全目的）。

# css - 共享点中的 CSS

> ID：489250
> 
> 赞同：2
> 
> 时间：2009-01-28T20:44:03.400
> 
> 标签：css, sharepoint, document, wss-3.0

我需要根据应用于站点的主题将 CSS 应用于 Sharepoint 站点 (WSS3.0)。CSS 将保存在“文档库”的根站点。如何以编程方式在页面上应用 CSS？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:04:45.510

放入页面布局或母版页。例如

```
<SharePointWebControls:CssRegistration ID="CssRegistrationMyCSS" name="<% $SPUrl:~sitecollection/Style Library/~language/Core Styles/myCSS.css %>" runat="server"/> 
```

以编程方式更改它需要您在页面加载时修改控件。但不确定它的效果如何。

# django - Django 和自定义表单验证

> ID：489252
> 
> 赞同：16
> 
> 时间：2009-01-28T20:44:28.953
> 
> 标签：django, forms, validation

我正在尝试创建一个自定义表单字段并对其进行验证。这是 Django 的 1.0 版本。

这是我的表单对象

```
class UsernameField(forms.CharField):
    def clean(self, values):
        print "" 
```

我是这样称呼它的

```
class RegisterForm(forms.Form):
   username = UsernameField(max_length=30, min_length=4)
   password = forms.CharField(widget = forms.PasswordInput(), min_length=5)
   password2 = forms.CharField(widget = forms.PasswordInput(), min_length=5)
   email = forms.EmailField(max_length=75) 
```

现在我想保留对 CharField 的默认最小/最大长度检查。但我似乎无法弄清楚如何做到这一点。

如果我将任何代码放入 clean() 中，则不会检查这些代码。如果我尝试调用 parent.clean() 我会收到错误消息。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-28T23:59:42.320

如果你只想清理你的字段，不需要定义一个全新的字段，你可以在表单的 clean_username 方法中做到这一点

```
class RegisterForm(forms.Form):
  username = forms.CharField(max_length=30, min_length=4)
  ...
  ...

  def clean_username(self):
    username = self.cleaned_data['username']
    try:
        user = User.objects.get(username=username)
    except User.DoesNotExist:
        return username
    raise forms.ValidationError(u'%s already exists' % username )

  def clean(self):
    # Here you'd perform the password check
    ... 
```

您也可以考虑在 Django 中使用[django-registration](http://bitbucket.org/ubernostrum/django-registration/wiki/Home)进行用户注册，它会在一个可插入的应用程序中处理此问题，该应用程序将为您处理所有用户验证、创建和设置。

至于新的 firld 创建，您的字段的 clean() 方法应该返回一个干净的值，而不仅仅是打印它。

```
class MyField(forms.CharField):
  def clean(self, value):
    # perform cleaning
    return value 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T21:11:00.647

这在 1.0 中不起作用......这就是我解决它的方法

```
class UsernameField(forms.CharField):
    def clean(self, request, initial=None):
        field = super(UsernameField, self).clean(request)

        from django.contrib.auth.models import User
        user = User(username=request)
        if user is not None:
            raise forms.ValidationError("That username is already taken") 
```

# java - 如何使用 Swing 刷新 Windows 任务栏？

> ID：489255
> 
> 赞同：8
> 
> 时间：2009-01-28T20:44:40.433
> 
> 标签：java, swing, taskbar

我正在开发一个 Swing 应用程序，我需要刷新 Windows 任务栏。我不能使用`frame.requestFocus()`，因为我不想从任何其他应用程序中窃取焦点。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-28T21:01:57.013

我不知道它是否适用于较新版本的 Windows，但如果当前 VM 的窗口都不在前台，则 .toFront() 方法用于闪烁窗口。

这意味着在最小化的框架上调用 frame.toFront() 总是会使其闪烁......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T21:03:09.603

[JNIWrapper 及其 winpack 扩展](http://www.teamdev.com/jniwrapper/winpack/)可以做你想做的事。

网站上的演示展示了它的实际应用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-04T02:55:39.870

您可以强制最小化您的 GUI 并`.toFront`-en 它：

```
 Gui.frame.setState(Frame.ICONIFIED);
        for (int i = 0; i < 3; i++) {
            Thread.sleep(10);
            Gui.frame.toFront();
            Thread.sleep(10);
            Gui.frame.setVisible(false);
            Thread.sleep(10);
            Gui.frame.toBack();
            Thread.sleep(10);
            Gui.frame.setVisible(true);
        }
        // be creative!! 
```

遗憾的是，这会将焦点从活动窗口中移除。您可以找出活动窗口并在之后重新激活它。但是，闪烁只会持续大约三秒钟。

...或者通过使用**DLL** -call on找到问题的真正根源`FlashWindow`。使用干净的 Java 代码无法调用 dll，您将需要其他编程语言的帮助，例如[JNA](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/)。除此之外，您还可以用另一种语言编写自己的程序并从您的 Java 应用程序中调用它。我将在下面的 AutoHotkey 中举一个例子：

自动热键代码：

```
 if 0 != 1       ; note: in ahk, 1 corresponds args[1] and 0 corresponds args.length
    {
        msgbox, There needs to be ONE parameter passed over to this file, which is the name of the window that should be flashed.
        ExitApp
    }
    programName = %1%
    winget, hWnd, ID, %programName%
    DllCall("FlashWindow",UInt,hWnd,Int,True) 
```

编译成一个名为 的文件`flash.exe`，放入你的 Java 工作目录，你可以从任何函数调用它：

```
 Runtime.getRuntime().exec("./flash.exe \"" + MyJFrame.getTitle() + "\""); 
```

或者，可以使用 AutoHotkey.dll 并在 Javacode 中访问它（互联网上有如何做到这一点的指南），因此不需要任何外部 exe 文件。

如果在 windows 任务栏中实现闪烁仍然有问题，请告诉我！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-13T10:49:24.330

最好的方法是：

```
if (!isFocused()) {
        setVisible(false);
        setVisible(true);
    } 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-28T21:04:29.897

使用 Swing 本身，你很可能不能；这是 Windowws 特有的事情。

# c# - LINQ 在特定属性上的 Distinct()

> ID：489258
> 
> 赞同：1334
> 
> 时间：2009-01-28T20:45:09.357
> 
> 标签：c#, linq, .net-3.5, distinct

我正在使用 LINQ 来了解它，但是`Distinct`当我没有简单的列表时，我不知道如何使用（简单的整数列表很容易做到，这不是问题）。如果想在对象的*一个*​​或*多个*属性的对象列表上使用[Distinct怎么办？](https://msdn.microsoft.com/library/system.linq.enumerable.distinct%28v=vs.100%29.aspx)

 **示例：如果一个对象是`Person`, 具有 Property `Id`。如何获取所有 Person 并将`Distinct`其与对象的属性一起使用`Id`？

```
Person1: Id=1, Name="Test1"
Person2: Id=1, Name="Test1"
Person3: Id=2, Name="Test2" 
```

我怎样才能得到公正`Person1`和`Person3`？那可能吗？

如果 LINQ 无法实现，那么`Person`根据 .NET 3.5 中的某些属性列出列表的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2234
> 
> 时间：2009-01-29T14:39:07.640

> 如果我想获得基于*一个*或*多个*属性的不同列表怎么办？

简单的！您想将它们分组并从组中选出获胜者。

```
List<Person> distinctPeople = allPeople
  .GroupBy(p => p.PersonId)
  .Select(g => g.First())
  .ToList(); 
```

如果您想在多个属性上定义组，方法如下：

```
List<Person> distinctPeople = allPeople
  .GroupBy(p => new {p.PersonId, p.FavoriteColor} )
  .Select(g => g.First())
  .ToList(); 
```

注意：某些查询提供程序无法解决每个组必须至少有一个元素，并且 First 是在这种情况下调用的适当方法。如果您发现自己在使用这样的查询提供程序，FirstOrDefault 可能会帮助您通过查询提供程序获取查询。

注意 2：考虑使用 EF Core（在 EF Core 6 之前）兼容方法的这个答案。[https://stackoverflow.com/a/66529949/8155](https://stackoverflow.com/a/66529949/8155)

* * *

## 回答 #2

> 赞同：1451
> 
> 时间：2009-01-28T21:17:13.163

**编辑**：这现在是[MoreLINQ](https://github.com/morelinq/MoreLINQ)的一部分。

你需要的是一个有效的“distinct-by”。我不相信它是 LINQ 的一部分，尽管它很容易编写：

```
public static IEnumerable<TSource> DistinctBy<TSource, TKey>
    (this IEnumerable<TSource> source, Func<TSource, TKey> keySelector)
{
    HashSet<TKey> seenKeys = new HashSet<TKey>();
    foreach (TSource element in source)
    {
        if (seenKeys.Add(keySelector(element)))
        {
            yield return element;
        }
    }
} 
```

因此，要仅使用该属性来查找不同的值`Id`，您可以使用：

```
var query = people.DistinctBy(p => p.Id); 
```

要使用多个属性，您可以使用匿名类型，它们适当地实现相等：

```
var query = people.DistinctBy(p => new { p.Id, p.Name }); 
```

未经测试，但它应该可以工作（现在至少可以编译）。

它假定键的默认比较器 - 如果您想传入相等比较器，只需将其传递给`HashSet`构造函数。

* * *

## 回答 #3

> 赞同：106
> 
> 时间：2012-02-14T12:52:51.957

采用：

```
List<Person> pList = new List<Person>();
/* Fill list */

var result = pList.Where(p => p.Name != null).GroupBy(p => p.Id).Select(grp => grp.FirstOrDefault()); 
```

`where`帮助您过滤条目（可能更复杂）并`groupby`执行`select`不同的功能。

* * *

## 回答 #4

> 赞同：86
> 
> 时间：2012-03-06T18:28:50.040

如果你希望它看起来像 LINQ，你也可以使用查询语法：

```
var uniquePeople = from p in people
                   group p by new {p.ID} //or group by new {p.ID, p.Name, p.Whatever}
                   into mygroup
                   select mygroup.FirstOrDefault(); 
```

* * *

## 回答 #5

> 赞同：80
> 
> 时间：2015-01-23T14:54:26.763

我认为这就足够了：

```
list.Select(s => s.MyField).Distinct(); 
```

* * *

## 回答 #6

> 赞同：49
> 
> 时间：2017-07-13T08:33:18.720

解决方案首先按您的字段分组，然后选择第一个或默认项目。

```
 List<Person> distinctPeople = allPeople
   .GroupBy(p => p.PersonId)
   .Select(g => g.FirstOrDefault())
   .ToList(); 
```

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2015-01-20T15:01:47.853

您可以使用标准来做到这一点[`Linq.ToLookup()`](https://msdn.microsoft.com/library/bb549073%28v=vs.100%29.aspx)。这将为每个唯一键创建一组值。只需选择集合中的第一项

```
Persons.ToLookup(p => p.Id).Select(coll => coll.First()); 
```

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2013-02-06T19:56:37.970

以下代码在功能上等同于[Jon Skeet 的 answer](https://stackoverflow.com/questions/489258/linqs-distinct-on-a-particular-property/489421#489421)。

在 .NET 4.5 上测试，应该适用于任何早期版本的 LINQ。

```
public static IEnumerable<TSource> DistinctBy<TSource, TKey>(
  this IEnumerable<TSource> source, Func<TSource, TKey> keySelector)
{
  HashSet<TKey> seenKeys = new HashSet<TKey>();
  return source.Where(element => seenKeys.Add(keySelector(element)));
} 
```

顺便说一句，在 Google Code 上查看[Jon Skeet 的最新版本 DistinctBy.cs](http://code.google.com/p/morelinq/source/browse/MoreLinq/DistinctBy.cs)。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2009-03-11T12:21:19.053

我写了一篇文章，解释了如何扩展 Distinct 函数，以便您可以执行以下操作：

```
var people = new List<Person>();

people.Add(new Person(1, "a", "b"));
people.Add(new Person(2, "c", "d"));
people.Add(new Person(1, "a", "b"));

foreach (var person in people.Distinct(p => p.ID))
    // Do stuff with unique list here. 
```

这是文章（*现在在 Web 存档中*）：*[扩展 LINQ - 在不同函数中指定属性](https://web.archive.org/web/20090323074757/http://www.singingeels.com/Articles/Extending_LINQ__Specifying_a_Property_in_the_Distinct_Function.aspx)*

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2015-10-30T18:59:07.003

我个人使用以下类：

```
public class LambdaEqualityComparer<TSource, TDest> : 
    IEqualityComparer<TSource>
{
    private Func<TSource, TDest> _selector;

    public LambdaEqualityComparer(Func<TSource, TDest> selector)
    {
        _selector = selector;
    }

    public bool Equals(TSource obj, TSource other)
    {
        return _selector(obj).Equals(_selector(other));
    }

    public int GetHashCode(TSource obj)
    {
        return _selector(obj).GetHashCode();
    }
} 
```

然后，一个扩展方法：

```
public static IEnumerable<TSource> Distinct<TSource, TCompare>(
    this IEnumerable<TSource> source, Func<TSource, TCompare> selector)
{
    return source.Distinct(new LambdaEqualityComparer<TSource, TCompare>(selector));
} 
```

最后，预期用途：

```
var dates = new List<DateTime>() { /* ... */ }
var distinctYears = dates.Distinct(date => date.Year); 
```

我发现使用这种方法的优点是可以将`LambdaEqualityComparer`类重用于其他接受`IEqualityComparer`. （哦，我把这些`yield`东西留给原始的 LINQ 实现......）

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2021-06-01T12:06:33.197

从 .NET 6 开始，[在 Linq 中有使用](https://devblogs.microsoft.com/dotnet/announcing-net-6-preview-4/#distinctby-unionby-intersectby-exceptby)[新`DistinctBy()`](https://devblogs.microsoft.com/dotnet/announcing-net-6-preview-4/#distinctby-unionby-intersectby-exceptby)扩展的新解决方案，所以我们可以这样做

```
var distinctPersonsById = personList.DistinctBy(x => x.Id); 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2019-03-27T06:04:44.570

您可以使用 DistinctBy() 通过对象属性获取不同的记录。使用前只需添加以下语句：

> 使用 Microsoft.Ajax.Utilities；

然后像下面这样使用它：

```
var listToReturn = responseList.DistinctBy(x => x.Index).ToList(); 
```

其中“索引”是我希望数据不同的属性。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-01-28T20:47:38.260

你可以这样做（虽然不是闪电般快速）像这样：

```
people.Where(p => !people.Any(q => (p != q && p.Id == q.Id))); 
```

也就是说，“选择列表中没有其他具有相同 ID 的人的所有人”。

请注意，在您的示例中，这只会选择第 3 个人。我不确定如何从前两个中分辨出您想要哪个。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2013-08-15T20:20:50.197

如果您需要对多个属性使用 Distinct 方法，可以查看我的[PowerfulExtensions](https://www.nuget.org/packages/PowerfulExtensions/)库。目前它还处于非常年轻的阶段，但您已经可以在任意数量的属性上使用 Distinct、Union、Intersect、Except 等方法；

这是你如何使用它：

```
using PowerfulExtensions.Linq;
...
var distinct = myArray.Distinct(x => x.A, x => x.B); 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2014-07-10T21:00:08.423

当我们在项目中遇到这样的任务时，我们定义了一个小的 API 来组成比较器。

所以，用例是这样的：

```
var wordComparer = KeyEqualityComparer.Null<Word>().
    ThenBy(item => item.Text).
    ThenBy(item => item.LangID);
...
source.Select(...).Distinct(wordComparer); 
```

API 本身看起来像这样：

```
using System;
using System.Collections;
using System.Collections.Generic;

public static class KeyEqualityComparer
{
    public static IEqualityComparer<T> Null<T>()
    {
        return null;
    }

    public static IEqualityComparer<T> EqualityComparerBy<T, K>(
        this IEnumerable<T> source,
        Func<T, K> keyFunc)
    {
        return new KeyEqualityComparer<T, K>(keyFunc);
    }

    public static KeyEqualityComparer<T, K> ThenBy<T, K>(
        this IEqualityComparer<T> equalityComparer,
        Func<T, K> keyFunc)
    {
        return new KeyEqualityComparer<T, K>(keyFunc, equalityComparer);
    }
}

public struct KeyEqualityComparer<T, K>: IEqualityComparer<T>
{
    public KeyEqualityComparer(
        Func<T, K> keyFunc,
        IEqualityComparer<T> equalityComparer = null)
    {
        KeyFunc = keyFunc;
        EqualityComparer = equalityComparer;
    }

    public bool Equals(T x, T y)
    {
        return ((EqualityComparer == null) || EqualityComparer.Equals(x, y)) &&
                EqualityComparer<K>.Default.Equals(KeyFunc(x), KeyFunc(y));
    }

    public int GetHashCode(T obj)
    {
        var hash = EqualityComparer<K>.Default.GetHashCode(KeyFunc(obj));

        if (EqualityComparer != null)
        {
            var hash2 = EqualityComparer.GetHashCode(obj);

            hash ^= (hash2 << 5) + hash2;
        }

        return hash;
    }

    public readonly Func<T, K> KeyFunc;
    public readonly IEqualityComparer<T> EqualityComparer;
} 
```

更多细节在我们的网站上：*[IEqualityComparer in LINQ](http://www.nesterovsky-bros.com/weblog/2014/07/10/IEqualityComparerInLINQ.aspx)*。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2016-08-22T17:45:16.810

如果您不想将 MoreLinq 库添加到您的项目中只是为了获得`DistinctBy`功能，那么您可以使用接收参数的 Linq`Distinct`方法的重载来获得相同的最终结果`IEqualityComparer`。

您首先创建一个通用的自定义相等比较器类，该类使用 lambda 语法来执行通用类的两个实例的自定义比较：

```
public class CustomEqualityComparer<T> : IEqualityComparer<T>
{
    Func<T, T, bool> _comparison;
    Func<T, int> _hashCodeFactory;

    public CustomEqualityComparer(Func<T, T, bool> comparison, Func<T, int> hashCodeFactory)
    {
        _comparison = comparison;
        _hashCodeFactory = hashCodeFactory;
    }

    public bool Equals(T x, T y)
    {
        return _comparison(x, y);
    }

    public int GetHashCode(T obj)
    {
        return _hashCodeFactory(obj);
    }
} 
```

然后在你的主代码中你像这样使用它：

```
Func<Person, Person, bool> areEqual = (p1, p2) => int.Equals(p1.Id, p2.Id);

Func<Person, int> getHashCode = (p) => p.Id.GetHashCode();

var query = people.Distinct(new CustomEqualityComparer<Person>(areEqual, getHashCode)); 
```

瞧！:)

以上假设如下：

*   属性`Person.Id`是类型`int`
*   该`people`集合不包含任何空元素

如果集合可以包含空值，那么只需重写 lambdas 以检查空值，例如：

```
Func<Person, Person, bool> areEqual = (p1, p2) => 
{
    return (p1 != null && p2 != null) ? int.Equals(p1.Id, p2.Id) : false;
}; 
```

**编辑**

这种方法类似于 Vladimir Nesterovsky 的答案，但更简单。

它也类似于 Joel 的答案，但允许涉及多个属性的复杂比较逻辑。

但是，如果您的对象只能在那时有所不同，`Id`那么另一个用户给出了正确的答案，您需要做的就是覆盖您的类中的默认实现，`GetHashCode()`然后只需使用Linq的开箱即用方法进行过滤出任何重复。`Equals()``Person``Distinct()`

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2018-09-27T20:31:34.757

覆盖**Equals(object obj)**和**GetHashCode()**方法：

```
class Person
{
    public int Id { get; set; }
    public int Name { get; set; }

    public override bool Equals(object obj)
    {
        return ((Person)obj).Id == Id;
        // or: 
        // var o = (Person)obj;
        // return o.Id == Id && o.Name == Name;
    }
    public override int GetHashCode()
    {
        return Id.GetHashCode();
    }
} 
```

然后只需调用：

```
List<Person> distinctList = new[] { person1, person2, person3 }.Distinct().ToList(); 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2013-10-21T00:47:18.107

与其他 .NET 版本兼容的最佳方法是覆盖 Equals 和 GetHash 来处理此问题（请参阅堆栈溢出问题*[此代码返回不同的值。但是，我想要的是返回一个强类型的集合，而不是匿名类型](https://stackoverflow.com/questions/7336275/linq-distinct-c-sharp)*），但是如果您需要在整个代码中通用的东西，那么本文中的解决方案非常棒。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-05-16T10:42:56.880

```
List<Person>lst=new List<Person>
        var result1 = lst.OrderByDescending(a => a.ID).Select(a =>new Player {ID=a.ID,Name=a.Name} ).Distinct(); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-28T20:49:52.810

您应该能够覆盖 Person 上的 Equals 以在 Person.id 上实际执行 Equals。这应该会导致您所追求的行为。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-07-28T20:06:04.707

如果你使用旧的 .NET 版本，扩展方法不是内置的，那么你可以定义你自己的扩展方法：

```
public static class EnumerableExtensions
{
    public static IEnumerable<T> DistinctBy<T, TKey>(this IEnumerable<T> enumerable, Func<T, TKey> keySelector)
    {
        return enumerable.GroupBy(keySelector).Select(grp => grp.First());
    }
} 
```

使用示例：

```
var personsDist = persons.DistinctBy(item => item.Name); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-11-07T09:56:40.620

可能这会有所帮助，试试这个。使用 HashSet 的代码性能更高。

```
public static IEnumerable<TSource> DistinctBy<TSource, TKey>(this IEnumerable<TSource> source, Func<TSource, TKey> keySelector)
{
    var known = new HashSet<TKey>();
    return source.Where(element => known.Add(keySelector(element)));
} 
```

* * *

## 回答 #23

> 赞同：-4
> 
> 时间：2018-07-16T05:26:30.017

请尝试使用以下代码。

```
var Item = GetAll().GroupBy(x => x .Id).ToList(); 
```

# asp.net - 好的或坏的做法，在视图中使用常规 html

> ID：489262
> 
> 赞同：3
> 
> 时间：2009-01-28T20:46:03.630
> 
> 标签：asp.net, html, asp.net-mvc

由于习惯使用 html，我发现在我的视图中使用常规 html 更容易，例如，使用`<input type="text" maxlength="30" name="firstname">`<%= html.textbox("firstname") %> 创建一个文本框。或`<form method="post" name="myform">`代替`<% html.beginform() { %>`.

这被认为是不好的做法吗？我应该开始强迫自己使用助手等吗？如果我继续使用常规 html，我会遇到麻烦吗？

只是我想知道，因为我在网上看到的大多数示例和东西都使用了前面提到的所有帮助程序和方法......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T20:56:41.613

我在 PHP 中使用自定义表单助手来制作输入字段。对于一些快速的东西，它们很方便，但是当你需要对一个元素做一些不寻常的事情（添加一些事件和 javascript，嵌入一个内联样式，禁用它）时，辅助函数会妨碍你。我更喜欢拥有真正的 HTML，因为无论如何它最终都会变成这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T21:36:06.417

由于各种原因，我一直使用原始 HTML，并且只有在我需要从我的类中访问它们时才在我的标签上放置一个 runat="server" 属性。

ASP.NET 控件确实很棒，但一段时间后人们（或者可能只是我）通常会发现它们妨碍了您，尤其是在高级场景中或者如果您正在执行一些高级 javascript。而且我们甚至还没有提到视图状态，它很容易在一个带有一些数据的中等大小的页面上占用半兆字节（！）。您只需使用原始 HTML 对您的页面进行更多控制。

所以这可能听起来有点尴尬，但在使用 ASP.NET 控件一段时间后，我已经回到（大部分）原始 HTML。这有点像使用一些非常好的 WYSIWYG 编辑器，然后意识到使用它来完成高级任务实际上比使用记事本需要更多的努力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T21:46:53.290

直接编写 HTML 从来都不是坏习惯。比较两者时；自己写你必须写出你认为合适的 HTML，当使用预制函数时，这些函数会为你生成它们认为合适的 HTML。我会说后者处于不良做法的边缘，具体取决于您对元素的控制程度。显然有些很好，但我发现这些函数中的很大一部分只会导致代码膨胀和/或标签汤。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-25T08:20:00.057

这确实是一个务实的选择，但线索就在名字里——他们被称为“帮手”并不是白白的。

*   如果您正在做简单的标记，那么请继续使用原始 HTML。
*   如果您正在做的事情可能会因路由规则的重组而发生变化，那么请使用帮助程序，它会负责响应这些更改。'BeginForm' 助手就是一个很好的例子。

像生活中的大多数事情一样，使用常识。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T21:43:38.100

Html 助手将通过为您动态创建 html 来帮助您。如果您决定重命名控制器，Html.BeginForm 会自动为您输出正确的 actionurl（一些重载比其他重载更具动态性）。如果您对 actionurl 进行硬编码，当然您将不得不做更多的代码更改。对于 Htmlhelper 和 Webform 控件都是如此。他们只是更有活力。在许多情况下，它们只是为您节省了大量重复的 html 代码，请参阅 mvc grid 或 gridview。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T22:17:49.327

当我第一次使用 MVC 时，我尝试使用 Html Helpers 甚至创建自己的助手。然而，当我尝试在我的应用程序中使用 JQuery/Ajax 时，我倾向于使用越来越多的原始 HTML。我不认为使用原始 HTML 是一种不好的做法。如果您想在客户端进行更多控制，原始 HTML 对我来说似乎是更简单的方法。

# python - Python super() 引发 TypeError

> ID：489269
> 
> 赞同：108
> 
> 时间：2009-01-28T20:47:10.307
> 
> 标签：python, inheritance, python-2.x, super

在 Python 2.5 中，以下代码引发了 a `TypeError`：

```
>>> class X:
      def a(self):
        print "a"

>>> class Y(X):
      def a(self):
        super(Y,self).a()
        print "b"

>>> c = Y()
>>> c.a()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 3, in a
TypeError: super() argument 1 must be type, not classobj 
```

如果我用 替换`class X`，`class X(object)`它将起作用。对此有何解释？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-01-28T20:48:26.683

原因是[`super()`](https://docs.python.org/2/library/functions.html#super)只对[新式类](https://docs.python.org/2/glossary.html#term-new-style-class)进行操作，这在 2.x 系列中意味着从 扩展`object`：

```
>>> class X(object):
        def a(self):
            print 'a'

>>> class Y(X):
        def a(self):
            super(Y, self).a()
            print 'b'

>>> c = Y()
>>> c.a()
a
b 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-01T03:23:05.507

此外，除非必须，否则不要使用 super()。对于您可能怀疑的新型类，这不是通用的“正确的事情”。

有时您期望多重继承并且您可能想要它，但是在您了解 MRO 的毛茸茸的细节之前，最好不要管它并坚持：

```
 X.a(self) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-14T22:48:58.360

如果以上答案都没有明确提及。您的父类需要从“对象”继承，这实际上会将其变成一个新的样式类。

```
# python 3.x:
class ClassName(object): # This is a new style class
    pass

class ClassName: # This is also a new style class ( implicit inheritance from object )
    pass

# Python 2.x:
class ClassName(object): # This is a new style class
    pass

class ClassName:         # This is a old style class
    pass 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-02T10:18:40.420

我尝试了各种 Xa() 方法；但是，它们似乎需要 X 的实例才能执行 a()，所以我做了 X().a(self)，这似乎比以前的答案更完整，至少对于我遇到的应用程序而言。由于存在不必要的构造和破坏，这似乎不是处理问题的好方法，但它工作正常。

我的特定应用程序是 Python 的 cmd.Cmd 模块，由于某种原因，它显然不是 NewStyle 对象。

最后结果：

```
X().a(self) 
```

# asp.net - 使用 Microsoft Velocity 和 Memcached 进行缓存和会话状态管理

> ID：489270
> 
> 赞同：1
> 
> 时间：2009-01-28T20:47:31.880
> 
> 标签：asp.net, memcached, appfabric

我正在查看 Microsoft Velocity 和 memcached 以找到一些会话管理问题的解决方案 -

Microsoft Velocity 提供的缓存、memcached 和会话状态管理之间有什么区别？我的意思是 memcached 和 microsoft velocity 提供分布式缓存功能......所以使用这些来存储会话状态将意味着会话状态也将是分布式的......我在这个假设中是否正确

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T20:55:11.553

缓存会话状态管理之间的区别在于缓存是在应用程序级别（缓存所有会话的数据）。缓存也可以在会话期间多次超时。使用缓存来保存经常使用的信息（即来自查找表的信息）。这样，您的应用程序就不必不必要地访问您的数据源。

# mysql - 将mysql转储sql文件转换为可以导入sqlite3 db的格式的脚本

> ID：489277
> 
> 赞同：20
> 
> 时间：2009-01-28T20:48:12.487
> 
> 标签：mysql, sqlite, mysqldump

我有一个导出 SQL 文件，其中包含来自 MySQL 的表和数据，我想将其导入 Sqlite 3 DB。

最好的方法是什么？

仅通过 sqlite3 工具导入文件是行不通的。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-28T20:51:36.410

这个shell脚本可以帮助你

```
#!/bin/sh
if [ "x$1" == "x" ]; then
   echo "Usage: $0 <dumpname>"
   exit
fi
cat $1 |
grep -v ' KEY "' |
grep -v ' UNIQUE KEY "' |
grep -v ' PRIMARY KEY ' |
sed '/^SET/d' |
sed 's/ unsigned / /g' |
sed 's/ auto_increment/ primary key autoincrement/g' |
sed 's/ smallint([0-9]*) / integer /g' |
sed 's/ tinyint([0-9]*) / integer /g' |
sed 's/ int([0-9]*) / integer /g' |
sed 's/ character set [^ ]* / /g' |
sed 's/ enum([^)]*) / varchar(255) /g' |
sed 's/ on update [^,]*//g' |
perl -e 'local $/;$_=<>;s/,\n\)/\n\)/gs;print "begin;\n";print;print "commit;\n"' |
perl -pe '
  if (/^(INSERT.+?)\(/) {
     $a=$1;
     s/\\'\''/'\'\''/g;
     s/\\n/\n/g;
     s/\),\(/\);\n$a\(/g;
  }
  ' > $1.sql
cat $1.sql | sqlite3 $1.db > $1.err
ERRORS=`cat $1.err | wc -l`
if [ $ERRORS == 0 ]; then
  echo "Conversion completed without error. Output file: $1.db"
  rm $1.sql
  rm $1.err
    rm tmp
else
   echo "There were errors during conversion.  Please review $1.err and $1.sql for details."
fi 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-24T22:11:57.083

为了使上述脚本正常工作，我进行了以下更改：

1.  用#!/bin/bash 运行它
2.  将两个 sed 添加到流水线 sed 列表中：
    *   sed 's/\\r\\n/\\n/g'
    *   sed 's/\\"/"/g'
3.  'rm tmp' 行是无操作的（除非你有一个名为 'tmp' 的文件在 :O 周围）
4.  我的 mysqldump 命令如下所示：

    $ mysqldump -u usernmae -h host --compatible=ansi --skip-opt -p database_name > dump_file

然后它工作得很好......感谢脚本。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-03-25T04:23:05.233

我尝试了其中一些使用 sed 或 awk 的脚本，但总是出现错误，可能是由于我的 MySQL 数据库的索引和外键以及所需的 mysqldump 选项。

然后我找到了 Perl 模块[SQL::Translator](http://search.cpan.org/~jrobinson/SQL-Translator-0.11010/) “将特定于供应商的 SQL 表定义转换为其他格式......”
该模块创建所有外键并更正索引，必要时更改名称。

所以，我重写了 shell 脚本，包括 MySQL 数据库的转储。有两个转储，因为脚本“sqlt”只生成结构并且在转储没有数据的情况下工作得很快。请注意，它可以适应 SQL::Translator 支持的其他转换。

在我发布了这个 shell 脚本之后，我意识到问题是要转换一个 MySQL 转储文件，所以我使用模块 SQL::Translator 做了一个 Perl 脚本来做这件事。在我的测试中，我使用了一个不带选项生成的转储文件（*mysqldump -u user --password database > dumpfile*）。我对字符集没有任何问题。

在其他测试中，我遇到了 mysql 触发器的问题，因此我更改了脚本以跳过它。

```
#!/bin/sh
#===============================================================================
#         USAGE: ./mysql2sqlite.sh <MySQL_database> <user>
#   DESCRIPTION: Converts MySQL databases to SQLite
#                Triggers are not converted
#  REQUIREMENTS: mysqldump, Perl and module SQL::Translator, SQLite 
#===============================================================================
if [ "$#" = 2 ]; then
    USER="$2"    
else
    echo "Usage: $0 <MySQL_database> <user>"
    exit
fi
if [ -s $1.db ]; then
    read -p "File <$1.db> exists. Overwrite? [y|n] " ANS
    if [ "$ANS" = "y" ] || [ "$ANS" = "Y" ] ; then
        rm $1.db 
    else 
        echo "*** Aborting..."
        exit
    fi
fi   
# extracts the necessary structure for SQLite:
mysqldump --skip-triggers --skip-add-locks --routines --no-data --compatible=ansi \
    --compact -u $USER --password $1 > /tmp/$1_$$_str.sql
# verify
if [ ! -s /tmp/$1_$$_str.sql ]; then
    echo "*** There are some problem with the dump. Exiting."
    exit
fi
# translates MySQL syntax structure to SQLite using the script "sqlt" of the
# perl module SQL::Translator (that corrects the foreign keys, indexes, etc.)
sqlt -f MySQL -t SQLite --show-warnings /tmp/$1_$$_str.sql \
    1> /tmp/$1_$$.sqlite 2> /tmp/$1_$$_sqlt.log
# verify
if [ ! -s /tmp/$1_$$.sqlite ]; then
    echo "*** There are some problem with the sql translation. Exiting."
    exit
fi
# adds statements to allow to load tables with foreign keys:
echo "PRAGMA foreign_keys=OFF;" >> /tmp/$1_$$.sqlite
echo "BEGIN TRANSACTION;" >> /tmp/$1_$$.sqlite
# extracts the data (simple inserts) without locks/disable keys, 
# to be read in versions of SQLite that do not support multiples inserts:
mysqldump --skip-triggers --no-create-db --no-create-info --skip-add-locks \
    --skip-extended-insert --compatible=ansi --compact -u $USER \
    --password $1 >> /tmp/$1_$$.sqlite
# adds statements to finish the transaction:
echo "COMMIT;" >> /tmp/$1_$$.sqlite
echo "PRAGMA foreign_keys=ON;" >> /tmp/$1_$$.sqlite
# correct single quotes in inserts
perl -pi -e ' if (/^INSERT INTO/) { s/\\'\''/'\'\''/g; } ' /tmp/$1_$$.sqlite
# load the sql file and generate the SQLite db with the same name 
# of the MySQL database
sqlite3 $1.db < /tmp/$1_$$.sqlite 2> /tmp/$1_$$sqlite.errlog
# verify
ERRORS=`cat /tmp/$1_$$sqlite.errlog | wc -l`
if [ $ERRORS = 0 ]; then
    echo "* Conversion complete. Verify the file < $1.db >"
    rm /tmp/$1_$$*
else
    echo "*** There are some problem. Verify the files < /tmp/$1_$$* >"
fi 
```

这里的 Perl 脚本将转储文件转换为 SQLite 数据库文件。

```
#!/usr/bin/perl 
#===============================================================================
#        USAGE: ./mysql2sqlite.pl <MySQL_dumpfile>
#  DESCRIPTION: Converts MySQL dumpfile to SQLite database
#               Triggers are not converted
#               The dump must be done with
#               > mysqldump --skip-triggers -u [user] --p [database] > dumpfile
# REQUIREMENTS: Perl and module SQL::Translator, SQLite
#===============================================================================
use strict;
use warnings;
use Carp;
use English qw( -no_match_vars );
use SQL::Translator;
use 5.012;

my $file = $ARGV[0];
my $filedb = $file;
$filedb =~ s/\.*[^.]*$/.db/;
if ( -s $filedb ) { 
    say "*** Ja existe o arquivo < $filedb >. Abandonando...";
    exit;
}
my @stru;
my @data;

open( my $SQLFILE, "<", $file )
    or croak "Can't open $file: $OS_ERROR";
while (<$SQLFILE>) {
    # nao considera linhas com comentarios e lock/unlock/drop
    next if ( /^--/ || /^\/\*/ || /^lock/i || /^unlock/i || /^drop/i );
    # processa os inserts
    if (/^(INSERT.+?)[(]/) {     
        my $ins = $1;            # captura o nome da tabela
        s/\\[']/''/g;            # substitue aspas simples - \'
        s/[)],[(]/);\n$ins(/g;   # divide multiplos inserts
        push( @data, $_ );
    }
    # processa a estrutura
    else { push( @stru, $_ ); }
}
close($SQLFILE);

my $strusql = join( '', @stru );
my $datasql = join( '', @data );
#open( my $STRU,   ">", "stru.sql" ); # to verify the results
#open( my $DATA,  ">", "data.sql" );
#print $STRU  $strusql;
#print $DATA  $datasql;

# here the conversion
my $translator = SQL::Translator->new(
    no_comments       => 0,
    show_warnings     => 0,
    quote_table_names => 1,
    quote_field_names => 1,
    validate          => 1,
);
my $struout = $translator->translate(
    from => 'MySQL',
    to   => 'SQLite',
    data => \$strusql,
    # filename => $file,
) or croak "Error: " . $translator->error;

# define inicio e final da transacao de inserts
my $prgini = "PRAGMA foreign_keys=OFF;\n";
my $traini = "BEGIN TRANSACTION;\n";
my $trafin = "COMMIT;\n";
my $prgfin = "PRAGMA foreign_keys=ON;\n";

#gera o arquivo final sqlite
my $sqlout = join( "\n", $struout, $prgini, $traini, $datasql, $trafin, $prgfin);
open( my $FINAL, ">", "/tmp/final.sql" );
print $FINAL $sqlout;

# Monta o SQLite database
my $log = "/tmp/sqlite.errlog";
my $command = "sqlite3 $filedb < /tmp/final.sql 2> $log";
system($command) == 0 or die "system $command failed: $?";
if ( -s $log ) { 
    say "*** Houve algum problema. Verifique o arquivo < /tmp/sqlite.errlog > "; 
}
else { 
    say "*** Conversao completa. Verifique o arquivo < $filedb > "; 
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-28T16:31:03.633

我对 mysql db 是 ISO-8859-1 (Latin-1) 有疑问。何时转换为 sqlite3 假设数据是 UTF-8 导致解码错误。

很容易解决这个问题：

iconv -f ISO-8859-1 -t UTF-8 mysql_dump_file > mysql_dump_file_utf8

万一这有助于某人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-30T06:38:12.710

当 sqlite3 数据库将与 ruby​​ 一起使用时，您可能需要更改：

```
tinyint([0-9]*) 
```

到：

```
sed 's/ tinyint(1*) / boolean/g ' |
sed 's/ tinyint([0|2-9]*) / integer /g' | 
```

唉，这只有一半有效，因为即使您将 1 和 0 插入标记为布尔值的字段，sqlite3 将它们存储为 1 和 0，因此您必须通过并执行以下操作：

```
Table.find(:all, :conditions => {:column => 1 }).each { |t| t.column = true }.each(&:save)
Table.find(:all, :conditions => {:column => 0 }).each { |t| t.column = false}.each(&:save) 
```

但是查看 sql 文件以查找所有布尔值是有帮助的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-16T21:38:00.230

至少，对于 mysql 5.0.x，在将其导入 sqlite3 之前，我必须从 mysql 的转储中删除**collat​​e utf8_unicode_ci 。**所以我修改了脚本，在 seds 列表中包含以下内容：

`sed 's/ collate utf8_unicode_ci/ /g' |`

更新：

MySQL 将布尔字段视为“tinyint(1)”，因此我必须在sed**之前添加以下内容：** `tinyint([0-9]*)`

`sed 's/ tinyint(1) / boolean /g' |`

此外，由于我试图将 mysql 数据库（生产）复制到 Ruby On Rails 应用程序的 sqlite3 数据库（开发），我必须添加以下行以设置自动递增主键：

`sed 's/) NOT NULL/) PRIMARY KEY AUTOINCREMENT NOT NULL/g' |`

我仍在尝试找出一种方法将**KEY**条目从 mysql 更改为其对应的 sqlite3 的**CREATE INDEX**条目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-13T17:36:38.967

为了转换其中包含 BLOB 的数据库，我将 --hex-blob 添加到 mysqldump 命令中，并将以下内容添加到流水线 seds 列表中：-

```
sed -e "s/,0x\([0-9A-Z]*\),/,X'\L\1',/g" | 
```

这将替换 mysql 十六进制转储字符串，例如 0x010A…。with X'010a...' 用于使用 sqlite 导入。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-06-03T22:36:58.477

这是将 ssql 转换为 .db 的最好的书面和有据可查的 shell 脚本

[https://gist.github.com/esperlu/943776](https://gist.github.com/esperlu/943776)

或者更好地使用这个工具它是*惊人的和快速的* **ESF 数据库迁移工具包**。

在这里尝试了所有脚本之后，直到我使用了 esf 工具，它才起作用。

笔记 ：

> ```
> Trial version add a 'T' to the begingn of each text value you have 
>  But the pro version worked like a charm :) 
> ```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-09T00:06:09.057

在 Centos 5.3 64bit 上运行良好。一旦你有输出文件，像这样加载它：

shell> sqlite3 file_name.db SQLite 版本 3.3.6 输入“.help”获取指令 sqlite> .databases seq 名称文件

* * *

0 main /current_directory/file_name.db
sqlite> 从表中选择 *；. . . . . 结果... sqlite>.quit

# .net - 如何从 MDIChild 表单中正确显示对话框（）？

> ID：489281
> 
> 赞同：3
> 
> 时间：2009-01-28T20:48:44.297
> 
> 标签：.net, winforms, mdi, showdialog

我有一个需要显示对话框的 MDIChild 表单。我目前正在从 mdichild 表单中这样做......

```
f.ShowDialog(Me) 
```

我应该使用`f.ShowDialog(mdiparent)`吗？

在调用之前设置所有者有什么区别`ShowDialog()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T22:29:37.977

我不确定这是否相关，但我在 ShowDialog 中传递拥有表单时遇到了一些问题，我通常这样做：

```
f.Owner = Me
f.ShowDialog() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T15:22:16.840

区别在于哪个父级拥有对话框。如果您明确设置父级，则该窗口拥有该对话框。如果您不设置它（使用 ShowDialog 的无参数版本），则应用程序的当前活动窗口拥有该对话框。那是在[MSDN](http://msdn.microsoft.com/en-us/library/w61zzfwe.aspx)上，顺便说一句。

这在通过使用 FormStartPosition.CenterParent 枚举设置 StartPosition 属性来使对话框居中时很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-10T16:13:55.887

它的确有所作为...

我有一个调用 ShowDialog(Me) 的 MDI 子级，在生成的对话框窗口中，Me.Owner 引用了 MDI 容器，而不是 MDI 子级。

使用 Me.Owner.ActiveControl 是一种解决方法，但使用：

```
 Dim ContractForm As New Contract(strType, intMode)
       ContractForm.Owner = Me
       dgrAction = ContractForm.ShowDialog() 
```

得到它很好。在生成的对话框窗口中，Me.Owner 现在确实引用了 MDI 子项。

希望这可以帮助！

# visual-studio - 如何使用 Unicode 从 CString 转换为 unsigned char*？

> ID：489293
> 
> 赞同：1
> 
> 时间：2009-01-28T20:51:07.100
> 
> 标签：visual-studio, visual-studio-2008, visual-c++, string

我正在尝试在这里做一些简单的事情。当我在 Visual Studio 2008 中使用 unicode 字符集执行以下代码时，xmlString 是正确的。

不幸的是，我需要将 CString 转换为 unsigned char*。使用下面的代码，ucStr 变为“<”（即 xmlString 的第一个字符）。

**我应该如何将 CString 转换为 unsigned char* 并保留所有信息？**

```
 CString xmlString;
        xmlString.Format( _T("<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?><gateway><config-read><%s /></config-read></gateway>"), keyName);

        unsigned char * ucStr = reinterpret_cast<unsigned char *> (xmlString.GetBuffer());
        pgIRequest->SendXmlData( "dgv/gateway.xml", ucStr, xmlString.GetLength() + 1) ; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T21:21:03.030

我发现最简单的是使用 CStringA 构造函数，如下所示：

```
 CString xmlString;
    xmlString.Format( _T("<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?><gateway><config-read><%s /></config-read></gateway>"), "test");

    printf("%s\n",xmlString );  // fails "<"

    //unsigned char * ucStr = reinterpret_cast<unsigned char *> (xmlString.GetBuffer());

    CStringA ucStr( xmlString );

    printf("%s\n",ucStr );   // works! 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T21:43:25.527

当您的“keyName”变量开始包含在 ISO-8859-1 编码中无法表示的字符时，此代码段可能不起作用。为此，我建议创建一个以 UTF-8 作为编码值的字符串，使用 WideCharToMultiByte 使用 CP_UTF8 代码页转换为 UTF-8 字节流，然后发送生成的 utf8 字节流。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T21:15:32.433

我认为您想要[wcstombs](http://msdn.microsoft.com/en-us/library/5d7tc9zw(VS.80).aspx)，或者更确切地说，它更安全的对应物[wcstombs_s](http://msdn.microsoft.com/en-us/library/s7wzt4be(VS.80).aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T21:11:22.970

我假设“SendXmlData”想要字节数而不是字符数。

如果是这样，您想将“GetLength() + 1”更改为“(GetLength() + 1)*sizeof(xmlString[0])”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T21:30:52.743

这是最终起作用的代码：

```
CString xmlString;
        xmlString.Format( _T("<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?><gateway><config-read><%s /></config-read></gateway>"), keyName);
        CStringA ucStr( xmlString );
        unsigned char * ucStr2 = reinterpret_cast<unsigned char *> (ucStr.GetBuffer());
        pgIRequest->SendXmlData( "dgv/gateway.xml", ucStr2, xmlString.GetLength() + 1) ;// target on gateway to download 
```

# winforms - 为什么我的 windows 窗体应用程序可以访问互联网？

> ID：489295
> 
> 赞同：0
> 
> 时间：2009-01-28T20:51:12.560
> 
> 标签：winforms

据我所知，我没有在我的 .net windows 窗体应用程序中添加任何互联网访问权限。但每隔一段时间，它就会尝试与 239.255.255.250 建立传出连接。我不知道为什么会这样。它是 .net 框架中的东西吗？

239.255.255.250 的信息：

```
OrgName:    Internet Assigned Numbers Authority 
OrgID:      IANA
Address:    4676 Admiralty Way, Suite 330
City:       Marina del Rey
StateProv:  CA
PostalCode: 90292-6695
Country:    US

NetRange:   224.0.0.0 - 239.255.255.255 
CIDR:       224.0.0.0/4 
NetName:    MCAST-NET
NetHandle:  NET-224-0-0-0-1
Parent:     
NetType:    IANA Special Use
NameServer: FLAG.EP.NET
NameServer: STRUL.STUPI.SE
NameServer: NS.ISI.EDU
NameServer: NIC.NEAR.NET
Comment:    This block is reserved for special purposes.
Comment:    Please see RFC 3171 for additional information.
Comment:    
RegDate:    1991-05-22
Updated:    2002-09-16 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T20:55:30.087

我想这没什么大不了的。供您观赏的参考资料：

*   [http://www.nthelp.com/upnpscrewup.htm](http://www.nthelp.com/upnpscrewup.htm)
*   [http://forums.snapstream.com/vb/showthread.php?p=129675](http://forums.snapstream.com/vb/showthread.php?p=129675)
*   [http://www.google.com/search?hl=en&q=239.255.255.250&btnG=Google+搜索](http://www.google.com/search?hl=en&q=239.255.255.250&btnG=Google+Search)

给你的问题：

*   你怎么知道这是你的 Windows 应用程序？**区域警报。**
*   你在使用多播吗？**不。**
*   您是否正在运行任何多播应用程序或可能使用 uPNP 的应用程序？**不。**
*   您是否正在使用您的应用程序*进行*网络连接？如果是这样，您使用的是什么类？

下次看到警报时试试这个：

```
Start> Run> cmd.exe:
netstat /b /o 
```

这可能会为您提供有关警报来自何处的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T20:56:19.973

^^被打败了

您是否在计算机上启用了 UPnP？这是 Windows 尝试访问该 IP 地址的主要原因。

# user-interface - 操作系统用户界面指南：何时忽略？

> ID：489302
> 
> 赞同：9
> 
> 时间：2009-01-28T20:52:53.117
> 
> 标签：user-interface

[这个答案](https://stackoverflow.com/questions/98310/focus-follows-mouse-plus-auto-raise-on-mac-os-x#100142)中的一句话，“*习惯于按自己的方式使用 Mac* ”，让我有点吃惊，让我开始思考我很久以前思考过的事情，但仍然没有想出一个好的答案.

对于如何开发应用程序的界面，每个操作系统都有自己的指导方针，以使其适合操作系统，从而适应用户的心态。

虽然没有人真正在很大程度上强制执行此操作（除了通常的“为 xyz OS 制造”程序），但让我感到困扰的是，在开发一个建议与操作系统建议不同的功能的应用程序时，我必须做出选择。可能是应用程序本身使用不同的用户界面更好，也可能是由于实现，例如作为 web 应用程序或跨平台。

**应用程序与操作系统：**

*   如果我选择根据这些 UI 建议进行开发，假设我有充分的理由这样做，会有什么后果？

**Web 应用程序与操作系统：**

*   如果我正在开发一个旨在像桌面应用程序一样使用的 web 应用程序，我该怎么办：
    *   开发并遵循我自己的约定（或主要操作系统约定之一）
    *   检查用户的操作系统并遵循该约定（因此即使使用相同的帐户，用户也会在不同的计算机上获得不同的体验）
    *   遵循另一个主要 webapp 的约定（gmail/docs、live 等）

**跨平台与操作系统：**

*   在开发跨平台的应用程序时
    *   遵循一个操作系统的约定
    *   根据运行的操作系统，使用遵循大多数操作系统约定的跨平台库，尽管没有一个是完美的
    *   完全原生的每个操作系统的自定义界面

我意识到这在很大程度上取决于可用的资源和其他各种不可知因素，但是在考虑此选择时，您使用的考虑因素、策略和论点是什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T21:03:26.137

我记得一些应用程序坚持跨平台保持相同的外观和感觉，在平台之间移动时吹捧各种好处。问题是大多数人不会在不同平台上使用一个应用程序，而是在一个平台上使用多个应用程序。如果其中一个应用程序的行为与基于他们使用的所有其他应用程序的预期明显不同，他们就不会喜欢它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-29T15:14:19.207

一般规则是，当您有令人信服的理由相信偏离会导致用户性能的净改善时，您可以偏离平台的风格指南。即偏差为用户提供的收益大于成本。

“令人信服的理由”通常是指经验证据——​​确认偏差净改善的可用性测试数据。设计师的直觉不够好。大多数操作系统指南不是任意的，而是与替代品相比的用户性能优势相关联，可能包括您正在考虑的那个。应制定可用性测试以实际评估性能成本和收益，以便可以对它们进行定量比较。领带去遵循风格指南。

即使指南是任意的，任何偏差仍然存在与外部不一致相关的成本，这种成本可能难以量化，但必须通过设计人员的判断来考虑。外部不一致性成本主要是努力学习偏差以及与尝试在其他应用程序的上下文中使用偏差相关的错误。如果提供培训和/或使用频率很高（后者证明学习开销是合理的），则学习的有效成本会更低。偏差的错误频率与应用程序使用的频率和上下文相关。如果您的应用程序被广泛使用并且与平台的其他应用程序分开使用，那么错误的有效成本就会降低。根据经验，除非用户每天使用您的应用数小时，

一般来说，UI*行为*不一致是比 UI*外观*不一致更严重的问题。此外，*矛盾*（看起来像风格指南中的东西但含义不同的东西）比*不规则*（看起来与风格指南中的东西不同但含义相同的东西）更严重。

对于应用程序而言，与操作系统样式指南的一致性通常比与 Web 约定的一致性更重要，因为 Web 约定在功能上较弱，适用于用户可能遇到的较少应用程序。除非您的大多数用户使用单个应用程序并且单个应用程序与您的应用程序一起使用，否则不应以牺牲操作系统指南为代价来遵循 Gmail 等单个应用程序的约定。为了获得最大的可用性，您应该遵循用户使用的任何操作系统的指南。没有替代品。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T21:03:53.733

我认为这里没有一个很好的答案，除了尽你所能遵循你所针对的平台的事实上的约定。如果您正在开发具有丰富 GUI 的 Web 应用程序，您仍然应该尝试遵循一般的 Web 设计原则。

如果您有一个多平台应用程序并且您不能为每个应用程序设置不同的前端，您可以尝试将各个平台的约定融合在一起，但也许遵循您将拥有最多用户的平台的约定。

**在打破规则之前，您必须了解规则。**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T21:13:24.590

我认为总体思路是给用户一种熟悉感。因此，最好让您的应用程序的行为与您目标平台上的任何应用程序一样。在 Mac OS X 上尤其如此，其中 OS、Apple 应用程序和第三方应用程序具有一致的外观和感觉（当然存在例外，但被认为是这样的：不是平台上最好的用户体验）。

对于 Web 应用程序，一致性存在于所有 Web 应用程序中，其规则似乎是*创造力*（如游戏或 DVD）。通常它会起作用。

对于跨平台应用程序，我建议使用一个通用核心（例如，带有文件、编辑、查看、...帮助的应用程序菜单），以及每个平台的特性。

# ruby-on-rails - 在 Rails 上请求跟踪器？

> ID：489303
> 
> 赞同：3
> 
> 时间：2009-01-28T20:53:06.160
> 
> 标签：ruby-on-rails, ruby

我正在构建一个应用程序，它必须处理和存储大量电子邮件（每天大约 2-4 千封），全世界很多人都需要以各种方式查看和处理这些电子邮件。听起来像票务系统，对吧？有一个转折——我有一个单独的应用程序，它为将要处理这些电子邮件的人处理大量的处理，它需要提取大量与它们相关的专业信息。例如，特定客户的信息将在处理应用程序中（联系信息等），当有人查看该信息时，他们还需要知道是否有任何未处理的票证，他们是否以及如何回复我们发送的特定电子邮件等。

我在将 RT（请求跟踪器）作为票务系统方面拥有丰富的经验，并且相信它可以处理电子邮件的数量并按照我们需要的方式对其进行分类。但是，我的处理程序是在 Ruby on Rails 中。我已经用 Perl（RT 是用它编写的）做了一些工作，但并不多，而且我以前从未尝试过让 Ruby 与 Perl 对话。我知道 RT 有一个 API，我正在努力通过它，但我想知道是否已经有一个好的解决方案？我只需要将数据从 RT 提取到我的 Rails 应用程序中，无需编写。

还是我在叫错树？我应该尝试一个已经在 Rails 上运行良好的票务系统吗？我是否应该直接从数据库中提取数据，因为我只是在读取它？只是寻找一些输入，如果这是以前尝试过的任何东西。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T00:35:28.847

RT 的 web API 是球——我们在工作中使用它来连接我们自己的东西（主要是 Python webapps）。我不建议使用它，除非你真的热衷于痛苦和痛苦。

直接进入数据库虽然仍然有点痛苦，但到目前为止是较小的邪恶。据我所知，没有关于结构的文档，它可能会在不同版本之间改变，但至少数据库模式是你之前可能处理过的东西，因此有一些经验。AR 可能不会与它交谈，因为 IIRC 有复合主键（或者现在支持 AR 中的主键？我不记得了），但原生 DB 适配器并不疯狂处理。

# reflection - 根据构建目标在编译时加载不同的程序集

> ID：489304
> 
> 赞同：5
> 
> 时间：2009-01-28T20:53:12.460
> 
> 标签：reflection, c#-3.0

我想根据构建目标加载四个单独的 C# 程序集之一。这将进入一个带有 .net framework 3.0 的 web 服务。

可能性：

32 位调试：AmtApiWrapper32d.dll

32 位版本：AmtApiWrapper32.dll

64 位调试：AmtApiWrapper64d.dll

64 位版本：AmtApiWrapper64.dll

这些包装器是一个单独的 C++ 项目，它包装了我编写的 C Native DLL。C/C++ 是我常用的平台，所以如果这是一个小问题，请原谅。

所有包装 DLL 都包含完全相同的函数和相同的原型。除了这个之外，它们还用于许多其他目的，所以除非这真的很糟糕，否则设置保持不变。

所以，我想在编译时加载其中一个。我查看了反射、GetDelegateForFunctionPointer 和其他一些东西，它们看起来都很相似，但对于这个简单的任务来说过于复杂。有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T21:09:38.653

这绝对是可能的，但你必须涉足构建文件。

你会想要这样的东西：

```
<ItemGroup Condition=" '$(Configuration)' == '32-bit debug' ">
  <Reference Include="AmtApiWrapper32d">
</ItemGroup>
<ItemGroup Condition=" '$(Configuration)' == '32-bit release' ">
  <Reference Include="AmtApiWrapper32">
</ItemGroup>
<ItemGroup Condition=" '$(Configuration)' == '64-bit debug' ">
  <Reference Include="AmtApiWrapper64d">
</ItemGroup>
<ItemGroup Condition=" '$(Configuration)' == '64-bit release' ">
  <Reference Include="AmtApiWrapper64">
</ItemGroup> 
```

我建议你无条件地让*其中一个*工作，然后看看参考到底是什么样的。

那就是如果您想将其添加为构建时参考。如果您想在 P/Invoke 声明中使用它，只需在适当的属性周围使用`#if SYMBOL`/ 。`#endif`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T21:08:51.057

您是否尝试过使用预编译器指令并在构建目标中定义不同的变量？

IE

```
#ifdef 32bdebug
<load dll here>
#endif 
```

自从我使用 C# 以来已经有一段时间了，但这应该在编译时工作。它是 C# 对 C 和 C++ 的一种借鉴。

# openid - 将用户 ID 存储在 Principal 或 Identity 中？ASP.Net/OpenID

> ID：489306
> 
> 赞同：3
> 
> 时间：2009-01-28T20:53:39.387
> 
> 标签：openid, membership, iprincipal, iidentity

我有一个使用表单身份验证的 ASP.Net MVC Web 应用程序。我正在使用 OpenID 进行身份验证。

目前，我将 openID url 存储在`Name`standard 中`GenericIdentity`。我还希望能够轻松访问用户的数据库 ID。

我可以通过覆盖该`Application_AuthenticateRequest`函数来制作自定义提供者或身份。

我的问题是用户的数据库 uid 应该进入主体还是身份？

Identity 的 Name 属性应该是 openid url（用户可以有很多，但我想在每个页面上显示它）还是数据库 uid？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T21:02:05.283

我现在在想，我应该只将用户 ID 存储在 Identity 中，然后在 Session 中保留 openid url。

这样我就不需要自定义身份或主体。

# command-line - 为什么 Borland C++ Builder 5 命令行编译器找不到我的文件？

> ID：489308
> 
> 赞同：1
> 
> 时间：2009-01-28T20:53:44.660
> 
> 标签：command-line, c++builder

我有一个正在尝试使用 make.exe 编译的 bcb5 项目组。Make 似乎运行良好并生成对 bcc32.exe 的调用，但失败了。这是对 bcc32.exe 的调用，然后是错误。

```
M:\projects\Project>"D:\Program Files\Borland\CBuilder5\Bin\bcc32.exe" -Od
-H=.\obj_files\vcl50.csm -Hc -Vx -Ve -X- -a8 -5 -b- -k- -vi -c -tW   -tWM -w
-par -IP:\b5\crc32\ISC\;Query;Z:\Bin\;Help;pas;D:\PROGRA~1\Borland\CBUILD~1\bin\
..\include;D:\PROGRA~1\Borland\CBUILD~1\bin\..\include\vcl;DataCenter;"P:\b5\Gif
Image\" -D;NO_STRICT;_RTLDLL -nobj_files\ help\chelp.cpp

Borland C++ 5.5.1 for Win32 Copyright (c) 1993, 2000 Borland

Error E2266: No file names given 
```

在我看来，该文件显然是“chelp.cpp”。这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T21:09:45.983

谢谢你的想法，司徒。它很接近，但实际问题是 P:\bg\Gif Image 周围的引号集。将它们更改为单引号可以解决问题。

我相信这也可以通过 FixMake 解决：http: [//www.grassvalleysoftware.com/](http://www.grassvalleysoftware.com/)。FixMake 需要一个 makefile 并清理诸如尾随反斜杠和转义引号之类的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T20:56:48.773

猜测是`-nobj_files\`（接近命令末尾）导致下一个空间被释放。尝试 excaping`\`或删除它。

# visual-studio-2008 - Visual Studio find 找不到所有可能性

> ID：489309
> 
> 赞同：9
> 
> 时间：2009-01-28T20:53:53.460
> 
> 标签：visual-studio-2008, find, replace

最近，我开始注意到当我搜索整个解决方案时，Visual Studio 2008 并没有找到我搜索的文本的所有实例。它将开始搜索文件以查找术语，但在某些时候，它会停止搜索其他文件，并开始仅在两个文件之间交替。这很烦人，因为我不能总是找到我要找的东西。事实上，更糟糕的是，有时搜索根本找不到我知道存在的术语，所以我会关闭搜索表单，切换文档，再次运行搜索，就会找到该术语。

请注意，在上述所有情况下，我都在搜索整个解决方案。

有没有人有这方面的经验？如果是这样，你是如何解决的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-09-14T14:04:07.947

是的。如果打开了许多文档（选项卡）并且您在当前项目或整个解决方案中搜索，“查找下一个”通常会被破坏。

解决方法：使用“查找全部”（`Ctrl`++ `Shift`）`F`，它在多个文件中是可靠的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T21:45:50.093

这确实很烦人。这在我使用 VS2003 时发生过，但不久之后我升级到了 VS2005，所以我从未尝试过修复它。我进行了搜索，以下是[一些可以](http://forums.asp.net/t/1103223.aspx)帮助您入门的方法：

*   运行 devenv /resetsettings
*   Window menu-->Select Reset Window Layout（不知道为什么会有帮助？）
*   修复VS2008，如果失败尝试重新安装。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-07-18T06:54:27.137

在我的情况下，“在文件中查找”功能完全停止工作。“重新安装 Windows/Visual Studio！” 我立刻想到了。但是有一个更简单的解决方案对我有用：在椅子上旋转 3 次，拍手两次，然后按 Control + Scroll Lock。

资料来源： http: [//geekswithblogs.net/claraoscura/archive/2008/10/17/125902.aspx](http://geekswithblogs.net/claraoscura/archive/2008/10/17/125902.aspx) [http://bloggingabout.net/blogs/edward/archive/2005/01/31/2136.aspx](http://bloggingabout.net/blogs/edward/archive/2005/01/31/2136.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T21:10:49.057

你有没有“检查”搜索隐藏文本？这通常是问题

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-25T21:19:29.807

这对我有用：

**首先**：`CTRL`++ `SHIFT`-`F`然后选择当前文档。我确保文本出现在该文件中。它应该在当前文档中找到文本。

**第二**：交换搜索回搜索整个解决方案，它将搜索整个解决方案。

希望这可以帮助某人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-29T23:30:42.950

万一其他人遇到这个问题并且无法解决它，我找到了一个意想不到的解决方案。

我必须通过很多组合来解决这个问题，包括但不限于对 Visual Studio 进行修复、卸载 Visual Studio、重新安装、禁用所有加载项、在安全模式下运行等。没有一个但是，这有效，包括完全卸载和重新安装 Visual Studio。

我的问题是，如果在“查找选项”中选中“向上搜索”复选框，则对整个解决方案的搜索将失败。在最极端的例子中，如果您关闭所有文档，然后搜索“a”（不带引号）或选中“使用正则表达式”复选框/下拉菜单并搜索“.*”（同样，不带引号），您将仍然没有结果。

但是，如果您取消选中“向上搜索”复选框，那么一切似乎都可以正常工作。

我不知道这个问题会适用于多少其他人，但我猜其他人也一定会被这个问题困扰。

关于这个主题的另外两个相关主题：

1.  [查找和替换不会搜索整个解决方案（ASP 论坛）](http://forums.asp.net/t/1284204.aspx)

2.  [整个解决方案中的 VS 2008 替换仅适用一次 (Microsoft Connect)](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=439375&wa=wsignin1.0#tabs)

我希望这可以帮助某人...

麦克风

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-19T14:25:23.273

我发现的另一件事是准确地添加你正在寻找的东西——最好是在一个会破坏语法的地方，这样你以后可以通过构建找到它——然后搜索。这将打破查找的周期性查找。我有很多次，它只发现了两次无休止的事件。

搜索 .error

文件 1 类

```
private blah()
{
  something something = ".error";
} 
```

文件 2 css

```
.error
{
... 
```

快速修复：文件 1

```
private blah()
{
  something something = ".error";
} 
.error //syntax error will show up in your errors list to find it quickly 
```

搜索现在有效

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-02T09:52:25.133

我在 Visual Studio 2010 中尝试了以下操作：

*   `Ctrl`+ `Shift`+`F`

*   `Ctrl`+`Break`

*   运行 devenv /resetsettings

*   Window menu-->Select Reset Window Layout（不知道为什么会有帮助？）

*   `Control`+`Scroll Lock`

*   重新启动 Visual Studio

但这些都不起作用。

我的解决方案是使用“查找全部”（`Ctrl`++ `Shift`）`F`，但单击“快速替换”选项卡而不是“在文件中查找”，然后单击下一步查找。

对于大型项目，这个解决方案是不够的，它只是一个紧急解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-09T08:52:35.197

按`Control`+`Scroll Lock`

如果您没有通过搜索`CTRL`++找到结果，这可能会对您有所`SHIFT`帮助`F`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-10-16T20:43:27.057

1.  CTRL + SHIFT + F
2.  选择“整个解决方案（包括外部项目）”

在我的情况下，“整个解决方案”在 VS Professional 2013 中忽略了 .config 文件（我们有 100 个）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-11-24T16:57:56.873

我试图在我知道存在的“整个解决方案”中查找文本，因为我可以看到当前打开的文件的实例。然而它说没有找到任何结果，并且它只搜索了 67 个文件，尽管我的解决方案中有近 800 个文件。原来“查看这些文件类型：”下拉列表中输入了我几天前搜索的文本 (*.js)。起初我没有注意到这一点，因为我认为您必须选中一个复选框才能启用该选项。野餐...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-03-23T15:02:11.783

我有一个头文件搜索永远看不到。我通过“添加->现有项目”解决方案资源管理器的标题解决了这个问题。

# ruby-on-rails - 对于我的一个模型，我有一些应该自动填充的实例。我该如何处理？

> ID：489316
> 
> 赞同：2
> 
> 时间：2009-01-28T20:56:07.650
> 
> 标签：ruby-on-rails, ruby, database, model, constants

我必须具体说明这一点。在我的应用程序中，我有一个名为主题的模型，其中包含小部件颜色主题信息。我们提供了一些主题，但主要依靠用户创建自己的主题。所以问题是：我在哪里存储我的主题？如果我将它们存储在主题数据库中，那么每当我在测试期间切换数据库或刷新它时，我都必须重新输入主题。这不是什么大不了的事，只是看起来很草率。

现在我将主题存储在控制器的哈希中。这样做的问题是因为每个小部件都有一个主题，每个小部件都有一个主题 ID，并且我们提供的主题没有主题 ID，因为它们没有存储在数据库中。

我知道这个问题的解决方案非常简单，但我想确保我的解决方案采用最佳编码实践。有人对此有什么建议吗？也许有一种方法可以在迁移或其他 rake 任务期间将条目添加到数据库中......

谢谢！

托尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T07:59:48.740

在迁移中加载种子数据是最有意义的，也是我经常做的事情。如果创建前几条记录确实是正确初始化表的一部分，即如果没有它们，您的表根本无法完成应用程序中所需的工作，那么它们属于迁移。Rake 任务非常适合捕获您需要根据命令加载到应用程序中的数据集（例如，对于演示），但如果始终需要某些记录，那么迁移就是当场。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T21:09:15.393

主题数据属于数据库。

对于测试，使用夹具或方法初始化主题数据`setup`。对于开发和生产，您应该创建一种使用初始主题数据播种数据库的方法。自定义 Rake 任务对此很有用。实际的主题数据可以以您希望的任何格式存储，真的。例如 SQL 脚本或[YML 固定装置](http://quotedprintable.com/2007/11/16/seed-data-in-rails)。

我使用以下 Rake 任务使用 db/seeddata 中的 SQL 文件中保存的数据为数据库播种（将其放在项目的 /lib 目录下的 .rake 文件中）：

```
namespace :db do
  desc "Load seed fixtures (from db/seeddata) into the current environment's database." 
  task :seed => :environment do
    require 'yaml'
    config = YAML::load(open("#{RAILS_ROOT}/config/database.yml"))["#{RAILS_ENV}"]
    Dir.glob(RAILS_ROOT + '/db/seeddata/*.sql').each do |file|
      cmd = "mysql -u #{config['username']} -p#{config['password']} -h #{config['host']} #{config['database']} < #{file}"
      `#{cmd}`
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T21:41:55.263

您播种数据的想法似乎是可行的方法。我喜欢你提出的方法，但你觉得这里提出的方法如何： [http ://railspikes.com/2008/2/1/loading-seed-data](http://railspikes.com/2008/2/1/loading-seed-data)

它建议您让 ActiveRecord 处理播种数据，以便它可以验证数据。

你认为哪一个更好？

再次感谢！

托尼

# c# - 如何在 C# 中传递任意数量的参数

> ID：489317
> 
> 赞同：3
> 
> 时间：2009-01-28T20:56:10.303
> 
> 标签：c#, arrays, parameters

好的，我需要设计一种方法来跟踪每个项目的存在数量。大约有 26 个项目。我还需要一种方法来确定是否存在某种项目组合。

例如，这是一个纸牌游戏的引擎。每张卡片都有不同的类型，每张卡片都可以附有卡片。需要有特定的卡片组合附加到一张卡片上，以便玩家在游戏中做某些事情。为了简化这个程序，我想做类似的事情

```
if (meetsCrit(2, water, 4, ground))
{
    do this()
}
else
{
    displayerror()
} 
```

**编辑：**解决了！

我使用了下面几篇文章中描述的技术组合。特别提及：

乔恩·斯基特、里纳特·阿卜杜林、弗兰克、

无论如何，这就是我所做的，我创建了一个名为 pair 的类，其中存储了我正在寻找的类型以及该类型的数量。然后我使用 Predicate Delegate 查找所有该类型并计算有多少，然后我将它与我正在搜索的数字进行比较并分别返回 true 或 false。

这是它的代码

```
public bool meetsCrit(params Pair[] specs)
{
    foreach (Pair i in specs)
    {
        if (!(attached.FindAll(delegate(Card c) { return c.type == i.type; }).Count >= i.value))
        {
            return false;
        }

    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-28T20:59:00.780

使用[参数](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/params)：

> **params**关键字允许您指定一个[方法参数](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/method-parameters)，该参数接受一个参数，其中参数的数量是可变的。

**在方法声明中params**关键字之后不允许有其他参数，并且在方法声明中只允许一个**params**关键字...

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-28T21:05:58.007

使用 params 关键字传递可变数量的参数：

```
 private static void HowMayItems<T>(params T[] values) {
        foreach (T val in values) { 
            //Query how many items here..
        }
    } 
```

您还可以创建一个 Predicate 并将其传递给 params 过滤器。在该方法中，您可以返回所有结果的并集。像这样的东西：

```
public class Item { 
    public string Name { get; set; }
}
public class ItemFilter {
    public string Name { get; set; }
    public ItemFilter(string name) {
        Name = name;
    }
    public bool FilterByName(Item i) {
        return i.Name.Equals(Name);
    }
}

public class ItemsTest {
    private static List<Item> HowMayItems(List<Item> l,params ItemFilter[] values)
    {
        List<Item> results= new List<Item>();
        foreach(ItemFilter f in values){
            Predicate<Item> p = new Predicate<Item>(f.FilterByName);
            List<Item> subList = l.FindAll(p);
            results.Concat(subList);
        }
        return results;
    }
} 
```

编辑：

好的，我的混合坚果版本怎么样 :)：

```
public enum ItemTypes{
    Balloon,
    Cupcake,
    WaterMelon
    //Add the rest of the 26 items here...
}

public class ItemFilter {
    private ItemTypes Type { get; set; }
    public ItemFilter(ItemTypes type) {
        Type = type;
    }
    public bool FilterByType(ItemTypes type) {
        return this.Type == type;
    }
}

public class PicnicTable {
    private List<ItemTypes> Items;

    public PicnicTable() {
        Items = new List<ItemTypes>();
    }

    public void AddItem(ItemTypes item) {
        Items.Add(item);
    }

    public int HowMayItems(ItemTypes item)
    {
        ItemFilter filter = new ItemFilter(item);
        Predicate<ItemTypes> p = new Predicate<ItemTypes>(filter.FilterByType);
        List<ItemTypes> result = Items.FindAll(p);
        return result.Count;
    }
}

public class ItemsTest {
    public static void main(string[] args) {
        PicnicTable table = new PicnicTable();
        table.AddItem(ItemTypes.Balloon);
        table.AddItem(ItemTypes.Cupcake);
        table.AddItem(ItemTypes.Balloon);
        table.AddItem(ItemTypes.WaterMelon);
        Console.Out.WriteLine("How Many Cupcakes?: {0}", table.HowMayItems(ItemTypes.Cupcake));
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-28T21:05:26.697

params 数组是显而易见的答案。另一种方法是创建一个类来表示标准。然后，您可以使用集合初始化程序，例如：

```
bool result = myCollection.Contains(new Criteria {
                 { 2, Item.Balloon },
                 { 4, Item.Cupcake }
              }); 
```

但是，如果这也没有用，我们肯定需要在问题中提供更多信息。

如果您可以提供一个示例，说明您想要调用该方法的语法*，*那肯定会对我们有所帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T21:04:14.670

params 关键字允许您以非数组形式传递任意数量的参数。但是，它们将被转换为函数内部的数组。我不知道任何编程结构会与任何语言中的不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T22:52:52.580

好的，因为我喜欢它，一些代码可以计算出您在某个列表中有多少个任意数量的类型的实例......

我需要有趣的计数器：

```
 public class FunnyCounter
  {
    Dictionary<Type, int> restrictions = new Dictionary<Type, int>();
    public FunnyCounter Add<T>(int appears)
    {
      restrictions.Add(typeof(T), appears);
      return this;
    }

    public void PassThrough(object o)
    {
      if (restrictions.ContainsKey(o.GetType()))
        restrictions[o.GetType()] = restrictions[o.GetType()] - 1;
    }

    public bool SatisfiedAll()
    {
      return restrictions.Values.Aggregate(true, (b, i) => b && i == 0);
    } 
```

现在有一个类似的列表

```
List<Stuff> l = new List<Stuff> { new Ball(), new Ball(), new Bucket() }; 
```

我愿意...

```
FunnyCounter counter = new FunnyCounter();
counter.Add<Ball>(2).Add<Bucket>(1);
l.ForEach(counter.PassThrough);
Console.WriteLine(counter.SatisfiedAll()); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T05:56:35.813

以下是我将以简化的方式完成此操作的方法：

```
var collection = new[] {Item.Baloon, Item.Cupcake, Item.Baloon, Item.Coke};

var result = collection.Contains(2.Baloons(), 1.Cupcakes()); 
```

在哪里：

```
public enum Item
{
    Baloon,
    Cupcake,
    Coke
}

public static class TableExtensions
{
    public static Pair<Item, int> Baloons(this int count)
    {
        return Tuple.From(Item.Baloon, count);
    }

    public static Pair<Item, int> Cupcakes(this int count)
    {
        return Tuple.From(Item.Cupcake, count);
    }

    public static bool Contains(this IEnumerable<Item> self, 
        params Pair<Item, int>[] criteria)
    {
        foreach (var pair in criteria)
        {
            var search = pair.Key;
            if (self.Count(item => item == search) < pair.Value)
                return false;
        }
        return true;
    }
} 
```

评论：

*   您不关心参数中项目的顺序。
*   我使用枚举来表示对象，但这些也可能是对象
*   元组来自[Lokad.Shared](http://abdullin.com/shared-libraries/)
*   包含当前搜索“至少 X 个项目”。我们可以通过传递实际上是可枚举**规则的谓词的标准对象来获得****更大的灵活性**。这将**保持语法相同**，但允许有更多选项（即：*AtLeast*、*AtMost*、 X. *VegetarianSets*、 Y. *Drinks*等）。如果有兴趣，请查看[验证和业务规则应用程序块](http://abdullin.com/journal/2008/11/23/net-application-block-for-validation-and-business-rules.html)中的预定义验证规则，以了解类似的规则组合方法。

 ******** * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T21:02:41.960

除了使用 params 关键字（这将强制您将项目添加到数组中）之外，C# 目前不支持此功能。C# 4.0 将在语言中引入可选参数，但我不确定这对你来说是否足够*随意*。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T21:02:56.780

我会采用一个可以针对您的数据源进行评估的谓词，然后对其进行评估，从谓词返回结果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-28T21:03:32.767

这些物品是如何储存的？它们应该存储在项目集合对象中。它应该有必要的方法来检查它的内脏。

或者使用实现 IItem 接口的对象的 params 数组。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-28T21:13:26.773

```
bool doTheseItemsExist(List criteria) { .. } 
```

你不能简单地传入一个对象列表吗？从技术上讲，它类似于传递一个数组，但它很容易使用，并且如果您使用 params，您不必加载调用堆栈，其中可能是一个可能很大的参数列表。（当然，最后一部分完全取决于您打算搜索多少标准。）

（编辑：实际上，该 List 需要是对象类型和预期数量的映射。）

但是建议您的收藏应该在您的收藏中公开这些查询的先生们可能是这里的赢家。一种可能：

```
bool MyCollection.HasBalloons(int numBalloons);
bool MyCollection.HasCupcakes(int numCupcakes);
bool MyCollection.HasPartyHats(int numHats); 
```

但是，对于调用者来说，布尔结果是模棱两可的......有这么多吗？至少有这么多？所以也许更好的方向是：

```
int MyCollection.NumBalloons();
int MyCollection.NumCupcakes();
int MyCollection.NumPartyHats(); 
```

然后，您不需要带有任意参数集的一些额外功能。您可以根据需要简单地检查集合。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-28T21:18:54.377

数组可能会完成这项工作，但它并不完全优雅。你有一个包含不同类型项目的集合的类吗？另一个更精确的解决方案是使用 Dictionary

```
Dictionary<String, int> numberOfEach = new Dictionary<string, int>();
numberOfEach.Add("balloons", 2);
numberOfEach.Add("cupcakes", 4); 
```

然后你将在你的类中有一个方法（带有集合的方法）

```
public bool correctAmmounts(Dictionary<String, int> numberOfEach)
{
    return collection1.Count == numberOfEach["balloons"] &&
           collection2.Count == numberOfEach["cupcakes"];
} 
```

其中 collection1 有一些气球，而 collection2 有一些纸杯蛋糕。

但是，如果不同类型的数量发生变化，您将不得不编辑您的方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-28T22:23:26.163

我想知道这个问题是否有点被打破。如果您询问某个对象是否包含 n 个这个和 y 个那个，那么您的对象可以被枚举。在这种情况下，它应该实现 IEnumerable ，其中 T 将是“您的内容的共同点”。从这里开始，您可以使用例如 LINQ 来获得问题的答案或将此类问题封装到对象中，并提供例如 Jon 所展示的标准系统...

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-28T22:26:53.223

这听起来像是做一些 OOP 的好机会：

说你有一些代表你的物品的类

```
public class Item
{
  public string Name{ get; set; }
  // Here put all the properties that are common to all items.
}

public class Cupcake : Item
{
  // By inheriting from Item, it will have Name 
  //  along with anything else you define there

  public bool HasFrosting{ get; set; }
  // Put whatever else Cupcake needs here
}

public class Baloon : Item
{
  public Color MyColor{ get; set; }
} 
```

然后在您的应用程序代码中

```
// From your post, I can't tell where you're getting
//  your items, so I'll just put a placeholder here for now.
//  I assume this returns all kinds of items:
//  Cupcakes, Baloons, and other fun stuff
Item[] items = GetItemsFromSomewhere();

int cupcakeCount = GetCupcakeCount(items);

...

public int GetCupcakeCount( Item[] items )
{
  int cupcakeCount = 0;

  // This is the code for checking types of items
  //  you could use a LINQ statement or whatever you like
  //  but i just put a foreach loop here for simplicity
  foreach( Item item in items )
  {
    // Check the types of each object, 
    if(item is Cupcake)
     ++cupcakeCount;
  }

  return cupcakeCount;
} 
```

即使您可以通过另一种方式做到这一点，也请考虑 OOP，因为您似乎需要区分对象类型并进行比较。这可能是准确表示您的系统的好方法。

# html - 垂直对齐图像旁边的文本？

> ID：489340
> 
> 赞同：2143
> 
> 时间：2009-01-28T21:01:50.337
> 
> 标签：html, css, alignment, vertical-alignment

为什么`vertical-align: middle`行不通？然而，`vertical-align: top` *确实*有效。

```
span{
  vertical-align: middle;
}
```

```
<div>
  <img src="https://via.placeholder.com/30" alt="small img" />
  <span>Doesn't work.</span>
</div>
```

* * *

## 回答 #1

> 赞同：2467
> 
> 时间：2009-01-28T21:10:50.180

实际上，在这种情况下，它非常简单：将垂直对齐应用于图像。由于它都在一行中，因此它实际上是您要对齐的图像，而不是文本。

```
<!-- moved "vertical-align:middle" style from span to img -->
<div>
  <img style="vertical-align:middle" src="https://via.placeholder.com/60x60">
  <span style="">Works.</span>
</div>
```

在FF3中测试。

现在您可以将 flexbox 用于这种类型的布局。

```
.box {
   display: flex;
   align-items:center;
}
```

```
<div class="box">
    <img src="https://via.placeholder.com/60x60">
    <span style="">Works.</span>
</div>
```

* * *

## 回答 #2

> 赞同：350
> 
> 时间：2009-01-28T21:45:03.963

以下是一些简单的垂直对齐技术：

## 单行垂直对齐：中间

这很简单：将文本元素的行高设置为等于容器的行高

```
<div>
  <img style="width:30px; height:30px;">
  <span style="line-height:30px;">Doesn't work.</span>
</div> 
```

## 多行垂直对齐：底部

相对于其容器绝对定位内部 div

```
<div style="position:relative;width:30px;height:60px;">
  <div style="position:absolute;bottom:0">This is positioned on the bottom</div>
</div> 
```

## 多行垂直对齐：中间

```
<div style="display:table;width:30px;height:60px;">
  <div style="display:table-cell;height:30px;">This is positioned in the middle</div>
</div> 
```

## 如果你必须支持旧版本的 IE <= 7

为了让它全面正常工作，您必须稍微修改一下 CSS。幸运的是，有一个对我们有利的 IE 错误。`top:50%`在容器和内部 div 上设置`top:-50%`，可以达到相同的效果。我们可以使用 IE 不支持的另一个功能将两者结合起来：高级 CSS 选择器。

```
<style type="text/css">
  #container {
    width: 30px;
    height: 60px;
    position: relative;
  }
  #wrapper > #container {
    display: table;
    position: static;
  }
  #container div {
    position: absolute;
    top: 50%;
  }
  #container div div {
    position: relative;
    top: -50%;
  }
  #container > div {
    display: table-cell;
    vertical-align: middle;
    position: static;
  }
</style>

<div id="wrapper">
  <div id="container">
    <div><div><p>Works in everything!</p></div></div>
  </div>
</div> 
```

## 可变容器高度垂直对齐：中间

该解决方案需要比其他解决方案更现代的浏览器，因为它利用了该`transform: translateY`属性。（[http://caniuse.com/#feat=transforms2d](http://caniuse.com/#feat=transforms2d)）

将以下 3 行 CSS 应用于元素将使其在其父元素中垂直居中，而与父元素的高度无关：

```
position: relative;
top: 50%;
transform: translateY(-50%); 
```

* * *

## 回答 #3

> 赞同：104
> 
> 时间：2014-03-24T07:54:59.223

将您的更改`div`为 flex 容器：

```
div { display: flex; } 
```

现在有两种方法可以使所有内容的对齐方式居中：

**方法一：**

```
div { align-items: center; } 
```

**[演示](http://jsfiddle.net/Mori/35oh5dfL/)**

* * *

**方法二：**

```
div * { margin: auto 0; } 
```

**[演示](http://jsfiddle.net/Mori/Qtng7/)**

* * *

尝试不同的宽度和高度值`img`以及不同的字体大小值`span`，您会发现它们始终保持在容器的中间。

* * *

## 回答 #4

> 赞同：97
> 
> 时间：2014-09-11T12:58:35.143

您必须同时应用`vertical-align: middle`这两个元素才能使其完美居中。

```
<div>
  <img style="vertical-align:middle" src="http://lorempixel.com/60/60/">
  <span style="vertical-align:middle">Perfectly centered</span>
</div>
```

接受的[答案](https://stackoverflow.com/a/489394/3323185)确实将图标集中在其旁边文本 x 高度的一半左右（如[CSS 规范](http://www.w3.org/TR/CSS2/visudet.html#propdef-vertical-align)中所定义）。如果文本在顶部或底部突出显示升序或降序，这可能已经足够好，但看起来有点偏离：

![居中图标比较](https://i.stack.imgur.com/V0WZM.png)

左边，文字没有对齐，右边如上图。可以在[这篇关于 vertical-align](http://christopheraue.net/2014/03/05/vertical-align/#centering-an-icon)的文章中找到现场演示。

**有没有人谈论过为什么`vertical-align: top`在场景中有效？**问题中的图像可能比文本高，因此定义了行框的顶部边缘。`vertical-align: top`在 span 元素上，然后将其放置在行框的顶部。

`vertical-align: middle`和之间行为的主要区别在于`top`，第一个移动元素相对于框的基线（放置在需要满足所有垂直对齐的任何位置，因此感觉相当*不可预测*）和第二个相对于行框的外部边界（即更具体）。

* * *

## 回答 #5

> 赞同：64
> 
> 时间：2013-12-24T21:06:14.827

接受的答案中使用的技术仅适用于单行文本（[demo](http://jsfiddle.net/danield770/ULzcX/6/)），而不适用于多行文本（[demo](http://jsfiddle.net/danield770/ULzcX/7/)） - 如那里所述。

如果有人需要将多行文本垂直居中到图像，这里有几种方法（方法 1 和 2 受[这篇 CSS-Tricks 文章的](http://css-tricks.com/centering-in-the-unknown/)启发）

## 方法 #1：CSS 表格 ( **[FIDDLE](http://jsfiddle.net/danield770/ULzcX/5/)** ) (IE8+ ( [caniuse](http://caniuse.com/css-table) ))

CSS：

```
div {
    display: table;
}
span {
    vertical-align: middle;
    display: table-cell;
} 
```

## 方法#2：容器上的伪元素（**[FIDDLE](http://jsfiddle.net/danield770/ULzcX/8/)**）（IE8+）

CSS：

```
div {
   height: 200px; /* height of image */
}

div:before {
  content: '';
  display: inline-block;
  height: 100%;
  vertical-align: middle;
  margin-right: -0.25em; /* Adjusts for spacing */
}

img {
    position: absolute;
}

span {
  display: inline-block;
  vertical-align: middle;
  margin-left: 200px;  /* width of image */
} 
```

## 方法#3：Flexbox ( **[FIDDLE](http://jsfiddle.net/danield770/ULzcX/4/)** ) ( [caniuse](http://caniuse.com/flexbox) )

**CSS**（上面的小提琴包含供应商前缀）：

```
div {   
    display: flex; 
    align-items: center;    
}
img {
    min-width: 200px; /* width of image */
} 
```

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2012-07-02T14:41:34.423

此代码适用于 IE 和 FF：

```
<div>
  <img style="width:auto; height:auto;vertical-align: middle;">
  <span>It does work on all browsers</span>
</div> 
```

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2009-01-28T21:05:08.817

因为您必须将其设置`line-height`为 div 的高度才能正常工作

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2011-11-18T13:24:05.230

作为记录，对齐“命令”不应该在 SPAN 上工作，因为它是一个**内联**标签，而不是一个**块级**标签。对齐、边距、填充等内容不适用于内联标签，因为内联点不会破坏文本流。

CSS 将 HTML 标签分为两组：内联和块级。搜索“css block vs inline”，就会出现一篇很棒的文章......

[http://www.webdesignfromscratch.com/html-css/css-block-and-inline/](http://www.webdesignfromscratch.com/html-css/css-block-and-inline/)

（理解核心 CSS 原则是它不那么烦人的关键）

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2011-11-29T18:24:13.407

基本上，您将不得不开始使用 CSS3。

```
-moz-box-align: center;
-webkit-box-align: center; 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2012-01-12T14:52:01.553

您可以做的另一件事是将文本设置`line-height`为`<div>`. 然后将图像设置为`vertical-align: middle;`

这真的是最简单的方法。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2013-05-20T23:50:12.333

用于`line-height:30px`跨度，使文本与图像对齐：

```
<div>
  <img style="width:30px; height:30px;">
  <span style="line-height:30px;">Doesn't work.</span>
</div> 
```

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2016-04-10T11:26:02.127

还没有看到`margin`任何这些答案的解决方案，所以这是我对这个问题的解决方案。

**[此解决方案](https://jsfiddle.net/Fleuv/3npn9x5b/)仅在您知道图像宽度的情况下才有效。**

## 的HTML

```
<div>
    <img src="https://placehold.it/80x80">
    <span>This is my very long text what should align. This is my very long text what should align.</span>
</div> 
```

## CSS

```
div {
  overflow:hidden;
}
img {
   width:80px
   margin-right:20px;
   display:inline-block;
   vertical-align:middle;
}
span {
   width:100%;
   margin-right:-100px;
   padding-right:100px;
   display:inline-block;
   vertical-align:middle;
   box-sizing:border-box;
   -moz-box-sizing:border-box;
   -webkit-box-sizing:border-box;
} 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2016-11-08T06:26:18.517

编写这些跨度属性

```
span{
    display:inline-block;
    vertical-align:middle;
} 
```

使用`display:inline-block;`时使用`vertical-align`属性。这些是关联属性

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2012-04-13T07:21:30.740

```
background:url(../images/red_bullet.jpg) left 3px no-repeat; 
```

我一般用 3px 代替`top`. 通过增加/减少该值，可以将图像更改为所需的高度。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2017-01-30T14:54:55.460

您可以将图像设置为`inline element`使用`display`属性

```
<div>
  <img style="vertical-align: middle; display: inline;" src="https://placehold.it/60x60">
  <span style="vertical-align: middle; display: inline;">Works.</span>
</div>
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2012-10-24T15:22:55.923

例如，在 jQuery mobile 中的按钮上，您可以通过将这种样式应用于图像来稍微调整它：

```
.btn-image {
    vertical-align:middle;
    margin:0 0 3px 0;
} 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2014-02-24T14:20:27.650

多线解决方案：

[http://jsfiddle.net/zH58L/6/](http://jsfiddle.net/zH58L/6/)

```
<div style="display:table;width:30px;height:160px;">
    <img style="display:table-cell;width:30px;height:60px;padding:50px" src='...' />
    <div style="display:table-cell;height:30px;vertical-align:middle">
      Multiline text centered vertically
    </div>
</div>
<!-- note: img (height + 2x padding) must be equal to root div height --> 
```

适用于所有浏览器和 ie9+

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2017-07-06T02:12:31.927

我同意，这可能会令人困惑。尝试利用表格功能。我使用这个简单的 CSS 技巧将模式定位在网页的中心。它具有大型浏览器支持：

```
<div class="table">
    <div class="cell">
        <img src="..." alt="..." />
        <span>It works now</span>
    </div>
</div> 
```

和 CSS 部分：

```
.table { display: table; }
.cell { display: table-cell; vertical-align: middle; } 
```

请注意，您必须设置图像和表格容器的样式并调整其大小，以使其按您的意愿工作。享受。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2020-09-19T10:44:18.860

## [`flex property`](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)在 css 中使用。

> **`align-items:center;`**如果要使用 in flex using 将文本水平居中对齐，请使用 in flex using 将文本垂直居中对齐**`justify-content:center;`**。

```
div{
  display: flex;
  align-items: center;
}
```

```
<div>
  <img src="http://lorempixel.com/30/30/" alt="small img" />
  <span>It works.</span>
</div>
```

## [`table-cell`](https://css-tricks.com/almanac/properties/d/display/#table-values)在 css 中使用。

```
div{
  display: table;
}
div *{
  display: table-cell;
  vertical-align: middle;
}
```

```
<div>
  <img src="http://lorempixel.com/30/30/" alt="small img" />
  <span>It works.</span>
</div>
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2021-08-16T06:44:30.960

```
div {
  display: flex;
  align-items: center;
}
```

```
<div>
  <img src="http://lorempixel.com/30/30/" alt="small img" />
  <span>It works.</span>
</div>
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-10-10T16:26:13.900

Display flex with`align-items: center;`是垂直对齐项目的最佳方式

```
div {
  display: flex;
  align-items: center;
}
```

```
<div>
  <img src="https://via.placeholder.com/30" alt="small img" />
  <span>it works.</span>
</div>
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-05-25T12:47:49.980

首先，完全不推荐**内联 CSS**，它真的会弄乱你的 HTML。

对于对齐图像和跨度，您可以简单地执行`vertical-align:middle`.

```
.align-middle {
  vertical-align: middle;
}
```

```
<div>
  <img class="align-middle" src="https://i.stack.imgur.com/ymxaR.png">
  <span class="align-middle">I'm in the middle of the image! thanks to CSS! hooray!</span>
</div>
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-11-05T05:21:33.793

不知道为什么它不会在您的导航浏览器上呈现它，但我通常在尝试显示带有图像和居中文本的标题时使用这样的片段，希望它有所帮助！

[https://output.jsbin.com/jeqorahupo](https://output.jsbin.com/jeqorahupo)

```
 <hgroup style="display:block; text-align:center;  vertical-align:middle;  margin:inherit auto; padding:inherit auto; max-height:inherit">

            <header style="background:url('http://lorempixel.com/30/30/') center center no-repeat; background-size:auto; display:inner-block; vertical-align:middle; position:relative; position:absolute; top:inherit; left:inherit; display: -webkit-box; display: -webkit-flex;display: -moz-box;display: -ms-flexbox;display: flex;-webkit-flex-align: center;-ms-flex-align: center;-webkit-align-items: center;align-items: center;">

            <image src="http://lorempixel.com/60/60/" title="Img title" style="opacity:0.35"></img>
                    http://lipsum.org</header>
                    </hgroup> 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2022-02-28T03:18:08.233

在 2022 年，[近 96% 的无前缀浏览器支持](https://caniuse.com/?search=grid)，我很惊讶没有人建议使用`grid`布局。

在[这个 JSFiddle](https://jsfiddle.net/CSSBurner/5knb6fo2/)中，3 行是实现 OP 目标所必需的（但提供了多个对齐方式以供比较）：

```
div {
    display: grid;
    grid-template-columns: min-content max-content;
    align-items: center
} 
```

一个额外的 UI 细节将包括该`gap`属性的可选使用，它可以调制父[网格容器](https://www.w3.org/TR/css-grid-1/#grid-container)( ) 中每个[网格项之间的空间。](https://www.w3.org/TR/css-grid-1/#grid-item)`div`

**`grid`布局优势**

1.  网格项目的简单垂直和水平对齐
2.  网格项之间的空间调制
3.  任何尺寸的图像（使用`min-content`）和文本长度（使用一行`max-content`或包装（未显示在小提琴中）使用`min-content`）都可以工作 - 无需在 CSS 中硬编码图像尺寸（两种用法都在 JSFiddle 中演示）
4.  现代方法

* * *

**`grid`布局的缺点**

1.  较旧的浏览器支持更具挑战性
2.  网格布局一般需要更有经验的开发者才能正确实现——不像`block`/`inline-block`显示那么简单

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2020-06-06T18:45:04.590

```
<!DOCTYPE html>
<html>
<head>
<style>
 .block-system-branding-block {
 flex: 0 1 40%;
}
@media screen and (min-width: 48em) {
.block-system-branding-block {
flex: 0 1 420px;
margin: 2.5rem 0;
text-align: left;
}
}
.flex-containerrow {
display: flex;
}
.flex-containerrow > div {
  justify-content: center;
align-items: center;
  }
 .flex-containercolumn {
display: flex;
flex-direction: column;
}
.flex-containercolumn > div {
  width: 300px;
 margin: 10px;
 text-align: left;
 line-height: 20px;
 font-size: 16px;
}
.flex-containercolumn  > site-slogan {font-size: 12px;}
.flex-containercolumn > div > span{ font-size: 12px;}
</style>
</head>
<body>
<div id="block-umami-branding" class="block-system block- 
system-branding-block">
  <div class="flex-containerrow">
 <div>
  <a href="/" rel="home" class="site-logo">
  <img src="https://placehold.it/120x120" alt="Home">
</a>
</div><div class="flex-containerrow"><div class="flex-containercolumn">
  <div class="site-name ">
    <a href="/" title="Home" rel="home">This is my sitename</a>
   </div>
    <div class="site-slogan "><span>Department of Test | Ministry of Test | 
 TGoII</span></div>
 </div></div>
</div>
 </div>
</body>
</html> 
```

* * *

## 回答 #26

> 赞同：-4
> 
> 时间：2009-01-28T21:10:00.417

你可能想要这个：

```
<div>
   <img style="width:30px; height:30px;">
   <span style="vertical-align:50%; line-height:30px;">Didn't work.</span>
</div> 
```

正如其他人所建议`vertical-align`的那样，尝试图像：

```
<div>
   <img style="width:30px; height:30px; vertical-align:middle;">
   <span>Didn't work.</span>
</div> 
```

CSS 并不烦人。您只是不阅读[文档](http://www.w3.org/TR/CSS2/visudet.html#line-height)。;P

# java - HQL - 分页的行标识符

> ID：489360
> 
> 赞同：8
> 
> 时间：2009-01-28T21:04:16.137
> 
> 标签：java, hibernate, pagination, hql

有谁知道 HQL 是否有一个关键字来识别诸如 ROWID 或 ROWNUM 之类的行？

我想用 HQL 实现分页，但我无法使用 .setMaxResult() 或 .setFirstResult() 因为我不直接使用会话对象，因此不使用 Query 对象，而只是将我的查询创建为一个字符串并使用 .find() 方法。

我尝试在查询中使用 LIMIT 和 OFFSET，但 HQL 似乎忽略了这些关键字，无论如何都会将整个结果返回给我。

我也无法使用 Hibernate 条件，因为它不支持出现在我的查询中的“HAVING”子句。

我最后的手段是使用 ROWNUM/ROWID 关键字来限制结果集。还有其他人有其他建议吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-08T14:38:52.943

这是hibernate大放异彩的一种情况：

使用 hql 查询的典型解决方案。

```
int elementsPerBlock = 10;
int page = 2;

return  getSession().createQuery("from SomeItems order by id asc")
            .setFirstResult(elementsPerBlock * (page-1) + 1 )
            .setMaxResults(elementsPerBlock)
            .list(); 
```

hibernate 会将其转换为数据库根据其 sql 方言理解的模式。在 oracle 上它将创建一个 ROWNUM < X 的子选择。在 postgresql 上它将发出一个 LIMIT / OFFSET 在 msSQL 服务器上它将发出一个 TOP ..

据我所知，使用“纯”hql 是不可能实现这一点的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-16T14:40:37.333

**使用查询接口进行分页：**

Query接口有两种分页方法。

**1\. Query setFirstResult(int startPosition)：** 这个方法接受一个整数，代表结果集中的第一行，从第 0 行开始。

**2.查询setMaxResults(int maxResult)：** 该方法告诉Hibernate检索固定数量的maxResults个对象。结合使用以上两种方法，我们可以在我们的 Web 或 Swing 应用程序中构建一个分页组件。

**例子：**

```
Query query = session.createQuery("FROM Employee");
query.setFirstResult(5);
query.setMaxResults(10);
List<Employee> list = query.list();
for(Employee emp: list) {            
   System.out.println(emp);
} 
```

**使用 Criteria 接口进行分页：Criteria 接口** 有两种方法进行分页。

**1\. 条件 setFirstResult(int firstResult):**

设置要检索的第一个结果。

**2.列表项Criteria setMaxResults(int maxResults)：**

对要检索的对象数量设置限制。

**例子：**

```
Criteria criteria = session.createCriteria(Employee.class);
criteria.setFirstResult(5);
criteria.setMaxResults(10);            
List<Employee> list = criteria.list();
for(Employee emp: list) {            
    System.out.println(emp);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T11:42:50.257

Well, you can in principle access ROWNUM/ROWID from HSQL (though I've never used it). See e.g. [Ron's Weblog](http://ronfrancis.wordpress.com/2007/10/16/dont-forget-an-order-by-for-pagination-queries/). That should work.

But I'd like to point out that you're really working against Hibernate and HSQL if you do it like that. The proper way is to use setMaxResult() & friends. If you cannot do that b/c of your architecture, I'd at least reconsider my architectural decisions. I know these are always tough changes to make, but it might be worth it.

# c++ - transform_iterator 编译问题

> ID：489364
> 
> 赞同：6
> 
> 时间：2009-01-28T21:05:07.070
> 
> 标签：c++, map, boost-iterators

你好，

我不喜欢发布编译问题，但我真的无法解决这个问题。使用此代码：

```
#include <map>
#include <boost/iterator/transform_iterator.hpp>

using namespace std;

template <typename K, typename V>
struct get_value
{
    const V& operator ()(std::pair<K, V> const& p) { return p.second; }
};

class test
{
    typedef map<int, float> TMap;
    TMap mymap;

public:
    typedef get_value<TMap::key_type, TMap::value_type> F;
    typedef boost::transform_iterator<F, TMap::iterator> transform_iterator;

    transform_iterator begin()
    {
        return make_transform_iterator(mymap.begin(), F());
    }
}; 
```

得到这个编译错误：

```
transform_iterator.hpp(43) : error C2039: 'result_type' : is not a member of 'get_value<K,V>'
        with
        [
            K=int,
            V=std::pair<const int,float>
        ] 
```

谁能解释为什么这不起作用？我正在使用带有 boost 1.36.0 的 Visual Studio 7.0

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T09:58:20.703

既然你也要求解释

需要知道调用函数的`transform_iterator`返回类型以便实例化自身。这是通过[`result_of`](http://www.boost.org/doc/libs/1_37_0/libs/utility/utility.htm#result_of)（在`<boost/utility/result_of.hpp>`

如果使用函数对象，则需要定义一个成员`result_type`来指定对象的结果类型。（因为一个对象没有这样的“返回类型”）

如果您使用了常规函数，则`result_of`可以自己解决，例如：

```
template <typename K, typename V>
const V & get_value(std::pair<K, V> const & p)  { return p.second; }

class test
{
  typedef map<int, float> TMap;
  TMap mymap;

public:
  typedef boost::function< const TMap::mapped_type & (const  TMap::value_type &)  > F;
  typedef boost::transform_iterator<F, TMap::iterator> transform_iterator;

  transform_iterator begin()
  {
    return boost::make_transform_iterator(mymap.begin(), &get_value< int, float >);
  }
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-28T21:11:47.917

您必须继承`get_value`from`unary_function<const V&, std::pair<K, V> const&>`才能知道`transform_iterator`签名`get_value`是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-13T23:02:50.393

```
// here is a working example:

#include <vector>
#include <iostream>
#include <boost/iterator/transform_iterator.hpp>

template <typename T, typename U>
const T& Get1st(const std::pair<T, U>& pair) { return pair.first; }

struct Bar {
    using Pairs = std::vector<std::pair<int, char>>;
    using Iter = boost::transform_iterator< decltype(&Get1st<int, char>), Pairs::const_iterator >;

    void add(int i, char c) { _pairs.emplace_back(i, c); }

    Iter begin() { return boost::make_transform_iterator(_pairs.begin(), &Get1st<int, char>); }
    Iter end()   { return boost::make_transform_iterator(_pairs.end(),   &Get1st<int, char>); }

private:
    Pairs _pairs;
};

int main() {
    Bar bar;
    bar.add(1, 'a');
    bar.add(3, 'c');
    bar.add(2, 'b');

    for(const auto& i : bar) std::cout << i << " ";
    std::cout << "\n";

    return 0;
} 
```

// 输出：1、3、2

# javascript - 设置 HTTP cookie 时可以使用 localhost 作为域吗？

> ID：489369
> 
> 赞同：18
> 
> 时间：2009-01-28T21:06:12.140
> 
> 标签：javascript, jquery, cookies

我正在使用 jQuery 插件来设置 cookie，当我使用 localhost 作为域时，它不会存储 cookie。

这是我在 jQuery 1.2.6 中使用的插件。

[http://www.stilbuero.de/2006/09/17/cookie-plugin-for-jquery/](http://www.stilbuero.de/2006/09/17/cookie-plugin-for-jquery/)

下面是我正在使用的代码。您可以看到它不喜欢 localhost，我是从 localhost 上的开发 Web 服务器运行它。一个细节是我正在运行端口 4005，但这不应该影响域，AFAIK。

```
$(function() {

    console.log('Testing');

    var one = $.cookie('Test.One');
    var two = $.cookie('Test.Two');
    var three = $.cookie('Test.Three');

    console.log(['one', one]);
    console.log(['two', two]);
    console.log(['three', three]);

    $('#div1').text(one);
    $('#div2').text(two);
    $('#div3').text(three);

    $.cookie('Test.One', 'Test 1');
    $.cookie('Test.Two', 'Test 2', { path: '/' });
    $.cookie('Test.Three', 'Test 3', { path: '/', domain: 'localhost' });

}); 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-28T21:11:04.063

我在设置 cookie 时遇到了类似的问题。组成一个域名并将其作为 127.0.0.1 添加到您的主机文件中。然后在该域上运行 Web 应用程序。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-28T21:28:59.910

我认为 cookie 的域名必须正好有两个点（不包括 TLD 之后的最后一个点）。所以`.something.localhost`没关系，`.google.com`没关系，但`.localhost`或`google.com`不是。但是看一眼[RFC 2965](https://www.rfc-editor.org/rfc/rfc2965)就会发现它比这更复杂……您可能想阅读该文档，尤其是第 3.3 节（和/或其前身[RFC 2109](https://www.rfc-editor.org/rfc/rfc2109)）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-29T16:05:49.290

我更新了 jQuery 插件，当它是 localhost 时不将域添加到 cookie 中。这解决了我的问题，而无需触及主机文件。

```
var domain = (options.domain && options.domain !== 'localhost') ? '; domain=' + (options.domain) : ''; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-01-31T06:45:06.207

我正在使用 Code Ignitor，并将域设置为空字符串解决了我在 localhost 上处理应用程序时遇到的问题。我相信这是更好的解决方案，因为开发团队中的每个人都不需要在 Windows 上弄乱他们的主机文件。

当部署在实时站点上时，生产域值可以放在 Code Ignitor 的 config.php 中。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-28T21:21:05.697

我尝试将主机文件设置为使用备用名称 (local.acme.com)，现在我可以在该域上设置 cookie。似乎我无法在 localhost 上设置 cookie，至少不能使用 Firefox。我不记得这是对 cookie 的限制。我想了解这里发生了什么。

另外，我确实尝试将主机文件中的域简单地设置为“dev”，但这不起作用。我必须使用以 .com 或其他顶级域名结尾的名称才能使其正常工作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-10-26T18:31:10.783

我解决这个问题的最简单的解决方案是使用 127.0.0.1 而不是 localhost ;-) 这在 Firefox 中运行良好！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-19T04:54:01.670

Cookie 需要指定`SameSite`属性，`None`值过去是默认值，但最近的浏览器版本`Lax`将默认值设为对某些类别的跨站请求伪造 (CSRF) 攻击具有相当强大的防御能力。

连同`Domain=localhost`你的 cookie 应该看起来像这样

```
document.cookie = `${name}=${value}${expires}; Path=/; Domain=localhost; SameSite=Lax`; 
```

[https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite)

# .net - .NET 是否与 Delphi 的 ActionList 等效？

> ID：489376
> 
> 赞同：6
> 
> 时间：2009-01-28T21:07:40.047
> 
> 标签：.net, delphi, actionlist

我们目前正在使用 Delphi 5 和 Delphi 2005 进行开发，并研究通过 Delphi Prism 走 .NET 路线。

是否有与 Delphi 的 ActionList 等效的 .NET？

对于那些不熟悉 ActionList 的人来说，它是一个包含我们创建的动作集合的组件，例如保存、刷新、加载等。每个动作都可以有一个标题、图像、启用/禁用分配给它。之后，您可以将一个按钮分配给一个动作，并且该按钮将继承该动作的标题、图像等，如果您的 UI 具有可用作菜单项和按钮的保存动作，则它们都可以使用相同的动作.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:41:53.967

您还可以查看[Actions for .NET WinForms](http://actions.codeplex.com/)。除其他外，它允许以类似 Delphi 的方式对动作进行分类，并且可以选择异步执行和/或更新它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T08:34:58.910

WinForms 没有内置这样的东西，但 WPF 有它的命令。请参阅[http://www.microsoft.com/belux/msdn/nl/community/columns/jdruyts/wpf_commandpattern.mspx](http://www.microsoft.com/belux/msdn/nl/community/columns/jdruyts/wpf_commandpattern.mspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-07T15:07:31.003

是的，有：[克拉德的行动](http://www.codeproject.com/KB/miscctrl/CradsActions.aspx)。

那是一个描述和托管原始源代码的 CodeProject 页面。[原作者页面](http://blogs.ugidotnet.org/crad/articles/38329.aspx)的[代码链接](http://www.marcodesanctis.it/images/Blog/CradsActions_src.zip)坏了。

很遗憾微软没有采用它们。

* * *

![在此处输入图像描述](https://i.stack.imgur.com/OC7kp.png)

![在此处输入图像描述](https://i.stack.imgur.com/aAJgL.png)

# silverlight - 尝试在 Silverlight 2 中使用 HttpWebRequest 时出错

> ID：489377
> 
> 赞同：1
> 
> 时间：2009-01-28T21:08:11.840
> 
> 标签：silverlight, asynchronous, httpwebrequest, invoke, dispatcher

我试图从异步调用写入表单。我在网上看到的示例表明这应该可以工作，但我一直收到错误消息。

首先，尽管 Disbatcher 从不调用 p 进行的调用。其次，我在调用 req.EndGetResponse(a); 时收到 System.Security.SecurityException；

什么可能导致问题？

```
public partial class Page : UserControl
{
    Uri url = new Uri("http://www.google.com", UriKind.Absolute);
    HttpWebRequest req;

    private delegate void PrintToUIThread(string text);
    PrintToUIThread p;

    public Page()
    {
        InitializeComponent();
        req = (HttpWebRequest)WebRequest.Create(url);
        p = new PrintToUIThread(print);
        req.BeginGetResponse(new AsyncCallback(WebComplete), req);
    }

    void WebComplete(IAsyncResult a)
    {
        try
        {
            Dispatcher.BeginInvoke(p);
            HttpWebRequest req = (HttpWebRequest)a.AsyncState;
            HttpWebResponse res = (HttpWebResponse)req.EndGetResponse(a);
            Dispatcher.BeginInvoke(p);
        }
        catch (Exception ex)
        {
            print(ex.ToString());
        }
    }

    private void print(string text)
    {
        PageTextBox.Text = text;
    }

    private void print()
    {
        PageTextBox.Text = "Call From Invoke";
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T20:22:55.903

从我所见，您的请求/响应代码本质上没有任何问题。由于 google 的 crossdomain.xml 文件隐含的跨域限制，您可能会遇到安全异常。

这是 Google 的 crossdomain.xml：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
  <site-control permitted-cross-domain-policies="by-content-type" />
</cross-domain-policy> 
```

这实际上是在说“嘿，RIA 应用程序，使用代理”。基本上，使用您的“友好”服务器设置 WCF 或 ASMX Web 服务调用，并使用 clientaccesspolicy.xml 文件，使用您的服务器发出 http 请求，然后返回结果。我不确定谷歌是否支持 JSONP，但你也可以试试。

# controls - 你知道任何用于渲染代码的开源 asp.net web 控件吗？

> ID：489384
> 
> 赞同：1
> 
> 时间：2009-01-28T21:09:19.713
> 
> 标签：controls, asp.net-2.0

我正在寻找一个能够格式化以某些编程语言编写的代码（如 StackOverflow 或 Notepad++ 中的“语言”功能）的 asp.net 控件，并根据语言自动语法高亮/缩进。

你知道这样的控制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T21:14:02.263

我不知道有任何 asp.net 控件可以做到这一点，但您可以使用 JavaScript 语法荧光笔，例如：[http](http://code.google.com/p/syntaxhighlighter/) ://code.google.com/p/syntaxhighlighter/ 。

主要优点是它将渲染成本转移到客户端，这对于具有大量代码的高频率网站（例如编程论坛/网站，如 SO.. 等等......他们也这样做了） ， 对 ？）。

# visual-studio-dbpro - Visual Studio Database Pro 部分项目约束问题

> ID：489401
> 
> 赞同：3
> 
> 时间：2009-01-28T21:11:54.687
> 
> 标签：visual-studio-dbpro

在 Visual Studio 2008 数据库版本中，可以使用“部分项目”来允许将数据库分成多个项目以进行部署和维护。我一直在考虑在我们的项目中这样做，但遇到了以下问题：

如果您的项目定义了一些基表，然后您有一个不同的项目定义了一组新表，这些表具有指向第一个项目中表的约束，DBPro 似乎无法映射这种关系。具体错误是：

> “CONSTRAINT 对表 foo 有未解析的引用”（其中 foo 在原始数据库中）。

如果您想为自己复制场景，请举一个更具体的例子：

*   创建一个名为 BaseDB 的项目。

*   在 BaseDB 中定义一个名为 Users 的表，其 DDL 如下：

    ```
    CREATE TABLE [dbo].[Users] ( 
        UserID INT IDENTITY(1,1) PRIMARY KEY, 
        UserName NVARCHAR(20) NOT NULL
    ) 
    ```

*   将 BaseDB 导出为部分项目，将 _BaseDB.files 文件添加到您的项目中。

*   在名为 DerivedDB 的同一解决方案中创建一个项目

*   使用 Import Partial Project 指向 BaseDB，确认您是否喜欢在您的导入文件中有一个存根引用指向 BaseDB 中的 Users 表。

*   使用以下 DDL 在 DerivedDB 中定义一个名为 PowerUsers 的表：

    ```
    CREATE TABLE [dbo].[PowerUsers] ( 
        PowerUserID INT IDENTITY(1,1) PRIMARY KEY, 
        UserID INT NOT NULL
    ) 
    ```

*   如果您此时进行“构建”，一切正常。

*   在 DerivedDB 项目中从 PowerUsers 添加 FOREIGN KEY CONSTRAINT 到具有以下 DDL 的用户：

    ```
    ALTER TABLE [dbo].[PowerUsers]
        ADD CONSTRAINT [PowerUsers_Users_FK]
        FOREIGN KEY (UserID)
        REFERENCES [dbo].[Users] (UserID) 
    ```

执行上述步骤应该可以让您看到我正在谈论的错误。

问题：

1.  有没有办法修复跨数据库项目的约束引用？

2.  如果不是，那么是否应该为一系列存储过程保留部分项目，而为基表和约束的*所有*DDL 保留基本项目？

# ms-access - 将 MS Access 图表导出到 Word/Excel

> ID：489406
> 
> 赞同：3
> 
> 时间：2009-01-28T21:13:10.847
> 
> 标签：ms-access, charts, export

我惊讶地发现，在 Microsoft Access 中生成的报告将不包括我在导出到 Excel、Word 或任何其他技术时生成的图表。

有没有人找到解决这个问题的方法？我的用户群需要能够将生成的报告（包括图形）复制/粘贴到不同的状态报告中。似乎无法直接从访问报告中复制/粘贴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T04:07:44.223

我真的需要更多信息来帮助您（哪个版本的 Access、您如何生成图表等）。

您是否尝试过打印预览中的“将其发布到 Microsoft Word”或“使用 Microsoft Excel 分析”选项？

您的用户可以选择 Alt-PrintScreen 并粘贴它。

我通常做的是让用户安装[CutePDF Writer](http://www.cutepdf.com/)（它是免费的），它可以让他们打印到PDF，然后他们可以将其发送给他们想要的任何人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T05:33:22.380

还有一种叫做快照的东西，用户可以进一步查看和/或插入文档中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T08:43:14.777

安装 CutePDF Writer（它是免费的），它可以让他们打印到 PDF

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-07T06:19:54.970

作为一种解决方法，我对 Access 中生成的图形使用免费的屏幕捕捉实用程序：在屏幕上获取图形，捕捉它，将其粘贴或选择性粘贴到 Word 中。运行良好且快速，如果您希望 Word 文档中的图形很大（例如整页），唯一的缺点是会丢失分辨率。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T18:03:08.257

我不确定 Access 2003 但在 Access 2007 中，您转到图表属性并设置`Enabled`为`Yes`. 之后，您可以将图表复制并粘贴到 Excel 和/或 Word 中。

# .net - 如何为 RC1 中的 ASP.NET-MVC 视图获取默认创建的“代码隐藏”文件

> ID：489415
> 
> 赞同：5
> 
> 时间：2009-01-28T21:15:10.140
> 
> 标签：.net, asp.net-mvc, code-behind

在 RC1 中，用于创建视图的模板的行为发生了变化。

正如 Scott Gu 关于[发布候选版本](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)的帖子所解释的那样，默认情况下，新创建的 aspx 视图不再具有代码隐藏文件。

> 根据反馈，我们已将视图模板更改为默认没有代码隐藏文件。此更改有助于加强 MVC 应用程序中视图的用途（旨在纯粹用于渲染并且不包含任何非渲染相关代码），并且对于大多数人来说消除了项目中未使用的文件。
> 
> RC 版本现在添加了 C# 和 VB 语法支持，用于从使用泛型的基类继承视图模板。例如，下面我们将其与 Edit.aspx 视图模板一起使用——其“inherits”属性派生自 ViewPage 类型：

我真的很喜欢能够在代码隐藏中编写特定于视图的代码来输出视图 - 特别是如果我在页面的几个部分重复逻辑，我无法证明创建部分视图是合理的。

**我的实际问题：**斯科特**默认**说- 这意味着我可以改变这种行为，但我似乎看不到在哪里。是否可以？手动创建一个代码隐藏文件并改变周围的东西是一种痛苦。

这也会导致另一个问题：

*   如果我重构模型的名称，则视图中的指令不会更新。这不是世界末日，而是完全强类型化的一个明显优势。

    * * *

**附录：**对于那些想知道为什么我想要代码隐藏的人，这里有一些可能的原因。这是我所想到的几乎所有内容的累积列表。不言而喻（应该如此），除了模型中已有的数据之外，您不得访问任何数据。LINQ 可以用于模型数据的简单操作，但 LINQ to SQL 则不行！MVC 适用于应该已经知道这一点的人——这就是我喜欢它的原因——由聪明的人为聪明的人制作。

*   数据绑定旧版 ASP.NET 控件 - 如果替代方案不可用或需要临时解决方案。
*   查看需要递归以创建某种嵌套或分层 HTML 的逻辑。
*   查看使用临时变量的逻辑。我拒绝在我的标签汤中定义局部变量！我至少希望它们作为视图类的属性。
*   仅特定于一个视图或模型且不属于 HtmlHelper 的逻辑。作为旁注，我认为 HtmlHelper 不应该知道任何“模型”类。`IEnumerable<Product>`如果它知道模型中定义的类（例如`ProductModel`.
*   当您键入时，HtmlHelper 方法最终会从您的所有视图中可见`Html+dot`，我真的想尽可能地最小化这个列表。
*   如果我想编写代码，使用`HtmlGenericControl`该命名空间中的其他类以面向对象的方式生成我的 HTML（或者我有执行我想要移植的现有代码）。
*   如果我打算将来使用不同的视图引擎怎么办。我可能希望将一些逻辑保留在标签汤之外，以便以后更容易重用。
*   如果我希望能够重命名我的模型类并让它自动重构我的视图，而无需转到 view.aspx 并更改类名，该怎么办？
*   如果我正在与一个我不信任的 HTML 设计师协调，他不会弄乱“标签汤”，并且想要在 .aspx.cs 文件中编写除非常基本的循环之外的任何内容。

我认为人们对“代码隐藏”有偏见，因为它传统上被解释为“事件处理代码”，而不是“视图部分类的另一半”。

视图的代码隐藏很好。

我并不反对它会使文件夹结构有些混乱，但这就是`+`图标的用途。我只希望能够使用“添加视图”创建带有代码隐藏的视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T22:46:31.470

要直接回答您的问题，我认为您无法更改此默认设置。您可以尝试修改模板（在 %programfiles%\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates" 中的某个位置），但我不确定。

但是，这种场景的“MVC 方式”可能是在一个单独的类中创建一个自定义帮助器。

我最近编写了一个使用 Gravatar ( [http://www.gravatar.com](http://www.gravatar.com) ) 生成个人资料图片的网络应用程序，并且我一直在我的视图中编写相同的自定义 <img> 标签，因此我创建了一个帮助程序：Html.Gravatar( )

只需创建一个静态类“MyHelpers”或“GravatarHelpers”或“FooHelpers”并添加带有如下签名的静态扩展方法：

```
public static string Gravatar(this HtmlHelper htmlHelper, string emailAddress) {
    return htmlHelper.Image(...);
} 
```

或者，如果您使用强类型视图 (ViewPage<T>) 并希望利用它，您可以扩展 HtmlHelper<T>

```
public static string Foo<TModel>(this HtmlHelper<TModel> htmlHelper, ...) {
    // Do stuff
    return // Stuff
} 
```

您可以轻松地将 HtmlHelper 切换为 UrlHelper 或 AjaxHelper。我相信您还可以从助手上的 ViewContext 属性访问 ViewData 等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T22:50:40.243

这似乎真的不是一个好主意。我读过的每条评论都说“不要使用代码隐藏；我们希望它不存在”。并且我同意。`HtmlHelper`您可以尝试在扩展方法（传统上是 on ）中编写逻辑，例如[此处](https://stackoverflow.com/questions/347528/using-scripts-in-a-master-page-with-asp-net-mvc#347565)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-12T19:17:31.357

我认为文件背后的代码仍然是有用的东西。尽管许多人谈论它们有多糟糕，因为它们提供了一种打破 MVC 所追求的设计模式的方法，但它们并不是天生就这样做的。您可以说视图应该是愚蠢的，但我认为说视图不应该关注复杂的业务逻辑可能更准确。然而，它确实需要关注呈现的各个方面。因此，除了简单的 html 之外，仍然存在需要代码来呈现信息的元素。它遵循关注点分离的推理（更不用说视图的纯可读性），标记本身与标记相关，并且在需要代码的地方支持它的代码。

Luis Abreu 写了一篇关于这个主题的好文章

[asp.net mvc 中的代码隐藏文件并不邪恶](http://msmvps.com/blogs/luisabreu/archive/2008/09/19/codebehind-files-in-asp-net-mvc-are-not-evil.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-04T18:10:11.573

仅供参考 - 在 Visual Studio 2010 中，只需将适当命名的代码文件添加到包含视图的文件中，就会自动将新的代码隐藏文件与视图相关联。您无需删除并重新添加文件即可将它们链接起来。但是，您仍然需要更改继承的类以使其像@Harry 描述的那样工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T21:12:56.907

我还希望将代码隐藏作为默认设置，但找不到更改它的方法。此页面说明如何将代码隐藏添加到页面：http: [//msdn.microsoft.com/en-us/magazine/cc301556.aspx](http://msdn.microsoft.com/en-us/magazine/cc301556.aspx)。

在我看来，代码隐藏类是数据绑定控件的理想选择，并在必要时对数据进行一些小的更改（例如日期和货币格式）。到目前为止，Repeaters 是显示数据列表的最简单方法，我仍然找不到遍历匿名类型集合的方法，并且页面中只有一个 for 语句让我想起 PHP：S

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T07:06:57.693

[我在这里](https://stackoverflow.com/questions/680448/asp-net-mvc-how-to-add-a-code-behind-page-to-a-partial-view)回答了这个问题：

**如何将代码隐藏页面添加到部分视图**

似乎这并不是特别棘手，而且非常可行这个答案适用于部分“ViewUserControl”，但同样适用

行。

第一：添加一个带有.cs约定的Class文件（即view.ascx.cs）

第二：添加“使用System.Web.Mvc；” 到班级

第三：将类更改为从“ViewUserControl<>”继承

第四：将以下内容添加到视图的标题中：

```
CodeBehind="View.ascx.cs" Inherits="Project.Views.Shared.View" 
```

第五：将文件复制出解决方案并拖回以将两者重新关联在一起

注意：要使用普通 MVC 视图，您只需要从“ViewPage”继承类

# c# - 最早访问 .net 生命周期

> ID：489417
> 
> 赞同：1
> 
> 时间：2009-01-28T21:15:31.653
> 
> 标签：c#, .net, iis-7, httpmodule, lifecycle

在查看 .net 上的 IIS7 应用程序生命周期后：

[http://msdn.microsoft.com/en-us/library/ms178473.aspx](http://msdn.microsoft.com/en-us/library/ms178473.aspx)

为了获得最佳性能，我想找到一种方法来在创建 HttpContext 对象但在 HttpApplication 之前启动我的代码。（在加载 HttpApplication 类之后运行代码很容易，但在使用 HTTP 模块的构造函数触发任何事件之前，如下所示：

```
 public class AuthModule : IHttpModule 
    {     
        public AuthModule()
        {
            HttpContext.Current.Response.Write("hello world");
            HttpContext.Current.Response.End();
        }

        #region IHttpModule Members

        public void Dispose()
        {  }

        public void Init(HttpApplication context)
        {   }

        #endregion
    } 
```

我知道我无法访问 User 对象，但我不需要它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T01:40:55.340

您永远无法确保您的代码在 HttpApplication 实例创建之前启动，因为这些实例可能会被重用。

此外，在这个阶段运行代码超出了管道的范围。它应该让你问自己这是否真的是一件明智的事情。

这与性能有关吗？你真的认为创建 HttpApplication 实例的时间会影响你的表现吗？

退后一步，重新考虑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T01:22:18.247

查看[MSDN 上的生命周期事件](http://msdn.microsoft.com/en-us/library/ms178472.aspx)。如果您想要比正常页面事件更早的事件，您可以考虑使用其中一个事件。

# sql - 您将如何编写此查询？

> ID：489420
> 
> 赞同：1
> 
> 时间：2009-01-28T21:17:03.147
> 
> 标签：sql, refactoring, rewrite

我希望将以下查询重构为更具可读性和可修改性的内容。前半部分与后半部分相同，但查询的数据库除外（但表名相同。）

```
 SELECT
    Column 1 AS c1,
    ...
    Column N AS cN
  FROM
    database1.dbo.Table1

UNION

  SELECT
    'Some String' as c1,
    ...
    NULL as cN
  FROM
    database1.dbo.Table2

UNION

  SELECT
    Column 1 AS c1,
    ...
    Column N AS cN
  FROM
    database2.dbo.Table1

UNION

  SELECT
    'Some String' as c1,
    ...
    NULL as cN
  FROM
    database2.dbo.Table2 
```

这个查询是[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)的定义，并要求我重写，但我不知道怎么写！

**编辑**：我们不能使用 linq，我们希望得到不同的结果；我希望使查询的物理文件大小更小，而不是返回的结果。

**编辑**：我要查询的数据库是专有的 ERP 数据库。重组它不是一种选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T21:22:32.607

我要在这里冒个险，说，根据你给我们的信息；

**这就像它会得到的一样好**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T21:22:29.250

我立即看到的一个性能提示是使用`UNION ALL`而不是，`UNION`除非您故意想要不同的记录。一个简单的`UNION`将消除需要时间的重复。`UNION ALL`不这样做。

你可以用动态 SQL 和循环重写它，但我认为结果会更糟。如果有足够的重复代码来证明动态 sql 方法的合理性，那么我想它可能是合理的。

或者，您是否考虑过将存储过程中的逻辑移到 LINQ 之类的东西中？对于许多人来说，这不是一个选择，所以我只是问。

最后一点：抵制修复没有损坏的东西的冲动，只是为了让它看起来更干净。如果清理有助于维护、验证等，那么就去做吧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T23:09:25.680

这是一个非常标准的 SQL 模式。有时很容易不经意地将 OOP/过程代码原则（如 DRY）转移到 SQL，但它们不一定是可转移的概念。

请注意，您可以轻松地了解查询的整个逻辑设计，而不是通过子模块进行搜索。如果其中一个子表达式有一个额外的列，或者列颠倒了，它就会突出。这基本上是一个非常简单的 SQL 语句，可以作为一个执行单元来理解，分解它会混淆它。

当您进行调试时，能够使用编辑器的文本突出显示选项来选择性地执行语句的某些部分非常方便——这是过程代码中不存在的一种技术。OTOH，如果它们分散到视图等中，试图追踪所有碎片可能会变得混乱。即使是 CTE 也会使这变得不方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T21:23:20.217

有什么问题？太长？太重复了？

有时你会得到丑陋的 SQL——你对此无能为力。

除非您想使用单独的视图然后将它们合并在一起，否则我看不到任何清理它的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T21:32:49.887

我投票赞成意见，这会带来几乎足够的零开销（好吧，也许编译时间成本很小，但这应该就是全部了）。然后你的 procs 就变成了某种形式

```
SELECT * FROM database1.view1
UNION
SELECT * FROM database1.view2
UNION
SELECT * FROM database2.view1
UNION
SELECT * FROM database2.view2 
```

我不确定我是否想进一步压缩它，尽管我预计大多数平台都会容忍它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T21:42:26.747

关于动态 SQL 主题 - 这是一个示例 - 不确定它是否更好。好处是您只需编写一次 SELECT 列表。

```
DECLARE @Select1 varchar(1000)
DECLARE @Select2 varchar(1000)

DECLARE @SQL varchar(4000)

SET @Select1 = 'SELECT
    Column 1 AS c1,
    ...
    Column N AS cN'

SET @Select2 = 'SELECT
    ''Some String'' as c1,
    ...
    NULL as cN'

SET @SQL = @Select1 + ' FROM database1.dbo.Table1 '

SET @SQL = @SQL + ' UNION ' + @Select2 + ' FROM database1.dbo.Table2 '

SET @SQL = @SQL + ' UNION ' + @Select1 + ' FROM database2.dbo.Table1 '

SET @SQL = @SQL + ' UNION ' + @Select2 + ' FROM database2.dbo.Table2 '

EXEC @SQL 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T21:59:59.473

如果你所有的 proc 看起来像这样 - 你可能遇到了架构问题。

您对 table2 的所有调用都只有一个有用的字段吗？（并且由于 UNION，最终只有一排？）

我完全赞同为这项工作使用参数化动态 SQL 和/或代码生成的想法，甚至使用`INFORMATION_SCHEMA`. 这并不完全是您所需要的，但它是一个开始（您可能会生成一个数据库和表的表）：

```
DECLARE @template AS varchar(MAX)
SET @template = 'SELECT {@column_list} FROM {@database_name}.dbo.{@table_name}'
DECLARE @column_list AS varchar(MAX)

SELECT @column_list = COALESCE(@column_list + ',', '') + COLUMN_NAME
FROM database1.dbo.INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = @table_name
ORDER BY ORDINAL_POSITION

DECLARE @sql AS varchar(MAX)
SET @sql = @template
SET @sql = REPLACE(@sql, '{@column_list}', @column_list)
SET @sql = REPLACE(@sql, '{@database_name}', @database_name)
SET @sql = REPLACE(@sql, '{@table_name}', @table_name) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T11:23:49.843

根据返回的行数，您最好在选择上使用 UNION ALL 并围绕它进行选择不同的查询。我以前见过类似的问题，并且对两种不同的样式有不同的执行计划

```
SELECT DISTINCT subquery.c1, subquery.cN
从
(
SELECT Column 1 AS c1, Column N AS cN FROM database1.dbo.Table1
联合所有
SELECT 'Some String' as c1, NULL as cN FROM database1.dbo.Table2
联合所有
SELECT Column 1 AS c1, Column N AS cN FROM database2.dbo.Table1
联合所有
SELECT 'Some String' as c1, NULL as cN FROM database2.dbo.Table2
) 子查询

```

# c# - 将列添加到绑定到 DataGridView 的 DataTable 不会更新视图

> ID：489425
> 
> 赞同：4
> 
> 时间：2009-01-28T21:19:00.723
> 
> 标签：c#, winforms, visual-studio-2008, datagridview, datatable

我有一个从 CSV 文件填充的 DataTable，然后使用 DataGridView 在内存中编辑数据。据我了解，数据的编程编辑应该在用户编辑完成的 DataTable 上完成。数据网格视图。

但是，当我以编程方式向 DataTable 添加列时，它不会自动反映在 DataGridView 中，我怀疑反之亦然。

你如何保持两者同时存在？我认为数据绑定的想法是这是自动的......

添加行也可以正常工作。

* * *

**解决了：**

尽管在属性对话框中（并在代码中明确设置），`AutoGeneratedColumns`但`false`在设计器代码中设置为。`true`初始列是以编程方式生成的，因此不应该出现，但是由于设计器代码还继续生成最初用于调试的“设计在”列，因此没有发现这一点。

道德：检查自动生成的代码！

除此之外，请参阅[这篇文章](https://stackoverflow.com/questions/499321/)和[这篇文章](https://stackoverflow.com/questions/530176/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T22:21:17.103

这听起来不对。为了测试它，我编写了一个简单的应用程序，它创建了一个 DataTable 并向其中添加了一些数据。
在`button1.Click`它将表绑定到 DataGridView。
然后，我添加了第二个按钮，当单击该按钮时，会将另一列添加到基础 DataTable。
当我测试它并单击第二个按钮时，网格立即反映了更新。

为了测试反向，我添加了第三个按钮，它会弹出一个对话框，其中包含绑定到同一个 DataTable 的 DataGridView。然后，在运行时，我向第一个 DataGridView 添加了一些值，当我单击按钮调出对话框时，这些更改就会反映出来。

我的观点是，他们应该保持并发。`AutoGenerateColumns`当他建议您检查是否设置为时，马克可能是对的`true`。不过，您不需要调用 DataBind，这仅适用于 Web 上的 DataGridView。也许您可以发布您正在做的事情，因为这应该有效。

我如何测试它：

```
DataTable table = new DataTable();
public Form1()
{
    InitializeComponent();
}

private void button1_Click(object sender, EventArgs e)
{
    table.Columns.Add("Name");
    table.Columns.Add("Age", typeof(int));
    table.Rows.Add("Alex", 26);
    table.Rows.Add("Jim", 36);
    table.Rows.Add("Bob", 34);
    table.Rows.Add("Mike", 47);
    table.Rows.Add("Joe", 61);

    this.dataGridView1.DataSource = table;
}

private void button2_Click(object sender, EventArgs e)
{
    table.Columns.Add("Height", typeof(int));
    foreach (DataRow row in table.Rows)
    {
        row["Height"] = 100;
    }
}

private void button3_Click(object sender, EventArgs e)
{
    GridViewer g = new GridViewer { DataSource = table };
    g.ShowDialog();
}

public partial class GridViewer : Form //just has a DataGridView on it
{
    public GridViewer()
    {
    InitializeComponent();
    }

    public object DataSource
    {
        get { return this.dataGridView1.DataSource; }
        set { this.dataGridView1.DataSource = value; }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T21:31:58.407

AutoGenerateColumns 是否设置为 true？如果您在初始绑定之后进行更改，您还必须调用 DataBind() 来重新绑定更改的数据源。我知道这对于 AJAX 回调是正确的，我*认为*对于 WinForms 控件 PostBack 也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-29T17:09:27.060

这是另一个不需要为数据网格分配“名称”的解决方案，因此数据网格可以是模板元素。

（在我的例子中，数据网格是 TabControl.ContentTemplate 中的一个模板元素）

显示新列（在初始绑定后以编程方式添加）的关键是强制刷新数据网格。从[Force WPF DataGrid to regenerate self](https://stackoverflow.com/questions/7595583/force-wpf-datagrid-to-regenerate-itself)中的答案来看，Andres 建议将设置`AutoGenerateColumns`从 false 设置为 true 将强制 datagrid 刷新。

这意味着我只需要：

1.  绑定`AutoGenerateColumns`到我的对象的属性
2.  在添加列之前将属性设置为 false
3.  添加列后将属性设置为true。

这是代码：

XAML：

```
<DataGrid AutoGenerateColumns="{Binding toggleToRefresh}"
          ItemsSource="{Binding dataTable}"
          /> 
```

C＃：

```
 public class MyTabItem : ObservableObject 
 {
        private DataTable _dataTable = new DataTable();
        public DataTable dataTable
        {
            get { return _dataTable; }
        }

        private bool _toggleToRefresh = true;
        public bool toggleToRefresh
        {
            get { return _toggleToRefresh; }
            set
            {
                if (_toggleToRefresh != value)
                {
                    _toggleToRefresh = value;
                    RaisePropertyChanged("toggleToRefresh");
                }
            }
        }

        public void addDTColumn()
        {
            toggleToRefresh = false;
            string newColumnName = "x" + dataTable.Columns.Count.ToString();
            dataTable.Columns.Add(newColumnName, typeof(double));
            foreach (DataRow row in dataTable.Rows)
            {
                row[newColumnName] = 0.0;
            }
            toggleToRefresh = true;
        }

        public void addDTRow()
        {
            var row = dataTable.NewRow();
            foreach (DataColumn col in dataTable.Columns)
            {
                row[col.ColumnName] = 0.0;
            }
            dataTable.Rows.Add(row);
        }
 } 
```

希望这有帮助:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-28T22:30:19.957

我有同样的问题，我发出了 DataBind()。这不是万能的灵丹妙药，但它在某些情况下对我有帮助。在通过 DataView 捕获信息之前，我必须在 EditCommand 和 UpdateCommand 事件之后立即在 EditItemIndex 语句之后将其放入，

```
protected void datalistUWSolutions_EditCommand(object source, DataListCommandEventArgs e)
{
  datalistUWSolutions.EditItemIndex = e.Item.ItemIndex;
  datalistUWSolutions.DataBind(); // refresh the grid.
} 
```

和

```
protected void datalistUWSolutions_UpdateCommand(object source, DataListCommandEventArgs e)
{
  objDSSolutions.UpdateParameters["Name"].DefaultValue = ((Label)e.Item.FindControl("lblSolutionName")).Text;
  objDSSolutions.UpdateParameters["PriorityOrder"].DefaultValue = ((Label)e.Item.FindControl("lblOrder")).Text;
  objDSSolutions.UpdateParameters["Value"].DefaultValue = ((TextBox)e.Item.FindControl("txtSolutionValue")).Text;
  objDSSolutions.Update();
  datalistUWSolutions.EditItemIndex = -1; // Release the edited record
  datalistUWSolutions.DataBind();         // Redind the records for refesh the control
} 
```

# c# - 在 SQL Server CLR 过程中使用 OLEDB 驱动程序的问题

> ID：489428
> 
> 赞同：0
> 
> 时间：2009-01-28T21:19:25.623
> 
> 标签：c#, sql-server, oledb, impersonation, sqlclr

我们正在尝试在 SQL Server 2005 机器上创建 C# CLR 存储过程。C# 代码通过 OLEDB 驱动程序连接到外部数据源以获取数据表。它已经在单独的控制台应用程序上进行了测试，并且可以正常运行。（OLEDEB 驱动程序是连接到专有数据库的专有驱动程序......）

在 SQL Server 上，我们已经为程序集设置了 EXTERNAL 权限级别，它是 StrongNamed 并且已经在 SQL Server 中为其创建了一个 ASSYMETRIC KEY。

当我们尝试执行该过程时，我们会遇到以下两个问题：

*   用于联系 OLEDB 的凭据是运行 SQL 服务的凭据，而不是 sql contect 中已登录用户的凭据

*   提出了一个 .NET 框架：

    System.Security.SecurityException：请求 System.Data.OleDb.OleDbPermission 类型的权限

似乎我们无法为进程授予运行 oledb 驱动程序所需的权限。要么是缺少配置，要么是我们做错了什么。将权限级别设置为 UNSAFE 也不是一种选择......

有没有人对这类问题有任何经验。欢迎任何意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:30:46.223

关于您的第一个问题（模仿）：

[http://blogs.msdn.com/sqlprogrammability/archive/2006/06/16/635004.aspx](http://blogs.msdn.com/sqlprogrammability/archive/2006/06/16/635004.aspx)

[http://www.codeproject.com/KB/database/SQLCLRIntegrationSecurity.aspx](http://www.codeproject.com/KB/database/SQLCLRIntegrationSecurity.aspx)

# django - 将报告添加到 Django 的管理员

> ID：489429
> 
> 赞同：16
> 
> 时间：2009-01-28T21:20:21.017
> 
> 标签：django, django-admin

我希望向我的自动生成的管理站点添加一组额外的页面。我想从我的模型和一些围绕它的日志中生成报告。实际生成不是问题。

我如何：

1.  让报告输出看起来像是一个管理页面，带有面包屑、类似格式的表格等？
2.  注册视图以使其显示在首页上？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T16:47:52.997

上面的答案没有解决问题2，至少直接......让您的自定义视图显示为管理员首页的“hack”方式可能只是在urlconf中覆盖它：

```
(r'^admin/$', my.custom.admin.homepage), 
```

在正常的管理行之前：

```
(r'^admin/', admin.site.root), 
```

但是，“正确”的做法是让您的管理员成为 AdminSite 的自定义实例并覆盖 index_template 设置。[http://docs.djangoproject.com/en/dev/ref/contrib/admin/#root-and-login-templates](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#root-and-login-templates)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T21:28:15.340

在生成 admin 的外观和感觉方面，继承 admin 的父页面并将您自己的模板内容插入到适当的块中应该是微不足道的。

查看默认管理页面中的标记（包括 id 和 class 属性），并尝试了解事物的样式是如何一致的。如果您在页面上包含管理 CSS，您应该可以免费获得很多。

有关更多信息，请查看管理文档：[http ://docs.djangoproject.com/en/dev/ref/contrib/admin/](http://docs.djangoproject.com/en/dev/ref/contrib/admin/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T14:54:39.777

这是一个帮助您入门的基本模板：

```
 {% extends "admin/base_site.html" %}
    {% load adminmedia %}

    {% block extrahead %}
    {% endblock %}
    {% block coltype %}flex{% endblock %}
    {% block bodyclass %}change-list{% endblock %}
    {% block stylesheet %}{% admin_media_prefix %}css/changelists.css{% endblock %}
    {% block extrastyle %}
    <link rel="stylesheet" type="text/css" href="{{settings.MEDIA_URL}}/stylesheets/extra_admin.css" />
    {% endblock %}
    {% block breadcrumbs %}<div class="breadcrumbs"><a href="/admin/">Home</a>&nbsp;&rsaquo;&nbsp;{{page_title}}</div>{% endblock %}
    {% block content %}
    <div id="content-main">
        <h1>{{page_title}}</h1>
        {{page_content}}
    </div>
    {% endblock %} 
```

# caching - 代理缓存使廉价的 wimax 有用

> ID：489435
> 
> 赞同：0
> 
> 时间：2009-01-28T21:21:30.173
> 
> 标签：caching, proxy

通过我的工作，我可以获得便宜的 wimax，但带宽限制为 200MB/月

我经常在上班的火车上从事个人编程项目。为此，我通常不需要网络访问，即使我确实需要访问；它通常用于我已经访问过的页面。

有没有办法以相对透明的方式缓存我的网络访问。我在考虑一个缓存代理。

我希望能够告诉它：

*   缓存来自[https://developer.mozilla.org](https://developer.mozilla.org)的所有内容（如果他们提供可下载的文档会很好）

*   不要缓存谷歌

*   缓存来自 gmail 和 facebook 的 javascript、css 和图像（可能每周更新一次）

*   完全阻止 youtube（带宽占用）

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:26:57.650

Squid Cache 符合您的要求吗？

[http://www.squid-cache.org/](http://www.squid-cache.org/)

# c# - 无法获得所需的权限

> ID：489437
> 
> 赞同：2
> 
> 时间：2009-01-28T21:21:59.783
> 
> 标签：c#, asp.net, .net-3.5, permissions

> **可能重复：**
> [IIS7 无法授予最低权限请求](https://stackoverflow.com/questions/1846816/iis7-failed-to-grant-minimum-permission-requests)

我正在开发一个 ASP.NET 网站，但出现异常：

`Required permissions cannot be acquired.`

有没有办法找出缺少哪些权限？

我知道导致异常的程序集，但我不知道它需要哪个权限。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-04-20T09:54:51.143

[IIS7 无法授予最低权限请求](https://stackoverflow.com/questions/1846816/iis7-failed-to-grant-minimum-permission-requests)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T21:27:49.553

通常，发生此异常是因为您的程序集正在请求 IIS 无法授予的权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T08:44:19.467

permcalc - 沙盒

将信息存储到可在 web.config 文件中使用的 xml 文件中。

# mysql - 使用 REF_CURSOR 转换 Oracle 存储过程并将全局变量打包为 Postgresql 或 MySQL

> ID：489441
> 
> 赞同：2
> 
> 时间：2009-01-28T21:22:47.737
> 
> 标签：mysql, oracle, postgresql, global-variables, ref-cursor

这个包使用了 Oracle 的两个独特的特性，REF_CURSOR 和一个包全局变量。我想将功能从 Oracle 移植到 Postgresql 或 MySQL。

```
PACKAGE tox IS
    /*=======================*/
        g_spool_key spool.key%TYPE := NULL;
        TYPE t_spool IS REF CURSOR RETURN spool%ROWTYPE;
    /*=======================*/
        PROCEDURE begin_spool;
    /*=======================*/
        PROCEDURE into_spool
            (
            in_txt IN spool.txt%TYPE
            );
    /*=======================*/
        PROCEDURE reset_spool;
    /*=======================*/
        FUNCTION end_spool
            RETURN t_spool;
    /*=======================*/
        FUNCTION timestamp
            RETURN VARCHAR2;
    /*=======================*/
    END tox;

PACKAGE BODY tox
    IS
    /*========================================================================*/
    PROCEDURE begin_spool
        AS
        /*=======================*/
        BEGIN
        /*=======================*/
            SELECT
                key.NEXTVAL
            INTO
                g_spool_key
            FROM
                DUAL;
        /*=======================*/
        END begin_spool;
    /*========================================================================*/
    PROCEDURE into_spool
        (
        in_txt IN spool.txt%TYPE
        )
        AS
        /*=======================*/
        BEGIN
        /*=======================*/
            INSERT INTO
                spool
            VALUES
                (
                g_spool_key,
                in_txt,
                seq.NEXTVAL
                );
        /*=======================*/
        END into_spool;
    /*========================================================================*/
    PROCEDURE reset_spool
        AS
        /*=======================*/
        BEGIN
        /*=======================*/
            DELETE
                spool
            WHERE
                key = g_spool_key;
            COMMIT;
            begin_spool;
        /*=======================*/
        END reset_spool;
    /*========================================================================*/
    FUNCTION end_spool
        RETURN t_spool
        AS
        v_spool t_spool;
        /*=======================*/
        BEGIN
        /*=======================*/
            COMMIT;
            OPEN v_spool FOR
                SELECT
                    *
                FROM
                    spool
                WHERE
                    key = g_spool_key
                ORDER BY
                    seq;
            RETURN v_spool;
        /*=======================*/
        END end_spool;
    /*========================================================================*/
    FUNCTION timestamp
        RETURN VARCHAR2
        AS
        /*-----------------------*/
        v_result VARCHAR2(14);
        /*=======================*/
        BEGIN
        /*=======================*/
            SELECT
                TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
            INTO
                v_result
            FROM
                DUAL;
            RETURN v_result;
        /*=======================*/
        END timestamp;
    /*========================================================================*/
    END tox; 
```

**你能产生等效的代码吗？对于PostgreSQL？对于 MySQL？**

注意：Oracle 代码是线程安全的。这是一个关键特性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T16:54:57.203

**PostgreSQL 8.3**

PostgreSQL 中的问题是缺少全局（或包）变量，因此必须使用首先创建的临时表来解决这部分问题。其余的很容易。

如果您认真考虑将应用程序移植到 PostgreSQL 或 MySQL，我建议您根本不要使用全局变量，因为它们在编码时是不好的做法（至少根据我的说法 :)）

但无论如何，这里是代码：

*这必须在运行函数之前存在：*

```
create table spool (key integer, txt varchar(2048), seq integer);
create sequence s_key;
create sequence s_seq;
create schema tox;
create temp table globals (name varchar(10), value varchar(100), primary key(name)); 
```

*这些函数被放入模式 tox 以模拟一个包。*

```
create or replace function tox.get_variable(var_name varchar) returns varchar as $$
declare 
    ret_val varchar(100);
begin
    select value into ret_val from globals where name = var_name;
    return ret_val;
end
$$ language plpgsql;

create or replace function tox.set_variable(var_name varchar, value anyelement) returns void as $$
begin
    delete from globals where name = var_name;
    insert into globals values(var_name, value);
end;
$$ language plpgsql;

create or replace function tox.begin_spool() returns integer as $$
begin
    perform tox.set_variable('key', nextval('s_key')::varchar);
    return tox.get_variable('key'); 
end;
$$ language plpgsql;

create or replace function tox.reset_spool() returns integer as $$
begin
    delete from spool where key = tox.get_variable('key')::integer;
    return tox.begin_spool();
end;
$$ language plpgsql;

create or replace function tox.into_spool(in_txt spool.txt%TYPE) returns void as $$
begin
    insert into spool values(tox.get_variable('key')::integer, in_txt, nextval('s_seq'));
end;
$$ language plpgsql;

create or replace function tox.end_spool(refcursor) returns refcursor as $$
declare
begin
    open $1 for select * from spool where key = tox.get_variable('key')::integer order by seq;
    return $1;
end;
$$ language plpgsql;

create or replace function tox.test(txt varchar(100)) returns setof spool as $$
declare 
    v_spool_key integer;
    cnt integer;
begin
    v_spool_key = tox.begin_spool();

    for cnt in 1..10 loop
    perform tox.into_spool(txt || cnt); 
    end loop;

    perform tox.end_spool('spool_cursor');
    return query fetch all from spool_cursor;
end;
$$ language plpgsql; 
```

要进行测试，只需在创建完所有内容后运行它。

```
select * from tox.test('Test'); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-31T22:40:07.433

对于 mysql：

1.  对于 ref_cursor 您可以在过程中使用常规选择。如果您发出 select 语句，Mysql 有一个从存储过程返回的隐式结果集。[在这里](https://stackoverflow.com/questions/273929/what-is-the-equivalent-of-oracles-ref-cursor-in-mysql-when-using-jdbc/445434#445434)查看我的答案。
2.  对于包全局变量，你可以把它放在一个表中，但是从你的代码看它是一个序列，所以可以用一个auto_increment字段来替换它。那应该很简单。

如果您可以在问题中发布假脱机表的定义，这将有所帮助。然后我可能会为您提供 mysql 的确切代码。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-02T23:22:13.947

这是使用 MySQL 5.1.30 测试的解决方案。

关于您对线程安全的要求，MySQL[用户变量](http://dev.mysql.com/doc/refman/5.1/en/user-variables.html)机制应该会有所帮助。这允许您访问[`SET`](http://dev.mysql.com/doc/refman/5.1/en/set-option.html)其状态仅限于当前会话的变量。其他会话也可以创建同名变量，并在其中保留不同的值。

我假设你所说的线程安全是指这样的东西——会话范围的状态。因为您不能在数据库中真正拥有更细粒度的线程安全状态。应用程序的每个线程都必须有自己的数据库会话。

MySQL 中没有包，因此用户变量对于会话是全局的。碰巧使用同名变量的另一个存储过程将发生冲突。

```
CREATE TABLE spool (
  `key` INT,
  txt   VARCHAR(2048),
  seq   INT AUTO_INCREMENT PRIMARY KEY
);

CREATE TABLE spool_key (
  `key` INT AUTO_INCREMENT PRIMARY KEY
);

DELIMITER $$
CREATE PROCEDURE begin_spool ()
BEGIN
  DELETE FROM spool_key;
  INSERT INTO spool_key (`key`) VALUES (DEFAULT);
  SET @sp_key = LAST_INSERT_ID();
END $$

CREATE PROCEDURE into_spool(IN in_txt VARCHAR(2048))
BEGIN
  INSERT INTO spool (`key`, txt, seq) VALUES
    (@sp_key, in_txt, DEFAULT);
END $$

CREATE PROCEDURE reset_spool()
BEGIN
  DELETE spool FROM spool JOIN spool_key USING (`key`);
  CALL begin_spool();
END $$

CREATE PROCEDURE end_spool()
BEGIN
  SELECT *
  FROM spool JOIN spool_key USING (`key`)
  ORDER BY seq;
END $$
DELIMITER ;

CALL begin_spool();
CALL into_spool('now is the time');
CALL into_spool('for all good men');
CALL end_spool();
CALL reset_spool();
CALL into_spool('to come to the aid');
CALL into_spool('of their country');
CALL end_spool();

DROP FUNCTION IF EXISTS fmt_timestamp;
CREATE FUNCTION fmt_timestamp() RETURNS CHAR(14)
RETURN DATE_FORMAT(SYSDATE(), '%Y%m%d%H%i%s');

SELECT fmt_timestamp(); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-04T19:06:15.913

我很难理解您的代码中的几件事。看起来您有一个包含两个序列的表，但其中只有一个是真正的 auto_increment 列。

在 mysql 中，auto_increment 只允许在表中的一列上。您是否考虑过将另一列作为另一个表的自动递增列的外键？

全局变量很棘手，因为 mysql 没有它们。我认为唯一的解决方案是将它作为标量存储在表中，然后用外键将数据绑定到它。

最后，正如我在之前的回答中指出的那样，返回一个 ref 游标很容易。在链接提供（不同的答案）中，您可以看到代码示例。

# asp.net - 我可以使用 ASP.NET 的“OutputCache”控件缓存图像而不会影响性能吗？

> ID：489447
> 
> 赞同：4
> 
> 时间：2009-01-28T21:24:29.933
> 
> 标签：asp.net, outputcache

我有一些动态生成图像的 ASP.NET MVC 操作（尽管它同样可以是 ASPX 页面）。

我正在使用 [OutputCache] 缓存这些图像。我只是想知道是否需要担心 ASP.NET 在内存中缓存图像并占用太多资源。这些是仅包含几十种产品的购物车的不同尺寸的产品图像。

OutputCache 将使用磁盘还是仅在内存中？它有多智能？还是我应该自己将图像保存到磁盘并实现我自己的缓存系统（这实际上是当前的实现）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T22:31:43.543

出于所有意图和目的，我相信输出缓存完全在内存中 - 这意味着如果应用程序池被回收，则需要再次生成图像。

过去我不得不做类似的事情，我实际上实现了一个两层系统，主要使用 HTTP 缓存，并使用文件系统作为后备。如果某些东西不存在，我会生成图像并将其保存到磁盘并将其放入缓存中。这样，如果它被推出缓存或应用程序池回收，我只需将它从磁盘加载（看起来你已经做了同样的事情）。

至于“内存过多”，如果显式使用HttpContext.Cache而不是[OutputCache]，就可以控制缓存中item的优先级。然后，您可以调整应用程序池的设置以控制它总体使用的内存量，但我不确定除此之外还有很多工作要做。几张图片 * 12 个产品似乎不会占用我大量的内存。

在不了解您的应用程序的任何其他信息的情况下，对我来说听起来您可以只使用输出缓存就可以逃脱。但是，如果您需要更健壮和可扩展的东西，我会使用我描述的两层系统。但是，如果您已经实施并工作，“如果它没有损坏......”

# computer-science - 关键字/标签的空间映射

> ID：489453
> 
> 赞同：2
> 
> 时间：2009-01-28T21:25:40.150
> 
> 标签：computer-science, taxonomy

我试图了解构建相关/常见关键字或标签的空间地图的策略或想法。以 SO 为例；如果您访问[https://stackoverflow.com/tags](https://stackoverflow.com/tags)并输入“python”，您将获得包含该单词的所有标签，但没有可能密切相关的标签（WSGI、Google 的 App Engine、flying 等） .

根据我的问题，您如何构建一个可以查询的空间图，以从搜索中找到密切相关的标签/关键字，按权重排序？但是，如何将标签 foo 的权重存储到可能更大数量的标签中，并且仍然保持系统响应？

我已经看过 David Weinberger 的 Google 技术演讲，这是一个让我思考的很棒的技术演讲。 [http://video.google.com/videoplay?docid=2159021324062223592&ei=qseASZvgI6e4qAP91a2PDg&q=google+tech+talk](http://video.google.com/videoplay?docid=2159021324062223592&ei=qseASZvgI6e4qAP91a2PDg&q=google+tech+talk)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T12:28:51.380

查看 O'Reilly 的[“Programming Collective Intelligence”](http://oreilly.com/catalog/9780596529321/)中的集群概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T23:21:36.610

似乎最有可能构建有关此类关系的数据的方法是分类哪些标签最常一起出现，同时与其他标签的数量最少。

也就是说，“c++”和“stl”经常一起出现，而“stl”很少（？）出现没有“c++”，所以它们是相关的（至少在一个方向上）。"c++" 和 "algorithm" 也经常一起出现，但分开出现的次数更多，所以没有关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T00:27:42.933

在考虑如何构建数据时，我的一个想法可能是一个四表系统。一个表将是源数据（例如，必须有某种问题表），它连接到一个标签表，然后一个标签权重表连接回标签表。

```
#pseudo code
     source table {
     id: int
     source_data: text   
     }

     source_tag table {
        source_id: int
        tag_id: int
     }

     tag table{
      id: int
      tag: String(30)
     }

    tag_weight table {
        base_tag_id: int
        weight: float( 0-10 or 100 ) or int ( count of mutual occurrence )
        source_tag_id: int      
    } 
```

我不知道这种结构的效率有多高，但我认为它有一些工作要做。否则，为了使其工作，对源数据的新准入可能会触发更新后触发器，或者在后台有一个工作进程在预设时间重新平衡权重。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-28T22:09:44.007

你需要一个好的搜索引擎。;)

自己动手：实现一种相似性算法。例如：[Levenshtein distance](http://en.wikipedia.org/wiki/Levenshtein_distance)或[Dice's coefficient](http://en.wikipedia.org/wiki/Dice%27s_coefficient)。

或者使用现成的东西，比如[Lucene](http://lucene.apache.org/java/docs/index.html)。

# asp.net - 将 IIS 设置从一台机器复制到另一台机器

> ID：489462
> 
> 赞同：1
> 
> 时间：2009-01-28T21:28:05.840
> 
> 标签：asp.net, iis-6

寻找这个的答案，并没有看到它。

这适用于 IIS 6.0 / Windows Server 2003。

我正在使用一个非常大的 ASP/ASP.NET 应用程序，并且我正在尝试让我的开发环境与我的团队成员环境相匹配。这个过程基本上是反复试验：遇到错误，进入 IIS，进行更改，希望错误得到修复。啊。我希望找到一种方法将一台机器上**的一组 IIS 目录及其配置复制**到我的机器上。

我确实找到了一个脚本，它将遍历并给我一个机器上所有虚拟目录的列表。它有帮助，但不是很多，因为我仍然需要进入并设置所有这些虚拟目录（我认为其中有 20 个大概）。整个过程很复杂，因为我们将 ASP 和 ASP.NET 应用程序混合在同一个应用程序中，该应用程序跨越许多解决方案和项目。把整个事情搞好似乎工作太多了，但我从来没有听说过真正的解决方案。

Powershell 在这里有用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:33:54.533

您应该导出和导入 IIS 元数据库。

这些可能会有所帮助：

*   [IIS 设置复制](http://weblogs.asp.net/owscott/archive/2006/06/07/IISCnfg.vbs---IIS-Settings-Replication.aspx)
*   [IIS 元数据库备份和还原](http://web-developer.boeldt.net/IIS_Metabase_Backup.asp)

幸运的是，在 IIS7 中，ASP.NET 配置与 IIS 配置集成在一起，因此工作是通过复制`Web.config`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-15T19:05:56.377

这是 Microsoft 的 iiscnfg 文档。[iiscnfg 文档](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/81f04967-f02f-4845-9795-bad2fe1a1687.mspx?mfr=true)

当我第一次运行它时，我收到一条错误消息，提示“此脚本不适用于 WScript。” 如果这种情况发生在您身上：

```
1\. Click OK.
2\. At the "Would you like to register Cscript as your default host for VBscript?" click Yes.
3\. At "Successfully registered Cscript" click OK.
4\. Run the command again 
```

# .net - 在.Net中以零开头填充一个数字

> ID：489466
> 
> 赞同：37
> 
> 时间：2009-01-28T21:29:10.563
> 
> 标签：.net, string, formatting, padding

我需要用起始零填充所有个位数。有人可以建议最好的方法吗？（例如 1 -> 01、2 -> 02 等）

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-01-28T21:31:03.523

```
number.ToString().PadLeft(2, '0') 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-01-28T21:31:07.377

我会在数字上调用[.ToString](https://docs.microsoft.com/en-us/dotnet/api/system.int32.tostring?view=netframework-4.7.2#System_Int32_ToString_System_String_)，提供一个需要两位数字的[格式字符串](https://docs.microsoft.com/en-us/dotnet/standard/base-types/formatting-types#FormatStrings)，如下所示：

```
int number = 1;
string paddedNumber = number.ToString("00"); 
```

如果它是较大字符串的一部分，您可以在占位符中使用格式字符串：

```
string result = string.Format("{0:00} minutes remaining", number); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-29T01:21:09.410

假设您只是输出这些值，而不是存储它们

```
int number = 1;
Console.Writeline("{0:00}", number); 
```

这是.Net 支持的所有格式的[有用资源。](http://blog.stevex.net/index.php/string-formatting-in-csharp/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-20T21:05:06.337

我将添加此选项作为答案，因为我在这里看不到它，它可以用作替代方案。

在 VB.NET 中：

```
''2 zeroes left pad
Dim num As Integer = 1
Dim numStr2ch As String = Strings.Right("00" & num.ToString(), 2)

''4 zeroes left pad
Dim numStr4ch As String = Strings.Right("0000" & num.ToString(), 4)

''6 zeroes left pad
Dim numStr6ch As String = Strings.Right("000000" & num.ToString(), 6) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-10T05:15:41.810

```
# In PowerShell:

$year = 2013
$month = 5
$day = 8

[string] $datestamp = [string]::Format("{0:d4}{1:d2}{2:d2}", $year, $month, $day)
Write-Host "Hurray, hurray, it's $datestamp!" 
```

# html - 在 .ASP 页面中进行数据验证后将焦点设置为文本框

> ID：489474
> 
> 赞同：1
> 
> 时间：2009-01-28T21:31:07.893
> 
> 标签：html, focus, asp.net

我正在处理一个 asp 页面，该页面在用户输入后验证文本框中的信息。

手动输入“产品编号”（自由格式）。使用更新后事件，我让页面发布数据并查找产品编号以确定它是否有效。如果无效，则会在框中发布错误消息，否则将产品编号和描述放在框中（IE X1234 变为 X1234 – RED YO-YO）。这可以 100% 正常工作。我的问题是更新后所有数据输入项都失去了焦点。我希望将焦点返回到下一个文本框，以便操作员可以输入下一条所需信息。

注意：到目前为止，我插入了一个动态更改“TABSTOP”编号的函数，以便在验证查找后为“下一个”框分配#1。这适用于我的浏览器（Firefox 3.05），但不适用于我的 IE（谢谢比尔！）。在 IE 中，当发布完成时，由于某种原因，焦点最终会落在“输入 URL”上，并且点击选项卡会将焦点放在某个控制按钮上，而该按钮离我想要的位置不远。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T04:49:45.900

如果您正在尝试做我认为的事情，那么应该这样做。

在您的 ASPX 页面中：

```
<script type="text/javascript">
    function focusControl(ctrlId) {
        document.getElementById(ctrlId).focus();
    }
</script> 
```

在您的代码隐藏中：

```
// 'ctrl' is the name of the ASP.NET TextBox that you want to receive
// focus on load.
Page.ClientScript.RegisterStartupScript(
    typeof(Page),
    "Focuser",
    "focusControl('" + ctrl.ClientID + "');",
    true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T05:07:23.617

这是一般的解决方案：

[http://couldbedone.blogspot.com/2007/08/restoring-lost-focus-in-update-panel.html](http://couldbedone.blogspot.com/2007/08/restoring-lost-focus-in-update-panel.html)

# vb6 - VB6 - 如何从命令行（或 msbuild）自动中断兼容性

> ID：489475
> 
> 赞同：3
> 
> 时间：2009-01-28T21:31:08.750
> 
> 标签：vb6, msbuild, compatibility, tfsbuild

我们正在实施 Team Build，并且知道我们需要编写 MSBuild 脚本来构建我们的旧版 VB 6 应用程序。它被配置为使用二进制兼容性，我们偶尔会破坏兼容性，我们希望我们新的自动化构建过程能够自动破坏兼容性。

任何人都知道如何做到这一点，或者甚至可能吗？

或者，我知道中断只是将兼容性更改为不兼容，编译，更改为二进制并重新编译。如果有人知道如何从命令行更改兼容性，这也会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T21:47:36.470

关于从兼容性更改为不兼容，我通过使用 Unix 风格的工具（sed、awk 和/或 perl）编辑项目文件来完成类似的操作。不要更改原始项目文件，而是生成一个新的/临时项目文件，并使用它进行构建。这是一个例子：

```
sed -e "s/CompatibleMode=0/CompatibleMode=2" <myProj.vbp >tmpProj.vbp 
```

您可以将此技术用于其他目的，例如将版本号插入项目文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T21:59:23.233

/d 开关允许您在编译时替换项目属性值。尝试

```
VB6 /MAKE c:\Some.vbp /outdir c:\somedir\ /d CompatibleMode="0" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T09:00:49.353

这有效：

`VB6 /MAKE c:\Some.vbp /outdir c:\somedir\ /d CompatibleMode="0" CompatibleEXE32=""`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-13T16:04:52.660

我不确定上述任何解决方案是否有效。我们的产品也有同样的问题。我们必须编写一个 vb 项目（也用作插件）来破坏兼容性并构建项目。vb 项目，读取现有的 VB 文件，生成一个新的 vbp 文件，其中包含项目兼容性设置和生成的 dll 的新目标。目标将是 ref-dll 所在的同一文件夹。一旦构建了 dll，旧的 dll 将被删除，新的 red-dll 被重命名以匹配旧的。最后，所有临时文件都将被删除。vb 项目有一个公开的函数，它接受一个参数，即 vbp 文件。这可以从 vb 脚本运行。所以基本上命令行参数是

```
BuildRefDll.vbs <my.vbp>
vb6.exe /make <my.vbp> 
```

# javascript - 浏览器 | 如何防止滚动页面上缺少输入焦点？

> ID：489478
> 
> 赞同：0
> 
> 时间：2009-01-28T21:32:21.867
> 
> 标签：javascript, html

我有很多输入的 HTML 表单。当我专注于输入时，我很感兴趣，之后我滚动页面并且焦点混乱了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T16:29:31.193

问题：当使用 IE 滚动条时，焦点元素失去焦点。

你需要：

*   识别失去焦点的元素
*   识别文档何时滚动
*   重新应用焦点

`blur`您可以通过事件识别失去焦点的元素。将合适的事件处理程序添加到您希望记住焦点的每个元素。

当`blur`事件处理程序运行时，对于给定的输入元素，您应该存储（也许在全局变量中）输入元素的标识符。如何执行此操作取决于您选择识别元素的方式。的`id`元素将是理想的。

`scroll`您可以通过对象的事件处理程序判断何时滚动文档`window`。请参阅[https://developer.mozilla.org/en/DOM/window.onscroll](https://developer.mozilla.org/en/DOM/window.onscroll)。

您可以通过比较 scrollHeight 的前后值来判断文档何时完成滚动。请参阅[https://developer.mozilla.org/en/DOM/element.scrollHeight](https://developer.mozilla.org/en/DOM/element.scrollHeight)。

总体：

*   将`blur`事件处理程序添加到您的输入元素
*   在模糊时，注意失去焦点的元素和当前的滚动高度
*   在滚动期间，比较 scrollHeights 以确定滚动是否停止
*   当滚动停止时，重新应用焦点

您可能希望在滚动停止和重新应用焦点之间等待一小段时间。用户可能正在滚动一点，停止，滚动，停止。您不希望您的脚本引起疯狂的焦点跳跃行为。

# php - 自引用 URL

> ID：489482
> 
> 赞同：4
> 
> 时间：2009-01-28T21:33:24.423
> 
> 标签：php, apache, http, cgi

构建自引用 URL 的最可靠、最通用的方法是什么？换句话说，我想生成用户浏览器正在点击的 URL 的[http://www.site.com[:port]](http://www.site.com[:port])部分。我正在使用在 Apache 下运行的 PHP。

一些并发症：

*   依赖 $_SERVER["HTTP_HOST"] 是危险的，因为这似乎直接来自 HTTP Host 标头，有人可以伪造。

*   可能有也可能没有虚拟主机。

*   可能有一个使用 Apache 的 Port 指令指定的端口，但如果它位于负载平衡器或代理之后，则该端口可能不是用户指定的端口。

*   该端口实际上可能不是 URL 的一部分。例如，通常省略 80 和 443。

*   PHP 的 $_SERVER["HTTPS"] 并不总是提供可靠的值，尤其是当您使用负载平衡器或代理时。

*   Apache 有一个 UseCanonicalName 指令，它会影响 SERVER_NAME 和 SERVER_PORT 环境变量的值。如果有帮助，我们可以假设它已打开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T21:45:58.643

我记得，你想做这样的事情：

```
$protocol = 'http';

if ( (!empty($_SERVER['HTTPS'])) || ($_SERVER['HTTPS'] == 'off') ) {
    $protocol = 'https';
    if ($_SERVER['SERVER_PORT'] != 443)
        $port = $_SERVER['SERVER_PORT'];
} else if ($_SERVER['SERVER_PORT'] != 80) {
    $port = $_SERVER['SERVER_PORT'];
}
// Server name is going to be whatever the virtual host name is set to in your configuration
$address = $protocol . '://' . $_SERVER['SERVER_NAME'];
if (!empty($port))
    $address .= ':' . $port
$address .= $_SERVER['REQUEST_URI'];
// Optional, if you want the query string intact
if (!empty($_SERVER['QUERY_STRING']))
    $address .= '?' . $_SERVER['QUERY_STRING']; 
```

我还没有测试过这段代码，因为我现在手头没有 PHP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T21:48:32.227

我建议确定和确保安全的唯一方法是在网站的某种配置文件中为 url 定义一个常量。您可以使用 $_SERVER['HTTP_HOST'] 作为默认值生成常量，并在安全性真正重要的部署中替换为硬编码定义。

```
define('SITE_URL', $_SERVER['HTTP_HOST']); 
```

并根据需要更换：

```
define('SITE_URL', 'http://foo.bar.com:8080/'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T22:08:30.377

最可靠的方法是自己提供。

该站点应编码为与主机名无关，但要了解特殊的配置文件。该文件不会被放入代码库的源代码控制中，因为它属于网络服务器的配置。该文件用于设置主机名和其他特定于网络服务器的参数。您可以容纳负载平衡器、更改端口等，因为您是说如果 HTTP 请求命中该代码，那么它可以假设您愿意假设多少。

顺便说一句，这个技巧也有助于开发。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T21:38:58.750

$_SERVER["HTTP_HOST"] 可能是最好的方法，当然经过一些验证。

是的，用户指定了它，因此它不可信，但您可以轻松检测到用户何时使用它玩游戏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T22:02:55.177

验证 $_SERVER['HTTP_HOST'] 有效的一种方法是通过 DNS 验证它。我已经在一两种情况下使用了这种方法，而没有对速度造成严重后果，我相信如果提供 IP 地址，这种方法会静默失败。

[http://www.php.net/manual/en/function.gethostbyname.php](http://www.php.net/manual/en/function.gethostbyname.php)

Peusudo 代码可能是：

```
define('SITEHOME', in_array(gethostbyname($_SERVER['HTTP_HOST']), array(... valid IP's))) 
? $_SERVER['HTTP_HOST']
: 'default_hostname'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T00:45:36.737

为什么{如果您希望用户继续使用他们所在的[http:///host:port/](http:///host:port/)您是否希望生成完整的 url} 可以使用相对 url 而不是

[在http://xxx:yy/zzz/fff/](http://xxx:yy/zzz/fff/)页面上说

你可以使用

../graphics/whatever.jpg {to go back one directory from current and get [http://xxx:yy/zzz/graphics/whatever.jpg](http://xxx:yy/zzz/graphics/whatever.jpg)

or /zzz/graphics/whatever.jpg {to goto site root and work up the directories as specified}

these both avoid mentioning the host:port part and inherit it from the one currently in use

# c# - String、Int32 等的操作在哪里定义？

> ID：489485
> 
> 赞同：6
> 
> 时间：2009-01-28T21:34:06.390
> 
> 标签：c#, .net, string

我正在通过反射器查看 String 和 Int32 类型，但找不到任何已定义的运算符。

如果没有定义，+/- 等如何作用于这些类型？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-28T21:48:54.423

数字运算符是 IL 本身的一部分。字符串上的“+”运算符有点特殊——它不是由字符串类型本身重载的，而是由编译器完成的。C# 编译器翻译：

```
string x = a + "hello" + b; 
```

进入：

```
string x = string.Concat(a, "hello", b); 
```

这比使用普通运算符完成连接更有效，因为否则必须在每个连接处创建一个新字符串。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T21:47:50.620

String 类只有两个，它们具有符合 CLS 的名称：op_Equality 和 op_Inequality。编译器有很多关于 System.String 类的内置知识。为了能够使用 Ldstr 操作码，这是必要的。同样，它将 + 运算符转换为 String.Concat()。

几乎是 Int32 的故事，运算符和 IL 操作码之间存在直接匹配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T22:44:58.087

原语的运算符很痛苦，正如我在尝试[为运算符编写通用支持](http://www.pobox.com/~skeet/csharp/miscutil/usage/genericoperators.html)（即使用 T + T 等）时发现的那样；这里还有一个讨论页面[，涵盖了这一点](http://www.pobox.com/~skeet/csharp/genericoperators.html)。

您可以通过使用诸如`Expression`(.NET 3.5) 之类的抽象来解决此问题 - 否则，您将不得不查看原始 IL，或使用一些已知方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T21:50:13.127

是的，这些操作被转换为原生 IL 指令，而不是显式调用“operator+”方法。它可能不是执行这些操作的托管代码......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T21:53:21.700

c# 编译器是一个疯狂的儿子......我曾经尝试重新创建 Nullable 类型的能力，但直到在他的博客上的一些评论中，Eric Lippert 向我保证它的能力也来自编译器在何时生成它遇到可为空的类型。

# apache - 为什么有些设置前端 Glassfish 与 Apache？

> ID：489491
> 
> 赞同：0
> 
> 时间：2009-01-28T21:35:46.433
> 
> 标签：apache, glassfish

我一直在努力研究 Glassfish，而不断出现的一件事是使用 Apache 面对 Glassfish 的“操作方法”。不幸的是，我还没有找到你为什么要这样做的描述！

根据我的实验，Glassfish 似乎是一个功能齐全的 Web 服务器类型的服务；但我可能会错过很多。那么，前端 Glassfish 的概念是更多地将其与现有架构集成的解决方案，还是前端（在纯 Java 环境中）提供额外的好处？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-05T15:55:06.740

还有另一个有效的用例说明我们为什么将 Glassfish 与 Apache 放在一起。在这种情况下，Apache 将充当反向代理，以提高 Glassfish 的安全性。RP 配置为仅允许将某些 URL 传递到应用程序服务器。例如，您可能在 Glassfish 中部署了应用程序上下文 /myApp 和 /myPrivApp。在 RP 服务器中，您只需将 /myApp 配置为传递给 Glassfish。任何请求 /myPrivApp 的人都会看到 404 '因为请求在 RP 级别停止。

在我的一个部署中，我部署了一堆 WAR，一些用于来自 Internet 的用户，一些仅用于 Intranet。我有 2 个 RP 正在运行，一个用于 Internet 用户，另一个用于 Intranet。我将 Internet RP 配置为仅允许已批准的 Internet 应用程序的 URL 通过，而 Intranet 用户可以查看所有内容。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T22:01:50.030

它通常用于加快速度。由于 apache 是一个非常快速的 Web 服务器，它用于传递静态内容。比如图片、CSS文件等等。Glassfish 在此场景中提供动态内容（servlet、JSP）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-09T18:33:45.370

使用 Apache 作为 Glassfish 前端的另一个原因是可以在 Glassfish 集群中提供负载平衡。有关详细信息，请参阅[http://tiainen.sertik.net/2011/03/load-balancing-with-glassfish-31-and.html](http://tiainen.sertik.net/2011/03/load-balancing-with-glassfish-31-and.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-22T19:09:25.217

另一个原因是 glassfish 不能（轻松地）在端口 80 上运行，当然没有授予它 root 权限。因此，对于大多数用户来说，在 apache 前面运行某种代理（apache、nginx、varnish）并让两台服务器都在普通用户下运行会更容易。

然后，您可以从前端的一些配置选项中获得另一个优势。像其他人提到的那样，例如缓存。

# asp.net - 在 Javascript 中从对象数组中创建 HTML 表

> ID：489492
> 
> 赞同：1
> 
> 时间：2009-01-28T21:35:55.730
> 
> 标签：asp.net, javascript, web-services, asp.net-ajax, asmx

我正在从 javascript 调用 web 方法。Web 方法从 Northwind 数据库返回一组客户。我正在使用的示例在这里：[使用 ASP.NET AJAX 调用 Web 服务](http://www.asp.net/learn/ajax/tutorial-05-cs.aspx)

我不知道如何编写这个 javascript 方法：**CreateCustomersTable**

这将创建 html 表来显示返回的数据。任何帮助，将不胜感激。

我的 javascript

```
function GetCustomerByCountry() {
  var country = $get("txtCountry").value;
  AjaxWebService.GetCustomersByCountry(country, OnWSRequestComplete, OnWSRequestFailed);
}
function OnWSRequestComplete(results) {
    if (results != null) {
        CreateCustomersTable(results);
        //GetMap(results);
    }
}
function CreateCustomersTable(result) {
    alert(result);
if (document.all) //Filter for IE DOM since other browsers are limited
{
   // How do I do this?
    }
}
else { 
$get("divOutput").innerHTML = "RSS only available in IE5+"; }
} 
```

我的网络方法

```
 [WebMethod]
    public Customer[] GetCustomersByCountry(string country) 
    {
        NorthwindDALTableAdapters.CustomersTableAdapter adap =
           new NorthwindDALTableAdapters.CustomersTableAdapter();
        NorthwindDAL.CustomersDataTable dt = adap.GetCustomersByCountry(country);

        if (dt.Rows.Count <= 0)
        {
            return null;
        }

        Customer[] customers = new Customer[dt.Rows.Count];
        for (int i = 0; i < dt.Rows.Count; i++)
        {
            NorthwindDAL.CustomersRow row = (NorthwindDAL.CustomersRow)dt.Rows[i];
            customers[i] = new Customer();
            customers[i].CustomerId = row.CustomerID;
            customers[i].Name = row.ContactName;
        }
        return customers;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T22:16:51.200

尝试查看调试模式下的结果变量值是什么。如果结构看起来是我想象的结构，那么这样的事情可能会起作用：

```
function CreateCustomersTable(result) {
    var str = '<table>'; 
    str += '<tr><th>Id</th><th>Name</th></tr>';
    for ( var i=0; i< result.length; i++){
        str += '<tr><td>' + result[i].CustomerId + '</td><td>' + result[i].Name + '</td></tr>';
    }
    str += '</table>';
    return str;    
} 
```

然后你可以这样做：

```
var existingDiv = document.getElementById('Id of an existing Div');
existingDiv.innerHTML = CreateCustomersTable(result); 
```

我希望这对你有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T22:05:59.490

像这样，假设您在“结果”值中返回了 JSON。“容器”是一个 id 为“容器”的 div。我正在克隆节点以节省内存，而且如果您想将一些基类分配给“基”元素。

```
var table = document.createElement('table');
var baseRow = document.createElement('tr');
var baseCell = document.createElement('td');
var container = document.getElementById('container');

for(var i = 0; i < results.length; i++){
  //Create a new row
  var myRow = baseRow.cloneNode(false);

  //Create a new cell, you could loop this for multiple cells
  var myCell = baseCell.cloneNode(false);
  myCell.innerHTML = result.value;

  //Append new cell
  myRow.appendChild(myCell);

  //Append new row
  table.appendChild(myRow);
}

container.appendChild(table); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T21:58:51.410

您应该将数组作为 JSON 或 XML 传递，而不仅仅是它的 toString() 值（除非 offcourse 返回 JSON 或 XML）。请注意，JSOn 更适合 javascript，因为它是一种 javascript 原生格式。
此外，告诉您除 IE 之外的浏览器无法进行 DOM 操作的人应该对他/她做了可怕的事情。

如果您的格式是 JSON，您可以只循环它们并创建元素并打印它们。（一旦您弄清楚您的服务返回什么格式，我们就可以为您提供更好的帮助。）

# c - 在 Objective-C 程序中使用 sqlite 时的指针问题

> ID：489496
> 
> 赞同：0
> 
> 时间：2009-01-28T21:37:17.333
> 
> 标签：c, objective-c, sqlite, pointers, warnings

当我尝试将其编译为objective-c程序的一部分时，它会发出警告：
`warning: passing argument 1 of 'sqlite3_close' from incompatible pointer type`

```
sqlite3 *db;
sqlite3_open("~/Documents/testdb.sqlite", &db);
/*stuff*/
sqlite3_close(&db); 
```

几乎任何其他使用`&db`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T21:40:41.540

`sqlite3_close`需要一个`sqlite3*`，而不是一个`sqlite3**`。所以删除＆符号，它应该编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T21:40:08.467

您应该只传递指针，而不是对其的引用：

```
sqlite3_close(db); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T21:40:30.917

我认为你不需要第二个`&`......如果这与普通 c 类似，你只想调用`sqlite3_close(db);` （从而将指针本身传递给它，而不是指针的地址。）`sqlite3_open`我相信调用会是保持原样。

# python - 为什么我在 Python “ImportError: No module named py”中收到以下错误？

> ID：489497
> 
> 赞同：23
> 
> 时间：2009-01-28T21:37:27.410
> 
> 标签：python

我是 Python 新手，所以请耐心等待 :)

我创建了一个名为 test.py 的文件，其内容如下：

```
test.py
import sys
print sys.platform
print 2 ** 100 
```

然后我在解释器中运行`import test.py`file 以遵循我书中的示例。当我这样做时，我得到了最后带有导入错误的输出。

```
win32
1267650600228229401496703205376
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named py 
```

为什么我会收到此错误，我该如何解决？谢谢！

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-28T21:39:36.610

代替：

```
import test.py 
```

简单地写：

```
import test 
```

这假设 test.py 与导入它的文件位于同一目录中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-28T21:48:36.717

这个看起来很奇怪的错误是 Python 导入模块的结果。

**Python 看到**：

```
import test.py 
```

**Python 认为**（简化了一点）：

> 导入模块测试。
> 
> *   在模块搜索路径中搜索 test.py
> *   执行 test.py （你得到你的输出）
> *   将“test”作为名称导入当前命名空间
> 
> 导入测试.py
> 
> *   搜索文件 test/py.py
> *   找到抛出 ImportError（没有名为“py”的模块）。

因为 python 允许使用带点的模块名称，它只是认为您在模块中命名了一个子`py`模块`test`，并试图找到它。它不知道您正在尝试导入文件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-28T21:39:12.790

导入时不指定扩展名。做就是了：

```
import test 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T21:47:51.867

正如其他人所提到的，您不需要将文件扩展名放在导入语句中。推荐阅读[Python 教程的模块部分](http://docs.python.org/tutorial/modules.html)。

对于错误的更多背景信息，解释器认为您正在尝试导入`py`从包内部命名的模块`test`，因为点表示封装。因为不存在这样的模块（并且[test 甚至不是一个包](http://docs.python.org/tutorial/modules.html#packages)！），所以它会引发该错误。

正如[关于 import 语句的更深入的文档中](http://docs.python.org/reference/simple_stmts.html#the-import-statement)`test`所指出的，它在尝试导入模块之前仍会执行模块中的所有语句`py`，这就是您打印出这些值的原因。

# shellexecute - 在过程中执行 ShellExecute

> ID：489499
> 
> 赞同：0
> 
> 时间：2009-01-28T21:38:52.853
> 
> 标签：shellexecute, procedure

我想调用它.. 和 ShellExecute(Handle, 'open', 'c:\Windows\notepad.exe', nil, nil, SW_SHOWNORMAL) 一样好，我可以在 form1 的方法中毫无问题地调用它

但我只有一个过程“过程转换数据集（）；” 我想调用它并且它不识别句柄......我只需要将这个过程作为form1的方法吗？我怎么做？这就是解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:42:10.960

是的，ShellExecute 需要窗口句柄。最直接的解决方案是将其传递给您的方法。我觉得这有点难看，所以就个人而言，我会考虑在方法返回时调用 ShellExecute。如果调用是可选的（取决于数据），请考虑从方法返回一个状态标志，指示是否需要调用 ShellExecute。不过，无论哪种方式都有效。

# ruby-on-rails - 来自模型或控制器的 Rails 断言？

> ID：489504
> 
> 赞同：6
> 
> 时间：2009-01-28T21:39:51.977
> 
> 标签：ruby-on-rails

如果在开发和测试期间不变量被破坏，是否有一种内置的方式来指定 Rails 中的断言，这将引发异常？

编辑：为了清楚起见，我正在寻找可以放置在模型或控制器中的断言，而不是用于单元测试的断言。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-28T22:20:57.823

如果您正在编写测试，则有许多断言函数。但是对于主代码中的 assertiona，没有任何内容，您可以轻松滚动自己的代码。

将这样的内容添加到`environment.rb`：

```
class AssertFailure < Exception
end

def assert(message = 'assertion failed')
  unless block_given? and yield
    raise message
  end
end 
```

并使其成为您的无操作，`environments/production.rb`因此开销最小

```
def assert(message = 'assertion failed')
end 
```

然后，在您的代码中，您可以随心所欲地断言：

```
assert { value == expected_value }
assert('value was not what was expected') { value == expected_value } 
```

如果`value`不等于`expected_value`并且您没有在生产中运行，则会引发异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T21:49:02.647

除了[这些](http://topfunky.com/clients/rails/ruby_and_rails_assertions.pdf)，你的意思是？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T13:41:01.750

引发异常，并使用[rescue_from](http://api.rubyonrails.org/classes/ActiveSupport/Rescuable/ClassMethods.html#M000714)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T13:50:22.767

正如@Gordon 所说，没有。我最终使用了Jorge Manrubia 的[solid_assert](https://github.com/jorgemanrubia/solid_assert) gem，正如这个问题中提到的：[向 Ruby 的 Kernel 类添加一个 assert() 方法是否符合 Ruby 的习惯？](https://stackoverflow.com/questions/147969/is-it-idiomatic-ruby-to-add-an-assert-method-to-rubys-kernel-class)

# xml - ActionScript 3 是否需要 XML 的错误事件处理程序？

> ID：489510
> 
> 赞同：2
> 
> 时间：2009-01-28T21:41:21.693
> 
> 标签：xml, flash, actionscript-3, actionscript, error-handling

在我正在开发的 Flash 游戏中，有一些设置是由外部 XML 文件设置的。当我通过 Flash IDE 运行 SWF 文件时，它可以正常加载。如果我运行与投影仪 (.exe) 或独立 SWF 文件相同的文件，它不会加载 XML 文件。

我的（意外）修复是为加载器对象分配一个*错误*事件侦听器。当我再次发布文件时，XML 正确加载到投影仪和独立 SWF 文件中。（我已经验证了注释掉错误事件处理程序可以恢复错误）。

这是涉及的代码块（~~删除了无关的代码和函数调用~~):

```
public function getSettings():void {
outputBox = getChildByName("output_box") as TextField;
var xmlLoader:URLLoader = new URLLoader();
var xmlData:XML = new XML();                
xmlLoader.addEventListener(Event.COMPLETE, loadXML, false, 0, true); 
xmlLoader.addEventListener(ErrorEvent.ERROR, function (e:Error) 
    { outputBox.appendText(e.message) });

try {               
    xmlLoader.load(xmlPath);
} 
catch(err:Error) {
    trace(err.message);
    outputBox.appendText(err.message);
    checkChances("0");
}

function loadXML(e:Event):void {

    try {
        xmlData = new XML(e.target.data);
        var chances:String = xmlData.chances.text();
        var dbURL:String = xmlData.database.text();

        trace("Chances are set to: " + chances);                    
        trace("Database URL is set to: " + dbURL);
        outputBox.appendText("Chances are set to: " + chances);
    }
    catch(err:Error) {              
        outputBox.appendText(err.message);
    }
        checkChances(chances);
        dbPath = new URLRequest(dbURL);
} 
```

}

让我知道您是否遇到过这种情况，或者您是否可以对可能发生的事情有所了解。谢谢！

编辑：

这是不起作用的*代码*。（我还编辑了可以显示我取出的所有其他位的代码，以防它们可能会影响它）：

```
public function getSettings():void {
outputBox = getChildByName("output_box") as TextField;
var xmlLoader:URLLoader = new URLLoader();
var xmlData:XML = new XML();                
xmlLoader.addEventListener(Event.COMPLETE, loadXML, false, 0, true); 
/*xmlLoader.addEventListener(ErrorEvent.ERROR, function (e:Error) 
    { outputBox.appendText(e.message) });*/

try {               
    xmlLoader.load(xmlPath);
} 
catch(err:Error) {
    trace(err.message);
    outputBox.appendText(err.message);
    checkChances("0");
}

function loadXML(e:Event):void {

    try {
        xmlData = new XML(e.target.data);
        var chances:String = xmlData.chances.text();
        var dbURL:String = xmlData.database.text();

        trace("Chances are set to: " + chances);                    
        trace("Database URL is set to: " + dbURL);
        outputBox.appendText("Chances are set to: " + chances);
    }
    catch(err:Error) {              
        outputBox.appendText(err.message);
    }
        checkChances(chances);
        dbPath = new URLRequest(dbURL);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T15:27:46.043

在第一个 addEventListener 上，您告诉它使用弱引用（调用的最后一个参数）。您的 loadXML 函数在您的 getSettings() 方法中定义。一旦您离开 getSettings() 范围，loadXML 就会超出范围。唯一剩下引用 loadXML 的是事件侦听器，但是因为您告诉它使用不会阻止它被垃圾收集的弱引用。因此，在引发事件时，loadXML 方法可能已被垃圾回收。

我的猜测是，当您定义另一个侦听器时，那里定义的匿名方法会保持 getSettings() 范围（因为它是该方法范围的一部分），这将使 loadXML() 保持在范围内。

您真正应该做的是将您的 loadXML 方法重构为对象上的实际成员函数，而不是在 getSettings() 中定义的匿名方法。这将使事情变得更清洁，并且会阻止您看到的垃圾收集，因为只要对象存在，该方法就会保持在范围内。

如果由于某种原因您不想使 loadXML 成为成员函数，那么删除弱引用标志应该足以修复它。但是，由于这些匿名方法的工作方式，您最终可能会出现一些内存泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T23:52:09.667

您的问题的答案是否定的，actionscript 3.0 不需要 XML 的错误事件处理程序。它甚至不需要完整的处理程序！这就是 .addEventListener() 的重点，事件监听器是可选的。

听起来你的代码比你在这里展示的更多。
（您提交错误事件侦听器，然后一切正常，这根本没有意义！）

您是否始终从同一位置执行文件？这就是我对为什么无法加载 XML 的猜测，也许您将 .swf 文件移动到另一个文件夹？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T14:05:00.313

这只是一个疯狂的猜测，但在程序的早期版本中，是否有可能在之前**发出**`load()`命令，并且在添加第二个错误侦听器时重新排序它们（以*正确的顺序）？*如果是这样，那肯定是时间问题。*如果您还包含不起作用*的代码，那将会很有帮助。 **`addEventListener()`**

 ******更新**

我认为[爱马仕](https://stackoverflow.com/questions/489510/does-actionscript-3-require-an-error-event-handler-for-xml/492052#492052)是对的。当您将单个本地范围的侦听器添加为**弱引用**时，不仅侦听器本身，而且*对象在下载完成之前`URLLoader`都会被垃圾收集*（因为没有侦听器，保留它没有意义）。（为什么这发生在独立模式而不是在 Flash IDE 中可能是偶然的，这取决于 GC 的工作原理。）当您添加第二个**强引用**错误事件侦听器*tada*时，不再进行 GC。

因此，要么尝试 Herms 的建议：使用范围更广的函数作为完成侦听器，*要么*`addEventListener()`直接从调用中删除弱引用参数。

# sql - 相当于“删除用户时，删除他的所有帖子”的数据库概念是什么？

> ID：489513
> 
> 赞同：1
> 
> 时间：2009-01-28T21:42:03.533
> 
> 标签：sql, database

相当于“删除用户时，删除他的所有帖子”的数据库概念是什么？这是一件好事吗？

另一个例子：如果您的网站是一个编程论坛，您需要在删除该主题之前找到并删除与该主题相关的评论。

这应该在数据库层自动处理吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-28T21:44:25.853

级联删除

我会犹豫推荐真正的删除——而不是使用将记录标记为已删除的软删除——在这种情况下，您可能会使用级联更新（或不使用，因为原始主题已被标记为已删除）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-28T21:43:32.780

级联更新，通常与外键引用结合使用。不同的 DBMS 提供不同级别的支持。

在论坛或类似网站的特定情况下，我建议使用“软”删除 - 将数据库中的行标记为已删除，这将防止它们在列表或搜索结果中被查看或返回，但不要t 完全删除它们。这有助于取消删除等，以对抗伪劣或有偏见的适度。

此外，我建议在您删除用户帐户时自动删除用户的帖子可能不是所有情况下的最佳行为 - 当然，在处理巨魔/垃圾邮件帐户时，您可能想要删除垃圾帖子，但您不'不一定想在其他情况下删除所有信息，特别是因为它引入了引用损坏的问题（例如外部引用、来自其他帖子的交叉链接等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T21:59:17.493

您的问题的答案是级联删除。作为记录，我**讨厌**将用户删除作为论坛功能。如果人们想离开，那太好了……我想看看他们在那里所做的事情的历史。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-28T21:54:09.780

不确定这是否是您想要找出的，但在 MySQL 中，您所询问的事物类型（我认为）称为触发器。它基本上是一个与表和对该表的操作相关联的 SQL 语句；例如，您可以设置一个语句，该语句将在删除用户记录时执行，这将删除与该用户关联的所有评论/帖子/任何内容。

请参阅[http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html](http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html)和其中的链接（当然，这是针对 MySQL 的……其他数据库可能会有所不同）

# python - 有没有办法让用户定义的 Python 函数像内置语句一样工作？

> ID：489524
> 
> 赞同：1
> 
> 时间：2009-01-28T21:43:58.943
> 
> 标签：python

是否可以使用户定义的 Python 函数像语句一样起作用？换句话说，我想说：

```
myfunc 
```

而不是：

```
myfunc() 
```

无论如何都要调用它 - 比如说，`print`会的方式。

我已经可以听到你们所有人都在撰写关于这是多么可怕的事情的回应，我问它是愚蠢的，我为什么要这样做，我真的应该做其他事情，但请相信我的话我需要调试我遇到的问题，它不会被检查或用于空中交通管制系统等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T21:45:29.627

不，这是不可能的。

正如您从[语言参考](http://docs.python.org/3.0/reference/simple_stmts.html#simple-statements)中看到的那样，规范中的简单语句列表没有扩展空间。

而且，`print`as 语句在 Python 3.0 中不再存在，被`print()`内置函数取代。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T21:48:16.720

如果您正在寻找的是在`print`Python 语言中添加一个新语句（如 ），那么这并不容易。您可能必须修改词法分析器、解析器，然后重新编译 Python 的 C 源代码。为了一个有问题的方便需要做很多工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T22:05:38.430

我不会实现这个，但是如果我实现这个，我会给带有 myfunc 的代码一个特殊的扩展名，编写一个导入钩子来解析文件，添加括号以使其有效 Python，并将其提供给解释器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T21:49:13.440

如果您想传递参数，则不是。您可以做一些事情来构建一个滥用该`__str__`方法的对象，但强烈不建议这样做。您还可以使用其他运算符，例如重载C++ 中的`<<`运算符。`cout`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T21:56:11.757

在 Python 2.x 中 print 不是一个函数，它是一个语句，就像 if、while 和 def 是语句一样。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-20T22:18:54.857

不可能以有计划的方式进行，或者没有大量工作。

如果您大胆且喜欢冒险，请阅读这篇关于元循环评估的维基百科文章。Python 对它自己的编译器/评估器对象有很好的检查和反射，你可以沿着这些线拼凑一些东西。

> """元循环实现适用于扩展它们所编写的语言。它们对于编写与编程语言紧密集成的工具也很有用，例如复杂的调试器。一种在设计时考虑到元循环实现的语言通常更适合构建一般语言，甚至是与宿主语言完全不同的语言。"""

*   [http://en.wikipedia.org/wiki/Meta-circular_evaluator](http://en.wikipedia.org/wiki/Meta-circular_evaluator)

我相信 pypy 正在做类似的事情，你可能想研究一下。

*   [http://pypy.org](http://pypy.org)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T00:30:34.170

这可能不会涵盖您的问题，但我还是会提到它。如果`myfunc`是模块的一部分，并且您正在像这样使用它：

```
from mymodule import myfunc
myfunc # I want this to turn into a function call 
```

然后你可以这样做：

```
import mymodule
mymodule.myfunc # I want this to turn into a function call 
```

然后，您可以从模块中删除`myfunc`并`mymodule`重载模块，以便在每次`myfunc`请求成员时调用特定函数。

# javascript - Javascript onchange 事件阻止 HTML 表单中的 onsubmit 事件？

> ID：489527
> 
> 赞同：3
> 
> 时间：2009-01-28T21:44:58.973
> 
> 标签：javascript, html, validation, onchange

考虑一个 HTML 表单：

```
<form action="" method="POST" onsubmit="return checkValidArray()">
    <input type="text" name="data" onchange="return validate(this);">
</form> 
```

看起来（在 IE 6 和 Firefox 3 中）当您在输入字段中键入一些文本并单击提交时，会为输入字段触发 onchange 事件，但在单击提交按钮之前不会为表单触发 onsubmit 事件第二次（当然，此时 onchange 不会触发）。换句话说，onchange 似乎阻止了 onsubmit 触发。

希望在用户退出字段时检查表单中的每个字段，以便为他们提供即时验证反馈，并在存在无效数据时防止提交表单。

[编辑：请注意，两个验证函数都包含一个 alert()。]

如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T20:23:50.020

解决方案（某种）：

事实证明，只有在输入的 onchange 事件期间存在 alert() - 或 confirm() - 才会导致表单的 onsubmit 事件不触发。JS 线程似乎被 alert() 阻塞了。
解决方法是在输入的 onchange 调用中不包含任何 alert() 或 confirm()。

已知受影响的浏览器：
IE6 - Windows
IE8 - Win
FF3 - Win

已知不受影响的浏览器：
Google Chrome - Win
Safari - Mac
FF - Mac

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T22:01:56.287

我尝试使用以下代码使用 Firefox 3 (Mac)：

```
 <html>
        <head>
            <script>
                function validate(ele)
                {
                    alert("vali");
                    return false;
                }

                function checkValidArray()
                {
                    alert("checkValidArray");
                }

            </script>
        </head>
        <body>
            <form action="" method="POST" onsubmit="return checkValidArray()">
                <input type="text" name="data" onchange="return validate(this);">
                <input type="submit" value="Ok">
            </form>
        </body>
</html> 
```

它似乎工作。当我点击 Ok 按钮时，“Vali”和“Check Valid Array”都会弹出。最初我认为`return false`可能是表单未提交的原因，但它已提交（至少，`checkValidArray()`被调用）。

现在，你在你的`checkValidArray()`和`validate()`方法中做了什么？有什么特别的吗？你可以发布代码吗？

编辑：我在 Windows 上使用 IE8 和 FF3 进行了测试，这两个事件都没有被触发。我不知道为什么。也许 onblur 是一个解决方案，但为什么 onchange 不起作用？是有特定原因还是只是另一个不一致？（适用于 Mac 上的 FF 和 Safari）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T21:50:35.200

您可以在输入中使用 onblur 事件而不是 onchange。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T17:57:33.963

有趣的是，Mac 上的行为有所不同，因此它似乎依赖于平台而不是依赖于浏览器。一定有什么线索……

我尝试使用 Nivas 的代码进行 onblur，但结果与 onchange 相同（只有“Vali”警报）。

有什么不同的是你是否在 validate() 中做*任何事情。*注释掉 alert("vali"); 它有效！（来自 validate() 的实际返回值并不重要，尽管我不希望它如此。）

编辑：一位同事刚刚在 Windows 上的 Google Chrome 中尝试过这个，它在那里工作。这在直觉上是有道理的，因为 Chrome 是如何分离 JS 线程的。

关于阻塞线程的第一个 alert() 的某些内容会导致 onsubmit 事件丢失。可能的比赛条件？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-22T11:16:46.907

不要创造；提交按钮。相反，创建一个普通按钮并编写一个可以使用该按钮调用 onClick 的函数。

函数将对表单字段进行验证，如果一切正常，它将提交表单。否则不会。

```
function validate
{
  "Piece of code to Validate your form"
  document.formName.action.value = "URL which you want to call"
 document.propFile.submit(); // It will submit he page
} 
```

# java - Java 是否有一个好的 *strict* 日期解析器？

> ID：489538
> 
> 赞同：11
> 
> 时间：2009-01-28T21:47:37.720
> 
> 标签：java, datetime, parsing, strict

Java是否有一个好的、*严格*的日期解析器？我可以访问 Joda-Time，但我还没有看到这个选项。我发现了“Is there a good date parser for Java”问题，虽然这是相关的，但它有点相反。虽然这个问题要求一个宽松的、更模糊的逻辑并且容易出现人为错误的解析器，但我想要一个严格的解析器。例如，对于 JodaTime（据我所知）和 simpleDateFormat，如果您的格式为“MM/dd/yyyy”：

解析这个：40/40/4353

这成为有效日期。我想要一个知道 40 是无效月份和日期的解析器。Java中肯定存在一些实现吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-28T21:57:33.673

我不认为[Joda](http://joda-time.sourceforge.net/)认为这是一个有效的日期。例子：

```
strict = org.joda.time.format.DateTimeFormat.forPattern("MM/dd/yyyy")
try {
    strict.parseDateTime('40/40/4353')
    assert false
} catch (org.joda.time.IllegalFieldValueException e) {
    assert 'Cannot parse "40/40/4353": Value 40 for monthOfYear must be in the range [1,12]' == e.message
} 
```

据我所知，[DateFormat](http://java.sun.com/javase/6/docs/api/java/text/DateFormat.html)和[setLenient(false)](http://java.sun.com/javase/6/docs/api/java/text/DateFormat.html#setLenient(boolean))也没有。例子：

```
try {
    df = new java.text.SimpleDateFormat('MM/dd/yyyy')
    df.setLenient(false)
    df.parse('40/40/4353')
    assert false
} catch (java.text.ParseException e) {
    assert e.message =~ 'Unparseable'
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-03-01T14:51:49.047

使用 DateFormat 进行严格验证的一个好方法是重新格式化解析的日期并检查与原始字符串的相等性：

```
String myDateString = "87/88/9999";
Date myDate = dateFormat.parse(myDateString);
if (!myDateString.equals(df.format(myDate))){
  throw new ParseException();
} 
```

奇迹般有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-26T09:23:27.553

`apache.commons.validator.routines.DateValidator`如果您不想使用 ，可以使用来验证日期`SimpleDateFormat`。

例子 ：

```
 public static Date validateDate(String value, String pattern) {
       DateValidator validator = new DateValidator();
       Date date = null;
           if (pattern!=null) {    //Pattern is passed
               date = validator.validate(value, pattern);
           } else {
               date = validator.validate(value);
           }
       return date;
    } 
```

因此，如果**返回 null，**则表示日期无效，否则为有效日期。此方法是使用的替代方法，`SimpleDateFormat`因为您不必依赖抛出的异常来识别它是否是有效日期。

# .net - wsdl.exe /sharetypes

> ID：489542
> 
> 赞同：5
> 
> 时间：2009-01-28T21:48:14.440
> 
> 标签：.net, web-services, wsdl.exe

我正在使用似乎使用相同对象结构服务器端的多个第三方 Web 服务（来自同一供应商）。其中一项服务允许我按角色查询用户列表，另一项服务允许我按 ID 查询单个用户。为了使其以最佳方式发挥作用，从两种服务返回的用户需要能够互换使用。

输入 wsdl.exe。我知道 /sharetypes 做了我想做的事，但是，当我生成代理时，最终仍然有多个版本的对象（即 Person、Person1、...）。

我正在执行的命令如下：

`wsdl.exe /sharetypes /language:VB http://mbptest2.seniormbp.com:8080/SeniorSystemsWS/UserManagementService.asmx?wsdl http://mbptest2.seniormbp.com:8080/SeniorSystemsWS/DataExportService.asmx?wsdl http://mbptest2.seniormbp.com:8080/SeniorSystemsWS/UserProfileService.asmx?wsdl`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-21T20:51:50.617

DataExportService 的架构具有 tns 和定义为`http://www.senior-systems.com/`. UserProfileService 的架构具有 tns 和定义为`http://senior-systems.com/`.

它们是不同的，即使它们在用作 URL 时碰巧解析到同一个 Web 服务器。XML 命名空间以文本方式进行比较，而不是根据 URL 语法。例如，`http://senior-systems.com/`and`http://senior-systems.com`将是两个不同的命名空间（提示：一个缺少尾部斜杠）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T21:53:27.427

根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/7h3ystb6(VS.80).aspx)，所有服务中的命名空间、名称和线路签名必须相同。有些东西看起来不匹配，所以这些是开始寻找的好地方。

# c# - 正则表达式：如果字符串末尾的模式不匹配

> ID：489544
> 
> 赞同：2
> 
> 时间：2009-01-28T21:48:22.053
> 
> 标签：c#, .net, regex

我有以下正则表达式，我想在其中匹配任何显式点，后跟一个或多个：

```
<b> <i> <u> </b> </i> </u> 
```

如果它出现在字符串的末尾，我希望这个正则表达式不匹配这个模式。

```
string = Regex.Replace(string, "\.((<[\/biu]+>)+)", ".$1||") 
```

前任：

```
This <b>should match.</b> allright.

This <i><b>shouldn't match.</b></i> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-28T21:51:23.997

```
"\.((<[\/biu]+>)+)(?!$)" 
```

使用带有符号的负前瞻断言`$`来检查行尾。（记住，匹配行尾，所以*你*`$`不想匹配。）

 ** * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T22:17:35.100

您可以使用[原子分组](http://www.regular-expressions.info/atomic.html)：

```
\.(?>(?:<\/?[biu]>)+)(?!$) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T22:00:32.513

强制在最后一个关闭元素之后有更多项目，但要确保它们本身不是元素。

```
"\.((<[\/biu]+>)+)[^<>]+" 
```

# security - 使用 SetDllDirectory 可能存在安全漏洞？

> ID：489552
> 
> 赞同：1
> 
> 时间：2009-01-28T21:49:58.133
> 
> 标签：security, dll

我有一个 DLL，它在其 DllMain() 函数中调用[SetDllDirectory() 。](http://msdn.microsoft.com/en-us/library/ms686203(VS.85).aspx)SetDllDirectory() 的参数是 DLL 所在的目录，由[GetModuleFileName()](http://msdn.microsoft.com/en-us/library/ms683197(VS.85).aspx)函数返回。这样做的效果是，如果 DLL 被放置为`c:/foo/bar.dll`，那么加载`bar.dll`会添加`c:/foo`到调用进程的 DLL 搜索路径中。

我的问题是：这会打开任何形式的安全漏洞吗？在加载库的进程必须显式调用的函数中执行 SetDllDirectory() 调用会更安全吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:57:23.347

它不是。好吧实际上不是一个新的。由于应用程序路径是 Windows 查找 dll 的第一个位置，因此有人可能会在此文件夹中放置恶意 dll。因此，没有您的 SetDllDirectory() 调用存在安全漏洞。

# linux - 在 Linux 上使用什么数据库工具来读取 as/400 数据库？

> ID：489555
> 
> 赞同：2
> 
> 时间：2009-01-28T21:50:47.180
> 
> 标签：linux, odbc, ibm-midrange, redhat

在 Linux（Red Hat dist）中，我们需要读取一个 AS400 数据库。我们有 ODBC 驱动程序要连接，最好的查询工具是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T02:44:01.833

[Kexi](http://kexi-project.org/)称自己为“Microsoft Access for Linux”，它非常好，但[ODBC 驱动程序](http://kexi-project.org/wiki/wikiview/index.php@ODBCDriver.html)还没有完全到位。

一个类似的程序是[OpenOffice.org BASE](http://www.openoffice.org/product/base.html)。IMO，Kexi是一个整体更好的产品，但是Base有一个ODBC驱动。

用于具有 ODBC 驱动程序的数据库的轻量级图形工具包括[Datakiosk](http://extragear.kde.org/apps/datakiosk/)和[Tora](http://tora.sourceforge.net)（尽管名称如此，但它不仅仅与 Oracle 一起使用）。

什么是“最好的”？取决于你的口味和你的需求。这绝不是一个包罗万象的清单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T05:51:37.350

Eclipse 和 Quantum DB

# ruby - 在鞋子中，我如何将堆栈停靠在窗口底部？

> ID：489558
> 
> 赞同：2
> 
> 时间：2009-01-28T21:53:18.860
> 
> 标签：ruby, shoes

在鞋子中，我如何将堆栈停靠在窗口底部？

例如，我有以下代码段。

```
Shoe.app do 
  stack :height => 100 do 
    background red
  end
  stack :height => 100 do 
    background blue
  end
end 
```

我希望蓝色堆栈停靠在窗口的底部，并在我调整窗口大小时留在那里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T21:40:33.093

要使用邮件列表中的示例：

```
Shoes.app do
  @s0 = stack do
    background red
    100.times do
      para "yay"
    end
  end
  @s = stack do
    style(:attach => Window, :top => height - 100)
    background lightblue
    para app.width
    para app.height
  end

  @height = 0
  every(1) do
    unless app.height == @height
      @s.clear do
        background lightblue
        style(:top => height-100)
        para app.width
        para app.height
      end
    end
  end
end 
```

你好山姆！

由于我在 :scroll => true 和设置高度方面遇到的问题（通常鞋子的设计方式是个坏主意），我会以这种方式做类似的事情：

[http://gist.github.com/54431](http://gist.github.com/54431)

这样，您会发现通过附加到窗口，滚动整个应用程序应该会更好地工作。我尝试在 OSX 中运行它，整个粘性 fandango 对我来说完全失败了，所以我已经启动了 linux（我假设你也在使用它）。在 linux 中，鼠标滚轮也可以使用。

我将样式保留在它自己的方法调用中，而不是使用 stack(styles) 方法，因为由于某种原因，如果这样做，您无法将堆栈保存到实例变量中。

此外，您不需要保存 app 对象，因为 self（几乎）始终是 Shoes.app，如果不是，则有一个名为“app”的方法来获取它。

我希望这有帮助。

[http://article.gmane.org/gmane.comp.lib.shoes/2997](http://article.gmane.org/gmane.comp.lib.shoes/2997 "gmane上的线程")

# asp.net - 是否有人创建安装程序来部署内部 asp.net Web 应用程序？

> ID：489565
> 
> 赞同：7
> 
> 时间：2009-01-28T21:54:10.280
> 
> 标签：asp.net, deployment, installation, release-management

我总是通过 FTP（有时甚至是 xcopy）部署我的 Web 应用程序，然后自己手动运行数据库脚本。

我在 90 年代开始以这种方式部署，但最近，我看到了一些带有安装程序的 Web 应用程序。我开始质疑，如果我被锁定在一个过时的过程中。我是一名顾问，我的应用程序通常是内部的，所以我不担心分发和让其他人安装它们。

但我很好奇；是否有人创建安装程序来部署内部 asp.net Web 应用程序？

如果是这样，为什么？（自愿、强制或自动化过程的一部分）

你这样做有什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T21:56:57.480

绝对地。我们用它来做我们所有的应用程序。这样，我们创建安装程序并在 qa 和 uat 环境中运行它以进行测试，我们确切地知道生产中会发生什么。没有人猜测某人可能会按照什么顺序做某事，或者他们是否错过了一步。它使事情变得容易得多。

哦，我也忘记了自动化过程。我们有适当的系统（Ant Hill Pro），可以自动将其部署到适当的环境中。质量检查人员不必等待完成某件事，因为这一切都在凌晨 2 点完成。如果他们需要使用更新重新运行构建，开发人员会签入代码，我们按下一个按钮，它就会自动部署。无需等待构建工程师，因为他正在开会或生病或其他任何事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T21:58:33.173

你总是希望有一种自动化的方式来构建和部署——如果你忘记了某个步骤，它会大大减少一次性错误的机会。此外，它还允许您轻松地将部署卸载给其他人，而无需教他们 100 个自定义步骤。无论项目是否为内部项目，所有应用程序都应遵循最佳实践。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T21:59:35.603

就我个人而言，我有点像 OP；通常我只是使用 FTP 进行部署，但通常我的应用程序是内部的，或者在其他项目的情况下，100% 由我管理。

然而，我最近也一直在考虑这个问题，并开始考虑如何使用正确的部署来改进这个过程——必须记录一个详细的安装过程可能是一个真正的痛苦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T22:02:15.287

我使用[Powershell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)并发现自动执行许多任务非常容易。一开始您可能会发现有点不同，但最后您会发现这完全取决于 .NET 库的强大功能！！！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T22:10:36.360

我已经使用“ [Web 设置项目](http://weblogs.asp.net/scottgu/archive/2007/06/15/tip-trick-creating-packaged-asp-net-setup-programs-with-vs-2005.aspx)”创建了一个 MSI，该 MSI为内部应用程序安装了“ [Web 部署项目”的输出。](http://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)我们的服务器管理员无法完成 50 步手动安装的任务。对于我当前的应用程序，我的服务器管理员不喜欢 MSI 安装程序的“黑匣子”感觉，而是更喜欢获得一堆文件和 50 步部署手册。（在这里看到一个模式？问你的服务器管理员他想要什么。）

Web 安装项目并没有立即明确如何安装到“默认网站”以外的任何地方，除此之外，它使安装过程可重复并创建了内置的回滚方式（只需从 1 运行安装程序以前的版本）。

这当然假设您的虚拟目录不包含任何用户修改的内容——我不相信 MSI 可以正确合并用户创建的文件和新文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T22:11:27.063

我们在这里使用“XCopy”部署模型，因为 Ops 人员有自己的方法在服务器上的新 Web 应用程序上设置安全性。

但是，当我们必须安装使用较新版本 Crystal Reports 的 Web 应用程序时，我们确实需要使用安装程序，因为它必须使用密钥执行一些特殊操作，而且我们没有完整的 CR 版本。服务器本身。因此，在使用第三方应用程序时请记住这一点，他们可能需要执行某种 MSI 可以轻松处理的合并模块。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T22:41:15.003

是的……我们有一个需要设置很多先决条件的应用程序……Web 服务、Windows 服务、用户帐户、安全性、文件夹创建、GAC 位等……我把它全部汇总成一个具有自定义操作的漂亮 MSI，可以干净地安装和卸载。节省了大约一小时的工作来部署新盒子。

许多其他较小的应用程序只是通过将网站发布到本地文件夹然后通过 ftp 将内容传输到目标来部署的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-06T12:54:00.493

这在很大程度上取决于您的项目规模、环境和内部用户群。我很少使用 msi 进行部署，因为我们的操作太小而无法拥有多个环境（SharePoint 除外，这完全不同）。我们开发并使用 VS 将 web 应用程序部署到开发箱，假设它们被批准然后我们再次使用 VS 部署到 live 箱。

唯一的附带条件是我们有多个 web.config 副本（附加了 test、dev 和 live），然后我们根据其部署位置从相关文件中删除后缀。

它可能不是最好的方法（我知道它不是），但它很有效，并且有助于在小规模用户环境中快速部署中小型解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-27T21:52:04.983

F5ToDebug...

你说如果你没有时间正确地走捷径可以吗？

“谁来测试测试环境的代码？” 您自己说过您有 _test 的配置文件 - 为什么这不是一个合适的测试？

# regex - 需要正则表达式来查找两个标记之间的子字符串

> ID：489567
> 
> 赞同：5
> 
> 时间：2009-01-28T21:56:13.130
> 
> 标签：regex, regex-greedy

我怀疑这已经在某个地方得到了回答，但我找不到它，所以......

我需要从一个较大字符串中的两个标记之间提取一个字符串，其中第二个标记可能会再次出现，意思是......（伪代码......）

```
myString = "A=abc;B=def_3%^123+-;C=123;"  ;

myB = getInnerString(myString, "B=", ";" )  ;

method getInnerString(inStr, startToken, endToken){
   return inStr.replace( EXPRESSION, "$1");
} 
```

所以，当我使用表达式“ `.+B=(.+);.+`”运行它时，我得到“def_3%^123+-;C=123;” 大概是因为它只是寻找';'的最后一个实例 在字符串中，而不是停在第一个出现的地方。

我尝试使用 (?=) 来搜索第一个 ';' 但它给了我同样的结果。

我似乎找不到一个正则表达式参考来解释如何指定“NEXT”令牌而不是最后的那个。

非常感谢任何和所有帮助。

* * *

关于SO的类似问题：

*   [正则表达式：提取字符串中两个标签之间的子字符串](https://stackoverflow.com/questions/1237/regex-to-pull-out-a-section-a-substing-from-a-string-between-two-tags)
*   [正则表达式替换字符串中的所有 \n，但没有 [code] [/code] 标记内的那些](https://stackoverflow.com/questions/328387/regex-to-replace-all-n-in-a-string-but-no-those-inside-code-code-tag)
*   [使用正则表达式调用替换分隔符内的模式](https://stackoverflow.com/questions/180793/replace-patterns-that-are-inside-delimiters-using-a-regular-expression-call)
*   [正则表达式匹配 HTML 标签并提取文本](https://stackoverflow.com/questions/299942/regex-matching-html-tags-and-extracting-text)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T21:58:18.447

您通过不指定其中来使用贪婪模式`?`。试试这个：

```
".+B=(.+?);.+" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T21:58:03.767

试试这个：

```
B=([^;]+); 
```

这匹配 和 之间的所有内容`B=`，`;`除非它是`;`. 所以它匹配之后`B=`的所有内容`;`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T06:36:22.090

（这是从评论到埃文回答的对话的延续。）

以下是应用（更正的）正则表达式时发生的情况：首先，`.+`匹配整个字符串。然后它回溯，放弃它刚刚匹配的大部分字符，直到它到达`B=`可以匹配的点。然后`(.+?)`匹配（并捕获）它看到的所有内容，直到下一部分（分号）可以匹配。然后最终`.+`吞噬剩余的字符。

你真正感兴趣的是“B=”和“;” 以及它们之间的任何内容，那么为什么要匹配字符串的其余部分呢？您必须这样做的唯一原因是您可以将整个字符串替换为捕获组的内容。但是，如果您可以直接访问组的内容，为什么还要这样做呢？这是一个演示（在 Java 中，因为我不知道您使用的是什么语言）：

```
String s = "A=abc;B=def_3%^123+-;C=123;";

Pattern p = Pattern.compile("B=(.*?);");
Matcher m = p.matcher(s);
if (m.find())
{
  System.out.println(m.group(1));
} 
```

当“发现”如此简单时，为什么要“替换”？可能是因为你的 API 让它变得更容易了；这就是为什么我们用 Java 来做这件事。Java 在其 String 类中有几个面向正则表达式的便利方法：`replaceAll()`、`replaceFirst()`、`split()`和`matches()`（`true`如果正则表达式匹配*整个*字符串则返回），但不是`find()`。而且也没有方便的方法来访问捕获组。我们无法与这样的 Perl 单行代码的优雅相提并论：

```
print $1 if 'A=abc;B=def_3%^123+-;C=123;' =~ /B=(.*?);/; 
```

...所以我们满足于这样的黑客：

```
System.out.println("A=abc;B=def_3%^123+-;C=123;"
    .replaceFirst(".+B=(.*?);.+", "$1")); 
```

为了清楚起见，我并不是说不要使用这些技巧，或者埃文的回答有什么问题——没有。我只是认为我们应该了解我们*为什么*使用它们，以及我们在使用它们时要做出哪些权衡。

# xml - 您如何衡量/估计 XML 编程工作的规模？

> ID：489573
> 
> 赞同：7
> 
> 时间：2009-01-28T21:57:24.237
> 
> 标签：xml, jakarta-ee, estimation

设置场景 - 我在那些喜欢估计和跟踪几乎所有事情的行业之一工作。我们的关键指标之一是 SLOC（源代码行 - 声明性和可执行语句）。我们将其用于项目规模和成本估算、项目规划和许多其他事情。我们尝试用它来比较苹果和苹果（即，我们不会将一种语言/领域的 SLOC 与另一种语言/领域的 SLOC 进行比较）。 **注意**：我们不会根据这个指标评估单个开发人员，也不会仅仅因为 SLOC 与预期的不同而将其称为错误或坏事。然而，我们*确实认为一个项目有更多的 SLOC，也可能有更多的错误。*

就在最近，我开始在项目中使用库来代替原本需要手动编码的组件——例如 JSF 代替 JSP，Hibernate 代替 JDBC 等等。所以......而不是编写代码行，我们的团队正在开发 XML 文件。XML 映射仍然需要付出努力，并且复杂性之间仍然存在模糊的相关性 - 在给定项目中拥有多 100 倍的这些 XML 配置文件可能表明它需要更多的努力来创建并且可能比仅具有的项目更复杂的调试XML 文件的 1/100。

那么......有人对测量这些 XML 配置文件的大小有什么建议吗？# 元素？# 元素 + # 属性？别的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T18:54:16.377

有趣的问题。我知道的唯一指标（除了您建议的计算节点和属性之外）是称为结构化文档复杂性指标的东西。

[http://www.oreillynet.com/xml/blog/2006/05/metrics_for_xml_projects_5_str_1.html](http://www.oreillynet.com/xml/blog/2006/05/metrics_for_xml_projects_5_str_1.html)

是我目前能找到的最好的链接（已经有一段时间了）。我还发现了这个小工具，它显然会为你计算它（可能还有其他工具）：

[http://schematron.com/resources/documentcomplexitymetric.html](http://schematron.com/resources/documentcomplexitymetric.html)

除此之外，恐怕我唯一的建议是只选择几个指标来跟踪似乎合理的指标，然后重新评估它们以确定它们是否真的在对每个文档施加的努力中产生趋势......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T22:12:04.940

首先让我说，根据这样的标准评估项目就像根据同样的事情评估程序员一样愚蠢。我知道有研究表明代码行数和代码缺陷数量之间存在明显的相关性。在我看来，这只是一个扩大规模的问题。

话虽如此，如果您的领主...错误...我的意思是管理要求您提出一些建议，这里有一些相对容易的测量方法：

*   节点总数
*   节点类型数
*   每个节点的平均属性
*   最高级别的嵌套

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T22:26:22.493

好吧，如果您只是根据基本的 SOAP/WSDL 操作、消息和类型将模式映射到结构，那么您可能只需将这些方面中的每一个都等同于它各自的方法、消息和类。

例如......这样的客户模式：

```
 <?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns:tns="http://tempuri.org" 
           targetNamespace="http://tempuri.org"
           xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Customer">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="FirstName" type="xs:string" />
        <xs:element name="LastName" type="tns:LastNameType" />
      </xs:sequence>
      <xs:attribute name="CustID" type="xs:positiveInteger"
                    use="required" />
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="LastNameType">
    <xs:restriction base="xs:string">
      <xs:maxLength value="20"/>
    </xs:restriction>
  </xs:simpleType>
</xs:schema> 
```

...将等同于这样的客户类...

```
public class Customer
{
    public string FirstName{}
    public string LastName{get;set;}
    etc...
} 
```

通过这种方式，您可以继续在相对范围内使用当前的 SLOC 基准。

这样做的问题是，编写 XML 模式实际上并不能像编写 Java 或 C# 程序那样允许 LOC 的巨大变化。程序员可以用一百万种不同的方式编写 C# 类，其中架构定义更加结构化，并且只允许操作、消息和变量名称的长度变化。因此，如果您现在只是编写 XML 而不是 Java 或 C#，那么您可能需要考虑您的 SLOC 指标在确定项目大小和错误方面将比过去少很多。

# javascript - 获取当前 GMT 世界时间

> ID：489581
> 
> 赞同：36
> 
> 时间：2009-01-28T21:58:40.847
> 
> 标签：javascript

我怎样才能得到当前时间？（在 JavaScript 中）

不是您计算机的时间，例如：

```
now = new Date;
now_string = addZero(now.getHours()) + ":" + addZero(now.getMinutes()) + ":" + addZero(now.getSeconds()); 
```

但真正准确的世界时间？

我是否需要连接到服务器（很可能是的，是哪一个？以及如何从中检索时间？）

我从谷歌做的所有搜索都返回`(new Date).getHours()`.

编辑：

如果用户的计算机时间错误，我想避免显示错误的时间。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-28T23:10:39.173

您可以使用 JSON[P] 并访问时间 API：

（下面的代码应该可以完美运行，刚刚测试过......）

```
function getTime(zone, success) {
    var url = 'http://json-time.appspot.com/time.json?tz=' + zone,
        ud = 'json' + (+new Date());
    window[ud]= function(o){
        success && success(new Date(o.datetime));
    };
    document.getElementsByTagName('head')[0].appendChild((function(){
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.src = url + '&callback=' + ud;
        return s;
    })());
}

getTime('GMT', function(time){
    // This is where you do whatever you want with the time:
    alert(time);
}); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-28T22:12:21.867

首先，要获得准确的 GMT 时间，您需要一个您信任的来源。这意味着某处的某些服务器。Javascript 通常只能进行 HTTP 调用，并且只能对托管相关页面的服务器进行调用（同源策略）。因此，该服务器必须是您的 GMT 时间来源。

我会将您的网络服务器配置为使用 NTP 将其时钟与 GMT 同步，并让网络服务器通过将变量写入页面来告诉脚本它是什么时间。或者当你需要知道的时候make和XmlHttpRequest返回给服务器。不利的一面是，由于所涉及的延迟，这将是不准确的：服务器确定时间，将其写入响应，响应通过网络传播，并且只要客户端的 cpu 给它一个时间片，javascript就会执行，等等。如果页面很大，慢速链接可能会延迟几秒钟。您可以通过确定用户时钟与 GMT 的距离，并通过该偏移量调整所有时间计算来节省一些时间。当然，如果用户'

另请记住，客户端可以更改数据，因此不要相信他们发送给您的任何时间戳。

**编辑**： [JimmyP 的答案](https://stackoverflow.com/questions/489581/getting-the-current-gmt-world-time/489846#489846)非常简单易用：使用 Javascript 添加一个`<script>`调用 url 的元素，例如[http://json-time.appspot.com/time.json?tz=GMT](http://json-time.appspot.com/time.json?tz=GMT). 这比自己做这件事更容易，因为 json-time.appspot.com 服务器作为 GMT 时间的来源，并以允许您解决同源策略的方式提供此数据。我会建议简单的网站。但是它有一个主要缺点：json-time.appspot.com 站点可以在您的用户页面上执行任意代码。这意味着，如果该站点的运营商想要分析您的用户或劫持他们的数据，他们可以轻松做到这一点。即使您信任运营商，您也需要相信他们没有被黑客入侵或入侵。对于商业站点或任何具有高可靠性问题的站点，我建议您自己托管时间解决方案。

**编辑 2**： [JimmyP 的答案](https://stackoverflow.com/questions/489581/getting-the-current-gmt-world-time/489846#489846)有一条评论，表明 json-time 应用程序在它可以支持的请求数量方面存在一些限制。这意味着如果您需要可靠性，您应该自己托管时间服务器。但是，在您的服务器上添加一个响应相同格式数据的页面应该很容易。基本上，您的服务器接受查询，例如

```
http://json-time.appspot.com/time.json?tz=America/Chicago&callback=foo 
```

并返回一个字符串，例如

```
foo({
 "tz": "America\/Chicago", 
 "hour": 15, 
 "datetime": "Thu, 09 Apr 2009 15:07:01 -0500", 
 "second": 1, 
 "error": false, 
 "minute": 7
}) 
```

注意`foo()`哪个包装了 JSON 对象；这对应于查询中的 callback=foo 。这意味着当脚本加载到页面中时，它将调用您的 foo 函数，该函数可以随时间做任何事情。此示例的服务器端编程是一个单独的问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-03T22:35:51.047

你为什么不发送每一页的时间？例如在 html 中的某处：

```
<span id="time" style="display:none;">
    2009-03-03T23:32:12
</span> 
```

然后，您可以在网站加载并解释日期时运行 Javascript。这将减少网络必须做的工作量。您可以存储相应的本地时间，并在每次需要时计算偏移量。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T22:11:21.243

您可以使用[getTimezoneOffset](http://www.w3schools.com/jsref/jsref_getTimezoneOffset.asp)来获取本地日期和 GMT 日期之间的偏移量，然后进行数学运算。但这只会与用户的时钟一样准确。

如果你想要一个准确的时间，你应该连接到一个[NTP 服务器](http://support.ntp.org/bin/view/Main/WebHome)。由于[Same Origin Policy](https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript)，您无法使用 JS 向另一台服务器发出请求，然后是您的服务器。我建议您创建一个连接到 NTP 服务器的服务器端脚本（使用 PHP 或任何您想要的语言）并返回准确的日期。然后，使用 AJAX 请求读取这个时间。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-10-29T18:16:37.987

[对Shiny 先生和 New 先生](https://stackoverflow.com/a/489637/706466)和[James](https://stackoverflow.com/a/489846/706466)的回答做一点补充

这是一个 PHP 脚本，您可以将其放置在自己的服务器上并使用它来代替 json-time.appspot.com

```
<?php
header('Content-Type: application/json');
header("Expires: Tue, 01 Jan 1990 00:00:00 GMT");
header("Cache-Control: no-store, no-cache, must-revalidate, max-age=0");
header("Cache-Control: post-check=0, pre-check=0", false);
header("Pragma: no-cache");

$error = "false";
$tz = $_GET['tz'];

if ( !in_array($tz, DateTimeZone::listIdentifiers())) {
   $error = 'invalid time zone';
   $tz = 'UTC';
}

date_default_timezone_set($tz);

?>
<?php echo htmlspecialchars($_GET['callback'], ENT_QUOTES, 'UTF-8' ); ?>({
 "tz": "<?php echo $tz ?>",
 "hour": <?php echo date('G'); ?>,
 "datetime": "<?php echo date(DATE_RFC2822); ?>",
 "second": <?php echo intval(date('s')); ?>,
 "error": "<?php echo $error; ?>",
 "minute": <?php echo intval(date('i')); ?>
}) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-29T01:03:38.633

正如[Shiny 和 New 先生](https://stackoverflow.com/users/7867)所说，您需要一个时间正确的服务器。它可以是您站点所在的服务器，也可以是其他一些以您可以阅读的格式发送正确时间的服务器。

如果您想在页面上多次使用日期，间隔一秒或多秒，您可能不想每次都从服务器获取时间，而是缓存差异并使用客户端时钟。如果是这种情况，这里是众多解决方案之一：

```
var MyDate = new function() {
    this.offset = 0;
    this.calibrate = function (UTC_msec) {
        //Ignore if not a finite number
        if (!isFinite(UTC_msec)) return;

        // Calculate the difference between client and provided time
        this.offset = UTC_msec - new Date().valueOf();

        //If the difference is less than 60 sec, use the clients clock as is.
        if (Math.abs(this.offset) < 60000) this.offset = 0;
    }
    this.now = function () {
        var time = new Date();
        time.setTime(this.offset + time.getTime());
        return time;
    }
}(); 
```

将其包含在您的页面中，并让您的服务器端脚本生成如下行：

```
MyDate.calibrate(1233189138181); 
```

其中数字是自 1970 年 1 月 1 日以来的当前时间（以毫秒为单位）。您还可以使用您最喜欢的 AJAX 框架并让它调用上面的函数。或者您可以使用[JimmyP](https://stackoverflow.com/users/21677/)建议的解决方案。我已经重写了 JimmyPs 解决方案以包含在我的解决方案中。只需在上面的函数中复制并粘贴以下内容：

```
 this.calibrate_json = function (data) {
        if (typeof data === "object") {
            this.calibrate (new Date(data.datetime).valueOf() );
        } else {
            var script = document.createElement("script");
            script.type="text/javascript";
            script.src=(data||"http://json-time.appspot.com/time.json?tz=UTC") +
                "&callback=MyDate.calibrate_json";
            document.getElementsByTagName('head')[0].appendChild(script);
        }
    }
    this.calibrate_json(); //request calibration with json 
```

请注意，如果您从*MyDate更改函数的名称，则必须在**script.src*行的*this.calibrate_json*中更新回调。

 *解释：

*Mydate.offset*是服务器时间和客户端时钟之间的当前偏移量，以毫秒为单位。

*mydate.calibrate(x);* 是一个设置新偏移量的函数。它期望输入是自 1970 年 1 月 1 日以来的当前时间（以毫秒为单位）。如果服务器和客户端时钟之间的差异小于 60 秒，则将使用客户端时钟。

*Mydate.now()*是一个返回具有当前校准时间的日期对象的函数。

*Mydate.calibrate_json( data )*是一个函数，它可以将 url 传递给返回 datetime 回复的资源，也可以获取具有当前时间的对象（用作回调）。如果未提供任何内容，它将使用默认 url 来获取时间。url 必须有一个问号“？” 在里面。

如何每秒使用当前时间更新元素的简单示例：

```
setInterval(
    function () {
        var element = document.getElementById("time");
        if (!element) return;
        function lz(v) {
            return v < 10 ? "0" + v : v;
        }
        var time = MyDate.now();
        element.innerHTML = time.getFullYear() + "-" +
            lz(time.getMonth() + 1) + "-" +
            lz(time.getDate()) + " " +
            lz(time.getHours()) + ":" +
            lz(time.getMinutes()) + ":" +
            lz(time.getSeconds())
        ;
},1000); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-04-19T19:03:45.877

我偶然发现了另一种解决方案，适用于那些无法访问服务器端的人。问题[的答案](https://stackoverflow.com/questions/4904487/getting-default-server-time-in-jquery/4904541#4904541)[在 jQuery 中获取默认服务器时间？](https://stackoverflow.com/questions/4904487/getting-default-server-time-in-jquery).

基本上，您可以通过对“/”执行 AJAX HEAD 请求来获取“日期”标头。并非所有服务器都支持这一点，并且可能需要一些复杂的操作才能使其与特定服务器一起使用。

[查看真正的答案](https://stackoverflow.com/questions/4904487/getting-default-server-time-in-jquery/4904541#4904541)以获取更多详细信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-04-24T18:31:13.427

IMO，最简单的解决方案是启动 AWS Lambda（或 Google Serverless）并通过 API Gateway 附加它，为您提供时间服务器，而无需管理任何基础设施。我的 Lambda 代码：

```
import datetime
import json

def lambda_handler(event, context):
   dt = datetime.datetime.utcnow()

   return {
      'statusCode': 200,
      'body': json.dumps({
      'iso_time': dt.strftime('%Y-%m-%dT%H:%M:%SZ')
   })
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T22:54:31.953

我们已经成功使用了 EarthTools 的 API：

[地球工具](http://www.earthtools.org/webservices.htm#timezone)

该服务返回带有当前 GMT 和时区偏移量等信息的 XML（当提供纬度和经度时）。我们在 ASP.NET 页面的 VB 后端使用 WebClient 和 XMLDocument 来读取和解释 XML。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-09-02T08:33:08.823

由于与[詹姆斯的](https://stackoverflow.com/questions/489581/getting-the-current-gmt-world-time/489846#489846)答案相关的服务似乎不再起作用，我找到了另一个很好的休息 API 可以用于此目的，它工作正常。来源是这个网站：[timeapi](http://www.timeapi.org/)，你可以使用的代码就是这个（使用jQuery库和API提供的jsonp回调）：

```
 $.getJSON("http://www.timeapi.org/utc/now.json?callback=?",function(json){
       //console.log(json)
       alert(json.dateString);
 }); 
```

有了这个，您将拥有格式中的日期和小时，例如

```
 September 02, 2016 09:59:42 GMT+0100 
```

如果您想在 javascript 中操作它，获得小时数，只需将其转换为 Date 对象，如下所示：

```
 new Date(json.dateString) 
```

因此，例如，您可以这样写：

```
 $.getJSON("http://www.timeapi.org/utc/now.json?callback=?",function(json){

         var now = new Date(json.dateString);
         var hours = now.toLocaleTimeString();

         alert(hours)

    }); 
```

这样，您将获得准确的本地时间（以小时为单位）。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-03-05T02:02:48.230

你可以在 PHP 中做到这一点

```
<?php
$json = file_get_contents( "http://json-time.appspot.com/time.json?tz=GMT" );
$obj = json_decode($json);
$timenow= $obj->{'datetime'};
$hournow= $obj->{'hour'}; 
$minutenow= $obj->{'minute'}; 
$secondnow= $obj->{'second'}; 
?> 
```

`$timenow`包含您的完整日期和时间：“2012 年 3 月 5 日星期一 01:57:51 +0000”，`$hournow`：“1” `$minutenow`：“57”。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2014-04-07T17:44:40.487

如果您的 javascript 是从 Web 服务器提供的，那么您可以使用这个简单的函数从该服务器请求时间。如果服务器在 HTTP 响应中返回 Date 标头，它将起作用。

```
function getServerTime()
{
    var req = new XMLHttpRequest();
    req.open('GET', document.location, false);
    req.send(null);
    return new Date(req.getResponseHeader("Date"));
} 
```

由于缓存，这可能会返回错误的时间。要解决此问题，您可以使用随机 URL：

```
req.open('GET', "/time?r=" + Math.floor(Math.random()*10000000), false); 
```

# algorithm - 纠错码可以构成一个有趣的游戏吗？

> ID：489584
> 
> 赞同：4
> 
> 时间：2009-01-28T21:59:21.877
> 
> 标签：algorithm

每当我玩 Sudoko 时，我都会将完成的谜题视为原始输入的过度指定版本。像 8b/10b、Reed-Solomon 码、turbo 码或低密度奇偶校验码。对于 ECC，计算机必须解决一个难题才能产生正确的数据，而对于数独，人类必须解决一个难题才能产生 81 位数*的乐趣*。

您认为这些 ECC 代码中的任何一个都能成为一款出色的纸笔游戏吗？（8b/10b——家庭版！）

有没有一种好方法可以将数据表示为数独谜题，以提供最荒谬的 ECC？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T01:36:39.597

在最终结果中查看超规格的另一种方法是将原始状态视为压缩算法的结果。

[非图](http://en.wikipedia.org/wiki/Nonogram)是以信息密集谜题的形式表示的信息非常稀疏的结果的另一个例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T01:44:42.217

将任意数据表示为数独谜题并不是特别可行，因为数独网格的总数（因此，一个谜题可以表示的不同信息的数量）太少（大约 6E21），无法编码大量数据（超过大约 9 个字节）。

再加上为给定解决方案生成非歧义谜题的计算难度，以及针对不同解决方案的最佳谜题的广泛变化的数据密度。

# c# - C#：如何在强制不同的编组时调用方法？

> ID：489596
> 
> 赞同：3
> 
> 时间：2009-01-28T22:01:56.037
> 
> 标签：c#, .net, reflection, binding

在 Microsoft 的 Primary Interop 程序集中声明的方法是错误的。

它被声明为：

```
void Write(object[] psarray); 
```

这是不正确的，实际上应该声明为：

```
void Write([In, MarshalAs(UnmanagedType.SafeArray)] object[] psarray); 
```

`[In, MarshalAs(UnmanagedType.SafeArray)]`调用原始方法时，我需要强制编译器使用。

我不反对做类似的*事情*：

```
object[] parameters = new Object[1];
parameters[0] = theStringIWantedToPass;

thing.GetType().InvokeMethod(
      "write", 
      BindingFlags.InvokeMethod,
      null,
      thing, 
      parameters); 
```

但我必须知道如何覆盖**InvokeMethod**以使用**UnmanagedType.SafeArray**编组。

***注意：****我说“喜欢”，因为我不知道使用反射调用方法是否甚至可以完成我需要的。关键是我不反对长期调用方法，或者加载寄存器和发出汇编 JMP 指令，只要 .NET 允许这种事情。*

* * *

**注意：**我不能用不同的签名重新声明这个类，因为那是一个不同的类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T22:24:47.720

克服这个缺点的一种方法是拆卸 PIA，修复问题，然后重建。

这不是我或我的一个伙伴过去第一次不得不使用互操作程序集来执行此操作。

# javascript - JavaScript 字符串替换问题

> ID：489601
> 
> 赞同：0
> 
> 时间：2009-01-28T22:02:31.823
> 
> 标签：javascript

我正在对从 JSON Web 服务返回的文本进行一些字符串替换，字符串可能如下所示：

```
"Hello I am a string.\r\nThis is a second line.\r\n\r\nThis is a bigger space" 
```

我想`\r\n`用`<br />`标签替换所有的，以便格式化 HTML，但是当我这样做时：

```
var string = result.replace('\r\n','<br />'); 
```

我只替换了第一个实例，而不是任何其他实例。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T22:05:53.143

尝试设置全局标志的正则表达式：

```
var string = result.replace(/\r\n/g,'<br />'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T22:06:30.660

没有。这就是 JavaScript 替换函数的工作原理 :)

您可以使用正则表达式来替换所有出现的地方。

```
var string = result.replace(/\r\n/g, '<br />'); 
```

看看[这个](http://www.tizag.com/javascriptT/javascript-string-replace.php "JavaScript 替换教程")链接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T23:54:50.630

虽然在这种情况下使用正则表达式*绝对*是您最想使用的，但您可能会发现自己在生活中的某个时候至少会遇到一两次以上的问题，而且您希望少做一点的可能性很小比正则表达式自然会做的事情。出于这个原因，我将演示一种替代方法，它在完成相同的事情的同时，为潜在的定制留出了更多空间：

```
<script>
while (result.indexOf('\r\n') != -1)
 {
result = result.replace('\r\n', '<br />');
 }
string = result;
</script> 
```

我喜欢使用这个方法（一个`while`块）和原型来修改JavaScript 中附加到 String 对象的本机**replace()方法。**

# iphone - 禁用 UINavigationBar 渐变

> ID：489605
> 
> 赞同：0
> 
> 时间：2009-01-28T22:04:03.940
> 
> 标签：iphone, cocoa-touch, uinavigationbar

有人知道如何在 UINavigationBar 中禁用渐变并使其完全变黑吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T09:05:40.407

创建一个继承自 UINavigationBar 并实现自己的`drawRect:`方法的类。您可能必须自己绘制标题和按钮（在这种情况下，为什么不使用自定义视图？）

# c# - WinDbg 和 Visual Studio Express 版本

> ID：489607
> 
> 赞同：0
> 
> 时间：2009-01-28T22:04:32.693
> 
> 标签：c#, debugging, windbg

WinDbg 可以和[Visual C# 2008 Express Edition](https://en.wikipedia.org/wiki/Microsoft_Visual_Studio_Express#Visual_C.23_Express)一起使用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T22:13:27.603

windbg 并不是真正的 IDE 调试器；它更常直接用于机器上已编译的 exe。因此，是的，使用Express Edition*编译*的 exe 应该没问题，但不可以：Express Edition 没有直接参与*其中*。

最终，Express、Pro、Team 等产品都使用可以在命令行中使用的相同编译器（`csc`尽管它们可能比 exe 更直接地访问它！）。

也看看“SOS”（罢工之子）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T18:01:51.977

好问题。

VS C# 2008 Express Edition 包含一个托管调试器。
您很可能会在针对同一进程运行 Windbg 和 VS2008 托管调试器时遇到一些问题。

您可能遇到的情况是中断和 Windbg 中的访问冲突，通常在没有本机调试器的情况下处理得很好。

只要您不打算同时执行本机和托管调试（使用不同的调试器），您就可以将 Windbg 以**非侵入模式**附加到在托管调试器下运行的进程，而不会出现任何问题。

这是 ICordbg 上一些附加信息的链接（[ICorDebug 的分区](http://blogs.msdn.com/jmstall/archive/2006/01/04/icordebug_overview.aspx)）

谢谢，亚伦

# winapi - GetProfileInt... 在注册表中的什么位置？

> ID：489609
> 
> 赞同：2
> 
> 时间：2009-01-28T22:05:00.383
> 
> 标签：winapi, registry

简单的问题，如果有人碰巧知道答案。我正在维护一个旧的 Windows 应用程序；它使用 GetProfileInt 来检索设置。文档说它“从注册表中读取”。下落？我知道在较旧的操作系统上，它从 win.ini 读取。win.ini 类型的条目存储在注册表中的什么位置？

谢谢，劳尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T22:14:49.940

您的答案在 MSDN 文档中针对该功能在技术上有所定义。

[http://msdn.microsoft.com/en-us/library/ms724360](http://msdn.microsoft.com/en-us/library/ms724360)

本质上，该调用是为了 16 位 Windows 兼容性，但如果您先在注册表中设置一些映射，它仍然*可以工作。*

简而言之，如果可能的话，您可能希望使用真正的注册表功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:18:40.697

MSDN 说它是否在 INI 文件中，是否在注册表中取决于您运行的 Windows 版本。我按照他们的指示，但找不到我要找的东西（就像互联网上的很多用户一样）。

所以这就是我用蛮力做的：

1/ 打开`C:`驱动器，搜索所有`*.ini`包含您要使用的关键字的文件`GetProfileInt`。如果没有显示，它在注册表中。

2/ 打开`regedit`，搜索关键字。

在我的情况下，我运行的是 Windows XP，并且第 1 点/工作正常，我正在寻找的文件在`C:\Windows\`其中并命名为`{MYAPP}.ini`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T22:13:41.333

GetProfileInt 的 MSDN 文档提供了路径。如果这被证明是错误的，来自 www.sysinternals.com 的 ProcMon 应该向您展示。

# c# - 将csv文件/excel导入sql数据库asp.net

> ID：489620
> 
> 赞同：10
> 
> 时间：2009-01-28T22:07:52.060
> 
> 标签：c#, asp.net, architecture, .net-3.5, import

我正在使用 c# 使用 asp.net visual studio 2008 / SQL 2000（未来为 2005）开始一个项目。

对我来说棘手的部分是现有的数据库架构经常更改，并且导入文件列都必须与现有的数据库架构匹配，因为它们在列名上可能不是一对一的匹配。（有一个查找表，它为表模式提供了我将使用的列名）

我正在探索解决此问题的不同方法，并且需要一些专家建议。是否有任何现有的控件或框架可以用来做这些？

到目前为止，我探索了 FileUpload .NET 控件，以及一些 3rd 方上传控件来完成上传，例如[SlickUpload](http://krystalware.com/Products/SlickUpload/)，但上传的文件应该小于 500mb

下一部分是读取我的 csv /excel 并解析它以显示给用户，以便他们可以将它与我们的 db 模式匹配。我看到了[CSVReader](http://www.codeproject.com/KB/database/CsvReader.aspx)和其他人，但对于 excel，它更难，因为我需要支持不同的版本。

本质上，执行此导入的用户将从该导入文件中插入和/或更新几个表。还有其他更高级的要求，例如记录匹配和导入记录的预览，但我希望先了解如何做到这一点。

更新：我最终使用 csvReader 和 LumenWorks.Framework 来上传 csv 文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T06:08:43.073

查看出色的 FileHelpers 库——[在 CodeProject 上有一篇](http://www.codeproject.com/KB/database/filehelpers.aspx)关于它的文章，它位于[此处](http://www.filehelpers.com/)。

它是纯 C#，它可以导入几乎任何平面文件、CSV，它也可以处理 Excel。导入是完全可配置的 - 您可以定义分隔符、要跳过的行和/或列等内容 - 有很多选项。

我已经在各种项目中成功地使用了它，而且它完美无瑕——强烈推荐。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T01:57:13.113

您可以通过 Excel 或 CSV 文件轻松创建 IDataReader（请参阅[http://support.microsoft.com/kb/316934](http://support.microsoft.com/kb/316934)）。

您是否使用 SQL Server 作为数据库引擎？如果是这样，您可以使用 SqlBulkCopy 类 ( [http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx) ) 来有效地获取您的 IDataReader，根据需要映射列，并存储结果在您的数据库中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T02:11:49.917

我怀疑可能存在一些强大而灵活的工具来帮助你处理这个可能非常复杂的应用程序，希望有人会指出你。

同时，我发现这是一个有用的函数，可以将 excel 文件转换为 DataTable。此版本仅查找第一个工作表。它可以作为一个起点。与 csv 文件类似的东西只需要修改连接字符串。

```
public static DataTable GetDataTableFromExcel(string SourceFilePath)
{
    string ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" +
                                "Data Source=" + SourceFilePath + ";" +
                                "Extended Properties=Excel 8.0;";

    using (OleDbConnection cn = new OleDbConnection(ConnectionString))
    {
        cn.Open();

        DataTable dbSchema = cn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);
        if (dbSchema == null || dbSchema.Rows.Count < 1)
        {
            throw new Exception("Error: Could not determine the name of the first worksheet.");
        }

        string WorkSheetName = dbSchema.Rows[0]["TABLE_NAME"].ToString();

        OleDbDataAdapter da = new OleDbDataAdapter("SELECT * FROM [" + WorkSheetName + "]", cn);
        DataTable dt = new DataTable(WorkSheetName);

        da.Fill(dt);

        return dt;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T06:51:22.160

[FileHelpers](http://filehelpers.sourceforge.net/)是您的朋友。我已经愉快地将它用于几个项目，它为我节省了很多悲伤和劳动

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-05T19:39:20.117

我正在使用 LumenWorks.Framework 中的 csvReader 将 csv 文件上传并导入到我根据导入的列创建的内存中的 sql 表和 DataTable 中。

我还让用户在 ui 中映射字段，然后通过将每条记录标记为插入/更新/错误来验证和准备要导入的数据。然后，我为每个将受到影响的表创建/填充强类型数据集，并为 Enterprise Library UpdateDataset() 方法构建插入/更新查询。

然后我提交事务以插入/更新数据库。——</p>

映射是一个有 4 列的网格。（导入字段名称、目标表、目标字段名称、忽略、匹配状态），目标表和字段名称被选择，根据所选表刷新。我动态填充选择。如果找到匹配项，则最初选择组合填充 1 个值，否则请选择。ignore 允许用户忽略该字段。匹配状态是字段是否自动映射

# design-patterns - 您使用工厂而不是构造函数来创建对象的阈值是多少？

> ID：489623
> 
> 赞同：11
> 
> 时间：2009-01-28T22:08:44.633
> 
> 标签：design-patterns, domain-driven-design, factory

您使用工厂而不是构造函数来创建对象的阈值是多少？

1.  你总是使用工厂。
2.  仅当您有除检查空值之外的不变检查时，您才使用工厂。
3.  你总是使用构造函数
4.  你很少使用工厂......那些情况是什么？

利弊

更新：我在我的项目中应用域驱动设计的工厂模式。创建工厂的原因之一是减少领域模型中的噪音。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-28T22:31:16.867

如果我有一个抽象基类（或接口）和几个具体的派生类，我会使用一个工厂，并且有一些逻辑根据哪个具体类来创建。我在工厂中实现了这个逻辑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T22:52:14.437

工厂最明显的情况是在运行时选择实现接口的特定类，例如从配置文件中选择。我没有大量使用工厂，但是当我希望两个对象高度解耦时，我更有可能使用工厂来获取另一个的实例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T23:51:08.547

与此主题相关的 C# 的一些有趣之处在于，对类定义中指定的泛型类型的 new() 约束强制由泛型容器类型处理的类型实现无参数构造函数。仅当打算在`GenericType<T>`类中创建类型 T 的实例时，才需要 new() 约束，例如在 中。在我看来，这是明确支持类工厂，尤其是生产泛型类型的工厂。

为了扭转这一要求，Windows Communication Foundation (WCF) 有一个 ChannelFactory 类，它定义了以下静态工厂方法：

```
public static TChannel CreateChannel(Binding binding, EndpointAddress endpointAddress, Uri via)
{
    ChannelFactory<TChannel> factory = new ChannelFactory<TChannel>(binding);
    if (factory.HasDuplexOperations())
    {
        throw DiagnosticUtility.ExceptionUtility.ThrowHelperError(new InvalidOperationException(SR.GetString("SFxInvalidStaticOverloadCalledForDuplexChannelFactory1", new object[] { factory.channelType.Name })));
    }
    TChannel channel = factory.CreateChannel(endpointAddress, via);
    ChannelFactory<TChannel>.SetFactoryToAutoClose(channel);
    return channel;
} 
```

如果您在反射器中查看类反汇编（System.ServiceModel 程序集和 System.ServiceModel.Channels 命名空间），您会注意到“new()”没有用作约束。

那是因为 CreateChannel 方法使用 typeof(TChannel) 将对象创建委托给更远的链...

```
public virtual TChannel CreateChannel(EndpointAddress address, Uri via)
{
    TChannel local;
    bool traceOpenAndClose = base.TraceOpenAndClose;
    try
    {
        using (ServiceModelActivity activity = (DiagnosticUtility.ShouldUseActivity && base.TraceOpenAndClose) ? ServiceModelActivity.CreateBoundedActivity() : null)
        {
            if (DiagnosticUtility.ShouldUseActivity)
            {
                ServiceModelActivity.Start(activity, this.OpenActivityName, this.OpenActivityType);
                base.TraceOpenAndClose = false;
            }
            if (address == null)
            {
                throw DiagnosticUtility.ExceptionUtility.ThrowHelperArgumentNull("address");
            }
            if (base.HasDuplexOperations())
            {
                throw DiagnosticUtility.ExceptionUtility.ThrowHelperError(new InvalidOperationException(SR.GetString("SFxCreateNonDuplexChannel1", new object[] { base.Endpoint.Contract.Name })));
            }
            base.EnsureOpened();
            local = (TChannel) this.ServiceChannelFactory.CreateChannel(typeof(TChannel), address, via);
        }
    }
    finally
    {
        base.TraceOpenAndClose = traceOpenAndClose;
    }
    return local;
} 
```

随着 Type 类被向下传递，您可以沿着委托链更深几级，直到最终调用以下方法：

```
RemotingServices.CreateTransparentProxy(this, classToProxy, stub, stubData); 
```

它非常复杂，但它是我见过的最复杂的工厂。有趣的是，所有的阴谋最终都导致 WCF 从 System.Runtime.Remoting.Proxies 命名空间创建一个 RealProxy 类。

总之，工厂适用于具有很多复杂性或需要从动态类型构造中受益的对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T22:18:49.043

我不确定您是如何选择阈值的...

如果您不想从构造中抽象出对象的使用者，工厂是合适的。可能与此相关的实例：

*   您可能希望在运行时分出实现。通常这与使用接口而不是具体类相结合。Java 中的一个示例是如何从 Java 中的 DocumentBuilder 获取 Document 对象。
*   您可能希望限制对象的实例数。考虑用有限数量的线程对象构造一个池，而不是一直创建新的

查看 Book of Four (Gamma et. al.) 模式书并详细查看工厂模式以获取有关何时使用此模式的更多信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T21:31:57.687

这是一个激进的想法（我并不是真的提倡它，但我认为它不会有害）：

始终使用工厂方法！

工厂方法更灵活，例如，它们可以缓存结果或返回子类。

所以，而不是：

```
class SomeClass {
  public SomeClass(/*parameters*/) { /*...*/ }
} 
```

始终使用：

```
class SomeClass {
  protected SomeClass(/*parameters*/) { /*...*/ }
  public static SomeClass New(/*parameters*/) {
    return new SomeClass(/*parameters*/);
  }
} 
```

调用方代码更改为：

```
SomeClass sc = new SomeClass(); 
```

至：

```
SomeClass sc = SomeClass.New(); 
```

您现在可以更改“构造函数”逻辑以返回子类或缓存实例，并且所有调用者都不会受到影响。您现在可以控制“构造函数”的返回值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T22:14:11.533

我喜欢将构造函数的数量保持在合理的低水平；超过两三个，我质疑这个物体的结构设计得有多好。

在引入其他构造函数以支持设置各种可选属性的情况下，我喜欢使用[Builder](http://rwhansen.blogspot.com/2007/07/theres-builder-pattern-that-joshua.html)，如*[Effective Java](http://www.amazon.co.uk/Effective-Java-Second-Joshua-Bloch/dp/0321356683/ref=sr_1_2?ie=UTF8&s=books&qid=1233180737&sr=8-2)*（Joshua Bloch，第 2 版）中所述。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T23:39:08.023

当实例化哪个具体类的决定不取决于客户端时，请使用工厂。例如，当有多个对象“族”时，选择使用哪个族是在别处进行的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T22:16:35.490

我尝试在这些之间进行衡量。我认为你应该在以下情况下使用工厂：

1.  参数数量多。
2.  可选参数。**（两者都使用内部类 Builder 模式）**
3.  由于参数类型相同但数据不同，您必须更改参数的顺序才能完成其他操作。
4.  你需要一个单例类（最好用枚举）

对于工厂，在这种情况下，您可以为返回的对象状态指定一个正确的名称。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-29T01:07:03.493

I think you are confusing the Builder pattern and the Factory pattern. I would suggest just using constructors and being done with it. It sounds like (without seeing the code) you're overthinking or overanalysing your code a bit.

# c++-cli - 订阅事件的 C++/CLI 语法是什么？

> ID：489626
> 
> 赞同：7
> 
> 时间：2009-01-28T22:09:33.680
> 
> 标签：c++-cli, managed-c++

我正在更新一些旧的托管 C++ 代码，如下所示：

```
instanceOfEventSource->add_OnMyEvent( 
    new EventSource::MyEventHandlerDelegate(this, MyEventHandlerMethod) ); 
```

在哪里

*   **EventSource**是发布事件的类
*   **instanceOfEventSource**是该类的一个实例
*   **EventSource::MyEventHandlerDelegate**是事件的委托类型
*   **MyEventHandlerMethod**是当前类（其中“this”是一个实例）中的（非静态）方法，其签名匹配 EventSource::MyEventHandlerDelegate

在 C++/CLI 中正确的语法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T22:15:27.523

语法类似于 C# 的，换句话说，`+=`被重载以使这成为可能：

```
instanceOfEventSource.MyEvent +=
    gcnew EventSource::MyEventHandlerDelegate(this, &MyClass::MyEventHandlerMethod); 
```

类似地用于移除。然而，与 C# 不同的是，您不能忽略事件处理程序委托的显式实例化，因此这会产生相当冗长的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-20T01:53:03.560

我刚刚花了半个小时试图弄清楚如何将静态方法注册为事件的回调方法。虽然 OP 没有特别要求注册静态方法，但这将有助于其他面临同样问题的人。这实际上非常简单，在这种情况下，委托构造函数只为静态目标方法采用一个参数。

例子：

```
System::EventHandler^ h = gcnew System::EventHandler(&MyClass::MyStaticCallbackMethod); 
```

# iphone - 为 iPhone 应用程序中的大量数据而设计

> ID：489631
> 
> 赞同：1
> 
> 时间：2009-01-28T22:10:48.593
> 
> 标签：iphone, object, model

我有一个手机应用程序，打开时需要显示一个包含大约 25000 条记录的数据表。每条记录由两个字段组成：TITLE 和DESCRIPTION。这两个字段在每个表格单元格中都可见。表格视图也可以使用 UISearchBar 进行完全搜索。

当应用程序启动并加载此视图时，“集合对象”会从表中获取所有数据并将其加载到“项目对象”中。因为我需要两个字段来搜索，所以我真的没有什么可以补水/脱水的；因此，整个表都在内存中。必须有更好的方法提供完整的搜索功能，但同时大幅减少内存中的对象数量。

有任何想法吗？

**编辑：**

我想我应该进一步解释。

我已经在使用 SQLite 数据库。我的问题是将 20,000 条记录加载到内存中花费的时间太长，而且应用程序看起来很慢。

另外，如果我在当前选择的两边只有 100 条记录，我怎么能搜索所有记录（包括那些不在内存中的记录）？

我将研究表代表建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T09:03:42.143

您应该使用 SQL 进行搜索，而不是将所有内容加载到内存中并从那里进行搜索。如果您像平面文件一样使用数据库，那么它有什么意义？

此外，许多应用程序都有一个“加载更多”条目作为其表格视图中的最后一个条目，这会向视图中添加更多项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T04:06:33.997

也许我可以澄清一下其他人在说什么。

正如您肯定知道的那样，表视图必须有一个数据源，该数据源至少实现了`<UITableViewDatasource>`协议中的两个必需方法：

```
– tableView:cellForRowAtIndexPath:  
– tableView:numberOfRowsInSection: 
```

我怀疑您当前的实现`– tableView:cellForRowAtIndexPath:` 只是从全局集合对象中获取两个字符串，将它们弹出到一个单元格中（希望一个被正确重用的单元格！）并返回它。

它可能应该做的是根据需要从数据库中检索这些数据。我会实现一个类（或多个类）来在应用程序和数据库之间进行调解，并将例如 100 行的块返回到充当数据源的任何类（SQLite 支持 LIMIT 和 OFFSET 关键字），它将持有到那个有限的集合上。

当`– tableView:cellForRowAtIndexPath:`被 tableView 调用时，您可以检查数据是否在本地存储的块中（我会创建一个属性来存储当前的记录偏移量），如果没有，则使用对 DB 的请求来更新本地块以进行下一个（或以前，视情况而定）100 条记录。

快速。在任何给定时间，内存中都有固定数量 (100) 的记录，数据源根据需要向表视图提供数据。你可以变得更漂亮，但这是一般的想法。

至于搜索，假设您正在对标题进行自由文本搜索，只需让数据库中介发出类似的问题

```
 'select id, title, description from yourTable where title like ?' 
```

并绑定？无论用户键入什么，在适当的地方使用通配符（不要忘记清理您的输入......并不是说任何人都极有可能在您的 iPhone 应用程序上执行 SQL 注入，但是，习惯和所有...... :)

显然，如果您只是搜索而不是过滤结果，您将不得不稍微调整一下，但希望这是一个开始。

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T00:06:23.383

我会重新考虑您的应用程序的架构。

您必须记住，iPhone 与桌面应用程序不同，人们使用手机的方式不像普通电脑那样使用。iPhone一次使用几分钟，而不是几小时。没有人会想要滚动浏览 20,000 多个条目。老实说，我不确定是否有人愿意在桌面应用程序中这样做。

相反，加载有限数量的条目，可能是 100 或 200 个顶部。然后让用户加载更多（或搜索他们需要的内容）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T22:24:45.147

您应该尝试为您的表使用委托，并且仅按需将项目加载到内存中。如果只显示前十项，则操作系统只会要求您提供这些。

您还应该考虑将记录存储在 SQLite 数据库中。当搜索处于活动状态时，委托将对使用当前搜索词构建的 SQL 查询进行操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T22:35:31.040

在当前屏幕之前/之后搜索并保留在内存中 50-200 左右可能是个好主意，这样您就可以在从数据库加载更多项目时滚动项目。

编辑; 如上所述，SQL lite 也是一个好主意。

# ruby-on-rails - 在模型中使用助手：如何包含助手依赖项？

> ID：489641
> 
> 赞同：110
> 
> 时间：2009-01-28T22:13:12.613
> 
> 标签：ruby-on-rails, ruby, activerecord, model

我正在编写一个模型来处理来自文本区域的用户输入。根据[http://blog.caboo.se/articles/2008/8/25/sanitize-your-users-html-input](http://web.archive.org/web/20090416200046/http://blog.caboo.se/articles/2008/8/25/sanitize-your-users-html-input)的建议，我在保存到数据库之前清理模型中的输入，使用 before_validate打回来。

我的模型的相关部分如下所示：

```
include ActionView::Helpers::SanitizeHelper

class Post < ActiveRecord::Base {
  before_validation :clean_input

  ...

  protected

  def clean_input
    self.input = sanitize(self.input, :tags => %w(b i u))
  end
end 
```

不用说，这是行不通的。尝试保存新帖子时出现以下错误。

```
undefined method `white_list_sanitizer' for #<Class:0xdeadbeef> 
```

显然，SanitizeHelper 创建了一个 HTML::WhiteListSanitizer 实例，但是当我将它混合到我的模型中时，它找不到 HTML::WhiteListSanitizer。为什么？我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2009-01-28T23:39:48.287

只需将第一行更改如下：

```
include ActionView::Helpers 
```

这将使它工作。

**更新：**对于 Rails 3 使用：

```
ActionController::Base.helpers.sanitize(str) 
```

归功于lornc[的回答](https://stackoverflow.com/a/7593347/59168)

* * *

## 回答 #2

> 赞同：137
> 
> 时间：2011-09-29T06:31:58.613

这为您提供了一个辅助方法，而没有将每个 ActionView::Helpers 方法加载到您的模型中的副作用：

```
ActionController::Base.helpers.sanitize(str) 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2014-07-16T15:57:32.410

这对我来说效果更好：

**简单的：**

```
ApplicationController.helpers.my_helper_method 
```

**进步：**

```
class HelperProxy < ActionView::Base
  include ApplicationController.master_helper_module

  def current_user
    #let helpers act like we're a guest
    nil
  end       

  def self.instance
    @instance ||= new
  end
end 
```

资料来源： http: [//makandracards.com/makandra/1307-how-to-use-helper-methods-inside-a-model](http://makandracards.com/makandra/1307-how-to-use-helper-methods-inside-a-model)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2013-02-04T08:09:48.783

要从您自己的控制器访问助手，只需使用：

```
OrdersController.helpers.order_number(@order) 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2016-08-12T05:36:58.117

如果要使用`my_helper_method`内部模型，可以编写：

```
ApplicationController.helpers.my_helper_method 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-10-03T09:04:17.413

我不会推荐任何这些方法。相反，将其放在自己的命名空间中。

```
class Post < ActiveRecord::Base
  def clean_input
    self.input = Helpers.sanitize(self.input, :tags => %w(b i u))
  end

  module Helpers
    extend ActionView::Helpers::SanitizeHelper
  end
end 
```

# sql-server - 实值排序是否不同于 SQL Server 查询中的浮点数？

> ID：489660
> 
> 赞同：1
> 
> 时间：2009-01-28T22:17:03.650
> 
> 标签：sql-server

谁能想到这样做的理由：

SELECT * FROM TableA ORDER BY cast(cast(RealColumnA as nvarchar(50))as float) --其中 RealColumnA 在表中定义为实数

我的一位前开发人员坚持认为这是正确分类真实数据所必需的。谁能想到一个可能是真的原因？

orderby 子句中的演员表是一个很大的性能杀手。但我需要确保在删除它之前没有必要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T22:18:52.430

去掉它。ORDER BY 是您所期望的。它肯定会成为性能杀手。

关于 SQL 的规则 #1。质疑（并测试）您（和其他人）的所有假设。（尤其是像这样奇怪的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T04:41:27.180

这是没有意义的。尤其是`CAST`右后卫。

我唯一能看到的是，如果您将非`float`信息存储在 a 中`float`并希望它按 asciibetally 排序。我想你可能想要这个：

```
1
10
11
12
2
3
4
5
6
7
8
9 
```

但通常当这种存储优化完成时（比如 SSN 或存储在 int 中的电话号码），左侧假定有隐式填充，这意味着任何预期的排序实际上与正常的数字排序相同。

# .net - .NET 程序集绑定方式/原因（1.1、2.0、GAC、策略文件等...）

> ID：489675
> 
> 赞同：4
> 
> 时间：2009-01-28T22:21:42.300
> 
> 标签：.net, binding, gac, policyfiles

我一直在解决一些 DLL 版本、策略文件和 GAC 中的项目的一些非常“奇怪”的问题，在我的一生中，我一直无法找到关于 . NET 框架在绑定项目引用时选择它执行的程序集。

首先介绍一下我们所拥有的历史，我们有两个库 DLL 文件，其中包含以下信息

```
ApplicationAssembly.dll - .NET 1.1 code - .dll Version 01.01.00.1234
ApplicationAssembly.dll - .NET 1.1 code - .dll Version 01.01.00.1244
ApplicationAssembly.dll - .NET 2.0 code - .dll Version 02.00.00.1111 
```

这些程序集中的每一个都加载到 GAC 中，并且 1.1 和 2.0 版本都有一个策略文件，指定要加载的最新版本。

我们有一个项目引用了 1.1.00.1234 版本的 ApplicationAssembly.dll 文件，但是，该项目已被移动，提示路径不再有效。但是，该引用并未失效，而是显示为 02.00.00.1111 版本，而不是预期的 1.1 版本的程序集。

这个过程是如何确定的，为什么马上跳到2.0框架？如果我们指定它是“特定版本”引用，即使使用不正确的提示路径，它也会找到正确的 DLL，但由于将来有破坏东西的风险，我们不能让该设置保持打开状态。

我想问题是*为什么会发生这种情况？* .NET 如何确定程序集的去向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T22:40:27.377

Fusion（.Net 中的托管 dll 加载功能）用于定位 dll 的规则非常广泛（由于 Gac/强名称/自定义加载挂钩等等）。

[官方规则在这里](http://msdn.microsoft.com/en-us/library/yx7xezcf.aspx)大体上处理 由于您的库名称很强大，因此将适用更复杂的规则

# visual-studio - 如何在 VS QuickWatch 窗口中输入 DateTime 值？

> ID：489682
> 
> 赞同：3
> 
> 时间：2009-01-28T22:24:33.870
> 
> 标签：visual-studio, debugging

我正在尝试在 QuickWatch 窗口中更改一些 DateTime 数据。我已经尝试了 2009 年 1 月 29 日等，但它们似乎都不起作用。它只是不断回到#12:00:00 AM#。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-28T22:39:16.507

DateTime 中的年/月/小时/等字段是不可变的。您无法在 QuickWatch 中更改它们。您只能通过重新分配来更改它。只需通过构造一个新值来更改值。换言之，在“值”部分输入“new DateTime(2009, 29, 1)”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T22:26:43.677

把它放在英镑符号 (#) 里面，比如...

```
#1/29/2009# 
```

# asp.net - 使用 HtmlTextWriter 呈现服务器控件？

> ID：489691
> 
> 赞同：5
> 
> 时间：2009-01-28T22:26:26.517
> 
> 标签：asp.net, stringbuilder, servercontrols, htmltextwriter, method-chaining

我正在编写`RenderContents()`我的 ASP.NET 服务器控件的方法。该方法使用`HtmlTextWriter`对象来呈现输出内容。对于我正在编写的控件，使用`HtmlTextWriter`'s 方法似乎需要很多代码行来打开和关闭每个标签并将每个属性添加到流中。最后，我觉得我最终会得到比它需要的更长的代码。

我在想，如果我使用一个可链接的类，例如`StringBuilder`，我的代码会更容易阅读和编写。

我想知道的是，是否有任何理由使用该`HtmlTextWriter`对象来呈现我的整个控件的内容？除了安全检查（我假设）之外，它还包括确保您不会以错误的顺序编写标签或创建无效标记，我看不出任何原因。

似乎只做这样的事情会更容易：

```
protected override void RenderContents(HtmlTextWriter output)
{
    StringBuilder s = new StringBuilder();
    s.Append("lots")
     .Append("of")
     .Append("strings");

    output.BeginRender();
    output.Write(s.ToString());
    output.EndRender();
} 
```

有什么理由说明这是一个坏主意吗？

**更新**
响应[Mehrdad Afshari](https://stackoverflow.com/questions/489691#489711)的回答：
我并没有过多考虑`StringBuilder`实例化单独对象的内存要求。为 HtmlTextWriter 制作一个包装器怎么样，这样它就可以被链接起来，这样就不会产生额外的字符串。

```
public class ChainedHtmlTextWriter
{
    private HtmlTextWriter _W;
    public ChainedHtmlTextWriter(HtmlTextWriter writer)
    {
        _W = writer;
    }

    public ChainedHtmlTextWriter Write<T>(T value) 
    { 
        _W.Write(value); 
        return this; 
    }

    public ChainedHtmlTextWriter WriteLine<T>(T value)
    {
        _W.WriteLine(value);
        return this;
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-28T22:44:07.230

我在开发一个应用程序，开发人员遵循您正在探索的可怕路径。这让人回想起您必须编写自己的 ISAPI dll 来输出 html 代码的日子。工作总是让人头疼。如果您的代码主要是字符串，那么就有问题了。

我更改的大多数这种类型的代码都会实例化服务器对象，根据需要配置它们的属性，然后将它们告诉 .RenderControl(writer)。这使代码更易于阅读和使用。如果这带来的开销对性能造成影响，我愿意接受（事实上，在我进行更改后，应用程序通常运行得更快，所以有趣的是，情况并非如此，但我没有分析我的代码）。

在字符串中硬编码您的内容的一个简单缺点是 HTML 标准发生变化时。我工作的代码是在 04/05 编写的，从那时起 <BR> 变成了 <br /> 并且大写的 html 标签不再是 kosher 了，等等。如果他们一直在使用服务器控件，那些服务器控件已经改变了他们的输出 html 而我们不需要做任何事情。这只是一个简单的例子。

编辑：哦，顺便说一句，BeginRender 和 EndRender 没有任何实现。它们是您在 HtmlTextWriter 派生类中覆盖和提供自定义功能的占位符。

*EDIT2：有时总是*使用服务器控件有点麻烦，比如容器和东西。我会做很多 .Controls.Add() ，然后再渲染容器。所以有时我会这样做：

```
writer.AddAttribute(HtmlTextWriterAttribute.Class, "myContainerClass");
writer.RenderBeginTag(HtmlTextWriterTag.Div);
// do some stuff, .RenderControl on some other controls, etc.
writer.RenderEndTag(); 
```

如前所述，即使 div 的 html 将来发生变化，这也会呈现正确的 html，因为我没有任何硬编码的字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T22:32:21.730

在性能方面，这将需要完成更多的字符串副本。`HtmlTextWriter`直接写入输出缓冲区。`StringBuilder`另一方面，有自己的缓冲区。当您调用`ToString`时`StringBuilder`，必须构建一个新字符串，然后将其写入输出缓冲区`output.Write`。它需要做更多的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T22:36:29.540

我认为您不应该调用 BeginRender/EndRender，这是由页面完成的。

我看不出使用字符串生成器如何节省使用 HtmlTextWriters 自己的方法的任何工作。

# perl - 如何将 Perl 脚本中的 stdout 和 stderr 输出重定向到 Windows 上的文件？

> ID：489699
> 
> 赞同：4
> 
> 时间：2009-01-28T22:29:54.310
> 
> 标签：perl, testing, selenium

我试过这个：

```
test1.pl >output.log 2>&1 
```

但这是结果：

```
Can't dup STDOUT:  Permission denied at C:/Perl/lib/Test/Builder.pm line 1376.
Compilation failed in require at C:/Perl/lib/Test/Builder/Module.pm line 3.
BEGIN failed--compilation aborted at C:/Perl/lib/Test/Builder/Module.pm line 3.
Compilation failed in require at C:/Perl/lib/Test/More.pm line 22.
BEGIN failed--compilation aborted at C:/Perl/lib/Test/More.pm line 22.
Compilation failed in require at C:/Perl/site/lib/Test/WWW/Selenium.pm line 72.
BEGIN failed--compilation aborted at C:/Perl/site/lib/Test/WWW/Selenium.pm line 72.
Compilation failed in require at C:\Software\selenium-remote-control-1.0-beta-2\tests\test1.pl line 5.
BEGIN failed--compilation aborted at C:\Software\selenium-remote-control-1.0-beta-2\tests\test1.pl line 5. 
```

只要我不尝试以任何方式从命令行重定向输出，脚本就会运行文件。

这是我的脚本，以防万一。（这是一个[Selenium](http://seleniumhq.org/)测试脚本）：

```
#!C:/perl/bin/perl.exe -w
use strict;
use warnings;
use Time::HiRes qw(sleep);
use Test::WWW::Selenium;
use Test::More "no_plan";
use Test::Exception;

my $sel = Test::WWW::Selenium->new( host => "localhost",
                                    port => 4444,
                                    browser => "*chrome",
                                    browser_url => "http://localhost/" );
print "Start Time: " . localtime() . "\n";
for (my $count = 3000; $count > 0; $count--)
{
    print $count . " tests remaining.\n";
    $sel->open_ok("/home");
    $sel->click_ok("link=News");
    $sel->wait_for_page_to_load_ok("30000");
    $sel->click_ok("video");
    $sel->wait_for_page_to_load_ok("30000");
    $sel->click_ok("link=Sports");
    $sel->wait_for_page_to_load_ok("30000");
    $sel->click_ok("link=Movies");
    $sel->wait_for_page_to_load_ok("30000");
    $sel->click_ok("moremovies");
    $sel->wait_for_page_to_load_ok("30000");
}

print "End Time: " . localtime() . "\n"; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-28T22:50:20.790

`Perl`for中的重定向存在一般问题`Windows`。

包中失败的行`Test::More`说：

```
open TESTOUT, ">&STDOUT" or die $!; 
```

当您调用命令时，这将失败`test.pl > outlog.log`，因为您要重定向`STDOUT`到的文件被 锁定`cmd.exe`，而不是被锁定`perl.exe`。你不能`dup()`从`perl.exe`

你需要运行：

```
perl test1.pl >output.log 2>&1 
```

反而。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:12:35.607

在我所有的测试脚本中，我总是配置测试报告和日志记录选项（而不是使用标准输出）。我也遇到了同样的重定向输出问题。您可以使用我上面列出的解决方案，或者您可以做我所做的：

```
my $res_file = "C:\\Automation\\Results\\Test_Logs\\login_test_output.txt"; 
my $err_file = "C:\\Automation\\Results\\Test_Logs\\login_error_output.txt";

open FH, ">$res_file" or die "couldn't open file: $!";

FH->autoflush(1); # Make FileHandle HOT. Set to 0 to turn autoflush off

Test::More->builder->output (*FH{IO}); # Redirect to test result file ($res_file)
Test::More->builder->failure_output ($err_file); # and test failure output file 
```

使用这种方法，我可以将我的 perl 脚本中的 stdout 和 stderr 输出重定向到 Windows 上的文件。

# java - 带有注释的 Spring MVC 验证

> ID：489703
> 
> 赞同：16
> 
> 时间：2009-01-28T22:30:49.970
> 
> 标签：java, spring, spring-mvc, validation

自从我将控制器从经典继承迁移到使用 @Controller 和 @RequestMapping 之类的注释后，我遇到了很多麻烦。问题是我不知道如何像旧案例那样插入验证。有没有关于这个的好教程？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-28T22:40:10.843

查看[Spring MVC 文档的 §13.11.x](http://static.springsource.org/spring/docs/2.5.x/reference/mvc.html#mvc-annotation)。它涵盖了基于注释的控制器配置，包括数据绑定。它应该对你很有用。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-06-26T16:22:01.520

Spring 3 包括改进的验证支持，特别是 JSR-303 验证。您可以使用 @Valid 注释和 . 看

[http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/validation.html#validation-beanvalidation](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/validation.html#validation-beanvalidation)

第 5.7 节。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-19T00:32:22.813

在紧要关头，总是有这样的东西：[http](http://annovalidator.sourceforge.net/) ://annovalidator.sourceforge.net/ - 它都是围绕使用注释进行验证的工具，旨在与 Spring 一起使用。

# open-source - 如何向你的老板解释开源？

> ID：489706
> 
> 赞同：19
> 
> 时间：2009-01-28T22:31:20.983
> 
> 标签：open-source, communication

我的老板过去对开源并不真正感兴趣。他总是很好，如果我们开发人员使用库或框架，那是免费的。但他从不对细节感兴趣。

但是一些客户谈到了开源，所以他明白了，这样的东西是存在的。最近他让我们吃惊，因为他想和我们谈谈开源和我们公司的开源战略。

因此，他向我们介绍了将来为我们的软件授权的系统。该系统包括注册下载，并且不允许任何人将代码提供给第三方，并且在未经我们许可的情况下实际上不允许任何人更改代码。所以我说这很好，但不是开源的，他对此有点不高兴。

问题是，他真的不知道开源是什么。你会如何向你的老板解释开源的概念？

编辑：我认为我的老板有一个真正的问题要理解，即一个**没有**公司强大领导力的开发人员社区。在我看来，他认为私人工作的人无法生产一些有用的软件。因此，他认为 Apache 网络服务器和 Linux 是 Sun 的产品。他看起来很困惑，因为我解释说我可以从 Apache 网络服务器获取代码，更改一些位并将这个更改后的网络服务器作为自己的产品发布（换句话说：创建一个分支）。

我敢肯定他并不是真的想发布开源，但他不明白它的想法，所以我想办法解释一下。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T22:37:25.293

[Eric S. Raymond的 The Magic Cauldron](http://www.catb.org/~esr/writings/magic-cauldron/magic-cauldron.txt)帮助我理解了贡献和/或启动开源项目的价值。它可以帮助你向他解释价值和决策变量。

**编辑：可以在**[这里](http://catb.org/~esr/writings/cathedral-bazaar/magic-cauldron/)找到实际的论文，而不仅仅是摘要。请尊重版权声明。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-28T22:38:29.783

试着把他们带到[大教堂和集市](http://catb.org/~esr/writings/cathedral-bazaar/)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-28T23:00:27.650

听起来您的老板正在为您的客户描述**源许可证**。这当然有价值，因为它可以让客户确信代码是高质量的。他们可以自己做代码检查、安全审计等。

它也可以替代将源代码放入**escrow**中。一些公司将其代码的副本存储起来，由第三方持有，以便在您的公司破产和消失的情况下，客户可以访问代码，以便他们可以在这种情况下接管维护。贵公司与客户之间的协议应包括此条款。如果您向客户授予源许可证，则可以取消第三方托管服务。您只需在协议中包含如果您的公司消失，客户将拥有使用和修改您的代码的非独占许可。

开源是不同的，因为**每个人**都有一个非排他的许可来使用和修改你的代码，只要你发布它。在此期间，您的公司将继续保持健康。用户当然必须遵守许可条款，这可能会增加使用条件。例如，GPL 规定客户的任何修改也必须在兼容许可下提供。另一方面，BSD 不需要这个。

开源并不*一定*意味着**免费**。您可以对代码收费，即使它仍然是开源的。甚至 GPL 也允许这样做。但这是一个合理的问题，如果代码是开源的，你如何控制或执行许可证？

最好的解决方案是您的业务价值基于**服务**或**访问**，而不是简单的代码。也就是说，如果客户付费订阅新闻提要，为什么不让显示新闻的软件开源呢？在那个行业，也许你甚至希望软件免费广泛分发，因为它会吸引更多人订阅你的服务。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-29T00:06:56.253

我认为您的老板可能在不了解目标的情况下患有流行语综合症（“取悦客户”除外）。

我认为你应该做的不是试图解释开源，而是和他谈谈他的商业策略（假设他可以控制它并且你是一个小商店）。

如果您的商业模式依赖于销售能够为您带来竞争优势并且从未与客户共享的专有代码，那么就没有理由去开源。

如果您正在开发的内容对其他人有益，并且您的企业可以通过提供与代码相关的服务来获得收入，或者如果其他人可以更改或扩展该产品可能会更成功，那么开源可能是相关的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T22:37:03.470

> 问题是，他真的不知道开源是什么。你会如何向你的老板解释开源的概念？

我们发布软件，以便每个用户都可以深入了解，自己修复问题并向我们发布解决方案——免费。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-01T17:08:39.147

告诉他这是一个社会主义理念，有助于削弱“男人”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T22:37:13.000

让他阅读关于开源的 wiki 页面：[http ://en.wikipedia.org/wiki/Open_source_software](http://en.wikipedia.org/wiki/Open_source_software)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-28T22:45:11.050

第三方访问是开源的主要目的之一。其余的区别涉及用户通知、原作者信用、可售性以及一些我确信我已经忘记的更精细的点。;)

有一些许可证限制了可以进行编辑的人员和方式——尤其是研究许可证，它允许查看和研究源代码，但不能更改。

但是，无论如何，限制第 3 方访问违反了开源的定义——公开可用的源代码。

* * *

或者，您可以查看[**Shared Source**](http://en.wikipedia.org/wiki/Shared_source)，而不是（听起来更像您的老板想要的）。

它仍然涉及第 3 方访问，但这更多地允许拒绝未注册的访问。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-18T12:25:41.940

[在这里你可以找到一本很好的电子书](http://producingoss.com/)，它解释了开源是如何工作的。

它帮助我理解为什么要花时间/工作以及他们如何为这些项目提供资金。

# ftp - SSH 自动 ftp 上传

> ID：489714
> 
> 赞同：1
> 
> 时间：2009-01-28T22:33:15.957
> 
> 标签：ftp, ssh

我有一个我在本地工作的网站，并由另一台服务器上的网络主机托管。如何使用 SSH 自动将本地文件推送到生产服务器？是否可以设置我不想上传的本地计算机上的文件列表，我可以让它只上传有更改的文件吗？

**编辑**：感谢您的回复，实际上我今天才开始使用 git，所以我必须研究一下。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T22:42:38.963

听起来[rsync](http://samba.anu.edu.au/rsync/)将是一个很好的工具供您使用。它可以通过 SSH 运行，并且可以找出发生了什么变化。您也可以告诉它忽略文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T22:55:56.957

正如[Rob Di Marco](https://stackoverflow.com/users/24195/rob-di-marco)提到的，[rsync](http://samba.anu.edu.au/rsync/)是复制文件的好方法。我最近切换到的另一个选项是为此目的使用[git ，它也适用于 ssh 并为我们提供版本控制。](http://git-scm.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T22:34:47.873

我会使用scp。

您可以编写一个简单的脚本来将您的上传文件暂存到某个目录（这样您就可以排除其他文件），然后以这种方式将它们推送到您的服务器。

[我使用 ssh 和 cvs。](http://cvs.ecoinformatics.org/HOWTO-cvs-over-ssh.html)（基本思想就在那里，忽略大学特定的东西）

我会定期检查我的代码，然后给它贴上标签。在网络服务器上，我查看了最新的标签。它使退出超级容易，更新也超级容易。

然后我再也不用担心我不想要的文件会到达那里，而且因为它是通过 SSH 调整的，所以它是完全安全的。

webserver 和 cvs 服务器都是真正简化事情的 linux 机器。

也看看[WinSCP](http://winscp.net)。

# .net - DLL (.Net) 中的 GUID

> ID：489715
> 
> 赞同：4
> 
> 时间：2009-01-28T22:33:42.540
> 
> 标签：.net, dll, guid

我在这方面不是很有经验 - 所以我有几个问题。首先，所有 .Net 创建的 DLL 都有自己的 GUID 吗？如果没有，我的问题是如何获得一个并将其与 DLL 关联。

那么问题是，我如何获得该 dll 的 GUID - 即。给定一个 DLL 路径 (c:\some\path\to\a\file.dll) 我如何确定它的 GUID？另外，有没有一种简单的方法可以走另一条路（GUID-> DLL）-我已经阅读了一些关于这个的内容，但其中很多是指 VB6 DLL 和 COM 的东西......这是否仍然适用于 .Net DLL ?

**更新：**感谢您的回答。也许我问错了问题。我希望我的每个 DLL 文件都有一个唯一的 ID，以便我可以在数据库中引用它们。我希望能够获取存储在数据库中的唯一 ID，然后轻松找到 DLL 并用它做一些事情。根据答案所说，也许我不应该使用 GUID，那么有没有.Net 方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T22:48:22.993

我认为您可能对托管程序集和 COM 组件感到困惑。COM 使用 GUID 以类 ID (CLSID) 和接口 ID (IID) 的形式标识组件和接口。该信息存储在注册表中，用于创建 COM 对象实例。.Net 不使用这种机制来识别程序集和类。类似的注册情况是程序集被[强命名](http://msdn.microsoft.com/en-us/library/wd40t7ad.aspx)并存储在[GAC](http://msdn.microsoft.com/en-us/library/yf1d93sz(VS.80).aspx)中。*在 .Net中*有几个地方使用 GUID - 包括 COM 互操作 - 但程序集标识不是其中之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T22:49:34.160

[assembly: Guid("...")] 属性通常在您的 AssemblyInfo.cs 文件中定义。默认情况下，当您创建一个新项目时，Visual Studio 会自动为您提供一个 Guid，但这仅在您要将程序集公开给 COM 时才真正有用。.NET Framework 本身不使用此值来确定如何加载程序集或以任何方式与其交互。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T22:38:40.580

作为 Visual Studio 用户，请查看定义了程序集 GUID 的 AssemblyInfo.cs `[assembly: Guid("abc...")]`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T22:46:30.253

我认为我们必须要问的问题是，为什么您认为您的程序集需要 GUID？除非它是 COM 可用的，否则您不会按 GUID 加载或注册 CLSID。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T22:52:58.100

要回答第二个问题（Guid -> 程序集），如果 dll 已经加载并且您只想找到哪个有 guid（如果有的话），这很简单，您可以简单地做

```
using System;
using System.Reflection;
using  System.Runtime.InteropServices;

static Assembly FindAssemblyForGuid(Guid match)
{
    foreach (var a in AppDomain.CurrentDomain.GetAssemblies())
    {
        object[]  attributes = a.GetCustomAttributes(typeof(GuidAttribute)) ;
        if ( attributes.Length > 0 ) 
        {
            foreach (GuidAttribute g in attributes )
            {
                if (g.Value == match)
                    return a;
            }
        }
    }
    return null; // failed to find it
} 
```

如果您想在不加载它**的情况下**执行此操作，则需要将其加载到临时应用程序域中，检查它，然后删除应用程序域或使用非托管自省 api 来做同样的事情，但之后不需要释放任何东西.

# python - Python 装饰器有哪些常见用途？

> ID：489720
> 
> 赞同：357
> 
> 时间：2009-01-28T22:35:02.693
> 
> 标签：python, decorator

虽然我喜欢认为自己是一个相当称职的 Python 编码器，但我从未能够理解的语言的一个方面是装饰器。

我知道它们是什么（表面上），我已经阅读了有关 Stack Overflow 的教程、示例和问题，并且我了解语法，可以自己编写，偶尔使用@classmethod 和@staticmethod，但我从未想过使用装饰器来解决我自己的 Python 代码中的问题。我从来没有遇到过这样的问题：“嗯……这看起来像是装饰师的工作！”

所以，我想知道你们是否可以提供一些你在自己的程序中使用装饰器的例子，希望我会“啊哈！” 时刻并*得到*它们。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-01-29T01:54:11.900

我使用装饰器主要是为了计时

```
def time_dec(func):

  def wrapper(*arg):
      t = time.clock()
      res = func(*arg)
      print func.func_name, time.clock()-t
      return res

  return wrapper

@time_dec
def myFunction(n):
    ... 
```

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2009-01-29T00:55:20.943

我用它们进行同步。

```
import functools

def synchronized(lock):
    """ Synchronization decorator """
    def wrap(f):
        @functools.wraps(f)
        def newFunction(*args, **kw):
            lock.acquire()
            try:
                return f(*args, **kw)
            finally:
                lock.release()
        return newFunction
    return wrap 
```

正如评论中指出的那样，从 Python 2.5 开始，您可以将[`with`](http://docs.python.org/2/reference/compound_stmts.html#with)语句与 [`threading.Lock`](http://docs.python.org/2/library/threading.html#threading.Lock)（或[`multiprocessing.Lock`](http://docs.python.org/2/library/multiprocessing.html#multiprocessing.Lock)自 2.6 版起）对象结合使用，以将装饰器的实现简化为：

```
import functools

def synchronized(lock):
    """ Synchronization decorator """
    def wrap(f):
        @functools.wraps(f)
        def newFunction(*args, **kw):
            with lock:
                return f(*args, **kw)
        return newFunction
    return wrap 
```

无论如何，您可以像这样使用它：

```
import threading
lock = threading.Lock()

@synchronized(lock)
def do_something():
  # etc

@synchronzied(lock)
def do_something_else():
  # etc 
```

基本上它只是将`lock.acquire()`/`lock.release()`放在函数调用的任一侧。

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2009-01-28T23:49:31.327

我使用装饰器进行类型检查参数，这些参数通过一些 RMI 传递给我的 Python 方法。因此，与其重复相同的参数计数，不如一次又一次地引发异常。

例如，而不是：

```
def myMethod(ID, name):
    if not (myIsType(ID, 'uint') and myIsType(name, 'utf8string')):
        raise BlaBlaException() ... 
```

我只是声明：

```
@accepts(uint, utf8string)
def myMethod(ID, name):
    ... 
```

并`accepts()`为我完成所有工作。

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2009-01-28T22:41:49.527

装饰器用于任何你想用附加功能透明地“包装”的东西。

Django 使用它们在视图函数上包装[“需要登录”功能](http://docs.djangoproject.com/en/dev/topics/auth/?from=olddocs#the-login-required-decorator)，以及[注册过滤器函数](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/#registering-custom-filters)。

您可以使用类装饰器[将命名日志添加到类](https://stackoverflow.com/questions/401277/naming-python-loggers#402471)。

任何可以“附加”到现有类或函数行为的足够通用的功能都是装饰的公平游戏。

[在PEP 318 - Decorators for Functions and Methods](http://www.python.org/dev/peps/pep-0318/#background)所指向的 Python-Dev 新闻组上也有[关于用例](http://mail.python.org/pipermail/python-dev/2004-April/044132.html)的讨论。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2009-01-29T00:06:36.457

对于鼻子测试，您可以编写一个装饰器，为单元测试函数或方法提供几组参数：

```
@parameters(
   (2, 4, 6),
   (5, 6, 11),
)
def test_add(a, b, expected):
    assert a + b == expected 
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-01-28T22:52:24.063

Twisted 库使用结合生成器的装饰器来产生异步函数是同步的错觉。例如：

```
@inlineCallbacks
def asyncf():
    doStuff()
    yield someAsynchronousCall()
    doStuff()
    yield someAsynchronousCall()
    doStuff() 
```

使用它，本来可以分解成大量小回调函数的代码可以很自然地写成一个块，从而更容易理解和维护。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2013-08-22T15:05:15.253

一个明显的用途是记录，当然：

```
import functools

def log(logger, level='info'):
    def log_decorator(fn):
        @functools.wraps(fn)
        def wrapper(*a, **kwa):
            getattr(logger, level)(fn.__name__)
            return fn(*a, **kwa)
        return wrapper
    return log_decorator

# later that day ...
@log(logging.getLogger('main'), level='warning')
def potentially_dangerous_function(times):
    for _ in xrange(times): rockets.get_rocket(NUCLEAR=True).fire() 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2009-01-28T22:38:14.653

我主要将它们用于调试（围绕打印其参数和结果的函数的包装）和验证（例如，检查参数的类型是否正确，或者在 Web 应用程序的情况下，用户是否有足够的权限来调用特定的方法）。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-28T23:40:01.983

装饰器用于定义函数的属性或作为改变它的样板；它们返回完全不同的功能是可能的，但违反直觉。看看这里的其他响应，似乎最常见的用途之一是限制其他一些进程的范围——无论是日志记录、分析、安全检查等。

CherryPy 使用对象分派来将 URL 与对象以及最终的方法相匹配。这些方法上的装饰器表明 CherryPy 是否被*允许*使用这些方法。例如，改编自[教程](http://www.cherrypy.org/wiki/CherryPyTutorial)：

```
class HelloWorld:

    ...

    def secret(self):
        return "You shouldn't be here."

    @cherrypy.expose
    def index(self):
        return "Hello world!"

cherrypy.quickstart(HelloWorld()) 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-01-29T07:15:27.183

我最近在开发社交网络 Web 应用程序时使用了它们。对于社区/组，我应该授予会员权限以创建新讨论并回复您必须成为该特定组成员的消息。所以，我写了一个装饰器`@membership_required`，并把它放在我认为需要的地方。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-10-26T07:29:50.157

我正在使用以下装饰器来使函数线程安全。它使代码更具可读性。它与 John Fouhy 提出的几乎相似，但不同之处在于它只处理单个函数，并且不需要显式创建锁定对象。

```
def threadsafe_function(fn):
    """decorator making sure that the decorated function is thread safe"""
    lock = threading.Lock()
    def new(*args, **kwargs):
        lock.acquire()
        try:
            r = fn(*args, **kwargs)
        except Exception as e:
            raise e
        finally:
            lock.release()
        return r
    return new

class X:
    var = 0

    @threadsafe_function     
    def inc_var(self):
        X.var += 1    
        return X.var 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-08-22T22:47:08.800

装饰器可用于轻松创建函数方法变量。

```
def static_var(varname, value):
    '''
    Decorator to create a static variable for the specified function
    @param varname: static variable name
    @param value: initial value for the variable
    '''
    def decorate(func):
        setattr(func, varname, value)
        return func
    return decorate

@static_var("count", 0)
def mainCallCount():
    mainCallCount.count += 1 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-08-10T09:46:09.233

我用这个装饰器来修复参数

```
def fill_it(arg):
    if isinstance(arg, int):
        return "wan" + str(arg)
    else:
        try:
            # number present as string
            if str(int(arg)) == arg:
                return "wan" + arg
            else:
                # This should never happened
                raise Exception("I dont know this " + arg)
                print "What arg?"
        except ValueError, e:
            return arg

def fill_wanname(func):
    def wrapper(arg):
        filled = fill_it(arg)
        return func(filled)
    return wrapper

@fill_wanname
def get_iface_of(wanname):
    global __iface_config__
    return __iface_config__[wanname]['iface'] 
```

这是当我重构一些函数需要传递参数“wanN”时写的，但在我的旧代码中，我只传递了 N 或 'N'

# jquery - jQuery UI 对话框验证不使用 标签

> ID：489722
> 
> 赞同：32
> 
> 时间：2009-01-28T22:35:12.693
> 
> 标签：jquery, validation, jquery-ui, jquery-plugins, jquery-validate

[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)看起来是最好的 jquery 验证插件。我似乎无法让它在 jQuery UI 对话框中工作。

此代码在对话框 DIV 之外工作：

```
<script type="text/javascript">
$(document).ready(function() {
     $("form").validate();
     $("a").bind("click", function() { alert($("form").valid()); });
});
</script>

<form method="get" action="">
   <p>
     Name
     <input id="name" name="name" class="required" minlength="2" />
   </p>
   <p>
     E-Mail
     <input id="cemail" name="email" size="25"  class="required email" />
   </p>
   <a href="#" id="clickTest">Click</a>
</form> 
```

这很好用。当我将表单移动到我的对话框 div 中时，打开对话框，然后单击它返回 true，no bueno 的链接。

有什么方法可以使用这个杀手 jquery 验证插件而不必使用`<form>`标签？或者有没有更好的方法来成功地做到这一点？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2010-01-26T19:48:38.820

万一其他人遇到这种情况，jQuery-UI 对话框不会附加到表单，它只是在之前附加`</body>`，因此要验证的元素在该`<form></form>`部分之外：

要解决此问题，只需在创建对话框时指示对话框在表单内移动，如下所示：

```
$("#mydiv").dialog("open").parent().appendTo(jQuery("form:first")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-14T17:23:01.310

您可以使用 [valitidy jquery 插件](http://validity.thatscaptaintoyou.com/Demos/index.htm)

javascript

```
function validateForm(){  
    $.validity.start();   
    // Required:  
    $("#recipientFirstName").require();  
    var result = $.validity.end();  
    return result.valid;  
}

$(document).ready(function() { 
    $('#dialog').dialog({
        autoOpen: false,   
        title: 'My title', 
        width: 600,  
        modal: true,  
        buttons: {  
            "Ok": function() {   
                if(validateForm()) {
                    saveOrder();
                    $(".validity-tooltip").css("display", "none"); 
                    $(this).dialog("close");  
                }
            },
            "Cancel": function() {
                // The following line was added to
                // hide the tool-tips programmatically:          
                $(".validity-tooltip").css("display", "none");
                $(this).dialog("close");       
            }
        }
   });
}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T22:52:50.397

试着给你的表单一个像“myform”这样的ID。

然后尝试将此调用添加到您的 clicktest 锚点的 onclick 事件中：

onclick='return($("#myform").validate().form());'

而不是在 document.ready 中进行验证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-12T15:31:59.220

Nick Craver 解决方案对我有用，但它并不完全适用于 IE7。

IE7 中有一个错误，它不尊重嵌套元素的 z-index；因此，如果您将对话框的父级移到表单中，则覆盖层将覆盖在对话框上，从而阻止用户与对话框进行交互。IE7 的修复方法是将叠加层的 z-index 设置为 -1，然后克隆叠加层元素并将其添加到表单中，就像您为对话框所做的那样。然后在对话框的关闭事件中，删除克隆的覆盖。 [IE7 Z-Index 分层问题](https://stackoverflow.com/questions/1287439/ie7-z-index-problem)

根据您的网站布局，您可能只需移动覆盖而不需要克隆它。我不得不克隆它，因为我的网站布局有左右边距，我需要覆盖来覆盖整个区域。下面是我所做的一个例子：

```
var $dialog = $('#myDialog');
var $form = $dialog.parents('form:first');

$dialog.dialog({
    autoOpen: false,
    title: 'My Dialog',
    minWidth: 450,
    minHeight: 200,
    modal: true,
    position: ['center', 'center'],
    close: function () {
        // IE7 BUG: Needed to add an additional overload because of the z-index bug in IE7.
        $('.ui-widget-overlay-ie7fix:first').remove();
    },
    buttons: dialogButtons
});

$form.prepend($dialog.parent());
$dialog.dialog('open');

if ($.browser.msie && $.browser.version.slice(0, 1) == "7") {
    var $overlay = $('body .ui-widget-overlay:first');
    $form.prepend($overlay.clone().addClass('ui-widget-overlay-ie7fix'));
    $overlay.css('z-index', '-1');
} 
```

谢谢，加里

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-01T14:50:09.097

这可能相关也可能不相关，但这是我的问题和解决方案：

我遇到了完全相同的问题，当我打开对话框时，我的“form”标签被替换为“div”标签。

这是因为我将对话框放在一个已经打开的表单元素中，（显然你不能在表单中拥有一个表单）

**不要做我所做的:)**

```
<form>
    <form>

    </form>
</form> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T22:45:12.547

您是否尝试过将表单包裹在您的 div 周围（根据 W3C 规范，表单标签不允许在 div 内。）

如果不重新编写插件，我看不出没有表单元素的简单原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T23:25:56.570

我决定使用[这个 jQuery 验证插件](http://plugins.jquery.com/project/Validation)并围绕现有代码编写我自己的插件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-25T17:35:55.377

我知道这个问题很老，但我也遇到了这个问题，所以我发布了我的解决方案。

如果您想保留 jQuery 验证插件（这似乎是最佳选择）并且不想像 Nick Craver 建议的那样移动对话框，您可以简单地将其添加到`<form>`标签中：

```
onsubmit="return false;" 
```

这将阻止表单被提交。如果在一些特殊情况下需要提交，在需要的时候改变这个返回值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-07-14T19:50:25.730

请参阅流行的 jQuery.validationEngine 的此补丁，以允许非表单标签作为验证目标。

[https://github.com/posabsolute/jQuery-Validation-Engine/pull/101](https://github.com/posabsolute/jQuery-Validation-Engine/pull/101)

如果您觉得这值得，请发表评论...截至目前作者不会拉补丁。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-02T08:59:27.043

我最近创建了一个用于 HTML 表单验证的插件。你可以自己试试。[Prashant-UI-验证器](http://prasant.com.np/Prashant-UI-Validator/)

使用 Jquery 构建，支持 Bootstrap，您可以按照自己的方式配置它。它支持不同的数据类型，如 INT、STRING、NUMERIC、MAX[Num]、MIN[Num]、EMAIL，最重要的是还支持您的自定义 javascript 验证代码。

希望能帮助到你，

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-01-28T03:23:36.170

我在使用 jQuery 1.11.2 和 jQueryValidate 1.13.1 的 asp.net 应用程序上使用它在 IE8 中工作：

```
$('#lnz_NuevoLink').click(function () {
        $("#lnz_AgregarDiv").dialog("open").parent().appendTo(jQuery("#aspnetForm"));   //Add the dialog to the form     
        $("#lnz_AgregarDiv").parent().attr('style', 'z-index: 101');                //To avoid the modal
        $("#lnz_AgregarDiv").dialog("option", "position", { my: "center", at: "center", of: window }); //To center the dialog
    }) 
```

# vb.net - 在 vb.net 中的 json.net 3.5b2 中从客户端反序列化 json

> ID：489723
> 
> 赞同：4
> 
> 时间：2009-01-28T22:35:16.750
> 
> 标签：vb.net, jquery, json.net

我有一个我遇到的问题的测试用例，基本上我在服务器上创建了一个 json 对象并将其提供给在客户端调用的 AJAX。这很好用，但是，当我尝试将其发回并反序列化服务器端时，我得到以下异常：

> **没有为“System.String”类型定义无参数构造函数。**
> 
> System.MissingMethodException 在 System.Web.Script.Serialization.ObjectConverter.ConvertDictionaryToObject(IDictionary `2 dictionary, Type type, JavaScriptSerializer serializer, Boolean throwOnError, Object& convertedObject) at system.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeInternal(Object o, Type type, JavaScriptSerializer serializer, Boolean throwOnError, Object& convertedObject) at system.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeMain(Object o, Type type, JavaScriptSerializer serializer, Boolean throwOnError, Object& convertedObject) at System.Web.Script.Serialization.ObjectConverter.ConvertObjectToType(Object o, Type type, JavaScriptSerializer serializer) at System.Web.Script.Services.WebServiceMethodData.StrongTypeParameters(IDictionary`2 rawParams) 在 System.Web.Script.Services.WebServiceMethodData.CallMethodFromRawParams(Object target, IDictionary `2 parameters) at System.Web.Script.Services.RestHandler.InvokeMethod(HttpContext context, WebServiceMethodData methodData, IDictionary`2 rawParams) 在 System.Web.Script.Services.RestHandler .ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)

**默认.aspx**

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="Default.aspx.vb" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
    <script src="http://www.json.org/json2.js" type="text/javascript"></script>
    <script src="http://code.jquery.com/jquery-latest.pack.js" type="text/javascript" ></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $.theDate = {};
            $("#Button1").click(function(){
                $.ajax({
                    type: 'POST',
                    url: 'default.aspx/getDate',
                    data: '{}',
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function(json){
                        var date = eval("("+json.d+")");
                        $.theDate = date;
                        var pdate = eval("("+json.d.replace(/"\\\/Date\(([0-9]+)[0-9-]+\)\\\/"/gi, 'new Date(parseInt($1,10))')+")");
                        $("#now").val(date.now);
                        $("#pnow").val(pdate.now);
                        $("#strnow").val(date.strnow);
                    },
                    error: function(xmlhr, status, err){
                        console.error(arguments);
                        var response = eval("("+xmlhr.responseText+")");
                        console.log(response);
                    }
                });
            });

            $("#Button2").click(function(){
                var json = JSON.stringify($.theDate);
                json = '{"json":'+json+'}';
                $.ajax({
                    type:'POST',
                    url:'default.aspx/deserialize',
                    data: json,
                    contentType:'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function(json){
                        var date = eval("("+json.d+")");
                        console.log(date);
                    },
                    error: function(xmlhr, status, err){
                        console.error(arguments);
                        var response = eval("("+xmlhr.responseText+")");
                        console.log(response);
                    }
                });
            });
        });
    </script>

</head>
<body>
    <form id="form1" runat="server">
    <div>
        <input id="Button1" type="button" value="Get Date" /><br />
        date.now: <input type="text" id="now" value="" style="width:20em" /><br />
        date.now processed: <input type="text" id="pnow" value="" style="width:30em"><br />
        date.strnow: <input type="text" id="strnow" value=""  style="width:20em"/>
        <input id="Button2" type="button" value="Send Date" /><br />
    </div>
    </form>
</body>
</html> 
```

**默认.aspx.vb**

```
Imports System.Web.Services
Imports Newtonsoft.Json

Partial Class _Default
    Inherits System.Web.UI.Page

    Private Class _date
        <JsonProperty()> Public now As New Date
        <JsonProperty()> Public strnow As String
        Public Sub New()
            now = Date.Today
            strnow = Date.Today.ToLongDateString
        End Sub
    End Class

    <WebMethod()> Public Shared Function getDate() As String
        Dim theDate As New _date
        Dim strJson As String

        strJson = JsonConvert.SerializeObject(theDate)

        Return strJson
    End Function

    <WebMethod()> Public Shared Function deserialize(ByVal json As String) As String
        Dim newDate As _date
        Try
            newDate = JsonConvert.DeserializeObject(json, GetType(_date))
            Return "{""done"":true}"
        Catch ex As Exception
            Throw ex
        End Try
    End Function
End Class 
```

对于我在这里做错的事情，我将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T16:33:16.223

不得不改变

```
Private Class _date 
```

到

```
Public Class _date 
```

和

```
<WebMethod()> Public Shared Function deserialize(ByVal json As String) As String 
```

到

```
<WebMethod()> Public Shared Function deserialize(ByVal json As _date) As String 
```

# c# - C# 中的 Javascript 和用户控件

> ID：489739
> 
> 赞同：0
> 
> 时间：2009-01-28T22:38:55.430
> 
> 标签：c#

我在用户控件的 ASCX 中有一些 JS 函数。此 UC 在主机页面中多次加载。当我查看源代码时，我看到 UC 的每个实例都重复了 JS。

有没有办法让它只加载一次功能？我想减小页面大小以获得更好的性能

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T22:41:58.933

将函数放在单独的 .js 文件中，然后通过调用 Page 添加它。[客户端脚本](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.aspx)。[RegisterClientScriptInclude](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerclientscriptinclude.aspx) ()。

您还可以将文件标记为嵌入式资源，然后使用 Page.ClientScript 将其包含在内。[注册客户端脚本资源](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerclientscriptresource.aspx)（）。

请注意，如果您使用的是 ScriptManager/UpdatePanels，请使用[ScriptManager](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.aspx)。[RegisterClientScriptInclude](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerclientscriptinclude.aspx)或 . [RegisterClientScriptResource](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerclientscriptresource.aspx)以便它知道如何在部分回发中正确添加引用。

# c# - 列出 Exchange 2003 邮箱权限

> ID：489743
> 
> 赞同：0
> 
> 时间：2009-01-28T22:39:55.693
> 
> 标签：c#, permissions, exchange-server, rights

如何列出已分配给域用户邮箱的权限？

例如，在 AD 用户和计算机的“交换的高级”选项卡的“邮箱权限”部分中指定的帐户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T23:29:25.250

哟，这是很恶心的东西。由于没有 .NET 包装器（上次我检查过，那是在 1.1 发呆），您需要使用 CDOEXM 进行 COM 互操作。

下面是一些伪代码，我希望它能让你在我的 brutha 中抢先一步：

```
DirectoryEntry userDirectoryEntry; // you need to new this up
IExchangeMailbox exchangeMailbox = (IExchangeMailbox)userDirectoryEntry.NativeObject;
IADsSecurityDescriptor securityDescriptor = (IADsSecurityDescriptor) exchangeMailbox.MailboxRights;   
IADsAccessControlList acl = (IADsAccessControlList) securityDescriptor.DiscretionaryAcl;
// Iterate thru each ACE in the ACL
foreach ( IADsAccessControlEntry ace in acl)
{
     // in here, you'll have access to each "ace"
} 
```

# sql - 数据库部署：脚本或备份

> ID：489745
> 
> 赞同：7
> 
> 时间：2009-01-28T22:39:58.313
> 
> 标签：sql, sql-server, deployment

如果你有一个 DBA 负责在实时环境中部署数据库，你会选择给他什么？他可以恢复到现有数据库的数据库创建脚本或备份？有哪些优点/缺点？（我们使用的是 MSSQL2000 和 MSSQL2005）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T22:44:00.477

我更喜欢部署脚本，它们的侵入性要小得多。还原将覆盖整个数据库、数据和所有内容，这在您的生产环境中可能不是一个好主意。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T23:20:06.940

虽然我同意 John 关于使用数据库备份的第一个部署建议，但我更喜欢至少让脚本可供审查以允许检查编码标准、性能评估等的想法。

如果您希望对已经审查过的东西进行交钥匙，那么备份/恢复是第一次部署的完美选择，如果该数据库中存在已“暂存”的配置数据则更是如此。这有助于避免冗长或复杂的插入语句。

它的一个给定的版本超出了第一个将被编写脚本。在我们的环境中，我们需要发行说明来指定脚本的服务器、实例和路径。脚本应按数字顺序提供，按目标数据库分隔到文件夹中，并带有第二组回滚脚本。我们甚至要求每个脚本的顶部都有一个 USE 语句，这样我们就不必担心在主数据库中创建新对象！;)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T22:55:09.110

对于第**一次部署；数据库备份**......它就是这么快速和简单。

如果**数据库已经存在；它必须是一系列编号的脚本**。就我个人而言，我对我的脚本进行编号，并且只通过脚本进行数据库更改。这可以确保所有数据库都同步，或者可以很容易地同步。

有些人认为这是一种肛门......但我永远不会遇到生产部署问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T22:42:33.350

我不确定备份选项，但使用 db 创建脚本，dba 可以根据需要设置数据库（必须、权限等），然后只需使用脚本创建表等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T23:23:54.903

我更喜欢脚本，因为您可以将其放入存储库并进行跟踪。你也可以很容易地在远程服务器上运行它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T10:31:13.023

在源代码控制下使用脚本 - 一个可爱的附带好处是您可以为数据库中的每个对象建立可搜索的历史记录，并且它是人类可读的。备份是黑匣子——你不知道它们会对你的数据库做什么。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-30T15:45:31.467

一定要使用 SQL 脚本，因为它们可以受版本控制。最好使它们变小并有某种批次以已知顺序（增量）运行它们，以便在已经投入生产的数据库中轻松运行它们。

SQL 脚本的替代方法是使用迁移框架。您可以在源代码中以小步骤指定数据库更改。迁移框架的好处是不了解 SQL 的程序员可以简单地对数据库进行更改（但这并不会消除了解一些数据库基础知识的需要）。

它们非常明确地说明了如何在增量步骤中建立和拆除数据库。这使得在数据库系统或应用程序的不同版本中测试和重新创建错误变得更加容易。

我知道的一些迁移框架的例子是：

*   在构建脚本（例如 msbuild）中运行的 .NET 的[Migratordotnet 。](http://code.google.com/p/migratordotnet/)
*   [Ruby on Rails](http://guides.rubyonrails.org/migrations.html)使用通过 Rake 运行的迁移。

备份旨在实际备份数据库。随着数据库的增长，可移植性降低。所以程序员只需要数据的一个子集。出于安全原因，他们也应该处理测试数据而不是真实数据。手头有一些测试数据生成器是一个很好的做法，这样开发人员和测试人员可以通过他们的实现进行测试，而不会损坏生产中的数据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T22:41:12.743

数据库创建脚本更好——你可以随时打开记事本并修复它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-30T15:35:42.457

我会选择脚本——人类可读性、通过源代码控制的兼容性以及轻松处理数据库引擎升级的潜力使这成为我们组织的方式。

# .net - SQL CLR 中的 WCF 客户端

> ID：489748
> 
> 赞同：2
> 
> 时间：2009-01-28T22:40:10.967
> 
> 标签：.net, sql, wcf, sqlclr

我知道它不受支持，而且我知道这甚至不是一个非常好的主意。但是，我想在 SQL 表值函数中有一个 WCF 客户端。

我（似乎）注册了正确的程序集，但是在运行我的客户端时 - 我收到了 WCF 错误：

```
消息 6522，第 16 级，状态 1，第 1 行
System.ServiceModel.CommunicationObjectFaultedException：
 通信对象，System.ServiceModel.ChannelFactory`1[MyProxy.IMyService]，
 不能用于通信，因为它处于故障状态。

```

Sql Server 之外的测试似乎有效——我什至没有看到 WCF 客户端尝试建立 TCP 连接。

不确定这是 WCF 还是 SQL CLR 问题，因为我对这两者都是新手.....

编辑：我了解所需的 System.ServiceModel 及其无数程序集不在经过审查的 Sql CLR 列表中。然而，

> “仍然可以从您的托管存储过程、触发器、用户定义的函数、用户定义的类型和用户定义的聚合中调用不受支持的库。不受支持的库必须首先使用 CREATE ASSEMBLY 语句在 SQL Server 数据库中注册，在它可以在你的代码中使用之前。任何在服务器上注册和运行的不受支持的库都应该经过审查和测试，以确保安全性和可靠性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T23:27:37.533

本文可能会帮助您找出真正的潜在异常是什么，并了解它的致命程度：

> [http://jdconley.com/blog/archive/2007/08/22/wcfclientwrapper.aspx（archive.org](http://web.archive.org/web/20101230161606/http://www.jdconley.com/blog/archive/2007/08/22/wcfclientwrapper.aspx)副本）

正如[大卫正确所说](https://stackoverflow.com/questions/489748/wcf-client-inside-sql-clr#489850)，SQL CLR 支持有限的 .NET 程序集子集：

> [SQL 2005 支持的 .NET Framework 库](http://msdn.microsoft.com/en-us/library/ms403279(SQL.90).aspx)
> [SQL 2005 CLR 集成编程模型限制](http://msdn.microsoft.com/en-us/library/ms403273(SQL.90).aspx)
> 
> [SQL 2008 支持的 .NET Framework 库](http://msdn.microsoft.com/en-us/library/ms403279.aspx)
> [SQL 2008 CLR 集成编程模型限制](http://msdn.microsoft.com/en-us/library/ms403273.aspx)

`System.Web.Services`如果端点是 WSDL 服务，是否支持这样可以帮助您摆脱困境？或者，您始终可以使用 Web 服务作为您尝试与之交谈的任何非 Web 服务 WCF 端点的代理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T15:13:42.733

我不太明白，但[Kev 的指针](https://stackoverflow.com/questions/489748/wcf-client-inside-sql-clr/489881#489881)终于让我进入了工作状态。WCF 客户端包装器为您提供了*实际*的异常 - 而不是 CommunicationObjectFaultedException，VS2008 代理为您提供了（如何解决这个问题？）。

该异常是 FileLoadException，抱怨 System.ServiceModel：

> 主机存储中的程序集与 GAC 中的程序集具有不同的签名。（HRESULT 异常：0x80131050）有关详细信息，请参阅 Microsoft 知识库文章 949080。

当然，[KB 949080](http://support.microsoft.com/kb/949080)没有任何帮助，因为它仍然指的是 SQL 2005（顺便说一句，我注意到很多 SQL 2008 错误消息，并且仍然指的是 2005 - 你认为他们至少可以替换了错误消息中的文本）并在更新 .NET FX 后处理问题——这并没有发生。

不过，这确实让我想到了 32 位和 64 位的区别。我的 SQL 2008 服务器是 Server 2008 x64 上的 x64 - 因此，它同时具有 C:\Windows\Microsoft.NET\Framework 和 Framework64 文件夹。由于 SQL Server 是一个 64 位进程，并且我的程序集将在进程中托管 - 我从 Framework64 文件夹加载程序集，并从 Program Files 加载 System.IdentityModel 和 System.IdentityModel.Selectors，而不是 Program Files (x86)。

所以，我尝试了 x86 程序集 - 但尝试加载 System.Web 给出了相当神秘的错误：

> 程序集 'System.Web' 引用程序集 'system.web, version=2.0.0.0,culture=neutral, publickeytoken=b03f5f7f11d50a3a.'，当前数据库中不存在。

嗯，是的...我猜 System.Web 可能确实引用了 System.Web。事实证明，StackOverflow[已经有了](https://stackoverflow.com/questions/400099/deploying-wcf-client-assembly-in-sql2005/403837#40383)这个问题的答案。虽然没有多大意义，但看起来您需要加载 System.Web 的 Framework64 版本，以及其他所有内容的常规 Framework 版本。

不幸的是，尝试该解决方案让我返回了可怕的 WCF 捕获所有 CommunicationObjectFaultedException。对 WCF 和 IDisposable 的愚蠢感到恼火，我取消了 using 和 Dispose 调用，这样我就可以 - 你知道 - 实际上*看到*正确的异常：

```
var p = new MyServiceClient(new CustomBinding(b), new EndpointAddress(uri));
var result = p.Execute(); // Don't Dispose proxy or you'll lose the actual exception.

try {
   return result.Values;
} finally {
   if (p.State != CommunicationState.Closed) {
      if (p.State != CommunicationState.Faulted) {
         p.Close();
      } else {
         p.Abort();
      }
   }
} 
```

然后我又遇到了另一个 FileLoadException，这次是在 System.Runtime.Serialization 上，再次将我指向无用的 KB 949080。

考虑到这是 x64 的另一种怪异情况，我决定如果要加载 Framework 程序集，我可能还应该加载 Program Files (x86) System.IdentityModel 程序集。

而且 - 你知道什么......它确实有效。运行时的 IntPtr.Size 为 8 个字节......所以我被加载为 x64。将我的程序集标记为 x64（或 x86）将无法部署 - 它仅适用于 AnyCPU。在加载的程序集上运行 corflags 显示 x86 或 x64 版本的位数没有差异，所以我*真的*不知道问题是什么。但是，以下 CREATE ASSEMBLIES 有效：

```
create assembly [System.Web] 
from 'C:\Windows\Microsoft.NET\Framework64\v2.0.50727\System.Web.dll'
with permission_set = UNSAFE

create assembly [System.Messaging] 
from 'C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.Messaging.dll'
with permission_set = UNSAFE

create assembly [SMDiagnostics]
from 'C:\Windows\Microsoft.NET\Framework\v3.0\Windows Communication Foundation\SMDiagnostics.dll'
with permission_set = UNSAFE

CREATE ASSEMBLY [System.IdentityModel] 
from 'C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.0\System.IdentityModel.dll'
with permission_set = UNSAFE

CREATE ASSEMBLY [System.IdentityModel.Selectors] 
from 'C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.0\System.IdentityModel.Selectors.dll'
with permission_set = UNSAFE

CREATE ASSEMBLY [Microsoft.Transactions.Bridge] 
from 'C:\Windows\Microsoft.NET\Framework\v3.0\Windows Communication Foundation\Microsoft.Transactions.Bridge.dll'
with permission_set = UNSAFE 
```

然后将我的用户程序集部署为 AnyCPU。YMMV 可能在 x86 版本的 Sql Server 上。

男孩 - 我真的开始对这些东西的黄金时间还没有做好准备感到恼火。我几乎错过了 C 的简单日子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T23:14:07.043

至少在 SQL Server 2005 中，只有少数支持 SQL CLR 的程序集。我不相信 WCF 是其中之一。我进行了快速搜索，没有任何结果让我得出结论，2008 SQL CLR 发生了很大变化。

参考： http: [//support.microsoft.com/kb/922672](http://support.microsoft.com/kb/922672)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T09:06:26.163

我在尝试在 SQL CLR 中调用 WCF Web 服务时遇到了类似的问题。它从 .NET 加载了如此多的程序集，但我无法使其工作。

最终，我使用通用 WebClient 向 WCF 服务器发出 HTTP 请求，该服务器运行良好，并且需要将最少的程序集加载到 SQL Server 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T13:01:35.327

我对 System.Runtime.Serialization 程序集有同样的问题。在 x64 窗口上

解决方案是，在 c:\windows\assembly 目录中找到 System.Runtime.Serialization，将其复制到其他目录并运行 CREATE ASSEMBLY sql 命令。

最好的，

# sql - 如何将 SQLite 用于 Windows 窗体应用程序文件？

> ID：489764
> 
> 赞同：0
> 
> 时间：2009-01-28T22:45:01.767
> 
> 标签：sql, winforms, sqlite

我正在编写一个新的 Windows Forms 2.0 应用程序。这个应用程序将有一个数据文件。用户将能够打开数据文件，做一些工作并将其保存到磁盘。然后他就可以稍后打开它，继续工作。与 Microsoft Word 和 .doc 文件相同。

我想将 SQLite 用于数据文件。但是，我不希望立即将更改写入数据文件。我希望用户更改数据，但磁盘上的文件保持不变。**只有当用户单击“保存”时**，磁盘上的数据文件才会被更改。

在您看来，最好的方法是什么？

我是否应该将 SQLite DB 的内容加载到内存中，也许将其映射到对象，并在用户单击“保存”时写回它？

或者......有没有办法使用 SQL 命令（无对象）处理数据文件，但只将更改留在内存中，直到单击“保存”？

我有点困惑，我将不胜感激有关此最佳实践的任何想法。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T22:55:04.807

1) 在启动时，制作 Sqlite 文件的临时副本。这将是您的“工作文件”。

2) 针对工作文件运行所有 INSERTs/UPDATEs/DELETEs。当用户单击“保存”时，将工作文件复制到原始文件上。

3) 删除工作文件并转到步骤#1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T15:13:28.890

根据您的场景，您还可以将 SQL 包装在事务中（BEGIN TRANSACTION;），当用户单击保存时，提交事务；如果用户单击取消，则回滚事务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T22:49:42.570

当用户进入编辑表单时加载数据。如果他点击保存然后更新/插入。如果不是，那么只需关闭表单而不进行任何数据库操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T22:52:55.513

临时文件。

使用 XML 或其他一些易于解析的格式，将数据保存到磁盘上的临时文件中。当用户保存文件时，将该日期转储到您的数据库中。

如果机器死机或程序崩溃，这将为您提供保存用户点击保存功能以及一些冗余。

# generator - 正确计算 IPV6 校验和的 libnet

> ID：489774
> 
> 赞同：0
> 
> 时间：2009-01-28T22:49:02.680
> 
> 标签：generator, checksum, ipv6, packet, libnet

我最近开始使用 libnet 并使用它来生成 IPV6 数据包。我对编程很陌生，但是，我对这个库很满意。

我有一个问题。似乎 libnet 当前无法正确计算 IPV6 数据包的校验和。作为编程新手，我还没有能力解决这个问题（虽然我正在学习，所以有一天我可以）。

我很好奇，有没有人运行过可以正确执行此操作的库版本？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T20:06:50.443

什么校验和？在 IPv6 中，与 IPv4 不同，第 3 层标头中没有校验和......

# compiler-construction - Is Scalas/Haskells parser combinators sufficient?

> ID：489783
> 
> 赞同：8
> 
> 时间：2009-01-28T22:51:28.167
> 
> 标签：compiler-construction, scala, haskell, parsing, parser-combinators

I'm wondering if Scalas/Haskells parser combinators are sufficient for parsing a programming language. More specifically the language MiniJava. I'm currently reading compiller construction and jflex and java cup is quite painful to work with so I'm wondering if I could/should use parser combinators instead. The MiniJava syntax is very small. MiniJavas BNF: [http://www.cambridge.org/us/features/052182060X/grammar.html](http://www.cambridge.org/us/features/052182060X/grammar.html)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-29T02:06:58.570

I've never used Scala, but the existence of a definitive BNF makes this easy.

Trivially translated into Haskell's [Text.ParserCombinators.Parsec](http://legacy.cs.uu.nl/daan/parsec.html):

```
goal = do c <- mainClass
          cs <- many classDeclaration
          eof
          return $ c:cs
mainClass = do token "class"
               name <- identifier
               ... 
```

etc. The [PArrows](http://www.cs.helsinki.fi/u/ekarttun/PArrows/) translation is pretty trivial too. You'll probably find it easier to have a distinct lexing phase before the parser, but you can do without too.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-29T20:52:52.067

I'm using Scala's parser combinators to parse PL/SQL code, it works like a charm.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-29T08:50:27.850

At least Parsec has built-in lexer for Java-like languages:

```
lexer = makeTokenParser javaStyle 
```

You have to define the reserved words yourself.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-08T21:58:58.487

Scala's parser is a backtracking parser, so it can deal with pretty much any BNF or EBNF. It also means, though, that there are edge cases where input can be painfully slow to be read.

If the grammar can be changed into an [LL(1) grammar](http://en.wikipedia.org/wiki/LL_parser), you can use the ~! operator to keep backtracking to a minimum.

The grammar probably CAN be turned into LL(1), but, as written, it is not. See, for instance, that Expression and Statement have First/First conflicts (look this up at the end of the linked article).

Anyway, for an academic project, it is enough. For real life compiler stuff, you'll need faster parsers.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T23:07:31.397

[Programming in Scala](http://www.artima.com/shop/programming_in_scala) (p. 647) says:

> It [Scala's parser combinator framework] is much easier to understand and to adapt than a parser generator, and the difference in speed would often not matter in practice, unless you want to parse very large inputs.

As I would not classify source code as *very large input* (ideally), it should be sufficient.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T23:05:07.470

I haven't dealt with the Scala or Haskell parser combinator libraries, but it looks like the grammar should be fine.

# grails - 是否可以在没有整个 grails 的情况下使用 GSP（groovy 服务器页面）？

> ID：489785
> 
> 赞同：13
> 
> 时间：2009-01-28T22:52:23.517
> 
> 标签：grails, groovy, installation, gsp

我只想和 groovy 玩一点

我正在考虑开发我自己的小型 Web 框架，一个非常简单且易于管理的东西......

所以我想使用 GSP 页面，而不必安装整个 grails 的东西，以及它的所有依赖项和幕后框架......

任何人都可以向我提供有关下载内容、安装位置、如何配置 tomcat 等的详细说明...

* * *

到目前为止我发现的一些信息

> [Groovy Servlet](http://groovy.codehaus.org/Groovlets)
> 
> [GSP 标签参考](http://www.grails.org/GSP+Tag+Reference)

这非常接近我正在寻找的内容，但仍然不知道要下载什么，保存在哪里等等......

> [http://groovy.codehaus.org/GSP](http://groovy.codehaus.org/GSP)

看看这里是怎么说的……

> GSP 不作为独立模块进行维护。但它已被分叉并重新集成到 Grails 中。

?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-29T22:55:28.077

嗯，看起来并没有我想象的那么难

只需要复制 groovy-all-1.5.7.jar

来自 C:\java\groovy-1.5.7\embeddable

到 C:\java\Tomcat 6.0\lib

并将以下行添加到 C:\java\Tomcat 6.0\conf\web.xml

```
 <!-- Groovy mapping - sas 2009-01-29 -->
<servlet>
    <servlet-name>Groovy</servlet-name>
    <servlet-class>groovy.servlet.GroovyServlet</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>Groovy</servlet-name>
    <url-pattern>*.groovy</url-pattern>
</servlet-mapping>

<servlet>
    <servlet-name>GroovyTemplate</servlet-name>
    <servlet-class>groovy.servlet.TemplateServlet</servlet-class>    
</servlet>
<servlet-mapping>
    <servlet-name>GroovyTemplate</servlet-name>
    <url-pattern>*.gsp</url-pattern>
</servlet-mapping> 
```

它奏效了！！！

我什至没有下载grails安装程序...

真的有那么容易吗？？？

这里有一些链接

[http://noor.ojuba.org/2008/06/groovlets-setting-up/](http://noor.ojuba.org/2008/06/groovlets-setting-up/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T22:59:09.243

独立的 GSP 在当前的 Grails 路线图中。同时查看 GSP 模块项目页面：[https ://gsp.dev.java.net/](https://gsp.dev.java.net/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T14:00:46.563

这篇 JavaWorld 文章可能会有所帮助：

[用 Groovlets 减轻重量](http://www.javaworld.com/community/?q=node/2292)

> 并非所有 Web 应用程序都需要完整的堆栈框架（如 Grails、Rails、Spring MVC 等）。不要误会我的意思，前面提到的 hip 框架本身是轻量级的（而且启动起来非常强大）；但是，它们确实有相关的成本（尽管比手动滚动相同的功能要低得多）。例如，一些应用程序不需要数据存储（因此，Grails 的很大一部分——例如，Hibernate——不会被使用）。其他应用程序实际上并不需要强大的视图技术（例如，简单的服务不需要 JSP 或 GS​​P）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-08T03:28:41.640

请检查[Rabbtor](http://knowledgebase.rabbytes.com/display/rabbtordoc)。我们通过对 Grails 标记库的自定义，为 Spring MVC 应用程序提供了简单的 GSP 集成。支持最常见的标签库，但删除了一些依赖 Grails 的标签库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-08T01:19:08.780

我不确定 taglib 功能是否在 Groovlet 中。

# c# - 如何在 .NET 应用程序中使用自定义鼠标光标？

> ID：489791
> 
> 赞同：6
> 
> 时间：2009-01-28T22:53:00.363
> 
> 标签：c#, .net, mouse-cursor

好吧，正如标题所说，我怎样才能将图像或其他任何东西设置为鼠标光标。我知道您可以使用 Cursors 类中的内置图像，但我想知道是否有一种方法可以使用您自己的图像（最好没有 P/Invoke，但无论哪种方式都可以。）

编辑：我想我没有足够清楚地解释我想要什么。我没有任何 .cur 文件（它们容易创建吗？），我想知道是否有办法从磁盘（或任何地方）获取图像并将其用作光标。最后，我想做这样的事情：

```
myForm.Cursor = new Cursor(Image.FromFile("foo.jpg")); 
```

可能的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T23:00:24.310

最简单的是，您只需使用：

```
form.Cursor = new Cursor(path); 
```

但是有从其他来源（非托管指针、原始流或 resx）加载的重载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T23:27:58.950

如果您想了解有关如何创建自己的光标资源的更多信息，那么这里有一个很好的[教程](http://www.functionx.com/vcnet/resources/cursors.htm)。您应该创建光标文件并将其作为资源嵌入到可执行文件中 - 在 Visual Studio 中很容易。这比从单独的文件加载更整洁、更有效。然后，您可以使用带有资源名称的 Cursor 构造函数直接加载它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T22:58:20.337

首先将自定义光标添加到您的项目中，然后非常简单：

```
Cursor myCursor = new Cursor("custom.cur"); 
```

然后只需将其分配给您的控件

```
someControl.cursor = myCursor 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-07T18:30:43.417

除了上面提到的，你还可以这样做：

```
Mouse.OverrideCursor = Cursors.Arrow; 
```

光标可以是：AppStarting Arrow ArrowCD Cross Hand Help Pen UpArrow 或其他。

# ruby-on-rails - 是否可以将 ActiveScaffold 配置为在显示列表之前显示搜索表单？

> ID：489798
> 
> 赞同：1
> 
> 时间：2009-01-28T22:55:10.530
> 
> 标签：ruby-on-rails, configuration, activescaffold

当我让 ActiveScaffold 向我展示一个很长的列表（例如已售产品列表）时，它会运行数据库查询以获取第一页数据并显示它。如果列表有一些关系，则此查询可能需要一些时间来执行（超过一秒）。大多数时候，我对这个“未过滤”列表不感兴趣：我想做的第一件事就是点击“搜索”并过滤掉这个列表。

有什么方法可以告诉 ActiveScaffold在调用列表操作时***不要显示未过滤的列表？***我希望它简单地显示搜索表单，等待输入一些条件，然后才*显示*过滤列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T10:38:23.897

我通过在控制器中定义*conditions_for_collection方法找到了解决方案。*这是一种 hack，但它很简单（3 行）并且有效：

```
def conditions_for_collection
  params[:action]=="update_table" ? "" : "1=2"
end 
```

事情是这样的：当你请求列表时，控制器的*列表*方法被调用，由 ActiveScaffold 处理。ActiveScaffold 调用*conditions_for_collection*，由于操作是*列表*（不是*update_table*），所以上面的 conditions_for_collection 方法返回“1=2”，这当然会导致一个空列表。

用户可以单击“搜索”按钮，并启动搜索。这将调用*update_table*操作，ActiveScaffold 再次调用*conditions_for_collection*，这一次返回 "" （无过滤器），因此搜索整个列表。

它不是很漂亮，但它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T20:01:52.230

您可能需要覆盖该`#index`操作并提供您自己的模板。似乎没有任何方法可以告诉它不显示该列表。

像这样的东西：

```
active_scaffold :models do |config|
    config.actions.exclude :index
end 
```

然后，您必须实现自己的索引方法，该方法具有自己的模板等。交回 Active Scaffold 的搜索操作。我不知道你是怎么做到的，但是如果你查看原始页面的 HTML 源代码，你应该很清楚它链接到的搜索操作是什么。

# c# - c# 引用变量mem分配

> ID：489805
> 
> 赞同：5
> 
> 时间：2009-01-28T22:56:33.023
> 
> 标签：c#, memory, variables, reference

有谁知道创建引用类型变量时占用了多少内存？

字符串 s = "123";

's' 会占用多少内存作为参考，而不是指向它的数据？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-28T23:24:47.537

这按以下方式分解：

```
String s = "123"; 
```

变量 s：这将消耗当前架构上的本机指针大小（如果操作系统是 32 位或进程在 WoW64 下执行，则被认为是 32 位），因此相应地是 32 位或 64 位。在这种情况下， s 要么在堆栈上，要么已注册。如果您将字符串引用放入数组中，那么该空间将在堆上消耗。

字符串是一个对象的事实：8 个字节的开销将 4 个字节用于方法表，这兼作指示对象的实际类型加上 4 个字节用于一些内务处理位和允许将其用作同步块的同步块锁定语句的目标。

字符串总是由空字符终止（尽管这是一个实现细节，不是运行时合同的一部分），因此它可以直接与 C 样式字符串 API 一起使用，字符是 UTF-16，因此每个字符两个字节感觉 .Net 使用字符（为什么的细节很复杂，需要转入 Unicode，我将省略）。

字符串进一步包含以下内容：

### .Net 4.0 之前的版本

*   以字符为单位的字符串长度的 int
*   用于保存字符的基础数组长度的 int
*   一个字符，它是字符串中的第一个字符（后续字符直接在它之后）或空字符串的空字符

由于 StringBuilder 的工作方式，该字符串**可能会**消耗高达实际保存所需字符数组所需的内存量的两倍

因此，字符串本身将在堆上消耗 16 + (2*n) + 2 和 16 + (4*n) + 2 个字节，具体取决于它的创建方式。

### 从 4.0 开始的 .Net 版本

*   以字符为单位的字符串长度的 int
*   一个字符，它是字符串中的第一个字符（后续字符直接在它之后）或空字符串的空字符

字符串本身将在堆上消耗至少 12 + (2*n) + 2 个字节。

* * *

请注意，在这两种情况下，根据运行时强制执行的对齐方式，字符串可能占用的实际空间略多于它使用的空间，这可能不会超过 IntPtr.Size。

这可能会因字符串实习而变得更加复杂（其中两个单独的实例最终指向同一个字符串，因为它是不可变的），因为理论上您应该将堆开销（加上实习开销）除以对细绳。

有关此问题的更多讨论，请查看[这篇文章](http://www.codeproject.com/KB/dotnet/strings.aspx)。但是请注意，这篇文章对于 4.0 中的更改已经过时。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-28T23:03:01.030

引用本身的大小取决于您的处理器架构——32 位为 4 字节，64 位为 8 字节。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T23:02:53.387

根据您使用的是 32 位还是 64 位机器，它将是 32 位或 64 位指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T23:02:57.643

通常需要 4 个字节作为参考

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T23:15:14.953

如果您想在代码中检查这一点，请致电：

```
IntPtr.Size 
```

# python - 使用 Python 2.6 连接到 MySQL...如何？

> ID：489807
> 
> 赞同：1
> 
> 时间：2009-01-28T22:57:04.163
> 
> 标签：python, mysql

我所有的搜索，包括Stack 上的[这个问题](https://stackoverflow.com/questions/372885/how-to-connect-to-a-mysql-database-from-python)，都指向 MySQLdb。不幸的是 MySQLdb 没有 Python 2.6 的版本。

我是什么做的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T23:01:13.950

你试过为 Python 2.6 编译它吗？API 在次要版本中变化很小，因此很可能是 Just Work (TM)。

编辑：根据[这篇文章](http://mail.python.org/pipermail/python-list/2008-November/516315.html)，它确实有效，并且张贴者提到已经发布了 Windows 二进制文件。

# flash - 旋转 AS3 动态创建的对象

> ID：489808
> 
> 赞同：1
> 
> 时间：2009-01-28T22:57:10.433
> 
> 标签：flash, actionscript-3, rotation

我正在构建一个需要使用均衡器播放音频文件的站点。我对 AS3 还不太了解，所以这可能是一个简单的问题。

我找到了一个我想在此处使用[演示](http://www.everydayflash.com/blog/index.php/2008/03/26/classic-sound-equalizer-in-flashas3/)的示例和此处的[源文件](http://www.everydayflash.com/flash/equalizer/as3equalizer.zip)

将均衡器对象添加到舞台的代码（来自教程）

```
package {
    import flash.media.*;
    import flash.net.*;
    import flash.display.*;
    import flash.events.*;

    import com.everydayflash.equalizer.*;
    import com.everydayflash.equalizer.color.*;

    public class Main extends Sprite{
        public function Main() {
            var s:Sound = new Sound(new URLRequest("track.mp3"));
            s.play(0, 100, new SoundTransform(1, 0));

            var es:EqualizerSettings = new EqualizerSettings();
            es.numOfBars = 32;
            es.height = 64;
            es.barSize = 2;
            es.vgrid = true;
            es.hgrid = 2;
            es.colorManager = new SolidBarColor(0xffff4444);
            es.effect = EqualizerSettings.FX_REFLECTION;

            var e:Equalizer = new Equalizer();
            e.update(es);
            e.x = 100;
            e.y = 100;
            addChild(e);

            addEventListener(Event.ENTER_FRAME, e.render);
        }
    }
} 
```

这将创建一个具有一些非常好的效果的垂直定向均衡器。

但是我希望它是水平的，所以我相信我需要将“e”旋转 90 度。你们中有人知道怎么做吗？或者方向是否完全由创建它的动作脚本决定？

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T23:08:10.693

就在行的正下方：

```
e.x = 100;
e.y = 100; 
```

尝试添加：

```
e.rotation = 90; 
```

我相信这应该可行，但是您可能会遇到枢轴点位置的一些问题（无论您是希望它围绕中心旋转 90 度，还是围绕左上角旋转）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T16:28:19.933

要记住的另一件事是[DisplayObject.transform](http://livedocs.adobe.com/flex/3/langref/flash/display/DisplayObject.html#transform) .matrix（Sprite 间接扩展了 DisplayObject）。如果需要，您可以使用[矩阵变换](http://livedocs.adobe.com/flex/3/html/help.html?content=15_Geometry_5.html)来进行更复杂的平移/旋转/缩放。

# c# - 单元测试 HttpContext.Current.Cache 或 C# 中的其他服务器端方法？

> ID：489819
> 
> 赞同：33
> 
> 时间：2009-01-28T22:59:06.047
> 
> 标签：c#, unit-testing, nunit, mocking

为使用 class 的类创建单元测试[`HttpContext.Current.Cache`时](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.aspx)，使用 NUnit 时出现错误。该功能是基本的 - 检查一个项目是否在缓存中，如果没有，则创建它并将其放入：

```
if (HttpContext.Current.Cache["Some_Key"] == null) {
    myObject = new Object();
    HttpContext.Current.Cache.Insert("Some_Key", myObject);
}
else {
    myObject = HttpContext.Current.Cache.Get("Some_Key");
} 
```

从单元测试中调用它`NullReferenceException`时，遇到第一`Cache`行时它会失败。在 Java 中，我会使用[Cactus](http://jakarta.apache.org/cactus/index.html)来测试服务器端代码。有没有类似的工具可以用于 C# 代码？ [这个 SO question](https://stackoverflow.com/questions/244280/creating-a-system-web-cachcing-cache-object-in-a-unit-test)提到了模拟框架 - 这是我测试这些方法的唯一方法吗？是否有类似的工具可以为 C# 运行测试？

另外，我不检查是否`Cache`为空，因为我不想专门为单元测试编写代码，并假设它在服务器上运行时始终有效。这是有效的，还是我应该在缓存周围添加空检查？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-29T05:37:00.533

这样做的方法是避免直接使用 HttpContext 或其他类似的类，并用模拟代替它们。毕竟，您不是在尝试测试 HttpContext 是否正常运行（这是微软的工作），您只是在尝试测试方法是否在应该调用的时候被调用。

步骤（如果您只想了解该技术而无需挖掘大量博客）：

1.  创建一个接口，描述您要在缓存中使用的方法（可能是 GetItem、SetItem、ExpireItem 之类的东西）。称它为 ICache 或任何你喜欢的

2.  创建一个实现该接口的类，并将方法传递给真正的 HttpContext

3.  创建一个实现相同接口的类，就像一个模拟缓存一样。如果您关心保存对象，它可以使用字典或其他东西

4.  更改您的原始代码，使其根本不使用 HttpContext，而只使用 ICache。然后代码将需要获取 ICache 的实例 - 您可以在类构造函数中传递一个实例（这就是依赖注入的全部内容），或者将其粘贴在某个全局变量中。

5.  在您的生产应用程序中，将 ICache 设置为您真正的 HttpContext-Backed-Cache，并在您的单元测试中，将 ICache 设置为模拟缓存。

6.  利润！

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-05T08:06:03.560

我同意其他人的观点，即使用界面是最好的选择，但有时改变现有系统是不可行的。这是我刚刚从我的一个项目中混合在一起的一些代码，它们应该可以为您提供所需的结果。这与漂亮或出色的解决方案相去甚远，但如果您真的无法更改代码，那么它应该可以完成工作。

```
using System;
using System.IO;
using System.Reflection;
using System.Text;
using System.Threading;
using System.Web;
using NUnit.Framework;
using NUnit.Framework.SyntaxHelpers;

[TestFixture]
public class HttpContextCreation
{
    [Test]
    public void TestCache()
    {
        var context = CreateHttpContext("index.aspx", "http://tempuri.org/index.aspx", null);
        var result = RunInstanceMethod(Thread.CurrentThread, "GetIllogicalCallContext", new object[] { });
        SetPrivateInstanceFieldValue(result, "m_HostContext", context);

        Assert.That(HttpContext.Current.Cache["val"], Is.Null);

        HttpContext.Current.Cache["val"] = "testValue";
        Assert.That(HttpContext.Current.Cache["val"], Is.EqualTo("testValue"));
    }

    private static HttpContext CreateHttpContext(string fileName, string url, string queryString)
    {
        var sb = new StringBuilder();
        var sw = new StringWriter(sb);
        var hres = new HttpResponse(sw);
        var hreq = new HttpRequest(fileName, url, queryString);
        var httpc = new HttpContext(hreq, hres);
        return httpc;
    }

    private static object RunInstanceMethod(object source, string method, object[] objParams)
    {
        var flags = BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic;
        var type = source.GetType();
        var m = type.GetMethod(method, flags);
        if (m == null)
        {
            throw new ArgumentException(string.Format("There is no method '{0}' for type '{1}'.", method, type));
        }

        var objRet = m.Invoke(source, objParams);
        return objRet;
    }

    public static void SetPrivateInstanceFieldValue(object source, string memberName, object value)
    {
        var field = source.GetType().GetField(memberName, BindingFlags.GetField | BindingFlags.NonPublic | BindingFlags.Instance);
        if (field == null)
        {
            throw new ArgumentException(string.Format("Could not find the private instance field '{0}'", memberName));
        }

        field.SetValue(source, value);
    }
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-07-23T02:06:07.777

```
HttpContext.Current = new HttpContext(new HttpRequest(null, "http://tempuri.org", null), new HttpResponse(null)); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-29T02:43:07.123

如果您使用的是 .NET 3.5，则可以在应用程序中使用 System.Web.Abstractions。

Justin Etheredge 有一篇关于如何模拟 HttpContext（其中包含缓存类） 的精彩[文章。](http://www.codethinked.com/post/2008/12/04/Using-SystemWebAbstractions-in-Your-WebForms-Apps.aspx)

在 Justin 的示例中，我使用 HttpContextFactory.GetHttpContext 将 HttpContextBase 传递给我的控制器。在模拟它们时，我只是构建一个 Mock 来调用缓存对象。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-07-30T16:18:15.057

有一种更新的方法可以帮助在单元测试中专门处理缓存。

我建议使用 Microsoft 的新**MemoryCache.Default**方法。您将需要使用 .NET Framework 4.0 或更高版本并包含对 System.Runtime.Caching 的引用。

请参阅此处的文章-> [http://msdn.microsoft.com/en-us/library/dd997357(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/dd997357(v=vs.100).aspx)

MemoryCache.Default 适用于 Web 和非 Web 应用程序。所以想法是你更新你的 webapp 以删除对 HttpContext.Current.Cache 的引用并将它们替换为对 MemoryCache.Default 的引用。稍后，当您运行决定对这些相同的方法进行单元测试时，缓存对象仍然可用并且不会为空。（因为它不依赖于 HttpContext。）

这样，您甚至不必模拟缓存组件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-29T02:17:24.943

普遍的共识似乎是，在单元测试中驱动任何与 HttpContext 相关的东西都是一场噩梦，如果可能的话应该避免。

我认为您在嘲笑方面走在正确的道路上。我喜欢 RhinoMocks ( [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx) )。

我也读过一些关于 MoQ 的好东西（[http://code.google.com/p/moq](http://code.google.com/p/moq)），虽然我还没有尝试过。

如果您真的想用 C# 编写可单元测试的 Web UI，人们似乎正在使用 MVC 框架 ( [http://www.asp.net/mvc](http://www.asp.net/mvc) ) 而不是 WebForms...

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-24T13:15:53.057

您可以在 System.Web.Abstractions.dll 中使用 HttpContextBase 类。这是 .NET 3.5 中的一个新 dll。

您可以在下面的链接中找到如何使用的示例。

[http://vkreynin.wordpress.com/2009/03/23/stub-htttpcontext/](http://vkreynin.wordpress.com/2009/03/23/stub-htttpcontext/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T12:39:58.727

这可能在你的街道上...... Phil Haack 在 Rhino 模拟的帮助下展示了如何在 asp mvc 中模拟 httpcontext，但我想可以应用于 webforms。

[咔嚓！！](http://haacked.com/archive/2007/11/05/rhino-mocks-extension-methods-mvc-crazy-delicious.aspx)

希望这可以帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-04-16T00:38:53.020

如果您不关心测试缓存，您可以执行以下操作：

```
[TestInitialize]
    public void TestInit()
    {
      HttpContext.Current = new HttpContext(new HttpRequest(null, "http://tempuri.org", null), new HttpResponse(null));
    } 
```

你也可以像下面一样起订量

```
var controllerContext = new Mock<ControllerContext>();
      controllerContext.SetupGet(p => p.HttpContext.Session["User"]).Returns(TestGetUser);
      controllerContext.SetupGet(p => p.HttpContext.Request.Url).Returns(new Uri("http://web1.ml.loc")); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T08:21:41.260

所有这些编程问题都需要基于接口的编程模型，在该模型中您实现了两次接口。一个用于真实代码，一个用于模型。

实例化是下一个问题。有几种设计模式可以用于此。例如，参见著名的 GangOfFour 创建模式 ( [GOF](http://en.wikipedia.org/wiki/Design_Patterns#Creational_patterns) ) 或依赖注入模式。

ASP.Net MVC 实际上就是使用这种基于接口的方法，因此更适合单元测试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-28T12:28:10.903

就像这里大家说的，HTTPContext有一个问题，目前[Typemock](http://www.typemock.com)是唯一可以直接伪造它的框架，不需要任何包装器或抽象。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-28T12:46:15.000

缓存对象很难模拟，因为它是 .NET 框架的一个封闭区域。我通常通过构建一个接受缓存管理器对象的缓存包装类来解决这个问题。为了测试，我使用了一个模拟缓存管理器；对于生产，我使用实际访问 HttpRuntime.Cache 的缓存管理器。

基本上，我自己抽象出缓存。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-09-26T11:41:33.910

使用 MVC 3 和 MOQ 的示例：

我的控制器方法有以下几行：

```
model.Initialize(HttpContext.Cache[Constants.C_CustomerTitleList] 
as Dictionary<int, string>); 
```

因此，任何单元测试都会失败，因为我没有设置 HttpContext.Cache。

在我的单元测试中，我安排如下：

```
 HttpRuntime.Cache[Constants.C_CustomerTitleList] = new Dictionary<int, string>();

 var mockRequest = new Mock<HttpRequestBase>();
 mockRequest.SetupGet(m => m.Url).Returns(new Uri("http://localhost"));

 var context = new Mock<HttpContextBase>(MockBehavior.Strict);
 context.SetupGet(x => x.Request).Returns(mockRequest.Object);
 context.SetupGet(x => x.Cache).Returns(HttpRuntime.Cache);

 var controllerContext = new Mock<ControllerContext>();
 controllerContext.SetupGet(x => x.HttpContext).Returns(context.Object);

 customerController.ControllerContext = controllerContext.Object; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-08-12T15:57:13.850

可以试试...

```
 Isolate.WhenCalled(() => HttpContext.Current).ReturnRecursiveFake();
 var fakeSession = HttpContext.Current.Session;
 Isolate.WhenCalled(() => fakeSession.SessionID).WillReturn("1"); 
```

# c# - 是否可以更改 Sql Workflow Persistence Service 表和存储过程名称？

> ID：489837
> 
> 赞同：0
> 
> 时间：2009-01-28T23:04:42.900
> 
> 标签：c#, .net, workflow, sqlworkflowpersistencese

我正在使用默认的 Sql Workflow Persistence Service 来管理我正在开发的应用程序中的工作流持久性。我使用 Microsoft 提供的脚本在 SQL 数据库中生成架构和逻辑。到目前为止，它工作得很好。但是，我想更改表和存储过程的名称以符合我选择的命名约定。

例如，Microsoft 提供的脚本生成了一个名为的存储过程`RetrieveNonblockingInstanceStateIds`，我想将其名称更改为`wf_RetrieveNonblockingInstanceStateIds`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T23:13:16.360

您可能可以创建自己的持久性服务，但就我个人而言，我会不理会它。

# javascript - 哪个 Javascript minifier (cruncher) 与 Google 用于其 JS API 的功能相同？

> ID：489847
> 
> 赞同：29
> 
> 时间：2009-01-28T23:12:07.003
> 
> 标签：javascript, obfuscation, minify

我是一名 Google Maps API (javascript) 开发人员。我注意到 Google 使用了具有以下功能的 Javascript 缩小器：

1.  缩短变量、属性、参数、类、函数和方法名称，混淆代码。（例如，函数 1 -> a，函数 2 -> b，函数 3 -> c）
2.  一些变量、类、属性和方法可以标记为不被处理，因此其名称与 API 手册中记录的名称保持一致。
3.  它会在 API 的每个子版本中重新运行，就像构建任务一样，我注意到由于经过处理的名称会从一个版本更改为另一个版本。

我还没有在整个互联网上找到具有这些功能的 Javascript 缩小器。有人知道吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-11-24T08:31:02.310

谷歌现在已经开放了他们使用的[缩小器](http://closure-compiler.appspot.com/home)以及其他一些内部 javascript 好东西。

这一切都在[“关闭工具”](http://code.google.com/closure/)的名称下，并于本月早些时候[宣布。](http://googlecode.blogspot.com/2009/11/introducing-closure-tools.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-28T23:31:40.690

以下是我所知道的缩小器： Dean Edwards' [packer](http://dean.edwards.name/packer/)；YUI[压缩机](http://developer.yahoo.com/yui/compressor/)；[JSMIN](http://crockford.com/javascript/jsmin) ; 和 Dojo[压缩器](http://dojotoolkit.org/docs/shrinksafe)

除了这些之外，[GWT 编译器](http://code.google.com/webtoolkit/overview.html)还做了很多工作以从 Java 文件中生成高效的 JavaScript 文件。如果这是他们使用的，我不会感到惊讶。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T23:31:32.970

我相信 YUICompressor 执行 #1，除了函数名称，并且 #2 使用在压缩过程中删除的特殊语法。

#3 只是一个构建任务，而不是压缩器的功能。

[YUI压缩机](http://www.julienlecomte.net/yuicompressor/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-07T00:17:23.853

YUI Compressor还有[一个 .NET 端口，](http://yuicompressor.codeplex.com/)可让您：-

*   将缩小/文件合并到 Visual Studio 构建后事件中
*   集成到 TFS 构建（包括 CI）
*   如果您只想在自己的代码中使用 dll（例如即时缩小）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T00:36:04.403

可以在 [http://netspurt.com找到基于 dojo 的收缩保险箱的简单在线 javascript 缩小器](http://netspurt.com)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-09-07T08:17:30.917

您所描述的是“混淆器”而不是缩小器，通过搜索“Javascript 混淆器”很容易找到它们。

我们的[SD Thicket ECMAScript 混淆](http://www.semanticdesigns.com/Products/Obfuscators/ECMAScriptObfuscator.html)器同时混淆和缩小。

# java - 将指针从java传递到native

> ID：489853
> 
> 赞同：4
> 
> 时间：2009-01-28T23:15:41.580
> 
> 标签：java, parameters, reference, java-native-interface

我正在制作一个 DLL 库的接口，所以我可以将它与 Java 一起使用。我需要我的本机函数来修改 jlong​​ 参数的值。就像参数是通过引用传递的。我的 Java 方法必须具有与此处显示的本机函数 MPUSBWrite 完全相同的参数。

实际无效代码示例： MPUSBWrite 获取其第 4 个参数作为参考并修改其值。当我读取 pLength 传递的变量时，我总是得到 0。

爪哇：

```
public static native boolean Write(long handle, byte[] pData, int dwLen, long pLength, int dwMilliseconds); 
```

本机 C++：

```
JNIEXPORT jboolean JNICALL Java_jPicUsb_iface_Write
(JNIEnv *env, jclass jc, jlong handle, jbyteArray pData, jint dwLen, jlong pLength, jint dwMilliseconds) {
    jniByteArray b(env, pData);
    DWORD res = MPUSBWrite((HANDLE)handle,b.getBytes(),dwLen,(PDWORD)pLength,dwMilliseconds);
    if (res) {
        return JNI_TRUE;
    } else {
        return JNI_FALSE;
    }
} 
```

有没有办法我的 C++ 代码通过引用修改 pLength 变量的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T08:39:40.720

[SWIG](http://www.swig.org/)支持此功能。

使用 SWIG，您可以更新 Java 参数值，例如 C++ 中的指针。这非常适用于对象参数。您可以放入一个 Long 对象以使其工作。

使用 Swig，您可以在 java 和 C++ 之间编写一个层，您可以将函数调用后的指针值放入 Java 对象中。Swig 还生成 Java 类，你必须要我们调用 C++ 函数。当 C++ 函数包含另一个 C++ 类作为参数时，Swig 会将此 C++ 类生成为带有 getter、setter 和您要调用的所有 C++ 函数的 Java 对象。

对于这个功能，Swig 有一种特殊的语言，你必须在 VisualStudio 项目中编写。但所有这些都在[Swig 手册中进行了描述](http://www.swig.org/Doc1.1/PDF/SWIGManual.pdf)

> SWIG 是一种软件开发工具，它将用 C 和 C++ 编写的程序与各种高级编程语言连接起来。SWIG 与不同类型的语言一起使用，包括常见的脚本语言，例如 Perl、PHP、Python、Tcl 和 Ruby。支持的语言列表还包括非脚本语言，例如 C#、Common Lisp（CLISP、Allegro CL、CFFI、UFFI）、Java、Lua、Modula-3、OCAML、Octave 和 R。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T23:20:46.127

不。

如果您确实需要这样做，最好的选择是将您的第四个参数定义为 long[]，并让您的 JNI 代码更新数组元素。

实际上，您最好的选择是考虑为什么不能从方法中返回 long 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T08:30:54.763

这不是 JNI 问题。该函数是按值调用的，没有办法修改它。传入一个对象或一个数组，这样你就可以拥有引用。

# objective-c - 将用户默认值绑定到不同的标识符

> ID：489856
> 
> 赞同：1
> 
> 时间：2009-01-28T23:18:44.477
> 
> 标签：objective-c, cocoa, binding, bundle, nsuserdefaults

我有一个首选项窗格包（它在系统首选项中运行）。我使用 Interface Builder 设计了界面，其中我将“自动启动”复选框绑定到 Shared User Defaults。这很好用，但它会将偏好写入 com.apple.systempreferences。我想将我的偏好保留在 com.example.mybundle 默认值中。我该怎么做呢？

我想我需要在 Interface Builder 中添加一个 User Defaults 控制器，但我如何告诉它与 com.example.mybundle 进行映射？

谢谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T23:59:41.850

你会想要绑定到一个 NSDictionaryController ，它的持久性是通过管理的`-[NSUserDefaults persistentDomainForName:]`，`-[NSUserDefaults setPersistentDomain:forName:]`尽管坦率地说它`+[NSDictionary dictionaryWithContentsOfFile:]`和`-[NSDictionary writeToFile:atomically:]`.

# python - 在 Python 中锁定文件

> ID：489861
> 
> 赞同：184
> 
> 时间：2009-01-28T23:20:03.990
> 
> 标签：python, file-locking

我需要锁定一个文件以便用 Python 编写。它将同时从多个 Python 进程访问。我在网上找到了一些解决方案，但大多数都因我的目的而失败，因为它们通常仅基于 Unix 或基于 Windows。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-01-31T08:30:04.733

好的，所以我最终使用了我在此处编写的代码~~[，在我的网站](http://www.evanfosmark.com/2009/01/cross-platform-file-locking-support-in-python/)~~^([链接已失效，请在 archive.org 上查看](https://web.archive.org/web/20140531203736/http://www.evanfosmark.com:80/2009/01/cross-platform-file-locking-support-in-python/))（[也可在 GitHub 上找到](https://github.com/dmfrey/FileLock)）。我可以通过以下方式使用它：

```
from filelock import FileLock

with FileLock("myfile.txt"):
    # work with the file as it is now locked
    print("Lock acquired.") 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-01-29T01:01:50.527

这里有一个跨平台的文件锁定模块：[Portalocker](https://pypi.python.org/pypi/portalocker)

尽管正如 Kevin 所说，一次从多个进程写入文件是您希望尽可能避免的事情。

如果您可以将问题硬塞到数据库中，则可以使用 SQLite。它支持并发访问并处理自己的锁定。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2017-09-25T14:12:14.093

其他解决方案引用了许多外部代码库。如果您更愿意自己动手​​，这里有一些跨平台解决方案的代码，该解决方案在 Linux / DOS 系统上使用相应的文件锁定工具。

```
try:
    # Posix based file locking (Linux, Ubuntu, MacOS, etc.)
    #   Only allows locking on writable files, might cause
    #   strange results for reading.
    import fcntl, os
    def lock_file(f):
        if f.writable(): fcntl.lockf(f, fcntl.LOCK_EX)
    def unlock_file(f):
        if f.writable(): fcntl.lockf(f, fcntl.LOCK_UN)
except ModuleNotFoundError:
    # Windows file locking
    import msvcrt, os
    def file_size(f):
        return os.path.getsize( os.path.realpath(f.name) )
    def lock_file(f):
        msvcrt.locking(f.fileno(), msvcrt.LK_RLCK, file_size(f))
    def unlock_file(f):
        msvcrt.locking(f.fileno(), msvcrt.LK_UNLCK, file_size(f))

# Class for ensuring that all file operations are atomic, treat
# initialization like a standard call to 'open' that happens to be atomic.
# This file opener *must* be used in a "with" block.
class AtomicOpen:
    # Open the file with arguments provided by user. Then acquire
    # a lock on that file object (WARNING: Advisory locking).
    def __init__(self, path, *args, **kwargs):
        # Open the file and acquire a lock on the file before operating
        self.file = open(path,*args, **kwargs)
        # Lock the opened file
        lock_file(self.file)

    # Return the opened file object (knowing a lock has been obtained).
    def __enter__(self, *args, **kwargs): return self.file

    # Unlock the file and close the file object.
    def __exit__(self, exc_type=None, exc_value=None, traceback=None):        
        # Flush to make sure all buffered contents are written to file.
        self.file.flush()
        os.fsync(self.file.fileno())
        # Release the lock on the file.
        unlock_file(self.file)
        self.file.close()
        # Handle exceptions that may have come up during execution, by
        # default any exceptions are raised to the user.
        if (exc_type != None): return False
        else:                  return True 
```

现在，`AtomicOpen`可以在`with`通常使用`open`语句的块中使用。

**警告：**

*   **如果在调用exit**之前在 Windows 上运行和 Python 崩溃，我不确定锁定行为会是什么。
*   这里提供的锁定是建议性的，不是绝对的。所有潜在的竞争进程都必须使用“AtomicOpen”类。
*   截至（2020 年 11 月 9 日），此代码仅锁定Posix 系统上的*可写*文件。在发布之后和此日期之前的某个时间点，使用`fcntl.lock`只读文件是非法的。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2015-12-06T23:09:02.353

我一直在寻找几种解决方案来做到这一点，我的选择是 [oslo.concurrency](http://docs.openstack.org/developer/oslo.concurrency/)

它功能强大且文档相对完善。它基于紧固件。

其他解决方案：

*   [Portalocker](https://pypi.python.org/pypi/portalocker)：需要 pywin32，这是一个 exe 安装，所以不能通过 pip
*   [紧固件](https://pypi.python.org/pypi/fasteners)：记录不充分
*   [锁定文件](https://pypi.python.org/pypi/lockfile)：已弃用
*   [flufl.lock](https://pypi.python.org/pypi/flufl.lock/2.4.1)：用于 POSIX 系统的 NFS 安全文件锁定。
*   [simpleflock](https://github.com/derpston/python-simpleflock) : 最后更新 2013-07
*   [zc.lockfile](https://pypi.python.org/pypi/zc.lockfile?)：最后一次更新 2016-06（截至 2017-03）
*   [lock_file](https://pypi.python.org/pypi/lock_file/2.0) : 2007-10 的最后更新

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2010-07-27T13:04:47.867

我更喜欢**[lockfile](https://github.com/smontanaro/pylockfile)** — 独立于平台的文件锁定

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-01-29T08:46:38.620

锁定是特定于平台和设备的，但通常，您有几个选项：

1.  使用flock()，或等效的（如果你的操作系统支持的话）。这是建议锁定，除非您检查锁定，否则它会被忽略。
2.  使用 lock-copy-move-unlock 方法，复制文件，写入新数据，然后移动它（移动，而不是复制 - 移动是 Linux 中的原子操作 - 检查您的操作系统），然后检查锁定文件的存在。
3.  使用目录作为“锁”。如果您要写入 NFS，这是必要的，因为 NFS 不支持flock()。
4.  也有可能在进程之间使用共享内存，但我从未尝试过；这是非常特定于操作系统的。

对于所有这些方法，您必须使用自旋锁（失败后重试）技术来获取和测试锁。这确实为错误同步留下了一个小窗口，但它通常足够小，不会成为主要问题。

如果您正在寻找跨平台的解决方案，那么您最好通过其他机制登录到另一个系统（下一个最好的方法是上面的 NFS 技术）。

请注意，sqlite 受到与普通文件相同的 NFS 约束，因此您无法写入网络共享上的 sqlite 数据库并免费获得同步。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-29T00:24:06.857

在操作系统级别协调对单个文件的访问充满了您可能不想解决的各种问题。

您最好的选择是有一个单独的进程来协调对该文件的读/写访问。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2020-01-17T21:54:45.170

下面是一个如何使用[filelock](https://pypi.org/project/filelock/)库的示例，它类似于[Evan Fossmark 的实现](https://stackoverflow.com/a/498505)：

```
from filelock import FileLock

lockfile = r"c:\scr.txt"
lock = FileLock(lockfile + ".lock")
with lock:
    file = open(path, "w")
    file.write("123")
    file.close() 
```

块中的任何代码`with lock:`都是线程安全的，这意味着它将在另一个进程访问该文件之前完成。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-28T23:45:51.707

锁定文件通常是特定于平台的操作，因此您可能需要考虑在不同操作系统上运行的可能性。例如：

```
import os

def my_lock(f):
    if os.name == "posix":
        # Unix or OS X specific locking here
    elif os.name == "nt":
        # Windows specific locking here
    else:
        print "Unknown operating system, lock unavailable" 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-08-07T01:01:51.917

我一直在处理这样的情况，我从同一个目录/文件夹中运行同一个程序的多个副本并记录错误。我的方法是在打开日志文件之前将“锁定文件”写入磁盘。程序在继续之前检查“锁定文件”是否存在，如果“锁定文件”存在则等待轮到它。

这是代码：

```
def errlogger(error):

    while True:
        if not exists('errloglock'):
            lock = open('errloglock', 'w')
            if exists('errorlog'): log = open('errorlog', 'a')
            else: log = open('errorlog', 'w')
            log.write(str(datetime.utcnow())[0:-7] + ' ' + error + '\n')
            log.close()
            remove('errloglock')
            return
        else:
            check = stat('errloglock')
            if time() - check.st_ctime > 0.01: remove('errloglock')
            print('waiting my turn') 
```

编辑---在考虑了上面关于过时锁的一些评论之后，我编辑了代码以添加对“锁文件”过时的检查。在我的系统上对该函数进行数千次迭代，平均为 0.002066... 秒：

```
lock = open('errloglock', 'w') 
```

到之后：

```
remove('errloglock') 
```

所以我想我会从这个数量的 5 倍开始，以指示陈旧性并监控问题的情况。

此外，当我处理时间安排时，我意识到我有一些并非真正必要的代码：

```
lock.close() 
```

我在公开声明之后立即删除了它，因此我在此编辑中将其删除。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-02-15T10:46:42.647

这对我有用：不要占用大文件，将创建文件 Temp 的几个小文件分发，删除文件 A，然后将文件 Temp 重命名为 A。

```
import os
import json

def Server():
    i = 0
    while i == 0:
        try:        
                with open(File_Temp, "w") as file:
                    json.dump(DATA, file, indent=2)
                if os.path.exists(File_A):
                    os.remove(File_A)
                os.rename(File_Temp, File_A)
                i = 1
        except OSError as e:
                print ("file locked: " ,str(e))
                time.sleep(1)

def Clients():
    i = 0
    while i == 0:
        try:
            if os.path.exists(File_A):
                with open(File_A,"r") as file:
                    DATA_Temp = file.read()
            DATA = json.loads(DATA_Temp)
            i = 1
        except OSError as e:
            print (str(e))
            time.sleep(1) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-08-11T07:11:53.370

**场景**是这样的：用户请求一个文件来做某事。然后，如果用户再次发送相同的请求，它会通知用户第二个请求在第一个请求完成之前没有完成。这就是为什么，我使用锁机制来处理这个问题。

这是我的工作代码：

```
from lockfile import LockFile
lock = LockFile(lock_file_path)
status = ""
if not lock.is_locked():
    lock.acquire()
    status = lock.path + ' is locked.'
    print status
else:
    status = lock.path + " is already locked."
    print status

return status 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-08-19T15:22:58.637

我从 grizzled-python 中找到了一个简单且有效的（！）[实现。](https://github.com/bmc/grizzled-python/blob/master/grizzled/io/filelock.py)

简单使用 os.open(..., O_EXCL) + os.close() 在 Windows 上不起作用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-09-26T16:41:45.923

您可能会发现[pylocker](https://bachiraoun.github.io/pylocker/)非常有用。它可用于锁定文件或一般的锁定机制，并且可以同时从多个 Python 进程访问。

如果您只是想锁定一个文件，那么它是如何工作的：

```
import uuid
from pylocker import Locker

#  create a unique lock pass. This can be any string.
lpass = str(uuid.uuid1())

# create locker instance.
FL = Locker(filePath='myfile.txt', lockPass=lpass, mode='w')

# aquire the lock
with FL as r:
    # get the result
    acquired, code, fd  = r

    # check if aquired.
    if fd is not None:
        print fd
        fd.write("I have succesfuly aquired the lock !")

# no need to release anything or to close the file descriptor, 
# with statement takes care of that. let's print fd and verify that.
print fd 
```

# apache - 如何即时修改第一个返回的标头

> ID：489863
> 
> 赞同：0
> 
> 时间：2009-01-28T23:20:16.377
> 
> 标签：apache, http

我的意思是 HTTP/1.1 xxx yyyyyyy

header 我可以使用 mod_headers 修改所有其他人，但希望能够将 403 错误页面的状态 200 返回给不显示我的 403 页面文本的特定用户代理{它显示一个备用页面}

只是询问是否有人知道 env-var 或标头名称，我可以在 apache.conf 中更改以以任何方式更改此标头{一旦我有了，我就可以计算出使其成为用户代理特定位

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T23:34:19.610

那不是标题，它是状态行。

谎报响应的状态通常会导致问题，例如，链接检查器会错过报告此类错误。您依赖于人类阅读 200 页并理解它，但计算机协议的全部意义在于它们也可以被计算机理解。您应该尝试解决问题而不是隐藏它。

在我看来，您似乎遇到了 Internet Explorer 对“友好”错误页面的坚持。您可以通过填充错误页面使其大于 512 字节来解决此问题，这会导致 Internet Explorer 显示错误页面而不是它自己的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T23:31:17.183

您可以为您的 403 错误页面设置一个 php 脚本，并使用该脚本修改标题：

在 .htaccess 或 Apache 配置文件中添加这样的一行：

`ErrorDocument 403 /path/to/your/error/script.php`

以及上述php文件中的以下内容：

```
<?php
if($_SERVER['HTTP_USER_AGENT'] == 'FooBot 1.2') {
  header("HTTP/1.0 200 OK");
}
?> 
```

或者用你喜欢的语言做同样的事情。

# macos - OS X：我如何利用 Apple 的“辅助工具”API 来观察键盘输入？

> ID：489867
> 
> 赞同：0
> 
> 时间：2009-01-28T23:21:03.397
> 
> 标签：macos, accessibility

我想创建类似于 TextExpander 的东西——一个宏程序，它监视键盘的特定击键组合，然后用一个片段替换你刚刚输入的文本。我的意思是，你输入“--expando”，它会用“gee is not this an extended text snippets”替换它。我知道您需要连接到辅助服务 API，但我似乎找不到任何简单的源代码可以从中跳出，而且我能找到的所有文档都是关于使现有应用程序可访问，而不是创建辅助工具他们自己。

指向源代码的指针将是最受欢迎的，但只需一个指向必要 API 文档的链接将是一个好的开始！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-27T16:31:45.840

我刚从 2008 年 1 月看到[这篇博](http://caffeinatedcocoa.com/blog/?m=200801)文，其中提到使用 Accessibility API 编写按键记录器很容易。

该功能应该是您需要的基本功能的一半（另一半是将扩展文本注入当前应用程序）。

也许您可以联系博客作者以获取更多详细信息。

# sql - SQL ORDER 字符数

> ID：489874
> 
> 赞同：41
> 
> 时间：2009-01-28T23:24:19.520
> 
> 标签：sql, char, type-conversion, sql-order-by, numerical

我有一列数字存储为字符。当我为此列执行 ORDER BY 时，我得到以下信息：

100
131
200
21
30
31000
等

如何以数字方式订购这些字符？我需要转换一些东西还是已经有一个 SQL 命令或函数？

谢谢你。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-01-28T23:26:39.750

试试这个：

```
ORDER BY CAST(thecolumn AS int) 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2011-12-18T20:07:05.667

这对我有用：

```
ORDER BY ABS(column_name) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-12-18T16:58:26.510

在某些情况下，这可能是一个很好的匹配：

```
ORDER BY LENGTH(column_name), column_name 
```

特别是如果您有一列包含所有数字或字母和数字混合但长度相同的列。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T23:27:59.233

这是在“自然排序”中排序数字字符串的问题（如果您在 Google 上查找“自然排序”，您会发现很多东西）。本质上将字符串转换为 int 并对结果值进行排序应该可以修复它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T11:10:32.913

原因是对于 char 数据类型，您将行排序为字符串。

这个想法`ORDER BY CAST()`是正确的，但是随着返回结果数量的增加，它的性能会下降。

如果此列中只有数字数据，最佳做法是找到合适的数字数据类型并更改它。

如果您确实无法更改列并且发现自己遇到性能问题，我建议您使用包含转换为整数的值的排序顺序列（将空值转换为适当的值）。

索引排序顺序列，理想情况下，将触发器添加到 CHAR 列，以便对 char 值的插入或更新触发对整数值的更新。

# windows-desktop-gadgets - 帮助程序员的桌面小工具和小工具

> ID：489877
> 
> 赞同：1
> 
> 时间：2009-01-28T23:25:20.593
> 
> 标签：windows-desktop-gadgets

这里的集体天才是否知道任何帮助开发人员完成工作的侧边栏小工具或仪表板小部件？像这样的任务：

*   快速查找函数/方法的能力
*   类描述
*   按特定标签组过滤的 Stackoverflow 问题

你给它命名。

我正在拼命寻找使用 Vista 侧边栏的理由，并且我希望这样做可以创造一个更高效的环境，并帮助我完成日常任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T23:28:36.923

它不是侧边栏小工具，但我过去曾使用 www.quickref.org 来快速查找参考。我相信它会成为一个很棒的小工具。不幸的是，我对 Vista 侧边栏也有同样的感觉，目前它并没有真正的用处，至少对我来说是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T23:38:43.983

我实际使用的少数几个之一是[Activity Tracker](http://screeperzone.com/2007/11/25/activity-tracker-windows-vista-sidebar-time-managementtime-tracker-gadget/)。我喜欢（有时必须）跟踪我在各种项目和支持任务上的时间——我把这个小工具从侧边栏上撕下来，放在角落里的第二台显示器上——现在，一个简单的点击，我就走了一项任务，然后是下一项——网络界面甚至可以绘制时间/项目的图表。

肯定希望看到一些更有用的小工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T23:46:21.037

我喜欢任何能让我不显眼地监控 CPU 使用率的东西。通常，对我来说，这只是第二台显示器上的任务管理器，甚至最小化（系统托盘中的活动。）

而且，（正如爸爸会警告的那样）要小心不要仅仅因为你拥有它而使用它。有点像应用设计模式、范例等...... :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T06:58:51.840

我喜欢来自**www.3dfreeair.com**的动物（大象）、有趣的玩具、蜡烛动画等桌面小工具的新技术， 试试这个。你也喜欢。

# c++ - 代码依赖文档软件

> ID：489880
> 
> 赞同：1
> 
> 时间：2009-01-28T23:26:40.560
> 
> 标签：c++, c

我正在寻找一种工具来记录我使用的嵌入式 C 项目的遗留源代码。我想到有一个工具可以创建各种 C 和 .h 文件的图表，但我不记得它叫什么了。有人知道这样的工具吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-02-03T20:39:46.210

[CppDepend](http://www.cppdepend.com)类似于 C\C++ 的 NDepend

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T23:30:07.607

[多氧](http://www.doxygen.org/)

如果您还安装了[graphviz](http://www.graphviz.org/)，那么[doxygen](http://www.doxygen.org/)也可以生成漂亮的[调用图](http://www-scf.usc.edu/~peterchd/doxygen/)和其他[图表](http://www.doxygen.nl/manual/diagrams.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T23:35:02.870

[这个网址](http://grok2.tripod.com/code_comprehension.html)也有一个很大的列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T23:32:11.173

[理解](http://www.scitools.com/products/understand/)

# c# - 仍在渲染不可见的控件

> ID：489886
> 
> 赞同：1
> 
> 时间：2009-01-28T23:29:23.473
> 
> 标签：c#, .net, asp.net

我遇到了最奇怪的问题。

我在母版页中有两个占位符；一个包含已注销用户的控件，另一个包含已登录用户的控件。

他们是：

`plhLoggedOut`

`plhLoggedIn`

在我的 Page_Load（母版页）期间，我将它们的可见性设置为：

```
 //LOGGED-IN?
        plhLoggedOut.Visible = (app.UserID == 0);
        plhLoggedIn.Visible = (app.UserID != 0); 
```

但是，BOTH PlaceHolders 的内容仍在渲染中。

我什至将他们的可见性写入状态消息，并且该状态消息确认在任何给定时间只有一个可见。例如，

```
plhLoggedOut.Visible == True; plhLoggedIn.Visible == False 
```

任何想法如何发生（以及如何解决它）？

非常感谢，

迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T23:38:18.197

也许在您的代码中的其他地方，您正在将这些面板的父控件设置为可见，这会穿透所有子控件并将它们也设置为可见。您需要更改代码，以便在其父控件之后设置 plhLoggedOut 和 plhLoggedIn 可见性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T00:00:02.227

我刚刚删除了旧的 PlaceHolders 并创建了两个具有不同 ID 的新 PlaceHolders。然后它开始工作。

我隐约记得以前有过类似的奇怪行为，由于某种原因，代码隐藏和标记是断开的。这可能会发生，因为我不使用可视化设计器，而是手动编写 .NET 标记和 Designer.cs 文件。

仅供参考，slolife，我刚刚对其进行了测试，可见性并没有像从父控件到子控件那样传递。即使将容器的可见性设置为 true，您也可以嵌套隐藏的控件。

谢谢大家，

迈克尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T23:57:24.570

你打电话也试试

```
<asp:PlaceHolder ID="plhLoggedOut" runat="server" Visible="<%# app.UserID == 0 %>" />

<asp:PlaceHolder ID="plhLoggedIn" runat="server" Visible="<%# app.UserID != 0 %>" /> 
```

然后对它们进行数据绑定以使表达式求值。

# python - 如何通过 Python 从地理数据中提取 x、y 和 z 坐标？

> ID：489901
> 
> 赞同：0
> 
> 时间：2009-01-28T23:36:31.743
> 
> 标签：python, extraction, geography

我有包含 14 个变量的地理数据。数据格式如下：

> Quadname：RockPort_Colony_SD分辨率：10 ULLAT：43.625
> ULLON：-97.87527466 LRLAT：43.5
> LRLON：-97.75027466 HDATUM：27
> ZMIN：361.58401489 ZMAX：413.38400269 ZSIGMA：396.1293335 Zsigma：12.36359215 PMethod：5
> Quaddate：20001001

整个数据在序列中有许多先前的变量。

如何从数据中提取坐标 ULLAT、ULLON 和 LRLAT 到三个列表中，以便每一行对应一个位置？

这个问题是由[帖子](https://stackoverflow.com/questions/486807/where-can-i-get-the-x-y-z-coordinates-for-california-to-use-a-contour-plot)中的问题提出的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T02:55:42.353

如果数据都在一个大的平面文本文件中，这样的事情可能会起作用：

```
import re

data = """
QUADNAME: rockport_colony_SD RESOLUTION: 10 ULLAT: 43.625
ULLON: -97.87527466 LRLAT: 43.5
LRLON: -97.75027466 HDATUM: 27
ZMIN: 361.58401489 ZMAX: 413.38400269 ZMEAN: 396.1293335 ZSIGMA: 12.36359215 PMETHOD: 5
QUADDATE: 20001001
"""

regex = re.compile(
    r"""ULLAT:\ (?P<ullat>-?[\d.]+).*?
    ULLON:\ (?P<ullon>-?[\d.]+).*?
    LRLAT:\ (?P<lrlat>-?[\d.]+)""", re.DOTALL|re.VERBOSE)

print regex.findall(data) # Yields: [('43.625', '-97.87527466', '43.5')] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T00:40:57.807

给定一个名为 reader 的[StreamReader](http://docs.python.org/library/codecs.html#streamreader-objects)，这应该为您提供 (float, float, float) 的列表。我建议使用 3 元组列表，因为它可能会更方便、更高效，除非出于某种原因你只想单独获得所有点。

```
coords = []
reader
while line=reader.readline():

  index_ullat = line.find("ULLAT")
  if index_ullat >= 0:
    ullat = float(line[ index_ULLAT+7 : ])

    line = reader.readline()

    index_ullon = line.find("ULLON")
    index_lrlat = line.find("LRLAT")
    if index_ullon >= 0 and index_lrlat >= 0:
      ullon = float(line[ index_ullon+7 : index_lrlat-1 ])
      lrlat = float(line[ index_lrlat+7 : ])
    else:
      raise InputError, "ULLON and LRLAT didn't follow ULLAT."

    coords.append(ullat, ullon, lrlat) 
```

它可能有效，但它很丑陋。我不是字符串解析方面的专家。

# iis - 是否可以在 IIS 5.1 上托管多个网站？

> ID：489902
> 
> 赞同：1
> 
> 时间：2009-01-28T23:37:21.663
> 
> 标签：iis, windows-xp, iis-5

我在我的家庭开发机器上运行 WinXP Pro SP3 和 IIS 5.1。据我所知，IIS 5.1 只允许我托管一个网站，这是一个问题，因为我目前正在处理三个网站。是这样吗？如果是这样，有什么办法可以绕过这个限制吗？

**编辑：**这仅用于开发/测试目的-我不想实际托管任何实时网站，甚至不想让除我之外的任何人访问它们。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T00:29:39.967

这实际上可以在没有任何插件的情况下完成。XP Pro 仍将允许多个站点在 IIS 下运行，但他们已从 GUI 中删除了配置此选项的选项。他们还取消了同时运行多个站点的能力。使用 \Inetpub\Adminscripts 目录中的脚本，您可以添加其他站点，然后使用 IIS 管理管理单元切换运行哪个站点。

这篇文章解释了细节：

[http://www.developerfusion.com/code/4645/multiple-iis-virtual-servers-on-xp-pro/](http://www.developerfusion.com/code/4645/multiple-iis-virtual-servers-on-xp-pro/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T23:47:40.487

如果这是为了测试，您可能可以使用 IIS Admin，它允许您设置多个站点，但一次只有一个活动：

[http://blog.crowe.co.nz/archive/2005/08/08/179.aspx](http://blog.crowe.co.nz/archive/2005/08/08/179.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T23:43:02.477

您只能在 XP 上托管一个网站。您还会发现存在连接限制，因此即使托管一个网站也可能是一项挑战。

模拟多个站点的一种方法是为每个站点设置一个单独的主机名。然后在自己的文件夹下创建每个“站点”，例如，

/site1/

/site2/

/site3/

然后每个站点通用的代码（例如，在您的布局中）检查 URL 并重定向到相应文件夹下的页面，如果它尚未从那里加载页面。因此，您有效地将主机名绑定到子文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T23:42:06.910

您可以在不同的虚拟目录中托管不同的站点应用程序，例如：

[http://localhost/Site1](http://localhost/Site1)

[http://localhost/Site2](http://localhost/Site2)

[http://localhost/Site3](http://localhost/Site3)

但我认为您不能让 XP IIS 响应不同的主机：

[http://Site1/](http://Site1/)

[http://Site2/](http://Site2/)

[http://Site3/](http://Site3/)

# sql - MySQL添加总列

> ID：489904
> 
> 赞同：4
> 
> 时间：2009-01-28T23:38:08.277
> 
> 标签：sql, mysql, aggregate-functions, subquery

我需要查询此数据库以获取每一行，以及结果的列值之一的 SUM。我可以使用 php 来获取总值，但是我需要运行两个循环，一个来获取总值（位于结果上方的顶部）。所以我更喜欢查询来捕获它并只创建一个“总”行，但我让它工作的唯一方法是使用基本上是原始查询重复的子查询。有没有更好的办法？

```
SELECT 
CONCAT(u.firstname, ' ', u.lastname ) name, u.id, s.description, s.shiftstart, s.shiftend, 
    (SELECT 
    SUM( TIME_TO_SEC( TIMEDIFF( shiftend, shiftstart ) ) ) /3600
    FROM shifts
    WHERE id =  '$user'
    AND DATE( shiftstart )
    BETWEEN '$start'
    AND '$end') total
FROM shifts s
INNER JOIN users u ON ( s.id = u.id )
WHERE s.id = '$user'
AND DATE( shiftstart )
BETWEEN '$start'
AND '$end'
ORDER BY shiftstart 
```

上述工作和输出：

```
name        id     description  shiftstart             shiftend               total
Joe User    joeuser    Stuff    2009-01-05 07:45:00    2009-01-05 12:15:00    39.5000
Joe User    joeuser    Stuff    2009-01-05 13:00:00    2009-01-05 17:00:00    39.5000
Joe User    joeuser    Stuff    2009-01-06 07:45:00    2009-01-06 10:45:00    39.5000
Joe User    joeuser    Stuff    2009-01-06 10:45:00    2009-01-06 12:45:00    39.5000
Joe User    joeuser    Stuff    2009-01-06 13:30:00    2009-01-06 14:30:00    39.5000
Joe User    joeuser    Stuff    2009-01-06 14:30:00    2009-01-06 17:00:00    39.5000
Joe User    joeuser    Stuff    2009-01-07 09:45:00    2009-01-07 14:00:00    39.5000
Joe User    joeuser    Stuff    2009-01-07 15:00:00    2009-01-07 17:00:00    39.5000
Joe User    joeuser    Stuff    2009-01-08 08:00:00    2009-01-08 12:15:00    39.5000
Joe User    joeuser    Stuff    2009-01-08 13:15:00    2009-01-08 17:00:00    39.5000
Joe User    joeuser    Stuff    2009-01-09 07:45:00    2009-01-09 10:45:00    39.5000
Joe User    joeuser    Stuff    2009-01-09 11:45:00    2009-01-09 15:15:00    39.5000
Joe User    joeuser    Stuff    2009-01-09 15:15:00    2009-01-09 17:00:00    39.5000 
```

这是我需要的，但可能不是获得它的最佳方式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T00:08:31.537

MySQL 支持一种特殊的 group-by 修饰符，称为[ROLLUP](http://dev.mysql.com/doc/refman/5.1/en/group-by-modifiers.html)。

```
SELECT CONCAT(u.firstname, ' ', u.lastname ) name, u.id, 
  s.description, s.shiftstart, s.shiftend, 
  SUM( TIME_TO_SEC( TIMEDIFF( shiftend, shiftstart ) ) ) /3600 total
FROM shifts s INNER JOIN users u ON ( s.id = u.id )
WHERE s.id = ? AND DATE( shiftstart ) BETWEEN ? AND ?
GROUP BY u.id, s.shiftstart WITH ROLLUP
ORDER BY shiftstart; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T23:50:44.973

更好的方法是使用代码来做到这一点。人们一直坚持使用关系代数 SQL 来完成程序性任务。就复杂性和性能而言，试图将过程性硬塞到 SQL 上**总是一个坏主意。**听取专业 DBA 的建议。

从您的代码中运行两个查询。首先输出较大的集合，然后以您想要的任何格式输出总行。您的查询将变得更小更简单，您的性能将得到提高，您将获得所需的输出。

其他一些建议 - 磁盘空间很便宜，并且大多数数据库表的读取频率远高于写入频率。设置一个插入/更新触发器（如果可能在 MySQL 中）以使用“ `CONCAT(u.firstname,' ',u.lastname)`”之类的计算字段填充单独的列，并将其用于查询。每行函数是不可扩展的，当它变大时会破坏你的 DBMS 性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T23:52:33.940

相比之下，任何事情都可以更好；问题是与什么比较，对吧？

您指出的关键问题是您希望总数位于结果的顶部；Crystal Reports 和其他应用程序通过作为 2 通道引擎来管理这种魔法。第一次通过获得总数。

任何解决方案都需要权衡取舍。如果您得到一个单独的“总计”行，那么接收应用程序将需要将其从结果中删除或使用其他技巧来隐藏它。

如果您不是为每小时点击量为 100 万的网站编写代码，则一种可能性是简单地进行 2 次调用 - 一次调用开销信息，例如名称、总时间等，然后调用详细信息...从查询中显示您正在选择一个人的结果。

我们都是为了节省开销和带宽，但有时，简单更好......

编辑：Pax 将我击败到“保存”按钮...大声笑...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T00:19:25.073

使用专门为此目的提供的 mysql 扩展，如 Bill Karwin 的回复（我自己赞成）中所述。

如果这不可用，选项 2 将是另一个 SQL 语句：SELECT SUM ...) 与您可能编写的任何过程代码循环相比，SQL 确实经过优化，对于这类事情非常有效。

# java - 更改方法中变量的值，Java

> ID：489913
> 
> 赞同：14
> 
> 时间：2009-01-28T23:40:32.997
> 
> 标签：java, scope

我有一个关于更改 Java 方法中的变量值的问题。

这是我的代码：

```
public class Test {
    public static void funk(int a, int[] b) { 
        b[0] = b[0] * 2; 
        a = b[0] + 5;
    } 

    public static void main(String[] args) {
        int bird = 10;
        int[] tiger = {7};

        Test.funk(bird, tiger);
    }
} 
```

在方法执行之后`Test.funk(bird, tiger)`，bird 的值没有改变——它仍然是值`10`，即使在`funk()`方法中我们已经改变了值`a = b[0] + 5;`

另一方面，数组中元素的值发生了变化，因为我们有语句`b[0] = b[0] * 2;`

我不明白为什么一件事会改变而另一件事不会？有人可以为我解释一下吗。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-28T23:45:00.523

查看 Jon Skeet 的关于[Parameter-Passing in Java](http://www.yoda.arachsys.com/java/passing.html)的文章，其中解释了这一点。

简而言之（查看他的网站以获得更全面的解释）：

数组是引用类型。如果传递指向数组的引用，则引用的值将被复制并分配给函数的参数。所以参数将指向与传递的参数相同的数组。因此，您通过函数的参数对数组所做的更改将在调用函数中可见。更改参数本身 (b)，例如将其设置为*null*，但是，调用函数不会注意到，因为参数 (b) 只是传递的参数 (tiger) 的副本。

整数是所谓的原始类型。传递整数会复制其值并将其分配给参数。但该值不是对实际数据的引用，而是数据本身。所以函数中参数的改变会影响参数（a），但不会影响调用函数（bird）中传递的参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T23:47:39.100

那是因为当你声明

```
 public static void funk(int a, int[] b) 
```

变量*a*的范围只是那个方法。然后，当您更改该值时，您仅更改**该方法中****该**变量的值。

 **关于b。那是对 main 中创建的同一数组的新对象引用，这就是为什么值*似乎*确实发生了变化（正在变化的是下面的数组对象）

但是试试这个：

```
public static void funk(int a, int[] b) { 
    // create a new reference for b
    int[] c = new int[b.length];
    c[0] = b[0];
    b = c;

    // The same.
    b[0] = b[0] * 2; 
    a = b[0] + 5;
} 
```

当你这样做时，你的 Tiger 的值也不会改变（只有在 funk 中创建的新数组 c 的内容）

您可以使用包装器模拟通过 ref 传递。[看到这个帖子。](https://stackoverflow.com/questions/430479/how-do-i-use-an-equivalent-to-c-reference-parameters-in-java#431152)

*[虽然我对此没有任何评论]*

**编辑只是为了好玩：**

我已修改您的代码以使用上面发布的包装器。

它看起来很奇怪，但看起来很有效。

```
// By ref simulated.
public class Test {

    public static void funk(_<Integer> a, int[] b) { 
        b[0] = b[0] * 2; 
        a.s(  b[0] + 5 ) ;
    } 

    public static void main(String[] args) {
        _<Integer> bird = new _<Integer>(10);
        int[] tiger = {7};

        Test.funk( bird , tiger );

        System.out.println("bird = " + bird );
        System.out.println("tiger = " + tiger[0] );

    }

} 
```

印刷

```
bird = 19
tiger = 14 
```

:-S

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T23:49:20.593

基本上，对象（如数组）是“通过引用”传递给方法的。因此，当您更改对象时，它会更改传递给方法的相同对象。

基元（如 int）是“按值传递”的，因此您在 a 中分配值的变量与传入的 int 变量不同。

我希望这有帮助...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-09T15:30:16.217

一个变量是按引用传递，另一个是按值传递 :)

[按引用传递与按值传递有什么区别？](https://stackoverflow.com/questions/373419/whats-the-difference-between-passing-by-reference-vs-passing-by-value)

# wcf - WCF：为什么传入远程端点会失败？

> ID：489915
> 
> 赞同：16
> 
> 时间：2009-01-28T23:41:51.357
> 
> 标签：wcf, net.tcp, .net-3.0

WCF：为什么通过配置文件传递同一端点时传递远程端点失败？

这有效：

```
 Using con As New OfferingTap.OfferingTapClient(New ServiceModel.InstanceContext(callback), "NetTcpBinding_IOfferingTap" 
```

这不会：

```
 Using con As New OfferingTap.OfferingTapClient(New ServiceModel.InstanceContext(callback), "NetTcpBinding_IOfferingTap", "net.tcp://qa1offerings:8190/") 
```

配置文件摘录：

```
 <endpoint address="net.tcp://qa1offerings:8190/" binding="netTcpBinding"
            bindingConfiguration="NetTcpBinding_IOfferingTap" contract="OfferingTap.IOfferingTap"
            name="NetTcpBinding_IOfferingTap"> 
```

例外：

```
System.ServiceModel.Security.SecurityNegotiationException was unhandled
  Message="A call to SSPI failed, see inner exception."
  Source="mscorlib"
  StackTrace:
    Server stack trace: 
       at System.ServiceModel.Channels.WindowsStreamSecurityUpgradeProvider.WindowsStreamSecurityUpgradeInitiator.OnInitiateUpgrade(Stream stream, SecurityMessageProperty& remoteSecurity)
       at System.ServiceModel.Channels.StreamSecurityUpgradeInitiatorBase.InitiateUpgrade(Stream stream)
       at System.ServiceModel.Channels.ConnectionUpgradeHelper.InitiateUpgrade(StreamUpgradeInitiator upgradeInitiator, IConnection& connection, ClientFramingDecoder decoder, IDefaultCommunicationTimeouts defaultTimeouts, TimeoutHelper& timeoutHelper)
       at System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.SendPreamble(IConnection connection, ArraySegment`1 preamble, TimeoutHelper& timeoutHelper)
       at System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.DuplexConnectionPoolHelper.AcceptPooledConnection(IConnection connection, TimeoutHelper& timeoutHelper)
       at System.ServiceModel.Channels.ConnectionPoolHelper.EstablishConnection(TimeSpan timeout)
       at System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.OnOpen(TimeSpan timeout)
       at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.OnOpen(TimeSpan timeout)
       at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.CallOpenOnce.System.ServiceModel.Channels.ServiceChannel.ICallOnce.Call(ServiceChannel channel, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.CallOnceManager.CallOnce(TimeSpan timeout, CallOnceManager cascade)
       at System.ServiceModel.Channels.ServiceChannel.EnsureOpened(TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs)
       at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
       at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)
    Exception rethrown at [0]: 
       at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
       at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
       at Offering_Server_Recorder.OfferingTap.IOfferingTap.RequestFeed(Int32 dataSourceKey)
       at Offering_Server_Recorder.OfferingTap.OfferingTapClient.RequestFeed(Int32 dataSourceKey) in C:\Documents and Settings\jallen\Local Settings\Application Data\Temporary Projects\Offering Server Recorder\Service References\OfferingTap\Reference.vb:line 471
       at Offering_Server_Recorder.Module1.Main() in C:\Documents and Settings\jallen\Local Settings\Application Data\Temporary Projects\Offering Server Recorder\Module1.vb:line 9
       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: System.Security.Authentication.AuthenticationException
       Message="A call to SSPI failed, see inner exception."
       Source="System"
       StackTrace:
            at System.Net.Security.NegoState.ProcessAuthentication(LazyAsyncResult lazyResult)
            at System.Net.Security.NegotiateStream.AuthenticateAsClient(NetworkCredential credential, String targetName, ProtectionLevel requiredProtectionLevel, TokenImpersonationLevel allowedImpersonationLevel)
            at System.ServiceModel.Channels.WindowsStreamSecurityUpgradeProvider.WindowsStreamSecurityUpgradeInitiator.OnInitiateUpgrade(Stream stream, SecurityMessageProperty& remoteSecurity)
       InnerException: System.ComponentModel.Win32Exception
            ErrorCode=-2147467259
            Message="The target principal name is incorrect"
            NativeErrorCode=-2146893022
            InnerException: 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-28T23:50:01.717

显然，您必须传入一个空的 SpnEndpointIdentity 才能完成这项工作。

```
 Using con As New OfferingTap.OfferingTapClient( _ 
        New ServiceModel.InstanceContext(callback), "NetTcpBinding_IOfferingTap", _
        New ServiceModel.EndpointAddress(New Uri("net.tcp://qa1offerings:8190/"), _
        New ServiceModel.SpnEndpointIdentity(""))) 
```

# java - 如何在Java中输出序列'1 0 1 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 0 0...'？

> ID：489927
> 
> 赞同：-1
> 
> 时间：2009-01-28T23:46:39.273
> 
> 标签：java, for-loop, sequence

我目前正在开始使用 Java 进行编程。我试图将标题中的序列编码为 Java 中的输出，但我被卡住了！我正在试验 for 功能，欢迎任何帮助；）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-28T23:50:09.203

```
System.out.println("1 0 1 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 0 0"); 
```

但说真的，伙计们，这是未经测试的第一关：

```
for(int i=1; i<100; i++){
    System.out.print("1 ");
    for(int j=0; j<i; j++){
        System.out.print("0 ");
    }
} 
```

如果您正在寻找有关如何开始的基本信息，Google 是您的朋友。例如，尝试用谷歌搜索“for loop java”，你会得到很多很好的例子。此外，要学习任何语言的基本知识，谷歌搜索“<language> hello world”是非常可靠的。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-29T00:10:28.960

为什么是两个循环？

*（从 C# 转换而来，请原谅任何语法错误）*

```
String s = "1 ";
for (int i = 0; i < 5; ++i)
{
  s = s + "0 ";
  System.out.print(s);
} 
```

自我批评：

*   两个 for 循环（如 Michael Haren 的解决方案）将否定字符串复制
*   StringBuffer/StringBuilder 将否定字符串复制

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-28T23:56:07.570

您可以将数字 10 存储在变量中，然后在循环中打印该数字，将其乘以 10（在其十进制表示后附加一个零），然后重复。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-29T00:05:56.817

```
for (int i = 2; i < 64; i <<= 1)
    //System.out.print(Integer.toString(i, 2));
    System.out.print(Integer.toString(i, 2).replaceAll("[01]", "$0 ")); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T23:49:03.980

还是你的老师要求你做的？两个嵌套的 for 循环就可以了。

或者以另一种语言（Ruby）的另一种方式：

```
4.times {|n| print 10**(n+1)} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T23:58:00.170

这不是真正的 fors 问题，而是非常基本的算法思维问题。你有一个由“1”组成的序列，然后是随着时间增长的其他东西“，另一个“1”，另一个东西等等。你可以将它们视为两个不同的交错序列。

因此，整体结构将类似于：

```
while(... infinity?)
{
   System.out.print("1");
   doSomething(); 
} 
```

现在，某些东西显然与外部循环的迭代次数（“阶段”）或 1 的计数相关，因此您需要类似：

```
int stage=0;
while(...infinity?)
{
   ++stage;
   System.out.print("1");
   for(int i=0; i<stage; ++i) System.out.print("0");
} 
```

如果您知道需要经过多少个循环，请使用 for 循环而不是 while，并通过它增加阶段。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-11-16T02:26:01.310

```
for (int i = 1; i < 100000;)
{
    i = i * 10;
    System.out.print(i);              
} 
```

或者

```
int i = 1;

while (i < 100000)
{
    i = i * 10;
    System.out.print(i);
} 
```

# c - 解析 C 中的字符串时出错“左操作数必须是左值”

> ID：489933
> 
> 赞同：3
> 
> 时间：2009-01-28T23:48:35.727
> 
> 标签：c, string

我需要在 ANSI C 中以“blah.bleh.bloh”格式的字符串提取信息。通常我会使用 strok() 来完成此操作，但由于我是通过 strtok 获取此字符串，并且strtok 不是线程安全的，我不能使用这个选项。

我写了一个函数来手动解析字符串。这是一个片段：

```
for(charIndex=0; charIndex < (char)strlen(theString); charIndex++)
{
    if(theString[charIndex] == '.')
    {
        theString[charIndex] = '\0';
        osi_string_copy_n(Info[currentInfoIndex], 1024, theString, charIndex + 1 );
        currentInfoIndex++;
        theString = &theString[charIndex + 1];
    }
    charIndex++;
} 
```

如您所见，我试图找到第一次出现的“。” 并记下字符的索引。然后我转换“。” 到一个空字符并将第一个字符串复制到一个数组中。

然后我想将指针更改为在找到分隔符之后开始，基本上给了我一个新的更短的字符串。

不幸的是，我遇到了一个错误：

```
theString = &theString[charIndex + 1]; 
```

错误是：

```
error C2106: '=' : left operand must be l-value 
```

为什么我不允许像这样移动指针？我的方法有缺陷吗？也许有人对我解析这个字符串有更好的主意。

编辑：针对评论，theString 的声明是：

```
char theString[1024] = {0}; 
```

此外，我保证 theString 永远不会超过 1024 个字符。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T23:55:02.377

假设您将 theString 定义为数组，请尝试将其定义为指针。将 char 变量声明为数组时，以后不能更改其地址。

我假设你有一个类似于

```
char theString[100]; 
```

最简单的解决方案是不理会该声明，然后添加另一个：

```
char *str = theString; 
```

然后`str`在您当前使用的任何地方使用`theString`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T00:06:42.633

您可以使用[`strtok_r`](http://www.opengroup.org/onlinepubs/000095399/functions/strtok.html)它在大多数平台上都可用并且是可重入的。这意味着它不保持内部状态，您可以毫无问题地从嵌套循环中调用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T00:58:22.590

只有一种真正的 C 方式，使用指针、紧密循环和神秘命令 :-)。

下面的`getNext()`函数将允许您按顺序返回所有组件，后跟一个 NULL 哨兵。您需要提供足够大的缓冲区来存储组件。我还包含了我的测试程序，因此您可以检查它（如果您愿意，还可以添加更多单元测试用例）。

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char *getNext (char *pStr, char *pComp) {
    /* Special for '.' at string end. */
    if ((*pStr == '.') && (*(pStr+1) == '\0')) {
        *pComp = '\0';
        return pStr + 1;
    }

    /* Check if no components left. */
    if (*pStr == '\0')
        return NULL;

    /* Transfer component one character at a time. */
    while ((*pStr != '\0') && (*pStr != '.'))
        *pComp++ = *pStr++;
    *pComp = '\0';

    /* Skip '.' at end, if there, but not at end of string. */
    if ((*pStr == '.') && (*(pStr+1) != '\0'))
        pStr++;

    // Return location of next component.
    return pStr;
}

int main (int argCount, char *argVal[]) {
    int argNum;
    int compNum;
    char *newStr;
    char *strPtr;

    if (argCount < 2) {
        printf ("Usage: components <string to componentize>...\n");
        return 1;
    }
    for (argNum = 1; argNum < argCount; argNum++) {
        if ((newStr = malloc (strlen (argVal[1]) + 1)) == NULL) {
            printf ("Out of memory for '%s'.", argVal[argNum]);
        } else {
            printf ("Input string is '%s'.\n", argVal[argNum]);
            compNum = 0;
            strPtr = getNext (argVal[argNum],newStr);
            while (strPtr != NULL) {
                printf ("   Component [%3d] is '%s'.\n", ++compNum, newStr);
                strPtr = getNext (strPtr,newStr);
            }
            free (newStr);
        }
    }

    return 0;
} 
```

这是输出：

```
[fury]> components your.test.string .dot.at.start at.end. .both. no_dots ''
Input string is 'your.test.string'.
    Component [  1] is 'your'.
    Component [  2] is 'test'.
    Component [  3] is 'string'.
Input string is '.dot.at.start'.
    Component [  1] is ''.
    Component [  2] is 'dot'.
    Component [  3] is 'at'.
    Component [  4] is 'start'.
Input string is 'at.end.'.
    Component [  1] is 'at'.
    Component [  2] is 'end'.
    Component [  3] is ''.
Input string is '.both.'.
    Component [  1] is ''.
    Component [  2] is 'both'.
    Component [  3] is ''.
Input string is 'no_dots'.
    Component [  1] is 'no_dots'.
Input string is ''. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T23:54:25.187

变量“theString”必须是指针而不是数组类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T01:57:37.433

这条线`theString = &theString[charIndex + 1];`本来就不应该存在。即使这一行没有出错并正常运行，`theString[charIndex]`也不会像`theString`移动的那样成为您期望的下一个相邻字符。

我的建议，几乎没有代码更改：

```
for(charIndex=0; charIndex < strlen(theString); charIndex++)
{
    if(theString[charIndex] == '.')
    {
        theString[charIndex] = '\0';
        osi_string_copy_n(Info[currentInfoIndex], 1024, theString + subStrStart, charIndex + 1 - subStrStart);
        currentInfoIndex++;
        subStrStart = charIndex + 1;
    }
    charIndex++;
} 
```

我不确定您`osi_string_copy_n`是做什么的，因此该行只是您原始代码的猜测。但是，如果您要将子字符串复制到另一个地方，并在函数参数中指定子字符串长度，那么应该不需要将子字符串的结尾设为空吗？

**编辑：**
我发现你的代码有两个`charIndex++`. 是`theString`双字节字符串吗？如果是这样，也许使用起来更合适`wchar_t`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T02:13:40.117

如果你有一个非古代的`libc`，你有`strtok_r`，这是一个可重入的变体`strtok`。

```
char *saveptr;
char *str;
for (str = strtok_r(theString, ".", &saveptr);
        str;
        str = strtok_r(NULL, ".", &saveptr)
    )
{
    printf("got: '%s'\n", str);
} 
```

这保证不会破坏任何`strtok`保持的状态，或其他`strtok_r`调用保持的任何状态（假设它们不共享你的`saveptr`）。

# c# - 在 C# 中，你如何完成与 #define 相同的事情

> ID：489937
> 
> 赞同：3
> 
> 时间：2009-01-28T23:49:23.980
> 
> 标签：c#, constants

来自 C 背景，我习惯于通过以下方式定义缓冲区的大小：

```
#define BUFFER_SIZE 1024

uint8_t buffer[BUFFER_SIZE]; 
```

你将如何在 C# 中完成同样的事情？

全大写的 K&R 样式是否也适合普通的 C# Pascal/Camel 大小写？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T23:53:23.067

```
const int BUFFER_SIZE = 1024; 
```

不要使用“静态只读”，因为它会创建一个变量。“const”在构建时被替换并且不创建变量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T23:55:32.670

就个人而言，我更喜欢常量：

```
private const int BUFFER_SIZE = 1024; 
```

但是，如果它是公共的并且您是一个框架，您可能希望它是只读的以[避免客户端重新编译](http://techblogs.wordpress.com/2008/07/01/constansts-in-cs-const-vs-readonly/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T23:52:12.850

```
public static readonly int BUFFER_SIZE = 1024; 
```

我更喜欢这个而不是 const，因为[编译器的恶作剧可能会发生](http://en.csharp-online.net/const,_static_and_readonly)在 const 值上（const 仅用于替换，因此更改值不会在针对原始值编译的任何程序集中更改它）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T23:52:56.093

不要使用#define。

定义一个常量：private const int BUFFER_SIZE 或只读变量：private readonly int BUFFER_SIZE

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-15T09:46:34.657

在 C# 中，我决定这样做：

```
//C# replace C++ #define
struct define
{
    public const int BUFFER_SIZE = 1024;
    //public const int STAN_LIMIT = 6;
    //public const String SIEMENS_FDATE = "1990-01-01";
}

//some code
byte[] buffer = new byte[define.BUFFER_SIZE]; 
```

# php - Django 可以为我的 PHP 应用程序的现有架构进行自动管理吗？

> ID：489948
> 
> 赞同：2
> 
> 时间：2009-01-28T23:52:57.077
> 
> 标签：php, django

我有一个生产中的应用程序，其管理界面低于标准。该应用程序是用 PHP 编写的，并由 PostgreSQL 提供支持。

我对 Django 进行了简单的修改，并且对启动和运行管理界面的简单程度印象深刻。

对 Django 更有经验的人可以评论一下：

*   我可以让 Django 以类似的方式围绕我现有的模式构建一个管理应用程序吗？如果是这样，
*   你会推荐它/有什么陷阱吗？

我可以看到的一个问题是我将维护两个模型：一个用 Python 编写，一个用 PHP 编写。不过，使用 Django 启动和运行管理界面的速度非常诱人。

谢谢哈利

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T00:18:59.317

[您可以使用 manage.py 的inspectdb](http://docs.djangoproject.com/en/dev/ref/django-admin/#inspectdb)命令创建链接到现有数据库的 django 站点，然后将管理功能添加到生成的模型中。

我还没有尝试过，但我使用 inspectdb 输出通过 Django 访问一些 phpbb 表，它似乎工作正常。

如果应用程序自己的管理界面不仅仅是简单的 CRUD（例如更新其他表中的非规范化字段等），您可能会遇到问题。改进当前的管理界面可能比在新的管理界面中重现这些东西更容易（更不用说如果您将来需要更改它们的逻辑会发生什么）。

# kerberos - 我可以向客户端表明支持 SPNEGO 但 NTLM 不适用于 HTTP 请求吗？

> ID：489950
> 
> 赞同：7
> 
> 时间：2009-01-28T23:53:21.600
> 
> 标签：kerberos, ntlm, spnego, negotiate, www-authenticate

我目前知道的微软使用的两个 WWW-Authenticate 添加是

*   NTLM
*   谈判

如果从服务器发送 Negotiate，将根据一组条件使用 Kerberos

*   内网区
*   使用主机名而不是 IP 访问服务器
*   已启用 IE 中的集成 Windows 身份验证，主机在 Firefox 中受信任
*   服务器不是浏览器本地的
*   客户端的 Kerberos 系统通过域控制器的身份验证

然后将在服务器和客户端之间尝试 Kerberos，如果不满足上述条件，则将尝试 NTLM。

我的问题是，服务器是否有某种方法可以指示不应发送 NTLM？我目前通过跟踪会话中的请求来处理这个问题，如果收到 NTLM 消息，它会在会话的剩余时间内禁用 Kerberos 和 WWW-Authenticate。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-11T03:49:08.270

初始`WWW-Authenticate`标头仅指定`negotiate`. 它不能再多说什么了，比如*"no NTLM"*。

我认为可以响应客户端发送的第一个 Authenticate: {Base64 NTLMSSP} 标头`401 unauthorized`和第二个`Negotiate`标头，该标头可以包含响应令牌，可能包括`SupportedMechanisms`指定仅 Kerberos 的标头。

但我怀疑这只会让你`"unauthorized"`受益，因为它首先回到了 NTLM。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-04T16:28:40.500

是的你可以。查看 SPNEGO HTTP Servlet Filter 项目的[参考文档](http://spnego.sourceforge.net/reference_docs.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-23T12:53:31.947

你可以这样做，（至少在理论上）是的。IE 可能会做一些非常奇怪的事情，比如在没有适当的 SPNEGO ASN.1 封装的情况下发送 Kerberos 令牌，但是，那是一个不同的主题。在符合标准的 SPNEGO ( [https://www.rfc-editor.org/rfc/rfc4178#section-4.1](https://www.rfc-editor.org/rfc/rfc4178#section-4.1) ) 实施中，您可以这样做。

如果您可以操纵 NegTokenInit mechTypes 成员以仅包含 Kerberos，它会强制客户端发送 Kerberos 或无法进行身份验证。

# javascript - 确定浏览器是否支持 iFrame 中的 javascript？

> ID：489966
> 
> 赞同：2
> 
> 时间：2009-01-28T23:59:37.687
> 
> 标签：javascript, iframe

我正在构建一个 iframe，它将进入我客户的网页。我需要确定用户的浏览器是否支持 javascript 并相应地返回页面的 javascript 或非 javascript 版本。

在这种情况下确定 javascript 支持的最佳方法是什么？我考虑过使用 javascript 重写 iframe url 以包含一个指示 javascript 支持的 GET 变量。但是，这会向服务器创建两个请求，一个用于初始加载，另一个用于 javascript 重写 URL 时。有没有办法只提交一个请求？还是有更好的方法来确定 JavaScript 支持？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T00:02:49.507

为什么不选择 < `noscript`> 标签？

```
<script>
document.write('<iframe src="javascript_enabled_page.html"></iframe>');
</script>

<noscript>
<iframe src="javascript_disabled_page.html"></iframe>;
</noscript> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T00:06:32.930

一般来说，您不应该检测 JavaScript 支持。您应该提供一个在没有 JavaScript 的情况下工作的页面，并添加 JavaScript 以在 JavaScript 可用时以任何适合的方式更改页面。

# css - 严格的 DOCTYPE 影响图像之间的间距

> ID：489974
> 
> 赞同：4
> 
> 时间：2009-01-29T00:03:05.027
> 
> 标签：css, xhtml, doctype

当我切换到 XHTML Strict DOCTYPE 时，我的图像间距出现问题。

以下代码 - 使用 Yahoo 的重置样式表来消除所有默认浏览器填充 - 在下面的两个图像之间留下大约 4 像素的间隙，但仅当我使用严格的 doctype 时。为什么是这样？

这只是 Chrome 和 Firefox 中的问题。IE 不会在两个图像之间显示单个像素。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <link rel="stylesheet" type="text/css" 
     href="http://yui.yahooapis.com/2.6.0/build/reset/reset-min.css">
</head>

<body>

<div><img src="http://www.catfacts.org/cat-facts.jpg" border="0"/></div>
<div><img src="http://www.catfacts.org/cat-facts.jpg" border="0"/></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-29T00:31:22.350

使用彼得的答案作为开始，以下解决了问题：

```
img { vertical-align: bottom } 
```

这样做的原因是默认为`vertical-align`is `baseline`，这相当于文本的“在线上方”部分，其中悬挂位垂下（小写 g、q 等都挂在此基线之下）。

因此，为了留出空间，它为这些悬垂留出了 4px 的空间。

希望这是有道理的。

编辑：来自[源站点的视觉辅助](http://www.brightlemon.com/web-design/blog/?cat=13)[（来源：][[brightlemon.com](http://www.brightlemon.com/web-design/blog/images/typography/basics-01.gif)][）]
[![替代文字](https://i.stack.imgur.com/dG0hL.gif)](https://i.stack.imgur.com/dG0hL.gif)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-29T00:47:41.740

可以在此处找到有关神秘图像间隙的更多信息：

[https://developer.mozilla.org/en/Images,_Tables,_and_Mysterious_Gaps](https://developer.mozilla.org/en/Images,_Tables,_and_Mysterious_Gaps)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T00:24:55.950

使用[Firebug](http://getfirebug.com/)表明是 DIV 导致了间距，而不是图像。

我设置字体大小：0；对于顶部 div，差距就消失了。

（奇怪的是，有/应该有一个继承的 font-size:0; 来自 reset-min.css 中的正文，所以不确定为什么会这样。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T07:30:52.657

在严格的文档类型中，图像成为内联元素，并且表现得像文本。因此，您需要更改其`vertical-align`属性，或将其显示属性更改为`display: block`，或`display:inline-block`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T00:17:09.303

为了排除常见错误，我通过修复不少于 8 个验证错误使代码通过验证。

通常，如果浏览器无法解析给定 DOCTYPE 中的文档，则结果未指定。

它仍然不起作用，但这是验证代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
   <link rel="stylesheet" type="text/css" 
     href="http://yui.yahooapis.com/2.6.0/build/reset/reset-min.css" />
    <title>Required</title>
</head>

<body>

    <div><img src="http://www.catfacts.org/cat-facts.jpg" alt="cat1" /></div>
    <div><img src="http://www.catfacts.org/cat-facts.jpg" alt="cat2" /></div>

</body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T05:56:57.660

display:inline-block 解决方案绝对不适合我。

vertical-align:bottom 解决方案确实有效，但有一个警告：根据情况，有些图像我必须改为设置为 vertical-align:top

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-17T14:04:38.140

切换到宽松的标准而不是严格的标准对我有用……保留了我需要的 IE 格式，但消除了 Firefox 和 Chrome 中奇怪的图像间距。

[https://developer.mozilla.org/en/Gecko%27s_Almost_Standards_Mode](https://developer.mozilla.org/en/Gecko%27s_Almost_Standards_Mode)

使用了这条线：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
```

# linux - 在netfilter中编译多个文件

> ID：489978
> 
> 赞同：0
> 
> 时间：2009-01-29T00:05:27.830
> 
> 标签：linux, kernel, netfilter

如何在内核模块中编译多个文件（调用其他文件中的函数的文件）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T02:25:34.130

我将您的问题解释为，您想将多个编译单元链接到一个模块中吗？

内核源代码本身就有很多这样的例子。它的一般要点是这样`Makefile`写

```
obj-$(CONFIG_FOO) += foo.o
foo-objs: bar.o 
```

这将链接`foo.o`在一起if `bar.o`。有关更详细的说明，请参阅[Linux Kernel Module Programming Guide # Modules Spanning Multiple Files 。](http://tldp.org/LDP/lkmpg/2.6/html/x351.html)`foo.ko``CONFIG_FOO=m`

# sql-server - 如何在 SSIS VBScript 中指定 EOF？

> ID：489979
> 
> 赞同：0
> 
> 时间：2009-01-29T00:05:51.153
> 
> 标签：sql-server, vb.net, ssis, streamreader, script-component

在 SSIS VBScript 中读取直到文件结尾的语法是什么？

```
Dim readFile As FileInfo = New FileInfo(logHourlyName)
If readFile.Exists() Then
   Dim textStream As StreamReader = readFile.OpenText()
   Dim strLine As String
   Do While Not EOF    <--- what goes here?
       curLine = textStream.ReadLine()
   Loop
   textStream.Close()
End If 
```

编辑：我实际上是在尝试获取文件中最后一行的值。因此，读取直到不是 EOF 与读取到文件末尾并不完全相同。但是我删减了很多，以至于我的示例代码很差。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T00:18:19.317

来自[http://msdn.microsoft.com/en-us/library/system.io.streamreader.aspx](http://msdn.microsoft.com/en-us/library/system.io.streamreader.aspx)：

```
Dim readFile As FileInfo = New FileInfo(logHourlyName)
If readFile.Exists() Then
   Dim textStream As StreamReader = readFile.OpenText()
   Dim strLine As String
   Do
       curLine = textStream.ReadLine()
   Loop Until curLine Is Nothing
   textStream.Close()
End If 
```

如果你只想要最后一行：

```
Dim readFile As FileInfo = New FileInfo(logHourlyName)
Dim lastLine As String
If readFile.Exists() Then
   Dim textStream As StreamReader = readFile.OpenText()
   Dim strLine As String
   Do
       curLine = textStream.ReadLine()
       If Not curLine Is Nothing Then lastLine = curLine
   Loop Until curLine Is Nothing
   textStream.Close()
End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-30T19:25:50.010

这是一种只读取最后一行而不遍历整个文件的方法。它走到文件的末尾并开始向后读取，直到遇到另一个 LF 字符，这表示倒数第二行的结尾，然后它只是读入该行。

在具有数百万行的大文件上，这降低了读取几个字节的成本。

您可以取消注释 Dts.Events.FireInformation 代码在输出窗口中发生的事情。

```
 Dim i As Integer
    Dim CurrentByte As Integer
    Dim Trailer As String

    i = 1

    Using reader As StreamReader = New StreamReader("c:\temp\SourceFile.txt")
        Do While CurrentByte <> 10 'while we are not finding the next LF character
           reader.BaseStream.Seek((-1 * i) - 2, SeekOrigin.End) 'seeking backwards from the last position in the file minus the last CRLF
            'Dts.Events.FireInformation(0, "Now at position", reader.BaseStream.Position().ToString, "", 0, False)
            CurrentByte = reader.BaseStream.ReadByte 'read the next byte, this will advance pointer position
            'Dts.Events.FireInformation(0, "Current ASCII Code", CurrentByte & " Character:" & Chr(CurrentByte), "", 0, False)
            i = i + 1 'go to the next character                 
        Loop
        Trailer = reader.ReadLine 'we exited on the LF character, so we are at the beginning of trailer line
        Dts.Events.FireInformation(0, "   Trailer:", Trailer, "", 0, False)
    End Using 
```

# git - 你如何组织你的 git 存储库？

> ID：489988
> 
> 赞同：16
> 
> 时间：2009-01-29T00:08:12.410
> 
> 标签：git, version-control, dvcs, repository

“传统”版本控制系统遵循“大教堂”模型——所有代码都存储在一个主存储库中。

像 git 这样的分布式版本控制系统在组织多个存储库时提供了更大的灵活性。您可以“推送”更改、“拉取”更改和“克隆”存储库。

您是否按照工作组或工作流程组织了存储库？你注意到任何模式了吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-29T00:27:17.850

Scott Chacon，他的 git-fu 非常强大，在[Getting Git](http://en.oreilly.com/rails2008/public/asset/attachment/2816)中有一些很棒的幻灯片。查看第 474-501 页，了解许多解释三种工作流类型的优秀图表：

*   中央存储库模型（svn 风格），
*   独裁者和副手模型（linux内核风格），
*   集成管理器模型（github 风格）。

可以在此处找到所引用幻灯片的完整上下文[Pro Git-5.1 Distributed Git-Distributed Workflows](http://git-scm.com/book/en/Distributed-Git-Distributed-Workflows)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T00:19:26.507

我对 git 还是很陌生，但是我一直在处理这个问题的方式是在我自己的存储库上弄得一团糟，当我进入一个看起来很健康的状态时（至少通过了一些单元测试），我标记它并推送到可公开访问的存储库。

# java - 使用给定的运算符搜索类对象的用法？[蚀]

> ID：489993
> 
> 赞同：0
> 
> 时间：2009-01-29T00:12:46.927
> 
> 标签：java, eclipse

例如，假设我想查找所有将 == 运算符与任何字符串对象一起使用的实例，以便我可以将其替换为 .equals() 。我怎么能做这样的搜索？否则我必须逐行浏览我的所有代码......谢谢:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T00:21:07.533

Eclipse 没有任何特殊的运算符搜索功能。这并不意味着您不能对它们进行文件搜索。

您最好运行[PMD](http://pmd.sourceforge.net/rules/strings.html)来为您查找此类问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T07:31:40.940

FindBugs 也可能对这种类型的编码产生警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T00:27:44.260

在所有文件中搜索“==”和“==”。

CTRL-H -> 文件搜索选项卡

```
Containing text: =="
File name patterns: *.java 
```

然后对字符串 == " 执行相同的操作（注意 == 和 "

# ruby - ruby：如何在另一个对象中引用@foo？

> ID：489994
> 
> 赞同：1
> 
> 时间：2009-01-29T00:13:41.277
> 
> 标签：ruby

在 ruby​​ 中，我想大致执行以下操作并打印出“已更改”：

```
class Whatever
  def change_foo
    @foo="changed"
  end
end

@foo = "original"
o = Whatever.new
o.change_foo
puts "it changed" if @foo == "changed"
puts "it did not change" if @foo == "original" 
```

`Whatever`当然，问题是 inside`@foo`属于 的一个实例`Whatever`。

有没有办法`change_foo`改变“全局” foo？问这个问题的另一种方式可能是“我可以引用什么对象”拥有“ `@foo`？”。

我不想要“使用全局变量”或“使用类变量”或“传递`@foo`给`change_foo`”之类的解决方案。我特别询问上述情况，我无法控制原始变量或`change_foo`调用方式。

我想出了一个解决方法，在构建时传递对全局对象的引用，但我并不对此感到疯狂，因为它需要我在适当的范围内实例化任何东西。

```
class Whatever
  def initialize(main)
    @main = main
  end

  def change_foo
    @main.instance_variable_set("@foo","changed")
  end
end
o = Whatever.new(self) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T00:18:29.753

我知道这是您不想要的答案，但是根据您的描述，您确实应该使用类变量。此外，不可能找到变量的“所有者”，因为具有特定内容（例如，“原始”）的所有字符串都无法区分 - 没有记录它来自哪里（当然，除非 @foo 真的是一个自定义对象，您可以在其中存储对父级的引用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-01T19:12:10.777

迟到了，但您可以将当前上下文传递给方法，然后在该特定上下文中评估实例变量上的操作：

```
class Whatever
  def changeFoo(context)
    eval %q( @foo="changed" ), context
  end
end
@foo = "original"
o = Whatever.new()
o.changeFoo(binding)
puts "it changed" if @foo == "changed"
puts "it did not change" if @foo == "original"

# => it changed 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T00:45:22.087

为什么你想要做这样的事情超出了我的范围......你不应该在你的根对象上定义实例变量，并且不惜一切代价避免使用全局变量。

这说明了您可以实现此目的的一些方法。您可以通过在脚本顶部简单地定义 $self = self 来避免对象空间的东西。

无论如何这里是一些工作示例代码，帮自己一个忙，不要使用它

```
class Whatever
    def changeFoo
        @foo="changed"
    end

    def changeFoo2(o)
      o.instance_variable_set('@foo', 'changed')
    end

    def changeFoo3
      ObjectSpace.each_object do |o| 
        if o.instance_of? Object and o.instance_variables.include?("@foo")
          o.instance_variable_set('@foo', 'changed')
        end
      end
    end
end
@foo = "original"
o = Whatever.new()
o.changeFoo()
puts "it changed" if @foo == "changed"
puts "it did not change" if @foo == "original"

o.changeFoo2(self) 
puts "it changed" if @foo == "changed"
puts "it did not change" if @foo == "original"

@foo = "original" 

o.changeFoo3() 
puts "it changed" if @foo == "changed"
puts "it did not change" if @foo == "original" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T00:59:44.570

我觉得这样做有点傻，但无论如何我都会提出来。似乎三宝有正确的想法。我不知道那个 ObjectSpace 模块。甜的。

我将它包装在一个模块中。

```
module What

  @foo = 'bar'

  class Whatever
    def change_foo
      What.instance_variable_set(:@foo, "changed")
    end
  end

end

w = What::Whatever.new

p What.instance_variable_get(:@foo)    
# >> "bar"

w.change_foo

p What.instance_variable_get(:@foo)
# >> "changed" 
```

# flash - Flash 加载外部文件会冻结页面 - 或 - 多个同时下载

> ID：489997
> 
> 赞同：0
> 
> 时间：2009-01-29T00:15:43.207
> 
> 标签：flash, audio, streaming, mp3, buffer

我的一个网页上有一个 Flash mp3 播放器，用于传输外部音频。以这个网站为例（没有隶属关系，只是一个例子）：

[http://www.1pixelout.net/code/audio-player-wordpress-plugin/](http://www.1pixelout.net/code/audio-player-wordpress-plugin/)

当它是一个大小合适的 mp3 时，一旦我开始播放文件，缓冲需要一点时间。在缓冲时，如果我点击任何其他链接，浏览器会等到缓冲完成后再对我的点击进行操作。在慢速连接上，这很烦人。

想知道是否还有其他人与此作斗争？是否有服务器设置，或技巧（不同的网址？）或明显我缺少的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T08:29:11.403

该插件看起来使用渐进式下载，而不是流式传输。

如果是这种情况，并且您可以访问 Flash 源，我建议确保在先前创建的 Sound 对象上调用[Sound.close()](http://livedocs.adobe.com/flex/3/langref/index.html)方法。

如果您无权访问源并且它是一个与您链接的插件类似的插件，您可能需要与供应商核实这是否是一个错误，因为他们应该确保当前加载的声音是在创建新的之前关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T04:11:02.400

我想到了。使用子域，浏览器将允许同时下载。对于遇到这种情况的其他人...

# python - 将整数列表转换为一个数字？

> ID：489999
> 
> 赞同：73
> 
> 时间：2009-01-29T00:16:23.457
> 
> 标签：python

我有一个整数列表，我想将其转换为一个数字，例如：

```
numList = [1, 2, 3]
num = magic(numList)

print num, type(num)
>>> 123, <type 'int'> 
```

实现*魔术*功能的最佳方法是什么？

**编辑**
我确实找到[了这个](http://bytes.com/groups/python/722951-int-str-list-elements)，但似乎必须有更好的方法。

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-01-29T00:21:26.677

```
# Over-explaining a bit:
def magic(numList):         # [1,2,3]
    s = map(str, numList)   # ['1','2','3']
    s = ''.join(s)          # '123'
    s = int(s)              # 123
    return s

# How I'd probably write it:
def magic(numList):
    s = ''.join(map(str, numList))
    return int(s)

# As a one-liner  
num = int(''.join(map(str,numList)))

# Functionally:
s = reduce(lambda x,y: x+str(y), numList, '')
num = int(s)

# Using some oft-forgotten built-ins:
s = filter(str.isdigit, repr(numList))
num = int(s) 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-01-29T00:23:42.553

两种解决方案：

```
>>> nums = [1, 2, 3]
>>> magic = lambda nums: int(''.join(str(i) for i in nums)) # Generator exp.
>>> magic(nums)
123
>>> magic = lambda nums: sum(digit * 10 ** (len(nums) - 1 - i) # Summation
...     for i, digit in enumerate(nums))
>>> magic(nums)
123 
```

-`map`导向的解决方案实际上在我的盒子上出现了——你绝对不应该使用`sum`可能是大数字的东西：

![时间比较](https://lh3.ggpht.com/_t58Xs7CN35o/SYETlAnN6NI/AAAAAAAABSg/KJetpOdJcKw/s400/image.png)

```
import collections
import random
import timeit

import matplotlib.pyplot as pyplot

MICROSECONDS_PER_SECOND = 1E6
FUNS = []
def test_fun(fun):
    FUNS.append(fun)
    return fun

@test_fun
def with_map(nums):
    return int(''.join(map(str, nums)))

@test_fun
def with_interpolation(nums):
    return int(''.join('%d' % num for num in nums))

@test_fun
def with_genexp(nums):
    return int(''.join(str(num) for num in nums))

@test_fun
def with_sum(nums):
    return sum(digit * 10 ** (len(nums) - 1 - i)
        for i, digit in enumerate(nums))

@test_fun
def with_reduce(nums):
    return int(reduce(lambda x, y: x + str(y), nums, ''))

@test_fun
def with_builtins(nums):
    return int(filter(str.isdigit, repr(nums)))

@test_fun
def with_accumulator(nums):
    tot = 0
    for num in nums:
        tot *= 10
        tot += num
    return tot

def time_test(digit_count, test_count=10000):
    """
    :return: Map from func name to (normalized) microseconds per pass.
    """
    print 'Digit count:', digit_count
    nums = [random.randrange(1, 10) for i in xrange(digit_count)]
    stmt = 'to_int(%r)' % nums
    result_by_method = {}
    for fun in FUNS:
        setup = 'from %s import %s as to_int' % (__name__, fun.func_name)
        t = timeit.Timer(stmt, setup)
        per_pass = t.timeit(number=test_count) / test_count
        per_pass *= MICROSECONDS_PER_SECOND
        print '%20s: %.2f usec/pass' % (fun.func_name, per_pass)
        result_by_method[fun.func_name] = per_pass
    return result_by_method

if __name__ == '__main__':
    pass_times_by_method = collections.defaultdict(list)
    assert_results = [fun([1, 2, 3]) for fun in FUNS]
    assert all(result == 123 for result in assert_results)
    digit_counts = range(1, 100, 2)
    for digit_count in digit_counts:
        for method, result in time_test(digit_count).iteritems():
            pass_times_by_method[method].append(result)
    for method, pass_times in pass_times_by_method.iteritems():
        pyplot.plot(digit_counts, pass_times, label=method)
    pyplot.legend(loc='upper left')
    pyplot.xlabel('Number of Digits')
    pyplot.ylabel('Microseconds')
    pyplot.show() 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-29T02:04:01.117

```
def magic(number):
    return int(''.join(str(i) for i in number)) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-29T00:23:31.710

```
def magic(numbers):
    return int(''.join([ "%d"%x for x in numbers])) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-29T23:26:56.140

为了完整起见，这里有一个使用的变体`print()`（适用于 Python 2.6-3.x）：

```
from __future__ import print_function
try: from cStringIO import StringIO
except ImportError:
     from io import StringIO

def to_int(nums, _s = StringIO()):
    print(*nums, sep='', end='', file=_s)
    s = _s.getvalue()
    _s.truncate(0)
    return int(s) 
```

## 不同解决方案的时间性能

我已经测量了[@cdleary 函数的](https://stackoverflow.com/questions/489999/python-convert-list-of-ints-to-one-number#490031)性能。结果略有不同。

每个函数都使用以下生成的输入列表进行测试：

```
def randrange1_10(digit_count): # same as @cdleary
    return [random.randrange(1, 10) for i in xrange(digit_count)] 
```

`--sequence-creator=yourmodule.yourfunction`您可以通过命令行参数提供您自己的函数（见下文）。

对于列表 ( ) 中给定数量的整数，最快的函数`len(nums) == digit_count`是：

*   `len(nums)`在**1..30**

    ```
    def _accumulator(nums):
        tot = 0
        for num in nums:
            tot *= 10
            tot += num
        return tot 
    ```

*   `len(nums)`在**30..1000**

    ```
    def _map(nums):
        return int(''.join(map(str, nums)))

    def _imap(nums):
        return int(''.join(imap(str, nums))) 
    ```

![图：N = 1000](https://i.stack.imgur.com/0Wkhe.png)

```
|------------------------------+-------------------|
| Fitting polynom              | Function          |
|------------------------------+-------------------|
| 1.00  log2(N)   +  1.25e-015 | N                 |
| 2.00  log2(N)   +  5.31e-018 | N*N               |
| 1.19  log2(N)   +      1.116 | N*log2(N)         |
| 1.37  log2(N)   +      2.232 | N*log2(N)*log2(N) |
|------------------------------+-------------------|
| 1.21  log2(N)   +      0.063 | _interpolation    |
| 1.24  log2(N)   -      0.610 | _genexp           |
| 1.25  log2(N)   -      0.968 | _imap             |
| 1.30  log2(N)   -      1.917 | _map              | 
```

![图：N = 1000_000](https://i.stack.imgur.com/VmZVb.png)

要绘制第一个图形下载[`cdleary.py`并`make-figures.py`](http://gist.github.com/51074)运行（`numpy`并且`matplotlib`必须安装才能绘制）：

```
$ python cdleary.py 
```

或者

```
$ python make-figures.py --sort-function=cdleary._map \
> --sort-function=cdleary._imap \
> --sort-function=cdleary._interpolation \
> --sort-function=cdleary._genexp --sort-function=cdleary._sum \
> --sort-function=cdleary._reduce --sort-function=cdleary._builtins \
> --sort-function=cdleary._accumulator \
> --sequence-creator=cdleary.randrange1_10 --maxn=1000 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-29T00:22:17.343

伪代码：

```
int 魔法（列出数字）
{
  整数 = 0

  而 (!nums.isEmpty())
  {
    int 数字 = nums.takeFirst()
    总计 *= 10
    总数 += 数字
  }

  返回
}
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-29T03:31:57.943

只要列表中的每个元素只有一个数字，此方法就可以在 2.x 中使用。但是您实际上不应该使用它。这太糟糕了。

```
>>> magic = lambda l:int(`l`[1::3])
>>> magic([3,1,3,3,7])
31337 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-29T03:37:16.750

使用生成器表达式：

```
def magic(numbers):
    digits = ''.join(str(n) for n in numbers)
    return int(digits) 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-05-26T03:52:47.030

单线，无需往返`str`

```
def magic(num):
    return sum(e * 10**i for i, e in enumerate(num[::-1])) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-12-16T10:39:42.583

如果列表仅包含整数：

```
reduce(lambda x,y: x*10+y, list) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-29T02:34:59.213

这对我来说似乎很干净。

```
def magic( aList, base=10 ):
    n= 0
    for d in aList:
        n = base*n + d
    return n 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-12-07T11:31:36.853

我发现一些示例与 python 3 不兼容我从@Triptych 测试了一个

`s = filter(str.isdigit, repr(numList))` `num = int(s)`

在 python 3 中它会给出错误

`TypeError: int() argument must be a string, a bytes-like object or a number, not 'filter'`

我认为更简单和兼容的方式是

```
def magic(num_list):
    return int("".join(map(str, num_list))) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-02-27T06:07:20.193

这可能会有所帮助

```
def digits_to_number(digits):
    return reduce(lambda x,y : x+y, map(str,digits))

print digits_to_number([1,2,3,4,5]) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-03-07T17:58:32.130

如果您碰巧使用 numpy (with `import numpy as np`)：

```
In [24]: x
Out[24]: array([1, 2, 3, 4, 5])

In [25]: np.dot(x, 10**np.arange(len(x)-1, -1, -1))
Out[25]: 12345 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-07-14T13:57:59.657

我在尝试根据 C 样式指针将列表转换为底层 int 的实际值时发现了这个线程，但其他答案似乎都不适用于这种情况。我认为以下解决方案按预期工作并且可能对其他人有用，即使它不一定回答原始问题。

```
def listToInt(x, reverseBytes=False):
  if reverseBytes:
    x = x[::-1]
  return reduce(lambda x,y: x*256+y, x) 
```

`listToInt([1, 249]) == 505`

`listToInt([249, 1], True) == 505`

这样做的主要价值是模拟将字节数组转换为另一种数据类型的行为，例如 uint16，Python 在大端或小端系统上似乎无法原生地做到这一点。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-08-21T20:40:39.577

为时已晚，这里的聚会是没有转换为字符串的方法

```
x=0
k=len(a)-1
for i in a:
    x+=(10**k)*i
    k-=1 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-04-17T23:37:11.980

我认为这似乎是最简单的解决方案**，不需要任何 fcn**

```
res = int(''.join(numList)) 
```

注意：此实现在 Python 3 中

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-07-22T02:27:53.717

希望这个单行公式也有用：

```
s=sum([numlist[i] * 10**(len(numlist)-i-1) for i in range(len(numlist))]) 
```*****************