# StackOverflow 问答 10097000-10097999

# mysql - 为什么我在连接两个表的 MYSQL 查询中得到不正确的 SUM？

> ID：10097003
> 
> 赞同：0
> 
> 时间：2012-04-10T21:53:08.360
> 
> 标签：mysql

简单的工作查询，列出每种许可证类型的许可证数量：

询问：

```
SELECT
  COUNT(licenses.licenseID) AS total
FROM
  licenses
GROUP BY
  licenses.licensetypeID 
```

结果：

```
total
=====
389
 14
  2
  5
  3
  1
  1 
```

现在我想总结一下许可证的利润。一个表`transactions`包含来自 PayPal 的所有交易。我`mc_gross`用来总结。有时会有退款，所以`mc_gross`是负数，交易比许可证多。

在我当前的数据库中，四个许可证被删除，因为交易已退还。

我的尝试：

```
SELECT
  COUNT(licenses.licenseID) AS total,
  SUM( transactions.mc_gross ) AS gross
FROM
  licenses
  LEFT JOIN transactions ON licenses.txn_id = transactions.txn_id
GROUP BY
  licenses.licensetypeID 
```

结果：

```
393     9020.00
 14     NULL
  2     NULL
  5     NULL
  3     100.00
  1     NULL
  1     NULL 
```

请注意，第一个许可证类型现在总共比第一个查询多四个。由此我推断它正在计算事务表中的额外行。但我不明白为什么，因为我认为 a`LEFT JOIN`会获取左表的所有行`licenses`并连接到任何可用`transactions`的 .

阅读不同的连接，我无法理解它们以产生我想要的结果。

我在做不正确的加入吗？还是我按错误的值分组？

请注意，我确实想列出所有许可证类型 - 即使它们的总和为零。

（让我知道是否需要整个表格结构 - 我跳过它以避免使问题过长。我希望包括所有相关信息。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T21:55:40.217

可能有多个事务具有相同的`TXN_ID`. 在这种情况下，加入将在每个匹配的事务中列出一次相同的许可证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:00:44.647

如果退款在交易表中输入为负数，则不应删除原始交易。两者都需要存在才能使总余额为 0。由于您看到的交易比您想象的多 4 笔，并且您知道有 4 笔退款，我会说原始交易和退款交易都在交易表中，他们应该是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T22:15:24.123

感谢我得到的评论，我设法创建了一个产生正确结果的查询：

```
SELECT
  COUNT( distinct licenses.licenseID ) AS total,
  SUM( temp.mc_gross / temp.quantity ) AS gross
FROM
  licenses
  LEFT JOIN
    ( SELECT txn_id, mc_gross, quantity
      FROM transactions
      WHERE valid = 'VERIFIED-PAID'
    ) AS temp ON licenses.txn_id = temp.txn_id
GROUP BY
  licenses.licensetypeID 
```

正确数据：

```
total   gross
===================
389     7780.000000
 14     NULL
  2     NULL
  5     NULL
  3     60.000000
  1     NULL
  1     NULL 
```

更新 - 改进的查询：

```
SELECT
  COUNT( licenses.licenseID ) AS total,
  SUM( transactions.mc_gross / transactions.quantity ) AS gross
FROM
  licenses
  LEFT JOIN transactions ON licenses.txn_id = transactions.txn_id AND transactions.valid = 'VERIFIED-PAID'
GROUP BY
  licenses.licensetypeID 
```

# powershell - 结合 powershell 命令

> ID：10097005
> 
> 赞同：1
> 
> 时间：2012-04-10T21:53:29.180
> 
> 标签：powershell, powershell-2.0, powershell-remoting

伙计们，我有这个独特的问题，并且一直在寻找答案。我基本上有两个很好的运行脚本，但我需要将它们结合起来。由于某种原因，这不起作用，我收到所有类型的语法 powershell 错误。

第一个正常工作的脚本。请参阅下面的第二个脚本

```
Get-Content c:\list.txt | foreach {
    Get-Mailboxstatistics -id $_ | foreach{
        $mbx = $_ | select DisplayName, @{Label=’MailboxSize("MB")’;Expression={$_.TotalItemSize/1MB}}, ItemCount
        $date_captured=get-date | select datetime

        Get-Mailbox -id $_ | foreach{
            $mbx | add-member -type noteProperty -name Alias -value $_.Alias
            $mbx | add-member -type noteProperty -name ServerName -value $_.ServerName
            $mbx | add-member -type noteProperty -name ProhibitSendReceiveQuota -value $.ProhibitSendReceiveQuota 
            $mbx | add-member -type noteProperty -name UseDatabaseQuotaDefaults -value $.UseDatabaseQuotaDefaults 
            $mbx | add-member -type noteProperty -name IssueWarningQuota -value $_.IssueWarningQuota
        } $mbx, $date_captured

    }

} 
```

这是运行的第二个命令。这本身就很好用，并再次尝试

将它与上面的命令结合起来失败。

```
get-mailboxfolderstatistics -id "alias" | select name, foldersize, itemsinfolder 
```

现在我想要完成的是让我的输出如下所示。

> DisplayName MailboxSize("MB") ItemCount
> Alias ServerName
> ProhibitSendReceiveQuota UseDatabaseQuotaDefaults IssueWarningQuota
> 
> 日期时间：2012 年 4 月 10 日星期二下午 4:04:28
> 
> 名称 Foldersize Itemsinfolder topofinfromationstore 0 3 日历
> 1234 54 收件箱 1024785 241 已发送项目 14745 54 已删除项目 5414745 875

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:38:57.453

您可以使用`Out-File`记录这两个命令的输出，例如：

```
<first-command> | Out-File c:\log.txt
<second-command> | Out-File c:\log.txt -Append 
```

或者，如果您更喜欢重定向运算符：

```
<first-command>   > c:\log.txt
<second-command> >> c:\log.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T18:04:10.893

如果我遵循您的问题，我认为您想要做的是结合两个命令的结果，以便最终得到一个新对象。此代码将使用您似乎想要的值将自定义对象写入管道。要保存到文件，请运行您的脚本并将其通过管道传输到 Out-File 或其他任何内容。

```
Get-Content c:\list.txt | foreach {
Get-Mailboxstatistics -id $_ | foreach-object {
    #define a hash table of properties
    $size=($_.TotalItemSize)/1MB
    $props=@{
    MailboxSizeMB=$size;
    Displayname=$_.DisplayName;
    ItemCount=$_.ItemCount;
    DateCaptured=Get-Date;
    } #close hash

    Get-Mailbox -id $_ | foreach-object {
        $props.Add("Alias",$_.Alias)
        $props.Add("ServerName",$_.ServerName)
        $props.Add("ProhibitSendReceiveQuota",$_.ProhibitSendReceiveQuota)
        $props.Add("UseDatabaseQuotaDefaults",$_.UseDatabaseQuotaDefaults)
        $props.Add("IssueWarningQuota",$_.IssueWarningQuota)
    } #foreach mailbox

    #write a custom object
    New-Object -TypeName PSObject -Property $props

} #foreach mailboxstatistic 
```

} #foreach 内容

# android - Android画布地理点线绘制

> ID：10097006
> 
> 赞同：1
> 
> 时间：2012-04-10T21:53:34.110
> 
> 标签：android, gps, drawing, line, android-canvas

我正在开发一个 android 应用程序，它允许用户跟踪他们的路线并将其显示给他们。我有一个使用 gps 的地图视图，找到一个用户位置，将每个位置保存到一个数组列表中，并在覆盖层上的每个点上画线，所有这些在实际的谷歌地图上都可以正常工作。但是，我想使用 androids 的画布功能创建更详细的视图。画布显示（作为绿色背景），但当我尝试在地理点数组列表之间绘制时，线条（和点）不显示。我通过调用内部类将内容视图设置为画布，如下所示：

```
setContentView(new SimulationDraw(this));

this.setRequestedOrientation(
ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
paint = new Paint(Color.LTGRAY); 
```

这是有问题的课程：

```
class SimulationDraw extends View {
    private ColourGeoPoint firstPoint;
    private Object lastCGP;
    private int lastCGPLong;
    private int lastCGPLat;

    public SimulationDraw(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
        firstPoint = null;
    }

    @Override
    public void onDraw(Canvas canvas) {
        canvas.drawColor(Color.GREEN);

        paint.setColor(Color.LTGRAY);
        paint.setStrokeWidth(20);
        paint.setStyle(Paint.Style.STROKE); 

        for(ColourGeoPoint point : trackOverlay.geoPointsArray){
            int loclat = point.getGeoLocation().getLatitudeE6();
            System.out.println("LOCLAT" + loclat);
            int loclong = point.getGeoLocation().getLongitudeE6();
            System.out.println("LOCLONG" + loclong);

            canvas.drawPoint(loclat, loclong, paint);
            if (lastCGP == null) {
                lastCGP = point;
                lastCGPLat = point.getGeoLocation().getLatitudeE6();
                System.out.println("LASTCGPLAT" + lastCGPLat);
                lastCGPLong = point.getGeoLocation().getLongitudeE6();
                System.out.println("LASTCGPLONG" + lastCGPLong);
            } else {
                Path path = new Path();
                path.moveTo(loclat,loclong);
                path.lineTo(lastCGPLat, lastCGPLong);
                canvas.drawLine(loclat, loclong, lastCGPLat, lastCGPLong, paint);
                canvas.drawPoint(loclat, loclong, paint);
                lastCGP = point;
            }
        } 
```

所以我的问题是，我哪里出错了？我插入了一些打印语句并尝试绘制画布和点，但除了绿色背景之外什么都没有显示。我没有运行时错误。

作为旁注，打印语句按预期显示地理点。我是否需要以某种方式将地理点转换为屏幕点？我也在地图视图的顶部画了这个，这可能与它为什么根本不起作用有关吗？

提前谢谢了。

# python - 使用 Python 生成二叉搜索树和数据

> ID：10097012
> 
> 赞同：0
> 
> 时间：2012-04-10T21:54:03.893
> 
> 标签：python, recursion, tree, binary-tree, binary-search-tree

我有一个二叉树函数，每个节点中有 3 条数据。它们按身份证号分类。他们还持有“姓名”和“标记”

我遇到的某个功能是名称搜索功能，它看起来像这样：

```
def findName(tree,name):
    if tree==None:
        return None
    elif tree['name']==name:
        return True
    else:
        findName(tree['right'],name)
        findName(tree['left'],name) 
```

我总是可以在一棵树上找到第一个名字，但我找不到任何以后的名字。如果我`findName(tree['right'],name)`在 python idle 中输入，如果名称在树中，我会得到 true。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T21:56:04.370

函数实际返回一些数据的唯一方法是它本身是否使用`return`语句。您的`else:`套件不包含任何`return`语句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T22:07:42.983

在其他方面，您必须执行以下操作：

```
return findName(tree['right'],name) or findName(tree['left'],name) 
```

以便它在两个分支中搜索，如果在其中任何一个分支中找到它，则返回值将为 True

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T22:51:00.207

我相信有可用的开源二叉搜索树模块；如果您的目标是了解 BST，请务必自己编写，但如果您正在研究适合开源的东西，您可能想尝试一个已经过测试和调试的预制模块。

[我在http://stromberg.dnsalias.org/~strombrg/treap/](http://stromberg.dnsalias.org/~strombrg/treap/)有类似 Python 的 BST 。它实际上是 BST 的一种变体，它不需要以随机顺序将密钥提供给 BST - 它使用每个节点上的随机值来分散事物。对程序员来说，它看起来像一个字典，除了当你迭代它们时，键返回排序，并且查找不如字典（哈希）快。

我相信，Treaps 是在 80 年代后期发现的，所以它们是相对较新的 CS。它们是一个非常全面的数据结构；您访问相同数据的不同方式越多，您就越有可能陷入陷阱。

实际上，根据您的描述，您甚至可以通过字典（哈希表）更好地为您服务，其中键是您的姓名。

# java - Android中乐谱图像上的线条检测

> ID：10097013
> 
> 赞同：8
> 
> 时间：2012-04-10T21:54:04.727
> 
> 标签：java, android, image-processing, opencv, rotation

我正在研究关于光学音乐识别的 Android 项目。我通过手机相机拍了一张乐谱照片，并尝试识别音符和符号。我对预处理后的方法非常熟悉，但这类工作通常是在扫描仪的帮助下完成的。（相反我必须使用移动相机）

直观地说，我首先使用霍夫变换来检测五线谱（五线谱），然后计算它们与水平轴之间的角度，并将图像旋转到角度。这在理论上可行，但霍夫发现线段和这些线段的角度不一致。所以它不起作用。（可能是因为透视的影响）

之后，我尝试了许多边缘检测和寻线算法，但没有一个能稳定运行。（包括频域旋转和线段检测器）

现在我正在考虑一种类似于 Android 上的文档扫描仪的新方法。我尝试将我的图像转换为扫描文档之类的形式。我想将我的图像与水平轴对齐并消除由于倾斜和透视而产生的效果。

我想知道是否有人对如何实现这种“文档扫描”有任何想法。或者，如果您对对齐文档或稳定线检测有任何想法，这对我未来的工作会很有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T12:01:14.867

您可以简单地测量板材左侧和右侧的顶部或底部板条的高度，并据此计算角度。唯一的困难可能是找到一个自动测量高度的好点（即找到垂直扫描五线谱的列）。使其健壮的一种方法是检查 6 个或许多连续的黑色像素，这些像素由接近恒定宽度的白色区域隔开。当您发现这一点时，您可以确定没有偏离测量值的杂散音符或符号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T23:09:18.933

您应该首先消除相机失真：

[http://en.wikipedia.org/wiki/Distortion_(optics)#Software_correction](http://en.wikipedia.org/wiki/Distortion_(optics)#Software_correction)

接下来，按照openOMR的实现方式，你可以使用下面这段代码进行FFT，以求出整个图像倾斜的角度：

[http://www.koders.com/java/fid38ED5C64ADB6C4F5F01FB05FB08744AF159A8244.aspx?s=FFT#L23](http://www.koders.com/java/fid38ED5C64ADB6C4F5F01FB05FB08744AF159A8244.aspx?s=FFT#L23)

# javascript - 使用 CSS 和/或 JavaScript/jQuery 在行和列中排列 s 列表

> ID：10097014
> 
> 赞同：-2
> 
> 时间：2012-04-10T21:54:04.787
> 
> 标签：javascript, jquery, html, css

**输入：**包含在父跨度中的未知数量的跨度元素列表。例如

```
<span id="parent">
<span id="child-1">1</span>
<span id="child-2">2</span>
<span id="child-3">3</span>
<span id="child-4">4</span>
<span id="child-5">5</span>
<span id="child-6">6</span>
<span id="child-7">7</span>
<span id="child-8">8</span>
<span id="child-9">9</span>
<span id="child-10">10</span>
...
...
...
</span> 
```

**输出：**使用 CSS 类和/或 JavaScript/jQuery，而不`<span>`在父跨度内添加 s（为了将子跨度分成组）-我想让子跨度被渲染-**垂直和水平**-在 N 行和 M 列中。N 和 M 应该经常更改，因此我不能使用将 html 元素添加到父跨度以将子跨度分成组的解决方案。

例如，如果我有 12 个子跨度并且 N(rows)=4 和 M(columns)=3，那么在浏览器中我应该看到：

水平顺序：

```
1 2 3
4 5 6
7 8 9
10 11 12 
```

垂直顺序：

```
1 5 9
2 6 10
3 7 11
4 8 12 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:39:25.523

首先，在静态样式块中将内部跨度的浮动样式设置为“左”。您还必须给它们一个恒定的宽度以让它们适合列。

```
<style type="text/css">
    #parent span { float: left; display: block; width: 100px; }
</style> 
```

然后，您可以通过以正确的顺序将它们重新附加到父元素并动态地将清除样式更改为单独的行来重新排列 JavaScript 中的跨度。这是我的示例代码：

```
function makeHorizontalOrder(rows, cols)
{
    var parent = document.getElementById("parent");
    for (var row = 0; row < rows; ++row)
    {
        for (var col = 0; col < cols; ++col)
        {
            var index = 1 + col + row * cols;
            var span = document.getElementById("child-" + index);
            if (span)
            {
                span.style.clear = col ? "none" : "left";
                parent.appendChild(span);
            }
        }
    }
}

function makeVerticalOrder(rows, cols)
{
    var parent = document.getElementById("parent");
    for (var row = 0; row < rows; ++row)
    {
        for (var col = 0; col < cols; ++col)
        {
            var index = 1 + row + col * rows;
            var span = document.getElementById("child-" + index);
            if (span)
            {
                span.style.clear = col ? "none" : "left";
                parent.appendChild(span);
            }
        }
    }
} 
```

请注意，这两个函数仅在指数计算上有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T00:51:13.627

列是用纯 CSS 完成的，顺序可以用 javascript 完成。

给每个跨度一个固定宽度，然后将父跨度设置为一个固定宽度，使其他跨度保持在所需数量的“列”中。

```
<style type="text/css">
#parent {
  display: block;
  width: 5em;
  border: 1px solid red
}

#parent span {
  width: 1.3em;
  border: 1px solid blue;
}
</style>

<span id="parent">
  <span id="0">0</span>
  <span id="1">1</span>
  <span id="2">2</span>
  <span id="3">3</span>
  <span id="4">4</span>
  <span id="5">5</span>
  <span id="6">6</span>
  <span id="7">7</span>
  <span id="8">8</span>
  <span id="9">9</span>
  <span id="10">10</span>
  <span id="11">11</span>
</span> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T06:06:49.893

好吧，这是水平的最简单的解决方案

```
$('#parent').css('text-align','left').children().each(function(i){if((i+1)%3==0) $(this).after('<br>')}) 
```

除了 ft1 提供的垂直解决方案之外，还有其他解决方案.....

# python - easygui中的滚动条？

> ID：10097017
> 
> 赞同：1
> 
> 时间：2012-04-10T21:54:23.207
> 
> 标签：python, scrollbar, easygui

有没有什么方法可以使用 easygui 模块或它的修改版本来获得滚动条？我在网上找到了一个名为thinking_py.txt的文件，将其转换为python格式后，发现它确实有一个带有滚动条的easygui版本。但是，根据启动器的说法，至少该模块充满了语法错误。我不想太乱搞它，那我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:53:35.560

您可能参考了`thinking.py`Steve Ferg 的应用程序，这是他[在 Tkinter 中思考](http://thinkingtkinter.sourceforge.net/)的工作的一部分。

我刚刚下载了它，它就像一个魅力。

不确定问题出在哪里，但我不会一直把责任归咎于 Ferg 的语法错误。因此，我对您的问题的建议是您花一些时间**学习**tkinter。你可以在 Tkinter 中使用你已经拥有的相同的 Thinking 来做到这一点。

忘记 EasyGui，它是 tkinter 的一个包装器，为了简单起见，它从你那里窃取了一些基本的东西，比如**选择框架大小的能力**，这是人们想要对占据大部分框架的框架做的第一件事屏幕。

在 Ferg 的网站上，还有其他有趣的学习 tkinter 的链接。

最后，这是[文本控件中滚动条](http://effbot.org/zone/tkinter-scrollbar-patterns.htm)所需要的：

```
from Tkinter import *

root = Tk()

scrollbar = Scrollbar(root)
scrollbar.pack(side=RIGHT, fill=Y)

text = Text(root, wrap=WORD, yscrollcommand=scrollbar.set)
text.pack()

data = 'I will study some tkinter\n'
for i in range(100):
    text.insert(END, data)

scrollbar.config(command=text.yview)

mainloop() 
```

![在此处输入图像描述](../Images/48854d9f030ad5f74598c29acfbec315.png)

# ruby-on-rails-3 - 通过 jquery 渲染表单禁用 :remote => true

> ID：10097021
> 
> 赞同：1
> 
> 时间：2012-04-10T21:54:42.573
> 
> 标签：ruby-on-rails-3

在 app/views/alerts/_form.html.erb 我有表单（我设置了@alert = Alert.new）

```
<%= form_for( @alert, :remote => true ) do |f| %>
... 
```

这工作正常，当我点击提交时，我得到

*由 AlertsController#create as JS 处理*

我最终进入 app/views/alerts/create.js.erb。

但是，如果我通过 JQuery 调用呈现表单， :remote => true 似乎被遗忘了。

```
$("div.new_alert").html( "<%= escape_javascript( render( :partial => "alerts/form" ) ) %>" ); 
```

现在，当我点击提交时，我得到

*由 AlertsController#create 作为 HTML 处理*

并运行 format.html 操作。

如何通过 JQuery 呈现表单并仍然以 JS 进行处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T22:57:49.823

从 Rails 3.0 升级到 3.1 时问题消失了。我不确定 3.0 的问题是什么，但很可能我对 javascript_include_tag 很草率，所以 JQuery 可能以某种方式被部分破坏了。升级时我清理了javascript_include_tag，现在我没有问题了。

# vim - 跳过vim中的右括号

> ID：10097022
> 
> 赞同：1
> 
> 时间：2012-04-10T21:54:45.523
> 
> 标签：vim, parentheses

我想设置 vim，以便如果我在右括号上按制表符，它会向右移动光标。这在与自动完成括号一起使用时很有用。

这是我到目前为止所拥有的（不起作用）：

```
inoremap <expr> <Tab> strpart(getline('.'), col('.')-1, 1) == "}" ? "\<Right>" : "\<Tab>"
inoremap <expr> <Tab> strpart(getline('.'), col('.')-1, 1) == ")" ? "\<Right>" : "\<Tab>"
inoremap <expr> <Tab> strpart(getline('.'), col('.')-1, 1) == "]" ? "\<Right>" : "\<Tab>" 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T02:26:58.637

一个键只能有一个工作映射（您可以定义至少两个：缓冲区本地（每个缓冲区一个）和一个全局，但它们不能同时工作），所以您需要这样的东西：

```
inoremap <expr> <Tab> stridx('])}', getline('.')[col('.')-1])==-1 ? "\t" : "\<Right>" 
```

不要使用`strpart()`,`string[idx1:idx2]`工作正常（所有`idx1`, `idx2`,`:`都是可选的，但至少必须存在一个），打字更少，可读性更强。

# unix - PIPE_BUF 是否适用于命名管道（也称为 FIFO）？

> ID：10097029
> 
> 赞同：1
> 
> 时间：2012-04-10T21:55:14.717
> 
> 标签：unix, concurrency, buffer, named-pipes

我今天读到的关于 UNIX 管道的内容：

> 如果多个进程正在写入单个管道，那么如果它们一次写入不超过 PIPE_BUF 字节，则可以保证它们的数据不会混合。

它是否适用于也称为 FIFO 的命名管道？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T21:57:03.413

是的，FIFO 在这方面表现得像管道，并且 POSIX 声明 PIPE_BUF 适用于它们。

# ravendb - 如何搜索数字介于 2 个值之间的文档？

> ID：10097037
> 
> 赞同：4
> 
> 时间：2012-04-10T21:55:43.447
> 
> 标签：ravendb

我正在使用 Advanced.LuceneQuery 例如

```
RavenQueryStatistics stats = null;
vm.Products = DocumentSession.Advanced.LuceneQuery<Product>("Products/Index")
            .Statistics(out stats)
            .Where(searchExpression)
            .OrderBy(columnToSortBy)
            .Skip((vm.PageIndex - 1) * vm.PageSize)
            .Take(vm.PageSize)
            .ToArray()
            ; 
```

有了这个索引

```
public Products_Index()
{
    Map = products => from p in products
                      select new
                      {
                          p.ItemNum,
                          p.BrandName,
                          p.ProductName,
                          p.Catalog,
                          p.UOM,
                          p.CasePack,
                          p.AveWeight,
                          p.CatalogId,
                          p.HasPicture,
                          p.INFO2,
                          p.IsOfflineSupplierItem,
                          p.IsRebateItem,
                          p.IsSpecialOrderItem,
                          p.IsSpecialPriceItem,
                          p.Price
                      };

    Indexes.Add(x => x.INFO2, FieldIndexing.Analyzed);
    Indexes.Add(x => x.CatalogId, FieldIndexing.Analyzed);
    Indexes.Add(x => x.HasPicture, FieldIndexing.Analyzed);
    Indexes.Add(x => x.IsOfflineSupplierItem, FieldIndexing.Analyzed);
    Indexes.Add(x => x.IsRebateItem, FieldIndexing.Analyzed);
    Indexes.Add(x => x.IsSpecialOrderItem, FieldIndexing.Analyzed);
    Indexes.Add(x => x.IsSpecialPriceItem, FieldIndexing.Analyzed);
    Indexes.Add(x => x.Price, FieldIndexing.Analyzed);
} 
```

并且要执行的典型表达式如下所示

```
"INFO2:(blue*) AND INFO2:(pen*) AND HasPicture:(True) AND IsSpecialOrderItem:(True) AND IsRebateItem:(True) AND IsOfflineSupplierItem:(True) AND CatalogId:(736275001)" 
```

现在我需要合并基于价格列/索引的范围搜索。构造我的 where 子句的那部分的语法是什么？

要求是

价格 >= FromNumber 价格 <= ToNumber

**编辑：构造 where 子句的方法**

```
private void ProductSearch(ProductSearchViewModel vm)
{

    var terms = vm.SearchTerm
        .ToLower()
        .Split(new char[] { ' ' });

    // Start buildeing up the query
    var sb = new StringBuilder();

    // terms
    foreach (string term in terms)
    {
        sb.AppendFormat("INFO2:({0}*) AND ", term);
    }

    if (vm.Filters != null)
    {

        // picture 
        if (vm.Filters.IsAtrFilterPictureSelected)
        {
            sb.AppendFormat("HasPicture:({0}) AND ", vm.Filters.IsAtrFilterPictureSelected);
        }
        // special order
        if (vm.Filters.IsAtrFilterSpecialOrderSelected)
        {
            sb.AppendFormat("IsSpecialOrderItem:({0}) AND ", vm.Filters.IsAtrFilterSpecialOrderSelected);
        }
        // special price
        if (vm.Filters.IsAtrFilterSpecialPriceSelected)
        {
            sb.AppendFormat("IsSpecialPriceItem:({0}) AND ", vm.Filters.IsAtrFilterSpecialPriceSelected);
        }
        // rebate
        if (vm.Filters.IsAtrFilterRebateSelected)
        {
            sb.AppendFormat("IsRebateItem:({0}) AND ", vm.Filters.IsAtrFilterRebateSelected);
        }
        // offline supplier
        if (vm.Filters.IsAtrFilterOfflineItemSelected)
        {
            sb.AppendFormat("IsOfflineSupplierItem:({0}) AND ", vm.Filters.IsAtrFilterOfflineItemSelected);
        }
        // catalog
        if (vm.Filters.CatalogSelected > 0)
        {
            sb.AppendFormat("CatalogId:({0}) AND ", vm.Filters.CatalogSelected);
        }
        // price range
        if (vm.Filters.PriceFrom > 0 && vm.Filters.PriceTo > 0)
        {
            sb.AppendFormat("Price_Range:[{0} TO {1}]", NumberUtil.NumberToString((double)vm.Filters.PriceFrom), NumberUtil.NumberToString((double)vm.Filters.PriceTo));
        }

    }

    // remove the last 'AND' from the string 
    var searchExpression = sb.ToString();
    if (searchExpression.EndsWith("AND "))
    {
        searchExpression = searchExpression.Substring(0, searchExpression.LastIndexOf("AND "));
    }

    // trace it out
    Logger.WriteMessage(Infrastructure.Logging.LogLevel.Info, "Search Term: " + searchExpression);

    Stopwatch watch = Stopwatch.StartNew();

    string columnToSortBy = string.Empty;
    if (vm.GridParams != null)
    {
        // Luncene specific way of ordering
        columnToSortBy = vm.GridParams.sidx ?? "Price";
        columnToSortBy = vm.GridParams.sord == "asc" ? "+" + columnToSortBy : "-" + columnToSortBy;
    }

    // execution of query
    RavenQueryStatistics stats = null;
    vm.Products = DocumentSession.Advanced.LuceneQuery<Product>("Products/Index")
                .Statistics(out stats)
                .Where(searchExpression)
                .OrderBy(columnToSortBy)
                .Skip((vm.PageIndex - 1) * vm.PageSize)
                .Take(vm.PageSize)
                .ToArray()
                ;

    watch.Stop();
    vm.TotalResults = stats.TotalResults;
    Logger.WriteMessage(Infrastructure.Logging.LogLevel.Info, "Search Time: " + watch.ElapsedMilliseconds);

} 
```

谢谢你，斯蒂芬

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T22:09:54.207

你需要这样的东西（注意“_Range”）：

```
Price_Range:[FromNumber TO ToNumber] 
```

有关完整信息，请参阅 Lucene[查询语法](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_0/queryparsersyntax.html#Range%20Searches)文档。您还需要以正确的十六进制格式输入数字。[确保您使用 Raven.Abstractions 命名空间中NumberUtils 类](https://github.com/ayende/ravendb/blob/master/Raven.Abstractions/Indexing/NumberUtil.cs)中的内置函数为您执行此操作，而不是您自己执行此操作。

**但是**，您是否有理由使用低级 Lucene API 并手动构建查询？有一个支持 LINQ 的强类型 API 可以为您完成很多工作（`session.Query<T>()`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-11T05:43:26.627

重申马特的评论。您真的希望避免手动构建查询。Lucene Query API 有一个方法 WhereBetween 可以为您完成所有工作。请注意，那里有很多魔法，比如参数格式化等，你真的想考虑。

# c# - Windows 7 中的鼠标移动 - 左键单击并拖动

> ID：10097048
> 
> 赞同：2
> 
> 时间：2012-04-10T21:56:14.817
> 
> 标签：c#, .net, winforms, mouse, user32

我试图通过在 Windows 7 中使用 user32.dll 模拟鼠标移动和点击来自动绘制类似于绘图的程序。

这是我所拥有的以及我如何使用它：

## 设置

```
 [DllImport("user32.dll")]
    static extern void mouse_event(int dwFlags, int dx, int dy, int dwData, int dwExtraInfo);

    [Flags]
    public enum MouseEventFlags
    {
        LEFTDOWN = 0x00000002,
        LEFTUP = 0x00000004,
        MIDDLEDOWN = 0x00000020,
        MIDDLEUP = 0x00000040,
        MOVE = 0x00000001,
        ABSOLUTE = 0x00008000,
        RIGHTDOWN = 0x00000008,
        RIGHTUP = 0x00000010
    }

    public void LeftMouseDown()
    {
        mouse_event((int)(MouseEventFlags.LEFTDOWN), Cursor.Position.X, Cursor.Position.Y, 0, 0);
    }

    public void LeftMouseUp()
    {
        mouse_event((int)(MouseEventFlags.LEFTUP), Cursor.Position.X, Cursor.Position.Y, 0, 0);
    } 
```

## 绘图时

```
 foreach (var contour in contours)
            {
                LeftMouseDown();
                foreach (var point in contour)
                {
                    var x = point.X + offsetX;
                    var y = point.Y + offsetY;
                    Cursor.Position = new Point(x, y);
                    //LeftMouseDown();
                    System.Threading.Thread.Sleep(2);
                }
                LeftMouseUp();
            } 
```

我试图模拟的是鼠标被点击并按住，移动到每个点的一堆点，`contour`然后在移动到下一个点之前松开`contour`。

问题在于，这只是在第一次移动时按住鼠标按钮，然后再松开。

## TL;博士

当以编程方式移动鼠标时，如何保持鼠标左键单击？

我正在尝试在第三方应用程序中模拟绘图。（Microsoft LINQ 的 Whiteboard，IM 客户端。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T17:57:06.387

总结评论线索：这不是预期的结果，因为代码只模拟鼠标点击，而不是鼠标运动。使用 Cursor.Position 移动光标直接更改光标位置，绕过 Windows 输入事件队列。因此不会向具有焦点的窗口生成任何通知（WM_MOUSEMOVE 消息）。

通过将 MouseMove() 方法添加到使用 mouse_event() 和 MouseEventFlags.MOVE 的帮助程序类来修复

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T16:19:13.223

一个迟到的回应，但我认为你的错误是在打电话`mouse_event`。基本上，[`mouse_event`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646260%28v=vs.85%29.aspx)报告**相对**鼠标移动（如果没有`MOUSEEVENTF_ABSOLUTE`），但您传递绝对位置，从而使其行为错误。**此外，在执行鼠标按下之前**，您应该将光标移动到按下鼠标按钮的位置。

所以这是我的修复：

```
// I changed a bit of the method signature, but that doesn't really matter
[DllImport("user32.dll", CallingConvention = CallingConvention.StdCall)]
static extern void mouse_event(MouseEventFlags flags, uint dx, uint dy, uint delta, IntPtr extraInfo);

[Flags]
enum MouseEventFlags : uint
{
    Absolute = 0x8000,
    LeftDown = 0x0002,
    LeftUp = 0x0004,
    MiddleDown = 0x0020,
    MiddleUp = 0x0040,
    Move = 0x0001,
    RightDown = 0x0008,
    RightUp = 0x0010,
    Wheel = 0x0800,
    XDown = 0x0080,
    XUp = 0x0100,
    HWheel = 0x1000,
}

public void LeftMouseDown()
{
    // Simulate left down, notice that RELATIVE movement is 0
    mouse_event(MouseEventFlags.LeftDown, 0, 0, 0, IntPtr.Zero);
}

public void LeftMouseUp()
{
    // Simulate left up, notice that RELATIVE movement is 0 too
    mouse_event(MouseEventFlags.LeftUp, 0, 0, 0, IntPtr.Zero);
} 
```

移动鼠标时...

```
foreach (var contour in contours)
{
    // simulate mouse down AFTER cursor is moved to the first point (IMPORTANT!)
    var x = contour[0].X + offsetX;
    var y = contour[0].Y + offsetY;
    Cursor.Position = new Point(x, y);
    LeftMouseDown();
    foreach (var point in contour)
    {
        x = point.X + offsetX;
        y = point.Y + offsetY;
        Cursor.Position = new Point(x, y);
        System.Threading.Thread.Sleep(2);
    }
    // cursor is already at the final position
    LeftMouseUp();
} 
```

附带说明一下，通过一些简单的测试，设置`Cursor.Position` **确实会**生成`WM_MOUSEMOVE`消息。

# c# - 图标放置在热点中的图像映射

> ID：10097050
> 
> 赞同：0
> 
> 时间：2012-04-10T21:56:27.167
> 
> 标签：c#, javascript, jquery, asp.net

因此，简而言之，我的项目允许用户查看带有预定义热点的 ImageMap，这些热点代表办公室周围打印机的位置。当他们将鼠标悬停在这些热点上时，我将添加一个工具提示，告诉他们打印机的名称，并让他们能够远程安装打印机驱动程序。

我的问题是：是否可以使用 jquery 或其他方法在热点位置添加一个图标（例如每个热点都相同的小型打印机）？我知道您不能将 CssClass 添加到热点（这有点令人讨厌），但是有没有办法强制这样做，或者使用 ImageMapster 之类的插件来制作它，以便图标按顺序始终存在表示打印机在哪里？

任何想法或帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T22:05:48.100

与其使用热点，不如直接使用相对定位的 div 和绝对定位的图标？除了图标的尺寸需要是正方形之外，功能基本相同。即具有设定的宽度/高度；您不能像在热点中那样绘制圆形或多边形。

这将使您可以完全控制事物的位置，并且您可以为每个热点设置不同的 CSS 类。

# c++ - 为嵌套类提升 python 包装器 - 恢复全局范围

> ID：10097051
> 
> 赞同：1
> 
> 时间：2012-04-10T21:56:27.143
> 
> 标签：c++, boost, scope, boost-python

在["Header" 的 Boost Python 文档中](http://www.boost.org/doc/libs/1_43_0/libs/python/doc/v2/scope.html)，描述了如何公开一个类的子类。

但是，我找不到任何关于如何为多个类执行此操作的文档。请参阅下面的代码，以文档中的代码为模型。如果我想编写类似的代码

```
w = nested.Z.W()
z.g() 
```

等等它不起作用，因为显然一旦范围被定义为 X，它就不会返回到全局范围。因此，例如 Z 现在位于 X 的范围内。我怎样才能使其返回到全局范围？文件说

> 使用参数构造作用域对象会将关联的全局 Python 对象更改为由参数保存的对象，直到作用域对象的生命周期结束，此时关联的全局 Python 对象恢复到构造作用域对象之前的状态。

更一般地说，这是有问题的，因为在构建此范围对象之后，我可能在模块中定义的对象会发生什么？它们最终都会在 X 的范围内吗？

解决此问题的一种方法是恢复全局范围的机制。有谁知道如何做到这一点？任何其他解决此问题的方法也可以。

```
#include <boost/python/module.hpp>
#include <boost/python/class.hpp>
#include <boost/python/scope.hpp>
using namespace boost::python;

struct X
{
  void f() {}
  struct Y { int g() { return 42; } };
};

struct Z
{
  void f() {}
  struct W { int g() { return 91; } };
};

BOOST_PYTHON_MODULE(nested)
{
  // add some constants to the current (module) scope
  scope().attr("yes") = 1;
  scope().attr("no") = 0;

  // Change the current scope
  scope outer
    = class_<X>("X")
    .def("f", &X::f)
    ;

  // Define a class Y in the current scope, X
   class_<X::Y>("Y")
     .def("g", &X::Y::g)
     ;

  // Change the current scope 
  // (this does not work as one would hope - W ends up inside Z, but Z is now in X.)
  scope outer2
    = class_<Z>("Z")
    .def("f", &Z::f)
    ;

  // Define a class Y in the current scope, X
   class_<Z::W>("W")
     .def("g", &Z::W::g)
     ;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T01:11:50.170

进入和退出范围仅由`scope`对象的生命周期处理（...另一种说法是：范围在相应`scope`对象被破坏时结束）。在示例中，如果将“outer”`scope`括在大括号中，“outer2”将（返回）在模块范围内。

```
BOOST_PYTHON_MODULE(nested)
{
  // add some constants to the current (module) scope
  scope().attr("yes") = 1;
  scope().attr("no") = 0;

  // Change the current scope
  { // -- limit C++ scope of outer
    scope outer
      = class_<X>("X")
      .def("f", &X::f)
      ;

     // Define a class Y in the current scope, X
     class_<X::Y>("Y")
       .def("g", &X::Y::g)
       ;

  } // -- finish scope "outer" --

  // Start new scope
  scope outer2
    = class_<Z>("Z")
    .def("f", &Z::f)
    ;

  // Define a class Y in the current scope, X
   class_<Z::W>("W")
     .def("g", &Z::W::g)
     ;
} 
```

这里有一个类似的答案：[boost::python 嵌套命名空间](https://stackoverflow.com/questions/7765596/create-boost-python-nested-namespace)

# java - 使用 for 循环的数组元素差异

> ID：10097058
> 
> 赞同：0
> 
> 时间：2012-04-10T21:56:52.817
> 
> 标签：java, android, arrays, for-loop, android-edittext

真的需要一些帮助，我有 3 个 editText，我需要从 hh:mm:ss 中的两个中获取输入。然后使用数组和for循环找出差异，并在第三个editText中设置为文本。任何输入都会很棒！

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    end = (EditText) findViewById(R.id.etEnd);
    start = (EditText) findViewById(R.id.etStart);
    diff = (EditText) findViewById(R.id.etDiff);
    calc = (Button) findViewById(R.id.bCalc);
    clear = (Button) findViewById(R.id.bClear);

    calc.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            int h1 = s[0];
            int m1 = s[1];
            int s1 = s[2];

            int h2 = e[0];
            int m2 = e[1];
            int s2 = e[2];

            String sGet2 = end.getText().toString(); // end to string
            String sGet1 = start.getText().toString(); // start to string

            String[] erA = sGet2.split(":"); // end string to end array
            String[] srA = sGet1.split(":"); // start string to string array

            for (int i = 0; i < srA.length; i++) {

                inted = Integer.parseInt(erA[i].trim());
                intst = Integer.parseInt(srA[i].trim());

                s[i] = intst;
                e[i] = inted;
            }

            if (s2 > s1) {m1--;s1 += 60;}

            if (m2 > m1) {h1--;m1 += 60;}

            int H, M, S;
            S = s1 - s2;
            M = m1 - m2;
            H = h1 = h2;
            diff.setText(H + ":" + M + ":" + S);

            }
        });
    }
} 
```

*另外，如果我以 1:2:3 作为开始时间和 4:5:6 作为结束时间运行它。它只吐出 (6) 结束时间的最后一位数字。如果我将结束时间设置为 3:4:5，它将在 editText 中显示 5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T22:44:55.997

我认为您的代码中有两个错误：

首先是任务

```
 int h1 = s[0];
        int m1 = s[1];
        int s1 = s[2];

        int h2 = e[0];
        int m2 = e[1];
        int s2 = e[2]; 
```

然后我认为最后的计算应该是这样的：

```
if (s[2] > s[1]) {
     m[1]--; // What happens if m[1] is 0?
     s[1] += 60;
}

if (m[2] > m[1]) {
     h[1]--;
     m[1] += 60;
}

 S = s[1] - s[2];
 M = m[1] - m[2];
 H = h[1] - h[2]; 
```

你正在混合你的变量。我认为你应该简单地在你的方法（而不是你的类的成员）中声明这些 int[]（s 和 e）数组，并去掉 s1、s2、m1、m2、h1 和 h2。

# python - 散列大型任意对象的最快方法是什么？

> ID：10097064
> 
> 赞同：3
> 
> 时间：2012-04-10T21:57:17.000
> 
> 标签：python, caching, hash

我正在编写一种方法来生成缓存键以用于缓存函数结果，该键基于函数名称和参数哈希值的组合。

目前我正在使用 hashlib 对参数的序列化版本进行哈希处理，但是序列化大对象的操作非常昂贵，那么有什么替代方案呢？

```
#get the cache key for storage
def cache_get_key(*args):
    import hashlib
    serialise = []
    for arg in args:
        serialise.append(str(arg))
    key = hashlib.md5("".join(serialise)).hexdigest()
    return key 
```

更新：我尝试使用 hash(str(args))，但是如果 args 中有相对较大的数据，仍然需要很长时间来计算哈希值。有什么更好的方法吗？

实际上，具有大数据的 str(args) 需要永远......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T21:58:11.040

您是否尝试过仅使用该`hash`功能？它在元组上效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T22:03:11.633

假设您创建了对象，并且它由较小的组件组​​成（它不是二进制 blob），您可以在构建对象时使用其子组件的哈希值预先计算哈希值。

例如，而不是`serialize(repr(arg))`，做`arg.precomputedHash if isinstance(arg, ...) else serialize(repr(arg))`

如果您既不制作自己的对象也不使用`hash`可用的对象，您也许可以保留一个对象引用的记忆表 -> 哈希，假设您不改变对象。最坏的情况是，您可以使用允许记忆的函数式语言，因为这种语言中的所有对象都可能是不可变的，因此是可散列的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T22:05:14.637

```
def cache_get_key(*args):
    return hash(str(args)) 
```

或者（如果你真的想使用 hashlib 库）

```
def cache_get_key(*args):
    return hashlib.md5(str(args)).hexdigest() 
```

我不会费心重写代码来将数组变成字符串。使用内置的。

## 替代解决方案

以下是@8bitwide 建议的解决方案。此解决方案根本不需要散列！

```
def foo(x, y):
    return x+y+1

result1 = foo(1,1)
result2 = foo(2,3)

results = {}
results[foo] = {}
results[foo][ [1,1] ] = result1
results[foo][ [2,3] ] = result2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T22:43:21.800

我见过人们将任意 python 对象提供给 random.seed()，然后使用从 random.random() 返回的第一个值作为“散列”值。它并没有给出极好的值分布（可以倾斜），但它似乎适用于任意对象。

如果您不需要加密强度的哈希，我想出了一对哈希函数，用于我在布隆过滤器中使用的整数列表。它们出现在下方。布隆过滤器实际上使用这两个散列函数的线性组合来获得任意数量的散列函数，但它们应该在其他只需要一些散布并具有良好分布的情况下工作正常。它们的灵感来自 Knuth 关于线性同余随机数生成的文章。他们将整数列表作为输入，我相信这可能只是您的序列化字符的 ord()。

```
MERSENNES1 = [ 2 ** x - 1 for x in [ 17, 31, 127 ] ]
MERSENNES2 = [ 2 ** x - 1 for x in [ 19, 67, 257 ] ]

def simple_hash(int_list, prime1, prime2, prime3):
    '''Compute a hash value from a list of integers and 3 primes'''
    result = 0
    for integer in int_list:
        result += ((result + integer + prime1) * prime2) % prime3
    return result

def hash1(int_list):
    '''Basic hash function #1'''
    return simple_hash(int_list, MERSENNES1[0], MERSENNES1[1], MERSENNES1[2])

def hash2(int_list):
    '''Basic hash function #2'''
    return simple_hash(int_list, MERSENNES2[0], MERSENNES2[1], MERSENNES2[2]) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-06T15:48:18.313

我知道这个问题很老，但我只想加上我的 2 美分：

1.  您不必创建一个列表然后加入它。特别是如果列表无论如何都会被丢弃。使用哈希函数的`.update()`方法

2.  考虑使用更快的非加密哈希算法，特别是如果这不是加密安全的实现。

话虽如此，这是我建议的改进：

```
import xxhash

#get the cache key for storage
def cache_get_key(*args):
    hasher = xxhash.xxh3_64()
    for arg in args:
        hasher.update(str(arg))
    return hasher.hexdigest() 
```

这使用（声称是）*极快*的xxHash [NCHF*](https://github.com/Cyan4973/xxHash/wiki/Performance-comparison)。

* * *

* NCHF = 非加密哈希函数

# asp.net-mvc-3 - MVC3，关闭不在 ViewModel 中的字段的字段验证

> ID：10097065
> 
> 赞同：1
> 
> 时间：2012-04-10T21:57:17.387
> 
> 标签：asp.net-mvc-3, validation

我在 MVC3 项目中有一个表单。我的输入字段之一应该接受 HTML。不幸的是，我不能有这个值映射到的 ViewModel。该字段是自动生成的并自动读入。我收到以下错误。

```
 A potentially dangerous Request.Form value was detected from the client 
```

由于没有视图模型，我无法应用 [AllowHTML] 属性。有谁知道不涉及禁用整个页面验证的解决方法？

谢谢你

附加信息：我可以通过执行以下操作来访问未验证的值：

```
 using System.Web.WebPages;
 using System.Web.Helpers;

  .....Inside Controller....
  string value = Request.Unvalidated("input-40"); 
```

现在的问题是 Request.Params 集合抛出异常。我想访问所有其他值并让它们得到验证......只是不是那个。有没有办法让我显式地验证其他字段或访问经过验证的集合。

以下会很好

```
 string value = System.Web.Something.ValidateInput(Request.Unvalidated("input-41")); 
```

不幸的是，我不知道这种方法在哪里/是否存在

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:14:33.000

你可以试试这个`ValidateInput(false)`属性：

```
[ValidateInput(false)]
public ActionResult YourAction(FormCollection yourCollection)
{
    // your stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:16:54.593

为您的操作方法使用 ValidateInput 属性。似乎不安全，但应该可以工作，现在无法测试。

# java - 从 Java 生成 Excel 2010 数据透视表

> ID：10097066
> 
> 赞同：2
> 
> 时间：2012-04-10T21:57:18.097
> 
> 标签：java, excel, pivot-table

有谁知道可以生成 excel 2010 格式的数据透视表的服务器端库（免费与否 - 没关系）。

POI做不到。

现在我正在评估 SmartXLS，但它使用 Excel 2007 格式。我需要 Excel 2010 中的几个功能 - 例如数据字段排序、默认数据透视表模板等...

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-28T14:49:08.243

这个问题的答案建议使用[X4J](https://github.com/jbaliuka/x4j-analytic)，这似乎很有希望，但我自己没有尝试过。

[Java 开源库，用于从 excel 中生成数据透视表](https://stackoverflow.com/questions/18850120/java-open-source-library-to-generate-pivot-table-out-of-excel)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T11:50:07.057

对于那些仍在寻找这个的人，虽然 SmartXLS 或 POI 现在可能支持它，但他们总是会落后于 Excel 的新发展。如果您总是希望能够在 Excel 中编写最新功能的脚本，最好使用 .net（或 PowerShell、VBScript、VBA）进行编码

# xcode - xCode ios5：如何在间隔后淡出标签文本？

> ID：10097068
> 
> 赞同：4
> 
> 时间：2012-04-10T21:57:42.737
> 
> 标签：xcode, ios5, uilabel

我有一个显示图像的小 iOS5 应用程序。我单击图像以显示其信息。我希望信息在几秒钟后消失。有没有好的方法来做到这一点？

我总是可以实现另一个按钮操作，但这会更整洁..

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-10T21:59:31.320

使用`NSTimer`或`performSelector:withObject:afterDelay`。这两种方法都要求您调用一个单独的方法，该方法实际上会进行淡出，这应该相当简单。

## 例子：

**NS定时器**

```
[NSTimer scheduledTimerWithTimeInterval:3.0 target:self selector:@selector(fadeOutLabels:) userInfo:nil repeats:NO]; 
```

**performSelector:withObject:afterDelay:**

```
/* starts the animation after 3 seconds */
[self performSelector:@selector(fadeOutLabels) withObject:nil afterDelay:3.0f]; 
```

您将调用该方法`fadeOutLabels` *（或任何您想调用的方法）*

```
-(void)fadeOutLabels
{
    [UIView animateWithDuration:1.0 
                          delay:0.0  /* do not add a delay because we will use performSelector. */
                        options:UIViewAnimationCurveEaseInOut 
                     animations:^ {
                         myLabel1.alpha = 0.0;
                         myLabel2.alpha = 0.0;
                     } 
                     completion:^(BOOL finished) {
                         [myLabel1 removeFromSuperview];
                         [myLabel2 removeFromSuperview];
                     }];
} 
```

或者您可以使用动画块来完成所有工作：

```
-(void)fadeOutLabels
{
    [UIView animateWithDuration:1.0 
                          delay:3.0  /* starts the animation after 3 seconds */
                        options:UIViewAnimationCurveEaseInOut 
                     animations:^ {
                         myLabel1.alpha = 0.0;
                         myLabel2.alpha = 0.0;
                     } 
                     completion:^(BOOL finished) {
                         [myLabel1 removeFromSuperview];
                         [myLabel2 removeFromSuperview];
                     }];
} 
```

# git - GitHub自动合并后出现致命错误

> ID：10097069
> 
> 赞同：1
> 
> 时间：2012-04-10T21:57:46.060
> 
> 标签：git, github, git-fetch

我在 GitHub 上有一个存储库，位于[此处](https://github.com/dapphp/securimage)。我为某人创建了一个工作分支，他们分叉了 repo，对工作分支进行了一些更改并提交了一个拉取请求。

我尝试了更改，一切都很好，由于 GitHub 提供自动合并拉取请求，我继续点击绿色的大“合并拉取请求”按钮。除了对工作分支的更改应用于我可以忍受的主分支之外，一切都很好。

现在的问题是我或其他任何人都无法获取存储库。我收到此错误：

```
dp@dpub:/tmp/gh$ git clone git://github.com/dapphp/securimage.git
Initialized empty Git repository in /tmp/gh/securimage/.git/
remote: Counting objects: 333, done.
remote: Compressing objects: 100% (269/269), done.
remote: Total 333 (delta 91), reused 297 (delta 55)
Receiving objects: 100% (333/333), 3.91 MiB | 2.78 MiB/s, done.
Resolving deltas: 100% (91/91), done.
error: refs/remotes/origin/master does not point to a valid object!
error: Trying to write ref refs/heads/master with nonexistant object 31d684d383913c4cf1a0d5ff0691c2c163284a35
fatal: Cannot update the ref 'HEAD'. 
```

这导致没有创建目录或下载任何工作文件。我已经到处寻找可能的方法来解决这个问题，但大多数人都在谈论向 git repo 发出命令，这是我无法做到的，因为我一开始就无法获得 repo 的副本。

我发现我仍然可以使用这样的方法克隆远程分支：`git clone -b audiofixes git://github.com/dapphp/securimage.git`但我仍然收到有关错误 ref 的错误，并且我无法找出可以运行的任何命令来解决问题。如有必要，我愿意撤消更改。

如果它有帮助，一旦我克隆了一个不同的分支，这里是输出`git branch -a`：

```
* audiofixes
  remotes/origin/2.0.2
  remotes/origin/3.0
  remotes/origin/HEAD -> origin/master
  remotes/origin/audiofixes
  remotes/origin/securimage_flash 
```

在这一点上，我真的不知道我能做些什么（如果有的话）来修复存储库的状态。

感谢您的任何建议。

编辑：按要求输出一些命令。

```
$ ls .git/refs/remotes/origin
HEAD

$ ls .git/objects
info/  pack/
# info is empty, pack has pack-b8add06e9a6864ea44a58c06b8bd549eedd90c94.idx and pack-b8add06e9a6864ea44a58c06b8bd549eedd90c94.pack

$ cat .git/refs/remotes/origin/master
cat: .git/refs/remotes/origin/master: No such file or directory

$ cat .git/refs/remotes/origin/HEAD 
ref: refs/remotes/origin/master 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:48:17.097

新的：

显然 1）github 不提供 ssh 访问权限：（和 2）通过 git 协议在不同机器之间共享 reflog 是不可能的。

所以......您显然已经创建了一张票，但您不一定需要它们来修复存储库。您所需要的只是让他们（因为他们具有特权访问权限）`git reflog master`在服务器的存储库上运行，然后粘贴结果供您查看。在该文件中，查找 master 以前的 SHA-1 值（因为当前的值似乎不起作用）。一旦你有了它，你（我认为）可以（在你自己的计算机上）执行以下操作：

```
$ git checkout -b temp
$ git update-ref refs/heads/temp $SHA1
$ git push -u origin +temp:master 
```

这将撤消服务器上的合并操作。

您可能能够获得以前工作的 SHA1，而无需从服务器获取 reflog。在您的本地仓库（或您朋友的本地仓库）中，之前工作的提交*确实*存在于那里的某个地方。如果你能想办法在那里找到它，那么你可以继续上面的建议。

老：这是我的第一个想法。如果您能够*从服务器*`.git/logs`复制目录，则该目录中将存储分支的所有先前值。具体来说，该文件将是一个原始文本文件，其中包含该分支的先前值。例如（我不知道 github 是否允许你这样做）：*`master``.git/logs/refs/heads/master`*

 *```
$ git clone https://github.com/dapphp/securimage.git -b audiofixes
$ scp github.com:/dapphp/securimage.git/logs/refs/heads/master .git/logs/refs/remotes/origin/master
$ git update-ref refs/remotes/origin/master refs/remotes/origin/master@{1} #see "Date Spec" section of http://book.git-scm.com/4_git_treeishes.html 
```

*从理论上讲*，这应该将值更改为 master 以前的值。但是，它只会在本地执行此操作，实际上不会更改服务器上的值，而这正是我们真正需要的。因此，如果您可以直接 ssh 到服务器并在那里运行最后一个命令，那么（再次，理论上）只需撤消合并即可永久解决问题。

.

这就是我能想到的一切。但我真的很喜欢解决这样的 git 难题，所以我会让它在我的脑海中停留更长时间:)*

# cocoa - NSTableView 并将鼠标悬停在列上

> ID：10097072
> 
> 赞同：1
> 
> 时间：2012-04-10T21:57:58.967
> 
> 标签：cocoa, nstableview

我实现了一个 NSTableView 并且想要添加一些东西，当用户将鼠标悬停在一个列上时，我会显示一些自定义信息。关于信息。在那一栏中。我不确定这是否是工具提示，或者是否有 NSTableView 委托来执行此操作。有什么建议么 ？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T06:14:37.130

是的，它是一个工具提示。

为什么不确定是否有`NSTableView`代表？您是否*看过*表格[视图文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/TableView/Introduction/Introduction.html)？这样做会比在这里提问更快地回答您的问题。

你想要[tableView:toolTipForCell:rect:tableColumn:row:mouseLocation:](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/NSTableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/NSTableViewDelegate/tableView%3atoolTipForCell%3arect%3atableColumn%3arow%3amouseLocation%3a)委托方法。

# javascript - 在 JavaScript 的 Date 构造函数中查找和使用用户的时区

> ID：10097080
> 
> 赞同：1
> 
> 时间：2012-04-10T21:58:52.413
> 
> 标签：javascript, datetime

```
new Date('April 12, 2012 05:00:00 ').toLocaleString(); 
```

日期本身是通过 PHP 提供和格式化的。但是，如果用户没有登录，那么我不知道他们的时区偏移量是多少，这就是我被迫使用 JavaScript 的原因。

我怎样才能找到偏移量并应用并且仍然将其全部保存在一行代码中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:13:23.120

Sorry, dude. Dates are hard.

When possible, let the server format your date strings and send them down to the browser with the web page or ajax response or whatever.

If really, really, really want to do time zone conversions on the client in javascript, you've got to send the timezone rules you're interested in down to the client. If you have a Windows machine, below is a powershell script that will generate a javascript file with timezone rules and a function to do the conversions. I used this when I needed to convert dates from a 3rd party web api to a timezone different than the browser's time zone.

You should only go this approach if you need to get a date object into a timezone other than the browser's timezone or utc. Even then, you might consider a web service to format the dates for you as an alternative.

```
# Serialize .Net TimeZoneInfo objects to a javascript file.
Add-Type -AssemblyName System.Web.Extensions;
$f = "timezoneinfo.js";
$ser = new-object System.Web.Script.Serialization.JavaScriptSerializer;
$tzi = [System.TimeZoneInfo]::FindSystemTimeZoneById("Central Standard Time");

# To keep the file size reasonable, exclude timezoneinfos where this web site has no activity.
$exclude = @("Afghanistan Standard Time",
"Arab Standard Time",
"Arabian Standard Time",
"Arabic Standard Time",
"Argentina Standard Time",
"Atlantic Standard Time",
"AUS Central Standard Time",
"AUS Eastern Standard Time",
"Azerbaijan Standard Time",
"Azores Standard Time",
"Bangladesh Standard Time",
"Cape Verde Standard Time",
"Caucasus Standard Time",
"Cen. Australia Standard Time",
"Central America Standard Time",
"Central Asia Standard Time",
"Central Brazilian Standard Time",
"Central Europe Standard Time",
"Central European Standard Time",
"Central Pacific Standard Time",
"China Standard Time",
"Dateline Standard Time",
"E. Africa Standard Time",
"E. Australia Standard Time",
"E. Europe Standard Time",
"E. South America Standard Time",
"Egypt Standard Time",
"Ekaterinburg Standard Time",
"Fiji Standard Time",
"FLE Standard Time",
"Georgian Standard Time",
"Greenland Standard Time",
"Greenwich Standard Time",
"Hawaiian Standard Time",
"India Standard Time",
"Iran Standard Time",
"Israel Standard Time",
"Jordan Standard Time",
"Kaliningrad Standard Time",
"Kamchatka Standard Time",
"Korea Standard Time",
"Magadan Standard Time",
"Mauritius Standard Time",
"Mid-Atlantic Standard Time",
"Middle East Standard Time",
"Montevideo Standard Time",
"Morocco Standard Time",
"Myanmar Standard Time",
"N. Central Asia Standard Time",
"Namibia Standard Time",
"Nepal Standard Time",
"Newfoundland Standard Time",
"North Asia East Standard Time",
"North Asia Standard Time",
"Pacific SA Standard Time",
"Pakistan Standard Time",
"Paraguay Standard Time",
"Romance Standard Time",
"Russian Standard Time",
"SA Eastern Standard Time",
"SA Pacific Standard Time",
"SA Western Standard Time",
"Samoa Standard Time",
"SE Asia Standard Time",
"Singapore Standard Time",
"Sri Lanka Standard Time",
"Syria Standard Time",
"Taipei Standard Time",
"Tasmania Standard Time",
"Tokyo Standard Time",
"Tonga Standard Time",
"Turkey Standard Time",
"Ulaanbaatar Standard Time",
"Venezuela Standard Time",
"Vladivostok Standard Time",
"W. Australia Standard Time",
"W. Central Africa Standard Time",
"W. Europe Standard Time",
"West Asia Standard Time",
"West Pacific Standard Time",
"Yakutsk Standard Time");

"/*This file was generated by a tool*/" | out-file $f;
"(function (TimeZoneInfo, undefined) {" | out-file $f -Append;

$first = $true;
"var infos = {" | out-file $f -Append;
[System.TimeZoneInfo]::GetSystemTimeZones() | ? {
    $exclude -notcontains $_.Id} | % {

    # Serizliae the TimeZoneInfo
    $s1 = $ser.Serialize($_);
    # Serialize the adjustment rules.  Convert MS Ajax dates into JS date constructors.
    $s2 = $ser.Serialize($_.GetAdjustmentRules()) -replace "\`"\\/Date\((?<ticks>.+?)\)\\/\`"", "new Date(`$1)";
    # Add the adjustment rules to the resulting JSON.
    $s3 = $s1.Substring(0, $s1.Length - 1) + ",AdjustmentRules:" + $s2 + "}";
    # Add item to associative JS array.
    $s3 = "`"" + $_.ID + "`":" + $s3;
    if (!$first) {      
        $s3 = "," + $s3;
        $s3 | write-host;
    } else {
        $first = $false;        
    }

    # Cheesy code here.  But the next few steps remove properties we don't care about to get keep the file size down.
    # Remove strings.
    $s3 = $s3 -replace "`"(Id|DisplayName|StandardName|DaylightName)`":`".+?`"(,)?", "";
    # Remove all of the TimeSpan properties except TotalMinutes.
    $s3 = $s3 -replace "`"(Ticks|Days|Hours|Milliseconds|Minutes|Seconds|TotalDays|TotalHours|TotalMilliseconds)`":[-0-9.]+?,", "";
    $s3 = $s3 -replace ",`"TotalSeconds`":(-)?\d+", "";

    $s3 | out-file $f -Append;
}
"};" | out-file $f -Append;

# Add the client function to do the conversion.  This mainly comes from using reflector and looking as MSDN for IsFixedDateRule.
$s4 = "
// This function will shift a date the approprate number of hours to make it appear correct for the given timezoneid.
TimeZoneInfo.ConvertTime = function(dt, tzid) {
    if (typeof(dt) === `"undefined`" || dt == null) { return null; }
    if (typeof(tzid) === `"undefined`" || tzid == null || tzid === `"`") { return dt; }
    var tz = infos[tzid];
    if (typeof(tz) === `"undefined`") { return dt; }

    var clientOffset = dt.getTimezoneOffset();

    var adj = null;
    var j = tz.AdjustmentRules.length;  
    for (var i = 0; i < j; i++) {
        if (tz.AdjustmentRules[i].DateStart <= dt) {
            if (tz.AdjustmentRules[i].DateEnd >= dt) {
                adj = tz.AdjustmentRules[i];
                break;
            }
        } 
    }

    function GetDaysInMonth(y, m)
    {
        return 32 - new Date(y, m, 32).getDate();
    }

    function GetTransitionDayOfMonth(t, y) {
        var startOfWeek = t.Week * 7 - 6;
        var firstDayOfWeek = new Date(y, t.Month - 1, 1).getDay();
        var transitionDay = null;
        var changeDayOfWeek = t.DayOfWeek;
        if (firstDayOfWeek <= changeDayOfWeek) {
            transitionDay = startOfWeek + (changeDayOfWeek - firstDayOfWeek);
        } else {
            transitionDay = startOfWeek + (7 - firstDayOfWeek + changeDayOfWeek);
        }
        if (transitionDay > GetDaysInMonth(y, t.Month - 1)) {
            transitionDay -= 7;
        }
        return transitionDay;
    }

    var dstOffset = 0;
    if (adj != null) {
        var dstStart = adj.DaylightTransitionStart.IsFixedDateRule ?
            new Date(dt.getFullYear(), adj.DaylightTransitionStart.Month - 1, adj.DaylightTransitionStart.Day, adj.DaylightTransitionStart.TimeOfDay.getHours()) :
            new Date(dt.getFullYear(), adj.DaylightTransitionStart.Month - 1, GetTransitionDayOfMonth(adj.DaylightTransitionStart, dt.getFullYear()), adj.DaylightTransitionStart.TimeOfDay.getHours());
        var dstEnd = adj.DaylightTransitionEnd.IsFixedDateRule ?
            new Date(dt.getFullYear(), adj.DaylightTransitionEnd.Month - 1, adj.DaylightTransitionEnd.Day, adj.DaylightTransitionEnd.TimeOfDay.getHours()) :
            new Date(dt.getFullYear(), adj.DaylightTransitionEnd.Month - 1, GetTransitionDayOfMonth(adj.DaylightTransitionEnd, dt.getFullYear()), adj.DaylightTransitionEnd.TimeOfDay.getHours());
        if (dstStart <= dt && dstEnd >= dt) {
            dstOffset = adj.DaylightDelta.TotalMinutes;
        }
    }
    var dtcopy = new Date(dt.getTime());
    dtcopy.setMinutes(dtcopy.getMinutes() + clientOffset + tz.BaseUtcOffset.TotalMinutes + dstOffset);
    return dtcopy;  
};
TimeZoneInfo.Get = function(tzid) { return infos[tzid]; };
";

$s4 | out-file $f -Append;

"} (window.TimeZoneInfo = window.TimeZoneInfo || {}));" | out-file $f -Append;

#//TimeZoneInfo.ConvertTime(new Date(2011,7,1,16,45), "Central Standard Time");
#//TimeZoneInfo.ConvertTime(new Date(2011,7,1,16,45), "Eastern Standard Time");
#//TimeZoneInfo.ConvertTime(new Date(2011,7,1,16,45), "South Africa Standard Time");
#notepad.exe $f; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:19:26.207

不要试图发现用户的时区。而是以 unix 时间（秒 1/1/1970 00:00 UTC）传递时间并从那里设置：

```
d = new Date(); d.setTime(the_time_value); 
```

这将根据浏览器的本地时区生成一个设置为您传递给它的时间的日期。

在 PHP 中，您可以将日期/时间转换为 unix 时间[`$date->getTimestamp();`](http://www.php.net/manual/en/datetime.gettimestamp.php)

经验法则是，始终以 UTC 存储和传递您的程序（包括浏览器和服务器之间）的时间，并尽可能晚地转换为本地日期/时间。

# php - Yii Active Record 在不同表的命名范围内添加多个条件

> ID：10097081
> 
> 赞同：3
> 
> 时间：2012-04-10T21:58:53.337
> 
> 标签：php, activerecord, yii

我试图设定一个条件，即客户端 ID 必须与客户端 ID 匹配，并且位置表中的区域字段必须与附加到与用户位置关联的位置 ID 的区域匹配。

所以我有3张桌子。当前表（t1），表relation1引用（t2），以及t2在relation2中引用的表（我们称之为t3）。

```
    $this->getDbCriteria()->mergeWith(数组(
        'with' => $rel,
        '条件'=>'relation1.client_id=:client_id AND
                      关系1.关系2.区域=：区域'，
        'params'=>array(':client_id'=>$client_id, ':region'=>$region),
    ));

返回$这个；

```

Relation1 是表中的关系，一旦从该关系中删除。关系 1 引用的表有一个名为关系 2 的关系，它可以让我到达需要检索区域值的位置。

如果我删除第二个条件和参数，它就可以工作，所以我知道关系 1 正在工作，而关系 2 也可以在其他情况下工作。如果想见他们，他们就在这里。

```
    公共职能关系（）
    {
        返回数组（
            'relation1' => 数组(self::BELONGS_TO, 't2', 't2_id'),
        );
    }

```

和

```
    公共职能关系（）
    {
        返回数组（
            'relation2' => 数组(self::BELONGS_TO, 't3', 't3_id'),
             );
    }

```

我真的觉得这应该工作。有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T14:58:01.950

我从另一个网站得到了答案。如果您有兴趣，解决方案是：

```
    $this->getDbCriteria()->mergeWith(数组(
            '与' => 数组（
                'relation1' => 数组（
                       '条件' => 'relation1.column = :column_id',
                       'params' => array(':column_id'=>$column_id)),
                'relation1.relation2' => 数组（
                       '条件' => 'relation2.column2 = :column2',
                       '参数' => 数组(':column2'=>$column2))
            ),
        ));
    返回$这个；

```

谢谢你的帮助！

# jquery - jQuery关闭按钮效果/样式

> ID：10097083
> 
> 赞同：1
> 
> 时间：2012-04-10T21:59:07.010
> 
> 标签：jquery, css, button

我想实现在将鼠标悬停在 div 上一段时间后出现关闭按钮的效果。我怎么能那样做？顺便说一句，我对 jQuery 很陌生。

这是一个类似于我想要的东西的例子

![在此处输入图像描述](../Images/e47f16d18821554283a8238f2fce78da.png)

我想出现在我的一个设计中的角落里的那个“x”。

谢谢大家

到目前为止我做了什么：

jQuery：

```
$("#slider #content").on("hover", '.element', function(evt) {
    var top, left;
    top = $(this).offset().top;
    left = $(this).offset().left;
    $(".close-button").css({"top":top, "left":left});
    $(".close-button").show();
 }); 
```

如果不是，我猜 div 和 div 的样式无关紧要，我会在这里发布。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T22:26:46.473

给定以下 HTML，这是执行此操作的一种方法：

```
<a href="#" class="modalShow">show modal</a> <a href="#" class="modalShow">show modal</a>
<div class="modal">
    <span class="close">X</span>
    <p>Some text in the first modal div</p>
</div>
<div class="modal">
    <span class="close">X</span>
    <p>Some text in the second modal div</p>
</div>​ 
```

和CSS：

```
.modal {
    display: none;
    width: 50%;
    padding: 0.5em;
    min-height: 6em;
    border: 10px solid #000;
    border: 10px solid rgba(0,0,0,0.5);
    position: absolute;
    top: 20%;
    left: 50%;
    margin-left: -25%;
}
span.close {
    display: none;
    position: absolute;
    top: -2.5em;
    left: -2.5em;
    width: 2em;
    height: 2em;
    text-align: center;
    line-height: 2em;
    border: 10px solid #000;
    border: 10px solid rgba(0,0,0,0.5);
    border-radius: 2em;
    background-color: #fff;
    cursor: pointer;
}​ 
```

和 jQuery：

```
$('a.modalShow').click(
    function() {
        // finds which link was clicked, and therefore which modal to show
        var i = $(this).index('.modalShow'); 
        // fades all the modal elements out
        $('.modal').fadeOut(1000);
        // fades the relevant modal in
        $('.modal').eq(i).fadeIn(1000);
    });

$('.modal').hover(
    function() {
        // while hovering over the modal, it fades the close element in after a delay
        $(this).find('.close').delay(1000).fadeIn(500);
    },
    function() {
        // after leaving/mouseout of the the modal, has a delay and then fades the close out
        $(this).find('.close').delay(1000).fadeOut(500);
    });

$('span.close').click(
    function(){
        // clicking the close span causes the closest ancestor modal to fadeout
        $(this).closest('.modal').fadeOut(1000);
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/VhgVV/2/)。

参考：

*   [`click()`](http://api.jquery.com/click/).
*   [`closest()`](http://api.jquery.com/closest/).
*   [`eq()`](http://api.jquery.com/eq/).
*   [`fadeIn()`](http://api.jquery.com/fadeIn/).
*   [`fadeOut()`](http://api.jquery.com/fadeOut/).
*   [`fadeToggle()`](http://api.jquery.com/fadeToggle/).
*   [`find()`](http://api.jquery.com/find/).
*   [`index()`](http://api.jquery.com/index/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:14:44.863

很大程度上取决于您的 HTML 和 CSS。现在，让我们假设*盒子*是一个 div 元素，*关闭按钮*是盒子内的一个子 div。你可能会做这样的事情......

```
$(".boxes").hover(
    //do this on mouse over...
    function () {
        var me = $(this);
        me.find('.closeButton').delay(1000).fadeIn(500);
    },
    //do this on mouse out...
    function () {
        var me.find('.closeButton').fadeOut(100);
    }
); 
```

# xpages - DataContext 被多次执行

> ID：10097084
> 
> 赞同：0
> 
> 时间：2012-04-10T21:59:20.803
> 
> 标签：xpages

有没有人注意到 xpages 中的数据上下文存在问题。在某些情况下，具有多个自定义控件的单个 xpage 会导致在单个页面加载期间对 datacontext 进行 12 次评估？其他数据源也会发生这种情况吗？

这是一个简单的例子，它被执行了 3 次！！

```
<?xml version="1.0" encoding="UTF-8"?>
<xp:view xmlns:xp="http://www.ibm.com/xsp/core"
    xmlns:xe="http://www.ibm.com/xsp/coreex">
    <xp:this.dataContexts>
        <xp:dataContext var="doc1">
            <xp:this.value><![CDATA[#{javascript:var doc:NotesDocument = database.createDocument();
doc.replaceItemValue("Form", "frmContact");
doc.replaceItemValue("fldFirstName", "test");
print("got here");
return doc;}]]></xp:this.value>
        </xp:dataContext>
    </xp:this.dataContexts>
    <xp:inputText id="inputText1" value="#{doc1.fldFirstName}"></xp:inputText>
</xp:view> 
```

我不应该在我的应用程序中使用 dataContexts 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:35:08.390

就像页面上的其他控件一样，可以多次评估数据上下文。有关dataContexts 的好处的更多信息，请参见[此处。](https://stackoverflow.com/questions/9413943/whats-the-benefits-of-using-data-context-in-xpages "这里是关于数据上下文的一个很好的答案")但在我看来，从您的代码示例来看，使用 xp:data 源可能会更快，但我不确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T04:40:59.093

与所有其他值绑定一样，如果将 # 更改为 $，可能会多次请求 dataContext 的 value 属性，但*确定*该值的计算只会执行一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T04:55:16.437

还要注意，如果您使用的是部分刷新。假设，您的数据上下文位于 id B 中，并且您对 id A 进行了刷新。id B 中的数据上下文也将被刷新。所有其他数据源也会发生这种情况。

我在这里描述了这种行为[http://www-10.lotus.com/ldd/xpagesforum.nsf/topicThread.xsp?action=openDocument&documentId=56E9B8537DA50A90852579A6002EAC64#FA00DE3675A456C0852579AB005A1FF4](http://www-10.lotus.com/ldd/xpagesforum.nsf/topicThread.xsp?action=openDocument&documentId=56E9B8537DA50A90852579A6002EAC64#FA00DE3675A456C0852579AB005A1FF4)

还有一些关于 PMR 的提示和可能的解决方法。

# php - 使用 jQuery ajax 难以从选择框中加载 MySQL 数据。

> ID：10097086
> 
> 赞同：-1
> 
> 时间：2012-04-10T21:59:33.157
> 
> 标签：php, ajax, jquery, drop-down-menu, javascript

我正在尝试从 html 选择框从我的数据库中加载 mysql 数据。这是我目前正在使用的 jquery 函数，但它似乎没有根据选择更新我的结果。

```
$(function(){
            $('#countries').keyup(function(){

            var inpval=$('#countries').val();

            $.ajax({
                type: 'POST',
                data: ({countries : inpval}),
                url: 'data.php',
                success: function(data) {
                     $('#show_results').html(data);
          }
        });
    });
}); 
```

这是我的选择框的 html 代码

```
<select id="countries">
                    <option value="canada" id="canada">canada</option>
                    <option value="america" id="america">america</option>
                    <option value="india" id="india">india</option>
                    <option value="uk" id="uk">uk</option>
                    <option value="germany" id="germany">germany</option>
                </select> 
```

我学习了如何使用 jquery ajax 从[Here](http://kyokasuigetsu25.wordpress.com/2011/02/02/dynamically-load-mysql-data-using-jquery-and-php/)加载 mysql 数据库中的数据，它实际上对于输入常规文本框的数据非常有效，但是，它似乎不适用于选择框。任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:01:48.327

我认为您应该将事件更改为：

```
 $('#countries').change(function(){ 
```

并不是`keyup`

# ruby-on-rails - 从呈现的成员创建复选框表单以发送电子邮件 - Ruby on Rails

> ID：10097089
> 
> 赞同：0
> 
> 时间：2012-04-10T21:59:44.270
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms

我有一个团队成员页面，它通过与大学体育俱乐部相关联的用户进行筛选，我试图让它在每个成员旁边生成一个复选框，以便委员会成员可以简单地选择几个成员按下提交按钮，系统将向他们发送一封电子邮件。

我试过`<%= check_box_tag(<%= render @users %>) %>`但没有任何运气

**show_selection.html.rb** - 这是呈现用户的页面

```
<% if signed_in? %>
    <% if current_user.captain? %>
        Welcome, select members to send a message to below

    <table summary="Team members">
      <tr>
        <td class="main">
          <% unless @users.empty? %>
            <ul class="users">
              <%= render @users %>
            </ul>
            <%= will_paginate @users %>
          <% end %>
        </td>       
      </tr>
    </table>

    <br>
    <br>

<% else %>
    <h1>An error has occured</h1>
    <br>
    <p>It looks like you're trying to access a restricted page <%= link_to "Please Click Here", '/' %> </p>
    <% end %>
<% else %>
    An error has occured
    <br>
    <p>It looks like you're trying to access a restricted page <%= link_to "Please Click Here", '/' %> </p>
<% end %> 
```

**users_contorller.rb**

```
class UsersController < ApplicationController
  before_filter :authenticate, :only => [:index, :edit, :update, :destroy]
  before_filter :correct_user, :only => [:edit, :update]
  before_filter :admin_user,   :only => :destroy

  def show
    @user = User.find(params[:id])
    @microposts = @user.microposts.paginate(:page => params[:page])
    @title = @user.name
    @admins = User.where(:admin => "t")
    @captains = User.where(:captain => "t")
    @clubs = User.where(:captain => "t")
  end

  def new
    @user = User.new
    @title = "Sign up"
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:success] = "Welcome to University Sports!"
      redirect_to @user
      UserMailer.welcome_email(@user).deliver
    else
      @title = "Sign up"
      render 'new'
    end
  end

  def edit
    @title = "Edit user"
  end

  def update
    @user = User.find(params[:id])
    if @user.update_attributes(params[:user])
      flash[:success] = "Profile updated."
      redirect_to @user
    else
      @title = "Edit user"
      render 'edit'
    end
  end

  def index
    @users = User.paginate(:page => params[:page])
  end

  #def admins
  #  @users = User.admins
  #  render "users/index"
  #end

  def admins
    @admins=User.where(:admin => "t")
  end

  def captains
    @captains=User.where(:captain => "t")
  end

  def clubs
    @clubs=User.where(:captain => "t")
  end

  def destroy
    User.find(params[:id]).destroy
    flash[:success] = "User destroyed."
    redirect_to users_path
  end

  def following
    @title = "Following"
    @user = User.find(params[:id])
    @users = @user.following.paginate(:page => params[:page])
    render 'show_follow'
  end

  def followers
    @title = "Followers"
    @user = User.find(params[:id])
    @users = @user.followers.paginate(:page => params[:page])
    render 'show_follow'
  end

  def selection
    @title = "Selection"
    @user = User.find(params[:id])
    @users = @user.followers.paginate(:page => params[:page])
    render 'show_selection'
  end 

  private

    def authenticate
      deny_access unless signed_in?
    end

    def correct_user
      @user = User.find(params[:id])
      redirect_to(root_path) unless current_user?(@user)
    end

    def admin_user
      redirect_to(root_path) unless current_user.admin?
    end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T02:15:58.870

首先，您需要将其包装在一个表单中，以处理将所选成员提交到电子邮件。表单应发布到邮件控制器或处理选定成员以发送电子邮件的操作。

```
 <%= render @users %> 
```

这将为@users 中的每个对象呈现部分内容。您应该在此部分中添加复选框，以便为每个成员呈现它。

你的部分中会有这样的东西

```
<%= check_box_tag "user_ids[]", user.id %> 
```

Ryan 有一个 railscast 会为你指出如何实现的正确方向。这是关于更新记录，但您可以修改代码以使用您的方案。

[http://railscasts.com/episodes/52-update-through-checkboxes](http://railscasts.com/episodes/52-update-through-checkboxes)

# python - Python中的列表迭代问题

> ID：10097090
> 
> 赞同：1
> 
> 时间：2012-04-10T21:59:45.913
> 
> 标签：python

我正在处理遇到此问题的 Google Python 课程练习 -

```
def front_x(words):
  # +++your code here+++
  list = []
  for i,s in enumerate(words):
    print i,s
    if s[0] == 'x':
        list.append(words.pop(i))
  return list

print front_x(['bbb','ccc','axx','xzz','xaa']) 
```

我的循环只从 0 迭代到 3，所以 print i,s 给我的值直到 'xzz'。请指出我错的地方。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T22:01:38.217

不要在迭代时修改某些内容。`words.pop(i)`修改`words`，您正在通过`enumerate()`.

我建议查看[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)以实现您的明显目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:31:52.120

是的，您可能不应该使用 words.pop()。您想要的单词最有可能在 s 中 - 将其添加到列表中。

另外，请注意，将列表命名为“列表”，或多或少会从本地范围中删除“列表”内置类型。这不是一种成败的交易，但它是 pylint 会警告的。

# jboss - OSwor kflow jar 文件未在 Jboss 5.1 上部署

> ID：10097095
> 
> 赞同：1
> 
> 时间：2012-04-10T22:00:21.770
> 
> 标签：jboss

我正在尝试在 jboss eap 5.1 上部署 OS 工作流文件，但遇到问题。这个 jar 文件包含 osworkflow-2.8.0.jar，我在互联网上看到过帖子说 ejb jar 文件在 jboss 5.1 中产生问题。

```
06,598 INFO  [CopyMechanism] VFS temp dir: 
C:\jboss-eap-5.1.0\jboss-eap-5.1\jboss-as\server\default\tmp
17:10:06,801 INFO  [ZipEntryContext] VFS force nested jars copy-mode is 
enabled.
17:10:07,864 INFO  [ServerInfo] Java version: 1.6.0_27,Sun Microsystems Inc.
17:10:07,864 INFO  [ServerInfo] Java Runtime: Java(TM) SE Runtime 
Environment (build 1.6.0_27-b07)
17:10:07,864 INFO  [ServerInfo] Java VM: Java HotSpot(TM) Client VM 
20.2-b06,Sun Microsystems Inc.
17:10:07,864 INFO  [ServerInfo] OS-System: Windows XP 5.1,x86
17:10:07,864 INFO  [ServerInfo] VM arguments: -Dprogram.name=run.bat 
-Xms128m -Xmx512m -XX:MaxPermSize=256m -Dfile.encoding=Cp1252
17:10:07,879 INFO  [JMXKernel] Legacy JMX core initialized
17:10:12,801 INFO  [WebService] Using RMI server codebase: 
http://127.0.0.1:8083/
17:10:17,332 INFO  [NativeServerConfig] JBoss Web Services - Stack 
Native Core
17:10:17,332 INFO  [NativeServerConfig] 3.1.2.SP7
17:10:18,145 INFO  [LogNotificationListener] Adding notification 
listener for logging mbean 
"jboss.system:service=Logging,type=Log4jService" to server 
org.jboss.mx.server.MBeanServerImpl@82d603[ defaultDomain='jboss' ]
17:10:30,223 ERROR [ProfileDeployAction] Failed to add deployment: 
osworkflow-2.8.0.jar
org.jboss.deployers.spi.DeploymentException: Unable to find class path 
entry ClassPathEntryImpl{path=mmra/WEB-INF/lib/oscore-2.2.5.jar} from 
osworkflow-2.8.0.jar
    at 
org.jboss.deployers.spi.DeploymentException.rethrowAsDeploymentException(DeploymentException.java:49)
    at 
org.jboss.deployers.vfs.plugins.structure.VFSStructureBuilder.applyContextInfo(VFSStructureBuilder.java:188)
    at 
org.jboss.deployers.structure.spi.helpers.AbstractStructureBuilder.populateContext(AbstractStructureBuilder.java:82)
    at 
org.jboss.deployers.structure.spi.helpers.AbstractStructuralDeployers.determineStructure(AbstractStructuralDeployers.java:89)
    at 
org.jboss.deployers.plugins.main.MainDeployerImpl.determineStructure(MainDeployerImpl.java:1001)
    at 
org.jboss.deployers.plugins.main.MainDeployerImpl.determineDeploymentContext(MainDeployerImpl.java:437)
    at 
org.jboss.deployers.plugins.main.MainDeployerImpl.addDeployment(MainDeployerImpl.java:387)
    at 
org.jboss.deployers.plugins.main.MainDeployerImpl.addDeployment(MainDeployerImpl.java:297)
    at 
org.jboss.system.server.profileservice.repository.MainDeployerAdapter.addDeployment(MainDeployerAdapter.java:86)
    at 
org.jboss.system.server.profileservice.repository.ProfileDeployAction.install(ProfileDeployAction.java:61)
    at 
org.jboss.system.server.profileservice.repository.AbstractProfileAction.install(AbstractProfileAction.java:53)
    at 
org.jboss.system.server.profileservice.repository.AbstractProfileService.install(AbstractProfileService.java:403)
    at 
org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1652)
    at 
org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:938)
    at 
org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
    at 
org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:988)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:778)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:543)
    at 
org.jboss.system.server.profileservice.repository.AbstractProfileService.registerProfile(AbstractProfileService.java:308)
    at 
org.jboss.system.server.profileservice.ProfileServiceBootstrap.start(ProfileServiceBootstrap.java:256)
    at 
org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:461)
    at org.jboss.Main.boot(Main.java:221)
    at org.jboss.Main$1.run(Main.java:556)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.io.IOException: Child not found 
mmra/WEB-INF/lib/oscore-2.2.5.jar for 
DelegatingHandler@22970138[path=mmra/WEB-INF/lib/osworkflow-2.8.0.jar 
context=file:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/ 
real=file:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/WEB-INF/lib/osworkflow-2.8.0.jar], 
available children: 
[ZipEntryHandler@15378051[path=mmra/WEB-INF/lib/osworkflow-2.8.0.jar/META-INF 
context=file:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/ 
real=file:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/WEB-INF/lib/osworkflow-2.8.0.jar/META-INF], 
ZipEntryHandler@22682719[path=mmra/WEB-INF/lib/osworkflow-2.8.0.jar/com 
context=file:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/ 
real=file:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/WEB-INF/lib/osworkflow-2.8.0.jar/com], 
ZipEntryHandler@16564336[path=mmra/WEB-INF/lib/osworkflow-2.8.0.jar/overview.html 
context=file:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/ 
real=file:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/WEB-INF/lib/osworkflow-2.8.0.jar/overview.html]]
    at org.jboss.virtual.VirtualFile.findChild(VirtualFile.java:472)
    at 
org.jboss.deployers.vfs.plugins.structure.VFSStructureBuilder.applyContextInfo(VFSStructureBuilder.java:184)
    ... 23 more
17:10:47,503 INFO  [Ejb3DependenciesDeployer] Encountered deployment 
AbstractVFSDeploymentContext@2347435{vfszip:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/WEB-INF/lib/oscore-2.2.5.jar/}
17:10:47,503 INFO  [Ejb3DependenciesDeployer] Encountered deployment 
AbstractVFSDeploymentContext@2347435{vfszip:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/WEB-INF/lib/oscore-2.2.5.jar/}
17:10:47,503 INFO  [Ejb3DependenciesDeployer] Encountered deployment 
AbstractVFSDeploymentContext@2347435{vfszip:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/WEB-INF/lib/oscore-2.2.5.jar/}
17:10:47,503 INFO  [Ejb3DependenciesDeployer] Encountered deployment 
AbstractVFSDeploymentContext@24363946{vfszip:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra.war/}
17:10:47,519 INFO  [Ejb3DependenciesDeployer] Encountered deployment 
AbstractVFSDeploymentContext@24363946{vfszip:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra.war/}
17:10:47,519 INFO  [Ejb3DependenciesDeployer] Encountered deployment 
AbstractVFSDeploymentContext@24363946{vfszip:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra.war/}
17:10:47,519 INFO  [Ejb3DependenciesDeployer] Encountered deployment 
AbstractVFSDeploymentContext@9389903{vfszip:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/mmra.zip/}
17:10:47,519 INFO  [Ejb3DependenciesDeployer] Encountered deployment 
AbstractVFSDeploymentContext@9389903{vfszip:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/mmra.zip/}
17:10:47,519 INFO  [Ejb3DependenciesDeployer] Encountered deployment 
AbstractVFSDeploymentContext@9389903{vfszip:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/deploy/mmra/mmra.zip/}
17:10:48,972 INFO  [MailService] Mail Service bound to java:/Mail
17:10:50,519 WARN  [JBossASSecurityMetadataStore] WARNING! POTENTIAL 
SECURITY RISK. It has been detected that the MessageSucker component 
which sucks messages from one node to another has not had its password 
changed from the installation default. Please see the JBoss Messaging 
user guide for instructions on how to do this.
17:10:52,316 WARN  [XMLLoginConfigImpl] End loadConfig, failed to load 
config: 
vfsfile:/C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/conf/login-config.xml
org.jboss.security.auth.login.ParseException: Encountered "<?xml" at 
line 1, column 1.
Was expecting one of:
<EOF>
<IDENTIFIER> ...

    at 
org.jboss.security.auth.login.SunConfigParser.generateParseException(SunConfigParser.java:401)
    at 
org.jboss.security.auth.login.SunConfigParser.jj_consume_token(SunConfigParser.java:339)
    at 
org.jboss.security.auth.login.SunConfigParser.config(SunConfigParser.java:98)
    at 
org.jboss.security.auth.login.SunConfigParser.parse(SunConfigParser.java:57)
    at 
org.jboss.security.auth.login.SunConfigParser.doParse(SunConfigParser.java:79)
    at 
org.jboss.security.auth.login.XMLLoginConfigImpl.loadSunConfig(XMLLoginConfigImpl.java:440)
    at 
org.jboss.security.auth.login.XMLLoginConfigImpl.loadConfig(XMLLoginConfigImpl.java:405)
    at 
org.jboss.security.auth.login.XMLLoginConfigImpl.loadConfig(XMLLoginConfigImpl.java:375)
    at 
org.jboss.security.auth.login.XMLLoginConfig.startService(XMLLoginConfig.java:218)
    at 
org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSupport.java:376)
    at 
org.jboss.system.ServiceMBeanSupport.pojoStart(ServiceMBeanSupport.java:216)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at 
org.jboss.reflect.plugins.introspection.ReflectionUtils.invoke(ReflectionUtils.java:59)
    at 
org.jboss.reflect.plugins.introspection.ReflectMethodInfoImpl.invoke(ReflectMethodInfoImpl.java:150)
    at 
org.jboss.joinpoint.plugins.BasicMethodJoinPoint.dispatch(BasicMethodJoinPoint.java:66)
    at 
org.jboss.kernel.plugins.dependency.KernelControllerContextAction$JoinpointDispatchWrapper.execute(KernelControllerContextAction.java:243)
    at 
org.jboss.kernel.plugins.dependency.ExecutionWrapper.execute(ExecutionWrapper.java:47)
    at 
org.jboss.kernel.plugins.dependency.KernelControllerContextAction.dispatchExecutionWrapper(KernelControllerContextAction.java:111)
    at 
org.jboss.kernel.plugins.dependency.KernelControllerContextAction.dispatchJoinPoint(KernelControllerContextAction.java:72)
    at 
org.jboss.kernel.plugins.dependency.LifecycleAction.installActionInternal(LifecycleAction.java:221)
    at 
org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:54)
    at 
org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:42)
    at 
org.jboss.dependency.plugins.action.SimpleControllerContextAction.simpleInstallAction(SimpleControllerContextAction.java:62)
    at 
org.jboss.dependency.plugins.action.AccessControllerContextAction.install(AccessControllerContextAction.java:71)
    at 
org.jboss.dependency.plugins.AbstractControllerContextActions.install(AbstractControllerContextActions.java:51)
    at 
org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1652)
    at 
org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:938)
    at 
org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
    at 
org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:988)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:778)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:543)
    at 
org.jboss.deployers.vfs.deployer.kernel.BeanMetaDataDeployer.deploy(BeanMetaDataDeployer.java:125)
    at 
org.jboss.deployers.vfs.deployer.kernel.BeanMetaDataDeployer.deploy(BeanMetaDataDeployer.java:52)
    at 
org.jboss.deployers.spi.deployer.helpers.AbstractSimpleRealDeployer.internalDeploy(AbstractSimpleRealDeployer.java:62)
    at 
org.jboss.deployers.spi.deployer.helpers.AbstractRealDeployer.deploy(AbstractRealDeployer.java:55)
    at 
org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:179)
    at 
org.jboss.deployers.plugins.deployers.DeployersImpl.doDeploy(DeployersImpl.java:1454)
    at 
org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1172)
    at 
org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1193)
    at 
org.jboss.deployers.plugins.deployers.DeployersImpl.install(DeployersImpl.java:1113)
    at 
org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1652)
    at 
org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:938)
    at 
org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
    at 
org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:988)
    at 
org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:826)
    at 
org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:556)
    at 
org.jboss.deployers.plugins.deployers.DeployersImpl.process(DeployersImpl.java:789)
    at 
org.jboss.deployers.plugins.main.MainDeployerImpl.process(MainDeployerImpl.java:699)
    at 
org.jboss.system.server.profileservice.repository.MainDeployerAdapter.process(MainDeployerAdapter.java:117)
    at 
org.jboss.system.server.profileservice.repository.ProfileDeployAction.install(ProfileDeployAction.java:70)
    at 
org.jboss.system.server.profileservice.repository.AbstractProfileAction.install(AbstractProfileAction.java:53)
    at 
org.jboss.system.server.profileservice.repository.AbstractProfileService.install(AbstractProfileService.java:403)
    at 
org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1652)
    at 
org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:938)
    at 
org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
    at 
org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:988)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:778)
    at 
org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:543)
    at 
org.jboss.system.server.profileservice.repository.AbstractProfileService.registerProfile(AbstractProfileService.java:308)
    at 
org.jboss.system.server.profileservice.ProfileServiceBootstrap.start(ProfileServiceBootstrap.java:256)
    at 
org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:461)
    at org.jboss.Main.boot(Main.java:221)
    at org.jboss.Main$1.run(Main.java:556)
    at java.lang.Thread.run(Unknown Source)
17:10:52,550 INFO  [TransactionManagerService] JBossTS Transaction 
Service (JTA version - tag:JBOSSTS_4_6_1_GA_CP07) - JBoss Inc.
17:10:52,550 INFO  [TransactionManagerService] Setting up property 
manager MBean and JMX layer
17:10:53,035 INFO  [TransactionManagerService] Initializing recovery manager
17:10:53,566 INFO  [TransactionManagerService] Recovery manager configured
17:10:53,566 INFO  [TransactionManagerService] Binding 
TransactionManager JNDI Reference
17:10:53,613 INFO  [TransactionManagerService] Starting transaction 
recovery manager 
```

这个问题可能是什么原因？感谢您的时间。我在这里阅读了类似的帖子[将应用程序部署到 JBoss 5 时出错，该应用程序在 JBoss 4.2 上运行良好，](https://stackoverflow.com/questions/530735/error-deploying-an-app-to-jboss-5-that-was-working-fine-on-jboss-4-2) 但没有得到帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:05:16.403

此问题的另一个可能原因是在您的应用程序和 jboss-as/lib、jboss-as/lib/endorsed 目录、jboss-as/server/${server-profile}/lib 中都有 xml 解析器相关的 jar ，或类路径中的其他位置。

其中，以下 jar 的冲突版本可能会导致此问题：

*   夏兰
*   xml-api
*   练习

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:17:07.397

看起来您位于 @ 的登录配置`C:/jboss-eap-5.1.0/jboss-eap-5.1/jboss-as/server/default/conf/login-config.xml`格式不正确。确保 XML 文件格式正确。

那应该处理最后一个错误。一旦你修复了这个帖子，你的发现再次在这里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T10:14:23.960

snowdrop jar 文件用于使用 jboss 5.1 制作 spring 2 这有效：- [http://www.jboss.org/snowdrop 。](http://www.jboss.org/snowdrop)使用 snowdrop-vfs.jar 并更改 web.xml 以修复它。

# ruby - Rails 开发服务器、PDFKit 和多线程

> ID：10097101
> 
> 赞同：6
> 
> 时间：2012-04-10T22:00:56.297
> 
> 标签：ruby, thin, pdfkit

我有一个使用 PDFKit 呈现网页的 pdf 版本的 rails 应用程序。我使用 Thin 作为开发服务器。

问题是当我处于开发模式时。当我使用“bundle exec rails s”启动服务器并尝试渲染任何 PDF 时，整个过程会陷入僵局，因为当您渲染 PDF 时，会向服务器请求一些额外的资源，如图像和 css，并且看起来只有一个线程.

如何配置 Rails 开发服务器以运行多个工作线程？

非常感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-10T22:37:09.363

我发现的最简单的解决方案是[unicorn](http://unicorn.bogomips.org/)。

```
gem install unicorn 
```

创建一个`unicorn.conf`：

```
worker_processes 3 
```

然后使用它：

```
my_gem_tree/bin/unicorn_rails -c unicorn.conf 
```

# python - 是否可以在类中线程化子类？

> ID：10097102
> 
> 赞同：3
> 
> 时间：2012-04-10T22:01:00.787
> 
> 标签：python, multithreading, parent-child, irc, subclass

这是用于 C&C Renegade 的审核机器人，以防有人想要一些背景知识。

我有一个类将充当提供 IRC 连接、与游戏日志（UDP 套接字）的连接等的子类负载的父类，我想知道是否可以拆分其中一些子类（尤其是两个socket 连接 [IRC, gamelog]) 使用 threading 模块进入它们自己的线程。

如果有人有任何建议，即使只是说无法完成，我也会很感激您的意见。

汤姆

编辑：我有使用线程应用程序的经验，所以我不是一个完整的菜鸟，老实说。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:13:59.637

It is feasible, take a look at:

[multiprocessing](http://docs.python.org/dev/library/multiprocessing.html)

Besides the simple process forking, it also provides memory sharing - which is likely to be needed.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:53:53.723

最好的选择是使用[gevent](http://www.gevent.org/)协程运行您的应用程序。这些比线程和进程轻得多。该库是基于绿色线程执行单元创建的。[在这里](http://codescience.wordpress.com/2011/09/05/non-blocking-io-node-js-and-pythons-eventlet/)你可以找到 Eventlet（一个提供同步接口来执行异步 I/O 操作的 python 库，它使用绿色线程来实现协作套接字）和 node.js 的执行模型的一个很好的比较和基准。

# ruby-on-rails - 通过嵌套表单中的复选框添加记录

> ID：10097103
> 
> 赞同：1
> 
> 时间：2012-04-10T22:01:04.233
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.1

我的表单是嵌套的，因此购物车具有产品，产品可以具有功能。我希望能够通过复选框为产品添加功能。

提交后，rails 正在创建购物车记录，但未能使用“accepts_nested_attributes_for”完成嵌套记录的添加。

我的表格非常简单，我没有收到任何错误，只是忽略了字段。我的字段看起来像这样（在表单助手中）

```
= f.fields_for :feature_line_items do |builder|
  = builder.check_box :id
  = builder.label :id, "Feature Label" 
```

在此先感谢，我有点怀疑这是否可能，并且可能需要重新考虑我的数据架构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T08:50:58.937

在 railscasts 中尝试[这一集。](http://railscasts.com/episodes/17-habtm-checkboxes-revised)我还建议使用[simple_form](https://github.com/plataformatec/simple_form) gem，它使表单编程非常简单直接。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T08:57:35.583

看一看 ：

[http://asciicasts.com/episodes/17-habtm-checkboxes](http://asciicasts.com/episodes/17-habtm-checkboxes)

[http://ramblings.gibberishcode.net/archives/rails-has-and-belongs-to-many-habtm-demystified/17](http://ramblings.gibberishcode.net/archives/rails-has-and-belongs-to-many-habtm-demystified/17)

# spotify - 在 Spotify 应用播放列表中编辑时间字段

> ID：10097104
> 
> 赞同：0
> 
> 时间：2012-04-10T22:01:08.370
> 
> 标签：spotify

我在从 Spotify 应用程序的播放列表中删除时间字段时遇到问题。我只想显示歌曲标题、艺术家和专辑。关于这个主题的任何帮助都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:05:23.000

您可以使用 List 对象指定要显示的轨道属性。一个例子在这里：[http ://deceptacle.com/2011/12/26/spotify-app-api-some-things/](http://deceptacle.com/2011/12/26/spotify-app-api-some-things/)

```
var list = new views.List(playlist, function (track) {
    return new views.Track(track, views.Track.FIELD.NAME |
                views.Track.FIELD.ARTIST |
                views.Track.FIELD.ALBUM);
});
$("#playlist").append(list.node); 
```

**更新**

更充实的例子：

```
var pl = m.Playlist.fromURI("spotify:user:rhino_records:playlist:6sSFeKDgDxVR81YqNOuPf2");
var list = new v.List(pl, function (track) {
    return new views.Track(track, views.Track.FIELD.NAME |
                views.Track.FIELD.ARTIST |
                views.Track.FIELD.ALBUM);
});

document.body.appendChild(list.node); 
```

`m`是模型命名空间，`v`是视图命名空间。出于某种原因，它对我来说不太适用。目前似乎没有调用观察者方法。似乎是一个 spotify 后端的东西。经过一番催促，它似乎最终被调用了

# php - 从 S3 获取视频并用 PHP 上传到 YouTube

> ID：10097105
> 
> 赞同：6
> 
> 时间：2012-04-10T22:01:21.493
> 
> 标签：php, upload, youtube, amazon-s3

我有一些代码可以将视频文件上传到 YouTube：

```
$yt = new Zend_Gdata_YouTube($httpClient);

// create a new VideoEntry object
$myVideoEntry = new Zend_Gdata_YouTube_VideoEntry();

// create a new Zend_Gdata_App_MediaFileSource object
$filesource = $yt->newMediaFileSource('file.mov');
$filesource->setContentType('video/quicktime');
// set slug header
$filesource->setSlug('file.mov'); 
```

我在 S3 中有视频，我想将它们上传到 YouTube。我们 S3 帐户中的视频是公开的，所以我可以使用 wget 之类的命令。在运行此脚本 ( ) 之前，我是否应该运行 wgets 视频文件并将其下载到本地的命令`shell_exec("wget ".$s3videoURL)`？

还是我应该尝试输入 MediaFileSource 作为 S3 文件本身的 URL？

主要是，我只需要稳定性（不是经常超时的解决方案）；速度和本地存储并不重要（上传后我可以在本地删除视频文件）。

解决此问题的最佳方法是什么？

谢谢！

更新：我可能应该提到这个脚本每次执行将上传大约 5 个视频到 YouTube。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-12-10T22:38:15.113

这是一个老问题，但我相信我有更好的答案。

您不必将视频写入 HDD，也不能将整个内容保存在 RAM 中（我认为它是一个大文件）。

您可以使用 PHP AWS SDK 和 Google 客户端库从 S3 缓冲文件并将其发送到 YouTube。使用 registerStreamWrapper 方法将 S3 注册为文件系统并使用来自 YouTube API 的可恢复上传。然后，您所要做的就是使用 fread 从 S3 读取块并将它们发送到 YouTube。这样，您甚至可以限制 RAM 的使用。

我假设您从 Google_Video 类创建了视频对象（代码中的 $video）。这是一个完整的代码。

```
<?php
require_once 'path/to/libraries/aws/vendor/autoload.php';
require_once 'path/to/libraries/google-client-lib/autoload.php';

use Aws\S3\S3Client;

$chunkSizeBytes = 2 * 1024 * 1024; // 2 mb
$streamName = 's3://bucketname/video.mp4';

$s3client = S3Client::factory(array(
                    'key'    => S3_ACCESS_KEY,
                    'secret' => S3_SECRET_KEY,
                    'region' => 'eu-west-1' // if you need to set.
                ));
$s3client->registerStreamWrapper();

$client = new Google_Client();
$client->setClientId(YOUTUBE_CLIENT_ID);
$client->setClientSecret(YOUTUBE_CLIENT_SECRET);
$client->setAccessToken(YOUTUBE_TOKEN);

$youtube = new Google_YoutubeService($client);
$media = new Google_MediaFileUpload('video/*', null, true, $chunkSizeBytes);

$filesize = filesize($streamName); // use it as a reguler file.
$media->setFileSize($filesize);

$insertResponse = $youtube->videos->insert("status,snippet", $video, array('mediaUpload' => $media));
$uploadStatus = false;

$handle = fopen($streamName, "r");
$totalReceived = 0;
$chunkBuffer = '';
while (!$uploadStatus && !feof($handle)) {
    $chunk = fread($handle, $chunkSizeBytes);
    $chunkBuffer .= $chunk;
    $chunkBufferSize = strlen($chunkBuffer);
    if($chunkBufferSize > $chunkSizeBytes) {
        $fullChunk = substr($chunkBuffer, 0, $chunkSizeBytes);
        $leapChunk = substr($chunkBuffer, $chunkSizeBytes);
        $uploadStatus = $media->nextChunk($insertResponse, $fullChunk);
        $totalSend += strlen($fullChunk);

        $chunkBuffer = $leapChunk;
        echo PHP_EOL.'Status: '.($totalReceived).' / '.$filesize.' (%'.(($totalReceived / $filesize) * 100).')'.PHP_EOL;
    }

    $totalReceived += strlen($chunk);
}

$extraChunkLen = strlen($chunkBuffer);
$uploadStatus = $media->nextChunk($insertResponse, $chunkBuffer);
$totalSend += strlen($chunkBuffer);
fclose($handle); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T13:15:41.763

“MediaFileSource”必须是真实文件。它不需要 URL，因此您需要先将视频从 S3 复制到您的服务器，然后再将它们发送到 YouTube。

如果您的使用量很少，您可能可以使用“shell_exec”，但由于各种原因，使用[Zend S3 Service](http://framework.zend.com/manual/1.11/en/zend.service.amazon.s3.html)或[cURL](http://php.net/manual/en/book.curl.php)从 S3 提取文件可能更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-05T19:39:29.093

我必须对@previous_developer 的答案进行一些更改，以使其与 Youtube Data API V3 一起使用（请支持他，因为除了他的之外我找不到任何工作代码）。

```
$streamName = 's3://BUCKET-NAME/VIDEO.mp4';

/**
Since I have been using Yii 2\. Use the AWS 
SDK directly instead.
*/

    $aws = Yii::$app->awssdk->getAwsSdk();
    $s3client = $aws->createS3();

    $s3client->registerStreamWrapper();

    $service = new \Google_Service_YouTube($client);

    $snippet = new \Google_Service_YouTube_VideoSnippet();
    $snippet->setTitle("Test title");
    $snippet->setDescription("Test descrition");
    $snippet->setTags(array("tag1","tag2"));
    $snippet->setCategoryId("22");

    $status = new \Google_Service_YouTube_VideoStatus();
    $status->privacyStatus = "public";

    $video = new \Google_Service_YouTube_Video();
    $video->setSnippet($snippet);
    $video->setStatus($status);

    $client->setDefer(true);
    $insertResponse = $service->videos->insert("status,snippet", $video);

    $media = new MediaFileUpload(
        $client,
        $insertResponse,
        'video/*',
        null,
        true,
        false
    );

    $filesize = filesize($streamName); // use it as a reguler file.
    $media->setFileSize($filesize);

    $chunkSizeBytes = 2 * 1024 * 1024; // 2 mb

    $uploadStatus = false;

    $handle = fopen($streamName, "r");
    $totalSend = 0;
    $totalReceived = 0;
    $chunkBuffer = '';
    while (!$uploadStatus && !feof($handle)) {
        $chunk = fread($handle, $chunkSizeBytes);
        $chunkBuffer .= $chunk;
        $chunkBufferSize = strlen($chunkBuffer);
        if($chunkBufferSize > $chunkSizeBytes) {
            $fullChunk = substr($chunkBuffer, 0, $chunkSizeBytes);
            $leapChunk = substr($chunkBuffer, $chunkSizeBytes);
            $uploadStatus = $media->nextChunk($fullChunk);
            $totalSend += strlen($fullChunk);

            $chunkBuffer = $leapChunk;
            echo PHP_EOL.'Status: '.($totalReceived).' / '.$filesize.' (%'.(($totalReceived / $filesize) * 100).')'.PHP_EOL;
        }

        $totalReceived += strlen($chunk);
    }

    $extraChunkLen = strlen($chunkBuffer);
    $uploadStatus = $media->nextChunk($chunkBuffer);
    $totalSend += strlen($chunkBuffer);
    fclose($handle);

    // If you want to make other calls after the file upload, set setDefer back to false
    $client->setDefer(false); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-04-07T11:37:58.077

$chunkSizeBytes = 2 * 1024 * 1024; // 2 兆

```
 $s3client = $this->c_aws->getS3Client();
    $s3client->registerStreamWrapper();

    try {

        $client = new \Google_Client();

        $client->setAccessType("offline");
        $client->setApprovalPrompt('force');

        $client->setClientId(GOOGLE_CLIENT_ID);
        $client->setClientSecret(GOOGLE_CLIENT_SECRET);
        $token = $client->fetchAccessTokenWithRefreshToken(GOOGLE_REFRESH_TOKEN);

        $client->setAccessToken($token);

        $youtube = new \Google_Service_YouTube($client);

        // Create a snippet with title, description, tags and category ID
        // Create an asset resource and set its snippet metadata and type.
        // This example sets the video's title, description, keyword tags, and
        // video category.
        $snippet = new \Google_Service_YouTube_VideoSnippet();
        $snippet->setTitle($title);
        $snippet->setDescription($summary);
        $snippet->setTags(explode(',', $keywords));

        // Numeric video category. See
        // https://developers.google.com/youtube/v3/docs/videoCategories/list 
```

// $snippet->setCategoryId("22");

```
 // Set the video's status to "public". Valid statuses are "public",
        // "private" and "unlisted".
        $status = new \Google_Service_YouTube_VideoStatus();
        $status->privacyStatus = "public";

        // Associate the snippet and status objects with a new video resource.
        $video = new \Google_Service_YouTube_Video();
        $video->setSnippet($snippet);
        $video->setStatus($status);

        // Setting the defer flag to true tells the client to return a request which can be called
        // with ->execute(); instead of making the API call immediately.
        $client->setDefer(true);

        $insertRequest = $youtube->videos->insert("status,snippet", $video);

        $media = new \Google_Http_MediaFileUpload(
            $client,
            $insertRequest,
            'video/*',
            null,
            true,
            $chunkSizeBytes
        );

        $result = $this->c_aws->getAwsFile($aws_file_path);

        $media->setFileSize($result['ContentLength']);

        $uploadStatus = false;

        // Seek to the beginning of the stream
        $result['Body']->rewind();

        // Read the body off of the underlying stream in chunks
        while (!$uploadStatus && $data = $result['Body']->read($chunkSizeBytes)) {

            $uploadStatus = $media->nextChunk($data);

        }
        $client->setDefer(false);
        if ($uploadStatus->status['uploadStatus'] == 'uploaded') {
            // Actions to perform for a successful upload
             $uploaded_video_id = $uploadStatus['id'];
            return ($uploadStatus['id']);
        }
    }catch (\Google_Service_Exception $exception){
        return '';
        print_r($exception);
    } 
```

# android - Android - 在 ImageView 对象上显示实时视频帧 - 线程，AsyncTask？

> ID：10097112
> 
> 赞同：1
> 
> 时间：2012-04-10T22:01:38.197
> 
> 标签：android, multithreading, camera, android-asynctask, imageview

我正在尝试在目标 ImageView 对象中显示实时视频帧。关键是我不想使用整个表面，因为布局中有更多控件（即按钮，...）。我想应该使用 Thread 或 AsyncTask，但我不知道该怎么做。任何提示都非常受欢迎。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T14:10:16.610

您可以将您的相机预览表面设置为任何您想要的大小，它是一个与其他任何元素一样的 UI 元素。

或者，您可以从 onPreview 回调（作为 NV12）中将帧作为字节流抓取，使用[YuvImage](http://developer.android.com/reference/android/graphics/YuvImage.html)解码为 jpeg并使用 BitmapFactory 将它们转换为位图，然后在您的图像视图中显示位图。

我做了类似的事情，但是用两部手机而不是一部，[这里](https://code.google.com/p/mover-bot/source/browse/trunk/Android-1.0/src/com/agentx3r/moverbot/RoverServerActivity.java#556)和[这里](https://code.google.com/p/mover-bot/source/browse/trunk/Android-1.0/src/com/agentx3r/moverbot/RoverClientActivity.java#442)。

# facebook - Facebook - Heroku - 标签问题

> ID：10097115
> 
> 赞同：1
> 
> 时间：2012-04-10T22:01:52.353
> 
> 标签：facebook, heroku, tabs

使用 Facebook 的 Heroku 集成时遇到问题。

我有一个业务页面，我想要一个“Facebok Tab”，它链接到一个时间表。

据我了解，我必须在开发人员区域设置一个 facebook 应用程序，并将画布设置为指向我的托管文件。位于[https://warm-mist-9082.herokuapp.com/](https://warm-mist-9082.herokuapp.com/)我的应用程序的 facebook 命名空间当前设置为[https://apps.facebook.com/weblessoncrashes/](https://apps.facebook.com/weblessoncrashes/)。

在应用程序中，我将 Tab url 设置为[https://warm-mist-9082.herokuapp.com/lessons.php](https://warm-mist-9082.herokuapp.com/lessons.php)

所以理论上当我点击我的标签时（[https://www.facebook.com/WebIsEasy/app_388846884472817](https://www.facebook.com/WebIsEasy/app_388846884472817)）

它应该加载 classes.php 的内容，即

```
<html>
<head>
<title>hihi</title>
</head>
<body>
nonono
</body>
</html> 
```

然而。您在现实中将看到的只是一个带有空白画布的 Facebook 框架。

我尝试改变标签以使用 facebook 命名空间，并检查所有 SSL 证书和条目是否正确。

我现在已经静止不动了。

任何帮助都是完美的！

谢谢

# django - django 获取 ForeignKey 相关模型的不同“孩子”列表（并在模板中执行此操作？）

> ID：10097116
> 
> 赞同：1
> 
> 时间：2012-04-10T22:02:01.747
> 
> 标签：django, django-templates, foreign-keys, django-generic-views

我正在制作一个已发行音乐专辑的数据库

模型.py

```
class Image(models.Model):
    image = models.ImageField(....

class Album(models.Model):
    title = models.CharField(....

class Release(models.Model):
    album = models.ForeignKey(Album)
    cover_art = models.ForeignKey(Image, blank=True, null=True, on_delete=models.SET_NULL) 
```

在我的模板中（目前我正在使用通用视图）我有：

```
{% for a in album_list %}
    {% for r in a.release_set.all %}
        {% if r.cover_art %}
        # display cover art image
        {% endif %}
    {% endfor %}
{% endfor %} 
```

问题是，有时一张专辑已经发行了好几次，封面都是一样的，在这种情况下，我只想显示一次图片，并附上一些文字列出它所属的发行版。

我试过了：

```
{% for i in a.release_set.cover_art %}
{% for i in a.release_set.cover_art_set %}
{% for i in a.release_set.all.cover_art %}
{% for i in a.release_set.all.cover_art_set %} 
```

或者在更简单的情况下，如果有多个图像，我至少希望将图像显示得更小。

```
{% if a.release_set.count > 1 %} # works but displays duplicate images
{% if a.release_set.cover_art_set.count > 1 %} # doesn't work (see above) 
```

是否可以通过反转此 ForeignKey 查找然后询问他们的孩子的集合来获得相关的对象列表？我能想到的唯一方法是在视图中组装一些元组/列表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T11:11:29.337

我在 Album 模型上使用了一种新方法来管理它：

```
class Album(models.Model):
    title = models.CharField(....

    def distinct_cover_images(self):
        "Returns the queryset of distinct images used for this album cover"
        pks = self.release_set.all().values_list('cover_art__pk', flat=True)
        distinct_cover_images = Images.objects.filter(pk__in=pks).distinct()
        return distinct_cover_images 
```

那么模板就简单多了：

```
{% for i in a.distinct_cover_images %} 
```

感谢@danilobargen，感谢他对这段代码的贡献。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T22:06:03.160

如果我理解正确：

*   一张专辑可以有多个版本
*   发行版只有一个封面
*   您想遍历专辑的所有封面

在这种情况下，以下应该有效：

```
{% for release in a.release_set.all %}
  {{ release.cover_art.image }}
{% endfor %} 
```

如果您想防止列出相同的封面，您可以比较循环中的封面，或者在您的视图中准备一个具有不同封面的集合，以便您可以将其传递给模板。

```
# Solution using a set
context['distinct_coverimages'] = \
    set([r.cover_art.image for r in album.release_set.all()])

# Solution using two queries, might perform better
pks = album.release_set.values_list('cover_art__pk', flat=True)
context['distinct_coverimages'] = models.Image.filter(pk__in=pks).distinct() 
```

第三种选择是为您的专辑创建一个自定义模板过滤器，以返回所有不同的发行封面。

无论如何，我建议在你的 Django shell 中调试这些东西。您可以使用`./manage.py shell`. 如果你已经安装了[django-extensions](https://github.com/django-extensions/django-extensions)，你也可以使用它`./manage.py shell_plus`来自动加载所有模型。所有不需要参数的对象属性和函数（例如，普通的实例属性或没有参数的实例函数，如`'string'.isalnum()`）也可以在模板中以相同的方式使用（只是没有括号）。

# php - 从数据库中获取图像，然后在 url 中写入文件

> ID：10097125
> 
> 赞同：0
> 
> 时间：2012-04-10T22:02:51.570
> 
> 标签：php, header

我正在开发我的游戏网站，但为了让 Facebook API 正常工作，我必须制作一个可以根据游戏 ID 获取缩略图的新脚本。这就是这个脚本试图做的，但我得到了这个错误。

```
Warning: readfile(localhost/thumbs/6c9e40d35e8cf07e.png) [function.readfile]: failed to open stream: No such file or directory in B:\home\home\thumb.php on line 22 
```

我想知道你们中是否有人可以帮助我解决这个问题。

```
<?php
require_once "functions.php";
if(!isset($_REQUEST['t'])){
die("No ID Defined");
}
$t = $_REQUEST['t'];
$t = intval($t);
connect();
$fetch = fetchdata("select * from `games` where id = $t");
$thumb = $fetch{'thumb'};
$file = "/thumbs/$thumb";
$filename = basename($file);
$file_extension = strtolower(substr(strrchr($filename,"."),1));
switch( $file_extension ) {
    case "gif": $ctype="image/gif"; break;
    case "png": $ctype="image/png"; break;
    case "jpeg":
    case "jpg": $ctype="image/jpg"; break;
    default:
}
header($ctype);
readfile($_SERVER['HTTP_HOST'].'/thumbs/'.$thumb);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:07:46.150

你不需要PHP`http`也不需要工作……事实上，使用 http 可以加载这些图像……`https``readfile``slower`

```
 readfile('/thumbs/'.$thumb); //or
 readfile(PATH_TO_LOCAL_DIR. '/thumbs/'.$thumb); 
```

应该可以正常工作。

这是您的脚本的 10 行版本

```
require_once "functions.php";
if (! isset ( $_REQUEST ['t'] )) {
    die ( "No ID Defined" );
}
connect ();
$fetch = fetchdata ( sprintf("select * from `games` where id = '%d'",$_REQUEST ['t']) );
if(!is_file("thumbs/" . $fetch ['thumb'] ))
    die("Thum Does not exist");
header ( "Content-type: ", image_type_to_mime_type ( exif_imagetype ( $fetch ['thumb'] ) ) );
readfile ( "thumbs/" . $fetch ['thumb'] ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:14:46.920

您需要像这样实际设置 mime-type 标头：

```
header(sprintf("Content-Type: %s", $ctype)); 
```

然后查看[@Baba 的回答](https://stackoverflow.com/a/10097175/367456)。

# r - R brew 选择语句

> ID：10097131
> 
> 赞同：0
> 
> 时间：2012-04-10T22:03:21.617
> 
> 标签：r, r-brew

问题 - 回复：带有 HTML 的 R brew 包（使用 Rook）

使用表单检索查询时，通常在屏幕刷新时，用户预选的选项在表单中保持选中状态。例如，如果有一个姓名字段，我输入 John，... 输入其他表单数据，点击提交，当页面刷新时，表单仍会在姓名字段中显示“John”，而不是一个空框。

我可以使用类似的东西在文本类型输入字段中预先填写一个条目——

```
 ...
    <input class="someclass" type="text" name="Name" value="<%=Name%>" />
    ... (other form data) 
```

当用户点击提交并且页面刷新时，R 使用 <%=Name%> 中的值预填充名称字段

使用下拉菜单时，我在复制相同内容时遇到了一些困难。这个想法是，当页面刷新时，用户在先前查询中选择的选项将处于活动状态。

```
 <select class="someclass" name="group3" style="width:200px;">
    <option value="," selected>None</option>
    <option value="Name,">Name)</option>
    <option value="Phone">Phone</option>
    </select> 
```

我认为一种方法可能是输入类似的内容，

`<%if (group3=="Name"){ print("selected") } ...`等针对各个行中的每个选项，但这有点麻烦。能否请您分享您的想法，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T02:45:15.420

最终使用 jQuery 完成了这项工作。标签中的内联 <%= if(..) print ("selected") ... 不起作用。

添加 id=something 标签来选择 --

```
<select class="someclass" name="group3" id="myselect" style="width:200px;">
<option value=",">None</option>
<option value="Name">Name)</option>
<option value="Phone">Phone</option>
</select> 
```

将 jquery.js 添加到标头中的 html 文件中--

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script> 
```

在我的 Rook brew 文件中，我有类似的东西，

```
forminput <- req$GET()
userselection <- forminput$group3 #group3 is the class name for the select statement 
```

在 HTML 文档中，在结束表单标记之前，输入以下内容 -

```
<script>
$("#myselect").val("<%=userselection%>").attr("selected", "selected");
</script> 
```

# selenium - junit.framework.AssertionFailedError：在寄存器中找不到测试

> ID：10097132
> 
> 赞同：4
> 
> 时间：2012-04-10T22:03:23.860
> 
> 标签：selenium, junit, selenium-rc

我在让这个测试用例工作时遇到问题。谁能指出我正确的方向？我知道我做错了什么，我只是不知道是什么。

```
import org.junit.*;
import com.thoughtworks.selenium.*;
import org.openqa.selenium.server.*;

@SuppressWarnings("deprecation")

public class register extends SeleneseTestCase {

  Selenium selenium;
  private SeleniumServer seleniumServer;
  public static final String MAX_WAIT = "60000";
  public final String CRN = "12761";

  public void setUp() throws Exception {
    RemoteControlConfiguration rc = new RemoteControlConfiguration();
    rc.setAvoidProxy(true);
    rc.setSingleWindow(true);
    rc.setReuseBrowserSessions(true);

    seleniumServer = new SeleniumServer(rc);
    selenium = new DefaultSelenium("localhost", 4444, "*firefox", "http://google.com/");
    seleniumServer.start();
    selenium.start();
  }

  @Test
  public void register_test() throws Exception {
    //TESTS IN HERE
  }

  @After
  public void tearDown() throws Exception {
    selenium.stop();
    // Thread.sleep(500000);
  }
} 
```

我收到以下错误：

```
junit.framework.AssertionFailedError: No tests found in register
at jumnit.framework.TestSuite$1.runTest(TestSuite.java:97) 
```

我难住了。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-10T22:15:52.477

您不能既扩展 TestCase（或 SeleniumTestCase）又使用 JUnit 注释（@Test）。JUnit3 和 4 的测试运行器不同，我的假设是当 JUnit 看到您扩展了 TestCase 时，它​​会使用旧运行器。

删除 @Test 注释，而是按照旧的约定命名你的测试，并以“test”为前缀，这样就可以解决它。

```
public void testRegister() throws Exception {
  //TESTS IN HERE
} 
```

PS。我建议遵循更标准的 Java 命名约定，例如驼峰式大小写。

聚苯乙烯。这是一个更详细地解释这一点的[链接。](https://stackoverflow.com/questions/2635839/junit-confusion-use-extend-testcase-or-test)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-11T14:53:44.370

这意味着您没有在当前运行的以下测试用例类中创建以 test 开头的方法名称

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-23T19:57:15.707

`<junit>`在我的案例中，我能够通过指向 1.7 或更高版本的 Ant来解决这个错误——即使用 Ant 任务运行测试。Ant 1.7+ 尊重嵌套`<classpath>`元素，我在其中指向一个 JUnit 4.x jar，正如 CodeSpelunker 指出的那样，它理解 @Test 注释。 [http://ant.apache.org/faq.html#delegating-classloader](http://ant.apache.org/faq.html#delegating-classloader)为我提供了一个惊喜时刻。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-07T12:27:12.057

我`mockk`在 Kotlin for Android 中使用，我遇到了这个错误。

我的班级是这样声明的（由 Android Studio 自动生成）：

```
class MyClassTest : TestCase() { 
```

但删除 TestCase 修复了错误

```
class MyClassTest { 
```

# javascript - 多维布尔数组检查Javascript中是否全部为真

> ID：10097136
> 
> 赞同：9
> 
> 时间：2012-04-10T22:03:43.310
> 
> 标签：javascript, jquery, multidimensional-array, boolean

我有一个多维的布尔数组，每个元素都设置为 true：

var boolarray= $.extend(true, [], board);

board 是一个 3x3 的多维字符串数组。boolarray 只是这个的深层副本。

```
 for (var i=0; i < boolarray.length; i++) {
              boolarray[i]
              for (var j=0; j < boolarray[i].length; j++) {
                boolarray[i][j] = true;
              };
            }; 
```

这给了我：

boolarray = [true,true,true,true,true,true,true,true,true]

我想检查所有元素是否为真，如果是这样则返回。但是我下面的方法不起作用。

```
if (boolarray == true)
{
console.log("all elements in boolarray are true, return true ")
return true;
}
else 
{
console.log("not all elements in boolarray are true, return false")
return false;
} 
```

关于如何检查 boolarray 是否全部正确的任何想法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-10T22:17:29.537

使用`.every()`...

```
var boolarray = [true,true,true,true,true,true,true,true,true];

boolarray.every(Boolean); 
```

***演示：http:*** [//jsfiddle.net/gFX7X/](http://jsfiddle.net/gFX7X/)

* * *

如果第一个循环的唯一目的是创建第二个循环，那么您可以跳过它并执行此操作...

```
var boolarray = [[true, true, true], 
                 [true, true, true], 
                 [true, true, true]];

boolarray.every(function(arr) {
    return arr.every(Boolean)
}); 
```

***演示：http:*** [//jsfiddle.net/gFX7X/1/](http://jsfiddle.net/gFX7X/1/)

* * *

或者是前一个版本的稍短版本：

```
boolarray.every(Function.call.bind(Boolean, null)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T22:16:09.123

作为使用布尔数组的替代方法，为什么不使用简单的十六进制数来存储您的电路板（然后使用位操作来更改/测试），即

000 000 001

==

1个十进制

111 111 111

==

511 (256 + 128 + 64 + 32 + 16 + 8 + 4 + 2 + 1)

将棋盘位置设置为真或假将变得有点操作，测试将变得像 parseInt = 511 一样简单......

在 javascript 中查看[位操作](http://www.i-programmer.info/programming/javascript/2550-javascript-bit-manipulation.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T22:08:10.637

编写一个在给定参数（我们的二维数组）上运行循环的函数，并检查每个单元格是否为真。如果不是，则返回 false。循环结束后，返回true；

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T22:08:40.750

您需要再次遍历数组以检查所有值；以与您分配它们的方式非常相似的方式：

```
for (var i=0; i < boolarray.length; i++) {
    for (var j=0; j < boolarray[i].length; j++) {
        if (boolarray[i][j] == false) {
            return false;
        }
    };
}; 

return true; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-10T22:08:49.720

```
bool alltrue = true;
for (var i=0; i < boolarray.length; i++) {
              boolarray[i]
              for (var j=0; j < boolarray[i].length; j++) {
                if(boolarray[i][j] != true) {
                    alltrue = false;
                }
              };
            }; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-10T22:09:36.413

```
for(var i in boolarray)
    if(!boolarray[i]) return false;

return true; 
```

...这是基于您的陈述：

> boolarray = [true,true,true,true,true,true,true,true,true]

这不是多维数组。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-10T22:12:25.517

ES5 符号示例（简化）：

```
var foo = [ [true, true, true], [true, true], [true, true], [false, true], [true, true] ];

var boolarray = foo.every(function(level2, i) {
    return level2.every(function(bool) {
        return bool;
    });
}); 
```

`Array.prototype.every`这个例子利用了返回从循环函数返回的结果的事实。一旦`falsy`返回一个值，迭代也会停止。

^(如果您需要保持与旧版浏览器 IE6/7 的兼容，您可以下载众多 ES5 shim 库之一)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-10T22:13:32.383

您的名为 boolArray 的变量是一个数组，只要它不为空，您编写的代码就会将其设置为 true，以获得您想要的东西，您需要这样的东西：

```
var boolArrayValue = true; // valor final a usar es boolarray value
for(var i = 0;i<boolarray.length;i++){
    for(var a = 0;a<boolarray[i].length;a++){
        boolArrayValue = boolArrayValue && boolarray[i][a];
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-10T22:16:33.520

```
boolarray = [true,true,true,true,true,true,true,true,true];
Array.prototype.isFalse=function(){
    for(var i=0;i<this.length;i++)
    {
        if(this[i]!=true) return false;
    }
    return true;
};
alert(boolarray.isFalse());​ 
```

[这里](http://jsfiddle.net/heera/KG4Ed/)有一个小提琴。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-23T21:48:46.590

检查任意深度的嵌套数组的递归版本：

```
function deepEvery(arr, fn, _this) {
    return (function iterate(arr, i) {
        var len = arr && arr.length;
        if (!len || i >= len) {
            return false;
        }
        var first = arr[i] && typeof arr[i].splice === "function" 
            ? iterate(arr[i], 0) 
            : fn.call(_this || this, arr[i], i);
        i += 1;
        return !!first && (i >= len || iterate(arr, i));
    })(arr, 0);
} 
```

用法：

```
deepEvery([[true, true, true], 
           [true, true, true], 
           [true, true, true]], function(el, i) {
    return el;
}); 
```

请注意，这允许在回调中进行任何类型的检查。如果您传递给任何元素的函数`deepEvery`返回`false`，那么总体结果是`false`; 否则，结果为`true`。例子：

```
deepEvery([4, true, [6, [5, "F"], 6]], function(el, i) {
    return typeof el === "number";
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-22T14:32:55.750

使用**[jQuery.grep()](http://api.jquery.com/jQuery.grep/)**和**[jQuery.map()](http://api.jquery.com/jQuery.map/)**：

```
var flattenedBoolarray = $.map(boolarray, function recurs(n) {
    return ($.isArray(n) ? $.map(n, recurs): n);
});

if ($.grep(flattenedBoolarray, function(e, i){return e}, true).length) {
    // In case if any isn't true
} else {
    // In case if all are true
} 
```

**演示：http: [//jsfiddle.net/tYSu6/](http://jsfiddle.net/tYSu6/)**

# emacs - 函数后和条件后缩进行为的区别是什么

> ID：10097137
> 
> 赞同：0
> 
> 时间：2012-04-10T22:03:43.670
> 
> 标签：emacs

我的自动缩进功能是将函数的开头与控制语句的开头区别对待。我不知道它可以检测到差异。当检测到这些环境时，确定格式化行为的配置选项是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T22:09:40.863

自动缩进的配置取决于使用的主要模式；尝试`C-h m`查看当前缓冲区主要模式的文档。

# mfc - MFC：FrameWnd 如何知道停靠窗格何时调整大小？

> ID：10097138
> 
> 赞同：5
> 
> 时间：2012-04-10T22:03:48.557
> 
> 标签：mfc

我有`CFrameWndEx`几个停靠`CDockablePanes`但我似乎无法在停靠窗格的大小发生更改时收到通知（因此我可以相应地调整其他窗口的大小）。尝试 Spy++ 检查消息，但自定义绘图似乎是唯一的（这似乎不合适）并且还尝试覆盖 RecalcLayout，但在这种情况下不会调用。 `OnSize`不起作用，因为框架本身的大小没有改变。有任何想法吗？

（Ps：我很确定这是可能的，因为我曾经有一个拆分窗口作为“客户”区域，当窗格调整大小时它会神奇地调整自己的大小）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-08T12:21:32.460

好吧，这有点奇怪，但我有完全相同的问题，在谷歌上搜索，然后看到我在一年前回答了这个问题，但完全误解了这个问题的含义:)

无论如何，为了参考未来的谷歌用户，这个问题的答案是覆盖 virtual void CFrameWndEx::EAdjustDockingLayout(HDWP hdwp) 并在那里调整客户端控件的大小。要在隐藏/关闭/任何窗格之后获取客户区，请使用 m_dockManager.GetClientAreaBounds()。我的 AdjustDockingLayout 看起来像这样（m_View 是应该填充整个客户区的子窗口，无论任何停靠窗格的状态如何，都可以根据需要进行调整）：

```
void CMainFrame::AdjustDockingLayout(HDWP hdwp)
{
    CFrameWndEx::AdjustDockingLayout(hdwp);

    if (m_View.GetSafeHwnd()) {
        CRect rectUsable = m_dockManager.GetClientAreaBounds();
        m_View.MoveWindow(rectUsable);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T15:13:15.023

我认为问题在于 CFrameWndEx 的“内容”本身就是一个窗口，并且在该窗口中存在“主要内容”窗口。使用 Spy++ 检查窗口层次结构，以及 CFrameWndEx 的任何子窗口（可停靠窗格除外）是否在调整大小时收到消息。基本上，当停靠窗格停靠时，CFrameWndEx 会调整其子项的大小，因此您必须在那里检测它并（如果需要）将消息反射回 CFrameWndEx（如果确实需要它）。

或者，也许我误解了，这正是我描述的你想要做的事情。在这种情况下，我认为将窗口添加到 CFrameWndEx 的方式有问题，因为它应该自己处理调整大小。创建时子窗口的父级是否正确设置为 CFrameWndEx？

# android - Android 4 ICS 中的 TYPE_SYSTEM_OVERLAY

> ID：10097145
> 
> 赞同：3
> 
> 时间：2012-04-10T22:04:27.437
> 
> 标签：android, android-4.0-ice-cream-sandwich, android-windowmanager

我的问题与这里的问题类似，[ICS 中的 TYPE_SYSTEM_OVERLAY](https://stackoverflow.com/q/9656185/563306)

但是有没有其他方法可以在 ICS 中通过触摸事件实现系统覆盖？

市场上有一些使用覆盖的应用程序，例如，

Dock4Droid [https://play.google.com/store/apps/details?id=com.urbandroid.dock](https://play.google.com/store/apps/details?id=com.urbandroid.dock)

和

[https://play.google.com/store/apps/details?id=mobi.conduction.swipepad.android](https://play.google.com/store/apps/details?id=mobi.conduction.swipepad.android)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T17:03:50.637

我看到 TYPE_SYSTEM_ALERT 在 ICS 上仍然有效，我需要使用这个标志想出一个解决方案。

# php - PHP 内存不足？或者？

> ID：10097151
> 
> 赞同：2
> 
> 时间：2012-04-10T22:05:32.500
> 
> 标签：php

我有一个运行 IIS7 的 Web 服务器，我刚刚更新到 PHP 5.3。我有两个似乎运行良好的站点，它们都使用了少量的 PHP。我目前在这台服务器上测试的版本大概使用了很多……更多。

我遇到的问题是在我的测试服务器（本地 XAMPP 安装）上，我的页面加载正常。当我将它推送到我的服务器并在浏览器中点击页面时，我得到以下信息：

```
Id ) return true; } return false; } public static function PrintSelector($SelectionArray) { if( !isset($SelectionArray)) { Page::WriteLine("
No selections are available.

"); } else { $FoundViewer = false; foreach($SelectionArray as $Selection) { if( $Selection->IsViewing()) { $ViewerSelection = $Selection; $FoundViewer = true; } } if( $FoundViewer ) { Page::WriteLine("Show / Hide " . get_class($Selection) . " Selections"); $ViewerSelection->PrintOverview(); Page::WriteLine("
"); } Page::WriteLine("\n"); foreach($SelectionArray as $Selection) if( $Selection->IsSelectable() && !$Selection->IsViewing()) $Selection->PrintSelection(); Page::WriteLine("
\n"); if( $FoundViewer ) Page::WriteLine("
"); } } } ?> 
```

这只是我的新网站的一些底层代码。

经过进一步调查，我跑到我的其他网站之一并得到这个：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>AGP Credential Manager</title>

<link rel="stylesheet" href="styles.css" type="text/css" />

<script type="text/javascript">

function submitPageForm()

{

  document.forms["pageForm"].submit();

}

function submitForm(formName)

{

  document.forms[formName].submit();

}

</script>

<script language="javascript">

  function toggleDiv(divid){

    if(document.getElementById(divid).style.display == 'none'){

      document.getElementById(divid).style.display = 'block';

    }else{

      document.getElementById(divid).style.display = 'none';

    }

  }

</script></head>

<body>

<div id="wrap">

    <div class="header">

        <!-- TITLE -->

        <h1><a href="#">AGP Credential Manager</a></h1>

        <!-- END TITLE -->

    </div>

    <div id="nav">

        <ul>    

            <!-- MENU --> 
```

在源代码中。而且我敢肯定你可以推测，我的前端并不多。似乎 PHP 开始执行，但在...中失败了几百行，原因不明。

好奇是否有人以前见过这个并且碰巧知道修复？会很好。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:13:14.270

IIS 和 Apache 是两种不同的野兽。为了您自己的理智，请努力使您的开发环境接近您的部署环境。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T22:34:29.193

我怀疑问题可能是您的 PHP 脚本使用[短标签](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag) `<?`，但 PHP 配置是这样的，它不接受短标签并需要完整标签`<?php`。

您可以更改`php.ini`并设置`short_open_tag`或`1`修改脚本以使用完整的打开标记。我建议使用完整的打开标签，因为短标签在带有 PHP 扩展的 XML 文件中存在问题。

您还需要检查短回声，`<?=`并将其替换为`<?php echo`.

您可以尝试一些正则表达式：

```
/<?([^p])/<?php$1/g
/<?= /<?php echo /g 
```

# sql-server-2008 - 从 SQL Server 中的重复值中选择第一条记录

> ID：10097152
> 
> 赞同：0
> 
> 时间：2012-04-10T22:05:38.850
> 
> 标签：sql-server-2008, duplicate-removal, distinct-values

我有这个查询：

```
Select DFC_NOMBRE_CAMPO, DFC_TITULO, TDT_DATO_MOTOR, DFC_LONGITUD
FROM MEM_DEFINICIONES_CAMPOS JOIN MEM_TIPOS_DATOS ON DFC_TDT_CODIGO = TDT_CODIGO 
WHERE DFC_ALMACENAR_BASEDATOS = 'S'
ORDER BY DFC_NOMBRE_CAMPO ASC, DFC_LONGITUD DESC 
```

结果，给我重复的值：

```
DFC_NOMBRE_CAMPO                                   DFC_TITULO                                         TDT_DATO_MOTOR       DFC_LONGITUD
-------------------------------------------------- -------------------------------------------------- -------------------- ---------------------------------------
CodigoRespuesta                                    Cod. Respuesta                                     Varchar              3
CodigoRespuesta                                    Cod. Resp.                                         Numeric              3
CodigoRespuesta                                    Cod Respuesta                                      Numeric              3
CodigoTransaccion                                  NULL                                               Numeric              2
CodigoTransaccion                                  Codigo Transaccion                                 Numeric              2
CodigoTransaccion                                  Codigo Transaccion                                 Numeric              2
Estado                                             Estado                                             Numeric              2
FechaHora                                          Fecha                                              Varchar              14
FechaHora                                          Fecha                                              Varchar              14
FechaHora                                          Fecha                                              Varchar              14
NUT                                                NUT                                                Numeric              9
NUT                                                NUT                                                Numeric              8
NUT                                                NUT                                                Numeric              8 
```

我如何只能从每个（DFC_NOMBRE_CAMPO）组中获取第一条记录。像这样：

```
DFC_NOMBRE_CAMPO                                   DFC_TITULO                                         TDT_DATO_MOTOR       DFC_LONGITUD
-------------------------------------------------- -------------------------------------------------- -------------------- ---------------------------------------
CodigoRespuesta                                    Cod. Respuesta                                     Varchar              3
Estado                                             Estado                                             Numeric              2
FechaHora                                          Fecha                                              Varchar              14
NUT                                                NUT                                                Numeric              9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:11:35.023

尝试这个：

```
;
WITH CTE AS
     (
         SELECT DFC_NOMBRE_CAMPO,
                DFC_TITULO,
                TDT_DATO_MOTOR,
                DFC_LONGITUD,
                ROW_NUMBER() OVER(
                    PARTITION BY DFC_NOMBRE_CAMPO ORDER BY DFC_NOMBRE_CAMPO ASC,
                    DFC_LONGITUD DESC
                ) Rn
         FROM   MEM_DEFINICIONES_CAMPOS
                JOIN MEM_TIPOS_DATOS
                     ON  DFC_TDT_CODIGO = TDT_CODIGO
         WHERE  DFC_ALMACENAR_BASEDATOS = 'S'
     )

SELECT *
FROM   CTE
WHERE  Rn = 1 
```

# perl - 创建关键字对象 Perl Microsoft::AdCenter

> ID：10097155
> 
> 赞同：0
> 
> 时间：2012-04-10T22:06:01.680
> 
> 标签：perl, api, keyword, ads

因此，我查看了 Microsoft::AdCenter 模块的 perldoc，它显示了如何创建关键字对象的示例：

`~$ perldoc Microsoft::AdCenter`

```
#Create a Keyword object
my $keyword = Microsoft::AdCenter::V7::CampaignManagementService::Keyword->new
           ->Text("some text")
           ->BroadMatchBid(Microsoft::AdCenter::V7::CampaignManagementService::Bid->new->Amount(0.1))
           ->ExactMatchBid(Microsoft::AdCenter::V7::CampaignManagementService::Bid->new->Amount(0.1)); 
```

但是，这是否违反了每个关键字只使用一种匹配类型的新政策？

广告系列管理更改：

“以前，您将创建一个关键字对象，并为每个要出价的匹配项指定出价值（例如，完全匹配或词组匹配）。如果您没有在关键字级别指定出价值，adCenter使用了在广告组级别指定的默认出价。

现在，您必须为要出价的每种匹配类型创建一个关键字对象。例如，要使用完全匹配和词组匹配对关键字 car 出价，请创建一个 Keyword 对象并将 Text 元素设置为 car，将 ExactMatchBid 元素设置为出价金额。然后，创建第二个 Keyword 对象并将 Text 元素设置为 car，将 PhraseMatchBid 设置为投标金额。添加关键字后，您将获得每个关键字和匹配类型组合的唯一关键字 ID。”

perldoc 似乎不是最新的。这些 perldocs 最后更新于 2011-05-15。perldocs 什么时候更新？

还有什么时候会更新[Msdn API 文档](http://msdn.microsoft.com/en-US/library/bb671833(v=msads.70).aspx)？

[在 Perl 中添加关键字](http://msdn.microsoft.com/en-us/library/cc300296.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:17:24.653

According to Microsoft:

This functionality in which you described where a new keyword object needs to be created for each match type being bid on is being rolled out in gradual phases in the near future. The documentation for this new functionality will be updated to reflect these functionality changes.

Please watch the [Microsoft AdCenter API Developer Blog](http://community.microsoftadvertising.com/blogs/api/default.aspx?) and [AdCenter API Release Notes](http://msdn.microsoft.com/en-US/library/ee703976.aspx) for more updates on this new functionality coming soon.

# asp.net-mvc-3 - 摆脱自动完成中的重复条目

> ID：10097157
> 
> 赞同：1
> 
> 时间：2012-04-10T22:06:03.583
> 
> 标签：asp.net-mvc-3, linq, entity-framework-4.1

我很难摆脱自动完成中出现的重复条目。自动完成是从数据库动态生成的。

这是控件中用于自动完成的代码：

```
 public ActionResult AutoCompletefootball()
    {
        var db = new footEntities();
        string selection = this.Request.Params["term"].ToString();
        return Json(db.football.Where(a => a.player.Name.StartsWith(selection)).Select(Adds => a.Player.Name), JsonRequestBehavior.AllowGet);
    } 
```

欢迎所有建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:08:18.103

在您的 return 语句（使用 LINQ 的地方）中，添加 DISTINCT 子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:09:18.630

.distinct() 会消除重复，但考虑到出现重复是因为有很多同名玩家，所以他们并不是真正的重复人

# javascript - 可以在不使用 RTSP 的情况下流式传输实时视频吗？

> ID：10097162
> 
> 赞同：2
> 
> 时间：2012-04-10T22:06:25.197
> 
> 标签：javascript, streaming, rtsp, live-streaming

是否可以在不使用 RTSP 协议的情况下直播视频（和音频）？今天我试用了 Adob​​e 的 Flash Media Server 和免费的替代品 Red5。两者都显得有点矫枉过正（加上 Red5 不支持 AAC 音频的问题）。
基本上我正在寻找一种将实时视频上传到我的服务器的方法，以便可以使用 jwplayer 查看它，然后存储它以便以后查看。MP4 支持直播吗？这样我就可以在客户端记录它然后上传查看？

我一直在尝试上传 jpg 图像并使用 HTML5 画布显示它们，使其看起来像视频。
这是我的代码：（仅使用几张图片）
[http://jsfiddle.net/QM5EV/](http://jsfiddle.net/QM5EV/)

它有几个问题。一方面，它效率不高，因为它需要上传大量的 jpg。最重要的是没有音频。

最好做什么？RTSP 是唯一明智的选择吗？谢谢。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T10:44:21.117

在大多数情况下，通过 HTTP 服务器直播不是一个选项。但是有“Apple Live Streaming”又名 MPEG-TS，尽管这将您的客户端限制在 iOS 设备上。它使用一个普通的 ol'web 服务器。（这似乎正在改变，越来越多的桌面浏览器支持 MPEG-TS，但可能需要一段时间才能普及。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T09:33:52.920

对于在线流媒体，rtsp 是最好的解决方案。其他协议，例如 RTMP ( [http://en.wikipedia.org/wiki/Real_Time_Messaging_Protocol](http://en.wikipedia.org/wiki/Real_Time_Messaging_Protocol) )，但使用 RTSP 传输到任何多媒体内容。

另一件事是您可以使特定的流媒体服务器接受 HTTP 重定向请求。因此，而不是 URL 的 rtsp://mydomain.com:554/myfile.mp4 可以有 URL 像[http://mydomain.com/myfile.mp4](http://mydomain.com/myfile.mp4)

问候！

# ruby-on-rails - 从 rails 3.2.0 升级到 3.2.2 时出现“新”路由问题

> ID：10097165
> 
> 赞同：3
> 
> 时间：2012-04-10T22:07:01.760
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing, new-operator, edit

在将 rails 从 3.2.0 升级到 3.2.2 时，我遇到了一些路由问题。

当使用 routes 助手生成新路由时，助手工作并生成如下所示的链接：

```
/things/new 
```

但是，当您访问该链接时，它会引发路由错误...

```
Routing Error
No route matches {:action=>"edit", :controller=>"app/things", :id=>#<Thing id: nil, title: n.... 
```

它将其误认为是编辑 url 操作而不是新操作。

路线上什么都没有，但是......

```
 scope :module => :app, :as => :app, :constraints => { :subdomain => /app/ } do
     resources :things
  end 
```

有没有人经历过或者知道发生了什么？

谢谢。

额外的细节...

耙路线：

```
 app_things GET    /things(.:format)                                    app/things#index {:subdomain=>/app/}
               POST   /things(.:format)                                    app/things#create {:subdomain=>/app/}
 new_app_thing GET    /things/new(.:format)                                app/things#new {:subdomain=>/app/}
edit_app_thing GET    /things/:id/edit(.:format)                           app/things#edit {:subdomain=>/app/}
     app_thing GET    /things/:id(.:format)                                app/things#show {:subdomain=>/app/}
               PUT    /things/:id(.:format)                                app/things#update {:subdomain=>/app/}
               DELETE /things/:id(.:format)                                app/things#destroy {:subdomain=>/app/} 
```

卷曲：

```
curl -IL http://app.testapp.com/things/new
HTTP/1.1 404 Not Found 
```

从日志（堆栈跟踪？）：

```
 Started GET "/things/new" for 127.0.0.1 at 2012-04-24 19:27:02 +0100
Processing by App::ThingsController#new as HTML
  Rendered app/things/_new_form.html.erb (2.0ms)
  Rendered app/things/new.html.erb within layouts/app (2.7ms)
  Rendered layouts/_app_includes.html.erb (11.0ms)
  Rendered app/nav/_things_new.html.erb (1.6ms)
  Rendered app/nav/_menu_wrapper.html.erb (2.1ms)
Completed 500 Internal Server Error in 21ms

ActionController::RoutingError (No route matches {:action=>"edit", :controller=>"app/things", :id=>#<Thing id: nil, title: nil, created_at: nil, updated_at: nil, account_id: nil>}):
  app/views/app/nav/_step_1_title.html.erb:2:in `_app_views_app_nav__step___title_html_erb__3644446743043796555_70280275307960'
  app/views/app/nav/_things_new.html.erb:1:in `_app_views_app_nav__things_new_html_erb__4471631226426153422_70280275315660'
  app/views/app/nav/_menu_wrapper.html.erb:8:in `_app_views_app_nav__menu_wrapper_html_erb___3003322303253991863_70280275346820'
  app/views/layouts/app.html.erb:32:in `_app_views_layouts_app_html_erb__4514085623626236526_70280285513740'

  Rendered /Users/blerg/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (0.6ms) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T18:50:05.130

我猜这不是`/things/new`导致问题的路线本身。正在渲染的内容（例如，您的 _nav 菜单之一）包括`edit_app_thing_path`使用 nil 或其他缺少对象参数的调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T08:37:07.710

当您访问“/things/new”时，检查您的 development.log 文件以查看完整的堆栈跟踪。如果您无法从日志中看到有什么问题，请在此处发布。

乍一看，`edit_thing_path(@thing)`调用中似乎存在问题：您正在将新记录传递给它 - 我`#<Thing id: nil...`在该错误消息中看到。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-21T16:18:13.877

## 在这里工作正常。

我不知道该告诉你什么 Smickie，我重新创建了你的情况，它对我来说效果很好。以下是一些细节：

*导轨版本*

```
$ bundle exec rails -v
Rails 3.2.2 
```

*路由.rb*

```
scope :module => :app, :as => :app, :constraints => { :subdomain => /app/ } do
  resources :things
end 
```

*耙子路线*

```
$ bundle exec rake routes
    app_things GET    /things(.:format)          app/things#index {:subdomain=>/app/}
               POST   /things(.:format)          app/things#create {:subdomain=>/app/}
 new_app_thing GET    /things/new(.:format)      app/things#new {:subdomain=>/app/}
edit_app_thing GET    /things/:id/edit(.:format) app/things#edit {:subdomain=>/app/}
     app_thing GET    /things/:id(.:format)      app/things#show {:subdomain=>/app/}
               PUT    /things/:id(.:format)      app/things#update {:subdomain=>/app/}
               DELETE /things/:id(.:format)      app/things#destroy {:subdomain=>/app/} 
```

*得到`things/new`*

```
$ curl -IL http://app.test.dev:3001/things/new
HTTP/1.1 200 OK
... 
```

### 如果您从您的机器上发布相同的详细信息，我们会看到什么是可疑的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T03:01:16.423

用这个：

```
scope "/app" do
  resources :things
end 
```

# c - 与套接字的死锁

> ID：10097166
> 
> 赞同：0
> 
> 时间：2012-04-10T22:07:04.237
> 
> 标签：c, networking

我编写了这个程序来在 eth0 上发送和接收来自 ipv6 的数据包：

```
#include<sys/socket.h>
#include<sys/types.h>
#include <netinet/in.h>
#include <stdio.h>
#include <netdb.h>
#include <errno.h>
#include <net/if.h>
#include <sys/ioctl.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <fcntl.h>
int main() {

    int sock,i;
    struct sockaddr_in6 *address;
    struct protoent *proto;
    struct ifreq ethreq, Interface, Interface1;
    unsigned char buffer[2048];
    unsigned char tbuff[2048];
    unsigned char *iphead, *ethhead,*phead;
    static const uint8_t mys6_addr[16]={0x54,0x04,0x20,0x49,0x0e,0x40,0xc7,0x03,0xa0};

    //open socket for receive ipv6 packet 
    sock=socket(AF_INET6, SOCK_RAW,255);
    //control error
    if(sock<0) {
        perror("socket");
        exit(1);
    }

    strncpy(ethreq.ifr_name, "eth0", IFNAMSIZ);
    if (ioctl(sock,SIOCGIFFLAGS, &ethreq) == -1) {
        perror("ioctl");
        close(sock);
        exit(1);
    }

    ethreq.ifr_flags |= IFF_PROMISC;
    if (ioctl(sock, SIOCSIFFLAGS, &ethreq) == -1) {
        perror("ioctl");
        close(sock);
        exit(1);
    }

    //bind to sock with eth0 
    memset(&Interface, 0, sizeof(Interface));
    strncpy(Interface.ifr_ifrn.ifrn_name, "eth0", IFNAMSIZ);
    if (setsockopt(sock, SOL_SOCKET, SO_BINDTODEVICE, &Interface, sizeof(Interface))<0)
        close(sock);

    //open the RAW socket for sendto
    int s = socket (AF_INET6, SOCK_RAW, 255);
    struct sockaddr_in6 sin6; 
    memset(&sin6,0,sizeof(sin6));
    sin6.sin6_family = AF_INET6;
    sin6.sin6_port = htons(0);
    memcpy(sin6.sin6_addr.s6_addr, mys6_addr, sizeof(mys6_addr));
    //bind the sock descriptor with eth0
    memset(&Interface1, 0, sizeof(Interface1));
    strncpy(Interface1.ifr_ifrn.ifrn_name, "eth0", IFNAMSIZ);
    if (setsockopt(s, SOL_SOCKET, SO_BINDTODEVICE, &Interface1, sizeof(Interface1)) < 0) {
        close(s);
    }
    while (1) {

        printf("----------------------\n");
        i = recv(sock, buffer, sizeof(buffer), 0);
        printf("%d bytes read\n", i);
        // check header size: Ethernet = 14, IP = 20, TCP = 8 (sum = 42)
        i=43;
        if (i < 42) {
            perror("recvfrom():");
            printf("Incomplete packet (errno is %d)\n", errno);
            close(sock);
            exit(0);
        }
        phead = buffer + 14; // (skip ethernet  header)
        memcpy(tbuff,phead,i-14); 
        iphead=tbuff;
        if (*iphead == 0x45) {
            int ptrindex= iphead[9];
            switch(ptrindex){

            case 1:
            printf("The transport protocl is:ICMP\n");
            break;
            case 2:
            printf("The transport protol is:IGMP\n");
            break;
            case 6:
            printf("The transport protocol is:TCP\n");
            break;
            case 17:
            printf("The transport protocol is:UDP\n");
            break;
            case 103:
            printf("The transport protocol is:PIM\n"); 
            break; 
            default:
            printf("The transport protocol is:%d\n",iphead[9]);
        }           
        //printf("%d",*ptrindex);
        // printf("\n The transport protocol is :%u\n",iphead[9]); 
        printf("Source Address: %d.%d.%d.%d, Port: %d\n",
        iphead[12], iphead[13], iphead[14], iphead[15], (iphead[20] << 8) + iphead[21]);
        printf("Dest Address: %d.%d.%d.%d, Port: %d\n",
        iphead[16], iphead[17], iphead[18], iphead[19], (iphead[22] << 8) + iphead[23]);

        /* if(sendto(s,tbuff,i-14,0,(struct sockaddr_in6 *)&sin6,sizeof(sin6))<0)
        printf("error\n"); */

        if(send(s,tbuff,i-14,0)<0) {
            printf("error\n");

        } else {
            printf("\nThe received packet is send\n");
        }

        memset(buffer,0,sizeof(buffer));
        memset(tbuff,0,sizeof(tbuff));

        } else{
            printf("The non ip had received");
        }

    }
    close(sock);
    return 0;
} 
```

大部分代码是我读过的问题的一部分，但现在我不记得是什么了。该程序在 printf("----------------\n") 处陷入死锁。为什么？你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:43:48.377

死锁是一个循环的锁链。这里没有锁，因此也没有死锁。正在发生的`recv()`只是阻塞等待输入到达。

# wpf - 在 Win7 x64 上部署时 WPF 应用程序内存不足

> ID：10097168
> 
> 赞同：1
> 
> 时间：2012-04-10T22:07:16.670
> 
> 标签：wpf, .net-3.5, out-of-memory, windows-7-x64

有谁知道什么会导致 WPF 应用程序出现以下异常？在 Windows 7 x64 上部署后开始发生。应用程序正在使用 .NET 3.5，并且没有导致此问题的特定操作，并且应用程序运行的时间长度是随机的。

```
Message : Insufficient memory to continue the execution of the program.
Source : PresentationCore
Help link : 
Data : System.Collections.ListDictionaryInternal
TargetSite : Boolean CreateOrAddRefOnChannel(ResourceHandle ByRef, ResourceType)
Stack Trace :    at System.Windows.Media.Composition.DUCE.Channel.CreateOrAddRefOnChannel(ResourceHandle& handle, ResourceType resourceType)
   at System.Windows.Media.Composition.DUCE.MultiChannelResource.CreateOrAddRefOnChannel(Channel channel, ResourceType type)
   at System.Windows.Media.RenderData.System.Windows.Media.Composition.DUCE.IResource.AddRefOnChannel(Channel channel)
   at System.Windows.UIElement.RenderContent(RenderContext ctx, Boolean isOnChannel)
   at System.Windows.Media.Visual.UpdateContent(RenderContext ctx, VisualProxyFlags flags, Boolean isOnChannel)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.UpdateChildren(RenderContext ctx, ResourceHandle handle)
   at System.Windows.Media.Visual.RenderRecursive(RenderContext ctx)
   at System.Windows.Media.Visual.Render(RenderContext ctx, UInt32 childIndex)
   at System.Windows.Media.CompositionTarget.Compile(Channel channel)
   at System.Windows.Media.CompositionTarget.System.Windows.Media.ICompositionTarget.Render(Boolean inResize, Channel channel)
   at System.Windows.Media.MediaContext.Render(ICompositionTarget resizedCompositionTarget)
   at System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget)
   at System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)
   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-04T05:23:38.110

我至少找到了导致此问题的 1 个原因。如果将 DataGrid 放入像 StackPanel 这样允许子控件无限调整大小的容器中，那么当您绑定一个大列表（对我来说是 17k 行）时，您会得到一个 OutOfMemoryException。

如果将 DataGrid 放置在像 Grid 这样的固定高度容器中，那么它可以正常工作。

具有讽刺意味的是，我通过试用 DevExpress WPF 库发现了这一点。在这种情况下，他们的网格实际上引发了带有以下文本的异常。

*DevExpress.Xpf.Grid.v13.2.Core.dll 中出现“DevExpress.Xpf.Grid.InfiniteGridSizeException”类型的第一次机会异常附加信息：默认情况下，不允许无限网格高度，因为将呈现所有网格行因此网格将非常缓慢地工作。要解决此问题，您应该将网格放入一个容器中，该容器将为网格提供有限的高度，或者您应该手动指定网格的高度或 MaxHeight。请注意，您也可以通过将 GridControl.AllowInfiniteGridSize 静态属性设置为 True 来避免此异常，但在这种情况下，网格将运行缓慢。*

一旦我看到这一点，便士就掉了，然后我可以复制并使用 Microsoft DataGrid 修复原始行为。

# c# - 同时从套接字发送和读取

> ID：10097169
> 
> 赞同：0
> 
> 时间：2012-04-10T22:07:20.663
> 
> 标签：c#, sockets

我正在开发一个简单的代理服务器。问题是浏览器有时会重复使用连接并在同一连接上发送多个请求。

我正在使用 TcpClient 和 Stream 向服务器发出 HTTP 请求。我怎样才能让读写函数彼此“分开”，例如在单独的线程中。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:10:06.027

它称为持久连接。如果您不希望浏览器这样做，则不应在代理响应中发送此标头“Connection: Keep-Alive”。

[http://en.wikipedia.org/wiki/HTTP_persistent_connection](http://en.wikipedia.org/wiki/HTTP_persistent_connection)

# java - Maven 程序集插件没有创建带有目录条目的 tar 文件？

> ID：10097170
> 
> 赞同：3
> 
> 时间：2012-04-10T22:07:21.570
> 
> 标签：java, maven, tar

我正在开发我的第一个 Maven 项目，该项目最终将 Java 应用程序打包到 Debian 包中（使用 jdeb 插件）。我正在尝试使用程序集插件来构建一个 tar 文件，但看起来生成的文件并不总是包含目录条目，这将导致 dpkg install 失败。

有没有人见过这个？

具体来说，生成的 tar 文件不包含以下目录条目：

*   指定的文件集`<includes>`（离开`<includes>`将导致 tar 文件中的目录条目）
*   一个依赖集

这是一个不使用`<includes>`

```
<assembly
xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
<id>simple</id>
<formats>
    <format>tar</format>
</formats>
<includeBaseDirectory>false</includeBaseDirectory>

<moduleSets>
</moduleSets>
<fileSets>
    <fileSet>
        <directory>src/main/config</directory>
        <outputDirectory>/etc/${project.artifactId}</outputDirectory>

    </fileSet>
</fileSets>

<dependencySets>

    <dependencySet>
        <outputDirectory>/usr/lib/${project.artifactId}/lib</outputDirectory>
        <scope>runtime</scope>
        <useProjectArtifact>true</useProjectArtifact>
    </dependencySet>

</dependencySets>
<repositories>
</repositories>
<componentDescriptors />
</assembly> 
```

以下是 tar 文件的内容：

```
 tar tvf assembly-test-0.0.1-SNAPSHOT-simple.tar
drwxr-xr-x 0/0               0 2012-04-10 12:54 etc/assembly-test/
-rw-r--r-- 0/0               0 2012-04-10 12:52 etc/assembly-test/file1.xml
-rw-r--r-- 0/0               0 2012-04-10 12:52 etc/assembly-test/file2.xml
-rw-r--r-- 0/0            2131 2012-04-10 13:26 usr/lib/assembly-test/lib/assembly-test-0.0.1-SNAPSHOT.jar 
```

现在，如果我使用带有一些包含模式的程序集：

```
<assembly
xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
<id>include-match</id>
<formats>
    <format>tar</format>
</formats>
<includeBaseDirectory>false</includeBaseDirectory>

<moduleSets>
</moduleSets>
<fileSets>
    <fileSet>
        <directory>src/main/config</directory>
        <outputDirectory>/etc/${project.artifactId}</outputDirectory>
        <includes>
            <include>*.xml</include>
        </includes>
    </fileSet>
</fileSets>

<dependencySets>

    <dependencySet>
        <outputDirectory>/usr/lib/${project.artifactId}/lib</outputDirectory>
        <scope>runtime</scope>
        <useProjectArtifact>true</useProjectArtifact>
    </dependencySet>

</dependencySets>
<repositories>
</repositories>
<componentDescriptors />
</assembly> 
```

tar 文件的内容会丢失目录条目：

```
tar tvf assembly-test-0.0.1-SNAPSHOT-include-match.tar
-rw-r--r-- 0/0               0 2012-04-10 12:52 etc/assembly-test/file1.xml
-rw-r--r-- 0/0               0 2012-04-10 12:52 etc/assembly-test/file2.xml
-rw-r--r-- 0/0            2131 2012-04-10 13:26 usr/lib/assembly-test/lib/assembly-test-0.0.1-SNAPSHOT.jar 
```

这似乎是程序集插件中的一个错误，尽管我仍在尝试它。我当然可以解决它（使用包中的 preinst 脚本，也许构建一个目录结构供 jdeb 构建），但我希望尽可能多地保留在描述符文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T23:30:08.980

想我可以用一种可以强制在 tar 文件中创建目录条目的方法来回答这个问题（我实际上在其他地方找到了这个，但不记得在哪里） - 添加一个 fileSet 同时排除所有内容，例如：

```
 <!-- force entry for /usr/lib/${project.artifactId} -->
        <fileSet>
            <directory></directory>
            <outputDirectory>/usr/lib/${project.artifactId}</outputDirectory>
            <excludes>
                <exclude>*/**</exclude>
            </excludes>
        </fileSet> 
```

不优雅，如果你有很多目录，它会变得冗长，但它有效。但是，对于我创建 debian 包的具体情况，我最终使用 Assembly 插件来构建“目录”格式的程序集，然后让 jdeb 插件使用目录结构（并设置文件模式），结果有点整体更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-11T18:19:49.060

有一种简单的方法可以解决这个问题，只需包含您想要的目录或“**/”，如果您想要所有这些，例如：

```
<include>mydir/**/</include> 
```

注意尾随的 / 因为那是拉入目录的东西。我认为当前的行为可能是故意的，因为 include 似乎准确地引入了您所包含的内容，而不是其他任何内容。顺便说一句，虽然生成的 tarball 不满足 npm，所以 maven 的支持似乎仍然有点可疑。

# eclipse - Eclipse 中的 Makefile 及其路径

> ID：10097176
> 
> 赞同：1
> 
> 时间：2012-04-10T22:07:50.603
> 
> 标签：eclipse, path, makefile

我正在尝试使用 Eclipse 中的特定编译器构建一个项目，并且我正在使用 Makefile 来完成这项肮脏的工作——唯一的问题是 Eclipse 似乎与我的 bash 会话不共享相同的路径。我已经设置了 .bash_profile 和 .profile（显然 Mac 喜欢 .profile 和 .bash_profile 一样多），但是我所包含的导出都没有被​​拾取。我是否需要在我的 /usr/bin 或类似的东西中手动设置一些符号链接？或者有没有办法在eclipse中手动设置路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T17:38:15.420

这是因为`.bash_profile`和在会话开始时`.profile`被读取。`bash`因此，您需要将构建命令更改为`bash -l -c "make"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:31:52.760

编辑 Makefile 并添加绝对路径：

```
PATH = /Users/me/yagarto/yagarto-4.6.2/bin/
TRGT = $(PATH)arm-none-eabi- 
```

# ruby-on-rails - 控制器中的额外实例变量在视图中为零？

> ID：10097177
> 
> 赞同：5
> 
> 时间：2012-04-10T22:07:54.563
> 
> 标签：ruby-on-rails, model-view-controller, view

我已经通过 Stack Overflow 搜索了几个小时，但似乎没有一个相关问题适用于我的问题。

我是 Rails 新手，这是我第一个真正的项目，我可能会对 MVC 设置感到困惑。我试图在 search_controller.rb 的操作中分配 @stars 实例变量：

```
def create
  @search = Search.new(params[:search])
  tempstr = searchstr(@search)
  @stars = Star.where("tempstr", :limit => 100)
end 
```

`@search`创建得很好，是一个具有不同参数的复杂搜索。`tempstr`只是结果的一个简单字符串容器`searchstr(@search)`，这是一种将搜索参数转换为 MySql 相关字符串的快速方法（在这种情况下，这似乎比尝试正常使用 .where 帮助器更容易）。我确定我可以`searchstr(@search)`直接放入 .where，但我现在将它们分开，以便在元素通过时检查它们。

无论如何，当我尝试调用`@stars`show.html.erb 视图时，问题就出现了。即使是这样简单的事情：

```
<% @stars.each do |star| %>
  <%= display stuff %>
<% end %> 
```

我收到一条错误消息`'each' is not a method of nil:NilClass`。因此，我将其更改为以下内容，以查看 @stars 是否为 nil：

```
<%= @stars.inspect %> 
```

果然`@stars`是`nil`。但是，当我将此行添加到我的控制器以进行检查`@stars`时：

```
return render @stars.each 
```

我看到变量填充了 Star.where() 中的正确星形对象，正如我所期望的那样。在控制器中时，快速 .inspect 显示变量不为零。

所以，我不确定如果视图已经在控制器中定义得很好，为什么视图将它接收为 nil。不过，如果是我误解了 MVC 的工作原理，我不会感到惊讶。Star 类是在 Star 模型中定义的，但也许是因为我试图从 Searches 控制器访问它，因此它没有为视图初始化？

我应该以其他方式做这件事吗？我试图使用局部变量（使用`stars`而不是`@stars`），但随后视图显示“未定义的局部变量或方法'星'”。

任何帮助将不胜感激，我已经花了好几个小时来创建复杂的搜索并将星文件数据解析到数据库中，所以我有点筋疲力尽。如果需要，我可以提供更多信息，我不确定还有什么有助于提供答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T04:34:26.317

您正在设置方法，但您正在谈论的视图是 show.html.erb `@stars`。`create`也尝试`@stars`在`show`方法中设置。像这样的东西：

```
def show
  @search = Search.find(params[:id])
  tempstr = searchstr(@search)
  @stars = Star.where("tempstr", :limit => 100)
end 
```

如果这对您没有帮助，请向您展示其余的控制器操作，以便我们可以更好地帮助您。

# macos - 如何使我在 AddressBook 中为自定义属性设置的值保持不变？

> ID：10097179
> 
> 赞同：0
> 
> 时间：2012-04-10T22:08:03.630
> 
> 标签：macos, cocoa, osx-lion, addressbook

我在 AddressBook 中创建了一个名为“Qref”的自定义属性。我可以使用 来检查它是否存在`[ABPerson properties]`，并且对于我编写的任何测试应用程序来说它总是存在的。

顺便说一句，您不能删除自定义属性，因为`[ABPerson removeProperties]`尚未实现。让我知道是否有，因为我需要删除我打错名字的人。

我用这段代码设置了一个属性值。

```
ABPerson *p = <person chosen from a PeoplePicker>;
NSError *e;
if (![p setValue: aString forProperty:@"Qref" error:&e]) {
  [NSAlert alertWithError:e]runModal;
} 
```

（我还没有看到警报，但有时会在控制台中收到一堆错误消息。）此时我可以离开 PeoplePicker 中的人并返回以找到正确设置的值。如果我检查`[[ABAddressBook sharedAddressBook] hasUnsavedChanges]`结果为否，那么显然更改自定义属性值不算作更改，所以我通过插入虚拟人来强制保存（请提出更好的方法），然后执行

```
[[ABAddressBook sharedAddressBook] save]; 
```

如果虚拟人正在运行，它会立即出现在 AddressBook 中，所以有些事情是正确的。但是当我关闭我的应用程序并再次运行它时，我发现我设置的值已经消失了。(MacOSX-狮子)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T13:21:37.897

我一直在叫错树。事实证明，我无法保存任何属性，无论它们是否是自定义属性。然后我想知道这是否与代码签名、权利或 iCloud 有关，这对我来说是不可逾越的丛林。您从 PeoplePicker 获得的人似乎与任何通讯录都没有关联，因此`[[ABAddressBook sharedAddressBook] save]`不会执行任何操作。您必须从 ABAddressBook 实例中获取您的人。这是工作原理的框架，没有任何错误检查。

```
ABPerson *p = [[myPeoplePicker selectedRecords] objectAtIndex:0];
NSString *uid = p.uniqueId;
ABPerson *editablePerson = 
     (ABPerson*) [[ABAddressBook sharedAddressBook] recordForUniqueId:uid];
// Typecast because it returns an ABRecord. Can anyone improve?
[editablePerson setValue:@"ABCD" forProperty:@"Qref"]; // my custom property
[[ABAddressBook sharedAddressBook] save]; 
```

# sql - 即使不一定需要，我是否应该在表中使用唯一约束？

> ID：10097180
> 
> 赞同：0
> 
> 时间：2012-04-10T22:08:06.890
> 
> 标签：sql, sql-server

在 Microsoft SQL Server 中，创建表时，对列使用唯一约束是否有任何缺点，即使您并不真的需要它是唯一的？

一个例子是对用户管理系统中角色的描述：

```
CREATE TABLE Role
(
    ID TINYINT PRIMARY KEY NOT NULL IDENTITY(0, 1),
    Title CHARACTER VARYING(32) NOT NULL UNIQUE,
    Description CHARACTER VARYING(MAX) NOT NULL UNIQUE
) 
```

我担心在其他表中频繁插入时验证此约束将是一个非常耗时的过程。我不确定如何验证此约束，但我觉得它可以以非常有效的方式或作为线性比较来完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T23:04:25.443

您的恐惧变成了现实：UNIQUE 约束被实现为索引，这既费时又费空间。

因此，每当您插入新行时，数据库都必须更新表，并且每个唯一约束也必须更新一个索引。

所以，根据你的说法：

> 对列使用唯一约束，即使您并不真正需要它是唯一的

答案是否定的，不要使用它。有时间和空间的缺点。

您的示例表需要一个用于 Id 的聚集索引和 2 个额外的索引，每个唯一约束一个。这会占用空间和时间来更新插入的 3 个索引。

仅当您按这些字段进行查询过滤时，这才是合理的。

顺便说一句：原始的帖子样本表有几个缺陷：

*   该语法不是 SQL Server 语法（并且您将其标记为 SQL Server）

*   您不能在 varchar(max) 列中创建索引

如果您更正语法并创建此表：

```
CREATE TABLE Role
(
  ID tinyint PRIMARY KEY NOT NULL IDENTITY(0, 1),
  Title varchar(32) NOT NULL UNIQUE,
  Description varchar(32) NOT NULL UNIQUE
) 
```

然后你可以执行`sp_help Role`，你会发现 3 个索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T22:10:57.823

数据库会创建一个索引来支持 UNIQUE 约束，因此进行唯一性检查的成本应该非常低。

[http://msdn.microsoft.com/en-us/library/ms177420.aspx](http://msdn.microsoft.com/en-us/library/ms177420.aspx)

> 数据库引擎会自动创建一个 UNIQUE 索引来强制执行 UNIQUE 约束的唯一性要求。因此，如果尝试插入重复行，数据库引擎会返回一条错误消息，指出违反了 UNIQUE 约束并且不会将该行添加到表中。除非显式指定聚集索引，否则默认情况下会创建唯一的非聚集索引以强制执行 UNIQUE 约束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T07:50:11.810

> 如果您知道数据将始终是唯一的，但它不一定需要是唯一的才能使应用程序正常运行，那么限制它通常是一种好习惯吗？

我的问题是：两个角色有不同的头衔但有相同的描述是否有意义？例如

```
INSERT INTO Role ( Title , Description )
   VALUES ( 'CEO' , 'Senior manager' ), 
          ( 'CTO' , 'Senior manager' ); 
```

对我来说，这似乎贬低了描述的使用；如果有很多重复，那么做更多这样的事情可能更有意义：

```
INSERT INTO Role ( Title )
   VALUES ( 'CEO' ), 
          ( 'CTO' );

INSERT INTO SeniorManagers ( Title )
   VALUES ( 'CEO' ), 
          ( 'CTO' ); 
```

但是话又说回来，您并不期望重复。

我认为这是一个低活动表。你说你害怕在其他表中频繁插入时验证这个约束。好吧，这不会发生（除非有一个我们看不到的触发器可能会在另一个表被更新时更新这个表）。

就个人而言，我会要求设计师（业务分析师，等等）证明不应用唯一约束是合理的。如果他们不能，那么我会根据常识施加 unqiue 约束。对于这样的文本列，通常情况下，我也会应用`CHECK`约束，例如禁止前导/尾随/双空格、零长度字符串等。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-10T23:13:22.497

在 SQL Server 上，数据类型 tinyint 只为您提供 256 个不同的值。无论您在 id 列之外做什么，您最终都不会得到一个非常大的表。即使有十几个索引列，它也肯定会快速执行。

但是，除了代理键之外，您通常至少需要一个唯一约束。如果你没有，你很可能会得到这样的数据。

```
1    First title    First description
2    First title    First description
3    First title    First description
...
17   Third title    Third description
18   First title    First description 
```

允许此类数据的表格通常是错误的。任何使用*对该*表的外键引用的表都无法正确报告，例如，使用的“第一个标题”的数量。

我认为在用户管理系统中允许多个相同的角色标题是一个设计错误。我可能会争辩说，“标题”对于该专栏来说也是一个非常糟糕的名字。

# scala - Scala - 遍历目录中文件中所有行的迭代器

> ID：10097189
> 
> 赞同：18
> 
> 时间：2012-04-10T22:08:45.437
> 
> 标签：scala, io, lazy-evaluation

我真的很喜欢

```
for (line <- Source fromFile inputPath getLines) {doSomething line} 
```

在scala中迭代文件的构造，我想知道是否有一种方法可以使用类似的构造来迭代目录中所有文件中的行。

这里的一个重要限制是所有文件加起来都会产生堆溢出的空间量。（想想几十 GB，所以增加堆大小不是一种选择）作为暂时的解决方法，我一直在将每个文件放在一个文件中，并使用上面的结构，它适用于 b/c 的懒惰。

重点是，这似乎引发了诸如.. 我可以连接两个（一百个）惰性迭代器并获得一个非常大、非常惰性的迭代器吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-10T22:28:39.000

是的，虽然它不是那么简洁：

```
import java.io.File
import scala.io.Source

for {
  file <- new File(dir).listFiles.toIterator if file.isFile
  line <- Source fromFile file getLines
} { doSomething line } 
```

诀窍是`flatMap`和[它的`for`理解语法糖](https://stackoverflow.com/a/1059501/334519)。例如，上述内容或多或少等同于以下内容：

```
new File(dir)
  .listFiles.toIterator
  .filter(_.isFile)
  .flatMap(Source fromFile _ getLines)
  .map(doSomething) 
```

正如 Daniel Sobral 在下面的评论中指出的那样，这种方法（以及您问题中的代码）将使文件保持打开状态。如果这是一次性脚本，或者您只是在 REPL 中工作，这可能没什么大不了的。如果确实遇到问题，可以使用[pimp-my-library 模式](http://www.artima.com/weblogs/viewpost.jsp?thread=179766)来实现一些基本的资源管理：

```
implicit def toClosingSource(source: Source) = new {
  val lines = source.getLines
  var stillOpen = true
  def getLinesAndClose = new Iterator[String] {
    def hasNext = stillOpen && lines.hasNext
    def next = {
      val line = lines.next
      if (!lines.hasNext) { source.close() ; stillOpen = false }
      line
    }
  }
} 
```

现在只需使用`Source fromFile file getLinesAndClose`，您就不必担心文件处于打开状态。

# xcode - 如何更改 Xcode 的整个版权声明模板？

> ID：10097192
> 
> 赞同：13
> 
> 时间：2012-04-10T22:09:17.513
> 
> 标签：xcode, cocoa, xcode4, xcode-template, copyright-display

我找到了一些关于如何更改公司名称的答案，但是有没有办法在 Xcode 中更改整个版权模板？

**例如：**

*改变 ：*

```
(c) 2012 MyCoolCompany 
```

*到 ：*

```
(c) 2012 MyCoolCompany, unauthorized reproduction is prohibited, contact bla-bla-bla@example.com for details, etc. 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-10T22:10:26.357

**去 ：**

```
/Developer/Library/Xcode/Templates/File Templates 
```

或者，如果您使用的是较新的 self-tained `Xcode.app`，

```
/Applications/Xcode.app/Contents/Developer/Library/Xcode/Tem‌​plates/File Templates 
```

为避免模板被 Xcode 更新破坏，请复制您要编辑的模板并将其移动到您的主库文件夹中——</p>

```
~/Library/Application Support/Developer/Shared/Xcode/File Templates 
```

如果 - 比方说 - 这是您想要更改的 Objective-C 类模板，请转到以下子目录：

```
/Cocoa/Objective-C class.xctemplate 
```

打开 ：

```
NSObject/___FILEBASENAME___.h
NSObject/___FILEBASENAME___.m 
```

并编辑它们。

* * *

***提示：****您必须根据需要调整尽可能多的模板文件（例如，如果您需要您的版权标题对 NSDocument 子类有效，那么请确保您也编辑这些文件......;-)）*

* * *

**一个例子（我的`___FILEBASENAME___`文件是什么样的）：**

```
/******************************************************
 | ___PROJECTNAME___
 |******************************************************
 | File : ___FILENAME___
 | 
 | Created on ___DATE___
 | By Ioannis Zafeiropoulos (a.k.a. Dr.Kameleon)
 |*********************************************************************
 | Copyright (c) ___YEAR___ InSili.co.uk. All rights reserved.
 |*********************************************************************/ 
```

# makefile - make 命令 makefile:18 中的错误：*** 缺少分隔符。停止

> ID：10097193
> 
> 赞同：46
> 
> 时间：2012-04-10T22:09:18.317
> 
> 标签：makefile, gnu-make

对于下面复制的以下 make 文件，我收到了缺少分隔符的错误。选项卡空间似乎没有任何问题。

```
OBJS = driver.o snapshot.o
SHOBJS = malloc.o mymemory.o
CC = g++
DEBUG = -g
CFLAGS = -Wall -c $(DEBUG)
LFLAGS = -Wall $(DEBUG)
Snapshot: $(OBJS)
  $(CC) $(LFLAGS) $(OBJS) -o Snapshot
driver.o: snapshot.h driver.cpp
  $(CC) $(CFLAGS) driver.cpp
snapshot.o: mymemory.h snapshot.h snapshot.cpp
  $(CC) $(CFLAGS) snapshot.cpp
libmymemory.so: $(SHOBJS)
  gcc -shared -o libmymemory.so malloc.o mymemory.o
malloc.o: malloc.c
  gcc -fPIC -g -c -Wall malloc.c
mymemory.o: mymemory.cpp
 gcc -fPIC -g -c -Wall mymemory.cpp 
clean:
 \rm *.o *~ Snapshot 
```

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-04-10T22:23:34.560

第 18 行是`gcc -fPIC -g -c -Wall mymemory.cpp`. Make 需要一个分隔符，通常是`:`. 它没有将此行检测为命令。你打错了意图：你有空格，你应该有一个标签。

好的编辑器会突出显示以空格开头但看起来应该以制表符开头的 makefile 行。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-10-19T19:07:13.837

当文件在 makefile 的行首使用空格而不是制表符时，我看到了此错误消息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-13T07:38:07.730

如果您从互联网复制粘贴代码，通常会发生这种情况。使用删除键删除缩进行中的所有空格。然后按 Tab 键，每行仅一次。

保存并再次尝试运行该文件。它现在应该可以工作了。这对我有用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-10T22:14:15.110

我不知道它是否准确或在线粘贴代码的工件，但文件中最后两个命令的缩进看起来比它上面的命令小。仔细检查你的间距。

# facebook-fql - 如何获取您的朋友对给定地点的“喜欢”数量

> ID：10097196
> 
> 赞同：0
> 
> 时间：2012-04-10T22:09:38.090
> 
> 标签：facebook-fql, facebook-opengraph

给定一个地方，比如[https://graph.facebook.com/112088822180423](https://graph.facebook.com/112088822180423)，我怎样才能得到我朋友的点赞数？该图表为我提供了 Likes、Checkins 和 Talking_About_count，但我只希望我的朋友喜欢谁。那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:29:10.643

如果您想为您管理的页面执行此操作，并且您希望以管理员身份执行此操作，则当前 API 可能无法实现。从[https://stackoverflow.com/a/6737579/121052](https://stackoverflow.com/a/6737579/121052)，您无法获取某个位置或页面的点赞列表。如果你有这个列表，你可以获取你自己朋友的列表，然后执行一个交集。

但是，如果它是您在应用程序中构建的功能，供其用户使用 - 即您希望显示喜欢页面的用户的朋友列表，那么这是可能的。为此，请执行以下操作：

*   使用[http://developers.facebook.com/docs/reference/api/user/#likes](http://developers.facebook.com/docs/reference/api/user/#likes)来获取用户是否喜欢某个页面/位置。
*   使用[http://graph.facebook.com/ **USER** /friends?access_token=XXX](http://graph.facebook.com/__USER__/friends?access_token=XXX)获取他的朋友列表。
*   对于任何朋友，您可以再次进行点赞检查并进行交叉。

我相信可能有一种方法可以优化此操作。[批量请求](http://developers.facebook.com/docs/reference/api/batch/)肯定会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:31:56.653

我发现这可以通过使用 FQL 和[page_fan 表来实现](https://developers.facebook.com/docs/reference/fql/page_fan/)

# java - Javadoc @see 还是 {@link}？

> ID：10097199
> 
> 赞同：202
> 
> 时间：2012-04-10T22:09:53.127
> 
> 标签：java, javadoc

`@see`有人可以告诉我 javadoc和之间的区别`{@link}`吗？

或者更确切地说，什么时候使用它们中的哪一个？

* * *

## 回答 #1

> 赞同：232
> 
> 时间：2012-04-10T22:15:14.040

这方面的[官方指南](http://www.oracle.com/technetwork/java/javase/documentation/index-137868.html#inlinelinks)非常明确。

功能上的区别是：

*   `{@link}`是一个内联链接，可以放在任何你喜欢的地方
*   `@see`创建自己的部分

在我看来，`{@link}`当您在描述中真正使用类、字段、构造函数或方法名称时，最好使用它。用户将能够点击进入您所链接内容的 javadoc。

我`@see`在两种情况下使用注释：

*   有些东西非常相关，但在描述中没有提到。
*   我在描述中多次提到相同的东西，它被用作多个链接的替代品。

我的这个观点是基于随机检查标准库中各种各样的东西的文档。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-04-10T22:42:05.293

`@see`在 Javadocs 中创建一个独立的行。`{@link}`用于嵌入文本中。

我`@see`在它是一个相关实体时使用它，但我没有在说明性文本中提及它。当存在紧密耦合时，我会在文本中使用链接，或者（我觉得）读者可能会从导航提示中受益，例如，您需要直接引用它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-12-30T18:40:13.603

标签与标签`@see`有点不同`@link`，
在某些方面受到限制，而在其他方面更灵活：

[![不同的 JavaDoc 链接类型](../Images/f557c6fa8b87946909cf6b13725ca696.png)](https://i.stack.imgur.com/5W2KP.png) ^(*不同的 JavaDoc 链接类型*)

1.  显示成员名称以便更好地学习，并且是可重构的；通过重构重命名时名称将更新
2.  可重构和可定制；显示您的文本而不是成员名称
3.  显示名称，可重构
4.  可重构、可定制
5.  一个相当*平庸*的组合，即：

*   可重构、可定制并保留在“**另请参阅**”部分
*   在 Eclipse 悬停中很好地显示
*   生成时显示链接标记及其格式
*   使用多个`@see`项目时，描述中的逗号会使输出混乱

6.  **完全违法**；在生成器中导致意外内容和非法字符错误

请参阅以下结果：

[![不同链接类型的 JavaDoc 生成结果](../Images/a30be805f21e0c0110c506132af01c8f.png)](https://i.stack.imgur.com/HN8wC.png) ^(*不同链接类型的 JavaDoc 生成结果*)

此致。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-09-27T06:57:43.313

还有另一个参考（弃用部分）相同的官方[文档](https://www.oracle.com/technetwork/java/javase/documentation/index-137868.html#@deprecated)更喜欢（自 Java 1.2 起）：`{@link}``@see`

> 对于 Javadoc 1.2 及更高版本，标准格式是使用 @deprecated 标记和内联 {@link} 标记。这会在您想要的位置创建内嵌链接。例如：
> 
> 对于 Javadoc 1.1，标准格式是创建一对 @deprecated 和 @see 标记。例如：

# c++ - 如何提高邻接表分配速度？

> ID：10097205
> 
> 赞同：1
> 
> 时间：2012-04-10T22:11:00.807
> 
> 标签：c++, data-structures, graph, adjacency-list

在确定**邻接矩阵**不适用于**80513**个节点和**5899882 个**边之后，我决定应用**adjacency list**。这是我第一次实现邻接表，基本上我决定应用向量方法的向量。

因此，例如，**vectorOfVectors[5]**将包含邻居节点**5**的邻居。我正在使用的数据集可以在[这里找到](http://socialcomputing.asu.edu/datasets/Flickr)

目前我已经编写了这段代码，它可以正常工作，但是在我的计算机上需要 26 秒（i5 2.4，6 gb ram，运行 Win7）。我想知道是否可以改进我的代码以降低分配速度。

**PS：**我正在使用**fstream库并从****.csv**文件中读取。

```
#include <iostream>
#include <fstream>
#include <vector>
#include <cstdlib>

using namespace std;

int main()
{
    ifstream file("edges.csv");
    string word="",data="";
    getline(file,word);
    int arrTemp[3];
    int numberOfNodes=atoi(word.c_str());
    vector<int>temp;
    vector< vector<int> >adjacencyList;

    for(int i=0;i<numberOfNodes;i++)
    {
        adjacencyList.push_back(temp);
    }
    while(file.good() && getline(file,word))
    {
        //cout<<word<<endl;
        if(word.size()>0)
        {
            for(int i=0;i<3;i++)
            {
                int cutFrom=word.find_first_of(',');
                arrTemp[i]=atoi(word.substr(0,cutFrom).c_str());
                word=word.substr(cutFrom+1,word.length());
            }
            //cout<<arrTemp[0]<<" "<<arrTemp[1]<<endl;
            adjacencyList[arrTemp[0]-1].push_back(arrTemp[1]-1);

        }
        else
            break;
    }

    cout<<"Vector size:"<<adjacencyList[1].size()<<endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T22:49:30.170

您可以使用 adjacencyList.reserve(numberOfNodes) 为 adjacencyList 预分配内存。这将减少不必要的内存分配和数据复制。

同样在调试模式下的 Visual Studio 中，STL 运行时会跟踪所有迭代器，这有时会使处理大型容器的速度变慢。调试/发布之间的数量级并不少见。研究“调试迭代器支持”以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:22:15.053

更好的方法是`unordered_set`节点索引对（其中对总是首先列出较小的节点）。

# facebook - “喜欢”按钮不起作用，（iframe）版本

> ID：10097206
> 
> 赞同：2
> 
> 时间：2012-04-10T22:11:16.147
> 
> 标签：facebook, facebook-like

我知道这是一个常见问题，但我还没有找到任何答案。我单击按钮，但没有任何反应。我一直在使用 linter 并拥有所有 og 标签。

这是我的代码（直接来自类似按钮的创建者）和网站：

```
 <iframe src="//www.facebook.com/plugins/like.php?href&amp;send=false&amp;layout=button_count&amp;width=450&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:450px; height:21px;" allowTransparency="true"></iframe> 
```

[http://alexcieminski.com/index.html](http://alexcieminski.com/index.html)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:42:44.123

`?href&`这就是问题。您需要真正将您的 url 编码的 url 放在这里：`?href=%3A%2F%2F&`

还要在 linter 中查看您的页面：http: [//developers.facebook.com/tools/debug/og/object ?q=http%3A%2F%2Falexcieminski.com%2Findex.html](http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Falexcieminski.com%2Findex.html)

它说你也应该指定 og:description 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-15T14:44:59.490

我在过去 4 小时内遇到了这个问题，结果证明是与浏览器相关的问题。[在我开始接受来自http://www.facebook.com/](http://www.facebook.com/)的第三方 cookie 之后，突然一切都开始工作了......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-16T22:01:41.743

您需要删除所有 'amp;' 分隔查询字符串。因此，您应该只使用 '&'，而不是使用 '&' 分隔每个查询字符串。您也没有任何“href”的网址

# c# - 如何从带有变量的 Access 数据库中运行 C# 中的 Select 语句？

> ID：10097207
> 
> 赞同：2
> 
> 时间：2012-04-10T22:11:27.497
> 
> 标签：c#, ms-access, datagridview

我正在尝试用 C# 创建一个 Windows 窗体应用程序，主要是为了练习我在大学里学到的东西。我的数据库是由三个表（SetIndex、SetSong [连接表] 和 Song）组成的 Access 数据库。我们从未学会如何在应用程序中使用数据库，只是在网站中。我学到的大部分东西，都是通过反复试验学到的。

我有一个组合框列表，其中包含来自 SetIndex 表的日期，值是 ID（SetIndex 的主键）。我需要能够使用选择语句查询数据库，该语句说 setindex.id = setsong.setid 和 setsong.songid = song.id 和 setIndex.id = 一个变量，从下拉列表中选择的值。我使用 (setindex.id = ?) 在 Access 中编写了一个 select 语句，该语句在 Access 中运行良好，但我还没有弄清楚如何在 C# 中执行它。我找到了有关如何使用参数以及如何查询多个表的答案，但没有找到将两者结合起来的答案。

那么有没有办法在代码中做到这一点？

这是我尝试的最后一件事：

```
using (OleDbConnection dataConnection = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Users\Mandy\Documents\Visual Studio 2010\Projects\SetManager1.3\SetManager1.3\SetManager.accdb"))
{
    using (OleDbCommand dataCommand = dataConnection.CreateCommand())
    {
        dataCommand.CommandText = "SELECT Title FROM Song WHERE Song.ID = SetSong.SongID AND SetIndex.ID=SetSong.SetID AND SetIndex.ID=@ID";
        dataConnection.Open();
        dataCommand.Parameters.AddWithValue("@ID", ID);
        DataTable table = new DataTable();
        OleDbDataAdapter adapter = new OleDbDataAdapter();
        adapter.SelectCommand = dataCommand;
        adapter.Fill(table);
        bindingSource1.DataSource = table;
        dataGridView1.AutoResizeColums(DataGridViewAutoSizeColumnsMode.AllCellsExceptHeader);
        dataGridView1.ReadOnly = true;
        dataGridView1.DataSource = bindingSource1;
    }
} 
```

ID 是一个 int 变量，它来自一个全局类，它从列出日期的组合框中获取 ID 值（选定的 SetIndex.ID 的值）。我通过使用标签和按钮进行了测试，以确保这部分工作正常，它似乎正在检索值，将其存储在 GlobalClass.ViewBySetDate 中，并将其转换为我的 int ID 就好了。

但这会出现错误“没有为一个或多个必需参数提供值”。

有没有更好/可行的方法来做到这一点？或者，如果没有，我该如何修复错误？

先感谢您，

曼迪

编辑：我将 Select 语句更改为以下内容：

```
SELECT song.Title FROM SetIndex INNER JOIN (song INNER JOIN SetSong ON song.ID = SetSong.SongID) ON SetIndex.ID = SetSong.SetID WHERE ((set index.id) =[?]); 
```

错误不再存在，但 datagridview 仍然是空白的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:15:38.233

测试你在数据库中查询。。访问数据库的方法是一样的，但是你的查询是错误的

```
SELECT Title FROM Song WHERE Song.ID = SetSong.SongID AND SetIndex.ID=SetSong.SetID AND SetIndex.ID=@ID 
```

SetSong 未在查询中定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T11:15:52.727

```
grigview1.datasource = table;

gridview1.databind(); 
```

# python - Python: formatting dictionary having tuple as keys

> ID：10097211
> 
> 赞同：2
> 
> 时间：2012-04-10T22:11:51.523
> 
> 标签：python, dictionary, format, tuples

I want to format a dictionary for printing (Python 2.7.3), and the dictionary has tuples as keys. With other types of keys I can do

```
>>> coord = {'latitude': '37.24N', 'longitude': '-115.81W', 'altitude':100}
>>> 'Coordinates: {0[latitude]}, {0[longitude]}'.format(coord)
'Coordinates: 37.24N, -115.81W' 
```

I tried the same but it does not work with tuple keys.

```
>>> a={(1,1):1.453, (1,2):2.967}
>>> a[1,1]
1.453
>>> 'Values: {0[1,1]}'.format(a)

Traceback (most recent call last):
  File "<pyshell#66>", line 1, in <module>
    'Values: {0[1,1]}'.format(a)
KeyError: '1,1' 
```

Why? How I can refer to tuple keys in formatting string?

**FOLLOW UP**

It seems we can't (see answer below). As agf quickly pointed out, Python can't handle this (hope it will be implemented). In the meantime, I managed to refer to tuple keys in format string with the following workaround:

```
my_tuple=(1,1)
b={str(x):a[x] for x in a} # converting tuple keys to string keys
('Values: {0[%s]}'%(str(my_tuple))).format(b) # using the tuple for formatting 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T22:18:08.373

在[Format String Syntax](http://docs.python.org/library/string.html#format-string-syntax)下，`field_name`描述（强调我的）：

> `field_name`本身以数字`arg_name`或**关键字**开头。如果它是一个数字，它指的是一个位置参数，如果它是一个关键字，它指的是一个命名的关键字参数。如果格式字符串中的数字 arg_names 依次为 0、1、2、...，则它们都可以省略（不仅仅是一些），并且数字 0、1、2、... 将自动按该顺序插入. **因为`arg_name`不是引号分隔，所以不可能在格式 string中指定任意字典键（例如，字符串`'10'`或`':-]'`**） 。`arg_name`后面可以跟任意数量的索引或属性表达式。形式的表达式`'.name'`使用 选择命名属性`getattr()`，而**形式的表达式`'[index]'`使用`__getitem__()`**.

语法描述`arg_name`为：

```
arg_name ::= [标识符 | 整数]

```

哪里`identifier`是：

```
标识符 ::= (字母|"_") (字母 | 数字 | "_")*

```

因此 a`tuple`不是有效`arg_name`的，因为它既不是 an 也不是`identifier`an `integer`，并且不能是任意字典键，因为没有引用字符串键。

# c++ - What is the best way to write a loop with no body

> ID：10097213
> 
> 赞同：7
> 
> 时间：2012-04-10T22:12:00.180
> 
> 标签：c++

I have a function `func` which returns `true` or `false`. Until `func` returns `false`, I want to keep calling it. What is the least awkward way to do this?

```
do {
  // do nothing
} while (func()); 
```

or..

```
while (func()); 
```

or..

```
while (func())
  if (!func())
    break; 
```

All of them look really awkward and unintuitive to me. Is there another solution to this altogether?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-10T22:13:35.100

I think option B is most commonly used, but you should make it more obvious that you have an empty loop body:

```
while (func())
  ; // do nothing 
```

or

```
while (func())  { /* do nothing */ } 
```

As a side note, this *looks* like some kind of busy waiting. If this is the case, it can and should usually be avoided by using OS-provided synchronization primitives.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-10T22:23:23.793

我以前写

```
while (func()) continue; 
```

当我需要一个完整的忙等待循环时（这不是很常见）。关键字使得很难错过意图，并且它被编译掉了。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T22:16:06.103

选项 B 的变体：

```
while (func())
{
    // no-op
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T22:14:39.453

好吧，第三个做了一些不同的事情——`func`每次迭代它会调用两次。

我猜你想要第二个，它不会让其他人感到困惑。

# c - C Wininet File Upload With Http Post

> ID：10097216
> 
> 赞同：1
> 
> 时间：2012-04-10T22:12:31.467
> 
> 标签：c, winapi, wininet

I am trying to upload a PDF file to my PHP page with my code. But I can only upload, a little of part it. When I open it in Firefox it says the PDF is damaged. Also, when I look at the value of `a` it's just a small part of file. How I can solve this?

```
char *getmem();
int main(int argc, char *argv[]) 
{

char *a = getmem();
printf ("%s\n",a);
        HINTERNET hInet = InternetOpen(NULL, INTERNET_OPEN_TYPE_PRECONFIG, NULL, NULL, 0);
char frmdata[160000];
sprintf(frmdata,"-----------------------------acebdf13572468\r\nContent-Disposition: form-data; name=\"uploaded\"; filename=\"C:\\Users\\pen\\Desktop\\perltut.pdf\"\r\nContent-Type: application/pdf\r\n\r\n%s\r\n-----------------------------acebdf13572468--\r\n",a);

 char *hdrs = "Content-Type: multipart/form-data; boundary=---------------------------acebdf13572468\nUser-Agent: aa";
MessageBox(0,a,a,1);
        HINTERNET hConnect = InternetConnect(
                        hInet,
                        "host",
                        80,
                        NULL,
                        NULL,
                        INTERNET_SERVICE_HTTP,
                        0, 0
        );
LPCSTR accept[2]={"*/*", NULL};
        HINTERNET hRequest = HttpOpenRequest(
                hConnect,
                "POST",
                "/path",
                NULL, NULL, NULL, 0, 0
        );

        BOOL ret = HttpSendRequest(hRequest, hdrs,strlen(hdrs), frmdata, strlen(frmdata));

    system("pause");
    return 0;
}

char *getmem(){

FILE *fp;
long len;
char *buf;
fp=fopen("C:\\Users\\ff\\Desktop\\perltut.pdf","rb");
fseek(fp,0,SEEK_END); 
len=ftell(fp); 
fseek(fp,0,SEEK_SET); /
buf=(char *)malloc(len); 
fread(buf,len,1,fp); /
fclose(fp);
return buf;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T10:58:55.647

您的文件包含零字符，它被解释为字符串的结尾。您不能将 sprintf 用于二进制数据。

# c++ - Setting Boost regex locale?

> ID：10097218
> 
> 赞同：3
> 
> 时间：2012-04-10T22:12:54.663
> 
> 标签：c++, regex, boost, locale, boost-regex

In boost 1.48.0 I find this in the regex code (boost/regex/v4/**w32_regex_traits.hpp**):

```
w32_regex_traits()
      : m_pimpl(re_detail::create_w32_regex_traits<charT>(::boost::re_detail::w32_get_default_locale()))
   { }
//...//
BOOST_REGEX_DECL lcid_type BOOST_REGEX_CALL w32_get_default_locale()
{
    return ::GetUserDefaultLCID();
} 
```

I need to override this w32_get_default_locale() since I always want US locale to be set. How can this be done without modifying the source code?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T22:21:17.610

可以为每个正则表达式基础对象设置语言环境（检查[这个](http://www.boost.org/doc/libs/1_49_0/libs/regex/doc/html/boost_regex/background_information/locale.html)是否有任何陷阱）：

```
boost::regex re;
re.imbue(std::locale("es_ES.UTF-8")); // or whatever you want
re.assign("[a-z]*"); // Important - assign after imbue! 
```

还有一种方法可以使用每个正则表达式对象的 Boost Xpressive 来做到这一点：

```
#include <locale>
#include <boost/xpressive/xpressive.hpp>
...
// Declare a regex_compiler that uses a custom std::locale
std::locale loc; /* ... create a locale here ... */;
boost::xpressive::regex_compiler<char const *, boost::xpressive::cpp_regex_traits<char> > cpprxcomp(loc);
boost::xpressive::cregex cpprx = cpprxcomp.compile( "\\w+" );

// or (after using boost::xpressive)
sregex cpprx2 = imbue(loc)( +_w ); 
```

# javascript - Jquery HTML5 CSS3 Help Needed

> ID：10097223
> 
> 赞同：0
> 
> 时间：2012-04-10T22:13:05.710
> 
> 标签：javascript, jquery, html, css, host

I am using a HTML5 CSS3 jquery template (vivid photo) that I have modified greatly and everything works GREAT on my computer(local host).... I also integrated colorbox jquery.

However, as soon as I uploaded it to a server online, The popup javascript for the navigation menu is not working, and I believe on IE9, the bottom image bar is not loading...

Here it is: [http://tinyurl.com/89lst8j](http://tinyurl.com/89lst8j)

Any help? I am not that good at programming, but I am good at trial and error and manipulation of scripts... I am just confused that if it works on my local host... it must be something with the online server that is not working right??

Please help if you can, thanks!

[http://pritesh.info/vivid-photo-2/](http://pritesh.info/vivid-photo-2/) Here was the template I modified which looks like it works... I just added more pop-up commands for several more navigational items and added colorbox... not much else between swapping content.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:28:48.260

看起来您在页面加载时的 functions.js 中的第 95 行有一些 javascript 错误。这可以防止在页面加载时进一步执行其他 javascript 代码。可能这会破坏您的导航菜单弹出窗口。

页脚导航似乎在 ie 和 Firefox 中都不起作用（扩展的页脚窗格为空）。但是，导航（图像）栏在浏览器 ff 和 ie9 中都加载。

要在不同的浏览器中测试您的网站，您可以安装 IETester 或类似的工具（例如spoon.net）。在 Firefox 中，您可以使用 Firebug 查看幕后。

离题但你可能感兴趣：你做了很多下载超过 2MB 的请求，这对于初始页面加载来说是相当多的。您可以通过减少请求数量来提高网站的性能。

# facebook - Fancybox v2: Facebook Login Not Showing Up inside Fancybox

> ID：10097227
> 
> 赞同：2
> 
> 时间：2012-04-10T22:13:24.817
> 
> 标签：facebook, fancybox

is it possible to have a Facebook login button within the Fancybox AJAX popup?

I tried to program this but it just shows Login with Facebook without the actual button.

I have gotten Fancybox to call a HTML file which has:

```
<div class="fb-login-button" scope="
        email,
        publish_stream
        ,user_education_history
        {*,user_birthday*}  {* Uncomment to enable *}
        ">
    Login with Facebook
  </div> 
```

in it. And yet it doesn't show up within Fancybox.

# c++ - multiple inheritance ambiguity errors

> ID：10097229
> 
> 赞同：0
> 
> 时间：2012-04-10T22:13:34.397
> 
> 标签：c++, gcc

okay, i'm curious why gcc calls this an ambiguity. check this:

```
class base_stream
{
public:
    std::string m_buffer;
};

class idatastream : public base_stream
{

};

class odatastream : public base_stream
{

};

class datastream : public idatastream, public odatastream
{
public:
    void dostuff( m_buffer = "some text";) // reference is ambiguous?
}; 
```

i declare m_buffer only once in base_stream, and do not redeclare it in the inheriting classes, so why is it that when i inherit from both the inheriting classes, m_buffer is ambiguous? the error says this:

`||In member function 'void datastream::dostuff()':|
|22|error: reference to 'm_buffer' is ambiguous|
|6|error: candidates are: std::string base_stream::m_buffer|
|6|error: std::string base_stream::m_buffer|
||=== Build finished: 3 errors, 0 warnings ===|`

i'm confused here because the valid candidates are the same. when i change the defintion of dostuff to:

```
void dostuff() {base_stream::m_buffer = "test string";} 
```

, like it suggests, i get this error:

`||In member function 'void datastream::dostuff()':|
|22|error: 'base_stream' is an ambiguous base of 'datastream'|
||=== Build finished: 1 errors, 0 warnings ===|`

This is where i think the heart of the problem lies. Am i not able to inherit from two classes that inherit from the same class?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:22:21.827

您需要继承`idatastream`和`odatastream`从`base_stream`使用虚拟继承。

所以这样的事情可能会奏效。

```
class base_stream
{
public:
    std::string m_buffer;
};

class idatastream : virtual public base_stream
{

};

class odatastream : virtual public base_stream
{

};

class datastream : public idatastream, public odatastream
{
public:
    void dostuff( m_buffer = "some text";) // reference is ambiguous?
}; 
```

`base_stream`因此，在这种情况下，内部仅存在一个副本，可以`data_stream`访问`m_buffer`.`data_stream`

我希望我回答了你的问题。

# .net - Interactive Graph display using TA-Lib

> ID：10097231
> 
> 赞同：0
> 
> 时间：2012-04-10T22:13:35.437
> 
> 标签：.net

I am looking after an interactive and tick-by-tick graphical software using TA-Lib to run in .NET where I can used my own datafeed (forex prices). Recommendations are welcome.

Rgds

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T10:13:52.553

[http://openforexplatform.com](http://openforexplatform.com)可以解决问题。

TA-Lib 已集成到平台中以提供指标，但是您可能需要进行一些编码才能实现逐笔交易，因为我认为支持的最低时间框架是 1m。

该平台编写得非常好，如果您了解 C#，则可以相对轻松地实现您可以访问的任何数据源。

# android - Optimal WebView Settings for HTML5 Support?

> ID：10097233
> 
> 赞同：14
> 
> 时间：2012-04-10T22:13:57.897
> 
> 标签：android, android-webview

I'm interested in determining what the optimal settings are for a WebView that is intended to show HTML5 content.

Currently I'm using :

```
mWebView.setFocusable(true);
mWebView.setFocusableInTouchMode(true);
mWebView.getSettings().setJavaScriptEnabled(true);
mWebView.getSettings().setPluginsEnabled(true);
mWebView.getSettings().setRenderPriority(RenderPriority.HIGH);
mWebView.getSettings().setCacheMode(WebSettings.LOAD_NO_CACHE);
mWebView.getSettings().setDomStorageEnabled(true);
mWebView.getSettings().setDatabaseEnabled(true);
mWebView.getSettings().setAppCacheEnabled(true);
mWebView.setScrollBarStyle(View.SCROLLBARS_INSIDE_OVERLAY); 
```

With these settings, the WebView score 189 (w/ 1 bonus) on [html5test.com](http://www.html5test.com). I am wondering if there are any settings that I should/could change to get further compatibility with HTML5\. Of course, this list is an amalgamation of settings compiled over some months, so I'm also open to being told I'm doing something wrong. I do not have control over the html content to be displayed but am trying to support as broad a swath of HTML5 as possible.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T14:25:36.460

我要补充：

```
 mWebView.setWebViewClient(new WebViewClient()); // tells page not to open links in android browser and instead open them in this webview 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T02:47:08.133

这是一个与最佳 HTML5 设置有关的（较旧的）项目：
[http ://code.google.com/p/html5webview/source/browse/trunk/HTML5WebView/src/org/itri/html5webview/HTML5WebView.java](http://code.google.com/p/html5webview/source/browse/trunk/HTML5WebView/src/org/itri/html5webview/HTML5WebView.java)

仅供参考，通常我还会为 HTML5 设置数据库存储路径：

```
mWebView.getSettings().setDatabaseEnabled(true);
mWebView.getSettings().setDatabasePath("/data/data/" + Actvity.getPackageName() + "/databases/"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-26T06:24:52.193

也可以设置为

```
try {
  WebSettings settings = view.getSettings();
      settings.setJavaScriptCanOpenWindowsAutomatically(true);
      settings.setSupportMultipleWindows(true);
      settings.setBuiltInZoomControls(true);
      settings.setJavaScriptEnabled(true);
      settings.setAppCacheEnabled(true);
      settings.setAppCacheMaxSize(10 * 1024 * 1024);
      settings.setAppCachePath("");
      settings.setDatabaseEnabled(true);
      settings.setDomStorageEnabled(true);
      settings.setGeolocationEnabled(true);
      settings.setSaveFormData(false);
      settings.setSavePassword(false);
      settings.setRenderPriority(WebSettings.RenderPriority.HIGH);
      // Flash settings
      settings.setPluginState(WebSettings.PluginState.ON);

      // Geo location settings
      settings.setGeolocationEnabled(true);
      settings.setGeolocationDatabasePath("/data/data/selendroid");
    } catch (Exception e) {
      SelendroidLogger.error("Error configuring web view", e);
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T22:23:43.073

恕我直言，答案可能比您的 Android 版本更多，而不是特定设置。

看看 CanIUse.com 的“表格”部分：

*   [http://caniuse.com/](http://caniuse.com/)

... 或 MobileHTML5.org：

*   [http://mobilehtml5.org/](http://mobilehtml5.org/)

# ruby-on-rails - 使用 Braintree 表单构建器的 Rails 通用表单

> ID：10097236
> 
> 赞同：1
> 
> 时间：2012-04-10T22:14:02.740
> 
> 标签：ruby-on-rails, form-for, braintree

我有一个类似的表格：

```
 <%= form_for :customer,
  :params => @result && @result.params[:customer],
       :errors => @result && @result.errors.for(:customer),
       :builder => BraintreeHelper::BraintreeFormBuilder,
       :url => Braintree::TransparentRedirect.url,
       :html => { :autocomplete => "off"} do |f| -%>
      First name: <%= f.text_field :first_name , :value => "John"%><br />
      <%= f.submit %>
    <% end %> 
```

当我尝试将值添加到该文本字段时，我不会这样做。但是，如果我从 form_for 标记中获取构建器，我就可以这样做。任何人都有使用 Braintree 表单生成器的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T16:26:16.120

沉思伟走在了正确的轨道上……

Rails 中的表单构建器帮助您将表单与应用程序中的模型联系起来，并为与模型属性对应的表单元素生成值、名称和 ID。它们非常有帮助，但有时有必要覆盖它们给你的东西。

您在 Braintree Rails 示例应用程序中找到的示例表单构建器提供了一些有用的东西，因为 TR 表单直接发布到我们的网关而不是您的应用程序，并为您的表单字段提供 Braintree 网关期望的属性名称和默认值，并有助于填充返回到您的应用程序的验证错误。

在这种特殊情况下，表单构建器最终将输入的值（包括 :first_name）与现有值（如果有）或 nil （覆盖您传入的内容）合并。

[https://github.com/braintree/braintree_ruby_examples/blob/master/rails_tr_checkout/app/helpers/braintree_form_builder.rb#L22](https://github.com/braintree/braintree_ruby_examples/blob/master/rails_tr_checkout/app/helpers/braintree_form_builder.rb#L22)

随意修改表单生成器以满足您的需求！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:32:36.557

使用“form_for”时，默认值为表单对象的值。例如

```
@person = Person.new(:first_name => "Jack")

<%= form_for :person do |f| %>
  <%= f.text_field :first_name %>  
<% end %> 
```

你会得到一个默认值 "Jack" 的文本输入：

```
<input type="text" value="Jack"/> 
```

因此，在使用时`f.text_field`，您无法设置默认值，除非您更改表单对象（这里是@person）。

如果你想设置默认值，我建议你要么使用没有“表单对象”的“form_tag”，或者使用jQuery来实现默认值的东西。

# c# - 如何使用 LinQ 提高性能

> ID：10097240
> 
> 赞同：1
> 
> 时间：2012-04-10T22:14:42.650
> 
> 标签：c#, performance

我有这个 LinQ：

```
var IPI = item.INV_TAXES.Where(t => t.TAXTYPES.TAXNAME == "IPI")
                        .Select(t => new {TOT_AMT = t.TAXVALUE, t.TAXFACTOR, t.TAXBASE})
                        .First(); 
```

然后在代码中我调用下一行大约 10 次：

```
PerformSomeCalculation(IPI.TOT_AMT);
PerformAnotherStuff(IPI.TOT_AMT,IPI.TAXVALUE);
PerformSomethingElse(IPI.TAXBASE); 
```

我想知道每次我调用 IPI 的每个成员时，LinQ 都会执行还是只是在我第一次分配它时执行？

首先将 IPI 成员分配给变量会更好吗？

```
decimal IPI_TOT_AMT = IPI.TOT_AMT,
        IPI_TAXVALUE = IPI.TAXVALUE,
        IPI_TAXBASE = IPI.TAXBASE; 
```

然后使用它们。

感谢所有的建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T22:27:31.907

首先，停止在你的代码中大喊大叫。

你的担心是对的。每次访问时都会重新执行*查询*，*因为结果可能会发生变化。*但结果不是查询，而是一个值。*`First`*

 *也就是说，如果你这样做：

```
var query = whatever.Where(whatever).Select(whatever);
Console.WriteLine(query.First());
Console.WriteLine(query.First()); 
```

然后查询由第一行*创建*，由第二行*执行*，并由第三行*再次执行。*查询不知道第二次调用时第一个结果是否不同`First`，因此再次运行查询。

相反，如果你这样做：

```
var query = whatever.Where(whatever).Select(whatever);
var first = query.First();
Console.WriteLine(first);
Console.WriteLine(first); 
```

然后第一行创建查询，第二行执行查询并存储结果，第三行和第四行报告存储的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T22:18:44.963

在您提供的代码中，LINQ 查询只会在您调用该`.First()`方法时运行。

通过在访问变量之前将成员分配给变量，不会有明显的性能改进。

请注意，并非所有 LINQ 语句都如此。例如，如果您说过：

```
var IPIs = item.INV_TAXES.Where(t => t.TAXTYPES.TAXNAME == "IPI")
                     .Select(t => new {TOT_AMT = t.TAXVALUE, t.TAXFACTOR, t.TAXBASE}); 
```

...然后将 IPI 传递给几种方法，您最终可能会得到单独的数据库往返。为了避免该问题，您将`.ToList()`在分配变量之前调用强制立即评估。但在这种情况下，调用`.First()`有效地做同样的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T22:18:51.333

> 如果每次调用 IPI 的每个成员时，LinQ 每次都执行还是仅在我分配它的第一次执行？

不，查询只执行*一次*- `IPI`是具有一堆原始属性（实际上是小数）的匿名类型的实例。此对象不再连接到查询 - 您的查询已执行并作为扩展方法的结果返回此对象，该[`First()`](http://msdn.microsoft.com/en-us/library/bb291976.aspx)扩展方法强制立即执行并返回输入集合中的第一项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-14T11:24:49.180

Eric Lippert 的回答解释了你想要的一切。但是，如果您想进一步优化，可以尝试使用 CompiledQuery.Compile 方法来存储和重用查询。

有关详细信息，请查看 msdn。你可以从这里开始：http: [//msdn.microsoft.com/cs-cz/library/bb399335.aspx](http://msdn.microsoft.com/cs-cz/library/bb399335.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T22:20:44.320

First() 方法执行 linq 查询并返回第一个对象 该对象的类型与您使用的任何其他对象一样，唯一的区别是类定义是由编译器编写的。

因此，当您使用该对象时，不再执行任何操作*

# php - 将 json 解析为字符串时出错

> ID：10097241
> 
> 赞同：2
> 
> 时间：2012-04-10T22:14:44.297
> 
> 标签：php, android, json

![在此处输入图像描述](../Images/a62d23f489b1d4df7e9f606e2943b1bf.png)伙计们，我正在尝试将我的 android 应用程序连接到 php 服务器并使用 json 来编码数据。我无法在应用程序上对其进行解码。请帮忙

```
public class JsonDemoActivity extends Activity implements OnClickListener{
    /** Called when the activity is first created. */
     HttpPost httppost;

        StringBuffer buffer;

        HttpResponse response;

        HttpClient httpclient;
        TextView tv;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        tv=(TextView) findViewById(R.id.textView1);
        Button b=(Button) findViewById(R.id.button1);
        b.setOnClickListener(this);
    }

    public void onClick(View v) {
        // TODO Auto-generated method stub
         try{

             httpclient=new DefaultHttpClient();

             httppost= new HttpPost("http://10.0.2.2/jsondemo.php"); // make sure the url is correct.

             response=httpclient.execute(httppost);

             HttpEntity he=response.getEntity();

             JSONObject jo=new JSONObject(EntityUtils.toString(he));

             String message=jo.getString("message");
             String from=jo.getString("from");
             String to=jo.getString("to");

             tv.setText("Message "+message+"/n"+"from "+from+"/n"+"to "+to);

             tv.setText("Response from PHP : " + response);

         }catch(Exception e){

             System.out.println("Exception : " + e.getMessage());
                tv.setText(e.getLocalizedMessage());
                System.out.println("Response from php"+response);
         }

    }
} 
```

这是php端代码

```
<?php

header('Content-Type: application/json');
$obj = new stdClass();

$obj->message="hello";
$obj->from="pratik";
$obj->to="server";

echo json_encode($obj);
?> 
```

我收到错误无法将 json 转换为字符串。![在此处输入图像描述](../Images/1d57bbb72e5f9359e8e1f405f73e5ea3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T10:11:51.050

我删除了 tv.setText("Response from PHP :" + response); 从代码。终于成功了。！！！

tv.setText("消息"+message+"/n"+"从"+from+"/n"+"到"+to); 那被 tv.setText("Response from PHP : " + response);

# sorting - 如何在 Grails 的关联表中按列对结果进行排序？

> ID：10097243
> 
> 赞同：2
> 
> 时间：2012-04-10T22:14:46.703
> 
> 标签：sorting, grails, grails-orm

我有两个具有简单一对多关系的域类（一个 Gift 可以有多个 GiftInstance），如下所示。我希望检索给定用户的所有 GiftInstances（以及可能的其他条件），但根据与每个 GiftInstance 关联的 Gift 的“过期”属性对结果进行排序。我将如何做到这一点？我宁愿呆在 Grails 的范围内（动态查找器、标准等），而不必执行原始 SQL

```
class Gift {

    String name;
    String description;
    Date expires;
}

class GiftInstance {

    static belongsTo = [gift: Gift]
    User user;
    ... other fields ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:42:06.303

您可以通过两种方式[在您的域类中映射来做到这一点。](http://grails.org/doc/latest/guide/GORM.html#defaultSortOrder)

在 Gift 类中设置排序和顺序，如下所示：

```
class Gift {

    String name;
    String description;
    Date expires;

    static hasMany = [giftInstances: GiftInstance]

    static mapping = {
        giftInstances sort: "expired"
    }

} 
```

或在您的 GiftInstance 域类中。

```
class GiftInstance {

    static belongsTo = [gift: Gift]
    User user
    boolean expired

    static mapping = {
        sort: "expired"
    }
} 
```

是的，您也可以设置顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T04:57:07.477

您可以在 GiftInstance 中添加命名查询

```
 class GiftInstance {

    static namedQueries = {
      giftInstanceByUser {  user ->
          eq 'user', user

          order 'gift.expires', 'asc'
      }
    }
} 
```

# repository - Bitbucket 获取有关存储库的所有提交的信息

> ID：10097245
> 
> 赞同：4
> 
> 时间：2012-04-10T22:14:49.717
> 
> 标签：repository, feed, commit, bitbucket

我想要有关在我的 BitBucket 存储库上完成的所有提交的信息。

我不需要 XML 提要。我只想要一个提交列表和提交的顺序以及可能有关合并的信息。

在 bitbucket 网站上，信息以分页形式显示，对我来说还不够。如果能获得一个 pdf 或列出我所有提交的东西，那就太好了。

有没有办法这样做？

任何帮助，将不胜感激。

谢谢，

潘卡伊。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T08:16:05.837

您应该进行**本地克隆**，然后使用可以生成此类 PDF 的任何工具访问本地存储库。这样您就可以完全访问您需要的有关提交和合并的信息。由于 Mercurial 是一个分布式版本控制系统，这确实是您应该访问它的方式：在本地，而不是通过 Bitbucket 上的屏幕抓取。

如果您使用 Java 或 Python，则可以使用[JavaHg](http://javahg.aragost.com/)或[python-hglib](http://mercurial.selenic.com/wiki/PythonHglib)访问存储库。请参阅[库的完整列表](http://mercurial.selenic.com/wiki/CommandServer#Libraries)。

# hadoop - 没有数据节点启动

> ID：10097246
> 
> 赞同：32
> 
> 时间：2012-04-10T22:14:49.770
> 
> 标签：hadoop, hdfs

我正在尝试使用以下指南在伪分布式配置中设置*Hadoop 版本 0.20.203.0 ：*

[http://www.javacodegeeks.com/2012/01/hadoop-modes-explained-standalone.html](http://www.javacodegeeks.com/2012/01/hadoop-modes-explained-standalone.html)

运行`start-all.sh`脚本后，我运行“jps”。

我得到这个输出：

```
4825 NameNode
5391 TaskTracker
5242 JobTracker
5477 Jps
5140 SecondaryNameNode 
```

当我尝试使用以下方法向 hdfs 添加信息时：

```
bin/hadoop fs -put conf input 
```

我收到一个错误：

```
hadoop@m1a2:~/software/hadoop$ bin/hadoop fs -put conf input
12/04/10 18:15:31 WARN hdfs.DFSClient: DataStreamer Exception: org.apache.hadoop.ipc.RemoteException: java.io.IOException: File /user/hadoop/input/core-site.xml could only be replicated to 0 nodes, instead of 1
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:1417)
        at org.apache.hadoop.hdfs.server.namenode.NameNode.addBlock(NameNode.java:596)
        at sun.reflect.GeneratedMethodAccessor6.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:523)
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1383)
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1379)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:416)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1059)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:1377)

        at org.apache.hadoop.ipc.Client.call(Client.java:1030)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:224)
        at $Proxy1.addBlock(Unknown Source)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:82)
        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:59)
        at $Proxy1.addBlock(Unknown Source)
        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.locateFollowingBlock(DFSClient.java:3104)
        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.nextBlockOutputStream(DFSClient.java:2975)
        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.access$2000(DFSClient.java:2255)
        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream$DataStreamer.run(DFSClient.java:2446)

12/04/10 18:15:31 WARN hdfs.DFSClient: Error Recovery for block null bad datanode[0] nodes == null
12/04/10 18:15:31 WARN hdfs.DFSClient: Could not get block locations. Source file "/user/hadoop/input/core-site.xml" - Aborting...
put: java.io.IOException: File /user/hadoop/input/core-site.xml could only be replicated to 0 nodes, instead of 1
12/04/10 18:15:31 ERROR hdfs.DFSClient: Exception closing file /user/hadoop/input/core-site.xml : org.apache.hadoop.ipc.RemoteException: java.io.IOException: File /user/hadoop/input/core-site.xml could only be replicated to 0 nodes, instead of 1
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:1417)
        at org.apache.hadoop.hdfs.server.namenode.NameNode.addBlock(NameNode.java:596)
        at sun.reflect.GeneratedMethodAccessor6.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:523)
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1383)
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1379)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:416)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1059)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:1377)

org.apache.hadoop.ipc.RemoteException: java.io.IOException: File /user/hadoop/input/core-site.xml could only be replicated to 0 nodes, instead of 1
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:1417)
        at org.apache.hadoop.hdfs.server.namenode.NameNode.addBlock(NameNode.java:596)
        at sun.reflect.GeneratedMethodAccessor6.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:523)
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1383)
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1379)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:416)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1059)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:1377)

        at org.apache.hadoop.ipc.Client.call(Client.java:1030)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:224)
        at $Proxy1.addBlock(Unknown Source)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:82)
        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:59)
        at $Proxy1.addBlock(Unknown Source)
        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.locateFollowingBlock(DFSClient.java:3104)
        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.nextBlockOutputStream(DFSClient.java:2975)
        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.access$2000(DFSClient.java:2255)
        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream$DataStreamer.run(DFSClient.java:2446) 
```

我不完全确定，但我相信这可能与数据节点没有运行的事实有关。

有谁知道我做错了什么，或者如何解决这个问题？

编辑：这是 datanode.log 文件：

```
2012-04-11 12:27:28,977 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: STARTUP_MSG:
/************************************************************
STARTUP_MSG: Starting DataNode
STARTUP_MSG:   host = m1a2/139.147.5.55
STARTUP_MSG:   args = []
STARTUP_MSG:   version = 0.20.203.0
STARTUP_MSG:   build = http://svn.apache.org/repos/asf/hadoop/common/branches/branch-0.20-security-203 -r 1099333; compiled by 'oom' on Wed May  4 07:57:50 PDT 2011
************************************************************/
2012-04-11 12:27:29,166 INFO org.apache.hadoop.metrics2.impl.MetricsConfig: loaded properties from hadoop-metrics2.properties
2012-04-11 12:27:29,181 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source MetricsSystem,sub=Stats registered.
2012-04-11 12:27:29,183 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Scheduled snapshot period at 10 second(s).
2012-04-11 12:27:29,183 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: DataNode metrics system started
2012-04-11 12:27:29,342 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source ugi registered.
2012-04-11 12:27:29,347 WARN org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Source name ugi already exists!
2012-04-11 12:27:29,615 ERROR org.apache.hadoop.hdfs.server.datanode.DataNode: java.io.IOException: Incompatible namespaceIDs in /tmp/hadoop-hadoop/dfs/data: namenode namespaceID = 301052954; datanode namespaceID = 229562149
        at org.apache.hadoop.hdfs.server.datanode.DataStorage.doTransition(DataStorage.java:232)
        at org.apache.hadoop.hdfs.server.datanode.DataStorage.recoverTransitionRead(DataStorage.java:147)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.startDataNode(DataNode.java:354)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.<init>(DataNode.java:268)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.makeInstance(DataNode.java:1480)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.instantiateDataNode(DataNode.java:1419)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.createDataNode(DataNode.java:1437)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.secureMain(DataNode.java:1563)
        at org.apache.hadoop.hdfs.server.datanode.DataNode.main(DataNode.java:1573)

2012-04-11 12:27:29,617 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: SHUTDOWN_MSG:
/************************************************************
SHUTDOWN_MSG: Shutting down DataNode at m1a2/139.147.5.55
************************************************************/ 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-04-11T16:47:24.530

您在 DN 日志中遇到的错误在此处描述：http: [//www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-multi-node-cluster/#java-io-ioexception-不兼容的命名空间 ID](http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-multi-node-cluster/#java-io-ioexception-incompatible-namespaceids)

从该页面：

目前，似乎有两种解决方法，如下所述。

**解决方法 1：从头开始**

我可以证明以下步骤解决了这个错误，但副作用不会让你开心（我也不会）。我发现的粗略解决方法是：

1.  停止集群
2.  删除有问题的DataNode上的数据目录：该目录由conf/hdfs-site.xml中的dfs.data.dir指定；如果您按照本教程进行操作，则相关目录为 /app/hadoop/tmp/dfs/data
3.  重新格式化 NameNode（注意：在此过程中所有 HDFS 数据都将丢失！）
4.  重启集群

当删除所有 HDFS 数据并从头开始听起来不是一个好主意时（在初始设置/测试期间可能没问题），您可以尝试第二种方法。

**解决方法 2：更新有问题的 DataNode 的 namespaceID**

非常感谢 Jared Stehler 的以下建议。我自己还没有测试过，但是请随时尝试一下并将您的反馈发送给我。这种解决方法是“微创”，因为您只需在有问题的 DataNode 上编辑一个文件：

1.  停止数据节点
2.  编辑 /current/VERSION 中 namespaceID 的值以匹配当前 NameNode 的值
3.  重启数据节点

如果您按照我的教程中的说明进行操作，则相关文件的完整路径为：

> NameNode：/app/hadoop/tmp/dfs/name/current/VERSION
> 
> 数据节点：/app/hadoop/tmp/dfs/data/current/VERSION
> 
> （背景：dfs.data.dir 默认设置为
> 
> ${hadoop.tmp.dir}/dfs/data，我们设置 hadoop.tmp.dir
> 
> 在本教程中到 /app/hadoop/tmp）。

如果您想知道 VERSION 的内容是什么样的，这是我的一个：

> # /current/VERSION 的内容
> 
> 命名空间ID=393514426
> 
> storageID=DS-1706792599-10.10.10.1-50010-1204306713481
> 
> cTime=1215607609074
> 
> storageType=DATA_NODE
> 
> 布局版本=-13

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-07-30T16:19:52.447

好的，我再发一次：

如果有人需要这个，对于较新版本的 Hadoop（基本上我正在运行 2.4.0）

*   在这种情况下停止集群`sbin/stop-all.sh`

*   然后转到`/etc/hadoop`配置文件。

在文件中： hdfs-site.xml 寻找对应的目录路径 dfs.namenode.name.dir dfs.namenode.data.dir

*   递归删除两个目录（rm -r）。

*   现在通过格式化namenode`bin/hadoop namenode -format`

*   最后`sbin/start-all.sh`

希望这可以帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-07-14T04:39:01.077

我在使用 hadoop1.1.2 的伪节点上遇到了同样的问题所以我运行 bin/stop-all.sh 来停止集群，然后在 hdfs-site.xml 中看到我的 hadoop tmp 目录的配置

```
<name>hadoop.tmp.dir</name>
<value>/root/data/hdfstmp</value> 
```

所以我进入 /root/data/hdfstmp 并使用命令删除了所有文件（你可能会丢失你的数据）

```
rm -rf * 
```

然后再次格式化namenode

```
bin/hadoop namenode -format 
```

然后使用启动集群

```
bin/start-all.sh 
```

主要原因是 bin/hadoop namenode -format 没有删除旧数据。所以我们必须手动删除它。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-01-15T08:28:31.803

执行以下步骤：

```
1\. bin/stop-all.sh
2\. remove dfs/ and mapred/ folder of hadoop.tmp.dir in core-site.xml
3\. bin/hadoop namenode -format
4\. bin/start-all.sh
5\. jps 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-29T14:17:07.060

我一直在使用 CDH4 作为我的 hadoop 版本，并且在配置它时遇到了麻烦。即使在尝试重新格式化我的名称节点后，我仍然收到错误消息。

我的 VERSION 文件位于

```
/var/lib/hadoop-hdfs/cache/{username}/dfs/data/current/VERSION 
```

您可以通过查找**hadoop.tmp.dir**属性找到 HDFS 缓存目录的位置：

```
more /etc/hadoop/conf/hdfs-site.xml 
```

我发现这样做

```
cd /var/lib/hadoop-hdfs/cache/
rm -rf * 
```

然后重新格式化namenode我终于能够解决这个问题。感谢第一个回复帮助我找出我需要轰炸的文件夹。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-07T13:01:26.850

尝试格式化您的数据节点并重新启动它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-03T06:21:35.427

我尝试了 Jared Stehler 在 Chris Shain 回答中建议的方法 2，我可以确认在进行这些更改后，我能够解决上述问题。

我对名称和数据版本文件使用了相同的版本号。意思是说将版本号从文件VERSION内部（/app/hadoop/tmp/dfs/name/current）复制到VERSION内部（/app/hadoop/tmp/dfs/data/current），它就像魅力一样

干杯！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-03-02T18:16:15.710

我在使用未修改的 cloudera quickstart vm 4.4.0-1 时遇到了这个问题

作为参考，cloudera 经理说我的数据节点健康状况良好，尽管 DataStreamer 堆栈跟踪中的错误消息说没有数据节点正在运行。

信用来自[https://stackoverflow.com/a/10110369/249538](https://stackoverflow.com/a/10110369/249538)的解决方法＃2，但我将详细介绍我使用 cloudera 快速入门 vm 的具体经验。

具体来说，我这样做了：
按此顺序，`hue1, hive1, mapreduce1, hdfs1` 通过 cloudera 管理器[http://localhost.localdomain:7180/cmf/services/status 停止服务](http://localhost.localdomain:7180/cmf/services/status)

通过以下方式找到我的`VERSION`文件：
`sudo find / -name VERSION`

我有：

```
/dfs/dn/current/BP-780931682-127.0.0.1-1381159027878/current/VERSION
/dfs/dn/current/VERSION
/dfs/nn/current/VERSION
/dfs/snn/current/VERSION 
```

`namespaceID`我检查了这些文件的内容，但除了一个文件完全丢失之外，它们都有一个匹配项。所以我添加了一个条目。

然后我通过cloudera manager以相反的顺序重新启动了服务。现在我可以`-put`塞进hdfs了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-24T11:41:21.980

`dfs.name.dir`就我而言，我错误地为and设置了一个目的地`dfs.data.dir`。正确的格式是

```
 <property>
 <name>dfs.name.dir</name>
 <value>/path/to/name</value>
 </property>

 <property>
 <name>dfs.data.dir</name>
 <value>/path/to/data</value>
 </property> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-10T03:13:31.533

我有同样的数据节点丢失问题，我按照这个对我有用的步骤

1.找到datanode所在的文件夹。 **cd hadoop/hadoopdata/hdfs** 2.查看文件夹，你会看到你在hdfs **ls**中有什么文件 3.删除 datanode文件夹，因为它是旧版本的datanode **rm -rf/ datanode/*** 4\. 运行上一条命令后你会得到新版本 5\. 启动新的datanode **hadoop-daemon.sh 启动datanode** 6\. 刷新web服务。你会看到丢失的节点出现在 [我的终端](http://i.stack.imgur.com/GMSxS.png)

# mysql - 数据库结构 - 关系的存储

> ID：10097247
> 
> 赞同：0
> 
> 时间：2012-04-10T22:15:06.970
> 
> 标签：mysql, rdbms

这是一个复杂的问题，所以我将尝试简化它。

我的服务器上有一个 mysql 实例，托管了许多用于不同目的的模式。这些模式通常（不完美）以[EAV](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)方式构建。我需要定期将信息移入和移出该结构。

**示例 1**：为了在网页上显示信息，我获取信息，将其粘贴到一个复杂对象中，然后通过 json 将其传递给网页，在网页中将 json 转换为复杂的 javascript 对象，然后我将其与[淘汰赛](http://knockoutjs.com/)和类似的东西。

**结论**：这导致*很多*逻辑被放在多个地方，以便我可以将页面上的值与数据库中的值相关联。

**Example2**：为了让用户可以从 pdf 中导入信息，我在 pdf 表单字段中存储了很多信息。在这种情况下，我没有编写 pdf，因此表单字段的命名方式没有使所有这些逻辑都足够容易为[CRUD](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete)编写 3 次或更多次。

**结论**：这导致我将 pdf 表单字段列表复制到数据库中的表中，以便我可以以某种方式将它们与应放置数据的位置相关联。出现的问题是 pdf 上的字段需要与 schema.table.column 关联，而我发现存储该信息的唯一方法是通过[VARCHAR](http://dev.mysql.com/doc/refman/5.0/en/char.html)

这两个示例都没有涉及少量数据（例如示例 1 中的 6 个表和示例 2 中的大约 1400 个 pdf 表单字段）。鉴于*Example1和生成的逻辑存储在多个位置，构建**Example2*似乎是合乎逻辑的，我可以将数据之间的**关系**存储在数据库中，在那里它们可以被一致地访问和更改，并且适用于所有涉及的方法。

现在，很可能我只是很愚蠢，而且我所有的谷歌搜索都没有发现有一种简单的方法可以将这些数据与正确的 schema.table.column 相关联如果是这种情况，那么告诉我正确的方法这样做是简单的答案。

但是，这就是我感到困惑的地方。我一直被告知，您永远不想在数据库中存储有关数据库的信息，尤其是不作为字符串 (varchar)。这在很多层面上似乎都是错误的，我只是不知道我是否愚蠢，最好遵循*Example1*或者这里是否有一些关于数据库结构的技巧我错过了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:55:48.537

不知道你从哪里得到*“......从不......在数据库中存储有关数据库的信息”*。对于 EAV 模型，通常将元模型（实体类型及其允许的属性）存储在数据库本身中，以便它是自描述的。如果您必须更改元模型，您更愿意更改代码还是表中的几行？

EAV 数据库的主要缺点是您失去了进行简单连接的能力。连接类型的操作变得更加复杂。就像生活中的其他事情一样，您会根据自己的要求进行权衡。我已经看到自我描述的 EAV 架构非常成功地使用。

# c++ - QSslError：证书是自签名的，不受信任

> ID：10097250
> 
> 赞同：5
> 
> 时间：2012-04-10T22:15:21.747
> 
> 标签：c++, qt, ssl, qnetworkaccessmanager

我正在尝试向证书自签名的网络服务发送休息请求。目前我正在创建一个请求，设置 url 和 auth。键作为标题。然后我告诉回复忽略这个 ssl 错误：

```
QSslError error(QSslError::SelfSignedCertificate);
QList<QSslError> expectedSslErrors;
expectedSslErrors.append(error);

QNetworkReply *reply = _accessManager.put(request, ""); // no requestbody
reply->ignoreSslErrors(expectedSslErrors); 
```

当我运行它时，我收到以下 ssl 错误：

> 9 - 证书是自签名的，不受信任

其次是网络错误nr 6：

> 请求失败并显示消息：SSL 握手失败

目前我忽略了所有错误，因为它似乎是唯一有效的东西。觉得脏。

如果有人知道我做错了什么，将不胜感激！

编辑：

变成：

```
QList<QSslError> expectedSslErrors;
expectedSslErrors.append(QSslError::SelfSignedCertificate);
expectedSslErrors.append(QSslError::CertificateUntrusted);
reply->ignoreSslErrors(expectedSslErrors); 
```

但仍然得到同样的错误......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T01:30:51.737

> 证书是自签名的，不受信任

问题是“不受信任”的部分。您必须提供自签名证书，作为`QSslError`.

**编辑：**根据源代码，`ignoreSslErrors`通过比较错误代码和证书来比较实际收到的 SSL 错误和传递给的错误。
因此，如果 OpenSSL 返回的错误将包含证书，例如 with `QSslError::SelfSignedCertificate`，则必须始终将证书传递给`QSslError`构造函数，否则比较将失败。

但是您也可以通过将信号连接`sslError()`到检查错误列表仅包含自签名证书错误的插槽来手动忽略错误，然后调用`ignoreSslErrors()`（不带任何参数）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-21T09:46:20.693

阅读文档，您需要做的是在响应 QNetworkReply::sslErrors 信号的插槽上调用 ignoreSslErrors

# php - MySQL标签搜索

> ID：10097251
> 
> 赞同：0
> 
> 时间：2012-04-10T22:15:24.163
> 
> 标签：php, mysql, search, tags

我有一个带有图像和标签的表格（称为`tbl_images`）

```
image_file    image_tags
----------    ----------------------------
test.png      tag1 another_tag tag2
hi.jpg        tag9 tag1 another_tag qwerty 
```

我将如何做到这一点：

*   搜索“另一个”不返回任何内容
*   搜索“tag1”返回 test.png 行
*   搜索“tag1 another_tag”返回 test.png 行
*   搜索“qwerty tag2”不返回任何内容

?

如，如果它们都出现在同一行的同一 image_tags 字段中，则可以使用*完整的标签名称进行搜索并同时搜索多个标签。*笔记：-

*   我只在一个领域内搜索
*   它是通过 PHP 搜索输入完成的（在 中检索`$_GET['search_terms']`）
*   我不能这样做`LIKE '%tag9%`，因为 tag9 可能出现在更大的标签中，例如`Atag98`，并且正如我所说，我只想要*完全*匹配的标签。
*   我不能这样做`LIKE ' tag9 '`（注意前后的空格，）因为tag9可能出现在image_tags字段的开头（没有空格，所以不会匹配）
*   我不能这样做，`LIKE 'tag9 another_tag'`因为我不知道 another_tag 是否在 tag9 之后，同样`LIKE 'tag9%another_tag'`出于同样的原因我不能这样做；tag9 也可以是更大标签的一部分（如前所述。）

另外，全文搜索是否适合这个？如果是这样，你能提供一个例子吗？

一个棘手的问题（无论如何对我来说；）任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T22:24:41.857

使用图像存储标签的更好解决方案是创建一个单独的表，其中标签链接到图像。然后，您将为每个标签创建一行，例如

```
image_file (FK)  tag
---------------  -----------
test.png         tag1
test.png         another_tag
test.png         tag2
hi.jpg           tag9
hi.jpg           tag1
hi.jpg           another_tag
hi.jpg           qwerty 
```

然后，您可以简单地查找哪些标签与图像相关：

```
SELECT tag FROM tags WHERE image_file = 'test.png' 
```

或者哪些图像与某个标签相关：

```
SELECT image_file FROM tags WHERE tag = 'tag1' 
```

使用这种方法可以避免您在问题中描述的所有 LIKE 问题。像这样规范化数据库时不需要全文搜索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T22:26:18.707

如果您的标签没有明确的分隔符，您需要进行正则表达式选择。

```
SELECT * FROM tbl_images WHERE image_tags REGEXP '[[:<:]]tag[[:>:]]' 
```

[[:<:]] 和 [[:>:]] 标记标识 MySQL 中的单词边界......所以虽然 REGEX 选择可能比 LIKE 慢，但这仍然有效。

在此处阅读有关 MySQL REGEX 的更多信息：http: [//dev.mysql.com/doc/refman/5.1/en/regexp.html](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T22:27:26.350

如果所有标签都用空格分隔，请将它们分解成一个数组，然后在数组中搜索您要查找的关键字。如果找到关键字，则取该行。

我不知道您在这里使用的语言是什么：

```
loop all rows:
   get values of the current row:
   tags = array of the tags cell, explode ' '
   foreach (tag in tags):
      if (tag == keyword)
         save current row info
   end foreach;
end loop; 
```

您不需要像这里建议的那样为每个标签创建一个新行，因为这不是一个理想的选择。

# .net - SimpleInjector 不使用隐式属性注入来注入属性

> ID：10097267
> 
> 赞同：2
> 
> 时间：2012-04-10T22:16:45.520
> 
> 标签：.net, dependency-injection, ioc-container, simple-injector

我有一个`ObjectA`，它有一个属性 for `ObjectB`，它有一个属性 for `ObjectC`，它们都在[Simple Injector](http://simpleinjector.codeplex.com)容器中。当我创建时`ObjectA`，我会调用`InjectProperties`它，它会加载`ObjectB`. 但是，此时，它不会加载`ObjectC`对新创建的 的引用`ObjectB`；它不执行我所说的对象的“深度积累”。

有没有办法启用它？

**编辑**

我有一个类对象A：

```
public class ObjectA
{
     public ObjectB InstanceB { get; set; }
} 
```

其中有一个属性`ObjectB`：

```
public class ObjectB
{
     public ObjectC InstanceC { get; set; }
} 
```

所有这些都已使用容器上的标准注册方法进行注册。为了得到`ObjectA`，我使用它`GetInstance<ObjectA>(),`，这很好，我还构建了一个初始化程序来在创建时构建所有对象：

```
_container.RegisterInitializer<object>(i => _container.InjectProperties(i)); 
```

这在它解析时`ObjectB`注入`ObjectA`，但随后不`ObjectC`注入。`ObjectB``ObjectB`

有解决方法吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T11:52:26.803

我使用您的代码和配置编写了一个小测试（并添加了缺失的`ObjectC`）：

```
public class ObjectA
{
    public ObjectB InstanceB { get; set; }
}

public class ObjectB
{
    public ObjectC InstanceC { get; set; }
}

public class ObjectC
{

} 
```

考试：

```
[TestMethod]
public void ImplicitPropertyInjectionTest()
{
    // Arrange
    var container = new Container();

    container.RegisterInitializer<object>(
        i => container.InjectProperties(i));

    // Act
    var a = container.GetInstance<ObjectA>();

    // Assert
    Assert.IsNotNull(a.InstanceB);
    Assert.IsNotNull(a.InstanceB.InstanceC);
} 
```

测试成功并`InstanceC`正确注入。我预计您的配置有问题，或者可能`ClassC`无法创建。尝试`ClassC`直接请求找出容器无法创建的原因：

```
container.GetInstance<ClassC>(); 
```

这条线可能会失败，这`InstanceC`就是没有注入的原因。

这直接让我想到了以下几点：

像您一样调用`RegisterInitializer<object>(instance => container.InjectProperties(instance))`是启用隐式属性注入的有效方法，但您应尽可能避免使用隐式属性注入，因为这会导致无法验证容器配置（`container.Verify()`例如使用）。你已经注意到了这一点，因为`InstanceC`被跳过了。相反，您应该尽可能使用构造函数注入。[在此处](http://simpleinjector.codeplex.com/wikipage?title=How-to&referringTitle=Documentation#Verifying_Configuration)查看有关以可以验证的方式编写代码的更多信息。

如果在某些场景下无法使用构造函数注入，最好使用显式属性注入，具体做法如下：

```
container.RegisterInitializer<ClassA>(a =>
{
    a.InstanceB = container.GetInstance<ClassB>();
});

container.RegisterInitializer<ClassB>(b =>
{
    b.InstanceC = container.GetInstance<ClassC>();
}); 
```

这会显式注入属性`InstanceB`和`InstanceC`，并且当无法注入属性时将无法构造。

可以在[此处](https://simpleinjector.codeplex.com/wikipage?title=Advanced-scenarios&#Property-Injection)找到有关使用 Simple Injector 进行属性注入的更多信息。

最后一点。请注意，在隐式属性注入方面，所​​有容器的行为大致相同。因此，这并不是 Simple Injector 特有的。如果该容器支持此功能，它将跳过每个无法注入的属性。换句话说，所有容器都会默默地失败并继续，这通常不是你想要的。这意味着在使用默认启用隐式属性注入的容器时必须格外小心。

# ruby-on-rails - heroku db:push 错误：时区位移超出范围

> ID：10097270
> 
> 赞同：3
> 
> 时间：2012-04-10T22:17:09.560
> 
> 标签：ruby-on-rails, heroku, timezone

我制造了一个`heroku db:push`

起初一切顺利

```
Sending schema
Schema:        100% |==========================================| Time: 00:00:06
Sending indexes
schema_migrat: 100% |==========================================| Time: 00:00:01
Sending data
3 tables, 8 records
schema_migrat: 100% |==========================================| Time: 00:00:00
users:           0% |                                          | ETA:  --:--:--
Saving session to push_201204102202.dat.. 
```

这些是 push_201204102202.dat 文件的内容：

```
 {"klass":"Taps::Push","database_url":"sqlite://db/development.sqlite3","remote_url":"http://heroku:osui59a24am79x@taps19.heroku.com","session_uri":"/sessions/7436189125","stream_state":{},"completed_tables":["schema_migrations"],"table_filter":null,"local_tables_info":{"schema_migrations":2,"users":4,"microposts":2}} 
```

然后麻烦开始了：

```
    ！！！捕获服务器异常
    HTTP 代码：500
    Taps 服务器错误：PGError：错误：时区位移超出范围：“2012-04-10 12:00:00.000000+5894467200”

    ["/app/.bundle/gems/ruby/1.9.1/gems/sequel3.20.0/lib/sequel/adapters/postgres.rb:175:in `async_exec'", "/app/.bundle/gems/ruby /1.9.1/gems/sequel-3.20.0/lib/seq
uel/adapters/postgres.rb:175:in `block (2 levels) in execute'","/app/.bundle/gems/ruby/1.9.1/gems/sequel-.20.0/lib/sequel/database/ logging.rb:28:in`log_yield'","/app/.bundle/gems/ruby/1.9.1/gems/sequel-.20.0/lib/sequel/adapters/postgres.rb:175:in `block in执行'","/app/.bundle/gems/ruby/1.9.1/gems/sequel-.20.0/lib/sequel/adapters/postgres.rb:158:in`check_disconnect_errors'","/app/.bundle /gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/adapters/postgres.rb:175:in `execute'","/app/.bundle/gems/ruby/1.9.1/ gems/sequel-.20.0/lib/sequel/adapters/postgres.rb:240:in `block (2 levels) in execute'", "/app/.bundle/gems/ruby/1.9.1/gems/sequel- 3.20.0/lib/sequel/connection_pool/threaded.rb:71:in`hold'","/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/database/connecting.rb:226:in `synchronize'", "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/adapters/postgres .rb:240:in `block in execute'", "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/adapters/postgres.rb:261:in ` check_database_errors'", "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/adapters/postgres.r
b:238:in `execute'", "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/database/query.rb:71:in `execute_dui'" , "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/dataset/actions.rb:552:in `execute_dui'", "/app/.bundle/gems /ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/dataset/actions.rb:243:in `block (2 l
evls) 在导入'", "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/dataset/actions.rb:243:in `每个'", "/ app/.bundle/gems/ruby/1.9.1/gems/sequel-3.2
0.0/lib/sequel/dataset/actions.rb:243:in `block in import'", "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/database /query.rb:223:in `_transaction'
", "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/database/query.rb:209:in `block in transaction'", "/app/.捆绑包/gems/ruby/1.9.1/gems/sequel-3.20。
0/lib/sequel/connection_pool/threaded.rb:84:in `hold'", "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/database/connecting .rb:226:in `同步'"
, "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib/sequel/database/query.rb:207:in `事务'", "/app/.bundle/gems /ruby/1.9.1/gems/sequel-3.20.0/lib/sequ
el/dataset/actions.rb:243:in `import'", "/app/lib/taps/data_stream.rb:315:in `import_rows'", "/app/lib/taps/data_stream.rb:158:在 `fetch_remote_in_server'", "/a
pp/lib/taps/server.rb:114:in `block (3 levels) in '", "/app/lib/taps/utils.rb:161:in `call'", "/app/lib/taps /utils.rb:161:in `server_error_handlin
g'", "/app/lib/taps/server.rb:112:in `block (2 levels) in '", "/app/lib/taps/db_session.rb:15:in `block in conn'" , "/app/.bundle/gems/ruby/1.9.1/g
ems/sequel-3.20.0/lib/sequel/database/connecting.rb:76:in `connect'", "/app/.bundle/gems/ruby/1.9.1/gems/sequel-3.20.0/lib /sequel/core.rb:119:in `connect'", "/a
pp/lib/taps/db_session.rb:14:in `conn'", "/app/lib/taps/server.rb:111:in `block in '", "/app/.bundle/gems/ruby/ 1.9.1/gems/sinatra-1.0/lib/sinatra/
base.rb:865:in `call'", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:865:in `block in route'" , "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-
1.0/lib/sinatra/base.rb:521:in `instance_eval'", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:521:in `route_eval'", "/app/.bundle/gems/rub
y/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:500:in `block (2 levels) in route!'", "/app/.bundle/gems/ruby/1.9.1/ gems/sinatra-1.0/lib/sinatra/base.rb:497:in `ca
tch'", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:497:in `block in route!'", "/app/.bundle /gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/
base.rb:476:in `each'", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:476:in `route!'", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/
sinatra/base.rb:601:in `dispatch!'", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:411:in `block in打电话！'", "/app/.bundle/gems/ruby/1.9.1/
gems/sinatra-1.0/lib/sinatra/base.rb:566:in `instance_eval'", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb :566:in `block in invoke'", "/ap
p/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:566:in `catch'", "/app/.bundle/gems/ruby/1.9.1/ gems/sinatra-1.0/lib/sinatra/base.rb:566:in `invok
e'", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:411:in `call!'", "/app/.bundle/gems /ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:399：
在`调用'中", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:979:in `block in call'", "/app/.捆绑包/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinat
ra/base.rb:1005:in `synchronize'", "/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:979:in `call'" , "/home/heroku_rack/lib/static_assets.rb:9:
在 `call'", "/home/heroku_rack/lib/last_access.rb:15:in `call'", "/app/.bundle/gems/ruby/1.9.1/gems/rack-1.2.1/lib /rack/urlmap.rb:47:in `block in call'", "/app/
.bundle/gems/ruby/1.9.1/gems/rack-1.2.1/lib/rack/urlmap.rb:41:in `each'", "/app/.bundle/gems/ruby/1.9.1/ gems/rack-1.2.1/lib/rack/urlmap.rb:41:in `call'", "/home
/heroku_rack/lib/date_header.rb:14:in `call'", "/app/.bundle/gems/ruby/1.9.1/gems/rack-1.2.1/lib/rack/builder.rb:77:在 `call'", "/app/.bundle/gems/ruby/1.9.1/ge
ms/thin-1.2.7/lib/thin/connection.rb:76:in `block in pre_process'", "/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib /thin/connection.rb:74:in `catch'", "/app/.
bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/connection.rb:74:in `pre_process'", "/app/.bundle/gems/ruby/1.9.1/gems /thin-1.2.7/lib/thin/connection.rb:57:in `
进程'", "/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/connection.rb:42:in `receive_data'", "/app/.bundle/ gems/ruby/1.9.1/gems/eventmachine-0.12.10/l
ib/eventmachine.rb:256:in `run_machine'", "/app/.bundle/gems/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'" , "/app/.bundle/gems/ruby/1.9
.1/gems/thin-1.2.7/lib/thin/backends/base.rb:57:in `start'", "/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2\. 7/lib/thin/server.rb:156:in `start'", "/app/.bundle/gem
s/ruby/1.9.1/gems/thin-1.2.7/lib/thin/controllers/controller.rb:80:in `start'", "/app/.bundle/gems/ruby/1.9.1/gems /thin-1.2.7/lib/thin/runner.rb:177:in `run_com
mand'", "/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/runner.rb:143:in `run!'", "/app/.bundle /gems/ruby/1.9.1/gems/thin-1.2.7/bin/thin:6:in `'", "/app/.bundle/gems/ruby/1.9.1/bin/thin:19:in `load'", "/app/.bundle/gems/ruby/1.9.1/bin/thin:19:in `'"]

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T04:52:23.990

这是一个 ruby​​ 1.9.3 错误。您应该使用 1.9.2 和 db:push 才能工作。如果你安装了 rvm，你可以这样做：

```
rvm 使用 ruby​​-1.9.2-p318
heroku 数据库：推送

```

确保使用正确的 1.9.2 版本，我以 p318 为例，因为我已经安装了它。要使用 rvm 查看已安装的 ruby​​ 版本，请使用`rvm list`. 如果您没有安装 1.9.2，请使用`rvm install ruby-1.9.2`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T20:55:42.523

使用带有 Ruby 1.9.2 的 gemset，安装水龙头和 sqlite3，你会没事的。

```
sudo gem install heroku --no-ri --no-rdoc

sudo gem install taps --no-ri --no-rdoc

sudo gem install sqlite3 --no-ri --no-rdoc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T13:56:35.510

[终于在 Dosha 的回答的](https://github.com/ricardochimal/taps/issues/92#issuecomment-11996909)帮助下完成了这个工作。

确保您的 ruby​​ 版本与 Heroku 上运行的版本相匹配。似乎 1.9.2 是这些迁移的最稳定版本。

将您的 gemfile 更改为具有以下内容（假设您使用的是 SQLite）：

```
group :development do
 gem 'taps', :require => false
 gem 'sqlite3'
end 
```

这可能仍然无法解决您的问题，因为您的`heroku db:push`命令使用的是 Heroku 工具栏，而不是旧的、现已弃用的 heroku gem。不幸的是，我们实际上想要较旧的 gem，但是 Heroku 工具栏被`heroku`. 为了解决这个问题，您需要在您的 ruby​​ 1.9.2 版本上安装 heroku gem，然后通过其特定的文件路径访问它。

所以，接下来的步骤展示了如何让它工作：

在控制台中运行以下命令：

```
rvm install ruby-1.9.2-p320
rvm use ruby-1.9.2-p320
bundle install`
sudo gem install heroku --no-ri --no-rdoc 
```

然后运行：

```
rake assets:clean
bundle exec rake assets:precompile 
```

将您的更改提交到 Github。

然后在控制台中输入以下内容：

`~/.rvm/gems/ruby-1.9.2-p320/gems/heroku-2.40.0/bin/heroku db:push` （使用您自己的文件路径，如果它与此不同。）

# c++ - 使用 vector<>::iterator 时查找索引

> ID：10097273
> 
> 赞同：2
> 
> 时间：2012-04-10T22:17:47.890
> 
> 标签：c++

我想知道是否有办法获取随机访问迭代器的索引。例如：

```
int myIndex = -1;
for(std::vector<std::string>::iterator iter = myStringVec.begin();
    iter != myStringVec.end();
    iter++)
{
  if(someFunction(*iter))  //got a hit on this string
    myIndex = ...
} 
```

如果这是超级琐碎的，请原谅。一个明显的解决方案是按索引进行迭代，但我的想法是考虑随机访问迭代器，迭代器可能有一种方法可以告诉你它的索引是什么，比如`myIndex = iter.index()`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-10T22:19:05.093

```
myIndex = iter - myStringVec.begin(); 
```

或者

```
myIndex = std::distance(myStringVec.begin(), iter); 
```

另请注意，为了可移植（并可能消除编译器警告），`myIndex`应该是 type`std::vector<std::string>::difference_type`而不是`int`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-10T22:20:49.130

您可以使用`std::distance`, 或减法。`std:distance`具有在不提供随机访问的迭代器上工作的优势（但使用专门化为随机访问迭代器提供恒定时间的距离）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-10T22:20:29.700

你可以这样做：

```
if(someFunction(*iter))  //got a hit on this string
{
   myIndex = std::distance(myStringVec.begin(), iter);
} 
```

# ruby-on-rails-3 - Actionmailer 电子邮件似乎在控制台和日志中发送，但它们从未到达

> ID：10097275
> 
> 赞同：1
> 
> 时间：2012-04-10T22:18:09.233
> 
> 标签：ruby-on-rails-3, gmail, email, linode

导轨 3.0.0

这是我在环境/production.rb 中的配置：

```
 config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {  
    :address              => "smtp.gmail.com",  
    :port                 => 587,  
    :domain               => "<domain>",  
    :user_name            => "<un>@gmail.com",  
    :password             => "<pw>",  
    :authentication       => "plain",  
    :enable_starttls_auto => true  
  }

  config.action_mailer.raise_delivery_errors = true

  config.action_mailer.perform_deliveries = true 
```

我还尝试按照另一篇 Stack Overflow 帖子中的建议注释掉该域。

我尝试通过我的应用程序和控制台发送邮件。在控制台中没有错误，它返回邮件对象但不显示任何其他内容。当我尝试通过应用程序发送时，日志显示它呈现了我的用户邮件模板。

我在 Linode 上托管我的应用程序，但他们向我保证这种方法“应该”有效，并且 Linode 不应该是问题。我还检查以确保我的应用程序正在“生产”中运行。

调试这个有什么想法吗？我尝试发送到三个不同的常见电子邮件主机。

编辑：这是我在控制台中发送邮件的代码：

```
user_mailer.rb

class UserMailer < ActionMailer::Base
  default :from => "myaccount@gmail.com"
  layout 'user_layout' 

  def activation(user)
    @user = user    
    mail(:to => @user.email, :subject => 'Activate your account')  
  end

end

console command

> u = User.last
> u.email
#myotheraccount@gmail.com
> UserMailer.activation(u).deliver 
```

更新 2：当我添加一个纯文本视图模板时，发送很好。所以只是发送 HTML 版本有问题。我已经简化了我所有的 HTML 模板以包含简单的标签和标准的 doctype html，但仍然没有骰子。

# java - 使用警报管理器的 Android 通知不起作用

> ID：10097282
> 
> 赞同：1
> 
> 时间：2012-04-10T22:18:34.557
> 
> 标签：java, android, notifications

我一直在尝试让通知在正确的时间在 Android 上启动。我希望他们在 App 启动后 2 分钟内起飞。如果我可以让它在这里工作，我可以很容易地让它在我真正需要的地方工作。日志显示所需的代码行正在运行，但通知从未启动。我花了超过 8 个小时来尝试调试它，却一无所获。任何帮助都会很棒。

这是我创建的提醒代码：

```
 final PendingIntent pi = PendingIntent.getBroadcast(this.mContext,
            0,
            i,
            PendingIntent.FLAG_ONE_SHOT);

    TimeZone timeZone= TimeZone.getDefault();
    Calendar time= Calendar.getInstance(timeZone);
    time.add(Calendar.MINUTE, 2);

    this.mAlarmManager.set(AlarmManager.RTC_WAKEUP,
            time.getTimeInMillis(),
            pi);

    Log.d ("setReminder",time.getTime().toLocaleString()); 
```

现在下面是我的`OnAlarmRecieve`代码，根据日志，它永远不会在 2 分钟后运行。类扩展`BroadcastReceiver`

```
@Override
public void onReceive(final Context context,
        final Intent intent) {
    Log.d(TAG, "Recieved wake up cal from Alarm Manger");

    final String tableName = intent.getStringExtra(IntentExtraStringStorage.TABLE_NAME);
    final long rowID = intent.getLongExtra(IntentExtraStringStorage.ROW_ID,
            -1);
    final String titleString = intent.getStringExtra(IntentExtraStringStorage.NOTIFICATION_TITLE);
    final String notificationString=intent.getStringExtra(IntentExtraStringStorage.NOTIFICATION_NOTE);

    WakeUpReminderIntentService.acuireStaticLock(context);

    /*if (tableName== Task.TABLE_NAME) {
        launchTaskView(context, rowID);
    }
    else {
        Log.e (TAG, "Did not Launch");
        Toast.makeText(context, "Did not work right", Toast.LENGTH_SHORT).show();
    }*/
    Intent i = new Intent (context, ReminderService.class);
    i.putExtra("taskID", rowID);
    i.putExtras(intent.getExtras());
    Log.d(TAG, "Launched task");
    //TODO Added code to build the screen correctly
    //FIXIT this need to be finished.
    context.startService(i);
}]= 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T16:47:55.007

我发现了我的问题。原来我没有把 OnAlarmReciever 作为接收器放在 mainfest 中。还需要在服务中添加其他内容。

Draw back to be new to developing for this is so many little things.

# retain - 保留计数为 +0 的对象返回给调用者，其中预期保留计数为 +1（拥有）

> ID：10097286
> 
> 赞同：1
> 
> 时间：2012-04-10T22:19:03.627
> 
> 标签：retain

我正在验证我的应用程序，我收到了很多这样的警告：

保留计数为 +0 的对象返回给调用者，其中预期保留计数为 +1（拥有）

这是生成警告的方法之一的示例（警告在返回行上）

```
+ (vehicleInfo*) newWithNode: (CXMLNode*) node
{
    if(node == nil) { return nil; }
    return (vehicleInfo*)[[[vehicleInfo alloc] initWithNode: node] autorelease];
} 
```

这是我应该担心的事情吗？我该如何解决？

在此先感谢，塞缪尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T22:24:59.527

您收到警告是因为您违反了成为使用名为 with 的方法创建的对象的所有者的合同`new`。任何代码调用`+newWithNode`都期望成为返回值的所有者，并且应该稍后调用`-release`以释放它。

有关详细信息，请参阅[Objective-C 内存管理策略](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html#//apple_ref/doc/uid/20000994-BAJHFBGH)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-12T21:29:06.510

在链接之后，指南说：

**使用 autorelease 发送延迟版本**

当您需要发送延迟释放消息时（通常是从方法返回对象时）使用自动释放。例如，您可以像这样实现 fullName 方法：

```
- (NSString *)fullName {
     NSString *string = [[[NSString alloc] initWithFormat:@"%@ %@",
                                      self.firstName, self.lastName] autorelease];
     return string;
} 
```

你拥有 alloc 返回的字符串。要遵守内存管理规则，您必须在丢失对它的引用之前放弃对字符串的所有权。但是，如果您使用 release，则字符串将在返回之前被释放（并且该方法将返回无效对象）。使用自动释放，您表示您想要放弃所有权，但您允许方法的调用者在释放之前使用返回的字符串。

所以，尽管有警告，但我似乎在做正确的事情，不是吗？

# css - 给 ul 一个图片库的类，这样页面上的其他 ul 不受影响

> ID：10097290
> 
> 赞同：0
> 
> 时间：2012-04-10T22:19:06.773
> 
> 标签：css, class, overlay, html-lists, image-gallery

我的网站有一个带有 ul（带链接）的标题，用于导航栏。

![（链接到下图 - 1）](../Images/c62adf421c2dd25fb542b064465d8c21.png)

我的一个页面有一个图片库的 ul。模板来自这个网站：[http ://www.thecssninja.com/demo/futurebox/v3/](http://www.thecssninja.com/demo/futurebox/v3/)

图片库做我想做的事：单击（覆盖）时在页面上打开放大的图片，放大的图片居中，单击屏幕上的任何位置时关闭。问题是 ul 弄乱了我的导航栏。我该如何解决？导航栏已经有一个 ul 类。

![（链接到下面的图片 - 2）](../Images/62467f3ae2bb750bc74a32faa0036ffa.png)

这是相关的CSS：

```
ul li{
display: inline-block;
float: left;
list-style: none;
margin:0.3em;
border:0.1em solid black;
-webkit-border-radius:0.25em;
-moz-border-radius:0.25em;
border-radius:0.25em;
}
ul li:hover { border:0.1em solid red; }

ul li img, ul li label { 
    display: block; 
    cursor: pointer; 
}

ul li input { display: none; }
ul li input:checked + .overlay { display: table; }

.overlay{
width: 100%;
height: 100%;
position: absolute; 
top: 0; 
left: 0; 
display: none; 
z-index: 999;
background: rgb(0,0,0);
background: rgba(0,0,0,0.7);}

.overlay label
{
    display: table-cell; 
    vertical-align: middle; 
    text-align: center;
}
    .overlay img,
    .overlay iframe
    {
        display: inline;
        border:0.25em solid white;
        -webkit-border-radius:0.25em;
        -moz-border-radius:0.25em;
        border-radius:0.25em;
    } 
```

这是HTML：

```
 <div class="text2col">
        <h2>Photo gallery</h2>

<ul>
    <li>
        <label for="futurebox01"><img src="http://www.thecssninja.com/demo/futurebox/gr_ninja-attack_med.gif" width="100" height="102" alt="The CSS Ninja" /></label>
        <input type="radio" id="futurebox01" name="gallery" />
        <div class="overlay">
            <label for="close" title="Close futurebox"><img src="http://www.thecssninja.com/demo/futurebox/gr_cssninja_lrg.png" alt="The Css Ninja" width="469" height="500" /></label>
        </div>
    </li>
    <li>
        <label for="futurebox02"><img src="http://www.thecssninja.com/demo/futurebox/gr_ninja-attack_med.gif" width="100" height="102" alt="The CSS Ninja" /></label>
        <input type="radio" id="futurebox02" name="gallery" />
        <div class="overlay">
            <label for="close" title="Close futurebox"><img src="http://www.thecssninja.com/demo/futurebox/gr_cssninja_lrg2.png" alt="The Css Ninja" width="469" height="500" /></label>
        </div>
    </li>
    <li>
        <label for="futurebox03"><img src="http://www.thecssninja.com/demo/futurebox/gr_ninja-attack_med.gif" width="100" height="102" alt="The CSS Ninja" /></label>
        <input type="radio" id="futurebox03" name="gallery" />
        <div class="overlay">
            <label for="close" title="Close futurebox"><img src="http://www.thecssninja.com/demo/futurebox/gr_cssninja_lrg3.png" alt="The Css Ninja" width="469" height="500" /></label>
        </div>
    </li>
    <li>
        <label for="futurebox04"><img src="http://www.thecssninja.com/demo/futurebox/gr_ninja-attack_med.gif" width="100" height="102" alt="The CSS Ninja" /></label>
        <input type="radio" id="futurebox04" name="gallery" />
        <div class="overlay">
            <label for="close" title="Close futurebox"><img src="http://www.thecssninja.com/demo/futurebox/gr_cssninja_lrg4.png" alt="The Css Ninja" width="469" height="500" /></label>
        </div>
    </li>
... (more li's)...
</ul>
<div class="clear">&nbsp;</div>

<input type="radio" id="close" name="gallery" /> 
```

我还尝试为图片库添加一个 ul 类，通过更改所有`ul`to`ul.futurebox`并将其添加到网页中的类中，这使导航栏恢复正常，但它不再居中覆盖图像（覆盖在那里，但图像转到页面的顶部，左侧）。

![（链接到下图 - 3）](../Images/4956be8a9659bfab8158cc87496d9593.png)

问题（我认为）是覆盖有一个相邻的兄弟连接器：`ul li input:checked + .overlay { display: table; }`所以在为图片库添加一个类之后。或者......这可能完全是另一个问题，但我不确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:41:54.830

我还没有找到答案，但这个演示做了我想做的一切：[http ://www.thecssninja.com/demo/futurebox/](http://www.thecssninja.com/demo/futurebox/)

它没有相邻的兄弟连接器，所以我使用它作为模板，并为图片库放入一个名为“futurebox”的 ul 类，这样我的导航栏就不会受到影响。

除了这个的问题是它会遍历您使用“后退”按钮单击的所有图像，而另一个则没有。

# c# - 跨线程操作无效：控件“richtxtStatus”从创建它的线程以外的线程访问

> ID：10097293
> 
> 赞同：-1
> 
> 时间：2012-04-10T22:19:29.270
> 
> 标签：c#, return-value, invoke

> **可能重复：**
> [跨线程操作无效：控件从创建它的线程以外的线程访问](https://stackoverflow.com/questions/142003/cross-thread-operation-not-valid-control-accessed-from-a-thread-other-than-the)

下面是我编写的一个方法，它尝试从 RichTextControl 获取文本并返回它。

```
 /** @delegate */
    private delegate string RichTextBoxObtainContentsEventHandler();

    private string ObtainContentsRichTextBox()
    {

        if (richtxtStatus.InvokeRequired)
        {
            // this means we're on the wrong thread!  
            // use BeginInvoke or Invoke to call back on the 
            // correct thread.
            richtxtStatus.Invoke(
                new RichTextBoxObtainContentsEventHandler(ObtainContentsRichTextBox)
                );
            return richtxtStatus.Text.ToString();
        }
        else
        {

            return richtxtStatus.Text.ToString();
        }
    } 
```

但是，当我尝试运行此程序时，出现以下异常： 跨线程操作无效：控件'richtxtStatus' 从创建它的线程以外的线程访问。

如何修改上述代码以允许我返回内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T22:24:33.357

问题是您仍在访问错误线程上的文本框。您需要返回 的结果`Invoke()`，而不仅仅是调用、忽略结果，然后做您一开始就试图避免的事情。此外，您不需要将其包装在事件处理程序中；只需再次调用当前方法。

```
if (richtxtStatus.InvokeRequired)
{
    // this means we're on the wrong thread!  
    // use BeginInvoke or Invoke to call back on the 
    // correct thread.
    string text = (string)richtxtStatus.Invoke(ObtainContentsRichTextBox);
    return text;
} 
```

最后，`.Text`已经是一个字符串，所以不需要调用`.ToString()`它。可以直接退货。

# c# - MVC MS 图表导出到 PNG C#

> ID：10097297
> 
> 赞同：0
> 
> 时间：2012-04-10T22:20:20.673
> 
> 标签：c#, asp.net-mvc, mschart

我正在尝试导出在 c# 中生成的 MS Chart，我成功地将其添加到 itextsharp PDF 使用

```
....
 var image = Image.GetInstance(ChartPng(list, propertyList, displayNames));
..... 
```

图表保存在缓冲区中

```
 using (var chartimage = new MemoryStream())
            {
                chart.SaveImage(chartimage, ChartImageFormat.Png);
                return chartimage.GetBuffer();
            } 
```

我能够在浏览器中打开它，使用：

```
 return File(ChartPng(list, propertyList, displayNames), "image/png"); 
```

我如何将其作为下载而不是将其保存到特定磁盘，任何建议。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:53:10.863

如果您只是想将其直接写入响应流，您可以在此处查看我的答案：

[如何使用 jQuery 在 MVC 中刷新 asp.net 图表](https://stackoverflow.com/questions/1247315/how-to-refresh-asp-net-charts-in-mvc-using-jquery/2293745#2293745)

**编辑：**

要提示用户下载文件，请使用 FileContentResult。

[http://msdn.microsoft.com/en-us/library/system.web.mvc.filecontentresult.aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.filecontentresult.aspx)

# javascript - 实例化函数对象时，局部变量创建了多少次？（ 先进的 ）

> ID：10097299
> 
> 赞同：1
> 
> 时间：2012-04-10T22:20:29.360
> 
> 标签：javascript

在下面的消息对象中，如果我这样称呼它：

```
var message_object = new Message( response_element );
message_object.display( 'empty' ); 
```

是否为每次调用 new Message() 创建了消息数组...如果是这样，我如何确保只有一个消息数组，因为这就是我所需要的？

```
var Message = function( element )
{
    var messages =  
    {
        name:         'Please enter a valid name',
        email:        'Please enter a valid email',
        pass:         'Please enter passoword, 6-40 characters',
        url:          'Please enter a valid url',
        title:        'Please enter a valid title',
        tweet:        'Please enter a valid tweet',
        empty:        'Please complete all fields',
        email_s:      'Please enter a valid email.',
        same:         'Please make emails equal',
        taken:        'Sorry, that email is taken',
        validate:     'Please contact <a class="d" href="mailto:chris@domain.com">support</a> to reset your password',
    }
    this.display = function( type ) 
    {
        element.innerHTML = messages[ type ];
        new Effects().fade( element, 'down', 4000 );
    }
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T22:26:22.250

是的，每次都会执行整个函数，并且每次都会重新定义消息对象和函数。

您可能想要做的是将它包装在一个闭包中，并利用 Javascript 的原型继承

```
var Message = (function () {
    var messages = {
        name:         'Please enter a valid name',
        email:        'Please enter a valid email',
        pass:         'Please enter passoword, 6-40 characters',
        url:          'Please enter a valid url',
        title:        'Please enter a valid title',
        tweet:        'Please enter a valid tweet',
        empty:        'Please complete all fields',
        email_s:      'Please enter a valid email.',
        same:         'Please make emails equal',
        taken:        'Sorry, that email is taken',
        validate:     'Please contact <a class="d" href="mailto:chris@host.com">support</a> to reset your password',
    };
    var Message = function (element) {
        this.element = element;
    };

    Message.prototype.display = function( type ) {
        this.element.innerHTML = messages[ type ];
        new Effects().fade( this.element, 'down', 4000 );
    };
    return Message;
}()); 
```

这使`messages`对象对“类”保持私有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T22:24:25.600

`messages`是一个对象而不是数组，但是是的：每次调用您的`Message()`函数时都会创建一个新对象。

如果您只需要一个副本，那么在其他语言中什么是“静态”变量，一种方法是执行以下操作：

```
var Message = function( element )
{
    this.display = function( type ) 
    {
        element.innerHTML = this.messages[ type ];
        new Effects().fade( element, 'down', 4000 );
    }
};

Message.prototype.messages = {
    name:         'Please enter a valid name',
    email:        'Please enter a valid email',
    pass:         'Please enter passoword, 6-40 characters',
    url:          'Please enter a valid url',
    title:        'Please enter a valid title',
    tweet:        'Please enter a valid tweet',
    empty:        'Please complete all fields',
    email_s:      'Please enter a valid email.',
    same:         'Please make emails equal',
    taken:        'Sorry, that email is taken',
    validate:     'Please contact <a class="d" href="mailto:chris@host.com">support</a> to reset your password',
}; 
```

`prototype`所有实例都可以访问添加到 的属性和方法- 请注意，在`display()`方法中它以`this.messages`.

（请注意，在原型上定义您的方法也可能是明智的，这将涉及使用 . 制作参数`display()`的实例副本。）`element``this.element = element;`

# data-structures - 展开树旋转算法：为什么使用 zig-zig 和 zig-zag 而不是更简单的旋转？

> ID：10097306
> 
> 赞同：1
> 
> 时间：2012-04-10T22:21:07.240
> 
> 标签：data-structures, tree, rotation, splay-tree, tree-balancing

我不太明白为什么 splay 树数据结构中的旋转不仅考虑了评级节点的父节点，还考虑了祖父节点（之字形和之字形操作）。为什么以下不起作用：

例如，当我们向树中插入一个新节点时，我们检查是插入左子树还是右子树。如果我们插入到左边，我们将结果向右旋转，右子树反之亦然。递归它会是这样的

```
Tree insert(Tree root, Key k){
    if(k < root.key){
        root.setLeft(insert(root.getLeft(), key);
        return rotateRight(root);
    }
    //vice versa for right subtree
} 
```

那应该避免整个“张开”过程，你不觉得吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T19:26:06.377

您在树上提出的算法称为“移动到根”启发式算法，并[在 Sleator 和 Tarjan 关于展开树的原始论文的第四页进行了讨论。](http://www.cs.cmu.edu/~sleator/papers/self-adjusting.pdf#page=4)他们引用了 Allen 和 Munro 的一篇较早的论文，该论文表明，如果您尝试使用移至根作为重塑树的方法，则每次查找的摊销成本可能为 O(n)，即很慢。展开是一种非常精心设计的用于重塑树的算法，无论执行何种访问顺序，它都能保证平均 O(log n) 查找。

直观地说，移动到根不是重塑树的一个很好的方法，因为它会向下移动从节点到根的路径上的所有节点，同时试图使访问的节点在未来更容易到达。因此，在执行此版本的树重组时，整体树可能会变得更糟。另一方面，splay 方法倾向于降低展开节点的高度及其访问路径上的所有节点，这意味着作为一个整体，树在展开期间往往会变得更好。

希望这可以帮助！

# javascript - 尝试使用 node.js 安装 jquery 时出现错误消息

> ID：10097310
> 
> 赞同：1
> 
> 时间：2012-04-10T22:21:21.603
> 
> 标签：javascript, jquery, node.js

我正在尝试在 node.js 应用程序中使用 jQuery。根据[Can I use jQuery with Node.js? 似乎很容易？](https://stackoverflow.com/questions/1801160/can-i-use-jquery-with-node-js)但是当我试图跑步时`npm install jQuery jsdom htmlparser xmlhttprequest`，根本`npm install jQuery`没有一个人似乎对我有用。这是我收到的错误消息的全文：

```
 $ npm install jQuery jsdom htmlparser xmlhttprequest
npm http GET https://registry.npmjs.org/htmlparser
npm http GET https://registry.npmjs.org/jQuery
npm http GET https://registry.npmjs.org/xmlhttprequest
npm http GET https://registry.npmjs.org/jsdom
npm http 304 https://registry.npmjs.org/jsdom
npm http 304 https://registry.npmjs.org/htmlparser
npm http 304 https://registry.npmjs.org/xmlhttprequest
npm http 200 https://registry.npmjs.org/jQuery
npm http GET https://registry.npmjs.org/contextify
npm http GET https://registry.npmjs.org/cssom
npm http GET https://registry.npmjs.org/request
npm http 304 https://registry.npmjs.org/contextify
npm http 304 https://registry.npmjs.org/cssom
npm http 304 https://registry.npmjs.org/request
npm http GET https://registry.npmjs.org/bindings
npm http 304 https://registry.npmjs.org/bindings

> contextify@0.1.2 install /Users/nicmeiring/node_modules/jsdom/node_modules/contextify
> node-gyp rebuild

info it worked if it ends with ok 
spawn python [ '/Users/nicmeiring/.node-gyp/0.6.14/tools/gyp_addon',
  'binding.gyp',
  '-I/Users/nicmeiring/node_modules/jsdom/node_modules/contextify/build/config.gypi',
  '-f',
  'make' ]
ERR! Error: not found: make
    at F (/usr/local/lib/node_modules/npm/node_modules/which/which.js:43:28)
    at E (/usr/local/lib/node_modules/npm/node_modules/which/which.js:46:29)
    at Object.oncomplete (/usr/local/lib/node_modules/npm/node_modules/which/which.js:57:16)
ERR! not ok
npm WARN optional dependency failed, continuing contextify@0.1.2
xmlhttprequest@1.3.0 ./node_modules/xmlhttprequest 
jquery@1.6.3 ./node_modules/jquery 
htmlparser@1.7.5 ./node_modules/htmlparser 
jsdom@0.2.13 ./node_modules/jsdom 
├── request@2.9.200
└── cssom@0.2.3 
```

在我的 node.js 应用程序文件 (app.js) 中，我使用 包含 jquery 模块`var $ = require('jQuery)`，但是，正如预期的那样，当我尝试在我的应用程序中使用 jQuery 时，它返回一个错误。任何想法是什么导致安装失败？谢谢

更新： jquery 模块已成功安装，但是当我尝试运行我的应用程序时，我收到了一个新错误。以下是脚本：

应用程序.js

```
 var express = require('express')
  , routes = require('./routes')
  , $ = require('jquery');

var app = module.exports = express.createServer();

// Configuration

app.configure(function(){
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(require('stylus').middleware({ src: __dirname + '/public' }));
  app.use(app.router);
  app.use(express.static(__dirname + '/public'));

});

app.configure('development', function(){
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
});

app.configure('production', function(){
  app.use(express.errorHandler());
});

// Routes

app.get('/', routes.index);
app.get('/', routes.getData);

app.listen(4000);
console.log("Express server listening on port %d in %s mode", app.address().port, app.settings.env); 
```

和 index.js

```
var $ = require('jquery');

exports.index = function(req, res){
  console.log("rendering index.html")
  res.render('layout', { title: 'Express' })
};

var link = "http://en.wikipedia.org/w/api.php?action=parse&format=json&callback=?"

exports.getData = $.ajax({
                      url: link,
                      dataType: JSON,
                      data: data,
                      success: function(data) {
                        console.log(data);
                        console.log(data.parse.text['*']);
                      }
}); 
```

这是我启动应用程序时遇到的错误

```
 Nic-Meirings-MacBook-Pro:Wiki2 nicmeiring$ node app

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
ReferenceError: $ is not defined
    at Object.<anonymous> (/Users/nicmeiring/Sites/Wiki2/routes/index.js:16:19)
    at Module._compile (module.js:441:26)
    at Object..js (module.js:459:10)
    at Module.load (module.js:348:31)
    at Function._load (module.js:308:12)
    at Module.require (module.js:354:17)
    at require (module.js:370:17)
    at Object.<anonymous> (/Users/nicmeiring/Sites/Wiki2/app.js:7:14)
    at Module._compile (module.js:441:26)
    at Object..js (module.js:459:10) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:02:57.993

您似乎缺少开发人员工具附带的“make”。这是相关的SO问题：

[https://stackoverflow.com/a/1470005/337504](https://stackoverflow.com/a/1470005/337504)

# jquery - jQuery - 警报框只显示一次？

> ID：10097311
> 
> 赞同：0
> 
> 时间：2012-04-10T22:21:37.737
> 
> 标签：jquery, javascript-events

我有一个警报框，当用户将鼠标悬停在某个区域时会触发该框。这是代码：

```
 $("#contentfooter:contains(This website)").mouseover(function(){
     $(".navTopItemGroup_6").slideDown("slow");
      alert("You've Unlocked A Hidden Area");
      }); 
```

如何防止此警报框多次激活？即，当他们将鼠标悬停在该区域一次时，如果他们将鼠标悬停两次，我不希望弹出警报框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:23:37.623

使用`one()` [http://api.jquery.com/one/](http://api.jquery.com/one/)。

```
$element.one('mouseover', function(){ ... }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:23:43.893

如果您不再隐藏内容， .one() 方法将起作用。但是如果你这样做了，那么只需将你的 mouseover 事件更改为 mouseenter。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T22:29:03.540

这是一个示例[演示](http://jsfiddle.net/rt7Ns/)

[one()](http://api.jquery.com/one/)绑定一个事件处理程序，并在第一次执行时取消绑定它。

# windows - Windows 7\. Git 公钥配置

> ID：10097318
> 
> 赞同：3
> 
> 时间：2012-04-10T22:23:02.873
> 
> 标签：windows, git, windows-7, github, ssh-keys

我已按照此处的说明进行操作：[http](http://help.github.com/win-set-up-git/) : //help.github.com/win-set-up-git/ 在我的 Windows 7 机器上设置 git。

我可以使用“git bash”并运行命令。系统提示我输入密钥的密码并且可以成功连接。例如：

```
$git push -u origin master
Enter passphrase for key '/c/Users/mbj/.ssh/id_rsa':
Everything up-to-date 
```

还有这个：

```
$ ssh -T git@github.com
Enter passphrase for key '/c/Users/mbj/.ssh/id_rsa':
Hi markbrenigjones! You've successfully authenticated, but GitHub does not provi
de shell access.

$ which ssh
/bin/ssh 
```

但是，当我打开常规的 Windows 命令提示符并运行相同的命令时，我得到了这个：

```
C:\util\meta_vimrc>git push
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

还有这个：

```
C:\util\meta_vimrc>ssh -T git@github.com
Permission denied (publickey).

C:\util\meta_vimrc>which ssh
C:\Program Files (x86)\Git\bin\ssh.exe 
```

我如何从非“git bash”提示中得到这个工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T22:34:39.143

`HOME`当从 Windows`cmd.exe`解释器运行时，程序可能不知道您的目录在哪里。为此，必须找到带有您的密钥的 ssh 配置目录，即`/c/Users/mbj/.ssh`.

通过运行进行设置：

```
set HOME=C:\Users\mbj\ 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-10T22:25:23.200

对我有用的是运行 PuTTY 的 Pageant.exe 并将您的私钥添加到其中。然后 plink.exe 无论如何都知道在哪里找到密钥。

# c# - 根据另一个列表获取列表

> ID：10097319
> 
> 赞同：0
> 
> 时间：2012-04-10T22:23:04.960
> 
> 标签：c#

我之前问过这个问题，但我过度简化了它，我仍然不知道如何以比我正在做的更好的方式来做（for）。

我有两个清单。

一，facebook 好友列表，一个简单的对象，考虑 facebook.id 唯一的属性。

其次，一个用户列表，它是一个更复杂的对象，因为每个用户在里面（facebook、twitter等）都会得到一个provider列表，但是providers list可以为null，如果不为null，provider不一定是facebook一。所以：

```
public class EFacebook
{
    public long Id { get; set; }
}

public class EUser
{
    public long Id { get; set; }
    /// <summary>
    /// Nullable
    /// </summary>
    public List<EProvider> EProviders { get; set; }
}

public class EProvider
{
    public enum EnumProviderType
    {
        Facebook = 2,
        Twitter = 3
    }
    public EnumProviderType ProviderType { get; set; }
    public string Id { get; set; }
} 
```

我需要的是过滤 facebook 列表以获取所有作为用户的 facebook 朋友并获取所有不是用户的 facebook 朋友。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:08:14.167

假设：

```
List<EFacebook> listEFacebookFriends = new List<EFacebook>();
List<EUser> listEUsers = new List<EUser>(); 
```

然后，您可以在此处获取所有 Facebook 好友的列表：

```
var listEUsersOnFacebook = from user in listEUsers
    let fbProviders =
    from provider in user.EProviders
    where provider.ProviderType == EProvider.EnumProviderType.Facebook
    select provider.Id
    where fbProviders.Count() > 0
    select user.Id;

// this next call will get facebook friends that are users
var friendsOnFacebook = listEFacebookFriends.Where(x => 
                                listEUsersOnFacebook.Contains(x.Id)); 
```

在这里，您可以获得不是用户的 Facebook 朋友：

```
var listEUsersNotOnFacebook = from user in listEUsers
    let fbProviders =
    from provider in user.EProviders
    where provider.ProviderType == EProvider.EnumProviderType.Facebook
    select provider.Id
    where fbProviders.Count() == 0
    select user.Id;

// this call will get facebook friends that are not users 
var friendsNotOnFacebook = listEFacebookFriends.Where(x => 
                            listEUsersNotOnFacebook.Contains(x.Id)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:31:01.037

假设这`List<EFacebook> fbList`是第一个列表并且`List<EUser> usersList`是第二个列表。你可以这样做：

`fbList.Where(x=>usersList.Select(x=>x.Id).Contains(x.Id))`==> 这将返回作为用户的 facebook 实体列表。第二个列表是这个 fbList 和这个之间的区别。

让我知道我是否正确理解了这个问题！

塔玛什

# java - 如何避免大型数组的初始化

> ID：10097320
> 
> 赞同：10
> 
> 时间：2012-04-10T22:23:15.913
> 
> 标签：java, arrays

我分配了大量的双打作为

```
double[] x = new double[ n ]; 
```

其中 n 很大，我想避免初始化以节省时间。可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-10T22:27:46.270

简短的回答：不。数组在创建时总是被清零。

如果您的分析表明这是一个主要瓶颈，您可以考虑保留一个数组实例池，每个集合的长度比`n`以往任何时候都大。问题是您可能需要一个包装器对象来包含数据数组和使用的实际长度，因为您不能再使用`data.length`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-10T22:34:38.483

您可以使用一个`ArrayList`或其他东西，并根据需要向其中添加元素来构建您的数组吗？如果这是您的问题，这将节省初始化时间。

```
ArrayList<double> x = new ArrayList<double>(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-01-02T23:04:52.723

如果您不想初始化太长的数组，您可以确定数组大小的限制，这不会让您等待太多。我建议将一个长数组拆分成更小的数组。定义一个保存数组的列表。如果您的数组已满，请将其添加到您的列表中。然后继续填写一个新的。

```
import java.util.ArrayList;
import java.util.List;

public class Tester {
    private static final int LIMIT = 30;
    private static int index = 0;

    private static int[][] lookup;
    private static List<int[][]> list = new ArrayList<int[][]>();

    public static void main(String[] args) {
        lookup = new int[LIMIT][1];

        for (int i = 0; i <= 93; i++) {
            addToArr(i);
        }

        list.add(lookup);

        for (int[][] intArr : list) {
            for (int i = 0; i < intArr.length; i++) {
                System.out.print(intArr[i][0] + ",");
            }
        }
    }

    public static void addToArr(int value) {
        if (index == LIMIT) {
            list.add(lookup);
            lookup = new int[LIMIT][1];
            index = 0;
        }
        lookup [index++][0] = value;
    }
} 
```

印刷：

> 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24, 25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49, 50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74, 75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-01-07T02:01:56.437

****警告******不安全的替代品****

这不是一个精确的解决方案，但它可能是一个可行的替代方案。这种方法有一些风险。但如果真的绝对必要，你可能会走这条路。此方法使用未记录的`sun.misc.Unsafe`类来分配**堆外**内存来存储双精度值。堆外意味着它不是垃圾收集的，因此您需要注意释放关联的内存。

以下代码基于[有关 sun.misc.Unsafe 的这篇博客文章](http://mishadoff.com/blog/java-magic-part-4-sun-dot-misc-dot-unsafe/#big-arrays)。

```
import java.lang.reflect.Field;

import sun.misc.Unsafe;

@SuppressWarnings("restriction")
public class SuperDoubleArray {

    private final static Unsafe unsafe = getUnsafe();
    private final static int INDEX_SCALE = 8;

    private long size;
    private long address;

    public SuperDoubleArray(long size) {
        this.size = size;
        address = unsafe.allocateMemory(size * INDEX_SCALE);
    }

    private static Unsafe getUnsafe() {
        try {
            Field singleoneInstanceField = Unsafe.class.getDeclaredField("theUnsafe");
            singleoneInstanceField.setAccessible(true);
            return (Unsafe) singleoneInstanceField.get(null);
        } catch (IllegalArgumentException | SecurityException 
                | NoSuchFieldException | IllegalAccessException e) {
            throw new RuntimeException(e);
        }
    }

    public void set(long i, double value) {
        unsafe.putDouble(address + i * INDEX_SCALE, value);
    }

    public double get(long idx) {
        return unsafe.getDouble(address + idx * INDEX_SCALE);
    }

    public long size() {
        return size;
    }

    public void deallocate() {
        unsafe.freeMemory(address);
    }

} 
```

以下代码将打印一些来自未初始化内存的随机双精度值。

```
SuperDoubleArray sda = new SuperDoubleArray(100);
for (int i=0; i<sda.size(); i++) {
    System.out.println(sda.get(i));
}
sda.deallocate(); 
```

没有安全/范围检查，什么都没有，您可以轻松地使用它使 JVM 崩溃，可能无法与非 SUN JRE 一起使用，甚至可能在未来的 SUN JRE 版本中停止工作，但在某些情况下它可能是唯一的解决方案. 与 Java 数组不同，它还可以分配 >`Integer.MAX_VALUE`大小的伪数组。

`java.nio.ByteBuffer.allocateDirect(...)`实际上在幕后使用相同的 Unsafe 类来分配字节缓冲区，您可以使用`ByteBuffer.allocateDirect(8*size).asDoubleBuffer()`它来适应 a `DoubleBuffer`，但`ByteBuffer.allocateDirect(...)`仍在用零初始化缓冲区，因此它可能会产生性能开销。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-02T23:01:56.133

就像其他人已经提到的那样，简单的答案是：不，您无法避免初始化部分。除非您正在使用某些`native`分配或使用[IntBuffer](https://docs.oracle.com/javase/1.5.0/docs/api/java/nio/IntBuffer.html)创建为字节缓冲区的视图，[否则](https://docs.oracle.com/javase/1.5.0/docs/api/java/nio/ByteBuffer.html)当且仅当字节缓冲区本身是直接的时，它才会是直接的。

如果您不使用它们中的任何一个，那么为了尽快分配和初始化数组，您需要最小化`GC`调用，并且您必须确保 JVM 具有存储和使用该数组所需的内存。

在 Albert Hendriks 的情况下：`static int[][] lookup = new int[113088217][2]`如果没有至少 2.3G（12+113088217*(12+2*4) 字节）的内存，JVM 将无法分配所需的空间。请注意，我没有添加所需的填充空间（内存对齐）。

回答为什么`lookup = new int[2*113088217];`执行得更快。这是因为处理的内存要少得多，因为我们没有子数组（标题 + 元素 + 每个子数组的对齐方式），只需要 (2*113088217*4+12) bytes=~804M。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-10T22:40:11.867

一旦你声明了“new double[n]”语句，数组就会初始化。没有办法解决它。

如果您这样做是为了优化，那么我会雇用您阅读有关过早优化的信息。如果您的程序没有碰壁，那么它不值得优化。而且它也绝对不是您应该优化的阵列。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-02T20:53:39.847

如果您绝对需要像这样处理双数组，则可以使用 ArrayList 来节省初始化时间，然后将其转换为数组：

```
List<Double> withoutInitializing = new ArrayList<Double>();
Double[] nowYouConvert = (Double[]) withoutInitializing.toArray(); 
```

来自 Java 文档：

> toArray：以正确的顺序（从第一个元素到最后一个元素）返回一个包含此列表中所有元素的数组。
> 
> 返回的数组将是“安全的”，因为此列表不维护对它的引用。（换句话说，即使此列表由数组支持，此方法也必须分配一个新数组）。因此，调用者可以自由修改返回的数组。
> 
> 此方法充当基于数组和基于集合的 API 之间的桥梁。
> 
> 指定者：集合中的 toArray()

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-07T02:35:42.840

据我了解，真正的问题是分配一个巨大的*二维*数组，如评论中所述

“static int[][] lookup = new int[113088217][2]; 不起作用，而 private final static int[][] lookup = new int[11308821][2]; （少 10 倍）进入更少超过一秒”

假设这是正确的，是的，对于巨大的数字，它是骨慢。您**没有**分配 113088217 * 2 *ints*的单个块！您正在分配 113088217 个单独的*数组*，它们是*Objects*，每个数组都必须在堆上分配：这意味着超过 1 亿次 JVM 正在寻找空间，将其标记为已使用，可能在内存紧张时运行 GC，等等。 .. 每个数组都占用大量（在这些巨大的数字中）额外的内存，而且每个数组都包含 2 个整数。

对于这个巨大的案例：

1）切换索引，然后去

`static int[][] lookup = new int[2][113088217]`

这不是分配 1.13 亿个数组，而是分配**两个**. 在数组中进行查找时，切换两个索引。

2）制作一维数组并自己进行查找

`static int[] lookup = new int[2*113088217];`

这需要做简单的数学运算来找到合适的索引。不要直接访问数组，而是编写一个函数来进行数学运算，调用代码应该使用它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-02T22:32:27.537

一些关于如何不初始化数组的解决方法。

制作一个保证大于最大可能条目数的数组，并部分填充它。

例如，您可以决定用户永远不会提供超过 100 个输入值。然后分配一个大小为 100 的数组：

```
final int VALUES_LENGTH = 100;
double[] values = new double[VALUES_LENGTH]; 
```

然后保留一个伴随变量，它告诉数组中实际使用了多少元素。

```
int valuesSize = 0; 
```

现在 values.length 是数组值的容量，是数组`valuesSize`的当前大小。不断向数组中添加元素，`valuesSize`每次递增变量。

```
values[valuesSize] = x;
valuesSize++; 
```

这样，`valuesSize`始终包含正确的元素计数。以下代码段显示了如何将数字读入部分填充的数组。

```
int valuesSize = 0;
Scanner in = new Scanner(System.in);
while (in.hasNextDouble()) {
  if (valuesSize < values.length) {
    values[valuesSize] = in.nextDouble();
    valuesSize++;
  }
} 
```

在此循环结束时，`valuesSize`包含数组中的实际元素数。

例如，以下是如何将任意长的序列号读入数组，而不会耗尽空间：

```
int valuesSize = 0;
while (in.hasNextDouble()) {
   if (valuesSize == values.length) {
      values = Arrays.copyOf(values, 2 * values.length);
   }
   values[valuesSize] = in.nextDouble();
   valuesSize++;
} 
```

# emacs - 在命令行的emacs中指定窗口布局

> ID：10097321
> 
> 赞同：2
> 
> 时间：2012-04-10T22:23:20.060
> 
> 标签：emacs

我希望能够在从命令行启动 Emacs 时指定它的窗口布局。

更具体地说，我调用“emacs file1 file2 file3 file4”，例如，我会看到

```
+---------+                             +--------+
|  file1  |                             |  buff  |
|         |                             |  list  |
+---------+    instead of the default   +--------+  that I see currently
|         |                             |        |
|  file3  |                             |  file4 |
+---------+                             +--------+ 
```

我的 emacs 是 GNU Emacs 24.0.91.1，我不使用 emacsclient。

请注意，我不想使更改永久化。这就是为什么我要求命令行解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T08:52:50.457

将以下内容放入`layout.el`

```
(setq inhibit-startup-screen t)

(defun ordered-window-list-aux (tree)
  (if (windowp tree)
      (list tree)
    (append (ordered-window-list-aux (nth 2 tree))
            (ordered-window-list-aux (nth 3 tree)))))

(defun ordered-window-list ()
  "Lists windows from top to bottom, left to right."
  (ordered-window-list-aux
   (car (window-tree))))

(require 'cl)

(defun fill-windows ()
  "Make window list display recent buffer."
  (mapcar*
   (lambda (win buf)
     (set-window-buffer win buf))
   (nreverse (ordered-window-list))
   (buffer-list)))

(delete-other-windows)

;; your window configuration
(split-window-horizontally)
(split-window-vertically)

;; Make window list display recent buffer
(fill-windows) 
```

然后

```
emacs blah foo bar --load layout.el 
```

您唯一需要做的就是使用以下功能的组合以您想要的方式自定义布局：

```
(split-window-horizontally)
(split-window-vertically)
(other-windows 1) 
```

# string - Ukkonen 后缀树：程序“规范化”不清楚

> ID：10097323
> 
> 赞同：4
> 
> 时间：2012-04-10T22:23:30.720
> 
> 标签：string, algorithm, suffix-tree

'canonize' 函数（下面给出，来自 Ukkonen 的论文）是如何工作的，特别是 while 循环何时完成？我认为 p' - k' 的值将始终小于 p - k 的值。我是对还是错？

```
procedure canonize(s, (k, p)):
1\. if p < k then return (s, k)
2\. else
3\. find the tk–transition g'(s, (k', p')) = s' from s;
4\. while p' − k' <= p − k do
5\.     k  = k + p' − k' + 1;
6\.     s  = s';
7\.     if k <= p then find the tk–transition g'(s, (k', p')) = s' from s;
8\. return (s, k). 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T02:00:51.667

该`canonize`函数的作用是在[这篇 SA 帖子](https://stackoverflow.com/questions/9452701/can-someone-please-explain-ukkonens-suffix-tree-algorithm-in-plain-english/9513423#9513423)的最后描述的，我们在其中考虑如下情况：

![在此处输入图像描述](../Images/459a699a4ff58f6769da15dcc424bfa8.png)

**情况是这样的：**

1.  活动点在 处`(red,'d',3)`，即三个字符进入`defg`从红色节点出来的边缘。

2.  现在我们跟随一个后缀链接到绿色节点。理论上，我们的活动节点现在是`(green,'d',3)`。

3.  不幸的是，该点不存在，因为`de`从绿色节点出来的边只有 2 个字符。**因此，我们应用`canonize`函数**。

**它是这样工作的：**

1.  我们感兴趣的边的起始字符是`d`。这个字符在 Ukkonen 的符号中被称为 t [k 。]因此，“找到 t [k] -edge”意味着`de`在绿色节点处找到边。

2.  该边只有两个字符长。即`(p' - k') == 2`在 Ukkonen 的符号中。但原来的边缘有三个字符：`(p - k) == 3`. 也是如此`<=`，我们进入循环。

3.  我们将我们正在寻找的边缘从 缩短`def`到`f`。这就是该`p := p + (k' - p') + 1`步骤的作用。

4.  我们前进到`de`边缘指向的状态，即蓝色状态。就是`s := s'`这样。

5.  由于边的剩余部分`f`不是空的（`k <= p`），我们识别相关的出边（即`fg`从蓝色节点出来的边）。这一步将 k' 和 p' 设置为全新的值，因为它们现在引用字符串`fg`，并且它的长度 (p' - k') 现在将为 2。

6.  剩余边的长度`f`(p - k) 现在为 1，`fg`新活动点的候选边的长度 (p' - k') 为 2。因此循环条件

    而 (p' - k') <= (p - k) 做

不再正确，因此循环结束，并且确实新的（和正确的）活动点是`(blue,'f',1)`.

*[实际上，在 Ukkonen 的符号中，一条边的结束指针 p 指向的是边的最后一个字符的位置，而不是它后面的位置。因此，严格来说，(p - k) 是 0，而不是 1，(p' - k') 是 1，而不是 2。但重要的不是长度的绝对值，而是两个不同的相对比较长度。]*

**最后的几点说明：**

*   像 p 和 k 这样的指针指的是原始输入文本 t 中的位置。这可能会让人很困惑。例如，在`de`绿色节点的边中使用的指针将指向t 的*某个*子串，而在蓝色节点`de`的边中使用的指针将指向 t 的*某个*子串。尽管字符串必须在 t 的某处出现为一个连续的字符串，但子串也可能出现在其他地方。所以，边的指针 k不一定**是**边的结束指针 p**加一**。`fg`*`fg``defg``fg``fg`**`de`***

******   因此，当我们决定是否结束循环时，重要的不是绝对位置 k 或 p，而是剩余边的长度 (p - k) 与当前候选边的长度 (p' - k') 相比.

    *   在您的问题中，代码片段的第 4 行有一个错字：它应该是`k'`而不是`k;`.***** 

 ****** * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-17T13:04:17.383

我不得不更改 canonize 函数，因为它没有正确处理辅助状态。我在“p < k”之后添加了以下代码，如果：

```
if (s == auxiliary)
{
    s = root;
    k++;
    if (p < k)
        return;
} 
```

它现在*似乎*工作了:)*****

# css - IE8 表格行渐变过滤器不显示在表格单元格中

> ID：10097328
> 
> 赞同：0
> 
> 时间：2012-04-10T22:23:51.170
> 
> 标签：css, internet-explorer-8, filter, border, gradient

简短版本：我为`<tr>`标签设置了渐变过滤器，但在 IE8 中，子标签`<td>`和`<th>`标签完全忽略它，无论它们的背景属性是什么。

这是我正在查看的示例：http: [//jsfiddle.net/FlashbackJon/NqkGv/3/](http://jsfiddle.net/FlashbackJon/NqkGv/3/)

通常，我只会将其应用于表格单元格标签，但正如我现在所知道的（来自[无数](https://stackoverflow.com/questions/5995189/extremely-weird-ie7-8-border-opacity-compatibility-issue) [主题](https://stackoverflow.com/questions/3465346/table-cell-loses-border-when-css-gradient-filter-is-applied-in-ie8)），过滤器呈现在元素背景内容之上，包括边框，我需要表格边框到位并且崩溃了。我使用的是 HTML5 文档类型，公司标准是 IE8，适用于我们的大部分最终用户。

我试图让它没有图像，并且非常希望避免不必要的 HTML。如果根本无法使行渐变可见，那么我可能不得不求助于它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-15T20:09:42.413

来源：http: [//msdn.microsoft.com/en-us/library/ms532847.aspx](http://msdn.microsoft.com/en-us/library/ms532847.aspx)

> 不能应用过滤器和转换的特定元素包括：
> 
> *   嵌入和小程序元素
> *   选择和选项表单元素
> *   **tr** 、 tHead 、tBody 和 tFoot 表格元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:43:53.180

没有办法使行渐变可见，它只是不适用于 tr 标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T00:44:30.310

渐变对您的布局是否超级重要？我建议为 IE8 完全放弃它 - 很有可能体验不会被破坏，只是不同。

IE 中的过滤器具有很高的性能成本 - 所以当你真正需要它时应该使用它们。我认为表格行的背景颜色可能不是其中之一。您的网站会运行得更快，您的用户也会很高兴。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T01:03:17.927

如果是水平渐变，您可以将其应用于 TD 而不是 TR。它会起作用，并且看起来一样。TR 不被视为旧 IE 中的“真实”元素，它们就像 TD 的抽象容器。不过，TD的风格很好。

# math - 为什么使用 windows 计算器时 sqrt(4) - 2 等于 -8.1648465955514287168521180122928e-39？

> ID：10097337
> 
> 赞同：0
> 
> 时间：2012-04-10T22:24:46.717
> 
> 标签：math, floating-point, calculator

> **可能重复：**
> [浮点数是如何存储的？什么时候重要？](https://stackoverflow.com/questions/56947/how-is-floating-point-stored-when-does-it-matter)

使用我的 Win7 x64 上的内置计算器，我在计算`-8.1648465955514287168521180122928e-39`时得到了数字`sqrt(4)-2`。

我希望结果为 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:27:47.683

当您偶尔减去它们时，浮点值会出现一些错误。您可能会得到 0 或非常接近 0 的表示（10^-39 非常接近）。

有关更多信息，请查看Wikipedia 上[的二进制分数。](http://en.wikipedia.org/wiki/Binary_numeral_system#Fractions_in_binary)

# jquery - jQuery循环插件如何添加一个活动类

> ID：10097340
> 
> 赞同：2
> 
> 时间：2012-04-10T22:24:54.420
> 
> 标签：jquery, jquery-plugins

示例：http: [//jsfiddle.net/kuTLf/](http://jsfiddle.net/kuTLf/)

代码如下所示：

```
<div id="main">
        <div id="slideshow" class="pics">
            <div id="nav"></div>
            <img src="http://cloud.github.com/downloads/malsup/cycle/beach1.jpg" width="200" height="200" />
            <img src="http://cloud.github.com/downloads/malsup/cycle/beach2.jpg" width="200" height="200" />
            <img src="http://cloud.github.com/downloads/malsup/cycle/beach3.jpg" width="200" height="200" />
        </div>
</div> 
```

js：

```
$(function() {
    $('#slideshow').cycle({
        fx:     'turnDown',
        speed:  'fast',
        timeout: 3000,
        pager:  '#nav',
        slideExpr: 'img'
    });
}); 
```

如何将当前活动类添加到当前 img？喜欢`<img class='active`>

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T22:39:08.943

```
$('#slideshow').cycle({
    after: function(el, next_el) {
        $(next_el).addClass('active');
    },
    before: function(el) {
        $(el).removeClass('active');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:38:54.793

这是一个快速[演示](http://jsfiddle.net/KqN9K/1/)，可以了解哪个是活动的。

```
function onAfter1(curr,next,opts) {
   currentSlide = $(".thePager a.activeSlide").html();
    if(!currentSlide) currentSlide = "1";
    $('.slideCaption').html(currentSlide + '/' + opts.slideCount);
} 
```

# wpf - WPF 按钮样式不显示文本

> ID：10097341
> 
> 赞同：0
> 
> 时间：2012-04-10T22:24:55.073
> 
> 标签：wpf, button, styles, controltemplate

我是新手，所以请多多包涵。

我现在有这个`Style`。将其粘贴到窗口中以查看它的运行情况。

```
<Window.Resources>

<Style x:Key="SelectionButton3"
        TargetType="{x:Type Button}">

    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">

                <Grid HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        ClipToBounds="False">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="75" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="100" />
                        <ColumnDefinition Width="55" />
                    </Grid.ColumnDefinitions>

                    <Border x:Name="TheBorder"
                            BorderThickness="0,1.5,1.5,1.5"
                            CornerRadius="3"
                            Background="SteelBlue"
                            Height="35"
                            Grid.Column="1"
                            Grid.Row="0"
                            Margin="-31"
                            BorderBrush="DarkSlateBlue"/>

                    <Rectangle Name="TheRectangle"
                                Fill="SteelBlue"
                                Stroke="DarkSlateBlue"
                                Grid.Row="0"
                                Grid.Column="0">

                        <Rectangle.LayoutTransform>
                            <RotateTransform Angle="-45" />
                        </Rectangle.LayoutTransform>

                        <Rectangle.BitmapEffect>
                            <DropShadowBitmapEffect ShadowDepth="5" />
                        </Rectangle.BitmapEffect>

                    </Rectangle>

                    <ContentPresenter x:Name="ContentArea"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Content="{Binding Path=Content, RelativeSource={RelativeSource TemplatedParent}}" />
                </Grid>

                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver"
                                Value="True">
                        <Setter TargetName="TheBorder"
                                Property="BitmapEffect">
                            <Setter.Value>
                                <DropShadowBitmapEffect ShadowDepth="0" />
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>

    </Setter>

    <Setter Property="Foreground"
            Value="White"/>
    <Setter Property="FontFamily"
            Value="Segoe UI" />
    <Setter Property="FontSize"
            Value="20" />

    </Style> 
```

```
<Grid.RowDefinitions>
    <RowDefinition Height="20"/>
    <RowDefinition Height="Auto"/>
    <RowDefinition Height="Auto" />
    <RowDefinition Height="Auto" />
    <RowDefinition Height="Auto" />
</Grid.RowDefinitions>
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="20"/>
    <ColumnDefinition Width="250" />
</Grid.ColumnDefinitions>

<Button Grid.Row="1"
        Grid.Column="1"
        Style="{StaticResource SelectionButton3}"
        Margin="0,0,0,5"
        Click="Button_Click">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <Image Height="35"
               Width="35"
               Stretch="Fill"
               HorizontalAlignment="Center"
               VerticalAlignment="Center"
               Grid.Column="0"
               Margin="32.5,0,0,0"
               Source="/app;component/Media/Images/Mail/email.png" />

        <TextBlock Text="Email"
                   Grid.Column="1"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Margin="22,0,0,0"/>

    </Grid>

</Button> 
```

我有两个问题：

1) 为什么只显示部分文字？

2）如何将`Image`and`TextBlock`放入`Template`并绑定到它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:01:05.980

您的 Text 被剪裁的原因是您没有为`ContentPresenter`. 这会导致您的按钮内容默认为您的第 0 行和第 0 列`ControlTemplate`，这与您的边距和位置相结合会导致您的按钮元素上的文本块被切断。我猜这可能是你的意图？

```
<ContentPresenter x:Name="ContentArea"
   Grid.Column="0"
   Grid.ColumnSpan="2"
   Grid.Row="0"
   VerticalAlignment="Stretch"
   HorizontalAlignment="Stretch"
   Content="{Binding Path=Content, 
             RelativeSource={RelativeSourceTemplatedParent}}" /> 
```

现在`ContentPresenter`将跨越`ControlTemplate`Grid 上的两列，因此您的 Textblock 将有更多空间来显示自己。

回答你的第二个问题`How do I put the Image and Textblock in the template and just bind to them?`

一种方法是对类进行子`Button`类化，例如调用它，并在这个新类中实现两个名为and的`MyImageButton`新依赖属性。然后您可以将您的和移动到您的控制模板并将它们绑定到您的新属性和属性。然后，您可以实例化并使用新的属性来设置按钮的图像和文本。`Image``Text``<Image>``<TextBlock>``Image``Text``MyImageButton`

# jquery-ui - jQuery UI 滑块没有出现

> ID：10097343
> 
> 赞同：11
> 
> 时间：2012-04-10T22:25:13.883
> 
> 标签：jquery-ui, jquery-ui-slider

我认为滑块的基本语法是：

```
<div id="slider"></div>

$("#slider").slider() 
```

但这不会产生可见的滑块。检查`div`元素，我看到应用了一些样式，但滑块不可见。

这是一个小提琴：http: [//jsfiddle.net/yqNcn/](http://jsfiddle.net/yqNcn/)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-10T22:35:12.357

您没有包括 jQuery UI 的 CSS，因此应用了类但没有应用*样式*（实际上没有应用）。[这是](http://jsfiddle.net/yqNcn/3/)一个包含样式的已编辑小提琴（查看资源面板）；滑块应该是可见的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T17:34:32.327

首先导入您的 javascript Files* [jquery.s](http://code.jquery.com/jquery-1.9.1.js)并导入 Jquery UI 小部件[Jquery-ui.js](http://code.jquery.com/ui/1.10.4/jquery-ui.js) 然后将您的 Css **Div**标签与**id** `<div id="slider"></div>` this Example

```
<div id="slider"></div> 
```

然后调用 Jquery 滑块函数....

```
<script>
$(function() {
$( "#slider" ).slider();
});
</script> 
```

# php - 正则表达式在测试文件中工作，而不是在程序中（HTTP 原始响应）

> ID：10097346
> 
> 赞同：3
> 
> 时间：2012-04-10T22:25:43.717
> 
> 标签：php, regex

我正在尝试调试正则表达式，对于我的一生，我无法弄清楚为什么它在测试文件中有效，但在其他地方却无效。

我收到了一个原始的 HTTP 响应，并解析了感兴趣的部分：

```
UID:5F12F7DA-10B0-4EE3-820D-B56F0B2FC153
DTSTAMP:20120408T041113Z
CLASS:PUBLIC
CREATED:20120408T041113Z
DESCRIPTION:Testfghfghfghfghfghfghfghfghfghfghfghfghfghfghfgh
DTSTART;TZID=America/New_York:20120410T000000
DTEND;TZID=America/New_York:20120419T010000
LAST-MODIFIED:20120408T041228Z
LOCATION:Philadelphia\, PA
SEQUENCE:1
SUMMARY:Test
TRANSP:OPAQUE 
```

每行以 (hex:0D0A) 结尾，应该是 '\r\n'。

这是摘要的呼吁：

$this->Summary = \Extract\Extract::GetSummary($vevent);

这是功能：

```
public static function GetSummary($String) {
            $re1='.*?'; # Non-greedy match on filler
            $re2='(SUMMARY)';   # Word 1
            $re3='(:)'; # Any Single Character 1
            $re4='(.*?)';   # Non-greedy match on filler
            $re5='(\r\n)';  # Any Single Character 2

            if ($c=preg_match_all ("/".$re1.$re2.$re3.$re4.$re5."/is", $String, $matches))
            {

                $word1=$matches[1][0];
                $c1=$matches[2][0];
                $word2=$matches[3][0];
                return $word2;
            }

        } 
```

Preg_match_all 在我的测试文件中评估为 true，但在我的程序中评估为 false。有任何想法吗？关于它不喜欢的原始字符串，或者没有被复制到我的测试文件中（所以我找不到它）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T22:35:27.007

尝试仅使用换行符作为最终匹配：

```
function GetSummary($String) {
  $re1='.*?';       // Non-greedy match on filler
  $re2='(SUMMARY)'; // Token
  $re3='(:)';       // Separator
  $re4='(.*?)';     // Content
  $re5='\n';        // End of line

  if ($c=preg_match_all ("/".$re1.$re2.$re3.$re4.$re5."/is", $String, $matches))
  {
    $word1=$matches[1][0];
    $c1=$matches[2][0];
    $word2=$matches[3][0];
    return $word2;
  }
} 
```

演示：http: [//ideone.com/zHr2X](http://ideone.com/zHr2X)

如果这仍然不起作用，您可以尝试使用 end-of-line token `$`，或在调用正则表达式之前清理行尾。

# javascript - 为什么 Disqus 的评论代码不使用全球 CDN？

> ID：10097347
> 
> 赞同：3
> 
> 时间：2012-04-10T22:25:49.890
> 
> 标签：javascript, cdn, disqus

根据 Disqus[注释代码说明](http://docs.disqus.com/developers/universal/#comment-count)，您应该按如下方式包含他们的 JavaScript：

```
(function () {
  var s = document.createElement('script');
  s.async = true;
  s.type = 'text/javascript';
  s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}()); 
```

JavaScript 的位置基于特定于您网站的短名称。为什么 Disqus 这样做，而不是为他们的 JavaScript 使用一个全球位置（例如 cdn.disqus.com/count.js）。如果每个站点的 JavaScript 都相同，那么要求每个人都为他们访问的每个启用 Disqus 的域重新下载 JavaScript 似乎很愚蠢。如果 JavaScript 基于短名称不同，为什么不使用在加载全局 js 之前设置的短名称变量？

Disqus 是一家相当大且成熟的公司，所以我假设这是他们有意识和有目的的决定。他们为什么走这条路？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T00:17:51.250

实际上，他们正在使用 CDN 来交付`count.js`.

如果`<shortname>`存在

`http://<shortname>.disqus.com/count.js`重定向到类似的东西

`http://mediacdn.disqus.com/1334018047/build/system/count.js`.

为了减少流量`count.js`（在 CDN 上），使用 Expires-Header 交付，允许缓存长达一个月。

但是假设他们需要更改代码或阻止某些站点或向其他站点提供特殊功能，则可能需要长达一个月的时间才能让所有客户获得更改。为了减少时间跨度，他们可能会使用此重定向（最多仅缓存 10 分钟），因此代码/功能更改将在 10 分钟内到达每个客户端。

它为他们提供了很大的灵活性，并且不需要用户更改包含代码。

# ipad - iPad 的 Web 开发：如何使 safari 视图不可拖动

> ID：10097349
> 
> 赞同：0
> 
> 时间：2012-04-10T22:26:02.433
> 
> 标签：ipad, safari, web, drag

我正在制作一个适合 iPad 屏幕的网络项目。我试图让它看起来尽可能像一个原生应用程序。它在 safari 或 atomic 浏览器中加载。我试图找出的是，是否有可能消除其中一个浏览器仅针对该站点的拖动甚至缩放功能。

换句话说，我想让我的网站始终固定在屏幕上。问题是，用户会尝试点击一个按钮，它会拖动屏幕。

PS。另一个问题是我如何才能做到这一点，如果按住图像不具有“另存为”功能，我尝试在图像上放置一个跨度，这适用于 firefox，但不适用于 iPad safari。

如果您能解决任何或所有这些问题，我将非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:00:44.243

事实证明，您可以将几个元标记放入您的 js 文件中，以保持屏幕固定。好东西在这里：http: [//jakeboyles.com/2011/01/16/how-to-build-an-iphone-and-ipad-web-app/](http://jakeboyles.com/2011/01/16/how-to-build-an-iphone-and-ipad-web-app/)

至于“另存为”问题，我还不知道，我的应用程序开发的那部分还没有解决。

# java - java单写多读

> ID：10097350
> 
> 赞同：2
> 
> 时间：2012-04-10T22:26:03.463
> 
> 标签：java, concurrency

抱歉，如果之前有人问过这个问题，但我找不到我的确切情况。

目前我有一个后台线程，它向列表中添加一个元素并每隔几分钟删除一次旧数据。理论上，列表中一次最多可以有 2 个项目，并且这些项目是不可变的。我还有多个线程可以在需要时抓取列表中的第一个元素。在这种情况下，是否需要对列表进行显式序列化操作？我的假设是，由于我只是在获取对元素的引用，因此如果后台线程从列表中删除元素，那无关紧要，因为线程在删除之前已经获取了引用的副本。可能有更好的方法来做到这一点。先谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:36:04.433

是的，这里仍然需要同步，因为添加和删除不是原子操作。如果一个线程`add(0, new Object())`同时调用另一个调用`remove(0)`，则结果未定义；例如，`remove()`可能最终没有效果。

根据您的使用情况，您可能可以使用非阻塞列表类，例如`ConcurrentLinkedQueue`. 但是，鉴于您每隔几分钟就会推动一次更改，我怀疑您是否通过避免同步而获得了很大的性能。

# html - td 类，很困惑，数字越大宽度越小？

> ID：10097353
> 
> 赞同：5
> 
> 时间：2012-04-10T22:26:22.730
> 
> 标签：html, css, html-table

这不是一个真正的问题，但我想知道发生了什么，所以我可以理解它。我目前正在编写一个新网站，该网站要求我在设计的页脚中使用一个表格。（我不经常使用它们，但这张表只是让这个项目的生活变得更轻松。）

我正在为表 td 使用 CSS 类，其中唯一的元素是 width:%; 但由于某种原因，我无法理解，将 % 从 10% 增加到 20% 实际上会使 td 的宽度变小。完全倒退。

我真的被这个难住了，谁能解释一下？

**HTML：**

```
<div class="footertable">
<table border="2">
<tbody>
<tr>
<td valign="top" class="footer">
<div class="footerheading">SHOPPING</div>
</td>
<td valign="top" class="footer">
<div class="footerheading">CUSTOMER SERVICE</div>
</td>
<td valign="top" class="footer">
<div class="footerheading">PAYMENT OPTIONS</div>
</td>
<td valign="top" class="footer">
<div class="footerheading">SOCIAL</div>
</td>
<td valign="top" class="footer">
<div class="footerheading">ORDER</div>
</td>
</tr>
</tbody>
</table>
</div>​ 
```

**CSS：**

```
.footertable { margin:auto; max-width:1080px;}
td.footer {width:10%;}​ 
```

**笔记：**

*   奇怪的行为发生在低于 24 的百分比：从 15 到 23 总宽度减小，从 23 到 24 它突然扩大。对于高于 24 的百分比，您的行为正常。
*   为表格指定 max-width 还是仅指定宽度都没有关系
*   该问题可在 chrome、firefox、opera 和 IE9 中重现
*   jsFiddle在这里：http: [//jsfiddle.net/BPygA/](http://jsfiddle.net/BPygA/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T00:27:14.703

表格布局有其拥护者和仇恨者，但可以肯定的是，它是一种**高级策略**。这就像力量的组合，一些较弱，一些更强，最终决定了您的列宽。并且有很多输入变量：

*   表格布局：固定与否
*   表格具有特定的宽度（以像素或百分比为单位或根本没有）
*   所有列都有宽度吗？
*   表中是否有 colgroup 元素？
*   桌子有多少可用空间？
*   是否有任何单元格具有不可破坏的内容？

对于没有经验的人来说，这是一场噩梦。

在您的特定情况下，您的表格没有特定的宽度，这意味着它将是列宽度的总和。但是列的大小以百分比为单位，这将是表格总宽度的百分比。你可以看到这是一个先有鸡还是先有蛋的问题。

使用加起来不等于 100% 的百分比也有点不确定。

我会退后一步，想想你想要达到的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:42:31.453

我可以看到表格单元格在 10% 到 20% 宽度之间切换的行为。

向表格本身（而不是包含`DIV`）添加宽度会改变行为：

[http://jsfiddle.net/BPygA/2/](http://jsfiddle.net/BPygA/2/)

如果表格本身没有宽度，浏览器会根据单元格的内容对如何显示单元格做出最佳猜测。我不确定*为什么*当百分比设置为更大的数字时它会选择更小的宽度，但这是一个不确定的计算，因此浏览器可以自由地做它想做的事情（见下面的规范）。

换句话说，如果表格上没有宽度，您就是在告诉浏览器每个单元格是可以自由确定的变量值的 10%。

另一个考虑可能是表格有 5 个单元格。将每个设置为 10% 会导致总宽度仅为 50%。再一次，浏览器必须猜测总宽度，但还必须确定如何处理剩余的 50% 未考虑的部分。

正如@Jacob 指出的那样，W3 定义了建议（但只是建议）来指导用户代理如何呈现表格。

> 该算法反映了编写本规范时几个流行的 HTML 用户代理的行为。在 'table-layout' 为 'auto' 的情况下，UA 不需要实现该算法来确定表格布局；他们可以使用任何其他算法，即使它导致不同的行为。

UA 应该尝试使用请求的百分比，但这可能并不总是可行的。

> 列宽的百分比值是相对于表格宽度的。如果表格具有“宽度：自动”，则百分比表示对列宽度的约束，UA 应尝试满足该约束。（显然，这并不总是可能的：如果列的宽度为“110%”，则无法满足约束。）

[http://w3.org/TR/CSS2/tables.html#propdef-table-layout](http://w3.org/TR/CSS2/tables.html#propdef-table-layout)

我会很好奇更好的解释。

# php - Yii accessRules 表达式不起作用

> ID：10097355
> 
> 赞同：2
> 
> 时间：2012-04-10T22:26:37.067
> 
> 标签：php, yii, rbac

在我的控制器中，我有

```
 /**
 * @return array action filters
 */
public function filters()
{
    return array(
        'accessControl', // perform access control for CRUD operations
    );
}

/**
 * Specifies the access control rules.
 * This method is used by the 'accessControl' filter.
 * @return array access control rules
 */
public function accessRules()
{
    return array(
        array('allow',  // allow all users to perform 'index' and 'view' actions
            'actions'=>array('index','view'),
            'users'=>array('*'),
        ),
        array('allow', // allow players to comment on games
            'actions'=>array('createComment'),
            'roles'=>array('createComment'),
        ),
  array('allow', // allow users to update and delete their own comments
    'actions'=>array('deleteComment'),
    'expression'=>'return $user->id==Game::model()->findByPk(Yii::app()->getRequest()->getQuery("id"))->author->id;',
  ),
        array('allow', // allow admin users to create, update, delete and manage games
            'actions'=>array('admin','create','update','delete','deleteComment'),
    'roles'=>array('admin'),
        ),
        array('deny',  // deny all users
            'users'=>array('*'),
        ),
    );
} 
```

但由于某种原因，deleteComment 上的表达式总是给我一个 403 错误（未经授权）。即使我已经测试了那个表达并且得到了真实。甚至把'表达式'=>'return true;' 不起作用。:( 我完全糊涂了......有什么想法吗？谢谢，布拉德（：

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-10T22:32:21.297

`return`你在你的表达的开头有一个额外的。Yii[已经添加了一个](http://code.google.com/p/yii/source/browse/tags/1.1.10/framework/base/CComponent.php#602)，所以有两个会导致语法错误。删除你的，你会很高兴的。

# ruby-on-rails - 在 Rails 3 中为多个嵌套资源创建表单

> ID：10097356
> 
> 赞同：2
> 
> 时间：2012-04-10T22:26:38.750
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我一直在关注 Ryan Bates 关于嵌套表单[Railscast 196的教程](http://railscasts.com/episodes/196-nested-model-form-part-1?view=asciicast)

新操作的表单显示测验的嵌套属性，但不显示键的嵌套属性。我猜这是因为测验有一个 has_many 关系，其中 key 有一个 has_one 关系......但我无法弄清楚我做错了什么？

任何帮助深表感谢！

这是我的模型：

```
class Repository < ActiveRecord::Base
   has_many :quizzes, :dependent => :destroy
   has_one :key, :dependent => :destroy

   accepts_nested_attributes_for :key, :quizzes
end 
```

这是我的控制器：

```
def new
  @repository = Repository.new
  3.times { @repository.quizzes.build }
  @repository.key = Key.new

  respond_to do |format|
    format.html # new.html.erb
    format.xml  { render :xml => @repository }
  end
end 
```

这是我的看法：

```
<div class="field">
  <%= f.label :wp_uid %><br />
  <%= f.text_field :wp_uid %>
<% f.fields_for :quizzes do |quiz_fields| %>
  <p>
    <%= quiz_fields.label :name, "Name" %><br />
    <%= quiz_fields.text_field :name %>
  </p>
<% end %>
<% f.fields_for :key do |key_fields| %>
  <div class="field">
  <%= key_fields.label :value, "Value" %><br />
  <%= key_fields.text_field :value %>
  </div>
  <div class="field">
  <%= key_fields.label :expiry, "Expiry" %><br />
  <%= key_fields.date_select :expiry %>
  </div>
<% end %>
</div>
<div class="actions">
  <%= f.submit %>
</div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:35:03.410

您应该尝试修改您的 fields_for 块以使用 <%= %>

尝试更改为：

```
<%= f.fields_for :key do |key_fields| %> 
```

railscast 可以在 Rails 3 更改为使用 <%= %> 而不是 <%%> 之前进行。

Ryan 有一个 nested_form gem，您可能会发现它对此也很有用。我还没有尝试使用它，但计划下次我开始一个新项目。

[https://github.com/ryanb/nested_form](https://github.com/ryanb/nested_form)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:50:48.633

尝试将关键对象构建为

@reposit.build_key

来自 Rails 文档 [http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Unsaved+objects+and+associations](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Unsaved+objects+and+associations)

如果您希望将对象分配给 has_one 关联而不保存它，请使用 build_association 方法。被替换的对象仍将被保存以更新其外键。

# ruby-on-rails - rails：在 :where 中使用关联模型的列

> ID：10097358
> 
> 赞同：3
> 
> 时间：2012-04-10T22:26:49.330
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我不确定这里发生了什么。我有一个我正在尝试创建的适用于我的协会的范围：

```
class Subscription < ActiveRecord::Base
  belongs_to :subscriber, :class_name => "User"
  belongs_to :subscribable, :polymorphic => true
end

create_table :products do |t|
   t.string  :name
   t.decimal :price
   t.decimal :cost_per_unit
   t.integer :user_id
end

create_table :subscriptions do |t|
   t.string  :name
   t.decimal :price
   t.decimal :cost_per_unit
   t.integer :subscriber_id
   t.integer :subscribable_id
   t.string  :subscribable_type
end

class Product < ActiveRecord::Base
  has_many :subscriptions, :as => :subscribable, :dependent => :destroy

  def self.lower_prices
      Product.includes(:subscriptions).
      where("products.price < subscriptions.price OR products.cost_per_unit < subscriptions.cost_per_unit" )
  end
end 
```

我正在尝试将产品的较低价格与订阅进行比较，但这给了我错误：

```
ActiveRecord::StatementInvalid in Pages#subscribed_products

PGError: ERROR:  missing FROM-clause entry for table "subscriptions"
LINE 1: ...  WHERE (user_id != 2) AND (products.price < subscripti...
                                                             ^
: SELECT COUNT(*) FROM "products"  WHERE (user_id != 2) AND (products.price < subscriptions.price OR products.cost_per_unit < subscriptions.cost_per_unit) 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T01:46:19.907

该`includes`方法并不完全按照您的想法进行。代替它应该`joins`做`includes`你的意思：

```
Product.joins(:subscriptions).
      where("products.price < subscriptions.price OR products.cost_per_unit < subscriptions.cost_per_unit" ) 
```

也许：

```
Product.includes(:subscriptions).joins(:subscriptions).
      where("products.price < subscriptions.price OR products.cost_per_unit < subscriptions.cost_per_unit" ) 
```

`joins`在生成的 SQL 查询中转换为 a `JOIN`，因此您可以在连接表上执行 WHERE 子句。 `include`只是要求 Active Record 执行另一个查询以选择给定表中的所有相关记录。如果你同时做这两件事，Active Record 会创建一个（相当长的）一体机，它同时连接两个表并使用结果来创建两组对象。

# database - 我可以从 TFS CI Build 更改 VS2010 数据库项目的部署脚本的位置吗

> ID：10097364
> 
> 赞同：1
> 
> 时间：2012-04-10T22:27:29.033
> 
> 标签：database, visual-studio-2010, tfs, continuous-integration, database-project

我无法将 TFS CI 构建的输出定向到默认位置以外的目录位置。我有 2 个数据库项目与我们的大型 .net 项目集成。一切都按照我们在本地 PC 上的预期构建和执行。文件最终位于数据库项目 sql/Debug 或 Release 文件夹下的预期位置。在我们的 TFS 构建服务器上，项目会正确构建和生成所有内容，但会将所有数据库项目输出文件（.SQL、.schema 等）转储到 TFS 输出目录的根目录中。那里变得非常混乱，因为有几个项目似乎导致了这种情况的发生。

目前我只关心数据库项目。有没有办法在项目的部署或构建定义（或我没想到的任何其他地方）中指定这些文件的输出位置？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T17:32:08.643

一个简单的方法是创建一个在编译过程结束时运行的 MSbuild 项目。

创建名为 DropTidy.Proj 的文件，然后添加如下内容。

```
<Project DefaultTargets="CopySQLReleaseFiles" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="3.5">

  <Target Name="CopySQLReleaseFiles">

    <ItemGroup>
      <SqlBuildOutput Include="$(OutDir)\*.sql" />
    </ItemGroup>

    <Copy SourceFiles="@(SqlBuildOutput)" DestinationFolder="$(OutDir)\SQL" />

  </Target>

</Project> 
```

上面的示例将所有扩展名为“sql”的文件复制到名为“SQL”的文件夹中。$(OutDir) 是团队构建使用的工作文件夹，与构建代理的构建工作区中的“二进制”文件夹相关

将文件签入 TFS，然后将其添加到 Team Build Process 中的“要构建的项目”列表中。确保它是列表中的最后一个“解决方案”，以便它在构建中的其他解决方案之后运行。还要确保将 proj 文件签入的文件夹是构建工作区的一部分。

运行您的构建，您应该会在放置位置看到一个名为 SQL 的新文件夹。

# android - 远程登录。Android，挂起发送

> ID：10097373
> 
> 赞同：0
> 
> 时间：2012-04-10T22:28:24.673
> 
> 标签：android, sockets, telnet

我试图通过 telnet 向我的计算机发送命令，然后在使用 telnet 时将命令发送到串行端口

```
adb shell
$telnet 172.20.104.203 5334
$h 
```

它从命令h返回数据，但是当我尝试使用android执行此操作时，它连接到套接字，我可以在计算机上看到它，它发送命令但是一旦它记录它已经发送它就会挂起并提出“应用程序没有响应”，它有等待或强制关闭，如果我等待它就保持不变。

这是我的 telnet 部分代码

```
 private static final int TCP_SERVER_PORT = 5334;

    private void runTcpClient() {
        try {
            Socket s = new Socket("172.20.104.203", TCP_SERVER_PORT);
            BufferedReader in = new BufferedReader(new InputStreamReader(s.getInputStream()));
            BufferedWriter out = new BufferedWriter(new OutputStreamWriter(s.getOutputStream()));
            //send output msg
            String outMsg = "$getPos"; 
            out.write(outMsg);
            out.flush();
            Log.i("TcpClient", "sent: " + outMsg);
            //accept server response
            String inMsg = in.readLine() + System.getProperty("line.separator");
            Log.i("TcpClient", "received: " + inMsg);
            //close connection
            s.close();
        } catch (UnknownHostException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } 
    } 
```

它记录了发送，但它从不记录接收，我认为这可能与接收到的数据量有关，所以我只是发送了

```
$getPos 
```

相反，但它仍然挂起。

有人知道会发生什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T02:33:10.567

我不熟悉平台的细节，但是 readline 不太可能在 socket/tcp 流上工作，或者如果它工作，它会不可靠地工作。来自套接字的数据不一定被组织成“行”，而是特定大小的数据包。在套接字上执行的“读取”将返回一些字节数。

进行此类读取的客户端需要读取每个数据包，缓冲它们，直到它收到商定的“数据结束”标记。商定的标记由协议确定。

您已经向我们展示了代码的客户端。有对应的服务器端吗？

From what you have here, my *guess* is that your client code is waiting patiently for an 'end of line' that for some reason, will never come. OR there's something wrong at the server end and the server isn't sending any data to the client.

# php - 如何将带有撇号的东西传递给json

> ID：10097374
> 
> 赞同：1
> 
> 时间：2012-04-10T22:28:25.227
> 
> 标签：php, json, escaping

我的 facebook 应用程序使用 facebook 的 ui 方法，您将 json 传递给该方法。然而，我的 php 变量可能包含撇号......保存它们的最佳方法是什么，同时将它们正确传递给 fb 方法？

```
 FB.ui(
    {
        method: 'feed',
        name: '<? echo $tname; ?>',
        link: '<? echo $short; ?>',
        caption: '<? echo $description; ?>'
    }, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T22:36:33.327

使用[json_encode](http://php.net/manual/en/function.json-encode.php)

```
$myJSON = array(
    'method'      => 'feed',
    'name'        => $tag_line.' at '.$owner_name,
    'link'        => $short,
    'caption'     => $description,
    'description' => $short
);

$myJSON = json_encode($myJSON); 
```

`$myJSON`现在包含一个带有 JSON 格式数据的字符串，并准备回显到页面。

```
{
    "method"      : "feed",
    "name"        : "tag_line at owner_name",
    "link"        : "short",
    "caption"     : "description",
    "description" : "short"
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T22:30:40.110

您需要“转义”它们，这意味着在它们之前添加一个反斜杠。

PHP 中有一些方便的函数可以帮助您完成此操作：（[`json_encode`](http://php.net/manual/en/function.json-encode.php)专门用于正确格式化 JSON）或[`addslashes`](http://php.net/manual/en/function.addslashes.php).

但是，您应该使用`json_encode`而不是`addslashes`在这种情况下，因为`addslashes` *可能会*根据输入输出不正确的 JSON 格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T20:03:13.033

OP 需要转义撇号 - 这是 json_encode 不做的事情。经常遇到的问题是需要在php中使用json_encode生成一个json字符串并放在javascript代码中（如OP示例）。由于 Javascript 没有 heredoc 注释，因此您需要转义撇号或双引号以防止解析错误。

例如：

```
jQuery.parseJSON('<?=str_replace("'", "\\\\u0027", json_encode(array('something' => "John's")))?>'); 
```

但是，这并不是最佳的，因为它有时会在 js 端保持为 \u0027。所以理想情况下，我们需要再次使用 js 替换我们用来翻译报价的任何代码：

```
var code = '<?=parse(json_encode($data)) ?>';
code = code.replace(/\\\\u0027/g, "'");
jQuery.parseJSON(code); 
```

# jquery - Qtip2 Modal，关闭模态时触发事件

> ID：10097377
> 
> 赞同：1
> 
> 时间：2012-04-10T22:29:01.140
> 
> 标签：jquery, modal-dialog, qtip2

当用户单击“x”以关闭 qtip2 模式时，我试图用 jquery 触发某些东西。

这是我的模态的 JS：

```
<script language="javascript" type="text/javascript">
$('.show_likes_modal').live('mouseover', function(event) {//SHOW LIKES MODAL
    clearInterval(auto_refresh); auto_refresh = 0;
    var itemid = $(this).attr("itemid");
    var itemtype = $(this).attr("itemtype");
        $(this).qtip({
        id: 'likesmodal',
        content: {
            text: '<img src="images/loading.gif" alt="Loading..." />',
            ajax: {url: 'modals/show_likes.php',type: 'GET',data: { itemid: itemid,itemtype:itemtype}},
            title: { text: 'People who like this:',button: true}
        },
        position: {my: 'centered',at: 'centered',target: $(window)},
        show: {event: 'click',solo: true,modal: true},
        hide: false,
        style: 'ui-tooltip-light ui-tooltip-rounded',
        events: {
        hide: function(event, api){
         auto_refresh = setInterval(function (){$('#bottom_middle').load(thisurl + '&timer=' + new Date().getTime() + ' #bottom_middle' );}, 5000);             
         $(this).qtip("destroy"); 
        }
       }        
      }); 
return false;     
}); 
</script> 
```

如果您注意到“隐藏：函数（事件，api）{”行，当用户在模式外部单击以关闭它时，这可以正常工作，但是当用户单击“x”以关闭模式时，它只是关闭模态的。当用户单击“x”时，我如何“做某事”？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T14:58:37.373

为了捕捉按钮的关闭事件，我发现你需要在而不是捕捉`mousedown`事件，它不会被触发。我假设是因为插件对它做了一些事情。`.qtip-close``click`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T11:39:48.977

你试过绑定关闭按钮的点击事件了吗？

```
// > jQuery 1.7
$("a.ui-tooltip-close").on("click", function() { ... });

// < jQuery 1.7
$("a.ui-tooltip-close").click(function() { ... }); 
```

# java - JAXB 中的元帅参数

> ID：10097382
> 
> 赞同：1
> 
> 时间：2012-04-10T22:29:31.140
> 
> 标签：java, xml, jaxb

我有一个名为 Costumer 的类，它将客户数据作为输入，并以 XML 格式输出一个复杂类型，其中包含许多标签，如地址、邮政、电话。

在我的主要功能中，我创建了一个名为 C1 的客户对象的成功实现，并将其作为编组参数传递，并按预期查看 XML 输出。

我的问题是，如果我想添加另一个客户 C2，那么什么是有效的实施方式。Obvioulsy 我无法创建 ArrayList 。因为 marshall 参数不将 ArrayList 作为参数。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:14:47.853

您想生成带有客户元素列表的 XML？您需要另一种类型来表示您的列表，并且您还需要注释该类型。然后构造一个“列表类型”的实例并对其进行编组。

# ruby-on-rails - 如何在 Ruby on Rails 中调整 <%= form_for %> 表单的输入大小

> ID：10097384
> 
> 赞同：0
> 
> 时间：2012-04-10T22:29:37.877
> 
> 标签：ruby-on-rails, css

如果我试图减小“电子邮件”和“密码”表单的宽度：

```
 <div id="signin">
    <h1>Sign in</h1>

    <%= form_for(:session, :url => sessions_path) do |f| %>
      <div class="field">
        <%= f.label :email %><br />
        <%= f.text_field :email %>
      </div>
      <div class="field">
        <%= f.label :password %><br />
        <%= f.password_field :password %>
      </div>
      <div class="actions">
        <%= f.submit "Sign in" %>
      </div>
     <% end %> 
```

...并将它们放在右上角的导航栏中，CSS 看起来如何？

为什么会....

```
 #signin #field.text_field {

    width:20px;

    } 
```

...不行？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:50:07.500

Rails 的`.text_field`方法将`input`在您的 HTML 中生成一个标签，因此您需要改为以该`input`标签为目标。此外，您应该使用`.field`, not `#field`，因为它是一个类，而不是一个 id。

```
#signin .field input {
  width:20px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T22:32:56.537

试试这个：`field`被定义为类但不是一个ID。

`#signin .field.text_field { width: 20px; }`

或者

我认为您可以将第 6 行修改为

`<%= f.text_field :email, :size => 10 %>`

# c++ - 使用重复键对对象进行排序

> ID：10097388
> 
> 赞同：0
> 
> 时间：2012-04-10T22:30:05.957
> 
> 标签：c++, list

我需要一长串按其中一个参数排序的对象。在 C++ 中执行此操作的最快方法是什么？我需要能够在此列表中添加和删除元素，并且仍然按该特定参数进行排序。

```
Class Foo {
private:
  int rank;
} 
```

我希望我的所有`Foo`对象都按升序排列，*当添加或删除新对象时，它应该在顺序中占据正确的位置*。也可以有多个相同的对象，`rank`因此键值是不可能的。

知道如何在 C++ 中做到这一点吗？我正在查看[make_heap()](http://www.sgi.com/tech/stl/make_heap.html)但我不确定如何将它与对象一起使用（或者是否可以使用）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:46:48.143

首先，您可能应该`operator<`为`Foo`（类似这样的东西）定义...

```
inline bool operator< (const Foo& lhs, const Foo& rhs) {
  return lhs.rank < rhs.rank;
} 
```

需要将其声明为`Foo`'s 的朋友：

```
class Foo {
 public:
  explicit Foo(int rank_init) : rank(rank_init) {}
  friend bool operator< (const Foo&, const Foo&);
 private:
  int rank;
}; 
```

现在您可以创建一个`std::multiset<Foo>`保持`Foo`s 升序排序的 s `rank`，例如

```
std::multiset<Foo> foo_multiset;
foo_multiset.insert(Foo(5));  // 5
foo_multiset.insert(Foo(3));  // 3, 5
foo_multiset.insert(Foo(1));  // 1, 3, 5
foo_multiset.insert(Foo(3));  // 1, 3, 3, 5
size_t erased_count(foo_multiset.erase(Foo(3)));  // 1, 5 (erased_count == 2) 
```

但是，不能保证这将是您特定情况下的“最快”选项。您需要为此进行概要分析。根据元素的数量、插入/擦除操作的频率以及 STL 实现，您会发现 sorted`std::vector<Foo>`更适合您的需求。

Scott Meyers 的[有效 STL](https://rads.stackoverflow.com/amzn/click/com/0201749629)在第 23 项中描述了这种情况。

# matlab - MATLAB 变量轮廓 LevelStep

> ID：10097390
> 
> 赞同：0
> 
> 时间：2012-04-10T22:30:25.320
> 
> 标签：matlab, contour

我知道要在等高线图中显示的等高线，但它们的间距不规则。是否可以手动输入这些轮廓值而不仅仅是 LevelStep？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:29:02.297

是的。在它谈论之前的[轮廓文档](http://www.mathworks.com.au/help/techdoc/creating_plots/f10-2524.html#f10-2600)`LevelStep`中，它还说（我跳过了一些关于指定轮廓级别数量的位，你已经知道了）：

> 等高线功能允许您指定等高线级别的数量或要绘制的特定等高线级别。在`contour`……的情况下`contour(Z,v)`。`Z`是数据矩阵，...并且`v`是特定轮廓级别的向量。

所以就这样做（例如）

```
contour(Z,[1 2 3 4 5]) % or contour(X,Y,Z,v) 
```

它将`Z`在 1、2、3、4 和 5 处绘制等高线。

# c# - 是否可以使用受保护的构造函数创建对象的实例？

> ID：10097391
> 
> 赞同：3
> 
> 时间：2012-04-10T22:30:39.310
> 
> 标签：c#, constructor, protected, explicit, activator

大家好，问题是这样的：

```
public abstract class BaseClass
{
    protected BaseClass()
    {
        // some logic here
    }

    protected BaseClass(Object parameter) : this()
    {
        // some more logic
    }
}

public class Descendant : BaseClass
{
   // no constructors
} 
```

我试图在 Descendant 类上调用**Activator.CreateInstance ，但****没有**找到构造函数。

我需要在 Descentant 类上**明确定义它吗？**

我使用的绑定是这些：`BindingFlags.Instance | BindingFlags.NonPublic`

**注意 1**：我在现实中调用 AppDomain.CreateInstanceAndUnwrap()，如果它应该有一些影响的话。

```
 domain.CreateInstanceAndUnwrap(path, typeName, false, BindingFlags.Instance |
     BindingFlags.NonPublic, null, new[] { parameter }, null, null); 
```

**注意 2**：如果我在 Descendant 类中明确定义受保护的构造函数，那么它可以工作，但如果可能的话，我想避免这种情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T22:33:00.700

~~~~您不能使用 Activator.CreateInstance，但在完全信任环境中，您应该能够通过反射直接定位和调用构造函数。~~~~

实际上，您的 Descendant 类自动提供了一个公共构造函数，该构造函数传递到基类的受保护构造函数。这应该可以正常工作：

```
Activator.CreateInstance(typeof(Descendant)) 
```

 ~~好的，现在我意识到您正在尝试调用非默认构造函数。不幸的是，这根本是不允许的。直接在基类上调用构造函数是行不通的，因为基类是抽象的。您需要在后代类上有一个构造函数（自动生成或显式定义）才能构造对象。

您可以在 Descendant 类上创建一个传递构造函数，但您的评论听起来像是您试图避免强制实现者在其构造函数中传递一个值。您可能真正想要的是在构造对象后可以调用的初始化方法：

```
// Define other methods and classes here
public abstract class BaseClass
{
    protected BaseClass()
    {
        // some logic here
    }

    protected Object Parameter {get; private set;}    

    public virtual void Initialize(Object parameter)
    {
        Parameter = _parameter;
        // some more logic
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:03:24.643

您在这里似乎想要的是构建器模式，而不是构造器。这很简单——你定义一个类（带有默认构造函数）来“构建”你想要的类。像这样的东西（注意：前面的未经测试的代码）：

```
public abstract class BaseBuildable : MarshalByRefObject {
   public String Foo { get; internal set; }
}

public class DerivedBuildable : BaseBuildable { }

public class BuildableBuilder : MarshalByRefObject {
   private String _foo;
   public BuildableBuilder WithFoo(String foo) { _foo = foo; return this; }
   public TBuildable Build<TBuildable>() where TBuildable : BaseBuildable, new() {
       return new TBuildable { Foo = _foo; }
   }
}

// Used so:
var builder = domain.CreateInstanceAndUnwrap(.. // yadda yadda, you want a BuildableBuilder
var buildable = builder.WithFoo("Foo, yo").Build(); 
```~~

# pascal - Pascal 是否支持将参数传递给函数？

> ID：10097393
> 
> 赞同：2
> 
> 时间：2012-04-10T22:30:59.670
> 
> 标签：pascal, freepascal

我是 Pascal 的新手，我正在尝试编写一个简单的程序，但是在函数之间传递值时遇到了麻烦。这是我所拥有的一小部分：

```
program numberConverter;

const
    maxValue = 4999;
    minValue = 1;

var num: integer;

function convertNumeral(number: integer):string;
var j: integer;
begin
if ((number < minValue) OR (number > maxValue)) then
    begin
    writeln(number);
    writeln('The number you enter must be between 1 and 4999\. Please try again:');
    read(j);
    convertNumeral := convertNumeral(j);
    end
else 
 if (number >= 1000) then
convertNumeral := 'M' + convertNumeral(number -1000)
{more code here, left it out for space}
end;

begin
    writeln;
    writeln('Enter an integer between 1 and 4999 to be converted:');
    read(num);
    writeln;
    writeln(num);
    writeln(convertNumeral(num));
end. 
```

我的问题是来自 writeln(converNumeral(num)) 的值，主要是“num”，没有传递给 convertNumeral 函数，我想知道 Pascal 是否会这样做。我认为它是因为我没有将 number 声明为变量，但是当我这样做时，我得到一个编译错误，它无法完成第二个 if 语句。谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:37:02.843

是的，值肯定会传递给函数。我保证`num`确实会传递给`convertNumeral`. 在该函数中，`number`获取`num`. 您如何观察程序的行为可能存在问题。

您对 所做的更改`number`（如果有）将不会反映在 中`num`。*该参数是按值*传递的，因此`number`存储了存储在中的值的*副本*`num`；它们是两个不同的变量。如果这是您想要的，您可以使用`var`通过引用传递参数。

每次递归调用`convertNumeral`都会获取 的*新*实例，因此一旦函数返回给调用者，`number`对 所做的更改（如果有）将不会出现。`number`每个调用都有自己的`number`和版本`j`。

# c++ - C++ & 从函数接收对象

> ID：10097396
> 
> 赞同：0
> 
> 时间：2012-04-10T22:31:19.950
> 
> 标签：c++, oop, object

我有一个包含普通构造函数和复制构造函数的类的以下简单代码

```
class largeObj
{
public:
    largeObj()
    {
        printf("\nNormal constructor\n");
    }

    largeObj(const largeObj& mv)
    {
        printf("\nCopy constructor\n");
    }

    ~largeObj()
    {
        printf("\nDestroying..\n");
    }

    void tryme()
    {
        printf("\nHi :)\n");
    }

};

largeObj iReturnLargeObjects()
{
    largeObj md;

    return md;
}

int main()
{

    largeObj mdd = iReturnLargeObjects();

    mdd.tryme();

    return 0;
} 
```

输出是

> 普通构造函数
> 
> 复制构造函数
> 
> 破坏..
> 
> 你好 ：）

我明白了为什么。

但是如果我替换以下行

```
largeObj mdd = iReturnLargeObjects(); 
```

和

```
largeObj& mdd = iReturnLargeObjects(); 
```

输出是一样的，这是为什么呢？

我的意思是：在第一种情况下不应该有另一个副本（没有＆）吗？这两条线有什么区别，为什么它们的行为相同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T22:35:40.583

```
largeObj& mdd = iReturnLargeObjects(); 
```

您不能将可变的左值引用绑定到右值。这是非法的 C++，只有某些特定的编译器扩展允许。然而，问题的语义没有改变，即使这个引用是`const`合法的，因此赋值是合法的。

您的输出没有什么不同的原因是因为称为 RVO 的编译器优化。这种优化在 C++ 标准中明确允许，允许编译器在某些限制内跳过它认为不必要的构造对象——即使这样做会改变程序的语义，这使得它成为一种非常不寻常的优化。

底线是：不要将副作用放在复制/移动构造函数和析构函数中，因为即使程序的正确性取决于调用它们，编译器也可以消除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:00:22.500

你用的是什么编译器，我敢打赌这行得通，因为无论你使用什么编译器都没有在返回后将未使用的堆栈变量清零，你没有遇到段错误，因为它仍然是你的堆栈。基本上 md 留在堆栈上，您在技术上仍然可以解决。两者的区别在于

> 大对象 md;

是一个完整地接收变量的变量。

> largeObj& mdd = iReturnLargeObjects();

是对由于惰性编译器仍然存在的变量的引用。

# rspec - 如何设置模拟数据库以在 sinatra 中进行测试？

> ID：10097398
> 
> 赞同：1
> 
> 时间：2012-04-10T22:31:28.273
> 
> 标签：rspec, mocking, sinatra, rspec2, neo4j

我有一个使用 neo4j 作为图形数据库的 sinatra 应用程序。该应用程序通过neography 作为REST 客户端访问数据库。

我想使用 rspec 模拟这个客户端以进行测试。实现这一目标的最佳做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T09:56:15.613

找到我的答案：

西纳特拉应用程序：

```
require 'sinatra'

module Backend
  class Neography
    # stuff
  end
end

helpers Backend

before do
    @neo = Backend::Neography.new
end

get '/:id' do
  "#{@neo.get_node(params[:id])}"
end 
```

规格：

```
describe 'The App' do
  include Rack::Test::Methods

  def app
    Sinatra::Application
  end

  def mock_neography
    @neo_mock = mock("Backend::Neography")
    @neo_mock.stub!("get_node") {"something else"}
    Backend::Neography.stub(:new).with(any_args()).and_return(@neo_mock)
  end

  it "gets a node" do
    mock_neography
    get '/5'
    last_response.should be_ok
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T01:23:13.020

你有几个选择：

一：点击此链接： http: [//net.tutsplus.com/tutorials/ruby/writing-an-api-wrapper-in-ruby-with-tdd/](http://net.tutsplus.com/tutorials/ruby/writing-an-api-wrapper-in-ruby-with-tdd/)

它逐步解释了如何使用 webmock 和 vcr gem 进行操作。这个想法是您第一次针对实时数据库运行测试，vcr 记录它们，然后您的测试将运行记录的答案。

二：您可以在 CI 虚拟机环境中针对新数据库运行测试。看看 Neography 的 travis.yml 文件：

脚本：“bundle exec rake neo4j:install neo4j:start spec --trace”

结果： [http ://travis-ci.org/#!/maxdemarzi/neography](http://travis-ci.org/#!/maxdemarzi/neography)

三：您可以在与您的 dev 或 prod 数据库不同的端口号上运行测试数据库，将 neography 指向您的规范文件中的那个并使用它。

这是一个很好的问题，所以这些天我会在我的博客[http://maxdemarzi.com上发表一篇文章](http://maxdemarzi.com)

# hashmap - HashMap key hashcode 可能会失败？

> ID：10097403
> 
> 赞同：0
> 
> 时间：2012-04-10T22:32:02.680
> 
> 标签：hashmap

好的，我正在使用我的一个类作为 Key 使用 hashmap。

我的问题是：当我一次得到正确的物品时，是否有可能在另一次得到一件坏的物品？

我的意思是，我实现了一个哈希码算法，我在这里查看另一个问题。有时我得到正确的项目，有时我没有得到它。

有什么猜测吗？是否有可能一次找到而第二次找不到它？我不会删除它！

非常感谢提前！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T22:36:38.000

当然不是，你需要一致性。如果使用相同的算法计算，则同一项目的哈希值必须始终相同。

您的问题的一个可能答案是您正在使用在第一次搜索和第二次搜索之间修改的对象的一些内部值进行计算。

从两个值映射到相同哈希值的意义上讲，您可能会发生冲突，但是您不能拥有第一次有效而第二次无效的东西。

# ruby-on-rails - 我可以用 Spock 做这个吗？

> ID：10097406
> 
> 赞同：3
> 
> 时间：2012-04-10T22:32:22.433
> 
> 标签：ruby-on-rails, unit-testing, junit, spock

我在 ROR 中看到了一个用于测试某些域类的示例：

```
context "Validations" do
   [:city, :zip, :street].each do |attr|
      it "must have a #{attr}" do
         a = Address.new
         a.should_not be_valid
         a.errors.on(attr).should_not be_nil
      end
   end
end 
```

它使用不同的值和不同的名称动态创建测试......这很有趣，但是......我可以用 spock 或 jUnit 来做这件事吗？

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T22:55:05.120

使用斯波克：

```
class Validations extends Specification {
    def "must have a #attr"() {
        def a = new Address()

        expect:
        !a.valid
        a.errors.on(attr) != null

        where:
        attr << ["city", "zip", "street"]
    }
} 
```

如果有多个数据变量，表格语法更方便：

```
 ...
        where:
        attr1    | attr2
        "city"   | ...
        "zip"    | ...
        "street" | ... 
```

# c# - 如何确定线性化 PDF 文件中第 1 页的范围（以字节为单位）？

> ID：10097407
> 
> 赞同：8
> 
> 时间：2012-04-10T22:32:36.067
> 
> 标签：c#, pdf

我知道我可以“线性化”PDF 文件，例如使用 Acrobat SDK 或使用商业工具。这也称为“针对 Web 优化”，它重新排列 PDF 以便可以尽快加载第 1 页。以这种方式提供的 PDF 显示得更快，因为 PDF 查看器不必等待整个 PDF 被下载。

**更新：**根据下面的答案，我现在意识到线性化 PDF 不仅重新排列，而且还包含有关其自身结构的元数据，以“线性化字典”的形式。

我有一个应用程序，我想预取几个 PDF（查询的结果），以期用户希望看到其中一个。如果我的客户可以为每个搜索结果下载第 1 页，并且只下载第 1 页，那就太棒了。当用户选择其中之一时，可以立即显示第 1 页，其余的可以在后台下载。

我正在寻找一种可用于服务器端（Windows 或 Linux）来预处理我的 PDF 的通用解决方案，以便我可以分别存储和提供第 1 页和其余部分。真的，我只需要知道 PDF 中正确显示第 1 页所需的最后一个字节的位置。如果我能得到这个数字，那么其他所有内容都将随之而来。

我浏览了[PDF 的 ISO 规范，](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/pdf/pdfs/PDF32000_2008.pdf)但文件格式似乎太复杂，无法简单地解析出第 1 页的结束位置。另一方面，线性化 PDF 的工具必须几乎肯定知道第 1 页的结束位置。

我对将 PDF 分段提供给客户的复杂性不感兴趣；这部分已经解决，因为客户端是一个应用程序，而不是浏览器，我可以完全控制。

我也不认为它会帮助我使用[AP Split](http://docs.editme.com/docs-apsplit)之类的工具将 PDF 拆分为“第 1 页”PDF 和完整的 PDF。如果我这样做了，那么我将无法欺骗客户查看者认为它是单个 PDF 文件，并且当我将“第 1 页”PDF 替换为完整 PDF 时会出现明显的闪烁。

任何帮助或指针表示赞赏。

**解决方案**（基于以下 Bobrovsky 的回答）：

正确线性化的 PDF 以标题行（在 PDF 规范的第 7.5.2 节中定义）开始，例如“%PDF-1.7”，后跟至少四个二进制字符的注释行（定义为 128 或更高的字节值） . 例如：

```
 %PDF-1.7
    %¤¤¤¤ 
```

此标头后紧跟线性化字典（在 PDF 规范的附录 F 中定义）。一个例子：

```
 43 0 obj
    << /Linearized 1.0 % Version
     /L 54567   % File length
     /H [475 598] % Primary hint stream offset and length (part 5)
     /O 45      % Object number of first page’s page object (part 6)
     /E 5437    % Offset of end of first page
     /N 11      % Number of pages in document
     /T 52786 % Offset of first entry in main cross-reference table (part 11)
    >>
    endobj 
```

在这个例子中，第一页的结尾在字节偏移 5437 处。这个数据结构非常简单，可以使用几乎任何语言进行解析。“43 0 obj”这个东西给出了这个字典的一个 ID (43) 和一个代号（对于线性化文件总是零）。字典本身被 << 和 >> 包围，它们之间是键值对（键有像“/E”这样的斜线）。

这是一个使用正则表达式查找相关数字的 C# 方法：

```
public int GetPageOneLength(byte[] data)
{
  // According to ISO PDF spec: "The linearization parameter dictionary shall be entirely contained within the first 1024 bytes of the PDF file" (p. 679)
  string preamble = new string(ASCIIEncoding.ASCII.GetChars(data, 0, 1024));    // Note that the binary section on line 2 of the header will be entirely converted to question martks ('?')
  var match = Regex.Match(preamble, @"<<\w*/Linearized.+/E\s+(?<offset>\d+).+>>");
  if (!match.Success) throw new InvalidDataException("PDF does not have a proper linearization dictionary");
  return int.Parse(match.Groups["offset"].Value);
} 
```

请注意 Bobrovsky 的警告，即文件可能包含线性化字典，但可能未正确线性化（可能是因为增量编辑？）。就我而言，这不是问题，因为我将自己线性化所有 PDF。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T08:15:12.033

线性化字典应该可以帮助你。

包含参数所需的字典`E`是

> 第一页结尾（示例 F.1 中第 6 部分的结尾）相对于文件开头的偏移量。

请注意，并非每个带有线性化字典的文件实际上都是线性化的（损坏的生成器、线性化后的变化等）。因此，如果您的文件未被验证为正确线性化，您可能无法使用所描述的方法。

有关线性化字典的更多信息，请查看 PDF 参考中的*F.2.2 线性化参数字典（第 2 部分）*。

# iphone - 在 iOS 应用中获取全球 IP 地址并获取国家是否合法？

> ID：10097410
> 
> 赞同：2
> 
> 时间：2012-04-10T22:32:41.607
> 
> 标签：iphone, ipad, ios5, ip, country

我刚听说这件事。我正计划开发一个 ios 应用程序 - iPhone 和 iPad 版本。该应用程序需要根据访问的国家/地区显示内容。（注意我只需要国家而不需要更多详细信息）。

我可以获取 iPhone/iPad 的当前全球 IP 地址，然后根据我自己在服务器中的数据库将其转换为国家/地区吗？

这样做是否合法，因为我刚刚听说它违反了苹果的政策？

我不想使用定位服务来处理这个问题，因为我觉得使用 IP 地址获取国家/地区要容易得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:07:25.183

使用用户的区域设置可能是最好的选择，但如果您想使用 IP 地址，那么这里有一个免费的[数据库](http://www.maxmind.com/app/geolitecountry)。该页面还包含用于使用 IP 地址搜索数据库的免费库。

如果您在服务器上做所有事情，那么这是完全合法的，并且不违反任何 Apple 规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T22:56:04.783

你可以用这个找到国家

```
NSLocale *locale = [NSLocale currentLocale];
NSString *countryCode = [locale objectForKey: NSLocaleCountryCode];
NSString *countryName = [locale displayNameForKey: NSLocaleCountryCode value: countryCode]]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T22:34:12.630

这是合法的，并且已经被多个应用程序付诸实践。不是真正的故障安全（容易欺骗，VPN连接等）。

编辑：“这是合法的”是基于下一个陈述“已经在实践中”。一些大公司使用它，所以我认为这是一项法律行动。但是，我不是法律事务专家。

# asp.net - 静态类中的 ASP.NET 非静态类线程安全

> ID：10097415
> 
> 赞同：0
> 
> 时间：2012-04-10T22:33:06.880
> 
> 标签：asp.net, thread-safety, static

堆栈溢出。假设我要初始化一个非静态变量类，其中两个是 UserID (int) 和 MyDictionary (Dictionary)。这个非静态类在静态类中声明（并在静态类的成员之一中初始化）。如果脚本运行时间较长并且另一个用户访问同一页面，则新用户可能会更改另一个用户的 MyDictionary 的内容。但我不明白这是怎么可能的，因为 MyDictionary 是在一个非静态类中。有人明白这个吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:43:16.443

所以我假设代码看起来有点像这样，对吧？

```
public class MyNonStaticClass
{
    public int UserID;

    public Dictionary<int, string> MyDictionary 
        = new Dictionary<int, string>;
}

public static class MyStaticClass
{
    public static MyNonStaticClass aStaticInstanceOfTheNonStaticClass 
        = new MyNonStaticClass();

    public static void AddToDictionary(int key, string value)
    {
        aStaticInstanceOfTheNonStaticClass.add(key, value);
    }
} 
```

通过将静态类中的对象声明为静态变量，您基本上是在说“在我的应用程序中，我想要其中之一；并且只有其中之一”；所以即使类不是静态的；您仍在创建它的静态实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T22:41:03.327

静态性（或缺乏静态性）不会**影响**线程安全。静态只是意味着类成员（属性、字段、方法或构造函数）与*类型*相关联，而不是与类*的特定实例*相关联。

我可以编写非线程安全的静态代码（如您在问题中描述的代码），我可以编写线程安全的实例代码，反之亦然。这是一些**非线程安全（坏）的**代码，或多或少与我认为您正在做的事情一致：

```
public static class MyFoo {

    // Just because this is a static property doesn't
    // mean the contained dictionary is thread safe!
    public static Dictionary<String, String> MyDictionary { get; set; }

    public static MyFoo() {
        MyDictionary = new Dictionary<String, String>();
    }
} 
```

如果您需要在 ASP.NET 中存储特定于用户的信息，请使用 Session 对象或（对于长期存在的数据）数据库。永远不要依赖静态变量——如果两个用户同时在网站上怎么办？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T22:39:56.907

因为包含类和访问成员是静态的，所以它使用单一的内存空间。您必须假设静态类的引用（在这种情况下为局部变量、字段或属性）也是静态的（即使它们是非静态类的实例）。

首先这个类是静态的原因是什么？如果您使用共享逻辑，为什么不通过引用静态方法来传递字典？

# wpf - 如何创建自动滚动文本框

> ID：10097417
> 
> 赞同：27
> 
> 时间：2012-04-10T22:33:17.343
> 
> 标签：wpf, xaml, mvvm

我有一个 WPF 应用程序，其中包含一个多行文本框，用于显示调试文本输出。

如何设置 TextBox 以便将文本附加到框中时，它会自动滚动到文本框的底部？

*   我正在使用 MVVM 模式。
*   理想情况下，纯 XAML 方法会很好。
*   TextBox 本身不一定是焦点。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-12T21:51:18.153

@BojinLi 提供的答案效果很好。然而，在阅读了@GazTheDestroyer 链接的答案后，我决定为 TextBox 实现我自己的版本，因为它看起来更干净。

总而言之，您可以通过使用附加属性来扩展 TextBox 控件的行为。（称为 ScrollOnTextChanged）

使用它很简单：

```
<TextBox src:TextBoxBehaviour.ScrollOnTextChanged="True" VerticalScrollBarVisibility="Auto" /> 
```

这是 TextBoxBehaviour 类：

```
using System;
using System.Collections.Generic;
using System.Windows;
using System.Windows.Controls;

namespace MyNamespace
{
    public class TextBoxBehaviour
    {
        static readonly Dictionary<TextBox, Capture> _associations = new Dictionary<TextBox, Capture>();

        public static bool GetScrollOnTextChanged(DependencyObject dependencyObject)
        {
            return (bool)dependencyObject.GetValue(ScrollOnTextChangedProperty);
        }

        public static void SetScrollOnTextChanged(DependencyObject dependencyObject, bool value)
        {
            dependencyObject.SetValue(ScrollOnTextChangedProperty, value);
        }

        public static readonly DependencyProperty ScrollOnTextChangedProperty =
            DependencyProperty.RegisterAttached("ScrollOnTextChanged", typeof (bool), typeof (TextBoxBehaviour), new UIPropertyMetadata(false, OnScrollOnTextChanged));

        static void OnScrollOnTextChanged(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
        {
            var textBox = dependencyObject as TextBox;
            if (textBox == null)
            {
                return;
            }
            bool oldValue = (bool) e.OldValue, newValue = (bool) e.NewValue;
            if (newValue == oldValue)
            {
                return;
            }
            if (newValue)
            {
                textBox.Loaded += TextBoxLoaded;
                textBox.Unloaded += TextBoxUnloaded;
            }
            else
            {
                textBox.Loaded -= TextBoxLoaded;
                textBox.Unloaded -= TextBoxUnloaded;
                if (_associations.ContainsKey(textBox))
                {
                    _associations[textBox].Dispose();
                }
            }
        }

        static void TextBoxUnloaded(object sender, RoutedEventArgs routedEventArgs)
        {
            var textBox = (TextBox) sender;
            _associations[textBox].Dispose();
            textBox.Unloaded -= TextBoxUnloaded;
        }

        static void TextBoxLoaded(object sender, RoutedEventArgs routedEventArgs)
        {
            var textBox = (TextBox) sender;
            textBox.Loaded -= TextBoxLoaded;
            _associations[textBox] = new Capture(textBox);
        }

        class Capture : IDisposable
        {
            private TextBox TextBox { get; set; }

            public Capture(TextBox textBox)
            {
                TextBox = textBox;
                TextBox.TextChanged += OnTextBoxOnTextChanged;
            }

            private void OnTextBoxOnTextChanged(object sender, TextChangedEventArgs args)
            {
                TextBox.ScrollToEnd();
            }

            public void Dispose()
            {
                TextBox.TextChanged -= OnTextBoxOnTextChanged;
            }
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-10T06:44:46.697

此解决方案的灵感来自[Scott Ferguson 的](https://stackoverflow.com/a/10132405/1430156)附加属性解决方案，但避免存储内部关联字典，因此代码更短：

```
 using System;
    using System.Windows;
    using System.Windows.Controls;

    namespace AttachedPropertyTest
    {
        public static class TextBoxUtilities
        {
            public static readonly DependencyProperty AlwaysScrollToEndProperty = DependencyProperty.RegisterAttached("AlwaysScrollToEnd",
                                                                                                                      typeof(bool),
                                                                                                                      typeof(TextBoxUtilities),
                                                                                                                      new PropertyMetadata(false, AlwaysScrollToEndChanged));

            private static void AlwaysScrollToEndChanged(object sender, DependencyPropertyChangedEventArgs e)
            {
                TextBox tb = sender as TextBox;
                if (tb != null) {
                    bool alwaysScrollToEnd = (e.NewValue != null) && (bool)e.NewValue;
                    if (alwaysScrollToEnd) {
                        tb.ScrollToEnd();
                        tb.TextChanged += TextChanged;
                    } else {
                        tb.TextChanged -= TextChanged;
                    }
                } else {
                    throw new InvalidOperationException("The attached AlwaysScrollToEnd property can only be applied to TextBox instances.");
                }
            }

            public static bool GetAlwaysScrollToEnd(TextBox textBox)
            {
                if (textBox == null) {
                    throw new ArgumentNullException("textBox");
                }

                return (bool)textBox.GetValue(AlwaysScrollToEndProperty);
            }

            public static void SetAlwaysScrollToEnd(TextBox textBox, bool alwaysScrollToEnd)
            {
                if (textBox == null) {
                    throw new ArgumentNullException("textBox");
                }

                textBox.SetValue(AlwaysScrollToEndProperty, alwaysScrollToEnd);
            }

            private static void TextChanged(object sender, TextChangedEventArgs e)
            {
                ((TextBox)sender).ScrollToEnd();
            }
        }
    } 
```

据我所知，它的行为完全符合预期。这是一个测试用例，窗口中有几个文本框，允许`AlwaysScrollToEnd`以各种方式设置附加属性（硬编码、`CheckBox.IsChecked`绑定和代码隐藏）：

xml:

```
 <Window x:Class="AttachedPropertyTest.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="AttachedPropertyTest" Height="800" Width="300"
        xmlns:local="clr-namespace:AttachedPropertyTest">
        <Window.Resources>
            <Style x:Key="MultiLineTB" TargetType="TextBox">
                <Setter Property="IsReadOnly" Value="True"/>
                <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
                <Setter Property="Height" Value="60"/>
                <Setter Property="Text" Value="{Binding Text, ElementName=tbMaster}"/>
            </Style>
        </Window.Resources>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBox Background="LightYellow" Name="tbMaster" Height="150" AcceptsReturn="True"/>

            <TextBox Style="{StaticResource MultiLineTB}" Grid.Row="1" local:TextBoxUtilities.AlwaysScrollToEnd="True"/>
            <TextBox Style="{StaticResource MultiLineTB}" Grid.Row="2"/>
            <TextBox Style="{StaticResource MultiLineTB}" Grid.Row="3" Name="tb3" local:TextBoxUtilities.AlwaysScrollToEnd="True"/>
            <TextBox Style="{StaticResource MultiLineTB}" Grid.Row="4" Name="tb4"/>
            <CheckBox Grid.Column="1" Grid.Row="4" IsChecked="{Binding (local:TextBoxUtilities.AlwaysScrollToEnd), Mode=TwoWay, ElementName=tb4}"/>
            <Button Grid.Row="5" Click="Button_Click"/>
        </Grid>
    </Window> 
```

代码隐藏：

```
 using System;
    using System.Windows;
    using System.Windows.Controls;

    namespace AttachedPropertyTest
    {
        public partial class Window1 : Window
        {
            public Window1()
            {
                InitializeComponent();
            }

            void Button_Click(object sender, RoutedEventArgs e)
            {
                TextBoxUtilities.SetAlwaysScrollToEnd(tb3, true);
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-11T04:39:33.037

嗯，这似乎是一件有趣的事情，所以我尝试了一下。从一些凝视来看，似乎没有一种直接的方法可以“告诉”文本框将自身滚动到最后。所以我换了个思路。WPF 中的所有框架控件都有一个默认的 Style/ControlTemplate，从 Textbox 控件的外观判断，其中必须有一个 ScrollViewer 来处理滚动。那么，为什么不直接使用默认文本框 ControlTemplate 的本地副本并以编程方式获取 ScrollViewer。然后我可以告诉 ScrollViewer 将其内容滚动到最后。事实证明这个想法有效。

这是我编写的测试程序，可以使用一些重构，但您可以通过查看它来了解它：

这是 XAML：

```
<Window x:Class="WpfApplication3.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:WpfApplication3="clr-namespace:WpfApplication3"
        Title="MainWindow" Height="350" Width="525">
  <Window.Resources>
    <!--The default Style for the Framework Textbox-->
    <SolidColorBrush x:Key="DisabledForegroundBrush" Color="#888" />
    <SolidColorBrush x:Key="DisabledBackgroundBrush" Color="#EEE" />
    <SolidColorBrush x:Key="WindowBackgroundBrush" Color="#FFF" />
    <SolidColorBrush x:Key="SolidBorderBrush" Color="#888" />
    <ControlTemplate x:Key="MyTextBoxTemplate" TargetType="{x:Type TextBoxBase}">
      <Border x:Name="Border" CornerRadius="2" Padding="2" Background="{StaticResource WindowBackgroundBrush}"
              BorderBrush="{StaticResource SolidBorderBrush}" BorderThickness="1">
        <ScrollViewer Margin="0" x:Name="PART_ContentHost" />
      </Border>
      <ControlTemplate.Triggers>
        <Trigger Property="IsEnabled" Value="False">
          <Setter TargetName="Border" Property="Background" Value="{StaticResource DisabledBackgroundBrush}" />
          <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource DisabledBackgroundBrush}" />
          <Setter Property="Foreground" Value="{StaticResource DisabledForegroundBrush}" />
        </Trigger>
      </ControlTemplate.Triggers>
    </ControlTemplate>
    <Style x:Key="MyTextBox" TargetType="{x:Type TextBoxBase}">
      <Setter Property="SnapsToDevicePixels" Value="True" />
      <Setter Property="OverridesDefaultStyle" Value="True" />
      <Setter Property="KeyboardNavigation.TabNavigation" Value="None" />
      <Setter Property="FocusVisualStyle" Value="{x:Null}" />
      <Setter Property="MinWidth" Value="120" />
      <Setter Property="MinHeight" Value="20" />
      <Setter Property="AllowDrop" Value="true" />
      <Setter Property="Template" Value="{StaticResource MyTextBoxTemplate}"></Setter>
    </Style>

  </Window.Resources>
  <Grid>
    <WpfApplication3:AutoScrollTextBox x:Name="textbox" TextWrapping="Wrap" Style="{StaticResource MyTextBox}"
                                       VerticalScrollBarVisibility="Visible" AcceptsReturn="True" Width="100" Height="100">test</WpfApplication3:AutoScrollTextBox>
  </Grid>
</Window> 
```

以及背后的代码：

```
using System;
using System.Windows;
using System.Windows.Controls;

namespace WpfApplication3
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            for (int i = 0; i < 10; i++)
            {
                textbox.AppendText("Line " + i + Environment.NewLine);
            }
        }
    }

    public class AutoScrollTextBox : TextBox
    {
        protected override void OnTextChanged(TextChangedEventArgs e)
        {
            base.OnTextChanged(e);
            // Make sure the Template is in the Visual Tree: 
            // http://stackoverflow.com/questions/2285491/wpf-findname-returns-null-when-it-should-not
            ApplyTemplate();
            var template = (ControlTemplate) FindResource("MyTextBoxTemplate");
            var scrollViewer = template.FindName("PART_ContentHost", this) as ScrollViewer;
            //SelectionStart = Text.Length;
            scrollViewer.ScrollToEnd();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-11T08:41:47.423

一种更便携的方法可能是使用附加属性，例如在[listbox 的类似问题中](https://stackoverflow.com/questions/2006729/wpf-listbox-scroll-when-item-added)。

（属性变化`VerticalOffset`时才设置）`Text`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-02T23:31:47.733

与其他答案类似，但没有静态事件和控制字典。（恕我直言，如果可能，最好避免静态事件）。

```
public class ScrollToEndBehavior
{
    public static readonly DependencyProperty OnTextChangedProperty =
                DependencyProperty.RegisterAttached(
                "OnTextChanged",
                typeof(bool),
                typeof(ScrollToEndBehavior),
                new UIPropertyMetadata(false, OnTextChanged)
                );

    public static bool GetOnTextChanged(DependencyObject dependencyObject)
    {
        return (bool)dependencyObject.GetValue(OnTextChangedProperty);
    }

    public static void SetOnTextChanged(DependencyObject dependencyObject, bool value)
    {
        dependencyObject.SetValue(OnTextChangedProperty, value);
    }

    private static void OnTextChanged(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
    {
        var textBox = dependencyObject as TextBox;
        var newValue = (bool)e.NewValue;

        if (textBox == null || (bool)e.OldValue == newValue)
        {
            return;
        }

        TextChangedEventHandler handler = (object sender, TextChangedEventArgs args) =>
            ((TextBox)sender).ScrollToEnd();

        if (newValue)
        {
            textBox.TextChanged += handler;
        }
        else
        {
            textBox.TextChanged -= handler;
        }
    }
} 
```

这只是其他已发布解决方案的替代方案，这些解决方案是我在寻找一段时间后发现的最好的解决方案之一（即简洁和 mvvm）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-24T06:26:42.160

“ScrollToEnd”方法的问题是 TextBox 必须是可见的，否则它不会滚动。

因此，更好的方法是将 TextBox Selection 属性设置为文档结尾：

```
 static void tb_TextChanged(object sender, TextChangedEventArgs e)
  {
     TextBox tb = sender as TextBox;
     if (tb == null)
     {
        return;
     }

     // set selection to end of document
     tb.SelectionStart = int.MaxValue;
     tb.SelectionLength = 0;         
  } 
```

顺便说一句，第一个示例中的内存泄漏处理[可能是不必要](https://stackoverflow.com/questions/4526829/why-and-how-to-avoid-event-handler-memory-leaks "为什么以及如何避免事件处理程序内存泄漏？")的。TextBox 是发布者，静态附加属性事件处理程序是订阅者。发布者保留对订阅者的引用，这可以使订阅者保持活动状态（而不是相反。）因此，如果 TextBox 超出范围，对静态事件处理程序的引用也会如此（即，没有内存泄漏。）

所以连接附加属性可以更简单地处理：

```
 static void OnAutoTextScrollChanged
      (DependencyObject obj, DependencyPropertyChangedEventArgs args)
  {
     TextBox tb = obj as TextBox;
     if (tb == null)
     {
        return;
     }

     bool b = (bool)args.NewValue;

     if (b)
     {
        tb.TextChanged += tb_TextChanged;
     }
     else
     {
        tb.TextChanged -= tb_TextChanged;
     }
  } 
```

# css - 网站无法在 IE9 / Comino 和 iPad / iPhone 浏览器中正确呈现 - 侧边栏下降到底部，内容下方

> ID：10097419
> 
> 赞同：1
> 
> 时间：2012-04-10T22:33:23.337
> 
> 标签：css, wordpress, html, themes, internet-explorer-9

我有一个在最新（截至目前）WordPress 上运行的网站，并且经过大量修改的“记者”主题。

网址：[http ://www.roofingcalculator.org/](http://www.roofingcalculator.org/)

这就是问题所在 - 在 IE 9、Comino 和 iPad / iPhone 浏览器中，侧边栏位于所有页面上的内容和评论下方

它在 IE 8 中正常工作（尽管它显示各种安全/页面错误废话）Chrome、Firefox、Safari 在 PC 和 Mac、大多数 Android 浏览器等。

我的 CSS 是结构化的，因此内容向左流动，侧边栏向左流动。

我尝试调整内容的宽度，认为 IE9 认为它比 993 px 宽的整个页面设计更宽（连同侧边栏）。

我在 iPhone / iPad 上并不那么担心，因为这些都是次要的，但 IE9 占我总流量的 25%，这需要修复。

请帮忙。谢谢你们。

PS - 我阅读了多篇关于此的帖子，但没有找到解决方案 - 我认为这是因为我自定义了主题......但我在多个网站上使用相同的主题，如果它不呈现这是一个大问题正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:18:53.177

尝试修复表格代码中的错误以及缺少或不合适的`<div>`标签。代码错误是 WP 主题中布局问题的一个重要原因，尤其是。下拉的侧边栏。

[[无效]roofingcalculator.org 的标记验证 - W3C 标记验证器](http://validator.w3.org/check?uri=http%3A//www.roofingcalculator.org/&doctype=Inline&ss=1&group=0&user-agent=W3C_Validator/1.654)。在验证报告中向下滚动以查看行号和源代码。

# sql-server-2008 - SQL Server 2008 R2 If/else 语法

> ID：10097421
> 
> 赞同：4
> 
> 时间：2012-04-10T22:33:44.397
> 
> 标签：sql-server-2008, ssms

我正在尝试在 sql server 中编写一个相当简单的存储过程。如果我的错误的来源很明显，我没有抓住它。SSMS 给我“')' 附近的语法错误。” 任何帮助，将不胜感激。这是程序：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[sprocAddSymbols] @symbol NVARCHAR(10)

AS 

BEGIN

DECLARE @symbolCheck NVARCHAR(10)
DECLARE @statusCheck NVARCHAR(10)

SET @symbolCheck = (SELECT Symbol FROM tblSymbolsMain WHERE Symbol = @symbol)
SET @statusCheck = (SELECT SymbolStatus FROM tblSymbolsMain WHERE Symbol = @symbol)

IF (@symbolCheck IS NOT NULL AND @statusCheck = 'Inactive')
BEGIN
    UPDATE tblSymbolsMain
    SET SymbolStatus = 'Active'
    WHERE Symbol = @symbol
END
ELSE
    INSERT INTO tblSymbolsMain (Symbol, DateAdded, Status)
    VALUES (@symbol, GETDATE(), 'Active') 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T22:37:48.733

你最后错过了一个 END 。总是缩进你的代码。它不仅看起来更好，而且您不会遇到这些情况。此外，即使您在 IF/ELSE 中有单个语句，或者在任何其他不需要 BEING/END 的块中，最好使用 BEGIN 和 END。当以后有人可以添加语句并破坏作为 IF 或 ELSE 块一部分的代码时，它减少了维护的噩梦。

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[sprocAddSymbols] @symbol NVARCHAR(10)

AS 

BEGIN

    DECLARE @symbolCheck NVARCHAR(10)
    DECLARE @statusCheck NVARCHAR(10)

    SET @symbolCheck = (SELECT Symbol FROM tblSymbolsMain WHERE Symbol = @symbol)
    SET @statusCheck = (SELECT SymbolStatus FROM tblSymbolsMain WHERE Symbol = @symbol)

    IF (@symbolCheck IS NOT NULL AND @statusCheck = 'Inactive')
    BEGIN
        UPDATE tblSymbolsMain
        SET SymbolStatus = 'Active'
        WHERE Symbol = @symbol
    END
    ELSE
    BEGIN
        INSERT INTO tblSymbolsMain (Symbol, DateAdded, Status)
        VALUES (@symbol, GETDATE(), 'Active')
    END

END 
```

# c# - 如何在 Telerik RadTreeView 中设置 SelectedNode 并设置选定节点的焦点？

> ID：10097427
> 
> 赞同：3
> 
> 时间：2012-04-10T22:34:32.297
> 
> 标签：c#, asp.net, .net, telerik, radtreeview

我正在使用带有 ASP .Net C# 的 Telerik RadTreeView。我可以使用以下代码设置选定节点：

```
 var node = radTreeViewMenuStructure.Nodes.FindNodeByValue(linkID.ToString());

        if (node != null) // <- equals null when not on the root of the tree
        {
            node.Selected = true;
            node.Expanded = true;
            node.ExpandParentNodes();
            node.Focus();
        } 
```

上面的代码仅在节点刚刚离开根且未包含在父节点中时才设置选定节点。选择包含在父节点中的节点的 ID 时，我的节点 = null。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T14:41:37.490

.FindNodeByValue 在树视图的节点中查找。它不会查看每个子节点。解决方案是递归地走树。这是我最终解决问题的代码：

```
 private void SelectLink(int linkID, RadTreeNodeCollection rootNodes)
    {
        var node = rootNodes.FindNodeByValue(linkID.ToString());
        if (node != null)
        {
            node.Selected = true;
            node.Expanded = true;
            node.ExpandParentNodes();
            node.Focus();

            ... Do some other work ...

            return;
        }

        // for each node with children  
        foreach (RadTreeNode item in rootNodes.Cast<RadTreeNode>().Where(item => item.Nodes.Count > 0))
        {
            // Recursive call to self to walk the tree
            SelectLink(linkID, item.Nodes);
        }
    } 
```

然后我只需使用根 RadTreeView 调用该方法：

```
SelectLink(radTreeViewMenuStructure.Nodes, idToFind); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T22:49:43.267

你只需要也打电话`node.ExpandParentNodes();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-06T19:27:28.647

您只需要做： radTreeViewMenuStructure.FindNodeByValue() 将搜索整个树。

# hibernate - 使 Hibernate @ManyToOne 关联成为 Scala 选项类型

> ID：10097430
> 
> 赞同：3
> 
> 时间：2012-04-10T22:34:51.423
> 
> 标签：hibernate, scala

任何人都有一个在 Hibernate 中为 @ManyToOne 关联使用包装对象的示例，例如 Scala 的 Option？

谢谢。

编辑：感谢您的建议。经过进一步思考，我决定使用私有变量并公开它们具有返回 Option [MyType] 的 scala getter/setter。像这样：

```
class EmailFolder(__parent: Option[EmailFolder] = None) {

    //.... default constructor etc...

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "parent_id")
    private[this] var _parent: EmailFolder = __parent.orNull
    def parent = Option(_parent)
    def parent_=(newVal:Option[EmailFolder]) = _parent = newVal.orNull
} 
```

这行得通，我不再需要在我的应用程序中使用空值。

——安德烈亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T03:47:01.660

我最初的想法是创建一个类，调用它`Option`，将它标记为一个`@Embeddable`，然后给它一个对您可能想要引用的对象集的公共基类的引用（调用它`DomainObject`）。

但是，这样做意味着您可能需要放弃一些事情：

1.  “...任意对象...” 您不能`@ManyToOne`在 Hibernate 中引用完全任意的类。它需要针对特定​​的 Hibernate 实体或实体层次结构：即`DomainObject`，否则 Hibernate 无法知道在获取时要查询哪些表。
2.  “......空值......” Hibernate 为 Elements（又名`@Embeddable`）做了一些特殊的事情。特别是，如果 Element 仅包含 null 引用，则对 Element 本身的引用为 null。

所以你可以采用这种方法，但你最终会得到一个你可能不想要的基类，以及 Element 类中的一些无关字段，只是为了确保 Element 本身不为空。有点痛。

相反，我建议您将 Option 类完全排除在 Hibernate 之外。在具有选项的实体中，使用[访问类型设置](http://docs.jboss.org/ejb3/app-server/HibernateAnnotations/reference/en/html_single/index.html#d0e1955)，以便 Hibernate 通过字段而不是方法访问​​成员。像这样实现getter：

```
...
@ManyToOne
private MyObjectType myObjectReference;

public Option<MyObjectType> getMyObject() {
    return new Option(this.myObjectReference);
}
... 
```

另一种选择是不进行字段级访问，而是使用内部私有 getter/setter 供 Hibernate 处理字段，以及将其包装在 Option 中的公共 getter/setter 以供应用程序的其余部分查看。

这里唯一的缺点是 getter 必须做一些实际的工作，而不是一个简单的 POJO 方法。但我认为不将 Hibernate 打结是值得的。

希望有帮助。

# python - 当出现 500 错误时，如何从 pycurl 获取 HTML 输出？

> ID：10097434
> 
> 赞同：1
> 
> 时间：2012-04-10T22:35:25.487
> 
> 标签：python, pycurl

我正在尝试使用 pycurl 与服务器交互，但出现 500 错误。我希望能够看到从服务器返回的错误文本，但 pycurl 似乎没有给我一种方法来做到这一点。

例如，当我将“curl”指向服务器时，我会得到如下信息：

```
$ curl -H "Content-Type: text/xml; charset=utf-8" -k -d @subcase.xml -X POST https://192.168.1.110/vision.asmx
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <soap:Body>
    <soap:Fault>
      <faultcode>soap:Server</faultcode>
      <detail>
        <ExceptionMessage>Invalid Case Objid -1 or idNumber 76029744 or Case is closed.</ExceptionMessage>
      </detail>
    </soap:Fault>
  </soap:Body>
</soap:Envelope> 
```

但是当我尝试构建一些做同样事情的 pycurl 时，从服务器返回的 HTML 似乎被吞没了：

```
class Storage:
    '''An object used to hold the output of a pyCurl command'''
    def __init__(self):
        self.contents = []
    def store(self, buf):
        self.contents.append(buf)
    def __str__(self):
        return '\n'.join(self.contents)

def go_get_it(url):
    curl_obj = pycurl.Curl()
    curl_obj.setopt(pycurl.URL, str(url))

    output = Storage()
    header = Storage()
    curl_obj.setopt(pycurl.WRITEFUNCTION, output.store)
    curl_obj.setopt(pycurl.HEADERFUNCTION, header.store)

    response = Response(header, output)
    if self.debug_level:
        curl_obj.setopt(pycurl.VERBOSE, 1)
        curl_obj.setopt(pycurl.DEBUGFUNCTION, self.curl_debug)
    try:
        curl_obj.perform()
        status_code = curl_obj.getinfo(pycurl.HTTP_CODE)
        response.set_status_code(status_code)
        return response
    except pycurl.error, curl_err:
        print curl_obj.errstr() 
```

如果服务器没有抛出 500 错误，则该`output`对象包含来自服务器的 HTML 响应。但是，当我们得到异常时，输出对象是空的。从服务器返回的 HTML 也不可用`curl_err`（据我所知）。

有谁知道在这种情况下是否有办法恢复从服务器返回的 HTML？

# session - 设计 Web 应用程序：会话或无会话

> ID：10097441
> 
> 赞同：6
> 
> 时间：2012-04-10T22:35:55.517
> 
> 标签：session, cookies, web, application-design, session-less

我希望其他人向我解释，哪种方法更好：使用会话或设计无会话。我们正在开始开发一个新的 Web 应用程序，但尚未决定要遵循的路径。

无会话设计 IMO 更可取：

优点：

1.  可扩展性。我们可以拥有任意数量的服务器，而无需共享用户会话。它们中的每一个都可以处理请求（例如通过循环进行负载平衡）。
2.  节省服务器资源。我们不需要在服务器端分配内存（再次 - 可伸缩性）。
3.  服务器重启后无需恢复。

缺点：

1.  必须在 cookie 中保留一些与用户相关的信息（非关键）。
2.  需要更多的编码（但不是真正的编码）。

在做出最终决定之前，我们需要注意哪些话题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T23:59:21.430

今天的应用程序可以很快变得非常大（看看所有那些“小而简单”的工具，如 pastebin、jsfiddle 等！）。并且在某些时候一台 16 核的高端机器是不够的（有些人可能会说“你必须重新编码你的应用程序才能节省 cpu 功率 bla-bla”，但是每个服务器的 http-connection-limit 也是一个问题） . 因此，如果您计划构建一个可能比预期更受欢迎的公共应用程序，那么开始“无会话”是要走的路！老实说，这只会影响那些写出真正大事的人。

会话的杀手锏是：mySQL 数据库的流量更少，编码更容易。但是当您的应用程序变大时，您将不得不重写整个系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-16T07:37:35.010

使用内存数据解决方案（如 REDIS 和基于 spring 的抽象来处理会话），我认为这个问题在今天的上下文中甚至都不成立。尝试保持应用程序会话较少显然更好，但根据需要，不需要对自己如此苛刻。集中式会话管理也不会导致缩放问题。

# security - 如何使用 WIF 保护对静态文件的访问？

> ID：10097444
> 
> 赞同：0
> 
> 时间：2012-04-10T22:36:02.263
> 
> 标签：security, iis-7.5, wif, claims-based-identity

我在 IIS 服务器上有一个 jpg 图像文件夹，我们需要保护它们，以便只有具有特定权限的人才能查看它们。我们已经实现了基于 WIF 的 STS（不是 AD），用于在网站的其他部分进行身份验证，我希望能够对 WIF 身份验证的用户使用特定声明，以允许他们通过 IIS（IIS 7）读取这些图像文件.

我可以编写一个自定义处理程序来进行检查，但我宁愿不必通过 .net 管道传递静态文件。我们已经查看了[C2WTS](http://msdn.microsoft.com/en-us/library/ee517278.aspx)选项，但它似乎被硬编码为使用我们的 STS 不提供的 UPN 声明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:55:59.500

您能否不使用 web.config 中的位置标记指定该特定文件夹，然后在其中使用类似：

```
<allow roles="Viewer"/>
<deny users="*"/> 
```

# python - Django 1.4：获取外键对象中的字段（null=True），获取None或字段值

> ID：10097448
> 
> 赞同：2
> 
> 时间：2012-04-10T22:36:30.567
> 
> 标签：python, django

假设我有这些模型：

```
class A(models.Model):
    name = models.CharField(max_length=32)
    b = models.ForeignKey("B", null=True)
    def __unicode__(self):
        return self.name

class B(models.Model):
    name = models.CharField(max_length=32)
    def __unicode__(self):
        return self.name 
```

而这个观点：

```
def DisplayIt(request):
    html = ""
    for a in A.objects.all():
        html += "<input type='text' value='" + a.b.name + "' />" 
```

只要每个 A 在字段 b 中都有对 B 的引用，这就可以正常工作。但是，我在 b 参考字段上有 null=True 。当 b 为 None 时，会抛出 NoneType 没有函数名的异常，这是完全可以预料的。

显然，我可以这样做：

```
def DisplayIt(request):
    somestring = ""
    for a in A.objects.all():
        if a.b is not None:
            somestring += a.b.name 
```

但是，如果我不需要，我不想这样做。那么，如果b是None，有没有办法获得b.name或None，而不`if a.b is not None:`在每个循环中放置一个？我的现实世界的例子要复杂得多，我正在创建一个临时对象以显示实际的数据库字段......我只想说我不想拥有所有这些 if 语句，并且不确定是否存在是到达那里的另一个内置功能。我还可以创建一个类方法来获取这些外部字段中的每一个（如果它们存在），或者如果它们不存在则为空白，但我也不确定这是否是最好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T22:42:43.840

让数据库为你做这件事。

使用一个[交叉关系过滤器](https://docs.djangoproject.com/en/dev/topics/db/queries/#lookups-that-span-relationships)来获取所有`A`的 a `b`with `name`which is [not null](https://docs.djangoproject.com/en/dev/ref/models/querysets/#std%3afieldlookup-isnull)：

```
def DisplayIt(request):
    somestring = ""
    for a in A.objects.filter(b__name__isnull=False):
        somestring += a.b.name 
```

为此，当`a.b`为 None 时包含虚拟值，请使用以下命令：

```
def DisplayIt(request):
    somestring = ""
    for a in A.objects.filter(b__name__isnull=False):
        somestring += a.b.name
    for a in A.objects.filter(b__name__isnull=True):
        somestring += "dummy value for missing b.name" 
```

* * *

另外，作为旁注，不要以这种方式进行字符串连接——它的[效率非常低](http://www.skymind.com/~ocrow/python_string/)，因为 Python 字符串是不可变的。以下要好得多：

```
def DisplayIt(request):
    stringparts = []
    for a in A.objects.filter(b__name__isnull=False):
        stringparts.append(a.b.name)
    for a in A.objects.filter(b__name__isnull=True):
        stringparts.append("dummy value for missing b.name")
    ''.join(stringparts) 
```

* * *

第二个注意事项：上面的代码将在 for 循环的每次迭代中执行查询以获取 ab。那可能会超级慢。考虑使用[`select_related`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-related)一次性抓住所有东西。不过要小心 - 如果您的索引设置不正确，这也会很慢。启用此功能后，我会嗅探查询并[花一些时间与您的查询计划](https://docs.djangoproject.com/en/dev/topics/db/optimization/)器一起确保您没有进行任何令人讨厌的非索引查找。

修改后的代码：

```
def DisplayIt(request):
    stringparts = []
    for a in A.objects.filter(b__name__isnull=False).select_related():
        stringparts.append(a.b.name)
    for a in A.objects.filter(b__name__isnull=True).select_related():
        stringparts.append("dummy value for missing b.name")
    ''.join(stringparts) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T23:11:55.290

建立你的评论，说你想要A的实例可能有也可能没有B。你可以破解它来工作，这通常是一个糟糕的主意。使用你想避免的冗长的 Pythonic 方式。但这是做你想做的事情的**坏方法：**

```
a.__dict__.get('b',{'name':None}).name 
```

这使用了所有属性都存储在`dict`对象实际实例上的对象中的事实。您使用标准字典访问器`get()`来返回其中一个`b`或包含您感兴趣的属性的字典。这是一个糟糕的主意，但它确实存在。

此外，django/python 不是老式的 PHP。我不敢相信过去几周我在 stackoverflow 上看到了多少次，但是......**不要连接字符串来生成 HTML！**这就是模板语言的用途。用它。立即停止你正在做的事情。停止它停止它停止它。使用模板，不要尝试在视图中编写 HTML。这是一个可以证明是错误的事情，所以停下来。停下来。

# arrays - 使用数组的二叉树表示

> ID：10097452
> 
> 赞同：0
> 
> 时间：2012-04-10T22:36:40.273
> 
> 标签：arrays, tree, binary-tree

使用基于数组的二叉树实现而不是旧的基于节点的实现是否有任何速度/空间/一般性能提升？我理解基于数组的树的旋转或任何其他复杂修改将是可怕的，但在简单的二叉树实现的情况下，你会说通过数组来做会更好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T22:38:16.783

我猜您正在寻找[Binary Heap](http://en.wikipedia.org/wiki/Binary_heap)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T22:41:09.833

基于数组的版本不使用堆分配，因此它很可能都适合缓存，并且需要更简单的指针数学来加快遍历所需的读取量。如果您现在在编译时大小受到限制，那么它是更快的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-27T22:15:09.843

`delete`如果您的主要工作流程包括构建一棵树，然后通过一系列`delete-range`操作将其拆除，那么嵌入在数组中的二叉树可能比基于指针的树快得多。请参阅[拆解树](https://github.com/kirillkh/rs_teardown_tree)。另请参阅[此答案](https://stackoverflow.com/a/42737607/3646645)。

# drupal - drupal 7 触发器：查看特定节点类型时发送电子邮件

> ID：10097457
> 
> 赞同：0
> 
> 时间：2012-04-10T22:37:22.773
> 
> 标签：drupal, triggers

每次查看名为 MyType 的节点类型时，我都需要让 Drupal 7 向我发送电子邮件（管理员，纯文本很好）。我不想要任何其他节点类型的电子邮件。我想用最少的编程来做到这一点。drupal_mail 似乎需要大量编程（http://api.drupal.org/api/drupal/includes%21mail.inc/function/drupal_mail_system/7#comment-16454）。我可以使用触发器吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T06:16:51.867

看起来你可以使用触发器来做到这一点。在触发规则 (admin/rules/trigger) 下，使用 Event type="Content is going to be 查看" 创建一个新规则。在规则元素中，广告条件并选择“查看的内容”并选择内容类型。添加操作并选择“向任意电子邮件地址发送电子邮件”并提供收件人详细信息。我希望这会奏效。

# javascript - Splitter.js 不适用于新版本的 jQuery

> ID：10097458
> 
> 赞同：14
> 
> 时间：2012-04-10T22:37:30.277
> 
> 标签：javascript, jquery, version

```
I'm using Splitter.js in a project. 
```

代码来自[http://methvin.com/splitter/](http://methvin.com/splitter/) 具体的JS在[http://methvin.com/splitter/splitter.js](http://methvin.com/splitter/splitter.js)

使用 jQuery v1.5.2 时，代码可以正常工作。

当我移至 jQuery v1.7.2 时，代码失败，并给出“递归过多”错误。当我使用 jQuery 1.6.2 时，这似乎也会发生

有没有人有解决方法？

我确实在[https://bungeni-exist.googlecode.com/svn-history/r188/xq-framework/trunk/db/framework/assets/bungeni/scripts/splitter 找到了 splitter.js 的（更新？）版本。 js](https://bungeni-exist.googlecode.com/svn-history/r188/xq-framework/trunk/db/framework/assets/bungeni/scripts/splitter.js)，但这似乎并不能解决问题。

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-21T19:24:25.347

[在https://github.com/e1ven/jQuery-Splitter](https://github.com/e1ven/jQuery-Splitter)有一个更新的 jQuery.splitter 分支，它适用于 jQuery 1.8（如果您恢复，也可以使用 1.9 `jQuery.browser`）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-10T22:40:34.233

[UI-Layout](http://layout.jquery-dev.net/)保持最新状态并进行“拆分”等等，而且相当容易使用。

## 极简主义的例子

```
$('body').layout({ applyDemoStyles: true });
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript" src="http://layout.jquery-dev.net/lib/js/jquery.layout-latest.js"></script>
<div class="ui-layout-center">Center
	<p><a href="http://layout.jquery-dev.com/demos.html">Go to the Demos page</a></p>
	<p>* Pane-resizing is disabled because ui.draggable.js is not linked</p>
	<p>* Pane-animation is disabled because ui.effects.js is not linked</p>
</div>
<div class="ui-layout-north">North</div>
<div class="ui-layout-south">South</div>
<div class="ui-layout-east">East</div>
<div class="ui-layout-west">West</div>
```

## [复杂演示](http://layout.jquery-dev.net/demos/complex.html)

```
var layoutSettings_Outer = {
    name: "outerLayout",
    defaults: {
        size: "auto",
        minSize: 50,
        paneClass: "pane",
        resizerClass: "resizer",
        togglerClass: "toggler",
        buttonClass: "button",
        contentSelector: ".content",
        contentIgnoreSelector: "span",
        togglerLength_open: 35,
        togglerLength_closed: 35,
        hideTogglerOnSlide: true,
        togglerTip_open: "Close This Pane",
        togglerTip_closed: "Open This Pane",
        resizerTip: "Resize This Pane",
        fxName: "slide",
        fxSpeed_open: 750,
        fxSpeed_close: 1500,
        fxSettings_open: { easing: "easeInQuint" },
        fxSettings_close: { easing: "easeOutQuint" }
    },
    north: {
        spacing_open: 1,
        togglerLength_open: 0,
        togglerLength_closed: -1,
        resizable: false,
        slidable: false,
        fxName: "none"
    },
    south: {
        maxSize: 200,
        spacing_closed: 0,
        slidable: false,
        initClosed: true,
        onhide_start: function() { return confirm("START South pane hide \n\n onhide_start callback \n\n Allow pane to hide?"); },
        onhide_end: function() { alert("END South pane hide \n\n onhide_end callback"); },
        onshow_start: function() { return confirm("START South pane show \n\n onshow_start callback \n\n Allow pane to show?"); },
        onshow_end: function() { alert("END South pane show \n\n onshow_end callback"); },
        onopen_start: function() { return confirm("START South pane open \n\n onopen_start callback \n\n Allow pane to open?"); },
        onopen_end: function() { alert("END South pane open \n\n onopen_end callback"); },
        onclose_start: function() { return confirm("START South pane close \n\n onclose_start callback \n\n Allow pane to close?"); },
        onclose_end: function() { alert("END South pane close \n\n onclose_end callback"); },
        onresize_end: function() { alert("END South pane resize \n\n onresize_end callback \n\n NOTE: onresize_start event was skipped."); }
    },
    west: {
        size: 250,
        spacing_closed: 21,
        togglerLength_closed: 21,
        togglerAlign_closed: "top",
        togglerLength_open: 0,
        togglerTip_open: "Close West Pane",
        togglerTip_closed: "Open West Pane",
        resizerTip_open: "Resize West Pane",
        slideTrigger_open: "click",
        initClosed: true,
        fxSettings_open: { easing: "easeOutBounce" }
    },
    east: {
        size: 250,
        spacing_closed: 21,
        togglerLength_closed: 21,
        togglerAlign_closed: "top",
        togglerLength_open: 0,
        togglerTip_open: "Close East Pane",
        togglerTip_closed: "Open East Pane",
        resizerTip_open: "Resize East Pane",
        slideTrigger_open: "mouseover",
        initClosed: true,
        fxName: "drop",
        fxSpeed: "normal",
        fxSettings: { easing: "" }
    },
    center: {
        paneSelector: "#mainContent",
        minWidth: 200,
        minHeight: 200
    }
};
$(function() {
	var outerLayout, innerLayout;
	outerLayout = $("body").layout(layoutSettings_Outer);
	outerLayout.addToggleBtn("#tbarToggleNorth", "north");
	outerLayout.addOpenBtn("#tbarOpenSouth", "south");
	outerLayout.addCloseBtn("#tbarCloseSouth", "south");
	outerLayout.addPinBtn("#tbarPinWest", "west");
	outerLayout.addPinBtn("#tbarPinEast", "east");

	var westSelector = "body > .ui-layout-west",
		eastSelector = "body > .ui-layout-east";
	$("<span></span>").addClass("pin-button").prependTo(westSelector);
	$("<span></span>").addClass("pin-button").prependTo(eastSelector);
	outerLayout.addPinBtn(westSelector + " .pin-button", "west");
	outerLayout.addPinBtn(eastSelector + " .pin-button", "east");
	$("<span></span>").attr("id", "west-closer").prependTo(westSelector);
	$("<span></span>").attr("id", "east-closer").prependTo(eastSelector);

	outerLayout.addCloseBtn("#west-closer", "west");
	outerLayout.addCloseBtn("#east-closer", "east");

	$("a").each(function() {
	var path = document.location.href;
		if (path.substr(path.length - 1) == "#") path = path.substr(0, path.length - 1);
		if (this.href.substr(this.href.length - 1) == "#") this.href = path + "#";
	});
});
```

```
body { font-size: 85%; }
```

```
<link href="http://layout.jquery-dev.net/demos/css/complex.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript" src="http://layout.jquery-dev.net/lib/js/jquery.layout-latest.js"></script>
<script type="text/javascript" src="http://layout.jquery-dev.net/demos/js/complex.js"></script>
<script type="text/javascript" src="http://layout.jquery-dev.net/lib/js/debug.js"></script>

<div class="ui-layout-west">
	<div class="header">Outer - West</div>
	<div class="content">
		<h3><b>Outer Layout</b></h3>
		<ul>
			<li><a href="#" onClick="outerLayout.toggle('north')">Toggle North</a></li>
			<li><a href="#" onClick="outerLayout.toggle('south')">Toggle South</a></li>
			<li><a href="#" onClick="outerLayout.toggle('west')"> Toggle West</a></li>
			<li><a href="#" onClick="outerLayout.toggle('east')"> Toggle East</a></li>
			<li><a href="#" onClick="outerLayout.hide('north')">Hide North</a></li>
			<li><a href="#" onClick="outerLayout.hide('south')">Hide South</a></li>
			<li><a href="#" onClick="outerLayout.show('south', false)">Unhide South</a></li>
			<li><a href="#" onClick="outerLayout.hide('east')"> Hide East</a></li>
			<li><a href="#" onClick="outerLayout.show('east', false)">Unhide East</a></li>
			<li><a href="#" onClick="outerLayout.open('east')"> Open East</a></li>
			<li><a href="#" onClick="outerLayout.open('north'); outerLayout.sizePane('north', 'auto')">  Resize North="auto"</a></li>
			<li><a href="#" onClick="outerLayout.sizePane('north', 100); outerLayout.open('north')">  Resize North=100</a></li>
			<li><a href="#" onClick="outerLayout.sizePane('north', 300); outerLayout.open('north')">  Resize North=300</a></li>
			<li><a href="#" onClick="outerLayout.sizePane('north', 10000); outerLayout.open('north')">Resize North=10000</a></li>
			<li><a href="#" onClick="outerLayout.open('south'); outerLayout.sizePane('south', 'auto')">  Resize South="auto"</a></li>
			<li><a href="#" onClick="outerLayout.sizePane('south', 100); outerLayout.open('south')">  Resize South=100</a></li>
			<li><a href="#" onClick="outerLayout.sizePane('south', 300); outerLayout.open('south')">  Resize South=300</a></li>
			<li><a href="#" onClick="outerLayout.sizePane('south', 10000); outerLayout.open('south')">Resize South=10000</a></li>
			<li><a href="#" onClick="outerLayout.panes.north.css('backgroundColor','#FCC')">North Color = Red</a></li>
			<li><a href="#" onClick="outerLayout.panes.north.css('backgroundColor','#CFC')">North Color = Green</a></li>
			<li><a href="#" onClick="outerLayout.panes.north.css('backgroundColor','')">    North Color = Default</a></li>
			<li><a href="#" onClick="alert('outerLayout.name = \''+outerLayout.options.name+'\'')">Show Layout Name</a></li>
			<li><a href="#" onClick="showOptions(outerLayout,'defaults')">Show Options.Defaults</a></li>
			<li><a href="#" onClick="showOptions(outerLayout,'north')">   Show Options.North</a></li>
			<li><a href="#" onClick="showOptions(outerLayout,'south')">   Show Options.South</a></li>
			<li><a href="#" onClick="showOptions(outerLayout,'west')">    Show Options.West</a></li>
			<li><a href="#" onClick="showOptions(outerLayout,'east')">    Show Options.East</a></li>
			<li><a href="#" onClick="showOptions(outerLayout,'center')">  Show Options.Center</a></li>
			<li><a href="#" onClick="showState(outerLayout,'container')"> Show State.Container</a></li>
			<li><a href="#" onClick="showState(outerLayout,'north')">     Show State.North</a></li>
			<li><a href="#" onClick="showState(outerLayout,'south')">     Show State.South</a></li>
			<li><a href="#" onClick="showState(outerLayout,'west')">      Show State.West</a></li>
			<li><a href="#" onClick="showState(outerLayout,'east')">      Show State.East</a></li>
			<li><a href="#" onClick="showState(outerLayout,'center')">    Show State.Center</a></li>
		</ul>
	</div>

	<div class="footer">Automatically positioned footer</div>
</div>
<div class="ui-layout-east">
	<div class="header">Outer - East</div>
	<div class="subhead">I'm a subheader</div>
	<div class="content">
		<h3><b>Inner Layout</b></h3>
		<ul id="createInner">
			<li><a href="#" onClick="createInnerLayout(); return false;">CREATE Inner Layout</a></li>
		</ul>
		<ul id="innerCommands" style="display: none;">
			<li><a href="#" onClick="innerLayout.toggle('north')">Toggle North</a></li>
			<li><a href="#" onClick="innerLayout.toggle('south')">Toggle South</a></li>
			<li><a href="#" onClick="innerLayout.toggle('west')"> Toggle West</a></li>
			<li><a href="#" onClick="innerLayout.toggle('east')"> Toggle East</a></li>
			<li><a href="#" onClick="innerLayout.hide('north')">Hide North</a></li>
			<li><a href="#" onClick="innerLayout.hide('south')">Hide South</a></li>
			<li><a href="#" onClick="innerLayout.hide('west')"> Hide West</a></li>
			<li><a href="#" onClick="innerLayout.hide('east')"> Hide East</a></li>
			<li><a href="#" onClick="innerLayout.show('east')"> Show East</a></li>
			<li><a href="#" onClick="innerLayout.sizePane('north', 50); innerLayout.open('north')">   Resize North=50</a></li>
			<li><a href="#" onClick="innerLayout.sizePane('north', 300); innerLayout.open('north')">  Resize North=300</a></li>
			<li><a href="#" onClick="innerLayout.sizePane('north', 10000); innerLayout.open('north')">Resize North=10000</a></li>
			<li><a href="#" onClick="innerLayout.sizePane('south', 50); innerLayout.open('south')">   Resize South=50</a></li>
			<li><a href="#" onClick="innerLayout.sizePane('south', 300); innerLayout.open('south')">  Resize South=300</a></li>
			<li><a href="#" onClick="innerLayout.sizePane('south', 10000); innerLayout.open('south')">Resize South=10000</a></li>
			<li><a href="#" onClick="innerLayout.panes.north.css('backgroundColor','#FCC')">North Color = Red</a></li>
			<li><a href="#" onClick="innerLayout.panes.north.css('backgroundColor','#CFC')">North Color = Green</a></li>
			<li><a href="#" onClick="innerLayout.panes.north.css('backgroundColor','')">    North Color = Default</a></li>
			<li><a href="#" onClick="alert('innerLayout.name = \''+innerLayout.options.name+'\'')">Show Layout Name</a></li>
			<li><a href="#" onClick="showOptions(innerLayout,'defaults')">Show Options.Defaults</a></li>
			<li><a href="#" onClick="showOptions(innerLayout,'north')">   Show Options.North</a></li>
			<li><a href="#" onClick="showOptions(innerLayout,'south')">   Show Options.South</a></li>
			<li><a href="#" onClick="showOptions(innerLayout,'west')">    Show Options.West</a></li>
			<li><a href="#" onClick="showOptions(innerLayout,'east')">    Show Options.East</a></li>
			<li><a href="#" onClick="showOptions(innerLayout,'center')">  Show Options.Center</a></li>
			<li><a href="#" onClick="showState(innerLayout,'container')"> Show State.Container</a></li>
			<li><a href="#" onClick="showState(innerLayout,'north')">     Show State.North</a></li>
			<li><a href="#" onClick="showState(innerLayout,'south')">     Show State.South</a></li>
			<li><a href="#" onClick="showState(innerLayout,'west')">      Show State.West</a></li>
			<li><a href="#" onClick="showState(innerLayout,'east')">      Show State.East</a></li>
			<li><a href="#" onClick="showState(innerLayout,'center')">    Show State.Center</a></li>
		</ul>
	</div>
	<div class="footer">I'm a footer</div>
	<div class="footer">I'm another footer</div>
	<div class="footer">Unlimited headers &amp; footers</div>
</div>
<div class="ui-layout-north">
	<div class="header">Outer - North</div>
	<div class="content">
		I only have toggler when 'closed' - I cannot be resized - and I do not 'slide open'
	</div>
	<ul class="toolbar">
		<li id="tbarToggleNorth" class="first"><span></span>Toggle NORTH</li>
		<li id="tbarOpenSouth"><span></span>Open SOUTH</li>
		<li id="tbarCloseSouth"><span></span>Close SOUTH</li>
		<li id="tbarPinWest"><span></span>Pin/Unpin WEST</li>
		<li id="tbarPinEast" class="last"><span></span>Pin/Unpin EAST</li>
	</ul>
</div>
<div class="ui-layout-south">
	<div class="header">Outer - South</div>
	<div class="content">
		<p>I only have a resizer/toggler when 'open'</p>
	</div>
</div>
<div id="mainContent">
	<div class="ui-layout-center">
		<h3 class="header">Inner - Center</h3>
		<div class="ui-layout-content">
			<p id="createInner2" style="font-weight: bold;"><a href="#" onClick="createInnerLayout(); return false;">Click here to CREATE the Inner Layout</a></p>
			<p>See the <a href="#" onclick="outerLayout.open('east'); return false;">Outer-East pane</a> for commands to manipulate the Inner Layout</p>
			<p><a href="../demos.html">Go to the Demos page</a></p>
			<p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p>
			<p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p>
			<p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p>
			<p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p>
		</div>
		<div class="footer">Center panes can have headers &amp; footers too</div>
	</div>

	<div class="ui-layout-north"> Inner - North</div>
	<div class="ui-layout-south"> Inner - South</div>
	<div class="ui-layout-west">  Inner - West</div>
	<div class="ui-layout-east">  Inner - East
		<p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p>
		<p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p>
		<p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p>
		<p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p><p>...</p>
	</div>

</div>
```

## [高级复杂演示](http://layout.jquery-dev.com/demos/layouts_inside_tabs.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-18T21:10:36.173

我在将网站升级到 jQuery 1.8 的过程中遇到了同样的问题。经过一些调试并在代码中四处寻找，在我看来有两个问题：在一些地方不必要地触发了调整大小事件，并且在设置拆分器的调整大小事件处理程序之前在拆分器上触发了它. 我切换了最后两块代码的顺序，以确保首先设置拆分器的调整大小事件处理程序并整理几行。现在看起来像这样：

```
 // Resize event handler
  splitter.bind("resize", function(e, size){
    // Determine new width/height of splitter container
    splitter._DF = splitter[0][opts.pxFixed] - splitter._PBF;
    splitter._DA = splitter[0][opts.pxSplit] - splitter._PBA;
    // Bail if splitter isn't visible or content isn't there yet
    if ( splitter._DF <= 0 || splitter._DA <= 0 ) return;
    // Re-divvy the adjustable dimension; maintain size of the preferred pane
    resplit(!isNaN(size)? size : (!(opts.sizeRight||opts.sizeBottom)? A[0][opts.pxSplit] :
        splitter._DA-B[0][opts.pxSplit]-bar._DA));
    e.stopPropagation();
  });

  // Resize event propagation and splitter sizing
  if ( opts.anchorToWindow ) {
    // Account for margin or border on the splitter container and enforce min height
    splitter._hadjust = dimSum(splitter, "borderTopWidth", "borderBottomWidth", "marginBottom");
    splitter._hmin = Math.max(dimSum(splitter, "minHeight"), 20);
    splitter._bottomOffset = opts.bottomOffset ? opts.bottomOffset : 0;
    $(window).bind("resize", function(){
      var top = splitter.offset().top;
      var wh = $(window).height() - splitter._bottomOffset;
      splitter.css("height", Math.max(wh-top-splitter._hadjust, splitter._hmin)+"px");
      splitter.trigger("resize");
    }).trigger("resize");
  }
  else if ( opts.resizeToWidth )
    $(window).bind("resize", function(){
      splitter.trigger("resize");
    }); 
```

另外，请确保删除

```
if ( !$.browser.msie ) panes.trigger("resize"); 
```

来自 reSplit 函数。如果您想在一个地方查看所有内容，我已将整个内容上传到[GitHub 存储库。](https://github.com/jhbwood/jquery-splitter)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-06T02:15:48.457

我遇到了同样的问题。在 splitter.js 文件中查看了一段时间后，我遇到了这段代码：

```
// Resize event handler; triggered immediately to set initial position
    splitter.bind("resize", function(e, size){          
        // Custom events bubble in jQuery 1.3; don't get into a Yo Dawg
        if ( e.target != this ) return;

        ......

    }).trigger("resize" , [initPos]); 
```

“哟 dawg” 参考是死赠品:)

果然，在 Chrome 中调试后，在这个特定的事件处理函数中存在过多的递归。编写它的开发人员试图解决该问题，但由于某种原因，较新版本的 JQuery 库无法按预期工作，并且从未满足转义条件。据我所知，这段特定的代码仅在页面加载期间用于设置拆分器的初始位置。我发现除了堆栈溢出之外，拆分器仍然可以使用，我注意到这个问题的唯一原因是因为我的 javascript 代码在初始化拆分器后没有运行。如果您有时间，请查看是否可以找出这部分代码不起作用的原因并发布修复。如果您赶时间并且不介意胶带，请在您调用 . 拆分器（）函数。它似乎在 Chrome 19 和 IE 9 中都能正常工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-06T20:45:17.853

根据 Steven Hunt 的回答，我有一个解决方法，方法是添加 try/catch 块并删除递归调用。

用这个修改后的版本替换下面的块（从第 149 行开始）-

```
 try
        {

          if ( opts.anchorToWindow ) {
            // Account for margin or border on the splitter container and enforce min height
            splitter._hadjust = dimSum(splitter, "borderTopWidth", "borderBottomWidth", "marginBottom");
            splitter._hmin = Math.max(dimSum(splitter, "minHeight"), 20);
            $(window).bind("resize", function(){
                var top = splitter.offset().top;
                var wh = $(window).height();
                splitter.css("height", Math.max(wh-top-splitter._hadjust, splitter._hmin)+"px");
            }).trigger("resize");

          }
          else if ( opts.resizeToWidth && !$.browser.msie )
            $(window).bind("resize", function(){
                splitter.trigger("resize"); 
            });
          }
        catch(err)
        {
        } 
```

# html - 当存在行跨度时添加行边框的最简单方法是什么？

> ID：10097459
> 
> 赞同：0
> 
> 时间：2012-04-10T22:37:35.517
> 
> 标签：html, css, css-tables

我有一个`table`，其中一半的细胞是`rowspan="2"`，另一半不是。请参阅[演示](http://jsfiddle.net/4vyAX/1/)。

我想要每个“实际”行之间的边界。这意味着对于 H1 和 H2，它需要在每一行上。但是对于 H3 和 H4，它需要在每隔一行上。

使用 CSS 最优雅的方法是什么？我宁愿不必在每个人身上都加上一个类名来让它`td`工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:41:57.540

从您自己的小提琴开始，只需将选择器[更改](http://jsfiddle.net/4vyAX/3/)为. 由于表格和单元格的边框宽度不同，底部生成的边框不统一，但这也很容易纠正。`(even)``(odd)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T22:43:08.613

只需使用and[将标题与实际行分开](http://jsfiddle.net/4vyAX/2/)即可。然后只对行进行样式设置。当然，您仍然可以设置标题的样式，但是将表格标题与内容分开是很好的标记。`<thead>``<tbody>``<tbody>`

```
<table>
    <thead>
        <tr>
            <th>H1</th>  
            <th>H2</th> 
            <th>H3</th> 
            <th>H4</th>  
        </tr>        
    </thead>
    <tbody>
        <tr>
          <td rowspan="2">1</td>
          <td rowspan="2">2</td>
          <td>3a</td>
          <td>4a</td>
        </tr>
        ...

/* Style in question: */
tbody tr:nth-child(even) {
    border-bottom: 2px solid #BBB;
} 
```

# android - 不可见时按钮不起作用

> ID：10097460
> 
> 赞同：0
> 
> 时间：2012-04-10T22:37:37.500
> 
> 标签：android, xml, layout, button

我有一个背景，我把它放在我的应用程序中，并且有一些按钮应该去的地方。因此，当我将所有按钮排成一行时，我会将按钮设置为不可见，这样当您打开应用程序时就不会看到它们。但是当我这样做时，它是不可见的，但它们没有不可见的按钮。我应该能够单击放置按钮的区域。对？

感谢你的帮助！

```
Button
    android:id="@+id/start1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" 
    android:height="75dp" 
    android:width="150dp" 
    android:layout_marginLeft="15dp" 
    android:layout_marginTop="93dp" 
    android:visibility="visible" **(After I switch this to invisible the button doesn't work)**
    android:clickable="true"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T22:41:20.703

您应该将按钮背景设置为您想要的背景，您需要可见性。

可见=可见。能够与不可见的=不可见的交互。此视图的空间仍被占用但无法交互消失 = 根本不存在，没有空间占用，无法交互

# trigonometry - 如何计算点“沿”单位圆弧度

> ID：10097461
> 
> 赞同：-1
> 
> 时间：2012-04-10T22:37:42.020
> 
> 标签：trigonometry, geometry

看到这张图片：http: [//i.stack.imgur.com/hqKjE.png](http://i.stack.imgur.com/hqKjE.png)

给定 P1 和圆半径，是否有计算 P2 的方法？

我能够获得 P1 处的角度，以及由在圆内形成的三角形定义的相关距离和点（其斜边沿 P1 和 P1。）

我认为解决方案与P1的角度有关......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:06:59.933

使用 和 之间的距离`r`和`P1`方向`P2`角`t`

```
P2.X = P1.X + r*COS(t)
P2.Y = P2.Y - r*SIN(t) 
```

请注意，角度`t`以弧度或 为单位`t=π/180*degrees`。

# c++ - std::vector 不是异常安全的？

> ID：10097466
> 
> 赞同：1
> 
> 时间：2012-04-10T22:38:26.843
> 
> 标签：c++, vector

我听说过几次提到`std::vector`存储原始指针时不是异常安全的，应该使用`unique_ptr`or`shared_ptr`代替。

我的问题是，为什么`std::vector`不是异常安全的，这些类如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T22:48:09.007

这`std::vector`不是异常安全的，它使用原始指针进行内存管理：

```
int main()
{
    try
    {
        int* i = new int;

        throw "oops, memory leak!";
    }
    catch (...){}
} 
```

这与向量本身无关，只是这样做是完全相同的问题：

```
int main()
{
    try
    {
        std::vector<int*> vi;
        vi.push_back(new int);

        throw "oops, memory leak!";
    }
    catch (...){}
} 
```

这两个都是通过使用智能指针来修复的：

```
int main()
{
    try
    {
        std::unique_ptr<int> i(new int);

        std::vector<std::unique_ptr<int>> vi;
        vi.push_back(std::unique_ptr<int>(new int));
        vi.push_back(std::move(i));

        throw "vector destroys unique_ptr's...which delete their memory";
    }
    catch (...){}
} 
```

（或者`shared_ptr`，更昂贵。您也可以使用来自 Boost 的指针容器。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T22:45:51.377

通过“非异常安全”，我认为它们意味着如果向量在异常期间被展开破坏，则会出现内存泄漏。

Shared_ptr 确保当向量本身被销毁时，指针指向的对象被删除。

另一种选择是[Boost 指针容器](http://www.boost.org/libs/ptr_container/)。

# macos - 导出 Mac OSX 的 Processing.org 应用程序时将音频文件放在哪里？

> ID：10097474
> 
> 赞同：0
> 
> 时间：2012-04-10T22:39:24.153
> 
> 标签：macos, audio, export, processing

我正在使用 Mac 并尝试导出我的应用程序以在 Mac 上使用。我在我的应用程序中访问了两个小音频文件，但这些文件不会被复制到 application.macosx 文件夹中。

当我在我的计算机上运行应用程序时，我可以将音频文件复制到 application.macosx 文件夹中并且应用程序可以工作。如果我不将音频文件复制到 application.macosx 文件夹中，应用程序将无法完全启动。

我正在寻找一种包含这些音频文件的方法，因此我只需发送使用应用程序文件即可。我不想向他们发送 application.macosx 文件夹。我尝试将音频文件添加到“应用程序包”中的每个位置，但没有任何效果。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T16:32:41.580

尝试使用草图的相对路径（无论在哪里执行）。有一个名为的内置属性`sketchPath`对此非常方便。您可以将文件放在草图路径上方一层，例如：

```
String path = sketchPath+"/../yourFile.mp3"; 
```

由你决定。要检查路径是否正确，您可以尝试以下操作：

```
println("does " + path + " exist? : " + new File(path).exists()); 
```

另一个想法是使用将提示文件位置的[selectInput() 。](http://processing.org/reference/selectInput_.html)尝试在 selectInput() 返回的字符串上使用 sketchPath() 函数（应该格式化相对于草图的路径）可能会很方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T16:12:18.787

好的...这是您需要做的。

在旧时代（我在想 Xcode 4 之前的版本），在 Macintosh 上创建新应用程序时，会自动创建一个“资源”文件夹，可以在其中放置 Macintosh 应用程序将使用的图像、声音文件等。（“资源”本身是“经典 MacOS”时代的遗留物，当时几乎所有内容都嵌入到 .rsrc 文件中......但我离题了）。

现在，当设置新的 Macintosh 应用程序项目时，Xcode 4 将创建一个“支持文件”组，而不是“资源”组。

因此，要解决您的问题，请将您的音频文件导入或拖放到项目中的“支持文件”组中，然后它们应该最终会出现在您的应用程序包中。当我构建这个测试应用程序时，.wav 文件最终位于应用程序包的“资源”文件夹中。

我将一个 .wav 文件复制到一个测试项目中，如下所示： ![声音文件进入支持文件](../Images/a03dcd2d6043f9f09b2154af55e8252e.png)

希望我的回答能帮到你！

# java - 在通知中制作特定歌曲

> ID：10097476
> 
> 赞同：0
> 
> 时间：2012-04-10T22:39:48.180
> 
> 标签：java, android, notifications

当我收到通知时，是否可以从原始文件夹开始制作歌曲？我尝试使用此代码使歌曲“警报”开始，但没有任何反应。

```
NotificationManager notificationManager = (NotificationManager) context
        .getSystemService(Context.NOTIFICATION_SERVICE);
Notification notification = new Notification(R.drawable.beatdanger,
        "Your friend is in danger!!!", System.currentTimeMillis());
// Hide the notification after its selected
notification.flags |= Notification.FLAG_AUTO_CANCEL;

notification.sound = Uri.parse("R.raw.alert");

Intent intent1 = new Intent("wael.ilahi.pfe.SMSRECEIVERESULT");
intent1.putExtra("coordination", str);
PendingIntent pendingIntent = PendingIntent.getActivity(context, 0,
        intent1, 0);
notification.setLatestEventInfo(context, "Help your friend !!",
        str, pendingIntent);
notificationManager.notify(0, notification); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:13:38.743

[请参阅Android 通知文档](http://developer.android.com/guide/topics/ui/notifiers/notifications.html#Sound)中的“添加声音”一章。

您的问题似乎是，您给`notification`-object 一个错误的 URI:`"R.raw.alert"`无效。

相反，如果您需要获取存储在`res/raw/`-directory 中的文件的 URI，请使用此模式：`"android.resource://" + getPackageName() + "/" + R.raw.your_raw_file`如下所述：[如何在 android 中从 assets 文件夹或 raw 文件夹播放视频？](https://stackoverflow.com/a/8616187/717341)

# python - python JSON数组换行符

> ID：10097477
> 
> 赞同：15
> 
> 时间：2012-04-10T22:39:50.413
> 
> 标签：python, json

我有一个大字典，里面有一些大数组数据：

```
d = {'something': {'else': 'x'}, 'longnumbers': [1,2,3,4,54,6,67,7,7,8,8,8,6,4,3,3,5,6,7,4,3,5,6,54]} 
```

真正的字典有更多的键和嵌套结构。当我使用`json.dump`without`indent`时，我得到一个不可读的紧凑单行输出。当我设置`indent`时，它会在每个分隔符之后放置换行符，包括数组。

数值数组很长，最终如下所示：

```
 "longnumbers": [
    1, 
    2, 
    3, 
    4, 
    54, 
    6, 
    67, 
    7, 
    7, 
    8, 
    8, 
    8, 
    6, 
    4, 
    3, 
    3, 
    5, 
    6, 
    7, 
    4, 
    3, 
    5, 
    6, 
    54
  ], 
```

有什么办法可以得到带有缩进级别的漂亮打印的 JSON，但不在数组元素之后放置换行符？对于上面的例子，我想要这样的东西：

```
{
  "longnumbers": [1, 2, 3, 4, 54, 6, 67, 7, 7, 8, 8, 8, 6, 4, 3, 3, 5, 6, 7, 4, 3, 5, 6, 54],
  "something": {
    "else": "x"
  }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-02T19:05:01.323

我最终只是编写了自己的 JSON 序列化程序：

```
import numpy

INDENT = 3
SPACE = " "
NEWLINE = "\n"

def to_json(o, level=0):
    ret = ""
    if isinstance(o, dict):
        ret += "{" + NEWLINE
        comma = ""
        for k,v in o.iteritems():
            ret += comma
            comma = ",\n"
            ret += SPACE * INDENT * (level+1)
            ret += '"' + str(k) + '":' + SPACE
            ret += to_json(v, level + 1)

        ret += NEWLINE + SPACE * INDENT * level + "}"
    elif isinstance(o, basestring):
        ret += '"' + o + '"'
    elif isinstance(o, list):
        ret += "[" + ",".join([to_json(e, level+1) for e in o]) + "]"
    elif isinstance(o, bool):
        ret += "true" if o else "false"
    elif isinstance(o, int):
        ret += str(o)
    elif isinstance(o, float):
        ret += '%.7g' % o
    elif isinstance(o, numpy.ndarray) and numpy.issubdtype(o.dtype, numpy.integer):
        ret += "[" + ','.join(map(str, o.flatten().tolist())) + "]"
    elif isinstance(o, numpy.ndarray) and numpy.issubdtype(o.dtype, numpy.inexact):
        ret += "[" + ','.join(map(lambda x: '%.7g' % x, o.flatten().tolist())) + "]"
    elif o is None:
        ret += 'null'
    else:
        raise TypeError("Unknown type '%s' for json serialization" % str(type(o)))
    return ret 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-08-16T01:51:38.953

呃，现在应该是为两种不同的 JSON 容器类型指定不同缩进的选项。如果您想与核心 Python JSON 库保持兼容，另一种方法是覆盖该`_make_iterencode()`库中负责处理的函数（当前）`indent`。

在[重新实现 _make_iterencode() 时遇到了问题](https://github.com/sam-at-github/_make_iterencode.py)。只需更改几[行](https://github.com/sam-at-github/_make_iterencode.py/commit/7f87dd8d462aa30de97aeb52dbc594784e317bfa)即可`indent`选择，可选地采用 tuple `(hash-indent, array-indent)`。但不幸的是，必须更换一个整体`_make_iterencode()`，结果证明它相当大且分解不良。无论如何，以下适用于 3.4-3.6：

```
import sys
import json

dat = {"b": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "a": 1, "c": "x"}
indent = 2
print(json.dumps(dat, indent=indent))

if sys.version_info.major == 3 and 4 <= sys.version_info.minor <= 6:
  import _make_iterencode
  json.encoder._make_iterencode = _make_iterencode._make_iterencode
  indent = (2, None)

print(json.dumps(dat, indent=indent)) 
```

**给出**：

```
{
  "c": "x",
  "a": 1,
  "b": [
    1,
    2,
    3,
    4,
    5,
    6,
    7,
    8,
    9,
    10
  ]
}
{
  "c": "x",
  "a": 1,
  "b": [1,2,3,4,5,6,7,8,9,10]
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-07-29T20:45:45.113

@jterrace 的答案是为 Python 2 编写的，它已被 Python 3 弃用，并更改了类型。因此，由于他的回答得到了应有的认可，我对其进行了一些调整以供我个人使用并与 Python 3 兼容，包括支持将元组作为列表：

```
import numpy

INDENT = 3
SPACE = " "
NEWLINE = "\n"

# Changed basestring to str, and dict uses items() instead of iteritems().
def to_json(o, level=0):
  ret = ""
  if isinstance(o, dict):
    ret += "{" + NEWLINE
    comma = ""
    for k, v in o.items():
      ret += comma
      comma = ",\n"
      ret += SPACE * INDENT * (level + 1)
      ret += '"' + str(k) + '":' + SPACE
      ret += to_json(v, level + 1)

    ret += NEWLINE + SPACE * INDENT * level + "}"
  elif isinstance(o, str):
    ret += '"' + o + '"'
  elif isinstance(o, list):
    ret += "[" + ",".join([to_json(e, level + 1) for e in o]) + "]"
  # Tuples are interpreted as lists
  elif isinstance(o, tuple):
    ret += "[" + ",".join(to_json(e, level + 1) for e in o) + "]"
  elif isinstance(o, bool):
    ret += "true" if o else "false"
  elif isinstance(o, int):
    ret += str(o)
  elif isinstance(o, float):
    ret += '%.7g' % o
  elif isinstance(o, numpy.ndarray) and numpy.issubdtype(o.dtype, numpy.integer):
    ret += "[" + ','.join(map(str, o.flatten().tolist())) + "]"
  elif isinstance(o, numpy.ndarray) and numpy.issubdtype(o.dtype, numpy.inexact):
    ret += "[" + ','.join(map(lambda x: '%.7g' % x, o.flatten().tolist())) + "]"
  elif o is None:
    ret += 'null'
  else:
    raise TypeError("Unknown type '%s' for json serialization" % str(type(o)))
  return ret 
```

# java - Java - 如果您可以扩展任何类，那么抽象的意义何在？

> ID：10097481
> 
> 赞同：1
> 
> 时间：2012-04-10T22:40:08.180
> 
> 标签：java, interface, abstract-class, extends

所以抽象类可以扩展，但是任何类都可以吗？那么为什么一些特定的类是抽象的而另一些不是呢？

此外，我试图弄清楚，但我总是很困惑，但接口和抽象类之间的实际区别是什么？

感谢任何可以为我解决这个问题的人！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T22:45:38.947

接口只能描述方法签名，例如

```
public void add(int a, int b); 
```

实现它的类必须定义方法。

一个抽象类只能被继承，但它仍然可以定义一个方法：

```
public void add(int a, int b) {
    return a+b;
} 
```

任何实现它的类都可以使用该方法。抽象类也可以实现`final`方法，因此它们永远不能被扩展它的类重新实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-10T22:47:41.223

抽象类的用处在于分解几个类共有的功能（方法和属性）。此外，说任何类都可以扩展是不正确的，最终类不能扩展。

抽象类与接口不同，因为接口只定义了一个功能契约：需要完成*什么，但从不指示**如何*实现它，而抽象类可以充实一些通用的*抽象*实现细节，但将具体方面保持开放由其子类实现。在某种程度上，抽象类就像接口和具体类之间的中间点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-10T22:50:55.637

抽象类的重点是有意义的默认行为。

抽象类可以在那些有意义的方法中提供有意义的默认实现，并且只留下抽象方法供客户实现。*如果客户愿意*，客户可以选择覆盖这些默认实现。

接口没有提供这样的机会；它们都是必须由客户端实现的抽象方法。

这不是一个非此即彼的命题；通常两者都提供。例如，参见`java.util.Map`and 。`java.util.AbstractMap`

# ssi - 如何有条件地禁用服务器端包括

> ID：10097485
> 
> 赞同：1
> 
> 时间：2012-04-10T22:40:31.110
> 
> 标签：ssi

我有一种情况，我将内容从 CMS 提取到 spring webapp 中。现在我们想在 CMS 中为作者提供一个选项，以在 apache 提供的 html 上添加或删除 spring 应用程序页眉和页脚。此决定应根据在 CMS 上完成的设置在服务器上完成。我们决定使用服务器端包含来做决定。现在棘手的部分是我如何让 apache 服务器忽略一些服务器端包含并根据 CMS 设置处理其余部分。代码类似于以下

* * *

< ! -- #include virtual="/webApp/globalHeaderWrapper" -->

CMS 数据进入此处。

< !-- #include virtual="/webApp/globalFooterWrapper" -->

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:52:02.137

设置[环境变量](https://stackoverflow.com/questions/10627064/is-the-value-of-rewritebase-available-as-a-variable-reference/11299157#11299157)并使用条件包括：

```
<!--#if expr="$CMSHEADER = /^true$/" -->
  <!--#include virtual="/webApp/globalHeaderWrapper" -->
<!--#endif --> 
```

# objective-c - Xcode 链接失败消息 - 这是什么意思？

> ID：10097489
> 
> 赞同：1
> 
> 时间：2012-04-10T22:40:48.870
> 
> 标签：objective-c, ios, xcode

我收到以下错误消息： **链接器命令失败，退出代码为 1（使用 -v 查看调用）**

Apple 的“您的第三个 iOS 应用程序”演示程序正在发生这种情况。没有显示动态错误。错误消息详细信息继续说； **ld：重复符号 _OBJC_IVAR_$_STESimpleTextDocument._documentText 在 /Users/chris/Library/...**

我仔细查看了 _documentText ivar 中的代码，以及 Apple 文档中的剪切和粘贴代码，但我仍然遇到同样的错误？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T03:04:33.667

有一次，在深夜编码的时候，我不小心打字了

```
#import "fubar.m" 
```

代替

```
#import "fubar.h" 
```

在“fubar2.m”文件中，

并得到了这种奇怪的链接器错误。

编译器在读取“fubar2.m”时编译类方法一次，在读取 fubar.m 时再次编译。

我很惭愧地说，在我发现这个错误之前，我不得不离开这个项目并回到它。

# c# - 可以通过触摸 MonoTouch.Dialog 中的单元格外部来关闭键盘吗？

> ID：10097490
> 
> 赞同：0
> 
> 时间：2012-04-10T22:40:49.883
> 
> 标签：c#, ios, xamarin.ios, monotouch.dialog

> **可能重复：**
> [MonoTouch.Dialog：通过触摸 DialogViewController 中的任何位置来关闭键盘](https://stackoverflow.com/questions/10824092/monotouch-dialog-dismissing-keyboard-by-touching-anywhere-in-dialogviewcontroll)

我注意到，当触摸表格单元格（我认为是“部分”）之外时，不会调用 touchesBegan 方法，因此我无法调用`EndEditing`or `ResignFirstReponder`。

我正在创建一个多行条目元素；正因为如此，返回键转到新行而不是“返回”。这是预期的行为。但是，那时我无法关闭键盘。

我注意到在 iPhone 上的菜单设置（常规->键盘->快捷方式）或输入凭据时，触摸外部区域不会让响应者退出。这是否意味着这是整个 iOS 的限制（或者 Apple 在这些情况下认为不合适）？

有没有办法做到这一点？

据我所知，这里有一个相同的问题，但没有人想出一个有效的答案：
[我可以通过触摸 DialogViewController (MonoTouch.Dialog) 的背景来关闭 iPhone 键盘吗？](https://stackoverflow.com/questions/3463778/can-i-dismiss-the-iphone-keyboard-by-touching-the-background-of-dialogviewcontro)

也许在一年半内有人解决了它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T16:50:16.917

miguel.de.icaza 在另一个线程上回答了这个问题： [https](https://stackoverflow.com/a/10864640/1134836) ://stackoverflow.com/a/10864640/1134836 。

他的解决方案：

> ```
>  var tap = new UITapGestureRecognizer ();
>    tap.AddTarget (() =>{
>        dvc.View.EndEditing (true);
>    });
>    dvc.View.AddGestureRecognizer (tap); 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:42:34.273

我认为你有两个选择：

*   在某处放置一个“完成”按钮
*   在视图的背景上连接触摸事件以关闭

我认为第一个选项更好，因为它是 Safari 所做的。

您可以在键盘顶部附加一个工具栏来模拟 Safari 对`InputAccessoryView`. 这是在 Obj-C 中执行此操作的示例（应该很容易移植）： http: [//gabriel-tips.blogspot.com/2011/05/input-accessory-view-how-to-add-extra.html](http://gabriel-tips.blogspot.com/2011/05/input-accessory-view-how-to-add-extra.html)

但是，如果屏幕空间很紧，它可能不适用于您的布局。在这种情况下使用选项#2。

# java - 在 Java 中调用和接收 Python 脚本的输出？

> ID：10097491
> 
> 赞同：63
> 
> 时间：2012-04-10T22:40:51.873
> 
> 标签：java, python

从 Java 执行 Python 脚本并接收该脚本的输出的最简单方法是什么？我寻找过不同的库，例如 Jepp 或 Jython，但大多数都显得过时了。库的另一个问题是，如果我使用库，我需要能够轻松地将库包含在源代码中（尽管我不需要为库本身提供源代码）。

正因为如此，最简单/最有效的方法是简单地做一些事情，比如用 runtime.exec 调用脚本，然后以某种方式捕获打印输出？或者，即使这对我来说很痛苦，我也可以将 Python 脚本输出到一个临时文本文件，然后用 Java 读取该文件。

注意：Java 和 Python 之间的实际通信不是我要解决的问题的要求。然而，这是我能想到的轻松执行需要完成的事情的唯一方法。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-04-10T22:48:11.283

不确定我是否正确理解了您的问题，但如果您可以从控制台调用 Python 可执行文件并且只想在 Java 中捕获其输出，则可以使用`exec()`Java`Runtime`类中的方法。

```
Process p = Runtime.getRuntime().exec("python yourapp.py"); 
```

您可以阅读如何实际读取此资源的输出：http: [//www.devdaily.com/java/edu/pj/pj010016](http://www.devdaily.com/java/edu/pj/pj010016) import java.io.*;

```
public class JavaRunCommand {

    public static void main(String args[]) {

        String s = null;

        try {

        // run the Unix "ps -ef" command
            // using the Runtime exec method:
            Process p = Runtime.getRuntime().exec("ps -ef");

            BufferedReader stdInput = new BufferedReader(new 
                 InputStreamReader(p.getInputStream()));

            BufferedReader stdError = new BufferedReader(new 
                 InputStreamReader(p.getErrorStream()));

            // read the output from the command
            System.out.println("Here is the standard output of the command:\n");
            while ((s = stdInput.readLine()) != null) {
                System.out.println(s);
            }

            // read any errors from the attempted command
            System.out.println("Here is the standard error of the command (if any):\n");
            while ((s = stdError.readLine()) != null) {
                System.out.println(s);
            }

            System.exit(0);
        }
        catch (IOException e) {
            System.out.println("exception happened - here's what I know: ");
            e.printStackTrace();
            System.exit(-1);
        }
    }
} 
```

还有一个 Apache 库（Apache exec 项目）可以帮助您解决这个问题。你可以在这里读更多关于它的内容：

[http://www.devdaily.com/java/java-exec-processbuilder-process-1](http://www.devdaily.com/java/java-exec-processbuilder-process-1)

[http://commons.apache.org/exec/](http://commons.apache.org/exec/)

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-04-10T23:29:01.933

您可以在 Java 项目中包含[Jython](https://www.jython.org/download)库。您可以从 Jython 项目本身[下载源代码。](https://github.com/jython/jython)

Jython 确实提供了对[JSR-223 的](http://jcp.org/aboutJava/communityprocess/final/jsr223/index.html)支持，它基本上允许您从 Java 运行 Python 脚本。

您可以使用 a`ScriptContext`来配置要将执行输出发送到的位置。

例如，假设您在名为 的文件中有以下 Python 脚本`numbers.py`：

```
for i in range(1,10):
    print(i) 
```

因此，您可以按如下方式从 Java 运行它：

```
public static void main(String[] args) throws ScriptException, IOException {

    StringWriter writer = new StringWriter(); //ouput will be stored here

    ScriptEngineManager manager = new ScriptEngineManager();
    ScriptContext context = new SimpleScriptContext();

    context.setWriter(writer); //configures output redirection
    ScriptEngine engine = manager.getEngineByName("python");
    engine.eval(new FileReader("numbers.py"), context);
    System.out.println(writer.toString()); 
} 
```

输出将是：

```
1
2
3
4
5
6
7
8
9 
```

只要您的 Python 脚本与 Python 2.5 兼容，使用 Jython 运行它就不会出现任何问题。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-10-11T09:05:48.737

我以前遇到过同样的问题，也在这里阅读了答案，但没有发现任何令人满意的解决方案可以平衡兼容性、性能和良好的格式输出，Jython 不能使用扩展 C 包并且比 CPython 慢。所以最后决定自己发明轮子，花了我5个晚上，希望对你也有帮助：jpserve( [https://github.com/johnhuang-cn/jpserve](https://github.com/johnhuang-cn/jpserve) )。

JPserve 提供了一种简单的方式来调用 Python 并通过格式良好的 JSON 交换结果，几乎没有性能损失。以下是示例代码。

首先在Python端启动jpserve

```
>>> from jpserve.jpserve import JPServe
>>> serve = JPServe(("localhost", 8888))
>>> serve.start()

INFO:JPServe:JPServe starting...
INFO:JPServe:JPServe listening in localhost 8888 
```

然后从 JAVA 端调用 Python：

```
PyServeContext.init("localhost", 8888);
PyExecutor executor = PyServeContext.getExecutor();
script = "a = 2\n"
    + "b = 3\n"
    + "_result_ = a * b";

PyResult rs = executor.exec(script);
System.out.println("Result: " + rs.getResult());

---
Result: 6 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-10T23:15:16.173

> 我一直在寻找不同的库，例如 Jepp 或 Jython，但大多数似乎都已经过时了。

Jython 不是“图书馆”；它是在 Java 虚拟机之上的 Python 语言的实现。它绝对不会过时；最近一次发布是今年 2 月 24 日。它实现了 Python 2.5，这意味着您将缺少一些更新的功能，但老实说，它与 2.7 并没有太大区别。

> 注意：Java 和 Python 之间的实际通信不是上述作业的要求，所以这不是我的功课。然而，这是我能想到的轻松执行需要完成的事情的唯一方法。

这对于学校作业来说似乎**极不可能。**请告诉我们更多关于你**真正**想做的事情。通常，学校作业会明确指定您将使用哪些语言，而我从未听说过涉及一种以上语言的语言。如果确实如此，他们会告诉你是否需要建立这种沟通方式，以及他们打算如何让你这样做。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-04-09T11:34:57.160

**Jython 方法**

Java 应该是平台独立的，并且调用本机应用程序（如 python）并不是非常独立于平台的。

有一个用 Java 编写的 Python (Jython) 版本，它允许我们将 Python 嵌入到我们的 Java 程序中。通常，当您要使用外部库时，一个障碍是编译和正确运行它，因此我们通过 Jython 构建和运行一个简单的 Java 程序的过程。

我们首先获取 jython jar 文件：

[https://www.jython.org/download.html](https://www.jython.org/download.html)

我将 jython-2.5.3.jar 复制到我的 Java 程序所在的目录中。然后我输入了下面的程序，和前两个一样；取两个数字，将它们发送给 python，python 将它们相加，然后 python 将它返回给我们的 Java 程序，其中数字被输出到屏幕上：

```
import org.python.util.PythonInterpreter; 
import org.python.core.*; 

class test3{
    public static void main(String a[]){

        PythonInterpreter python = new PythonInterpreter();

        int number1 = 10;
        int number2 = 32;
        python.set("number1", new PyInteger(number1));
        python.set("number2", new PyInteger(number2));
        python.exec("number3 = number1+number2");
        PyObject number3 = python.get("number3");
        System.out.println("val : "+number3.toString());
    }
} 
```

我将此文件称为“test3.java”，保存它，然后执行以下操作来编译它：

```
javac -classpath jython-2.5.3.jar test3.java 
```

下一步是尝试运行它，我执行以下方式：

```
java -classpath jython-2.5.3.jar:. test3 
```

现在，这允许我们以独立于平台的方式从 Java 中使用 Python。这有点慢。尽管如此，它还是很酷的，它是一个用 Java 编写的 Python 解释器。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-07-04T10:36:10.170

[Jep](https://github.com/mrj0/jep)是另一种选择。它通过 JNI将**CPython**嵌入到 Java 中。

```
import jep.Jep;
//...
    try(Jep jep = new Jep(false)) {
        jep.eval("s = 'hello world'");
        jep.eval("print(s)");
        jep.eval("a = 1 + 2");
        Long a = (Long) jep.getValue("a");
    } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-09-10T06:31:46.247

ProcessBuilder 非常易于使用。

```
ProcessBuilder pb = new ProcessBuilder("python","Your python file",""+Command line arguments if any);
Process p = pb.start(); 
```

这应该调用 python。有关完整示例，请参阅此处的过程方法！

[https://bytes.com/topic/python/insights/949995-three-ways-run-python-programs-java](https://bytes.com/topic/python/insights/949995-three-ways-run-python-programs-java)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-10T23:02:01.217

您可以尝试使用 groovy。它在 JVM 上运行，并为运行外部进程和提取输出提供了强大的支持：

[http://groovy.codehaus.org/Executing+External+Processes+From+Groovy](http://groovy.codehaus.org/Executing+External+Processes+From+Groovy)

您可以在来自同一链接的这段代码中看到 groovy 如何轻松获取进程的状态：

```
println "return code: ${ proc.exitValue()}"
println "stderr: ${proc.err.text}"
println "stdout: ${proc.in.text}" // *out* from the external program is *in* for groovy 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-18T14:54:02.880

首先，我建议使用 ProcessBuilder（自 1.5 起）
这里描述了简单的用法
[https://stackoverflow.com/a/14483787](https://stackoverflow.com/a/14483787)
有关更复杂的示例，请参阅
[http://www.javaworld.com/article/2071275/core-java /when-runtime-exec---won-t.html](http://www.javaworld.com/article/2071275/core-java/when-runtime-exec---won-t.html)

我在从 Java 启动 Python 脚本时遇到了问题，脚本对标准输出产生了太多的输出，一切都变糟了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-05-16T11:09:56.017

实现的最佳方法是使用 Apache Commons Exec，因为我将它用于生产，即使对于 Java 8 环境也没有问题，因为它允许您通过使用看门狗以`synchronous`和方式执行任何外部进程（包括 python、bash 等） `asynchronous`.

```
 CommandLine cmdLine = new CommandLine("python");
 cmdLine.addArgument("/my/python/script/script.py");
 DefaultExecuteResultHandler resultHandler = new DefaultExecuteResultHandler();

 ExecuteWatchdog watchdog = new ExecuteWatchdog(60*1000);
 Executor executor = new DefaultExecutor();
 executor.setExitValue(1);
 executor.setWatchdog(watchdog);
 executor.execute(cmdLine, resultHandler);

 // some time later the result handler callback was invoked so we
 // can safely request the exit value
 resultHandler.waitFor(); 
```

此处共享一个小而完整的 POC 的完整源代码，解决了本文中[的](https://stackoverflow.com/questions/7340452/process-output-from-apache-commons-exec/56165822#56165822)另一个问题；

[https://github.com/raohammad/externalprocessfromjava.git](https://github.com/raohammad/externalprocessfromjava.git)

# php - 是否可以从 php 将数据发布到 ssl 脚本？

> ID：10097493
> 
> 赞同：-1
> 
> 时间：2012-04-10T22:40:58.443
> 
> 标签：php, ssl

这是我的情况：站点 A 有表单，它通过 ssl 将数据发送到脚本。我想绕过站点 A 并将数据直接发送到该脚本，但我不知道 ssl 是否不是问题。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:42:34.097

没有一些上下文，我在黑暗中拍摄。但是你不能用对站点 B 的 SSL 的 POST 操作创建你自己的表单吗？

# tcl - 如何将 TCL 程序指向不同的目录

> ID：10097497
> 
> 赞同：0
> 
> 时间：2012-04-10T22:41:15.077
> 
> 标签：tcl, parameter-passing

我有一个接受文件的程序。我已将这些文件存储在 Tcl\bin 文件夹中。现在，如果我将这些文件放在不同的文件夹中，可能是共享文件夹。如何指向该特定文件夹以获取这些文件作为此过程的输入参数？

```
 proc test {File1 File2 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:52:10.363

无论您使用的是相对文件路径还是绝对文件路径，都可以使用[file](http://tmml.sourceforge.net/doc/tcl/file.html)命令及其选项来检测某些内容，例如访问权限。从那里你可以摆脱只使用[打开](http://tmml.sourceforge.net/doc/tcl/open.html)/[读取](http://tmml.sourceforge.net/doc/tcl/read.html)/[获取](http://tmml.sourceforge.net/doc/tcl/gets.html)/[关闭](http://tmml.sourceforge.net/doc/tcl/close.html)命令来读取它们。例如：

```
#!/usr/bin/tclsh

set path "path/to/file/directory/"
set name "file.name"

if {[file exists $path$name]} {
    if {[catch { set handle [open $path$name] }]} {
        puts "Could not open $path$name"
    } else {
        set data [split [read $handle] "\n"]
        close $handle
    }
} 
```

# java - Android SDK 未安装在 win 7 64 位

> ID：10097501
> 
> 赞同：14
> 
> 时间：2012-04-10T22:41:40.567
> 
> 标签：java, android

我正在尝试在 Windows 7 64 位上安装 Android SDK，但它不起作用。我不断收到[这个屏幕](http://goo.gl/4Xe5I)：

```
JAVA SE Development Kit (JDK) not found.  
Error: Failed to find Java version for 'C:\Windows\system32\java.exe': [2] The system cannot find the file specified.  (...)   
If you believe you have a JDK installed and it was not properly recognized, simply set an environment variable JAVA_HOME to point to it. 
```

我尝试设置`JAVA_HOME`为`C:\Windows\System32\java.exe`（这是我的安装路径），但它仍然无法正常工作。

在命令行中我测试了版本，`java -version`它运行良好。

尝试了 back 和 next 的旧技巧，但遗憾的是不起作用。

这太令人失望了....有什么建议吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-10T22:45:10.040

它是*JDK*，而不是*Java*，它不见了。JAVA_HOME 不应指向 java.exe 文件。它应该指向 jdk 文件夹。通常`C:\Program Files\Java\jdk1.6.0_23`或类似。如果你在某个地方没有 jdk 文件夹，你应该从[这里安装](http://www.oracle.com/technetwork/java/javase/downloads/index.html "here")**JDK**。

请注意，为 Android 开发的官方~~要求是 JDK 6~~ [。](http://developer.android.com/sdk/index.html)

 ~~* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-05T12:17:46.630

将系统变量中的 JAVA_HOME 环境变量设置为 C:\Program Files\Java\jdk1.7.0_07\ 确实解决了我的问题。

有几点需要注意：

1.  无需指定 bin 或 jre 文件夹名称。
2.  您将需要取消并重新启动 android sdk 安装。上一个/下一个可能不起作用。
3.  我刚刚从 Windows 资源管理器地址栏中复制了文件夹名称。无需将 \ 替换为 /。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-21T01:28:35.110

[从http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html](http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html)下载 JDK 64bit

添加指向 C:\Program Files\Java\jdk1.7.0_21 的系统变量 JAVA_HOME

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T23:17:25.077

自 Android 工具 SDK 第 16 版以来其中一个批处理文件的更改可能是罪魁祸首。尝试使用 ZIP 文件而不是 EXE。[从http://developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)下载 android-sdk_r18-windows.zip 。解压缩到您的程序文件通常驻留的新 Android 目录（其他位置也应该可以）。将 Android\android-sdk\tools\lib 目录中的 find_java.bat 替换为 release 16 SDK 工具中的一个（如果你还没有从[https://tekeye.uk/downloads/find_java.zip](https://tekeye.uk/downloads/find_java.zip)获取它） . 使用 ZIP 而不是 EXE 意味着不会设置快捷方式和程序组，但您可以运行 android-sdk 文件夹中的 SDK Manager.exe 来获取 SDK 的其余部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-27T01:16:02.687

以下是从头开始对我有用的设置步骤（截至今天 - 2013 年 6 月 26 日）

[设置步骤]

**第一部分 - Java JDK**

1.  删除 PC 上安装的所有 Java 程序。
2.  访问：[http](http://www.oracle.com/technetwork/java/javase/downloads/index.html) ://www.oracle.com/technetwork/java/javase/downloads/index.html （这是 Java JDK 下载站点）
3.  [http://www.oracle.com/technetwork/java/javase/downloads/index.html]->鼠标点击
4.  选择单选按钮 ，然后选择并下载并将其保存到任何临时目录中。
5.  鼠标单击以突出显示 jdk-7u25-windows-x64.exe，然后单击鼠标右键并选择开始安装过程并安装为默认设置。

*结果：Java JDK 安装将按预期完成*

**第二部分 - Android SDK（初步设置）**

1.  [PC:Home]->鼠标点击
2.  [PC：开始菜单]->鼠标单击
3.  [PC：控制面板]->鼠标单击
4.  [PC:System]->鼠标单击
5.  [PC:高级系统设置]->鼠标点击
6.  [PC:环境变量:系统变量]->鼠标点击
7.  [PC:New System Variable]->填写如下：
    *   变量名：JAVA_HOME
    *   变量值：C:\Program Files\Java\jdk1.7.0_25 ->鼠标点击
8.  关闭/重启电脑

*这是为了确保环境变量的更改将起作用*

**第三部分 - Android SDK**

1.  转至：http: [//developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)
2.  [http://developer.android.com/sdk/index.html]->鼠标点击
3.  下载以下内容并将其保存到 PC 上的任何临时目录中：
    *   安装程序_r22.0.1-windows.exe（推荐）
4.  鼠标单击下载的 ，然后单击鼠标右键并选择开始安装过程并安装为默认设置。

*结果：Android SDK 安装将按预期完成*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-21T03:26:03.007

1.  使用 7zip 或类似软件解压缩 .exe 或重新下载 .zip
2.  做安装程序会做的事情：创建工具和插件目录并将文件放入`$COMMONFILES`etc 到适当的工具和插件中
3.  打开一个（管理员？）cmd窗口
4.  CD 到`tools/lib`, ，`notepad find_java.bat`注意它调用`find_jave.exe`.`-s`
5.  然后尝试`find_java.exe -s`。它会说：（ `Failed to convert path to a short DOS path: C:\Windows\system32\java.exe`这已经是一条非常短的路径了——很奇怪。）
6.  从.bat 内部的`-s`两个调用中删除。`find_java.exe`保存
7.  跑`/tools/android.bat`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-13T10:40:44.930

最简单的解决方案我有 Windows 7 x64 在安装 Java JDK 64bit 后它没有工作，但是：在安装 x32 和 x64 之后它工作了 :) 享受~~

# web-services - 设计建议 JMS 或 Web 服务

> ID：10097502
> 
> 赞同：0
> 
> 时间：2012-04-10T22:41:57.353
> 
> 标签：web-services, jms

我需要向其他系统发送一些消息，比如 10 个其他系统（大小 50 KB XML），而所有其他系统都是基于 JAVA 的系统，这是一个很好的选择？JMS 或 WEBServices？其他选择是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T07:08:10.390

实际上，您可以通过 jms 拥有 Web 服务。Webservice 在另一层。如果您的意思是在系统之间通信 xml，对我来说最简单的是 HTTP。这里有一个有趣的博客可以帮助你：

[http://it.toolbox.com/blogs/the-soa-blog/web-services-http-vs-jms-19110](http://it.toolbox.com/blogs/the-soa-blog/web-services-http-vs-jms-19110)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-02T04:48:48.873

在我看来，JMS 在分布式系统的情况下提供了更好的功能和控制。您可以进行事务处理并进行更好的故障处理。

# java - 使用 JSF 的 @Entity，使用 JPA 坚持“hello world”

> ID：10097504
> 
> 赞同：0
> 
> 时间：2012-04-10T22:41:57.790
> 
> 标签：java, jsf, jpa, ejb, cdi

[Oracle](http://docs.oracle.com/javaee/6/tutorial/doc/bnbqa.html)很好地描述了如何创建@Entity。但是，我并不清楚如何实际添加/删除表。我也喜欢印度玫瑰的[解释](http://www.roseindia.net/ejb/entity-bean-example.shtml)，但只是想澄清一下总体思路。

对于带有 CDI 的 JSF JEE6 应用程序，我基本上可以创建一个 @Entity 类，在 @Named bean 中实例化一些实例，然后使用 bean 中的 EntityManager 将（CRUD 操作）写入 MySQL 数据库？我可以只使用 Glassfish 附带的默认 JPA 吗？

只是想在我开始之前澄清总体思路。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T07:08:16.203

一般来说，您至少有两种选择：

1.  创建数据库表和引用，然后基于数据库表构建实体类（现代 IDE 提供了从 db 表自动生成实体类的工具）

2.  手动编写实体类并从这些类创建数据库。*JPA 提供者通常通过在persistence.xml*中设置一个特殊参数来允许这样做，例如对于 Eclipselink：

```
<property name="eclipselink.ddl-generation" value="drop-and-create-tables"/> 
```

删除所有现有表并从您的实体类创建新表（在开发期间特别有用），同时

```
<property name="eclipselink.ddl-generation" value="create-tables"/> 
```

如果不存在，只会创建一个新表。

> *我可以只使用 Glassfish 附带的默认 JPA 吗？*

是的，对于基于规范的功能。

# core-data - 核心数据未解决的错误（空），（空）

> ID：10097508
> 
> 赞同：1
> 
> 时间：2012-04-10T22:42:17.583
> 
> 标签：core-data, ios5

我昨天启动并运行了这个应用程序的一个版本。我重新开始是因为我想要练习并添加一些功能。但是今天我无法完成为实体添加新对象的最基本任务。当我尝试保存时，我不断收到同样的错误：

> 未解决的错误 (null), (null)

大多数早期代码都是从工作应用程序中复制和粘贴的。当这不起作用时，我创建了一个新项目并重新输入了所有代码。没有骰子。所以我删除了所有派生数据，删除了应用程序的所有早期版本，重置了模拟器，关闭了 Xcode，重新启动了我的机器，创建了一个新项目并重新键入了这四个类。但我仍然得到同样的臭名昭著的错误。我的模型中没有强制属性。我在这里用头撞墙。有任何想法吗？这是我正在使用的类的代码：

```
//  PublisherTableViewController.h

#import <UIKit/UIKit.h>
#import "Publisher.h"

@interface PublisherTableViewController : UITableViewController <NSFetchedResultsControllerDelegate, PublisherAddDelegate>{
    @private

    NSFetchedResultsController *fetchedResultsController;
    NSManagedObjectContext *managedObjectContext;

}

@property (strong, nonatomic) NSFetchedResultsController *fetchedResultsController;
@property (strong, nonatomic) NSManagedObjectContext *managedObjectContext;

- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath; 
```

// PublisherTableViewController.m

```
#import "AddPublisherTableViewController.h"
#import "PublisherTableViewController.h"
#import "AppDelegate.h"

@interface PublisherTableViewController ()

@end

@implementation PublisherTableViewController
@synthesize fetchedResultsController, managedObjectContext;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"AddPublisherSegue"]) {
        AddPublisherTableViewController *addPublisherController = (AddPublisherTableViewController *) [[segue destinationViewController] topViewController];
        addPublisherController.delegate = self;

        Publisher *newPublisher = [NSEntityDescription insertNewObjectForEntityForName:@"Publisher" inManagedObjectContext:self.managedObjectContext];
        addPublisherController.publisher = newPublisher;
    }
}

-(void)publisherAddViewController:(AddPublisherTableViewController *)publisherAddViewController didAddPublisher:(Publisher *)publisher
{
    [self dismissModalViewControllerAnimated:YES];
}

- (void)viewDidLoad
{

    if (managedObjectContext == nil) 
    { 
        managedObjectContext = [(AppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext]; 
        //NSLog(@"After managedObjectContext: %@",  managedObjectContext);
    }

    NSError *error = nil;
    if (![[self fetchedResultsController] performFetch:&error ]) {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    }

    [super viewDidLoad];

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{

    // Return the number of sections.
    return [[self.fetchedResultsController sections]count];

}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    // Return the number of rows in the section.

    id<NSFetchedResultsSectionInfo> sectionInfo = [[self.fetchedResultsController sections] objectAtIndex:section];

    return [sectionInfo numberOfObjects];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"PublisherCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...

    [self configureCell:cell atIndexPath:indexPath];

    return cell;
}

-(void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath
{
    Publisher *publisherForCell = (Publisher *)[fetchedResultsController objectAtIndexPath:indexPath];
    cell.textLabel.text = [NSString stringWithFormat:@"%@ %@",publisherForCell.firstName, publisherForCell.lastName];
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
}

/*
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}
*/

/*
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
    }   
}
*/

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the item to be re-orderable.
    return YES;
}
*/

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Navigation logic may go here. Create and push another view controller.
    /*
     <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
     // ...
     // Pass the selected object to the new view controller.
     [self.navigationController pushViewController:detailViewController animated:YES];
     */
}

- (NSFetchedResultsController *)fetchedResultsController {
    // Set up the fetched results controller if needed.

    if (fetchedResultsController == nil) {

        // Create the fetch request for the entity.
        NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
        // Edit the entity name as appropriate.
        NSEntityDescription *entity = [NSEntityDescription entityForName:@"Publisher" inManagedObjectContext:managedObjectContext];
        [fetchRequest setEntity:entity];

        // Edit the sort key as appropriate.
        NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"lastName" ascending:YES];
        NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil];

        [fetchRequest setSortDescriptors:sortDescriptors];

        // Edit the section name key path and cache name if appropriate.
        // nil for section name key path means "no sections".
        NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:managedObjectContext sectionNameKeyPath:nil cacheName:@"Root"];
        aFetchedResultsController.delegate = self;
        self.fetchedResultsController = aFetchedResultsController;

        //        [aFetchedResultsController release];
        //        [fetchRequest release];
        //        [sortDescriptor release];
        //        [sortDescriptors release];
    }

    return fetchedResultsController;
}    

/**
 Delegate methods of NSFetchedResultsController to respond to additions, removals and so on.
 */

- (void)controllerWillChangeContent:(NSFetchedResultsController *)controller {
    // The fetch controller is about to start sending change notifications, so prepare the table view for updates.
    [self.tableView beginUpdates];
}

- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type newIndexPath:(NSIndexPath *)newIndexPath {
    UITableView *tableView = self.tableView;

    switch(type) {
        case NSFetchedResultsChangeInsert:
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeUpdate:
            [self configureCell:(UITableViewCell *)[tableView cellForRowAtIndexPath:indexPath] atIndexPath:indexPath];
            break;

        case NSFetchedResultsChangeMove:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
}

- (void)controller:(NSFetchedResultsController *)controller didChangeSection:(id <NSFetchedResultsSectionInfo>)sectionInfo atIndex:(NSUInteger)sectionIndex forChangeType:(NSFetchedResultsChangeType)type {
    switch(type) {
        case NSFetchedResultsChangeInsert:
            [self.tableView insertSections:[NSIndexSet indexSetWithIndex:sectionIndex] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [self.tableView deleteSections:[NSIndexSet indexSetWithIndex:sectionIndex] withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
}

- (void)controllerDidChangeContent:(NSFetchedResultsController *)controller {
    // The fetch controller has sent all current change notifications, so tell the table view to process all updates.
    [self.tableView endUpdates];
}

@end 
```

// 添加PublisherTableViewController.h

```
#import <UIKit/UIKit.h>
#import "Publisher.h"
@protocol PublisherAddDelegate;

@interface AddPublisherTableViewController : UITableViewController{
    Publisher *publisher;
    UITextField *firstName;
    UITextField *lastName; 
```

// 添加PublisherTableViewController.m

```
#import "AddPublisherTableViewController.h"

@interface AddPublisherTableViewController ()

@end

@implementation AddPublisherTableViewController

@synthesize delegate, firstName, lastName, publisher;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;
}

-(IBAction)savePublisher
{
    publisher.firstName = firstName.text;
    publisher.lastName = lastName.text;

    NSError *error = nil;

    if (![publisher.managedObjectContext save:&error]) {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    }

    [self.delegate publisherAddViewController:self didAddPublisher:publisher];

}

-(IBAction)cancel
{
    if (publisher.firstName == NULL) {
        [publisher.managedObjectContext deleteObject:publisher];

        NSError *error = nil;

        if (![publisher.managedObjectContext save:&error]) {
            NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    }
        [self.delegate publisherAddViewController:self didAddPublisher:nil];
    }else {
        [self.delegate publisherAddViewController:self didAddPublisher:publisher];
    }
}    

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

@end
    id<PublisherAddDelegate> delegate;

}

@property (nonatomic, strong) Publisher *publisher;
@property (nonatomic, strong) IBOutlet UITextField *firstName;
@property (nonatomic, strong) IBOutlet UITextField *lastName;
@property (nonatomic, strong) id<PublisherAddDelegate> delegate;

-(IBAction)savePublisher;
-(IBAction)cancel;

@end

@protocol PublisherAddDelegate <NSObject>

-(void)publisherAddViewController:(AddPublisherTableViewController *)publisherAddViewController didAddPublisher:(Publisher *)publisher;

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T09:44:26.823

属性`fetchedResultsController`和类变量不能具有相同的名称。你把编译器逼疯了。尝试这个：

```
//  PublisherTableViewController.h

#import <UIKit/UIKit.h>
#import "Publisher.h"

@interface PublisherTableViewController : UITableViewController <NSFetchedResultsControllerDelegate, PublisherAddDelegate>{
    @private

    NSFetchedResultsController *mFetchedResultsController;
    NSManagedObjectContext *mManagedObjectContext;
}

@property (strong, nonatomic) NSFetchedResultsController *fetchedResultsController;
@property (strong, nonatomic) NSManagedObjectContext *managedObjectContext;

- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath; 
```

// PublisherTableViewController.m

```
#import "AddPublisherTableViewController.h"
#import "PublisherTableViewController.h"
#import "AppDelegate.h"

@interface PublisherTableViewController ()

@end

@implementation PublisherTableViewController
@synthesize fetchedResultsController = mFetchedResultsController
@synthesize managedObjectContext = mManagedObjectContext;

... 
```

您`fetchedResultsController`可以在之前调用`viewDidLoad`，因此当您尝试初始化获取的结果控制器时`managedObjectContext`仍然可以调用。`null`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T18:33:42.440

没关系。显然xcode讨厌我。我添加了几个断点和 nslog，所以看看我的文本字段和发布者属性的值是什么。我第一次构建并运行该项目时，文本字段返回了正确的值，但发布者属性我们仍然为空。虽然一直坚持，但我只是重新构建并再次运行该项目而没有更改任何内容，现在它只是花花公子。感谢 Xcode！

# c++ - C++ Visual Studio 2010 C4717 编译器在代码的一部分中发出警告，但在另一部分中没有

> ID：10097510
> 
> 赞同：3
> 
> 时间：2012-04-10T22:42:37.837
> 
> 标签：c++, visual-studio-2010, visual-c++, warnings

这六种方法（实际上是三种，实际引发警告的是非常量版本）正在导致 C4717（所有路径上的函数递归）警告，但这些方法之后的方法却没有（我可以说完全一样.. .)。*我错过了什么导致这些警告而不是另一个警告？*

警告生成方法：

```
template<class T>
const QuadTreeNode<T>* QuadTree<T>::GetRoot() const {
    return _root;
}

template<class T>
QuadTreeNode<T>* QuadTree<T>::GetRoot() {
    return static_cast<const QuadTree<T> >(*this).GetRoot();
}

template<class T>
const int QuadTree<T>::GetNumLevels() const {
    return _levels;
}

template<class T>
int QuadTree<T>::GetNumLevels() {
    return static_cast<const QuadTree<T> >(*this).GetNumLevels();
}

template<class T>
const bool QuadTree<T>::IsEmpty() const {
    return _root == NULL;
}

template<class T>
bool QuadTree<T>::IsEmpty() {
    return static_cast<const QuadTree<T> >(*this).IsEmpty();
} 
```

非警告生成方法：

```
template<class T>
const Rectangle QuadTreeNode<T>::GetNodeDimensions() const {
    return _node_bounds;
}

template<class T>
Rectangle QuadTreeNode<T>::GetNodeDimensions() {
    return static_cast<const QuadTreeNode<T> >(*this).GetNodeDimensions();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T03:34:21.650

正如[ildjarn](https://stackoverflow.com/users/636019/ildjarn)所提到的，这是一个带有警告的[公认](http://connect.microsoft.com/VisualStudio/feedback/details/522094/)错误。如果您以与您的代码类似的最基本用法查看代码，则不会出现以下警告（并且不是递归的）。

```
class A
{
public:
    bool IsEmpty()
    {
        return static_cast<const A>(*this).IsEmpty();
    }

    bool IsEmpty() const
    {
        return true;
    }
};

int main()
{
    A whatever;
    whatever.IsEmpty();

    return 0;
} 
```

# python - “'int' 对象不可调用”错误

> ID：10097533
> 
> 赞同：-3
> 
> 时间：2012-04-10T22:46:00.253
> 
> 标签：python

这是我的脚本，[http ://pastebin.com/zgRrBX0U](http://pastebin.com/zgRrBX0U)

作为参考，这是 Zed Shaw 的“Learning python the hard way”的 ex36 脚本。我试图创建一个基于塞尔达传说第一级设计的基于文本的冒险。

但是当我开始进入程序时，我遇到了一个问题。它可以让您从主房间开始。但无论往哪个方向走，都会有错误的说法。“‘int’对象是不可调用的。” 我无法通过搜索弄清楚这意味着什么。或者查看 pydocs。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:48:51.347

您将`roomBA`and定义`roomDA`为函数，然后……您将它们绑定到整数。当然，它不会起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T22:53:08.430

正如 Ignacio 所说，删除第 129 和 130 行，它将起作用。

在 Python 中，“可调用”通常是一个函数。该消息意味着您将一个数字（一个“int”）视为一个函数（一个“可调用”），所以 Python 不知道该做什么，所以它停止了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T23:03:20.530

第 47 行：

```
def roomBA(key, life, door_open, roomBA, roomDA): 
```

您在这里定义了一个名为 roomBA 的函数。

第 129 行：

```
roomBA = 0 
```

在这里，您现在已将 roomBA 更改为数字 0。

因此，您定义的原始函数丢失了。你不再有一个名字可以用来称呼它了。

在第 132 行：

```
roomCA(key, life, door_open, roomBA, roomDA) 
```

在这里，您调用的是函数 roomCA。除其他外，此函数向玩家询问方向，然后尝试调用相应的房间函数。

我输入了 west，所以我们尝试调用变量 roomBA 引用的函数（第 17 行）。但是，哦不，它不再是一个函数。它是 0。因此，你是错误的。

发生的事情是函数名称和变量名称之间有很多冲突。当然，roomXX 是代表游戏中每个房间的函数。然后，你有状态变量（现在也被命名为 roomXX）。这些变量似乎旨在跟踪您之前是否进入过房间。由于您的函数和状态变量都被命名为相同的东西，所以您正在做各种意想不到的事情。

正如上面提到的，您可以删除第 129 行和第 130 行以使代码运行；但是，您可能需要更好地了解基础知识。这是一个开始的地方：

[http://en.wikipedia.org/wiki/Scope_%28computer_science%29](http://en.wikipedia.org/wiki/Scope_%28computer_science%29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T23:07:17.190

> 一个错误的说法。“‘int’对象是不可调用的。” 我无法通过搜索弄清楚这意味着什么。

您应该通过了解语言和英语的基础知识来弄清楚这意味着什么。

该错误表示`'int'`对象不可调用。调用是你对函数（和类似的东西）所做的，所以你有一个 int ，你认为你有一个函数（或类似的东西）。这是因为您已将函数名称重新绑定到 int。

在 Python 中，您现在应该知道：

1.  一切都是对象，甚至函数。

2.  直到运行时才检查类型。

3.  值有类型，而不是变量（实际上是名称）。

所以没有什么能阻止你写：

```
function a(): pass
a = 1 
```

第一行创建一个函数对象，并将其绑定到 name `a`。第二行将整数绑定`1`到 name `a`。这取代了旧的绑定，因此*不再是函数的*`a`名称。

# c++ - 为什么需要模运算符？

> ID：10097534
> 
> 赞同：0
> 
> 时间：2012-04-10T22:46:16.410
> 
> 标签：c++, c, optimization, compiler-construction

我在一个文档中读到，您可以用逻辑替换 mod 操作，如下所示：

反而：

```
int Limit = Value % Range; 
```

你做：

```
int Limit = Value & (Range-1); 
```

但是编译器仍然会生成 mod 指令，我的问题基本上是：如果编译器工作相同，为什么编译器不使用最有效的方法？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-10T22:47:57.323

嗯，不……只有当`Range`是 2 的幂时才有效。

对于所有其他值，您仍然需要模数`%`运算符。

使用负数时也有一些细微的（可能是实现定义的）差异。

* * *

附带说明：使用`%`运算符也可能更具可读性。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-11T02:54:10.497

只有当它是 2 的幂时，你才能用它替换模数。使用初等数学来替换它而不用模数

```
a = b % c; 
```

可以用

```
x = b % c;
a = b / (x*c); 
```

让我们用一个例子来检查一下

```
25 % 7 = 
25 / 7 = 3 (integer math)
25 - (3 * 7) =
25 - 21 = 4 
```

因为我没有模运算符，所以无论如何我必须在我的计算器上这样做。

注意

```
25 & (7-6) = 
0x19 & 0x6 = 0x0 
```

所以你的替换不起作用。

不仅大多数处理器没有模数，许多处理器也没有除法。查看黑客喜悦书。

为什么要取模？如果您已经烧毁了硬件以进行划分，那么您可能也愿意加倍努力来添加模数。大多数处理器将您的问题提升到一个新的水平，当它可以在软件中完成时，您为什么要在硬件中实现它。您的问题的答案是大多数处理器系列没有模数，并且许多没有分频器，因为与软件解决方案相比，它不值得芯片空间、功耗等。软件解决方案的痛苦/成本/风险较小。

现在我假设你的问题不是获奖海报的答案。对于 Range 是 2 的幂并且恒等式确实有效的情况...首先，如果在编译时不知道范围，那么您必须执行减法和一个与，两个操作，也许还有一个中间变量，即比模更昂贵，编译器将错误地优化为减法和而不是模数。如果范围是 2 的幂并且在编译时已知，那么您更好/更高级的编译器将进行优化。有时，尤其是具有可变字长指令集的情况下，较小的指令可以在较大的指令上使用，加载 Range 并进行模运算可能比加载大量非零位（值与您的身份匹配的范围在值中设置了一个位，其他位为零，0x100、0x40、0x8000 等）并进行取模。load immediate plus modulo 可能比 load immediate plus and 便宜，或者 modulo immediate 可能比 and immediate 便宜。您必须检查指令集以及编译器如何实现解决方案。

我建议您发布一些未进行优化的示例，并且我假设我们可以发布许多示例，说明编译器在何处进行了您所期望的优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T02:58:42.730

正如其他人所说，范围必须是 2^n-1，即使这样，如果它是在运行时完成的，你也会遇到问题。

在最近的架构上（比方说，P4 时代之后的任何东西）整数除法指令的延迟在最坏情况下在 26 到 50 个周期之间。相比之下，乘法可以是 1-3 个周期，并且通常可以更好地并行完成。

DIV 指令返回 EAX 中的商和 EDX 中的余数。“余数”是自由的（模数是余数）。

如果你在运行时实现范围可变的东西，如果你想使用 &，你必须：

a) 检查范围是否为 2^n-1，如果是，请使用您的 & 代码路径：这是一个分支，可能的缓存未命中等。增加了巨大的潜在延迟 b) 如果不是 2^n-1，则使用DIV 指令

使用 DIV 而不是在等式中添加分支（在缓存驱逐不佳的情况下，这可能会花费数百甚至数千个周期）使 DIV 成为明显的最佳选择。最重要的是，如果您将 & 与带符号的数据类型一起使用，则需要进行转换（对于混合数据类型没有 &，但对于 DIV 有）。此外，如果 DIV 仅用于从模数中进行分支，而不使用其余结果，则推测执行可以很好地执行；可以并行执行指令的多个管道也进一步减轻了性能损失。

您必须记住，如果您使用的是真实代码，您的大量缓存将被您正在处理的数据以及您将很快使用或刚刚处理的其他代码和数据填充。您真的不想因为分支预测错误而驱逐缓存页面并等待它们调入页面。在大多数模数情况下，你不只是去 i = 7; d = 我 % 4; 您正在使用较大的代码，该代码通常调用一个子程序，该子程序本身就是一个（预测和缓存的）子程序调用。此外，您可能正在循环中执行此操作，该循环本身也使用分支预测；带有循环的嵌套分支预测在现代微处理器中得到了很好的处理，但它最终只是简单地添加到它试图做的预测中。

总而言之，对于一般用例，在现代处理器上使用 DIV 更有意义；由于缓存考虑和其他因素，编译器生成 2^n-1 并不是真正的“优化”。如果您真的需要微调整数除法，并且您的整个程序都依赖于它，那么您最终会将除数硬编码为 2^n-1 并自己进行按位和逻辑。

最后，这有点啰嗦——用于整数除法的专用 ALU 单元确实可以将延迟减少到大约 6-8 个周期，它只是占用了相对较大的芯片区域，因为数据路径最终大约为 128 位宽，并且当整数 DIV 工作得很好时，没有人拥有它的空间。

# javascript - 两个操作数之间的相等比较，其中一个操作数可能未定义

> ID：10097542
> 
> 赞同：2
> 
> 时间：2012-04-10T22:47:11.097
> 
> 标签：javascript

```
if (typeof operand1 != "undefined" && operand1 == operand2) {
} 
```

以上是`if`检查操作数 1 和操作数 2 之间是否相等的语句，*其中**操作*数*1*可能`undefined`在某些情况下。我想知道是否`typeof operand1 != "undefined"`不必要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T22:50:54.127

因为您使用`==`运算符而不是`===`运算符，所以只有 if `operand2`will never be才没有必要`null`。

但是您可以将 更改`if statement`为使用`===`运算符，该运算符只有在`operand2`“真正等于”时才会通过`operand1`，意思`operand2`也是`undefined`如此。

您可以在此处阅读更多相关信息：
[JavaScript 比较中应该使用哪个等号运算符 (== vs ===)？](https://stackoverflow.com/questions/359494/javascript-vs-does-it-matter-which-equal-operator-i-use)

一个[小提琴](http://jsfiddle.net/2dEHz/2/)，显示了这里写的内容。

* * *

在`Data Base`世界上，`null`(或`undefined`) 什么都不是，这意味着你不能将它与任何东西进行比较。

**SQL 示例：**

```
SELECT *
FROM   table_name t
Where  t.operand1 = null 
```

是一个错误，因为没有任何东西等于 null，而 null 不等于任何东西，它只是不存在。

**在`javascript`it is not like that 中**，您可以将事物与`null`and进行比较`undefined`，但您必须小心`TypeError`s，就像这样：

```
var x;
x.foo; // TypeError! 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T22:52:56.680

唯一一次我会说在检查两个变量值的相等性之前有必要进行`typeof`检查是当其中一个 ( `operand1`) 可能未定义时，防止`ReferenceError`.

[js小提琴](http://jsfiddle.net/jmTaA/)。

# iphone - 链接器命令失败，退出代码为 1 - 不知道为什么

> ID：10097544
> 
> 赞同：1
> 
> 时间：2012-04-10T22:47:26.177
> 
> 标签：iphone, objective-c, ios, xcode

我不确定我为什么会得到这个。它通常是由于缺少框架而出现的，除了它提到了我在项目中已经拥有的一个类，并导入到它说错误出现的文件中。它说...

```
Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_ELCImagePickerController", referenced from:
      objc-class-ref in JCreateViewController.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

JCreateViewController.m 在导入中有这个：

```
#import "ELCImagePickerController.h" 
```

所以我真的不知道为什么它给了我这个错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T23:48:34.703

为了提供可接受的答案，请从评论中：

确保`ELCImagePickerController`包含在项目的编译源构建阶段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T18:18:38.410

您可以通过简单的选择和添加将资源添加到您的项目构建阶段，请参阅此[链接](http://codefriends.blogspot.in/2012/04/hi-i-faced-this-problem-and-want-to.html)

# c# - 使用额外的 XPath 查询过滤 XmlNodeList？

> ID：10097546
> 
> 赞同：1
> 
> 时间：2012-04-10T22:47:36.897
> 
> 标签：c#, xml, xpath

我有一个大型 XML 文档，我正在使用 C# 来查询内容。我有类似以下内容：

```
var bookA = xmlDoc.SelectSingleNode("/books/book[yearPublished=2012 and id=123]");
var bookB = xmlDoc.SelectSingleNode("/books/book[yearPublished=2012 and id=456]");
var bookC = xmlDoc.SelectSingleNode("/books/book[yearPublished=2012 and id=789]"); 
```

如您所见，每个查询中都会重复“yearPublished”过滤器，如果我错了，请纠正我，整个图书列表会被重复解析。具有以下内容是否会更有效：

```
var newBooks = xmlDoc.SelectNodes("/books/book[yearPublished=2012]");
var bookA = newBooks.SelectSingleNode("book[id=123]");
var bookB = newBooks.SelectSingleNode("book[id=456]");
var bookC = newBooks.SelectSingleNode("book[id=789]"); 
```

假设我的文档很大（假设它包含关于几千本书的数据），我是否正确地根据第一个条件过滤数据然后从过滤列表中选择所需的 XmlNode 会更有效？

其次，我试图验证我的假设，但我遇到了麻烦。我收到有关 SelectSingleNode 的错误消息：

> “System.Xml.XmlNodeList”不包含“SelectSingleNode”的定义，并且找不到接受“System.Xml.XmlNodeList”类型的第一个参数的扩展方法“SelectSingleNode”（您是否缺少 using 指令或程序集引用?)

我引用了 System.Xml 以及“使用 System.Xml”。我还缺少其他东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T22:58:47.367

SelectNodes[方法](http://msdn.microsoft.com/en-us/library/hcebdtae.aspx)返回一个[XmlNodeList](http://msdn.microsoft.com/en-us/library/system.xml.xmlnodelist.aspx)类型。[SelectSingleNode](http://msdn.microsoft.com/en-us/library/h0hw012b.aspx)方法属于[XmlNode](http://msdn.microsoft.com/en-us/library/bxz4hfh3.aspx)类。

你可以像这样得到你的书：

```
var bookA = newBooks.Where(x => x.Attributes["id"].Value == 123);
var bookB = newBooks.Where(x => x.Attributes["id"].Value == 456);
var bookC = newBooks.Where(x => x.Attributes["id"].Value == 789); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:00:19.603

```
var newBooks = xmlDoc.SelectNodes("/books/book[yearPublished=2012]"); 
```

这将返回一个[XmlNodeList](http://msdn.microsoft.com/en-us/library/system.xml.xmlnodelist.aspx)对象。该对象不包含名为 的方法`SelectSingleNode`，这就是编译器告诉您的原因。

您可以迭代`XmlNodeList`从方法返回的节点，`SelectNodes`如下所示：

```
foreach (XmlNode node in newBooks)
{
   //...
} 
```

至于您的性能问题或感知的性能问题，我建议您加载所需大小的文件并对其进行基准测试。只有这样，您才能判断是否存在性能问题，因为您将对其进行测量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T02:25:24.813

您可以评估具有变量引用的 XPath 表达式——请参阅**[XPathExpression.SetContext()](http://msdn.microsoft.com/en-us/library/s4085db5.aspx)**和**[此示例](http://msdn.microsoft.com/en-us/library/dd567715.aspx)**如何实现 IXsltContextVariable。

# css - 无论浏览器窗口大小如何，在视觉上连接到内容背景的边距背景

> ID：10097553
> 
> 赞同：0
> 
> 时间：2012-04-10T22:48:01.513
> 
> 标签：css, margins

我需要创建一个启动页面，其中包含一个波形，该波形在一些营销文本下方运行页面的宽度。页面设置由一个 960 像素宽的主要内容区域组成，两侧是两个具有自动边距宽度的边距区域。我需要能够将用作内容区域背景的波形图像与用作边距背景的波形图像对齐。本质上，无论用户的浏览器窗口大小如何，波形线都需要在边缘和主要内容区域之间进行视觉连接。下面是我必须使用的模板的一个简单示例（这并不是说我不能在必要时添加到结构中）。如果有人对如何实现这一点有一个好主意，我将不胜感激您的意见。

```
.main {
    // not sure what to do here, but I know this isn't it
    // background: url("margin-wave.jpg") no-repeat scroll left top transparent;
}

.content {
    margin: 0 auto;
    width: 960px;
    background: url("main-wave.jpg") no-repeat scroll left top transparent;
}

<div class="main">
  <div class="content">
  ...
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:12:47.793

我的猜测是：

```
.main {
    background: url("margin-wave.jpg") repeat-x scroll center top transparent;
} 
```

# jsp - How do i use grails tags in JSP

> ID：10097557
> 
> 赞同：1
> 
> 时间：2012-04-10T22:48:13.790
> 
> 标签：jsp, grails, gsp

I have a JSP file which i am including in my GSP

```
 <div class="dialog">
                <g:include view="WEB-INF/-----/merchantCompany.jsp"/>
            </div> 
```

and in my merchantcompany.jsp i need to include timezone as drop down. Since grails has g:timezone i want to use that tag. How can I include grails tag-lib in my jsp??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T05:39:00.777

Try Following

```
<%@ taglib uri="http://grails.codehaus.org/tags" prefix="g" %>

<g:form method="post" controller="book">
</g:form> 
```

This is more or less same as way in which you will use any oither taglib in jsp files.

Hope that helps.

# c++ - Visual Studio 调试器：轻松查看 std::list（和其他 std 容器）

> ID：10097564
> 
> 赞同：2
> 
> 时间：2012-04-10T22:49:05.420
> 
> 标签：c++, visual-studio, std

当我尝试在 Visual Studio 调试器中查看 std::list 时，我基本上只想查看列表包含的所有 myList.size 值的数组。在理想情况下，我可以通过在 Watch Window 中键入一些 x < myList.size 的“MyList, x”来做到这一点。

但是，这无济于事。相反，我必须手动扩展大量变量来逐个查看每个值：

myList -> std::_List_val -> std::_List_nod -> _Myhead -> _Myval

这只是列表中的第一个值。

这是调试查看列表中值的一种糟糕方式。有什么方法可以让我只查看列表中的所有值而不用担心实现细节？

这个问题也适用于其他 STD 容器，例如载体。我只想做“MyStdContainer，x”而不关心我如何包含我的变量。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:31:27.240

听起来您的`autoexp.dat`文件丢失或损坏。这通常位于`%VSINSTALLDIR%\Common7\Packages\Debugger\`并提供调试器可视化`std::`容器所需的信息。

如果您找到此文件，相关部分将`std::list`开始：

```
;------------------------------------------------------------------------------
;  std::list from <list>
;------------------------------------------------------------------------------ 
```

# javascript - 如何更改名称的属性取决于哪个 在另一个被选中 ?

> ID：10097570
> 
> 赞同：0
> 
> 时间：2012-04-10T22:50:09.570
> 
> 标签：javascript, forms, select

我正在制作一个品牌/模型表格，有两个下拉菜单。选择一个品牌后，将显示带有该品牌的适当模型列表的模型下拉列表，而其他品牌的其余下拉列表保持隐藏。我遇到的问题是将表单发布到文本文件。所有字段都发布得很好，除了模型字段，它总是发布在最后一个下拉列表中选择的选项，这恰好是沃尔沃模型的列表。对于模型的活动列表，我需要将 name="" 属性更改为 "car_model"。

这是我拥有的代码的简短示例：

```
<tr>
    <td width="15%" class="label">Make:</td>
    <td class="inputd"><select id="makes" name="car_make" class="input">
        <option value="Default">Please Select</option>
        <option value="Acura">Acura</option>
        <option value="Audi">Audi</option>
        <option value="BMW">BMW</option>
    </select>
    </td>
</tr>
<tr>
    <td width="15%" class="label">Model:</td>
    <td class="inputd"><div id="car_models">
        <div id="Default" style="display:block">
          <select name="car_model">
            <option value="0">Please Select</option>
            <option value="1">Choose Make First</option>
          </select>
        </div>
        <div id="Acura" style="display: none;">
          <select name="car_model">
            <option value="0">Please Select</option>
            <option value="CL">CL</option>
            <option value="Integra">Integra</option>
            <option value="Legend">Legend</option>
          </select>
        </div>
        <div id="Audi" style="display: none;">
          <select name="car_model">
            <option value="0">Please Select</option>
            <option value="A3">A3</option>
            <option value="A4">A4</option>
            <option value="A5">A5</option>
          </select>
        </div>
        <div id="BMW" style="display: none;">
          <select name="car_model">
            <option value="0">Please Select</option>
            <option value="1 Series">1 Series</option>
            <option value="3 Series">3 Series</option>
            <option value="5 Series">5 Series</option>
          </select>
        </div>
    </td>
</tr> 
```

这是我用来显示/隐藏 div 的 javascript：

```
<script>
$(function () {
    $('#makes').change(function () {
        $('#car_models > div').hide();
        $('#car_models').find('#' + $(this).val()).show();
    });
});
</script> 
```

我有一个 php 表单写入文件，它从下拉列表中写入名为“car_model”的值，因此我需要找到一种方法在它处于活动状态时将其更改为唯一名称。

谢谢。

这是我用来写入 txt 文件的代码：

```
<?php
$first_name = $_POST['first_name'];
$last_name = $_POST['last_name'];
$phone = $_POST['phone'];
$email = $_POST['email'];
$zip = $_POST['zip'];
$year = $_POST['car_year'];
$make = $_POST['car_make'];
$model = $_POST['car_model'];
$mileage = $_POST['car_mileage'];
$data = "$first_name, $last_name, $phone, $email, $zip, $year, $make, $model, $mileage
\n";
$fh = fopen("data.txt", "a");
fwrite($fh, $data);
fclose($fh);
print "Thanks";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:01:02.663

您当前代码的问题是您的所有选择列表都具有相同的名称，并且它们都与表单一起提交，*即使它们不可见*。由于提交了多个具有相同名称的变量，因此最后一个总是获胜。

`<select>`要解决这个问题，除了隐藏它们的容器之外，还要禁用元素：

```
$('#makes').change(function () {
    $('#car_models > div').hide();
    $('#car_models select').prop('disabled', true);
    $('#car_models').find('#' + $(this).val()).show()
                    .find('select').prop('disabled', false);
}); 
```

# git - 是否可以仅在下一次提交时“git pull”？

> ID：10097571
> 
> 赞同：13
> 
> 时间：2012-04-10T22:50:10.683
> 
> 标签：git, git-pull

我知道`git pull`会将工作分支更新到它跟踪的远程分支的尖端。因此，假设我这样做`git pull`，它将引入所有最新更改。就我而言，它将在我的树顶部引入 5 个更改。

有没有办法`git pull`只进行下一次更改？即，如果`git pull`将更改 03、04、05、06 和 07 放在我的树顶部，我如何只拉更改 03？在执行此命令时，我不知道它将引入的下一个更改的提交 ID。

我的树的尖端完全没有改变，不会有任何合并冲突等。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-10T22:56:25.953

也许是这样的？

```
git fetch
git merge <commit to merge> 
```

要查找要合并的提交的 ID，请在运行 fetch 后在 gitk 中查找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-10T15:54:00.037

这在理论上应该是可能的。`git status`显示有 8 个提交要提取，如果脚本可以解析出“8”并输入（默认为 1）作为您想要的下一次提交的数量。你可以运行`git-pull-next 2`，它可以这样做：

1.  以某种方式，检查有多少新提交（git status 有效）
2.  设置为变量`newCommits`
3.  还设置变量 ,`pullNextNCommits`等于 cli 输入，默认为 1
4.  运行 git pull
5.  运行 git 日志
6.  获取之前的提交哈希`newCommits`，减去`pullNextNCommits`
7.  存储变量`current_git_branch`作为结果`git rev-parse --abbrev-ref HEAD`
8.  跑`git checkout <hash>`
9.  在本地删除 current_git_branch
10.  `git checkout -b current_git_branch`

多田！不是不可能！只需要写这个脚本...

这个答案是一个社区维基，请随意充实伪代码

可能有更好的方法来做到这一点 - 因为 git pull merge 可能有问题，最好从这里的第一个答案中获得灵感。但不知何故，以编程方式找到下一个提交哈希。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-24T23:07:26.243

你可以。非常简单：

```
git fetch
git log --oneline --decorate --graph --all
git merge <some-commit-id>
#Repeat last line as often as you wish
#to incorporate upstream changes piecemeal. 
```

标志的组合`git log`对于快速了解发生的事情非常有用，以至于我总是定义一个 shell 别名来使用这种精确的组合：

```
alias gitlog='git log --oneline --decorate --graph' 
```

使用该别名，上述序列变为

```
git fetch
gitlog --all
git merge ...
... 
```

# wpf - 如何在控件模板中为 WPF 中的 ListView 列应用 MinWidth？

> ID：10097574
> 
> 赞同：5
> 
> 时间：2012-04-10T22:50:44.187
> 
> 标签：wpf, xaml, listview, controltemplate, gridviewcolumn

[按照此处](https://stackoverflow.com/questions/852872/minwidth-for-listview-column-in-wpf)类似问题的答案，我能够在 XAML 页面上设置 MinWidth。

我想做的是在所有 ListView 中的所有 GridViewColumn 的控件模板中完成此操作。

这可能吗？

**更新：**

我在下面尝试了一些简单的示例代码，但它不起作用：

```
<Window x:Class="WpfApplication4.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">

    <Window.Resources>
        <Style TargetType="{x:Type GridViewColumnHeader}" >
            <Setter Property="MinWidth" Value="200" />
        </Style>
    </Window.Resources>

    <Grid Width="500">
        <Border BorderBrush="Black" BorderThickness="2" Margin="20">
            <ListView SelectionMode="Single">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="Header 1" Width="Auto">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="Hello There"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Header 2" Width="Auto" />
                    </GridView>
                </ListView.View>
            </ListView>
        </Border>
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-12-11T11:00:52.367

如果您使用 GridViewColumnHeader 您可以处理大小更改：

```
 <GridView>
     <GridViewColumn>
        <GridViewColumnHeader Content="HeaderContent" SizeChanged="HandleColumnHeaderSizeChanged"/> 
   ... 
```

在代码中：

```
 private void HandleColumnHeaderSizeChanged(object sender, SizeChangedEventArgs sizeChangedEventArgs)
    {
        if (sizeChangedEventArgs.NewSize.Width <= 60) {
            sizeChangedEventArgs.Handled = true;
            ((GridViewColumnHeader) sender).Column.Width = 60;
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T00:11:35.883

```
<Window.Resources>
    <Style TargetType="{x:Type GridViewColumnHeader}" >
        <Setter Property="MinWidth" Value="400" />
    </Style>
</Window.Resources> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-10T23:13:58.900

```
 <ListView>
        <ListView.View>
            <GridView>
                <GridViewColumn>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock MinWidth="100"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                 ...more columns...
            </GridView>
        </ListView.View>
    </ListView> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-02T20:47:06.903

我也偶然发现了这个。为了解决它，我必须做两件事：

1.  修改ListView头部的ControlTemplate。
2.  在 ControlTemplate 中处理 Thumb 的 DragDelta 事件。

ListView 的标题是[GridViewColumnHeader](http://msdn.microsoft.com/en-us/library/system.windows.controls.gridviewcolumnheader.aspx)。下面显示的是 GridViewColumnHeader 的 ControlTemplate 的简化版本。正如我们所见，它使用 Canvas 中的[Thumb](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.thumb%28v=vs.100%29.ASPX)来创建拖动/调整大小效果。

*PS：获取完整的GridViewColumnHeader ControlTemplate请参考[如何抓取WPF 4.0控件默认模板？](https://stackoverflow.com/questions/3526378/how-to-grab-wpf-4-0-control-default-templates)*

```
<ControlTemplate TargetType="GridViewColumnHeader">
<Grid SnapsToDevicePixels="True">
    <Border BorderThickness="0,1,0,1" Name="HeaderBorder" ...>
    <!-- omitted -->
    </Border>
    <Border BorderThickness="1,0,1,1" Name="HeaderHoverBorder" Margin="1,1,0,0" />
    <Border BorderThickness="1,1,1,0" Name="HeaderPressBorder" Margin="1,0,0,1" />
    <Canvas>
        <Thumb Name="PART_HeaderGripper">
        <!-- omitted -->
        </Thumb>
    </Canvas>
</Grid>
<ControlTemplate.Triggers>
<!-- omitted -->
</ControlTemplate.Triggers> 
```

所以为了限制GridViewColumnHeader的大小，我们需要hook Thumb的拖动事件（DragStarted、DragDelta、DragCompleted...等）。

原来我们只需要[DragDelta](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.thumb.dragdelta%28v=vs.100%29.ASPX)事件，只要我们知道[DragDeltaEventHandler](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.dragdeltaeventhandler%28v=vs.100%29.ASPX)中的 MinSize 即可。

下面显示的是带有注释的修改后的 XAML。

```
<Grid Width="500">
    <Border BorderBrush="Black" BorderThickness="2" Margin="20">
        <ListView SelectionMode="Single">
            <ListView.View>
                <GridView>                        
                    <GridViewColumn Header="Header 1" Width="Auto">
                        <!-- Apply a style targeting GridViewColumnHeader with MinWidth = 80 and a ControlTemplate -->
                        <GridViewColumn.HeaderContainerStyle>
                            <Style TargetType="{x:Type GridViewColumnHeader}">
                                <Setter Property="MinWidth" Value="80" />
                                <Setter Property="Control.Template" Value="{DynamicResource myGridViewColumnHeaderControlTemplate}" />
                            </Style>
                        </GridViewColumn.HeaderContainerStyle>**
                    </GridViewColumn>
                    <GridViewColumn Header="Header 2" Width="Auto" />
                </GridView>
            </ListView.View>
        </ListView>
    </Border>
</Grid> 
```

在 myGridViewColumnHeaderControlTemplate 中添加一些 XAML 到：

1.  将 GridViewColumnHeader 的 MinWidth 绑定到 Canvas 的 MinWidth。
2.  连接 Thumb 的 DragDelta 事件。

> ```
> <ControlTemplate x:Key="TemplateGridViewColumnHeader" TargetType="GridViewColumnHeader">
>     <!-- omitted -->
>     <Canvas MinWidth="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=MinWidth, Mode=OneTime}">
>         <Thumb x:Name="PART_HeaderGripper" DragDelta="myGridViewColumnHeader_DragDelta"> 
> ```

最后是 myGridViewColumnHeader_DragDelta 函数：

```
 private void myGridViewColumnHeader_DragDelta(object sender, DragDeltaEventArgs e)
    {
        DependencyObject parent = sender as DependencyObject;

        try
        {
            do
            {
                parent = VisualTreeHelper.GetParent(parent as DependencyObject);
            } while (parent.GetType() != typeof(Canvas));

            Canvas canvas = parent as Canvas;
            if (canvas.ActualWidth + e.HorizontalChange < canvas.MinWidth)
            {
                e.Handled = true;
            }
        }
        catch
        {
        }
    } 
```

这是我找到工作的唯一方法。希望有更简单的方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-07-19T11:37:32.307

我想对所有列应用 minwidth，所以我写了这个：

```
 public static class GridViewConstraints
  {
    public static readonly DependencyProperty MinColumnWidthProperty =
        DependencyProperty.RegisterAttached("MinColumnWidth", typeof(double), typeof(GridViewConstraints), new PropertyMetadata(75d, (s,e) =>
        {
            if(s is ListView listView)
            {
                listView.Loaded += (lvs, lve) =>
                {
                    if(listView.View is GridView view)
                    {
                        foreach (var column in view.Columns)
                        {
                            SetMinWidth(listView, column);

                            ((System.ComponentModel.INotifyPropertyChanged)column).PropertyChanged += (cs, ce) =>
                            {
                                if (ce.PropertyName == nameof(GridViewColumn.ActualWidth))
                                    SetMinWidth(listView, column);
                            };
                        }
                    }
                };
            }
        }));

    private static void SetMinWidth(ListView listView, GridViewColumn column)
    {
        double minWidth = (double)listView.GetValue(MinColumnWidthProperty);

        if (column.Width < minWidth)
            column.Width = minWidth;
    }

    public static double GetMinColumnWidth(DependencyObject obj) => (double)obj.GetValue(MinColumnWidthProperty);

    public static void SetMinColumnWidth(DependencyObject obj, double value) => obj.SetValue(MinColumnWidthProperty, value);
} 
```

只需将其放在您的列表视图中：

```
<ListView b:GridViewConstraints.MinColumnWidth="255" /> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-05-03T06:47:23.733

如果您想为所有列设置不同的最小宽度并将最大值设置为自动，您可以尝试这个，对于每一列

```
 <ListView.View>
    <GridView >
        <GridViewColumn Header="FILE NAME" DisplayMemberBinding="{Binding fileName}" Width="auto" >
            <GridViewColumn.HeaderContainerStyle>
                <Style TargetType="{x:Type GridViewColumnHeader}">
                    <Setter Property="MinWidth" Value="200" />

                </Style>
            </GridViewColumn.HeaderContainerStyle>
        </GridViewColumn>
                <GridViewColumn Header="ERROR DETAILS" DisplayMemberBinding="{Binding errorMessage}" Width="auto">
            <GridViewColumn.HeaderContainerStyle>
                <Style TargetType="{x:Type GridViewColumnHeader}">
                    <Setter Property="MinWidth" Value="396" />

                </Style>
            </GridViewColumn.HeaderContainerStyle>
        </GridViewColumn>

    </GridView>
</ListView.View> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-28T07:59:01.440

更新比利·杰克·奥康纳 ( [Billy Jake O'Connor](https://stackoverflow.com/users/982057/billy-jake-oconnor) ) 的解决方案，他提供了最简单、易于实施和工作正确的解决方案。

对于不希望所有列共享相同最小宽度的人，通过下一次代码更新，您可以为每列设置特定的最小宽度，直接在列属性中指定最小宽度。

```
public static class GridColumn {
    public static readonly DependencyProperty MinWidthProperty =
        DependencyProperty.RegisterAttached("MinWidth", typeof(double), typeof(GridColumn), new PropertyMetadata(75d, (s, e) => {
            if(s is GridViewColumn gridColumn ) {
                SetMinWidth(gridColumn);
                ((System.ComponentModel.INotifyPropertyChanged)gridColumn).PropertyChanged += (cs, ce) => {
                    if(ce.PropertyName == nameof(GridViewColumn.ActualWidth)) {
                        SetMinWidth(gridColumn);
                    }
                };
            }
        }));

    private static void SetMinWidth(GridViewColumn column) {
        double minWidth = (double)column.GetValue(MinWidthProperty);

        if(column.Width < minWidth)
            column.Width = minWidth;
    }

    public static double GetMinWidth(DependencyObject obj) => (double)obj.GetValue(MinWidthProperty);

    public static void SetMinWidth(DependencyObject obj, double value) => obj.SetValue(MinWidthProperty, value);
} 
```

XAML 可能是这样的（“本地”是您使用的命名空间名称，请进行相应修改）

```
<ListView>
    <ListView.View>
        <GridView>
            <GridViewColumn local:GridColumn.MinWidth="25" />
            <GridViewColumn local:GridColumn.MinWidth="100" />
            <GridViewColumn local:GridColumn.MinWidth="200" />
        </GridView>
    </ListView.View>
</ListView> 
```

# data-structures - 我如何像二维数组一样迭代四重链接的二维数据网格？

> ID：10097583
> 
> 赞同：0
> 
> 时间：2012-04-10T22:51:29.980
> 
> 标签：data-structures, grid, recursive-datastructures

我如何像二维数组一样迭代四重链接的二维数据网格？

我的网格结构是：

```
typedef bool tile;

struct BLOCK;
typedef struct BLOCK block;

struct BLOCK {
 const block * to_the_left;
 const block * above;
 const block * to_the_right;
 const block * below;

 tile data;
};

typedef struct {
 const block * start;
} map; 
```

我需要能够像二维数组一样遍历这个网格，这样我就可以在屏幕上以起始块为中心显示地图的图块。

PSS 我最希望看到 C 中的解决方案（这是我为这个项目编写的代码）、C++、Haskell 或 Java 代码，因为这些都是我熟悉的语言，但任何语言都可以。我只需要算法。

PSSS 为清楚起见，通过像二维数组一样迭代，我的意思是我需要获取 x 和 y 位置的索引作为变量。例如，我需要调用 mvaddch(y,x,'#')。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:56:47.637

这将以与二维数组相同的顺序迭代

```
 BLOCK * process = upper_left_block;
    BLOCK * leftmost = process;
    while(true)
    {
        //<do stuff here>
        process = process->to_the_right;
        if(process == null)
        {
            process = leftmost->below;
            leftmost = process;
        }
        if(process == null)
            break;
    } 
```

# css - 奇怪的 IE 问题 - CSS 定位不正确

> ID：10097586
> 
> 赞同：-2
> 
> 时间：2012-04-10T22:51:54.660
> 
> 标签：css, internet-explorer, internet-explorer-8, internet-explorer-7, internet-explorer-9

这是该网站的链接[http://kennunn.com/our_attorneys-new.html](http://kennunn.com/our_attorneys-new.html)。

如果你在 Chrome 中加载它，你会看到它的外观。问题是 IE 7-9 将正确加载此页面，直到它决定进行一些重新排列，并且将旁边的律师图片和内容完全移出位置。我不确定是什么导致它在页面加载结束时突然搞砸了。

我们正在使用来自 fonts.com 的 Web 字体和他们的 CSS API，但我尝试删除它，但没有帮助。

希望有人可以帮助我们，因为我一直在为此烦恼。

感谢您的时间和努力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:06:28.203

该问题似乎与您的脚本有关，`fixpng.js`. 乍一看，它似乎将图像的父节点设置为`position:absolute`，这自然会搞砸你的布局。

当我跳过该代码时，它呈现得很好。

# android - ListView 图片下载器并发问题

> ID：10097589
> 
> 赞同：0
> 
> 时间：2012-04-10T22:52:22.810
> 
> 标签：android, multithreading, android-listview, android-imageview, android-viewbinder

我正在尝试在“ListView.xml”中延迟从网络加载图像。我已经按照[这里](http://android-developers.blogspot.it/2010/07/multithreading-for-performance.html)的教程进行操作。

它非常有用，但不幸的是，即使我完全按照它的存在（通过实现实际工作的文件缓存）我仍然存在并发问题（即图像出现在错误的位置）。

我使用的唯一不同的东西是`SimpleCursorAdapter`a`ViewBinder`而不是 custom `ArrayAdapter`。会不会是这个原因？重要的区别可能是r`ArrayAdapter`没有使用该`ViewHolder`模式。`SimpleCursorAdapte`有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:00:16.740

如果它有任何帮助，这里是一个非常简单的线程图像下载器实现。到目前为止，我在所有应用程序中都使用了它。唯一的缺点是图像缓存到期，但我仍然对此感到满意。它缓存在 SD 卡和内存中。

[http://theandroidcoder.com/utilities/android-image-download-and-caching/](http://theandroidcoder.com/utilities/android-image-download-and-caching/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T02:01:10.833

请参阅以下链接以获取图像。

[关联](http://w2davids.wordpress.com/android-listview-with-iconsimages-and-sharks-with-lasers/)

[LINK2](http://davidmarquis.posterous.com/android-listview-with-images-using-droid-fu-w)参考使用自定义webimageview

[链接3](http://androidcookbook.com/Recipe.seam;jsessionid=5424397F3130CE7769FF47DD67742911?recipeId=1418&recipeFrom=ViewTOC)

也试试这些链接可能是你在寻找这些。

[LINK4](https://github.com/thest1/LazyList)指 LazyList

[LINK5](http://www.androidkit.com/loading-images-from-remote-server-over-http-on-a-separate-thread)从服务器加载图像（即从 url）。

# php - 以月/日/年格式在数据库中按名称搜索月份

> ID：10097591
> 
> 赞同：0
> 
> 时间：2012-04-10T22:52:24.567
> 
> 标签：php, mysql

我试图用php和Mysql开发一个搜索系统，但是你如何搜索：例如数据库中日期格式为2012-03-26（年/月/日）的三月

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T22:56:30.390

根据列数据的格式，这样的事情可能会起作用：（许多解决方案之一）

```
SELECT [whatever] 
FROM [wherever] 
WHERE `date` < '2012-03-31 23:59:59' 
AND `date` > '2012-03-01 00:00:00' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:01:05.667

您可以像这样使用 mysql [MONTH()](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_month%22month%28%29%22)函数：

```
SELECT * FROM table WHERE MONTH(date_column) = 3 
```

例如搜索 March，或者还有这样的 MONTHNAME() 函数：

```
SELECT * FROM table WHERE MONTHNAME(date_column) = 'march' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:00:25.277

尝试类似的东西

```
SELECT   keyword ,  description , url FROM searchTable WHERE MONTH(addDate) = '3' 
SELECT   keyword ,  description , url FROM searchTable WHERE MONTHNAME(addDate) = 'March' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T23:46:37.083

这是一个相当粗略的示例，说明您如何处理搜索表单中的日期 -

```
<form method="get" action="">
    Year:
    <select name="year">
        <option value="2012">2012</option>
        <option value="2011">2011</option>
        <option value="2010">2010</option>
    </select>
    Month:
    <select name="month">
        <option value="1">January</option>
        <option value="2">February</option>
        <option value="3">March</option>
    </select
    <input type="submit" name="search" value="search"/>
</form>
<?php

if (isset($_GET['search'])) {
    $year = intval($_GET['year']);
    $month = intval($_GET['month']);

    $sql = "SELECT *
            FROM `table`
            WHERE `date` BETWEEN '$year-$month-01' AND LAST_DAY('$year-$month-01')";
} 
```

# sonarqube - 无法成功安装声纳 2.14

> ID：10097593
> 
> 赞同：1
> 
> 时间：2012-04-10T22:52:48.087
> 
> 标签：sonarqube

我的机器使用 32 位 windows xp 作为操作系统，我只想使用 Apache Derby 来测试声纳。任何帮助将不胜感激。这是日志文件

```
wrapper  | --> Wrapper Started as Console
wrapper  | Launching a JVM...
jvm 1    | Wrapper (Version 3.2.3) http://wrapper.tanukisoftware.org
jvm 1    |   Copyright 1999-2006 Tanuki Software, Inc.  All Rights Reserved.
jvm 1    | 
jvm 1    | 2012-04-11 08:39:52.774:INFO::Logging to STDERR via org.mortbay.log.StdErrLog
jvm 1    | 2012-04-11 08:39:52.805:INFO::jetty-6.1.25
jvm 1    | 2012-04-11 08:39:52.915:INFO::NO JSP Support for /, did not find org.apache.jasper.servlet.JspServlet
jvm 1    | JRuby limited openssl loaded. http://jruby.org/openssl
jvm 1    | gem install jruby-openssl for full support.
jvm 1    | Server must be upgraded. Please browse /setup
jvm 1    | 2012-04-11 08:40:03.763:INFO::Started SelectChannelConnector@localhost:9000 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T06:19:13.603

您收到以下消息“必须升级服务器”，这意味着您已在以前的版本上安装了 Sonar 2.14（或者您已将 Derby 文件夹复制到新安装中）。我们在文档中明确指定 Derby 不支持迁移：这意味着您应该在新位置安装 Sonar 2.14（或删除旧的安装文件夹）。

# c++ - 将节点添加到双向链表时遇到问题

> ID：10097598
> 
> 赞同：1
> 
> 时间：2012-04-10T22:53:18.933
> 
> 标签：c++, doubly-linked-list

嗨，我正在尝试制作一个双向链表，将单个数字存储为双向链表的节点，然后将它们加在一起并打印出来以进行家庭作业。我在让它工作时遇到了很多麻烦，并将我的问题追溯到我的添加节点函数，因为它们没有正确更新指针。例如，在 AddToFront() 函数上，我无法理解如何让 prev 指针工作并指向它后面的节点。

我不能使用 STL，必须自己实现 LL，以防有人想知道。谢谢！

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <math.h>
#include <iostream>

using namespace std;

/////// PART A
template <class T>
class List {
private:
    struct Node {
        T data;
        Node *next;
        Node *prev;
    };
    Node *front, *current, *rear;

public:
    List();
    ~List();
    void AddtoFront (T newthing);
    void AddtoRear (T newthing);
    bool FirstItem (T & item);
    bool LastItem (T & item);
    bool NextItem (T & item);
    bool PrevItem (T & item);
};

template <class T>
List<T>::List() {
  front = NULL;  current = NULL; rear = NULL;
}
template <class T>
List<T>::~List() {

}

template <class T>
void List<T>::AddtoFront (T newthing) {
    if (front == NULL) {
        Node *temp;
        temp = new Node;
        temp->data = newthing;
        temp->next = front;
        temp->prev = NULL;
        front = temp;
    } else {
        Node *temp;
        temp = new Node;
            front->prev = temp;
        temp->data = newthing;
        temp->next = front;
        temp->prev = NULL;
        front = temp; 
    }
}

template <class T>
void List<T>::AddtoRear (T newthing) {
    if (rear == NULL) {
        Node *temp;
        temp = new Node;
        temp->data = newthing;
        temp->prev = rear;
        temp->next = NULL;
        rear = temp;
    } else {
        Node *temp;
        temp = new Node;
            rear->next = temp;
        temp->data = newthing;
        temp->prev = rear;
        temp->next = NULL;
        rear = temp;
    }
}

template <class T>
bool List<T>::FirstItem (T & item) {
    if (front == NULL) { return false; }
    current = front;
    item = front->data;
    return true;
}

template <class T>
bool List<T>::LastItem (T & item) {
    if (rear == NULL) { return false; }
    current = rear;
    item = rear->data;
    return true;
}

template <class T>
bool List<T>::NextItem (T & item) {
    if (current != NULL) current = current->next;
    if (current == NULL) { return false; }
    item = current->data;
    return true;
}

template <class T>
bool List<T>::PrevItem (T & item) {
    if (current == NULL) { return false; }
    if (current->prev != NULL) current = current->prev;
    item = current->data;
    return true;
}

/////// PART B
class BigNumber {
private:
//complete here...
//include here a List of integers, or shorts etc
    List<int>L;

public:
//complete here...
//what methods do you need?
//e.g., ReadFromString, PrintBigNumber, AddBigNumbers
    BigNumber();
    ~BigNumber();
    void ReadFromString(char * decstring);
    void PrintBigNumber();
    void AddBigNumbers(BigNumber B1, BigNumber B2);
};

BigNumber::BigNumber(){
// anything here?
}

BigNumber::~BigNumber(){
//you can keep that empty
}

void BigNumber::ReadFromString (char * decstring ) {
    //read a string, adding a new node per digit of the decimal string
    // To translate 'digits' to integers: myinteger=decstring[index]-48
    //You need to use the AddtoFront()
    int temp;
    for (unsigned i=0; i < strlen(decstring); ++i) {
        //cin >> decstring[i];
        temp = decstring[i]-48;
        //L.AddtoFront(temp);
        L.AddtoRear(temp);
        //cout <<"Number added!" <<endl;
    }
}

void BigNumber::PrintBigNumber () {
//complete here, print the list (i.e., use FirstItem() and NextItem() )
    int val;
    if (L.FirstItem(val)) {
        cout << val;
    } else {
        cout << "print failed";
    }
    //if (L.FirstItem(val)) { cout << "true-first";} else { cout <<"false-first";};
    //if (L.LastItem(val)) { cout << "true";} else { cout <<"false";};
    //L.FirstItem(val);
    //cout << val;
    /*while (L.PrevItem(val)){

            cout << val;
            //cout <<"Print error!Value not here.";
    }*/
}

void BigNumber::AddBigNumbers(BigNumber B1,BigNumber B2){
//complete here.
//use FirstItem(), NextItem() and AddNode()
//to add two big numbers, what do you have to do? Be careful about the carry
//Remember to add the last carry, the resulting number can have one more digit than B1 or B2
}

/////// PART C

BigNumber B1, B2, RES;

int main (int argc, char ** argv) {
  //use command line arguments
  if(argc!=3){printf("usage: executable number1 number2\n");exit(0);}
  B1.ReadFromString(argv[1]);
  B2.ReadFromString(argv[2]);
  //print
  cout << endl<< "Add the following numbers " << endl;
  B1.PrintBigNumber();
  cout << " + ";
  B2.PrintBigNumber();
  cout << " = " << endl;
  //compute the addition
  RES.AddBigNumbers(B1,B2);
  //print the result
  RES.PrintBigNumber();
  cout << endl;
  return 0;
} 
```

编辑：我在 AddToFront() 和 AddToRear() 中分别添加了一行。这是在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T22:57:39.220

`AddtoFront`还需要更新`prev`. `front`也就是说，你目前正在做

```
temp -> front <-> rest_of_list 
```

它需要在哪里

```
temp <-> front <-> rest_of_list. 
```

此外，您可能会注意到您的`if`语句的两个分支`AddtoFront`是相同的...... :)

# java - JList 复制选择

> ID：10097601
> 
> 赞同：6
> 
> 时间：2012-04-10T22:53:48.617
> 
> 标签：java, swing, arraylist, jlist

我正在尝试使用 Swing，并决定专注于将 JList 与对象数组列表结合使用。

我想创建一个显示空白 JList 的程序，当按下按钮时将显示 arraylist 的内容，并允许单选打印出曾经选择的内容。

我当前的代码执行上述所有操作，但是当我单击 JList 上的单个条目时，它会打印两次。我觉得这是一个很容易纠正的简单错误，但我一直在阅读它，我的大脑已经停止合作。

任何帮助将不胜感激。提前致谢 ：）

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.util.ArrayList;
import javax.swing.event.*;

public class textarea {

    ArrayList <Pet> petList = new ArrayList <Pet> ();
    DefaultListModel model = new DefaultListModel();
    JList list = new JList();

    public static void main (String [] args){

        textarea gui = new textarea();
        gui.go();
    }

    public void go(){

        petList.add(new Pet("Lucy","Dog",5));
        petList.add(new Pet("Geoff","Cat",2));
        petList.add(new Pet("Hammond","Hamster",1));

        model = new DefaultListModel();
        for(Pet p:petList){
            model.addElement(p.toString());
        }

        JFrame frame = new JFrame();
        JPanel panel = new JPanel();
        JButton button = new JButton("view pets");
        button.addActionListener(new ButtonListener());

        JScrollPane scroller = new JScrollPane(list);
        scroller.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        scroller.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);

        panel.add(scroller);

        list.setVisibleRowCount(4);
        list.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        list.addListSelectionListener(new ListSelectionListener(){
            public void valueChanged(ListSelectionEvent event){
                String selection = (String) list.getSelectedValue();
                System.out.println(selection);
            }
        });

        frame.getContentPane().add(BorderLayout.CENTER,panel);
        frame.getContentPane().add(BorderLayout.SOUTH,button);

        frame.setSize(350,300);
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    }//end go()

        class ButtonListener implements ActionListener{
        public void actionPerformed(ActionEvent event){
                list.setModel(model);
            }
        }//end ButtonListener

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T23:15:37.533

简短的回答：`if (!event.getValueIsAdjusting())`像这样在你的印刷品周围添加：

```
list.addListSelectionListener(new ListSelectionListener()
{
  public void valueChanged(ListSelectionEvent event)
  {
    if (!event.getValueIsAdjusting())
    {
      String selection = (String) list.getSelectedValue();
      System.out.println(selection);
    }
  }
}); 
```

长答案：正在触发两个事件。单击鼠标时触发一个，释放鼠标时触发另一个。我们通常将单击视为单个动作，但实际上它是由鼠标按下、任何移动和鼠标释放组成的。在这些阶段，选择的内容可以改变。运行您的代码并尝试单击一行，拖动到其他行，然后释放。您会看到每次行更改时都会触发事件。通过仅在值不再调整时采取行动，您可以在“最终”状态下触发。

来源：[ListSelectionEvent Javadocs](http://docs.oracle.com/javase/7/docs/api/javax/swing/event/ListSelectionEvent.html#getValueIsAdjusting%28%29)和[ListSelectionModel Javadocs](http://docs.oracle.com/javase/7/docs/api/javax/swing/ListSelectionModel.html#setValueIsAdjusting%28boolean%29)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T23:06:34.990

刚刚测试了你的代码。在项目选择上发送 2 个事件。我能看到的唯一区别是 isAdjusting 布尔值。第一次设置为true，第二次设置为false

无论如何，这似乎是标准行为

# php - Magento 多语言

> ID：10097602
> 
> 赞同：-1
> 
> 时间：2012-04-10T22:53:51.253
> 
> 标签：php, zend-framework, magento

[目前我在http://www.mywebsite.com](http://www.mywebsite.com)上安装了一个 Magento 网站，目录中有大约 150 种产品，只有一种语言：英语。

现在我需要在我的网站上安装另一种语言，德语。但是这家德国商店的目录中只有大约 30 种产品，其域名为[http://www.mywebsite.de](http://www.mywebsite.de)。

我从来没有处理过这样的情况，是不是又长又难？谁能给我一些关于如何进行的建议？

我认为这是 Magento 开发人员的经典场景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:13:53.183

我认为这并不难，您需要从管理商店部分创建另一个商店，您应该对多商店有完整的了解。对于不同的域。配置两个商店后，您需要从连接管理器安装德语语言包。然后你必须从管理部分的配置->通用->本地部分中选择语言。那么您必须为两个不同的商店英语和德语导入产品。

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T07:47:44.417

1.  **从http://www.magentocommerce.com/translations**下载语言包，然后将其解压缩到您的 magento 目录。当系统询问文件夹“app”是否会被替换时，点击“yes to all”

2.  然后转到系统-> 配置。

3.  单击右上角的 Create Store View 链接，然后在 store 中输入这些

店铺：总店

名称：“语言名称”

代码：任意

状态：启用

排序顺序是可选的。

在这里，您还可以通过禁用其状态来禁用任何商店视图。

保存，返回系统 > 配置。在当前配置范围下拉框中，您现在看到有新的商店视图。单击该链接。在左侧的区域设置选项卡上，取消选中“使用网站”复选框，然后将区域设置更改为您刚刚创建的商店视图的名称。节省。 **现在您可以使用您选择的语言来创建您的网站。** 您也可以执行此步骤来配置其他现有商店视图。

享受！

# c# - 睡眠任务（System.Threading.Tasks）

> ID：10097605
> 
> 赞同：10
> 
> 时间：2012-04-10T22:54:42.817
> 
> 标签：c#, winforms, multithreading, sleep, taskfactory

我需要创建线程来替换[Windows 窗体](https://en.wikipedia.org/wiki/Windows_Forms)窗口中的照片，而不是等待*约 1 秒*并恢复上一张照片。

我认为以下代码：

```
TaskScheduler ui = TaskScheduler.FromCurrentSynchronizationContext();
var task = Task.Factory.StartNew(() =>
{
    pic.Image = Properties.Resources.NEXT;
    Thread.Sleep(1000);
    pic.Image = Properties.Resources.PREV;
}, CancellationToken.None, TaskCreationOptions.LongRunning, ui) 
```

做这项工作，但不幸的是没有。它冻结了主 UI 线程。

那是因为不能保证每个任务有一个线程。一个线程可用于处理多个任务。甚至[TaskCreationOptions.LongRunning](https://msdn.microsoft.com/en-us//library/system.threading.tasks.taskcreationoptions(v=vs.110).aspx)选项也无济于事。

我该如何解决？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-11T04:31:11.997

Thread.Sleep 是一个*同步延迟*。如果您想要*异步延迟*，请使用[*Task.Delay*](http://msdn.microsoft.com/en-us/library/hh139096%28v=VS.110%29.aspx)。

在目前处于 beta 版本的 C# 5 中，您可以简单地说

```
await Task.Delay(whatever); 
```

在异步方法中，该方法将自动从中断处继续。

如果您不使用 C# 5，那么您可以“手动”设置您希望自己继续延迟的任何代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-10T23:07:36.813

当您传递来自当前同步上下文的新 TaskScheduler 时，实际上是在告诉任务在 UI 线程上运行。您实际上想要这样做，因此您可以更新 UI 组件，但是您不想在该线程上休眠，因为它会阻塞。

这是何时`.ContinueWith`是理想的一个很好的例子：

```
TaskScheduler ui = TaskScheduler.FromCurrentSynchronizationContext();
var task = Task.Factory.StartNew(() =>
                                     {
                                         pic.Image = Properties.Resources.NEXT;
                                     },
                                 CancellationToken.None,
                                 TaskCreationOptions.None,
                                 ui);

task.ContinueWith(t => Thread.Sleep(1000), TaskScheduler.Default)
    .ContinueWith(t =>
                      {
                          pic.Image = Properties.Resources.Prev;
                      }, ui); 
```

* * *

编辑（删除了一些东西并添加了这个）：

发生的情况是我们阻塞 UI 线程只有足够的时间来更新`pic.Image`。通过指定`TaskScheduler`，您是在告诉它在哪个线程上运行任务。重要的是要知道 Tasks 和 Threads 之间的关系不是 1:1。实际上，您可以在相对较少的线程上运行 1000 个任务，甚至 10 个或更少，这完全取决于每个任务的工作量。不要假设您创建的每个任务都将在单独的线程上运行。CLR 在自动为您平衡性能方面做得很好。

现在，您不必使用 default `TaskScheduler`，如您所见。当你传递 UI`TaskScheduler`时，也就是`TaskScheduler.FromCurrentSynchronizationContext()`它使用 UI 线程而不是线程池`TaskScheduler.Default`。

记住这一点，让我们再次查看代码：

```
var task = Task.Factory.StartNew(() =>
                                     {
                                         pic.Image = Properties.Resources.NEXT;
                                     },
                                 CancellationToken.None,
                                 TaskCreationOptions.None,
                                 ui); 
```

在这里，我们正在创建并启动一个将在*UI*线程上运行的任务，该任务将使用您的资源更新 的`Image`属性。`pic`执行此操作时，*UI*将无响应。幸运的是，这可能是一个*非常*快的操作，用户甚至不会注意到。

```
task.ContinueWith(t => Thread.Sleep(1000), TaskScheduler.Default)
    .ContinueWith(t =>
                      {
                          pic.Image = Properties.Resources.Prev;
                      }, ui); 
```

使用此代码，我们正在调用该`ContinueWith`方法。它完全符合听起来的样子。它返回一个新`Task`对象，该对象将在运行时执行 lambda 参数。当任务完成、出错或被取消时，它将启动。您可以通过传入来控制它何时运行`TaskContinuationOptions`。但是，我们还传递了一个与以前不同的任务调度程序。这是默认任务调度程序，它将在线程池线程上执行任务，因此不会阻塞 UI。此任务可能会运行数小时，并且您的 UI 将保持响应（不要让它），因为它是与您正在交互的 UI 线程不同的线程。

我们还调用`ContinueWith`了我们设置为在默认任务调度程序上运行的任务。这是将再次更新 UI 线程上的图像的任务，因为我们已将相同的 UI 任务调度程序传递给正在执行的任务。一旦线程池任务完成，它将在 UI 线程上调用它，在更新图像时将其阻塞很短的时间。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-10T23:03:35.530

您应该`Timer`在将来的某个时候使用 a 来执行 UI 任务。只需将其设置为运行一次，间隔为 1 秒。将 UI 代码放入 tick 事件中，然后将其关闭。

如果你*真的*想使用任务，你会希望其他任务不在 UI 线程中运行，而是在后台威胁中运行（即只是一个常规`StartNew`任务），然后使用任务内部的 Control.Invoke 来运行UI线程上的命令。这里的问题是'创可贴'启动任务只是为了让它睡觉的潜在问题。最好只让代码在第一时间不执行整整一秒。

# php - 如何使用 cron 作业运行 php 文件

> ID：10097609
> 
> 赞同：17
> 
> 时间：2012-04-10T22:55:14.433
> 
> 标签：php, cron

我每天使用 cron 作业在 php 页面上运行电子邮件计划。当我使用链接运行页面时，php 代码运行良好。

现在，当我使用 cron 作业运行 php 脚本时，它也可以正常工作，但是当我进行一些查询时，cron 作业将无法理解链接。

例如：`http://www.wetube.org/cron.php?id=01001`所以现在如果我尝试每天使用 cron 作业运行它，它就不起作用了。

但是，如果我们只是删除查询，它就可以正常工作。你们知道使这个链接在 cron 工作中工作的任何代码吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-10T23:03:15.603

Cron 运行命令就像它们通过 shell 运行一样，因此运行 PHP 将使用本地路径。

您需要使用如下命令：

`php /home/USER/public_html/cron.php`

或者，如果需要包含查询字符串，请改用 cURL（如果已安装）：

`curl http://www.wetube.org/cron.php?id=01001`

您可能希望不要将您的 cron 脚本暴露在互联网上 - 将它们移动到您的 web 目录之外，因为如果有人发现它，他们可以不断重新加载它以向您的 cron 脚本发送垃圾邮件（即发送大量电子邮件）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-10-01T09:00:03.193

我会像这样添加哈希

```
curl http://www.wetube.org/cron.php?id=01001&hash=cm349ucKuc023b2ynGyv23ycr23 
```

并在 php 文件中

```
if(isset($_GET['hash']) && $_GET['hash']=='cm349ucKuc023b2ynGyv23ycr23'){
....
stuff to do
....
} 
```

*您甚至可以在应该运行时添加特定的时间/日期检查。
*您可以使用相同的盐甚至时间检查 cron 和 php 文件中的 IP
*生成 sha512（我会推荐）哈希，然后检查它们是否相同 - 黑客不可能重新创建它 - 除非他以某种方式获得了您的原始哈希设置

# c# - P&P RetryPolicy, what is transient exception

> ID：10097612
> 
> 赞同：1
> 
> 时间：2012-04-10T22:55:29.057
> 
> 标签：c#, .net, azure

I tried to use Microsoft.WindowsAzure.StorageClient.RetryPolicy; without connecting to Azure services

```
var _retry = RetryPolicyFactory.GetRetryPolicy<StorageTransientErrorDetectionStrategy>("Incremental Retry Strategy");
  var result = _retry.ExecuteAction(()=> InnerRequest(data)); 
```

the question is - what should do InnerRequest method do to RetryPolicy began work? it should throw some sort of specified exception?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T07:05:17.733

Transient errors are detected automatically by the error detection strategies available in the **Microsoft.Practices.EnterpriseLibrary.WindowsAzure.TransientFaultHandling** assembly (like the **StorageTransientErrorDetectionStrategy** in your snippet), and this will trigger the retry policy.

In reality, this is based on what you can find in the **Microsoft.Practices.TransientFaultHandling.Core** assembly. Each error detection strategy in the Azure specific assembly implements the following interface:

```
/// <summary>
/// Defines an interface which must be implemented by custom components responsible for detecting specific transient conditions.
/// </summary>
public interface ITransientErrorDetectionStrategy
{
    /// <summary>
    /// Determines whether the specified exception represents a transient failure that can be compensated by a retry.
    /// </summary>
    /// <param name="ex">The exception object to be verified.</param>
    /// <returns>True if the specified exception is considered as transient, otherwise false.</returns>
    bool IsTransient(Exception ex);
} 
```

Here is an example of the **StorageTransientErrorDetectionStrategy** you use:

```
WebException webException = ex as WebException;
if (webException != null && (webException.Status == WebExceptionStatus.ProtocolError || webException.Status == WebExceptionStatus.ConnectionClosed))
{
    return true;
}
DataServiceRequestException dataServiceException = ex as DataServiceRequestException;
if (dataServiceException != null && StorageTransientErrorDetectionStrategy.IsErrorStringMatch(StorageTransientErrorDetectionStrategy.GetErrorCode(dataServiceException), new string[]
{
    "InternalError", 
    "ServerBusy", 
    "OperationTimedOut", 
    "TableServerOutOfMemory"
}))
{
    return true;
}
StorageServerException serverException = ex as StorageServerException;
if (serverException != null)
{
    if (StorageTransientErrorDetectionStrategy.IsErrorCodeMatch(serverException, new StorageErrorCode[]
    {
        1, 
        2
    }))
    {
        return true;
    }
    if (StorageTransientErrorDetectionStrategy.IsErrorStringMatch(serverException, new string[]
    {
        "InternalError", 
        "ServerBusy", 
        "OperationTimedOut"
    }))
    {
        return true;
    }
}
StorageClientException storageException = ex as StorageClientException;
return (storageException != null && StorageTransientErrorDetectionStrategy.IsErrorStringMatch(storageException, new string[]
{
    "InternalError", 
    "ServerBusy", 
    "TableServerOutOfMemory"
})) || ex is TimeoutException; 
```

# javascript - 键输入不起作用 Chrome？

> ID：10097614
> 
> 赞同：0
> 
> 时间：2012-04-10T22:55:32.600
> 
> 标签：javascript, google-chrome

我有一些代码可以在按键上运行功能：

```
document.onkeypress=function(e)
{
         var e=window.event || e
         var evtobj=window.event? event : e //distinguish between IE's explicit event object (window.event) and Firefox's implicit.
         var unicode=evtobj.charCode? evtobj.charCode : evtobj.keyCode
    if (unicode == 39)
    {
         Rotate();
    }
}

    function Rotate()
    {
        myDiv.setAttribute('style', '-moz-transform:rotate(' + rotationAmount + 'deg); -o-transform:rotate(' + rotationAmount + 'deg);-webkit-transform:rotate(' + rotationAmount + 'deg);-ms-transform:rotate(' + rotationAmount + 'deg)');
    } 
```

无论出于何种原因，按键输入在 Firefox 中有效，但在 Chrome 中无效。当我在 Chrome 中按下一个键时，什么也没有发生。我知道 Rotate() 函数在 Chrome 中工作，因为如果我在不同的条件下调用它，它运行没有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:01:22.817

您似乎正在检测右箭头键。对于这个和任何其他不可打印的击键，您应该使用该`keydown`事件并只使用该`keyCode`属性，该属性适用于所有主要浏览器。您还可以简化事件代码：

```
document.onkeydown = function(e)
{
    e = e || window.event;
    if (e.keyCode == 39)
    {
         Rotate();
    }
}; 
```

# r - 如何在 ggplot 命令中激活两个不同的 scale_fill_manual

> ID：10097615
> 
> 赞同：9
> 
> 时间：2012-04-10T22:55:54.563
> 
> 标签：r, graph, ggplot2

这个问题来自我[之前](https://stackoverflow.com/questions/9968975/using-ggplot2-in-r-how-do-i-make-the-background-of-a-graph-different-colours-in)关于 ggplot2 中背景颜色的问题。

从那里的答案中，我现在可以用来`geom_rect`为我的情节提供五种不同颜色的背景。最重要的是，我想绘制一个使用两种不同颜色的条形图。我可以分别完成这些任务中的每一项，但是当我尝试将它们组合起来时，`scale_fill_manual`命令会发生冲突。

这是我正在尝试的：

```
scores = data.frame(category = 1:4, percentage = c(34,62,41,44), type = c("a","a","a","b"))
rects <- data.frame(ystart = c(0,25,45,65,85), yend = c(25,45,65,85,100), col = letters[1:5])
labels = c("ER", "OP", "PAE", "Overall")
medals = c("navy","goldenrod4","darkgrey","gold","cadetblue1")

ggplot() + 
geom_rect(data = rects, aes(xmin = -Inf, xmax = Inf, ymin = ystart, ymax = yend, fill=col), alpha = 0.3) + 
scale_fill_manual(values=medals) +
opts(legend.position="none") + 
geom_bar(data=scores, aes(x=category, y=percentage, fill=type), stat="identity") +
#scale_fill_manual(values = c("indianred1", "indianred4")) +
scale_x_continuous(breaks = 1:4, labels = labels) 
```

如前所述，这使得两个条形图颜色与前两个背景颜色相同。删除`#`第二个命令（倒数第二行）上的“”`scale_fill_manual`会覆盖背景颜色命令以使条形成为我想要的颜色，但使背景只有我想要的两种颜色`barchart`。

如何将一个`scale_fill_manual`命令应用于`geom_rect`背景，将另一个命令应用于`geom_bar`条形图（或者如何通过其他方式实现相同的效果）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-10T23:33:50.497

问题是您在两者中都使用`"a"`and ，因此它们被映射到相同的颜色。由于矩形似乎是占位符值，请将它们更改为比.`"b"``rects``scores``scores`

```
rects$col <- c("Z1","Z2","Z3","Z4","Z5") 
```

现在你可以`scale_fill_manual`用所有 (7) 种颜色制作一个。

```
ggplot() + 
geom_rect(data = rects, aes(xmin = -Inf, xmax = Inf, ymin = ystart, 
                            ymax = yend, fill=col), alpha = 0.3) + 
opts(legend.position="none") + 
geom_bar(data=scores, aes(x=category, y=percentage, fill=type), stat="identity") +
scale_fill_manual(values=c("indianred1", "indianred4", medals)) +
scale_x_continuous(breaks = 1:4, labels = labels) 
```

![在此处输入图像描述](../Images/fbe7a1491615a3f3e467934746545fe0.png)

# database - 散列用于在 NoSQL 数据存储中查找的英语单词？

> ID：10097619
> 
> 赞同：1
> 
> 时间：2012-04-10T22:56:28.300
> 
> 标签：database, hash, nosql, amazon-web-services, datastore

我正在建立一个搜索引擎。我使用的是 NoSQL 各种键值数据存储，特别是 Amazon SimpleDB，而不是常规的 RDBMS。我有一个指向网页的 URL 表。我想我需要建立另一个表格，可以用来查找哪些页面包含给定的英文单词。

该表的结构是：`Search (String word, String URL)`我的查询看起来像`select from Search where word = "foo"`

**我应该在存储单词之前对单词进行哈希处理并进行查找吗？** IE。我应该使用表：`Search (String word_hash, String URL)`并使用类似的查询`select from Search where word = "acbd18db4cc2f85cedef654fccc4a4d8"`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:09:02.027

除非您将此作为练习，否则不要构建自己的。使用[狮身人面像](http://sphinxsearch.com/)或类似的东西。

如果这*是*一个练习，那就给野心加分吧！搜索引擎是一个大项目。

我认为自己散列单词没有任何价值。哈希表已经在内部完成了（它是一个*哈希*表）。稍后您可能想要进行基本的拼写更正，或者例如允许“books”也匹配“book”，此时使用纯文本单词会有所帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-10T20:11:53.597

陪审团是为一般案件而存在的。虽然看起来数据库会在内部散列，但肯定有一个重要的反例：BigTable 将其列为特定好处，例如“com.example.foo/*.html”之类的 URL 键将聚集在一起以实现它更容易建立谷歌搜索索引。（有关详细信息，请参阅 bigtable 论文）。

# java - 使用 MongoDB-Java 驱动程序从数组中删除一个条目

> ID：10097621
> 
> 赞同：10
> 
> 时间：2012-04-10T22:56:34.790
> 
> 标签：java, spring, mongodb

我有 JSON 喜欢：

```
{ 
    "_id" : "1",
    "_class" : "com.model.Test",
    "itemList" : [
        {
            "itemID" : "1",
            "itemName" : "Foo",
            "resources" : [ 
                { 
                    "resourceID" : "1",
                    "resourceName" : "Foo Test1"
                 }, {
                    "resourceID" : "2",
                    "resourceName" : "Foo Test2"
                 }
             ]
        }
    ]
} 
```

我需要能够删除 itemList 的记录之一。我做了以下事情：

```
public void removeItemByID(String docID, String itemID) throws Exception {
    MongoOperations mongoOperations = mongoConfiguration.getMongoTemplate();
    Query query = new   Query(where("_id").is(docID).and("itemList.itemID").is(itemID));
    mongoOperations.remove(query, Item.class); 
```

}

这种方法行不通。但是，当我将 BasicDBObject 与 $pull 方法一起使用时，它可以正常工作！这些方法有什么区别！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T05:36:47.530

如果你想删除一个数组，我通常使用以下内容：

```
BasicDBObject match = new BasicDBObject("_id", "1"); // to match your document
BasicDBObject update = new BasicDBObject("itemList", new BasicDBObject("itemID", "1"));
coll.update(match, new BasicDBObject("$pull", update)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-22T13:17:47.473

从模板中删除方法删除文档。如果要从数组中删除项目，则必须使用 pull。就像是

```
MongoOperations mongoOperations = mongoConfiguration.getMongoTemplate();
Query query = new Query(where("_id").is(docID).and("itemList.itemID").is(itemID));
Update update = new Update().pull("itemList", new BasicDBObject("itemID", "1"));
mongoOperations.updateFirst(query, update, Item.class); 
```

# asp.net - asp.net会员系统

> ID：10097623
> 
> 赞同：0
> 
> 时间：2012-04-10T22:56:46.420
> 
> 标签：asp.net, login, azure

我正在构建一个 asp.net 应用程序，该应用程序稍后将被移植到 azure。

目前，我将所有业务表放在一个数据库和一个用于会员资格的单独数据库中；它基本上是登录控件生成的默认数据库。

在业务数据库中，我有一个包含用户配置文件数据的表，一个字段是 TheUserID（它是一个 int）和另一个称为 TheUserMembership（一个字符串）的字段，它将包含由 asp.net 用户生成的用户 ID管理工具。

用户登录后，我将 TheUserID 存储在会话中，整个应用程序使用 int 作为标识符。

这是一个好方法吗？这个端口会变成天蓝色吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:01:39.940

用户 ID 是一个 GUID，您可以在 users 表上找到它，您不应该将用户 ID 存储到会话中，因为 cookie 可能会被盗。对于天蓝色的一个主要要求是所有表都有一个主键

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T04:17:17.087

您应该使用：http: [//msdn.microsoft.com/en-us/library/yh26yfzy.aspx](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)

然后是的，它将移植到 Azure 和 SQL Azure。

**Azure 的注意事项**

本地存储（磁盘存储）。由于您有多个实例，因此本地存储不起作用，因为您永远无法分辨它在哪个实例上。

出于与上述相同的原因，会话状态必须超出 proc。

这里或那里还有许多关于 Azure 的其他小事情，但这些将是移动时需要注意的 2 个最大的问题。

# javascript - Javascript验证控制

> ID：10097627
> 
> 赞同：0
> 
> 时间：2012-04-10T22:57:06.973
> 
> 标签：javascript, html, validation, dom-events

我编写了一个 Javascript 来验证表单上的一些简单字段。我的问题是，即使表单上没有错误，代码也能正常工作。

具体来说，它会在`if(openHour > closeHour)`

这是代码：

```
function checkForm()
{  
    var openHour;
    var closeHour;
    var i;

    for(i=1;i<8;i++)
    {
    openHour = document.getElementById("openHours" + i).value;
    closeHour= document.getElementById("closeHours" + i).value;

    if(openHour > closeHour)
    {   
    document.getElementById('error').innerHTML= "Opening Error at " + i;  
    return false;
    }
    if(openHour == "0" && closeHour > 0)
    {
    document.getElementById('error').innerHTML= "Closing Error at " + i;  
    return false;
    }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:04:11.167

openHours 和 closeHours 字段中是否始终存在默认值？

尝试设置一些默认值，例如：

```
var openHour = 0;
var closeHour = 0; 
```

然后在分配之前检查 openHours 和 closedHours 中是否有值：

```
if (document.getElementById("openHours" + i).value != null && document.getElementById("openHours" + i).value != "")
    openHour = document.getElementById("openHours" + i).value;

if (document.getElementById("closeHours" + i).value != null && document.getElementById("closeHours" + i).value != "")
    closeHour = document.getElementById("closeHours" + i).value; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T19:12:10.547

```
openHour = parseInt(document.getElementById("openHours" + i).value);
closeHour = parseInt(document.getElementById("closeHours" + i).value); 
```

我只需要将值解析为整数以便能够比较它们。

感谢你的帮助

# android - SQL开表混乱

> ID：10097628
> 
> 赞同：0
> 
> 时间：2012-04-10T22:57:19.603
> 
> 标签：android, sql

我需要在一个 Android 项目中存储一些与课时相关的数据。在查看了我的选项后，我认为 SQL 数据库将是一个不错的选择。不幸的是，我似乎无法让我的声明真正打开数据库。我的开放数据库语句字符串如下所示：

```
"create table "+ DATABASE_PERIOD+" (_id integer primary key autoincrement,"
+KEY_CLASSTITLE+" text not null, "+KEY_PERIOD+" text not null, 
"+KEY_XPERIODS+" text not null, "+KEY_DOUBLEPERIODS+" text not null); 
```

我基于 Android 网站上的记事本项目。我只是添加了几个字段，但无法打开数据库。如果你们想要错误消息或其他类型的信息，我会尽力为您获取（这是我第一次使用 SQL，所以我真的不知道需要什么来解决这个问题）。提前致谢！

我收到的错误消息是这样的：

```
android.database.sqlite.SQLiteException: no such table: periodData: , while
compiling: SELECT DISTINCT _id, title, period, xPeriods, doublePeriods FROM
periodData WHERE _id = -1 
```

正如那里所说，我正在使用 SQLite。

我将一些数据放入数据库助手类的表中的代码：

```
ContentValues initialValues = new ContentValues();
initialValues.put(KEY_CLASSTITLE, title);
initialValues.put(KEY_PERIOD, period);
initialValues.put(KEY_XPERIODS, xPeriods);
initialValues.put(KEY_DOUBLEPERIODS, doublePeriods);

return mDb.insert(DATABASE_PERIOD, null, initialValues); 
```

我开始使用私有静态字符串来确保我的调用不正确（感谢 Barak 的发现！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:18:28.643

查看[http://developer.android.com/guide/topics/data/data-storage.html#db上的开发主题](http://developer.android.com/guide/topics/data/data-storage.html#db)

您将创建一个 DbHelper 类来帮助您打开数据库，您的代码将类似于：

```
SQLiteDatabase db = dbHelper.getReadableDatabase();
Cursor c = qb.query(db, projection, selection, selectionArgs, null, null, sortOrder); 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T04:12:21.510

您的问题是表名（如错误消息所示）。从您展示的代码中，您创建了一个名为“句点”的表。然而，您尝试使用表名“periodData”来查询它。

修复它的两种方法：

1）将数据库中的表名更改为 periodData（更难，因为它涉及重新创建数据库）。

2) 将查询中的表名从“periodData”更改为“period”。

# ruby - .rake 文件的 rake 任务

> ID：10097629
> 
> 赞同：0
> 
> 时间：2012-04-10T22:57:38.737
> 
> 标签：ruby, rake, rake-task

我在 Ruby 1.9.3 项目中有以下 Rakefile：

```
require 'rake/testtask'
require 'json'

Rake::TestTask.new do |t|
  t.pattern = "spec/**/*_spec.rb"
  t.verbose = true
end

task :default => :test

namespace :omglol do
  namespace :file_a do
    task :foo do
      # do some stuff
    end
  end

  namespace :file_b do
    task :bar do
      # do some stuff
    end
  end
end 
```

如您所见，该文件的第一部分允许运行测试，只需使用`rake`命令。第二部分包含一些任务。

实际上，我在 omgol:file_a 和 omgol:file_b 命名空间中有很多任务。这就是为什么我想将它们中的每一个移动到一个文件中，例如`tasks/omglol/file_a.rake`和`tasks/omglol/file_b.rake`.

有没有最好的方法呢？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T22:49:20.843

是的。只需将逻辑移动到适当的文件中，然后再移动`require`它们。

示例 Rakefile：

```
require 'rake/testtask'
require 'json'
require 'lib/tasks/omglol/file_a.rake' # <= contains your subtasks

Rake::TestTask.new do |t|
  t.pattern = "spec/**/*_spec.rb"
  t.verbose = true
end

task :default => :test 
```

然后`lib/tasks/omglol/file_a.rake`简单地将您的任务定义为正常：

```
namespace :omglol do
  namespace :file_a do
    task :foo do
      # do some stuff
    end
  end
end 
```

file_b.rake 的模式相同。

# ios - Delphi Firemonkey iOS 应用程序中是否提供多点触控手势编程？

> ID：10097631
> 
> 赞同：5
> 
> 时间：2012-04-10T22:57:43.763
> 
> 标签：ios, delphi, firemonkey

我有兴趣使用 Delphi XE2 来制作 iOS 应用程序。目前是否支持使用 Firemonkey 进行多点触控（2-3 指滑动）？如果是这样，是否有一些参考或示例可用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T04:52:22.083

不，多点触控和手势在 iOS 版 Firemonkey 中尚不可用。

但是：你可以解决它，就像[Anders Ohlsson 展示](http://blogs.embarcadero.com/ao/2012/01/24/39201)的那样。他在 Embarcadero CodeCentral 上对[Firemonkey进行了](http://cc.embarcadero.com)[修改](http://cc.embarcadero.com/item/28635)。

# html - CSS - 将边框和填充应用于响应式（基于％）网格系统

> ID：10097639
> 
> 赞同：1
> 
> 时间：2012-04-10T22:59:14.870
> 
> 标签：html, css

我正在现场测试 ZURB 的[Foundation](http://foundation.zurb.com/)，并想知道是否有一个优雅的解决方案可以将边框和填充应用于网格中的 div，而不破坏它或诉诸：1）具有减小的宽度/边距的自定义类，2）嵌入额外的非-grid`<div>`在父级，基于网格`<div>`

我也尝试过`{ box-sizing: border-box; }`，但移动浏览器似乎不遵守。

建议？感谢人们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:41:00.323

您可以尝试使用轮廓而不是边框​​ - 速记完全相同，但不会影响盒子模型。

# java - Spring Security - 输入无效密码后无法登录

> ID：10097640
> 
> 赞同：1
> 
> 时间：2012-04-10T22:59:23.310
> 
> 标签：java, security, spring-mvc, spring-security

我刚刚设置了 Spring Security，它工作得很好。我可以使用我的自定义表单登录和注销。我已经连续多次登录然后退出，没有问题。奇怪的是，如果我尝试使用错误的密码登录，我将无法再次登录 - 此后每次尝试登录时都会进入“loginFailed”页面。有谁知道如何解决这一问题？

这是我的security-config.xml：

```
<beans:beans xmlns="http://www.springframework.org/schema/security"
xmlns:beans="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/security
       http://www.springframework.org/schema/security/spring-security-3.0.3.xsd">

<http use-expressions="true">
    <intercept-url pattern="/secureA.htm" access="isAuthenticated()" /> 
    <intercept-url pattern="/secureB.htm" access="isAuthenticated()" /> 
    <form-login login-page="/login.htm" default-target-url="/secureA.htm" 
        authentication-failure-url="/loginFailed.htm"/>
    <logout logout-success-url="/login" />
</http>

<authentication-manager>
  <authentication-provider>
    <password-encoder hash="sha">
    </password-encoder>
    <user-service>
      <user name="user" password="pass" 
            authorities="ROLE_USER, ROLE_ADMIN" />
    </user-service>
  </authentication-provider>
</authentication-manager>

</beans:beans> 
```

我的登录表格：

```
<form action="<c:url value='j_spring_security_check' />" method="post">
Username:&nbsp;<input type="text" name="j_username" /><br/>
    Password:&nbsp;<input type="password" name="j_password" /><br/>
    <input type="submit" value="Login" /><br/>
</form> 
```

我的登录控制器：

```
@Controller
public class LoginController {

    @RequestMapping(value = "/login", method = RequestMethod.GET)
    public String welcome(ModelMap m) {
        return "login";
    }

    @RequestMapping(value = "/loginFailed", method = RequestMethod.GET)
    public String failed(ModelMap m) {
        m.addAttribute("error", "Invalid username or password");
        return "login";
    }

    @RequestMapping("logout.htm")
    public String logout(ModelMap m) {
        return "redirect:login.htm";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:12:14.533

如果您返回到您登录的同一页面，则该模型将被执行。由于您正在向该模型添加一个属性，因此您可能正在检查该属性是否已在视图页面上设置。一旦它被设置，在你的会话对象被清除之前什么都不会取消它。

要确认，请更改：

```
@RequestMapping(value = "/login", method = RequestMethod.GET)
public String welcome(ModelMap m) {
  System.out.println(m.getAttribute("error");
  return "login";
} 
```

然后检查您的控制台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:56:23.087

好吧，我不知道问题是什么，但我能够解决它。我刚刚发现了一个较旧的 SO 帖子：[Spring security blocks user after failed login](https://stackoverflow.com/questions/8296868/spring-security-blocks-user-after-failed-login)。Timh 切换到 Spring 3.0.7.RELEASE（从 3.0.6 开始）的答案对我有用。抱歉重复发布。

如果有人知道为什么会在 3.0.6 中发生这种情况，我很想知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T13:40:11.903

这是因为： [https ://jira.springsource.org/browse/SEC-1493](https://jira.springsource.org/browse/SEC-1493)

org.springframework.security.core.userdetails.eraseCredentials() 在身份验证时被调用。

解决方案应该是 authentication-manager 的参数 erase-credentials="false"，但显然它在 Spring 3.1.0 或 3.1.3 中对我不起作用。

解决方法是在每个身份验证请求上重新加载用户的详细信息。

# asp.net-mvc - 如何使验证摘要中仅显示某些错误消息 (MVC3)

> ID：10097644
> 
> 赞同：0
> 
> 时间：2012-04-10T22:59:41.593
> 
> 标签：asp.net-mvc, asp.net-mvc-3, validation, razor

在 MVC 3 razor 中似乎有 2 个选项：

在验证摘要中显示各种属性的所有错误

```
@Html.ValidationSummary(false) 
```

或在属性本身旁边显示错误

```
@Html.ValidationSummary(true) 
```

但我只希望*某些*属性在验证摘要中显示它们的错误，（从我的验证覆盖返回的错误消息，例如）

```
 public IEnumerable<ValidationResult> Validate(ValidationContext context)
    {
        if (string.IsNullOrWhiteSpace(HomePhoneNumber) && string.IsNullOrWhiteSpace(WorkPhoneNumber) && string.IsNullOrWhiteSpace(MobileNumber) && string.IsNullOrWhiteSpace(FaxNumber))
        {
            yield return new ValidationResult("Please fill in at least one of the phone fields with a phone number");
        }
    } 
```

以及其他更简单的验证，以便在模型旁边显示错误消息，如模型所定义，例如

```
 [Required(ErrorMessage = "Please fill in your full name")] 
```

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:08:25.100

有可能的。 `ValidationSummary()`显示 ModelErrors for`string.empty`作为键。这是示例代码：

```
IList<ValidationResult> validationResults = Validate();

if (validationResults != null) {
    foreach (var validationResult in validationResults) {
        ModelState.AddModelError(String.Empty, validationResult.ErrorMessage);
    }
} 
```

鉴于：

```
@Html.ValidationSummary(true) 
```

**编辑：**

以上是 ValidationSummery 助手如何处理非属性（对象）级别消息的示例。

`IEnumerable<ValidationResult> IValidatableObject.Validate(ValidationContext validationContext)`但是，您的代码应该可以按预期工作，请考虑如果对象的属性中没有错误，则会触发验证接口方法。这是验证检查的默认顺序：

*   属性属性
*   类属性
*   验证接口

如果任何步骤失败，它将立即返回，无需进一步检查。如果启用了不显眼的客户端验证，则应在客户端触发基于属性的验证。然后验证接口将在模型绑定期间触发。

# video - 如何生成具有高性能（最小 I/O）的“moov before mdat”MP4 视频文件？

> ID：10097645
> 
> 赞同：6
> 
> 时间：2012-04-10T22:59:47.233
> 
> 标签：video, video-streaming, mp4

我正在设计一个服务器应用程序，它将实时 H.264 视频流存储为 MP4 供浏览器以后使用。由于服务器需要处理尽可能多的同时流，我相信 I/O 将成为自然的瓶颈，我希望将 I/O 保持在最低限度。我遇到了经典的 MP4 moov/mdat 排序问题：MP4 生成器更喜欢先写 mdat 框（包含实际的媒体帧），然后再写 moov 框（包含文件偏移量和其他结构信息），在它实际之后知道 mdat 文件的偏移量是多少。MP4 消费者喜欢相反的渐进式流媒体——首先读取 moov 框，因此 mdat 结构是已知的，视频可以快速开始播放，而无需下载整个文件。

通常的解决方案是对 MP4 文件进行后处理以将 moov 框移动到 mdat 框之前，并相应地重写文件偏移量。但是，对于大容量应用程序，我想避免将传入的视频数据写入磁盘、将其全部读回并以新的安排再次写入的 I/O 损失。

想到了几种方法：

1.  像往常一样对 MP4 进行后处理，这会导致 I/O 损失并可能会延迟视频的可用性。（不好。）
2.  使用分段 MP4 和适合内存的小片段大小。（我认为这可能会对整个文件的可搜索性产生负面影响。）
3.  如果文件系统提供了一个快速的“前置”选项来将新块添加到文件块链的开头，那就太棒了。（我认为这还没有被发明出来。）
4.  将 MP4 生成为两个文件——一个“mdat”文件（包含实际的媒体帧）和一个“moov”文件（包含 ftyp 标头和 moov 数据）。如果将这两个文件连接起来，将产生一个有效的 moov-first MP4 文件。一个简单的 Web 服务器模块可以向用户呈现一个虚拟的 .mp4 文件，但在后台读取 .moov 和 .mdat 文件。

我现在倾向于#4。有没有更实用的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T12:15:05.693

如果 moov 数据的大小是可估计的，则在文件开头预分配空间。其中一些可能会被浪费，但您不必重新计算任何偏移量，并且在某些情况下它会避免 I/O 成本。只要确保当 moov 数据大于您的估计时您有一个备用方案。

# html - 突出显示相同的第 n 个子元素

> ID：10097646
> 
> 赞同：0
> 
> 时间：2012-04-10T22:59:54.430
> 
> 标签：html, css, css-tables

假设我有下表：

```
+----------+
| A  |  B  |
+----------+
| 1  |  2  |
+----------+ 
```

我想这样当我将鼠标悬停在上面时`A`，它`1`会获得某些 css 样式，同样适用于`B`和`2`. 有没有办法不使用js来做到这一点？

## [这是一个小提琴，看看我的意思](http://jsfiddle.net/en5rB/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:15:19.343

使用此标记和纯 CSS 是不可能的，因为您需要使用`td:hover`鼠标悬停时应用 CSS 规则，并且没有选择器可以让您沿着 DOM 树向上移动（因为您想要定位居住在与悬停的分支不同）。

如果你可以修改，那么像达斯汀这样的解决方案就可以工作；如果你可以使用 JS，那么在桌面[上撒一点 jQuery也是一个问题：](http://jsfiddle.net/UznED/)

```
$("td").on("mouseenter mouseout", function() {
    var $this = $(this);
    $this.closest("table").find("td:nth-child(" + ($this.index() + 1) + ")")
                          .toggleClass("hover");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:09:03.830

如果您可以更改标记，这里有一个响应 jsfiddle 可以使用 CSS 执行此操作。

[http://jsfiddle.net/dBrd2/](http://jsfiddle.net/dBrd2/)

编辑：啊，但我看到你回复了我的评论并说你不想。无论如何，如果你重新考虑，只是一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T04:24:30.893

嗨，你可以这样做

**CSS**

```
td {
    position: relative;
    border: 1px solid black;
    padding: 50px;
}

tr .fir{
    background:red;
}
table:hover .fir{
    background:green;
}

​ 
```

**HTML**

```
<table>
<tr>
    <td class="fir">a</td>
    <td class="sec">b</td>
</tr>
<tr>
    <td class="fir">1</td>
    <td class="sec">2</td>
</tr>
</table>​ 
```

现场演示[http://jsfiddle.net/rohitazad/en5rB/3/](http://jsfiddle.net/rohitazad/en5rB/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T23:04:55.970

您可以创建一个名为 .hover 的类，并这样做以将样式添加到具有同一类的所有 td

```
$("td.fir").bind("mouseenter", function(){
   $(".fir").addClass("hover");
});​​​​
$("td.fir").bind("mouseleave", function(){
   $(".fir").removeClass("hover");
}); 
```

​</p>

# javascript - 如何在 Google 地图中收听用户生成的缩放？

> ID：10097647
> 
> 赞同：18
> 
> 时间：2012-04-10T23:00:00.853
> 
> 标签：javascript, google-maps, google-maps-api-3

我想知道何时通过用户与 +/- 缩放按钮的交互专门触发了 Google Maps zoom_changed 事件。如果我为 zoom_changed 使用通用事件侦听器，我无法判断它是用户生成的事件还是由 fitBounds() 之类的东西引起的缩放更改。寻找最好的方法来做到这一点。

我尝试了以下方法，但似乎都不起作用：

1) 查找有关 zoom_changed 的​​事件信息。似乎没有。

2) 为 mouseover 和 mouseout 添加侦听器，让我设置一个标志以查看用户是否在地图边界内，并检查 zoom_changed 上的标志。这不起作用，因为地图不会将缩放按钮视为地图框的一部分（换句话说，将鼠标悬停在缩放按钮上会触发 mouseout 事件）。

3) 为缩放按钮添加一个普通（非 gMap）监听器。但是，我找不到一个明确的 CSS 选择器，可以让我只抓取按钮。

4) 在 gMaps API 中寻找可以让我执行 getZoomElements() 之类的功能，然后我可以使用它设置侦听器。

奇怪的是，如果我向地图添加自定义控件，我可以清楚地做我想做的事。他们会强迫我这样做而不是挂钩到默认缩放控件，这似乎很奇怪。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T23:17:01.147

我不会只使用`+`/`-`按钮（或您自己的自定义控件上的按钮）。用户可以使用鼠标滚轮或双击地图来更改地图的缩放比例。另外，您将依赖实现细节而不是记录在案的 API，这是**一个主要的禁忌**。

这实际上意味着检测缩放变化的唯一可靠的、*记录在案*的方法是[`zoom_changed`监听](https://developers.google.com/maps/documentation/javascript/reference#Map)`Map`.

如果您的事件处理程序无法确定事件是来自用户操作还是 API 调用，则有两种方法：

*   在调用 API 函数之前设置一个标志，以便您知道可以忽略此更改。
*   您能否重新设计您的应用程序，使缩放更改来自代码还是用户都无关紧要？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-31T07:27:38.717

我通过为我的地图 创建**自定义缩放按钮解决了这个问题。**

这是我的项目中的代码：
**编辑**：删除了不必要且不言自明的通用代码

你的 zoomControl 函数：

```
function zoomControl(map, div) {

  var controlDiv = div,
      control = this;

  // Set styles to your own pa DIV
  controlDiv.style.padding = '5px';

  // Set CSS for the zoom in div.
  var zoomIncrease = document.createElement('div');
  zoomIncrease.title = 'Click to zoom in';
  // etc.

  // Set CSS for the zoom in interior.
  var zoomIncreaseText = document.createElement('div');
  // Use custom image
  zoomIncreaseText.innerHTML = '<strong><img src="./images/plusBut.png" width="30px" height="30px"/></strong>';
  zoomIncrease.appendChild(zoomIncreaseText);

  // Set CSS for the zoom out div, in asimilar way
  var zoomDecreaseText = document.createElement('div');
  // .. Code .. Similar to above

  // Set CSS for the zoom out interior.
  // .. Code ..

  // Setup the click event listener for Zoom Increase:
  google.maps.event.addDomListener(zoomIncrease, 'click', function() {
      zoom = MainMap.getZoom();
      MainMap.setZoom(zoom+1);
      // Other Code parts
  });

  // Setup the click event listener for Zoom decrease:
  google.maps.event.addDomListener(zoomDecrease, 'click', function() {
      zoom = MainMap.getZoom();
      MainMap.setZoom(zoom-1);
  });
} 
```

你的初始化函数：

```
function initializeMap() {

    var latlng = new google.maps.LatLng(38.6, -98);
    var options = {
        zoom : 5,
        center : latlng,
        mapTypeId : google.maps.MapTypeId.ROADMAP,  
        // Other Options
    };
    MainMap = new google.maps.Map(document.getElementById("google-map-canvas"),
            options);

    // The main part - Create your own Custom Zoom Buttons
    // Create the DIV to hold the control and call the zoomControl()
    var zoomControlDiv = document.createElement('div'), 
        zoomLevelControl = new zoomControl(MainMap, zoomControlDiv);

    zoomControlDiv.index = 1;
    MainMap.controls[google.maps.ControlPosition.RIGHT_TOP].push(zoomControlDiv);
} 
```

希望能帮助到你

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-05-28T06:21:13.133

```
var zoomFlag = "user"; // always assume it's user unless otherwise

// some method changing the zoom through API
zoomFlag = "api";
map.setZoom(map.getZoom() - 1);
zoomFlag = "user";

// google maps event handler
zoom_changed: function() {
  if (zoomFlag === "user") {
    // user zoom
  }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-03T21:45:05.090

我想做同样的事情。我希望找到一种内置于 Google Maps API 的方法，但至少，您应该能够在初始化地图时将起始缩放级别存储为变量。然后，将 getZoom() 的结果与它进行比较，以了解它是放大还是缩小。

例如：

```
map = new google.maps.Map(document.getElementById('map_canvas'), { zoom: 11 });
var previous_zoom = 11;

google.maps.event.addListener(map,'zoom_changed',function(){
  if(map.getZoom() > previous_zoom) {
    alert('You just zoomed in.');
  }
  previous_zoom = map.getZoom();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T02:35:47.743

我建议使用自定义控件进行放大/缩小，然后在自定义 congrol 上使用事件侦听器：

[http://goo.gl/u8gKC](http://goo.gl/u8gKC)

您可以轻松隐藏默认缩放控件：

[http://goo.gl/N5HIE](http://goo.gl/N5HIE)

（`zoomControl`具体来说）

# git - 为 Symfony2 项目设置 GIT：为什么将 web/bundles 文件夹添加到 gitignore

> ID：10097648
> 
> 赞同：17
> 
> 时间：2012-04-10T23:00:10.923
> 
> 标签：git, symfony, gitignore

我正在构建我的第一个 Symfony2 项目，我可能对`web/bundles`文件夹的用途感到困惑。根据 Symfony2 文档，他们说这是静态数据的去处，如 js 库、css 和图像。`/web/bundles`这一切都是有道理的，但是当您仍在构建基本布局时，将其放在忽略列表中是不是有点烦人？事实上，为什么还要把它列入忽略名单？引导程序、参数、缓存等都可以忽略，因为您不想将开发设置与生产设置交叉。

这是 symfony 指示您添加到 gitignore 的内容：

```
/web/bundles/
/app/bootstrap*
/app/cache/*
/app/logs/*
/vendor/
/app/config/parameters.yml 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-11T07:06:57.977

`web/bundles`忽略文件夹的原因是它是通过运行命令*生成*`app/console assets:install web`的，该命令也会在运行结束时自动`bin/vendors install`运行。无论你有什么`YourBundle/Resources/public`去`web/bundles/your`。

如果您不想在开发时每次更改资产时都安装资产，请使用以下`--symlink`参数：

```
app/console assets:install --symlink web 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-13T14:39:30.607

我想对 Elnur Abdurrakhimov 的回答发表评论，但由于声誉不足：`app/console assets:install web`删除所有内容，`web/`因此请确保在第一次执行命令`src/<Bundle>/Resources/public` **之前将所有内容复制到。**

# ruby-on-rails - rails 3.1.3: rake aborts (couldn't parse YAML) when run first db:migrate (尝试在 mac lion 上本地运行 postgres)

> ID：10097653
> 
> 赞同：0
> 
> 时间：2012-04-10T23:00:30.933
> 
> 标签：ruby-on-rails, macos, postgresql

对于一个新项目，我正在尝试在本地运行 postgres。

Mac Lion 已安装 Postgres (9.1.2)。我在 .bash_profile 中修改了我的路径（根据另一个 SO 线程），所以现在使用 psql 实用程序创建数据库或用户没有问题。

[我使用http://blog.willj.net/2011/05/31/setting-up-postgresql-for-ruby-on-rails](http://blog.willj.net/2011/05/31/setting-up-postgresql-for-ruby-on-rails-development-on-os-x/)`env ARCHFLAGS="-arch x86_64" gem install pg`上的优秀博客卸载并重新安装了 pg gem (0.13.2)[开发-on-os-x/](http://blog.willj.net/2011/05/31/setting-up-postgresql-for-ruby-on-rails-development-on-os-x/)

我的 Gemfile 使用 pg gem 进行开发、测试和生产。我已经运行捆绑安装。

我的 database.yml 看起来像这样（并且用户名和数据库名称是正确的，并且我验证我可以使用 psql 实用程序访问该用户名的数据库）：

```
development:
 adapter: postgresql
  encoding: unicode
  database: ddchart_development
  pool: 5
  username: ddchart
  password: 
```

（测试和生产相同，除了 _test 和 _production。密码为空，对吗？）

当我运行`bundle exec rake db:migrate`它时中止：

```
rake aborted!
couldn't parse YAML at line 8 column 10 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:59:18.907

如果您正确粘贴了代码，则代码中存在错误。例如，“适配器”之前只有一个空格，但后面的行之前只有两个。

在 YAML 中，缩进很重要。

# facebook - 更改 facebook like 按钮的输出

> ID：10097654
> 
> 赞同：1
> 
> 时间：2012-04-10T19:00:48.760
> 
> 标签：facebook, drupal-6

我已将来自 facebook 开发站点（我目前使用 iframe 版本）的 facebook like 按钮的代码直接绑定到节点（或内容帖子）的 html 中。我希望能够操纵当有人点击“赞”按钮时发送的文本。

您可以在此处查看网站和按钮 www.masteringmoneybasics.org

我已经尝试了按钮的 iframe 和 html5 版本，但看不到在哪里更改发送的内容。

如果无法直接更改发送的内容，有谁知道它在要发送的内容中查找什么，以便我可以正确构造节点？如果您注意到，当您喜欢该页面时，它不会获得内容的第一句，而是其后的所有内容，并且我尝试将不同的内容放在两行之间（在它自己的中`<p>`）并且它仍然抓取后者。还有它如何确定从页面中抓取哪个图像？大多数时候它不拍摄任何图像，但两次它抓住了中学图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T19:23:52.103

您需要将[facebook open graph 元](http://davidwalsh.name/facebook-meta-tags)标记添加到被喜欢的页面的 html 头部，例如

```
<meta property="og:title" content=""/>
<meta property="og:image" content="http://davidwalsh.name/wp-content/themes/klass/img/facebooklogo.png"/>
<meta property="og:site_name" content="David Walsh Blog"/>
<meta property="og:description" content="Facebook's Open Graph protocol allows for web developers to turn their websites into Facebook "graph" objects, allowing a certain level of customization over how information is carried over from a non-Facebook website to Facebook when a page is 'recommended', 'liked', or just generally shared."/> 
```

您不必使用类似“发送”代码，只需将此信息添加到您的 html 页面中 - 这使您可以控制发布的图像和文本。

仅供参考，您应该决定用户是否喜欢文章或网站，并相应地更改每个页面上的信息，就像使用搜索引擎的标准元标记一样。

# sql - Oracle 日期数据类型错误

> ID：10097656
> 
> 赞同：1
> 
> 时间：2012-04-10T23:00:52.583
> 
> 标签：sql, database, oracle, oracle10g, oracle9i

我对 Oracle 有点不满意

那我下面的SQL

```
select * from orders where 
trunc(ordered_date)
between
to_date('01-JAN-12') 
and 
to_date('07-JAN-12') 
```

Ordered_date 是 DATE 数据类型

是否给出以下错误。

```
Error starting at line 1 in command:
select * from orders
where 
trunc(ordered_date)
between 
to_date('01-JAN-12') 
and 
to_date('07-JAN-12')
Error report:
SQL Error: ORA-01841: (full) year must be between -4713 and +9999, and not be 0
01841\. 00000 -  "(full) year must be between -4713 and +9999, and not be 0"
*Cause:    Illegal year entered
*Action:   Input year in the specified range 
```

我很困惑是什么导致了 mu 代码中的这个错误。

任何输入都会很棒。

谢谢 ！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:18:22.240

您必须指定日期格式。

向 to_date 函数添加参数：

```
 to_date('01-JAN-12', 'DD-Mon-YY') 
```

希望它有帮助。

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:32:58.260

如果您真的使用日期文字，则可以改用以下语法：

```
select * from orders where 
trunc(ordered_date)
between
date '2012-01-01'
and
date '2012-01-07' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T04:32:30.040

也许您应该将日期（即 DB 日期和 2 个输入日期）转换为相同的格式，如下所示

```
 SELECT *
  FROM ORDERS O
 WHERE TO_DATE(TO_CHAR(O.ORDERED_DATE, 'DD-MON-YY'), 'DD-MON-YY') BETWEEN
       TO_DATE('01-JAN-12', 'DD-MON-YY') AND
       TO_DATE('07-JAN-12', 'DD-MON-YY') 
```

希望能帮助到你

# php - php 文档的 REQUEST_URI 是“favicon.ico”或样式表的文件名

> ID：10097657
> 
> 赞同：3
> 
> 时间：2012-04-10T23:00:54.790
> 
> 标签：php, request, uri, favicon

我记录进入我网站的流量。我通过查看用户访问的第一页的 REQUEST_URI 来获取用户的登录页面。该网站全是 php，因此每个页面都包含一个文件，其中包括：

```
$_SESSION['landing']=$_SERVER['REQUEST_URI']; 
```

我还记录流出的流量。我注意到 $_SESSION['landing'] 有两种条目，尽管这不太有意义。我会看到：“favicon.ico”或“ie8.css”

Favicon 只是一个图标：

```
<link rel="shortcut icon" href="http://www.SITE.com/images/favicon.ico" /> 
```

ie8.css 是一个样式表，它修复了一些东西，所以它们在 IE8 中看起来是正确的。我像这样包括它：

```
<!--[if lt IE 9]>
<link rel="stylesheet" type="text/css" href="/ie8.css" />
<![endif]--> 
```

为什么这些会显示为 php 文档的 $_SERVER['REQUEST_URI'] ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:09:42.977

我知道可能导致此类错误的三个原因...

1.  错误 URL 重定向 .... 尝试实现干净 URL 时 ....

2.  `AddType x-httpd-php .css .ico .xyz

3.  有人在弄乱您的服务器....

我希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T08:15:39.060

这是为了引导我朝着正确的方向前进。我正在使用重写规则来模拟“县”目录，例如：

```
/county/Sonoma?1, /county/Sonoma?2, etc. 
```

将县与看起来像 /Santa Rosa 的城市区分开来。这是规则：

```
RewriteCond %{REQUEST_URI} !/\.php/ [NC]
RewriteRule ^county/(.+)$ /county.php?county=$1 [L,QSA] 
```

但是我到 favicon.ico 的链接是相对的，而不是绝对的，即`favicon.icon`而不是`/favicon.ico`. 所以 apache 正在寻找`/county/favicon.ico`而不是`/favicon.ico`. RewriteRule 将其发送到county.php。

结果`$_SERVER['REQUEST_URI']`是`/favicon.ico.`

我在斜线前面加上了它，它起作用了。为了更好地衡量，我添加了另一条规则：

```
RewriteRule ^county/(.+/.+)$ /$1 [L] 
```

以防万一。

# c# - 如何在多个图像之间画线

> ID：10097663
> 
> 赞同：0
> 
> 时间：2012-04-10T23:01:21.870
> 
> 标签：c#, wpf, xaml, expression-blend

我需要直观地显示从一个图像到一个或多个图像的线来表示连接到一个或多个服务器的服务器。我假设 WPF 是最好的工具，并且正在使用这个项目来学习和评估 WPF 并确定我们是否应该开始从 WinForms 迁移。

我试图保持布局简单，以便重新调整大小和管理布局。所以代表源服务器的图像位于左上角，所有连接的服务器都列在右侧。我是 WPF 和 Expression Blend 的新手，一直在为如何绘制连接器而苦苦挣扎。现在我有一个网格中的图像。在一些令人沮丧的尝试使用平铺图像绘制线条之后，我开始使用带有 GradientBrush 的线条，它看起来像一个 2D 管道。这似乎是一个不错的方法。但我希望有一种足够的方法来绘制类似于我的模型的路径。

想法...

*   将线放在网格中并跨越多行和多列
*   将线放在跨越所有行和列的画布上
*   我认为行路径需要在后面的代码中确定，但我对 XAML 的所有功能印象深刻。

我只是一个 WPF 菜鸟，对 WPF 所能做的一切都有些不知所措。这似乎是以前做过很多次的事情，但我找不到任何相关的 WPF 示例，并且希望尽量减少我令人沮丧的尝试:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T04:06:58.610

我会使用`Canvas`，而不是`Grid`因为您可以使用[绝对定位与 Canvas](http://msdn.microsoft.com/en-us/library/bb514508%28v=vs.90%29.aspx)。

[查看CodeProject](http://www.codeproject.com/Articles/23871/WPF-Diagram-Designer-Part-3)上的这个 4 部分系列以获得一些想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:08:08.573

您可以尝试在图像之间使用分隔符。将分隔符放在堆栈面板中，以便您可以控制其方向为水平或垂直，还可以更改其颜色和厚度。如果您将分隔符放置在画布中，您还可以控制其位置。

# git - 运行 git archive 时忽略 .gitignore

> ID：10097665
> 
> 赞同：7
> 
> 时间：2012-04-10T23:01:27.737
> 
> 标签：git

我有一个带有一堆源代码的 git repo，当它编译时会产生一堆二进制文件。二进制文件都列在适当的 .gitignore 文件中，并且不包含在 repo 中。

但是，我想分发包含所有二进制文件的我的仓库的源+二进制文件快照压缩文件，但不包含 .git/ 目录之类的东西。

创建快照压缩文件的自然方式似乎是

```
git archive -o archive.zip 
```

但这不包括 .gitignore 中的任何二进制文件。

关于如何使用 git archive 完成此任务的想法？（我的解决方法是手动创建一个包含 .git/ 目录以外的所有内容的 zip 存档）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-09-25T11:28:50.090

`git archive`您可以使用**.gitattributes**文件排除文件和/或目录。

1.  在项目根目录中创建一个名为**.gitattributes**的文件（如果它不存在）。
2.  编辑文件：每个排除项都应该有一个文件模式，后跟“ **export-ignore** ”：

    ```
    .gitattributes export-ignore
    .gitignore export-ignore
    /mytemp export-ignore 
    ```

3.  确保忽略 .gitattributes 文件本身！

4.  确保提交 .gitattributes 文件，否则`git archive`不会选择设置。

然后随意使用您的`git archive -o archive.zip`命令或变体。

[来源在这里](https://feeding.cloud.geek.nz/posts/excluding-files-from-git-archive/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T23:53:17.970

我不认为您将能够使用“git archive”来实现您希望实现的目标。'git archive' 适用于提交，您的二进制文件根本不可见。注意 'git archive' 是如此以提交为中心，以至于您可以直接在没有明确存在源代码控制文件的裸存储库中使用 git archive。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-01-04T09:43:22.893

`.gitignore`如果文件被版本控制忽略（通过），则无法将文件包含在 git-archive 中。

在我的解决方法中，我会在之后附加我需要的文件。

```
git archive --format=tar -o repo.tar HEAD
tar --append --file=repo.tar thirdparty/binary
gzip repo.tar 
```

请注意，附加到 a`tar.gz`并不容易，因此我首先创建一个未压缩的存档，然后添加二进制文件，然后进行压缩。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T12:13:51.490

正如[GoZoner](https://stackoverflow.com/users/1286639/gozoner) [所说](https://stackoverflow.com/a/10098081/520162)，这不是可以完成的任务`git archive`。

为正确的任务使用正确的工具。我也做了一些非常相似的事情，并且有一个 Perl 脚本来创建包含源代码和编译内容的存档。

简单地压缩编译期间创建的所有内容可能不是您想要的：

*   如果你想把一个库交给某人，他只会对这个库和一些标题感兴趣，才能使用这个库。例如，无需归档目标文件和其他中间文件。

*   如果您希望您的观众能够自己构建库，请包括源代码、所需的项目文件以及可能的预构建二进制文件。

*   ...

因此，根据我的经验，我建议采用您选择的脚本语言并使用提供的语言机制来创建您的发行版。这样做，您还可以在您的发行版中创建一个不同的文件夹结构，该结构不必与您的磁盘上的结构相匹配。

要注意创建存档的 git 修订版，您可以将修订版存储在 zip 文件的注释中：

![截屏](../Images/5c98e4fd5c1974271b2bbc390e961e01.png)

# database - 公开密钥时屏蔽数据库大小？（不杀性能）

> ID：10097666
> 
> 赞同：3
> 
> 时间：2012-04-10T23:01:37.377
> 
> 标签：database

我们有一个包含 1000 万条记录的数据库表。我们不想使用 auto_increment，因为这会让我们的用户知道我们有多少记录。我们不想将其暴露给我们的竞争对手。我看到的问题是使用 UUID 或类似的东西会降低查询性能。

例如，这是一个禁忌： [http ://domain.com/widgets?id=34345](http://domain.com/widgets?id=34345)

因为竞争对手可以抓取网站以确定我们有多少小部件。这种业务屏蔽应该在app层面处理，还是在数据库层面处理好？大多数人在这种情况下会怎么做？我们使用的数据库是 postgres，但我认为该解决方案仍然与数据库无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:05:14.037

使用 GUID 作为键。您可以查看[此问题](https://stackoverflow.com/questions/10029651/fastest-way-in-c-sharp-to-iterate-through-all-guids-possible)以了解为什么可以这样做。您可能可以使用 GUID 编号的子集来逃避，但位大小越小，冲突的可能性就越大。GUID 不会太大，应该可以存储为数字。密钥的转移将是密钥的 4 倍，但这在很大程度上是无关紧要的。

对于 1000 万行，存储空间可能多出大约 120 MB，但在如此大的大小下似乎可以忽略不计。您是否测试过 GUID 的性能并发现它们缺乏？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:19:44.553

我使用基于 slug 的 url，`slug`它是唯一的，因此是索引字段，而且你会得到很好的 url，比如[http://example.com/awesome-blue-widget](http://example.com/awesome-blue-widget)。您可以通过小写小部件名称、用连字符替换空格等来创建 slug。我的 web 框架有一个简单的`slugify`功能，如果已经使用了 slug，我将其扩展为在末尾添加一个增量。

蛞蝓通常与模式相匹配`[a-z0-9-]+`。而且您仍然可以将自动递增的主键用于其他表等中的外键，而不会影响您的业务数据。

# database - 重新生成 Drools 知识库。Strore 流口水规则到数据库

> ID：10097667
> 
> 赞同：0
> 
> 时间：2012-04-10T23:01:37.620
> 
> 标签：database, drools

我使用 Drools 开发 Web 应用程序。我所有的流口水文件都存储到数据库中。修改一些规则后，我必须创建新的知识库并添加我从规则创建的包。我如何只更新我需要的知识库中的那些包，因为重新生成所有知识库非常耗时；例如，我进行下一步；

用户编辑规则并按下应用按钮。之后我做了一些事情：

KnowledgeBuilder kbuilder = KnowledgeBuilderFactory.newKnowledgeBuilder(); kbuilder.add(ResourceFactory.newReaderResource(Reader, getClass()),ResourceType.DRL); 知识库 kbase = KnowledgeBaseFactory.newKnowledgeBase(); kbase.addKnowledgePackages(kbuilder.getKnowledgePackages());

我将规则脚本如何在数据库中存储文本并使用 Reader 在 KnowledgeBuilder 中添加包。我从这里获取规则数据库格式 [http://docs.codehaus.org/display/DROOLS/Loading+and+managing+rules+dynamically+from +a+数据库](http://docs.codehaus.org/display/DROOLS/Loading+and+managing+rules+dynamically+from+a+database)

我试图从知识库中按名称删除包并再次添加但不成功。我必须做什么来更新我的知识库。我不能每次用户编辑和保存规则时都创建新的知识库，我必须做一些动作来更新知识库的某些部分，让我这样说。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T15:32:04.630

您是否阅读了 drools 文档中的知识代理？据我所知，该组件包含将新更改合并到现有知识库中的逻辑。干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T15:40:24.990

我阅读了仅与 changeset.xml 配置和扫描资源一起使用的知识代理，它在 changeset.xml 中定义

# linux - 合并 data.frames 导致内存不足错误

> ID：10097672
> 
> 赞同：3
> 
> 时间：2012-04-10T23:02:22.113
> 
> 标签：linux, r, memory-management, data.table

根据我收到的错误消息，我有 4GB 的 RAM，并且无法在 Linux 的 R 中将 147.6MB 拉入内存：`Error: cannot allocate vector of size 147.6 Mb`.

我该如何诊断？

这是我的代码：

```
IDs <- read.csv('Set1.csv')  #   2 MB
Set2 <- read.csv('Set2.csv') # 240 MB 
data <- merge(IDs, Set2, by='MemberID')
rm(IDs)                      # Remove junk! 
rm(Set2)                     # Remove junk!
gc()
print('First merge complete')

Set3 <- read.csv('Set3.csv') # 25 MB
data <- merge(data, Set3, by='MemberID')
rm(Set3)                     # Remove junk!
gc()
print('Second merge complete') 
```

在第一个打印语句之后执行停止。我不明白额外的内存使用量来自哪里。环顾 R 中关于 memory() 的文档，这似乎是一个连续的内存问题？有没有办法在 Ubuntu 上的 R 中解决这个问题？

还查看了其他人在这里提出类似问题，但提出的解决方案是特定于 Windows 的。

**编辑 1**

一些评论以解决以下评论：

```
> print(object.size(IDs), units="Mb")
1.3 Mb
> print(object.size(Set2), units="Mb")
142.6 Mb
> print(object.size(Set3), units="Mb")
12.5 Mb 
```

因此，从 CSV 读取对象的大小看起来并没有太大变化。我会检查 data.table() 和其余的......

**编辑 2**

我已经更新了我的代码以使用 data.table() 并且有同样的错误。这让我担心它可能对我的机器有些特殊？对于所涉及文件的大小，这似乎很奇怪。 `Error: cannot allocate vector of size 147.6 Mb`

```
IDs <- as.data.table(read.csv('Set1.csv'))  #   2 MB
Set2 <- as.data.table(read.csv('Set2.csv')) # 240 MB 
data <- merge(IDs, Set2, by='MemberID')
rm(IDs)                      # Remove junk! 
rm(Set2)                     # Remove junk!
gc()
print('First merge complete')

Set3 <- as.data.table(read.csv('Set3.csv')) # 25 MB
data <- merge(data, Set3, by='MemberID')
rm(Set3)                     # Remove junk!
gc()
print('Second merge complete') 
```

**编辑 3**

通过我的数据检查，我怀疑问题可能在这里。Set3.csv 中有一些常见的字段名称，所以我认为它正在做讨厌的 nxn 连接或其他东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T18:45:28.130

切换到`data.table()`上面评论中建议的@Chase，并删除使用过的对象让我能够处理第一次合并。事实证明，由于第二个数据集具有非唯一键，后来导致麻烦的合并实际上是在我没想到的地方进行笛卡尔连接，所以我不得不完全放弃它。

我通过子集数据暂时解决了这个问题，但后来在尝试将模型拟合到预测时遇到了类似的错误。

这个故事的寓意是，R 函数使用的内存比传入向量本身的大小要多得多，正如上面@Justin 所建议的那样，用`object.size`. 对于在处理操作期间用完 RAM 的函数也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-13T20:22:57.797

我有一个非常相似的问题。我的问题是我将 NA 引入了两个数据框的“by”列。

这最终导致了一个非常大的数据框。使用 NA 修复或删除行解决了该问题。

# java - Android 1.6 的“Google API”在哪里？

> ID：10097675
> 
> 赞同：0
> 
> 时间：2012-04-10T23:02:41.980
> 
> 标签：java, android, android-1.6-donut

我正在阅读 Tony Hillerson 的 O'Reilly 视频培训课程“使用 Java 开发 Android 应用程序”中的视频教程。他提到我必须针对“Google APIs”而不是标准的 Android 1.6 API 构建我的应用程序，才能将 Google Maps API 用于我的应用程序。我需要这个才能在我的应用程序类中导入“com.google.android.maps.MapActivity”。

问题是：我在最新的 Android SDK 管理器下的任何地方都找不到这个“Google API”。

我在哪里可以找到适用于 Android 1.6 的“Google API”？请协助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:04:50.500

最低使用 SDK 2.1 更新。就个人而言，我大部分时间都使用 2.2，但 2.1-update 将支持几乎所有的手机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:08:16.690

您应该能够从 Eclipse 内部的 ADT 插件或从 SDK 管理器外部安装它 ![Android SDK 管理器](../Images/4a89a821f5ccd366c722ad11aa5e7ec8.png)

# jquery - 使用图像中的链接时无法让 fancybox 工作

> ID：10097676
> 
> 赞同：0
> 
> 时间：2012-04-10T23:02:57.807
> 
> 标签：jquery, css, fancybox

所以，我试图让这张图片出现在精美的盒子视图中，然后当你点击图片时，它会下载一个文件。但！当我的图像在 img 标签周围有锚点时，花哨的框效果将不起作用。

继承人页面：

点击查看我的简历横幅，它将显示 2 张简历图片。我希望能够单击其中任何一个，它将下载我的文件。但是我说，当我这样做时，花哨的框不会让我点击横幅。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:20:49.783

如果您可以发布一些示例代码以使其正常工作，我会很好。

你不能做这样的事情：

```
$(function(){
   $("#a#linkTo").click(function(){
     $("whichResume").fancybox();
   });
}); 
```

以及#whichResume div 的代码

```
<a href="images/resumeTHUMB/graphicResumeTHUMB.jpg">
<img class="graphic" src="images/resumeTHUMB/graphicResumeTHUMB.jpg">
</a>
<a href="images/resumeTHUMB/typeResumeTHUMB.jpg">
<img class="type" src="images/resumeTHUMB/typeResumeTHUMB.jpg" style="margin-left:50px;">
</a> 
```

我没有测试它，如果你在这里发布示例代码会容易得多。

对于禁用 javascript 的用户（如我），还为 #whichResume 提供默认显示：无。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:18:04.040

你在`.fancybox()`打电话`a#linkTo`。当 Fancybox 在您指向的锚点内找到链接时，它会将锚点 ( `#linkTo`) 的内容删除到 DOM 中的其他位置。这大概是为了方便使用。在您的情况下，您希望`#workTag`保留在链接中。因此，如果您`#whichResume`在锚点之外删除您的 fancybox 内容 ( )，Fancybox 应该会自动找到带有 id 的内容`#whichResume`，因为您的 href 指向它。你不需要它在你的链接里面。

改变这个：

```
<a id="linkTo" href="#whichResume">     
    <div id="workTag">       
        <div id="whichResume" style="background:white;" class="roundedCorners">     
            <a href="images/icons/document_pdf.png">
                <img src="images/resumeTHUMB/graphicResumeTHUMB.jpg" class="graphic" />
            </a>       
            <a href="images/icons/document_pdf.png">
                <img style="margin-left:50px;" src="images/resumeTHUMB/typeResumeTHUMB.jpg" class="type"/>
            </a>       
        </div>   
    </div>  
</a> 
```

对此：

```
<a id="linkTo" href="#whichResume">     
    <div id="workTag"></div>  
</a>

<div id="whichResume" style="background:white;" class="roundedCorners">     
    <a href="images/icons/document_pdf.png">
        <img src="images/resumeTHUMB/graphicResumeTHUMB.jpg" class="graphic" />
    </a>       
    <a href="images/icons/document_pdf.png">
        <img style="margin-left:50px;" src="images/resumeTHUMB/typeResumeTHUMB.jpg" class="type"/>
    </a>       
</div> 
```

请参阅此处的示例：http: [//jsfiddle.net/jtbowden/BTqxx/](http://jsfiddle.net/jtbowden/BTqxx/)

# android - 将数据从 web 服务加载到列表视图的最佳方法

> ID：10097679
> 
> 赞同：2
> 
> 时间：2012-04-10T23:03:06.600
> 
> 标签：android, lazy-loading

我正在制作一个适配器，它强调从 Web 服务加载的数据，每次用户向下滚动时，它都会加载更多数据并将其添加到该适配器后面的 ArrayList 中。数据包含图像 URL，然后我在 getView 方法中延迟加载。

*   有没有更好的解决方案？
*   以及如何正确缓存这些图像？
*   当用户旋转设备时，我可以保留适配器的数据吗？所以不需要从头开始再次加载它们？

我使用片段来显示该列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:42:26.287

我将尝试一一回答所有三个问题。

**有没有更好的解决方案？（除延迟加载外）**

那要看。延迟加载的好处是，当您显示组件时，您不需要一开始就拥有所有数据。问题通常是，如何根据需要获取新数据。

因此，当从网络加载新数据时，实际上是加载数据块有多大的问题。我不会在下一个条目之后加载一个新条目，而是在到达列表末尾时加载例如 20 个新条目。

当然，这只是一个数字的随机想法，您需要为您的案例找到速度和可用性之间的完美点。

因此，当您从 Web 服务加载足够快的数据块时，这确实是一个很酷的概念。但是，如果您只是在阅读一个又一个条目（因此，用户几乎总是在等待新数据），这真的很烦人。

**以及如何正确缓存图像？**

有多种可能的解决方案可用，其中一些是：

*   [使用 system-cache](https://stackoverflow.com/questions/1945201/android-image-caching)，就像浏览器一样（似乎是最好的）。
*   实现您自己的使用设备存储的系统（例如 SD 卡或内部应用程序存储（首选第一个））。

您可能还喜欢[这个问题](https://stackoverflow.com/questions/6875847/android-image-caching-how)的内容（并且它是公认的答案），为您提供一些关于内存管理的一般建议。

**当用户旋转设备时，我可以保留适配器的数据吗？**

旧的，**已弃用**的分析器：

> ~~是的，您可以使用 Activity 的“实例状态”来执行此操作。基本上，来自 Activity 的[`onSaveInstanceState()`-method](http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29)允许您使用状态信息填充给定`Bundle`，然后将其传递给[`onCreate()`-method](http://developer.android.com/reference/android/app/Activity.html#onCreate%28android.os.Bundle%29)。~~
> 
> ~~您将保存在其中的数据`Bundle`将是（例如）列表的当前位置，甚至可能是列表本身（取决于大小）。~~

是的，使用[Loaders API](http://developer.android.com/guide/components/loaders.html)。它也可以在兼容性库中找到。

# sql - 这些连接是否在 AFTER INSERT,UPDATE 触发器内？使用 IF UPDATE(column...)？

> ID：10097685
> 
> 赞同：0
> 
> 时间：2012-04-10T23:03:46.963
> 
> 标签：sql, tsql, sql-server-2008-r2

我有这个触发器可以正常工作（据我的测试可以看出），但我强烈怀疑我可以通过使用 IF UPDATE 来简化代码......我只是不完全理解它是如何工作的。我似乎在插入和删除表方面做得最好。

可以按照我刚才提到的方式（或任何其他提高可读性的方式）简化此触发器吗？

```
CREATE TRIGGER [dbo].[tr_Affiliate_IU] 
   ON  [dbo].[Affiliate] 
   AFTER INSERT, UPDATE
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    -- Get the current date.
    DECLARE @getDate DATETIME = GETDATE()

    -- Set the initial values of date_created and date_modified.
    UPDATE
        dbo.Affiliate
    SET 
         date_created = @getDate
    FROM
        dbo.Affiliate A 
        INNER JOIN INSERTED I ON A.id = I.id
        LEFT OUTER JOIN DELETED D ON I.id = D.id
    WHERE
        D.id IS NULL

    -- Ensure the value of date_created does never changes.
    -- Update the value of date_modified to the current date.
    UPDATE
        dbo.Affiliate
    SET
         date_created = D.date_created
        ,date_modified = @getDate
    FROM 
        dbo.Affiliate A 
        INNER JOIN INSERTED I ON A.id = I.id
        INNER JOIN DELETED D ON I.id = D.id 
END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:44:53.553

如果 updated(column_name) 无济于事，因为它只是说明该列参与了引发触发器的查询。触发器的更新部分可以通过使用 case 语句来缩短，以帮助确定 date_created 将保留哪个日期。

```
CREATE TRIGGER [dbo].[tr_Affiliate_IU] 
   ON  [dbo].[Affiliate] 
   AFTER INSERT, UPDATE
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    -- Get the current date.
    DECLARE @getDate DATETIME = GETDATE()

    -- Set the initial values of date_created and date_modified.
    UPDATE
        dbo.Affiliate
    SET 
      -- If there is a record for this ID in Deleted
         date_created = case when D.id is not null 
                          -- Take date of creation from Deleted
                             then D.date_created 
                             else @getDate 
                             end
        ,date_modified = @getDate
    FROM
        dbo.Affiliate A 
        INNER JOIN INSERTED I ON A.id = I.id
        LEFT OUTER JOIN DELETED D ON I.id = D.id
END 
```

# linux - 哪个IDE用于调试wireshark？

> ID：10097687
> 
> 赞同：0
> 
> 时间：2012-04-10T23:04:11.090
> 
> 标签：linux, debugging, ide, wireshark

我想通过wireshark中的一些代码来看看一些事情是如何工作的。我已经阅读了一些 Wireshark 构建环境指南，但似乎缺少很多信息。我以前从未在 linux 中做过任何编程，所以请耐心等待。

在 Linux 中用于调试 Wireshark 的最佳 IDE 是什么？如果没有，那么在没有 IDE 的情况下如何调试？我真的只在 Visual Studio 中开发过，所以我被它的易用性宠坏了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:09:36.983

您可以将 Eclipse 用作具有调试功能的成熟 IDE。或者您可以使用 gdb 从命令行进行调试。或者您可以使用 DDD，它是 gdb 的 GUI 前端。

# java - Appengine 后端任务调度器：更经济的版本

> ID：10097693
> 
> 赞同：3
> 
> 时间：2012-04-10T23:04:53.320
> 
> 标签：java, multithreading, performance, google-app-engine, scheduled-tasks

我正在为 appengine 开发作业调度程序，默认调度程序总是会启动 3-4 个实例来完成所有工作，一些溢出实例可能需要数千个任务，或者只有几个，然后坐在那里烧 CPU什么也不做。

我的任务涉及为许多不同大小的域处理作业，有时吞吐量很大，有时是一个用户有 10,000 个模型要更新；如果我松开普通的 appengine 任务调度程序，它会以两种方式失败：1）后端永远不会关闭，当内存达到上限时，java gc 会使实例抖动并表现得几乎是僵尸但从未关闭{并且仍然take/hold jobs}，以及 2) 许多域有一个用户，其处理时间比其他所有用户要长得多，这使得后端在域的其余部分完成后很长时间内保持活动状态。

这些任务必须全天运行，并且需要多个后端来处理扇出，所以我不能将它们全部转储到 B8 上并收工。所以我们需要一个调度程序来管理如何将任务分配给后端。

现在，我不想为了节省几分钟的 cpu 时间而为每项任务支付数据存储操作费用，所以我的攻击计划{请批评}是在 RAM 中使用静态 ConcurrentHashMap，尝试启动每个 run() ，让每个延迟任务在启动时将其 [hashcode, startTime] 放入并在 finally 中放入 remove(hashcode)。每个正在运行作业的后端实例都会有一个这样的映射，包装在一个方法中，BackendCounter.addToLiveMap(this); 它的 .size() 用作该后端上有多少作业处于活动状态的运行总数{带有时间戳以检测运行 > 10 分钟的僵尸作业}。作业调度程序可以为每个实例触发一个工作线程，以监控在该实例中运行的作业（不包括其自身）的数量，并在内存缓存中保留一个排名列表，其中哪些实例有多少任务处于活动状态。如果一个实例低于 X 个活动任务的阈值，则选择一个溢出实例来推迟，然后让 BackendCounter.addToLiveMap(this) 方法抛出一个我可以捕获的异常，告诉作业只将自己安排到一个新实例 {ChangeInstanceException#获取新目标（）}。通过这种方式，我可以防止几乎没有使用过的实例获得新作业，以便它们有机会关闭，只需为一些 memcache 操作付费，而扇出只需对静态映射进行写入和删除。

这解决了问题二，即实例小时杀手。至于问题一，即如何防止一个实例（通常是实例 0 和 1）达到内存峰值并开始转向黑暗面，我在两个选项之间徘徊。

一方面，我可以使用对 BackendCounter.addToLiveMap(this) 的预期调用 throws ChangeInstanceException 并简单地检查内存：

if (((float)Runtime.getRuntime().freeMemory() / Runtime.getRuntime().totalMemory())<0.9) throw new ChangeInstanceException(getOverflowInstance()); 这种天真的方法只会告诉任何接近其内存限制的实例将所有新工作发送到其他地方。

另一方面，我可以保留实例 0 和 1 来处理溢出{并在两者中的哪一个获得新作业以使它们有机会关闭}，然后将扇出发送到实例 2+，它只会运行直到它们顺便说一下，并行 10 或 15 个工作。扇出非常一致，只需要几分钟，因此实例 2、3 和最多 4 个将需要打开，并在另一个实例受到更多负载时有时间关闭。我唯一担心的是，如果作业开始从一个实例跳到另一个实例，这可能可以通过重定向标头限制来克服，以跳过抛出 ChangeInstanceException。

非常感谢任何想法或建议。

# entity-framework-4 - 获取初始实体框架迁移脚本

> ID：10097696
> 
> 赞同：11
> 
> 时间：2012-04-10T23:05:00.980
> 
> 标签：entity-framework-4, entity-framework-migrations

我刚刚安装了 Entity Framework Migrations，向一个类添加了一个属性，然后试了一下 EF Migrations。

我的开发数据库及时更新。到现在为止还挺好。

现在，我想为生产数据库的迁移的*初始使用创建一个更改脚本。*请注意，有一个预先存在的数据库，因为我将它应用于现有项目。

我的迁移是：

```
PM> Get-Migrations
Retrieving migrations that have been applied to the target database.
201204102238194_AutomaticMigration
201203310233324_InitialCreate
PM> 
```

我想我可以使用以下内容获得一个 delta 脚本：

```
Update-Database -SourceMigration:201203310233324_InitialCreate -TargetMigration:201204102238194_AutomaticMigration  -script 
```

但是，这给了我错误：

> “201204102238194_Au​​tomaticMigration”不是有效的迁移。在编写它们之间的升级脚本时，必须对源和目标使用显式迁移。

只是为了看看会发生什么，我颠倒了两个参数（向后迁移）并在添加*-force*标志后得到了我期望的脚本（删除了新列）。

**如何获得第一次迁移的脚本？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-14T15:28:02.280

开始对现有数据库使用 EF 迁移的正确方法是首先添加一个包含当前数据库元数据的空迁移。

我认为您必须回滚到与初始数据库模式兼容的模型。然后运行以下命令：

```
add-migration InitialSchema -IgnoreChanges 
```

这应该会给你一个初始迁移，它什么都不做，但包含当前模型的元数据。`-IgnoreChanges`如果您已扩展代码模型以涵盖数据库中已经存在的更多表，您当然可以稍后添加迁移。

完成初始迁移步骤后，脚本就可以工作了。

一般来说，我不建议使用自动迁移，除非您只打算使用自动迁移。如果您想对数据库的更改进行某种控制（包括编写脚本），那么基于代码的迁移就是一种方式。

# ruby - Nokogiri::XML::Builder：需要使用字符串“send”作为元素名称

> ID：10097697
> 
> 赞同：3
> 
> 时间：2012-04-10T23:05:09.320
> 
> 标签：ruby, nokogiri, send, builder

我正在编写一个应用程序来生成 XML 文件作为 SipP 的输入。SipP 经常使用的一个标签是“发送”

问题是，当我使用 nokogiri 为我构建 xml 时

```
builder = Nokogiri::XML::Builder.new do |xml|
  xml.send "Some Content"
end 
```

我明白了

```
<?xml version="1.0"?>
<Some Content/> 
```

当我这样做时也会发生同样的情况：

```
builder = Nokogiri::XML::Builder.new do |xml|
  xml.send(:'send', "Some Content")
end 
```

我不能用大写字母拼写“SEND”，因为 SipP 不会这样理解。

任何想法如何强制 nokogiri 创建一个名为“发送”的元素？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T23:12:38.113

从[文档](http://nokogiri.rubyforge.org/nokogiri/Nokogiri/XML/Builder.html)：

> 构建器通过利用 method_missing 来工作。不幸的是，在 ruby​​ 中定义了一些难以删除或危险的方法。例如，您可能希望创建名称为“type”、“class”和“id”的标签。在这种情况下，您可以使用下划线来消除您的标签名称与方法调用的歧义。

因此，请检查以下内容：

```
irb(main):007:0> Nokogiri::XML::Builder.new { |xml| xml.send_ "foo" }.to_xml
=> "<?xml version=\"1.0\"?>\n<send>foo</send>\n" 
```

# django - Django 如何处理模板名称冲突？

> ID：10097704
> 
> 赞同：0
> 
> 时间：2012-04-10T23:06:33.380
> 
> 标签：django, django-templates

...当多个应用程序在适当的层次结构之外定义类似命名的模板时。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:16:35.303

不是很清楚你的意思。当你指定一个模板时，你应该适当地命名它并准确地指定它。如果您的意思是管理员从模板列表中选择“最佳”模板，它使用简单的算法来找到最佳匹配。它只需将模板列表传递给 loader.select_template 并使用第一个有效的模板即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:20:15.070

模板加载器按照您在 中定义的顺序应用`settings.TEMPLATE_LOADERS`。

例如，如果您在`app_directories`加载器之后运行`filesystem`加载器并且您的模板位于`filesystem`加载器中，`app_directories`则永远不会使用加载器。

如果您专门讨论`app_directories`加载程序，它会按照它们在`INSTALLED_APPS`.

如果您有非故意的冲突模板名称（不是某种覆盖层次结构），您最好为每个模板文件夹添加应用程序名称的前缀。

```
# this is standard
myapp/templates/myapp/index.html 
myapp2/templates/myapp2/index.html 
```

# java - 我的应用程序如何知道要使用的私钥

> ID：10097708
> 
> 赞同：0
> 
> 时间：2012-04-10T23:06:57.703
> 
> 标签：java, ssl, glassfish

我有一个在 GlassFish 3.x 上运行的应用程序。它通过 https 与远程服务器通信。在我的 cacerts 文件中，我添加了服务器证书。在我的 keystore.jks 中，我添加了运行远程服务器的公司发给我的私钥。这在 Glassfish 2.x 上效果很好，但是在 3.x 上，他们的远程服务器一直抱怨我拥有的密钥无效。

如果我从密钥库中删除密钥，我会得到同样的错误。就好像它甚至没有加载密钥，这让我想知道应用程序/容器如何知道我需要哪个密钥

我的连接代码如下所示：

```
public class SSLSocket {

private static Logger logger = LoggerFactory.getLogger(SSLSocket.class);
private ConnectionProperties connectionProperties;

public TuSSLSocket(ConnectionProperties connectionProperties) {
    this.connectionProperties = connectionProperties;
}

public SSLSocket getSSLSocket() throws Exception{
    SSLSocketFactory factory = (SSLSocketFactory) SSLSocketFactory.getDefault();
    SSLSocket socket = (SSLSocket) factory.createSocket(connectionProperties.getHost(), connectionProperties.getPort());
    socket.setSoTimeout(90000);

    return socket;
}

} 
```

我相应地设置了主机和端口，但我没有说去哪里寻找密钥库中的这个别名。那么......应用程序如何知道要抓取的别名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T02:33:54.593

解释两种方式的 ssl 和所有爵士乐令人筋疲力尽。我会尝试找到一个有用的链接。但是，当部署在 glassfish 中的应用程序作为客户端通过 SSL 与服务器通信时（例如，通过 SSL 端口配置的 LDAP 服务器领域），它将使用 glassfish 服务器的身份证书（来自其密钥库）作为其客户端证书。

但是，如果您明确编码 SSL 握手，则客户端应用程序负责选择密钥库，并将证书作为握手的一部分提供。

由于它在以前版本的 Glassfish 中工作，因此相同的代码应该适合您。您的问题很可能与配置有关。我对您添加到服务器的内容感到有些困惑，`keystore.jks`通常其他服务器的证书已添加到信任库`cacerts.jks`

一个[有用的 glassfish ssl 示例](http://www.nolte-schamm.za.net/2011/06/glassfish-ssl/)

[SSL 套接字客户端](http://www.herongyang.com/JDK/SSL-Socket-Client-Example-SslSocketClient.html)示例

[在客户端选择密钥库的示例。](http://www.rap.ucar.edu/staff/paddy/cacerts/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-06T03:53:15.093

有两种方法可以做到这一点第一种：

从管理控制台页面打开以下路径。

*   配置
*   您的集群/实例配置。
*   jvm设置
*   jvm 选项
*   您会在项目列表中的某个位置找到此行 -Dcom.sun.enterprise.security.httpsOutboundKeyAlias=s1as

将 s1as 值更改为您要使用的证书别名。

另一种选择是将系统属性添加到您的代码 System.setProperty("com.sun.enterprise.security.httpsOutboundKeyAlias", "your certificate alias");

# ruby-on-rails-3 - 将记录插入表格时如何自动获取通讯员ID

> ID：10097711
> 
> 赞同：0
> 
> 时间：2012-04-10T23:07:19.170
> 
> 标签：ruby-on-rails-3

我正在使用 ROR3 为一家公司开发员工记录管理系统我是 ROR 的新手。一个月前才开始。因此在开发应用程序时面临一些麻烦。

这些是一些表

1- 配置文件 id service_number first_name last_name

2- 促销 id service-number rank date_of_rank profile_id

当员工晋升到下一个级别时，我有一个表格可以插入晋升记录。

```
 <%= f.input :service_number %>
    <%= f.input :rank %>

    <%= f.input :date_of_rank, :start_year => Date.today.year - 50, :end_year => Date.today.year%>

        <%= f.hidden_field :profile_id %>

    <%= f.error :base %>
    <%= f.button :submit %>
<% end %> 
```

将数据插入促销表时，我想插入与用户输入的服务号对应的 profile_id。profile_id 是用户的隐藏字段。所以需要自动获取profile_id。我使用服务编号是因为它是公司用来识别员工的唯一编号。

任何人都可以帮我做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:07:48.080

有必要有`profile_id`隐藏标签吗？如果是一个独特的字段，您可以基于该`service_number`字段查找并将其与您正在创建的字段相关联。`Profile``Promotion`

```
def create
  @promotion = Promotion.new(params[:promotion])
  profile = Profile.where(:service_number => @promotion.service_number).first
  @promotion.profile = profile  # this will set profile_id for you

  @promotion.save
  ...
end 
```

这是假设您的`Promotion`模型具有`belongs_to :profile`关联并且您的`Profile`模型具有`has_many :promotions`关联（或 `has_one :promotion`）。

# upload - 无法使用 expressjs 处理图像上传

> ID：10097712
> 
> 赞同：0
> 
> 时间：2012-04-10T23:07:21.477
> 
> 标签：upload, express

我正在使用 express v2.5.8。我正在从多部分表单上传文件，其中表单中的文件输入被分类为文件：

表格：enctype="multipart/form-data"

元素：类型='文件'

在服务器端应用程序中，我设置了以下内容： app.use(express.bodyParser({uploadDir:'./files/ph'})), //valid directory and no write issues

我还需要“fs”模块。

在表单处理路线中，我可以看到 req.body，但是当我尝试访问 req.files 时，它似乎是未定义的，当我检查 req.is('image') 时，结果为 false。

任何有关从通过 express 处理的 html 表单处理图像上传的建议将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:44:57.053

我切换到 node-formidable 并且它对我有用 - 一旦我使用 express v3.0/connect v2.0，我将再次检查上述逻辑（看起来多部分数据的 req.files 在 express 3.0/connect 2.0 中可用，尽管我我不完全确定，所以请自己做尽职调查）。

# android - 适用于 Android 非实时应用的 Android SDK 与 HTML5

> ID：10097713
> 
> 赞同：1
> 
> 时间：2012-04-10T23:07:25.143
> 
> 标签：android, html

假设我想为 Android 操作系统编写一个**不会**成为实时游戏的应用程序；也就是说，它将是一个基于表格和页面的回合制游戏（需要互联网访问）。

我想使用 HTML5 来执行此操作，并且只需在本机应用程序上有一个 WebView，并与网站的 javascript 等进行一些绑定，以获得更多功能（如果需要）。当然，由于这不是实时游戏，因此性能似乎不是问题。

我能想到*不*使用 HTML5 的唯一真正原因是因为在表单之间会有加载时间，例如每次用户单击按钮执行将它们转换为新表单的操作时，这实际上是一个新的网络page，必须加载该网页。如果我使用 Android SDK 在本机上执行此操作，则表单的加载将是无缝且即时的（即使 Web 启动/关闭将花费少量时间，但这是意料之中的）。

这是一个真正的问题吗？有没有不涉及使用 Android SDK 而不是 HTML5 的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:58:28.950

几个想法：

1) 将您的 HTML 与名为 assets 的文件夹中的应用程序捆绑在一起，然后使用类似 file:///android_asset/your_path.html 的 URL 从那里加载它。这将减少加载所需的时间，因为内容将在设备上。

但是，请注意 Android 3.0+ 中的以下 webview 错误，该错误会导致任何带有 # 或 ? 的 URL 无法从资产文件夹加载：
[http ://code.google.com/p/android/issues/detail?id=17535](http://code.google.com/p/android/issues/detail?id=17535)

2）您也可以选择使用AJAX来减少页面加载时间。您在开始时加载繁重的库一次，然后使用 AJAX 进行后续页面加载，以避免加载大量 JS 内容。但要注意上面的错误，因为 AJAX 页面加载在 URL 中使用 #。

# t4mvc - T4MVC 和没有查询参数的路径

> ID：10097717
> 
> 赞同：1
> 
> 时间：2012-04-10T23:07:46.520
> 
> 标签：t4mvc

我可以在不使用可为空整数的情况下使用 T4MVC 呈现不带查询参数的 url 吗？

```
public virtual ActionResult GetSchoolsForDistrict(int districtId)
        {
            return Json(_schoolsService.GetSchoolsByDistrict(districtId.Value), JsonRequestBehavior.AllowGet);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:11:24.497

您应该能够在没有任何参数的情况下调用它。例如

```
Html.ActionLink(MVC.Schools.GetSchoolsForDistrict()) 
```

这是因为 T4MVC 总是生成一个没有参数的重载。

# javascript - 无法在 IE9 中应用 CSS

> ID：10097718
> 
> 赞同：1
> 
> 时间：2012-04-10T23:07:59.323
> 
> 标签：javascript, jquery, css

我有一个使用 OpenTable 的预订小部件的网站。在除 IE9 之外的所有浏览器（包括旧版本的 IE）中，我都可以通过样式表和使用 jQuery 来设置和操作小部件元素的样式。但在 IE9 中，小部件以奇怪的样式显示，我无法以任何方式影响它。即使尝试像这样的简单测试`$('#OT_form').hide();`也没有任何效果。

这是该网站的临时链接：

[http://www.tcmulder.com/jing/reservations](http://www.tcmulder.com/jing/reservations)

有谁知道可能是什么问题？

# sql - 查询通过键值对链接到实际匹配条件的记录的记录

> ID：10097722
> 
> 赞同：1
> 
> 时间：2012-04-10T23:08:32.917
> 
> 标签：sql, database, postgresql

我们有一个简单的通用表结构，在 PostgreSQL 中实现（8.3；9.1 即将推出）。这似乎是一个非常简单和常见的实现。归结为：

```
events_event_types
(
    # this table holds some 50 rows
    id bigserial # PK
    "name" character varying(255)
)

events_events
(
    # this table holds some 15M rows
    id bigserial # PK
    datetime timestamp with time zone
    eventtype_id bigint # FK to events_event_types.id
)

CREATE TABLE events_eventdetails
(
    # this table holds some 65M rows
    id bigserial # PK
    keyname character varying(255)
    "value" text
    event_id bigint # FK to events_events.id
) 
```

events_events 和 events_eventdetails 表中的某些行如下所示：

```
events_events               | events_eventdetails
  id  datetime eventtype_id |   id   keyname       value        event_id
----------------------------|-------------------------------------------
  100 ...      10           |   1000 transactionId 9774ae16-... 100
                            |   1001 someKey       some value   100
  200 ...      20           |   2000 transactionId 9774ae16-... 200
                            |   2001 reductionId   123          200
                            |   2002 reductionId   456          200
  300 ...      30           |   3000 transactionId 9774ae16-... 300
                            |   2001 customerId    234          300
                            |   2001 companyId     345          300 
```

我们迫切需要一个“解决方案”，它可以在单个结果集中同时返回 events_events 第 100 行、第 200 行和第 300 行，而且速度很快！当被问到 reductionId=123 或当被问到 customerId=234 或当被问到 companyId=345 时。（可能对这些标准的 AND 组合感兴趣，但这不是本质上的目标。）目前不确定它是否重要，但结果集应该可以根据日期时间范围和 eventtype_id（IN 列表）进行过滤，并给出一个限制。

我要求一个“解决方案”，因为这可能是：

*   单个查询
*   两个较小的查询（只要它们的中间结果总是足够小。我遵循这种方法并被困在具有大量（~20k）关联交易（transactionId）的公司（companyId））
*   微妙的重新设计（例如非规范化）

这不是一个新问题，因为我们在数月内尝试了所有三种方法（这些查询不会打扰您），但性能都失败了。解决方案应在 <<<1s 内返回。以前的尝试大约花了。最好10s。

我真的很感激一些帮助 - 我现在不知所措......

* * *

两个较小的查询方法看起来很像这样：

查询一：

```
SELECT Substring(details2_transvalue.VALUE, 0, 32)
    FROM events_eventdetails details2_transvalue
    JOIN events_eventdetails compdetails ON details2_transvalue.event_id = compdetails.event_id
    AND compdetails.keyname = 'companyId'
    AND Substring(compdetails.VALUE, 0, 32) = '4'
    AND details2_transvalue.keyname = 'transactionId' 
```

查询 2：

```
SELECT events1.*
    FROM events_events events1
    JOIN events_eventdetails compDetails ON events1.id = compDetails.event_id
    AND compDetails.keyname='companyId'
    AND substring(compDetails.value,0,32)='4'
    WHERE events1.eventtype_id IN (...)
UNION
SELECT events2.*
    FROM events_events events2
    JOIN events_eventdetails details2_transKey ON events2.id = details2_transKey.event_id
    AND details2_transKey.keyname='transactionId'
    AND substring(details2_transKey.value,0,32) IN ( -- result of query 1 goes here -- )
    WHERE events2.eventtype_id IN (...)
    ORDER BY dateTime DESC LIMIT 50 
```

由于查询 1 返回的集合很大，因此性能变差。

如您所见，events_eventdetails 表中的值始终表示为长度为 32 的子字符串，我们已经对其进行了索引。keyname、event_id、event_id + keyname、keyname + 长度为 32 的子字符串的进一步索引。

* * *

这是一种 PostgreSQL 9.1 方法——尽管我没有正式拥有该平台供我使用：

```
WITH companyevents AS (
SELECT events1.*
FROM events_events events1
JOIN events_eventdetails compDetails
ON events1.id = compDetails.event_id
AND compDetails.keyname='companyId'
AND substring(compDetails.value,0,32)=' -- my desired companyId -- '
WHERE events1.eventtype_id in (...)
ORDER BY dateTime DESC
LIMIT 50
)
SELECT * from events_events
WHERE transaction_id IN (SELECT transaction_id FROM companyevents)
OR id IN (SELECT id FROM companyevents)
AND eventtype_id IN (...)
ORDER BY dateTime DESC
LIMIT 250; 
```

companyId 28228 个 transactionId 的查询计划如下：

```
 Limit  (cost=7545.99..7664.33 rows=250 width=130) (actual time=210.100..3026.267 rows=50 loops=1)
   CTE companyevents
     ->  Limit  (cost=7543.62..7543.74 rows=50 width=130) (actual time=206.994..207.020 rows=50 loops=1)
           ->  Sort  (cost=7543.62..7544.69 rows=429 width=130) (actual time=206.993..207.005 rows=50 loops=1)
                 Sort Key: events1.datetime
                 Sort Method: top-N heapsort  Memory: 23kB
                 ->  Nested Loop  (cost=10.02..7529.37 rows=429 width=130) (actual time=0.093..178.719 rows=28228 loops=1)
                       ->  Append  (cost=10.02..1140.62 rows=657 width=8) (actual time=0.082..27.594 rows=28228 loops=1)
                             ->  Bitmap Heap Scan on events_eventdetails compdetails  (cost=10.02..394.47 rows=97 width=8) (actual time=0.021..0.021 rows=0 loops=1)
                                   Recheck Cond: (((keyname)::text = 'companyId'::text) AND ("substring"(value, 0, 32) = '4'::text))
                                   ->  Bitmap Index Scan on events_eventdetails_substring_ind  (cost=0.00..10.00 rows=97 width=0) (actual time=0.019..0.019 rows=0 loops=1)
                                         Index Cond: (((keyname)::text = 'companyId'::text) AND ("substring"(value, 0, 32) = '4'::text))
                             ->  Index Scan using events_eventdetails_companyid_substring_ind on events_eventdetails_companyid compdetails  (cost=0.00..746.15 rows=560 width=8) (actual time=0.061..18.655 rows=28228 loops=1)
                                   Index Cond: (((keyname)::text = 'companyId'::text) AND ("substring"(value, 0, 32) = '4'::text))
                       ->  Index Scan using events_events_pkey on events_events events1  (cost=0.00..9.71 rows=1 width=130) (actual time=0.004..0.004 rows=1 loops=28228)
                             Index Cond: (id = compdetails.event_id)
                             Filter: (eventtype_id = ANY ('{103,106,107,110,45,34,14,87,58,78,7,76,42,11,25,57,98,37,30,35,33,49,52,29,74,28,85,59,51,65,66,18,13,86,75,6,44,38,43,94,56,95,96,71,50,81,90,89,16,17,4,88,79,77,68,97,92,67,72,53,2,10,31,32,80,111,104,93,26,8,61,5,73,70,63,20,60,40,41,23,22,48,36,108,99,64,62,55,69,19,46,47,15,54,100,101,27,21,12,102,105,109,112,113,114,115,116,119,120,121,122,123,124,9,127,24,130,132,129,125,131,118,117,133,134}'::bigint[]))
   ->  Index Scan Backward using events_events_datetime_ind on events_events  (cost=2.25..1337132.75 rows=2824764 width=130) (actual time=210.100..3026.255 rows=50 loops=1)
         Filter: ((hashed SubPlan 2) OR ((hashed SubPlan 3) AND (eventtype_id = ANY ('{103,106,107,110,45,34,14,87,58,78,7,76,42,11,25,57,98,37,30,35,33,49,52,29,74,28,85,59,51,65,66,18,13,86,75,6,44,38,43,94,56,95,96,71,50,81,90,89,16,17,4,88,79,77,68,97,92,67,72,53,2,10,31,32,80,111,104,93,26,8,61,5,73,70,63,20,60,40,41,23,22,48,36,108,99,64,62,55,69,19,46,47,15,54,100,101,27,21,12,102,105,109,112,113,114,115,116,119,120,121,122,123,124,9,127,24,130,132,129,125,131,118,117,133,134}'::bigint[]))))
         SubPlan 2
           ->  CTE Scan on companyevents  (cost=0.00..1.00 rows=50 width=90) (actual time=206.998..207.071 rows=50 loops=1)
         SubPlan 3
           ->  CTE Scan on companyevents  (cost=0.00..1.00 rows=50 width=8) (actual time=0.001..0.026 rows=50 loops=1)
 Total runtime: 3026.410 ms 
```

companyId 288 个 transactionId 的查询计划如下：

```
 Limit  (cost=7545.99..7664.33 rows=250 width=130) (actual time=30.976..3790.362 rows=54 loops=1)
   CTE companyevents
     ->  Limit  (cost=7543.62..7543.74 rows=50 width=130) (actual time=9.263..9.290 rows=50 loops=1)
           ->  Sort  (cost=7543.62..7544.69 rows=429 width=130) (actual time=9.263..9.272 rows=50 loops=1)
                 Sort Key: events1.datetime
                 Sort Method: top-N heapsort  Memory: 24kB
                 ->  Nested Loop  (cost=10.02..7529.37 rows=429 width=130) (actual time=0.071..8.195 rows=1025 loops=1)
                       ->  Append  (cost=10.02..1140.62 rows=657 width=8) (actual time=0.060..1.348 rows=1025 loops=1)
                             ->  Bitmap Heap Scan on events_eventdetails compdetails  (cost=10.02..394.47 rows=97 width=8) (actual time=0.021..0.021 rows=0 loops=1)
                                   Recheck Cond: (((keyname)::text = 'companyId'::text) AND ("substring"(value, 0, 32) = '5'::text))
                                   ->  Bitmap Index Scan on events_eventdetails_substring_ind  (cost=0.00..10.00 rows=97 width=0) (actual time=0.019..0.019 rows=0 loops=1)
                                         Index Cond: (((keyname)::text = 'companyId'::text) AND ("substring"(value, 0, 32) = '5'::text))
                             ->  Index Scan using events_eventdetails_companyid_substring_ind on events_eventdetails_companyid compdetails  (cost=0.00..746.15 rows=560 width=8) (actual time=0.039..1.006 rows=1025 loops=1)
                                   Index Cond: (((keyname)::text = 'companyId'::text) AND ("substring"(value, 0, 32) = '5'::text))
                       ->  Index Scan using events_events_pkey on events_events events1  (cost=0.00..9.71 rows=1 width=130) (actual time=0.005..0.006 rows=1 loops=1025)
                             Index Cond: (id = compdetails.event_id)
                             Filter: (eventtype_id = ANY ('{103,106,107,110,45,34,14,87,58,78,7,76,42,11,25,57,98,37,30,35,33,49,52,29,74,28,85,59,51,65,66,18,13,86,75,6,44,38,43,94,56,95,96,71,50,81,90,89,16,17,4,88,79,77,68,97,92,67,72,53,2,10,31,32,80,111,104,93,26,8,61,5,73,70,63,20,60,40,41,23,22,48,36,108,99,64,62,55,69,19,46,47,15,54,100,101,27,21,12,102,105,109,112,113,114,115,116,119,120,121,122,123,124,9,127,24,130,132,129,125,131,118,117,133,134}'::bigint[]))
   ->  Index Scan Backward using events_events_datetime_ind on events_events  (cost=2.25..1337132.75 rows=2824764 width=130) (actual time=30.975..3790.332 rows=54 loops=1)
         Filter: ((hashed SubPlan 2) OR ((hashed SubPlan 3) AND (eventtype_id = ANY ('{103,106,107,110,45,34,14,87,58,78,7,76,42,11,25,57,98,37,30,35,33,49,52,29,74,28,85,59,51,65,66,18,13,86,75,6,44,38,43,94,56,95,96,71,50,81,90,89,16,17,4,88,79,77,68,97,92,67,72,53,2,10,31,32,80,111,104,93,26,8,61,5,73,70,63,20,60,40,41,23,22,48,36,108,99,64,62,55,69,19,46,47,15,54,100,101,27,21,12,102,105,109,112,113,114,115,116,119,120,121,122,123,124,9,127,24,130,132,129,125,131,118,117,133,134}'::bigint[]))))
         SubPlan 2
           ->  CTE Scan on companyevents  (cost=0.00..1.00 rows=50 width=90) (actual time=9.266..9.327 rows=50 loops=1)
         SubPlan 3
           ->  CTE Scan on companyevents  (cost=0.00..1.00 rows=50 width=8) (actual time=0.001..0.019 rows=50 loops=1)
 Total runtime: 3796.736 ms 
```

对于 3s/4s，这一点也不差，但仍然太慢了 100+。此外，这不在相关硬件上。尽管如此，它应该显示疼痛在哪里。

* * *

这里有一些可能会变成解决方案的东西：

添加了一个表：

```
events_transaction_helper
(
    event_id bigint not null
    transactionid character varying(36) not null
    keyname character varying(255) not null
    value bigint not null
    # index on keyname, value
) 
```

我现在“手动”填写了这张表，但是物化视图实现可以解决问题。它将遵循以下查询：

```
SELECT tr.event_id, tr.value AS transactionid, det.keyname, det.value AS value
   FROM events_eventdetails tr
   JOIN events_eventdetails det ON det.event_id = tr.event_id
  WHERE tr.keyname = 'transactionId'
     AND det.keyname
     IN ('companyId', 'reduction_id', 'customer_id'); 
```

在 events_events 表中添加了一列：

```
transaction_id character varying(36) null 
```

这个新列的填充如下：

```
update events_events
set transaction_id =
    (select value from events_eventdetails
        where keyname='transactionId'
        and event_id=events_events.id); 
```

现在，以下查询始终在 <15ms 内返回：

```
explain analyze select * from events_events
    where transactionId in
    (select distinct transactionid
        from events_transaction_helper
        WHERE keyname='companyId' and value=5)
    and eventtype_id in (...)
    order by datetime desc limit 250;

 Limit  (cost=5075.23..5075.85 rows=250 width=130) (actual time=8.901..9.028 rows=250 loops=1)
   ->  Sort  (cost=5075.23..5077.19 rows=785 width=130) (actual time=8.900..8.953 rows=250 loops=1)
         Sort Key: events_events.datetime
         Sort Method: top-N heapsort  Memory: 81kB
         ->  Nested Loop  (cost=57.95..5040.04 rows=785 width=130) (actual time=0.928..8.268 rows=524 loops=1)
               ->  HashAggregate  (cost=52.30..52.42 rows=12 width=37) (actual time=0.895..0.991 rows=276 loops=1)
                     ->  Subquery Scan on "ANY_subquery"  (cost=52.03..52.27 rows=12 width=37) (actual time=0.558..0.757 rows=276 loops=1)
                           ->  HashAggregate  (cost=52.03..52.15 rows=12 width=37) (actual time=0.556..0.638 rows=276 loops=1)
                                 ->  Index Scan using testmaterializedviewkeynamevalue on events_transaction_helper  (cost=0.00..51.98 rows=22 width=37) (actual time=0.068..0.404 rows=288 loops=1)
                                       Index Cond: (((keyname)::text = 'companyId'::text) AND (value = 5))
               ->  Bitmap Heap Scan on events_events  (cost=5.65..414.38 rows=100 width=130) (actual time=0.023..0.024 rows=2 loops=276)
                     Recheck Cond: ((transactionid)::text = ("ANY_subquery".transactionid)::text)
                     Filter: (eventtype_id = ANY ('{103,106,107,110,45,34,14,87,58,78,7,76,42,11,25,57,98,37,30,35,33,49,52,29,74,28,85,59,51,65,66,18,13,86,75,6,44,38,43,94,56,95,96,71,50,81,90,89,16,17,4,88,79,77,68,97,92,67,72,53,2,10,31,32,80,111,104,93,26,8,61,5,73,70,63,20,60,40,41,23,22,48,36,108,99,64,62,55,69,19,46,47,15,54,100,101,27,21,12,102,105,109,112,113,114,115,116,119,120,121,122,123,124,9,127,24,130,132,129,125,131,118,117,133,134}'::bigint[]))
                     ->  Bitmap Index Scan on testtransactionid  (cost=0.00..5.63 rows=100 width=0) (actual time=0.020..0.020 rows=2 loops=276)
                           Index Cond: ((transactionid)::text = ("ANY_subquery".transactionid)::text)
 Total runtime: 9.122 ms 
```

我稍后会回来告诉你这是否真的是一个可行的解决方案:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T11:14:14.760

这个想法*不是*去规范化，而是**规范化**。events_details() 表可以替换为两张表：一张是 event_detail_types，一张是实际值（参考 {even_id,detail_types}。这将使查询的执行更容易，因为只有数字 id 的detail_types 必须被提取和选择。好处是减少了 DBMS 必须获取的页面数量，因为所有的键名只需要存储+检索+比较一次。

注意：我稍微改变了命名。主要是出于理智和安全的原因。

```
SET search_path='cav';
/**** ***/
DROP SCHEMA cav CASCADE;
CREATE SCHEMA cav;
SET search_path='cav';

CREATE TABLE event_types
(
    -- this table holds some 50 rows
    id bigserial PRIMARY KEY
    , zname varchar(255)
);
INSERT INTO event_types(zname)
SELECT 'event_'::text || gs::text
FROM generate_series (1,100) gs
        ;

CREATE TABLE events
(
    -- this table holds some 15M rows
    id bigserial PRIMARY KEY
    , zdatetime timestamp with time zone
    , eventtype_id bigint REFERENCES event_types(id)
);
INSERT INTO events(zdatetime,eventtype_id)
SELECT gs, et.id
FROM generate_series ('2012-04-11 00:00:00'::timestamp
                     , '2012-04-12 12:00:00'::timestamp  ,' 1 hour'::interval ) gs
        , event_types et
        ;

-- SELECT * FROM event_types;
-- SELECT * FROM events;

CREATE TABLE event_details
(
    -- this table holds some 65M rows
    id bigserial PRIMARY KEY
    , event_id bigint REFERENCES events(id)
    , keyname varchar(255)
    , zvalue text
);

INSERT INTO event_details(event_id, keyname)
SELECT ev.id,im.*
FROM events ev
        , (VALUES ('transactionId'::text),('someKey'::text)
           ,('reductionId'::text),('customerId'::text),('companyId'::text)
          ) im
        ;
UPDATE event_details
SET zvalue = 'Some_value'::text || (random() * 1000)::int::text
        ;
        --
        -- Domain table with all valid detail_types
        --
CREATE TABLE detail_types(
        id bigserial PRIMARY KEY
        , keyname varchar(255)
        );
INSERT INTO detail_types(keyname)
SELECT DISTINCT keyname
        FROM event_details
        ;

        --
        -- Context-attribute-value table, referencing {event_id, type_id}
        --
CREATE TABLE event_detail_values
        ( event_id BIGINT
        , detail_type_id BIGINT
        , zvalue text
        , PRIMARY KEY(event_id , detail_type_id)
        , FOREIGN KEY(event_id ) REFERENCES events(id)
        , FOREIGN KEY(detail_type_id)REFERENCES detail_types(id)
        );

        --
        -- For the sake of joining we create some natural keys
        --
CREATE INDEX events_details_keyname ON event_details (keyname) ;
CREATE INDEX detail_types_keyname ON detail_types(keyname) ;

INSERT INTO event_detail_values (event_id,detail_type_id, zvalue)
        SELECT ed.event_id, dt.id
                , ed.zvalue
        FROM event_details ed
        , detail_types dt
        WHERE ed.keyname = dt.keyname
        ;
        --
        -- Now we can drop the original table, and use the view instead
        --
DROP TABLE event_details;
CREATE VIEW event_details AS (
        SELECT dv.event_id AS event_id
                , dt.keyname AS keyname
                , dv.zvalue AS zvalue
        FROM event_detail_values dv
        JOIN detail_types dt ON dt.id = dv.detail_type_id
        );
EXPLAIN ANALYZE
SELECT ev.id AS event_id
        , ev.zdatetime AS zdatetime
        , ed.keyname AS keyname
        , ed.zvalue AS zevalue
        FROM events ev
        JOIN event_details ed ON ed.event_id = ev.id
        WHERE ed.keyname IN ('transactionId','customerId','companyId')
        ORDER BY event_id,keyname
        ; 
```

结果查询计划：

```
 QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1178.79..1197.29 rows=7400 width=40) (actual time=159.902..177.379 rows=11100 loops=1)
   Sort Key: ev.id, dt.keyname
   Sort Method: external sort  Disk: 560kB
   ->  Hash Join  (cost=108.34..703.22 rows=7400 width=40) (actual time=12.225..122.231 rows=11100 loops=1)
         Hash Cond: (dv.event_id = ev.id)
         ->  Hash Join  (cost=1.09..466.47 rows=7400 width=32) (actual time=0.047..74.183 rows=11100 loops=1)
               Hash Cond: (dv.detail_type_id = dt.id)
               ->  Seq Scan on event_detail_values dv  (cost=0.00..322.00 rows=18500 width=29) (actual time=0.006..26.543 rows=18500 loops=1)
               ->  Hash  (cost=1.07..1.07 rows=2 width=19) (actual time=0.025..0.025 rows=3 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                     ->  Seq Scan on detail_types dt  (cost=0.00..1.07 rows=2 width=19) (actual time=0.009..0.014 rows=3 loops=1)
                           Filter: ((keyname)::text = ANY ('{transactionId,customerId,companyId}'::text[]))
         ->  Hash  (cost=61.00..61.00 rows=3700 width=16) (actual time=12.161..12.161 rows=3700 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 131kB
               ->  Seq Scan on events ev  (cost=0.00..61.00 rows=3700 width=16) (actual time=0.004..5.926 rows=3700 loops=1)
 Total runtime: 192.724 ms
 (16 rows) 
```

如您所见，查询的“最深”部分是在给定字符串列表的情况下检索 detail_type_ids。这被放入哈希表中，然后与 detail_values 的相应哈希集组合。（注意：这是 pg-9.1）

YMMV。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T06:13:42.887

看，如果您的键（`reductionId`在这种情况下）在表中所有行的 7-10% 以上都满足`events_eventdetails`，那么 PostgreSQL 将更喜欢 SeqScan。没有什么可以做的，*这是*最快的方法。

我有一个使用 ISO8583 数据包的类似案例。每个数据包包含 128 个字段（按设计），因此第一个数据库设计遵循您的方法，使用 2 个表：

*   `field_id`和一张表中的描述（`events_events`在你的情况下），
*   `field_id`+`field_value`在另一个 ( `events_eventdetails`) 中。

虽然这样的布局遵循 3NF，但我们马上遇到了同样的问题：

*   表现不佳，
*   高度复杂的查询。

在您的情况下，您应该进行重新设计。一种选择（更简单的一种）是`events_eventdetails.keyname`成为 a `smallint`，这将使比较操作更快。虽然不是很大的胜利。

另一种选择是将 2 个表减少为一个，例如：

```
CREATE TABLE events_events (
    id            bigserial,
    datetime      timestamp with time zone,
    eventtype_id  bigint,
    transactionId text,   -- value for transactionId 
    reductionId   text,   --   -"-     reductionId
    companyId     text,   -- etc.
    customerId    text,
    anyotherId    text,
    ...
); 
```

这*将*打破 3NF，但另一方面：

*   您有更多的自由来索引您的数据；
*   您的查询将更短且更易于维护；
*   性能会好很多。

可能的缺点：

*   您将为未使用的字段浪费更多空间：[`unused fields / 8`每行字节数](http://www.postgresql.org/docs/current/static/page.html#HEAPTUPLEHEADERDATA-TABLE)
*   您可能仍然需要一个额外的表格来处理那些太靠后而无法保留单独列的事件。

**编辑：**

我不太明白你在这里实现的意思。

在您提到的问题中，您想要：

> “解决方案”在单个结果集中同时返回 events_events 第 100 行、第 200 行和第 300 行，而且速度很快！当被问到 reductionId=123 或当被问到 customerId=234 或当被问到 companyId=345 时。

建议的重新设计从您的`events_eventdetails`. 要获取满足您条件的所有 events_events 行，您可以使用：

```
SELECT *
  FROM events_events
 WHERE id IN (100, 200, 300)
   AND reductionId = 123
-- AND customerId = 234
-- AND companyId = 345; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:41:31.863

如果您*必须*按照这些思路使用设计，您应该从 events_eventdetails 中删除 id 列，并将主键声明为 (event_id, keyname)。这将为您提供一个非常有用的索引，而无需为合成键维护一个无用的索引。

更好的方法是完全消除 events_eventdetails 表，并为该数据使用 hstore 列，并使用 GIN 索引。这可能会让您达到您的性能目标，而无需预先定义存储的事件详细信息。

更好的是，如果您可以预测或指定可能的事件细节，那就是不要尝试在数据库中实现数据库。将每个“keyname”值放入 events_eventdetails 中的列中，并使用适合该数据性质的数据类型。这可能会允许更快的访问，但代价是`ALTER TABLE`随着细节的性质发生变化而需要发布声明。

# jakarta-ee - 将表单上的大量参数传递给 Action Struts2

> ID：10097723
> 
> 赞同：0
> 
> 时间：2012-04-10T23:08:34.880
> 
> 标签：jakarta-ee, jqgrid, struts2, struts-html

我一直致力于将 Web 应用程序从 Struts1 迁移到 Struts2。

我有一个包含大约 45 个字段的简单表单（基本上是一个带有数据的网格）。我必须在 Struts2 Action 中捕获所有这些内容。我注意到在 struts2 中我们有 OGNL，通过它我们只需通过在本地声明字段来编写 getter setter 以使这些变量在请求中流动。我不能在我的操作中编写 45 个 getter/setter，必须有一种方法可以将整个对象（一个 POJO）从 jsp 传递到操作层。

在 Struts 1 中，我们通常在 map 中获取 ActionForm 对象和/或获取请求参数，然后进行填充。

# c++ - Using c++, why am I getting the error message "string subscript out of range" when I know it is not? Or at least it seems that way

> ID：10097725
> 
> 赞同：0
> 
> 时间：2012-04-10T23:08:58.483
> 
> 标签：c++, string, char, fstream, outofrangeexception

EDIT - there are no blank lines. EDIT 2 - my bad, it seems I was wrong all along. There is a blank line somewhere, although the csv file indicates otherwise. It's working now. Okay so here is the entire (short) program:

```
#include <iostream>
#include <cctype>
#include <string>
#include <fstream>
using namespace std;

int main(){
    char a;
    string stringmanip;

    fstream myfile("readthisfile.csv");
    if (myfile.is_open()){
        while ( myfile.good() ){
            getline(myfile,stringmanip);
            a=stringmanip[0];
        }
        myfile.close();
    }
    else cout<< "Unable to open file";

    return 0;
} 
```

It makes no sense to me. I can copy stringmanip, I can cout stringmanip, I can use .substr with stringmanip. If I define a regular string I can use the [] operation just fine. I've tried .at as well, but that only leads to another error. (Out of range).

Any help would be GREATLY appreciated. Sorry I'm such a beginner, as I'm sure you can tell.

Thanks, Ben

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T23:17:23.343

如果 readthisfile.csv 在文件末尾（或文件中的任何位置）有一个空行，那么您将返回一个空字符串。您不能取消引用空字符串的第 0 个字符。`string::operator[]`只接受从`0`to 的索引`string::length() - 1`。如果您有一个空字符串，任何调用都`string::operator[]`将导致未定义的行为。

# entity-framework - EF 4 Code First - 结合视图和表格

> ID：10097729
> 
> 赞同：1
> 
> 时间：2012-04-10T23:09:23.503
> 
> 标签：entity-framework, c#-4.0, views, ef-code-first

我研究了这个问题好几天，似乎找不到一个让我感觉良好的选项；但是，这是一个非常相似的问题的链接：

[将计算字段添加到模型](https://stackoverflow.com/questions/3756082/how-do-i-add-a-calculated-column-to-my-ef4-model)

最终，我有同样的问题，但我希望有更好的解决方案。

考虑以下数据库表：

```
CREATE TABLE [Contact](
[ContactID] [int] IDENTITY(1,1) NOT FOR REPLICATION NOT NULL,
[ContactName] [varchar](80) NOT NULL,
[Email] [varchar](80) NOT NULL,
[Title] [varchar](120) NOT NULL,
[Address1] [varchar](80) NOT NULL,
[Address2] [varchar](80) NOT NULL,
[City] [varchar](80) NOT NULL,
[State_Province] [varchar](50) NOT NULL,
[ZIP_PostalCode] [varchar](30) NOT NULL,
[Country] [varchar](50) NOT NULL,
[OfficePhone] [varchar](30) NOT NULL,
[MobilePhone] [varchar](30) NOT NULL)

CREATE TABLE [Blog](
[BlogID] [int] IDENTITY(1,1) NOT FOR REPLICATION NOT NULL,
[BlogName] [varchar](80) NOT NULL,
    [CreatedByID] [int] NOT NULL,  -- FK to ContactTable
    [ModifiedByID] [int] NOT NULL  -- FK to ContactTable
)

CREATE TABLE [Post](
[PostID] [int] IDENTITY(1,1) NOT FOR REPLICATION NOT NULL,
    [BlogID] [int] NOT NULL, -- FK to BlogTable
[Entry] [varchar](8000) NOT NULL,
    [CreatedByID] [int] NOT NULL,  -- FK to ContactTable
    [ModifiedByID] [int] NOT NULL  -- FK to ContactTable
) 
```

我现在想使用视图来加载“常见”查找/计算信息。每次我们在网站上显示帖子时，我们都想知道创建帖子的人和最后修改帖子的人的姓名。这是两个存储在与 post 表不同的表中的字段。我可以轻松地使用以下语法（假设应用了延迟/急切加载，并且 CreatedBy 是基于 CreatedByID 的 Contact 类型的属性）： currentPost.CreatedBy.Name;

这种方法的问题在于 Db 调用的数量以及为联系人检索到的大量记录，但在这种情况下我们只使用 Name 99%。我意识到上面的数据库模式很小，但这只是一个简化的例子，真正的联系人表有大约 50 个字段。

为了管理过去的这种情况（在使用 EF 之前），我通常会为我将使用的表构建“详细”视图。“详细”视图包含常见的查找/计算字段，因此只需 1 次调用数据库即可有效地获取我需要的所有信息（注意：我们还使用 SQL 视图上的索引来提高读取效率）这里是我将常用的视图列表（因为它们将包含相关表中的“查找”字段）：

```
ALTER VIEW [icoprod].[BlogDetail]
AS
SELECT  B.[BlogID], 
    B.[BlogName], 
    B.[BlogDescription],
    B.[CreatedByID], 
    B.[ModifiedByID],
    CREATEDBY.[ContactName] AS CreatedByName, 
    MODIFIEDBY.[ContactName] AS ModifiedByName,
    (SELECT COUNT(*) FROM Post P WHERE P.BlogID = B.BlogID) AS PostCount
FROM    Blog AS B 
JOIN Contact AS CREATEDBY ON B.CreatedByID = CREATEDBY.ContactID 
JOIN Contact AS MODIFIEDBY ON B.ModifiedByID = MODIFIEDBY.ContactID

ALTER VIEW [icoprod].[PostDetail]
AS
SELECT  P.[PostID], 
    P.[BlogID],
    P.[Entry], 
    P.[CreatedByID], 
    P.[ModifiedByID],
    CREATEDBY.[ContactName] AS CreatedByName, 
    MODIFIEDBY.[ContactName] AS ModifiedByName,
    B.Name AS BlogName
FROM    Post AS P
JOIN Contact AS CREATEDBY ON P.CreatedByID = CREATEDBY.ContactID 
JOIN Contact AS MODIFIEDBY ON P.ModifiedByID = MODIFIEDBY.ContactID
JOIN Blog AS B ON B.BlogID = P.BlogID 
```

这是我的“POCO”对象的概述：

```
public class Blog
{
    public int ID { get; set; }
    public string Name { get; set; }

    public int CreatedByID { get; set; }
    public DateTime ModifiedByID { get; set; }
}

public class Post
{
    public int ID { get; set; }
    public string Name { get; set; }

    public int CreatedByID { get; set; }
    public DateTime ModifiedByID { get; set; }
}

public class Contact
{
    public int ID { get; set; }
    public string Name { get; set; }

    public string Email { get; set; }
    public string Title { get; set; }
    public string Address { get; set; }
    public string City { get; set; }
    public string MobilePhone { get; set; }
}

public class BlogDetails : Blog
{
    public string CreatedByName { get; set; }
    public string ModifiedByName { get; set; }
    public int PostsCount { get; set; }
}

public class PostDetails : Post
{
    public string CreatedByName { get; set; }
    public string ModifiedByName { get; set; }
    public string BlogName { get; set; }
} 
```

我喜欢这种方法的原因是它允许我根据表或视图从数据库中检索信息，如果我加载视图，视图包含所有“表”信息，这些信息允许我从视图加载但保存到一张桌子。IMO，这给了我两全其美。

我过去使用过这种方法，但通常，我只是使用数据行或存储过程中的信息从数据库加载信息，甚至在从数据库加载后使用亚音速活动记录模式和映射字段。我真的希望我可以在 EF 中做一些事情，让我在不创建另一层抽象的情况下加载这些对象。

这是我尝试用于配置的内容（使用 Fluent API 和代码优先 EF）：

```
public class PostConfiguration : EntityTypeConfiguration<Post>
{
    public PostConfiguration()
        : base()
    {
        HasKey(obj => obj.ID);

        Property(obj => obj.ID).
            HasColumnName("PostID").
            HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity).
            IsRequired();

        Map(m =>
            {
                m.ToTable("Post");
            });
    }
}

public class BlogConfiguration : EntityTypeConfiguration<Blog>
{
    public BlogConfiguration()
        : base()
    {
        HasKey(obj => obj.ID);

        Property(obj => obj.ID).
            HasColumnName("BlogID").
            HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity).
            IsRequired();

        Map(m =>
            {
                m.ToTable("Blog");
            });
    }
}

public class ContactConfiguration : EntityTypeConfiguration<Contact>
{
    public ContactConfiguration()
        : base()
    {
        HasKey(obj => obj.ID);

        Property(obj => obj.ID).
            HasColumnName("ContactID").
            HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity).
            IsRequired();

        Map(m =>
            {
                m.ToTable("Contact");
            });
    }
}

public class PostDetailsConfiguration : EntityTypeConfiguration<PostDetails>
{

    public PostDetailsConfiguration()
        : base()
    {

        Map(m =>
            {
                m.MapInheritedProperties();
                m.ToTable("icoprod.PostDetails");
            });

    }

}

public class BlogDetailsConfiguration : EntityTypeConfiguration<BlogDetails>
{

    public BlogDetailsConfiguration()
        : base()
    {

        Map(m =>
            {
                m.MapInheritedProperties();  
                m.ToTable("icoprod.BlogDetails");
            });

    }

} 
```

此时，我尝试使用包含表中所有信息和“扩展”信息的视图，当我尝试这个时，我得到了可怕的 3032 错误（[错误示例here](http://blog.abodit.com/2010/04/error-3032-problem-in-mapping-fragments-mapped-to-the-same-rows-in-table/)）。然后我试图让视图只包含表的主键和“扩展”属性（例如 [Entry] 不在 PostDetails 视图中）。当我尝试这个时，我收到以下错误：

```
All objects in the EntitySet 'DBContext.Post' must have unique primary keys. However, an instance of type 'PostDetails' and an instance of type 'Post' both have the same primary key value, 'EntitySet=Post;ID=1'. 
```

所以我玩了一点MapInheritedProperties，但没有运气。我继续收到类似的错误。

有人对如何“扩展”基/表对象并从视图加载信息有任何建议吗？同样，我相信这样做会带来很大的性能提升。我在这个问题开头引用的文章有 2 个潜在的解决方案，但是 1 个需要太多的 DB 命中（只是为了获得一些常见的查找信息），另一个需要额外的抽象层（我真的很想直接去我的 POCO 来自数据库，没有写任何映射）。

最后，**感谢**所有回答此类问题的人。我为多年来为响应做出贡献的每个人鼓掌。我认为我们太多的开发人员认为这些信息是理所当然的！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T08:46:38.470

从视图加载记录并将其保存到表中不适用于代码映射 - 博客实体将始终从表中加载并保存到表中，BlogDetail 实体将始终从视图中加载并保存到视图 - 因此您必须具有可更新的视图，或者的触发器来支持这种情况。如果您使用 EDMX，您还可以映射为插入、更新和删除执行的自定义 SQL / 存储过程以强制保存到表，但此功能在代码映射中不可用。无论如何，这不是你最大的问题。

您可以使用您的视图，并且可以像以前一样将其映射到类，但不能映射继承。原因在于继承的工作方式。继承表示实体要么是父级，要么是子级（可以充当父级）。永远不会有既可以是父母（我的意思是只有父母）也可以是孩子的数据库记录。这在 .NET 中甚至是不可能的，因为要支持这种情况，您需要两个实例——一个父类型实例和一个子类型实例。这两个实例不等价，因为纯父级不能强制转换为子级（它不是子级）。最大的问题来了。映射继承后，键在整个继承层次结构中必须是唯一的。因此，您永远不能有两个具有相同密钥的实例（一个用于父级，一个用于子级）。

作为一种解决方法，不要`BlogDetail`从映射实体 ( `Blog`) 派生。要么使用第三个未映射的类作为两者的父类，要么使用接口。也不要`MapInheritedProperties`用来使你的`BlogDetail`完全无关`Blog`。

另一种解决方法是根本不映射 BlogDetail。在这种情况下，您可以按原样使用您的代码，而不是使用视图，而是使用投影创建简单的可重用查询：

```
var blogDetails = from b in context.Blogs
                  where ... 
                  select new BlogDetail
                      {
                          Name = b.Name,
                          CreatedByID = b.CreatedByID,
                          ...
                          CreatedByName = b.CreatedBy.Name // You need navigation property
                          ...   
                      }; 
```

在这两种情况下，如果您需要保存`Blog`，您必须创建新实例并从`BlogDetail`. 之后将其附加到上下文，将其设置为修改状态并保存更改。

# ios - 在 gcc 内联汇编中使用标签会导致奇怪的错误访问错误

> ID：10097734
> 
> 赞同：1
> 
> 时间：2012-04-10T23:10:11.063
> 
> 标签：ios, loops, assembly, arm

一旦我尝试在内联汇编代码中使用标签，由于无法理解的`EAX_BAD_ACCESS`错误，应用程序会在一致的 asm 语句之后立即崩溃。

例如考虑以下代码：

```
asm volatile (
    "myloop:    \n"
    :
    :
    :
); 
```

为什么导致这个片段总是崩溃？我将 Xcode 4.3.1 与 gcc 4.2 一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T09:20:31.583

问题在于苹果工具链中的链接器。我也遇到过这个问题。链接器从生成的程序集中获取任何标签，并假定它是一个函数开始，并从标签开始重新定位节。这会导致一些代码在没有函数 Epilog 的情况下被截断，并使 PC 成为孤立的并漂移到下一个地址处的任何部分/函数/例程。链接器以两种方式理解本地标签（正如我从反向工程中理解的那样。） 1\. 在标签名称的开头使用大写的“L”。这就是编译器标记自己的本地标签（循环等）的方式。2\. 使用数字标签，例如“0：”等，并使用方向分支，如“b 0f”用于向前跳转，“b 0b”用于向后跳转。因此，您的问题的解决方案： asm volatile ("Lmyloop: \n" : : : );

或 asm volatile ("0: \n"
: : : );

# c# - Visual Studios WCF 共享库类 DataContractAttribute

> ID：10097737
> 
> 赞同：-1
> 
> 时间：2012-04-10T23:10:14.253
> 
> 标签：c#, wcf, visual-studio

我有一个 Visual Studios C# 类库（A5Lib）和一个 WCF 服务项目（A5Services）。A5Services 项目引用 A5Lib 并且 Web 服务函数使用在 A5Lib 中创建的类（作为参数/返回对象）。

我的 ASP Web 项目也将使用 A5Lib 中的类，所以我不想将这些对象移动到 Web 服务中。

问题是当我尝试运行 A5Services 时，出现以下错误：

> 错误：无法从[http://localhost:16344/UserServices.svc](http://localhost:16344/UserServices.svc)获取元数据如果这是您有权访问的 Windows (R) Communication Foundation 服务，请检查您是否已在指定地址启用元数据发布。有关启用元数据发布的帮助，请参阅位于[http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata](http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata) Exchange Error URI: [http://localhost:16344/UserServices.svc](http://localhost:16344/UserServices.svc)的 MSDN 文档 元数据包含无法解析的引用：“http://localhost:16344/UserServices.svc”。内容类型应用程序/soap+xml；[服务http://localhost:16344/UserServices.svc](http://localhost:16344/UserServices.svc)不支持 charset=utf-8\. 客户端和服务绑定可能不匹配。远程服务器返回错误：(415) Unsupported Media Type.HTTP GET Error URI: [http://localhost:16344/UserServices.svc](http://localhost:16344/UserServices.svc) 下载“http://localhost:16344/UserServices.svc”时出错。请求失败并显示错误消息：--#content{ FONT-SIZE: 0.7em; 垫底：2em；MARGIN-LEFT: 30px}BODY{MARGIN-TOP: 0px; 左边距：0px；颜色：#000000；字体家族：Verdana；背景颜色：白色}P{边距顶部：0px；边距底部：12px；颜色：#000000；FONT-FAMILY: Verdana}PRE{BORDER-RIGHT: #f0f0e0 1px solid; 填充右：5px；边框顶部：#f0f0e0 1px 实心；边距顶部：-5px；填充左：5px；字体大小：1.2em；填充底部：5px；左边界：#f0f0e0 1px 实心；填充顶部：5px；边框底部：#f0f0e0 1px 实心；FONT-FAMILY：Courier New；背景颜色：#e5e5cc}.heading1{MARGIN-TOP：0px；填充左：15px；字重：正常；字体大小：26px；边距底部：0px；填充底部：3px；左边距：-30px；宽度：100%；颜色：#ffffff；填充顶部：10px；字体家族：Tahoma；背景颜色：#003366}.intro{MARGIN-LEFT：-15px}ServiceService
> 
> 服务遇到错误。
> 
> 一个 ExceptionDetail，可能由 IncludeExceptionDetailInFaults=true 创建，其值为：System.InvalidOperationException：在调用 WSDL 导出扩展时引发异常：System.ServiceModel.Description.DataContractSerializerOperationBehavior 合同：[http ://tempuri.org/:IUserServices](http://tempuri.org/:IUserServices)----> System.Runtime.Serialization.InvalidDataContractException：无法序列化类型“A5Lib.Appliance”。考虑使用 DataContractAttribute 属性对其进行标记，并使用 DataMemberAttribute 属性标记您想要序列化的所有成员。如果该类型是一个集合，请考虑使用 CollectionDataContractAttribute 对其进行标记。有关其他支持的类型，请参阅 Microsoft .NET Framework 文档。在 System.Runtime.Serialization.DataContract.DataContractCriticalHelper.ThrowInvalidDataContractException（字符串消息，类型类型）在 System.Runtime.Serialization.DataContract.DataContractCriticalHelper.CreateDataContract（Int32 id，RuntimeTypeHandle typeHandle，类型类型）在 System.Runtime.Serialization.DataContract。 DataContractCriticalHelper.GetDataContractSkipValidation(Int32 id,

这是我从中得出的结论：

> 无法序列化类型“A5Lib.Appliance”。考虑使用 DataContractAttribute 属性对其进行标记，并使用 DataMemberAttribute 属性标记您想要序列化的所有成员。如果该类型是一个集合，请考虑使用 CollectionDataContractAttribute 对其进行标记。

Visual Studios 不允许我用这些属性（即使使用 System.Runtime.Serialization）在 A5Lib（编译错误）中标记这些类/数据成员。有什么理由吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:50:29.770

我将 [Serializable] 添加到所有类中，它神奇地工作............

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-02T23:52:53.737

我必须明确添加 System.Runtime.Serialization 汇编参考。不知道为什么因为你说 VS 在你输入 using 语句时似乎解决了它？

# php - 这是什么 PHP 语法： ($variation_id>0) ？$variation_id : $item_id;

> ID：10097740
> 
> 赞同：2
> 
> 时间：2012-04-10T23:10:35.893
> 
> 标签：php, syntax

是否有人能够解释以下语句的含义，以及它所指的 php 类型，以便我可以做进一步的研究：

`$foo = ($variation_id>0) ? $variation_id : $item_id;`

我已经尝试过搜索，但我真的不知道我在搜索什么。

我要找出的是以下语法的名称和含义 `?`/`:`只是`($variation_id>0)`if 语句的简写？

- 我只是偶然发现了条件变量，尽管仍然会感谢一个很好的简单解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T23:16:02.717

该结构称为三元结构，简称为 If ... Else

你的片段：

```
$foo = ($variation_id>0) ? $variation_id : $item_id; 
```

转换为

```
if($variation_id>0) {
   $foo = $variation_id;
} else {
   $foo = $item_id;
} 
```

基本上，语法将归结为这样

```
$variable = (<CONDITION>) ? <TRUE EXPRESSION> : <FALSE EXPRESSION>; 
```

您也可以在一行中组合多个三元结构，但是如果您使用 normal if 会更好，如果这太复杂了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:13:20.963

那是一个三元条件。如果'？'之前左边的条件 是真的，它执行'？'之后的语句 和冒号之前。如果不是，则执行后面的语句。

在英语中，这表示“如果变体 ID 大于零，则使用变体 ID，否则使用项目 ID”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:14:07.513

```
$foo = ($variation_id>0) ? $variation_id : $item_id; 
```

方法

```
if($variation_id>0) 
{
    $foo =$variation_id // if true
}
else
{
    $foo =$item_id; // if false
} 
```

让我们刹车吧

```
$foo=($variation_id>0) ? // This is condition 
$variation_id : // This value will be populated by variable '$foo' if condition is true
$item_id;  // This value will be populated by variable '$foo' if condition is false 
```

被称为三元语句/操作，快捷方式`if else`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T23:14:57.797

这只是一个快捷方式，如下所示：

假设你有一个功能。

最后你想返回一个值，但如果值为 0 则例外。

所以你会这样做：

```
return ($value != 0) ? this_will_be_returned_if_true : this_will_be_returned_if_false; 
```

你也可以在变量分配中做到这一点。

图案：

```
(Bool statement) ? true : false; 
```

# objective-c - Objective-C 字符串函数：包含字符串

> ID：10097741
> 
> 赞同：4
> 
> 时间：2012-04-10T23:10:44.707
> 
> 标签：objective-c, cocoa, nsstring, substring

如何检查 NSString 是否包含另一个子字符串，此时它将返回一个布尔值。

这就是我的想法：

```
If myString.contains("string") then
{
   //Stuff Happens
} 
```

但是，从我所做的研究来看，Obj-C 似乎没有这方面的功能。这篇[Wikipedia 文章](http://en.wikipedia.org/wiki/Comparison_of_programming_languages_%28string_functions%29#Contains)提供了许多字符串函数、它们的区别以及所有不同语言的内容，但我没有看到任何包含函数的 Obj-C 支持。

有谁知道上面曾经有一个简单易用的函数（类似于 C# 和 VB.NET 函数）？

“查找”功能会起作用吗？如果是这样，怎么做？

如果 Obj-C 不支持此功能，是否有我可以使用的解决方法？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-10T23:15:15.093

```
if ([myString rangeOfString:@"string"].location != NSNotFound)
{
    // Stuff happens
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-10T23:18:04.987

```
NSString *someString = @"Time for an egg hunt";

if ( [someString rangeOfString:@"egg" options:NSCaseInsensitiveSearch].location != NSNotFound ) {
  NSLog( @"Found it!" );
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-10T23:24:06.950

如果你想成为`case insensitive`.

```
NSRange range = [string rangeOfString:@"string" options:NSCaseInsensitiveSearch];
if (range.location != NSNotFound)
{
    return range.location;
}
else
{
    return nil;
} 
```

[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-10T23:18:43.407

创建一个**NSString 类别**，并将其放入...

**代码 ：**

```
- (BOOL)contains:(NSString *)str
{
    NSRange aRange = [self rangeOfString:str];

    return (aRange.location!=NSNotFound);
} 
```

**用法 ：**

```
NSString* testStr = @"This is my string";

if ([testStr contains:@"is"])
{
     // do something
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-10T23:13:15.047

```
if([string rangeOfString:substring].length > 0)
    ... 
```

# macos - 绑定一个 NSViewController 的代表对象

> ID：10097745
> 
> 赞同：2
> 
> 时间：2012-04-10T23:11:38.873
> 
> 标签：macos, cocoa, binding, nsviewcontroller

是否可以将 a 的`representedObject`属性绑定到 a`NSViewController`的`NSArrayController`属性`selection`（即 a `NSManagedObject`）？

```
[self.ressourcesViewController bind:@"representedObject" toObject:self.ressourcesController withKeyPath:@"selection" options:nil]; 
```

由于某种原因，这总是给我没有选择占位符！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T15:02:41.270

这可以通过使用 keypath 来实现`selectedObjects.@lastObject`！

虽然我不知道这是多么符合标准，因为绑定旨在将视图对象同步到控制器对象。我所做的是同步 2 个控制器对象。另一方面，使用绑定只是节省了一些代码，需要通过 KVO 和 KVC 手动实现它。

# objective-c - 简单的检测算法

> ID：10097748
> 
> 赞同：0
> 
> 时间：2012-04-10T23:11:55.407
> 
> 标签：objective-c, c, algorithm

我正在开发一个简单的多人游戏，它从服务器接收随机 4x4 矩阵并从中提取形状

例如：

```
XXOO
XXOX
XOOX
XXXX

OXOO
XXOO
XOOO
OXXX 
```

所以在第一个矩阵中，我要解析的形状是这样的：

```
 oo
 o
oo 
```

第二个：

```
 oo
  oo
 ooo 
```

我知道必须有一个算法来解决这个问题，因为我在一些益智游戏中看到了这种行为，但我不知道如何去检测它们，甚至不知道从哪里开始

所以我的问题是：我如何检测矩阵中的形状以及如何区分多种颜色？（又名..它不仅仅出现在 x 和 o.. 它最多出现 4 个）

注意：形状必须至少为 4 块

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:17:26.990

目前尚不完全清楚您想要做什么，但似乎您想要提取某种形状（基于第二个示例，`O`不包括左上角）。我会考虑遍历数组，并为每个单元格检查相邻`O`的 s。折扣您可能计算的重复项（可能只查看您正在检查的单元格下方和右侧的邻居）。然后，如果它满足您想要的“形状”的任何标准。也许如果您提供更多示例或更好的描述，我们可以更准确。或者自己试一试，然后在卡住的地方张贴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T09:12:19.973

也许你可以试试这个：

```
1\. Assign integer values to each position in the matrix, like this, [1,2,3,4
                                                                     5,6,7,8 
                                                                     9,10,11,12
                                                                     13,14,15,16].
2.Read the position of zeroes. (I guess, shapes correpond to '0' s located either horizontally  or  vertically aligned). Store them in an array. So, for first case your array will read [3,4,7,11,10]

 2\. Then Start 'drawing' the shape.
       1\. First value 3\. so shape= 0.
       2\. Next value  4\. Check if it is consecutive to any other value in the array. that value is 3\. so the shape = 00
        3\. Next val= 7\. Is it consecutive ? no. Is it 4 more than any other value? yes, 3\. So it goes below 3\. shape= 00 
                        0
       4\. Next 11, similar to step3, it goes below 7\. shape= 00
                                                             0
                                                             0
       5\. Next 10, it is one less than 11, so it is placed before 11\. shape= 00
                                                                             0
                                                                            00. 
```

你可以做一些优化，比如连续，只检查上一个。数组中的 val。对于垂直，仅检查四个 prev 值。

另外，不要忘记边界值的特殊条件，例如 4 和 5。我不知道它们会形成形状。

# c++ - 数组是 C++ 中的 const 指针吗？

> ID：10097752
> 
> 赞同：0
> 
> 时间：2012-04-10T23:12:35.573
> 
> 标签：c++, pointers

C++ 数组确实是 C++ 中的 const 指针吗？

[http://www.cplusplus.com/forum/articles/10/#msg1381](http://www.cplusplus.com/forum/articles/10/#msg1381)

那么`x`，`&x`如果它们是指针，为什么它们是相同的呢？

```
#include<iostream>
using namespace std;

int main() {
    int x[5];
    int *y = new int[5];

    cout << "&x : " << &x << endl;
    cout << "x : " <<  x << endl;
    cout << endl;
    cout << "&y : " << &y << endl;
    cout << "y : " <<  y << endl;
    return 0; 
} 
```

输出：

```
&x:  0xbfec4ccc
x :  0xbfec4ccc

&y:  0xbfec4ce0
y :  0x8961008 
```

链接到上述代码的ideone：http: [//ideone.com/3JRZd](http://ideone.com/3JRZd)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T23:16:03.353

格雷厄姆错了，他不知道他在说什么。数组和指针是两个不同的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T23:16:45.343

不，数组不是 C++ 中的 const 指针。确实，如果一个文件包含

```
extern int* const a; 
```

另一个包含

```
int a[10]; 
```

在同一范围内，合并两个文件会导致奇怪的错误。

但是，在大多数情况下，数组会*衰减为指针。*更准确地说，如果在右值上下文中使用数组，它会隐式转换为指向其第一个元素的指针。这就是第二个链接示例中 x 发生的情况：由于数组的第一个元素当然与数组位于相同的地址，因此两者`x`和`&x`都打印为相同的地址。但是请注意，它们*不是*同一个指针，因为它们属于不同的类型：`x`在此上下文中衰减为`int*`，即指向 的指针`int`，而`&x`类型为`int(*)[5]`，即指向 5 `int`s 数组的指针。

另一种你可以看到两者不同的情况是一个函数*引用*一个数组，比如

```
void f(int (&arr)[5]); 
```

您可以传递`x`给这个函数（因为它是类型`int[5]`），但既不传递也不传递给您在编写时获得`&x`的指针；`y``int* y = x`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T23:19:04.217

编码

```
int array[3]; 
```

不一样**_**

```
int const *array=new int[3]; 
```

只是出于简单但不是单一的原因：您需要`delete [] array`在第二种情况下调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T14:34:11.983

愚蠢的比喻：

考虑地址*1, Main Street*。
尽管您可以将 Main Street 的开头称为“1, Main Street”，但它与街道“Main Street”不同。事实上，如果你想在街的那一头见到某人，你可以给他们一张纸条，上面写着“1, Main Street”的地址，作为在哪里等你的指针，这比把所有的人都装好要容易得多在一张纸上（或者给他们一张上面有“X”的地图，如果我们允许自己引入一个抽象层的话）。

*1、Main Street*当然不仅是Main Street的起点地址，也是Main Street*上第*一栋房子的地址——这就是你打印出来的样子`x`——但是房子和地址*都不*是街道。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-10T23:17:40.803

是的，他们是。

因为指针始终是地址，所以 &value 对于任何类型的指针都应该是相同的。

你也可以做这样的事情

```
int number[] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
int *pNumbers = number; 
```

[编辑] 也许不是根据其他答案......但我一直认为这是真的 [编辑] 也见[http://www.cplusplus.com/doc/tutorial/pointers/](http://www.cplusplus.com/doc/tutorial/pointers/)在“指针和数组”

# php - PHP 或 HTML 表单验证

> ID：10097755
> 
> 赞同：-2
> 
> 时间：2012-04-10T23:12:42.427
> 
> 标签：php, html, validation

我想用 HTML 或 PHP 验证 HTML 表单。通过验证，我的意思是确保在 2 个文本框中的每一个中输入至少 1 个文本字符。并且要么只输入字母数字字符，要么确保任何标点符号不会以“/”结尾。

目前我的表单由 2 个 php 页面组成（复制如下），然后发布到一个 txt 文件。

我要么在获得一些（非常基本的）关于如何操作的说明，要么在下面的脚本中提出建议。

```
//HTML
<form style="" method="post" action="addtopic2.php">
Topic:<input name="topic" id="topicbox" maxlength="100" type="text"><br>
Outline: <textarea input wrap="nowrap" rows="10" cols="120" 
name="outline"></textarea>    
<br><input name="submit" value="Submit" type="submit">
</form>
//HTML

<?php
$t = "Topic:";
$o = "Outline:";

$topic = $_POST['topic'];
$outline = $_POST['outline'];

$data = "$t $topic | $o $outline |\n";

$fh = fopen("users.txt", "a");
fwrite($fh, $data); 
fclose($fh); 
?> 
```

//尝试使用以下内容，但在插入任何一个页面时似乎都不起作用。

```
<?php
if($_POST['Submit'] == "submit")
{
  $errorMessage = "";
  if(empty($_POST['topic']))
  {
$errorMessage .= "<li>A topic needs to be entered</li>";
  }
  if(empty($_POST['outline']))
  {
    $errorMessage .= "<li>An outline needs to be entered</li>";
  }
  $vartopic = $_POST['formtopic'];
  $varoutline = $_POST['formoutline'];
  if(!empty($errorMessage))
  {
    echo("<p>There was an error with your form:</p>\n");
        echo("<ul>" . $errorMessage . "</ul>\n");
  }
}
?>

<?php
if (isset($_POST['topic']) && isset($_POST['outline'])) {
     $topic = trim($_POST['topic']);
    $outline = trim($_POST['outline']);
}
else {
  echo '<p>Fill the form</p>';
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:22:50.797

Try

```
$file = "users.txt";
$errorMessage = array ();

if ($_POST ['Submit'] == "submit") {
    if (empty ( $_POST ['topic'] )) {
        $errorMessage [] = "A topic needs to be entered<";
    }
    if (empty ( $_POST ['outline'] )) {
        $errorMessage [] = "An outline needs to be entered";
    }

    if (count ( $errorMessage ) == 0) {
        $data = $_POST ['topic'] . "|" . $_POST ['outline'] . "\n";
        $fh = fopen ( $file, "a" );
        fwrite ( $fh, $data );
        fclose ( $fh );
    } else {
        print ("<p>There was an error with your form:</p>\n") ;
        print ("<ul>") ;
        foreach ( $errorMessage as $error ) {
            print "<li>" . $error . "<li>";
        }
        print ("</ul>") ;
    }
}

// To Read Your File

$content = file ( $file );
print ("<p>File Details</p>\n") ;
foreach ( $content as $info ) {
    list ( $topic, $outline ) = explode ( "|", $info );
    print ("<ul>") ;
    print "<li>Topic: " . $topic . "<li>";
    print "<li>Outline:" . $outline . "<li>";
    print ("</ul>") ;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-07T04:48:27.507

试试这个（单个文件）解决方案：

```
<form style="" method="post">

    Topic:<input name="topic" id="topicbox" maxlength="100" type="text" value='<?= $_REQUEST['topic'] ?>><br>
    Outline: <textarea input wrap="nowrap" rows="10" cols="120" name="outline"><?= $_REQUEST['outline'] ?></textarea>
    <p/>
    <input name="submit" value="Submit" type="submit">

</form>

<?php

    if ($_REQUEST['submit'] !== 'submit')
    {
        exit;
    }

    if ($_REQUEST['topic'] == '')
    {
        echo "<p>Missing Topic.</p>\n";
        exit;
    }

    if ($_REQUEST['outline'] == '')
    {
        echo "<p>Missing Outline.</p>\n";
        exit;
    }

    $t = "Topic:";
    $o = "Outline:";

    $topic = $_POST['topic'];
    $outline = $_POST['outline'];

    $data = "$t $topic | $o $outline |\n";

    $fh = fopen("users.txt", "a");
    fwrite($fh, $data); 
    fclose($fh); 
?> 
```

# python - 使用 TEA 的伪随机数生成器

> ID：10097757
> 
> 赞同：0
> 
> 时间：2012-04-10T23:12:50.680
> 
> 标签：python, random, des

嗨，我正在尝试使用加密算法作为引擎来获得统一的随机数生成器。可以使用 DES，但在这种情况下，我根据[http://myweb.tiscali.co.uk/jgrimbleby/random.htm](http://myweb.tiscali.co.uk/jgrimbleby/random.htm)将代码从 c++ 移植到 python 使用了 TEA。我遇到的问题是我需要范围在 0 和 1 之间。目前我得到的值是非常大的 10 ^ 76 范围。任何想法是否是我的转录错误，或者我是否可以添加任何添加来获得所需的范围。

```
class psrTEA:

def __init__(self):

    self.m = 4294967296.0
    self.d = 0X09E3779B9L
    self.k0 = 0X0C7D7A8B4L
    self.k1 = 0X09ABFB3B6L
    self.k2 = 0X073DC1683L
    self.k3 = 0X017B7BE73L

    self.y = 123456789L
    self.z = 987654321L

def rnd(self):
    s = 0
    self.y = long(time.time())
    self.z = long(time.clock())

    for n in range(31):
        s += self.d
        self.y += (self.z << 4) + self.k0 ^ self.z + s ^ (self.z >> 5) + self.k1
        self.z += (self.y << 4) + self.k2 ^ self.y + s ^ (self.y >> 5) + self.k3

    return ((self.z + self.y / self.m)/ self.m) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:32:00.943

计算你的最高值（或计算大量值，取最大值，也许根据 2 的幂或其他东西猜测一下）。

然后将每个大结果除以最高值的浮点版本。那应该将事情缩放到0..1。

# java - Java JRE 版本不兼容

> ID：10097758
> 
> 赞同：2
> 
> 时间：2012-04-10T23:12:59.113
> 
> 标签：java, applet, cross-browser

我对不同 java 版本之间的兼容性有疑问。

在我的电脑上，我有 java 版本“1.7.0_02”。但是当我上传 .class 并将其嵌入网页时，它不起作用

我得到错误：

“不支持的 major.minor 版本 51.0”

控制台顶部的标题显示：“Java Plug-in 1.6.0_31 Using JRE version 1.6.0_31-b05 Java HotSpot(TM) Client VM”

我想问是什么导致了这个问题。这真的是我的java版本吗？我的意思是，我使用编译小程序的计算机访问了该站点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T00:42:06.823

您不能将编译为 Java 1.7 兼容类文件的类与早期的虚拟机一起使用，并且您看到的“Java 插件”错误表明这正是发生的情况。

两种选择：

1.  如果您不使用仅 Java 1.7 的功能，则可以使用选项 -target 1.6 编译代码以与 1.6 JVM 兼容（请参阅[此处](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/javac.html#crosscomp-options)的文档）
2.  如果可能，将您的浏览器使用的 Java 插件升级到 1.7（例如，我认为您不能在 OS X 上执行此操作）。您没有注意到您使用的是什么操作系统和浏览器，所以我不确定升级路径是什么，如果有的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T10:30:03.183

感谢您的回答，我知道出了什么问题。

我一开始在我的机器上安装了 1.7 和 1.6，这真的让我很困惑。问题是，1.7 是 64 位，而 1.6 是 32 位。

我的浏览器是 chrome 32 位的。

我刚刚安装了 1.7 32 位，没问题

# java - Java - 如何为从数组生成的每个图块赋予唯一的“ID”

> ID：10097759
> 
> 赞同：0
> 
> 时间：2012-04-10T23:13:08.653
> 
> 标签：java, arrays, random, tile

我正在尝试进行鼠标选择，并且我单击的图块会更改为对面的图块，即。将草变为泥土，但每个草砖都有相同的“ID”，因此屏幕上的每个草砖都会变为泥土。我怎样才能以更好的方式生成这些图块？我希望它是随机生成的，而不是从像 000001100 这样的数组映射中绘制的。

***块类***

```
public class Block {

public enum BlockType {
    Dirt,
    Grass,
    Selection
}

BlockType Type;
Vector2f Position;
Image texture;
boolean breakable;

public Block(BlockType Type, Vector2f Position, Image texture, boolean breakable) {
    this.Type = Type;
    this.Position = Position;
    this.texture = texture;
    this.breakable = breakable;
}

    public BlockType getType() { 
        return Type; 
    }
    public void setType(BlockType value) {
        Type = value;
    }

    public Vector2f getPosition() { 
        return Position; 
    }
    public void setPosition(Vector2f value) { 
        Position = value; 
    }

    public Image gettexture() { 
        return texture; 
    }
    public void settexture(Image value) { 
        texture = value; 
    }

    public boolean getbreakable() { 
        return breakable; 
    }
    public void setbreakable(boolean value) { 
        breakable = value; 
    }
} 
```

***瓦片生成类***

```
public class TileGen {

Block block;
public Block[] tiles = new Block[2];
public int width, height;
public int[][] index;
boolean selected;
int mouseX, mouseY;
int tileX, tileY;

Image dirt, grass, selection;
SpriteSheet tileSheet;

public void init() throws SlickException {
    tileSheet = new SpriteSheet("assets/tiles/tileSheet.png", 64, 64);

    grass = tileSheet.getSprite(0,0);
    dirt = tileSheet.getSprite(1,0);
    selection = tileSheet.getSprite(2,0);

    tiles[0] = new Block(BlockType.Grass, new Vector2f(tileX,tileY), grass, true);
    tiles[1] = new Block(BlockType.Dirt, new Vector2f(tileX,tileY), dirt, true);

    width = 50;
    height = 50;

    index = new int[width][height];

    Random rand = new Random();
    for (int x = 0; x < width; x++)
    {
        for (int y = 0; y < height; y++)
        {
            index[x][y] = rand.nextInt(2);
        }
    }
}

public void update(GameContainer gc) {
    Input input = gc.getInput();
    mouseX = input.getMouseX();
    mouseY = input.getMouseY();
    tileX = mouseX / width;
    tileY = mouseY / height;

    if(input.isMouseButtonDown(Input.MOUSE_LEFT_BUTTON)) {
        selected = true;
    }
    else{
        selected = false;
    }
    System.out.println(tiles[index[tileX][tileY]]);
}

public void render() {
    for (int x = 0; x < width; x++)
    {
        for (int y = 0; y < height; y++)
        {
            tiles[index[x][y]].texture.draw(x * 64, y *64);

            if(IsMouseInsideTile(x, y))
                selection.draw(x * 64, y * 64);
            if(selected && tiles[index[x][y]].breakable) {
                if(tiles[index[tileX][tileY]].Type == BlockType.Grass)
                    tiles[index[tileX][tileY]].texture = dirt;
            }
        }
    }
}

public boolean IsMouseInsideTile(int x, int y)
{
    return (mouseX >= x * 64 && mouseX <= (x + 1) * 64 &&
            mouseY >= y * 64 && mouseY <= (y + 1) * 64);
} 
```

我正在使用 slick2d 库。我不确定 ID 是否是正确的词，但我希望你能理解我想问的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:18:54.097

看起来您现有的结构很好，但看起来您并不了解它的作用。该`int[][] index`数组包含一个瓦片类型的网格，对应于`x`和`y`坐标。要更改特定坐标处的瓷砖类型，您只需将`index`数组设置为您想要的类型。

具体来说，在您的渲染函数中，您将拥有如下内容：

```
if(IsMouseInsideTile(x, y) && selected && tiles[index[x][y]].breakable)
    if(tiles[index[tileX][tileY]].Type == BlockType.Grass)
        tiles[index[tileX][tileY]].texture = dirt; 
```

在进一步修改之前，我会尝试弄清楚你的代码在做什么。

注意：为什么这仍然在渲染函数中？您可能应该将它放在自己的函数中，或者至少在您的`update`函数中。

# java - 未捕获的错误：在 NPObject 上调用方法时出错。关于 java & javascript

> ID：10097768
> 
> 赞同：1
> 
> 时间：2012-04-10T23:13:51.757
> 
> 标签：java, javascript, serial-port

我已经浪费了几个小时试图解决这个问题，但没有成功，所以也许有人可以帮助我:)

我正在使用[http://www.walking-productions.com/jsserial/new/JSSerial.html](http://www.walking-productions.com/jsserial/new/JSSerial.html)从串行 RF-ID 阅读器读取数据以自动填充我的文本字段。如果我制作一个按钮并调用 openport(); ，我设法使一切正常。和 startTimer();。

但是，如果我调用 openport(); 在没有用户交互的情况下，从 onload 或我的 html 的任何部分，我得到了未捕获的错误：在该函数 openport(); 中调用 NPObject 上的方法时出错。

我想这是某种安全功能或一些签名的java程序？

有谁知道如何解决这个问题？是否有某种方法可以设置任何浏览器以允许此代码启动？谢谢多里扬

# ios5 - 如何将自定义着色器与 GLKit 一起使用

> ID：10097769
> 
> 赞同：5
> 
> 时间：2012-04-10T23:13:52.550
> 
> 标签：ios5, shader, glkit

我一直在阅读使用 GLKit 和您自己的自定义着色器是多么容易。但是，到目前为止，我还没有找到任何有关如何实际操作的信息。如何将自己的着色器“插入”到现有的 GLKit 项目中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-16T12:36:06.507

好吧，你可以看看这个博客，它使用 GLKit 构建了一个基本的 OpenGL ES 2.0 应用程序。如果您想深入了解它，还有其他博客的链接：

[GLKit + OpenGL ES 2.0 + iOS5 编程博客](http://stevezissouprogramming.blogspot.ca/)

它唯一没有涵盖的是 GLKBaseEffect，但是如果你想像你说的那样构建自定义着色器，你肯定不想使用它。

GLKit 提供了 4 个基本的东西：

1.  一个数学库（矩阵、向量...）
2.  专门用于绘制 OpenGL 内容的视图/控制器组合
3.  纹理加载器类 (GLKTextureLoader)
4.  GLKBaseEffect，模仿 OpenGL 1.0 的固定管道

# c# - 阻止分发或编辑器构建中的某些代码，例如#if defined

> ID：10097771
> 
> 赞同：1
> 
> 时间：2012-04-10T23:13:59.600
> 
> 标签：c#, distribution, c-preprocessor, conditional-compilation

在我正在创建的应用程序中，我将“编辑器”直接连接到应用程序。但是，编辑器充当外部程序，在应用程序上戳。

编辑器将使用的一些访问器和修改器绝对不会在应用程序本身中使用，也不应该被使用！

由于我在一个团队中工作，我想在非编辑器构建中运行时完全“阻止”某些函数和类。

在 C++ 中，我可以这样做：

```
#if !defined(_DISTRIBUTION)
    void SetUniqueID(int inID) { mID = inID; }
#endif 
```

当上面的代码用于调试或编辑器构建时，它被称为正常。在发布版本中使用时，编译器或游戏将失败。

与此等效的 C# 是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:17:32.130

这些是[条件编译](http://msdn.microsoft.com/en-us/library/aa691099%28v=vs.71%29.aspx)指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:18:00.710

```
#if DEBUG
    Console.WriteLine("Mode=Debug"); 
#else
    Console.WriteLine("Mode=Release"); 
#endif 
```

# c++ - C++ STL 容器 ::clear ::swap

> ID：10097772
> 
> 赞同：2
> 
> 时间：2012-04-10T23:14:04.017
> 
> 标签：c++, dictionary, stl, std

“清除”大型 STL 容器的最快方法是什么？在我的应用程序中，我需要处理大尺寸`std::map`，例如 10000 个元素。

我已经测试了以下 3 种方法来清除`std::map`.

*   每次需要时创建一个新容器。
*   调用`map::clear()`方法。
*   调用`map::swap()`方法。

这似乎`::swap()`给出了最好的结果。谁能解释一下为什么会这样？可以肯定地说使用`map::swap()`方法是“清除” std::map 的正确方法吗？其他 STL 容器是否也一样，例如 , ,`set`等。`vector``list`

```
 m_timer_start = boost::posix_time::microsec_clock::local_time();

//  test_map.clear();
    test_map.swap(test_map2);
    for (int i = 0; i< 30000; i++){
        test_map.insert(std::pair<int, int>(i, i));
    }    

//  std::map<int, int> test_map_new;
//  for (int i = 0; i< 30000; i++){
//      test_map_new.insert(std::pair<int, int>(i, i));
//  }     

    m_timer_end = boost::posix_time::microsec_clock::local_time();
    std::cout << timer_diff(m_timer_start, m_timer_end).fractional_seconds() << std::endl; // microsecond 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T23:41:15.257

您没有正确测试`swap`案例。您需要销毁交换映射以始终考虑问题。尝试其中之一：

```
{ std::map<something, something_else> test_map2;
test_map.swap(test_map2);
} // test_map2 gets destroyed at the closing brace. 
```

或者

```
// temporary gets destroyed at the semi-colon
std::map<int, int>().swap(test_map); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:47:42.647

你问这个是因为你遇到了性能问题并且你已经确定你的程序花费了太多时间来清理你的地图？如果您还没有这样做，那么只需使用 map::clear() 或每次创建新的局部变量，以您的程序最自然和直接的为准。交换技巧是一种优化，除非根据经验确定需要，否则浪费时间优化没有什么意义。

如果您发现了性能问题，那么您已经有了确定哪种方法最能解决问题的工具。

# winapi - 获取进程可读内存的大小？

> ID：10097777
> 
> 赞同：0
> 
> 时间：2012-04-10T23:14:38.807
> 
> 标签：winapi, memory

如何获取进程中所有可读内存的范围？

VirtualQuery 只允许我一次查询页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:54:26.600

没有办法只获得可读页面的列表。您需要使用 VirtualQuery 遍历所有内存（从包含有效内存的最低地址开始）。您可以从 MEMORY-BASIC_INFORMATION 结构中读取 RegionSize 以了解要调用的基地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-21T01:04:03.437

这样做的唯一方法是遍历每个内存区域。

此代码将执行此操作，并输出每个区域的开始和结束地址：

```
 MEMORY_BASIC_INFORMATION meminfo;
    unsigned char* addr = 0;

    HANDLE hProc = OpenProcess(PROCESS_ALL_ACCESS, FALSE, GetCurrentProcessId());

    MEMORY_BASIC_INFORMATION mbi;

    while (VirtualQueryEx(hProc, addr, &mbi, sizeof(mbi)))
    {
        if (mbi.State == MEM_COMMIT && mbi.Protect != PAGE_NOACCESS)
        {
            std::cout << "base : 0x" << std::hex << mbi.BaseAddress << " end : 0x" << std::hex << (uintptr_t)mbi.BaseAddress + mbi.RegionSize << "\n";
        }
        addr += mbi.RegionSize;
    } 
```

# jquery - 仅在特定 div ID 内的 jQuery 函数

> ID：10097779
> 
> 赞同：1
> 
> 时间：2012-04-10T23:14:51.153
> 
> 标签：jquery, asp.net

我有以下我只想在里面运行的功能`<div id="imgWrapper">`

我已经和父母一起尝试了一些事情，但我似乎无法弄清楚这一点。

```
 <script type="text/javascript" language="javascript">
    $(document).ready(
        function () {
            $("img").each(function () {
                var src = $(this).attr("src");
                if (src.substring(0, 1) == "/")
                    $(this).attr("src", "http://serverName.com/" + src.substring(1))
            });

        }
     ); 
 </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:16:36.770

如果您在选择器中放置空格，则它是`descendant-selector`：

```
$(document).ready(
    function () {
        $("#imgWrapper img").each(function () { // <<<<<<<=======
            var src = $(this).attr("src");
            if (src.substring(0, 1) == "/")
                $(this).attr("src", "http://serverName.com/" + src.substring(1))
        });

    }
 ); 
```

`descendant-selector` [文档](http://api.jquery.com/descendant-selector/)：

> 描述：选择作为给定祖先的后代的所有元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:18:48.243

`$(img)`没有看到你的html 改变这个`$("div#imgWrapper img")`或`$("img", 'div#imgWrapper')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:18:15.237

要仅选择div`img`的后代元素，请更改此行：`imgWrapper`

```
$("img").each(function () { 
```

对此：

```
$("#imgWrapper img").each(function () { 
```

# mysql - 带压缩的mysql复制

> ID：10097780
> 
> 赞同：0
> 
> 时间：2012-04-10T23:14:53.253
> 
> 标签：mysql, compression, replication

我想设置使用带有压缩的mysql复制。

主机是一台装有 mysql 5.5 的 windows 机器，从机在 Linux (redhat) 上，装有 mysql 5.0。

复制有效。

我试图打开压缩

设置全局 slave_compressed_protocol=1;

在奴隶上

设置全局 slave_compressed_protocol=1;

在主人身上。

但是：我没有看到奴隶跟上主人的能力有任何提高。

任何想法，可能有什么问题？

提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-06T11:06:02.320

我会逐点查看正在使用的网络带宽。也许使用 Wireshark 进行监控。

然后我会查看从机上的磁盘 IO。从属 IO 不如普通 IO 快

我会在从机上安装 pt-diskstats 以了解从机上的 IO 负载。 [http://www.percona.com/doc/percona-toolkit/2.1/pt-diskstats.html](http://www.percona.com/doc/percona-toolkit/2.1/pt-diskstats.html)

你必须找到瓶颈在哪里。如果它是磁盘瓶颈，那么压缩将无济于事。

我也很紧张你有不同的版本。我一直被教导从机版本应该更新或与主机相同。换句话说，复制到旧的奴隶是不好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-05T03:29:11.167

slave_compressed_protocol=1 只会压缩通过网络传输数据的时间，这只是所有时间的一小部分，但对单线程从属执行线程没有帮助（与 Master 具有多线程相比）

# java - 序列化扩展 Java 类的 Scala 类：价值丢失？

> ID：10097792
> 
> 赞同：4
> 
> 时间：2012-04-10T23:16:22.440
> 
> 标签：java, scala, serialization

Foo.java

```
public class Foo{
  public int i = 0;
} 
```

巴尔斯卡拉

```
class Bar() extends Foo with Serializable{
  i = 1 
} 
```

通过 Josh Seureth 进行序列化[https://stackoverflow.com/a/3442574/390708](https://stackoverflow.com/a/3442574/390708)

```
import java.io._

  class Serialization{
    def write(x : AnyRef) {
    val output = new ObjectOutputStream(new FileOutputStream("test.obj"))
    output.writeObject(x)
    output.close()
  }

  def read[A] = {
    val input = new ObjectInputStream(new FileInputStream("test.obj"))
    val obj = input.readObject()
    input.close()
    obj.asInstanceOf[A]
  }
} 
```

REPL 会话，bar 在序列化之前为 1，但在序列化之后为 0。

```
scala -cp .
Welcome to Scala version 2.9.1.final (Java HotSpot(TM) 64-Bit Server VM, Java 1.7.0_03).
Type in expressions to have them evaluated.
Type :help for more information.

scala> val bar = new Bar
bar: Bar = Bar@2d2ab673

scala> bar.i
res0: Int = 1

scala> :load Serialization.scala
Loading Serialization.scala...
import java.io._
defined class Serialization

scala> val serialization = new Serialization
serial: Serialization = Serialization@41a45f89

scala> serialization.write(bar)

scala> val bars = serialization.read[Bar]
bars: Bar = Bar@5a9948fd

scala> bars.i
res3: Int = 0 
```

那么，在这种情况下，为什么 bar.i 不是 1 呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T23:57:40.073

这是意料之中的，我相信与 Scala 无关。Non-Serializable 超类不会被序列化（因为它们不可序列化！），因此它们的值将由默认构造函数初始化。

如果您想以某种方式保存超类，则需要覆盖您的 readObject 和 writeObject 以手动保存状态。或者，使用更灵活的序列化解决方案，编写 XML、JSON 等并使用反射。

# javascript - 使用`.childNodes`从javascript访问HTML DOM元素

> ID：10097797
> 
> 赞同：1
> 
> 时间：2012-04-10T23:16:54.967
> 
> 标签：javascript, dom

我想知道该`.childNodes`属性，我有下面的代码，出于某种原因，我得到了 18 个孩子，而 6 个是`HTMLInputElement`预期的，其余的是`undefined`. 这是关于什么的？有没有一种有效的方法来迭代`input`元素？

```
<html>
  <head>
    <script>
    window.onload = function(e){
        form = document.getElementById('myForm');
        alert(form.childNodes.length);
        for(i=0; i<form.childNodes.length; i++){
            alert(form[i]);
        }
    }
    </script>
  </head>
  <body>
<form id='myForm' action="haha" method="post">
Name: <input type="text" id="fnameAdd" name="name" /><br />
Phone1: <input type="text" id="phone1Add" name="phone1" /><br />
Phone2: <input type="text" id="phone2Add" name="phone2" /><br />
E-Mail: <input type="text" id="emailAdd" name="email" /><br />
Address: <input type="text" id="addressAdd" name="address" /><br />
<input type="submit" value="Save" />
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:20:12.860

文本节点，即使它们仅包含空格，也将包含在输出中，`br`元素也是如此。

如果`.children`您想要所有元素（包括`br`. 这只会给你元素节点。我认为较旧的 IE 错误地包含注释节点，但您的代码中没有，所以没有问题。

或者你可以做...

```
form.getElementsByTagName('input') 
```

...假设您只想要`input`元素。

除此之外：你忘了关闭你的`form`元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:19:00.047

childNodes 也返回文本节点；这可能是您困惑的根源。

要遍历所有子节点，但只关注 INPUT，只需检查节点的 tagName 属性。如果节点是文本节点，它不会有 tagName，如果节点有 tagName，你可以检查 tagName == "input"。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T23:24:58.830

用于[`form.elements`](https://developer.mozilla.org/en/DOM/form.elements)获取所有表单字段，或[`form.getElementsByTagName('INPUT')`](https://developer.mozilla.org/en/DOM/element.getElementsByTagName)获取`INPUT`表单内的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T23:23:50.620

form.elements 是访问表单中每个元素的快捷方式——

```
window.onload = function(e){
        var s='', form = document.getElementById('myForm'),
        L=form.elements.length;
        s=L+'\n';
        for(var i=0;i<L; i++){
            s+= (form[i].name || form[i].id)+'='+form[i].value+'\n';
        }
        alert(s);
    } 
```

# macos - 从变量向文件中插入文本

> ID：10097800
> 
> 赞同：3
> 
> 时间：2012-04-10T23:17:09.790
> 
> 标签：macos, bash, shell, unix

我有一个看起来像这样的文件：

```
ABC
DEF
GHI 
```

我有一个看起来像这样的 shell 变量：

```
var="MRD" 
```

我想要做的是让我的文件看起来像这样：

```
ABC
MRD
DEF
GHI 
```

我试图这样做：

```
sed -i -e 's/ABC/&$var/g' text.txt 
```

但它只插入 $var 而不是值。我也试过这个：

```
sed -i -e 's/ABC/&"$var"/g' text.txt 
```

但这也没有用。有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:21:45.390

看看这是否有效。

```
var="MRD"
sed 's/ABC/&\n'"${var}"'/' text.txt 
```

**编辑**

我们可以使用任何字符来代替 /。因此，如果我们希望它出现在搜索或替换表达式中，请使用 |

```
var="</stuff>"
sed 's|ABC|&\n'"${var}"'|' text.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:22:55.510

sed 可以做[的不仅仅是搜索和替换](http://man.cx/sed)——它可以附加：

```
sed "/ABC/a $var" 
```

在一些旧版本的 sed 中，你必须写

```
sed "/ABC/a\\
$var" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T23:41:58.970

```
var='<stuff>' awk '{ print $0 } NR==1 { print ENVIRON["var"]; }' \
  <<<$'ABC\nDEF\nGHI' \ 
```

产量

```
ABC
<stuff>
DEF
GHI 
```

要进行就地替换：

```
tempfile=$(mktemp "${infile}.XXXXXX")
awk ... <"$infile" >"$tempfile" \
  && mv "$tempfile" "$infile" 
```

请注意，它`var`需要在环境中——因此，如果您没有在调用 awk 的同一行上定义它，那么您应该`export`这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T23:21:29.583

单引号禁用变量插值；双引号没有。

```
sed -i -e "s/ABC/&$var/g" text.txt 
```

`$var`（请注意，当contains`/`或任何其他特殊处理的字符时，这不是一个好主意`sed`。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T23:24:14.183

在切换到双引号之前，您需要终止单引号（防止插值），或者只使用双引号开始。

也就是说，该`s`命令会更改当前行，它不会插入行；您最终会得到包含`DEFMRD`, 的单行，而不是`MRD`插入自己的行。为此，你想要类似的东西

```
sed -i -e "/ABC/a\\
$var\\
." text.txt 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-10T23:26:18.050

与`awk`：

```
awk "{print \$0}NR==1{print \"$var\"}" text.txt 
```

或者如果`var`已导出：

```
export var=MRD
awk '{print $0}NR==1{print ENVIRON["var"]}' text.txt 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-14T22:46:05.623

```
printf '2i\n%s\n.\nw\n' "$var" | ed -s text.txt 
```

# git - git rebase 导致 origin/master 和 master 分歧

> ID：10097805
> 
> 赞同：2
> 
> 时间：2012-04-10T23:17:38.010
> 
> 标签：git, push, rebase

我已经看过问题了

[git rebase 和 git push：非快进，为什么要使用？](https://stackoverflow.com/questions/559917/git-rebase-and-git-push-non-fast-forward-why-use)

和

[master 分支和 'origin/master' 已经发散了，如何' undiverge' 分支'？](https://stackoverflow.com/questions/2452226/master-branch-and-origin-master-have-diverged-how-to-undiverge-branches)

我仍然不清楚在这种特定情况下我需要做什么。我首先让 origin/master 和 master 同步。两者的提交顺序是

```
---o---A---B 
```

我现在在我的本地存储库上提交了另外两个提交，这样我就有了

```
---o---A---B---C---D 
```

现在我做了一个 rebase，因为我想重新排序提交。所以我的主人现在是：-

```
---o---A---C---D---B 
```

而我的起源/主人仍然和第一种情况一样。现在，如果我尝试执行 git push，它会拒绝推送它，因为 master 和 origin/master 已经分歧。如何将此变基推到原点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:20:53.813

你可以强制它：

```
git push -f origin master 
```

不过要小心。这实际上改变了起源的历史，所以只有在你知道它不会破坏其他开发者的任何东西的情况下才这样做，例如。

一般来说，对已经推送到远程/中央存储库的提交进行 rebase 并不是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-04T15:11:26.457

我已经经历过几次这种情况，起初我像 git 所说的那样拉，它会尝试将我过去的更改与我的新本地更改合并 - 不好。基本上，当您的本地 repo 分支与远程分支分歧时，您也必须重新设置远程分支。例如：

```
git:(branch)$ git commit -m "my fix."
git:(branch)$ git checkout master
git:(master)$ git rebase branch
git:(master)$ git rebase origin/master
git:(master)$ git push origin master 
```

巨大的成功！

# java - 进度条无限旋转

> ID：10097812
> 
> 赞同：0
> 
> 时间：2012-04-10T23:18:12.563
> 
> 标签：java, android, progress-bar, android-asynctask, progressdialog

代码：

```
button.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        // fileReader();

        new xyz().execute();

    }// button
});// button end        

private class xyz extends AsyncTask<Void, Void, Void> {

    private final ProgressDialog dialog = new ProgressDialog(CCActivity3.this);

    protected void onPreExecute() {
        this.dialog.setCancelable(true);
        this.dialog.setMessage("Please Wait...");
        this.dialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
        this.dialog.setProgress(0);
        this.dialog.setMax(100);
        this.dialog.show();
    }

    // put your code which preload with processDialog  
    private boolean running = true;

    @Override
    protected Void doInBackground(Void... params) {

        // while( running ) {
        fileReader(); //i keep getting error here
        //}

        return null;
    }

    @Override
    protected void onPostExecute(final Void unused) {
        if (this.dialog.isShowing()) {
            this.dialog.dismiss();
        }   
        super.onPostExecute(unused);
        //this.dialog.dismiss();
    }
} 
```

堆栈跟踪：

```
04-10 21:05:05.398: D/skia(30039): purging 270K from font cache [38 entries]
04-10 21:05:05.508: D/dalvikvm(30039): GC_EXPLICIT freed 1828K, 18% free 12468K/15107K, external 7017K/7937K, paused 106ms
04-10 21:06:36.318: D/skia(30039): purging 13K from font cache [2 entries]
04-10 21:06:36.418: D/dalvikvm(30039): GC_EXPLICIT freed 3271K, 39% free 9233K/15107K, external 7017K/7937K, paused 93ms
04-10 21:07:37.208: W/dalvikvm(30039): threadid=9: thread exiting with uncaught exception (group=0x40015568)
04-10 21:07:37.228: E/AndroidRuntime(30039): FATAL EXCEPTION: AsyncTask #1
04-10 21:07:37.228: E/AndroidRuntime(30039): java.lang.RuntimeException: An error occured while executing doInBackground()
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.os.AsyncTask$3.done(AsyncTask.java:200)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at java.lang.Thread.run(Thread.java:1019)
04-10 21:07:37.228: E/AndroidRuntime(30039): Caused by: android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.view.ViewRoot.checkThread(ViewRoot.java:2954)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.view.ViewRoot.invalidateChild(ViewRoot.java:644)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.view.ViewRoot.invalidateChildInParent(ViewRoot.java:670)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.view.ViewGroup.invalidateChild(ViewGroup.java:2533)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.view.View.invalidate(View.java:5288)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.widget.TextView.checkForRelayout(TextView.java:5663)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.widget.TextView.setText(TextView.java:2814)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.widget.TextView.setText(TextView.java:2682)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.widget.TextView.setText(TextView.java:2657)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at dev.android.CCActivity3.fileReader(CCActivity3.java:207)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at dev.android.CCActivity3$xyz.doInBackground(CCActivity3.java:110)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at dev.android.CCActivity3$xyz.doInBackground(CCActivity3.java:1)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
04-10 21:07:37.228: E/AndroidRuntime(30039):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
04-10 21:07:37.228: E/AndroidRuntime(30039):    ... 4 more
04-10 21:07:37.258: I/Process(30039): Sending signal. PID: 30039 SIG: 9
04-10 21:14:03.819: D/dalvikvm(30687): GC_EXTERNAL_ALLOC freed 109K, 64% free 487K/1347K, external 0K/0K, paused 4ms
04-10 21:14:03.988: D/dalvikvm(30687): GC_EXTERNAL_ALLOC freed 4K, 64% free 491K/1347K, external 1K/513K, paused 14ms
04-10 21:14:04.778: D/dalvikvm(30687): GC_EXTERNAL_ALLOC freed 10K, 61% free 534K/1347K, external 1521K/2013K, paused 12ms
04-10 21:14:04.968: D/dalvikvm(30687): GC_EXTERNAL_ALLOC freed 2K, 61% free 533K/1347K, external 4856K/6064K, paused 10ms
04-10 21:14:27.868: W/IInputConnectionWrapper(30687): getExtractedText on inactive InputConnection
04-10 21:14:27.888: W/IInputConnectionWrapper(30687): getCursorCapsMode on inactive InputConnection
04-10 21:14:27.888: W/IInputConnectionWrapper(30687): getExtractedText on inactive InputConnection
04-10 21:14:27.898: W/IInputConnectionWrapper(30687): performPrivateCommand on inactive InputConnection
04-10 21:14:38.208: D/szipinf(30687): Initializing inflate state
04-10 21:14:38.238: D/szipinf(30687): Initializing zlib to inflate
04-10 21:14:40.628: D/dalvikvm(30687): GC_FOR_MALLOC freed 412K, 24% free 3798K/4995K, external 7079K/7937K, paused 27ms
04-10 21:14:40.808: D/dalvikvm(30687): GC_CONCURRENT freed 405K, 18% free 5440K/6595K, external 7079K/7937K, paused 0ms+4ms
04-10 21:14:41.038: D/dalvikvm(30687): GC_CONCURRENT freed 7K, 10% free 7457K/8259K, external 7079K/7937K, paused 1ms+4ms
04-10 21:14:41.288: D/dalvikvm(30687): GC_CONCURRENT freed 351K, 11% free 9202K/10307K, external 7079K/7937K, paused 1ms+7ms
04-10 21:14:41.488: D/dalvikvm(30687): GC_FOR_MALLOC freed 6K, 7% free 10789K/11587K, external 7079K/7937K, paused 75ms
04-10 21:14:41.758: D/dalvikvm(30687): GC_CONCURRENT freed 522K, 10% free 12363K/13635K, external 7079K/7937K, paused 0ms+9ms
04-10 21:14:42.118: D/dalvikvm(30687): GC_CONCURRENT freed 8K, 6% free 14316K/15107K, external 7079K/7937K, paused 1ms+9ms
04-10 21:15:55.768: D/skia(30687): purging 340K from font cache [47 entries]
04-10 21:15:55.888: D/dalvikvm(30687): GC_EXPLICIT freed 1817K, 17% free 12542K/15107K, external 7079K/7937K, paused 107ms
04-10 21:16:42.368: D/skia(30687): purging 13K from font cache [2 entries]
04-10 21:16:42.478: D/dalvikvm(30687): GC_EXPLICIT freed 1038K, 24% free 11524K/15107K, external 7079K/7937K, paused 102ms
04-10 21:18:28.688: D/skia(30687): purging 13K from font cache [2 entries]
04-10 21:18:28.788: D/dalvikvm(30687): GC_EXPLICIT freed 6921K, 70% free 4646K/15107K, external 7079K/7937K, paused 91ms
04-10 21:18:33.758: W/dalvikvm(30687): threadid=9: thread exiting with uncaught exception (group=0x40015568)
04-10 21:18:33.768: E/AndroidRuntime(30687): FATAL EXCEPTION: AsyncTask #1
04-10 21:18:33.768: E/AndroidRuntime(30687): java.lang.RuntimeException: An error occured while executing doInBackground()
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.os.AsyncTask$3.done(AsyncTask.java:200)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at java.lang.Thread.run(Thread.java:1019)
04-10 21:18:33.768: E/AndroidRuntime(30687): Caused by: android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.view.ViewRoot.checkThread(ViewRoot.java:2954)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.view.ViewRoot.invalidateChild(ViewRoot.java:644)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.view.ViewRoot.invalidateChildInParent(ViewRoot.java:670)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.view.ViewGroup.invalidateChild(ViewGroup.java:2533)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.view.View.invalidate(View.java:5288)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.widget.TextView.checkForRelayout(TextView.java:5663)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.widget.TextView.setText(TextView.java:2814)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.widget.TextView.setText(TextView.java:2682)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.widget.TextView.setText(TextView.java:2657)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at dev.android.CCActivity3.fileReader(CCActivity3.java:207)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at dev.android.CCActivity3$xyz.doInBackground(CCActivity3.java:110)//file reader
04-10 21:18:33.768: E/AndroidRuntime(30687):    at dev.android.CCActivity3$xyz.doInBackground(CCActivity3.java:1)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
04-10 21:18:33.768: E/AndroidRuntime(30687):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
04-10 21:18:33.768: E/AndroidRuntime(30687):    ... 4 more 
```

我的应用程序几乎没有延迟，所以我决定在应用程序加载时放入进度条微调器。我的代码在进度条旋转大约 6 分钟后显示错误。它在 fileReader() 上引发错误，有时它只是永远旋转。FileReader() 是另一个类文件，它是代码的核心。如果你想看到这个类点击[这里](https://stackoverflow.com/questions/10022345/android-get-resource-buffer-reader-problems) 请帮助我。我很感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:56:32.770

问题是您正试图从该`doInBackground`方法更改 UI。根本原因可能是你的`FileReader`班级在做`display.setText(fg);`. 当您在其中时，`doInBackground`您**无法**更改`Acticity's`UI。您将需要使用 AsyncTask 的[publishProgress](http://developer.android.com/reference/android/os/AsyncTask.html#publishProgress%28Progress...%29)和[onProgressUpdate](http://developer.android.com/reference/android/os/AsyncTask.html#onProgressUpdate%28Progress...%29)方法来完成此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:37:21.993

`this.dialog.dismiss();`可以从 if 语句中删除，并且只要对话框在`onPostExecute`运行时自动关闭。

编辑：我的代码建议：

在启动 AsyncTask 的类中：

```
 ProgressDialog progressDialog = new ProgressDialog(getActivity());
            progressDialog.setMessage("Logging in...");
            LoginTask loginTask = new LoginTask((Polling) getActivity(), progressDialog);
            loginTask.execute(); 
```

和 AsyncTask 本身：

```
public class LoginTask extends AsyncTask<String, Void, Integer> {

private ProgressDialog progressDialog;
private Polling activity; 
 public LoginTask(Polling activity, ProgressDialog progressDialog)
{
    this.activity = activity;
    this.progressDialog = progressDialog;
}

@Override
protected void onPreExecute()
{
    progressDialog.show();
}

protected Integer doInBackground(String... arg0) {
    EditText userName = (EditText)activity.findViewById(R.id.emailEditText);
    EditText passwordEdit = (EditText)activity.findViewById(R.id.passEditText);
    String email = userName.getText().toString();
    String password = passwordEdit.getText().toString();
    UserFunctions userFunction = new UserFunctions();
    JSONObject json = userFunction.loginUser(email, password);

    // check for login response
    try {
        if (json.getString(KEY_SUCCESS) != null) {
            String res = json.getString(KEY_SUCCESS);

            if(Integer.parseInt(res) == 1){
                //whole bunch of extra code!
                responseCode = 1;
                // Close Login Screen
                //finish();

            }else{
                responseCode = 0;
                // Error in login
            }
        }

    } catch (NullPointerException e) {
        e.printStackTrace();

    }
    catch (JSONException e) {
        e.printStackTrace();
    }

    return responseCode;
}

@Override
protected void onPostExecute(Integer responseCode)
{
    EditText userName = (EditText)activity.findViewById(R.id.emailEditText);
    EditText passwordEdit = (EditText)activity.findViewById(R.id.passEditText);

    if (responseCode == 1) {
        progressDialog.dismiss();
        activity.loginReport(responseCode);
        userName.setText("");
        passwordEdit.setText("");
        //shared prefences, store name

    }
    if (responseCode == 0) {
        progressDialog.dismiss();
        activity.loginReport(responseCode);

    }
} 
```

}

只需跟随progressDialog。它在启动任务的主类中启动，并传递给 AsyncTask。然后在 AsyncTask 构造时，progressDialog 被存储为 AsyncTask 中的一个字段。然后，在 preExecute 中，我们显示（）progressDialog。然后，根据 doInBackground 的结果，我们向 onPostExecute 发送 1 或 0。那个 1 或 0 告诉 onPostExecute 要做什么，在我的代码中以任何一种方式关闭对话框，但随后在主类中运行不同的方法。希望这可以帮助您将类似的任务与您自己的任务进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T02:07:14.743

```
runOnUiThread(new Runnable() {
@Override
public void run() {
// TODO Auto-generated method stub
if (this.dialog.isShowing()) {
this.dialog.dismiss();
}
}); 
```

在 doInBackground() 的 catch 块中使用上面的代码。

# csv - 使用 Applescript 将列表写入 CSV

> ID：10097819
> 
> 赞同：2
> 
> 时间：2012-04-10T23:18:33.297
> 
> 标签：csv, applescript

我有一个从 CSV 读取数据的小程序（成功！）。在我的脚本完成数据编辑后，我希望它将修改后的文本写回该文件。 *当我的文本被写回 CSV 文件时，它丢失了所有的回车符，所以它读为一行。*我究竟做错了什么？

```
set theFile to choose file with prompt "Select a text file:"
set theFileContents to read theFile
...

set theList to paragraphs of theFileContents

repeat with i from 2 to count theList

set AppleScript's text item delimiters to ","
set theLine to theList's item i
theLine
set clinic_id to first text item of theLine
....
set AppleScript's text item delimiters to ""

...

    open for access theFile with write permission

    set theData to theList as text
    write the [theData] to theFile as text
    close access theFile

    display dialog the [theLine]
end if
end repeat 
```

有什么建议么？这段代码的输出是：

```
1,2,3,A,B,C,X,Y,Z 
```

当我想要的是

```
1,2,3
A,B,C
X,Y,Z 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T08:06:00.867

我想你`theList`有行（每行一个带逗号的字符串）作为它的项目，所以它看起来像`{"1,2,3", "A,B,C", "X,Y,Z"}`，对吧？因此，*在*将列表转换为 a`text`以便将其写入文件之前，请将 设置`text item delimiters`为换行符：

```
set AppleScript's text item delimiters to "\n"
set theData to {"1,2,3", "A,B,C", "X,Y,Z"} as text 
```

`theData`现在有价值

```
"1,2,3
A,B,C
X,Y,Z" 
```

这正是您将在输出文件中找到的内容。

# sql - 教义 - 查询中奇怪的移动括号

> ID：10097823
> 
> 赞同：0
> 
> 时间：2012-04-10T23:18:43.810
> 
> 标签：sql, doctrine, dql, parentheses

我已经在网上进行了测试并进行了一些研究，但仍然没有运气。有没有人遇到过这个问题？

说，我有一个学说查询设置如下：

```
$q = Doctrine_Query::create()
->update('PckFolder')
->set('id_path', "CONCAT(?, RIGHT(id_path, LENGTH(id_path)-?))", array($newPath, $lenOld))
->where("id_path like '$oldPath%'");

// and I print the query out
$qstr = $q->getSqlQuery(array($newPath, $lenOld)); 
```

而不是给我：

```
UPDATE pck_folder SET id_path = CONCAT(?, RIGHT(id_path, LENGTH(id_path)-?)) WHERE (id_path like '1/2//%') 
```

教义给了我：

```
UPDATE pck_folder SET id_path = CONCAT(?, RIGHT(id_path, LENGTH(id_path-?))) WHERE (id_path like '1/2//%') 
```

请注意这部分`RIGHT(id_path, LENGTH(id_path)-?)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:37:03.460

（注意：我假设您使用的是 Doctrine 1.2。我还没有使用过 Doctrine 2.0。）

我之前没有遇到过这个特定的错误，但我发现在 Doctrine_Query 中实现 update() 存在许多问题。除了最直接的更新查询之外，基本上任何事情都会导致解析器生成错误或无效的查询。例如，它不能处理更新中的子选择。

尝试编写原始 SQL 查询，或者使用效率较低但功能齐全的解决方法：使用 Doctrine_Query 选择要更新的记录，然后遍历它们并在 PHP 中设置字段，然后对每个记录调用 save()。

顺便说一句，使用 UPDATE 查询和 Doctrine 有一个很大的 GOTCHA 固有的问题，这会迫使您在许多情况下使用该解决方法。也就是说，如果您或您的插件在模型中使用了漂亮的 Doctrine 钩子方法，但您执行了影响这些记录的 SQL 级更新，则这些钩子将被静默规避。根据您的应用程序，这可能会破坏您的业务逻辑处理。

# ruby - 通过代理的 Ruby Eventmachine 和 HTTP 请求

> ID：10097824
> 
> 赞同：1
> 
> 时间：2012-04-10T23:18:47.040
> 
> 标签：ruby, proxy, eventmachine

我在 Eventmachine 上运行的高度可扩展的网络收割机上进行编码。一切正常且快速。最近我试图通过一堆也可以正常工作的代理来触发请求，例如：

```
EventMachine.run do
  connect_opts = { :proxy => { :host => '11.12.13.14', :port => 3128 } }
  request_opts = { :proxy => { :authorization => ['jdoe', 'mysecretpass'] } }
  req = EventMachine::HttpRequest.new('http://www.example.com/', connect_opts).get request_opts
  req.callback { }
end 
```

我正在迭代数百个代理并每秒触发数百个请求。我现在需要知道哪个代理用于哪个请求将这个元数据存储在数据库中。你将如何从 req 对象中获取这些信息？

我希望有一些方法，如 req.proxy_foo（相当于 req.response、req.response_header 等）来获取这些信息，但还没有找到任何合适的方法。

# objective-c - 在 NSScrollView 中嵌入字段编辑器

> ID：10097826
> 
> 赞同：0
> 
> 时间：2012-04-10T23:18:53.467
> 
> 标签：objective-c, cocoa, nstextfield, fieldeditor

有没有人有过在滚动视图中嵌入字段编辑器（用于 NSTextField）的经验？我试图在编辑时使 NSTextField 可滚动。

我尝试过的事情：

1.  `-becomeFirstResponder`当自定义字段编辑器被调用时动态嵌入它。这个半作品；问题是当 NSTextField 在编辑期间调整大小时，自定义字段编辑器不再调整大小（我需要这个 - 制作手风琴风格的应用程序）

2.  从 NSScrollView 创建一个“伪装”字段编辑器，并使用 NSInvocation 将方法转发到实际的代理字段编辑器。这是我真正希望可行的方法；我已经实现了[这里](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html)列出的所有方法；但是`EXC_BAD_ACCESS`每当实际加载字段编辑器时（例如，当我调用时`[customTextField selectText:nil]`），我都会得到一个。即使启用了 Zombies，我似乎也无法从调试器中撬出任何信息，并且查看日志`NSObjCMessageLoggingEnabled`也不会产生任何结果。看起来[这些家伙](http://www.cocoabuilder.com/archive/cocoa/145568-resizable-field-editor-in-nstableview.html)成功了，但那是七年前的事了。

最后的手段是完全放弃 NSTextFields 并使用 NSTextViews （或者不依赖于字段编辑器机制，自己编写一个），但由于我有很多行数据，一次只能编辑一个，我不不想为它们中的每一个实例化一个 NSTextView ......但是，也许它不会那么糟糕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T05:20:26.227

我最终使用了选项 1，并且毫不费力地让它工作。选项 2 完全是死胡同，因为`EXC_BAD_ACCESS`无论我走到哪里都会弹出。

我的自定义字段编辑器现在保留对（自定义）滚动视图的引用以将其自身嵌入（vvScrollView）中，并将其插入到视图层次结构中。我在自定义字段编辑器 (NSTextView) 中的代码，用于将其嵌入到滚动视图中，一旦字段编辑器成为第一响应者并自动插入到视图层次结构中，就会调用该滚动视图：

```
- (void)embedSelfInScrollView {
    NSView *realSuperview = [[self superview] superview];
    // [self superview] is some kind of private NSClipView class
    if ([realSuperview isKindOfClass:[NSTextField class]]) { // the expected behavior: this may change? TODO make less prone to chance
        [realSuperview addSubview:[self vvScrollView]]; // insert into view
        [[self vvScrollView] setFrameSize:[realSuperview frame].size]; // se the initial size equivalent to control size so it can autoresize the same way
        // add the scrollview into the view hierarchy
        [[self vvScrollView] setDocumentView:self]; // removes self from previous superview
    }
} 
```

我遇到的最初问题是我试图将滚动视图插入到字段编辑器（NSClipView 的私有类）正上方的超级视图中，这破坏了几乎所有自动调整大小选项（因为我希望能够在编辑时调整 NSTextField 的大小） . 更进一步并绕过私人课程似乎可行，但几乎似乎是任意的。

# localization - 本地化来自域对象（实体）的验证消息

> ID：10097828
> 
> 赞同：4
> 
> 时间：2012-04-10T23:18:54.127
> 
> 标签：localization, dependency-injection, domain-driven-design, globalization

我的目的不是就 DDD 中的验证、代码所属的位置等进行辩论，而是专注于一种可能的方法以及如何解决本地化问题。我在我的一个域对象（实体）上具有以下行为（方法），它举例说明了这种情况：

```
public void ClockIn()
{
    if (WasTerminated)
    {
        throw new InvalidOperationException("Cannot clock-in a terminated employee.");
    }

    ClockedInAt = DateTime.Now;
    :
} 
```

可以看到，当调用 ClockIn 方法时，该方法会检查对象的状态以确保 Employee 没有被终止。如果 Employee 被终止，我们会抛出一个与“不要让你的实体进入无效状态”方法一致的异常。

我的问题是我需要本地化异常消息。这通常使用应用程序服务 (ILocalizationService) 完成（在此应用程序中），该应用程序服务是使用 MEF 在需要访问其方法的类中导入的。但是，与任何 DI 框架一样，只有在容器实例化对象时才会注入/导入依赖项。DDD 通常不是这种情况。

此外，我所了解的有关 DDD 的所有内容都表明我们的域对象不应该有依赖关系，并且这些问题应该在域对象的外部处理。如果是这种情况，我该如何本地化如上图所示的消息？

这不是一个新要求，因为许多业务应用程序都需要全球化/本地化。我会很感激一些建议如何使这项工作仍然与 DDD 的目标保持一致。

**更新**

我最初没有指出我们的本地化都是数据库驱动的，所以我们确实有一个本地化服务（通过可注入的 ILocalizationService 接口）。因此，使用 Visual Studio 作为项目一部分提供的静态资源类不是一个可行的选择。

**另一个更新**

也许它会推动讨论，说明该应用程序是一个 RESTful 服务应用程序。因此，客户端可以是一个简单的网络浏览器。因此，我不能期望调用者可以执行任何类型的本地化、代码映射等进行编码。当发生异常时（在这种方法中，尝试将域对象置于无效状态是异常），抛出异常并返回相应的 HTTP 状态代码以及异常消息，该异常消息应本地化为调用者的文化（接受语言）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T16:26:54.617

不确定此响应对您有多大帮助，但本地化确实是前端问题。根据您的示例本地化异常消息不是常见的做法，因为最终用户不应该看到技术细节，例如异常消息中描述的那些（并且任何将对您的异常进行故障排除的人可能具有足够的英语水平，即使它不是他们的母语）。

当然，如有必要，您始终可以处理异常并在前端向您的用户提供本地化、用户友好的消息。但是将其作为前端关注点应该会简化您的架构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T18:19:09.330

正如 Clafou 所说，您不应该使用异常以任何方式将消息传递给 UI。

如果您仍然坚持这样做，一种选择是抛出错误代码而不是消息

`throw new InvalidOperationException("ERROR_TERMINATED_EMPLOYEE_CLOCKIN");`

然后，当它发生时，对异常做任何你需要做的事情（日志、查找本地化等等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-29T03:53:04.393

您尝试避免向域模型对象添加内部依赖项是正确的。

更好的解决方案是处理服务方法内部的操作，例如：

```
public class EmployeeServiceImpl implements EmployeeService {

   public void ClockEmployeeIn(Employee employee) throws InvalidOperationException {
      if (employee.isTerminated()) {
          // Localize using a resource lookup code..
          throw new InvalidOperationException("Error_Clockin_Employee_Terminated");      
      }       
      employee.setClockedInAt(DateTime.Now);
   }
} 
```

然后，您可以使用 DI 框架在您将进行时钟调用的地方注入服务，并使用该服务将您的域对象与业务逻辑的更改隔离开来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T00:38:01.527

如果本地化是域/应用程序的重要组成部分，您应该将其设为一等公民并在它所属的任何地方注入。我不确定“DDD 说我们的域对象不应该有依赖项”是什么意思 - 请解释一下。

# asp.net-mvc - Uploadify - MVC3：如何传回表单集合数据？

> ID：10097836
> 
> 赞同：0
> 
> 时间：2012-04-10T23:19:26.433
> 
> 标签：asp.net-mvc, asp.net-mvc-3, uploadify

我有一个视图模型，它显示在使用uploadify 的视图中。我需要在帖子中传回收集数据。我怎样才能做到这一点？

视图模型：

```
public class ViewModel
{
   string Name;
   IEnumerable<Junk> theJunk;
}

public Junk
{
   int id;
   string Name;
} 
```

看法：

```
@model ViewModel

@using (@Html.BeginForm())
{
  <input type="file" name="dr405" id="dr405" />

    <div>
        @Html.LabelFor(model => model.Name)
        @Html.EditorFor(model => model.Name)
    </div>        
    @Html.EditorFor(model => model.theJunk)

    <input type="submit" value="Upload Junk" /> 
}

<script type="text/javascript">
    jQuery.noConflict();
    jQuery(document).ready(function () {
        jQuery("#dr405").uploadify({
            'uploader': '@Url.Content("~/Scripts/uploadify.swf")',
            'cancelImg': '/Content/themes/base/images/cancel.png',
            'buttonText': 'Browse Files',
            'script': 'home/upload',
            'folder': '/uploads',
            'fileDesc': 'Image Files',
            'fileExt': '*.jpg;*.jpeg;*.gif;*.png',
            'sizeLimit': '38000',
            'multi': true,
            'auto': true,
        });
    }); 
    </script> 
```

控制器：

```
 [HttpPost]
    public ActionResult Upload(HttpPostedFileBase fileData, FormCollection collection)
    {
        // Get my view model here
        // ...get the main Name!
        // ...get the collection of Junk 

        return "ok";
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T06:20:21.620

这是[一篇](http://blog.bobcravens.com/2011/03/upload-multiple-files-with-progress-using-uploadify/)介绍这种情况的文章。您可以使用`scriptData`允许您将附加值传递给服务器的参数。但是由于uploadify为每个文件发送多个请求（假设您已将`multi`选项设置为true），您可以有2个控制器操作：第一个将针对每个选定的文件进行命中，以便将其保存在某处，第二个将是一次热所有文件都已上传并发送表单数据。`auto`如果您不希望在选择文件后立即开始上传，您还应该将该选项设置为 false。

# java - 从 Java 后端创建 RSS 提要

> ID：10097838
> 
> 赞同：0
> 
> 时间：2012-04-10T23:19:33.407
> 
> 标签：java, drupal, rss

基本上我想要达到的目标......

我希望能够从我的 java 后端更新 RSS 提要并将其显示在我的网页上..

例如，它会有点像新闻提要，并且会很好地配合更新。

这是可能的还是有更好的方法来做到这一点

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:27:39.050

I would recommend looking at this question [How to write an RSS feed with Java?](https://stackoverflow.com/questions/113063/java-rss-library)

I'm an advocate of using established, reputable libraries rather than reinventing the wheel wherever possible.

# winapi - 当调用winsock 中的recv 函数并且没有收到所有数据时会发生什么？

> ID：10097839
> 
> 赞同：1
> 
> 时间：2012-04-10T23:19:42.530
> 
> 标签：winapi, winsock

从我读过的关于winsock的内容来看，recv倾向于不会在一次调用中接收到来自发件人的所有数据。当人们这么说时，他们的意思是，例如，我从客户端发送 300 个字节并在服务器上调用 recv，它可能在第一次调用时只能接收 200 个字节，缓冲区将被这 200 个字节填充? 最后 100 个字节会发生什么？

另外，假设缓冲区太小，例如 512 字节或其他内容，客户端发送 600。第一个 recv 调用是否会将缓冲区填充到容量，然后只删除最后的 88 个字节？如果我用不同的缓冲区再次调用 recv，该缓冲区的前 88 个字节会是其余的数据吗？

第三，如果 1 和 2 为真，并且我在单独的缓冲区中接收到一整包数据，我是否必须将它们拼接到一个缓冲区中才能开始解析我的数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:21:41.297

我在这里假设 TCP。

> 是否有可能它在第一次调用时只能接收 200 个字节并且缓冲区将被这 200 个字节填充？

是的。

> 最后 100 个字节会发生什么？

下次您会收到它们。

> 另外，假设缓冲区太小，例如 512 字节或其他内容，客户端发送 600。第一个 recv 调用是否会将缓冲区填充到容量，然后只删除最后的 88 个字节？

不。

> 如果我用不同的缓冲区再次调用 recv，前 88 个字节会是其余的数据吗？

是的。

> 第三，如果 1 和 2 为真，并且我在单独的缓冲区中接收到一整包数据，我是否必须将它们拼接到一个缓冲区中才能开始解析我的数据？

这取决于你。您*需要*一个连续缓冲区中的数据吗？如果是这样，是的。

# ios - 用于网络任务 iOS 的 GCD

> ID：10097843
> 
> 赞同：1
> 
> 时间：2012-04-10T23:20:12.517
> 
> 标签：ios, uitableview, grand-central-dispatch

我正在使用 GCD 进行网络任务。我有一个表视图控制器从服务器加载数据，但是一旦我离开这个控制器并启动另一个视图控制器，应用程序就会崩溃。我找不到这个问题的解决方案。来自服务的响应是一个 NSArray，它是表视图的数据源。当我得到响应时，我在控制器中设置了一个数据源属性。我覆盖设置器并检查当前视图是否是表视图，如果是我重新加载表。我是在错误地接近这个吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:29:40.067

听起来错误可能出现在很多地方。我的建议是将问题分解成越来越小的部分。这不一定是快速和容易的。但是您会发现问题（并在此过程中学到很多东西）。

作为第一步，尝试用一些本地数据替换来自网络的数据。如果您仍然有问题，那么您可能可以排除处理网络响应的代码。

或者您可以采用另一种方式：只需检查请求中返回的数据。不要将其传递给应用程序。也许您会在响应中注意到空的、格式不正确的等数据。

注意：我认为您的服务器不会返回`NSArray`. 确保区分清楚（您可能正在接收一些`json`格式化的数据并对其进行解析）。

# mysql - SQL 语句总和

> ID：10097848
> 
> 赞同：0
> 
> 时间：2012-04-10T23:20:44.373
> 
> 标签：mysql

嘿伙计们，我正在尝试总结这些表格，但我不知道我做错了什么

我的第一张桌子是：

```
Reserve
ReserveID   MembershipID   PlayerCount   Time    CourseID 
```

我的第二张桌子是

```
Courses
CourseID   Name 
```

我正在尝试的 sql 语句在这里：

```
Select Sum(Reserve.Player_Count)Total
From Reserve 
Left Join Courses 
On Courses.CourseID = Reserve.ReserveID 
Where Time = "2012-04-09 07:10:00" 
And Courses.Name = "Lake" (or I had Courses.CourseId = "1") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:40:27.947

你似乎在混合别名。避免他们

```
Select Sum(Reserve.Player_Count)Total
From Reserve 
Left Join Courses 
On Courses.CourseID = Reserve.ReserveID 
Where Reserve.Time = "2012-04-09 07:10:00" 
--     ^ Right here  
And Courses.Name = "Lake" (or I had Courses.CourseId = "1") 
```

# jquery - 如何设置 Rails 3 jQuery 视图以显示州列表，然后列出属于该州的城市？

> ID：10097849
> 
> 赞同：0
> 
> 时间：2012-04-10T23:20:44.607
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3

我有一个`State`模型 which`has_many :cities`和一个`city`模型 which `belongs_to :state`。我想显示一个州列表，然后当用户点击一个州时，进行 ajax 调用以显示下面属于该州的城市。

我确信这可以使用 jQuery 来完成，并且没有部分，我只是在想出一些示例和解决方案时遇到了麻烦。

这是我希望它首先看起来的样子： - 阿拉巴马州 - 阿拉斯加州 - 阿肯色州 - 等等。

然后，如果有人点击“阿拉斯加”，列表将更新为： - 阿拉巴马州 - 阿拉斯加州 - 安克雷奇 - 费尔班克斯 - 朱诺 - 阿肯色州

任何帮助将非常感激！

**编辑**

好的，所以我一直在驱逐 jQuery 我想出了以下代码。我不能让各州单独展示他们各自的城市。照原样，如果您单击任何一个州，它只会显示第一个州的城市。

这是代码：

```
<script>
$(function(){
    $('#city').hide();
$('.toggle').toggle(function(){
    $('#city').fadeIn(100);
},
function(){
    $('#city').fadeOut(100);
});
});

</script>
<%= render "layouts/header"%>

<table class="state_list">
<% @states.in_groups_of(1, false).each do |state| %>
  <tr>
<% for state in state %>
<td>    
<div class="toggle"><h3><%= state.name %><br /></h3></div>
    <% @cities.each do |city| %>
        <% if city.state.id == state.id %>
                    <div id="city"><%= link_to city.name, cities_path(:city_id => city.id) %> (<%= city.posts.where(:published => true).count %>)<br />
            <% end %>
        <% end %>   
</div>
    </td>
        <% end %>
  </tr>
<% end %>
</table> 
```

再次感谢任何反馈！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T14:51:03.173

StackOverflow 答案

我知道了！

这是我做的参考...另外，如果您看到更好的方法，请告诉我。

```
<table class="state_list">
<% @states.in_groups_of(1, false).each do |state| %>
<tr>
<% for state in state %>
<td>    
    <script>
    $(function(){
            $('#city-<%=state.id%>').hide();
        $('#toggle-<%=state.id%>').toggle(function(){
            $('#city-<%=state.id%>').fadeIn(100);
        },
        function(){
            $('#city-<%=state.id%>').fadeOut(100);
        });
    });

    </script>
<div id="toggle-<%=state.id%>"><h3><%= state.name %><br /></h3></div>
    <% @cities.each do |city| %>
        <% if city.state.id == state.id %>
                    <div id="city-<%=state.id%>"><%= link_to city.name, cities_path(:city_id => city.id) %> (<%= city.posts.where(:published => true).count %>)<br />
            <% end %>
        <% end %>   
</div>
</td>
    <% end %>
  </tr>
<% end %>
</table> 
```

一切都像我希望的那样工作！

# c++ - 如何为类数组调用函数c ++

> ID：10097853
> 
> 赞同：0
> 
> 时间：2012-04-10T23:20:57.143
> 
> 标签：c++

我在 C++ 中创建了一个名为 Commands 的类（文件名 commands.cpp）。

我已将其放入命令数组（文件名 test.cpp）中。

我想知道的是如何调用 Commands 类中的函数。

例如，我在 Commands 类中有一个名为

```
 void command::init(char data[]) 
      {
        //detail
       } 
```

我试图调用该函数的是

***编辑***

```
 Class test{
     int CmdCount;     // number of commands in the array
     int MaxCmds;      // max amount of commands allowed
     command* cmds;
  Public:
     int get_command_count() const{
          return CmdCount;
     }

     int readfile(const char fname[]){
          char line[161];

          FILE* fp;
          fp = fopen(fname, "r");

          if(fp){
               for(int i = 0; 1 == fscanf(fp, "%160[^\n]\n", line; i++){
                     cmds[get_command_count()].init(line);
                     CmdCount += 1;
               }
          }
          fclose(fp);
     }
  }; 
```

我只想知道如何能够调用 void command::init(char data[])。

有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:30:27.077

听起来您的数组包含您的类的实例。在这种情况下，您希望在数组中的单个条目上调用该方法：

```
my_array[i].someMethod(); 
```

`my_array[i]`你的类的一个实例在哪里。

# php - smarty foreach 最后不能正常工作？

> ID：10097854
> 
> 赞同：-1
> 
> 时间：2012-04-10T23:21:13.493
> 
> 标签：php, html, smarty

我在从foreach的最后一个选项中添加一个类时遇到了麻烦，它出于某种原因重复它有什么想法吗？

```
{if $subcategories} 
<div class="subcategories">
{if $subcategories|@count < 6}
    <ul>
{/if}
{foreach from=$splitted_subcategories item="ssubcateg"}
    {if $subcategories|count >= 6}
        <div class="subcategories">
            <ul>
    {/if}
        {foreach from=$ssubcateg item=category name="ssubcateg"}
        {if $category.category_id}<li{if $smarty.foreach.ssubcateg.last} class="last"{/if}><a href="{"categories.view?category_id=`$category.category_id`"|fn_url}" class="strong">{$category.category}</a></li>{/if}

    {/foreach}
    {if $subcategories|count >= 6}
            </ul>
        </div>
    {/if}
{/foreach}
{if $subcategories|count < 6}
</ul>
{/if}
</div>
{/if} 
```

输出：似乎在重复？如果有 6 个结果是添加一个 class="last" 但中间结果如第三个结果？

```
<ul> 
<li class="last"><a class="strong" href="#">Link</a></li>
    <li><a class="strong" href="#">Link</a></li>
    <li class="last"><a class="strong" href="#">Link</a></li>
    <li><a class="strong" href="#">Link</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T08:15:48.960

您的最后一项正在重复，因为您正在检查“在内部循环中处于最后”。您忽略了内部循环本身是循环的。尝试：

```
{foreach from=$splitted_subcategories item="ssubcateg" name="outer"}
  {foreach from=$ssubcateg item=category name="ssubcateg"}
    {if $smarty.foreach.outer.last && $smarty.foreach.ssubcateg.last}
      … 
```

# objective-c - iOS：TapGestureRecognizer 问题

> ID：10097855
> 
> 赞同：1
> 
> 时间：2012-04-10T23:21:13.947
> 
> 标签：objective-c, ios, xcode, uiimageview, uitapgesturerecognizer

所以我有一个像照片库一样的应用程序，我正在实现用户删除图像的能力。这是设置：我有 9 个 UIImageView、imageView、imageView2 等。我还有一个“编辑”按钮和一个 tapGesture 操作方法。我将一个 Tap Gesture Recognizer 拖到我在 IB 中的视图上，并将其附加到每个 UIImageViews 上。我还将 tapGesture 操作方法附加到每个 UIImageViews。理想情况下，我希望该方法仅在按下“编辑”按钮时才变为活动状态。当用户点击编辑，然后点击他们要删除的图片时，我希望出现一个 UIAlertView，询问他们是否确定要删除它。这是我正在使用的代码：

```
- (IBAction)editButtonPressed:(id)sender {
    editButton.hidden = YES;
    backToGalleryButton.hidden = NO;
    tapToDeleteLabel.hidden = NO;
}

- (IBAction)tapGesture:(UITapGestureRecognizer*)gesture
{

    UIAlertView *deleteAlertView = [[UIAlertView alloc] initWithTitle:@"Delete"
                                                              message:@"Are you sure you want to delete this photo?"
                                                             delegate:self
                                                    cancelButtonTitle:@"No"
                                                    otherButtonTitles:@"Yes", nil];
    [deleteAlertView show];

    if (buttonIndex != [alertView cancelButtonIndex]) {

        UIImageView *view = [self.UIImageView];
        if (view) {
            [self.array removeObject:view];
        }

        CGPoint tapLocation = [gesture locationInView: self.view];
        for (UIImageView *imageView in self.view.subviews) {
            if (CGRectContainsPoint(self.UIImageView.frame, tapLocation)) {
                ((UIImageView *)[self.view]).image =nil;
 }

}
        [self.user setObject:self.array forKey:@"images"];
}
} 
```

这段代码显然充满了错误：这一行的“使用未声明的标识符按钮索引”：`if (buttonIndex != [alertView cancelButtonIndex])`

此行上的“在 PhotoViewController 类型的对象上找不到属性 UIImageView”`UIImageView *view = [self.UIImageView];`

和这一行的“预期标识符”`((UIImageView *)[self.view]).image =nil;`

我对编程很陌生，我很惊讶我能做到这一点。所以，我只是想弄清楚我需要如何编辑我的代码以使错误消失，并且只要点击 9 个图像视图之一就可以使用它，并且只有在首先按下编辑按钮。我之前使用标签，效果很好，但是我通过 NSData 保存图像，所以我不能再使用标签了。非常感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:42:15.637

首先，您不想将点击手势附加到图像视图。此外，如果您将拥有超过 9 个图像，您可能需要滚动视图，或单独处理滚动。首先，删除该手势识别器及其所有连接。

接下来，确定您将用作画廊画布的视图类型。一个简单的视图，或者一个滚动视图，或者其他什么......现在并不重要，只是为了让它工作。您想将该视图按住 ctrl 并拖动到您的界面定义中，因此它会为该视图放置一个 IBOutlet（这样您就可以在代码中引用它）。

你将把你的 ImageViews 放到我刚才提到的视图上。

您可以为手势识别器设置一个内部标志，但它也有一个属性，可以随时启用/禁用它。因此，您可以相当轻松地使其处于活动/非活动状态。

您要做的就是将一个轻击手势识别器放到您的控制器上，并将其连接到控制器的实现部分。它将生成一个用于处理识别器的存根。它将“一般”解释控制器的点击，并在视图上进行点击时调用您的代码。

还有一些代码...

在滚动视图中为“新”图像创建一个框架。

```
- (CGRect)frameForData:(MyData*)data atIndex:(NSUInteger)idx
{
    CGPoint topLeft;
    int row = idx / 4;
    int col = idx % 4;
    topLeft.x = (col+1)*HORIZ_SPACING + THUMBNAIL_WIDTH * (col);
    topLeft.y = (row+1)*VERT_SPACING + THUMBNAIL_HEIGHT * (row);
    return CGRectMake(topLeft.x, topLeft.y, THUMBNAIL_WIDTH, THUMBNAIL_HEIGHT);
} 
```

为每条元数据创建一个图像视图和一个小边框。

```
- (UIImageView*)createImageViewFor:(MetaData*)metadata
{
    UIImageView *imageView = [[UIImageView alloc] initWithImage:metadata.lastImage];
    imageView.frame = CGRectMake(0, 0, THUMBNAIL_WIDTH, THUMBNAIL_HEIGHT);;
    imageView.layer.borderColor = [[UIColor blackColor] CGColor];
    imageView.layer.borderWidth = 2.0;
    imageView.userInteractionEnabled = YES;
    return imageView;
} 
```

这是创建视图并将其添加到父级的地方...

```
 imageView = [self createImageViewFor:metadata];
    //[data.imageView sizeToFit];

    // Make sure the scrollView contentSize represents the data
    CGRect lastFrame = [self frameForData:data atIndex:self.data.count-1];
    CGFloat newHeight = lastFrame.origin.y + lastFrame.size.height;
    if (self.bookshelfScrollView.contentSize.height < newHeight) {
        CGSize newSize = self.bookshelfScrollView.contentSize;
        newSize.height = newHeight;
        self.bookshelfScrollView.contentSize = newSize;
    }
    [self.bookshelfScrollView addSubview:data.imageView]; 
```

因此，您只需创建每个框架，将它们添加到视图中，您唯一需要做的就是在它们上启用用户交互，否则滚动视图不允许手势通过。

好的......看看你发布的代码......因为你没有说它有什么问题......很难说......下面是你的代码......我的评论是，嗯，评论...... .

```
- (IBAction)editButtonPressed:(id)sender {
    editButton.hidden = YES;
    backToGalleryButton.hidden = NO;
    tapToDeleteLabel.hidden = NO;
}
- (IBAction)tapGesture:(UITapGestureRecognizer*)gesture
{
    // I don't think I'd do this here, but it shouldn't cause "problems."
    UIAlertView *deleteAlertView = [[UIAlertView alloc] initWithTitle:@"Delete"
                                                              message:@"Are you sure you want to delete this photo?"
                                                             delegate:self
                                                    cancelButtonTitle:@"No"
                                                    otherButtonTitles:@"Yes", nil];
    [deleteAlertView show];

    // In your controller, you have the main view, which is the view
    // on which you added your UIViews.  You need that view.  Add it as an IBOutlet
    // You should know how to do that...  ctrl-drag to the class INTERFACE source.
    // Assuming you name it "galleryView"

    // Take the tap location from the gesture, and make sure it is in the
    // coordinate space of the view.  Loop through all the imageViews and
    // find the one that contains the point where the finger was taped.
    // Then, "remove" that one from its superview...
    CGPoint tapLocation = [gesture locationInView: self.galleryView];
    for (UIImageView *imageView in self.galleryView.subviews) {
        if (CGRectContainsPoint(imageView.frame, tapLocation)) {
            [imageView removeFromSuperview];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T00:30:21.127

就个人而言，在我的小照片库中，我绕过了所有手势识别器，方法是用控件替换`UIImageView`控件`UIButton`，为按钮设置图像属性，就像为`UIImageView`. 它看起来一模一样，但是你可以免费点击缩略图，根本不需要手势。

所以，我的视图只有一个`UIScrollView`，我以编程方式将我的图像添加为按钮，并为按钮控件设置图像，例如：

```
- (void)loadImages
{
    listOfImages = [ImageData newArrayOfImagesForGallery:nil];

    // some variables to control where I put my thumbnails (which happen to be 76 x 76px)

    int const imageWidth = 76;
    int const imageHeight = imageWidth;
    NSInteger imagesPerRow;
    NSInteger imagePadding;
    NSInteger cellWidth;
    NSInteger cellHeight;

    // some variables to keep track of where I am as I load in my images

    int row = 0;
    int column = 0;
    int index = 0;

    // add images to navigation bar

    for (ImageData *item in listOfImages)
    {
        // figure out what row and column I'm on

        imagesPerRow = self.view.frame.size.width / (imageWidth + 2);
        imagePadding = (self.view.frame.size.width - imageWidth*imagesPerRow) / (imagesPerRow + 1);
        cellWidth = imageWidth + imagePadding;
        cellHeight = imageHeight + imagePadding;

        // this is how I happen to grab my UIImage ... this will vary by implementation

        UIImage *thumb = [item imageThumbnail];

        // assuming I found it...

        if (thumb)
        {
            // create my button and put my thumbnail image in it

            UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
            button.frame = CGRectMake(column * cellWidth  + imagePadding, 
                                      row    * cellHeight + imagePadding, 
                                      imageWidth, 
                                      imageHeight);
            [button setImage:thumb forState:UIControlStateNormal];
            [button addTarget:self
                       action:@selector(buttonClicked:)
             forControlEvents:UIControlEventTouchUpInside];
            button.tag = index++;
            [[button imageView] setContentMode:UIViewContentModeScaleAspectFit];

            // add it to my view

            [scrollView addSubview:button];

            // increment my column (and if necessary row) counters, making my scrollview larger if I need to)

            if (++column == imagesPerRow) 
            {
                column = 0;
                row++;
                [scrollView setContentSize:CGSizeMake(self.view.frame.size.width, (row+1) * cellHeight + imagePadding)];
            }
        }
    }
}

// I also have this in case the user changes orientation, so I'll move my images around if I need to

- (void)rearrangeImages
{
    if (!listOfImages)
    {
        [self loadImages];
        return;
    }

    // a few varibles to keep track of where I am

    int const imageWidth = 76;
    int const imagesPerRow = self.view.frame.size.width / (imageWidth + 2);
    int const imageHeight = imageWidth;
    int const imagePadding = (self.view.frame.size.width - imageWidth*imagesPerRow) / (imagesPerRow + 1);
    int const cellWidth = imageWidth + imagePadding;
    int const cellHeight = imageHeight + imagePadding;

    NSArray *buttons = [[NSArray alloc] initWithArray:[scrollView subviews]];

    int row;
    int column;
    int index;

    CGRect newFrame;

    // iterate through the buttons

    for (UIView *button in buttons)
    {
        index = [button tag];

        if ([button isKindOfClass:[UIButton class]] && index < [listOfImages count])
        {
            // figure out where the button should go

            row = floor(index / imagesPerRow);
            column = index % imagesPerRow;
            newFrame = CGRectMake(column * cellWidth  + imagePadding, 
                                  row    * cellHeight + imagePadding, 
                                  imageWidth, 
                                  imageHeight);

            // if we need to move it, then animation the moving

            if (button.frame.origin.x != newFrame.origin.x || button.frame.origin.y != newFrame.origin.y)
            {
                [UIView animateWithDuration:0.33 animations:^{
                    [button setFrame:newFrame];
                }];
            }
        }
    }

    NSInteger numberOfRows = floor(([listOfImages count] - 1) / imagesPerRow) + 1;

    [scrollView setContentSize:CGSizeMake(self.view.frame.size.width, numberOfRows * cellHeight + imagePadding)];
}

- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation
{
    [self rearrangeImages];
} 
```

希望这能让您了解如何`UIButton`以编程方式添加一个作为图库中的图像。我试图即时编辑它，所以如果我在此过程中引入任何错误，我提前道歉，但它应该让你了解你可以想象的事情......我删除了我的代码以执行此操作单独的 GCD 队列（我这样做是因为我有接近 100 个图像，并且在主队列上这样做太慢了。）

无论如何，您可以创建您的`buttonClicked`方法来显示您的`UIAlertView`.

```
- (void)buttonClicked:(UIButton *)sender
{
     if (inEditMode)
     {
         // create your UIAlterView using [sender tag] to know which image you tapped on
     }
} 
```

最后，您的 上有两个按钮`UIAlertView`，但您似乎没有检查用户单击了哪个按钮。您的视图控制器应该是一个`UIAlterViewDelegate`，您已经在其中定义了`alertView:clickedButtonAtIndex`将执行您的实际编辑步骤的视图控制器。

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
     // ok, will do what I need to do with whatever the user tapped in my alertview
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:38:41.340

我能想到的最简单的事情是默认禁用手势，然后在按下编辑按钮后启用手势。这样，图片只有在“编辑”模式下才会响应点击手势识别器。

# json - 杰克逊对双向一对多关系感到困惑

> ID：10097865
> 
> 赞同：11
> 
> 时间：2012-04-10T23:22:08.283
> 
> 标签：json, jackson

我通过 MappingJacksonHttpMessageConverter 使用带有 Hibernate/Spring MVC 的 jackson 1.9.2。

Jackson 无法序列化双向的一对多关系，造成无限循环。

我正在使用的课程是：

*   具有一组 SMS 实例的对话。

*   每个 SMS 实例都有一组电话号码

*   每个 PhoneNumber 都有一个父联系人（这是双向多对一关系）

我想要做的是序列化对话。

如果我不使用**@JsonManagedReference**和**@JsonBackReference** ，那么jackson 将由于无限循环而崩溃。但是当我使用它们时，***联系人***不会被序列化为***PhoneNumber***。

```
班级联系{
  @JsonManagedReference
  List<PhoneNumber> phoneNumber ;
}
类电话号码 {
  @JsonBackReference
  联系方式；
}

```

输出是：

```
{ <--------------------- 对话
    “身份证”：51，
    “短信集”：[
      {
        “身份证”：53，
        “起源”：0123465，
        “目的地”：“06533844XY”，
        "message": "你好世界！",
        “电话号码”： [
          {
            “身份证”：64，
            "num": "06533844XY",
            “创作日期”：1333992533000，
          }
        ],
      }
    ],
    “创作日期”：1333992534000
  }

```

代替

```
{ <--------- 对话
    “身份证”：51，
    “短信集”：[
      {
        “身份证”：53，
        “起源”：0123465，
        “目的地”：“06533844XY”，
        "message": "你好世界！",
        “电话号码”： [
          {
            “身份证”：64，
            "num": "06533844XY",
            “创作日期”：1333992533000，
            "联系人": <--------------------- 缺少的部分
             {
                “身份证”：12，
                “名称”：“塞缪尔杰克逊”，
                “primaryNumber”：“06533844XY”
             }
          }
        ],
      }
    ],
    “创作日期”：1333992534000
  }

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T18:00:32.023

我最近遇到了一个类似的问题：Jackson - serialization of entity with birectional Relations (avoiding cycles)

所以解决方案是升级到 Jackson 2.0，并在类中添加以下注释：

```
@JsonIdentityInfo(generator = ObjectIdGenerators.IntSequenceGenerator.class, 
                  property = "@id")
public class SomeEntityClass ... 
```

那么问题是 Spring 不适用于 Jackson 2.0。这已通过以下方式解决：

```
<bean id="jacksonMessageConverter"
          class="own.implementation.of.MappingJacksonHttpMessageConverter"/>

<bean class="org.springframework.web.servlet.mvc
             .annotation.AnnotationMethodHandlerAdapter">
        <property name="messageConverters">
            <list>
                <ref bean="jacksonMessageConverter"/>
            </list>
        </property>
        <property name="requireSession" value="false"/>
    </bean> 
```

而own.implementation.of.MappingJacksonHttpMessageConverter就是基于这个：

[http://www.jarvana.com/jarvana/view/org/springframework/spring-web/3.0.0.RELEASE/spring-web-3.0.0.RELEASE-sources.jar!/org/springframework/http/converter /json/MappingJacksonHttpMessageConverter.java?format=ok](http://www.jarvana.com/jarvana/view/org/springframework/spring-web/3.0.0.RELEASE/spring-web-3.0.0.RELEASE-sources.jar!/org/springframework/http/converter/json/MappingJacksonHttpMessageConverter.java?format=ok)

但是使用`ObjectMapper`Jackson 2.0 中的其他 Jackson 类而不是 Jackson 1.*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T06:30:12.987

作为第一个解决方案，我保留了这些注释并创建了另一个类：ContactWithouPhoneNumber，并将其作为字段添加到 PhoneNumber 类。

现在，在渲染之前，我将除 PhoneNumber 之外的所有字段从联系人复制到 contactWithoutPhoneNumber。输出 JSON 包含我需要的所有内容。

这就是 DTO 设计模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T17:16:55.510

你的类 def 中的一件事是使用 untyped `List`；你应该有：

```
List<PhoneNumber> phoneNumber ; 
```

因为否则杰克逊在反序列化时无法知道类型是什么；甚至在序列化时也可能导致问题（因为不确定基类型）。所以我会先解决这个问题。

但另外你的依赖可能是错误的：`@JsonManagedReference`必须始终是序列化的第一件事。如果不是这种情况，则不能使用这些注释。如果没有看到您尝试序列化的对象，则很难确定（POJO 定义和 JSON 似乎略有不同）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T04:16:29.277

您可以将@JsonIgnore 添加到字段，映射器将在序列化期间跳过它们。它的功能类似于@Transient。

它在 jackson-core-asl 中。

# php - Understanding Nested If.. Else statements

> ID：10097866
> 
> 赞同：1
> 
> 时间：2012-04-10T23:22:08.283
> 
> 标签：php, mysql

For some reason my PHP login script keeps returning "invalid email/password combination", yet i know I am entering the correct email and password. Does anyone see what I might be doing wrong?

```
<?php

$email= $_POST['email'];
$password= $_POST['password'];

if (!empty($email) && !empty($password)) {

    $connect= mysqli_connect("localhost", "root", "", "si") or die('error connecting with the database');
    $query= "SELECT user_id, email, password FROM users WHERE email='$email' AND            
    password='$password'";
    $result= mysqli_query($connect, $query) or die('error with query');

    if (mysqli_num_rows($result) == 1) {
        $row= mysqli_fetch_array($result);
        setcookie('user_id', $row['user_id']);
        echo "you are now logged in";
    } else {
        echo "invalid username/password combination";
    }

} else {
    echo" you must fill out both username and password";
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:33:30.583

你的代码看起来不错。我会检查以下内容：

确保查询正常工作。我会回显查询并在您的数据库程序中的数据库上运行它，看看结果是什么。

确保您使用该电子邮件/密码组合的用户不超过 1 个 - 它会干扰您的计数检查。

检查您发布的详细信息，并确保它们与您在数据库中的内容正确（没有杂散的空白等）。

最后，你最好正确缩进和布局你的代码，看看这里阅读有多容易：http: [//codepad.org/DmtMuTpC](http://codepad.org/DmtMuTpC)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:30:24.143

我会转而说，

```
if (mysqli_num_rows($result) > 0) 
```

但除此之外，代码看起来应该可以工作。您确定 $_POST 变量包含您认为它们应该包含的内容吗？您确定此用户/密码组合存在于您的数据库中吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T23:25:56.753

you care getting that when `mysqli_num_rows ( $result )` is not equal to `1` ... What i think you should do is verify if the `username` and `password` exist directly in the database ..... that is the only logical reason in your script why you should be getting `invalid username/password combination`

If you still have additional issue let me know

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T23:53:48.377

出现错误是因为数据库中有重复的数据。

# mysql - MySQL - When to have one to one relationships

> ID：10097872
> 
> 赞同：0
> 
> 时间：2012-04-10T23:22:54.553
> 
> 标签：mysql, database, database-design, join, one-to-one

When should one use one to one relationships? When should you add new fields and when should you separate them into a new table?

It seems to me that you'd use it whenever you're grouping fields and/or that group tends to be optional. Yes?

I'm trying to create the tables for an object but grouping/separating everything would require me about 20 joins and some even 4 levels deep.

Am I doing something wrong? How can I improve?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T23:30:56.670

首先，我强烈推荐阅读[有关范式](http://en.wikipedia.org/wiki/Database_normalization#Normal_forms)

规范化的关系数据库非常有用，正确地做到这一点是 Hibernate 等工具存在的原因 - 以帮助管理对象表示为关系映射和对象作为程序实体之间的差异。

任何具有一对一映射的东西都应该在同一个表中。一个人只有一个名字，一个姓氏。这些在逻辑上应该在同一个表中。没有必要引用名称表——特别是因为很少有关于名称的额外数据可以存储。显然，这并不总是正确的（词源数据库可能希望完全这样做），但对于大多数用途，您并不关心名称的来源 - 实际上您想要的只是名称。

因此，请考虑被表示的对象。一个人有一些单一的数据点，以及一些一对多的关系（例如，他们住过的地址）。一对多和多对多几乎总是需要一个单独的表（或两个，多对多）。遵循这两个准则，您可以非常快速地获得规范化的数据库。

请注意，应尽可能避免使用可选字段。通常情况下，有一个单独的表来保存该字段并引用回原始表。尽量保持你的桌子精简。如果一个字段不太可能有什么东西，它可能应该是它自己的表中的一行。许多这样的属性暗示了一个“属性”表，它可以保存特定类型的任意可选属性（即，应用于“人”）。

# c++ - 为什么我不能使用“delete”关键字回收动态分配的内存？

> ID：10097874
> 
> 赞同：3
> 
> 时间：2012-04-10T23:23:07.697
> 
> 标签：c++, memory-management, new-operator

我有以下课程：

```
class Patient {
public:
    Patient(int x);
    ~Patient();
private:
    int* RP;
};

Patient::Patient(int x) { RP = new int [x]; }
Patient::~Patient() { delete [] RP; } 
```

我在堆栈上创建了这个类的一个实例，如下所示：

```
void f() { Patient p(10); } 
```

现在，当`f()`返回时，我收到“双重释放或损坏”错误，这向我发出信号，表明有人试图多次删除某些内容。但我不明白为什么会这样。数组的空间是在堆上创建的，仅仅因为分配空间的函数返回，我不希望空间被回收。

我认为如果我在堆上分配空间（使用`new`关键字），那么回收该空间的唯一方法是使用 delete 关键字。帮助！

**根据要求，这是实际代码（为简洁起见略有删节）**

这是完整的类定义（拆分为一个`.cpp`和`.h`文件，但一起显示）：

```
class Patient {

public:
    Patient(int numDecisionEpochs);

    ~Patient();

    void recordRP(const int& age, const bool& t);
    void recordBiopsy(const int& age, const int& result);
    void recordPSA(const int& age, const double& level);
    void recordPSA(const int& age);
private:
    int* RP;
    int* Biopsy;
    double* PSA;
};

Patient::Patient(int numDecisionEpochs) {
    RP = new int [numDecisionEpochs];
    Biopsy = new int [numDecisionEpochs];
    PSA = new double [numDecisionEpochs];
}

Patient::~Patient() {
    delete[] RP;
}

void Patient::recordRP(const int& age, const bool& t) {
    if(t)
    RP[age-1] = 1;  // RP either yes (1) or no (0)
    else
    RP[age-1] = 0;
}

void Patient::recordBiopsy(const int& age, const int& result) {
    switch(result)
    {
    case 0:
    case 1:
    case 2:
    case 3:
    case 4:
        Biopsy[age-1]=result; // only permit results 0,1,2,3,4
        break;
    default:
        cerr << "Invalid biopsy result (" << result << ") at age " << age << "!\n";
    }
}

void Patient::recordPSA(const int& age, const double& level) {
    PSA[age-1] = level; // record PSA volume
}

void Patient::recordPSA(const int& age) {
    PSA[age-1] = -1; // symbol for no screening during epoch
} 
```

接下来是使用上述类的函数。以下函数直接调用`main()`并传递一个`Policy`完全独立于`Patient`类的对象：

```
void simulate1(Policy& P)
{
    // ...
    Patient patient(260);

    for(int idx=0; idx<(P.size); idx++)
    {
        while(state != 9) // while patient not dead
        {
                // ...
                patient.recordPSA(age,PSA);
                // ...
                patient.recordPSA(age);
                // ...
                patient.recordBiopsy(age,biopsyResult);
                // ...
                patient.recordRP(age,true);
                // ...
                patient.recordRP(age,false);
                // ...

        } // end patient (while loop)

    } // end sample (for loop)

} // end function 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T23:34:43.293

您违反了[三规则](https://stackoverflow.com/q/4172722/636019)（或对于 C++11，违反了[五规则](https://stackoverflow.com/q/4782757/636019)）。您需要一个复制构造函数和复制赋值运算符来对指针进行深度复制。当然，由于您不跟踪分配的数组的大小，因此如果不引入第二个数据成员，这是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:37:35.193

这不能直接回答您的问题，但也可以考虑使用 std::vector。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:48:47.010

在任何`record...`方法中都没有任何限制检查年龄的方法。因此，如果年龄恰好大于`260`或小于`0`您的示例中的年龄，您将超出`RP`or`Biopsy`或的范围`PSA`。这直接导致“双重释放或损坏”错误。

# java - Java - Scanner with multiple delimiters

> ID：10097876
> 
> 赞同：2
> 
> 时间：2012-04-10T23:23:24.493
> 
> 标签：java, java.util.scanner

I would like to use a Scanner to read input (a number) until it encounters either '+','-', '*', or '/'. These operators should end the input, and the value before the respective operator should be stored in a variable.

I am thinking about doing this by using the operators as delimiters. Am I on the right track, or is there a better way to do this?

Nik

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T05:18:02.760

`String.split( )`可能是你最好的选择。

但小心点！`String.split()`将[正则表达式](http://docs.oracle.com/javase/tutorial/essential/regex/)作为其参数。因为`+`and`*`是正则表达式中具有特殊含义的元字符，所以需要对其进行转义。

正则表达式`"-|\\+|\\*|/"`将在出现`-`or`+`或`*`or时拆分您的字符串`/`。

此示例代码应打印以下内容：`[20, 30, 40]`

```
String test = "20+30*40";

String[] tokens = split( "-|\\+|\\*|/" );

System.out.println( Arrays.toString( tokens ) ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:51:13.300

你在正确的轨道上。

您可以使用 String.split() 函数将字符串按 +、- 或 / 分割。

最终将成为

```
String[] allStrings = String.split("+|-|/"); 
```

这为您提供了一个由这些分隔符中的任何一个分割的字符串数组。

如果您需要更多帮助，请发布您的代码，以便我们为您提供帮助。

祝你有美好的一天

# ruby-on-rails - rails assets give TypeError (can't dup NilClass)

> ID：10097881
> 
> 赞同：0
> 
> 时间：2012-04-10T23:23:57.270
> 
> 标签：ruby-on-rails, ruby-on-rails-3, fastcgi

I have a rails 3 app that works fine when run under `rails s`. However, when trying to deploy it to apache2 with fcgi, the asset pipeline breaks. For example, when trying to request `/assets/logo.png` the log will show:

```
Started GET "/assets/logo.png" for 10.50.10.249 at Tue Apr 10 19:20:39 -0400 2012

TypeError (can't dup NilClass): 
```

This happens on either the production or development environments.

How can I debug this?

# mysql - MySQL - 冲突的 WHERE 和 GROUP BY 语句

> ID：10097883
> 
> 赞同：0
> 
> 时间：2012-04-10T23:24:06.537
> 
> 标签：mysql

我有一个查询返回一些数据的计数，但我不想要其中包含空值的数据......

例如，代码将点击系统中的统计信息滚动到表格中。

```
SELECT sh.dropid,
COUNT(DISTINCT IF(sh2.`SentDate` IS NOT NULL, sh2.`subid`, NULL)) AS sentCount,
COUNT(DISTINCT IF(sh2.`Open` = 1, sh2.`subid`, NULL)) AS openCount,
COUNT(DISTINCT IF(sh2.`Click` = 1, sh2.`subhistid`, NULL)) AS clickCount,
COUNT(DISTINCT IF(sh2.`Bounced` = 1, sh2.`subid`, NULL)) AS bounceCount,
COUNT(DISTINCT IF(sh2.`Unsubscribed` = 1, sh2.`subid`, NULL)) AS unsubCount,
COUNT(DISTINCT IF(sh2.`Abuse` = 1, sh2.`subid`, NULL)) AS abuseCount
FROM subscriberhistory sh
INNER JOIN subscriberhistory sh2 ON sh.subid = sh2.subid
WHERE sh.SentDate >= '#runDate# #lastRunTime#'
AND sh.dropid IS NOT NULL
AND sh.dropid != ""
OR (sh.SentDate IS NULL AND sh.OpenDate >= '#runDate# #lastRunTime#')
OR (sh.SentDate IS NULL AND sh.ClickDate >= '#runDate# #lastRunTime#')
OR (sh.SentDate IS NULL AND sh.UnsubscribeDate >= '#runDate# #lastRunTime#')
OR (sh.SentDate IS NULL AND sh.BouncedDate >= '#runDate# #lastRunTime#')
OR (sh.SentDate IS NULL AND sh.AbuseDate >= '#runDate# #lastRunTime#')
GROUP BY dropid
ORDER BY sentCount DESC 
```

编辑：更正查询

```
SELECT sh.dropid,
COUNT(DISTINCT IF(sh2.`SentDate` IS NOT NULL, sh2.`subid`, NULL)) AS sentCount,
COUNT(DISTINCT IF(sh2.`Open` = 1, sh2.`subid`, NULL)) AS openCount,
COUNT(DISTINCT IF(sh2.`Click` = 1, sh2.`subid`, NULL)) AS clickCount,
COUNT(DISTINCT IF(sh2.`Bounced` = 1, sh2.`subid`, NULL)) AS bounceCount,  
COUNT(DISTINCT IF(sh2.`Unsubscribed` = 1, sh2.`subid`, NULL)) AS unsubCount,
COUNT(DISTINCT IF(sh2.`Abuse` = 1, sh2.`subid`, NULL)) AS abuseCount
FROM subscriberhistory sh
INNER JOIN subscriberhistory sh2 ON sh.subid = sh2.subid
WHERE sh.dropid IS NOT NULL AND sh.dropid != ""
AND ((sh.SentDate >= '2012-04-10 14:15') 
OR (sh.SentDate IS NULL AND sh.OpenDate >= '2012-04-10 14:15')
OR (sh.SentDate IS NULL AND sh.ClickDate >= '2012-04-10 14:15')
OR (sh.SentDate IS NULL AND sh.UnsubscribeDate >= '2012-04-10 14:15')
OR (sh.SentDate IS NULL AND sh.BouncedDate >= '2012-04-10 14:15')
OR (sh.SentDate IS NULL AND sh.AbuseDate >= '2012-04-10 14:15'))
GROUP BY sh.dropid
ORDER BY sentCount DESC 
```

返回的记录集的示例如下所示...

```
(dropid) sent opens  clicks
400      2    3      4
401      2    3      6
NULL     2    3      4 
```

同样，目标是将 NULL 数据排除在前面的记录集之外。有人可以向我解释为什么会发生这种行为以及如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:00:23.417

正如我在评论中提到的 -`NULL`行正在通过语句中的`OR`条件蔓延。`WHERE`

考虑：

```
WHERE sh.dropid IS NOT NULL
AND   sh.dropid != ""
OR    ( some.other.condition ) 
```

假设您有一`sh.dropid`行为 NULL 但仍然令人满意`some.other.condition`- 那么整个`WHERE`子句将评估为，`TRUE`因为`OR`.

解决方案 - 添加括号。例如（取决于您所追求的逻辑）：

```
WHERE sh.dropid IS NOT NULL
  AND sh.dropid != ""
  AND (   one.condition
       OR second.condition
       OR third.condition
       ) 
```

# php - 在 PHP 登录脚本中使用会话和会话变量

> ID：10097887
> 
> 赞同：48
> 
> 时间：2012-04-10T23:24:18.557
> 
> 标签：php, session, login

我刚刚在 PHP 中创建了一个完整的登录和注册系统，但我的问题是我还没有使用任何会话。我是 PHP 的新手，以前从未使用过会话。我想要做的是，在用户注册并填写登录表单后，他们仍然会留在同一页面上。因此，如果会话已登录，则其中一部分将是已登录的，而另一部分将是其他部分（用户未登录，因此显示登录表单）。谁能告诉我如何开始？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-04-10T23:40:31.220

希望这可以帮助 ：）

开始会话，您需要在页面顶部或在调用会话代码之前说

```
 session_start(); 
```

在会话中放置一个用户 id 以跟踪谁登录

```
 $_SESSION['user'] = $user_id; 
```

检查是否有人登录

```
 if (isset($_SESSION['user'])) {
   // logged in
 } else {
   // not logged in
 } 
```

查找登录的用户 ID

```
$_SESSION['user'] 
```

所以在你的页面上

```
 <?php
 session_start();

 if (isset($_SESSION['user'])) {
 ?>
   logged in HTML and code here
 <?php

 } else {
   ?>
   Not logged in HTML and code here
   <?php
 } 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-01-05T09:30:58.393

这是使用 php 的最简单的会话代码。我们正在使用 3 个文件。

**登录.php**

```
<?php  session_start();   // session starts with the help of this function 

if(isset($_SESSION['use']))   // Checking whether the session is already there or not if 
                              // true then header redirect it to the home page directly 
 {
    header("Location:home.php"); 
 }

if(isset($_POST['login']))   // it checks whether the user clicked login button or not 
{
     $user = $_POST['user'];
     $pass = $_POST['pass'];

      if($user == "Ank" && $pass == "1234")  // username is  set to "Ank"  and Password   
         {                                   // is 1234 by default     

          $_SESSION['use']=$user;

         echo '<script type="text/javascript"> window.open("home.php","_self");</script>';            //  On Successful Login redirects to home.php

        }

        else
        {
            echo "invalid UserName or Password";        
        }
}
 ?>
<html>
<head>

<title> Login Page   </title>

</head>

<body>

<form action="" method="post">

    <table width="200" border="0">
  <tr>
    <td>  UserName</td>
    <td> <input type="text" name="user" > </td>
  </tr>
  <tr>
    <td> PassWord  </td>
    <td><input type="password" name="pass"></td>
  </tr>
  <tr>
    <td> <input type="submit" name="login" value="LOGIN"></td>
    <td></td>
  </tr>
</table>
</form>

</body>
</html> 
```

**主页.php**

```
<?php   session_start();  ?>

<html>
  <head>
       <title> Home </title>
  </head>
  <body>
<?php
      if(!isset($_SESSION['use'])) // If session is not set then redirect to Login Page
       {
           header("Location:Login.php");  
       }

          echo $_SESSION['use'];

          echo "Login Success";

          echo "<a href='logout.php'> Logout</a> "; 
?>
</body>
</html> 
```

**注销.php**

```
<?php
 session_start();

  echo "Logout Successfully ";
  session_destroy();   // function that Destroys Session 
  header("Location: Login.php");
?> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-10T23:40:53.960

首先，PHP 文档有一些关于[会话的](http://php.net/manual/en/features.sessions.php)**[优秀信息](http://www.php.net/manual/en/book.session.php)**。

其次，您将需要一些方法来存储您网站的每个用户的凭据（例如数据库）。最好不要将密码存储为人类可读的未加密纯文本。存储密码时，应使用 PHP 的[`crypt()`](http://php.net/manual/en/function.crypt.php)散列函数。这意味着，如果任何凭据被泄露，密码**就不**容易获得。

大多数登录系统会对用户输入的密码进行散列/加密，然后将结果与相应用户名的存储系统（例如数据库）中的散列进行比较。如果输入密码的哈希与存储的哈希匹配，则用户输入了正确的密码。

您可以使用会话变量来存储有关用户当前状态的信息 - 即他们是否登录，如果他们登录，您还可以存储他们的唯一用户 ID 或您需要的任何其他信息。

要启动 PHP 会话，您需要调用[`session_start()`](http://php.net/manual/en/function.session-start.php). 同样，要销毁会话及其数据，您需要调用[`session_destroy()`](http://php.net/manual/en/function.session-destroy.php)（例如，当用户注销时）：

```
// Begin the session
session_start();

// Use session variables
$_SESSION['userid'] = $userid;

// E.g. find if the user is logged in
if($_SESSION['userid']) {
    // Logged in
}
else {
    // Not logged in
}

// Destroy the session
if($log_out)
    session_destroy(); 
```

我也建议你看看**[这个](http://tinsology.net/2009/06/creating-a-secure-login-system-the-right-way/)**。那里有一些关于创建简单登录系统的良好、易于遵循的信息。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-10T23:56:05.807

我总是做 OOP 并使用这个类来维护会话，所以你可以使用函数 is_logged_in 来检查用户是否登录，如果没有，你可以做你想做的事。

```
<?php
class Session
{
private $logged_in=false;
public $user_id;

function __construct() {
    session_start();
    $this->check_login();
if($this->logged_in) {
  // actions to take right away if user is logged in
} else {
  // actions to take right away if user is not logged in
}
}

public function is_logged_in() {
   return $this->logged_in;
}

public function login($user) {
// database should find user based on username/password
if($user){
  $this->user_id = $_SESSION['user_id'] = $user->id;
  $this->logged_in = true;
  }
}

public function logout() {
unset($_SESSION['user_id']);
unset($this->user_id);
$this->logged_in = false;
}

private function check_login() {
if(isset($_SESSION['user_id'])) {
  $this->user_id = $_SESSION['user_id'];
  $this->logged_in = true;
} else {
  unset($this->user_id);
  $this->logged_in = false;
 }
}

}

$session = new Session();
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-18T03:42:32.720

```
//start use session

$session_start();

extract($_POST);         
//extract data from submit post 

if(isset($submit))  
{

if($user=="user" && $pass=="pass")

{

$_SESSION['user']= $user;   

//if correct password and name store in session 

}
else {

echo "Invalid user and password";

header("Locatin:form.php");

}

if(isset($_SESSION['user'])) 

{

//your home page code here

exit;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-23T15:26:14.490

这是一个单页**登录/注销系统**示例。密码永远不会暴露，并且 HASH+SALT与任何使用哈希加盐密码查看数据库表的人
一样*安全。*

`$hash`首先，使用这个[sandbox.io](https://phpsandbox.io/n/delicate-wave-llo7-j6jen)创建一个加盐密码，并确保将结果字符串替换为下面的 $hash's`***`

`index.php`单页：

```
<?php
// stackoverflow.com/a/67661402/383904
session_start();

$username = "pony";
$salt = "PonieshaveunicornS"; // Use something really custom instead of ponies
$hash = "***"; // Replace *** with the result of: echo hash("sha256", "myPassword".$salt);

$url = strtok($_SERVER["PHP_SELF"], '?');
$errorMessage = ""; // Used for login error messages

// LOGOUT SYSTEM
if (isset($_GET["p"]) && $_GET["p"] == "logout"):
    session_destroy();
    header("Location: $url");
    exit;
endif;

// LOGIN SYSTEM
if (isset($_POST['un']) && isset($_POST['pw'])):

  sleep(3); // Makes it ages slower for rainbow attacks

  if ($_POST['un'] == $username && hash("sha256", $_POST['pw'].$salt) == $hash):
    $_SESSION['_reg'] = $_POST['un'];
    header("Location: $url");
    exit;
  else:
    $message = "Incorrect login data";
  endif;
endif;

// DETERMINE A VALID LOGIN
$isLoggedIn = isset($_SESSION['_reg']) && $_SESSION['_reg'] == $username;

// YOUR CUSTOM LOGGED-IN METHODS AND STUFF
if ($isLoggedIn):

  // I.e: your DB connections, functions, methods, etc...

endif;
?>

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My app</title>
</head>
<body>

  <div id="app">
    <?php if ($isLoggedIn): ?>

      <h1>Welcome <?= $_SESSION["_reg"] ?></h1>
      <a href="?p=logout">Logout</a>

    <?php else: ?>

      <h1>LogIn</h1>

        <form action="./index.php" method="post">
          <label><input type="text" name="un" placeholder="Username" /></label><br>
          <label><input type="password" name="pw" placeholder="Password"/></label><br>
          <input type="submit" id="submit" value="LOGIN" />
        </form>

        <b><?= $errorMessage ?></b>

    <?php endif; ?>
  </div>

</body>
</html> 
```

**免责声明：请注意，以上**

*   没有那么糟糕，但是
*   应该使用 SHA 轮次和/或比 SHA256 更强的算法来改进
*   永远不要将秘密（盐）或哈希硬编码到可分发的文件中
*   仍然容易受到[Session 劫持](https://en.wikipedia.org/wiki/Session_hijacking)
*   它可以通过格式错误/损坏的服务器文件类型响应暴露（Facebook'07 综合症）
*   不专业（阅读：***禁止***）将此类代码推送到公开的 git 存储库，其中包含暴露的秘密 Salt 和 Hash
*   对于短期的*“**登录查看”*项目可能还可以
*   如果对所提供的代码/脚本没有正确、更深入的了解，您**永远不** 应该从**Stack Overflow***中“复制粘贴” 。*

 *** * *

## 回答 #7

> 赞同：-2
> 
> 时间：2018-07-31T12:25:17.053

```
$session_start();

extract($_POST);         
//extract data from submit post 

if(isset($submit))  
  {    
    if($user=="user" && $pass=="pass")    
      {     
        $_SESSION['user']= $user;       
        //if correct password and name store in session 
    } else {
        echo "Invalid user and password";
        header("Locatin:form.php")
    }
if(isset($_SESSION['user']))     
  {
  } 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2015-11-07T13:59:57.653

您需要在页面顶部或调用会话代码之前开始会话

```
session_start(); 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2017-09-13T07:44:45.700

```
$session_start();

extract($_POST);         
//extract data from submit post 

if(isset($submit))  
{

if($user=="user" && $pass=="pass")

{

$_SESSION['user']= $user;   

//if correct password and name store in session 

}
else {

echo "Invalid user and password";

header("Locatin:form.php");

}

if(isset($_SESSION['user'])) 

{

//your home page code here

exit;
} 
```**

# android - Android bug with buttons and editText

> ID：10097888
> 
> 赞同：0
> 
> 时间：2012-04-10T23:24:26.320
> 
> 标签：android, xml, user-interface

I have some android code (textView, editText, button) and I add all strings in string.xml. I call these data in this way:

```
Button vibro;          
setVibro((Button) findViewById(R.id.vibro));     
vibro.setText(getString(R.string.vibro_button));            
vibro = (Button)findViewById(R.id.vibro); 
```

and also I create set and get method for it. This is one part of my main.xml:

```
<EditText     
    android:id="@+id/editme"       
    android:layout_width="fill_parent"     
    android:layout_height="wrap_content"     
    android:text="@string/username"     
    />        

 <Button     
    android:id="@+id/buttons"      
    android:layout_width="fill_parent"        
    android:layout_height="wrap_content"     
    android:text="@string/bfirst"     
    /> 
```

and this is one part of my string.xml:

```
<string name="bfirst">Register</string> 
```

The problem is that I see the buttons and edit text and everything in all my pages. I am sure that I call them in a correct way. But what can cause a problem?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:31:39.300

setVibro 是一种方法吗？

另外，尝试设置这一行：

`vibro = (Button)findViewById(R.id.vibro);`

在此行之前：

`vibro.setText(getString(R.string.vibro_button));`

# asp.net-mvc-3 - JS内带有剃刀asp.net mvc的图像

> ID：10097889
> 
> 赞同：1
> 
> 时间：2012-04-10T23:24:27.453
> 
> 标签：asp.net-mvc-3, image, razor

我需要在我的 JS 代码中动态插入图像。在我的 Razor 模板中，我有：

```
@section Includes {  
      <script type="text/javascript">   

        var imgPath = "@Url.Content("~/Content/img/")";
        alert(imgPath);

      </script>

} 
```

然后在我的JS中我有：

```
 insertImg = "";
  if (response[i].someFlag == 'Y') {

                        insertImg = "<img src=\"" + imgPath + "/imgToInsert.gif\" width=\"6px\" height=\"10px\" />";
                    } 
```

但它不起作用 - 它不会找到图像。图像存储在 /Content/img 文件夹中...

我究竟做错了什么？我猜这是因为它是从 Js 脚本映射图像..看起来我将不得不对其进行硬编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:56:48.873

警告或者console.log下面看看是不是斜杠太多 `" + imgPath + "/imgToInsert.gif"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:44:53.683

[使用MVC TagBuilder 类](http://www.asp.net/mvc/tutorials/older-versions/views/using-the-tagbuilder-class-to-build-html-helpers-cs)来构建图像标签而不是使用字符串*连接*可能是有利的。让您动态构建标签并确保它们格式正确。很可能您的标签格式不正确。

# java - 逆逻辑函数/逆 S 型函数

> ID：10097891
> 
> 赞同：29
> 
> 时间：2012-04-10T23:25:17.330
> 
> 标签：java, math, fuzzy-logic

我目前正在用java编写一个模糊逻辑库。我找到了所有标准函数的方程——坡度、逆坡度、三角形、梯形、高斯。但是，我找不到 sigmoid/逻辑函数的倒数。

我编写逻辑函数的方式是java：

```
//f(x) = 1/(1+e(-x))
public double logistic(double x){

   return (1/(1+(Math.exp(-x)));

} 
```

但是我无法在任何地方解决或找到逆。我的代数/微积分能力相当有限，因此我无法计算出函数的倒数。

任何提示或指示都会有很大帮助。

谢谢

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-10T23:40:49.580

如果

```
y = 1/(1+exp(-x)) 
```

然后

```
x = ln(y/(1-y)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2021-06-22T16:09:04.020

只需完成以下步骤：

```
y = 1/(1 + exp(-x))

1 + exp(-x) = 1/y

exp(-x) = 1/y - 1

exp(-x) = 1/y - y/y

exp(-x) = (1 - y)/y

ln(exp(-x)) = ln((1 - y)/y)

-x = ln((1 - y)/y)

x = -ln((1 - y)/y)

x = ln(y/(1 - y)) 
```

# android - Problems with Twitter on Android App

> ID：10097892
> 
> 赞同：0
> 
> 时间：2012-04-10T23:25:26.020
> 
> 标签：android, twitter, motodev-studio

I'm trying to show one public twitter profile in one WebView of my app, is not necessary to login twitter, in the MotoDev Simulator this works fine, but in the physical device don't work, this: "403 fobiden limite exceed rate" error appears, this is the simple code line that I'm using:

> webView.loadUrl("https://mobile.twitter.com/#!/asambleaecuador");

and works fine into de MotoDev simulator AVD

....can somebody helpme please!!!

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:06:57.367

你想通了吗？

我只是想知道您为什么要尝试使用“https://mobile.twitter.com/#!/asambleaecuador”而不是简单地使用“https://mobile.twitter.com/asambleaecuador”。

无论如何，我只想说没有“MOTODEV 模拟器 AVD”，MOTODEV Studio 使用常规的 Android SDK 模拟器，没什么特别的。您面临的问题可能是由于 AVD 浏览器的底层实现与您的物理设备上的不同 - Android 设备有大量不同的浏览器实现。

# iphone - iOS: Linking a third party framework and crashing when deploying

> ID：10097896
> 
> 赞同：2
> 
> 时间：2012-04-10T23:26:10.407
> 
> 标签：iphone, ios, xcode

So, my problem is that I'm creating a framework to be used with iOS. It works great when in the simulator and when I'm debugging it on my iPad but as soon as I send it to anyone via Testflight (including my iPad) it crashes. The application will load the splash screen, then crash.

I tried symbolicating the report but I'm not getting anything out of it.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:50:38.333

所以，我的问题的解决方案是我正在链接框架但没有将它复制到设备，所以当我用连接到它的 iPad 调试它时，它会找到对框架的引用，但是一旦它被部署，应用程序在尝试查找框架时崩溃。

答案是：

1.  转到项目的构建阶段。
2.  添加构建阶段 > 添加副本文件。
3.  在目标字段中选择框架。
4.  复制框架。

您的应用程序现在应该已将框架复制并安装在需要的任何位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:46:35.853

有一次发生在我身上... xcode 编译应用程序以在模拟器上调试，但在 iOS 设备上发布。然后，调试版本没有做很多增强。

转到“产品”->“管理方案”。在那里，如果我是你，我会将所有内容设置为“构建配置”：发布。

这样，您可能会使模拟器崩溃......并且您可能更容易弄清楚发生了什么。

在我的情况下，我使用了一个块但没有复制它......然后，在发布版本中，编译器清除了内存，而在调试版本中它没有。

希望能帮助到你

# ruby-on-rails - Rails 3 jQuery UI Slider

> ID：10097898
> 
> 赞同：0
> 
> 时间：2012-04-10T23:26:15.383
> 
> 标签：ruby-on-rails, jquery-ui, jquery-ui-slider

I'm trying to use the jQuery UI Slider with my rails 3 app. I've downloaded a theme and put the css file in app/assets/stylesheet and I put all the images in app/assets/images.

When I load a page with a slider, I get an error that it can't find an image:

```
GET http://10.1.10.100:3000/assets/images/ui-bg_glass_45_0078ae_1x400.png 404 (Not Found) 
```

That file is in app/assets/images/ and the css file has been edited to point to `../images/<image>`

Is there something else I need to do to make a jQuery slider work with Rails 3?

gist with the files: [https://gist.github.com/2355571](https://gist.github.com/2355571)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:47:54.363

我更喜欢保持 jQuery UI 文件原样，并将 ui 图像放在`public/stylesheets/images`. 这样升级 jQuery UI 样式表就更容易了，你可以把它换成你的新样式表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:37:08.173

也许只是尝试直接在您的 CSS 文件中链接到图像，但将文件保留在原处。如果我是正确的，它应该知道无论如何都要查看 assets/images 文件夹。

代替...

`url(../images/ui-bg_inset-hard_100_fcfdfd_1x100.png)`

试一试

`url(ui-bg_inset-hard_100_fcfdfd_1x100.png)`

# php - How to remove part of a url?

> ID：10097900
> 
> 赞同：1
> 
> 时间：2012-04-10T23:26:32.233
> 
> 标签：php, url, relative-path

Trying to turn this:

```
href="/wp-content/themes/tray/img/celebrity_photos/photo.jpg" 
```

into:

```
href="/img/celebrity_photos/photo.jpg" 
```

So I'm simply trying to *remove* `/wp-content/themes/tray/` from the url.

Here's the plug in's PHP code that builds a variable for each anchor path:

```
$this->imageURL = '/' . $this->path . '/' . $this->filename; 
```

So I'd like to say:

```
$this->imageURL = '/' . $this->path -/wp-content/themes/tray/ . '/' . $this->filename; 
```

PHP `substr()`? `strpos()`?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T23:35:20.770

鉴于：

```
$this->imageURL = '/' . $this->path . '/' . $this->filename;
$remove = "/wp-content/themes/tray"; 
```

这是删除已知前缀（如果存在）的方法：

```
if (strpos($this->imageURL, $remove) === 0) {
    $this->imageURL = substr($this->imageURL, strlen($remove));
} 
```

如果您*确定*它始终存在，那么您也可以失去该`if`条件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:36:56.507

这是一种选择：

```
$h="/wp-content/themes/tray/img/celebrity_photos/photo-on-4-6-12-at-3-23-pm.jpg";

$prefix="/wp-content/themes/tray/";

print str_replace($prefix, "/", $h, 1); 
```

它有一个主要缺陷，那就是它没有将自己锚定到`$h`. 为此，您要么需要使用正则表达式（处理量更大），要么在运行`str_replace()`.

```
$h="/wp-content/themes/tray/img/celebrity_photos/photo-on-4-6-12-at-3-23-pm.jpg";

$prefix="/wp-content/themes/tray/";

if (strpos(" ".$h, $prefix) == 1)
  $result = str_replace($prefix, "/", $h, 1);
else
  $result = $h;

print $result; 
```

请注意这个重要元素：前缀以斜杠**结尾**。您不想匹配“trayn”或“traypse”等其他主题。请注意仅针对您的特定用例编写内容。总是试图弄清楚代码是如何破坏的，并围绕有问题的假设用例进行编程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T23:33:45.537

**尝试这个 ：**

```
$href = str_replace("/wp-content/themes/tray","",$href); 
```

或者在您的特定情况下，是这样的：

```
$this->imageURL = '/' . str_replace("/wp-content/themes/tray/","",$this->path) . '/' . $this->filename; 
```

# c# - How can error in external API depend on calls to GC.Collect() in main application?

> ID：10097902
> 
> 赞同：0
> 
> 时间：2012-04-10T23:27:06.820
> 
> 标签：c#, cplex, unmanaged-memory

I have been trying to explaing this behavior in my c# optimization routine.

The program creates and solves large LPs using the cplex 12.2 API in a subroutine. For the purpose of hunting this bug, I changed it so that it solves the same problem repeatedly. After solving, I call cplex.End() on the instance, and the cplex instance goes out of scope, so the memory will be deallocated.

The second time I create the model and call cplex.Solve(), it does not solve the model. It gives the error: "CPLEX error 1217: No Solution Exists", which is not so credible since it solved the same problem the first time. (memory requirements at the moment of the crash were just 1.3 GIG)

Now, if I force a garbage collect between the two solves, cplex solves the model the second time as it did the first time.

Can anyone explain this behavior to me? And the way to properly fix it?

# google-chrome-extension - Chrome 扩展程序 - 设置页面上的扩展程序图像

> ID：10097906
> 
> 赞同：15
> 
> 时间：2012-04-10T23:27:50.640
> 
> 标签：google-chrome-extension, icons

我试图弄清楚如何让我们的扩展程序的图像/图标显示在“设置”->“扩展程序”页面上。我查看了清单 api，但我发现与此相关的最接近的事情是包含不起作用的“图标”。

![在此处输入图像描述](../Images/92a54b48af354ec027c7d8b67a58c6e5.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-11T05:23:45.640

查看我的清单（我有一个图标）我有：

```
{
   "name": "Obviously there's more to my manifest file. Also, I'm not using manifest version 2 yet", 
   "icons":
   {
      "128": "images/icon128.png",
      "16": "images/icon16.png",
      "48": "images/icon48.png"
   }
} 
```

# python - Python——如何从混合的数字和字符中提取信息并将它们保存在二维列表中？

> ID：10097913
> 
> 赞同：1
> 
> 时间：2012-04-10T23:29:16.377
> 
> 标签：python

来自 .txt 的数据：

```
ABC 12 34 24
edf 23 15 63
hre 41 3  356
...
... 
```

我想将每个单词（在第一列中）保存在一组中。对于集合中的每个元素，都有一个包含其后每个数字的列表。例如单词[ABC][1] = 34，单词[hre][2] = 356。

我在网上找不到任何有用的信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T23:32:31.250

您将需要一个字典，将键映射到整数列表：

```
d = {}
with open("input.txt") as f:
    for line in f:
        items = line.split()
        d[items[0]] = map(int, items[1:]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:03:00.903

这是使用生成器来节省内存的好时机，即使是在大文件上也是如此。

在这里，我使用多行字符串模拟文件。

```
file_ = """ABC 12 34 24
edf 23 15 63
hre 41 3  356""".splitlines()

rows = (line.split() for line in file_)
pairs = ((row[0], map(int, row[1:])) for row in rows)
d = dict(pairs)

for key_ in d:
    print key_, d[key_]

"""
>>>
hre [41, 3, 356]
ABC [12, 34, 24]
edf [23, 15, 63]
"""

print d['ABC'][1]
"34" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:39:34.503

这是一种方法：

mkt.py

```
words = {}
with open('a.txt') as f:
  for l in f:
    cols = l.split()
    word = cols[0]
    nums = [int(e) for e in cols[1:]]
    words[word] = nums

# Printing all words with their number lists
for k, v in words.iteritems():
  print("%s -> %s" % (k, v))

# Getting specific ones
print(words['ABC'][1]) # -> 34
print(words['hre'][2]) # -> 356

# Showing it's an int - doing some basic arithmetic operation
i = words['ABC'][1] + 50 # -> 84
print(i) 
```

一个.txt

```
ABC 12 34 24
edf 23 15 63
hre 41 3  356 
```

跑步：

```
$ python mkt.py 
hre -> [41, 3, 356]
ABC -> [12, 34, 24]
edf -> [23, 15, 63]
34
356
84 
```

# c# - 为什么我的事件属性代码会导致堆栈溢出异常？

> ID：10097915
> 
> 赞同：1
> 
> 时间：2012-04-10T23:29:54.330
> 
> 标签：c#, winforms, events, properties, user-controls

我正在制作一个自定义按钮（Winforms 控件库）并具有下面的代码，以便将所有 mouseenter 添加到我的按钮中的所有控件中。当我运行它时，它会导致堆栈溢出异常。我用 Click 而不是 MouseEnter 有相同的代码，它工作正常。这是代码：

```
public new event EventHandler MouseEnter {
    add
    {
        this.MouseEnter += value;
        foreach (Control i in Controls)
        {
            i.MouseEnter += value;
        }
    }
    remove
    {
        this.MouseEnter -= value;
        foreach (Control i in Controls)
        {
            i.MouseEnter -= value;
        }
    }
} 
```

这是点击代码：

```
public new event EventHandler Click {
    add {
        this.Click += value;
        foreach (Control i in Controls) {
            i.Click += value;
        }
    }
    remove {
        this.Click -= value;
        foreach (Control i in Controls) {
            i.Click -= value;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T23:33:33.107

`+=`是“为此事件调用加法器”的简写。`+=`你是从你的加法器调用的。因此，您有未绑定的递归，导致堆栈溢出。

查看您的代码，您似乎正在自己定义加法器，以便不仅从控件中添加和删除处理程序，而且还从其所有子项中添加和删除处理程序。这让我觉得这是一个非常糟糕的主意：给定事件的订阅者有合理的期望，即他们只会在实际事件被触发时收到通知，而不是在事件被他们一无所知的任意数量的发布者触发时收到通知。

如果您想创建执行此操作的辅助方法，那可能更有意义，因为现在调用这些方法的消费者确切地知道他们正在进入什么。同样，这将摆脱您启动的递归错误。

最后，这个功能可能是不必要的：无论如何，许多事件都会从孩子传给父母。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:16:53.717

我最终将 this.Click 替换为 base.Click。

```
 public new event EventHandler Click {
        add {
            base.Click += value;
            foreach (Control i in Controls) {
                i.Click += value;
            }
        }
        remove {
            base.Click -= value;
            foreach (Control i in Controls) {
                i.Click -= value;
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:35:51.770

我想你想要这样的东西（不确定它是否适合私人成员）：

```
private EventHandler mouseEnter;
public new event EventHandler MouseEnter {
add
{
    this.mouseEnter += value;
    foreach (Control i in Controls)
    {
        i.mouseEnter += value;
    }
}
remove
{
    this.mouseEnter -= value;
    foreach (Control i in Controls)
    {
        i.mouseEnter -= value;
    }
} 
```

}

你`this.MouseEnter`在递归中调用自己。

# ruby-on-rails - 在 Ruby 中是否采用“MVC”方式？（汽车->零件）

> ID：10097916
> 
> 赞同：0
> 
> 时间：2012-04-10T23:29:58.207
> 
> 标签：ruby-on-rails, ruby, model-view-controller, controller, render

我有一个关于如何在 Ruby 中以最佳方式实现 MVC 概念的理论问题（因为我更熟悉非 MVC -thx 的提示语言，如 ASP、PHP）。

在我的示例应用程序中，您必须管理*Car*及其*Parts*。在此之后，我将（在我看来）实现以下两个控制器：
- **CarsController**
- **PartsController**

两者都有其默认操作（索引、显示、编辑、删除）。

在**PartsController**的“索引”动作中，所有与汽车相关的部件都会显示出来。

在**CarsController**的“索引”操作中，所有汽车的详细信息都会显示出来，此外，我将包括**PartsController**的“索引”操作的内容，将汽车 id 传递给它（或会话中的那些）。

示例布局 (CarsController/show/1)
- 汽车：Porsche GT
- 品牌：Porsche
- 型号：GT
- PS：400
- 零件（来自 PartsController/index，汽车的零件之前由 CarsController 缓存）：
*--- 门锁
- -- 发动机 400*

我尝试使用

```
render "cars/index"  
render :action => "cars/index"  
render :template => "cars/index"  
render :controller => "cars", :action => "index" 
```

在我的 index.html.erb 模板中，但没有一个可以工作（我每次都会收到错误消息“模板丢失”）。

因为我已经遇到了很多麻烦，所以我认为我的概念/实现可能是错误的。

有什么建议可以找到更好的方法吗？

谢谢您的帮助 ！

**更新：**

好的，这是一个更具体的示例。假设用户访问 localhost/cars/1。这是我的控制器的模板用于执行此操作：

*应用程序/视图/汽车/show.html.erb*

```
<%= form_for(@car) do |f| %>
  <div class="field">
    <%= f.label :brand %><br />
    <%= f.text_field :brand %>
  </div>
  <div class="field">
    <%= f.label :model %><br />
    <%= f.text_field :model %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
<%= render "parts/index" %> 
```

*app/view/parts/index.html.erb*

```
<table>
  <% @parts.each do |part| %>
  <tr id="part-<%= part.id %>">
    <td><%= part.amount %></td>
    <td><%= part.price_total %></td>
  </tr>
  <% end %>
</table> 
```

零件是从缓存中加载的，因此 PartsController 不需要汽车 ID（还没有）！

*路线.rb*

```
resources :cars do
  resources :parts
end 
```

然后我会收到以下错误：

> {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]} 缺少部分部分/索引。在以下位置搜索：*“D:/Dev/Ruby/MyCRM/app/views”*“C:/Ruby193/lib/ruby/gems/1.9.1/gems/datagrid-0.5.3/app/views”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:55:03.820

你现在实际上有许多不同的问题。您的帖子的积极意义是您应该有两个控制器，如您所列出的。当您是新手时，路由（这就是 rails 处理 Web 请求的方式）是一个非常复杂的话题，但非常重要。

我建议您从[本文档](http://guides.rubyonrails.org/routing.html)开始，如果您在此之后仍有问题可以再次提问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T16:47:08.907

就像您尝试做的事情在 Rails 中被称为“渲染部分”。

基本思想是，您有一个 html 存根（在这种情况下，是一个零件模板，用于呈现特定汽车的零件列表），并且该片段包含在一个或多个完整页面中。

```
render "parts/index" 
```

不工作，因为它在部件文件夹下寻找一个名为“索引”的部分，而不是一个完整的页面*。*按照惯例，Rails 中的局部用下划线命名。

为了让它工作，你应该创建一个部分，即 app/views/parts/_list.html.erb

第二部分是，该部分将需要访问部件列表。除非您的汽车控制器创建一个 @parts 变量，否则这将需要推断。在实践中这样做的方法是传递局部变量。因此，您将重写 _list.html.erb 以使用 'parts' 而不是 '@parts'，然后在您的汽车控制器中，您将像这样呈现它：

```
render "parts/list", :locals => {:parts => @car.parts} 
```

在您的零件索引中，如果您想列出*所有*零件，您可以像这样呈现部分：

```
render "list", :locals => {:parts => @parts} 
```

有关更多信息和更详细的演练，请阅读： http: [//guides.rubyonrails.org/layouts_and_rendering.html#using-partials](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)

# php - curl POST错误：请求的URL返回错误：413

> ID：10097920
> 
> 赞同：1
> 
> 时间：2012-04-10T23:30:48.200
> 
> 标签：php, curl

我环顾四周，找不到解决我问题的解决方案。我收到以下错误：“请求的 URL 返回错误：413。”

我通过 curl 和 PHP 将一些信息发布到通过 HTTPS 的 URL。我被告知我必须将“Content-Length”与我的请求一起传递，因为目标是 https 而不是 http。

这是我正在使用的代码：

```
 $user = '11111111111111111';
    $books = array(111);

    $data = array("action" => "books-shared", "userID" => $user, "bookIDs" => $books);
    $data_string = array('json'=>json_encode($data));
    $target_url = 'https://www.test.com/test.php'; // fake URL of course

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $data_string);
    curl_setopt($ch, CURLOPT_URL,$target_url);                                                                  
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_FAILONERROR, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, array(                                                                          
        'Content-Type: application/json',                                                                                
        'Content-Length: ' . strlen($data_string))                                       
    );                                                                                                                   

    $api = curl_exec($ch); 
```

我的 strlen($data_string) 命令返回的值为 5，这比 $data_string 的实际长度要小得多，后者要长得多。我认为这是问题所在，除非有人认为它可能是由其他原因引起的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T22:13:26.773

这就是我最终得到的结果：

```
 $user = '11111111111111111';
    $books = array(111);

    $data = array("action" => "books-shared", "userID" => $user, "bookIDs" => $books);
    $data_string = array('json'=>json_encode($data));

    $target_url = 'https://www.test.com/test.php'; // fake URL of course

    $ch = curl_init();
    if (!$ch) {
        die("Couldn't initialize a cURL handle");
    }       
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_VERBOSE, true);        
    curl_setopt($ch, CURLOPT_POSTFIELDS, $data_string);
    curl_setopt($ch, CURLOPT_URL, $target_url);                                                                  
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_FAILONERROR, true);                                                                                                                  

    $api = curl_exec($ch); 
```

没有 SSL 或大小错误，它似乎工作正常。

# c - 错误：“lessthen_predictable_t”之前的预期声明说明符或“...”？

> ID：10097921
> 
> 赞同：0
> 
> 时间：2012-04-10T23:30:55.523
> 
> 标签：c

按照本教程： [http ://www.jamesmolloy.co.uk/tutorial_html/7.-The%20Heap.html](http://www.jamesmolloy.co.uk/tutorial_html/7.-The%20Heap.html)

我有以下错误：

```
source/ordered_array.c: In function ‘insert_ordered_array’:
source/ordered_array.c:43:67: error: expected identifier before ‘[’ token
source/ordered_array.c:43:67: error: too few arguments to function ‘array->less_than’
make: *** [obj/ordered_array.o] Error 1 
```

从我的编译器。我没有得到任何它，因为我完全遵循了教程。

以下是相关的文件：

有序数组.h：

```
// ordered_array.h -- Interface for creating, inserting and deleting
//                    from ordered arrays.
//                    Written for JamesM's kernel development tutorials.

#ifndef ORDERED_ARRAY_H
#define ORDERED_ARRAY_H

#include "common.h"

/**
   This array is insertion sorted - it always remains in a sorted state (between calls).
   It can store anything that can be cast to a void* -- so a u32int, or any pointer.
**/
typedef void* type_t;
/**
    A predicate should return nonzero if the first argument is less than the second.  Else 
    it should return zero.
**/
typedef s8int (*lessthan_predicate_t)(type_t,type_t);
typedef struct
{
    type_t *array;
    u32int size;
    u32int max_size;
    lessthan_predicate_t less_than;
} ordered_array_t;

/**
   A standard less than predicate.
**/
s8int standard_lessthan_predicate(type_t a, type_t b);

/**
   Create an ordered array.
**/
ordered_array_t create_ordered_array(u32int max_size, lessthan_predicate_t less_than);
ordered_array_t place_ordered_array(void *addr, u32int max_size, lessthan_predicate_t  less_than);

/**
   Destroy an ordered array.
**/
void destroy_ordered_array(ordered_array_t *array);

/**
   Add an item into the array.
**/
void insert_ordered_array(type_t item, ordered_array_t *array);

/**
   Lookup the item at index i.
**/
type_t lookup_ordered_array(u32int i, ordered_array_t *array);

/**
   Deletes the item at location i from the array.
**/
void remove_ordered_array(u32int i, ordered_array_t *array);

#endif // ORDERED_ARRAY_H 
```

有序数组.c：

```
// ordered_array.c -- Implementation for creating, inserting and deleting
//                    from ordered arrays.
//                    Written for JamesM's kernel development tutorials.

#include "ordered_array.h"

s8int standard_lessthan_predicate ( type_t a, type_t b )
{
return ( a < b ) ? 1:0;
}

ordered_array_t create_ordered_array ( u32int max_size, lessthan_predicate_t less_than     )
{
ordered_array_t to_ret;
to_ret.array = ( void* ) kmalloc ( max_size * sizeof ( type_t ) ) ;
memset ( to_ret.array, 0, max_size*sizeof ( type_t ) );
to_ret.size = 0;
to_ret.max_size = max_size;
to_ret.less_than = less_than;
return to_ret;
}

ordered_array_t place_ordered_array ( void *addr, u32int max_size, lessthan_predicate_t   less_than )
{
ordered_array_t to_ret;
to_ret.array = ( type_t *) addr;
memset ( to_ret.array, 0, max_size*sizeof ( type_t ) );
to_ret.size = 0;
to_ret.max_size = max_size;
to_ret.less_than = less_than;
return to_ret;
}

void destroy_ordered_array ( ordered_array_t *array )
{
// kfree ( array -> array );
}

void insert_ordered_array ( type_t item, ordered_array_t *array )
{
ASSERT ( array -> less_than );
u32int iterator = 0;
---------------------------------------Faulting Line------------------------------------
while ( iterator < array -> size && array -> less_than ( array ->[iterator], item )    )
----------------------------------------------------------------------------------------

    iterator++;
if ( iterator == array -> size ) // just add at the end of the array.
    array -> array [array -> size++] = item;
else
{
    type_t tmp = array -> array[iterator];
    array -> array[iterator] = item;
    while ( iterator < array -> size )
    {
        iterator++;
        type_t tmp2 = array -> array[iterator];
        array -> array[iterator] = tmp;
        tmp = tmp2;
    }
    array -> size++;
}
}

type_t lookup_order_array ( u32int i, ordered_array_t *array )
{
ASSERT ( i < array -> size );
return array -> array [i];
}

void remove_ordered_array ( u32int i, ordered_array_t *array )
{
while ( i < array -> size )
{
    array -> array[i] = array -> array[i+1];
    i++;
}
array -> size--;
} 
```

知道为什么我会收到编译错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:41:43.620

`lessthen_predictable_t`没有在任何地方定义。

`array ->[iterator]`是错的。估计应该是`array->array[iterator]`吧？

# php - 只更新不为空的字段

> ID：10097924
> 
> 赞同：1
> 
> 时间：2012-04-10T23:31:13.160
> 
> 标签：php, mysql, null, dreamweaver

我一直在试图弄清楚只有在字段不为空时如何更新字段（否则 NULL 会覆盖未更改的字段）。字段不能为空并不重要。

我已经尝试过 COALESCE 和 ISNULL，但是我不能以正确的方式使用它们，因为我不习惯 Dreamweaver 编码。代码如下：

```
<i>if ((isset($_POST["MM_update"])) && ($_POST["MM_update"] == "catalogue")) {
  $updateSQL = sprintf("UPDATE catalogue SET catbox1=%s, catbox2=%s, catbox3=%s, catbox4=%s, catbox5=%s, catbox6=%s WHERE id=%s",
                       GetSQLValueString($_POST['catbox1'], "text"),
                       GetSQLValueString($_POST['catbox2'], "text"),
                       GetSQLValueString($_POST['catbox3'], "text"),
                       GetSQLValueString($_POST['catbox4'], "text"),
                       GetSQLValueString($_POST['catbox5'], "text"),
                       GetSQLValueString($_POST['catbox6'], "text"),
                       GetSQLValueString($_POST['id'], "int"));</i> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:33:42.707

您的代码中几乎没有错误，但这些可能是拼写错误。

1.  没有 PHP 包装器：您已将 mysqlcode 包含在部分中
2.  使用`IS NOT NULL`代替`ISNULL`

您尝试做的基本方法是使用这样的查询

```
UPDATE `tablename` SET `fieldName` = 'value' WHERE `fieldName` IS NOT NULL 
```

# linux - Mac OS X？Linux？X？侏儒？KDE？为什么 osx 被认为是 linux，为什么不被认为是 linux？

> ID：10097927
> 
> 赞同：0
> 
> 时间：2012-04-10T23:31:37.747
> 
> 标签：linux, macos

我不知道如何问这个问题，所以这里......

软件有时会说在所有“*nix”上都可用，这意味着 osx 和 linux，或者它可能会说在 linux 上可用而不是 mac，反之亦然。所以当我问是什么让它们相似/不同时，我想我是在问这些操作系统是由什么组成的，是什么让它们同时不同和相似。我在某处读到 mac osx 基于 bsd 以及一些关于 debian 和内核以及窗口管理器的东西......我只是很困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:33:17.950

OS X 不是 Linux。OS X 是 UNIX。

较低级别的系统 API 非常相似（在许多情况下相同） - C、'nix、POSIX 等。使用这些接口的程序可以很容易地移植到另一个程序（考虑在两者上兼容并且几乎不需要平台特定功能的库）。

当然有区别。OS X 内核是一个微内核（Darwin），而 Linux 是单片的。核心用户层之外的分歧发生得很快，尤其是在用户界面方面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:45:59.057

Linux 不是通用变体，Unix 是。Linux 是 Unix 的一种形式，BSD 的衍生产品（包括 OS X）、Solaris、AIX 和许多其他产品也是如此。

正式地说，是什么让 Unix 符合（并且最好是认证）Open Group 的 Unix 规范。然而，大多数 Unix 还提供超出该规范的功能（和标准功能），并且在该领域中您最常遇到兼容性问题，尽管设备驱动程序可用性和其他与操作系统接口不直接相关的问题作为出色地。

# mysql - 是否有一种性能友好的方式来列出数据库中每个字母的结果？

> ID：10097931
> 
> 赞同：2
> 
> 时间：2012-04-10T23:32:34.157
> 
> 标签：mysql, alphabet

我想为字母表中的每个字母创建一个包含几个结果的索引页面。

目前我有这个：

```
SELECT url_slug, name FROM artists WHERE name LIKE "A%" ORDER BY rand() LIMIT 10 
SELECT url_slug, name FROM artists WHERE name LIKE "B%" ORDER BY rand() LIMIT 10 
SELECT url_slug, name FROM artists WHERE name LIKE "C%" ORDER BY rand() LIMIT 10 
SELECT url_slug, name FROM artists WHERE name LIKE "D%" ORDER BY rand() LIMIT 10 
SELECT url_slug, name FROM artists WHERE name LIKE "E%" ORDER BY rand() LIMIT 10 
SELECT url_slug, name FROM artists WHERE name LIKE "F%" ORDER BY rand() LIMIT 10 
```

是否有另一种性能更友好的方法来实现这一目标？

Ps 我知道'order by rand()' 不是很好。但这只是在开发中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:54:43.697

出于您要达到的目的，该查询不会比该 IMO 更好。但是，如果表是巨大的，如果可能想要偶尔缓存表，单独保存一个固定字母的值。

并且索引，索引您的记录，根据字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:53:52.400

试一试，它对我的​​测试数据有效：

```
SELECT url_slug, name FROM artists WHERE name REGEXP '^[A-Z]'; 
```

--**更新**--

我得到一个查询，它将提取所有名称（无限制）并按字母分组，但没有限制，可能不值得。

```
# Note, you do not need the WHERE clause if you want all letters
# I left it in for dev testing
select GROUP_CONCAT(CONCAT(url_slug, ':', name)) AS list, substr(name, 1, 1) as letter from artists where name REGEXP '^[A-B]' group by letter; 
```

您可以做的是每隔几个小时发出一次这样的查询，并按字母缓存结果。不过我同意你的观点，我认为最好查询一次，而不是查询 26 次，只要你不为每个查询都提取一个巨大的结果集，我认为填充缓存是可以的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:54:46.853

我不是你所说的每个字母的“几个结果”的意思，但你是否有可能做这样的事情：

```
select left(name, 1), url_slug, group_concat(name) 
from artists 
group by left(name, 1); 
```

这让你每个字母都能找到所有的艺术家。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T00:58:09.590

表现不佳（26K 记录在我的上网本上需要 0.04 秒），但比您的 26 个查询有趣且略快 -

```
SELECT
    url_slug, name,
    IF( @prev <> LEFT(name, 1), @rownum := 1, @rownum := @rownum+1 ) AS rank,
    @prev := LEFT(name, 1)
FROM(
    SELECT * FROM artists ORDER BY LEFT(name, 1), RAND()
) tmp, (SELECT @rownum := NULL, @prev := '') init
HAVING rank <= 2 
```

# .net - 为什么不调用 BackgroundWorker.OnDoWork？

> ID：10097932
> 
> 赞同：0
> 
> 时间：2012-04-10T23:32:35.180
> 
> 标签：.net, vb.net, multithreading, .net-4.0, backgroundworker

我有一个用于长时间运行操作的作业对象，其工作方式如下：

```
Class LongRunningJob
    Inherits BackgroundWorker

    Protected Overrides Sub OnDoWork(ByVal e As System.ComponentModel.DoWorkEventArgs)
         'do long running job here
    End Sub
End Class 
```

我这样调用它：

```
 Dim job As New LongRunningJob

    'run it
    job.RunWorkerAsync() 
```

一年前这很好用，然后我开始做其他事情。我今天不得不返回这段代码，当我现在运行它时，`OnDoWork`根本没有调用覆盖。没有命中断点，没有写入调试消息，根本没有调用该方法，并且没有在任何地方引发错误。

我想不出有什么改变会导致这种情况，因为它看起来像是一个低级的框架。应用程序的其余部分加载并运行良好，主窗口显示（它是一个 WPF 应用程序），并且按钮单击事件触发。它只是不会触发的后台线程方法。这里会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T12:46:26.583

使用 BackgroundWorker 时的常见错误。毫无疑问，您忘记了检查异常。如果您不明确编写代码，它们会在没有诊断的情况下被整个吞下。使固定：

```
Protected Overrides Sub OnRunWorkerCompleted(ByVal e As RunWorkerCompletedEventArgs)
    If e.Error IsNot Nothing Then Throw e.Error
    MyBase.OnRunWorkerCompleted(e)
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T12:35:12.197

好吧，我想出了如何解决这个问题，尽管我不确定这里到底发生了什么。如果我将 OnDoWork 例程留空：

```
Protected Overrides Sub OnDoWork(ByVal e As System.ComponentModel.DoWorkEventArgs)
     'no code at all
End Sub 
```

它会被调用，如果我把基本框架的东西放在那里，它也会被调用。但是一旦我添加了这样的一行：

```
Dim result = AnotherLibrary.SomeMethod() 
```

该例程不会被调用。我查看`AnotherLibrary`了由我编写的项目，查看`Compile Tab`了`Target CPU`下拉列表，看到它说`x86`。我将其更改为`Any CPU`并解决了问题。但我仍然想知道这真正意味着什么以及它为什么会导致这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T18:07:59.867

我得到了一些答案，关于类似的问题。尝试将一些 dll 添加到我的项目（c#-wpf 的东西），使用托管对象的 c++ 代码包装器，当使用第二个时，我注意到了同样的问题。

就我而言，这是因为如果同一个库（版本 XX.4.1 和 XX.3.2），两个库使用不同的实例。在同一个库上编译两个库，一切正常。

# jquery - 如何禁用智能手机和平板电脑浏览器中的滚动？

> ID：10097937
> 
> 赞同：13
> 
> 时间：2012-04-10T23:33:38.237
> 
> 标签：jquery, iphone, scroll, smartphone

我使用以下代码禁用桌面浏览器中的滚动，但它不适用于 iPhone 屏幕分辨率。

```
$("html").css("overflow", "hidden"); 
```

我还需要添加什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-10T23:35:35.620

```
//target the entire page, and listen for touch events
$('html, body').on('touchstart touchmove', function(e){ 
     //prevent native touch activity like scrolling
     e.preventDefault(); 
}); 
```

如果阻止触摸事件对您不起作用，您总是可以这样：

```
html, body{
     max-width:100%;
     max-height:100%;
     overflow:hidden;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-22T18:46:25.907

我将提供一个不使用 jQuery 的片段，因此下一个“Javascripter”可以直接复制粘贴：

```
var defaultPrevent=function(e){e.preventDefault();}
document.body.parentElement.addEventListener("touchstart", defaultPrevent);
document.body.parentElement.addEventListener("touchmove" , defaultPrevent);
document.body.addEventListener("touchstart", defaultPrevent);
document.body.addEventListener("touchmove" , defaultPrevent); 
```

# utf-8 - 打印 UTF-8 字符串中的字符数

> ID：10097941
> 
> 赞同：4
> 
> 时间：2012-04-10T23:33:48.590
> 
> 标签：utf-8, lua

例如：

```
local a = "Lua"
local u = "Луа"
print(a:len(), u:len()) 
```

输出：

```
3   6 
```

如何输出 utf-8 字符串中的字符数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T07:33:53.623

如果需要在 Lua 中使用 Unicode/UTF-8，则需要使用外部库，因为 Lua 仅适用于 8 位字符串。一个这样的库是[slnunicode](https://github.com/LuaDist/slnunicode)。示例代码如何计算字符串的长度：

```
local unicode = require "unicode"
local utf8 = unicode.utf8

local a = "Lua"
local u = "Луа"
print(utf8.len(a), utf8.len(u)) --> 3    3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-14T11:40:39.680

在 Lua 5.3 中，您可以使用[`utf8.len`](http://www.lua.org/manual/5.3/manual.html#pdf-utf8.len)来获取 UTF-8 字符串的长度：

```
local a = "Lua"
local u = "Луа"
print(utf8.len(a), utf8.len(u)) 
```

输出：`3 3`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T00:16:08.863

你没有。

Lua 不支持 Unicode。它所看到的只是一串字节。当您询问长度时，它会为您提供该字节字符串的长度。如果您想使用 Lua 以某种方式与 Unicode 字符串进行交互，您必须编写一个实现这些交互的 Lua 模块或下载这样的模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T04:42:57.780

另一种选择是包装本机 os UTF-8 字符串函数并使用 os 函数来完成繁重的工作。这取决于您使用的操作系统——我已经在 OSX 上完成了这项工作，而且效果很好。Windows 将是类似的。当然，如果您只想从命令行运行脚本，它会打开另一个蠕虫 - 取决于您的应用程序。

# objective-c - 在 iOS 上使用委托进行 Kiwi 异步测试

> ID：10097943
> 
> 赞同：0
> 
> 时间：2012-04-10T23:33:57.540
> 
> 标签：objective-c, ios, xcode, ocunit

我正在尝试对异步组件进行 kiwi 测试。

我已经阅读了**kiwi wiki 注释**(http://www.kiwi-lib.info/mocks_and_stubs.html) 和关于异步的注释，以及他们为请求设置了块的示例。

现在，我有一个使用 ASIHTTPRequest 的类SensisAPIDataFetcher **，**[因此](https://github.com/amleszk/sensis-api-iphone/blob/master/Classes/SensisAPIDataFetcher.m)我需要我的规范文件来实现在**SensisAPIDataFetcher**中创建的委托，但由于规范没有头文件，我该怎么做？

 ****提前致谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-05T06:11:54.070

我已经在[此处](https://stackoverflow.com/questions/13616255/how-to-test-delegates-asynchronously-with-kiwi)发布了对您其他问题的答案，我认为这与您几个月后遇到的问题相同。****

# c++ - 在这种情况下，放入 decltype(x) 以指定返回类型的语法是什么

> ID：10097944
> 
> 赞同：1
> 
> 时间：2012-04-10T23:34:06.927
> 
> 标签：c++, c++11, auto, decltype

我有以下函数可以`std::vector`在另一个容器中创建一个迭代器：

```
template <typename T,
          template <typename, typename = std::allocator<T>> class Con>
std::vector<typename Con<T>::iterator> make_itervec(Con<T>& v)
{
    std::vector<typename Con<T>::iterator> itervec;
    for (auto i = v.begin(); i != v.end(); ++i)
    {
        itervec.push_back(i);
    }
    return itervec;
} 
```

我想做的是：

```
template <typename T,
          template <typename, typename = std::allocator<T>> class Con>
auto make_itervec(Con<T>& v) -> decltype(x) // This line
{
    std::vector<typename Con<T>::iterator> itervec;
    for (auto i = v.begin(); i != v.end(); ++i)
    {
        itervec.push_back(i);
    }
    return itervec;
} 
```

我该怎么做`x`才能让它发挥作用？

尝试但失败的尝试：

```
decltype(std::vector<typename Con<T>::iterator>)
decltype(std::vector<decltype(v)::iterator>) 
```

（另外，我不是这方面的专家，所以欢迎任何其他建议，评论！谢谢。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:44:43.087

我认为你在这里做的工作太多了。您需要做的就是：

```
template <typename T>
std::vector<typename T::iterator> make_itervec(T& v)
{
    std::vector<typename T::iterator> itervec;

    for (auto i = v.begin(); i != v.end(); ++i)
    {
        itervec.push_back(i);
    }

    return itervec;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T23:47:39.687

您可以使用`std::vector<decltype(v)::iterator>`或`std::vector<decltype(v.begin())>`。请注意，周围*没有* ，因为它已经是一种类型，而不是变量或表达式。仅用于获取表达式的类型。`decltype``std::vector``decltype`

# ios - 在 UIWebView 中管理垂直滚动

> ID：10097945
> 
> 赞同：4
> 
> 时间：2012-04-10T23:34:12.430
> 
> 标签：ios, uiwebview, scroll, rich-text-editor

我尝试通过`UIWebView`“正常”滚动操作获得可编辑的内容，以便当文本光标将被键盘隐藏时，`UIWebView`滚动以防止这种情况发生。我[使用](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html)我的`UIWebView`. 我还在网上发现了许多技巧，使用 ScrollView 属性/方法或 javascript 命令，但无法获得正常的滚动操作，例如`NSTextView`MacOS 上的任何操作。你知道这个问题的任何解决方案吗？

[已**编辑**] 得到了解决方案，并创建了一个由`NSTimer`. 要获得插入符号 Y 位置，应该选择活动元素，并插入一个虚拟节点。然后获取 node.offsetTop 属性给出 caretY。不要忘记删除节点...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:54:03.873

好的，这是 Apple 在他们的示例中执行此操作的方式（我不再记得是什么项目名称了）：

1.您注册键盘通知（键盘每次显示或隐藏时都会发送通知）：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(keyboardWasShown:)
                                             name:UIKeyboardDidShowNotification object:nil];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(keyboardWillBeHidden:)
                                             name:UIKeyboardWillHideNotification object:nil]; 
```

2.获取键盘的大小（您对高度感兴趣）并在视图中不包含该点时滚动：

```
- (void)keyboardWasShown:(NSNotification*)aNotification
{

NSDictionary* info = [aNotification userInfo];
CGSize kbSize = [[info objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;
    // If active text field is hidden by keyboard, scroll it so it's visible
CGRect aRect = self.view.frame;
aRect.size.height -= kbSize.height;

CGPoint point;

point = CGPointMake(0, activeTextField.frame.origin.y + activeTextField.frame.size.height);

if (!CGRectContainsPoint(aRect, point ))
{
    CGPoint scrollPoint = CGPointMake(0.0, activeTextField.frame.origin.y+activeTextField.frame.size.height-kbSize.height);
    [scrollView setContentOffset:scrollPoint animated:YES];
} 
```

不要忘记在隐藏键盘时进行反向操作，如果您推送到另一个视图控制器，请移除观察者。此示例与 UIScrollView 上的文本字段一起使用，但我相信您可以轻松适应它。

就个人而言，如果我还管理 Web 端，我更喜欢创建 320 像素宽的网页，设置我的 webView sizeToFit，将其添加到 UIScrollView 顶部并从那里管理滚动。对于 textFields，我只需使用 javascript 获取所选 textField 的容器并获取它的坐标。

# php - 收到数据后关闭 HTTP 连接

> ID：10097946
> 
> 赞同：1
> 
> 时间：2012-04-10T23:34:24.837
> 
> 标签：php, http

我正在使用 fsockopen 和 fwrite 发送和接收数据。我的应用程序收到了正确的响应，但似乎要等到某种超时才能继续。我怀疑在它完成接收响应后我没有正确关闭连接，这解释了等待。有人可以看看我的代码吗？

```
private static function Send($URL, $Data) {
            $server = parse_url($URL, PHP_URL_HOST);
            $port = parse_url($URL, PHP_URL_PORT);

            // If the parsing the port information fails, we will assume it's on a default port.
            // As such, we'll set the port in the switch below.
            if($port == null) {
                switch(parse_url($URL, PHP_URL_SCHEME)) {
                    case "HTTP":
                        $port = 80;
                        break;
                    case "HTTPS":
                        $port = 443;
                        break;

                }
            }

            // Check if we are using a proxy (debug configuration typically).
            if(\HTTP\HTTPRequests::ProxyEnabled) {
                $server = \HTTP\HTTPRequests::ProxyServer;
                $port = \HTTP\HTTPRequests::ProxyPort;
            }

            // Open a connection to the server.
            $connection = fsockopen($server, $port, $errno, $errstr);
            if (!$connection) {
                die("OMG Ponies!");
            }

            fwrite($connection, $Data);

            $response = "";
            while (!feof($connection)) {
                $response .= fgets($connection);
            }
            fclose($connection);

            return $response;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:40:01.457

问题在于这一行：

```
while (!feof($connection)) { 
```

套接字是流；除非对方*先*关闭连接，`feof`否则永远不会返回`true`，您的脚本最终会超时。

要执行有序关闭，双方必须关闭连接端；*他们中的一个*可以这样做作为对另一个的回应，但很明显，如果两者都在等待另一个先关闭，那么没有人会这样做。

对方程序输出东西后是否关闭连接？似乎没有。

# database-design - 关于级联恢复的软删除通用属性

> ID：10097948
> 
> 赞同：1
> 
> 时间：2012-04-10T23:34:31.733
> 
> 标签：database-design, theory, rdbms, cascade, soft-delete

软删除一般用什么类型的字段？这些中的任何一个，还有其他的吗？

```
bool IsDeleted // nice because the default value is 0 (no) just in case
date DateDeleted // is this a common one?
date DateCreated // more of a temporal db aspect
date DateModified // same with respect to created 
```

我问的原因是，在使用软删除时，仍必须实施级联以保持完整性。然而，真正的诀窍不是级联删除，这很容易。

`The trick is cascade restoring`. 在级联删除中，使用软删除方案，关系图中的所有记录都被标记为已删除、非活动，无论标志是什么，也许不同之处在于将 datedeleted 更改为 null 值。在级联恢复时，必须评估记录引用以查看它们被删除的原因是否是与正在恢复、重新激活、取消删除的记录相关的级联删除的结果。

如何处理存储数据的级联恢复操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T11:36:39.407

如果您不仅要跟踪发生的结果，还要跟踪*发生*的时间和*原因*，人们经常使用**事务日志**。

事务日志表通常具有以下列：事件的日期/时间、事件的性质（插入、更新、删除……）以及执行操作的用户和/或进程。事务日志和基表中受影响的记录之间也存在链接。这可以通过事务日志表的基表上的外键来完成，但更常见的是让事务日志包含基表的外键。如果事务日志表在各种基表之间共享，则需要一个基表指示符和一个基表外键。

在您的情况下，如果删除是主要问题，您可以将日志条目限制为删除，并区分级联删除与其他删除。您也可以（应该）考虑使用事务包装器来一次编写所有软删除（主要加级联）。您可以在日志中包含某种标识符，例如身份值或 GUID 作为“业务事务 ID”，并将此 ID 放入属于同一操作的每个条目中。这可以让您清楚地了解发生了什么、发生的时间、发生的原因以及发生在哪些记录上。您将能够使用此信息来决定如何撤消任何特定事务，包括执行级联恢复。

# codeigniter - Codeigniter 会话问题

> ID：10097952
> 
> 赞同：2
> 
> 时间：2012-04-10T23:34:56.620
> 
> 标签：codeigniter, session

我正在使用代码点火器。我对会话有一个奇怪的问题。当用户登录并将他重定向到新页面时，我设置了会话。我观察到会话有时已设置，有时未设置。我尝试使用带有 sess_use_database 变量 TRUE 和 FALSE 的 codeigniter 会话和本机会话。我不知道发生了什么。

这是配置文件的样子：

```
$config['sess_expiration']      = 7200;
$config['sess_expire_on_close'] = FALSE;
$config['sess_encrypt_cookie']  = TRUE;
$config['sess_use_database']    = TRUE;
$config['sess_table_name']      = 'ci_sessions';
$config['sess_match_ip']        = FALSE;
$config['sess_match_useragent'] = TRUE;
$config['sess_time_to_update']  = 7200; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T09:03:29.580

当会话数据在数据库中可用时，每次在用户的 cookie 中找到有效会话时，都会执行数据库查询以匹配它。如果会话 ID 不匹配，则会话被销毁。会话 ID 永远无法更新，只能在创建新会话时生成。

为了存储会话，您必须首先为此创建一个数据库表。

在您的数据库中创建它：

```
CREATE TABLE IF NOT EXISTS  `ci_sessions` (
    session_id varchar(40) DEFAULT '0' NOT NULL,
    ip_address varchar(16) DEFAULT '0' NOT NULL,
    user_agent varchar(120) NOT NULL,
    last_activity int(10) unsigned DEFAULT 0 NOT NULL,
    user_data text NOT NULL,
    PRIMARY KEY (session_id),
    KEY `last_activity_idx` (`last_activity`)
); 
```

何时进行配置并更改：

```
$config['sess_use_database']    = TRUE; 
```

我更喜欢将会话保存在数据库中，因为它更安全并且可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-23T00:53:55.940

我认为它只是没有按预期更新，它会在每个页面请求上创建一个新的。（常见的 Codeigniter 的设置问题）

**这是我的建议：**

仔细检查您的 Application/Config/config.php 文件，以确保如果您将站点托管在主目录上，则会话域的部分看起来像这样：

```
$config['cookie_prefix']    = "";
$config['cookie_domain']    = "yourdomain.com";
$config['cookie_path']  = "var/sessions/";
$config['cookie_secure']    = FALSE; 
```

如果您将站点托管在子目录中，就像这样：

```
$config['cookie_prefix']    = "";
$config['cookie_domain']    = "yourdomain.com";
$config['cookie_path']  = "siteSubDirectory/var/sessions/";
$config['cookie_secure']    = FALSE; 
```

并且通过将它们的权限固定为755左右来确保这2个目录是可写的，我强烈建议您启用数据库会话，它更安全，并且可以通过检查会话表来帮助您找出真正的问题。祝你好运 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T00:07:01.053

您的 sess_cookie 设置在哪里？我在那里没看到？

```
$config['sess_cookie_name']     = 'cookiename';
$config['sess_expiration']      = 7200;
$config['sess_expire_on_close'] = FALSE;
$config['sess_encrypt_cookie']  = TRUE;
$config['sess_use_database']    = TRUE;
$config['sess_table_name']      = 'ci_sessions';
$config['sess_match_ip']        = FALSE;
$config['sess_match_useragent'] = TRUE;
$config['sess_time_to_update']  = 7200; 
```

确保您选择的任何 cookie 名称都没有下划线。IE：

```
$config['sess_cookie_name'] = 'mycookie';   // good
$config['sess_cookie_name'] = 'my_cookie';   // bad 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-13T16:31:01.750

尝试`$config['sess_match_useragent'] = FALSE;`

我在会话和重定向方面遇到了同样的问题，我已经破解了我的 cms 以找出导致这种情况的原因。在 config.php 中设置它对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-16T09:29:02.593

有同样的问题，我发现它有什么

```
 $config['sess_encrypt_cookie']  = TRUE;
    $config['sess_use_database']    = TRUE; 
```

将在会话表中插入 2 条记录，第一条记录有数据，第二条记录没有任何内容，因此无法访问会话数据。当你改变

```
 $config['sess_encrypt_cookie']  = FALSE; 
```

为 false 它只会将一条记录插入到会话表中，其中包含所有数据，并且所有数据都对世界正确 :)

# android - (Android MediaPlayer) 如果 MediaPlayer.create() 隐式调用 prepare()，我应该如何调用 setAudioStreamType()？

> ID：10097954
> 
> 赞同：12
> 
> 时间：2012-04-10T23:35:16.090
> 
> 标签：android, android-mediaplayer

我正在编写一个使用服务来播放警报音的 Android 警报应用程序。目前，我可以播放音频，但它以可以通过调低设备音量来静音的形式播放。因此，我试图添加一个调用`setAudioStreamType(AudioManager.STREAM_ALARM);`来防止这种情况。

我`onStartCommand()`的服务功能如下：

```
MediaPlayer mMP;    
@Override
    public int onStartCommand(Intent intent, int flags, int startId)
    {
        try
        {
            mMP = MediaPlayer.create(this, R.raw.alarm);
            mMP.setAudioStreamType(AudioManager.STREAM_ALARM);
            mMP.setLooping(true);
            //mMP.prepare(); commented out since prepare() is called in create
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }
        if (mMP != null) mMP.start();

        return START_STICKY;
    } 
```

我的问题是调用 setAudioStreamType()，MediaPlayer 永远不会播放音频。如果我注释掉那条线，音频就会播放。

输入该行后，我收到以下运行时错误：

> 04-10 19:32:03.115: E/MediaPlayer(3411): setAudioStream 在状态 8 中调用
> 
> 04-10 19:32:03.115: E/MediaPlayer(3411): 错误 (-38, 0)
> 
> 04-10 19:32:03.115: E/MediaPlayer(3411): 在状态 0 中开始调用
> 
> 04-10 19:32:03.115: E/MediaPlayer(3411): 错误 (-38, 0)
> 
> 04-10 19:32:03.115: E/MediaPlayer(3411): 错误 (-38,0)
> 
> 04-10 19:32:03.115: E/MediaPlayer(3411): 错误 (-38,0)

一些研究（我现在找不到链接）告诉我，`setAudioStreamType()`在被调用后无法`prepare()`调用，并且`create()`隐式调用`prepare()`.

无论如何，如果`setAudioStreamType()`没有这样的错误，我应该怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-10T23:46:25.763

您可以调用`mp.reset()`然后设置流类型、数据源，然后进行准备。或者只使用默认构造函数并自己处理初始化。

编辑：

```
Resources res = getResources();
AssetFileDescriptor afd = res.openRawResourceFd(R.raw.alarm);

mp.reset();
mp.setAudioStreamType(AudioManager.STREAM_ALARM);
mp.setLooping(true);
mp.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
mp.prepare();
mp.start(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-16T16:29:09.237

接受的答案是抛出*IllegalStateException*。这是有效的

```
MediaPlayer mediaPlayer = new MediaPlayer();

try {
  mediaPlayer.setDataSource(
          this,
          getCustomToneUri()
  );

  mediaPlayer.setAudioStreamType(AudioManager.STREAM_NOTIFICATION);

  mediaPlayer.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {
    @Override
    public void onPrepared(MediaPlayer mp) {
      mp.start();
    }
  });

  mediaPlayer.prepareAsync();
} catch (IOException e) {
  e.printStackTrace();
} 
```

# jquery - jquery内容滑块，控制速度？

> ID：10097958
> 
> 赞同：0
> 
> 时间：2012-04-10T23:35:43.923
> 
> 标签：jquery, slider

我正在使用一个非常轻的 jquery 内容滑块，但不知道如何控制动画的速度。它目前非常快，我需要放慢速度。恐怕 jquery 对我来说是一个新领域，尽管尝试了几种方法，但我无法让它工作。任何帮助将不胜感激。这是我的代码：

```
$(document).ready(function (){
    $('#button a').click(function(){
        var integer = $(this).attr('rel');
        $('#myslide .cover').animate({left:-960*(parseInt(integer)-1)})
        $('#button a').each(function(){
            $(this).removeClass('active');
            if($(this).hasClass('button'+integer)){
                $(this).addClass('active')
            }
        }); 
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:38:52.203

```
 $('#myslide .cover').animate({left:-960*(parseInt(integer)-1)});

 //change to
                                                                 //speed in ms
 $('#myslide .cover').animate({left:-960*(parseInt(integer)-1)}, 1000); 
```

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)这里是 .animate jQuery 语法。1000ms == 1 秒，换个数来尝尝。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:39:02.750

您必须向[.animate()](http://api.jquery.com/animate/)添加一个参数，例如：

```
.animate({left:-960*(parseInt(integer)-1)},5555) 
```

css 将在 5555 毫秒后获得。

# vbscript - 有没有办法让 QTP 中的 OptionalStep 快速超时？

> ID：10097961
> 
> 赞同：1
> 
> 时间：2012-04-10T23:36:22.293
> 
> 标签：vbscript, timeout, automated-tests, qtp, gui-testing

在我的自动化测试中，我有一个偶尔出现的区域（当它出现时需要点击）。这是使用 OptionalStep 前缀的理想场所，以防止在可选区域从未出现时步骤失败。

问题是，我希望 OptionalStep 在继续测试的其余部分之前只等待一两秒钟。就像我可以让 object.Exist(2) 只等待 2 秒一样，有没有办法让 OptionalStep 只等待几秒钟？

其他一些注意事项：

*   我想把它保留为一小行。我知道我可以创建一个在 If/Then 语句中使用 object.Exist(2) 的多行逻辑测试，但我宁愿让代码小而精巧。
*   我不想仅仅为这一步更改全局 20 秒超时。
*   由于此可选步骤仅出现在一个特定区域，因此在整个测试过程中运行恢复方案似乎不是一个好的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T17:08:30.607

Vitaly 的评论将是一个很好的解决方案，因为您可能会不必要地过度复杂化您的测试。

也不建议使用如此长的全局超时，并且应该尽可能低。我通常将其设置为 3 秒左右并处理代码中的同步。

任何需要很长时间的事情都应该预先知道并在代码中处理。当大多数对象无法找到错误发生时，为所有内容设置全局超时将导致您的测试运行不必要的缓慢。

# java - 在java中访问robots.txt文件

> ID：10097971
> 
> 赞同：0
> 
> 时间：2012-04-10T23:38:34.213
> 
> 标签：java, web-crawler, robots.txt

我是java新手。我想做一个简单的网络爬虫。如何访问java中网站的robots.txt文件。实际上我对robots.txt不太了解。请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:52:21.273

你需要解决两个任务：

1.  使用 HTTP 库通过 HTTP 获取文件——[如何在 Java 中发送 HTTP 请求？](https://stackoverflow.com/questions/1359689/how-to-send-http-request-in-java)
2.  为 robots.txt 文件编写或使用解析器[——robots.txt parser java](https://stackoverflow.com/questions/3141031/robots-txt-parser-java)

# javascript - 链接来自单独文档的代码以在另一个页面上工作

> ID：10097980
> 
> 赞同：0
> 
> 时间：2012-04-10T23:39:38.763
> 
> 标签：javascript

我从我制作的网页文档中获取脚本，并保存到扩展名为*.js*的记事本文档中。

我现在想知道如何从我创建的当前页面引用这个 .js 文件，以便脚本将在该页面上运行，而没有实际代码，只有参考链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:44:24.303

像这样的东西？

```
<script type="text/javascript" src="myfile.js" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:47:42.317

你需要做：

```
<script type="text/javascript" src="URI_TO_DIR/extension.js"></script> 
```

请参阅有关嵌入 javascript 文件的[此页面](http://www.w3.org/TR/html4/interact/scripts.html)

如果脚本在您的计算机上，那么它当然无法在网络上访问，因为您需要网络服务器或网络空间

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:48:03.563

您可以使用带有 src 属性的脚本标记来包含外部 JavaScript。例如， `<script type="text/javascript" src="javascriptfile.js"></script>`应该做我认为你要求的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T23:44:45.473

它必须是参考链接。除了标准之外，还有其他的技术，但都依赖于联动。你无法击败联动。你不能停止联动。你必须屈服于这种联系。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T23:42:00.160

这不是网络的运作方式吗？当页面加载时，您可能可以使用某种开发人员工具从文件中执行任意 javascript，但这只会覆盖 Web 的默认工作方式。

# bash - 在makefile中执行命令

> ID：10097983
> 
> 赞同：0
> 
> 时间：2012-04-10T23:40:10.680
> 
> 标签：bash, makefile, gnu-make

我正在我的 makefile 中执行以下命令。当我必须打开 file2 时，它给了我一个错误。换句话说，如果基于我选择的开关在 file1.c 中有任何更改，则 make 在这一行完全失败。

```
unifdef -DSW1 -DSW2 -USW3 file1.c >file2.c 
```

好的，unifdef 是一个为我进行部分预处理的实用程序。file1.c 是 unifdef 的输入，file2.c 是输出。我的 makefile 简单明了，我对 file1.c 或 file2.c 没有任何依赖关系。Makefile 依赖项工作正常。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T10:58:47.890

默认情况下，如果 unifdef 对输入文件进行任何更改，则会以状态码 1 退出。Make将此视为失败。您可以通过在命令前加上 - 来告诉 make 忽略退出状态

unifdef 2.7 版（2013 年 3 月发布）有一个 -x 选项来控制退出状态逻辑，因此它与 make 配合得更好。您可能想要使用 -x1 以便 make 确保 unifdef 确实进行了更改。见[http://dotat.at/prog/unifdef/](http://dotat.at/prog/unifdef/)

# css - Chrome 扩展 - 防止 CSS 被过度写入

> ID：10097988
> 
> 赞同：9
> 
> 时间：2012-04-10T23:40:38.380
> 
> 标签：css, google-chrome-extension

我正在编写一个 Chrome 扩展程序，其中一个小面板出现在现有网站的顶部。当我访问某些网站时，我注意到我的面板的 CSS 已被网站的 CSS 覆盖。我目前正在使用[Eric Meyer 的 CSS Reset](http://meyerweb.com/eric/tools/css/reset/)，但它似乎没有起到作用。还有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T05:15:58.013

这是一个带有 iframe 的漂亮“hack”，您实际上并没有实例化 iframe：

1.  将 iframe 附加到 DOM，这将是你爸爸的容器
2.  进入 iframe 并将您的 HTML 代码添加到正文的 innerHTML

它看起来像这样：

```
var iframe = document.createElement('iframe');
document.documentElement.appendChild(iframe); //fastest way to append to DOM: http://jsperf.com/insertbefore-vs-appendchild/2
iframe.contentDocument.body.innerHTML = '<a href="yomama.com">Normal link!!</a>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:46:39.643

我不熟悉 Chrome 扩展程序本身。但是您可以尝试在“id”内确定您的面板范围：

```
<div id='my-panel'>
  PANEL GOES HERE
</div> 
```

然后在 CSS`#my-panel`中将其作为所有 CSS 的第一个选择器。采取重置 css 并将`#my-panel`标识符添加到那里定义的每个元素。可能很乏味......但会确保您重置所有元素，并几乎保证它们将以比网站可能定义的任何内容更高的优先级重置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-06T02:01:17.373

我刚刚写的一个扩展遇到了类似的问题。我已经让它们中的大多数消失了，但不是全部。我想我知道为什么，但我还没有解决异常（这只是现在的学校作业）。

这是我发现的：当通过扩展清单或后台页面注入样式表时，它被视为用户样式表，仅赋予它比默认浏览器样式表级联的优先级。至少在我的经验中，将`!important`指令添加到您的规则中无济于事。用户样式表（由扩展或手动添加）可以包含`!important`指令，但由于某种原因，Chrome 不支持它们——只需检查它们在 Chrome DevTools 中的显示方式，没有`!important`. 添加`id`属性也无济于事，因为特异性只会在优先级相等的情况下胜过。

什么对我有用：

```
var ninjaCSS = document.createElement("link");
ninjaCSS.setAttribute("rel", "stylesheet");
ninjaCSS.setAttribute("type", "text/css");
ninjaCSS.setAttribute("href", chrome.extension.getURL('ninja.css'));
document.getElementById("head").appendChild(ninjaCSS); 
```

此代码包含在清单中作为内容脚本列出的 JavaScript 文件中，应在文档加载时运行。CSS 文件未在清单中列出，但包含在扩展文件夹中。现在样式表与其他作者的样式表处于同等地位。

当然，这仅仅是开始。您现在可以为面板中的所有元素赋予一个`id`属性（您可能已经拥有）。是否使用样式重置取决于您。但是您必须确保您的样式指定了野外样式表可能试图操纵的每条规则。如果您不打算更改规则的默认值，您仍必须指定该默认值。即使默认值为“无”；

最后，您必须勇敢地忽略所有关于该`!important`指令最好谨慎使用的警告。正好相反。当您添加`!important`到每个样式规则时，就面板的级联而言，就好像您根本没有使用它一样。另一方面，您现在将成为小组的老板。相信我，有人会根据`!important`他们的`button:hover background-image`规则制定指令。引导您精心制作的按钮莫名其妙地变成 1985 年 bon jovi 音乐会的音乐会图像 - 但只有当鼠标悬停时，所以不用担心，对吧？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T03:43:26.853

`appendChild`解决方案对我有用（Devin G Rhode 和 jCyCle 的答案）。但我注意到这些解决方案只是添加了属性`xmlns="http://www.w3.org/1999/xhtml"`。所以我只是通过将这个 xmlns 属性添加到我的链接标签（直接，不使用 JS）来测试我的代码，它也可以工作，不知道为什么。

失败：

```
<link rel="stylesheet" type="text/css" href="filesystem:chrome-extension://................/temporary/Content/Styles/style.css" /> 
```

在职的：

```
<link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="filesystem:chrome-extension://.............../temporary/Content/Styles/style.css" /> 
```

# c# - 如何使用文件 URL 机制在 Metro 中播放音乐

> ID：10097989
> 
> 赞同：2
> 
> 时间：2012-04-10T23:40:48.190
> 
> 标签：c#, xaml, media, windows-8, microsoft-metro

我需要使用文件 URL 播放音乐库文件，我将在 XAML c# 对象中将其设置为 MediaPlayer 对象。

我构造了URI如下

```
StorageFile file = await KnownFolders.MusicLibrary.GetFileAsync(track.Id);

return new Uri("file:///" + file.Path); 
```

URI 如下所示：streamingUri = {file:///C:/Users/user/Music/04 - A Train Makes A Lonely Sound.mp3}

我需要基于 URL 的方案来播放，以便我也可以为网络流重用相同的逻辑。

我该如何进行这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T16:33:29.513

看看 [这个样本](http://code.msdn.microsoft.com/windowsapps/Basic-Media-Playback-003619be)。它应该给你一些关于如何从文件进行媒体播放的想法。

虽然我注意到您说您需要基于 URI，但您应该为本地文件使用流。您需要提取的唯一部分是设置 MediaElement 的源的调用。您可以只创建一个具有 2 个覆盖的函数，它应该相对干净。

因此，对于网络流：

```
void SetMediaElementSource(Uri webStreamUri)
{ 
    MyMediaElement.Source = webStreamUri;
} 
```

对于本地文件：

```
void SetMediaElementSource(StorageFile file)
{
    var stream = await file.OpenAsync(Windows.Storage.FileAccessMode.Read); 
    MyMediaElement.SetSource(stream, file.ContentType); 
} 
```

# ruby-on-rails - Rails config.assets.precompile 设置处理 app/assets 中的所有 CSS 和 JS 文件

> ID：10097993
> 
> 赞同：33
> 
> 时间：2012-04-10T23:41:14.203
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sprockets

我希望预编译项目`app/assets`文件夹中的所有 CSS 和 JS 文件。我不想预编译 vendor/assets 或 lib/assets 中的所有内容，只需要根据需要预编译我的文件的依赖项。

我尝试了以下通配符设置，但它错误地预编译了所有内容。这会导致大量额外工作，甚至在使用 bootstrap-sass 时导致编译失败。

```
config.assets.precompile += ['*.js', '*.css'] 
```

我最好的选择是只处理我的文件`app/assets`？谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-31T07:56:25.673

`config.assets.precompile = ['*.js', '*.css']`

这将编译资产路径中的任何 JavaScript 或 CSS，无论目录深度如何。通过[这个答案](https://stackoverflow.com/questions/7278029/rails-3-1-asset-precompilation-include-all-javascript-files#comment8996769_7327825)找到。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-04-11T16:39:16.980

由于 sprockets 使用不包括底层未编译资源所在位置的逻辑路径，因此这项任务变得更加困难。

假设我的项目有 JS 文件“/app/assets/javascripts/foo/bar.js.coffee”。

sprockets 编译器将首先确定输出文件扩展名，在本例中为“.js”，然后评估是否编译逻辑路径“foo/bar.js”。未编译的资源可能位于“app/assets/javascripts”、“vendor/assets/javascripts”、“lib/assets/javascripts”或 gem 中，因此无法根据逻辑路径包含/排除特定文件独自的。

要确定底层资源的位置，我认为有必要询问 sprockets 环境（可通过对象 Rails.application.assets 获得）以在给定逻辑路径的情况下解析资源的真实路径。

这是我正在使用的解决方案。我对 Ruby 很陌生，所以这不是最优雅的代码：

```
# In production.rb
config.assets.precompile << Proc.new { |path|
  if path =~ /\.(css|js)\z/
    full_path = Rails.application.assets.resolve(path).to_path
    app_assets_path = Rails.root.join('app', 'assets').to_path
    if full_path.starts_with? app_assets_path
      puts "including asset: " + full_path
      true
    else
      puts "excluding asset: " + full_path
      false
    end
  else
    false
  end
} 
```

* * *

对于 sprockets > 3.0，这在生产环境中不起作用，因为 Rails.application.assets 将为 nil（假设默认值：config.assets.compile = false）。

要解决此问题，请将**full_path**分配替换为：

```
@assets ||= Rails.application.assets || Sprockets::Railtie.build_environment(Rails.application)
full_path = @assets.resolve(path) 
```

另见：[https ://github.com/rails/sprockets-rails/issues/237](https://github.com/rails/sprockets-rails/issues/237)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-09-24T21:50:05.500

对 techpeace 的回答稍作调整：

`config.assets.precompile = ['*.js', '*.css', '**/*.js', '**/*.css']`

我会在他的回答中添加评论，但我还没有足够的声誉。给我一个upvote，我会在那里！

注意：这也将预编译通过 ruby​​gems 包含的所有 CSS/JavaScript。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-04-11T04:06:48.107

我在rails代码中找到了这个：

```
@assets.precompile               = [ Proc.new{ |path| !File.extname(path).in?(['.js', '.css']) },
                                     /(?:\/|\\|\A)application\.(css|js)$/ ] 
```

这是由rails指南支持的：

> 编译文件的默认匹配器包括 application.js、application.css 和所有非 JS/CSS 文件

如果使用 ，则不会重置此默认值`+=`，因此您需要使用 a`=`而不是覆盖它`+=`。请注意，显然，您可以将 Proc 或正则表达式传递给`precompile`扩展名。我相信，如果您只想预编译顶级目录中的文件，则必须创建一个正则表达式，例如：

```
config.assets.precompile = [ /\A[^\/\\]+\.(ccs|js)$/i ] 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-03-06T06:25:32.870

我在 2017 年重温这篇文章。

我们的产品仍然大量使用 RoR，我们一直在通过`Rails.application.config.assets.precompile`添加新模块来不断修改我们的预编译配置。最近我试图通过添加一个正则表达式模式来优化它，我发现以下 glob 模式有效：

```
Rails.application.config.assets.precompile += %w(**/bundle/*.js) 
```

但是我仍然需要排除某些模块，所以我努力使用正则表达式而不是 glob。

在我查看 sprockets 源代码：[https](https://github.com/rails/sprockets-rails/blob/master/lib/sprockets/railtie.rb#L108) ://github.com/rails/sprockets-rails/blob/master/lib/sprockets/railtie.rb#L108 之前，我发现他们已经在使用正则表达式：

```
app.config.assets.precompile +=
  [LOOSE_APP_ASSETS, /(?:\/|\\|\A)application\.(css|js)$/] 
```

所以我把我的代码改成：

```
Rails.application.config.assets.precompile +=
  [/^((?!my_excluded_module)\w)*\/bundle\/\w*\.js$/] 
```

哪个效果很好。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-03-16T10:23:38.613

这将获取所有`.css` `.scss`并`.js`包括子目录中的所有文件。

```
js_prefix    = 'app/assets/javascripts/'
style_prefix = 'app/assets/stylesheets/'

javascripts = Dir["#{js_prefix}**/*.js"].map      { |x| x.gsub(js_prefix,    '') }
css         = Dir["#{style_prefix}**/*.css"].map  { |x| x.gsub(style_prefix, '') }
scss        = Dir["#{style_prefix}**/*.scss"].map { |x| x.gsub(style_prefix, '') }

Rails.application.config.assets.precompile = (javascripts + css + scss) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-21T22:41:45.977

我希望编译来自 /app 和 /vendor 的所有资产，除了部分（名称以下划线 _ 开头）。所以这是我在 application.rb 中的条目版本：

```
config.assets.precompile << Proc.new { |path|
  if path =~ /\.(css|js)\z/
    full_path = Rails.application.assets.resolve(path).to_path
    app_assets_path = Rails.root.join('app', 'assets').to_path
    vendor_assets_path = Rails.root.join('vendor', 'assets').to_path

    if ((full_path.starts_with? app_assets_path) || (full_path.starts_with? vendor_assets_path)) && (!path.starts_with? '_')
      puts "\t" + full_path.slice(Rails.root.to_path.size..-1)
      true
    else
      false
    end
  else
    false
  end
} 
```

此外，它还输出为调试目的而编译的文件列表...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-16T20:29:13.853

此片段包括所有 js/css 文件，**不包括 gems**，位于：app/assets、**vendor/assets**、**lib/assets**下，除非它们是部分文件（例如“_file.sass”）。它还有一个策略来包含来自 Gems 的资产，这些资产并未包含在每个页面中。

```
 # These assets are from Gems which aren't included in every page.
    # So they must be included here
    # instead of in the application.js and css manifests.
    config.assets.precompile += %w(a-gem.css a-gem.js b-gem.js)

    # This block includes all js/css files, excluding gems,
    # under: app/assets, vendor/assets, lib/assets
    # unless they are partial files (e.g. "_file.sass")
    config.assets.precompile << Proc.new { |path|
      if path =~ /\.(css|js)\z/
        full_path = Rails.application.assets.resolve(path).to_path
        aps = %w( /app/assets /vendor/assets /lib/assets )
        if aps.any? {|ap| full_path.starts_with?("#{Rails.root}#{ap}")} &&
            !path.starts_with?('_')
          puts "\tIncluding: " + full_path.slice(Rails.root.to_path.size..-1)
          true
        else
          puts "\tExcluding: " + full_path
          false
        end
      else
        false
      end
    } 
```

虽然，您可能不想这样做，因为您可能会两次预编译 gem 资产（基本上任何在 application.js 或 css 中已经 \=require'd 的东西）。此片段包括所有 js/css 文件，**包括 gems**，位于：app/assets、**vendor/assets**、**lib/assets**下，除非它们是部分文件（例如“_file.sass”）

```
# This block includes all js/css files, including gems, 
# under: app/assets, vendor/assets, lib/assets
# and excluding partial files (e.g. "_file.sass")
config.assets.precompile << Proc.new { |path|
  if path =~ /\.(css|js)\z/
    full_path = Rails.application.assets.resolve(path).to_path
    asset_paths = %w( app/assets vendor/assets lib/assets)
    if (asset_paths.any? {|ap| full_path.include? ap}) && 
        !path.starts_with?('_')
      puts "\tIncluding: " + full_path
      true
    else
      puts "\tExcluding: " + full_path
      false
    end
  else
    false
  end
} 
```

# c# - 我想了解 @Html.DisplayFor(modelItem => item.FirstName) 中的 lambda 表达式

> ID：10097995
> 
> 赞同：53
> 
> 时间：2012-04-10T23:41:22.250
> 
> 标签：c#, asp.net-mvc, razor, lambda, html-helper

我是 C# 和 MVC 的新手，并且在某些场合使用过 lambda，例如匿名方法和 LINQ。

通常我看到的 lambda 表达式看起来像这样：

```
(x => x.Name), (x => { Console.WriteLine(x)) 
```

我知道 lambda =“去”。我从未见过不使用 left 参数的 lambda 表达式。

我不知道如何翻译这个 lambda 表达式

```
@Html.DisplayFor(modelItem => item.FirstName) 
```

任何人都可以为我阐明这一点吗？这不应该是

```
(modelItem => modelItem.FirstName)? 
```

我从 Microsoft 的[Introduction to ASP.NET MVC 教程](http://www.asp.net/mvc/tutorials/mvc-5/introduction/accessing-your-models-data-from-a-controller)中得到了这个。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-04-11T00:20:42.663

lambda 表达式是一种编写匿名函数的方法，即没有名称的函数。“箭头”左侧是函数参数，右侧是函数体。因此，逻辑上转换为类型之类的`(x => x.Name)`东西，并且显然会有所不同并从上下文中派生出来。`string Function(Data x) { return x.Name }``string``Data`

左侧参数的缺失转换为没有参数的函数，因此这在`(() => someVariable)`逻辑上转换为：`string Function() { return someVariable; }`

此时你可能会开始疑惑，`someVariable`它从何而来，它不是函数参数，也没有在函数中定义。你是对的，这样的函数永远不会编译。然而，像这样的 lambda 函数非常好，因为它允许以这种方式提升和使用外部范围变量。（在内部创建了一个包装类，其中 lambda 表达式中使用的变量成为字段。）

现在让我们看看是什么`model => item.FirstName`意思。从逻辑上讲，它会转换为`string Function(Model model) { return item.FirstName; }`. 基本上这是一个带参数的函数，但没有用到这个参数。

现在，最后一点信息。尽管 lambda 表达式最终代表函数，但有时创建它们的目的并不是为了实际执行（尽管它们可能可以）。lambda 表达式可以用表达式树的形式表示。这意味着它可以被*解析*而不是执行它。

在这种特殊情况下，MVC 引擎不会*运行*lambda 表达式所代表的函数。而是*解析*表达式，以便 MVC 引擎知道要为该特定行发出什么 html。如果您的数据项不是直接来自模型对象，则 lambda 表达式的左侧部分无关紧要。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-11T00:25:25.307

我认为这是关于 foreach 循环。例子：

```
@foreach(var item in model) 
{ 
 <td> 
     @html.displayfor(model => item.firstName) </td>
 </td>     
} 
```

`var item`需要使用，因为序列中的每一项都是匿名类型。 `model => item.firstName`意味着`(input parameter) => expression`。您不能使用输入参数，因为我们将当前“项目”存储在`item`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-10T23:48:39.927

它使用的是无参数的lambada。看到这个[问题](https://stackoverflow.com/questions/424775/is-there-a-better-way-to-express-a-parameterless-lambda-than)

基本上 DisplayFor 不使用 lambda 函数参数模型（它可以是我所说的使用 _ 或 () 的任何东西），而只是在 for 循环中使用 lambda 函数来针对它使用 displayfor。DisplayFor 需要一个 lambda 函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-07T06:49:18.203

我也费了很大劲才理解 Visual Studio 生成的代码。我不想提供关于 lambda 表达式的一般解释，而是想使用 ASP.NET MVC 框架放置一个上下文。

假设我们准备了一个具有 2 个属性的模型类（例如 Destination）：City 和 ProvinceCode。

```
public class Destination
{
    public string City { get; set; }
    public string ProvinceCode { get; set; }
} 
```

生成控制器和视图后，我们应该如前所述通过 Visual Studio 获取生成的代码。然而，生成的代码有点难以理解，尤其是对于数据行

```
@Html.DisplayFor(modelItem => item.City) 
```

我只是*猜测*MVC 团队应该认为 Html 辅助类应该在 cshtml 文件中始终使用。因此，他们尝试使用技巧来通过 C# 编译器。在这种情况下，modelItem 甚至没有用作这个 lambda 表达式的输入参数。我们不能使用 () 因为类型**不**正确。这就是为什么如果我们替换**模型**或任何模型对象，lambda 表达式就可以工作。

老实说，我想以更易读的形式重写生成的代码。我们可以简单地呈现正确的输出，而不是使用**Html**帮助器类，如下所示：

```
@foreach (var item in Model) {
<tr>        
    <td>  
        @* Code Generated by Visual Studio. modelItem is a dummy param *@
        @Html.DisplayFor(modelItem => item.City)
    </td>
    <td>
        @* A better way - simply get rid of Html helper class *@
        @item.ProvinceCode
    </td>
</tr>
} 
```

# php - Is htmlspecialchars required if you are not outputting html?

> ID：10097996
> 
> 赞同：1
> 
> 时间：2012-04-10T23:41:29.617
> 
> 标签：php, xss

I have a script that registers users based on their user input. This uses prepared statements plus whitelists to prevent sql injection. But I am struggling to understand the prevention of XSS.

From what I understand, you only need to prevent XSS if you are outputting HTML onto the page? What does this mean???

Im guessing that with this register page it doesn't apply because I am not outputting HTML to the web page? Is that right?

If I was to prevent XSS, do I use htmlspecialchars?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:46:40.897

Generally correct, if you are having any returned values show up on the page, or if you are inserting information into the database for later retrieval and display (like user profile information) you will want to use htmlspecialchars.

For me, when I do my user registration, if they fail to enter a correct value in an input field, I redisplay the page with the values they entered. In this case, I have it encoded with htmlspecialchars.

If at any point ever, you plan on redisplaying the information from the DB into a webpage (as mentioned with profiles and the like) you should use htmlspecialchars.

Better safe than sorry I always say - **never** trust user input

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T23:45:46.273

Basically, XSS happens when you are taking the user's input un-sanitized and display in your webpage.

For example: A user inputs

```
<script>alert('hello you are hacked');</script> 
```

In a text box, and you show this in your webpage after it is registered like

```
Hello, $username 
```

This suddenly gets turned into

```
Hello, <script>alert('hello you are hacked');</script> 
```

This is one of the form of XSS

* * *

One of a effiecient way to prevent XSS is like this

```
echo htmlspecialchars($varname, ENT_QUOTES, 'UTF-8'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:50:09.587

> From what I understand, you only need to prevent XSS if you are outputting HTML onto the page? What does this mean???

XSS is an attack carried out by the server outputting HTML (in practice, Javascript) to the client when it did not mean to do so (and obviously when that HTML was specially crafted and supplied by a hostile user).

> Im guessing that with this register page it doesn't apply because I am not outputting HTML to the web page? Is that right?

If you are not outputting *anything that comes from user input* you are safe.

> If I was to prevent XSS, do I use `htmlspecialchars`?

Yes, that is sufficient.

# windows-8 - 使用 WinJS 绑定多个 HTML 属性？

> ID：10097998
> 
> 赞同：1
> 
> 时间：2012-04-10T23:41:32.690
> 
> 标签：windows-8, microsoft-metro, winjs

WinJS 允许您在运行时动态绑定 HTML 属性，类似于 XAML 绑定。

```
<div id="itemTemplate" data-win-control="WinJS.Binding.Template"...>
    <h3 data-win-bind="innerText: timestamp"></h3>
</div> 
```

如果我还想绑定字体颜色样式`<h3>`，我该如何实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T23:43:44.977

与`data-win-options`使用`{key:value,key2:value2}`语法的绑定不同。`data-win-binding`使用类似于 inline-css 样式的语法。

使用`property:bindingValue;property2:bindingValue2`etc 将允许您将多个属性绑定到同一个 HTML 控件。

以回答上述问题为例：

```
<div id="itemTemplate" data-win-control="WinJS.Binding.Template"...>
     <h3 data-win-bind="style.color: fontcolor; innerText: timestamp"></h3>
</div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T12:26:54.223

如果时间戳是“重要的”，假设您想在绿色和红色之间切换，并且您的模型中有一个字段“isImportant”：

**HTML：**

```
<div id="itemTemplate" data-win-control="WinJS.Binding.Template">
    <h3 data-win-bind="innerText: timestamp; style.color: isImportant MyConverters.colorConverter"></h3> </div> 
```

然后，您可以使用转换器根据布尔值 isImportant 返回首选颜色，如下所示：

**JS：**

```
WinJS.Namespace.define("MyConverters", {
    //Converter function
    colorConverter: WinJS.Binding.converter(function (important) {
        return important ? "Green" : "Red";
    })
}); 
```