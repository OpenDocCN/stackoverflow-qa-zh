# StackOverflow 问答 000234000-000234999

# asp.net-mvc - 什么是 ASP.NET MVC 的验证选项

> ID：234006
> 
> 赞同：8
> 
> 时间：2008-10-24T15:22:17.323
> 
> 标签：asp.net-mvc, validation

.net mvc 有哪些验证选项？

他们中的任何一个都像 webforms 那样有一个很好的验证摘要吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-24T15:35:40.650

您可以使用 MVC html 验证摘要，请参阅此博客

[http://blog.maartenballiauw.be/post/2008/08/29/Form-validation-with-ASPNET-MVC-preview-5.aspx](http://blog.maartenballiauw.be/post/2008/08/29/Form-validation-with-ASPNET-MVC-preview-5.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-23T14:10:38.530

xVal 是最好的。我们在三个 Web 应用程序中实现了，我们将在未来更多地使用它（直到我们找到比这更好的一个）。在此处查看 xVal 的详细信息

[http://blog.codeville.net/2009/01/10/xval-a-validation-framework-for-aspnet-mvc/](http://blog.codeville.net/2009/01/10/xval-a-validation-framework-for-aspnet-mvc/)

# entity-framework - Ado.net 实体框架调试可视化器

> ID：234007
> 
> 赞同：9
> 
> 时间：2008-10-24T15:22:27.713
> 
> 标签：entity-framework

有谁知道是否有一个调试可视化器，但与此相同，以及 linq to SQL 调试可视化器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-01T19:39:18.097

目前我不知道有一个（希望这里的其他答案能以其他方式显示），但 Julie Lerman 有一篇文章[“用于可视化 ObjectStateEntries 的扩展方法”](http://www.thedatafarm.com/blog/2008/04/29/AnExtensionMethodForVisualizingObjectStateEntries.aspx)，她在其中逐步创建了一个弹出的调试工具建立一个 WinForm 用于通过其 EntityKey 检查实体的状态。

不是一个可视化工具，但当您需要拆分 ObjectStateEntries 以调试更改跟踪场景时，它非常方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-24T20:00:13.557

这是一个可视化工具的链接，我认为它可以满足您的需求 - [Visualizer](http://www.thinqlinq.com/Post.aspx/Title/LINQ-to-Entity-Visualizer#close=1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-30T16:44:13.630

以下是 EntityObject、EntityCollection、ObjectQuery 和 ObjectContext 的可视化工具： [http](http://entityvisualizers.codeplex.com/) ://entityvisualizers.codeplex.com/ ，适用于 .NET 3.5 和 4.0。

# c# - 动态使用泛型是不可能的吗？

> ID：234008
> 
> 赞同：10
> 
> 时间：2008-10-24T15:22:52.923
> 
> 标签：c#, generics

我需要在运行时创建使用泛型的类的实例，例如`class<T>`，在不知道它们将具有的类型 T 的情况下，我想做这样的事情：

```
public Dictionary<Type, object> GenerateLists(List<Type> types)
{
    Dictionary<Type, object> lists = new Dictionary<Type, object>();

    foreach (Type type in types)
    {
        lists.Add(type, new List<type>()); /* this new List<type>() doesn't work */
    }

    return lists;
} 
```

……但我做不到。我认为不可能在泛型括号内用 C# 编写类型变量。还有另一种方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-24T15:24:55.163

你不能那样做——泛型的重点主要是*编译时*类型安全——但你可以通过反射来做到这一点：

```
public Dictionary<Type, object> GenerateLists(List<Type> types)
{
    Dictionary<Type, object> lists = new Dictionary<Type, object>();

    foreach (Type type in types)
    {
        Type genericList = typeof(List<>).MakeGenericType(type);
        lists.Add(type, Activator.CreateInstance(genericList));
    }

    return lists;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-24T15:45:39.537

根据您调用此方法的频率，使用 Activator.CreateInstance 可能会很慢。另一种选择是执行以下操作：

私人词典>代表=新词典>（）；

```
 public Dictionary<Type, object> GenerateLists(List<Type> types)
    {
        Dictionary<Type, object> lists = new Dictionary<Type, object>();

        foreach (Type type in types)
        {
            if (!delegates.ContainsKey(type))
                delegates.Add(type, CreateListDelegate(type));
            lists.Add(type, delegates[type]());
        }

        return lists;
    }

    private Func<object> CreateListDelegate(Type type)
    {
        MethodInfo createListMethod = GetType().GetMethod("CreateList");
        MethodInfo genericCreateListMethod = createListMethod.MakeGenericMethod(type);
        return Delegate.CreateDelegate(typeof(Func<object>), this, genericCreateListMethod) as Func<object>;
    }

    public object CreateList<T>()
    {
        return new List<T>();
    } 
```

在第一次点击时，它将创建一个委托给创建列表的通用方法，然后将其放入字典中。在随后的每次点击中，您只需调用该类型的委托。

希望这可以帮助！

# c++ - 如何为 fstream 对象设置标志 FILE_FLAG_BACKUP_SEMANTICS？

> ID：234012
> 
> 赞同：2
> 
> 时间：2008-10-24T15:23:45.790
> 
> 标签：c++, winapi, visual-c++, fstream

如何为 fstream 对象设置标志 FILE_FLAG_BACKUP_SEMANTICS？

您可以使用 fstream 设置大多数标志，但似乎这个标志不可用。[您可以在此处](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)阅读有关该标志的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T17:07:42.600

我过去做过这种事情，但已经有一段时间了，所以我不确定我做对了。

没有很好的文档记录，但是在 vs2008 中，fstream 将 FILE 对象作为构造函数。您可以使用 _fdopen() 从文件 id 创建 FILE 对象。您可以使用 _open_osfhandle 从操作系统句柄获取文件 ID。

所以我认为它就像：

```
int id = _open_osfhandle(CreateFile(..., FILE_FLAG_BACKUP_SEMANTICS...));
fstream f = new fstream(_fdopen(id)); 
```

# javascript - JavaScript 数组到 ColdFusion

> ID：234024
> 
> 赞同：1
> 
> 时间：2008-10-24T15:27:12.057
> 
> 标签：javascript, jquery, forms, coldfusion

我有一个用 JavaScript 创建的数组。最终结果是 element1,element2,,,element5,element6,,,element9.... 等

一旦传递给 ColdFusion，它就会删除空元素，我最终得到 element1,element2,element5,element6,element9

我需要维护这些空间，有什么想法吗？我的问题可能在此之前开始，更详细地解释......

我有一个包含 13 个元素的表单，它们充当搜索/过滤器类型的功能。我想用 AJAX “发布”，本质上，我使用一个按钮来调用一个 jQuery 函数，并希望将字段传递给 ColdFusion 页面，然后将结果传回。JavaScript 数组甚至可能不是我最好的选择。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T15:45:10.630

您是否将 jS 数组反序列化为列表？CF 使用其内置函数忽略空列表字段。这可以通过直接处理文本来解决。幸运的是，有人已经为您完成了这项工作。cflib.org 上有几个功能，例如：

*   [列表修复](http://cflib.org/udf/ListFix)
*   [ListLenIncNulls](http://cflib.org/udf/ListLenIncNulls)

等等等等等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-09T20:48:05.933

在 javascript 和 Coldfusion 之间交换数据时，请查看使用 JSON。

[http://www.json.org](http://www.json.org)

[http://www.epiphantastic.com/cfjson/](http://www.epiphantastic.com/cfjson/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T22:27:54.227

不使用 CF ListToArray 函数，而是使用 Java String 方法将字符串拆分为数组。这将维护空列表项。

```
<cfset jsList = "item1,item2,,item4,item5,,item6">
<cfset jsArray = jsList.split(",")>
<cfdump var="#jsArray#"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T14:08:48.263

你在 JavaScript 中使用数组，很好。而不是默认分配空值，分配一些虚拟值。每当您使用此数组值时，都会使用条件忽略虚拟值。

# c++ - 如何在与 boost 正则表达式匹配的字符串中找到索引？

> ID：234027
> 
> 赞同：2
> 
> 时间：2008-10-24T15:27:58.357
> 
> 标签：c++, boost-regex

如何在与 boost 正则表达式匹配的字符串中找到索引？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T16:26:50.327

使用 的`position`成员函数`match_results`：

```
int find_match_offset(std::string const& string_to_search,
                      boost::regex const& expression)
{
    boost::smatch results;
    if(boost::regex_match(string_to_search,results,expression))
    {
        return results.position()
    }
    return -1;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-24T16:33:04.933

如果您使用 boost::regex_match 它是匹配的整个字符串。
也许您的意思是使用 regex_search：

```
void index(boost::regex& re,const std::string& input){
    boost::match_results<std::string::const_iterator> what;
    boost::match_flag_type flags = boost::match_default;
    std::string::const_iterator s = input.begin();
    std::string::const_iterator e = input.end();
    while (boost::regex_search(s,e,what,re,flags)){
        std::cout << what.position() << std::endl;
        std::string::difference_type l = what.length();
        std::string::difference_type p = what.position();
        s += p + l;
    }
} 
```

# oracle - 带有宏和 VB 的 MS-Excel 电子表格到 Oracle 的转换工具？

> ID：234039
> 
> 赞同：2
> 
> 时间：2008-10-24T15:32:15.383
> 
> 标签：oracle, excel

我们的用户创建了 MS-Excel 电子表格，随着时间的推移，这些电子表格已经演变成相当复杂的应用程序。他们与他们一起经营他们的业务。但是，从未接触过软件开发学科，这些电子表格是脆弱的、单点故障的解决方案。

我们的开发小组主要将 Oracle 与 Java 和其他一些技术结合使用。是否有从 MS-Excel 到 Oracle 的转换工具？至少在某种程度上，我们可以抢占先机，而不仅仅是逆向工程和重写？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T16:43:51.090

不，没有任何工具可以隐藏公式或逻辑。你将不得不以艰难的方式做到这一点。您可以通过将数据导出为 CSV 并使用 SQL Loader 将其导入数据库来将数据导入 Oracle。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T17:21:33.820

有一些工具可以转换数据，但尝试转换公式会导致设计在最好的情况下效率低下，在最坏的情况下无法使用。电子表格和 Oracle 数据库之间的区别类似于家庭园丁和农民之间的区别。两者在他们的水平上都是有用的，并且一些相同的原则适用，但所采用的技术完全不同。

我建议您检查电子表格，直到您了解他们试图达到的目标，然后使用 Oracle 中可用的最佳技术在 Oracle 中构建一个满足这些目标的系统。处理最终会完全不同，但产品会明显更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T17:28:54.977

您可以将电子表格吸入 MS Access，然后将其作为表直接推送到 Oracle（或将其附加到现有表中）。我相信你可以编写一个 MS Access 宏来做到这一点。

[似乎](http://www.orafaq.com/forum/t/26771/0/)也可以使用 Oracle 的 SQL Loader，但我自己从未尝试过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T16:48:22.390

您可以找到迁移数据的工具，但除此之外您找不到自动执行此操作的工具，您必须手动完成所有操作。

即使直接复制那里的内容也没有意义，您使用的工具非常有限（Excel），您需要重新分析需求，并可能在做任何其他事情之前对其进行修改。

# visual-studio-2005 - 如何使 Reflector 成为 Visual Studios 的插件？

> ID：234043
> 
> 赞同：4
> 
> 时间：2008-10-24T15:33:21.123
> 
> 标签：visual-studio-2005, reflector

我下载了[Reflector.Net](http://www.red-gate.com/products/reflector/)，它是VS外部的.Exe。我记得（去年）当我下载它时，它是 VS 的插件。我怎样才能让它回到一个插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T15:47:23.310

[反射器插件再次出现;-)](http://weblogs.asp.net/nunitaddin/archive/2006/08/01/ReflectorAddInLivesAgain.aspx)

PS 使 Reflector 成为 Visual Studio 插件的反射器插件已停止使用。

# asp.net - 使用 ASP.NET + Cookie 进行匿名个性化的有效方法

> ID：234044
> 
> 赞同：2
> 
> 时间：2008-10-24T15:33:49.920
> 
> 标签：asp.net, anonymous, personalization

我正在尝试在 ASP.net 环境中实现匿名个性化。我知道 ASP.NET 2.0 提供[Profile](http://www.odetocode.com/articles/440.aspx)。但是，我想尽可能避免访问数据库，因为我正在处理的站点是一个流量相对较高的站点。

另一个明显的解决方案是 cookie，但鉴于[cookie 的限制](http://www.ietf.org/rfc/rfc2109.txt)，我想知道是否有人有任何有效的方法将信息存储到 cookie 中。有谁知道亚马逊或雅虎如何处理匿名的。个性化？

最终，我们试图根据预定义活动中的一组业务规则大纲为我们的用户群提供不同的动态内容。原因是为了衡量我们网站的转化率。可以在网站的所有不同页面上使用相同的广告系列。我需要将其设置为 cookie 的原因是，如果我们希望用户能够看到之前提供的相同内容，那么用户可以看到它。所以这就是我现在在 cookie 中的内容。

```
 campaign code:page id:result display 
```

您可以看到，如果有很多广告系列并且每个广告系列在许多页面上使用，这将会增加。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T09:22:00.660

如果数据库负载是一个问题，您可以在用户在网站上启动他的会话时检索个性化，然后将其存储在会话状态中。这样，只有第一个页面加载会调用数据库。

您可以将用户 ID 存储在 cookie 中。

只要记住当用户更新他的偏好时将会话保留在数据库中，如果有很多匿名用户访问您的网站，一段时间后删除旧的数据库记录也可能是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T21:52:16.747

如果您想保留更改，例如每个广告系列视图，则实际上没有任何方法可以访问以写入这些更改。如果使用得当，ASP.NET 成员资格在大容量站点（每天超过 100 万）上还不错。例如，您应该将对成员资格提供程序的调用包装在缓存对象中，并经常刷新（短期到期）。此外，请确保在 RoleProvider 上设置 cacheRefreshInterval。这将强制 asp.net 将角色缓存在 cookie 中，以减少数据库活动。

另一种看待这个问题的方法是采纳 Ady 的建议并将成员资格分离到一个单独的数据库中。再一次，ASP.NET Membership 提供程序的另一个重要特性 - 您可以设置不同的 SQL 连接字符串，并将其加载到不同的数据库和/或服务器上。

围绕会员提供程序还有其他几种可以真正提高性能的技术。一些快速的谷歌搜索出现了其中的一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T09:16:16.537

我会为访问者创建一个数据库记录，并且只将 ID 存储在 cookie 中，这样您就可以从数据库中查找所有个性化详细信息，并将 cookie 大小保持在最低限度。

如果数据库速度是一个问题，也许使用不同的数据库和服务器来存储个性化。

或者，您可以将个人数据存储在文件系统中，并在访问者返回匹配 cookie ID 时加载到会话中。

如果识别用户和清除 cookie 是个问题，您可以冷使用 ActiveX 控件，但这需要在客户端计算机上安装，人们可能会反对。

# xml - 格式化xml字符串的好代码

> ID：234056
> 
> 赞同：15
> 
> 时间：2008-10-24T15:38:03.173
> 
> 标签：xml, delphi, pretty-print, text-formatting

任何人都有一个现成的函数，它将接受一个 XML 字符串并返回一个正确缩进的字符串？

例如

```
<XML><TAG1>A</TAG1><TAG2><Tag3></Tag3></TAG2></XML> 
```

并在插入换行符和制表符或空格后返回格式良好的字符串？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-25T04:24:04.263

RTL 在接受和返回字符串的 XMLDoc.pas 中有[FormatXMLData](http://docwiki.embarcadero.com/Libraries/XE5/en/Xml.XMLDoc.FormatXMLData)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-24T15:50:59.027

使用[OmniXML](http://www.omnixml.com/)：

```
program TestIndentXML;

{$APPTYPE CONSOLE}

uses
  SysUtils,
  OmniXML,
  OmniXMLUtils;

function IndentXML(const xml: string): string;
var
  xmlDoc: IXMLDocument;
begin
  Result := '';
  xmlDoc := CreateXMLDoc;
  if not XMLLoadFromAnsiString(xmlDoc, xml) then
    Exit;
  Result := XMLSaveToAnsiString(xmlDoc, ofIndent);
end;

begin
  Writeln(IndentXML('<XML><TAG1>A</TAG1><TAG2><Tag3></Tag3></TAG2></XML>'));
  Readln;
end. 
```

上面的代码片段已发布到公共领域。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-24T15:51:29.510

使用 XSLT...

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:output method="xml" indent="yes" />
    <xsl:template match="/">
        <xsl:copy-of select="."/>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-30T04:40:04.157

我使用[Tidy](http://tidy.sourceforge.net/)和Michael [Elsdörfer](http://elsdoerfer.name/=libtidy)的 libtidy。它为您提供了大量选项，您可以在应用程序外部配置它们。也适用于 HTML。

这是我使用的一些非常粗略的代码。随心所欲。

```
function TForm1.DoTidy(const Source: string): string;
var
  Tidy              : TLibTidy;
begin
  if not TidyGlobal.LoadTidyLibrary('libtidy.dll') then
  begin
    //    Application.MessageBox('TidyLib is not available.', 'Error', 16);
    //    exit;
    raise Exception.Create('Cannot load TidyLib.dll');
  end;
  Tidy := TLibTidy.Create(Self);
  try
    Tidy.LoadConfigFile(ExtractFilePath(Application.ExeName) +
      'tidyconfig.txt');
    //    Tidy.Configuration.IndentContent := tsYes;
    //    Tidy.Configuration.IndentSpaces := 5;
    //    Tidy.Configuration.UpperCaseTags := False;
    //    Tidy.Configuration.NumEntities := True;
    //    Tidy.Configuration.AccessibilityCheckLevel := 2;
    //    Tidy.Configuration.InlineTags := 'foo,bar';
    //    Tidy.Configuration.XmlDecl := True;
    //    Tidy.Configuration.XmlTags := True;
    //    Tidy.Configuration.CharEncoding := TidyUTF8;
    //    Tidy.Configuration.WrapLen := 0;
    //    Tidy.SaveConfigFile('tidyconfig.txt');
    Tidy.ParseString(Source);
    Result := Tidy.RunDiagnosticsAndRepair;
  finally
    Tidy.Free;
  end;
end; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-24T16:22:08.060

Delphi 中构建的 XML 文档 DOM 对象有一个漂亮的格式化选项。您只需将您的 XML 加载到其中并将其保存回来，如果您设置了该选项，那么它会变得很漂亮。

我会查找并更新此答案。

# c# - 如果 .NET 中的 MemoryStream 未关闭，是否会产生内存泄漏？

> ID：234059
> 
> 赞同：122
> 
> 时间：2008-10-24T15:39:40.360
> 
> 标签：c#, .net, memory-leaks, memorystream

我有以下代码：

```
MemoryStream foo(){
    MemoryStream ms = new MemoryStream();
    // write stuff to ms
    return ms;
}

void bar(){
    MemoryStream ms2 = foo();
    // do stuff with ms2
    return;
} 
```

我分配的 MemoryStream 是否有可能在以后无法处理？

我有一个同行评审坚持要我手动关闭这个，我找不到信息来判断他是否有一个有效的观点。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2008-10-24T16:28:15.987

你不会泄露任何东西——至少在当前的实现中是这样。

调用 Dispose 不会更快地清理 MemoryStream 使用的内存。它将阻止*您*的流在调用后对读/写调用可行，这可能对您有用，也可能没有用。

如果您绝对确定您*永远*不想从 MemoryStream 移动到另一种流，那么不调用 Dispose 不会对您造成任何伤害。但是，这通常是一种很好的做法，部分原因是如果您*确实*更改为使用不同的 Stream，您不希望被难以找到的错误所困扰，因为您很早就选择了简单的方法。（另一方面，还有 YAGNI 论点……）

这样做的另一个原因是新的实现*可能会*引入资源，这些资源将在 Dispose 上释放。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-10-24T15:42:46.750

如果某些东西是一次性的，则应始终将其丢弃。你应该`using`在你的方法中使用一个语句`bar()`来确保`ms2`得到 Disposed。

它最终会被垃圾收集器清理掉，但调用 Dispose 总是好的做法。如果您在代码上运行 FxCop，它会将其标记为警告。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2010-05-14T20:33:03.983

**是的，*有*泄漏**，这取决于您如何定义 LEAK 以及您的意思是多长时间...

如果泄漏的意思是“内存仍然分配，无法使用，即使您已经完成使用它”，而后者是指在调用 dispose 后的任何时间，那么是的，可能存在泄漏，尽管它不是永久性的（即应用程序运行时的生命周期）。

要释放 MemoryStream 使用的托管内存，**您需要取消对它的引用**，方法是取消对它的引用，这样它就可以立即进行垃圾回收。如果你没有这样做，那么你会在你用完它之后创建一个临时泄漏，直到你的引用超出范围，因为在此期间内存将无法用于分配。

using 语句（而不是简单地调用 dispose）的好处是您可以在 using 语句中声明您的引用。当 using 语句完成时，不仅调用 dispose，而且您的引用超出范围，有效地使引用无效并使您的对象立即有资格进行垃圾回收，而无需您记住编写“reference=null”代码。

虽然未能立即取消引用某些内容并不是经典的“永久性”内存泄漏，但它肯定具有相同的效果。例如，如果您保留对 MemoryStream 的引用（即使在调用 dispose 之后），并且在您的方法中再往下一点，您尝试分配更多内存......您仍然引用的内存流正在使用的内存将不可用直到你取消引用或者它超出范围，即使你调用了 dispose 并完成了使用它。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-15T20:01:18.880

这已经得到了回答，但我只想补充一点，信息隐藏的老式原则意味着您可能在将来的某个时候想要重构：

```
MemoryStream foo()
{    
    MemoryStream ms = new MemoryStream();    
    // write stuff to ms    
    return ms;
} 
```

到：

```
Stream foo()
{    
   ...
} 
```

这强调了调用者不应该关心返回的 Stream 类型，并且可以更改内部实现（例如，在模拟单元测试时）。

如果您没有在 bar 实现中使用 Dispose，那么您将遇到麻烦：

```
void bar()
{    
    using (Stream s = foo())
    {
        // do stuff with s
        return;
    }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-24T15:45:15.683

不需要调用`.Dispose()`（或用 包装）。`Using`

您调用的原因`.Dispose()`是尽快**释放资源**。

想想，比如说，堆栈溢出服务器，我们有一组有限的内存和数千个请求进入。我们不想等待预定的垃圾收集，我们希望尽快释放内存以便它可用对于新的传入请求。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-24T15:42:02.523

所有流都实现 IDisposable。将你的内存流包装在 using 语句中，你会很好而且花花公子。using 块将确保您的流无论如何都关闭和处置。

无论你打电话给 Foo 你都可以使用(MemoryStream ms = foo()) ，我认为你应该还可以。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-23T08:35:16.520

我建议将 MemoryStream 包装`bar()`在一个`using`语句中，主要是为了保持一致性：

*   现在 MemoryStream 不会释放内存`.Dispose()`，但有可能在将来的某个时候它可能会，或者您（或您公司的其他人）可能会用您自己的自定义 MemoryStream 替换它，等等。
*   它有助于在您的项目中建立一种模式，以确保*所有*流都得到处理——通过说“必须处理所有流”而不是“必须处理某些流，但某些流不必”来更明确地划定界限...
*   如果您曾经更改代码以允许返回其他类型的 Stream，则无论如何都需要将其更改为 dispose。

在创建和返回 IDisposable等情况下，我通常会做的另一件事`foo()`是确保构造对象与`return`被异常捕获之间的任何失败、释放对象并重新抛出异常：

```
MemoryStream x = new MemoryStream();
try
{
    // ... other code goes here ...
    return x;
}
catch
{
    // "other code" failed, dispose the stream before throwing out the Exception
    x.Dispose();
    throw;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-24T16:22:23.333

您不会泄漏内存，但您的代码审查员正确地指出您应该关闭您的流。这样做是有礼貌的。

唯一可能泄漏内存的情况是您不小心留下了对流的引用并且从不关闭它。您仍然没有真正泄漏内存，但是您*不必要*地延长了您声称使用它的时间。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T15:42:23.960

如果一个对象实现了 IDisposable，您必须在完成后调用 .Dispose 方法。

在某些对象中，Dispose 与 Close 的含义相同，反之亦然，在这种情况下，两者都可以。

现在，对于您的特定问题，不，您不会泄漏内存。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-24T15:44:37.120

我不是.net 专家，但也许这里的问题是资源，即文件句柄，而不是内存。我猜垃圾收集器最终会释放流并关闭句柄，但我认为明确关闭它始终是最佳实践，以确保将内容刷新到磁盘。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-05-15T15:58:41.397

在垃圾收集语言中，非托管资源的处置是不确定的。即使您显式调用 Dispose，您也绝对无法控制实际释放后备内存的时间。Dispose 在对象超出范围时被隐式调用，无论是通过退出 using 语句，还是从从属方法弹出调用堆栈。话虽如此，有时对象实际上可能是托管资源（例如文件）的包装器。这就是为什么最好在 finally 语句中显式关闭或使用 using 语句的原因。干杯

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2013-01-08T08:51:19.960

MemoryStram 只不过是字节数组，它是托管对象。忘记 dispose 或 close 这除了超出最终确定之外没有任何副作用。
只需检查反射器中 MemoryStream 的构造函数或刷新方法，就会清楚为什么您不需要担心关闭或处置它，而不仅仅是遵循良好实践。

# .net - .Net DataBinding 具有值类型属性的新对象

> ID：234064
> 
> 赞同：2
> 
> 时间：2008-10-24T15:41:14.117
> 
> 标签：.net, wpf, silverlight, data-binding

使用数据绑定，如何绑定使用值类型的新对象？

简单的例子：

```
public class Person() {
    private string _firstName;
    private DateTime _birthdate;
    private int _favoriteNumber;
    //Properties
} 
```

如果我创建一个新的 Person() 并将其绑定到带有文本框的表单。出生日期显示为 01/01/0001，收藏号码显示为 0。这些字段是必需的，但我希望这些框为空并让用户填写。

该解决方案还需要能够默认字段。在我们的示例中，我可能希望收藏号码默认为 42。

我专门询问 Silverlight，但我认为 WPF 和 WinForms 可能有同样的问题。

**编辑：**

我想到了 Nullable 类型，但是我们目前在客户端和服务器上使用相同的域对象，我不想让必填字段为 Nullable。我希望数据绑定引擎公开一种知道它正在绑定新对象的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T16:01:26.340

也许您可以尝试 Nullable 类型？

```
public class Person() {
    private string? _firstName;
    private DateTime? _birthdate;
    private int? _favoriteNumber;
    //Properties
} 
```

或者

```
public class Person() {
    private Nullable<string> _firstName;
    private Nullable<DateTime> _birthdate;
    private Nullable<int> _favoriteNumber;
    //Properties
} 
```

这实际上是一样的。

现在，默认值为 null，您可以通过设置属性来强制属性具有值。

有关可空类型的更多信息：

[http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx](http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-26T02:43:49.823

尝试使用值转换器，这是一个可以帮助您入门的示例。

基本思想是在显示数据时将类型的默认值转换为 null，并在更新绑定源时将任何 null 值转换回类型的默认值。

```
public class DefaultValueToNullConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        object result = value;
        Type valueType = parameter as Type;

        if (value != null && valueType != null && value.Equals(defautValue(valueType)))
        {
            result = null;
        }

        return result;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        object result = value;
        Type valueType = parameter as Type;

        if (value == null && valueType != null )
        {
            result = defautValue(valueType);
        }
        return result;
    }

    private object defautValue(Type type)
    {
        object result = null;
        if (type == typeof(int))
        {
            result = 0;
        }
        else if (type == typeof(DateTime))
        {
            result = DateTime.MinValue;
        }
        return result;
    }
} 
```

然后在您的 xaml 参考中像这样的转换器

```
<Page.Resources>
    <local:DefaultValueToNullConverter x:Key="DefaultValueToNullConverter"/>
</Page.Resources>

<TextBox 
    Text="{Binding 
            Path=BirthDate, 
            Converter={StaticResource DefaultValueToNullConverter},
            ConverterParameter={x:Type sys:DateTime}}" 
    /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-26T00:37:47.987

我会重写 Person 类，使其看起来更像这样......

```
public class Person
  {
    private int _favoriteNumber = 0;
    public string FavoriteNumber
    {
      get
      {
        return _favoriteNumber > 0 ? _favoriteNumber.ToString() : string.Empty;
      }
      set
      {
        _favoriteNumber = Convert.ToInt32(value);
      }
    }

    private DateTime _birthDate = DateTime.MinValue;
    private string BirthDate 
    {
      get
      {
        return _birthDate == DateTime.MinValue ? string.Empty : _birthDate.ToString(); //or _birthDate.ToShortDateString() etc etc
      }
      set
      {
        _birthDate = DateTime.Parse(value);
      }
    }
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-26T01:30:24.603

您可以使用 IValueConverter 根据对象的值将文本框绑定格式化为默认值。这是 IValueConverter 上的一些链接

[http://ascendedguard.com/2007/08/data-binding-with-value-converters.html](http://ascendedguard.com/2007/08/data-binding-with-value-converters.html) [http://weblogs.asp.net/marianor/archive/2007/09/18/using-ivalueconverter-to-format -binding-values-in-wpf.aspx](http://weblogs.asp.net/marianor/archive/2007/09/18/using-ivalueconverter-to-format-binding-values-in-wpf.aspx)

不幸的是，这可能不是您所需要的，因为您没有为每个属性选择 Nullable 值。

您可以做的是在进行数据绑定时为您的对象设置默认属性。

您可以通过使用 Person.Empty 对象作为默认值来做到这一点。或者在设置 DataContext 时显式设置这些值。

无论哪种方式都应该有效:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-28T18:14:47.430

在您准备好转换器后，您还需要在 Person 对象上隐含 INotifyPropertyChanged。这样，您可以设置绑定的 Mode=TwoWay 两种方式数据绑定将在文本框发生更改时更新对象中的值，并且相对于 vis。

# c# - 如何将服务“绑定”到 .NET Remoting 服务器中的特定通道（tcp、http、ipc）？

> ID：234067
> 
> 赞同：3
> 
> 时间：2008-10-24T15:41:43.867
> 
> 标签：c#, .net, remoting

我有一个复杂的 .NET Remoting 服务器应用程序，它提供了一些服务。客户端目前可以使用 tcp 和 http 通道连接到服务器。

现在我需要实现一些新的管理服务，但我想限制它们对本地机器的可用性，即我想创建一个可以使用这些新服务的管理工具，但我不希望敏感数据物理离开服务器，所以我需要限制在同一台服务器计算机上运行管理工具。

我考虑添加新服务并在服务器上注册 ipc 通道以供管理工具使用。现在问题来了：如何防止远程客户端使用 tcp 或 http 通道连接到这些新的管理服务？我可以在 app.config 中说类似“注册服务 x，由程序集 A 中的 C 类实现，只能通过 ipc 使用”，“注册服务 y，由程序集 A 中的 D 类实现，可通过 tcp/http 使用”之类的话（或使用远程基础设施类）？

令我困惑的是“只能通过 ipc 使用”部分。（不，现在不能移植到 WCF。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T16:00:37.247

RegisterWellKnownServiceType 没有允许您指定要在哪个通道上注册的重载，IPCServerChannel 上也没有任何方法来注册服务，因此这些都不起作用。

我能想到的最好的方法是编写一个 ChannelSink 来过滤您的消息或提供安全性。这些可以添加到 TcpChannel 和 HttpChannel 的构造函数中，以过滤掉仅管理员调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T15:49:42.477

获取调用它的服务的 IPAddress。如果不是 127.0.0.1 则拒绝呼叫。

# wpf - 如何使按钮的 IsEnabled 属性依赖于其他控件中数据的存在？(WPF)

> ID：234076
> 
> 赞同：1
> 
> 时间：2008-10-24T15:43:43.940
> 
> 标签：wpf, vb.net, xaml, data-binding

我有一个“登录”按钮，我希望禁用该按钮，直到同一个 WPF 表单上的 3 个文本框填充了文本（用户、密码、服务器）。

我有一个带有名为 IsLoginEnabled 的布尔属性的支持对象，当且仅当所有 3 个控件都有数据时，它才返回 True。但是，我应该什么时候检查这个属性？它应该在 3 个依赖控件中的每一个的 LostFocus 事件上吗？

谢谢！

vg1890

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T16:02:06.323

`IsLoginEnabled`当三个字段中的任何一个被更新时，我会得到“支持对象”来引发更改的事件。然后，您可以将按钮绑定到 IsLoginEnabled 属性，而不必继续检查它。

伪代码看起来像这样：

```
Public Event IsLoginEnabledChanged As EventHandler

Public Property User() As String
Get..   ' snipped for brevity
Set(ByVal value As String)
   mUser = value
   RaiseEvent IsLoginEnabledChanged(Me, New EventArgs())
End Set

' do the same in the Set for Password() and Server() properties 
```

诀窍是命名事件`[PropertyName]Changed`（即`IsLogonEnabledChanged`） - 因为引发此事件将自动通知任何绑定控件：o）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T15:54:10.673

是的，我想说最简单的选择是检查每个控件的 LostFocus 或 TextChanged 事件。但是，如果您想做一些更重的提升，您可以将布尔值实现为您可以绑定到按钮的启用的依赖属性。 [http://msdn.microsoft.com/en-us/library/ms750428.aspx](http://msdn.microsoft.com/en-us/library/ms750428.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T15:58:20.277

您可以将您的 IsLoginEnabled 权限数据绑定到登录按钮的 Enabled 属性吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T19:46:20.067

我认为您可以使用WPF 最有用的功能之一**RoutedCommands 。**基本上添加一个**CommandBinding**，使用**OnExecute**和**OnQueryCommandEnabled**来管理按钮的启用状态。

[查看有关在 WPF 中使用 RoutedCommands 的精彩说明](http://blogs.msdn.com/dancre/archive/2006/08/05/dm-v-vm-part-5-commands.aspx)

# text - 如何检测具有一定模糊性的重复文本

> ID：234084
> 
> 赞同：3
> 
> 时间：2008-10-24T15:46:14.530
> 
> 标签：text, diff, duplicates, duplicate-data, duplication

前段时间，我使用[Text::DeDupe编写了](http://search.cpan.org/dist/Text-DeDuper/)[一个](http://svn.rot13.org/index.cgi/refeed/view/trunk/deduper/reblog-dupe.pl)小脚本来删除重复的博客文章，然后才不得不关注它们。

在阅读了实现所依据[的 Web 论文的句法聚类](http://www.ra.ethz.ch/CDstore/www6/Technical/Paper205/Paper205.html)之后，我希望能够找到重叠的文档（例如，与全文相对的博客片段，也许还有引号）。

您是否知道在编写自己的 C、C++ 或 perl 中我可以尝试的任何其他实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-26T17:44:36.187

SpotSigs 似乎正好符合我的要求，这里有一些参考资料：

*   [http://dbpubs.stanford.edu/pub/2008-10](http://dbpubs.stanford.edu/pub/2008-10)
*   [http://infoblog.stanford.edu/2008/08/spotsigs-are-stopwords-finally-good-for.html](http://infoblog.stanford.edu/2008/08/spotsigs-are-stopwords-finally-good-for.html)
*   [http://ilpubs.stanford.edu:8090/860/](http://ilpubs.stanford.edu:8090/860/)

该模块的源代码托管在 GitHub 上：

[http://github.com/jzawodn/perl-text-spotsig](http://github.com/jzawodn/perl-text-spotsig)

# regex - 基础设施 Windows 网格

> ID：234087
> 
> 赞同：2
> 
> 时间：2008-10-24T15:46:53.280
> 
> 标签：regex, infragistics, ultrawingrid

我正在使用 Infragistics WinForms UltaGrid 控件，并且正在设置 RegexPattern 属性。如何让我设置 RegEx 的网格单元格实际使用该模式来限制输入？还是我误解了 RegexPattern 属性的工作原理。

杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T15:51:23.777

列的 RegexPattern 属性用于单元格值验证。因此，如果您设置此属性并且您的用户尝试编辑列中的值，则在完成后将针对此 Regex 对其进行验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-26T11:48:06.230

您使用的是哪个版本的 NetAdvantage？NetAdvantage 2008 中没有 UltraGridCell 类的 RegexPattern 属性。

但是，如果您引用 UltraGridColumn 类的 RegexPattern 属性，它将执行您想要的操作。单元格的值必须**完全匹配**，否则验证将失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-05T14:52:21.417

Regex 属性仅在用户单击单元格后验证。它不限制初始条目。如果您想在输入时将 RegexPattern 应用于键值，我会尝试修改 UltraGrid.KeyDown 事件。

# java - 如何将参数传递给servlet

> ID：234090
> 
> 赞同：1
> 
> 时间：2008-10-24T15:47:53.293
> 
> 标签：java, html, forms, jsp, parameters

如何将 JSP 中页面的 useBean 中的参数传递给 Java 中的 servlet？我的表单中有一些数据通过提交按钮没有问题，但无法发送其他任何内容。请帮忙？这是我的代码：

```
<input name = "deleteGameButton" type = "submit" value = "Delete"
 onclick = "submitToServlet('DeleteGameServlet');"> 
```

这是相应的javascript：

```
 function submitToServlet(newAction)
 {
   document.userGameForm.action = newAction;
 } 
```

我希望 servlet 可以访问 userBean

```
 <jsp:useBean id = "userBean" scope = "session" class = "org.project.User" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T15:56:03.730

你这里有点乱。

onclick() 是 Javascript 并在客户端执行。它没有（直接）方法来更新会话范围的 bean。该 bean 留在服务器端，并在**生成**HTML 页面时使用。要将参数传递回 servlet，您需要使用良好的旧表单字段并提交表单。

在表单中添加更多字段，在提交之前设置它们的值，然后提交。

在 Servlet 中调用 request.getParameter("name");

PS 要使此类事情自动化，**请使用 STRUTS**。:-) Struts 完全符合您的要求：在将参数传递给操作之前，它使用这些参数填充 bean。透明地。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T18:46:51.480

这完全取决于您要做什么。这

`<jsp:useBean id = "userBean" scope = "session" class = "org.project.User" />`

标签将允许您在 jsp 中使用会话的 userBean 属性。如果会话中没有 userBean 属性，它将创建一个新的（使用 org.project.User 的默认构造函数）并将其放置在会话中。

然后，当您访问 servlet 时，您可以使用以下命令检索它：

```
User user = (User)request.getSession().getAttribute("userBean"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-17T09:29:35.790

```
 getServletConfig().getServletContext().getRequestDispatcher("servlet path & name");         
 dispatcher.forward (request, response); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T15:56:15.477

嗨尝试下一个标签：

```
<jsp:useBean id = "userBean" scope = "session" class = "org.project.User"/>
 <jsp:setProperty name="beanName" property="propertyname" value="value"/>
</jsp:useBean> 
```

更多[在这里](http://java.sun.com/products/jsp/tags/syntaxref.fm13.html)

祝你好运！

# web-services - 如何为 WebService 暴露构建 DAL？

> ID：234091
> 
> 赞同：1
> 
> 时间：2008-10-24T15:48:01.560
> 
> 标签：web-services, data-access-layer, dto, null

我们有一个高度专业化的 DAL，它位于我们的数据库之上。我们的应用程序需要使用此 DAL 才能正确操作此数据库。

生成的 DAL（位于一些自定义基类上）具有各种“Rec”类（Table1Rec、Table2Rec），每个类都表示给定表的记录结构。

这是一个示例伪类......

```
Public Class SomeTableRec
    Private mField1 As String
    Private mField1isNull As Boolean
    Private mField2 As Integer
    Private mField2isNull As Boolean

    Public Sub New()
        mField1isNull = True
        mField2isNull = True
    End Sub
    Public Property Field1() As String
        Get
            Return mField1
        End Get
        Set(ByVal value As String)
            mField1 = value
            mField1isNull = False
        End Set
    End Property
    Public ReadOnly Property Field1isNull() As Boolean
        Get
            Return mField1isNull
        End Get
    End Property
    Public Property Field2() As Integer
        Get
            Return mField2
        End Get
        Set(ByVal value As Integer)
            mField2 = value
            mField2isNull = False
        End Set
    End Property
    Public ReadOnly Property Field2isNull() As Boolean
        Get
            Return mField2isNull
        End Get
    End Property
End Class 
```

每个类都有每个字段的属性......因此我可以写......

```
Dim Rec as New Table1Rec
Table1Rec.Field1 = "SomeString"
Table2Rec.Field2 = 500 
```

在字段可以接受 NULL 值的情况下，还有一个附加属性指示该值当前是否为 null。

因此....

```
Dim Rec as New Table1Rec
Table1Rec.Field1 = "SomeString"
If Table1Rec.Field1Null then 
    ' This clearly is not true
End If
If Table1Rec.Field2Null then 
    ' This will be true
End If 
```

这是因为类的构造函数将所有 NULL 属性设置为 True，并且任何 FieldProperty 的设置都会导致等效的 NullProperty 设置为 false。

我最近需要通过网络服务（我当然打算保护它）在网络上公开我的 DAL，并且发现虽然“Rec”类的结构在网络上保持不变......所有逻辑都是丢失..

如果有人要远程运行前一段代码，他们会注意到这两个条件都不会被证明是正确的，因为没有客户端代码将 null 设置为 true。

**我觉得我把这一切都错了，但看不出我应该如何改进它。**

**构建这个的正确方法是什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T12:50:39.003

不确定我是否完全理解这个问题，但您可以在 XML 中使用可为空的数据类型。

所以这...

```
Imports System.Web
Imports System.Web.Services
Imports System.Web.Services.Protocols

<WebService(Namespace:="http://tempuri.org/")> _
<WebServiceBinding(ConformsTo:=WsiProfiles.BasicProfile1_1)> _
<Global.Microsoft.VisualBasic.CompilerServices.DesignerGenerated()> _
Public Class Testing
     Inherits System.Web.Services.WebService

    <WebMethod()> _
   Public Function GetObjects() As Generic.List(Of TestObject)
        Dim list As New Generic.List(Of TestObject)
        list.Add(New TestObject(Nothing, "Empty ID Object"))
        list.Add(New TestObject(1, "Full ID Object"))
        list.Add(New TestObject(2, Nothing))
        Return list
    End Function

    Public Class TestObject
        Public Sub New()
            _name = String.Empty
            _id = Nothing
        End Sub
        Public Sub New(ByVal id As Nullable(Of Integer), ByVal name As String)
            _name = name
            _id = id
        End Sub
        Private _name As String
        Public Property Name() As String
            Get
                Return _name
            End Get
            Set(ByVal value As String)
                _name = value
            End Set
        End Property

        Private _id As Nullable(Of Integer)
        Public Property ID() As Nullable(Of Integer)
            Get
                Return _id
            End Get
            Set(ByVal value As Nullable(Of Integer))
                _id = value
            End Set
        End Property
    End Class

End Class 
```

输出这个（带有可为空的区域）

```
<?xml version="1.0" encoding="utf-8" ?> 
<ArrayOfTestObject xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://tempuri.org/">
 <TestObject>
  <Name>Empty ID Object</Name> 
  <ID xsi:nil="true" /> 
 </TestObject>
 <TestObject>
  <Name>Full ID Object</Name> 
  <ID>1</ID> 
 </TestObject>
 <TestObject>
  <ID>2</ID> 
 </TestObject>
</ArrayOfTestObject> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T16:18:17.130

Web 服务旨在公开操作（方法）和数据合约，但不公开内部实现逻辑。这在面向服务的架构世界中是一件“好事”。您描述的场景是远程/分布式对象架构。Web 服务将不支持您尝试执行的操作。请参阅这篇[文章](https://stackoverflow.com/questions/187006/how-to-expose-objects-through-wcf#187079 "使用 WCF")了解更多信息。

# .net - 为什么 CLR 集成程序集具有随机版本号

> ID：234103
> 
> 赞同：1
> 
> 时间：2008-10-24T15:51:15.237
> 
> 标签：.net, sql-server-2005, clr, sqlclr

出于某种原因，新项目将程序集的版本号设置为 1.0.*，然后在编译后分配看似随机的数字。

为什么不像所有其他项目那样设置为 1.0.0.0。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T22:11:00.820

这些数字不是随机的，但如果您不知道它们是如何生成的，它们可能会以这种方式出现。前段时间我遇到过：

当版本为 1.0.ds 时，“d”是自 2000 年 2 月 1 日以来的天数，“s”是自午夜/2 以来的秒数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T18:03:10.227

您希望每个版本的版本号都不同（* 它基于 TOD IIRC）。它是 .net 中并排支持的核心（即强命名）。

例如，如果您正在执行浏览器托管程序集，如果您更新程序集但不更新版本#，IEHOST 会变得非常混乱。它将拒绝加载程序集，因为 http 程序集与下载缓存中的内容不匹配，但由于版本号匹配，它不会更新缓存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T16:04:21.247

我注意到一些模板在这方面有不同的行为。我的猜测是他们想确保它默认递增。

如果您不喜欢默认设置，可以修改模板。

# c# - 在成功插入时获得 sqlexception，VB.NET

> ID：234110
> 
> 赞同：0
> 
> 时间：2008-10-24T15:52:28.400
> 
> 标签：c#, sql, vb.net

我正在尝试使用 VB.NET 做一个非常简单的 INSERT。出于某种原因，我在每次插入时都会收到 SqlException 。数据被插入，但仍然得到以下内容：

违反 PRIMARY KEY 约束“PK_User”。无法在对象“dbo.Employee”中插入重复键。该语句已终止

当我签入 SQL Management Studio 时，数据已成功插入。

这是发生问题的代码

```
Try
    conn.Open()
    Dim insertSQL As String = "insert into Employee(uName, firstName, lastName,
        On_Switch, On_Phone) " + "values('" & uName & "', '" & firstName & "', '" _
        & lastName & "', '" & onSwitch & "', '" & onPhone & "')"
        Dim AddCom As SqlCommand = New SqlCommand(insertSQL, conn)

        If (AddCom.ExecuteNonQuery() = 1) Then

            lblError.Text = "User Added."
            ' string urlBack = "../ViewAsset.aspx?DeptID=" + DeptID;
            ' Response.Redirect(urlBack);
        End If

        conn.Close()

    Catch ex As SqlException
        Dim ExMsg As String = ex.Message.ToString()
        lblError.Text = ExMsg 
```

我回去用 C# 测试了相同的代码，没有抛出异常。这似乎是我在 VB 中所做的一些小事，但我不知道它是什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T16:02:31.437

作为旁注，我强烈建议更改为参数化查询，以防止当前代码不受保护的 SQL 注入风险。

对于错误问题，我会检查您的代码是否在 VB 版本中没有被调用两次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T15:57:30.043

两种理论。您的代码正在执行两次，或者 Employee 表上有一个触发器在成功插入后尝试插入。（编辑：@Mitchel Sellers 完全正确，如果相同的代码在 c# 中工作，那绝对不是触发问题。）

我的预感是你的代码被执行了两次。尝试在附加调试器并在 ExecuteNonQuery 上设置断点的情况下运行 - 我想您会发现其他一些方法多次调用此方法。

@Mitchel Sellers - 很好地发现了 SQL 注入错误！参数，请！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-25T19:22:50.603

作为另一个说明，我注意到您的代码可能会打开一个 sql 连接。如果您使用的是 .NET 2.0 框架，您应该使用 Using 语句。即使抛出异常，它也能确保关闭和释放连接。有关更多详细信息，请查看 MSDN 上的这篇文章：http: [//msdn.microsoft.com/en-us/library/htd05whh.aspx](http://msdn.microsoft.com/en-us/library/htd05whh.aspx)。另一种选择是在 try-catch 处理程序的 finally 块中添加 close 语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T23:01:20.113

如果您在某种事件中执行此代码，请确保您没有多次订阅该事件。我在asp.net中遇到过这个问题。通常我只是删除后面代码中的 click 事件处理程序和 aspx 文件中的 onclick 属性（如果它也存在的话），然后再试一次。

# postgresql - 您如何有效地确定 Postgres 表是否有行

> ID：234131
> 
> 赞同：7
> 
> 时间：2008-10-24T15:57:19.140
> 
> 标签：postgresql

我做了这个测试，结果似乎计数函数呈线性比例。我有另一个函数强烈依赖效率来知道是否有任何数据，所以我想知道如何用另一个更有效的（可能是常数？）查询或数据结构替换这个 select count(*)。

> psql -d testdb -U postgres -f truncate_and_insert_1000_rows.sql > NUL
> 
> psql -d testdb -U postgres -f count_data.sql

## -------------------------------------------------- ------------------------------

聚合（成本=36.75..36.76 行=1 宽度=0）（实际时间=0.762..0.763 行=1 循环=1）-> 数据上的 Seq 扫描（成本=0.00..31.40 行=2140 宽度=0） （实际时间=0.02 8..0.468 行=1000 次循环=1）总运行时间：**0.846 毫秒** （3 filas）

> psql -d testdb -U postgres -f truncate_and_insert_10000_rows.sql > NUL
> 
> psql -d testdb -U postgres -f count_data.sql

## -------------------------------------------------- ------------------------------

聚合（成本=197.84..197.85 行=1 宽度=0）（实际时间=6.191..6.191 行=1 循环=1）-> datos 上的 Seq 扫描（成本=0.00..173.07 行=9907 宽度=0） （实际时间=0.0 09..3.407 行=10000 次循环=1）总运行时间：**6.271 毫秒** （3 个 filas）

> psql -d testdb -U postgres -f truncate_and_insert_100000_rows.sql > NUL
> 
> psql -d testdb -U postgres -f count_data.sql

## -------------------------------------------------- ------------------------------

聚合（成本=2051.60..2051.61 行=1 宽度=0）（实际时间=74.075..74.076 行=1 循环=1）-> datos 上的 Seq 扫描（成本=0.00..1788.48 行=105248 宽度=0 ）（实际时间= 0.032..46.024 行=100000 循环=1）总运行时间：**74.164 ms** （3 fils）

> psql -d prueba -U postgres -f truncate_and_insert_1000000_rows.sql > NUL
> 
> psql -d testdb -U postgres -f count_data.sql

## -------------------------------------------------- ------------------------------

聚合（成本=19720.00..19720.01 行=1 宽度=0）（实际时间=637.486..637.4 87 行=1 循环=1）-> datos 上的 Seq 扫描（成本=0.00..17246.60 行=989360 宽度=0 ）（实际时间=0.028..358.831行=1000000循环=1）总运行时间：**637.582 ms** （3 filas）

数据的定义是

```
CREATE TABLE data
(
  id INTEGER NOT NULL,
  text VARCHAR(100),
  CONSTRAINT pk3 PRIMARY KEY (id)
); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-13T09:03:42.837

从表限制1中选择true；

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-07T01:28:09.370

```
select exists(select * from your_table_here) as has_row 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T17:41:14.470

试试这个：

```
SELECT t.primary_key IS NOT NULL FROM table t LIMIT 1; 
```

如果有记录，您将获得 TRUE，如果没有记录，您将获得 NULL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T16:03:55.367

如果您只关心 1 行或没有行。将您的查询限制在第一行 - 为什么要计算所有行只是为了找出是否有 1 或更多，或零......

使用相当于 ROWNUM = 1 或 TOP 1 或 postgres 给你的任何东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T16:00:51.583

如何计算不为 NULL 的主键字段，将查询限制为 1 个响应？

由于*必须*存在主键，如果有主键，您就有数据，是吗？

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-24T16:39:41.800

您可能会发现[这](http://wiki.postgresql.org/wiki/Slow_Counting)很有用。

# c++ - 在 Win32 中从字符串中解析日期

> ID：234171
> 
> 赞同：3
> 
> 时间：2008-10-24T16:05:03.897
> 
> 标签：c++, windows, winapi

我有一个包含日期的字符串，以及另一个包含第一个字符串的日期格式的字符串。有没有可以调用的函数将该日期转换为类似于 SYSTEMTIME 结构的函数？基本上，我想要[GetDateFormat()](http://msdn.microsoft.com/en-us/library/ms776293(VS.85).aspx)的反面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T16:15:05.140

它与您描述的不太一样，但我会先使用`COleDateTime::ParseDateTime`. 它适用于本地化的日期时间格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T16:10:04.747

不，但是您可以编写一个函数，将日期格式字符串转换为`sscanf`格式字符串和一系列变量。然后将变量中的数据复制到`SYSTEMTIME`结构中，一切就绪。

这不是微不足道的，但如果您必须支持许多不同的日期格式，它可能是最灵活的安排。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T16:17:59.613

在源文件[Here](http://code.google.com/p/kgui/source/browse/trunk/kgui.cpp) .

我有一个以多种不同格式读取日期的函数，该函数称为

```
bool kGUIDate::Setz(const char *datestring) 
```

这是一门按日/月/年阅读并处理小时/分钟/秒的课程。

代码是 LGPL，所以请随意复制。

```
/* formats excepted are: */
/* yyyy-mm-dd */
/* Wdy, DD-Mon-YY HH:MM:SS GMT */
/* Wdy, D Mon YY HH:MM:SS GMT */ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T16:20:38.110

如果您有 POSIX 系统，则可以使用该[`strptime()`](http://linux.about.com/library/cmd/blcmdl3_strptime.htm)功能。不幸的是，MSVC 2005 在它的 C 运行时中似乎没有这个功能。用于 Windows 的 MinGW 可以。

# c# - NHibernate 自动重命名 C# 中的列名

> ID：234174
> 
> 赞同：2
> 
> 时间：2008-10-24T16:06:18.530
> 
> 标签：c#, nhibernate, hibernate

我不明白为什么 NHibernate 会这样做。

这是我在 MS SQL 中的表的一部分

```
CREATE TABLE Person ( 
nameFamily text,
nameGiven text
) 
```

这是 Person.hbm.xml

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">

  <class name="Infosci.Dpd.Model.Person,Infosci.Dpd.Model" table="Person" lazy="true">
    <property type="string"  name="NameGiven" column="nameGiven" />
    <property type="string" name="NameFamily" column="nameFamily" />
  </class>
</hibernate> 
```

在我的 Person.cs 中，我将我的属性命名如下

```
 string NameFamily
    {
        get ;
        set ;

    }
    string NameGiven
    {
        get ;
        set ;

    } 
```

然后我尝试使用以下代码创建记录

```
 ISession session = NHibernateHelper.GetCurrentSession();
    Person person = new Person();
    person.NameFamily = "lee";
    session.Save(person); 
```

奇怪的是，当我尝试执行它时，NHibernate 实际上通过执行以下操作来更改列名

```
NHibernate: INSERT INTO Person (name_family,name_given....... 
```

因此，NHibernate 在这里将我的列名从 NameFamily 更改为 name_family，尽管我确实指定了列名。

这是 NHibernate 错误吗？或者我需要做任何配置吗？

这是我的休眠配置文件

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">

  <session-factory>

    <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="dialect">NHibernate.Dialect.MsSql2000Dialect</property>
    <property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
    <property name="connection.connection_string">Data Source=xxxxxxx;Initial Catalog=xx;Integrated Security=True;Pooling=False;User ID=xxxx;Password=xxxx</property>
    <property name="show_sql">true</property>

  </session-factory>

</hibernate-configuration> 
```

这就是我创建 sessionFactory 的方式

```
 sessionFactory = new `Configuration().Configure("hibernate.cfg.xml").
SetNamingStrategy(ImprovedNamingStrategy.Instance).
AddFile("Person.hbm.xml").
BuildSessionFactory();` 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T16:26:16.727

这是 SetNamingStrategy(ImprovedNamingStrategy.Instance) 的“功能”

它将在混合大小写名称中的每个大写字母前添加下划线。

不知道你是如何禁用它的（我不是一个休眠用户）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T17:41:45.060

我最终做的只是使用默认命名策略或 SetNamingStrategy(DefaultNamingStrategy.Instance)

默认命名策略将保持混合大小写名称不变

# database - 如何使用 DataSet 将数据从一个数据库传输到另一个数据库？

> ID：234177
> 
> 赞同：3
> 
> 时间：2008-10-24T16:08:47.510
> 
> 标签：database, ado.net, merge, data-transfer

像往常一样，先介绍一些背景信息：

数据库 A（Access 数据库）- 保存一个表，其中包含我只需要两列的信息。无法访问数据库 A 的人将使用应用程序需要这两列中的信息。

数据库 B（Access 数据库）- 保存一个只包含两列的表（反映我们需要从表 A 中获取的内容）。数据库 B 可供应用程序的所有用户访问。一个问题是，其中一个列名与数据库 A 中的表中的不同。

我需要做的是通过一个会自动运行的实用程序传输必要的数据，比如每周一次（两个数据库不需要完全同步，只需关闭即可）。传输实用程序将从有权访问两个数据库的用户帐户运行（显然）。

这是我采取的方法（如果有更好的方法，请提出建议）：

1.  从数据库 A 中获取数据。它只是必要表中的两列。

2.  使用 DataReader 对象和 WriterStream 对象将数据写入 [tablename].txt 文件。我已经这样做了，所以我可以使用 schema.ini 文件并强制数据列具有与数据库 B 中相同的名称。

3.  创建一个 DataSet 对象，其中包含一个镜像数据库 B 中的表的 DataTable。

4.  使用具有文本扩展属性 hdr=yes 和 fmt=delimited 的 Microsoft.Jet.OLEDB.4.0 提供程序将 .txt 文件中的信息吸入 DataTable（以匹配我的 schema.ini 文件设置和 .txt文件设置）。我正在使用 DataAdapter 来填充 DataTable。

5.  创建另一个 DataSet 对象，其中包含一个镜像数据库 B 中的表的 DataTable。

6.  从数据库 B 中获取信息，使其包含表中需要从数据库 A 更新的所有当前数据。我再次使用 DataAdapter 填充此 DataTable（与步骤 5 不同，因为它们是两者都使用不同的数据源）。

7.  合并包含来自数据库 A（或 .txt 文件，技术上）数据的 DataTable。

8.  使用更改更新数据库 B 的表。

我已经为 DataAdapter 手动编写了更新、删除和插入命令，该命令负责与数据库 B 通信。但是，这个逻辑从未使用过，因为 DataSet-From-Database-B.Merge(Dataset-From-TxtFile[tableName] ) 不会翻转 HasChanges 标志。这意味着 DataSet-From-Database-B.Update 不会触发任何命令。

那么有什么方法可以使用我正在使用的方法从 DataSet-From-TxtFile 获取数据以合并并应用于数据库 B？我在这里错过了关键的一步吗？

我知道我总是可以从数据库 B 的表中删除所有记录，然后只插入文本文件中的所有记录（即使我必须遍历 DataSet 中的每条记录并应用 row.SetAdded 以确保它触发 HasChanges 标志） ，但我宁愿让它每次只应用更改。

我正在使用 c# 和 2.0 框架（我意识到这意味着我可以使用 DataTables 和 TableAdapters 而不是 DataSets 和 DataAdapters，因为我只处理一个表，但无论如何）。

TIA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T17:06:36.393

暂时搁置一下，我将使用 SQLServer，并且只有一个带有多个视图的表来控制谁可以看到其中的信息以避免整个同步问题......

我认为@Mitchel 在这里是正确的。只需编写一个连接两个数据库的程序，分别加载A表和B表。然后，对于 A 中的每个元素（列对），确保它在 B 中。如果不是，则将其插入 B。然后，对于 B 中的每个元素，确保它在 A 中。如果不是，则将其从 B 中删除. 保存 B. 我不认为需要先转到文件。

伪代码：

```
DataTable A = load table from A
DataTable B = load table from B

foreach row in A
   col1 = row[col1]
   col2 = row[col2]
   matchRow = B.select( "col1 = " + col1 + " and col2 = " + col2)
   if not matchRow exists
      add new row to B with col1,col2
   end
end

foreach row in B
   col1 = row[col1]
   col2 = row[col2]
   matchRow = A.select( "col1 = " + col1 + " and col2 = " + col2)
   if not matchRow exists
      remove row from B
   end
end

update B 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T16:11:51.590

为什么不简单地使用数据阅读器，并遍历记录，如果需要手动插入数据库 B？

而不是使用数据集、合并等。

# apache-flex - 闪存日志 API

> ID：234180
> 
> 赞同：5
> 
> 时间：2008-10-24T16:09:48.117
> 
> 标签：apache-flex, flash, actionscript-3, air

谁能推荐一个适用于 Flash/AIR/Flex 的好的 (AS3) 日志记录 API？除了编码事件之外，我还需要一些东西来捕获和记录鼠标和键盘事件。最好是有据可查/支持的东西。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T17:06:13.557

我一直在使用[迅雷](http://code.google.com/p/flash-thunderbolt/)。它允许您在 Firebug 中查看日志结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-19T20:57:56.080

我开发和管理 Loggee!，一个 Flash/Flex 日志工具：[http ://davidbuhler.org/loggee-flex-logging-tool/](http://davidbuhler.org/loggee-flex-logging-tool/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T16:12:40.467

你必须看到[http://sourceforge.net/projects/log4flash/](http://sourceforge.net/projects/log4flash/)

没有了……再见

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T16:13:39.467

如果您正在寻找开发工具（这在您的问题中不是很清楚），我会推荐[节肢动物](http://arthropod.stopp.se/)，如果它是为了记录您的客户的行为，我不知道有任何工具抱歉。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T22:23:29.530

我总是最终编写自己的日志记录解决方案。与项目的其他部分相比，它们通常非常简单，通过自己编写，我可以完全根据我的需要对其进行调整。而使用预建的，似乎总是过于过度设计和使用复杂，或者太简单并且缺少我需要的几个功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-13T18:15:41.670

尝试对 ActionScript 3.0使用[Log5F日志记录实用程序](http://log5f.wordpress.com)

# c# - 从 SortedList 或 SortedDictionary 中获取第 i 个值

> ID：234181
> 
> 赞同：19
> 
> 时间：2008-10-24T16:09:57.320
> 
> 标签：c#, .net, collections

我有一个排序的对象集合（它可以是 SortedList 或 SortedDictionary，我将主要用于阅读，因此添加性能并不那么重要）。如何获得第 i 个值？

因此，例如，当我在集合中有数字 1、2、3、4、5 并且我想要中位数（本例中为 3）时，我该怎么做？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-24T16:28:59.170

您可以使用类似的代码

```
list.Values[index] 
```

对于排序列表。

使用 SortedDictonary 的最简单方法是使用 ElementAt() 方法：

```
dict.ElementAt(index).Value 
```

但是，这比列表情况要慢。

无论哪种情况，您都需要检查您的计数。如果是奇数，取 index = (list.length-1) / 2 )。如果是偶数，则取 index1 = list.length/2 AND index2 = list.length/2 - 1 并取平均值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-24T16:14:42.490

尝试这样的事情：

list.Values[list.Count / 2];

请注意，如果 Count 为偶数，则真正的中位数将平均中间的两个数字。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-02-26T19:19:15.800

您可以使用以下语法在特定位置提取值：

```
sortedDictionaryName.ElementAt(index); 
```

如果要在所需索引处提取元素的键或值：

```
sortedDictionaryName.ElementAt(index).Key //For only Key
sortedDictionaryName.ElementAt(index).Value //For only Value 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-13T13:00:51.257

如果需要在一个 SortedDictionary 中多次按索引获取一个元素，性能就惨不忍睹。使用 SortedDictionary 作为输入创建一个新的 SortedList 并访问 SortedList。运行速度快很多很多倍。

# java - 谁能解释 servlet 映射？

> ID：234210
> 
> 赞同：51
> 
> 时间：2008-10-24T16:16:53.750
> 
> 标签：java, jakarta-ee, servlets, spring-mvc, web.xml

我正在尝试使用 SpringMVC 编写一个 Web 应用程序。通常我只是将一些虚构的文件扩展名映射到 Spring 的前端控制器并愉快地生活，但这次我将使用类似 REST 的 URL，没有文件扩展名。

将我的上下文路径下的所有内容映射到前端控制器（我们称之为“**应用程序**”）意味着我也应该处理静态文件，这是我宁愿不做的事情（为什么要重新发明另一个轮子？），所以与 tomcat 的默认值进行一些组合servlet（我们称之为“ **tomcat** ”）似乎是要走的路。

我得到了工作做类似的事情

```
<servlet-mapping>
  <servlet-name>app</servlet-name>
  <url-pattern>/</url-pattern>
</servlet-mapping>

<servlet-mapping>
  <servlet-name>tomcat</servlet-name>
  <url-pattern>*.ext</url-pattern>
</servlet-mapping> 
```

并为我的静态内容的每个文件扩展名重复后者。我只是想知道为什么以下设置（对我来说与上面的设置相同）不起作用。

```
<!-- failed attempt #1 -->
<servlet-mapping>
  <servlet-name>app</servlet-name>
  <url-pattern>/*</url-pattern>
</servlet-mapping>

<servlet-mapping>
  <servlet-name>tomcat</servlet-name>
  <url-pattern>*.ext</url-pattern>
</servlet-mapping>

<!-- failed attempt #2 -->
<servlet-mapping>
  <servlet-name>app</servlet-name>
  <url-pattern>/</url-pattern>
</servlet-mapping>

<servlet-mapping>
  <servlet-name>tomcat</servlet-name>
  <url-pattern>/some-static-content-folder/*</url-pattern>
</servlet-mapping> 
```

任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-28T22:36:29.960

我想我可能知道发生了什么事。

在您的工作 web.xml 中，您已将您的 servlet 设置为默认 servlet（如果没有其他匹配项，/ 本身就是调用的默认 servlet），它将响应与另一个映射不匹配的任何请求。

在 Failed 1 中，您的 /* 映射确实是有效的路径映射。使用 web.xml 中的 /* 映射，它会回答除其他路径映射之外的所有请求。根据规范，扩展映射是被显式映射覆盖的隐式映射。这就是扩展映射失败的原因。一切都明确映射到应用程序。

在 Failed 2 中，App 负责一切，除了与静态内容映射匹配的内容。为了显示我设置的快速测试中发生了什么。这是一个例子。 `/some-static-content-folder/`包含`test.png`

试图访问 test.png 我试过：

```
/some-static-content-folder/test.png 
```

并且找不到该文件。然而尝试

```
/some-static-content-folder/some-static-content-folder/test.png 
```

它出现了。因此，似乎 Tomcat 默认 servlet（至少 6.0.16）丢弃了 servlet 映射，并将尝试使用剩余路径查找文件。根据这篇文章[Servlet for serving static content](https://stackoverflow.com/questions/132052) Jetty 提供了您和我所期望的行为。

有什么原因你不能为你的休息电话做一些事情，比如映射一个根目录。像 app 映射到 /rest_root/* 之类的东西比您负责 rest_root 文件夹中发生的任何事情，但其他任何地方都应由 Tomcat 处理，除非您进行另一个显式映射。我建议将您的 rest servlet 设置为路径映射，因为它可以更好地声明意图。使用 / 或 /* 似乎不合适，因为您必须列出例外情况。以 SO 为例，我的其余映射将类似于

> /users/* 用于用户 servlet
> 
> /posts/* 用于帖子 servlet

映射顺序

1.  显式（路径映射）
2.  隐式（扩展映射）
3.  默认 （/）

请纠正我做错的任何事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-31T09:01:59.863

作为参考，“失败的尝试 #2”在 Tomcat >= 到 6.0.29 的版本中完全正确。

这是在 6.0.29 版中修复的 Tomcat 错误的结果：

[https://issues.apache.org/bugzilla/show_bug.cgi?id=50026](https://issues.apache.org/bugzilla/show_bug.cgi?id=50026)

```
<!-- Correct for Tomcat >= 6.0.29 or other Servlet containers -->
<servlet-mapping>
  <servlet-name>app</servlet-name>
  <url-pattern>/</url-pattern>
</servlet-mapping>

<servlet-mapping>
  <servlet-name>default</servlet-name>
  <url-pattern>/some-static-content-folder/*</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-28T20:32:52.457

我从未尝试过像这样映射 servlet，但我*认为*/* 在技术上确实以 / 开头和以 /* 结尾，即使两个匹配项使用了相同的字符。

# xml - XML to WordML using XSLT 1.0 - 用 wordML 格式化标签替换 xml 内容中的 html 标签

> ID：234215
> 
> 赞同：1
> 
> 时间：2008-10-24T16:18:13.387
> 
> 标签：xml, xslt, wordml

我正在从一个 xml 文件创建一个 WordML 文档，该文件的元素有时包含 html 格式的文本。

```
<w:p>
  <w:r>
    <w:t> html formatted content is in here taken from xml file! </w:t>
  </w:r>
</w:p> 
```

这就是我的模板的设置方式。我有一个递归调用模板函数，它对源 xml 内容进行文本替换。当遇到“ `<b>`”标签时，我在 CDATA 中输出一个包含“ `</w:t></w:r><w:r><w:rPr><w:b/></w:rPr><w:t>`”的字符串，以关闭当前运行并启动一个启用粗体格式的新运行。当它到达一个“ `</b>`”标签时，它用下面的 CDATA 字符串“ `</w:t></w:r><w:r><w:t>`”替换它。

我想做的是使用 XSL 关闭运行标记并开始新的运行，而不使用 CDATA 字符串插入。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T17:38:23.447

Working with WordML is tricky. One tip when converting arbitrary XML to WordML using XSLT is to not worry about the text runs when processing blocks, but to instead create a template that matches text() nodes directly, and create the text runs there. It turns out that Word doesn't care if you nest text runs, which makes the problem much easier to solve.

```
 <xsl:template match="text()" priority="1">
         <w:r>
            <w:t>
               <xsl:value-of select="."/>
            </w:t>
         </w:r> 
   </xsl:template>

   <xsl:template match="@*|node()">
       <xsl:apply-templates select="@*|node()"/>
   </xsl:template>

   <xsl:template match="para">
      <w:p>
         <xsl:apply-templates select="text() | *" />
      </w:p>
   </xsl:template>

   <xsl:template match="b">
      <w:r>
         <w:rPr>
            <w:b />
         </w:rPr>
         <w:t><xsl:apply-templates /></w:t>
      </w:r>
   </xsl:template> 
```

This avoids the bad XSLT technique of inserting tags directly as escaped text. You'll end up with the bold tag as a nested text run, but as I said, Word couldn't care less. If you use this technique, you'll need to be careful to not apply templates to the empty space between paragraphs, since it will trigger the text template and create an out-of-context run.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T14:30:44.827

根据您的描述，听起来您可以解析嵌入的 html。如果是这样，只需应用模板就可以满足您的需求。输出中的 wordML 可能不正确，但希望这会有所帮助。

样本输入：

```
<text>
  <para>
    Test for paragraph 1
  </para>
  <para>
    Test for <b>paragraph 2</b>
  </para>
</text> 
```

转换：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:w="http://foo">
<xsl:template match="/">
  <w:p>
    <w:r>
      <xsl:apply-templates/>
    </w:r>     
  </w:p>
</xsl:template>
  <xsl:template match="para">
    <w:t>
      <xsl:apply-templates/>
    </w:t>
  </xsl:template>

  <xsl:template match="b">
    <w:rPr>
      <w:b/>
    </w:rPr>
      <xsl:value-of select="."/>
  </xsl:template>
</xsl:stylesheet> 
```

结果：

```
<w:p xmlns:w="http://foo">
  <w:r>
    <w:t>
      Test for paragraph 1
    </w:t>
    <w:t>
      Test for <w:rPr><w:b /></w:rPr>paragraph 2
    </w:t>
  </w:r>
</w:p> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T06:57:32.680

如果只有我理解您的问题，我很可能会为您提供帮助... html 是在 CDATA 部分中还是被解析为输入文档的一部分（因此是格式正确的 XML）？由于您谈论“文本替换”，我假设您将“html 格式化内容”视为单个字符串 (CDATA)，因此需要一个递归调用模板函数来执行字符串替换。您将能够使用 XSL 匹配模板来完成您现在正在做的事情的唯一方法是使 html 成为已解析文档（您的输入文档）的一部分。在这种情况下，您可以只匹配`b`标记并将其替换为适当的输出（再次：假设它始终可以被解析为有效的 XML）。你的问题现在已经转移了......因为（如果我正确理解你的问题）你是什么`w:t``w:r`元素，然后“重新打开”它们……这很难，因为（正如您可能怀疑的那样）很难在 XSLT 中很好地做到这一点（您不能只在模板 A 中创建一个元素，然后在模板 B 中将其关闭）。你必须开始弄乱未转义的输出等才能做到这一点。我现在做了很多假设，但这里有一个小例子可以帮助你：

*输入.xml*

```
<doc xmlns:w="urn:schemas-microsoft-com:office:word">
<w:p>
  <w:r>
    <w:t>before<b>bold</b>after</w:t>
  </w:r>
</w:p>
</doc> 
```

*convert_html.xsl*

```
<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="/doc/w:p/w:r/w:t//b">
  <xsl:value-of select="'&lt;/w:t>&lt;/w:r>&lt;w:r>&lt;w:rPr>&lt;w:b/>&lt;/w:rPr>&lt;w:t>'" disable-output-escaping="yes" />
  <xsl:apply-templates select="@*|node()"/>
  <xsl:value-of select="'&lt;/w:t>&lt;/w:r>&lt;w:r>&lt;w:t>'" disable-output-escaping="yes" />
</xsl:template> 
```

现在运行

```
xalan input.xml convert_html.xsl 
```

生产

```
<?xml version="1.0" encoding="UTF-8"?><doc xmlns:w="urn:schemas-microsoft-com:office:word">
<w:p>
  <w:r>
    <w:t>before</w:t></w:r><w:r><w:rPr><w:b/></w:rPr><w:t>bold</w:t></w:r><w:r><w:t>after</w:t>
  </w:r>
</w:p>
</doc> 
```

我想这就是你想要的。

希望这对您有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-27T16:54:04.357

为了完全完成 HTML > WordML，我推荐您的代码的这个编辑版本：

```
<xsl:template match="Body"><xsl:apply-templates select="p"/></xsl:template>

<xsl:template match="text()" priority="1"><w:r><w:t><xsl:value-of select="."/></w:t></w:r></xsl:template>

<xsl:template match="@*|node()"><xsl:apply-templates select="@*|node()"/></xsl:template>

<xsl:template match="p"><w:p><xsl:apply-templates select="text() | *" /></w:p></xsl:template>

<xsl:template match="b"><w:r><w:rPr><w:b /></w:rPr><xsl:apply-templates /></w:r></xsl:template>
<xsl:template match="i"><w:r><w:rPr><w:i /></w:rPr><xsl:apply-templates /></w:r></xsl:template>
<xsl:template match="u"><w:r><w:rPr><w:u w:val="single" /></w:rPr><xsl:apply-templates /></w:r></xsl:template> 
```

假设您的 HTML 包含在标记中的 XML 中某处

# c# - 是否可以在 .NET 中在运行时编译和执行新代码？

> ID：234217
> 
> 赞同：35
> 
> 时间：2008-10-24T16:18:26.397
> 
> 标签：c#, .net, compilation, runtime

**注意：数学表达式评估不是本题的重点。我想在.NET 中在运行时编译和执行新代码。** 话虽如此...

我想允许用户在文本框中输入任何等式，如下所示：

```
x = x / 2 * 0.07914
x = x^2 / 5 
```

并将该等式应用于传入的数据点。传入的数据点由**x**表示，每个数据点由用户指定的方程处理。几年前我做过，但我不喜欢这个解决方案，因为它需要为每次计算解析方程的文本：

```
float ApplyEquation (string equation, float dataPoint)
{
    // parse the equation string and figure out how to do the math
    // lots of messy code here...
} 
```

当您处理大量数据点时，这会带来相当多的开销。我希望能够动态地将方程转换为一个函数，这样它只需要解析一次。它看起来像这样：

```
FunctionPointer foo = ConvertEquationToCode(equation);
....
x = foo(x);  // I could then apply the equation to my incoming data like this 
```

函数 ConvertEquationToCode 将解析方程并返回指向应用适当数学的函数的指针。

该应用程序基本上会在运行时编写新代码。.NET 可以吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-04T23:12:05.990

是的！使用[Microsoft.CSharp](http://msdn.microsoft.com/en-us/library/microsoft.csharp.aspx)、[System.CodeDom.Compiler](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.aspx)和[System.Reflection](http://msdn.microsoft.com/en-us/library/system.reflection.aspx)命名空间中的方法。这是一个简单的控制台应用程序，它使用一种方法（“Add42”）编译一个类（“SomeClass”），然后允许您调用该方法。这是一个简单的示例，我将其格式化以防止滚动条出现在代码显示中。它只是为了演示在运行时编译和使用新代码。

```
using Microsoft.CSharp;
using System;
using System.CodeDom.Compiler;
using System.Reflection;

namespace RuntimeCompilationTest {
    class Program
    {
        static void Main(string[] args) {
            string sourceCode = @"
                public class SomeClass {
                    public int Add42 (int parameter) {
                        return parameter += 42;
                    }
                }";
            var compParms = new CompilerParameters{
                GenerateExecutable = false, 
                GenerateInMemory = true
            };
            var csProvider = new CSharpCodeProvider();
            CompilerResults compilerResults = 
                csProvider.CompileAssemblyFromSource(compParms, sourceCode);
            object typeInstance = 
                compilerResults.CompiledAssembly.CreateInstance("SomeClass");
            MethodInfo mi = typeInstance.GetType().GetMethod("Add42");
            int methodOutput = 
                (int)mi.Invoke(typeInstance, new object[] { 1 }); 
            Console.WriteLine(methodOutput);
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-24T16:39:21.630

你可以试试这个：[Calculator.Net](http://weblogs.asp.net/pwelter34/archive/2007/05/05/calculator-net-calculator-that-evaluates-math-expressions.aspx)

它将评估一个数学表达式。

从发布中它将支持以下内容：

```
MathEvaluator eval = new MathEvaluator();
//basic math
double result = eval.Evaluate("(2 + 1) * (1 + 2)");
//calling a function
result = eval.Evaluate("sqrt(4)");
//evaluate trigonometric 
result = eval.Evaluate("cos(pi * 45 / 180.0)");
//convert inches to feet
result = eval.Evaluate("12 [in->ft]");
//use variable
result = eval.Evaluate("answer * 10");
//add variable
eval.Variables.Add("x", 10);            
result = eval.Evaluate("x * 10"); 
```

[下载页面](http://www.loresoft.com/Applications/Calculator/Download/default.aspx) 并且在 BSD 许可下分发。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-24T16:24:04.530

是的，绝对可以让用户在文本框中键入 C#，然后编译该代码并在您的应用程序中运行它。我们在我的工作中这样做是为了允许自定义业务逻辑。

这是一篇文章（我只是略读了一下），应该可以帮助您入门：

[http://www.c-sharpcorner.com/UploadFile/ChrisBlake/RunTimeCompiler12052005045037AM/RunTimeCompiler.aspx](http://www.c-sharpcorner.com/UploadFile/ChrisBlake/RunTimeCompiler12052005045037AM/RunTimeCompiler.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-24T18:12:15.357

您还可以从空的“虚拟”XML 流创建 System.Xml.XPath.XPathNavigator，并使用 XPath 评估器评估表达式：

```
static object Evaluate ( string xp )
{
  return _nav.Evaluate ( xp );
}
static readonly System.Xml.XPath.XPathNavigator _nav
  = new System.Xml.XPath.XPathDocument (
      new StringReader ( "<r/>" ) ).CreateNavigator ( ); 
```

如果要注册要在此表达式中使用的变量，您可以动态构建 XML，您可以将其传递到采用 XPathNodeIterator 的 Evaluate 重载中。

```
<context>
  <x>2.151</x>
  <y>231.2</y>
</context> 
```

然后，您可以编写诸如“x / 2 * 0.07914”之类的表达式，然后 x 是 XML 上下文中节点的值。另一件好事是，您将可以访问所有 XPath 核心函数，其中包括数学和字符串操作方法等等。

如果您想更进一步，您甚至可以构建自己的 XsltCustomContext（或按需在此处发布），您可以在其中解析对扩展函数和变量的引用：

```
object result = Evaluate ( "my:func(234) * $myvar" ); 
```

my:func 映射到 C#/.NET 方法，该方法采用 double 或 int 作为参数。myvar 在 XSLT 上下文中注册为变量。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-24T16:21:30.340

您可以尝试查看 CodeDom 或 Lambda 表达式树。我认为其中任何一个都应该允许您完成此任务。表达树可能是更好的方法，但也有更高的学习曲线。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-24T16:54:45.497

我已经使用 CSharpCodeProvider 通过在生成器类中创建样板类和函数内容作为 const 字符串来完成此操作。然后我将用户代码插入样板并编译。

这样做相当简单，但这种方法的危险在于，输入等式的用户可能会输入几乎任何可能成为安全问题的内容，具体取决于您的应用程序。

如果安全是一个问题，我会推荐使用 Lambda 表达式树，但如果不是，使用 CSharpCodeProvider 是一个相当强大的选项。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-08-10T15:07:40.427

你看过[http://ncalc.codeplex.com](http://ncalc.codeplex.com)吗？

它是可扩展的、快速的（例如有自己的缓存），使您能够通过处理 EvaluateFunction/EvaluateParameter 事件在运行时提供自定义函数和变量。它可以解析的示例表达式：

```
Expression e = new Expression("Round(Pow(Pi, 2) + Pow([Pi2], 2) + X, 2)"); 

  e.Parameters["Pi2"] = new Expression("Pi * Pi"); 
  e.Parameters["X"] = 10; 

  e.EvaluateParameter += delegate(string name, ParameterArgs args) 
    { 
      if (name == "Pi") 
      args.Result = 3.14; 
    }; 

  Debug.Assert(117.07 == e.Evaluate()); 
```

它还原生处理 unicode 和许多数据类型。如果您想更改语法，它会附带一个 antler 文件。还有一个 fork 支持 MEF 加载新功能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-24T16:23:43.720

您可以从[这里](http://www.codeproject.com/KB/dotnet/Expr.aspx)开始，如果您真的想进入它，可以修改[Boo以满足您的需求。](http://boo.codehaus.org/)您还可以将[LUA 与 .NET](http://luaforge.net/projects/luainterface/)集成。其中任何三个都可以在您的`ConvertEquationToCode`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-09-17T12:46:35.680

试试 Vici.Parser：[在这里下载（免费）](http://viciproject.com/wiki/projects/parser/home)，它是迄今为止我发现的最灵活的表达式解析器/求值器。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-05-20T01:41:24.570

这里有一个更现代的简单表达式库：System.Linq.Dynamic.Core。它与 .NET Standard/.NET Core 兼容，可通过 NuGet 获得，源代码可用。

[https://system-linq-dynamic-core.azurewebsites.net/html/de47654c-7ae4-9302-3061-ea6307706cb8.htm](https://system-linq-dynamic-core.azurewebsites.net/html/de47654c-7ae4-9302-3061-ea6307706cb8.htm) [https://github.com/StefH/System.Linq.Dynamic.Core](https://github.com/StefH/System.Linq.Dynamic.Core) [https:// www.nuget.org/packages/System.Linq.Dynamic.Core/](https://www.nuget.org/packages/System.Linq.Dynamic.Core/)

这是一个非常轻量级的动态库。

我为这个库写了一个简单的包装类，让我做这样的事情：

```
 string sExpression = "(a == 0) ? 5 : 10";
  ExpressionEvaluator<int> exec = new ExpressionEvaluator<int>(sExpression);
  exec.AddParameter("a", 0);
  int n0 = exec.Invoke(); 
```

编译表达式后，您可以简单地更新参数值并重新调用表达式。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-24T19:56:48.500

如果一切都失败了，System.Reflection.Emit 命名空间下的类可以用来生成新的程序集、类和方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-02-04T00:58:00.663

您可以实现一个[后缀堆栈计算器](http://resume.technoplaza.net/java/postfix-calc.php)。基本上，您要做的就是将表达式转换为后缀表示法，然后简单地遍历后缀中的标记进行计算。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-24T16:23:32.317

我会做一个递归函数，它不编写代码，而是根据在该字符串中找到的特殊字符将基本运算符应用于字符串的某些部分。如果找到多个特殊字符，它会分解字符串并在这两部分上调用自身。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2010-02-04T00:52:14.513

您可以使用`system.CodeDom`它来生成代码并即时编译，看看[这里](http://msdn.microsoft.com/en-us/library/system.codedom.codecompileunit.aspx)

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2008-12-17T19:29:02.947

我不知道是否可以实现您的`ConvertEquationToCode`功能，但是，您可以生成一个表示您需要执行的计算的数据结构。

例如，您可以构建一棵树，其叶节点代表计算的输入，其非叶节点代表中间结果，其根节点代表整个计算。

它有一些优点。例如，如果您正在进行假设分析并希望一次更改一个输入的值，您可以根据已更改的值重新计算结果，同时保留未更改的结果。

# c# - 在目录中创建应用程序快捷方式

> ID：234231
> 
> 赞同：71
> 
> 时间：2008-10-24T16:22:12.693
> 
> 标签：c#, .net, file-io, shortcut

如何使用 C# 或使用 .NET 框架创建应用程序快捷方式（.lnk 文件）？

结果将是一个指向指定应用程序或 URL 的 .lnk 文件。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-10-24T17:38:42.353

它不像我想要的那么简单，但是在 vbAccelerator 上有一个很棒的类 [叫做](http://www.vbaccelerator.com/home/index.html)[ShellLink.cs](http://www.vbaccelerator.com/home/NET/Code/Libraries/Shell_Projects/Creating_and_Modifying_Shortcuts/ShellLink_Code.html)

此代码使用互操作，但不依赖 WSH。

使用这个类，创建快捷方式的代码是：

```
private static void configStep_addShortcutToStartupGroup()
{
    using (ShellLink shortcut = new ShellLink())
    {
        shortcut.Target = Application.ExecutablePath;
        shortcut.WorkingDirectory = Path.GetDirectoryName(Application.ExecutablePath);
        shortcut.Description = "My Shorcut Name Here";
        shortcut.DisplayMode = ShellLink.LinkDisplayMode.edmNormal;
        shortcut.Save(STARTUP_SHORTCUT_FILEPATH);
    }
} 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2013-11-11T19:13:02.650

干净整洁。( **.NET 4.0** )

```
Type t = Type.GetTypeFromCLSID(new Guid("72C24DD5-D70A-438B-8A42-98424B88AFB8")); //Windows Script Host Shell Object
dynamic shell = Activator.CreateInstance(t);
try{
    var lnk = shell.CreateShortcut("sc.lnk");
    try{
        lnk.TargetPath = @"C:\something";
        lnk.IconLocation = "shell32.dll, 1";
        lnk.Save();
    }finally{
        Marshal.FinalReleaseComObject(lnk);
    }
}finally{
    Marshal.FinalReleaseComObject(shell);
} 
```

就是这样，不需要额外的代码。*CreateShortcut*甚至可以从文件中加载快捷方式，因此*TargetPath*等属性会返回现有信息。[快捷方式对象属性](http://msdn.microsoft.com/en-us/library/f5y78918%28v=vs.84%29.aspx)。

对于不支持动态类型的 .NET 版本，也可以采用这种方式。( **.NET 3.5** )

```
Type t = Type.GetTypeFromCLSID(new Guid("72C24DD5-D70A-438B-8A42-98424B88AFB8")); //Windows Script Host Shell Object
object shell = Activator.CreateInstance(t);
try{
    object lnk = t.InvokeMember("CreateShortcut", BindingFlags.InvokeMethod, null, shell, new object[]{"sc.lnk"});
    try{
        t.InvokeMember("TargetPath", BindingFlags.SetProperty, null, lnk, new object[]{@"C:\whatever"});
        t.InvokeMember("IconLocation", BindingFlags.SetProperty, null, lnk, new object[]{"shell32.dll, 5"});
        t.InvokeMember("Save", BindingFlags.InvokeMethod, null, lnk, null);
    }finally{
        Marshal.FinalReleaseComObject(lnk);
    }
}finally{
    Marshal.FinalReleaseComObject(shell);
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-04-29T11:17:00.237

我发现了这样的事情：

```
private void appShortcutToDesktop(string linkName)
{
    string deskDir = Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory);

    using (StreamWriter writer = new StreamWriter(deskDir + "\\" + linkName + ".url"))
    {
        string app = System.Reflection.Assembly.GetExecutingAssembly().Location;
        writer.WriteLine("[InternetShortcut]");
        writer.WriteLine("URL=file:///" + app);
        writer.WriteLine("IconIndex=0");
        string icon = app.Replace('\\', '/');
        writer.WriteLine("IconFile=" + icon);
        writer.Flush();
    }
} 
```

[悲伤人文章“url-link-to-desktop”中的](http://www.sorrowman.org/c-sharp-programmer/url-link-to-desktop.html)原始代码

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-20T03:49:21.797

[下载 IWshRuntimeLibrary](http://originaldll.com/file/interop.iwshruntimelibrary.dll/20842.html)

您还需要导入 COM 库`IWshRuntimeLibrary`。右键单击您的项目 -> 添加引用 -> COM -> IWshRuntimeLibrary -> 添加，然后使用以下代码片段。

```
private void createShortcutOnDesktop(String executablePath)
{
    // Create a new instance of WshShellClass

    WshShell lib = new WshShellClass();
    // Create the shortcut

    IWshRuntimeLibrary.IWshShortcut MyShortcut;

    // Choose the path for the shortcut
    string deskDir = Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory);
    MyShortcut = (IWshRuntimeLibrary.IWshShortcut)lib.CreateShortcut(@deskDir+"\\AZ.lnk");

    // Where the shortcut should point to

    //MyShortcut.TargetPath = Application.ExecutablePath;
    MyShortcut.TargetPath = @executablePath;

    // Description for the shortcut

    MyShortcut.Description = "Launch AZ Client";

    StreamWriter writer = new StreamWriter(@"D:\AZ\logo.ico");
    Properties.Resources.system.Save(writer.BaseStream);
    writer.Flush();
    writer.Close();
    // Location for the shortcut's icon           

    MyShortcut.IconLocation = @"D:\AZ\logo.ico";

    // Create the shortcut at the given path

    MyShortcut.Save();

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-24T18:03:26.483

在调查了我在 SO 上发现的所有可能性后，我选择了[ShellLink](http://msjogren.webhost4life.com/dotnet/eng/samples/dotnet_shelllink.asp)：

```
//Create new shortcut
using (var shellShortcut = new ShellShortcut(newShortcutPath)
{
     Path = path
     WorkingDirectory = workingDir,
     Arguments = args,
     IconPath = iconPath,
     IconIndex = iconIndex,
     Description = description,
})
{
    shellShortcut.Save();
}

//Read existing shortcut
using (var shellShortcut = new ShellShortcut(existingShortcut))
{
    path = shellShortcut.Path;
    args = shellShortcut.Arguments;
    workingDir = shellShortcut.WorkingDirectory;
    ...
} 
```

除了简单有效之外，作者（Mattias Sjögren，MS MVP）还是某种 COM/PInvoke/Interop 大师，仔细阅读他的代码，我相信它比其他替代方案更强大。

应该提到的是，快捷方式文件也可以由几个命令行实用程序创建（反过来可以很容易地从 C#/.NET 调用）。我从未尝试过其中任何一个，但我会从[NirCmd](http://www.nirsoft.net/utils/nircmd.html)开始（NirSoft 有类似 SysInternals 的质量工具）。

不幸的是，NirCmd 无法*解析*快捷方式文件（仅创建它们），但为此目的，[TZWorks lp](https://www.tzworks.net/prototype_page.php?proto_id=11)似乎有能力。它甚至可以将其输出格式化为 csv。[lnk-parser](https://code.google.com/p/lnk-parser/)看起来也不错（它可以输出 HTML 和 CSV）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-09T19:06:37.933

与[IllidanS4 的回答](https://stackoverflow.com/a/19914018/590790)类似，使用[Windows Script Host](https://msdn.microsoft.com/en-us/library/ec0wcxh3(v=vs.84).aspx)对我来说是最简单的解决方案（在 Windows 8 64 位上测试）。

但是，与其通过代码手动导入 COM 类型，不如将 COM 类型库添加为参考更容易。选择`References->Add Reference...`，`COM->Type Libraries`找到并添加*“Windows Script Host Object Model”*。

这将导入命名空间`IWshRuntimeLibrary`，您可以从中访问：

```
WshShell shell = new WshShell();
IWshShortcut link = (IWshShortcut)shell.CreateShortcut(LinkPathName);
link.TargetPath=TargetPathName;
link.Save(); 
```

[归功于 Jim Hollenhorst](http://www.codeproject.com/Articles/3905/Creating-Shell-Links-Shortcuts-in-NET-Programs-Usi)。

# ruby-on-rails - 为什么 rake 会抛出这个 Rails 迁移错误？

> ID：234233
> 
> 赞同：4
> 
> 时间：2008-10-24T16:22:26.657
> 
> 标签：ruby-on-rails, migration, rake

我有两台机器......一台开发机器和一台生产机器。当我第一次将我的 rails 应用程序带到生产服务器上时，我没有遇到任何问题。我只是通过运行 rake db:schema:load RAILS_ENV=production 来导入 schema.rb。一切都好。

所以，然后在我的开发机器上，我进行了一些更改和另一个迁移，然后将新应用程序复制到生产机器上。然后我尝试通过运行 rake db:migrate RAILS_ENV=production 来更新数据库。我收到以下错误：“数据库中已经有一个名为 'schema_migrations' 的对象。”

我在想自己，你不开玩笑，瑞克……你创造了它！我在 rake 上运行跟踪，似乎 rake 认为这是它第一次运行。但是，通过分析我的开发机器和生产机器上的“schema_migrations”表，您可以看到一个迁移存在差异，即我想要迁移的那个。

我也尝试过明确定义版本号，但这也不起作用。

关于如何使生产服务器保持最新的任何想法？

**更新：**

让我首先说我不能只是“删除”数据库。这是一个生产服务器，里面已经有超过 10 万条记录。如果以后出现类似的问题怎么办？我是不是每次发生数据库问题时都删除表？这次它可能会奏效，但它似乎不是每个数据库问题的实用长期解决方案。我怀疑我现在遇到的问题对我来说是独一无二的。

1.  听起来“schema_info”表和“schema_migrations”表是一样的。在我的设置中，我只有“schema_migrations”。如前所述，生产服务器上的“schema_migrations”表和开发机器上的差异只是一条记录。即包含我要迁移的更改的版本号的记录。

2.  从我读过的《Simply Rails 2》一书中，它指出当第一次迁移到生产服务器时，应该只运行 rake:db:schema:load，而不是运行 rake db:migrate。

3.  如果重要的话，我使用的是 Rails 2.1 版。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T00:33:37.590

关于您的更新：

1.  我不明白您的生产 schema_migrations 和开发版本之间有什么区别。两个表中是否都有记录（应该只有 1 列，“版本”，对）或者开发数据库中是否有一条记录而生产中是否有零记录？如果生产表中的记录为零，则执行以下操作：

    `ActiveRecord::Base.connection.execute("INSERT schema_migrations (version) VALUES(#{my version number that production is supposedly on})")`

2.  或者，您可以尝试在生产环境中完全删除 schema_migrations 表：

    `ActiveRecord::Base.connection.execute("DROP TABLE schema_migrations")`

    然后，重新运行`rake db:migrate RAILS_ENV=production`. 不过，这将从版本 1 开始运行迁移，这可能不是您所追求的。

3.  或者，您可以在生产环境中启动 IRB 会话，对要加载的迁移文件执行“要求”或“加载”（我永远不记得哪个，或者是否重要），然后调用`MyMigrationClass.up`. 之后，您需要在 schema_migrations 表中手动设置版本号，因为您仍然会遇到问题，但作为一种快速修复类型的 hack，它会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T20:53:24.547

根据生产中使用的系统，我看到以下情况不起作用的**情况**：

```
rake db:migrate RAILS_ENV=production 
```

但是这个确实有效：

```
RAILS_ENV=production rake db:migrate 
```

古怪，我知道，但值得一试，看看它是否有所作为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T23:48:14.773

这是一个猜测，我承认：我认为因为您首先在生产环境中运行 db:schema:load 而不是 db:migrate，所以您得到了 db 的结构，但没有迁移到您的 schema_info 表中的数据。所以现在，当你在生产环境中运行 migrate 时，schema_info 中没有数据，这就是为什么 migrate 认为它还没有运行（因为它还没有运行）。

也就是说......你说你已经查看了“schema_migrations”表，并且从开发到生产存在一个版本的差异......我还没有听说过那个表，虽然我几个月落后于我的 Rails 版本。也许您可以尝试在生产环境中创建一个“schema_info”表，其中包含一个“版本”列，然后添加一行包含您认为您的生产环境所在的版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T09:41:45.703

如果您得到“数据库中已经有一个名为 'schema_migrations' 的对象。” 错误消息然后我怀疑您使用 MS SQLServer 作为您的数据库？（因为这看起来像 MS SQL Server 错误消息）

如果是，那么您使用的是哪个 ActiveRecord 数据库适配器？（你的 database.yml 文件是什么，你安装了哪些 gem 来访问 MS SQL Server 数据库？）

目前，Rails 似乎在生产模式中找不到 schema_migrations 表，因此尝试创建它，但此创建失败并显示数据库错误消息。可能原因是 schema_migrations 表名中的大写/小写字符 - 据我了解 MS SQL Server 标识符区分大小写。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T21:52:03.007

schema_info 来自旧版本的 Rails。schema_migrations 是新来的。您应该能够删除 schema_info 表，因为它将不再被使用。您可能需要搜索与此名称更改相关的任何问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T21:57:03.933

rake db:schema:load 将从 schema.rb 加载数据库结构。该文件是数据库结构的当前表示。当您有一个需要创建所有表和索引的空模式（数据库）时使用它。它使您不必运行所有迁移。如果您有一个包含数据的现有生产数据库，您不想运行它。正如其他人所说，那会很糟糕！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-25T00:18:53.403

我只想删除数据库，再次添加它并运行 rake rb:migrate。布拉德是正确的，当您运行模式加载时，它没有在 schema_migrations 表中放置任何记录。

如果在生产服务器上有不能丢失的数据，这当然会更复杂。您可以获取 rake 备份任务（不确定这是否是核心的一部分），然后在您的生产数据库上运行 rake db:backup:write，然后在生产中获得最新的迁移后，运行 rake db：备份：读取。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-21T14:00:21.927

我知道这篇文章是很久以前的，但我偶然发现它并没有真正得到答复。当它出现在谷歌上时，就到这里。

当您执行 rake db:schema:dump（或者当构建脚本为您完成此操作时）时，它会将迁移表的定义放入 schema.rb。在脚本结束时，该进程将尝试再次创建表，但它显然已经存在。只需在运行 rake:schema:load 之前从 schema.rb 中删除迁移表，就不会出现错误消息。

您需要在迁移表中设置版本号以随后运行迁移。因此，重要的是要知道您的 schema.rb 与哪个版本相关，或者删除所有旧迁移（它们安全地在您的 SCM 中，对吗？）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-25T03:31:57.660

```
rake db:migrate RAILS_ENV=production 
```

仅将`db:schema:load`任务用于第一次创建，应迁移增量更改。

# c# - 从安全的角度来看，在 Windows 中使用管道是否被认为是危险的？

> ID：234234
> 
> 赞同：4
> 
> 时间：2008-10-24T16:22:58.790
> 
> 标签：c#, c++, windows, winapi, pipe

从安全的角度来看，在 Windows 中使用管道是否被认为是危险的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T16:32:01.440

管道不是 Windows 中的特定安全风险。如果您担心安全性，请确保将管道上的安全描述符设置为适当的 DACL。如果您的使用要求管道对任何人都开放，那么您必须将传入数据视为可疑数据，就像任何文件或网络输入一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T16:31:08.277

如果您担心网络嗅探，我想可能是因为我不认为系统之间的管道是加密的。我不确切知道它们是如何在 Windows 中实现的，但我希望同一台机器上的进程/线程之间的管道将通过共享内存实现，并且不会让流量泄漏到盒子外面。如果您需要系统之间的安全通信，我会使用安全套接字。

# vb6 - 更改 DTPicker 控件中的文本颜色

> ID：234238
> 
> 赞同：5
> 
> 时间：2008-10-24T16:24:14.623
> 
> 标签：vb6, colors

在 VB6 中，我在表单上有一个 DTPicker 控件。（DTPicker 是日历日期/时间选择器，包含在 Microsoft Windows Common Controls-2 6.0 中，可从“组件”对话框中获得。）

虽然有许多属性会影响日历下拉时的颜色，但没有属性可以更改文本框中显示的日期颜色。我正在寻找类似于标准 TextBox 的 ForeColor 属性的东西。

有没有人有一点 API 魔法可以让我模拟那个属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T20:31:22.800

我讨厌发布一些没有真正帮助的东西，但这似乎超出了微软希望开发人员对控件进行的操作范围。虽然肯定有一个 API 调用来设置颜色（Windows 肯定知道在启用时将其绘制为黑色，在禁用时将其绘制为灰色），但这样做的方法却让我无法理解。

我的建议是，如果没有其他人回应如何做你需要的事情，要么获得具有所需属性的新 DateTime Picker 控件（似乎有一些第 3 方选项），要么“滚动你自己的”控件.

FWIW，同样的问题存在于 VB.NET 中，除了 Microsoft 专门覆盖（然后隐藏）从通用 Control 对象继承的 ForeColor（和 BackColor）属性，什么都不做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-20T14:59:11.103

我将解决 DatePicker 对象的两个问题以及它们的解决方法。

1.  您不能将空白值放入 DatePicker，这导致我遇到第二个问题。
2.  您不能将字体颜色更改为至少使其显示为空白。

为了保持 DatePicker 的功能并获得具有空白值和常规字体格式选项（颜色等）的能力，我使用了两个对象。首先制作一个 DTP 对象并设置宽度，以便您只能真正看到下拉箭头。对我来说这是 15 岁。然后制作一个足够宽的常规 TextBox 以容纳您的日期。将 DTP 箭头直接放在文本框的右侧（或左侧）。然后，您只需将代码添加到 DTP 的 Change 事件中，即可将其 .Value 复制到 TextBox 的 .Text 中，如下所示：

```
Private Sub MyDTP_Change()    
    MyUserForm.MyDateTextBox.Text = MyUserForm.MyDTP.Value
End Sub 
```

然后让您需要访问 MyDateTextBox.Text 而不是 MyDTP.Value 和 presto 的任何数据引用！您可以通过常规 TextBox 的格式控制获得 DTP 的功能。

编辑：对不起 JeffK，9 年前我没有在生产环境中使用 VB。:) 我也想为此添加功能的另一面。这允许在 TextBox 和 DTP 之间进行双向同步。IE：在文本框中手动输入日期，然后是 DTP 日历。如果 TextBox 为空或日期无效，则 DTP 默认为今天的日期。

```
Private Sub MyDateTextBox_Change()    
    If MyUserForm.MyDateTextBox.Text <> "" And 
    IsDate(MyUserForm.MyDateTextBox.Text) = True Then
        If CDate(MyUserForm.MyDateTextBox.Text) <= MyUserForm.MyDPT.MaxDate And _
        CDate(MyUserForm.MyDateTextBox.Text) >= MyUserForm.MyDPT.MinDate Then
            MyUserForm.MyDTP.Value = MyUserForm.MyDateTextBox.Text
        Else
            MyUserForm.MyDTP.Value = Date
        End If
    Else
        MyUserForm.MyDTP.Value = Date
    End If
End Sub 
```

# c# - C# Action lambda 代码块的限制

> ID：234239
> 
> 赞同：0
> 
> 时间：2008-10-24T16:24:31.067
> 
> 标签：c#, .net-3.5, lambda

C# .NET 3.5。我试图了解 C# Action 对象的内在限制。在 lamda（实际上是 lamdas 吗？）中，我们可以执行赋值、调用函数，甚至执行三元运算，但不能执行多语句运算。

这是因为单语句执行只是将其包装在委托中的语法糖吗？为什么下面的第一个示例不起作用？

```
public class MyClass
{
    private int m_Count = 0;

    public void Test()
    {
        int value = 0;

        // Does not work, throws compile error
        Action action = () => { if(m_Count < 10) m_Count++; value = m_Count; }

        // Works
        Action action2 = () => value = delegate(){ 
            if(m_Count < 10) 
                m_Count++; 

            return m_Count;
        };

        // Works
        Action action3 = () => value = m_Count;

        // Works
        Action action4 = () => value = m_Count < 10 ? m_Count++ : 0;

        // Works
        Action action5 = () => value = Increment();
    }

    public int Increment()
    {
        if (m_Count < 10)
            m_Count++;

        return m_Count;
    }
} 
```

编辑： Grr，对不起噪音。本来，我有

```
Action action = () => if(m_Count < 10) m_Count++; value = m_Count; 
```

这引发了编译错误，但在发布之前我想我会尝试将它包装在大括号中

```
Action action = () => { if(m_Count < 10) m_Count++; value = m_Count; } 
```

这也引发了编译错误，所以我得出结论认为这是同样的问题。但是，如果我在大括号后面加上一个分号，它就可以了

```
Action action = () => { if(m_Count < 10) m_Count++; value = m_Count; }; 
```

对不起，噪音！

编辑 2：感谢 cfeduke，您在我上面的编辑同时发布 - 继续并标记为答案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-24T16:30:30.337

你缺少一个分号，它编译：

```
 Action action = () => { if (m_Count < 10) m_Count++; value = m_Count; }; 
```

当你说`type name = statement;`你需要一个分号时，即使你对代码块使用大括号。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T16:34:46.787

cfeduke 已经发布了让您的代码编译的解决方案。

请注意，您不能将语句块 lambda 表达式转换为表达式树，即使您可以将它们转换为委托。对于可以转换为表达式树的内容还有[其他限制。](http://csharpindepth.com/ViewNote.aspx?NoteID=68)

回到委托，那里有*一些*限制 - 例如，您不能在 lambda 表达式中编写迭代器块。（我以前就想这样做——当你试图理解它时会变得很奇怪。但你不能这样做。）在大多数情况下，你几乎可以做任何你可以在一个方法中做的事情。

# php - PHP 中的 echo 和 print 有何不同？

> ID：234241
> 
> 赞同：226
> 
> 时间：2008-10-24T16:25:12.767
> 
> 标签：php, echo

> **可能重复：**
> [参考：比较 PHP 的打印和回显](https://stackoverflow.com/questions/7094118/reference-comparing-phps-print-and-echo)

PHP 中这两个函数之间有什么主要和根本的区别吗？

* * *

## 回答 #1

> 赞同：294
> 
> 时间：2008-10-24T16:27:56.393

来自： [http ://web.archive.org/web/20090221144611/http://faqts.com/knowledge_base/view.phtml/aid/1/fid/40](http://web.archive.org/web/20090221144611/http://faqts.com/knowledge_base/view.phtml/aid/1/fid/40)

1.  速度。两者之间存在差异，但在速度方面，您使用哪一个应该无关紧要。echo 稍微快一点，因为如果您真的想深入了解细节，它不会设置返回值。

2.  表达。`print()`表现得像一个函数，你可以这样做 `$ret = print "Hello World"`：并且`$ret`会`1`。这意味着 print 可以用作 echo 不能的更复杂表达式的一部分。PHP手册中的一个例子：

```
$b ? print "true" : print "false"; 
```

print 也是优先表的一部分，如果它要在复杂的表达式中使用，它需要它。它只是在优先级列表的底部。只是`,` `AND` `OR` `XOR`较低。

3.  参数）。语法是：`echo expression [, expression[, expression] ... ]`但`echo ( expression, expression )`无效。这将是有效的`echo ("howdy"),("partner")`：同：`echo "howdy","partner"`; （把括号放在那个简单的例子中没有任何意义，因为像这样的单个术语没有运算符优先级问题。）

因此，不带括号的 echo 可以采用多个参数，这些参数被连接起来：

```
 echo  "and a ", 1, 2, 3;   // comma-separated without parentheses
   echo ("and a 123");        // just one parameter with parentheses 
```

`print()`只能带一个参数：

```
 print ("and a 123");
   print  "and a 123"; 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2008-10-24T16:29:33.380

他们是：

*   print 只需要一个参数，而 echo 可以有多个参数。
*   print 返回一个值 (1)，因此可以用作表达式。
*   echo 稍微快一点。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-15T16:47:45.433

为了补充上面的答案，虽然 print 只能采用一个参数，但它允许连接多个值，即：

```
$count = 5;

print "This is " . $count . " values in " . $count/5 . " parameter"; 
```

这是 1 个参数中的 5 个值

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-19T18:04:12.017

我认为`print()`比`echo`.

我喜欢`print()`仅用于以下情况：

```
 echo 'Doing some stuff... ';
 foo() and print("ok.\n") or print("error: " . getError() . ".\n"); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-24T16:28:54.333

正如 PHP.net 手册所建议的，请阅读[此讨论](http://www.faqts.com/knowledge_base/view.phtml/aid/1/fid/40)。

一个主要区别是`echo`可以采用多个参数来输出。例如：

```
echo 'foo', 'bar';   // Concatenates the 2 strings
print('foo', 'bar'); // Fatal error 
```

如果您要评估输出语句的结果（如下所示），请使用`print`. 如果没有，请使用`echo`.

```
$res = print('test');
var_dump($res); //bool(true) 
```

# java - Java 文件扩展名正则表达式

> ID：234249
> 
> 赞同：4
> 
> 时间：2008-10-24T16:27:02.807
> 
> 标签：java, regex

我正在尝试提出一个 Java 正则表达式，它仅在文件名具有有效扩展名的情况下才会匹配。例如，它应该匹配“foo.bar”和“foo.b”，但都不匹配“foo”。也不是“富”。

我编写了以下测试程序

```
public static void main(String[] args) {
  Pattern fileExtensionPattern = Pattern.compile("\\.\\w+\\z");

  boolean one = fileExtensionPattern.matcher("foo.bar").matches();
  boolean two = fileExtensionPattern.matcher("foo.b").matches();
  boolean three = fileExtensionPattern.matcher("foo.").matches();
  boolean four = fileExtensionPattern.matcher("foo").matches();

  System.out.println(one + " " + two + " " + three + " " + four);
} 
```

我希望这会打印“真真假假”，但它会为所有 4 种情况打印假。我哪里错了？

干杯，唐

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-24T16:34:04.213

Matcher.matches [()](http://java.sun.com/javase/6/docs/api/java/util/regex/Matcher.html#matches())函数尝试将模式与整个输入进行匹配。因此，您必须添加`.*`到您的正则表达式的开头（`\\Z`结尾也是多余的），或者使用[find()](http://java.sun.com/javase/6/docs/api/java/util/regex/Matcher.html#find())方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-24T17:11:19.270

```
public boolean isFilename(String filename) {
    int i=filename.lastInstanceOf(".");
    return(i != -1 && i != filename.length - 1)
} 
```

会明显更快，无论您做什么，将其放入方法中都会更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T10:38:45.287

```
package regularexpression;

import java.io.File;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class RegularFile {
    public static void main(String[] args) {
        new RegularFile();
    }

    public RegularFile() {

        String fileName = null;
        boolean bName = false;
        int iCount = 0;
        File dir = new File("C:/regularfolder");
        File[] files = dir.listFiles();
        System.out.println("List Of Files ::");

        for (File f : files) {

            fileName = f.getName();
            System.out.println(fileName);

            Pattern uName = Pattern.compile(".*l.zip.*");
            Matcher mUname = uName.matcher(fileName);
            bName = mUname.matches();
            if (bName) {
                iCount++;

            }
        }
        System.out.println("File Count In Folder ::" + iCount);

    }
} 
```

# windows - 如何记录每次登录和注销 Windows XP 的时间？

> ID：234251
> 
> 赞同：2
> 
> 时间：2008-10-24T16:27:34.163
> 
> 标签：windows, logging, time, events

我注意到每次我启动或关闭 Windows 时，Windows XP 事件查看器都会在系统日志下显示典型操作列表，并且我可以知道一天的开始和结束时间。

无论如何，我每次锁定屏幕和每次重新登录时都可以记录时间吗？也许有一种方法可以欺骗 System Event Logger 提交，但如果没有，免费的第三方工具也会很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T16:33:09.177

您绝对可以安排任务在您登录或注销时运行。只需编写一个小脚本来附加一个带有系统时间的文件，并安排它在您登录或注销时运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T16:33:40.737

我认为[这篇文章](http://www.eggheadcafe.com/software/aspnet/31913289/screen-saver-lock-event-i.aspx)对这个主题有一些有趣的想法。你可能想看看它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T16:36:08.640

您的安全事件日志记录帐户登录和注销事件。不确定屏幕保护程序锁定然后再次登录是否算作可记录事件。

Timesnapper 可能是您正在寻找的东西：

[http://www.timesnapper.com/](http://www.timesnapper.com/)

跟踪您的一天，甚至跟踪您不使用计算机的时间。

不是免费的，但 24 美元也几乎不会让银行破产。

# .net - CAS：从 Intranet 运行 exe

> ID：234253
> 
> 赞同：0
> 
> 时间：2008-10-24T16:27:48.687
> 
> 标签：.net, security, cas

在我毫不留情地被抨击和否决之前，我的公司将不允许在非开发机器上安装 .NET3.5（其他人目前在 3.0 上）。

我在网络共享上有一个托管 exe，需要能够从那里运行。这是 pre-.NET3.5SP1 的常见问题，但我不知道如何解决。除了 MSDN CAS 文章（就像尝试阅读和理解 EULA）之外，我还阅读 [了这个问题](https://stackoverflow.com/questions/197835/how-to-get-rid-of-security-exception)以及[这篇文章。](http://blogs.msdn.com/vancem/archive/2008/08/13/net-framework-3-5-sp1-allows-managed-code-to-be-launched-from-a-network-share.aspx)我似乎无法解决这个问题。

我试过签名；以及文章中的其他建议。我发现让它从网络上运行的唯一方法是让它成为一个点击一次的应用程序并发布它；这是不可接受的，因为它在已发布的目录中创建了一堆不同的文件（这使我们的技术水平较低的用户感到困惑）并在控制面板的“添加/删除程序”中创建条目。

我只是一个开发人员，所以我无权设置/更改机器策略等。谁能给我一步一步的说明（或指向一个易于阅读的站点），说明需要做什么才能使这个东西从网络上运行？甚至可以不设置机器/域安全/软件策略（我无权访问）吗？

**编辑**
好吧...我预计会被否决；但是，如果人们能解释为什么他们投了反对票，那就太好了。这是一个严重的问题，许多人似乎都遇到了问题；几乎没有人知道如何解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T16:37:32.803

Pre 3.5 并且无法访问机器本身或机器/域策略，我认为你不走运。

蛮力方法是在每台计算机上转到控制面板 > 管理工具 > MS .NET Framework XX 向导 > 调整 .NET 安全性，并将本地 Intranet 区域的安全级别设置为 FullTrust。这种方法的安全风险在于，现在您信任Intranet 上可用的*所有*.NET 代码，这可能不是您的组织想要的。

更为外科手术的方法是通过使用开发团队的私钥（可由 .NET 生成）对 .NET 程序集进行签名，为它们赋予一个强名称。然后在您的用户计算机上执行一次只安装策略，该策略信任使用您团队的密钥签名的所有程序集。现在，您团队的所有 .NET 程序集都将受到完全信任，无论它们实际位于何处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T16:56:38.257

您可以创建一个非托管引导程序，在本地复制您的 .net 代码并启动它。或者您可以使用单击一次并在另一个目录中创建快捷方式来隐藏其他文件。

# line - 样条与直线的交点

> ID：234261
> 
> 赞同：11
> 
> 时间：2008-10-24T16:29:12.273
> 
> 标签：line, intersection, spline

我试图找到一种方法来计算 b 样条和直线之间的交点。到目前为止，谷歌并没有提供太多帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-24T16:53:12.723

纯数学方法：

*   变换样条线和直线，使直线位于 X 轴上。
*   计算样条上 Y = 0 的点（取决于样条的顺序）。
*   将这些点转换回原始坐标系。

如果这是你要走的路，我可以制定出必要的公式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-10T20:49:50.243

我听说过的最有效的算法称为 Bezier 裁剪。

这是[关于曲线和样条相交的书籍章节](http://cagd.cs.byu.edu/~557/text/ch7.pdf)（pdf）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-24T16:34:59.890

您最好的方法可能是将样条分解成单独的线段并测试每个线段是否与线相交。样条曲线可能与直线相交不止一个点，因此您还必须确定您感兴趣的点。

# css - 未知属性'MozOpacity' - 是什么意思？

> ID：234265
> 
> 赞同：0
> 
> 时间：2008-10-24T16:30:08.217
> 
> 标签：css

我正在使用 Chris Pederick 的 Firefox 插件["Web Developer 1.1.6"](http://chrispederick.com/work/web-developer/)。当我在我的网站上点击某个网页时收到此警告：

> 未知属性“MozOpacity”。声明被放弃。

这是什么意思，我该如何在我的网站上解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T16:41:08.070

浏览器习惯性地为实验性或专有功能添加前缀*-moz*（用于基于 Gecko 的浏览器）或*-webkit*（用于 webkit），以便可以使用它们但不会干扰标准 CSS 渲染。在*-moz-opacity*的情况下，似乎他们终于删除了专有标签，因为支持标准*不透明*标签。

我不认为 IE 团队遵循任何等效的约定，但是 IE 再次落后于包，它可能永远不会出现；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T16:31:27.620

您是否`mozopacity`在 CSS 样式表中使用？这可能拼写错误，因此会触发错误。

您可能正在寻找[`-moz-opacity`](https://developer.mozilla.org/en/CSS/opacity)从 Firefox 3.0 开始删除的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T12:46:23.960

这可能不是您网站的问题。一些浏览器插件——例如，Firebug 或 Web Developer——通常会为页面动态添加额外的样式以进行调试；我注意到非官方的 -moz-* 样式在我自己的 Firefox 调试中弹出。

但是，这不一定是您的页面的问题。您的用户代理首先创建自己，然后假设您的页面存在问题，这可能是一个问题。

首先，我建议尝试禁用您的 Firefox 插件并查看是否仍然出现上述错误。然后，确保您的插件是最新的——尤其是任何可能在页面加载后操纵 DOM 的开发/调试类型的插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T16:34:46.740

有一些专有的 CSS 声明： - 过滤器（来自微软）；- -moz-corner-radius, -moz-opacity 和其他 -moz 以 mozilla 为前缀 - -khtml 以 safari 为前缀

这些不是标准的，它仅适用于该浏览器。如果您不希望 -moz 属性在 safari 上工作并在 firefox 上进行过滤，则可以忽略该警告 :)

# c# - 自定义 MembershipProvider 初始化方法

> ID：234268
> 
> 赞同：9
> 
> 时间：2008-10-24T16:30:58.633
> 
> 标签：c#, .net, membership-provider

当覆盖 MembershipProvider 并直接调用它时，有没有办法填充 Initialize 方法的 NameValueCollection 配置参数，而无需手动查看配置文件进行设置？

显然，这个 Initialize 正在被 asp.net 调用，并且配置正在某个地方填充。我已经实现了自己的 MembershipProvider，它通过内置控件运行良好。我想创建我的提供程序的一个新实例并直接调用它，但我真的不想解析 MembershipProvider 的 .config，它是连接字符串名称，然后是连接字符串（如果它已经在某处完成） .

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-24T21:10:19.117

tvanfosson-感谢您的帮助。（如果我有必要的 15 分，我会投票给你）

从您的链接中，我能够弄清楚。事实证明，初始化过程的第二个参数是来自提供者的参数列表，可以通过以下方式访问：

```
string configPath = "~/web.config";
Configuration config = WebConfigurationManager.OpenWebConfiguration(configPath);
MembershipSection section = (MembershipSection)config.GetSection("system.web/membership");
ProviderSettingsCollection settings = section.Providers;
NameValueCollection membershipParams = settings[section.DefaultProvider].Parameters;
Initialize(section.DefaultProvider, membershipParams); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-24T16:44:51.977

不知道为什么要创建一个新的，但如果你自己创建它，你需要阅读网络配置并自己获取值以传递给 Initialize() 因为这是在类之外完成的。不过，我敢肯定，该部分已经有一个部分处理程序，因此只需要做以下事情：

```
MembershipSection section  = WebConfigurationManager.GetSection("membership"); 
```

然后找到您的提供者并访问其属性以构造 NameValueCollection。我认为您不必编写任何代码来解析配置部分。

这是 MSDN 上的[MembershipSection](http://msdn.microsoft.com/en-us/library/system.web.configuration.membershipsection.aspx)文档。从那里向下钻取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-27T01:13:26.223

在任何情况下，您都不应该创建 MembershipProvider 的实例。它通过标准的 asp.net 基础结构创建和初始化。您可以通过如下代码访问它：

var customerMembership = Membership.Provider;

# c++ - 精心设计的应用程序的开源示例

> ID：234276
> 
> 赞同：16
> 
> 时间：2008-10-24T16:32:42.797
> 
> 标签：c++, design-patterns, architecture, open-source

您是否知道设计精良且易于分析的开源应用程序？

具体来说，我对基于 C++ 的程序中的实际应用程序对象关系映射感兴趣，其中域模型和持久性/序列化功能之间有很好的分离。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T18:14:50.017

如果您包含设计良好的开源*库*，这些库对分析具有指导意义，请查看[Boost](http://www.boost.org)。

关于持久性/序列化（虽然不是关系映射），看看[Boost Serialization](http://www.boost.org/doc/libs/1_36_0/libs/serialization/doc/index.html)，你可能会找到好主意！

> “......世界上最受推崇和专业设计的 C++ 库项目之一。” — Herb Sutter 和 Andrei Alexandrescu，C++ 编码标准
> 
> “第55条：熟悉Boost。” — Scott Meyers，Effective C++，第 3 版。
> 
> “对于大多数程序员来说，显而易见的解决方案是使用一个库，该库提供一个优雅而高效的平台，独立于所需的服务。例如 BOOST……” — Bjarne Stroustrup，C++ 中的抽象、库和效率

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T18:01:41.947

While this doesn't fit your specific requirements (it's not a business app for a start), I think that [OGRE 3D](http://ogre3d.org "OGRE") is a great example of an open source C++ project.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-25T09:24:18.620

据说 V8 javascript 引擎设计得非常好。[http://code.google.com/p/v8/](http://code.google.com/p/v8/)

谷歌浏览器也有一个有趣的架构和高质量的代码库。[http://code.google.com/chromium/](http://code.google.com/chromium/)

两者都是开源的，在类似 BSD 的许可下。

# windows-server-2003 - 尽管已连接 VPN，但无法找到 Windows 共享

> ID：234284
> 
> 赞同：-1
> 
> 时间：2008-10-24T16:34:33.807
> 
> 标签：windows-server-2003, vpn, sharing

我是程序员，该死的，我应该被允许问这些 IT 问题！:)

无论如何，问题如下。我正在编写一个自动构建脚本来将代码部署到实时 Windows 2003 服务器。为了访问服务器，我启用了 VPN 角色，我可以使用我在网络连接屏幕上在服务器上设置的用户名和密码从我的开发机器远程连接到它。

我在那台机器上设置了一个共享，并为我用来连接的帐户提供了完整的共享+安全权限。一旦连接，我会认为我将能够看到共享。事实上，即使连接了 VPN，我什至看不到计算机（如果我在运行框中键入“\IPADDRESS\”，则什么也没有出现）。

我在这里错过了一个重要的步骤吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-24T16:40:38.037

所以你可以使用远程桌面连接来连接服务器，但是 CIFS/SMB（共享）不起作用？

是否有需要更改的 Windows 防火墙设置（...我什至不知道是否有包含 Windows 防火墙的 2003 更新）？

ping IP 地址会导致哪个错误消息（或者，如果您可以 RDC，希望没有）？

远程服务器和您的本地开发盒是否在同一个 IP 子网上？如果路由不正确，您可能正在尝试访问本地地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:24:22.573

在我看来，您无法从建立 VPN 连接的同一会话中连接到网络共享。我现在手动打开 VPN 连接，然后启动构建脚本

# asp.net - 带有 DataPager 的 ListView 不起作用

> ID：234289
> 
> 赞同：20
> 
> 时间：2008-10-24T16:35:46.567
> 
> 标签：asp.net, vb.net, listview, paging

从我读过的所有内容来看，似乎将分页添加到 ListView 控件应该非常简单，但它对我不起作用。在将 ListView 和 DataPager 控件添加到表单并将它们连接在一起之后，我的行为变得非常奇怪。DataPager 正确地限制了 ListView 的页面大小，但单击分页按钮根本不会影响 ListView。分页按钮似乎认为他们正在做他们的工作，因为当您转到最后一页等时，最后一个按钮被禁用，但 ListView 永远不会改变。此外，它需要在 DataPager 上单击两次才能使其执行任何操作，即单击 Last 一次不会执行任何操作，但再次单击它会使 DataPager 做出反应，就好像现在选择了最后一页一样。

我能想到的唯一一件事是我在运行时将 DataSource 绑定（到 LINQ 对象），而不是使用 LinqDataSource 控件或任何东西。有没有人见过这种行为？难道我做错了什么？这是我正在使用的代码：

```
<asp:DataPager ID="HistoryDataPager" runat="server" PagedControlID="HistoryListView" PageSize="10">
    <Fields>
        <asp:NextPreviousPagerField ButtonType="Button" ShowFirstPageButton="true" ShowLastPageButton="true" />
    </Fields>
</asp:DataPager>

<asp:ListView ID="HistoryListView" runat="server">
    ...
</asp:ListView> 
```

在代码隐藏中：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    If Not IsPostBack Then
        HistoryListView.DataSource = From x in myContext.myTables ...
        DataBind()
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-29T23:43:34.763

我们需要在 OnPreRender 事件中再次绑定列表视图。

```
protected override void OnPreRender(EventArgs e)
        {
            ListView1.DataBind();
            base.OnPreRender(e);
        } 
```

- 更新

在使用 asp.net ajax 处理了一些列表视图之后，我看到了一个比上述更有意义的解决方案。您通常会在页面加载方法或按钮单击事件处理程序上对 Listview 进行数据绑定，当有回发时，数据绑定将丢失，如上述问题中所述。因此，我们需要再次对列表视图的页面属性更改事件处理程序进行数据绑定。

```
ListView_PagePropertiesChanged(object sender, EventArgs e)
{
ListView.DataSource=someDatasource;
ListView.DataBind()
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T05:35:22.403

**另一种解决方案**，很简单，只需从数据库中获取“QUERY-STRING”中的“ID”，现在将其设置为 Pager Control 属性为 [QueryStringField="ID"]，如：

```
<asp:DataPager ID="DataPagerProducts" runat="server" QueryStringField="ID" PageSize="3">
                            <Fields>
                                <asp:NextPreviousPagerField ShowFirstPageButton="True" ShowNextPageButton="False" />
                                <asp:NumericPagerField />
                                <asp:NextPreviousPagerField ShowLastPageButton="True" ShowPreviousPageButton="False" />
                            </Fields>
                        </asp:DataPager> 
```

**注意：**如果不唤醒，则也设置`[ PagedControlID="ListView_Name" ]`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-25T21:26:00.730

看看 ListViewPagedDataSource。

```
private ListViewPagedDataSource GetProductsAsPagedDataSource(DataView dv)
{
// Limit the results through a PagedDataSource
ListViewPagedDataSource pagedData = new ListViewPagedDataSource();
pagedData.DataSource = dv;
pagedData.MaximumRows = dv.Table.Rows.Count;
pagedData.TotalRowCount = dpTop.PageSize;

if (Request.QueryString[dpTop.QueryStringField] != null)
  pagedData.StartRowIndex = (Convert.ToInt32(Request.QueryString[dpTop.QueryStringField]) - 1) * dpTop.PageSize;
else
  pagedData.StartRowIndex = 0;

return pagedData;
} 
```

不过，我在查看最后一页时遇到问题。DataPager 跳回第一页，但显示的数据是最后一页。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-11T13:01:02.440

此外，如果您的 ListView 的数据源发生更改（例如，如果根据搜索参数显示数据），请不要忘记在每次更新数据源时重置寻呼机。对于 ListView，这不像其他一些数据绑定控件（例如 GridView）那样简单：

```
private void ResetListViewPager()
{
    DataPager pager = (DataPager)ListViewMembers.FindControl("DataPager1");
    if (pager != null)
    {
        CommandEventArgs commandEventArgs = new CommandEventArgs(DataControlCommands.FirstPageCommandArgument, "");
        // MAKE SURE THE INDEX IN THE NEXT LINE CORRESPONDS TO THE CORRECT FIELD IN YOUR PAGER
        NextPreviousPagerField nextPreviousPagerField = pager.Fields[0] as NextPreviousPagerField;
        if (nextPreviousPagerField != null)
        {
            nextPreviousPagerField.HandleEvent(commandEventArgs);
        }

        // THIS COMMENTED-OUT SECTION IS HOW IT WOULD BE DONE IF USING A NUMERIC PAGER RATHER THAN A NEXT/PREVIOUS PAGER
        //commandEventArgs = new CommandEventArgs("0", "");
        //NumericPagerField numericPagerField = pager.Fields[0] as NumericPagerField;
        //if (numericPagerField != null)
        //{
        //    numericPagerField.HandleEvent(commandEventArgs);
        //}
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-09T16:49:43.943

在 datapager 的预渲染事件而不是在页面加载时绑定列表视图。请在[此处查看解决方案](https://stackoverflow.com/questions/1130439/asp-net-datapager-control-always-a-step-behind-with-paging)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-15T19:35:47.813

```
<asp:ListView ID="ListView1" runat="server" DataSourceID="sdsImages">
    <ItemTemplate>
        <div class="photo sample12">
                <asp:Image ID="img_Galerie" runat="server" ImageUrl='<%# "~/imageHandler.ashx?ID=" + Eval("ImageID") %>' />
        </div>
    </ItemTemplate>
</asp:ListView>
<asp:DataPager ID="DataPager1" runat="server" PagedControlID="ListView1" PageSize="3" QueryStringField="ImageID">
    <Fields>
        <asp:NextPreviousPagerField ShowFirstPageButton="True" ShowNextPageButton="False" />
        <asp:NumericPagerField />
        <asp:NextPreviousPagerField ShowLastPageButton="True" ShowPreviousPageButton="False" />
    </Fields>
</asp:DataPager>
<asp:SqlDataSource ID="sdsImages" runat="server"
    ConnectionString="<%$ ConnectionStrings:DBCS %>"
    SelectCommand="SELECT ImageID FROM  Images "> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-06T21:18:47.580

试试这个：

```
protected void ListView1_PagePropertiesChanging(object sender, PagePropertiesChangingEventArgs e)
{
    DataPager1.SetPageProperties(e.StartRowIndex, e.MaximumRows, false);
    ListView1.DataSource = productList;
    ListView1.DataBind();
    DataPager1.DataBind();
} 
```

# winforms - 为什么我的 Winforms 应用程序中没有调用 form_load 事件？

> ID：234291
> 
> 赞同：1
> 
> 时间：2008-10-24T16:36:09.593
> 
> 标签：winforms

我不知道为什么，但是我的表单在加载时没有调用 Form_Load 事件。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T16:49:34.697

您是否设置了事件处理程序？

最终，会有一行代码看起来像这样：

```
this.Load += new System.EventHandler(this.Form1_Load); 
```

这可能是您自己编写的代码，或者是通过在 Visual Studio 中双击表单的 Load 事件生成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-14T03:04:49.643

Initialize_Component() 中可能抛出异常；这可以防止调用加载方法？

[http://blog.paulbetts.org/index.php/2010/07/20/the-case-of-the-disappearing-onload-exception-user-mode-callback-exceptions-in-x64/](http://blog.paulbetts.org/index.php/2010/07/20/the-case-of-the-disappearing-onload-exception-user-mode-callback-exceptions-in-x64/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T09:52:00.597

去 btnSave 找到“点击”设置“btnSave_Click”然后工作

# c# - Telnet 服务器如何与客户端通信？

> ID：234300
> 
> 赞同：4
> 
> 时间：2008-10-24T16:37:41.647
> 
> 标签：c#, terminal, client-server, telnet, vt100

我想编写一个 C# 应用程序，它连接到 telnet 服务器并与服务器通信。我想知道 telnet 服务器如何向客户端发送信息。我已经查看（略读）了[Telnet RFC](http://www.faqs.org/rfcs/rfc854.html)并查看了从服务器传入的数据包，但仍然有点困惑。谁能给我一个例子，服务器如何在 telnet 客户端中移动光标以及它如何改变字符的颜色？（一个例子将不胜感激）

**更新一**

以下是一些额外的 VT100 资源：

1.  [ANSI/VT100 终端控制](http://graphcomp.com/info/specs/ansi_col.html)
2.  [vt100_codes_news.txt](http://www.cs.utk.edu/~shuford/terminal/vt100_codes_news.txt)

**更新二**

经过大量研究和时间，我在这里发现了：[Telnet Programming with C#](http://srand2.blogspot.com/2009/02/telnet-programming-with-c.html)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T16:53:07.420

移动光标和更改颜色不是由 telnet 协议完成的。

您的 telnet 客户端正在模拟[终端](http://en.wikipedia.org/wiki/Computer_terminal)，很可能是 VT-100 变体。为了移动光标和改变颜色，服务器发送特定于被模拟终端类型的转义序列（在 telnet 协议协商中发送）。

如果你不想要这些转义序列，在 telnet 协议协商中告诉服务器你是一个“哑”终端就足够了。如果你想要它们（或者如果服务器假设每个人都有一个 VT-100 并且总是发送它们）你将不得不实现一个 VT-100 终端仿真器（或者至少有足够的它来丢弃你不想要的东西）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T16:44:10.417

一个[简单的 Google 搜索](http://www.google.com/search?q=c%23+telnet+client&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)显示了许多用 C# 编写的开源 Telnet（和其他网络协议）客户端。您可以将源代码下载到其中一个，然后查看它们如何实现连接协商和命令。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T16:44:48.310

关于处理光标和文本颜色等，现在您正在谈论终端仿真。为此，您将需要一个库。 [这看起来是一个不错的起点。](http://www.jscape.com/articles/telnet_using_csharp.html)

# sharepoint - 如何将 Web 部件页添加到网站定义？

> ID：234302
> 
> 赞同：3
> 
> 时间：2008-10-24T16:39:21.443
> 
> 标签：sharepoint, web-parts

我必须为必须包含预定义 Web 部件页面的客户端创建站点定义。我可以创建 Web 部件页面，但在创建时将它们附加到网站时不知所措。

我知道通过 SharePoint 创建的 Web 部件页面存储在文档库中。我是否需要预先填充“Web 部件页面”文档库并向这些文件添加所需的导航？如果是这样，我该如何添加所需的 aspx 文件？

最后，在 onet 中配置自定义 Web 部件页面时，我应该注意哪些注意事项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-25T11:05:14.580

您可以在 ONET.XML 中设置页面。

首先将 Web 部件页面模板添加到您的站点定义。

然后在您的 ONET.XML 中提供页面实例（添加了 web 部分）。

*[Ted Pattison 的《Windows SharePoint Services 3.0 内幕](https://rads.stackoverflow.com/amzn/click/com/0735623201)*》一书中全面描述了这些内容

**默认.aspx**

```
<%@ Assembly Name="Microsoft.SharePoint,Version=12.0.0.0,Culture=neutral,PublicKeyToken=71e9bce111e9429c" %> <%@ Register Tagprefix="SharePoint" Namespace="Microsoft.SharePoint.WebControls" Assembly="Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %> <%@ Register Tagprefix="Utilities" Namespace="Microsoft.SharePoint.Utilities" Assembly="Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %> <%@ Import Namespace="Microsoft.SharePoint" %> <%@ Register Tagprefix="WebPartPages" Namespace="Microsoft.SharePoint.WebPartPages" Assembly="Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>

<%@ Page language="C#" MasterPageFile="~masterurl/default.master"    
          Inherits="Microsoft.SharePoint.WebPartPages.WebPartPage" %>

<asp:Content ContentPlaceHolderId="PlaceHolderMain" runat="server">
    <table cellspacing="0" border="0" width="100%">
      <tr>
       <td class="ms-pagebreadcrumb">
            <asp:SiteMapPath SiteMapProvider="SPContentMapProvider" id="ContentMap" SkipLinkText="" NodeStyle-CssClass="ms-sitemapdirectional" runat="server"/>
       </td>
      </tr>
      <tr>
        <td>
         <table width="100%" cellpadding=0 cellspacing=0 style="padding: 5px 10px 10px 10px;">
          <tr>
           <td valign="top" width="70%">
               <WebPartPages:WebPartZone runat="server" FrameType="TitleBarOnly" ID="Left" Title="loc:Left" />
               &nbsp;
           </td>
           <td>&nbsp;</td>
           <td valign="top" width="30%">
               <WebPartPages:WebPartZone runat="server" FrameType="TitleBarOnly" ID="Right" Title="loc:Right" />
               &nbsp;
           </td>
           <td>&nbsp;</td>
          </tr>
         </table>
        </td>
      </tr>
    </table>
</asp:Content>

<asp:Content ID="Content1" ContentPlaceHolderId="PlaceHolderPageTitle" runat="server">
    <SharePoint:ProjectProperty ID="ProjectProperty1" Property="Title" runat="server"/>
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderId="PlaceHolderPageTitleInTitleArea" runat="server">
         <label class="ms-hidden"><SharePoint:ProjectProperty ID="ProjectProperty2" Property="Title" runat="server"/></label>
</asp:Content> 
```

**ONET.xml 片段**

```
<Module Name="Default" Url="" >
  <File Url="default.aspx" Type="Ghostable">
    <!-- Add a Web Part to left zone -->
    <AllUsersWebPart WebPartZoneID="Left" WebPartOrder="0">
      <![CDATA[         
       <WebPart 
         xmlns="http://schemas.microsoft.com/WebPart/v2"
         xmlns:cewp="http://schemas.microsoft.com/WebPart/v2/ContentEditor">
         <Assembly>Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c</Assembly>
         <TypeName>Microsoft.SharePoint.WebPartPages.ContentEditorWebPart</TypeName>
         <Title>Working with Site Definitions</Title>
         <FrameType>TitleBarOnly</FrameType>
         <cewp:Content>
           This Web Part was added through declarative logic in ONET.XML
         </cewp:Content>
       </WebPart>
       ]]>
    </AllUsersWebPart>
  </File>
</Module> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T20:52:55.830

您可以遵循这种使用特征装订的方法。我使用它在创建 Web 部件时自动将它们添加到我的网站：

[http://blogs.msdn.com/sharepoint/archive/2007/03/22/customizing-moss-2007-my-sites-within-the-enterprise.aspx](http://blogs.msdn.com/sharepoint/archive/2007/03/22/customizing-moss-2007-my-sites-within-the-enterprise.aspx)

# language-agnostic - 您为自定义 IDE 做了哪些工作？

> ID：234312
> 
> 赞同：3
> 
> 时间：2008-10-24T16:41:16.493
> 
> 标签：language-agnostic, ide, development-environment, customization

你做了哪些调整/插件/主题来让你的 IDE 变得很棒？例如，在 Visual Studio 中，我为[主题着色](http://www.hanselman.com/blog/VisualStudioProgrammerThemesGallery.aspx)，[CodeRush](http://www.devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/)在大括号之间绘制线条，我总是安装和使用[Consolas](http://www.microsoft.com/downloads/details.aspx?familyid=22e69ae4-7e40-4807-8a86-b3d36fab68d3&displaylang=en)字体，并且我设置它以在我更改热键时[在计算机之间同步我的设置，并在](http://blogs.msdn.com/saraford/archive/2008/06/30/did-you-know-you-can-use-team-settings-to-keep-visual-studio-settings-on-different-machines-in-sync-248.aspx)[FolderShare](https://www.foldershare.com/welcome.aspx)的帮助下进行其他操作。

此外，这不是 Visual Studio 特定的，请随意提及您使用 Emacs 或 Eclipse 或其他我们所做的事情，因为我们中的许多人都使用一些。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T16:42:44.227

适用于 Visual Studio 2008 的[ReSharper 4.1。这是一件很美好的事情。](http://www.jetbrains.com/resharper/)它查找各种代码错误、优化等。感谢这个方便的 Visual Studio 插件，我的代码更干净。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T16:50:46.787

[优化](https://stackoverflow.com/questions/8440/visual-studio-optimizations)IDE 将是第一步。Resharper 有很大帮助，但有时一些简单的[宏](http://blogs.msdn.com/kirillosenkov/archive/2008/04/03/coding-productivity-macros-shortcuts-and-snippets.aspx)就绰绰有余了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-24T16:53:14.393

第一件事。更改默认的蹩脚字体。然后开始摆弄“选项”对话框。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-24T16:53:58.400

在朋友的推荐下，我为 Visual Studio 2008 安装了[Visual Assist——](http://www.wholetomato.com/ "视觉辅助")它*很棒*。我发誓它可以读懂我的想法。

[注意：我与他们没有任何关系——只是一个非常高兴的客户]

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-24T16:57:31.140

我做了很多，但我真的不应该这样做。所以在过去的几年里，我已经减少了宏、自定义键映射、自定义工具栏等的数量。在大多数情况下，我认为开发人员应该习惯他们的默认行为和外观IDE。然后，当您需要在同事的机器上工作时，您仍然知道如何绕过并设法帮助他们。更不用说当更新发布时，大量的自定义设置会被破坏或重新排列或以其他方式重置。

也就是说，每次设置 IDE 时，我仍然会做一些事情......例如，将 Visual Studio 中的并发构建数设置为 1，因为该功能已被破坏，以至于什么都不会使用任何更大的设置正确编译。除此之外，成为具有默认行为的王牌最终会让您更有效率，而不是花费数小时调整软件以使其更加流畅。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-24T17:34:32.047

我喜欢 Axtools [http://www.axtools.com/](http://www.axtools.com/)中的 CodeSmart VB6 和 CodeSmart VS.NET， 用于高级语法高亮、在 If..then..else..endif 的各个部分之间画线、Do While ... 循环和所有其他构造。它还具有出色的代码审核员和许多附加功能。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-22T07:05:24.330

vi插件！！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-24T16:43:15.880

我不太喜欢花哨的视觉插件，所以我把我的 IDE（Visiual Studio）留在了标准外观（**MS Reference Sans Serif**字体除外）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-24T16:44:20.340

我使用 Emacs。我的 .emacs 文件只有几百行长，但会根据我的机器的主机名和操作系统自定义设置，这样我几乎可以在任何地方使用相同的配置文件。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-24T16:48:59.317

着色 - 自定义 - GreyishBlack 上的白色文本，Consolas 字体

热键 - CTRL+SHIFT+ALT+Z（附加到进程）可能还有其他一些...

插件[-DPack](http://www.usysware.com/dpack/)、[Coderush](http://www.devexpress.com/)、[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)。

工具栏关闭所有窗口设置为折叠

我不会用这台机器做演示 - 如果我是的话，那将是准系统。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-24T16:52:17.203

当然，eclipse 插件使我的 ide 完全符合我的要求。

[eclipse插件中心](http://www.eclipseplugincentral.com/)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-24T16:55:31.423

我有点喜欢 VS 的默认设置，我只确保 Consolas 作为编辑器字体，tabsize 2（制表符到空格），并更改数字的颜色（红色）。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-24T16:58:28.953

对于使用 Eclipse 进行 Java 开发，我有一些必不可少的插件。[MyEclipse Workbench](http://www.myeclipseide.com/ "MyEclipse 工作台")为大多数内置模块添加了许多功能。它使将应用程序部署到多个应用程序服务器变得非常容易，并增强了许多内置编辑器。[PMD](http://pmd.sourceforge.net/)插件非常适合搜索潜在的代码问题。正如今天之前的一篇文章中提到的，[Ganymede](http://sourceforge.net/projects/ganymede/)插件确实有助于突出显示日志条目。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-27T23:54:20.053

在 Visual Studio 2005 中，我执行以下操作：

*   将 F11 绑定到全屏模式
*   启用 80 个字符的垂直线：（`HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\8.0\Text Editor\Guides = "RGB(196,196,196) 80"`指南不会出现在注册表中。）
*   在“帮助”菜单后添加“开始调试”、“全部中断”和“停止调试”按钮。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-24T16:50:22.370

我通常将配色方案更改为黑色背景而不是白色。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-24T16:54:36.183

我使用[Zenburn](http://www.codinghorror.com/blog/archives/000682.html)配色方案和[Proggy Clean](http://www.proggyfonts.com/index.php?menu=download)作为字体。这对我的眼睛来说就像一把舒适的椅子。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-24T16:56:25.977

没有什么。我讨厌处理由于更新等不可避免地导致的所有损坏。所以，我改为让自己适应我的 IDE。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-24T16:56:44.497

我将[ViEmu](http://www.viemu.com/)和[ReSharper](http://www.jetbrains.com/resharper/)与[深色主题](http://www.winterdom.com/weblog/2007/10/13/RagnarokAVS2005ColorScheme.aspx)结合使用。

哦，我还隐藏了大部分工具栏并关闭了动画以加快速度。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-24T16:57:49.703

银色背景，8pt Consolas，禁用所有工具栏并将制表符间距设置为 3 个空格。:)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-26T17:02:23.320

我在 Eclipse 中进行 Java 开发。以下是一些我觉得有用的插件：

1.  Mylyn - 隐藏与当前上下文无关的项目元素。
2.  eUML2 - UML 编辑器。
3.  FindBugs - 用于查找 Java 中常见错误的静态分析工具。
4.  Crap4J - 另一个静态分析工具。
5.  EclEmma - 用于单元测试的代码覆盖插件。

编辑：我忘记了一个：

1.  禁用拼写检查器。:)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-26T16:19:08.010

我没有自定义 IDE，而是自定义了我的错误消息。我有一个宏，它扩展为一个`#pragma warning`生成与 MSVC++ 格式相同的编译时消息的语句。Visual Studio 可以解析生成的警告，因此双击消息会在 IDE 中打开有问题的文件，并将我带到有问题的行。

我用过宏：

*   为一段代码“添加书签”，这样开发人员每次构建时都会被唠叨修复它。
*   在`#if`块内测试各种编译时条件。
*   在标题中，查看他们是谁`#include`，在哪里。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-10-26T16:40:09.230

`vim`您可以将`makeprg`( make *program* ) 变量设置为将构建项目的命令，并将`errorformat`变量设置为`scanf`描述构建错误格式的 -style 字符串。从那里：

*   `:make`将构建您的项目
*   `:cl`列出所有匹配的错误`errorformat`
*   `:cc`告诉你当前的错误
*   `:cn`带你到下一个错误
*   `:cp`带你到上一个错误。

开箱即用，`vim`设置`makeprg`和`errorformat`使用`make`and `gcc`，所有命令都记录在`vim`的内置帮助中。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-24T17:15:41.307

对于 Visual Studio

*   最重要的 - [Resharper](http://www.jetbrains.com/resharper/) - 我买了自己的副本，所以我不必纠缠我的雇主。
*   更改颜色/字体 - 选择适合您的
*   优化（投票支持 Gulzar 的帖子并附上链接）
*   不要试图让 IDE 做所有事情，只是因为你可以。（有点讽刺的是，我也使用 emacs）。我个人非常不喜欢集成源代码管理。
*   更改一些默认文件关联，因此双击某些文件类型不会启动 Visual Studio

除了 Resharper，我实际上发现大多数其他有益的事情不是自定义 IDE，而是自定义**自己**以学习键盘快捷键。从 Ctrl -、Ctrl Shift -、Ctrl Shift V、Ctrl Alt L 等大收获开始，然后按照使用频率的顺序逐步学习其余快捷键

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-01-22T08:27:12.060

创建一些基本的宏，例如打印错误修复代码注释：

```
 Public Sub WriteBugFix()
    Dim TS As TextSelection = DTE.ActiveDocument.Selection
    TS.Text = "'Edited for Bug Fixed By JK - " & Date.Now.ToShortDateString
End Sub 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-01-22T07:42:19.030

我正在使用 Vim [Cscope](http://cscope.sourceforge.net/)插件。

Cscope 就像打了兴奋剂的“ctags”，让遍历代码变得更加容易。我通常将它与标签一起使用来查找函数的声明位置，然后直接转到调用该函数的任何代码。

我还使用 Vim 的 Rgrep 插件（递归搜索）来搜索代码层次结构中的文件。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-12-22T15:00:47.710

（此答案假设工作站是 GNU/Linux 计算机。）

Emacs 是一个出色的 IDE，特别是因为它可以进行大量定制。

您可以通过编辑主目录中的 .emacs 文件来自定义 Emacs。我的 .emacs 是一个符号链接：

$ ln -s /home/bzimmerly/bin/emacs/emacs24/wbz.emacs.el .emacs

由于 Emacs 为程序开发和调试提供了多种专门的主要模式，因此您可以轻松地“推出自己的”最适合您的 IDE 设计。例如，当我使用 C 或汇编程序进行编程时，我喜欢让左侧运行 GDB 模式，而右侧显示正在跟踪的源代码。

一点点 LISP 技能对于将 Emacs 变成一个非常强大的 IDE 大有帮助。花时间学习如何使用这个强大的工具是非常值得的！

最后，像 Youtube 这样的工具是学习如何做到这一点的宝贵场所。只需在 Youtube 搜索表单中输入“Emacs 作为 IDE”，就会显示人们如何修改 Emacs 以实现这一目的的视频。有关于编辑 Python 代码、Javascript、Java、C 等的视频。

# python - 精心设计的 Python 应用程序的开源示例

> ID：234328
> 
> 赞同：6
> 
> 时间：2008-10-24T16:45:40.603
> 
> 标签：python, design-patterns, architecture, open-source

您是否知道设计精良且易于分析的开源应用程序？

当然，这个问题与[其他帖子](https://stackoverflow.com/questions/234276/open-source-examples-of-well-designed-applications)密切相关，但我对用 Python 编写的应用程序特别感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T19:39:07.880

[Django](http://www.djangoproject.com/)是一个 Python 包，它的编码和设计都非常好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T16:55:50.783

查看 Python 标准库。这是一个非常丰富的python代码。我特别喜欢this.py :)

说真的，虽然标准库中有很好的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T16:56:42.937

[佐佩](http://www.zope.org/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-24T17:56:27.560

金字塔很棒！

**[Pyramid - 网络框架](http://www.pylonsproject.org/)**

# .net - Type.GetMethods 的 BindingFlags 不包括属性访问器

> ID：234330
> 
> 赞同：17
> 
> 时间：2008-10-24T16:46:34.237
> 
> 标签：.net, reflection

假设我有以下程序：

```
namespace ReflectionTest
{
    public class Example
    {
        private string field;

        public void MethodOne() { }

        public void MethodTwo() { }

        public string Property
        {
            get { return field; }
            set { this.field = value; }
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            iterate(typeof(Example));

            Console.ReadLine();
        }

        public static void iterate(Type type)
        {
            MethodInfo[] methods = type.GetMethods(
                BindingFlags.DeclaredOnly |
                BindingFlags.Instance |
                BindingFlags.Public);

            foreach (MethodInfo mi in methods)
            {
                Console.WriteLine(mi.Name);
            }
        }
    }
} 
```

当我运行程序时，我得到以下输出：

```
方法一
方法二
get_Property
set_Property
```

我想跳过属性访问器方法。[`BindingFlags`](http://msdn.microsoft.com/en-us/library/system.reflection.bindingflags.aspx)例如，我尝试过不同的`~BindingFlags.SetProperty`，但没有运气。目前我发现跳过这些方法的唯一方法是将迭代函数重写为：

```
public static void iterate(Type type)
{
    MethodInfo[] methods = type.GetMethods(
        BindingFlags.DeclaredOnly |
        BindingFlags.Instance |
        BindingFlags.Public);

    foreach (MethodInfo mi in methods)
    {
        if (mi.IsSpecialName) continue;
        Console.WriteLine(mi.Name);
    }
} 
```

你知道我`BindingFlags`应该用什么吗？

### 更新：

好吧，我应该解释一下，该项目实际上是为自动构建单元测试模板，所以我可以跳过所有特殊方法。感谢您提供有关 IsSpecialName 的其他信息 :)

林克？真的吗？哇。无论如何，这个项目是 .NET 2.0，所以 LINQ（很遗憾）不是一个选项。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-24T16:57:50.360

从我的头顶：

```
mi.IsSpecialName &&( mi.Name.StartsWith("set_") || mi.Name.StartsWith("get_")) 
```

应该让你一切就绪。SpecialName 不仅仅是属性访问器（事件添加/删除方法也算在内），这就是您必须检查名称的原因。

您也可以为此使用 LINQ :)

# opengl - 在opengl中对纹理进行颜色映射

> ID：234333
> 
> 赞同：2
> 
> 时间：2008-10-24T16:47:00.240
> 
> 标签：opengl, colors, mapping, textures

我正在显示一个我想在不影响图像数据的情况下操作的纹理。我希望能够钳制纹素值，以便低于下限值的任何值变为 0，高于上限值的任何值变为 0，并且介于两者之间的任何值都从 0 线性映射到 1。

最初，为了显示我的图像，我使用了 glDrawPixels。为了解决上述问题，我将使用 glPixelMap 创建一个颜色图。这很好用。但是，出于性能原因，我已经开始使用纹理来显示我的图像。glPixelMap 方法似乎不再有效。好吧，这种方法可能有效，但我无法让它发挥作用。

然后我尝试使用 glPixelTransfer 设置比例和偏差'。这似乎在第一次通过时产生了某种效果（不一定是所需的），但是当改变上限和下限约束时，看不到任何效果。

然后我被告知片段着色器可以工作。但是在调用 glGetString(GL_EXTENSIONS) 之后，我发现不支持 GL_ARB_fragment_shader。另外，调用 glCreateShaderObjectARB 会导致 nullreferenceexception。

所以现在我很茫然。我该怎么办？请帮忙。

* * *

我愿意尝试任何可能有效的方法。供应商是英特尔，渲染器是英特尔 945G。不幸的是，我仅限于集成在主板上的显卡，并且只有 gl 1.4。

感谢您迄今为止的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T22:49:56.343

除非你有一个相当旧的显卡，否则你没有片段着色器支持是令人惊讶的。我建议您尝试使用[this](http://www.realtech-vr.com/glview/)进行仔细检查。

另外，您确定要高于最大值的任何值都为 0 吗？也许你的意思是1？如果您的意思是 1 而不是 0，那么执行您所要求的事情的方法非常冗长。

简洁的答案是您使用多个渲染通道。首先，您以正常强度渲染图像。然后你使用减法混合（查找 glBlendEquation）来减去你的最小值。然后使用加法混合将所有内容乘以 1/(max-min)（可能需要多次通过）。

如果你真的想这样做，请发回你的显卡的`GL_VENDOR`和。`GL_RENDERER`

**编辑：**嗯。英特尔 945G 没有`ARB_fragment_shader`，但它确实有`ARB_fragment_program`，这也可以解决问题。

您的片段代码应该看起来像这样（但自从我写任何东西以来已经有一段时间了，所以它可能被窃听了）

```
!!ARBfp1.0
ATTRIB tex = fragment.texcoord[0]
PARAM cbias = program.local[0]
PARAM cscale = program.local[1]
OUTPUT cout = result.color

TEMP tmp
TXP tmp, tex, texture[0], 2D
SUB tmp, tmp, cbias
MUL cout, tmp, cscale

END 
```

您可以像这样将其加载到 OpenGL 中：

```
GLuint prog;
glEnable(GL_FRAGMENT_PROGRAM_ARB);
glGenProgramsARB(1, &prog);
glBindProgramARB(GL_FRAGMENT_PROGRAM_ARB, prog);
glProgramStringARB(GL_FRAGMENT_PROGRAM_ARB, GL_PROGRAM_FORMAT_ASCII_ARB, strlen(src), src);
glDisable(GL_FRAGMENT_PROGRAM_ARB); 
```

然后，在渲染几何体之前，请执行以下操作：

```
glEnable(GL_FRAGMENT_PROGRAM_ARB);
glBindProgramARB(GL_FRAGMENT_PROGRAM_ARB, prog);
colour4f cbias = cmin;
colour4f cscale = 1.0f / (cmax-cmin);
glProgramLocalParameter4fARB(GL_FRAGMENT_PROGRAM_ARB, 0, cbias.r, cbias.g, cbias.b, cbias.a);
glProgramLocalParameter4fARB(GL_FRAGMENT_PROGRAM_ARB, 1, cscale.r, cscale.g, cscale.b, cscale.a);

//Draw your textured geometry

glDisable(GL_FRAGMENT_PROGRAM_ARB); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T23:44:19.370

另请查看是否`GL_ARB_fragment_program`支持扩展。该扩展支持 ASM 风格的片段程序。这应该在 OpenGL 1.4 中得到支持。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-25T23:03:10.673

很遗憾你使用的是这么古老的 OpenGL 版本。你可以用你的卡升级吗？

对于更现代的 OGL 2.x，这正是 GLSL 所适用的程序类型。很棒的文档可以在这里找到：

[OpenGL 文档](http://opengl.org/documentation/)

[OpenGL 着色语言](http://opengl.org/documentation/glsl/)

# javascript - AJAX、Rails 和表单的动态加载

> ID：234336
> 
> 赞同：2
> 
> 时间：2008-10-24T16:48:50.410
> 
> 标签：javascript, ruby-on-rails, ajax, views, partials

我有一个 Rails 应用程序，它获得了一些牵引力，但我有一个严重的头痛要处理。这是一种基本的资产管理器应用程序——用户上传他们的照片、.pdf、视频等，系统允许他们管理资产的呈现方式。

我从一个相当标准的 rails 视图开始 - 正是 rails 生成的内容 - 用于 index.html.erb。我有一个为每个资产呈现缩略图的部分内容，如下所示：

```
<div id="preview">  </div> 
```

我想要的是缩略图是可点击的（很容易）但是当用户点击那个按钮时，div的内容将被填充，嗯，基本上是edit.html.erb，但我猜它需要作为部分完成。我已经用直接的javascript管理了这个。

我确实可以访问新的“Agile Development on Rails”一书的预出版版本，任何人都可以通过出版商获得，但是关于 AJAX 的章节非常少，并且假设在这些方面的经验比我拥有的更多，这是我第一次涉足 javascript 和 rails。

更新：针对“问题是什么”的“答案”，尽管我认为这很清楚：

我需要在缩略图的部分中添加什么内容才能单击它以将编辑表单加载到 div 中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T17:39:44.410

您需要使用 link_to_remote：

```
<%=    link_to_remote image_tag('whatever.jpg'), 
       {:controller => 'something', :action => 'replace_thumbnail', :id => @thumbnail.id}, 
       :update => 'preview' %> 
```

在控制器中你应该有这个动作：

```
def replace_thumbnail
  image = Image.find(params[:id])
  render :partial => 'edit', :object => image, :layout => false
end 
```

确保您的部分名为“_edit.html.erb”

# java - 我应该始终使我的 java 代码线程安全，还是出于性能原因仅在需要时才这样做？

> ID：234341
> 
> 赞同：27
> 
> 时间：2008-10-24T16:49:34.290
> 
> 标签：java, multithreading, performance, concurrency, thread-safety

如果我创建目前仅在单个线程中使用的类，我是否应该使它们成为线程安全的，即使我目前不需要它？可能会发生，我后来在多个线程中使用这个类，那时我可能会遇到竞争条件，如果我没有首先使类线程安全，可能很难找到它们。或者我应该让这个类不是线程安全的，以获得更好的性能？但是过早的优化是邪恶的。

不同的问题：如果需要，我应该使我的类线程安全（如果在多个线程中使用，否则不是）还是应该优化这个问题然后需要（如果我看到同步占用了处理时间的重要部分）？

如果我选择两种方式中的一种，是否有减少缺点的方法？还是存在我应该使用的第三种可能性？

**编辑**：我给出了我想到这个问题的原因。在我们公司，我们编写了一个非常简单的用户管理，将数据写入属性文件。我在一个网络应用程序中使用它，经过一些工作后我得到了奇怪的错误，用户管理忘记了用户的属性（包括名称和密码）和角色。这很烦人，但不能始终如一地重现，所以我认为这是竞争条件。由于我同步了从磁盘读取和写入的所有方法，因此问题消失了。所以我想，如果我们一开始就编写了带同步的类，我可能可以避免所有的麻烦？

**编辑 2**：当我查看实用程序员的技巧时，我看到了技巧 #41：始终为并发设计。这并不是说所有代码都应该是线程安全的，而是说设计应该考虑到并发性。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-24T16:53:13.287

我曾经尝试让一切都成为线程安全的——然后我意识到“线程安全”的真正含义取决于使用情况。您通常无法预测这种用法，调用者无论如何*都*必须采取行动才能以线程安全的方式使用它。

这些天来，我写的几乎所有东西都假设单线程，并将线程知识放在少数几个重要的地方。

话虽如此，我也（在适当的情况下）创建不可变类型，这些类型自然适用于多线程 - 并且通常更容易推理。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-25T04:27:35.070

从数据开始。决定明确共享哪些数据并加以保护。如果可能的话，用数据封装锁定。使用预先存在的线程安全并发集合。

尽可能使用不可变对象。使属性最终，在构造函数中设置它们的值。如果您需要“更改”数据，请考虑返回一个新实例。不可变对象不需要锁定。

对于非共享或线程限制的对象，不要花时间使它们成为线程安全的。

记录代码中的期望。JCIP 注释是可用的最佳预定义选择。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-24T17:00:26.377

遵循“尽可能简单，但不简单”的原则。如果没有要求，您不应该使它们成为线程安全的。这样做是投机性的，而且可能是不必要的。线程安全编程为您的类增加了更多的复杂性，并且可能由于同步任务而降低它们的性能。

除非明确声明一个对象是线程安全的，否则期望它不是。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-24T17:19:22.577

我个人只会在需要时设计“线程安全”的类——本着仅在需要时优化的原则。Sun 似乎在单线程集合类的示例中采用了相同的方式。

但是，如果您决定改变，有一些好的原则可以帮助您：

1.  最重要的是：在同步之前三思。我曾经有一位同事曾经同步过一些东西“以防万一——毕竟同步一定更好，对吧？” 这是错误的，并且是多个死锁错误的原因。
2.  如果您的对象可以是不可变的，则使它们不可变。这不仅有助于线程化，还有助于将它们安全地用于集合中，作为 Maps 等的键
3.  使您的对象尽可能简单。理想情况下，每个人都应该只做一项工作。如果您发现您可能想要同步对一半成员的访问，那么您可能应该将对象一分为二。
4.  学习 java.util.concurrent 并尽可能使用它。在 99% 的情况下，他们的代码会比你的（或我的）更好、更快、更安全。
5.  阅读[Java 中的并发编程，](http://java.sun.com/docs/books/cp/)非常棒！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-12T02:54:09.800

顺便说一句：同步！=线程安全。即便如此，您可能不会同时修改数据，但您可能会同时读取它。因此，请记住 Java 内存模型，其中同步意味着使数据在所有线程中可靠可用，而不仅仅是保护它的并发修改。

是的，在我看来，线程安全必须从一开始就内置，如果您需要处理并发，它取决于应用程序逻辑。永远不要假设任何事情，即使您的测试似乎很好，比赛条件也是睡狗。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-25T04:04:57.127

我发现[JCIP](http://www.javaconcurrencyinpractice.com/)注释对于声明哪些类是线程安全的非常有用。我的团队将我们的类注释为[@ThreadSafe](http://www.javaconcurrencyinpractice.com/annotations/doc/net/jcip/annotations/ThreadSafe.html)、[@NotThreadSafe](http://www.javaconcurrencyinpractice.com/annotations/doc/net/jcip/annotations/NotThreadSafe.html)或[@Immutable](http://www.javaconcurrencyinpractice.com/annotations/doc/net/jcip/annotations/Immutable.html)。这比阅读 Javadoc 要清楚得多，而且[FindBugs](http://findbugs.sf.net)也可以帮助我们发现违反 @Immutable 和[@GuardedBy](http://www.javaconcurrencyinpractice.com/annotations/doc/net/jcip/annotations/GuardedBy.html)合同的情况。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-24T17:00:48.903

您绝对应该知道哪些代码段将是多线程的，哪些不会。

如果不能将多线程区域集中到一个小的、可控的部分，你就不会成功。您的应用程序中的多线程部分需要仔细检查、全面分析、理解并适应多线程环境。

其余的则没有，因此使其成为线程安全的将是一种浪费。

例如，对于 swing GUI，Sun 刚刚决定不再使用多线程。

哦，如果有人使用你的类——这取决于他们确保如果它在一个线程部分中，那么让它成为线程安全的。

Sun 最初推出了线程安全集合（仅）。问题是，线程安全不能成为非线程安全的（出于性能目的）。所以现在他们推出了带有包装器的非线程安全版本，以使它们成为线程安全的。在大多数情况下，包装器是不必要的——假设除非你自己创建线程，否则你的类不必是线程安全的——但在 javadocs 中记录它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-11-03T13:20:01.760

> 如果我创建目前仅在单个线程中使用的类，我应该使它们成为线程安全的吗

线程使用的类本身不需要线程安全，程序作为一个整体是线程安全的。**如果**它们受到适当的同步保护，您可以在线程之间安全地共享非“线程安全”类的对象。因此，在这一点变得明显之前，没有必要让一个类本身成为线程安全的。

但是，多线程是程序中的基本（架构）选择。这[并不是事后才添加的东西](https://stackoverflow.com/questions/2165782/how-to-deal-with-concurrency-before-you-start-coding)。所以你应该从一开始就知道哪些类需要是线程安全的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-03-08T06:43:34.363

这是我个人的做法：

*   尽可能使对象和数据结构**不可变**。这通常是一种很好的做法，并且自动是线程安全的。问题解决了。
*   If you have to make an object mutable then normally **don't bother trying to make it thread safe**. The reasoning for this is simple: when you have mutable state then locking / control cannot be safely handled by a single class. Even if you synchronize all the methods, this doesn't guarantee thread safety. And if you add synchronisation to an object that only ever gets used in a single-threaded context, then you've just added unnecessary overhead. So you might as well leave it up to the caller / user to implement whatever locking system is necessary.
*   If you provide a higher level public API then **implement whatever locking is required to make your API thread safe**. For higher level functionality the overhead of thread safety is pretty trivial, and your users will definitely thank you. An API with complicated concurrency semantics that the users need to work around is not a good API!

This approach has served me well over time: you may need to make the occasional exception but on average it's a very good place to start!

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-24T16:52:44.317

如果您想了解 Sun 在 Java API 中所做的事情，可以查看集合类。许多常见的集合类不是线程安全的，但有线程安全的对应物。根据 Jon Skeet（见评论）的说法，许多 Java 类最初是线程安全的，但它们并没有使开发人员受益，因此一些类现在有两个版本——一个是线程安全的，另一个不是线程安全的。

我的建议是，除非您必须这样做，否则不要使代码成为线程安全的，因为线程安全涉及一些开销。我想这与优化属于同一类别-在必须这样做之前不要这样做。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-24T16:53:08.170

分别设计要从多个线程中使用的类，并记录仅从单个线程中使用的其他类。

单线程的更容易使用。

分离多线程逻辑有助于使同步正确。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-24T17:13:27.927

“总是”在软件开发中是一个非常危险的词……像这样的选择是“总是”情境的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-09-27T22:59:57.463

为了避免竞争条件，只锁定一个对象 - 冗长地阅读竞争条件的描述，你会发现交叉锁（竞争条件是用词不当 - 竞争在那里停止）总是两个 + 线程试图锁定的结果两个 + 对象。

使所有方法同步并进行测试 - 对于任何实际必须处理问题的现实世界应用程序同步是一个很小的成本。他们没有告诉你的是，整个事情确实锁定在 16 位指针表上......那时你是呃，......

只要保持你的汉堡翻转简历'最新。

# c++ - TCHAR 仍然相关吗？

> ID：234365
> 
> 赞同：88
> 
> 时间：2008-10-24T16:55:50.770
> 
> 标签：c++, c, windows, unicode, wchar-t

我是 Windows 编程的新手，在阅读 Petzold 的书后，我想知道：

`TCHAR`使用类型和`_T()`函数来声明字符串是否仍然是一种好习惯，或者我是否应该只在新代码中使用`wchar_t`和字符串？`L""`

我将只针对 Windows 2000 及更高版本，我的代码从一开始就是[i18n 。](http://en.wikipedia.org/wiki/Internationalization_and_localization)

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2008-11-26T20:46:42.813

简短的回答： **不**。

就像所有其他人已经写过的一样，很多程序员仍然使用 TCHAR 和相应的函数。在我看来**，整个概念是个坏主意**。[UTF-16](http://en.wikipedia.org/wiki/UTF-16/UCS-2)字符串处理与简单的 ASCII/MBCS 字符串处理有很大不同。如果你对它们都使用相同的算法/函数（这是 TCHAR 想法的基础！），如果你做的不仅仅是简单的字符串连接（比如解析等）。主要原因是[代理](http://msdn.microsoft.com/en-us/library/dd374069.aspx)。

唯一的例外是，当您**确实**必须为不支持 Unicode 的系统编译应用程序时，我认为没有理由在新应用程序中使用过去的这种包袱。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2010-06-09T01:12:07.760

我必须同意萨沙。`TCHAR`// etc的底层前提`_T()`是你可以编写一个基于“ANSI”的应用程序，然后通过定义一个宏神奇地赋予它Unicode支持。但这是基于几个错误的假设：

**您积极构建软件的 MBCS 和 Unicode 版本**

否则，你*会*滑倒，`char*`在很多地方使用普通的字符串。

**您不在 _T("...") 文字中使用非 ASCII 反斜杠转义**

除非您的“ANSI”编码恰好是 ISO-8859-1，否则结果`char*`和`wchar_t*`文字不会代表相同的字符。

**UTF-16 字符串的使用就像“ANSI”字符串一样**

他们不是。Unicode 引入了大多数传统字符编码中不存在的几个概念。代理人。组合字符。正常化。条件和语言敏感的大小写规则。

也许最重要的是，UTF-16 很少保存在磁盘上或通过 Internet 发送的事实：UTF-8 往往更适合外部表示。

**您的应用程序不使用 Internet**

*（现在，对于您的*软件来说，这可能是一个有效的假设，但是......）

[网络在 UTF-8](http://w3techs.com/technologies/overview/character_encoding/all)和[大量稀有编码](http://www.iana.org/assignments/character-sets)上运行。这个`TCHAR`概念只识别两个：“ANSI”（[*不能*是 UTF-8](https://stackoverflow.com/questions/2995111/why-isnt-utf-8-allowed-as-the-ansi-code-page)）和“Unicode”（UTF-16）。它对于让你的 Windows API 调用支持 Unicode 可能很有用，但它对于让你的 Web 和电子邮件应用程序支持 Unicode 毫无用处。

**您不使用非 Microsoft 库**

没有其他人使用`TCHAR`. [Poco](http://pocoproject.org/)使用`std::string`和 UTF-8。 [SQLite](http://www.sqlite.org/)有其 API 的 UTF-8 和 UTF-16 版本，但没有`TCHAR`. `TCHAR`甚至不在标准库中，所以`std::tcout`除非你想自己定义它。

## 我推荐什么而不是 TCHAR

忘记存在“ANSI”编码，除非您需要读取无效的 UTF-8 文件。也别想`TCHAR`了。始终调用“W”版本的 Windows API 函数。 `#define _UNICODE`只是为了确保您不会意外调用“A”函数。

始终对字符串使用 UTF 编码：对字符串使用 UTF-8，对`char`字符串使用 UTF-16（在 Windows 上）或 UTF-32（在类 Unix 系统上）`wchar_t`。 `typedef` `UTF16`和`UTF32`字符类型以避免平台差异。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-10-24T17:19:04.763

如果您想知道它是否仍在实践中，那么是的 - 它仍然被使用了很多。如果你的代码使用了 TCHAR 和 _T("")，没有人会觉得你的代码很有趣。我现在正在进行的项目正在从 ANSI 转换为 unicode - 我们正在采用可移植 (TCHAR) 路线。

***然而...***

我的投票是忘记所有 ANSI/UNICODE 可移植宏（TCHAR、_T("") 和所有 _tXXXXXX 调用等...），而只是假设到处都是 unicode。如果您永远不需要 ANSI 版本，我真的看不出便携的意义。我会直接使用所有宽字符函数和类型。在所有字符串文字前加上 L。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-24T17:32:25.233

如果我今天做一个新项目，我仍然会使用 TCHAR 语法。使用它和 WCHAR 语法之间没有太大的实际区别，我更喜欢在字符类型是什么方面明确的代码。由于大多数 API 函数和辅助对象采用/使用 TCHAR 类型（例如：CString），因此使用它才有意义。此外，如果您决定在某个时候在 ASCII 应用程序中使用代码，或者 Windows 曾经演变为 Unicode32 等，它还为您提供了灵活性。

如果您决定走 WCHAR 路线，我会明确说明。也就是说，使用 CStringW 代替 CString，并在转换为 TCHAR 时转换宏（例如：CW2CT）。

无论如何，这是我的看法。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-08-14T16:49:22.613

MSDN 上的[Windows 编程简介文章](http://msdn.microsoft.com/en-us/library/ff381407(VS.85).aspx)说

> 新应用程序应始终调用（API 的）Unicode 版本。
> 
> **TEXT**和**TCHAR**宏现在用处不大，因为所有应用程序都应该使用 Unicode 。

我会坚持`wchar_t`和`L""`。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-01-24T17:54:00.230

我想提出一种不同的方法（两者都不是）。

总而言之，使用 char* 和 std::string，假设 UTF-8 编码，并且仅在包装 API 函数时才转换为 UTF-16。

Windows 程序中这种方法的更多信息和理由可以在[http://www.utf8everywhere.org](http://www.utf8everywhere.org)中找到。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-03-15T02:45:33.620

`TCHAR`/`WCHAR`对于一些遗留项目来说可能就足够了。但是对于新的应用程序，我会说**NO**。

由于历史原因，所有这些`TCHAR`/东西都在那里。提供了一种看似巧妙的方式（伪装）在 ANSI 文本编码 (MBCS) 和 Unicode 文本编码 (UTF-16) 之间切换。过去，人们并不了解世界上所有语言的字符数。他们假设 2 个字节足以表示所有字符，因此具有使用. **然而，在1996 年**Unicode 2.0 发布后，情况就不再如此了。`WCHAR``TCHAR``WCHAR`

 **也就是说：无论你在`CHAR`/ `WCHAR`/`TCHAR`中使用哪个，你程序中的文本处理部分都应该能够处理**变长字符**以进行国际化。

所以你实际上需要做的不仅仅是从`CHAR`//`WCHAR`中选择一个`TCHAR`在Windows中进行编程：

1.  如果您的应用程序很小并且不涉及文本处理（即只是将文本字符串作为参数传递），那么坚持使用`WCHAR`. 因为这种方式更容易使用支持 Unicode 的 WinAPI。
2.  否则，我建议使用 UTF-8 作为内部编码并将文本存储在 char 字符串或 std::string 中。并在调用 WinAPI 时将它们转换为 UTF-16。[UTF-8](http://en.wikipedia.org/wiki/UTF-8)现在是主要的编码，并且有许多方便的库和工具来处理 UTF-8 字符串。

查看这个精彩的网站以获得更深入的阅读： [http ://utf8everywhere.org/](http://utf8everywhere.org/)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-24T17:07:18.030

是的，一点没错; 至少对于 _T 宏。不过，我不太确定宽字符的东西。

原因是为了更好地支持 WinCE 或其他非标准 Windows 平台。如果您 100% 确定您的代码将保留在 NT 上，那么您可能只使用常规的 C 字符串声明。但是，最好倾向于更灵活的方法，因为在非 Windows 平台上#define 该宏要容易得多，而不是通过数千行代码并将其添加到任何地方，以防您需要移植一些库到windows手机。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-26T07:31:27.420

恕我直言，如果您的代码中有 TCHAR，那么您在错误的抽象级别上工作。

在处理文本处理时使用对您最方便的任何字符串类型 - 希望这将支持 unicode，但这取决于您*。*根据需要在 OS API 边界进行转换。

处理文件路径时，请创建自己的自定义类型，而不是使用字符串。这将允许您独立于操作系统的路径分隔符，将为您提供比手动字符串连接和拆分更容易的编码接口，并且更容易适应不同的操作系统（ansi、ucs-2、utf-8 等） .

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-01-06T03:24:37.827

我看到使用除显式 WCHAR 之外的任何东西的唯一原因是可移植性和效率。

如果您想让最终的可执行文件尽可能小，请使用 char。

如果您不关心 RAM 的使用并希望国际化像简单的翻译一样简单，请使用 WCHAR。

如果您想让您的代码灵活，请使用 TCHAR。

如果您只打算使用拉丁字符，您不妨使用 ASCII/MBCS 字符串，这样您的用户就不需要那么多 RAM。

对于“从一开始就是 i18n”的人来说，节省源代码空间并简单地使用所有 Unicode 函数。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-06-25T12:45:09.500

只是添加一个老问题：

# 不

在 VS2010 中开始一个新的 CLR C++ 项目。微软自己使用`L"Hello World"`，'nuff 说。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-05-07T21:18:23.413

`TCHAR`有一个新的含义 to port from `WCHAR`to `CHAR`。

[https://docs.microsoft.com/en-us/windows/uwp/design/globalizing/use-utf8-code-page](https://docs.microsoft.com/en-us/windows/uwp/design/globalizing/use-utf8-code-page)

> 最新版本*的 Windows 10*使用 ANSI 代码页和 -A API 作为向应用程序引入 UTF-8 支持的一种方式。如果为 UTF-8 配置 ANSI 代码页，则 -A API 以 UTF-8 运行。

# html - 网站作为图像/剪贴画库有参考吗？

> ID：234367
> 
> 赞同：1
> 
> 时间：2008-10-24T16:55:52.890
> 
> 标签：html, image, web

作为一名软件开发人员，我做过许多网页应用程序，并一直在写博客以获取我的编程经验。我想在很多情况下使用图片。**图片价值千言万语，它们是通用语言**！

您可以创建自己的剪贴画图像或下载图形（实际上很多都是可用的开放剪贴画/图像库，例如[打开剪贴画库](http://openclipart.org/media/view/media/home)）。但是您的时间和艺术技能是有限的，您只能保留有限的图像库。

我希望是否有任何具有永久引用的开放艺术/图像库网站，这样您只需在 html 页面中添加一个简单的引用，就像您可以使用其他人或网站图形的方式一样：

```
<img src="http://OpenArtLibray.net/icon/work/DoItYourself.png".../> 
```

这样，无需浪费时间下载和上传图像，也不会浪费您和其他计算机的磁盘空间（无重复）。只有一个地方有大量各种可用的图像，并开放供人们使用，或者收取一些合理的费用。人们也可以投票决定艺术/图像的受欢迎程度。

有没有这样的网站可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T17:43:29.580

通常网站不鼓励这样做。这真正做的是将带宽成本转移到托管站点。在某些情况下，带有图片的网站会分析引荐来源网址，以确定图片是否链接到其他网站，然后提供带有文本的图片，声称该图片被“窃取”。

关键是这个想法不是很受欢迎。

但是，某些网站（例如 w3c）允许您链接到他们的认证图片。这完全取决于您要链接的内容。

很难想象一家企业会这样做，因为似乎没有收入方面。

即使有些人被收取了费用，通过推荐人文本检查/验证谁支付了很多工作。也许你有一个新的商业计划。

更新：哦，我有一个朋友总是给我发邮件，里面有 flickr 的链接。也许他们的许可证允许您链接到他们网站上的图像。有东西让你检查。

更新：这个文本，“照片托管网站”，是一个有趣的、相关的谷歌搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T19:42:37.640

感[谢克里斯](https://stackoverflow.com/users/15578/chris)的解释。我可以接受它作为答案。但是，我提出这个问题是因为我真的不喜欢“窃取”图像。我可以看到收费很难，但是网上有很多可用的开放资源。实际上，我发现了一个[开放剪贴画库](http://openclipart.org/media/view/media/home)，它允许人们贡献和分享图像。我在那里找到了很多好照片并下载了。当我为我的博客创建图像时，我可能会贡献一些，所以我会让人们使用我的。

Flickre 是一个供人们存储和共享图片的开放社交场所。只要图片在那里共享，特别是由人们共享，我认为您可以在那里使用和链接图像。您仍然必须完成工作：创建和上传。实际上，我尝试了另一个名为[DropBox](https://www.getdropbox.com/home)的开放社交网站。我可以在那里创建一个公共文件夹并添加我的图片以进行共享。所有这些网站都有一个共同问题：个人帐户，如果在一段时间内不活动（DropBox 为 90 天？），可能无法使用。

这就是我在 StackOverFlow 中问这个问题的原因。我希望有些人可能知道一些可用的主机或任何其他可用的替代选项。也许就像克里斯说的那样，“这个想法不太受欢迎”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-28T11:53:48.260

尝试[搜索知识共享许可](http://search.creativecommons.org/)的作品。人们通常会根据知识共享许可在 Flickr 等地方上传和分享照片，该许可允许您在自己的项目、博客或网站上重新混合、参考或使用。

CC 下有不同类型的许可，如果您打算从中赚钱或从事商业活动，有些许可会要求您不要使用他们的作品。

使用 CC 下的项目时，您只需向原作者点头，如果您链​​接回它们，那就是好业力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T16:30:41.103

实际上，我意识到我在上一封电子邮件中提到的 Open Clip Art Library 确实提供了类似图像托管的服务。如果您单击任何人的图片下载链接，它将打开一个新选项卡或窗口以显示该图形。显示器有它的 URL。我创建了一个新的用户名并提交了我的图片。它运作良好。我可以在我的测试网页中包含图形。不确定该 URL 会存在多长时间。它看起来像永久的。

# gis - 如何获取大量 shapefile 并将它们排列在 GIS 中？

> ID：234374
> 
> 赞同：0
> 
> 时间：2008-10-24T16:57:13.637
> 
> 标签：gis, shapefile

我正在尝试获取我创建的县内细分的 shapefile，并将其与县评估区（地块数据）提供给我的另一个 shapefile 对齐。当我试图让他们排队时，我的街道 shapefile 与其他所有内容都不对齐。它们都在同一个坐标系上，我不想为细分重新创建 shapefile。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-26T00:23:40.737

这个问题的答案可能很简单，也可能很复杂，具体取决于您的情况。作为一名 GIS 开发人员，我最常将此视为坐标系定义不正确的症状。但是，是否是这种情况以及解决方案在很大程度上取决于您的环境。从这里开始，我假设您正在使用 ESRI 包...

我同意其他海报的观点，即您的问题是不匹配的投影和/或基准定义之一。

关于 ESRI 软件中的预测，最重要的一点是：

**在 ArcCatalog 中手动设置数据集（shapefile、地理数据库要素类等）的投影不会重新投影该数据集！！！**

为了重新投影您的数据，您必须从您一直在其中工作且数据明显正确排列的 ArcMap 会话中导出数据。在导出过程中，您可以选择使用基础地图的坐标系或原始数据集的坐标系保存数据。

您最好的办法是按照以下步骤创建具有正确投影的新数据集，然后推断您需要做什么来解决您的特定问题：

1.  创建一个新的 ArcMap 会话并设置其坐标系：

在没有其他数据的新 ArcMap 会话中执行此操作。请务必将 ArcMap 地图视图的坐标系显式设置为所需的坐标系（我推荐与您尝试叠加的数据相匹配的坐标系，或者来自另一个成熟数据集的坐标系）。

1.  添加另一个具有已知良好坐标系的数据集。

2.  在此 ArcMap 会话中创建新数据集。为您的新数据提供与 ArcMap 地图视图和地图中的另一个数据集相同的坐标系。将新数据的 XY 域设置为超出其他数据集定义的区域，但不要超出会降低所需空间分辨率的大小。

3.  创建您的数据。此时可以是任何数据。一些线，一些多边形等。保存您的工作。

4.  导出新数据集。出现提示时，选择使用底层地图视图的坐标系进行保存。

5.  创建一个新的 ArcMap 会话并添加您的新数据集。然后添加您的宗地数据集。它们现在应该在您的地图窗口中占据相同的空间。

6.  随心所欲地编辑新数据。

如果这没有帮助，可能会出现一些问题：

*   您没有正确执行这些步骤 - 检查 ESRI 文档；这是一个有据可查的问题。

*   您尝试匹配的宗地数据没有正确定义的坐标系。这些数据的保存者总是有可能不知道他们在做什么，并且把它搞砸了。我已经多次看到这个问题，我愿意承认。

*   您已匹配投影，但与基准面不匹配。许多市政当局仍在使用 NAD27 中的数据，这已经过时了。有些人已经转移到现代 NAD83。差异可能高达 300 米，具体取决于您所在的国家/地区。此外，源自测量或 GPS 设备的数据通常在 WGS84（卫星测量的典型默认设置）中收集，这在所有实际目的上与 NAD83 相同，至少在测绘比例分辨率上。

尝试研究这些问题，看看情况如何。我再说一遍：

**手动设置投影实际上并不投影该数据！**

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T17:04:45.307

您的问题可能是投影之一

| 投影：命名要使用的地图投影的字符串。见 | “mapproject”（在“mapproj”库中）。默认为 | 使用长宽比选择的矩形投影| 经度和纬度比例在 | 图片的中心。`-----

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T15:51:14.953

同意你的问题是投影。是否有与您的任何一个文件关联的 .prj 文件扩展名？如果不是关键首先是找出你有什么项目。如果您正在处理来自当地政府的以美国为中心的本地数据，我会猜想某种国家飞机。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T15:32:19.903

地籍工具（测量工具）通常让您指定少数控制点，然后将“扭曲”数据以适合您的控制点。这可以是任何事情，从简单的转变到更复杂的事情。如果所有内容都移动了几英尺，您也可以使用“编辑器”选择所有 shapefile，然后将它们移动到必要的多英尺。

如果您已验证两个 shapefile 使用相同的坐标系，则投影不太可能成为问题。宗地数据从其他数据源（例如道路）“偏移”是相当常见的。这来自不一致的收集方法和参考点。

另一个错误来源可能是其中一个 shapefile 指定了错误的坐标系。例如，如果道路实际上是 WGS 1984，但它的 prj 设置为 NAD1983，您将看到一些重大错误。如果您必须手动设置 shapefile 的坐标系统（即它不包含 PRJ 而您创建了一个），通常会发生这种情况。

# .net - XmlReader - 将当前节点读取为字符串

> ID：234379
> 
> 赞同：2
> 
> 时间：2008-10-24T16:57:52.277
> 
> 标签：.net, xml, vb.net, xmlreader

在下面的代码片段中，当我遇到一个元素时，使用 XmlReader。我想按原样阅读它，包括元素中的所有属性和命名空间装饰。使用 oXml.Name 属性，我只能获取标签名称。是否有获取标签本身的功能？

```
oXml = XmlReader.Create(path, oXmlSettings)
While oXml.Read()
   Select Case oXml.NodeType
      Case XmlNodeType.Element
        'Read Element as-is
         If taglist.contains(oXml.Name)
           stringbuilder.Append(oXml.ReadOuterXml())
         End If
      Case XmlNodeType.Text
         stringbuilder.Append(oXml.Value)
   End Select
End While 
```

我试过 oXml.ReadOuterXml() 但它返回元素及其子内容。这可能是可以接受的，但是当我刚刚从 ReadOuterXml 获得的元素已被解析时，我如何快进我的 XmlReader 以忽略后续的 XmlNodeType.Text 和 XmlNodeType.EndElement？

更新：对于以下代码片段，loc1 在 taglist 中，因此使用 ReadOuterXml 编写，但解析器无法获取以下“！” 特点。

```
<para>
  Test blabla <loc1 href="test">complicated</loc1>!
</para> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T17:02:47.137

我没有尝试过，但我不希望您在调用 ReadOuterXml 后必须快进阅读器。我希望读取外部 XML 的行为能够使用它。

你试过了吗？

# perl - RegSvr32 注册但没有实际注册

> ID：234382
> 
> 赞同：2
> 
> 时间：2008-10-24T16:58:29.017
> 
> 标签：perl, activex, regsvr32, pdk

一个相当奇怪的经历。使用来自 ActiveState 的最新 PDK (v7.3)，我使用 perlctrl 构建了一个 COM DLL。Perlctrl 运行顺利。OLEView 读了typelib 好了。RegSvr32 注册好了。但是......在注册表中没有任何迹象，任何试图使用它的东西都会失败。我使用 RegEdit 寻找各种 UID，但它们不存在。

代码如下。它是 Lingua::ZH::WordSegmenter 的包装，但编码更改为 utf8 而不是 gbk。

这可能是显而易见的......

```
package ZHWordSeg;

use strict;
use warnings;
use utf8;
use ws;

use Encode;

use constant STX => chr( 2 ); #[
use constant ETX => chr( 3 ); #]
use constant FS => chr( 28 ); #^
use constant RS => chr( 30 ); #~

use constant TAB_SEPARATOR => 0;
use constant CARET_SEPARATOR => 1;
use constant FS_SEPARATOR => 2;
use constant SPACE_SEPARATOR => 3;
use constant AS_ARRAY => 4;

use feature 'switch';

our $segmenter; 

sub ZHWordSeg_Setup {
  my $dic = shift;
  my $dic_encoding = shift;
  my $separator = shift;
  my $verbose = shift;

  $dic_encoding = 'utf8' unless defined( $dic_encoding );
  $separator = " " unless defined( $separator );
  $verbose = 0 unless defined( $verbose );

  if ( defined( $dic ) ) {
    $segmenter = ws->new( dic => $dic, dic_encoding => $dic_encoding, seperator => $separator, verbose => $verbose );
  } else {
    $segmenter = ws->new( dic_encoding => $dic_encoding, seperator => $separator, verbose => $verbose );
  }
}

sub ZHWordSeg {
  my $source = shift;
  print STDERR $source;
  my $sepcode = shift;
  $source = encode("utf8",$source);
  my $stringres = $segmenter->seg($source);
  my @arrayres;

  given ($sepcode) {
    when (TAB_SEPARATOR) { 
      $stringres =~ tr/ /\t/;
      return $stringres;
    }
    when (CARET_SEPARATOR) { 
      $stringres =~ tr/ /^/;
      $stringres .= "^";
      return $stringres;
    }
    when (FS_SEPARATOR) { 
      $stringres =~ s/ /FS/eg;
      $stringres .= FS;
      return $stringres;
    }
    when (SPACE_SEPARATOR) { 
      return $stringres;
    }
    default { 
      @arrayres = split( / /, $stringres );
      return \@arrayres;
    }
  }
}

sub SetDictionary {
  my ($source) = shift;
  my $res = set_dic($source);
  return $res;
}

1;

=pod

=begin PerlCtrl

%TypeLib = (
  PackageName     => 'ZHWordSeg',
  DocString       => 'Chinese word segmentation',
  HelpContext     => 1,
  TypeLibGUID     => '{F6C9BD66-7CA1-4610-B77F-E219A7122C18}', # do NOT edit this line
  ControlGUID     => '{45D47C6A-2B9A-4D62-9CFD-F18C95DC00C5}', # do NOT edit this line either
  DispInterfaceIID=> '{007E4E7A-3B75-4DC3-864C-7746860941B3}', # or this one
  ControlName     => 'BOCWS',
  ControlVer      => 2,  # increment if new object with same ProgID
  # create new GUIDs as well
  ProgID          => 'ZHWordSeg.BOCWS',
  LCID            => 0,
  DefaultMethod   => 'ChineseWordSegmenter',
  Methods         => {
      'ChineseWordSegmenter' => {
        RetType             =>  VT_VARIANT,
        TotalParams         =>  2,
        NumOptionalParams   =>  1,
        ParamList           =>  
          [ 'source' => VT_BSTR,
            'sepcode' => VT_I4
          ] 
      },
      'ChineseWordSegmenter_Setup' => {
        RetType             =>  VT_VARIANT,
        TotalParams         =>  4,
        NumOptionalParams   =>  4,
        ParamList           =>  
          [ 'dic' => VT_BSTR,
            'dic_encoding' => VT_BSTR,
            'separator' => VT_BSTR,
            'verbose' => VT_BSTR
          ] 
      }
  },  # end of 'Methods'
  Properties        => {
    TAB_SEPARATOR => {
      DocString  => "Separate items with TAB (0x0)",
      Type => VT_I4, 
      DispID => 3,
      ReadOnly => 1,
    },
    CARET_SEPARATOR => {
      DocString  => "Separate items with ^ (0x1)",
      Type => VT_I4, 
      DispID => 4,
      ReadOnly => 1,
    },
    FS_SEPARATOR => {
      DocString  => "Separate items with ascii 28 (0x2)",
      Type => VT_I4, 
      DispID => 5,
      ReadOnly => 1,
    },
    SPACE_SEPARATOR => {
      DocString  => "Separate items with space (0x3)",
      Type => VT_I4, 
      DispID => 6,
      ReadOnly => 1,
    },
    AS_ARRAY => {
      DocString  => "Separate items as array (0x4)",
      Type => VT_I4, 
      DispID => 7,
      ReadOnly => 1,
    }
  },  # end of 'Properties'
);  # end of %TypeLib

=end PerlCtrl

=cut 
```

这是 .perlctrl 文件，以防万一：

```
#!C:\Program Files\ActiveState Perl Dev Kit 7.3 Deployment\bin\lib\pai.exe
PAP-Version: 1.0
Packer: C:\Program Files\ActiveState Perl Dev Kit 7.3 Deployment\bin\perlctrl.exe
Script: ZHWordSeg.ctrl
Cwd: P:\BOCWS
Byref: 0
Clean: 0
Date: 2008-10-24 18:05:42
Debug: 127.0.0.1:2000
Dependent: 0
Dyndll: 0
Exe: BOCWS.dll
Force: 1
Gui: 0
Hostname: xi
No-Compress: 0
No-Gui: 0
No-Logo: 0
Runlib: 
Shared: none
Singleton: 0
Tmpdir: 
Verbose: 0
Version-Comments: 
Version-CompanyName: 
Version-FileDescription: Wrapper of Lingua::ZH::WordSegmenter.pm
Version-FileVersion: 1.0
Version-InternalName: ZHWordSeg
Version-LegalCopyright: 
Version-LegalTrademarks: 
Version-OriginalFilename: ZHWordSeg.ctrl
Version-ProductName: BOChineseWordSegmenter
Version-ProductVersion: 1.0
Warnings: 0
Xclude: 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T03:07:27.303

我发现的唯一“[解决方案”是在 news:comp.os.ms-windows.programmer.win32 上提出的](http://groups.google.com/group/comp.os.ms-windows.programmer.win32/browse_thread/thread/8674ae1ff9b751e3?q=axtens+regsvr32#d514714d20613f3b)

> i am not a PDK user but from experience i can tell you, that you should check the DllRegister exports code and what it internally does, since this is what the regsvr32 calls and this code is creating the registry keys for your com server/proxy, etc, ...
> 
> You can track the registry for changes with sysinternal tools like regmon or procmon, just to make sure!

Ultimately, I gave up and went back to a previous version that worked and tweaked it.

# regex - 正则表达式匹配每个文件和每行多次出现

> ID：234386
> 
> 赞同：0
> 
> 时间：2008-10-24T17:00:07.437
> 
> 标签：regex, preg-replace

第一次发帖，就这样吧。我正在编写一个在文件树上进行智能搜索和替换的脚本。本质上，脚本将每个文件的内容放入缓冲区字符串中，并与预定义的模式进行匹配，在这种情况下，模式是`/^[^\r\n]*(vendor)[^\r\n]*$/im`. 该模式应该找到任何不区分大小写的“供应商”形式，并给我匹配的整行。我需要查看整行以确定是否替换该事件。这种模式对于给定文件中出现的任意数量的单独行都表现良好。

但是，如果在给定的行上有多个匹配项，则该模式将仅匹配其中一个匹配项，并跳过其他匹配项。我正在尝试确定是否需要第二个模式来在匹配的行上进行额外的搜索，或者我是否可以使用完成上述所有操作的单个模式来完成此目的。

只是我希望生产的样品。单行多次出现匹配的示例：

> 热情地彻底改变基于网络的供应商潜力供应商安装了基础电子零售商。

我想输出类似的东西（同样，输出不是这里的问题，我是否可以用一种模式来匹配它）：

> 行中多次出现：|| 热情地彻底改变基于网络的供应商潜力供应商安装了基础电子零售商。||
> 
> 代替？(y,n,q) || ...有能力的供应商潜力... ||
> 
> 代替？(y,n,q) || ...联系供应商即时... ||

如果我不清楚我的目标，请告诉我。感谢您对此的任何帮助和回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T17:52:49.827

如果您正在使用

```
/^[^\r\n]*(vendor)[^\r\n]*$/im 
```

我建议添加 g （全局）运算符

```
/^[^\r\n]*(vendor)[^\r\n]*$/img 
```

# c++ - 生成一副牌

> ID：234388
> 
> 赞同：8
> 
> 时间：2008-10-24T17:00:31.947
> 
> 标签：c++

我正在尝试制作一个简单的二十一点程序。可悲的是，我在生成一副纸牌时遇到了问题。

```
#include <iostream>
#include <vector>

using namespace std;

int main() {
    vector<char> deck;
    char suit[] = {'h','d','c','s'};
    char card[] = {'2','3','4','5','6','7','8','9','10','J','Q','K','A'};
    for (int j=0; j<13; j++) {
        for (int i=0; i<4; i++) {
            deck.push_back(card[j] suit[i]);
        }       
    }

    return 0;
} 
```

我知道我的问题始于我试图将值“10”分配给一个字符。显然我无法编译它，但我敢肯定，当我尝试将卡片值分配给矢量卡组时，我也会得到一个错误，因为我使用了变量类型“char”。知道要使用什么样的变量类型似乎让我很生气。另外，'deck.push_back(card[j] suit[i]);' 是组合卡片和花色的正确代码，还是必须在卡片 [j] 和花色 [i] 之间添加一些东西？如果你们中的任何人能引导我朝着正确的方向前进，我将不胜感激。另外作为一个小旁注，这是家庭作业的一部分，所以请不要只给我整个代码块。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-24T17:08:06.470

我认为您要使用的是枚举。它将使您的代码更清晰并解决您的问题。

```
enum SUIT { HEART, CLUB, DIAMOND, SPADE }; 
enum VALUE { ONE, TWO, THREE, ..., TEN, JACK, QUEEN, KING}; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-24T17:05:42.667

尝试创建以花色和卡片为成员的卡片类，并将其设置为向量类型。像

```
public class Card {
 public:
  Card(char suit, char card);
  char suit, card;
};

int main() {
    vector<Card> deck;
    char suit[] = {'h','d','c','s'};
    char card[] = {'2','3','4','5','6','7','8','9','T','J','Q','K','A'};
    for (int j=0; j<13; j++) {
        for (int i=0; i<4; i++) {
                deck.push_back(new Card(card[j],suit[i]));
        }               
    }
    return 0;
} 
```

在西装和卡片中也使用枚举而不是字符会使其更清晰。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-24T17:34:18.413

您对其建模的方式实际上取决于您要做什么。

您是否正在创建一个实际的游戏，而数据结构只需要支持游戏玩法？

如果是这样，我会创建一个卡片类，其中包含用于花色的枚举字段和用于面值的数字类型（值 1 - 13）。

另一方面，如果您正在构建分析应用程序或 AI 播放器，那么模型可能会有所不同。

几年前，我编写了一个模拟器来计算各种德州扑克场景中的概率，我希望它能够真正快速地处理数字。我从一个非常简单的模型开始（卡片类、套装枚举等），但经过大量分析和优化后，我最终得到了按位表示。

每张牌是一个 16 位的值，其中 13 个高位表示面值，2 个低位表示花色，并且 bit[2] 作为一个特殊标志，表示 A（仅在以下情况下使用） ace 可能出现在 A2345 顺子中）。

这里有一些例子：

```
0000000000001001  <----  Two of hearts
0100000000000011  <----  King of spades
1000000000000110  <----  Ace of diamonds

^^^^^^^^^^^^^            ("face-value" bits)
             ^           ("low-ace" flag)
              ^^         ("suit" bits) 
```

你可以想象，通过这样的设计，寻找对子、三人组和顺子（同花稍微复杂一些）是如何快速的。

我不会详细介绍所有特定的操作，但只要说这种模型每秒支持数百万次操作就足够了……

当然，请记住，我实际上并不是在提倡您在简单的游戏实现中使用这样的设计。我最终选择这个设计的唯一原因是因为我需要进行大规模的统计模拟。

因此，请仔细考虑您要如何建模：

*   每张卡
*   玩家的手
*   整个甲板
*   牌桌状态...包括所有玩家手牌（包括已拆分初始手牌的玩家），可能是六副牌鞋，弃牌堆等

总体应用程序模型和一般应用程序的目标将在很大程度上决定最合适的数据结构类型。

玩得开心！！！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-24T17:02:23.750

使用“T”而不是 10。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-24T17:02:25.717

您是否尝试过将 J 替换为 11、Q 替换为 12 以及 K 替换为 13？然后你可以使用`int`egers 而不是演员`char`。稍后将 11-13 替换为适当的字母。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-24T17:06:42.510

好吧，首先，deck[0] 是一个字符，但您正在尝试将“2h”塞入其中。（目前，我们将忽略您的做法是错误的。）

基本上，您需要将甲板制作成`vector<std::string>`. 将 card 设为 const char*s 数组，并将元素转换为字符串。

然后使用：

```
deck.push_back(std::string(card[j]) + suit[i]); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-24T17:06:35.007

正如其他人所提到的，您可以使用“T”来表示十，使用 J、Q 和 K 来表示数字。至于 push_back.. 由于 deck 是一个字符向量，因此您只能将一个字符作为参数传递给 push_back。同时传递牌面值（1...9，T，J，Q，K）和它的套件不起作用。

我个人会创建一个小结构来表示具有 Value 和 Suite 属性的 Card。然后，您可以使您的牌组成为 Cards 的向量。

编辑：修复最后一个单词，因为向量（小于）卡（大于）被渲染为向量（无）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-25T02:04:45.140

这可能无法编译，但这是我会（并且已经使用过）的方法。您将要使用整数来表示您的卡片，但您可以在一个类中轻松地抽象它。我会为你写的。

```
class Card
{
public:
    enum ESuit
    {
        kSuit_Heart,
        kSuit_Club,
        kSuit_Diamond,
        kSuit_Spade,
        kSuit_Count
    };

    enum ERank
    {
        kRank_Ace,
        kRank_Two,
        kRank_Three,
        kRank_Four,
        kRank_Five,
        kRank_Six,
        kRank_Seven,
        kRank_Eight,
        kRank_Nine,
        kRank_Ten,
        kRank_Jack,
        kRank_Queen,
        kRank_King,
        kRank_Count
    };

    static int const skNumCards = kSuit_Count * kRank_Count;

    Card( int cardIndex )
    : mSuit( static_cast<ESuit>( cardIndex / kRank_Count ) )
    , mRank( static_cast<ERank>( cardIndex % kRank_Count ) )
    {}

    ESuit GetSuit() const { return mSuit );
    ERank GetRank() const { return mRank );

private:
    ESuit mSuit;
    ERank mRank;
} 
```

现在很容易添加到这个类中以获得你想要的一切。要生成列表，如下所示。

```
rstl::vector<Card> mCards;
mCards.reserve( Card::skNumCards );

for ( int cardValue = 0; cardValue < Card::skNumCards; ++cardValue )
{
    mCards.push_back( Card( cardValue ) );
} 
```

你需要洗牌吗？

```
#include <algorithm>
std::random_shuffle( mCards.begin(), mCards.end() ); 
```

看看第一张卡的价值如何？

```
if ( mCards[0].GetSuit() == Card::kRank_Club && mCards[0].GetRank() == Card::kRank_Ace )
{
    std::cout << "ACE OF CLUBS!" << std::endl;
} 
```

我没有编译任何这些，但它应该很接近。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T17:13:32.073

由于这是一个二十一点程序，您将添加和比较卡片的价值。

在这种情况下，您可以通过为卡片提供*int*值 (1-13) 而不是*char*值来节省一些额外的编程和痛苦。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-05-07T01:37:04.713

当我创建[我的 C++ Deck of cards 类](http://www.binpress.com/app/anubis-cppcards/525?ad=1229)时，我遇到了一些我自己的问题。首先，我试图将[我的 PHP 扑克牌类](http://www.binpress.com/app/anubis-phpcards/518?ad=1229)转换为 C++，但运气不佳。我决定坐下来，把它写在纸上。我决定使用面向对象的设置，主要是因为我觉得它最容易用于扩展。我使用对象**Card**和**Deck**，因此，例如，如果您想将 10 个套牌放入您的二十一点游戏的**Shoe**中，您可以创建 10 个套牌，这很简单，因为我决定让所有东西都自成一体。事实上，它是如此独立，要创建你的鞋子，代码将是：

```
#include "AnubisCards.cpp"

int main() {

    Deck *shoe = new Deck(10);

} 
```

但是，这是为了简单起见，在只需要一个套牌的小型游戏中并不完全必要。

无论如何，**我**是通过创建一个包含 52 个 Card 对象的数组来生成套牌的。甲板很容易，因为你知道你有**4 套西装**和**每套 13 张牌**，你也知道你有**2,3,4,5,6,7,8,9,10,Jack,Queen,King,王牌在每一件西装**。这些永远不会改变。所以我使用了两个循环，一个用于**Suit**，另一个用于**Value**。

是这样的：

```
for(int suit = 1; suit <= 4; suit++){
    for(int card = 1; card <= 13; card++){
        // Add card to array
    }
} 
```

现在，您会注意到在每一个循环中，我使用了一个整数值。原因很简单，卡片就是数字。4套。13 个值。甚至是二十一点游戏中的数值。面值，直到您击中面值卡，这是数值 10，直到您击中数值 1 或 11 的 Ace。一切都是数字。因此，您不仅可以使用这些数字来分配卡片的价值，还可以分配卡片的花色以及数字序列中的数字。

一个想法是在 Card 类中存储一个地图，其中包含卡片的字符或字符串名称，其中 1,2,3... 是每个卡片的索引。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-24T17:19:39.893

我会同意罗斯的使用整数的建议。大多数纸牌游戏都会涉及一些数学知识，因此这是一个更好的表示。

在输出时转换为“A”或“ACE”等。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-24T18:41:34.207

由于这是 C++ 的作业，我猜你应该使用类。否则使用枚举，如果这是 C 使用结构或其他东西。

对于某些游戏，除了积分值之外，您还想为卡片存储某种等级，这取决于当前的游戏模式。

我从来没有做过纯 C，但我的意思是这样的：

```
typedef struct struct_card {
  unsigned short int suit:2;
  unsigned short int card:4;
//  unsigned short int valu:4;
} card;

int main() {
  card a_card;
  card std_deck[52];
  const unsigned short int rummy_value[13] = {1,2,3,4,5,6,7,8,9,10,10,10,10};
  const char *std_card_name[13] = {"Ace","Two","Three","Four","Five","Six",
    "Seven","Eight","Nine","Ten","Jack","Queen","King"};
  const char *std_suit_name[4] = {"Spades","Clubs","Hearts","Diamonds"};

  int j, k, i=0;
  for(j=0; j<4; j++){
    for(k=0; k<13; k++){
      a_card.suit=j; a_card.card=k;
      std_deck[i++] = a_card;
    }
  }

  //check our work
  printf("In a game of rummy:\n");
  for(i=0;i<52;i++){
    printf("  %-5s of %-8s is worth %2d points.\n",
        std_card_name[std_deck[i].card],
        std_suit_name[std_deck[i].suit],
        rummy_value[std_deck[i].card]);
  }

  //a different kind of game.
  enum round_mode {SHEILD_TRUMP, FLOWER_TRUMP, BELL_TRUMP, ACORN_TRUMP, BOCK, GEISS} mode;
  const card jass_deck[36]={
    {0,0},{0,1},{0,2},{0,3},{0,4},{0,5},{0,6},{0,7},{0,8},
    {1,1},{1,1},{1,2},{1,3},{1,4},{1,5},{1,6},{1,7},{1,8},
    {2,2},{2,1},{2,2},{2,3},{2,4},{2,5},{2,6},{2,7},{2,8},
    {3,3},{3,1},{3,2},{3,3},{3,4},{3,5},{3,6},{3,7},{3,8},
  };
#define JASS_V {11,0,0,0,0,10,2,3,4}
  const unsigned short int jass_value[9] = JASS_V;
#define JASS_TRUMP_V {11,0,0,0,14,10,20,3,4}
  const unsigned short int jass_trump_value[9] = JASS_TRUMP_V;
#define JASS_BOCK_V {11,0,0,8,0,10,2,3,4}
  const unsigned short int jass_bock_value[9] = JASS_BOCK_V;
#define JASS_GEISS_V {0,11,0,8,0,10,2,3,4}
  const unsigned short int jass_geiss_value[9] = JASS_GEISS_V;
  const char *jass_card_name[9] = {"Ace","Six","Seven","Eight","Nine","Banner",
    "Under","Ober","King"};
  const char *jass_suit_name[4] = {"Sheilds","Flowers","Bells","Acorns"};
  const unsigned short int jass_all_value[6][4][9] = {
    { JASS_TRUMP_V, JASS_V, JASS_V, JASS_V },
    { JASS_V, JASS_TRUMP_V, JASS_V, JASS_V },
    { JASS_V, JASS_V, JASS_TRUMP_V, JASS_V },
    { JASS_V, JASS_V, JASS_V, JASS_TRUMP_V },
    { JASS_BOCK_V, JASS_BOCK_V, JASS_BOCK_V, JASS_BOCK_V },
    { JASS_GEISS_V, JASS_GEISS_V, JASS_GEISS_V, JASS_GEISS_V }
  };

  //check our work 2: work goes on summer vacation
  printf("In a game of jass with trump (Sheilds | Flowers | Bells | Acorns) | Bock | Geiss\n");
  for(i=0;i<36;i++){
    printf("  %-6s of %-7s is worth %8d%10d%8d%9d%8d%8d\n",
        jass_card_name[jass_deck[i].card],
        jass_suit_name[jass_deck[i].suit],
        jass_all_value[SHEILD_TRUMP][jass_deck[i].suit][jass_deck[i].card],
        jass_all_value[FLOWER_TRUMP][jass_deck[i].suit][jass_deck[i].card],
        jass_all_value[BELL_TRUMP][jass_deck[i].suit][jass_deck[i].card],
        jass_all_value[ACORN_TRUMP][jass_deck[i].suit][jass_deck[i].card],
        jass_all_value[BOCK][jass_deck[i].suit][jass_deck[i].card],
        jass_all_value[GEISS][jass_deck[i].suit][jass_deck[i].card]);
  }
  return 0;
} 
```

输出如下所示：

```
In a game of rummy:
  Ace   of Spades   is worth  1 points.
  Two   of Spades   is worth  2 points.
  Three of Spades   is worth  3 points.
  Four  of Spades   is worth  4 points.
  Five  of Spades   is worth  5 points.
...
  Nine  of Diamonds is worth  9 points.
  Ten   of Diamonds is worth 10 points.
  Jack  of Diamonds is worth 10 points.
  Queen of Diamonds is worth 10 points.
  King  of Diamonds is worth 10 points.
In a game of jass with trump (Sheilds | Flowers | Bells | Acorns) | Bock | Geiss
  Ace    of Sheilds is worth       11        11      11       11      11       0
  Six    of Sheilds is worth        0         0       0        0       0      11
  Seven  of Sheilds is worth        0         0       0        0       0       0
  Eight  of Sheilds is worth        0         0       0        0       8       8
  Nine   of Sheilds is worth       14         0       0        0       0       0
  Banner of Sheilds is worth       10        10      10       10      10      10
...
  Under  of Acorns  is worth        2         2       2       20       2       2
  Ober   of Acorns  is worth        3         3       3        3       3       3
  King   of Acorns  is worth        4         4       4        4       4       4 
```

二十一点很无聊。这段代码可以编译。

# version-control - IDE内部还是外部的SCM？

> ID：234401
> 
> 赞同：1
> 
> 时间：2008-10-24T17:03:57.897
> 
> 标签：version-control

我个人一直在我的 SCM 工作中使用某种类型的外部应用程序；现在，这意味着windows上的[tortoiseSVN](http://tortoisesvn.tigris.org)和mac 上的[versions.app 。](http://versionsapp.com)然而，我一直在反对开发人员（即 eclipse 用户），他们认为 SCM 在 IDE 本身内完成更好。我还没有听到任何真正有说服力的支持这个工作流程的论据，而且我个人喜欢 IDE 和 SCM 操作之间一定程度的“分离”。在 Visual Studio 中使用不稳定的 SVN 插件，以及过去几年在离线工作时 Xcode 中不符合标准的 SVN 支持，这已经深深烙印在我身上。

在您看来，哪种方式可以促进更好的工作流程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T17:13:23.213

对于基本操作 - 签入签出我喜欢在 IDE 中进行操作，对于更高级的（分支/合并），我更喜欢使用外部工具。

在这些情况下，外部工具似乎可以提供更好的控制/选项。直接在 IDE 中工作时，您的选择似乎有限或不存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T17:56:27.013

我绝对更喜欢外面。话虽如此，我的主要 IDE 是 Visual Studio，我没有使用过 eclipse 或 intellij（虽然我在 emacs 中使用过 cvs-mode ......），所以你的里程可能会有所不同......

*   进行更改和提交更改是不同的任务 - 让它们都可以在 IDE 中轻松使用意味着您没有明确区分完成一组更改和提交它们。很多时候它是类型类型类型的情况，编译，测试，测试，提交......'哦，等等 - 我也忘了 foo 酒吧。从 IDE 模式到 SCM 模式的上下文切换往往会在提交之前触发“哦，等待”。

*   将提交的相关文件保存在一起 - 提交源更改太容易了，然后记住相关的 SQL 脚本并分别提交它们，然后添加新的图像文件，因为它们是存储库的新文件，等等。

*   与上述类似，在 IDE 中提交存储库中错误级别/目录的内容往往要容易得多。（例如，我应该在解决方案级别而不是项目级别提交）

*   在 IDE 之外的存储库中获取工作区的完整差异往往更容易，这通常是值得的。

*   它还可能使您的 IDE 更快一些

我也同意之前的海报 - 所有非平凡的 SCM 任务往往更容易外部开发 IDE 集成。

老实说，只要你避免上述混乱的提交情况，做任何你觉得最舒服的事情。在工作流程方面 - 分离必须“更清洁”，这种清洁是否超过便利将在旁观者的眼中 - 我们主要对我们的个人经历做出反应（我怀疑我的与你的相似）。

无论您做什么，都使用[SourceSafe](http://www.codinghorror.com/blog/archives/000660.html')以外的任何东西......我现在必须使用遗留代码 - 我发现文件被设为只读并且 SCM 集成物理地改变文件的内容是可恶的......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T19:54:13.217

One advantage to having the integration is in refactoring. If I renamed a class in Java (and thus the file name), your SCM integration would automatically handle the rename operation (a delete and then an add in svn, for example).

It also is very handy to be able to say, "show me the history of this file" or whatever while you are working on it, without having to drop to Windows Explorer or the command line or whatever.

But I like being able to have both available, honestly.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T19:54:44.357

I almost always use external tools. The only exception is when I need to rename a source file. It is just so much easier for the IDE to update its project references at the same time.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T17:20:11.500

这在很大程度上取决于 IDE/SCM 组合。我目前正在将 IntelliJ 与 SVN 一起使用，并且发现 IntelliJ 的 SVN 插件通常比 Tortoise 更易于使用。并不是说我对 Tortoise 有任何特别的抱怨——IntelliJ 更好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T18:14:17.477

没有 IDE 应该可以构建，所以没有 IDE 应该可以进行 SCM。

另一方面，让 IDE 支持 SCM 会很方便。很高兴能够轻松检查文件历史记录并可能恢复它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-15T16:23:50.400

I like internal SCM for.

*   Renaming files, rather than having to do the rename in the IDE **and** the SCM tools
*   Adding files to a project - see above

**I find with an internal SCM it is less common for developers to forget to add new files to the SCM system.**

For any complex operation, e.g. merge, branch, etc I tend to use an external SCM GUI or command line.

# .net - 限制程序集执行的 cpu 周期数

> ID：234411
> 
> 赞同：3
> 
> 时间：2008-10-24T17:06:09.687
> 
> 标签：.net, multithreading, process, measurement, cpu-cycles

我有一个项目可以动态加载实现指定接口的未知程序集。除了实现我的接口之外，我不知道程序集的内容或目的。

我需要以某种方式限制这些组件可用的处理能力。处理器优先级不是我想要的。我不能使用秒表并为程序集分配一定的时间来运行，因为服务器可能会很忙。

理想情况下，我想指定一些完全独立于负载的 CPU 使用量度量。如有必要，我可以在自己的进程中运行程序集。

有没有办法以某种方式测量给定线程（或进程，尽管线程是最佳的）的总超时 CPU 使用率？

我可以使用进程性能计数器，还是我怀疑它们太不可靠了？虽然我不需要循环精度，但我需要相当高的精度来限制分配给每个程序集执行的计算能力。

* * *

根据我的情况推断一下。我不寻找进程优先级的原因是我不害怕耗尽我的资源，我只需要确保我可以测量给定程序集使用的“多少”资源 - 因此我关于服务器的观点是任意的忙碌的。

想象一下您有两个程序集 X 和 Y 的示例场景。它们中的每一个都实现了一个给定的算法，我想对哪个程序集可以最快地完成工作进行原始测试。我运行每个程序集并让它运行，直到它使用“Z”资源，此时我评估哪个程序集做得最好。在这种情况下，我不介意一个程序集以 100% CPU 运行 3 秒，而另一个程序集以 2% CPU 运行 5 分钟 - 总资源使用量很重要。

我想我也许可以使用 CPU time perfcounter 来做一个粗略的限制。在一个新线程中运行每个程序集并让它运行，直到它使用给定的 CPU 时间，此时我将终止该进程并评估结果。我只是怕它不够准确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-25T20:31:39.200

我很好奇为什么你认为你不能（不应该）为此使用优先级。微软的人们花了很长时间开发任务计划程序，它让所有线程/进程在 CPU 上都获得了平等的机会。如果您的机器上运行了更高优先级的进程，并且您不希望您的程序/第 3 方 dll 影响该其他程序，那么只需将您的优先级设置为低于该其他程序，您不会。这就是优先级的目的。即使您的程序以 100% 的速度最大化 CPU，其他程序也会在它想要运行时取代您的进程或线程，即使优先级相同，但尤其是当它具有更高的优先级时。

如果您仍然确定，那么您将不得不使用[PerformanceCounter](http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx)或 Win32 API 来监视您的进程/线程并在超过阈值时使用 Thread.Sleep。这似乎过于混乱。

更好的选择 (IMO) 是使用自定义线程池，它允许您配置最大线程数，为您加载的每个程序集排队一个线程，将它们的优先级设置为低于正常值，并监控以确定产生的最大线程数您想要的性能限制。可以在[这里](http://www.yoda.arachsys.com/csharp/miscutil/)找到一个非常好的自定义线程池。（.NET 线程池不允许您限制事物，这就是您需要使用自定义线程池的原因。）

* * *

如果您在多 CPU 机器上运行，另一种选择是使用亲和力将您的程序限制在某些内核上。例如，在四核机器上，如果您将程序限制为 core3，那么它可能会过度使用并最大限度地使用该 cpu，而系统的其余部分仍将具有 3 个内核以保持高可用性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T16:55:46.250

大多数 X86 操作系统的工作方式是使用抢占式线程调度。操作系统在主板上初始化一个定时器，每隔 100 毫秒就会向处理器发送一个中断。（这是一个执行片。表现良好的计算密集型程序通常应该在此限制之前开始等待将它们放入等待队列的东西。）当处理器收到中断时，它将执行切换到 OS 内核。

因此，从技术上讲，将单核系统上的线程执行限制为比这个计时器更精细的东西在技术上应该是不可能的。

使用“公平”调度，您可以拥有一个旋转管理器（因为您对节能不感兴趣）查看各个线程的执行时间并在它们执行时间过长时终止它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-25T18:25:39.080

我想我记得 Terrarium 做了一些类似于你想要的事情，我建议看看[http://www.codeplex.com/terrarium2](http://www.codeplex.com/terrarium2)。

不幸的是，我认为您没有一种简单的方法可以通过配置加载 DLL 的 AppDomain 来做到这一点。您可能必须重新实现 Terrarium 的功能。

# silverlight - 在 Silverlight 中，如何从动态变化的连接中填充排序的 DataGrid

> ID：234424
> 
> 赞同：1
> 
> 时间：2008-10-24T17:09:44.000
> 
> 标签：silverlight, sorting, datagrid

我有一个数据集，其元素在 DataGrid 中显示为行。行的排序顺序会随着外部事件的变化而变化。

我最初的想法是将行存储为 ObservableCollection 并在更新后重新收集。但是我遇到了两个问题：1) ObservableCollection 没有 Sort() 方法 2) 如果我尝试自己对元素进行排序，每当我尝试将元素分配给新位置时都会出现异常，例如在交换功能，如

```
class MyCollection : ObservableCollection<T>
{
   void swap( int i, int j )
   {
      T tmp = this[i];
      this[i] = this[j]; // THROWS A NOT SUPPORTED EXCEPTION
      this[j] = tmp;
   }
} 
```

所以问题是......如何填充行顺序需要动态更新的DataGrid？

我终于得到了一个有效的答案，我将在下面描述它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T17:22:21.387

我通过显式实现 INotifyCollectionChanged（而不是使用 ObservableCollection）来实现这一点。此外，我发现使用 Update 操作会导致相同的“不支持”错误，但我可以使用 Add 和 Remove 操作。所以我的交换函数最终看起来像这样：

```
class MyCollection<T> : List<T>, INotifyCollectionChanged
{
   public event NotifyCollectionChangedEventHandler CollectionChanged;

   private void swap( int i, int j )
   {
      T a = this[i];
      T b = this[j];

      // swap my own internal data storage
      this[i] = b;
      this[j] = a;

      // and also let my CollectionChanged listener know that I have done so.
      if( CollectionChanged != null )
      {
         NotifyCollectionChangedEventArgs arg;

         arg = new NotifyCollectionChangedEventArgs(
             NotifyCollectionChangedAction.Remove, a, i );
         CollectionChanged( this, arg );

         arg = new NotifyCollectionChangedEventArgs(
             NotifyCollectionChangedAction.Add, b, i );
         CollectionChanged( this, arg );

         arg = new NotifyCollectionChangedEventArgs(
             NotifyCollectionChangedAction.Remove, b, j );
         CollectionChanged( this, arg );

         arg = new NotifyCollectionChangedEventArgs(
             NotifyCollectionChangedAction.Add, a, j );
         CollectionChanged( this, arg );

      }

   }

} 
```

动态变化是相当局部的，所以幸运的是使用较慢的手写排序来响应变化对我来说工作正常。换句话说，当更新到达时，我调用另一个成员函数（在同一个集合中），看起来像这样：

```
public void ProcessUpdates( List<T> updateList )
{
    // use the contents of updateList to modify my internal store
    // ...

    // and now resort myself
    sort();
}

private void sort()
{
    // implement your favorite stable sorting algorithm here, calling 
    // swap() whenever you swap two elements.

    // (this is an intentionally facetious sorting algorithm, because I
    // don't want to get into the long and irrelevant details of my own 
    // data storage.)
    while( i_am_not_sorted() )
    {
       int i = random_index();
       int j = random_index();
       if( out_of_order(i,j) )
       {
          // modify my internal data structure and 
          // also let my CollectionChanged listener know that I have done so
          swap( i, j );
       }
    }
} 
```

不要忘记，在向集合中添加元素时，还需要触发“添加”通知！我对初始列表进行排序，然后按排序顺序添加，这使我在第一次填充数据时可以使用更有效的库排序。

# sharepoint - SharePoint 开发/生产环境

> ID：234432
> 
> 赞同：6
> 
> 时间：2008-10-24T17:12:19.270
> 
> 标签：sharepoint

我在使用 SharePoint 时遇到的最大挑战之一是它不能很好地适应典型的项目环境，该环境至少包含开发和生产环境。我遇到的最多的问题是内容和列表是如此紧密耦合，以至于如果不对生产环境执行内容冻结，就很难执行设计更改。例如，如果我有一个包含计算列的列表并且想要添加一些新功能，我将不得不在生产服务器上进行内容冻结，从生产服务器创建一个列表模板（包括内容），将该列表恢复到开发环境，进行我的更改，然后反转列表模板过程。这同样适用于页面和 SharePoint 中的任何其他内容。

你们中的一些其他 SharePoint 开发人员如何处理此限制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T17:39:01.087

SharePoint“开发”实际上有两个（更多？）级别。您拥有部署到服务器的代码，例如 Web 部件、内容类型、工作流操作等。这在部署和最佳实践方面效果相对较好。

然后你就有了你的例子，这更像是对站点实例的定制。当我们不得不在门户的站点目录列表中自定义计算字段时，我们所做的是尝试调整开发中的更改。然后写下要进行的定制的详细说明，并让具有适当权限的单独人员使用这些说明在集成（登台）服务器上进行更改。然后让同一个人在生产上进行更改。

我不确定您的更改是否容易受到这种方法的影响，但值得考虑。

然后我们有另一个网站，它使用 SharePoint 设计器进行了大量定制，并且我们在该网站上工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T17:44:54.990

您可以使用内容部署向导 ( [http://www.codeplex.com/SPDeploymentWizard](http://www.codeplex.com/SPDeploymentWizard) ) 快速迁移列表和库等内容。您还可以备份/恢复生产副本，然后对其进行更改，然后在清晨进行内容冻结（希望那时没人会关心），将所有更改的数据从生产导入到您的副本中，然后通过生产恢复副本。至少可以推迟冻结，并且只有在导出->导入->恢复过程期间才需要冻结。

在实践中，我只是手动进行生产更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T20:49:24.510

Use FeatureActivation code to deploy changes to the lists' fields. After the code updates the fields then you deactivate the feature and remove it. This allows results to be tested in a QA environment before hand.

# .net - LINQ 中的动态 where 子句 - 列名在运行时可用

> ID：234439
> 
> 赞同：9
> 
> 时间：2008-10-24T17:13:57.753
> 
> 标签：.net, linq-to-sql, dynamic-linq

免责声明：我已经使用 System.Linq.Expressions 中的表达式解决了这个问题，但我仍在寻找更好/更简单的方法。

考虑以下情况：

```
var query = 
    from c in db.Customers
    where (c.ContactFirstName.Contains("BlackListed") || 
           c.ContactLastName.Contains("BlackListed")  ||
           c.Address.Contains("BlackListed"))
    select c; 
```

需要对照列入黑名单的术语检查的列/属性仅在运行时对我可用。如何生成此动态 where 子句？

另一个复杂情况是 Queryable 集合（上面的 db.Customers）被输入到基类“Customer”（比如“Person”）的 Queryable 中，因此不能像上面那样编写 c.Address。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-25T22:30:42.783

@Geoff 有最好的选择，只是动态 LINQ。

如果您想在运行时使用 Lambda 构建查询，但我建议您使用 PredicateBuilder ( [http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx) ) 并具有以下内容：

```
Expression<Fun<T,bool>> pred = null; //delcare the predicate to start with. Note - I don't know your type so I just used T 
if(blacklistFirstName){
  pred = p => p.ContactFirstName.Contains("Blacklisted");
}
if(blacklistLastName){
  if(pred == null){
    pred = p => p.ContactLastName.Contains("Blacklisted"); //if it doesn't exist just assign it
  }else{
    pred = pred.And(p => p.ContactLastName.Contains("Blacklisted"); //otherwise we add it as an And clause
  }
} 
```

对于您要包含的所有列，依此类推。当您进行查询时，您只需要以下内容：

```
var results = db.Customers.Where(pred).Select(c => c); 
```

我用它来构建 LINQ 以搜索大约 20 种不同选项的位置，它会产生非常好的 SQL。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-24T17:35:45.913

```
var query = from C in db.Customers select c;

if (seachFirstName)
         query = query.Where(c=>c.ContactFirstname.Contains("Blacklisted"));

if (seachLastName)
         query = query.Where(c=>c.ContactLastname.Contains("Blacklisted"));

if (seachAddress)
         query = query.Where(c=>c.Address.Contains("Blacklisted")); 
```

请注意，它们不是相互排斥的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-01T12:14:10.180

您可以使用一些逻辑表达式打开和关闭 where 子句。

```
//Turn on all where clauses
bool ignoreFirstName = false;
bool ignoreLastName = false;;
bool ignoreAddress = false;

//Decide which WHERE clauses we are going to turn off because of something.
if(something)
    ignoreFirstName = true; 

//Create the query
var queryCustomers = from c in db.Customers 
    where (ignoreFirstName || (c.ContactFirstName.Contains("BlackListed")))
    where (ignoreLastName || (c.ContactLastName.Contains("BlackListed")))
    where (ignoreAddress || (c.Address.Contains("BlackListed"))
    select j; 
```

如果在查询中 ignoreFirstName 为真，则 or 语句另一侧的条件将被忽略。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-25T22:19:59.357

由于这不是 LINQ to Objects，而是 LINQ to SQL，因此除了使用表达式或存储过程之外，您别无选择。

# visual-studio - 将新项目添加到 TFS 中的现有解决方案

> ID：234443
> 
> 赞同：73
> 
> 时间：2008-10-24T17:15:29.700
> 
> 标签：visual-studio, tfs

我向当前使用 TFS 进行源代码控制的现有解决方案添加了一个项目，但由于某种原因，我无法签入新项目。当我查看待处理的更改时，新项目中的任何文件都不会显示。所有文件旁边都没有加号（对于新文件）。我做错什么了？我如何解决它？是时候办理登机手续了。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2010-02-07T12:57:37.670

问题是解决方案失去了约束力。这就是为什么当您添加新项目时它不会自动签出。

要在 VS 2010 中恢复绑定，请转到 File->Source Control->Change Source Control。查找“解决方案：*您的解决方案名称*”，如果未绑定，则会显示“无服务器”。单击它，然后单击工具栏中的“绑定”。

在 Visual Studio 2012/2013 中，它是 File->Source Control-> *Advanced* ->Change Source Control（感谢 danglund）。

这应该会创建一个正确绑定的新 vssscc 文件。现在添加新项目，一切都应该正常工作。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2011-01-21T08:44:28.140

我也遇到了同样的问题，我是这样解决的：

转到 Visual Studion：File->Source Control->Change Source Control 在那里找到您的项目，它的状态将是“无效”，单击它并按“取消绑定”。现在返回解决方案资源管理器并删除您的项目。再次将此项目添加到解决方案资源管理器中以解决问题。

祝你好运！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-03-21T14:59:50.357

1.  在源代码管理资源管理器中单击团队项目名称
2.  文件 -> 源代码管理 -> 将项目添加到文件夹...
3.  按照向导。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-24T17:26:03.157

转到源代码管理资源管理器并浏览到树中与您的解决方案的新项目所在位置相匹配的位置。在那里添加文件。

但是，我担心您修改了解决方案文件并且它没有要求您检查它。您可能想要尝试做的是手动签出解决方案文件，然后将项目读入解决方案并查看是否需要。

您不需要进入命令行 - 这是一个非常简单的操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-25T23:23:50.530

打开解决方案。选择项目（确保它在解决方案中）。

File -> Source Control -> Properties 会弹出绑定对话框。

将项目绑定到源代码管理。

您现在应该在所有文件旁边看到 + 符号。关键是为您的项目添加了一个 .vssscc 以进行版本控制。

如果失败，请在记事本中打开您的 csproj（进行备份后），并确保删除任何版本控制绑定，然后重试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T17:18:52.267

不幸的是，我敢打赌，您最好的选择是通过命令行手动进行签到。我遇到过 Team Explorer UI 与源代码管理中实际发生的情况不同步的情况，通过 tf.exe 手动修复问题是解决它的唯一方法。

也就是说，*通常*情况下，将新项目添加到解决方案中并不麻烦。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T17:20:41.217

TFS 可以根本不知道你的项目是否存在。只需通过源代码管理资源管理器添加您的项目文件并重新加载解决方案。

在加载解决方案时，它可能会要求您将项目绑定到源代码管理。通过单击绑定按钮让它这样做 - 它应该为您完成所有的魔法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-25T07:46:44.730

*   确保您获得最新版本的解决方案
*   查看解决方案文件
*   添加新项目

如果新添加的项目以前在（另一个）源代码控制下，那可能会搞砸，请确保在添加之前“取消绑定”它。（请参阅 Visual Studio 中“文件”菜单下某处的源代码控制绑定）

你不应该需要命令行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-24T14:44:47.580

我在 VS 2019 中遇到了同样的问题，我在现有解决方案中添加了一个新项目，并且该项目没有出现在待处理的更改中。右键单击项目并转到源代码管理只有一个选项“将解决方案添加到源代码管理”。

使用上面的答案，我开始了 File --> Source Control 路径，然后产生了一个直接“将选定的项目添加到源代码控制”的选项。采用该选项解决了问题，因此现在新项目显示在未决更改中。注意：我添加了这个答案，因为它在 VS 2019 中仍然是一个问题，但现在比过去有一个更简单的解决方案。

# iphone - 如何在单元格中创建带有控件的圆桌？

> ID：234448
> 
> 赞同：1
> 
> 时间：2008-10-24T17:17:09.103
> 
> 标签：iphone, cocoa-touch

我正在探索 iPhone SDK 并希望创建和使用如下图所示的 UI 组件。一个带有单元格的圆桌，其中每个单元格可以有一些标签文本，可能是一个输入文本字段和一个将其带到下一个屏幕的操作按钮。表格不应该是屏幕填充。

但是......我不知道该怎么做或找到示例代码。“表格视图”似乎总是导致屏幕填充表格，虽然“表格视图单元格”看起来像我需要的，但我找不到任何好的例子。我敢肯定这一切都不是那么难，但我就是找不到。任何提示，指针表示赞赏。

（这个图只是我正在寻找的那种 UI 组件的一个例子，我没有构建与航班跟踪相关的东西......）

[表格组件 http://gerodt.homeip.net/table_ui_component.png](http://gerodt.homeip.net/table_ui_component.png)

下吕

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T17:32:57.560

尝试查看 Apple 提供的[TableViewSuite](https://developer.apple.com/iphone/library/samplecode/TableViewSuite/index.html)代码示例的“5_CustomTableViewCell”项目。它应该如何创建 UITableViewCell 的自定义子类。

简短的回答是，正如上面提到的，您需要继承 UITableViewCell 并将您的自定义 UI 元素添加到其中。对于您提供的示例，您需要两种不同类型的单元格；一个带有标签（浅蓝色）和内容（黑色）的 4 个单元格，然后是更复杂的一个，右侧带有附加文本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T17:57:02.703

You want a Grouped style table, which has sections with rounded elements as you lay out instead of filling the screen.

You also want custom table cells, which you can search here to find example code for.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T18:08:47.453

正如其他答案所提到的，您想要的是一个带有自定义 UITableViewCells 的分组 TableView。查看[Table View Programming Guide](https://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/TableView_iPhone/Introduction/chapter_1_section_1.html)，特别是[关于创建表格视图](https://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/TableView_iPhone/CreateConfigureTableView/chapter_5_section_2.html#//apple_ref/doc/uid/TP40007451-CH6-SW11)的这一部分和[关于自定义单元格](https://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/chapter_6_section_4.html#//apple_ref/doc/uid/TP40007451-CH7-SW18)的这一部分。

# c++ - 多态性或条件会促进更好的设计吗？

> ID：234458
> 
> 赞同：39
> 
> 时间：2008-10-24T17:19:46.617
> 
> 标签：c++, oop, tdd, polymorphism

[我最近在谷歌测试博客中](http://googletesting.blogspot.com/2008/08/by-miko-hevery-so-you-decided-to.html)偶然发现了这篇关于编写更多可测试代码的指南。直到这一点，我都同意作者：

> 支持多态而不是条件：如果你看到一个 switch 语句，你应该考虑多态。如果您在课堂上的许多地方看到相同的 if 条件重复，您应该再次考虑多态性。多态性会将你的复杂类分解成几个更小的更简单的类，它们清楚地定义了哪些代码片段是相关的并一起执行。这有助于测试，因为更简单/更小的类更容易测试。

我根本无法解决这个问题。我可以理解使用多态性而不是 RTTI（或 DIY-RTTI，视情况而定），但这似乎是一个如此广泛的陈述，我无法想象它实际上被有效地用于生产代码。在我看来，更容易为具有 switch 语句的方法添加额外的测试用例，而不是将代码分解成几十个单独的类。

此外，我的印象是多态性会导致各种其他微妙的错误和设计问题，所以我很想知道这里的权衡是否值得。有人可以向我解释这个测试指南的确切含义吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-24T17:29:38.347

实际上，这使得测试和代码更容易编写。

如果你有一个基于内部字段的 switch 语句，你可能在多个地方有相同的 switch，做的事情略有不同。当您添加新案例时，这会导致问题，因为您必须更新所有 switch 语句（如果您能找到它们）。

通过使用多态性，您可以使用虚函数来获得相同的功能，并且因为新案例是一个新类，您不必在代码中搜索需要检查的内容，每个类都是隔离的。

```
class Animal
{
    public:
       Noise warningNoise();
       Noise pleasureNoise();
    private:
       AnimalType type;
};

Noise Animal::warningNoise()
{
    switch(type)
    {
        case Cat: return Hiss;
        case Dog: return Bark;
    }
}
Noise Animal::pleasureNoise()
{
    switch(type)
    {
        case Cat: return Purr;
        case Dog: return Bark;
    }
} 
```

在这个简单的例子中，每一个新的动物原因都需要更新两个 switch 语句。
你忘了一个？什么是默认值？砰！！

使用多态性

```
class Animal
{
    public:
       virtual Noise warningNoise() = 0;
       virtual Noise pleasureNoise() = 0;
};

class Cat: public Animal
{
   // Compiler forces you to define both method.
   // Otherwise you can't have a Cat object

   // All code local to the cat belongs to the cat.

}; 
```

通过使用多态性，您可以测试 Animal 类。
然后分别测试每个派生类。

此外，这还允许您将 Animal 类（**已关闭以供更改**）作为二进制库的一部分。但是人们仍然可以通过派生从 Animal 标头派生的新类来添加新的 Animals ( **Open for extension )。**如果所有这些功能都已在 Animal 类中捕获，那么所有动物都需要在运输之前定义（已关闭/已关闭）。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-24T19:48:49.313

## 不要害怕...

我猜你的问题在于熟悉度，而不是技术。熟悉 C++ OOP。

## C++ 是一种面向对象语言

在其众多范式中，它具有 OOP 特性，并且能够支持与大多数纯 OO 语言的比较。

不要让“C++ 中的 C 部分”让您相信 C++ 无法处理其他范例。C++ 可以非常优雅地处理许多编程范式。其中，OOP C++是继过程范式（即前面提到的“C部分”）之后最成熟的C++范式。

## 多态性可以用于生产

没有“微妙的错误”或“不适合生产代码”的东西。有些开发人员保持自己的方式，有些开发人员将学习如何使用工具并为每项任务使用最好的工具。

## 开关和多态性[几乎]相似......

...但是多态性消除了大多数错误。

不同之处在于您必须手动处理开关，而多态性更自然，一旦您习惯了继承方法覆盖。

使用开关，您必须将类型变量与不同类型进行比较，并处理差异。使用多态性，变量本身知道如何表现。您只需要以逻辑方式组织变量，并覆盖正确的方法。

但最后，如果你忘记在 switch 中处理 case，编译器不会告诉你，而如果你从一个类派生而没有覆盖它的纯虚方法，你会被告知。因此，避免了大多数开关错误。

总而言之，这两个功能都是关于做出选择的。但是多态性使您能够做出更复杂的同时更自然的选择，从而更容易做出选择。

## 避免使用 RTTI 来查找对象的类型

RTTI 是一个有趣的概念，并且很有用。但大多数时候（即 95% 的时间），方法覆盖和继承就绰绰有余了，您的大部分代码甚至不应该知道所处理对象的确切类型，而是相信它会做正确的事情。

如果你使用 RTTI 作为一个美化的开关，你就错过了重点。

（免责声明：我是 RTTI 概念和 dynamic_casts 的忠实粉丝。但是必须为手头的任务使用正确的工具，而且大多数时候 RTTI 被用作美化开关，这是错误的）

## 比较动态与静态多态性

如果您的代码在编译时不知道对象的确切类型，则使用动态多态（即经典继承、虚拟方法覆盖等）

如果您的代码在编译时知道类型，那么也许您可以使用静态多态，即 CRTP 模式[http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern](http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern)

CRTP 将使您拥有闻起来像动态多态性的代码，但其每个方法调用都将静态解析，这对于一些非常关键的代码来说是理想的。

## 生产代码示例

与此类似的代码（来自内存）用于生产。

更简单的解决方案围绕消息循环调用的过程（Win32 中的 WinProc，但为了简单起见，我编写了一个更简单的版本）。所以总结一下，它是这样的：

```
void MyProcedure(int p_iCommand, void *p_vParam)
{
   // A LOT OF CODE ???
   // each case has a lot of code, with both similarities
   // and differences, and of course, casting p_vParam
   // into something, depending on hoping no one
   // did a mistake, associating the wrong command with
   // the wrong data type in p_vParam

   switch(p_iCommand)
   {
      case COMMAND_AAA: { /* A LOT OF CODE (see above) */ } break ;
      case COMMAND_BBB: { /* A LOT OF CODE (see above) */ } break ;
      // etc.
      case COMMAND_XXX: { /* A LOT OF CODE (see above) */ } break ;
      case COMMAND_ZZZ: { /* A LOT OF CODE (see above) */ } break ;
      default: { /* call default procedure */} break ;
   }
} 
```

每次添加命令都会添加一个案例。

问题是某些命令相似，并且部分共享了它们的实现。

因此，混合案例是进化的风险。

我通过使用 Command 模式解决了这个问题，也就是说，使用一个 process() 方法创建一个基本的 Command 对象。

所以我重新编写了消息程序，将危险代码（即使用 void * 等）最小化，并编写它以确保我永远不需要再次触摸它：

```
void MyProcedure(int p_iCommand, void *p_vParam)
{
   switch(p_iCommand)
   {
      // Only one case. Isn't it cool?
      case COMMAND:
         {
           Command * c = static_cast<Command *>(p_vParam) ;
           c->process() ;
         }
         break ;
      default: { /* call default procedure */} break ;
   }
} 
```

然后，对于每个可能的命令，我没有在过程中添加代码，而是混合（或更糟糕的是，复制/粘贴）来自类似命令的代码，而是创建了一个新命令，并从 Command 对象或其中之一派生了它其派生对象：

这导致了层次结构（表示为树）：

```
[+] Command
 |
 +--[+] CommandServer
 |   |
 |   +--[+] CommandServerInitialize
 |   |
 |   +--[+] CommandServerInsert
 |   |
 |   +--[+] CommandServerUpdate
 |   |
 |   +--[+] CommandServerDelete
 |
 +--[+] CommandAction
 |   |
 |   +--[+] CommandActionStart
 |   |
 |   +--[+] CommandActionPause
 |   |
 |   +--[+] CommandActionEnd
 |
 +--[+] CommandMessage 
```

现在，我需要做的就是覆盖每个对象的进程。

简单，易于扩展。

例如，假设 CommandAction 应该分三个阶段执行其过程：“之前”、“期间”和“之后”。它的代码类似于：

```
class CommandAction : public Command
{
   // etc.
   virtual void process() // overriding Command::process pure virtual method
   {
      this->processBefore() ;
      this->processWhile() ;
      this->processAfter() ;
   }

   virtual void processBefore() = 0 ; // To be overriden

   virtual void processWhile()
   {
      // Do something common for all CommandAction objects
   }

   virtual void processAfter()  = 0 ; // To be overriden

} ; 
```

例如，CommandActionStart 可以编码为：

```
class CommandActionStart : public CommandAction
{
   // etc.
   virtual void processBefore()
   {
      // Do something common for all CommandActionStart objects
   }

   virtual void processAfter()
   {
      // Do something common for all CommandActionStart objects
   }
} ; 
```

正如我所说：易于理解（如果注释正确），并且非常易于扩展。

该开关被减少到最低限度（即 if-like，因为我们仍然需要将 Windows 命令委托给 Windows 默认过程），并且不需要 RTTI（或者更糟糕的是，内部 RTTI）。

我想，开关中的相同代码会很有趣（如果仅根据我在工作应用程序中看到的“历史”代码的数量来判断的话）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-24T17:33:11.410

对 OO 程序进行单元测试意味着将每个类作为一个单元进行测试。您要学习的一个原则是“对扩展开放，对修改关闭”。我是从 Head First Design Patterns 得到的。但它基本上说您希望能够轻松扩展您的代码，而无需修改现有的测试代码。

多态性通过消除那些条件语句使这成为可能。考虑这个例子：

假设您有一个带有武器的角色对象。你可以这样写一个攻击方法：

```
If (weapon is a rifle) then //Code to attack with rifle else
If (weapon is a plasma gun) //Then code to attack with plasma gun 
```

等等

使用多态性，角色不必“知道”武器的类型，只需

```
weapon.attack() 
```

会工作。如果发明了一种新武器会怎样？如果没有多态性，您将不得不修改您的条件语句。使用多态性，您将不得不添加一个新类并单独保留测试的 Character 类。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-24T17:56:33.330

我有点怀疑：我相信继承通常增加的复杂性比它消除的复杂性要多。

不过，我认为您提出了一个很好的问题，我考虑的一件事是：

*您是否因为处理不同的事情*而分成多个班级？还是真的是同一件事，以不同的*方式行事*？

如果它真的是一个新**类型**，那么继续创建一个新类。但如果它只是一个选项，我通常将它保留在同一个类中。

我相信默认的解决方案是单类解决方案，程序员有责任提出继承来证明他们的情况。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-24T17:33:40.380

不是测试用例含义方面的专家，而是从软件开发的角度来看：

*   **开闭原则**——类应该对更改关闭，但对扩展开放。如果您通过条件构造管理条件操作，那么如果添加了新条件，则您的类需要更改。如果使用多态，则基类无需更改。

*   **不要重复自己**——指南的一个重要部分是“*相同*的if 条件”。这表明您的班级有一些不同的操作模式可以纳入班级。然后，该条件出现在您的代码中的一个位置——当您为该模式实例化对象时。同样，如果出现新的，您只需要更改一段代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-24T17:32:45.983

多态性是 OO 的基石之一，当然非常有用。通过将关注点划分为多个类，您可以创建独立且可测试的单元。因此，与其做一个 switch...case 来调用几种不同类型或实现的方法，不如创建一个具有多个实现的统一接口。当你需要添加一个实现时，你不需要修改客户端，就像 switch...case 一样。非常重要，因为这有助于避免回归。

您还可以通过只处理一种类型来简化您的客户端算法：接口。

对我来说非常重要的是多态性最好与纯接口/实现模式一起使用（如古老的 Shape <- Circle 等...）。您还可以使用模板方法（也称为钩子）在具体类中实现多态性，但随着复杂性的增加，其有效性会降低。

多态是我们公司代码库建立的基础，所以我认为它非常实用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-13T15:17:07.717

开关和多态做同样的事情。

在多态性（以及一般的基于类的编程中）中，您按函数的类型对函数进行分组。使用开关时，您可以按功能对类型进行分组。决定哪种观点对你有好处。

因此，如果您的接口是固定的并且您只添加新类型，那么多态是您的朋友。但是，如果您向界面添加新功能，则需要更新所有实现。

在某些情况下，您可能有固定数量的类型，并且可以出现新功能，那么开关会更好。但是添加新类型会使您更新每个开关。

使用开关，您可以复制子类型列表。使用多态性，您正在复制操作列表。你用一个问题换了一个不同的问题。这就是所谓的[表达式问题](http://c2.com/cgi/wiki?ExpressionProblem)，我知道的任何编程范式都没有解决这个问题。问题的根源在于用于表示代码的文本的一维性质。

由于在这里很好地讨论了支持多态性点，让我提供一个支持切换点。

OOP 具有避免常见陷阱的设计模式。过程式编程也有设计模式（但还没有人写下来，AFAIK，我们需要另一个新的 N 帮来制作一本畅销书……）。一种设计模式可能*总是包含默认情况*。

开关可以正确完成：

```
switch (type)
{
    case T_FOO: doFoo(); break;
    case T_BAR: doBar(); break;
    default:
        fprintf(stderr, "You, who are reading this, add a new case for %d to the FooBar function ASAP!\n", type);
        assert(0);
} 
```

此代码会将您最喜欢的调试器指向您忘记处理案例的位置。编译器可以强制你实现你的接口，但这会*强制*你彻底测试你的代码（至少要看到新的案例被注意到了）。

当然，如果一个特定的开关会在多个地方使用，它会被切割成一个功能（*不要重复自己*）。

如果你想扩展这些开关，只需做一个`grep 'case[ ]*T_BAR' rn .`（在 Linux 上），它会吐出值得一看的位置。由于您需要查看代码，您将看到一些上下文，可以帮助您正确添加新案例。当您使用多态性时，调用站点隐藏在系统中，并且您依赖于文档的正确性（如果它存在的话）。

扩展开关也不会破坏 OCP，因为您不会更改现有案例，只需添加一个新案例。

开关还可以帮助下一个尝试习惯和理解代码的人：

*   可能的情况就在您的眼前。阅读代码时这是一件好事（少跳动）。
*   但是虚方法调用就像普通的方法调用一样。人们永远无法知道呼叫是虚拟的还是正常的（无需查找课程）。那很糟。
*   但是如果调用是虚拟的，可能的情况并不明显（没有找到所有派生类）。这也很糟糕。

当您向第三方提供接口时，他们可以将行为和用户数据添加到系统中，那就是另一回事了。（他们可以设置回调和指向用户数据的指针，你给他们句柄）

进一步的辩论可以在这里找到：[http ://c2.com/cgi/wiki?SwitchStatementsSmell](http://c2.com/cgi/wiki?SwitchStatementsSmell)

*恐怕我的“C-hacker综合症”和反OOP主义最终会在这里烧毁我所有的名声。但是，每当我需要或不得不将某些东西破解或固定到程序 C 系统中时，我发现它很容易，缺乏约束、强制封装和较少的抽象层使我“就去做”。但是在一个 C++/C#/Java 系统中，在软件的生命周期中，数十个抽象层堆叠在一起，我需要花费数小时甚至数天时间来找出如何正确解决其他程序员的所有约束和限制内置到他们的系统中，以避免其他人“扰乱他们的班级”。*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T17:39:45.267

这主要与知识的封装有关。让我们从一个非常明显的例子开始——toString()。这是 Java，但很容易转移到 C++。假设您要打印对象的人性化版本以进行调试。你可以这样做：

```
switch(obj.type): {
case 1: cout << "Type 1" << obj.foo <<...; break;   
case 2: cout << "Type 2" << ... 
```

然而，这显然是愚蠢的。为什么某处的一种方法知道如何打印所有内容。对象本身知道如何打印自己通常会更好，例如：

```
cout << object.toString(); 
```

这样 toString() 可以访问成员字段而无需强制转换。它们可以独立测试。它们可以很容易地改变。

但是，您可能会争辩说，对象的打印方式不应与对象相关联，而应与 print 方法相关联。在这种情况下，另一种设计模式会派上用场，即访问者模式，用于伪造 Double Dispatch。对于这个答案来说，完整地描述它太长了，但你可以[在这里阅读一个很好的描述](http://en.wikipedia.org/wiki/Visitor_pattern)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-24T18:23:27.333

**如果您理解它，它会**很好地工作。

还有2种多态性。第一个在java-esque中很容易理解：

```
interface A{

   int foo();

}

final class B implements A{

   int foo(){ print("B"); }

}

final class C implements A{

   int foo(){ print("C"); }

} 
```

B 和 C 共享一个公共接口。在这种情况下，B 和 C 无法扩展，因此您始终可以确定您调用的是哪个 foo()。C++ 也是如此，只需将 A::foo 设为纯虚拟即可。

其次，更棘手的是运行时多态性。在伪代码中看起来还不错。

```
class A{

   int foo(){print("A");}

}

class B extends A{

   int foo(){print("B");}

}

class C extends B{

  int foo(){print("C");}

}

...

class Z extends Y{

   int foo(){print("Z");

}

main(){

   F* f = new Z();
   A* a = f;
   a->foo();
   f->foo();

} 
```

但这要棘手得多。特别是如果您在 C++ 中工作，其中一些 foo 声明可能是虚拟的，而一些继承可能是虚拟的。还有这个问题的答案：

```
A* a  = new Z;
A  a2 = *a;
a->foo();
a2.foo(); 
```

可能不是你所期望的。

只要保持敏锐地意识到你在做什么，不知道你是否使用了运行时多态性。不要过分自信，如果你不确定运行时会做什么，那就测试一下。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-13T19:26:21.193

如果您在任何地方都使用 switch 语句，那么您可能会在升级时错过一个需要更新的地方。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-19T16:42:44.853

我必须重申，在成熟的代码库中查找所有 switch 语句可能是一个不平凡的过程。如果你错过了任何一个，那么应用程序可能会因为不匹配的 case 语句而崩溃，除非你有默认设置。

另请查看有关“重构”的“Martin Fowlers”一书
使用开关而不是多态性是代码异味。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-10-24T17:39:50.353

这真的取决于你的编程风格。虽然这在 Java 或 C# 中可能是正确的，但我不同意自动决定使用多态是正确的。例如，您可以将代码拆分为许多小函数并使用函数指针（在编译时初始化）执行数组查找。在 C++ 中，多态性和类经常被过度使用——从强大的 OOP 语言进入 C++ 的人们所犯的最大设计错误可能是一切都进入了一个类——这不是真的。一个类应该只包含使它作为一个整体工作的最少的东西。如果一个子类或朋友是必要的，那就这样吧，但它们不应该成为常态。对类的任何其他操作都应该是同一命名空间中的自由函数；ADL 将允许使用这些函数而无需查找。

C++ 不是一种 OOP 语言，不要让它成为一种语言。这就像在 C++ 中编程 C 一样糟糕。

# visual-studio - Visual Studio (2008) 混合模式项目依赖项。C-sharp 项目依赖于 C++ dll，但没有重新构建 C++ dll

> ID：234477
> 
> 赞同：2
> 
> 时间：2008-10-24T17:26:33.093
> 
> 标签：visual-studio, build-process, dependencies

我有一个包含两个项目的 Visual Studio 2008 解决方案。一个 C++ DLL 和一个 Csharp 应用程序。

Csharp 应用程序使用 [DllImport] 访问 DLL 中的函数，并在 DLL 上设置了依赖项。

出于某种原因，设置依赖项不足以导致 VS 将 DLL 复制到应用程序的构建路径。因此，应用程序项目有一个构建后事件，该事件会导致 DLL 被复制。（如果有人知道更清洁的方法，请告诉我！）

我遇到的问题是，当我对 DLL 代码进行更改，然后尝试在调试器中运行 Csharp 应用程序时，VS2008 无法意识到必须重新构建（并重新复制）DLL。

我必须强制重新构建 Csharp 应用程序（即通过明确选择构建，或通过“触摸”.CS 文件）。

有谁知道如何告诉 Visual Studio 做正确的事？

编辑：我*正在*使用项目依赖项。他们工作不正常。

我*正在*使用构建后事件来复制 DLL。

问题在于，如果您只是选择调试应用程序，Visual Studio将*无法*重新编译更改后的 C++ 项目，*尽管事实上存在依赖项*。

我知道依赖项正在工作，因为如果我选择“构建”（而不是“调试”），就会构建 C++ DLL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T14:09:48.790

“构建”和“调试”做不同的事情。在工具 - 选项 - 项目和解决方案 - 构建和运行中，有一个复选框“仅在运行时构建启动项目和依赖项”。这是默认选中的。因此，如果 VS 没有将 DLL 识别为依赖项，则在您选择“调试”时它不会构建它。

我手头没有 VS（只有 Express），但您可以尝试将 C++ DLL 添加为引用而不是依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T12:38:41.297

我没试过，但你不能用构建顺序来做吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T17:37:28.033

嗯......所以我以前没有做过这个确切的事情，但我只是在同一个解决方案中将一个 C++ lib 项目和一个 C# winform 项目放在一起。我右键单击该解决方案，选择“属性”，然后在“通用属性”->“项目依赖项”下，使 C# 依赖于 C++。

当我为 C++ 制作一个 mod 时，它会问我是否要重建 C++ 的。还有一个“不要问我”复选框。

也许我的测试与您的情况不同，但是当我这样做时它似乎起作用了。

希望这是一些帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T17:41:43.047

假设 DLL 项目没有在另一个解决方案中使用，为什么不将构建后事件放在~~DLL~~应用程序项目上，所以它总是被复制？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T17:32:04.933

对于具有 DLL 项目依赖项的应用程序，我也遇到过同样的问题。在我看来，问题在于 Visual Studio 仅在必须重新编译应用程序项目中的某些内容时才启动构建后事件。因此，如果您修改 DLL 源而不修改应用程序包含的任何头文件，则不会重新编译应用程序，因为从它的角度来看，DLL 是相同的。由于未重新编译应用程序，因此不会触发构建后事件。因此，应用程序留下了过时的 DLL。我还没有想出一个很好的解决这个问题的方法。

# emacs - 确定 Emacs 中的行终止符

> ID：234479
> 
> 赞同：4
> 
> 时间：2008-10-24T17:26:48.973
> 
> 标签：emacs, elisp, text-files, eol

我正在编写一个配置文件，我需要定义该过程是否需要 Windows 格式文件或 unix 格式文件。我有一份预期文件的副本 - 有没有办法在不退出 emacs 的情况下检查它是使用 \n 还是 \r\n ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T17:40:40.117

如果在 Unix 上打开文件时模式行上显示 (DOS)，则行尾是 Windows 样式的。如果在 Windows 上打开文件时显示 (Unix)，则行尾是 Unix 风格的。

来自 Emacs 22.2 手册（节点：模式行）：

> 如果缓冲区的文件使用回车换行，则冒号将更改为反斜杠 ('\') 或 '(DOS)'，具体取决于操作系统。如果文件只使用回车，冒号指示符将变为正斜杠 ('/') 或 '(Mac)'。在某些系统上，对于使用换行符作为行分隔符的文件，Emacs 会显示 '(Unix)' 而不是冒号。

这里有一个函数——我认为——展示了如何从 elisp 中检查 Emacs 确定的行尾类型。如果它看起来异常复杂，也许它是。

```
(defun describe-eol ()
  (interactive)
  (let ((eol-type (coding-system-eol-type buffer-file-coding-system)))
    (when (vectorp eol-type)
      (setq eol-type (coding-system-eol-type (aref eol-type 0))))
    (message "Line endings are of type: %s"
             (case eol-type
               (0 "Unix") (1 "DOS") (2 "Mac") (t "Unknown"))))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T19:39:23.513

如果您进入 hexl-mode (Mx hexl-mode)，您应该会看到行终止字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T17:30:50.793

使用 find-file-literally 在 emacs 中打开文件。如果行末尾有 ^M 符号，则它需要一个 windows 格式的文本文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T18:11:14.377

`nil`如果文件中没有出现终止符，则以下 Elisp 函数将返回`"\r\n"`（否则它返回第一次出现的点）。你可以把它放在你的`.emacs`并用`M-x check-eol`.

```
(defun check-eol (FILE)
  (interactive "fFile: ")
  (set-buffer (generate-new-buffer "*check-eol*"))
  (insert-file-contents-literally FILE)
  (let ((point (search-forward "\r\n")))
    (kill-buffer nil)
    point)) 
```

# javascript - 需要 firefox/IE designMode 参考

> ID：234481
> 
> 赞同：2
> 
> 时间：2008-10-24T17:27:45.290
> 
> 标签：javascript, internet-explorer, firefox, designmode

我正在寻找 Firefox 2/3 和 IE 6/7/8 中 designMode 的参考文档。有没有人有好的参考链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T17:38:03.180

> [将使用 document.designMode 的应用程序从 IE 转换为 Mozilla。](http://www.mozilla.org/editor/ie2midas.html)
> 
> [http://starkravingfinkle.org/blog/2007/07/firefox-3-contenteditable/](http://starkravingfinkle.org/blog/2007/07/firefox-3-contenteditable/)
> 
> [http://starkravingfinkle.org/blog/2007/02/xul-clippings-midas-rich-text-editor/](http://starkravingfinkle.org/blog/2007/02/xul-clippings-midas-rich-text-editor/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T17:35:22.093

试试[Mozilla 的开发者参考](https://developer.mozilla.org/En/Rich-Text_Editing_in_Mozilla)。（也表示 IE 不一致和省略命令。）

# c++ - 使用 STL 查找向量中的所有元素

> ID：234482
> 
> 赞同：14
> 
> 时间：2008-10-24T17:27:48.053
> 
> 标签：c++, stl

我有一个需要操作的元素集合，在集合上调用成员函数：

```
std::vector<MyType> v;
... // vector is populated 
```

对于不带参数的调用函数，它非常简单：

```
std::for_each(v.begin(), v.end(), std::mem_fun(&MyType::myfunc)); 
```

如果我希望调用的函数有一个参数，则可以做类似的事情。

我的问题是，如果满足某些条件，我想在向量中的元素上调用一个函数。 `std::find_if`返回满足谓词条件的第一个元素的迭代器。

```
std::vector<MyType>::iterator it  = 
      std::find_if(v.begin(), v.end(), MyPred()); 
```

我希望找到满足谓词的**所有**元素并对其进行操作。

我一直在寻找“ `find_all`”或“ `do_if`”等价物的 STL 算法，或者我可以用现有的 STL 做到这一点的方法（这样我只需要迭代一次），而不是自己滚动或简单地做一个标准使用 for 循环和比较进行迭代。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-24T17:47:54.893

Boost Lambda 让这一切变得简单。

```
#include <boost/lambda/lambda.hpp>
#include <boost/lambda/bind.hpp>
#include <boost/lambda/if.hpp>

std::for_each( v.begin(), v.end(), 
               if_( MyPred() )[ std::mem_fun(&MyType::myfunc) ] 
             ); 
```

如果很简单，您甚至可以取消定义 MyPred()。这就是 lambda 真正闪耀的地方。例如，如果 MyPred 的意思是“可被 2 整除”：

```
std::for_each( v.begin(), v.end(), 
               if_( _1 % 2 == 0 )[ std::mem_fun( &MyType::myfunc ) ]
             ); 
```

* * *

**更新：** 使用 C++0x lambda 语法执行此操作也非常好（继续将谓词作为模 2）：

```
std::for_each( v.begin(), v.end(),
               [](MyType& mt ) mutable
               {
                 if( mt % 2 == 0)
                 { 
                   mt.myfunc(); 
                 }
               } ); 
```

乍一看，这看起来像是从 boost::lambda 语法倒退了一步，然而，它更好，因为用 c++0x 语法实现更复杂的函子逻辑很简单……在 boost::lambda 中任何非常复杂的事情都会变得棘手迅速地。Microsoft Visual Studio 2010 beta 2 当前实现了此功能。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-24T17:40:39.197

我写了 a`for_each_if()`和 a `for_each_equal()`，我认为你正在寻找它。

`for_each_if()`采用谓词函子来评估相等性，并`for_each_equal()`采用任何类型的值并使用`operator ==`. 在这两种情况下，您传入的函数都会在每个通过相等测试的元素上调用。

```
/* ---

    For each
    25.1.1

        template< class InputIterator, class Function, class T>
            Function for_each_equal(InputIterator first, InputIterator last, const T& value, Function f)

        template< class InputIterator, class Function, class Predicate >
            Function for_each_if(InputIterator first, InputIterator last, Predicate pred, Function f)

    Requires:   

        T is of type EqualityComparable (20.1.1) 

    Effects:    

         Applies f to each dereferenced iterator i in the range [first, last) where one of the following conditions hold:

            1:  *i == value
            2:  pred(*i) != false

    Returns:    

        f

    Complexity: 

        At most last - first applications of f

    --- */

    template< class InputIterator, class Function, class Predicate >
    Function for_each_if(InputIterator first, 
                         InputIterator last, 
                         Predicate pred, 
                         Function f)
    {
        for( ; first != last; ++first)
        {
            if( pred(*first) )
                f(*first);
        }
        return f;
    };

    template< class InputIterator, class Function, class T>
    Function for_each_equal(InputIterator first, 
                            InputIterator last, 
                            const T& value, 
                            Function f)
    {
        for( ; first != last; ++first)
        {
            if( *first == value )
                f(*first);
        }
        return f;
    }; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-24T17:35:54.527

可以改变向量吗？您可能想查看分区算法。
[分区算法](http://www.cplusplus.com/reference/algorithm/partition.html)

另一种选择是将您更改`MyType::myfunc`为检查元素，或者将谓词作为参数并使用它来测试它正在操作的元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T22:36:54.810

```
std::vector<int> v, matches;
std::vector<int>::iterator i = v.begin();
MyPred my_pred;
while(true) {
    i = std::find_if(i, v.end(), my_pred);
    if (i == v.end())
        break;
    matches.push_back(*i);
} 
```

作为记录，虽然我看到了调用`end()`a`list`是 O(n) 的实现，但我还没有看到任何 STL 实现调用`end()`a`vector`不是 O(1) —— 主要是因为`vector`s 保证具有随机-访问迭代器。

即便如此，如果您担心效率低下`end()`，您可以使用以下代码：

```
std::vector<int> v, matches;
std::vector<int>::iterator i = v.begin(), end = v.end();
MyPred my_pred;
while(true) {
    i = std::find_if(i, v.end(), my_pred);
    if (i == end)
        break;
    matches.push_back(*i);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T17:42:32.033

对于它的价值[for_each_if](http://www.crystalclearsoftware.com/cgi-bin/boost_wiki/wiki.pl?STLAlgorithmExtensions/ForEachIf)被认为是对 boost 的最终补充。实现自己的并不难。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T17:52:43.447

拉姆达功能 - 想法是做这样的事情

```
for_each(v.begin(), v.end(), [](MyType& x){ if (Check(x) DoSuff(x); }) 
```

原帖[在这里](http://softwareramblings.com/2008/04/c-lambda-functions.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T19:50:48.060

您可以使用[Boost.Foreach](http://www.boost.org/doc/libs/1_36_0/doc/html/foreach.html)：

```
BOOST_FOREACH (vector<...>& x, v)
{
    if (Check(x)
        DoStuff(x);
} 
```

# iis - 如何使用 ssl 证书设置 iis？

> ID：234493
> 
> 赞同：1
> 
> 时间：2008-10-24T17:29:57.313
> 
> 标签：iis, iis-7, iis-6

有没有办法以编程方式为 iis 6 和 7 安装 ssl 证书？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T17:34:10.270

是的，试试 IIS 6.0 资源工具包工具： [http ://www.microsoft.com/downloads/details.aspx?FamilyID=56fc92ee-a71a-4c73-b628-ade629c89499&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=56fc92ee-a71a-4c73-b628-ade629c89499&displaylang=en)

它包括一个名为：IISCertDeploy.vbs 的工具。这是一个用于在运行 IIS 6.0 的服务器上部署和备份 SSL 证书的工具。您可以使用 IISCertDeploy.vbs 将证书部署到本地服务器、服务器集群或远程服务器。您还可以使用 IISCertDeploy.vbs 通过将证书从网站导出到包含私钥和公钥的个人信息交换 (.pfx) 文件来备份证书。

# c++ - 你用什么来单元测试你的 C++ 代码？

> ID：234503
> 
> 赞同：3
> 
> 时间：2008-10-24T17:32:08.963
> 
> 标签：c++, unit-testing

我正在研究单元测试 C++ 类的一些可能选项。

所以，简而言之，你在用什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T17:33:48.413

我正在使用[cppunit](http://sourceforge.net/projects/cppunit)。它是标志性的 JUnit 到 c++ 的一个很好的移植。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T17:34:24.967

[单元测试++](http://unittest-cpp.sourceforge.net/)。过去我使用过 Boost Test，它也很不错，但是我遇到了一个问题，即 boost 测试需要一个 operator<< 定义并且它不接受我的重载 operator<<。UnitTest++ 丝毫没有退缩。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T17:35:52.327

我正在使用[谷歌测试](http://code.google.com/p/googletest/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-24T17:39:49.433

[CxxTest](http://cxxtest.tigris.org/)，它运行一个 Perl 脚本作为预处理器来检测所有名为`test*`. 使用起来非常容易，因为 Perl 会为您完成所有套件/案例的注册。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-24T22:49:27.590

[升压测试](http://www.boost.org/doc/libs/1_36_0/libs/test/doc/html/index.html)。无论如何我都使用 boost，还不如使用它的测试库而不是另一个不同的库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T21:00:08.123

链接 lib/DLL 并使用断言语句的简单控制台应用程序。

它符合我的主要要求：易于设置，并且当发生错误时，您可以立即进入调试器。

要重复运行单个测试，对例程的调用将（临时）复制到顶部。

但是，它有一些缺点：首先，您没有测试运行的自动视觉验证，但可以使用 print 语句修复。您不会得到失败的测试列表。除此之外，与任何支持反射的环境相比，单元测试框架的附加值对我来说似乎有点低。这些总比没有单元测试好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T22:13:34.373

看看[CUnitWin32](http://code.google.com/p/cunitwin32/)。它包括一个例子。

# variables - 到 foo bar，还是不到 foo bar：这是个问题

> ID：234507
> 
> 赞同：28
> 
> 时间：2008-10-24T17:32:53.080
> 
> 标签：variables, coding-style, naming-conventions, metasyntactic-variable

[这是Big Nerd Ranch](http://www.bignerdranch.com/)的 Charles Brian Quinn在[acts_as_conference](http://www.actsasconference.com)的演讲中最初讨论的内容。他正在讨论他从向许多编程新手和 Rails 新手指导 Ruby on Rails 训练营中学到的东西。

一张特别突出的幻灯片是**在尝试教某人编程时从不使用 foo 和 bar 作为示例**。他的理由很简单。

哪个更容易理解？

```
baz = foo + bar 
```

或者

```
answer = first_number + second_number 
```

我自己在解释某事时发生了很多次，我立即跳到 go to foo bar 占位符，但随后意识到我的错误，并通过使用真实世界的场景使示例更有意义。

这在尝试教没有编程经验的人时尤其适用，并且您最终需要在解释您实际尝试教的内容之前解释 foo 和 bar。

然而，对于有经验的程序员来说，使用 foo 和 bar 似乎没问题，尽管我个人认为，与 Charles 一样，这是需要改变的东西。

快速搜索“foo”会返回超过 20 页的结果，其中 foo 以我可以理解的更多方式使用。在某些情况下，我正在阅读有关特定语言的问题，我这样做是为了帮助更好地理解该语言。如果使用适用的变量名而不是 foo 和 bar，则更容易理解和解释问题。所以对于经验丰富的开发人员来说，这个结构似乎也有点缺陷。

这是一个永远可以被踢掉的习惯吗？你为什么选择 foo bar 或不 foo bar？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-24T17:38:11.307

这完全取决于你想教什么。有时，在展示一个编程示例时，您必须声明一些东西只是为了让代码片段“完整”，而这些东西并不是您展示的核心。

例如，如果您想展示如何抛出异常，我相信可以呈现如下片段

```
public void foo() { 

   // Do some things

   if (errorCondition) {
      throw new Exception("Error message");
   }

} 
```

由于其中的要点是显示异常，因此关心方法名称没有意义，因此 foo 在这种情况下是“合法的”，或者至少对我而言。

我不接受的（在同一个例子中）是

```
public void foo() { 

   // Do some things

   if (bar) {
      throw new Exception(baz);
   }

} 
```

因为它掩盖了您要教的内容。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-24T17:36:24.150

与非程序员交谈时，我明白这一点，但是当您在白板上与一些团队成员讨论问题时.. 我会想念我的 foos 和我的酒吧。我认为 foo/bar 的流行是大多数程序员抽象思考能力的一个例子。

如果您在训练场上，可能会成为更大的问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-24T17:37:33.290

我有时会使用它们。但只有在“真实”名称不相关的情况下。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-24T17:43:36.773

我在演示 'foo' 和 'bar' 的任何值都足够时使用它们，例如“您可以使用 sizeof(foo) 获取对象的大小”。它有助于让人们理解一般概念，而不仅仅是细节。例如，如果我说“您可以使用 sizeof(int) 之类的东西获得对象的大小”，那么几乎可以肯定有人会问这是否也适用于浮点数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T21:52:37.403

For totaly new programmer I have to say that terms foo and bar might not be known. I thought that they were something language specific (namely C), but after cheking Wikipedia I now know they are just abstract place holders. So if your audience consist of people who don't know meanings of them, something else is much clearer. Also first_number and so tells that those are numbers how ever they are presented and not something else.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T17:38:57.140

每当我的听众对手头的概念足够熟悉以致不利于他们的理解时，我都会选择不使用 foo 和 bar。

唯一应该使用 Foo 和 Bar 的情况是当您谈论的内容如此抽象以至于添加上下文需要额外讨论时。然后 Foo 和 Bar 比 x、y 和 z 等替代方案更具可读性和创建的代码更易于遵循。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T21:34:57.707

我认为这是由于许多程序员的温和或不那么温和的讽刺性质。虽然许多人试图在 foo/bar 上赋予不同的含义，但我们中的大多数人，或者至少是很多人，都会想到“FUBAR”，F**K Up Beyond All Recognition。这是“有经验”的人对其他人发表讽刺评论的一种方式。

因此，我从不将它用于非程序员，即使有经验的程序员也很少使用它。如果我确实使用你可以打赌我正在对手头的主题进行含蓄的引用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-06T21:46:43.267

除了避免像 foo & bar 这样无意义的词之外，我发现为具有相同关系的真实场景提供代码示例更为重要。这确实有助于学习者正确理解一个主题并防止误解。例如，如果我正在教授依赖注入并展示示例代码，其中 Car 类的实例被注入到 Driver 类中，那么没有人会感到困惑并认为“那么这意味着 Car 控制 Driver 吗？”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-17T10:49:09.143

I think there is another important reason for using `foo` and `bar` in examples. These names make it clear that you are not invoking any magic keywords. Whenever I am reading some documentation or code examples, I like the arbitrary parts of the example to be clearly distinguished from the necessary parts.

If you substituted the nonsense word for what it generically represents in the example code, you might end up with some names that look a lot like the keywords, classes, or methods you're trying to explain. The "my" prefix, as in `myNumber`, `myFunction`, is a good compromise that makes names stand out as being arbitrary.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-06T21:25:37.350

我是编程新手，或多或少是自学的。我在网上阅读了很多示例代码，一开始发现自己替换了 foo 和 bar &c。具有更相关的名称，例如上面的 firstnumber 和 secondnumber 示例。

我现在更喜欢 x,y,z,i... 因为 foo 和 bar 似乎在我的脑海中激发了语言冲动，可以分散我的注意力，而且我已经在某种程度上发展了持有一大堆不同的能力我脑海中的变量并记住它们是什么。但是我仍然肯定会建议在教别人时使用相关的命名，尤其是在向不会编程但需要了解程序如何工作的人解释代码时。

# python - 在python中拆分字符串

> ID：234512
> 
> 赞同：7
> 
> 时间：2008-10-24T17:33:41.940
> 
> 标签：python, string, split, parsing, tokenize

我有一个这样的字符串：

这是[括号测试]“和引号测试”

我正在尝试在 Python 中编写一些东西来按空格分割它，同时忽略方括号和引号中的空格。我正在寻找的结果是：

['this','is','括号测试','和引号测试']

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-24T17:57:26.260

Here's a simplistic solution that works with your test input:

```
import re
re.findall('\[[^\]]*\]|\"[^\"]*\"|\S+',s) 
```

This will return any code that matches either

*   a open bracket followed by zero or more non-close-bracket characters followed by a close bracket,
*   a double-quote followed by zero or more non-quote characters followed by a quote,
*   any group of non-whitespace characters

This works with your example, but might fail for many real-world strings you may encounter. For example, you didn't say what you expect with unbalanced brackets or quotes,or how you want single quotes or escape characters to work. For simple cases, though, the above might be good enough.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T22:07:04.277

要完成 Bryan 的帖子并准确匹配答案：

```
>>> import re
>>> txt = 'this is [bracket test] "and quotes test "'
>>> [x[1:-1] if x[0] in '["' else x for x in re.findall('\[[^\]]*\]|\"[^\"]*\"|\S+', txt)]
['this', 'is', 'bracket test', 'and quotes test '] 
```

不要误解使用的整个语法：这不是一行中的多个语句，而是单个功能语句（更防错）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T18:04:26.403

这是一个简单的解析器（针对您的示例输入进行了测试），它引入了 State 设计模式。

在现实世界中，您可能想使用[PLY 之](http://www.dabeaz.com/ply/)类的东西构建一个真正的解析器。

```
class SimpleParser(object):

    def __init__(self):
        self.mode = None
        self.result = None

    def parse(self, text):
        self.initial_mode()
        self.result = []
        for word in text.split(' '):
            self.mode.handle_word(word)
        return self.result

    def initial_mode(self):
        self.mode = InitialMode(self)

    def bracket_mode(self):
        self.mode = BracketMode(self)

    def quote_mode(self):
        self.mode = QuoteMode(self)

class InitialMode(object):

    def __init__(self, parser):
        self.parser = parser

    def handle_word(self, word):
        if word.startswith('['):
            self.parser.bracket_mode()
            self.parser.mode.handle_word(word[1:])
        elif word.startswith('"'):
            self.parser.quote_mode()
            self.parser.mode.handle_word(word[1:])
        else:
            self.parser.result.append(word)

class BlockMode(object):

    end_marker = None

    def __init__(self, parser):
        self.parser = parser
        self.result = []

    def handle_word(self, word):
        if word.endswith(self.end_marker):
            self.result.append(word[:-1])
            self.parser.result.append(' '.join(self.result))
            self.parser.initial_mode()
        else:
            self.result.append(word)

class BracketMode(BlockMode):
    end_marker = ']'

class QuoteMode(BlockMode):
    end_marker = '"' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-26T19:17:49.740

好吧，我已经多次遇到这个问题，这导致我编写了自己的系统来解析任何类型的语法。

结果可以在[这里](http://gist.github.com/19929)找到；请注意，这可能是多余的，它会为您提供一些东西，让您可以根据需要解析带有括号和括号、单引号和双引号的语句。例如，您可以解析这样的内容（用 Common Lisp 编写的示例）：

```
(defun hello_world (&optional (text "Hello, World!"))
    (format t text)) 
```

您可以使用嵌套、方括号（方）和圆括号（圆）、单引号和双引号字符串，而且它的可扩展性非常好。

这个想法基本上是有限状态机的可配置实现，它逐个字符地构建抽象语法树。我建议您查看源代码（请参阅上面的链接），以便您了解如何操作。它可以通过正则表达式实现，但是尝试使用 RE 编写一个系统，然后尝试扩展它（甚至理解它）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T19:28:32.707

这是一个更程序化的方法：

```
#!/usr/bin/env python

a = 'this is [bracket test] "and quotes test "'

words = a.split()
wordlist = []

while True:
    try:
        word = words.pop(0)
    except IndexError:
        break
    if word[0] in '"[':
        buildlist = [word[1:]]
        while True:
            try:
                word = words.pop(0)
            except IndexError:
                break
            if word[-1] in '"]':
                buildlist.append(word[:-1])
                break
            buildlist.append(word)
        wordlist.append(' '.join(buildlist))
    else:
        wordlist.append(word)

print wordlist 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-24T18:56:54.300

仅适用于报价。

```
rrr = []
qqq = s.split('\"')
[ rrr.extend( qqq[x].split(), [ qqq[x] ] )[ x%2]) for x in range( len( qqq ) )]
print rrr 
```

# c# - 如何修复 Soap 中的绑定失败？

> ID：234515
> 
> 赞同：7
> 
> 时间：2008-10-24T17:33:56.730
> 
> 标签：c#, .net, soap

我重新加载了一个旧项目，并试图运行它只是遇到绑定失败 MDA 助手：

```
检测到绑定失败

消息：显示名称为“SoapTest.XmlSerializers”的程序集未能加载到
ID 为 1 的 AppDomain 的“LoadFrom”绑定上下文。失败的原因是：
System.IO.FileNotFoundException：无法加载文件或程序集
'SoapTest.XmlSerializers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 或一
其依赖项。该系统找不到指定的文件。

```

谷歌搜索后，我能找到的唯一解决方案是关闭 MDA。这可行，但我更愿意解决根本问题（SoapTest.XmlSerializers.dll 不在 bin\Debug 目录中）。我怎样才能解决这个问题？是什么创建了 SoapTest.XmlSerializers.dll，为什么不在 Rebuild 中创建它？是的，我已尝试更新 Web 参考（这无济于事）。不，我不想升级到 WCF 肥皂服务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-27T11:49:15.250

实际上是的，我去了倾向窗口并将“生成序列化程序集”的选项设置为“开启”，这样你就可以确保每次构建项目时，我猜当你编辑类库的程序集信息时会发生错误您正在引用而不重新构建它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-25T17:38:13.077

在 VS.NET 中，您可以转到项目设置并尝试不同的 XmlSerialization 设置 - 我相信您可能想要禁用自动设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-25T22:57:22.477

我也遇到了这个问题。问题是导致异常的项目是在 .exe 文件之外的另一个文件夹中创建的。我通过从属性/构建设置页面更改部署路径轻松解决了这个问题。不需要对“生成序列化程序集”进行其他更改。

# .net - 我可以在 .NET 中设置 IIS MIME 类型吗？

> ID：234526
> 
> 赞同：5
> 
> 时间：2008-10-24T17:35:57.350
> 
> 标签：.net, asp.net, silverlight, iis-6

我可以通过 ASP.NET 或一些 .NET 代码设置自定义 MIME 类型吗？我需要在 IIS 6 中注册 Silverlight XAML 和 XAP MIME 类型。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T17:51:41.467

要添加到主 MIME 类型列表：

```
using (DirectoryEntry mimeMap = new DirectoryEntry("IIS://Localhost/MimeMap"))
{
    PropertyValueCollection propValues = mimeMap.Properties["MimeMap"];

    IISOle.MimeMapClass newMimeType = new IISOle.MimeMapClass();
    newMimeType.Extension = extension; // string - .xap
    newMimeType.MimeType = mimeType;   // string - application/x-silverlight-app

    propValues.Add(newMimeType);
    mimeMap.CommitChanges();
} 
```

添加对 的引用：

.NET 添加引用选项卡上的“System.DirectoryServices”
COM 添加引用选项卡上的“Active DS IIS 命名空间提供程序”。

要为特定站点配置 MIME 类型，请更改 ..

`'IIS://Localhost/MimeMap'`

到

`'IIS://Localhost/W3SVC/[iisnumber]/root'`

...替换`'[iisnumber]'`为网站的 IISNumber。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-19T23:14:32.657

COM 添加引用选项卡上的“Active DS IIS 命名空间提供程序”。

如果它不存在，您必须在您的机器上安装 IIS。

请参阅[有没有办法获取所有 MIME 类型，而不是编写一个巨大的 case 语句？](https://stackoverflow.com/questions/1191811/is-there-a-way-to-get-all-the-mime-types-instead-of-wrinting-a-huge-case-statemen/1767242#1767242)

# sql - SQL - 使用 GROUP BY 时用逗号分隔多个值

> ID：234532
> 
> 赞同：13
> 
> 时间：2008-10-24T17:37:14.570
> 
> 标签：sql, oracle, oracle10g

我有看起来像的数据

> ```
> CUSTOMER,  CUSTOMER_ID, PRODUCT
> ABC INC    1            XYX
> ABC INC    1            ZZZ
> DEF CO     2            XYX
> DEF CO     2            ZZZ
> DEF CO     2            WWW
> GHI LLC    3            ZYX 
> ```

我想编写一个查询，使数据看起来像这样：

> ```
> CUSTOMER, CUSTOMER_ID, PRODUCTS
> ABC INC   1            XYX, ZZZ
> DEF CO    2            XYX, ZZZ, WWW
> GHI LLC   3            ZYX 
> ```

如果有帮助，请使用 Oracle 10g。我看到了一些可以使用 MYSQL 的东西，但我需要一个普通的 SQL 或 ORACLE 等价物。我还看到了可以制作的存储过程的示例，但是，我不能将存储过程与我正在使用的产品一起使用。

如果我使用它，这是它在 MySQL 中的工作方式

```
SELECT CUSTOMER, 
       CUSTOMER_ID, 
       GROUP_CONCAT( PRODUCT ) 
FROM MAGIC_TABLE 
GROUP BY CUSTOMER, CUSTOMER_ID 
```

谢谢你。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-20T20:06:01.127

我认为 LISTAGG 是在这种情况下按功能使用的最佳聚合组：

```
 SELECT CUSTOMER, CUSTOMER_ID,
         LISTAGG(PRODUCT, ', ') WITHIN GROUP (ORDER BY PRODUCT)
    FROM SOME_TABLE
GROUP BY CUSTOMER, CUSTOMER_ID
ORDER BY 1, 2 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-24T17:44:45.600

[此链接](http://www.oracle-base.com/articles/10g/StringAggregationTechniques.php)引用了许多在 Oracle 上执行此操作的不同方法的示例。看看那里是否有你对你的数据库有权限做的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-12T15:11:47.937

oracle 用户函数 'wm_concat' 的工作方式与 LISTAGG 相同，但默认情况下不能指定分隔符 ',' 或排序顺序。但是它与 10g 兼容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T18:52:03.157

谢谢奈杰尔，

我的 SQL 不够优雅，但我需要一个只需要 SQL 的解决方案，而不是 PLSQL 或 TSQL，所以它最终看起来像这样：

```
SELECT   CUSTOMER, CUSTOMER_ID, COUNT(PRODUCT) PROD_COUNT, 
         RTRIM( 
            XMLAGG( XMLELEMENT (C, PRODUCT || ',') ORDER BY PRODUCT
).EXTRACT ('//text()'), ',' 
         ) AS PRODUCTS FROM     (
         SELECT   DISTINCT CUSTOMER, CUSTOMER_ID, PRODUCT
         FROM     MAGIC_TABLE
         ) GROUP BY CUSTOMER, CUSTOMER_ID ORDER BY 1 , 2 
```

仍然不能完全确定 XML 函数究竟做了什么，但是当需要时我会深入研究。

# asp.net - 如何为动态创建的控件禁用 ViewState？

> ID：234558
> 
> 赞同：1
> 
> 时间：2008-10-24T17:40:45.093
> 
> 标签：asp.net

对于动态添加到页面的控件，我似乎无法禁用 ViewState。

**ASPX**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Page1.aspx.cs" Inherits="Page1" EnableViewState="false" %>
...
<asp:PlaceHolder ID="DropDownPlaceHolder" runat="server" EnableViewState="false" />
<asp:Button ID="Submit" runat="server" OnClick="Submit_OnClick" Text="Click Me!"  EnableViewState="false"/>
... 
```

**ASPX.CS**

```
protected override void OnInit(EventArgs e)
{
    DropDownList dropDown = new DropDownList();
    TextBox textBox = new TextBox();

    textBox.EnableViewState = false;

    dropDown.Items.Add("Apple");
    dropDown.Items.Add("Dell");
    dropDown.Items.Add("HP");

    dropDown.AutoPostBack = true;
    dropDown.EnableViewState = false;

    DropDownPlaceHolder.Controls.Add(dropDown);
    DropDownPlaceHolder.Controls.Add(textBox);

    base.OnInit(e);
} 
```

如果我不能在这些控件上禁用 ViewState，那么我永远无法以编程方式覆盖用户输入/选择的内容。

我尝试将此代码放在 OnInit 和 Page_Load 中，但在任一位置的效果都是相同的——启用了 ViewState（DropDownList 维护选定的值，TextBox 保留输入的文本）。

那么，如何禁用 ViewState 并阻止它填充这些控件？

谢谢！

* * *

感谢您的答复。不幸的是，在我的情况下，这不是一个可行的解决方案。

我将根据配置文件动态加载控件，其中一些控件将加载子控件。

我需要能够单独关闭控件的 ViewState，而无需编写用于在不同位置加载控件的逻辑（在 OnInit 与 LoadComplete 方法中）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T14:47:56.553

> @这个垫子
> 
> 似乎 post(back) 将发送选定的值，即使控件的视图状态已关闭。

是的。帖子将始终发送控件选择/当前值。这是 HTTP 表单发布的一种行为，与 ASP.NET 控件/视图状态无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-28T12:13:42.310

您所看到的是[`ControlState`](http://msdn.microsoft.com/en-us/library/system.web.ui.pagestatepersister.controlstate.aspx ".NET Framework 类库 - PageStatePersister.ControlState 属性").Net Framework 2.0 引入的。它旨在存储控件工作所需的绝对最少信息，例如您的选择`DropDownList`和`TextBox`. 仅与外观相关的属性，例如`BackColor`，仍保留在`ViewState`.

不像`ViewState` [你不能关闭 ControlState](http://msdn.microsoft.com/en-us/library/ms178577.aspx "ASP.NET 状态管理中的新增功能")。

我只能假设这是为了避免最终用户的混淆，因为当控件在`ViewState`不了解后果的情况下禁用时，控件不执行应有的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T19:26:27.283

这是一个“功能” ——http: [//support.microsoft.com/?id=316813](http://support.microsoft.com/?id=316813)

谢谢，微软！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T18:31:07.487

我对此进行了一些测试，发现它有点奇怪。似乎 post(back) 将发送选定的值，即使控件的视图状态已关闭。

不过，我确实找到了一个很好的解决方案，如果您在初始化和加载之后处理所有内容，您将在处理完视图状态后重新加载您的控件，因此它将重置值。

我使用了 LoadComplete 事件，示例如下：

> ```
>  Public Sub Page_In(ByVal sender As Object, ByVal e As EventArgs) _ 
>  Handles Me.LoadComplete
> 
>     Dim ddl As New DropDownList()
>     ddl.EnableViewState = False
>     ddl.Items.Add("Hello")
>     ddl.Items.Add("Stackoverflow")
> 
>     phTest.Controls.Add(ddl)
> 
> End Sub 
> ```

希望这可以帮助。

# data-structures - 跳过列表——曾经使用过它们吗？

> ID：234560
> 
> 赞同：19
> 
> 时间：2008-10-24T17:41:00.817
> 
> 标签：data-structures, binary-tree, skip-lists

我想知道这里是否有人曾经使用过[跳过列表](http://en.wikipedia.org/wiki/Skip_list)。它看起来与平衡二叉树具有大致相同的优势，但实现起来更简单。如果有，您是自己编写的，还是使用预先编写的库（如果有，它的名称是什么）？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-08T17:01:26.507

我的理解是，它们不是*二叉树*（例如红黑树）的有用替代品，而是用于数据库使用的*B 树*，因此您可以将级别的# 降低到可行的最小值并处理w/ base-K 日志而不是 base-2 日志以获得性能特征。概率跳过列表的算法（恕我直言）比相应的 B 树算法更容易正确。另外还有一些关于无锁跳过列表的文献。几个月前我考虑过使用它们，但后来放弃了发现[HDF5](http://en.wikipedia.org/wiki/Hierarchical_Data_Format)库的努力。

有关该主题的文献：

比尔·普格的论文：

*   [跳过列表食谱](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.17.524)
*   [跳过列表：平衡树的概率替代方案](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.17.9380)
*   [跳过列表的并发维护](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.17.8201)

非学术论文/教程：

*   [Eternally Confuzzled](http://www.eternallyconfuzzled.com/tuts/datastructures/jsw_tut_skip.aspx)（对几种数据结构进行了一些讨论）
*   Thomas A. Anastasio 的[“跳过列表”](http://www.csee.umbc.edu/courses/undergraduate/341/fall01/Lectures/SkipLists/skip_lists/skip_lists.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-24T19:31:45.230

实际上，对于我的一个项目，我正在实现自己的完整 STL。我使用了一个跳过列表来实现我的`std::map`. 我选择它的原因是它是一个简单的算法，它非常接近平衡树的性能，但具有*更*简单的迭代能力。

此外，[Qt4 的 QMap](http://doc.trolltech.com/4.1/qmap.html)也是一个跳过列表，这是我在`std::map`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-24T20:16:45.667

几年前，我为一个概率算法类实现了我自己的。我不知道任何库实现，但已经很长时间了。实现起来非常简单。我记得它们对于大型数据集有一些非常好的属性，并且避免了一些重新平衡的问题。我认为实现也比一般的二进制尝试更简单。这里有一个很好的讨论和一些示例 C++ 代码：

[http://www.ddj.us/cpp/184403579?pgno=1](http://www.ddj.us/cpp/184403579?pgno=1)

还有一个带有运行演示的小程序。可爱的 90 年代 Java 光泽在这里：

[http://www.geocities.com/siliconvalley/network/1854/skiplist.html](http://www.geocities.com/siliconvalley/network/1854/skiplist.html)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-05T05:17:53.827

Java 1.6 (Java SE 6) 将[ConcurrentSkipListSet](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListSet.html)和[ConcurrentSkipListMap](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)引入了集合框架。所以，我推测那里有人真的在使用它们。

Skiplist 往往在多线程情况下提供的锁争用要少得多，并且（概率上）具有类似于树的性能特征。

请参阅William Pugh[的原始论文](http://ftp://ftp.cs.umd.edu/pub/skipLists/skiplists.pdf)[pdf]。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-24T19:29:55.200

几年前，我实现了一个变体，我称之为规则引擎的反向跳过列表。大致相同，但参考链接从最后一个元素向后运行。

这是因为插入最有可能朝向集合后端的已排序项目会更快。

它是用 C# 编写的，经过几次迭代才能成功运行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-05-12T14:06:05.497

跳过列表具有与二分搜索算法相同的搜索对数时间界限，但它扩展了该性能以在插入或删除条目时更新方法。然而，跳跃列表的边界是预期的，而排序表的二进制搜索具有最坏情况的边界。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-06T05:53:57.200

跳过列表很容易实现。但是，在插入和删除的情况下调整跳过列表上的指针，你必须小心。没有在真正的程序中使用它，但是做了一些运行时分析。跳过列表不同于搜索树。相似之处在于，它给出了一段时间字典操作的平均 log(n)，就像展开树一样。它比不平衡的搜索树好，但并不比平衡的树好。

每个跳过列表节点都有前向指针，代表当前->下一个（）连接到不同级别的跳过列表。通常，此级别的上限为 ln(N)。因此，如果 N = 100 万，则级别为 13。将有那么多指针，在 Java 中，这意味着用于实现引用数据类型的指针数量。作为平衡搜索树的地方更少，它提供相同的运行时间！！。

[SkipList Vs Splay Tree Vs Hash](http://harisankar-krishnaswamy.blogspot.in/2012/04/skip-list-runtime-on-dictionay.html)正如为字典查找操作所描述的那样，锁剥离哈希表将在 0.010 ms 以下给出结果，其中 splay 树给出 ~ 1 ms 和跳过列表 ~ 720 ms。

# vim - Tab 键 == 4 个空格并在 Vim 中的花括号后自动缩进

> ID：234564
> 
> 赞同：1372
> 
> 时间：2008-10-24T17:41:47.463
> 
> 标签：vim, whitespace, indentation, vi, auto-indent

如何使[vi](http://en.wikipedia.org/wiki/Vi) - [Vim从不使用制表符（将空格转换为制表符，糟糕！），使制表键 == 4 个空格，并像](http://en.wikipedia.org/wiki/Vim_%28text_editor%29)[Emacs](http://en.wikipedia.org/wiki/Emacs)一样在大括号块之后自动缩进代码？

另外，如何保存这些设置，这样我就不必再次输入它们了？

我已经看到与此相关的其他问题，但它似乎总是与我想要的有点偏离。

* * *

## 回答 #1

> 赞同：2049
> 
> 时间：2008-10-24T17:45:13.557

正如在其他几个答案中所指出的那样，现在首选的方法不是使用 smartindent，而是使用以下内容（在您的 中[`.vimrc`](https://stackoverflow.com/questions/10921441/where-is-my-vimrc-file)）：

```
filetype plugin indent on
" show existing tab with 4 spaces width
set tabstop=4
" when indenting with '>', use 4 spaces width
set shiftwidth=4
" On pressing tab, insert 4 spaces
set expandtab 
```

* * *

~~在您的 [.vimrc:][1] 文件中：

```
set smartindent
set tabstop=4
set shiftwidth=4
set expandtab 
```~~ 

帮助文件需要一些时间来适应，但是你阅读的越多，Vim 就越好：

```
:help smartindent 
```

更好的是，您可以在源代码中嵌入这些设置以实现可移植性：

```
:help auto-setting 
```

要查看您的当前设置：

```
:set all 
```

正如[graywh](https://stackoverflow.com/users/18038/graywh)在评论中指出的那样， smartindent 已被 cindent 取代，它“工作得更聪明”，尽管仍然主要用于具有类 C 语法的语言：

```
:help C-indenting 
```

* * *

## 回答 #2

> 赞同：260
> 
> 时间：2008-11-27T05:42:13.667

相关，如果你打开一个同时使用制表符和空格的文件，假设你有

```
set expandtab ts=4 sw=4 ai 
```

您可以将整个文件中的所有制表符替换为空格

```
:%retab 
```

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2009-01-04T21:09:33.780

获得特定文件类型缩进的最好方法是`filetype plugin indent on`在你的 vimrc 中使用。然后，您可以`set sw=4 sts=4 et`在 .vim/ftplugin/c.vim 中指定内容，例如，不必为所有正在编辑的文件设置全局，其他非 C 类型的语法也会正确缩进*（甚至是 lisps）*。

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2014-01-24T02:42:33.537

要在大多数文件中使用 4 空格制表符，在 Makefiles 中使用真正的 8 宽制表符字符，以及在包括 C/C++ 在内的各种文件中自动缩进，请将其放入您的`~/.vimrc`文件中：

```
" Only do this part when compiled with support for autocommands.
if has("autocmd")
    " Use filetype detection and file-based automatic indenting.
    filetype plugin indent on

    " Use actual tab chars in Makefiles.
    autocmd FileType make set tabstop=8 shiftwidth=8 softtabstop=0 noexpandtab
endif

" For everything else, use a tab width of 4 space chars.
set tabstop=4       " The width of a TAB is set to 4.
                    " Still it is a \t. It is just that
                    " Vim will interpret it to be having
                    " a width of 4.
set shiftwidth=4    " Indents will have a width of 4.
set softtabstop=4   " Sets the number of columns for a TAB.
set expandtab       " Expand TABs to spaces. 
```

* * *

## 回答 #5

> 赞同：63
> 
> 时间：2014-08-04T13:26:58.590

在很多 Linux 系统上，比如 Ubuntu，`.vimrc`默认情况下该文件是不存在的，所以建议您先创建它。

不要使用`.viminfo`主目录中存在的文件。它用于不同的目的。

第 1 步：转到您的主目录

`cd ~`

第 2 步：创建文件

`vim .vimrc`

第三步：添加上述配置

```
filetype plugin indent on
set tabstop=4
set shiftwidth=4
set expandtab 
```

第 3 步：按`Shift`+保存文件`ZZ`。

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2014-05-02T10:35:06.630

推荐的方法是使用基于文件类型的缩进，如果这还不够，只使用 smartindent 和 cindent。

将以下内容添加到您的 .vimrc

```
set expandtab
set shiftwidth=2
set softtabstop=2
filetype plugin indent on 
```

希望它有助于作为一个不同的答案。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2015-10-08T01:26:41.920

编辑你的 ~/.vimrc

```
$ vim ~/.vimrc 
```

添加以下行：

```
set tabstop=4
set shiftwidth=4
set softtabstop=4
set expandtab 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2015-11-18T19:08:54.550

来自[VIM 维基](http://vim.wikia.com/wiki/Converting_tabs_to_spaces)：

```
:set tabstop=4
:set shiftwidth=4
:set expandtab 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-10-24T17:48:21.520

自动缩进基于当前的语法模式。我知道如果您正在编辑 Foo.java，然后输入 a`{`并点击`Enter`缩进以下行。

至于选项卡，有两种设置。在 Vim 中，键入一个冒号，然后“set tabstop=4”，这会将制表符设置为显示为四个空格。再次点击冒号并输入“set expandtab”，这将为制表符插入空格。

您可以将这些设置放在主目录中的 .vimrc（或 Windows 上的 _vimrc）中，因此您只需键入一次。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-07-29T11:46:47.917

毕竟，您可以编辑.vimrc，然后添加conf

```
set tabstop=4 
```

或者执行命令

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-02-06T20:48:11.260

首先，不要使用`Tab`Vim 中的键进行手动缩进。Vim 有一对插入模式的命令，用于手动增加或减少缩进量。这些命令是`Ctrl-T`和`Ctrl-D`。这些命令观察 、 和 的值`tabstop`，`shiftwidth`并`expandtab`保持空格和制表符的正确混合（制表符的最大数量后跟任何必要数量的空格）。

其次，如果您使用自动缩进，这些手动缩进键无论如何都不必使用太多。

如果`Ctrl-T`不是`Tab`打扰您，您可以重新映射它：

```
:imap <Tab> ^T 
```

您还可以重新映射`Shift-Tab`以进行`Ctrl-D`deindent：

```
:imap <S-Tab> ^D 
```

这里 ^T 和 ^D 是文字控制字符，可以插入为`Ctrl-V``Ctrl-T`.

有了这个映射，您仍然可以使用`Ctrl-V``Tab`. 请注意，如果您这样做，即使`:set expandtab`打开，您也会得到一个未展开的制表符。

`<Tab>`使用 可以实现与地图类似的效果`:set smarttab`，这也会使行前的退格键表现得更智能。

在`smarttab`mode中，当`Tab`不在行首使用时，没有特殊意义。这与我上面的`Tab`to映射不同`Ctrl-T`，因为`Ctrl-T`在一行中的任何地方（在插入模式下）使用 a 会增加该行的缩进。

其他有用的映射可能是：

```
:map <Tab> >
:map <S-Tab> < 
```

现在我们可以做一些事情，比如选择一些行，然后点击`Tab`缩进它们。或者在一行上敲`Tab`两次（在命令模式下）以增加它的缩进。

如果您使用正确的缩进管理命令，那么一切都由三个参数控制`shiftwidth`：`tabstop`和`expandtab`。

该`shiftwidth`参数控制您的缩进大小；如果您想要四个空格缩进，请使用`:set shiftwidth=4`或缩写`:set sw=4`。

如果仅这样做，则将使用空格和制表符的混合创建缩进，因为这`noexpandtab`是默认设置。使用`:set expandtab`. 这会导致您在缓冲区中键入的制表符扩展为空格，并且 Vim 管理的缩进只使用空格。

何时`expandtab`打开，并且如果您通过所有适当的 Vim 机制管理缩进，则 的值`tabstop`变得无关紧要。它控制选项卡碰巧出现在文件中时的显示方式。如果您有`set tabstop=8 expandtab`然后使用 将硬制表符潜入文件中`Ctrl-V``Tab`，它将像往常一样产生与下一个基于 8 列的制表符位置的对齐。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-08T08:55:43.197

最简单的将是 n vim 文件

```
set tabstop=4 
```

# database - 每个开发人员一个数据库？

> ID：234580
> 
> 赞同：33
> 
> 时间：2008-10-24T17:46:00.963
> 
> 标签：database, development-environment

在主要编写管理软件的企业开发环境中，每个开发人员应该使用自己的数据库实例，还是应该在开发期间使用中央数据库实例？每种方法的优点和缺点是什么？其他环境和其他产品呢？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-24T17:50:27.133

如果你们都共享同一个数据库，那么如果有人对数据库进行了结构更改并且代码没有与之“同步”，那么您可能会遇到一些问题。

我强烈建议每个开发人员使用一个数据库，唯一的原因是您不想进行“编写”测试以看到其他人在之后立即覆盖您。一个简单的例子？您尝试为网站展示产品。一切正常，直到所有产品消失。问题？另一位开发人员决定使用产品的“活动”标志来测试其他东西。在这种情况下，交易甚至可能不起作用。故事结束，你花时间调试别人的动作。

我强烈建议不时将登台数据库复制到开发人员数据库以同步结构（或者更好的是，拥有一个从头开始重建数据库的工具）。

当然，我们需要脚本来更改数据库，并且一切都在源代码管理中。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-24T18:13:39.317

数据库环境应该稀缺的日子已经一去不复返了。我在一个带有 5x15k SCSI 磁盘的[XW9300上写这篇文章。](http://web.archive.org/web/20090205211511/http://h10010.www1.hp.com/wwpc/ca/en/sm/WF06b/12132708-12132710-12132712-12132712-12132712-12132804-77987465.html)这台机器将在相当合理的时间内运行大量的 ETL 工作，并且（在 2007 年年中）我在 ebay 上花了大约 1,700 英镑，包括磁盘。从开发人员的角度来看，尤其是在数据仓库等以数据库为中心的项目中，开发人员和 DBA 之间的界限非常模糊。在我写这篇文章时，我正在为 SQL Server 2005 数据仓库构建一个分区管理框架。

出于（IMO）这些原因，开发人员应该拥有一个或多个自己的开发数据库：

*   要求人们将存储过程、补丁脚本和模式定义文件保存在源代码控制中。应用补丁可以在很大程度上自动化。甚至还有像[Redgate SQL Compare Pro](https://www.red-gate.com/products/sql-development/sql-compare/)这样的工具可以为此做很多繁重的工作。

*   鼓励一种便于配置管理和部署的应用程序架构，因为人们必须部署到他们自己的工作站上。许多部署问题在投入生产之前很久就会得到解决，或者人们甚至意识到他们可能出错了。

*   避免开发人员在彼此的工作中绊倒。在人们使用 ETL 代码的数据仓库之类的东西上，这是一个更大的胜利。

*   它鼓励一定程度的责任感，因为开发人员必须学习基本的数据库管理。这也消除了对运营支持人员和一些开发人员的许多要求。操作摩擦。

*   如果您拥有自己的数据库，则没有任何守门人会阻碍实验或其他工作。由于没有“服务器”，围绕管理“服务器”的政治消失了。在任何存在大量官僚机构的环境中，这都是生产力的胜利。

*   对于小数据量，一台普通的 PC 就足够快了。开发人员版本或许可适用于大多数（如果不是全部）数据库管理系统，并将在桌面操作系统上运行。如果您使用的是 Linux 或 Unix，这将不是什么大问题。对于更大的数据量，包括大多数 MIS 应用程序，像[HP XW9400](https://support.hp.com/us-en/document/c01741499)或[Lenovo D10](https://www.cnet.com/products/lenovo-thinkstation-d10-6493-xeon-e5410-2-33-ghz-monitor-none-series/)这样的工作站可以配备 5 个 15k 磁盘，其成本低于许多[专业](https://rads.stackoverflow.com/amzn/click/com/B000WM3L4S) [开发](http://web.archive.org/web/20080909234327/http://www.programmers.com/ppi_us/product.aspx?sku=P26%2008101E01&source=) [工具](http://web.archive.org/web/20080213013501/http://trolltech.com/)的成本。（是的，我知道这是双重许可，但 QT 的商业全平台许可大约是 4000 英镑一个席位）。像这样的机器运行 ETL 过程的速度比您想象的要快 10 到 100 百万行。

*   它有助于为烟雾测试或协调目的设置多个环境。由于您可以完全控制机器，因此在生产环境中模拟条件的空间很大。例如，我曾经为[Control-M](http://archive.is/sy1oZ)制作了一个简单的仿真器，只是安装了一些运行时脚本。如果您对环境具有这种级别的控制和透明度，则可以生成经过相当稳健测试的部署过程，这在很大程度上消除了生产部署中相互指责的机会。

我见过小型团队在 14 个环境中工作，同时有 7 个在工作站上活动。在 ETL 等数据库繁重的工作中，您需要处理整个表，在单个开发环境中工作是浪费时间或花时间在蛋壳上行走的秘诀。

此外，您可以为数据库平台使用单用户开发许可证，这可以为您节省仅在数据库许可方面的工作站成本。大多数开发人员许可证（Microsoft 和 OTN 是我熟悉的几个示例）将允许您在单个工作站上免费或以象征性价格为单个开发人员使用该系统。

相反，共享开发服务器上的许可条款通常有些模糊，而且我看到供应商不止一次地试图说服客户在开发服务器上获得许可。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-24T17:48:00.057

我们的每个开发人员都有一个功能齐全的数据库。与任何其他代码一样，更改是脚本化和源代码控制的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-25T02:20:08.070

理想情况下，是的，每个开发人员都应该有一个“沙盒”开发环境，因此他们甚至可以在将代码部署到共享测试/暂存环境之前对其进行测试。

每个开发人员的环境都应运行脚本测试，将数据库重置为已知状态。这在共享环境中是不可能做到的。

为每个开发人员提供自己的实例的成本低于多个开发人员试图在共享环境中一起测试易失性更改所导致的混乱成本。

另一方面，在许多 IT 商店中，系统使用复杂的基础架构，涉及多个应用服务器或多个物理节点。然后经济发生变化；与为每个开发人员复制它相比，人们合作并避免踩到彼此的工作成本更低。如果您集成了昂贵的第三方系统，而这些系统没有为您提供多个开发环境的许可证，则尤其如此。

所以答案是肯定的和否定的。:-) 如果可以廉价地复制该环境，请为每个开发人员提供自己的环境。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-24T17:55:12.177

我的建议是拥有 2 个级别的开发环境：

每个开发人员都有自己的个人开发系统，有自己的 dp、Web 服务器等。这允许他们针对已知设置进行编码，编写自动化（系统级）测试，将他们的数据库和系统初始化为已知状态等。

开发集成环境由所有开发人员共享，用于确保一切按预期协同工作，然后再将其交给 QA。代码从源代码管理中签出并安装在那里，并且任何服务器（db 或其他）只有一个实例。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-25T03:17:17.973

这个问题暗示了开发人员需要做他/她的工作。当然应该提供一个私有数据库实例。同样重要的是，我会确保数据库与您打算部署到的产品/版本相同。不要在 MySQL 6.x 上开发并部署到 MySQL 5.x。（这适用于应用服务器和 Web 服务器！）

拥有开发人员数据库并不一定意味着您需要将其托管在本地计算机上。您可以拥有一个中央 DBMS 主机，其中包含所有开发数据库。专业人士是您针对目标数据库开发的 garauntee。开发盒的开销更少，强大的 IDE 和应用服务器的空间/马力更多。缺点是所有开发人员的单点故障。（DBMS 服务器出现故障，没有人可以工作。） 开发人员缺乏设置和管理 DBMS 的机会。开发人员无法轻易尝试即将发布的数据库版本或替代数据库选项来解决棘手的问题。

根据您的组织和结构，一些优点可能是缺点，反之亦然。也许您不希望开发人员管理 DBMS。也许您确实计划支持不同的数据库平台。该决定归结为您的组织以及您的目标平台选择。如果您计划针对各种 DB/OS/app 服务器组合，那么每个开发人员不仅应该拥有自己的数据库，而且应该以独特的组合工作。（MySQL/Tomcat/OSX 用于一个 DB2/Jetty/Linux 用于另一个 Postegres/Geronimo/WinXP 用于第三个等）如果您在 iSeries 上设置 ASP（应用程序服务提供者）类型商店，那么当然您'可能会有一个包含所有开发 dbmses 的中央主机，但每个开发人员至少应该有一个单独的数据库实例，以允许对架构进行结构更改。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-25T02:46:35.553

我在本地安装了一个 SQLServer Development Edition 实例。我们有一个 QA DB 服务器，以及多个生产服务器。所有开发和集成测试都是使用我的本地服务器（或其他开发人员本地服务器）完成的。新版本暂存到 QA 服务器。每次发布，经客户验收后，投入生产。

由于我主要做 Web 开发，所以我使用与 VS2008 捆绑的 Web 服务器进行开发和本地测试，然后将 Web 应用程序发布到托管在 VM 上的 QA Web 服务器。一旦被客户接受，它就会被发布到几个不同的生产网络服务器之一——一些是虚拟的，一些不是，这取决于应用程序。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-25T06:41:02.927

我公司的部门只有有限的开发环境，纯粹是因为支持和硬件成本。我们有几个基于生产环境中的 t-1 夜间刷新的环境，以及一些静态环境。

理想情况下，每个人都应该有自己的，但在许多情况下，当满足以下条件时，这将是不切实际的：

*   您有大量需要资源的开发人员（我们部门可能有 80 个）
*   每个开发人员都需要多种资源（通常我每天使用 4-5 个不同的数据库）
*   最新数据很重要（您只是不能足够快地刷新它们）

在这些情况下，需要共享实例和良好的沟通。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-24T17:53:05.537

每个开发人员使用一个数据库的一个优势是，每个开发人员都拥有自己处于“已知”状态的数据的快照。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-24T17:55:20.430

这实际上取决于您的应用程序的性质。如果您的架构是分布式环境中的客户端-服务器架构，那么最好有一个每个人都使用的中央数据库。如果产品为用户提供了具有本地数据库实例的环境，您可以使用它。如果您的开发尽可能地反映现实世界的环境，那将是最好的。

这也取决于您处于哪个开发阶段。可能在早期阶段，您不想被连接性、网络和分布式环境问题所困扰，只想启动并运行。在这种情况下，您可以从每用户数据库实例模型开始，然后在产品达到一定成熟度时切换到中央模型。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-24T17:56:05.327

*我喜欢在必须*隔离开发人员时使用本地版本的想法——开发架构更改、性能测试、设置特定场景等......

在其他时候使用共享版本以确保一切都彼此同步。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-24T17:58:40.393

我认为这里存在术语问题。我已经有一段时间没有戴上我的 DBA 帽子了（天哪，快 10 年了）——所以其他人可以插话并纠正我。

我认为每个人都同意每个开发人员都应该有自己的沙箱模式集。

在 MySQL 和 Sybase/MS SQLServer 中，每个数据库引擎可以支持多个数据库。每个数据库（通常）完全独立于另一个数据库。因此，您可以拥有一个数据库引擎实例，并为每个开发人员提供自己的数据库空间，让他们随心所欲。唯一的问题是如果开发人员正在使用 tempdb——那里可能会发生冲突（我认为——这你需要查找）。请注意不要使用具有固定数据库名称的跨数据库查询。

在 Oracle 中，数据库引擎实例与特定的模式集相关联。如果您在同一个引擎上有多个开发人员，他们都指向同一个表。在这种情况下，是的，您将需要运行多个实例。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-24T17:58:44.323

我们的每个开发人员都有一个本地数据库。我们将创建脚本和“标准数据”的转储存储在我们的 SVN 存储库中。我们有一组广泛的测试，必须针对这些测试数据通过。我们还有一个“沙盒”数据库，可供人们将他们想要共享的数据放入标准数据中。这对我们很有效，允许我们让开发人员修改他们的本地数据副本来测试东西，但我们控制传递给其他开发人员的内容。我们也严格控制模式的变化，所以我们不会遇到别人提到的问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-11T17:17:51.293

在我的公司中，我们在处理重要的新功能时倾向于复制整个数据库。有磁盘空间的原因很便宜，而意外的数据丢失（即使是测试数据）不是。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-03T20:09:51.320

我曾在这两种类型的开发环境中工作过。就个人而言，我更喜欢拥有自己的数据库/应用服务器。但是，使用共享基础架构进行开发可能有一些优势。

主要的一点是共享环境更接近于现实世界的场景：当所有开发人员共享一个数据库时，您更有可能发现锁定或事务的问题。为每个开发人员提供自己的数据库可能会导致“它适用于我的数据库”综合症。

但是，如果您需要应用和测试架构更改或优化，那么我可以在这种设置中看到问题。

也许折衷的解决方案效果最好：所有开发人员共享基础设施，如果有人需要测试架构更改，他们会创建自己的临时数据库实例（也许有一个只是为了这个目的而坐在那里？），直到他们乐于提交新的模式到源代码控制。

您确实在源代码控制中拥有整个架构（和测试数据），对吗？对？？？

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-15T07:09:16.177

我喜欢折衷解决方案（所有开发人员共享基础架构，如果有人需要测试架构更改，他们会创建自己的临时数据库实例（也许有一个只是为了这个目的而坐在那里？），直到他们乐于将新架构提交给源代码控制。）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-07-07T13:11:13.980

每个开发人员一个数据库。没有问题。但问题实际上是如何编写整个数据库的脚本、“控制数据”并对其进行版本控制。我的解决方案在这里：[http](http://dbsourcetools.codeplex.com/) ://dbsourcetools.codeplex.com/ 玩得开心。- 内森。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-01-25T06:27:28.790

数据库模式应该保存在源代码控制中，开发人员应该拥有为代码和数据库一起签入的变更集。在签入之前，开发人员应该在他自己的数据库上工作。签入后，自动构建（例如：签入时、夜间等）应更新中央集成数据库以及应用程序本身。

在开发人员实例级别，加载的数据至少应该适合单元测试。在集成级别，共享数据库应该保存也适合测试的数据，但不应该依赖生产复制——这只是托管测试数据的替代品。

根据我的经验，开发人员选择共享数据库的唯一原因是他们相信在最近的生产数据上开发和运行在某种程度上是“真实的”，这意味着他们可以在测试上投入更少的精力。他们更喜欢互相踩脚并忍受在下一次生产更新之前慢慢损坏的共享数据库，而不是编写和管理适当的测试。正是这种管理实践给 IT 世界带来了目前所拥有的糟糕声誉。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2008-10-24T17:51:24.027

我建议使用数据库的一个实例。您不希望您的数据库成为移动目标。

# java - Java Swing, textarea as input/output?

> ID：234587
> 
> 赞同：0
> 
> 时间：2008-10-24T17:47:08.917
> 
> 标签：java, swing

I want to load up a window using the java swing, something like [this](http://www.java2s.com/Code/Java/Swing-JFC/ShowlinestartendoffsetsinaJTextArea.htm)

However I want to be able to use it for text input also not just to dump data into it..

any idea how to do it?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T18:02:02.913

JTextAreas are editable by default, so input is trivial. Just put one into a test UI and see for yourself.

From a design perspective, using the same JTextArea for both input and output strikes me as unwise. The only example I can think of is a shell interface, and that imposes stronger limits on how input and output works than a JTextArea will provide out of the box.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T22:03:28.353

我不确定我是否明白了您的问题，但您可以使用 getText() 方法获取用户输入的文本：

JTextArea ta = new JTextArea(); 字符串输入 = ta.getText();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-17T13:57:06.797

看看这个太阳图：

[http://java.sun.com/docs/books/tutorial/uiswing/components/textarea.html](http://java.sun.com/docs/books/tutorial/uiswing/components/textarea.html)

特别是，向下滚动到“TextAreaDemo”示例。

# .net - 限制对应用程序中对象的访问

> ID：234589
> 
> 赞同：4
> 
> 时间：2008-10-24T17:47:21.507
> 
> 标签：.net, security

我经常遇到但没有解决方案的一个问题是限制或允许访问系统中的特定实体。一些公司（例如银行）对哪些员工可以访问某些信息有非常严格的政策。例如，特定分支机构的员工可以访问该特定分支机构的客户的帐户信息，但不能访问其他分支机构的客户信息。此外，在许多国家/地区设有分支机构的银行可能会受到法律限制，限制其他国家/地区的员工访问有关国内客户的信息。

我遇到的另一个示例是公共网站，其中用户属于特定实体（例如公司），并且可能仅访问有关该实体而不是其他实体的信息。

如果实体的数量很小且固定，这不是问题。只需在活动目录中指定域组（如果您在 Microsoft 环境中工作，我就是这种情况），将用户添加到组并使用 IsInRole() 限制每个实体的访问。因此，如果系统中有一家名为 ABC 的公司，我会创建一个名为“Admins_ABC”或类似名称的域组，当用户尝试管理有关 ABC 的信息时，我会确保该用户是该组的成员. 这并不是 AD 的真正使用方式，但对于少数实体，我发现它是合理的。

当实体的数量经常变化并且需求变得更加详细时，复杂性会增加。我已经看到与 NTFS 中的安全性类似的安全要求——某些用户（或用户组）应该能够访问某些实体（NTFS 中的文件）或实体组（传播在 NTFS 中的目录上设置的权限）给它的孩子们）。

我尽量避免这样的情况，因为它们往往是建模和编码的噩梦，而且管理起来通常很复杂，但与我一起工作的客户经常需要解决这个问题。

就像我说的，我从来没有真正解决过这个*问题*。您将如何以可重用的方式对该问题进行建模和开发解决方案？您知道任何可以使用的通用专有解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T18:23:05.693

我曾多次用头撞这堵墙。

我找到的最佳解决方案是在树层次结构中对所有内容进行建模，其中每个域类都是树中的一个分支，而实例是该分支的叶子。如果您需要固定部分实例，叶子可以有脉络。每个分支都有自己分配的操作（例如“读取”、“写入”、“删除”、“发布”）。为安全使用相同的层次结构，但根随后成为用户或组。您最终会得到如下结构：

```
<domain> Project
|- <class> Person
| |- <instance> John
| |- <instance> Mary
|- <class> FormX
| |- <instance> John's Leave Form
... 
```

并且为了应用安全性，您可能有一个名为 Administrators 的组，他们可以与人一起做事：

```
<group> Administrators
|- <class> Person: actions (Read, Create, Update, Suspend) 
```

以及可以处理表格和结交新朋友的办公室管理员：

```
<group> Office Administrator
|- <class> Person: actions (Create)
|- <class> FormX: actions (Approve, Deny) 
```

然后约翰可以用他自己的个人资料做一些事情：

```
<user> John
|- <class> Person
| |- <instance> John: actions (Edit) 
```

当我实现这个结构时，它使用的是 C# 和 SQL Server 2000，因此我能够使用 XML 模式数据类型并对数据库执行安全查询，或者 [通常] 将一个人的安全配置文件合并到一个树中以确定某人对实例、类或其他具有什么权利（我在`<group>`类以上的域中有 s - 不是安全组，以便于维护）。

同样重要的是包括 - 尽管我没有说明 - 每个动作都是一个权限，而不是一个布尔值，其中权限值是`{ Allow, None, Deny }`允许授予对该动词的访问权限，除非明确拒绝，无既不允许也不拒绝，拒绝阻止无论如何访问。

您从这种结构中获得的一个优势是您可以在其中添加其他类型的分支，例如数据驱动的分类法，并且仍然使用相同的 API。

在我的具体实现中，我向方法和属性添加了自定义元数据属性，并且我必须`SecurityManager.Test`在每个“安全”函数中调用一个方法作为授权的最后一层（`SecurityManager.Test`通常被调用以确定是否显示或隐藏表单的各个部分，并确定哪些按钮在 UI 中可见）。现在我知道如果我必须再次实现相同的事情，我将使用[PostSharp](http://www.postsharp.org/)将安全测试注入我的域模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T17:58:39.677

您是否研究过 Microsoft 为 .NET 框架创建的[代码访问安全模型？](http://msdn.microsoft.com/en-us/library/930b76w0(VS.80).aspx)我自己只看过几次，但它的要点是您可以锁定某些对象和方法，以便只有来自内部网络的用户才能真正调用该代码。或者类似地，只能从安装代码的机器本身调用进行维护的方法，从而防止第三方破解维护程序。

[维基百科](http://en.wikipedia.org/wiki/Code_Access_Security)对 CAS 做了一个很好的总结：

> Microsoft .NET 框架中的代码访问安全性 (CAS) 是 Microsoft 防止不受信任的代码执行特权操作的解决方案。当 CLR 加载程序集时，它将获取程序集的证据并使用它来识别程序集所属的代码组。一个代码组包含一个权限集（一个或多个权限）。执行特权操作的代码将执行代码访问请求，这将导致 CLR 遍历调用堆栈并检查授予调用堆栈中每个方法的程序集的权限集。代码组和权限集由定义安全策略的机器管理员确定。

[这篇](http://www.15seconds.com/issue/040121.htm)来自 15 Seconds 的文章对如何开展工作进行了很好的快速概述。

# php - Solving the shared-server security problem for Python

> ID：234590
> 
> 赞同：2
> 
> 时间：2008-10-24T17:47:21.587
> 
> 标签：php, python, mysql, ruby, security

So my group is trying to set up a shared-server environment for various and sundry web services. I think we've settled on setting `disable_functions` and `disable_classes` site wide in `php.ini` and `php_admin_value` to force `open_basedir` in each app's `httpd.conf` for php scripts, and passenger's [user switching](http://www.modrails.com/documentation/Users%20guide.html#user_switching) for ruby scripts.

We still need to find something for python though. Passenger does support python, but not for per-application security for specific sub-directories (it's all or nothing at the domain level).

Any suggestions?

(And if any of the previous doesn't make sense - well, I'm the guy who's supposed to set up the python support, not the guy who set up the php or ruby support, so there's still some "and then some magic happens" steps in there from my perspective).

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-26T20:25:54.673

好吧，有一个名为[virtualenv](http://pypi.python.org/pypi/virtualenv)的系统，它允许您在一种安全的环境中运行 Python，并即时配置/加载/关闭这些环境。我对此了解不多，但您应该认真研究一下；这是其网页上的描述（只需谷歌它，你会找到它）：

> 正在解决的基本问题是依赖关系和版本之一，以及间接权限。想象一下，您有一个应用程序需要 LibFoo 版本 1，但另一个应用程序需要版本 2。您如何同时使用这两个应用程序？如果您将所有内容都安装到 /usr/lib/python2.4/site-packages（或任何您平台的标准位置），很容易导致您无意中升级不应升级的应用程序。
> 
> 或者更一般地说，如果你想安装一个应用程序并让它保持不变怎么办？如果应用程序正常工作，其库或这些库版本的任何更改都可能破坏应用程序。
> 
> 另外，如果你不能将包安装到全局站点包目录中怎么办？例如，在共享主机上。
> 
> 在所有这些情况下，virtualenv 都可以帮助您。它创建了一个有自己的安装目录的环境，它不与其他 virtualenv 环境共享库（并且可选地也不使用全局安装的库）。

# string - 大写与小写

> ID：234591
> 
> 赞同：94
> 
> 时间：2008-10-24T17:47:35.377
> 
> 标签：string, language-agnostic, uppercase

在进行不区分大小写的比较时，将字符串转换为大写还是小写更有效？这还重要吗？

[在这篇 SO 帖子](https://stackoverflow.com/questions/9033/hidden-features-of-c#12137)中建议C# 使用 ToUpper 更有效，因为“Microsoft 以这种方式对其进行了优化”。但我也读过[这个论点](http://www.petefreitag.com/item/175.cfm)，即转换 ToLower 与 ToUpper 取决于您的字符串包含更多内容，并且通常字符串包含更多小写字符，这使得 ToLower 更有效。

特别是，我想知道：

*   有没有办法优化 ToUpper 或 ToLower 以使一个比另一个快？
*   在大写或小写字符串之间进行不区分大小写的比较是否更快，为什么？
*   是否有任何编程环境（例如 C、C#、Python 等）其中一种情况明显优于另一种情况，为什么？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-10-24T18:28:52.890

由于某些文化（尤其是土耳其）的“有趣”特征，为了进行不区分大小写的比较而转换为大写或小写是不正确的。Instead, use a [StringComparer](http://msdn.microsoft.com/en-us/library/system.stringcomparer.aspx) with the appropriate options.

MSDN对字符串处理有一些[很好的指导。](http://msdn.microsoft.com/en-us/library/ms973919.aspx)您可能还想检查您的代码是否通过[了土耳其测试](http://www.moserware.com/2008/02/does-your-code-pass-turkey-test.html)。

编辑：注意尼尔关于*序数*不区分大小写比较的评论。这整个领域都很模糊:(

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-01-02T20:42:23.137

来自[微软](http://msdn.microsoft.com/en-us/library/dd465121.aspx)在 MSDN 上：

> # [在 .NET Framework 中使用字符串的最佳实践](http://msdn.microsoft.com/en-us/library/dd465121.aspx)
> 
> **字符串使用建议**
> 
> *   规范化字符串以进行比较时，请使用[String.ToUpperInvariant](http://msdn.microsoft.com/en-us/library/system.string.toupperinvariant.aspx)方法而不是[String.ToLowerInvariant方法。](http://msdn.microsoft.com/en-us/library/system.string.tolowerinvariant.aspx)

为什么？来自[微软](http://msdn.microsoft.com/en-us/library/bb386042.aspx)：

> # 将字符串规范化为大写
> 
> 有一小部分字符在转换为小写时无法进行往返。

这种不能往返的角色的例子是什么？

*   **开始**: 希腊 Rho 符号 (U+03f1) ϱ
*   **大写：**大写希腊字母 Rho (U+03a1) Ρ
*   **小写：小写**希腊字母 Rho (U+03c1) ρ

> ε , **Ρ** , **ρ**

[.NET 小提琴](https://dotnetfiddle.net/NiQhpH)

```
Original: ϱ
ToUpper: Ρ
ToLower: ρ 
```

这就是为什么，如果您想进行不区分大小写的比较，则将字符串转换为大写，而不是小写。

因此，如果您必须选择一个，请选择**Uppercase**。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-10-24T17:54:39.073

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms973919.aspx)，传递字符串并告诉比较忽略大小写会更有效：

> String.Compare(strA, strB, StringComparison.OrdinalIgnoreCase) 等价于（**但比**）调用
> 
> String.Compare（ToUpperInvariant（strA），ToUpperInvariant（strB），StringComparison.Ordinal）。
> 
> 这些比较仍然非常快。

当然，如果您一遍又一遍地比较一个字符串，那么这可能不成立。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-10-24T17:51:57.490

基于倾向于具有更多小写条目的字符串，ToLower 理论上应该更快（很多比较，但很少分配）。

在 C 中，或者当使用每个字符串的可单独访问的元素（例如 C 字符串或 C++ 中的 STL 字符串类型）时，它实际上是一个字节比较 - 所以比较`UPPER`与`lower`.

如果你偷偷摸摸地把你的字符串加载到`long`数组中，你会对整个字符串进行非常快速的比较，因为它一次可以比较 4 个字节。但是，加载时间可能使其不值得。

为什么你需要知道哪个更快？除非你正在做一个公制的比较，否则运行几个周期的速度与整体执行的速度无关，听起来像是过早的优化:)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-24T17:56:35.013

微软已经优化`ToUpperInvariant()`，没有`ToUpper()`。不同之处在于不变量对文化更友好。如果您需要对可能在文化上有所不同的字符串进行不区分大小写的比较，请使用 Invariant，否则不变转换的性能应该无关紧要。

我不能说 ToUpper() 或 ToLower() 是否更快。我从来没有尝试过，因为我从来没有遇到过性能如此重要的情况。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-24T17:56:26.433

如果您在 C# 中进行字符串比较，使用 .Equals() 比将两个字符串都转换为大写或小写要快得多。使用 .Equals() 的另一个好处是没有为 2 个新的大写/小写字符串分配更多内存。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-12-25T19:31:39.353

我想要一些关于这方面的实际数据，所以我提取了以or失败的两个字节字符[的完整列表](//stackoverflow.com/questions/11124705#65433126)。然后我在下面运行了这个测试：`ToLower``ToUpper`

```
using System;

class Program {
   static void Main() {
      char[][] pairs = {
new[]{'\u00E5','\u212B'},new[]{'\u00C5','\u212B'},new[]{'\u0399','\u1FBE'},
new[]{'\u03B9','\u1FBE'},new[]{'\u03B2','\u03D0'},new[]{'\u03B5','\u03F5'},
new[]{'\u03B8','\u03D1'},new[]{'\u03B8','\u03F4'},new[]{'\u03D1','\u03F4'},
new[]{'\u03B9','\u1FBE'},new[]{'\u0345','\u03B9'},new[]{'\u0345','\u1FBE'},
new[]{'\u03BA','\u03F0'},new[]{'\u00B5','\u03BC'},new[]{'\u03C0','\u03D6'},
new[]{'\u03C1','\u03F1'},new[]{'\u03C2','\u03C3'},new[]{'\u03C6','\u03D5'},
new[]{'\u03C9','\u2126'},new[]{'\u0392','\u03D0'},new[]{'\u0395','\u03F5'},
new[]{'\u03D1','\u03F4'},new[]{'\u0398','\u03D1'},new[]{'\u0398','\u03F4'},
new[]{'\u0345','\u1FBE'},new[]{'\u0345','\u0399'},new[]{'\u0399','\u1FBE'},
new[]{'\u039A','\u03F0'},new[]{'\u00B5','\u039C'},new[]{'\u03A0','\u03D6'},
new[]{'\u03A1','\u03F1'},new[]{'\u03A3','\u03C2'},new[]{'\u03A6','\u03D5'},
new[]{'\u03A9','\u2126'},new[]{'\u0398','\u03F4'},new[]{'\u03B8','\u03F4'},
new[]{'\u03B8','\u03D1'},new[]{'\u0398','\u03D1'},new[]{'\u0432','\u1C80'},
new[]{'\u0434','\u1C81'},new[]{'\u043E','\u1C82'},new[]{'\u0441','\u1C83'},
new[]{'\u0442','\u1C84'},new[]{'\u0442','\u1C85'},new[]{'\u1C84','\u1C85'},
new[]{'\u044A','\u1C86'},new[]{'\u0412','\u1C80'},new[]{'\u0414','\u1C81'},
new[]{'\u041E','\u1C82'},new[]{'\u0421','\u1C83'},new[]{'\u1C84','\u1C85'},
new[]{'\u0422','\u1C84'},new[]{'\u0422','\u1C85'},new[]{'\u042A','\u1C86'},
new[]{'\u0463','\u1C87'},new[]{'\u0462','\u1C87'}
      };
      int upper = 0, lower = 0;
      foreach (char[] pair in pairs) {
         Console.Write(
            "U+{0:X4} U+{1:X4} pass: ",
            Convert.ToInt32(pair[0]),
            Convert.ToInt32(pair[1])
         );
         if (Char.ToUpper(pair[0]) == Char.ToUpper(pair[1])) {
            Console.Write("ToUpper ");
            upper++;
         } else {
            Console.Write("        ");
         }
         if (Char.ToLower(pair[0]) == Char.ToLower(pair[1])) {
            Console.Write("ToLower");
            lower++;
         }
         Console.WriteLine();
      }
      Console.WriteLine("upper pass: {0}, lower pass: {1}", upper, lower);
   }
} 
```

结果如下。注意我还测试了`Invariant`版本，结果完全相同。有趣的是，其中一对都失败了。但是基于这个 **ToUpper 是最好的选择**。

```
U+00E5 U+212B pass:         ToLower
U+00C5 U+212B pass:         ToLower
U+0399 U+1FBE pass: ToUpper
U+03B9 U+1FBE pass: ToUpper
U+03B2 U+03D0 pass: ToUpper
U+03B5 U+03F5 pass: ToUpper
U+03B8 U+03D1 pass: ToUpper
U+03B8 U+03F4 pass:         ToLower
U+03D1 U+03F4 pass:
U+03B9 U+1FBE pass: ToUpper
U+0345 U+03B9 pass: ToUpper
U+0345 U+1FBE pass: ToUpper
U+03BA U+03F0 pass: ToUpper
U+00B5 U+03BC pass: ToUpper
U+03C0 U+03D6 pass: ToUpper
U+03C1 U+03F1 pass: ToUpper
U+03C2 U+03C3 pass: ToUpper
U+03C6 U+03D5 pass: ToUpper
U+03C9 U+2126 pass:         ToLower
U+0392 U+03D0 pass: ToUpper
U+0395 U+03F5 pass: ToUpper
U+03D1 U+03F4 pass:
U+0398 U+03D1 pass: ToUpper
U+0398 U+03F4 pass:         ToLower
U+0345 U+1FBE pass: ToUpper
U+0345 U+0399 pass: ToUpper
U+0399 U+1FBE pass: ToUpper
U+039A U+03F0 pass: ToUpper
U+00B5 U+039C pass: ToUpper
U+03A0 U+03D6 pass: ToUpper
U+03A1 U+03F1 pass: ToUpper
U+03A3 U+03C2 pass: ToUpper
U+03A6 U+03D5 pass: ToUpper
U+03A9 U+2126 pass:         ToLower
U+0398 U+03F4 pass:         ToLower
U+03B8 U+03F4 pass:         ToLower
U+03B8 U+03D1 pass: ToUpper
U+0398 U+03D1 pass: ToUpper
U+0432 U+1C80 pass: ToUpper
U+0434 U+1C81 pass: ToUpper
U+043E U+1C82 pass: ToUpper
U+0441 U+1C83 pass: ToUpper
U+0442 U+1C84 pass: ToUpper
U+0442 U+1C85 pass: ToUpper
U+1C84 U+1C85 pass: ToUpper
U+044A U+1C86 pass: ToUpper
U+0412 U+1C80 pass: ToUpper
U+0414 U+1C81 pass: ToUpper
U+041E U+1C82 pass: ToUpper
U+0421 U+1C83 pass: ToUpper
U+1C84 U+1C85 pass: ToUpper
U+0422 U+1C84 pass: ToUpper
U+0422 U+1C85 pass: ToUpper
U+042A U+1C86 pass: ToUpper
U+0463 U+1C87 pass: ToUpper
U+0462 U+1C87 pass: ToUpper
upper pass: 46, lower pass: 8 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-24T17:52:22.887

这真的不应该有关系。对于 ASCII 字符，这绝对无关紧要 - 只是一些比较和任一方向的翻转。Unicode 可能有点复杂，因为有些字符会以奇怪的方式改变大小写，但除非您的文本中充满了这些特殊字符，否则实际上应该没有任何区别。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-04T15:48:48.083

做对了，如果你转换成小写字母，应该有一个很小的、微不足道的速度优势，但正如许多人所暗示的那样，这是依赖于文化的，并且不是在函数中继承，而是在你转换的字符串中继承（很多小写字母意味着对内存的分配很少）-如果您有一个包含大量大写字母的字符串，则转换为大写会更快。

# eclipse - Eclipse：你能在保存时格式化代码吗？

> ID：234594
> 
> 赞同：127
> 
> 时间：2008-10-24T17:47:55.283
> 
> 标签：eclipse, code-formatting, code-standards

在 Eclipse 中，在`Windows`-> `Preference`-> `Java`->下`Code Style`，您可以定义注释和代码的代码模板，并且您可以设置代码格式化程序。

我想知道每次保存源文件时是否可以在 Eclipse 中使这些设置生效。基本上，我希望 Eclipse 负责确保我的代码格式正确，而不是突出显示所有内容并按下++ `Ctrl`。`Shift``F`

这可能吗？你如何设置它？

**关于使用自动格式化的注意事项：** 最好选择“格式化编辑的行”，因为当您重新格式化已经在源代码管理中且格式不正确的整个文件时，合并更改变得非常困难。已经对同事这样做了。

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2008-10-24T17:53:56.877

在 下`Preferences`，选择`Java`--> `Editor`--> `Save Actions`。选中`Perform the selected actions on save`，然后选中该`Format source code`框。

这在以前的 Eclipse 版本中可能可用，也可能不可用。我知道它适用于：

```
Version: 3.3.3.r33x_r20080129-_19UEl7Ezk_gXF1kouft<br>
Build id: M20080221-1800 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-26T10:49:35.187

我强烈建议您将 eclipse 格式的 xml 描述符检查到源代码控制中。这样，团队的所有成员都可以使用它，而您不必来回重新格式化战斗。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-06-26T06:14:08.610

我有设置的快照。请按照以下路径：

在`Preferences`窗口中，选择`Java`--> `Editor`--> `Save Actions`。

检查`Perform the selected actions on save`，然后检查`Format source code box`。

![在此处输入图像描述](https://i.stack.imgur.com/t3Q9d.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-10T17:14:44.717

如果您发现在-->下没有`Save Actions`首选项，可能是因为您使用的是旧版本的 Eclipse。[在这种情况下，您可以从此处](http://sourceforge.net/projects/ejp/files/eclipse%20formatonsave%20plugin/)安装 Format on save 插件。`Java``Editor`

然后，在 下`Preferences`，选择`Java`--> `Format on save`。选择`Run Format`下面的选项`Select a code formatting action`

# java - Can I use Class.newInstance() with constructor arguments?

> ID：234600
> 
> 赞同：256
> 
> 时间：2008-10-24T17:48:59.943
> 
> 标签：java, constructor

I would like to use `Class.newInstance()` but the class I am instantiating does not have a nullary constructor. Therefore I need to be able to pass in constructor arguments. Is there a way to do this?

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2008-10-24T17:52:26.553

```
MyClass.class.getDeclaredConstructor(String.class).newInstance("HERESMYARG"); 
```

or

```
obj.getClass().getDeclaredConstructor(String.class).newInstance("HERESMYARG"); 
```

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2008-10-24T17:51:53.933

```
myObject.getClass().getDeclaredConstructors(types list).newInstance(args list); 
```

Edit: according to the comments seems like pointing class and method names is not enough for some users. For more info take a look at the documentation for [getting constuctor](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getDeclaredConstructor%28java.lang.Class...%29) and [invoking it](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Constructor.html#newInstance%28java.lang.Object...%29).

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2014-06-08T19:15:07.283

假设您有以下构造函数

```
class MyClass {
    public MyClass(Long l, String s, int i) {

    }
} 
```

你需要表明你打算像这样使用这个构造函数：

```
Class classToLoad = MyClass.class;

Class[] cArg = new Class[3]; //Our constructor has 3 arguments
cArg[0] = Long.class; //First argument is of *object* type Long
cArg[1] = String.class; //Second argument is of *object* type String
cArg[2] = int.class; //Third argument is of *primitive* type int

Long l = new Long(88);
String s = "text";
int i = 5;

classToLoad.getDeclaredConstructor(cArg).newInstance(l, s, i); 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-10-24T20:43:51.713

不要使用`Class.newInstance()`；看到这个线程：[为什么 Class.newInstance() 是邪恶的？](https://stackoverflow.com/questions/195321/why-is-classnewinstance-evil)

就像其他答案说的那样，`Constructor.newInstance()`改用。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-24T17:51:03.857

You can get other constructors with [getConstructor(...)](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getConstructor(java.lang.Class...)).

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-10-29T10:40:27.510

按照以下步骤调用参数化构造函数。

1.  `Constructor`通过将类型传入 `Class[]` for`getDeclaredConstructor`方法获取参数类型`Class`
2.  `Object[]`通过在for
    `newInstance`方法中传递值来创建构造函数实例`Constructor`

示例代码：

```
import java.lang.reflect.*;

class NewInstanceWithReflection{
    public NewInstanceWithReflection(){
        System.out.println("Default constructor");
    }
    public NewInstanceWithReflection( String a){
        System.out.println("Constructor :String => "+a);
    }
    public static void main(String args[]) throws Exception {

        NewInstanceWithReflection object = (NewInstanceWithReflection)Class.forName("NewInstanceWithReflection").newInstance();
        Constructor constructor = NewInstanceWithReflection.class.getDeclaredConstructor( new Class[] {String.class});
        NewInstanceWithReflection object1 = (NewInstanceWithReflection)constructor.newInstance(new Object[]{"StackOverFlow"});

    }
} 
```

输出：

```
java NewInstanceWithReflection
Default constructor
Constructor :String => StackOverFlow 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-24T11:31:04.593

我认为这正是你想要的 [http://da2i.univ-lille1.fr/doc/tutorial-java/reflect/object/arg.html](http://da2i.univ-lille1.fr/doc/tutorial-java/reflect/object/arg.html)

虽然它似乎是一个死线程，但有人可能会发现它很有用

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-07-02T14:56:30.040

你可以使用`getDeclaredConstructor`Class的方法。它需要一个类数组。这是一个经过测试的工作示例：

```
public static JFrame createJFrame(Class c, String name, Component parentComponent)
{
    try
    {
        JFrame frame = (JFrame)c.getDeclaredConstructor(new Class[] {String.class}).newInstance("name");
        if (parentComponent != null)
        {
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        }
        else
        {
            frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        }
        frame.setLocationRelativeTo(parentComponent);
        frame.pack();
        frame.setVisible(true);
    }
    catch (InstantiationException instantiationException)
    {
        ExceptionHandler.handleException(instantiationException, parentComponent, Language.messages.get(Language.InstantiationExceptionKey), c.getName());
    }
    catch(NoSuchMethodException noSuchMethodException)
    {
        //ExceptionHandler.handleException(noSuchMethodException, parentComponent, Language.NoSuchMethodExceptionKey, "NamedConstructor");
        ExceptionHandler.handleException(noSuchMethodException, parentComponent, Language.messages.get(Language.NoSuchMethodExceptionKey), "(Constructor or a JFrame method)");
    }
    catch (IllegalAccessException illegalAccessException)
    {
        ExceptionHandler.handleException(illegalAccessException, parentComponent, Language.messages.get(Language.IllegalAccessExceptionKey));
    }
    catch (InvocationTargetException invocationTargetException)
    {
        ExceptionHandler.handleException(invocationTargetException, parentComponent, Language.messages.get(Language.InvocationTargetExceptionKey));
    }
    finally
    {
        return null;
    }
} 
```

# c# - 使用 WEBDAV、C# 以 .msg 格式保存来自 Exchange 2003 的消息

> ID：234601
> 
> 赞同：1
> 
> 时间：2008-10-24T17:49:09.833
> 
> 标签：c#, .net, webdav

在 C# .net 2.0 中，是否有一种快速简便的方法可以从 Exchange 2003 中检索消息（包括其可能的附件）并将其以 .MSG（outlook）格式保存到磁盘。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T18:18:26.810

我很幸运使用[WebDav.NET](http://www.independentsoft.de/webdavex/index.html)与来自 C# 代码的交换进行交互。你应该评估它，看看它是否会做你想做的事情:-) 祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-28T16:08:11.503

我正在寻找相同的解决方案。到目前为止，我发现： http: [//www.codeproject.com/KB/cs/Exchange_2003_with_WebDav.aspx](http://www.codeproject.com/KB/cs/Exchange_2003_with_WebDav.aspx)

它是一个演示应用程序，包含使用 WebDAV 与 Exchange 通信所需的所有代码。
不过我没试过。

# database - Oracle client with OpenforwardOnly flag in database connection.

> ID：234606
> 
> 赞同：3
> 
> 时间：2008-10-24T17:49:58.303
> 
> 标签：database, oracle, visual-c++, 64-bit

I am porting an existing windows based C++ application to 64 bit environment, and this is one of those weird errors. In the code snippet you can that I am using `openforwardonly` and it used to work fine with our old setup but in the 64 bit environment it gives the problem of fetching only **ONE** recordset. Or it could be a problem with the `MoveNext();` of ADO.

To circumvent it we started using `adOpenStatic`, and it worked fine for me for a while but only later realized that it has a performance hit and it is taking forever to get/iterative through values. I request someone to try this code with both the flags and validate the behavior I am seeing.

Information about ado flags: [http://www.w3schools.com/ADO/met_rs_open.asp](http://www.w3schools.com/ADO/met_rs_open.asp)

Another EE topic [http://www.experts-exchange.com/Programming/Languages/Visual_Basic/VB_DB/Q_11520558.html](http://www.experts-exchange.com/Programming/Languages/Visual_Basic/VB_DB/Q_11520558.html)

I remember seeing a MS support case, but I can't get to it now.

I would appreciate any help or suggestions. I know we are using old technology, but we want to move to the additional capabilities without changing code much.

```
// Dbtest.cpp : Defines the entry point for the console application.
//
#include "stdafx.h"
#include <windows.h>
#include <stdio.h>
#include <time.h>

#import "C:\Program Files\Common Files\System\ADO\msado15.dll" \
no_namespace rename("EOF", "EndOfFile")

int main(int argc, char* argv[])
{  
    HRESULT hr = S_OK;
    try
    {
        CoInitialize(NULL);

        _bstr_t strCnn("Provider=OraOLEDB.Oracle;Data Source =****; User Id=****; password=***");
        _ConnectionPtr m_pConn;

        hr=m_pConn.CreateInstance(__uuidof(Connection));

        if(FAILED(hr))
        {
            printf("Failed creating record set instance\n");
            return 0;
        }

        m_pConn->Open(strCnn,"","",NULL);

        //Open the Record set for getting records from Author table
        _RecordsetPtr pRstDoctors = NULL;
        time_t start,end1,end2;
        pRstDoctors.CreateInstance(__uuidof(Recordset));
        time(&start);

        pRstDoctors->Open("select logid from log",strCnn, adOpenForwardOnly,
                  **adLockReadOnly**,adCmdText);

        //Declare a variable of type _bstr_t

        int valField1;
        //int valField2;

        pRstDoctors->MoveFirst();

        //Loop through the Record set
        if (!pRstDoctors->EndOfFile)
        {
            while(!pRstDoctors->EndOfFile)
            {
                valField1 = pRstDoctors->Fields->GetItem("logid")->Value.intVal;
                // valField2 = pRstDoctors->Fields->GetItem("reportid")->Value.intVal;
                // printf("%d - \n",valField1);
                pRstDoctors->MoveNext();
            }
        }
        time(&end1);

        double dif=difftime(end1,start);
        printf("time difference is %.2lf",dif);
    }
    catch(_com_error e)
    {
        printf("Error:%s\n",e);
    }

    CoUninitialize();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-09T12:59:52.473

使用“adOpenStatic”而不是“adOpenForwardOnly”将起作用

```
pRstDoctors->Open("select logid from log",strCnn, adOpenStatic,
               **adLockReadOnly**,adCmdText); 
```

# project-management - How do you bring a failing project back on track?

> ID：234609
> 
> 赞同：19
> 
> 时间：2008-10-24T17:51:03.810
> 
> 标签：project-management, development-process

You must have heard the archetypical story of a failing/failed project:

1.  A team of inexperienced programmers work 24x7
2.  Bugs are fixed only to introduce new bugs
3.  Customer is screaming that he could not even do the basic stuff (Saving/Querying) etc.
4.  Programmers used to having the spec handed down struggle to improvise
5.  No automated unit tests aggravate the situation
6.  Architecture document that looked nice on paper was not followed in practice
7.  Third party components used become bottlenecks not having been tested for fitness in the first place
8.  Milestone after milestone missed
9.  The team is not able to come up with a delivery date as nobody agrees as to the quantum of work actually needs to be done
10.  No technical leadership / or a Cowboy Coder that can take on the technical issues

Now, If you were to be brought in as #10 what would be your first steps?

Update: First of all: Thanks to you all for chipping in. Well... I'm being brought in as #10\. I was the original Architect anchoring the solution when we made the proposal to the client. Then, unfortunately, I couldn't take on the delivery responsibilities as I was assigned somewhere else. :)

Let's say it's a webification of an existing desktop application. I'm now being brought in as #10\. Running away, sadly, is not an option. I'm sure this can still be reversed by following agile best practices and just wanted to tap the community for ideas.

The larger question perhaps is this: If the development team does not have specs but only the (baselined) code for a running application, the original solution called for looking at the code and extracting business rules on the fly. Now, the inexperienced programmers are reluctant to look at VB 6.0 code and want documents! So how do you fight this if you were to instate Agile processes?

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-26T06:27:43.397

Vyas，我觉得我可以写下这个问题。我之前的工作涉及复活一个经过一年开发失败的 KVM 项目。规格以用户手册和开发人员使用类似产品的经验的形式出现。我最终向 3 个汇编程序员教授 C 语言并从头开始重新架构。我们在 4 个月内成功地将产品推向市场。（然后我辞职了。去想想。）

我会再做一些事情，尤其是在经验不足的团队中：

*1\. 一个缺乏经验的程序员团队 24x7 全天候工作*
*10\. 没有技术领导/或 Cowboy Coder 可以处理技术问题*

*   给他们一个（短暂的！）从项目中“充电”的休息时间。也许是一天，也许是一个下午，也许是一顿漫长的午餐。它将标志着“旧”项目的结束和成功的开始。
*   让他们同意在他们回来时努力工作，并承诺你将成为他们的首选人、啦啦队长和防弹夹克。你，集体，是一个团队，你的工作是开辟他们的道路，消除干扰，并领导他们。
*   计划立竿见影的成功，无论多小，并保持“可以做”的态度。

*8\. 错过里程碑后*
*的里程碑 9\. 团队无法提出交货日期，因为没有人同意实际需要完成的工作量*
*3\. 客户尖叫说他甚至无法完成基本工作（节省/查询）等。*

*   **吃点小东西！** 尽可能地分解每一块，然后处理小部件。您将及早发现“陷阱”并更好地确定整个项目的范围。
*   **定义你的接口。**任何时候你可以隔离一个块，**就去做。** 这允许并行开发，因为您已经决定了参数、前提条件、假设、内部发生的事情和返回值。您可以将其存根，并*独立构建其他模块和测试。*
*   **优先。** 首先关注影响客户的缺陷和问题。新功能排在最后。如有必要，推迟功能而不是交付有缺陷的代码。
*   **分配职责。** 志愿者是首选，每个人都在他/她的专业领域，但必须有*一个*人负责每项任务。
*   **跟踪缺陷，**并记录有助于重现、定位和修复它们的所有内容。记录交货时剩余的任何东西，这样客户就不会感到惊讶。

*4\. 习惯于将规范传下来的程序员很难即兴发挥*
*6\. 在纸上看起来不错的架构文档在实践中没有被遵循*

*   *您*将随时创建规格详细信息，每件都在需要之前。只要每个人都理解当前的任务并且你有大局，它不需要漂亮、完整，甚至是书面的。
*   当开发人员准备编写代码时，一次一个地讨论实现。必要时自己写骨架，让团队填“胆”。你想让他们专注于每项任务，而不是“即兴发挥”。
*   随时可以回答出现的问题。您的主要目标是保持团队的生产力。

*2\. 修复错误只是为了引入新的错误*
*5\. 没有自动化单元测试会加剧这种情况*

*   尽快计划并开始单元测试。如果可能的话，争取团队之外的资源。
*   在小问题变大或被隐藏之前解决它们。对每一小块的信心建立了对整体的信心。

*7\. 使用的第三方组件成为瓶颈，一开始没有经过适应性测试*

*   不编码时头脑风暴解决方案。如果可能的话，不要让他们阻止你的进步。你能围绕它们封装或编码吗？替换它们？

**一般建议：**

*   **保持领先于团队。** 在团队遇到问题之前预测并尝试解决问题。在需要之前收集任何必要的信息。
*   **不断沟通。** 明确表示您不希望有任何意外，并在每一天都征求您的疑虑、问题、状态、障碍*等。*鼓励协作并在整个团队中分享“发现”。
*   **庆祝每一次成功。** 赞美一个聪明的解决方案，解决问题时带来甜甜圈，展示一个新的工作功能......任何表明你欣赏他们的团队的东西。
*   **完成每一项任务，然后继续前进。**不要浪费时间去调整、增强或改造任何不是成功的直接障碍的东西。
*   **信守对团队、客户和管理层**的承诺。****

 **祝你好运——请随时通知我们！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-24T17:53:03.413

Run away or find a new job. This is a [death march](http://en.wikipedia.org/wiki/Death_march_(software_development)) and they need a scape goat.

> Often, the death march will involve desperate attempts to right the course of the project by asking team members to work especially grueling hours, weekends, or by attempting to "throw (enough) bodies at the problem" with varying results, often causing burnout.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-24T17:56:42.550

Freeze releases, and start fixing issues with the program.... deal with the customer complaints by priority (the business side of the company can prioritize) and get the program running. Once you get the biggest issues out of the way, start cleaning up the code. Assign tasks to other developers, and start enforcing coding practices on all new code.

If you can do whatever you want, then look at what the real issues are and deal with them. If that means putting together a new team to develop the software all over from scratch, so be it. But you should try to at least fix the major bugs. Don't bother introducing new features, they only compound the problem, and a program that doesn't work and the problems aren't dealt with lose you clients.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-11T01:18:50.910

我希望你得到很好的报酬。无论如何，我的计划将按以下顺序类似于这些步骤：

0) 停止在整个团队中添加特性或功能。在执行以下步骤到第 5 步时允许解决错误，然后停止错误修复并恢复功能开发：

1) 应用我所说的*逆人员配备法则*：较弱的团队成员会放慢更好和更快的团队成员的速度，通常后期的软件项目需要移除人员，而不是添加人员。因此，您需要评估团队成员作为个人贡献者的质量。从团队中淘汰较弱的员工，因为大概有一些。这最好通过审查他们的代码并检查他们的错误修复来完成，并找出谁让代码变得更糟和更好，并为团队砍掉它们。现在不是指导的时候，您将需要最好的人在最佳时间段内改变“修复”情况。如果你不能解雇他们或重新分配他们，让他们为剩下的其他人喝咖啡或其他东西。

2) 评估代码本身。识别代码中构建得不好和/或抽象得不好的区域。如果一个区号没有很好地构建和/或在它应该做的事情上显然很脆弱，那么将它作为重写的目标。在这一点上感觉很痛苦，但从长远来看，它会节省你的时间。重复出现的错误和/或修复历史将有助于识别无法挽救的代码。如果代码区域或模块从根本上构建良好，但在接口级别抽象得不好，那么它应该适合重构。这将节省大量时间并且是有用的代码。保留重写区域、重构区域和合适区域的列表。

3) 定义一个新的合理架构，您认为该架构将为您最终希望的特性和功能提供强大而完整的解决方案。该架构在开始时可能不是最佳的，但实际上与您想要的位置相匹配。

4) 与利益相关者合作，决定什么是可接受的第一个版本，尝试为“以后的”版本列出尽可能多的特性。也许你不能削减任何东西，但如果你能，现在是时候去做了。

5) 停止后台错误修复工作，并将已定义的工作分配给（剩余的）团队，以估计出一个合理的其余功能的新实施计划。他们需要拥有时间表。汇总时间表并相当保守。现在，您可以合理地预测何时可以真正拥有可行且强大的东西。

6) 实现剩余的功能，然后通过解决剩余的错误来加强版本。我假设在这里观察到所有正常的良好软件开发实践，如源代码控制、单元测试等。

7) 消除尽可能多的障碍，以使团队尽可能快地完成工作。

8) 监控问题，并通过尽可能多地弄脏您的手来提供帮助。提出在您可以提供帮助的范围内解决更棘手的问题，同时保持团队所有成员的工作效率。

祝你好运！

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-24T17:54:12.460

Number 10 is obviously the worst problem, or at least the root of all others. Find someone with some creativity and ability to deliver a project, and give them free reign to do anything - including start over.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-25T18:31:12.220

这不再是关于技术领导力，而是关于项目管理。

作为技术负责人，您将只是在泰坦尼克号上移动躺椅。如果我是事实上的**项目经理**，这就是我会做的事情。

1) 确定项目发起人和利益相关者——包括官方的和**真实**的。

2) 去找他们，要求项目“黑掉”一周。

3）如果他们不同意，离开这个项目。

4）如果他们同意，就叫项目暂停一周——一切都停止了。

5) 花整整一周时间与项目中的重要人物交谈，以确定真正的项目状态。

6) 在参与这些讨论的同时，开始制定项目恢复计划，强调范围、进度、预算和人员之间可能的权衡。

7) 在一周结束时，决定哪些（如果有）您的可能项目方案是可行的。

8) 将这些场景中最好的情况反馈给项目发起人和利益相关者，并开始谈判。

9) 当一个前进的方向达成一致时，重新启动项目并祈祷——可能不是按照那个顺序。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-24T18:31:05.583

Maxim（退出死亡行军）已经向您指出了常识。但是，如果出于未知的原因你想坚持下去，让我用我在类似情况下的经历来招待你——也许它可能会有用。

这是我在一个昏昏欲睡的老城区的第一份工作，那里很难找到好的计算机工作，而我在大学毕业后迫切需要一个。我被录用了，因为管理层认为我足够热情，可能聊胜于无（我提出带上我自己的薪酬，以节省他们给我一台 PC 的费用，并提出独自工作）

由于死亡行军的情况，该项目已被其创建者放弃，并在删除代码中的所有注释并执行其他混淆后离开了。也没有人知道 win32 / MFC 的东西。

我只是开始在好的旧纸和铅笔上研究代码（大量的摩擦和更正），直到在 20 天内我知道整个代码，包括心脏的变量以及发生的事情和发生的地方。

有了这些知识，我就能够制作出以前所有人都无法理解的关键作品。当然，这不过是沧海一粟，但它使管理层能够赢得客户的信心“聪明的家伙 - 很难让他 - 已经让 x 工作 - 你将在 y 时间内让你的东西工作”。

一旦客户被说服并且我们能够争取一些时间，一些压力就被消除了。这给团队带来了一些希望，我们开始全力以赴。6 个月后，我被提升为项目负责人，9 个月后，我们收到了修复货物（大量的进度演示和明显越来越满意的客户）。

如您所见，成功的要素不能直接复制。但我想总结一下，您需要首先为项目注入一些希望 - 展示一些进展并赢得信心 - 您的同行、管理层和客户的信心。一旦到位，技术内容也应该得到纠正——没有什么可以代替这部分等式。

如果这看起来不太可能，那么所有的辛勤工作（哦，是的 - 很多工作都是你从未想象过的 - 为什么你认为它被称为死亡行军）将是一种浪费，你最好在开始之前就退出。

我别无选择，我很热血，迫切需要一份工作。可以在其中发挥作用的技术细节，一切都刚刚到位。我真的通过这部作品赢得了很多善意和自尊，但从长远来看，它只是一个故事，我可以非常沉着地讲述，除了那些知道的人之外，仅此而已。

事情可能对您有所不同，但由您决定。

祝你好运

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T18:08:55.193

如果你真的必须让它走上正轨（如果不能选择保释）

首先要承认这是管理上的失败。然后，您可能希望继续实施严格但轻松的流程。

我建议采用某种形式的敏捷，因为它在没有 GURU 的情况下最容易成功实施，但你必须非常严格，包括配对、无情重构、评论、尖峰功能、可见性、TDD、一周周期、 8 小时工作日（是的，超过 8 小时往往会损害生产力而不是帮助，正如您似乎已经注意到的那样）......

也不要剪掉任何东西。敏捷的一部分依赖于其他部分——没有配对、重构和测试，您无法消除前期设计（最大的敏捷失败之一）。

不要忘记它的管理方面。一周迭代开始（每周演示）。不断适应。每天很短的站立会议来解决问题。（最多保持 15 分钟，列出更长的问题等）燃尽图，核心团队与客户在上面。

你不能仅仅每周开 15 分钟的会议和 2 周的迭代就称之为敏捷，但如果你做得对，它可能会给你一个机会。您可能会得到一位优秀的敏捷顾问来培训您入门。

此外，不断评估哪些有效，哪些无效。准备好修复不起作用的东西。每周召开会议，分析这几周的开发成功和失败。

总体而言，它可以工作，并且可以使一个摇摇欲坠的团队陷入困境，但这并不是微不足道的。最好的部分是您可以在不占用当前开发的大量时间的情况下实现它。你只是不断发展，但你做得更好。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T19:01:28.817

在艰难的情况下，您的客户信任度为零，无论如何，在这种情况下基本上都无法成功。

出于所有意图和目的，该项目需要重新启动；不幸的事实是，现有商店通常没有机会重新开始并重新评估那里的一切。

我不想这么说，但是您需要停止开发并花一个月的时间找出问题所在...

结果需要制定一个可行的 6 个月 - 1 年交付计划，真正让他们专注于必备品和对第三方组件的真实贸易研究。并且垃圾代码库需要成为一种选择；开始一个新的源代码控制项目，当你到达一个特定的模块端口时，这些端口是有意义的，并留下了垃圾。

敏捷非常棒，一旦你制定了真正的计划，它也是一种有效的方法；但它不会修复与您的客户的破裂关系......或所有已经存在的垃圾。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-24T17:55:38.650

*   Make sure you *aren't* the scapegoat
*   Cut scope creep
*   Trim functionality "requirements"
*   Implement a faster dev cycle (maybe Agile/Scrum/XP/whatever)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-28T06:25:15.150

首先，要下定决心，你可能会失败——如果你不能接受，就不要接受挑战。这包括成为替罪羊（确实会发生）。管理层不会以这些方式看待它（即他们不是有意/有意识地“设置你”）。但这是企业环境的现实；如果您承担责任（通常比不承担责任的人获得更多报酬），那么如果事情没有解决，您的头脑就会被阻止。你也必须准备好长期坚持下去。我曾经在一个客户网站上待了 8 个月，以修复一个衰落的项目。正如您所看到的，这里的其他博客发布者之一花了 9 个月的时间才准备好发布版本。

现在，假设您可以接受尽管您付出了努力但仍可能变成梨形的可能性，这就是我的建议：

*   错误跟踪系统将成为您最好的朋友，它将让您重新获得控制权。您不能希望将复杂的系统作为一个整体来理解，因此“分块”会有所帮助。错误跟踪系统允许您将问题统一起来并将它们分发给您正在合作的其他人。

*   你要应对技术和政治挑战。技术通常不是那么糟糕，因为您是编码员并且您知道如何做到这一点。政治问题要棘手得多，你掌舵的一艘船已经无可救药地偏离了航线，而你正处于百慕大三角地带。最大的挑战通常是阻止客户中负面情绪的浪潮（例如客户：“这些牛仔不知道他们在做什么”，“他们向我承诺过，但没有兑现”，“我没有信心在这些家伙中，不再有”）。

*   首先，向客户道歉并具体告诉他们你正在做什么来重新纠正他们的项目，例如你：“我很抱歉你的项目延迟了，我现在陷入困境。我查看了项目历史，就个人而言，如果我为这个系统付出高昂的代价，我也会很生气。我要解决的第一件事是……”<-宾果游戏，你刚刚拿了对项目负责，这意味着没有回头路——现在要么全有，要么全无。

*   其他几个人在这里说过，我同意；停止添加新功能。他们没有提到的是，您可能必须这样做才能让客户满意（请记住，挑战存在技术和政治方面）。

*   尽可能了解业务领域。通读任何你能拿到的需求文件。由于您不知道最初讨论的内容，因此迟到该项目会使您处于极大的劣势。魔鬼在细节中。这就是让我在无法挽救的后期项目中陷入困境的原因，每个人都处于紧张状态，而我错过了一个次要要求。在当时，这没什么大不了的，可以很容易地纠正，但从政治上讲，这是压垮骆驼的最后一根稻草。一种可能会有所帮助的策略是在客户网站上停留几周。

*   明白时间就是金钱。它不仅仅是一个技术问题。客户支付了不正确或未交付的东西。您的公司已经花费了资源，可能已经用完了所有的项目预算 - 业务现在正在亏损。这就是新功能问题再次出现的地方，是的 - 人们说不要添加它们，稳定。但是添加新功能在政治上可能是一种有用的策略，管理层会很高兴，因为新的资金正在用于不合规格的工作。

*   我建议您或您的编码人员工作荒谬的时间来交付。如果您通常在下午 5 点离开，请改为在下午 6.30 或晚上 7 点离开。您和您的编码男孩可以连续数周保持一两个小时的额外工作，周末可能会保持 4-5 小时。每晚工作到晚上 9 点或 10 点会导致大约 2 周内精疲力竭（有些可能会持续更长时间）。在那之后，您在项目上的额外时间弊大于利。万一您的老板对此提出异议，请做出选择；做他们要求的（即工作更多时间），或者说“我已经为这个项目付出了额外的时间——我是长期来这里的，如果这个项目我死了，我会完成这个项目。但这是我愿意投入多少时间的极限。*但要为后果做好准备*（请记住，政治局势与技术局势一样多）。

*   这里有人说“停下来写一个规范，停下来做这个......” - 对不起，伙计们，我在这里不能同意你的看法，这是不切实际的。该项目已经停滞不前，管理层或客户想要在这里做的最后一件事是“我们必须停止一切并且......”。我以前试过这个，我对客户和管理层说“错误会一直出现，直到我们停止，我写了一个详细的系统测试计划。这需要我两个星期”——客户不想要要为此付出代价，而管理层不愿意承担这笔费用。正如它发生的那样，错误不断出现。

*   学会“杂耍”——你必须提前规划任务，这样程序员就不会等你了。这通常意味着您自己编写的代码更少。通常，最好通过在编码开始之前制定项目时间表来实现这一点。程序员在完成他们当前的工作后应该知道他们接下来要做什么，他们不应该来问你“我接下来要做什么？”，他们应该已经知道了。

*   内置恢复实用程序，尤其是当软件存在难以确定的反复出现的问题时。例如; 追踪错误并修复它可能需要 12 小时，可能需要 2 小时投入实用程序（阅读“hack”）来暂时修复问题。时间和动力是必不可少的，不幸的是，可能需要使用创可贴修复。

*   非常注意客户的情绪。他们需要知道您“站在他们一边”（例如客户：“产品不可接受”，您：“我同意，如果我处于您的位置，我会踢我们的屁股。我能告诉您的就是我在上面并且在一切正常之前不会休息”）。当客户回到您的网站时，他们实际上会开始帮助您。例如，他们可能会保护你免受来自管理层的压力。

*   以身作则。类似于“我要留下来做这个项目，如果你也愿意留下来，我会很感激帮助”和“我知道这不是我们的烂摊子，但我们仍然要打扫无论如何，它。我希望客户得到一些高质量的软件“。程序员通常可能不太关心让他们陷入这种情况的公司，但他们可能会关心是他们自己还是客户（“可能”）。

我在这里看到的许多建议都假定了相当高的权力（例如，“停止项目以正确重新启动它”或“对新功能说不”）——你开始项目时已经受够了，作为一名程序员，传统上，与真正的经理相比，您影响变革的能力要小得多。这并不意味着“放弃/不尝试”——它只是意味着你必须要有创造力并做你通常不会做的事情（即使用“软”或人际交往能力）。

这里的很多人都说要保释该项目，奔向山丘。迄今为止，我已经完成了 3 个无可救药的迟到的项目。我设法修复了 2，而 1 我无法修复。就个人而言，承担后期项目并不困扰我。毕竟，可能发生的最坏情况就是你被解雇了 :)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-24T21:25:47.417

Here's the summary of *key learning* after reading through your experiences:

**Maxim**
1: Make sure this is not a "Death March"

**Ellie**
2: Make sure what's delivered works 3: Refactor & Realgin codebase to Architecture / Best practices 4: Look at what are the real issues: Is the team technically competenet to deliver?

**Kendall**
5: Ensure availaibility of Technical Leadership

**Bill K**
6: Implement Agile Processes (At least automated unit tests if not TDD, short iterations that make progress visible) 7: Get customer buy-in 8: Be prepared to throw out what cannot work (wishful thinking aside)

**Warren**
9: Make sure the team memebers that remain given a chance to start over

**Tim**
10: Motivate team and as improvement becomes visible reward them

**jsl4980**
11: You need buy-in on schedule from your team (most imp.) & customer [This raises more questions. What if your customer asks whether the team is competent enough to stick to your schedule? What if you yourself know that the timelines the team is proposing just shows their lack of understanding]

**Ather**
12: Is the team commited?
13: Do you formally QA?

**Patrick**
14: Start over, redesign and reconform to Architecture/Design best practices for modules yet to be developed.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-24T18:02:22.740

如果可以，就逃吧。

如果没有，您需要停止所有使项目不稳定的活动——包括编码和修复缺陷。

评估你在哪里

将需求分解为更小的“里程碑”

阅读一些实用书籍（想到麦康奈尔的《软件项目生存指南》。

识别所有问题和风险。与所有相关人员进行沟通。

一次一个地处理每一件。

庆祝实现的改进和里程碑。

祝你好运。你的情况听起来很糟糕。它可能无法挽救 - 事情必须改变才能变得更好。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-25T01:53:09.093

摘要有 14 项。你不能全部都做。那么，第一步是什么？

这是你首先要做的——改进**一**件事。

*   你有基本的质量问题。(#2-5)
*   您遇到了架构和组件问题。(#6, 7)
*   你有日程安排问题。(#1, 8, 9)

你可以解决质量问题。走向 TDD 的正式单元测试会有所帮助。这可能很难，因为架构问题会减慢测试速度。

你可以处理建筑。这可能会更难，因为它可能会涉及看起来无法交付的返工。但它可能会解决质量问题。或者，它可能会因基本测试问题而复杂化。

你可以处理时间表。如果没有其他更正（即质量或架构），您可能无法解决进度问题。

我认为，人们态度的全面改善来自于尽可能早地从*一次成功——任何成功——开始。*挂在最低点的水果是什么？

*   一个长期存在的错误？一个单元测试套件来查找和修复该错误？
*   一个主要的建筑特征？每个人都可以在他们的多维数据集中发布的图表会有帮助吗？演示文稿如何澄清事情？
*   一个新的用例？一项真正有效的新功能？

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-06T11:40:31.413

这是一本关于这个主题的好书：

[灾难解开：让软件项目重回正轨](https://rads.stackoverflow.com/amzn/click/com/0321336623)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-24T18:20:58.350

1）我要评估的第一件事是团队中的人是否致力于项目？如果没有，做任何其他事情都是毫无价值的。除非我有一个敬业的团队，否则没有什么能阻止灾难。2) 我会确保团队中有 QA。3) 为客户制定合理的迭代和增量发布计划。由于我们所处的混乱局面，客户不可能很快得到所有东西。根据客户的优先级，我们会经常向他提供较小的功能增量。这将使客户保持参与度，因为他看到一些事情正在发生，所以不那么紧张。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-11T00:38:52.363

敏捷重构。识别并优先考虑客户的需求，然后在现有代码的短冲刺中创建最重要的东西。祝你好运：）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-24T17:58:29.707

If you were involved in the project from the beginning, I hate to say it, but the company should replace you (and the entire team).

It should be reanalyzed with a competent team with real project management processes and lead by a project manager with experience in this situation.

None of the original coders should work on the 'new project' of saving it. They can move to other projects (they don't have to be fired) but to get a fresh look at the project, everybody should be replaced.

And of course, management has to understand and be on board with the fact that the project is going to be much later than expected. If management doesn't agree with this (replace team, find experienced leadership, take a step back and start again) then @Maxim is right - get out of there.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-10T23:50:54.397

Been there, followed these steps:

**Stabilize**

*   gather the real story: how good/bad is the codebase, how good/bad are the developers, what really needs to get done (bare bone min.), when it needs to get done by
*   reduce overtime (tired people, good or bad, don't work well)
*   remove the bad, input new/good - err on the side of replacement (many could be burnt out and appreciate even a forced change)
*   remove access to bad/un-required code (focus on the 20% of the code base that provides the 80% of the value)
*   put base code practices in place ensuring only good code is getting in (don't damage the base anymore)

**Control**

*   implement teams focused on the app components (decouple as much as possible)
*   put code management, release management, risk management, QA, etc. in place (build your environment so you can succeed)
*   get on your clients/sponsors good side - delivery a win, even if it's a somewhat stable very very small release - and then put in change management (control what gets requested)

Move forward

*   develop a plan (planning is essential, plans are useless according to Ike - you need to plan to find what is missing and to set a target, but don't expect to tell the future) - continuous planning is required
*   aggressively manage your people - good people make good product - make sure you get and retain the best
*   refactor over time - clean up code as you go - you may not have the luxury to fix everything at once so do it overtime to provide for a cleaner code base
*   move forward bravely - overtime be more aggressive with your deliveries test (but not stress) your team

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-26T09:39:41.857

## 不管你做什么，一步一步去做。

首先，这不是关于添加功能，而是关于修复应用程序。不要添加任何新内容。只是重构。对有人要求你在系统中引入的任何新东西说不。

不要试图改进整个应用程序。带上你的团队，让它在当时专注于一个方面，尽可能地使用最佳实践，尤其是使用单元测试。

仅使用测试驱动开发。在这种情况下，它会立即向您显示您不了解行为的哪一部分（如果您不知道要测试什么，则无法编写测试代码。

## 所以这里是路线图：

1.  确定您需要更改的关键部分
2.  隔离暗示此行为的代码
3.  在其余代码中查找此代码的任何出现
4.  使用这些知识和大量 TDD 进行重构
5.  集成、测试和修复，直到这个特定部分工作
6.  回到步骤

向你的老板说明情况：这需要时间、金钱，而且会很痛苦。解释为什么，你会做什么，你别无选择，否则它会再次失败。

A 最重要的是，第一次不要试图让它干净。重构你能做的，但不要期望第一次改变你正在处理的部分的整个架构。您将不得不**在整个应用程序上**多次迭代该过程。

没有奇迹。只是方法和耐心。

# sql - 如何使用解释计划优化查询？

> ID：234622
> 
> 赞同：22
> 
> 时间：2008-10-24T17:53:05.787
> 
> 标签：sql, oracle, optimization

我的任务是在工作中优化一些 sql 查询。我发现的一切都指向使用解释计划来识别问题区域。我无法确切找出解释计划告诉我的问题。你得到成本、基数和字节。

这表明了什么，我应该如何使用它作为指南。数字越小越好吗？越高越好吗？任何投入将不胜感激。

或者，如果您有更好的方法来优化查询，我会很感兴趣。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-25T13:17:55.437

我还假设您使用的是 Oracle。对于初学者，我还建议您查看解释计划网页。优化有很多，但可以学习。

一些提示如下：

首先，当有人要求您优化时，他们几乎总是在寻找可接受的性能而不是最终性能。如果您可以将查询的运行时间从 3 分钟缩短到 3 秒，请不要急于将其缩短到 2 秒，直到您被要求这样做。

其次，快速检查以确保您正在优化的查询在逻辑上是正确的。这听起来很荒谬，但我无法告诉你有多少次我被要求就运行缓慢的查询提供建议，只是发现它偶尔会给出错误的答案！事实证明，调试查询通常也可以加快查询速度。

特别是，在解释计划中寻找短语“笛卡尔连接”。如果您在那里看到它，那么您很有可能发现了一个无意的笛卡尔连接。无意的笛卡尔连接的通常模式是 FROM 子句列出用逗号分隔的表，连接条件在 WHERE 子句中。除了缺少一个连接条件，Oracle 只能执行笛卡尔连接。对于大型表，这是性能灾难。

可以在查询逻辑正确的解释计划中看到笛卡尔联接，但我将其与旧版本的 Oracle 相关联。

还要寻找未使用的复合索引。如果查询中没有使用复合索引的第一列，Oracle 可能会低效使用索引，或者根本不使用索引。让我举个例子吧：

查询是：

```
select * from customers    
where
     State = @State
     and ZipCode = @ZipCode 
```

（DBMS 不是 Oracle，所以语法不同，我忘记了原来的语法）。

快速浏览一下索引会发现一个关于客户的索引，其中的列（国家、州、邮政编码）按此顺序排列。我将查询更改为阅读

```
 select * from customers
   where Country = @Country
      and State = @State
      and ZipCode = @ZipCode 
```

现在它运行了大约 6 秒而不是大约 6 分钟，因为优化器能够充分利用索引。我问应用程序程序员为什么他们在条件中省略了国家，这是他们的回答：他们知道所有地址的国家都等于“美国”，因此他们认为可以通过省略该条件来加快查询速度！

不幸的是，优化数据库检索实际上并不等同于将计算时间缩短几微秒。它涉及了解数据库设计，尤其是索引，以及至少对优化器如何工作的概述。

当您学会与优化器协作而不是试图超越它时，您通常会从优化器中获得更好的结果。

祝你好运，加快优化速度！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-24T18:04:24.390

你得到的远不止这些，这取决于你在做什么。看看这个[解释计划](http://www.oracle-base.com/articles/8i/ExplainPlanUsage.php)页面。我在这里假设您正在使用 Oracle 并且知道如何运行脚本来显示计划输出。开始时可能更重要的是查看左侧是否使用特定索引以及如何使用该索引。如果您正在执行连接，您应该会看到“（完整）”、“（按索引行）”等内容。成本将是接下来要考虑的事情，成本越低越好，您会注意到，如果您正在执行不使用索引的连接，您可能会获得非常大的成本。您可能还想阅读有关[说明计划列](http://www.cs.umbc.edu/help/oracle8/server.815/a67775/ch13_exp.htm)的详细信息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-24T20:01:02.720

你得到了棒棒糖的模糊末端。

如果没有大量额外的信息和经验，绝对没有办法单独查看解释计划并确定是什么（如果有的话）导致性能低于最佳性能。如果查询调优可以减少到 10 个步骤的过程，它将通过自动化过程来完成。我正要列出所有你需要了解的东西才能有效地做到这一点，但那将是一个很长的清单。

我能想到的唯一简短答案......是在计划中寻找比你想象的更多字节的步骤。然后考虑如何减少这个数字......通过索引或分区。

认真地，获取 Jonathan 的 Lewis 关于基于成本的 Oracle 基础的书

获取 Tom Kyte 关于 Oracle 数据库架构的书，然后在树林里租一间小屋住几个星期。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-25T08:20:12.213

这是一个庞大的专业领域（又名黑艺术）。

我一般采取的方法是：

1.  运行有问题的 SQL 语句，
2.  获取实际计划（查找 dbms_xplan），
3.  比较估计的行数（基数）与实际的行数。差异较大表示有问题需要修复（例如索引、直方图）
4.  考虑是否可以创建一个索引来加速部分过程（通常是您从概念上认为计划应该首先进行的地方）。尝试一些索引。

您需要在您询问数据库的上下文中了解不同索引的 O() 影响。它可以帮助您理解 b 树、哈希表等数据结构。然后，创建一个可能有效的索引并重复该过程。

如果 Oracle 决定不使用您的索引，请应用 INDEX() 提示并查看新计划。成本将高于它选择的计划——这就是它没有选择你的指数的原因。暗示的计划可能会导致一些关于为什么您的索引不好的见解。

# c# - TIBCO EMS 服务器是否管理重新连接？还是客户？

> ID：234634
> 
> 赞同：2
> 
> 时间：2008-10-24T17:55:52.300
> 
> 标签：c#, tibco, tibco-ems, ems

TIBCO EMS .NET 参考指南说（第 134 页）

> 要启用重新连接行为和容错，serverURL 参数必须是两个或多个 URL 的逗号分隔列表。在只有一台服务器的情况下，您可以提供该服务器 URL 的两个副本以启用客户端重新连接（例如，tcp://localhost:7222,tcp://localhost:7222）。

TIBCO EMS 用户指南（第 292 页）讨论了故障转移方案、客户端通知和客户端到备份服务器的自动传输，但没有具体与“重新连接”相关。

在“重新连接”场景中，服务器是否处理所有事情？还是客户端必须对其 TIBCO.EMS.Connection 实例做些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T19:51:44.440

从我们的测试看来，服务器和客户端上都有启用此功能的设置。在客户端，SetReconnAttemptCount、Delay、Timeout 控制客户端在意识到服务器故障转移/连接故障转移后尝试重新连接的尝试。

在我们的测试中，我们使用单服务器环境，在连接字符串中列出了两次服务器（使用您上面概述的技巧），当该服务器脱机时，我们收到了故障转移过程生效的客户端通知（我们启用了 Tibems .SetExceptionOnFTSwitch(true)) 并且当服务器重新上线时，我们的客户端无缝地重新连接，没有错过任何一个节拍。我们不需要编写任何代码，内部重新连接逻辑发挥了它的魔力。

在服务器端，需要启用容错，我相信需要启用服务器-客户端和客户端-服务器心跳（尽管尚未验证）。

希望这可以帮助。

# java - 对于有经验的程序员来说，最好的 Java RPG（角色扮演游戏）引擎是什么？

> ID：234646
> 
> 赞同：7
> 
> 时间：2008-10-24T17:57:35.807
> 
> 标签：java

我正在研究构建一个小型 Java rpg。对于有经验的 Java 程序员来说，我还没有找到任何好的 RPG 引擎示例，它是最强大但最稳定的。

任何和所有类型。我只是想尽可能多地了解那里有什么。

2d、3d 或等轴测图

提前谢谢大家。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T18:00:24.430

我不知道您是在考虑 2d 还是 3d，但我不久前使用了[jMonkeyEngine](http://www.jmonkeyengine.com/)并发现它非常可靠。

# asp.net - 将 ASP.NET GridView 绑定到 Oracle SYS_REFCURSOR

> ID：234657
> 
> 赞同：2
> 
> 时间：2008-10-24T18:00:30.123
> 
> 标签：asp.net, oracle, gridview, sys-refcursor

我们在 Oracle 中有一个带有 SYS_REFCURSOR 输出参数的过程，它返回我们想要绑定到 ASP.NET GridView 控件的数据。我以前见过这样做，但我找不到我用来解决问题的原始参考。

程序如下所示：

```
create or replace PROCEDURE GETSOMEDATA
(
    P_Data OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_Data FOR SELECT * FROM SOMETABLE;
END GETSOMEDATA; 
```

现在 GridView 只是简单的：

```
<asp:GridView ID="grdData" runat="server" AutoGenerateColumns="true"></asp:GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T18:39:08.987

只是谷歌搜索试图为你找到答案，[我遇到了这篇文章](http://www.enterprisedb.com/documentation/dotnetprovider-refcursors.html)。

也许它可以帮助你解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T14:51:19.790

尝试类似：（未指定哪种语言）

```
 Public Function GetSomeData() as DataTable
        Dim OrclConn as New OracleConnection("Connectionstring")
        Dim OrclCmd as New Oraclecommand("GETSOMEDATA", OrclConn)
        OrclCmd.CommandType = CommandType.StoredProcedure
        OrclCmd.Parameters.Add("P_Data", OracleType.Cursor).Direction = ParameterDirection.Output 'Or ParameterDirection.ReturnValue

        Dim OrclDA as New OracleDataAdapter(OrclCmd)
        Dim RtnTable as DataTable
        OrclConn.Open
        OrclDA.Fill(RtnTable)
        OrclConn.Close

        Return RtnTable
    End Function 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-11T11:41:29.380

```
Dim oracon As New OracleConnection("User Id=developer;Password=developer;Data Source=orcl;")
        Dim ds As New Data.DataSet
        Dim qry As String
        oracon.Open()
        qry = "select * from Employee"
        Dim adp As New OracleDataAdapter(qry, oracon)
        adp.Fill(ds)
        GridView1.DataSource = ds
        GridView1.DataBind()
        oracon.Close() 
```

# localization - 您会为 Windows 推荐哪种 unicode 友好的文本编辑器？

> ID：234669
> 
> 赞同：-1
> 
> 时间：2008-10-24T18:03:10.993
> 
> 标签：localization, editor

我从事许多亚洲语言本地化项目，并且正在寻找具有以下功能的强大文本编辑器：

1) Unicode 支持 2) 在文件中查找 3) 在文件中替换 4) 正则表达式 5) 多行查找/替换 6) 内置差异

我目前正在使用 NotePad++，但它的文件查找工具并不真正支持 unicode，这是一个破坏交易的工具。EmEditor 看起来很有前途，但它没有多行查找/替换。

任何处理中文、日文或韩文文件的人都有他们喜欢的免费或商业文本编辑器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T19:10:49.170

我将[UniRed](http://www.esperanto.mv.ru/UniRed/ENG/)用于 Unicode 密集型的东西。（虽然我不将它用作通用编辑器：jEdit）。UniRed 在下部屏幕中显示当前字形的十六进制值，这非常方便（即使对于 ASCII 也是如此）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T18:23:34.180

这是一个描述使用[Vim](http://www.vim.org/)和中文文件的页面：http: [//blog.wensheng.com/2007/05/vim-gvim-utf8-and-chinese-in-windows-xp.html](http://blog.wensheng.com/2007/05/vim-gvim-utf8-and-chinese-in-windows-xp.html)

免责声明：我实际上并不使用亚洲语言，但当我想到一个功能强大且国际化的编辑器时，首先想到的是 Vim。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T18:09:38.670

[Ultraedit](http://www.ultraedit.com/products/ultraedit.html)是我最喜欢的文本编辑器，它被宣传为具有良好的 Unicode 支持

[http://www.ultraedit.com/support/tutorials_power_tips/ultraedit/unicode.html](http://www.ultraedit.com/support/tutorials_power_tips/ultraedit/unicode.html)。

它具有您正在寻找的查找/替换/正则表达式功能以及我曾经需要的几乎所有其他功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T18:21:30.580

查看[JEdit](http://www.jedit.org/)。它是用 Java 编写的，它具有语言级别的 Unicode 支持。我尚未确认它具有您列出的所有功能，但如果没有，我会感到惊讶。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T18:38:00.297

### [赛特](http://scintilla.sourceforge.net/SciTETranslation.html)

[http://scintilla.sourceforge.net/SciTETranslation.html](http://scintilla.sourceforge.net/SciTETranslation.html)

~ ~ ~

[Scintilla](http://www.scintilla.org/ScintillaHistory.html)（*构建 SciTE 编辑器的库*）的相关新功能（unicode ）最近的发行说明：

*   于 2008 年 10 月 18 日发布。
    *   即使是带有 SCI_SETKEYSUNICODE 的窄字符窗口，Windows 上的 Scintilla 也可以将键解释为 Unicode。
    *   自动完成取消时发送的通知。
    *   汇编器词法分析器适用于非 ASCII 文本。
    *   CSS 词法分析器更新并适用于非 ASCII。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T18:45:47.660

我会推荐 EditPadPro ( [http://www.editpadpro.com](http://www.editpadpro.com) )。除了完整的 Unicode 支持之外，它还内置了最好的正则表达式引擎之一（它来自 JGSoft，RegexBuddy 的制造商（顺便完美地集成到 EditPadPro 中））。您需要 RegexBuddy 来查找/替换文件功能，您列表中的所有其他内容都由 EditPadPro 本身涵盖。

几个月前，我从 UltraEdit 切换到了 EditPadPro，正是因为它具有出色的正则表达式引擎（UltraEdit 的 Perl 正则表达式引擎有一些烦人的错误，尤其是在多行查找/替换操作方面）。

免费提供可安装在任何 USB 记忆棒上的便携式版本。

EPP 的创建者 Jan Goyvaerts 是居住在泰国的比利时人，因此您可以确定他对亚洲语言了如指掌。

# c# - 如何在自定义控件中实现 BaseValidator 和 IValidator - ASP.Net

> ID：234681
> 
> 赞同：2
> 
> 时间：2008-10-24T18:07:19.563
> 
> 标签：c#, asp.net, vb.net, validation

我有一个从 WebControl 继承并实现 IValidator 的自定义控件，但我还希望拥有 ValidationGroup 的属性。从研究来看，我似乎需要从 BaseValidator 继承才能这样做。任何人都可以从实现 BaseValidator 和 IValidator 的 ASP.Net 自定义控件中提供一个成功的示例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T18:09:46.517

从 BaseValidator 继承会给你所有这些。

您可能会发现此控件的源代码可用作起点： http: [//www.codeplex.com/UsernameAvailability](http://www.codeplex.com/UsernameAvailability)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T18:37:38.583

BaseValidator 实现了 IValidator 接口。只需让您的类从 BaseValidator 派生并覆盖或实现必要的方法来支持您的验证逻辑：

```
public class MyValidator : BaseValidator
{
   public override bool EvaluateIsValid()
   {
     ... your code here ...
   }
} 
```

# javascript - Javascript Array.sort 实现？

> ID：234683
> 
> 赞同：274
> 
> 时间：2008-10-24T18:08:14.087
> 
> 标签：javascript, algorithm, arrays, sorting

JavaScript`Array#sort()`函数使用哪种算法？我知道它可以采用各种参数和函数来执行不同种类的排序，我只是对普通排序使用哪种算法感兴趣。

* * *

## 回答 #1

> 赞同：338
> 
> 时间：2008-10-25T15:02:50.567

我刚刚查看了 WebKit (Chrome, Safari ...)[源代码](http://trac.webkit.org/browser/trunk/Source/JavaScriptCore/runtime/ArrayPrototype.cpp?rev=138530#L647)。根据数组的类型，使用不同的排序方法：

[数字数组](http://trac.webkit.org/browser/trunk/Source/JavaScriptCore/runtime/JSArray.cpp?rev=138530#L972)（或原始类型数组）使用 C++ 标准库函数进行排序，该函数[`std::qsort`](http://en.cppreference.com/w/cpp/algorithm/qsort)实现了快速排序的一些变体（通常是[introsort](https://en.wikipedia.org/wiki/Introsort)）。

如果可用（以获得稳定的排序）或`qsort`没有可用的合并排序，则使用合并排序[对非数字类型的连续数组进行字符串化和排序。](http://trac.webkit.org/browser/trunk/Source/JavaScriptCore/runtime/JSArray.cpp?rev=138530#L1065)

对于其他类型（非连续数组，可能是关联数组），WebKit 使用[选择排序](http://en.wikipedia.org/wiki/Selection_Sort)（他们称之为[“min”排序](http://trac.webkit.org/browser/trunk/Source/JavaScriptCore/runtime/ArrayPrototype.cpp?rev=138530#L668)），或者在某些情况下，它通过 AVL 树进行排序。不幸的是，这里的文档相当模糊，因此您必须跟踪代码路径才能实际查看使用哪种排序方法的类型。

然后有[这样的评论](http://trac.webkit.org/browser/trunk/Source/JavaScriptCore/runtime/JSArray.cpp?rev=138530#L1124)：

```
// FIXME: Since we sort by string value, a fast algorithm might be to use a
// radix sort. That would be O(N) rather than O(N log N). 
```

– 我们只希望真正“修复”这个问题的人比这篇评论的作者对渐近运行时有更好的理解，并意识到基数排序的运行时描述比简单的 O(N)[稍微复杂一些。](https://stackoverflow.com/a/474040/1968)

（感谢 phsource 指出原始答案中的错误。）

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2008-10-24T18:43:49.023

如果您查看此错误[224128](https://bugzilla.mozilla.org/show_bug.cgi?id=224128)，则似乎 Mozilla 正在使用 MergeSort。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2016-05-16T00:37:47.093

没有草案要求 JS 使用特定的排序算法。正如许多人在这里提到的，Mozilla 使用合并排序。但是，在 Chrome 的 v8 源代码中，截至今天，它使用 QuickSort 和 InsertionSort，用于较小的数组。

[V8引擎源](https://github.com/v8/v8/blob/master/src/js/array.js#L720)

从 807 - 891 行

```
 var QuickSort = function QuickSort(a, from, to) {
    var third_index = 0;
    while (true) {
      // Insertion sort is faster for short arrays.
      if (to - from <= 10) {
        InsertionSort(a, from, to);
        return;
      }
      if (to - from > 1000) {
        third_index = GetThirdIndex(a, from, to);
      } else {
        third_index = from + ((to - from) >> 1);
      }
      // Find a pivot as the median of first, last and middle element.
      var v0 = a[from];
      var v1 = a[to - 1];
      var v2 = a[third_index];
      var c01 = comparefn(v0, v1);
      if (c01 > 0) {
        // v1 < v0, so swap them.
        var tmp = v0;
        v0 = v1;
        v1 = tmp;
      } // v0 <= v1.
      var c02 = comparefn(v0, v2);
      if (c02 >= 0) {
        // v2 <= v0 <= v1.
        var tmp = v0;
        v0 = v2;
        v2 = v1;
        v1 = tmp;
      } else {
        // v0 <= v1 && v0 < v2
        var c12 = comparefn(v1, v2);
        if (c12 > 0) {
          // v0 <= v2 < v1
          var tmp = v1;
          v1 = v2;
          v2 = tmp;
        }
      }
      // v0 <= v1 <= v2
      a[from] = v0;
      a[to - 1] = v2;
      var pivot = v1;
      var low_end = from + 1;   // Upper bound of elements lower than pivot.
      var high_start = to - 1;  // Lower bound of elements greater than pivot.
      a[third_index] = a[low_end];
      a[low_end] = pivot;

      // From low_end to i are elements equal to pivot.
      // From i to high_start are elements that haven't been compared yet.
      partition: for (var i = low_end + 1; i < high_start; i++) {
        var element = a[i];
        var order = comparefn(element, pivot);
        if (order < 0) {
          a[i] = a[low_end];
          a[low_end] = element;
          low_end++;
        } else if (order > 0) {
          do {
            high_start--;
            if (high_start == i) break partition;
            var top_elem = a[high_start];
            order = comparefn(top_elem, pivot);
          } while (order > 0);
          a[i] = a[high_start];
          a[high_start] = element;
          if (order < 0) {
            element = a[i];
            a[i] = a[low_end];
            a[low_end] = element;
            low_end++;
          }
        }
      }
      if (to - high_start < low_end - from) {
        QuickSort(a, high_start, to);
        to = low_end;
      } else {
        QuickSort(a, from, low_end);
        from = high_start;
      }
    }
  }; 
```

**更新** 截至 2018 年 V8 使用 TimSort，感谢@celwell。[来源](https://github.com/v8/v8/blob/78f2610345fdd14ca401d920c140f8f461b631d1/third_party/v8/builtins/array-sort.tq#L5)

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2008-10-24T18:34:59.947

ECMAscript 标准没有指定使用哪种排序算法。事实上，不同的浏览器具有不同的排序算法。例如，Mozilla/Firefox 的 sort() 在对地图进行排序时是[不稳定](http://en.wikipedia.org/wiki/Sorting_algorithm#Stability)的（就单词的排序而言）。IE 的 sort() 是稳定的。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-24T18:14:26.197

我认为这取决于您所指的浏览器实现。

每种浏览器类型都有它自己的 javascript 引擎实现，所以这取决于。您可以查看 Mozilla 和 Webkit/Khtml 的源代码库以了解不同的实现。

但是 IE 是封闭源代码，因此您可能需要询问 microsoft 的人员。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-24T18:42:13.720

经过更多研究，对于 Mozilla/Firefox，Array.sort() 似乎使用了合并排序。[请参阅此处](https://dxr.mozilla.org/seamonkey/source/js/src/jsarray.c)的代码。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2018-12-21T01:15:23.340

从 V8 v7.0 / Chrome 70 开始，V8 使用Python 的排序算法[TimSort](https://en.wikipedia.org/wiki/Timsort)。Chrome 70 于 2018 年 9 月 13 日发布。

有关此更改的详细信息，请参阅[V8 开发博客上的帖子。](https://v8.dev/blog/array-sort)您也可以阅读[源代码](https://chromium.googlesource.com/v8/v8.git/+/master/third_party/v8/builtins/array-sort.tq)或[补丁 1186801](https://chromium-review.googlesource.com/c/v8/v8/+/1186801)。

# python - Django 动作的默认参数

> ID：234695
> 
> 赞同：3
> 
> 时间：2008-10-24T18:12:00.413
> 
> 标签：python, django, django-urls

在正则表达式不匹配使用 django 的任何内容的情况下，有没有办法将默认参数传递给操作？

```
 urlpatterns = patterns('',(r'^test/(?P<name>.*)?$','myview.displayName'))

#myview.py
def displayName(request,name):
      # write name to response or something 
```

我尝试将 urlpatterns 中的第三个参数设置为包含 ' 的字典，并为 name 参数提供方法的默认值，但这些都不起作用。name 参数似乎总是无。如果我可以设置默认值，我真的不想对 None 进行检查。

澄清：这是我将其更改为的示例。

```
 def displayName(request,name='Steve'):
      return HttpResponse(name)
#i also tried

urlpatterns = patterns('',
      (r'^test/(?P<name>.*)?$',
        'myview.displayName',
        dict(name='Test')
      )
) 
```

当我将浏览器指向视图时，它会显示文本“无”

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-24T19:39:04.607

问题是，当模式与“test/”匹配时，正则表达式捕获的 groupdict 包含映射“name”=> None：

```
>>> url.match("test/").groupdict()
{'name': None} 
```

这意味着当视图被调用时，使用我期望的类似于下面的东西：

```
view(request, *groups, **groupdict) 
```

这相当于：

```
view(request, name = None) 
```

对于 'test/'，意味着该名称被分配为 None 而不是未分配。

这使您有两个选择。你可以：

1.  在视图代码中明确检查 None ，这有点骇人听闻。
2.  重写 url 调度规则以使名称捕获非可选，并引入第二条规则以在未提供名称时进行捕获。

例如：

```
urlpatterns = patterns('',
    (r'^test/(?P<name>.+)$','myview.displayName'), # note the '+' instead of the '*'
    (r'^test/$','myview.displayName'),
) 
```

采用第二种方法时，您可以简单地调用没有捕获模式的方法，让 python 处理默认参数，或者您可以调用不同的委托视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T18:25:42.147

我*以为*你可以`def displayName(request, name=defaultObj)`；这就是我过去所做的，至少。您将默认值设置为什么？

# javascript - HTML embed<> 可以阻止 mp3 自动下载吗？

> ID：234696
> 
> 赞同：4
> 
> 时间：2008-10-24T18:12:04.920
> 
> 标签：javascript, html, mp3, embed

我的网站上有很多 mp3，我希望我的朋友只能播放它们 - 但我不希望它们在页面打开后立即下载，并且希望它们仅在有人想要时才开始下载到缓冲区中玩它- 嵌入标签可以吗？我似乎在 Google 上找不到任何东西，所以我想知道这是否是我必须在 JavaScript 中做的事情，或者考虑使用 HTML 解决方法。

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T18:18:01.040

当用户单击按钮或类似的东西时，您可以使用 javascript 构建嵌入并将它们插入到 DOM 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-25T17:07:45.650

如果您想要一个非常简单的修复 - 不要嵌入只有链接的音乐文件。然后用户在单击文件之前不会下载文件（这就是`blog.stackoverflow.com`播客的作用......）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T18:56:17.280

您将希望使用 Object 标签与 Embed 标签，但也就是说，不要设置自动播放选项，它们在请求之前不会加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-18T15:05:38.333

如果您有时间，可以寻求我的解决方案...我为每首歌曲创建了一个单独的 html 页面，并在每首歌曲上使用了 embed 标签。然后我刚刚创建了指向要在新窗口中打开的页面的链接。我知道......黑客！但它运作良好，其他相关链接在每首歌曲的新窗口中随之出现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-18T15:09:45.673

你可以随时尝试雅虎媒体播放器，

您只需链接到 mp3，他们就可以按照自己的节奏播放。

我已经看到它用于 PodCast，而 Mp3 的播放列表非常方便且免费。

[http://mediaplayer.yahoo.com/](http://mediaplayer.yahoo.com/)

```
<a href="http://mediaplayer.yahoo.com/example1.mp3">First link</a>
<a href="http://mediaplayer.yahoo.com/example2.mp3">Second link</a>
<a href="http://mediaplayer.yahoo.com/example3.mp3">Third link</a>

<script type="text/javascript" src="http://mediaplayer.yahoo.com/js"></script> 
```

简单的 ：）

您甚至可以通过简单的 html 添加专辑封面和操作 mp3 添加到播放列表的顺序。

[http://yahoomediaplayer.wikia.com/wiki/How_to_link](http://yahoomediaplayer.wikia.com/wiki/How_to_link)

# network-programming - 以编程方式管理思科；Telnet 与 SNMP？

> ID：234697
> 
> 赞同：7
> 
> 时间：2008-10-24T18:12:10.910
> 
> 标签：network-programming, telnet, snmp, cisco

最近，一位网络工程师和我的同事找到了我，他想将他的次要网络管理职责交给初级帮助台技术人员。需要管理的特定位置在其单站点物业上充当租户的 ISP，因此每天都会进行很多小调整。

我认为给他写一个 winform 应用程序来现场管理 32 台 Cisco 设备会很有帮助。我想最初提供可以修改访问控制列表、端口 VLAN 分配和每个 VLAN 的带宽限制的功能......在列表中添加更多认为有价值的内容。

**我最初的想法是模拟**与网络设备的 telnet 会话；利用我的网络工程师对命令行/IOS 交互的熟悉程度。我自己需要最少的时间来学习 Cisco IOS 约定。

**尽管在寻找解决方案时，似乎大多数人都喜欢 SNMP。** 那，或者，他们的具体情况将他们推向了 SNMP 的方向。

我想知道我是否忽略了 SNMP 的一个明显好处。 **我应该使用 SNMP 吗？为什么或者为什么不？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T04:33:08.573

SNMP 非常适合*从*Cisco 设备获取信息，但对于控制设备不是很有用。（虽然从技术上讲，您*可以*使用 SNMP 和 TFTP 的组合将新配置推送到 Cisco IOS 设备。但是发送全新配置对于控制您的路由器或交换机来说是一种相当生硬的工具）。

其他评论者之一提到了 Cisco IOS XR XML API。请务必注意，IOS XR XML API 仅在运行 IOS XR 的设备上可用。IOS XR 仅用于少数 Cisco 的高端运营商级设备，因此对于 99% 的 Cisco 路由器和交换机，IOS XR XML API 不是一个选项。

其他可能性是 SSH 或 HTTP（许多 Cisco 路由器、交换机、AP 等都有可选的 Web 界面）。但我建议反对其中任何一个。据我所知，Web 界面在设备之间不是很一致，而且相当数量的 Cisco 设备不支持 SSH，或者至少在基本许可证中不支持它。

Telnet 确实是唯一的出路，除非您只针对一小部分设备型号。为了给您一些比较，思科自己的 CiscoWorks 网络管理软件使用 Telnet 连接到托管设备。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T15:01:08.787

我不会使用 SNMP，而是使用一种叫做“expect”的小语言。它为这些路由器提供了一个非常好的期望/响应处理器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-06T06:15:08.997

我已经使用 Cisco 交换机完成了相当数量的现实世界 SNMP 编程，并发现在 Net-SNMP 之上的 Python 是相当合理的。这是通过 Google 书籍通过 Net-SNMP 和 Python 上传新 Cisco 配置的示例： [Cisco Switch Upload via Net-SNMP and Python](http://books.google.com/books?id=Y7RCCgjmowcC&lpg=PA225&ots=mgz1MnTtbF&dq=python%20for%20unix%20and%20linux%20cisco%20snmp&pg=PA225#v=onepage&q=&f=false)。我应该透露我是链接中引用的这本书的合著者。

每个人的里程可能会有所不同，但我个人不喜欢使用`expect`，更喜欢使用 SNMP，因为它实际上被设计为“简单网络管理协议”。在紧要关头，expect 是可以的，但它不会是我的第一选择。一些公司使用 expect 的原因之一是开发人员只是习惯了使用 expect。我不一定会因为有人自动化 telnet 或 ssh 的例子就绕过 SNMP。先自己试试吧。

可能会发生一些真正可怕的事情，这可能也不明显。因为expect等待输入，在合适的条件下会出现非常细微的问题，很难调试。这并不意味着一个非常有经验的开发人员不能用 expect 开发可靠的代码，但也需要注意这一点。

您可能想要查看的另一件事是使用多处理模块编写非阻塞 SNMP 代码的示例。因为这是我在 stackoverflow 上的第一篇文章，所以我不能发布多个链接，但如果你用谷歌搜索它，你可以找到它，或者另一个关于使用 IPython 和 Net-SNMP 的文章。

编写 SNMP 代码时要记住的一件事是，它涉及阅读大量文档并进行反复试验。在 Cisco 的情况下，文档非常好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T18:21:37.537

SNMP 还不错，但它可能无法完成您需要它做的所有事情。根据您使用的库以及它如何隐藏与 SNMP 交互的细节，您可能很难找到要更改的 MIB 的正确部分，甚至不知道要更改什么或如何更改它们以执行您想要的操作。

不使用 SNMP 的一个原因是您可以使用[IOS XR XML API](http://www.cisco.com/en/US/docs/ios_xr_sw/iosxr_r3.2/xml/program/guide/xml_32.html)进行所有您需要的配置。捆绑您想要发送到使用它的设备的命令比与 SNMP 交互要容易得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-24T18:49:22.537

我发现 SNMP 对管理来说很痛苦。如果您只需要获取一些数据，那就太好了；如果您需要更改或大量使用它可能非常耗时。就我而言，我对 CLI 很满意，因此 Telnet 方法效果很好。我编写了一些 Python 脚本来使用[Telnetlib对各种网络设备执行管理任务](http://www.python.org/doc/2.5.2/lib/module-telnetlib.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-01T22:41:45.000

与 telnet 相比，SNMP 对相关设备的 CPU 占用相当大；我会尽可能推荐telnet。（如之前的回答中所述，IOS XR XML API 会很好，但据我所知，IOS XR 仅部署在高端运营商级路由器上）。

在现有的配置管理系统方面，两个商业玩家是 HP Opsware 和 EMC Voyence。两者都可能满足您的需求。我不知道实际上支持部署更改的许多开源解决方案。（例如， [RANCID](http://www.shrubbery.net/rancid/)只进行配置监控，而不是预登台和部署配置更改）。

如果您要推出自己的解决方案，我建议的一件事是与您的网络管理员坐下来，为他提供的服务提出最佳实践部署模型（例如标准化 ACL、QoS 队列和 VLAN 名称；类似ACL 中对不同客户具有相同功能的条目等）。在开始设计之前，确保所有现有部署的配置都符合此 BP，这将使问题更易于管理。祝你好运。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T18:49:51.240

旁注：在重新发明轮子编写另一个服务供应系统/网络管理系统之前，请尝试寻找现有的。我知道很多不同程度的灵活性/功能的商业解决方案，但我确信有很多开源解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-06T18:52:34.453

思科已包含帮助台应用程序的菜单选项。基本上你telnet到盒子，它会提供一个漂亮的干净菜单（按1、2、3）。有关更多信息，请查看此链接：

[http://www.cisco.com/en/US/docs/ios/12_2/configfun/command/reference/frf001.html#wp1050026](http://www.cisco.com/en/US/docs/ios/12_2/configfun/command/reference/frf001.html#wp1050026)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-03T00:25:52.953

对期望的另一票。

此外，您不希望允许通过 telnet 或 SNMP 配置防火墙 - ssh 是唯一的方法。原因是 ssh 对其有效负载进行加密，并且不会将特权管理凭据暴露给潜在的拦截。

如果由于某种原因您不能直接使用 ssh，请考虑将启用 ssh 的串行控制台服务器连接到防火墙的控制台端口并以这种方式进行配置。

# asp.net - WebForms 中的选项卡行为

> ID：234704
> 
> 赞同：8
> 
> 时间：2008-10-24T18:14:16.353
> 
> 标签：asp.net, webforms, tabs

在 WinForms 中，我可以设计一个表单并有一个 TabValue 来控制每次用户点击“Tab”时选择哪个控件。我的问题是，在 Web 表单中，是否有做同样事情的机制？

编辑：这同样适用于 Ajax 繁重的应用程序吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-24T18:16:41.637

您可以使用 ASP 控件上的 TabIndex 属性进行设置。如果您想在不是 ASP 控件的东西上执行此操作，您还可以尝试使用[jQuery tabIndex 插件](http://fluidproject.org/blog/2008/01/11/jquery-tabindex-plugin/)之类的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-24T18:18:09.120

Web 控件具有您可以设置的 TabIndex 属性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-17T23:40:45.003

使用 TabIndex 值时，将它们命名为 5、10、15、20 等而不是 1、2、3、4，因此如果您想稍后插入控件甚至移动它，则无需重新编号所有控件的 TabIndex 属性。

# .htaccess - 通用 htaccess 将 www 重定向到非 www

> ID：234723
> 
> 赞同：525
> 
> 时间：2008-10-24T18:19:38.993
> 
> 标签：.htaccess, redirect, mod-rewrite, url-rewriting, http-status-code-301

我想重定向`www.example.com`到`example.com`. 以下 htaccess 代码使这种情况发生：

```
RewriteCond %{HTTP_HOST} ^www\.example\.com [NC]
RewriteRule ^(.*)$ http://example.com/$1 [L,R=301] 
```

但是，有没有办法在不硬编码域名的情况下以通用方式做到这一点？

* * *

## 回答 #1

> 赞同：966
> 
> 时间：2009-08-13T06:05:20.280

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ https://%1/$1 [R=301,L] 
```

[和迈克尔的](https://stackoverflow.com/a/235064/662581)一样，除了这个有效：P

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2010-03-19T08:51:48.657

但是，如果我们需要对单独的 http 和 https 执行此操作：

```
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

RewriteCond %{HTTPS} on
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ https://%1/$1 [R=301,L] 
```

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2011-03-10T15:42:10.487

**将非 www**重定向到**www**（两者：http + https）

```
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} !^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L]

RewriteCond %{HTTPS} on
RewriteCond %{HTTP_HOST} !^www\.(.*)$ [NC]
RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2011-03-10T02:31:27.143

如果您想在 httpd.conf 文件中执行此操作，您可以在没有 mod_rewrite 的情况下执行此操作（显然它对性能更好）。

```
<VirtualHost *>
  ServerName www.example.com
  Redirect 301 / http://example.com/
</VirtualHost> 
```

我在这里得到了答案：[https ://serverfault.com/questions/120488/redirect-url-within-apache-virtualhost/120507#120507](https://serverfault.com/questions/120488/redirect-url-within-apache-virtualhost/120507#120507)

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2012-04-28T10:21:02.077

以下是将 www URL 重定向到 no-www 的规则：

```
#########################
# redirect www to no-www
#########################

RewriteCond %{HTTP_HOST} ^www\.(.+) [NC]
RewriteRule ^(.*) http://%1/$1 [R=301,NE,L] 
```

以下是将无 www 的 URL 重定向到 www 的规则：

```
#########################
# redirect no-www to www
#########################

RewriteCond %{HTTP_HOST} ^(?!www\.)(.+) [NC]
RewriteRule ^(.*) http://www.%1/$1 [R=301,NE,L] 
```

请注意，我使用`NE`flag 来防止 apache 转义查询字符串。如果没有这个标志，apache 会将请求的 URL 更改`http://www.example.com/?foo%20bar`为`http://www.example.com/?foo%2250bar`

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-10-24T20:00:06.590

```
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^/(.*)$ https://%1/$1 [R] 
```

`RewriteCond`捕获`HTTP_HOST`变量*中*的所有内容并将其`www.`保存在`%1`.

`RewriteRule`捕获没有前导的 URL并将`/`其保存在`$1`.

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-10-24T18:26:48.260

试试这个：

```
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteRule ^(.*)$ %{HTTP_HOST}$1 [C]
RewriteRule ^www\.(.*)$ http://$1 [L,R=301] 
```

如果主机以 www 开头，我们将整个主机粘贴到 URL 的开头，然后去掉“www”。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2016-02-09T16:43:06.230

完整的通用 WWW 处理程序，http/https

我没有看到完整的答案。我用它来处理 WWW 包含。

1.  通用的。不需要域信息。
2.  在主域上强制使用 WWW：www.domain.com
3.  删除子域上的 WWW：sub.domain.com
4.  保留 HTTP/HTTPS 状态。
5.  允许域/子域的单个 cookie

请让我知道这是如何工作的，或者我是否留下了漏洞。

```
RewriteEngine On
RewriteBase /

# Force WWW. when no subdomain in host
RewriteCond %{HTTP_HOST} ^[^.]+\.[^.]+$ [NC]
RewriteCond %{HTTPS}s ^on(s)|off [NC]
RewriteRule ^ http%1://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# Remove WWW. when subdomain(s) in host     
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteCond %{HTTPS}s ^on(s)|off [NC]
RewriteCond http%1://%{HTTP_HOST} ^(https?://)(www\.)(.+\.)(.+\.)(.+)$ [NC]
RewriteRule ^ %1%3%4%5%{REQUEST_URI} [R=301,L] 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2011-01-17T16:06:28.737

我发现可能有很多关于 htaccess 重定向的错误信息。首先，确保您的站点使用 Apache 在 Unix 上运行，而不是在 Windows 主机上运行，​​如果您希望此代码能够正常工作。

```
RewriteEngine On

RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]

RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

（但请确保每行文本之间没有行间距；我在行之间添加了一个额外的空格，因此它在此窗口中呈现正常。）

这是一段代码，可用于将您网站的 www 版本指向 http:// 版本。还有其他类似的代码也可以使用。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-10-19T14:36:17.633

```
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1/subfolder/$1 [R=301,L] 
```

对于子文件夹

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-09-04T18:23:19.350

对于那些需要能够在没有“www”前缀的情况下访问整个站点**的**人。

```
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^ http%{ENV:protossl}://%1%{REQUEST_URI} [L,R=301] 
```

确保将其添加到以下文件中

```
/site/location/.htaccess 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-04-18T08:22:22.300

使用 .htaccess 重定向到 www 或非 www：

只需将以下代码行放入您的主根 .htaccess 文件中。在这两种情况下，只需将 domain.com 更改为您自己的主机名。

重定向到 www

```
<IfModule mod_rewrite.c>
  RewriteEngine on
  RewriteCond %{HTTP_HOST} ^domain\.tld [NC]
  RewriteRule ^(.*)$ http://www.domain.tld/$1 [L,R=301]
</IfModule> 
```

重定向到非 www

```
<IfModule mod_rewrite.c>
  RewriteEngine on
  RewriteCond %{HTTP_HOST} ^www\.domain\.tld [NC]
  RewriteRule ^(.*)$ http://domain.tld/$1 [L,R=301]
</IfModule> 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-05-22T08:10:11.470

我使用上述规则将 www 转发到 no www 并且它适用于主页，但是在它们转发到 /index.php 的内部页面上

我在我的 .htaccess 文件中发现了另一个导致此问题的规则，但不知道该怎么做。任何建议都会很棒：

```
############################################
## always send 404 on missing files in these folders

    RewriteCond %{REQUEST_URI} !^/(media|skin|js)/

############################################
## never rewrite for existing files, directories and links

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-l

############################################
## rewrite everything else to index.php

    RewriteRule .* index.php [L] 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-03-03T11:50:52.513

使用 https 从 www 到非 www

```
RewriteEngine on

RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

RewriteCond %{HTTPS} !on
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-07-10T08:12:07.150

```
RewriteEngine on
# if host value starts with "www."
RewriteCond %{HTTP_HOST} ^www\.
# redirect the request to "non-www"
RewriteRule ^ http://example.com%{REQUEST_URI} [NE,L,R] 
```

如果要同时删除`www`and `http`，`https`请使用以下命令：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www\.
RewriteCond %{HTTPS}s ^on(s)|offs
RewriteRule ^ http%1://example.com%{REQUEST_URI} [NE,L,R] 
```

这会重定向非 ssl

*   [http://www.example.com](http://www.example.com)

到

*   [http://example.com](http://example.com)

和 SSL

*   [https://www.example.com](https://www.example.com)

到

*   [https://example.com](https://example.com)

在 apache 上，`2.4.*`您可以使用`Redirect`with`if`指令完成此操作，

```
<if "%{HTTP_HOST} =='www.example.com'">
Redirect / http://example.com/
</if> 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-08-02T06:37:03.657

使用：Javascript / jQuery

```
// similar behavior as an HTTP redirect
window.location.replace("http://www.stackoverflow.com");
// similar behavior as clicking on a link
window.location.href = "http://stackoverflow.com"; 
```

或 .htaccess：

```
RewriteEngine On
RewriteBase /
Rewritecond %{HTTP_HOST} ^www\.yoursite\.com$ [NC]
RewriteRule ^(.*)$ https://yoursite.com/$1 [R=301,L] 
```

和 PHP 方法：

```
$protocol = (@$_SERVER["HTTPS"]    == "on") ? "https://" : "http://";

if (substr($_SERVER['HTTP_HOST'], 0, 4) !== 'www.') {
    header('Location: '.$protocol.'www.'.$_SERVER    ['HTTP_HOST'].'/'.$_SERVER['REQUEST_URI']);
    exit;
} 
```

阿贾克斯

```
$.ajax({
    type: "POST",
    url: reqUrl,
    data: reqBody,
    dataType: "json",
    success: function(data, textStatus) {
        if (data.redirect) {
            // data.redirect contains the string URL to redirect to
            window.location.href = data.redirect;
        }
        else {
            // data.form contains the HTML for the replacement form
            $("#myform").replaceWith(data.form);
        }
    }
}); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-02-28T18:21:34.897

我让它工作的唯一方法......

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^site\.ro
RewriteRule (.*) http://www.site.ro/$1 [R=301,L] 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-04-24T15:38:58.040

如果你强迫 www。在 url 或强制 ssl 协议中，然后尝试在 htaccess 文件中使用可能的变体，例如：

```
重写引擎开启
RewriteBase /

### 强制万维网###

RewriteCond %{HTTP_HOST} ^example\.com
重写规则 (.*) http://www.example.com/$1 [R=301,L]

## 强制 SSL ###

RewriteCond %{SERVER_PORT} 80
重写规则 ^(.*)$ https://example.com/$1 [R,L]

##阻止IP的###
订单拒绝，允许
拒绝来自 256.251.0.139
拒绝来自 199.127.0.259

```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-05-05T16:07:53.833

这已更新为适用于 Apache 2.4：

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} ^www\.(.*)$
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

[与迈克尔的](https://stackoverflow.com/a/235064/662581)唯一变化是删除`[NC]`，这会产生“AH00665”错误：

> 不支持非正则表达式模式“-f”的 NoCase 选项，将被忽略

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2017-01-15T15:17:03.437

这里选择的答案和许多其他解决方案在 / 之后删除了 url 的一部分，所以基本上它总是重定向到主域，至少对我来说是这样。所以我在斜杠后添加了关于完整路径的工作示例。

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1%{REQUEST_URI} [L,R=301] 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2019-10-18T22:11:51.957

如果 .htaccess 自定义不是理想选项，则替代方法：

我创建了简单的重定向服务器供公众使用。只需添加 A 或 CNAME 记录：

```
CNAME   r.simpleredirect.net
A       89.221.218.22 
```

更多信息：[https ://simpleredirect.net](https://simpleredirect.net)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-12-16T18:07:11.670

我不确定你为什么要删除 www。但反向版本将是：

```
# non-www.* -> www.*, if subdomain exist, wont work
RewriteCond %{HTTP_HOST} ^whattimein\.com
RewriteRule ^(.*)$ http://www.whattimein.com/$1 [R=permanent,L] 
```

这个脚本的优点是：如果你有类似 test.whattimein.com 或任何其他（开发/测试环境）的东西，它不会将你重定向到原始环境。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-12-13T08:54:12.017

添加了如果本地主机，则忽略重定向（用于本地环境中的开发目的）。如果不是 localhost AND（不是 https 或者是 www），则重定向到 https 和非 www。

```
RewriteEngine On

RewriteBase /
RewriteCond %{HTTP_HOST} !localhost [NC]
RewriteCond %{HTTPS} off [OR]
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #24

> 赞同：-3
> 
> 时间：2015-05-05T12:29:10.297

您好，您可以在您的 htaccess 文件中使用以下规则：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^example.com
RewriteRule (.*) http://www.example.com/$1 [R=301,L] 
```

# c++ - 是否可以在 C++ 中序列化和反序列化一个类？

> ID：234724
> 
> 赞同：151
> 
> 时间：2008-10-24T18:19:42.050
> 
> 标签：c++, serialization

是否可以在 C++ 中序列化和反序列化一个类？

我已经使用 Java 3 年了，序列化/反序列化在该语言中相当简单。C++ 有类似的功能吗？是否有处理序列化的本机库？

一个例子会很有帮助。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-10-24T18:24:05.600

图书馆[`Boost::serialization`](http://www.boost.org/doc/libs/1_36_0/libs/serialization/doc/index.html)相当优雅地处理了这个问题。我已经在几个项目中使用过它。[这里](http://www.boost.org/doc/libs/1_36_0/libs/serialization/example/demo.cpp)有一个示例程序，展示了如何使用它。

唯一的本地方法是使用流。这基本上就是`Boost::serialization`库所做的所有事情，它通过设置框架将对象写入类似文本的格式并从相同格式读取它们来扩展流方法。

对于内置类型，或您自己的类型`operator<<`并`operator>>`正确定义，这相当简单；有关详细信息，请参阅[C++ 常见问题解答。](https://isocpp.org/wiki/faq/serialization#serialize-simple-types)

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2014-03-02T01:00:53.233

我意识到这是一个旧帖子，但它是搜索时出现的第一个帖子`c++ serialization`。

我鼓励任何有权访问 C++11 的人看一下[grain](http://uscilab.github.io/cereal/)，这是一个仅用于序列化的 C++11 标头库，支持开箱即用的二进制、JSON 和 XML。谷物被设计为易于扩展和使用，并且具有与 Boost 相似的语法。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-24T18:44:06.993

Boost 是一个很好的建议。但如果你想自己动手，这并不难。

基本上，您只需要一种方法来构建对象图，然后将它们输出为某种结构化存储格式（JSON、XML、YAML 等）。构建图就像使用标记递归体面对象算法然后输出所有标记的对象一样简单。

我写了一篇文章，描述了一个基本的（但仍然很强大）的序列化系统。您可能会发现它很有趣：[使用 SQLite 作为磁盘文件格式，第 2 部分](http://replay.waybackmachine.org/20090412173303/http://www.praeclarum.org/2006/03/using-sqlite-as-on-disk-file-format_31.html)。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-24T18:52:49.830

就“内置”库而言，`<<`和`>>`已专门为序列化保留。

您应该重写`<<`以将您的对象输出到某个序列化上下文（通常是`iostream`）并`>>`从该上下文中读回数据。每个对象负责输出其聚合的子对象。

只要您的对象图不包含循环，此方法就可以正常工作。

如果是这样，那么您将不得不使用库来处理这些循环。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-10-24T21:04:25.230

我推荐 Google[协议缓冲区](http://code.google.com/p/protobuf/)。我有机会在一个新项目上试用该库，它非常易于使用。该库针对性能进行了高度优化。

Protobuf 不同于此处提到的其他序列化解决方案，因为它不会序列化您的对象，而是根据您的规范为序列化的对象生成代码。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2013-01-19T11:29:54.657

[Boost::serialization](http://www.boost.org/doc/libs/1_36_0/libs/serialization/doc/index.html)是一个不错的选择，但我遇到了一个新项目：[Cereal](http://uscilab.github.io/cereal/)，我觉得它更优雅！我强烈建议调查一下。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-06-04T06:30:22.453

您可以检查[**amef**](https://code.google.com/p/amef)协议，amef 中的 C++ 编码示例如下，

```
 //Create a new AMEF object
    AMEFObject *object = new AMEFObject();

    //Add a child string object
    object->addPacket("This is the Automated Message Exchange Format Object property!!","adasd");   

    //Add a child integer object
    object->addPacket(21213);

    //Add a child boolean object
    object->addPacket(true);

    AMEFObject *object2 = new AMEFObject();
    string j = "This is the property of a nested Automated Message Exchange Format Object";
    object2->addPacket(j);
    object2->addPacket(134123);
    object2->addPacket(false);

    //Add a child character object
    object2->addPacket('d');

    //Add a child AMEF Object
    object->addPacket(object2);

    //Encode the AMEF obejct
    string str = new AMEFEncoder()->encode(object,false); 
```

在java中解码就像，

```
 string arr = amef encoded byte array value;
    AMEFDecoder decoder = new AMEFDecoder()
    AMEFObject object1 = AMEFDecoder.decode(arr,true); 
```

协议实现有 C++ 和 Java 的编解码器，有趣的部分是它可以保留名称值对形式的对象类表示，我在上一个项目中需要一个类似的协议，当我偶然发现这个协议时，我实际上有根据我的要求修改了基础库。希望这对您有所帮助。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-11-29T11:04:10.453

我建议使用其他海报所描述的 boost 序列化。这是一个关于如何使用它的很好的详细教程，它很好地补充了 boost 教程：[http ://www.ocudert.com/blog/2011/07/09/a-practical-guide-to-c-serialization/](http://www.ocoudert.com/blog/2011/07/09/a-practical-guide-to-c-serialization/)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-09-05T01:57:38.387

[**Sweet Persist**](http://www.sweetsoftware.co.nz/persist_overview.html)是另一个。

可以在 XML、JSON、Lua 和二进制格式的流之间进行序列化。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-04-02T18:48:26.070

我建议研究通常用作序列化基础的抽象工厂

我已经回答了关于 C++ 工厂的另一个 SO question。如果对灵活工厂感兴趣，请查看[那里。](https://stackoverflow.com/questions/410823/factory-method-implementation-c/534396#534396)我尝试从 ET++ 中描述一种使用宏的旧方法，这对我来说非常有用。

[ET++](http://www.ubilab.org/publications/wei94.html)是一个将旧的 MacApp 移植到 C++ 和 X11 的项目。在此过程中，Eric Gamma 等人开始考虑*设计模式*。ET++ 包含在运行时进行序列化和自省的自动方法。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-12-29T14:29:34.797

如果您想要简单且最佳的性能并且不关心向后数据兼容性，请尝试[HPS](https://github.com/jl2922/hps)，它是轻量级的，比 Boost 等快得多，并且比 Protobuf 等更易于使用。

例子：

```
std::vector<int> data({22, 333, -4444});
std::string serialized = hps::serialize_to_string(data);
auto parsed = hps::parse_from_string<std::vector<int>>(serialized); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-10-09T10:05:57.397

我正在使用以下模板来实现序列化：

```
template <class T, class Mode = void> struct Serializer
{
    template <class OutputCharIterator>
    static void serializeImpl(const T &object, OutputCharIterator &&it)
    {
        object.template serializeThis<Mode>(it);
    }

    template <class InputCharIterator>
    static T deserializeImpl(InputCharIterator &&it, InputCharIterator &&end)
    {
        return T::template deserializeFrom<Mode>(it, end);
    }
};

template <class Mode = void, class T, class OutputCharIterator>
void serialize(const T &object, OutputCharIterator &&it)
{
    Serializer<T, Mode>::serializeImpl(object, it);
}

template <class T, class Mode = void, class InputCharIterator>
T deserialize(InputCharIterator &&it, InputCharIterator &&end)
{
    return Serializer<T, Mode>::deserializeImpl(it, end);
}

template <class Mode = void, class T, class InputCharIterator>
void deserialize(T &result, InputCharIterator &&it, InputCharIterator &&end)
{
    result = Serializer<T, Mode>::deserializeImpl(it, end);
} 
```

这`T`是您要序列化`Mode`的类型是一个虚拟类型，用于区分不同类型的序列化，例如。同一个整数可以序列化为 little endian、big endian、varint 等。

默认情况下，`Serializer`将任务委托给正在序列化的对象。对于内置类型，您应该对`Serializer`.

还提供了便利功能模板。

例如无符号整数的小端序列化：

```
struct LittleEndianMode
{
};

template <class T>
struct Serializer<
    T, std::enable_if_t<std::is_unsigned<T>::value, LittleEndianMode>>
{
    template <class InputCharIterator>
    static T deserializeImpl(InputCharIterator &&it, InputCharIterator &&end)
    {
        T res = 0;

        for (size_t i = 0; i < sizeof(T); i++)
        {
            if (it == end) break;
            res |= static_cast<T>(*it) << (CHAR_BIT * i);
            it++;
        }

        return res;
    }

    template <class OutputCharIterator>
    static void serializeImpl(T number, OutputCharIterator &&it)
    {
        for (size_t i = 0; i < sizeof(T); i++)
        {
            *it = (number >> (CHAR_BIT * i)) & 0xFF;
            it++;
        }
    }
}; 
```

然后序列化：

```
std::vector<char> serialized;
uint32_t val = 42;
serialize<LittleEndianMode>(val, std::back_inserter(serialized)); 
```

反序列化：

```
uint32_t val;
deserialize(val, serialized.begin(), serialized.end()); 
```

由于抽象迭代器逻辑，它应该与任何迭代器（例如流迭代器）、指针等一起使用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-09-07T01:41:00.010

这是我敲出的一个简单的序列化程序库。它只是标题，c11 并具有序列化基本类型的示例。这是一个用于上课的地图。

[https://github.com/goblinhack/simple-c-plus-plus-serializer](https://github.com/goblinhack/simple-c-plus-plus-serializer)

```
#include "c_plus_plus_serializer.h"

class Custom {
public:
    int a;
    std::string b;
    std::vector c;

    friend std::ostream& operator<<(std::ostream &out, 
                                    Bits my)
    {
        out << bits(my.t.a) << bits(my.t.b) << bits(my.t.c);
        return (out);
    }

    friend std::istream& operator>>(std::istream &in, 
                                    Bits my)
    {
        in >> bits(my.t.a) >> bits(my.t.b) >> bits(my.t.c);
        return (in);
    }

    friend std::ostream& operator<<(std::ostream &out, 
                                    class Custom &my)
    {
        out << "a:" << my.a << " b:" << my.b;

        out << " c:[" << my.c.size() << " elems]:";
        for (auto v : my.c) {
            out << v << " ";
        }
        out << std::endl;

        return (out);
    }
};

static void save_map_key_string_value_custom (const std::string filename)
{
    std::cout << "save to " << filename << std::endl;
    std::ofstream out(filename, std::ios::binary );

    std::map< std::string, class Custom > m;

    auto c1 = Custom();
    c1.a = 1;
    c1.b = "hello";
    std::initializer_list L1 = {"vec-elem1", "vec-elem2"};
    std::vector l1(L1);
    c1.c = l1;

    auto c2 = Custom();
    c2.a = 2;
    c2.b = "there";
    std::initializer_list L2 = {"vec-elem3", "vec-elem4"};
    std::vector l2(L2);
    c2.c = l2;

    m.insert(std::make_pair(std::string("key1"), c1));
    m.insert(std::make_pair(std::string("key2"), c2));

    out << bits(m);
}

static void load_map_key_string_value_custom (const std::string filename)
{
    std::cout << "read from " << filename << std::endl;
    std::ifstream in(filename);

    std::map< std::string, class Custom > m;

    in >> bits(m);
    std::cout << std::endl;

    std::cout << "m = " << m.size() << " list-elems { " << std::endl;
    for (auto i : m) {
        std::cout << "    [" << i.first << "] = " << i.second;
    }
    std::cout << "}" << std::endl;
}

void map_custom_class_example (void)
{
    std::cout << "map key string, value class" << std::endl;
    std::cout << "============================" << std::endl;
    save_map_key_string_value_custom(std::string("map_of_custom_class.bin"));
    load_map_key_string_value_custom(std::string("map_of_custom_class.bin"));
    std::cout << std::endl;
} 
```

输出：

```
map key string, value class
============================
save to map_of_custom_class.bin
read from map_of_custom_class.bin

m = 2 list-elems {
    [key1] = a:1 b:hello c:[2 elems]:vec-elem1 vec-elem2
    [key2] = a:2 b:there c:[2 elems]:vec-elem3 vec-elem4
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-02-01T12:53:02.413

C++14（推荐 C++17）[boost prf](https://www.boost.org/doc/libs/1_75_0/doc/html/boost_pfr.html)

*   没有宏
*   无需显式编写代码

[演示](https://godbolt.org/z/1qvPqx)

# .net - 无需注册即可使用 OCX

> ID：234726
> 
> 赞同：33
> 
> 时间：2008-10-24T18:20:01.503
> 
> 标签：.net, com, ocx, regfreecom

是否可以在 winform 上使用 ocx（ActiveX 控件）（可能以编程方式添加它）而无需先向 regsrv32 注册 ocx？

我想要实现的是启用 xcopy 安装。我已经从我的开发机器生成了“AxInterop..dll *”和“Interop..dll”文件。*

我已经看到了在不先注册它的情况下调用 COM dll 的可能性（[ProSysLib](http://www.codeproject.com/KB/library/ProSysLib2.aspx?fid=1524721&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2659721&fr=28#xx2659721xx)，据作者说，但我还没有测试过），因为 ocx 也是基于 COM 的，因此我认为必须有一些方法也这样做。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-24T19:52:34.623

是的，这是可以做到的。您必须假设您的应用程序将仅部署在 Windows XP（或 Windows Server 2003）或更高版本上，然后您可以使用所谓的“免注册 COM”来实现这一目标。

本质上，您所做的是为 ActiveX 控件 DLL 创建一个清单文件，以便 Windows 加载程序和 COM DLL 知道它的注册是什么，而不必将其放入注册表中。

MSDN 上的这篇文章中介绍了要执行的操作： [COM 组件的免注册激活：演练](http://msdn.microsoft.com/en-us/library/ms973913.aspx)

该文章中的“第 6 步”和“第 7 步”包含您需要的*所有内容。*

我刚刚在我自己的一个使用 Microsoft ActiveX 网格控件（旧的“MS Flex Grid”）的 C# 程序上进行了尝试，它工作得很好。确保为应用程序和 COM DLL 创建清单文件，并在正确的位置替换适当的 GUID。如果手边没有它们，您可能需要使用 OLEVIEW 从​​ ActiveX DLL 中找出要使用的正确 ID。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-17T21:55:08.773

请注意，显然对在 .NET 中编写的 COM 组件使用无注册表 COM 可能会随机导致 Windows XP 上的崩溃！

链接：[Stackoverflow question](https://stackoverflow.com/questions/617253/is-anyone-successfully-using-registration-free-com-with-net-components) where I learn this, Microsoft 知识库[文章](http://support.microsoft.com/kb/943232)在那个问题中提到。有一个修补程序，但您不能重新分发它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-20T11:23:31.147

在 Visual Studio 中甚至更简单：只需转到引用，找到您的 ocx 创建的位置（应该有 2 个，AxSomething 和Something）并为它们设置隔离：在它们的属性中为真。没有清单，没有代码。您现在应该使用包含 ocx 的 dll 文件分发您的 exe。在您的开发机器上，可以注册 ocx。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-11-17T13:03:09.077

现在，有一个无法访问的点击站点解决方案的副本：mmm4vb6.atom5.com/yes-update-0-12-5479.html#c 在网络存档： [http ://web.archive.org/web/20140828233304/ http://mmm4vb6.atom5.com/yes-update-0-12-5479.html](http://web.archive.org/web/20140828233304/http://mmm4vb6.atom5.com/yes-update-0-12-5479.html)

和上下文：

# **做我的清单**

2013 年 4 月 7 日，星期日

## 是的，更新

虽然我不再那么积极地使用 VB6 进行日常工作，但在此过程中，我和我的同事们需要在修复错误后重新打包一些现有的应用程序，以应对不断变化的 Windows 环境。

自上一个版本发布以来，我们进行了一些更改，看起来不错。我决定发布此更新，但请注意，它尚未像大多数早期版本那样经过彻底的测试！

因此，请务必在发布之前彻底测试使用 MMM 0.12 打包的 MMM 应用程序。

有关详细信息，请参阅更改日志 (Related\MMMChangeLog.txt)。以下是显着的变化：

另一种改进/更正清单的 DPI-Aware 节点的尝试。更改 TLB 处理以防止它们被包含在内。运行时通常不需要 TLB。如果您确实需要包含它们，请通过添加文件自己添加它们，或者之后将它们复制到目标文件夹。试图应对最终导致 MMM 清单中出现“重复” coClass 条目的 Microsoft 补丁。更好地（我们希望）处理一些 VB6 提供的 OCX 中包含的不可创建类。我希望这能解决您在这些领域也可能面临的一些问题。当然，我希望这个版本不会破坏任何东西或以某种方式使事情变得更糟。

通过下载获取新版本：

[MMM-0-12](http://web.archive.org/web/20140828233304/http://home.comcast.net/%7Ebvocs/miscdls/MMM-0-12-src.zip)

发表于 2013 年 4 月 7 日星期日下午 2:59 ...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-11T19:58:49.743

经过 10 个小时的搜索如何在 Win7 上使用 OCX 运行 VB6 应用程序而无需注册它和管理员权限，我在这里找到了一些点击解决方案：http: [//mmm4vb6.atom5.com/yes-update-0-12-5479.html# C](http://mmm4vb6.atom5.com/yes-update-0-12-5479.html#c)

需要检查嵌入清单以使其工作。像魅力一样工作！

我在这里发布解决方案，因为我在这里也发现了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-28T22:12:03.987

我通过以下方式将 ocx 转换为 dll

*   打开“VS 2019 的开发人员命令提示符”
*   调用“tlbimp 文件名.ocx”

然后我将生成的 filename.dll 作为项目中的参考导入。

参考：[https ://docs.microsoft.com/en-us/dotnet/framework/tools/tlbimp-exe-type-library-importer](https://docs.microsoft.com/en-us/dotnet/framework/tools/tlbimp-exe-type-library-importer)

# linux - 使用 Bash 在 Linux 中设置环境变量

> ID：234742
> 
> 赞同：77
> 
> 时间：2008-10-24T18:25:47.407
> 
> 标签：linux, bash, unix, shell

在`tcsh`，我有以下脚本工作：

```
#!/bin/tcsh
setenv X_ROOT /some/specified/path

setenv XDB    ${X_ROOT}/db
setenv PATH   ${X_ROOT}/bin:${PATH}

xrun -d xdb1 -i $1 > $2 
```

`tcsh setenv`Bash中的函数等价于什么？

有直接模拟吗？环境变量用于定位可执行文件。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2008-10-24T18:29:44.073

`export VAR=value`将 VAR 设置为值。如果需要空格，请将其括在单引号中，例如`export VAR='my val'`. 如果要对变量进行插值，请使用双引号，例如`export VAR="$MY_OTHER_VAR"`.

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-24T21:46:52.180

人们经常建议写作的原因

```
VAR=value
export VAR 
```

而不是更短的

```
export VAR=value 
```

是较长的形式比短的形式在更多不同的外壳中起作用。如果您知道自己正在处理`bash`，当然，两者都可以正常工作。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2014-08-20T15:37:08.077

## 在 Linux 上使用 Bash 设置本地和环境变量

**检查 Bash 中名为 LOL 的变量的本地或环境变量：**

```
el@server /home/el $ set | grep LOL
el@server /home/el $
el@server /home/el $ env | grep LOL
el@server /home/el $ 
```

健全性检查，没有称为 LOL 的本地或环境变量。

**在本地而不是环境中设置一个名为 LOL 的局部变量。所以设置它：**

```
el@server /home/el $ LOL="so wow much code"
el@server /home/el $ set | grep LOL
LOL='so wow much code'
el@server /home/el $ env | grep LOL
el@server /home/el $ 
```

变量“LOL”存在于局部变量中，但不存在于环境变量中。如果您重新启动终端、注销/登录或运行，LOL 将消失`exec bash`。

**设置一个局部变量，然后清除 Bash 中的所有局部变量**

```
el@server /home/el $ LOL="so wow much code"
el@server /home/el $ set | grep LOL
LOL='so wow much code'
el@server /home/el $ exec bash
el@server /home/el $ set | grep LOL
el@server /home/el $ 
```

**您也可以只取消设置一个变量：**

```
el@server /home/el $ LOL="so wow much code"
el@server /home/el $ set | grep LOL
LOL='so wow much code'
el@server /home/el $ unset LOL
el@server /home/el $ set | grep LOL
el@server /home/el $ 
```

局部变量 LOL 消失了。

**将局部变量提升为环境变量：**

```
el@server /home/el $ DOGE="such variable"
el@server /home/el $ export DOGE
el@server /home/el $ set | grep DOGE
DOGE='such variable'
el@server /home/el $ env | grep DOGE
DOGE=such variable 
```

请注意，导出使其同时显示为局部变量和环境变量。

上面导出的变量 DOGE 在 Bash 重置后仍然存在：

```
el@server /home/el $ exec bash
el@server /home/el $ env | grep DOGE
DOGE=such variable
el@server /home/el $ set | grep DOGE
DOGE='such variable' 
```

**取消设置所有环境变量：**

您必须拿出一罐 Chuck Norris 来重置所有环境变量，而无需注销/登录：

```
el@server /home/el $ export CAN="chuck norris"
el@server /home/el $ env | grep CAN
CAN=chuck norris
el@server /home/el $ set | grep CAN
CAN='chuck norris'
el@server /home/el $ env -i bash
el@server /home/el $ set | grep CAN
el@server /home/el $ env | grep CAN 
```

您创建了一个环境变量，然后重置终端以摆脱它们。

**或者您可以像这样手动设置和取消设置环境变量：**

```
el@server /home/el $ export FOO="bar"
el@server /home/el $ env | grep FOO
FOO=bar
el@server /home/el $ unset FOO
el@server /home/el $ env | grep FOO
el@server /home/el $ 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-24T18:47:42.323

`VAR=value`将 VAR 设置为值。

之后也`export VAR`将其提供给子进程。

`export VAR=value`是两者兼而有之的速记。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-24T18:28:54.090

我认为您正在寻找`export`-尽管我可能是错的..我以前从未玩过tcsh。使用以下语法：

```
export VARIABLE=value 
```

# .net - ASP.NET 2.0 IIS 设置

> ID：234773
> 
> 赞同：2
> 
> 时间：2008-10-24T18:34:18.247
> 
> 标签：.net, asp.net, iis

下午好，

这应该是一件容易的事。我已经完成了千篇一律的默认 ASP.NET 2.0 安装，但我的应用程序中有几个编程错误。

当我访问服务器本身的网页时，我会收到详细的 ASP 错误消息。但是，当我尝试从客户端机器上运行相同的东西时，我只会得到一个没有任何异常细节的非描述性 500 错误。

如何将如此详细的异常消息发送到远程客户端？

问候，艾伦。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-24T18:35:45.497

将[CustomErrors](http://msdn.microsoft.com/en-us/library/h0hfz6fc.aspx)模式设置为关闭。我希望这不适用于面向公众的网站。

Off - 指定禁用自定义错误。详细的 ASP.NET 错误会显示给远程客户端和本地主机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T18:36:50.813

你不想那样做。它违反了安全惯例。

试想一下，当您的源代码和应用程​​序版本（以及其他内容）显示在屏幕上时，您对攻击者的攻击变得多么容易。

# .net - .NET 消息框中的自定义按钮标题？

> ID：234774
> 
> 赞同：21
> 
> 时间：2008-10-24T18:34:20.010
> 
> 标签：.net, vb.net, winforms, messagebox

有没有一种简单的方法可以在 VB.NET 中显示带有自定义按钮标题的消息框？我遇到*[了在托管 C++ 中创建带有自定义按钮文本的 MessageBox 的简单方法是什么？](https://stackoverflow.com/questions/77293/what-is-an-easy-way-to-create-a-messagebox-with-custom-button-text-in-managed-c)*，在堆栈溢出档案中，但它适用于[托管 C++](http://en.wikipedia.org/wiki/Managed_Extensions_for_C%2B%2B)。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-24T22:37:59.330

MessageBox 使用一个普通的窗口，它可以像任何其他窗口一样被弄乱。这在 Windows 中已经实现了很长时间，已经超过 20 年了。然而，这些技术变得晦涩难懂，太多友好的类包装器隐藏了本机 winapi 并且没有暴露你可以用它做的所有事情。如此之多，以至于程序员现在自动假设这是不可能的，正如您可以从赞成的答案中看出的那样。这是 Petzold 在其开创性的“Programming Windows”一书中教给我们的那种编程。用自定义的 Form 或 Window 替换 MessageBox 实际上是相当困难的，它会自动布局以适应文本并在没有帮助的情况下支持本地化。虽然这正是你似乎不喜欢的:)

Anyhoo，消息框窗口很容易找回。它由 UI 线程拥有，并具有使其独一无二的特殊类名。EnumThreadWindows() 枚举线程拥有的窗口，GetClassName() 让您检查窗口的类型。然后只需使用 SetWindowText() 将文本插入按钮。

向您的项目添加一个新类并粘贴如下所示的代码。使用如下代码调用它：

```
Nobugz.PatchMsgBox(New String() {"Da", "Njet"})
MsgBox("gack", MsgBoxStyle.YesNo) 
```

这是代码：

```
Imports System.Text
Imports System.Runtime.InteropServices

Public Class Nobugz
  Private Shared mLabels() As String    '' Desired new labels
  Private Shared mLabelIndex As Integer '' Next caption to update

  Public Shared Sub PatchMsgBox(ByVal labels() As String)
    ''--- Updates message box buttons
    mLabels = labels
    Application.OpenForms(0).BeginInvoke(New FindWindowDelegate(AddressOf FindMsgBox), GetCurrentThreadId())
  End Sub

  Private Shared Sub FindMsgBox(ByVal tid As Integer)
    ''--- Enumerate the windows owned by the UI thread
    EnumThreadWindows(tid, AddressOf EnumWindow, IntPtr.Zero)
  End Sub

  Private Shared Function EnumWindow(ByVal hWnd As IntPtr, ByVal lp As IntPtr) As Boolean
    ''--- Is this the message box?
    Dim sb As New StringBuilder(256)
    GetClassName(hWnd, sb, sb.Capacity)
    If sb.ToString() <> "#32770" Then Return True
    ''--- Got it, now find the buttons
    mLabelIndex = 0
    EnumChildWindows(hWnd, AddressOf FindButtons, IntPtr.Zero)
    Return False
  End Function

  Private Shared Function FindButtons(ByVal hWnd As IntPtr, ByVal lp As IntPtr) As Boolean
    Dim sb As New StringBuilder(256)
    GetClassName(hWnd, sb, sb.Capacity)
    If sb.ToString() = "Button" And mLabelIndex <= UBound(mLabels) Then
      ''--- Got one, update text
      SetWindowText(hWnd, mLabels(mLabelIndex))
      mLabelIndex += 1
    End If
    Return True
  End Function

  ''--- P/Invoke declarations
  Private Delegate Sub FindWindowDelegate(ByVal tid As Integer)
  Private Delegate Function EnumWindowDelegate(ByVal hWnd As IntPtr, ByVal lp As IntPtr) As Boolean
  Private Declare Auto Function EnumThreadWindows Lib "user32.dll" (ByVal tid As Integer, ByVal callback As EnumWindowDelegate, ByVal lp As IntPtr) As Boolean
  Private Declare Auto Function EnumChildWindows Lib "user32.dll" (ByVal hWnd As IntPtr, ByVal callback As EnumWindowDelegate, ByVal lp As IntPtr) As Boolean
  Private Declare Auto Function GetClassName Lib "user32.dll" (ByVal hWnd As IntPtr, ByVal name As StringBuilder, ByVal maxlen As Integer) As Integer
  Private Declare Auto Function GetCurrentThreadId Lib "kernel32.dll" () As Integer
  Private Declare Auto Function SetWindowText Lib "user32.dll" (ByVal hWnd As IntPtr, ByVal text As String) As Boolean
End Class 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-24T18:49:32.957

不可以。
您必须使用`FormBorderType = FixedDialog`.
这是一个小教程：

# 在 .NET 中创建对话框

**James D. Murray 于 2007 年 6 月 12 日，在 70-526 下**

*Microsoft 认证考试：70-526 (MCTS)
目标：在 Windows 窗体应用程序中创建和使用自定义对话框。
语言：Visual Basic 2005（点击此处查看本条目的 C# 版本）*

我记得我第一次需要在我用 C# 编写的 .NET 应用程序中创建一个对话框。作为一名资深的 Visual Basic 程序员，我认为这可以通过使用 Visual Studio.NET 中包含的对话框模板轻松完成。令我惊讶的是，C# 没有这样的表单模板，尽管 Visual Basic 2005 有。在翻阅了几本关于 Windows Forms 2.0 编程信息的书籍和网页后，一组基本步骤对我来说变得很明显，用于手动转换.NET 窗体进入 Windows 对话框：

第 1 步：向您的 .NET 项目添加一个表单并将其命名为“DialogBoxForm”。

第 2 步：将两个按钮放在表单的右下方区域，并将它们命名为“OKButton”和“CancelButton”。

第 3 步：更改 Form 的以下属性以将其外观和行为调整为类似于标准对话框：

```
    属性值说明
    -------------------------------------------------- -------------------------------------------------- -------------------------
    AcceptButton OK 按钮实例 使表单返回 DialogResult.OK 值。仅用于模式对话框。
    CancelButton 取消按钮实例 使表单返回值DialogResult.Cancel。仅用于模式对话框。
    FormBorderStyle FixedDialog 创建一个在标题栏上没有控制框的大小不一的表单。
    HelpButton True 帮助按钮出现在关闭按钮旁边的标题栏中。ControlBox 属性必须为 True 才能使这些按钮可见。
    MaximizeBox False 隐藏标题栏中的最大化按钮。
    MinimizeBox False 隐藏标题栏中的最小化按钮。
    ShowIcon False 标题栏图标在对话框中不可见。
    ShowInTaskBar False 不指示窗体在 Windows 任务栏上的存在。
    起始位置 CenterParent 对话框的初始位置在其父窗体之上。
    所需大小 对话框所需的固定大小。

```

可以使用表单的“属性”窗口或使用放置在表单的 Load 事件中的代码来设置这些属性：

```
 Me.AcceptButton = OKButton
    Me.CancelButton = CancelButton
    Me.FormBorderStyle = Windows.Forms.FormBorderStyle.FixedDialog
    Me.HelpButton = True
    Me.MaximizeBox = False
    Me.MinimizeBox = False
    Me.ShowInTaskbar = False
    Me.ShowIcon = False
    Me.StartPosition = FormStartPosition.CenterParent 
```

第 4 步：将以下按钮单击事件处理程序添加到表单：

```
    Private Sub OKButton_Click(ByVal sender As Object, _ByVal e As EventArgs)
        ' 用户点击确定按钮
        Me.DialogResult = Windows.Forms.DialogResult.OK
    结束子

    Private Sub CancelButton_Click(ByVal sender As Object, _ByVal e As EventArgs)
        ' 用户点击取消按钮
        Me.DialogResult = Windows.Forms.DialogResult.Cancel
    结束子

```

第 5 步：添加您需要将数据移入和移出对话框的属性，就像对任何表单一样：

```
    私有 _LoginName 作为字符串
    私有 _LoginPassword 作为字符串

    公共属性 LoginName() 作为字符串
        得到
            返回_登录名
        结束获取
        设置（ByVal 值作为字符串）
            _LoginName = 值
        结束集
    结束属性

    公共属性 LoginPassword() 作为字符串
        得到
            返回_登录密码
        结束获取
        设置（ByVal 值作为字符串）
            _LoginPassword = 值
        结束集
    结束属性

```

第 6 步：通过调用表单的 ShowDialog() 以模态方式显示对话框：

```
    公共子 ShowDialogBox()
        暗淡对话框作为新的 DialogBoxForm

        dialog.LoginName = "JDMurray"
        dialog.LoginPassword = String.Empty

        如果 dialog.ShowDialog() = Windows.Forms.DialogResult.OK 那么
            Debug.WriteLine("登录名：" & dialog.LoginName)
            Debug.WriteLine("密码：" & dialog.LoginPassword)
        别的
            ' 用户点击取消按钮
        万一
    结束子

```

第 7 步：要无模式地显示对话框，请调用 DialogBoxForm 的 Show() 方法。您需要向 DialogBoxForm 的 Close 事件添加一个事件处理程序，以了解用户何时关闭对话框：

```
    公共子 ShowDialogBox()
        暗淡对话框 As DialogBoxForm = New DialogBoxForm
        dialog.LoginName = "JDMurray"
        dialog.Password = String.Empty
        AddHandler dialog.FormClosed, AddressOf dialog_FormClosed
        对话框.Show()

        ' Show() 方法立即返回
    结束子

    Private Sub dialog_FormClosed(ByVal sender As Object, _

     ByVal e As FormClosedEventArgs)
        ' 当用户关闭对话框时调用此方法
    结束子

```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-24T19:02:26.223

不，没有方法可以访问或重定向消息框的默认按钮文本。

做到这一点的唯一方法是编写自己的代码，或者只使用互联网上许多免费的代码之一：

[免费 MsgBoxGo！](http://www.componentgo.com/Load.aspx?file=Downloads/MsgBoxSetup.msi&log=MSGBOX)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-16T23:38:07.283

有一个解决方案。通过安装 CBT 挂钩，可以即时调整各种 MessageBox 视觉设置：消息和按钮字体、对话框背景、对话框定位、图标、按钮标题、超时，甚至插入其他控件。

完整的解决方案：扩展 MessageBox .NET 程序集 [http://www.news2news.com/vfp/?solution=5](http://www.news2news.com/vfp/?solution=5)

它是一个功能齐全的试用版，普通版包含完整的 C# 源代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-09T17:29:04.023

Daniel Nolan 的解决方案，VB.Net 中的代码

```
<DllImport("kernel32.dll")> _
Private Shared Function GetCurrentThreadId() As UInteger
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function CallNextHookEx(ByVal idHook As Integer, ByVal nCode As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Integer
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function UnhookWindowsHookEx(ByVal idHook As Integer) As Boolean
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Function SetWindowsHookEx(ByVal idHook As Integer, ByVal lpfn As HookProc, ByVal hInstance As IntPtr, ByVal threadId As Integer) As Integer
End Function

<DllImport("user32.dll")> _
Private Shared Function SetDlgItemText(ByVal hWnd As IntPtr, ByVal nIDDlgItem As Integer, ByVal lpString As String) As Boolean
End Function

Private Delegate Function HookProc(ByVal nCode As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Integer

Shared dlgHookProc As HookProc

Private Const WH_CBT As Long = 5
Private Const HCBT_ACTIVATE As Long = 5

Private Const ID_BUT_OK As Integer = 1
Private Const ID_BUT_CANCEL As Integer = 2
Private Const ID_BUT_ABORT As Integer = 3
Private Const ID_BUT_RETRY As Integer = 4
Private Const ID_BUT_IGNORE As Integer = 5
Private Const ID_BUT_YES As Integer = 6
Private Const ID_BUT_NO As Integer = 7

Private Const BUT_OK As String = "Save"
Private Const BUT_CANCEL As String = "Cancelar"
Private Const BUT_ABORT As String = "Stop"
Private Const BUT_RETRY As String = "Continue"
Private Const BUT_IGNORE As String = "Ignore"
Private Const BUT_YES As String = "Si"
Private Const BUT_NO As String = "No"

Private Shared _hook As Integer = 0

Private Shared Function DialogHookProc(ByVal nCode As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Integer
  If nCode < 0 Then
    Return CallNextHookEx(_hook, nCode, wParam, lParam)
  End If

  If nCode = HCBT_ACTIVATE Then
    SetDlgItemText(wParam, ID_BUT_OK, BUT_OK)
    SetDlgItemText(wParam, ID_BUT_CANCEL, BUT_CANCEL)
    SetDlgItemText(wParam, ID_BUT_ABORT, BUT_ABORT)
    SetDlgItemText(wParam, ID_BUT_RETRY, BUT_RETRY)
    SetDlgItemText(wParam, ID_BUT_IGNORE, BUT_IGNORE)
    SetDlgItemText(wParam, ID_BUT_YES, BUT_YES)
    SetDlgItemText(wParam, ID_BUT_NO, BUT_NO)
  End If

  Return CallNextHookEx(_hook, nCode, wParam, lParam)
End Function

Private Sub btn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btn.Click
  dlgHookProc = New HookProc(AddressOf DialogHookProc)

  _hook = SetWindowsHookEx(CInt(WH_CBT), dlgHookProc, IntPtr.op_Explicit(0), CInt(GetCurrentThreadId()))

  Dim dlgEmptyCheck As DialogResult = MessageBox.Show("Text", "Caption", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Exclamation, MessageBoxDefaultButton.Button3)

  If dlgEmptyCheck = DialogResult.Abort Then
  End If

  UnhookWindowsHookEx(_hook)
End Sub 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T19:10:37.830

可以在 MSDN 论坛下的一篇文章中找到完成相同操作的 C# 代码，[https:](https://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3087899&SiteID=1) //forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3087899&SiteID=1 。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-22T08:26:41.977

将此添加到您希望从中显示对话框的按钮。这是一个自定义表单messageBox；

```
 private void DGroup_Click(object sender, EventArgs e)
    {
        messageBox m = new messageBox();
        m.ShowDialog();
        if (m.DialogResult == DialogResult.Yes)
        {
            //del(groups.php?opt=del&amp;id=613','asdasd');
            String[] asd = new String[2];
            asd[0] = "groups.php?opt=del&amp;id=613";
            asd[1] = "asdasd";
            addgroup.Document.InvokeScript("del",asd);
        }
        else
            if (m.DialogResult == DialogResult.No)
            {
                MessageBox.Show("App won´t close");
            }
    } 
```

将此代码添加到消息框。

```
 private void deleteGroupOnly_Click(object sender, EventArgs e)
    {
        this.DialogResult = DialogResult.Yes;
        this.Close();
    }

    private void deleteAll_Click(object sender, EventArgs e)
    {
        this.DialogResult = DialogResult.No;
        this.Close();
    }

    private void cancel_Click(object sender, EventArgs e)
    {
        this.DialogResult = DialogResult.Cancel;
        this.Close();
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-15T11:39:17.890

这是一个 C# 片段，它使用 Win32 挂钩来更改按钮标题（来自[http://icodesnip.com/snippet/csharp/custom-messagebox-buttons](http://icodesnip.com/snippet/csharp/custom-messagebox-buttons)）：

```
 [DllImport("kernel32.dll")]
        static extern uint GetCurrentThreadId();

        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern int CallNextHookEx(int idHook, int nCode, IntPtr wParam, IntPtr lParam);

        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern bool UnhookWindowsHookEx(int idHook);

        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern int SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, int threadId);

        [DllImport("user32.dll")]
        private static extern bool SetDlgItemText(IntPtr hWnd, int nIDDlgItem, string lpString);

        delegate int HookProc(int nCode, IntPtr wParam, IntPtr lParam);

        static HookProc dlgHookProc;

        private const long WH_CBT = 5;
        private const long HCBT_ACTIVATE = 5;

        private const int ID_BUT_OK = 1;
        private const int ID_BUT_CANCEL = 2;
        private const int ID_BUT_ABORT = 3;
        private const int ID_BUT_RETRY = 4;
        private const int ID_BUT_IGNORE = 5;
        private const int ID_BUT_YES = 6;
        private const int ID_BUT_NO = 7;

        private const string BUT_OK = "Save";
        private const string BUT_CANCEL = "Cancel";
        private const string BUT_ABORT = "Stop";
        private const string BUT_RETRY = "Continue";
        private const string BUT_IGNORE = "Ignore";
        private const string BUT_YES = "Yeeh";
        private const string BUT_NO = "Never";

        private static int _hook = 0;

        private static int DialogHookProc(int nCode, IntPtr wParam, IntPtr lParam)
        {
            if (nCode < 0)
            {
                return CallNextHookEx(_hook, nCode, wParam, lParam);
            }

            if (nCode == HCBT_ACTIVATE)
            {
                SetDlgItemText(wParam, ID_BUT_OK, BUT_OK);
                SetDlgItemText(wParam, ID_BUT_CANCEL, BUT_CANCEL);
                SetDlgItemText(wParam, ID_BUT_ABORT, BUT_ABORT);
                SetDlgItemText(wParam, ID_BUT_RETRY, BUT_RETRY);
                SetDlgItemText(wParam, ID_BUT_IGNORE, BUT_IGNORE);
                SetDlgItemText(wParam, ID_BUT_YES, BUT_YES);
                SetDlgItemText(wParam, ID_BUT_NO, BUT_NO);
            }

            return CallNextHookEx(_hook, nCode, wParam, lParam);
        }

        private void Button_Click(object sender, EventArgs e)
        {
            dlgHookProc = new HookProc(DialogHookProc);

            _hook = SetWindowsHookEx((int)WH_CBT, dlgHookProc, (IntPtr)0, (int)GetCurrentThreadId());

            DialogResult dlgEmptyCheck = MessageBox.Show("Text", "Caption", MessageBoxButtons.AbortRetryIgnore, MessageBoxIcon.Exclamation, MessageBoxDefaultButton.Button3);

            if (dlgEmptyCheck == DialogResult.Abort)
            {

            }

            UnhookWindowsHookEx(_hook);
        } 
```

# c# - '^' 在 c#（枚举）中做了什么？

> ID：234776
> 
> 赞同：10
> 
> 时间：2008-10-24T18:34:30.290
> 
> 标签：c#, enums, operators

我正在阅读一些第 3 方代码，我发现了这个：

```
x.Flags = x.Flags ^ Flags.Hidden; 
```

它有什么作用？

我用过'&'和'|' 对于带有枚举的按位“和”和“或”，但这是我第一次看到那个符号......

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-24T18:37:07.647

^ 是 C# 中的按位异或运算符。

编辑：如果 a 为真且 b 为假，或者 a 为假且 b 为真，则 a ^ b 返回真，但不是两者兼而有之。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-24T18:40:31.183

那将是“异或”运算符。在您的示例代码中，它将根据 x.Flags 的当前值打开或关闭 Flags.Hidden。

这样做的好处是它允许您更改 Flags.Hidden 的设置，而不会影响已设置的任何其他标志。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T18:37:57.707

取自[这里](http://msdn.microsoft.com/en-us/library/zkacc7k1(VS.71).aspx)：

> 对于整数类型，^ 计算其操作数的按位异或。对于 bool 操作数，^ 计算其操作数的逻辑异或；也就是说，当且仅当**奇数个**操作数为真时，结果才为真。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-24T18:38:31.513

这是异或（XOR）运算符，此链接有示例用法

[http://weblogs.asp.net/alessandro/archive/2007/10/02/bitwise-operators-in-c-or-xor-and-amp-amp-not.aspx](http://weblogs.asp.net/alessandro/archive/2007/10/02/bitwise-operators-in-c-or-xor-and-amp-amp-not.aspx)

# c# - 当 TIBCO EMS 服务器尝试故障转移时，客户端应该做什么？

> ID：234782
> 
> 赞同：3
> 
> 时间：2008-10-24T18:35:53.733
> 
> 标签：c#, tibco, tibco-ems, ems

TIBCO EMS 用户指南（第 292 页）说：

> 备份服务器**将无限期地工作**以 A) 成为主服务器或 B) 重新连接到主服务器。它还说 ，当切换成功时，**客户端可能会收到故障转移通知**（另请参阅 TIBCO EMS .NET 参考第 220 页）。

我有一些问题来自这些事实......

1.  当服务器尝试故障转移/重新连接时，客户端会发生什么样的错误？

2.  客户的适当回应是什么？

    *   从 ConnectionFactory 获取新的 Connection 对象，直到一个工作？
    *   等待故障转移通知？（此时当前的 Connection 实例是否已修复？还是我需要获取一个新实例？）

我希望情况很清楚，任何相关的信息或建议也将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T20:00:16.763

我至少可以回答上面的＃1。

如果您启用了 Tibems.SetExceptionOnFTSwitch(true); 并设置了一个异常处理程序来捕获服务器发送给客户端的消息，您将看到以下内容：

对于单服务器、非容错连接失败：“连接已终止”。

对于容错连接失败：“连接已执行容错切换到”

如果您在连接断开时尝试发布，则会引发 TIBCO.EMS.IllegalStateException 并显示“生产者已关闭”消息。

for #2 above, I think the answer is to allow the EMS library to handle as much as possible. Once we got the EMS reconnect functionality to work, it gracefully tried to reconnect until the server became available again and once it reconnected, it was like there was never a problem. The only gotcha is probably if you try to publish a message before the ems connection is back. This is where the exception handler comes in, Once notified that you are in failover mode, you can adjust exception handling on the publisher side to suppress the error until the connection is back. The thing I don't know is how do you tell when you've exhausted all reconnect attempts.

Anyway, Seems like our two worlds are closely related when it comes to EMS - hope our findings (based on your comments on my questions) help you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-25T04:48:12.410

We use TEMS (Tibco EMS - a Tibco Product for WCF) So it becomes a custom binding. We tried to break it by doing things like bounce the server to force switch overs and it works really well. make sure you are using version 1.2 not 1.1 because you cannot do anything other then client acknowledgement.

# tdd - 如何将软件商店转换为 TDD？

> ID：234783
> 
> 赞同：10
> 
> 时间：2008-10-24T18:35:55.607
> 
> 标签：tdd

我真的很想在我工作的商店内推动 TDD 开发。那里的许多前辈没有从事过单元测试，也没有做过涉及数据库的单元测试。

我很想带来一些好的论据、培训书籍、可能的教练来缓解过渡。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-24T18:41:11.977

我发现通常很难从开发人员那里推动 TDD。我倾向于做的是尽可能多地谈论TDD的好处，并在可能的情况下，自己一点一点地介绍TDD的元素。

如果他们不介意，就开始一个包含单元测试的新项目（经理很少介意更多的测试覆盖率），然后自己开始开发。慢慢地向团队的其他成员展示好处，并尝试赢得一些皈依者。一旦你身边有一些其他开发人员，就开始推动管理人员进行一些培训。

您还可以为其他开发人员提供一些关于它的午餐学习。教学是最好的学习方式，您将有望获得盟友。如果你幸运的话，你可以说服你的老板为午餐学习买披萨，这样每个人都会受益。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T18:46:54.740

就像 Rob P 说的那样——我还发现讲道以嘶哑的声音结束了我，没有人在听。通过这样做并保持该部分可见，我可以更快、更广泛地获得结果。对质疑持开放态度，不要强迫它。鼓励和赞美，但不要说教。

将它与发布您的测试结果结合起来——并让它自动化——你也许可以发送一封电子邮件。您需要许多微妙的提醒来向人们展示您的方法有多好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-24T18:48:01.527

我认为将 TDD 原则潜入现有产品的一个好方法是开始为错误编写单元测试。通过这种方式，您慢慢开始构建一组用于回归测试的单元测试，这些单元测试成为项目不可或缺的一部分，特别是如果您可以让它们作为构建过程的一部分运行。

唯一的障碍是现有代码可能无法测试，但这只是进行重构的另一个借口。

一旦人们开始意识到好处，势头就会增长，但你需要开拓道路。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-29T16:09:26.187

虽然我不能告诉你什么会起作用，但我可以告诉你一些肯定不会起作用并且应该避免的事情：

**我写代码，你写测试**

这总是首先出现。人们认为，既然您对测试如此热衷，那么您应该是编写测试的人。这根本不起作用，并且错过了重点。

**您编写了破坏性的测试，因此您必须修复它。**

如果您开始为您的代码编写测试，则不可避免地会有其他人破坏这些测试。然后，如果您要求他们修复它，他们通常会说这是您的责任。这不一定是他们是个混蛋，可能只是他们不了解这个过程。这是您需要管理备份的地方。

**我就开始吧，大家都跟着。**

正如其他人所说，没有管理支持的 TDD 非常困难。如果有任何开发人员不“喝 Cool-Aid”，那么他们将不断地破坏您的测试并且不在乎。如果你不能让他们相信，那么你需要管理层告诉他们这是他们的工作。

最终让我兴奋的是，看到一个项目由于太多的错误而崩溃。它使我确信我做的事情根本上是错误的。一项小小的研究让我接触到了自动化测试，并带着一点决心自学了基础知识。也许与您的开发人员同事讨论类似的项目（我们都至少有一个......）将帮助他们意识到他们可能想尝试一些新的东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-30T15:56:26.553

**以身作则**：

*   在您编写的所有代码上使用 TDD
*   一有机会就向他们展示好处（单元测试检测到的回归或在单元测试环境中重新创建的事件）
*   提供“有效的干净代码”
*   向他人提出您的帮助
*   不要教条主义 - TDD 不是灵丹妙药
*   使您的单元测试可见：它们应该与测试的代码一起编译

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T18:44:13.157

如果项目没有足够的单元测试，您可以指出问题数据库中的错误，如果有单元测试，这些错误可能会被避免。

至于推动 TDD 或其他一些代码宗教，请不要打扰。

对于某些人（以及某些类型的代码）来说，TDD 很棒。有些人不那样工作，也不会从测试优先中受益。只要他们不完全避免测试，我认为这并不重要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T19:25:13.090

“自下而上”带来的 TDD 的一个巨大挑战是，当迫在眉睫时（就像最后期限临近时不可避免的那样），管理层将忽略对测试的重视：“我们负担不起测试！我们必须完成这个项目！

当然，这正是 TDD 的好处真正发挥作用的情况（最后期限迫在眉睫，大量积压，进度未按承诺进行，导致优先级和任务迅速转移）。管理压倒它，项目/迭代开始以同样的方式分崩离析，管理层回头说：“我们尝试了 TDD，但它根本没有帮助。”

# php - 在 Zend Framework 中自动连接表而不破坏默认行为

> ID：234785
> 
> 赞同：7
> 
> 时间：2008-10-24T18:36:09.507
> 
> 标签：php, zend-framework

情况如下：我有2个模型：'Action'和'User'。这些模型分别引用表“操作”和“用户”。

我的操作表包含一列`user_id`。此时，我需要对所有操作以及分配给它们的用户进行概览。当我使用`$action->fetchAll()`时，我只有用户 ID，所以我希望能够从用户模型中加入数据，最好不要调用`findDependentRowset()`.

我考虑过在我的模型中创建 custom`fetchAll()`和方法`fetchRow()`，`find()`但这会破坏默认行为。

解决此问题的最佳方法是什么？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-26T01:18:51.507

我在 Zend Framework 中设计并实现了表关系特性。

我的第一条评论是`findDependentRowset()`无论如何你都不会使用——`findParentRow()`如果 Action 有对 User 的外键引用，你会使用。

```
$actionTable = new Action();
$actionRowset = $actionTable->fetchAll();
foreach ($actionRowset as $actionRow) {
  $userRow = $actionRow->findParentRow('User');
} 
```

**编辑：** 在循环中，您现在有一个 $actionRow 和一个 $userRow 对象。您可以通过更改对象字段并调用对象，通过任一对象将更改写回数据库`save()`。

您还可以使用 Zend_Db_Table_Select 类（在我离开项目后实现）来检索基于 Action 和 User 之间的连接的 Rowset。

```
$actionTable = new Action();
$actionQuery = $actionTable->select()
  ->setIntegrityCheck(false) // allows joins
  ->from($actionTable)
  ->join('user', 'user.id = action.user_id');
$joinedRowset = $actionTable->fetchAll($actionQuery);
foreach ($joinedRowset as $joinedRow) {
  print_r($joinedRow->toArray());
} 
```

请注意，这种基于连接查询的 Rowset 是只读的。您不能在 Row 对象中设置字段值并调用`save()`将更改发布回数据库。

**编辑：**没有办法使任意连接的结果集可写。考虑一个基于上述连接结果集的简单示例：

```
action_id  action_type  user_id  user_name
   1          Buy          1       Bill
   2          Sell         1       Bill
   3          Buy          2       Aron
   4          Sell         2       Aron 
```

接下来对于 action_id=1 的行，我更改了来自 User 对象的字段之一：

```
$joinedRow->user_name = 'William';
$joinedRow->save(); 
```

问题：当我查看 action_id=2 的下一行时，我应该看到“Bill”还是“William”？如果是“William”，这是否意味着保存第 1 行必须在此结果集中的所有其他行中自动将“Bill”更新为“William”？或者这是否意味着`save()`自动重新运行 SQL 查询以从数据库中获取刷新的结果集？如果查询很耗时怎么办？

还要考虑面向对象的设计。每行都是一个单独的对象。调用`save()`一个对象是否具有改变单独对象中值的副作用（即使它们是同一对象集合的一部分）？对我来说，这似乎是一种[内容耦合](http://en.wikipedia.org/wiki/Coupling_(computer_science))形式。

上面的示例是一个相对简单的查询，但也允许更复杂的查询。Zend_Db 无法分析查询以区分可写结果和只读结果。这也是 MySQL 视图不可更新的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T21:08:07.000

您始终可以在数据库中创建一个视图来为您执行连接。

```
CREATE OR REPLACE VIEW VwAction AS
SELECT [columns]
  FROM action
  LEFT JOIN user
    ON user.id = action.user_id 
```

然后只需使用

```
$vwAction->fetchAll(); 
```

请记住 MySQL 中的视图是只读的（假设这是 MySQL）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-27T14:06:16.210

创建视图 sql 表不是一个很好的联合解决方案吗？并在一个简单的表类之后访问它

我认为如果你的逻辑在 sql 中比在 php 中更好

# database-design - 用于标记、云和搜索的最佳数据架构（如 StackOverflow）？

> ID：234796
> 
> 赞同：39
> 
> 时间：2008-10-24T18:38:33.120
> 
> 标签：database-design, tags, full-text-search, tag-cloud

我很想知道 Stack Overflow 的标记和搜索是如何构建的，因为它似乎工作得很好。

如果我想做以下所有事情，什么是好的数据库/搜索模型：

1.  在各种实体上存储标签，（标准化程度如何？即实体、标签和实体标签表？）
    *   搜索具有特定标签的项目
    *   构建适用于特定**搜索结果集的所有标签的标签云**
    *   如何在搜索结果中显示每个项目的标签列表？

也许将标签以标准化形式存储是有意义的，但也可以作为空格分隔的字符串用于#2、#4 和#3 的目的。想法？

我听说 Stack Overflow 使用 Lucene 进行搜索。真的吗？我听过一些讨论 SQL 优化的播客，但没有关于 Lucene 的内容。如果他们确实使用 Lucene，我想知道有多少搜索结果来自 Lucene，以及“向下钻取”标签云是否来自 Lucene。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-28T19:44:18.967

哇，我刚写了一篇大文章，就这么哽咽着挂在上面，当我点击后退按钮重新提交时，标记编辑器是空的。啊啊啊

所以我又来了……

关于 Stack Overflow，原来他们使用[SQL server 2005 全文搜索](https://stackoverflow.com/questions/115831/what-is-the-search-engine-behind-stack-overflow)。

关于@Grant 推荐的操作系统项目：

*   ***DotNetKicks**使用 DB 进行标记，使用 Lucene 进行全文搜索。似乎没有办法将全文搜索与标签搜索结合起来
*   **Kigg**使用 Linq-to-SQL 进行搜索和标签查询。两个查询都加入了 Stories->StoryTags->Tags。
*   这两个项目都有一个 3-table 方法来标记，因为每个人似乎都普遍推荐

我还发现了一些我之前错过的关于 SO 的其他问题：

*   [您如何建议实施标签或标记？](https://stackoverflow.com/questions/20856/how-do-you-recommend-implementing-tags-or-tagging)
*   [如何为可搜索性构建数据？](https://stackoverflow.com/questions/185597/how-to-structure-data-for-searchability)
*   [用于标记的数据库设计](https://stackoverflow.com/questions/48475/database-design-for-tagging)

我目前正在为我提到的每个项目做的事情：

1.  在数据库中，3 个表：Entity、Tag、Entity_Tag。我使用数据库：
    *   构建站点范围的标签云
    *   按标签浏览（即像 SO's */questions/tagged/ASP.NET*这样的 URL ）
2.  对于搜索，我使用 Lucene + NHibernate.Search
    *   标签被连接成一个由 Lucene 索引的 TagString
        *   所以我拥有了 Lucene 查询引擎的全部功能（AND/OR/NOT 查询）
        *   我可以同时搜索文本*和*按标签过滤
        *   Lucene 分析器合并单词以获得更好的标签搜索（例如，“test”的标签搜索也会找到标记为“testing”的东西）
    *   Lucene 返回一个潜在的巨大结果集，我将其分页为 20 个结果
    *   然后 NHibernate 通过 Id 从数据库或实体缓存中加载结果实体
    *   因此，搜索结果完全有可能对数据库产生 0 次点击
3.  还没有这样做，但我想我可能会尝试找到一种方法来从 Lucene 中的 TagString 构建标签云，而不是再进行一次数据库攻击
4.  还没有这样做，但我可能会将 TagString 存储在数据库中，这样我就可以显示实体的标记列表，而无需再进行 2 次连接。

这意味着每当修改实体的标签时，我必须：

*   插入任何尚不存在的新标签
*   从 EntityTag 表中插入/删除
*   更新 Entity.TagString
*   更新实体的 Lucene 索引

鉴于在我的应用程序中读取与写入的比率非常大，我认为我可以接受。唯一真正耗时的部分是 Lucene 索引，因为 Lucene 只能从其索引中*插入*和*删除*，所以我必须重新索引整个实体才能更新 TagString。我对此并不感到兴奋，但我认为如果我在后台线程中执行此操作，那就没问题了。

时间会告诉我们...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-25T14:27:42.477

我不知道它们是否符合最佳条件，但 DotNetKicks 和 Kigg 都是开源 digg 克隆实现。你可以看看他们是如何做标签和搜索的。

我最好的猜测没有经过深思熟虑:)

1.  我从不喜欢将多个值序列化到一个字段中的想法，因此存储在一个字段中的分隔字符串对我没有吸引力……可能适用于具有树的邻接路径，但这些路径始终是有序的，标签不需要。这似乎会对您可能为找到它们所做的 LIKE 操作员工作增加负担。

所以我最初的想法可能是 Entity -> EntityTag <- Tag。

2.  这种方法使通过 Tag 查找项目变得非常容易，通过 EntityTag 重新加入，收工。

3.  您需要在此处进行辅助操作来为结果集选择不同的标签。所以 a.) 拉取结果集，b.) 规范化标签空间。我认为无论#1 的答案是什么，你都会这样做——即使将标签填充到一个字段中仍然会产生重复的标签（并且你必须对它们进行反序列化才能执行此操作——因此需要更多的工作，这是完全关系的另一个论点方法）。

4.  还是很轻松的。这是序列化方法效果更好的一个领域。无需加入子标签，它就在实体中。也就是说，通过两个表连接提取 0..n 个标签对我来说似乎并不太具有挑战性。如果您正在谈论性能考虑，请先将其标准化，然后通过缓存或 denorm 进行优化。

另一种选择是“两者都做”。这感觉像是过早的优化，但您可以使用完全规范化的方法来支持任何以标签为中心的操作并在持久化后序列化以在实体中拥有非规范化版本。更多的工作，如果没有完全覆盖，一些可能会失去同步，但如果在您的用例中对完全标准化的方式存在真正的限制，那么两全其美。

Lucene 也很有趣，您可以在索引 IIRC 中声明特定的元数据，因此您也可以通过这种方式利用标签搜索。我的怀疑是，如果你在这条路上走得太远，那么你最终会在数据库中存储的内容与索引之间出现一些断开连接。我可以说 Lucene，它功能强大且易于使用——我相信 .Text 使用它是因为它的搜索功能，并且在切换到社区服务器之前它支持所有 weblogs.asp.net。如果 MSSQL 不在图片中/足够，我会坚持使用它进行全文搜索，解决数据库 imo 中的标签问题。

# regex - sed 中的正则表达式

> ID：234797
> 
> 赞同：10
> 
> 时间：2008-10-24T18:38:54.447
> 
> 标签：regex, sed

我需要使用 sed 将所有出现的 ##XXX## 转换为 ${XXX}。X 可以是任何字母字符或“_”。我知道我需要使用类似的东西：

```
's/##/\${/g' 
```

但当然这不会正确，因为它会将 ##FOO## 转换为 ${FOO${

有接盘侠吗？- 大学教师

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-24T18:45:16.990

这是一个更好的替换正则表达式的镜头：

```
's/##\([a-zA-Z_]\+\)##/${\1}/g' 
```

或者，如果您假设恰好三个字符：

```
's/##\([a-zA-Z_]\{3\}\)##/${\1}/g' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T18:48:07.657

*   将 alpha 和 '_' 封装在 '\(' 和 '\)' 中，然后在右侧使用 '\1' 引用它。
*   '+' 匹配一个或多个 alpha 和 '_'（如果你看到####）。
*   将“g”选项添加到末尾以替换所有匹配项（我猜这就是您在这种情况下想要做的）。

```
's/##\([a-zA-Z_]\+\)##/${\1}/g'
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T18:41:36.453

用这个：

```
s/##\([^#]*\)##/${\1}/ 
```

顺便说一句，没有必要在“s”运算符的右侧转义 $。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T18:44:13.077

```
sed 's/##\([a-zA-Z_][a-zA-Z_][a-zA-Z_]\)##/${\1}/' 
```

`\(...\)`记忆...并在扩展中被引用`\1`。使用单引号来保存你的理智。

正如下面的评论中所指出的，这也可以收缩为：

```
sed 's/##\([a-zA-Z_]\{3\}\)##/${\1}/' 
```

此答案假定该示例需要恰好匹配三个字符。根据哈希标记之间的内容，有多种变化。关键部分是记住匹配字符串的一部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-14T09:09:00.657

```
echo "##foo##" | sed 's/##/${/;s//}/' 
```

*   `s`默认只更改 1 次
*   `s//`采用上次使用的搜索模式，因此 second 也采用`##`并且仅第二次出现仍然存在

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-17T17:44:01.410

回声'##XXX##' | sed "s/^##([^#]*)/##${\1}/g"

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-27T08:59:29.793

sed 's/([^az] *[^AZ]* [^0-9]*)/(&)/pg

# ajax - 有人用过TIBCO GI吗？

> ID：234841
> 
> 赞同：3
> 
> 时间：2008-10-24T18:50:55.640
> 
> 标签：ajax, tibco-gi

前几天我在检查[TIBCO GI](http://www.tibco.com/devnet/gi/)，给我留下了深刻的印象。

*   有没有人广泛使用它？
*   你怎么认为？
*   你遇到了什么弊端？
*   它适用于 Internet 还是仅适用于 Intranet 应用程序？

我感谢您对此提出的任何意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T01:36:09.893

是的，我已经非常广泛地使用它，这是我的一些想法。将在发生时添加到它们中。

*   我不评价在框架本身中实现 ​​IDE 的方法（它在浏览器窗口中运行）。有很多很多的怪癖，这可能会导致非常令人沮丧的经历。我通常使用 Javascript 调试窗口在 Intellij Idea 中开发所有 JS、XML 等来运行 IDE 本身。处理文件后，必须在 IDE 中重新加载它，但它仍然效率更高。

*   使用 IDE，可以相对快速地布局整个应用程序。

*   学习曲线非常陡峭。API 很广泛，当您遇到问题时，社区论坛也不是很好。

*   大部分 GUI 绘制都是使用内联样式属性完成的，因此很难对它们进行蒙皮，并使整个应用程序看起来完全符合您的要求。如果是因为这个原因，我认为 GI 比公开可用的应用程序更适合 Intranet 应用程序。

*   GI 使用“双 DOM”方法，保留每个屏幕元素的内部表示。这会使完全集成其他框架（如 JQuery 等）变得困难。

*   随着 RIAD 环境的发展，我认为它很棒。我发现以 GI 方式做事比沿着请求/响应路线快两个数量级。

*   我真的很喜欢强制分离表示和业务逻辑。

*   他们放入的 JS 扩展，如内省包、接口和类定义，非常聪明，非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-22T09:28:20.933

我完全同意 mysomic，但是：

*   不幸的是，Tibco GI 有一个巨大的缺点是它的重量和运行速度有多慢。

*   jQuery 要快得多。

*   我还遇到了在 IE 和 firefox 下开发的 UI 行为不同的问题。

*   缺乏文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-18T13:11:35.503

我在某些方面同意你的观点：将 JQuery 与 GI 进行比较，我认为它们不是同一级别：

*   Jquery 实现了 CSS 搜索引擎，提供了插件结构和一些实用工具，但它仍然像组件。
*   GI是企业级RIA解决方案，提供映射实用程序、类接口、扩展、实现结构、AMP插件结构、I10N、I18N等，就像复合级别。它还有 GI IDE，非常酷。

# c# - 在 C# 中更改本地管理员密码

> ID：234845
> 
> 赞同：10
> 
> 时间：2008-10-24T18:52:24.200
> 
> 标签：c#, wmi

我正在寻找一种方法来更改 Windows（本例中为 XP）机器上的本地用户帐户（本地管理员）的密码。我已经阅读了有关执行此操作的一种方法的[CodeProject 文章](http://www.codeproject.com/KB/threads/Reset-Administrator-Pass.aspx)，但这似乎并不“干净”。

我可以看到这[可能与 WMI 有关](http://www.microsoft.com/technet/scriptcenter/resources/qanda/oct04/hey1015.mspx)，所以这可能是答案，但我不知道如何将 WinNT WMI 命名空间与 ManagementObject 一起使用。当我尝试以下代码时，它会引发“无效参数”异常。

```
public static void ResetPassword(string computerName, string username, string newPassword){ 
            ManagementObject managementObject = new ManagementObject("WinNT://" + computerName + "/" + username); // Throws Exception
            object[] newpasswordObj = {newPassword};
            managementObject.InvokeMethod("SetPassword", newpasswordObj);
} 
```

有一个更好的方法吗？（我使用的是 .NET 3.5）

**编辑：**感谢伊利为我指明了正确的方向。这是我最终使用的代码：

```
public static void ResetPassword(string computerName, string username, string newPassword) { 
        DirectoryEntry directoryEntry = new DirectoryEntry(string.Format("WinNT://{0}/{1}", computerName, username)); 
        directoryEntry.Invoke("SetPassword", newPassword);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T20:06:17.017

尝试`DirectoryEntry`上课而不是`ManagementObject`上课。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T03:00:11.053

正如 Ely 所说，您可以使用 System.DirectoryServices 代码来完成每个[MSDN](http://msdn)：

```
String myADSPath = "LDAP://onecity/CN=Users,
     DC=onecity,DC=corp,DC=fabrikam,DC=com";

// Create an Instance of DirectoryEntry.
DirectoryEntry myDirectoryEntry = new DirectoryEntry(myADSPath);
myDirectoryEntry.Username = UserName;
myDirectoryEntry.Password = SecurelyStoredPassword; 
```

# sql - db2 中是否有“最强大”的功能？

> ID：234848
> 
> 赞同：3
> 
> 时间：2008-10-24T18:54:02.950
> 
> 标签：sql, db2

我在 MYSQL 和显然其他数据库引擎中发现有一个“最大”的函数，可以像这样使用：最大（1、2、3、4），它会返回 4。我需要这个，但我使用的是 IBM 的 DB2 . 有没有人知道这样的等效函数，即使它只接受 2 个参数？

我在某个地方发现了 MAX 应该这样做，但它不起作用......它只适用于选择列的 MAX。

如果没有这样的功能，是否有人知道执行此操作的存储过程是什么样的？（我没有存储过程的经验，所以我不知道 DB2 能做什么）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T19:12:24.487

为什么 MAX 不适合您？

从 sysibm.sysdummy1 中选择 max(1,2,8,3,1,7)

给我

```
 1
    ---------------
                 8

      1 record(s) selected. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-29T16:29:36.020

正如 Dave 指出的那样，MAX 应该可以工作，因为它既作为标量函数又作为列函数重载（标量需要 2 个或更多参数）。在 DB2 for LUW、DB2 for z/OS 和 DB2 for i5/OS 中就是这种情况。您使用的 DB2 的确切版本和平台是什么？您使用的确切语句是什么？MAX 标量版本的要求之一是所有参数都是“兼容的”——我怀疑您传递给函数的一个或多个参数可能存在细微的类型差异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T14:41:14.433

在 Linux V9.1 上，“select max (1,2,3) ...”给出 -

SQL0440N 未找到类型为“FUNCTION”的名为“MAX”且具有兼容参数的授权例程。SQLSTATE=42884

它是一个标量函数，需要单个值或单个列名。在 z/os 上，它的行为不同。

但是，它确实在 Linux 9.5 上按预期工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T19:05:21.273

两种选择：

1.  如何按降序对列进行排序并抓住前 1 行？

2.  根据我的“SQL 袖珍指南”，MAX(x) 返回一组中的最大值。

更新：如果您正在查看列，显然#1 将不起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T21:31:26.823

这听起来很疯狂，但在 DB2 中不存在这样的功能，至少在 9.1 版本中不存在。如果要选择两列中的较大者，最好使用 case 表达式。

您还可以定义自己的 max 函数。例如：

```
create function importgenius.max2(x double, y double)
returns double
language sql
contains sql
deterministic
no external action
begin atomic
    if y is null or x >= y then return x;
    else return y;
    end if;
end 
```

将输入和输出定义为双精度可以利用类型提升，因此该函数也适用于整数。“确定性”和“无外部操作”语句有助于数据库引擎优化函数的使用。

如果你想让另一个 max 函数用于字符输入，你必须给它另一个名字。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-07T09:48:04.630

请检查以下查询：

```
select * from table1 a,
(select appno as sub_appno,max(sno) as sub_maxsno from table1 group by appno) as tab2
where a.appno =tab2.sub_appno and a.sno=tab2.sub_maxsno 
```

# queue - 替换 jms 队列中的消息

> ID：234849
> 
> 赞同：6
> 
> 时间：2008-10-24T18:54:10.267
> 
> 标签：queue, jms, message-queue

我正在使用 activemq 在不同进程之间传递请求。在某些情况下，我在队列中有多个重复的消息（它们是请求）。我想只有一个。有没有办法发送一条消息，它将替换具有相似属性的旧消息？如果没有，有没有办法检查队列并检查具有特定属性的消息（在这种情况下，如果存在旧消息，我将不会发送新消息）。

澄清（基于戴夫的回答）：我实际上是在尝试确保队列上没有任何重复的消息，以减少消费者收到消息时发生的处理量。因此，我想替换一条消息，甚至不把它放在队列中。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T08:11:35.170

[这听起来像是幂等消费者](http://activemq.apache.org/camel/idempotent-consumer.html)的理想用例，它从队列或主题中删除重复项。

以下示例显示了如何使用[Apache Camel](http://activemq.apache.org/camel/)执行此操作，这是实现任何[企业集成模式](http://activemq.apache.org/camel/enterprise-integration-patterns.html)的最简单方法，特别是如果您使用的[是随 Camel](http://activemq.apache.org/enterprise-integration-patterns.html)开箱即用集成的[ActiveMQ](http://activemq.apache.org/)

```
from("activemq:queueA").
  idempotentConsumer(memoryMessageIdRepository(200)).
  header("myHeader").
  to("activemq:queueB"); 
```

唯一的技巧是确保有一种简单的方法来计算每条消息的唯一 ID 表达式 - 例如从文档中提取 XPath 或使用如上例中的一些唯一消息头

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T19:09:20.423

您可以浏览队列并使用选择器来识别消息。但是，除非您有少量消息，否则这不会很好地扩展。相反，您的消息应该只是指向数据库记录（或记录集）的指针。这样您就可以更新记录，任何收到消息的人都将访问最新版本的记录。

# c++ - C++ 中的变量命名约定

> ID：234866
> 
> 赞同：37
> 
> 时间：2008-10-24T19:02:35.083
> 
> 标签：c++, variables, naming-conventions

我来自 .NET 世界，并且是编写 C++ 的新手。我只是想知道在命名局部变量和结构成员时首选的命名约定是什么。

例如，我继承的遗留代码有很多：

```
struct MyStruct
{
   TCHAR           szMyChar[STRING_SIZE];
   bool            bMyBool;
   unsigned long   ulMyLong;
   void*           pMyPointer;
   MyObject**      ppMyObjects;
} 
```

来自 C# 背景的我很震惊地看到带有匈牙利符号的变量（我第一次看到 pp 前缀时就忍不住笑了）。

我宁愿以这种方式命名我的变量（尽管我不确定首字母大写是否是一个好的约定。我见过其他方式（见下面的链接））：

```
struct MyStruct
{
   TCHAR           MyChar[STRING_SIZE];
   bool            MyBool;
   unsigned long   MyLong;
   void*           MyPointer;
   MyObject**      MyObjects;
} 
```

我的问题：这（前一种方式）是否仍然是在 C++ 中命名变量的首选方式？

参考：

[http://geosoft.no/development/cppstyle.html](http://geosoft.no/development/cppstyle.html)

[http://www.syntext.com/books/syntext-cpp-conventions.htm](http://www.syntext.com/books/syntext-cpp-conventions.htm)

[http://ootips.org/hungarian-notation.html](http://ootips.org/hungarian-notation.html)

谢谢！

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-10-24T19:07:42.033

这种匈牙利表示法相当无用，如果你必须改变某些东西的类型，可能比无用更糟糕。（[*正确*](http://www.joelonsoftware.com/articles/Wrong.html)[的匈牙利符号](http://www.joelonsoftware.com/articles/Wrong.html)*是另一回事。）*

 *我建议你使用你的团队所做的任何事情。如果您是该程序的唯一工作人员，请以对您最有意义的方式命名。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-24T19:08:41.233

最重要的是要保持一致。如果您使用的是遗留代码库，请按照遗留代码的命名约定来命名变量和*函数*。如果您正在编写仅与旧代码交互的新代码，请在新代码中使用您的命名约定，但也要与您自己保持一致。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-24T22:02:05.457

不，“错误的匈牙利表示法”——尤其是用于双重间接的 pp——对早期的 C 编译器来说是有意义的，你可以在其中编写

```
int * i = 17;
int j = ***i; 
```

甚至没有来自编译器的警告（甚至可能是正确硬件上的有效代码......）。

“真正的匈牙利符号”（由 head Geek 链接）是 IMO 仍然是一个有效的选择，但不一定是首选。现代 C++ 应用程序通常有数十或数百种类型，您找不到合适的前缀。

在某些情况下，我仍然在本地使用它，例如在问题域中必须混合具有非常相似甚至相同名称的整数和浮点变量，例如

```
float fXmin, fXmax, fXpeak; // x values of range and where y=max
int   iXmin, iXMax, iXpeak; // respective indices in x axis vector 
```

* * *

但是，在维护确实遵循某些约定的遗留代码时（即使是松散的），您应该坚持那里使用的约定 - 至少在要维护的现有模块/编译单元中。

我的推理：编码标准的目的是遵守最小意外原则。始终使用一种风格比使用哪种风格更重要。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-24T19:23:34.450

在这个例子中，除了有点难看之外，还有什么不喜欢或嘲笑“ppMyObjects”的呢？无论哪种方式，我都没有强烈的意见，但它确实可以一目了然地传达有用的信息，而“MyObjects”却没有。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-24T19:16:28.520

我同意这里的其他答案。为了一致性起见，要么继续使用你从传下来的风格，要么想出一个适合你团队的新约定。团队达成一致很重要，因为几乎可以保证您将更改相同的文件。话虽如此，过去我发现一些非常直观的东西：

类/结构成员变量应该突出 - 我通常以 m_ 为前缀
全局变量应该突出 - 通常以 g_ 为前缀
变量通常应以小写
函数开头通常名称应以大写
宏开头，并且可能枚举应全部大写
所有名称都应该描述函数/变量的作用，并且永远不应该描述它的类型或值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-24T19:43:42.647

我自己是一个匈牙利符号的人，因为我发现它增加了代码的可读性，而且我更喜欢自我记录的代码而不是注释和查找。

也就是说，我认为您可以为牺牲自己喜欢的风格和一些额外的可维护性以实现团队团结提出理由。为了统一的代码可读性，我不购买一致性的论点，特别是如果你为了一致性而降低可读性......它只是没有意义。但是，与您一起工作的人相处可能值得在查看变量的类型上多加混淆。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-24T19:06:51.520

匈牙利符号在 Win32 和 MFC API 的用户中很常见。如果您的前任正在使用它，您最好继续使用它（即使它很烂）。C++ 世界的其他地方从来没有过这种脑残的约定，所以如果你使用的是那些 API 以外的东西，就不要使用它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T19:08:18.193

我认为您仍然会发现大多数使用 Visual C++ 编程的商店都坚持使用匈牙利表示法，或者至少是它的淡化版本。在我们的商店中，我们的应用程序有一半是旧版 C++，顶部有一个闪亮的新 C# 层（中间有一个托管 C++ 层。）我们的 C++ 代码继续使用匈牙利符号，但我们的 C# 代码使用您介绍的符号。我认为这是丑陋的，但它是一致的。

我说，使用您的团队想要的任何项目。但是，如果您正在处理遗留代码或加入团队，请坚持现有的风格以保持一致性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T19:44:11.350

这完全取决于个人喜好。我曾为 2 家具有类似方案的公司工作，其中成员变量被命名为 m_varName。我从未见过在工作中使用匈牙利符号，并且真的不喜欢它，但又归结为偏好。我的一般感觉是 IDE 应该注意告诉你它是什么类型，所以只要名称足以描述它的作用（ m_color, m_shouldBeRenamed ），就可以了。我喜欢的另一件事是成员变量、局部变量和常量命名之间的区别，因此很容易看出函数中发生了什么以及变量来自哪里。成员：m_varName 常量：c_varName 本地：varName

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-05-15T12:55:43.717

我也更喜欢 CamelCase，事实上，我大部分时间都看到有人在 C++ 中使用 CamelCase。就个人而言，我不使用私有/受保护成员和接口的任何前缀：

```
class MyClass : public IMyInterface {
public:
    unsigned int PublicMember;
    MyClass() : PublicMember(1), _PrivateMember(0), _ProtectedMember(2) {}
    unsigned int PrivateMember() {
        return _PrivateMember * 1234; // some senseless calculation here
    }
protected:
    unsigned int _ProtectedMember;
private:
    unsigned int _PrivateMember;
};
// ...
MyClass My;
My.PublicMember = 12345678; 
```

**为什么我决定省略公共成员的前缀：** 因为公共成员可以像在结构中一样直接访问，并且不会与私有名称冲突。而不是使用下划线，我还看到人们使用第一个小写字母作为成员。

```
struct IMyInterface {
    virtual void MyVirtualMethod() = 0;
}; 
```

接口包含每个定义仅需要稍后实现的纯虚拟方法。但是在大多数情况下，我更喜欢抽象类，但这是另一回事。

```
struct IMyInterfaceAsAbstract abstract {
    virtual void MyVirtualMethod() = 0;
    virtual void MyImplementedMethod() {}
    unsigned int EvenAnPublicMember;
}; 
```

有关更多灵感，请参阅[高完整性 C++ 编码标准手册。](http://www.codingstandard.com/HICPPCM/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-01-20T05:17:54.370

我的团队遵循这个[Google C++ 代码约定](https://google.github.io/styleguide/cppguide.html#Variable_Names)：

这是变量名称的示例：

```
string table_name;  // OK - uses underscore.
string tablename;   // OK - all lowercase.

string tableName;   // Bad - mixed case. 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-20T21:12:34.497

如果您使用 CamelCase，约定是类结构和非原始类型名称的首字母大写，数据成员的首字母小写。方法的大写往往是一个混合包，我的方法往往是动词，并且已经被括号区分，所以我不大写方法。

就我个人而言，我不喜欢阅读 CamelCase 代码，并且更喜欢数据和方法标识符的下划线小写，首字母大写的类型和保留大写以及我使用宏的罕见情况（警告这是一个宏）。

# winforms - 从winforms启动IE，当我的winforms关闭时我可以关闭IE吗？

> ID：234869
> 
> 赞同：1
> 
> 时间：2008-10-24T19:03:00.683
> 
> 标签：winforms, internet-explorer

我有一个 winforms 应用程序，这就是为什么有人点击我需要打开 IE 到特定 URL 的按钮。

当有人关闭 winforms 应用程序时，我需要关闭 IE。

这可能吗？如果是，如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T19:15:48.460

如果您没有对用于启动 IE 的旧进程的引用，则必须搜索 System.Diagnostics.Process.GetProcessesByName("IEXPLORE") 返回的进程数组并终止特定进程。

[这里](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2252401&SiteID=1)有一些样品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T19:09:57.863

这样做是可能的，但最好使用 WebBrowser 控件将 Internet Explorer 简单地嵌入到您的应用程序中。这样，当您关闭网站时，当您的网站在现有 IE 窗口的新选项卡中打开时，您就没有机会关闭整个窗口。

**编辑：**如果你还是要这样做，请查看[System.Diagnostics.Process.Close 上的 MSDN 页面](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.close.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T19:14:03.393

对的，这是可能的，

当您调用 System.Diagnostics.Process.Start() 启动浏览器时，请使用专门创建的进程对象。您可以稍后使用进程信息来终止该进程。

但是，正如 Dan Walker 所提到的，只使用 Web Browser 控件可能是一个更好的主意，除非您有特定的导航需求，否则启动和终止 IE 可能更有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T19:35:19.667

试试这个（假设你正在使用 .NET 的 WinForms）

```
Process ieProcess = Process.Start("iexplore", @"http://www.website.com");

// Do work, etc

ieProcess.Kill(); 
```

这只会杀死您启动的实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T19:13:52.427

不确定您是如何启动 IE 的，但如果您保留对已启动进程（或创建的窗口句柄）的引用，则可以在应用退出时终止进程（或关闭窗口）。

编辑：

关闭窗口句柄的代码就像

```
Utilities.Utilities.SendMessage(mTestPanelHandle, WM_COMMAND, WM_CLOSE, 0); 
```

如果您有 P/Invoke

```
public const int WM_COMMAND = 0x0112;
public const int WM_CLOSE = 0xF060;
[DllImport("user32.dll", EntryPoint = "SendMessage", SetLastError = true,
        CallingConvention = CallingConvention.StdCall)]
public static extern int SendMessage(IntPtr hwnd, uint Msg, int wParam, int lParam) 
```

# .net - basicHttpBinding 是将 .Net 2.0 客户端连接到 WCF 服务的唯一选择吗？

> ID：234871
> 
> 赞同：2
> 
> 时间：2008-10-24T19:03:59.277
> 
> 标签：.net, wcf, security, .net-2.0

这是对这个[问题](https://stackoverflow.com/questions/232500/how-to-configure-security-when-calling-wcf-service-from-net-20-client)的后续。我试图避免使用 x509 证书方法，因为这会使我的客户端安装更加复杂。如果 basicHttpBinding 不是唯一的选择，那么其他绑定方法的一些示例在哪里。

我的客户在 .Net 2.0 上，我无权访问 System.ServiceModel 命名空间，因为它直到 3.0 才出现。

更新：需要明确的是，客户端：.Net 2.0，网络服务：.net3.5/WCF

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T19:32:07.130

问题不在于 .Net 2.0 服务和 WCF 以及各种绑定之间的不匹配——它们是非常兼容的协议（有一些在您的情况下不应该成为问题的显着例外）。

WSE 3.0（在 2.0 .Net 框架上运行）特别接近。您可以将其与 basicHttpBinding 或 wsHttpBinding 以及一些调整一起使用。'Jimmy' Skowronski 的文章[和](http://devlicio.us/blogs/ziemowit_skowronski/archive/2007/07/18/interoperability-between-wcf-and-wse-3-0.aspx)MSDN 文章[涵盖](http://msdn.microsoft.com/en-us/magazine/cc163597.aspx)了大部分基础知识。

您还可以编写自定义绑定，让您避开 WSE 和 WCF 之间的一些不兼容问题（例如使用 WCF 和基本身份验证时的安全传输要求）

据我了解，您的问题是如何管理身份验证-在您之前的问题中，您排除了 Windows 身份验证。Kerberos 在 WCF 或 WSE 中都可以工作，但这更加复杂。

除非您深入研究自己的身份验证方案，否则（据我所知）仅限于使用基本身份验证（因此每个客户端都提供用户名或密码，这可能对所有客户端都相同，具体取决于您的需要）或基于证书的身份验证.

Toran 的回答是使用基本身份验证的良好开端。

我认为也许一个好的方法是首先查看 .Net 2.0（和 WSE*）方面的要求 - 建立一个适合您的客户端部署的身份验证机制，然后研究如何使用 WCF 接受该身份验证。

WCF 几乎可以接受 WSE 3.0 可以发送的任何东西（我能想到的唯一例外是寻址规范的版本，以及一些稍微严格的安全要求）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T19:11:40.307

您可能需要带有 basicHttp 的 SSL + 用户名/密码。

首先，以下是您的客户端将在 .NET 2.0 中使用 WCF 服务进行身份验证的内容。

```
Dim client As WebServiceClient = New WebServiceClient("basicHttpWebService")
client.ClientCredentials.UserName.UserName = "username"
client.ClientCredentials.UserName.Password = "password" 
```

接下来，您的 WCF 服务的示例配置需要 SSL + Membership 提供者凭据

```
 <bindings>
            <basicHttpBinding>
                <binding name="basicHttp">
                    <security mode="TransportWithMessageCredential">
                        <transport/>
                        <message clientCredentialType="UserName"/>
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
        <behaviors>
            <serviceBehaviors>
                <behavior name="NorthwindBehavior">
                    <serviceMetadata httpGetEnabled="true"/>
                    <serviceAuthorization principalPermissionMode="UseAspNetRoles"/>
                    <serviceCredentials>
                        <userNameAuthentication userNamePasswordValidationMode="MembershipProvider"/>
                    </serviceCredentials>
                </behavior>
            </serviceBehaviors>
        </behaviors> 
```

我唯一不确定的是，要使用客户端应用程序中的第一部分，您可能需要安装 WCF/WPF 扩展 CTP，因为我通常右键单击并“添加服务引用”而不是 ASMX“添加 Web 引用” - 如果是这样，这个 VS2005 的扩展确实需要安装 .NET 3.0。但是通过一个简单的“添加网络参考”，您仍然应该能够输入用户名/密码......我只是不知道这个 vb/c# 会是什么样子......

# c++ - 通过 Win32 API 更改文件夹安全权限

> ID：234872
> 
> 赞同：2
> 
> 时间：2008-10-24T19:04:55.860
> 
> 标签：c++, security, winapi

我的 C++ 应用程序将一些常见的用户数据存储在`%CSIDL_COMMON_APPDATA%\Company\Product`. 我想确保用户组对该文件夹具有写入权限，而在 Vista 上则没有。我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T20:19:10.390

自己用ATL想出来的...

```
CDacl oDacl;
AtlGetDacl(strFolder, SE_FILE_OBJECT, &oDacl);
oDacl.RemoveAces(Sids::Users()); // Remove existing "Users" access
oDacl.AddAllowedAce(Sids::Users(), FILE_ALL_ACCESS, CONTAINER_INHERIT_ACE | OBJECT_INHERIT_ACE);
AtlSetDacl(strFolder, SE_FILE_OBJECT, oDacl); 
```

当然，我的真实代码包含错误检查。

# .net - 在企业应用程序中抽象数据连接层和表示层

> ID：234888
> 
> 赞同：2
> 
> 时间：2008-10-24T19:10:25.660
> 
> 标签：.net, design-patterns, connection-string, database-connection, abstraction

我们正在构建一个企业应用程序，我们将在其中整合多个用户界面平台（即 ASP.net webapp、Windows 应用程序，以及未来的移动应用程序）和多个后端数据库平台（即 SQL Server、XML、Oracle）。另一个必要条件是这些后端数据库要么集中并通过 Web 访问，要么本地化在客户端计算机上，偶尔同步到中央服务器。

任何人都可以就我们如何抽象用户界面层和数据层提供建议，以便我们可以更简单地在各种 UI 和 DB 的各种选择之间创建即插即用的适应性？例如：在一种情况下，我们可能有一个通过互联网在中央服务器上运行的网络应用程序，我们可能有远程机器通过一个 Windows 应用程序运行本地化副本。在预定的时间间隔内，我们希望所有机器同步，以便它们都可以拥有近乎实时的数据。

我们还需要有关处理所涉及的各种连接字符串的建议，以便在任何一个应用程序上需要更改的唯一设置是“本地”或“远程”，然后它们将确定必要的连接字符串。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-25T07:27:02.257

一旦掌握了 n 层架构的窍门，抽象表示层是一个相当简单的概念。只需专注于区分“领域逻辑”和“应用程序逻辑”。域逻辑在您的不同平台上是通用的，而应用程序逻辑是特定于平台的。例如，数据验证是域逻辑（虽然你可以在前端执行它很好，这会使事情变得更复杂，但在这里和我一起工作......）并决定在某些操作后重定向到哪个 URL 是应用程序逻辑。确保将域逻辑放在任何平台都可以使用的级别，并确保不要将任何应用程序逻辑放在域层中。

您问题的另一半似乎是您更大的焦点，但我想在这里要求澄清一下，因为我可以辨别出两个不同的基本问题。

1.  我希望您不要追求数据库独立性的“圣杯”。在设计阶段，这始终是一个崇高的目标，几乎总是，几乎每次都不需要。

    如果这不是您想要的，那么我建议您应该知道哪些对象存储在哪个持久性介质中，并且您应该避免灵活性的复杂性，并以直接的方式编码您的垂直路径尽可能。IE 不会将额外的东西编码到将其数据存储在 Oracle 中的某些业务类中，以使您能够“在将来的某个时间”将其放入 SQL Server。（我循环回到数据库独立性，不是吗？）

2.  在本地缓存数据以提高某些平台的性能的问题特定于这些平台，我建议您查看智能客户端和 MS P&P 团队拥有的缓存框架/指导。在过去的几年里，我一直非常专注于网络方面的工作，但在 05/06 的时候情况非常好，与此同时，他们在智能客户端方面也做了很多工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T19:11:57.857

我会考虑使用提供者模型在您的应用程序中建立数据库连接。

我将首先查看 Microsoft 数据应用程序块中提供的示例和详细信息，我认为这将有助于您实现目标。

# asp.net-mvc - ASP .NET / MVC 模型框架

> ID：234892
> 
> 赞同：3
> 
> 时间：2008-10-24T19:11:01.400
> 
> 标签：asp.net-mvc, csla

几年来，我一直在将 CSLA 框架用于 Windows 应用程序。现在有了 ASP .NET MVC / AJAX / jQuery，CSLA 框架（它是强面向对象的）在 web 应用程序中有什么用处吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T19:29:29.367

你绝对会的。CSLA 用于构建您的业务逻辑层；您使用哪种 ui 介质并不重要。是的，有一些不错的新工具和模式可用于构建和控制 Web ui，但 CSLA 为您提供的用于创建业务框架的管道是次要的（如果有的话）。CSLA 与 UI 无关，它与 UI 使用的所有逻辑有关。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T19:32:20.673

在最近一集中的 .Net Rocks 中，Rocky Lhotka 谈到即将推出的 CSLA 版本将支持 MVC。他们只是添加了 Silverlight 支持，而且，afaik，它也适用于 Web 表单。

[http://www.dotnetrocks.com/default.aspx?showNum=387](http://www.dotnetrocks.com/default.aspx?showNum=387)

# mysql - 命名数据库表以提供自然组织的最佳实践是什么？

> ID：234902
> 
> 赞同：12
> 
> 时间：2008-10-24T19:13:14.797
> 
> 标签：mysql, database, database-design

我们在相关表上放置了通用前缀，以确保它们在我们的数据库管理软件（Toad、Enterprise Manager 等）中彼此相邻显示。

例如，所有用户表都以 User 开头：

*   用户
*   用户事件
*   用户购买

理想情况下，为了纪念[程序员的三大美德，](http://c2.com/cgi/wiki?LazinessImpatienceHubris)这些表应该分别命名为 User、Event、Purchase 以节省一些打字，同意吗？

这种命名约定是自然地将相关表分组在一起的最佳（唯一？）实践吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-24T19:35:53.503

在这里，我倾向于在两个方面违反命名约定......

1.  我不喜欢使用前缀，以便在给定的 UI 中组合在一起。对我来说，表的命名应该使得它们在代码中易于阅读且有意义。有大量研究（大部分被程序员忽略）表明，使用下划线、逻辑名称、消除缩写以及消除前缀之类的东西对理解和处理代码的速度都有很大的影响。此外，如果您使用前缀来分解表格，当一个表格被多个区域使用时您会怎么做 - 或者更糟糕的是，它开始只在一个区域中，但后来开始在另一个区域中使用。您现在必须重命名表吗？

2.  我几乎完全忽略了名字的长度。我更关心可读性和可理解性，而不是花费 1/10 秒的时间来键入列或表名。当您还记住所有时间都浪费在试图记住您是否将“number”缩写为“no”、“num”或“nbr”并记住使用诸如 Intellisense 之类的东西时，使用更长、更有意义的名称是对我来说毫无疑问。

考虑到这些，如果您的 UserEvents 表确实与与用户相关的事件有关，那么该名称就非常有意义。仅使用事件最终会给您一个名称**不佳**的表，因为我认为名称不够清晰。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-24T19:55:23.263

我不会使用命名约定来按字母顺序排列表名。当它以这种方式运行时很好，但这不应该是设计使然。

阅读 Joe Celko 的书“ [SQL 编程风格](https://rads.stackoverflow.com/amzn/click/com/0120887975)”。他在那本书中的第一章是关于命名约定的，由 ISO 11179 元数据命名标准指导。他的建议之一是避免在命名约定中使用不必要的前缀。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-24T19:16:42.777

如果这个表是“用户”和“事件”表之间的多对多关系的表示，我会使用这个符号，即“UserEvent”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-24T19:26:59.670

我认为这取决于您是否/如何计划扩展您的数据模型。例如，如果您决定不仅要拥有用户事件，还要拥有帐户事件或登录事件，并且用户、帐户和登录都是不同类型的实体，但它们共享一些事件，该怎么办。在这种情况下，您可能需要一个规范化的数据库模型：

*   用户（Id int，名称 varchar）
*   帐户（Id int，名称 varchar）
*   登录（Id int，名称 varchar）
*   事件（Id int，名称 varchar）
*   UserEvents (UserId int, EventId int)
*   AccountEvents (AccountId int, EventId int)
*   LoginEvents (LoginId int, EventId int)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-24T20:48:47.710

我猜想 SQL 中的命名约定是或至少应该遵循与其他编程语言中使用的相同的准则。我一直更喜欢明确识别目的的变量名/类名，这通常意味着更多的输入。我认为要记住的重要一点是代码只写一次，但要读很多次，所以清晰是至关重要的。在过去的 4 或 5 年中，我注意到变量名称已从“eDS”发展为“employeeDataSet”，我认为 IntelliSense 是主要原因。我认为自从 Red Gate SQL Prompt 和现在的 MS SQL2008 将 Intellisense 引入主流数据库世界以来，我们将在 SQL 中看到同样的情况。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-29T12:48:50.473

我也会避免使用前缀来从按字母顺序排列的列表中获取含义。以这种方式使用名称通常是糟糕的数据管理。如果表密切相关，那么管理数据模型的软件应该能够对表之间的关系进行建模，而不管表是如何命名的。

当每一行的内容描述用户和事件之间的关系时，应该使用像 UserEvents 这样的名称。如果我在数据库中看到这样一个对我来说是新的表，我希望在这个表中看到一个由两个外键组成的主键，一个是用户表，一个是事件表。

如果我看到不同的东西，我将不得不放慢速度，直到我理解设计师的惯例。

这最后一点提出了一些问题：家里有很多新人会跟上数据库吗？这些人将有什么文件可用？这些新人对于包含数据库的项目的成功或数据库设计者的成功有多重要？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T19:17:52.637

我个人喜欢与您在此处列出的类似的命名条件，因为这是一种非常合乎逻辑的模式，它们的组织方式使您可以轻松找到它们，并且总体而言，额外的输入位通常不会导致很多问题或减少及时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-03T09:54:27.040

我个人重命名我的表是这样的：

*   主表：tbl_user
*   参考表：ref_profil
*   相关表：lnk_user_profile

# assembly - CIL nop 操作码的目的是什么？

> ID：234906
> 
> 赞同：82
> 
> 时间：2008-10-24T19:14:03.313
> 
> 标签：assembly, bytecode, cil

我正在浏览 MSIL 并注意到 MSIL 中有很多[nop](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.nop.aspx)指令。

MSDN 文章说，如果操作码被修补，它们不会执行任何操作并用于填充空间。它们在调试版本中的使用比在发布版本中更多。

我知道这些语句在汇编语言中用于对齐后面的指令，但是为什么 MSIL 中需要 MSIL nop 呢？

（编者注：接受的答案是关于机器代码 NOP，而不是问题最初询问的 MSIL/CIL NOP。）

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-10-24T19:41:12.837

NOP 有多种用途：

*   它们允许调试器在一行上放置一个断点，即使它与生成的代码中的其他断点结合使用。
*   它允许加载器使用不同大小的目标偏移量来修补跳转。
*   它允许代码块在特定边界对齐，这对缓存很有好处。
*   它允许增量链接通过调用新部分来覆盖代码块，而不必担心整个函数会改变大小。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-25T03:15:34.933

以下是调试使用[MSIL / CIL](https://en.wikipedia.org/wiki/List_of_CIL_instructions) nops（**不是 x86 机器代码[`nop`](https://www.felixcloutier.com/x86/nop)**）的方式：

语言编译器（C#、VB 等）使用 Nop 来定义隐式序列点。这些告诉 JIT 编译器在哪里确保机器指令可以映射回 IL 指令。

[Rick Byer 关于DebuggingModes.IgnoreSymbolStoreSequencePoints](http://blogs.msdn.com/rmbyers/archive/2005/09/08/462676.aspx)的博客文章解释了一些细节。

C# 还在调用指令之后放置 Nops，以便源中的返回站点位置是调用而不是调用之后的行。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-24T19:16:39.643

它为代码中的基于行的标记（例如断点）提供了机会，其中发布版本不会发出任何内容。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-24T19:19:02.977

老兄！无操作太棒了！这是一个除了消耗时间什么都不做的指令。在昏暗的黑暗时代，您可以使用它来对关键循环中的时序进行微调，或者更重要的是作为自修改代码的填充物。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-24T22:43:13.267

在针对特定处理器或架构进行优化时，它还可以使代码运行得更快：

长期以来，处理器采用多条大致并行工作的流水线，因此可以同时执行两条独立的指令。在具有两个管道的简单处理器上，第一个可能支持所有指令，而第二个仅支持一个子集。此外，当必须等待尚未完成的前一条指令的结果时，流水线之间会出现一些停顿。

在这种情况下，一个专用的*nop*可能会强制下一条指令进入特定的管道（第一条，或者不是第一条），并改进后续指令的配对，从而使*nop*的成本 超过摊销。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-28T13:03:36.383

在我最近（四年）工作的一个处理器中，NOP 用于确保在下一个操作开始之前完成上一个操作。例如：

将值加载到寄存器（需要 8 个周期） nop 8 add 1 to register

这确保寄存器在添加操作之前具有正确的值。

另一个用途是填充执行单元，例如必须具有一定大小（32 字节）的中断向量，因为向量 0 的地址是 0，向量 1 的地址是 0x20 等等，所以编译器会在其中放入 NOP需要。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-24T19:24:02.250

他们可以在调试时使用它们来支持**编辑并继续。**它为调试器提供了工作空间，可以在不更改偏移量等的情况下用新代码替换旧代码。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-28T12:46:59.147

50 年太晚了，但是嘿。

如果您手动输入汇编代码，则 Nop 很有用。如果你必须删除代码，你可以 nop 旧的操作码。

类似地，您可以通过覆盖一些操作码并跳转到其他地方来插入新代码。在那里放置被覆盖的操作码，并插入新代码。准备好后你跳回去。

有时您必须使用可用的工具。在某些情况下，这只是一个非常基本的机器代码编辑器。

如今，对于编译器，这些技术不再有意义。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-24T19:17:58.797

它们的一个典型用途是使您的调试器始终可以将源代码行与 IL 指令相关联。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-24T19:33:08.330

在软件破解场景中，解锁应用程序的经典方法是使用 NOP 修补检查密钥或注册或时间段或诸如此类的行，这样它就什么也不做，只是继续启动应用程序，就好像它已注册一样.

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-24T20:03:31.873

我还看到代码中的 NOP 会修改自身以混淆它作为占位符的作用（非常古老的复制保护）。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-25T02:24:50.277

正如 ddaa 所说，nops 让您考虑堆栈中的差异，因此当您覆盖返回地址时，它会跳转到 nop 雪橇（连续很多 nop），然后正确命中可执行代码，而不是跳转到一些不是开始的指令中的字节。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-02T09:28:29.030

[NOP-Slides](http://www.phreedom.org/solar/honeynet/scan20/scan20.html)是一个有点非正统的用法，用于缓冲区溢出漏洞利用。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-24T19:22:23.920

它们允许链接器将较长的指令（通常是长跳转）替换为较短的指令（短跳转）。NOP 占用了额外的空间 - 代码无法移动，因为它会阻止其他跳转工作。这发生在链接时，因此编译器无法知道长跳转或短跳转是否合适。

至少，这是他们的传统用途之一。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-24T19:26:04.490

这不是您特定问题的答案，但在过去，如果您无法用其他有用的指令填充它，您可以使用 NOP 来填充[分支延迟槽。](http://en.wikipedia.org/wiki/Branch_delay_slot)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-24T19:27:27.797

.NET 编译器是否对齐 MSIL 输出？我想它可能对加快对 IL 的访问很有用......另外，我的理解是它被设计为可移植的，并且在其他一些硬件平台上需要对齐访问。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-24T20:55:02.597

我学到的第一个程序集是 SPARC，所以我熟悉分支延迟槽，如果你不能用另一条指令填充它，通常是你要放在分支指令之上的指令或在循环中增加一个计数器，你使用一个NOP。

我不熟悉破解，但我认为使用 NOP 覆盖堆栈是很常见的，因此您不必准确计算恶意函数的开始位置。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-25T04:21:08.857

我使用 NOP 自动调整进入 ISR 后累积的延迟。非常方便地确定时间。

# plsql - 用于解析 EDI 的 PL/SQL（X12、NCPDP、HL7）

> ID：234909
> 
> 赞同：3
> 
> 时间：2008-10-24T19:14:33.983
> 
> 标签：plsql, edi, hl7, x12

我有一些 EDI 消息（X12、HL7 等）存储在 Oracle 数据库中。我有时想提取个别字段（例如 ISA-03）。目前，我有一些非常丑陋的 sql。我想创建一个 PL/SQL 包以使其更容易，并且想知道是否有人已经这样做了。

我想像：

从 edi_table 中选择 edi.x12.extract_field(clob_column, 'ISA', 4)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T17:41:14.643

虽然我从未将 HL7 消息按原样存储在数据库中，但它应该是可能的。

HL7（和 XML）的想法是，它是系统用来传输信息的通用格式。它从未被设计为“可储存”的物品。通常，我会将数据从仓库格式中提取到特定的 HL7 消息中，然后发送到 MQHub/eGate 进行传输。在返回时，相反地提取我正在仓储的字段并保存它们。IE HL7 不应该被存储，所以我没有。

讲座够了。:)

我建议每个段使用一个函数/过程，并将消息拆分到一个临时表中。

[在 oracle 中拆分的示例](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5259821.html)

# java - 寻找“通用”文档查看器组件/库

> ID：234914
> 
> 赞同：4
> 
> 时间：2008-10-24T19:16:03.480
> 
> 标签：java, applet, viewer, plugins

我正在寻找一个与 Oracle/Stellent OutsideIn ActiveX 控件或 Autonomy KeyView 技术具有类似功能的 Applet，它充当浏览器插件，允许呈现/显示大量文件格式（文字处理、spreadhseet、图形、等）我目前使用 Stellent 解决方案，但由于我们的一些客户的一些限制，他们更喜欢作为 Java Applet、Silverlight 控件存在的东西，或者具有我可以在其之上构建小程序的 Java API（两者都不是我提到的两个中的一个）。

> 它至少需要显示以下格式：
> 
> > MS Word、Excel、PowerPoint
> > 
> > MS Outlook 味精文件
> > 
> > Adobe PDF
> > 
> > 标准图像格式：BMP、PNG、JPEG、TIFF
> > 
> > WordPerfect
> > 
> > HTML

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-25T14:09:16.983

如果可以选择商业产品，[那么 ViewOne](http://www.daeja.com/products/viewone1.asp)是一款不错的产品。它是一个小程序，您可以查看各种各样的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T19:19:20.650

它不是一个插件，但[multivalent](http://multivalent.sourceforge.net/)是一个用于大量文档格式的 Java 库和浏览器，但可能不是您想要涵盖的所有格式。

它至少涵盖了 PDF、HTML 和任何合理的图像格式，但不包括任何专有格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-25T03:19:14.457

如果您正在寻找支持所有这些格式的纯 Java 组件，我非常有信心它不存在。如果您想要嵌入浏览器、MS Office、Acrobat 等，您将需要一个 ActiveX 容器。

以下是一些选择：

[JDIC](https://jdic.dev.java.net/#demos) - 如果您使用的是 Swing（请参阅文档查看器演示。）

[SWT ActiveX 容器](http://www.alphaworks.ibm.com/tech/swtactivexcontainer)- 如果您使用的是 SWT

[TeamDev WinPack](http://www.teamdev.com/winpack/demo.jsf) - 如果您的时间比金钱更宝贵 ;-) 产品非常精美，价格合理且支持出色。

请注意，使用其中任何一个，您都需要安装 Acrobat、MS Office（或免费的文档查看器）以及编辑文件格式所需的任何其他应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-06T19:44:43.230

您是否看过 Adeptol AJAX 文档查看器。
一个无插件无小程序无安装查看器，支持 300 多种文件类型。
请参阅[ajaxdocumentviewer.com](http://www.ajaxdocumentviewer.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-11T13:27:53.330

您可能对 Net-it Central 感兴趣。它使用 Active-x 插件或 java 小程序，并适用于几种不同的格式。我目前正在将它用于 Word 和 Excel。

# c# - 可编辑的 WPF GridView 行

> ID：234929
> 
> 赞同：1
> 
> 时间：2008-10-24T19:19:05.970
> 
> 标签：c#, wpf, gridview

我正在尝试创建一个数据绑定的 WPF GridView，其行可以是只读的或可编辑的（通过双击或通过上下文菜单）。如果其任何可编辑控件失去焦点，我希望该行返回只读状态。我正在寻找的功能与[此示例](http://blogs.msdn.com/atc_avalon_team/archive/2006/03/14/550934.aspx)非常相似，但同时编辑了整行（而不是单个单元格）。有谁知道如何实现这个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-25T10:25:17.063

在 codeplex 上还有来自微软的“官方”wpf 数据网格：http: [//www.codeplex.com/wpf](http://www.codeplex.com/wpf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-25T10:20:22.360

使用 ListView + GridView 控件非常复杂，因为该控件“在列中思考”，因此您必须为每一列创建一个模板，并使用编辑模板（对于每个单元格）切换只读模板。我建议你看看 xceed DataGrid。它是免费的，并且以更简单的方式实现了编辑功能（您可以在此处找到信息：http: [//xceed.com/Grid_WPF_Intro.html](http://xceed.com/Grid_WPF_Intro.html)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-08T21:21:02.297

最新的 WPF 有自己的 DataGrid。 [http://wpftutorial.net/DataGrid.html](http://wpftutorial.net/DataGrid.html)

# objective-c - 哪个方法名称最适合 Objective-C/Cocoa 约定？

> ID：234930
> 
> 赞同：4
> 
> 时间：2008-10-24T19:19:19.763
> 
> 标签：objective-c, cocoa, cocoa-touch, naming-conventions

这是一个快速的问题。哪个方法名称对 Objective-C Cocoa 应用程序最有意义？

```
-(void) doSomethingWithAnimation:(BOOL)animated 
```

或者：

```
-(void) doSomething:(BOOL)animated 
```

甚至：

```
-(void) doSomethingAnimated:(BOOL)animated 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T19:51:43.613

我认为 Cocoa 约定将为您的示例提供以下语义（显然，忽略参数的 BOOL 类型）：

```
-(void) doSomethingWithAnimation:(BOOL)animated 
```

实际上会期望一个动画作为参数（即代表动画的东西。

```
-(void) doSomething:(BOOL)animated 
```

会期望某事做。

```
-(void) doSomethingAnimated:(BOOL)animated 
```

正如诺亚回答的那样，会用可选的动画做一些事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T19:27:15.783

-(void)doSomethingAnimated:(BOOL)animated 似乎最符合 Apple 的命名风格。作为参考，请查看 iPhone UIKit 文档 - UINavigationController 的 -popToRootViewControllerAnimated: 方法，例如。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T22:23:29.547

这是另一个需要考虑的选项：制作两种方法，`-doSomething`并且`-doSomethingWithAnimation`.

然后，如果你愿意，你可以让它们都尾调用第三个私有方法，并给该方法起任何你想要的名字。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-26T17:05:06.770

清楚简洁地写下您的评论，例如：//用动画做一些事情

然后根据此注释写下您的方法名称，如下所示 doSomethingwithAnimation:(BOOL)animated

Objective-C 和 Cocoa 被设计成可读性好，所以如果你的方法不能清晰地描述你的代码，那么它可能没有很好的命名。

# installation - 如何从安装程序中创建安装程序？

> ID：234934
> 
> 赞同：2
> 
> 时间：2008-10-24T19:20:26.717
> 
> 标签：installation, nsis

我有一个旧的遗留应用程序，我只有安装程序。它除了解压缩并注册它自己和他的库之外什么都不做。

由于我没有源代码，因此在维护问题上让我很头疼。在某些特定的计算机（带有 Windows 的 Acer Aspire One）上只是不运行。

我想提取文件并使用 NSIS 重新创建此安装程序。这是可能的还是我疯了？

原始安装程序是使用 Ghost Installer Studio 创建的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T19:37:17.603

一种选择是找到一台可以运行它的机器，**然后**安装一些“安装保护”软件（通常称为 Acme Uninstaller 之类的软件）。使用它来跟踪实际安装的内容，然后复制相关文件并编写自己的文件。

对我来说，这看起来很麻烦，而且你可能在许可证方面如履薄冰。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T19:25:09.640

您可以尝试使用一个程序来监控正在安装的新文件，然后从它们各自的路径中获取安装的文件。

例如，我在谷歌大约 10 秒内[发现了这个](http://www.tucows.com/preview/222221)，还有更多类似的程序，但我对 Windows 可用的程序缺乏经验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T19:24:26.803

如果它使用 MSI 文件，您可以使用 Orca 或 SuperOrca 来获取里面的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-16T23:15:02.773

这通常是*重新打包软件*的工作。此类工具有几种工作方式，但通常是通过在将系统安装到干净系统之前和之后查看系统，并根据检测到的更改构建自定义安装程序。这通常是为了生成定制的安装和/或可以在其部署中自动化的安装。我不知道有一个会生成 NSIS 包，今天的标准格式是 MSI（Windows Installer）。

如果您有原始安装程序，则任何重新打包程序都可以，但即使没有原始安装程序，您也可以按照此处其他一些人的建议进行操作，并监控应用程序的使用以满足其要求。两个最流行的重新打包工具是 InstallShield AdminStudio 和 Wise Package Studio。该功能也可能是设置创作解决方案的一部分，因此如果可以，请与您的内部开发人员联系。

可以[在 AppDeploy.com上找到重新打包工具的完整列表](http://www.appdeploy.com/tools/browse.asp?startnum=1&catmatch=2014&sortby=TotalScore)

[AppDeploy Repackager](http://www.appdeploy.com/tools/repackager)是一个免费的重新打包工具，可用于从另一个 [legacy] 设置工具（我必须透露我参与其中）创建 Windows Installer 设置。另一个免费的重新打包程序是 WinINSTALL LE。

# asp.net - 向 ASP.NET Gridview 添加动态列

> ID：234935
> 
> 赞同：15
> 
> 时间：2008-10-24T19:21:58.260
> 
> 标签：asp.net, gridview, dynamic

我在将列动态添加到 GridView 时遇到问题。我需要根据 DropDownList 中的值更改布局——即包含的列。当用户更改此列表中的选择时，我需要删除除第一列之外的所有列，并根据选择动态添加其他列。

我的标记中只定义了一个列——第 0 列，一个模板列，我在其中声明了一个 Select 链接和另一个特定于应用程序的 LinkBut​​ton。该列需要始终存在。当创建 ListBoxSelection 时，我删除除第一列之外的所有列，然后重新添加所需的列（在此示例中，我将其简化为始终添加“标题”列）。以下是部分代码：

```
RemoveVariableColumnsFromGrid();
BoundField b = new BoundField();
b.DataField = "Title";
this.gvPrimaryListView.Columns.Add(b);
this.gvPrimaryListView.DataBind();

private void RemoveVariableColumnsFromGrid() {
    int ColCount = this.gvPrimaryListView.Columns.Count;
    //Leave column 0 -- our select and view template column
    while (ColCount > 1) {
        this.gvPrimaryListView.Columns.RemoveAt(ColCount - 1);
        --ColCount;
    }
} 
```

这段代码第一次运行时，我看到了静态列和动态添加的“标题”列。但是，下次进行选择时，第一列生成为空（其中没有任何内容）。我看到了标题列，我看到了它左边的第一列——但里面没有生成任何东西。在调试器中，我可以看到 gvPrimaryListView 确实仍然有两列，第一列（索引 0）确实是一个模板列。事实上，该列甚至保留了它的宽度，在下面的标记中设置为 165px（用于调试目的）。

有任何想法吗？

```
<asp:GridView ID="gvPrimaryListView" runat="server" Width="100%" AutoGenerateColumns="false"
    DataKeyNames="Document_ID" EnableViewState="true" DataSourceID="odsPrimaryDataSource"
    AllowPaging="true" AllowSorting="true" PageSize="10" OnPageIndexChanging="activeListView_PageIndexChanging"
    AutoGenerateSelectButton="False" OnSelectedIndexChanged="activeListView_SelectedIndexChanged"
    Visible="true" OnRowDataBound="CtlDocList_RowDataBound" Font-Size="8pt" Font-Names="Helvetica">
    <Columns>
        <asp:TemplateField ShowHeader="false">
            <ItemTemplate>
                <asp:LinkButton EnableTheming="false" ID="CtlSelectDocRowBtn" runat="server" Text="Select"
                    CommandName="Select" CssClass="gridbutton" OnClick="RowSelectBtn_Click" />
                <asp:ImageButton EnableTheming="false" ID="DocViewBtn" runat="server" ImageUrl="../../images/ViewDoc3.png"
                    CssClass="gridbutton" CommandName="Select" OnClick="DocViewBtn_Click" />
            </ItemTemplate>
            <ItemStyle Width="165px" />
        </asp:TemplateField>
    </Columns>
    <EmptyDataTemplate>
        <asp:Label ID="Label6" runat="server" Text="No rows found." SkinID="LabelHeader"></asp:Label>
    </EmptyDataTemplate>
</asp:GridView> 
```

* * *

只是一些额外的信息。

它与它是第一列这一事实无关，而是与它是一个 TemplateField 的事实有关。如果我将一个普通列放在左侧（在标记中）并将 TemplateField 列向右移动，则第一列呈现良好，并且（现在是第二个）TemplateField 列消失。

另一个奇怪的事情——问题不会发生在第一次回发——或第二次——但它从第三次回发开始，然后继续进行后续的回发。我难住了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-30T16:18:37.460

我最近用网格视图中的动态列解决了类似的问题，也许这会有所帮助。

首先关闭视图状态
其次以编程方式在 oninit 事件中触发的函数中添加列
最后我使用以下帮助程序类在 RowDataBound 事件启动时使复选框实例化。是的，其中一些是硬编码的。

哎呀，这是所有的代码。试试看:) 保固原样，等等等等……

最后，由于我刚刚弄湿了 DotNet，任何提示都将不胜感激 [IE 不要太撕我 :) ]。是的，从某处“借用”了网络上的初始代码，对不起，我不记得了:(

-- 在受保护的覆盖无效 OnInit 中触发它

```
 private void GridViewProject_AddColumns()
    {
        DataSet dsDataSet = new DataSet();
        TemplateField templateField = null;

        try
        {
            StoredProcedure sp = new StoredProcedure("ExpenseReportItemType_GetList", "INTRANETWEBDB", Context.User.Identity.Name);
            dsDataSet = sp.GetDataSet();

            if (sp.RC != 0 && sp.RC != 3000)
            {
                labelMessage.Text = sp.ErrorMessage;
            }

            int iIndex = 0;
            int iCount = dsDataSet.Tables[0].Rows.Count;
            string strCategoryID = "";
            string strCategoryName = "";
            iStaticColumnCount = GridViewProject.Columns.Count;

            // Insert all columns immediatly to the left of the LAST column
            while (iIndex < iCount)
            {
                strCategoryName = dsDataSet.Tables[0].Rows[iIndex]["CategoryName"].ToString();
                strCategoryID = dsDataSet.Tables[0].Rows[iIndex]["CategoryID"].ToString();

                templateField = new TemplateField();
                templateField.HeaderTemplate = new GridViewTemplateExternal(DataControlRowType.Header, strCategoryName, strCategoryID);
                templateField.ItemTemplate = new GridViewTemplateExternal(DataControlRowType.DataRow, strCategoryName, strCategoryID);
                templateField.FooterTemplate = new GridViewTemplateExternal(DataControlRowType.Footer, strCategoryName, strCategoryID);

                // Have to decriment iStaticColumnCount to insert dynamic columns BEFORE the edit row
                GridViewProject.Columns.Insert((iIndex + (iStaticColumnCount-1)), templateField);
                iIndex++;
            }
            iFinalColumnCount = GridViewProject.Columns.Count;
            iERPEditColumnIndex = (iFinalColumnCount - 1); // iIndex is zero based, Count is not
        }
        catch (Exception exception)
        {
            labelMessage.Text = exception.Message;
        }
    } 
```

-- 助手类

```
public class GridViewTemplateExternal : System.Web.UI.ITemplate
{
    #region Fields
    public DataControlRowType DataRowType;
    private string strCategoryID;
    private string strColumnName;
    #endregion

    #region Constructor
    public GridViewTemplateExternal(DataControlRowType type, string ColumnName, string CategoryID)
    {
        DataRowType = type; // Header, DataRow,
        strColumnName = ColumnName; // Header name
        strCategoryID = CategoryID;
    }
    #endregion

    #region Methods
    public void InstantiateIn(System.Web.UI.Control container)
    {
        switch (DataRowType)
        {
            case DataControlRowType.Header:
                // build the header for this column
                Label labelHeader = new Label();
                labelHeader.Text = "<b>" + strColumnName + "</b>";
                // All CheckBoxes "Look Up" to the header row for this information
                labelHeader.Attributes["ERICategoryID"] = strCategoryID;
                labelHeader.Style["writing-mode"] = "tb-rl";
                labelHeader.Style["filter"] = "flipv fliph";
                container.Controls.Add(labelHeader);
                break;
            case DataControlRowType.DataRow:
                CheckBox checkboxAllowedRow = new CheckBox();
                checkboxAllowedRow.Enabled = false;
                checkboxAllowedRow.DataBinding += new EventHandler(this.CheckBox_DataBinding);
                container.Controls.Add(checkboxAllowedRow);
                break;
            case DataControlRowType.Footer:
                // No data handling for the footer addition row
                CheckBox checkboxAllowedFooter = new CheckBox();
                container.Controls.Add(checkboxAllowedFooter);
                break;
            default:
                break;
        }
    }
    public void CheckBox_DataBinding(Object sender, EventArgs e)
    {
        CheckBox checkboxAllowed = (CheckBox)sender;// get the control that raised this event
        GridViewRow row = (GridViewRow)checkboxAllowed.NamingContainer;// get the containing row
        string RawValue = DataBinder.Eval(row.DataItem, strColumnName).ToString();
        if (RawValue.ToUpper() == "TRUE")
        {
            checkboxAllowed.Checked = true;
        }
        else
        {
            checkboxAllowed.Checked = false;
        }
    }
    #endregion
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-01T08:28:47.493

通过以下地址将动态列添加到网格视图（ASP）的最佳解决方案：请查看： http: [//www.codeproject.com/Articles/13461/how-to-create-columns-dynamically-in -a-grid-view](http://www.codeproject.com/Articles/13461/how-to-create-columns-dynamically-in-a-grid-view)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-12T02:50:12.533

我写了一篇关于基于用户在 CheckBoxList 控件中选择的列动态填充 GridView 列的类似主题的短文。希望这对那些寻找简单演示的人有所帮助[如何根据用户选择动态生成 GridView 列？](http://www.dotnetfunda.com/articles/article1400-how-to-generate-gridview-columns-dynamically-based-on-user-selection-.aspx).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T19:09:54.280

我今天早些时候发现了这一点：[GridView 中的 TemplateField 在插入 BoundFields 时没有恢复其 ViewState](http://connect.microsoft.com/VisualStudio/feedback/details/104994/templatefield-in-a-gridview-doesnt-have-its-viewstate-restored-when-boundfields-are-inserted)。

看起来 Microsoft 不打算修复的错误，因此您必须尝试上述解决方案之一。我遇到了同样的问题——我有一些 DataBoundFields 和一些 TemplateFields，在回发之后，基于 TemplateField 的列失去了它们的控件和数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T16:26:58.007

Diningphilanderer.myopenid.com 与我推荐的方法类似。

问题是每次回发时您都必须重新绑定网格，因此您必须重建列。我喜欢有一个名为 BindGrid() 的方法，它首先清除 Columns GridView1.Columns.Clear(); 然后以编程方式添加它们，然后设置数据源并调用数据绑定。确保您为网格禁用了视图状态，并且您有 autogeneratecolumns = false;

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-25T15:50:45.570

```
 void Page_PreRenderComplete(object sender, EventArgs e)
    {
        // TemplateField reorder bug: if there is a TemplateField based column (or derived therefrom), GridView may blank out
        // the column (plus possibly others) during any postback, if the user has moved it from its original markup position.
        // This is probably a viewstate bug, as it happens only if a TemplateField based column has been moved.  The workaround is
        // to force a databind before each response. See https://connect.microsoft.com/VisualStudio/feedback/details/104994/templatefield-in-a-gridview-doesnt-have-its-viewstate-restored-when-boundfields-are-inserted
        //
        // This problem is also happening for grid views inside a TabPanel, even if the TemplateField based columns have not
        // been moved.  Also do a databind in that case.
        //
        // We also force a databind right after the user has submitted the column chooser dialog.
        // (This is because the user could have moved TemplateField based column(s) but ColChooserHasMovedTemplateFields()
        // returns false -- ie when the user has moved all TemplateField based columns back to their original positions.
        if ((!_DataBindingDone && (ColChooserHasMovedTemplateFields() || _InTabPanel)) || _ColChooserPanelSubmitted || _ColChooserPanelCancelled)
            DataBind();

        // There is a problem with the GridView in case of custom paging (which is true here) that if we are on the last page,
        // and we delete all row(s) of that page, GridView is not aware of the deletion during the subsequent data binding,
        // will ask the ODS for the last page of data, and will display a blank.  By PreRenderComplete, it will somehow have
        // realized that its PageIndex, PageCount, etc. are too big and updated them properly, but this is too late
        // as the data binding has already occurred with oudated page variables.  So, if we were on the last page just before
        // the last data binding (_LastPageIndex == _LastPageCount - 1) and PageIndex was decremented after the data binding,
        // we know this scenario has happened and we redo the data binding.  See http://scottonwriting.net/sowblog/archive/2006/05/30/163173.aspx
        // for a discussion of the problem when the GridView uses the ODS to delete data.  The discussion also applies when we
        // delete data directly through ClassBuilder objects.
        if (_LastPageIndex == _LastPageCount - 1 && PageIndex < _LastPageIndex)
            DataBind();

        if (EnableColChooser)
        {
            if (!_IsColChooserApplied)
                ApplyColChooser(null, false, false);
            else
            {
                // The purpose of calling ApplyColChooser() here is to order the column headers properly.  The GridView
                // at this point will have reverted the column headers to their original order regardless of ViewState,
                // so we need to apply our own ordering.  (This is not true of data cells, so we don't have to apply
                // ordering to them, as reflected by the parameters of the call.)

                // If we have already processed column reordering upon the column chooser panel being submitted,
                // don't repeat the operation.
                if (!_ColChooserPanelSubmitted)
                    ApplyColChooser(null, false, true);
            }
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T21:08:08.420

I found this little nugget in the documentation, under the DataControlFieldCollection Class.

*If you are using the GridView or DetailsView control, the DataControlField objects that are automatically created (for example, when the AutoGenerateColumns property is true) are not stored in the publicly accessible fields collection. You can only access and manipulate DataControlField objects that are not automatically generated.*

I guess the answer is to do all of your column manipulation in code, and then your approach should work fine.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-29T15:26:13.947

除了动态添加列之外，您是否可以在一开始就定义它们并根据需要隐藏/显示它们（使用 Visible="false" 或将控件/页眉/页脚的 CssClass 设置为具有“显示：无”的类） ? 我在我的一些代码中使用了这个方法，包括模板列，没有问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-30T15:52:11.680

对不起，德克尔。我显然错过了几个关键点.. :)

如果这对您来说仍然是个问题，我想知道您的项目模板中的内容是否有所不同？如果您只是在其中放置一些文本，然后刷新页面几次，文本是否出现在第一次加载时，而不是在第二次加载时？

此外，当问题出现时，单元格中是否有任何 html 标记，或者它们是否完全为空？

# installation - GODI安装错误

> ID：234941
> 
> 赞同：1
> 
> 时间：2008-10-24T19:23:06.087
> 
> 标签：installation, ocaml, godi

我正在运行 Fedora 9 x86_64 并且或多或少是 Linux 新手（不使用它，但安装等）。错误发生在引导程序的第二阶段（即“./bootstrap_stage2”）。它做了很多事情，然后这些错误开始发生：

```
Fatal error: exception Out_of_memory
make[8]: *** [odoc_html.cmo] Error 2
make[8]: Leaving directory `/home/matthew/godi/build/godi/godi-ocaml/work/ocaml/ocamldoc'
make[7]: *** [ocamldoc] Error 2
make[7]: Leaving directory `/home/matthew/godi/build/godi/godi-ocaml/work/ocaml'
Error: Exec error: File /home/matthew/godi/build/godi/godi-ocaml/./../../mk/bsd.pkg.mk, line 1039: Command returned with non-zero exit code
Error: Exec error: File /home/matthew/godi/build/godi/godi-ocaml/./../../mk/bsd.pkg.mk, line 1378: Command returned with non-zero exit code
Error: Command fails with code 1: godi_console
Failure! 
```

我已经运行它来监控我的记忆，并且可以说我肯定没有用完（使用大约 500 个，我有 3 个）。所以有人知道问题是什么吗？我在网上搜索过，但我发现的唯一其他类似的东西是这里的另一个线程（但它有一个不同的错误）

任何帮助将不胜感激，因为我上次安装它时，它完美无缺。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-03T21:09:38.237

这看起来像是64 位平台上旧 OCaml (<3.11)的一个[已知问题，可能是由 Fedora 上启用的堆随机化触发的。](http://caml.inria.fr/mantis/view.php?id=4448)据我所知，它已在最近的版本中得到修复（至少 3.11，可能是 3.10.2）。如果是这种情况，则超过第 3.11 节的最新 GODI 应该可以工作。

# .net - 从 WSDL 文件对 Web 服务接口进行逆向工程的最佳方法是什么？

> ID：234945
> 
> 赞同：3
> 
> 时间：2008-10-24T19:24:29.767
> 
> 标签：.net, web-services, wsdl, reverse-engineering

我在系统上为 Web 服务继承了一个 WSDL 文件，我无权访问该文件以进行开发和测试。

我需要生成一个遵循该 WSDL 的 Web 服务。包装器是 .NET，但如果有一种简单的方法可以在另一个平台上执行此操作，我们也许可以看看。生产 Web 服务是基于 Java 的。

这样做的最佳方法是什么？

注意：继承的 wsdl 似乎与**wsdl.exe**不兼容，因为它不符合 WS-I Basic Profile v1.1。特别是，传递它的小组提到它使用了微软工具不支持的另一个标准，但他们没有澄清。该错误与必需的“名称”字段有关：

```
错误：在中声明的元素引用“{namespace}/:viewDocumentResponse”
来自命名空间 '' 的架构类型 ''
       - 缺少必需的属性“名称”
```

为清楚起见，我知道我可以轻松地从 WSDL 文件创建一个 .NET 包装类，但这不是我需要的。就像这样：

更新：最初的 Web 服务是使用 Axis 创建的。

[显示不可用 Web 服务和模拟 Web 服务的系统图 http://paulw.us/blog/uploads/SO-WSDL-Question2.gif](http://paulw.us/blog/uploads/SO-WSDL-Question2.gif)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T19:40:44.197

通过使用该选项，您可能会发现 .NET 的[命令行实用程序很有用。`wsdl.exe`](http://msdn.microsoft.com/en-us/library/7h3ystb6(VS.80).aspx)`/serverInterface`根据文档：

> 为 ASP.NET Web 服务的服务器端实现生成接口。为 WSDL 文档中的每个绑定生成一个接口。WSDL 单独实现 WSDL 契约（实现接口的类不应在类方法中包含以下任何一种：Web 服务属性或更改 WSDL 契约的序列化属性）。缩写形式是“/si”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-25T01:06:56.050

我们正在使用Thinktecture 的 WSCF [- Web Services Contract First](http://www.thinktecture.com/resourcearchive/tools-and-software/wscf) 工具进行 Web 服务开发，首先创建 XSD 模式，然后使用该工具生成服务接口。从 WSDL 生成服务接口可能很有用，但我自己还没有尝试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T21:22:51.390

是的 - 您可以使用 WSCF（如上所述）生成服务器端代码。然后可以覆盖实际 URL 以指向您要使用的测试 URL。

但是，这只会生成一个存根。您仍然需要编写实际的例如 GetCustomers() 方法，这有点令人怀疑，因为您不知道实际的实现是如何工作的。

然后您可以模拟它或创建一个简单的 ASP Web 服务器来运行它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T19:45:31.910

尝试使用[RhinoMocks](http://ayende.com/projects/rhino-mocks.aspx)和[StructureMap](http://structuremap.sourceforge.net/Default.htm)模拟包装器接口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T19:52:26.840

不确定这是否会有所帮助，

我最近做的是：

*   使用 wsdl 工具或 Visual Studio 生成 .cs 文件
*   我已将其更改为部分课程
*   我创建了另一个部分类，它所做的只是添加一行来说明该类实​​现了 IWhatEver
*   我创建了一个与生成的代理类相同的接口（因此代理完全实现了该接口）

然后我在我的例子中使用了一个 Mocking 框架（Moq）来模拟 WebService，然后我使用了糟糕的依赖注入（将模拟传递给被测类的构造函数）.. 它可以处理一个实例随便

测试一下。。

希望有帮助

# cakephp - 如何在 CakePHP 的视图文件中访问通过 URL 发送的参数？

> ID：234949
> 
> 赞同：6
> 
> 时间：2008-10-24T19:26:01.013
> 
> 标签：cakephp, parameters

我是 CakePHP 的新手，但我一直在阅读他们的常见问题解答和指南，但无济于事。这很简单，我不能直截了当地思考：

如何访问通过我的视图文件中的 URL 发送的参数？

示例：[http ://example.com/view/6](http://example.com/view/6)

我将如何获取该参数（“6”）并将其通过控制器循环到另一个视图页面？

如果这对于快速回答来说太复杂了，我如何在视图页面本身中引用 6？这种情况下的 6 是我数据库中的“Id”值，我需要将其设置为“父”-

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-02-27T22:25:22.593

可以像这样检索参数

```
$this->params['pass'] 
```

在 Action 之后返回 URL 参数的数组（数字索引）。

```
// URL: /posts/view/12/print/narrow
Array
(
    [0] => 12
    [1] => print
    [2] => narrow
) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T19:55:57.550

要访问视图中的参数，请*查看*`$this->params`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T19:45:44.327

正如您所拥有的那样，该 URL 将调用您的 ViewController 的 6() 方法，这不是有效的方法名称。您可能必须使用您的路线才能使其发挥作用。

如果您不想配置路由，则需要 URL 中的控制器，如下所示：

```
http://example.com/thinger/view/6 
```

这将调用`thingerControllerObject->view("6")`. 如果您希望“/view/”采用不同的方法，请编辑路线。看：

*   [蛋糕控制器](http://book.cakephp.org/2.0/en/controllers.html)
*   [蛋糕路线](http://book.cakephp.org/2.0/en/development/routing.html#routes-configuration)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-29T12:43:20.293

在视图文件中使用以下代码：

```
$url=Router::url($this->here, true);
$url_arr=explode("/",$url); 
```

要查看`$url`被分解的内容，只需使用 pr() 打印它，如下所示：

```
pr($url_arr); 
```

它将打印关联数组，因此您可以访问通过 url 发送的任何特定数量的参数。

# emacs - 在 Emacs 中重新打开 *scratch* 缓冲区？

> ID：234963
> 
> 赞同：172
> 
> 时间：2008-10-24T19:30:09.850
> 
> 标签：emacs

如果我不小心关闭了Emacs 中的*暂存*缓冲区，我该如何创建一个新的*暂存*缓冲区？

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2008-10-24T20:00:51.097

GNU Emacs 默认绑定：

> `C-x``b` `*scratch*` `RET`

或者，更详细地说

> `M-x` `switch-to-buffer *scratch*` `RET`

`*scratch*`缓冲区是启动时选择的缓冲区，主要模式为Lisp [Interaction](http://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Interaction.html)。注意：`*scratch*`缓冲区的模式由变量控制[`initial-major-mode`](http://www.gnu.org/software/emacs/manual/html_node/emacs/Entering-Emacs.html)。

通常，您可以根据需要创建任意数量的“临时”缓冲区，并根据您的选择命名它们。

> `C-x``b` `NAME` `RET`

切换到一个缓冲区`NAME`，如果它不存在则创建它。`C-x``C-w`在您使用(或`M-x` `write-file` `RET`) 选择应保存的文件之前，新缓冲区不会与磁盘上的文件相关联。

> `M-x` `text-mode` `RET`

将当前缓冲区的主要模式更改为文本模式。要查找所有可用模式（即，不需要任何新包），您可以通过键入以下内容获取列表：

> `M-x` `apropos-command -mode$` `RET`

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-11T09:09:01.030

我在我的 .emacs 中添加以下内容：

```
;; bury *scratch* buffer instead of kill it
(defadvice kill-buffer (around kill-buffer-around-advice activate)
  (let ((buffer-to-kill (ad-get-arg 0)))
    (if (equal buffer-to-kill "*scratch*")
        (bury-buffer)
      ad-do-it))) 
```

如果我不想看到*暂存*缓冲区，请按 Cx Ck ，但它不会杀死它，只需将其放在缓冲区列表的末尾，这样下次我就不需要创建新缓冲区了。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-07-30T10:17:02.113

[这个 EmacsWiki 页面](http://emacswiki.org/emacs/RecreateScratchBuffer)上有一大堆技巧。

这是第一个：

> 重新创建暂存缓冲区的一个非常简单的函数：

```
(defun create-scratch-buffer nil
   "create a scratch buffer"
   (interactive)
   (switch-to-buffer (get-buffer-create "*scratch*"))
   (lisp-interaction-mode)) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-24T19:35:13.630

Cx b `*scratch*`RET y RET 启用 iswitchb 模式。

否则只需 Cx b `*scratch*`RET。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-24T20:41:22.653

我在几年前第一次开始使用 emacs 时发现了这一点；我不知道现在在哪里，但它一直在我的个人 .el 文件中占有一席之地。它确实在谷歌搜索中弹出。

```
;;; Prevent killing the *scratch* buffer -- source forgotten
;;;----------------------------------------------------------------------
;;; Make the *scratch* buffer behave like "The thing your aunt gave you,
;;; which you don't know what is."
(save-excursion
  (set-buffer (get-buffer-create "*scratch*"))
  (make-local-variable 'kill-buffer-query-functions)
  (add-hook 'kill-buffer-query-functions 'kill-scratch-buffer))

(defun kill-scratch-buffer ()
  ;; The next line is just in case someone calls this manually
  (set-buffer (get-buffer-create "*scratch*"))

  ;; Kill the current (*scratch*) buffer
  (remove-hook 'kill-buffer-query-functions 'kill-scratch-buffer)
  (kill-buffer (current-buffer))

  ;; Make a brand new *scratch* buffer
  (set-buffer (get-buffer-create "*scratch*"))
  (lisp-interaction-mode)
  (make-local-variable 'kill-buffer-query-functions)
  (add-hook 'kill-buffer-query-functions 'kill-scratch-buffer)

  ;; Since we killed it, don't let caller do that.
  nil)
;;;---------------------------------------------------------------------- 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-25T09:20:30.023

我曾经使用 dwj 的解决方案，对此我感到非常高兴，直到有一天我意识到当您实际*重命名*暂存缓冲区（例如通过保存它）时它失败了。

然后我采用了这个，这对我很有效：

```
 (run-with-idle-timer 1 t
    '(lambda () (get-buffer-create "*scratch*"))) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-01-11T14:23:07.133

就像文档字符串说的那样，这个函数将：

> 切换到暂存缓冲区。如果缓冲区不存在，则创建它并将初始消息写入其中。”

这将带来一个新的暂存缓冲区，它看起来像初始暂存缓冲区。

```
(defun switch-buffer-scratch ()
  "Switch to the scratch buffer. If the buffer doesn't exist,
create it and write the initial message into it."
  (interactive)
  (let* ((scratch-buffer-name "*scratch*")
         (scratch-buffer (get-buffer scratch-buffer-name)))
    (unless scratch-buffer
      (setq scratch-buffer (get-buffer-create scratch-buffer-name))
      (with-current-buffer scratch-buffer
        (lisp-interaction-mode)
        (insert initial-scratch-message)))
    (switch-to-buffer scratch-buffer)))

(global-set-key "\C-cbs" 'switch-buffer-scratch) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-01-11T03:07:33.003

我有`scratch`一个交互式命令来打开一个新的暂存缓冲区（我喜欢有几个）：

```
(defun scratch ()
  "create a new scratch buffer to work in. (could be *scratch* - *scratchX*)"
  (interactive)
  (let ((n 0)
        bufname)
    (while (progn
             (setq bufname (concat "*scratch"
                                   (if (= n 0) "" (int-to-string n))
                                   "*"))
             (setq n (1+ n))
             (get-buffer bufname)))
  (switch-to-buffer (get-buffer-create bufname))
  (if (= n 1) initial-major-mode))) ; 1, because n was incremented 
```

来自：[http ://everything2.com/index.pl?node_id=1038451](http://everything2.com/index.pl?node_id=1038451)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-01-16T09:58:28.827

```
(global-set-key (kbd "C-x M-z")
                '(lambda ()
                   (interactive)
                   (switch-to-buffer "*scratch*"))) 
```

这不仅会快速切换到`*scratch*`缓冲区（因为我经常这样做），而且会重新创建`*scratch*`缓冲区并`lisp-interaction-mode`在您意外杀死它时自动启用。根据需要更改绑定。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-04-21T20:38:38.497

请注意，MELPA 中的 emacs 包`unkillable-scratch`会执行此操作。还有`scratch-persist`一个会自动保存和恢复会话之间的缓冲区。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-22T07:39:08.600

这就是我使用的 - 我将它绑定到一个方便的击键。它会将您发送到`*scratch*`缓冲区，无论它是否已经存在，并将其设置为`lisp-interaction-mode`

```
(defun eme-goto-scratch () 
  "this sends you to the scratch buffer"
  (interactive)
  (let ((eme-scratch-buffer (get-buffer-create "*scratch*")))
    (switch-to-buffer eme-scratch-buffer)
    (lisp-interaction-mode))) 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-01-12T05:49:38.847

我更喜欢让我的暂存缓冲区成为自动保存的实际文件，重新打开它就像打开文件一样简单。在启动时，我杀死默认设置并找到我自己的这样。

```
(add-hook 'emacs-startup-hook
  (lambda ()
    (kill-buffer "*scratch*")
    (find-file "/Users/HOME/Desktop/.scratch"))) 
```

我有一个自定义的 kill-buffer 函数，它基本上做同样的事情——重新打开我的个人暂存文件并在我杀死最后一个可见缓冲区时终止默认*暂存*。

我自定义了一些要*在之后*`desktop.el`加载的函数，以便在退出 Emacs 时最后可见的文件不会被默认划痕埋没，也不会在启动 Emacs 时被我的自定义划痕埋没。 *`(kill-buffer "*scratch*")``(find-file "/Users/HOME/Desktop/.scratch")`*

 *我喜欢使用`auto-save-buffers-enhanced`，它会自动保存未明确排除的任何文件扩展名：

[https://github.com/kentaro/auto-save-buffers-enhanced/blob/master/auto-save-buffers-enhanced.el](https://github.com/kentaro/auto-save-buffers-enhanced/blob/master/auto-save-buffers-enhanced.el)

```
(require 'auto-save-buffers-enhanced)
(auto-save-buffers-enhanced t)
(setq auto-save-buffers-enhanced-save-scratch-buffer-to-file-p 1)
(setq auto-save-buffers-enhanced-exclude-regexps '("\\.txt" "\\.el" "\\.tex")) 
```

当我想创建一个无文件访问缓冲区时，我使用了@paprika 函数的细微变化：

```
(defun lawlist-new-buffer ()
  "Create a new buffer -- \*lawlist\*"
(interactive)
  (let* (
    (n 0)
    bufname)
  (catch 'done
    (while t
      (setq bufname (concat "*lawlist"
        (if (= n 0) "" (int-to-string n))
          "*"))
      (setq n (1+ n))
      (if (not (get-buffer bufname))
        (throw 'done nil)) ))
  (switch-to-buffer (get-buffer-create bufname))
  (text-mode) )) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-11-12T11:58:45.280

我已将迄今为止发布的解决方案组合成一个功能：

```
(defun --scratch-buffer(&optional reset)
  "Get the *scratch* buffer object.
Make new scratch buffer unless it exists. 
If RESET is non-nil arrange it that it can't be killed."
  (let ((R (get-buffer "*scratch*")))
    (unless R
      (message "Creating new *scratch* buffer")
      (setq R (get-buffer-create "*scratch*") reset t))
        (when reset
          (save-excursion
            (set-buffer R)
            (lisp-interaction-mode)
            (make-local-variable 'kill-buffer-query-functions)
            (add-hook 'kill-buffer-query-functions '(lambda()(bury-buffer) nil)
          )))
    R)) 
```

*要在.emacs*中应用此功能，请使用：

```
(--scratch-buffer t)
(run-with-idle-timer 3 t '--scratch-buffer) 
```

这将使暂存缓冲区一开始就坚不可摧，如果保存，它将被重新创建。此外，我们可以使用快捷功能`scratch`来快速调出缓冲区：

```
(defun scratch()
  "Switch to *scratch*.  With prefix-arg delete its contents."
  (interactive)
  (switch-to-buffer (--scratch-buffer))
  (if current-prefix-arg
      (delete-region (point-min) (point-max))
    (goto-char (point-max)))) 
```

过去，了解 Emacs 启动的原始启动目录已被证明是有用的。这是暂存缓冲区的值`desktop-dirname`或局部变量：`default-directory`

```
(defvar --scratch-directory
  (save-excursion (set-buffer "*scratch*") default-directory)
  "The `default-directory' local variable of the *scratch* buffer.")

(defconst --no-desktop (member "--no-desktop" command-line-args)
  "True when no desktop file is loaded (--no-desktop command-line switch set).")

(defun --startup-directory ()
  "Return directory from which Emacs was started: `desktop-dirname' or the `--scratch-directory'.
Note also `default-minibuffer-frame'."
  (if (and (not --no-desktop) desktop-dirname) 
      desktop-dirname
    --scratch-directory)) 
```

因此*--startup-directory*将始终返回您的 makefile、TODO 文件等的基本目录。如果没有桌面（*--no-desktop*命令行开关或没有桌面文件），该`--scratch-directory`变量将保存 Emacs 曾经的目录下开始。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-10-08T03:03:26.517

在 EmacsWiki 中找到答案：[http ://www.emacswiki.org/emacs/RecreateScratchBuffer](http://www.emacswiki.org/emacs/RecreateScratchBuffer)

```
(defun create-scratch-buffer nil
   "create a scratch buffer"
   (interactive)
   (switch-to-buffer (get-buffer-create "*scratch*"))
   (lisp-interaction-mode)) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-01-21T14:33:55.750

要添加到已接受的答案，如果您打开了 ILO 模式（并且它在 之后自动完成`C-x` `b`，因此不允许您编写`*scratch*`），然后尝试：

> `C-x``b` `C-b``*scratch*` `RET`

`C-x b C-b *scratch* RET`

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2008-10-24T19:37:14.080

> `C-x``b` 然后输入`*scratch*` `↩︎`

创建一个也处于 lisp 交互模式的新缓冲区。

# c# - 在 C# 中确定会话变量为空或为空的最佳方法是什么？

> ID：234973
> 
> 赞同：79
> 
> 时间：2008-10-24T19:33:00.407
> 
> 标签：c#, asp.net, session

在 ASP.NET C# 中检查会话变量是否存在的最佳方法是什么？

我喜欢将`String.IsNullOrEmpty()`作品用于字符串，并想知道是否有类似的方法用于`Session`. 目前我知道的唯一方法是：

```
 var session;
 if (Session["variable"] != null)
 {
     session = Session["variable"].ToString();
 }
 else
 {
     session = "set this";
     Session["variable"] = session;
 } 
```

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2008-10-24T20:25:41.873

跟随其他人所说的。我倾向于有两层：

**核心层。这是在几乎所有 Web 应用程序项目中添加的 DLL 中**。在这个我有一个 SessionVars 类，它为 Session 状态获取器/设置器执行 grunt 工作。它包含如下代码：

```
public class SessionVar
{
    static HttpSessionState Session
    {
        get
        {
            if (HttpContext.Current == null)
                throw new ApplicationException("No Http Context, No Session to Get!");

            return HttpContext.Current.Session;
        }
    }

    public static T Get<T>(string key)
    {
        if (Session[key] == null)
            return default(T);
        else
            return (T)Session[key];
    }

    public static void Set<T>(string key, T value)
    {
        Session[key] = value;
    }
} 
```

注意获取任何类型的泛型。

然后，我还为特定类型添加 Getters/Setters，尤其是字符串，因为我经常更喜欢使用 string.Empty 而不是 null 来处理呈现给用户的变量。

例如：

```
public static string GetString(string key)
{
    string s = Get<string>(key);
    return s == null ? string.Empty : s;
}

public static void SetString(string key, string value)
{
    Set<string>(key, value);
} 
```

等等...

**然后我创建包装器将其抽象出来并将其带到应用程序模型中。例如，如果我们有客户详细信息：**

```
public class CustomerInfo
{
    public string Name
    {
        get
        {
            return SessionVar.GetString("CustomerInfo_Name");
        }
        set
        {
            SessionVar.SetString("CustomerInfo_Name", value);
        }
    }
} 
```

你明白吗？:)

**注意：**在为已接受的答案添加评论时想到了。使用状态服务器时，在将对象存储在 Session 中时，始终确保对象是可序列化的。在网络农场上尝试使用泛型保存对象非常容易，而且它会蓬勃发展。我在工作中部署在网络农场上，因此在核心层中对我的代码添加了检查，以查看对象是否可序列化，这是封装 Session Getter 和 Setter 的另一个好处:)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-24T19:37:44.047

这几乎就是你的做法。但是，您可以使用更短的语法。

```
sSession = (string)Session["variable"] ?? "set this"; 
```

这就是说如果会话变量为空，则将 sSession 设置为“设置此”

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-24T19:59:42.007

将它包装在属性中可能会使事情变得更加优雅。

```
string MySessionVar
{
   get{
      return Session["MySessionVar"] ?? String.Empty;
   }
   set{
      Session["MySessionVar"] = value;
   }
} 
```

然后你可以把它当作一个字符串。

```
if( String.IsNullOrEmpty( MySessionVar ) )
{
   // do something
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-24T21:00:24.487

c# 3.0 中的“as”表示法非常干净。由于所有会话变量都是可为空的对象，因此您可以获取该值并将其放入您自己的类型变量中，而不必担心引发异常。大多数对象都可以这样处理。

```
string mySessionVar = Session["mySessionVar"] as string; 
```

我的概念是您应该将 Session 变量拉入局部变量，然后适当地处理它们。始终假设您的 Session 变量可以为空，并且永远不会将它们转换为不可为空的类型。

如果您需要一个不可为空的类型变量，则可以使用 TryParse 来获得它。

```
int mySessionInt;
if (!int.TryParse(mySessionVar, out mySessionInt)){
   // handle the case where your session variable did not parse into the expected type 
   // e.g. mySessionInt = 0;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-23T01:30:45.583

在我看来，最简单且清晰易读的方法是：

```
 String sVar = (string)(Session["SessionVariable"] ?? "Default Value"); 
```

它可能不是最有效的方法，因为即使在默认情况下它也会转换默认字符串值（将字符串转换为字符串），但如果您将其作为标准编码实践，您会发现它适用于所有数据类型，并且易于阅读。

例如（一个完全虚假的例子，但它说明了这一点）：

```
 DateTime sDateVar = (datetime)(Session["DateValue"] ?? "2010-01-01");
 Int NextYear = sDateVar.Year + 1;
 String Message = "The Procrastinators Club will open it's doors Jan. 1st, " +
                  (string)(Session["OpeningDate"] ?? NextYear); 
```

我喜欢泛型选项，但它似乎有点矫枉过正，除非你希望到处都需要它。可以修改扩展方法以专门扩展 Session 对象，使其具有“安全”获取选项，例如 Session.StringIfNull("SessionVar") 和 Session["SessionVar"] = "myval"; 它打破了通过 Session["SessionVar"] 访问变量的简单性，但它是干净的代码，并且仍然允许验证是否为 null 或是否为字符串（如果需要）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-05-17T13:35:35.780

此方法也不假定 Session 变量中的对象是字符串

```
if((Session["MySessionVariable"] ?? "").ToString() != "")
    //More code for the Code God 
```

所以基本上在将空变量转换为字符串之前用空字符串替换它，因为它`ToString`是`Object`类的一部分

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-24T19:39:09.597

检查无/空是这样做的方法。

处理对象类型不是要走的路。声明一个严格类型并尝试将对象转换为正确的类型。（并使用强制转换提示或转换）

```
 private const string SESSION_VAR = "myString";
 string sSession;
 if (Session[SESSION_VAR] != null)
 {
     sSession = (string)Session[SESSION_VAR];
 }
 else
 {
     sSession = "set this";
     Session[SESSION_VAR] = sSession;
 } 
```

对不起任何语法违规，我是一个日常的VB'er

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T20:23:24.547

通常，我为会话中的项目创建具有强类型属性的 SessionProxy。访问这些属性的代码检查是否为空，并将转换为正确的类型。这样做的好处是我所有与会话相关的项目都保存在一个地方。我不必担心在代码的不同部分使用不同的键（并且想知道为什么它不起作用）。通过依赖注入和模拟，我可以通过单元测试对其进行全面测试。如果遵循 DRY 原则，也让我定义合理的默认值。

```
public class SessionProxy
{
    private HttpSessionState session; // use dependency injection for testability
    public SessionProxy( HttpSessionState session )
    {
       this.session = session;  //might need to throw an exception here if session is null
    }

    public DateTime LastUpdate
    {
       get { return this.session["LastUpdate"] != null
                         ? (DateTime)this.session["LastUpdate"] 
                         : DateTime.MinValue; }
       set { this.session["LastUpdate"] = value; }
    }

    public string UserLastName
    {
       get { return (string)this.session["UserLastName"]; }
       set { this.session["UserLastName"] = value; }
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-25T07:26:05.833

我还喜欢将会话变量包装在属性中。这里的设置器是微不足道的，但我喜欢编写 get 方法，因此它们只有一个退出点。为此，我通常在返回会话变量的值之前检查 null 并将其设置为默认值。像这样的东西：

```
string Name
{
   get 
   {
       if(Session["Name"] == Null)
           Session["Name"] = "Default value";
       return (string)Session["Name"];
   }
   set { Session["Name"] = value; }
} 
```

}

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-08T12:38:54.253

通过这种方式可以检查这样的密钥是否可用

```
if (Session.Dictionary.ContainsKey("Sessionkey"))  --> return Bool 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-24T19:47:56.507

您使用的是 .NET 3.5 吗？创建一个 IsNull 扩展方法：

```
public static bool IsNull(this object input)
{
    input == null ? return true : return false;
}

public void Main()
{
   object x = new object();
   if(x.IsNull)
   {
      //do your thing
   }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-24T19:51:42.677

如果您知道它是一个字符串，则可以使用 String.IsEmptyOrNull() 函数。

# c# - 在 C# 中实现文件访问的最佳方法

> ID：234976
> 
> 赞同：3
> 
> 时间：2008-10-24T19:33:11.183
> 
> 标签：c#, wcf, file, coding-style

场景 - 我需要访问一个 HTML 模板以从我的业务逻辑层生成一封电子邮件。它是一个类库，包含一个包含文件的子文件夹。当我在单元测试中尝试以下代码时：

```
string FilePath = string.Format(@"{0}\templates\MyFile.htm", Environment.CurrentDirectory);
string FilePath1 = string.Format(@"{0}\templates\MyFile.htm", System.AppDomain.CurrentDomain.BaseDirectory); 
```

它使用 C:\WINNT\system32\ 或 ASP.NET 临时文件夹目录。

无需使用 app.config 或 web.config 文件来访问此文件的最佳方法是什么？

[这是使用 WCF 服务]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T19:35:24.207

您是从 ASP.Net 应用程序运行它的，对吗？改为使用`Server.MapPath()`。

另请查看`System.IO.Path.Combine()`连接路径。

[编辑]因为你不能使用`System.Web`，试试这个：

```
System.Reflection.Assembly.GetExecutingAssembly().Location 
```

或`GetEntryAssembly()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-08T04:36:33.877

我在我的网站上得到了这个工作！在过去的 2 年里，我一直没有在做这个！！！！

我在 web.config 的 system.serviceModel 块中添加了这个。它似乎使所有路径都相对于您的服务的安装位置。

```
 <system.serviceModel>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true"> 
```

迟到总比不到好？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T20:19:17.737

我相信你正在寻找

```
System.IO.Path.GetDirectoryName(Application.ExecutablePath); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T19:37:07.807

利用

```
System.Web.HttpServerUtility.MapPath( "~/templates/myfile.htm" ) 
```

# java - Class.getResource 中奇怪的区分大小写错误？

> ID：234990
> 
> 赞同：9
> 
> 时间：2008-10-24T19:37:20.520
> 
> 标签：java, resources

我正在使用以下代码加载图像资源，它在我的开发环境（netbeans）中运行良好，但从桌面运行时立即抛出异常。

```
new ImageIcon(Images.class.getResource("images/highlighter24.gif")); 
```

我将其追溯到我的文件，其大小写与代码中的不同。

好吧，我的错，但为什么不一致的行为？

小精灵？

注意：在你问之前，我正在 Windows 上运行。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-24T19:39:39.987

让我猜猜：在 NetBeans 中，它是从文件系统加载它（不区分大小写），而从桌面运行它时，它是在一个 jar 文件中（区分大小写）。

我以前见过这样的事情，一个 web 应用程序在 Windows 上运行良好，但在 Unix 上却失败了，因为我们在 URL 中弄错了大小写。

如果您将 jar 文件视为“只是另一个文件系统”，那么这是有道理的，即使不一致会有点烦人。

# visual-c++ - 如何在自定义淹没 CListCtrl 中更改项目大小和它们之间的间隙

> ID：234993
> 
> 赞同：1
> 
> 时间：2008-10-24T19:38:24.777
> 
> 标签：visual-c++, mfc, listview, custom-draw

据我所知`ON_WM_MEASUREITEM`，不会在自定义绘制列表控件中调用。仅当控件为所有者绘制时才使用。

我找到了一种方法来做到这一点，但这有点像 HACK，我仍然无法控制它们以某种方式自动设置的项目之间的差距。

诀窍是您可以`CImageList`使用所需大小的未使用图像创建，如果将此类图像列表分配给列表控件，则项目的大小将调整为接近图像大小的尺寸。之后，您可以使用自定义绘图在这些放大的项目中绘制任何内容。

```
CImageList m_imageList1;
m_imageList1.Create(176, 144, ILC_COLOR32 | ILC_MASK, 5, 1);
GetListCtrl().SetImageList(&m_imageList1, LVSIL_NORMAL); 
```

所以问题是如何在自定义淹没控件中更改项目大小和它们之间的间距？

`LVS_OWNERDRAWFIXED`还是我唯一的选择是完全由所有者绘制的控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-26T14:58:46.813

更新。
我在 VS2008 中编译了相同的自定义绘制列表控件。而且神色不一样了。物品尺寸完美，物品之间没有间隙。我想我遇到的尺寸问题只是在 VS2003 的 MFC 中，我最初使用的是 VS2003。
伙计，MFC 是一个持续的 HACK 狂欢 :-)

我想问题已经结束了。
谢谢你（我）。

# .net - 在客户站点比较 .NET 性能与 VB 6 性能的最佳方法是什么？

> ID：234994
> 
> 赞同：3
> 
> 时间：2008-10-24T19:38:40.190
> 
> 标签：.net, sql-server, performance, vb6, novell

两个问题：

1.  有人可以指出将 .NET 性能与 VB 6 性能进行比较的无偏见数据吗？我已经搜索过，但很难找到。
2.  当应用程序在客户站点上运行时，将 .NET 性能与 VB 6 性能进行比较的最佳方法是什么？

我们有一个 WindowsForms 客户端-服务器应用程序（为 2.0 编写，很快升级到 3.5 SP 1），与之前的 VB 6 版本相比，某些客户抱怨“性能缓慢”。我知道，“性能缓慢”是非常模糊和笼统的，但是假设 .NET 代码可能比 VB 6 代码慢，因为 .NET 在 VM 中运行，这是真的吗？我 100% 用 C# 编写代码，所以它没有被第三方或向导移植。

并非所有客户都提出此投诉，因此我们怀疑存在环境问题。我们是在客户现场衡量绩效的唯一选择吗？我们的一些客户在 Novell 网络上的 Windows Server 2003 上使用 SQL Server 2005。与 Windows 网络上的类似机器相比，他们会看到截然不同的数据访问性能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T19:42:57.903

性能几乎*总是*取决于你在做什么。

如果可能的话，去现场观察使用应用程序的客户。找出减速发生的地方，然后对其进行分析 - 理想情况下使用类似数量的数据等。

检查客户站点的客户端和服务器的性能 - 找出真正导致问题的原因。检查网络配置和运行状况 - 愚蠢的设置有时可以让事情正常运行，但速度非常慢。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-24T20:04:45.707

我需要提到的第一件事是 .Net 代码*永远不会*在 VM 中运行。虽然 .Net 程序确实被编译为有点类似于 Java 的 ByteCode 的 IL，但重要的区别在于 IL 在应用程序启动之前又被编译为完全本机代码，而不是由 VM 解释。

继续进行 .Net/VB6 比较。我不能指出具体的数据，但从个人经验来看，这取决于你在做什么。

为了说明这一点，让我们考虑六个不同的基准测试应用程序，每个应用程序都有一个 vb6 和 .Net 版本。每个应用程序选择一个特定的操作，执行 100,000 次，然后记录所用的时间。请注意，这是一个思想实验：我实际上还没有看到真实应用程序的结果。但我觉得我对这两个平台的优势和劣势有所了解。

*   应用程序 A 进行了一些严重的 CPU 密集型运算。在这种情况下，我不得不相信这里的结果几乎是相同的。VB6 和 .Net 都编译为本机代码，因此`mult`无论如何 cpu 指令都是相同的。也就是说，如果您不使用`Option Strict`，您可能很快就会在任一平台上陷入困境。由于您使用了 C#（本质上总是`Option Strict`），因此可以为您的 .Net 代码带来优势。

*   应用程序 B 出去并从数据库中检索一个值。同样，结果可能非常接近，尽管出于两个原因我不得不给 .Net 一个非常小的优势：它使用本机 sql 客户端，据说速度更快，并且它执行自动连接池之类的操作并使其更容易分解出诸如连接一次并重新使用该连接而不是重复连接之类的事情。但是，如果就代码而言，如果您将苹果与苹果进行比较，两者可能会非常接近。

*   应用程序 C 重复显示和隐藏表单。在这里，我不得不给 vb6 点头。它基于较旧的、不那么炫目的小部件集，坦率地说，渲染成本更低。此外，WinForms 组件并不以速度如此之快而著称。但是，差异可能并不像您想象的那么大，而且您可能也没有那么频繁地完全重绘表格。这可能是您的用户抱怨的缓慢。

*   应用程序 D 是基于字符串操作的，在这里我不得不向 .Net 致敬。VB6 和 .Net 都以慢速字符串操作而闻名。但是，.Net 提供了许多在 vb6 中根本不可用的工具来帮助开发人员克服缓慢的问题。也就是说，如果您不了解这些工具，那么糟糕的字符串操作选择很容易让您的应用程序陷入无用的工作。这也可能导致用户投诉。

*   应用程序 E 将重复地将 Xml 文档加载到内存中。同样，我不得不认为 .Net 会有优势。首先，vb 可用的所有 xml 工具充其量只是原始的。我发现它们不太可能没有得到显着改善。此外，.Net 的垃圾收集器非常聪明，可以在加载期间为其分配和释放内存。但是，我认为这里最重要的是磁盘速度，这意味着差异不会那么大。

*   应用程序 F 将重复启动一个 .Net 或 vb6 程序，等待它准备好（对于“准备好”的一些定义），然后关闭它。这里 vb6 可能具有优势，原因有两个。首先，.Net 必须在第一次运行时将 IL 编译为字节码。谢天谢地，这只是第一次运行。其次，.Net 应用程序还必须加载任何引用的程序集。相比之下，VB6 运行时*要*小得多。但是，这通常仅在您*第*一次在特定机器上启动应用程序时才适用，并且有一些方法可以预编译 .Net 代码。这也可能导致感知缓慢。

重要的一点是，对于所有这些应用程序，.Net 应用程序可能会占用*更大*的内存。由于某些原因，开发人员倾向于认为这是一个糟糕的性能特征，而实际上恰恰相反。如果您的应用程序使用更多内存，则它可能花费更少的时间进入磁盘，并且磁盘速度较慢。它可能还缓存更多，从而节省了 cpu 时间。特别是对于.Net，它会在更重要或电脑空闲时节省分配/解除分配操作。

我没有时间，但是看到有人使用[今天的 Coding Horror](http://www.codinghorror.com/blog/archives/001178.html)中提到的 StopWatch 实现（至少对于 .Net 方面）来获得每一个的真正基准是很有趣的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T19:52:25.203

1.  我从来没有寻找过这种数据。您可能会查看经常用于基准测试的规范“宠物店”应用程序。它可能适用于两种开发平台。不过，我怀疑＃2 更重要的是要回答。谁在乎宠物店是否跑得快。重要的是您客户的应用程序。

2.  大多数性能问题与数据库和/或网络相关。如果您在版本之间进行了重大的数据库更改，我将首先使用 SQL 跟踪/分析工具对那些进行分析，或者只是在关键 procs/sql 上运行一些简单的测试，以支持您所谓的“低性能”表单。

如果我对您的理解正确，那么在某些客户端上似乎很好，但在其他客户端上却不行，并且有人在锤击您，因为它是 .NET 并且 VB6 就很好，非常感谢。客户端之间的网络差异绝对是一个关键的差异。服务器操作系统、交换机的速度和网络基础设施等 - 有很多变量需要探索。但我愿意打赌它与 .NET 与 VB6 无关。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-24T20:16:01.083

我知道我冒着听起来像一个质疑问题而不是回答问题的人的风险，但要明白，我提供这个完全是为了提供帮助。

在您更关心的情况下，即客户抱怨 .net 应用程序比 VB6 慢，如果您发现 VB6 确实更快，您是否认真考虑下转换？如果没有，为什么要浪费时间进行测试？

即使您可以最终证明您的客户是错误的并且 .net 更快，您也不会通过驳回客户投诉来真正赢得任何东西。花时间解决问题而不是争论原因，最终每个人都会更快乐。

最后，我要指出的是，切换平台以获得更好的性能通常不是一项富有成效的努力，而且通常是让平台战争战胜常识的程序员的最后努力。我的建议是忽略已经构建的项目的 .NET/VB6 性能比较，只需花时间找出应用程序关注的特定领域并尽可能优化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-25T04:59:36.173

哦，很容易看出来。在 WF 和 VB6 中复制并粘贴一个表单中的 50 个按钮，并并排比较它们的绘制速度。不是.NET慢，而是WF慢。我从来没有真正确定它，但促成因素：

*   Button 类的绘制速度非常慢。它要求容器绘制背景以获得它没有的透明度。
*   VB6 有几个无窗口控件，例如 Label。在 WF 中，每个控件都是一个窗口。
*   视觉风格不是免费的。
*   他们非常努力地使 VB1 在 386SUX 上运行良好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T19:56:20.250

如果您实际上是在谈论用 VB 6.0 和 VB.NET 编写的相同客户端应用程序，那么 VB 6.0 应用程序很可能会更快地进入第一个屏幕（因为 .NET JIT 编译和程序集加载）。之后的表现应该差不多。

问题是 - 在任何实际情况下 - 应用程序的架构都会不同，真正的性能比较没有意义，

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T01:13:22.597

.Net 粉丝有一千个借口。微软曾一度禁止比较，可能是有原因的。

.Net 速度慢的部分原因是运行时启动成本。其中一部分是 JIT 编译所需的时间。其中一部分是垃圾收集。部分原因是消耗了这么多内存的开销，这可能导致更多的交换。部分原因是在内联代码之外（即操作系统调用、许多标准库）涉及通过 COM 和/或 Win32 层来完成任务。

具有大量内存和多个快速 CPU 和硬盘驱动器速度的较新机器掩盖了其中的一些。掩蔽不会减少浪费。

.Net 的目标与 Java 擅长的相同。快速编写的一次性代码和长时间保持加载和运行的服务器端内容。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-24T19:46:37.820

与 VB6 应用程序相比的性能可能更多是由于应用程序设计而不是 c# 与 VB6。如果设计得当，我会猜测 C# 应用程序的 9.5/10 倍会更快。.Net 不在虚拟机内部运行。CLR JIT 将 .Net 应用程序编译为机器级代码，速度非常快。原因是运行速度比非托管代码慢一点，因为运行在沙箱下的 .Net 是托管的，并且有一些开销。******