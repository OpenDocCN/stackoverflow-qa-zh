# StackOverflow 问答 000865000-000865999

# c++ - C++ 中的碰撞检测方法

> ID：865000
> 
> 赞同：1
> 
> 时间：2009-05-14T18:38:47.010
> 
> 标签：c++, graphics, collision

我是 C++ 的新手，我一直在一个什么都不做的小游戏程序中练习碰撞，我就是无法正确地碰撞

所以我使用加载到变量中的图像

```
background = oslLoadImageFile("background.png", OSL_IN_RAM, OSL_PF_5551);
sprite = oslLoadImageFile("sprite.png", OSL_IN_RAM, OSL_PF_5551);
bush = oslLoadImageFile("bush.png", OSL_IN_RAM, OSL_PF_5551); 
```

虽然有变量存储，如

```
sprite->x = 3;

if ( (sprite->x + spritewidth > bush->x) && (sprite->x < bush->x + bushwidth) && (sprite->y + spriteheight > bush->y) && (sprite->y < bush->y + bushheight) ) 
{
         bushcol = 1;               
}
else
{
        bushcol = 0;      
} 
```

所以当我按下一个按钮

```
if (osl_keys->held.down)
{
if (bushcol == 1) 
{
sprite->y = bush->y + 38;
}
else
{
sprite->y += 3;
}
}
if (osl_keys->held.up)
{
if (bushcol == 1) 
{
sprite->y = bush->y - 23;
}
else
{ 
sprite->y -= 3;
}
}
if (osl_keys->held.right)
{
if (bushcol == 1) 
{
sprite->x = bush->x - 28;
}
else
{ 
sprite->x += 3;
}
}
if (osl_keys->held.left)
{
if (bushcol == 1) 
{
sprite->x = bush->x + 28;
}
else
{ 
sprite->x -= 3;
}
} 
```

我在想像这样的事情

```
sprite->y = bushheight - 24; 
```

但它不起作用

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T19:12:59.267

我建议仅出于边界框碰撞检测的目的制作一个函数。它可能看起来像

```
IsColiding(oslImage item1, oslImage item2) 
{ 
  /* Perform check */
} 
```

您在其中执行检查图像 1 和图像 2 之间是否存在冲突。至于您尝试使用的算法，请查看此维基百科，例如[AABB 边界框](http://en.wikipedia.org/wiki/Bounding_volume#Basic_intersection_checks)

特别是这部分：

> 在 AABB 的情况下，该测试就单位轴而言成为一组简单的重叠测试。对于由 M,N 定义的 AABB 与由 O,P 定义的 AABB，如果 (Mx>Px) 或 (Ox>Nx) 或 (My>Py) 或 (Oy>Ny) 或 (Mz>Pz) 或(Oz>Nz)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T19:42:25.953

我想你有基本的想法。只是检查你的工作。这是一个编译的简单版本：

```
#import <stdlib.h>

typedef struct {
    // I'm going to say x, y, is in the center
    int x;
    int y;
    int width;
    int height;
} Rect;

Rect newRect(int x, int y, int w, int h) {
    Rect r = {x, y, w, h};
    return r;
}

int rectsCollide(Rect *r1, Rect *r2) {
    if (r1->x + r1->width/2 < r2->x - r2->width/2) return 0;
    if (r1->x - r1->width/2 > r2->x + r2->width/2) return 0;
    if (r1->y + r1->height/2 < r2->y - r2->height/2) return 0;
    if (r1->y - r1->height/2 > r2->y + r2->height/2) return 0;
    return 1;
}

int main() {
    Rect r1 = newRect(100,200,40,40);
    Rect r2 = newRect(110,210,40,40);
    Rect r3 = newRect(150,250,40,40);

    if (rectsCollide(&r1, &r2))
        printf("r1 collides with r2\n");
    else
        printf("r1 doesnt collide with r2\n");

    if (rectsCollide(&r1, &r3))
        printf("r1 collides with r3\n");
    else
        printf("r1 doesnt collide with r3\n");

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T19:31:43.390

首先我想你的意思是

`sprite->y = bush->**y** - 3;`

其次，我不知道您使用的是什么平台，但通常 y 坐标是倒置的。即，y=0 对应于屏幕顶部。在这种情况下，您的比较可能不起作用。

当您向其中添加旋转和非矩形对象时，第三次碰撞检查会很快变得复杂。您应该考虑使用 CGAL 或其他一些可以处理多边形相交的计算几何算法库。

# wpf - 什么是可冻结的父级？这个错误是什么意思？

> ID：865002
> 
> 赞同：11
> 
> 时间：2009-05-14T18:39:06.760
> 
> 标签：wpf, invalidoperationexception, dependencyobject, freezable

我收到此错误：

> 不能使用属于与其父 Freezable 不同的线程的 DependencyObject

那有什么意思？是英文的吗？父母是冻结的，还是只是可冻结的？如果它使错误消失，有什么方法可以使父母不可冻结？

发生了什么：

我在一个 WPF 应用程序中有两个 opengl winforms 控件，到目前为止，一切都很顺利（我认为）。现在，我添加了一个更新，这样当一个 winform 控件更新图像时，另一个也应该更新。这实际上曾经有效，现在我得到了那个错误。单步执行代码会在随机位置发生崩溃，这让我相信这是垃圾收集错误（即，另一个线程中的某些更新正在创建正在收集垃圾的东西，并且该收集是在随机时间发生的）。

异常在主运行方法中被捕获，它是一个 InvalidOperationException。

我在这里抓着稻草。我从哪里开始？

编辑：看起来导致问题的调用是这个：

```
 if (imagePanel.InvokeRequired)
        {
            imagePanel.Invoke(new System.Windows.Forms.MethodInvoker(delegate{
                imagePanel.ClearImages();
            }));
        }
        else
        {
            imagePanel.ClearImages();
        } 
```

我仍在追踪它；如果这一系列行被注释掉，崩溃仍然会发生，并且线程状态有一个“刚刚结束”的线程（因此是垃圾收集假设）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-14T19:01:00.670

好的，我已经想通了。通常，我会删除这个问题，但很难找到有关如何解决此问题的任何信息。

问题是一个看起来像这样的调用：

```
ImageBrush theBrush = new ImageBrush(new Bitmap(new Uri(...)));

if (labelStatus.Dispatcher.Thread == System.Threading.Thread.CurrentThread) {
    button.background = theBrush;
}
else {
   labelStatus.Dispatcher.BeginInvoke((System.Threading.ThreadStart)(delegate {
    button.background = theBrush;
   }));
} 
```

但！如果你这样做，那么调度程序就会工作，然后它会尝试删除画笔，但画笔本身显然也在另一个位置被删除。

所以，带回家的教训是，如果你声明一个 ImageBrush，然后在同一个线程中删除它，如下所示：

```
void MyFunc(){
     ImageBrush theBrush = new ImageBrush(new Bitmap(new Uri(...)));
     button.background = theBrush;
}

if (labelStatus.Dispatcher.Thread == System.Threading.Thread.CurrentThread) {
    MyFunc();
}
else {
   labelStatus.Dispatcher.BeginInvoke((System.Threading.ThreadStart)(delegate {
       MyFunc();
   }));
} 
```

# css - 使用css通过文本定位标签

> ID：865006
> 
> 赞同：1
> 
> 时间：2009-05-14T18:40:05.853
> 
> 标签：css, selenium, css-selectors

您将如何**使用 CSS**获得以下标签？

```
<p>You can only use the text inside the tag</p> 
```

与 xpath 一样，我将使用以下内容：

```
//p[contains(text(), "inside the tag") 
```

PS：我无法关闭 xpath，它会尝试使用代码自动完成...：S

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T18:58:31.033

我相信 CSS3 选择器只能过滤*属性*，而不是标签中的文本。所以你可以做一些事情，比如`a[href~="aspx"]`匹配到 aspx 页面的链接，但这只是基于内容的匹配。

对于您想要做的事情，您可能必须使用 javascript 或服务器端处理。

查看[quirksmode](http://www.quirksmode.org/css/contents.html)和[W3](http://www.w3.org/TR/css3-selectors/)了解更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T20:07:36.413

这就是我要找的！

```
p:contains("inside the tag") 
```

# javascript - 自动选择 基于输入字段，有一些注意事项

> ID：865009
> 
> 赞同：0
> 
> 时间：2009-05-14T18:40:26.337
> 
> 标签：javascript, regex, select, option, postal-code

我有一个 SELECT 元素，我需要根据在文本字段中输入的邮政编码的前半部分自动选择适当的选项。英国邮政编码的格式为*AB12 3CD*，其中第一部分由代表县的 1-2 个字母和代表县内区域的数字组成。最后 3 个字符与此问题无关。

对于大多数字段，它仅基于第一个字母，但对于某些选项，它是邮政编码范围。HTML应该最好地解释它：

```
<select id="country_field">
  <option value="">Select</option>
  <option value="AB">AB (Aberdeen)</option>
  <option value="AL">AL (St. Albans)</option>
  <option value="B">B (Birmingham)</option>
  <option value="BA">BA (Bath)</option>
  ...
  <option value="DD1">DD 1-7 (Dundee)</option>
  <option value="DD8">DD 8-11 (Dundee)</option>
  ...
</select> 
```

当值正好是两个字母时，我下面的代码当前将选择正确的元素。但我需要将其扩展为包含单字母代码（伯明翰）和邮政编码范围（邓迪）。注意：如果有保证特殊值的解决方案，我可以更改选项值，例如 DD1/DD2 而不是 DD1/DD8。

简而言之：

*   B2 --> 伯明翰
*   BA3 --> 浴缸
*   DD5 --> 第一个邓迪 [DD1]
*   DD11 --> 第二个邓迪 [DD8]

这是我到目前为止的Javascript...

```
window.onload = function()
{
  // postcode INPUT field
  var zipInput = document.getElementById( 'zip_field' );
  // county SELECT field
  var ctySelect = document.getElementById( 'county_field' );

  zipInput.onchange = function()
  {
    var zipValue = zipInput.value;
    var ctyOptions = ctySelect.options;
    for ( i = 0; i < ctyOptions.length; i++ )
    {
      if ( zipValue.substring(0,2) == ctyOptions[i].value )
        ctyOptions[i].selected = true;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T19:00:21.327

您可以使用正则表达式来提取值...

```
/^([a-z]{1,2})(\d*)\s/i 
```

然后，对于像 DD 这样的范围的代码，可能是这样的（伪代码）......

```
if(match[1].value == "DD") {   // needs special processing
  range = match[2].value;
  range = range < 8 ? 1 : 8;   // if the number is less than 8, set it to 1, otherwise set it to 8
  listValue = match[1].value + range
} else                         // just use the letters to select the list item 
  listValue = match[1].value; 
```

因此，对于`DD5`，这将返回`DD1`，对于`DD11`它将返回`DD8`。类似`B2`or的东西会分别`BA3`返回`B`and 。`BA`

如果您有多个具有不同范围的其他代码，您可以将其更改`if`为 a 。`switch`然后，只需将具有该值的列表项设置为当前选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T19:00:04.947

代替：

```
zipInput.onchange = function()
  {
    var zipValue = zipInput.value;
    var ctyOptions = ctySelect.options;
    for ( i = 0; i < ctyOptions.length; i++ )
    {
      if ( zipValue.substring(0,2) == ctyOptions[i].value )
        ctyOptions[i].selected = true;
    }
  } 
```

和：

```
zipInput.onchange = function()
  {
    var zipValue = zipInput.value.match(/^[a-z]+/gi);

    var ctyOptions = ctySelect.options;
    for ( i = 0; i < ctyOptions.length; i++ )
    {
      if (zipValue[0] === ctyOptions[i].value )
        ctyOptions[i].selected = true;
    }
  } 
```

1.  首先，我们从循环中删除了变量赋值动作。为什么要浪费循环重复相同的操作？
2.  第二，我们现在过滤掉除了输入开头的字母之外的所有内容。
3.  这又可以扩展为包括数字后缀等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T19:02:05.317

您可以将 zipValue 的开头与选项值进行比较。不需要正则表达式。只需使用 indexOf。

```
 zipInput.onchange = function()
  {
    var zipValue = zipInput.value.toUpperCase();
    var ctyOptions = ctySelect.options;
    for ( i = 0; i < ctyOptions.length; i++ )
    {
      if ( zipValue.indexOf(ctyOptions[i].value) == 0 )
        ctyOptions[i].selected = true;
    }
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T19:34:32.023

我不确定这将如何在 javascript 中工作，但我会执行以下操作：

*   将您的值设置为正则表达式以匹配您要查找的内容

那么，“B”就变成了“^B[0-9]”（我假设它后面必须跟一个数字）

BA 变为“^BA[0-9]”

DD1 变为 "^DD([1-7] )"

DD8 变为 "^DD([8-9] |[1][01] )" 以匹配 DD8、DD9、DD10、DD11

然后只需对您的字符串运行正则表达式（无需对其进行子字符串化，因为 ^ 确保此匹配发生在字符串的开头）并检查是否成功匹配。

# php - 如何在每个页面加载时增加一个计数器（在 PHP 中）？

> ID：865015
> 
> 赞同：2
> 
> 时间：2009-05-14T18:41:59.017
> 
> 标签：php, count, increment

我希望在用户访问网站的 X 个页面时执行某个操作

我是否必须将计数器存储在外部（在 txt 文件或 db 中）？

我想不出一种将计数器设置为 0 的方法，然后在每次加载页面时将其递增。计数器总是会重置为 0，还是我遗漏了一些明显的东西？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-14T18:48:35.147

仅使用`$_SESSION`数据来存储个人查看过的页面数量非常简单。

```
$_SESSION['pageviews'] = ($_SESSION['pageviews']) ? $_SESSION['pageviews'] + 1 : 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T18:51:09.943

最简单的方法是使用 PHP 的[会话存储](http://php.net/session_start#function.session-start.examples)。

```
session_start();
@$_SESSION['pagecount']++; 
```

PHP 自动向用户发送会话 cookie，并将 $_SESSION 的内容透明地存储在与此 cookie 关联的平面文件中。你真的不需要为这个问题推出你自己的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T18:44:59.257

您可以在用户第一次访问您的页面时启动会话，然后在每次用户重新加载/访问子页面时递增该值。另一种方法是在每个页面上都有一个隐藏字段，并检索它的值，增加它并将其发布到新页面。

```
<input type="hidden" value="2" id="blabla" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T18:47:04.243

简短的回答是肯定的，您必须将其保存在外部，因为 php（默认情况下）具有零内存持久性策略。这基本上意味着一旦您的 php 脚本运行，内存中就没有任何内容了。

对于低流量站点，您可能需要考虑一个简单的 txt 文件，您可以在其中读取、递增和写入。对于更高流量的站点，一个非常简单的 mysql 表可能会起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T18:48:39.047

您是否已经有一种方法可以确定用户是谁（例如用户名和密码），即使他们离开网站并在另一天回来？或者您只是对跟踪访问者看到的页面数量感兴趣，并在查看的第 x 个页面上做一些特别的事情。

如果是第二个，您已经有一个会话变量，您可以在其中存储计数器。

```
$_SESSION['views'] = $_SESSION['views'] + 1
if($_SESSION['views'] == x) ... 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-14T18:44:28.417

您将使用 if 语句来检查它是否已设置；

```
if( isset($count) )
{
   $count = $count + 1;
}
else
{
   $count = 1;
} 
```

您还可以使用 get 方法将计数放在 URL 中，这样您就不必将计数写入文件或数据库。

# php - pg_send_query()：无法将连接设置为阻塞模式？

> ID：865017
> 
> 赞同：14
> 
> 时间：2009-05-14T18:42:21.963
> 
> 标签：php, postgresql

我有一个长时间运行的脚本，它似乎偶尔会报告以下通知级错误：pg_send_query(): 无法将连接设置为阻塞模式

之后似乎继续发送查询，但不清楚它是否成功发送了生成错误的查询。

这是什么症状？

**编辑：**错误发生时 postgres 日志中没有任何条目，这表明这只是一个连接错误，而不是 postgres 方面的问题（例如，可能不是 postgres 崩溃和重新启动的结果或其他原因）

**编辑：**据我所知，当触发此错误时，我的 INSERT 语句以一种或另一种方式成功。

**编辑：**看起来这可能已在 2013 年 6 月修复：[https ://bugs.php.net/bug.php?id=65015](https://bugs.php.net/bug.php?id=65015)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-10-13T21:15:27.873

这是`pg_send_query()`无法成功将连接切换回阻塞模式的症状。查看 PHPs pgsql.c 中的源代码，可以发现：

```
/* {{{ proto bool pg_send_query(resource connection, string query)
   Send asynchronous query */
PHP_FUNCTION(pg_send_query)
{

<... snipped function setup stuff ...>

 if (PQ_SETNONBLOCKING(pgsql, 1)) {
  php_error_docref(NULL TSRMLS_CC, E_NOTICE, "Cannot set connection to nonblocking mode");
  RETURN_FALSE;
 }

<... snipped main function execution stuff ...>

 if (PQ_SETNONBLOCKING(pgsql, 0)) {
  php_error_docref(NULL TSRMLS_CC, E_NOTICE, "Cannot set connection to blocking mode");
 }
 RETURN_TRUE;
} 
```

因此，在主要工作完成后，在函数结束时会引发错误。这符合您的 INSERT 语句被执行的观察。

这两个调用的全部目的`PQ_SETNONBLOCKING`是将连接置于非阻塞模式以允许异步执行，然后将其恢复为默认阻塞行为。从[PQsetnonblocking 的文档中](http://www.postgresql.org/docs/8.3/static/libpq-async.html)：（PQ_SETNONBLOCKING 只是为该函数定义的别名）：

> 设置连接的非阻塞状态。
> 
> ```
> int PQsetnonblocking(PGconn *conn, int arg); 
> ```
> 
> 如果 arg 为 1，则将连接状态设置为非阻塞，如果 arg 为 0，则将连接状态设置为阻塞。如果正常则返回 0，如果错误则返回 -1。
> 
> 在非阻塞状态下，对 PQsendQuery、PQputline、PQputnbytes 和 PQendcopy 的调用不会阻塞，而是在需要再次调用时返回错误。
> 
> 注意 PQexec 不支持非阻塞模式；如果它被调用，它无论如何都会以阻塞方式运行。

进一步查看 PQsetnonblocking 的来源（在 PostgeSQLs fe-exec.c 中），调用失败的可能原因有两个：

```
/* PQsetnonblocking:
 * sets the PGconn's database connection non-blocking if the arg is TRUE
 * or makes it non-blocking if the arg is FALSE, this will not protect
 * you from PQexec(), you'll only be safe when using the non-blocking API.
 * Needs to be called only on a connected database connection.
 */
int
PQsetnonblocking(PGconn *conn, int arg)
{
 bool  barg;

 if (!conn || conn->status == CONNECTION_BAD)
  return -1;

 barg = (arg ? TRUE : FALSE);

 /* early out if the socket is already in the state requested */
 if (barg == conn->nonblocking)
  return 0;

 /*
  * to guarantee constancy for flushing/query/result-polling behavior we
  * need to flush the send queue at this point in order to guarantee proper
  * behavior. this is ok because either they are making a transition _from_
  * or _to_ blocking mode, either way we can block them.
  */
 /* if we are going from blocking to non-blocking flush here */
 if (pqFlush(conn))
  return -1;

 conn->nonblocking = barg;

 return 0;
} 
```

所以要么连接丢失了，要么 pqFlush 没有成功完成，表明连接输出缓冲区中有剩余的东西。

第一种情况是无害的，因为您的脚本肯定会注意到稍后调用的连接丢失并对此做出反应（或者失败更明显）。

这留下了第二种情况，这意味着您的连接处于非默认、非阻塞状态。我不知道这是否会影响以后重用此连接的调用。如果你想安全起见，你会在这种情况下关闭连接并使用新的/其他的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-13T20:31:15.240

听起来您正在尝试使用该`pg_send_query()`函数向 PostgreSQL 发送异步查询。此函数的目的是让您的 PHP 脚本在等待 PostgreSQL 执行您的查询并准备好结果的同时继续执行其他代码。

[文档](http://php.net/manual/en/function.pg-send-query.php)中给出的示例`pg_send_query()`建议如果 PostgreSQL 已经在处理另一个查询，则不应发送查询：

```
if (!pg_connection_busy($dbconn)) {
  pg_send_query($dbconn, "select * from authors; select count(*) from authors;");
} 
```

您使用`pg_send_query()`而不是有原因`pg_query()`吗？如果您可以允许您的脚本阻止等待查询执行，我猜（诚然没有尝试过）您不会看到这些错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-14T01:28:20.410

我最近遇到了同样的问题，在 Henrik Opels 回答的帮助下，我意识到 PHP 在将连接设置回阻塞模式之前实际上并没有等待缓冲区刷新。

“无法将连接设置为阻塞模式”可以通过足够大的查询来填充发送缓冲区（在末尾填充空格就足够了）。对于较小的查询，我想它取决于负载，而且是断断续续的。

如果您确实需要异步模式，请尝试[https://bugs.php.net/bug.php?id=65015上的补丁](https://bugs.php.net/bug.php?id=65015)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-25T12:19:31.647

如果您正在使用**线程**并且正在重用连接，则可能会发生这种情况。如果是这种情况，您可以使用`PGSQL_CONNECT_FORCE_NEW`这样的：

```
pg_connect("...", PGSQL_CONNECT_FORCE_NEW) 
```

这将强制使用新的数据库连接资源，但请注意：**您可能会用完连接客户端**，因此在线程内小心使用它，所以不要忘记使用`pg_close()`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-08-24T17:13:00.057

我遇到了与 PHP 5.6.9 相同的错误消息

当*pg_pconnect()*建立的持久连接丢失并且 *pgsql.auto_reset_persistent*设置为*Off*时，就会发生这种情况。

在以下情况下，连接可能会丢失：

1.  PHP 会话过期
2.  连接到数据库超时
3.  Webserver / DB 服务器重新启动

您可以检查 PHP.ini 中的*pgsql.auto_reset_persistent*并将其设置为*On*。

启用pgsql.auto_reset_persistent后，每次调用*pg_pconnect* *()*时，都会检查连接链接，如果它仍然有效。这需要一点开销，但会在连接丢失时修复错误消息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-31T09:12:17.683

我也遇到了这个错误。我通过重新启动 Web 服务器（Apache）来解决我的问题。

# c++ - “错误 C2248：‘CObject::CObject’：无法访问在类‘CObject’中声明的私有成员

> ID：865035
> 
> 赞同：4
> 
> 时间：2009-05-14T18:46:10.363
> 
> 标签：c++, mfc

> **可能重复：**
> [使用 CArray 时出错](https://stackoverflow.com/questions/864864/error-using-carray)

重复：[使用 CArray 时出错](https://stackoverflow.com/questions/864864/error-using-carray)

* * *

所以，我正在尝试像这样使用 CArray ：

```
 CArray<CPerson,CPerson&> allPersons;
   int i=0;
   for(int i=0;i<10;i++)
   {
      allPersons.SetAtGrow(i,CPerson(i));
      i++;
   } 
```

但是在编译我的程序时，我收到了这个错误：

```
"error C2248: 'CObject::CObject' : cannot access private member declared in class 'CObject' c:\program files\microsoft visual studio 9.0\vc\atlmfc\include\afxtempl.h" 
```

我什至不明白这是从哪里来的。

帮助 ！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-07-01T19:29:28.557

问题是您正在堆栈上构造一个 CObject 。在程序中的某个地方，您试图传递对 CArray 对象的引用，但您不小心遗漏了函数原型中的“&”。例如：

```
void DoFoo(CArray cArr)
{
    // Do something to cArr...
} 
```

^^^ 上面的代码会导致您遇到的错误。

```
void DoFoo(CArray & cArr)
{
    // Do something to cArr...
} 
```

^^^ 上面的代码不会导致问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-06T07:34:39.433

为您的类（CPerson）编写一个构造函数并将其公开。它应该可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T18:49:59.073

这意味着您的程序正在尝试构造 的实例`CObject`，该实例似乎被禁止，因为`CObject`它具有私有构造函数。

也许`CArray`正在尝试构建这些实例？程序的其余部分是什么样的？

# java - 如何从 Document 或 Node 创建 InputStream

> ID：865039
> 
> 赞同：31
> 
> 时间：2009-05-14T18:47:04.103
> 
> 标签：java, xml, xstream

如何从要在 xstream 中使用的 XML 文档或节点对象创建 InputStream 对象？我需要更换？？？带有一些有意义的代码。谢谢。

```
Document doc = getDocument();
InputStream is = ???;
MyObject obj = (MyObject) xstream.fromXML(is); 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-05-14T18:59:35.633

```
ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
Source xmlSource = new DOMSource(doc);
Result outputTarget = new StreamResult(outputStream);
TransformerFactory.newInstance().newTransformer().transform(xmlSource, outputTarget);
InputStream is = new ByteArrayInputStream(outputStream.toByteArray()); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-08-18T08:05:03.883

如果您在没有任何第三方库的情况下使用 Java，则可以`InputStream`使用以下代码创建：

```
/*
 * Convert a w3c dom node to a InputStream
 */
private InputStream nodeToInputStream(Node node) throws TransformerException {
    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    Result outputTarget = new StreamResult(outputStream);
    Transformer t = TransformerFactory.newInstance().newTransformer();
    t.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
    t.transform(new DOMSource(node), outputTarget);
    return new ByteArrayInputStream(outputStream.toByteArray());
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T18:55:02.633

一种方法：使用[DOMSource](http://java.sun.com/javase/6/docs/api/javax/xml/transform/dom/DOMSource.html)`Document`适应[Source](http://java.sun.com/javase/6/docs/api/javax/xml/transform/Source.html)。创建[StreamResult](http://java.sun.com/javase/6/docs/api/javax/xml/transform/stream/StreamResult.html#StreamResult())以适应[ByteArrayOutputStream](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html)。使用[TransformerFactory.newTransformer](http://java.sun.com/javase/6/docs/api/javax/xml/transform/Transformer.html)中的[Transformer](http://java.sun.com/javase/6/docs/api/javax/xml/transform/TransformerFactory.html#newTransformer())复制数据。[使用ByteArrayInputStream](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayInputStream.html)检索您的和流。`byte[]`

将代码放在一起作为练习。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-07T13:46:21.353

```
 public static InputStream document2InputStream(Document document)    throws IOException {
      ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
      OutputFormat outputFormat = new OutputFormat(document);
      XMLSerializer serializer = new XMLSerializer(outputStream, outputFormat);
      serializer.serialize(document);
      return new ByteArrayInputStream(outputStream.toByteArray());
 } 
```

如果您使用的是 apache Xerces 实现，则此方法有效，您还可以使用输出格式设置格式参数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-26T08:48:44.740

```
public static InputStream documentToPrettyInputStream(Document doc) throws IOException {

    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();

    XMLWriter xmlWriter = new XMLWriter(outputStream, OutputFormat.createPrettyPrint());
    xmlWriter.write(doc);
    xmlWriter.close();

    InputStream inputStream = new ByteArrayInputStream(outputStream.toByteArray());

    return inputStream;
} 
```

如果你碰巧使用了 DOM4j 并且你需要把它打印出来！

# sql - 如果 SQL Server 作业已经在运行，它会跳过计划运行吗？

> ID：865042
> 
> 赞同：71
> 
> 时间：2009-05-14T18:47:35.773
> 
> 标签：sql, sql-server, scheduled-tasks, sql-server-agent

如果您安排 SQL Server 作业每 X 分钟运行一次，并且它在 # of minutes 结束之前没有完成上一次调用，它会跳过运行，因为它已经在运行，还是会运行两个实例工作做同样的步骤？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-05-14T19:11:36.620

SQL Server 代理在开始新的迭代之前检查作业是否已经在运行。如果您有长时间运行的作业并且它的时间表出现，它将被跳过，直到下一个间隔。

你可以自己试试这个。如果您尝试启动一个已经在运行的作业，您将收到一个错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T18:49:18.810

我很确定如果它正在运行它会跳过它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T19:15:21.807

您使用的是哪个版本的 SQL Server？这似乎是一件很容易测试的事情。设置一个包含 WAITFOR 的作业，将单行插入表中，并将作业设置为快速连续运行两次（比 WAITFOR DELAY 短）。

在 SQL Server 2005 中运行这样的测试时，它会跳过重叠的运行。

# c# - 如何在 C# 中找到 DataTable 行的大小？

> ID：865043
> 
> 赞同：3
> 
> 时间：2009-05-14T18:47:43.573
> 
> 标签：c#, datatable

在 C# 中是否`DataTable`提供了一个属性，它给了我每行的大小（字节数）？

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2009-05-14T19:00:25.057

[您可以使用Marshal.SizeOf](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.sizeof.aspx)确定托管对象的非托管大小。

# syntax - How do I translate this Haskell to F#?

> ID：865044
> 
> 赞同：3
> 
> 时间：2009-05-14T18:47:51.060
> 
> 标签：syntax, haskell, f#, list-comprehension

I'm trying to learn F# by translating some Haskell code I wrote a very long time ago, but I'm stuck!

```
percent       :: Int -> Int -> Float
percent a b    = (fromInt a / fromInt b) * 100

freqs         :: String -> [Float]
freqs ws       = [percent (count x ws) (lowers ws) | x <- ['a' .. 'z']] 
```

I've managed this:

```
let percent a b = (float a / float b) * 100. 
```

although i dont like having to have the . after the 100.

What is the name of the operation I am performing in `freqs`, and how do I translate it to F#?

Edit: `count` and `lowers` are `Char -> String -> Int` and `String -> Int` respectively, and I have translated these already.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T19:31:07.913

This is a list comprehension, and in F# it looks like the last two lines below:

```
// stub out since don't know the implementation
let count (c:char) (s:string) = 4
let lowers (s:string) = 10
// your code
let percent a b = (float a / float b) * 100.
let freq ws = [for x in ['a'..'z'] do 
                   yield percent (count x ws) (lowers ws)] 
```

More generally I think Haskell list comprehensions have the form suggested by the example below, and the corresponding F# is shown.

```
// Haskell
// [e(x,y) | x <- l1, y <- l2, pred(x,y)]
// F#
[for x in l1 do
    for y in l2 do
        if pred(x,y) then
            yield e(x,y)] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T11:32:13.187

Note that Brian's F# code:

> ```
> let freq ws = [for x in ['a'..'z'] do yield percent (count x ws) (lowers ws)] 
> ```

Can be written more elegantly as:

```
let freq ws = [for x in 'a'..'z' -> percent (count x ws) (lowers ws)] 
```

# unix - AIX 部署：installp 还是 rpm？

> ID：865049
> 
> 赞同：4
> 
> 时间：2009-05-14T18:48:49.887
> 
> 标签：unix, deployment, aix, rpm

我正在 AIX 上部署大量 perl/shell/sql 代码。这些可能是（并且是）具有自己的开发团队、源代码控制存储库等的不同应用程序。

我很*懒惰*，想让部署/回滚更容易——我正在挖掘**rpm**打包的所有 +/- 好处。

AIX 的本机打包系统是[**installp**](http://publibn.boulder.ibm.com/doc_link/en_US/a_doc_lib/aixprggd/genprogc/pkging_sw4_install.htm)（带有 bff 文件）。我在正确的轨道上使用**rpm**吗？[oss4aix.org](http://www.oss4aix.org)使用**rpm** FWIW。任何输入/最佳实践表示赞赏。

*谢谢*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T05:40:56.797

我从来不需要开发安装包。我的印象是，IBM 将很快购买一个主要的 Linux 发行版并停止其所有专有业务。我认为从长远来看，转向 rpm 正在走在曲线的前面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T05:58:43.410

“installp”有点玄学。很长一段时间以来，如果不花不小的钱就不可能获得构建软件，所以除了 IBM（和 Bull）之外，很少有人为它而烦恼。

另一方面，“rpm”多年来一直免费提供。对于脚本类型的东西，对于 AIX 应该没有特殊的考虑，因此大量可用于 Linux 的经验、知识和示例代码将对您有用。

我认为 IBM 不会很快放弃 AIX，但是，他们正在积极地将标准 linux 工具移植到 AIX，并将一些 AIX 工具移植到 Linux，因此环境正在融合。我认为 installp 变得“贬值”以支持 rpm 只是时间问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-10T12:16:44.967

Aix 4、5、6 使用 RPM v3.0 - 1998 circa，iirc RedHat 6.2。无数已解决的错误和新功能现在都在 rpm 中。所以使用它，但不要认为你可以用它来做现代 linux rpm 发行版中的其他操作。

或者，作为自己构建 rpm 5 的一个不错的选择——在 aix 上还有哪些？- 尝试 openpkg [http://www.openpkg.org/](http://www.openpkg.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-01T23:35:28.187

我找到了一份在 AIX 上构建 rpm 5.0 和 yum 的文档。

[http://www.tekwire.net/joomla/building/rpm/rpm_AIX_5.2.htm](http://www.tekwire.net/joomla/building/rpm/rpm_AIX_5.2.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-02T04:05:10.337

看看我们写的[polypkg](http://rc.quest.com/topics/polypkg/)工具；它是一个 shell 脚本，可以为您完成制作包的繁重工作。

# sql-server - 短期列的最占用索引

> ID：865051
> 
> 赞同：1
> 
> 时间：2009-05-14T18:48:55.177
> 
> 标签：sql-server, database, indexing, performance

在我当前的项目中，一些表有一个名为“changed”的列，它指示当前行自上次检查以来是否已更改。所有插入和更新语句都包含此列。

每小时，我运行一个计划任务，查询所有更改的行，对这些行执行一些操作，然后将 null 设置为它的“更改”列。

这可能是一个性能问题，因为我将在本专栏中进行大量的写入和读取操作，索引将不断重建。

这种情况的最佳选择是什么（而不是不使用这种机制）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T18:59:02.377

如果您的表很大，请删除该列并制作一个专用表（仅包含主键信息）并将触发器插入到该表中。然后，您只需要处理这个小表，并在完成行时将其清除。您需要为要跟踪的每个表执行此操作。

如果您的表很小，则列可能不是一个坏主意，但是如果您对这些表有很多选择和更新，并且您的计划处理循环或非常慢，您可能会看到阻塞/锁定。

如果您使用列，最好有一个 LastChgDate 列，然后您只需处理一个范围内的所有行（您需要跟踪每次处理的范围），但您不需要更改LastChgDate 显示它是“完成”。如果您的计划进程正在更新实际行，这可能没有实际意义，但您没有说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:29:20.673

由于该列可能只有两个值（null 和 1 表示已更改），因此索引可能无论如何都没用。

# c# - 使用 ROWLEX 以编程方式从 OWL 文件生成程序集

> ID：865052
> 
> 赞同：2
> 
> 时间：2009-05-14T18:49:00.293
> 
> 标签：c#, .net, rdf, owl, rowlex

我一直在使用[ROWLEX](http://rowlex.nc3a.nato.int)库来处理 RDF-s。它附带一个名为 OwlGrinder.exe 的设计时 GUI 工具，它可以从我的 OWL 本体生成 C# 助手类（准确地说是.NET 程序集）。我想知道是否有人知道我是否可以在运行时以编程方式执行相同的操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T13:15:39.070

ROWLEX 刚刚成为开源软件，所以现在您有机会实际查看 OwlGrinder.exe 的代码并从那里复制代码。但是，这是一个简短的示例：

```
 private NC3A.SI.Rowlex.AssemblyGenerator generator;

    private void RunAssemblyGeneration(XmlDocument ontologyFileInRdfXml)
    {
        this.generator = new NC3A.SI.Rowlex.AssemblyGenerator();
        this.generator.GenerateAsync(ontologyFileInRdfXml, "myAssemblyName", 
                                        null, this.OnGenerationFinished);
    }

    private void OnGenerationFinished(string errorMessage)
    {
        if (errorMessage == null)
        {
            // Success
            // Displaying warnings and saving result
            string[] warnings = this.generator.Warnings;
            this.generator.SaveResult(@"C:\myAssemblyName.dll");
                // Important! One generator instance can be executed only once. 
                this.generator = null; 
                this.RejoiceOverSuccess();
            }
        else
        {
                // Failure
                this.MournOverFailure();
            }

    } 
```

如果您想在运行时生成程序集，我假设您可能希望根据用户的要求一遍又一遍地重复该操作。您必须注意这里，因为 .NET 不允许您卸载程序集。因此，您无法摆脱以前运行的程序集。解决方案是每次在可以卸载的新 AppDomain 中执行生成代码。OwlGrinder.exe 正是这样做的，您可能希望在 MainForm.cs 中达到峰值

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T21:44:03.103

是的，Lame 先生，您可以通过编程方式生成 .NET 代码。

有几个选择。

1.  将代码创建为文本。
    您可以从应用程序中编译任何 .cs 或 .vb 源文件。有关初学者，请参阅 Microsoft.CSharp.CSharpCodeProvider 类的帮助。您以编程方式调用编译器，指定要嵌入的资源、生成的程序集的放置位置、依赖关系等。这里的一种情况是使用 template.cs 文件，在其中嵌入更多代码，然后对其进行编译。结果是由该代码生成的程序集（.dll 或 .exe 或 .netmodule，如果您愿意）。然后，您可以使用反射加载该程序集并调用它。

2.  使用文档对象模型创建代码。
    这里的相关功能区域称为“CodeDom”，它的工作方式类似于网页的 HTML DOM，除了文档对象模型用于创建 .NET 代码。您可以使用 DOM 元素以编程方式构建代码。

CodeDom 的例子：

```
var class1 = new System.CodeDom.CodeTypeDeclaration(className);
class1.IsClass=true;
class1.TypeAttributes = System.Reflection.TypeAttributes.Public;
class1.Comments.Add(new System.CodeDom.CodeCommentStatement("This class has been programmatically generated"));
// add a constructor to the class
var ctor= new System.CodeDom.CodeConstructor();
ctor.Attributes = System.CodeDom.MemberAttributes.Public;
ctor.Comments.Add(new System.CodeDom.CodeCommentStatement("the null constructor"));
class1.Members.Add(ctor);

// add one statement to the ctor:  an assignment
// in code it will look like;  _privateField = new Foo(); 
ctor.Statements.Add(new System.CodeDom.CodeAssignStatement(new System.CodeDom.CodeVariableReferenceExpression("_privateField"), new System.CodeDom.CodeObjectCreateExpression(fooType)));

// include a private field into the class
System.CodeDom.CodeMemberField field1;
field1= new System.CodeDom.CodeMemberField();
field1.Attributes = System.CodeDom.MemberAttributes.Private;
field1.Name= "_privateField";
field1.Type=new System.CodeDom.CodeTypeReference(fooType);
class1.Members.Add(field1); 
```

等等等等。你可以在代码中添加常规方法、各种语句等等。AFAIK CodeDom 的东西支持该语言支持的一切。你可以做 lambdas 和 linq 表达式，条件和控制流，任何东西。

然后，您可以编译该类，并再次生成一个程序集，您可以将其保存到磁盘或保存在内存中并动态加载。

# java - 有没有更好的方法来为许多分机做文件过滤？

> ID：865059
> 
> 赞同：10
> 
> 时间：2009-05-14T18:50:29.977
> 
> 标签：java, string, file-io, filter

```
File files[] = rootDir.listFiles(new FileFilter() {
    public boolean accept(File file) {
        if (file.isDirectory())
            return true;

    String name = file.getName().toLowerCase();

    if (name.endsWith(".zip") || name.endsWith(".jar")
     || name.endsWith(".z") || name.endsWith(".gz")
     || name.endsWith(".tar") || name.endsWith(".bz2")
     || name.endsWith(".bz"))
        return true;

    return false;
    }
}); 
```

如您所见，代码很脏，带有“||”

你知道如何让它变得更好吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-14T19:01:55.643

对于 Java 6 或更高版本，这是 a [`FileNameExtensionFilter`](http://java.sun.com/javase/6/docs/api/javax/swing/filechooser/FileNameExtensionFilter.html)... 的完美案例，只是它扩展`javax.swing.filechooser.FileFilter`而不是实现`java.io.FileFilter`.
但是为它编写一个包装器是微不足道的：

```
File[] files = rootDir.listFiles(new FileFilter() {
    private final FileNameExtensionFilter filter =
        new FileNameExtensionFilter("Compressed files",
            "zip", "jar", "z", "gz", "tar", "bz2", "bz");
    public boolean accept(File file) {
        return filter.accept(file);
    }
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T18:53:34.010

为什么不使用正则表达式？

`static final Pattern p = Pattern.compile("\\.(zip|jar|z|gz)$");`

进而`return p.matcher(name).find();`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T18:58:46.387

一些伪代码解决方案：

## 遍历数组

```
suffixes = [".tar", ".zip", ".jpg"]

for suffix in suffixes:
    if name.endsWith(suffix):
        return True 
```

## 使用一套

```
suffixes = [".tar", ".zip", ".jpg"]

nameSuffix = name.getSuffix()
if nameSuffix in suffixes:
    return True 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T19:16:09.730

我刚写完这堂课：

```
class FileExtensionFilter implements FileFilter {

    private final String[] validExtensions;

    public FileExtensionFilter(String... validExtensions) {
        this.validExtensions = validExtensions;
    }

    public boolean accept(File pathname) {
        if (pathname.isDirectory()) {
            return true;
        }

        String name = pathname.getName().toLowerCase();

        for (String ext : validExtensions) {
            if (name.endsWith(ext)) {
                return true;
            }
        }

        return false;
    }
} 
```

用法：

```
File files[] = directory.listFiles(
                  new FileExtensionFilter(".zip", ".jar", ".z", ".tar")); 
```

顺便说一句，这是一个可重用的类，您甚至可以使用装饰器模式等附加检查来包装它。

**附言**

刚刚注意到 FileNameExtensionFilter 的存在

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T19:18:13.203

您可以使用静态初始化的 HashSet 执行以下操作。就个人而言，我会将允许的扩展名提取到某种配置文件中，以使其更容易更改，但您不必这样做。

nb **FilenameUtils**属于**Commons I/O**，它还包括一堆使此类事情变得更容易的类。看看**FileFilterUtils**，它进一步简化了事情并提供了一些很好的帮助方法。

私有静态设置 allowedExtensions = null;

```
static {
    allowedExtensions = new HashSet<String>();
    allowedExtensions.add("txt");
    allowedExtensions.add("zip");
    allowedExtensions.add("jar");
    allowedExtensions.add("gz");
}

public void filter() {
    File rootDir = new File("/");
    File files[] = rootDir.listFiles(new FileFilter() {

        public boolean accept(File file) {

            if (file.isDirectory()) return true;

            String fileName = file.getName().toLowerCase();

            String extension = FilenameUtils.getExtension(fileName);
            if (StringUtils.isNotEmpty(extension)
                && allowedExtensions.contains(extension)) {
                return true;
            } else {
                return false;
            }
        }
    });        
} 
```

你可以在这里找到 API：

[http://commons.apache.org/io/api-release/](http://commons.apache.org/io/api-release/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T18:54:38.843

您可以静态创建地图，如果文件扩展名是地图中的键，则返回 true。

或者您可以尝试将文件名与正则表达式匹配（但我会选择使用映射）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T19:36:15.640

这是我的方法。java.lang.Collections 真的是一个不错的类！而且因为我们在 HashSet 中查找给定的文件扩展名，所以它的性能更高。虽然我怀疑，但在这种情况下，这种表现真的很重要......

```
// ...

final Set<String> archives = new HashSet<String>();
Collections.addAll(archives, ".zip", ".jar", ".z", ".gz", ".tar",
        ".bz2", ".bz");

File files[] = rootDir.listFiles(new FileFilter() {
    public boolean accept(final File file) {
        if (file.isDirectory())
            return true;

        final String name = file.getName().toLowerCase();
        return archives.contains(name
                .substring(name.lastIndexOf('.')));

    }
});

// ... 
```

# php - Zend_Db 对象是否有 Rows 属性？

> ID：865061
> 
> 赞同：-1
> 
> 时间：2009-05-14T18:51:37.183
> 
> 标签：php, zend-framework

寻找一个属性，它会给我查询返回的行数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T18:53:05.527

$rowset->count() - 或 count($rowset);

# infopath - 在 Sharepoint 中打开 Infopath 表单的问题

> ID：865073
> 
> 赞同：1
> 
> 时间：2009-05-14T18:54:49.843
> 
> 标签：infopath

我已将 InfoPath 表单作为内容类型发布并在文档库中引用它。但是，当我尝试从文档库中打开 InfoPath 表单时，我收到以下错误消息：

不允许请求的注册表访问。在 System.ThrowHelper.ThrowSecurityException(ExceptionResource resource) 在 Microsoft.Win32.RegistryKey.OpenSubKey(String name, Boolean writable) 在 Microsoft.Win32.RegistryKey.OpenSubKey(String name) 在 Microsoft.Win32.Registry.GetValue(String keyName, String valueName, Object defaultValue) 在 Microsoft.Office.InfoPath.Server.Runtime.FormServer.<>c__DisplayClass1.b__0() 在 Microsoft.Office.Server.Security.SecurityContext.RunAsProcess(CodeToRunElevated secureCode) 在 Microsoft.Office.InfoPath.Server。 Runtime.FormServer.DeterminePremiumSku() 在 Microsoft.Office.InfoPath.Server.Runtime.FormServer.get_IsPremium() 在 Microsoft.Office.InfoPath.Server.Controls.FormServerPage.OnInit(EventArgs e) 在 System.Web.UI.Control。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-06T15:25:31.757

I got this message as well. It turned out my MOSS 2007 copy had reverted to trial mode. After making the registry changes [outlined here](http://mcse-blogs.com/certification/requested-registry-access-is-not-allowed-error-with-forms-server-andor-moss.html) I got the following message after refreshing the page: `The trial period for this product has expired.`

I entered the license key again in Central Administration and everything started to work again.

# windows - 有没有办法检测和响应/停止一个进程的启动？

> ID：865081
> 
> 赞同：0
> 
> 时间：2009-05-14T18:56:23.147
> 
> 标签：windows

我想要一个只在后台运行的程序，并检测某个进程何时启动，并希望阻止它启动，然后在 Windows 中以某种方式对其做出反应。具体来说，我的同事会在忘记锁定机器 2 秒并喝咖啡或去洗手间的任何人的机器上安装“epic fail”。我想防御这个可执行文件的运行，也许让计算机说“不，你是失败的那个”。我知道某些根工具包可以做到这一点，但显然我不想使用这样的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T18:59:52.170

这并不难，你可以使用 EnumProcess 或 Toolhelp API 来获取进程，你可以编写一个服务来经常这样做，然后用 TerminateProcess 杀死有问题的 PID。

# python - Python：将 wx.py.shell.Shell 插入单独的进程

> ID：865082
> 
> 赞同：1
> 
> 时间：2009-05-14T18:56:26.547
> 
> 标签：python, shell, wxpython, multiprocessing

我想创建一个外壳来控制我使用多处理模块创建的单独进程。可能的？如何？

**编辑：**

我已经实现了一种向辅助进程发送命令的方法：我`code.InteractiveConsole`在该进程中创建了一个，并将其附加到一个输入队列和一个输出队列，这样我就可以从我的主进程命令控制台。但我希望它在一个外壳中，可能是一个`wx.py.shell.Shell`，所以程序的用户可以使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T12:13:52.093

1.  首先创建外壳
2.  通过将本地变量设为空，将 shell 与您的应用程序分离
3.  创建您的代码字符串
4.  编译代码字符串，得到一个代码对象
5.  在shell中执行代码对象

```
    从 wx.py.shell 导入外壳

    frm = wx.Frame(无)
    sh = 壳牌（frm）
    frm.Show()    
    sh.interp.locals = {}
    codeStr = """
    从多处理导入进程，队列

    定义 f(q)：
        q.put([42, 无, '你好'])

    q = 队列（）   
    p = 进程（目标=f，args=（q，））
    p.start()
    print q.get() # 打印 "[42, None, 'hello']"
    p.join()
    """

    代码 = 编译（codeStr，''，'exec'）
    sh.interp.runco​​de（代码）

```

注意：由于一些酸洗问题，我从第一张海报中窃取的 codeStr 可能无法在此处使用。但关键是您可以在 shell 中远程执行自己的 codeStr。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:27:00.443

您可以创建一个`Queue`传递给单独进程的文件。来自[Python 文档](http://docs.python.org/library/multiprocessing.html)：

```
from multiprocessing import Process, Queue

def f(q):
    q.put([42, None, 'hello'])

if __name__ == '__main__':
    q = Queue()
    p = Process(target=f, args=(q,))
    p.start()
    print q.get()    # prints "[42, None, 'hello']"
    p.join() 
```

**示例：**在[wx.py.shell.Shell 文档](http://www.wxpython.org/docs/api/wx.py.shell.Shell-class.html#__init__)中，构造参数给出为

```
__init__(self, parent, id, pos, size, style, introText, locals, 
         InterpClass, startupScript, execStartupScript, *args, **kwds) 
```

我没有尝试过，但`locals`可能是一个局部变量字典，你可以将它传递给 shell。所以，我会尝试以下方法：

```
def f(cmd_queue):
    shell = wx.py.shell.Shell(parent, id, pos, size, style, introText, locals(),
                              ...)

q = Queue()
p = Process(target=f, args=(q,))
p.start() 
```

在 shell 内部，您应该能够将您的命令放入`cmd_queue`其中，然后在要执行的父进程中读取这些命令。

# php - 将变量传递给 XSLT

> ID：865085
> 
> 赞同：4
> 
> 时间：2009-05-14T18:57:43.033
> 
> 标签：php, xml, xslt

我是 XML/XSL 的新手。我希望能够在规则字符串中传递一个 var 并让它返回正确的数据。

现在我有这个PHP：

```
<?php
$params = array('id' => $_GET['id']);

$xslDoc = new DOMDocument(); 
$xslDoc->load("test.xsl"); 

$xmlDoc = new DOMDocument(); 
$xmlDoc->load("test.xml");

$xsltProcessor = new XSLTProcessor(); 
$xsltProcessor->registerPHPFunctions(); 
$xsltProcessor->importStyleSheet($xslDoc); 

foreach ($params as $key => $val)
    $xsltProcessor->setParameter('', $key, $val);

echo $xsltProcessor->transformToXML($xmlDoc);
?> 
```

我的 xml 文件如下所示：

```
<Profiles> 
  <Profile> 
    <id>1</id> 
    <name>john doe</name> 
    <dob>188677800</dob> 
  </Profile> 
  <Profile> 
    <id>2</id> 
    <name>mark antony</name> 
    <dob>79900200</dob> 
  </Profile> 
  <Profile> 
    <id>3</id> 
    <name>neo anderson</name> 
    <dob>240431400</dob> 
  </Profile> 
  <Profile> 
    <id>4</id> 
    <name>mark twain</name> 
    <dob>340431400</dob> 
  </Profile> 
  <Profile> 
    <id>5</id> 
    <name>frank hardy</name> 
    <dob>390431400</dob> 
  </Profile> 
</Profiles> 
```

我的 xsl 看起来像这样

```
<xsl:stylesheet version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:param name="id" />

  <xsl:template match="*">
    <html><body>
    <h2>Profile</h2>
    <table cellspacing="1" cellpadding="5" border="1"> 
      <caption>User Profiles</caption> 
      <tr><th>ID</th><th>Name</th><th>Date of Birth</th></tr> 

      <xsl:for-each select="/Profiles/Profile[id='$id']">
        <tr> 
          <td><xsl:value-of select="id"/></td> 
          <td><xsl:value-of select="php:function('ucwords', string(name))"/></td> 
          <td><xsl:value-of select="php:function('date', 'jS M, Y', number(dob))"/></td> 
        </tr> 
      </xsl:for-each> 
    </table> 
    </body></html>
  </xsl:template>
</xsl:stylesheet> 
```

当我像这样测试网址时：

```
http://foo.com/sanbox/index.php?id=2
```

我只得到：

```
轮廓
用户配置文件 ID 名称 出生日期。

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T06:49:03.197

该错误是因为您没有包含正确的命名空间。

在您的 xsl:stylesheet 声明中包括 xmlns:php="http://php.net/xsl"

```
<xsl:stylesheet version="1.0" 
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:php="http://php.net/xsl"
> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T19:09:57.433

在 XPATH 表达式中，变量名 $id 周围不应有任何 qoutes，因此它应为：

```
<xsl:for-each select="/Profiles/Profile[id=$id]"> 
```

此外，您可以`<xsl:value-of select="$id"/>`在文档中放入 a 以确保传递该值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T20:45:50.933

嘿，我也是实现 xsl/xml 的新手，但我玩了一会儿你的代码，我无法让它工作，但即使你改变了

```
<xsl:for-each select="/Profiles/Profile[id='$id']"> 
```

至

```
<xsl:for-each select="/Profiles/Profile[id='2']"> 
```

尽管它确实获取了正确的信息，但您仍然会遇到一个令人讨厌的错误。如果您删除任何“”，甚至“”，除了数字之外的任何内容都会产生更多错误。我找到了另一种方法来做到这一点，尽管我没有时间测试它。[客户端 XSLT](http://www.tonymarston.net/php-mysql/client-side-xslt.html)

我和你有同样的问题，真的很想看到这个问题得到解决。

警告：XSLTProcessor::transformToXml() [xsltprocessor.transformtoxml]: xmlXPathCompOpEval: function function bound to undefined prefix php in E:\xampplite\htdocs\XSL\index.php on line 17

警告：XSLTProcessor::transformToXml() [xsltprocessor.transformtoxml]: xmlXPathCompiledEval: 1 个对象留在堆栈上。在第 17 行的 E:\xampplite\htdocs\XSL\index.php

警告：XSLTProcessor::transformToXml() [xsltprocessor.transformtoxml]: xmlXPathCompOpEval: function function bound to undefined prefix php in E:\xampplite\htdocs\XSL\index.php on line 17

警告：XSLTProcessor::transformToXml() [xsltprocessor.transformtoxml]: xmlXPathCompiledEval: 2 个对象留在堆栈上。在第 17 行的 E:\xampplite\htdocs\XSL\index.php

轮廓

用户配置文件 ID 姓名 出生日期 2 马克安东尼 79900200

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-17T02:29:46.653

这里有一些问题阻止它工作，一些已经提到过..

如上所述的命名空间：

```
<stylesheet xmlns:php="http://php.net/xsl" 
```

for-each...我倾向于使用：

```
<xsl:template match="/"> 
```

然后

```
<xsl:for-each select="Profiles/Profile[id=$id]"> 
```

此外，引号不正确，如上所述，id 不需要 ''

通过这三个更改，它可以工作....

# php - “和”的MySQL / PHP问题

> ID：865086
> 
> 赞同：2
> 
> 时间：2009-05-14T18:58:02.033
> 
> 标签：php, mysql, collation

我使用 PHP 和 MySQL 制作了一个带有评论的简单新闻系统，它在我的本地 Apache 服务器上运行良好，无论是在我的 Fedora 10 机器上，还是在我的 Windows 7 机器上。现在我有一个问题，我把它上传到一个网络主机，它不断返回所有的'和“作为\'和\”。

我相信这要么是出于安全原因自动添加它们的网络主机，要么是 MySQL 是错误的排序规则，但我还没有能够解决它，测试多个 MySQL 排序规则。

下面是一个查询示例：

```
mysql_query("INSERT INTO news (title, poster, text, time) VALUES ('$newstitle', '1', '$newstext', '$time')") or die(mysql_error()); 
```

`$time`is`time();` `$newstitle`和`$newstext`are parsed from`$_POST`并且两者都`mysql_real_escape_string()`在我运行查询之前运行（我想这可能是问题，但由于它是安全性的一部分，我只是不想删除它，因为它没有引起问题在我的本地服务器上）

最后一点：在我的本地 apache 服务器上，我`latin1_swedish_ci`在 web 主机服务器上不起作用。

**编辑：**

它们在数据库中看起来像这样：

```
\'\'\'\&quot;\&quot;\&quot; 
```

而在我的本地，他们没有额外的反斜杠，所以它必须是 PHP 添加它。除了添加一个删除多余反斜杠的函数之外，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T19:05:10.567

这些额外的反斜杠可能是[Magic Quotes](http://docs.php.net/manual/en/security.magicquotes.php)。在处理数据之前尝试[禁用它们或删除它们。](http://docs.php.net/manual/en/security.magicquotes.disabling.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T19:03:13.847

**编辑**：正如下面多次提到的，在评论中，正确的方法是禁用魔术引号。如果我在回答之前完全阅读并理解了这个问题，那可能会更好；）

* * *

`mysql_real_escape_string()`将按照它所说的去做，并转义字符串中的相关字符。转义引号是通过在它们前面加上转义字符（PHP 和许多其他语言中的反斜杠）来完成的。 **当您从数据库中拉回数据时**，对内容执行类似运行`stripslashes()`（请参阅[PHP 文档](http://uk3.php.net/stripslashes)）的操作，以删除引号等内容中的斜线。

**编辑**：正如 Gumbo 提到的，这也可能是由于在服务器上启用了 Magic Quotes。[你应该按照他的回答](https://stackoverflow.com/questions/865086/mysql-php-problem-with-and/865120#865120)禁用这些。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T19:06:46.147

不，您不想运行 stripslashes()。相反，正确设置您的服务器。

首先，关闭magic_quotes。这意味着进入脚本的任何数据都不会逃脱。

然后在数据上运行 mysql_real_escape_string() ，这将只为查询添加斜杠，并将数据存储在数据库中而没有斜杠。

再次加载数据时，一切顺利，引号周围不会有任何反斜杠。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T19:13:22.137

查看您的[`magic_quotes`](http://us2.php.net/manual/en/security.magicquotes.what.php)设置，并在您的服务器上进行比较。您的家庭服务器可能已`magic_quotes`禁用（应该如此，因为在当前版本的 PHP[中不推荐使用 Magic Quotes](http://www.php.net/manual/en/security.magicquotes.disabling.php)），并且您的 Web 主机可能已启用它们（可悲的是，这很常见）。您可以使用：

```
<?php echo phpinfo(); ?> 
```

进行快速比较。

如果你不熟悉magic_quotes，那么在部署你关心的任何东西之前，你可能想多研究一下PHP 安全性。

[包含“magic_quotes”的问题](https://stackoverflow.com/search?q=magic_quotes)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T19:06:21.373

您的主机可能启用了[魔术引号。](http://ca.php.net/manual/en/security.magicquotes.what.php)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T19:06:27.647

看看[magic_quotes_gpc](http://us.php.net/magic_quotes)。您可以通过 .htaccess 将其关闭并使用 mysql_real_escape_string()。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-14T20:46:22.150

真正的解决方案是在插入查询中使用准备好的语句。

这是一个顶部有插入示例的站点。

[PHP 中的准备好的语句](http://www.hiteshagrawal.com/mysql/mysql-prepared-statement-in-php)

好处是它是一种最佳实践，副作用是您不再需要担心清除输入以防 SQL 注入攻击。

# c# - Silverlight：判断DataContext是否被继承

> ID：865090
> 
> 赞同：0
> 
> 时间：2009-05-14T18:58:27.760
> 
> 标签：c#, silverlight, datacontext

在运行时以通用方式（即迭代 UIElements）我可以确定给定的 FrameWorkElement 是否具有非继承的 DataContext 属性集？我想要一个明确设置 DataContext 的元素列表，而不是从链中的更高层继承。我想也许 GetBindingExpression() 会有所帮助，但到目前为止还没有。使用 Silverlight beta 3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-10T20:09:32.587

确实！只需使用相等运算符比较 FrameworkElement Parent 的 DataContext。

在子控件将 DataContext 设置为与父控件完全相同的项的情况下，它可能无济于事，但在大多数情况下会有所帮助。

# wpf - 复合 WPF Visual Studio 样式界面

> ID：865094
> 
> 赞同：1
> 
> 时间：2009-05-14T18:59:15.637
> 
> 标签：wpf, prism

我希望使用 WPF Composite Application Guidance (PRISM) 设计一个具有 Visual Studio 界面风格的界面。我想在左边有一棵树，可以打开不同的视图。当有人单击树中的节点时，在选项卡的右侧打开视图。如果视图已在选项卡中打开，请将其放在前面。我还希望树与活动选项卡同步。

我试过搜索一些关于这方面的文章，但没有运气。有没有人有任何关于如何实现这一点的链接或信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T19:13:17.223

我认为你应该先从 MVVM 开始。 [http://msdn.microsoft.com/en-us/magazine/dd419663.aspx](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:49:22.767

Infragistics 有一个[xamDockManager](http://www.infragistics.com/dotnet/netadvantage/wpf/xamdockmanager.aspx#Overview)控件，可以为您完成很多工作。我没有使用过这个特定的控件，但是我使用了他们的一些其他 WPF 控件并取得了不同程度的成功。

# java - 如何为我们的系统提供 API

> ID：865096
> 
> 赞同：1
> 
> 时间：2009-05-14T18:59:38.363
> 
> 标签：java, api

我对 Web 服务或 API 没有太多经验。

我们有一个基于 Oracle->Sun App Server->Java->Struts2 框架的网站。我们需要为我们的系统提供 API。此 API 将被我们系统之外的其他系统使用。API 仅适用于我们数据库中的一个简单 SP。另一个系统不想连接到我们的数据库以获得对 SP 的访问权限，而是将 API 作为“网络服务”

社区能否说明如何解决这个问题？API 会放在我们的网络服务器上吗？那是其他系统将如何连接到它的方式吗？以及如何创建公共 API？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T19:12:06.290

您需要考虑的一些事情是：

*   SOAP 与 REST（[为什么要使用 REST 而不是基于 SOAP 的服务？](https://stackoverflow.com/questions/90451/why-would-one-use-rest-instead-of-web-services)）
*   您将如何处理身份验证？
*   它需要扩展吗？

您可能想看看[https://jersey.dev.java.net/](https://jersey.dev.java.net/)。

看看另一家公司是如何做到的也会有所帮助，请查看[http://www.flickr.com/services/api/](http://www.flickr.com/services/api/)了解一些想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T19:41:47.280

如果您使用的是 Sun App Server，那么使用 @WebService 标记将 EJB 公开为 Web 服务，然后让该 EJB 调用存储过程并返回数据应该是相当简单的。应用服务器为您提供了发布 WSDL 的工具，他们将使用该工具来了解如何调用您的 API。

话虽如此，在 50,000 英尺处听起来很容易，但处理所有细节确实很痛苦。首先，安全性如何？其次，是否真的需要 WebServices，或者是否有更好的更明显的通信机制，例如（至少）REST，如果不是一些简单的 servlet 通信。最困难的部分：您将以什么格式返回这个结果集？

无论如何，您可能会在这里处理一些政治问题（“什么，您不知道如何进行 Web 服务，每个人都知道，等等”），因此可能有点难以探究需求。好消息是，在最新的 Java EE 中发布 Web 服务非常简单（比使用 Web 服务容易得多）。坏消息是细节将是一个杀手。例如，我见过有经验的 Web 服务开发人员在命名空间问题上花费数小时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T20:13:05.037

肥皂或休息或.. 是奖牌的一方面，取决于客户想要什么。另一个（更）重要的是 api 设计本身。它应该是无状态的还是有状态的。客户端是位于同一个虚拟机（Appserver）中还是远程在同一个 LAN 中，甚至是在一个 Wan 中。一旦通信通过线路，它就会由于序列化而变慢。因此，您希望 API 方法一次获取更大（但不是太大）的数据块。

或者换句话说，如果不了解更多关于您想要和需要做什么的信息，您的问题就无法真正得到回答。

# asp.net - asp:DataList 控件，内部带有 asp:LinkBut ton - 有点奇怪

> ID：865104
> 
> 赞同：3
> 
> 时间：2009-05-14T19:01:02.400
> 
> 标签：asp.net

我正在研究一本试图学习 ASP.NET 的书中的示例，但我偶然发现了一些奇怪的东西。首先，如果我按照书中的内容输入，VS 会给我错误。这是书中写的代码：

```
 <asp:DataList ID="employeesList" runat="server">
    <ItemTemplate>
        <asp:Literal ID="extraDetailsLiteral" runat="server" EnableViewState="false" />
        Name: <strong><%#Eval("Name") %></strong><br />
        Username: <strong><%#Eval("Username") %></strong><br />
        <asp:LinkButton ID="detailsButton" runat="server" Text=<%#"View more details about " + Eval("Name")%> 
            CommandName="MoreDetailsPlease" 
            CommandArgument=<%#Eval("EmployeeID")%> />
    </ItemTemplate>
    <SeparatorTemplate>
        <hr />
    </SeparatorTemplate>
</asp:DataList> 
```

所以，我已经研究了一段时间，并提出了这个实际编译的解决方案：

```
 <asp:DataList ID="employeesList" runat="server" onitemcommand="employeesList_ItemCommand">
    <ItemTemplate>
        <asp:Literal ID="extraDetailsLiteral" runat="server" EnableViewState="false" />
        Name: <strong><%#Eval("Name") %></strong><br />
        Username: <strong><%#Eval("Username") %></strong><br />
        <asp:LinkButton ID="detailsButton" runat="server" Text='View more details about <%# Eval("Name") %>' 
            CommandName="MoreDetailsPlease" CommandArgument='<%Eval("EmployeeID") %>' />
    </ItemTemplate>
    <SeparatorTemplate>
        <hr />
    </SeparatorTemplate>
</asp:DataList> 
```

请注意，我还在 asp:DataList 标记中添加了 OnItemCommand，所以现在我可以按预期触发事件。

但是，浏览器中的结果不是我所期望的；**强文本**中列出的名称和用户名显示得很好，但是应该显示额外详细信息的文字控件（EmployeeID 字段）和 LinkBut​​ton 内的名称字段不会在页面中显示它们的值：

[未按预期显示 http://lh6.ggpht.com/_x84bQLYH57A/SgxzygartcI/AAAAAAAAAIY/nhT-6RUJa6o/s144/EmployeeDirectory_notshowing.jpg](http://lh6.ggpht.com/_x84bQLYH57A/SgxzygartcI/AAAAAAAAAIY/nhT-6RUJa6o/s144/EmployeeDirectory_notshowing.jpg)

它**应该**显示“EmployeeID：1”和“查看有关 Zak Ruvalcaba 的更多详细信息”

我想这是在另一个控件中时无法正常工作的 Eval 函数，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T19:05:13.437

将 LinkBut​​ton 更改为：

```
<asp:LinkButton ID="detailsButton" runat="server" 
     Text='<%# Eval("Name", "View more details about {0}") %>' 
     CommandName="MoreDetailsPlease" 
     CommandArgument='<%# Eval("EmployeeID") %>' /> 
```

对不起，我混淆了参数的顺序。我更新了我的答案。格式必须是第二个参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T19:09:51.523

您可以查看我昨天发布的另一个问题，该问题与此处惊人的相似：

[需要 DataList 中的 Eval 帮助](https://stackoverflow.com/questions/853299/need-help-with-eval-inside-datalist)

但是，我确实相信 Canavar 实际上给出了正确的答案。

# windows - Windows 中有类似 Linux ptrace 系统调用的东西吗？

> ID：865106
> 
> 赞同：9
> 
> 时间：2009-05-14T19:01:35.317
> 
> 标签：windows, ptrace

阅读*[Monitoring certain system calls done by a process in Windows](https://stackoverflow.com/questions/864839/monitoring-certain-system-calls-done-by-a-process)*，我想知道 Windows 是否等同于[ptrace](https://en.wiktionary.org/wiki/programmatical#Adjective)系统调用或编程解决方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T19:08:08.377

您可以使用 ETW 来跟踪系统调用。启动跟踪时，在 EVENT_TRACE_PROPERTIES 中，您可以将 EVENT_TRACE_FLAG_SYSTEMCALL 标志添加到 EnableFlags。这将启用 SysCallEnter 和 SysCallLeave 事件，如此处[所述](http://msdn.microsoft.com/en-us/library/aa964809(VS.85).aspx)。

# algorithm - 使用 DOS 通配符暴力破解字符串的最快方法

> ID：865107
> 
> 赞同：6
> 
> 时间：2009-05-14T19:01:47.470
> 
> 标签：algorithm, string, wildcard, brute-force

这个问题类似于盲目的 SQL 注入。目标是确定字符串的确切值，您唯一能做的测试是查看您指定的 DOS 样式通配符（？= 任意字符，* = 任意数量的任意字符）是否与字符串匹配。（所以实际上你只能访问一个`bool DoesWildcardMatch(string wildcard)`函数）。

直接的方法是进行测试，`a*, b*, c*...`直到找到第一个字母，然后重复。我能想到的一些优化：

*   搜索`*a*, *b*`etc. 以确定字符集
*   当`*x*`找到匹配项时，执行 divide-et-impera ( `*a*x*, *b*x*, ...`)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T19:34:17.843

至于分权，请务必跟踪您知道不存在的价值。我也不会使用`a, b, c`，而是使用频率顺序。某种马尔可夫链可能会使其更快。

需要注意的一件事是，您不能假设给定的文字将始终与输入中的相同位置匹配。这对于在最后删除通配符特别感兴趣。

```
c a b a
--------
* a *     match
  * b*a*  woops! 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T19:39:04.603

第一个想法。您可以确定`n`字符串的长度`O(log2(n))`。

*   检查`Z*`where`Z`表示`k`问号，从 0 开始，然后是 1，然后每次检查都将问号的数量加倍，直到不匹配。`n`必须在`k / 2`和之间`k`
*   `k`使用与二进制搜索相同的方式更改相同的模式找到确切的长度。

知道确切的长度可能有助于在空间域中执行一种分而治之的方法。

**更新**

如果您知道长度，则可以使用相同的模式来正确定位符号。

例子：

```
    ..X。..XX（为便于阅读添加了空格）

                              + 符号可能是 X
                              - 符号不是 X
                              X 符号是 X

    *X* => 匹配 ++++ ++++
    *X* ？？？？=> 匹配 ++++ ++++
    *X*？？？？？=> 不匹配 --++ ++++
    ？？X？？？？=> 匹配 --X+ ++++
    ??XX???? => 不匹配 --X- ++++
    ？？X？*X*？？=> 不匹配 --X- --++
    ？？X？？？X？=> 匹配 --X- --X+
    ？？X？??XX => 匹配 --X- --XX

```

对于字符串长度`n`和字母大小，`m`这将需要`O(log2(n))`找到字符串的长度，`O(n • log2(n))`正确放置`n`符号，并`O(m)`找到使用的符号 - 将所有符号加在一起产生`O(n • log2(n) + m)`。

我可以想象，可以通过合并几个步骤来加快速度 - 可能在确定字符串长度的同时测试使用的符号，或者同时在字符串的前半部分和后半部分定位两个（甚至更多？）符号。如果检查失败，这将需要单独重新检查合并的步骤，以确定哪个检查失败。但只要合并检查成功，您就可以获得两者的信息。

也许我明天会计算一下，看看它是否真的会加快速度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T19:20:03.557

如果具体数量？有效，你也可以检查“？”，“？？”，“？？？” 等等来获取字符串的长度，但我怀疑这会有所帮助，因为您还可以在每轮之后只进行一次额外检查而无需任何通配符来检查您是否获得了正确的长度。

我认为之前带有字符集检查的分割方法几乎是最佳的，还有一些额外的细节，例如如果你匹配`*a*b*`，你应该`*ab*`在之后检查是否有字母，当然如上所述，检查`*ab`和“ab “在此之后知道你是在右侧完成还是完全完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T19:23:20.680

为什么不将 DOS 风格的通配符字符串转换为正则表达式？例如：

？一种*

变成：

。一种。*

然后只需执行一个简单的正则表达式匹配，将其与您的测试字符串进行比较。

# python - 如何正确清理 Python 对象？

> ID：865115
> 
> 赞同：542
> 
> 时间：2009-05-14T19:04:12.377
> 
> 标签：python, destructor

```
class Package:
    def __init__(self):
        self.files = []

    # ...

    def __del__(self):
        for file in self.files:
            os.unlink(file) 
```

`__del__(self)`以上失败并出现 AttributeError 异常。我了解[Python 不保证](http://docs.python.org/reference/datamodel.html#customization)`__del__()`调用时存在“全局变量”（此上下文中的成员数据？） 。如果是这种情况并且这是异常的原因，我如何确保对象正确销毁？

* * *

## 回答 #1

> 赞同：717
> 
> 时间：2009-05-14T19:39:56.287

我建议使用 Python 的`with`语句来管理需要清理的资源。使用显式`close()`语句的问题是您必须担心人们完全忘记调用它或忘记将它放在`finally`块中以防止发生异常时资源泄漏。

要使用该`with`语句，请使用以下方法创建一个类：

```
 def __enter__(self)
  def __exit__(self, exc_type, exc_value, traceback) 
```

在上面的示例中，您将使用

```
class Package:
    def __init__(self):
        self.files = []

    def __enter__(self):
        return self

    # ...

    def __exit__(self, exc_type, exc_value, traceback):
        for file in self.files:
            os.unlink(file) 
```

然后，当有人想使用您的课程时，他们会执行以下操作：

```
with Package() as package_obj:
    # use package_obj 
```

变量 package_obj 将是 Package 类型的实例（它是`__enter__`方法返回的值）。`__exit__`无论是否发生异常，都会自动调用其方法。

您甚至可以将这种方法更进一步。在上面的示例中，仍然可以使用其构造函数实例化 Package 而无需使用`with`子句。你不希望这种情况发生。您可以通过创建定义`__enter__`和`__exit__`方法的 PackageResource 类来解决此问题。然后，Package 类将在`__enter__`方法内部严格定义并返回。这样一来，调用者就永远无法在不使用`with`语句的情况下实例化 Package 类：

```
class PackageResource:
    def __enter__(self):
        class Package:
            ...
        self.package_obj = Package()
        return self.package_obj

    def __exit__(self, exc_type, exc_value, traceback):
        self.package_obj.cleanup() 
```

您可以按如下方式使用它：

```
with PackageResource() as package_obj:
    # use package_obj 
```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2017-01-13T03:48:57.130

标准方法是使用[`atexit.register`](https://docs.python.org/3/library/atexit.html#atexit.register)：

```
# package.py
import atexit
import os

class Package:
    def __init__(self):
        self.files = []
        atexit.register(self.cleanup)

    def cleanup(self):
        print("Running cleanup...")
        for file in self.files:
            print("Unlinking file: {}".format(file))
            # os.unlink(file) 
```

但是您应该记住，这将保留所有创建的实例，`Package`直到 Python 终止。

使用上面保存为*package.py*的代码进行演示：

```
$ python
>>> from package import *
>>> p = Package()
>>> q = Package()
>>> q.files = ['a', 'b', 'c']
>>> quit()
Running cleanup...
Unlinking file: a
Unlinking file: b
Unlinking file: c
Running cleanup... 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2015-05-20T12:11:21.680

作为[克林特答案](https://stackoverflow.com/a/865272/321973)的附录，您可以简化`PackageResource`使用[`contextlib.contextmanager`](https://docs.python.org/3/library/contextlib.html#contextlib.contextmanager)：

```
@contextlib.contextmanager
def packageResource():
    class Package:
        ...
    package = Package()
    yield package
    package.cleanup() 
```

或者，虽然可能不像 Pythonic，但您可以覆盖`Package.__new__`：

```
class Package(object):
    def __new__(cls, *args, **kwargs):
        @contextlib.contextmanager
        def packageResource():
            # adapt arguments if superclass takes some!
            package = super(Package, cls).__new__(cls)
            package.__init__(*args, **kwargs)
            yield package
            package.cleanup()

    def __init__(self, *args, **kwargs):
        ... 
```

并简单地使用`with Package(...) as package`.

为了让事情更短，命名你的清理函数`close`并使用[`contextlib.closing`](https://docs.python.org/3/library/contextlib.html#contextlib.closing)，在这种情况下，你可以使用未修改的`Package`类，`with contextlib.closing(Package(...))`或者将其覆盖`__new__`为更简单的

```
class Package(object):
    def __new__(cls, *args, **kwargs):
        package = super(Package, cls).__new__(cls)
        package.__init__(*args, **kwargs)
        return contextlib.closing(package) 
```

而且这个构造函数是继承的，所以你可以简单地继承，例如

```
class SubPackage(Package):
    def close(self):
        pass 
```

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2017-03-20T15:37:41.807

更好的选择是使用[weakref.finalize](https://docs.python.org/3.6/library/weakref.html#weakref.finalize)。请参阅[终结器对象](https://docs.python.org/3.6/library/weakref.html#finalizer-objects)和[使用 __del__() 方法比较终结器中](https://docs.python.org/3.6/library/weakref.html#comparing-finalizers-with-del-methods)的示例。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-05-14T19:51:55.367

`__del__`我认为在调用之前不可能删除实例成员。我的猜测是您的特定 AttributeError 的原因在其他地方（也许您错误地在其他地方删除了 self.file ）。

但是，正如其他人指出的那样，您应该避免使用`__del__`. 这样做的主要原因是实例`__del__`不会被垃圾收集（它们只会在它们的引用计数达到 0 时被释放）。因此，如果您的实例涉及循环引用，只要应用程序运行，它们就会一直存在于内存中。（虽然我可能对这一切都误解了，我必须再次阅读 gc 文档，但我很确定它是这样工作的）。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-11-29T08:22:09.730

`__init__`我认为如果代码比显示的多，问题可能出在哪里？

`__del__`即使`__init__`没有正确执行或抛出异常也会被调用。

[来源](http://www.algorithm.co.il/blogs/programming/python-gotchas-1-__del__-is-not-the-opposite-of-__init__/)

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2018-04-16T14:10:21.250

这是一个最小的工作框架：

```
class SkeletonFixture:

    def __init__(self):
        pass

    def __enter__(self):
        return self

    def __exit__(self, exc_type, exc_value, traceback):
        pass

    def method(self):
        pass

with SkeletonFixture() as fixture:
    fixture.method() 
```

重要：**返回自我**

* * *

如果你像我一样，忽略了`return self`（[克林特米勒的正确答案](https://stackoverflow.com/a/865272/2394284)的部分），你会盯着这个胡说八道：

```
Traceback (most recent call last):
  File "tests/simplestpossible.py", line 17, in <module>                                                                                                                                                          
    fixture.method()                                                                                                                                                                                              
AttributeError: 'NoneType' object has no attribute 'method' 
```

希望它可以帮助下一个人。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-05-14T19:08:42.307

只需用 try/except 语句包装你的析构函数，如果你的全局变量已经被处理掉，它就不会抛出异常。

**编辑**

试试这个：

```
from weakref import proxy

class MyList(list): pass

class Package:
    def __init__(self):
        self.__del__.im_func.files = MyList([1,2,3,4])
        self.files = proxy(self.__del__.im_func.files)

    def __del__(self):
        print self.__del__.im_func.files 
```

它将在调用时保证存在的**del函数中填充文件列表。**weakref 代理是为了防止 Python，或者你自己以某种方式删除 self.files 变量（如果被删除，那么它不会影响原始文件列表）。如果即使有更多对变量的引用也没有删除它，那么您可以删除代理封装。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-05-14T19:09:24.753

似乎这样做的惯用方法是提供一个`close()`方法（或类似方法），并明确地调用它。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-09-19T15:59:09.293

`atexit.register`[是ostrakach 的回答](https://stackoverflow.com/a/41627098/2373278)中已经提到的标准方式。

但是，必须注意，不能依赖对象可能被删除的顺序，如下面的示例所示。

```
import atexit

class A(object):

    def __init__(self, val):
        self.val = val
        atexit.register(self.hello)

    def hello(self):
        print(self.val)

def hello2():
    a = A(10)

hello2()    
a = A(20) 
```

在这里，与创建对象的顺序相反，顺序似乎是合法的，因为程序给出的输出为：

```
20
10 
```

但是，当在一个更大的程序中，python 的垃圾回收器在对象的生命周期之外启动时会首先被破坏。

# ssas - MDX - 过滤多个维度

> ID：865118
> 
> 赞同：2
> 
> 时间：2009-05-14T19:05:06.090
> 
> 标签：ssas, mdx

我正在尝试形成一个 MDX 查询，使其仅返回度量满足特定条件的两个维度的组合。我认为使用 FILTER 功能会非常简单，即

```
SELECT
    NON EMPTY FILTER({[Program].[ByRegion].[Program] * [Performance Metric].[Metric].CHILDREN }, [Measures].[Point Percentage] < .95) ON ROWS,
    NON EMPTY ( HIERARCHIZE([Calendar Period].[Y-Q-M].[Month of Quarter].&[3]&[1]&[2009]) , [Measures].[Point Percentage] )ON COLUMNS
FROM [QEP Revenue] 
```

然而，在运行查询之后，很容易看出我有一个错误，因为第一个结果的点百分比为 1.5172，显然超过了 0.95。

如果我完全删除过滤器：

```
SELECT
    --NON EMPTY FILTER({[Program].[ByRegion].[Program] * [Performance Metric].[Metric].CHILDREN }, [Measures].[Point Percentage] < .95) ON ROWS,
    NON EMPTY ({[Program].[ByRegion].[Program] * [Performance Metric].[Metric].CHILDREN }) ON ROWS,
    NON EMPTY ( HIERARCHIZE([Calendar Period].[Y-Q-M].[Month of Quarter].&[3]&[1]&[2009]) , [Measures].[Point Percentage] )ON COLUMNS
FROM [QEP Revenue] 
```

我得到了一个类似的结果集，包括高于 0.95 的值。我是否完全错过了过滤器的要点，或者尝试一次过滤两个维度是否存在问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T08:24:20.090

我没有您的数据源，但此 MDX 可用于 AS2000 示例多维数据集 Foodmart（销售多维数据集）。

```
SELECT 
  NON EMPTY 
    {{[Time].[Quarter].MEMBERS}} ON COLUMNS
 ,NON EMPTY 
    Filter
    (
      CrossJoin
      (
        {[Customers].[State Province].&[CA]}
       ,[Promotions].[All Promotions].Children
      )
     ,
        (
          [Customers].[State Province].&[CA]
         ,[Time].&[1997].&[Q1]
         ,[Measures].[Unit Sales]
        )
      > 300
    ) ON ROWS
FROM [Sales]
WHERE 
  [Measures].[Unit Sales]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T18:39:25.277

我把它弄裂了。

过滤器已正确应用于“计划”和“绩效指标”维度。问题是过滤器是与日历期间维度分开应用的。因此，允许显示出现的 1.5172 的点百分比，因为在另一个月份有一个点百分比满足过滤器要求。

我能够这样重写查询以获得所需的结果：

```
SELECT 
  NON EMPTY 
    Filter
    (
      {
          [Program].[ByRegion].[Program]*
          [Performance Metric].[Metric].Children*
          [Calendar Period].[Y-Q-M].[Month of Quarter].&[3]&[1]&[2009]
      }
     ,
      [Measures].[Point Percentage] < 0.95
    ) ON ROWS
 ,NON EMPTY 
    [Measures].[Point Percentage] ON COLUMNS
FROM [QEP Revenue]; 
```

幸运的是，此查询正在报告服务中使用，因此将日历周期移动到 ROWS 中是合适的。但是，如果我想将日历周期保留在列中，我不知道如何解决这个问题，因为不能在两个轴上使用相同的维度。

# c# - 如何根据其内容调整 Silverlight 应用程序的大小？

> ID：865139
> 
> 赞同：0
> 
> 时间：2009-05-14T19:09:07.530
> 
> 标签：c#, silverlight

我有一个简单的应用程序，我想在加载内容时更改其大小。

例如，假设我加载大小为 100 的图像。

如何更改渲染 silverlight 的容器的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T19:10:55.810

解决方案 -

您需要通过浏览器对象，而不是浏览页面。

这是[我找到的解决方案：](http://www.jeff.wilcox.name/2008/08/quickzeropixel/)

```
width = 200;
height = 200;

var host = HtmlPage.Document.HtmlPage.Plugin.Id);
host.SetStyleAttribute("width", width.ToString());
host.SetStyleAttribute("height", height.ToString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T21:51:17.470

调整容器大小后，您会收到通知：

```
 public Page()
    {
        InitializeComponent();

        App.Current.Host.Content.Resized += (s, e) =>
        {

            // Place here your layour resize code...
            this.Width = App.Current.Host.Content.ActualWidth;
            this.Height = App.Current.Host.Content.ActualHeight;

        };

    } 
```

# datagridview - 用 subsonic & vb.net 填充 datagridview 组合框列

> ID：865141
> 
> 赞同：0
> 
> 时间：2009-05-14T19:09:33.427
> 
> 标签：datagridview, subsonic, datagridviewcombobox

就像标题说的那样，我正在尝试在 datagridview 中填充组合框列。

这是我到目前为止所拥有的：

```
Dim lc As System.Web.UI.WebControls.ListItemCollection = _
    DataAccess.Part.GetListItems()

dgvcboPart.DataSource = lc

' This is a standalone combo box and it works ok
cboTest.DataSource = lc 
```

关于我缺少什么的任何建议？

谢谢托尼·W

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T19:14:51.120

```
dgvcboPart.DataSource = lc
dgvcboPart.DataBind() 
```

必须调用 databind 方法才能发生魔法！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T11:43:38.150

我首先建议您将您的 Collection 绑定到 BindingSource，然后将 BindingSource 添加到 DataGridView（这样您就知道位置）

但是绑定 ComboBoxCell 应该非常简单。

假设您有一个包含两列 Id 和 Name 的 DataTable tblCurrency。您必须将此绑定到您的列（我假设第 0 列是您的 DataGridViewColumn）

```
 dgvcboPart.Columns(0).DataSource = tblCurrency
     dgvcboPart.Columns(0).ValueMember = "Id"
     dgvcboPart.Columns(0).DisplayMember = "Name" 
```

然后，您可以将 DataPropertyName 设置为 DataSource 中的属性。

```
 dgvcboPart.Columns(0).DataPropertyName = "Currency_Id" 
```

小心，tblCurrency.Id 和 Currency_Id 必须是相同的类型（Int32 和 UInt32 不起作用）如果 Currency_Id 的值不在 tblCurrency 中，你会得到一个带有完整 StackTrace 的讨厌的 MessageBox（所以你应该处理 DataError事件）

# validation - 单一责任原则对验证意味着什么

> ID：865144
> 
> 赞同：7
> 
> 时间：2009-05-14T19:10:01.663
> 
> 标签：validation, single-responsibility-principle

单一责任原则是否意味着您的验证规则应该在实体外部？

如果是这样，您是否每个验证规则使用一个类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T19:25:29.863

我通常会将此解释为意味着“实体”和实体的验证应该是单独的关注点。我通常会使用一个可以验证整个实体的类，但我认为没有理由通过不让该类使用其他类来限制其实现。但是我不会仅仅因为实体具有多个属性而将实体的验证拆分为多个类；我将验证者的职责定义为“验证实体 X”。有时单一职责归结为以一种巧妙的方式定义职责，这实际上是关于*你*制定规则。

有时您可能会遇到具有多个有效状态的实体，这些状态可能处于流程的不同阶段；一个订单可能有不同阶段的不同验证者，但我认为这对每个验证者来说是不同的责任。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T19:12:36.930

取决于您对*entity*的定义。例如，您可以验证每个服务层中的输入，但此验证可能由单独的类处理。

# .net - 保存时 Visual Studio 自动复制文件

> ID：865148
> 
> 赞同：4
> 
> 时间：2009-05-14T19:10:58.213
> 
> 标签：.net, visual-studio, visual-studio-2008

有没有办法让 Visual Studio 自动将我保存在项目中的文件复制到另一个位置？我不是在寻找源代码控制功能，更像是“自动部署”。我在本地机器上工作，但我希望每次编辑文件时自动将文件扔到我的开发箱中。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T19:14:28.530

将其设置为构建后事件。

右键单击您的项目 -> 属性 -> 构建事件（选项卡）

然后在构建后事件中输入您希望在构建完成后执行的命令。您可以放入批处理文件中的任何内容都可以放入此文本框中。

[MSDN Post Build Events 文档和方案](http://msdn.microsoft.com/en-us/library/ke5z92ks.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:39:59.323

听起来您不是在寻找构建后的过程，因为您希望每次保存（每次触摸文件时）都触发此过程。

由于您使用的是 Visual Studio，因此您使用的是 Windows，这不是我强大的基础。这是我可能会尝试的东西，我相信你可以找到 Windows 的等效项。

1.  使用 rsync 进行实际更新。您可以通过 ftp、ssh 或直接文件复制进行连接（您没有提到您将如何连接到另一个盒子）。

2.  安排 rsync 命令每 n 分钟运行一次。

一个快速的谷歌搜索会找到适用于 Windows 的 rsync 替代品和包装器，但我没有足够的知识来推荐一个。至于调度，有 Windows Scheduler 和 Windows 上的 at。

是的，这不是“按需”执行的，但它不是资源占用，如果您愿意，您甚至可以每分钟运行一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-19T07:21:23.790

您可以使用[FileSystemWatcher 类](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher%28v=vs.110%29.aspx)自动监视更改的文件并复制它们。

您只需在示例中添加几行即可使其以这种方式工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T19:13:13.357

您可以使用构建后事件来复制文件（这需要您先编译解决方案，不确定这是否对您来说是个问题）..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T19:56:37.823

您可以在您的开发盒上使用 Cruise Control .net，但您确实需要对此进行源代码控制。签入应用程序后，巡航控制将监视更改并在您的开发盒上执行构建。您可能需要配置 MSBuild 以复制输出文件或启动/停止服务等。

关于构建事件等，您可以考虑以下内容。

MSBUILD nANT RAKE（这是我现在正在使用的。）

# java - Spring-如何使用 Spring 依赖注入来编写独立的 Java 应用程序

> ID：865149
> 
> 赞同：10
> 
> 时间：2009-05-14T19:11:12.173
> 
> 标签：java, dependency-injection, inversion-of-control, spring

我想用 IOC 编写一个独立的应用程序，如何在其中使用 springs 依赖注入？我正在使用 Jidea。有 spring 2.5 支持，但我想使用 spring 3.0，这是我尝试过的方式！

> 我有使用 Spring MVC 的经验，我们可以在 WebApplicationContext 中注入依赖项，但是如何在独立应用程序中注入依赖项

我试过这个

> `ApplicationContext context = new ClassPathXmlApplicationContext(new String[] {"com\\ttg\\xmlfile.xml"});`

但我看不到依赖项是由那里定义的 bean 注入的（在 XML 文件中）我将上面的代码放在 main 方法和两个对象的两个 bean 定义中，在一个 Java 类的构造函数中我使用了另一个类的对象-被注入到这个对象 - 并调用了一个方法来打印一些东西但它没有工作我认为上面的代码创建了所有依赖项并注入它们但它看起来不像那样

> 如何在不包含 WebApplicationContext 的独立应用程序中正确使用 Springs IOC、依赖注入？

请提及步骤。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-14T22:44:08.403

假设你有：

```
class Bean1 {
  Bean2 bean2;
}

class Bean2 {
  String data;
} 
```

context.xml 文件

```
<bean id="bean1" class="Bean1">
  <property name="bean2" ref="bean2" />
</bean>

<bean id="bean2" class="Bean2" /> 
```

那么这应该是真的

```
ApplicationContext context = new ClassPathXmlApplicationContext(new String[] {"context.xml"});
Bean1 bean1 = (Bean1) context.getBean("bean1");

// bean1.bean2 should not be null here. 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-20T06:49:48.880

您可以使用 spring 提供的自动装配支持，以便将依赖项（并可能应用后处理器）注入不属于应用程序上下文的对象。

在您的情况下，此对象是您的独立应用程序。

这是实现这一目标的方法。在此示例中，我使用 @Autowired（用于 b1）、传统 DI（用于 b2）和用于 b3 的初始化挂钩。带有注释的自动装配支持假定您已经在应用程序上下文中定义了适当的弹簧后处理器（例如，通过声明`<context:annotation-config/>`）。

```
public class StandaloneApp implements InitializingBean {
  @Autowired private Bean1 b1;
  private Bean2 b2;
  private Bean3 b3;

  public void afterPropertiesSet() throws Exception {
    this.b3 = new Bean3(b1, b2);
  }

  public void setB2(Bean2 b2) {
    this.b2 = b2;
  }

  public static void main(String... args) {
    String[] locations = // your files relative to the classpath
    ApplicationContext ac = new ClasspathXmlApplicationContext(locations);
    // or use FileSystemXmlApplicationContext if the files are not in the classpath

    StandaloneApp app = new StandaloneApp();
    AutowireCapableBeanFactory acbf = ac.getAutowireCapableBeanFactory();
    acbf.autowireBeanProperties(app, AUTOWIRE_BY_NAME, false);
    acbf.initializeBean(app, "standaloneApp"); // any name will work
  }
} 
```

在此示例中，所有 b1、b2 和 b3 都应为非空（假设 b1 和 b2 bean 存在于您的应用程序上下文中）。

我还没有测试过它（由于一些拼写错误甚至可能无法编译），但这个想法在最后 3 行。请参阅 javadocs`AutowireCapableBeanFactory`和提及的方法，以了解究竟发生了什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T18:40:28.970

如果您更喜欢（主要）纯 java，则可以使用 java config：

```
@Configuration
pubic class MyConfig {

   @Bean
   public Bean1 bean1() { return new Bean1(); }

   @Bean
   public Bean2 bean2() { return new Bean2(bean1()); }
} 
```

然后实例化：

```
ApplicationContext ctx = 
    new AnnotationConfigApplicationContext(MyConfig.class); 
```

请记住，纯注解驱动的配置尚不支持某些东西（例如 tx:annotation-driven 之类的东西），您可能需要一些 xml 胶水代码。

```
<beans>
  <tx:annotation-driven />
  <context:annotation-config/>
  <bean class="MyConfig"/>
</beans> 
```

然后使用基于标准 xml 的方式创建 ApplicationContext（如 ClasspathXmlApplicationContext，或 spring web 上下文加载器等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T19:25:23.263

你打电话`context.getBean("beanName")`是为了获得对 bean 的引用还是你在做一个`new SomeClass()`？如果你这样做了，`getBean()`那么应该设置注入的属性。

此外，请务必使用相同的 bean 工厂（ClassPathXmlApplicationContext 实例）来检索所有 bean。这很可能是 static final 并由整个应用程序使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T20:30:00.923

你是如何确认你的豆子没有正确接线的？一个常见问题是 xml 配置文件不在正确的位置。你能给我们一些更多的信息，比如你的项目布局和你用来从容器中获取 bean 的代码吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T23:37:10.617

如果您将 log4j 日志记录添加到您的应用程序中，您应该会看到一系列消息，这些消息会告诉您很多关于 Spring 在做什么和没有做什么的信息。如果你没有那个反馈，你就在黑暗中。您也许可以通过从 log4j 获取更多 Spring 信息来找出答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-13T16:45:49.650

你可以使用命令@Autowired

# c++ - 如何在 C++ 中按名称获取进程句柄？

> ID：865152
> 
> 赞同：66
> 
> 时间：2009-05-14T19:12:29.427
> 
> 标签：c++, winapi, process

我正在尝试获取 example.exe 的进程句柄，以便调用`TerminateProcess`它。我怎样才能做到这一点？请注意，它没有窗口，因此`FindWindow`无法使用。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-05-14T19:26:01.250

```
#include <cstdio>
#include <windows.h>
#include <tlhelp32.h>

int main( int, char *[] )
{
    PROCESSENTRY32 entry;
    entry.dwSize = sizeof(PROCESSENTRY32);

    HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);

    if (Process32First(snapshot, &entry) == TRUE)
    {
        while (Process32Next(snapshot, &entry) == TRUE)
        {
            if (stricmp(entry.szExeFile, "target.exe") == 0)
            {  
                HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, entry.th32ProcessID);

                // Do stuff..

                CloseHandle(hProcess);
            }
        }
    }

    CloseHandle(snapshot);

    return 0;
} 
```

另外，如果你想在 OpenProcess 中使用 PROCESS_ALL_ACCESS，你可以试试这个：

```
#include <cstdio>
#include <windows.h>
#include <tlhelp32.h>

void EnableDebugPriv()
{
    HANDLE hToken;
    LUID luid;
    TOKEN_PRIVILEGES tkp;

    OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &hToken);

    LookupPrivilegeValue(NULL, SE_DEBUG_NAME, &luid);

    tkp.PrivilegeCount = 1;
    tkp.Privileges[0].Luid = luid;
    tkp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;

    AdjustTokenPrivileges(hToken, false, &tkp, sizeof(tkp), NULL, NULL);

    CloseHandle(hToken); 
}

int main( int, char *[] )
{
    EnableDebugPriv();

    PROCESSENTRY32 entry;
    entry.dwSize = sizeof(PROCESSENTRY32);

    HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);

    if (Process32First(snapshot, &entry) == TRUE)
    {
        while (Process32Next(snapshot, &entry) == TRUE)
        {
            if (stricmp(entry.szExeFile, "target.exe") == 0)
            {  
                HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, entry.th32ProcessID);

                // Do stuff..

                CloseHandle(hProcess);
            }
        }
    }

    CloseHandle(snapshot);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-14T19:27:46.237

以下代码显示了如何使用 toolhelp 和 OpenProcess 来获取进程的句柄。为简洁起见，删除了错误处理。

```
HANDLE GetProcessByName(PCSTR name)
{
    DWORD pid = 0;

    // Create toolhelp snapshot.
    HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
    PROCESSENTRY32 process;
    ZeroMemory(&process, sizeof(process));
    process.dwSize = sizeof(process);

    // Walkthrough all processes.
    if (Process32First(snapshot, &process))
    {
        do
        {
            // Compare process.szExeFile based on format of name, i.e., trim file path
            // trim .exe if necessary, etc.
            if (string(process.szExeFile) == string(name))
            {
               pid = process.th32ProcessID;
               break;
            }
        } while (Process32Next(snapshot, &process));
    }

    CloseHandle(snapshot);

    if (pid != 0)
    {
         return OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);
    }

    // Not found

       return NULL;
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-14T19:23:01.087

有两种基本技术。第一个使用PSAPI；MSDN 有[一个](http://msdn.microsoft.com/en-us/library/ms682623.aspx)使用[`EnumProcesses`](http://msdn.microsoft.com/en-us/library/ms682629.aspx)、[`OpenProcess`](http://msdn.microsoft.com/en-us/library/ms684320.aspx)、[`EnumProcessModules`](http://msdn.microsoft.com/en-us/library/ms682631.aspx)和的示例[`GetModuleBaseName`](http://msdn.microsoft.com/en-us/library/ms683196.aspx)。

另一个使用我更喜欢的 Toolhelp。用于获取进程列表的快照，使用and[`CreateToolhelp32Snapshot`](http://msdn.microsoft.com/en-us/library/ms682489.aspx)遍历它，它提供模块名称和进程 ID，直到找到所需的，然后调用以获取句柄。[`Process32First`](http://msdn.microsoft.com/en-us/library/ms684834.aspx)[`Process32Next`](http://msdn.microsoft.com/en-us/library/ms684836.aspx)[`OpenProcess`](http://msdn.microsoft.com/en-us/library/ms684320.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-03-06T18:43:18.067

可以使用以下代码：

```
DWORD FindProcessId(const std::wstring& processName)
{
    PROCESSENTRY32 processInfo;
    processInfo.dwSize = sizeof(processInfo);

    HANDLE processesSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);
    if (processesSnapshot == INVALID_HANDLE_VALUE) {
        return 0;
    }

    Process32First(processesSnapshot, &processInfo);
    if (!processName.compare(processInfo.szExeFile))
    {
        CloseHandle(processesSnapshot);
        return processInfo.th32ProcessID;
    }

    while (Process32Next(processesSnapshot, &processInfo))
    {
        if (!processName.compare(processInfo.szExeFile))
        {
            CloseHandle(processesSnapshot);
            return processInfo.th32ProcessID;
        }
    }

    CloseHandle(processesSnapshot);
    return 0;
} 
```

用法：

```
auto processId = FindProcessId(L"blabla.exe"); 
```

得到一个句柄应该是显而易见的，只需调用[`OpenProcess()`](https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openprocess)或类似的就可以了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T19:15:19.450

查看：[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms682489(VS.85).aspx)

您可以使用`GetModuleName`（我认为？）来获取名称并对其进行检查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T19:18:30.660

[OpenProcess](http://msdn.microsoft.com/en-us/library/ms684320.aspx)函数

来自 MSDN：

要打开另一个本地进程的句柄并获得完全访问权限，您必须启用 SeDebugPrivilege 权限。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-22T18:50:42.650

如果您不介意使用`system()`，那么做`system("taskkill /f /im process.exe")`起来会比这些其他方法容易得多。

# sql-server - 在 SQL Server 2005 中更改数据库图的所有者

> ID：865162
> 
> 赞同：13
> 
> 时间：2009-05-14T19:14:25.537
> 
> 标签：sql-server, sql-server-2005

我需要更改 SQL Server 2005 中数据库图表的所有者。目前它归我所有（域\用户名.diagramName），我想将其更改为由 dbo 拥有（dbo.diagramName）。我以为我可以使用 sp_changeobjectowner，但我相信这仅适用于表、存储过程等......我认为这很容易，我只是无法通过谷歌搜索找到任何东西。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-19T12:44:54.183

最后，我不得不删除该用户架构，然后运行以下更新...

```
-- to identify the diagram id, name, & owner

select *
from dbo.sysdiagrams

-- to manually change the owner of a diagram
-- note: i derived that the principal_id =1 for dbo from above query

update 
dbo.sysdiagrams set principal_id =1 where diagram_id = 1 
```

我最终从校园里的 DBA 那里得到了我需要的帮助。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-27T15:21:38.283

```
UPDATE dbo.sysdiagrams 
SET principal_id = 1 
```

如果需要，设置 WHERE 子句。上面的文字建议您需要从数据库中删除用户，但我不必这样做。我正在使用 SQL2008 R2。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-15T01:58:10.360

```
USE [db_name]
UPDATE dbo.sysdiagrams 
SET principal_id = 1 
```

如果上述语句不起作用，您可以通过右键单击 dbo.sysdiagrams 并选择编辑前 200 行来对此表进行编辑，然后您可以将所有记录的 principal_id 列手动设置为 1

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T19:37:32.767

这篇文章指出，您必须将自己删除为 db 的用户。与您选择的用户一起打开它。

[http://msdn.microsoft.com/en-us/library/ms171972(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms171972(VS.80).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T10:28:00.207

尽管在这种情况下它没有帮助（因为它只是重新创建了整`sysdiagrams`行），但这些脚本

[ScriptDiagram2005](http://conceptdevelopment.net/Database/ScriptDiagram2005/)或[ScriptDiagram2008](http://conceptdevelopment.net/Database/ScriptDiagram2008/)

允许您创建图表“内容”的*插入脚本*，以针对源数据库（或备份、脚本副本或其他）重新运行。您也可以轻松地（知道您现在所知道的`principal_id`）重新创建具有新所有者的图表。

只需在脚本中找到并编辑此语句的其余部分

```
INSERT INTO sysdiagrams ([name], [principal_id], [version], [definition]) 
```

真正的好处是能够对文本文件进行源代码控制/备份......

# html - 将 HTML 编码从 UTF-8 切换到 UTF-16 会出现什么问题？

> ID：865168
> 
> 赞同：6
> 
> 时间：2009-05-14T19:15:22.290
> 
> 标签：html, encoding, utf-8, utf-16

从 UTF-8 更改为 UTF-16 对 HTML 编码有何影响？我想知道你对这个问题的看法。在做出这样的改变之前，我需要考虑一些事情吗？

注意：由于我需要处理大量的日文和中文文本而感兴趣。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T19:29:08.840

我能想到一些会出错的事情：

1.  您必须在 HTTP 标头中指定它是 UTF-16。与 UTF-8 不同，UTF-16**不**兼容 ASCII，这意味着一切都需要从一开始就使用 UTF-16。
2.  旧客户端不支持 UTF-16。例如，Windows 9x 上的任何内容。可能还有 Mac OS9。
3.  哦，等等，我差点忘了：Windows XP 的北美和欧洲版本默认没有安装亚洲字体。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-14T19:19:44.370

*   假设您的大部分 HTML 是 ASCII，您的带宽消耗可能会增加近一倍
*   错误地假定 UTF-8（或 ASCII）的客户会感到困惑

为什么*要*改成UTF-16？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T19:28:23.397

字节顺序也成为 8 位以上数据的问题。UTF 编码文件以字节顺序标记开始，该标记用于确定该文件的字节顺序或字节序。

[维基百科对此有很好的解释。](http://en.wikipedia.org/wiki/Byte-order_mark)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-26T22:26:53.040

据我所知，所有现代浏览器都支持 UTF-16 编码。但正如其他人指出的那样，您应该明确声明编码。并非所有浏览器和平台都支持所有 unicode 字符，但我认为这与您使用的编码无关。

但是，如果带宽是一个大问题，您可能应该考虑对 HTML 进行 gzip 压缩。这将比切换编码节省更多的带宽。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-12-06T10:40:51.840

你在这里举行的非常好的文章。Fundamentals 指出，“当需要唯一的字符编码时，字符编码必须是 UTF-8、UTF-16 或 UTF-32。US-ASCII 向上兼容 UTF-8（US-ASCII 字符串也是 UTF -8 字符串，参见 [RFC 3629]），因此如果需要与 US-ASCII 兼容，则 UTF-8 是合适的。” 在实践中，与 US-ASCII 的兼容性非常有用，几乎是一项要求。W3C 明智地解释说，“在其他情况下，例如对于 API，UTF-16 或 UTF-32 可能更合适。选择其中之一的可能原因包括内部处理的效率和与其他进程的互操作性。”

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2009-05-14T19:27:28.250

我怀疑大多数浏览器甚至不会显示您的页面。

# iphone - 如何将图像作为导航栏标题

> ID：865176
> 
> 赞同：57
> 
> 时间：2009-05-14T19:18:40.517
> 
> 标签：iphone

我想在导航栏的中间放置一个 .png 图像，而不是用文本写的标题。你能告诉我怎么做吗？

谢谢。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2009-05-14T20:18:52.230

设置navigationItem的titleView

```
UIImage *image = [UIImage imageNamed:@"image.png"];
self.navigationItem.titleView = [[UIImageView alloc] initWithImage:image]; 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2015-07-13T13:29:01.533

**Swift 4.2**
包括建议的框架/缩放

```
let image: UIImage = UIImage(named: "image.png")!
let imageView = UIImageView(frame: CGRect(x: 0, y: 0, width: 40, height: 40))
imageView.contentMode = .scaleAspectFit
imageView.image = image
self.navigationItem.titleView = imageView 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-14T20:13:53.880

您可以更改 UINavigationBar 中的所有视图。如果您尝试更改导航控制器中的导航栏，请执行以下操作：

```
self.navigationItem.titleView = [[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"image.png"] autorelease]; 
```

如果您自己创建导航栏，请执行相同操作，但不要调用`self.navigationItem`调用：`navigationBar.topItem`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-02-05T02:01:22.987

如果有人在 Swift 4.2 的导航栏标题视图中需要图像和文本，请尝试此功能：-

```
override func viewDidLoad() {

    super.viewDidLoad()

    //Sets the navigation title with text and image
    self.navigationItem.titleView = navTitleWithImageAndText(titleText: "Dean Stanley", imageName: "online")
}

func navTitleWithImageAndText(titleText: String, imageName: String) -> UIView {

    // Creates a new UIView
    let titleView = UIView()

    // Creates a new text label
    let label = UILabel()
    label.text = titleText
    label.sizeToFit()
    label.center = titleView.center
    label.textAlignment = NSTextAlignment.center

    // Creates the image view
    let image = UIImageView()
    image.image = UIImage(named: imageName)

    // Maintains the image's aspect ratio:
    let imageAspect = image.image!.size.width / image.image!.size.height

    // Sets the image frame so that it's immediately before the text:
    let imageX = label.frame.origin.x - label.frame.size.height * imageAspect
    let imageY = label.frame.origin.y

    let imageWidth = label.frame.size.height * imageAspect
    let imageHeight = label.frame.size.height

    image.frame = CGRect(x: imageX, y: imageY, width: imageWidth, height: imageHeight)

    image.contentMode = UIView.ContentMode.scaleAspectFit

    // Adds both the label and image view to the titleView
    titleView.addSubview(label)
    titleView.addSubview(image)

    // Sets the titleView frame to fit within the UINavigation Title
    titleView.sizeToFit()

    return titleView

} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/QgUWb.png)](https://i.stack.imgur.com/QgUWb.png)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-04-05T16:31:57.880

使用 Swift 2.x 更新

```
navigationItem.titleView = UIImageView.init(image: UIImage(named:"yourImageName")) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-09-18T15:06:03.130

斯威夫特 5 版本：

```
navigationItem.titleView = UIImageView(image: UIImage(named: "logo.png")) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-10T17:40:29.433

在寻找这个问题的答案时，我在[Apple Discussions forum](http://discussions.apple.com/thread.jspa?messageID=7951074)`-(void)drawRect:(CGRect)rect`中找到了一个不错且简单的解决方案，覆盖`UINavigationBar`：

```
@implementation UINavigationBar (CustomImage)
- (void)drawRect:(CGRect)rect {
    UIImage *image = [UIImage imageNamed: @"NavigationBar.png"];
    [image drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
}
@end 
```

# c# - 监控子流程/我可以获得流程组的 TotalProcessorTime 吗？

> ID：865180
> 
> 赞同：0
> 
> 时间：2009-05-14T19:19:58.470
> 
> 标签：c#, windows, process, worker-processes

有没有办法让**Process.TotalProcessorTime**反映一个*进程*以及它产生的任何进程？

或者，我如何验证进程（或其后代）是否仍在“积极”运行？

* * *

我的应用程序正在生成一个外部进程并等待它退出。使用样本数据需要 5-20*分钟*才能完成；我没有猜测合理的最大超时时间。所以我的应用程序会每隔一段时间检查另一个进程的**Process.TotalProcessorTime**值，以确保它不断上升。

这很好用，但我发现该进程只是一个“包装器”，它产生一个子进程，而子进程又会产生一些消耗所有 CPU 时间的其他子进程。

而且我发现**TotalProcessorTime**在 CPU 利用率达到 100% 的几分钟后只返回一小部分时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T23:21:34.817

您可以使用性能计数器来检索父进程，如下所示：

```
PerformanceCounter pc = new PerformanceCounter("Process", 
    "Creating Process Id", " windbg");
Process p = Process.GetProcessById((int)pc.RawValue); 
```

有了这些信息，您就可以监控系统中的进程，维护整个进程树的结构并计算树的 TotalProcessorTime。希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-13T16:54:27.340

我还没有实现这个，但已经弄清楚它是如何工作的。这很乏味，但并不是那么复杂。

1.  每隔几秒生成一个后台线程：

    *   构建流程树（有关代码的简化版本，请参见此[答案），](https://stackoverflow.com/questions/1138625/how-to-terminate-all-grandchild-processes-using-c-on-wxp-and-newer-mswindows/1138950#1138950)
    *   如果进程已退出，则终止（监视线程）。
    *   按 PID 维护累积的 CPU 使用率的哈希值，
    *   保持所有进程的所有值的总和，
    *   保持与上次线程触发时总和的差值。
2.  这应该允许调用代码轻松检查进程（树）是否未挂起（*I/O 绑定进程在这里可能有问题，但这不适用于我的情况*）。

这一切似乎都不难，除了让监控线程没有（直接）产生的进程的 CPU 使用率可能例外。

如果/当我实现代码时，我会更新这个答案，但这可能需要很长时间。

# javascript - 滑块条/引脚算法

> ID：865183
> 
> 赞同：1
> 
> 时间：2009-05-14T19:20:38.017
> 
> 标签：javascript, algorithm

我有一个带有 x 个条形的滑块，每个条形代表一个值范围。每个条形图都有一个上下手柄，用于操纵范围。杆可以相互连接，因此，一些把手会影响两个杆（即把手在两个杆的中间），其中，它们的运动会影响其他杆在链条上的运动。条可以具有最大宽度，并且它们仍然可以在保持最大宽度的同时被推/拉。我的问题是，是否有记录的算法来验证用户尝试将句柄移动到值 V 的移动，而这又会推动或拉动链中的所有连接条？

这有点难以解释，所以希望这是有道理的。我不是在寻找一个实际的解决方案，只是一些可能帮助我找到解决方案的算法（即这类问题的神奇谷歌搜索词）。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T19:49:41.490

听起来您正在处理约束编程的特殊情况。我认为您可以将滑块建模为一系列约束，即：

滑块 1 范围：(a,b) 其中 a >= MIN, b <= MAX
滑块2 范围：(c,d) 其中 c > a + x, d <= MAX
...

当用户移动滑块 2 的底部范围时，x 在哪里改变？

当用户移动滑块时，仅评估所有受影响的方程需要时间与约束数量呈线性关系，这还不错。我不确定你能不能做得更好。

# ruby - 具有多个选项卡的 Excel 文件

> ID：865186
> 
> 赞同：1
> 
> 时间：2009-05-14T19:21:45.783
> 
> 标签：ruby, excel, tabs

我需要创建一个带有多个选项卡的 excel 文件。我需要在 Ruby on Rails 中执行此操作。我已经检查了 Apache POI，但我不确定它是否提供了该功能。有谁知道它是否可以，或者是否有其他替代方法可以做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T19:33:07.287

如果我理解正确 - 多个选项卡是指工作簿中的多个“工作表”。Apache POI 确实提供了这个功能（查看下面的链接）。请注意，我不是 Ruby 人（至少还不是），这些链接用于 Java 中的用法，但我很确定 YAJB 之类的桥梁将帮助您完成它：

[创建新工作簿](http://poi.apache.org/spreadsheet/quick-guide.html#NewWorkbook)
[创建新工作表](http://poi.apache.org/spreadsheet/quick-guide.html#NewSheet)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T19:34:03.913

我想通了，如果您使用的是 Apache POI，您可以在 Workbook 实例上调用 createSheet()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-11T13:39:32.420

我使用 ruby​​ gem“电子表格-excel”来实现这种功能

```
#!/usr/bin/env ruby
RAILS_ENV = 'production'

require File.dirname(__FILE__) + '/../config/environment'
require "spreadsheet/excel" 

file = "name_of_your_excel_file.xls" 
workbook = Spreadsheet::Excel.new("#{RAILS_ROOT}/#{file}")

# First Sheet
worksheet = workbook.add_worksheet("Sheet No. 1")
worksheet.write(0, 0, "Timestamp")
worksheet.write(0, 1, "Type")
worksheet.write(0, 2, "Text")
# ...and whatever you want to do here
# Second Sheet
worksheet_2 = workbook.add_worksheet("Sheet No. 2")
#... and so on 
```

这在 Ruby 和 Ruby-on-Rails 中都非常有效。

要安装电子表格/excel，只需键入

```
ruby gem install "spreadsheet-excel" 
```

希望这可以帮到你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-13T09:28:55.553

使用电子表格 gem 的多个选项卡 Excel 表

要在单个 excel 工作表中创建多个工作表，最好使用电子表格 gem。在您的控制器中（假设卡是您的控制器）添加以下内容：

默认导出

```
book = Spreadsheet::Workbook.new
sheet1 = book.create_worksheet :name => 'Sheet1'
sheet2 = book.create_worksheet :name => 'Sheet2'

 sheet1.row(0).push "some content in Column1" //to push content in 1st row 1st column of 1st spreadsheet

 //keep pushing on row(0) if you want to push contents other columns of 1st row

  spreadsheet = StringIO.new
  book.write spreadsheet
  file = "Excelsheet"
  send_data spreadsheet.string, :filename => "#{file}", :type =>  "application/vnd.ms-excel" 
```

结尾

在您查看 <%=link_to("Export Database to Excel", cards_url + "/export") %>**强文本**

# language-agnostic - 以编程方式操作多轨 ogg 文件

> ID：865188
> 
> 赞同：2
> 
> 时间：2009-05-14T19:21:55.330
> 
> 标签：language-agnostic, audio, ogg

我计划创建一个用于操作多轨 OGG 文件的程序，但我对相关库没有任何经验，因此我正在寻找有关为此使用哪种语言/库的建议。我对这门语言没有任何偏好，我会很乐意用 C、C#、Python 来编写它，只要让事情变得最简单（甚至可能）。也许它甚至有可能以某种方式自动化 Audacity？

在要求方面，我并不是在寻找特别花哨的东西。它可能是一个命令行程序，我不需要能够播放音频，绘制波形的图像表示等。该程序基本上用作转换器，但我需要先做一些处理输出。也就是说，我需要能够以编程方式删除一些轨道、设置每个轨道的平移、更改轨道音量等。没什么太复杂的，只是一些基本的处理，然后以 MP3 或易于转换为 MP3 的格式输出结果，比如WAV。

任何建议或一般信息将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-10T02:19:58.860

[SoX](http://sox.sourceforge.net/)可以做很多这样的事情，只需使用命令行脚本。

我用 Python + [Audiolab](http://cournape.github.com/audiolab/)做了更复杂的音频处理：

```
from audiolab import oggread, wavwrite

# Read in a file
data, fs, enc = oggread('test.ogg')

# Keep just the first two channels
newdata = data[:,0:2]

# Reduce by -6 dB
newdata *= 0.5

# Write to a new file
wavwrite(data, 'filename.wav', fs, enc) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T04:41:38.407

试试 BASS 库。它位于[http://www.un4seen.com/bass.html](http://www.un4seen.com/bass.html)，它可以播放 ogg/wav/mp3 和其他一大堆格式。然后您可以转换/加入并执行 DSP，例如 Compressor/EQ/etc。

# jquery - jquery替换和更新内容

> ID：865202
> 
> 赞同：2
> 
> 时间：2009-05-14T19:26:37.317
> 
> 标签：jquery

我正在从托管代码调用 javascript，并希望显示时间（从托管代码传递），

我有一个功能，例如：

```
function sometimefunction(sometime) {

    $(document).ready(function() {
        $('#currenttime').before($('<div class="timeupdate"></div>').html('<h3>Last update: ' + sometime+ '</h3')).remove();          
    })
} 
```

现在，这将替换时间，但仅在第一次调用时..我想要发生的是每次调用此函数时都替换时间...（顺便说一句。这是一个计时器，每秒来自托管代码）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T19:32:07.303

我认为您遇到问题的原因是因为您的函数只是订阅了文档加载事件。

如果您删除 document.ready 电话，您应该没问题：

```
function sometimefunction(sometime) {
    $('#currenttime').before($('<div class="timeupdate"></div>').html('<h3>Last update: ' + sometime+ '</h3')).remove();
} 
```

此外，您也许可以改用 jquery [replaceWith](http://docs.jquery.com/Manipulation/replaceWith)函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T19:53:00.093

添加更新后，您将立即删除它。我没有得到你的 HTML 结构，但这里有：

```
var someTimeFunc = function(sometime){
    $('#currenttime').innerHTML('<h3>'+ sometime +'</h3>')
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T19:33:54.787

document.Ready 事件仅在所有 DOM 内容加载完毕后由浏览器调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:24:43.823

代码每次`$('#currenttime').before(...).remove()`都会从页面中删除。`#currenttime`这正是你要求它做的......

所以：

```
<div id="currenttime"></div> 
```

变成：

```
<div class="timeupdate"><h3>Last update: 00/00/00 00:00:00<div> 
```

当您可能需要在页面上结束的是带有 timeupdate 类的 div 时，它还具有您的代码正在寻找的 ID：

```
<div id="currenttime" class="timeupdate"><h3>Last update: 00/00/00 00:00:00</h3><div> 
```

看看这如何解决您的问题？到达那里的最简单方法是从页面上的以下代码开始：

```
<div id="currenttime" class="timeupdate"></div> 
```

只需使用该`html()`功能直接替换内容：

```
$('#currenttime').html('<h3>Last update: ' + sometime+ '</h3'); 
```

不`before()`，不`remove()`，没问题。:)

# php - 如何在 Zend Acl 中实现资源之间的多重继承？

> ID：865204
> 
> 赞同：3
> 
> 时间：2009-05-14T19:27:30.607
> 
> 标签：php, zend-framework, multiple-inheritance

长话短说：为什么 Zend ACL 支持角色之间而不是资源之间的多重继承？

我有一个大的资源树，我希望能够授予权限。过去，我所做的就是创建两棵不同的树。第一个具有树中每种类型的通用资源。第二个具有这些类型的所有实例，以相同的方式排列。这意味着如果您要对树进行超级强加，您会在同一级别上找到相同类型的对象。然后，将每个对象实例设置为将其来自第一棵树的通用对象作为附加父对象。这允许我为每种类型的对象设置默认权限，因此每个实例都将继承它们，而不是我必须定义它们，但仍然为我提供了对每个实例的精细、特定的访问权限。

一个例子：

一个站点有 3 个模块：用户，其中存储用户配置文件和诸如此类的东西。论坛，对当前问题进行热烈讨论 画廊，用户可以上传他们的宠物照片

所以，上面提到的泛型树看起来像这样：

```
                        模块
                    / | \
                  用户论坛图库
                  / | \
               个人资料主题照片
                          |
                         邮政

```

实例树看起来像这样：

```
                        模块_1
        // / | \ \           
    用户 1 用户 2 用户 3 论坛 画廊 1 画廊 2
      | | | / \ / \ / \
个人资料 个人资料 个人资料 sub1 sub2 照片 照片 照片 照片
                         | / \
                     后 1 后 2 后 3

```

并且在 ACL 中，每个用户对象实例都将从第一棵树中的用户继承。所以默认情况下，我想让所有内容都可读，所以我允许在模块上读取。一切都继承自模块，所以一切都很好。我还希望用户能够编辑他们的个人资料，所以我授予每个用户在他们各自的个人资料上的编辑权限，泛型树在这里没有帮助。假设我的照片画廊是 NSFW，所以我想拒绝阅读它们。通过多重继承，我可以拒绝任何未注册用户的照片读取，这只是一个操作。如果没有多重继承，我必须检查每张照片并拒绝未注册用户的读取权限。如果我有很多照片，这是个坏消息。

有谁知道这样做的方法？它提供了我能想到的最灵活的解决方案。如果您能想到可以使用 Zend_Acl 实现的更好的东西，也请回复！

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T22:26:59.550

首先，回答你的问题。资源的多重继承。Zend_ACL 不支持，因为您的资源树旨在复制您正在保护的物理资源。您根本不能（例如）在多个父目录中存在一个文件。

所以为您提供解决方案...

*   我假设您的“泛型”树是您的资源。

*   您的角色应该代表您的用户组，例如匿名、注册、版主、管理员等。每个更宽松的角色都应该从前一个角色继承，所以“注册”将从“匿名”继承，“版主”从“注册”等继承。这允许每个级别都拥有其父级的所有权利，然后添加一些。

*   假设您使用我所描述的结构，您还将使用特权来分配可能的用户操作。IE。“查看”、“编辑”、“添加”和“管理”见[链接文本](http://framework.zend.com/manual/en/zend.acl.html#zend.acl.introduction.defining "Zend ACL 文档")

*   您需要将“查看”权限分配给“模块”上的匿名角色，并授予所有人读取权限。

*   您需要将“添加”权限分配给“论坛”上的注册角色，在此处通过授予读取（从匿名角色继承）和添加到注册用户。

*   您需要为“gallery”上的注册角色分配“add”权限，并在此处将读取（再次继承）和添加到注册用户。

*   冲洗并重复版主、管理员等。

*   要允许用户修改他们自己的个人资料、图片上传等，您不会使用 ACL 来处理此级别的交互。只需在代表资源（图像对象、配置文件对象等）的任何对象上创建一个 isOwner 方法，该方法将根据当前登录的用户是否拥有该项目返回一个布尔值。这样您就可以决定是否允许该用户编辑/删除/等该配置文件/图像。

希望这是有用的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T22:03:46.423

我不能直接从经验中推荐任何东西，我很久以前就使用每个资源的多个权限来完成它，这有点痛苦。

如果我现在正在编写 ACL 代码，我可能会在[http://codeutopia.net/blog/2009/02/11/zend_acl-part-2-different-roles-and-上查看这篇关于 ACL 资源类型的文章resources-more-on-access/](http://codeutopia.net/blog/2009/02/11/zend_acl-part-2-different-roles-and-resources-more-on-access/)或许还有第 1 部分和第 3 部分的灵感。

在文章的最后，谈到了允许跨所有资源的读取访问并创建一揽子允许/拒绝规则。

# c# - 单击gridview中的按钮时将项目添加到arraylist

> ID：865205
> 
> 赞同：0
> 
> 时间：2009-05-14T19:27:30.840
> 
> 标签：c#, session, gridview, button, arraylist

当我单击gridview中的“添加到购物车”按钮时，我需要从行列表中添加itemid，我能够将此itemid传递给arraylist。

但问题是每次我单击按钮时，前一个 itemid 都会被新项目覆盖，而不是我希望扩展数组列表。

```
public partial class Drama_k : System.Web.UI.Page
{
    string Cn=@"Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\ewap_k.mdf;Integrated Security=True;User Instance=True";
    ArrayList arrValues = new ArrayList(4);

protected void GridView2_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        if (e.CommandName=="AddToCart")
        {
            int index = Convert.ToInt32(e.CommandArgument);
            Session["item"] = GridView2.DataKeys[index].Value.ToString();
            arrValues.Add(Session["item"]);
            GridView1.DataSource = arrValues;
            GridView1.DataBind();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T19:31:50.470

不要忘记arraylist没有存储在某个地方，您必须将它存储在用户的会话中，并且在按钮引起的每次回发时，从会话中检索它并添加用户单击的项目。

编辑：这是一个关于如何在会话中存储 ArrayList 并在每次回发时检索它的小示例。

```
 public partial class _Default : System.Web.UI.Page
{
    ArrayList array;
    protected void Page_Load(object sender, EventArgs e)
    {
        if(Session["array"] == null)
        {
            array = new ArrayList();
            Session.Add("array", array);
        }
        else
            array = Session["array"] as ArrayList;
        GridView1.DataSource = array; 
        GridView1.DataBind(); //Edit 2
    }

    protected void Button1_Click(object sender, EventArgs e)
    {
        array.Add(DateTime.Now);
    }
} 
```

如果您还有问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T19:32:53.713

您只需将其存储`ArrayList`在`ViewState`or中`Session`，它将在回发之间保留其值。

# c++ - 我应该根据新标准还是旧标准（规范）学习 C++？

> ID：865209
> 
> 赞同：6
> 
> 时间：2009-05-14T19:27:48.937
> 
> 标签：c++, c++11

好的，我正在考虑在未来几个月内进入 c++ 开发（没有确定日期）。我对语言（主要是C）隐约熟悉，以及OO、MI、模板、异常、模式、使用过的STL的一些基础知识。现在我正处于我想深入掌握这门语言的时间点。自然的问题是我应该
从当前的**C++03**还是**C++0x**标准开始。

请建议从用户到大师的最佳方式，因为新标准几乎就在这里，并且可能会在未来很多年保持不变。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T19:37:47.383

我的建议是从中间开始。从 C++03 开始​​，但检查一些编译器已经经常提供的特性和 C++0x 库。到目前为止，C++03 是标准（不仅是正式的，而且您会发现的大多数代码都是严格的 C++03）。

现在，如果您打算学习最好：从 STL 基础快速开始，并立即跳入 Boost 库。全程学习模板，阅读元编程。现代 C++03 的使用将使您走上 C++0x 的轨道。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T19:31:38.897

学习旧的标准 C++03。C++0X 距离被批准为标准还有几年的时间（至少）。一旦标准化，*任何*符合其所有特性的实现都需要一段时间才能出现，而C++0X 实现变得非常流行和经常使用还需要*更长的时间。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T19:37:13.500

在我看来，学C++03更实用。如果您不介意学习新功能但可以使用 partial 几年，C++0x 更好。好消息是 g++ 新版本和 vc++2010 已经实现了部分新的 c++0x 功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T19:37:38.927

学习新的 C++0x 特性是深入了解 C++03 的好方法，因为您会了解 C++03 的工作原理、它的问题以及 c++0x 建议如何解决这些问题.

我最近在学习新的右值引用和移动语义时有过这种经验。在 C++03 中有很多不必要的临时创建和复制表达式，了解为什么 c++03 有这个问题以及 C++0x 如何解决这个问题非常有启发性，并为我当前的 C++ 开发提供了信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T19:42:46.980

C++0x 编译器普及还需要几年时间。所以目前，你别无选择。学习 C++03，到时候可以单独学习新的东西。根本区别并没有那么大。0x 主要是增加新功能，以及对现有功能进行通用化和精简。C++03 的知识仍然适用。

# asp.net - 如何在 Web 服务上进行通话后处理？

> ID：865212
> 
> 赞同：1
> 
> 时间：2009-05-14T19:28:44.660
> 
> 标签：asp.net, wcf, web-services

有没有办法让 Web 服务（WCF/ASMX/等）调用在返回结果后进行一些处理？注意我不是在寻找异步调用，因为客户端需要在额外处理完成之前尽快返回结果。

主要限制是，据我所知，在我的服务器上运行代码的唯一方法是通过 ASP 页面或 Web 服务。

这可以通过产生一个后台线程来完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T19:44:44.137

您想要客户不知道或无法控制成功的副作用吗？那**是**异步处理，即使您返回一个立即同步的答案。如果结果是可观察的并且客户感兴趣，您应该有一些方法让客户和运营商确定之后是否成功。

这取决于您托管 Web 服务的方式（与提供通信和激活层的 WCF 正交）。正常的 Web 服务托管不允许您处理 WS 调用之外的事情，主要是为了防止您自爆并吃掉所有服务器资源。

*   在 ASP.NET ASMX 托管下，您可以将另一个任务输入[线程池](http://www.beansoftware.com/ASP.NET-Tutorials/Multithreading-Thread-Pool.aspx)：但是，如果服务器负载过大，这可能会在没有警告的情况下终止。我们最近不得不在生产服务中求助于这个：幸运的是，服务器主机没有遇到高负载。我们对这个解决方案的可靠性有些紧张。
*   我没有使用过[Windows Activation Services](http://msdn.microsoft.com/en-us/library/ms730158.aspx)，但应该有一种方法可以在单独的线程中产生额外的工作。
*   您始终可以实现自己的工作进程，例如作为 Windows 服务，并根据需要向它提交工作。这并不是非常困难，但需要一些工作才能可靠且可扩展地完成。不是最喜欢的，WAS 旨在解决的场景类型。

生成另一个线程很容易，但 IIS 不应该允许您自由地做这件事，尤其是当它运行在任何类型的多应用程序 web 酒店中时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:35:23.500

那么，您的 Web 服务很可能托管在 Windows 服务器上，对吗？你可以做很多事情：

*   启动 Windows 工作流程
*   将条目写入数据库表，然后由另一个应用程序/进程扫描，然后根据该条目执行某些操作（例如发送电子邮件等）
*   启动控制台应用程序
*   在相同或不同的服务器上调用另一个服务

我认为您的选择确实无穷无尽。但是 - 它们本身并不是 Web 服务的直接一部分 - 您必须在 Web 服务调用结束*之前启动它们。*在 ASMX 或 WCF 中实际上没有任何内容允许您“发送请求然后继续执行” - 您的服务方法在完成时发送响应。

马克

# vba - 如何在 VBA 中实现 Zip 功能？

> ID：865214
> 
> 赞同：0
> 
> 时间：2009-05-14T19:29:24.720
> 
> 标签：vba, zip, windows-xp

最近我一直在开发 vba 中的一个应用程序，它依赖于文档本身的 .docm 文件中包含的一些文件。最初，我使用 Windows XP 压缩文件夹功能以编程方式提取文档的内容。这是一个最佳解决方案，因为它内置在所有将使用它的 Windows XP 中，因此无需安装。但是，我遇到了一个障碍：似乎在我提取文档一定次数后，它开始出错说“错误，该文件已经存在”。最初，我认为我破坏了某些东西并深入挖掘，结果发现我的代码中没有错误，而是压缩文件夹中的错误。

如果您在系统上的某个 zip 文件上收到“文件已存在”错误，则压缩文件夹不再适用于任何同名文件，如果您重命名所述文件，它会再次开始工作。所以这是我的问题：如何在没有压缩文件夹的情况下在 VBA 中实现 zip 功能？额外问题：如何修复压缩文件夹？

谢谢你的时间。

-Seamus

更新：目前我使用压缩文件夹工作，我正在通过每次发生错误时将文件重命名为新文件来解决该错误。这工作正常，但我正在寻找更多的修复而不是解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T22:14:06.857

似乎没有直接在 Windows 中访问 zip 功能的好方法。似乎唯一的好方法是使用其他答案中链接的 zip 文件夹复制方法。至于我遇到的问题，我将通过每次使用新文件名来解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T19:47:22.337

也许是一个额外问题的想法：在将文件与 VBA 应用程序一起使用之前，你不能重命名文件 2 次吗？首先给它一个临时名称，然后将其重命名为原始名称。

编辑：我只是在这里猜测，但似乎不太可能从您的应用程序中解决此问题，而是将其修复为一种 Windows 补丁。这意味着您的应用程序将运行的每台计算机都必须安装此补丁才能正常工作。这不是您可以依赖的东西。所以我认为你应该坚持一个解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T20:39:38.280

[这](http://www.jkp-ads.com/articles/Excel2007FileFormat02.asp)可能对您有所帮助。看起来他正在使用脚本文件系统对象......

# .net - 在运行时确定使用哪个提交按钮

> ID：865227
> 
> 赞同：1
> 
> 时间：2009-05-14T19:32:06.133
> 
> 标签：.net, asp.net, webforms

net 网页，它有两个带有单独提交按钮的搜索字段。

我想允许用户在其中一个字段中输入一些数据，然后按回车键并使用适当的按钮提交。现在，第一个提交按钮的回车键提交，但如果第二个文本框中有数据，我希望它改变。

我怎样才能做到这一点？

目前我的代码是：

```
 <label for="ctl00_cpMain_txtEmployeeSearch">Employee Name:</label><asp:TextBox id="txtEmployeeSearch" runat="server" CssClass="TextBox" />
    <asp:Button ID="btnEmployeeSeach" runat="server" Text="Search" onclick="btnEmployeeSeach_Click" CssClass="button" />

    <label for="ctl00_cpMain_txtCustomerSearch">Customer Name:</label><asp:TextBox id="txtCustomerSearch" runat="server" CssClass="TextBox" />
    <asp:Button ID="btnCustomerSeach" runat="server" Text="Search" onclick="btnCustomerSeach_Click" CssClass="button" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T19:38:42.250

看看`DefaultButton`物业。您可以将每个标签/按钮对包装在面板中，并将属性分别设置为`btnEmployeeSearch`和。`btnCustomerSearch`

[http://forums.asp.net/t/985791.aspx](http://forums.asp.net/t/985791.aspx)

```
<asp:Panel DefaultButton="btnEmployeeSearch" runat="server" id="Panel">
    <label for="ctl00_cpMain_txtEmployeeSearch">Employee Name:</label><asp:TextBox id="txtEmployeeSearch" runat="server" CssClass="TextBox" />
    <asp:Button ID="btnEmployeeSeach" runat="server" Text="Search" onclick="btnEmployeeSeach_Click" CssClass="button" />
</asp:Panel> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T19:39:43.837

我认为让两个按钮触发相同的服务器端功能可能会更好，然后您可以检查以编程方式单击了哪个按钮，然后从那里调用其他方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T19:40:20.077

您可以将每个部分包装在一个面板中，并使用它的 defaultbutton 属性为每个文本框指定提交按钮：

```
<asp:Panel runat="server" DefaultButton="btnEmployeeSeach">
    <label for="ctl00_cpMain_txtEmployeeSearch">Employee Name:</label><asp:TextBox id="txtEmployeeSearch" runat="server" CssClass="TextBox" />
    <asp:Button ID="btnEmployeeSeach" runat="server" Text="Search" onclick="btnEmployeeSeach_Click" CssClass="button" />
</asp:Panel>    
<asp:Panel runat="server" DefaultButton="btnCustomerSeach">
    <label for="ctl00_cpMain_txtCustomerSearch">Customer Name:</label><asp:TextBox id="txtCustomerSearch" runat="server" CssClass="TextBox" />
    <asp:Button ID="btnCustomerSeach" runat="server" Text="Search" onclick="btnCustomerSeach_Click" CssClass="button" />
</asp:Panel> 
```

[如何设置默认按钮](http://www.ehow.com/how_2021386_default-button-aspnet-c-vb.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:32:42.880

这是 asp:Panel 的扩展，它使页面能够
根据当前焦点具有多个默认按钮。
它覆盖 Panel 的 OnLoad 方法和 DefaultButton 属性。
您可以将字段和按钮包装到单独的自定义面板中，并在 Page_Load() 或 On_Load() 中启动它们的 DefaultButton

这是自定义控件：

```
public class DefaultButtonPanel:Panel
    {
        protected override void OnLoad(EventArgs e)
        {
            if(!string.IsNullOrEmpty(DefaultButton))
            {
                LinkButton btn = FindControl(DefaultButton) as LinkButton;
                if(btn != null)
                {
                    Button defaultButton = new Button {ID = DefaultButton.Replace(Page.IdSeparator.ToString(), "_") + "_Default", Text = " "};
                    defaultButton.Style.Add("display", "none");
                    PostBackOptions p = new PostBackOptions(btn, "", null, false, true, true, true, true, btn.ValidationGroup);
                    defaultButton.OnClientClick = Page.ClientScript.GetPostBackEventReference(p) + "; return false;";
                    Controls.Add(defaultButton);
                    DefaultButton = defaultButton.ID;
                }
            }
            base.OnLoad(e);
        }
        /// <summary>
        /// Set the default button in a Panel.
        /// The UniqueID of the button, must be relative to the Panel's naming container UniqueID. 
        /// 
        /// For example:
        ///    Panel UniqueID is "Body$Content$pnlLogin" 
        ///    Button's UniqueID is "Body$Content$ucLogin$btnLogin" 
        ///    (because it's inside a control called "ucLogin") 
        ///    Set Panel.DefaultButton to "ucLogin$btnLogin".
        /// </summary>
        /// <param name="panel"></param>
        /// <param name="button"></param>
        public override string DefaultButton
        {
            get
            {
                return base.DefaultButton;
            }
            set
            {
                string uniqueId = value;
                string panelIdPrefix = this.NamingContainer.UniqueID + Page.IdSeparator;
                if (uniqueId.StartsWith(panelIdPrefix))
                {
                    uniqueId = uniqueId.Substring(panelIdPrefix.Length);
                }
                base.DefaultButton = uniqueId;
            }
        }

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T19:37:23.500

你能把它分成两个独立`<form>`的s吗？您只会获得提交的文本字段之一（没有 JavaScript 技巧），但也许这在您的应用程序中并不重要？

# c# - 你将如何开发一个按频率排序的一万个英语中最常用单词的列表？

> ID：865238
> 
> 赞同：1
> 
> 时间：2009-05-14T19:34:40.730
> 
> 标签：c#, algorithm

一位现任员工曾经问我，我将如何开发一个按频率排序的一万个最常用英语单词的列表。用您选择的语言提出解决方案，尽管我更喜欢 C#。

请不仅提供实现，还请提供解释。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T19:42:23.737

```
IEnumerable<string> inputList; // input words.
var mostFrequentlyUsed = inputList.GroupBy(word => word)
  .Select(wordGroup => new { Word = wordGroup.Key, Frequency = wordGroup.Count() })
  .OrderByDescending(word => word.Frequency); 
```

说明：我真的不知道是否需要进一步解释，但我会尝试。`inputList`是一个数组或任何其他提供源词的集合。`GroupBy`函数将通过一些类似的属性（即在我的代码中，对象本身，如 lambda 所指出的`word => word`）对输入集合进行分组。输出（这是一组由指定键，单词组成的组）将被转换为具有 和 属性的对象，并按属性`Word`降序排序。您可以使用前 10000 个。整个事情可以通过 PLINQ 提供的轻松并行化。查询运算符语法可能看起来更清晰：`Frequency``Frequency``.Take(10000)``.AsParallel()`

```
var mostFrequentlyUsed = 
     (from word in inputList
      group word by word into wordGroup
      select new { Word = wordGroup.Key, Frequency = wordGroup.Count() })
     .OrderByDescending(word => word.Frequency).Take(10000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T02:50:38.497

作为第一个切入点，没有对问题的进一步定义（英语中最常用的词是什么意思？） - 我会购买[谷歌的 n-gram 数据](http://googleresearch.blogspot.com/2006/08/all-our-n-gram-are-belong-to-you.html)，将 1-gram 与英语词典相交，并且管它到`sort -rn -k 2 | head -10000`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T19:37:20.083

我会使用map-reduce。这是一个非常适合它的任务的[典型示例。](http://code.google.com/edu/parallel/mapreduce-tutorial.html)您可以将 Hadoop 与 C# 与[流式协议](http://hadoop.apache.org/core/docs/r0.15.2/streaming.html)一起使用。还有其他方法。请参阅[是否有与 Apache Hadoop 等效的 .NET？](https://stackoverflow.com/questions/339344/is-there-a-net-equivalent-to-apache-hadoop)和[https://stackoverflow.com/questions/436686/-net-mapreduce-implementation](https://stackoverflow.com/questions/436686/-net-mapreduce-implementation)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T19:47:22.587

我脑海中闪现的第一件事（没有检查语法，为了演示目的而冗长（对于 perl））

```
#!/usr/bin/perl

my %wordFreq
foreach ( my $word in @words)
{
   $wordFreq{$word}++;
}

my @mostPopularWords = sort{$wordFreq{$a} <=> $wordFreq{$b} } keys %wordFreq;
for (my $i=0; $i < 10000; ++$i)
{
   print "$i: $mostPopularWords[$i] ($wordFreq{$mostPopularWords[$i]} hits)\n"
} 
```

# wcf - WCF 服务文档

> ID：865240
> 
> 赞同：7
> 
> 时间：2009-05-14T19:35:27.497
> 
> 标签：wcf

在程序员和非程序员都会查看的技术产品文档中记录/发布有关 WCF 服务的信息的最佳方式是什么？另外，什么是最好的发布工具。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T19:40:04.540

这充其量是一个棘手的问题！:-)

您可以将 WCF 服务描述导出到 WSDL 文件并使用`<xs:documentation>`和`<xs:annotation>`元素丰富它，然后使用 XSLT 转换将其转换为可读的 HTML 文档 - 但这并不是很好和有用，真的....

这是一个显示如何做到这一点的链接：http: [//andrewtokeley.net/archive/2008/10/30/adding-wsdl-documentation-to-your-wcf-services.aspx](http://andrewtokeley.net/archive/2008/10/30/adding-wsdl-documentation-to-your-wcf-services.aspx)

那里的一些 XML 工具还提供了记录 WSDL 文件的方法 - 通常也来自那些文档和注释标签 - 一个示例在这里：[http ://www.oxygenxml.com/doc/ug-oxygen/generate-wsdl-documentation .html](http://www.oxygenxml.com/doc/ug-oxygen/generate-wsdl-documentation.html)

这是一个在线版本（和一个可下载的 XSLT 转换），用于将文档和注释元素从您的 WSDL 中转换出来：[http ://tomi.vanek.sk/index.php?page=wsdl-viewer](http://tomi.vanek.sk/index.php?page=wsdl-viewer)

我在这里并没有最终的答案——但对这个话题也很感兴趣！

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T19:46:10.950

看看这个问题：[Best way to document a WCF interface](https://stackoverflow.com/questions/823148/best-way-to-document-wcf-interface/823185#823185)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T19:54:31.243

当您使用WCF [REST Starter Kit](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24644)创建 WCF REST 服务时，会生成一个[帮助页面](http://msdn.microsoft.com/en-us/netframework/dd547388.aspx)。您似乎没有使用 REST，但我想我会提到它，因为这种格式可能适合您。

这使用操作描述来公开操作的 Atom Feed。

一个小小的反思出现了这个样本：

```
public Atom10FeedFormatter GetFeed(ContractDescription contractDescription)
{
    List<SyndicationItem> items = new List<SyndicationItem>();
    foreach (OperationDescription od in contractDescription.Description.Operations)
    {
        WebGetAttribute get = od.Behaviors.Find<WebGetAttribute>();
        WebInvokeAttribute invoke = od.Behaviors.Find<WebInvokeAttribute>();
        string method = this.GetMethod(get, invoke);
        string requestFormat = null;
        if (invoke != null)
        {
            requestFormat = this.GetRequestFormat(invoke, od);
        }
        string responseFormat = this.GetResponseFormat(get, invoke, od);
        string uriTemplate = this.GetUriTemplate(get, invoke, od);
        WebMessageBodyStyle bodyStyle = this.GetBodyStyle(get, invoke);
        string requestSchemaLink = null;
        string responseSchemaLink = null;
        string requestExampleLink = null;
        string responseExampleLink = null;
        if (bodyStyle == WebMessageBodyStyle.Bare)
        {
            UriTemplate responseSchemaTemplate = new UriTemplate("help/{operation}/response/schema");
            responseSchemaLink = responseSchemaTemplate.BindByPosition(this.BaseUri, new string[] { od.Name }).AbsoluteUri;
            UriTemplate responseExampleTemplate = new UriTemplate("help/{operation}/response/example");
            responseExampleLink = responseExampleTemplate.BindByPosition(this.BaseUri, new string[] { od.Name }).AbsoluteUri;
            if (invoke != null)
            {
                UriTemplate requestSchemaTemplate = new UriTemplate("help/{operation}/request/schema");
                requestSchemaLink = requestSchemaTemplate.BindByPosition(this.BaseUri, new string[] { od.Name }).AbsoluteUri;
                UriTemplate requestExampleTemplate = new UriTemplate("help/{operation}/request/example");
                requestExampleLink = requestExampleTemplate.BindByPosition(this.BaseUri, new string[] { od.Name }).AbsoluteUri;
            }
        }
        uriTemplate = HttpUtility.HtmlEncode(string.Format("{0}/{1}", this.BaseUri.AbsoluteUri, uriTemplate));
        string xhtmlDescription = string.Format("<div xmlns=\"http://www.w3.org/1999/xhtml\"><table border=\"5\"><tr><td>UriTemplate</td><td>{0}</td></tr><tr><td>Method</td><td>{1}</td></tr>", uriTemplate, method);
        if (!string.IsNullOrEmpty(requestFormat))
        {
            xhtmlDescription = xhtmlDescription + string.Format("<tr><td>Request Format</td><td>{0}</td></tr>", requestFormat);
        }
        if (requestSchemaLink != null)
        {
            xhtmlDescription = xhtmlDescription + string.Format("<tr><td>Request Schema</td><td><a href=\"{0}\">{0}</a></td></tr>", HttpUtility.HtmlEncode(requestSchemaLink));
        }
        if (requestExampleLink != null)
        {
            xhtmlDescription = xhtmlDescription + string.Format("<tr><td>Request Example</td><td><a href=\"{0}\">{0}</a></td></tr>", HttpUtility.HtmlEncode(requestExampleLink));
        }
        xhtmlDescription = xhtmlDescription + string.Format("<tr><td>Response Format</td><td>{0}</td></tr>", responseFormat);
        if (responseSchemaLink != null)
        {
            xhtmlDescription = xhtmlDescription + string.Format("<tr><td>Response Schema</td><td><a href=\"{0}\">{0}</a></td></tr>", HttpUtility.HtmlEncode(responseSchemaLink));
        }
        if (responseExampleLink != null)
        {
            xhtmlDescription = xhtmlDescription + string.Format("<tr><td>Response Example</td><td><a href=\"{0}\">{0}</a></td></tr>", HttpUtility.HtmlEncode(responseExampleLink));
        }
        WebHelpAttribute help = od.Behaviors.Find<WebHelpAttribute>();
        if ((help != null) && !string.IsNullOrEmpty(help.Comment))
        {
            xhtmlDescription = xhtmlDescription + string.Format("<tr><td>Description</td><td>{0}</td></tr>", help.Comment);
        }
        xhtmlDescription = xhtmlDescription + "</table></div>";
        var item = new SyndicationItem() {
           Id = "http://tmpuri.org/" + od.Name,
           Content = new TextSyndicationContent(xhtmlDescription, TextSyndicationContentKind.XHtml),
           LastUpdatedTime = DateTime.UtcNow,
           Title = new TextSyndicationContent(string.Format("{0}: {1}", this.Description.Name, od.Name))
        };
        items.Add(item);
    }
    SyndicationFeed feed = new SyndicationFeed()
    {
       Title = new TextSyndicationContent("Service help page"),
       LastUpdatedTime = DateTime.UtcNow,
       Items = items
    };
    WebOperationContext.Current.OutgoingResponse.ContentType = "application/atom+xml";
    return feed.GetAtom10Formatter();
} 
```

# .net - 将过期或缓存控制标头添加到 IIS 中的静态内容

> ID：865252
> 
> 赞同：48
> 
> 时间：2009-05-14T19:37:32.407
> 
> 标签：.net, http, iis, caching

在一个站点上运行[YSlow 插件](http://developer.yahoo.com/yslow)后，我看到其中一个[建议](http://developer.yahoo.com/performance/rules.html#expires)是将远期过期标头添加到脚本、样式表和图像中。

我想做这个，有人有这方面的经验吗？我正在使用 IIS 7，并且阅读了[Microsoft 的一篇文章，](http://support.microsoft.com/kb/247404)但对禁用 asp 页面或图像的缓存不感兴趣，我实际上想强制缓存静态内容。此外，理想的情况不会存在于代码中，而是存在于 Web 服务器配置中。

那么，我必须采取哪些步骤才能缓存每个图像、javascript 文件和样式表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-08-13T09:55:39.393

> 这可以在 IIS 6 中完成吗？

配置内容到期

1.  在 Internet 信息服务 (IIS) 管理器管理工具中，右键单击您的网站，然后单击属性。

2.  在“属性”对话框的“HTTP 标头”选项卡上，指定过期时间，然后单击“确定”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-04-05T13:19:01.027

我在 http 标头选项卡上添加了一个自定义标头，而不是选中该框，因为否则我无法在缓存控制标头中包含“公共”。

我为具有静态内容的文件夹（例如 /images/、/scripts/、/css/ 和其他一些文件夹，而不是整个项目）执行此操作。

名称：缓存控制值：public，max-age=604800

虚拟现实

# programming-languages - 您如何以及多久重构一次代码？

> ID：865258
> 
> 赞同：7
> 
> 时间：2009-05-14T19:37:56.743
> 
> 标签：programming-languages, refactoring, coding-style

[我的问题与这个](https://stackoverflow.com/questions/140677/how-often-should-you-refactor)隐约有关。但是，它没有涉及技术或实践。

我正在阅读*The Pragmatic Programmer*，它强烈主张尽可能多地重构代码。但是，它没有详细说明如何执行此操作以及多久执行一次。你们是如何重构代码的，你们多久重构一次？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-14T19:43:41.037

何时何地需要。

重构本身没有意义，它是简化进一步开发的工具。只有当你能从中受益时才进行重构。一个永远不会发展和经过测试的小型库是不重构的完美候选者，在重构上投入的任何时间都不会得到回报。系统/程序中将要发展、需要维护和难以阅读的部分是重构的明确候选者。

始终考虑 ROI（投资回报）​​，如果您开始重构您现在认为可能会更好的所有内容，那么明天您将再次重构，也许有时间您将有时间实际执行一些真正的进步。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-14T19:42:26.357

这有点像打扫房子，你应该每天收拾东西，做一些需要做的小事来保持清洁。然后（每周一次左右）你需要几个小时，从上到下对房子进行一次很好的清洁。最后（大约一年一次）你做了一个很好的春季大扫除，把所有的垃圾都拖出来，重新开始。

重构是为了保持一个干净的代码库，它是一项永远不会完成的永久任务。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T19:51:30.003

只有当我的代码被测试用例覆盖时，我才会重构。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T20:06:32.103

每当我看到代码重复时。

每当我看到一个更简单的算法/启发式的机会时。

我离发布越来越近了:)

我喜欢可以帮助您分析代码库的工具，并且可以告诉您未使用的成员、不必要的可见性（公共与受保护、内部与私有等）

我主要在 .NET 中工作，ReSharper 非常棒，可以做到这一点以及自动化许多类型的重构操作。我认为许多其他语言也有类似的工具。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T19:42:03.473

通常，当我致力于增强系统的一部分时，我会重构代码，并且我知道我正在重构的那部分代码将被测试。

如果我看到一些我知道需要处理的东西，并且它不是当前版本的一部分，我会暂时不理会它，并将其安排在下一个版本中。这对我们来说没什么大不了的，因为我们确实每个月发布一次，所以我们发现的错误代码可以稍等片刻（前提是它不会在生产中造成问题），直到我们有时间彻底审查需要做什么。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T19:43:30.427

当我编写第一次代码时，我通常会尽量不让自己陷入对未来可能的重用场景的思考太远。然后，随着更多重用场景的出现，我越深入开发，我就越会重构旧代码以提高其抽象和重用级别。

所以实际上这是一个迭代过程；我越是重复使用我已经为新目的编写的代码，我就越觉得有必要进行重构。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-14T19:44:05.450

每当我添加新功能或特别是在更改现有功能时，我都会寻找重构机会

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-14T22:39:37.837

最重要的是永远不要告诉你的老板/客户你正在重构。始终将重构包含在正常的工作流中。解释为什么值得付出代价是不值得的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-14T22:20:56.727

有重构的层次和层次。

我不断重构以消除重复。我不去*寻找*重复，但如果我看到它，我会修复它。我经常使用提取方法来缩小方法，并遵循所有 ReSharper 建议或警告（我配置 ReSharper 以将任何我可能忽略的内容变成提示）。这也是一个好处，因为你习惯了在顶部看到漂亮的绿色广场，告诉你一切都很好。当它是不同的颜色时，你就*知道*有问题了。

更大的重构（OP 可能关心的那种），我在很大程度上就像对待一个新特性一样。我将尝试就它的重要性达成共识，并相应地安排它。除非涉及的代码具有高度的单元测试覆盖率，否则我不会进行这样的更改。“如果它没有经过测试，那么它就坏了”是墨菲定律的推论之一。此外，如果它已经损坏，那么我不会通过重构覆盖不佳的代码来使其变得更糟。

我也不会重构以使代码适合某种模式，或者为了将来更容易修改。当未来到来时，它会带来一些失败的单元测试，除非我做出改变，否则这些单元测试不会成功。如果没有这样的测试，那么我无法判断我的更改是否破坏了任何东西，所以我不会重构。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-14T22:29:53.180

关于重构有许多格言和经验法则。一个常见的立即浮现在脑海的是[三法则](http://en.wikipedia.org/wiki/Rule_of_three_(programming))

在职业生涯中，我们对于何时可以进行重构的灵活性显然比我们在个人项目中的灵活性要小。由于更改会带来风险并为测试人员创造工作（即使您已将所有回归测试自动化，但转移到生产环境的更改会为您流程中的某个地方的人（除了更改代码的人之外）产生一些工作），您必须在决定重构什么以及何时重构时计算成本效益比。

在决定重构什么以及如何重构时，我会牢记以下几点，尤其是在我处理将要投入生产的代码时：

1.  重构的预期好处是什么？表现？降低复杂性？重复使用？
2.  变更的影响程度如何？具有重大影响的变更往往会进行大量的测试，并带来更高的风险。
3.  重构能否干净利落地执行？不完整的重构可能会引入比带走更多的熵。例如，您有一些方法可以创建一个很棒的实用程序类。如果您引入实用程序类，是否可以用对实用程序类的调用替换所有现有的（以及可能复制和粘贴的）方法？是否有另一个具有类似功能的现有实用程序类？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-15T13:16:33.033

我不是仅仅为了重构而重构的忠实粉丝。我总是尽量保持代码干净，避免走捷径，并在第一时间就做好。每次我添加一个新功能时，我都会在需要时进行重构，并将其视为功能实现的一部分。

如果您有能力以这种方式工作，那么就不需要像不定期进行小规模清理那样频繁地进行大而“可怕的”重构。

当然，当项目范围发生变化时，无论代码的形状如何，通常都需要重构，但是代码越精简，重构就越容易和更快。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-14T19:42:42.410

每当我不开发新代码时，我都会重构。我也会在任何时候重构我注意到任何瓶颈。

*   解开慢循环
*   将变量定义移动到函数的头部。
*   用经过验证的更快算法替换较慢的“原型”算法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-14T19:42:44.017

除了非常 - 非常紧张的情况，你现在必须完成一些事情**然后**我总是在我写下一些东西时保持开放的眼光来重构。有时我有空闲时间会尝试重构旧代码，以防我错过了什么。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-14T19:48:16.627

我经常重构。经典场景是当我结束编写大方法时，我喜欢将它们分解成更小的部分。还有很多其他的，它们以某种频率发生。重构帮助我在快速编码和尽可能保持代码整洁之间保持平衡。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-14T20:05:51.903

我认为重构代码有多个决定因素。其中一些可以是美学、通用功能或业务流程。

例如，我目前正在从我们的几个实用程序（Java Swing）中重构出常用功能。每个实用程序的顶部都有相同的菜单栏。但是如果我需要添加一个菜单项，我需要为所有实用程序（复制/粘贴）执行此操作。所以我创建了一个菜单栏对象，并让每个实用程序只使用这个对象。现在，如果我添加一个菜单项，它们都会立即更新。

上述公用事业的开发现在将在世界各地的不同地点完成，而不仅仅是由我完成。所以我想做的是打破更多的共性，这样当一个新的开发人员在一个实用程序上工作时，他们可以只关注肉和土豆，现在关注它的 Swing 方面。

我还将几个数据验证和数据插入过程重构为更小的过程。这有助于分解应用程序中的业务逻辑，并有助于“进入”您需要去的地方。例如，应用程序中有一个步骤确定是否可以将行插入到数据库中。我没有做这一步，而是做了大约 10 个，其中包括读取数据、验证正确的大小和数据类型、我在标签中显示什么等。现在更容易更改特定部分的业务逻辑.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-14T20:07:58.153

每次我推动 - 否则我的同事会处理我的情况，他们也应该这样做。

（这是 DVCS 的另一个好处：我可以在不推送的情况下提交正确但因子错误的代码。）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-14T22:04:47.903

每时每刻。每当我看到一个更好的方法或变量名称时，每当我看到一些应该被内联或提取的东西时，等等。我严重依赖 Eclipse 的自动重构来安全地进行这些更改。更大的、非自动化的重构发生的频率较低，但当我看到需要它们时再次发生，并且只有在可靠的测试覆盖范围内。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-14T22:10:24.880

特定于 VS 2008 和 C#

每时每刻。我倾向于在 StyleCop 和 Code Analysis 永久运行的情况下进行编码。甚至使用了 Resharper，如果我在任何地方看到红色，就该重构了。当然，我只使用这些工具来简化操作并强迫我这样做。

但是，按照我的规定，我只重构自己的代码和新代码。遗留代码和其他人编写的代码在得到指示之前不会受到影响。

# sql - 拥有一个包含同名列的 SQL 表是不好的编码习惯吗？

> ID：865265
> 
> 赞同：2
> 
> 时间：2009-05-14T19:38:56.053
> 
> 标签：sql, coding-style, conventions, readability

例子：

```
CREATE TABLE ErrorNumber
(
     ErrorNumber int,
     ErrorText varchar(255),
) 
```

这可能会导致查询如下所示：

```
SELECT ErrorNumber FROM ErrorNumber WHERE ErrorNumber=10 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T19:40:15.287

我假设 ErrorNumber 作为表中的列是主键？在这种情况下，您可以将表列命名为 ErrorNumberID。

我不知道这是一种糟糕的编码实践，但我无法想象它会为可读性做任何事情。您提供的示例很好地展示了查询最终会变得多么混乱。

我不确定的另一件事是（列名与表名相同）是否会导致错误？我敢肯定它因供应商而异。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T19:52:44.477

```
CREATE TABLE Errors (
    Number int,
    Description varchar(255)
) 
```

我觉得上面是一个更好的命名方案，因为：

*   表名现在代表它是什么。
*   由于它们所在的表，这些列中不需要“错误”一词。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T19:41:13.053

您可以坚持默认并命名您的主键 ID。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T19:42:38.887

我认为拥有与其表共享相同名称的列不是一个好主意。即使它有效，它也会令人困惑。尝试将您的表重命名为 Error 或将列重命名为 ErrorNum 甚至只是 Num

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T19:49:15.797

是的。简单数据模型中的绝大多数简单表应该是复数名词。在您的示例中，该表应称为“错误”，有两列，“id”和“description”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T20:08:07.170

我同意 DWC，并且会更进一步，将表命名为更具描述性的名称，例如它是哪种类型的错误表。如果它用于存储您将在代码中使用的错误是一回事，如果它是一个记录错误的表是另一回事。不确定您将其用于什么目的，因此完全取决于您将其命名为对其所使用的上下文有意义的名称。当我看到一个名为“错误”的表时，我不确定它是日志表还是用于查找错误代码的查找表。如果是后者，那么像 ErrorCodes 这样的名称可能是个好名字。

```
CREATE TABLE ErrorCodes
(
Id int,
Number int,
Description varchar(255)
) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T19:42:29.790

穷吗？也许有点，但没什么大不了的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T19:46:52.290

我同意这没什么大不了的。

我们在应用程序中有大量表，它们只有 id 和“名称”字段。它们用于下拉列表。

所以我这样设置它们：

列表名称是：州

表名是：状态

ID 是：StateID

实际状态值列是：StateName

它对我们有用。

在您的具体情况下，我会按照上面的建议进行操作，只需将表命名为错误。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-14T19:50:57.383

如果任何数据库供应商对此感到困惑，请使用另一个数据库供应商。任何数据库都应该可以轻松地解析它而不会出现问题。

我同意出于可读性的原因，这可能不是好的做法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-14T19:53:16.207

它是形式问题。就个人而言，我将大多数表名设为复数，那么它永远不会发生。在这种特殊情况下，我的表将是 ErrorNumbers 并且表字段将是 ErrorNumber （实际上我会使用 ErrorNumberID ）

不过，这取决于您或您的公司的编码标准。如果是不良形式，则属于极轻微的违规行为。如果有的话，那就是变量名称上缺少的 ID，这更像是一种违规。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-15T08:09:12.350

如果一个表预计包含多于一行，那么我的偏好是使用一个集体术语作为名称。请注意，这与使用单数并附加“s”不同，例如，我更喜欢“Personnel”和“Payroll”而不是“Employees”和“EmployeesSalaries”。并且应该取出并拍摄诸如“实体”之类的名称:)

鉴于此，并考虑到您设计中的列，我将有问题的表命名为“错误”。现在，我知道许多编码人员更喜欢表名的单数术语，但这只是一种不同的风格，而不是“糟糕的编码实践”。

偶尔需要单行表，例如包含 pi 的共享近似值的表“常量”，以供使用 DBMS 的应用程序使用......但是我想到的“常量”表有多个列，每个列用于不同的常量所以它得到了一个统称作为一个名称。

也许如果您的应用程序只使用过一个常量，那么您最终可能会得到一个名为“Pi”的表？好吧，我做出的另一种样式选择是使用 UpperCamelCase 作为表名，使用 lower_case_separated_by_underscores 作为列名。因此，我仍然能够（几乎）从列中区分表，即

```
SELECT pi FROM Pi; 
```

[还有一个代码解析器，比如 SO 上的那个，也让工作变得更容易！]

实际上，我倾向于几乎完全使用表相关名称，所以我更有可能写：

```
SELECT P1.pi 
  FROM Pi AS P1; 
```

还要考虑一些集体术语的拼写与单数术语相同，例如“物种”、“鹿”、“绵羊”、“鱼”，可能还有许多其他不属于动物王国的术语，但我刚才有精神障碍:)

因此，尽管我可以设想一个 SQL 表包含一个具有相同名称的列，即使使用我喜欢的数据元素命名约定，这种情况确实很少见。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-05T05:39:09.997

+1 dwc 的简洁名称。

“列名应该表示值域”的问题在于它忽略了上下文。列名仅存*在于*表的上下文中。它从不模棱两可。它的域不受其名称的控制。

Does the person exist who cannot distinguish between `Errors.Description` and `Parts.Description` and `Problems.Description`, or who would assume that all columns named `Description` or `Name` are drawn from the same holy well?

That said, I don't use generic terms such as *Number* or *ID* for primary key columns, for a very different reason: the column needs a new name where it appears as a foreign key.

Suppose error numbers had to be recorded in, say, the `Actions` table. `Actions.Number` can't possibly refer to an error number, so we're forced to invent something like `Actions.ErrorNumber`. If it's going to be `ErrorNumber` everywhere else, it might as well have the same name where it serves as the key!

# c# - 在 C# 中访问交换电子邮件

> ID：865267
> 
> 赞同：14
> 
> 时间：2009-05-14T19:39:01.280
> 
> 标签：c#, .net, exchange-server

你知道有没有办法？

我已经使用[这个库](http://www.codeproject.com/KB/IP/NetPopMimeClient.aspx%20)来访问 pop3 服务器，但它不适用于交换服务器。

您是否知道任何其他库或代码片段会告诉我如何做到这一点？

我无法更改服务器上的任何设置。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-15T16:10:59.573

如果您使用 Exchange 2007 并启用了 Web 服务，这非常容易。我在我的 VS2008 项目中添加了一个 2.0 风格的经典 Web 参考，我可以收到这样的邮件消息：

```
// exchange 2007 lets us use web services to check mailboxes.
using (ExchangeServiceBinding exchangeServer = new ExchangeServiceBinding())
{
    ICredentials creds = new NetworkCredential("user","password");
    exchangeServer.Credentials = creds;
    exchangeServer.Url = "https://myexchangeserver.com/EWS/Exchange.asmx";
    FindItemType findItemRequest = new FindItemType();
    findItemRequest.Traversal = ItemQueryTraversalType.Shallow;

    // define which item properties are returned in the response
    ItemResponseShapeType itemProperties = new ItemResponseShapeType();
    itemProperties.BaseShape = DefaultShapeNamesType.AllProperties;
    findItemRequest.ItemShape = itemProperties;

    // identify which folder to search
    DistinguishedFolderIdType[] folderIDArray = new DistinguishedFolderIdType[1];
    folderIDArray[0] = new DistinguishedFolderIdType();
    folderIDArray[0].Id = DistinguishedFolderIdNameType.inbox;

    // add folders to request
    findItemRequest.ParentFolderIds = folderIDArray;

    // find the messages
    FindItemResponseType findItemResponse = exchangeServer.FindItem(findItemRequest);

    // read returned
    FindItemResponseMessageType folder = (FindItemResponseMessageType)findItemResponse.ResponseMessages.Items[0];
    ArrayOfRealItemsType folderContents = new ArrayOfRealItemsType();
    folderContents = (ArrayOfRealItemsType)folder.RootFolder.Item;
    ItemType[] items = folderContents.Items;

    // if no messages were found, then return null -- we're done
    if (items == null || items.Count() <= 0)
        return null;

    // FindItem never gets "all" the properties, so now that we've found them all, we need to get them all.
    BaseItemIdType[] itemIds = new BaseItemIdType[items.Count()];
    for (int i = 0; i < items.Count(); i++)
        itemIds[i] = items[i].ItemId;

    GetItemType getItemType = new GetItemType();
    getItemType.ItemIds = itemIds;
    getItemType.ItemShape = new ItemResponseShapeType();
    getItemType.ItemShape.BaseShape = DefaultShapeNamesType.AllProperties;
    getItemType.ItemShape.BodyType = BodyTypeResponseType.Text;
    getItemType.ItemShape.BodyTypeSpecified = true;

    GetItemResponseType getItemResponse = exchangeServer.GetItem(getItemType);
    ItemType[] messages = new ItemType[getItemResponse.ResponseMessages.Items.Count()];

    for (int j = 0; j < messages.Count(); j++)
        messages[j] = ((ItemInfoResponseMessageType)getItemResponse.ResponseMessages.Items[j]).Items.Items[0];

    return messages;
} 
```

“messages”变量将是从 Exchange 返回的 ItemType 对象数组，这些对象具有您期望的邮件消息的所有属性（正文、附件等）。我希望这有帮助！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T20:20:02.040

取决于 Exchange 版本。[WebDAV](http://msdn.microsoft.com/en-us/library/aa143161(EXCHG.65).aspx)适用于 2000 至 2007，但[Web 服务](http://msdn.microsoft.com/en-us/library/aa565934.aspx)需要 2007+。

这些可能是最容易开始工作的。CDO 是另一种选择，但[C# 不支持它](http://blogs.msdn.com/mstehle/archive/2007/10/03/fyi-why-are-mapi-and-cdo-1-21-not-supported-in-managed-net-code.aspx)- 所以你必须[退出 proc](http://blogs.msdn.com/mstehle/archive/2007/07/27/howto-delete-search-folders-and-interop-with-cdo-1-21-from-managed-net-code.aspx)。

Exchange 也有一个[OLEDB 提供程序](http://msdn.microsoft.com/en-us/library/aa142634(EXCHG.65).aspx)，但我从未使用过它 - 但是[.NET 支持](http://support.microsoft.com/?kbid=813349)它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-10-19T14:53:40.123

直接在托管代码（VB.net / C#）中使用 EWS 可以说是笨拙的。

我已经摸索了几天，得出的结论是，最好围绕 API 构建自己的包装类，使服务在一两行代码中可用，而不是在页面中使用目前的实施。

你猜怎么了？Microsoft 在这方面胜过我：Exchange Web Services Managed API 的第一个候选版本可[在此处](http://www.microsoft.com/downloads/details.aspx?FamilyID=e8f38dd1-f123-4a16-b4c8-584d1f84af48&displaylang=en)下载。

安装、注册 dll 引用 (\Program Files\Microsoft\Exchange\Web Services\1.0\Micorosft.Exchange.WebServices.dll)，然后导入命名空间 (Microsoft.Exchange.WebServices.Data)，您就可以开始使用了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-15T16:42:53.973

我假设您的问题是您的交换服务器仅支持 NTLM 身份验证并且不允许纯文本身份验证？或者您可能没有使用正确的用户名约定。例如，您可以尝试使用格式 username@domain ，其中 domain 是内部 NT 域，可能与您的 Internet 域不同。

如果是这种情况，请寻找支持 NTLM 的库。

通过 telnet 进行测试的步骤

转到命令提示符类型：telnet my.server.com 110 你应该从你的交换服务器得到这样的响应 +OK Microsoft Exchange Server 2003 POP3 server version 6.5.7638.1 (my.server.com) ready。

类型：CAPA 这应该返回您的交换服务器支持的功能列表。CAPA +OK 能力列表遵循 TOP USER PIPELINING EXPIRE NEVER UIDL SASL NTLM 。

请注意，我的没有显示 PLAIN

这是一封电子邮件服务器的回复，该服务器已做好+OK Dovecot 准备就绪。CAPA +OK CAPA TOP UIDL RESP-CODES PIPELINING STLS USER SASL PLAIN 。

如果您的响应不包含 PLAIN，则停止，因为您需要一个支持 SPA 的库

类型：用户 myusername 或类型：用户 myusername@domain.corp 将 domain.corp 替换为您的域

然后您应该会收到 +OK

类型：pass mypass

你应该得到一个回应 +OK

类型：列表

应该得到一个电子邮件列表。这可能有助于查看您的问题是否是用户名格式问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-08T19:31:43.600

我写这篇文章是为了从我的收件箱中获取电子邮件。如果有电子邮件，我每天早上都有一项繁琐的任务要做，所以我编写了这段代码来检查我的文件夹中的电子邮件标题。我添加了一点 xml 创建来展示可能性。它不是交换，但它适用于我的情况。XCData 对正文中的任何特殊字符进行编码。我想我应该指出我正在寻找的电子邮件主题是 [Ticket - Support#12345]

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Outlook = Microsoft.Office.Interop.Outlook;
using Microsoft.Office;
using System.Xml.Linq;

namespace ProcessEmail
{
    class Program
    {
        static void Main(string[] args)
        {
            Outlook.Application outlook = new Outlook.Application();
            Outlook.NameSpace ns = outlook.GetNamespace("Mapi");
            object _missing = Type.Missing;
            ns.Logon(_missing, _missing, false, true);

            Outlook.MAPIFolder inbox = ns.GetDefaultFolder(Microsoft.Office.Interop.Outlook.OlDefaultFolders.olFolderInbox);

            int unread = inbox.UnReadItemCount;
            XElement xmlMail = new XElement("Mail");
            foreach (Outlook.MailItem mail in inbox.Items)
            {               
                string s = mail.Subject;

                if (s != null)
                {
                    if (s.Contains("Tickets") || (s.Contains("Support")))
                    {
                        string[] splitter = s.Split('#');
                        string[] split = splitter[1].Split(']');                       
                        string num = split[0].Trim();

                        XElement mailrow = new XElement("MailRow",
                            new XElement("Ticket_Number",num),
                            new XElement("Subject", mail.Subject),
                            new XElement("Body",  new XCData(mail.Body)),
                            new XElement("From", mail.SenderEmailAddress)
                            );
                        xmlMail.Add(mailrow);
                    }
                }

            }
            xmlMail.Save("E:\\mailxml.xml");

        }
    }
} 
```

马特

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T19:46:22.013

如果 Exchange Server 中未启用 POP3，则需要使用**[Exchange SDK 。](http://www.microsoft.com/downloads/details.aspx?FamilyID=190f71a4-7b5f-4a4c-99ba-9bd032e16e15&DisplayLang=en#Overview)**另一种选择是使用**[WebDAV](http://blog.mbcharbonneau.com/2006/10/26/using-net-and-webdav-to-access-an-exchange-server/)**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T19:58:42.967

你可以使用这个库： [http ://www.dimastr.com/redemption/](http://www.dimastr.com/redemption/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T20:06:47.143

另一种选择是将 Exchange 配置为启用 IMAP4。.NET 存在第 3 方 IMAP4 库，例如 rebex。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-15T16:00:21.937

您可以从 Exchange 2007 开始使用 EWS（Exchange webservices）。它们似乎总是被安装并且比 Webdav 得到更好的支持。

您可以从 Exchangeserver 导入 web 服务（在安装目录中搜索 asmx 文件）。您可以从您的邮件中下载 EML 文件并做更多的事情！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-07-08T22:37:31.913

您可以使用[Exchange Web Services](http://msdn.microsoft.com/en-us/library/bb204119%28v=exchg.140%29.aspx)（Exchange 2007 或 2010）或[WebDav](http://msdn.microsoft.com/en-us/library/aa143161%28v=exchg.65%29.aspx)（Exchange 到 2007，2010 不支持 WebDAV），但是如果您想快速开发，API 和实现可能会有点麻烦。

我过去成功地使用了 IndependentSoft 的[WebDav](http://www.independentsoft.de/webdavex/index.html)和[Exchange Web 服务](http://www.independentsoft.de/exchangewebservices/index.html)库，它们提供了一个围绕 Exchange API 的包装器，并且使用起来更简单。他们也很好地处理了解析消息和 MIME。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-17T20:51:35.650

1.  当前首选的 API（在 Exchange 2013 和 2016 中）是[EWS](https://msdn.microsoft.com/en-us/library/office/dd877012.aspx)。它完全基于 HTTP，可以从任何语言访问，但有[.Net](https://msdn.microsoft.com/en-us/library/office/dn567668.aspx)和[Java](https://github.com/OfficeDev/ews-java-api)特定的库。

    您可以使用[EWSEditor](https://ewseditor.codeplex.com/)来使用 API。

2.  [扩展 MAPI](https://msdn.microsoft.com/en-us/library/office/cc815424.aspx)。这是 Outlook 使用的本机 API。它最终使用 MSEMS Exchange MAPI 提供程序，该提供程序可以使用 RPC（Exchange 2013 不再支持它）或 RPC-over-HTTP（Exchange 2007 或更高版本）或 MAPI-over-HTTP（Exchange 2013 和更高版本）与 Exchange 通信。

    API 本身只能从非托管 C++ 或[Delphi](http://www.dimastr.com/outspy/download/MAPI_headers.zip)访问。您还可以使用[Redemption](http://www.dimastr.com/redemption)（任何语言） - 它的[RDO](http://www.dimastr.com/redemption/rdo_introduction.htm)对象系列是扩展的 MAPI 包装器。要使用扩展 MAPI，您需要安装 Outlook 或[MAPI 的独立 (Exchange) 版本](https://www.microsoft.com/en-us/download/details.aspx?id=42040)（在扩展支持下，它不支持 Unicode PST 和 MSG 文件，并且无法访问 Exchange 2016）。可在服务中使用扩展 MAPI。

    您可以使用[OutlookSpy](http://www.dimastr.com/outspy/)或[MFCMAPI](https://mfcmapi.codeplex.com/)使用 API 。

3.  [Outlook 对象模型](https://msdn.microsoft.com/en-us/library/office/aa221870(v=office.11).aspx)- 不是特定于 Exchange，但它允许访问运行代码的机器上 Outlook 中的所有可用数据。不能在服务中使用。

4.  [交换活动同步](https://technet.microsoft.com/en-us/library/aa998357.aspx)。Microsoft 不再为此协议投入任何重要资源。

5.  Outlook 用于安装 CDO 1.21 库（它包装了扩展 MAPI），但它已被 Microsoft 弃用，不再接收任何更新。

6.  曾经有一个名为 MAPI33 的第三方 .Net MAPI 包装器，但它不再被开发或支持。

7.  WebDAV - 已弃用。

8.  用于 Exchange 的协作数据对象 (CDOEX) - 已弃用。

9.  Exchange OLE DB 提供程序 (EXOLEDB) - 已弃用。

# objective-c - 使用 Qt 4.5 时如何修复我的应用程序泄漏？

> ID：865269
> 
> 赞同：2
> 
> 时间：2009-05-14T19:39:29.127
> 
> 标签：objective-c, cocoa, qt

除了针对 Qt 4.5 构建之外，没有对我的代码进行任何更改，当我运行我的应用程序时，我收到以下警告消息：

```
*** _NSAutoreleaseNoPool(): Object 0x50a1b0 of class NSCFNumber autoreleased with
no pool in place - just leaking 
```

我没有在我的代码中使用任何 Objective-C，但是 Qt 4.5 使用了一个新的基于 Cocoa 的后端而不是 Carbon。

我不确定如何解决和修复此错误消息。有人有线索吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T20:39:26.643

通常，当您在代码中看到此问题时，您会将有问题的代码块用`NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];`before 和`[pool release];`after 括起来。您可以在函数上设置断点，`_NSAutoreleaseNoPool`然后查看堆栈爬网以查看有问题的代码是什么。请记住，`-autorelease`它在 Cocoa 中随处使用，因此触发它的可能不是 Qt 代码中对 autorelease 的特定调用。

但是，由于这是执行此操作的 Qt 代码，并且上次我检查过，Qt/Cocoa 仍在进行中，您可能应该只提交带有错误的错误报告和堆栈爬取给它们，然后等待他们来修复它。

# java - 从 Java 应用程序独立执行 shell 脚本

> ID：865277
> 
> 赞同：1
> 
> 时间：2009-05-14T19:40:45.427
> 
> 标签：java, shell

我有一个由线程组成的 java 应用程序，该线程监视数据库中包含要执行的 shell 脚本的表。我每隔几秒钟就查一下数据库。对于脚本，执行它（通过 Process 类），然后等待表中的另一个脚本。

我的问题是：有时，脚本中的某些命令会失败。该线程捕获错误流并将其记录在数据库中。但是，它会不断记录消息，并且控件不会从脚本返回到 Java 线程，因此数据库中的后续 shell 脚本无法执行。

有解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T19:50:24.670

您是否*同时*阅读标准输出*和*标准错误？您是在单独的线程中执行此操作吗？根据您使用脚本输出的方式，可以阻止其中一个，我有一种预感，您的脚本被阻止等待父进程使用其输出。

从[流程](http://www.sbras.ru/win/docs/java/jdk1.3/docs/api/java/lang/Process.html)文档中：

> 由于部分原生平台只为标准输入输出流提供有限的缓冲区大小，未能及时写入子进程的输入流或读取输出流可能导致子进程阻塞，甚至死锁

请参阅[此问题](https://stackoverflow.com/questions/609762/need-sample-java-code-to-run-a-shellscript/609783#609783)和引用“stream gobblers”的示例代码。2 'gobbler's 被创建，消耗标准输出和标准错误。

# php - Zend/Apache mod_rewrite...怎么了？

> ID：865278
> 
> 赞同：0
> 
> 时间：2009-05-14T19:40:59.497
> 
> 标签：php, zend-framework, .htaccess, mod-rewrite

以下网址可以正常工作：

```
http://localhost/index/index/ 
```

但是，当它们像这样进来时，我无法 _get$ 变量：

[http://localhost/index/index/test/1234/test2/4321](http://localhost/index/index/test/1234/test2/4321)

-但-

但是，我可以通过以下方式 _get$ 变量：

```
http://localhost/index.php?test=1234&test2=4321
http://localhost/index?test=1234&test2=4321
http://localhost/index/index?test=1234&test2=4321 
```

为什么当我使用 /index/index/var/val 方式时变量没有为我显示？

您将在下面找到我的 .htaccess 文件。

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T20:08:02.757

Zend Framework 不会将请求 uri 中的数据作为 $_GET 变量提供，要访问它们，请使用**控制器**中的键：

```
$test = $this->getRequest()->getParam('test') //$test = 1234 
```

或者更短

```
$test = $this->_getParam('test'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T20:01:47.920

因为`$_GET`包含查询字符串中的变量 - 这是问号后面的 URL 部分。请注意，文件中的重写规则`.htaccess`将*所有*不引用现有文件或目录的 URL 转换为 just `index.php`，而没有原始 URL 的任何痕迹（尽管，正如 Gumbo 的评论提醒我的那样，它仍然可以通过 访问`$_SERVER['REQUEST_URI']`。你`RewriteRule`的 s 不要创建一个查询字符串（即他们不会在 URL 中添加问号），这是您使用`$_GET`.

我建议用`RewriteRule`类似的东西替换你的最后一个

```
RewriteRule ^.*$ index.php$0 [NC,L] 
```

这`$0`会将原始 URL 附加到`index.php`- 例如，`http://localhost/index/index/test/1234/test2/4321`将变为`http://localhost/index.php/index/index/test/1234/test2/4321`Then 请求将被处理`index.php`并且`$_SERVER['PATH_INFO']`变量将被设置为原始 URL `/index/index/test/1234/test2/4321`，。您可以编写一些 PHP 代码来解析它并挑选出您想要的任何参数。

如果您不希望将`/index/index`开头的 保存在 path_info 变量中，则可以使用`RewriteRule`这样的代替：

```
RewriteRule ^/index/index(.*)$ index.php$1 [NC,L] 
```

或者

```
RewriteRule ^(/index)*(.*)$ index.php$2 [NC,L] 
```

剥离任意数量的前导`/index`es。

*编辑*：实际上，您可以保留现有`RewriteRule`的 s 并查看`$_SERVER['REQUEST_URI']`以获取原始请求 URI；不需要弄乱路径信息。然后你可以在 PHP 中随意拆分它。

# iphone - iPhone SDK：检查 UITableView 中每个对象的 ID 号并相应地更改徽章号

> ID：865282
> 
> 赞同：0
> 
> 时间：2009-05-14T19:41:20.683
> 
> 标签：iphone, objective-c, xcode

我正在尝试使用一些代码为 iPhone App Icon 创建一个徽章编号。

我可以成功地做到这一点，但是我正在使用的代码（如下）非常糟糕并且可以很容易地做得更好，但是我没有能够做到这一点的逻辑知识。

这就是它正在做的...

1.  从 UITableView 中的第一条消息中获取用户的“ID”。然后它根据存储的 ID（从上次加载时的第一个对象）检查此 ID，并将徽章编号设为 1。
2.  然后检查消息中的第二个 ID 以查看它是否与存储的相同。如果不是，它将使徽章编号为 2。
3.  等等等等。

我想要它做的是自动检查 ID 并将“1”添加到徽章编号，直到找到具有正确 ID 的第一个帖子但是，我不太确定编码。

任何帮助都会很棒！

谢谢

（代码如下：）

```
 NSDictionary* tweetValues = [[NSDictionary alloc] init];
    tweetValues = [tweets objectAtIndex:1];
    NSString *newStatusID = [[tweetValues objectForKey:@"id"] stringValue];
    NSString *oldStatusID = [[NSUserDefaults standardUserDefaults] stringForKey:@"latestID"];
    [UIApplication sharedApplication].applicationIconBadgeNumber = 0;
    if([newStatusID isEqualToString:oldStatusID]){
        [UIApplication sharedApplication].applicationIconBadgeNumber = 0;
    } else {
        tweetValues = [tweets objectAtIndex:2];
        newStatusID = [[tweetValues objectForKey:@"id"] stringValue];

        if ([newStatusID isEqualToString:oldStatusID]){
            [UIApplication sharedApplication].applicationIconBadgeNumber = 1;
        }else{

            tweetValues = [tweets objectAtIndex:3];
            newStatusID = [[tweetValues objectForKey:@"id"] stringValue];

            if ([newStatusID isEqualToString:oldStatusID]){
                [UIApplication sharedApplication].applicationIconBadgeNumber = 2;
            }else{
                [UIApplication sharedApplication].applicationIconBadgeNumber = 3;
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T20:55:45.900

我最终做了以下似乎有效的事情：

```
 NSDate *dateRefreshed = [[NSUserDefaults standardUserDefaults] objectForKey:@"dateRefreshed"];

    [[NSUserDefaults standardUserDefaults] setObject:[NSDate date] forKey:@"dateRefreshed"];
    [[NSUserDefaults standardUserDefaults] synchronize];

    [UIApplication sharedApplication].applicationIconBadgeNumber = 0;

    for (NSDictionary *tweetValues in tweets) { // Iterate over all the tweetValues in tweets (assume tweets exist?)

        NSDate *dates = [tweetValues objectForKey:@"created_at"];

        NSTimeInterval sincePostDate = [[NSDate date] timeIntervalSinceDate: dates];    
        NSTimeInterval sinceNow = [[NSDate date] timeIntervalSinceDate: dateRefreshed];
        int timeDiff = sincePostDate;
        int timeSinceNow = sinceNow;

        if (timeDiff <= timeSinceNow){

             [UIApplication sharedApplication].applicationIconBadgeNumber++; // Increase the badge number by 1
        }

    } 
```

如果有人有更好的想法，请随时发布代码:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T20:05:43.010

我不确定您要做什么，但是查看您的代码我认为您需要使用[for](http://en.wikipedia.org/wiki/For_loop)循环。

您的代码的第一行也是泄漏。我不确定您要做什么。据我所知，您不必在这里创建一个空字典。

您检索 tweetValues ( `tweetValues = [tweets objectAtIndex:1];`) 的行也很奇怪。您正在检索索引 1 处的对象。由于数组是[零索引](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/doc/uid/20000137-279947)的，因此您正在检索数组中的第二个对象。如果你想检索你需要调用的第一个：`[tweets objectAtIndex:0];`

如果我必须重构您的代码，我可能会执行以下操作：

```
[UIApplication sharedApplication].applicationIconBadgeNumber = 0;

NSString *oldStatusID = [[NSUserDefaults standardUserDefaults] stringForKey:@"latestID"];
for (NSDictionary *tweetValues in tweets) { // Iterate over all the tweetValues in tweets (assume tweets exist?)

    NSString *newStatusID = [[tweetValues objectForKey:@"id"] stringValue];

    if ([oldStatusID isEqualToString:newStatusID]) {

        [UIApplication sharedApplication].applicationIconBadgeNumber++; // Increase the badge number by 1
    }
} 
```

我希望我正确地解释了你的代码。如果没有，更多的上下文可能会有用。

# c - 在控制台应用程序中获取 int 的最简单方法是什么？

> ID：865284
> 
> 赞同：14
> 
> 时间：2009-05-14T19:42:01.540
> 
> 标签：c, console, user-input

我想将用户输入作为整数处理，但似乎 C 无法从标准输入获取 int。有这样做的功能吗？我将如何从用户那里获得一个 int ？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-14T19:44:32.500

```
#include <stdio.h>

int n;
scanf ("%d",&n); 
```

见[http://www.cplusplus.com/reference/clibrary/cstdio/scanf/](http://www.cplusplus.com/reference/clibrary/cstdio/scanf/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T20:01:59.400

`scanf()`是答案，但你当然应该检查返回值，因为从外部输入解析数字时很多很多事情都会出错......

```
int num, nitems;

nitems = scanf("%d", &num);
if (nitems == EOF) {
    /* Handle EOF/Failure */
} else if (nitems == 0) {
    /* Handle no match */
} else {
    printf("Got %d\n", num);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T20:57:46.943

除了`(f)scanf`已在其他答案中充分讨论的 之外，还有`atoi`and `strtol`，用于您已经将输入读入字符串但想要将其转换为`int`or的情况`long`。

```
char *line;
scanf("%s", line);

int i = atoi(line);  /* Array of chars TO Integer */

long l = strtol(line, NULL, 10);  /* STRing (base 10) TO Long */
                                  /* base can be between 2 and 36 inclusive */ 
```

`strtol`推荐使用它，因为它允许您确定一个数字是否被成功读取（与 相反`atoi`，它无法报告任何错误，并且如果它给出垃圾则只会返回 0）。

```
char *strs[] = {"not a number", "10 and stuff", "42"};
int i;
for (i = 0; i < sizeof(strs) / sizeof(*strs); i++) {
    char *end;
    long l = strtol(strs[i], &end, 10);
    if (end == line)
        printf("wasn't a number\n");
    else if (end[0] != '\0')
        printf("trailing characters after number %l: %s\n", l, end);
    else
        printf("happy, exact parse of %l\n", l);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T19:48:04.487

标准库函数**scanf**用于格式化输入：%d int（d 是十进制的缩写）

```
#include <stdio.h>
int main(void)
{
  int number;
  printf("Enter a number from 1 to 1000: ");

  scanf("%d",&number); 
  printf("Your number is %d\n",number);
  return 0;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-14T19:45:16.243

```
#include <stdio.h>

main() {

    int i = 0;
    int k,j=10;

    i=scanf("%d%d%d",&j,&k,&i);
    printf("total values inputted %d\n",i);
    printf("The input values %d %d\n",j,k);

} 
```

从[这里](http://www.java2s.com/Code/C/Console/Readintvaluefromconsole.htm)

# iphone - 自定义 UIPageControl 视图，用“Page X of Y”替换点

> ID：865296
> 
> 赞同：13
> 
> 时间：2009-05-14T19:43:22.893
> 
> 标签：iphone, cocoa-touch, uikit

我正在尝试找到一种方法来用标题为“Y 页 X”的标题替换 UIPageControl 的点，因为我可能会有 >50 个项目。我刚刚开始熟悉 Cocoa，我想知道最好的方法是什么。我可以继承 UIPageControl 吗？我应该使用带有标签的自定义视图吗？或者是其他东西？

**编辑：**

我最终使用了 Matt Gallagher 的[这段](http://cocoawithlove.com/2009/01/multiple-virtual-pages-in-uiscrollview.html)代码来实现我的分页视图。它也更有效，因为它重用了两个视图，而不是像 Apple 的 PageControl 示例代码那样一次创建它们。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-11-22T04:49:52.197

编辑：

这个答案得到了几个赞成票。谢谢你，但对于所有来到这里的人，请意识到 UIPageControl*很容易自己实现*！更重要的是，请查看我的回复和下面的示例代码以获得一些想法，但您真的不应该在生产代码中使用它。如果您需要修改 UIPageControl 的外观和感觉，请滚动您自己的 UIControl 子类。

* * *

原始答案：

UIPageControl 没有做任何花哨的事情。对于大多数视图，视图本身要么在 drawRect: 中完成所有绘制，要么添加子视图并自行绘制。通过覆盖drawRect：而不是调用[super drawRect：]，您可以确保如果实现是基于drawRect：的，您将调用自己的绘图代码。对于 UIPageControl，它依赖于已添加到 UIPageControl 的子视图。你真的不需要知道是什么类型的，你也不应该关心。这是 Apple 的实施，可能会发生变化。

但是因为您知道它必须是 drawRect: 或基于子视图的，所以您可以简单地删除 UIPageControl 的子视图，然后您的 drawRect: 覆盖将按您的预期工作（大多数情况下，您必须做一点一些额外的工作以确保您在正确的时间重绘）。

这是一个示例，展示了如何制作您自己的自定义 UIPageControl。精明的读者会注意到，一旦您不小心以这种方式进行操作，您还不如创建自己的页面控件作为 UIControl 的子类并简单地实现 UIPageControl API。

```
//
//  RedGreyPageControl.m
//

@interface RedGreyPageControl : UIPageControl {
    NSArray                     *originalSubviews;
}

@end

@implementation RedGreyPageControl

// This assumes you're creating the control from a nib.  Depending on your
// usage you might do this step in initWithFrame:
- (void) awakeFromNib {
    // retain original subviews in case apple's implementation
    // relies on the retain count being maintained by the view's
    // presence in its superview.
    originalSubviews = [[NSArray alloc] initWithArray: self.subviews];

    for ( UIView *view in self.subviews ) [view removeFromSuperview];

    // make sure the view is redrawn not scaled when the device is rotated
    self.contentMode = UIViewContentModeRedraw;
}

- (void) dealloc {
    [originalSubviews release];
    [super dealloc];
}

- (void) drawRect:(CGRect) iRect {
    UIImage                 *grey, *image, *red;
    int                     i;
    CGRect                  rect;

    const CGFloat           kSpacing = 10.0;

    iRect = self.bounds;

    if ( self.opaque ) {
        [self.backgroundColor set];
        UIRectFill( iRect );
    }

    if ( self.hidesForSinglePage && self.numberOfPages == 1 ) return;

    red = [UIImage imageNamed: @"circle_graphic_red.png"];
    grey = [UIImage imageNamed: @"circle_graphic_grey.png"];

    rect.size.height = red.size.height;
    rect.size.width = self.numberOfPages * red.size.width + ( self.numberOfPages - 1 ) * kSpacing;
    rect.origin.x = floorf( ( iRect.size.width - rect.size.width ) / 2.0 );
    rect.origin.y = floorf( ( iRect.size.height - rect.size.height ) / 2.0 );
    rect.size.width = red.size.width;

    for ( i = 0; i < self.numberOfPages; ++i ) {
        image = i == self.currentPage ? red : grey;

        [image drawInRect: rect];

        rect.origin.x += red.size.width + kSpacing;
    }
}

// you must override the setCurrentPage: and setNumberOfPages:
// methods to ensure that your control is redrawn when its values change
- (void) setCurrentPage:(NSInteger) iPage {
    [super setCurrentPage: iPage];
    [self setNeedsDisplay];
}

- (void) setNumberOfPages:(NSInteger) iPages {
    [super setNumberOfPages: iPages];
    [self setNeedsDisplay];
}

@end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T20:25:44.803

我认为编写自定义页面控件不会违反人机界面指南。我认为显示> 50个点会;）

我认为这是完全可以接受的双向。

您可以创建 UIPageControl 的自定义子类并覆盖默认的点绘制行为。您必须小心不要覆盖您*确实*需要的其他行为。

或者，由于 UIPageControl 类的重新实现并不复杂，并且编写一个全新的类将确保您在覆盖点绘制逻辑时不会覆盖您需要的行为，您可以重新实现它。如果这样做，请尝试使用 Apple 的变量命名。这样，每个人都会立即知道如何使用您的课程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T00:28:29.260

只需使用 UILabel 并在滚动委托中使用格式字符串设置其文本，上面写着“Page N of K”或类似的内容。可以用简单的透明`UIButton`s 添加不可见的左/右按钮。

如果您真的想自己编写 UIControl 子类，由您决定......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-19T16:11:29.190

此外，我应该为任何考虑子类化 UIPageControl 的人添加（因为我（不幸地）*在*这样做之后来到这里），由于某些愚蠢的原因，该类不会在 drawRect: 或任何其他公共方法中进行绘图。我怀疑在页面更新期间的某个时候它会设置一个绘图上下文并用它的点填充它，但我在这里警告你：

*   您不能在 UIPageControl 中覆盖 drawRect: 以便绘制自定义点而不是标准点。即使你让你的绘制矩形来绘制你的点，UIPageControl*总是*会（耶！）绘制它的小白点。

这使得该类本质上是不可子类化的。当然，你可以，但为什么呢？

更重要的是，*为什么*苹果会开一个行为如此荒谬的类？！drawRect：是有原因的！这让我想起了在图像浏览器之前的日子里使用 NSMatrix...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T21:43:52.027

尽管您可以继承 UIPageControl，但我认为它不会添加任何内容。我建议你子类 UIControll 并将你的 API 建立在 UIPAgeControl 的 API 上。我认为用户界面将是相同的。

您可以添加属性来控制文本，但可能不需要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-18T14:59:10.473

我找到了一个不错的自定义页面控件类：[DDPageControl](http://ddeville.me/2011/01/ddpagecontrol-a-custom-uipagecontrol/)

它的行为与 UIPageControl 相同，您可以自定义它...

# asp.net - 自定义 DetailsView 命令栏

> ID：865306
> 
> 赞同：0
> 
> 时间：2009-05-14T19:45:28.597
> 
> 标签：asp.net

我只是想在插入或编辑项目时添加一些 Javascript 检查。我知道的唯一方法（使用内联 Javascript）是禁用 DetailsView 的 AutoGenerateXxxButton 属性并自己制作。我遇到的问题是用自定义 LinkBut​​tons 替换它们（并保持默认操作）并向它们添加 Javascript。有没有办法可以轻松做到这一点？我看到的唯一选择是编辑模板并将它们放在页脚或其他东西中。

提示？诡计？我缺少的明显的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-06T19:17:47.827

我在详细信息视图上搜索其他一些问题时遇到了这种诡计。相对容易做的是将那个字段变成模板字段。下面是一些将删除命令行转换为模板字段的代码：

```
<asp:TemplateField ShowHeader="False">
    <ItemTemplate>
         <asp:LinkButton ID="btnDelete" runat="server" CausesValidation="False" 
                         CommandName="Delete" Text="Delete"></asp:LinkButton>
    </ItemTemplate>
</asp:TemplateField> 
```

您可以将链接的任何标记放在模板字段中...

现在，要将一些 JavaScript 添加到该删除按钮，您可以在 DetailsView 的 DataBound 事件处理程序中执行此操作：

```
Protected Sub dgFileDetails_DataBound(ByVal sender As Object, ByVal e As System.EventArgs) Handles dgFileDetails.DataBound
    Dim btnDelete As LinkButton = CType(dgFileDetails.FindControl("btnDelete"), LinkButton)
    If Not btnDelete Is Nothing Then
       btnDelete.OnClientClick = String.Format("return confirm('Are you sure you want to delete the division {0}?');", dgFileDetails.DataKey.Value)
    End If
End Sub 
```

我知道这适用于删除按钮，但您也应该能够从插入和更新按钮中获取这个概念。

# php - php代码气味检测器

> ID：865313
> 
> 赞同：4
> 
> 时间：2009-05-14T19:46:41.793
> 
> 标签：php, refactoring, automated-refactoring

关于[http://c2.com/cgi/wiki?DetectingCodeSmellsInPhp上的 php 代码气味检测器](http://c2.com/cgi/wiki?DetectingCodeSmellsInPhp)

当我在我的网络浏览器中打开它时，我得到一个错误，但是当我在我的 IDE 中打开它时，我没有。

如何纠正它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T01:31:10.217

在解决停止问题的同一天，可以用代码检测到明确的代码气味。`*takes off joke hat*`

他只是在为他认为不好的代码设置一些参数。这是错误的（imo）

具有等于​​或多于 4 个参数是代码异味吗？他自己在代码气味检测器中有那个！

一个函数超过 20 行是代码异味？这个代码气味检测器的主要功能是 49 行代码！！

代码异味不是您可以编程的东西，在某些情况下，执行某些功能的最佳方式是非标准方式（无论那种方式是什么），而在其他情况下则不是。你只需要相信你的直觉，按照弗兰克法默在上面的评论中所说的去做。就拿个好妻子吧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T06:13:33.797

如果您想要代码嗅探器，请使用[Pears PHP_CodeSniffer](http://pear.php.net/package/PHP_CodeSniffer)。它允许您定义自己的规则、您自己的规则集等。

> PHP_CodeSniffer 是一个 PHP5 脚本，它对 PHP、JavaScript 和 CSS 文件进行标记和“嗅探”，以检测是否违反了定义的编码标准。它是一种必不可少的开发工具，可确保您的代码保持干净和一致。它还可以帮助防止开发人员犯一些常见的语义错误。
> 
> PHP_CodeSniffer 中的编码标准是嗅探文件的集合。每个嗅探文件仅检查编码标准的一部分。

使用起来很有趣（尝试编写一个符合 PEAR 标准的函数）并强制代码库至少保持一定的一致性。

*它不能保证代码质量，但它可能会有所帮助*

# css - Div 在 IE 7 中占据整个宽度（具有右浮动块元素子元素）

> ID：865314
> 
> 赞同：1
> 
> 时间：2009-05-14T19:46:47.220
> 
> 标签：css

我在父 div 中有一些右浮动块元素（带有 display:block 的锚元素，因为我需要在它们上设置高度）。

父 div 周围还有其他标记（父 div 应该充当工具栏，链接作为按钮）

这种安排在除 IE7 之外的所有浏览器中都能正常工作，在 IE7 中，不是将父 div 调整为它的父级，而是 div 占据了页面上的整个宽度。

这是 IE7 上的已知错误吗？我曾尝试在父 div 上应用 clearfix，但这似乎不起作用。

我在这里粘贴了标记和 CSS：http: [//pastebin.com/m37ffbdf9](http://pastebin.com/m37ffbdf9)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T19:57:27.633

对于浮动设置为非无值的元素，将忽略显示样式属性。你尝试在父 div 上设置 position:relative 吗？

# asp.net - 我应该遵循哪种设计模式来开发 asp.net 应用程序？

> ID：865328
> 
> 赞同：1
> 
> 时间：2009-05-14T19:48:20.867
> 
> 标签：asp.net

有许多设计模式可用于开发 asp.net 站点。每一种设计模式都有其优缺点。我想使用 asp.net 开发高性能应用程序。我应该遵循哪种模式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T20:11:26.880

我今天看到的最佳实践将所有业务逻辑与表示层分离。经典的 ASP.NET Webforms 往往使这变得更加困难并鼓励惰性编程，因为您可以使用页面外的所有事件，而不是强制良好的代码分离和单一职责原则。

如果您要使用 ASP.NET MVC 框架，您很可能拥有一个有助于更好编码实践的结构。但是，您仍然可以找到回退到 webforms 编码风格的方法。

如果您专注于**[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)**和**[ASP.NET MVC](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.asp.net%2Fmvc%2F&ei=2HsMSrrdLJq6tAOhm-XpAg&usg=AFQjCNG1FWlq5gZ1lBZOIcCgJoB9yLn9pA&sig2=FQd0g1vrJbPQeCjuryuqbA)**，您将有一个良好的开端。 **[领域驱动设计](http://en.wikipedia.org/wiki/Domain-driven_design)**也可能值得一看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T19:50:42.063

我会选择 ASP.NET MVC。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T19:55:48.683

它可以取决于应用程序的目的和目标。它会以用户为中心吗？漂亮/阿贾克斯？SOAP 服务？

设计模式是为了让生活更简单。如果你弄错了，那么它很可能会让生活变得更艰难。架构模式、行为模式、结构模式和数据语义只能在应用程序**功能**的上下文中决定，最终哪种形式是它的奴隶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T19:51:19.380

[模型-视图-控制器（MVC）](http://en.wikipedia.org/wiki/Model-view-controller)是一种流行的用于开发这类东西的方法

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T20:07:44.287

模式和实践中提供了一本非常好的免费[架构指南。](http://www.codeplex.com/AppArchGuide)它详细讨论了许多不同的模式以及它们可用于开发 ASP.NET（和许多其他类型的）应用程序的位置。

# algorithm - 测量数据质量的技术和实践是什么？

> ID：865329
> 
> 赞同：2
> 
> 时间：2009-05-14T19:48:43.347
> 
> 标签：algorithm, artificial-intelligence, data-quality

如果我有大量描述物理“事物”的数据，我该如何衡量这些数据与它应该代表的“事物”的匹配程度？

一个例子是，如果我有一个装有 12 个小部件的板条箱，并且我知道每个小部件重 1 磅，那么应该有一些数据质量“检查”以确保箱子重 13 磅。

另一个例子是，如果我有一盏灯和一个代表该灯的图像，它应该看起来像一盏灯。也许图像尺寸应该与灯尺寸具有相同的比例。

除了图像，我的数据是 99% 的文本（包括高度、宽度、颜色……）。

我在学校学习过人工智能，但除此之外几乎没有做过什么。

标准的人工智能技术是可行的吗？如果是这样，我如何将问题映射到算法？某些语言在这方面是否比其他语言更容易？他们有更好的图书馆吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T21:04:09.063

您的问题有点开放式，但听起来您想要的是[机器学习](http://en.wikipedia.org/wiki/Machine_learning)领域中所谓的“[分类器](http://en.wikipedia.org/wiki/Statistical_classification)” 。

通常，分类器接受一个输入并对其进行“分类”，即：确定对象的类别。许多分类器提供了这种确定的概率，有些分类器甚至可能返回多个类别，每个类别都有概率。

分类器的一些示例是[贝叶斯网络](http://en.wikipedia.org/wiki/Bayesian_network)、神经网络、决策列表和[决策树](http://en.wikipedia.org/wiki/Decision_tree_learning)。贝叶斯网络通常用于垃圾邮件分类。电子邮件有可能被归类为“垃圾邮件”或“非垃圾邮件”。

对于您的问题，您希望将您的对象分类为“高质量”或“非高质量”。

您需要的第一件事是一堆训练数据。也就是说，您已经知道正确分类的一组对象。获得这一点的一种方法是获取一堆对象并手动对其进行分类。如果一个人无法分类的物体太多，您可以将它们提供给[Mechanical Turk](https://www.mturk.com/mturk/welcome)。

获得训练数据后，您将构建分类器。您需要弄清楚哪些属性对您的分类很重要。你可能需要做一些实验来看看什么效果很好。然后你让你的分类器从你的训练数据中学习。

一种经常用于测试的方法是将训练数据分成两组。使用其中一个子集训练您的分类器，然后查看它对另一个（通常较小）子集的分类效果如何。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T21:09:54.900

人工智能是一条路，自然智能是另一条路。

您的挑战与亚马逊的 Mechanical Turk 完美匹配。将您的数据空间划分为极小的可验证原子，并将它们分配为 Mechanical Turk 上的 HIT。有一些重叠，让自己对 HIT 答案的一致性有一种感觉。

有一家商店有一大堆需要按相似度分组的组件 CAD 图纸。他们将其分解并在 Mechanical Turk 上放开，取得了非常令人满意的结果。我可以用谷歌搜索几个小时，但再也找不到那个链接了。

有关相关论坛帖子，请参见[此处](http://forums.spatial.com/t5/Academic-Facets-News-and-Views/Crowdsourcing-for-CAD-CAM/ba-p/403;jsessionid=695FAAB479F07F4CCD0057395C80F59E)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T20:13:29.403

这是一个艰难的答案。例如，什么定义了一盏灯？我可以用谷歌搜索一些看起来很疯狂的灯的图片。甚至，查找灯的定义（[http://dictionary.reference.com/dic?q=lamp](http://dictionary.reference.com/dic?q=lamp)）。对灯的外观没有物理要求。这就是人工智能问题的症结所在。

至于数据，您可以在项目上设置单元测试，以确保 12 个 widget() 在 WidetBox() 中的重量小于 13 磅。无论如何，您需要手头有数据才能测试类似的东西。

我希望我能够稍微回答你的问题。它有点模糊，我的答案很广泛，但希望它至少能给你一个好的方向。

# c - 何时/为什么使用 fscanf() 函数是个坏主意？

> ID：865335
> 
> 赞同：6
> 
> 时间：2009-05-14T19:49:24.237
> 
> 标签：c, pointers, file-io

在[答案](https://stackoverflow.com/questions/861793/trouble-reading-a-line-using-fscanf/861822#861822)中有一个有趣的陈述：“使用该函数几乎*总是*`fscanf()`一个坏主意，因为它可以在失败时将您的文件指针留在未知位置。我更喜欢用它`fgets()`来获取每一行然后`sscanf()`那个。”

您能否详细说明何时/为什么使用`fgets()`和`sscanf()`读取某些文件可能会更好？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-14T19:55:22.210

想象一个包含三行的文件：

```
 1
   2b
   c 
```

用于`fscanf()`读取整数，第一行会读得很好，但在第二行`fscanf()`会让你留在'b'，不知道从那里做什么。您需要一些机制来越过垃圾输入以查看第三行。

如果你做一个`fgets()`and `sscanf()`，你可以保证你的文件指针一次移动一行，这更容易处理。通常，您仍应查看整个字符串以报告其中的任何奇数字符。

我自己更喜欢后一种方法，尽管我不同意“使用它几乎总是一个坏主意`fscanf()`”的说法......`fscanf()`对于大多数事情来说都很好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T21:38:28.577

这发挥作用的情况是当您匹配字符文字时。假设你有：

```
int n = fscanf(fp, "%d,%d", &i1, &i2); 
```

考虑两个可能的输入“ `323,A424`”和“ `323A424`”。

在这两种情况下`fscanf()`都将返回 1 并且读取的下一个字符将是`'A'`. 无法确定逗号是否匹配。

话虽如此，这仅在找到错误的实际来源很重要时才重要。在知道存在格式错误的输入错误就足够的情况下，`fscanf()`实际上优于编写自定义解析代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T19:57:35.543

当 fscanf() 失败时，由于输入失败或匹配失败，文件指针（即文件中下一个字节将被读取的位置）被留在一个位置，而不是它的位置fscanf() 成功。这在顺序文件读取中通常是不可取的。一次读取一行导致文件输入是可预测的，而单行故障可以单独处理。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-14T18:42:23.530

有两个原因：

*   `scanf()``stdin`可以在难以预测的状态下离开；如果不是不可能的话，这会使错误恢复变得困难（这不是问题`fscanf()`）；和
*   整个`scanf()`系列都将指针作为参数，但没有长度限制，因此它们可以超出缓冲区并更改恰好位于缓冲区之后的不相关变量，从而导致看似随机的内存损坏错误，很难理解、查找和调试，特别是对于经验较少的*C*程序员。

新手*C*程序员经常对指针和“address-of”运算符感到困惑，并且经常忽略`&`需要它的地方，或者在不需要的地方“为了更好的衡量标准”添加它。这会导致他们很难找到的“随机”段错误。这不是`scanf()`错，所以我把它从我的清单中删除，但值得牢记。

23 年后，我*仍然*记得当我开始*C*编程并且不知道如何识别和调试这些错误时，我感到非常痛苦，而且（作为一个花了数年时间向初学者教授*C*的人）很难解释它们对于还不了解指针和堆栈的新手。

任何向*C*`scanf()`程序员新手推荐的人都应该受到无情的鞭打。

 *好吧，也许不是*无情*，但某种鞭刑绝对是为了；o）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T20:09:08.743

> 使用该`fscanf()`函数几乎总是一个坏主意，因为它会使您的文件指针在失败时留在未知位置。我更喜欢使用`fgets()`让每一行进入然后`sscanf()`那个。

您始终可以使用`ftell()`来找出文件中的当前位置，然后从那里决定要做什么。基本上，如果您知道可以期待什么，那么请随意使用`fscanf()`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T19:56:48.943

基本上，没有办法告诉该函数*不要*超出您为其分配的内存区域的范围。

已经出现了许多替代品，例如 fnscanf，它试图通过指定读者写入的最大限制来修复这些功能，从而使其不会溢出。

# mysql - MySQL 多重右连接

> ID：865338
> 
> 赞同：1
> 
> 时间：2009-05-14T19:49:48.307
> 
> 标签：mysql, join

```
mysql> select * from product;
+------------+---------------+
| product_id | name          |
+------------+---------------+
|          1 | Car           | 
|          2 | House         | 
|          3 | Cat           | 
|          4 | Blank Product | 
+------------+---------------+
4 rows in set (0.00 sec)

mysql> select * from tag;
+--------+-----------+
| tag_id | name      |
+--------+-----------+
|      1 | Expensive | 
|      2 | Fast      | 
|      3 | Mean      | 
|      4 | Large     | 
|      5 | Small     | 
|      6 | Alive     | 
|      7 | Blank Tag | 
+--------+-----------+
7 rows in set (0.00 sec)

mysql> select * from product_tag;
+------------+--------+
| product_id | tag_id |
+------------+--------+
|          1 |      1 | 
|          1 |      2 | 
|          1 |      3 | 
|          1 |      4 | 
|          2 |      1 | 
|          2 |      4 | 
|          3 |      2 | 
|          3 |      3 | 
|          3 |      5 | 
|          3 |      6 | 
+------------+--------+
10 rows in set (0.00 sec) 
```

为什么以下查询返回我的空白标签而不是我的空白产品？

```
mysql> select * from product_tag right join product using (product_id)
                                 right join tag using (tag_id);
+--------+-----------+------------+-------+
| tag_id | name      | product_id | name  |
+--------+-----------+------------+-------+
|      1 | Expensive |          1 | Car   | 
|      1 | Expensive |          2 | House | 
|      2 | Fast      |          1 | Car   | 
|      2 | Fast      |          3 | Cat   | 
|      3 | Mean      |          1 | Car   | 
|      3 | Mean      |          3 | Cat   | 
|      4 | Large     |          1 | Car   | 
|      4 | Large     |          2 | House | 
|      5 | Small     |          3 | Cat   | 
|      6 | Alive     |          3 | Cat   | 
|      7 | Blank Tag |       NULL | NULL  | 
+--------+-----------+------------+-------+
11 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T20:15:51.270

您正在使用正确的连接。在您的查询标签中，ID 是 MySQL 开始匹配的基础。右连接从右到左进行评估。如果您将查询分为两部分。第一个将是：

```
select * from product_tag right join tag using (tag_id);
+--------+-----------+------------+
| tag_id | name      | product_id |
+--------+-----------+------------+
|      1 | expensive |          1 | 
|      1 | expensive |          2 | 
|      2 | fast      |          1 | 
|      2 | fast      |          3 | 
|      3 | mean      |          1 | 
|      3 | mean      |          3 | 
|      4 | larg      |          1 | 
|      4 | larg      |          2 | 
|      5 | small     |          3 | 
|      6 | alive     |          3 | 
|      7 | blank tag |       NULL | 

+--------+-----------+------------+ 
```

如您所见，没有与空白标签匹配的 product_id。解释了为什么将这个结果与产品表连接起来会给你你看到的结果。

如果你改用左连接，你会得到这个结果：

```
select * from product_tag left join product using (product_id) left join tag using (tag_id);

+--------+------------+-------+-----------+
| tag_id | product_id | name  | name      |
+--------+------------+-------+-----------+
|      1 |          1 | car   | expensive | 
|      2 |          1 | car   | fast      | 
|      3 |          1 | car   | mean      | 
|      4 |          1 | car   | larg      | 
|      1 |          2 | house | expensive | 
|      4 |          2 | house | larg      | 
|      2 |          3 | cat   | fast      | 
|      3 |          3 | cat   | mean      | 
|      5 |          3 | cat   | small     | 
|      6 |          3 | cat   | alive     | 
+--------+------------+-------+-----------+ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T19:55:35.623

没有将产品 ID 4 与标签相关联的行。您需要向 product_tag 表中添加一行，如下所示：

```
+------------+--------+
| product_id | tag_id |
+------------+--------+
|          4 |      7 | 
+------------+--------+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T20:41:17.810

您正在使用 RIGHT JOIN，因此即使连接表中没有匹配项，也会返回正确表中的所有行，即“标记”。

# wpf - 来自包含控件的 WPF 访问信息

> ID：865339
> 
> 赞同：0
> 
> 时间：2009-05-14T19:49:48.447
> 
> 标签：wpf, user-controls

我有一个带有堆栈面板的 UserControl(a)，它的 ItemSource 设置为一个集合。StackPanel 然后包含一组 UserControl(b)，其中包含一些按钮和一个数据网格控件。有没有办法从 UserControl(b) 后面的代码中访问父 UserControl(a) 后面的代码中的属性。

基本上，当将 UserControl(a) 加载到窗口中时，会传入一个参数，其中包含表单是否被视为只读。我想将 Usercontrol(b) 中按钮的可见性绑定到父 UserControl(a) 的代码隐藏中的只读属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T20:13:28.967

通常使用 WPF 我建议您实现 Model-View-ViewModel 模式（请参阅[MSDN](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)）。

使用此模式，您将创建一个 ViewModel，其中包含要绑定的所有数据。这将被设置为 (a) 用户控件的数据上下文。然后，该控件会将其所有控件绑定到数据上下文上的属性。

子 (b) 用户控件将继承此数据上下文，因此可以将其控件绑定到 (a) 使用的相同属性。这是因为数据上下文是沿逻辑（和可视）树继承的，直到它被覆盖为止。

因此，对于您来说，我将考虑创建一个包含 ReadOnly 属性的 ViewModel。然后，您可以将此 ViewModel 对象设置为 (a) 用户控件的数据上下文。(b) 用户控件，因为它在 (a) 用户控件层次结构下，将继承相同的数据上下文。然后，这将允许您将 (b) 中的控件绑定到与 (a) 相同的属性，如下所示。

```
<Button IsEnabled="{Binding ReadOnly}"
    Context="Click me!"
    Command="{Binding ClickMeCommand}" /> 
```

要在视图代码隐藏中设置数据上下文，我执行如下所示的构造函数。

```
public MyView(IMyViewModel viewModel)
{
    InitializeComponent();
    DataContext = viewModel;
} 
```

MyView 是从您的实例中的 UserControl 继承的类。您不必以我的方式获取视图模型，我使用 Unity 将视图模型注入到自动构建的视图中，因为我使用的是 Prism，但您可以将其创建为普通对象并分配它到数据上下文。

请注意，我还使用 datacontext 将命令绑定到按钮，因为我通常也通过 ViewModel 公开这些命令，如果您创建一个实现 ICommand 的包装类并代理到​​委托，这很容易。如果您有兴趣，请参阅[DelegateCommand 博客文章或查看](http://kentb.blogspot.com/2009/04/mvvm-infrastructure-delegatecommand.html)[Prism](http://compositewpf.codeplex.com/)中的 DelegateCommand 类。

如果由于某种原因您确实覆盖了数据上下文，这可能在使用主/详细视图时发生，您将视图的详细信息部分的数据上下文更改为列表中当前选定的项目，那么您仍然可以访问父数据上下文通过使用相对源绑定。

例如

```
<ComboBox Grid.Row="1" Grid.Column="1" x:Name="Unit" IsReadOnly="True"
      ItemsSource="{Binding Path=DataContext.AvailableUnits, RelativeSource=
                   {RelativeSource Mode=FindAncestor,
                                   AncestorType={x:Type Window}}}"
      DisplayMemberPath="Name" SelectedItem="{Binding Unit}" /> 
```

请注意，ItemsSource 绑定使用相对源来查找父窗口，然后绑定到它的数据上下文的属性。为了清楚起见，我还将引号内的 ItemsSource 绑定拆分为多行，但不要在您的 xaml 中这样做，我不确定它是否会在那里工作（没有尝试查看标记扩展是否可以容忍空格）。

# c# - VSTO 2007：如何确定 Range 的页码和段落号？

> ID：865340
> 
> 赞同：2
> 
> 时间：2009-05-14T19:49:52.860
> 
> 标签：c#, ms-word, vsto

我正在构建一个 MS Word 加载项，它必须从文档中收集所有评论气球并将它们总结在一个列表中。我的结果将是 ReviewItem 类的列表，其中包含 Comment 本身、段落编号和注释文本所在的页码。

我的部分代码如下所示：

```
 private static List<ReviewItem> FindComments()
    {
        List<ReviewItem> result = new List<ReviewItem>();
        foreach (Comment c in WorkingDoc.Comments)
        {
            ReviewItem item = new ReviewItem()
            {
                Remark = c.Reference.Text,
                Paragraph = c.Scope. ???, // How to determine the paragraph number?
                Page = c.Scope. ??? // How to determine the page number?
            };
            result.Add(item);
        }
        return result;
   } 
```

类的`Scope`属性`Comment`指向文档中评论所涉及的实际文本，并且类型为`Microsoft.Office.Interop.Word.Range`。我不知道如何确定该范围位于哪个页面和哪个段落。

对于段落编号，我实际上是指段落的“编号列表”编号，例如“2.3”或“1.3.2”。

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-15T04:18:39.050

试试这个页码：

```
Page = c.Scope.Information(wdActiveEndPageNumber); 
```

这应该为您提供范围结束值的页码。如果您想要开头的页面值，请先尝试以下操作：

```
Word.Range rng = c.Scope.Collapse(wdCollapseStart);
Page = rng.Information(wdActiveEndPageNumber); 
```

*   [Range.Information 属性](http://msdn.microsoft.com/en-us/library/bb256015.aspx)
*   [WdInformation 枚举](http://msdn.microsoft.com/en-us/library/bb213848.aspx)

对于段落编号，看看你能从中得到什么：

```
c.Scope.Paragraphs; //Returns a paragraphs collection 
```

我的猜测是获取上面返回的集合中的第一个段落对象，获取从该段落末尾到文档开头的新范围，并获取它的整数值：

```
[range].Paragraphs.Count; //Returns int 
```

这应该给出注释范围开头的准确段落编号。

*   [范围.段落](http://msdn.microsoft.com/en-us/library/bb256026.aspx)
*   [段落对象成员](http://msdn.microsoft.com/en-us/library/bb257689.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-20T18:26:21.100

在 Mike Regan 在他的回答中给我的帮助下（再次感谢 Mike），我设法制定了一个我想在这里分享的解决方案。也许这也阐明了我的目标是什么。就性能而言，这可能不是最快或最有效的解决方案。随时提出改进建议。

我的代码的结果是 ReviewItem 类的列表，将在其他地方处理。废话不多说，代码如下：

```
/// <summary>
/// Worker class that collects comments from a Word document and exports them as ReviewItems
/// </summary>
internal class ReviewItemCollector
{
    /// <summary>
    /// Working document
    /// </summary>
    private Word.Document WorkingDoc = new Word.DocumentClass();

    /// <summary>
    /// Extracts the review results from a Word document
    /// </summary>
    /// <param name="fileName">Fully qualified path of the file to be evaluated</param>
    /// <returns></returns>
    public ReviewResult GetReviewResults(string fileName)
    {
        Word.Application wordApp = null;
        List<ReviewItem> reviewItems = new List<ReviewItem>();

        object missing = System.Reflection.Missing.Value;

        try
        {
            // Fire up Word
            wordApp = new Word.ApplicationClass();

            // Some object variables because the Word API requires this
            object fileNameForWord = fileName;
            object readOnly = true;

            WorkingDoc = wordApp.Documents.Open(ref fileNameForWord,
                ref missing, ref readOnly,
                ref missing, ref missing, ref missing, ref missing, ref missing,
                ref missing, ref missing, ref missing, ref missing, ref missing,
                ref missing, ref missing, ref missing);

            // Gather all paragraphs that are chapter headers, sorted by their start position
            var headers = (from Word.Paragraph p in WorkingDoc.Paragraphs
                           where IsHeading(p)
                           select new Heading()
                           {
                               Text = GetHeading(p),
                               Start = p.Range.Start
                           }).ToList().OrderBy(h => h.Start);

            reviewItems.AddRange(FindComments(headers));

            // I will be doing similar things with Revisions in the document
        }
        catch (Exception x)
        {
            MessageBox.Show(x.ToString(), 
                "Error while collecting review items", 
                MessageBoxButtons.OK, 
                MessageBoxIcon.Error);
        }
        finally
        {
            if (wordApp != null)
            {
                object doNotSave = Word.WdSaveOptions.wdDoNotSaveChanges;
                wordApp.Quit(ref doNotSave, ref missing, ref missing);
            }
        }
        ReviewResult result = new ReviewResult();
        result.Items = reviewItems.OrderBy(i => i.Position);
        return result;
    }

    /// <summary>
    /// Finds all comments in the document and converts them to review items
    /// </summary>
    /// <returns>List of ReviewItems generated from comments</returns>
    private List<ReviewItem> FindComments(IOrderedEnumerable<Heading> headers)
    {
        List<ReviewItem> result = new List<ReviewItem>();

        // Generate ReviewItems from the comments in the documents
        var reviewItems = from Word.Comment c in WorkingDoc.Comments
                          select new ReviewItem()
                          {
                              Position = c.Scope.Start,
                              Page = GetPageNumberOfRange(c.Scope),
                              Paragraph = GetHeaderForRange(headers, c.Scope),
                              Description = c.Range.Text,
                              ItemType = DetermineCommentType(c)
                          };

        return reviewItems.ToList();
    }

    /// <summary>
    /// Brute force translation of comment type based on the contents...
    /// </summary>
    /// <param name="c"></param>
    /// <returns></returns>
    private static string DetermineCommentType(Word.Comment c)
    {
        // This code is very specific to my solution, might be made more flexible/configurable
        // For now, this works :-)

        string text = c.Range.Text.ToLower();

        if (text.EndsWith("?"))
        {
            return "Vraag";
        }
        if (text.Contains("spelling") || text.Contains("spelfout"))
        {
            return "Spelling";
        }
        if (text.Contains("typfout") || text.Contains("typefout"))
        {
            return "Typefout";
        }
        if (text.ToLower().Contains("omissie"))
        {
            return "Omissie";
        }

        return "Opmerking";
    }

    /// <summary>
    /// Determine the last header before the given range's start position. That would be the chapter the range is part of.
    /// </summary>
    /// <param name="headings">List of headings as identified in the document.</param>
    /// <param name="range">The current range</param>
    /// <returns></returns>
    private static string GetHeaderForRange(IEnumerable<Heading> headings, Word.Range range)
    {
        var found = (from h in headings
                     where h.Start <= range.Start
                     select h).LastOrDefault();

        if (found != null)
        {
            return found.Text;
        }
        return "Unknown";
    }

    /// <summary>
    /// Identifies whether a paragraph is a heading, based on its styling.
    /// Note: the documents we're reviewing are always in a certain format, we can assume that headers
    /// have a style named "Heading..." or "Kop..."
    /// </summary>
    /// <param name="paragraph">The paragraph to be evaluated.</param>
    /// <returns></returns>
    private static bool IsHeading(Word.Paragraph paragraph)
    {
        Word.Style style = paragraph.get_Style() as Word.Style;
        return (style != null && style.NameLocal.StartsWith("Heading") || style.NameLocal.StartsWith("Kop"));
    }

    /// <summary>
    /// Translates a paragraph into the form we want to see: preferably the chapter/paragraph number, otherwise the
    /// title itself will do.
    /// </summary>
    /// <param name="paragraph">The paragraph to be translated</param>
    /// <returns></returns>
    private static string GetHeading(Word.Paragraph paragraph)
    {
        string heading = "";

        // Try to get the list number, otherwise just take the entire heading text
        heading = paragraph.Range.ListFormat.ListString;
        if (string.IsNullOrEmpty(heading))
        {
            heading = paragraph.Range.Text;
            heading = Regex.Replace(heading, "\\s+$", "");
        }
        return heading;
    }

    /// <summary>
    /// Determines the pagenumber of a range.
    /// </summary>
    /// <param name="range">The range to be located.</param>
    /// <returns></returns>
    private static int GetPageNumberOfRange(Word.Range range)
    {
        return (int)range.get_Information(Word.WdInformation.wdActiveEndPageNumber);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-07T02:17:08.907

我认为有一个更简单的方法。您可以从`Range`对象本身获取它。为`Range.get_Information`您提供页号、行号等信息，**除非您知道该范围跨越了多少页或行。**这就是问题所在，范围不必在一页中。

所以你可以得到一个范围的起点和终点，然后计算页码或行号等。这应该是：

```
public static void GetStartAndEndPageNumbers(Word.Range range, out int startPageNo,
                                             out int endPageNo)
{
    Word.Range rngStart;
    Word.Range rngEnd;
    GetStartAndEndRange(range, rngStart, rngEnd);

    startPageNo = GetPageNumber(rngStart);
    endPageNo = rngEnd != null ? GetPageNumber(rngEnd) : startPageNo;
}

static void GetStartAndEndRange(Word.Range range, out Word.Range rngStart,
                                out Word.Range rngEnd)
{
    object posStart = range.Start, posEnd = range.End;

    rngStart = range.Document.Range(ref posStart, ref posStart);

    try
    {
        rngEnd = range.Document.Range(ref posEnd, ref posEnd);
    }
    catch
    {
        rngEnd = null;
    }
}

static int GetPageNumber(Word.Range range)
{
    return (int)range.get_Information(Word.WdInformation.wdActiveEndPageNumber);
} 
```

你也可以对行号做同样的事情：

```
public static void GetStartAndEndLineNumbers(Word.Range range, out int startLineNo,
                                              out int endLineNo)
{
    Word.Range rngStart;
    Word.Range rngEnd;
    GetStartAndEndRange(range, rngStart, rngEnd);

    startLineNo = GetLineNumber(rngStart);
    endLineNo = rngEnd != null ? GetLineNumber(rngEnd) : startLineNo;
}

static int GetLineNumber(Word.Range range)
{
    return (int)range.get_Information(Word.WdInformation.wdFirstCharacterLineNumber);
} 
```

# asp.net - 是否有功能兼容的替代 asp:ListView？

> ID：865342
> 
> 赞同：1
> 
> 时间：2009-05-14T19:50:03.953
> 
> 标签：asp.net, listview, repeater

ASP.NET 3.5 附带的 asp:ListView 控件是否有功能兼容的替代方案？由于[最近](http://forums.asp.net/t/1422864.aspx)某个托管服务提供商安装 SP1 的一些问题，我正在为 ListView 寻找一个临时替代品，它可以在对我的其余代码进行最小更改的情况下放置到位。

一种简单的替代方法是使用中继器。从 ListView 降级到 Repeater 有什么我需要注意的主要问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T19:58:16.507

你会失去两件事：

1.  模板列表视图提供。您必须使用转发器的 HeaderTemplate、ItemTemplate、FooterTemplate 布局，这有点难看。
2.  中继器一旦绑定，就会忘记绑定到它们的数据。如果您使用 listview 的 DataKeyNames，那就有点大了。解析中继器的项目并不有趣。

你可以解决这两个问题，所以这不是什么大问题，但仍然值得考虑。不过，中继器是 ListView 的最佳替代品，因为 ListView 被设计为中继器的升级。

阅读此处了解更多信息： [http ://www.singingeels.com/Articles/The_ListView_Dominates_The_Repeater.aspx](http://www.singingeels.com/Articles/The_ListView_Dominates_The_Repeater.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T19:54:37.623

您可以使用中继器控制，因为不会有那么多陷阱

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:29:08.800

主持人似乎在大约 30 分钟前在[第二页做出了回应：](http://forums.asp.net/t/1422864.aspx?PageIndex=2)

> 很抱歉给您带来不便。我们相信这是最近升级到 ASP .NET 3.5 SP1 的结果。微软已经讨论了这个问题和解决方案。您可以在此处找到该信息 - [https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=344296&SiteID=212&wa=wsignin1.0](https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=344296&SiteID=212&wa=wsignin1.0)

# asp.net - 更改 ASP DropDownlist 上的样式

> ID：865347
> 
> 赞同：5
> 
> 时间：2009-05-14T19:50:41.363
> 
> 标签：asp.net, drop-down-menu

是否可以更改下拉列表控件上向下箭头的图形，而无需创建自定义控件？我需要所有正常的属性，只是想稍微设置一下箭头的样式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T20:30:58.583

通过使用 javascript 和 CSS，您可以轻松地为任何表单元素使用自定义图形，请参阅示例：

[http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/](http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/)

[http://www.noupe.com/css/form-elements-40-cssjs-styling-and-functionality-techniques.html](http://www.noupe.com/css/form-elements-40-cssjs-styling-and-functionality-techniques.html)

[http://www.noupe.com/css/47-excellent-ajax-css-forms.html](http://www.noupe.com/css/47-excellent-ajax-css-forms.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T20:07:39.417

您可以使用第三方控件，但如果您希望更改标准工具的外观，那是不可能的，因为它们是从操作系统的标准控件派生的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T19:59:57.533

有[第三方控件](http://easylistbox.com/demoCombo.aspx?rl=fp)可以帮助您做到这一点。

# c# - 如何重构多个相似的 Linq-To-Sql 查询？

> ID：865350
> 
> 赞同：3
> 
> 时间：2009-05-14T19:51:05.870
> 
> 标签：c#, .net, linq-to-sql, refactoring

假设我有以下两个想要重构的 Linq-To-SQL 查询：

```
var someValue1 = 0;
var someValue2= 0;
var query1 = db.TableAs.Where( a => a.TableBs.Count() > someValue1 )
              .Take( 10 );
var query2 = db.TableAs.Where( a => a.TableBs.First().item1 == someValue2)
              .Take( 10 ); 
```

请注意，只有 Where 参数会发生变化。有什么方法可以将查询放入方法中并将 Where 参数作为参数传递？

[当我尝试枚举结果时，上一个问题](https://stackoverflow.com/questions/863169/how-to-refactor-multiple-similar-linq-queries)中发布的所有解决方案都已尝试并在运行时失败。

抛出的异常是：“用于查询运算符'Where'的不支持重载”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T19:56:01.567

绝对地。你会写：

```
public IQueryable<A> First10(Expression<Func<A,bool>> predicate)
{
    return db.TableAs.Where(predicate).Take(10);
} 
```

（这是假设`TableA`是`IQueryable<A>`。）

调用它：

```
var someValue1 = 0;
var someValue2= 0;
var query1 = First10(a => a.TableBs.Count() > someValue1);
var query2 = First10(a => a.TableBs.First().item1 == someValue2); 
```

我*相信*这会奏效...

这与您上一个问题的答案之间的区别基本上是这种方法采用`Expression<Func<T,bool>>`而不是仅仅`Func<T,bool>`因此它最终使用`Queryable.Where`而不是`Enumerable.Where`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:57:21.920

如果您真的想要可重用性，您可以尝试编写自己的运算符。例如，而不是重复写：

```
var query = 
Products
    .Where(p => p.Description.Contains(description))
    .Where(p => p.Discontinued == discontinued); 
```

你可以编写简单的方法：

```
public static IEnumerable<Product> ByName(this IEnumerable<Product> products, string description)
{
    return products.Where(p => p.Description.Contains(description));
}

public static IEnumerable<Product> AreDiscontinued(IEnumerable<Product> products, bool isDiscontinued)
{
    return products.Where(p => p.Discontinued == discontinued);
} 
```

然后像这样使用它：

```
var query = Products.ByName("widget").AreDiscontinued(false); 
```

# php - 我怎样才能以一定的时间间隔（例如每天一次）运行 PHP 脚本？

> ID：865381
> 
> 赞同：10
> 
> 时间：2009-05-14T19:57:58.037
> 
> 标签：php, autorun

我有一个通过 http 读取一个文件的 php 脚本（该文件在另一个域上）。我想每天只阅读一次或两次这个文件，而不是每次刷新网站时都连接到它。 **除了使用 cron 之外，还有其他方法吗？** 我不想使用 cron，因为我更喜欢在脚本本身中设置这种行为。所以它很灵活，所以我可以在任何地方使用它，而无需每次都设置 cron。谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T20:46:54.113

我过去在无法访问 cron 时做过这种事情：

```
$lastRunLog = '/path/to/lastrun.log';
if (file_exists($lastRunLog)) {
    $lastRun = file_get_contents($lastRunLog);
    if (time() - $lastRun >= 86400) {
         //its been more than a day so run our external file
         $cron = file_get_contents('http://example.com/external/file.php');

         //update lastrun.log with current time
         file_put_contents($lastRunLog, time());
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T20:10:14.373

如果您不能或不想使用 cron 并且仅在访问页面时更新它是可以的。您可以缓存 HTTP 请求的结果，并且仅在缓存超过一天或您选择的任何时间间隔时才在加载它的页面上更新它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T20:00:57.467

如果您想按时间间隔访问站点，也可以使用 [基于 Web 的 Cron 。](http://www.webbasedcron.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T10:20:09.523

您甚至可以使用数据库表 - 结构、id、日期、脚本 url 以及您需要的任何内容非常简单 - 并在每次运行脚本时添加一行。

然后，在运行脚本之前，只需检查您拥有的每一天的行数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T19:59:51.230

您可以使用[Cronjob](http://en.wikipedia.org/wiki/Cron)。然后，您可以通过命令行运行 php 脚本。

```
php /someplace/somefile.php 
```

如果您每天更新，Cronjob 将如下所示。

```
0  0  *  0  0  php /someplace/somefile.php 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T20:50:47.503

由于您明确声明您不想使用 cron，因此执行此操作的唯一其他方法（没有类似于 cron 的东西）是将您的脚本设置为守护程序。但是，除非您真的需要守护程序提供的灵活性，否则 cron 会更容易和更简单。

这是一个[守护进程演练](http://kevin.vanzonneveld.net/techblog/article/create_daemons_in_php/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-19T18:32:57.197

如果您使用的是带有 systemd 的 Linux 发行版：

我需要安排基于年度的作业，独立于应用程序（以防系统重新启动或类似情况），并且有人建议我使用[systemd Timers](https://www.freedesktop.org/software/systemd/man/systemd.timer.html)。它上面的 Arch [Wiki 页面](https://wiki.archlinux.org/index.php/Systemd/Timers)提供了一些示例。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-14T19:59:12.417

如果您在 *nix 环境中，则可以使用[cron 作业](http://en.wikipedia.org/wiki/Cron#Usage)

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-05-14T20:01:13.317

cron 有什么问题？

cron 有几个选择 - 您的 php 可以由命令行 PHP 解释器调用，或者您可以使用 wget 或 fetch 或等效方法在服务器上调用您的 PHP。

通常，PHP 从 Web 服务器的上下文中运行对其执行时间有时间限制，因此通常您不能设置“后台”PHP 线程来“稍后”执行操作。

# python - 您如何通过存在于许多不同目录中的代码 grep？

> ID：865382
> 
> 赞同：23
> 
> 时间：2009-05-14T19:58:09.660
> 
> 标签：python, grep, plone, zope

我正在开发一个大量使用鸡蛋的 Python 程序（Plone）。这意味着有 198 个目录充满了我在调试时可能想要搜索的 Python 代码。有没有一种好方法可以只搜索那些目录中的 .py 文件，避免不相关的代码和大型二进制文件？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-14T20:00:33.133

```
find DIRECTORY -name "*.py" | xargs grep PATTERN 
```

顺便说一句，自从写了这篇文章后，我发现了[ack](http://beyondgrep.com/)，这是一个更好的解决方案。

（自那次编辑以来，我发现了 ag）。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-14T20:04:37.147

```
grep -r -n "PATTERN" --include="*.py" DIRECTORY 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-14T20:15:21.257

我强烈推荐[ack](http://betterthangrep.com/)，一个 grep 替代品，“针对拥有大量异构源代码树的程序员”（来自网站）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-16T14:43:24.463

这些天我也经常使用ack。我确实对其进行了一些调整以找到所有相关的文件类型：

```
# Add zcml to the xml type:
--type-add
xml=.zcml

# Add more files the plone type:
--type-add
plone=.dtml,.zpt,.kss,.vpy,.props

# buildout config files
--type-set
buildout=.cfg

# Include our page templates to the html type so we can limit our search:
--type-add
html=.pt,.zpt

# Create txt file type:
--type-set
txt=.txt,.rst

# Define i18n file types:
--type-set
i18n=.pot,.po

# More options
--follow
--ignore-case
--nogroup 
```

要记住的重要一点是，如果扩展名不在其配置中，则 ack 将找不到文件。有关所有可用类型，请参阅“ack --help-types”。

我还假设您正在使用[omelette](http://pypi.python.org/pypi/collective.recipe.omelette "煎蛋")，因此您可以 grep/ack/find 所有相关文件？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-14T20:04:42.203

```
find <directory> -name '*.py' -exec grep <pattern> {} \; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-02-27T05:00:22.757

这个问题是创建collective.recipe.omelette 的动机。这是一个构建配方，可以将您工作集中的所有鸡蛋符号链接到一个目录结构中，您可以将您最喜欢的搜索实用程序指向该目录结构。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-09-17T20:59:42.150

如果您想非常快速地在大型源代码树中查找标识符，还有[GNU idutils 。](http://www.gnu.org/software/idutils/ "GNU idutils")它需要通过运行 mkid（并调整其配置文件以不忽略 .py 文件）提前构建搜索数据库。 如果您使用 buildout，[z3c.recipe.tag会处理这个问题。](http://pypi.python.org/pypi/z3c.recipe.tag)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-02-27T04:21:08.687

以防万一您需要非命令行 OSS 解决方案...

我使用pycharm。它内置了对构建的支持。您将它指向一个构建生成的 bin/instance，它将项目外部依赖项设置为实例使用的所有鸡蛋。然后所有 IDE 的自省和代码导航都可以很好地工作。Goto 定义、goto 实例、重构支持，当然还有搜索。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-02-28T09:19:30.607

我建议在使用 plone 和 pydev 功能“全局浏览器”（使用 eclipse 或 aptana studio）时[搜索](http://pypi.python.org/pypi/grin)、[煎蛋。](http://pypi.python.org/pypi/collective.recipe.omelette)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-03-04T03:56:29.540

仅仅因为没有足够的答案......

如果您正在常规开发，那么使用 Pydev 安装 Eclipse（或者更简单，Aptana Studio - 这是一个修改后的 Eclipse）是非常值得的，在这种情况下，查找工具就在那里。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-03-07T21:01:53.793

OpenGrok 是源搜索和导航的绝佳选择。不过可以在 Java 上运行。

我真的希望有像[https://oracle.github.io/opengrok/这样的东西](https://oracle.github.io/opengrok/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-02-27T00:03:30.027

自从发现 Emacs 的 rgrep 命令后，我的 grepping 生活变得更加令人满意。

假设我想在 Plone 的源代码中找到“IPortletDataProvider”。我愿意：

1.  `M-x rgrep`
2.  Emacs 提示输入搜索字符串 (IPortletDataProvider)
3.  ...然后搜索哪些文件 (*.py)
4.  ...然后是哪个目录（~/Plone/buildout-cache/eggs）。如果我已经在编辑文件，则默认为该文件的目录，这通常正是我想要的。

结果出现在一个新的缓冲区中。顶部是`find | xargs grep`Emacs 运行的命令。所有匹配都会突出显示。我可以使用标准文本搜索命令搜索缓冲区。最重要的是，我可以在匹配项上按 Enter（或单击）以打开该文件。

这是一种非常好的工作方式。我喜欢我不必记住`find | xargs grep`参数序列，但如果我需要它，所有的力量都在那里。

[![Emacs rgrep 示例](https://i.stack.imgur.com/r6Jle.png)](https://i.stack.imgur.com/r6Jle.png "Emacs rgrep 示例")

# python - 如何获取 python 类的名称？

> ID：865384
> 
> 赞同：1
> 
> 时间：2009-05-14T19:58:27.117
> 
> 标签：python, reflection, inspection

当我有一个对象 foo 时，我可以通过

```
str(foo.__class__) 
```

然而，我只需要类的名称（例如“Foo”），上面会给我一些类似的东西

```
"<class 'my.package.Foo'>" 
```

我知道我可以用正则表达式很容易地得到它，但我想知道是否有更“干净”的方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T20:02:59.227

尝试

```
__class__.__name__ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T20:03:52.703

foo.__class__.__name__ 应该给你你需要的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T20:06:40.293

```
Python 3.0.1 (r301:69561, Feb 13 2009, 20:04:18) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> class foo:
...     x = 1
...
>>> f = foo()
>>> f.__class__.__name__
'foo'
>>> 
```

# sql - 清理数据源

> ID：865386
> 
> 赞同：0
> 
> 时间：2009-05-14T19:58:46.490
> 
> 标签：sql, mysql, database, excel, filemaker

我正在管理一个开发项目，该开发项目从各种数据源（SQL MySQL、Filemaker、excel）中提取数据，然后安装到具有 10 年记录库的新数据库结构中。显然，我需要在导出之前清理所有这些，并且想知道是否有任何应用程序可以为我简化此过程，或者我可以遵循的任何指南。

任何帮助都会很棒

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T21:08:13.640

我一直这样做，就像 Tom 在 SQl Server 中使用 DTS 或 SSIS 一样，这取决于最终数据库的版本。

我强烈推荐的一些东西：

在处理之前存档所有收到的文件，特别是如果您从外部来源获取这些数据，您可能需要研究旧的导入并返回原始数据。归档成功后，将文件复制到处理位置。

特别是对于大文件，获取某种标志文件是有帮助的，该标志文件仅在另一个文件完成后才被复制，或者更好的是它包含文件中的记录数。这有助于防止文件损坏或不完整造成的问题。

如果文件大小或记录数量可疑，请保留记录数量的日志并开始使您的工作失败。如果您发现更改是正确的，请输入一种处理方法。有时他们确实打算将文件切成两半，但大多数时候他们没有。

如果可能，在文件中获取列标题。您会惊讶于数据源在没有预先警告和中断导入的情况下更改列、列名或列顺序的频率。如果您有列标题，则在处理数据之前更容易检查这一点。

切勿直接导入生产表。最好使用暂存表，您可以在其中检查和清理数据，然后再将其放入产品中。

记录流程的每个步骤，以便您轻松找到导致失败的原因。

如果您要清理大量文件，请考虑创建函数来执行特定类型的清理（例如电话号码格式），那么您可以在多个导入中使用相同的函数。

Excel 文件是邪恶的。查找在导入过程中去除了前导零的地方。

我编写了我的流程，因此我可以将它们作为测试运行，并在最后进行回滚。这样做比意识到您的开发数据如此混乱以至于您甚至无法进行有效测试以确保所有内容都可以转移到产品中要好得多。

在没有先在 dev 上进行的情况下，永远不要在 prod 上进行新的导入。当您开始新的导入时直接观察记录（当然，如果它是一个大文件，则不是全部，但一个很好的采样）。如果您认为您应该获得 20 列并且它第一次导入为 21 列，请查看最后一列中的记录，这通常意味着制表符分隔的文件在数据的某处有一个制表符，并且列数据为此关闭记录。

不要假设数据是正确的，先检查一下。我在姓氏列中有名字，在邮政编码列中有电话等。

检查无效字符、应该只有数字的字符串数据等。

只要有可能，就从提供数据的人那里获取标识符。把它放在一个链接到你的标识符的表中。由于姓氏已更改或地址已更改，这将使您免于重复记录。

还有更多，但这应该让您开始考虑构建流程以通过不导入不良数据来保护公司的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:36:31.590

在类似的情况下，我个人发现 Emacs 和 Python 非常有用，但我想，任何具有良好搜索功能的文本编辑器和具有强大字符串操作功能的语言都应该可以胜任。我首先将数据转换为纯文本文件，然后

1.  眼球要么是整个数据集，要么是具有代表性的真实随机数据样本。
2.  基于此，对不同的列进行猜想（“不允许空值”、“仅包含值 'Y' 和 'N'”、“'开始日期'总是在 '结束日期'之前”等）。
3.  编写脚本来检查猜想。

显然，这种方法往往一次只关注一个表，因此只能补充将数据上传到关系数据库后所做的检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-05T22:01:36.857

对我有用的一个技巧是找到一种方法，让每种类型的数据源一次以制表符分隔的形式输出单个列和唯一标识符，这样您就可以使用文本工具清理它（ sed、awk 或 TextMate 的 grep 搜索），然后重新导入它/更新（副本！）原始源。

然后清理多个来源变得更快，因为您可以在它们之间重复使用工具（例如，大写姓氏 - McKay、O'Leary o'Neil、Da Silva、Von Braun 等、修复日期格式、修剪空白) 并在某种程度上自动化该过程（取决于来源）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:11:53.887

我主要使用 Microsoft SQL Server，这就是我的专长所在，但 SSIS 可以连接到相当多的数据源，并且非常适合 ETL 工作。即使您的数据源实际上都不是 MS SQL Server，您也可以使用它。也就是说，如果您不使用 MS SQL Server，那么可能会有一些更好的方法。

要提供一个非常好的答案，您需要有一个完整的数据源和目标列表，以及您可能需要完成的任何特殊任务以及运行转换的任何要求（它是一次性的吗？交易还是您需要能够安排它？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T20:12:57.533

不确定工具，但您将不得不处理：

*   同步生成的密钥

*   同步/规范化数据格式（例如不同的日期格式）

*   同步记录结构。

*   孤儿记录

如果在您开发此过程或移动数据时数据正在运行/正在更新，您还需要捕获更新。过去，当我不得不做这种事情时，最好但不是很好的答案是开发一组在多次迭代中运行的脚本，这样我就可以在移动之前迭代地开发和测试流程的数据。我发现拥有一个可以清理/重建目标数据库的脚本（我使用了模式和 ant 脚本，但它可以是任何东西）很有帮助。您也可能需要某种方式来记录脏/不匹配的数据。

# iphone - size_t 持有什么样的数据？

> ID：865388
> 
> 赞同：13
> 
> 时间：2009-05-14T19:58:59.923
> 
> 标签：iphone, objective-c, cocoa-touch, uikit, core-graphics

在代码片段中，我看到了这个：

```
size_t w = CGImageGetWidth(inImage); 
```

文档没有给我任何关于“size_t”的有用信息。有谁知道这是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-14T20:00:27.733

从[这里](http://www.cplusplus.com/reference/clibrary/cstring/size_t/)：

无符号整数类型

size_t 对应于语言运算符 sizeof 返回的整数数据类型，并在头文件（以及其他文件）中定义为无符号整数类型。

其中 `<cstring>,`，它用作函数 memchr、memcmp、memcpy、memmove、memset、strncat、strncmp、strncpy 和 strxfrm 中参数 num 的类型，在所有情况下，它都用于指定函数的最大字节数或字符数必须影响。

它还用作 strcspn、strlen、strspn 和 strxfrm 的返回类型以返回大小和长度。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-14T20:25:14.523

size_t 是一种依赖于平台的方法来表示对象的大小。它始终是无符号的，但它可以是 32 位平台上的无符号 32 位值或 64 位平台上的 64 位值。在 iPhone SDK 上是一个`unsigned long`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T20:00:51.010

size_t 是无符号整数的别名 (typedef)。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-14T20:00:19.467

这是一种在整个 C 和 C++ 中用于简单表示整数的类型。我相信这只是int的typedef。

# css - CSS 框架（即：960gs 或 Blueprintcss）可以在没有边距的情况下使用吗？

> ID：865390
> 
> 赞同：0
> 
> 时间：2009-05-14T19:59:28.517
> 
> 标签：css, jsf, frameworks, blueprint-css, 960.gs

我看不出使用[http://960.gs](http://960.gs)或[http://blueprintcss.org](http://blueprintcss.org)的意义，如果他们强制执行除漂亮杂志布局/marketing-esq 小册子之外的边距。有没有办法可以使用这些来满足某些设计要求，例如可以实际触摸/环绕标题的导航栏？**任何使用这些框架而没有边距的输入（因为它们将浏览器兼容性强加给较少 CSS 大师级别的开发人员）将是理想的。**（注意：我们使用的是 JSF，这也是一个开发商店，根本不是网上商店）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-25T05:25:35.440

我使用这种技术作为我的终极 CSS 布局技术：

[http://www.codeofficer.com/blog/entry/css_grid_frameworks_960gs_without_margins/](http://www.codeofficer.com/blog/entry/css_grid_frameworks_960gs_without_margins/)

我曾经遇到过同样的问题，自从我使用了那个，所有的边距问题都消失了。当我需要使用自定义宽度/高度时，我使用**!important覆盖。**

编码：

```
<div class="g_9 content_main">
    This div should actually have 720px in width.
    But I overide it using another class so now the width has become 700px,
    and just in case it needs custom margin, we can always set it in the css :)
</div> 
```

CSS：

```
.c_12 .g_9, .c_16 .g_12 { width: 720px; } /* 960-full.css */
.content_main { width: 700px !important; margin-left: 15px;} /* style.css */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:10:38.330

您不必为站点上的每个 div 使用网格类。如果您的页眉不需要遵循网格布局，则为页眉创建自己的样式。您也可以完全跳过网格，只使用表单和排版标记。这些框架试图为您的项目带来一点一致性。

我对主要内容使用蓝图，但标题区域有它自己的自定义布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-23T21:45:34.590

这是我编写的一个与 960gs 配合使用的 mod，可帮助您创建可触摸的元素，而无需重写框架。

[http://www.michaelhartmayer.com/css/960gs-margin-mod](http://www.michaelhartmayer.com/css/960gs-margin-mod)

# c++ - 如何通过 C++ 启动 explorer.exe？

> ID：865395
> 
> 赞同：5
> 
> 时间：2009-05-14T20:00:03.150
> 
> 标签：c++, winapi, createprocess

我正在尝试以编程方式启动 explorer.exe，但我没有任何运气。

这是我的代码：

```
cout << pName << "died, lets restart it." << endl;
STARTUPINFO startupInfo = {0};
startupInfo.cb = sizeof(startupInfo);

PROCESS_INFORMATION processInformation;

if(CreateProcess(pName, NULL, NULL, NULL, false, NORMAL_PRIORITY_CLASS, NULL, NULL, &startupInfo, &processInformation) == 0){
    cout << "Error starting " << pName << ": " << GetLastError() << endl;
} 
```

pName 是 explorer.exe

有人可以告诉我我做错了什么吗？我收到错误代码“2”，即`ERROR_FILE_NOT_FOUND`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T20:02:21.223

第一个参数是应用名称；第二个是命令行。尝试将“explorer.exe”指定为第二个参数。

请参阅此[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms682425.aspx)：

> lpApplicationName [输入，可选]
> 
> 要执行的模块的名称。该模块可以是基于 Windows 的应用程序。如果适当的子系统在本地计算机上可用，它可以是某种其他类型的模块（例如，MS-DOS 或 OS/2）。
> 
> 该字符串可以指定要执行的模块的完整路径和文件名，也可以指定部分名称。在部分名称的情况下，该函数使用当前驱动器和当前目录来完成规范。**该函数不会使用搜索路径**。该参数必须包含文件扩展名；假定没有默认扩展名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T03:37:38.383

您可能应该尝试“ [ShellExecuteEx ”。](http://msdn.microsoft.com/en-us/library/bb762154(VS.85).aspx)此函数允许您指定*文件*或*文件夹*以及描述如何处理它的*动词。*如果您使用“ `explore`”作为*动词*，它将打开带有给定*文件夹*的 Windows 资源管理器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-22T18:02:45.343

很难找到有关如何**可靠地**重新启动 Windows 资源管理器的相关信息。在 64 位 Windows 7/8 上，ShellExecute 方法无法正常工作，并导致文件复制和图标覆盖等事情被完全破坏。

最可靠的方法似乎是使用 stdlib.h 系统调用：

```
system("start explorer"); 
```

如果您尝试关闭并重新启动资源管理器，您可能希望以编程方式禁用 AutoRestartShell 注册表项，这会阻止您控制资源管理器*何时*重新启动。

# c# - 使用 C# 检查进程是否在远程系统上运行

> ID：865412
> 
> 赞同：9
> 
> 时间：2009-05-14T20:02:37.667
> 
> 标签：c#, .net, system.diagnostics

我正在尝试检查一个进程是否正在远程系统上运行。我正在使用以下代码：

```
string procSearc = "notepad";
string remoteSystem = "remoteSystemName";

Process[] proce = System.Diagnostics.Process.GetProcessesByName(procSearch, remoteSystem); 
```

但是，当我尝试运行代码时，出现以下错误：“无法连接到远程机器。”

我可以使用以下命令运行 pslist： C:>pslist \remoteSystemName 所以我知道可以获得我需要的信息，但我需要在代码中使用它。

另一种可能性是将 pslist 集成到 C# 中并搜索列表以查看该进程是否存在，但我还没有找到有关如何执行此操作的信息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T20:13:23.133

将`System.ServiceProcess.ServiceController`类用于服务。您可以使用`Status`来检查它是否正在运行并`Stop()`控制`Start()`它。

```
ServiceController sc = new ServiceController();
sc.MachineName = remoteSystem;
sc.ServiceName = procSearc;

if (sc.Status.Equals(ServiceControllerStatus.Running))
{
   sc.Stop();
}
else
{
   sc.Start();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T21:16:14.823

以下是我为使其正常工作所做的工作：

首先我添加了对 System.ServiceProcess 的引用并添加了： using System.ServiceProcess;

```
string remoteSystem = "remoteSystemName";
string procSearch = "notepad";            
Process[] proc = System.Diagnostics.Process.GetProcessesByName(procSearch, remoteSystem);

   if (proc.Length > 0)

   {
        Console.WriteLine("Able to find: " + proc[0]);
   }
   else
   {
        Console.WriteLine("Unable to find: " + procSearch);
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T20:21:03.800

内部异常是否说“拒绝访问”？

一个类似的问题可能会有所帮助，它提到需要在性能监视器用户组中。

[GetProcessesByName() 和 Windows Server 2003 计划任务](https://stackoverflow.com/questions/152337/getprocessesbyname-and-windows-server-2003-scheduled-task)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-01T08:47:40.877

我想当我自己运行应用程序时，我会得到一个异常窗口，因为我的代码中没有处理异常......

我在堆栈跟踪中看到了原因：**访问被拒绝**。原因是运行调用 .NET 方法以获取进程列表的程序的用户不属于远程计算机的“性能监视器用户”组。

之后我得到另一个异常，说**性能监控服务没有在远程机器上运行**。所以我在远程计算机上启动了相应的服务，瞧它工作了！

这是使用 Windows 7 客户端尝试获取 Windows 2008 Server 的进程列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-19T10:27:17.060

您可以尝试模拟有权访问远程服务器的用户。

[https://docs.microsoft.com/en-us/dotnet/api/system.security.principal.windowsimpersonationcontext?redirectedfrom=MSDN&view=netframework-4.7.2](https://docs.microsoft.com/en-us/dotnet/api/system.security.principal.windowsimpersonationcontext?redirectedfrom=MSDN&view=netframework-4.7.2)

模拟后，您将不再遇到错误。此外，您必须确保域之间存在信任，否则模拟将不起作用。

[LogonUser 仅适用于我的域](https://stackoverflow.com/questions/993418/logonuser-works-only-for-my-domain)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-08T10:54:13.510

**杀死远程进程**
我发现Process.MachineName设置后Process.Kill()方法不起作用，所以这里有一个远程杀死进程的解决方案，希望对其他人有所帮助。

**创建方法的扩展方法：KillRemoteProcess**

```
public static class ProcessExtensions
{
    public static void KillRemoteProcess(this Process p, string user, string password)
    {
        new Process
        {
            StartInfo = new ProcessStartInfo
            {
                FileName = "TaskKill.exe",
                Arguments = string.Format("/pid {0} /s {1} /u {2} /p {3}", p.Id, p.MachineName, user, password),
                WindowStyle = ProcessWindowStyle.Hidden,
                CreateNoWindow = true
            }
        }.Start();
    }
} 
```

**当然还有找到进程和使用 KillRemoteProcess 的方法**

```
 public static void KillProcessesRemote()
    {
        string targetProcessName = "myProcess"; //Do not put 'process.exe' here just 'process'
        string targetMachine = "remotMachine"; //Target machine
        string username = "myUser"; //Username
        string password = "myPassword"; //Password

        Parallel.ForEach<Process>( //Kill all processes found
            source: System.Diagnostics.Process.GetProcessesByName(targetProcessName, targetMachine),
            body: process => {
                process.KillRemoteProcess(username, password);
            });
    } 
```

# c# - 如何将 .dds 文件加载到图片框中？

> ID：865413
> 
> 赞同：4
> 
> 时间：2009-05-14T20:02:46.077
> 
> 标签：c#, image, directdraw, dds-format

如何在 C# 中将 .dds 纹理文件加载为图像？在谷歌上我找不到任何有用的东西。

你给我的样品信息越多，我就越容易理解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-16T22:03:07.747

我遇到过同样的问题。这是一个很好的解决方案。

1.  资料来源： http: [//www.mastropaolo.com/devildotnet/](http://www.mastropaolo.com/devildotnet/)
2.  从该链接下载 1.3 版（页面底部）
3.  添加 Devil.NET.dll 作为对您的应用程序的引用
4.  使用我在下面提供的代码。

    PictureBox1.Image = DevIL.DevIL.LoadBitmap(DDS_File_Path)

这真的很容易。我们欠 DevIL .NET Wrapper 创建者一杯啤酒。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T20:06:41.650

我认为简短的回答是你没有。[文档](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)说支持的格式是 BMP、GIF、EXIG、JPG、PNG 和 TIFF。

更新：似乎可以[通过 Google 找到许多转换器](http://www.google.se/search?q=dds+image+converter)，这可能会对您有所帮助。另外，正如韦恩建议的那样，看看 XNA（如果你还没有的话）。[Texture2D.FromFile](http://msdn.microsoft.com/en-us/library/bb196945.aspx)方法似乎可以处理.dds文件，但我自己从未使用过它，所以我不能说它是否是您正在寻找的东西......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T00:53:48.730

您可能想查看 Microsoft 的[XNA Game Studio SDK](http://msdn.microsoft.com/en-us/xna/default.aspx)以将纹理加载到内存中，并可能以 System.Drawing.Graphics 可用的方式捕获图像。

# xcode - Xcode 有代码导航功能吗？

> ID：865415
> 
> 赞同：8
> 
> 时间：2009-05-14T20:03:34.577
> 
> 标签：xcode

Xcode 有代码导航功能吗？像 unix 的 cscope 类型的工具，我可以输入一个类的名称，它会为我打开文件？或者找出类的特定方法的调用者？或者显示一个类的类型层次结构？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-14T20:06:29.170

`command`- `shift`- `D`(Xcode 4: `command`- `shift`- `O`) 打开一个快速打开窗口，您可以在其中键入部分类名并按 Enter 键打开文件。至于更复杂的版本，例如 Eclipse 提供的（方法名称、符号名称等），我不相信 XCode 中内置了类似的东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T20:13:57.017

除了“快速打开”窗口之外，还有类浏览器。类浏览器允许您查看类层次结构。类浏览器可以在项目菜单下找到。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T16:08:15.507

“Jump To Definition”项可以通过CMD+双击访问，直接跳转到相关代码

此外，您可以通过（选项或 ALT）+ 双击类/方法/属性“跳转到文档”

更新：Option + 双击不再将您直接带到 Snow Leopard 中的文档。现在它打开了一个小文档“气泡”，如果需要，可以选择跳转到文档浏览器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-20T20:21:23.967

从 XCode 4.4 开始，您可以通过打开选定（突出显示）方法的“显示相关项目”弹出窗口来查找调用者和被调用者：

1.  在代码中标记方法（使用光标或双击名称）
2.  按`Ctrl`+`1`
3.  从弹出菜单中选择“来电者”

你也可以去查看->标准编辑器->显示相关项目或按下编辑器窗口上方行中箭头按钮左边的小按钮（它显示你当前选择的文件和方法）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T20:14:38.013

如果你 Ctrl 单击类名、方法名或函数名，你会得到一个很长的菜单，你可以在其中找到**Jump to Definition**项。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-09T04:56:49.827

当用户指向一个方法或项目时，应该会打开一个元素预览窗口或气泡之类的东西。“跳转到定义”改变了用户的焦点，并采取了 2 个步骤去目标。

Source Insight 中的关系窗口和上下文窗口就是一个很好的例子，但我在 Xcode 和其他 mac 开发工具中找不到它们。

顺便说一句，上下文窗口应该有多个层来跟踪像 Xcode 中的拆分窗口这样的深度引用方法，而不仅仅是源代码洞察中的一层。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T19:08:42.467

另外：选择一个标识符，右键单击它，然后选择 Find in Project > As Symbol（或 Find in Project 并选择 Symbol 作为搜索类型）显示所有符号使用，即声明、定义和调用站点。

# php - 用户使用 CakePHP 登录后如何更改用户会话？

> ID：865418
> 
> 赞同：1
> 
> 时间：2009-05-14T20:03:55.167
> 
> 标签：php, cakephp

我有

```
$user = $this->Auth->user(); 
```

从会话中检索当前用户。

我想让管理员用户能够“充当”客户。当他们进入客户界面时，我希望能够在用户会话中替换 customer_id。

```
$user['User']['customer_id'] = 4; 
```

这不起作用，因为我找不到将 $user 数据推回 Auth 的方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T21:27:56.980

这应该有效：

```
$this->Session->write('Auth.User.customer_id', 4); 
```

请注意，如果您还使用 Acl 和基于组的权限模型，这种仅更改 customer_id 的方法可能会产生一些副作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T20:37:10.487

如果您只是检查会话上的 customer_id 以确定该用户是否属于客户类型，而不是：

$user['User']['customer_id'] = 4;

我会尝试：

$this->Session->write('User.customer_id', '4');

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:12:17.377

尝试结合`$this->Auth->logout()`，然后`$this->Auth->login()`与客户的数据。

但是，如果您希望您的管理员能够在不再次输入其凭据的情况下返回其帐户，则需要实施额外的逻辑。这很简单，但值得一提。

# objective-c - 这个 {{0,0},{w,h}} 在做什么？

> ID：865419
> 
> 赞同：5
> 
> 时间：2009-05-14T20:03:55.730
> 
> 标签：objective-c, iphone, cocoa-touch

我今天偶然发现了这段代码：

CGRect 矩形 = {{0,0},{w,h}};

在这里，我会使用 CGRectMake。但是乱七八糟的括号里的这个东西有什么作用呢？那是什么样的特殊语法？我的 Objective-c 书籍都没有提到这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-14T20:08:29.197

这是一个标准的 C 结构初始化构造。任何结构都可以在声明时通过在花括号中按顺序提供其内容来初始化，就像这样。因为一个 CGRect 包含一个 CGPoint 和一个 CGSize，所以你为 CGRect 使用一组大括号，然后为每个 CGPoint 和 CGSize 使用另一组。

# java - java.util.Map和java.util.Set的优化实现？

> ID：865423
> 
> 赞同：14
> 
> 时间：2009-05-14T20:04:42.903
> 
> 标签：java, performance, collections, map, set

我正在编写一个应用程序，其中内存和速度在较小程度上是至关重要的。我从分析中发现，我在 Map 和 Set 操作上花费了大量时间。虽然我正在研究减少调用这些方法的方法，但我想知道是否有人编写或遇到过显着改善访问时间或内存开销的实现？或者至少，考虑到一些假设，这可以改善这些事情？

通过查看 JDK 源代码，我无法相信它不能变得更快或更精简。

我知道 Commons Collections，但我不相信它有任何目标是更快或更精简的实现。谷歌收藏也是如此。

更新：应该注意到我不需要线程安全。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-14T20:22:09.850

通常这些方法很快。您应该检查几件事：您的哈希码是否已实现？它们是否足够均匀？否则你会得到垃圾性能。

[http://trove4j.sourceforge.net/](http://trove4j.sourceforge.net/) <-- 这有点快并且节省了一些内存。我在 50,000 次更新上节省了几毫秒

您确定您正确使用了地图/设置吗？即不尝试迭代所有值或类似的东西。另外，例如不要先包含然后再删除。只需检查删除。

还要检查您是否使用 Double vs double。我注意到数万次检查的几毫秒性能改进。

您是否还正确/适当地设置了初始容量？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T20:09:50.270

你看过[Trove4J](http://trove4j.sourceforge.net/)吗？从网站：

> Trove 旨在提供 java.util.Collections API 的快速、轻量级实现。

[此处](http://trove4j.sourceforge.net/html/benchmarks.shtml)提供的基准。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-14T20:52:21.073

以下是我知道的，除了 Google 和 Commons Collections：

*   [http://trove4j.sourceforge.net/](http://trove4j.sourceforge.net/)
*   [http://javolution.org/](http://javolution.org/)
*   [http://fastutil.dsi.unimi.it/](http://fastutil.dsi.unimi.it/)

当然，您始终可以实现自己的数据结构，这些数据结构针对您的用例进行了优化。为了能够提供更好的帮助，我们需要了解您的访问模式以及您在集合中存储的数据类型。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-14T20:10:10.520

尝试提高 equals 和 hashCode 方法的性能，这有助于加快标准容器对对象的使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T20:09:39.397

您可以扩展 AbstractMap 和/或 AbstractSet 作为起点。不久前我这样做是为了实现一个基于二叉树的映射（键是一个整数，树上的每个“级别”都是一个位位置。左孩子是 0，右孩子是 1）。这对我们来说效果很好，因为密钥是 EUI-64 标识符，而且对我们来说，大多数时候前 5 个字节是相同的。

要实现一个 AbstractMap，至少需要实现 entrySet() 方法，返回一组 Map.Entry，每个都是一个键/值对。

为了实现一个集合，你扩展 AbstractSet 并提供 size() 和 iterator() 的实现。

然而，至少是这样。您还需要实现 get 和 put，因为默认映射是不可修改的，并且 get 的默认实现会遍历 entrySet 以寻找匹配项。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-15T02:36:42.617

您可以通过以下方式节省一点内存：

(a) 使用**更强大、更广泛的哈希码**，从而**避免存储密钥**；

(b) 通过从数组中分配自己，**避免为每个哈希表条目创建单独的对象**。

如果它有用，这里有一个简单的 Java 实现的*Numerical Recipies*哈希表，我有时发现它很有用。您可以直接键入 CharSequence（包括字符串），否则您必须自己为您的对象提供一个强大的 64 位散列函数。

请记住，此实现**不存储 keys**，因此如果两个项目具有相同的哈希码（如果您有一个良好的哈希函数，您会期望在 2^32 或几十亿个项目之后进行哈希处理），然后一项将覆盖另一项：

```
public class CompactMap<E> implements Serializable {
  static final long serialVersionUID = 1L;

  private static final int MAX_HASH_TABLE_SIZE = 1 << 24;
  private static final int MAX_HASH_TABLE_SIZE_WITH_FILL_FACTOR = 1 << 20;

  private static final long[] byteTable;
  private static final long HSTART = 0xBB40E64DA205B064L;
  private static final long HMULT = 7664345821815920749L;

  static {
    byteTable = new long[256];
    long h = 0x544B2FBACAAF1684L;
    for (int i = 0; i < 256; i++) {
      for (int j = 0; j < 31; j++) {
        h = (h >>> 7) ^ h;
        h = (h << 11) ^ h;
        h = (h >>> 10) ^ h;
      }
      byteTable[i] = h;
    }
  }

  private int maxValues;
  private int[] table;
  private int[] nextPtrs;
  private long[] hashValues;
  private E[] elements;
  private int nextHashValuePos;
  private int hashMask;
  private int size;

  @SuppressWarnings("unchecked")
  public CompactMap(int maxElements) {
    int sz = 128;
    int desiredTableSize = maxElements;
    if (desiredTableSize < MAX_HASH_TABLE_SIZE_WITH_FILL_FACTOR) {
      desiredTableSize = desiredTableSize * 4 / 3;
    }
    desiredTableSize = Math.min(desiredTableSize, MAX_HASH_TABLE_SIZE);
    while (sz < desiredTableSize) {
      sz <<= 1;
    }
    this.maxValues = maxElements;
    this.table = new int[sz];
    this.nextPtrs = new int[maxValues];
    this.hashValues = new long[maxValues];
    this.elements = (E[]) new Object[sz];
    Arrays.fill(table, -1);
    this.hashMask = sz-1;
  }

  public int size() {
    return size;
  }

  public E put(CharSequence key, E val) {
    return put(hash(key), val);
  }

  public E put(long hash, E val) {
    int hc = (int) hash & hashMask;
    int[] table = this.table;
    int k = table[hc];
    if (k != -1) {
      int lastk;
      do {
        if (hashValues[k] == hash) {
          E old = elements[k];
          elements[k] = val;
          return old;
        }
        lastk = k;
        k = nextPtrs[k];
      } while (k != -1);
      k = nextHashValuePos++;
      nextPtrs[lastk] = k;
    } else {
      k = nextHashValuePos++;
      table[hc] = k;
    }
    if (k >= maxValues) {
      throw new IllegalStateException("Hash table full (size " + size + ", k " + k);
    }
    hashValues[k] = hash;
    nextPtrs[k] = -1;
    elements[k] = val;
    size++;
    return null;
  }

  public E get(long hash) {
    int hc = (int) hash & hashMask;
    int[] table = this.table;
    int k = table[hc];
    if (k != -1) {
      do {
        if (hashValues[k] == hash) {
          return elements[k];
        }
        k = nextPtrs[k];
      } while (k != -1);
    }
    return null;
  }

  public E get(CharSequence hash) {
    return get(hash(hash));
  }

  public static long hash(CharSequence cs) {
    if (cs == null) return 1L;
    long h = HSTART;
    final long hmult = HMULT;
    final long[] ht = byteTable;
    for (int i = cs.length()-1; i >= 0; i--) {
      char ch = cs.charAt(i);
      h = (h * hmult) ^ ht[ch & 0xff];
      h = (h * hmult) ^ ht[(ch >>> 8) & 0xff];
    }
    return h;
  }

} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T20:10:58.770

查看 GNU Trove：

[http://trove4j.sourceforge.net/index.html](http://trove4j.sourceforge.net/index.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T20:19:08.937

在 commons-collections 中至少有一个专门为速度而构建的实现：[Flat3Map](http://commons.apache.org/collections/api-release/org/apache/commons/collections/map/Flat3Map.html)它非常具体，只要元素不超过 3 个，它就会非常快。

我怀疑通过遵循@thaggie 的建议添加查看equals/hashcode 方法时间，您可能会获得更多里程。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-14T20:40:05.690

你说你分析了一些课程，但你有没有做任何时间来检查他们的速度？我不确定您将如何检查他们的内存使用情况。当您比较不同的实现时，手头有一些具体的数字似乎会很好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-14T21:47:09.287

这里有一些注释和几个替代数据结构库的链接：http: [//www.leepoint.net/notes-java/data/collections/ds-alternatives.html](http://www.leepoint.net/notes-java/data/collections/ds-alternatives.html)

我也会对 fastutil 投出强烈的一票。（在另一个响应中和该页面上提到）它具有比您无法动摇的更多不同的数据结构，并且针对原始类型作为键或值进行了优化的版本。（一个缺点是 jar 文件很大，但您大概可以将其修剪为您需要的内容）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-25T15:12:35.743

几年前我经历过类似的事情——非常大的地图和集合以及其中的很多。默认的 Java 实现占用了太多空间。最后我推出了自己的，但只有在我检查了我的代码所需的实际使用模式之后。例如，我有一组已知的大型对象，这些对象是在早期创建的，有些地图是稀疏的，而另一些是密集的。其他结构单调增长（没有删除），而在其他地方，使用“集合”并执行偶尔但无害的处理重复项目的额外工作比花费时间和空间避免重复更快。我使用的许多实现都是数组支持的，并利用了我的哈希码是按顺序分配的这一事实，因此对于密集映射，查找只是一个数组访问。

带走消息：

1.  看看你的算法，
2.  考虑多种实现，以及
3.  请记住，那里的大多数库都适合通用用途（例如插入*和*删除、一系列大小、既不稀疏也不密集等），因此它们将产生您可能避免的开销。

哦，写单元测试...

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-25T15:26:01.083

有时，当我看到 Map 和 Set 操作使用高比例的 CPU 时，这表明我过度使用了 Map 和 Set，并且重组我的数据几乎消除了前 10% 的 CPU 消耗者的集合。

看看你是否可以避免集合的副本、迭代集合和任何其他导致访问集合的大部分元素和创建对象的操作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-14T20:08:44.627

这可能不是导致问题的原因，而是它们背后的对象`Map`。`Set`根据您的问题，您可能需要更多数据库类型的方案，其中“对象”存储为一堆字节而不是 Java 对象。您可以嵌入一个数据库（例如 Apache Derby）或做您自己的专业工作。这非常取决于您实际在做什么。`HashMap`不是故意大而慢...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-14T20:17:22.123

Commons Collections 有[FastArrayList](http://commons.apache.org/collections/api-release/org/apache/commons/collections/FastArrayList.html)、[FastHashMap](http://commons.apache.org/collections/api-release/org/apache/commons/collections/FastHashMap.html)和[FastTreeMap](http://commons.apache.org/collections/api-release/org/apache/commons/collections/FastTreeMap.html)但我不知道它们的价值...

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-14T20:28:48.727

*   Commons Collections 有一个 id 映射，它通过 == 进行比较，应该更快。-`[Joda Primities][1]`与原始收藏一样，Trove 也是如此。我用 Trove 做了实验，发现它的内存使用更好。
*   我正在用一些整数映射许多小对象的集合。将这些更改为整数节省了近一半的内存（尽管需要一些更混乱的应用程序代码来补偿）。
*   在我看来，排序树应该比哈希图消耗更少的内存，因为它们不需要负载因子（尽管如果有人可以确认或有理由说明这实际上是愚蠢的，请在评论中发布）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-15T13:06:22.637

您使用的是哪个版本的 JVM？

如果您不在 6 上（尽管我怀疑您是），那么切换到 6 可能会有所帮助。

如果这是一个服务器应用程序并且在 Windows 上运行，请尝试使用 -server 来使用正确的热点实现。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-08-08T12:07:08.693

我使用下面的包（koloboke）来做一个 int-int hashmap，因为它支持 promitive 类型并将两个 int 存储在一个 long 变量中，这对我来说很酷。[科洛博克](http://leventov.github.io/Koloboke/api/1.0/java7/overview-summary.html)

# asp.net - 高性能asp.net mvc应用

> ID：865438
> 
> 赞同：2
> 
> 时间：2009-05-14T20:07:44.533
> 
> 标签：asp.net

开发高性能 asp.net 应用程序时我应该注意哪些事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T20:18:11.810

查看缓存机会。确保它不是“健谈”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T22:04:29.027

检查[http://blog.whiletrue.com/2009/04/aspnet-mvc-performance/](http://blog.whiletrue.com/2009/04/aspnet-mvc-performance/)和[http://codeclimber.net.nz/archive/2009/04/17/the-performances-implications-of-the-基于表达式树的actionlink-helper.aspx](http://codeclimber.net.nz/archive/2009/04/17/the-performances-implications-of-the-expression-tree-based-actionlink-helper.aspx)。我也在写一篇关于表演的博客文章。到现在才实现了一个[简单](http://dotnetmarche.org/blogs/andreabalducci/archive/2009/04/24/introducing-abanalyzer-an-apache-bench-runner-and-analyzer.aspx)的使用apache bench的bench工具来比较客户端渲染和服务端渲染使用asp.net mvc和jQuery

# hibernate - RESTFul 和休眠

> ID：865444
> 
> 赞同：5
> 
> 时间：2009-05-14T20:08:32.317
> 
> 标签：hibernate, rest

是否有可以从使用休眠工具生成的类创建 RESTFul java 服务的工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T09:52:41.097

Spring Data - REST 可能有用。

[https://github.com/SpringSource/spring-data-rest/wiki/JPA-Repository-REST-Exporter](https://github.com/SpringSource/spring-data-rest/wiki/JPA-Repository-REST-Exporter)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-04T08:42:51.560

这是非常有用的
[http://sourceforge.net/projects/hibernatepojoge/files/hibernatepojoge/hbnpojogen/](http://sourceforge.net/projects/hibernatepojoge/files/hibernatepojoge/hbnpojogen/)

它创建实体和服务，你可以试试，非常简单

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T06:33:19.663

[Tapestry 5](http://tapestry.apache.org/tapestry5/)具有出色的 Hibernate 集成并使用 REST 样式的 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:13:11.447

看看[JBoss 的 RESTEasy 框架](http://www.jboss.org/resteasy/)

# java - 将base64编码的字符串转换为java字节数组

> ID：865460
> 
> 赞同：1
> 
> 时间：2009-05-14T20:11:54.807
> 
> 标签：java, arrays, byte, unsigned

我正在编写一个解密类（AES/CBC/PKCS7Padding），其中加密数据来自 C#。我想采用以下字符串（base64 编码）：

usiTyri3/gPJJ0F6Kj9qYL0w/zXiUAEcslUH6/zVIjs=

并将其转换为java中的字节数组以作为密钥传递给SecretKeySpec。我知道 C# 有无符号字节和 java 只有有符号字节的问题。那么我怎样才能传递这个值大于 127 的字符串并让 java 接受键和初始化向量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T21:38:27.610

您不必担心字节符号，因为 base64 编码的数据在每个字节中使用的位从不超过 6 位（这就是为什么它被称为 base 64，因为您只使用 64 个字符，即 6 位，来表示数据字节的一部分） .

如果您关心的是结果数据（每 4 个 base64 字符对应 3 个数据字节），也不必担心。C# 中的无符号字节 255 与 Java 中的有符号字节 -1 相同。

要对数据进行编码，您可以按位和每个字节使用 0xff 并将其存储在一个 int 中，然后对最低有效 8 位进行编码。或者只是按位或每个字节都带有 0x80 并将其存储在 ant int 中并解码最低有效的 8 位。

但我认为你最好使用 Bouncy Castle 或标准 JCE 来处理所有这些东西。PKCS7 中的“S”表示标准，因此在 C# 中加密的数据在 Java 中应该可以正常解密，反之亦然。

# tfs - Team Foundation Server (TFS) 2008 应用程序错误报告网站

> ID：865461
> 
> 赞同：1
> 
> 时间：2009-05-14T20:11:54.993
> 
> 标签：tfs, tfs-2008

是否有与 TFS 相关联的优秀应用程序允许您的应用程序用户提交错误报告或软件更改请求？

有没有使用提供的 API 绑定到 TFS 的优秀 3rd 方应用程序？我想要一个好的应用程序来提交错误，然后将它们分配给 TFS 中的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T20:24:06.680

[工作项 Web 访问（](http://msdn.microsoft.com/en-us/library/cc668124.aspx)[在此处](https://web.archive.org/web/20080913224531/http://msdn.microsoft.com/en-us/library/cc668124.aspx)存档）允许没有 TFS CAL 的用户提交和查看他们自己的工作项（错误报告或更改请求）。

或者，如果您的用户有 CAL，他们可以使用[Team System Web Access （](http://msdn.microsoft.com/en-us/teamsystem/bb980951.aspx)[在此处](https://web.archive.org/web/20090725081901/http://msdn.microsoft.com/en-us/teamsystem/bb980951.aspx)存档），并且也可以查看其他用户的工作项。

如果这不能回答您的问题，您能否澄清与 TFS 相关的应用程序的含义。

# php - === 在 PHP 中做了什么

> ID：865476
> 
> 赞同：5
> 
> 时间：2009-05-14T20:14:31.413
> 
> 标签：php, comparison, operators

我已经用 PHP 编程了一段时间，但我仍然不明白 == 和 === 之间的区别。我知道 = 是赋值。== 等于。那么===的目的是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-14T20:16:35.370

它比较值和类型的相等性。

```
 if("45" === 45) //false
 if(45 === 45) //true
 if(0 === false)//false 
```

它有一个类比： !== 比较类型和值的不等式

```
 if("45" !== 45) //true
 if(45 !== 45) //false
 if(0 !== false)//true 
```

它对于像 strpos 这样的函数特别有用——它可以有效地返回 0。

```
 strpos("hello world", "hello") //0 is the position of "hello"

 //now you try and test if "hello" is in the string...

 if(strpos("hello world", "hello")) 
 //evaluates to false, even though hello is in the string

 if(strpos("hello world", "hello") !== false) 
 //correctly evaluates to true: 0 is not value- and type-equal to false 
```

[这是一个很好的维基百科表格](http://en.wikipedia.org/wiki/%3D%3D%3D#Object_identity_vs._Content_equality)，列出了与三等号类似的其他语言。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-14T20:31:58.253

=== 确实比较值和类型，但有一种情况尚未提及，那就是当您使用 == 和 === 比较对象时。

给定以下代码：

```
class TestClass {
  public $value;

  public function __construct($value) {
    $this->value = $value;
  }
}

$a = new TestClass("a");
$b = new TestClass("a");

var_dump($a == $b);  // true
var_dump($a === $b); // false 
```

在对象的情况下 === 比较引用，而不是类型和值（因为 $a 和 $b 的类型和值都相同）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-14T21:13:40.990

PHP 手册有[几个非常好的表格](http://php.net/manual/en/types.comparisons.php)（“使用 == 进行松散比较和使用 === 进行严格比较），它们显示了在比较各种变量类型时 == 和 === 会给出什么结果。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-14T20:16:13.610

它将检查数据类型和值是否相同

```
if ("21" == 21) // true
if ("21" === 21) // false 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T20:16:20.770

`===`比较值***和***类型。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T20:16:27.167

== 不比较类型， === 可以。

```
0 == false 
```

评估为真，但

```
0 === false 
```

才不是

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T20:17:14.387

这是一个真正的平等比较。

`"" == False`例如是`true`。

`"" === False`是`false`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T22:01:55.757

至少， === 比 == 快，因为没有自动强制转换/强制执行，但它是如此之小，几乎不值得一提。（当然，我刚才提到了……）

# apache-flex - 在 flex air 应用程序中处理开发/生产 URL 的简单方法

> ID：865480
> 
> 赞同：1
> 
> 时间：2009-05-14T20:15:20.243
> 
> 标签：apache-flex, air

在 flex air 应用程序中处理开发/生产 URL 的简单方法？我想指向我的本地盒子进行测试，但是当我启动时，我希望它自动指向生产 URL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T20:17:44.917

我建议使用配置文件或更改主机文件以将域指向开发机器上的本地主机或开发服务器。使用后一个选项，您始终在代码中使用您的生产 URL，但您的开发机器会将这些域解析到您的本地机器，因为它首先检查主机文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T20:50:51.983

您可以使用命名空间并在编译器选项中配置当前命名空间 (DEV/RELEASE)。

```
CONFIG::release
public function connect()
{
  //connect to release url
}

CONFIG::dev
public function connect()
{
   //connect to dev url
} 
```

然后为编译器定义这些选项：

```
-define=CONFIG::release,false
-define=CONFIG::dev,true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T01:26:03.367

这里最好的方法是将这些信息外部化到一个配置文件中——也许是一个 XML 文件——通过相对 url 加载。配置文件可能如下所示：

```
<config>
    <serviceEndpoint>http://www.mydomain.com/services</serviceEndpoint>
</config> 
```

请务必使用有效的 ActionScript 变量名称来命名您的 XML 元素，否则您可能会在处理文件时遇到一些困难（例如，E4X 表达式可能会变得困难。

然后，您可以使用 HTTPService 加载“config.xml”，该文件在部署时放置在应用程序的 SWF 旁边。这将允许您将托管在任何域上的 SWF 重新指向托管在其他任何地方的后端。如果您在本地开发并连接到共享开发服务器，这将特别有用。

将这些信息编译到您的 SWF 中是非常不灵活的，也是一种糟糕的做法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T02:52:15.450

我通常会在`url`应用`contentLoaderInfo`程序（Flex - [http://livedocs.adobe.com/flex/201/langref/mx/core/Application.html#url](http://livedocs.adobe.com/flex/201/langref/mx/core/Application.html#url)）或根显示对象（Flash - - [http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/LoaderInfo.html#url](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/LoaderInfo.html#url)）。如果 url 以“file”开头，你知道你在你的开发/IDE中，如果它是“http”，它正在浏览器中运行。如果您只是在浏览器中工作，您还可以将参数传递给具有类似

```
{
    url: $_SERVER['SERVER_NAME'];
} 
```

并执行一些初始化/启动方法以根据应用程序运行的路径进行切换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T05:26:36.490

我正在编写的一个 AIR 应用程序中遇到了这个问题，该应用程序通过 WebORB 访问 Rails 应用程序。

我只需要根据我是否在 Flex Builder 中运行（通过 adl）在[http://localhost](http://localhost)和[http://fakeproductionurl.com](http://fakeproductionurl.com)之间切换。

这就是我最终使用的：

```
if (NativeApplication.nativeApplication.publisherID != "") {
   return "http://fakeproductionurl.com";
}
else {
   return "http://localhost";
} 
```

它不能让您在 3+ 个不同的环境之间切换，但它是在开发/生产环境之间切换的一种非常简单的方法。

# coldfusion - 使用 ISAPI_Rewrite v2 重写 ColdFusion 站点的 url 是否有任何陷阱？

> ID：865483
> 
> 赞同：1
> 
> 时间：2009-05-14T20:15:35.407
> 
> 标签：coldfusion, url-rewriting, isapi-rewrite

我被要求帮助一些 ColdFusion 开发，其中一项任务是进行 url 重写，主要是将 url 参数转换为更清晰的 url。

该站点位于托管服务上，cf8 在 iis 上运行，Helicon Tech ISAPI_Rewrite v2。

有什么我应该注意的吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T12:50:43.483

这应该没问题。IIS（或 ISAPI 插件）处理 URL 重写，然后将其传递给 CF，就好像它作为原始 URL 被请求一样。

大多数人进行 URL 重写是为了提高他们的 SERP 排名 - 关键是确保以前存在的原始 URL 现在返回 301（永久移动）重定向到您的新 URL。这会保留与旧 URL 关联的“链接汁”。不要使用 CFLOCATION 进行重定向 - 该标签执行 302 ...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T13:18:29.283

几年来我一直在使用 ISAPI_Rewrite 和 ColdFusion，并取得了不错的效果。

如果可以的话，我建议升级到版本 3。虽然版本 2 运行良好，但我发现最新版本更易于使用，因为它与[mod_rewrite](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)兼容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T18:12:40.200

底线是 URL 重写器和您的应用程序服务器（ColdFusion 或其他）一起工作应该永远不会出现问题。如果是这样，您可能错误地设置了重写规则（或者正在使用糟糕的重写器）。

URL 重写器在将请求移交给应用程序服务器之前更改请求的外观。只要最终结果是 foo.cfm?var=value，无论是实际的 URL 还是重写的结果，都可以。

# performance - 不同的浏览器如何处理没有 Expires Header 的静态内容的缓存？

> ID：865484
> 
> 赞同：0
> 
> 时间：2009-05-14T20:15:41.957
> 
> 标签：performance, http, browser

在网站上运行[YSlow 插件](http://developer.yahoo.com/yslow)后，我看到其中一个[建议](http://developer.yahoo.com/performance/rules.html#expires)是将远期过期标头添加到脚本、样式表和图像中。

我问了一个关于如何在 IIS 中设置它的[不同问题](https://stackoverflow.com/questions/865252/add-expires-or-cache-control-header-to-static-content-in-iis)，但我实际上只是对每个浏览器的行为方式感到好奇。

我已经读过 IE 会在每个浏览会话中缓存项目，因此一旦您在关闭浏览器后重新打开站点，它将需要重新加载所有内容。我相信 Firefox 会继续自己设置到期日期。我还听说通过 HTTPS 连接时 IE 根本不缓存。不过，我不确定这些是否准确，并且想知道是否有人可以澄清我可能有的任何误解。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T10:14:05.017

您对 Firefox 设置自己的到期日期是正确的。请参阅此博客文章中的第二项：

[http://blog.httpwatch.com/2008/10/15/two-important-differences-between-firefox-and-ie-caching/](http://blog.httpwatch.com/2008/10/15/two-important-differences-between-firefox-and-ie-caching/)

IE 和 Firefox 一样，可以缓存基于 HTTPS 的内容。但是，您需要设置 Cache-Control: public 以在 Firefox 中跨浏览器会话进行持久缓存。请参阅此博客文章中的提示 #3：

[http://blog.httpwatch.com/2009/01/15/https-performance-tuning/](http://blog.httpwatch.com/2009/01/15/https-performance-tuning/)

# javascript - 如何检查一个元素是否在 jQuery 中的另一个元素中？

> ID：865486
> 
> 赞同：38
> 
> 时间：2009-05-14T20:15:51.503
> 
> 标签：javascript, jquery

JavaScript 或 jQuery 中是否有任何直接的方法来检查一个元素是否在另一个元素中。

我并不是指`$(this).parent`我希望找到的元素可以是元素树中较低的随机数。

例如，我想检查是否`< div id="THIS DIV">`在`< div id="THIS PARENT">`：

```
<div id="THIS_PARENT">
 <div id="random">
  <div id="random">
   <div id="random">
    <div id="THIS_DIV">
(... close all divs ...) 
```

所以在伪代码中：

```
 if($("div#THIS_DIV").isWithin("div#THIS_PARENT")) ... 
```

如果没有任何直接的方法，我可能会为此做一个功能，但仍然值得一问。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-05-14T20:23:13.560

你可以这样做：

```
if($('#THIS_DIV','#THIS_PARENT').length == 1) {

} 
```

通过[指定](http://docs.jquery.com/Core/jQuery#expressioncontext)搜索的上下文（第二个参数），我们基本上是在说“在 ID 为的元素中查找 ID 为`#THIS_DIV`的元素`#THIS_PARENT`”。这是使用 jQuery 最简洁的方法。

我们也可以这样写，使用[`find`](http://docs.jquery.com/Traversing/find)，如果它对你更有意义的话：

```
if($('#THIS_PARENT').find('#THIS_DIV').length == 1) {

} 
```

或者像这样，使用[`parents`](http://docs.jquery.com/API/1.2/Traversing/parents)，如果你想从孩子向上搜索：

```
if($('#THIS_DIV').parents('#THIS_PARENT').length == 1) {

} 
```

这些中的任何一个都应该可以正常工作。该`length`位对于确保“搜索”的长度 > 0 是必要的。我个人当然建议您使用第一个，因为它是最简单的。

此外，如果您通过 ID 引用元素，则没有必要（尽管当然完全可以）在选择器前面加上标签名称。然而，就速度而言，它并没有真正帮助，因为 jQuery 将在`getElementById()`内部使用本机。使用标签名称仅在按类选择时很重要，这比只有元素具有特定类`div.myclass`时要快得多。`.myclass``<div>`

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-04-09T21:40:58.903

使用 jQuery >=1.4 (2010)，您可以使用非常快速的函数[jQuery.contains()](http://api.jquery.com/jQuery.contains/)

此静态方法适用于 DOM 元素，而不适用于 jQuery 元素并返回`true`or `false`。

```
jQuery.contains( container, descendant ) 
```

示例：要检查一个元素是否在文档中，您可以这样做：

```
jQuery.contains( document.body, myElement ) 
```

# javascript - FireFox 捕获自动完成输入更改事件

> ID：865490
> 
> 赞同：15
> 
> 时间：2009-05-14T20:16:13.750
> 
> 标签：javascript, firefox, autocomplete

我正在尝试订阅 ajax 自动完成表单的输入标记上的更改事件。当用户单击来自 FireFox 的自动完成建议时，不会触发这些更改事件。

我已经看到了 IE 的修复，但没有看到 FireFox。[您可以在此处](http://jehiah.cz/sandbox/onchange.html)查看此行为

重新创建的步骤：在其中一个框中键入任何输入，然后单击提交。

开始在同一个框中再次输入值。

您应该会看到自动完成建议框出现在输入框下方。请注意，单击建议不会触发 change 事件（它也不会触发 click 事件）

目前我唯一的选择是禁用此字段的自动完成功能，但我不想这样做。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2011-07-26T23:56:35.833

Firefox 4+ 在使用自动完成时触发“oninput”事件。
这里有一些 jQuery 让这更可操作：

```
$('#password').bind('input', function(){ /* your code */}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-09-29T16:20:29.010

我有同样的问题。

显然，有可用的密码管理器调试 [https://wiki.mozilla.org/Firefox:Password_Manager_Debugging](https://wiki.mozilla.org/Firefox:Password_Manager_Debugging)

所以我发现对我来说**DOMAutoComplete**事件被触发了，我已经设法通过 jQuery 的绑定成功地将它附加到一个字段上

```
$('#email').bind('DOMAutoComplete',function() { ... 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-14T20:24:14.447

如果它让你感觉更好，这是一个[已知的错误](https://bugzilla.mozilla.org/show_bug.cgi?id=87943)

建议的解决方法：（不是我的，从[这里](http://forums.mozillazine.org/viewtopic.php?f=38&t=584166&start=0&st=0&sk=t&sd=a)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Mozilla Firefox Problem</title>
<script type="text/javascript">
function fOnChange()
{
  alert('OnChange Fired');
}

var val_textBox;

function fOnFocus()
{
  val_textBox = document.getElementById('textBox').value;
}

function fOnBlur()
{
  if (val_textBox != document.getElementById('textBox').value) {
    fOnChange();
  }
}
</script>
</head>
<body>
<form name="frm">
<table>
<tr>
<td><input type="text" id="textBox" name="textBox" onFocus="fOnFocus()" onBlur="fOnBlur()"></td>
</tr>
<tr>
<td><input type="submit" value="Submit"></td>
</tr>
</form>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-10T00:12:01.633

另一个建议的解决方法。这次使用轮询，您可以以完全相同的方式工作，检查您的字段的“更改”。调整轮询值（根据您的喜好默认为 375 毫秒）。

我使用了 jQuery 和有人写的 jquery 插件： [https ://github.com/cowboy/jquery-dotimeout/](https://github.com/cowboy/jquery-dotimeout/)

Git Hub Src：[https ://raw.github.com/cowboy/jquery-dotimeout/master/jquery.ba-dotimeout.js](https://raw.github.com/cowboy/jquery-dotimeout/master/jquery.ba-dotimeout.js)

```
<html>
  <head>
    <meta charset="utf-8">
    <title>onChange() for Firefox / IE autofil get-around</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" src="/~dsloan/js/ba-dotimeout.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            var val;
            var count=0; // used to illustrate the "poll count" 
                         // when focusing on the element and typing 
                         // (vs not focused)

            // set a focus function to poll the input
            $("#myname").focus(function() {

                // start polling
                $.doTimeout('checkname', 375, function() {
                    ++count;

                    // no changes, just exit this poll
                    if($("#myname").val() == val) {
                        return true;

                    // store the value
                    } else {
                        val = $("#myname").val();
                    }
                    var str;

                    // do stuff here with your field....
                    if($(document.activeElement) && 
                        ($(document.activeElement).attr('id') ==
                        $("#myname").attr('id'))) {

                            var len = $("#myname").val().length;
                            if(len == 0) {
                                str = 'Timer called, length 0...';
                            } else if(len < 2) {
                                str = 'Timer called, length < 2...';
                            } else {
                                str = 'Timer called, valid!';
                            }
                    }

                    // show some debugging...
                    $("#foo span").html(str+' (count: '+count+'): '+
                        $(document.activeElement).attr('id')+
                        ', val: '+$("#myname").val());

                    return true;
                });
            });

            // set a blur function to remove the poll
            $("#myname").blur(function() {
                $.doTimeout('checkname');
            });

        });
    </script>
  </head>
  <body>
    <form action="#" method=post>
        Name: <input type="text" name="name" value="" id="myname" />
        Scooby: <input name="scooby" value="" id="scooby" />
        <input type="submit" value="Press Me!" />
    </form>
    <div id="foo"><span></span></div>
  </body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T20:18:57.003

一个可能的替代方案：您能否简单地使用计时器来判断文本框的值何时发生变化？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T20:19:10.123

您将不得不模糊输入字段并将焦点重新设置为它。不过，这将需要一些技巧。

# c# - 问一个潜在员工的一个好的 C# ASP.NET MVC 问题是什么？

> ID：865497
> 
> 赞同：18
> 
> 时间：2009-05-14T20:17:40.750
> 
> 标签：c#, asp.net-mvc

我即将为我们的 ASP.NET MVC 项目雇用一位新程序员。我在面试中非常重视我有多喜欢候选人的态度，以及我如何看待他们与他们一起工作、交谈和享受成为团队的一员，但更实际的一点是，我需要淘汰那些从那些真正有能力每天适应和克服编程问题的人那里谈论一个好游戏。

任何人都可以提出任何好的简短问题/练习（最好是在 C# 中）来区分聪明的候选人和好的谈话者吗？

更新 - 非常感谢所有回答的人，我以传统的 StackOverlfow 方式选择了投票最多的人，但仍然感谢所有其他建议。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-14T20:33:57.577

MVC 首字母缩写词中的哪个字母应负责在网上商店 Web 应用程序中执行以下功能：

*   计算购物车中商品的总支付金额 (M)
*   建立一个要购买的物品的html表（五）
*   将未经过身份验证的用户重定向到他们可以输入帐单信息的页面 (C)

等等

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-14T11:31:47.717

ASP.Net MVC 面试中可能会问到的问题。

1-什么是 ASP.Net MVC？

2- 什么是剃须刀？

3-什么是TDD？

4-什么是BDD？

5-什么是依赖注入（DI）？

6- 什么是 ViewData 和 ViewBag？

7-在哪个程序集中定义了 MVC 框架？

8-模型、视图和控制器在 MVC 应用程序中代表什么？

9- ASP.NET MVC 的优点是什么？

10-哪种方法为测试驱动开发提供更好的支持 - ASP.NET MVC 或 ASP.NET Webforms？

11-控制器动作方法的不同返回类型的名称？

12- NonActionAttribute 的意义是什么？

13-是否可以跨多个控制器共享视图？

14-控制器在MVC应用程序中的作用是什么？

15- asp.net MVC 应用程序中定义的路由规则在哪里？

16- ASP.NET MVC 应用程序中存在的默认路由的 3 段是什么？

17- ASP.NET MVC 应用程序，利用 2 个位置的设置使路由正常工作。这2个地方是什么？

18- 使用 ASP.NET 路由有什么好处？

19-指定路线所需的三件事是什么？

20-以下默认路由有什么用？

21-添加路由到 webforms 应用程序和 mvc 应用程序有什么区别？

22-如何处理路线定义中可变数量的段？

23-向路线添加约束的两种方法是什么？

24- 举两个不应用路由的场景示例？

25- MVC 应用程序中动作过滤器的用途是什么？

26- 如果我实现了多个过滤器，这些过滤器的执行顺序是什么？

27- asp.net mvc 应用程序中有哪些不同类型的过滤器？

28-举一个asp.net mvc应用程序中的授权过滤器示例？

29- 哪个过滤器首先在 asp.net mvc 应用程序中执行？

30-过滤器可以在asp.net mvc应用程序中应用的级别是什么？

31-是否可以创建自定义过滤器？

32-最终执行了哪些过滤器？

33-是否可以取消过滤器执行？

34- OutputCacheAttribute 类代表什么类型的过滤器？

35- 2 个流行的 asp.net mvc 视图引擎是什么？36-你会用什么符号来表示剃刀视图中代码块的开始？

37-你会用什么符号来表示，aspx 视图中代码块的开始？

38-在剃刀语法中，@符号的转义序列字符是什么？

39- 当使用razor 视图时，您是否必须采取任何特殊步骤来保护您的asp.net mvc 应用程序免受跨站脚本（XSS）攻击？

40- 什么是 asp.net 母版页等效，当使用剃刀视图时？

41-什么是部分？

42- razor 视图的文件扩展名是什么？

43-如何使用剃刀语法指定注释？

44-ASP.NET MVC中的values参数是怎么回事？

45- 什么网站托管适合 ASP.NET MVC？

46-什么是Asp.Net MVC项目中的区域以及如何在ASP.Net项目中实现区域/

47- 如何在 ASP.Net mVC 项目中使用 Session？

48- 如何在 ASP.Net 应用程序中将数据从一页持久化到另一页？

49-什么是临时数据？

50-什么是JSON？

51-什么是Lambda表达式？

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-14T20:22:00.147

第一件事。他们甚至知道什么是 MVC。不仅是 TLA（三个字母的首字母缩写词），而且他们可以向您描述它。那么有什么好处。询问他们对此的看法也无妨。很高兴知道他们是否甚至喜欢 MVC 框架。

接下来，询问他们是否使用过任何其他 MVC 框架。Struts、Spring MVC、Zend 或类似的东西。

询问他们是否知道会话何时开始，网络上的一般状态问题等。

还有一点数据库。询问他们是否对数据库持久层有任何经验。

然后仅仅因为你可以问一个很难的技术问题，让他们编写一个函数来比较两个二叉树的值和结构，看看它们是否相同。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-07-15T17:48:37.207

任何在面试前阅读一本好的 MVC 书籍或 MVC 101 的人都可以回答诸如什么是 MVC、描述它等问题。确定他们是否有任何 MVC 工作知识的可靠方法是问他们，按照他们如何使用 MVC 处理 Web 应用程序的顺序排列步骤。例如：他们说，他们会先布局模型吗？或意见？为什么？他们首先在控制器上工作吗？只是典型应用程序的基本流程。一个按顺序描述这个过程并给出为什么它是这样的理由的候选人将是你正在寻找的赢家。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-14T20:21:33.037

什么是 MVC？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-14T20:58:25.303

您是否正在为短期项目雇用承包商？

如果答案是否定的，我认为 MVC 不应该真正考虑到这个场景。你几乎不应该期望一个非雇佣枪的员工会随便加入并富有成效。说实话，MVC 并不是一个困难的学习曲线。如果您长期雇用某人，而他们的第一个项目恰好是一个 MVC 网站，我认为您更适合判断他们的一般能力，而不是具体的技术。

相反，看看他们对设计模式的理解。MVC 并不是一种全新的方法。如果这个人能够理解 SOC，他们应该能够很容易地了解 MVC 的细节。该死的，他们可能可以在飞行中学习它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-06-03T19:28:15.703

要求他们对现有的 MVC 站点进行一些实质性（但简单）的更改。

这将允许您观察他们对 MVC 站点的组织的熟悉程度。如果您要求他们进行 HTML 更改，他们会直接进入 Views 文件夹吗？如果您的更改是在业务逻辑中，他们会直接进入控制器操作吗？

听起来有点明显，我意识到。但如果他们对这些事情犹豫不决，这意味着他们实际上并没有在 MVC 上花费太多时间。你在测试速度，真的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T20:21:39.400

告诉他在写字板上画出 ASP.NET MVC 模型的流程

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-14T21:45:40.727

这很有趣。前几天我问了一个很接近的问题。看看你是否在那里找到有用的东西。

[问开发人员是否更喜欢 WebForms 或 MVC 是否可以很好地表明他的熟练程度？](https://stackoverflow.com/questions/860057/can-asking-a-developer-whether-he-prefers-webforms-or-mvc-be-a-good-indicator-of)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-01T20:19:01.753

我认为最好的选择不一定是在一个问题中，而是在他们的投资组合中。查看他们构建的应用程序，并直接在应用程序上提问。为什么这个，为什么那个？这样您就可以很好地了解它们的发展方式。希望他们了解框架和关注点分离。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-06-03T17:26:29.420

你可以问他们：Asp.net MVC 如何有助于使搜索引擎友好的网站？路由如何在.net MVC中工作？，ViewEngine在asp.net中的作用是什么，如果可以，我们可以使用自定义视图引擎吗？我们如何制作控制器类而不在类名中添加“Contrller”后缀？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-02-11T15:11:56.373

我在 datalist 中使用计时器进行倒计时，并将其值显示在标签中。

但我的问题是它在数据列表中的更新时间不正确，当我刷新页面时，它会得到更新

# python - 如何是实例（x，模块）？

> ID：865503
> 
> 赞同：18
> 
> 时间：2009-05-14T20:18:19.330
> 
> 标签：python

我需要测试一个变量是否是一个模块。如何以最干净的方式做到这一点？

我需要它来初始化一些调度程序函数，并且我希望该函数可以接受 dict 或模块作为参数。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-14T20:21:08.777

```
>>> import os, types
>>> isinstance(os, types.ModuleType)
True 
```

（它也适用于你自己的 Python 模块，以及像 .）这样的内置模块`os`。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T20:37:35.710

我喜欢使用它，因此您不必导入 types 模块：

```
isinstance(amodule, __builtins__.__class__) 
```

# jquery - 复选框和 JQUERY：“已选中”始终为 FALSE

> ID：865513
> 
> 赞同：20
> 
> 时间：2009-05-14T20:19:58.267
> 
> 标签：jquery, checkbox

代码如下，复选框始终为 FALSE。但在页面上它是不同的。它不会被选中或取消选中。

```
<script type="text/javascript">
 $('.cbOzelHastaAdi').unbind('click');

 $('.cbOzelHastaAdi').click( function() {

    var parentDiv = $(this).parent().get(0);
    var cbs = $(parentDiv).find('table input:checkbox');

   if($(this).attr("checked") === "true") {
        cbs.each(function() { $(this).attr('checked', false); });
    }
    else{
        cbs.each(function() { $(this).attr('checked', true); });
    }

})

</script> 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-14T20:41:00.757

问题之一是您`checked`在顶部复选框和标签周围的跨度上具有属性，并且将事件处理程序绑定到跨度，因此`checked`将始终保留`checked`在跨度上。

我已将事件处理程序移至复选框，并稍微整理了代码。虽然我不认为在 HTML 元素上构建自己的属性（即在 span 元素上检查属性）存在问题（我认为 XHTML 严格验证对它们失败），但我不认为这样做是否是好的做法。

我可以看到您正在使用 ASP.NET，基于 ID 修改 - 您可以使用服务器端`<%= myControl.ClientID %>`获取修改后的 id 以在发送给客户端的 HTML 中呈现。

[这里的工作示例](http://jsbin.com/opuza)

```
 $(function() {     
        $('#rptOzel_ctl00_rptOzelHastalar_ctl00_cbOzelKurumHastasi').unbind('click');
        $('#rptOzel_ctl00_rptOzelHastalar_ctl00_cbOzelKurumHastasi').click( function() {

           var cbs = $('table input:checkbox');  

           if($(this).is(':checked')){
               cbs.each(function() { $(this).attr('checked', true); });
           }
           else{
            cbs.each(function() { $(this).attr('checked', false); });
           }

        });
    }); 
```

**编辑：**

作为对您的评论的回应，您有几个选项可以解决 clientid。如果您在 aspx 页面中编写 jQuery，那么您可以简单地使用

`$('#<%= cbOzelKurumHastasi.ClientID %>')`

代替

`$('#rptOzel_ctl00_rptOzelHastalar_ctl00_cbOzelKurumHastasi')`

如果您将 jQuery 放在外部脚本文件中，那么您可以将其放在您的 aspx 页面中

```
<script type="text/javascript">
var cbOzelKurumHastasi = '#<%= cbOzelKurumHastasi.ClientID %>';
</script> 
```

然后在您的外部脚本文件中使用该变量

```
$(function() {     
            $(cbOzelKurumHastasi).unbind('click');
            $(cbOzelKurumHastasi).click( function() { ... 
```

有关其他选项，请查看此问题和答案-[如何阻止 ASP.NET 更改 ID 以使用 jQuery](https://stackoverflow.com/questions/497802/how-to-stop-asp-net-from-changing-ids-in-order-to-use-jquery/498972#498972)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T20:38:05.460

我通常使用 jQuery 的 .is() 功能来检查这个

```
$('.cbOzelHastaAdi').click( function() {
  if($(this).is(':checked')){
    ...
  }else{
    ...
  }
}) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T20:33:25.223

可能是因为您将检查属性的值与字符串而不是布尔值进行比较，并使用 === 运算符来比较值和类型？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-23T14:05:57.443

我遇到了同样的问题；检查是否选中了复选框（以任何不同的方式）总是返回 false。

我的解决方案（问题过程）在使用的 JQuery 选择器中。

uzay95 使用类选择器“.”来选择其复选框。

$('.cbOzelHastaAdi')**

它返回一个结果集。因此，检查它是否被选中是无效的，因为它们可能是多个复选框......我知道他在他的代码中使用了**this**关键字，但对我来说这也没有解决问题。

**只要您按 ID 选择复选框，您就可以评估其“已选中”属性。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T21:01:56.417

Russ Cam 的答案有效，但为什么不 jQueryify 更多呢？

```
$(function() {     
    $('.cbOzelHastaAdi').live('click', function() {
        $(this).parents('div').find('table input:checkbox').attr('checked', $(this).attr('checked'));
    });
}); 
```

这假定类*cbOzelHastaAdi*现在附加到复选框而不是 span 元素。这应该允许您避免所有混乱的 ASP 重命名，并允许每页有多个相似的表，而无需多个单击事件函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-26T14:49:26.957

=== 是 JS 的类型安全比较器

请参阅： [https ://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Comparison_Operators](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Comparison_Operators)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T20:34:29.603

我发现以下可能是确定 jQuery 中已检查状态的最佳方法：

```
var cbs = $(parentDiv).find('table input:checkbox:checked'); 
```

这将为您提供已检查的每个输入的数组。

这主要来自 jQuery 文档：

> [选择器/选中](http://docs.jquery.com/Selectors/checked)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-26T11:02:01.880

这也有效：

```
(($('input[name="myCheckBox"]:checked').val())=='on') 
```

它将返回 true 或 false

其中复选框定义为：

```
<input type="checkbox" name="myCheckBox"> 
```

# c# - VS 安装项目：将开始菜单链接添加到合并模块中的文件

> ID：865515
> 
> 赞同：0
> 
> 时间：2009-05-14T20:20:14.100
> 
> 标签：c#, visual-studio, setup-project, merge-module

我创建了一个新的 Visual Studio 安装项目，它使用另一个合并模块项目的输出。合并模块包含将安装到“x:\program files\\Documentation”中的文件。这些文件之一是“documentation.pdf”。我想在文档 PDF 中添加指向安装项目中开始菜单的链接。问题是安装项目不允许您“创建快捷方式”到实际不在安装项目中的文件。我看不到查看或链接到合并模块的方法。

我似乎也找不到一种方法来创建将在合并模块中重命名的通用智能菜单位置。例如，“Module Retargetable Folder”中的所有文件都将被重定向到“Installation Folder”。我想对开始菜单做同样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-17T13:03:22.777

I am assuming that this can't be done.

# html - html页面大小标准

> ID：865519
> 
> 赞同：2
> 
> 时间：2009-05-14T20:20:46.110
> 
> 标签：html

今天html页面的标准宽度是多少？我知道它从 10 年前发生了变化，当时人们有不同的显示器，等等。截至 2009 年是什么？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T20:23:49.940

略**小于**1024 像素，以容纳滚动条。960 很受欢迎，因为它很容易被许多其他数字整除，以制作网格布局。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T20:23:32.173

取决于观众。这也可能是一个重复的问题，因为我之前已经回答过了。基本上，我认为美国消费者的目标宽度为 1024 像素，国际和企业用户的宽度为 800 像素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T20:26:14.770

我会做 1024x768，但要确保它可以缩放，或者在 800x600 中很好地显示最重要的项目

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T21:45:36.920

请记住，并非所有人都最大化我们的网络浏览器。使其灵活。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T20:23:13.267

您通常使用 1024x768 是安全的

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T20:23:51.250

当我开发新页面时，我通常会尝试设计至少 1024x768。似乎是最普遍使用的分辨率。

根据谷歌分析（无论如何在我的页面上），仍然有一些人使用 800x600 的点击率，但我通常不太担心那一小部分。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T20:30:33.123

我认为假设 800x600 是最低分辨率是相当安全的。所以瞄准或最小总宽度为 760 应该没问题。

Max 是另一回事。诸如 960.gs 之类的 CSS 框架适用于整体固定的最大值，但对于一般的流动宽度也有很多要说的。

流体的一个问题是，对于更大的分辨率，文本行变得更长并且可读性逐渐降低，因此您可能会做的是：具有固定宽度的文本元素，可能是 350 到 400 像素，其余以 em 或百分比表示。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T20:36:18.257

如有疑问，请复制雅虎。不久前，他们切换到至少 1024x768 的屏幕分辨率。我检查了我的专业网站上的分析，其中大多数在 800x600 上的用户群都小于 3%。

还要考虑 960 像素宽布局的流行，如[960 项目](http://960.gs/)所示。我会说你很清楚 1024x768 作为你的最低显示器分辨率，除非你是专门为八十多岁和视障人士设计的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-08-28T03:44:22.827

你可能喜欢一些代码？干得好...

```
body
{
    margin: 0px;
    padding: 0px;
    font-family: "Lucida Grande","Lucida Sans Unicode",Arial,Verdana,sans-serif;
}

#mr-workspace
{
    width:982px;
    margin-right:auto;
    margin-left:auto;
}

#mr-top-pane
{
   position: relative;
   left: 0px;
   width:982px;
   background-color:#000000;
}

#mr-left-pane
{
   position: relative;
   float: left;
   left: 0px;
   width: 180px;
   background-color:#FF0000;
   min-height:600px;
}

#mr-center-pane
{
   position: relative;
   float: left;
   left: 0px;
   width: 560px;
   background-color:#EAEAEA;
   border-right:1px solid #666666;
   border-left:1px solid #666666;   
}

#mr-right-pane
{
   position: relative;
   float: left;
   left: 0px;
   width: 240px;
   background-color:#FF0000;
}

#mr-bottom-pane
{
   position:relative;
   left: 0px;
   width:982px;
   background-color:#999999;
   clear:both;
} 
```

HTML 代码：

```
<div id="mr-workspace">
  <div id="mr-bodyContainer">
    <div id="mr-titlerow"></div>
      <div id="mr-mainarea">
        <div id="mr-top-pane">
          TOP
        </div>
      <div id="mr-left-pane">
      LEFT
      </div>
      <div id="mr-center-pane">
        <video src="movie.ogg" controls="controls">
             your browser does not support the video tag
        </video>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean at commodo nunc. Aliquam feugiat urna in ipsum varius et fermentum massa ullamcorper. Donec sed nisi quis lorem pharetra imperdiet. Quisque dictum vehicula ipsum ac laoreet. Morbi ultricies viverra rhoncus. In felis mauris, porttitor id imperdiet vitae, eleifend at elit. Donec consequat sodales odio et iaculis. Aliquam fringilla ipsum a magna convallis auctor. Etiam semper magna at urna egestas non tempor nunc consectetur. Nam vestibulum tincidunt odio vitae facilisis.</p>
      </div>
      <div id="mr-right-pane">
      RIGHT
      </div>
      <div id="mr-bottom-pane">
      Bottom
      </div>
    </div>
  </div>
</div> 
```

# html - 第 2 列低于第 1 列，这是什么常见原因？

> ID：865520
> 
> 赞同：1
> 
> 时间：2009-05-14T20:20:49.293
> 
> 标签：html, css

我的 HTML 太精致了，无法在此处发布。

我有一个 2 列布局，第一列是 160 像素，第二列要大得多。

出于某种原因，第 2 列隐藏在第 1 列之下。

造成这种情况的常见原因是什么？

**更新**

我想要的是这样的：

列#1 列#2

显示的内容（**firefox 没问题，IE6 导致问题**）：

列#1
列#2

**更新**

第二列被包裹在一个

blueprintcss 有这个：

```
.container:after {content:".";display:block;height:0;clear:both;visibility:hidden;} 
```

所以我想这是**清楚的：两者**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T20:43:58.847

假设两列都是浮动的（左），如果：

*   它已`clear:left;`分配给它
*   对于可用空间来说太宽了

如果问题出现在 IE 6 中，则可能是[IE 6 3 像素间隙](http://www.positioniseverything.net/explorer/threepxtest.html)错误。

（如果您在帖子中放置一些实际代码，我们可能会有更好的机会帮助您。目前我们正在猜测。）

**更新**

我不认为它`clear: both;`——该规则不会影响 IE 6，因为它不支持`:after`伪选择器。这是一个演示它的测试页面：

[http://www.pauldwaite.me.uk/testy.html](http://www.pauldwaite.me.uk/testy.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T22:18:29.680

除了 Paul 的 2 个原因之外，您还必须牢记 IE6 “双边距”错误。

在 IE6 中，`float`属性相应地使边距翻倍（`float: left;`影响`margin-left`，反之亦然）。

# c# - 打印 DataGrid 时的文本换行？。网

> ID：865521
> 
> 赞同：0
> 
> 时间：2009-05-14T20:20:57.483
> 
> 标签：c#, .net, printing, datagrid, word-wrap

我正在尝试在 Windows 窗体应用程序中打印 DataGrid，当列的宽度设置（它是可自定义的）太窄而无法容纳文本时，它只会截断文本而不是换行。DataGrid 中是否有设置文本换行的属性？

我添加了一些代码来帮助诊断问题。

```
private void PrintRow(PointF location, PrintPageEventArgs e)
    {
        Graphics g = e.Graphics;
        PointF curLocation = location;

        //Measure the height of one row
        SizeF charSize = g.MeasureString(MEASURE_CHAR.ToString(), this.Grid.Font);
        float rowHeight = charSize.Height + CELL_PADDING * 2;

        //Print the vertical gridline on the left side of the first cell
        //Note that we only print the vertical gridlines down to the bottom 
        //of the last printed row
        int maxRowsOnPage = (int)Math.Floor(e.MarginBounds.Height / rowHeight);            
        int rowsRemaining = this.Grid.Rows.Count - _curRowIdx;
        int rowsToPrint = Math.Min(maxRowsOnPage, rowsRemaining);
        float bottom = e.MarginBounds.Top + (rowsToPrint * rowHeight);
        g.DrawLine(Pens.Black, curLocation.X, e.MarginBounds.Top, curLocation.X, bottom);

        DataGridViewRow row = this.Grid.Rows[_curRowIdx];
        foreach (QueryField field in _fields)
        {                
            foreach (DataGridViewCell cell in row.Cells)
            {
                //Exit early if this is not the correct cell
                if (this.Grid.Columns[cell.ColumnIndex].HeaderText != field.FieldLabel) continue;                    

                //Calculate where we need to draw the next cell
                int maxChars = field.MaxLength > 0 ? field.MaxLength : field.FieldLabel.Length;
                SizeF maxSize = g.MeasureString(string.Empty.PadLeft(maxChars, MEASURE_CHAR), this.Grid.Font);
                RectangleF boundingRect = new RectangleF(curLocation, maxSize);                    

                //Make sure we don't overshoot the right margin
                if (boundingRect.Left >= e.MarginBounds.Right)
                {
                    break;
                }
                if (boundingRect.Right > e.MarginBounds.Right)
                {
                    boundingRect.Width = boundingRect.Width - (boundingRect.Right - e.MarginBounds.Right);
                }

                //Get the field value
                string fieldValue = string.Empty;
                if (cell.Value != null)
                {
                    fieldValue = cell.Value.ToString();
                }

                //Draw the field value                    
                g.DrawString(fieldValue, this.Grid.Font, Brushes.Black, (RectangleF)boundingRect, sf);

                curLocation.X += boundingRect.Width;
                curLocation.X += CELL_PADDING;

                //Print the vertical gridline between this cell and the next
                if (boundingRect.Right <= e.MarginBounds.Right)
                {
                    g.DrawLine(Pens.Black, curLocation.X, e.MarginBounds.Top, curLocation.X, bottom);                       
                }

                //Move the current location to the next position
                curLocation.X += CELL_PADDING;
            }
        }

        //Draw the top gridline                 
        g.DrawLine(Pens.Black, e.MarginBounds.Left, e.MarginBounds.Top, curLocation.X, e.MarginBounds.Top);

        //Draw the bottom gridline     
        curLocation.Y += charSize.Height;                
        curLocation.Y += CELL_PADDING;
        g.DrawLine(Pens.Black, e.MarginBounds.Left, curLocation.Y, curLocation.X, curLocation.Y);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T20:31:00.360

试试这个线程。有完全相同问题的人。希望能帮助到你！

[如何在 Windows 应用程序的数据网格的文本框列中换行文本。](http://tinyurl.com/qyge5z)

# objective-c - 为什么我在此 Cocoa 代码中收到 isEqualToString 错误？

> ID：865527
> 
> 赞同：0
> 
> 时间：2009-05-14T20:21:39.667
> 
> 标签：objective-c, cocoa

我不断收到此错误：

[替代文字 http://img514.imageshack.us/img514/2203/help.tif](http://img514.imageshack.us/img514/2203/help.tif)

它是什么？我什至从来没有叫过“isEqualToString”。

这是我的笑话.M

```
@implementation Joke
@synthesize joke;
@synthesize rating;

- (id)init {
[super init];
return self;
 }

- (void)dealloc {
[joke release];
[super dealloc];    
}

+ (id)jokeWithValue:(NSString *)joke {
Joke *j = [[Joke alloc] init];
j.joke = joke;
return [j autorelease];
}

@end 
```

这是笑话.h

```
@interface Joke : NSObject {
NSString *joke;
int rating;
}

+ (id)jokeWithValue:(NSString *)joke;

@property (readwrite, copy) NSString *joke;
@property (readwrite) int rating;

@end 
```

这里是开玩笑的地方

```
#import "TableViewController.h"
#import "Joke.h"

@implementation TableViewController
@synthesize jokes;

- (id)initWithCoder:(NSCoder *)coder {
if (self = [super initWithCoder:coder]) {
    self.jokes = [NSMutableArray arrayWithObjects:
                  [Joke jokeWithValue:@"If you have five dollars and Chuck Norris has five dollars, Chuck Norris has more money than you"],
                  [Joke jokeWithValue:@"There is no 'ctrl' button on Chuck Norris's computer. Chuck Norris is always in control."],
                  [Joke jokeWithValue:@"Apple pays Chuck Norris 99 cents every time he listens to a song."],
                  [Joke jokeWithValue:@"Chuck Norris can sneeze with his eyes open."],
                  nil];
    }
return self;
 }

- (void)viewDidLoad {
self.navigationItem.leftBarButtonItem = self.editButtonItem;
} 

 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView { // Saying how many sections wanted (Just like in address, where sorts by first name)
return 1;
 }

 - (NSInteger)tableView:(UITableView *)tableView 
numberOfRowsInSection:(NSInteger)section {
return [jokes count];
 }

 - (UITableViewCell *)tableView:(UITableView *)tableView 
     cellForRowAtIndexPath:(NSIndexPath *)indexPath {
  static NSString *CellIdentifier = @"Team";    
  UITableViewCell *cell = 
[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
  if (cell == nil) {
    cell = [[[UITableViewCell alloc] 
             initWithFrame:CGRectZero 
             reuseIdentifier:CellIdentifier] autorelease];
   }
cell.text = [jokes objectAtIndex:indexPath.row];
   return cell;
  }

 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath  *)indexPath {
 }

 - (void)viewWillAppear:(BOOL)animated {
[super viewWillAppear:animated];
 }

 - (void)viewDidAppear:(BOOL)animated {
[super viewDidAppear:animated];
 }

 - (BOOL)shouldAutorotateToInterfaceOrientation:
 (UIInterfaceOrientation)interfaceOrientation {
  return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
  }

 - (void)didReceiveMemoryWarning {
[super didReceiveMemoryWarning]; 
 }

 - (void)dealloc {
 [jokes release];
 [super dealloc];
 }

 @end 
```

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-14T21:00:23.817

替换这一行：

```
cell.text = [jokes objectAtIndex:indexPath.row]; 
```

这些行：

```
Joke *j = (Joke *)[jokes objectAtIndex:indexPath.row];
if( j )
  cell.text = j.joke; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T21:20:34.610

堆栈跟踪将帮助您准确找到调用的内容`isEqualToString:`。不幸的是，它没有给你任何符号，所以你必须做一些挖掘。

在 Objective-C 方法中，有两个隐藏参数始终作为前两个参数传递：`self`一个指向消息发送到的对象的指针，以及`_cmd`一个指向包含消息名称的 C 字符串的指针。发送。检查`_cmd`堆栈帧中的参数将帮助您调试问题。

您要做的第一件事是在抛出异常之前设置一个断点。打开调试器控制台 (Cmd+Shift+R) 并通过键入以下命令在堆栈跟踪顶部的函数中添加断点：

```
break 2438463755 
```

现在运行你的应用程序，调试器应该会在抛出异常之前中断。它还应该为您提供完整的符号回溯；如果没有，您将不得不自己走堆栈。您可以遍历堆栈并打印出各种`_cmd`参数的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T20:34:31.133

您正在使用函数参数隐藏 ivar 名称。尝试将您的 jackWithValue: 方法更改为：

在 joke.h 中：

```
+ (id)jokeWithValue:(NSString *)aJoke; 
```

在笑话.m：

```
+ (id)jokeWithValue:(NSString *)aJoke {
     Joke *j = [[Joke alloc] init];
     j.joke = aJoke;
     return [j autorelease];
} 
```

请注意，NSString 变量名称已更改，因此它不再影响 iVar 笑话。

**编辑：**

看到笑话是如何被调用的，看起来好像你正在为 cell.text 分配一个笑话对象，我相信它期待一个 NSString 而不是一个笑话。

尝试设置：

```
cell.text = [[jokes objectAtIndex:index] joke]; 
```

在 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T20:32:59.403

错误不在 Joke 类的定义中，而是在某个地方被使用。在大多数出现此类错误的情况下，这是内存管理错误的结果——某个对象（可能是一个字符串）被释放，另一个被分配到它的旧内存位置。尝试使用[NSZombieEnabled](http://www.cocoadev.com/index.pl?NSZombieEnabled)运行，看看它是否会向已释放对象显示消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T20:24:23.653

您的错误消息没有显示，但我假设您遇到了一个在幕后调用 isEqualToString 的语句，其中一个对象不是字符串

# ms-access - 使用 VBA 替换 MS Access 中的模块文本

> ID：865530
> 
> 赞同：5
> 
> 时间：2009-05-14T20:22:06.373
> 
> 标签：ms-access, vba

如何从 Access 中的另一个模块中搜索和替换 Access 中的模块中的文本？我在谷歌上找不到这个。

仅供参考，我想出了如何以编程方式删除模块：

调用 DoCmd.DeleteObject(acModule, modBase64)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T14:58:49.840

After a lot of searching I found this code:

```
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Function to Search for a String in a Code Module. It will return True if it is found and
'False if it is not. It has an optional parameter (NewString) that will allow you to
'replace the found text with the NewString. If NewString is not included in the call
'to the function, the function will only find the string not replace it.
'
'Created by Joe Kendall 02/07/2003
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

Public Function SearchOrReplace(ByVal ModuleName As String, ByVal StringToFind As String, _
        Optional ByVal NewString, Optional ByVal FindWholeWord = False, _
        Optional ByVal MatchCase = False, Optional ByVal PatternSearch = False) As Boolean

    Dim mdl As Module
    Dim lSLine As Long
    Dim lELine As Long
    Dim lSCol As Long
    Dim lECol As Long
    Dim sLine As String
    Dim lLineLen As Long
    Dim lBefore As Long
    Dim lAfter As Long
    Dim sLeft As String
    Dim sRight As String
    Dim sNewLine As String

    Set mdl = Modules(ModuleName)

    If mdl.Find(StringToFind, lSLine, lSCol, lELine, lECol, FindWholeWord, _
            MatchCase, PatternSearch) = True Then
        If IsMissing(NewString) = False Then
            ' Store text of line containing string.
            sLine = mdl.Lines(lSLine, Abs(lELine - lSLine) + 1)
            ' Determine length of line.
            lLineLen = Len(sLine)
            ' Determine number of characters preceding search text.
            lBefore = lSCol - 1
            ' Determine number of characters following search text.
            lAfter = lLineLen - CInt(lECol - 1)
            ' Store characters to left of search text.
            sLeft = Left$(sLine, lBefore)
            ' Store characters to right of search text.
            sRight = Right$(sLine, lAfter)
            ' Construct string with replacement text.
            sNewLine = sLeft & NewString & sRight
            ' Replace original line.
            mdl.ReplaceLine lSLine, sNewLine
        End If
        SearchOrReplace = True
    Else
        SearchOrReplace = False
    End If

    Set mdl = Nothing
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T03:09:02.683

我假设您的意思是如何以编程方式执行此操作（否则它只是 ctrl-h）。除非这是在 VBE 加载项的上下文中完成的，否则它很少（如果有的话）是一个好主意。自我修改代码通常被 AV 软件标记，尽管访问可以*让*你这样做，但它并没有足够强大来处理它，并且可能导致损坏问题等。此外，如果你使用自我修改代码，你会阻止自己曾经能够使用 MDE 甚至项目密码。换句话说，您将永远无法保护您的代码。如果您让我们知道您正在尝试使用自修改代码解决什么问题，并查看是否可以找到更可靠的解决方案，这可能会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T20:51:07.427

查看 Access 库的 VBA 对象浏览器。在 Module 对象下，您可以搜索 Module 文本以及进行替换。这是一个简单的例子：

在模块 1

```
Sub MyFirstSub()
    MsgBox "This is a test"
End Sub 
```

在模块 2

```
Sub ChangeTextSub()
    Dim i As Integer

    With Application.Modules("Module1")
        For i = 1 To .CountOfLines
            If InStr(.Lines(i, 1), "This is a Test") > 0 Then
                .ReplaceLine i, "Msgbox ""It worked!"""
            End If
        Next i
    End With
End Sub 
```

运行 ChangeTextSub 后，MyFirstSub 应为

```
Sub MyFirstSub()
MsgBox "It worked!"
End Sub 
```

这是一个非常简单的搜索，但希望这可以让您继续前进。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-19T08:46:41.180

附加功能（循环遍历所有行）

```
Public Function ReplaceWithLine(modulename As String, StringToFind As String, NewString As String)
    Dim mdl As Module
    Set mdl = Modules(modulename)

    For x = 0 To mdl.CountOfLines
     Call SearchOrReplace(modulename, StringToFind, NewString)
    Next x

    Set mdl = Nothing
End Function 
```

欣赏^^

# active-directory - 通过 WinNT 提供程序查询时 DirectoryEntry 中的 NativeGuid 是什么？

> ID：865539
> 
> 赞同：0
> 
> 时间：2009-05-14T20:23:46.133
> 
> 标签：active-directory, directoryservices

我正在编写一个我想与 Active Directory 以及本地用户和组一起使用的应用程序。我想我可以使用 DirectoryEntry 的 NativeGuid 属性作为唯一标识符，该标识符是使用 WinNT 提供程序针对 LocalHost 检索的。[但是，在LinqPad](http://www.linqpad.net/)中使用以下代码，我得到了两个条目相同的 NativeGuid。使用 LDAP 提供程序查询活动目录似乎会产生独特的结果，但现在我不确定。

```
System.DirectoryServices.DirectoryEntry localuserde = 
  new System.DirectoryServices.DirectoryEntry("WinNT://localhost/localuser");
localuserde.NativeGuid.Dump("localUser Guid");

System.DirectoryServices.DirectoryEntry adminde = 
new System.DirectoryServices.DirectoryEntry("WinNT://localhost/administrator");
adminde.NativeGuid.Dump("administrator Guid"); 
```

有人可以解释一下在使用 WinNT 提供程序时 NativeGuid 代表什么吗？uniqueId 是否有更好的替代品，或者 SID 是更好的选择吗？

*要在 LinqPad 中运行上述内容，请按 F4 并将 System.DirectoryServices.dll 添加到程序集列表中。然后确保 localuser 存在或将名称更改为系统上的本地用户。然后按F5。*

谢谢，

肖恩持有人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T20:28:39.773

This [other question](https://stackoverflow.com/questions/828036/how-to-get-user-guid-from-active-directory-using-winnt-protocol)说不要使用NativeGuid。我会改用“SID”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T20:28:57.667

我认为 SID 可能是您在任何与用户和组相关的场景中的最佳选择。实际上没有其他唯一标识符 - 尤其是 WinNT 提供程序。

有关[WinNT 与 LDAP](http://www.rlmueller.net/WinNT_LDAP.htm)讨论的更多信息以及关于每个提供程序真正公开的属性（以及它们的名称）的出色参考 Excel 表，请访问 Richard Mueller 的[Hilltop Lab](http://www.rlmueller.net/index.html)。Richard 是一位 ADSI MVP，他为任何对 Active Directory 和 LDAP 感兴趣的人提供了极好的内容。

马克

# flash - Flash：addEventListener 未检测到输入文本框中的粘贴事件

> ID：865542
> 
> 赞同：3
> 
> 时间：2009-05-14T20:23:55.230
> 
> 标签：flash, actionscript-3, event-handling, copy-paste

我是 Flash 新手，我似乎无法执行这个简单的操作。

（我使用的是 ActionScript 3.0）

我在编辑器中创建了一个输入文本框。实例名称为“test”。在我的动作编辑器中，我有这个：

```
import flash.events.Event;
this.test.addEventListener(Event.PASTE, pasteHandler);

function pasteHandler(e:Event)
{
    trace("blaaaaaaaaaagh");
} 
```

当我运行它时，它不会检测到我的任何粘贴事件，无论我是在执行 Ctrl+V 还是右键单击+粘贴。如果我使用另一个事件，例如 MouseEvent.CLICK，它会检测到它。事实上，我认为没有检测到任何 Event.XXX 事件（如 COPY、INIT 等）（至少从我尝试过的事件中）。所有 MouseEvent 和 KeyboardEvent 事件似乎都可以正常工作。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T20:34:24.207

TextField 对象不会调度 clear、copy、cut、paste 或 selectAll 事件。关于这些坏消息我很遗憾！

泰勒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T21:43:42.827

对此的解决方案是监听 TextEvent.TEXT_INPUT 并防止默认行为：

```
textField.addEventListener(TextEvent.TEXT_INPUT, onTextInput );

function onTextInput( e:TextEvent ) : void
{
    // this takes place of PASTE because Event.PASTE is not triggered on a textfield
    var t:TextField = TextField( e.currentTarget );
    t.replaceSelectedText( e.text );
    e.preventDefault();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T20:44:56.647

我会听 Event.CHANGE 因为粘贴会改变字段。

# c++ - 使用 Visual Studio 在发布二进制文件中生成符号

> ID：865546
> 
> 赞同：8
> 
> 时间：2009-05-14T20:24:20.533
> 
> 标签：c++, visual-studio, debugging, symbols

更新：我在[John Robbins](http://www.wintellect.com/CS/blogs/jrobbins/default.aspx)博客上发表了一篇关于。他在这里写了一个回复：

[http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/06/19/do-pdb-files-affect-performance.aspx](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/06/19/do-pdb-files-affect-performance.aspx)

我正在处理的项目不会为其发布二进制文件构建符号，我想改变它。

一些信息：

*   主要是 C++ 代码库，一些 C#。
*   在 VS2k5 下编译，将移至 VS2k8 Team System。
*   时间关键型软件。
*   必须启用优化。
*   源代码提供给客户，所以完整的符号就可以了。

生成我需要的东西的最佳命令行开关是什么，如果有的话，我将采取什么性能影响？

另外，是否有任何“陷阱”需要注意？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T20:30:11.423

生成调试符号（即 PDB 文件）只是创建一个外部文件，调试器在查看内存中的代码时可以引用该文件。它不会影响编译器或链接器生成的代码（有点像生成 .MAP 文件）。

现在，如果您正在谈论在发布版本中定义 _DEBUG，那将是一个完全不同的问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T00:03:55.193

更新：我在[John Robbins](http://www.wintellect.com/CS/blogs/jrobbins/default.aspx)博客上发表了一篇关于。他在这里写了一个回复：

[http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/06/19/do-pdb-files-affect-performance.aspx](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/06/19/do-pdb-files-affect-performance.aspx)

我在 microsofts 网站上找到了以下链接： [使用 Microsoft Visual C++ 6.0 生成和部署调试符号](http://msdn.microsoft.com/en-us/library/aa260783(VS.60).aspx)

此链接适用于 Visual C++ 6，但我假设这些说明与 Visual C++ 8(2005) 和 9(2008) 相同。

它提供的信息与 TheBlack 提供的链接非常相​​似，但更深入。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-05-01T00:35:25.013

Visual C++ 中的[/Zi](https://docs.microsoft.com/en-us/cpp/build/reference/z7-zi-zi-debug-information-format?view=vs-2019)开关将创建一个 PDB，但此设置还意味着会使 DLL 或 EXE 更大的其他设置。具体来说，`/Zi`暗含[/DEBUG](https://docs.microsoft.com/en-us/cpp/build/reference/debug-generate-debug-info?view=vs-2019)，暗含[/INCREMENTAL](https://docs.microsoft.com/en-us/cpp/build/reference/incremental-link-incrementally?view=vs-2019)、[/OPT:NOREF](https://docs.microsoft.com/en-us/cpp/build/reference/opt-optimizations?view=vs-2019)和[/OPT:NOICF](https://docs.microsoft.com/en-us/cpp/build/reference/opt-optimizations?view=vs-2019)。最后三个使编译的 DLL 或 EXE 更大，但可以通过指定`/OPT:REF`和`/OPT:ICF`除了`/Zi`. 无需覆盖`/INCREMENTAL`,`/OPT:REF`和/或`/OPT:ICF`将确保完整的非增量链接。

来源：[正确创建本机 C++ 版本构建 PDB](https://www.wintellect.com/correctly-creating-native-c-release-build-pdbs/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:57:32.963

我不知道命令行，但您需要在 IDE 中的 c++ 编译器配置（程序数据库）和链接器（生成调试信息）中设置调试符号。

如果您在项目中找到设置，您可以使用帮助来查看它们引用了哪些命令行。

# c# - 类的xml输出

> ID：865553
> 
> 赞同：0
> 
> 时间：2009-05-14T20:25:21.420
> 
> 标签：c#, xml, class

我正在尝试生成如下所示的 xml 输出（基于类）：

```
<cdsXMLEnvelope>
<TestValue1>x1</TestValue1>
  <inner>
    <eTestValue1>e1</eTestValue1>
  </inner>
  <inner>
    <eTestValue1>e1</eTestValue1>
  </inner>
  <inner>
    <eTestValue1>e1</eTestValue1>
  </inner>
</cdsXMLEnvelope>

[System.Xml.Serialization.XmlRootAttribute("cdsXMLEnvelope", Namespace = "",       IsNullable = false)]
[XmlTypeAttribute(Namespace = "http://www.w3.org/2001/XMLSchema-instance")]

//public class cdsXMLEnvelope : cdsXMLinfo
public class cdsXMLEnvelope
{
    [XmlElementAttribute(ElementName = "eTestValue1")]
    public string eTestValue1 { get; set; }

    [System.Xml.Serialization.XmlArrayItem("inner")]
    public cdsXMLinfo[] cdsXMLinfo { get; set; }

}

//[XmlTypeAttribute(Namespace = "http://www.w3.org/2001/XMLSchema-instance")]
public class cdsXMLinfo
{
    [XmlElementAttribute(ElementName = "TestValue1")]
    public string TestValue1 { get; set; }

    [System.Xml.Serialization.XmlAttributeAttribute()]
    public string TestValue3 { get; set; }
} 
```

请帮我把这段代码连接起来，改变类等等——我一直在尝试各种方法，当我试图将它序列化为 xml 时，我得到对象未找到和其他错误

我也可以避免对内部元素使用数组吗？我要使用列表吗？

我会尽量完善这个问题，我知道人们讨厌这些长？

谢谢！！

```
 {

                cdsXMLEnvelope x = new cdsXMLEnvelope();

                x.eTestValue1 = "x1"; 

                x.cdsXMLinfo = new cdsXMLinfo[1];
                x.cdsXMLinfo[0].TestValue1 = "xi1";
                //x.cdsXMLinner[0].TestValue1 = "xi2";             

                XmlSerializer writer = new XmlSerializer(x.GetType());
                StreamWriter file = new StreamWriter("x.xml");

                writer.Serialize(file, x);
                file.Close();

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T11:33:10.583

我认为这可以满足您的需求，但是您的示例并不太一致：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Xml;
using System.Xml.Serialization;

namespace Serialize
{
    class Program
    {
        static void Main( string[] args )
        {
            var envelope = new CdsXmlEnvelope
            {
                TestValue1 = "x1",
                InnerList = new List<CdsXmlInfo>
                {
                    new CdsXmlInfo {TestValue1 = "e1"},
                    new CdsXmlInfo {TestValue1 = "e1"},
                    new CdsXmlInfo {TestValue1 = "e1"},
                }
            };

            var ns = new XmlSerializerNamespaces();
            ns.Add( string.Empty, string.Empty );

            var serializer = new XmlSerializer( typeof( CdsXmlEnvelope ) );
            using( var stream = new MemoryStream() )
            {
                var settings = new XmlWriterSettings();
                settings.OmitXmlDeclaration = true;
                settings.Indent = true;

                var writer = XmlWriter.Create( stream, settings );
                serializer.Serialize( writer, envelope, ns );
                stream.Position = 0;
                Console.WriteLine( new StreamReader( stream ).ReadToEnd() );
            }
            Console.ReadLine();
        }
    }

    [XmlRoot( "cdsXMLEnvelope" )]
    public class CdsXmlEnvelope
    {
        [XmlElement( "TestValue1" )]
        public string TestValue1 { get; set; }

        [XmlElement( "inner" )]
        public List<CdsXmlInfo> InnerList { get; set; }
    }

    public class CdsXmlInfo
    {
        [XmlElement( "TestValue1" )]
        public string TestValue1 { get; set; }

        [XmlAttribute]
        public string TestValue3 { get; set; }
    }
} 
```

给出输出：

```
<cdsXMLEnvelope>
  <TestValue1>x1</TestValue1>
  <inner>
    <TestValue1>e1</TestValue1>
  </inner>
  <inner>
    <TestValue1>e1</TestValue1>
  </inner>
  <inner>
    <TestValue1>e1</TestValue1>
  </inner>
</cdsXMLEnvelope> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T20:48:32.893

如果您有架构，您可以尝试使用[Xsd.exe](http://msdn.microsoft.com/en-us/library/x6c1kb0s.aspx)为您生成 C# 类。

# web-hosting - 如何确定哪个托管服务提供商托管网站？

> ID：865556
> 
> 赞同：8
> 
> 时间：2009-05-14T20:26:27.047
> 
> 标签：web-hosting

是否有一项服务可以识别网站的托管位置（可能是通过 IP）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T20:30:54.807

[Who-hosts](http://who-hosts.com/thedomain.com)是一项在线免费服务，可以告诉您托管所提供 URL 的公司，并且不需要注册。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T20:28:56.417

tracert www.sitename.com

可能是你最好的选择。最后一两个条目应该给你最好的提示。否则，whois 条目也可能是一个很好的指标，尤其是当他们使用 DNS 托管服务提供商时。

编辑：它的 traceroute 在 linux 机器上不是 tracert。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T20:29:42.297

只需对 IP 进行 whois 搜索即可。

[http://samspade.org/whois/](http://samspade.org/whois/69.59.196.211)是一个免费实用程序，用于告诉您谁拥有 IP 地址或域名。如果这是一个托管多台服务器的服务器场，那么它可能会注册到托管公司。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T20:34:47.077

这并不是问题所要求的，但您可能会发现[Netcraft](http://uptime.netcraft.com/)提供了一些关于正常运行时间、网络服务器软件和用于托管网站的 ISP 的非常简洁的信息很有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T20:29:50.270

[Domaintools](http://whois.domaintools.com/stackoverflow.com)通常可以在“服务器数据”下并使用“反向 IP”工具为您提供一些非常好的信息（尽管您必须付费才能从该工具中获得完整的结果）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T20:30:32.123

[http://whois.domaintools.com/websitename.com](http://whois.domaintools.com/websitename.com)

只需输入网站名称而不是 websitename.com。

# .net - 如何对机器特定行为进行单元测试？

> ID：865559
> 
> 赞同：2
> 
> 时间：2009-05-14T20:27:00.900
> 
> 标签：.net, unit-testing, nunit

我正在测试一个静态方法，该方法在检查代理和主机名以及各种东西之后构建一个 URL 字符串。此方法在内部依赖于静态标志`System.Net.Sockets.Socket.OSSupportsIPv6`。因为它是静态的，所以我不能模拟这种依赖。

编辑：（这被简化了很多......我不能用标志修改方法的结构以接受真/假）。

在 XP 开发机器上，所讨论的方法返回一个可预测的字符串结果（在本例中为[http://hostname/](http://hostname/) .... ）。我们支持 IPv6 的构建服务器返回一个完全不同的结果（它给了我类似[http://192.168.0.1:80/...](http://192.168.0.1:80/...)的东西）。请不要问为什么 - 关键是有两种不同的输出类型会因操作系统依赖性而异。

测试需要验证返回的主机名或 IP 地址是否有效。输出很容易检查。问题是我只能得到一个可能的输出，这取决于运行测试的机器。

在这种情况下编写测试的最佳实践是什么？我是否在我的测试中放置了一个 if 语句来检查标志，然后查找两个不同的输出？这对我来说似乎很粗略，因为

1.  测试的行为因运行环境而异

2.  我基本上是将测试与方法耦合，因为您需要了解方法的内部结构来设置这两种情况。

我是否设置了两个测试，每个环境一个，如果它们在错误的环境中就可以通过？我是否编写了一些复杂的正则表达式来分离它得到的结果并使用更多的 if/else 逻辑来验证它？

任何建议都会有所帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T20:35:47.010

您可以通过介绍中间人来伪造电话。例如：

```
public static class NetworkUtils
{
    private static bool? forcedIPv6Support;

    /// <summary>
    /// Use this instead of Socket.OSSupportsIPv6 to
    /// allow for testing on different operating systems.
    /// </summary>
    public static SupportsIPv6
    {
        get { return forcedIPv6Support ?? Socket.OSSupportsIPv6; }
    }

    /// <summary>Only use in testing!</summary>
    public static void ForceIPv6Support(bool? value)
    {
        forcedIPv6Support = value;
    }
} 
```

这并不完全令人愉快，但它可以让你做你需要做的事情。

[ChrisW 的回答](https://stackoverflow.com/questions/865559/how-do-i-unit-test-for-machine-specific-behaviour/865601#865601)类似，但使用了一个界面。通常我会喜欢接口解决方案，但感觉它使生产代码和配置变得更加复杂。我的解决方案肯定不那么“纯粹”，但可能更务实。我会让你判断:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:34:53.830

你能把静态方法隐藏在抽象接口后面吗？

```
interface ISupportIPv6
{
  bool supported { get; }
}

//class for unit testing
class TestSupportsIPv6 : ISupportIPv6
{
  public bool supported { get { return true; } }
}

//another class for more unit testing
class TestDoesNotSupportIPv6 : ISupportIPv6
{
  public bool supported { get { return false; } }
}

//class for real life (not unit testing)
class OsSupportsIPv6 : ISupportIPv6
{
  public bool supported { get {
    return System.Net.Sockets.Socket.OSSupportsIPv6; } }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T20:36:48.677

您可以查看将所有可能更改的环境设置包装在实现接口的单独类中。然后可以将其传递给您编写的静态方法，然后在需要各种设置时回调接口。

这将允许您在测试时模拟环境设置以标准化，以防止您看到的问题。它还可以让您改变设置以测试不同的条件。

例如

```
public interface IEnvironment
{
    public bool SupportsIPV6 { get; }
} 
```

然后你的静态方法就变成了。

```
public static void DoSomething(IEnvironment environment)
{
    if(environment.SupportsIPV6)
    {
        ...
    }
} 
```

然后提供一个 IEnvironment 实现，该实现调用静态 System.Net 方法以获取实际使用设置，但提供一个模拟实现，用于使用已知值进行测试。

如果您不想将接口传递给静态方法，您可以考虑使用单例模式实现一个对象，然后调用该接口。然后，您拥有的静态方法可以使用单例访问当前界面的任何内容，尽管此方法有点混乱，所以我可能会使用前者。

例如

```
public Environment : IEnvironment
{
  private static IEnvironment current = new Environment();
  public static IEnvironment Current
  {
    get { return current; }
    set { current = value; }
  }

  public bool SupportsIPV6
  {
    return System.Net.....
  }
} 
```

然后使用静态方法调用它。

```
public static void DoSomething(IEnvironemnt environment)
{
    if(Environment.Current.SupportsIPV6)
    {
        ...
    }
} 
```

你可以在你的测试中通过

```
Environment.Current = new MockedEnvironment(); 
```

尽管您需要注意是否正在使用这样的单例进行任何多线程处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:30:12.373

我不明白你为什么不能嘲笑这个。您的方法应该接受一个`bool SupportsIPv6`参数，并且在实际代码中，您传递它`System.Net.Sockets.Socket.OSSupportsIPv6`。然后你测试你的方法，你的参数是真假，并确保它为真假情况吐出正确的格式。瞧，完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T20:32:04.197

有时确实会发生很难进行有用的单元测试的情况。我不确定这是其中一种情况，但值得记住。

也就是说，现在，定义“有效”是什么意思？你当然可以测试它的格式： [0-9]{1,3} 是一个正则表达式的开始。

您可以使用 ICMP 回显数据包（或 ping(8)）测试它是否可以访问。

如果您可以定义“有效”对您意味着什么，那应该定义一个单元测试。

# winforms - 是否有可以绑定的可为空的日期选择器？

> ID：865572
> 
> 赞同：1
> 
> 时间：2009-05-14T20:30:26.400
> 
> 标签：winforms, data-binding, .net-3.5, datepicker, nullable

我正在寻找像微软提供的那样的日期选择器，但它不支持空值，因为这与数据库上的一个可以为空的字段相关联，这是不可接受的。

我找到[了这个](http://www.codeproject.com/KB/selection/Nullable_DateTimePicker.aspx)，但根据页面底部的评论，它在绑定到数据库时存在问题。我的项目中也有一个我继承的，但它有类似的问题（有时它显示值，有时它不显示）。有谁知道一个有效的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T20:45:32.243

使用日期选择器填充文本框，如果他们希望该字段为空，只需擦除文本框的内容（然后相应地处理空白输入）。

这还提供了额外的好处，即允许用户输入他们的日期，如果他们愿意的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:46:13.600

Smart FieldPackEditor 有一个可以为空的日期选择器。我相信它可以满足您的一切需求。当我处理这类事情时，我希望它就在身边。我仍然记得我必须使用 Microsoft 的 datepicker 控件实现的所有变通方法。啊！

[http://www.visualhint.com/index.php/fieldpackeditor/](http://www.visualhint.com/index.php/fieldpackeditor/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-14T20:36:12.657

为什么不使用客户端日期选择器来填充文本字段。如果文本字段为空，则您的日期为空，否则转换该值。

jQuery 有一个很好用的日期选择器。[http://jqueryui.com](http://jqueryui.com)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-05-14T20:55:59.927

这个似乎有效，我的一位同事有它：

```
using System;
using System.Windows.Forms;

namespace CustomControls
{
    public class NullableBindableDateTimePicker : System.Windows.Forms.DateTimePicker
    {
        private Boolean isNull = false;
        private DateTimePickerFormat baseFormat = DateTimePickerFormat.Short;
        private Boolean ignoreBindOnFormat = false;

        public NullableBindableDateTimePicker()
        {
            this.Format = baseFormat;
            if (baseFormat == DateTimePickerFormat.Custom) this.CustomFormat = " ";
        }

        public Boolean IsNull
        {
            get { return isNull; }
            set
            {
                isNull = value;
                this.Checked = value;
            }
        }

        //TODO: Add BaseCustomFormat

        public DateTimePickerFormat BaseFormat
        {
            get { return baseFormat; }
            set { baseFormat = value; }
        }

        public object BindMe
        {
            get
            {
                if (IsNull) return System.DBNull.Value;
                else return base.Value;
            }
            set
            {
                //String s = this.Name;

                if (ignoreBindOnFormat) return;

                if (System.Convert.IsDBNull(value))
                {
                    // for some reason setting base.format in this.format calls set BindMe.
                    // we need to ignore the following call
                    ignoreBindOnFormat = true;
                    this.Format = DateTimePickerFormat.Custom;
                    ignoreBindOnFormat = false;

                    this.CustomFormat = " ";
                    IsNull = true;
                }
                else
                {
                    ignoreBindOnFormat = true;
                    this.Format = baseFormat;
                    ignoreBindOnFormat = false;

                    if (baseFormat == DateTimePickerFormat.Custom) this.CustomFormat = " ";
                    IsNull = false;
                    base.Value = (DateTime)value;
                }
            }
        }

        protected override void OnKeyDown(KeyEventArgs e)
        {
            base.OnKeyDown(e);

            if (e.KeyCode == Keys.Delete)
            {
                this.BindMe = DBNull.Value;
            }
        }

        protected override void OnCloseUp(EventArgs eventargs)
        {
            base.OnCloseUp(eventargs);
            BindMe = base.Value;
        }
    }
} 
```

# arrays - 将字符串和整数存储在单个 GWT 数组中

> ID：865580
> 
> 赞同：0
> 
> 时间：2009-05-14T20:31:32.870
> 
> 标签：arrays, json, gwt, coldfusion

看起来这应该是相对简单的，但显然不是那么简单。我一生都无法弄清楚如何将字符串和整数存储在 GWT 的数组中。你使用什么数据类型？如果我使用 JsArrayString，它会`IllegalArgumentException`在检索包含数字的索引时抛出一个。我显然不能使用 JsArrayInteger （我有字符串）。JsArray 需要一种类型，我不知道该使用什么（如果可以使用），我尝试过`String`但得到相同的结果。

正在检索的数据来自脚本页面，它无法区分字符串和整数 (ColdFusion)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:36:10.047

现在可以使用`JsArrayMixed`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T20:34:29.477

我认为您可以使用 Object 作为您的类型。如果 Integer 类不能自动为您执行此操作，您将不得不将您的基元 (int) 装箱。在获取数组中的内容后，您还必须进行一些类型检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:20:44.327

这有点笨拙，但是您总是可以对给定值是 int 还是 string 进行一些蛮力确定：

```
<cfset val1="one">
<cfset val2="1">
<cfif int(val(val1)) eq val1>int<cfelse>string</cfif>
<br />
<cfif int(val(val2)) eq val2>int<cfelse>string</cfif> 
```

这应该给你

```
 string
 int 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T17:40:01.417

GWT 目前不具备解析包含两种不同类型数据的数组结构的功能，除非采用严格的 JSON 格式（显然不是作为从 ColdFusion 传递的数组中 JSON 结构的一部分）。

# objective-c - 如何使用 gdb 调试 Objective-c 程序（Apple 提供的 pbcopy）？

> ID：865581
> 
> 赞同：1
> 
> 时间：2009-05-14T20:31:36.303
> 
> 标签：objective-c, gdb

我需要调试一个objective-c 程序。在 main() 函数上设置断点时，我有：

```
Reading symbols from /usr/bin/pbcopy...done.
(gdb) break main
Function "main" not defined. 
```

从回复相同的错误中调用“开始”。我怀疑 max os x 的做事方式不同？

与目标 c 程序等效的是什么？

顺便说一句，如何打破 exit() 函数？

编辑：我尝试按照 Lyndsey 的建议打破 -[NSApplication run]

```
(gdb) file pbcopy
Reading symbols for shared libraries ........ done
Reading symbols from /usr/bin/pbcopy...done.
(gdb) break -[NSApplication run]
Breakpoint 1 at 0x35a8356
(gdb) run
Starting program: /usr/bin/pbcopy 
Reading symbols for shared libraries +++++++.................................................................... done
Breakpoint 1 at 0x95a97356

helo
^C
Program received signal SIGINT, Interrupt.
0x9574eeda in read$UNIX2003 ()
(gdb) bt
#0  0x9574eeda in read$UNIX2003 ()
#1  0x94d4e5b6 in _NSReadFromFileDescriptor ()
#2  0x94d4e4b6 in -[NSConcreteFileHandle readDataOfLength:] ()
#3  0x94d7f2fa in -[NSConcreteFileHandle readDataToEndOfFile] ()
#4  0x00002a11 in ?? ()
#5  0x00002736 in ?? ()
(gdb) info breakpoints
Num Type           Disp Enb Address    What
1   breakpoint     keep y   0x95a97356 <-[NSApplication run]+6>
(gdb) 
```

这很奇怪，gdb如何找到符号的地址但没有破坏它......顺便说一句，GDB似乎在加载动态库后更改了断点的地址。但这并没有伤害到我，因为我认为 ld 需要搬迁。看到堆栈跟踪，我看到很多？？这让我假设这里不使用通常的触发应用程序的方式（？？大假设......：/）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T23:54:24.770

pbcopy 是一个命令行工具，而不是一个应用程序，所以它没有理由调用 [NSApplication run]。断点解析是因为它（无论出于何种原因）链接到 AppKit 框架。

由于这是一个剥离的二进制文件，因此破坏 C 函数名称不会很好地工作。如果您真的想四处寻找，最好的选择是转储程序集并据此确定要中断的位置。

如果你解释了你想要完成的总体目标，你可能会得到关于如何进行的更好的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T20:56:43.433

您是否使用 Cocoa 项目模板创建了您的 Objective-C 应用程序？如果有，是哪一个？许多具有主要功能。

你能发布你的主要功能吗？在您的主要功能中，键入：

`int main(int argc, char *argv[]) {`
**          #error 是的，我正在编译！**

```
 NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
    int retVal = UIApplicationMain(argc, argv, nil, nil);
    [pool release];
    return retVal;
} 
```

现在，构建您的应用程序，您是否遇到错误？如果不是，那么由于某种原因，您的带有 main 函数的代码实际上并未被编译。确保它是。

**编辑 2009 年 5 月 14 日 @ 5:22 EST**：当应用程序被告知运行时，您可能希望使用 b -[NSApplication run] 来中断。

# asp.net - ASP.NET 应用程序部署问题

> ID：865583
> 
> 赞同：0
> 
> 时间：2009-05-14T20:31:55.443
> 
> 标签：asp.net, iis, deployment

我已经将一个用 ASP.NET 2.0 编写的应用程序部署到生产环境中，但它遇到了一些延迟问题。页面加载大约需要 4-5 秒。GridView 刷新需要大约相同的时间来加载。

该应用程序在开发盒上运行良好。我在服务器上做了以下调查

1.  检查可用内存...已使用 80%。
2.  检查处理器... 1%
3.  从 perfmon 检查磁盘 IO，小于 15%

服务器配置是

Windows Server 2003 Sp2 双 2.0 GZH 2GB RAM

仅运行 SQL Server 2005 和 IIS

还有什么我可以解决的吗？我还检查了事件日志是否有错误，它很干净。

已编辑~我刚刚发现的唯一区别是我使用的是 IE7 而客户端使用的是 IE6 的 DEV 框 - 这可能是个问题吗？

更新 ~ 我将所有客户端更新到 IE8 并注意到性能提高了 30%。我终于发现我将 debug=true 留在了 web.config 文件中。将其设置为 flase 使应用程序恢复到稳定的性能......我仍然不敢相信我做到了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T20:43:31.827

First thing I would do is enable tracing. (see: [http://www.4guysfromrolla.com/webtech/081501-1.shtml](http://www.4guysfromrolla.com/webtech/081501-1.shtml))

then add tracing points to your page generation code to give you an idea of how long each part of the page build takes:

```
System.Diagnostics.Trace.Write(
                "Starting Page init",
                "TraceCheck");
//Init page

System.Diagnostics.Trace.Write(
                "End Page init",
                "TraceCheck");

System.Diagnostics.Trace.Write(
                "Starting Data Fetch",
                "TraceCheck");
//Get Data

System.Diagnostics.Trace.Write(
                "End Data Fetch",
                "TraceCheck"); 
```

etc

this way you can see exactly how long each stage is taking and then target that area.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:38:26.363

还要检查您的页面大小。我的一位开发人员朋友曾经将整个表加载到视图状态中。在本地机器上开发时，一个 12 兆字节的页面会溜走，但在生产中会立即引人注目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T21:26:27.560

Double check that you application is not running in debug mode. In your `web.config` file check that the `debug` attribute under `system.web\compilation` is set to false.

Besides making the application run slower and using more system memory you will also experience slow page loading since noting is cached when in debug mode.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:36:25.963

您是针对测试中的 SQL Server 运行还是使用不同的 SQL Server？

为了找出时间的来源，您可以在页面加载中添加一些跟踪语句，然后在打开跟踪的情况下加载页面。这可能有助于指出问题所在。

另外，您的开发箱的规格是什么？相同？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T21:09:04.480

Depending on the version of visual studio you have, Team Developer has a Performance Wizard you might want to investigate.

Also, if you use IE 8, it has a Profiler which will let you see how long the site takes to load in the browser itself. One of the first things to determine is whether the time is client side or server side.

If client side, start looking at what javascript you have and optimize / get rid of it.

If server side, you need to look at all of the performance counters (perfmon). For example, we had an app that crawled on the production servers due to a tremendous amount of JIT going on.

You also need to look at the communication between the web and database server. How long are queries taking? Are the boxes thrashing the disk drives? etc.

# oracle - Oracle - 如何授予用户对另一个用户对象的权限

> ID：865586
> 
> 赞同：7
> 
> 时间：2009-05-14T20:32:40.543
> 
> 标签：oracle, permissions, grant

[我需要授予用户 TARGETUSER 选择/插入/更新用户 SOURCEUSER 的所有表的权利（我可以从这里](https://stackoverflow.com/questions/187886/grant-select-on-all-tables-owned-by-specific-user)全部弄清楚）以及运行所有存储过程的能力。

基本上，如果我可以让 TARGETUSER 能够使用 SOURCE_USER 的对象进行所有非 ddl 活动，我不会抱怨。我该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T21:01:03.017

您可以编写一个简单的过程来执行此操作：

```
BEGIN
  FOR Rec IN (SELECT object_name, object_type FROM all_objects WHERE owner='SOURCEUSER' AND object_type IN ('TABLE','VIEW','PROCEDURE','FUNCTION','PACKAGE')) LOOP
    IF Rec.object_type IN ('TABLE','VIEW') THEN
      EXECUTE IMMEDIATE 'GRANT SELECT, UPDATE, INSERT, DELETE ON SOURCEUSER.'||Rec.object_name||' TO TARGETUSER';
    ELSIF Rec.object_type IN ('PROCEDURE','FUNCTION','PACKAGE') THEN
      EXECUTE IMMEDIATE 'GRANT EXECUTE ON SOURCEUSER.'||Rec.object_name||' TO TARGETUSER';
    END IF;
  END LOOP;
END; 
```

不确定您还要求什么。您可以修改上述内容，为您要提供给目标用户的权限添加额外的授权和/或 object_types。正如@stili 暗示的那样，您可以对角色做很多事情，但要小心 - 通过角色授予某些权限时不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:41:37.307

要生成 SQL 脚本，您可以使用以下内容，类似于 DCookie 建议的解决方案

```
SELECT 'GRANT SELECT, UPDATE, DELETE, INSERT ON ' || table_name || ' TO other_user;'
      FROM all_tables WHERE owner = 'other_user';
UNION ALL
SELECT 'GRANT EXECUTE ON ' || object_name || ' TO other_user;'
    FROM all_objects 
    WHERE owner = 'other_user' 
    AND object_type IN ('FUNCTION', 'PROCEDURE', 'PACKAGE'); 
```

一般来说，我建议使用角色来避免为每个用户授予访问权限。

如果使用角色，请以要从中复制角色的用户身份运行以下 SQL。您还可以包括其他选项，例如`admin_option`和`default_role`。

```
SELECT 'GRANT ' || granted_role || ' TO other_user;'
  FROM user_role_privs; 
```

或者，您可以查询`dba_role_privs`以获取特定用户的角色：

```
SELECT 'GRANT ' || granted_role || ' TO other_user;'
  FROM dba_role_privs WHERE grantee = 'source_user'; 
```

# javascript - 计量单位转换库

> ID：865590
> 
> 赞同：25
> 
> 时间：2009-05-14T20:33:33.117
> 
> 标签：javascript

基于用户首选的度量单位设置，在客户端中抽象出度量单位转换的最佳/最优雅的方法是什么？

例如，假设用户 A 的首选度量单位是“公制”，而用户 B 的首选是“英制”。

现在假设我已经计算了以平方米为单位的面积。当我去显示值时，我需要为每个用户使用不同的转换因子（例如，“1 米 = 1.09361 码”）。或者说我已经计算了流体体积`mL`。用户 B 的视图将使用转换“236.588237 mL = 1 US cup”计算。

是否有任何人都知道的现有 javascript 库来处理这些微不足道的 UOM 转换？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2010-08-20T13:49:19.183

这是我拼凑起来的一个小脚本，只是为了它。它处理克、字节、米和升的所有 SI 转换，我还添加了盎司和磅作为非 SI 单位的示例。要添加更多内容，您需要：

1.  将基本类型添加到遵循 SI 或的项目的“单位”列表中
2.  为不遵循 SI 的项目添加转化率

用法：

```
$u(1, 'g').as('kg').val(); // converts one gram to kg 
```

您可以使用 .val() 获取值，使用 .toString() 的字符串表示或通过 .debug() 的完整详细信息

```
(function () {
    var table = {};

    window.unitConverter = function (value, unit) {
        this.value = value;
        if (unit) {
            this.currentUnit = unit;
        }
    };
    unitConverter.prototype.as = function (targetUnit) {
        this.targetUnit = targetUnit;
        return this;
    };
    unitConverter.prototype.is = function (currentUnit) {
        this.currentUnit = currentUnit;
        return this;
    };

    unitConverter.prototype.val = function () {
        // first, convert from the current value to the base unit
        var target = table[this.targetUnit];
        var current = table[this.currentUnit];
        if (target.base != current.base) {
            throw new Error('Incompatible units; cannot convert from "' + this.currentUnit + '" to "' + this.targetUnit + '"');
        }

        return this.value * (current.multiplier / target.multiplier);
    };
    unitConverter.prototype.toString = function () {
        return this.val() + ' ' + this.targetUnit;
    };
    unitConverter.prototype.debug = function () {
        return this.value + ' ' + this.currentUnit + ' is ' + this.val() + ' ' + this.targetUnit;
    };
    unitConverter.addUnit = function (baseUnit, actualUnit, multiplier) {
        table[actualUnit] = { base: baseUnit, actual: actualUnit, multiplier: multiplier };
    };

    var prefixes = ['Y', 'Z', 'E', 'P', 'T', 'G', 'M', 'k', 'h', 'da', '', 'd', 'c', 'm', 'u', 'n', 'p', 'f', 'a', 'z', 'y'];
    var factors = [24, 21, 18, 15, 12, 9, 6, 3, 2, 1, 0, -1, -2, -3, -6, -9, -12, -15, -18, -21, -24];
    // SI units only, that follow the mg/kg/dg/cg type of format
    var units = ['g', 'b', 'l', 'm'];

    for (var j = 0; j < units.length; j++) {
        var base = units[j];
        for (var i = 0; i < prefixes.length; i++) {
            unitConverter.addUnit(base, prefixes[i] + base, Math.pow(10, factors[i]));
        }
    }

    // we use the SI gram unit as the base; this allows
    // us to convert between SI and English units
    unitConverter.addUnit('g', 'ounce', 28.3495231);
    unitConverter.addUnit('g', 'oz', 28.3495231);
    unitConverter.addUnit('g', 'pound', 453.59237);
    unitConverter.addUnit('g', 'lb', 453.59237);

    window.$u = function (value, unit) {
        var u = new window.unitConverter(value, unit);
        return u;
    };
})();

console.log($u(1, 'g').as('kg').debug());  
console.log($u(1, 'kg').as('g').debug());
console.log($u(1, 'g').as('mg').debug());
console.log($u(1, 'mg').as('g').debug());
console.log($u(1, 'mg').as('kg').debug());

console.log($u(1, 'g').as('oz').debug());
console.log($u(1, 'g').as('lb').debug());

console.log($u(1, 'oz').as('lb').debug());

console.log($u(1, 'lb').as('g').debug());

// this last one throws an exception since you can't convert liters to mg
console.log($u(1, 'l').as('mg').debug()); 
```

我已经把它移到 Github 上的一个小仓库，所以如果有人想改进/增强他们可以这样做： [https ://github.com/jerodvenemafm/jsunitconverter](https://github.com/jerodvenemafm/jsunitconverter)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-28T21:17:23.097

你可以看看这个 Ruby Units 到 Javascript 的移植：

[https://github.com/gentooboontoo/js-quantities](https://github.com/gentooboontoo/js-quantities)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-10T20:38:56.987

受到许多关于这个主题的帖子以及[MomentJs](http://momentjs.com/)的简单性和小巧性的启发，我开始着手这方面的工作：

[测量Js](https://github.com/Philzen/measurement.js)

它还不包括所有提到的转换，但您可以轻松扩展`DEFINITIONS`数组和`MeasurementJs.Units.*`对象以进行任何您喜欢的可能转换。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-12-04T23:26:33.617

我就把这个留在这里...

## 转换几乎所有英制/标准距离/长度测量值的简单 JS 方法

```
;;if (!window.hasOwnProperty('convertImperialMetric')) {
    function convertImperialMetric () {
        var metrics = convertImperialMetric.metrics,
            imperials = convertImperialMetric.imperials,
            args = arguments,
            conversionTypes = { imperial: 'imperial', metric: 'metric' },
            toFixed = false, toFixedX = 2,
            intX, typImp, typMet, conType = 'metric',
            $ret;

        conversionTypes.i = conversionTypes.imp = conversionTypes.imperial;
        conversionTypes.m = conversionTypes.met = conversionTypes.metric;

        function setVarz(c) {
            for (i in c) {
                var a = c[i];
                switch (typeof a) {
                    case "boolean":
                        toFixed = a;
                        break;
                    case "number":
                        void 0 == intX ? intX = a : toFixedX = a;
                        break;
                    case "string":
                        isNaN(parseFloat(a)) || void 0 != intX ? imperials.hasOwnProperty(a) ? typImp = a : metrics.hasOwnProperty(a) ? typMet = a : conversionTypes.hasOwnProperty(a) && (conType = conversionTypes[a]) : intX = parseFloat(a);
                        break;
                    case "object":
                        if (a instanceof Array) setVarz.apply(this, [a]);
                        else if (a instanceof Object)
                            for (h in a) {
                                var b = a[h];
                                conversionTypes.hasOwnProperty(h) ? conType = conversionTypes[h] : imperials.hasOwnProperty(h) ? (typImp =
                                    h, void 0 != intX || isNaN(parseFloat(b)) || (intX = parseFloat(b))) : metrics.hasOwnProperty(h) ? (typMet = h, void 0 != intX || isNaN(parseFloat(b)) || (intX = parseFloat(b))) : setVarz.apply(this, [
                                    [b]
                                ])
                            }
                }
            }
        };
        setVarz(args);

        if (!isNaN(parseFloat(intX)) && imperials.hasOwnProperty(typImp) && metrics.hasOwnProperty(typMet) && conversionTypes.hasOwnProperty(conType)) {
            if (conType == 'metric') {
                var inches = intX * imperials[typImp],
                    centimeters = inches * 2.54;
                $ret = centimeters * metrics[typMet];
            }
            else if (conType == 'imperial') {
                var centimeters = intX / metrics[typMet],
                    inches = centimeters / 2.54;
                $ret = inches / imperials[typImp];
            }
        }

        return toFixed ? parseFloat($ret.toFixed(toFixedX)) : $ret;
    }

    convertImperialMetric.imperials = {
        inches: 1,
        feet: 12,
        yards: 36,
        miles: 63360,
        nautical: 72913.4
    };

    convertImperialMetric.metrics = {
        yocto: 10000000000000000000000,
        zepto: 10000000000000000000,
        atto: 10000000000000000,
        femto: 10000000000000,
        pico: 10000000000,
        nano: 10000000,
        micro: 10000,
        milli: 10,
        centi: 1,
        deci: .1,
        meter: .01,
        deka: .001,
        hecto: .0001,
        kilo: .00001,
        mega: .00000001,
        giga: .00000000001,
        tera: .00000000000001,
        peta: .00000000000000001,
        exa: .00000000000000000001,
        zetta: .00000000000000000000001,
        yotta: .00000000000000000000000001
    };
} 
```

## 示例用法：

```
convertImperialMetric(12, 'inches', 'centi');   //  Results in: 30.48
convertImperialMetric(30.48, 'centi', 'inches', 'i');   //  Results in: 12
convertImperialMetric('1200000', 'inches', 'kilo'); //  Results in: 30.480000000000004
convertImperialMetric('1200000', 'inches', 'kilo', true);   //  Results in: 30.48
convertImperialMetric('1200000', 'inches', 'kilo', true, 1);    //  Results in: 30.5
convertImperialMetric([ 12, 'inches', 'centi' ]);   //  Results in: 30.48
convertImperialMetric([ '12', 'inches', 'centi' ]); //  Results in: 30.48
convertImperialMetric({ inches: 12, anyVariableName: 'centi' });    //  Results in: 30.48
convertImperialMetric({ inches: '12', anyVariableName: 'centi' });  //  Results in: 30.48
convertImperialMetric({ inches: 12, centi: 'anyValue' });   //  Results in: 30.48
convertImperialMetric({ inches: '12', centi: 'anyValue' }); //  Results in: 30.48
convertImperialMetric({ inches: '12', to: 'centi', type: 'metric', toFixed: true, toFX: 1 });   //  Results in: 30.5
convertImperialMetric({ feet: 1 }, 'centi');    //  Results in: 30.48
convertImperialMetric({ centi: '30.48' }, 'inches', 'imperial');    //  Results in: 12
convertImperialMetric({ meter: '.3048' }, 'inches', 'imperial');    //  Results in: 12 
```

**[jsFiddle](http://jsfiddle.net/SpYk3/qbt2du01/) / [jsFiddle/show](http://jsfiddle.net/SpYk3/qbt2du01/show/)**

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T20:57:11.640

有多少不同的单位被转换？听起来好像您正在编写我正在使用的特定应用程序，因为您只需要几种不同类型的转换（面积、体积等）

*如果*是这种情况，只需查找您需要的转换并将它们编码到自己的类中可能会更快。加载一个完整的 javascript 库只是为了执行一些特定的乘法可能是矫枉过正的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-02-06T20:32:41.040

一个流行的实用程序，可让您在不同单位之间进行转换：[转换单位](https://www.npmjs.com/package/convert-units)

使用示例，将英制英寸转换为公制厘米：

```
var convert = require('convert-units')
convert(1).from('in').to('cm') // 2.54 
```

安装：

```
npm install convert-units 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-07-03T01:47:06.970

库“度量”在单位类型（体积、质量等）之间转换并支持多种单位系统（美制、英制、公制）

```
// volume
measure('1 teaspoon').teaspoons() // 1
measure('1 1/2 tsp.').teaspoons() // 1.5
measure('2 cups and 1 pint').quarts() // 1

// mass
measure('1 pound').ounces() // 16
measure('1 1/2 oz.').ounces() // 1.5

// operations
measure('1 teaspoon').add('1 teaspoon').teaspoons();
measure('6 1/2 teaspoon').divide(2).teaspoons(); // 3.25 
```

[https://github.com/dubbs/measure](https://github.com/dubbs/measure)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-10-23T17:07:35.797

这是构建查找表的可扩展且简洁的东西，因此性能应该很好。

```
core = {};
core.mixin = function (dst, src) { if (src) for (var i in src) dst[i] = src[i]; return dst; }

function UnitConverter(meter) {
    var feetPerMeter = 3.2808399, feetPerMile = 5280;
    this.meter = core.mixin({ km: 1000, mi: feetPerMile / feetPerMeter, ft: 1 / feetPerMeter, m: 1 }, meter);
    var t = [], i = 0;
    for (t[i++] in this.meter);
    this.table = [];
    for (i = 0; i < t.length; i++)
        for (j = 0; j < t.length; j++) {
            var key1 = t[i], key2 = t[(i + j + 1) % t.length];
            this.table[key1 + "/" + key2] = this.meter[key2] / this.meter[key1];
        }
};

with(UnitConverter) {
    prototype = new Object();
    prototype.convert = function () {
        switch (arguments.length) {
        case 1:
            return this.table[arguments[0]];
        case 2:
            return arguments[0] * this.table[arguments[1]];
        case 3:
            return arguments[0] * this.meter[arguments[1]] / this.meter[arguments[2]];
        }
        return Number.NaN;
    }
} 
```

**用法**

```
Number.converter = new UnitConverter({ nm: 1852 }); // extent to include nautical miles
Number.units = Number.converter.table;
var km = 1;
var mi = km * Number.units["mi/km"];
var m = Number.converter.convert(mi, "mi", "m");
var ft = Number.converter.convert(m, "ft/m");
m = Number.converter.convert(ft, "ft", "m");
ft = m / Number.converter.convert("m/ft");
km = ft * Number.units["km/ft"];
nm = Number.converter.convert(km, "km", "nm"); 
```

# c# - 实体 - Linq to Sql 仅加载实体的一部分

> ID：865602
> 
> 赞同：2
> 
> 时间：2009-05-14T20:34:57.713
> 
> 标签：c#, linq-to-sql, entity-framework, .net-3.5

如果我使用带有 linq to sql 的实体框架来查询它并且我有一个对象 Person 但我只需要该对象的两个属性，那么将加载内存中的什么，整个对象？

例子 ：

我得到了实体 Person 的属性：姓名、年龄、地址、国家、语言......

我只需要使用属性名称和年龄。所以我不需要加载地址、国家和其他属性......内存中有什么，SQL 会询问什么类型的查询？

如果我的 Linq 查询是：

```
public IQueryable<Person> FindAllPersons()
{
    return from person in db.Persons
           select person;
} 
```

稍后在代码中，我只调用列表中每个 Person 的 Name 和 Age 属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T13:53:00.417

作为替代方案，您可以将不想立即加载的所有列的延迟加载设置为 true。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T20:38:26.863

您可以只查询您需要的字段。

像这样，

```
public IQueryable<Person> FindAllPersons()
{
    return from person in db.Persons
           select new Person(){Name = person.Name, Age = person.Age};
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T20:39:35.237

如果您使用 LINQ 选择整个 person 对象，那么当您访问该对象时，整个 person 将被加载到内存中。如果您只想选择特定的字段，您应该细化您的选择标准。例如：

```
var persons = from p in db.Persons select new { p.Name, p.Age }; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T20:41:46.903

尽管这不是绝对必要的，但您可能需要指定您使用的是 EF 还是 Linq2SQL。但是，根据您实际使用的 SQL 可能会有所不同。

从您指定的查询中，与数据库列相关的所有属性都将在对象上填充（只要它们不是实体引用）。您可能可以有效地在其他属性上使用延迟加载，但这不是一个全面的解决方案，并且可能会在您的应用程序的不同区域中适得其反。总而言之，我会说除非应用程序必须对内存非常敏感，否则只需按原样加载对象即可。

只加载姓名和年龄..

```
var list = db.Persons.Select(person => new Person() { Age = person.Age, Name = person.Name }); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T14:29:26.950

设计器中的每个实体列都具有延迟加载属性。将其设置为 true（默认值为 false）会禁用属性的即时加载，只有在代码中访问它时才会加载。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-06T10:54:01.437

```
public IQueryable<Persons> GetApplicationRoleList()
    {
        return DBContext.Persons.AsQueryable();
    } 
```

;)

# python - 如何在 python 中对 datetime.timedelta 执行除法？

> ID：865618
> 
> 赞同：25
> 
> 时间：2009-05-14T20:37:32.543
> 
> 标签：python, date, datetime, division, timedelta

我希望能够做到以下几点：

```
num_intervals = (cur_date - previous_date) / interval_length 
```

或者

```
print (datetime.now() - (datetime.now() - timedelta(days=5))) 
      / timedelta(hours=12)
# won't run, would like it to print '10' 
```

但时间增量不支持除法运算。有没有办法可以为 timedeltas 实现除法？

**编辑：**看起来这已添加到 Python 3.2（感谢 rincewind！）：[http ://bugs.python.org/issue2706](http://bugs.python.org/issue2706)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-14T20:44:46.130

整数除法和乘法似乎[开箱即用](http://docs.python.org/library/datetime.html#timedelta-objects)：

```
>>> from datetime import timedelta
>>> timedelta(hours=6)
datetime.timedelta(0, 21600)
>>> timedelta(hours=6) / 2
datetime.timedelta(0, 10800) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-14T20:41:21.850

当然，只需转换为秒数（分钟、毫秒、小时，选择单位）并进行除法。

*编辑*（再次）：所以你不能分配给`timedelta.__div__`. 试试这个，然后：

```
divtdi = datetime.timedelta.__div__
def divtd(td1, td2):
    if isinstance(td2, (int, long)):
        return divtdi(td1, td2)
    us1 = td1.microseconds + 1000000 * (td1.seconds + 86400 * td1.days)
    us2 = td2.microseconds + 1000000 * (td2.seconds + 86400 * td2.days)
    return us1 / us2 # this does integer division, use float(us1) / us2 for fp division 
```

并将其纳入 nadia 的建议：

```
class MyTimeDelta:
    __div__ = divtd 
```

示例用法：

```
>>> divtd(datetime.timedelta(hours = 12), datetime.timedelta(hours = 2))
6
>>> divtd(datetime.timedelta(hours = 12), 2)
datetime.timedelta(0, 21600)
>>> MyTimeDelta(hours = 12) / MyTimeDelta(hours = 2)
6 
```

等等当然，您甚至可以命名（或别名）您的自定义类，以便至少在您的代码中`timedelta`使用它来代替 real 。`timedelta`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T20:41:59.727

您可以像这样覆盖除法运算符：

```
class MyTimeDelta(timedelta):
     def __div__(self, value):
          # Dome something about the object 
```

# c# - 从 C# 中的 []byte 获取字符串

> ID：865621
> 
> 赞同：1
> 
> 时间：2009-05-14T20:37:54.493
> 
> 标签：c#, .net, usb

我有一个奇怪的问题。我有一个带有标签的表单，用于在程序中的某些点输出文本，而不是控制台输出。给定以下代码：

```
result = SetupDiGetDeviceRegistryProperty(deviceInfoSet, ref tBuff, 
                                          (uint)SPDRP.DEVICEDESC,
                                          out RegType, ptrBuf, 
                                          buffersize, out RequiredSize); 

if (!result)
{
    errorMessage = new Win32Exception(Marshal.GetLastWin32Error()).Message;
    statusLabel.Text += "\nSetupDiGetDeviceRegistryProperty failed because "
                        + errorMessage.ToString();
}
else
{
    statusLabel.Text += "\nPtr buffer length is: " + ptrBuf.Length.ToString();

    sw.WriteLine(tCode.GetString(ptrBuf) );

    sw.WriteLine("\n");
    // This is the only encoding that will give any legible output.
    // Others only show the first character "U"
    string tmp = tCode.GetString(ptrBuf) + "\n"; 

    statusLabel.Text += "\nDevice is: " + tmp + ".\n";                    
} 
```

我只得到标签上的一个硬件 ID 输出。这段代码在我循环的末尾。起初，这让我觉得我的循环有点悬，但是当我决定将输出直接输出到一个文件时，我几乎得到了我想要的和循环外的输出。谁能告诉我这里发生了什么？我想要的只是从 []byte ( **ptrBuf** ) 中获取表示硬件 ID 的字符串。请有人解释一下这里发生了什么？我的工作环境是 MSVstudio 2008 express。在 Windows 7 中。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T20:45:50.043

不幸的是，你没有展示什么`tCode`是。

查看[API 调用的文档，](http://msdn.microsoft.com/en-us/library/ms792967.aspx)它看起来应该用 REG_SZ 填充。我*怀疑*那是Unicode，即

```
string property = Encoding.Unicode.GetString(ptrBuf, 0, RequiredSize); 
```

应该转换它。

但是，如果您期望多个值，我想知道它是否是 - 分隔的`'\0'`字符串：尝试在 Win32 控件中输出它确实会在第一个`'\0'`.

试试这个：

```
string property = Encoding.Unicode.GetString(ptrBuf, 0, RequiredSize);
                                  .Replace('\0', ' '); 
```

那应该（如果我猜对了）用空格分隔值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T20:40:48.620

您需要指定编码：

```
// C# to convert a byte array to a string.
byte [] dBytes = ...
string str;
System.Text.ASCIIEncoding enc = new System.Text.ASCIIEncoding();
str = enc.GetString(dBytes); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T22:47:17.677

对不起，我应该说。`UnicodeEncoding tCode = new UnicodeEncoding();` 并且感谢 skeet，我不知道关于 Win32 控件的小信息。我会努力纠正这一点。我并没有暗中尝试将字节转换为字符（或字符串）。以后我会努力讲得更详细。

谢谢大家的回复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:47:31.583

您不能将字节隐式转换为字符串。您必须为转换选择一种编码方法（可能是 Unicode 或 ASCII）。一个字节存储一个可以表示一个字符（或一些其他数据）的数值，但本质上并不意味着什么。它在哲学上相当于将整数转换为字符串。您可以决定对值进行直接转换，或者您可以从该值中获得一些含义（即使用 ASCII 表：13 = TAB）。

您列出的函数返回的值很可能返回了一个表示某个字符串值的字节数组，但是您需要找到相关的编码方法将其转换为可用的字符串。

希望有帮助！

埃里克

# algorithm - ColdFusion - 搜索结构数组的有效方法是什么？

> ID：865627
> 
> 赞同：14
> 
> 时间：2009-05-14T20:39:13.553
> 
> 标签：algorithm, arrays, search, coldfusion, struct

我在 ColdFusion 中有一个半大（数百条记录）一维数组。数组中的每一项都是具有多个属性的结构。我想在数组中搜索具有特定“名称”属性的结构。我知道对于字符串值数组，我可以使用如下 Java 方法：

```
<cfset arrayIndex = myArray.indexOf("WhatImLookingFor") + 1> 
```

...但这不适用于结构数组。我也知道我可以像这样暴力破解它：

```
<cfset arrayIndex = 0>
<cfloop from="1" to="#ArrayLen(myArray)#" index="counter">
    <cfif myArray[counter].name IS "WhatImLookingFor">
        <cfset arrayIndex = counter>
    </cfif>
</cfloop> 
```

...但我觉得必须有一种更有效的方法。有没有人有比这更好的解决方案？您可以假设“名称”属性存在于每个结构中，并且数组中没有间隙或其他对象。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-15T03:01:30.017

除非您在构建数组时创建了一个哈希表，否则我看不出您将如何创建一个比您发布的 O(n) 解决方案更快的搜索函数。无论如何，在构建数组时，您可以执行以下操作：

```
<cfloop query="qryValues">
    <cfset nameValues[name] = currentrow />
    <cfset myArray[currentrow].name = name />
</cfloop>

<cfset arrayIndex = nameValues["WhatImLookingFor"] /> 
```

这假定该值始终存在。在拨打电话之前，您可能需要检查 StructKeyExists(nameValues, "WhatImLookingFor")。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-06T21:17:06.280

在 CF 10 或 Railo 4 中，您可以使用：

```
arrayIndex = ArrayFind(arrayOfStructs, function(struct){ 
   return struct.name == "WhatImLookingFor"; 
}); 
```

它没有记录，但它有效！如果您想要所有索引，ArrayFindAll() 也是一个选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T20:44:43.010

如果不深入研究，我会考虑将结构转换为查询（如下），然后对查询进行查询..假设您的数据集不是太大！

[http://www.bennadel.com/blog/264-Ask-Ben-Converting-A-Struct-To-A-Query-And-More-Java-.htm](http://www.bennadel.com/blog/264-Ask-Ben-Converting-A-Struct-To-A-Query-And-More-Java-.htm)

分享你最终做了什么！

编辑：建议的 StructFindValue 看起来也很棒，我没想到要查找任何相关功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:44:20.250

您要么想使用 StructFindValue 要么 StructFindKey

[http://livedocs.adobe.com/coldfusion/7/htmldocs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=ColdFusion_Documentation&file=00000640.htm#137597](http://livedocs.adobe.com/coldfusion/7/htmldocs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=ColdFusion_Documentation&file=00000640.htm#137597)

[http://livedocs.adobe.com/coldfusion/7/htmldocs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=ColdFusion_Documentation&file=00000639.htm#137550](http://livedocs.adobe.com/coldfusion/7/htmldocs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=ColdFusion_Documentation&file=00000639.htm#137550)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T02:33:23.313

[CFgroovy](http://barneyb.com/cfgroovy/) FTW！:)

```
<cfset count = 0>
<g:script>
count = myArray.find({ 
  it["NAME"] == "WhatImLookingFor" }
})
</g:script> 
```

或者..如果你喜欢更多的 java 风格（没有闭包）

```
<cfset count = 0>
<g:script>
for (i in myArray) {
  if( i["NAME"] == "WhatImLookingFor" )
    count++
}
</g:script> 
```

# postgresql - 如何在 PostgreSQL 中添加多对一关系

> ID：865633
> 
> 赞同：1
> 
> 时间：2009-05-14T20:40:03.647
> 
> 标签：postgresql, one-to-many

我有两个表：“Stock Master”和“Stock In”，如何在它们之间创建多对一关系？“Stock In”记录了许多不同日期和数量的不同库存，但“Stock Master”必须将相同的库存及其数量显示并合并为一个，并且必须具有先进先出的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T20:49:26.807

这听起来不像多对一是你真正需要的。

如果我理解正确，您有不同类型的不同时间进入的库存。您想记录收到的货物，您想查看您拥有多少特定类型，并且您希望能够识别最早收到的批次，以便您可以优先考虑运输。

大大简化了，您只需要一张记录已接收货物的表格，其中包含一个接收时间和日期列，您可以调用 WHERE 子句来确定哪个条目是最旧的，因此应该发货。

您不需要这样的表格来汇总库存（暂时忽略物化视图等选项）。只需对数量列求和；按产品类型分组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:24:01.357

如果您想在 Postgresql 中创建一个视图（就像您对 JosefAssad 的建议的评论所做的那样），就像在任何其他 SQL 数据库中一样，请使用以下内容：

```
CREATE VIEW Stockmaster (prodid, total)
  AS SELECT prodid, SUM(quantity)
  FROM Stockin
  GROUP BY prodid 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T20:48:36.167

除非我在这里遗漏了一些东西，否则您可以使用适当的主键/外键关系来处理这个问题。

# iphone - UIView：如何进行无损绘图？

> ID：865636
> 
> 赞同：18
> 
> 时间：2009-05-14T20:40:55.813
> 
> 标签：iphone, uiview, drawing, cgbitmapcontextcreate, off-screen

我原来的问题：

> 我正在创建一个简单的绘图应用程序，并且需要能够在我的`drawRect`. 在不完全替换现有内容的情况下绘制现有内容的正确方法是什么？

根据在这里和其他地方收到的答案，这就是交易。

1.  您应该准备好在`drawRect` 调用时重新绘制整个矩形。

2.  您**无法**通过执行以下操作来防止内容被删除：

    `[self setClearsContextBeforeDrawing: NO];`

    这只是对图形引擎的一个提示，让它为您预先清除视图是没有意义的，因为无论如何您可能需要重新绘制整个区域。它可能会阻止您的视图被自动删除，**但您不能依赖它**。

3.  要在视图顶部绘制而不擦除，请在屏幕外位图上下文中进行绘图（系统永远不会清除该上下文。）然后在您的 中`drawRect`，从该屏幕外缓冲区复制到视图。

例子：

```
- (id) initWithCoder: (NSCoder*) coder {    
     if (self = [super initWithCoder: coder]) {
         self.backgroundColor = [UIColor clearColor];
         CGSize size = self.frame.size;
         drawingContext = [self createDrawingBufferContext: size];
     }

     return self;
 }

- (CGContextRef) createOffscreenContext: (CGSize) size  {
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = CGBitmapContextCreate(NULL, size.width, size.height, 8, size.width*4, colorSpace, kCGImageAlphaPremultipliedLast);
    CGColorSpaceRelease(colorSpace);

    CGContextTranslateCTM(context, 0, size.height);
    CGContextScaleCTM(context, 1.0, -1.0);
    return context;
}

- (void)drawRect:(CGRect) rect {    
    UIGraphicsPushContext(drawingContext);
    CGImageRef cgImage = CGBitmapContextCreateImage(drawingContext); 
    UIImage *uiImage = [[UIImage alloc] initWithCGImage:cgImage];
    UIGraphicsPopContext();
    CGImageRelease(cgImage);
    [uiImage drawInRect: rect];
    [uiImage release];
 } 
```

**TODO**：任何人都可以优化，`drawRect`以便只使用（通常很小的）修改后的矩形区域进行复制吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T20:46:11.790

在离屏图像中绘制所有内容是相当常见的，并且在绘制屏幕时简单地显示该图像。您可以阅读：[创建位图图形上下文](http://developer.apple.com/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-CJBHBFFE)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-14T22:58:35.640

**关于优化drawRect**

试试这个：

```
- (void)drawRect:(CGRect)rect {
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGImageRef cgImage = CGBitmapContextCreateImage(drawingContext);
    CGContextClipToRect(context, rect);
    CGContextDrawImage(context, CGRectMake(0, 0, self.frame.size.width, self.frame.size.height), cgImage);
    CGImageRelease(cgImage);
} 
```

之后，您还应该在代码中注释这些行：

```
//CGContextTranslateCTM(context, 0, size.height);
//CGContextScaleCTM(context, 1.0, -1.0); 
```

还创建[了一个单独的问题](https://stackoverflow.com/questions/3043972/quartz-2d-draw-from-a-cgcontext-to-another-cgcontext)，以确保它是最佳方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-14T20:38:14.110

这似乎是比我一直使用的更好的方法。也就是说，在触摸事件中，我制作了即将更新的视图的副本。然后在 drawRect 中，我获取该图像并将其绘制到视图并同时更改我的其他视图。

但这似乎效率低下，但我想出了如何做到这一点的唯一方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T09:42:21.367

这可以防止您的视图在 drawRect 完成之前被删除：

```
[self.layer setNeedsDisplay]; 
```

此外，我发现最好在 drawRect 方法中完成所有绘图（除非你有充分的理由不这样做）。在屏幕外绘制和传输需要更多时间并增加更多复杂性，然后简单地绘制一次。

# c# - C# 问题创建方法以删除注册表项

> ID：865638
> 
> 赞同：2
> 
> 时间：2009-05-14T20:41:03.130
> 
> 标签：c#, registry

我承认我是 C# 的新手。我正在努力创建一种使用 .NET 删除注册表项的方法。该方法采用一个字符串参数，其中包含要删除的完整键。这是我正在尝试做的但不起作用的示例（显然）：

```
namespace NameHere
{
    class Program
    {
        static void Main(string[] args)
        {
            RegistryKey hklm = Registry.LocalMachine;
            hklm = hklm.OpenSubKey(@"SYSTEM\CurrentControlSet\Control\Print\Environments\Windows NT x86\")
        string strKey=”Test123”;
string fullPath = hklm + "\\" + strKey;
            deleteRegKey(fullPath);  
        }

        static void deleteRegKey(string keyName)
        {

            Registry.LocalMachine.DeleteSubKey(keyName);

        }
    } 
} 
```

我已经尝试了其他一些迭代并在谷歌上搜索了解决方案，但到目前为止，我还无法将这些部分组合在一起。任何帮助将不胜感激。此外，任何解释为什么我的蹩脚尝试无法帮助澄清我的知识差距的任何解释都很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T20:51:46.957

我相信你有太多的\'s。试试这个：

```
RegistryKey hklm = Registry.LocalMachine;
hklm = hklm.OpenSubKey(@"SYSTEM\CurrentControlSet\Control\Print\Environments\Windows NT x86\")
string strKey=”Test123”;
string fullPath = hklm + strKey;
deleteRegKey(fullPath); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T00:29:26.870

这个例程真的应该是单行的，比如：

Registry.LocalMachine.DeleteSubKey(@"SYSTEM\ControlSet...\etc...");

您不需要打开 RegistryKey 对象，因为 Registry.LocalMachine 已经为您打开了。

如果您确实需要打开 RegistryKey 对象来执行其他操作，请注意 RegistryKey 实现 IDisposable，因此既然您已经创建了一个对象，那么无论如何您都要负责处理它。所以，你必须用**try { ... }包围你的代码，并在****finally**块中调用 Dispose() 。幸运的是，这可以用 C# 更优雅地使用**using**进行编码：

```
using( RegistryKey key = Registry.LocalMachine.OpenSubKey(...) ) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T21:05:59.807

我认为@Correl 有它。

但是帮助您调试的一种方法是使用[这种形式的 DeleteSubkey](http://msdn.microsoft.com/en-us/library/1zwkz4bt.aspx)：

```
public void DeleteSubKey(
    string subkey,
    bool throwOnMissingSubKey
) 
```

而不是你只用一个参数调用的那个，并将 true 作为第二个参数传递。这样一来，如果

> ...指定的子键不存在，然后引发异常。

您得到的异常是[ArgumentException](http://msdn.microsoft.com/en-us/library/system.argumentexception.aspx)。

# windows-mobile - 如何防止 Windows（移动）安装程序覆盖注册表项值

> ID：865646
> 
> 赞同：1
> 
> 时间：2009-05-14T20:43:15.603
> 
> 标签：windows-mobile, installation, cab

我正在完成一个我编写的 Windows Mobile (6.1) 应用程序，一切都很好，花花公子，但我遇到了一个令人讨厌的问题：我的应用程序需要一些用于设置的注册表项，我可以在安装程序中创建它们（使用注册表编辑器）很好，但我的问题是每次我运行安装程序来更新软件的新版本时，它都会覆盖那些注册表值。

是否可以创建一个 .cab 安装程序来创建指定的注册表项（如果它们不存在），但如果它们存在则不理会它们。

另外，如果我假设安装项目会自动删除它在安装期间创建的卸载中的所有注册表项，我是否正确？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T21:49:13.340

我不相信您对安装程序 INF 中的注册表设置有太多控制权。

您需要做的是创建一个[设置 dll](http://msdn.microsoft.com/en-us/library/aa924308.aspx)，它将为您提供执行任何操作所需的所有控制权。问题是您必须用 C 或 C++ 编写它，但它应该很容易，因为您要做的就是设置注册表项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-02T13:47:32.610

不需要自定义 DLL。使用[INF 条目中的 FLG_ADDREG_NOCLOBBER (0x00000002)](http://msdn.microsoft.com/en-us/library/ms938375.aspx)作为您的 reg 键。

# jquery - 为什么这个函数不替换类

> ID：865648
> 
> 赞同：1
> 
> 时间：2009-05-14T20:43:26.180
> 
> 标签：jquery

我有一个正在测试的函数，它应该检查所有表头以查看它是否具有特定的类，将其删除并用另一个类替换它。我正在使用它来切换 tablesorter 插件的元数据解析器。我到目前为止的代码如下：

```
$(function(){
    $("th").each(function(){
        if ($(this).hasClass("{sorter: 'usLongDate'}")) { 
            $(this).removeClass("{sorter: 'usLongDate'}").addClass("{sorter: 'false'}");
            }       
    });
});

$(function() {
    $("table").tablesorter({}); 
}); 
```

我正在尝试将以下标头中的类解析器切换为错误的内联解析器。

```
<th class="{sorter: 'usLongDate'}"><a rel = "Header" href="#" title="Sort column in decending order" class="">Date</a></th> 
```

当然这不是我唯一的标题，我只是在这个上测试它，我假设其余的标题不应该受到影响，tablesorter 应该仍然对它们进行排序。但是当我运行 html 文件时，没有任何效果。有什么我想念的吗？谢谢。

注意：为了避免混淆，jQuery 的 tablesorter 插件可以在表头的 class 属性中使用内联解析器，以确定如何和/或是否应该对列进行排序。

更新：尝试了文森特罗伯特的建议，不幸的是它不起作用。关于 addClass 和 removeClass 是否可以处理这些。我有一个能够将禁用解析器添加到所有类的原始函数，

```
$("th[class='']").addClass("{sorter: 'false'}"); 
```

这来自 Paolo Bergantino，效果很好。我只是想扩展一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T20:54:02.223

如我错了请纠正我。但是 class="{sorter: 'usLongDate'}" 不是有效的类名。类是用空格分隔的名称。class="class1 class2" 表示元素有两个类 class1 和 class2 不是一个类。[此处](http://www.w3.org/TR/REC-html40/types.html#type-cdata)解释了有效的类名。

**编辑**

如果您希望能够更改类，请使用 attr 而不是添加/删除类

```
$(this).attr('class', 'myNewClass'); 
```

并删除使用：

```
$(this).removeAttr('class'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T21:14:40.240

我不认为 addClass() 或 removeClass() 可以处理这些“类”。您应该直接访问“类”属性。

现在我对这个插件不熟悉......

```
$(function(){
    $("th").each(function(){
        if ($(this).attr("class") == "{sorter: 'usLongDate'}") { 
                $(this).attr("class", "{sorter: 'false'}");
            }           
    });
}); 
```

**编辑**

刚刚浏览了文档，您可以使用选项方式而不是类方式：

```
$('table').tablesorter({ 
    headers: $('th').map(function(i)
    { 
        return { sorter: false /* or whatever you want based on $(this) content */ }; 
    }) 
}); 
```

只要您在任何 tablesorter() 调用之前调用它，这应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:13:31.787

如果你打电话

```
$("table").tablesorter({}); 
```

在尝试查看课程之前？我假设是插件将这些类名放在适当的位置？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T17:42:38.137

这可能是您正在寻找的。

```
$(document).ready(function() { 
    $("th[class*='usLongDate']").each(function(){
        $(this).removeClass("{sorter: 'usLongDate'}").addClass("{sorter: false}");
    });
    $("table").tablesorter(); 
}); 
```

问题可能源于类由空格分隔的事实。从技术上讲，“{sorter:”和“'usLongDate'}”是两个不同的类。我不确切知道 TableSorter 是如何处理它们的，但是删除“{sorter:”然后将其重新添加应该将其保留在“false}”旁边。

# php - 有没有办法在 Zend 中自动过滤 getRequest() 参数？

> ID：865649
> 
> 赞同：1
> 
> 时间：2009-05-14T20:43:26.850
> 
> 标签：php, zend-framework

如果我不需要，我真的不想在每次 getRequest->getParam('x') 之后在我的代码中调用 Zend 过滤器。有没有一种懒惰的方式来神奇地过滤 getRequest 中的所有内容？

**编辑：** *当我说过滤器时，我的意思是转义标签、清除 XSS 和转义任何 sql 转义字符。*

IE：

```
$myVar = $this->getRequest()->getParam('x');
filter the variable, escape sql stuf... etc 
```

标准是什么？你怎么样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T21:21:17.917

有几种方法可以处理您的情况。

首先，您可以一次获取所有参数：

```
$params = $this->_request->getParams(); //_request is equivalent to getRequest() 
```

因此，过滤所有参数的一种懒惰方法是在声明过滤器时使用 *****，这意味着所有字段，并且看起来像：

```
$filters = array('*' => array('StringTrim','HtmlEntities','StripTags'));
$input = new Zend_Filter_Input($filters,$validators,$params);
if($input->isValid()) {
     //blah blah blah
} 
```

您应该阅读更多关于[请求](http://framework.zend.com/manual/en/zend.controller.request.html)对象以及[过滤器](http://framework.zend.com/manual/en/zend.filter.html)、[输入过滤器](http://framework.zend.com/manual/en/zend.filter.input.html)和[验证器](http://framework.zend.com/manual/en/zend.validate.html)的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T22:18:56.217

唯一的办法就是以各种方式去做。

*   使用`Zend_Filter_Input`（如上面 karim79 所述）过滤事物以使其存储或查找方式（使用`StripTags`、 转换为`Int`、`StringTrim`等剥离标签），验证需要验证的位置 - 但不是 htmlentities，因为这可能应该在输出到避免数据库搜索等复杂化。在大多数情况下，应单独过滤/验证字段。

*   始终使用参数化查询（`Zend_Db_Select`带有 ? 占位符），或者至少使用 db 转义函数

*   根据需要转义所有输出 ( `Zend_View_Helper_Escape`-> `$this->escape()`)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:40:35.060

karim79 的回答包括在一个数组中抓取参数。

通常你不应该需要 Zend_Filter 在每个请求的基础上清理数据。

为了防止 XSS，您应该在视图中转义数据输出：

```
$this->escape($someUserSuppliedData) 
```

并且在处理 Zend_Db 时，一些方法（例如 insert 和 update）将为您引用数据。手动构建查询时，您可以使用 Zend_Db 函数，如[quote](http://framework.zend.com/manual/en/zend.db.html#zend.db.adapter.quoting.quote)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T22:38:53.097

也许他正在寻找一种方法来重载 getRequest() 方法，然后在新创建的方法中过滤请求对象。

查看： http: [//framework.zend.com/manual/en/zend.controller.plugins.html](http://framework.zend.com/manual/en/zend.controller.plugins.html)

然后你可以只使用 Zend_Filter 类或创建你自己的过滤器类重载上述..

# windows - 如何解决 Windows 计划任务未运行的问题？

> ID：865653
> 
> 赞同：13
> 
> 时间：2009-05-14T20:44:20.750
> 
> 标签：windows, scheduled-tasks

在部署我们的 .net 应用程序的过程中，我在服务器上设置了大约 20 个计划任务，所有这些任务基本上都做同样的事情：调用一个小型 .net 控制台应用程序，它从 SQL 数据库中提取数据并发布它到网络服务。每个任务调用应用程序的单独副本，每个副本在其配置文件中具有不同的查找 ID 值。

除了其中两个任务之外，所有任务每晚都可靠地运行。其中两个任务似乎不时停止运行，目前尚不清楚原因。当它们停止运行时，计划任务界面会正确显示它们的最后运行日期，该日期比在计划时间继续运行的其他任务晚一天或更长时间。停止运行的任务不会自行再次运行，尽管已按计划每晚运行。事件日志或计划任务界面本身中没有记录错误。这对我们来说是最奇怪的部分：如果我手动启动计划任务，它运行良好，它调用 .net 控制台应用程序并且一切都完成而没有异常。然后它继续在预定的时间运行良好，一次数天或数周，但最终失败，似乎出乎意料。似乎这两个任务总是在同一天晚上开始失败。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T20:48:36.840

有一个“最后结果”列应该为您提供与正在运行的任务本身相关的代码（它不会有任何类型的异常数据）。0 表示任务完成且没有错误。您可以查找其他任何内容，看看为什么任务无法启动。如果任务似乎仍然没有运行，但您仍然看到 Last Result 为 0，这意味着您的代码中有问题，但它正在正常退出。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-12-18T23:20:56.017

您是否设置了“开始于”属性？

如果这些 .NET 控制台应用程序需要 app.config 或位于其路径中的某些文件，则必须将“Start in”属性设置为“c:\your\app\path\”，否则它们就像在系统目录中一样启动，他们找不到他们需要的文件！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-15T15:52:08.673

Taskscheduler 在 64 位系统上假设应用程序是 64 位的。如果是 32 位从 32 位命令行启动它，即如果你想运行 c:\program files (x86)\Myprogram\Program.exe，告诉 taskscheduler 启动：

*   %systemroot%\Syswow64\cmd.exe /C "c:\program 文件 (x86)\Myprogram\Program.exe"

这迫使它从 32 位命令提示符启动，因此使用 32 位仿真。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-08-30T05:44:58.487

我发现这个**超级有用的链接**：[https](https://windowsreport.com/windows-scheduled-tasks-not-running/) ://windowsreport.com/windows-scheduled-tasks-not-running/用于许多用例的彻底调试步骤。

在我的情况下，调度程序配置为运行的用户帐户被锁定，停止执行计划任务，没有任何日志或报告问题。

[![在此处输入图像描述](https://i.stack.imgur.com/2strM.png)](https://i.stack.imgur.com/2strM.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-14T20:26:08.060

将计划任务与无密码 Windows 用户帐户关联时，会出现计划任务未运行的一个原因：默认情况下，计划任务无法使用空白密码运行。如果要从没有密码的帐户运行计划任务，则必须禁用系统变量：

*   转到：开始 > 管理工具 > 本地安全策略 > 安全设置 > 本地策略 > 安全选项
*   选择：“帐户：将本地帐户使用空白密码限制为仅限控制台登录”
*   禁用此变量

*免责声明：不建议使用没有密码的帐户。*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-09-28T10:47:03.210

以下 SO 问题的答案也可能与阅读此问题的人高度相关（但是，注意，它仅描述了计划任务的*一个*可能的特定问题，我相信这些问题都不是另一个问题的重复）：

[为什么我的计划任务正确更新其“上次运行时间”，并给出“（0x0）”的“上次运行结果”，但仍然无法正常工作？](https://stackoverflow.com/questions/32589381/)

对另一个问题给出的答案的总结是，Windows 2012 计划任务看不到正确的环境变量，包括 PATH，用于任务设置为运行的帐户。

就更一般的计划任务故障排除而言（如本问题所述），您可以测试此特定问题（例如`SET > test.txt`，在任务中运行，如该答案中所建议的那样），一旦您看到它发生，您就可以解决如果它影响到你。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-05-14T14:27:10.273

在我的情况下，即使它说上次运行成功（0），计划任务也不会运行。事实证明，运行作业的 Windows 用户帐户已被锁定。我之所以意识到这一点，是因为我尝试编辑现有的计划任务，将用户帐户设置为相同的，然后点击确定，它给了我一个关于帐户被锁定的错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T21:09:42.403

也许他们挂了，还在跑？

您可以单击额外菜单并选择菜单条目以查看日志，然后记事本将从任务计划器中打开一个日志文件

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-17T23:22:57.947

当我尝试对行为不端的计划任务进行故障排除时，我发现此页面很有帮助：http:
[//support.microsoft.com/kb/308558](http://support.microsoft.com/kb/308558)

选择 View->Details 以显示附加信息，例如 Last Run Time 和 Status，这个页面给了我状态/错误代码的含义：http:
[//msdn.microsoft.com/en-us/library/windows /desktop/ms681381(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681381(v=vs.85).aspx)

# sql-server - SQL Server 检查点

> ID：865659
> 
> 赞同：7
> 
> 时间：2009-05-14T20:45:07.003
> 
> 标签：sql-server, checkpoint

谁能解释 SQL Server 何时发出检查点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T20:51:13.760

来自：http: [//msdn.microsoft.com/en-us/library/ms188748.asp](http://msdn.microsoft.com/en-us/library/ms188748.asp)

导致检查点的事件
在数据库备份之前，数据库引擎会自动执行一个检查点，以便对数据库页面的所有更改都包含在备份中。此外，当出现以下任一情况时，检查点会自动出现：

*   日志的活动部分超过了服务器可以在恢复间隔服务器配置选项中指定的时间内恢复的大小。
*   日志已满 70%，并且数据库处于日志截断模式。当这两个条件都为 TRUE 时，数据库处于日志截断模式：数据库正在使用简单恢复模型，并且在执行引用数据库的最后一个 BACKUP DATABASE 语句后，发生以下事件之一：
*   在数据库中执行最少记录的操作
    ，例如执行最少记录的大容量复制操作或执行最少记录的 WRITETEXT
    语句。执行ALTER
    DATABASE 语句来
    添加或删除
    数据库中的文件。

此外，停止服务器会在服务器上的每个数据库中发出一个检查点。以下停止 SQL Server 的方法为每个数据库执行检查点：

使用 SQL Server 配置管理器。使用 SQL Server 管理工作室。使用 SHUTDOWN 语句。

# c# - .NET Framework 中是否有 ReadWord() 方法？

> ID：865661
> 
> 赞同：1
> 
> 时间：2009-05-14T20:45:43.617
> 
> 标签：c#, .net, parsing, text

我不想重新发明已经写好的东西，所以我想知道.NET Framework 中的某个地方是否有一个 ReadWord() 函数，它基于一些由空格和换行符分隔的文本来提取单词。

如果没有，您有想要分享的实现吗？

```
string data = "Four score and seven years ago";
List<string> words = new List<string>();
WordReader reader = new WordReader(data);

while (true)
{
   string word =reader.ReadWord();
   if (string.IsNullOrEmpty(word)) return;
   //additional parsing logic goes here
   words.Add(word);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T20:48:46.543

不是我直接知道的。如果您不介意一次性获得它们，则可以使用正则表达式：

```
Regex wordSplitter = new Regex(@"\W+");
string[] words = wordSplitter.Split(data); 
```

如果你有前导/尾随空格，你会在开头或结尾得到一个空字符串，但你总是可以`Trim`先调用。

另一种选择是编写一个基于`TextReader`. 如果您使用的是 .NET 3.5，它甚至可以是一种扩展方法。示例实现：

```
using System;
using System.IO;
using System.Text;

public static class Extensions
{
    public static string ReadWord(this TextReader reader)
    {
        StringBuilder builder = new StringBuilder();
        int c;

        // Ignore any trailing whitespace from previous reads            
        while ((c = reader.Read()) != -1)
        {
            if (!char.IsWhiteSpace((char) c))
            {
                break;
            }
        }
        // Finished?
        if (c == -1)
        {
            return null;
        }

        builder.Append((char) c);
        while ((c = reader.Read()) != -1)
        {
            if (char.IsWhiteSpace((char) c))
            {
                break;
            }
            builder.Append((char) c);
        }
        return builder.ToString();
    }
}

public class Test
{
    static void Main()
    {
        // Give it a few challenges :)
        string data = @"Four score     and

seven years ago    ";

        using (TextReader reader = new StringReader(data))
        {
            string word;

            while ((word = reader.ReadWord()) != null)
            {
                Console.WriteLine("'{0}'", word);
            }
        }
    }
} 
```

输出：

```
'Four'
'score'
'and'
'seven'
'years'
'ago' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T20:53:55.843

不是这样，但是您可以使用 String.Split 根据分隔字符或字符串将字符串拆分为字符串数组。您还可以为拆分指定多个字符串/字符。

如果您希望在不将所有内容加载到内存的情况下执行此操作，那么您可以编写自己的流类，该类在从流中读取时执行此操作，但以上是少量数据分词的快速修复。

# c++ - 为什么从 std::vector 中随机删除比 std::list 快？

> ID：865666
> 
> 赞同：-1
> 
> 时间：2009-05-14T20:46:15.377
> 
> 标签：c++, vector, iterator, arraylist, std

为什么从 std::vector 中随机删除比 std::list 快？我正在做的加快它的是将随机元素与最后一个交换，然后删除最后一个。我原以为该列表会更快，因为它是为随机删除而构建的。

```
for(int i = 500; i < 600; i++){
    swap(vector1[i], vector1[vector1.size()-1]);
    vector1.pop_back();
}

for(int i = 0; i < 100; i++){
        list1.pop_front();
} 
```

结果（以秒为单位）：
Vec 交换删除：0.00000909461232367903
列表正常删除：0.00011785102105932310

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-14T20:49:12.377

您正在做的不是随机删除。您要从最后删除，这就是构建向量的目的（除其他外）。

并且在交换时，您正在执行单个随机索引操作，这*也是*向量所擅长的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T21:32:12.367

`std::list`和之间的区别`std::vector`不仅仅取决于性能。它们也有不同的迭代器失效语义。如果您从 a 中删除一个项目`std::list`，则指向列表中其他项目的所有迭代器仍然有效。不是这样`std::vector`，擦除一个项目会使指向该项目的所有迭代器无效。（在某些实现中，它们可能仍然充当有效的迭代器，但根据标准，它们现在不可用，如果您尝试使用它们，检查实现应该断言。）

所以你对容器的选择也与你需要的语义有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T20:51:45.037

这不是随机的。试试 vector1.erase(vector.begin() + rand() % vector.size()); 反而。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:52:20.950

该列表`erase`将导致删除已删除的列表元素，这将调用对`delete`操作员的调用。矢量擦除只会导致交换，然后是整数递减 - 这要快得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T21:22:25.823

**实际上，如果您想进一步加快速度，您应该通过iterators**索引向量中的元素。众所周知，它们对于某些架构具有更好的性能。

# c++ - 在 C++ 中解析命令行参数？

> ID：865668
> 
> 赞同：211
> 
> 时间：2009-05-14T20:46:44.643
> 
> 标签：c++, command-line-arguments

如果程序被指定为这样运行，那么在 C++ 中解析命令行参数的最佳方法是什么：

```
prog [-abc] [input [output]] 
```

有什么方法可以在标准库中内置，还是我需要编写自己的代码？

* * *

有关的：

*   [在 unicode C++ 应用程序中解析命令行参数](https://stackoverflow.com/questions/332849/parsing-command-line-arguments-in-a-unicode-c-application)

* * *

## 回答 #1

> 赞同：271
> 
> 时间：2009-05-15T14:09:54.090

`boost::program_options`和 GNU getopt的建议很好。

但是，对于简单的命令行选项，我倾向于使用 std::find

例如，在`-f`命令行参数之后读取文件名。您也可以只检测是否已传入单个单词选项以`-h`寻求帮助。

```
#include <algorithm>

char* getCmdOption(char ** begin, char ** end, const std::string & option)
{
    char ** itr = std::find(begin, end, option);
    if (itr != end && ++itr != end)
    {
        return *itr;
    }
    return 0;
}

bool cmdOptionExists(char** begin, char** end, const std::string& option)
{
    return std::find(begin, end, option) != end;
}

int main(int argc, char * argv[])
{
    if(cmdOptionExists(argv, argv+argc, "-h"))
    {
        // Do stuff
    }

    char * filename = getCmdOption(argv, argv + argc, "-f");

    if (filename)
    {
        // Do interesting things
        // ...
    }

    return 0;
} 
```

在使用这种方法要注意的事情上，您必须使用 std::strings 作为 std::find 的值，否则将对指针值执行相等检查。

* * *

我希望可以编辑此响应而不是添加一个新响应，因为这是基于原始答案的。我稍微重写了函数并将它们封装在一个类中，所以这里是代码。我认为以这种方式使用它可能也很实用：

```
class InputParser{
    public:
        InputParser (int &argc, char **argv){
            for (int i=1; i < argc; ++i)
                this->tokens.push_back(std::string(argv[i]));
        }
        /// @author iain
        const std::string& getCmdOption(const std::string &option) const{
            std::vector<std::string>::const_iterator itr;
            itr =  std::find(this->tokens.begin(), this->tokens.end(), option);
            if (itr != this->tokens.end() && ++itr != this->tokens.end()){
                return *itr;
            }
            static const std::string empty_string("");
            return empty_string;
        }
        /// @author iain
        bool cmdOptionExists(const std::string &option) const{
            return std::find(this->tokens.begin(), this->tokens.end(), option)
                   != this->tokens.end();
        }
    private:
        std::vector <std::string> tokens;
};

int main(int argc, char **argv){
    InputParser input(argc, argv);
    if(input.cmdOptionExists("-h")){
        // Do stuff
    }
    const std::string &filename = input.getCmdOption("-f");
    if (!filename.empty()){
        // Do interesting things ...
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2009-05-14T20:49:37.383

[Boost.Program_options](http://www.boost.org/doc/libs/release/libs/program_options/) 应该可以解决问题

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2011-10-10T11:54:05.793

我可以建议[模板化 C++ 命令行解析器库（](http://tclap.sf.net) [GitHub 上](https://github.com/search?q=tclap)的一些分支可用），API 非常简单并且（引自网站）：

> 该库完全在头文件中实现，使其易于使用和与其他软件一起分发。它在 MIT 许可证下获得许可，可以无忧分发。

这是手册中的一个示例，为简单起见，在此处着色：

```
#include <string>
#include <iostream>
#include <algorithm>
#include <tclap/CmdLine.h>

int main(int argc, char** argv)
{

    // Wrap everything in a try block.  Do this every time,
    // because exceptions will be thrown for problems.
    try {

    // Define the command line object, and insert a message
    // that describes the program. The "Command description message"
    // is printed last in the help text. The second argument is the
    // delimiter (usually space) and the last one is the version number.
    // The CmdLine object parses the argv array based on the Arg objects
    // that it contains.
    TCLAP::CmdLine cmd("Command description message", ' ', "0.9");

    // Define a value argument and add it to the command line.
    // A value arg defines a flag and a type of value that it expects,
    // such as "-n Bishop".
    TCLAP::ValueArg<std::string> nameArg("n","name","Name to print",true,"homer","string");

    // Add the argument nameArg to the CmdLine object. The CmdLine object
    // uses this Arg to parse the command line.
    cmd.add( nameArg );

    // Define a switch and add it to the command line.
    // A switch arg is a boolean argument and only defines a flag that
    // indicates true or false.  In this example the SwitchArg adds itself
    // to the CmdLine object as part of the constructor.  This eliminates
    // the need to call the cmd.add() method.  All args have support in
    // their constructors to add themselves directly to the CmdLine object.
    // It doesn't matter which idiom you choose, they accomplish the same thing.
    TCLAP::SwitchArg reverseSwitch("r","reverse","Print name backwards", cmd, false);

    // Parse the argv array.
    cmd.parse( argc, argv );

    // Get the value parsed by each arg.
    std::string name = nameArg.getValue();
    bool reverseName = reverseSwitch.getValue();

    // Do what you intend.
    if ( reverseName )
    {
            std::reverse(name.begin(),name.end());
            std::cout << "My name (spelled backwards) is: " << name << std::endl;
    }
    else
            std::cout << "My name is: " << name << std::endl;

    } catch (TCLAP::ArgException &e)  // catch any exceptions
    { std::cerr << "error: " << e.error() << " for arg " << e.argId() << std::endl; }
} 
```

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2008-10-31T14:02:56.093

[Boost.Program_options](http://www.boost.org/doc/libs/1_36_0/doc/html/program_options.html)

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2009-05-14T20:49:55.073

您可以使用[GNU GetOpt](http://www.gnu.org/software/hello/manual/libc/Getopt.html) (LGPL) 或各种 C++ 端口之一，例如[getoptpp](http://code.google.com/p/getoptpp/) (GPL)。

使用 GetOpt 的简单示例（*prog [-ab] input*）如下：

```
// C Libraries:
#include <string>
#include <iostream>
#include <unistd.h>

// Namespaces:
using namespace std;

int main(int argc, char** argv) {
    int opt;
    string input = "";
    bool flagA = false;
    bool flagB = false;

    // Retrieve the (non-option) argument:
    if ( (argc <= 1) || (argv[argc-1] == NULL) || (argv[argc-1][0] == '-') ) {  // there is NO input...
        cerr << "No argument provided!" << endl;
        //return 1;
    }
    else {  // there is an input...
        input = argv[argc-1];
    }

    // Debug:
    cout << "input = " << input << endl;

    // Shut GetOpt error messages down (return '?'): 
    opterr = 0;

    // Retrieve the options:
    while ( (opt = getopt(argc, argv, "ab")) != -1 ) {  // for each option...
        switch ( opt ) {
            case 'a':
                    flagA = true;
                break;
            case 'b':
                    flagB = true;
                break;
            case '?':  // unknown option...
                    cerr << "Unknown option: '" << char(optopt) << "'!" << endl;
                break;
        }
    }

    // Debug:
    cout << "flagA = " << flagA << endl;
    cout << "flagB = " << flagB << endl;

    return 0;
} 
```

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2008-10-31T14:12:30.270

GNU [GetOpt](http://www.gnu.org/software/libtool/manual/libc/Getopt.html)。

使用 GetOpt 的简单示例：

```
// C/C++ Libraries:
#include <string>
#include <iostream>
#include <unistd.h>

// Namespaces:
using namespace std;

int main(int argc, char** argv) {
    int opt;
    bool flagA = false;
    bool flagB = false;

    // Shut GetOpt error messages down (return '?'): 
    opterr = 0;

    // Retrieve the options:
    while ( (opt = getopt(argc, argv, "ab")) != -1 ) {  // for each option...
        switch ( opt ) {
            case 'a':
                    flagA = true;
                break;
            case 'b':
                    flagB = true;
                break;
            case '?':  // unknown option...
                    cerr << "Unknown option: '" << char(optopt) << "'!" << endl;
                break;
        }
    }

    // Debug:
    cout << "flagA = " << flagA << endl;
    cout << "flagB = " << flagB << endl;

    return 0;
} 
```

如果您有接受参数的选项，您也可以使用[*optarg 。*](https://www.gnu.org/software/libc/manual/html_node/Using-Getopt.html)

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2012-01-24T18:12:37.777

另一种选择是精益平均 C++ 选项解析器：

[http://optionparser.sourceforge.net](http://optionparser.sourceforge.net/index.html)

它是一个只有头文件的库（实际上只是一个头文件），与所有其他建议不同，它也是独立的，即它没有任何依赖关系。特别是不依赖于 STL。它甚至不使用异常或任何其他需要库支持的东西。这意味着它可以与纯 C 或其他语言链接，而无需引入“外来”库。

与 boost::program_options 一样，它的 API 提供了对选项的方便直接访问，即您可以编写这样的代码

> 如果（选项[帮助]）...;

和

> int verbosity = options[VERBOSE].count();

与 boost::program_options 不同的是，这只是使用以（用户提供的）枚举为索引的数组。这提供了没有重量的关联容器的便利性。

它有据可查，并拥有对公司友好的许可证 (MIT)。

TLMC++OP 包含一个很好的使用消息格式化程序，它可以进行换行和列对齐，这在本地化程序时很有用，因为它确保即使在消息较长的语言中输出看起来也很好。它还为您省去了手动格式化 80 列的使用格式的麻烦。

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2011-08-04T23:24:53.920

```
for (int i = 1; i < argc; i++) {

    if (strcmp(argv[i],"-i")==0) {
        filename = argv[i+1];
        printf("filename: %s",filename);
    } else if (strcmp(argv[i],"-c")==0) {
        convergence = atoi(argv[i + 1]);
        printf("\nconvergence: %d",convergence);
    } else if (strcmp(argv[i],"-a")==0) {
        accuracy = atoi(argv[i + 1]);
        printf("\naccuracy:%d",accuracy);
    } else if (strcmp(argv[i],"-t")==0) {
        targetBitRate = atof(argv[i + 1]);
        printf("\ntargetBitRate:%f",targetBitRate);
    } else if (strcmp(argv[i],"-f")==0) {
        frameRate = atoi(argv[i + 1]);
        printf("\nframeRate:%d",frameRate);
    }

} 
```

* * *

## 回答 #9

> 赞同：19
> 
> 时间：2011-05-11T23:10:40.403

[我发现使用ezOptionParser](http://ezoptionparser.sourceforge.net/)更容易。它也是一个单独的头文件，除了 STL 之外不依赖任何东西，适用于 Windows 和 Linux（很可能也适用于其他平台），由于示例而没有学习曲线，具有其他库不具备的功能（如文件导入/导出带有注释、带有分隔符的任意选项名称、自动使用格式等），并且是 LGPL 许可的。

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2012-08-22T22:37:46.947

[`TCLAP`](http://tclap.sourceforge.net/)是一个非常好的轻量级设计并且易于使用： [http ://tclap.sourceforge.net/](http://tclap.sourceforge.net/)

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2009-01-14T06:50:32.050

如果您只想自己处理命令行选项，**最简单**的方法是放置：

```
vector<string> args(argv + 1, argv + argc); 
```

在你的顶部`main()`。这会将所有命令行参数复制到`std::string`s 的向量中。然后您可以`==`轻松地使用比较字符串，而不是无休止的`strcmp()`调用。例如：

```
int main(int argc, char **argv) {
    vector<string> args(argv + 1, argv + argc);
    string infname, outfname;

    // Loop over command-line args
    // (Actually I usually use an ordinary integer loop variable and compare
    // args[i] instead of *i -- don't tell anyone! ;)
    for (auto i = args.begin(); i != args.end(); ++i) {
        if (*i == "-h" || *i == "--help") {
            cout << "Syntax: foomatic -i <infile> -o <outfile>" << endl;
            return 0;
        } else if (*i == "-i") {
            infname = *++i;
        } else if (*i == "-o") {
            outfname = *++i;
        }
    }
} 
```

**[编辑：我意识到我正在将`argv[0]`程序的名称复制到`args`-- 已修复。]**

* * *

## 回答 #12

> 赞同：18
> 
> 时间：2010-09-30T00:35:34.357

您可能想为此使用外部库。有*很多*可供选择。

Boost 有一个功能非常丰富（和往常一样）的库[Boost Program Options](http://www.boost.org/doc/libs/release/doc/html/program_options.html)。

在过去的几年里，我个人最喜欢的是[TCLAP——](http://tclap.sourceforge.net/)纯模板化，因此没有库或链接、自动“--help”生成和其他好东西。请参阅文档中[最简单的示例](http://tclap.sourceforge.net/manual.html#EXAMPLE)。

* * *

## 回答 #13

> 赞同：16
> 
> 时间：2008-10-31T16:46:05.717

并且有一个可用的[谷歌图书馆](http://gflags.github.io/gflags/)。

真的，命令行解析是“解决的”。随便挑一个。

* * *

## 回答 #14

> 赞同：15
> 
> 时间：2009-01-14T01:17:28.977

使用 C++，答案通常是在 Boost...

[Boost.Program 选项](http://www.boost.org/doc/libs/1_37_0/doc/html/program_options.html)

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2009-09-17T03:18:46.133

试试[Boost::Program Options](http://www.boost.org/doc/libs/1_40_0/doc/html/program_options.html)。它允许您读取和解析命令行以及配置文件。

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2014-07-14T12:44:55.233

我认为 GNU GetOpt 使用起来不太方便。

Qt 和 Boost 可能是一个解决方案，但您需要下载和编译大量代码。

所以我自己实现了一个解析器，它产生一个 std::map<std::string, std::string> 参数。

例如，调用：

```
 ./myProgram -v -p 1234 
```

地图将是：

```
 ["-v"][""]
 ["-p"]["1234"] 
```

用法是：

```
int main(int argc, char *argv[]) {
    MainOptions mo(argc, argv);
    MainOptions::Option* opt = mo.getParamFromKey("-p");
    const string type = opt ? (*opt).second : "";
    cout << type << endl; /* Prints 1234 */
    /* Your check code */
} 
```

**主选项.h**

```
#ifndef MAINOPTIONS_H_
#define MAINOPTIONS_H_

#include <map>
#include <string>

class MainOptions {
public:
    typedef std::pair<std::string, std::string> Option;
    MainOptions(int argc, char *argv[]);
    virtual ~MainOptions();
    std::string getAppName() const;
    bool hasKey(const std::string&) const;
    Option* getParamFromKey(const std::string&) const;
    void printOptions() const;
private:
    typedef std::map<std::string, std::string> Options;
    void parse();
    const char* const *begin() const;
    const char* const *end() const;
    const char* const *last() const;
    Options options_;
    int argc_;
    char** argv_;
    std::string appName_;
}; 
```

**MainOptions.cpp**

```
#include "MainOptions.h"

#include <iostream>

using namespace std;

MainOptions::MainOptions(int argc, char* argv[]) :
        argc_(argc),
        argv_(argv) {
    appName_ = argv_[0];
    this->parse();
}

MainOptions::~MainOptions() {
}

std::string MainOptions::getAppName() const {
    return appName_;
}

void MainOptions::parse() {
    typedef pair<string, string> Option;
    Option* option = new pair<string, string>();
    for (const char* const * i = this->begin() + 1; i != this->end(); i++) {
        const string p = *i;
        if (option->first == "" && p[0] == '-') {
            option->first = p;
            if (i == this->last()) {
                options_.insert(Option(option->first, option->second));
            }
            continue;
        } else if (option->first != "" && p[0] == '-') {
            option->second = "null"; /* or leave empty? */
            options_.insert(Option(option->first, option->second));
            option->first = p;
            option->second = "";
            if (i == this->last()) {
                options_.insert(Option(option->first, option->second));
            }
            continue;
        } else if (option->first != "") {
            option->second = p;
            options_.insert(Option(option->first, option->second));
            option->first = "";
            option->second = "";
            continue;
        }
    }
}

void MainOptions::printOptions() const {
    std::map<std::string, std::string>::const_iterator m = options_.begin();
    int i = 0;
    if (options_.empty()) {
        cout << "No parameters\n";
    }
    for (; m != options_.end(); m++, ++i) {
        cout << "Parameter [" << i << "] [" << (*m).first << " " << (*m).second
                << "]\n";
    }
}

const char* const *MainOptions::begin() const {
    return argv_;
}

const char* const *MainOptions::end() const {
    return argv_ + argc_;
}

const char* const *MainOptions::last() const {
    return argv_ + argc_ - 1;
}

bool MainOptions::hasKey(const std::string& key) const {
    return options_.find(key) != options_.end();
}

MainOptions::Option* MainOptions::getParamFromKey(
        const std::string& key) const {
    const Options::const_iterator i = options_.find(key);
    MainOptions::Option* o = 0;
    if (i != options_.end()) {
        o = new MainOptions::Option((*i).first, (*i).second);
    }
    return o;
} 
```

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2008-10-31T14:19:07.497

GNU C 库中有[这些工具，其中包括](http://www.gnu.org/software/libtool/manual/libc/Parsing-Program-Arguments.html#Parsing-Program-Arguments)[GetOpt](http://www.gnu.org/software/libtool/manual/libc/Getopt.html#Getopt)。

如果您使用 Qt 并且喜欢 GetOpt 界面，[froglogic在](http://www.froglogic.com)[这里](http://www.froglogic.com/pg?id=PublicationsFreeware&category=getopt)发布了一个不错的界面。

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2012-10-03T06:11:24.797

如果可以的话，我也想建议看一下我编写的选项解析库：[dropt](http://www.taenarum.com/software/dropt/)。

*   它是一个 C 库（如果需要，可以使用 C++ 包装器）。
*   它很轻。
*   它是可扩展的（可以轻松添加自定义参数类型，并且与内置参数类型具有同等地位）。
*   它应该是非常可移植的（它是用标准 C 编写的），没有依赖项（C 标准库除外）。
*   它有一个非常不受限制的许可证（zlib/libpng）。

它提供的一个许多其他功能没有的功能是能够覆盖早期选项。例如，如果您有一个 shell 别名：

```
alias bar="foo --flag1 --flag2 --flag3" 
```

并且您想使用`bar`但`--flag1`已禁用，它允许您执行以下操作：

```
bar --flag1=0 
```

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2009-09-17T03:19:02.277

我喜欢 C 的 getopt()，但是我老了。:-)

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2009-09-17T03:20:12.230

谷歌的[gflags](http://code.google.com/p/google-gflags/)

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2009-01-14T01:18:22.970

我建议使用图书馆。有经典而古老的[getopt](http://www.gnu.org/software/libtool/manual/libc/Getopt.html)，我相信还有其他人。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2009-04-21T08:45:02.350

有许多不错的库可用。

[Boost Program Options](http://www.boost.org/doc/libs/1_37_0/doc/html/program_options.html)是一个相当重量级的解决方案，因为将它添加到您的项目需要您构建 boost，并且语法有些混乱（在我看来）。但是，它几乎可以做任何事情，包括让命令行选项覆盖配置文件中设置的选项。

[SimpleOpt](http://code.jellycan.com/simpleopt/)是一个相当全面但简单的命令行处理器。它是一个单独的文件，结构简单，但仅将命令行解析为选项，您必须进行所有类型和范围检查。它适用于 Windows 和 Unix，并且还附带了一个适用于 Windows 的 glob 版本。

getopt 在 Windows 上可用。它与 Unix 机器上的相同，但它通常是一个 GPL 库。

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2011-08-17T15:23:19.390

[AnyOption](http://www.hackorama.com/anyoption/)是一个 C++ 类，用于轻松解析复杂的命令行选项。它还以选项值对格式解析来自 rsourcefile 的选项。

AnyOption 实现了传统的 POSIX 样式字符选项 (-n) 以及较新的 GNU 样式长选项 (--name)。或者，您可以通过要求忽略 POSIX 样式选项来使用更简单的长选项版本 ( -name )。

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2014-01-12T10:56:00.413

Qt 5.2 带有一个[命令行解析器 API](http://doc-snapshot.qt-project.org/qt5-stable/qcommandlineparser.html#details)。

小例子：

```
#include <QCoreApplication>
#include <QCommandLineParser>
#include <QDebug>

int main(int argc, char **argv)
{
  QCoreApplication app(argc, argv);
  app.setApplicationName("ToolX");
  app.setApplicationVersion("1.2");

  QCommandLineParser parser;
  parser.setApplicationDescription("Tool for doing X.");
  parser.addHelpOption();
  parser.addVersionOption();
  parser.addPositionalArgument("infile",
      QCoreApplication::translate("main", "Input file."));

  QCommandLineOption verbose_opt("+",
      QCoreApplication::translate("main", "be verbose"));
  parser.addOption(verbose_opt);

  QCommandLineOption out_opt(QStringList() << "o" << "output",
      QCoreApplication::translate("main", "Output file."),
      QCoreApplication::translate("main", "filename"), // value name
      QCoreApplication::translate("main", "out")   // default value
      );
  parser.addOption(out_opt);

  // exits on error
  parser.process(app);

  const QStringList args = parser.positionalArguments();

  qDebug() << "Input files: " << args
    << ", verbose: " << parser.isSet(verbose_opt)
    << ", output: " << parser.value(out_opt)
    << '\n';
  return 0;
} 
```

## 示例输出

自动生成的帮助屏幕：

```
$ ./qtopt -h
用法：./qtopt [选项] infile
做 X 的工具。

选项：
  -h, --help 显示此帮助。
  -v, --version 显示版本信息。
  -+ 冗长
  -o, --output 输出文件。

论据：
  infile 输入文件。

```

自动生成的版本输出：

```
$ ./qtopt -v
工具X 1.2

```

一些真实的电话：

```
$ ./qtopt b1 -+ -o tmp blah.foo
输入文件： ("b1", "blah.foo") ，详细：true ，输出："tmp"
$ ./qtop          
输入文件： () ，详细： false ，输出：“out”

```

解析错误：

```
$ ./qtopt --hlp
未知选项“hlp”。
$回声$？
1

```

## 结论

如果你的程序已经使用了 Qt (>= 5.2) 库，那么它的命令行解析 API 就足够方便完成工作了。

请注意，`QApplication`在选项解析器运行之前会使用内置 Qt 选项。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2016-09-15T08:08:53.563

命令基本上是一个字符串。一般来说，它可以分为两部分——命令的`name`和命令的`arguments`。

**例子：**

```
ls 
```

用于列出目录的内容：

```
user@computer:~$ ls
Documents Pictures Videos ... 
```

`ls`以上是在用户的文件夹内执行的`home`。此处，要列出的文件夹的参数隐式添加到命令中。我们可以显式传递一些参数：

```
user@computer:~$ ls Picture
image1.jpg image2.jpg ... 
```

在这里，我已明确告诉`ls`我想查看哪个文件夹的内容。例如，我们可以使用另一个参数来`l`列出每个文件和文件夹的详细信息，例如访问权限、大小等：

```
user@computer:~$ ls Pictures
-rw-r--r-- 1 user user   215867 Oct 12  2014 image1.jpg
-rw-r--r-- 1 user user   268800 Jul 31  2014 image2.jpg
... 
```

哦，大小看起来很奇怪（`215867`，`268800`）。`h`让我们为人类友好的输出添加标志：

```
user@computer:~$ ls -l -h Pictures
-rw-r--r-- 1 user user  211K Oct 12  2014 image1.jpg
-rw-r--r-- 1 user user  263K Jul 31  2014 image2.jpg
... 
```

一些命令允许组合它们的参数（在上述情况下，我们不妨编写`ls -lh`，我们将得到相同的输出），使用短名称（通常是单个字母，但有时更多；缩写）或长名称（如果`ls`我们有`-a`或`--all`用于列出所有文件，包括隐藏文件，其中包含)等`--all`的长名称`-a`。有些命令**的参数顺序非常重要**，但也有一些**命令的参数顺序根本不重要**。

例如，如果我使用`ls -lh`或者`ls -hl`在`mv`（移动/重命名文件）的情况下，您对最后两个参数的灵活性较低，即`mv [OPTIONS] SOURCE DESTINATION`.

为了掌握命令及其参数，您可以使用`man`（示例：）`man ls`或`info`（示例：）`info ls`。

在包括 C/C++ 在内的许多语言中，您有一种方法可以解析用户附加到可执行文件（命令）调用的命令行参数。还有许多可用于此任务的库，因为在其核心中，正确地完成它实际上并不容易，同时提供了大量的参数及其种类：

*   `getopt`
*   `argp_parse`
*   `gflags`
*   ...

每个 C/C++ 应用程序都有所谓的入口点，这基本上是您的代码开始的地方 -`main`函数：

```
int main (int argc, char *argv[]) { // When you launch your application the first line of code that is ran is this one - entry point
    // Some code here
    return 0; // Exit code of the application - exit point
} 
```

无论您是使用库（例如我提到的上述库之一；但这显然在您的情况下是不允许的；））还是自己执行，您的`main`函数都有两个参数：

*   `argc`- 表示参数的**数量**
*   `argv`- 指向字符串数组的指针（您也可以看到`char** argv`它基本相同但更难使用）。

**注意：** `main`实际上还有第三个参数`char *envp[]`，它允许将环境变量传递给你的命令，但这是一个更高级的东西，我真的不认为你的情况需要它。

命令行参数的处理由两部分组成：

1.  **标记**化-这是每个参数都有**意义**的部分。它是将参数列表分解为有意义的元素（令牌）的过程。在的情况下，`ls -l`不仅`l`是一个有效的字符，而且本身也是一个标记，因为它代表一个完整的、有效的参数。

这是一个示例，如何输出参数的数量和可能实际上是或可能不是参数的（未经检查的有效性）字符：

```
#include <iostream>
using std::cout;
using std::endl;

int main (int argc, char *argv[]) {
    cout << "Arguments' count=%d" << argc << endl;

    // First argument is ALWAYS the command itself
    cout << "Command: " << argv[0] << endl;

    // For additional arguments we start from argv[1] and continue (if any)
    for (int i = 1; i < argc; i++) {
        cout << "arg[" << i << "]: " << argv[i] << endl;
    }

    cout << endl;
    return 0;
} 
```

2.  **解析**- 获取令牌（参数及其值）后，您需要检查您的命令是否支持这些。例如：

    ```
    user@computer:~$ ls -y 
    ```

    将返回

    ```
    ls: invalid option -- 'y'
    Try 'ls --help' for more information. 
    ```

    这是因为解析失败。为什么？因为`y`(和`-y`_ `-`_ _ it) 是命令的未知参数。`--``:``ls`

对于每个参数（如果这样被成功识别），您会触发应用程序中的某种更改。您可以使用`if-else`例如检查某个参数是否有效以及它的作用，然后更改您希望该参数在执行其余代码时更改的任何内容。您可以采用旧的 C 风格或 C++ 风格：

```
* `if (strcmp(argv[1], "x") == 0) { ... }` - compare the pointer value
* `if (std::string(argv[1]) == "x") { ... }` - convert to string and then compare 
```

我实际上喜欢（当不使用库时）转换`argv`为这样`std::vector`的字符串：

```
std::vector<std::string> args(argv, argv+argc);
for (size_t i = 1; i < args.size(); ++i) {
    if (args[i] == "x") {
        // Handle x
    }
    else if (args[i] == "y") {
        // Handle y
    }
    // ...
} 
```

该`std::vector<std::string> args(argv, argv+argc);`部分只是处理字符串数组的一种更简单的 C++ 方式，因为`char *`它是一个 C 样式的字符串（`char *argv[]`作为此类字符串的数组），可以很容易地转换为 C++ 字符串，即`std::string`. 然后我们可以通过给出起始地址`argv`然后也指向它的最后一个地址来将所有转换的字符串添加到一个向量中`argv + argc`（我们将`argc`字符串的数量添加到它的基地址`argv`基本上指向我们数组的最后一个地址）。

在`for`上面的循环中，您可以看到我检查（使用 simple `if-else`）某个参数是否可用，如果是，则相应地处理它。**提醒一句：**通过使用这样的循环，参数的顺序**无关紧要**。正如我在开头提到的，一些命令实际上对它们的部分或全部参数有严格的顺序。您可以通过手动调用每个内容`args`（或者`argv`如果您使用初始`char* argv[]`而不是矢量解决方案）以不同的方式处理此问题：

```
// No for loop!
if (args[1] == "x") {
    // Handle x
}
else if (args[2] == "y") {
    // Handle y
}
// ... 
```

这样可以确保在位置上`1`只有`x`预期等。问题是您可以通过超出索引范围来射击自己的腿，因此您必须确保您的索引保持在设置的范围内`argc`：

```
if (argc > 1 && argc <= 3) {
    if (args[1] == "x") {
        // Handle x
    }
    else if (args[2] == "y") {
        // Handle y
    }
} 
```

上面的示例确保您在索引处有内容，`1`但`2`没有超出。

最后但并非最不重要的一点是，每个参数的处理完全取决于您。您可以使用在检测到某个参数时设置的布尔标志（例如：`if (args[i] == "x") { xFound = true; }`稍后在您的代码中根据`bool xFound`及其值执行某些操作），如果参数是数字或由数字和参数名称组成的数字类型（例如：`mycommand -x=4`有一个参数`-x=4`，您可以另外解析为`x`，`4`最后一个是 的值`x`）等。根据手头的任务，您可能会发疯并为您的命令行参数增加疯狂的复杂性。

希望这可以帮助。如果有不清楚的地方或者您需要更多示例，请告诉我。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-10-31T14:26:29.213

[`argstream`](http://artis.imag.fr/~Xavier.Decoret/resources/argstream/)非常类似于`boost.program_option`：它允许将变量绑定到选项等。但是它不处理存储在配置文件中的选项。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2009-05-14T20:50:00.533

如果您可以使用 Boost 库，我会推荐 boost::program_options。

在 STL 和常规的 C++/C 运行时库中没有什么特别的。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2010-05-03T10:54:27.567

试试 CLPP 库。它是用于命令行参数解析的简单灵活的库。仅标题和跨平台。仅使用 ISO C++ 和 Boost C++ 库。恕我直言，它比 Boost.Program_options 更容易。

图书馆：http: [//sourceforge.net/projects/clp-parser/](http://sourceforge.net/projects/clp-parser/)

2010 年 10 月 26 日 - 新版本 2.0rc。许多错误已修复，源代码、文档、示例和注释的完整重构已得到纠正。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2010-09-30T00:35:51.490

您可以为此使用已创建的库

[http://www.boost.org/doc/libs/1_44_0/doc/html/program_options.html](http://www.boost.org/doc/libs/1_44_0/doc/html/program_options.html)

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2009-09-17T03:19:19.767

[提升 program_options](http://www.boost.org/doc/libs/1_40_0/doc/html/program_options.html)。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2010-05-03T10:50:04.113

试试 CLPP 库。它是用于命令行参数解析的简单灵活的库。仅标题和跨平台。仅使用 ISO C++ 和 Boost C++ 库。恕我直言，它比 Boost.Program_options 更容易。

图书馆：http: [//sourceforge.net/projects/clp-parser](http://sourceforge.net/projects/clp-parser)

2010 年 10 月 26 日 - 新版本 2.0rc。许多错误已修复，源代码、文档、示例和注释的完整重构已得到纠正。

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2010-06-21T11:54:55.790

这是我最喜欢的命令行方式，尤其是，但绝对不仅仅是在效率成为问题时。这似乎有点矫枉过正，但我​​认为这种矫枉过正几乎没有缺点。

[使用 gperf 进行高效的 C/C++ 命令行处理](http://www.ibm.com/developerworks/linux/library/l-gperf.html)

缺点：

*   您必须首先运行一个单独的工具来生成 C/C++ 中哈希表的代码
*   不支持特定的命令行界面。例如，用一个破折号声明多个选项的 posix 速记系统“-xyz”很难实现。

好处：

*   您的命令行选项与您的 C++ 代码分开存储（在单独的配置文件中，不需要在运行时读取，只需在编译时读取）。
*   您在代码中所拥有的只是一个开关（打开枚举值）来确定您有哪个选项
*   效率为 O(n)，其中 n 是命令行上的选项数量，可能选项的数量无关紧要。最慢的部分可能是 switch 的实现（有时编译器倾向于像 else 块一样实现它们，从而降低了它们的效率，尽管如果您选择连续值，这不太可能，请参阅：[这篇关于 switch 效率的文章](http://www.embeddedgurus.com/stack-overflow/2010/04/efficient-c-tip-12-be-wary-of-switch-statements/)）
*   为存储关键字而分配的内存恰好足以容纳关键字集，并且不会更大。
*   也适用于 C

使用像 eclipse 这样的 IDE，您可能可以自动化运行 gperf 的过程，所以您唯一需要做的就是在配置文件和 switch 语句中添加一个选项，然后按 build...

我使用批处理文件来运行 gperf 并进行一些清理并使用 sed 添加包含防护（在 gperf 生成的 .hpp 文件上）...

因此，您的软件中的代码极其简洁和干净，并且您不需要手动更改一个自动生成的哈希表文件。我怀疑 boost::program_options 是否真的会击败它，即使没有效率作为优先事项。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2010-09-30T00:37:33.423

如果这是 linux/unix，那么使用的标准是 gnu getopt

[http://www.gnu.org/s/libc/manual/html_node/Getopt.html](http://www.gnu.org/s/libc/manual/html_node/Getopt.html)

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2011-04-20T19:31:45.317

我在一些项目中使用了 GetPot：http: [//getpot.sourceforge.net/](http://getpot.sourceforge.net/)

主要特点：一切都在一个头文件中，没有构建麻烦。只需将它保存在您机器上的某个位置，然后在您的文件中“#include”它`main()`

最近没有更新，但它有很好的文档记录，并且运行良好。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2014-01-14T10:52:57.133

你可以试试我的小**选项**头（166 loc 很容易破解）[options.hpp](https://github.com/burner/sweet.hpp/blob/master/options.hpp)。它是一个单头实现，应该按照您的要求进行。它还会自动打印帮助页面。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2016-09-15T08:57:23.710

根据我的评论和 rbaleksandar 的回答，传递给 C 中任何程序的参数都是字符串值。为您提供*参数 count* ( )，它为您提供*从零开始*`argc`的参数索引，以当前正在运行的程序的名称（始终为）开头。这将所有参数保留为用户为您的程序提供的参数。每个都将是一个包含在*参数向量*中的字符串（它是一个*指向字符串数组的指针，*您将看到写成，或等效地作为函数参数）每个字符串都可供您使用，您只需要测试哪个参数是哪个。*`argv[0]``1 - argc`**`char *argv[]``char **argv``argv[1]``argv[argc-1]`***

 ***这将允许您将它们分开，并将它们作为*命令*( `cmd`)、*选项*( `opt`) 以及最后的*参数*( `arg`) 提供给您的`cmd`.

现在值得注意的是，shell 的规则（bash 等）适用于传递给程序的参数，*分词*、*路径名*和*变量扩展*在代码获取参数之前应用。因此，您必须考虑是否需要在您的任何参数周围使用*单*引号或更常见*的双引号*，以防止正常的 shell 拆分，否则将适用（例如`ls -al my file.txt`，会导致`4`用户为您的代码提供参数，而`ls -al "my file.txt"`或`ls -al my\ file.txt`会导致`3`你的期待。

把所有这些放在一起，你的一小段解析可以像下面这样完成。（您也可以随意使用 a`switch`而不是嵌套`if`的 s 等...）

```
#include <stdio.h>

int main (int argc, char **argv) {

    char *cmd = NULL,   /* here, since you are using the arguments  */
         *opt = NULL,   /* themselves, you can simply use a pointer */
         *arg = NULL;   /* or the argument itself without a copy    */

    /* looping using the acutal argument index & vector */
    for (int i = 1; i < argc; i++) {
        if (*argv[i] != '-') {      /* checking if the 1st char is - */
            if (!cmd)               /* cmd is currently NULL, and    */
                cmd = argv[i];      /* no '-' it's going to be cmd   */
            else                    /* otherwise, cmd has value, so  */
                arg = argv[i];       /* the value will be opt        */
        }
        else                /* here the value has a leading '-', so  */
            opt = argv[i];  /* it will be the option */
    }

    printf ("\n cmd : %s\n opt : %s\n arg : %s\n\n",
            cmd, opt, arg);

    return 0;
} 
```

**示例使用/输出**

如果你运行代码，你会发现它为参数提供了分隔，并提供了单独的指针以方便它们的使用：

```
$ ./bin/parse_cmd ls -la ./cs3000

 cmd : ls
 opt : -la
 arg : ./cs3000 
```

（重要的是要注意，如果您的任务是构建一个命令字符串，您需要将多个值复制到say`opt`或`arg`数组而不是开始的指针，或者您可以根据需要动态分配存储空间，例如`malloc`，`calloc`和/或`realloc`。然后您将拥有可用于复制和连接值的存储空间。）

如果这是您的挑战，那么在此处的所有答案之间，您应该掌握如何解决您的问题。如果您必须走得更远，并且实际上让您的程序`cmd`使用`opt`和执行`arg`，那么您将需要查看`fork`生成一个半独立的进程，在该进程中您将执行您的`cmd` `opt`和`arg`类似于`execv`or的东西`execvp`。祝你好运，如果您还有其他问题，请发表评论。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2018-04-03T04:23:08.447

它有点太大，无法包含在 Stack Overflow 答案中，但我创建了一个用于以声明方式定义命令行的库。它利用 C++14 的能力通过为每个成员变量赋予初始值来构建类构造函数。

该库主要是一个基类。要定义您的命令语法，您需要声明一个派生自它的结构。这是一个示例：

```
struct MyCommandLine : public core::CommandLine {
    Argument<std::string> m_verb{this, "program", "program.exe",
        "this is what my program does"};
    Option<bool> m_help{this, "help", false,
        "displays information about the command line"};
    Alias<bool> alias_help{this, '?', &m_help};
    Option<bool> m_demo{this, "demo", false,
        "runs my program in demonstration mode"};
    Option<bool> m_maximize{this, "maximize", false,
        "opens the main window maximized"};
    Option<int> m_loops{this, "loops", 1,
        "specifies the number of times to repeat"};
    EnumOption<int> m_size{this, "size", 3,
                           { {"s", 1},
                             {"small", 1},
                             {"m", 3},
                             {"med", 3},
                             {"medium", 3},
                             {"l", 5},
                             {"large", 5} } };
    BeginOptionalArguments here{this};
    Argument<std::string> m_file{this, "file-name", "",
        "name of an existing file to open"};
} cl; 
```

、和类模板在基类的范围内声明`Argument`，您可以将它们专门用于您自己的类型。每个都带有指针、选项名称、默认值和用于打印命令概要/用法的描述。`Option``Alias``CommandLine``this`

我仍然希望消除在其中撒上所有`this`指针的需要，但我还没有找到不引入宏的方法。这些指针允许每个成员向驱动解析的基类中的表注册自己。

一旦你有了一个实例，就会有几个方法重载来解析来自字符串或`main`-style 参数向量的输入。解析器处理 Windows 风格和 Unix 风格的选项语法。

```
if (!cl.Parse(argc, argv)) {
    std::string message;
    for (const auto &error : cl.GetErrors()) {
        message += error + "\n";
    }
    std::cerr << message;
    exit(EXIT_FAILURE);
} 
```

解析后，您可以使用以下命令访问任何选项的值`operator()`：

```
if (cl.m_help()) { std::cout << cl.GetUsage(); }
for (int i = 0; i < cl.m_loops(); ++i) { ... } 
```

整个库只有大约 300 行（不包括测试）。实例有点臃肿，因为解析表是实例的一部分（而不是类）。但是通常每个程序只需要一个实例，这种纯声明式方法的便利性非常强大，只需解析新输入即可重置实例。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2009-01-14T06:47:12.260

如果你不想使用 boost，我推荐[这个](http://www.codeproject.com/KB/cpp/cmdlineparser.aspx)小助手类。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2010-10-27T04:04:21.823

试试 CLPP 库。它是用于命令行参数解析的简单灵活的库。仅标题和跨平台。仅使用 ISO C++ 和 Boost C++ 库。恕我直言，它比 Boost.Program_options 更容易。

图书馆：http: [//sourceforge.net/projects/clp-parser](http://sourceforge.net/projects/clp-parser)

2010 年 10 月 26 日 - 新版本 2.0rc。许多错误已修复，源代码、文档、示例和注释的完整重构已得到纠正。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2016-09-15T07:09:44.760

你的 C/C++ 程序总是有一个 main 函数。它看起来像这样：

```
 int main(int argc, char**argv) {
        ...
    } 
```

这里 argc 是一些命令行参数，它们已经传递给你的程序，而 argv 是一个包含这些参数的字符串数组。所以命令行被调用者进程分隔成参数（这不是一行，就像在 Windows 中一样）。

现在你需要整理它们：

*   命令名称始终是第一个参数（索引 0）。
*   选项只是指定程序应该如何工作的特殊参数。按照惯例，它们从 - 符号开始。通常 - 一个字母选项和 - 任何更长的时间。所以在你的任务中，“选项”都是参数，从 - 开始，而不是第 0 个。
*   论据。只是所有其他不是程序名称或选项的参数。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2017-12-12T11:32:24.577

我在 windows/mingw 下使用 getopt() ：

```
while ((c = getopt(myargc, myargv, "vp:d:rcx")) != -1) {
        switch (c) {
        case 'v': // print version
            printf("%s Version %s\n", myargv[0], VERSION);
            exit(0);
            break;
        case 'p': // change local port to listen to
            strncpy(g_portnum, optarg, 10);
            break;
... 
```

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2021-02-10T23:14:23.553

一个简单的解决方案是放入`argv`一个`std::map`简单的查找：

```
map<string, string> argvToMap(int argc, char * argv[])
{
    map<string, string> args;

    for(int i=1; i<argc; i++) {
        if (argv[i][0] == '-') {
            const string key = argv[i];
            string value = "";
            if (i+1 < argc && argv[i+1][0] != '-') {
                value = string(argv[i+1]);
                i++;
            }

            args[key] = value;
        }
    }

    return args;
} 
```

示例用法：

```
#include <map>
#include <string>
#include <iostream>

using namespace std;

map<string, string> argvToMap(int argc, char * argv[])
{
    map<string, string> args;

    for(int i=1; i<argc; i++) {
        if (argv[i][0] == '-') {
            const string key = argv[i];
            string value = "";
            if (i+1 < argc && argv[i+1][0] != '-') {
                value = string(argv[i+1]);
                i++;
            }

            args[key] = value;
        }
    }

    return args;
}

void printUsage()
{
    cout << "simple_args: A sample program for simple arg parsing\n"
            "\n"
            "Example usage:\n"
            "    ./simple_args --print-all --option 1 --flag 2\n";
}

int main(int argc, char * argv[])
{
    auto args = argvToMap(argc, argv);

    if (args.count("-h") || args.count("--help")) {
        printUsage();
    }
    else if (args.count("--print-all")) {
        for (auto const & pair: args)
            cout << "{" << pair.first << ": " << pair.second << "}\n";
    }

    return 0;
} 
```

输出：

```
$ ./simple_args --print-all --option 1 --flag "hello world"
{--flag: hello world}
{--option: 1}
{--print-all: } 
```

这种方法肯定有很大的局限性，但我发现它在简单性和实用性之间取得了很好的平衡。

# bash - 在 bash 中用“时间”计时并发进程

> ID：865680
> 
> 赞同：2
> 
> 时间：2009-05-14T20:48:56.590
> 
> 标签：bash, time, concurrency

有没有一种简单的方法可以做到这一点，但同时运行这两个进程`bash`？

```
$ time sleep 5; sleep 8 
```

`time`应该报告总共 8 秒（或最长任务的时间量）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T15:47:21.063

```
$ time (sleep 5 & sleep 8 & wait)

real    0m8.019s
user    0m0.005s
sys     0m0.005s 
```

没有任何参数，shell 内置`wait`等待所有后台作业完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:53:19.527

```
time sleep 8 & time sleep 5 
```

操作员使第`&`一个命令在后台运行，这实际上意味着两个命令将同时运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T20:53:57.263

以睡眠为例。

如果您只想计时第一个过程，那么

```
time sleep 10 & sleep 20 
```

如果你想为这两个过程计时，那么

```
time (sleep 10 & sleep 20) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T21:07:02.740

抱歉，我的问题第一次可能不太清楚，但我想我已经找到了答案，这要感谢这里给出的一些指导。

```
time sleep 5& time sleep 8 
```

将在两个进程同时运行时对它们进行计时，然后我将采用更大的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-19T11:41:21.307

如果你安装了 GNU Parallel [http://www.gnu.org/software/parallel/](http://www.gnu.org/software/parallel/)你可以这样做：

```
time parallel sleep ::: 5 8 
```

您可以通过以下方式安装 GNU Parallel：

```
wget http://git.savannah.gnu.org/cgit/parallel.git/plain/src/parallel
chmod 755 parallel
cp parallel sem 
```

观看 GNU Parallel 的介绍视频以了解更多信息： [https ://www.youtube.com/playlist?list=PL284C9FF2488BC6D1](https://www.youtube.com/playlist?list=PL284C9FF2488BC6D1)

# netbeans - 在 MBP 上的 NetBeans 中编写完整的键盘快捷键

> ID：865681
> 
> 赞同：1
> 
> 时间：2009-05-14T20:49:11.160
> 
> 标签：netbeans, keyboard-shortcuts

刚得到一个 MBP，我无法弄清楚代码完成的快捷方式。它说`^`+`space`但`^`字符是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T20:50:41.030

这通常代表 Ctrl。`^M`表示 Ctrl-M 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T01:25:54.113

^ 确实是控制键。但是在我的 MBP 上，您可以通过按 +\（命令+反斜杠）打开代码完成窗口。

# visual-c++ - Visual Studio 2005 标准版中的 OpenMP

> ID：865686
> 
> 赞同：4
> 
> 时间：2009-05-14T20:49:36.510
> 
> 标签：visual-c++, visual-studio-2005, openmp

我使用 OpenMP 和 gcc 来编写并行代码。我现在使用 Visual C++ 2005 并试图弄清楚如何使用 OpenMP。Properties->C/C++/Language 菜单中有一个编译器选项，但它抱怨缺少库。是否有 OpenMP 的第 3 方实现，或者我只是错误地配置了 Visual C++？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T17:52:03.407

经过一些研究，我发现 OpenMP 库和 dll 不包含在 Visual C++ 2005 或 Visual C++ Express Edition 2008 中。但是通过一些变通方法，您可以使其正常工作。

首先，您需要从 microsoft 下载 lib 文件，这些文件可以在 [Windows SDK for Windows Server 2008 和 .NET framework 3.5](http://www.microsoft.com/downloads/details.aspx?FamilyId=E6E1C3DF-A74F-4207-8586-711EBE331CDC&displaylang=en)中找到。下载后，您需要确保 vcomp.lib 或 vcompd.lib 已链接到您的程序。

接下来，您需要拥有可以在[Visual C++ Redistributable Packkage](http://www.microsoft.com/downloads/details.aspx?familyid=9B2DA534-3E03-4391-8A4D-074B9F2BC1BF&displaylang=en)中找到的 dll 。然后确保 vcomp90.dll 在您的路径中的某个位置。

您还需要启用 OpenMP 编译器选项，该选项可在 Visual C++ 的 Properties->C/C++/Language 菜单中找到。

之后，您应该可以正常使用 OpenMP。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-15T14:10:17.053

我认为 VC 2005 开箱即用，但我不确定它们是否随所有版本一起提供。

如果你只是附上

```
/openmp 
```

选项您还必须包含打开的 mp 标头

```
#include <omp.h> 
```

这很重要，因为此标头会将清单添加到您的应用程序中，从而使其能够从正确的系统路径加载 vcomp.dll。因此，通常不再允许在可执行文件下复制 vcomp.dll 或其他系统 dll，但您必须拉动应用程序的清单以从正确的位置加载 dll。omp.h 标头不会自动执行此操作。

因此，如果您不想自己修改清单，最少的代码是：

```
#include <omp.h> // has to include this header to build the correct manifest to find vcom.dll or vcompd.dll

int main(int argc, char* argv[])
{
  double sum;
#pragma omp parallel for
  for(int i = 0; i < 10000; ++i) {

  }
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T20:52:39.387

您需要添加：

```
/openmp 
```

到您的编译器选项。

更多信息可在[MSDN上找到](http://msdn.microsoft.com/en-us/library/fw509c3b(VS.80).aspx)

# c++ - 用于单元测试的“Echo”设备

> ID：865689
> 
> 赞同：4
> 
> 时间：2009-05-14T20:49:57.787
> 
> 标签：c++, linux, unit-testing, linux-device-driver, cppunit

我目前正在为测试硬件通信端口的程序编写一些 CPPunit 测试（是的，我正在为测试应用程序编写单元测试；-)）。我正在测试的一个类基本上是设备文件描述符的包装器；我对文件描述符进行调用 `read()`。**Linux 上是否有设备文件/驱动程序，如果您****访问它，当您****从中读取时，您会读回您写的内容（如 FIFO 队列设备）？** 如果我有这个设备文件，那么在我的包装器中替换实际的设备文件会非常简单，并且可以很容易地模拟现实世界硬件上可能发生的“环回”场景。`write()`**`write()``read()`**

* * *

本质上，我正在寻找的是一种假设的`"/dev/echo"`设备。

例如：设备的行为如下：

```
open("/dev/echo", O_RDRW);

write(fdEcho, 123, sizeof(int));
write(fdEcho, 456, sizeof(int));
write(fdEcho, 789, sizeof(int));

read(fdEcho, iData,  sizeof(int);  // returns 123
read(fdEcho, iData2, sizeof(int);  // returns 456
read(fdEcho, iData3, sizeof(int);  // returns 789 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T21:01:46.650

为什么不在文件系统中使用 UNIX 管道？

```
mkfifo /dev/test
echo test > /dev/test 
```

在第二个终端上：

```
cat /dev/test 
```

然后第一个将解锁，第二个将显示文本！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T21:02:46.430

你可以用

```
mknod /dev/echo p 
```

第一个参数是文件名（它可以是任何文件名，不必是 in `/dev`），第二个参数是`p`“管道”。

参考：[http ://www.unix.com/unix-dummies-questions-answers/22205-unix-pipe.html](http://www.unix.com/unix-dummies-questions-answers/22205-unix-pipe.html)

您还可以查看`pipe()`C 函数： http: [//www.manpagez.com/man/2/pipe/](http://www.manpagez.com/man/2/pipe/)

# asp.net - 在 IE 7 或 FF 3 中未触发 html 表单的 onkeydown 事件

> ID：865693
> 
> 赞同：0
> 
> 时间：2009-05-14T20:50:02.420
> 
> 标签：asp.net, javascript, html

我正在编写一个 asp.net 应用程序，并有一个表单，用户必须按下一个键才能看到一个文本框，以便他/她可以登录。当按键被按下时，我想要一个标签消失并且一个文本框变得可见。出于某种原因，“onkeydown”事件在 FF 或 IE 中没有触发，但在 Chrome 中可以正常工作。该应用程序将使用 Links 浏览器在 AML 终端上运行，但我现在无法在该平台上进行测试。这是我的代码：

```
<form id="form1" runat="server" onkeydown="CheckKey(event.keyCode)" 
enableviewstate="True" submitdisabledcontrols="False" visible="True">

<script type="text/javascript">

    function SetVisibility() {
        var txtbx = document.getElementById("txtbx_login")
        txtbx.style.display = "none";
        var form = document.getElementById("form1")
    }

    function CheckKey(keycode) {
        if (keycode == 113) {
            var txtbx = document.getElementById("txtbx_login")
            txtbx.style.display = "";
            var lbl = document.getElementById("lbl_login")
            lbl.style.display = "none";
        }
    }

</script> 
```

******其他表单元素******

```
</form> 
```

能够使 onkeydown 事件起作用的唯一方法是文本框控件是否正在显示并具有焦点。我错过了什么吗？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T21:00:02.957

我认为问题在于对表单进行了 onkeydown 检查。

尝试将其移动到 body 元素，或者更好的是，使用 javascript 将事件处理程序添加到窗口事件：

```
function handleKeypress(e){

       var keycode = e.keyCode || e.charCode;

       if (keycode == 113) {
            var txtbx = document.getElementById("txtbx_login")
            txtbx.style.display = "";
            var lbl = document.getElementById("lbl_login")
            lbl.style.display = "none";
        }

    }
    window.onkeypress = handleKeypress; 
```

在 Firefox 中，您还需要使用 event.charCode。我没有在所有浏览器中测试上述内容，但这是一个开始。

# browser - 调整浏览器大小时模块中的组件消失（Flex 3）

> ID：865702
> 
> 赞同：0
> 
> 时间：2009-05-14T20:51:27.363
> 
> 标签：browser, flex3, module, resize

我们在 Builder 3 上构建了这个 Flex 应用程序，并且我们使用来自 FlexLib 的 SuperTabNavigator 来显示一些模块。问题是，每当用户调整浏览器窗口的大小时，打开的任何选项卡上的所有内容都会消失，并且无法恢复。这只是第一次发生，所以如果你关闭这些“损坏”的标签并重新打开它们，你可以调整你想要的一切，但你仍然失去了你在其中所做的一切，这是不可接受的。我做了一些测试，发现该选项卡中的模块在发生这种情况时不会调度调整大小事件。它在打开时调度（一切都设置为 100% 以适应浏览器窗口，因此它在启动时调整大小），并且每隔一次你调整它的大小而不“破坏”它。它变得更奇怪了。我' 我们还发现，只要将其大小调整为大于原始大小（即，您在恢复然后最大化的浏览器窗口中打开它），调整大小就可以完美地工作，但即使在这样做之后，如果您将其大小更改回甚至比原始像素小一个像素，模块就消失了。其他一切都保持在完美的工作状态：选项卡之外的任何组件和选项卡本身都可以工作，但是（总结）在您第一次将浏览器窗口调整为小于原始大小时打开的任何选项卡中的任何内容都会消失。

我知道这是一个奇怪的问题，希望你们中的一些人能够帮助我。如果有任何不清楚的地方，请随时提出任何问题。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-18T19:02:19.327

我的应用程序遇到了同样的问题。问题源于当窗口大小小于其原始大小时触发 RemovedFromStage 事件。我正在捕获 RemovedFromStage 事件并隐藏我的组件，这导致了这种行为。更详细的解释可以在[这里](http://jonathanbranam.net/flex3anatomy/class/Container/contentPane)找到。

# process - 如何缩短 inittab 进程条目，也就是将 init 可以看到的环境变量放在哪里？

> ID：865706
> 
> 赞同：0
> 
> 时间：2009-05-14T20:52:04.007
> 
> 标签：process, environment-variables, debian, sysadmin

我正在设置一个 Debian Etch 服务器来使用 nginx 托管 ruby​​ 和 php 应用程序。我已成功配置 inittab 以在启动时使用 respawn 操作启动 php-cgi 进程。在服务 1000 个请求后，php-cgi 工作进程死亡并由 init 重新生成。inittab 记录如下所示：

```
50:23:respawn:/usr/local/bin/spawn-fcgi -n -a 127.0.0.1 -p 8000 -C 3 -u someuser -- /usr/bin/php-cgi 
```

我最初将进程条目（第三个冒号之后的所有内容）写在一个单独的脚本中（只是因为它很长）并将该脚本名称放在 inittab 记录中，但由于脚本将运行它的单行并死掉，系统日志被填充有这样的错误：

```
May  7 20:20:50 sb init: Id "50" respawning too fast: disabled for 5 minutes 
```

因此，我摆脱了脚本文件，只是将整行放在 inittab 中。从此以后，系统日志中不会出现任何错误。

现在我正在尝试使用[Thin](http://code.macournoyer.com/thin/)来服务 Rails 应用程序。我可以通过运行以下命令成功启动瘦服务器：

```
sudo thin -a 127.0.0.1 -e production -l /var/log/thin/thin.log -P /var/run/thin/thin.pid -c /path/to/rails/app -p 8010 -u someuser -g somegroup -s 2 -d start 
```

无论我是否使用 -d （守护进程）标志，它的工作原理显然完全相同。无论哪种方式，命令行控制都会立即返回（进程已被守护）。如果我将整个命令（减去 sudo 和绝对路径）放入 inittab，init 会抱怨（在 syslog 中）进程条目太长，因此我将选项放入 /etc/profile 中的导出环境变量中。现在我可以通过以下方式成功启动服务器：

```
sudo thin $THIN_OPTIONS start 
```

但是当我用 respawn 动作把它放在一个 inittab 记录中时

```
51:23:respawn:/usr/local/bin/thin $THIN_OPTIONS start 
```

日志清楚地表明环境变量对 init 不可见；就好像该命令只是“薄启动”。

**如何缩短 inittab 进程条目？** 除了 /etc/profile 之外，还有其他文件可以设置 THIN_OPTIONS 环境变量吗？我早期使用 php-cgi 的经验告诉我，我不能将整个命令放在单独的脚本中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T13:37:24.980

你为什么不打电话给一个从你的选择开始变薄的包装商呢？

*start_thin.sh:*
#!/bin/bash
/usr/local/bin/thin -a 127.0.0.1 -e production -l /var/log/thin/thin.log -P /var/run/thin/thin.pid -c /path/to/rails/app -p 8010 -u someuser -g somegroup -s 2 -d start

然后：
51:23:respawn:/usr/local/bin/start_thin

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:32:51.507

**init.d 脚本**

在中使用脚本

```
/etc/rc.d/init.d 
```

并设置运行级别

下面是一些关于**瘦、红宝石、阿帕奇的例子**

[http://articles.slicehost.com/2009/4/17/centos-apache-rails-and-thin](http://articles.slicehost.com/2009/4/17/centos-apache-rails-and-thin)

[http://blog.fiveruns.com/2008/9/24/rails-automation-at-slicehost](http://blog.fiveruns.com/2008/9/24/rails-automation-at-slicehost)

[http://elwoodicious.com/2008/07/15/nginx-haproxy-thin-fastcgi-php5-load-balanced-rails-with-php-support/](http://elwoodicious.com/2008/07/15/nginx-haproxy-thin-fastcgi-php5-load-balanced-rails-with-php-support/)

其中提供了要使用的示例初始化脚本。

**编辑**：Asker 指出这将不允许重生。我建议在 init 脚本中分叉并取消进程，以便 init 不会挂起（它可能会 fork() 脚本本身，将检查）。然后创建一个无限循环，等待服务器进程死亡并重新启动它。

**edit2**：似乎 init 会分叉脚本。只需一个循环即可。

# css - CSS 继承

> ID：865711
> 
> 赞同：1
> 
> 时间：2009-05-14T20:53:37.950
> 
> 标签：css

```
 .x-panel-myheader{overflow:hidden;zoom:1;color:#15428b;font:bold 11px tahoma,arial,verdana,sans-serif;padding:5px 3px 4px 3px; border:1px solid #99bbe8;line-height:5px;background: transparent url(../images/default/panel/white-top-bottom.gif) repeat-x 0 -1px;}
.x-panel-myheader .x-panel-body { background-color: Transparent;  }
.x-panel-myheader .x-toolbar { background-color:inherit; border:0px ;}

`
<div class="x-panel x-panel-myheader x-border-panel x-panel-noborder" id="pnlHeader" style="width: 608px; top: 0px; left: 0px;">
  <div class="x-panel-bwrap" id="ext-gen62">
     <div class="x-panel-body x-panel-body-noheader x-panel-body-noborder" id="ext-gen63" style="width: 608px; height: 39px;">
        <div class="x-toolbar x-small-editor x-abs-layout-item" id="tbarTest" style="top: 17px; left: 5px;"> 
```

`

CSS继承是如何工作的？我想对 div class="x-toolbar " 应用不同的 CSS 不知道如何访问它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T21:04:40.653

问题似乎是 CSS 规则被定义为适用于：

```
.x-panel-myheader .x-toolbar 
```

这意味着它将适用于任何具有“x-toolbar”类的东西，但**前提**是它包含在具有“x-panel-myheader”类的其他东西中。

您的 HTML 没有显示任何带有“x-panel-myheader”类的内容，因此我无法确定这是否是导致您的问题的原因。如果 CSS 规则似乎根本不起作用，那可能就是原因。如果您只想将其应用于具有“x-toolbar”类的所有内容，请将行更改为：

```
.x-toolbar { background-color:inherit; border:0px ;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T21:00:10.120

简单地说，规则说后面的 CSS 声明会覆盖前面的声明。并且“样式”属性总是覆盖“类”属性。

如果覆盖级联多个元素的类（.x-panel-myheader .x-toolbar），则需要在覆盖时包含完整的“路径”。在您的示例中，它将是：

```
.x-panel-myheader .x-toolbar {
    /* new styles here */
} 
```

但是，如果您想覆盖在“样式”属性中声明的内容，那么您可以附加 !important 标志，或者您必须编辑样式本身：

```
.x-panel-myheader .x-toolbar {
    /* new styles here */
    background-color: #000 !important;
} 
```

更新：看起来您使用 x-panel-myheader 属性编辑了 div 元素，因此我的示例不一定适用于新代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T20:59:35.580

将不同样式应用于 x-toolbar 的唯一方法是在之前的定义之后注入样式。这样您就可以覆盖以前的定义。

如果您可以控制源，则可以添加不同名称的样式，然后将其放在每个元素的类列表中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T21:00:22.100

`-myheader`你的 CSS 中的 来自哪里？您的 HTML 中没有`x-panel-myheader`任何地方。

# jquery - Ajax 查询未触发，因为它生成了错误的 URL

> ID：865715
> 
> 赞同：0
> 
> 时间：2009-05-14T20:54:04.937
> 
> 标签：jquery, asp.net-mvc, vb.net, ajax, model-view-controller

以下代码在第一个下拉列表更改时填充第二个下拉列表（即级联下拉列表）。但是，Ajax 调用没有触发，我不知道为什么。我没有收到任何语法或运行时错误。在调试模式下，永远不会调用 GetPlans 操作。永远不会调用内部警报，但会调用外部警报。更糟糕的是，同样的设置在我的应用程序的其他地方也可以使用！这是所有相关的部分（如果我遗漏了一些重要细节，请告诉我）：

“报告/授权”视图：

```
<script type="text/javascript" src="../../Scripts/jquery-1.3.2.min.js"></script>

<script type="text/javascript" src="../../Scripts/MicrosoftAjax.js"></script>

<script type="text/javascript">

    $(function() {
        $("#year").change(function() {

            var year = $("#year > option:selected").attr("value");
            var rid = $("#rid").attr("value");

            $.ajax({
                type: "GET",
                contentType: "application/json; charset=utf-8",
                url: "GetPlans/" + rid + "/" + year,
                data: "{}",
                dataType: "json",
                success: function(data) {
                    alert('inside');
                    if (data.length > 0) {
                        var options = '';
                        for (p in data) {
                            var plan = data[p];
                            options += "<option>" + plan + "</option>";
                        }
                        $("#plan").html(options);

                    } else {
                        $("#plan").html('');
                    }
                }
            });

            alert("outer");
        });
    });

</script>

<% Using Html.BeginForm()%>
<%=Html.Hidden("rid")%>
Year:
<%=Html.DropDownList("year", Model.Years)%>
Plan:
<%=Html.DropDownList("plan")%>
<% End Using%> 
```

报告控制器：

```
Function Auth(ByVal rid As Integer) As ActionResult

    ViewData("plan") = New SelectList(New List(Of SelectListItem))
    Return View(New Auth)

End Function

Public Function GetPlansByYear(ByVal rid As Integer, ByVal year As Integer) As JsonResult

    Dim plans = _
        (From bp In BenefitDataContext.GetContext.BenefitPlans _
         Where bp.Benefit.repository_id = rid _
         And bp.Benefit.plan_year_val = year _
         Select bp.MphcPlan).Distinct

    Return New JsonResult _
        With {.Data = _
                From p In plans _
                Select New SelectListItem _
                    With {.Text = p.plan_code & " - " & p.plan_desc, _
                          .Value = p.plan_id}}

End Function 
```

认证类：

```
Public Class Auth

    Private _years As SelectList
    Public Property Years() As SelectList
        Get
            Return _years
        End Get
        Set(ByVal value As SelectList)
            _years = value
        End Set
    End Property

    Public Sub New()

        Dim disinctYears = _
            (From b In BenefitDataContext.GetContext.Benefits _
             Where b.repository_id = 1 _
             Select b.plan_year_val).Distinct

        Dim yearList = _
            From y In disinctYears _
            Order By y _
            Select New SelectListItem _
                With {.Text = y, _
                      .Value = y, _
                      .Selected = (y = Now.Year)}

        Years = New SelectList(yearList, "Value", "Text")

End Sub 
```

Global.asax - 注册路线：

```
routes.MapRoute( _
    "AuthReportGetPlans", _
    "GetPlans/{rid}/{year}", _
    New With {.controller = "Report", .action = "GetPlansByYear", .rid = "", .year = ""} _
) 
```

关于如何弄清楚发生了什么的任何想法？

**更新：**通过检查 Ajax 调用的错误输出发现了问题，所以现在我知道了问题的原因：URL 被附加到当前路径而不是从路由中调用，即 /Reports/Auth/GetPlans/ 1/2009 而不是 /GetPlans/1/2009。这很令人困惑，因为它似乎在 global.asax 中正确设置以映射到我设置的路线，并且如前所述，我在另一个视图中进行了设置，并且在那里工作正常。关于为什么 Ajax 调用指定错误路径的任何输入？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T21:04:35.647

尝试捕获 .ajax 调用的错误事件，看看它是否告诉你任何额外的信息

```
$.ajax({
    type: "GET",
    contentType: "application/json; charset=utf-8",
    url: "GetPlans/" + rid + "/" + year,
    data: "{}",
    dataType: "json",
    success: function(data) {
        alert('inside');
        if (data.length > 0) {
            var options = '';
            for (p in data) {
                var plan = data[p];
                options += "<option>" + plan + "</option>";
            }
            $("#plan").html(options);
        } else {
            $("#plan").html('');
        }
    },
    error: function(xhr){
        alert('something is b0rked')
        // take a look at xhr.status and xhr.responseText
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T21:18:03.103

它根本没有点击 URL 吗？也许你应该让你的 URL 是绝对的：

```
url: "/GetPlans/" + rid + "/" + year 
```

还可以尝试将操作绑定到 $(document).ready() 而不是立即绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T09:52:07.750

检查以确保 MicrosoftAjax.js 没有将 $ 用于它自己的目的。

[如果是，您可以在此页面](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)上找到有关如何使用 $ 以外的其他内容的信息

例如：

```
var $jQuery = jQuery.noConflict();

$jQuery(function() {
    $jQuery("#year").change(function() {

        var year = $jQuery("#year > option:selected").attr("value");
        var rid = $jQuery("#rid").attr("value");

        $jQuery.ajax({ ... 
```

...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T09:59:10.060

愚蠢的问题......你确定你的脚本路径是正确的吗？我不得不做一些修改以确保我在正确的位置（请参阅[此线程](https://stackoverflow.com/questions/840302/asp-net-mvc-and-jquery-routes-and-script-locations)）

我不是一个庞大的 jQuery 用户（我知道的很少，因此很危险），我很想通过坚持来确保

```
alert('Yep, I'm running'); 
```

在你的功能的某个地方。

**编辑**

我指出的线程并没有专门解决路径问题。Basicvally 我有一个名为 GetRootPath 的辅助方法，它返回站点的根目录，我调用 jQuery 文件如下

```
<script src="<%= Html.GetBasePath() %>Scripts/jQuery.js" type="text/javascript"></script> 
```

对困惑感到抱歉

现在，我将尝试教我的祖母吸鸡蛋。;)

# asp.net - Web 部署项目 - 远程 IIS 服务器

> ID：865716
> 
> 赞同：2
> 
> 时间：2009-05-14T20:54:15.453
> 
> 标签：asp.net, iis, deployment, msbuild, web-deployment-project

# 背景

本着持续集成的精神，我正在尝试使用 Web 部署项目来自动化我们的部署过程。大多数情况下，这是无痛的。大多数选项都内置了，而那些不容易通过 MSBuild XML 界面添加的选项。

但是，我似乎找不到部署到远程 IIS 服务器的选项。这对我来说似乎很奇怪，因为我显然不希望我的所有构建都在我的生产/登台服务器上运行。

# 问题

如何设置我的 Web 部署项目以在远程计算机上创建/覆盖 IIS 虚拟目录？

# 笔记

我正在使用`Visual Studio 2008`和`.net 3.0`。

# [编辑]

正如下面[x0n](https://stackoverflow.com/users/6920/x0n)所建议的，我可以为此使用 MS Deploy。不过，我宁愿使用 Web 部署项目，特别是因为我们已经设置了这些项目。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T20:59:49.387

最好的办法是查看 MS Deploy，它现在在 RC 级别作为独立包提供。它附带一个 Go-Live 许可证，这意味着它将与 Visual Studio 2010 附带的版本兼容。一些信息：

[http://blogs.iis.net/msdeploy/default.aspx](http://blogs.iis.net/msdeploy/default.aspx)

这是一个很棒的工具——将同步远程服务器、农场等，以获取丢失的元数据库信息、com 对象、注册表、bin 或 gac 中的 .net 组件、数据库——整个过程。它还附带一个交互式 shell 和 powershell cmdlet。

-Oisin

# user-interface - 如何使滑块标签可点击 [Flex 3]

> ID：865719
> 
> 赞同：1
> 
> 时间：2009-05-14T20:55:11.380
> 
> 标签：user-interface, button, label, slider, flex3

我有一个简单的滑块，只有 3 个选项。强迫用户拖动滑块上的小缩略图似乎很奇怪，而单击滑块旁边的 3 个实际标签之一会容易得多。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:05:53.053

这是一个很酷的问题。

Slider 使用的 Label 对象原来是 Label 的子类（称为 SliderLabel）。因此，最好的方法可能是继承 Slider 并将事件侦听器添加到标签。

我认为您可以在 commitProperties 方法或 updateDisplayList 方法中成功添加事件侦听器。我不确定一个是否比另一个更可取，但 commitProperties 似乎是*更*正确的选择。

因此，在您的 Slider 子类中：

```
override protected function commitProperties():void
{
    super.commitProperties();

    for(var i:int = 0; i < labelObjects.numChildren; i++)
    {
        if(!SliderLabel(labelObjects.getChildAt(i)).hasEventListener(MouseEvent.CLICK))
        {
            SliderLabel(labelObjects.getChildAt(i)).addEventListener(MouseEvent.CLICK,sliderLabelClickListener);
        }
    }
} 
```

然后可能是这样的`sliderLabelClickListener`：

```
private function sliderLabelClickListener(e:MouseEvent):void
{
    dispatchEvent( new SliderLabelClickEvent(e.target) );
} 
```

我认为您希望在那里有一个自定义事件，而不是发送一个常规事件`Event`，因此您可以包含标签的名称/ID/值。

此外，当从舞台上移除 Slider 时，您可能希望放入一个“dispose”方法以从标签中移除 CLICK 事件侦听器。如果您不打算删除 Slider，这不是问题，但如果是，我通常会创建一个名为的方法`dispose`并将我的所有手动删除逻辑放在那里（删除事件侦听器、取消监视/删除 ChangeWatchers）。然后我为组件的事件分配一个侦听器`REMOVED_FROM_STAGE`并从该侦听器调用`dispose`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T20:28:27.767

您确定滑块是在这种情况下使用的最佳组件吗？一般来说，当用户有大量连续选项可供选择时，将使用滑块，其中用户选择的精度并不重要（例如，音量滑块 - 音量为 51% 而不是 50%真的不会有太大的不同）。

如果您只有三个选项，并且只允许用户选择这三个选项之一，我建议使用组合框或单选按钮组。

# git - 仅使用 git 将网站的更改部分部署到 ftp (svn2web for git)

> ID：865722
> 
> 赞同：10
> 
> 时间：2009-05-14T20:55:47.023
> 
> 标签：git, deployment, mercurial, version-control

我有一个包含许多大图像文件的网站。源（以及图像）由 git 维护。我希望通过 ftp 将其部署到类似 bluehost 的廉价服务器上。

我不希望每次都部署所有网站（这样我就不必一遍又一遍地上传太多未更改的文件），但大致执行以下操作：

1.  在 git 存储库中，使用标记“已部署”标记上次部署的修订。
2.  当我说“部署修订版 X”时，找出修订版 X 和标记为部署的修订版之间哪些文件发生了更改，然后只上传它们。

它在精神上类似于[svn2web](http://svn2web.sourceforge.net/)。但我想要 DVCS。将考虑使用 Mercurial 替代品。

这是一个非常简单的脚本，但如果网络上有一些类似的脚本，我宁愿不要重新发明轮子。

Capistrano 和 fab 似乎只知道如何在他们的 SCM 集成中推动整个修订。所以我认为我目前无法使用它们。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-29T07:01:47.957

[git-ftp](https://github.com/git-ftp/git-ftp)脚本可能是您正在寻找的。它获取本地 git 存储库的更改并通过 ftp 将其同步到远程 git 存储库。

我通过托管使用[--bare 选项](http://www.bluishcoder.co.nz/2007/09/how-to-publish-git-repository.html)创建的 git repo 来使用它。把它放在我的ftp服务器上。

比运行 ./git-ftp.py。它提示输入 ftp 用户名、密码、ftp 主机、本地 git 存储库路径、远程 git 存储库路径（裸存储库的位置）。

然后它连接到 ftp git repo，然后单独发送差异。（它使用 git-python 库来获取所需的信息）。

该脚本几乎没有问题。它似乎总是提示输入用户名详细信息，我不得不注释掉第 68 行。

```
#ftp.voidcmd('SITE CHMOD 755 ' + node.name). 
```

但这些事情很容易解决。

**选择**

如果您在 nix 平台上，另一种方法是使用[curlftpfs](http://curlftpfs.sourceforge.net/)。它会将您的 ftp 帐户挂载为设备目录，您可以从中执行所有正常的 git 操作（推送、拉取）。当然，这个解决方案不是特定于 git 的。

您需要在 FTP 上共享的 repo 上使用上面提到的 bare 选项，并在 repo 中运行 [git update-server-info](http://www.kernel.org/pub/software/scm/git/docs/git-update-server-info.html)，然后再通过 FTP 共享它。

*注意*：如果您计划让多个用户写入您的 git 存储库，这不是一个好主意。由于 FTP 没有锁定访问的机制。你最终会得到一个腐败的回购。在投入生产之前进行测试。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-05-15T20:45:42.330

我创建了一个名为[git-deploy](http://github.com/aizatto/git-deploy)的脚本，希望对您有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T21:21:33.093

您可以将最新部署的修订存储在文件中的某个位置，然后您可以简单地获取更改文件的名称：

```
$ git diff --name-only $deployed $latest 
```

例如，用相应的 sha-1 代码替换，或者 $latest 可以是“master”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T21:29:46.693

另一种选择是使用[`git archive`](http://www.kernel.org/pub/software/scm/git/docs/git-archive.html).

当然，正如 Joey 在他的“[`git archive`作为发行版包格式](http://kitenet.net/~joey/blog/entry/git_archive_as_distro_package_format/)”中提到的：

> 使用 git（或其他 rcs）存档作为分发源包格式的棘手部分是处理原始的上游 tarball。
> 
> *   一种方法是尝试创建一个不包含存在于上游 tarball 中的对象的 git 存档。然后，要解压源代码包，您需要解压上游 tarball，将其中的文件转换为 git 对象并将它们添加到 .git 目录中。
>     这似乎可以实现，但是您需要了解很多关于 git 内部的知识才能从 git repo 中删除冗余对象并从 tarball 中重新生成它们。
>     
>     
> *   另一种方法是将**原始的上游 tarball 保存在 git 存档中，然后源包将完全由 git 存档组成**。这没有同样好的最小带宽上传行为——除非你可以“ `git push`”你的改变来做上传
>     
>     
> 
> **在 git 中存储大量上游 tarball 效率不高**，但脚本**[pristine-tar](http://git.kitenet.net/?p=pristine-tar.git;a=summary)**会处理这一点：
> 
> pristine-tar 可以仅使用一个小的二进制 delta 文件和可以作为修订控制检出的源副本来重新生成原始的上游 tarball。
> 该软件包还包括一个 pristine-gz 命令，它可以重新生成一个原始的 .gz 文件。
> delta 文件旨在与源代码一起检查到修订控制中，从而允许从修订控制中提取原始 tarball。

[此 perl 脚本 pristine-tar 的标题中的](http://git.kitenet.net/?p=pristine-tar.git;a=blob;f=pristine-tar;h=e7cd0f75fb2503eb9b564fc07eeab9f23ed436c8;hb=9d57a88c0825a0098a89a7f7f1af31b58a836bf3)更多详细信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-09T15:49:37.567

您也可以使用 wput (wput --timestamping --reupload --dont-continue) -- 就像 wget 仅用于 ftp 上传

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-11T12:40:23.133

Mercurial 的微型 BASH 解决方案：[hg-deploy](https://bitbucket.org/Pancetta/hg-deploy)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-26T13:44:21.737

`git-ftp push`来自的命令[`git-ftp`](https://github.com/git-ftp/git-ftp)似乎工作得很好。

安装它

```
sudo apt-get install git-ftp 
```

安装好后，配置你的ftp账号

```
git config git-ftp.url ftp.example.net
git config git-ftp.user your-ftp-user
git config git-ftp.password your-secr3t 
```

然后第一次做

```
git-ftp init 
```

然后，对于每一个变化，你只需要

```
git add -A
git commit -m "update"
git-ftp push 
```

文件将上传到用户主`~/`目录。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-03T21:09:42.273

对于 Github 用户，您可以使用[FTP Deploy Action](https://github.com/SamKirkland/FTP-Deploy-Action/)。

只需在`/.github/workflows/main.yml`.

```
on: push
name:  Deploy website on push
jobs:
  web-deploy:
    name:  Deploy
    runs-on: ubuntu-latest
    steps:
    - name:  Get latest code
      uses: actions/checkout@v2

    - name:  Sync files
      uses: SamKirkland/FTP-Deploy-Action@4.1.0
      with:
        server: <ftp_server>
        username: <ftp_username>
        password: ${{ secrets.ftp_password }} 
```

在每次主推时，只有自上次以来更改的文件会自动上传到 FTP 服务器。

# c# - WPF内存碎片

> ID：865735
> 
> 赞同：1
> 
> 时间：2009-05-14T20:59:05.067
> 
> 标签：c#, c++, wpf, memory, fragmentation

我有我认为是内存碎片问题。

我们最近将 WinForms 应用程序移植到 WPF 应用程序。此应用程序执行一些图像处理，并且此处理始终在应用程序的 WinForms 版本中工作。我们去WPF，处理死了。调试到库中会随机出现死亡，但总是有一个为空的数组，即分配失败。

处理本身是在一个由 ap/invoke 调用的 C++ 库中完成的，并且内存相当密集；如果给定的图像是 N x M 像素大，则图像是 N x M x 2 字节大（每个像素都是无符号短，并且是灰度图像）。在处理过程中，图像金字塔在浮点空间中，因此总内存使用量将是 N x M x (2 + 2 + 4 + 4 + 4 + 4)，其中第一个 2 是输入，第二个2 是输出，前 4 是浮点数的输入，第二个 4 是第 0 级差异图像，最后两个四是金字塔的其余部分（因为它们是金字塔，每个级别是每个级别的一半大小方向，这 4 个是上限）。因此，对于 5000x6000 的图像，即 600 mb，应该可以很好地放入内存中。

（使用编组可能会增加另一个 N x M x 4 的内存需求，即 C# 端的输入和输出图像，然后将相同的数组复制到 C++ 端——编组要求会更大吗？ )

与 WinForms 相比，WPF 的碎片化程度如何？有没有办法在运行这个处理之前整合内存？我怀疑由于破损的随机性，当它们发生时，碎片是问题，并且它始终是内存分配问题。

或者我应该通过使处理作为一个单独的进程运行，通过套接字或类似的东西传输数据来完全避免这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T21:08:46.103

如果我没看错，内存分配失败发生在非托管端，而不是托管端。责怪WPF似乎很奇怪。我认识到您是根据“它在 WinForms 中工作”这一事实得出的结论，但可能还有更多的变化。您可以使用[.NET Memory Profiler](http://memprofiler.com/)之类的工具来查看 WPF 应用程序和 WinForms 应用程序处理内存的方式之间的差异。您可能会发现您的应用程序正在做一些您意想不到的事情。:)

每条评论：是的，我明白了。如果您确信您已经排除了诸如环境变化之类的事情，我认为您必须获取[BoundsChecker](http://www.compuware.com/products/devpartner/visualc.htm)和 Memory Profiler （或[DevPartner Studio](http://www.compuware.com/products/devpartner/studio.htm)）的副本并深入了解是什么弄乱了您的内存分配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T22:33:07.617

我猜GC正在移动你的记忆。只要您有指向数组的原始指针，请尝试将内存固定在非托管土地上，并尽快取消固定它。WPF 可能导致 GC 更频繁地运行，这可以解释为什么它会更频繁地发生，如果是 GC，那么这将解释为什么它会在代码中的随机位置发生。

编辑：出于好奇，您是否还可以预先分配所有内存（我没有看到代码，所以不知道这是否可能），并确保您的所有指针都是非空的，所以你可以验证它实际上是在内存分配中发生的，而不是其他一些问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T04:42:30.617

听起来您通常希望对内存管理更加小心；即：要么在单独的地址空间中运行处理引擎，该地址空间仔细管理内存，要么在内存变得过于碎片化之前预先分配足够大的块并仅管理该区域中的图像。如果您在一个长时间运行的进程中与 .NET 运行时共享地址空间，并且您需要大的连续区域，那么它总是会在某些时候失败。只是我的2c。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-14T06:34:56.343

这篇文章可能有用 [http://blogs.msdn.com/tess/archive/2009/02/03/net-memory-leak-to-dispose-or-not-to-dispose-that-s-the-1 -gb-question.aspx](http://blogs.msdn.com/tess/archive/2009/02/03/net-memory-leak-to-dispose-or-not-to-dispose-that-s-the-1-gb-question.aspx)

# python - “其他”在 Python 中被认为是有害的？

> ID：865741
> 
> 赞同：11
> 
> 时间：2009-05-14T21:00:06.467
> 
> 标签：python, if-statement

在一个关于 Python 声明的问题的[回答](https://stackoverflow.com/questions/855759/python-try-else/855783#855783)中（由[S.Lott 撰写）](https://stackoverflow.com/users/10661/s-lott)`try...else`：

> 实际上，即使在 if 语句中，else: 也可能以非常糟糕的方式被滥用，从而产生很难找到的错误。[...]
> 
> 三思而后行：。这通常是一个问题。避免它，除非在 if 语句中，甚至考虑记录 else 条件以使其明确。

**这是一个广泛持有的观点吗？被`else` [认为是有害](http://meyerweb.com/eric/comment/chech.html)的？**

当然，您可以用它编写令人困惑的代码，但任何其他语言结构都是如此。在我看来，即使是 Python 也是`for...else`一件非常方便的事情（对于`try...else`.

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-14T21:04:53.727

S.Lott 显然已经看到了一些糟糕的代码。我们不是吗？我不认为 else 有害，尽管我已经看到它用于编写糟糕的代码。在这些情况下，所有周围的代码也很糟糕，那为什么还要责怪糟糕的其他代码呢？

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-14T21:06:57.730

不，它没有害处，这是必要的。

应该始终有一个包罗万象的声明。所有开关都应该有一个默认值。ML 语言中的所有模式匹配都应该有一个默认值。

在一系列 if 语句之后不可能推理出什么是真实的论点是生活中的事实。计算机是最大的有限状态机，在每种情况下列举每种可能性是愚蠢的。

如果你真的害怕未知错误在 else 语句中被忽视，那么在那里引发异常真的那么难吗？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-14T21:09:25.370

说 else 被认为是有害的有点像说变量或类是有害的。哎呀，这甚至就像说 goto 是有害的。当然，事情可能会被滥用。但是在某些时候，你只需要相信程序员是成年人并且足够聪明，不要这样做。

归根结底是：如果您愿意不使用某些东西，因为 SO 上的答案或博客文章甚至 Dijkstra 的著名论文告诉您不要使用，您需要考虑编程是否适合您.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-14T21:09:31.220

我不会说它是有害的，但有时 else 语句会给你带来麻烦。例如，如果您需要根据一个输入值进行一些处理，并且只有两个有效的输入值。只有检查一个可能会引入一个错误。例如：

```
The only valid inputs are 1 and 2:

if(input == 1)
{
   //do processing
   ...
}
else
{
   //do processing 
   ...
} 
```

在这种情况下，使用 else 将允许处理除 1 之外的所有值，而应该只处理值 1 和 2。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-14T21:08:48.227

对我来说，某些流行语言结构本质上不好的整个概念是完全错误的。甚至`goto`有它的位置。我见过 Walter Bright 和 Linus Torvalds 等人使用它的可读性强、可维护的代码。只教程序员可读性很重要并使用常识比武断地声明某些构造“有害”要好得多。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-14T23:02:38.857

如果你写：

```
if foo:
    # ...
elif bar:
    # ...
# ... 
```

那么读者可能会想知道：如果两者`foo`都不`bar`是真的呢？也许您知道，根据您对代码的理解，必须是`foo`or 或`bar`. 我希望看到：

```
if foo:
    # ...
else:
    # at this point, we know that bar is true.
    # ...
# ... 
```

或者：

```
if foo:
    # ...
else:
    assert bar
    # ...
# ... 
```

这让读者清楚地知道您希望控制如何流动，而无需读者对来自何处`foo`和`bar`来自何处有深入的了解。

（在最初的情况下，你仍然可以写一个评论来解释正在发生的事情，但我想我会想知道：“为什么不只使用一个`else:`子句？”）

我认为重点不是你不应该使用`else:`; 相反，**一个`else:`子句可以让您编写不清楚的代码**，您应该尝试识别何时发生这种情况并添加一些注释以帮助任何读者。

这对于编程语言中的大多数事情都是正确的，真的:-)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-14T21:11:31.620

**Else**在记录有关代码的假设时最有用。它确保您已经考虑了 if 语句的两面。

始终在每个 if 语句中使用 else 子句甚至是“代码完成”中的推荐做法。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-14T21:12:24.443

Au contraire... 在我看来，每个 if 都必须有一个 else。诚然，您可以做愚蠢的事情，但如果您足够努力，您可以滥用任何构造。您知道“真正的程序员可以用每种语言编写 FORTRAN”的说法。

我经常做的是将 else 部分写成评论，描述为什么没有什么可做的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-14T21:12:23.227

`else`首先在 Python 中包含语句 (of )的基本原理`try...else`是只捕获您真正想要的异常。通常当你有一个`try...except`块时，有一些代码可能会引发异常，然后还有一些代码只有在前面的代码成功时才应该运行。如果没有`else`块，您必须将所有代码放入`try`块中：

```
try:
    something_that_might_raise_error()
    do_this_only_if_that_was_ok()
except ValueError:
    # whatever 
```

问题是，如果`do_this_only_if_that_was_ok()`引发 a`ValueError`怎么办？`except`当你可能不想要它时，它会被声明抓住。这就是`else`块的目的：

```
try:
    something_that_might_raise_error()
except ValueError:
    # whatever
else:
    do_this_only_if_that_was_ok() 
```

我想这在某种程度上是一个见仁见智的问题，但我个人认为这是一个好主意，尽管我很少使用它。当我使用它时，感觉非常合适（此外，我认为它有助于澄清代码流）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-14T21:12:52.617

在我看来，对于存在默认场景或副作用的任何语言和任何流程控制语句，该场景需要具有相同的考虑水平。if 或 switch 或 while 中的逻辑仅与条件 if(x) while(x) 或 for(...) 一样好。因此，该陈述无害，但其条件的逻辑是有害的。

因此，作为开发人员，我们有责任用广泛的 else in mind 进行编码。太多的开发人员将其视为“如果不是上述”，实际上它可以忽略所有常识，因为其中唯一的逻辑是对前面逻辑的否定，这通常是不完整的。（算法设计错误本身）

然后，我不认为“其他”比 for() 循环中的“其他”或糟糕的内存管理更有害。这都是关于算法的。如果您的自动机在其范围和可能的分支上是完整的，并且所有内容都是具体的并且可以理解，那么就不会有危险。危险在于人们误用了表达式背后的逻辑，而没有意识到广泛逻辑的影响。**计算机很愚蠢，它们按照操作员的指示行事**（理论上）

我确实认为**try**和**catch**是危险的，因为它可以否定对未知数量的代码的处理。**在raise**之上的分支可能包含一个 bug，由**raise**本身突出显示。这可能是不明显的。这就像将一组顺序指令变成错误处理的树或图，其中每个组件都依赖于父级中的分支。奇怪的。请注意，我爱C。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-15T22:11:10.813

在 C 家族语言中遇到了一个所谓的“悬空 else”问题，如下所示：

```
if (a==4)
if (b==2)
printf("here!");
else
printf("which one"); 
```

这个无辜的代码可以通过两种方式来理解：

```
if (a==4)
    if (b==2)
        printf("here!");
    else
        printf("which one"); 
```

或者

```
if (a==4)
    if (b==2)
        printf("here!");
else
    printf("which one"); 
```

问题是“else”是“悬空的”，可以迷惑else的所有者。当然编译器不会造成这种混淆，但它对凡人有效。

感谢 Python，我们不能在 Python 中遇到悬空的 else 问题，因为我们必须编写

```
if a==4:
    if b==2:
        print "here!"
else:
    print "which one" 
```

或者

```
if a==4:
    if b==2:
        print "here!"
    else:
        print "which one" 
```

所以人的眼睛会捕捉到它。而且，不，我不认为“else”是有害的，它和“if”一样有害。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-14T21:11:30.327

在假设难以推理的示例中，可以显式编写，但 else 仍然是必需的。例如

```
if a < 10:       
    # condition stated explicitly   
elif a > 10 and b < 10:       
    # condition confusing but at least explicit   
else:       
    # Exactly what is true here?       
    # Can be hard to reason out what condition is true 
```

可以写

```
if a < 10:       
    # condition stated explicitly   
elif a > 10 and b < 10:       
    # condition confusing but at least explicit   
elif a > 10 and b >=10:
    # else condition
else:   
    # Handle edge case with error? 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-14T21:50:38.703

我认为关键`try...except...else`在于使用它来*创建*不一致的状态而不是修复它是一个简单的错误。不是不惜一切代价避免它，但它可能会适得其反。

考虑：

```
try:
    file = open('somefile','r')
except IOError:
    logger.error("File not found!")
else:
    # Some file operations
    file.close()
# Some code that no longer explicitly references 'file' 
```

说上面的块阻止代码尝试访问不存在的文件或用户没有权限的目录，并且说所有内容都被封装，因为它在一个`try...except...else`块中，这将是非常好的。但实际上，上面形式的很多代码真的应该是这样的：

```
try:
    file = open('somefile','r')
except IOError:
    logger.error("File not found!")
    return False
# Some file operations
file.close()
# Some code that no longer explicitly references 'file' 
```

你经常自欺欺人地说，因为`file`不再在范围内引用，所以在块之后继续编码是可以的，但在许多情况下，会出现一些不合适的地方。或者，稍后可能会在`else`块中创建一个未在块中创建的变量`except`。

这就是我区分`if...else`from 的方式`try...except...else`。在这两种情况下，在大多数情况下，必须使块并行（一个中设置的变量和状态应该设置在另一个中），但在后一种情况下，编码人员通常不这样做，可能是因为它不可能或不相关。在这种情况下，返回调用者通常比尝试继续解决您认为在最佳情况下将拥有的东西更有意义。

# ruby-on-rails - 如果出现错误，请清除密码字段

> ID：865748
> 
> 赞同：0
> 
> 时间：2009-05-14T21:00:55.110
> 
> 标签：ruby-on-rails

我有一个带有 virtual_attributes 的常规注册表单：

```
attr_accessor :password_confirmation

def password
  @password
end

def password=(password)
  @password=self.crypted_password = User.encrypt(@password=pass, create_new_password_salt)
end 
```

当密码出现错误时，我想清除表单的密码字段。我想出了如何使用 return 使密码字段不显示错误，但如果密码字段有错误，我不知道如何使 password_confirmation 字段返回。

观点很简单

```
<% form_for @user do |f| %>
  <%= f.password_field :password %>
  <%= f.password_field :password_confirmation %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T21:50:11.497

我并不完全清楚您当前的密码验证是如何工作的，但是这样的事情怎么样：

```
class User < ActiveRecord::Base
  ...
  validate :password_confirmation_matches

  def password_confirmation_matches
    if password != password_confirmation
      errors.add_to_base("You did not correctly confirm your password")
      self.password_confirmation = self.password = nil
    end
  end
end 
```

这对你有用吗？

# c++ - 即使我有一个指向它的指针（装饰器）也不能调用基类方法？

> ID：865756
> 
> 赞同：0
> 
> 时间：2009-05-14T21:03:02.937
> 
> 标签：c++, templates, decorator

我有一个模板类，我用一个指向它的指针（装饰器模式）对其进行了子类化。我添加了一个`getBase()`调用来返回指向基类的指针以用于任何进一步的子类。但是，当我使用它`getBase()`并调用仅基类的方法时，我得到一个链接器错误，它无法在中间（装饰器）类中找到该方法的符号？

像这样：

```
template <typename T> class B {    
  public:
    typedef std::auto_ptr<T> MYFUN( 
      std::istream&, const std::string&, const std::string& );

  public:
    B<T>( MYFUN* p );
    auto_ptr<T> fun( istream& );

  private:
    MYFUN *fptr;
};

template <typename T>
class D : public class B<T>
{
  D( typename B<T>::MYFUN *fPtr, B<T> *providedBase );
  //Looks like B
  B* getBase() { return base_ ; }
  private:
    B* base_;
};

template <typename T>
class Dagain : public class D<T>
{
  //Looks like D
  auto_ptr<T> fun( istream& );
};

auto_ptr<T>
Dagain::fun( istream& is )
{
  this->getBase()->fun( is );
} 
```

`fun( istream& )`请注意， in没有定义`D<T>`。目的是让客户端使用指向基址的指针来调用`B<T>::fun( istream& )`

当客户端构造一个`Dagain`对象时，链接器说（基本上）：

`Client.o:
(.data.rel.ro. --stuff--
[vtable for D<T>]:
undefined reference to
'D<T>::fun( basic_istream<char, char_traits<char> >&)'`

但是，我没有调用**D**的定义`fun(istream&)`......它甚至没有！我直接使用指向基类的指针......当我为`D<T>::fun(istream&)`事情添加定义时，但我不明白为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-27T16:57:07.353

您忘记在模板定义中指定模板参数。此外，您还有一些错误。这是工作代码：

```
template <typename T> class B {
  public:
    typedef std::auto_ptr<T> MYFUN(
      std::istream&, const std::string&, const std::string& );

  public:
    B<T>( MYFUN* p );
    auto_ptr<T> fun( istream& );

  private:
    MYFUN *fptr;
};

template <typename T>
class D : public B<T>
{
  D( typename B<T>::MYFUN *fPtr, B<T> *providedBase );
  //Looks like B
  B<T>* getBase() { return base_ ; }
  private:
    B<T>* base_;
};

template <typename T>
class Dagain : public D<T>
{
  //Looks like D
  auto_ptr<T> fun( istream& );
};

template <typename T>
auto_ptr<T>
Dagain<T>::fun( istream& is )
{
  this->getBase()->fun( is );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:08:56.027

我不是 C++ 专家，不确定这是否与模板有关，但如果我们忽略模板，我认为您的部分问题可能是 B 中的 fun() 不是虚拟的。

当您调用 getBase() 时，您会得到 B* 的静态类型，然后当您在其上调用 fun() 时，您会从 B 中获取版本，而不是 DAgain 中的版本。我认为链接器会抱怨您没有为 B 定义版本（因此也为 D 定义）。由于绑定是静态的，因此在 DAgain 中覆盖 fun() 的事实是不够的。

另一种选择是返回 B* 而不是 B* 可能是问题所在，但我最近使用 C++ 的次数还不够多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:11:36.957

在我看来，您`getBase`的返回类型错误。它应该返回正确的基类类型：

```
template <typename T>
class D : public class B<T>
{
  ...
  //Looks like B
  B<T>* getBase() { return base_ ; }
  private:
    B<T>* base_;
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T21:13:01.493

你所说的“基础”实际上不是—— D 有一个真正的 B 基础（由于继承）和一个通过该指针的假基础。至于为什么当您似乎根本没有虚拟机时编译器会抱怨 vtable，这很奇怪——您确定您在某处没有虚拟机吗？

# linux - 打印fifo内容并退出

> ID：865762
> 
> 赞同：2
> 
> 时间：2009-05-14T21:04:45.257
> 
> 标签：linux, shell, command-line, named-pipes

我需要将 fifo（命名管道）的内容打印到标准输出。
我可以使用以下命令：

```
cat fifo 
```

问题是它`cat`不会返回。它保持运行，等待来自 fifo 的更多内容。但我知道一段时间内不会有更多内容出现，所以我只想打印可用的内容。

是否有只打印可用内容并退出的命令？

**编辑：**
在fifo的一端，有一个过程不时地写入不同命令的输出。该进程将永久运行，因此不会出现 EOF。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T21:16:16.227

当您无法发送 EOF 时，您可以使用“非阻塞猫”。我已经包含了我在[这里](http://www.linuxquestions.org/questions/programming-9/reading-from-fifo-file-569873/)找到的（经过测试的）C 版本（当然要归功于原作者）。魔法就在`fcntl(STDIN_FILENO, F_SETFL, O_NONBLOCK).`

这个非阻塞猫的第一个参数是你想在再次退出之前等待的秒数。

```
#include <stdio.h>
#include <fcntl.h>
#include <time.h>
#include <unistd.h>
#include <string.h>

void read_loop(int fFile, double wWait)
{
    if (fFile < 0) return;

    double max_time = wWait, total_time = 0;
    struct timespec cycle_time = { 0, 50 * 1000 * 1000 };
    double add_time = (double) cycle_time.tv_sec + (double) cycle_time.tv_nsec / 1000000000.;

    char next_line[1024];

    FILE *input_file = fdopen(fFile, "r");

    while (total_time < max_time)
    {
    while (fgets(next_line, 1024, input_file))
     {
    write(STDOUT_FILENO, next_line, strlen(next_line));
    total_time = 0;
     }

    nanosleep(&cycle_time, NULL);
    total_time += add_time;
    }

    fclose(input_file);
}

int main(int argc, char *argv[])
{
    if (argc < 2)
    {
    fprintf(stderr, "%s [max time] (files...)\n", argv[0]);
    return 1;
    }

    int max_wait = strtoul(argv[1],0, 10);

    if (argc == 2)
    {
    fprintf(stderr, "%s: using standard input\n", argv[0]);
    fcntl(STDIN_FILENO, F_SETFL, O_NONBLOCK);
    read_loop(STDIN_FILENO, max_wait);
    return 0;
    }

    int current = 2;

    while (current < argc)
    {
    fprintf(stderr, "%s: switch to file '%s'\n", argv[0], argv[current]);
    int next_file = open(argv[current++], O_RDONLY | O_NONBLOCK);
    read_loop(next_file, max_wait);
    close(next_file);
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:13:23.020

您应该关闭 FIFO 的另一端。那应该向`cat`进程发送一个EOF。

# wpf - WPF中的滑块开/关开关

> ID：865767
> 
> 赞同：33
> 
> 时间：2009-05-14T21:06:18.653
> 
> 标签：wpf, wpf-controls

我正在寻找有关在 iPhone 上创建幻灯片 ON/OFF 开关的 WPF 教程。

这是一个示例（“发送所有流量”选项）[https://secure-tunnel.com/support/software_setup/iphone/images/iphone_vpn_settings.jpg](https://secure-tunnel.com/support/software_setup/iphone/images/iphone_vpn_settings.jpg)

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-05-14T21:24:16.643

我还没有看到关于这个确切问题的教程，但我想你可以从启动 Expression Blend 并在其上放置一个 CheckBox 开始。然后选择复选框，进入主菜单 - 对象 -> 编辑样式 -> 编辑副本

这将使 Blend 生成 CheckBox 的默认样式，因此您可以对其进行修改。看看那里的事情是如何运作的，你将能够取得一些成果。

基本上（除了颜色和画笔），您需要查看与 IsChecked 属性挂钩的触发器。例如，当 IsChecked 为 True 时，您将矩形移动到一侧，显示 ON 字并隐藏 OFF 字。要对此进行动画处理，您只需添加触发器输入和输出动画。

UPD：我花了 10-15 分钟来混合制作“原型”：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Class="CheckBoxIPhone.Window1"
    x:Name="Window"
    Title="Window1"
    Width="320" 
    Height="240" 
    FontFamily="Segoe UI" 
    FontSize="20" 
    WindowStartupLocation="CenterScreen"
    >

    <Window.Resources>
        <Style x:Key="CheckBoxStyle1" TargetType="{x:Type CheckBox}">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
            <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type CheckBox}">
                        <ControlTemplate.Resources>
                            <Storyboard x:Key="OnChecking">
                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="slider" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
                                    <SplineDoubleKeyFrame KeyTime="00:00:00.3000000" Value="25"/>
                                </DoubleAnimationUsingKeyFrames>
                            </Storyboard>
                            <Storyboard x:Key="OnUnchecking">
                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="slider" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
                                    <SplineDoubleKeyFrame KeyTime="00:00:00.3000000" Value="0"/>
                                </DoubleAnimationUsingKeyFrames>
                                <ThicknessAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="slider" Storyboard.TargetProperty="(FrameworkElement.Margin)">
                                    <SplineThicknessKeyFrame KeyTime="00:00:00.3000000" Value="1,1,1,1"/>
                                </ThicknessAnimationUsingKeyFrames>
                            </Storyboard>
                        </ControlTemplate.Resources>

                        <DockPanel x:Name="dockPanel">
                            <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" Content="{TemplateBinding Content}" ContentStringFormat="{TemplateBinding ContentStringFormat}" ContentTemplate="{TemplateBinding ContentTemplate}" RecognizesAccessKey="True" VerticalAlignment="Center"/>
                            <Grid Margin="5,5,0,5" Width="50" Background="#FFC0CCD9">
                                <TextBlock Text="ON" TextWrapping="Wrap" FontWeight="Bold" FontSize="12" HorizontalAlignment="Right" Margin="0,0,3,0"/>
                                <TextBlock HorizontalAlignment="Left" Margin="2,0,0,0" FontSize="12" FontWeight="Bold" Text="OFF" TextWrapping="Wrap"/>
                                <Border HorizontalAlignment="Left" x:Name="slider" Width="23" BorderThickness="1,1,1,1" CornerRadius="3,3,3,3" RenderTransformOrigin="0.5,0.5" Margin="1,1,1,1">
                                    <Border.RenderTransform>
                                            <TransformGroup>
                                                <ScaleTransform ScaleX="1" ScaleY="1"/>
                                                <SkewTransform AngleX="0" AngleY="0"/>
                                                <RotateTransform Angle="0"/>
                                                <TranslateTransform X="0" Y="0"/>
                                            </TransformGroup>
                                        </Border.RenderTransform>
                                        <Border.BorderBrush>
                                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                <GradientStop Color="#FFFFFFFF" Offset="0"/>
                                                <GradientStop Color="#FF4490FF" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.BorderBrush>
                                        <Border.Background>
                                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                <GradientStop Color="#FF8AB4FF" Offset="1"/>
                                                <GradientStop Color="#FFD1E2FF" Offset="0"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                    </Border>
                                </Grid>
                        </DockPanel>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Trigger.ExitActions>
                                    <BeginStoryboard Storyboard="{StaticResource OnUnchecking}" x:Name="OnUnchecking_BeginStoryboard"/>
                                </Trigger.ExitActions>
                                <Trigger.EnterActions>
                                    <BeginStoryboard Storyboard="{StaticResource OnChecking}" x:Name="OnChecking_BeginStoryboard"/>
                                </Trigger.EnterActions>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid x:Name="LayoutRoot">
        <CheckBox HorizontalAlignment="Center" Style="{DynamicResource CheckBoxStyle1}" VerticalAlignment="Center" Content="CheckBox"/>
    </Grid>
</Window> 
```

如果您有兴趣，我还建议您阅读 WPF 中的样式和模板。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2011-03-18T08:13:25.980

我根据 arcaut 的帖子创建了一些橙色和蓝色的样式。

截屏： ![点击](https://i.stack.imgur.com/Hzmif.png)

我希望我的风格更接近 iOS 设备的 On/Off Switch 风格。这种风格的一个区别是，滑动动画只滑动开关而不是下面的指示器。也许如果我能找到一些时间，我会这样修改它。在那之前，我想分享我的结果。它并不完美，但这是代码。

```
<LinearGradientBrush x:Key="CheckedBlue" StartPoint="0,0" EndPoint="0,1">
  <GradientStop Color="#FF285AB3" Offset="0" />
  <GradientStop Color="#FF4184EC" Offset="0.5" />
  <GradientStop Color="#FF558BED" Offset="0.5" />
  <GradientStop Color="#FF7DACF0" Offset="1" />
</LinearGradientBrush>
<LinearGradientBrush x:Key="CheckedOrange" StartPoint="0,0" EndPoint="0,1">
  <GradientStop Color="#FFCA6A13" Offset="0" />
  <GradientStop Color="#FFF67D0C" Offset="0.2" />
  <GradientStop Color="#FFFE7F0C" Offset="0.2" />
  <GradientStop Color="#FFFA8E12" Offset="0.5" />
  <GradientStop Color="#FFFF981D" Offset="0.5" />
  <GradientStop Color="#FFFCBC5A" Offset="1" />
</LinearGradientBrush>
<SolidColorBrush x:Key="CheckedOrangeBorder" Color="#FF8E4A1B" />
<SolidColorBrush x:Key="CheckedBlueBorder" Color="#FF143874" />
<Style x:Key="OrangeSwitchStyle" TargetType="{x:Type CheckBox}">
  <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}" />
  <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type CheckBox}">
        <ControlTemplate.Resources>
          <Storyboard x:Key="OnChecking">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="slider" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
              <SplineDoubleKeyFrame KeyTime="00:00:00.1000000" Value="53" />
            </DoubleAnimationUsingKeyFrames>
          </Storyboard>
          <Storyboard x:Key="OnUnchecking">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="slider" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
              <SplineDoubleKeyFrame KeyTime="00:00:00.1000000" Value="0" />
            </DoubleAnimationUsingKeyFrames>
          </Storyboard>
        </ControlTemplate.Resources>
        <DockPanel x:Name="dockPanel">
          <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" Content="{TemplateBinding Content}" ContentStringFormat="{TemplateBinding ContentStringFormat}" ContentTemplate="{TemplateBinding ContentTemplate}" RecognizesAccessKey="True" VerticalAlignment="Center" />
          <Grid>
            <Border x:Name="BackgroundBorder" BorderBrush="#FF939393" BorderThickness="1" CornerRadius="3" Height="27" Width="94">
              <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                  <GradientStop Color="#FFB5B5B5" Offset="0" />
                  <GradientStop Color="#FFDEDEDE" Offset="0.1" />
                  <GradientStop Color="#FFEEEEEE" Offset="0.5" />
                  <GradientStop Color="#FFFAFAFA" Offset="0.5" />
                  <GradientStop Color="#FFFEFEFE" Offset="1" />
                </LinearGradientBrush>
              </Border.Background>
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition /><ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Ellipse x:Name="Off" Width="14" Height="14" Stroke="#FF7A7A7A" StrokeThickness="2" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" />
                <Line x:Name="On" X1="0" Y1="0" X2="0" Y2="14" Stroke="#FF7A7A7A" StrokeThickness="2" Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" />
              </Grid>
            </Border>
            <Border BorderBrush="#FF939393" HorizontalAlignment="Left" x:Name="slider" Width="41" Height="27" BorderThickness="1" CornerRadius="3" RenderTransformOrigin="0.5,0.5" Margin="0">
              <Border.RenderTransform>
                <TransformGroup>
                  <ScaleTransform ScaleX="1" ScaleY="1" />
                  <SkewTransform AngleX="0" AngleY="0" />
                  <RotateTransform Angle="0" />
                  <TranslateTransform X="0" Y="0" />
                </TransformGroup>
              </Border.RenderTransform>
              <Border.Background>
                <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                  <GradientStop Color="#FFF0F0F0" Offset="0" />
                  <GradientStop Color="#FFCDCDCD" Offset="0.1" />
                  <GradientStop Color="#FFFBFBFB" Offset="1" />
                </LinearGradientBrush>
              </Border.Background>
            </Border>
          </Grid>
        </DockPanel>
        <ControlTemplate.Triggers>
          <Trigger Property="IsChecked" Value="True">
            <Trigger.ExitActions>
              <BeginStoryboard Storyboard="{StaticResource OnUnchecking}" x:Name="OnUnchecking_BeginStoryboard" />
            </Trigger.ExitActions>
            <Trigger.EnterActions>
              <BeginStoryboard Storyboard="{StaticResource OnChecking}" x:Name="OnChecking_BeginStoryboard" />
            </Trigger.EnterActions>
            <Setter TargetName="On" Property="Stroke" Value="White" />
            <Setter TargetName="Off" Property="Stroke" Value="White" />
            <!-- Change Orange or Blue color here -->
            <Setter TargetName="BackgroundBorder" Property="Background" Value="{StaticResource CheckedOrange}" />
            <Setter TargetName="BackgroundBorder" Property="BorderBrush" Value="{StaticResource CheckedOrangeBorder}" />
          </Trigger>
          <Trigger Property="IsEnabled" Value="False">
            <!-- ToDo: Add Style for Isenabled == False -->
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-05-20T07:00:54.323

一些开源的切换开关：

*   [ToggleSwitch](https://github.com/ejensen/toggle-switch-control)看起来不错，NuGet 也可以使用。
*   [MahApps ToggleSwitch](https://mahapps.com/docs/controls/toggleswitch)是 Metro 类控件的更大 MahApps 库的一部分。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-01-02T22:00:36.460

我刚刚发布了一个关于此的条目，它提供了适当的滑动动作、完全可配置性并且不需要固定大小（因为我在网上找不到任何提供类似解决方案的东西而感到恼火）。

你可以在这里找到它：http: [//itsallaboutthexaml.blogspot.com/2012/01/variables-in-animation.html](http://itsallaboutthexaml.blogspot.com/2012/01/variables-in-animation.html)

知道回答这个问题已经很晚了，但希望它对未来的任何人都有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-20T13:23:22.087

我喜欢arconaut的漂亮原型，我添加了一些代码来使边框变圆。

您必须从 Grid 声明中删除“Background”属性，并在 Grid 声明和第一个 TextBlock 声明之间添加以下行：

```
<Border
    x:Name="back"
    CornerRadius="3,3,3,3"
    BorderThickness="1"
    BorderBrush="#FFC0CCD9"
    >
    <Rectangle Fill="#FFC0CCD9"/>
</Border> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T03:02:39.310

好吧，我开始着手完成同样的任务，但这些示例与生产代码相比有点不足。例如，如果您将文本放入控件（如 On/Off 或文本的本地化版本）会发生什么情况，答案是您必须定义控件的大小，因为在呈现控件后您无法修改动画或模板触发器。这为您提供了一种万能的解决方案，该解决方案不适用于本地化文本。

我的解决方案是使用控件的 Loaded 事件和 FrameworkElementFactory 类为控件动态创建模板。我不得不说这很复杂，但可以实现。简单地说，在您的代码中，按照描述创建一个模板，为您的开/关文本设置依赖属性，使用文本度量来确定控件的宽度、高度和动画值。

很抱歉，我无法发布解决方案，因为它现在属于 Avanquest。:(

在 SystemSuite 和 Fix-It 12 中查找它。

# c# - C#：从 KeyEventArgs 的 KeyData 中获取正确的按键

> ID：865774
> 
> 赞同：4
> 
> 时间：2009-05-14T21:08:47.010
> 
> 标签：c#, enums, enum-flags, keyeventargs

我正在捕获一个`KeyDown`事件，我需要能够检查当前按下的键是否是：`Ctrl`++ ？`Shift``M`

* * *

我知道我需要使用`e.KeyData`from `KeyEventArgs`、`Keys`enum 以及带有 Enum Flags 和 bits 的东西，但我不确定如何检查组合。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T21:12:55.207

您需要使用 KeyEventArgs 类的[Modifiers](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.modifiers.aspx)属性。

就像是：

```
//asumming e is of type KeyEventArgs (such as it is 
// on a KeyDown event handler
// ..
bool ctrlShiftM; //will be true if the combination Ctrl + Shift + M is pressed, false otherwise

ctrlShiftM = ((e.KeyCode == Keys.M) &&               // test for M pressed
              ((e.Modifiers & Keys.Shift) != 0) &&   // test for Shift modifier
              ((e.Modifiers & Keys.Control) != 0));  // test for Ctrl modifier
if (ctrlShiftM == true)
{
    Console.WriteLine("[Ctrl] + [Shift] + M was pressed");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-22T03:01:39.073

我认为最容易使用这个：

`if(e.KeyData == (Keys.Control | Keys.G))`

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-14T21:18:16.613

您可以使用类似于以下的技术进行检查：

```
if(Control.ModifierKeys == Keys.Control && Control.ModifierKeys == Keys.Shift) 
```

这与正常的密钥检查相结合将为您提供您寻求的答案。

# iphone - 了解目标 c 枚举声明

> ID：865776
> 
> 赞同：2
> 
> 时间：2009-05-14T21:08:55.107
> 
> 标签：iphone, c, objective-c, enums

来自 iPhone UIControl

```
UIControlEventAllTouchEvents      = 0x00000FFF,
UIControlEventAllEditingEvents    = 0x000F0000,
UIControlEventApplicationReserved = 0x0F000000,
UIControlEventSystemReserved      = 0xF0000000,
UIControlEventAllEvents           = 0xFFFFFFFF 
```

现在我假设 UIControlEventApplication 是我可以用来指定自定义控件事件的“范围”，但我不知道如何正确地做到这一点。只有当我分配 0xF0000000 时，控制事件才会正确触发。如果我分配其他任何内容（0xF0000001），则控制事件会在不应该触发时触发。

一些澄清：

```
enum {
    UIBPMPickerControlEventBeginUpdate = 0x0F000000,
    UIBPMPickerControlEventEndUpdate = // Which value do I use here?

}; 
```

我假设它是一个范围是基于文档的。其中说：

> 我假设这是因为文档说：一系列可供应用程序使用的控制事件值。

谁能帮我理解 UIControl 中使用的枚举声明的类型？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T22:00:29.037

我认为 0x0F000000 是您可以用来创建自己的控制事件的 4 位。

```
0x0F000000 = 00001111 00000000 00000000 00000000 
```

所以任何组合：

```
0x00000001<<27 = 00001000 00000000 00000000 00000000
0x00000001<<26 = 00000100 00000000 00000000 00000000
0x00000001<<25 = 00000010 00000000 00000000 00000000
0x00000001<<24 = 00000001 00000000 00000000 00000000 
```

您当然可以将这些 OR 一起创建新的：

```
0x00000001<<24 | 0x00000001<<25 = 00000011 00000000 00000000 00000000 
```

所以在你的例子中：

```
enum {
    UIBPMPickerControlEventBeginUpdate = 0x00000001<<24,
    UIBPMPickerControlEventEndUpdate = 0x00000001<<25, ...
}; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-15T08:30:16.183

要使用枚举，您只需执行按位运算：

```
UIControlEventAllEditingEvents | UIControlEventApplicationReserved | UIControlEventApplicationReserved 
```

# java - 命名枚举类型

> ID：865780
> 
> 赞同：5
> 
> 时间：2009-05-14T21:09:26.663
> 
> 标签：java, enums, naming

如果你有一组相关的词（例如 Row & Column 或 On & Off），你如何找到描述这些词的集合词？具体来说，你如何命名一个枚举？

如果我有“红色”、“绿色”和“蓝色”，一个合理的枚举名称可能是“颜色”。“On”和“Off”的值可能有一个合理的枚举名称“Power”。但是如何命名可以具有“行”或“列”值的枚举？

* * *

“你如何命名行或列枚举？”的几个很好的答案。-笛卡尔和IndexType。

寻找一般的集体词怎么样 - 那里有任何资源，还是你只需要擅长英语/知道很多词？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T21:17:00.127

尝试使用指示枚举用途的名称，例如

```
public enum CountMethod 
{
    Row,
    Column
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T21:51:03.023

有一个名为 WordNet 的软件，它基本上将每个英语单词分类到一个复杂的类层次结构中，并为它构建了一个软件，它可以接收两个单词并返回它们最早的公共超类（wordnet 语言中的上位词）。

在这种情况下，查询单词 red 会返回类似

```
red, redness
   => chromatic color, chromatic colour, spectral color, spectral colour
       => color, colour, coloring, colouring
           => visual property
               => property
                   => attribute
                       => abstraction, abstract entity
                           => entity 
```

查询蓝色给出

```
blue, blueness
   => chromatic color, chromatic colour, spectral color, spectral colour
       => color, colour, coloring, colouring
           => visual property
               => property
                   => attribute
                       => abstraction, abstract entity
                           => entity 
```

所以你知道，描述红色或蓝色最准确的方法是“彩色”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T21:12:45.113

对于 (Row | Colum)，我通常使用 'IndexType' 或类似的东西。正如我所见，行或列是同一数据结构中的两个不同索引。

我发现自己主要在编写基于表的数据结构时使用它. 然后，要执行特定于行或列的操作，您只需使用要使用的特定索引类型调用通用操作。

如果将其范围限定为一个类，则效果最好

```
Table.IndexType or Grid.IndexType (etc.) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T21:14:06.310

我首先想到的是“笛卡尔”。如在

```
public enum Cartesian
{
   Row, Column
} 
```

这背后的原因是因为行/列最接近地表明了网格系统的笛卡尔坐标。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T21:30:58.593

良好的英语词汇知识会对此有所帮助，但该语言中有大量的集体名词，即使是大多数以母语为母语的人也完全不知道。例如，有多少人恰好知道乌鸦的集体名词是“谋杀”？Sting 在他的歌曲“All This Time...”中使用了这个词，顺便说一句。

我最初建议笛卡尔坐标系是因为数学中类似于笛卡尔坐标系。辅助问题，关于集体词，本身就很有趣，所以为了任何可能想要了解这个范围的人的利益，来自维基百科：

[来自 AH 的集体名词](http://en.wikipedia.org/wiki/List_of_collective_nouns_by_subject_A-H)

[来自 IZ 的集体名词](http://en.wikipedia.org/wiki/List_of_collective_nouns_by_subject_I-Z)

也许那里有一些东西可能会触发一个好的枚举名称！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T21:36:36.660

考虑如何使用它。您要描述哪些属性或属性？

您选择的术语应该反映这些值的实际使用。对于 API 的用户来说，它应该是自然的，并且在某种程度上是可以猜测的。

例如，这些可能非常好：

```
widget.IndexMethod = IndexMethod.Row
widget.CountBy = CountMethod.Column 
```

按照同样的思路，我认为`Cartesian`在大多数情况下这将是一个糟糕的选择。笛卡尔既不自然也不可猜测，除非您正在处理技术图形功能或其他东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T21:36:45.663

另一种可能：

```
public enum Mapping
{
   Row, Column
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T21:20:56.310

您需要一个描述枚举中各个元素的名称。例如，您的 Row、Column 示例或两个笛卡尔元素，因此笛卡尔将是一个好名字。如果您有一个硬件商店的零件列表作为枚举，那么它的好名称将是 HardwareStoreParts 等。如果您有一个诸如 之类的枚举`shoes, graphs, elephants, blue, pluto, Martha Stewart`，那么您做错了什么。如果您想不出项目的术语，那么您可能正试图强制枚举适合它不适合的东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-14T22:15:37.363

我尝试想出一个在实际使用枚举时最有意义的名称。根据上下文可能类似于：

```
Table.ROW 
```

或者一些相当不同的东西，比如：

```
SortMode.ROW 
```

# iphone - 在可可的viewdownload方法中更改子类中的uitablelview属性？

> ID：865782
> 
> 赞同：0
> 
> 时间：2009-05-14T21:09:40.157
> 
> 标签：iphone, cocoa-touch, uitableview

我一直在关注一个从 uiviewcontroller 操作 uitableview 以生成样式精美的单元格的教程。

我想知道是否可以对子类 uitablewcontroller 而不是 uiviewcontroller 的类做同样的事情。用户使用如下代码：

```
 tableView.rowHeight = 50;
tableView.backgroundColor = [UIColor clearColor]; 
```

在 viewdidload 方法中。我想在 uitableview 子类中做同样的事情。我试着做

```
 self.rowHeight = 50; 
```

但这没有用。有谁知道我可以如何实现这个？

太感谢了！

这是实际的教程网站：[http ://blog.atrexis.com/index.cfm/2009/1/6/iPhone--Customize-the-UITableCellView](http://blog.atrexis.com/index.cfm/2009/1/6/iPhone--Customize-the-UITableCellView)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T21:16:13.480

Cocoa 设计模式鼓励使用控制器对象来配置视图，但没有理由不能像您所描述的那样进行子类化，特别是如果您需要添加无法以任何其他方式完成的功能。您可以按照您描述的方式使用属性和方法，因此其他地方存在问题。你用什么方法来分配行高？您是否检查了调试器以确保您的子类被分配而不是常规表视图？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T08:37:08.057

UITableViewController 是 UIViewController 的子类。唯一的区别是它符合 UITableViewDelegateDataSource 和 UITableViewDelegate 协议，并且它有一个额外的实例变量：tablview。

在 viewDidLoad 中，您可以设置任何您喜欢的表格属性，样式除外（样式必须在初始化程序或 IB 中设置）

```
- (void)viewDidLoad{

   [[self tableView] setRowHeight:kCellHeight];
   [[self tableView] setTableHeaderView:myView];

//etc...

} 
```

# c++ - 为什么我的#includes 的顺序很重要？(C++)

> ID：865785
> 
> 赞同：2
> 
> 时间：2009-05-14T21:10:17.037
> 
> 标签：c++, header, include

我创建了一个名为“list_dec.h”的头文件，将其放在文件夹“C:\Headers”中，并将我的编译器设置为包含来自“C:\Headers”的文件，所以现在我可以执行以下操作

```
#include<list_dec.h>
int main(){return(0);} 
```

但是当我尝试做类似的事情时

```
#include<iostream>
#include<list_dec.h>
int main(){return(0);} 
```

我收到一个错误（不是什么具体的，只是“list_dec.h”中的一大串语法错误，我知道这不是真的，因为我已经能够将它编译为 main.cpp 文件和 .h文件在一个单独的项目中）。但是，当我更改订单时，“list_dec.h”位于顶部：

```
#include<list_dec.h>
#include<iostream>
int main(){return(0);} 
```

所有错误都消失了。那么为什么错误的顺序很重要呢？

注意：据我所知，当我对所有头文件使用“list_dec.h”时会发生这种情况，但我绝对肯定它出现在的文件是：

```
#include<iostream>
#include<vector>
#include<time.h>
#include<stdlib.h> 
```

编辑：这些是当“list_dec.h”低于任何其他标题时我得到的错误：

```
c:\headers\list_dec.h(14) : error C2143: syntax error : missing ')' before 'constant'
        c:\headers\list_dec.h(51) : see reference to class template instantiation 'list<T,limit>' being compiled
c:\headers\list_dec.h(14) : error C2143: syntax error : missing ';' before 'constant'
c:\headers\list_dec.h(14) : error C2059: syntax error : ')'
c:\headers\list_dec.h(14) : error C2238: unexpected token(s) preceding ';'
c:\headers\list_dec.h(69) : warning C4346: 'list<T,limit>::{ctor}' : dependent name is not a type
        prefix with 'typename' to indicate a type
c:\headers\list_dec.h(69) : error C2143: syntax error : missing ')' before 'constant'
c:\headers\list_dec.h(69) : error C2143: syntax error : missing ';' before 'constant'
c:\headers\list_dec.h(69) : error C2988: unrecognizable template declaration/definition
c:\headers\list_dec.h(69) : error C2059: syntax error : 'constant'
c:\headers\list_dec.h(69) : error C2059: syntax error : ')'
c:\headers\list_dec.h(78) : error C2065: 'T' : undeclared identifier
c:\headers\list_dec.h(78) : error C2065: 'limit' : undeclared identifier
c:\headers\list_dec.h(78) : error C2065: 'T' : undeclared identifier
c:\headers\list_dec.h(78) : error C2065: 'limit' : undeclared identifier
c:\headers\list_dec.h(79) : error C2143: syntax error : missing ';' before '{'
c:\headers\list_dec.h(79) : error C2447: '{' : missing function header (old-style formal list?) 
```

如果有帮助，这些是错误中提到的行（14、69、78 和 79）：

第 14 行： `list(const T& NULL); (A constructor for "list" class)`

第 69 行： `inline list<T, limit>::list(const T& NULL): (Definition for the constructor, also, the colon at the end is intentional, It part of the definion ie: void x(int n): VAR(n).)`

第 78 行： `inline list<T, limit>::list(const list<T, limit>& lst) (def for the copy constructor)`

第 79 行：`{ (the begining of the list-copy contructor)`

并且很多人希望看到“list_dec.h”的开头：

```
template<class T, size_t limit>
class list 
```

注意：这些不是第一行，但它们是我认为问题所在，它们之前的行只是一个称为“err”的枚举。

编辑：请注意，“list_dec.h”不包含包含、定义、ifdef 或任何以“#”开头的内容。除了枚举，它只包含“list”类声明和“list”类成员函数定义。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-14T21:15:08.490

一般来说，它不应该，但是可能存在冲突的符号定义或预处理器宏，最终使编译器感到困惑。尝试通过从冲突的标题中删除部分和包含来缩小问题的大小，直到您可以看到导致它的原因。

为了响应您发布的错误消息，该符号`NULL`通常被实现为数字 0 的预处理器宏。这样您就可以轻松地将其用作空指针。因此：

```
list(const T& NULL); 
```

预处理器可以将其转换为以下语法错误：

```
list(const T& 0); 
```

将参数的名称更改为`NULL`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T21:38:00.900

注意这里：

`Line 14: list(const T& NULL); (A constructor for "list" class)`

`NULL`是标准宏的名称 - 当在 list_dec.h 之前包含标准头文件时，它很可能会导致`NULL`被定义，这反过来会导致您的代码在编译器中看起来像这样：

`list(const T& 0);`

上面的常量`0`使 C++ 行格式错误。您可以通过指示编译器生成预处理输出文件来获得更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T21:15:17.710

大概 list_dec.h 正在运行一个宏，该宏定义在其他标头（或它们依次包含的某些标头）中——如果没有看到第一条错误消息和 list_dec.h 的相关部分，很难说是哪个！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T21:15:51.157

实际的错误会提供更具体的线索，这意味着您的包含文件中有一些东西正在搞砸下一个的扫描。最常见的事情是某种 unclude #-directive，比如`#if`缺少它的`#endif`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T21:16:00.347

如果错误本质上是随机的，则可能是缺少分号。编译器通常会停止，但有时你会“幸运”。

否则，名称或定义冲突。例如，您有任何名为 std 的东西吗？

# asp.net - 在 VS 2008 中解锁 asp.net mvc 模板

> ID：865808
> 
> 赞同：0
> 
> 时间：2009-05-14T21:14:08.573
> 
> 标签：asp.net, asp.net-mvc, visual-studio

好的，所以我通过 Web 平台安装程序下载了 asp.net mvc。重新启动机器并启动 VS 2008 express。瞧，没有可以设置 mvc 项目的网站/项目模板。我做了一些研究，发现它们不会出现在快速版本中。没关系 - 我也有团队套件版本，所以我安装了它并希望模板出现。他们没有，所以我重新安装了mvc，他们仍然不会出现。

我讨厌开发的这一部分——我只是想给工具命名——我做错了什么——为什么模板不显示？我现在似乎无法卸载 mvc 并重新安装只是告诉我它已经安装了......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T21:44:02.603

如果您安装了 asp.net mvc 并且在 Visual Studio 中看不到模板，您应该尝试运行管理命令提示符并运行 devenv - setup 以便可以注册模板。

c:\Windows\system32>cd "C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE"

C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE>devenv - 设置

这应该有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:17:13.883

你确定吗？我想，但它必须是 .NET 3.5 并且它是来自新项目对话框而不是通过新网站对话框的 Web 应用程序。烦人但唉！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:21:30.037

如果您在 mvc*之后*安装了 Team Suite ，它将看不到模板。尝试重新安装 MVC，它很轻，应该不会花很长时间。

# java - 是否可以从部署在 JBoss 容器中的所有 .war 文件中读取属性文件

> ID：865819
> 
> 赞同：2
> 
> 时间：2009-05-14T21:17:13.307
> 
> 标签：java, jsp, maven-2, jboss, war

我已经设法将 .war 部署到包含并读取位于 /META-INF/groupid-dir/artifactid-dir/ 下的 pom.properties 的 Jboss Web 容器

为了访问该文件，我在同一战争中的 JSP 中使用了以下代码：

```
ServletContext servletContext = getServletConfig().getServletContext(); 
InputStream in = servletContext.getResourceAsStream("META-INF/maven/groupid-dir/artifactid-dir/pom.properties"); 
```

这工作得很好。但我希望能够从容器中部署的所有 .war 动态读取 pom.propertes。这是可能的还是我只能访问我的 jsp 的一个战争持有者的上下文？

-mb

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T14:33:43.317

您可能需要做一些棘手的事情，比如通过 JBoss MBean。我意识到这很模糊，但请考虑研究这种方法。这是关于如何从 JBoss 中的应用程序获取 MBean 服务器的链接（添加 http://）www.jboss.org/community/wiki/FindMBeanServer（Stackoverflow 阻止我粘贴链接）。我想您可以找到 Jboss Web mbean，剥离所有 Web 应用程序 mbean，然后向每个请求其类加载器，然后继续执行您已经提到的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-23T21:51:31.210

我不认为阅读 zip 或使用 jboss mbean 是正确的方法。我认为这并不棘手，并且您使用`ServletContext.getResourceAsStream`.

您可能可以使用`ServletContext.getResourcePaths`，但似乎多次使用来识别子目录 groupid 和 artifactid。就像是

```
servletContext.getResourceAsStream(servletContext.getResourcePaths(
    (String) servletContext.getResourcePaths("/META-INF/maven/")
               .iterator().next())
  .iterator().next() + "pom.properties") 
```

或者

```
servletContext.getResourceAsStream(servletContext.getResourcePaths(
    (String) servletContext.getResourcePaths("/META-INF/maven/")
               .iterator().next())
  .iterator().next() + "pom.xml") 
```

对于 pom.xml

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T12:14:38.423

如果 WAR 文件被分解为文件夹，您应该可以使用

> String basePath=getServletContext().getRealPath("/");

如果 WAR 文件为存档格式，此方法可能不起作用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-16T08:42:54.387

您只能在当前类路径中查找资源。Web 容器的正常操作是为每个已部署的工件创建特定的类路径，而无需访问容器中部署的其他工件。

这对于避免使用 foo-1.0.jar 的工件 A 避免意外使用与工件 B 一起部署的 foo-0.9.jar 非常重要。

因此，您需要向容器寻求帮助。这反过来意味着您需要编写容器特定的代码来执行此操作。这将使您依赖供应商——您可能不希望这样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T21:33:35.093

基本上，您的应用程序与 JBoss 容器在同一台机器上运行，因此应该可以访问本地文件系统上的文件，就像您访问自己的 .properties 文件一样。我不熟悉任何应该阻止你这样做的东西。

如果要访问war 文件*中*的文件，则需要使用java.util.zip 包，因为war 文件当然是普通的zip 文件。只是一个善意的提醒。

# c# - 幻数 - 从配置文件中读取与全局空间相同？不利于单元测试？

> ID：865821
> 
> 赞同：0
> 
> 时间：2009-05-14T21:17:21.310
> 
> 标签：c#, unit-testing

考虑以下类：

```
class Something : ISomething {

    public void DoesSomething(int x) {
        if (x == 0) {
            x = 1;
        }
    }
} 
```

我当然想删除这个幻数——我的单元测试通过了等等……但我想重构这个可怕的幻数。

我正在使用 C#，但我想这个问题很笼统。从配置文件（xml 文件）读取是通过以下方式完成的：

```
ConfigurationManager.AppSettings["MyOldMagicNumber"]... 
```

当然，这将是一个需要测试的草皮。我可以轻松地在这个类中创建一个标记为虚拟的私有函数。其目的是封装上述代码。这将允许我在我的单元测试中访问以覆盖并插入我自己的值。

我的问题是——

我这样做是不是很糟糕？见标题。

**编辑：**

这是针对游戏的 - 因此，在开发过程中，值很可能会经常更改，并且重新构建将是一件苦差事。我应该提到，上面的代码是通用的，我这样做是为了让问题尽可能简单。不过有点上下文 - '0' 是游戏区域的界限。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T21:25:00.963

你为什么不为此创建一个界面

```
public interface IApplicationSettings {
 int MyOldMagicNumber { get; }
} 
```

然后有两种实现，一种用于从配置文件中读取的生产，另一种用于单元测试。

```
public class ApplicationSettings : IApplicationSettings {
 public int MyOldMagicNumber { 
   get { return ConfigurationManager.AppSettings["MyOldMagicNumber"]; }
  }
}

public class FakeApplicationSettings : IApplicationSettings {
 public int MyOldMagicNumber { 
   get { return 87; /*Or whatever you want :) */ }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T21:23:30.407

您真的需要在不重新编译程序的情况下更改这些值吗？如果不是，我认为你应该避免将它放在你的配置文件中，否则你最终会在 xml 中编程；）

在这种情况下，使用常量有利于可读性：

```
class Something : ISomething {

    public const int Zero = 0;
    public const int One = 1;

    public void DoesSomething(int x) {
        if (x == Zero) {
            x = One;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T21:30:49.187

如果你在玩游戏，我肯定会把它放在配置文件中。这是因为您可能（将）想要尝试一组不同的值。将它放在配置文件中意味着您可以换出文件并尝试新的数字，而无需修改“引擎”。您甚至可能会发现自己在配置中定义了每个游戏生物的属性/值，这没关系！

# sql - SQL（任何）请求了解查询优化

> ID：865824
> 
> 赞同：0
> 
> 时间：2009-05-14T21:17:57.987
> 
> 标签：sql, optimization, query-optimization, sql-optimization

由于大量信息被连接在一起，我的查询特别慢。但是，我需要以 id in 的形式添加 where 子句（从表中选择 id）。

我想知道以下是否有任何收获，更紧迫的是，它是否会给出预期的结果。

```
select a.* from a where a.id in (select id from b where b.id = a.id) 
```

作为替代方案：

```
select a.* from a where a.id in (select id from b) 
```

更新：MySQL 不能更具体，抱歉表 a 实际上是 7 个不同表之间的连接。* 用于示例

编辑，b 没有被选中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T21:27:56.260

您列出的两个查询都相当于：

```
select a.* 
from a 
inner join b on b.id = a.id 
```

几乎所有的优化器都会以同样的方式执行它们。

你可以发布一个真正的执行计划，这里的某个人可能会给你一种加快速度的方法。如果您指定您正在使用的数据库服务器，它会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T22:21:04.807

您的问题是关于这两者之间的区别：

```
select a.* from a where a.id in (select id from b where b.id = a.id)

select a.* from a where a.id in (select id from b) 
```

前者是*相关*子查询。它可能会导致 MySQL 对`a`.

后者是一个*不相关的*子查询。MySQL 应该能够执行一次并缓存结果，以便与`a`.

我会使用后者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:21:52.750

YMMV，但我经常发现使用 EXISTS 而不是 IN 可以使查询运行得更快。

```
SELECT a.* FROM a WHERE EXISTS (SELECT 1 FROM b WHERE b.id = a.id) 
```

当然，如果不查看查询的其余部分和上下文，这可能不会使查询变得更快。

JOINing 可能是一个更可取的选择，但如果 a.id 在 b 的 id 列中出现多次，您将不得不在其中抛出一个 DISTINCT，并且您很可能会在优化方面倒退。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T21:22:13.247

我永远不会使用这样的子查询。加入会快得多。

```
select a.*
from a 
join b on a.id = b.id 
```

当然也不要使用 select * （尤其是在进行连接时永远不要使用它，因为至少有一个字段重复），它会浪费网络资源来发送不需要的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T21:23:33.603

你看过执行计划吗？

怎么样

```
select a.* 
from a 
inner join b
on a.id = b.id 
```

大概 id 字段是主键？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T21:32:52.147

```
Select a.* from a
inner join (Select distinct id from b) c
on a.ID = c.AssetID 
```

我尝试了所有 3 个版本，它们的运行情况大致相同。执行计划相同（内连接，IN（子查询中有无where子句），Exists）

由于您没有从 B 中选择任何其他字段，因此我更喜欢使用 Where IN(Select...) 任何人都会查看查询并知道您要做什么（仅在 b 中的 if 中显示）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T21:50:49.637

您的问题很可能在“a”中的七个表中

使 FROM 表包含“a.id” 进行下一个连接：inner join b on a.id = b.id

然后加入其他六个表。

如果您需要真正的帮助，您确实需要显示整个查询、列出所有索引以及每个表的大致行数

# eclipse - Eclipse 中的通用代码片段或模板

> ID：865830
> 
> 赞同：3
> 
> 时间：2009-05-14T21:19:13.240
> 
> 标签：eclipse, templates, code-snippets

在使用 Textmate 进行多年的开发后，我目前正在评估 eclipse。我在 Eclipse 中错过并且找不到任何解决方案的是某种通用模板：

我将 PDT 用于我的 JavaScript 和 PHP 开发，它支持代码模板。但是，在我的项目中，我也在编写大量的 shell 脚本、yml 配置文件、xml 文件、gnu make 脚本等。我正在使用通用语法（类似于 robodoc）为所有这些脚本编写源文档，当您可以使用模板插入文档块时，您可以节省很多时间。然而，除了 PDT 之外，并不是所有的编辑器插件都支持模板。

是否有一些通用的方法可以在 Eclipse 中存储代码片段/模板，这将适用于所有编辑器插件？我认为应该可以使用 eclipse monkey 来实现这样的功能——但是，monkey 的开发似乎停止了？

我正在使用 Eclipse 3.4.0。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-13T14:03:33.427

如果您安装了 Web 工具 (WTP) 插件，您应该有一个 Snippets 视图，它是一个独立于编辑器的地方，用于收集可重用的代码片段。您可以在其中创建和放置您的片段，并可以使用“抽屉”将它们分开。双击或拖动片段项目会将其插入活动编辑器中。

Web 工具用户指南[有一个](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.wst.sse.doc.user/topics/tsrcedt026.html)关于此视图的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-13T03:37:11.080

你为什么不试试 Snip2Code 插件？它是一个通用的代码片段管理器平台，您可以将其添加到 Eclipse 中，并将您的代码片段存储在云中，这样您在重新安装 Eclipse 或移动到另一台机器时就不必同步它们。

[http://www.snip2code.com/Static/Downloads](http://www.snip2code.com/Static/Downloads)

# jquery - jquery中的remove事件取消了慢速隐藏事件

> ID：865833
> 
> 赞同：1
> 
> 时间：2009-05-14T21:19:27.593
> 
> 标签：jquery, events, callback, hide

我有一个关于如何保持一个事件执行一个动作而不被下一行代码取消的问题在这种情况下，我不希望删除动作取消隐藏行为

也许，这属于回调类别，但我不确定在这种情况下是否可以使用它

下面的代码已经驻留在加载方法的回调中

这是代码

```
$(".frmtbnote:last").submit(function () {
    $(this).parents(".paneltbnote").animate({ opacity: 'hide' }, "slow");
    $(this).parents(".wrappertbnote").remove();

    $.post("tbnotesact.php", {
        noteid: $tbnoteid,
        action: "remove",
        time: timestamp
    }, function (xml) {
        // do something
    });
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T21:23:22.277

我相信回调是您所追求的

```
$(this).parents(".paneltbnote").animate({ opacity: 'hide' }, "slow", function(){
    $(this).parents(".wrappertbnote").remove();
  }
); 
```

# regex - 如何使用带有 C# 正则表达式的白名单拒绝名称（人员和公司）？

> ID：865837
> 
> 赞同：2
> 
> 时间：2009-05-14T21:20:19.960
> 
> 标签：regex, xss

我使用 C# 正则表达式在 Web 输入上实现允许字符的白名单时遇到了一些问题。我试图避免 SQL 注入和 XSS 攻击。我读过允许字符的白名单是要走的路。

输入是人名和公司名。

其中一些问题是：

1.  有和号的公司名称。比如“吉姆父子”。& 号很重要，但也有风险。

2.  名称中的 Unicode 字符（例如，我们有亚洲客户），使用他们的字符集输入他们的名字。我需要将所有这些都列入白名单。

3.  公司名称可以有各种斜线，如“S/A”和“S\A”。这些有风险吗？

在看到数据库中已经存在的所有数据（并且由新用户输入）之后，我发现自己想要允许几乎每个字符。

对于处理这些（和其他）问题的良好白名单有什么建议吗？

注意：这是一个遗留系统，所以我无法控制所有代码。我希望通过防止不良数据首先进入系统来减少攻击次数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T21:47:39.317

[这个 SO 线程](https://stackoverflow.com/questions/1973/what-is-the-best-way-to-avoid-sql-injection-attacks)对保护自己免受注入攻击有很多很好的讨论。

简而言之：

1.  尽可能过滤您的输入
2.  使用基于框架的方法转义字符串
3.  参数化你的 sql 语句

在您的情况下，您可以将名称字段限制为一个小字符集。公司领域将更加困难，您需要考虑并平衡用户对进入自由的需求与您对站点安全的需求。正如其他人所说，尝试编写自己的自定义卫生方法既棘手又冒险。保持简单并通过您的体系结构保护自己——不要简单地依赖字符串是“安全的”，即使在净化之后也是如此。

编辑：

澄清一下——如果你想建立一个白名单，这不是社区可以分发的，因为它完全取决于你想要的数据。但是让我们看一个正则表达式白名单的例子，也许是名字。假设我已将 AZ、az 和 space 列入白名单。

```
Regex reWhiteList = new Regex("^[A-Za-z ]+$") 
```

这将检查整个字符串是否由这些字符组成。请注意，带有数字、句点、引号或其他任何内容的字符串与此正则表达式不匹配，因此会导致白名单失败。

```
if (reWhiteList.IsMatch(strInput))
   // it's ok, proceed to step 2
else
   // it's not ok, inform user they've entered invalid characters and try again 
```

希望这有助于更多！对于名称和公司名称，您将很难开发出一个严格的模式来检查，但您可以做一个简单的允许字符列表，正如我在这里展示的那样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T21:34:14.747

不要尝试清理名称，尤其是使用正则表达式！

只需确保您正确转义值并将它们安全地保存在您的数据库中，并在以 HTML 呈现时将它们转义回来

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T21:23:17.597

公司名称中可能包含几乎任何类型的符号，所以我不知道这对你有多大的作用。我会专注于直接保护自己免受各种攻击，而不是希望你的琴弦“自然”安全。

（当然，它们可以有与号、冒号、分号、感叹号、连字符、百分号以及在许多情况下可能“不安全”的各种其他内容。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T03:25:35.277

为什么要过滤或正则表达式数据，甚至转义它，您应该使用绑定变量来访问数据库。

这样，客户可以输入类似：anything' OR 'x'='x

而且您的应用程序并不关心，因为您的 SQL 代码不会解析变量，因为它在您准备语句时没有设置。IE

```
'SELECT count(username) FROM usertable WHERE username = ? and password = ?' 
```

然后您使用这些变量集执行该代码。

这适用于 PHP、PERL、J2EE 应用程序等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T21:37:01.747

我认为编写自己的正则表达式不是一个好主意：这将非常困难。尝试利用 Web 框架的现有功能，网上有很多资源。如果您说 C#，我假设您使用的是 ASP.NET，请尝试以下文章： [如何：防止 ASP.NET 中的注入攻击](http://msdn.microsoft.com/en-us/library/bb355989.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T16:46:48.277

这是我当前的公司名称正则表达式白名单。这些字符之外的任何输入都会被拒绝：

```
"^[0-9\p{L} '\-\.,\/\&]{0,50}$" 
```

*   匹配任何 unicode “`\p{L}`字母”。因此，口音和亚洲字符被列入白名单。

*   这`\&`有点问题，因为它可能允许 javascript 特殊字符。

*   由于`\'`SQL 注入，如果不使用参数化查询，则会出现问题。

*   如果不使用参数化查询，`\-`则可能允许“--”，这也是 SQL 注入的可能性。

此外，它`\p{L}`不会在客户端工作，因此您不能在 ASP.NET 正则表达式验证器中使用它而不禁用客户端验证：
`EnableClientScript="False"`

# c++ - 带有 Alpha 通道的闪烁子窗口

> ID：865851
> 
> 赞同：2
> 
> 时间：2009-05-14T21:22:19.770
> 
> 标签：c++, windows, alphablending, flicker, doublebuffered

当绘制包含具有每像素 Alpha 通道的位图的子控件时，每当需要重绘它们时，我们就会得到相当多的闪烁。实际的混合工作正常。我找到了很多关于减少闪烁的信息（例如[这个问题](https://stackoverflow.com/questions/197948/reduce-flicker-with-gdi-and-c)或[这个网站](http://www.catch22.net/tuts/flicker)），但我似乎找不到任何特别适用于这种情况的信息。

例如，我有一个带有几个不同位图的按钮，这些位图根据按钮的状态进行了 alpha 混合和 blitted 到窗口。当它们的状态发生变化并且我需要绘制不同的位图时，我需要先重新绘制背景，否则它会与前一个状态位图留下的像素混合。这是我得到一些闪烁的地方，我偶尔会得到一些背景撕裂。

让顶级父窗口绘制位图背景而不是纯色，以及让子控件重叠的可能性使问题变得更加复杂；只是将基础颜色乘以孩子的位图是不可能的，就像使用`WS_CLIPCHILDREN`.

由于窗口有位图背景，我将返回`true`，`WM_ERASEBKGND`以避免绘制将被覆盖的颜色。

当然，双缓冲似乎可以解决所有这些问题，但我无法让它正常工作。我已经`WS_COMPOSITED`为顶级窗口和`WS_TRANSPARENT`子窗口设置了。当需要使用新位图重绘子窗口时，我遇到了一些问题（很可能是我不理解在这种情况下绘制顺序是如何工作的）：

*   如果我调用`InvalidateRect()`并传递子句柄，子窗口确实被重绘，但背景没有被重绘，因此像素相互叠加，混合在一起。
*   如果我调用`InvalidateRect()`并传入*父*句柄，矩形由子窗口的尺寸组成，则背景会被重绘，但子窗口不会。
*   如果我同时执行上述两项操作，那么背景和子窗口都会被重绘，它看起来完全符合我的要求——除了这样做，我设法让它再次*闪烁*（这不是这并不令人惊讶，因为这样调用两次似乎非常骇人听闻`InvalidateRect()`，因为我猜每次调用都可能导致缓冲区翻转，这违背了目的）。

我得出的结论是，我真的不明白我需要如何修改我的程序来处理双缓冲，或者双缓冲是否有助于解决这种情况。我觉得它肯定会，但我不太明白我需要如何修改东西才能让所有东西再次正常播放。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T22:13:56.277

你在使用 [分层窗口](http://msdn.microsoft.com/en-us/library/ms997507.aspx)吗？如果没有，也许试试看。

同样对于双缓冲[考虑这种技术](http://www.codeguru.com/cpp/misc/misc/flickerfreedrawing/article.php/c389)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T22:04:00.807

这可能完全不合时宜——我的 gui 时代是很久很久以前的事了......

但是你不能为你的不同状态预先计算混合吗？我假设您的按钮可以启用/禁用和向上/向下，所以只有 4 种组合。为什么不预先计算组合位图？

或者问题是已经组合的位图与现有状态的交互？

# c - printf C程序中的当前地址

> ID：865862
> 
> 赞同：12
> 
> 时间：2009-05-14T21:23:53.527
> 
> 标签：c, memory

想象一下，我有以下简单的 C 程序：

```
int main() {

int a=5, b= 6, c;
c = a +b; 
return 0;
} 
```

现在，我想知道表达式 c=a+b 的地址，即执行此加法的程序地址。有没有可能我可以使用 printf？沿线的东西：

```
int main() {

int a=5, b= 6, c;
printf("Address of printf instruction in memory: %x", current_address_pointer_or_something)
c = a +b; 
return 0;
} 
```

我知道如何使用 gdb 和 info line file.c:line 找到地址。但是，我应该知道我是否也可以直接使用 printf 执行此操作。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-14T21:31:17.907

在 gcc 中，您可以使用 && 运算符获取标签的地址。所以你可以这样做：

```
int main() 
{
    int a=5, b= 6, c;

    sum:
        c = a+b;

    printf("Address of sum label in memory: %p", &&sum);
    return 0;
} 
```

&&sum 的结果是跳转指令的目标，如果你做了`goto sum`. 因此，虽然在 C/C++ 中确实没有地址到行的一对一映射，但您仍然可以说“给我一个指向此代码的指针”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T21:30:33.807

Visual C++ 具有 _ReturnAddress 内在函数，可用于在此处获取一些信息。

例如：

```
__declspec(noinline) void PrintCurrentAddress()
{
    printf("%p", __ReturnAddress);
} 
```

这将为您提供一个接近您正在查看的表达式的地址。如果进行一些优化，例如尾部折叠，这将是不可靠的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T21:33:32.677

在 Visual Studio 2008 中测试：

```
int addr;
__asm
{
    call _here
    _here: pop eax
    ; eax now holds the PC.
    mov [addr], eax
}

printf("%x\n", addr); 
```

归功于[这个问题](https://stackoverflow.com/questions/599968/reading-program-counter-directly)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T01:28:12.673

这是另一种方法的草图：

假设您没有剥离调试符号，特别是您有源代码级符号调试器需要的地址表的行号，以便实现单步源代码行，在源代码行设置断点，等等。

大多数工具链都使用记录良好的调试数据格式，并且通常有实现大部分细节的帮助库。

考虑到这一点以及评估当前行号的预处理器宏的一些帮助`__LINE__`，应该可以编写一个查找任何源行地址的函数。

优点是不需要汇编，可以通过调用特定平台的调试信息库来实现可移植性，并且不需要直接操作堆栈或使用破坏CPU管道的技巧。

一个很大的缺点是它比任何基于直接读取程序计数器的方法都要慢。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T01:35:59.347

对于 x86：

```
int test()
{
    __asm {
        mov eax, [esp]
    }
}

__declspec(noinline) int main() // or whatever noinline feature your compiler has
{
    int a = 5;
    int aftertest;

    aftertest = test()+3; // aftertest = disasms to 89 45 F8 mov dword ptr [a],eax.

    printf("%i", a+9);
    printf("%x", test());
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T14:42:19.217

如果编译器有任何好处，则此添加发生在寄存器中，并且永远不会存储在内存中，至少不会以您的想法进行。实际上，一个好的编译器会看到您的程序什么都不做，在函数内操作值但从不在函数外的任何地方发送这些值会导致没有代码。

如果您要：

c = a+b; printf("%u\n",c);

然后，一个好的编译器也永远不会将该值 C 存储在内存中，它将保留在寄存器中，尽管它也取决于处理器。例如，如果该处理器的编译器使用堆栈将变量传递给函数，则 c 的值将使用寄存器计算（一个好的编译器会看到 C 始终为 11 并分配它）并且该值将被放入堆栈同时被发送到 printf 函数。自然地， printf 函数很可能由于其复杂性而需要在内存中临时存储（不能满足它需要在寄存器中执行的所有操作）。

我要去的地方是你的问题没有答案。它在很大程度上依赖于处理器、编译器等。没有通用的答案。我不得不想知道问题的根源是什么，如果您希望使用调试器进行探测，那么这不是要问的问题。

底线，反汇编您的程序并查看它，对于那天使用这些设置进行编译，您将能够看到编译器放置中间值的位置。即使编译器为变量分配了一个内存位置，也不意味着程序会将变量存储在该位置。这取决于优化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T01:17:48.097

我不知道细节，但应该有一种方法可以调用一个函数，然后可以在返回堆栈中爬取调用者的地址，然后复制并打印出来。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T02:20:14.670

在 i386 或 x86-64 上使用 gcc：

```
#include <stdio.h>

#define ADDRESS_HERE() ({ void *p; __asm__("1: mov 1b, %0" : "=r" (p)); p; })

int main(void) {
    printf("%p\n", ADDRESS_HERE());
    return 0;
} 
```

请注意，由于存在编译器优化，表达式的明显位置可能与其在原始源中的位置不对应。

与 &&foo 标签方法相比，使用此方法的优点是它不会更改函数的控制流图。它也不会像使用调用的方法那样破坏返回预测器单元 :) 另一方面，它非常依赖于架构......并且因为它不会干扰 CFG，所以不能保证跳转到有问题的地址根本没有任何意义。

# compiler-optimization - 30 GOTO 10 会一直到 10 吗？

> ID：865871
> 
> 赞同：1
> 
> 时间：2009-05-14T21:25:10.993
> 
> 标签：compiler-optimization

本着乔尔提到的[最新播客](https://blog.stackoverflow.com/2009/05/podcast-53/)的精神，他想要一些简单的问题和可能有趣的答案......

在我们今天必须编程的环境中，我们不能依赖语言语句的执行顺序。真的吗？我们应该担心吗？

30 GOTO 10 总是会转到 10 吗？*

*我没有故意使用 20 ;)

[编辑] 对于投票结束这个问题的四个人......

“运行时编译器使用分析信息来帮助优化正在编译的代码。JVM 被允许使用特定于执行的信息以生成更好的代码，这意味着在一个程序中编译方法 M 可能会生成与在一个程序中编译 M 不同的代码其他”

（来自 Java 并发实践，2006，Goetz 等人）

..看看“单态调用转换”

[编辑]

和另一个编辑，你的处理器被允许交换语句的执行顺序......

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-14T21:35:22.657

不，它不会。但它总是**表现得**好像它确实如此。编译器设计的基本规则之一是“好像”规则。你的编译器可以做它喜欢的任何改变，只要结果表现得*就像*你遵循了语言规则一样。

GOTO 10 可以决定跳转到其他位置，只要编译器可以保证它不会改变程序的结果。

所以不，它不应该让你担心。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-14T21:29:32.013

如果你有

```
40 COMEFROM 30 
```

在您的代码中的某处。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-14T21:47:49.210

![替代文字](https://imgs.xkcd.com/comics/goto.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T21:30:20.513

好吧，如果它不执行，它就不会执行，例如，如果有一个`20 GOTO 40`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T21:30:33.180

在 BASIC 中，是的。在其他语言中，它会产生编译错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T21:37:46.627

你想说什么？任何声称自己是程序员的人都应该知道（尤其是在您提示之后）这取决于第 10 行和第 20 行的内容，并且任何在 SO 上工作超过一周的人都应该意识到这个问题似乎并没有增加太多。

我们应该依靠代码完全按照我们的指示去做。如果我们告诉它`GOTO 10`在第 30 行，但也告诉它跳过第 30 行，当第 30 行被跳过时，我们不应该感到最惊讶。我们告诉程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T21:59:58.557

诚然，如果您考虑执行 BASIC 程序的多核 CPU，其中一个内核可能会意外错过 GOTO（提示：“TLB 错误”）并继续执行，就好像它不存在一样。

# flash - ActionScript 3.0 当前调用的函数，加上之前的所有函数

> ID：865876
> 
> 赞同：0
> 
> 时间：2009-05-14T21:27:32.050
> 
> 标签：flash, actionscript-3, addeventlistener

好吧，我不知道我是怎么做到的，可能 AS3 大神在我编码后滚动条正常工作时对我生气，没有错误。但我有一个非常奇怪的问题。我有三个不同的按钮，它们没有相互嵌套，并且它们具有用于调用函数的鼠标单击的事件侦听器。每当单击这 3 个按钮中的一个时，它都会调用它应该加上来自 swf 生命周期的所有先前的函数。我不知道这是怎么发生的，说实话我很震惊，我，我感到很震惊。这是怎么回事？与事件监听器有关吗？也许与 URLLoader 相关？我不知道，我已经追踪了每一步，但我一无所有，所以我把自己扔到更聪明的程序员面前，希望你们中的一位尊敬的先生和女士们知道我的意思

**文档类文件** [Pastie](http://pastie.org/478465)

```
package {

    import gs.TweenMax;
    import gs.easing.*;
    import flash.display.*;
    import flash.events.*;
    import flash.ui.Keyboard;
    import flash.net.*;
    import flash.external.ExternalInterface;
    import FullScreenScrollBar;

    public class Gessner extends MovieClip {

        //====================================Declare Variables================================//
        var objectsArray:Array = ["whatwedo_bkg", "whoweare_bkg", "howmuch_bkg", "needsome_bkg"];
        var images:Array = [];
        var instances:Array = [];
        var imageInstances:Array = [];
        var paginationButtons:Array =[];
        //=====================================================================================//

    private var xmlLoader:URLLoader = new URLLoader();
    private var xmlData:XML = new XML();

    //======================================================================================
    public function initXML(e:Event) {
    //======================================================================================
        var target:String = e.currentTarget.name;
        if (e.currentTarget.name == "recent_projects" || e.currentTarget.name == "whoweare") {
            xmlLoader.addEventListener(Event.COMPLETE, onCompleteXML);
            xmlLoader.load(new URLRequest("http://www.gessnerengineering.com/projects"));
        } else if (e.currentTarget.name == "our_staff") {
            xmlLoader.addEventListener(Event.COMPLETE, onCompleteXML);
            xmlLoader.load(new URLRequest("http://www.gessnerengineering.com/profiles"));
        }

        //========================================================================
         function onCompleteXML(e:Event):void {
        //========================================================================
            xmlData = new XML(e.currentTarget.data);
            makePagination();
            trace("onCompleteXML() target: " + target);
            if (target == "recent_projects" || target == "whoweare") {
                trace("loadProjectXML() got called from onCompleteXML();");
                loadProjectsXML(0, xmlData);
            } else if (target == "our_staff") {
                loadStaffXML(0, xmlData);
            }
        }

        //========================================================================
         function makePagination():void {
        //========================================================================
            var pages:Number;
            trace("makePagination() target: " + target);
            if (target == "recent_projects" || target == "whoweare") {
                pages = Math.ceil(xmlData.project.length() / 13);
            } else if (target == "our_staff") {
                pages = Math.ceil(xmlData.profile.length() / 13);
            }
            for (var i:Number = 0; i < pages; i++) {
                var tmp:pageNum = new pageNum();
                var startX:Number = -(((pages * 50) - 10) / 2);
                tmp.Id = i * 13;
                tmp.x = startX;
                startX += 50;
                tmp.y = 0;
                tmp.label.text = String(i+1);
                tmp.buttonMode = true;
                tmp.mouseChildren = false;
                tmp.useHandCursor = true;
                tmp.addEventListener(MouseEvent.CLICK, onChangePage);
                Gessner(root).pages.whoweare_bkg.pagination.addChild(tmp);
                paginationButtons.push(Gessner(root).pages.whoweare_bkg.pagination.getChildByName(tmp.name));
            }
        }

        //========================================================================
        function onChangePage (e:MouseEvent):void {
        //========================================================================
            if (target == "recent_projects" || target == "whoweare") {
                trace("loadProjectXML() got called from onChangePage();");
                loadProjectsXML(e.currentTarget.Id as Number, xmlData);
            } else {
                loadStaffXML(e.currentTarget.Id as Number, xmlData);
            }
        }
    }

    //======================================================================================
    public function loadProjectsXML(startNum:Number, xmlData:XML):void {
    //======================================================================================
        removeAll();
        var index:int = 1;
        var endNum:Number = startNum + 13;
        if (endNum > xmlData.project.length()) {
            endNum = xmlData.project.length();
            //trace("projectENDNUM" + endNum);
        }
        for(startNum; startNum < endNum; startNum++) {
            var instance:String = "cont" + index;
            var imageURL:String = "http://www.gessnerengineering.com/system/files/" + xmlData.project[startNum].assets.asset[0]["id"] + "/thumb/" + xmlData.project[startNum].assets.asset[0]["file-file-name"];

            loadImage(imageURL, instance);
            Gessner(root).pages.whoweare_bkg[instance].title.text = xmlData.project[startNum].name;
            Gessner(root).pages.whoweare_bkg[instance].description.text = xmlData.project[startNum].description;
            instances.push(instance);

            index++;
        }
    }

    //=======================================================================================
    public function loadStaffXML(startNum:Number, xmlData:XML):void {
    //=======================================================================================
        removeAll();
        var index:int = 1;
        var endNum:Number = startNum + 13;
        if (endNum > xmlData.profile.length()) {
            endNum = xmlData.profile.length();
            ////trace("endNUM" + endNum);
        }
        for(startNum; startNum < endNum; startNum++) {
            var instance:String = "cont" + index;
            var imageURL:String = "http://www.gessnerengineering.com/system/avatars/" + xmlData.profile[startNum]["id"] + "/thumb/" + xmlData.profile[startNum]["avatar-file-name"];

            loadImage(imageURL, instance);
            Gessner(root).pages.whoweare_bkg[instance].title.text = xmlData.profile[startNum]["user-id"];
            Gessner(root).pages.whoweare_bkg[instance].description.text = xmlData.profile[startNum]["bio"];
            instances.push(instance);
            index++;
        }
    }

    //=======================================================================================
    private function loadImage(imageURL:String, instance:String):void {
    //=======================================================================================
            var imageLoader:Loader = new Loader();
            var imageRequest = new URLRequest(imageURL);

            imageLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);
            imageLoader.load(imageRequest);

            function onComplete(e:Event) {
                var image:Bitmap = (Bitmap)(e.currentTarget.content);
                Gessner(root).pages.whoweare_bkg[instance].thumb.addChild(image);
                images.push(Gessner(root).pages.whoweare_bkg[instance].thumb.getChildByName(image.name));
                imageInstances.push(instance);
                //imageLoader.unload();
            }
    }

    //=======================================================================================
    private function removeAll():void {
    //=======================================================================================
        var lengthOfIndex:uint = instances.length;
        /*for each(var button:DisplayObject in paginationButtons) {
            Gessner(root).pages.whoweare_bkg.pagination.removeChild(button);
        }*/
        for (var i:uint = 0; i < lengthOfIndex; i++) {              
            Gessner(root).pages.whoweare_bkg[instances[i]]["title"].text = "";
            Gessner(root).pages.whoweare_bkg[instances[i]]["description"].text = "";
            try {
            Gessner(root).pages.whoweare_bkg[imageInstances[i]].thumb.removeChild(images[i]);
            } catch (ArgumentError) {
                //trace("error: " + images[i].name + "::" + instances[i]);
            }
        }
        paginationButtons.splice(0, paginationButtons.length);
        images.splice(0, lengthOfIndex);
        imageInstances.splice(0, lengthOfIndex);
        instances.splice(0, lengthOfIndex);         
    }
} 
```

**文档的时间线操作**

```
this.pages.whoweare_bkg.recent_projects.addEventListener(MouseEvent.CLICK, initXML);
this.pages.whoweare_bkg.our_staff.addEventListener(MouseEvent.CLICK, initXML);
this.whoweare.addEventListener(MouseEvent.CLICK, initXML); 
```

**输出** [馅饼](http://pastie.org/478460)

```
##first click
makePagination() target: whoweare
onCompleteXML() target: whoweare
loadProjectXML() got called from onCompleteXML();
projectENDNUM3

##second click
makePagination() target: whoweare
onCompleteXML() target: whoweare
loadProjectXML() got called from onCompleteXML();
projectENDNUM3
makePagination() target: recent_projects
onCompleteXML() target: recent_projects
loadProjectXML() got called from onCompleteXML();
projectENDNUM3

##third click
makePagination() target: whoweare
onCompleteXML() target: whoweare
loadProjectXML() got called from onCompleteXML();
projectENDNUM3
makePagination() target: recent_projects
onCompleteXML() target: recent_projects
loadProjectXML() got called from onCompleteXML();
projectENDNUM3
makePagination() target: recent_projects
onCompleteXML() target: recent_projects
loadProjectXML() got called from onCompleteXML();
projectENDNUM3

##fourth click
makePagination() target: whoweare
onCompleteXML() target: whoweare
loadProjectXML() got called from onCompleteXML();
projectENDNUM3
makePagination() target: recent_projects
onCompleteXML() target: recent_projects
loadProjectXML() got called from onCompleteXML();
projectENDNUM3
makePagination() target: recent_projects
onCompleteXML() target: recent_projects
loadProjectXML() got called from onCompleteXML();
projectENDNUM3
makePagination() target: recent_projects
onCompleteXML() target: recent_projects
loadProjectXML() got called from onCompleteXML();
projectENDNUM3

and so on and so on 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T21:37:26.643

我懂了。这部分在这里：

```
xmlLoader.addEventListener(Event.COMPLETE, onCompleteXML);
xmlLoader.load(new URLRequest("http://www.gessnerengineering.com/projects")); 
```

每次调用此代码时，都会向 xmlLoader 添加一个 NEW 事件侦听器。因此，您以后每次调用它时，它都会调用 onCompleteXML +1 次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T21:37:39.297

看起来您从未删除过事件侦听器-如果您想这样做的话。另外，您的目标变量是什么？我没有看到它的声明位置，您是要使用 e.currentTarget 还是什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T21:38:07.313

检查您在时间轴上正在做什么，并确保您在`stop()`某处有命令，并避免再次添加事件侦听器。

每次在时间轴上输入关键帧时，都会添加事件侦听器。所以我猜你要去一个不同的框架，然后回到添加事件侦听器的同一个框架。

# jquery - 在鼠标悬停时显示图标（或内容）

> ID：865891
> 
> 赞同：2
> 
> 时间：2009-05-14T21:30:00.937
> 
> 标签：jquery

在 Twitter 中，当您将鼠标悬停在消息上时，右侧会出现一个星号和一个回复图标。

同样，在 facebook 中，当您将鼠标悬停在更新上时，右侧会出现一个小的“隐藏”图标，同时提供一个小的上下文菜单。

我想在我的项目中对拖放手柄采用类似的方法。我能决定的是实现这个目标最有效的方法是什么。

是不是每次我将鼠标悬停在带有 id 的 div 上时，我是否只使用 .append() 或类似方法注入 html？还是我显示/隐藏已经存在的 html.. 还是有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T21:39:52.317

最快的解决方案是使用按钮/拖动手柄隐藏块，每当您将鼠标悬停在您的元素上时，您`.show()`就是那个 div 并相应地定位它（使用 css）

`.append()`'ing 并在每次鼠标悬停时删除 html 代码当然是可能的，但肯定会对性能产生一些影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T23:27:18.470

最近做了这样的事情，这里有一个扩展的例子，如果你想测试它，你需要获取 jquery、jquery ui 和我的[reset.css](http://simplicityphp.com/export/f6ef828384025e63841354581d779430099e5c5c/source/lib/simplicity/modules/admin/public/css/reset.css "重置.css")。悬停时，背景和边框会发生变化，并且会显示以前隐藏的图标。

```
 <html>
          <head>
              <link rel="stylesheet" href="css/reset.css" type="text/css" media="screen" />
              <link rel="stylesheet" href="css/smoothness/jquery-ui.css" type="text/css" media="screen" />

              <style type="text/css">
                  body {
                      font-family: sans-serif;
                      font-size: 13px;
                  }

                  p {
                      font-size: 1em;
                      line-height: 1.5em;
                      margin-bottom: 15px;
                  }                 
                  #items .item .buttons {
                      width: 16px;
                      display: none;
                      float: right;
                      background: transparant;
                  }

                  #items .item .buttons li {
                      height: 16px;
                      width: 16px;
                      margin: 1px 1px 0px 0px;
                      float:right;
                      cursor: pointer;
                  }         

                  #items .item {
                      width: 400px;
                      margin: 10px;
                      border: 1px dotted #fff;
                  }

                  #items .hover {
                      background: #ffe;
                      border: 1px dotted #ccc;
                  }

                  #items .item .contents {
                      margin: 20px 10px 10px 10px;
                  } 
              </style>

              <script src="js/jquery.js" type="text/javascript"></script>
              <script src="js/jquery-ui.js" type="text/javascript"></script>

              <script type="text/javascript">
                  $(function() {
                      $('#items .item').hover(
                          function() {
                              $(this).addClass('hover');
                              $(this).find('.buttons').show();
                          },
                          function() {
                              $(this).removeClass('hover');
                              $(this).find('.buttons').hide();
                          }
                      );

                      $('#items .item .buttons li').hover(
                          function() {
                              $(this).addClass('ui-state-hover');
                          },
                          function() {
                              $(this).removeClass('ui-state-hover');
                          }
                      );
                  });
              </script>

              <link
          </head>
          <body>
              <div id="items">
                  <div class="item">
                      <ul class="buttons">
                        <li class="delete ui-state-default ui-corner-all">
                          <span class="ui-icon ui-icon-close"/>
                        </li>
                        <li class="config ui-state-default ui-corner-all">
                          <span class="ui-icon ui-icon-wrench"/>
                        </li>
                        <li class="info ui-state-default ui-corner-all">
                          <span class="ui-icon ui-icon-info"/>
                        </li>
                      </ul>
                      <div class='contents'>
                          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque sit amet arcu ante. Suspendisse potenti. Praesent vel nisl urna, eu ultricies risus.</p> 
                          <p>Nulla eget mauris ac lectus tempor consectetur. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec et lacus ipsum.</p> 
                          <p>Donec rhoncus tincidunt magna, sit amet placerat nulla fringilla iaculis.</p>
                      </div>
                  </div>

                  <div class="item">
                      <ul class="buttons">
                        <li class="delete ui-state-default ui-corner-all">
                          <span class="ui-icon ui-icon-close"/>
                        </li>
                        <li class="config ui-state-default ui-corner-all">
                          <span class="ui-icon ui-icon-wrench"/>
                        </li>
                        <li class="info ui-state-default ui-corner-all">
                          <span class="ui-icon ui-icon-info"/>
                        </li>
                      </ul>
                      <div class='contents'>
                          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque sit amet arcu ante. Suspendisse potenti. Praesent vel nisl urna, eu ultricies risus.</p> 
                          <p>Nulla eget mauris ac lectus tempor consectetur. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec et lacus ipsum.</p> 
                          <p>Donec rhoncus tincidunt magna, sit amet placerat nulla fringilla iaculis.</p>
                      </div>
                  </div>
              </div>
          </body>
      </html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T21:32:38.217

如果您想显示漂亮的工具提示，有一个更好的方法 -[工具提示插件](http://jquery.bassistance.de/tooltip/demo/)

您总是可以将内容附加到 DOM，然后在悬停时删除，这确实有效。我认为这取决于您计划显示的内容，如果是图像，那么我很想在页面加载时隐藏它们，然后在悬停时显示，但如果它只是一段文本，那么我可能会很想追加到 DOM，然后在悬停时移除。

另一个需要考虑的方面是优雅降级——如果 JavaScript 被禁用或没有，您是否希望某些/类似的功能可用？

如果您使用 Firefox 的[Firebug](http://getfirebug.com/)插件检查 Facebook，您可以看到页面加载时***隐藏***div 存在，但通过 CSS 类隐藏和激活。

# .net - .NET 中的邮件地址

> ID：865903
> 
> 赞同：1
> 
> 时间：2009-05-14T21:31:27.673
> 
> 标签：.net, mailaddress

我正在尝试发送一封电子邮件，而不是向每个人发送 5 封单独的电子邮件，我想向所有 5 个人发送一封群发电子邮件。这里的不同之处在于我希望每个人都出现在“TO”或“CC”行中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T21:34:09.850

这将只发送一条消息：

```
MailMessage msg = new MailMessage();
msg.To.Add(new MailAddress("jdoe1@example.com", "Optional Name"));
msg.To.Add(new MailAddress("jdoe2@example.com"));
msg.To.Add(new MailAddress("jdoe3@example.com"));
msg.CC.Add(new MailAddress("jdoe4@example.com"));
msg.CC.Add(new MailAddress("jdoe5@example.com"));

// can add to BCC too
// msg.Bcc.Add(new MailAddress("jdoe5@example.com"));

msg.Body = "...";
msg.Subject = "...";

SmtpClient smtp = new SmtpClient();
smtp.Send(msg); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T21:35:30.127

```
using System.Net.Mail;

...

MailMessage mmsg = new MailMessage();
mmsg.To.Add(new MailAddress("joe@user.com"));
mmsg.To.Add(new MailAddress("fred@user.com"));
mmsg.To.Add(new MailAddress("bob@user.com"));

// set other properties here...

SmtpClient client = new SmtpClient("mymailserver.com");
client.Send(mmsg); 
```

编辑：噢，约翰的手指比我的快；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T21:34:25.653

MailMessage.CC.Add（新邮件地址（地址））

查看：http: [//msdn.microsoft.com/en-us/library/system.net.mail.mailmessage.cc.aspx](http://msdn.microsoft.com/en-us/library/system.net.mail.mailmessage.cc.aspx)

# javascript - 为网站选择正确的设计？

> ID：865906
> 
> 赞同：5
> 
> 时间：2009-05-14T21:32:36.233
> 
> 标签：javascript, html, css

我天生就是一名程序员（业余爱好者，但希望以此为职业），所以当我被要求设计一个网站时，我觉得有点不合适（我的大多数应用程序都没有漂亮的 UI，它们只是工作，因为我是唯一一个使用它们的人）。我一直在研究如何设计我的网站，并开始想知道你们是如何决定的。

你们能给我什么指导方针？在开始编码之前我应该​​考虑什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T21:36:38.877

很难在答案中总结整个 UI 设计领域。

让最常见的任务变得最简单。弄清楚人们想要做什么，并使其尽可能直观和直接。[不要让他们思考](https://rads.stackoverflow.com/amzn/click/com/0321344758)。

制作模型和原型。观察人们尝试使用它们（**注意**，不要帮助他们），并修复他们觉得尴尬的事情。你第一次尝试设计是不对的，不要太反对把它扔掉。

这个领域真的有很多东西，它不能轻易地向任何人解释。设计并不比编程复杂，但许多程序员似乎出于某种原因将其视为事后的想法。尝试一些创造性的谷歌搜索设计原则，特别是当它们适用于网络时。查看您认为设计良好的网站，并尝试找出他们对您有这种感觉的**原因。**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T23:27:19.673

读读读读！！！

最好的办法是阅读设计技术和编码实践！

设计网站：

*   [http://www.smashingmagazine.com/](http://www.smashingmagazine.com/)
*   [http://www.youthedesigner.com/](http://www.youthedesigner.com/)
*   [http://www.psdtuts.com/](http://www.psdtuts.com/)

编码网站（具有设计意识）：

*   [http://www.nettuts.com](http://www.nettuts.com)
*   [http://cssglobe.com/](http://cssglobe.com/)

以上所有答案都很棒！我的建议是通过研究他人（并提出问题）来尽可能多地学习。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T21:34:46.930

*   首先，您应该始终尝试最低限度。
*   先考虑可用性和轻松导航。
*   以其他网站为例，找出它们的弱点和长处，并在您的解决方案中继承它们。
*   如果你发现自己因为缺乏设计想象力而受阻，那么试着简单地想想内容占位符，即某些元素的去向，试着在纸上画出它的样子并判断它，冲洗并重复，你应该得到一些东西。
*   理想情况下，将您的草图展示给某人并征求第二意见。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T21:39:22.380

从设计中设计和构建 HTML/CSS 是两个不同的游戏。第一个需要艺术技巧，第二个需要大量了解 HTML 和 CSS 应该如何工作以及某些浏览器如何选择理解这些规则。

首先，如果你能设计，那就太好了。如果您做不到并且客户想要您无法交付的东西，请与自由职业者交谈。那里有十亿个。

构建它可以全面学习，但可能需要时间。如果这是您第一次将复杂的设计带到 Web 上，您可能也希望将其外包......但如果您想以此为业，这确实是您需要能够做的事情。

没有理由你不能做所有事情，但你需要意识到你的技能会随着时间的推移而提高，当你第一次做的时候，它可能会好很多。与一切一样，熟能生巧。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T22:24:21.600

我意识到我不擅长网页设计：我知道 HTML、CSS（两者都很好），但我不知道如何让页面看起来不错。所以我使用现有的模板，并进行一些小的调整或定制。请参阅以下问题以获取免费模板：

[https://stackoverflow.com/questions/851666/free-website-templates-royalty-free-css-html-asp-net](https://stackoverflow.com/questions/851666/free-website-templates-royalty-free-css-html-asp-net)

[https://stackoverflow.com/questions/522856/what-are-good-resources-for-css-templates-or-templated-layout-sites](https://stackoverflow.com/questions/522856/what-are-good-resources-for-css-templates-or-templated-layout-sites)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T21:46:30.337

既然你被问到，我假设有一个客户参与了这个过程。因此，创建一个原型，尝试获得反馈并根据该反馈继续前进，尝试始终在最后阶段跟踪这些反馈，这可能会变得非常有帮助。在大多数情况下，创建设计取决于网站的内容。在您制作草图之前，请浏览具有相同主题和相同背景的网站，以便在您的脑海中获得一些想法。几次之后，您将获得一些技能并能够真正感受到它的外观。我个人的建议是尽量考虑清晰的设计，避免混乱，考虑可用性和功能，在大多数情况下需要足够的通用特性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-15T16:14:15.087

我同意这种方法，即研究、阅读和寻找是成为一名优秀设计师的最佳途径。我认为有时程序员害怕“艺术”领域，因为它太主观了，或者他们认为他们需要有一些天赋。

大多数优秀的艺术家都非常努力地改进他们的工艺。天赋对设计师的用处大致相当于高级数学技能对程序员的用处。它可以在某些领域提供帮助，但不是必需的。

查看具有相似目标的热门网站。他们如何使用视觉元素解决问题？页面上的信息是如何排列的，如何分解，哪些部分对网站的功能至关重要，哪些部分仅有助于改善审美呈现（或不改善它）？

虽然抄袭网站设计永远不会很酷，但借用技术或想法并使用它们来创建自己的原创设计是完全正常的。

首先制作一个线框 - 这将允许您有效地将信息放置在页面上并考虑架构和功能，而不必担心“漂亮”的东西。然后转到一个图像模型，它是网站的充实版本。不要害怕扔掉设计并完全重新开始。

在此过程中，您可能会学到许多图形设计原则。记住它们总是好的，但我的建议是现在就跟着你的直觉走。如果您认识任何熟练的设计师，请寻求反馈。设计师喜欢批评（以一种很好的方式）。

很多人会建议保持简单明了。这是很好的建议，但请记住：简单可能真的很难。

至于在线资源，我认为[Web Design From Scratch](http://www.webdesignfromscratch.com/design-like-no-ones-watching.php)在一个地方提供了很多很好的建议。网上有无数很棒的设计帮助和灵感资源，所以请继续挖掘并订阅博客提要。

祝你好运。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T19:33:36.247

您可能还想浏览Jakob Neilsen 的[一些 Alert Box 文章](http://useit.mondosearch.com/cgi-bin/MsmFind.exe?QUERY=web+design)。我没读过，但人们也对他的书评价很高。

一旦你决定了你可能想要什么样的布局，还有大量的网站可以为你生成 CSS 模板。这为您提供了基础，您可以随后对其进行调整以满足您的需求。

# python - Python 中的一切都像 Ruby 一样是对象吗？

> ID：865911
> 
> 赞同：68
> 
> 时间：2009-05-14T21:33:02.693
> 
> 标签：python, ruby, object, language-comparisons

我在另一个 Stack Overflow 问题上读到 Python 就像 Ruby，因为它与“一切都是对象”有关，而 Python 中的一切都是对象，就像 Ruby 一样。

这是真的？Python 中的一切都像 Ruby 一样是对象吗？

两者在这方面有何不同，还是真的相同？例如，你能拿一个数字做我见过的 Ruby 的东西吗：

```
y = 5.plus 6 
```

可以在 Python 中以同样的方式完成吗？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-05-14T21:40:38.337

[DiveIntoPython - 一切都是对象](https://linux.die.net/diveintopython/html/getting_to_know_python/everything_is_an_object.html#d0e4665)

> Python 中的一切都是对象，几乎所有东西都有属性和方法。所有函数都有一个内置属性`__doc__`，它返回`doc string`函数源代码中定义的值。`sys`模块是一个对象，它具有（除其他外）一个名为`path`. 等等。
> 
> 不过，这引出了一个问题。什么是对象？不同的编程语言以不同的方式定义“对象”。在某些情况下，这意味着*所有*对象都*必须*具有属性和方法；在其他情况下，这意味着所有对象都是可子类化的。在 Python 中，定义比较宽松；有些对象既没有属性也没有方法（第 3 章会详细介绍），而且并非所有对象都是可子类化的（第 5 章会详细介绍）。但从某种意义上说，一切都是对象，它可以分配给变量或作为参数传递给函数（第 4 章会详细介绍）。

[Ruby Docs - 从 Python 到 Ruby](http://www.ruby-lang.org/en/documentation/ruby-from-other-languages/to-ruby-from-python/)

> 与 Python 一样，在 Ruby 中，... 一切都是对象

因此，您可以从 Ruby 自己的网站获得它：在 Python 中，一切都是对象。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-05-14T22:03:28.673

虽然在 Python 中一切都是对象，但它在解析名称和与对象交互的方法上与 Ruby 不同。

例如，虽然 Ruby 在 Object 基类上为您提供了一个“to_s”方法，但为了公开该功能，Python 将它集成到字符串类型本身中——您可以通过从它构造字符串来将类型转换为字符串。而不是`5.to_s`，你有`str(5)`。

不过，不要被愚弄。幕后仍然有一种方法 - 这就是这段代码有效的原因：

```
(5).__str__() 
```

所以在实践中，两者本质上是相似的，但你使用它们的方式不同。Python 中的列表和元组等序列的长度是这一原则的另一个例子 - 实际功能建立在[具有特殊名称的方法](https://docs.python.org/3/reference/datamodel.html#special-method-names)之上，但通过更简单、更易于使用的接口（`len`函数）公开。

因此，与您在问题中所写内容等效的 Python 将是：

```
(5).__add__(6) 
```

另一个重要的区别是全局函数的实现方式。在 Python 中，全局变量由字典表示（本地变量也是如此）。这意味着以下内容：

```
foo(5) 
```

相当于 Python 中的这个：

```
globals()["foo"].__call__(5) 
```

虽然 Ruby 有效地做到了这一点：

```
Object.foo(5) 
```

这对用两种语言编写代码时使用的方法有很大影响。Ruby 库倾向于通过向现有类型（如`Object`.

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-05-14T22:02:51.247

“一切”对于 Python 和 Ruby 来说都有点过高——例如，`if`它不是“对象”，而是用于启动条件语句或（在 Python 中）在列表推导和生成器表达式中的关键字。发现函数、类、方法和所有类似的东西在（比如）C++ 中不是真正的对象，在 Ruby 或 Python 中是对象的热情，引起了这种热情。其他东西可能是 Ruby 中的对象，但不是 Python 或反之亦然（代码块、正则表达式……）。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-05-14T21:51:48.870

在回答您的第二个问题时，是的：

```
>>> (1).__add__(2)
3 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T21:40:59.507

是的，据我所知，一切都是 Python 中的对象。当然，原始类型和内置类型（int、long、str、float 等）可以被子类化——实际上这些类型本身就是对象。函数是对象，类是对象，甚至代码块在某种意义上也是对象......我想不出Python中有什么不能被视为对象的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T23:08:33.210

为其他人的优秀答案添加评论：一切都是对象，但有些——特别是字符串和数字类型——是不可变的。这意味着这些类型在赋值、参数传递等方面的行为方式与它们在 C 或 Java（其中整数等不是对象）等语言中的行为方式相同，并且您永远不必担心由传递引起的陷阱-参考。这是一个很好的解决方案:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-27T10:37:44.577

您好，答案不是一切，参考比这更完整，并提供更多途径，例如在 Python 3.8.5 中，分隔符、运算符和关键字不是对象。[stackoverflow.com/a/66374328/11554034](https://stackoverflow.com/a/66374328/11554034)

已经在该链接中详细解释了它，请随时查看。

无论如何，下一个说你可以通过说来纠正它（更正确的东西，尽管如果仍然可以更完整，请随意）： **“逻辑行中的所有内容，不是 NEWLINE，INDENT，DEDENT，空格键字符，运算符，关键字或分隔符是 Python 中的一个对象。”**

干杯。

# .net - 可空枚举类型的奇怪行为

> ID：865916
> 
> 赞同：5
> 
> 时间：2009-05-14T21:33:55.903
> 
> 标签：.net, asp.net, nullable, page-lifecycle, global-asax

我正在使用 Global.asax 通过 Application_EndRequest 事件在每个请求结束时执行日志记录。但是，我看到存储在 HTTPContext.Current.Items 集合中的某些值的一些奇怪行为。

下面是可空枚举的调试输出。可以看到有值，但是 HasValue 解析为 False？！

```
{System.Nullable(Of AreaNameEnum)}
    HasValue: False
    hasValue: False
    Value: {System.InvalidOperationException}
    value: ADMIN {0} 
```

我猜在请求生命周期中访问 HTTPContext.Current 为时已晚 - 但它似乎有时有效，有时无效。任何人都可以更清楚地了解到底发生了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T21:45:11.197

Nullable 是一个结构，它包含一个 boolean hasValue 和一个 T 值，其中 T 是一个值类型。在这种情况下，一个枚举。在这种情况下，枚举必须有一些值，默认值为 0，但是公共 Value 会抛出异常，因为 hasValue 为 false。

您所看到的是 Nullable 如何完成它的工作的内部结构。当 hasValue 为 false 时，您无法将任何内容读入具有任何值的内部值字段。毕竟，如果 value 可以包含 null ，那么在这里使用 Nullable 就没有任何意义了。

# iphone - 如何找出一个像素在 CGImageRef 中有多少字节？

> ID：865917
> 
> 赞同：0
> 
> 时间：2009-05-14T21:33:58.227
> 
> 标签：iphone, cocoa-touch, uikit, core-graphics

该文档提到了一个 CGBitmapContextGetBitsPerPixel()。我几乎可以肯定，我只需要将它除以 8。

但是由于我没有学习计算机科学，所以我对细节感到困惑。如果它是 8 位 PNG 或 24 位 PNG 会有所不同吗？还是其他的PNG？

因此，为了安全地获取 CGContextRef 的每个像素的字节数，我是否只需除以 8？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T21:43:23.963

每个像素的位数不一定是 8 的倍数。有时使用 15 位，黑白图像使用 1 位。因此，如果您想找到保存单个像素值所需的最小字节数，请除以 8 并向上取整。

# c++ - 如何用 C++ 编写一个简单的类？

> ID：865922
> 
> 赞同：43
> 
> 时间：2009-05-14T21:34:29.007
> 
> 标签：c++, constructor, destructor, public, private-members

我一直在阅读很多关于 C++ 类的教程，但他们错过了其他教程包含的内容。

有人可以告诉我如何编写和使用一个非常简单的 C++ 类，它使用可见性、方法和简单的构造函数和析构函数吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-14T21:41:51.877

[从C++ 中的构造函数和析构函数中](http://www.java-samples.com/showtutorial.php?tutorialid=313)获取并更好地解释了有据可查的示例：

```
#include <iostream>            // for cout and cin

class Cat                      // begin declaration of the class
{
  public:                      // begin public section
    Cat(int initialAge);       // constructor
    Cat(const Cat& copy_from); //copy constructor
    Cat& operator=(const Cat& copy_from); //copy assignment
    ~Cat();                    // destructor

    int GetAge() const;        // accessor function
    void SetAge(int age);      // accessor function
    void Meow();
 private:                      // begin private section
    int itsAge;                // member variable
    char * string;
};

// constructor of Cat,
Cat::Cat(int initialAge)
{
  itsAge = initialAge;
  string = new char[10]();
}

//copy constructor for making a new copy of a Cat
Cat::Cat(const Cat& copy_from) {
   itsAge = copy_from.itsAge;
   string = new char[10]();
   std::copy(copy_from.string+0, copy_from.string+10, string);
}

//copy assignment for assigning a value from one Cat to another
Cat& Cat::operator=(const Cat& copy_from) {
   itsAge = copy_from.itsAge;
   std::copy(copy_from.string+0, copy_from.string+10, string);
}

// destructor, just an example
Cat::~Cat()
{
    delete[] string;
}

// GetAge, Public accessor function
// returns value of itsAge member
int Cat::GetAge() const
{
   return itsAge;
}

// Definition of SetAge, public
// accessor function
 void Cat::SetAge(int age)
{
   // set member variable its age to
   // value passed in by parameter age
   itsAge = age;
}

// definition of Meow method
// returns: void
// parameters: None
// action: Prints "meow" to screen
void Cat::Meow()
{
   cout << "Meow.\n";
}

// create a cat, set its age, have it
// meow, tell us its age, then meow again.
int main()
{
  int Age;
  cout<<"How old is Frisky? ";
  cin>>Age;
  Cat Frisky(Age);
  Frisky.Meow();
  cout << "Frisky is a cat who is " ;
  cout << Frisky.GetAge() << " years old.\n";
  Frisky.Meow();
  Age++;
  Frisky.SetAge(Age);
  cout << "Now Frisky is " ;
  cout << Frisky.GetAge() << " years old.\n";
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-26T02:29:23.580

即使他是一名学生，也值得尝试回答，因为它是一个复杂的问题，至少对于 C++ 的新访问者来说不是那么容易:)

C++ 中的类服务于两种设计范式的交集，

1) ADT :: 这基本上意味着一种新类型，例如整数“int”或实数“double”，甚至是“date”之类的新概念。在这种情况下，简单的类应该是这样的，

```
class NewDataType
{
public:
// public area. visible to the 'user' of the new data type.
.
.
.
private:
// no one can see anything in this area except you.
.
.
.
}; 
```

这是一个 ADT 最基本的骨架……当然，忽略公共区域可以更简单！并删除访问修饰符（公共，私有），整个事情将是私有的。但这只是胡说八道。因为 NewDataType 变得没用了！想象一个你可以声明但你不能对它做任何事情的'int'。

然后，您需要一些基本不需要 NewDataType 存在的有用工具，但您可以使用它们让您的类型看起来像语言中的任何“原始”类型。

第一个是构造函数。语言中的许多地方都需要构造函数。看看 int 并尝试模仿它的行为。

```
int x; // default constructor.

int y = 5; // copy constructor from a 'literal' or a 'constant value' in simple wrods.
int z = y; // copy constructor. from anther variable, with or without the sametype.
int n(z); // ALMOST EXACTLY THE SAME AS THE ABOVE ONE, it isredundant for 'primitive' types, but really needed for the NewDataType. 
```

上面的每一行都是一个声明，变量在那里构造。

最后想象一下函数中的上述 int 变量，该函数称为“有趣”，

```
int fun()
{
    int y = 5;
    int z = y;
    int m(z);

    return (m + z + y)
    // the magical line.
} 
```

你看到了神奇的线条，在这里你可以告诉编译器你想要的任何东西！在您完成所有操作并且您的 NewDataType 对函数中的本地范围不再有用之后，您将其杀死。一个经典的例子是释放“new”保留的内存！

所以我们非常简单的 NewDataType 变成了，

```
class NewDataType
{
public:
// public area. visible to the 'user' of the new data type.
    NewDataType()
    { 
        myValue = new int;
        *myValue = 0;
    }

    NewDataType(int newValue)
    {
        myValue = new int;
        *myValue = newValue;
    }

    NewDataType(const NewDataType& newValue){

        myValue = new int;
        *myValue = newValue.(*myValue);
    }
private:
// no one can see anything in this area except you.
    int* myValue;
}; 
```

现在这是非常基本的框架，要开始构建有用的类，您必须提供公共功能。

在 C++ 中构建类时需要考虑很多小工具，

. . . .

2) Object :: 基本意思是一个新的类型，但不同的是它属于兄弟姐妹，祖先和后代。看看 C++ 中的 'double' 和 'int'，'int' 是 'double' 的太阳，因为至少在概念上每个 'int' 都是 'double' :)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-14T21:40:53.127

```
class A
{
  public:
    // a simple constructor, anyone can see this
    A() {}
  protected:
    // a simple destructor. This class can only be deleted by objects that are derived from this class
    // probably also you will be unable to allocate an instance of this on the stack
    // the destructor is virtual, so this class is OK to be used as a base class
    virtual ~A() {}
  private:
    // a function that cannot be seen by anything outside this class
    void foo() {}
}; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-14T21:42:45.553

```
#include <iostream>
#include <string>

class Simple {
public:
  Simple(const std::string& name);
  void greet();
  ~Simple();
private:
  std::string name;
};

Simple::Simple(const std::string& name): name(name) {
  std::cout << "hello " << name << "!" << std::endl;
}

void Simple::greet() {
  std::cout << "hi there " << name << "!" << std::endl;
}

Simple::~Simple() {
  std::cout << "goodbye " << name << "!" << std::endl;
}

int main()
{
  Simple ton("Joe");
  ton.greet();
  return 0;
} 
```

傻，但是，你来了。请注意，“可见性”是用词不当：公共和私有控件可访问性，但即使是“私有”内容仍然从外部“可见”，只是不可*访问*（尝试访问它是错误的）。

# sharepoint - Sharepoint OnWorkflowItemChanged 在属性列表之前/之后

> ID：865926
> 
> 赞同：1
> 
> 时间：2009-05-14T21:35:07.163
> 
> 标签：sharepoint, workflow, workflow-foundation

我想在 WSS 3.0 状态机工作流中使用 OnWorkflowItemChanged 事件来检查对启动工作流的列表项所做的更改。此事件的属性包括更改属性之前和之后，我可以毫无问题地绑定到之后属性，并使用列表项的更改值获取属性集。然而，属性之前的绑定总是空的，经过一些研究，我发现了这个[http://msdn.microsoft.com/en-us/library/aa979520.aspx](http://msdn.microsoft.com/en-us/library/aa979520.aspx)，它说之前的属性只能在文档库而不是列表中使用。

我想知道的是，是否有解决此缺失功能的方法，或者获得此功能的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T14:27:50.770

我克服这个问题的方法是使用该项目的先前版本。当然，必须在列表上启用版本控制。

```
// get an object referencing the item in the list
Guid listGuid = new Guid(listId);
SPList myList = web.Lists[listGuid];
SPListItem myItem = myList.GetItemById(itemId);

// make sure there is at least one previous version to compare
// 0 -> current version
// 1 -> previous version
// 2 -> older version
// ...
if (myItem.Versions.Count > 1)
{
    SPListItemVersion newItem = myItem.Versions[0];
    SPListItemVersion oldItem = myItem.Versions[1];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T00:06:28.033

我目前使用了以下解决方法，并希望得到一些关于其他人想法的反馈。我个人不喜欢它，因为我认为应该有一种方法可以访问框架提供的这些信息。

我在等待项目更改的状态初始化中创建了一个执行自定义代码活动。以下代码将属性保存到工作流中的一个字段，以便在更新发生后访问

```
SPListItem item = workflowProperties.Item;
item.Update();

beforeApplicationChangedProperties = new Hashtable();
foreach (SPField field in item.ContentType.Fields)
{
    if (!beforeApplicationChangedProperties.ContainsKey(field.Title))
    {
        beforeApplicationChangedProperties.Add(field.Title, item[field.Id]);
    }
} 
```

别人怎么看？

# c# - 自动生成c#类

> ID：865927
> 
> 赞同：3
> 
> 时间：2009-05-14T21:35:07.633
> 
> 标签：c#, code-generation

我经常发现我正在编写一个类似于以下的类（但成员数量、成员类型等）。是否有可能自动、轻松、免费地做到这一点？

所以我想提供参数“Foo”、“int”、“apples”、“bool”、“banana”、“Bar”和“clementine”，并为我生成其余代码。

```
public class Foo
{
   public Foo(int apples, bool banana, Bar clementine)
   {
      m_Apples = apples;
      m_Banana = banana;
      m_Clementine = clementine;
   }

   public int Apples
   {
      get { return m_Apples; }
      set { m_Apples = value; }
   }

   public bool Banana
   {
      get { return m_Banana; }
      set { m_Banana = value; }
   }

   public Bar Clementine
   {
      get { return m_Clementine; }
      set { m_Clementine = value; }
   }

   private int m_Apples;
   private bool m_Banana;
   private Bar m_Clementine;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T21:36:59.530

看看[T4 引擎](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)。它包含在 VS2005 及更高版本中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T21:46:45.513

如果你升级到 C# 3.5，你可以缩短你需要做的编写量。

例如，您可以这样做：

```
public class Foo
{
  public int Apples { get; set; }
  public bool Banana { get; set; }
  public Bar Clementine { get; set; }
}

var myFoo = new Foo { Apples = 1, Banana = true, Clementine = new Bar() }; 
```

或者，您仍然可以拥有构造函数，但不必添加所有私有字段。使用代码片段或 resharper 可以快速输入和更快。一个缺点是，如果没有更多代码，您将无法验证您的参数输入。这取决于谁将使用您的课程，以及显式设置 int Apples 而不仅仅是 0 的重要性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T21:40:58.007

您还可以使用使创建代码的过程变得非常容易的 C# 片段，例如 prop、ctor、propdp、prope。无论如何，这是一个列表，这可能会有所帮助。

[C# 代码段](http://www.codeplex.com/snippets/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T21:38:35.317

您可以使用自动属性，这样：

```
 public Bar Clementine
   {
      get;
      set;
   } 
```

这至少可以为您节省一些打字时间。

另外，您应该购买 resharper - 我知道您说免费，但是一旦您意识到它为您节省了多少时间，它基本上是免费的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T21:39:53.940

这可以通过 System.CodeDom 中的类来完成。有关示例，请参阅 CodeDomProvider 的帮助。我已经使用它基于类型库中定义的 IDL 枚举创建了一个带有 flags 属性的托管枚举。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T21:45:43.300

XSD 工具可以为您做到这一点。只需编写一个表示您的对象的模式，XSD 就会生成相应的类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T21:46:49.647

对于您提供的示例，以下内容在功能上是等效的：

```
public class Foo {
    public int Apples;
    public bool Banana;
    public Bar Clementine;
}

new Foo { Apples = 1, Banana = false, Clementine = new Bar() }; 
```

在不知道您要解决什么问题的情况下，很难提出更好的替代方案。这些是什么物品？消息？数据文件的运行时表示？

您可能需要考虑其他表示形式，例如元组或原始数组。

# java - Java 服务器套接字缓冲区没有在 Mac 上被垃圾收集

> ID：865951
> 
> 赞同：0
> 
> 时间：2009-05-14T21:38:48.527
> 
> 标签：java, macos, sockets, memory-leaks

我正在寻找应用程序中的内存错误，它似乎与 ServerSocketChannel.accept() 生成的 byte[] 缓冲区有关。根据 jvisualvm，在应用程序使用的 505 megs 中，超过 90% 的内存被 byte[] 数组使用。进一步跟踪它，有 68k+ 个 byte[] 实例，到目前为止最常见的大小是 16681。

我对这些字节数组进行了随机抽样，它们无一例外都与 InputRecord 或 OutputRecord 相关。如果我遵循所有引用，我找不到任何不返回终结器的内容，以我有限的理解，这意味着该对象已准备好进行垃圾收集，但由于某种原因它还没有.

我希望我可以附上 jvisualvm 输出的屏幕截图。无论如何，所指对象包括：

*   输入记录
*   应用输入流
*   SSLSocketImpl
*   套接字输入流
*   SocksSocketImpl
*   套接字输出流
*   应用输出流
*   委托HttpsURLConnection
*   HttpsURLConnectionImpl

这似乎只发生在使用 Apple 虚拟机的客户身上。有人知道为什么这些缓冲区没有被垃圾收集吗？我读错了堆配置文件吗？黑客或解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T21:56:30.000

`finalize`在垃圾收集器发现对象后的某个时间调用。Sun 的实现与`java.lang.ref`. 正确关闭资源应该释放它们的内存。如果对象`finalize`在关闭时未能清空对缓冲区的引用，那么这些缓冲区将一直挂起，直到终结器执行后相关的 GC。

通常只有一个终结器线程，尽管规范允许很多。如果由于阻塞操作、不适当的持有锁或其他原因而被阻塞，则可终结对象的 GC 将被搁置。我建议检查 visualvm 中的 finaliser 线程，看看它是否被阻塞。

# unix - 使用 fork 和套接字时处理不正常的关闭

> ID：865955
> 
> 赞同：3
> 
> 时间：2009-05-14T21:39:20.773
> 
> 标签：unix, sockets, process, fork, zombie-process

我有一个服务器，它监听套接字连接并根据请求执行不同类型的操作。其中之一是长期存在的数据库查询，服务器为此分叉。

服务器保留所有活动子节点的日志，并且每当被要求关闭时，它会在退出之前杀死所有子节点。有几次我遇到服务器崩溃或被不优雅地杀死的情况，这导致子进程成为孤儿。如果我再次尝试恢复服务器，它将拒绝说监听套接字无法绑定，因为该地址/端口已经绑定。

我正在寻找一种方法来改善这种情况，以便主服务器进程可以立即恢复。我已经尝试从孩子那里监视父母的存在并在消失后立即退出，但这只会导致僵尸进程并且套接字似乎仍然被绑定。

该服务器是用 Python 编写的，但欢迎任何语言的任何解释或建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T01:05:44.490

使您的服务器成为[进程组](http://en.wikipedia.org/wiki/Process_group)的领导者。在这种情况下，当组长退出时，孩子会被终止。

> 在类 Unix 系统上使用文本用户界面时，会话用于实现登录会话。单个进程（会话领导者）与控制终端交互，以确保在用户“挂断”终端连接时终止所有程序。（如果没有会话负责人，则终端的前台进程组中的进程应处理挂起。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T23:14:15.867

在你调用listen()之前在你的socket上使用它：

```
int on = 1;
setsockopt (sockfd_wan, SOL_SOCKET, SO_REUSEADDR, &on, sizeof (on)); 
```

它允许您的程序使用该套接字，即使它之前是由另一个传出 TCP 连接随机选择的（对于 <1024 的端口不会发生）。但它也应该直接帮助您解决问题！！

无关：

还有可能发生的另一件坏事：如果您的孩子被分叉，他们会继承每个打开的文件描述符。如果他们只是简单地分叉并启动另一个长时间运行的程序，那么这些程序也会有一个打开的监听套接字句柄，因此它会继续使用（使用 lsof 和 netstat 命令查找！）

所以应该这样称呼：

```
int close_on_exec_on(int fd)
{
  return fcntl(fd, F_SETFD, FD_CLOEXEC);
}

close_on_exec_on(sockfd); 
```

但是我从来没有在主程序中尝试过它，如果它分叉了孩子，它显然不会帮助你，因为孩子是分叉的，而不是与 exec 一起运行。

但请记住，无论如何都要在主程序的监听套接字上调用它！以防万一您运行外部程序

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:45:27.887

也许当你分叉时，不承认孩子，这样父进程就不是向操作系统注册的父进程。父母真的需要和孩子交流吗？如果不是，这可能是一个选择。

您可以跟踪子进程，但方式不同。您将不会再收到 SIGCHLD 事件。

# python - Python：文件 IO - 禁用增量刷新

> ID：865957
> 
> 赞同：3
> 
> 时间：2009-05-14T21:39:42.007
> 
> 标签：python, file-io

有点与[这个问题](https://stackoverflow.com/questions/608316/is-there-commit-analog-in-python-for-writing-into-a-file)相反。

有没有办法告诉 Python “在我告诉你之前不要写入磁盘”。（通过关闭或刷新文件）？我正在写入网络上的文件，并且宁愿一次写入整个文件。

同时，我正在写入 StringIO 缓冲区，然后在最后将其写入磁盘。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T21:47:08.103

不，看一下python手册并不表示将缓冲区大小设置为无穷大的选项。

您当前的解决方案基本上是相同的概念。

您**可以**使用 Alex 的想法，但出于以下原因，我会冒险反对它：

1.  打开时的缓冲区大小限制为 2^31-1 或 2 个演出。任何更大都会导致“OverflowError：long int too large to convert to int”
2.  它似乎不起作用：

    ```
    a = open("blah.txt", "w", 2 ** 31 - 1)
    for i in xrange(10000): 
        a.write("a") 
    ```

在不关闭python的情况下打开文件，你会看到文本

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T21:49:20.687

您可以根据需要使用尽可能大的缓冲区打开文件。例如，要使用多达 10 亿字节进行缓冲，`x=open('/tmp/za', 'w', 1000*1000*1000)`-- 如果您有 1000 亿字节的内存并且想要全部使用它们，只需添加另一个 *100...;-)。内存只会消耗实际需要的量，所以，不用担心......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T05:05:29.377

我会说这部分取决于你想要做什么。

我遇到此问题的情况是，当我的应用程序创建另一个应用程序使用的文件有点慢时，另一个应用程序将获得该文件的不完整版本。

我通过将文件写入另一个位置来解决它，然后在我完成写入后将其重命名到正确的位置。

如果您出于其他原因想要这个，那么也许这无济于事。

# python - 算法：如何删除所有其他文件

> ID：865973
> 
> 赞同：1
> 
> 时间：2009-05-14T21:42:18.427
> 
> 标签：python, algorithm

我有一个包含数千张图像的文件夹。我想删除所有其他图像。最有效的方法是什么？用 i%2==0 遍历每一个仍然是 O(n)。有没有一种快速的方法来做到这一点（最好在 Python 中）？

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-14T21:45:49.527

要删除一半的 N 图像，你**不能**比 O(N) 快！您*确实*知道 O() 表示法（除其他外）意味着常数乘法因子是不相关的，是吗？

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-14T23:18:38.023

```
import os
l = os.listdir('/some/dir/with/files')

for n in l[::2]:
    os.unlink(n) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T21:49:18.317

> 用 i%2==0 遍历每一个仍然是 O(n)。有没有一种快速的方法来做到这一点（最好在 Python 中）？

比 O(n) 更快的唯一方法是如果您的文件已经排序，并且您只想删除 1 个文件。

您说 i%2==0，这意味着您正在删除每个“偶数”文件。O(n/2) 仍然是 O(n)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T21:46:46.950

我看不到任何可以想象的方式删除`n/2`文件可能比 O(n) 更快，除非文件系统具有删除大量文件的一些特殊功能（但我认为这在实践中实际上并不存在，如果它甚至可能的话)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T21:47:18.977

如果你想删除 Log(n) 文件，会有......你可以将图像存储在数据库中，不过（MySQL 有一个“blob”类型，以及其他几个类型，它将存储你的图像）。然后，如果你巧妙地命名它们，你可以在 O(1) 中做到这一点。

/edit 我讨厌我必须使用速记和糟糕的语法来快速得到我的答案！！！

如果您正在寻找 rm -rf *2.img *4.img *6.img *8.img *0.img 的 python 等价物，请知道计算机仍然必须遍历整个文件列表

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T22:01:43.667

您可以`islice`从`itertools`模块中使用。这是你的例子：

```
import os, itertools
dirContent = os.listdir('/some/dir/with/files')
toBeDeleted = itertools.islice(dirContent, 0, len(dirContent), 2)
# Now remove the files
[os.unlink(file) for file in toBeDeleted] 
```

这是做你想做的另一种形式，虽然我不确定它是否会更快。希望这可以帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T00:03:59.227

我会尝试使用特定于操作系统的东西，例如：

linux：

```
@files = grep { -f "$dir/$_" && /*.H$/ }
unlink @files 
```

赢：

```
$file_delete =~ /H$/;
rm $file_delete 
```

看看你的操作系统是否比在 python 中迭代更快。

使用 os.system(...) 或 subprocess.call(...) 从 python 运行这些。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T21:50:54.367

“用 i%2==0 遍历每一个仍然是 O(n)”

增加 2 而不是增加 1？

```
for(i = 0; i < numFiles; i += 2) {
  deleteFile(files[i]);
} 
```

不过说真的：遍历文件列表可能不是文件删除算法中最慢的部分。实际删除可能需要多几个数量级的时间。

# subsonic - SubSonic 和 Paging 使用 ROW_NUMBER ()

> ID：865974
> 
> 赞同：1
> 
> 时间：2009-05-14T21:42:18.677
> 
> 标签：subsonic, paging, row-number

如何使用 SubSonic 启用 ROW_NUMBER () 进行分页？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T12:03:35.647

你不必。它内置于 sqlquery 引擎中。使用 SubSonic.SqlQuery 而不是 SubSonic.Query。

# .net - 处理旧应用程序中的新库功能

> ID：865978
> 
> 赞同：0
> 
> 时间：2009-05-14T21:43:04.697
> 
> 标签：.net, backwards-compatibility

我们正在开发一个新的库版本，其中包含一些其他应用程序使用的 UI 控件。其中一些控件具有旧应用程序不知道的新功能。默认情况下，我们将禁用新功能，但我们希望为某些特定应用启用它们。这些应用程序可能存在于同一台机器上。

你会如何建议实施这个？

**更新：** 我想出的最佳解决方案是使用 Process.GetCurrentProcess() 并使用类似 proc.MainModule.FileVersionInfo.InternalName 的东西来查找指定覆盖值的注册表项。也许还要查看版本号以检查它是否太旧而无法了解新功能。这种方法有问题吗？

**更新：** 添加的功能封装在控件中，只是它们在某些情况下有意义，而在其他情况下没有意义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T21:56:09.267

我不认为你可以。您将无法更改旧应用程序的界面，也无法接收或返回任何新数据。因此，新控件必须像旧控件一样对旧应用程序起作用。现在，如果您在新控件中有完全封装在控件中的行为（例如固定或最小化或类似的东西），那么这些功能可能会在您的旧应用程序上工作。您可以处理让旧应用程序使用新控件的麻烦事，假设它们是强命名的，并且在 GAC 中使用[Publisher Policies](http://msdn.microsoft.com/en-us/library/dz32563a.aspx)。

# sockets - 我需要心跳来保持 TCP 连接打开吗？

> ID：865987
> 
> 赞同：108
> 
> 时间：2009-05-14T21:44:17.407
> 
> 标签：sockets, tcp

我有两个通过 TCP/IP 进行通信的组件。组件 A 充当服务器/侦听器，组件 B 是客户端。两人应该尽快沟通。任何时候都只能有一个连接（尽管这个问题除外）。我公司的一位高级开发人员说我需要在两个组件之间使用应用程序级心跳来确保连接保持打开状态。

我认为 TCP/IP 的连接保持打开状态，但我读过许多博客/网站，说在这些应用程序之间进行心跳是非常标准的做法。

我知道组件 A 检测组件 B 的部分原因，因此如果组件 B 存在通信问题（链接已关闭或组件 B 未运行），它可以通知支持人员。是否出于任何其他原因需要心跳？比如确保经常有东西“在管道中”保持开放？

组件 A 当前每 20 秒对组件 B 进行一次心跳，如果在 120 秒内没有从组件 B 收到任何返回，则关闭连接。然后它继续侦听连接，假设如果链接断开，组件 B 将定期尝试重新连接。这成功了。

重申我的问题：保持 TCP/IP 连接处于活动状态是否需要心跳？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-05-14T21:46:35.687

无论如何，连接*都应该*保持打开状态，但是通常会看到协议实现心跳以帮助检测死连接，例如使用[PING命令的 IRC。](https://www.rfc-editor.org/rfc/rfc2812#section-3.7.2)

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-05-15T00:20:31.290

正如许多其他人所指出的，如果留给自己的设备，TCP 连接将保持正常。但是，如果您在连接的中间有一个设备跟踪其状态（例如防火墙），您可能需要保持连接以防止状态表条目过期。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-08-27T15:10:52.990

如果您的组件：

*   在传统的有线网络中
*   它们之间没有防火墙或 NAT 路由器
*   他们都没有崩溃

那么你不需要有心跳。

如果这些假设中的任何一个是错误的（我在看着你，GPRS！），那么很快就需要心跳。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-14T21:50:44.473

您不需要自己发送心跳。无论使用情况如何，TCP 连接都将保持打开状态。

请注意，TCP 实现了一个可选的[keepalive](http://tldp.org/HOWTO/TCP-Keepalive-HOWTO/overview.html)机制，可用于及时识别关闭的连接，而不是要求您在稍后的某个日期发送数据，然后才发现连接已关闭。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-01-27T04:53:34.777

如果您使用 Windows，请注意 TCP Keep-alive。默认情况下，除非您使用 Windows 注册表或通过 setsockopt 全局打开它，否则它会被禁用。

默认保持活动间隔为 2 小时。

[http://msdn.microsoft.com/en-us/library/ms819735.aspx](http://msdn.microsoft.com/en-us/library/ms819735.aspx)

如果不希望 2 小时保持活动状态，您可能需要实现自己的心跳并在 Windows 上禁用 TCP 保持活动状态。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-14T21:50:33.803

> 是否需要心跳来保持 TCP/IP 连接处于活动状态？

它们对于检测连接何时终止很有用。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-14T23:59:28.783

TCP 将使连接保持活动状态。应用程序心跳用于应用程序级别的考虑，例如故障转移、负载平衡或提醒管理员注意潜在问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-07-21T12:10:51.210

心跳是告诉服务器您还活着的好方法，我的意思是，如果服务器正在使用 DoS 攻击预防系统，它（服务器）可能会在检测到该特定连接后删除所有分配的资源在指定时间段内不活动。
他们没有授权实施任何心跳机制。

但是，如果您正在设计一个应用程序，它的主要标准是响应能力，这很好。您不希望在连接设置、DNS 查找和路径发现上浪费时间。只是一直保持连接，不断发送心跳，应用程序知道连接是活动的，不需要连接设置。只是简单的发送和接收。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-15T00:22:02.067

TCP/IP 作为协议被指定为在您发送关闭数据包之前不会关闭。即使在无线或互联网连接参差不齐之后，我的套接字仍保持打开状态。

然而，这一切都非常依赖于实现。很可能会有一个“超时”，这意味着在考虑连接“死”之前等待响应的最长时间。有时这基于应用程序本身，有时基于 NAT 路由器。

因此，我强烈建议您保持“心跳”以检测不良连接并使其保持打开状态。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-12-22T13:11:13.780

基本上，TCP 连接会创建存储在交换机中的链接状态以进行路由。为了检测断开的连接（例如当一个对应方崩溃（没有发送适当的断开连接）时），这些状态必须在一段时间不活动后被驱逐。发生这种情况时，您的 TCP 连接已关闭。虽然我无法准确判断这些超时时间有多长，但它们似乎取决于设备生产商和/或互联网提供商。我记得我的空闲 SSH 终端会话被我以前的 1 和 1 互联网提供商迅速关闭（不到 15 分钟的空闲时间），而他们在使用 Kabel-BW 提供的连接时保持打开几个小时......

最后，我以我之前的演讲者结束：心跳是判断连接是否仍然存在和启动的好方法......

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-14T21:48:04.077

在尝试设置超时时，您所说的心跳很有用。您的插座可能看起来是打开的，但另一端的人可能正在遭受蓝屏死机。检测失效客户端/服务器的最简单方法之一是设置超时并确保每隔一段时间收到一条消息。

有些人称他们为 NOOP（无操作）。

但是不，它们不是保持连接活动的必要条件，只有助于了解状态是什么。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-14T21:52:38.760

我想说，如果您没有心跳，那么您的 TCP/IP 连接是否打开都没有关系。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-14T22:38:39.600

心跳不是 TCP 协议的必需品。它的实现是用来检测对方是否以非标准方式终止了连接（即没有经历拆除过程）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-03-31T13:28:58.803

TCP 不需要保持活动消息来保持会话打开。该协议旨在用于可以每隔几周激活一次而不会出现问题的终端和打印机。

其他答案确定的透明网络级元素肯定会造成令人难以置信的破坏，以至于当整个工厂行为不端并丢失会话或以其他方式干扰流量时会杀死整个工厂。这总是不正确的，不需要应用程序或操作系统开发人员采取任何行动。

如果没有保持连接，则只有在下一次尝试传输时才会检测到通信丢失错误。

存在三种可能的保活级别：

1.  [套接字级别使用操作系统设置或SO_KEEPALIVE](https://docs.microsoft.com/en-us/windows/win32/winsock/so-keepalive)选项保持活动状态。这是透明的，并且会及时检测到通信错误或损坏的合作伙伴系统。
2.  从应用程序发送零长度帧通常会提供类似的结果。这将强制检测丢失会话的 TCP PUSH 和 ACK 段对。
3.  发送和接收的应用程序级别保持活动消息以轮询合作伙伴以获取活动响应。
4.  一方定期发送心跳消息。

前两个结果不会改变通过通道传输的应用程序级信息，尽管它们必然会触发空段的传输。

最后两个选项导致应用程序通信并且可以提供更多信息。例如，如果主机应用程序已经停止并且不会响应，那么前两个备选方案无法检测到这种故障模式。第四个选项隐式起作用。发送者最终会收到一个错误，接收者应该期待周期性消息作为健康会话的指示。

如果使用更高级别的协议 - 例如 RPC 或 REST，则返回良性的 Ping() 函数可能会有所帮助。

除非必须检测连接故障，否则在必要时简单地重新连接通常更容易。选择取决于应用程序级协议和来自要求的端到端消息保证。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-14T21:50:31.433

连接将保持打开状态——不需要实现心跳，大多数使用套接字的应用程序都不会这样做。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-05-14T21:51:00.387

许多协议都实现了心跳或健康状态类型的东西，就像 Lloyd 所说的那样。只是为了让您知道连接仍处于打开状态，如果您可能遗漏了什么

# jquery-ui - jQuery UI 对话框 - 关闭事件的问题

> ID：865998
> 
> 赞同：1
> 
> 时间：2009-05-14T21:45:50.913
> 
> 标签：jquery-ui, jquery-ui-dialog

当我关闭 jQuery UI 对话框时，我正在尝试执行特定操作。这是我的代码的简化版本：

```
$('a.open-trigger').click(function(){
    var test = 'hello';

    $('#dialog').dialog({
        bgiframe: true,
        dialogClass: 'change', 
        resizable: false,
        draggable: false,
        modal: true,
        height: 334, 
        width: 450,
        autoOpen: false,
        show: 'fade'
    });

    $('#dialog').dialog('open');

    $('a.close-trigger').click(function(){
        alert(test);
        $('#dialog').dialog('close');
    });
}); 
```

第一次关闭对话框时，我会收到带有“hello”一词的预期警报。如果我再次打开对话框并关闭它，我会收到两次“hello”警报。如果我第三次打开和关闭它，我会收到三个警报，依此类推。

为什么这些警报会自我复制？我希望警报只在关闭时显示一次，无论我打开/关闭对话框多少次。

谢谢！西蒙

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T21:50:05.880

每次调用时都会附加额外的事件处理程序`.click`。这就是它重复的原因。

```
$('a.close-trigger').click(function(){
                    alert(test);
                    $('#dialog').dialog('close');
            }); 
```

将该代码拉出到与其他事件绑定相同的级别，它应该可以按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:55:35.040

您已将一个函数绑定到打开按钮，该函数会在每次触发打开事件时将事件处理程序添加到关闭按钮。您应该在“a.open-trigger”事件函数之外的某个地方添加关闭事件处理程序...

```
$('a.open-trigger').click(function(){
        var test = 'hello';

        $('#dialog').dialog({bgiframe: true, dialogClass: 'change', resizable: false, draggable: false, modal: true, height: 334, width: 450, autoOpen: false, show: 'fade'});
        $('#dialog').dialog('open');
});

$('a.close-trigger').click(function(){
        alert(test);
        $('#dialog').dialog('close');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:55:57.053

您需要将关闭单击事件处理程序从打开单击事件处理程序中取出

```
$(function() {
    $('#dialog').dialog({bgiframe: true, dialogClass: 'change', resizable: false, draggable: false, modal: true, height: 334, width: 450, autoOpen: false, show: 'fade'});

    $('a.open-trigger').click(function(){    
        $('#dialog').dialog('open');
    });

    $('a.close-trigger').click(function(){
        alert("hello");
        var myDialog = $('#dialog');
        if (myDialog.dialog('isOpen'))
            myDialog.dialog('close');
    });
}); 
```****