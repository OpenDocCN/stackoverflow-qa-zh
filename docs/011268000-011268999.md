# StackOverflow 问答 11268000-11268999

# android - 有未接来电时的警报对话框

> ID：11268002
> 
> 赞同：0
> 
> 时间：2012-06-29T19:42:18.140
> 
> 标签：android, alter

**有未接来电时的警报对话框** 我想在有未接来电时振动电话并显示对话警报以停止振动

要使用我正在使用此代码的对话框

```
 AlertDialog.Builder alertDialog = new AlertDialog.Builder(MainActivity.this);
                            alertDialog.setTitle("Call");
                            alertDialog.setMessage("show this?");

                            // "Yes" Button
                            alertDialog.setPositiveButton("YES", new DialogInterface.OnClickListener() {
                                public void onClick(DialogInterface dialog,int which)
                               {

                                Toast.makeText(getApplicationContext(), "You clicked                        YES", Toast.LENGTH_SHORT).show();
                                }
                            });

                            //  "NO" Button
                            alertDialog.setNegativeButton("NO", new DialogInterface.OnClickListener() {
                                public void onClick(DialogInterface dialog, int which) {
                                // Write your code here to invoke NO event
                                Toast.makeText(getApplicationContext(), "You clicked NO", Toast.LENGTH_SHORT).show();
                                dialog.cancel();
                                }
                            });

                            alertDialog.show(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:52:26.113

您无法获取未接来电的事件/广播/通知，但您可以获取**ACTION_PHONE_STATE_CHANGED的事件，按照****EXTRA_STATE_RINGING**到**EXTRA_STATE_OFFHOOK**到**EXTRA_STATE_IDLE**的顺序跟踪事件

 **在此之后，您可以查看通话记录并找到未接来电详细信息。

为了您的纵容[，这里](http://www.anddev.org/video-tut_-_querying_and_displaying_the_calllog-t169.html)是获取通话记录的代码示例

礼貌：AndDev.org

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:34:04.343

但是，您尝试实现的设计模式不是首选。

Android 本身会通知用户未接来电。手机会根据用户的振动设置振动。

如果您愿意，您可以在收到 ACTION_PHONE_STATE_CHANGED 时自行检查通话记录，并根据它*发送通知*。显示对话框是一种烦人的方法，它会打断正常的任务流程。您可以为通知实现内容 Intent，在单击通知时将用户发送回您的应用程序。进入您的应用程序后，用户可以选择关闭振动。

未接来电通常不会中断用户正在进行的其他工作。**

# c# - 上传 Excel 工作表并将数据导入 SQL Server Express 数据库

> ID：11268005
> 
> 赞同：2
> 
> 时间：2012-06-29T19:42:26.747
> 
> 标签：c#, asp.net-mvc-3, sql-server-2008

我正在使用我发现的帖子中的一个示例。这似乎很适合我正在做的事情。这是保存文件的代码：

```
[HttpPost]
public ActionResult FileUpload(HttpPostedFileBase excelFile)
{
   //Save the uploaded file to the disc.
   string savedFileName = "~/App_Data/uploads/";// +excelFile.FileName;
   string filePath = Path.Combine(savedFileName, excelFile.FileName); 
   excelFile.SaveAs(Server.MapPath(filePath));

   return View();
} 
```

以下是将数据放入数据库表的代码：

```
private void SaveFileToDatabase(string savedFileName)
{
    String strConnection = "Data Source=.\\SQLEXPRESS;AttachDbFilename='catalog=QQAEntities'Integrated Security=SSPI;User Instance=True";
    String connectionString = string.Format("Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0};Extended Properties=Excel 12.0;", Server.MapPath(savedFileName));
    {
    using (OleDbConnection connection = new OleDbConnection(connectionString))
    {
       using (OleDbCommand cmd = new OleDbCommand("SELECT * FROM [dbo_ts_quality_audit_tbl$]", connection))
       {
          connection.Open();

          using (OleDbDataReader dReader = cmd.ExecuteReader())
          {
             using (SqlBulkCopy sqlBulk = new SqlBulkCopy(strConnection))
             {
                 //Give your Destination table name 
                 sqlBulk.DestinationTableName = "AuditSchedules";
                 sqlBulk.WriteToServer(dReader);
             }
          }
       }
       }
   }
}

private string GetLocalFilePath(string saveDirectory, FileUpload fileUploadControl)
{
   //System.Web.UI.WebControls.WebControl
   string filePath = Path.Combine(saveDirectory, fileUploadControl.FileName);

   fileUploadControl.SaveAs(filePath);

   return filePath;
} 
```

这是 FileUpload 的视图：

```
<h2>FileUpload</h2>

@using (Html.BeginForm("FileUpload", "Admin", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
<input type="file" id="excelFile" name="excelFile" />
<input type="submit" value="Upload" />
} 
```

上传工作。我的问题是；如何`SaveFileToDatabase`在视图中调用数据传输 ()？这一切都将在管理部分完成。

此外，我已经在配置中连接到数据库 - 我该如何清理它？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:50:01.840

视图应该获取文件信息，然后将所有执行传递给控制器​​。在控制器内部，您应该调用 SaveFileToDatabase 函数并将您保存的临时文件传递给它，如下所示：

```
[HttpPost]
public ActionResult FileUpload(HttpPostedFileBase excelFile)
{
    //Save the uploaded file to the disc.
    string savedFileName = "~/App_Data/uploads/";// +excelFile.FileName;
    string filePath = Path.Combine(savedFileName, excelFile.FileName); 
    excelFile.SaveAs(Server.MapPath(filePath));

    // Call function to place temporary file into database
    SaveFileToDatabase(filePath);

    // Optional: Delete temporary Excel file from server

    return View();
} 
```

（不要忘记考虑是否要在服务器上保留临时 Excel 文件。如果没有，一旦知道处理已完成，您需要注意删除文件）

# java - Android 手势未被识别，但 onGesturePerformed() 被调用。如何让不同的手势被识别？

> ID：11268006
> 
> 赞同：1
> 
> 时间：2012-06-29T19:42:28.203
> 
> 标签：java, android, gesture, gestures, prediction

我试图让这段代码工作：
[http](http://scanplaygames.com/?p=168) ://scanplaygames.com/?p=168 （也在stackoverflow上）： [将GestureOverlayView添加到我的SurfaceView类，如何添加到视图层次结构？](https://stackoverflow.com/questions/3375967/adding-gestureoverlayview-to-my-surfaceview-class-how-to-add-to-view-hierarchy)

我运行了代码并添加了打印出预测的标签。

```
public void onGesturePerformed(GestureOverlayView overlay, Gesture gesture) 
{
    // TODO Auto-generated method stub
    ArrayList<Prediction> predictions = mLibrary.recognize(gesture);
    Log.d(TAG, predictions.toString()); 
```

... 之后，当我绘制手势时，会打印出一个空数组。

我究竟做错了什么？我怎么知道正在绘制哪些手势？这种方法是如何工作的？

另外，我的手势文件可能有问题吗？我只是不确定。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T22:25:43.117

我认为错误可能在于您使用预测。它是一个 ArrayList 所以你必须得到第一个（0）。

尝试这样的事情：

```
public void onGesturePerformed(GestureOverlayView overlay, Gesture gesture) {
    ArrayList<Prediction> predictions = mLibrary.recognize(gesture);

    // We want at least one prediction
    if (predictions.size() > 0) {
        Prediction prediction = predictions.get(0);
        // We want at least some confidence in the result
        if (prediction.score > 1.0) {
            // Show the spell
            Toast.makeText(this, prediction.name, Toast.LENGTH_SHORT).show();
        }
    }
} 
```

# grails - 在 Grails 中使用嵌套数组的 Groovy JSONBuilder

> ID：11268012
> 
> 赞同：1
> 
> 时间：2012-06-29T19:43:19.533
> 
> 标签：grails, groovy, jsonbuilder

有没有办法在 Groovy 中使用 JSONBuilder 嵌套 JSON 数组？更明确地说，我有一个 Grails 应用程序需要呈现如下内容：

```
{
    "event": {
        "type": "1.0",
        "templates": [
            {
                "template":{
                    "window": {
                        "type1": "id-1",
                        "type2": "id-2"
                    },
                    "object": {
                        "id-1": {
                            "type": "classA",
                            "others": [
                                {
                                    "var": "thing1",
                                    "mixed": "no"
                                }
                            ]
                        },
                        "id-2": {
                            "type": "classB",
                            "others": [
                                {
                                    "var": "thing1",
                                    "mixed": "yes"
                                }
                            ]
                        }
                    }
                }
            }
        ]
    }
} 
```

我在让我的 Grails 控制器使用该`render`函数以及在服务中显式使用 JSONBuilder 来构建它时遇到了一些麻烦。

除了“模板”数组中的“模板”对象没有被渲染之外，一切似乎都正常工作。这是进行渲染的代码：

```
render(contentType: "text/json") {
    event {
        type = "1.0"
        templates = array {
            template = {
                window = {
                    type1 = "id-1"
                    type2 = "id-2"
                }
                object = {
                    "${ 'id-1' }" {
                        type = "classA"
                        others = array {
                            otherArr(var:"thing1", mixed:"yes")
                        }
                    }
                    "${ 'id-2' }" {
                        type = "classB"
                        others = array {
                            otherArr(var:"thing1", mixed:"yes")
                        }
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T22:24:53.123

您在`array`封闭内缺少一个级别。试试这个：

```
templates = array {
  item {
    template = {
      window = {
        // ... 
```

# google-apps-script - 部署 UI Web 应用程序

> ID：11268013
> 
> 赞同：2
> 
> 时间：2012-06-29T19:43:37.110
> 
> 标签：google-apps-script

第一次在 GAS 中部署 UI Web 应用程序。尝试查看已部署的脚本 url 后获取“无法调用 null 的方法“getSheets””TypeError：

[https://script.google.com/macros/s/AKfycbzuQNbkTeBpRPz75Q4dRiVLfEYtuLiuBKnWeA5CbD0/dev](https://script.google.com/macros/s/AKfycbzuQNbkTeBpRPz75Q4dRiVLfEYtuLiuBKnWeA5CbD0/dev)

这是电子表格：

[https://docs.google.com/spreadsheet/ccc?key=0AnJTymuE8awLdHZ6QzhNVXpjeFphM3pMV1cxU0daZ2c](https://docs.google.com/spreadsheet/ccc?key=0AnJTymuE8awLdHZ6QzhNVXpjeFphM3pMV1cxU0daZ2c)

脚本代码：

```
// https://developers.google.com/apps-script/class_listbox - How to create listBox
function doGet() {
   //var ss = SpreadsheetApp.openById("0AnJTymuE8awLdHZ6QzhNVXpjeFphM3pMV1cxU0daZ2c");
   var ss = SpreadsheetApp.getActiveSpreadsheet();
   var sheet = ss.getSheets()[1];  
   var app = UiApp.createApplication().setTitle('App to show how ListBox data can update');
   var panel = app.createVerticalPanel();
   var lb = app.createListBox(true).setId('myLBid').setName('myLBname');

   // how many items to show
   lb.setVisibleItemCount(10);

   // get sorted names
   var rows = sheet.getDataRange();
   var numRows = rows.getNumRows();
   var values = rows.getValues();

   for (var i = 0; i <= numRows - 1; i++) {
     var row = values[i];
     lb.addItem(row);
   }

   panel.add(lb);
   var button = app.createButton('Submit');
   var handler = app.createServerClickHandler('respondToSubmit').addCallbackElement(panel);
   button.addClickHandler(handler);
   panel.add(button);
   app.add(panel);
   ss.show(app);
 }

// http://youtu.be/5VmEPo6Rkq4 - How to have sumbit write data to ss
function respondToSubmit(e) {
   var app = SpreadsheetApp.getActiveSpreadsheet();
   //reference widget name to capture what user selected
   var listBoxValue = e.parameter.myLBname;
   var ss = SpreadsheetApp.getActiveSpreadsheet();
   var sheet = ss.getSheets()[2];
   var lastRow = sheet.getLastRow()+1;
   var lastCell = sheet.getRange("A"+lastRow);
   lastCell.setValue(listBoxValue);
   return app.close();
}

/**
 * Adds a custom menu to the active spreadsheet, containing a single menu item
 * for invoking the readRows() function specified above.
 * The onOpen() function, when defined, is automatically invoked whenever the
 * spreadsheet is opened.
 * For more information on using the Spreadsheet API, see
 * https://developers.google.com/apps-script/service_spreadsheet
 */
function onOpen() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet();
  var entries = [{
    name : "Names",
    functionName : "doGet"
  }];
  sheet.addMenu("Script Menu", entries);
}; 
```

从编辑器运行时完美运行。

想找出我需要在代码中修改哪些内容才能使 Web 应用程序正常工作。我希望 UI 出现在脚本 url 中，就像在 ss.xml 中运行时一样。这不应该发生吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:07:29.070

编辑：哎呀，对不起，我没有注意到其他一些错误，请查看有关[webApps 和电子表格 UI 之间差异](https://developers.google.com/apps-script/uiapp?hl=fr-FR#Deploying)的文档，然后阅读我的答案。

你为什么评论这条线？

`SpreadsheetApp.openById("0AnJTymuE8awLdHZ6QzhNVXpjeFphM3pMV1cxU0daZ2c");`

当作为 web 应用程序运行时，您应该始终按 ID 打开电子表格，因为没有活动的电子表格（从电子表格查看没有**用户**打开电子表格，只有脚本有......）

*另外： “我希望 UI 出现在脚本 url 中”*到底是什么意思？

当您转到部署它时将创建的 url 时，您的 Ui 将显示为一个独立的应用程序。（您也必须保存它的一个版本，但这样做的时候已经很好地解释了）

# admob - Admob 中介 iAd 测试

> ID：11268014
> 
> 赞同：2
> 
> 时间：2012-06-29T19:43:40.273
> 
> 标签：admob, iad

我似乎有 admob 调解工作正常。我宁愿先使用 iAd，然后再使用 admob 填充。问题是我在 iTunes 连接中收到零 iAd 请求。我什至将百分比设置为 100%。我启用了它，一切都在 admob 中。任何人都知道如何使用 admob 中介测试 iAd？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T19:50:08.410

问题可能不在于 admob 中介，而在于 iAd 填充率。他们的填充率在历史上一直很低，最近今年，许多应用程序的填充率下降到 5% 左右。

看到这个答案 [在程序中看不到 iAd？](https://stackoverflow.com/questions/3361464/can-not-see-iad-in-program)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T01:19:52.927

这不可能。我将 admob 保持在 10% 的低设置，因此大多数广告来自其他网络。

# jmeter - 如何在Jmeter中获取jmeter脚本的目录

> ID：11268015
> 
> 赞同：12
> 
> 时间：2012-06-29T19:43:40.443
> 
> 标签：jmeter

我有一个用 java 编写的自定义 jmeter 采样器，它将文件位置和文件路径作为参数，并基于这些创建一个用于发布到服务的 json 文件（基于模板文件）。由于我的脚本需要在具有不同目录结构的多个环境中运行，因此我需要在采样器中使用相对路径来指向我需要转换为有效 json 的文件。有没有办法让我的脚本所在的目录作为jmeter中的变量？我试过 ${user.dir}，但它返回 jmeter 启动的目录，而不是我的脚本所在的目录。我可以参考另一个系统属性来获取这个值吗？如果没有，是否有人以编程方式完成此操作？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-09-03T10:23:31.687

不久前我遇到了类似的情况，我必须上传签名文件作为 POST 请求的一部分。这个签名文件相对于我的 JMeter 脚本所在的文件夹结构存在。

尝试使用以下 BeanShell 表达式（可以作为系统级属性访问）来解析 JMeter 测试用例所在/执行位置的相对路径。

```
${__BeanShell(import org.apache.jmeter.services.FileServer; FileServer.getFileServer().getBaseDir();)}${__BeanShell(File.separator,)} 
```

*   您可以通过简单地附加文件名，在“使用请求发送文件”字段中输入要发送/发布的文件的名称。

    `${__BeanShell(import org.apache.jmeter.services.FileServer; FileServer.getFileServer().getBaseDir();)}${__BeanShell(File.separator,)}fileName.sig`

*   更简洁的实现是将其声明为变量（本地或全局取决于范围）并在适当的字段中使用此变量。

    `absolutePath = ${__BeanShell(import org.apache.jmeter.services.FileServer; FileServer.getFileServer().getBaseDir();)}${__BeanShell(File.separator,)}`

    `${absolutePath}fileName.sig`

***注意：**如果您打算将 JMeter 测试文件插入 Jenkins 等持续集成系统，这种方法非常有用。它使您的测试用例更易于维护。*

# cakephp - 哪个控制器正在设置闪烁消息？

> ID：11268017
> 
> 赞同：0
> 
> 时间：2012-06-29T19:43:47.053
> 
> 标签：cakephp, cakephp-1.3

有没有办法——除了查看我所有的代码——找出哪个控制器正在设置一个闪存消息？

我有这条消息显示在所有页面上，除了`admin_`页面，我显然是在测试期间的某个时候设置的，但我想摆脱。

我已经搜索了我的大部分代码，`$this->Session->setFlash`但我似乎无法找到问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T22:17:36.893

简而言之，没有。从技术上讲，可以从任何地方设置 flash 消息，因为它只是一个会话值。相反，您可以调试闪存消息正上方的位置。

在您看来，在设置 flash 消息的位置下添加调试语句。

```
echo $this->Session->flash();
debug($this->here); 
```

# mysql - SQL：如何计算有限行并重置计数器

> ID：11268018
> 
> 赞同：0
> 
> 时间：2012-06-29T19:43:54.630
> 
> 标签：mysql, sql

我正在处理一个问题，需要一些专家建议来解决这个问题，我的 sql 查询生成包含两列的输出，第一列显示 id（例如下表中的 abc-123），下一列显示与存储的 id 对应的结果在 db 中是通过还是失败。

我需要实现，当分辨率通过时，它应该显示成功尝试，在下面的示例中，abc-123 第一次失败，但是 def-456 在下一次尝试中通过，因此成功率为 50%，现在计数器应该重置并转到下一行有通过，因此它应该显示 100%，再次当代码命中通过计数器重置然后下一步并显示 33% 因为最后有两个失败和一个通过，如何在 sql 中实现？（id 和 resolution 是列名）

```
**date**       **id resolution**    
 6/6/2012     abc-123   fail       50%
 6/7/2012     abc-456   pass    
 6/8/2012     abc-789   pass       100%
 6/9/2012     abc-799   fail       33%
 6/10/2012    abc-800   fail    
 6/1/2012     abc-900   pass 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:05:16.873

```
SELECT
  *
FROM
  table
INNER JOIN
(
  SELECT
    MIN(g.id)   AS first_id,
    MAX(g.id)   AS last_id,
    COUNT(*)    AS group_size
  FROM
    table AS p
  INNER JOIN
    table AS g
      ON g.id > COALESCE(
                  (SELECT MAX(id) FROM table WHERE id < p.id AND resolution = 'pass'),
                  ''
                )
     AND g.id <= p.id
  WHERE
    p.resolution = 'pass'
  GROUP BY
    p.id
)
  AS groups
    ON  table.id >= groups.first_id
    AND table.id <= groups.last_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T20:16:15.537

有不止一种方法可以做到：

```
SELECT st.*, 
       @prev:=@counter + 1,
       @counter:= CASE 
         WHEN st.resolution = 'pass'
         THEN 0
         ELSE @counter + 1
       END c,
       CASE WHEN @counter = 0 
            THEN CONCAT(FORMAT(100/@prev, 2), '%') 
            ELSE '-' 
       END res
  FROM so_test st, (SELECT @counter:=0) sc 
```

这[是概念证明](http://sqlfiddle.com/#!2/68600/19)。

# c++ - Outlook pst 文件 - 密码读取

> ID：11268020
> 
> 赞同：0
> 
> 时间：2012-06-29T19:43:55.293
> 
> 标签：c++, outlook, passwords

我想知道如何从 pst 文件中恢复/读取密码？

我阅读了一些文章，发现 pst 文件中的密码是由 CRC32 实现的。

没关系，但我想知道此密码包含在 pst 文件中的什么位置？我必须知道这个密码在这个文件中的位置。

我在想，也许你会有一些关于“读取 pst 密码的算法……如何……”的信息。</p>

你能这么好心，把任何有关它的信息发给我吗？

我对任何诸如 PST .NET 之类的书面软件或可以帮助您返回密码的应用程序不感兴趣，我想知道如何自己用 C++ 语言编写它...

请给我一个线索...

我期待着您的来信。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:23:07.227

Microsoft 有一些关于 PST[文件](http://msdn.microsoft.com/en-us/library/ff385210.aspx)格式的文档。[密码](http://msdn.microsoft.com/en-us/library/ff385916%28v=office.12%29)本身存储在消息存储的特定属性中。

# random - 使用 Random123 的 OpenCL 随机数

> ID：11268023
> 
> 赞同：3
> 
> 时间：2012-06-29T19:44:04.900
> 
> 标签：random, opencl

我一直在查看这个 lib [Random123](http://www.thesalmons.org/john/random123/releases/1.06/docs/index.html)和相关引用：

> 一位神秘人来到我的展位，询问我对使用 OpenCL 生成随机数的了解。我告诉他有关 Mersenne Twister 的实现，但他没有留下深刻的印象。他告诉我一篇新的技术论文，它解释了如何通过结合整数计数器和分组密码在 GPU 上生成随机数。他用恭敬的语气说，基于计数器的随机数生成器 (CBRNG) 生成的数字比 MT 具有更大的统计随机性和更快的速度。

我能够使用这个内核运行一个演示：

```
__kernel void counthits(unsigned n, __global uint2 *hitsp) {
    unsigned tid = get_global_id(0);
    unsigned hits = 0, tries = 0;
    threefry4x32_key_t k = {{tid, 0xdecafbad, 0xfacebead, 0x12345678}};
    threefry4x32_ctr_t c = {{0, 0xf00dcafe, 0xdeadbeef, 0xbeeff00d}};
    while (tries < n) {
        union {
            threefry4x32_ctr_t c;
            int4 i;
        } u;
        c.v[0]++;
        u.c = threefry4x32(c, k);
        long x1 = u.i.x, y1 = u.i.y;
        long x2 = u.i.z, y2 = u.i.w;
        if ((x1*x1 + y1*y1) < (1L<<62)) {
            hits++;
        }
        tries++;
        if ((x2*x2 + y2*y2) < (1L<<62)) {
            hits++;
        }
        tries++;
    }
    hitsp[tid].x = hits;
    hitsp[tid].y = tries;
} 
```

我现在的问题是，这不会在每次运行时生成相同的随机数吗，随机数是基于全局 id 的吗？如何每次生成新的随机数。可以提供种子作为内核的参数然后以某种方式使用它吗？

任何一直在使用这个库并且可以让我对它的使用有更多了解的人吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T16:06:01.730

是的。示例代码每次调用时都会生成相同的随机数序列。

要获得不同的随机数流，只需以不同方式初始化任何值 k[1..3] 和/或 c[1..3]。您可以从命令行参数、环境变量、时间、保存状态、/dev/urandom 或任何其他来源初始化它们。请注意：

a) 如果您在两次不同的运行中以完全相同的方式初始化它们，那么这两次运行将获得相同的随机数流

b) 如果您在两次不同的运行中以不同方式初始化它们，那么这两次运行将获得不同的随机数流。

有时你想要财产 a)。有时你想要属性 b)。花点时间想想你想要什么，并确保你正在做你想做的事。

更一般地，库中的函数，例如threefry4x32，**没有状态**。如果您更改输入中的任何位（即，c 或 k 的任何元素中的任何位），您将获得完全不同的随机、统计独立、均匀分布的输出。

PS我是图书馆的作者之一，论文“Parallel Numbers: As Easy as 1, 2, 3”： [http ://dl.acm.org/citation.cfm?id=2063405](http://dl.acm.org/citation.cfm?id=2063405)

如果您不是 ACM 数字图书馆的订阅者，上面的链接可能会遇到付费问题。或者，您可以通过点击此页面上的链接免费获取该论文：

[http://www.thesalmons.org/john/random123/index.html](http://www.thesalmons.org/john/random123/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T21:23:25.837

对于库本身，我无法为您提供帮助，但我可以告诉您，在 OpenCL 中生成随机数的最常见方法是在调用内核之间保存一些状态。

随机数生成器通常使用一个状态，从中生成一个新状态和一个随机数。实际上，这并不复杂：您只需传递一个保存状态的额外数组。在我的代码中，我实现了如下随机数：

```
uint rand_uint(uint2* rvec) {  //Adapted from http://cas.ee.ic.ac.uk/people/dt10/research/rngs-gpu-mwc64x.html
    #define A 4294883355U
    uint x=rvec->x, c=rvec->y; //Unpack the state
    uint res = x ^ c;          //Calculate the result
    uint hi = mul_hi(x,A);     //Step the RNG
    x = x*A + c;
    c = hi + (x<c);
    *rvec = (uint2)(x,c);      //Pack the state back up
    return res;                //Return the next result
    #undef A
}
inline float rand_float(uint2* rvec) {
    return (float)(rand_uint(rvec)) / (float)(0xFFFFFFFF);
}
__kernel void my_kernel(/*more arguments*/ __global uint2* randoms) {
    int index = get_global_id(0);
    uint2 rvec = randoms[index];

    //Call rand_uint or rand_float a number of times with "rvec" as argument.
    //These calls update "rvec" with new state, and return a random number

    randoms[index] = rvec;
} 
```

. . . 然后，您所做的就是传递一个额外的数组，将 RNG 的状态保存为随机数。在实践中，您会希望为每个工作项以不同的方式播种此数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T20:11:45.060

`0xdecafbad`, `0xfacebead`,`0x12345678`和`0xf00dcafe`,只是任意选择的数字`0xdeadbeef`，`0xbeeff00d`它们并不特殊。可以使用任何其他数字（甚至 0）来代替它们——我将在示例代码中添加注释。

你可以用你传入的变量替换它们中的任何一个；避免在输出随机“流”中出现不必要的重复的唯一要求是避免重复 (c, k) 输入元组。示例代码使用线程 id 和循环索引来确保唯一性，但您可以轻松添加更多变量以确保唯一性 - 例如计算主机代码中的内核调用并将该计数器传入，使用它来代替元素之一k 或 c。

顺便说一句，尽管名称为“基于计数器的随机数生成器”，但并不要求输入 (c, k) 是“计数器”，只是计数器恰好是确保输入不重复。

# c++ - C++ 查看堆栈以获取调用者信息

> ID：11268030
> 
> 赞同：1
> 
> 时间：2012-06-29T19:44:47.327
> 
> 标签：c++, debugging, stack

是否有可能通过将地址映射到调试 .map 文件或其他东西来“窥视”堆栈以推断出调用函数是什么？

我有一个从大量不同地方调用的函数，基本上，如果可能的话，我希望能够以编程方式注销谁调用了该函数，以便我可以跟踪参数值随时间的进展，并能够连接他们回到他们可能出错的地方。我可以添加一个参数，以便调用者必须提供用户字符串或其他内容，但如果可能的话，我想做一些不那么侵入性的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:51:59.700

GCC 有这方面的功能，例如 __builtin_return_address （参见[http://gcc.gnu.org/onlinedocs/gcc/Return-Address.html](http://gcc.gnu.org/onlinedocs/gcc/Return-Address.html)）。它们应仅用于调试或特殊测试目的，而不应作为生产代码的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T19:59:56.157

您可以[使用 Windows API 生成 MiniDump 文件](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680369%28v=vs.85%29.aspx)并稍后在调试器中加载它们，如果符号可用，您应该能够调试崩溃并调查变量的值。

# android - 动画中的延迟 (TranslateAnimation)

> ID：11268033
> 
> 赞同：16
> 
> 时间：2012-06-29T19:44:51.650
> 
> 标签：android, android-animation, translate-animation

有没有办法`Animation`暂停半秒？

我正在尝试使用`TranslateAnimation`API 制作无限动画。所以，我使用`RepeatCount`as `Infinite`。我还注意到有一种`setStartOffset(...)`方法可以解决我想要延迟启动动画的情况。但是，我找不到在每次“重新启动”之前延迟的方法。由于动画会无限次发生，所以每次动画重新启动时我都需要延迟。

有任何想法吗？

谢谢！！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T20:50:28.420

这是一个例子：

首先是带有我们想要动画的图像的布局（main.xml）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_launcher" />

</LinearLayout> 
```

下一个是动画。放置在 res/anim 中，名为 anim_img.xml。该文件包含 android:startOffset="500"（以毫秒为单位）的翻译动画。这将设置每次动画开始时使用的偏移量：

```
<?xml version="1.0" encoding="utf-8"?>
<set>

    <translate
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:duration="1000"
        android:fromXDelta="0%"
        android:fromYDelta="0%"
        android:toXDelta="0%"
        android:toYDelta="100%"
        android:zAdjustment="top" 
        android:repeatCount="infinite"
        android:startOffset="500"/>

</set> 
```

最后但并非最不重要的 - 活动。启动动画：

```
public class StackOverflowActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        ImageView iv_icon = (ImageView) findViewById(R.id.imageView1);

        Animation a = AnimationUtils.loadAnimation(this, R.anim.anim_img);
        a.setFillAfter(true);
        a.reset();

        iv_icon.startAnimation(a);
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-12T21:18:01.163

要在每次重启之间实现 x 毫秒的暂停：

```
myAnimation.setAnimationListener(new AnimationListener(){

        @Override
        public void onAnimationStart(Animation arg0) {
        }
        @Override
        public void onAnimationEnd(Animation animation) {
        }

        @Override
        public void onAnimationRepeat(Animation animation) {
            myAnimation.setStartOffset(x);
        }

    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-03T01:25:01.453

myanimation.setStartDelay(int);

# wpf - WPF - 如何创建将样式应用于子类型的样式

> ID：11268034
> 
> 赞同：9
> 
> 时间：2012-06-29T19:44:53.287
> 
> 标签：wpf, xaml, styles, tablecell

我正在尝试获得一种样式以将另一种样式应用于某种类型的元素。类似于你会做的 CSS

```
div a  
{  
    background-color:red;  
} 
```

为 <div> 元素包含的所有 <a> 元素应用红色背景。

具体来说，我试图让包含在具有特定样式的 TableRowGroup 中的所有 TableCells 来改变它们的边界。

我有以下解决方案，其中每个单元格样式都是单独设置的。

```
<Table>
    <Table.Columns>
        <TableColumn/>
        <TableColumn/>
    </Table.Columns>

    <Table.Resources>
        <Style x:Key="HeaderStyle" TargetType="{x:Type TableRowGroup}">
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>

        <Style x:Key="HeaderCellStyle" TargetType="{x:Type TableCell}">
            <Setter Property="BorderThickness" Value="0,1,0,1" />
            <Setter Property="BorderBrush" Value="Black" />
        </Style>
    </Table.Resources>

    <TableRowGroup Name="TableColumnHeaders" Style="{StaticResource HeaderStyle}">
        <TableRow>
            <TableCell Style="{StaticResource HeaderCellStyle}">
                <Paragraph>
                    Description
                </Paragraph>
            </TableCell>
            <TableCell Style="{StaticResource HeaderCellStyle}">
                <Paragraph>
                    Amount
                </Paragraph>
            </TableCell>
        </TableRow>
    </TableRowGroup>
</Table> 
```

这显然不是首选，因为当有许多单元格时它会使 xaml 膨胀。

我尝试了以下但没有成功。

```
<Table.Resources>
    <Style x:Key="HeaderStyle" TargetType="{x:Type TableRowGroup}">
        <Style.Resources>
            <Style TargetType="{x:Type TableCell}">
                <Setter Property="BorderThickness" Value="0,1,0,1" />
                <Setter Property="BorderBrush" Value="Black" />
            </Style>
        </Style.Resources>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="FontSize" Value="12"/>
    </Style>
</Table.Resources> 
```

由于某种原因，这也不起作用，尽管是有效的

```
<Table.Resources>
    <Style x:Key="HeaderStyle" TargetType="{x:Type TableRowGroup}">
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="FontSize" Value="12"/>
        <Setter Property="TableCell.BorderThickness" Value="0,1,0,1" />
        <Setter Property="TableCell.BorderBrush" Value="Black" />
    </Style>
</Table.Resources> 
```

将有几个行组，每个组都有自己的单元格样式，每个组都包含许多单元格。请告诉我有更好的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T12:24:12.123

**根据您的评论更新**

根据您的评论，我相信您的问题可以使用`Style`继承轻松解决。下面是在不同 TableRowGroups 上使用 2 种不同单元格样式的示例：

```
<Table>
    <Table.Resources>

        <Style x:Key="HeaderCellStyle" TargetType="{x:Type TableCell}">
            <Setter Property="BorderThickness" Value="0,1,0,1" />
            <Setter Property="BorderBrush" Value="Black" />
            <Setter Property="TextAlignment" Value="Center" />
            <Setter Property="FontStyle" Value="Italic" />
            <Setter Property="Padding" Value="5" />
        </Style>

        <Style x:Key="FooterCellStyle" BasedOn="{StaticResource HeaderCellStyle}" TargetType="{x:Type TableCell}">
            <Setter Property="Background" Value="AliceBlue" />
            <Setter Property="TextAlignment" Value="Right" />
            <Setter Property="FontWeight" Value="Bold" />
        </Style>

        <Style x:Key="HeaderTableRowGroupStyle" TargetType="{x:Type TableRowGroup}">
            <Style.Resources>
                <Style BasedOn="{StaticResource HeaderCellStyle}" TargetType="{x:Type TableCell}" />
            </Style.Resources>
        </Style>

        <Style x:Key="FooterTableRowGroupStyle" TargetType="{x:Type TableRowGroup}">
            <Style.Resources>
                <Style BasedOn="{StaticResource FooterCellStyle}" TargetType="{x:Type TableCell}" />
            </Style.Resources>
        </Style>

    </Table.Resources>
    <Table.Columns>
        <TableColumn />
        <TableColumn />
        <TableColumn />
        <TableColumn />
    </Table.Columns>

    <!--  This TableRowGroup hosts a header row for the table.  -->
    <TableRowGroup Style="{StaticResource HeaderTableRowGroupStyle}">
        <TableRow>
            <TableCell />
            <TableCell>
                <Paragraph>Gizmos</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>Thingamajigs</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>Doohickies</Paragraph>
            </TableCell>
        </TableRow>
    </TableRowGroup>

    <!--  This TableRowGroup hosts the main data rows for the table.  -->
    <TableRowGroup>
        <TableRow>
            <TableCell>
                <Paragraph>Blue</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>1</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>2</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>3</Paragraph>
            </TableCell>
        </TableRow>
        <TableRow>
            <TableCell>
                <Paragraph>Red</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>1</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>2</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>3</Paragraph>
            </TableCell>
        </TableRow>
        <TableRow>
            <TableCell>
                <Paragraph>Green</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>1</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>2</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>3</Paragraph>
            </TableCell>
        </TableRow>
    </TableRowGroup>

    <!--  This TableRowGroup hosts a footer row for the table.  -->
    <TableRowGroup Style="{StaticResource FooterTableRowGroupStyle}">
        <TableRow>
            <TableCell>
                <Paragraph>Totals</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>3</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>6</Paragraph>
            </TableCell>
            <TableCell>
                <Paragraph>9</Paragraph>
            </TableCell>
        </TableRow>
    </TableRowGroup>
</Table> 
```

每当您想要定义一个`Style`将针对特定类型的所有元素的一般时，您都不能为该样式指定 Key。尝试从 Style 中删除 x:Key ，一切都应该正常工作，如下所示：

```
<Table.Resources>
    <Style TargetType="{x:Type TableRowGroup}">
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="FontSize" Value="12"/>
        <Setter Property="TableCell.BorderThickness" Value="0,1,0,1" />
        <Setter Property="TableCell.BorderBrush" Value="Black" />
    </Style>
</Table.Resources> 
```

# python - 在 python 中使用请求发布到 html 表单？

> ID：11268039
> 
> 赞同：1
> 
> 时间：2012-06-29T19:45:10.067
> 
> 标签：python, post, python-requests

如果我试图用谷歌搜索某些东西，我将如何发送要搜索的数据以进行搜索？我知道您可以将其添加到 url，但我不想这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:49:32.550

使用请求库。您可以像使用 .get 方法一样使用 .post 方法。将数据作为字典传递给函数的数据参数。

快速入门文档在这里描述它[http://requests.readthedocs.org/en/latest/user/quickstart/#more-complicated-post-requests](http://requests.readthedocs.org/en/latest/user/quickstart/#more-complicated-post-requests)

如果使用 urllib 或 urllib2 `data`，则 urlopen 函数的参数会将`POST`数据发送到页面而不是页面`GET`。

在这里查看文档[http://docs.python.org/library/urllib.html#urllib.urlopen](http://docs.python.org/library/urllib.html#urllib.urlopen)

# java - 小程序中未显示图像

> ID：11268040
> 
> 赞同：1
> 
> 时间：2012-06-29T19:45:13.507
> 
> 标签：java, image, applet

我有一个小的 JApplet，它应该只是导入图像并将其显示在屏幕上。但是，我遇到了一些麻烦。

```
private Image logo1;

public void init() {
    logo1 = getImage( getCodeBase(), "Penguins.jpg" );
}

@Override
public void paint( Graphics g ) {
    g.drawImage( logo1, 0, 0, this );
} 
```

这基本上是我的整个程序。有什么问题吗？我假设其中一个问题可能是图片可能必须在您计算机的特定部分或类似的东西中...该图片的地址是 C:\Users\Public\Pictures\Sample Pictures

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T00:19:47.713

`getCodeBase()`方法调用中的原因`getImage()`是为了获取代码库位置。

代码库是包含所有源代码包的文件夹。它很可能是`src`您项目文件夹上方的文件夹。这是一个普通项目（至少我的项目）的基本结构：

> -MyProject -*这是代码库*
>   -src -*你的所有代码可能都在这个文件夹中。所有包在此处显示为文件夹*
>   -bin -*当您的代码编译时，它会在此处结束*
>   -data -*这是所有资源所在的位置（我的偏好）*
>     -images -*很明显，图像会放在这里*
>       -Penguin.jpg -*你的形象*

所有这些都导致了这个答案：使用上述结构，您的调用`getImage()`应为：

```
getImage(getCodeBase(), 'data/images/Penguin.jpg'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-05T22:53:31.590

```
public void init() {
        Picture =  getImage(getDocumentBase(),"image.gif");
} 
```

我使用此代码。执行以下步骤来添加您的图像：

1.  清理并构建项目
2.  将图像添加到项目的构建文件夹中。
3.  运行项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-30T20:00:50.643

尝试将要显示的图像包含在 java 程序的文件夹中。有时如果图像在另一个文件夹中，它不会显示在小程序中。我也遇到了类似的问题。只需将图像复制到您的项目文件夹中。

# wcf - Wcf 服务发送具有空值的类对象列表

> ID：11268041
> 
> 赞同：0
> 
> 时间：2012-06-29T19:45:18.280
> 
> 标签：wcf, list, class, object, contract

问题是当 wcf 服务向客户端发送类对象列表时，这些值为空。任何帮助或指导表示赞赏。

**我的服务接口是**

## **IPswdService.cs**

```
namespace GetPasswordsSvc
{
    [ServiceContract]
    public interface IPswdService
    {
        [OperationContract]
        List<dbVal> GetData(int value);
    }

[DataContract]
    public class dbVal
    {
        public string Group;
        public string Title;
        public string Username;
    } ;
} 
```

* * *

## GetPasswords.svc.cs

```
namespace GetPasswordsSvc
{
    public class PswdService : IPswdService
    {

       public List<dbVal> GetData(int value)
        {
          List<dbVal> kpdata= (from entry in db.RootGroup.GetEntries(true)
                         select new dbVal
                         {
                             Group = entry.ParentGroup.Name,
                             Title = entry.Strings.ReadSafe("Title"),
                             Username = entry.Strings.ReadSafe("UserName"),
                         }).ToList();

            List<dbVal> l = kpdata.ToList();
             return l;
        } 
```

=======================================

# WCF 客户端代码

```
SvcRef.PswdServiceClient wcfClient = new SvcRef.PswdServiceClient();
wcfClient.Open();
List<GetPasswords.dbVal> dbValues = wcfClient.GetData(0); 
```

===============================================

## 客户端配置文件是

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_IPswdService" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://xxxxxxx:444/GetPasswords.svc" binding="basicHttpBinding"
        bindingConfiguration="BasicHttpBinding_IPswdService" contract="SvcRef.IPswdService"
        name="BasicHttpBinding_IPswdService" />
    </client>
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:18:56.310

很难确切地说出原因是什么，但只要看看您的服务数据合同，我可以看到您错过了`DataMember`数据合同字段上的属性，您的数据合同应该是：

```
[DataContract]
public class dbVal
{
    [DataMember]
    public string Group;
    [DataMember]
    public string Title;
    [DataMember]
    public string Username;
} 
```

# mongodb - 在 Mongodb 中使用字符串与 id 作为外键

> ID：11268045
> 
> 赞同：0
> 
> 时间：2012-06-29T19:45:37.853
> 
> 标签：mongodb, foreign-keys, schema, database, nosql

我有一个集合`users`，其文件将属于 a `company`（每个公司可以有很多`users`）。因为我对公司名称设置了唯一索引，所以我可以使用名称作为`user`文档内部的外键，还是建议使用 id 代替？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:14:54.700

如果名称是唯一的并且保证永远不会更改，那么您可以使用它，没问题。尽管在我的实践中，有时名称变得不那么独特且不那么不变（该死的要求更改）。因此，为了更加安全，请使用 id。

# c# - 获取进程互斥列表

> ID：11268047
> 
> 赞同：2
> 
> 时间：2012-06-29T19:45:48.857
> 
> 标签：c#, .net, list, process, mutex

我有一个进程 ID 列表，我想列出该进程拥有的所有互斥锁。

我正在尝试在 C# 中执行此操作，但我无法找到执行此操作的方法。

到目前为止，我得到了：

```
foreach(Process thisProcess in processlist)
{
    Console.WriteLine("{0} {1}", thisProcess.ProcessName, thisProcess.Id);
} 
```

这将列出所有进程 ID，但需要它们拥有的互斥锁。

我读过一些关于使用 NTDLL.dll 的内容，但现在不知道如何使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:34:37.453

枚举互斥锁是使用“内核对象”的一般工作的一部分。在深入研究此类代码之前，阅读[“Windows Internals”一书是个好主意。](http://technet.microsoft.com/en-us/sysinternals/bb963901.aspx)

这是一个链接，提供有关[枚举内核对象的](http://www.bing.com/search?q=enumerate++kernel+object+&qs=HS&form=QBRE&pq=enumerate+kernel+object)[一些信息](http://forum.sysinternals.com/topic9529.html)

> 将 ZwQuerySystemInformation 与 SystemHandleInformation、ZwDuplicateObject、ZwQueryObject 与 ObjectNameInformation 一起使用。

# expressionengine - 如何使用 ExpressionEngines 模棱两可的频道字段 ID 保持理智？

> ID：11268048
> 
> 赞同：1
> 
> 时间：2012-06-29T19:45:51.663
> 
> 标签：expressionengine

在编写查询或运行结果集时，我经常不得不将字段称为“field_id_X”。我想相信有一种比为每个 field_id/name 对定义一个 CONST 更明智的方法。

```
define(NAME_FIELD ,'field_id_3');
define(HEIGHT_FIELD, 'field_id_4');

foreach( $result as $row ){
    $name = $row[NAME_FIELD]; // :(
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T18:00:38.230

获取字段 ID 和名称的数组...

```
function getFieldReferences() {
    $sql = "SELECT field_id, field_name
        FROM exp_channel_fields
       WHERE site_id = ".$this->EE->config->item('site_id');
    $result = $this->EE->db->query($sql);

    if ($result->num_rows() > 0) {
        $result = $result->result_array();
        $finalResult = array();
        foreach ($result as $row)
            $finalResult[$row["field_id"]] = $row["field_name"];

        return $finalResult;
    } else {
        return false;
    }
} 
```

特定条目详细信息的示例转换 $entry_id...

```
$sql = "SELECT exp_channel_data.*, exp_channel_titles.*, exp_channels.channel_name
          FROM exp_channel_data, exp_channel_titles, exp_channels
         WHERE exp_channel_data.entry_id = $entry_id
           AND exp_cart_products.entry_id = $entry_id
           AND exp_channel_titles.entry_id = $entry_id
         LIMIT = 1";
$result = $this->EE->db->query($sql);
if ($result->num_rows() > 0) {
        $result = $result->result_array();
        $result = $result[0];

        //###   Get Field Titles   ###
        $fieldReferences = getFieldReferences();

        //###   Replace Field ID reference with name   ###
        foreach ($result as $key => $value) {
            if (substr($key,0,9) == "field_id_") {
                $result[$fieldReferences[substr($key,9)]] = $value;
                unset($result[$key]);
            }
            if (substr($key,0,9) == "field_ft_")
                unset($result[$key]);
        }//###   End of foreach   ###
} 
```

根据指定的成员 $id 将成员字段转换为名称...

```
$sql = "SELECT m_field_id, m_field_name
      FROM exp_member_fields";
$result = $this->EE->db->query($sql);
if ($result->num_rows() > 0) {
    $memberFields = $result->result_array();

    $sql = "SELECT exp_member_data.*, exp_members.email
          FROM exp_member_data, exp_members
         WHERE exp_member_data.member_id = $id
           AND exp_members.member_id = $id
         LIMIT 1";

    $result = $this->EE->db->query($sql);
    if ($result->num_rows() > 0) {
    $result = $result->result_array();
    $rawMemberDetails = $result[0];

    //###   Loop through each Member field assigning it the correct name   ###
    foreach($memberFields as $row)
        $memberDetails[ $row['m_field_name'] ] = $rawMemberDetails['m_field_id_'.$row['m_field_id']];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T15:08:03.520

您可以通过**exp_channel_data中的****field_id**查找**exp_channel_fields.field_name**（或 field_label）。

# java - Spring：使用@Value注解时，Bean无法从外部属性文件中读取值

> ID：11268049
> 
> 赞同：0
> 
> 时间：2012-06-29T19:45:58.240
> 
> 标签：java, spring, annotations, spring-annotations

**XML 配置**

```
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

    <util:properties id="mongoProperties" location="file:///storage/local.properties" />

    <bean id="mongoService" class="com.business.persist.MongoService"></bean>
</beans> 
```

MongoService 看起来像

```
@Service
public class MongoService {

    @Value("#{mongoProperties[host]}")
    private String host;

    @Value("#{mongoProperties[port]}")
    private int port;

    @Value("#{mongoProperties[database]}")
    private String database;

    private Mongo mongo;

    private static final Logger LOGGER = LoggerFactory.getLogger(MongoService.class);

    public MongoService() throws UnknownHostException {
        LOGGER.info("host=" + host + ", port=" + port + ", database=" + database);
        mongo = new Mongo(host, port);
    }

    public void putDocument(@Nonnull final DBObject document) {
        LOGGER.info("inserting document - " + document.toString());
        mongo.getDB(database).getCollection(getCollectionName(document)).insert(document, WriteConcern.SAFE);
    } 
```

我把我的 MongoServiceTest 写成

```
public class MongoServiceTest {

    @Autowired
    private MongoService mongoService;

    public MongoServiceTest() throws UnknownHostException {
        mongoRule = new MongoRule();
    }

    @Test
    public void testMongoService() {
        final DBObject document = DBContract.getUniqueQuery("001");
        document.put(DBContract.RVARIABLES, "values");
        document.put(DBContract.PVARIABLES, "values");

        mongoService.putDocument(document);
    } 
```

我认为测试中的失败是

```
12:37:25.224 [main] INFO  c.s.business.persist.MongoService - host=null, port=0, database=null
java.lang.NullPointerException
    at com.business.persist.MongoServiceTest.testMongoService(MongoServiceTest.java:40) 
```

这意味着 bean 无法从 local.properties 读取值

**本地属性**

```
### === MongoDB interaction === ###
host="127.0.0.1"
port=27017
database=contract 
```

我该如何解决？

**更新** 即使在为字段创建 setter/getter 之后，它似乎也没有读取值。我现在真是一头雾水。

**更新01**

添加 init() 方法并将其添加到 bean 后，它仍然不起作用。我什至没有看到记录消息
**XML**

```
<bean id="mongoService" class="com.business.persist.MongoService" init-method="init"></bean> 
```

**MongoService**

```
@Service
public class MongoService {

    @Value("#{mongoProperties['host']}")
    private String host;

    @Value("#{mongoProperties['port']}")
    private int port;

    @Value("#{mongoProperties['database']}")
    private String database;

    private Mongo mongo;

    private static final Logger LOGGER = LoggerFactory.getLogger(MongoService.class);

    public MongoService() {}

    public void init() throws UnknownHostException {
        LOGGER.info("host=" + host + ", port=" + port + ", database=" + database);
        mongo = new Mongo(host, port);
    }

    public void putDocument(@Nonnull final DBObject document) {
        LOGGER.info("inserting document - " + document.toString());
        mongo.getDB(database).getCollection(getCollectionName(document)).insert(document, WriteConcern.SAFE);
    } 
```

我怎么能调试这个问题？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:12:38.243

我在这里看到一个问题，您正在`MongoService`构造函数中实例化一个 Mongo 类，但是此时您的属性尚未基于`local.properties`文件注入，因此主机、端口和数据库的值在那里将为空。

相反，您可以做的是不在 Service 构造函数中实例化 Mongo 类，让属性以您的方式注入 MongoService ，然后将其创建为在设置属性后调用的 init 方法的一部分：

在 MongoService 中：

```
public void init(){
    mongo = new Mongo(host, port);
} 
```

并在您的 bean 配置中：

```
<bean id="mongoService" class="com.business.persist.MongoService" init-method="init"></bean> 
```

# ubuntu - 更新后统一破坏

> ID：11268050
> 
> 赞同：1
> 
> 时间：2012-06-29T19:45:58.980
> 
> 标签：ubuntu, apt-get, ubuntu-unity

Ubuntu 12.04

今天应用更新后，我失去了 unity3d。

apt-get 给出以下消息：

unity : 取决于: unity-common (= 5.12+bzr2444ubuntu0+709) 但要安装 5.12+bzr2445ubuntu0+709

关于如何降级或解决这种依赖关系的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T21:20:18.677

遇到了同样的问题。

在此处下载统一包：http: [//ppa.launchpad.net/unity-team/staging/ubuntu/pool/main/u/unity/unity_5.12+bzr2444ubuntu0+709_amd64.deb](http://ppa.launchpad.net/unity-team/staging/ubuntu/pool/main/u/unity/unity_5.12+bzr2444ubuntu0+709_amd64.deb)

并使用以下命令手动安装： sudo dpkg -i --force-all unity_5.12+bzr2444ubuntu0+709_amd64.deb

确保首先安装了 unity-common。

# c# - 使用正则表达式有效地解析 StreamReader

> ID：11268053
> 
> 赞同：4
> 
> 时间：2012-06-29T19:46:06.637
> 
> 标签：c#, multithreading, parallel-processing, streamreader

我有变量

```
 StreamReader DebugInfo = GetDebugInfo();
    var text = DebugInfo.ReadToEnd();  // takes 10 seconds!!! because there are a lot of students 
```

文本等于：

```
<student>
    <firstName>Antonio</firstName>
    <lastName>Namnum</lastName>
</student>
<student>
    <firstName>Alicia</firstName>
    <lastName>Garcia</lastName>
</student>
<student>
    <firstName>Christina</firstName>
    <lastName>SomeLattName</lastName>
</student>
... etc
.... many more students 
```

* * *

我现在在做什么是：

```
 StreamReader DebugInfo = GetDebugInfo();
  var text = DebugInfo.ReadToEnd(); // takes 10 seconds!!!

  var mtch = Regex.Match(text , @"(?s)<student>.+?</student>");
  // keep parsing the file while there are more students
  while (mtch.Success)
  {
     AddStudent(mtch.Value); // parse text node into object and add it to corresponding node
     mtch = mtch.NextMatch();
  } 
```

整个过程大约需要 25 秒。将 streamReader 转换为`var text = DebugInfo.ReadToEnd();`需要 10 秒的文本 ( )。另一部分大约需要 15 秒。我希望我能同时做这两个部分...

* * *

## 编辑

我想要类似的东西：

```
 const int bufferSize = 1024;

    var sb = new StringBuilder();

    Task.Factory.StartNew(() =>
    {
         Char[] buffer = new Char[bufferSize];
         int count = bufferSize;

         using (StreamReader sr = GetUnparsedDebugInfo())
         {

             while (count > 0)
             {
                 count = sr.Read(buffer, 0, bufferSize);
                 sb.Append(buffer, 0, count);
             }
         }

         var m = sb.ToString();
     });

     Thread.Sleep(100);

     // meanwhile string is being build start adding items

     var mtch = Regex.Match(sb.ToString(), @"(?s)<student>.+?</student>"); 

     // keep parsing the file while there are more nodes
     while (mtch.Success)
     {
         AddStudent(mtch.Value);
         mtch = mtch.NextMatch();
     } 
```

## 编辑 2

**概括**

**我忘了提抱歉，文本与 xml 非常相似，但事实并非如此。**这就是我必须使用正则表达式的原因......简而言之，我认为我可以节省时间，因为我正在做的是将流转换为字符串然后解析字符串。为什么不用正则表达式解析流。或者，如果这不可能，为什么不获取流的一部分并在单独的线程中解析该块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:20:48.570

更新：

此基本代码在 0.75 秒内读取（大约）20 兆字节的文件。我的机器应该在您引用的那 2 秒内大致处理 53.33 兆字节。此外，20,000,000 / 2,048 = 9765.625。.75 / 9765.625 = .0000768。这意味着您大约每 768 万分之一秒读取 2048 个字符。您需要了解与迭代时间相关的上下文切换成本，以确定增加的多线程复杂性是否合适。在 7.68X10^5 秒时，我看到您的读者线程大部分时间都处于空闲状态。这对我来说没有意义。只需对单个线程使用单个循环。

```
char[] buffer = new char[2048];
StreamReader sr = new StreamReader(@"C:\20meg.bin");
while(sr.Read(buffer, 0, 2048) != 0)
{
    ; // do nothing
} 
```

对于像这样的大型操作，您希望使用只进、非缓存的读取器。看起来您的数据是 XML，因此 XmlTextReader 非常适合。这是一些示例代码。希望这可以帮助。

```
string firstName;
        string lastName;
        using (XmlTextReader reader = GetDebugInfo())
        {
            while (reader.Read())
            {
                if (reader.IsStartElement() && reader.Name == "student")
                {
                    reader.ReadToDescendant("firstName");
                    reader.Read();
                    firstName = reader.Value;
                    reader.ReadToFollowing("lastName");
                    reader.Read();
                    lastName = reader.Value;
                    AddStudent(firstName, lastName);
                }
            }
        } 
```

我使用了以下 XML：

```
<students>
    <student>
        <firstName>Antonio</firstName>
        <lastName>Namnum</lastName>
    </student>
    <student>
        <firstName>Alicia</firstName>
        <lastName>Garcia</lastName>
    </student>
    <student>
        <firstName>Christina</firstName>
        <lastName>SomeLattName</lastName>
    </student>
</students> 
```

你可能需要调整。这应该运行得更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T19:53:55.757

您可以逐行读取，但如果读取数据需要 15 秒，那么您无法加快速度。

在进行任何重大更改之前，请尝试简单地读取文件的所有行并且不进行任何处理。如果您的目标仍然需要更长的时间 - 调整目标/更改文件格式。否则，看看优化解析可以获得多少收益 - RegEx 对于不复杂的正则表达式来说非常快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T12:34:44.937

RegEx 不是解析字符串的最快方法。您需要一个类似于 XmlReader 的定制解析器（以匹配您的数据结构）。它将允许您部分读取文件并比 RegEx 更快地解析它。

由于您有一组有限的标签和嵌套 FSM 方法 (http://en.wikipedia.org/wiki/Finite-state_machine) 将为您工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-03T13:23:12.190

这是最快的（也许我想尝试更多的东西）

创建了一个数组数组`char[][] listToProcess = new char[200000][];`，我将在其中放置流的块。在一个单独的任务中，我开始处理每个块。代码如下所示：

```
 StreamReader sr = GetUnparsedDebugInfo(); // get streamReader                        

   var task1 = Task.Factory.StartNew(() =>
   {
       Thread.Sleep(500); // wait a little so there are items on list (listToProcess) to work with
       StartProcesingList();
   });

   int counter = 0;

   while (true)
   {
       char[] buffer = new char[2048]; // crate a new buffer each time we will add it to the list to process

       var charsRead = sr.Read(buffer, 0, buffer.Length);

       if (charsRead < 1) // if we reach the end then stop
       {
           break;
       }

       listToProcess[counter] = buffer;
       counter++;
   }

   task1.Wait(); 
```

并且该方法`StartProcesingList()`基本上开始遍历列表，直到它到达一个空对象。

```
 void StartProcesingList()
    {
        int indexOnList = 0;

        while (true)
        {
            if (listToProcess[indexOnList] == null)
            {
                Thread.Sleep(100); // wait a little in case other thread is adding more items to the list

                if (listToProcess[indexOnList] == null)
                    break;
            }

            // add chunk to dictionary if you recall listToProcess[indexOnList] is a 
            // char array so it basically converts that to a string and splits it where appropiate
            // there is more logic as in the case where the last chunk will have to be 
            // together with the first chunk of the next item on the list
            ProcessChunk(listToProcess[indexOnList]);

            indexOnList++;                
        }

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T19:23:49.263

[@kakridge](https://stackoverflow.com/users/347062/kakridge)是对的。例如，我可能正在处理一个任务正在编写 listToProces[30] 而另一个线程可能正在解析 listToProces[30] 的竞争条件。为了解决这个问题并删除效率低下的 Thread.Sleep 方法，我最终使用了信号量。这是我的新代码：

```
 StreamReader unparsedDebugInfo = GetUnparsedDebugInfo(); // get streamReader 
        listToProcess = new char[200000][];
        lastPart = null;
        matchLength = 0;

        // Used to signal events between thread that is reading text 
        // from readelf.exe and the thread that is parsing chunks
        Semaphore semaphore = new Semaphore(0, 1);

        // If task1 run out of chunks to process it will be waiting for semaphore to post a message
        bool task1IsWaiting = false;

        // Used to note that there are no more chunks to add to listToProcess.
        bool mainTaskIsDone = false;

        int counter = 0; // keep trak of which chunk we have added to the list

        // This task will be executed on a separate thread. Meanwhile the other thread adds nodes to  
        // "listToProcess" array this task will add those chunks to the dictionary. 
        var task1 = Task.Factory.StartNew(() =>
        {
            semaphore.WaitOne(); // wait until there are at least 1024 nodes to be processed

            int indexOnList = 0; // counter to identify the index of chunk[] we are adding to dictionary

            while (true)
            {
                if (indexOnList>=counter)   // if equal it might be dangerous! 
                {                           // chunk could be being written to and at the same time being parsed.
                    if (mainTaskIsDone)// if the main task is done executing stop
                        break;

                    task1IsWaiting = true; // otherwise wait until there are more chunks to be processed
                    semaphore.WaitOne();
                }

                ProcessChunk(listToProcess[indexOnList]); // add chunk to dictionary
                indexOnList++;
            }
        });

        // this block being executed on main thread  is responsible for placing the streamreader 
        // into chunks of char[] so that task1 can start processing those chunks
        {                
            int waitCounter = 1024; // every time task1 is waiting we use this counter to place at least 256 new chunks before continue to parse them

            while (true) // more chunks on listToProcess before task1 continues executing
            {
                char[] buffer = new char[2048]; // buffer where we will place data read from stream

                var charsRead = unparsedDebugInfo.Read(buffer, 0, buffer.Length);

                if (charsRead < 1){
                    listToProcess[counter] = pattern;
                    break;
                }

                listToProcess[counter] = buffer;
                counter++; // add chunk to list to be proceesed by task1.

                if (task1IsWaiting)
                {               // if task1 is waiting for more nodes process 256
                    waitCounter = counter + 256;    // more nodes then continue execution of task2
                    task1IsWaiting = false;
                }
                else if (counter == waitCounter)                    
                    semaphore.Release();                    
            }
        }

        mainTaskIsDone = true; // let other thread know that this task is done

        semaphore.Release(); // release all threads that might be waiting on this thread

        task1.Wait(); // wait for all nodes to finish processing 
```

# java - 如何根据 JDBC Result Set 创建表

> ID：11268057
> 
> 赞同：2
> 
> 时间：2012-06-29T19:46:27.510
> 
> 标签：java, mysql, database, jdbc, resultset

我正在构建一个报告工具，我需要对远程数据库执行查询并将结果集存储在我自己的数据库中（因为我没有远程数据库的写权限，而且我需要缓存结果以防止进一步执行）。此外，我需要此功能，因此我可以将两个结果集连接在一起并根据生成的结果生成结果。

**现在，我的问题是我不知道如何基于 jdbc ResultSet 创建表。是否有任何开源工具或脚本可以处理这个问题？**

我的应用程序基于 Spring 3.1.0 并使用 JDBC 来查询本地和远程数据库。我要存储结果的本地数据库是 MySQL 5.5.20。（这是存储在 MySQL 中的好主意吗？它提供了足够的性能吗？）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T20:43:14.843

我们可以从结果集中提取*最近的匹配*结构并构造一个表。
但这***不可能是精确的副本，就表名、键、引擎类型、字段是否可为空等而言***。

以下代码片段可帮助您以某种方式继续获得适当的结果。

```
String sql = "select * from visitors";
ResultSet rs = stmt.executeQuery( sql );
ResultSetMetaData rsmd = rs.getMetaData();
int columnCount = rsmd.getColumnCount();
String tableName = null;
StringBuilder sb = new StringBuilder( 1024 );
if ( columnCount > 0 ) { 
    sb.append( "Create table " ).append( rsmd.getTableName( 1 ) ).append( " ( " );
}
for ( int i = 1; i <= columnCount; i ++ ) {
    if ( i > 1 ) sb.append( ", " );
    String columnName = rsmd.getColumnLabel( i );
    String columnType = rsmd.getColumnTypeName( i );

    sb.append( columnName ).append( " " ).append( columnType );

    int precision = rsmd.getPrecision( i );
    if ( precision != 0 ) {
        sb.append( "( " ).append( precision ).append( " )" );
    }
} // for columns
sb.append( " ) " );

System.out.println( sb.toString() ); 
```

使用上述部分代码执行，打印以下字符串：

```
Create table visitors ( ip VARCHAR( 6 ), bro VARCHAR( 6 ) ) 
```

让我希望这可以帮助您进一步进行。

类似的示例可以在以下位置找到：[***使用 ResultSet 创建表？？？***](http://www.coderanch.com/t/295484/JDBC/java/Create-table-ResultSet)

**更新 1**：

> *我如何处理只存在于一个数据库中而不存在于另一个数据库中的类型*

仅依赖于客户端应用程序的结果集时，您无能为力。
它应该始终是从复合数据类型（如,等）中选择适当数据的*主选择查询。***示例**：`geometry``address`
**`select addess.city, address.zipcode, x( geometry_column ), y( geometry_column )`**

 ****举一个`geometry`数据类型**的例子：
MySQL 有对其[***空间支持***](http://dev.mysql.com/doc/refman/5.6/en/gis-introduction.html)的定义。但我不确定它们与[***SQL Server 的 Spatial Data 实现***](http://msdn.microsoft.com/en-us/library/bb933790)相比有多好。

`geometry`是一种复合数据类型，因此不能通过直接查询来检索。
您需要从这些数据列解析数据并以*可读*、*可识别*的数据格式返回的依赖函数。
*示例*：`create table geom ( g geometry );`
将 ResultSet 从`select g from geom`使用 JAVA 转换为 create table 语句将导致`unknwon`列的数据类型`g`。

```
Create table geom ( g UNKNOWN ) 
```

在列上使用`x(g)`,`y(g)`坐标函数`g`将返回正确且可接受的数据类型。
查询`select x(g), y(g) from geom`将转换为

```
Create table  ( x(g) DOUBLE( 23, 31 ), y(g) DOUBLE( 23, 31 ) ) 
```

**更新 2**：
可能会使用关系结合多个表生成结果集。结果集字段也有可能由表达式及其别名组成。因此，生成的列字段或别名的数据类型是动态确定的。元数据不知道查询中的表、列名及其原始/父数据类型的确切名称。

所以，*无法获得*

1.  表的单一名称并使用它。
2.  父列的数据类型并使用它。

**注意**：这也适用于所有其他跨数据库特定数据类型，例如*NVARCHAR*等。但是，请参阅[此帖子以了解 MySQL 中 NVARCHAR 用法的替代方法](https://stackoverflow.com/a/2214925/767881)。

在尝试这种动态数据迁移之前，客户端应用程序应该有责任了解等效的数据类型并相应地使用它们。

此外，有关更多信息，请参阅[***Microsoft Access、MySQL 和 SQL Server 的数据类型和范围。***](http://www.w3schools.com/sql/sql_datatypes.asp?output=print)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T20:50:33.237

也许这有点棘手，但我认为它可能会帮助你。

JDBC ResultSet 对象有一个`getMetaData()`方法，该方法返回一个`ResultSetMetaData`对象，其中包含列名和列类型等。你可以这样做：

```
ResultSet rs;
String strSQL;

...

strSQL = "create table tbl ("
for(i=0;i<rs.getMetaData().getColumnCount(),i++) {
    if(i>0)
        strSQL += ", "
    strSQL += rs.getMetaData().getColumnName(i) 
           + " " 
           + rs.getMetaData().getColumnType(i);
}
strSQL+= ")"

.... 
```

您可以通过这种方式构造一个包含您需要的列的有效 SQL DML。之后，剩下的就是填充表格。

希望这对您有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-18T09:02:50.560

您可能拥有基于执行选择查询的 ResultSet。现在，我们可以执行单个查询来创建表，而不是获取 ResultSet 然后遍历它来创建表。

您的原始查询：

`select * from table_name`

而不是执行这个和迭代，执行这个

`create table new_table_name as (select * from table_name)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T19:49:05.070

如此[处](http://dev.mysql.com/doc/refman/5.0/en/create-table-select.html)所述，您可以使用普通的 SQL 来执行此操作，如下所示：

```
CREATE TABLE artists_and_works
  SELECT artist.name, COUNT(work.artist_id) AS number_of_works
  FROM artist LEFT JOIN work ON artist.id = work.artist_id
  GROUP BY artist.id; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-21T17:07:11.060

如果您想要一个通用的解决方案来处理数据库之间不同但在 java 中类型相同的数据类型，您可以使用**JDBCType**。只需采用 Ravinder Reddy 解决方案并更改此行：

```
String columnType = rsmd.getColumnTypeName( i ); 
```

到

```
String columnType = JDBCType.valueOf(rsmd.getColumnType(i)).getName(); 
```

希望能帮助到你。**

# android - 使用 Intent 打开系统应用程序

> ID：11268060
> 
> 赞同：2
> 
> 时间：2012-06-29T19:47:11.423
> 
> 标签：android, android-intent, system, implicit

我正在尝试制作一个简单的应用程序，当用户从主屏幕或应用程序抽屉单击时，它会将用户发送到特定的（系统安装的）应用程序（系统设置、日历、浏览器等）。

例如，我目前正在尝试在我的应用程序启动时打开系统设置，就像设置的快捷方式一样。

是否可以按照我想要的方式实现它？有没有人有什么建议？

这是我的代码：

```
import android.app.Activity;
import android.content.Intent;
import android.content.pm.PackageManager;

public class MainActivity extends Activity {

    public void  LaunchComponent (String packageName, String name){
        Intent i = new Intent(Intent.ACTION_MAIN);
        PackageManager manager = getPackageManager();
        i = manager.getLaunchIntentForPackage("com.sec.android.app.controlpanel");
        i.addCategory(Intent.CATEGORY_LAUNCHER);
        startActivity(i);

    }
} 
```

我目前在我的应用程序中没有布局文件，例如 main.xml，因为它没有任何 UI 或布局元素。它应该做的就是将用户发送到另一个应用程序活动。我一直在使用本教程（缺少链接）并且我已经实现了所有代码示例，但我无法弄清楚，我是 android 开发的新手，java 不是我最好的语言。接受任何批评或建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T19:54:33.243

您必须调用 LaunchComponent ，这可以在 onCreate 第一个生命周期回调函数中完成

```
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
     LaunchComponent (packageName, name);
} 
```

更新

```
import android.app.Activity;
import android.content.Intent;
import android.content.pm.PackageManager;

public class MainActivity extends Activity {

public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
         LaunchComponent ("com.sec.android.app.controlpanel", "abc?");
    }

public void  LaunchComponent (String packageName, String name){
    Intent i = new Intent(Intent.ACTION_MAIN);
    PackageManager manager = getPackageManager();
    i = manager.getLaunchIntentForPackage(packageName);
    i.addCategory(Intent.CATEGORY_LAUNCHER);
    startActivity(i);

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:04:36.950

在此示例中，您可以打开系统闹钟应用程序。希望对您有所帮助，示例活动：

```
public class TestActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        PackageManager packageManager = this.getPackageManager();
        if (packageManager != null) {

            Intent AlarmClockIntent = 
                new Intent(Intent.ACTION_MAIN).addCategory(
                        Intent.CATEGORY_LAUNCHER).setComponent(
                                new ComponentName("com.android.deskclock", "com.android.deskclock.DeskClock"));

            ResolveInfo resolved = packageManager.resolveActivity(AlarmClockIntent, PackageManager.MATCH_DEFAULT_ONLY);
            if (resolved != null) {
                startActivity(AlarmClockIntent);
                finish();
                return;
            } else {
                // required activity can not be located!
            }
        }
    }
} 
```

# scala - 使用 anorm 实现 1-m 关系

> ID：11268061
> 
> 赞同：3
> 
> 时间：2012-06-29T19:47:14.993
> 
> 标签：scala, playframework, anorm

比方说，我们有一个 1 米的关系，经典的例子：Author-Book。我们在数据访问层中有 2 个案例类（以及 DB ofc 中的表），对应的 Author 和 Book。

有没有办法获得作者的集合，让每个作者都被 Anorm 中的作者书籍集合填充？

如果没有办法，那么在执行 2 个查询（如“SELECT * FROM Author”和“SELECT * FROM Book”之后，假设我们有一个外键关系，那么获取此集合链接的正确（最佳）方法是什么？ ?

谢谢！

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-06-29T20:53:46.587

您是否看过 Play 示例中的“计算机数据库”？

在此示例中，您可以看到公司拥有许多计算机：[https ://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/models/Models.scala#L84](https://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/models/Models.scala#L84)

# regex - 漂亮的字符串操作

> ID：11268064
> 
> 赞同：5
> 
> 时间：2012-06-29T19:47:49.513
> 
> 标签：regex, vb.net, string, vba, vb6

我有以下字符串，我希望从中提取部分：

```
<FONT COLOR="GREEN">201 KAR 2:340.</FONT> 
```

在这种特殊情况下，我希望提取数字 201,2 和 340，稍后我将使用它们连接形成另一个字符串：

[http://www.lrc.state.ky.us/kar/201/002/340reg.htm](http://www.lrc.state.ky.us/kar/201/002/340reg.htm)

我有一个解决方案，但它不容易阅读，而且看起来相当笨重。它涉及使用中间功能。这里是：

```
intTitle = CInt(Mid(strFontTag, 
                    InStr(strFontTag, ">") + 1, 
                    (InStr(strFontTag, "KAR") - InStr(strFontTag, ">")) 
                           - 3)) 
```

我想知道是否有更好的方法来完成这项任务。我意识到我可以创建一些描述性的变量名称，比如 intPosOfEndOfOpeningFontTag 来描述第一个 InStr 函数的作用，但我仍然觉得它很笨拙。

我应该使用某种拆分函数、正则表达式，还是我还没有遇到过的更优雅的方式？多年来我一直以这种方式操纵字符串，我只是觉得必须有更好的方法。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T06:49:01.680

**班上**

```
Imports System
Imports System.IO
Imports System.Text
Imports System.Text.RegularExpressions
Imports System.Xml
Imports System.Xml.Linq
Imports System.Linq

Public Class clsTester
    'methods
    Public Sub New()
    End Sub

    Public Function GetTitleUsingRegEx(ByVal fpath$) As XElement
        'use this function if your input string is not a well-formed
        Dim result As New XElement(<result/>)
        Try
            Dim q = Regex.Matches(File.ReadAllText(fpath), Me.titPattern1, RegexOptions.None)
            For Each mt As Match In q
                Dim t As New XElement(<title/>)
                t.Add(New XAttribute("name", mt.Groups("name").Value))
                t.Add(New XAttribute("num1", mt.Groups("id_1").Value))
                t.Add(New XAttribute("num2", mt.Groups("id_2").Value))
                t.Add(New XAttribute("num3", mt.Groups("id_3").Value))
                t.Add(mt.Value)
                result.Add(t)
            Next mt
            Return result
        Catch ex As Exception
            result.Add(<error><%= ex.ToString %></error>)
            Return result
        End Try
    End Function

    Public Function GetTitleUsingXDocument(ByVal fpath$) As XElement
        'use this function if your input string is well-formed
        Dim result As New XElement(<result/>)
        Try
            Dim q = XElement.Load(fpath).Descendants().Where(Function(c) Regex.IsMatch(c.Name.LocalName, "(?is)^font$")).Where(Function(c) Regex.IsMatch(c.Value, Me.titPattern2, RegexOptions.None))
            For Each nd As XElement In q
                Dim s = Regex.Match(nd.Value, Me.titPattern2, RegexOptions.None)
                Dim t As New XElement(<title/>)
                t.Add(New XAttribute("name", s.Groups("name").Value))
                t.Add(New XAttribute("num1", s.Groups("id_1").Value))
                t.Add(New XAttribute("num2", s.Groups("id_2").Value))
                t.Add(New XAttribute("num3", s.Groups("id_3").Value))
                t.Add(nd.Value)
                result.Add(t)

            Next nd
            Return result
        Catch ex As Exception
            result.Add(<error><%= ex.ToString %></error>)
            Return result
        End Try
    End Function

    'fields
    Private titPattern1$ = "(?is)(?<=<font[^<>]*>)(?<id_1>\d+)\s+(?<name>[a-z]+)\s+(?<id_2>\d+):(?<id_3>\d+)(?=\.?</font>)"
    Private titPattern2$ = "(?is)^(?<id_1>\d+)\s+(?<name>[a-z]+)\s+(?<id_2>\d+):(?<id_3>\d+)\.?$"
End Class 
```

**用途**

```
Sub Main()
        Dim y = New clsTester().GetTitleUsingRegEx("C:\test.htm")
        If y.<error>.Count = 0 Then
            Console.WriteLine(String.Format("Result from GetTitleUsingRegEx:{0}{1}", vbCrLf, y.ToString))
        Else
            Console.WriteLine(y...<error>.First().Value)
        End If

        Console.WriteLine("")
        Dim z = New clsTester().GetTitleUsingXDocument("C:\test.htm")

        If z.<error>.Count = 0 Then
            Console.WriteLine(String.Format("Result from GetTitleUsingXDocument:{0}{1}", vbCrLf, z.ToString))
        Else
            Console.WriteLine(z...<error>.First().Value)
        End If
        Console.ReadLine()
    End Sub 
```

* * *

***希望这可以帮助。***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:04:15.003

```
<FONT[^>]*>[^\d]*(\d+)[^\d]*(\d+):(\d+)[^\d]*</FONT> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T19:58:21.200

正则表达式模式：`<FONT[^>]*>.*?(\d+).*?(\d+).*?(\d+).*?<\/FONT>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T19:30:21.083

我认为@Jean-François Corbett 是对的。

将其隐藏在函数中，永不回头

将您的代码更改为：

```
intTitle = GetCodesFromColorTag("<FONT COLOR="GREEN">201 KAR 2:340.</FONT>") 
```

创建一个新函数：

```
Public Function GetCodesFromColorTag(FontTag as String) as Integer

    Return CInt(Mid(FontTag, InStr(FontTag, ">") + 1, 
                (InStr(FontTag, "KAR") - InStr(FontTag, ">")) 
                - 3))

End Function 
```

# c# - 如何在 asp.net 的加载面板中显示事件的结果

> ID：11268067
> 
> 赞同：0
> 
> 时间：2012-06-29T19:47:57.300
> 
> 标签：c#, asp.net, ajax

我正在使用 c# 处理 asp.net 和 ajax。我正在尝试创建一个新的用户注册，当用户单击提交按钮时，我正在弹出一个带有加载图像的更新面板。而且我需要同时将数据插入数据库。我使用以下代码，

```
 <asp:UpdatePanel ID="updatepanel1" runat="server">
        <ContentTemplate>   
         <asp:TextBox runat="server" ID="txtMI" Width="80px" Height="20px" CssClass="s1">                                       </asp:TextBox>
    <asp:TextBox runat="server" ID="txtMI" Width="80px" Height="20px" CssClass="s1"></asp:TextBox>
    <asp:TextBox runat="server" ID="txtMI" Width="80px" Height="20px" CssClass="s1"></asp:TextBox>
            <asp:Dropdownlist ID="drpCountries" runat="server" Font-Bold="True" ForeColor="#FF3300"></asp:Dropdownlist>
            <br />
            <asp:Button ID="btnLoad" runat="server" onclick="btnLoad_Click" Text="submit" />
            </ContentTemplate>
            </asp:UpdatePanel>
 <asp:UpdateProgress id="updateProgress" runat="server">
     <ProgressTemplate>
            <div style="position: fixed; text-align: center; height: 100%; width: 100%; top: 0; right: 0; left: 0; z-index: 9999999; background-color: #000000; opacity: 0.7;">
                    <asp:Image ID="imgUpdateProgress" runat="server" ImageUrl="~/avatarloading.gif" AlternateText="Loading ..." ToolTip="Loading ..." style="padding: 10px;position:fixed;top:25%;left:35%;" /><center><span style="color:White;font-weight:bolder;font-size:x-large;"><b>Loading...</b></span></center>
            </div>
     </ProgressTemplate>

</asp:UpdateProgress> 
```

在我的文件后面的代码中，

```
protected void btnLoad_Click(object sender,EventArgs e)
{
//INsert the records into database
} 
```

起初，当用户单击提交时，我能够弹出加载面板并加载 gif 图像。成功插入后，我需要在加载面板上显示一些信息，例如注册成功代替图像。请指导我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:57:42.117

您可以绑定 asp.net ajax 的 endRequest 事件以在 ajax 请求完成后获得控制权。

```
<script language="javascript" type="text/javascript">

    var prm = Sys.WebForms.PageRequestManager.getInstance();
    prm.add_endRequest(endRequest);

    function endRequest(sender, args) {
        alert("After ajax request");
    }  
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:15:43.337

我将创建一个与 UpdateProgress 标记（css 类）相同的面板，其中包含一个标签。并且在成功操作时设置标签文本并将面板 Visible 属性切换为 true。

# javascript - Jquery 文本输入行为滑稽

> ID：11268072
> 
> 赞同：0
> 
> 时间：2012-06-29T19:48:18.023
> 
> 标签：javascript, jquery, css

我有以下 jQuery 在单击时修改表格单元格-它将使用户能够填写文本输入并在输入时返回正常的`<td>`.

HTML-

```
<td class="delivered">
    {{ title.delivery_date|date:"Y-m-d" }}
</td> 
```

JS-

```
$("td.delivered").click(function () {
    if ($(this).find('#inp').length == 0) {
        var before = $(this).text();
        var title_id = $(this).parent().attr('id');
        var status_type = 'delivery-date'
        $(this).html($("<input/>", {
            id: 'inp',
            style: 'width:70px;',
            placeholder: 'YYYY-MM-DD',
            change: function () {
                selectdone(this, title_id, status_type);
            }
        }));
        $("#inp").focus();
        $('#inp').val(before);
    }
}); 
```

上面的 js 可以工作，但是有一个怪癖。

即使输入元素是 70 像素，它似乎也像文本宽度为 200 像素左右一样滚动。这使得您`placeholder`在第一次单击 td 后无法看到。我将如何使光标**始终**向左齐平并且文本输入在任何方面都是 70px。

**更新：**`POST`这是输入文本并通过:发送后的样子`u'status': [u'\t\t\t\t\t\t\t\t\t\t\t2012-01-01']`。换句话说，它似乎从文本输入中的 11 个选项卡开始！为什么会发生这种情况，我将如何摆脱这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:56:24.677

You could wrap your input box in a div with `width:70px;overflow:hidden` so you're sure that you won't see any scrollbars.

# jquery - 保存或编辑后 JqGrid 不刷新记录

> ID：11268077
> 
> 赞同：2
> 
> 时间：2012-06-29T19:48:46.253
> 
> 标签：jquery, jqgrid

我使用 JqGrid 来列出、添加、删除、编辑、查找我的记录。当我选择 loadonce=false 时，它​​通常会在删除、编辑或添加后刷新记录。但是，分页和搜索机制不起作用。一旦我选择 loadonce=true，它会在删除后刷新记录，而不是在添加或编辑后刷新记录。然后分页和搜索在 loadonce=true 模式下正常运行。我试过了；

```
$("#list").setGridParam({datatype:'json', page:1}).trigger('reloadGrid'); 
```

或者

```
afterInsertRow: function (rowid,rowdata,rowelem){
    alert("hello"); // this wasnt invoked
} 
```

但他们没有解决我的问题。

我的问题是什么原因。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-30T10:39:02.300

如果你使用比你必须**在服务器端**`loadonce: false`实现分页、排序和搜索。如果分页和搜索不起作用，那么您没有在当前服务器代码中实现这些功能。

 **该选项`reloadAfterSubmit`指定编辑后是否重新加载网格。

如果您使用`loadonce: true`，`datatype`将`'local'`在第一次加载后更改。问题是 jqGrid 不支持本地表单编辑。所以你必须为添加/编辑/删除实现服务器部分。问题是这种情况下的重新加载将在**本地**执行，而不是从服务器执行。要在表单编辑结束后从服务器重新加载数据，您可以在回调中将其重置`datatype`为初始状态（“json”或“xml”） 。`afterSubmit`在这种情况下，下一次重新加载（在 的情况下`reloadAfterSubmit: true`）将像您想要的那样从服务器完成。

**更新： afterSubmit**的以下代码[应该](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#events)可以解决问题：

```
afterSubmit: function () {
    $(this).jqGrid("setGridParam", {datatype: 'json'});
    return [true];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-06T09:13:58.160

试试这个代码；

```
afterSubmit: function () { location.reload(true); } 
```**

# jquery - 如何为html的主体制作jQuery动画？

> ID：11268079
> 
> 赞同：0
> 
> 时间：2012-06-29T19:49:07.287
> 
> 标签：jquery

我正在制作一个网站，我正在尝试向网页添加三个图像并使用 jQuery 使它们旋转。我已经阅读了很多关于 jQuery :not() 函数的威胁，用于从动画中排除子元素，但无法以正确的方式做到这一点。问题是我只需要 3 个背景图像（附加到）来淡入，而不是所有其他元素，如菜单、标题或网站内容。这是我的代码，希望有人可以帮助我。

```
<script type="text/javascript">
 $(document).ready(function()
    {
 var imgArr = new Array() // relative paths of images
 imgArr[0]="images/1.jpg";
 imgArr[1]="images/2.jpg";
 imgArr[2]="images/3.jpg";

 var preloadArr = new Array();
 var i;

 /* preload images */
 for(i=0; i < imgArr.length; i++){
 preloadArr[i] = new Image();
 preloadArr[i].src = imgArr[i];
 }

 var currImg = 1;
 var intID = setInterval(changeImg, 1000);

 /* image rotator */
 function changeImg(){
 $(".wrapper").not('dont know').animate({opacity: 0}, 1000, function(){
 $(this).css('background','url(' + preloadArr[currImg++%preloadArr.length].src +') top center no-repeat');
 }).animate({opacity: 1}, 1000);

 }

 });

</script> 
```

我需要的是只为身体背景设置动画以淡入，而不是像菜单、段落、网站内容等子元素。感谢您的任何建议。

Html部分：

```
<div class="parent">
 <div class="inline_element1">Here goes menu</div>
   <div class="inline_element2">Here goes site content</div>
</div> 
```

在 CSS 部分：

```
.parent{

width: 100%;
height: 100%;
margin: 0px auto;
background-image: url(../images/1.jpg);
background-repeat: no-repeat;
background-size: cover;
} 
```

我只需要对里面的元素进行动画处理，而不是对里面的所有元素进行动画处理。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:04:19.317

如果我理解，您需要对父级的背景进行动画处理和淡化，同时不淡化里面的内容。这根本是不可能的，我的意思是，如果你删除一个（或淡入/淡出或你在它上面做的任何事情），你会同时删除他所有的孩子，因为它在同一个容器中。这就是创建 DOM 的方式。知道这一点，仍然有办法“伪造”背景图像，例如父级内部的 DIV，位置绝对，顶部 0 和左侧 0（父级必须是相对的），高度和宽度为 100%，z-索引为 -1（确保它在所有内容的后面）。比你可以简单地淡入/淡出那个特定的 div。

```
<div class="parent">
 <div class='fakeBackground'></div>
 <div class="inline_element1">Here goes menu</div>
 <div class="inline_element2">Here goes site content</div>
</div>

.parent {
   width: 100%;
   height: 100%;
   margin: 0px auto;
   position: relative;

}   
.parent .fakeBackground {
   position: absolute;
   z-index: -1;
   top: 0;
   left: 0;
   width: 100%;
   height: 100%;
   margin: 0px auto;
   background-image: url(../images/1.jpg);
   background-repeat: no-repeat;
   background-size: cover;
} 
```

接着：

```
// you have to figure out yourself how to point the parent, or if it is all at the same 
// time, just go with $('.fakeBackground').fadeOut(1000, etc.)
$('.parent').children('.fakeBackground').fadeOut(1000,function() {
  // change background like you want
}); 
```

# html - 具有最大宽度 td 的表格中的文本在 IE7 中被截断

> ID：11268082
> 
> 赞同：0
> 
> 时间：2012-06-29T19:49:19.643
> 
> 标签：html, internet-explorer-7, css

我有一张简单的桌子。第一列的最大宽度设置为 15 像素。它是用来保存小图标的设计。我在表格底部有几行摘要。在这些行中，我在第一个小宽度列中有一些长文本。我希望整个文本超出 TD 宽度。我可以在除 IE7 之外的所有浏览器中使用此功能。

[我在http://jsfiddle.net/sweimer/A96Bx/4/](http://jsfiddle.net/sweimer/A96Bx/4/)设置了一个 jsfiddle 。在 IE7 中打开它，您会看到第一列底部的文本被截断。所有其他浏览器都按需要显示。

在此先感谢您的时间。

斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T19:57:41.947

您正在寻找`colspan`“我希望此单元格跨越表格中的 x 列”的属性，并将其设置为“5”，因为您的表格共有 5 列。

```
<td class="icoColumn noWrap" colspan="5"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T05:44:58.737

您可以使用

```
max-width:15px;
min-width:15px; 
```

# xcode - 区分表视图

> ID：11268086
> 
> 赞同：0
> 
> 时间：2012-06-29T19:49:34.517
> 
> 标签：xcode, ios5, uistoryboard

我在视图控制器中有三个表视图（将显示/隐藏表视图以显示不同上下文中的选项列表）

只是想知道区分使用相同委托的不同表视图的最佳方法是什么。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T19:51:59.380

在视图控制器中使用三个单独的实例变量来存储表视图。然后在委托方法中，您可以执行以下操作：

```
if (tableView == myFirstTableView) {
    // Do whatever you need for table view 1.
} else if (tableView == mySecondTableView) {
    // Do whatever you need for table view 2.
} 
```

# c# - 将 SharpDX 效果应用于 MediaCapture 流

> ID：11268090
> 
> 赞同：1
> 
> 时间：2012-06-29T19:50:01.767
> 
> 标签：c#, camera, microsoft-metro, effect, sharpdx

我正在尝试将效果应用于 Windows 8 Metro 应用程序中的视频流。我知道 MFT 和类的`AddEffectAsync`方法`MediaCapture`。但是，我不太了解 C++，并且对编写自己的 MFT 驱动程序感到不自在。

所以我希望能够 (1) 捕获相机的流，(2) 对其应用 SharpDX 效果，然后 (3) 将生成的流输出到 Metro 应用程序上的 xaml 对象。我已经看过[这个](http://advertboy.wordpress.com/2012/04/25/custom-effects-ripple-effect-pixel-shader/)站点，但考虑到它们涉及大量 C++ 代码（即使其中一些只是包装器），我还没有发现这些教程很有帮助。任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T16:52:14.833

我最终在 MSDN 论坛上得到了答案。这不是一个理想的答案，但这是我一直担心的。

[http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/f3a6934e-df7a-44da-bfd8-7b95d494ff43/#90690f89-e57d-4043-9881-60fcc587f736](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/f3a6934e-df7a-44da-bfd8-7b95d494ff43/#90690f89-e57d-4043-9881-60fcc587f736)

# python - 在 python 中，如何在字典中找到值的总和？每个键都有多个值

> ID：11268092
> 
> 赞同：2
> 
> 时间：2012-06-29T19:50:24.693
> 
> 标签：python, dictionary

我的数据是制表符分隔的，如下所示：

```
Name   Count    Sample
Dog    .0001    1
Dog    .00003   1
Dog    .0001    2
Cat    .0004    1
Cat    .0002    1
Cat    .0003    2
Cat    .0002    2 
```

在我将变量 unid 定义为与第三列（ex Dog_1）合并的第一列并将 num 定义为该行的 Count 之后，我将每个 num 附加到 unid 下的字典中（使用 Python 2.7），如下所示：

```
for line in K:
        sp = line.split("\t")
        name = sp[0]
        unid = sp[3][:-2] +"_"+ sp[0]
        num = int(Decimal(sp[1]))
        if not dict1.has_key(unid):
            dict1[unid] = []
        dict1[unid].append(num) 
```

我试着用这个来总结：

```
dictTot = sum(dict1.values()) 
```

但我收到此错误消息：

```
TypeError: unsupported operand type(s) for +: 'int' and 'list' 
```

我怎样才能总结这些值，以便我可以检索`Cat_1: .0006, Cat_2: .0005` 等？

对不起大家，我知道我的？不是很好。但正如下面 Jacob 所说，“dictTot = sum(sum(value) for value in dict1.values())”对所有总和进行求和，但我正在寻找的是独立地对每个键下的每组值求和所以我可以找出样本 1 中有多少只猫，依此类推。也许 sum 不适合这个？对不起，很明显我不是一个非凡的 Python。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:01:31.430

不是这样的`sum`。你试图通过“添加”一堆列表来获得一个整数（或数值类型），所以内置函数吓坏了。试试这个：

```
dictTot = sum(sum(value) for value in dict1.values()) 
```

这将总结所有的总和，这就是你想要的（我认为）。

**编辑**

显然，您想对列表中每个元素中的所有值求和。为此，您可以使用[字典理解](http://www.python.org/dev/peps/pep-0274/)：

```
dictTot = {key:sum(l_values) for key, l_values in dict1.items()} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:04:29.327

我基本上重写了整个事情......

```
K = "Dog    .0001    1\n  Dog    .00003   1\n  Dog    .0001    2\n  Cat    .0004   1\n  Cat    .0002    1\n  Cat    .0003    2\n  Cat    .0002    2"
dict1 = {}
for line in K.split("\n"):
    sp = line.split()
    name = sp[0]
    unid = "_".join([sp[0] , sp[2][-2:]])
    num = float(sp[1])
    if not dict1.has_key(unid):
        dict1[unid] = [num,]
    else :
        dict1[unid].append(num)
print(dict1)
dictTot = sum([sum(x) for x in dict1.values()])
print(dictTot) 
```

最终的命令是

```
{'Dog_2': [0.0001], 
 'Dog_1': [0.0001, 3e-05], 
 'Cat_1': [0.0004, 0.0002], 
 'Cat_2': [0.0003, 0.0002]} 
```

总和是

```
0.00133 
```

这些值是列表，因此您希望循环它们以单独求和。

**编辑**

显然现在你想要“Cat_1：.0006，Cat_2：.0005 等”，所以`dict1`，你可以做

```
for key in dict1.iterkeys():
    dict1[key] = sum(dict1[key]) 
```

现在`dict1`变成

```
{'Dog_2': 0.0001, 
 'Dog_1': 0.00013, 
 'Cat_1': 0.0006, 
 'Cat_2': 0.0005} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T20:12:28.790

为了对所有值求和，您必须首先将所有列表连接到一个`sum()`可以处理的迭代中。这里有两种方法可以做到这一点：

```
dictTot = sum(sum(dict1.values(), [])) 
```

稍微更冗长，但更具可读性：

```
from itertools import chain
dictTot = sum(chain.from_iterable(dict1.values())) 
```

`sum()`实际上需要两个参数。第二个参数，`start`默认为`0`. 因此，您收到有关添加`int`to的错误消息`list`。本质上，它是这样做的：`0 + [1, 2, 3] + [1, 2]...`. 在我的第一个示例中，我将默认起始值​​设置为一个空列表。结果是一个列表。现在我将所有值都放在一个列表中，我可以`sum()`通过结果来获得答案。

**编辑**

回应您的更新：

您可以使用生成器表达式执行此操作：

```
dictTot = {key: sum(value) for key, value in dictTot.items()} 
```

或者如果您使用的是 < Python 2.7：

```
dictTot = dict((key, sum(value)) for key, value in dictTot.iteritems()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T20:59:06.287

回答：

`dict((k,sum(v)) for k,v in dict1.iteritems())`

是的，更改`int(Decimal('.0001'))`并使用默认字典

+1 对一个有否决票的问题，然后是四个错过了 oneliner 答案的答案

**编辑**哎呀，我错过了@Joel Cornett 有它，所以那里也有道具

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T21:31:40.670

这有效：

```
d={}
for line in K:
   sp = line.strip().split()
   unid = sp[0]+"_"+sp[-1] 
   num = decimal.Decimal(sp[1])
   d.setdefault(unid,[]).append(num)      

print({k:sum(v) for k, v in d.items()}) 
```

印刷：

```
{'Dog_1': Decimal('0.00013'), 
 'Cat_2': Decimal('0.0005'), 
 'Cat_1': Decimal('0.0006'), 
 'Dog_2': Decimal('0.0001')} 
```

# php - 如果 mySQL 查询返回 true，则返回 JSON 字符串

> ID：11268101
> 
> 赞同：0
> 
> 时间：2012-06-29T19:51:13.107
> 
> 标签：php, mysql

我有一个`PHP`代码，它将运行一个 Select 查询来检查一个特定`personName`的是否存在。如果存在，我们应该返回一个`JSON`声明，如果不存在，我们应该发送一个`JSON`声明相同的响应。

到目前为止我的代码；

```
$rst= mysql_query("select* from Person
where personname='Labby'");

 while($r= mysql_fetch_array($rst) ){

// Now what ??
} 
```

// 我怎么知道是`$rst= mysql_query("select* from Person where personname='Labby'");`返回 true 还是 false ？并根据它创建一个 JSON 响应。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:56:00.200

对于 SELECT、SHOW、DESCRIBE、EXPLAIN 和其他返回结果集的语句，mysql_query() 成功时返回资源，错误时返回 FALSE。

来自[http://php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)：

```
// Perform Query
$result = mysql_query($query);

// Check result
// This shows the actual query sent to MySQL, and the error. Useful for debugging.
if (!$result) {
    $message  = 'Invalid query: ' . mysql_error() . "\n";
    $message .= 'Whole query: ' . $query;
    die($message);
}

// Use result
// Attempting to print $result won't allow access to information in the resource
// One of the mysql result functions must be used
// See also mysql_result(), mysql_fetch_array(), mysql_fetch_row(), etc.
while ($row = mysql_fetch_assoc($result)) {
    echo $row['firstname'];
    echo $row['lastname'];
    echo $row['address'];
    echo $row['age'];
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T19:56:01.280

这里的诀窍是意识到`$r`如果找不到任何东西，那将是错误的，这意味着如果 mysql 找不到您要查找的内容，则循环将退出（或永远不会启动）。

您可以执行以下操作：

```
$rst= mysql_query("select* from Person
where personname='Labby'");

$return = array();
while($r= mysql_fetch_array($rst) ){
    $return[] = $r;
}

if (count($return) > 0) {
    echo json_encode($return);
}
else {
    echo '{"success": false}'
} 
```

显然，您需要将“true”和“false”返回值调整为对您的应用有意义的值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T19:56:08.173

切换查询以使用`COUNT(*)`和检索值，或使用[`mysql_num_rows()`](http://php.net/manual/en/function.mysql-num-rows.php)（或 mysqli 或 PDO 等效项）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T19:57:53.370

在处理 fetch 之前，您应该`$rst`首先测试是否为 NULL。

```
if($rst)
    while($r = mysql_fetch_array) 
```

Mysql_query 文档：

> 返回值
> 
> 对于 SELECT、SHOW、DESCRIBE、EXPLAIN 和其他返回结果集的语句，mysql_query() 成功时返回资源，错误时返回 FALSE。
> 
> 对于其他类型的 SQL 语句，INSERT、UPDATE、DELETE、DROP 等，mysql_query() 在成功时返回 TRUE，在错误时返回 FALSE。
> 
> 返回的结果资源应该传递给 mysql_fetch_array() 和其他处理结果表的函数，以访问返回的数据。
> 
> 使用 mysql_num_rows() 找出 SELECT 语句返回了多少行，或使用 mysql_affected_rows() 找出有多少行受到 DELETE、INSERT、REPLACE 或 UPDATE 语句的影响。
> 
> 如果用户无权访问查询引用的表，mysql_query() 也会失败并返回 FALSE。

# php - 区分位置搜索和“常规”搜索的方法？

> ID：11268109
> 
> 赞同：0
> 
> 时间：2012-06-29T19:52:05.037
> 
> 标签：php, search, location

我们的数据库中有与位置相关的项目。这些项目也有标题（名称）。我们希望一个搜索栏允许用户搜索可以进行地理编码的通用位置（可能通过 Google 地图 API），或者允许用户按名称（标题）搜索项目。

是否有区分位置和“正常”（非位置）搜索的库、API 或一般方法？

我们目前测试邮政编码与名称 - 因为邮政编码与字符串匹配相对容易测试。

这感觉就像机器学习中的一个练习，我不准备这样做：D

# java - 如何在android中获取已安装应用程序的缓存大小

> ID：11268110
> 
> 赞同：0
> 
> 时间：2012-06-29T19:52:15.950
> 
> 标签：java, android

我正在使用以下代码获取 android 上所有已安装应用程序的列表，我的问题是如何获得这些应用程序使用的缓存大小，任何帮助将不胜感激。

```
public class CacheActivity extends Activity {

    private ListView lv;
    // private TextView tv;
    private List<PackageInfo> pkNames;

    // private Context context;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.cache);

        lv = (ListView) findViewById(R.id.cacheList);
        // tv = (TextView) findViewById(R.id.text1);
        pkNames = getPackageManager().getInstalledPackages(0);

        ArrayAdapter<PackageInfo> adapter = new ArrayAdapter<PackageInfo>(this,
                android.R.layout.simple_list_item_1, pkNames);
        lv.setAdapter(adapter);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:59:55.520

[我认为目前不可能。](https://groups.google.com/forum/?fromgroups#!topic/android-developers/6SCsourCd_M)正如该线程中提到的那样，没有公共API。[然而，这里](https://stackoverflow.com/questions/1806286/getting-installed-app-size)提到了一个小技巧，通过隐藏函数而不是直接缓存大小来获取已安装应用程序的大小。我想他们想要隐藏有关其他应用程序的一些信息有点正常。

# jquery - 添加和删 除透明 div

> ID：11268115
> 
> 赞同：0
> 
> 时间：2012-06-29T19:52:50.187
> 
> 标签：jquery, jquery-ui

我在一个窗口（带有树视图）上添加了一个透明 div，如下所示：

```
function add()
{
$dialog.html('<div id="div1"  style="background: url(img/trans.png); opacity:0.1; filter:alpha(opacity=10); "></div>');
} 
```

如何删除此 div 以便我可以在另一个函数中再次看到窗口的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:56:35.710

```
function subtract(){
$dialog.html('');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T19:56:57.220

试试这个来“隐藏” *div1*：

```
$("#div1").css("display","none"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T20:11:43.623

```
$('#div1', $dialog).remove(); 
```

它`div`会`#div1`从`$dialog`.

如果你使用，你会覆盖 html 内容，所以如果你想取回它，请`$dialog.html()`尝试使用。`append`

看这个[**演示**](http://jsfiddle.net/LXtF9/1/)。

**参考**：

***jQuery.remove()***：[http ://api.jquery.com/remove/](http://api.jquery.com/remove/)
***jQuery.append()***：[http ://api.jquery.com/append/](http://api.jquery.com/append/)

# java - 枚举中没有枚举常量类

> ID：11268118
> 
> 赞同：0
> 
> 时间：2012-06-29T19:53:26.800
> 
> 标签：java, enums

```
public enum ProcessorFactory {
    A("ap") {
        Processor create() throws Exception {
            return new AProcessor();
        }
    },

    B("bp"){
        Processor create() throws Exception {
            return new BProcessor();
        }
    };

    abstract Processor create() throws Exception;

    public static Processor getProcessor(String product) throws Exception {
        ProcessorFactory factory = valueOf(product);
        return factory.create();
    }

    private String product;

    private ProcessorFactory(String product) {
        this.product = product;
    }
 } 
```

现在当我尝试打电话时

```
ProcessorFactory.getProcessor("ap"); 
```

它抛出上述异常。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T19:57:35.720

尝试`ProcessorFactory.getProcessor("A")`

或添加新方法：

```
public ProcessorFactory getbyProduct(String product) {
   for (ProcessorFactory factory : values()) {
      if (factory.getProduct().equals(processor)) {
         return factory;
      }
   }
   return null; // or throw an exception
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T19:58:26.723

好吧，确实没有名为“ap”的枚举值。你只有`A`和`B`。`valueOf`不使用您存储的内容`product`。如果您想通过一些自定义标识符获取枚举，则必须使用一些转换`product`为`ProcessorFactory`值的转换映射（或者只是遍历所有值，效率较低）。

# java - Log4J 不记录任何内容

> ID：11268120
> 
> 赞同：8
> 
> 时间：2012-06-29T19:53:43.680
> 
> 标签：java, log4j, websphere, rad, websphere-7

我刚刚在工作中挑选了一个现有的 Web 应用程序，它应该使用 Log4J 记录其活动。我已经完全按照我被告知的方式配置了我的工作区，其他一切（数据库连接、身份验证等）都可以正常工作，只是没有将任何内容写入日志文件。其他类似的应用程序记录没有问题。

当应用程序启动时，我查看了 WebSphere 控制台，那里没有任何错误可能表明 Log4J 没有记录的原因。

我向另一位开发人员提到了这一点（他曾经在这个应用程序上工作过，但没有一段时间，而且比我现在更过时），他说这是非常奇怪的行为，但不知道为什么它可能无法登录并且不报告任何错误。

我已经检查了配置文件和属性文件，一切*看起来都*很好。我怀疑 Log4J 甚至从未读取过 log4j.xml，但我不确定。自从我使用 Log4J 以来已经有一段时间了 - 有没有人有一些关于解决这类问题的好技巧？

PS：有这个应用程序的实例部署到各种测试/QA/prod 服务器，这些实例都可以正常记录。*仅*在本地工作站上，日志记录似乎静默失败。

* * *

**更新：**因此，应用程序的部署方式似乎确实存在问题。我将类加载器模式更改为“Parent Last”，我可以看到至少现在正在读取 Log4J 文件。我尝试的第一个动作触发了一个找不到的`ClassNotFoundException`说法。`org.apache.commons.logging.impl.Log4jFactory`

* * *

**第二次更新：** 我注意到了一些奇怪的事情......该应用程序有两个 WAR 项目 - 其中一个用于 UI，另一个用于某些 Web 服务。用于 UI 的项目*正在*成功地将其操作记录到日志文件中。Web 服务项目是失败的`ClassNotFoundException`. 它们都将 commons-logging.jar 列为 JavaEE 模块依赖项，并且它们都没有特定于项目的日志记录配置（所有配置文件都在 Resources 项目中）。

一个主要的区别是该 UI 项目包括一些其他内部框架（预编译为 JAR），这些框架*可能*已经包括必要的日志配置，也许这​​就是区别所在。

我还尝试使用此问题的答案（META-INF/services 中名为 org.apache.commons.logging.LogFactory 的文件，其中一行包含：“org.apache.commons.logging.impl.Log4jFactory”）：[Websphere 所有日志都将转到 SystemOut.log](https://stackoverflow.com/questions/8131529/websphere-all-logs-are-going-to-systemout-log/8138477#8138477)，但似乎没有帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-29T23:19:47.273

请参阅此答案： [如何正确初始化 log4j？](https://stackoverflow.com/questions/1140358/how-to-initialize-log4j-properly)

-Dlog4j.debug 对于这样的问题非常有用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T21:23:36.620

我最近更改的最终使日志记录正常工作的是将类加载器模式更改为“PARENT_FIRST”，将 WAR 类加载器策略更改为“应用程序”。初始默认配置是“PARENT_FIRST”/“模块”。我根据一位同事的建议将其更改为“PARENT_LAST”/“Application”，他说日志记录对他们来说很好，这是他们在为此应用程序创建新沙箱时必须进行的唯一更改。我不确定为什么我必须使用“PARENT_FIRST”/“Application”，但至少它现在可以工作了。

* * *

更新：

我尝试设置一个新的工作区，但我遇到了同样的问题。事实证明，您需要“PARENT_FIRST”/“Application”和 META-INF/services 中名为 org.apache.commons.logging.LogFactory 的文件，其中一行包含：“org.apache.commons.logging.impl.Log4jFactory” . 没有该文件会导致日志记录失败（通常会显示一条消息，指出找不到 Log4J）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:30:24.193

我意识到这不是您完全相同的症状，但是如果您的应用程序（或它使用的任何东西）使用 Commons Logging，log4j 就会出现已知问题。看看[这个问题/答案](https://stackoverflow.com/a/8138477/796761)是否相关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-25T09:39:17.943

无法创建日志文件，我在 spring webservice 应用程序中使用了 logback.xml 文件并部署到 websphere 服务器中......但是当我使用 log4j.properties 文件时，它正在创建日志文件。我已经为 log4j 和 slf4j.. logback.xml 文件提供了适当的依赖关系

```
<file>C:/abc/myLogFile.log</file>
<append>true</append>
<encoder>
  <pattern>%d [%thread] %-5level %logger{35} - %msg%n</pattern>
</encoder></appender> 
```

`

依赖：

```
<dependency>
    <groupId>org.slf4j</groupId>
      <artifactId>slf4j-api</artifactId>
      <version>${slf4j.version}</version>
    </dependency>
    <dependency>
      <groupId>ch.qos.logback</groupId>
      <artifactId>logback-classic</artifactId>
      <version>${logback.version}</version>
    </dependency>
    <dependency>
      <groupId>ch.qos.logback</groupId>
      <artifactId>logback-core</artifactId>
      <version>${logback.version}</version>
    </dependency> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-09T20:57:26.683

我遇到了一个问题，log4j 在我的一个项目中没有显示任何内容。原来我在 log4j2.xml 文件的类名中添加了一个前导空格。Log4j 按类名进行字典查找。因此，类名中的任何前导或尾随空格都会使该特定条目无效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-26T08:29:31.393

只是我的两美分 - 我发生了这样的事情 - 但在我的情况下，我可以看到我的日志调用的一些输出。很明显，配置是从其他地方获取的，而我正在更改的配置没有任何影响。

在按照此处的建议打开 -Dlog4j.debug=true 后，很明显 log4j 正在获取一个名为 log4j.xml 的文件，该文件位于我的 tomcat 的工作目录中。它要么是我正在做的其他事情的遗留物，要么是从我配置错误的库中的某个 log4j 配置中以某种方式生成的。

我没有想过擦除工作目录的内容（可以尝试过.. [编辑：我尝试过但没有用]）-我唯一想到的就是通过 -Dlog4j 将硬编码引用传递给我的属性文件.configuration=log4j.properties （不想使用绝对路径）（碰巧我使用的是属性文件而不是 xml） - 它有效。

[编辑：好吧，它不适用于服务器配置。我终于发现了问题所在 - 我作为 JAR 包含在项目中的一些自制库有自己的 log4j.xml 和 log4j.properties 文件，这些文件显然比我自己的属性文件更早被读取/找到 - 最正确的事情是从 JAR 中删除这些多余的属性文件]

# javascript - 在 javascript 中实现 dijkstra 算法时出错

> ID：11268121
> 
> 赞同：2
> 
> 时间：2012-06-29T19:53:44.537
> 
> 标签：javascript, algorithm, dijkstra

我根据wiki中给出的伪代码制作了这段代码。仍然有一些错误。请帮助我编写代码并告诉我如何改进它我正在尝试几个小时！我已将我知道的那行标记为错误。休息一下，我不知道我哪里错了

```
 var graph = [{
        from: [1, 2, 3, 4],
        to: [3, 3, 5, 6]
    }];
    var shortestpath = function (graph, source) {
            for (i in graph) {
                dist[i] = infinty;
                prev[i] = undefined;
            }
            dist[source] = 0;
            var q = [];
            q.push(graph.value);
            while (q != 0) {
               var min_distance = infinity;
var u = null;

for (var i in dist) {
   if (dist[i] < min_distance) {
      u = i;
      min_distance = dist[u];
   }
}
                if (dist[u] = infinity) {
                    break;
                }
                q.pop(u);
                for (v in u) {
                    var alt = dist[u] + dist_between(u, v);
                    if (alt < dist[v]) {
                        dist[v] = alt;
                        previous[v] = u;
                        q.sort(v);
                    }
                }
            }
            return dist;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T19:57:01.483

根据[Dijkstra 的算法伪代码](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm#Pseudocode)， `u` 不应该是一个**列表**，而是一个简单的 int，它保存着距离 in 小的顶点的索引 `Q`。

如果您想要距离最小的顶点，则必须遍历 vertices array ，跟踪到目前为止找到的最小距离，并分配给 `u`具有此距离的顶点。

```
var min_distance = infinity;
var u = null;

for (var i in dist) {
   if (dist[i] < min_distance) {
      u = i;
      min_distance = dist[u];
   }
} 
```

# php - 如何在 PHPUnit 中模拟外部 Web 请求？

> ID：11268125
> 
> 赞同：7
> 
> 时间：2012-06-29T19:53:55.273
> 
> 标签：php, unit-testing, phpunit

我正在使用[Phactory](http://phactory.org/)和[PHPUnit为 PHP](https://github.com/sebastianbergmann/phpunit/) [Propel](http://www.propelorm.org/)项目设置测试套件。我目前正在尝试对发出外部请求的函数进行单元测试，并且我想在该请求的模拟响应中存根。

这是我要测试的类的片段：

```
class Endpoint {
  ...
  public function parseThirdPartyResponse() {
    $response = $this->fetchUrl("www.example.com/api.xml");
    // do stuff and return 
    ...
  }

  public function fetchUrl($url) {
    return file_get_contents($url);
  }
  ... 
```

这是我正在尝试编写的测试函数。

```
// my factory, defined in a seperate file
Phactory::define('endpoint', array('identifier'  => 'endpoint_$n');

// a test case in my endpoint_test file
public function testParseThirdPartyResponse() {
  $phEndpoint = Phactory::create('endpoint', $options);
  $endpoint = new EndpointQuery()::create()->findPK($phEndpoint->id);

  $stub = $this->getMock('Endpoint');
  $xml = "...<target>test_target</target>...";  // sample response from third party api

  $stub->expects($this->any())
       ->method('fetchUrl')
       ->will($this->returnValue($xml));

  $result = $endpoint->parseThirdPartyResponse();
  $this->assertEquals('test_target', $result);
} 
```

我现在可以看到，在我尝试了我的测试代码之后，我正在创建一个模拟对象`getMock`，然后从不使用它。所以该函数`fetchUrl` 实际上执行了，这是我不想要的。但我仍然希望能够使用 Phactory 创建的`endpoint`对象，因为它具有从我的工厂定义中填充的所有正确字段。

有没有办法让我在现有对象上存根方法？所以我可以存根 刚刚创建`fetch_url`的`$endpoint`Endpoint 对象吗？

还是我做错了？有没有更好的方法来对依赖于外部 Web 请求的函数进行单元测试？

我确实阅读了有关“存根和模拟 Web 服务”的 PHPUnit 文档，但是他们这样做的示例代码有 40 行长，不包括必须定义自己的 wsdl。我很难相信这是我处理这个问题的最方便的方法，除非 SO 的好人强烈反对。

非常感谢任何帮助，我整天都在挂断电话。谢谢！！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-02T13:35:36.430

从测试的角度来看，您的代码有两个问题：

1.  url 是硬编码的，让您无法更改它以进行开发、测试或生产
2.  端点知道如何检索数据。从您的代码中，我无法说出端点的真正作用，但如果它不是低级别的“Just get me Data”对象，它不应该知道如何检索数据。

使用这样的代码，没有很好的方法来测试您的代码。您可以使用反射、更改代码等。这种方法的问题是你没有测试你的实际对象，而是一些反射改变了测试。

如果你想编写“好”的测试，你的端点应该是这样的：

```
class Endpoint {

    private $dataParser;
    private $endpointUrl;

    public function __construct($dataParser, $endpointUrl) {
        $this->dataPartser = $dataParser;
        $this->endpointUrl = $endpointUrl;
    }

    public function parseThirdPartyResponse() {
        $response = $this->dataPartser->fetchUrl($this->endpointUrl);
        // ...
    }
} 
```

现在您可以注入 DataParser 的 Mock，它会根据您要测试的内容返回一些默认响应。

下一个问题可能是：如何测试 DataParser？大多数情况下，你没有。如果它只是 php 标准函数的包装器，则不需要。您的 DataParser 应该非常低级，如下所示：

```
class DataParser {
    public function fetchUrl($url) {
        return file_get_contents($url);
    }
} 
```

如果您需要或想要测试它，您可以创建一个 Web 服务，它存在于您的测试中并充当“模拟”，始终返回预配置的数据。然后，您可以调用这个模拟 url 而不是真实的 url 并评估返回。

# ios - iOS：UIApplicationDidReceiveRemoteNotification

> ID：11268127
> 
> 赞同：0
> 
> 时间：2012-06-29T19:54:01.200
> 
> 标签：ios, class, uiviewcontroller, delegates, instance

在应用程序委托之外有类似的东西吗？当我收到通知时，我希望能够在我的视图控制器中做某些事情。我是否只需要导入它们中的每一个并根据我当前的视图控制器检查类的类型以便对它们执行操作？

本质上，如果我收到远程通知并且我没有对堆栈上最顶层视图控制器的确切引用，是否有访问该控制器的类或实例方法的好方法？或者甚至是一些属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:16:04.870

你为什么不直接向他们发送一个 NSNotification （不要误会**通知中心**和**Apple Push Notifications**）？你有一篇很好的文章[在这里](http://devinsheaven.com/cocoa-tutorial-passing-messages-between-objects-notifications-delegates-and-target-action/)谈论它。

# c# - 尝试取消选中 C# 应用程序中的所有复选框时出错

> ID：11268128
> 
> 赞同：0
> 
> 时间：2012-06-29T19:54:12.650
> 
> 标签：c#, wpf, visual-studio, compiler-errors

我是 C# 的新手。

我正在尝试在`uncheck`我`checkboxes`的应用程序中使用此代码

```
foreach (CheckBox control in this.Controls.OfType<CheckBox>()) {
    control.Checked = false;
} 
```

但在这一行中`CheckBox control in this.Controls.OfType<CheckBox>()`，`Controls`用红色下划线。当我尝试运行该程序时，我收到以下错误：

```
Error   1   'FedApp.MainWindow' does not contain a definition for 'Controls' and no extension method 'Controls' accepting a first argument of type 'FedApp.MainWindow' could be found (are you missing a using directive or an assembly reference?) 
```

**注意**我正在使用以下内容：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes; 
```

FedApp 是应用程序的名称。请问我该如何解决。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:14:27.330

要枚举 WPF 窗口中的控件，我认为您应该执行以下操作

```
foreach (object o in LogicalTreeHelper.GetChildren(FedApp.MainWindow))
{
  if (o is CheckBox)
  {
      ((CheckBox)o).Checked = false;
  }
} 
```

# php - php会话必须启动，但当它开始时给出异常

> ID：11268131
> 
> 赞同：1
> 
> 时间：2012-06-29T19:54:34.197
> 
> 标签：php, session

我有一个带有许多选项卡的站点，当我打开任何选项卡时，我想从会话中获取一些数据，但是没有这些数据就无法获取`session_start();`，当我输入时`session_start()`，抛出的异常告诉我会话已经开始

这是例外

```
A session had already been started - ignoring session_start() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:00:19.340

您应该在开始会话之前检查会话是否已设置。

```
if(!isset($_SESSION)){
    session_start();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T19:56:39.423

你可以从

```
if(!$_SESSION) {
    session_start();
} 
```

或者，

```
@session_start(); 
```

“@”抑制错误。

# c - C传递'fread'的参数1使指针从整数而不进行强制转换

> ID：11268132
> 
> 赞同：3
> 
> 时间：2012-06-29T19:54:36.163
> 
> 标签：c

很抱歉打扰你，但我已经坚持了太久了。我在 fread 上收到以下警告：“警告：传递 'fread' 的参数 1 会在没有强制转换的情况下从整数生成指针”
我是 C 新手，非常喜欢它，但不要克服这个问题。
提前致谢。

```
 typedef unsigned char byte;

    int main( int argc, char *argv[]){
        FILE * filein;
        filein = fopen(argv[1], "r" );
        int width=10;
        int height=10;
        byte ** data;

        // Allocation
        data = (byte **) malloc(height*sizeof(byte *));
        for(int i=0;i<height;i++){
            data[i]=(byte *) malloc(width*sizeof(byte));
        }

        for(int i=0;i<height;i++){
            for(int j=0;j<width;j++){
                fread(data[i][j], sizeof(const char), 1, infile);
            }
        }

        for(int i=0;i<height;i++){
            free(data[i]);
        }
        free(data);
        fclose(filein);

        return 0;
        exit(0);
    } 
```

这只是实际程序的一小部分。任务是读取二进制 pgm-image，将其存储在数据矩阵中，标准化值并将它们写入新的二进制 pgm-image。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T19:57:06.817

fread() 需要指向缓冲区的 void* 指针。您正在传递存储在 data[i][j] 中的值，而不是*指向**元素*data[i][j] 的指针。

尝试使用

```
fread(&data[i][j], sizeof(const char), 1, infile); 
```

顺便说一句，.pgm 文件格式（[如果是这样的话](http://netpbm.sourceforge.net/doc/pgm.html)）有一个标题，仅读取宽度*高度字符是不够的。像素值也用空格分隔，所以需要一点解析。另请记住，行尾符号也占用空间（.pgm 一行不能超过 70 个字符）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T19:56:54.927

data[i][j] 的类型是字节。那不是指针。如果您一次读取一个字节，您真正想要的是读取 &data[i][j]。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T21:03:39.810

要读取单个字符，您可以执行

```
int c; // not char, because it must be able to hold EOF
c = getc(infile);
if( c == EOF ){
   // do something about error or premature EOF
}
data[i][j] = c; 
```

这更冗长主要是因为您的代码没有进行错误检查。

# android - 希望应用程序在插入手机并且源确定为 PC（不是 AC 插头）时执行一些代码

> ID：11268136
> 
> 赞同：1
> 
> 时间：2012-06-29T19:55:49.390
> 
> 标签：android, android-intent

**问题：**

我正在尝试编写一个应用程序，当手机插入确定为 PC 的电源而不是 AC 端口时执行一些代码。我还希望这个应用程序有一个用户可以“强制”启动相同代码的 gui 界面。

到目前为止，我有 2 个类：一个是主要活动，另一个是扩展 BroadcastReceiver 的类。

**代码如下：**

MainActivity.java

```
public class MainActivity extends Activity{

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void func1(View view){ //stuff        }

    public void func2(View view){ //stuff        }
} 
```

ChargingOnReceiver.java

```
public class ChargingOnReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
    // TODO Auto-generated method stub
        CharSequence text = "Plug status = " + isUSBConnected(context);
        int duration = Toast.LENGTH_SHORT;
        Toast toast = Toast.makeText(context, text, duration);
        toast.show();
    }
    public static boolean isUSBConnected(Context context){
        Intent intent = context.registerReceiver(null, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
        int plugged = intent.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1);
        return plugged == BatteryManager.BATTERY_PLUGGED_USB;
    }
} 
```

AndroidManifest.xml

```
 <receiver android:name=".ChargingOnReceiver">
        <intent-filter>
            <action android:name="android.intent.action.ACTION_POWER_CONNECTED" />
        </intent-filter>
    </receiver> 
```

*附带问题：*

所以一个快速的第一个问题：如何从 ChargingOnReceiver（例如 func1 或 fucn2）调用 MainActivity 中的方法？例如，我的 isUSBConnected() 函数曾经在 MainActivity 中，但我找不到从 ChargingOnReceiver 调用它的方法，因此我将其移至 ChargingOnReceiver。

**主要问题：**

代码错误： * *FATAL EXCEPTION: main:: java.lang.RuntimeException: Unable to start receiver com.example.ChargingOnReceiver: android.content.ReceiverCallNotAllowedException: IntentReceiver 组件不允许注册接收意图 **

我有点理解为什么它会出错，因为我正在尝试在接收器中注册接收器，但是有人可以指出我如何正确地做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T19:57:01.167

代替：

```
context.registerReceiver(null, new IntentFilter(Intent.ACTION_BATTERY_CHANGED)); 
```

利用：

```
context.getApplicationContext().registerReceiver(null, new IntentFilter(Intent.ACTION_BATTERY_CHANGED)); 
```

这很烦人——`registerReceiver()`应该比这更聪明——但这是这种特殊情况的解决方法。

# php - 有条件的 preg_match_all

> ID：11268140
> 
> 赞同：0
> 
> 时间：2012-06-29T19:56:02.430
> 
> 标签：php, regex, preg-match-all

我有以下格式的数据：
Randomtext1 (random2,random4) Randomtext2 (ran dom) Randomtext3 Randomtext4 (random5,random7,random8)

所以我想识别 Randomtext-part 和括号中的文本，如果它与 preg_match_all 一起存在，但我不知道如何完成它。括号中的内容与 Randomtext-part 一起使用，一些 Randomtext-part 有它，而其中一些没有。

这是我到目前为止所拥有的，它在大多数情况下都有效，但如果文本没有任何括号，那么它会将整个内容与一个匹配。
`preg_match_all("/([a-zA-Z]+)\s+(?([a-zA-Z, ]*))?/",$text,$matches);`

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:00:55.460

```
preg_match_all("/\b\w+\b(?:\s*\(.*?\)|)/", $text, $matches); 
```

# android - 如何在android中制作模糊（倾斜移位）效果？

> ID：11268141
> 
> 赞同：3
> 
> 时间：2012-06-29T19:56:03.927
> 
> 标签：android, camera

我正在尝试做模糊（倾斜移位）效果以使图片看起来像[这样](http://upload.wikimedia.org/wikipedia/commons/b/b2/Oregon_State_Beavers_Tilt-Shift_Miniature_Greg_Keene.jpg)，我想这会在图像的顶部和底部添加模糊。

我想知道当用户在拍照后查看我的相机视图或位图上的最坏情况情景时，我是否可以实时做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:14:43.643

如果您知道如何进行基本模糊，那么您正在寻找的效果应该不难。基本上，您越靠近图像的顶部/底部边缘，就会增加模糊强度。增加对比度/饱和度对于“移轴”效果也很常见。

有关如何首先进行快速模糊的想法，请查看[此问题](https://stackoverflow.com/q/98359/752320)。

至于速度，我相信您可以实时执行此操作，因为您仅在预览大小的位图上执行此操作，因为相对而言，这些位图非常小。拍摄后在实际大小的图像上再次运行该函数。

# internet-explorer - GWT JsonpRequestBuilder 和 codeServer（调试模式）在 IE8 兼容模式下不起作用

> ID：11268142
> 
> 赞同：0
> 
> 时间：2012-06-29T19:56:04.710
> 
> 标签：internet-explorer, gwt, jsonp

当我使用调试模式的代码服务器参数运行 GWT 应用程序时，没有达到断点。这只发生在 IE8 兼容模式下，一切都适用于 IE8 标准模式和其他浏览器。我正在为 IE6 及更高版本编译。

JsonpRequestBuilder 也有同样的问题，请求被成功触发，但从未返回。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:06:03.900

添加以下脚本：

```
<iframe src="javascript:''" id='__gwt_historyFrame' style='position:absolute;width:0;height:0;border:0'></iframe> 
```

就在 nocache.js 参考之前。

# php - 计算活动会话数

> ID：11268145
> 
> 赞同：3
> 
> 时间：2012-06-29T19:56:10.200
> 
> 标签：php

> **可能重复：**
> [查找打开的会话数](https://stackoverflow.com/questions/679657/find-number-of-open-sessions)
> [访问 PHP 中的活动会话](https://stackoverflow.com/questions/3426844/access-active-sessions-in-php)

当用户到达网页时，会为用户创建一个会话变量，我想知道是否可以计算活动会话的数量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:09:37.713

> 当用户到达网页时，会为用户创建一个会话变量，我想知道是否可以计算活动会话的数量？

您存储的所有东西都可以计数。但是，默认情况下，会话中的值是每个用户的，PHP 不会一起跟踪所有会话或其他东西。

因此，由您来创建该上下文。例如，您可以编写自己的会话处理程序。

这在 PHP 5.4 中变得容易多了，因为您现在可以扩展标准会话处理程序并添加您需要的功能。请参阅手册页：[SessionHandler 类](http://php.net/manual/en/class.sessionhandler.php)

那么这怎么可能呢？每次会话存在时，您都会向*共享*的数据存储写入活动会话。如果会话被破坏，例如通过垃圾收集或因为您比较时间并且自上次活动以来已经过去了足够的时间，那么您可以通过共享数据存储来计算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T20:01:07.403

会话存储在 session.save_path（在 ini 文件中）文件夹中的临时文件中。每个文件都以“sess_”开头。我认为您可以计算这些文件的数量以了解有多少会话处于活动状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T20:00:01.213

您可能可以通过以下方式获得会话数：

```
$sessionCount = count(glob(session_save_path()."/*")); 
```

但是，您需要确保正确配置了会话垃圾收集，这样您就不会在其中获得死会话文件。

# internet-explorer - 对象嵌入在 Internet Explorer 中不起作用

> ID：11268152
> 
> 赞同：0
> 
> 时间：2012-06-29T19:56:45.223
> 
> 标签：internet-explorer

好的，所以我正在尝试使用以下代码嵌入一个 swf 文件：

```
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" 
    type="application/x-shockwave-flash" width="640" height="480">
    <param name="FlashContent" value="http://www.drudexflash.com/flash/Vegetard_3.swf" />
    <param name="quality" value="high" />
    <embed src="http://www.drudexflash.com/flash/Vegetard_3.swf" quality="high" width="640" height="480" 
    name="Vegetard - Dragonzball P" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />
    </object> 
```

它似乎在除 Internet Explorer 之外的所有浏览器上都能正常工作，像 youtube 这样的 Flash 内容似乎也能正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:04:04.563

Internet Explorer 使用对象标记。尝试设置一个与你所拥有的不同的 classid。你可以看到我在这里设置的工作版本：http: [//jsfiddle.net/cYrFx/2/](http://jsfiddle.net/cYrFx/2/)

# c++ - C++ 类扩展（继承类中数组的大小不同）

> ID：11268153
> 
> 赞同：2
> 
> 时间：2012-06-29T19:56:47.327
> 
> 标签：c++, inheritance

我是 C++ 新手，我想得到一个建议。我正在编写两个包含相同对象但大小不同的数组的类。这两个类都有相同的方法来处理数组，但每个类都有自己独特的行为。因此，我想创建一个新类来表示数组及其上的操作，并使这两个类扩展它。

例如：

```
Class classA{
     Person* persons[5];
     string className;
     ...
}

Class classB{
     Person* persons[15];
     int integerForClassB;
     string className;
     ...
} 
```

定义类 parentClass 的最佳（最建议）方法是什么，以便它只处理 pesrons 数组并且 classA 将扩展 parentClass（数组大小为 5）而 classB 将扩展 parentClass（数组大小为 15）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:01:24.403

你需要扩展数组处理类吗？也许最好只使用 ClassA 和 ClassB 中的那个类。[更喜欢组合而不是继承](http://en.wikipedia.org/wiki/Composition_over_inheritance)

你需要一个数组吗？正如其他人所说， std::vector 可能会更好。

如果您需要数组，您是否考虑过使用模板？类模板可以具有整数参数，例如

```
template <int npersons> class PersonHandler {
    Person* persons[npersons]
} 
```

所以你可以从 PersonH​​andler<5> 继承 ClassA，从 PersonH​​andler<15> 继承 ClassB。但请注意，PersonClass 是 ClassA 和 ClassB 的不同类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:10:07.920

基于这个问题，我的想法是*最好*的方法是不使用继承。使用`public`继承来定义类层次结构。将其用作代码重用的手段时要非常谨慎，因为通常情况下，组合是更好的选择。

*   正如评论中所建议的，考虑一个[`std::vector`](http://en.cppreference.com/w/cpp/container/vector).
*   如果`std::vector`没有所有所需的操作，请检查是否[`<algorithms>`](http://en.cppreference.com/w/cpp/algorithm)满足您的需求。
*   如果您的需求仍未满足，请考虑将集合操作编写为自由函数而不是成员函数。通过适当的解耦，这些操作可以`std::vector<Person>`在`Person`.
*   如果您必须拥有`Persons`具有非常特定行为的集合，请使用组合。问题描述暗示组合是正确的：“两个类都*包含*一个数组......”

关于继承，如果`classA`is-a collection-of`Persons`和`classB`is-a collection-of `Persons`，则考虑`public`继承，如果行为不同的一组通用方法可以支持一组通用的前置条件和后置条件。例如，考虑一个`Ellipse`and `Circle`：

```
class Ellipse
{
  // Set the width of the shape.
  virtual void width( unsigned int );

  // Set the height of the shape.
  virtual void height( unsigned int );
};

class Circle
{
  // Set the width of the shape.  If height is not the same as width, then
  // set height to be equal to width.
  virtual void width( unsigned int );

  // Set the height of the shape.  If width is not the same as height, then
  // set width to be equal to height.
  virtual void height( unsigned int );
}; 
```

`Circle`从以下内容中得出的结论非常诱人`Ellipse`：

*   在编程之外，有人可能会说这`Circle`是一种特殊的`Ellipse`，就像 a`Square`是一种特殊的`Rectangle`。
*   它们甚至具有相同的成员函数：`width()`和`height()`.

但是，不要这样做！ `Ellipse`可以做`Circle`不能做的事情，例如具有不同的宽度和高度；因此`Circle`不应该是一种`Ellipse`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T20:41:56.793

这样的事情有帮助吗？使用 Person 类型的 STL 向量，您可以使基类对人数进行计数。然后每个派生类为 m_persons 向量调用具有不同大小的基类构造函数。然后，每种情况下的向量将使用默认初始化的 Person 实例填充到请求的大小。

# 包括

```
class Person
{
};

class ParentClass
{
public:
    // Relies on Person having a default constructor
    ParentClass( int personCount ) : m_persons( personCount )
    {
    } 

private:
    std::vector<Person> m_persons;
};

class ClassA : public ParentClass
{
public:
    ClassA() : ParentClass(5)
    {
    }
};

class ClassB : public ParentClass
{
public:
    ClassB() : ParentClass(15)
    {
    }
}; 
```

# c++ - 如何避免 Q_DECLARE_METATYPE 的重复声明

> ID：11268156
> 
> 赞同：8
> 
> 时间：2012-06-29T19:56:55.957
> 
> 标签：c++, qt, qvariant

我的项目包含一个链接到两个静态库的应用程序。每个库都声明`Q_DECLARE_METATYPE< QUuid >`，以便使用`QUuid`with `QVariant`，这会导致`'redefinition of struct QMetaTypeId< QUuid >'`错误。

在保持在不同项目中单独使用每个库的能力的同时，正确的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T12:54:03.907

作为一种解决方法，您可以`Q_DECLARE_METATYPE`从需要它的实现文件中调用宏，而不是从头文件中调用它，或者[按照文档的建议](http://qt-project.org/doc/qmetatype.html#Q_DECLARE_METATYPE)，从每个库中的私有头文件中调用它。

但是因为`QUuid`将其内容存储`QByteArray`为 已经支持的a `QVariant`，所以您不需要使用它`Q_DECLARE_METATYPE`来执行此操作（仅从 Qt 4.8 开始）：

```
// QVariant variant;
// QUuid uuid;
variant = uuid.toByteArray();
uuid = variant.toByteArray(); 
```

或同样的事情，但效率稍低，使用`QString`（在 Qt 4.8 之前）：

```
variant = uuid.toString();
uuid = variant.toString(); 
```

并且由于`QVariant`将在`QString`and之间进行隐式转换`QByteArray`，因此您可以混合 `toString`and`toByteArray`没有任何问题。

# php - 在json数组PHP上去除斜杠

> ID：11268157
> 
> 赞同：-3
> 
> 时间：2012-06-29T19:56:56.190
> 
> 标签：php, json

我有json字符串：`$json = '{ "comment" : "I don\'t like" }';`

```
$json_array = json_decode($json, true); // decode as array rather than object 
```

现在单个代码之前的反斜杠在这里搞砸了：

```
foreach($json_array as $key => $value)
    {
        echo $value;
    } 
```

所以我之前试过这个`foreach`并解码：

```
$json = stripslashes($json); 
```

但仍然报错：

> 错误：为 foreach() 提供的参数无效

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:00:53.317

这不是合法的 PHP 代码：

```
$json = { "comment" : "I don\'t like" } 
```

如果您想要PHP 中的 JSON*字符串：*

```
$json = '{ "comment" : "I don\'t like" }'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:04:11.520

您需要使用[json_decode](http://php.net/json_decode)将您的 json 转换为对象或数组。以下代码输出`I don't like`：

```
$json = '{ "comment" : "I don\'t like" }';
$data = json_decode($json, true);
foreach($data as $key => $value)
{
    echo $value;
} 
```

# flash - 如何从 Cs3 迁移到 Flex

> ID：11268159
> 
> 赞同：2
> 
> 时间：2012-06-29T19:56:59.390
> 
> 标签：flash, apache-flex, actionscript, cs3

虽然我使用 Flash CS3 进行开发，但我的项目实际上是纯 AS3；我的 .FLA 文件只不过是一部 640x480 的电影，没有类，没有控件或库，我的操作窗口只有一行代码

```
 include 'myscript.as' 
```

这是一个大约 10,000 行的大 as3 文件....

生成的 swf 文件大小只有 18k 左右，但在应用程序中发生了很多事情......

我的问题/问题是，如何用 flex 而不是 cs3 编译我的“myscript.as”？（我想使用较新的 as3 函数，并想通过命令行编译）

我应该提一下，我注意到在很多 AS3 代码中有类似下面的内容

```
 public class someapp extends sprite
    {
    ....
    } 
```

我在代码中没有任何类，因为一切都在我自己的状态机中运行，这会是 flex 的问题吗？或者 flex 可以编译 cs3 可以编译的任何东西？

swf（这是一个视频聊天，通话时间类型的应用程序）位于 [http://www.mebeam.net/chat_SO_demo](http://www.mebeam.net/chat_SO_demo)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T23:45:24.240

[首先从http://sourceforge.net/adobe/flexsdk/wiki/Downloads/](http://sourceforge.net/adobe/flexsdk/wiki/Downloads/)下载 Flex SDK

解压它；在解压缩的文件夹中，您会找到一个名为`bin`. 里面有所有的 Flex 编译器和工具。编译 Flex 或 ActionScript 应用程序所需的一个称为`mxmlc`.

您必须至少向其提供以下三项信息：

*   所有 ActionScript 源文件的根路径
*   您想要作为输出文件的文件的路径：这当然应该具有 .swf 扩展名
*   主 ActionScript 类的路径；应用程序的入口点

现在您可以像这样在命令行上编译您的应用程序：

```
mxmlc -source-path+=/path/to/myproject/src -output=/path/to/myApp.swf /path/to/myproject/src/Main.as 
```

据我所知，这个入口点（示例中的 Main.as 文件）必须是一个类，但我必须承认我从未测试过它。因此，您必须至少创建一个扩展 Sprite 的类并从那里启动您的功能程序。

```
public class Main extends Sprite {
    public Main() {
        firstGlobalFunction();
    }
} 
```

# c# - 更改特定列的方向 - 不是整个行或表

> ID：11268160
> 
> 赞同：0
> 
> 时间：2012-06-29T19:56:59.840
> 
> 标签：c#, asp.net, css, telerik, radgrid

我对 Telerik RadGrid 中特定列的排序方向有一点问题。使用 Firebug，我们可以轻松找到并更改表格（主或细节）的方向。但是没有任何类可供特定列访问。

如何更改特定列的排序方向，而不是 Telerik RadGrid 中的整个行或表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:16:48.290

最后我找到了解决方案。
这是示例：

```
 <telerik:GridBoundColumn DataField="PluginPath" FilterControlAltText="Filter PluginPath column" HeaderText="PluginPath" SortExpression="PluginPath" UniqueName="PluginPath"
      FilterImageToolTip="Filter">
          <HeaderStyle HorizontalAlign="Center" VerticalAlign="Middle" />
          <ItemStyle  CssClass="PluginPath" HorizontalAlign="Center" VerticalAlign="Middle" />
     </telerik:GridBoundColumn> 
```

和CSS：

```
.PluginPath
{
    direction: ltr !important;
} 
```

向stackoverflow用户致以最美好的祝愿...

# machine-learning - 由随机人员进行调查是监督学习还是无监督学习？

> ID：11268173
> 
> 赞同：-3
> 
> 时间：2012-06-29T19:57:57.080
> 
> 标签：machine-learning

我有一个城市列表，如`London`,`Paris`等`Roma`。

我想根据某些特征返回哪些城市很有趣。我让人们判断他们是否觉得这些城市有趣。我向每个城市展示了人们对它有多有趣的平均判断。

这是有监督的还是无监督的学习？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-30T06:36:22.713

这是监督学习。
监督学习是指您的训练集同时包含输入数据和所需的输出数据。在这种情况下，输入数据是城市，输出数据是人们给它的评分。

您建议的是推荐系统；这些可以使用一种称为[协同过滤](https://en.wikipedia.org/wiki/Collaborative_filtering)的技术来构建。

# javascript - 如何在调用链的下游取消其他 onclick 函数调用？

> ID：11268174
> 
> 赞同：0
> 
> 时间：2012-06-29T19:58:03.570
> 
> 标签：javascript, internet-explorer, events, javascript-events, onclick

我有一个带有这个 onclick 属性的元素：

```
onclick="ieDisabledBtn(); widgetPayTotalDue.show();" 
```

我已经添加了第一个函数，如果合适的话，我**不想**执行第二个函数。我基本上需要为 IE 调整一些东西（通过使其只读来伪造禁用的按钮，但不能使其可点击）。我不能使用禁用的按钮，因为 IE 为禁用的按钮文本呈现灰色文本。我不能使用禁用的按钮。

这是我为 IE 设置我的假禁用按钮的地方：

```
 (function() {
    var $disabled_btns = $('button[disabled]');

    if ($disabled_btns && $.browser.msie) {
        $disabled_btns.each(function() {
            $(this)
                .removeAttr('disabled')
                .attr({
                    'readonly': 'readonly',
                    'disabledIE': true //set a flag, used in ieDisabledBtn()
                })
                .click(function() {
                    $(this)
                        .removeClass('ui-state-focus') //don't want this button style
                        .find('span').css({ //need to shift text so it stays in same position
                            'position': 'relative',
                            'top': '-1px;',
                            'left': '1px;'
                    });

                    return false;
                }); //end click
        }); //end each
    } //end if
})(); 
```

这是我的 ieDisabledBtn 函数：

```
function ieDisabledBtn(e) {
    //we only care about IE
    if ($.browser.msie){
        var e       = window.event,
            btn     = e.srcElement;

        //yes, we're a disabled IE btn, stop any other onclick events bound to this btn from firing
        if (btn.getAttribute('disabledIE')) { 
            e.returnValue   = false;
            e.cancelBubble  = true;

            return false;
        }
    }
} 
```

我确信这只是设置 e.returnValue = false 的问题，我已经解决了几个变体，但我仍然在执行第二个函数。

我错过了什么？

我将让这些按钮分布在整个应用程序中，它们调用不同的框架模式，因此我希望能够在这些 onclicks 前面加上一个新功能，如果合适的话，它将阻止进一步的 onclick 功能执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:13:11.133

如果您的 onclick 事件处理程序 ( `ieDisabledBtn(); widgetPayTotalDue.show();`) 中有两个语句，它们都将被调用。onclick 属性大致翻译为：

```
function()
{
  ieDisabledBtn();
  widgetPayTotalDue.show();
} 
```

所以你需要在你想被调用的时候`ieDisabledBtn()`返回，这意味着：`true``widgetPayTotalDue.show()`

```
function()
{
  if(ieDisabledBtn())
  {
    widgetPayTotalDue.show();
  }
} 
```

或者：

`onclick="if(ieDisabledBtn()) widgetPayTotalDue.show()"`

为简单起见，最好只有一个函数绑定到一个事件，如果你能提供帮助的话。然后你可以让这个函数做任何你喜欢的事情并保持它的可读性。

# c++ - 当试图优化/内联我看起来平凡但不平凡的 dtor 时，编译器会自责，我做错了什么？

> ID：11268178
> 
> 赞同：1
> 
> 时间：2012-06-29T19:58:34.443
> 
> 标签：c++, destructor, shared-ptr, pimpl-idiom

我有这个共享的 pimpl*。它向前声明了实现对象，并有一个自定义实现的共享指针对象来实现 pimpl 习惯用法（同样，具有共享语义）。浓缩，它看起来像这样：

### Foo.h

```
#include "SharedPtr.h"

class Foo_impl;
class FooFactory;
class Foo {
  friend class FooFactory;
  private:
    SharedPtr<Foo_impl> pimpl;
    Foo(SharedPtr<Foo_impl>);
  public:
    ~Foo();
};
struct FooFactory {
  Foo build() const;
}; 
```

### Foo.cpp

```
#include "Foo.h"

Foo FooFactory::build() const {
  return Foo(SharedPtr<Foo_impl>(new Foo_impl(/*...*/)));
}
Foo::Foo(SharedPtr<Foo_impl> pimpl)
  : pimpl(pimpl) {
}
Foo::~Foo() {
} 
```

现在，（我认为）编译器在编译`Bar.cpp`（使用`Foo`对象和*其他* `SharedPtr`对象）时变得非常聪明并抱怨：

```
SharedPtr.h: In member function ‘void Deallocator<T>::operator()(T*) const [with T = Foo_impl]’:
SharedPtr.h:54:   instantiated from ‘void SharedPtr<T, Delete>::drop() [with T = Foo_impl, Delete = Deallocator<Foo_impl>]’
SharedPtr.h:68:   instantiated from ‘SharedPtr<T, Delete>::~SharedPtr() [with T = Foo_impl, Delete = Deallocator<Foo_impl>]’
SharedPtr.h:44: warning: possible problem detected in invocation of delete operator:
SharedPtr.h:42: warning: ‘t’ has incomplete type
Foo.h:29: warning: forward declaration of ‘struct Foo_impl’
SharedPtr.h:44: note: neither the destructor nor the class-specific operator delete will be called, even if they are declared when the class is defined. 
```

除了and`~SharedPtr<Foo_impl>`之外，还有谁可能在打电话？这是从哪里来的，我该如何解决？`Foo``FooFactory`

注意：制作`~Foo`虚拟并没有帮助，这对我来说更令人费解。

* * *

[* impl 被共享的事实在这里无关紧要，我只是想阻止典型的“请定义一个复制-ctor/分配方法”的评论。共享 pimpl 指针是完全有意的。]

* * *

编辑：`SharedPtr`界面：

```
 33     template <typename T> struct Deallocator {
 34       private:
 35         bool doDelete; // not const to be def. assignable
 36       public:
 38         Deallocator(bool doDelete = true) : doDelete(doDelete) {}
 39         bool willDelete() const {
 40           return doDelete;
 41         }
 42         void operator()(T* t) const {
 43           if (doDelete)
 44             delete t;
 45         }
 46     };
 47
 48     template <typename T, typename Delete = Deallocator<T> > class SharedPtr : private SharedPtrBase {
 49       private:
 50         Delete del;
 51         T* ptr;
 52         void drop() {
 53           if (ptr && shouldDelete()) {
 54             del(ptr);
 55           }
 56           ptr = NULL;
 57           leave();
 58         }
 59       public:
 60         // SharedPtr(p,false) will not delete the pointer! Useful for Stackobjects!
 61         explicit SharedPtr(T* ptr = NULL, Delete del = Delete())
 62           : SharedPtrBase(), del(del), ptr(ptr) {
 63         }
 64         SharedPtr(SharedPtr const& from)
 65           : SharedPtrBase(from), del(from.del), ptr(from.ptr) {
 66         }
 67         ~SharedPtr() {
 68           drop();
 69         }
 70         SharedPtr& operator=(SharedPtr const& from) {
 71           if (&from != this) {
 72             drop();
 73             del = from.del;
 74             ptr = from.ptr;
 75             join(&from);
 76           }
 77           return *this;
 78         }
 79         SharedPtr& operator=(T* from) {
 80           return *this = SharedPtr(from,del);
 81         }
 ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:18:43.507

您没有声明赋值运算符，`Foo`因此如果您使用它，编译器将为您定义一个。编译器生成的将使用 then 复制赋值运算符，`SharedPtr`其中通过许多中间函数调用`delete`a `Foo_impl`。

我看不到你的`Bar.cpp`，所以我不能说你可能在哪里复制`Foo`.

# mysql - 具有某种格式的最新字符串数

> ID：11268181
> 
> 赞同：2
> 
> 时间：2012-06-29T19:58:39.560
> 
> 标签：mysql

我有这样的mysql数据库

```
id | code
1  | bok-1
2  | bok-2
3  | bok-3
4  | inv-1
5  | inv-2
6  | inv-3 
```

我如何获得最新的前缀数`bok-`？
上面示例中的代码结果将是`bok-3`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:02:07.870

这有效：

```
select code
from Table1
where code like "bok%"
order by cast(substring(code from 5) as signed) desc
limit 1 
```

编辑 ：

如果列表中有 bok-11，它现在给出 bok-11，因为我认为 11 大于 3。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:04:20.460

对于代码尝试：

```
select code from table where id in (select max(id) where code like 'bok-%'); 
```

并且仅用于 id：

```
select max(id) where code like 'bok-%' 
```

# haskell - Haskell 和带守卫的“循环”

> ID：11268183
> 
> 赞同：1
> 
> 时间：2012-06-29T19:59:00.323
> 
> 标签：haskell, guard

我对 Haskell 有问题。我有一个简单的代码：

```
petla szerokosc wysokosc pozycje = do
let plansza_x = oznacz_pola_dookola_jako_miejsca_na_skarby_wiele 
            pozycje
        (utworz_plansze pozycje szerokosc wysokosc) 
        szerokosc
 let x = make_list $ zlicz_x plansza_x
 guard ((sprawdz_kombinacje2 plansza_x pozycje (head x) szerokosc wysokosc) == True)
 x 
```

参数很好，但是 GHCI 返回了我的一些奇怪的东西。函数`make_list`返回字符串列表，例如：`[['_','_'],['*','_'],['_','*'],['*','*']]`.

我想要`loop`获取此列表的第一个元素，将其作为参数粘贴到`sprawdz_kombinacje2`. 如果该函数返回`False`，它将从列表中获取网络元素。否则该函数`petla`应返回字符串，例如：`['_','*']`.

问题：当我在 GHCI 中运行这个函数时，它会返回一个空列表，但它不应该：

```
*Main> petla 2 2 [(1,1,1)]
[] 
```

但是，当我添加`return`到最后一行时：

```
petla szerokosc wysokosc pozycje = do
let plansza_x = oznacz_pola_dookola_jako_miejsca_na_skarby_wiele 
            pozycje
        (utworz_plansze pozycje szerokosc wysokosc) 
        szerokosc
 let x = make_list $ zlicz_x plansza_x
 guard ((sprawdz_kombinacje2 plansza_x pozycje (head x) szerokosc wysokosc) == True)
 return x 
```

我编译了它，并使用与以前相同的参数运行此函数，GHCI 返回我：

```
*Main> petla 2 2 [(1,1,1)]

<interactive>:1:0:
    Ambiguous type variable `m' in the constraint:
      `Control.Monad.MonadPlus m'
         arising from a use of `petla' at <interactive>:1:0-18
    Probable fix: add a type signature that fixes these type variable(s) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-30T04:42:34.393

我相信您知道，GHC 和 GHCi 是在格拉斯哥编写的。它的前几个公开版本只接受用苏格兰语编写的代码。例如，使用 RWS monad 看起来像：

```
import Guide.Monad.RWS

ensaumple :: RWS Int [Int] Int ()
ensaumple = dae
  env <- aks
  s   <- git
  lat s' = s + env
  pit s'
  clype [s'] 
```

作者在将其本地化为英语时遇到了相当大的挑战。所以我很确定GHC 能够处理波兰语代码还需要几年的时间。普热普拉萨姆:(

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T21:32:41.927

来自 ghci 的消息，

```
*Main> petla 2 2 [(1,1,1)]

<interactive>:1:0:
    Ambiguous type variable `m' in the constraint:
      `Control.Monad.MonadPlus m'
         arising from a use of `petla' at <interactive>:1:0-18
    Probable fix: add a type signature that fixes these type variable(s) 
```

表示表达式`petla 2 2 [(1,1,1)]`具有推断类型

```
MonadPlus m => m sometype 
```

上的`MonadPlus`约束`m`来自使用`guard`. 但是 ghci 无法知道`MonadPlus`它应该在这里使用哪个实例。在程序中，这通常可以从调用上下文中推断出来，但是在 ghci 提示符下，没有调用上下文。因此，您必须告诉 ghci`MonadPlus`使用哪个实例。您可以通过`petla`在定义它的文件中提供类型签名来做到这一点（或者，如果它是在提示符处定义的，则通过在该处提供类型签名以及定义），或者通过为输入的表达式提供类型签名ghci 提示符，例如

```
ghci> petla 2 2 [(1,1,1)] :: [sometype] 
```

（替换`sometype`为适当的单态类型；如果结果`make_list`是，如帖子所示，则将在签名`[[String]]`中替换）。`sometype`

# solr - 将当前 solr 索引分区为分片

> ID：11268187
> 
> 赞同：1
> 
> 时间：2012-06-29T19:59:21.650
> 
> 标签：solr, partitioning

我一直在分析提高 SOLR 索引性能的最佳方法，并且可能会分片当前索引以允许搜索变得分布式。

然而，鉴于我们的索引超过 400GB 并且包含大约 700MM 文档，重新索引数据似乎很麻烦。我一直在玩弄复制索引和删除文档的想法，以此来更有效地创建分片环境。

不幸的是，模数似乎无法用于查询文档的内部数字 ID。我可以使用哪些其他可能的分区策略来通过查询而不是完整的重新索引来删除？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:09:31.763

一个 lucene 工具可以完成[IndexSplitter的工作，请参阅](https://issues.apache.org/jira/browse/LUCENE-1959)[此处](http://lucene.472066.n3.nabble.com/Index-Splitter-td480905.html)提到的文章链接（日语，用谷歌翻译它......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:43:51.473

If you can find a logical key to partition the data, then it will be helpful in more than one way. For eg. can you have these documents split across shards based on some chronological order?

We have a similar situation. We have an index of 250M docs that are split across various shards based on their created date. A major use case involves searching across these shards based on a range of created date. So, the search is only submitted to the shards that contain the docs with the given date range. There may be other benefits to logically partitioned data - for eg. different capacity planning, applying different qualities of service to search terms etc..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T10:54:32.607

我在[另一个 StackOverflow 问题中回答了这个问题](https://stackoverflow.com/a/12857332/680742)。我编写了一个命令行实用程序（[Hash-Based Index Splitter](https://github.com/healthonnet/hash-based-index-splitter#readme)），用于根据每个文档的 ID 散列拆分 Lucene 索引。

# java - Runtime.exec() 的安全问题

> ID：11268189
> 
> 赞同：2
> 
> 时间：2012-06-29T19:59:27.643
> 
> 标签：java

我正在使用 Runtime.exec() 来运行可执行文件。我一直在研究并发现在应用程序中使用它时可能存在安全问题。使用 Runtime.exec() 运行可执行文件时是否存在任何安全问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-24T17:58:34.443

@Jeanne Boyarsky：显然你不能以你提到的方式注入 Runtime.exec() ，除非 Runtime.exec() 首先生成一个 shell（Windows 上的 cmd.exe 或 Linux 上的 sh/bash/csh/ksh）来运行命令。[这](https://www.owasp.org/index.php/Command_injection_in_Java)是一个很好的链接，它谈到了这一点。

我写了一个小程序来测试一下。它将命令作为用户输入。因此，如果我输入“ **pwd** ”（Linux 系统），它会将当前目录打印到系统控制台。这完美地工作。

但是，如果我尝试运行两个命令，这在 Linux 中是允许的，例如**pwd;id**它会立即抛出异常。抛出的异常如下。

**javax.faces.el.E​​valuationException：java.io.IOException：无法运行程序“pwd；ls”：错误=2，没有这样的文件或目录**

话虽如此，尽管在某些情况下这可能是个问题。如果我有一段代码如下：

**进程 proc = runtime.exec(cmd);**

...用户可以提供**sh -c pwd;id**的输入，从而导致 shell 运行，然后在其中链接命令。

所以简而言之，如果你能提供帮助，最好不要使用 Runtime.exec() 。如果您必须使用它，请确保规范化所有用户输入并仅允许特定字符和命令。

[这](https://wiki.sei.cmu.edu/confluence/display/java/IDS07-J.+Sanitize+untrusted+data+passed+to+the+Runtime.exec%28%29+method)是有关如何编写安全代码的好读物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:10:11.973

我能想到的最大的一个是[Command Injection](https://www.owasp.org/index.php/Command_Injection)。你想把运行的东西列入白名单，这样别人就不能通过你的 Runtime.exec 运行“rm /”。发生这种情况的方法比您想象的要多。例如，如果“目录”名称作为“foo; rm -r ; ls”传入会怎样。

另一个 - 如果这是一个 Web 应用程序 - 是应用程序的权限（因此您的 Runtime.exec() 命令行与访问网页的人所拥有的不同。这意味着该人可以删除您的Tomcat或将数据插入数据库或...

# android - 没有两个 SMS 应用程序在 Android 手机中同时工作

> ID：11268191
> 
> 赞同：1
> 
> 时间：2012-06-29T19:59:42.573
> 
> 标签：android, sms, broadcastreceiver

我正在尝试开发一个应用程序来将收到的 SMS 转发到 Web API。我安装了 Go SMS，这是一个在我的手机中处理消息的应用程序。我的问题是，我无法同时运行这两个应用程序。会有什么问题？

我正在使用 onReceive(() 来处理收到的短信。是否可以同时运行这两个应用程序，还是我的代码中存在问题？如果 GO SMS 阻止了这一点，我如何在我的应用程序中执行相同的操作，以便我的应用程序得到优先于其他 SMS 应用程序？

我的接收代码是，

```
public void onReceive(Context context, Intent intent) {
final String telNumber="123456789";
final String message="message content comes here";
SmsManager sms= SmsManager.getDefault();
sms.sendTextMessage(telNumber, null, message, null, null);
postData(message);
}
public void postData(String url) {
    Create a new HttpClient and Post Header
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://mysite.com/index.php");

    try {
        // Add your data
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        nameValuePairs.add(new BasicNameValuePair("message",url));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost);

    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
    } catch (IOException e) {
        // TODO Auto-generated catch block
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:26:37.677

GO SMS 会禁用来自其他应用的通知，因此您不会有两个 SMS 应用同时通知您。您需要指示您的用户（以及您自己）进入 GO SMS 并从其设置中禁用此功能。

# iphone - 在模拟器与实际 iOS 设备上存储文件

> ID：11268192
> 
> 赞同：0
> 
> 时间：2012-06-29T19:59:43.743
> 
> 标签：iphone, ios, nsdata, nsfilemanager

目前我正在使用以下代码在模拟器上本地存储一些 mp3 文件以获取路径..

```
manager = [NSFileManager defaultManager];
    NSArray* paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    filePath = [paths objectAtIndex:0]; 
```

这种存储方法在模拟器上运行良好，但是当我检查调试器中的实际路径时，它最终成为我的 macbook 上模拟器存储其数据的路径。有谁知道此代码是否也适用于实际设备？是否会生成特定于目标设备的不同路径？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:02:10.930

当然，这段代码应该没问题，`NSFileManager`会为您管理，在 iPhone 设备上这将解析为您的应用程序沙箱。因此，这将是一条不同的绝对路径，但这与您无关。

# c# - 使用 WCF 发现时的 TCP/IP 异常

> ID：11268195
> 
> 赞同：0
> 
> 时间：2012-06-29T19:59:47.860
> 
> 标签：c#, .net, wcf, tcp, discovery

我们有以下代码...

## 发现服务.cs

```
[ServiceContract]
public interface IDiscoveryService
{
    [OperationContract]
    void PrintHello();
}

public class DiscoveryService : IDiscoveryService
{
    public void PrintHello()
    {
        MessageBox.Show("Hello");
    }
} 
```

## 服务器.cs

```
 private void InitializeDiscovery()
    {
        Uri baseAddress = DiscoveryHelper.AvailableTcpBaseAddress;
        ServiceHost host = new ServiceHost(typeof (DiscoveryService), baseAddress);
        host.EnableDiscovery();
        host.Open();
    } 
```

## 客户端.cs

```
 private void DiscoverAddressClick(object sender, EventArgs e)
    {
        EndpointAddress address =  DiscoveryHelper.DiscoverAddress<IDiscoveryService>();
        Binding binding = new NetTcpBinding();

        IDiscoveryService proxy = ChannelFactory<IDiscoveryService>.CreateChannel(binding, address);
        proxy.PrintHello();

        (proxy as ICommunicationObject).Close();
    } 
```

现在，这段代码似乎一直有效，直到我们修改与服务合同有关的任何内容，此时我们得到一个 TCP 异常，错误代码 10061（主动拒绝连接）。但是，我们无法弄清楚谁在拒绝，或者为什么。如果我们试图将我们的代码恢复到以前的状态，当它工作时，我们不能，它只是在（似乎）我们从项目中添加/删除东西之后拒绝工作。

每次我建造时，我都会先清洁。我们也遵循[此处发布的说明](http://msdn.microsoft.com/en-us/magazine/ee335779.aspx)。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:41:08.590

我将首先说明我对 WCF Discovery 不是很熟悉......尽管我可能会在我们的新服务器堆栈中实现它。但是我在这里看不到的一件事是您在此处展示的内容中存在代理服务器。

据我在[MSDN](http://msdn.microsoft.com/en-us/library/dd456787.aspx)上阅读的内容了解，您的 WCF 服务基本上会将其存在注册到网络上运行的代理服务器。然后，您的客户端将通过 DiscoveryProxy 服务器“发现”您的服务服务器。那可能是您缺少的管道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:06:17.173

您当前的服务器实现将在 InitializeDiscovery 方法完成后立即关闭服务器，因为您的主机只有函数范围，并且将由垃圾收集器清理，除非您在其他地方保留引用。

# c++ - 奇怪的 C++ 内存分配

> ID：11268200
> 
> 赞同：12
> 
> 时间：2012-06-29T19:59:59.387
> 
> 标签：c++, object, memory, char

我在 C++ 中创建了一个简单的类 Storer，用于处理内存分配。它包含六个字段变量，所有这些变量都在构造函数中赋值：

```
int x;
int y;
int z;
char c;
long l;
double d; 
```

我对这些变量的存储方式很感兴趣，所以我编写了以下代码：

```
Storer *s=new Storer(5,4,3,'a',5280,1.5465);
cout<<(long)s<<endl<<endl;
cout<<(long)&(s->x)<<endl;
cout<<(long)&(s->y)<<endl;
cout<<(long)&(s->z)<<endl;
cout<<(long)&(s->c)<<endl;
cout<<(long)&(s->l)<<endl;
cout<<(long)&(s->d)<<endl; 
```

我对输出很感兴趣：

```
33386512

33386512
33386516
33386520
33386524
33386528
33386536 
```

为什么 char c 占用四个字节？sizeof(char) 当然返回 1，那么为什么程序分配的内存比它需要的多呢？确认使用以下代码分配了太多内存：

```
cout<<sizeof(s->c)<<endl;
cout<<sizeof(Storer)<<endl;
cout<<sizeof(int)+sizeof(int)+sizeof(int)+sizeof(char)+sizeof(long)+sizeof(double)<<endl; 
```

打印：

```
1
32
29 
```

确认确实是不必要地分配了 3 个字节。谁能向我解释为什么会这样？谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-29T20:10:01.973

**数据对齐和编译器填充打个招呼！**

CPU 没有类型的概念，它在 32 位（或 64 位、或 128 位 (SSE) 或 256 位 (AVX) - 让我们保持简单的 32 位）寄存器中获得的内容需要正确对齐以便正确有效地处理。想象一个简单的场景，你有一个 char，后跟一个 int。在 32 位架构中，char 为 1 个字节，整数为 4 个字节。

一个 32 位寄存器必须在其边界上中断，只接收整数的 3 个字节，并将第 4 个字节留作“第二次运行”。它无法以这种方式正确处理数据，因此编译器将添加填充以确保有效处理所有内容。这意味着根据所讨论的类型添加一定数量的填充。

## 为什么错位是个问题？

计算机不是人类，它不能仅仅用一双眼睛和一个大脑来挑选它们。它必须非常确定并谨慎对待如何做事。首先，它加载一个包含给定信息的 n 个字节的块，将其四处移动，以便删除不相关的信息，然后另一个，再次，移出一堆与手头的操作没有任何关系的不必要的字节，然后只有这样它才能进行必要的操作。通常你有两个操作数，这只是一个完整的。当你完成所有这些工作时，你才能真正处理它。当您可以简单地正确对齐数据时（而且大多数时候，如果您没有做任何花哨的事情，编译器会为您做这件事），性能开销太大了。

## 你能想象一下吗？

视觉上 - 第一个绿色字节是提到的字符，三个绿色字节加上第二个块的第一个红色是 4 字节 int，在 4 字节访问边界上进行颜色编码（我们谈论的是 32 位登记）。底部的“替代部分”显示了一个理想的设置，其中 int 正确命中寄存器（字符被填充到图像之外的某个地方）：

![在此处输入图像描述](../Images/47fcec1aa800242c1a0fa3b6ba4c9c58.png)

阅读有关数据对齐的更多信息，当您处理 SSE（128 位 regs）或 AVX（256 位 regs）等指令集的花哨扩展时，这非常方便，因此必须特别小心，以便优化向量化不会失败（在 SSE 的 16 字节边界上对齐，16*8 -> 128 位）。

## 关于用户定义对齐的附加说明

**phonetagger**在注释中提出了一个有效的观点，即可以通过预处理器分配编译指示指令以强制编译器以用户、程序员指定的方式对齐数据。但是这样的指令，比如`#pragma pack(...)`，是对编译器的一个声明，你知道你在做什么，什么最适合你。确保你这样做，因为如果你不能适应你的环境，你可能会遇到各种惩罚——最明显的是使用你没有自己编写的外部库，它们在打包数据的方式上有所不同。

当它们发生冲突时，事情就会爆炸。最好的建议是在这种情况下谨慎行事，并真正了解手头的问题。如果您不确定，请将其保留为默认值。如果您不确定但必须使用对齐为王的 SSE 之类的东西（而且不是默认的，也不是很简单），请在线查阅各种资源或在此处提出另一个问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T20:08:56.807

我打个比方来帮助你理解。

假设有一条长面包，你有一台切割机，可以将它切成等厚的薄片。然后你把这些面包分发给孩子们。每个孩子都拿着他们的面包，公平地做他们想做的事（把 Nutella 放在他们身上然后吃，等等）。他们甚至可以用它制作更薄的切片并像那样使用它。

如果一个孩子来找你，说他不想要每个人都吃的那片，而是更薄的那片，那你就会有困难，因为你的切割机经过优化，至少可以切割最少的量，这让每个人都开心. 但是当一个孩子要求更薄的切片时，你必须重新发明机器或增加机器的复杂性，比如引入两种切割模式。你不想要那个。最终你放弃了，还是给了他一大块。

这与它发生的原因相同。希望你能理解这个类比。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-29T20:03:09.577

数据对齐是 char 分配 4 个字节的原因：[数据对齐](http://www.songho.ca/misc/alignment/dataalign.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-29T20:02:45.077

`char`不占用四个字节：它像往常一样占用一个字节。您可以通过打印来检查它`sizeof(char)`。其他三个字节是编译器插入的*填充*，以优化对类的其他成员的访问。根据硬件的不同，访问多字节类型（例如 4 字节整数）通常要快得多，因为它们位于可被 4 整除的地址。编译器可以在 int 成员之前插入最多三个字节的填充，以将其与良好的内存地址对齐，以便更快地访问。

如果您想尝试使用类布局，可以使用名为[`offsetof`](http://www.cplusplus.com/reference/clibrary/cstddef/offsetof/). 它有两个参数 - 成员的名称和类的名称，它返回从结构的基地址到内存中成员位置的字节数。

```
cout << offsetof(Storer, x) << endl;
cout << offsetof(Storer, y) << endl;
cout << offsetof(Storer, z) << endl; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-29T20:03:21.160

结构成员以特定方式对齐。通常，如果您想要最紧凑的表示，请按大小递减顺序列出成员。

[http://en.wikipedia.org/wiki/Data_structure_alignment#Typical_alignment_of_C_structs_on_x86](http://en.wikipedia.org/wiki/Data_structure_alignment#Typical_alignment_of_C_structs_on_x86)

# git - 添加从 cvs 转换到超级项目历史的子模块

> ID：11268204
> 
> 赞同：0
> 
> 时间：2012-06-29T20:00:15.100
> 
> 标签：git, git-submodules, git-cvs

我正在将带有很多模块的 CVS 存储库转换为 git。

我将把一些模块与主项目结合到一个 repo 中。但我想保留另外 3 个作为 git 子模块。

在 CVS 中开发项目时，所有 4 个目录都使用相同的标签进行标记。这样我就可以查看项目的完整版本。

我可以将 4 个 CVS 存储库转换为 4 个 git 存储库。没问题。

但是，当我随后将一个 repo 签出为超级项目并将其他 3 个作为子模块添加时，它们仅存在于我随后提交的版本中。

我想要的是能够检查项目的先前标签（现在是 git repo 中的标签）和子模块中的关联标签。我想我需要一个“.gitmodules”文件才能出现在所有这些先前的标签中。

我怎么做？

谢谢，罗伯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:21:09.190

您必须进入每个子模块并重复该命令 - 假设那里存在相同的标签。

```
git submodule foreach 
```

在这种情况下，命令很有用。

# javascript - 浏览器兼容性问题 - 不适用于 IE

> ID：11268205
> 
> 赞同：-6
> 
> 时间：2012-06-29T20:00:18.343
> 
> 标签：javascript, jquery

我的工作在 Firefox 和 Google Chrome 上运行良好，但在 IE 中无法运行。你能指出我哪里弄错了吗？

**脚本.js**

```
$(document).ready(function () {
    $('.delete').click(function () {
        var contentId = $(this).attr('contentid');
        $.confirm({
            'title': 'Delete Confirmation',
            'message': 'Are you sure you want to delete this record?',
            'buttons': {
                'Yes': {
                    'class': 'blue',
                    'action': function () {
                        DoDelete(contentId);
                    }
                },
                'No': {
                    'class': 'orange',
                    'action': function () {}
                    // Nothing to do in this case. You can as well omit the action property.
                },
                'close': {
                    'action': function () {}
                    // Nothing to do in this case. You can as well omit the action property.
                }
            }
        });
    });
}); 
```

**生成 HTML 标记的确认脚本**

```
(function ($) {
    $.confirm = function (params) {
        if ($('#confirmOverlay').length) {
            return false;
        }
        var buttonHTML = '';
        $.each(params.buttons, function (name, obj) {
            buttonHTML += '<a href="#" class="button ' + obj['class'] + '">' + name + '<span></span></a>';
            if (!obj.action) {
                obj.action = function () {};
            }
        });
        var markup = [
            '<div id="confirmOverlay">',
            '<div id="confirmBox">',
            '<div id="header">',
            '<div id ="title">',
            params.title,
            '</div></div>',
            '<div id ="textbox">',
            '<p>',
            params.message,
            '</p></div>',
            '<div id="confirmButtons">',
            buttonHTML,
            '</div></div></div>'
        ].join('');
        $(markup).hide().appendTo('body').fadeIn();
        var buttons = $('#confirmBox .button'),
            i = 0;
        $.each(params.buttons, function (name, obj) {
            buttons.eq(i++).click(function () {
                obj.action();
                $.confirm.hide();
                return false;
            });
        });
    }
    $.confirm.hide = function () {
        $('#confirmOverlay').fadeOut(function () {
            $(this).remove();
        });
    }
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T18:46:59.050

首先，您的`$('.delete')`处理程序的第一行是：

```
var contentId = $(this).attr('contentid'); 
```

但你的标记`.delete`是：

```
<div class="delete"></div> 
```

（注意缺少`contentId`属性）。幸运的是（？）您的代码实际上似乎没有使用`contentId`:-)

更相关的是，您需要确定代码的哪一部分正在破坏（如果您有代码的 JS Fiddle，我可以查看，但既然您没有，您必须自己找出来）。我会在调用`alert`之前放一个`$.confirm`，然后再在里面放一个`$.confirm`，以确保代码甚至可以到达您的插件（如果没有，那是您的问题）。

如果是，那么下一个要问的问题是“您的标记是被添加但没有被显示，还是根本没有被添加”。警报或 IE 开发人员工具都应该让您检查 DOM 并确定您的标记是否被添加；如果没有，那是你的问题。如果它正在被添加，但没有显示出来，那么`fadeIn`你的 出现了问题，这就是你的问题。

最后一点，有一种更简单的方法可以连接按钮事件；代替：

```
var buttons = $('#confirmBox .button'),
        i = 0;
$.each(params.buttons, function (name, obj) {
    buttons.eq(i++).click(function () {
        obj.action();
        $.confirm.hide();
        return false;
    });
}); 
```

你可以这样做：

```
$('#confirmBox .button').each(function(button) {
    $(button).click(function () {
        params.buttons[$(this).text()].action();
        $.confirm.hide();
        return false;
    });
}); 
```

# php - 通过参数解析 Apache 日志中的 GET 请求

> ID：11268206
> 
> 赞同：0
> 
> 时间：2012-06-29T20:00:19.047
> 
> 标签：php, python, apache, parsing, logging

我有一组要解析的 Apache 日志。具体来说，该站点上运行的 PHP 脚本将参数传递给数据库，以将结果过滤给公众。这个名为“searchbox.php”的脚本传递了三个我对结果感兴趣的参数（在其 URL 中）：

*   引擎
*   询问
*   子引擎

其余的信息目前对我来说没有价值。以下是单个日志条目的格式：

```
sub.domain.com 123.456.789.456 - - [28/Jun/2012:00:04:00 -0500] "GET /sitescripts/search-box/searchbox.php?engine=catalog-vs-worldcat&query=law+enforcement+articles&x=0&y=0&subengine=iiikw HTTP/1.1" 302 20 "http://sub.domain.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" - 0 
```

我需要的信息在 GET 请求中，我只需要一种干净的方式从这些大型日志文件中提取这三位信息并将其转储到 CSV 或制表符分隔的文件中。

我想这将在 PHP 中完成，但我也会使用 Python。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:55:36.127

你可以使用正则表达式...

```
re_str = r"\?engine=(?P<eng>[\w-]*?)&query=(?P<query>[=\d\+\w-]*?)&subegine=(?P<sub>\w*)\s"
reg = re.compile(re_str)
for line in file:
  m = reg.search(line)
  print "Engine", m.group("eng")
  print "Query", m.group("query")
  print "Sub", m.group("sub") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:32:31.213

因此，假设您知道如何逐行读取文件，您可以使用 explode() 将行拆分为一个数组，然后继续分解数组中的元素，直到到达您想要的位置。

```
$line_parts = explode(" ", $line_you_read_from_log);
$url = $line_parts[6];
// /sitescripts/search-box/searchbox.php?engine=catalog-vs-worldcat&query=law+enforcement+articles&x=0&y=0&subengine=iiikw
$url_parts = explode("?", $url);
$query = $url_parts[1];
// engine=catalog-vs-worldcat&query=law+enforcement+articles&x=0&y=0&subengine=iiikw
$pairs = explode("&", $query);
// and so on and so on... 
```

正则表达式是另一种选择，但如果你看得太久，它们可能会变得复杂并让你发疯。

在 bash 中，您可以使用 sed 和 awk 来解析日志。取决于你的经验和环境。

# xpath - 如何使用 Selenium 的 xpath 获得第二个属性级别

> ID：11268210
> 
> 赞同：1
> 
> 时间：2012-06-29T20:00:29.733
> 
> 标签：xpath, selenium, selenium-rc

我正在尝试检查 Selenium 元素是否具有绿色边框。

我可以使用`//div[@id="target"]/@style`已解析的样式字符串来应用...并使用字符串搜索来搜索边框...我必须解决一些显示速记（`border: solid 3px green`）和其他显示扩展（`border-style: solid; border-color: green....`）的brosers ...但是怎么可能我这样做更干净吗？

理想情况下是这样的：`//div[@id="target"]/@style.borderColor`

我也想避免使用`contains`选择器，因为语法很糟糕。但如果这是唯一的方法，那就这样吧。当然。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T23:42:33.083

XPath 对 CSS 样式一无所知，它不理解属性并将它们视为简单的字符串。如果 XML 查询语言理解 CSS 样式，那会很奇怪，对吧？

此外，它[`getAttribute()`](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/Selenium.html#getAttribute%28java.lang.String%29)使用*类似于*XPath 的构造，但*不是*XPath！它还通过`@`符号选择属性，对。但是考虑一下这个定位器：`"id=target@style"`. 它可以工作，但绝对不是 XPath。

它还将返回显式设置的属性，而不是内部计算值，因此除非元素上`style`确实存在属性，否则它是无用的。`style`如果`style`定义了属性，那就去吧。

Selenium 本身不能给你正确的答案（WebDriver 有[`getCssValue()`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebElement.html#getCssValue%28java.lang.String%29)，但在 Selenium RC 中没有对应的，afaik）。

因此，在 Selenium RC 中获取元素的计算样式（从所有来源计算的最终值）的唯一方法是通过 JavaScript。

多年来一直为我工作的脚本（经过轻微编辑）是这样的（来自[quirksmode.org](http://www.quirksmode.org/dom/getstyles.html#link7)）：

```
function getStyle(id, stylePropJs, stylePropCss) {
    var x = document.getElementById(id);
    if (x.currentStyle)
        var y = x.currentStyle[stylePropJs];
    else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(x,null).getPropertyValue(stylePropCss);
    return y;
} 
```

请注意，IE 需要属性的 JavaScript 名称，但其他所有浏览器都使用 CSS 名称。此外，您*不能*使用速记属性，而*必须*使用扩展属性。因此，在您的情况下：

```
String script = "var x = document.getElementById('target');" +
                "if (x.currentStyle) var y = x.currentStyle['borderTopColor'];" +
                "else if (window.getComputedStyle) var y = document.defaultView.getComputedStyle(x,null).getPropertyValue('border-top-color');" +
                "y;";
String color = selenium.getEval(script); 
```

`target`这将返回元素顶部边框的颜色（是的，您需要调用它四次才能获得整个边框） 。但猜猜怎么了！每个浏览器都以不同的格式返回颜色。幸运的是，至少在 Java 中，有一个[`Color`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/support/Color.html)类可以轻松地重新格式化它：

```
String color = Color.fromString(color).asHex(); 
```

现在您已经存储了十六进制编码的颜色，您可以轻松检查它是否为绿色。

# c# - 在 C# 中创建自定义常量后缀

> ID：11268213
> 
> 赞同：4
> 
> 时间：2012-06-29T20:00:48.143
> 
> 标签：c#, .net

我正在尝试为无限大小的整数值开发一个类，我只需要创建一个与分配运算符一起使用的新自定义常量后缀。

例如：

让我们假设类名是 BigInt 并且创建的后缀是 B

分配语句将是这样的

```
// B character will tell the compiler about the New Data Type
BigInt x = 111111111111111111111111111111111111111111111111B; 
```

有没有办法做到这一点？

特别的问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T20:02:22.900

不，目前在 C# 中没有任何方法可以做到这一点。

解决方法：您可以查看[Nemerle](http://nemerle.org/About/)，它是一种基于 C# 语法的非常灵活、元编程友好的语言。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-29T20:09:21.170

不，语言/编译器不支持这个。您可能想要研究的接近的东西是隐式[转换运算符](http://msdn.microsoft.com/en-us/library/85w54y0a.aspx)。这会让你做这样的事情：

```
BigInt b = "1234";

public class BigInt
{
    public static implicit operator BigInt(string value)
    {
        return new BigInt {Value = value};
    }
    public string Value { get; private set; }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-29T20:04:11.147

无法以您描述的方式直接扩展语言。

您*可以*编写类似于 C# 并接受这样的说明符的 .NET 语言，但与您正在尝试做的事情完全不同。

注意：存在任意大小的整数的现有结构[`BigInteger`](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx)- 无需重新发明轮子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T20:05:03.020

微软已经这样做了。它被称为 BigInteger。认为它是随 .NET 4.0 推出的？

这是 MSDN 链接：http: [//msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx)

至于像那样扩展它，我认为这在 C# 中是不可能的。您必须重载赋值运算符，据我所知，这仅在 C++ 中可行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T20:09:12.367

我不完全确定，但你可以看看 Roslyn。查看[http://kevinmontrose.com/2012/06/10/extending-type-in​​ferencing](http://kevinmontrose.com/2012/06/10/extending-type-inferencing-in-c/) -in-c/了解更多信息。

# mysql - 历史数据的存储和分析——什么样的数据库？

> ID：11268214
> 
> 赞同：2
> 
> 时间：2012-06-29T20:00:52.540
> 
> 标签：mysql, plot, nosql

我目前正在设计一个系统来观看 youtube 视频的排名/观看次数。每天都有大量的 youtube 视频（> 500.000 并且还在增长）。

我目前正在考虑将其存储在 MySQL 数据库中，但令我不安的是，该表会增长到数十亿和数万亿行，我认为这不会很好。

我需要分析这些数据，例如：

*   哪些视频在 X 和 Y 之间的时间里增长了很多
*   绘制每天的点击次数
*   绘制每周的点击次数...
*   还有一些我还不知道的事情

那么，我的 web 2.0 想到的是，有没有一种 NoSQL 数据库可以更好地处理这个问题？我没有完全了解这些（几乎）新数据库，也不知道它们能做什么。

您的建议是什么，使用什么类型的数据库？有没有关系？如果不是，哪个 NoSQL 数据库？

PS：第一优先是快速评估和插入结果，第二是高可用（或者只是复制）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:36:11.553

为数据库系统提供建议是非常困难的，因为它总是依赖于它。但是，考虑到 Facebook 是建立在 MySQL 之上的，这表明 MySQL 对你来说可能没有性能限制。

有帮助并且您可能已经完成的是创建表结构应该是什么样子的结构。然后还要考虑您想对表运行的查询。

如果您拥有正确的索引（这是查询速度所依赖的主要和关键因素），您将不必担心 MySQL 的性能。您应该考虑的是（我必须经历的），MySQL 如何处理索引有很多有趣的事情。让我举几个我在此期间必须弄清楚的例子：

*   如果要使用索引进行范围扫描，则不能再使用`ORDER BY`索引
*   范围列必须是连接索引中的最后一个才能使用完整索引，同样`ORDER BY`如此

有关更多信息，请访问 mysqlperformanceblog.com 上的有用链接：[http ://www.mysqlperformanceblog.com/2009/09/12/3-ways-mysql-uses-indexes/](http://www.mysqlperformanceblog.com/2009/09/12/3-ways-mysql-uses-indexes/)

一般来说，如果数据库的结构经过深思熟虑并且索引良好，根据我的经验，实际上如果您只有 10.000 行或 100 亿行，查询时间将大致相同。

# javascript - 如何预览线条工具？

> ID：11268218
> 
> 赞同：2
> 
> 时间：2012-06-29T20:00:57.890
> 
> 标签：javascript, html, canvas

我正在尝试制作一个绘图应用程序，目前正在使用线条工具，并希望拥有 Microsoft Paint 和其他绘图应用程序中存在的预览。

我正在使用 HTML5 Canvas 和 Javascript，并且还使用了典型的画布绘图 API，如下所示：

```
context.beginPath();
context.moveTo(originX, originY);
context.lineTo(mousePos.x, mousePos.y);
context.stroke(); 
```

但是，当用户试图确定他想要哪一行时，它开始看起来像这样，因为它不会删除前一行：

![在此处输入图像描述](../Images/f339a66ecc49a67650246dfe9c8ebcd0.png)

中间的点是用户开始画线的起点。我无法每次都清除画布，因为可能还绘制了其他东西。我能想到的唯一解决方案是实现某种撤消功能，但这似乎会很慢而且很草率。

有谁知道如何实现这种预览功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T20:46:48.257

我建议使用多个画布。

**[现场演示](http://jsfiddle.net/loktar/zbTzq/)**

所以基本上他们在继续清除的顶部进行初步绘图，一旦他们释放鼠标按钮，它就会将其绘制到较低的“永久”画布上。

小提琴中的代码，由于 jsFiddle 最近速度很慢，因此将其添加以供参考。

```
var canvas = document.getElementById("canvas"),
    ctx = canvas.getContext("2d"),
    drawCanvas = document.getElementById("drawCanvas"),
    drawCtx = drawCanvas.getContext("2d"),
    painting = false,
    lastX = 0,
    lastY = 0,
    curX = 0,
    curY = 0,
    startX = 0,
    startY = 0,
    lineThickness = 1;

canvas.width = canvas.height = 600;

drawCanvas.width = drawCanvas.height = 600;

drawCanvas.onmousedown = function(e) {
    startX = e.pageX - this.offsetLeft;
    startY = e.pageY - this.offsetTop;
    painting = true;

};

drawCanvas.onmouseup = function(e){
    painting = false;

    ctx.strokeStyle = "#000";
    ctx.beginPath();
    ctx.moveTo(startX, startY);
    ctx.lineTo(lastX, lastY);
    ctx.stroke();

    drawCtx.clearRect(0, 0, 600, 600);
}

drawCanvas.onmouseclick = function(e) {

    startX = e.pageX - this.offsetLeft;
    startY = e.pageY - this.offsetTop;

    painting = true;
};

drawCanvas.onmousemove = function(e) {
    if(painting){
        lastX = e.pageX - this.offsetLeft;
        lastY = e.pageY - this.offsetTop;
        drawCtx.clearRect(0,0,600,600);
        drawCtx.beginPath();
        drawCtx.moveTo(startX ,startY );
        drawCtx.lineTo(lastX, lastY);
        drawCtx.stroke();
    }
}
​ 
```

# php - 在 codeigniter 中放置大的、很少使用的函数的位置

> ID：11268221
> 
> 赞同：0
> 
> 时间：2012-06-29T20:01:10.763
> 
> 标签：php, codeigniter

我有几个相当大的功能，每个只用于一个控制器功能，我想知道把这些放在哪里？他们没有显示任何视图，而是处理一些数字。
如果我没记错的话，我可以在 4 个地方放置这些函数：在我的控制器中、助手中、库中或模型中。但是这些似乎都不合适，因为我不希望每次用户使用控制器时都加载代码，并且模型应该用来做数据库的东西，帮助器和库应该包含可以反复使用的代码再次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:19:43.807

如果是业务逻辑，最好把它放在控制器中作为私有方法，然后你可以从控制器内部调用该方法。

请注意，除非您自动加载它们或将它们加载到控制器的构造函数中，否则并不总是加载助手。因此，作为替代方案，您可以将这些方法设为帮助程序，然后将帮助程序加载到您希望使用它们的控制器操作中。这样，它们仅在您需要时才加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:22:31.243

CodeIgniter 附带了您可能不会使用的帮助程序（除非您在 application/config/config.php 文件中指定它，否则不会加载）并且我认为只有在存储在那里时才使用的功能（应用程序/帮手）。例如，我可能只使用一次随机密码生成器，但它仍然存在并且不会加载，除非我调用它。

```
$this->load->helper('my_string_generators'); 
```

# javascript - 使用 jQuery 防止在 HTML 文本框中输入空格

> ID：11268222
> 
> 赞同：9
> 
> 时间：2012-06-29T20:01:19.197
> 
> 标签：javascript, jquery, html, input

所以我有一个`HTML`用户可以输入的表单。我如何使用 javascript/jQuery 立即无缝地从文本框中删除空格？我一直在研究`.val()`jQuery 方法并想出了这个：

```
$('input').keydown(function() {
    str = $(this).val();
    str = str.replace(/\s/g,'');
    $(this).val(str);
}); 
```

这对删除文本做了奇怪的事情，并且空格仍然出现在击键上，它们只是在下一次击键时被删除。有什么建议么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-29T20:05:04.847

您可以通过检查按下的键是否是空格键并在是的`false`话返回来阻止它被添加：

```
​$("input").on("keydown", function (e) {
    return e.which !== 32;
});​​​​​ 
```

这是一个[工作示例](http://jsfiddle.net/USJws/)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-29T20:02:56.687

尝试使用`keyup`

**[现场演示](http://jsfiddle.net/rajaadil/5Tax7/)**

```
$('input').keyup(function() {
    str = $(this).val();
    str = str.replace(/\s/g,'');
    $(this).val(str);
}); 
```

# windows - 在 Windows UNIDRV 中调试字体替换

> ID：11268223
> 
> 赞同：1
> 
> 时间：2012-06-29T20:01:19.747
> 
> 标签：windows, fonts, driver, printers, glyph-substitution

我正在开发基于 UNIDRV 的打印机驱动程序，并且遇到了字体替换问题。UNIDRV 未使用任何设备字体。所有字体一次下载一个字形到打印机。是否有 UNIDRV 的日志，和/或有什么方法可以调试 UNIDRV，尤其是字体替换？

开发和目标机器都是Windows 7（32位）。

# iphone - 将视图控制器添加到数组

> ID：11268225
> 
> 赞同：0
> 
> 时间：2012-06-29T20:01:24.783
> 
> 标签：iphone

我如何将这四个视图控制器添加到数组中

```
self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]]autorelease];    
ContainerViewController  *container= [[[ContainerViewController alloc]init]autorelease];
self.window.rootViewController = container;  
NSMutableArray *controllers = [NSMutableArray array];
for (int i=0; i<23; i++)
{
    First *first = [[First alloc] init];
    Second *second = [[Second alloc] init];
    Third *third = [[Third alloc] init];
    Fourth *fourth = [[Fourth alloc] init];

    [controllers addObject:first];
    [controllers addObject:second];
    [controllers addObject:third];
    [controllers addObject:fourth];
    }

 [container setSubViewControllers:controllers];
[window makeKeyAndVisible];
return YES; 
```

收到黄色警告，指出找不到实例方法 setSubViewController 返回类型默认为 id

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:10:38.143

要将视图控制器添加到数组中，不需要 for 循环。删除循环，并添加：

```
First *first = [[First alloc] init];
    Second *second = [[Second alloc] init];
    Third *third = [[Third alloc] init];
    Fourth *fourth = [[Fourth alloc] init];

    [controllers addObject:first];
    [controllers addObject:second];
    [controllers addObject:third];
    [controllers addObject:fourth]; 
```

对于`container`:中的视图控制器`setSubViewControllers`不是有效的方法。但是，您可以使用`addChildViewController`. 你可以遍历你的数组，然后调用 [container addChildViewController:x#ViewController]; 就像是：

```
for (id thisViewController in controllers) {
thisViewController = (UIViewController *)thisViewController;
[container addChildViewController:thisViewController];
} 
```

注意：我没有测试过这段代码。如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:11:41.237

设置这个

```
- (void)setSubViewControllers:(NSArray *)subViewControllers; 
```

在 .h 中`ContainerViewController` 这将帮助您摆脱警告，但我不确定您在逻辑上做什么，而且我建议您在循环中释放您的子视图控制器，然后再分配它们......

# asp.net-mvc-3 - jQuery选择麻烦

> ID：11268229
> 
> 赞同：0
> 
> 时间：2012-06-29T20:01:42.273
> 
> 标签：asp.net-mvc-3, jquery

我正在尝试使用 jquery 选择一些隐藏字段以从 aa 表中的某一行中检索一些值以进行 ajax 调用。第一个变量 (ebId) 被很好地检索，但所有其他变量都没有被设置。它们都是空的。我不能使用隐藏字段的名称，因为这些隐藏字段是动态创建的，并且具有相同的名称。所以我正在尝试使用一个类。知道为什么我选择最后 3 个变量（_product、_applicantType、_ssn）的方式不起作用吗？

这是 JQuery 和相关的 HTML

```
$('.submissionStatus').click(function () {
        var _ebId = $(this).next('.ebId').val();
        var _product = $(this).next('.product').val();
        var _applicantType = $(this).next('.applicantType').val();
        var _ssn = $(this).next('.ssn').val();

        $.ajax({
            type: 'GET',
            data: { ebId: _ebId, product: _product, applicantType: _applicantType, ssn: _ssn },
            url: '@Url.Action("GetSeverityErrors", "AppListing")',
            success: function (data) {
                alert('Call success')
                $(this).next('.loaded').val(true);
            },
            error: function (xhr, status, error) {
                alert('An Error Occured.');
            }
        });
    });

<input type="hidden" class="ebId" value="@item.ElectedBenefitId" />
<input type="hidden" class="product" value="@item.Product" />
<input type="hidden" class="applicantType" value="@item.ApplicantType" />
<input type="hidden" class="ssn" value="@item.Ssn" /> 
```

更多 HTML 见解：

```
<td align="left">
  <a style="color:red;" class="submissionStatus" href="javascript: void(0)" title="SubmissionStatus">@item.SubmissionStatus.ToPrettyString()</a>

<input type="hidden" class="ebId" value="@item.ElectedBenefitId" />
<input type="hidden" class="product" value="@item.Product" />
<input type="hidden" class="applicantType" value="@item.ApplicantType" />
<input type="hidden" class="ssn" value="@item.Ssn" />
<input type="hidden" class="loaded" value="false" />
 </td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:08:05.327

请注意，`closest()`根据它的参数选择最近的父元素，试试这个：

```
var _ebId = $(this).siblings('input.ebId').val();
var _product = $(this).siblings('input.product').val();
var _applicantType = $(this).siblings('input.applicantType').val();
var _ssn = $(this).siblings('input.ssn').val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:09:17.187

```
$('.submissionStatus').click(function () {

        var storThis = this;
        var _ebId = $(storThis).next('.ebId').val();
        var _product = $(storThis).next('.product').val();
        var _applicantType = $(storThis).closest('.applicantType').val();
        var _ssn = $(storThis).closest('.ssn').val(); 
```

# sockets - DHCP-服务器套接字接口

> ID：11268230
> 
> 赞同：0
> 
> 时间：2012-06-29T20:01:47.827
> 
> 标签：sockets, network-programming, dhcp

这可能是一个愚蠢的查询，但我正在寻找确认。

我计划根据一些典型的客户需求来实现一个 DHCP 服务器。为此目的，我在使用 RAW 套接字和 DGRAM 套接字之间有点困惑。我的理解是服务器可以通过 DGRAM 套接字实现，假设所有 DHCP 回复都可以处理，而 DHCP 客户端需要一个 RAW 套接字，因为在服务器提供 IP 地址之前它没有 IP 地址。

我对这些点的理解正确吗？

伙计们，

在进一步挖掘之后，服务器正在发送 DHCP OFFER 消息，其中包含客户端的 Mac 地址作为一个选项 (chaddr)。AFAIK; 使用 RAW Sockets 的服务器应用程序只能获取 DHCP 客户端机器的 MAC 地址。有没有可能。我们可以请求内核（TCP/IP 堆栈）将 mac 地址传递给通过 DGRAM 套接字运行的应用程序吗？感谢您的关注 ！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:30:32.090

好的。经过进一步的协议分析；dhcp client it-self 在 DISCOVER Packet 中发送 mac 地址。因此; 不需要 RAW Socket 并且使用 DGRAM Socket 本身我们可以实现 DHCP 服务器。

# javascript - 每次按下按钮时添加一个新的文本字段

> ID：11268232
> 
> 赞同：1
> 
> 时间：2012-06-29T20:02:05.797
> 
> 标签：javascript, html

我正在尝试创建一些 javascript，每次按下按钮时都会创建一个新的文本字段，任何帮助将不胜感激，似乎 javascript 不想运行不止一次

```
<!DOCTYPE html>
<html>
    <head>
        <title>Q&A Admin Panel</title>
    </head>
<body>
    <h1>Q&A Admin Panel</h1>
    <form action="add_question.php" method="post">
    Question Type: <input type="text" id="questionType" />
    Question Name: <input type="text" id="questionName" />
    Question Text: <input type="text" id="questionText" />
    <select id="myList" onchange="selectType()">
    <option>Yes or No</option>
    <option>Multiple Choice</option>  
    <option>Multiple Select</option>
    <option>Open Response</option>
    </select>
    <div id='buttons'> </div>
    </form>
    <script type="text/javascript">
    function selectType()
    {
    var type=document.getElementById("myList");
    if(type == "Multiple Choice" or type == "Multiple Select"){
    // add answer = visible
        }
    }
    </script>

    <script type="text/javascript">
    var answers = 0;
    function addAnswer()
    {
    write = document.getElementById('buttons');
    write.innerHTML = write.innerHMTL + "add answer: <input type=\"text\" id=\"answer" + answers + "\" <br>";
    answers = answers + 1;
    }
    </script>
    <button onclick="addAnswer(); return false;">add answer</button>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:08:07.097

```
var answers = 0,
    write = document.getElementById('buttons');

function addAnswer() {
    write.innerHTML += 'Add answer: <input type="text" id="answer"' + answers + '/> <br />';
    answers++;
}​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T23:35:14.277

我在大学项目中遇到了同样的问题。您也可以按照 David 的建议完成您的工作，但使用 innerHTML 不会向 DOM 添加元素，因此，当您刷新页面时，文本字段将消失。因此，要获取持久文本字段，您可以使用下面提到的代码：

```
var i = 0;

function addMore()
{
   var x = document.getElementById('buttons');
   var input1 = document.createElement("input");
   input1.setAttribute("type","text");
   input1.setAttribute("name","i" + i );
   x.appendChild( input1 );
   i++;
} 
```

你可以使用 firebug 来调试 javascript 的东西。谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-28T15:33:12.583

```
function addTextField(id){
    var colors = new Array('#660000','#33ff00','#0066ff','#cc3399','#9966ff');
    var container = document.getElementById(id);
    var ulElement = document.createElement('ul');
    container.appendChild(ulElement);
    var hideLink = function(){
        var firstElement = ulElement.firstChild.getElementsByTagName('a')[0];
            firstElement.style.display = (ulElement.childNodes.length==1)?'none':'inline';
        for(var i = 0 ; i <ulElement.childNodes.length; i++)
            ulElement.childNodes[i].style.color = colors[i%5];
    }
    var addListElement = function(){
        var liElement = document.createElement('li');
        ulElement.appendChild(liElement);
        var textElement = document.createElement('input');
        textElement.setAttribute('type','text');
        liElement.appendChild(textElement);

        var deleteLink = document.createElement('a');
        deleteLink.href = "#";
        deleteLink.appendChild(document.createTextNode('delete'));
        liElement.appendChild(deleteLink);
        deleteLink.onclick = function(){
            ulElement.removeChild(liElement);
            hideLink();
        }
        hideLink();
    }
    addListElement();
    var anchorElement = document.createElement('a');
    anchorElement.href = "#";
    anchorElement.appendChild(document.createTextNode('Add more'));
    container.appendChild(anchorElement);
    anchorElement.onclick = addListElement;
    hideLink();

} 
```

这是演示 [http://jsfiddle.net/mannejkumar/cjpS2/](http://jsfiddle.net/mannejkumar/cjpS2/)

# java - 等待并通知问题

> ID：11268233
> 
> 赞同：2
> 
> 时间：2012-06-29T20:02:05.847
> 
> 标签：java, wait, notify, kdb

之前我发布了一个关于实现等待和通知的问题，但我不是很清楚，所以这里有一个更具体的问题。

在下面的长代码块中，有一个等待和一个通知。通知应该停止等待并导致它停止等待。目前，我认为等待有效，但通知无效。有人可以解释为什么通知不通知等待吗？谢谢！

注意：其余代码工作我只对这两个特定部分感兴趣。

```
import com.fmr.ipgt.email.*;
import java.io.File;
import java.io.IOException;
import java.util.List;
import org.jdom.Document;
import org.jdom.Element;
import org.jdom.JDOMException;
import org.jdom.input.SAXBuilder;
import javax.mail.MessagingException;

class MyQuery {
synchronized void qQuery() throws Exception {
    String query = ".z.k"; // The query that is used to query q; this can be changed here.
    int version = 0;
    c qConn = null;
    qConn = new c(Main.host,Main.port); // Connect to the q database
      while (Main.healthy) {
          Object o = qConn.k(query); // Query q
          version = c.t(o);
          if(!(version==0)) {
              System.out.println(version);
              System.out.println("database healthy");
              NewThread.suspendFlag = false;
              notify(); 
              break; // End the process if the database responds
          }
          }

       System.out.println("reaches loop end");
  }
}

class MyThread implements Runnable {
  MyQuery myResource;

  MyThread(String name, MyQuery so) {
    myResource = so;
    new Thread(this, name).start();
  }

  public void run() {

    try {
      myResource.qQuery(); // Begin a method to query q.
    } catch (Exception e) {
      e.printStackTrace();
    }
  }
}

class NewThread implements Runnable {
       String name; // name of thread
       Thread t;
       static boolean suspendFlag;
    private int minutes;
       NewThread(int minutes) {
           this.minutes = minutes;
           System.out.println("reaches constructor");
          t = new Thread(this);
          suspendFlag = true;
          t.start(); // Start the thread
       }
       // This is the entry point for thread.
       public void run() {
          try {
             synchronized(this) {
                while(suspendFlag) {

                   System.out.println("reaches wait");
                   wait(minutes*60000);

                   System.out.println("reaches end");
                   if(suspendFlag) {
                       Main.setHealth(false);
                    Main.sendMessages(); // The database has not responded for the given time. Report that it is unhealthy.
                   }
                   break;
                }
              }
          } catch (InterruptedException e) {
             System.out.println(name + " interrupted.");
          } catch (MessagingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
       }
    }

public class Main {

private static String[] recipients;
private static String subject = "Database Failure";
private static String message = "The database has failed or is in a hung state";
private static String from;
static String host;
static int port;
private static String emails;
private static int minutes;
static boolean healthy = true;
public static void main(String args[]) throws Exception {

    // Import information from the configuration file
      SAXBuilder builder = new SAXBuilder();
      File xmlFile = new File("/export/home/rhadm/file.xml"); // Note: The directory for the configuration file may need to be changed

      try {

        Document document = (Document) builder.build(xmlFile);
        Element rootNode = document.getRootElement();
        List list = rootNode.getChildren("parameters");
           Element node = (Element) list.get(0);

          host = node.getChildText("host");
           port = Integer.parseInt(node.getChildText("port"));
           emails = node.getChildText("emails");
           String delims = "[ ]+";
           recipients = emails.split(delims); // parse email list
           minutes = Integer.parseInt(node.getChildText("time"));
           from = node.getChildText("from");

      } catch (IOException io) {
        System.out.println(io.getMessage());
      } catch (JDOMException jdomex) {
        System.out.println(jdomex.getMessage());
      }
    MyQuery unhealthy = new MyQuery();
    NewThread ob1 = new NewThread(minutes);
    new MyThread("MyThread", unhealthy);  // Create new Thread

  }
  public static void setHealth(boolean health){
      System.out.println("database unhealthy");
    healthy  = health;  
  }

  public static void sendMessages() throws MessagingException {
        System.out.println("sending emails");
      FCAPMailSender.postMail(recipients,subject,message,from);
  }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:07:05.627

您正在对不同的对象进行同步。通知只会影响对象同步等待相同的对象和实例。

等待线程同步并等待一段`NewThread`时间通知线程正在`MyQuery`实例上这样做

有一个共享对象。

```
private final Object LOCK = new Object();
synchronized(LOCK){
  LOCK.wait();
}
synchronized(LOCK){
  LOCK.notify();
} 
```

# android - NDK：使用共享库时出错

> ID：11268234
> 
> 赞同：0
> 
> 时间：2012-06-29T20:02:06.500
> 
> 标签：android, openssl, android-ndk

我正在尝试在我的 android 设备中使用 fips-openssl 库。到目前为止，我已经能够构建 fips 模块并在我的设备上运行它附带的测试套件。现在，我正在尝试将特定证书加载到我的代码的 JNI 部分。但是应用程序失败并出现此错误。

这就是失败的地方。

```
 cbio = BIO_new_mem_buf((void*)thawteCA, -1);
   PEM_read_bio_X509(cbio, &cacert, 0, NULL); 
```

我已经用 fips 对象文件 (fipscanister.o) 构建了我自己的共享库“libfips.so”，并将它加载到我的 java 类中。

```
 Fatal signal 11 (SIGSEGV) at 0xdeadbaad (code=1) 
```

我附上了我的 android-log 的相关部分。我对 NDK 开发相当陌生。任何关于此的指示都会对我有很大帮助。

```
F/libc    ( 5488): Fatal signal 11 (SIGSEGV) at 0xdeadbaad (code=1)
I/DEBUG   (   91): debuggerd: tmb file path:'/data/tombstones/tombstone_09'
I/DEBUG   (   91): *** *** *** *** *** *** *** *** *** *** *** 
I/DEBUG   (   91): Build fingerprint: 'alps/e1808_v75_jbl1/e1808_v75_jbl1:4.0.3/IML74K/1338672019:user/test-keys'
I/DEBUG   (   91): pid: 5488, tid: 5488  >>> com.work.data <<<
I/DEBUG   (   91): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr deadbaad
I/DEBUG   (   91):  r0 deadbaad  r1 00000001  r2 40000000  r3 00000000
I/DEBUG   (   91):  r4 00000000  r5 00000027  r6 00000004  r7 40049da4
I/DEBUG   (   91):  r8 be997678  r9 40049d9c  10 00000000  fp be99764c
I/DEBUG   (   91):  ip ffffffff  sp be9975f8  lr 40103589  pc 400ffc8c  cpsr 60000030
I/DEBUG   (   91):          #00  pc 00017c8c  /system/lib/libc.so
D/AEE/debuggerd(   91): stack_depth:1
I/DEBUG   (   91):          #01  lr 40103589  /system/lib/libc.so
I/DEBUG   (   91): 
I/DEBUG   (   91): code around pc:
I/DEBUG   (   91): 400ffc6c 4623b15c 2c006824 e026d1fb b12368db  \.#F$h.,..&..h#.
I/DEBUG   (   91): 400ffc7c 21014a17 6011447a 48124798 24002527  .J.!zD.`.G.H'%.$
I/DEBUG   (   91): 400ffc8c f7f47005 2106eca2 ed30f7f5 f04fa901  .p.....!..0...O.
I/DEBUG   (   91): 400ffc9c 460a5380 93032006 94029401 e8faf7f5  .S.F. ..........
I/DEBUG   (   91): 400ffcac 4622a905 f7f52002 f7f4e904 2106ec8e  .."F. .........!
 I/DEBUG   (   91): 
 I/DEBUG   (   91): code around lr:
 I/DEBUG   (   91): 40103568 41f0e92d 4c0c4680 447c2600 68a56824  -..A.F.L.&|D$h.h
 I/DEBUG   (   91): 40103578 e0076867 300cf9b5 dd022b00 47c04628  gh.....0.+..(F.G
 I/DEBUG   (   91): 40103588 35544306 37fff117 6824d5f4 d1ee2c00  .CT5...7..$h.,..
 I/DEBUG   (   91): 40103598 e8bd4630 bf0081f0 00027f9a 41f0e92d  0F..........-..A
 I/DEBUG   (   91): 401035a8 9004b086 f602fb01 460c461f 46154814  .........F.F.H.F
 I/DEBUG   (   91): 
 I/DEBUG   (   91): memory map around addr deadbaad:
 I/DEBUG   (   91): be977000-be998000 [stack]
 I/DEBUG   (   91): (no map for address)
 I/DEBUG   (   91): ffff0000-ffff1000 [vectors]
 I/DEBUG   (   91): 
 I/DEBUG   (   91): stack:
 I/DEBUG   (   91):     be9975b8  51226ecc  /data/data/com.work.data/lib/libfips.so
 I/DEBUG   (   91):     be9975bc  0151c478  [heap]
 I/DEBUG   (   91):     be9975c0  40049da4  
 I/DEBUG   (   91):     be9975c4  511b7570  /data/data/com.work.data/lib/libfips.so
 I/DEBUG   (   91):     be9975c8  4012b74c  /system/lib/libc.so
 I/DEBUG   (   91):     be9975cc  40130850  
 I/DEBUG   (   91):     be9975d0  00000000  
 I/DEBUG   (   91):     be9975d4  40103589  /system/lib/libc.so
 I/DEBUG   (   91):     be9975d8  00000000  
 I/DEBUG   (   91):     be9975dc  be99760c  [stack]
 I/DEBUG   (   91):     be9975e0  00000004  
 I/DEBUG   (   91):     be9975e4  40049da4  
 I/DEBUG   (   91):     be9975e8  be997678  [stack]
 I/DEBUG   (   91):     be9975ec  401026c9  /system/lib/libc.so
 I/DEBUG   (   91):     be9975f0  df0027ad  
 I/DEBUG   (   91):     be9975f4  00000000  
 I/DEBUG   (   91): #00 be9975f8  51246aec  /data/data/com.work.data/lib/libfips.so
 I/DEBUG   (   91):     be9975fc  0150c8c8  [heap]
 I/DEBUG   (   91):     be997600  51219f68  /data/data/com.work.data/lib/libfips.so
 I/DEBUG   (   91):     be997604  00000498  
 I/DEBUG   (   91):     be997608  00000004  
 I/DEBUG   (   91):     be99760c  fffffbdf  
 I/DEBUG   (   91):     be997610  012c5680  [heap]
 I/DEBUG   (   91):     be997614  4c1797c0  /dev/ashmem/dalvik-LinearAlloc (deleted)
 I/DEBUG   (   91):     be997618  012c5680  [heap]
 I/DEBUG   (   91):     be99761c  511ca4ec  /data/data/com.work.data/lib/libfips.so
 I/DEBUG   (   91):     be997620  4c1797c0  /dev/ashmem/dalvik-LinearAlloc (deleted)
 I/DEBUG   (   91):     be997624  51195e00  /data/data/com.work.data/lib/libfips.so
 I/DEBUG   (   91):     be997628  51238970  /data/data/com.work.data/lib/libfips.so
 I/DEBUG   (   91):     be99762c  0150c848  [heap]
 I/DEBUG   (   91):     be997630  293d175e  
 I/DEBUG   (   91):     be997634  4c1797c0  /dev/ashmem/dalvik-LinearAlloc (deleted)
 I/DEBUG   (   91):     be997638  51219888  /data/data/com.work.data/lib/libfips.so
 I/DEBUG   (   91):     be99763c  51219f68  /data/data/com.work.data/lib/libfips.so 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T13:20:40.217

我正在使用android源代码，在向各种框架文件添加了一些日志行之后，我在启动模拟器时遇到了同样的错误（这样想）。

谷歌搜索我找到了这个页面

[http://rootzwiki.com/topic/36129-guideicsjbcommon-definitive-faq-for-newest-miui-porting/](http://rootzwiki.com/topic/36129-guideicsjbcommon-definitive-faq-for-newest-miui-porting/)

这里说

`F/libc ( 83): Fatal signal 11 (SIGSEGV) at 0xdeadbaad (code=1)`

是因为 C 代码中的异常。

希望这个简短的信息对您有所帮助。

# iphone - UITextView Inside UIScrollView Scrolling Parent as Text is Entered

> ID：11268239
> 
> 赞同：3
> 
> 时间：2012-06-29T20:02:18.283
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我有一个`UIScrollView`包含一个`UITextView`. 当文本被输入时`UITextView`，`UIScrollView`将滚动以确保文本在内容框架中完全可见。我不想要这个。

我已禁用滚动`UIScrollView`，但这没有效果。有谁知道如何阻止这个？可以在此处找到示例项目：http: [//cl.ly/1P1u3y302r3q1f1C063K](http://cl.ly/1P1u3y302r3q1f1C063K)。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T21:34:06.520

我有类似的问题`UITextView`。似乎`scrollEnabled`属性不会取消自动滚动。我已经通过重写方法[解决了它。](https://github.com/onegray/UITableKit/blob/master/TableKit/DefaultTheme/TKDefaultTextViewCellView.m) 以下标志可能会有所帮助：`setContentOffset:`
`preventScrolling`

```
@interface MyScrollView : UIScrollView
@property (nonatomic, assign) BOOL preventScrolling;
@end

@implementation MyScrollView 
@synthesize preventScrolling;
-(void) setContentOffset:(CGPoint)contentOffset animated:(BOOL)animated
{
    if(!self.preventScrolling) {
        [super setContentOffset:contentOffset animated:animated];
    }
}
@end 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-29T20:11:24.970

您设置了错误的*contentSize:*滚动视图....

始终根据滚动视图内的内容设置内容大小，如果内容高度和宽度大于滚动视图高度和宽度，则仅增加内容大小，否则将其与滚动视图的宽度和高度相同

```
[self.mainScrollView setContentSize:CGSizeMake(4096, 4096)]; 
```

而不是它把这个*内容大小：*

```
[self.mainScrollView setContentSize:CGSizeMake(mainScrollView.frame.size.width, mainScrollView.frame.size.height)]; 
```

这可能会帮助你

# sql - 获取具有不同属性 ActiveRecord 的模型

> ID：11268248
> 
> 赞同：1
> 
> 时间：2012-06-29T20:03:14.127
> 
> 标签：sql, ruby-on-rails, ruby, activerecord

我的数据库中有一堆记录，它们都具有相同的标题但不同的位置。一旦我在位置边界内过滤，我想过滤掉具有相同标题的那些。有没有一种 ActiveRecord 方法可以做到这一点？我知道`select`，但这只会返回标题，我实际上需要整个记录。

所以我有一个有标题的业务。如果我选择给定纬度/经度边界内的所有企业，将返回多个具有相同名称的实例（例如，地铁）。我想将结果限制为 10。

In English：给我十条记录（整个记录，而不仅仅是某些列），其中每个标题在返回的十条中都是唯一的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:21:15.070

`ModelName.where(title: "Building")`

如果您提供更具体的问题，我将提供更具体的答案...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:17:39.047

你可以简单地使用`.first`，即

```
Venue.where(name: "Subway").first 
```

如果您需要多个元素，请将参数传递给 first：

```
Venue.where(name: "Subway").first(10) 
```

要在某个列中为每个不同的值选择一个条目，您可以使用`.group("column_name")`：

```
Venue.where(some_condition).group("name") 
```

# search - 在记事本++中搜索小写字母

> ID：11268250
> 
> 赞同：2
> 
> 时间：2012-06-29T20:03:19.517
> 
> 标签：search, notepad++

在记事本++中，是否有一个特殊的字符我可以在搜索中使用，只给我小写的字母？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:07:06.140

Notepad++ 支持搜索正则表达式。您可以在文件中搜索 [az]。这将找到任何单个小写字符。

您扩展正则表达式以使其更具体 - 例如某些 # 小写字符。

# jersey - 使用 Jersey 进行非安静通话

> ID：11268255
> 
> 赞同：0
> 
> 时间：2012-06-29T20:03:36.923
> 
> 标签：jersey

让 Jersey 处理所有请求而不仅仅是与休息相关的请求可以吗？包括基于会话。或者是否有任何性能、线程等方面的考虑？Jersey/Resteasy 提供了许多方便的功能，与普通的 servlet 相比使用起来会很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:21:25.563

是的，它适用于任何基于 HTTP 的通信。

# forms - 更改验证错误消息的颜色 - CakePHP

> ID：11268267
> 
> 赞同：0
> 
> 时间：2012-06-29T20:04:27.800
> 
> 标签：forms, validation, cakephp, colors

发生验证错误时是否可以更改错误消息的颜色？

我想将其设置为红色。我确实找到了一段 css 代码，但这最终使我表单中的所有文本都变成了红色。

```
form{
color: #ff0000;
}
label{
color: #000;
} 
```

任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:06:41.787

当然，使用`error-message`风格。

```
.error-message {
background-color:#a90329;
color:#fff;
} 
```

这是有效的，因为默认的错误模板如下：

```
<div class="error-message">message</div> 
```

这也可能会改变其他错误消息的样式。要更改分配给错误消息的类（以便您可以将其设置为单独的样式），请参阅[此问题](https://stackoverflow.com/questions/10362875/cakephp-validation-error-message)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:06:10.167

如果你在谈论 HTML5 的浏览器验证，那就是[`:invalid`伪选择器](https://developer.mozilla.org/en/CSS/%3ainvalid)。

# svn - SVN 通知中的电子邮件错误

> ID：11268269
> 
> 赞同：0
> 
> 时间：2012-06-29T20:04:28.607
> 
> 标签：svn, email

我们在cent os linux中安装了subversion，我们使用svn notify来提交邮件，我们的问题是thunderbird和outlook express等邮件客户端中提交邮件的o/p都很好。而如果我们在 Microsoft Outlook 2007 和 Outlook 2010 上查看相同的提交邮件，则提交邮件的格式不正确。任何想法来解决这个问题。请帮助我们..

就我们而言，这是 linux 中 SVN 的最佳邮件程序。如果还有其他更好的 linux 邮件程序，请告诉我

谢谢，j

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:32:50.430

如this [answer](https://stackoverflow.com/a/7924/1374267)中所述，您最好使用[提交后挂钩](http://svnbook.red-bean.com/en/1.4/svn.reposadmin.create.html#svn.reposadmin.create.hooks)以适合您需要的格式发送邮件。您将可以更好地控制诸如使用此类解决方案进行格式化之类的事情。

您可以在 SVN 文档中找到一个示例脚本 ( [commit-email.rb](http://svn.apache.org/repos/asf/subversion/trunk/tools/hook-scripts/commit-email.rb) )，该脚本在每次提交后发送一封电子邮件：。

# android - 如何使用 attr 属性指定可绘制源？

> ID：11268272
> 
> 赞同：2
> 
> 时间：2012-06-29T20:04:37.793
> 
> 标签：android, xml, drawable, attr

我正在为可绘制对象编写 xml。我的问题是：有没有办法让 src 属性引用 attr.xml 文件中定义的属性？我试过了：

```
android:src="?image" 
```

和

```
android:src="?attr/image" 
```

它们似乎都不起作用。这是我的 attr.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <attr name="image" format="reference"></attr>
</resources> 
```

以及我在哪里定义与主题相关的值：

```
<resources>
    <style name="HOLO" parent="@android:style/Theme.Black">
        <item name="android:textColor">#00FFFF</item>
        <item name="image">@drawable/holo_vcard_settings_icon</item>

        </style>
    <style name="HOLO_LIGHT" parent="@android:style/Theme.Light">
        <item name="android:textColor">#FF00FF</item>
        <item name="image">@drawable/holo_light_vcard_settings_icon</item>
        </style>
</resources> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:53:24.823

几点建议：

1.  尝试清理您的项目。我经历过几次在 Eclipse 构建中未更新 XML 更改的情况。
2.  您确定您的应用程序或活动正在使用 HOLO 或 HOLO_LIGHT 主题吗？检查您的活动中是否设置了“android:theme”键。
3.  尝试使用 'android:background' 属性而不是 'android:src'，这意味着不要使用 ImageView 而只使用 View 或 LinearLayout 的背景。

顺便说一句，引用您的属性的正确语法是：

```
<... android:src="?attr/image" .../> 
```

第四种选择：如果一切都失败了，您可以尝试使用该属性作为样式。（只是预感，它可能不起作用）例如：

```
<resources>
    <attr name="imageStyle" format="reference"></attr>
</resources> 
```

然后在你的styles.xml

```
 <style name="LightImageStyle">
    <item name="android:src">@drawable/light_png</item>
 </style>
 <style name="DarkImageStyle">
    <item name="android:src">@drawable/dark_png</item>
 </style> 
```

然后在你的themes.xml

```
 <style name="HOLO" ...>
     <item name="imageStyle">@style/DarkImageStyle</item>
 </style>
 <style name="HOLO_LIGHT" ....>
     <item name="imageStyle">@style/LightImageStyle</item>
 </style> 
```

最后在你的布局中：

```
 <ImageView style="?attr/imageStyle" ... /> 
```

# asp.net-mvc - Windows Azure，OpenID 后退按钮错误

> ID：11268273
> 
> 赞同：1
> 
> 时间：2012-06-29T20:04:46.343
> 
> 标签：asp.net-mvc, azure, openid

我正在开发一个使用 OpenID 进行身份验证的网站。链接后，用户只需单击“登录”按钮即可进入该站点。但是，在被允许进入站点后，如果用户单击返回按钮，则会出现以下错误：

> 处理您的请求时发生错误。
> 
> HTTP 错误代码：403 消息：ACS30000：处理 OpenID 登录响应时出错。内部消息：ACS30001：无法验证 OpenID 响应签名。内部消息：ACS50006：签名验证失败。跟踪 ID：13092d63-ea7a-4ed2-9321-5e9054321322 时间戳：2012-06-29 19:48:06Z

请帮我找出原因，也许是解决它的方法。

谢谢您的帮助，

亚伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T10:33:09.077

我不确定这是否会一直发生。但我想到的一种解决方法是使用 JavaScript 的 window.history 删除重定向页面上的最后一个浏览器历史记录条目。这也有助于“隐藏”身份验证详细信息。

此致，

明旭。

# php - 如何在 php 中使用 Amf ByteArray 字符串？

> ID：11268274
> 
> 赞同：2
> 
> 时间：2012-06-29T20:04:56.237
> 
> 标签：php, actionscript-3, amf, amfphp

我有一个我*认为*是 ByteArray 的东西。`urlencode`在字符串上使用时，我得到了这个数据......

```
%0A%82%03%01%11SaleDate%0DToYear%0DYardId%15BuyNowOnly%0BState%0BModel%0FStockId%11FromYear%11FullText%13Inventory%11Category%09Make%0FOrderBy%1DOrderDirection%0FPageNum%11PageSize%01%01%06%05-1%02%06%01%01%01%01%06%0F1024187%06%09Sale%01%01%06%13RunNumber%06%07Asc%04%01%04d 
```

我正在查看 php 函数解包，并尝试`unpack('c4char/Xstr/...')`X 是 a、A、h、H 以尝试将“SaleDate”字符串拉出，但我无法让它工作。

可能是完全错误的方法。我需要编写某种自定义解包器吗？

我什至不确定我在这里处理的是什么，它是闪存文件的输出，所以我认为它是一个 Amf“ByteArray”，但我不知道如何解析它。

甚至只是寻找一个方向来开始寻找如何操作/解析/重建这样的东西。最终，我希望能够通过一个函数运行它，获取一个关联数组，更改一些值，重新打包它，然后以快乐的方式发送它。

我认为它是[AMF3](http://en.wikipedia.org/wiki/Action_Message_Format)，这是消息部分中的数据。

我想如果有一个“主要”问题，我该如何简单安全地操作那串数据？

感谢任何线索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:48:26.687

有很多 AMF 反序列化器是开源的，为了简单起见，即使 AMF3 相当简单，不在这里推出自己的反序列化器可能也很有意义。

我在 github 上看到了这个看起来很有希望的链接：

[https://github.com/silexlabs/amfphp-2.0](https://github.com/silexlabs/amfphp-2.0)

您可能不想滚动整个框架，但可能会滚动这个：

[/core/amf/Deserializer.php](https://github.com/silexlabs/amfphp-2.0/blob/master/Amfphp/Core/Amf/Deserializer.php)

[/core/amf/Serializer.php](https://github.com/silexlabs/amfphp-2.0/blob/master/Amfphp/Core/Amf/Serializer.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T22:28:30.300

据我所知，这似乎是供应商特有的专有编码方法。他们使用“字节数组”来允许有效负载的更大灵活性。没有一种简单的方法可以解决这个问题，除非完全逆向工程他们的编码和解码算法。

# asp.net-mvc-3 - 从控制台应用程序中的 Asp.Net Web 应用程序获取完整的域 URL

> ID：11268277
> 
> 赞同：0
> 
> 时间：2012-06-29T20:05:03.957
> 
> 标签：asp.net-mvc-3, hyperlink, asp.net-mvc-routing, console-application, html-email

我目前正在做一个必须发送预定电子邮件的控制台应用程序。在其中一封电子邮件中，我必须输入页面的 url，如下所示：

```
var message = string.Format("Go to our web site
<a href=\"" + "http://" + Request.Url.Authority + Url.Action("action", "Controller", new { requestID = request.ID }) + "\">Click Here</a>"); 
```

显然 Request.Url.Authority 只能在我拥有的 ASP.Net MVC3 应用程序中工作。但我不确定是否有办法在控制台应用程序中获取完整的路线名称。也许如果我在控制台应用程序中引用网络应用程序......但我不知道还能做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:28:33.490

控制台应用程序不会在网站的上下文中运行，因此您将无法访问与网站相关的任何内容。

您可以在 app.config 文件中提前进行配置。

```
<appSettings>
  <add key="Url" value="http://www.yoursite.com/" />
</appSettings> 
```

在代码中你可以这样做来获得这个值：

```
ConfigurationManager.AppSettings["Url"] 
```

# php - 将多行保存到数据库

> ID：11268280
> 
> 赞同：1
> 
> 时间：2012-06-29T20:05:20.510
> 
> 标签：php, html

我有一个行数未知的表。我正在尝试将编辑保存到复选框字段、选择字段和文本字段。

以下是表格行的示例（概括）：

```
<tr onMouseover="this.bgColor='#EEEEEE'"onMouseout="this.bgColor='#FFFFFF'">
    <input type="hidden" name="batchupdate[][item1]" value="118">
    <td><a target="blank" href="www.link.com">Link</a></td>
    <td>Name</td>
    <td><input value="" type="text" name="batchupdate[][item2]" size=35></td>
    <td>
        <select name="batchupdate[][item3]">
        <optgroup label="Group 1">
            <option >1</option>
            <option >2</option>
            <option >3</option>
            <option >4</option>
            <option >5</option>
        </optgroup>
        <optgroup label="Group 2">
            <option >6</option>
            <option >7</option>
            <option >8</option>
            <option >9</option>
        </optgroup>
        </select>                           
    </td>
    <td><input type="checkbox" value="FALSE" name="batchupdate[][item4]"></td>
</tr> 
```

“id”（item1）是我的 postgresql 数据库中的自动递增字段。

这是php：

```
if(isset($_POST['savebutton'])) {
    if(isset($_POST['bachtupdate']) || is_array($_POST['batchupdate']))
    {
        foreach($_POST['batchupdate'] as $i)
        {   
            $item1 = $i['item1'];
            $item2 = $i['item2'];
            $item2 = pg_escape_string($item2);
            $item3 = $i['item3'];

            if(isset($i['item4'])){
                $item4 = "TRUE";
            } else {
                $item4 = "FALSE";
            }

        $query = "UPDATE schema.table SET field2='$item2', field3='$item3', field4='$item4' WHERE id='$item1'";

        $result = pg_query($database, $query);

        if ($result) {
            // success
        } else {
            die("Error: " .pg_last_error());
        } 
```

在这之后还有一些其他的逻辑，但是查询部分是它失败的地方。我收到一个错误，基本上 item3 和 id (item1) 是空的，所以它找不到要更新的行。Items2 和 4 工作正常，我可以在 postgres 提供的错误消息中看到它们包含的内容。

我在网上找到了这个解决方案，并将其改编为我自己的使用。我只是对为什么某些领域有效而其他领域无效感到困惑。想法？

编辑：

这就是带有回声的输出（在 foreach 循环内）。我注释掉了 postgres 查询。请注意，它执行了两次。我还注意到复选框没有返回 true。然而，所有的信息都在那里......，

118（id），文本框 1，选项 2，FALSE（复选框）

119 (id)，文本框 2，选项 3

118（id），文本框 1，选项 2，FALSE（复选框）

119 (id)，文本框 2，选项 3

编辑：

接下来，我将尝试以下方法之一：

1.  使用 php 创建唯一的名称属性（`item11`、`item12`、`item13`等），并增加一个`for`循环来计算表中有多少行，更改变量并执行查询。这似乎太乱了，但我想不出别的……，

2.  如我发现的其他示例中所示`foreach`，不要执行循环，而是执行循环。`for`不确定它会改变什么，但我想值得一试。

我会报告我发现的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T00:08:42.547

您显示的 HTML 的通用性如何？

我的意思是，当你写

```
 <input type="hidden" name="batchupdate[][item1]" value="118"> 
```

您确实在 batchupdate 的第一个键中放置了一些东西，不是吗？

因为否则 POST 会发送出去，比如说，

```
batchupdate[][item1]=118&batchupdate[][item3]=124... 
```

这将在 batchupdate[] 中创建两个不同的行，一个带有 item1，另一个只有 item3，因为 [] 是自动增量语法。

每个“组”行应该有一个不同的 ID 作为第一个索引：

```
 <input type="hidden" name="batchupdate[row1][item1]" value="118">
 <input type="hidden" name="batchupdate[row1][item2]" value="119">
 <input type="hidden" name="batchupdate[row1][item3]" value="120">
 ...
 <input type="hidden" name="batchupdate[row2][item1]" value="123"> 
```

这将导致一个 batchupdate 条目，其中 item1、2 和 3 定义并等于 118、119 和 120，这似乎是您要查找的内容。

# c++ - DirectX 渲染到纹理

> ID：11268284
> 
> 赞同：6
> 
> 时间：2012-06-29T20:05:49.057
> 
> 标签：c++, directx, textures

我正在尝试将我的场景渲染为纹理，以便在着色器中使用它来获得一些后期处理效果。我对这种东西不是很有经验，所以我在这里有一些问题.. 首先：

我的 OnCreateDevice() 方法中有这段代码：

```
 D3D11_TEXTURE2D_DESC textureDesc;
    D3D11_RENDER_TARGET_VIEW_DESC renderTargetViewDesc;
    D3D11_SHADER_RESOURCE_VIEW_DESC shaderResourceViewDesc;

    ZeroMemory(&textureDesc, sizeof(textureDesc));

    textureDesc.Width = 800/2;
    textureDesc.Height = 600/2;
    textureDesc.MipLevels = 1;
    textureDesc.ArraySize = 1;
    textureDesc.Format = DXGI_FORMAT_R32G32B32A32_FLOAT;
    textureDesc.SampleDesc.Count = 1;
    textureDesc.Usage = D3D11_USAGE_DEFAULT;
    textureDesc.BindFlags = D3D11_BIND_RENDER_TARGET | D3D11_BIND_SHADER_RESOURCE;
    textureDesc.CPUAccessFlags = 0;
    textureDesc.MiscFlags = 0;

    pd3dDevice->CreateTexture2D(&textureDesc, NULL, &renderTargetTextureMap);

    renderTargetViewDesc.Format = textureDesc.Format;
    renderTargetViewDesc.ViewDimension = D3D11_RTV_DIMENSION_TEXTURE2D;
    renderTargetViewDesc.Texture2D.MipSlice = 0;

    pd3dDevice->CreateRenderTargetView(renderTargetTextureMap, &renderTargetViewDesc, &renderTargetViewMap);

    shaderResourceViewDesc.Format = textureDesc.Format;
    shaderResourceViewDesc.ViewDimension = D3D11_SRV_DIMENSION_TEXTURE2D;
    shaderResourceViewDesc.Texture2D.MostDetailedMip = 0;
    shaderResourceViewDesc.Texture2D.MipLevels = 1;

    pd3dDevice->CreateShaderResourceView(renderTargetTextureMap, &shaderResourceViewDesc, &shaderResourceViewMap); 
```

我正在创建一个纹理、一个渲染视图和一个资源视图。但我从这里去哪里？我是否必须定义另一个缓冲区或者这是否有效？

具体来说，

所以我想我知道我必须设置 OMRenderTargets：renderTargetViewMap 和 depthStencilView。但是我必须在哪里设置呢？在每一帧渲染调用中？在我渲染场景中的其他对象之前还是之后？我的猜测是我必须制作一个新的着色器，我将创建这个纹理来使用它。

感谢您的任何见解：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:10:05.717

每次要渲染到纹理时都必须设置它，是的（只要您没有切换到另一个渲染目标或后台缓冲区）。将数据渲染到纹理后，设置处理此数据的着色器并使用此纹理绘制一个屏幕对齐的四边形。

# c - C 将 char 转换为 char*

> ID：11268289
> 
> 赞同：13
> 
> 时间：2012-06-29T20:06:36.293
> 
> 标签：c, char, type-conversion

我有一个`char`来自 的`fgets`，我想知道如何将它转换为`char*`.

我确信这已经发布过，但我找不到一个正在做我想做的事。任何答案表示赞赏。

编辑：这是代码。

```
char *filename = "file.txt";
FILE *file = fopen(filename, "r");
if(file != NULL) {
  char line[260];
  char *fl;
  while(fgets(line, sizeof line, file) != NULL) {
    // here I combine some strings with the 'line' variable.
    str_replace(line, "\"", "\"\""); // A custom function, but it only takes char*'s.
  }
  printf(fl);
  printf("\n");
} else {
  printf(" -- *ERROR* Couldn't open file.\n");
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-29T20:11:02.033

嗯，首先，`line`是`char`s 的数组，因此可以以与 a 大致相同的方式进行操作`char *`（有关重要​​差异，请参阅[comp.lang.c 常见问题解答](http://www.c-faq.com/aryptr/index.html)），因此您无需担心。

但是，如果您想回答一般问题...

`&`运算符是您所需要的：

```
char c;
char *pChar = &c; 
```

但是，请记住 pChar 是指向 char 的指针，并且仅当 c 在范围内时才有效。这意味着您不能从函数返回 pChar 并期望它工作；它将指向堆的某些部分，你不能指望它保持有效。

如果要将其作为返回值传递，则需要 malloc 一些内存，然后使用指针写入 c 的值：

```
char c;
char *pChar = malloc(sizeof(char));

/* check pChar is not null */

*pChar = c; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-29T20:18:03.803

正如 Dancrumb 所提到的，使用`&`运算符会给你一个指向角色的指针，但是正如他所提到的，还有一个范围问题阻止你返回指针。

我必须补充的一件事是，我想你想要 a 的原因`char*`是你可以将它用作字符串`printf`或类似的东西。您不能以这种方式使用它，因为字符串不会被`NULL`终止。要将 a`char`转换为字符串，您需要执行类似的操作

```
char c = 'a';
char *ptr = malloc(2*sizeof(char));
ptr[0] = c;
ptr[1] = '\0'; 
```

以后别忘了释放`ptr`！

# c# - 执行 System.Diagnostics.Process cmd.exe 仅打开命令提示符，不执行参数

> ID：11268290
> 
> 赞同：2
> 
> 时间：2012-06-29T20:06:36.893
> 
> 标签：c#, command-line, process, command-line-arguments, system.diagnostics

我哪里错了？这就像参数甚至没有被执行，它只是打开命令提示符，就是这样。“结果”（StandardOutput）正是您打开新命令提示符时显示的内容......说Microsoft Windows [Version 6.1.7600] 版权所有......然后是命令提示符开始的路径。

无论如何，这是我拥有的代码：

```
 private static void ExecuteProcess(string processFile, string processArguments)
    {
        ProcessStartInfo psi = new ProcessStartInfo(processFile, processArguments);
        psi.RedirectStandardOutput = true;
        psi.RedirectStandardError = true;
        psi.UseShellExecute = false;
        //psi.CreateNoWindow = true;

        Process p = new Process();
        p.StartInfo = psi;

        try
        {
            Cursor.Current = Cursors.WaitCursor;

            p.Start();

            string output = p.StandardOutput.ReadToEnd();

            p.WaitForExit();

            Cursor.Current = Cursors.Default;

            if (p.ExitCode == 0)
                MessageBox.Show(output, "Results");
            else
                throw new Exception(p.StandardError.ReadToEnd());
        }
        catch (Exception ex)
        {
            Cursor.Current = Cursors.Default;
            MessageBox.Show(ex.ToString(), "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
        finally
        {
            p.Dispose();
        }
    } 
```

processFile 等于“cmd.exe” processArguments 等于：

```
csvde -s {servername} -f {filename} -d OU=MyOU,DC=dmz,DC=lan -r "(objectClass=organizationalUnit)" -n 
```

关于为什么“参数”没有被执行的任何帮助都会很棒！

编辑：

到目前为止我发现的一件事，克里斯关于权限的建议是正确的，我需要设置：

```
psi.Verb = "runas"; 
```

但是在执行该进程时，它看起来并没有与该进程关联的用户名，所以我也添加了这一行：

```
psi.UserName = Environment.UserName; 
```

现在我得到“存根收到错误数据”......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:10:34.097

从[文档](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/cmd.mspx?mfr=true)：

> **命令**
> 
> 启动命令解释器 Cmd.exe 的新实例。不带参数使用，cmd显示Windows XP版本和版权信息。
> 
> 语法 cmd [[{/c|/k}] [/s] [/q] [/d] [{/a|/u}] [/t:fg] [/e:{on|off}] [ /f:{on|off}] [/v:{on|off}] 字符串] 页首
> 
> **参数**
> 
> /c ：执行字符串指定的命令，然后停止。

所以你需要：

1.  将完整路径传递给 EXE 或
2.  [将工作目录设置为](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.workingdirectory.aspx)包含exe的目录

然后

1.  制作`processFile`== "[]csvde.exe"，并将其从 中删除`processArguments`，或
2.  将“/c \””添加到`processArguments`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T15:15:00.513

我终于重新开始工作，并想出了如何让它发挥作用。

我必须专门设置 Process.ProcessStartInfo 的用户名、密码和域才能执行该进程。

# matlab - 有没有办法在 MatLab 中返回许多具有线性索引的列？

> ID：11268293
> 
> 赞同：1
> 
> 时间：2012-06-29T20:07:05.127
> 
> 标签：matlab, matrix

假设一个 3-D 矩阵：

```
>> a = rand(3,4,2)

a(:,:,1) =

    0.1067    0.7749    0.0844    0.8001
    0.9619    0.8173    0.3998    0.4314
    0.0046    0.8687    0.2599    0.9106

a(:,:,2) =

    0.1818    0.1361    0.5499    0.6221
    0.2638    0.8693    0.1450    0.3510
    0.1455    0.5797    0.8530    0.5132 
```

我使用线性索引一次有很多元素：

```
>> index1 = [1 ; 2 ; 1 ; 3];
>> index2 = [1 ; 4 ; 2 ; 3];
>> index3 = [1 ; 1 ; 2 ; 1];

>> indices = sub2ind(size(a), index1, index2, index3)

>> a(indices)

ans =

    0.1067
    0.4314
    0.1361
    0.2599 
```

我想做同样的事情，把第一个维度的所有值都返回。此维度的大小可能会有所不同。在这种情况下，回报应该是：

```
>> indices = sub2ind(size(a), ??????, index2, index3);

>> a(indices)

ans =

    0.1067    0.9619    0.0046    % a(:,1,1)
    0.8001    0.4314    0.9106    % a(:,4,1)
    0.1361    0.8693    0.5797    % a(:,2,2)
    0.0844    0.3998    0.2599    % a(:,3,1) 
```

有什么方法可以在 MatLab 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:51:52.823

```
ind1 = repmat((1:size(a,1)),length(index2),1);
ind2 = repmat(index2,1,size(a,1));
ind3 = repmat(index3,1,size(a,1));

indices = sub2ind(size(a),ind1,ind2,ind3)

indices =

 1     2     3
10    11    12
16    17    18
 7     8     9

a(indices)

ans =

    0.1067    0.9619    0.0046
    0.8001    0.4314    0.9106
    0.1361    0.8693    0.5797
    0.0844    0.3998    0.2599 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:09:01.273

您可以通过对与前两个维度分开的最后两个维度进行线性索引来获得所需的结果。即使在您希望引用的 3d 数据块中，`a(:,:,:)`您也可以通过`a(:)`（如您所知）*或* `a(:,:)`. 以下代码查找最后两个维度的 sub2ind，然后使用 重复它们`meshgrid`。这最终与@tmpearce 提出的解决方案非常相似，但明确显示了半线性索引并使用`meshgrid`而不是`repmat`：

```
dim1 = 3;
dim2 = 4;
dim3 = 2;

rand('seed', 1982);
a = round(rand(dim1,dim2,dim3)*10)

% index1 = :
index2 = [1 ; 4 ; 2 ; 3];
index3 = [1 ; 1 ; 2 ; 1];

indices = sub2ind([dim2 dim3], index2, index3)
a(:, indices) % this is a valid answer

[X,Y] = meshgrid(1:dim1, indices)
indices2 = sub2ind([dim1, dim2*dim3], X,Y);

a(indices2) % this is also a valid answer, with full linear indexing 
```

# jquery-mobile - 如何使用 jquery mobile 制作可折叠的复选框？

> ID：11268297
> 
> 赞同：1
> 
> 时间：2012-06-29T20:07:11.867
> 
> 标签：jquery-mobile, checkbox, collapsable

我想对某些复选框进行分组并使它们可折叠以及全选/取消全选。

**HTML**

```
<div style="padding-left: 5px; padding-right: 5px">
 <fieldset data-role="controlgroup"> 
  <input autocomplete="off" type="checkbox" name="layers" id="land" class="layers" checked="checked"/>
  <label for="land">Land Parcels</label> 
  <input autocomplete="off" type="checkbox" name="layers" id="road" class="layers" checked="checked"/>
  <label for="road">Roads</label> 
  <input autocomplete="off" type="checkbox" name="layers" id="rail"  class="layers" checked="checked"/>
  <label for="rail">Railroads</label> 
input autocomplete="off" type="checkbox" name="layers" id="lake"  class="layers" checked="checked"/>
  <label for="lake">Lakes</label>
  <input autocomplete="off" type="checkbox" name="layers" id="points" class="layers"/>
  <label for="points">AMIS Points</label>
  <input autocomplete="off" type="checkbox" name="education" id="education" class="layers"/>
  <label for="education">Education</label>
    <input autocomplete="off" type="checkbox" data-mini="true" name="education" id="childcare" class="layers"/>
    <label for="childcare">Child Care</label>
    <input autocomplete="off" type="checkbox" data-mini="true" name="education" id="highschool" class="layers"/>
    <label for="highschool">High School</label>
    <input autocomplete="off" type="checkbox" name="layers" id="stormpipes" class="layers"/>
  <label for="stormpipes">Storm Pipes</label>
 </fieldset>
</div> 
```

**jQuery**

```
$(document).ready(function () {
    fixContentHeight();
    $('.layers').click(changeLayers);
});

function changeLayers () {
    var checked = [];
    $('.layers').each(function () {
        if ($(this).attr('checked')) {
            checked.push($(this).attr('value'));
        }
    });
    mainLayer.params.LAYERS = checked.join(",");
    mainLayer.redraw();
}

$('#education').click(function() {
    $("INPUT[type='checkbox']").attr('checked', $('#education').is(':checked'));
}); 
```

试图在教育复选框中使儿童保育和高中可折叠。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T06:41:42.633

您可以使用带有 的无序列表`data-role="listview"`，添加`data-role="collapsible"`到`li`元素中，并在内部列表的每个复选框中嵌套另一个无序列表`li`

```
<ul data-role="listview">
    <li data-role="collapsible">
        <h3>Title of collapsible row</h3>
        <ul data-role="listview">
            <li>
                <input autocomplete="off" type="checkbox" name="layers" id="land" class="layers" checked="checked"/>
                <label for="land">Land Parcels</label> 
            </li>
            <li>
                <input autocomplete="off" type="checkbox" name="layers" id="road" class="layers" checked="checked"/>
                <label for="road">Roads</label> 
            </li>
        </ul>
    </li>
</ul> 
```

边距和填充看起来有点奇怪，但你可以调整 css 来修复它

# jquery - jquery滚动div - 页面完全加载后计算文档高度？

> ID：11268299
> 
> 赞同：1
> 
> 时间：2012-06-29T20:07:16.297
> 
> 标签：jquery, html, scroll

当访问者向下滚动网站时，我有一个向下滚动的侧边栏 div。问题是，它不会一直向下滚动，我知道为什么会这样。

我假设脚本在加载代码后立即计算文档的高度，但是网站上有不同大小的图像在计算完成后尚未加载，包括也将主图像更改为不同的缩略图单击后的大小。

如果我设置每个图像的高度，那么它会一直正确向下滚动，但我不可能知道然后在实时网站上动态生成的图像大小。

加载所有图像后，脚本有什么方法可以计算文档高度吗？或者其他可以工作的东西？

这是代码：

```
var documentHeight = 0;
var topPadding = 15;
$(function() {
    var offset = $("#sidebar").offset();
    documentHeight = $("#maincontainer").height();
    $(window).scroll(function() {
        var sideBarHeight = $("#sidebar").height();
        if ($(window).scrollTop() > offset.top) {
            var newPosition = ($(window).scrollTop() - offset.top) + topPadding;
            var maxPosition = documentHeight - (sideBarHeight + 0);
            if (newPosition > maxPosition) {
                newPosition = maxPosition;
            }
            $("#sidebar").stop().animate({
                marginTop: newPosition
            });
        } else {
            $("#sidebar").stop().animate({
                marginTop: 0
            });
        };
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T14:46:08.603

`$('body').height()`不起作用，因为`body`高度取决于视口大小。

此外， document.ready 不等待加载图像。这意味着，如果您的页面上有没有高度属性的图像，则最终加载的 DOM 会更高。

自己尝试一下：http: [//jsfiddle.net/vww42sqm/](http://jsfiddle.net/vww42sqm/)（请注意。）

或者拿这个：

```
$(document).ready(function() {
    var documentHeight = $(document).height()
    console.log('document height (document.ready): ' + documentHeight);
});

$(window).load(function() {
    var documentHeight = $(document).height()
    console.log('document height (window.load): ' + documentHeight);
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-29T20:21:23.603

将

> $('body').height()

工作 ？我在我的网页上使用了相同类型的脚本，这就是我用来确定我的网页的高度的方法。

如果这不是您想要的或者它没有按照您想要的方式工作，我会为您提供更多代码。

编辑 ：

```
$(document).ready(function () {
    var documentHeight = $('body').height()
}); 
```

然后稍后你调用你的 documentHeight 而不是你的 window.scrollTop。

# javascript - PowerShell - 等待 Firefox 启动，运行 imacro 并等待它完成，关闭 Firefox

> ID：11268301
> 
> 赞同：0
> 
> 时间：2012-06-29T20:07:24.707
> 
> 标签：javascript, firefox, powershell, imacros

我试过这样简单：

```
'Start-Process "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" -Wait' 
Start-Sleep -s 20
Start-Process "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" imacros://run/?m=MyJS.js -Wait' 
```

但它并没有在继续之前完成脚本。

`-PassThru`以及使用,和一个组合键来启动 jscript 的各种尝试`-Wait`，例如：`-Start` `-Sleep`

```
'start-process "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" -PassThru; Start-Sleep -s 20;[void] [System.Reflection.Assembly]::LoadWithPartialName("'Microsoft.VisualBasic");[Microsoft.VisualBasic.Interaction]::AppActivate("Login - Mozilla Firefox");[void] [System.Reflection.Assembly]::LoadWithPartialName("'System.Windows.Forms");[System.Windows.Forms.SendKeys]::SendWait("%5")' 
```

最终，我要做的是启动 Firefox，运行一个 imacros jscript，等待它完成，然后关闭 Firefox。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T12:27:42.447

我不确定你为什么要先启动 firefox，然后使用指定的 imacro 再次运行它。所以我在我的解决方案中跳过了它。我会做这样的事情：

```
$cmdLine = "C:\Program Files (x86)\Mozilla Firefox\firefox.exe"
$args = "imacros://run/?m=MyJS.js"
start-process $cmdLine $args
Start-Sleep -Seconds 30
Get-Process | ? {$_.Name -like "firefox"} | %{$_.Close()} 
```

# php - PHP postgres Zend 框架选择带有 WHERE 'AND' 子句的查询

> ID：11268303
> 
> 赞同：0
> 
> 时间：2012-06-29T20:07:50.697
> 
> 标签：php, zend-framework

好的，我对 Zend 来说还是新手，并且试图找出 ORM 的一般工作原理似乎是一项艰巨的任务（任何人都知道他们在哪里有专门的文档）。除了我想要做的是获取现有查询并向其添加“AND”子句。只是不知道该怎么做，就像我在其他地方找到的例子一样，看起来不像这个，我宁愿避免破坏

```
$select = $this->select()
            ->from('offer_term')
            ->setIntegrityCheck(false)
            ->joinUsing('term_mapping', 'term_id')
            ->where('promo_id = ?', $promo_id);
        return $this->fetchAll($select); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:16:42.353

尝试：

```
$select = $this->select()
    ->from('offer_term')
    ->setIntegrityCheck(false)
    ->joinUsing('term_mapping', 'term_id')
    ->where('promo_id = ?', $promo_id);
    ->where('name = ?', $name); // WHERE promo_id = $promo_id AND name = $name
return $this->fetchAll($select); 
```

并记得使用[手册](http://framework.zend.com/manual/en/zend.db.select.html#zend.db.select.building.where)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T07:42:12.983

实际上，一旦您开始了解 Zend_db 的工作原理，这真的很容易。

您的查询：

```
$select = $this->select()
            ->from('offer_term')
            ->setIntegrityCheck(false)
            ->joinUsing('term_mapping', 'term_id')
            ->where('promo_id = ?', $promo_id);
        return $this->fetchAll($select); 
```

您已经在使用该`select()`对象来执行查询，因此请尝试重构为这样的内容（我还将介绍如何使用条件进行操作）：

```
$select = $this->select()->setIntegrityCheck(false);
$select->from('offer_term');//if query is inside of a DbTable model the from() can be omitted
$select->joinUsing('term_mapping', 'term_id');
$select->where('promo_id = ?', $promo_id);//Every time you add a where(), select() adds the param using the AND operator
$select->where('something_new = ?', $new_param);//if you need to add a param using OR you can use the orWhere() method.
if (TRUE) {
    $select->orWhere('something = ?',$parameter);//This will add an OR WHERE to the query if the condition is true.
}
return $this->fetchAll($select); 
```

在查询中添加*AND*`select()`只需将另一个添加`where()`到链中即可。这可以通过链接您的原始查询或通过使用单独的语句来完成，就像我所做的那样。如果您需要在查询中使用*OR*`select()`运算符，您可以使用该`orWhere()`方法。

您可以根据需要混合使用链接和单独的语句，这使得添加条件非常容易。

**注意：** Zend_Db 不是 ORM，它是表网关和表行模式的实现（我希望我的名字是正确的）。所以请不要期望完整的 ORM 功能。

希望这可以帮助。

# objective-c - iOS：发送自定义的 uint8 数组

> ID：11268304
> 
> 赞同：1
> 
> 时间：2012-06-29T20:07:52.830
> 
> 标签：objective-c, ios, cocoa-touch

我正在尝试制作一个应用程序，使用底座到 RS232 线（我从 RedPark 购买）将 iPhone 与另一个硬件通信。我也在使用 redpark 提供的库。一开始我做了一个简单的代码，它工作得很好。UInt8 infoCmd[5] = {0x3E,0x3E,0x05,0x80,0xff}；[rscMgr 写入：infoCmd 长度：5]；
然后我想向它添加更多命令，所以我创建了一个方法来返回我需要的不同命令组合。

```
- (UInt8 *)requestCommand:(int)commandName{
    UInt8 * command;
    if (commandName == DATADUMP) {
        command=[Communication buildDataDump];
    }
    if (commandName == GETSERIALINFO) {
        command=[Communication buildGetSerailInfo];   
    }
    return command;
}
+ (UInt8 *)buildGetSerailInfo{
    UInt8 *command = malloc(sizeof(UInt8)*5);
    command[0]=SYN;
    command[1]=SYN;
    command[2]=ENQ;
    command[3]=GETSERIALINFO;
    //command[4] = {SYN, SYN, ENQ, GETSERIALINFO};
    return command;    
} 
```

问题是，我的一些命令包含 200 字节长的数据。如何创建一个更容易添加字节的 UInt8 数组？我是编程新手，请详细解释一下。非常感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:55:14.557

实际上，您只会通过线路发送数据，行字节。我在一个项目中做了类似的事情（不是有线，而是通过 TCP/IP 的 RS232 命令），如果您使用 NSMutableData 实例，它变得非常简单。

我的代码片段：

```
static u_int8_t codeTable[] =   { 0x1b, 0x74, 0x10 };
static u_int8_t charSet[]   =   { 0x1b, 0x52, 0x10 };
static u_int8_t formatOff[] =   { 0x1b, 0x21, 0x00 };
static u_int8_t reverseOn[] =   { 0x1d, 0x42, 0x01 };
static u_int8_t reverseOff[]=   { 0x1d, 0x42, 0x00 };
static u_int8_t paperCut[]  =   { 0x1d, 0x56, 0x0 };  

NSMutableData *mdata = [NSMutableData dataWithBytes:&formatOff length:sizeof(formatOff)];
[mdata appendBytes:&formatOff length:sizeof(formatOff)];
[mdata appendBytes:&reverseOff length:sizeof(reverseOff)];    
[mdata appendData: [NSData dataWithBytes: &codeTable length:sizeof(codeTable)]];
[mdata appendData: [NSData dataWithBytes: &charSet length:sizeof(charSet)]]; 
```

如您所见，我只是逐字节附加数据。

# c - 如何将大括号括起来的初始化列表作为参数传递？

> ID：11268305
> 
> 赞同：6
> 
> 时间：2012-06-29T20:07:58.370
> 
> 标签：c, function

*这是这篇文章的副本：[Brace Enclosed Initializer List As Function Argument](https://stackoverflow.com/questions/8004102/brace-enclosed-initializer-list-as-function-argument)，尽管我正在寻找仅使用 C 中可用方法的解决方案。我正在使用 Windows 8 编译器。*

基本上，我想做这样的事情：

```
HANDLE hThread1 = CreateThread(...);
HANDLE hThread2 = CreateThread(...);
HANDLE hThread3 = CreateThread(...);

...

WaitForMultipleObjects( 3, {hThread1,hThread2,hThread3}, FALSE, INFINITE ); 
```

而不是这个：

```
HANDLE hThread[3];
hThread[0] = CreateThread(...);
hThread[1] = CreateThread(...);
hThread[2] = CreateThread(...);

...

WaitForMultipleObjects( 3, hThread, FALSE, INFINITE );

foo(arg1, arg2, {arg3_1, arg3_2}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T20:20:49.263

C99 提供复合文字，它*会给*你你想要的：

```
WaitForMultipleObjects( 3,
                        (HANDLE*){hThread1, hThread2, hThread3},
                        FALSE,
                        INFINITE ); 
```

不幸的是，微软表示他们对支持 C90 之后的任何 C 标准没有兴趣，除了那些恰好是 C++ 一部分的功能（并且 C++ 没有复合文字）。

您可以编写一个可变参数函数来构建一个 s 数组`HANDLE`并返回指向其第一个元素的指针。调用可能如下所示：

```
WaitForMultipleObjects( 3,
                        HandleList(3, hThread1, hThread2, hThread3),
                        FALSE,
                        INFINITE ); 
```

但是，您通常会遇到管理为数组分配的内存的问题。

C90 没有提供一种特别干净的方式来做你想做的事。

# node.js - PBKDF2 的所有实现是否应该从相同的输入生成相同的密钥？

> ID：11268307
> 
> 赞同：2
> 
> 时间：2012-06-29T20:08:06.147
> 
> 标签：node.js, cryptography, openssl, pbkdf2, cryptojs

我正在将我的 node.js 应用程序的哈希算法从基于 JS 的[CryptoJS](http://code.google.com/p/crypto-js/#PBKDF2)实现切换到节点自己的[加密](http://nodejs.org/docs/v0.8.1/api/crypto.html#crypto_crypto_pbkdf2_password_salt_iterations_keylen_callback)实现。

这是我的实现：

```
var password = "password1";
var salt = generateSalt();
var iterations = 4000;
var keySize = 768/32;
var cryptoJSKey = CryptoJS.PBKDF2(password, salt, { "iterations": iterations , "keySize": keySize });
// base64 encoded key
cryptoJSKey = cryptoJSKey.toString(CryptoJS.enc.Base64);

require("crypto").pbkdf2( password, salt, iterations, keySize, function(err, derivedKey){
    var nodeCryptoKey = new Buffer( derivedKey, "binary" ).toString( "base64" );

    console.log( cryptoJSKey == nodeCryptoKey ); // always false!
}); 
```

我注意到的一件事是`nodeCryptoKey`最终成为`32`字符长并且 cryptoJSKey 是`192`. 如果我将`keySize`for only 节点的`crypto`版本增加到`144`( `keySize * 6`)，则密钥最终`192`也会变成字符长 - 尽管它仍然不同。

我做错了什么还是实现方式彼此不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T21:45:23.717

看来我想通了。

在“CryptoJS v3.0.2.zip”（当前下载）中卷起的 PBKDF2.js 脚本中`CryptoJS.enc.Base64`是`undefined`；这可能是有意的，但我没有注意到。

我正在将节点的 Base64 编码输出与 CryptoJS 的十六进制输出进行比较。

另一个需要注意的是，密钥大小在 CryptoJS 和 node.js 之间不兼容。节点需要`keySize * 4`为了输出一个相同的密钥。在这两种情况下，我都不熟悉引擎盖下发生的事情。但我只是假设这是有意的。

Node.js 的 PBKDF2 的文档非常稀缺；但是，它确实说它的“关键”参数名为`keylen`，它以字节为单位（或者它是位？我不确定）。

# c# - RouteUrl + RouteLink，同时保留当前查询字符串值

> ID：11268313
> 
> 赞同：1
> 
> 时间：2012-06-29T20:08:32.663
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing

在 ASP.net MVC 中，我使用`Url.RouteUrl`&`Html.RouteLink`在我的页面中创建一些链接。

考虑以下默认路由：

```
routes.MapRoute(
    null,
    "{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = UrlParameter.Optional }
); 
```

使用`Url.RouteUrl(new { controller = "Products", action = "List", sort = "newest" })`将产生 URL `/Products/List?sort=newest`。

到目前为止，这正是我想要的。我不确定如何完成以下内容。如果我目前在`/Products/List?sort=newest`. 我需要为用户提供一个 URL 来更改每页列出的产品数量：

```
`/Products/List?sort=newest&pagesize=30` 
```

如何使用`Url.RouteUrl`生成以下 URL 以便：

*   如果我当前位于 sort=newest 的页面上，它会保留此值：/Products/List?sort=newest&pagesize=30
*   如果我当前在一个没有排序的页面上，它会忽略它：/Products/List?pagesize=30

对于我的意思的一个例子，你可以看看stackoverflow。如果我查看问题并更改为查看特色问题，然后单击底部的页面大小，它将保留排序但随后将页面大小附加到 URL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T07:47:44.540

```
Url.RouteUrl(
    new { 
        controller = "Products", 
        action = "List", 
        sort = Request["sort"],
        pagesize = "30"
    }
) 
```

如果从中调用`/Products/List`它，它将产生`/Products/List?pagesize=30`. 如果从中调用`/Products/List?sort=newest`它，它将产生`/Products/List?sort=newest&pagesize=30`.

# jquery - 使用 jQuery 切换时移动到 DIV

> ID：11268314
> 
> 赞同：5
> 
> 时间：2012-06-29T20:08:33.503
> 
> 标签：jquery, scroll, toggle

我一直在阅读，我试图让屏幕移动到正在切换的 div。它位于我网站的底部，因此当您切换联系表单时，除非向下滚动，否则您无法判断它是否存在。

我有这个似乎不起作用的 jQuery 片段

```
//contact toggle
$("#show-con").click(function(){
  $("#contact-wrap").slideToggle("slow");
  $("#contact-wrap").animate({scrollTop: $("#contact-wrap").offset().top});
}); 
```

切换工作正常，但它不会滚动到 div。

我在这里阅读了一些较旧的文章，但不幸的是，它们链接到不再活跃的网站。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-29T20:10:33.707

这将起作用，`html, body`用于您的选择器：

```
$("#show-con").click(function(){
  $("#contact-wrap").slideToggle("slow");

  if ($("#contact-wrap").is(':visible')) {
     $("html, body").animate({scrollTop: $("#contact-wrap").offset().top});
  }
}); 
```

还添加了检查元素是否仅可见，否则滚动不可见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-22T18:29:46.567

要为所有`div`有开关的 s 定义这个，请参考[http://jsfiddle.net/LkTf8/79/](http://jsfiddle.net/LkTf8/79/)。

```
$(document).ready(function() {
  $(".trigger").click(function(e){
  var $toggled = $(this).attr('id');
  var $paneltoggled = $(this).next(".panel").attr('id');

  $(this).next(".panel").slideToggle('slow'); 
  if ($("#" + $paneltoggled).is(':visible')) {
    $("html, body").animate({scrollTop: $("#" + $paneltoggled).offset().top});}    
  });
}); 
```

# c++ - 反转字符串 find_first_not_of

> ID：11268323
> 
> 赞同：2
> 
> 时间：2012-06-29T20:09:23.713
> 
> 标签：c++, string, find

我有一个`std::string`并且我想找到第一个字符的位置：

*   与以下所有字符不同`' '`：`'\n'`和`'\t'`。
*   与我指示的位置相比，位置较低。

因此，例如，如果我有以下`string`和职位：

```
string str("AAA BBB=CCC DDD");
size_t pos = 7; 
```

我希望有可能使用这样的方法：

```
size_t res = find_first_of_not_reverse(str, pos, " \n\t");
// now res = 4, because 4 is the position of the space character + 1 
```

我能怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T21:00:31.907

正如 Bo 评论的那样，templatetypedef 的答案是 99%。我们只需要[`std::string::find_last_of`](http://en.cppreference.com/w/cpp/string/basic_string/find_last_of)而不是`std::string::find_last_not_of`：

```
#include <cassert>
#include <string>

std::string::size_type find_first_of_not_reverse(
    std::string const& str,
    std::string::size_type const pos,
    std::string const& chars)
{
    assert(pos > 1);
    assert(pos < str.size());

    std::string::size_type const res = str.find_last_of(chars, pos - 1) + 1;
    return res == pos ? find_first_of_not_reverse(str, pos - 1, chars)
         : res ? res
         : std::string::npos;
}

int main()
{
    std::string const str = "AAA BBB=CCC DDD";
    std::string const chars = " \n\t";
    std::string::size_type res = find_first_of_not_reverse(str, 7, chars); // res == 4
    res = find_first_of_not_reverse(str, 2, chars); // res == npos
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-10T08:11:01.590

我很好奇为什么 basic_string 自己没有定义 rfind_first_of 和朋友。我认为应该。无论如何，这里是一个非递归（参见 ildjarn 的答案）实现，应该满足这个问题的要求。它可以编译，但我没有测试过。

```
std::string delims = " \n\t";
reverse_iterator start = rend()-pos-1, found = 
std::find_first_of(start,rend(),delims.begin(),delims.end());
return found==rend()?npos:pos-(found-start); 
```

如果 rfind pos 是 npos 或大于 size()，则需要将其设置为 size()。

PS：我认为这个问题可以从一些编辑中受益。对于一个“find_first_of_not_reverse”来说，这是非常具有误导性的。我认为应该是 rfind_first_of （然后在结果中加 1。）

# sencha-touch-2 - Sencha touch 在scss中为特定容器设置主题

> ID：11268324
> 
> 赞同：1
> 
> 时间：2012-06-29T20:09:27.470
> 
> 标签：sencha-touch-2

我想知道如何为特定容器而不是整个应用程序中的每个容器设置主题。

```
#ext-element-18 x-scroll-container 
```

如果我想改变这个的背景颜色会是什么？

**应用程序.scss**

```
#ext-element-18 x-scroll-container{
  background-color: #000;
} 
```

这是行不通的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:42:45.550

将 CSS 建立在自动生成的 id 之类的`ext-element-18`. 它可以随时改变。所以我建议你使用[`cls`配置](http://docs.sencha.com/touch/2-0/#!/api/Ext.Component-cfg-cls)

给你的 contrainer 一个**cls**属性：

```
cls:'my-css-class' 
```

然后在您的 CSS 或 SCSS 文件中使用此类来自定义组件。

如果您需要访问组件的子组件，您现在可以执行类似的操作

```
.my-css-class .x-scroll-container{
  // custom style
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T16:39:39.780

这也有效；

```
Ext.get(Ext.fly('ext-groepen_detail-1').query('.x-scroll-container')).elements[0].style.backgroundImage = 'url("http://somedomain/path/to/test logo 2.jpg")'; 
```

# c# - 窗口化应用程序 Visual Studio 2012

> ID：11268328
> 
> 赞同：1
> 
> 时间：2012-06-29T20:09:54.670
> 
> 标签：c#, windows, visual-studio-2012

我试图从 Visual C# Express Edition 2012 创建一个空白项目。当我启动我的应用程序时，它处于全屏模式......我想创建一个窗口应用程序。制作窗口模式的选项在哪里？

PS：我的操作系统是 Windows 8 RC

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:16:21.203

Visual Studio Express 2012 RC 还不支持桌面开发。它最终只会在即将发布的 VS2012 稳定版本中作为单独的 Express SKU 提供，称为[Visual Studio Express 2012 for Windows Desktop](https://blogs.msdn.com/b/visualstudio/archive/2012/06/08/visual-studio-express-2012-for-windows-desktop.aspx?)。

如果您现在必须在 Windows 8 RP 上开始桌面开发，您可以安装 Visual C# 2010 Express，它在 Windows 8 上的工作方式应该与往常一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T20:15:32.697

根据我对 Visual C# Express 2012 的了解，您只能使用 express 版本创建 Metro 应用程序。如果您想创建传统的窗口应用程序，您必须购买专业版。但是我认为 Windows 8 与旧版本的 VS Express 兼容。

# linux - 如何将 Example.bat 更改为 Example.pl？

> ID：11268329
> 
> 赞同：2
> 
> 时间：2012-06-29T20:09:59.787
> 
> 标签：linux, perl, shell, scripting

我已阅读其他线程[在此处输入链接描述](http://bash.cyberciti.biz/)，讨论 .bat 到 L/unix 的转换，但没有一个令人满意。在编写自己的脚本时，我也尝试了很多 hack 类型的方法。

我有以下 example.bat 脚本，它代表了我想在 unix 上运行的那种脚本。

代码：

```
echo "Example.bat"

perl script1 param.in newParam.in

perl script2 newParam.in stuff.D2D stuff.D2C

program.exe stuff.D2C

perl script3 stuff.DIS results.out 
```

我的问题是我不知道如何处理 unix bash shell 中的 perl 和 program.exe。我曾尝试将它们放入 system() 中，但这不起作用。有人可以帮帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T22:34:42.687

假设你有一个`program.exe`在你的某个地方命名的可执行文件`$PATH`（你很可能 - Unix 可执行文件不必以 结尾`.exe`，但没有说它们不能），你粘贴的代码是一个有效的 shell 脚本。如果你将它保存在一个名为 的文件中`example.bat`，你可以通过键入来运行它

```
sh example.bat 
```

进入 shell 提示符。

当然，Unix shell 脚本通常有后缀`.sh`——或者根本没有后缀——而不是`.bat`. 此外，如果您希望您的脚本可以直接执行，只需键入

```
example.sh 
```

而不是`sh example.sh`，您需要做三件事：

1.  以“shebang”行开始脚本：`#!`以您要用于运行它的 shell 解释器的完整路径开头的行（例如`/bin/sh`，对于基本的 Bourne shell），如下所示：

    ```
    #!/bin/sh

    echo "This is a shell script."

    # ... more commands here ... 
    ```

2.  使用命令将您的脚本标记为可执行文件`chmod`，例如

    ```
    chmod a+rx example.sh 
    ```

3.  将脚本放在`$PATH`. 在 Unix 上，默认路径通常不包含当前目录`.`，因此您不能仅通过输入名称从当前目录执行程序。但是，您*可以通过指定显式路径来运行它们，例如*

    ```
    ./example.sh    # runs example.sh from the current directory 
    ```

    要找出你`$PATH`是什么，只需`echo $PATH`在 shell 中输入。

# android - 我的按钮总是用 performClick 调用两次

> ID：11268331
> 
> 赞同：2
> 
> 时间：2012-06-29T20:10:06.270
> 
> 标签：android, android-button

`TextView`我有一个简单的代码，可以在按下按钮后或用户按下“Enter”时显示字符串。当用户按下按钮时，一切都找到了，但是当按下“输入”时，它会调用`performClick()`与按钮相同的函数。但是我的函数总是被调用两次：

```
 private OnKeyListener ChampKeyListener = new OnKeyListener()
    {

        @Override
        public boolean onKey(View v, int keyCode, KeyEvent event)
        {
            if(keyCode == KeyEvent.KEYCODE_ENTER)
            {
                recherche.performClick(); // recherche is my button
            }
            return false;
        }
    };

    private OnClickListener RechercheListener = new OnClickListener() {
        @Override
        public void onClick(View v) {
        //whatever I have tried here it is always called twice

        }
    }; 
```

我怎么能阻止它。我已经看到我可以解决我去另一个的问题，`View`或者`Activity`但我不想使用那些。

有什么提示吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T20:17:17.253

1.  `KeyEvent.ACTION_DOWN`因为在 press &上有两个动作 `KeyEvent.ACTION_UP`

2.  [http://developer.android.com/reference/android/view/View.OnKeyListener.html](http://developer.android.com/reference/android/view/View.OnKeyListener.html)

`true`如果侦听器已经消费了事件，则返回，`false`否则返回。

试试看...

```
public boolean onKey(View v, int keyCode, KeyEvent event) {

    if (event.getAction() == KeyEvent.ACTION_DOWN)
          {
                if(keyCode == KeyEvent.KEYCODE_ENTER)
                {
                    recherche.performClick(); // recherche is my button
                    return true;
                }

           }

    return false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T20:21:16.007

事件可能会被触发两次，一次是按下键时，另一次是释放键时。尝试：

```
@Override
public boolean onKey(View v, int keyCode, KeyEvent event) {
    if(keyCode == KeyEvent.KEYCODE_ENTER &&
            event.getAction() == KeyEvent.ACTION_DOWN) {
        recherche.performClick(); // recherche is my button
        return true; // consume event
    }
    return false;
} 
```

# php - PHP - 动态图像生成

> ID：11268334
> 
> 赞同：0
> 
> 时间：2012-06-29T20:10:20.000
> 
> 标签：php, image, dynamic, gd, php-gd

如何使用取决于`$_GET['x']`变量的 php 创建动态图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:26:39.033

我强烈推荐这个库[http://codecanyon.net/item/image-tools-with-bmp-support/239941](http://codecanyon.net/item/image-tools-with-bmp-support/239941)我已经在我从事的几个项目中使用过它，这些项目基本上涉及到您的相同需求。我们需要一种方法来根据来自论坛数据库的数据（例如用户名、头像、帖子数量等）动态生成论坛签名。

编辑：不确定我是否被允许做广告（我不认为我是），但如果您有任何问题，请给我发电子邮件至 olds dot co 的 peter。

# asp.net - 如何在 Datalist 控件中进行分页？

> ID：11268336
> 
> 赞同：0
> 
> 时间：2012-06-29T20:10:31.070
> 
> 标签：asp.net, vb.net, paging, datalist

我在 ASP.NET 3.5 Access 2003 DataSource 中有我的 DataList。我想`DataList`使用 VB 为控件创建分页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T01:51:38.483

![输出](../Images/f8c9bf2447808f23f01e9d07cb8d341a.png) DataList 缺少像 in 那样的`GridView`分页功能，但可以为`DataList`. 在这里，我已经完成 `PagedDataSource`了分页，其中包含数据绑定控件的分页相关属性，允许它执行分页。[有关PagedDataSource](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.pageddatasource.aspx)的更多详细信息

**内联代码**

```
 <div>
        <asp:DataList ID="dataListStudent" runat="server">
            <ItemTemplate>
                <table cellpadding="10">
                    <tr>
                        <td nowrap="nowrap">
                            <b>Student id</b>
                        </td>
                        <td nowrap="nowrap">
                            <b>First name</b>
                        </td>
                        <td nowrap="nowrap">
                            <b>Last name</b>
                        </td>
                        <td>
                            <b>City</b>
                        </td>
                    </tr>
                    <hr />
                    <tr>
                        <td nowrap="nowrap">
                            <%# Eval("StudentID") %>
                        </td>
                        <td nowrap="nowrap">
                            <%# Eval("FirstName") %>
                        </td>
                        <td nowrap="nowrap">
                            <%# Eval("LastName") %>
                        </td>
                        <td nowrap="nowrap">
                            <%# Eval("City") %>
                        </td>
                    </tr>
                </table>
            </ItemTemplate>
        </asp:DataList>
        <br />
        <table border="0" width="410">
            <tr>
                <td align="left">
                    <asp:LinkButton ID="lbPrev" runat="server">
Prev
                    </asp:LinkButton>
                </td>
                <td align="right">
                    <asp:LinkButton ID="lbNext" runat="server">
Next
                    </asp:LinkButton>
                </td>
            </tr>
        </table>
    </div> 
```

**代码隐藏**

```
Imports System.Data
Imports System.Data.OleDb

Partial Class _Default
    Inherits System.Web.UI.Page
    Dim pageds As New PagedDataSource()

    Public Property CurrentPage() As Integer

        Get
            If Me.ViewState("CurrentPage") Is Nothing Then
                Return 0
            Else
                Return Convert.ToInt16(Me.ViewState("CurrentPage").ToString())
            End If
        End Get

        Set(ByVal value As Integer)
            Me.ViewState("CurrentPage") = value
        End Set
    End Property
    Sub bindDataList()
        Dim sql As String
        sql = "SELECT * FROM STUDENTS"
        Dim da As New OleDbDataAdapter(sql, "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=|DataDirectory|\Course.mdb")
        Dim dt = New DataTable()
        da.Fill(dt)
        Try
            pageds.DataSource = dt.DefaultView
            pageds.AllowPaging = True
            pageds.PageSize = 3
            pageds.CurrentPageIndex = CurrentPage
            lbNext.Enabled = Not pageds.IsLastPage
            lbPrev.Enabled = Not pageds.IsFirstPage
            dataListStudent.DataSource = pageds
            dataListStudent.DataBind()
        Catch ex As Exception
            Throw ex
        End Try
    End Sub
    Protected Sub lbPrev_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles lbPrev.Click
        currentPage -= 1
        bindDataList()
    End Sub
    Protected Sub lbNext_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles lbNext.Click
        currentPage += 1
        bindDataList()

    End Sub
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            bindDataList()

        End If
    End Sub
End Class 
```

您的连接字符串，列名可能不同，您可能希望 DataList 的不同布局随意摆弄它。 **希望它能帮助您解决问题。**

# c# - DriveInfo.GetDrives() 以管理员身份运行时不返回映射的驱动器

> ID：11268337
> 
> 赞同：5
> 
> 时间：2012-06-29T20:10:32.347
> 
> 标签：c#, .net, windows-7-x64, drives, driveinfo

我正在创建一个 WPF 应用程序，除其他外应检查是否存在多个映射驱动器。代码很简单：

```
DriveInfo[] systemDrives = DriveInfo.GetDrives();
foreach (DriveInfo i in systemDrives)
{
     if ((i.Name.Contains("V")) && (i.IsReady))
     {
          result = true;
          break;
     }

 } 
```

映射的驱动器映射到所有用户。上面的代码在以普通用户身份运行时工作正常，但是 Visual Studio 2010 以管理员身份运行，GetDrives 方法仅返回固定驱动器和 DVD 驱动器，但不返回映射驱动器。如果可执行文件以管理员身份运行，也会发生同样的情况。任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T20:16:33.517

来自[http://www.vistaheads.com/forums/microsoft-public-windows-vista-general/125180-run-administrator-loses-access-mapped-drives.html](http://www.vistaheads.com/forums/microsoft-public-windows-vista-general/125180-run-administrator-loses-access-mapped-drives.html)，

（通过[http://social.technet.microsoft.com/Forums/en-US/w7itpronetworking/thread/31c9eff2-ece3-4430-886d-19b54796e411/](http://social.technet.microsoft.com/Forums/en-US/w7itpronetworking/thread/31c9eff2-ece3-4430-886d-19b54796e411/)）：

> 这实际上是正常行为。正如您在 XP 上看到的，驱动器映射是特定于用户上下文的。因此，如果 User1 有一个驱动器 H: 映射到 \server\share1，则 User2 不会自动获得对该 H: 驱动器映射的任何访问权限；它只存在于 User1 的会话中。如果 User2 想要访问 \server\share1，他们需要创建自己的映射，H: 驱动器或任何其他适合的驱动器。
> 
> 嗯，它在 Vista 中是一样的......只是更是如此。
> 
> 与以前版本的 Windows 不同，当管理员登录到运行 Windows Vista 的计算机时，用户的完全管理员访问令牌被拆分为两个访问令牌：完全管理员访问令牌和标准用户访问令牌。在登录过程中，识别管理员的授权和访问控制组件被删除，从而产生标准用户访问令牌。然后使用标准用户访问令牌启动桌面，即 Explorer.exe 进程。因为所有应用程序都从桌面初始启动时继承其访问控制数据，所以它们也都以标准用户身份运行。管理员登录后，在用户尝试执行管理任务之前，不会调用完全管理员访问令牌。
> 
> 因此，当管理员“提升”以执行某种需要管理访问权限的操作时，他们的“拆分令牌”会暂时替换为完整的管理令牌。实际上，这意味着他们现在拥有不同的用户上下文。因此驱动器映射也发生了变化。因此 H: 驱动器在当前上下文中不再具有有效映射。
> 
> 我使用的解决方法是打开一个管理命令提示符——在那里你一直有一个提升的令牌——并从那里创建一个匹配的驱动器映射（net use h:\server\share1）。由于标准用户和高级管理员对“H：”驱动器的含义有共同的理解，因此一切正常。
> 
> 我理解（嗯，有点！）为什么这个设计已经到位。我不会试图批评或捍卫它。但是你现在有了。
> 
> 在理想情况下，管理员可以配置“全局”映射，自动应用于机器上的每个用户上下文（几乎就像真实设备一样）。但是，那并没有发生。大多数操作系统都有不同程度的杂乱无章的妥协。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-02-12T10:13:51.237

您可以通过注册表项使管理员也可以看到映射的驱动器：

HKEY_LOCAL_MACHINE/SOFTWARE/Microsoft/Windows/CurrentVersion/Policies/System

创建值为 1 的 DWORD EnableLinkedConnections

如此处所述：http: [//www.winability.com/how-to-make-elevated-programs-recognize-network-drives/](http://www.winability.com/how-to-make-elevated-programs-recognize-network-drives/)

这在 Win 10 上对我有用。

# fedex - FedEx 追踪网络服务无法识别任何追踪号码

> ID：11268341
> 
> 赞同：1
> 
> 时间：2012-06-29T20:10:40.623
> 
> 标签：fedex

我正在尝试使用 FedEx API 来跟踪包裹。我可以成功地向他们的测试服务器进行身份验证（使用我的用户凭据、帐号和仪表编号）。但是，对于我在请求中使用的大多数跟踪号码，我收到了同样无益的回复；测试跟踪号（如 999999999999）和真实跟踪号（在 FedEx 网站上运行良好）都返回以下内容：

> 错误代码 9040。我们的系统尚未收到以下货件的信息。请重试或拨打 1.800.Go.FedEx(R) 800.463.3339 联系客户服务。

获取不同响应的唯一请求是明显无效的请求，例如“test”，它返回：

> 错误代码 5508。跟踪号无效。

我尝试使用他们的 wsdl (TrackService_v5) 以及手动非 SOAP HTTP POST 请求进行 SOAP 请求，但它们的响应在这两种情况下完全相同。是他们那边出了什么问题，还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:02:55.513

似乎联邦快递已禁用任何测试跟踪号码，在过去 999999999999 可以正常工作，但现在甚至不起作用。据我所知，解决此问题的唯一方法是投入生产。恕我直言，哪个不好，因为您必须测试应用程序的跟踪部分，直到您投入生产。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-31T01:31:33.320

999999999999 为我工作，但我想我已经在生产环境中了。

![999999999999](../Images/5cadd8a94d3fe8e7c84682dea911c757.png)

# java - 通过命令行从 java 运行 ac/c++ 程序

> ID：11268343
> 
> 赞同：2
> 
> 时间：2012-06-29T20:10:51.813
> 
> 标签：java, command-prompt

我编写了一个编译和执行 C、c++、java 程序的 java 程序。我首先对它进行了 java 测试，它工作得非常好。然后我对它进行了 C 测试，但它给出了错误。请告诉我需要做什么..这是编译代码的模块..：

```
public void compileCode(String path,String lang)throws IOException
    {
        String cmd="";
        if(lang.equals("c")||lang.equals("cpp"))
            cmd="g++ Main"+threadNum+"."+lang+" -o "+threadNum;
        else if(lang.equals("java"))
            cmd="javac Main"+threadNum+".java";

        Process p=Runtime.getRuntime().exec(cmd,null,new File(path));

         String s=null;
        BufferedReader stdError = new BufferedReader(new InputStreamReader(p.getErrorStream()));
        while ((s = stdError.readLine()) != null) {
            msg+=s+"\n";
            res=0;
        }
        if(res!=0)
            processCode(path,lang);
    } 
```

错误是：

```
Exception in thread "main" java.io.IOException: Cannot run program "g++" (in directory "C:\wamp\www\usercodes\lokesh"): CreateProcess error=2, The system cannot find the file specified
    at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
    at java.lang.Runtime.exec(Runtime.java:615)
    at java.lang.Runtime.exec(Runtime.java:448)
    at Contest.compileCode(Main.java:164)
    at Contest.makeFile(Main.java:154)
    at Contest.main(Main.java:52)
    at Main.main(Main.java:14)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:1

20) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:22:58.673

要使“g++”正常工作，Windows 的 PATH 上必须有一个 g++.exe。如果它是“g++.bat”或“g++.cmd”，则必须使用确切的名称调用 Runtime.exec。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T22:50:29.430

我改用了进程生成器，它解决了..无论如何，谢谢你的时间:)这是代码......

```
public void compileCode(String path,String lang)throws IOException,InterruptedException
    {
        String cmd="";
        if(lang.equals("c")||lang.equals("cpp"))
            cmd="g++ "+path+"Main"+threadNum+"."+lang+" -o "+threadNum;
        else if(lang.equals("java"))
            cmd="javac Main"+threadNum+".java";
        ProcessBuilder process=new ProcessBuilder();
        process.directory(new File(path));
        process.command(new String[]{"cmd","/c",cmd});
        Process p=process.start();
        String s=null;
        BufferedReader stdError = new BufferedReader(new InputStreamReader(p.getErrorStream()));
        while ((s = stdError.readLine()) != null) {
            msg+=s+"\n";
            res=0;
        }
        if(res!=0)
            processCode(path,lang);
    } 
```

# git-rebase - 如果没有任何变化， rebase -i 会做什么？

> ID：11268344
> 
> 赞同：3
> 
> 时间：2012-06-29T20:10:54.667
> 
> 标签：git-rebase

我注意到如果我做一个

`git rebase -i HEAD~10`

然后不要更改结果文件中的任何内容，仍然会执行某种变基。即我需要

`git push origin branch --force`

因为经常推

`git push origin branch`

显然会失去历史！

这似乎意味着某些历史被改变了，但我不明白为什么。如果我没有选择更改任何提交（即每个提交都被选中），那么为什么历史记录会发生变化以及具体发生了什么变化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T16:46:02.990

如果你这样做，`git log --format=fuller`你会看到一个提交不仅跟踪作者，而且跟踪提交者：

```
commit 0d987988ffed315ef63f79b33eae40a8715390c9
Author:     Statichippo <example@example.com>
AuthorDate: Fri Jun 22 14:09:48 2012 -0400
Commit:     Statichippo  <example@example.com>
CommitDate: Fri Jun 22 14:09:48 2012 -0400

    a commit message 
```

当你变基时，你的用户被列为新的提交者。如果我重新设置该代码块的基础，这是一个示例：

```
commit 3e23bea3c778c66h59c5f665061e9354507b379b
Author:     Statichippo <example@example.com>
AuthorDate: Fri Jun 22 14:09:48 2012 -0400
Commit:     Jacob Angel <jangel@example.com>
CommitDate: Tue Jul 3 12:39:43 2012 -0400

    a commit message 
```

因此，可能发生的情况是，您正在对另一个人所做的提交进行变基，并且它正在更改提交和 CommitDate。显然 git 会看到一个新的哈希（因为提交的一部分已更改）并注意更改。

# objective-c - XCode - 打印对象的实时值

> ID：11268346
> 
> 赞同：0
> 
> 时间：2012-06-29T20:11:16.883
> 
> 标签：objective-c, xcode, debugging

嗨，我正在调试，需要能够检查我的对象中我的属性的值是什么。它们是字符串......但我没有看到实际的字符串本身。

我在这里得到这个：

![在此处输入图像描述](../Images/f29d5cf26d9ca5b458324c45f7f144de.png)

一些建议会很好......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:12:46.383

调试器有时会弄乱变量的内容。尝试记录您的字符串。

```
NSLog(@"String value: %@", myString); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:27:13.340

将以下方法添加到 TrackVO 类

```
- (NSString *)description{
   return @"put together your instance property values and send out";
} 
```

注意：您正在覆盖从 NSObject 继承的方法。%@ 和 xCode-variable-view 将隐式调用此描述方法。

# java - IceFaces ace:datatable: 需要全选/全选按钮

> ID：11268347
> 
> 赞同：0
> 
> 时间：2012-06-29T20:11:18.640
> 
> 标签：java, jsf, java-ee-6, icefaces

我有一个地狱般的时间添加一个“全选”按钮到 icefaces 数据表。我尝试了以下方法：

```
<h:commandButton
    value="Select All"
    actionListener="#{managedBeanMB.stateMap.setAllSelected(true)}" />
<h:commandButton
    value="Select None"
    actionListener="#{managedBeanMB.stateMap.setAllSelected(false)}" /> 
```

充其量，这是不一致和不可靠的。它还在用户提交表单之前修改了支持 bean。

IceFaces javascript API 似乎也没有任何帮助，因为它只有一个“clearSelection()”调用，无论如何我都无法让它工作。

任何帮助或想法都将被投票...谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T17:20:37.753

我们禁用了分页......这似乎改善了 IceFaces 的错误性质。

# c - 参数“我的 2D-arr”已初始化

> ID：11268353
> 
> 赞同：0
> 
> 时间：2012-06-29T20:11:26.103
> 
> 标签：c, arrays, cygwin, c99

考虑这段代码：

```
enum 
{
        ERR_START,
        ERR_CANNOTOPENFILE, 
        ERR_CANNOTCONNECT, 
        ERR_CANNOTCONNECTWITH,
        ERR_CANNOTGETHOSTNAME,
        ERR_CANNOTSEND,

};

char* ERR_MESSAGE[] =
{
    [ERR_START]                     = "Nothing",
    [ERR_CANNOTOPENFILE]            = "Cannot open '%s' filename.\n",
    [ERR_CANNOTCONNECT]             = "Cannot connect.\n",
    [ERR_CANNOTCONNECTWITH]         = "Cannot connect with '%s'.\n",
    [ERR_CANNOTGETHOSTNAME]         = "Cannot get host name.\n",
    [ERR_CANNOTSEND]                = "Cannot send.\n",

}; 
```

鉴于此错误：

```
error.h:27:1: error: parameter ‘ERR_MESSAGE’ is initialized
error.h:29:2: error: array index in non-array initializer
error.h:29:2: error: (near initialization for ‘ERR_MESSAGE’)
error.h:29:2: warning: initialization from incompatible pointer type
error.h:30:2: error: array index in non-array initializer
[....] 
```

我正在用`-std=c99`.

如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:31:32.803

我认为您收到此消息是因为文件中存在另一个语法错误（或之前包含的内容）。我将代码粘贴到一个独立的 C 文件中，并且没有编译错误，`gcc -std=c99 -c test.c`我的 GCC 版本是**gcc (GCC) 4.6.3 20120306 (Red Hat 4.6.3-2)**。

一个可能的错误（可能是唯一的错误）是函数声明缺少分号。用代码

```
enum 
{
        ERR_START,
        ERR_CANNOTOPENFILE, 
        ERR_CANNOTCONNECT, 
        ERR_CANNOTCONNECTWITH,
        ERR_CANNOTGETHOSTNAME,
        ERR_CANNOTSEND,

};

void foo()
char* ERR_MESSAGE[] =
{
    [ERR_START]                     = "Nothing",
    [ERR_CANNOTOPENFILE]            = "Cannot open '%s' filename.\n",
    [ERR_CANNOTCONNECT]             = "Cannot connect.\n",
    [ERR_CANNOTCONNECTWITH]         = "Cannot connect with '%s'.\n",
    [ERR_CANNOTGETHOSTNAME]         = "Cannot get host name.\n",
    [ERR_CANNOTSEND]                = "Cannot send.\n",

};
```

我收到类似的错误

```
est.c: In function ‘foo’:
test.c:13:1: error: parameter ‘ERR_MESSAGE’ is initialized
test.c:15:5: error: array index in non-array initializer
test.c:15:5: error: (near initialization for ‘ERR_MESSAGE’)
test.c:15:5: warning: initialization from incompatible pointer type [enabled by default]
test.c:15:5: warning: (near initialization for ‘ERR_MESSAGE’) [enabled by default]
test.c:16:5: error: array index in non-array initializer
test.c:16:5: error: (near initialization for ‘ERR_MESSAGE’)
test.c:16:5: warning: excess elements in scalar initializer [enabled by default]
test.c:16:5: warning: (near initialization for ‘ERR_MESSAGE’) [enabled by default]
[...] 
```

# java - 为什么我的背景颜色不会在 JFrame 中显示？

> ID：11268357
> 
> 赞同：4
> 
> 时间：2012-06-29T20:11:49.360
> 
> 标签：java, swing, background, jframe, setbackground

我有两个类文件：

屏幕[https://gist.github.com/3020101](https://gist.github.com/3020101)

JMain [https://gist.github.com/3020107](https://gist.github.com/3020107)

我试图让它全屏显示 5 秒并显示背景（或者，此时，甚至是前景）但是当我运行它时，它会全屏显示 5 秒，是的，但它只是一个空白的浅灰色屏幕。

我究竟做错了什么？最终，我将使用图像作为背景，并且我想确保我不会在某个地方搞砸。

多谢你们！

编辑：当我在 JMain 类的末尾添加它时，字体颜色与前景色相同，但无论我在程序中将其更改为哪种颜色，背景始终为黑色。

```
public void paint(Graphics g) {
    g.drawString("This is gonna be awesome", 200, 200);
} 
```

来自github的代码

```
import java.awt.*;
import javax.swing.JFrame;

public class JMain extends JFrame {

    private JFrame frame = new JFrame();

    public static void main(String[] args) {
        DisplayMode dm = new DisplayMode(800, 600, 16, DisplayMode.REFRESH_RATE_UNKNOWN);
        JMain m = new JMain();
        m.run(dm);
    }

    public void run(DisplayMode dm) {
        this.getContentPane().setBackground(Color.RED);
        frame.setForeground(Color.BLACK);
        frame.setFont(new Font("Arial", Font.PLAIN, 24));
        Screen s = new Screen();
        try {
            s.setFullScreen(dm, this);
            try {
                Thread.sleep(5000);
            } catch (Exception ex) {
            }
        } finally {
            s.restoreScreen();
        }
    }
} 
```

和

```
import java.awt.*;
import javax.swing.JFrame;

public class Screen {

    private GraphicsDevice vc;

    public Screen() {
        GraphicsEnvironment env = GraphicsEnvironment.getLocalGraphicsEnvironment();
        vc = env.getDefaultScreenDevice();
    }

    public void setFullScreen(DisplayMode dm, JFrame window) {
        window.setUndecorated(true);
        window.setResizable(false);
        vc.setFullScreenWindow(window);
        if (dm != null && vc.isDisplayChangeSupported()) {
            try {
                vc.setDisplayMode(dm);
            } catch (Exception ex) {
            }
        }
    }

    public Window getFullScreenWindow() {
        return vc.getFullScreenWindow();
    }

    public void restoreScreen() {
        Window w = vc.getFullScreenWindow();
        if (w != null) {
            w.dispose();
        }
        vc.setFullScreenWindow(null);
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-29T20:45:58.443

1.  Don't extend a `JFrame`, but instead create a local `JFrame` variable and use it.

2.  You can't paint the `JFrame`'s background Color, but you can do this for the JFrame's `contentPane` (usually a `JPanel`). An example of code that does this follows:

    this.getContentPane().setBackground(Color.RED);

3.  Never use `Thread.sleep(int)` in code called on the Swing event thread, as this will completely block this thread, preventing it from performing its necessary actions of painting the GUI and interacting with the user and effectively freezing the application for as long as the thread is sleeping.

4.  Use a [Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html) in place of `Thread.sleep(...)`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-29T20:43:43.253

Replace:

```
setBackground(Color.RED); 
```

With:

```
getContentPane().setBackground(Color.RED); 
```

Separately, you should try to put graphics related code in SwingUtilities.invoke... as you can get unexpected issues if the graphics related class are used from the main thread. If you make this change make sure to avoid the sleep within SwingUtilities.invoke... as it will block your painting.

# java - 将程序打包为 jar 后文件输出更改

> ID：11268359
> 
> 赞同：1
> 
> 时间：2012-06-29T20:12:07.257
> 
> 标签：java, jar

我有一个将一些数据写入纯文本索引文件的应用程序。它在 Netbeans 中运行良好，但是当打包为 jar 时，索引文件被创建但最终为空白。以下是相关代码：

```
System.out.println("Writing Index File");

PrintWriter indexOut = new PrintWriter(new File("index.txt"));

for(int i = 0; i < index.size(); i++)
{
    indexOut.println(index.get(i));
}

indexOut.flush();
indexOut.close();

System.out.println("Index complete."); 
```

当我将其捆绑为 jar 时，为什么应用程序的行为会发生变化，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:20:39.410

我怀疑您正在从一个应该与您当前目录相关的文件中读取程序中的一些数据。所以你应该检查你是否依赖于任何相对路径。如果是，则将它们转换为绝对路径作为第一步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:18:26.593

你认为索引集合有什么东西吗？您可能希望将第一个喜欢更改为 System.out.println("Writing Index File " + index.size());

您可以尝试进行相同的调试。

除非程序的输入发生变化，否则应用程序的行为应该没有改变的理由。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T21:05:29.757

当您从 netbeans 运行时，默认文件路径（如果您只写 File("indexOut.txt") 文件将位于该位置）是 netbeans 项目文件夹。如果双击 jar 文件，则默认路径是包含 jar 的目录。

# javascript - 在 JavaScript 中更改宿主对象的原型函数？

> ID：11268360
> 
> 赞同：2
> 
> 时间：2012-06-29T20:12:07.280
> 
> 标签：javascript, dom, prototype

每次调用时我都想执行一些代码`appendChild`。让我们假设我无法知道它会在何时何地被调用。我想我可以使用原型来做到这一点，但他们似乎没有工作：

```
var actAppendChild = Element.prototype.appendChild;
Element.prototype.appendChild = function(node){
    actAppendChild.call(this,node);

    //execute custom code here...
    console.log("foo");
}

document.body.appendChild(someNode); 
```

但是“foo”不会打印到控制台，也不会打印到新原型函数中的任何代码，就此而言。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T14:39:46.493

我可以确认它即使在 IE8+、Safari、Chrome 和 Opera 上也能正常工作。只是一个建议：将代码包装在闭包中以避免污染全局命名空间始终是最佳实践，如下所示：

```
(function(){
  var actAppendChild = Element.prototype.appendChild;
  ....
}()); 
```

# html - 使用未使用 position:absolute 定位的画布层

> ID：11268365
> 
> 赞同：1
> 
> 时间：2012-06-29T20:12:36.067
> 
> 标签：html, canvas, z-index, layer

我正在尝试使用此示例： [http](http://html5.litten.com/using-multiple-html5-canvases-as-layers/) ://html5.litten.com/using-multiple-html5-canvases-as-layers/ 为背景创建多个 html5 层（实际上只需要 2 个），然后在顶部创建动画那个背景。

问题出在示例上，许多其他建议使用 z-index 等对画布进行分层的解决方案似乎都将画布定位在绝对位置的 left:0 和 top:0 处。

例如： [html5 - 画布元素 - 多层](https://stackoverflow.com/questions/3008635/html5-canvas-element-multiple-layers) [html5 - 画布元素 - 多层](https://stackoverflow.com/questions/3008635/html5-canvas-element-multiple-layers)

然而，我想做的是让位置是动态的，但总是让两个画布彼此层叠。

到目前为止，我必须做的是：

```
 <div id="canvasesdiv" align=center; style="text-align:center; float:center">
        <canvas id="bottomlayer-background" style="z-index: 1; border:1px dotted;" align=center>
        This text is displayed if your browser does not support HTML5 Canvas.
        </canvas>
        <canvas id="toplayer-movingstuff" style="z-index: 2; border:1px dotted; position:absolute; left:530px; top:83px">
        This text is displayed if your browser does not support HTML5 Canvas.
        </canvas>
</div> 
```

这种方法的问题是我必须手动找出底层左上角的位置，然后将其输入到顶层。但是这个位置只适用于一个浏览器，一个显示器，全屏等。显然，不可行。

当我尝试让两者都对齐=中心时，会发生什么是画布并排出现，而不是相互叠加。

当我尝试为两者做绝对位置时，问题是窗口中的其他东西，最初位于画布下方（即文本、表格等）突然出现在画布下方。

有没有其他人能够解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T21:24:59.410

绝对定位的工作方式是目标元素绝对定位在其最近定位的祖先中。这意味着如果包含 div 是绝对定位或相对定位，那么目标元素将绝对定位在包含 div 内。

注意：除非您在其他地方弄乱了 z-index，否则您实际上并不需要 z-index

另一个注意事项：如果你想让你的画布表现出来，设置它们的宽度和高度属性，否则事情会变得奇怪。

[http://jsfiddle.net/mobidevelop/4WDJz/](http://jsfiddle.net/mobidevelop/4WDJz/)

**HTML**

```
<p>Other Content</p>
<p>Other Content</p>
<p>Other Content</p>

<div id="contain">
        <canvas id="surface1" width="480" height="160">
        </canvas>
        <canvas id="surface2" width="480" height="160">
        </canvas>
</div>

<p>Other Content</p>
<p>Other Content</p>
<p>Other Content</p>​ 
```

**CSS：**

```
#contain {
    width: 480px;
    height: 160px;
    margin: 0 auto;
    position: relative;    
}

#surface1,
#surface2 {
    top: 0;
    left: 0;
    position: absolute;
} 
```

而且，为了更好地衡量，**JS**：

```
var surface1 = document.getElementById('surface1');
if (surface1 != null) {
    if (surface1.getContext) {
        var context = surface1.getContext("2d");
        if (context != null) {
            context.fillStyle = "rgba(255,0,0,0.25)";
            context.fillRect(0,0,480,160);
        }
    }
}
surface2 = document.getElementById('surface2');
if (surface2 != null) {
    if (surface2.getContext) {
        var context = surface2.getContext("2d");
        if (context != null) {
            var x = 0;
            context.fillStyle = "rgba(0,0,0,1.0)";
            last = new Date();
            setInterval
            (
                function()
                {
                    var now = new Date();
                    var del = (now - last) / 1000.0
                    last = now;

                    context.clearRect(0,0, 480, 160);
                    context.fillRect(x, 10,32,32);                
                    x += 10 * del;
                    if (x > 480) {
                        x = -32;
                    }
                }, 15
            );            

        }
    }
} 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:18:52.043

```
#canvasesdiv{margin:0 auto; position:relative; width:300px;}

#bottomlayer-background, #toplayer-movingstuff{
    position:absolute; 
    z-index: 1; 
    border:1px dotted blue; 
    height:200px;
    width:300px;
}
#toplayer-movingstuff{
    z-index: 2; 
    border:1px solid red; 
} 
```

​</p>

**[工作小提琴](http://jsfiddle.net/loktar/b9Bcg/)**

以上应该工作。只需给包含元素一个相对位置，这将使子元素`absolute`相对于父元素定位。

# perl - 当 my() 有条件时会发生什么？

> ID：11268367
> 
> 赞同：16
> 
> 时间：2012-06-29T20:12:43.077
> 
> 标签：perl

比较使用 `perl -w -Mstrict`：

```
# case Alpha
print $c; 
```

...

```
# case Bravo
if (0) {
  my $c = 1;
}

print $c; 
```

...

```
# case Charlie
my $c = 1 if 0;
print $c; 
```

`Alpha`并且`Bravo`都抱怨全局符号没有明确的包名称，这是可以预料的。但`Charlie`没有给出相同的警告，只是该值未初始化，闻起来很像：

```
# case Delta
my $c;
print $c; 
```

引擎盖下到底发生了什么？（即使永远不应该为生产代码编写这样的东西）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-29T20:22:04.563

您可以将`my`声明视为在编译时和运行时具有操作。在编译时，一个`my`声明告诉编译器记下一个符号存在并且在当前词法作用域结束之前一直可用。该声明中符号的赋值或其他使用将在运行时进行。

所以你的例子

```
my $c = 1 if 0; 
```

就好像

```
my $c;         # compile-time declaration, initialized to undef
$c = 1 if 0;   # runtime -- as written has no effect 
```

* * *

请注意，这种编译时/运行时的区别允许您编写这样的代码。

```
my $DEBUG;    # lexical scope variable declared at compile-time
BEGIN {
    $DEBUG = $ENV{MY_DEBUG};   # statement executed at compile-time
}; 
```

现在你能猜出这个程序的输出是什么吗？

```
my $c = 3;
BEGIN {
    print "\$c is $c\n";
    $c = 4;
}
print "\$c is $c\n"; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-30T15:29:50.303

[mob 的回答](https://stackoverflow.com/a/11268473/18914)很好地解释了当前发生的事情（以及为什么），但不要忘记它[`perldoc perlsyn`](http://perldoc.perl.org/perlsyn.html#Statement-Modifiers)告诉我们：

> **注意：**`my`、`state`或`our`用语句修饰符条件或循环构造（例如 ）修改的行为`my $x if ...`是**undefined**。变量的值`my`可以是 `undef`，任何先前分配的值，或者可能是其他任何值。不要依赖它。未来版本的 perl 可能会做一些与您尝试使用的 perl 版本不同的事情。这里是龙。

不要指望那个结果或对它的解释在未来的 Perl 版本中仍然是正确的。（虽然它可能会。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-02T16:12:31.017

多年来，“my $foo = *val* if *cond* ”构造及其未定义的行为多次困扰着我。我希望编译器可以简单地拒绝它（为什么要在具有未定义行为的语言中保留一些东西？！），但大概出于向后兼容性或其他原因，这不能完成。我发现的最佳解决方案是使用 perlcritic 来防止它：

[http://search.cpan.org/perldoc?Perl::Critic::Policy::Variables::ProhibitConditionalDeclarations](http://search.cpan.org/perldoc?Perl::Critic::Policy::Variables::ProhibitConditionalDeclarations)

# git - 没有 git 服务器的 Web 开发的 Git 设置，使用本地网络

> ID：11268372
> 
> 赞同：1
> 
> 时间：2012-06-29T20:12:58.843
> 
> 标签：git

我一直在尝试为我们的 Web 开发团队设置 git，但没有成功。一些 stackoverflow 用户很好地帮助我了解如何在我们拥有的环境中设置它，从而让我开始；但是，在尝试实际实现它之后，我遇到了一些问题。我们正在尝试将其设置为开发 Wordpress 主题和插件。

[在网络上设置 Git 并复制到网站](https://stackoverflow.com/questions/10707323/setting-up-git-on-network-and-the-copying-to-website)

昨天，我将主题和插件文件夹从我们的生产服务器复制到了网络文件服务器。然后我打开 Git for Windows 附带的命令行，导航到文件服务器上的文件夹，并为每个主题和插件执行此操作以在网络上创建一个存储库：

```
$ git init
$ git add *
$ git commit -m 'initial project version' 
```

然后，在我的工作站上，我导航到主题（以及后来的插件）文件夹，并为每个主题和插件执行此操作：

```
$ git clone /path/to/network/repository 
```

它在文件中克隆，一切似乎进展顺利。然后，我测试了一个提交并尝试将其推回网络文件服务器。这给了我一个错误，说网络上的文件已签出。在网上搜索我做错了什么之后，我发现也许（我认为）我应该在网络文件服务器上创建一个裸存储库。所以，现在我正在寻找能够告诉我我是否朝着正确的方向前进的人。昨天花了一整天才发现我做错了，我想也许我应该验证一下，这是我现在认为我应该做的图形表示：

![新的 git 计划](../Images/0b0abbc85e6b79dc19adc40053fe20c9.png)

在此计划中，将在具有文件工作副本的网络文件服务器上创建一个存储库。此后，将在网络文件服务器上的单独目录中创建一个裸存储库。工作站将从裸存储库中获取和合并，然后推回它。然后，非裸网络存储库将从裸存储库中拉取。接下来，将文件从非裸网络存储库手动复制到登台服务器进行测试。测试后，我们的服务器管理员会将更改从登台复制到生产。

这有任何意义吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:24:26.177

这是有道理的。它应该可以正常工作。你的分支策略是什么？这是我的： http: [//dymitruk.com/blog/2012/02/05/branch-per-feature/](http://dymitruk.com/blog/2012/02/05/branch-per-feature/)

我不确定这是否是一个正确的问题。你能完善你需要回答的内容吗？

# java - 如何使用 RowFilter 过滤 JTable 的行 OUT

> ID：11268374
> 
> 赞同：2
> 
> 时间：2012-06-29T20:12:59.913
> 
> 标签：java, swing, jtable, rowfilter

我为此看到的每个示例都使用 RowFilter.regexFilter 并过滤掉除给定文本之外的所有其他内容。我希望过滤掉给定文本的行。对我来说，这甚至没有意义。咖啡过滤器将咖啡渣过滤掉，而不是相反。

如何从 JTable 中过滤掉包含所提供文本的行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T20:21:10.217

[`RowFilter`](http://docs.oracle.com/javase/6/docs/api/javax/swing/RowFilter.html)有一个名为 的静态方法[`notFilter()`](http://docs.oracle.com/javase/6/docs/api/javax/swing/RowFilter.html#notFilter%28javax.swing.RowFilter%29)，它接受 a`RowFilter`作为参数并返回一个`RowFilter`具有相反效果的新方法。你可以把你的`regexFilter`传给`RowFilter.notFilter()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T11:52:01.777

知道了谢谢，`sorter.setRowFilter(RowFilter.notFilter(RowFilter.regexFilter(expr)));`

# javascript - 使用 PEG Parser 进行 BBCode 解析：pegjs 或……什么？

> ID：11268376
> 
> 赞同：7
> 
> 时间：2012-06-29T20:13:34.607
> 
> 标签：javascript, parsing, bbcode, peg, pegjs

我有一个 bbcode -> html 转换器，它响应文本区域中的更改事件。目前，这是使用一系列正则表达式来完成的，并且存在许多病理情况。我一直想在这个语法上磨砺铅笔，但不想进入牦牛剃须。但是......最近我开始意识到[pegjs](http://pegjs.majda.cz/)，这似乎是 PEG 解析器生成的一个非常完整的实现。我已经指定了大部分语法，但现在我想知道这是否适合使用成熟的解析器。

我的具体问题是：

1.  由于我的应用程序依赖于将我可以翻译的内容转换为 HTML 并将其余部分保留为原始文本，因此使用可能因语法错误而失败的解析器实现 bbcode 是否有意义？例如：`[url=/foo/bar]click me![/url]`一旦输入关闭标签上的右括号，肯定会成功。但是在此期间用户会看到什么？使用正则表达式，我可以忽略不匹配的内容并将其视为普通文本以进行预览。使用正式语法，我不知道这是否可能，因为我依赖于从解析树创建 HTML，而解析失败的是……什么？

2.  我不清楚应该在哪里进行转换。在正式的基于 lex/yacc 的解析器中，我会有头文件和表示节点类型的符号。在 pegjs 中，我得到带有节点文本的嵌套数组。我可以将翻译后的代码作为 pegjs 生成的解析器的一个动作发出，但将解析器和发射器结合起来似乎是一种代码味道。但是，如果我打电话`PEG.parse.parse()`，我会得到这样的结果：

```
`[
       [
          "[",
          "img",
          "",
          [
             "/",
             "f",
             "o",
             "o",
             "/",
             "b",
             "a",
             "r"
          ],
          "",
          "]"
       ],
       [
          "[/",
          "img",
          "]"
       ]
    ]`
```

`给出如下语法：`

 ````
document
   = (open_tag / close_tag / new_line / text)*

open_tag
   = ("[" tag_name "="? tag_data? tag_attributes? "]")

close_tag
   = ("[/" tag_name "]") 

text
   = non_tag+

non_tag
   = [\n\[\]]

new_line
   = ("\r\n" / "\n") 
```

当然，我是在缩写语法，但你明白了。因此，如果您注意到，数组数组中没有上下文信息可以告诉我我拥有什么样的节点，即使解析器已经完成了这项工作，我也不得不*再次进行字符串比较。*我希望可以在解析期间定义回调并使用操作来运行它们，但是 Web 上关于如何做到这一点的信息很少。

我在吠叫错误的树吗？我应该回到正则表达式扫描并忘记解析吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T13:12:08.883

**第一个问题**（不完整文本的语法）：

你可以加

```
incomplete_tag = ("[" tag_name "="? tag_data? tag_attributes?)
//                         the closing bracket is omitted ---^ 
```

**after** `open_tag`并更改`document`为在末尾包含一个不完整的标签。诀窍是您为解析器提供**始终**解析所需的所有产品，但有效的产品首先出现。然后，您可以`incomplete_tag`在实时预览期间忽略。

**第二个问题**（如何包含动作）：

你在表达式之后写所谓的**动作。**动作是用大括号括起来的 Javascript 代码，允许在 pegjs 表达式之后，即在产生式中间！

在实践`{ return result.join("") }`中，几乎总是需要类似的操作，因为 pegjs 会拆分为单个字符。也可以返回复杂的嵌套数组。因此，我通常在语法头部的 pegjs 初始化程序中编写辅助函数以保持操作小。如果您仔细选择函数名称，则该操作是自记录的。

有关示例，请参阅[PEG for Python style indentation](https://stackoverflow.com/a/10708913/220060)。免责声明：这是我的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T20:07:02.397

关于你的第一个问题，我不得不说实时预览会很困难。您指出的有关解析器无法理解输入是“正在进行的工作”的问题是正确的。Peg.js 会告诉您错误在哪一点，所以也许您可以获取该信息并返回几句话并再次解析，或者如果缺少结束标记，请尝试在末尾添加它。

您问题的第二部分更容易，但之后您的语法看起来不会那么好。基本上你所做的是在每条规则上放置回调，例如

```
text
   = text:non_tag+ {
     // we captured the text in an array and can manipulate it now
     return text.join("");
   } 
```

目前，您必须在语法中内联编写这些回调。我现在在工作中做了很多这样的事情，所以我可能会向 peg.js 提出一个 pullrequest 来解决这个问题。但我不确定我什么时候有时间做这件事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T11:58:51.457

试试这个替换规则。你在正确的轨道上；你只需要告诉它组装结果。

text = result:non_tag+ { return result.join(''); }`

# android - 如何在片段中居中对话？

> ID：11268381
> 
> 赞同：2
> 
> 时间：2012-06-29T20:14:07.093
> 
> 标签：android, android-fragments, android-alertdialog

在我显示多个片段（例如列表片段和详细信息片段）并且其中一个片段显示警报对话框（DialogFrament）的场景中，我希望对话框位于片段的中心显示它，而不是在整个屏幕中居中。有没有办法在没有涉及屏幕尺寸、片段尺寸和位置等的大量像素计算的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T07:44:17.610

正如 Joe Simpson 所提到的，您可以使用 FrameLayout 来做到这一点。假设您要将对话片段放在您提到的详细信息片段的顶部。在活动布局中的详细信息片段周围放置一个 FrameLayout，然后将对话框片段也嵌入到 FrameLayout 中（使用 layout_gravity="center"）。设置 visibility="gone" 直到你需要它。例如：

```
 <FrameLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent" >

                <fragment
                    android:id="@+id/my_details_fragment"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    class="com.my.fragment.DetailsFragment" />

                <fragment
                    android:id="@+id/my_dialog_fragment"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    class="com.my.fragment.DialogFragment"
                    android:layout_gravity="center" />
            </FrameLayout> 
```

您也可以以编程方式启动它。在 xml 中放置一个持有者视图（例如 LinearLayout）：

```
 <FrameLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent" >

                <fragment
                    android:id="@+id/my_details_fragment"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    class="com.my.fragment.DetailsFragment" />

                <LinearLayout
                    android:id="@+id/myfragment"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center" />
            </FrameLayout> 
```

...然后在代码中替换它，如下所示：

```
 final MyDialogFragment dialog = MyDialogFragment.getInstance();

            // get an instance of FragmentTransaction from your Activity
            FragmentTransaction fragmentTransaction = getSupportFragmentManager()
                    .beginTransaction();
            fragmentTransaction.add(R.id.myfragment, dialog);
            fragmentTransaction.commit(); 
```

请注意，[DialogFragment 上](http://developer.android.com/reference/android/app/DialogFragment.html)的文档说可以像这样嵌入它：“如果需要，DialogFragment 仍然可以选择性地用作普通片段。如果您有一个片段在某些情况下应该显示为对话框并且其他嵌入在更大的 UI 中。”

# javascript - YUI 修改和检测 a 的变化

> ID：11268382
> 
> 赞同：0
> 
> 时间：2012-06-29T20:14:12.357
> 
> 标签：javascript, html, yui

当 div 的值发生变化时，我想看到一条警报消息。modify_div 正在修改此值。当我单击按钮时，此功能会修改 div，但不会显示警报“值已更改”。我错过了什么吗？

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"          "      http://www.w3.org/TR/html4/strict.dtd">

  <html>
  <head>
  <script src="http://yui.yahooapis.com/3.5.1/build/yui/yui-min.js"></script>
   <script>

 YUI().use('node', function (Y) {

 var demo = Y.one('#test');
 demo.on('click', function (e) {
    //alert('You clicked me');
});
});

 YUI().use('node','event', function (Y) {

var demo = Y.one('#variable-name');
demo.on('change', function (e) {
    alert('Value changed');
});
});

</script>

<script type="text/javascript">

function modify_div()
{
//var thevar = "This is a test";
var thevar = 7;

document.getElementById('variable-name').innerHTML = thevar;
}
</script>

</head>

<body>

<!-- Click me button -->
<input type="button" id="test" value="Click me" enabled="true" onclick="modify_div();">        </input>

</br>

<div id="variable-name" style="display:inline;">01010101</div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:24:27.243

基于[http://www.quirksmode.org/dom/events/change.html](http://www.quirksmode.org/dom/events/change.html)，

更改事件仅在其表单字段时触发

例如`input` `textarea`和`select`

所以当 div 的内容发生变化时不会触发 change 事件。

如果您将 div 替换为输入并更新其值，它将起作用。

另一个选项是在您更改变量值的地方手动触发事件

[http://tech.groups.yahoo.com/group/ydn-javascript/message/13216](http://tech.groups.yahoo.com/group/ydn-javascript/message/13216)

以下 SO 问题有答案，但需要 jQuery
[使用 jQuery 检测元素内容更改](https://stackoverflow.com/questions/1091661/detect-element-content-changes-with-jquery)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:43:14.627

@N30 给出了正确答案：div 没有更改事件。他提供了很好的选择，但没有 YUI 特定信息，所以我想用一个 YUI 插件的例子来扩展他的答案。

就像他解释的那样，基本思想是在 JavaScript 内存中保留一个值，并在您更改该值时触发一个事件。您可以通过扩展`Y.EventTarget`which 为您提供自定义事件来做到这一点：

```
YUI().use('node', 'plugin', function (Y) {
    function NodeValuePlugin(config) {
        // Boilerplate
        NodeValuePlugin.superclass.constructor.apply(this);

        // config.host is the Y.Node instance
        this._node = config.host;
        // we keep the value in a private property
        this._value = this._node.get('text');

        // we publish a 'change' event and set a default
        // function to run when the event is fired
        // This function will change the private property
        // and update the DOM
        // This means you can call e.preventDefault() and
        // stop the default behavior (the change of value)
        this.publish('change', {
            emitFacade: true,
            defaultFn: this._defValueChangeFn
        });
    }
    Y.extend(NodeValuePlugin, Y.EventTarget, {
        set: function (newVal) {
            // we want to do stuff only when the value changes
            if (newVal != this._value) {
                // instead of changing the DOM here,
                // we fire an event and let the event
                // do the work
                // We pass it the new and old values
                this.fire('change', {
                    newVal: newVal,
                    prevVal: this._value
                });
            }
            // make this method chainable
            return this;
        },
        get: function () {
            return this._value;
        },
        _defValueChangeFn: function (e) {
            // sync everything
            this._value = e.newVal;
            this._node.set('text', e.newVal);
        },
        // this is necessary boilerplate for plugins
        destroy: function () {}
    }, {
        // we can access the plugin from node[namespace]
        // in this case, node.value
        NS: 'value'
    });

    var node = Y.one('#test').plug(NodeValuePlugin);
    node.value.on('change', function (e) {
        console.log('Here\'s the old value: ' + e.prevVal);
        console.log('Here\'s the new value: ' + e.newVal);
    });
    // Freebie:
    // since we're using node.set('text', foo)
    // this prevents XSS vulnerabilities
    node.value.set('<a href="#">qwer</a>');

});​ 
```

您可以从YUI 网站的[插件用户指南](http://yuilibrary.com/yui/docs/plugin/)中了解更多关于插件的信息。

# magento-1.6 - Magento 购物车错误“最多可添加一件商品加入购物车。”

> ID：11268385
> 
> 赞同：0
> 
> 时间：2012-06-29T20:14:27.467
> 
> 标签：magento-1.6, magento

我检查了选项中的选项`system -> config -> Inventory`并将其设置为 1000，`Maximum Qty Allowed in Shopping Cart`我可以添加相同的产品，因此它会增加该产品的数量，但是如果我添加另一个产品，我会得到**购物车中允许的最大数量**，知道怎么做我修好了购物车，这样我就可以在购物车中添加更多物品了？

PS：我有**Magento 版本。1.6.1.0**

提前谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T14:14:01.830

我想建议您执行以下操作：

1.  首先检查系统 -> 配置 -> 所有商店的库存设置。通常，当不同商店级别的设置不合适时，用户会收到此类错误。
2.  但是，如果您在添加其他产品时遇到此错误，请转到产品的“库存”选项卡并检查“购物车中允许的最大数量”是否正确填写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-08T01:04:28.757

您的错误“最多可添加一件商品加入购物车”。是非常独特的，它实际上是一个自定义错误，不是 Magento 原生的。我在我的一个客户的一些代码中找到了它。您必须在几个文件中查找以下代码块：

```
 if ($cartItems >= 1) {
            Mage::getSingleton('core/session')->addError($this->__('Maximum one item to add the shopping cart.'));
            $this->_goBack();
            return;
       } 
```

和

```
 if ($params['product'] != $productId) {
        if ($cartItems >= 1) {
            $this->_getSession()->addError($this->__('Maximum one item to add the shopping cart.'));
            $this->_goBack();
            return;
       }
    } 
```

和

```
 if ($params['product'] != $productId) {
        if ($cartItems > 1) {
            Mage::getSingleton('checkout/session')->addError($this->__('Maximum one product to add the shopping cart.'));
            $this->_redirect('checkout/cart');
            return;
        }
    } 
```

和

```
 if ($item->getProductId() != $productId) {
           if ($cartItems >= 1) {
                $this->_getSession()->addError($this->__('Maximum one item to add the shopping cart.'));
                $this->_goBack();
                return;
            }
        } 
```

您可能会在`/app/code/local/{Name}/{Module}/controllers/Checkout/CartController.php` `/app/code/local/{Name}/{Module}/controllers/Checkout/OnepageController.php` `/app/code/local/{Name}/{Module}/controllers/Sales/OrderController.php` Mentionally 中找到它们，{Name} 不一定仅限于一个扩展名......我已经找到了多个，请在 /app/code/local 中的所有文件中执行搜索以确保. 为了“修复”它，或者将“1”更改为`if ($cartItems > 1) {`其他（更高）数字，或者将 if 语句注释掉并将其替换为`if(false) {`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-09-02T11:05:50.623

```
 if ($params['product'] != $productId) {
        if ($cartItems > 1) {
            Mage::getSingleton('checkout/session')->addError($this->__('Maximum one product to add the shopping cart.'));
            $this->_redirect('checkout/cart');
            return;
        }
    } 
```

# c - 在c函数中创建和访问fortran动态数组

> ID：11268387
> 
> 赞同：4
> 
> 时间：2012-06-29T20:14:29.663
> 
> 标签：c, memory, malloc, fortran, fortran77

我可以在 Fortran（77 标准）中创建和使用动态二维数组。现在，我想在 Fortran 程序的 C 函数中创建我的动态二维数组（使用我们说的“malloc”），并能够通过 Fortran 程序访问它。在 Fortran 中，我还希望能够像 a(1:n,2) 或 a(1,2) 那样做某事，并且还能够从 Fortran 子例程中传递和检索我的数组。请你给我举个例子，花点时间解释一下（如果可能的话，我真的很感激）记忆将如何排列？万分感谢！此外，如果二维不能直接工作，我可以在 C 函数中创建一维数组，但是从 Fortran 访问它，因为它是一个二维数组......谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:24:39.590

最重要的区别是索引顺序。Fortran 使用数学符号，因此第一个索引是列索引，第二个索引是行。C 不同，第一个索引是行。

宏解释了这一点

```
#define AccessFortranArray(ArrayName, i,j) ArrayName[j][i] 
```

要在 C 中执行 a(1:n, 2) 之类的操作，只能创建临时数组并在循环中提取元素（不包括要提取一系列行的情况 - 在这种情况下，您可以在 C 中使用指针算术）

C <-> Fortran 互操作有很好的参考，比如[这个](http://www.math.utah.edu/software/c-with-fortran.html)

这里还有一个多维样本：[Passing Array To/From Fortran](http://arnholm.org/software/cppf77/cppf77.htm#Section3.5.3)

“还有一件事”。

C 函数的名称必须在末尾包含下划线才能在 Fortran 中可见。它们也必须是小写的。这都是指 gcc/gfortran 对。

还有一个。你已经告诉过你能够传递数组，所以你知道（Jim Balter 在评论中说）Fortran 数组是基于 1 的，而 C 数组是基于 0 的。

第三个。如果您只需要一大块数据，那么不要弄乱链接设置和函数调用约定，而是使用 COMMON 块。

像这样

```
/* C Code */

extern struct
{
   double arr[100];
} thearr_; 
```

和 Fortran：

```
real*8 arr(100)

common/TheArr/ arr 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T20:46:39.990

不，您不能在 FORTRAN 77 标准中创建动态数组。

您也不能使用 malloc 创建 Fortran“动态”数组，任何尝试从 Fortran 释放它都会导致崩溃。（您当然可以以正常方式将其用作静态数组。）

此外，如果您明确要求 FORTRAN 77，请不要使用像 a(1:n,2) 这样的符号。本标准不支持。

在 Fortran 2003 中有[iso_c_binding](http://gcc.gnu.org/onlinedocs/gfortran/Interoperability-with-C.html)，但在 FORTRAN 77 中不存在类似的东西，您只能传递假定大小的数组并处理编译器使用的任何名称修改（即来自 C 的 Fotran 过程名称中的尾随下划线）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T22:34:12.053

为什么你必须在 FORTRAN 77 中做这些事情？它们在 Fortran 2003 或带有 ISO C 绑定的 Fortran 95 中要容易得多。几乎所有当前 Fortran 95 级别的 Fortran 编译器都带有 ISO C 绑定。该组合提供了您想要的功能，作为语言标准的一部分，因此以独立于平台和编译器的方式。

如果您只需要创建动态数组，您可以直接在 Fortran 95 中使用可分配数组来完成。如果您有不想更改的 FORTRAN 77 代码，您可以编写一些 Fortran 95 代码并将两者混合。您可以将在 Fortran 95 中创建的可分配数组传递给另一个未将其声明为可分配的 Fortran 过程。

如果出于某种原因需要在 C 中创建数组，您可以使用 ISO C 绑定来描述 Fortran 中的 C 例程。在 C 中使用 malloc 创建的数组以 Fortran 类型 C_PTR 传递给 Fortran。然后使用 Fortran 内部子例程 c_f_pointer 将该存储连接到 Fortran 数组。之后使用 Fortran 数组，它与 Fortran 数组相同。

确实，多维数组的索引顺序在语言之间是不同的。这是因为 Fortran 是一种列优先语言，而 C 是一种行优先语言。但是，Fortran 数组不必是一个索引。这只是默认设置。您可以更改声明中的起始索引：实数数组 (0:99)。或者对于带有指针边界重新分配的 c_f_pointer 的指针数组设置：array (0:99) => array

# sql - 为给定 SQL 查询生成最坏情况数据的工具

> ID：11268388
> 
> 赞同：2
> 
> 时间：2012-06-29T20:14:30.167
> 
> 标签：sql, database, performance, testing, optimization

我想用大量数据填充一些表，以便在最坏的情况下（好吧，尽可能接近它）凭经验测试 SQL 查询的性能。

我考虑使用随机值。但这需要手动调整才能接近最坏的情况。不受约束的随机值在最坏的情况下没有好处，因为它们往往是唯一的——在这种情况下，单个列上的索引应该与复合索引一样好。另一方面，从太小的集合中选择的随机值将导致大部分行被返回，这是无趣的，因为它反映的不是*搜索*性能，而是*列表*性能。

我也考虑过只看 EXPLAIN PLAN，但这不是经验性的，而且解释也会有所不同，部分取决于您已经拥有的数据，而不是最坏的情况。

**是否有一种工具可以分析给定的 SQL 查询（以及数据库模式和理想的索引），然后生成一个大型数据集（给定大小），这将使查询尽可能接近最坏情况？**

任何 RDBMS 都可以。

我也对获得这种对最坏情况行为的洞察力的替代方法感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:35:39.023

**简短的回答**：没有最坏的情况，因为每个情况都可以变得更糟，通常只是通过添加更多具有相同分布的数据。

**长答案**：

我建议您不要寻找最坏的情况，而是寻找从生产数据开始的“夸张的现实场景”，定义您认为的大量实体（分别针对每个表），乘以一个因子两个或三个，并从您手动拥有的生产数据中生成数据。

例如，如果您的生产数据包含来自 150 个汽车制造商的 1000 个汽车型号，并且您决定可能需要来自 300 个制造商的 10000 个型号，您将首先将引用表（制造商）中的记录数加倍，然后生成“副本”现有的 1000 种汽车模型参考这些生成的制造商再制造 1000 辆汽车，然后每个现有的汽车再生产 4 辆汽车，每次都根据具体情况的决策复制现有的价值分布。这意味着某些列中有新的唯一值，而其他列中的值只是简单地复制。

完成后不要忘记重新生成统计信息。我到底为什么要这么说？因为您想在给定查询、数据和模式的情况下测试可能的*最佳*查询计划，并对其进行优化*。*

理由：查询不是算法。查询优化器不仅根据查询选择合适的查询计划，还根据表的大小、索引覆盖率、运算符选择性等信息来选择合适的查询计划。您对了解选择不当的计划或执行不切实际的数据库的计划并不真正感兴趣。这甚至会诱使您添加选择不当的索引，而选择不当的索引会使生产性能变差。您想了解和测试针对现实的（尽管有大量行）的*最佳计划会发生什么。*

虽然您可以使用 1,000,000 个汽车模型进行测试，但对于您的特定数据库架构和查询而言，此类生产内容很可能是科幻小说。但是，使用与数据库中汽车制造商数量相等的汽车型号数量进行测试的用处会更小。虽然这样的分布可能碰巧对您的应用程序来说是*最糟糕*的分布，但您几乎不会从基于它的指标中学到任何东西。

# vb.net - 单元测试犀牛模拟功能（byRef byRef）

> ID：11268391
> 
> 赞同：0
> 
> 时间：2012-06-29T20:14:38.403
> 
> 标签：vb.net, unit-testing, mocking, rhino-mocks

我有一个`TryGetValues`接收 TKey 和 ByRef 一个 TValue 的函数，当我模拟这个函数时我需要返回一些东西。我需要 TValue 的值，因为稍后在我测试的方法中我将需要它。我用来测试它的方法是：

```
Dim agent = Mock.Get(Of ICalcAgent)()
Dim connections As IList(Of ICalcMapConnection) = Nothing
agent.CalcMap = Mock.Get(Of ICalcMap)()
agent.CalcMap.Stub(Function(x) x.TryGetCategoryChildren(agent, connections)).IgnoreArguments().OutRef(agent, connections).Repeat.Once().Return(True) 
```

在这种情况下，我需要 Connections 成为某种东西。我如何用 Rhino 做到这一点？

```
Sub AddConnection(ByRef cnn As ICalcMapConnection)
Sub AssignWeightToConnections()
Function TryGetCategoryParents(ByRef agent As ICalcAgent, ByRef parentsList As IList(Of ICalcMapConnection)) As Boolean
Function TryGetCategoryChildren(ByRef agent As ICalcAgent, ByRef childrenList As IList(Of ICalcMapConnection)) As Boolean
ReadOnly Property MapType() As MapType
Function GetMaxWeight(ByVal categoryId As Integer) As Integer
Function HasConnection(ByVal connection As ICalcMapConnection) As Boolean
Function HasCategory(ByVal categoryId As Integer) As Boolean
Function GetLeafCategories() As IEnumerable(Of Integer)
Function GetCategoryDefinition(ByRef agent As Interfaces.ICalcAgent) As ICalcMapConnection
Function GetLeafConnection(ByVal categoryId As Integer) As ICalcMapConnection
Sub RegisterCostCollectorCategory(ByVal connection As ICalcMapConnection)
Sub RegisterWBSCategory(ByVal connection As ICalcMapConnection)
Sub RegisterManualCategory(ByVal connection As ICalcMapConnection)

Function GetCostCollectorLeafCategories() As IList(Of ICalcMapConnection)
Function GetWBSLeafCategories() As IList(Of ICalcMapConnection)
Function GetManualCategories() As IList(Of ICalcMapConnection)

Sub AddWbs(ByVal wbsId As Integer)
Function HasWbs(ByVal wbsId As Integer) As Boolean

Sub AddCostCollector(ByVal costCollectorId As Integer)
Function HasCostCollector(ByVal costCollectorId As Integer) As Boolean 
```

# c++ - 这个程序会泄漏内存吗？

> ID：11268395
> 
> 赞同：-2
> 
> 时间：2012-06-29T20:15:01.563
> 
> 标签：c++, windows

由于返回进程ID的新用法？在调试我的应用程序的过程中，我如何检查内存何时开始泄漏？（解释部分的这个长度检查真的很烂=P）

```
#include "stdafx.h"
#include "Process.h"
#include <TlHelp32.h>
#include <iostream>

DWORD GetProcessId( const wchar_t* szProcess )
{
    if( szProcess )
    {
        HANDLE hSnapshot = CreateToolhelp32Snapshot( TH32CS_SNAPPROCESS, 0 );
        PROCESSENTRY32 *pe32 = new PROCESSENTRY32();
        memset( pe32, 0, sizeof( PROCESSENTRY32 ) );
        pe32->dwSize = sizeof( PROCESSENTRY32 );
        //Process32First( hSnapshot, pe32 );
        while( Process32Next( hSnapshot, pe32 ) )
        {
            if( pe32->szExeFile && !wcscmp( szProcess, pe32->szExeFile ) )
            {
                CloseHandle( hSnapshot );
                return( pe32->th32ProcessID ); //   std::wcout << pe32->szExeFile << std::endl;
            }
        }
        CloseHandle( hSnapshot );
    }
    return 0;
}

HANDLE GetProcessHandle( DWORD dwProcessId )
{
    if( dwProcessId )
        return( OpenProcess( PROCESS_VM_READ | PROCESS_VM_WRITE, 0, dwProcessId ) );

    return 0;
}

bool WriteExternProcessMemory( HANDLE hProcess, void* pAddr, size_t uSize, const char* szWrite, LPCVOID outBuffer )
{
    if( pAddr && szWrite && hProcess )
    {
        DWORD dwOldProtect;
        if( !VirtualProtectEx( hProcess, pAddr, uSize, PAGE_EXECUTE_READWRITE, &dwOldProtect ) )
            return( !WriteProcessMemory( hProcess, pAddr, outBuffer, uSize, NULL ) );
    }

    return false;
} 
```

-编辑，用法是：

```
void *pRecv;
WriteExternProcessMemory( GetProcessHandle( GetProcessId( _T( "notepad.exe" ) ) ), (void*)0x401000, 2, "\x40\x40",  &pRecv ); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T20:18:25.037

这是泄漏：

```
PROCESSENTRY32 *pe32 = new PROCESSENTRY32(); 
```

更好的使用：

```
PROCESSENTRY32 pe32 = {0};
pe32.dwSize = sizeof( PROCESSENTRY32 );
//Process32First( hSnapshot, pe32 );
while( Process32Next( hSnapshot, &pe32 ) )
... 
```

此外，您没有关闭在 处创建的句柄`GetProcessHandle`，这也是一个泄漏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T20:18:59.217

是的你是对的。正如您的程序所做的那样，分配内存而不释放它，构成内存泄漏。

您可以使用[内存泄漏检测器](http://www.codeproject.com/Articles/9815/Visual-Leak-Detector-Enhanced-Memory-Leak-Detectio)查找程序中的泄漏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T20:34:51.057

Valgrind 是一个很好的工具来告诉你内存泄漏。如果您使用调试符号（GCC 的 -g）进行编译，它甚至会告诉您泄漏发生在哪一行！

[http://valgrind.org/](http://valgrind.org/)

# postgresql - 对表格的每 3 行求和

> ID：11268398
> 
> 赞同：7
> 
> 时间：2012-06-29T20:15:28.753
> 
> 标签：postgresql, sum, rows, group-by, window-functions

我有以下查询来计算每分钟的所有数据。

```
$sql= "SELECT COUNT(*) AS count, date_trunc('minute', date) AS momento
FROM p WHERE fk_id_b=$id_b GROUP BY date_trunc('minute', date) 
ORDER BY momento ASC"; 
```

我需要做的是得到每行的计数与过去 2 分钟的计数的总和。

```
For example with the result of the $sql query above
|-------date---------|----count----|
|2012-06-21 05:20:00 |      12     |
|2012-06-21 05:21:00 |      14     |
|2012-06-21 05:22:00 |      10     |
|2012-06-21 05:23:00 |      20     |
|2012-06-21 05:24:00 |      25     |
|2012-06-21 05:25:00 |      30     |
|2012-06-21 05:26:00 |      10     |  

I want this result:

|-------date---------|----count----|
|2012-06-21 05:20:00 |      12     |   
|2012-06-21 05:21:00 |      26     |     12+14
|2012-06-21 05:22:00 |      36     |     12+14+10
|2012-06-21 05:23:00 |      44     |     14+10+20
|2012-06-21 05:24:00 |      55     |     10+20+25
|2012-06-21 05:25:00 |      75     |     20+25+30
|2012-06-21 05:26:00 |      65     |     25+30+10 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T20:28:31.203

[`lag()`窗口函数](http://www.postgresql.org/docs/current/interactive/functions-window.html#FUNCTIONS-WINDOW-TABLE)（也在[SQL Fiddle](http://www.sqlfiddle.com/#!1/1897b/1)上）不是那么棘手：

```
CREATE TABLE t ("date" timestamptz, "count" int4);
INSERT INTO t VALUES
('2012-06-21 05:20:00',12),
('2012-06-21 05:21:00',14),
('2012-06-21 05:22:00',10),
('2012-06-21 05:23:00',20),
('2012-06-21 05:24:00',25),
('2012-06-21 05:25:00',30),
('2012-06-21 05:26:00',10);

SELECT *,
    "count"
    + coalesce(lag("count", 1) OVER (ORDER BY "date"), 0)
    + coalesce(lag("count", 2) OVER (ORDER BY "date"), 0) AS "total"
  FROM t; 
```

1.  我已经双引号`date`和`count`列，因为这些是保留字；
2.  `lag(field, distance)`给我远离当前行的`field`列行的值，因此第一个函数给出前一行的值，第二个调用给出前一行的值；`distance`
3.  `coalesce()`需要避免函数的`NULL`结果`lag()`（对于查询中的第一行，没有“前一个”行，因此它是`NULL`），否则`total`也将是`NULL`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-30T14:20:21.273

这是当前行和前 N 行的值总和的更通用的解决方案（在您的情况下为 N = 2）。

```
SELECT "date", 
sum("count") OVER (order by "date" ROWS BETWEEN 2 preceding AND current row)
FROM t
ORDER BY "date"; 
```

您可以在 0 和“无界”之间更改 N。这种方法让您有机会在您的应用程序“过去 N 分钟的计数”中拥有一个参数。此外，如果超出范围，则无需处理默认值。

您可以在 PostgreSQL 文档 ( [4.2.8\. Window Function Calls](http://www.postgresql.org/docs/current/interactive/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS) )中找到更多相关信息

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-29T21:14:01.323

[@vyegorov 的回答](https://stackoverflow.com/a/11268542/939860)主要涵盖了它。但我的抱怨多于评论。

1.  根本不要使用像和这样的[保留字](http://www.postgresql.org/docs/current/interactive/sql-keywords-appendix.html)作为标识符*。*PostgreSQL 允许这两个特定的关键字作为标识符——除了每个 SQL 标准。但这仍然是不好的做法。*您可以*使用双引号内的任何内容作为标识符这一事实，甚至不是一个好主意。最重要的是，a的名称具有误导性。`date``count`**`"; DELETE FROM tbl;"``"date"``timestamp`**

***   错误的数据类型。示例显示[`timestamp`](http://www.postgresql.org/docs/current/interactive/datatype-datetime.html)，不是`timestamptz`。在这里没有什么区别，但仍然具有误导性。

    *   你不需要`COALESCE()`。使用[窗口函数`lag()`，`lead()`](http://www.postgresql.org/docs/current/interactive/functions-window.html#FUNCTIONS-WINDOW-TABLE)您可以提供默认值作为第三个参数：** 

 **基于此设置：

```
CREATE TABLE tbl (ts timestamp, ct int4);
INSERT INTO tbl VALUES
  ('2012-06-21 05:20:00', 12)
, ('2012-06-21 05:21:00', 14)
, ('2012-06-21 05:22:00', 10)
, ('2012-06-21 05:23:00', 20)
, ('2012-06-21 05:24:00', 25)
, ('2012-06-21 05:25:00', 30)
, ('2012-06-21 05:26:00', 10); 
```

询问：

```
SELECT ts, ct + lag(ct, 1, 0) OVER (ORDER BY ts)
              + lag(ct, 2, 0) OVER (ORDER BY ts) AS total
FROM   tbl; 
```

* * *

或者**更好**：使用单个`sum()`作为窗口聚合函数和[自定义窗口框架](http://www.postgresql.org/docs/current/interactive/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS)：

```
SELECT ts, sum(ct) OVER (ORDER BY ts ROWS BETWEEN 2 PRECEDING AND CURRENT ROW)
FROM   tbl; 
```

结果相同。
有关的：

*   [按期末而不是开始日期分组](https://stackoverflow.com/questions/32470043/group-by-end-of-period-instead-of-start-date/32470385#32470385)**

# sql - 选择视图的列

> ID：11268403
> 
> 赞同：36
> 
> 时间：2012-06-29T20:15:59.427
> 
> 标签：sql, tsql, view, sql-view

我正在尝试以`view`与选择 from 类似的方式选择a 的列名`information_schema.columns`。

我似乎找不到办法做到这一点。以前有没有其他人这样做过，或者知道这是否可能？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-06-29T20:19:57.060

information_schema.columns.Table_name（至少在 Sql Server 2000 下）包括视图，所以只需使用

```
SELECT * FROM information_schema.columns WHERE table_name = 'VIEW_NAME' 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-06-29T20:18:33.723

试试这个：

```
SELECT *
FROM sys.views 
```

这为您提供了这样的视图 - 如果您需要列，请使用：

```
SELECT * 
FROM sys.columns
WHERE object_id = OBJECT_ID('dbo.YourViewNameHere') 
```

不确定如何使用- 我从不使用它，因为与模式目录视图`INFORMATION_SCHEMA`相比，它感觉相当“笨拙”且不直观。`sys`

有关所有可用视图的所有详细信息，以及它们可能包含的信息，请参阅[目录视图上的 MSDN 文档。](http://msdn.microsoft.com/en-us/library/ms174365%28v=sql.100%29.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-04-27T11:25:06.457

我发现这种方式适用于视图（SQL 2017）。我无法从`information_schema.columns`and获取数据`sys.columns`：

```
 SELECT * FROM sys.all_columns WHERE object_id = OBJECT_ID('<view_name>') 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-09-24T05:28:25.103

INFORMATION_SCHEMA 视图保存有关数据库中对象的元数据。INFORMATION_SCHEMA.COLUMNS 使用底层 sys 表来检索元数据（检查 sp_helptext 'master.Information_schema.columns' ）。您可以使用这个更简单的查询来选择在任何视图中使用的列名。

```
SELECT col.name 
FROM <db_name>.sys.columns col, <db_name>.sys.views vew
WHERE col.object_id = vew.object_id
AND vew.name = '<view_name>' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-15T17:54:33.103

```
SELECT distinct VIEW_NAME
  ,TABLE_SCHEMA
  ,TABLE_NAME
  ,COLUMN_NAME
FROM   INFORMATION_SCHEMA.VIEW_COLUMN_USAGE
--WHERE  TABLE_SCHEMA = 'Person'
ORDER BY
   VIEW_NAME
  ,TABLE_SCHEMA
  ,TABLE_NAME
  ,COLUMN_NAME 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-20T19:13:30.850

```
select schema_name(v.schema_id) as schema_name,
   object_name(c.object_id) as view_name,
   c.column_id,
   c.name as column_name,
   type_name(user_type_id) as data_type,
   c.max_length,
   c.precision
from sys.columns c
join sys.views v 
 on v.object_id = c.object_id
order by schema_name,
     view_name,
     column_id; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-08-13T00:22:24.683

我需要创建类似的东西，所以我阐述了 Ghost 的建议。我需要按第一个序列降序为数据库顺序中的每个视图创建前 1000 个视图。

```
SELECT CONCAT (
              'CREATE VIEW dbo.temp_',
              v.name,
              ' AS select top (1000) * from ',
              OBJECT_SCHEMA_NAME (v.object_id),
              '.',
              v.name,
              ' ORDER BY [',
              c.COLUMN_NAME,
              '] DESC;'
          ) AS viewName
FROM sys.views AS v
    LEFT OUTER JOIN INFORMATION_SCHEMA.COLUMNS AS c
             ON v.name = c.TABLE_NAME
WHERE c.ORDINAL_POSITION = 1; 
```

# ios - Xcode 单元测试并将数据写入磁盘

> ID：11268417
> 
> 赞同：4
> 
> 时间：2012-06-29T20:17:04.210
> 
> 标签：ios, xcode, unit-testing

我正在尝试编写逻辑测试来调试将图像数据保存到磁盘的方法。我使用以下几行将图像数据写入文档目录：

```
docspath = [[NSString alloc] initWithString:[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, TRUE) objectAtIndex:0]];
fullpath = [[NSString alloc] initWithFormat:@"%@/%@", docspath, _name]; 
BOOL written = [fileData writeToFile:fullpath options:NSDataWritingAtomic error:&dataerror]; 
```

除了没有写入数据并且错误描述没有返回这样的文件或目录。我在 iOS 5.1 模拟器的测试目标下运行此代码。我是否需要创建中间目录才能访问文档目录，或者在测试目标下写入磁盘是否存在其他问题？

返回的错误：

```
2012-06-29 16:13:31.819 otest[4597:7b03] /Users/myaccount/xcode_projects/myproject/myproject/myfolder/MMFileManager.m - 285: Error Domain=NSCocoaErrorDomain Code=4 "The operation couldn’t be completed. (Cocoa error 4.)" UserInfo=0x1e1e3a0 {NSUserStringVariant=Folder, NSFilePath=/Users/myaccount/Library/Application Support/iPhone Simulator/5.1/Documents/mmLogo.png, NSUnderlyingError=0x1e1b430 "The operation couldn’t be completed. No such file or directory"} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T08:49:09.447

单元测试不在您的应用程序中，因此您无法在单元测试中访问 Documents 目录。

参考[iPhone 单元测试中的 NSHomeDirectory](https://stackoverflow.com/questions/8378712/nshomedirectory-in-iphone-unit-test)

# java - 运行 Selenium-Java 测试时自动切换浏览器

> ID：11268418
> 
> 赞同：2
> 
> 时间：2012-06-29T20:17:12.680
> 
> 标签：java, selenium, webdriver

我目前正在开发一个使用 Java、Selenium 和 Testng 的项目。我的总体目标是在不同的网络浏览器上测试网页的功能。我的 Selenium 代码可以正常工作，并且能够在 Chrome 和 Firefox 上运行测试。但是，我必须手动更改代码才能切换浏览器。我通过注释掉`driver = new ChromeDriver();` 我想编辑我的代码来做到这一点，以便测试在 Firefox 中运行，当测试完成时，在 Chrome 中启动测试。有人可以指导我正确的方向吗？

这是我的代码的示例：

```
WebDriver driver = null;
Selenium selenium = null;

@BeforeSuite
public void setup() throws Exception {

    ///    Chrome Driver  ///
    System.setProperty("webdriver.chrome.driver", "mac/chromedriver.exe");
    //driver = new ChromeDriver();

    ///    Firefox Driver  ///
    driver = new FirefoxDriver();

}

@Test
public void testGoogle() throws Exception {

selenium = new WebDriverBackedSelenium(driver,"URL"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:29:08.783

可能有很多方法可以实现这一目标。

在设置中，您可以读取一个属性，并在此基础上实例化正确的驱动程序。

```
String driverType = System.getProperty("driverType");
if ("firefox".equals(driverType))
   driver = new FirefoxDriver()..... 
```

您可以运行测试两次，一次使用 firefox 属性，然后使用 chrome 属性。

另一种选择是将所有测试保留在一个类中。然后通过两个类扩展这个类，一个用于 Firefox 设置，另一个用于 chrome 设置。然后，您可以在一个套件中运行两个子类测试。他们会一个接一个地跑。

# php - Internet Explorer：发布数据仅出现在页面刷新或浏览器后退按钮上，而不是标记链接

> ID：11268424
> 
> 赞同：0
> 
> 时间：2012-06-29T20:18:04.457
> 
> 标签：php, html, internet-explorer

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:39:26.077

我认为这是 IE 缓存以前页面的问题；如果您可以修改服务器配置，以便将无缓存请求传递给浏览器，它应该修复它。

# php - mysql_error 奇怪的行为（总是返回空字符串）

> ID：11268425
> 
> 赞同：1
> 
> 时间：2012-06-29T20:18:07.767
> 
> 标签：php, mysql

我得到了这种奇怪的行为：

想象一下，您有一个简单地创建与 MySQL 的连接并返回连接链接的类。

```
class Connection {

    private $conn;
    public function __construct() {
        $this->conn = mysql_connect(.....);
    }
    public function getConn() {
        return $this->conn;
    }   

} 
```

现在，如果我尝试使用连接链接（当然是实例化 Connection 和 using `$instance->getConn()`），我可以在函数中使用该链接`mysql_query`，但我不能在`mysql_error`and中使用它`mysql_errno`（它们总是分别返回`''`and `0`，即使执行的查询是绝对错误的）。

但！！如果我将链接创建放在 , 和 的同一类中，`mysql_query`则一切正常！`mysql_errno``mysql_error`

有没有人有同样的问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-29T20:22:36.147

```
mysql 
```

已弃用，请考虑使用

```
mysqli 
```

[http://www.php.net/manual/en/mysqli.query.php](http://www.php.net/manual/en/mysqli.query.php)

# javascript - 如何从 URL 重新格式化我的数据响应

> ID：11268426
> 
> 赞同：0
> 
> 时间：2012-06-29T20:18:10.207
> 
> 标签：javascript, jquery, json

我从 URL 得到的数据格式是这样的：

```
#RES#[{"status":"Stopped \/ Idle","val":17.469444444444,"unit":"617-0003"},{"status":"Working","val":0,"unit":"617-0003"},{"status":"Headland Turning","val":0,"unit":"617-0003"},{"status":"Transport","val":0.15333333333333,"unit":"617-0003"}] 
```

我想将其重新格式化为：

```
[
    {
    "status": "Stopped \/ Idle",
    "val": 17.469444444444},
{
    "status": "Working",
    "val": 0},
{
    "status": "Headland Turning",
    "val": 0},
{
    "status": "Transport",
    "val": 0.15333333333333}
] 
```

笔记：

1.  删除开始的字符串`#RES#`
2.  删除字段`"unit"`

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:27:06.873

```
var str = '#RES#[{"status":"Stopped \/ Idle","val":17.469444444444,"unit":"617-0003"},{"status":"Working","val":0,"unit":"617-0003"},{"status":"Headland Turning","val":0,"unit":"617-0003"},{"status":"Transport","val":0.15333333333333,"unit":"617-0003"}]';
str = str.slice(5);

var json = JSON.parse(str);
console.log(json);
for (var i = 0; i < json.length; i++) {
    delete json[i].unit;
}

console.log(json); 
```

# python - Python TypeErrors：“'list' object is not callable”和“'function' object is unsubscriptable”

> ID：11268429
> 
> 赞同：1
> 
> 时间：2012-06-29T20:18:26.090
> 
> 标签：python, genetic-algorithm, python-2.6, typeerror

我有以下代码：

```
from random import randint,choice

add=lambda x:lambda y:x+y
sub=lambda x:lambda y:x-y
mul=lambda x:lambda y:x*y

ops=[[add,'+'],[sub,'-'],[mul,'*']]

def gen_expression(length,left,right):
    expr=[]
    for i in range(length):
        op=choice(ops)
        expr.append([op[0](randint(left,right)),op[1]])
    return expr

def eval_expression (expr,x):
    for i in expr:
           x=i[0](x)
    return x

def eval_expression2 (expr,x):
    for i in expr:
           x=i(x)
    return x
[snip , see end of post]
def genetic_arithmetic(get,start,length,left,right):
    batch=[]
    found = False
    for i in range(30):
        batch.append(gen_expression(length,left,right))

    while not found:
        batch=sorted(batch,key=lambda y:abs(eval_expression(y,start)-get))
        print evald_expression_tostring(batch[0],start)+"\n\n"

                #combine                        
        for w in range(len(batch)):
            rind=choice(range(length))
            batch.append(batch[w][:rind]+choice(batch)[rind:])

            #mutate
        for w in range(len(batch)):
            rind=choice(range(length))
            op=choice(ops)
            batch.append(batch[w][:rind]+[op[0](randint(left,right)),op[1]]+batch[w][rind+1:])

        found=(eval_expression(batch[0],start)==get)

    print "\n\n"+evald_expression_tostring(batch[0],start) 
```

当我尝试使用 eval_expression 作为排序键调用genetic_artihmetic 时，我得到了这个：

```
 Traceback (most recent call last):
  File "<pyshell#113>", line 1, in <module>
    genetic_arithmetic(0,10,10,-10,10)
  File "/home/benikis/graming/py/genetic_number.py", line 50, in genetic_arithmetic
    batch=sorted(batch,key=lambda y:abs(eval_expression(y,start)-get))
  File "/home/benikis/graming/py/genetic_number.py", line 50, in <lambda>
    batch=sorted(batch,key=lambda y:abs(eval_expression(y,start)-get))
  File "/home/benikis/graming/py/genetic_number.py", line 20, in eval_expression
    x=i[0](x)
TypeError: 'function' object is unsubscriptable 
```

当我尝试使用 eval_expression2 作为排序时，错误是这样的：

```
Traceback (most recent call last):
  File "<pyshell#114>", line 1, in <module>
    genetic_arithmetic(0,10,10,-10,10)
  File "/home/benikis/graming/py/genetic_number.py", line 50, in genetic_arithmetic
    batch=sorted(batch,key=lambda y:abs(eval_expression2(y,start)-get))
  File "/home/benikis/graming/py/genetic_number.py", line 50, in <lambda>
    batch=sorted(batch,key=lambda y:abs(eval_expression2(y,start)-get))
  File "/home/benikis/graming/py/genetic_number.py", line 25, in eval_expression2
    x=i(x)
TypeError: 'list' object is not callable 
```

据我所知，我的猜测是 sorted() 正在尝试对子列表进行递归排序，也许？这里到底发生了什么？

Python 版本是 2.6 - debian stable repos 中的版本。

[剪辑]在这里：

```
def expression_tostring(expr):
    expr_str=len(expr)*'('+'x '
    for i in expr :
        if i[1]=='*':
            n=i[0](1)
        else:
            n=i[0](0)
        expr_str+=i[1]+' '+str(n)+') '

    return expr_str

def evald_expression_tostring(expr,x):
    exprstr=expression_tostring(expr).replace('x',str(x))
    return exprstr+ ' = ' + str(eval_expression(expr,x)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:24:20.603

```
 x=i[0](x)  #here i is a function so you can't perform indexing operation on it      

    x=i(x) #here i is a list so you can't call it as a function 
```

在这两种情况下， 的值`i`都是从中获取的`expr`，可能`expr`包含与您在此处假设的不同类型的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:33:31.960

试试这个修改：

```
def gen_expression(length,left,right):
    expr=[]
    for i in range(length):
        op=choice(ops)
        expr.append([op[0], randint(left,right),op[1]])
    return expr

def eval_expression (expr,x):
    for i in expr:
           x=i[0](i[1])
    return x 
```

您已经`expr.append([op[0](randint(left,right)),op[1]])`将调用函数的返回值放入第 0 个索引中。

# php - 从 mysql 检查的复选框

> ID：11268431
> 
> 赞同：2
> 
> 时间：2012-06-29T20:18:31.313
> 
> 标签：php, mysql, checkbox, while-loop

我遇到了一个问题。我有一个表单，我正在尝试添加一个编辑页面以插入到 mysql 中。我从一张桌子上得到所有房间，然后我必须检查它们是否在另一张桌子上“检查”。

```
Table 1 (HotelRooms):
ID | HotelRoom | Hid
---------------------
1  | Standard  | 20
2  | Deluxe    | 20
2  | Basic     | 20

Table 2 (HotelPromos)
ID | Promo | Rooms | Hid
-------------------------
1  | 10%   | deluxe, standard | 20 
```

现在在我的表格中，我首先需要找到属于 Hotel with Hid 20 的所有房间。所以这是我的选择声明：

```
<?php 
$getRooms = mysql_query("SELECT HotelRoom FROM HotelRooms WHERE HotelId = '$hid'") or die(mysql_error());
$rr = 1;
$numRooms = mysql_num_rows($getRooms);
if($numRooms == 0){
    echo "Lo sentimos pero no hay habitaciones registrados para este hotel. Favor de agregar habitacion para poder agregar una promocion.";
    }
while($ro = mysql_fetch_array($getRooms)){
    $roomName = $ro['HotelRoom'];
    ?>
    <input type="checkbox" name="room<?php echo $rr ?>" /><?php echo $roomName ?>
    <?php
    $rr++;
    }
?> 
```

有谁知道我如何检查 HotelPromos 表以查看它是否在“房间”列下并添加一个已选中的 =“已检查”？

任何帮助将不胜感激！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T00:46:54.040

I'm assuming that Basic's ID is actually 3 not 2 and that is a typo.

First of all, in HotelPromos, you should use the room IDs (1, 2) and not the names (Deluxe, Standard).

Second, you should split HotelPromos into two tables to comply with "First Normal Form", part of [Database Normalization](http://en.wikipedia.org/wiki/Database_normalization).

Yes, this is a little more difficult to design and you will have to modify your code, but it makes complex queries **much** easier to write.

```
PromoCodes
ID | Promo
----------
1  | 10%

HotelPromos
RoomID | PromoID
----------------
1      | 1
2      | 1 
```

Now you can get all rooms matching a hotel ID

```
SELECT HotelRooms.ID, HotelRooms.HotelRoom as Name, HotelPromos.PromoID
    FROM HotelRooms
    LEFT JOIN HotelPromos
        ON HotelRooms.ID = HotelPromos.RoomID
    WHERE HotelId = '$hid' 
```

The `LEFT JOIN` means I want *all* rooms in Hotel 20 regardless of whether or not they have a promo. The PromoID will be either the ID of the promo code or `NULL` if no code is available, and you can use this to decide whether or not to check the checkbox.

```
while( $ro = mysql_fetch_assoc($getRooms) ){
    $roomName = $ro['Name'];
?>
<input type="checkbox" name="room<?= $rr ?>" <?php if( $ro['PromoID'] ) { echo 'checked="checked" '; } ?>/><?php echo $roomName ?>
<?php
    $rr++;
} 
```

And one final thing, I think you should be using `$ro['ID']` instead of a new variable `$rr`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:27:05.477

不确定您的表架构，但类似于以下内容。然后检查是否设置了id。PS，逃避你的输入！

```
SELECT HotelRoom, hp.id
FROM HotelRooms AS hr
LEFT OUTER JOIN HotelPromos AS hp ON hp.hid=hr.id
WHERE HotelId = '$hid'" 
```

# web-services - lablife 的开源替代品

> ID：11268436
> 
> 赞同：0
> 
> 时间：2012-06-29T20:18:44.850
> 
> 标签：web-services, open-source, saas

我正在寻找由[lablife.org](https://www.lablife.org/ll)网站提供的 SAAS 的开源替代方案。该服务的主要目的是自动化生命科学实验室的日常任务。

这项服务是免费的，而且很好用，但是当开发这项服务的原始公司被 BioData 收购时，他们决定终止并用一项名为 labguru 的新服务取而代之。显然，一项新服务缺少很多功能，或者功能很差。

这就是为什么我正在寻找替代解决方案的原因。因此，如果您熟悉该软件的功能 - 并且有任何已知的替代方案，我将非常感谢您提供的任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T03:28:34.093

查看 Quartzy.com。我是创始人之一。如有任何问题，请随时与我们联系。

# linux - 如何在 UNIX 中将字符串转换为整数

> ID：11268437
> 
> 赞同：51
> 
> 时间：2012-06-29T20:18:46.370
> 
> 标签：linux, shell, unix, interactive

我有`d1="11"`和`d2="07"`。我想将`d1`and转换`d2`为整数并执行`d1-d2`. 我如何在 UNIX 中做到这一点？

`d1 - d2`目前`"11-07"`为我返回结果。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-06-29T21:46:26.713

标准溶液：

```
 expr $d1 - $d2 
```

你也可以这样做：

```
echo $(( d1 - d2 )) 
```

但请注意，这将被`07`视为八进制数！（so`07`与 相同`7`，但`010`不同于`10`）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-06-29T20:27:58.043

这些中的任何一个都可以从 shell 命令行工作。`bc`不过，这可能是您最直接的解决方案。

使用[bc](http://linux.die.net/man/1/bc)：

```
$ echo "$d1 - $d2" | bc 
```

使用`awk`：

```
$ echo $d1 $d2 | awk '{print $1 - $2}' 
```

使用`perl`：

```
$ perl -E "say $d1 - $d2" 
```

使用`Python`：

```
$ python -c "print $d1 - $d2" 
```

全部返回

```
4 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-01-17T04:36:22.183

# 一个不限于 OP 案例的答案

问题的标题将人们引到这里，所以我决定为其他所有人回答这个问题，因为 OP 描述的案例非常有限。

## TL;博士

我终于决定写一个函数。

1.  如果你想`0`在非整数的情况下：

```
int(){ printf '%d' ${1:-} 2>/dev/null || :; } 
```

2.  如果你想要*[empty_string]*在非整数的情况下：

```
int(){ expr 0 + ${1:-} 2>/dev/null||:; } 
```

3.  如果你想找到第一个 int 或*[empty_string]*：

```
int(){ expr ${1:-} : '[^0-9]*\([0-9]*\)' 2>/dev/null||:; } 
```

4.  如果你想找到第一个 int 或 0：

```
# This is a combination of numbers 1 and 2
int(){ expr ${1:-} : '[^0-9]*\([0-9]*\)' 2>/dev/null||:; } 
```

如果您想在非整数上获得非零状态代码，请删除`||:`(aka or `true`) 但保留`;`

## 测试

```
# Wrapped in parens to call a subprocess and not `set` options in the main bash process
# In other words, you can literally copy-paste this code block into your shell to test
( set -eu;
    tests=( 4 "5" "6foo" "bar7" "foo8.9bar" "baz" " " "" )
    test(){ echo; type int; for test in "${tests[@]}"; do echo "got '$(int $test)' from '$test'"; done; echo "got '$(int)' with no argument"; }

    int(){ printf '%d' ${1:-} 2>/dev/null||:; };
    test

    int(){ expr 0 + ${1:-} 2>/dev/null||:; }
    test

    int(){ expr ${1:-} : '[^0-9]*\([0-9]*\)' 2>/dev/null||:; }
    test

    int(){ printf '%d' $(expr ${1:-} : '[^0-9]*\([0-9]*\)' 2>/dev/null)||:; }
    test

    # unexpected inconsistent results from `bc`
    int(){ bc<<<"${1:-}" 2>/dev/null||:; }
    test
) 
```

## 测试输出

```
int is a function
int ()
{
    printf '%d' ${1:-} 2> /dev/null || :
}
got '4' from '4'
got '5' from '5'
got '0' from '6foo'
got '0' from 'bar7'
got '0' from 'foo8.9bar'
got '0' from 'baz'
got '0' from ' '
got '0' from ''
got '0' with no argument

int is a function
int ()
{
    expr 0 + ${1:-} 2> /dev/null || :
}
got '4' from '4'
got '5' from '5'
got '' from '6foo'
got '' from 'bar7'
got '' from 'foo8.9bar'
got '' from 'baz'
got '' from ' '
got '' from ''
got '' with no argument

int is a function
int ()
{
    expr ${1:-} : '[^0-9]*\([0-9]*\)' 2> /dev/null || :
}
got '4' from '4'
got '5' from '5'
got '6' from '6foo'
got '7' from 'bar7'
got '8' from 'foo8.9bar'
got '' from 'baz'
got '' from ' '
got '' from ''
got '' with no argument

int is a function
int ()
{
    printf '%d' $(expr ${1:-} : '[^0-9]*\([0-9]*\)' 2>/dev/null) || :
}
got '4' from '4'
got '5' from '5'
got '6' from '6foo'
got '7' from 'bar7'
got '8' from 'foo8.9bar'
got '0' from 'baz'
got '0' from ' '
got '0' from ''
got '0' with no argument

int is a function
int ()
{
    bc <<< "${1:-}" 2> /dev/null || :
}
got '4' from '4'
got '5' from '5'
got '' from '6foo'
got '0' from 'bar7'
got '' from 'foo8.9bar'
got '0' from 'baz'
got '' from ' '
got '' from ''
got '' with no argument 
```

## 笔记

我被送进了这个兔子洞，因为[接受的答案](https://stackoverflow.com/a/11269389/117471)与`set -o nounset`（又名`set -u`）不兼容

```
# This works
$ ( number="3"; string="foo"; echo $((number)) $((string)); )
3 0

# This doesn't
$ ( set -u; number="3"; string="foo"; echo $((number)) $((string)); )
-bash: foo: unbound variable 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-14T22:33:03.573

```
let d=d1-d2;echo $d; 
```

这应该会有所帮助。

* * *

## 回答 #5

> 赞同：-8
> 
> 时间：2012-06-29T20:19:53.007

用这个：

```
#include <stdlib.h>
#include <string.h>

int main()
{
    const char *d1 = "11";
    int d1int = atoi(d1);
    printf("d1 = %d\n", d1);
    return 0;
} 
```

等等

# c# - Cisco ASA 5505 系统重新加载（重启/重启）

> ID：11268444
> 
> 赞同：0
> 
> 时间：2012-06-29T20:19:06.520
> 
> 标签：c#, java, cisco

我有一个 Cisco ASA 5505，我需要每天重新启动它（它是滞后的）。

任何人都可以建议一些方法/代码，我如何在不登录控制台或手动重置的情况下重新启动它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:00:58.023

如果此设备有 API，也许您可​​以通过这种方式发送一些重启请求。如果没有，有 ssh 的 java 库和开源 ssh 客户端。编写一个小型 java 程序以 ssh 进入然后发出重新加载命令可能不会花费很长时间。您可以使用您的操作系统或一些任务调度软件安排这个小 Java 程序每天运行。

# ruby-on-rails - Rails form_for 附加字段

> ID：11268446
> 
> 赞同：1
> 
> 时间：2012-06-29T20:19:07.297
> 
> 标签：ruby-on-rails

我需要用户在我的表单中输入一个 URL。但是，URL 不是我数据库中的列。我收到以下表格的错误。

我有一个创建视频的表格 (new.html.haml)

```
= form_for @video do |f|
  .field
  = f.label :title
  = f.text_field :title
.field
  = f.label :description
  = f.text_area :description
.field
  = f.label :url
  = f.text_field :url
.field
  Provider
  %br
  = radio_button :video, :provider, 'vimeo'
  = f.label :provider, 'Vimeo', :value => 'vimeo'
  %br
  = radio_button :video, :provider, 'youtube' 
  = f.label :provider, 'Youtube', :value => 'youtube'
%br
.actions
  = f.submit "Add video" 
```

Rails 抱怨 URL is not a column in URL is an unknown method or variable。

**我想做的事**

基本上，我需要获取用户正在添加的视频的 URL，以及视频的标题、描述和提供者。

所有字段在数据库中都有一列，只有 URL 没有。

然后我需要格式化 URL 并在其上调用一些方法。它将创建一些我将存储在数据库中的新输出。

所以从 URL，我得到`provider_video_id`，`thumb`它们是数据库列。

**如何在没有专用数据库列的情况下接收表单中的用户 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:26:03.210

您需要使用虚拟属性。

在您的模型中放入如下内容：

```
def url=(url)
  @url = url
end

def url
  @url
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:26:15.603

您可以使用[form_tag](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-form_tag)。它不与任何对象绑定，因此只要您有一个不太简单的理由来使用它，它就是您想要使用的东西。例如，搜索表单将使用 form_tag，这种情况也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-16T02:59:31.690

您尝试使用 Ruby 类设置/获取，所以 Ruby 对此具有魔力。

这是一个简单的方法

```
def url=(url)
  @url = url
end

def url
  @url
end 
```

这是一种神奇的方式

```
attr_accessor :url 
```

使用这行代码，您将干燥您的代码。

# ssh - 使用密钥对和用户通过 SSH 连接到 AWS？

> ID：11268448
> 
> 赞同：0
> 
> 时间：2012-06-29T20:19:10.113
> 
> 标签：ssh, amazon-ec2, amazon-web-services

我发现了这个问题：[SSH to AWS Instance without keypairs](https://stackoverflow.com/questions/6119774/ssh-to-aws-instance-without-key-pairs) for how to disable the need to use keypairs on an EC2 instance。

我想做类似的事情，但如果可能的话，仍然使用密钥对但有多个用户。我们想让客户和供应商访问服务器，但不想与每个人共享相同的密钥对。有没有办法仍然使用密钥对但有多个用户帐户到服务器？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2014-02-14T18:29:57.543

我认为死链接的内容现在可以在[https://gist.github.com/shauns/6229678作为 Gist 找到](https://gist.github.com/shauns/6229678)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-29T22:42:33.093

找到答案：[http ://blog.taggesell.de/index.php?/archives/73-Managing-Amazon-EC2-SSH-login-and-protecting-your-instances.html](http://blog.taggesell.de/index.php?/archives/73-Managing-Amazon-EC2-SSH-login-and-protecting-your-instances.html)

# jquery - Jquery中的表单选择

> ID：11268449
> 
> 赞同：0
> 
> 时间：2012-06-29T20:19:32.213
> 
> 标签：jquery, html

我已经构建了许多我现在想要根据用户选择 nessecary 选择选项来显示的表单。在 jquery 中添加它的最佳方法是什么，以便我可以在选择时为表单设置动画（即淡入和淡出）。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:31:51.590

试试这个 - [http://jsfiddle.net/Vn2QG/](http://jsfiddle.net/Vn2QG/)

```
$("select").on("change", function() {
    var id = $(this).val();

    $("div:visible").fadeOut('slow', function() {
        $("div#form" + id).fadeIn();
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:49:15.993

您可以考虑使用 jQuery UI 中的预构建选项，例如[http://jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/)或[http://jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)

如果你想自己构建它，你可以从以下开始：

```
​&lt;select id="chooser">
    <option value="">Select...</option>
    <option​​​​​ value="formOne">One</option>
    <option value="formTwo">Two</option>
    <option value="formThree">Three</option>
​&lt;/select>

<form id="formOne" class="chooseable">Form One is here.</form>
<form id="formTwo" class="chooseable">Form Two is here.</form>
<form id="formThree" class="chooseable">Form Three is here.</form>​ 
```

JavaScript：

```
jQuery(function($) {
    $('.chooseable').hide();
    var shown = false;
    $('#chooser').change(function() {
        var next = this.value;
        if (shown) {
            $('#'+shown).fadeOut('slow', function() {
                if (next) $('#'+next).fadeIn();
            });
        } else if (next) $('#'+next).fadeIn();
        shown = next;
    });
}); 
```

见小提琴：http: [//jsfiddle.net/XG87j/](http://jsfiddle.net/XG87j/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T20:24:21.440

查看 jQuery fadeToggle 函数[http://api.jquery.com/fadeToggle/](http://api.jquery.com/fadeToggle/)它允许您淡入/淡出容器。

然后，在您的选择标签上，使用每次用户选择新选项时触发的 onchange 事件。触发此事件时，您可以捕获使用 $(this).val() 选择的值并淡入/淡出正确的表单。

# c# - 有没有一种简单的方法来合并登录屏幕？

> ID：11268452
> 
> 赞同：1
> 
> 时间：2012-06-29T20:19:50.217
> 
> 标签：c#, winforms, login

我知道我可以通过在显示表单之前的事件中显示登录表单来劫持表单（Load() 事件，IIRC），但在（也许愚蠢地）试图“偷工减料”并创建一个快速&肮脏的登录屏幕时，我陷入了两难境地。

这是我对现有项目所做的事情（事后添加了登录表单）：

```
1) Created the login form
2) Changed program.cs so that this login form is now the first form created
3) Added code to the login form that shows the "main" form if the login is successful. I then Hide the login form. 
```

这导致应用程序永远不会关闭（通过 Shift+F5 除外），因为隐藏的主窗体仍在潜伏。因此，我在“主”表单的 FormClosing 事件中添加了一个“Close()”，认为这会导致整个应用程序关闭（IOW，隐藏登录表单）。

但是（也许恰当地），这并没有解决我的问题，而是导致*“System.Windows.Forms.dll 中发生'System.StackOverflowException'类型的未处理异常”*

现在我不知道我是否应该继续这种快速而肮脏的尝试（以及如何），或者减少我的损失并恢复到 show-the-login-form-in-the-Load-event 方法[学]。

## 更新

Alex M 的解决方案奏效了。您需要做的唯一额外的事情是登录表单中的类似内容：

```
private void buttonLogin_Click(object sender, EventArgs e)
{
    String userName = textBoxUserName.Text.Trim();
    String pwd = textBoxPassword.Text.Trim();
    if ((userName == "donMcLean") || (pwd == "Drove my Chevy to the levee but the levee was dry, them good ole boys were drinking whiskey & Rye"))
    {
        this.DialogResult = DialogResult.OK;
    }
    else
    {
        MessageBox.Show("Incorrect User Name and/or Password");
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T20:27:03.770

创建顺序并不是特别重要。您可以使用显示登录表单`form.ShowDialog()`。这样做会处理表单并解决您所描述的问题。

例如：

```
var login = new LoginForm();
var mainForm = new MainForm();

if (login.ShowDialog() != DialogResult.Ok) 
{
      return; // Exit the application
}

Application.Run(mainForm); 
```

# javascript - 如何以编程方式在 URL 上执行 javascript

> ID：11268454
> 
> 赞同：1
> 
> 时间：2012-06-29T20:19:51.143
> 
> 标签：javascript

我想使用 Readability 的 javascript 来清理新闻文章，然后下载生成的文章。这意味着能够执行他们的 js 代码：

```
window.baseUrl          = 'https://www.readability.com';
window.readabilityToken = '';

var s = document.createElement('script');

s.setAttribute('type','text/javascript');
s.setAttribute('charset','UTF-8');
s.setAttribute('src', baseUrl + '/bookmarklet/read.js');

document.documentElement.appendChild(s); 
```

在不同于传统网络浏览器的环境中。例如，这可以通过在使用 Firebug 的站点上执行上述代码来实现；我想通过 Java（没有浏览器）模拟该功能。我在这里看到的问题之一是“窗口”对象，它在以编程方式访问页面时可能不存在。

关于这是否可能以及如何实施的任何提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:22:41.757

看一下无头浏览器，例如[EnvJS](http://www.envjs.com)。

# javascript - 找出哪些 javascript 更改了 DOM？

> ID：11268457
> 
> 赞同：49
> 
> 时间：2012-06-29T20:20:02.667
> 
> 标签：javascript, debugging

我最近一直在使用大量其他的 JS，并且开始非常讨厌尝试调试它。即使使用 Chrome 的开发工具，我也无法追踪页面加载期间发生的大量 DOM 更改。

是否有任何工具可以告诉我 DOM 的哪一部分（比如添加的属性）是由什么 JS 完成的？

谢谢

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-06-29T20:23:27.577

在 Chrome 开发工具中，您可以选择在 DOM 更改时中断执行。![在此处输入图像描述](../Images/71a54366b9cc49d1fad7b257e28dd518.png)

还有一个截图来说明 Wolfram 的答案（+1）

![在此处输入图像描述](../Images/9c6971076b77e97a609278ea2043efa5.png)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-06-29T20:38:03.477

Jayraj 回答的一个小补充：[DOM Mutation Events 上的断点](https://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints#dom)。右键单击任何元素，您可以选择`Break on Subtree Modifications`and`Break on Attributes Modifications`和`Break on Node Removal`。

这也可以使用[Firebug](http://getfirebug.com/wiki/index.php/Script_Panel#Types)：右键单击一个元素，您可以使用一些选项来监视它的更改。

# json - 在 Play 2.0 中使用 JSON 模板

> ID：11268463
> 
> 赞同：6
> 
> 时间：2012-06-29T20:21:08.450
> 
> 标签：json, templates, playframework, playframework-2.0

我收到此错误：

> 编译错误【包views.json.Runs不存在】

当它显然确实存在时。我不知道我做错了什么。

控制器中的操作`Runs`：

```
@BodyParser.Of(play.mvc.BodyParser.Json.class)
public static Result view(Long task_id, Long run_id) {
    Run run = Run.find.byId(run_id);
    return ok(views.json.Runs.view.render(run));
} 
```

`app/views/Runs/view.scala.json`：

```
@(run: Run)

{
    "started": "@run.started",
    "completed": "@run.completed"
} 
```

我已经得到了一些 html 模板，但这是我在 2.0 中尝试过的第一个 JSON 模板。我不确定还有什么可以尝试的，因为它已经尽可能基本了。有人有想法么？

**更新**：我已经收到了一些解决方法的建议，但我仍然想知道如何让模板工作，如果只是为了更好地理解对 2.0 的更改。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T23:17:04.403

默认情况下似乎只支持 html、xml 和 txt。对于其他文件扩展名和格式，您必须在其中注册额外的“templateTypes” `$PLAY_HOME/framework/src/sbt-plugin/src/main/scala/PlaySettings.scala`（另请参阅：[SBT 设置](https://github.com/playframework/Play20/wiki/SBTSettings)，靠近底部）。

查看`$PLAY_HOME/framework/src/play/src/main/scala/play/api/templates/Templates.scala`.

您也可以作弊并从 txt 文件中提供您的 json，但`response().setContentType("application/json")`在调用该`render`方法之前执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T20:40:17.217

对于 Json，为什么不直接使用[Json 助手](http://www.playframework.org/documentation/api/2.0.2/java/play/libs/Json.html)生成 Json 字符串：

```
public static Result view(Long task_id, Long run_id) {
    Run run = Run.find.byId(run_id);
    return ok(play.libs.Json.toJson(run));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T20:44:25.950

我建议遵循文档并让 Json 库序列化您的数据，而不是自己编写 Json 文本：[请参阅 Serving Json Response](http://www.playframework.org/documentation/2.0.2/JavaJsonRequests)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T21:15:32.643

我还是不明白，为什么人们想用视图渲染他们的 JSON。

注意：这与@nico_ekito 之前展示的方式相同，我完全同意他的看法，下面的代码仅演示了如何为 JSON 选择对象的一部分

```
public static Result view(Long task_id, Long run_id){

    Run run = Run.find.byId(run_id);

    ObjectNode result = Json.newObject();
    result.put("started", run.started);
    result.put("completed", run.completed);

    return ok(Json.toJson(result));

} 
```

# java - 如何以一种形式传递@RequestParam 和@ModelAttribute

> ID：11268470
> 
> 赞同：5
> 
> 时间：2012-06-29T20:21:48.597
> 
> 标签：java, spring, spring-mvc

我想将@RequestParam 和@ModelAttribute 混合在一个弹簧形式和控制器中。

我在控制器中做的事情如下：

```
@RequestMapping("/user/edit/{userId}")
public ModelAndView editUser(@PathVariable String userId, 
    @ModelAttribute User user, BindingResult bindingResult,
    @RequestParam Set<String> groups) {

    if(bindingResults.hasErrors() {
        //return back to form and correct errors
    } else {
        //save data and get out of form 
    }
} 
```

有简单的用户 bean（id、firstName、lastName 等）但没有“groups”属性。还有一个简单的 Group bean（id、name、description），但与 User 没有任何联系。所以在逻辑层面上，用户和组是完全分开的。

在我的表单中，编辑用户时，有一个 html SELECT 元素，其中包含所有组的 ID。您可以选择多个 id 连同填充用户数据并将其发送到控制器。

到目前为止，一切都运行良好。我正确填写了@ModelAttibute User。我还得到了@RequestParam Set[String] 组，其中填充了选定的 id（字符串）。

现在我想做更多的事情。我需要写一些东西，而不是@RequestParam Set[String] 组会给我@RequestParam Set[Group] 组。当然，我可以直接在我的控制器方法 editUser(...) 中转换它，但这不是一个好的解决方案。所以我决定编写一个自定义的@InitBinder 方法，它会为我顺利而顺利地完成它。

问题来了。

我将 initBinder 编写如下：

```
[...]
webDataBinder.registerCustomEditor(Set.class, "groups", new CustomCollectionEditor(Set.class) {
    @Override
    protected Object convertElement(Object element) {
        if (element instanceof GroupName) {
            return element;
        }

        if (element instanceof String) {
            Group group = userCatalog.loadGroup((String) element);
            return group.getGroupName();
        }

        return null;
    }
});
[...] 
```

问题是绝对没有办法调用这个方法。我在里面放了一些“调试” System.out.println(...) 但它不打印任何东西。

我的问题是：如何编写一个正确的 InitBinder，它将被调用以响应来自 html OPTION 元素的字符串数组并将其转换为我的用户集。

我将一些括号更改为这个 [ 和 ] 因为它没有显示。

谢谢你的帮助。

* * *

同时我遇到了这个话题：[自定义属性编辑器不适用于 Spring MVC 中的请求参数？](https://stackoverflow.com/questions/2998761/custom-property-editors-do-not-work-for-request-parameters-in-spring-mvc?answertab=votes#tab-top)

我认为这是解决问题的关键。事实上，正如 javadocs 所说，“字段”参数仅在使用 ModelAttibute（或相同的表单支持对象......）时才是必需的，而 RequestParam 则不需要。那么有什么解决方案可以将 InitBinder 与 RequestParam 一起使用？或者我需要在控制器中编写一个将 ids 转换为组对象集的直接方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T11:15:58.857

尝试仅针对 Set.class 类型注册您的自定义编辑器并省略字段名称以查看是否有效。

`webDataBinder.registerCustomEditor(Set.class, new CustomCol...`

我怀疑 field 参数表示 ModelAttribute 的属性名称而不是请求参数名称。

或者，您可以使用包装视图模型并使用第二个`ModelAttribute`参数，

```
class GroupsViewModel {
    private List<Group> groups
    ...
} 
```

# windows - 在 Windows 主机上使用 Vagrant 运行 Chef 食谱：SSH 问题

> ID：11268472
> 
> 赞同：2
> 
> 时间：2012-06-29T20:21:50.877
> 
> 标签：windows, ssh, chef-infra, vagrant

我使用 Vagrant 在 Windows 主机上创建一个 CentOS VM 并连接到它，到目前为止一切顺利。

接下来，我想使用 Chef 在创建的 VM 上配置堆栈。我尝试使用本地目录食谱以及提供食谱的 url，但这可能会失败，因为它无法 ssh 到访客框，从错误中可以看出：

`SSH authentication failed! This is typically caused by the public/private keypair for the SSH user not being properly set on the guest VM. Please verify that the guest VM is setup with the proper public key, and that the private key path for Vagrant is setup properly as well.`

所以我的第一个问题是：

1) 如何确保 SSH 在 Windows 主机中启动来宾操作系统的同一窗口内工作，以便所有脚本都能正常执行？

现在，当我在 vagrantfile 的下面一行评论时

```
config.ssh.username = "root" 
```

上面的错误消失了，但我得到另一个错误：

`The following SSH command responded with a non-zero exit status. Vagrant assumes that this means the command failed!`

`mount -t vboxsf -o uid=`id -u vagrant`,gid=`id -g vagrant` v-csr-2 /tmp/vagrant-chef-1/chef-solo-2/roles`

这是因为用户 vagrant 在 box 上没有足够的访问权限，这是我的第二个问题：

2) 如何指示 Vagrant 运行所有具有 sudo 或 su 访问权限的命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T09:12:59.123

以下是我设法让 SSH 工作的方法：

## 安装 cygwin (http://www.cygwin.com/)

从 cygwin 中设置 openssh

## 添加 ~/.ssh/id_rsa_vagrant

从[这里下载](https://github.com/mitchellh/vagrant/tree/master/keys/)

## 修改~/.ssh/config

主机 localhost IdentityFile ~/.ssh/id_rsa_vagrant

## 修改 ssh 目录的权限

chmod 600 ~/.ssh/*

一切都应该正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:08:23.723

我找到了一种从 Windows 使用批处理文件和相同的命令提示符窗口连接到 VM 的方法。

所以这里是步骤：

*   您需要在同一台机器上安装腻子。
*   您需要在以下批处理脚本中配置 putty 可执行文件的路径
*   使用批处理文件连接到您的盒子

这是批处理文件：

 ``@echo off REM REM This is a replacement for the "vagrant ssh" command on Windows REM (since "vagrant ssh" doesn't actually work on Windows). REM REM PuTTY must be installed. If it is not installed in REM "C:\Program Files (x86)\PuTTY" then set the PUTTY_DIR environment REM to point to the installed location. REM REM As with any vagrant command this should be executed in the directory REM containing the Vagrantfile. REM

setlocal enableextensions

if "%PUTTY_DIR%" == "" ( REM Default location of PuTTY if the Windows installer is used. set "PUTTY_DIR=C:\Program Files (x86)\PuTTY" )

if not exist "%PUTTY_DIR%" ( echo ERROR: PuTTY not found. echo Install PuTTY or check setting of PUTTY_DIR. goto end )

for /F "tokens=1,2" %%A in ('vagrant ssh-config') do ( if "%%A" == "HostName" ( set VagrantHostName=%%B ) if "%%A" == "Port" ( set VagrantPort=%%B ) if "%%A" == "User" ( set VagrantUser=%%B ) if "%%A" == "IdentityFile" ( set IdentityFile=%%B ) )

if "%VagrantHostName%" == "" ( goto end )

if exist %IdentityFile%.ppk ( set "VGPUTTY_OPTIONS=%VGPUTTY_OPTIONS% -i %IdentityFile%.ppk" ) else ( echo. echo TIP: For password-free Vagrant VM login use PuTTYGen to generate echo this file: %IdentityFile%.ppk echo from file: %IdentityFile% echo. )

start "%VagrantHostName%:%VagrantPort%" "%PUTTY_DIR%\PuTTY.exe" %VGPUTTY_OPTIONS% %VagrantUser%@%VagrantHostName% %VagrantPort%

:end``

# python - 如何在 Django 中的过滤查询上使用 distinct()？

> ID：11268474
> 
> 赞同：0
> 
> 时间：2012-06-29T20:22:11.290
> 
> 标签：python, django, filter, distinct

我有一个这样的查询：

```
last_orders = PsSiparis.objects.filter(kullanici = request.user).order_by("-id")[:4]
for order in last_orders:
    print order.restoran 
```

它输出：

```
Bafra Pide 
Bafra Pide 
Deneme Restoran 
Bafra Pide 
```

我想使用 distinct() 属性，所以我的列表将如下所示：

```
Bafra Pide
Deneme Restoran 
```

但我找不到路。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T15:49:33.943

您应该使用 a `set`，它将删除重复项：

```
>>> l = ['Bafra Pide','Bafra Pide','Deneme Restoran','Bafra Pide']
>>> s = set(l)
>>> for i in s:
...    print i
...
Bafra Pide
Deneme Restoran 
```

您应该将各个名称而不是实际对象添加到列表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:25:12.763

您不能调用`.distinct()`切片查询，因为没有简单的方法可以生成适当的 SQL 查询。您将需要使用`set`等进行后处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T00:38:19.660

Django 提供了一种选择查询结果不相等的方法。看看： [Django 文档，distinct()](https://docs.djangoproject.com/en/dev/ref/models/querysets/#distinct)

版本：另外，限制一个查询集返回一个查询集，所以你不会有问题，我建议在应用 distinc() 方法后切片。[限制查询集](https://docs.djangoproject.com/en/dev/topics/db/queries/#limiting-querysets)

# c++ - 从另一个线程调用 std 容器上的 size 是否安全？

> ID：11268477
> 
> 赞同：0
> 
> 时间：2012-06-29T20:22:35.593
> 
> 标签：c++, thread-safety, containers, std, atomic

当一个线程管理`std::map`添加和删除事物时，另一个线程可以安全地`size()`调用`map`?

由于不涉及迭代器，因此失效不是问题。

在这种情况下，我想地图总是存在的。没有在坏时刻破坏对象的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:26:14.233

不，大小可能涉及遍历，因为它不能保证为 O(1)。

# javax.imageio - 导入 javax.imageio.ImageIO 时出错；

> ID：11268481
> 
> 赞同：0
> 
> 时间：2012-06-29T20:22:54.353
> 
> 标签：javax.imageio

我是 Java 新手，正在尝试显示图像。我在网上得到了代码，但是在尝试时，我在导入“import javax.imageio.ImageIO;”时遇到了错误。错误消息显示“javax.imageio.ImageIO”是错误的包名称或不存在的实体。我在很多样品上都看到过这种情况，但它不适用于我。有什么建议吗

```
mport java.awt.*;
import java.awt.image.BufferedImage;
import java.io.*;
import javax.imageio.ImageIO;
import javax.swing.JFrame;
public class Showmap extends Panel
{
    BufferedImage img;
    public Showmap ()
    {
        try
        {
            image = ImageIO.read (new File ("KNP.jpg"));
        }

        /*
           catch (IOException e)
           {

               BufferedImage  image;
                 public ShowImage() {
                 try {
                 System.out.println("Enter image name\n");
                 BufferedReader bf=new BufferedReader(new
               InputStreamReader(System.in));
                String imageName=bf.readLine();
                 File input = new File(imageName);
                 image = ImageIO.read(input);
           }*/

        catch (IOException e)
        {
            System.out.println ("Error:" + e.getMessage ());
        }
    }

    public void paint (Graphics g)
    {
        g.drawImage (image, 0, 0, null);
    }

    static public void main (String args []) throws
        Exception
    {
        JFrame frame = new JFrame ("Display image");
        Panel panel = new Showmap ();
        frame.getContentPane ().add (panel);
        frame.setSize (500, 500);
        frame.setVisible (true);
    }
} 
```

谢谢伊万

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-10T04:04:54.087

在您的项目中选择：

1.  右键单击“JRE 系统库”
2.  选择属性
3.  在执行环境中选择“J2SE-1.5(jre8)”或更高版本；您应该使用最新版本的 jre8

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:27:16.283

我正在使用“Ready to Program”进行编程，并尝试了许多选项但没有成功。当我将相同的代码复制到“JCreator”并从那里运行它时，它工作正常。似乎“导入 javax.imageio.ImageIO;” 不适用于“准备编程”。

# gtk - 使用 Gtk 使用鼠标移动控件

> ID：11268482
> 
> 赞同：0
> 
> 时间：2012-06-29T20:23:03.047
> 
> 标签：gtk, widget, vala

我在 Gtk Fixed 项目上移动控件时遇到问题，代码抖动移动，而且通常很慢。我已经尝试找到正确的方法来做到这一点，但是都揭示了相同的结果。

我认为相关的代码是：

```
 view.button_press_event.connect( (bp) => {
            view.set_data("in_motion", true);

            int pointX = 0; int pointY = 0;
            fixed.get_pointer(out pointX, out pointY);
            int origX = 0; int origY = 0;
            view.translate_coordinates(fixed, 0,0, out origX, out origY);

            view.set_data("startx", origX + origX);
            view.set_data("starty", origY + origY);
            view.set_data("startsx", pointX);
            view.set_data("startsy", pointY);
            view.is_focus = true;
            view.has_focus = true;
            return false;
        });
        view.button_release_event.connect( (bp) => {
            view.set_data("in_motion", false);
            return false;
        });
        view.motion_notify_event.connect( (me) => {
            // TODO: Make this less glitchy somehow
            if(view.get_data<bool>("in_motion") == true){
                int x = view.get_data<int>("startx") + (int)me.x - view.get_data<int>("startsx");
                int y = view.get_data<int>("starty") + (int)me.y - view.get_data<int>("startsy");
                ((Fixed)view.parent).move(view, x,y );
            }
            return false;
        }); 
```

（其余的在[https://github.com/kennydude/diagramatic/blob/master/diagram.vala](https://github.com/kennydude/diagramatic/blob/master/diagram.vala)上）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T19:46:07.000

好的，所以我设法做到了，但是代码库转移到了 python（Vala 太难了）。

[https://github.com/kennydude/diagramatic/blob/master/diagram.py](https://github.com/kennydude/diagramatic/blob/master/diagram.py)

# c# - 如何获取从网站上传的 Excel 文件并以编程方式将数据导入 SQL Server？

> ID：11268483
> 
> 赞同：2
> 
> 时间：2012-06-29T20:23:14.050
> 
> 标签：c#, sql-server

我正在尝试做这样的事情：

```
public void ImportClick(object sender, EventArgs e) //the button used after selecting the spreadsheet file
{
    if (fileUpload.HasFile) //ASP.Net FileUpload control
    {
        if (fileUpload.FileName.EndsWith(".xls", StringComparison.OrdinalIgnoreCase) || fileUpload.FileName.EndsWith(".xlsx", StringComparison.OrdinalIgnoreCase))
        {
            Excel sheet = new Excel(fileUpload.Open()); //not sure how to do this part

            using (SqlConnection connection = new SqlConnection(ConfigurationManager.ConnectionStrings["our_database"].ConnectionString))
            {
                using (SqlCommand command = new SqlCommand("INSERT INTO table_name SELECT * FROM " + sheet, connection))
                {
                    connection.Open();
                    command.ExecuteQuery(); //Intellisense only has "ExecuteNonQuery()" method, but that's for T-SQL
                    connection.Close();
                }
            }
        }
        else
        {
            error.Text = "File must be either *.xls or *.xlsx";
            error.Visible = true;
        }
    }
    else
    {
        error.Text = "No file was selected";
        error.Visible = true;
    }
} 
```

[Microsoft.Office.Interop.Excel 命名空间](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel%28v=office.11%29.aspx)中有很多类和接口，我不知道该用哪一个。

我知道制作 Excel 对象以及 SQL 命令可能不会像我在这里那样容易，但这是我需要帮助的两件事。

任何建议/建议将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T20:29:14.570

我建议使用 Microsoft Jet Engine。

```
private static void UploadExcelToDB(string p)
    {
        try
        {
            using (SqlConnection conn = new SqlConnection(DBConnString))
            {
                conn.Open();
                if (conn.State == ConnectionState.Open)
                {
                    Log("Opened connection to DB");
                }
                SqlBulkCopy sbk = new SqlBulkCopy(conn);
                sbk.BulkCopyTimeout = 600;
                sbk.DestinationTableName = DbTableName;
                DataTable excelDT = new DataTable();
                OleDbConnection excelConn = new OleDbConnection(ExcelConnString.Replace("xFILEx",p));
                excelConn.Open();
                if (excelConn.State == ConnectionState.Open)
                {
                    Log("Opened connection to Excel");
                }
                OleDbCommand cmdExcel = new OleDbCommand();
                OleDbDataAdapter oda = new OleDbDataAdapter();
                cmdExcel.CommandText = "SELECT * FROM ["+ExcelTableName+"]";
                cmdExcel.Connection = excelConn;
                oda.SelectCommand = cmdExcel;
                oda.Fill(excelDT);
                if (excelDT != null)
                {
                    Log("Fetched records to local Data Table");
                }
                excelConn.Close();
                SqlCommand sqlCmd = new SqlCommand("TRUNCATE TABLE ICN_NUGGET_REPORT_RAW",conn);
                sqlCmd.CommandType = CommandType.Text;
                Log("Trying to clear current data in table");
                int i = sqlCmd.ExecuteNonQuery();
                Log("Table flushed");
                Log("Trying write new data to server");
                sbk.WriteToServer(excelDT);
                Log("Written to server");
                conn.Close();
            }
        }
        catch (Exception ex)
        {
            Log("ERROR: " + ex.Message);
            SendErrorReportMail();
        }
        finally
        {
            #if (DEBUG)
            {
            }
            #else
            {
            string archive_file = ArchiveDir+"\\" + DateTime.Now.ToString("yyyyMMdd-Hmmss") + ".xlsx";
            File.Move(p, archive_file);
            Log("Moved processed file to archive dir");
            Log("Starting archive process...");
            }
            #endif
        }
    } 
```

这是`ExcelConnString`这样的：

`public static string ExcelConnString { get { return "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=xFILEx;Extended Properties=\"Excel 12.0;HDR=YES\";";} }`

HDR=YES - 这意味着如果您在电子表格中有列名，它将被视为目标表列名以相互匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T09:17:21.010

我正在考虑创建一个 excel.application 类的实例并编写代码来循环遍历单元格。并使用 SQL 插入查询将行一一复制到 SQL 表中。无论如何，我仍在解决它，并会在我完成后粘贴代码。

# sql - 通过 postmeta 引用的 WordPress 站点上的 SQL 中的多个连接

> ID：11268484
> 
> 赞同：1
> 
> 时间：2012-06-29T20:23:17.853
> 
> 标签：sql, wordpress

这将是一个有点难以描述的挑战。我有一个非常不寻常的案例，我需要在 WordPress 中编写查询。

我有一个帖子类型，叫做`artists`，还有一个帖子类型，叫做`performances`。艺术家有一个带有 key 的元值`artist_id`。表演具有相同的元键，引用艺术家。我意识到这个替代的 ID 子系统很荒谬，但由于许多其他原因，事情就是这样，你必须相信我，他们是明智的。

表演有另一个`show_set_time`包含 UNIX 时间戳的元键。

**我需要编写一个查询，以获取在某个日期之后有表演的所有艺术家。**

如果不清楚，请告诉我。我再次完全认识到 ID 密钥是荒谬的，但还涉及其他因素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:58:06.147

这显然是未经测试的，但我认为它应该工作：

```
SELECT *

FROM (SELECT NULL) AS dummy

INNER JOIN
wp_posts AS artist
ON artist.post_type = `artist`

INNER JOIN
wp_postmeta AS meta_artist_id
 ON meta_artist_id.post_id = artist.ID
AND meta_artist_id.meta_key = 'artist_id'

INNER JOIN
wp_posts AS performance
ON artist.post_type = `performance`

INNER JOIN
wp_postmeta AS meta_performance_artist_id
 ON meta_performance_artist_id.post_id = performance.ID
AND meta_performance_artist_id.meta_key = 'artist_id'
AND meta_performance_artist_id.meta_value = meta_artist_id.meta_value

INNER JOIN
wp_postmeta AS meta_performance_date
 ON meta_performance_date.post_id = performance.ID
AND meta_performance_date.meta_key = 'show_set_time'

WHERE
meta_performance_date.meta_value > DATE('2012-12-21') 
```

# mysql - MySQL 一个月内每一天的高峰时间表

> ID：11268485
> 
> 赞同：1
> 
> 时间：2012-06-29T20:23:20.187
> 
> 标签：mysql, reporting

我正在尝试查询以获取特定月份每天的高峰时间。我的表如下所示：

```
id      idproduct       created_at
1       021354684       2011-10-01 20:25:48
2       033546835       2011-10-01 20:30:15
3       055965654       2011-10-01 20:45:20
4       012975343       2011-10-02 14:03:36
5       021354684       2011-10-02 15:55:48
6       033546835       2011-10-02 16:30:15
7       055965654       2011-10-02 16:45:20
8       012975343       2011-10-02 18:53:36
9       021354684       2011-10-03 08:55:48
10      033546835       2011-10-03 09:30:15
11      055965654       2011-10-03 14:03:20
12      012975343       2011-10-03 14:03:36 
```

我试图得到的是这样的......：

```
day     rush_hour    number_of_rows
1       20:00        3
2       16:00        5
3       14:00        4 
```

有可能得到这样的表吗？你们能帮帮我吗？

我犯了一个错误，对此感到抱歉。行数应该是当天售出的商品总数，而不是在那一小时内:(对不起。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:39:53.817

[http://sqlfiddle.com/#!2/5b87b/7](http://sqlfiddle.com/#!2/5b87b/7)

首先，统计每天每小时的计数（放到一个视图中，因为下面我们会用到两次）：

```
CREATE VIEW hours AS 
SELECT
  DATE( created_at ) AS d,
  HOUR( created_at ) AS h,
  COUNT(*) AS c
FROM item
GROUP BY DATE(created_at), HOUR(created_at); 
```

最终查询：

```
SELECT
  hours.d AS `day`,
  hours.h AS `rush_hour`,
  hours.c AS `count`

-- get the max count for every day
FROM (
      SELECT
        d,          -- the day 
        MAX(c) as c -- the count
      FROM hours
      GROUP BY d
     ) AS maxc

-- find the actual hour(s) with the max count for every day:
INNER JOIN hours ON hours.c = maxc.c
                AND hours.d = maxc.d; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T20:34:25.893

你会想看看[MySQL Date Functions](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)，他们为你提供了一些帮助

```
SELECT 
  day(created_at) as day, 
  hour(created_at) as rush_hour, 
  count(1) as num_rows 
FROM item
GROUP BY
  day(created_at), hour(created_at) 
```

[http://sqlfiddle.com/#!2/62a15/2/0](http://sqlfiddle.com/#!2/62a15/2/0)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T20:31:55.377

试试这个：

```
SELECT dayofyear(created_at) as day, hour(created_at) as rush_hour, count(*) as number_of_rows 
FROM table
GROUP BY dayofyear(created_at), hour(created_at); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T20:56:39.573

在这里不做任何视图：

```
SELECT ddd.day, eee.rush_hour, ddd.maxo
FROM 
(select day, max(num_rows) as maxo from (
SELECT 
  day(created_at) as day, 
  hour(created_at) as rush_hour, 
  count(1) as num_rows 
FROM item
GROUP BY
  day(created_at), hour(created_at)
  ) as groupo group by day) as ddd

LEFT JOIN
(SELECT 
  day(created_at) as day, 
  hour(created_at) as rush_hour, 
  count(1) as num_rows 
FROM item
GROUP BY
  day(created_at), hour(created_at)
  ) as eee on ddd.day=eee.day and ddd.maxo=eee.num_rows 
```

我可以想象它的格式会更好或者有更多相关的别名，但是这里有很多子选择。

并感谢 SQLfiddlers 将数据放在那里。

而且我认为，如果你有两个小时与你计算的最高数量并列，它们都会出现，所以你会在当月的那一天得到两条（或更多）记录。

# apache - AWS EC2 FTP/HTML

> ID：11268486
> 
> 赞同：11
> 
> 时间：2012-06-29T20:23:22.520
> 
> 标签：apache, amazon-ec2, amazon-web-services

我真的不太了解 Apache，我按照一些教程安装了 LAMP 堆栈。我可以成功地通过 ftp 到 /home/ec2-user 并在那里上传文件，但我希望能够将文件上传到 /var/www/html 或者只是有一个可以使用我的帐户将文件上传到网络的地方。

抱歉，如果我的问题不是很有帮助，但我在服务器上受过足够的教育，无法提供更多信息。问我问题，我会尽力而为。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-29T20:42:56.060

首先确保您可以写入文档根目录（在本例中为 /var/www/html） EC2 上用户“ec2-user”的默认组是“ec2-user”和“wheel”

使用以下命令授予用户“ec2-user”对 /var/www/html 的所有权

```
sudo chown -R ec2-user /var/www/html 
```

或组“轮”所有权和写入权限

```
sudo chgrp -R wheel /var/www/html
sudo chmod g+w /var/www/html 
```

第二步是将您的 FTP 客户端（Filezilla、Cyber​​Duck...）设置为默认为 /var/www/html 或在主目录 ec2-user 中创建一个指向 docroot 的符号链接。

```
ln -s /var/www/html ~/docroot 
```

当您在 ftp 客户端上进行身份验证时，只需双击看起来像“docroot”的文件夹。

需要注意的是，您的 DocumentRoot 可能未配置为 /var/www/html，请检查您在 /etc/httpd/conf.d/*.conf 中标有“DocumentRoot”的配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T21:37:31.333

Here is a helpful answer, and at the end is a link to a video for Cyberduck. The text of the Filezilla explanation was enough for me to figure it out for Cyberduck.

[Connect to Amazon EC2 file directory using Filezilla and SFTP](https://stackoverflow.com/questions/16744863/connect-to-amazon-ec2-file-directory-using-filezilla-and-sftp)

# jquery - jQuery .fadeOut 不会在绝对定位元素上触发

> ID：11268488
> 
> 赞同：0
> 
> 时间：2012-06-29T20:23:30.917
> 
> 标签：jquery, hide, fadein, fadeout

奇怪的问题发生在这两个代码块的末尾（这部分：**$('#next-back').delay(500).fadeOut(300);**）没有触发（它曾经！）

```
$('.menu-contact').click(function() {
        $('#about').fadeOut(300);$('.menu-about').removeClass('selected');
        $('#contact').delay(500).fadeIn(600);
        $(this).addClass('selected');$('#next-back').delay(500).fadeOut(300);
    });

    $('.menu-about').click(function() {
        $('#contact').fadeOut(300);$('.menu-contact').removeClass('selected');
        $('#about').delay(500).fadeIn(600);
        $(this).addClass("selected");$('#next-back').delay(500).fadeOut(300);
    }); 
```

我在这里不知所措。这是非常简单的东西，它不起作用，我什至不得不在这里发布它，我感到很尴尬。如果我将代码更改为`$('#next-back').hide();`元素将隐藏。

这是工作示例： http: [//fixxed.com/test/bp/visual-effects-color-grading-design.html](http://fixxed.com/test/bp/visual-effects-color-grading-design.html)

当您单击 CONTACT 或 ABOUT 时，右下角的“NEXT”应该随着覆盖层淡入淡出。当您单击覆盖层内的小“关闭”时，它会淡入“NEXT”
奇怪的是，“NEXT”会闪烁当你点击“关闭”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:31:55.553

当我删除它并尝试`$('#next-back').fadeOut()`它工作正常时，尽量不要在你的 .next div（在#next-back 中）上使用绝对定位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:33:27.093

从 about 和 contact 中删除这条线。

```
$('#next-back').delay(500).fadeOut(300); 
```

如果你删除，我觉得它不会有任何影响。

# iphone - CLLocationCoordinate2D currentCentre 不返回纬度/经度

> ID：11268489
> 
> 赞同：0
> 
> 时间：2012-06-29T20:23:35.600
> 
> 标签：iphone, ios, xcode, cocoa-touch

CLLocationCoordinate2D 当前中心；当我在 ViewDidLoad 中使用我的方法时不返回 lat/long 如果我使用它 viewDidAppear 它可以工作，但 lat/long 来自其他地方（不准确）。我想在 viewDidLoad 或 viewDidApear 上执行 [self queryGooglePlaces:@"grocery"]; 这是我的新手，请很好

```
-(void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.

//Back Button
UIBarButtonItem *back = [[UIBarButtonItem alloc] initWithTitle:@"Back" style:UIBarButtonItemStylePlain target:nil action:nil];
[[self navigationItem] setBackBarButtonItem:back];

self.mapView.delegate = self;     

locationManager = [[CLLocationManager alloc] init];

[locationManager setDelegate:self];

[locationManager setDistanceFilter:kCLDistanceFilterNone];
[locationManager setDesiredAccuracy:kCLLocationAccuracyBest];

[self.mapView setShowsUserLocation:YES];

firstLaunch=YES;
imageName=[[NSString alloc] init];
imageName=[NSString stringWithFormat:@"park.png"];
[self queryGooglePlaces:@"grocery"];

}

-(void) queryGooglePlaces: (NSString *) googleType
{

// Build the url string we are going to sent to Google. NOTE: The kGOOGLE_API_KEY is a constant which should contain your own API key that you can obtain from Google. See this link for more info:
// https://developers.google.com/maps/documentation/places/#Authentication

NSString *url = [NSString stringWithFormat:@"https://maps.googleapis.com/maps/api/place/search/json?location=%f,%f&radius=%@&keyword=%@&sensor=true&key=%@", currentCentre.latitude, currentCentre.longitude, [NSString stringWithFormat:@"%i", currenDist], googleType, kGOOGLE_API_KEY];

NSLog(@"test: %@",url);

//Formulate the string as URL object.
NSURL *googleRequestURL=[NSURL URLWithString:url];
//NSLog(url);
// Retrieve the results of the URL.
dispatch_async(kBgQueue, ^{
    NSData* data = [NSData dataWithContentsOfURL: googleRequestURL];
    [self performSelectorOnMainThread:@selector(fetchedData:) withObject:data waitUntilDone:YES];
}); 
```

}

我的 .h 代码

```
@interface MapViewController : UIViewController<MKMapViewDelegate,CLLocationManagerDelegate>
 {

CLLocationManager *locationManager;

NSString *imageName;
BOOL firstLaunch;

CLLocationCoordinate2D currentCentre;
int currenDist;

}
@property (strong, nonatomic) IBOutlet MKMapView *mapView;
 -(void) queryGooglePlaces: (NSString *) googleType;
@end 
```

但是如果我在按钮中调用它，它会像这样工作

```
- (IBAction)toolbarButtonPresses:(id)sender {

imageName=[[NSString alloc] init];
imageName=[NSString stringWithFormat:@"park.png"];

[self queryGooglePlaces:@"grocery"]; 

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T22:36:17.743

您需要调用`[locationManager startUpdatingLocation];`，`viewDidLoad`然后通过查询 location 属性来检查它是否返回了有效位置 - 检查它是否不为零。返回结果可能需要一段时间，因此当您的其余代码执行时，没有有效值。您也许可以使用`– locationManager:didUpdateToLocation:fromLocation: – locationManager:didFailWithError:`CLLocationManagerDelegate 协议中的方法来处理此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T07:05:24.783

请检查您不在模拟器中的设备中的运行代码 模拟器无法给出正确的纬度/日志位置

# node.js - 如何从 MongoJS 查询输出中选择值

> ID：11268495
> 
> 赞同：1
> 
> 时间：2012-06-29T20:24:34.617
> 
> 标签：node.js, mongodb, mongojs

我有 MongoJS 查询调用：

```
db.users.find({username:"eleeist"},function(err, docs) {
    console.log(docs);
}); 
```

该`docs`变量在控制台输出中如下所示：

```
[ { _id: 4fee05662b17f88abbeb60b6,
    username: 'eleeist',
    password: 'test' } ] 
```

我想显示用户的密码`eleeist`。

我试过`docs.password`但得到可怕的错误。

那么如何从返回的查询结果中选择值呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:33:42.430

`docs`是一个文档数组，因此要获取您要使用的第一个文档的密码`docs[0].password`。

# python - 如何在 Python 3.x 和 Python 2.x 中使用 pip

> ID：11268501
> 
> 赞同：213
> 
> 时间：2012-06-29T20:25:17.553
> 
> 标签：python, python-3.x, python-2.7, pip

我安装了 Python 3.x（除了 Ubuntu 上的 Python 2.x）并慢慢开始配对我在 Python 2.x 中使用的模块。

所以我想知道，我应该采取什么方法通过在 Python 2.x 和 Python 3.x 中使用 pip 来让我的生活更轻松？

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2012-06-30T07:06:54.150

您应该采取的方法是`pip`为 Python 3.2 安装。

您可以通过以下方式执行此操作：

```
$ curl -O https://bootstrap.pypa.io/get-pip.py
$ sudo python3.2 get-pip.py 
```

然后，您可以使用 为 Python 3.2`pip-3.2`安装东西，并使用 .为 Python 2-7 安装东西`pip-2.7`。该`pip`命令最终将指向其中之一，但我不确定是哪个，因此您必须检查。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2013-09-29T12:57:24.640

您还可以使用 apt-get：

```
apt-get install python3-pip 
```

根据我的经验，这也很流畅，而且您可以从 apt-get 中获得所有好处。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2016-03-22T05:17:36.020

首先，使用以下命令安装 Python 3 pip：

```
sudo apt-get install python3-pip 
```

* * *

然后，`Python 3 pip`使用：

```
pip3 install <module-name> 
```

使用`Python 2 pip`：

```
pip install <module-name> 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2019-07-26T14:31:45.000

最短的方法：

```
python3 -m pip install package
python -m pip install package 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-03-01T00:41:35.267

如果您不想每次使用*pip*时都指定版本：

安装点子：

```
$ curl https://raw.github.com/pypa/pip/master/contrib/get-pip.py | python3 
```

并导出路径：

```
$ export PATH=/Library/Frameworks/Python.framework/Versions/<version number>/bin:$PATH 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-10-29T05:08:30.063

在 Windows 中，首先安装 Python 3.7，然后安装 Python 2.7。然后，使用命令提示符：

> **pip** install *python2-module-name*
> 
> **pip3**安装*python3 模块名称*

就这样

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-01-10T07:25:03.293

这在 OS X 上对我有用：（我之所以这么说是因为有时 mac 有每个开源工具的“自己的”版本，你不能删除它，因为“它的改进”使它对于其他苹果的东西来说是独一无二的，如果你把它移走，事情就会开始坠落）

我按照@Lennart Regebro 提供的步骤获取python 3 的pip，但是python 2 的pip 仍然首先在路径上，所以......我所做的是在/usr/bin 中创建一个指向python 3 的符号链接（事实上，我做了同样的事情让我的 2 条蟒蛇安静地运行）：

`ln -s /Library/Frameworks/Python.framework/Versions/3.4/bin/pip /usr/bin/pip3`

**请注意**，我`3`在最后添加了 a ，所以基本上你要做的就是使用`pip3`而不是 just `pip`。

这篇文章很旧，但我希望有一天能对某人有所帮助。这在理论上应该适用于任何 LINUX 系统。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-06-17T16:38:31.877

在 Suse Linux 13.2 上，pip 调用 python3，但 pip2 可用于使用较旧的 python 版本。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-04-27T23:35:20.273

请注意，在 msys2 上，我发现这些命令很有帮助：

```
$ pacman -S python3-pip
$ pip3 install --upgrade pip
$ pip3 install --user package_name 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-05-13T11:51:20.283

以为这是老问题，我想我有更好的解决方案

1.  要将 pip 用于 python 2.x 环境，请使用以下命令 -

    py -2 -m pip install -r requirements.txt

2.  要将 pip 用于 python 3.x 环境，请使用以下命令 -

    py -3 -m pip install -r requirements.txt

# tfs - TFS：在签到时贴标签？

> ID：11268503
> 
> 赞同：3
> 
> 时间：2012-06-29T20:25:31.323
> 
> 标签：tfs, labels, checkin

我正在评估 TFS 作为公司的替代源代码控制选项，并记录如果我们开始使用它，我们当前的流程将如何改变或保持不变。

我们在当前产品中大量使用标签，不仅用于创建给定构建的快照，还用于针对未来构建的特定修改。我们的标准是始终签入每个文件，并带有其预期发布版本的标签。

我们当前的软件在签入屏幕上有一个“标签”选项，因此签入/标签是一个一步的过程。有没有办法用 TFS 做到这一点？我看到您可以在事后打开源代码控制资源管理器并标记事物，但是如果用户必须在事后单击以找到正确的变更集以标记，我想确保记录下来......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T14:36:34.127

这可能是您需要更改当前流程的地方。使用 TFS（或其他版本控制系统），针对特定版本的所有开发人员都应该使用 TFS 中的同一个分支，即，每个并行开发流都有一个专用分支。因此减少了对标签的需求。这是比使用标签更好的方法，因为您可以查看分支并查看该版本中的内容，而无需筛选标签以查看特定更改是否适用于该版本。

我建议查看[Visual Studio Team Foundation Server Branching And Merging Guide](http://vsarbranchingguide.codeplex.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T22:46:01.740

我不知道有一种自动标记每次签到的方法，但我想到了几个选项。

*   您可以设置必须填写的文本字段列表（在待定更改对话框的签入注释部分），甚至使这些字段成为必填字段，因此很容易为每个字段添加“版本”注释签入。IIRC 这是通过在团队资源管理器中右键单击团队项目并转到源代码控制选项来设置的。

*   TFS 为签入等操作引发事件，因此您可以使用 TFS api 处理服务器上的事件并自动添加标签。您甚至可以拿起签入说明来告诉您的代码标签应该是什么。

# javascript - jsLint/jsHint maven 站点报告

> ID：11268506
> 
> 赞同：0
> 
> 时间：2012-06-29T20:25:49.440
> 
> 标签：javascript, maven, jslint, jshint

我们正在寻求将 jsLint 或 jsHint 合并到我们的持续集成过程中，我发现许多 maven 插件将执行 jsLint 或 jsHint 并且如果违反规则会破坏构建。

然而，我们没有能力立即修复所有发现的问题，所以我只想使用 jsLint/jsHint 生成报告，而不是破坏构建。

我正在寻找的是一种让 jsLint/jsHint maven 插件在 mvn 站点中发布结果的方法，类似于 checkstyle。

如果有人有任何想法或知道任何具有此选项的现有插件，那将有很大帮助。

已经调查：

*   [http://mojo.codehaus.org/jslint-maven-plugin/](http://mojo.codehaus.org/jslint-maven-plugin/) - 超出了基础，但没有报告
*   [http://code.google.com/p/jslint-maven-plugin/](http://code.google.com/p/jslint-maven-plugin/) - 构建失败，没有报告

名单还在继续，许多在他们的工作上是相似的，但没有报告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T14:28:30.153

找到解决方案：http: [//www.dev.abiss.gr/mvn-jstools](http://www.dev.abiss.gr/mvn-jstools)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T19:55:35.290

[jslint4java](http://code.google.com/p/jslint4java/)可配置为不破坏构建。

# javascript - 多个事件的事件处理程序

> ID：11268507
> 
> 赞同：0
> 
> 时间：2012-06-29T20:25:52.313
> 
> 标签：javascript, jquery

> **可能重复：**
> [将多个事件绑定到 jQuery 'live' 方法](https://stackoverflow.com/questions/1646187/bind-multiple-events-to-jquery-live-method)

我有以下功能：

```
$("td.delivered").click(function() {

        $(this).html($("<input/>", {
          id: 'inp',
          style: 'width:80px;',
          placeholder: "YYYY-MM-DD",
          change: function() {
            selectdone(this, title_id, status_type);
          },
          blur: function() {
            selectdone(this, title_id, status_type);
          },
          onkeypress=="Return": function() { // pseudo-code
            selectdone(this, title_id, status_type);
          }
        })
        );
} 
```

以下作品，写它的更好方法是什么？

```
 change: function() {
            selectdone(this, title_id, status_type);
          },
          blur: function() {
            selectdone(this, title_id, status_type);
          },
          onkeypress: function(e) {
            if (e.keyCode == 13) {
            selectdone(this, title_id, status_type);
            }
          } 
```

我将如何更简洁地编写此代码，使函数在、和`selectdone`上触发？`change``blur``return`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:29:50.460

您可以使用`bind`：

```
 $(this).html($("<input/>", {
      id: 'inp',
      style: 'width:80px;',
      placeholder: "YYYY-MM-DD",
      change: function() {
        selectdone(this, title_id, status_type);
      }
  });

  $(this).bind('blur keypress change', function(e){
     selectdone(this, title_id, status_type);
  }); 
```

您可能需要针对不同的事件修改代码。请注意，要知道当前触发了哪个事件，您可以使用`e.type`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:29:59.610

```
$(this).html($("<input/>", {
      id: 'inp',
      style: 'width:80px;',
      placeholder: "YYYY-MM-DD"
  });

$('input', this).bind('change blur keypress', function(e) {
    if(e.type != 'keypress' || e.keyCode == 13){
        selectdone(this, title_id, status_type);
    }
}); 
```

# mod-rewrite - ISAPI PHP 重写

> ID：11268508
> 
> 赞同：1
> 
> 时间：2012-06-29T20:25:55.600
> 
> 标签：mod-rewrite, url-rewriting, iis-6, isapi

一个朋友让我想办法在他的 Windows 服务器上进行 modrewrite。他正在运行 IIS 6，而 Isapi 是我能找到的唯一东西。我不熟悉它并阅读了一些文档，但不能完全理解它。他想重写这些 URL 以使它们干净

www.domain.com/cat.php?CTGID=####

和

www.domain.com/pp.php?ID=##

我将如何重写这两个 URL 以使它们在 ISAPI 中干净。我已经将它安装在 Windows Server 上，我是将这些规则放在他的网站文件夹中的 IISF.ini 中还是将这些代码放在主 IISF 文件中？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T00:41:49.900

重写规则位于 web.config 文件或 ApplicationHost.config 中。如[http://learn.iis.net/page.aspx/465/url-rewrite-module-configuration-reference/中所述](http://learn.iis.net/page.aspx/465/url-rewrite-module-configuration-reference/)

例子

```
<rewrite>
<rules>

    <rule name="Force WWW" stopProcessing="true"> 
        <match url=".*" /> 
        <conditions> 
            <add input="{HTTP_HOST}" pattern="^example.com$" /> 
        </conditions> 
        <action type="Redirect" url="http://www.example.com/{R:0}" redirectType="Permanent" /> 
    </rule> 

    <rule name="Redirect from blog">
      <match url="^blog/([_0-9a-z-]+)/([0-9]+)" />
      <action type="Redirect" url="article/{R:2}/{R:1}" redirectType="Found" />
    </rule>

    <rule name="Rewrite to article.aspx">
      <match url="^article/([0-9]+)/([_0-9a-z-]+)" />
      <action type="Rewrite" url="article.aspx?id={R:1}&amp;title={R:2}" />
    </rule>

</rules>
</rewrite> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-16T16:58:53.680

对于 IIS，如果安装了 ISAPI_Rewrite 模块，则设置 $_SERVER["IIS_UrlRewriteModule"] 并包含模块的版本号。因此，您可以检查此服务器变量是否存在。

# vim - 如何在 vim 中语法突出显示自定义的自关闭脚本标记？

> ID：11268510
> 
> 赞同：1
> 
> 时间：2012-06-29T20:25:58.797
> 
> 标签：vim, syntax-highlighting, dsl

我知道[普通的脚本标签不能自我关闭](https://stackoverflow.com/questions/4531772/can-the-script-tag-not-be-self-closed)，而且我对 vimscript 的了解比我可能的要少。我一直在使用与 HTML 非常相似的自定义 XML 模板语言，并且一直在使用 HTML 模式和文件`~/.vim/after/syntax/html.vim`：

```
syn region javaScript start=+<is:PageComponents:Script[^>]*>+ keepend end=+</is:PageComponents:Script>+me=s-1 contains=@htmlJavaScript,htmlCssStyleComment,htmlScriptTag,@htmlPreproc
syn region htmlScriptTag contained start=+<is:PageComponents:Script+ end=+>+ contains=htmlTagN,htmlString,htmlArg,htmlValue,htmlTagError,htmlEvent 
```

我遇到的问题是突出显示区域的“溢出”，直到文件结尾或下一个结束脚本标记。

我尝试将 start 更改为:`+<is:PageComponents:Script[^>]*\(\\\)\@<!>+`和`+<is:PageComponents:Script[^>]*[^\\]>+`，这两者都没有区别。据我了解正则表达式，消极的lookbehind应该是一个理想的解决方案，一个字符匹配应该迫使贪婪的明星后退一个字符，导致失败。用不贪婪的行为替换`*`具有相同的结果。`\{-}`我错过了什么？

如果相关，我在 Cygwin 的 mintty 中运行 vim（类型是 xterm-256color），shell 是 bash，配色方案是[solarized](http://ethanschoonover.com/solarized)。

编辑：添加我们的标记语言示例

```
<is:PageComponents:Template title="Page Title" controller="controller">
    <is:PageComponents:Script src="/path/jsfile.js" />
    <is:PageComponents:Style src="cssfile.css" />
    <is:Containers:Box label="Box Label">
        <is:DataGridComponents:DataGrid id="data_grid_id" data_provider="data_provider" keep_state="true">
            <is:DataGridComponents:DataGridHeader />
            <is:DataGridComponents:Columns strip_placeholders="false" id="%%id%%_row">
                <is:DataGridComponents:Column header_title="Links Header">
                    <span class="popup-link popup-link-type1" id="type1_%%id%%">Type 1</span> |
                    <span class="popup-link popup-link-type2" id="type2_%%id%%">Type 2</span>
                </is:DataGridComponents:Column>
                <is:DataGridComponents:Column header_title="Data1">%%data1%%</is:DataGridComponents:Column>
                <is:DataGridComponents:Column header_title="Data2">%%data2%%</is:DataGridComponents:Column>
            </is:DataGridComponents:Columns>
            <is:DataGridComponents:DataGridFooter>
                <is:DataGridComponents:Pager id="pager_id" data_provider="pager_data_provider" for_component="data_grid_id" />
                <is:Containers:Box id="footer_box_id" data_provider="footer_box_data_provider">Text: %%data%%</is:containers:box>
            </is:DataGridComponents:DataGridFooter>
        </is:DataGridComponents:DataGrid>
    </is:Containers:Box>
    <is:PageComponents:Script location="onready">
    {literal}
        // Insert literal JavaScript code here for the page
    {/literal}
    </is:PageComponents:Script>
    {include file="path/file1.tpl"}
    {include file="path/file2.tpl"}
</is:PageComponents:Template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:02:44.760

当我切换到使用`/`而不是`\`在我的比赛中时，我的两种模式都能正常工作。

修正后的模式是： `+<is:PageComponents:Script[^>]*\(/\)\@<!>+`和 `+<is:PageComponents:Script[^>]*[^/]>+`。

# c# - 将字符串数组转换为字节数组

> ID：11268514
> 
> 赞同：3
> 
> 时间：2012-06-29T20:26:08.510
> 
> 标签：c#, arrays, string, byte

好的，在任何人试图将其标记为重复之前，我*并不是*要一个字符串到一个字节数组。我想要一个字符串数组，包含类似这样的内容： {"5","168","188","28","29","155"} 被转换为字节数组。我已经搜索过，只能找到字符串到字节数组，这是完全不同的。谢谢。

编辑：数组将被预设，以便每个成员都可以通过 byte.Parse 解析，所以这不是问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T20:31:08.007

*对于无法*解析的任何内容，这将失败`byte.Parse`

```
var str = new[] {"5", "168", "188", "28", "29", "155"};
var byt = str.Select(byte.Parse).ToArray(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-29T20:36:14.237

您必须将每个字符串解析为一个字节并放入一个新数组中。您可以遍历项目并转换每个项目：

```
string[] strings = { "5", "168", "188", "28", "29", "155" };
byte[] bytes = new byte[strings.length];
for (int i = 0; i < strings.Length; i++) {
  bytes[i] = Byte.Parse(strings[i]);
} 
```

您也可以使用以下[`Array.ConvertAll`方法](http://msdn.microsoft.com/en-us/library/exc45z53.aspx)：

```
string[] strings = { "5", "168", "188", "28", "29", "155" };
byte[] bytes = Array.ConvertAll(strings, Byte.Parse); 
```

您还可以使用 LINQ 扩展来执行此操作：

```
string[] strings = { "5", "168", "188", "28", "29", "155" };
bytes = strings.Select(Byte.Parse).ToArray(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T20:30:58.267

假设您的意思是您有一个字符串数组，例如`string[] myArray = {"5","168",...};`：

```
myArray.Select(x => byte.Parse(x)).ToArray(); 
```

或者：

```
myArray.Select(byte.Parse).ToArray(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-29T20:31:18.557

试试这个

**带 linq**

```
string[] strings = new[] { "1", "2", "3", "4" };
byte[] byteArray = strings.Select(x =>  byte.Parse(x)).ToArray(); 
```

**没有 linq**

```
string[] strings = { "1", "2", "3", "4" };

byte[] bytArr = new byte[strings.Length];

int i = 0;

foreach(String text in strings)
{
  bytArr[i++] = byte.Parse(text);  
} 
```

# load-balancing - ZMQ 设备队列没有正确负载均衡

> ID：11268518
> 
> 赞同：0
> 
> 时间：2012-06-29T20:26:27.630
> 
> 标签：load-balancing, distributed-computing, zeromq

我知道 ZMQ 提供了所有的灵活性来做你自己的负载平衡。但是我希望开箱即用的代理，大约 4 行代码使用该行

`zmq_device (ZMQ_QUEUE, frontend, backend);`

负载平衡很好，因为文档说它确实负载平衡。

> ZMQ_QUEUE 创建一个共享队列，从一组客户端收集请求，并将这些请求公平地分配给一组服务。请求从前端连接公平排队并在后端连接之间进行负载平衡。回复会自动返回到发出原始请求的客户端。

我有一大群后端服务，但发现我的前端客户端通常必须等待几秒钟才能在 1:1 设置中花费 < 1/10 秒的时间（客户端和服务的数量相同）机）。我怀疑 ZMQ 没有开箱即用地正确进行负载平衡 - 即使它没有带宽等，它也会向同一个服务发送太多请求。

我认为这部分是因为服务是多线程的，可以让它们最多处理 10 个并发请求，但在接近第 10 个请求时它会大大减慢，即使它仍然可以接受它们。随机分布将是理想的。是否有开箱即用的方法来做到这一点，或者可以用几行代码完成，还是我必须从头开始编写自己的代理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T20:08:26.817

Fwiw 问题是工人在没有空间的时候开始工作，问题不在于 ZMQ 层本身。

# c# - PetaPOCO 和超过 4 个连接

> ID：11268519
> 
> 赞同：2
> 
> 时间：2012-06-29T20:26:34.370
> 
> 标签：c#, orm, petapoco

petapoco 是否能够实现以下目标： 1.一个查询中的无限连接 2.一个查询中的无限一对多关系

我看过 PetaPOCO，似乎它不能进行超过 4 个连接，最长的签名看起来像：db.Query<T1, T2, T3, T4>

似乎它也支持一对多关系，但仅适用于一个复合对象，如下所示： db.FetchOneToMany<T1, T2> 其中 T2 是 T1 的外键

我正在测试一些微型 ORM 以坚持使用最好的。您是否知道其中任何一个可以处理这些情况，如果没有一个微型 ORM 支持此功能，您将如何处理如下所示的对象：

```
class A
{
    List<B> member1;
    List<C> member2; 
    Z  member3; //Composit object
    Z1 member4; //Composit object
    Z2 member5; //Composit object
    Z3 member6; //Composit object
    Z4 member7; //Composit object
} 
```

然后更复杂的是，如果成员 1（类型 B）本身有一些复合对象怎么办？如果我们有：

```
class B
{
    G member0;
} 
```

请不要提出多次访问数据库的解决方案，因为当对象变得有点复杂时，调用会太多。

哦，我也知道解决无限连接情况的另一种方法是创建一个非常扁平的对象，它将所有字段组合在一起。这根本不是一个优雅的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T15:30:54.277

T1..T$ Query() 重载都传递给主 Query(..Type[]..) 方法。您可以自己添加更多 Query() 重载来处理更多 T 参数，或者在 Type 数组中传入您需要的所有类型（这是 T1-T4 函数所做的）：

```
Query<TRet>( new Type[]{typeof(Poco1), typeof(Poco2), typeof(Poco3), typeof(Poco4), typeof(Poco5)}, null, sql, args); 
```

您可以有多个一对多关系，但 Schotime 是对的，您需要非常小心返回结果集中的大量重复数据。写sql查询，看看结果集，重复量你能接受吗？如果是这样，那么在 Petapoco 中有一个关系回调的概念，您可以在其中编写一个小类来处理单个结果行中的不同 poco，并将每个 poco 添加到父 poco 上的列表属性中。

[http://www.toptensoftware.com/Articles/115/PetaPoco-Mapping-One-to-Many-and-Many-to-One-Relationships](http://www.toptensoftware.com/Articles/115/PetaPoco-Mapping-One-to-Many-and-Many-to-One-Relationships)

我从来没有用多个一对多做这个，但从上面引用

> “如果你要加入两个以上的表，你将需要更复杂的东西，但它实际上只是上面的扩展。”

另一种选择是拥有一个存储过程，它在单个数据库请求中完成所有工作并让它返回多个结果集，我相信 Schotime 在他的 petapoco 分支中已经实现了，但我自己还没有使用它，所以我不能真的评论它是否有帮助：

[http://schotime.net/blog/index.php/2011/11/20/petapoco-multiple-result-sets/](http://schotime.net/blog/index.php/2011/11/20/petapoco-multiple-result-sets/)

如果我**绝对必须**一次性将所有数据连接到您建议的复杂和嵌套对象，那么我将使用存储过程（单个数据库调用）并将它们与代码拼接在一起。只有这样我才能弄清楚如何在 Petapoco 中做到这一点。但是，如果您的 UI 在用户单击扩展器按钮（或类似按钮）之前不显示所有嵌套数据，那么我会在那时使用 AJAX 调用，而不是最初获取所有数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-05T21:01:52.727

答案是正确的，但我是从另一个论坛来到这个页面的，那里没有人可以完成这项工作，所以我想我会加入我所做的事情以使事情更清楚。基本上，我有如下代码：

```
var sql = "select * from someTable where tableId = @0";
var listOfStuff = _petapoco.Fetch<FirstType, SecondType, ThirdType, FourthType, FirstType>(new RelatorClass().MapIt, sql, idVar); 
```

由于我需要添加第五个 poco，并且所有 Fetch 方法最终都会导致上面接受的答案中列出的主 Query 方法，所以我必须这样做：

```
var sql = "select * from someTable where tableId = @0";
Func<FirstType, SecondType, ThirdType, FourthType, FifthType, FirstType> mapIt = new RelatorClass().MapIt;
var listOfStuff = _petapoco.Query<FirstType>(new[] { typeof (FirstType), typeof (SecondType), typeof (ThirdType), typeof (FourthType), typeof(FifthType)}, mapIt, sql, idVar).ToList(); 
```

现在我可以用 5 个 pocos 进行查询，而不必修改 PetaPoco 代码。唯一要做的事情是添加到您的关系器类中，这样您就可以告诉 PetaPoco 将新数据映射到哪里，您就可以开始了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-15T17:09:27.487

**委托：** 注意：你不必`(UserActivity,int)`像这样返回匿名类型，你可以返回没有括号的单个类型！我只是懒惰，不想为返回类型创建新模型。

```
private delegate (UserActivity, int) GetIt(int fk_AccountTypeValue, UserActivityModel ua, User u, Client c, Client_Account ca); 
```

**SQL操作：**

```
public List<(UserActivity,int)> SomeMethodName(int orgnizationID)
        {
                    var sql = Sql.Builder
                        .Select("TOP(200) at.FK_AccountTypeValue, ua.*, u.*, c.*, ca.*")
                        .From("UserActivity ua")
                        .LeftJoin("Users u").On("u.PK_UserID = ua.FK_UserID")
                        .LeftJoin("Client c").On("c.FK_UserID = u.PK_UserID")
                        .LeftJoin("Client_Account ca").On("ca.FK_ClientID = c.PK_ClientID")
                        .LeftJoin("AccountType at").On("at.PK_AccountType = c.FK_AccountTypeID")
                        .Where("u.FK_OrganizationID =@0", orgnizationID)
                        .OrderBy("ua.Timestamp desc");
                    GetIt obj = new GetIt(youKnowIt);
                    var typs = new Type[]{typeof(int), typeof(UserActivityModel), typeof(User), typeof(Client), typeof(Client_Account)};
                    var uaList = _database.Query<(UserActivity, int)>(typs, obj, sql.SQL, sql.Arguments).ToList();
                    return uaList;
        } 
```

**委托指向的方法：**

```
private (UserActivity,int) youKnowIt(int fk_AccountTypeValue, UserActivityModel ua, CurrentDesk.Models.User u, CurrentDesk.Models.Client c, CurrentDesk.Models.Client_Account ca)
        {
            // do stuff
            var uam = new UserActivity()
            {
                // assign stuff
            };
            return (uam, fk_AccountTypeValue);
        } 
```

# c# - 如何将 DataGridViewComboBoxColumn 绑定到返回列表的对象的属性/方法？

> ID：11268520
> 
> 赞同：4
> 
> 时间：2012-06-29T20:26:37.963
> 
> 标签：c#, winforms, data-binding, datagridview

我有一个具有多个属性的自定义对象，其中一个返回一个列表。这是对象的代码：

```
public class SearchResult
{
    private int eventId;
    private String eventTitle;
    private int startDate;
    private List<String> tags;

    // Properties
    public int EventId { get { return this.eventId; } }

    public String EventTitle { get { return this.eventTitle; } }

    public int StartDate { get { return this.startDate; } }

    public List<String> Tags { get { return this.tags; } }

    public SearchResult(int eventId, String eventTitle, int startDate, List<String> tags)
    {
        // Constructor code
    }

    public List<String> GetTags()
    {
        return this.tags;
    }
} 
```

我还有一个`DataGridViewComboBoxColumn`我想绑定到`Tags`属性的东西。基本上，每个`SearchResult`对象都将显示在自己的行中，我希望每个对象的`List<String>`in`Tags`属性都显示在`ComboBox`该行的单元格中。这是我到目前为止的代码`DataGridView`：

```
BindingList<SearchResult> results = new BindingList<SearchResult>();
results.Add(new SearchResult(1, "This is a title", 2012, new List<String> { "Tag1", "Tag with a long name1" }));
results.Add(new SearchResult(2, "The quick brown fox", 2012, new List<String> { "Stack", "Overflow" }));
results.Add(new SearchResult(3, "In this tutorial, you create a class that is the type for each object in the object collection. ", 2012, new List<String> { "NYSE", "FTSE" }));
results.Add(new SearchResult(4, "another long piece of title text", -999, new List<String> { "Rabbits", "Chickens" }));

MyDataGrid.AutoGenerateColumns = false;
MyDataGrid.AllowUserToAddRows = false;
MyDataGrid.AllowUserToDeleteRows = false;
MyDataGrid.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.None;
MyDataGrid.BackgroundColor = System.Drawing.SystemColors.Control;
MyDataGrid.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
MyDataGrid.RowHeadersWidthSizeMode = System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders;
MyDataGrid.AutoSizeRowsMode = System.Windows.Forms.DataGridViewAutoSizeRowsMode.DisplayedCells;
MyDataGrid.DefaultCellStyle.WrapMode = DataGridViewTriState.True;

DataGridViewTextBoxColumn eventIdColumn = new DataGridViewTextBoxColumn();
eventIdColumn.DataPropertyName = "EventId";
eventIdColumn.HeaderText = "Event ID";
eventIdColumn.ReadOnly = true;
eventIdColumn.Width = 84;

DataGridViewTextBoxColumn eventTitleColumn = new DataGridViewTextBoxColumn();
eventTitleColumn.DataPropertyName = "EventTitle";
eventTitleColumn.HeaderText = "Event Title";
eventTitleColumn.ReadOnly = true;
eventTitleColumn.Width = 368;

DataGridViewTextBoxColumn startDateColumn = new DataGridViewTextBoxColumn();
startDateColumn.DataPropertyName = "StartDate";
startDateColumn.HeaderText = "Start Date";
startDateColumn.ReadOnly = true;
startDateColumn.Width = 130;

//I think I need to insert the code for the tags column here, but I'm not sure

MyDataGrid.Columns.Add(eventIdColumn);
MyDataGrid.Columns.Add(eventTitleColumn);
MyDataGrid.Columns.Add(startDateColumn);
//MyDataGrid.Columns.Add(tagsColumn);

MyDataGrid.DataSource = results; 
```

[我从网上找到的教程中](http://www.switchonthecode.com/tutorials/csharp-tutorial-binding-a-datagridview-to-a-collection)得出了这段代码，它运行良好。

我一直在尝试将 的`Tags`属性绑定`SearchResult`到 a `DataGridViewComboBoxColumn`，但我不确定如何。我一直在看[这个问题](https://stackoverflow.com/questions/631126/how-to-bound-a-datagridviewcomboboxcolumn-to-a-object)，它提供了这个代码：

```
column.DataPropertyName = "Foo";
column.DisplayMember = "SomeNameField"; 
column.ValueMember = "Bar"; // must do this, empty string causes it to be 
                            // of type string, basically the display value
                            // probably a bug in .NET
column.DataSource = from foo in Foo select foo;
grid.DataSource = data; 
```

我遇到麻烦的原因是我不理解的链接问题的一些细微差别。

1.  根据[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcolumn.displaymember.aspx)和链接的问题，`DisplayMember`应该链接到“包含实例描述”的属性，但是由于`SearchResult`对象是动态添加的并且没有与之关联的任何描述，我应该将其留空吗？
2.  `ValueMember`[给了我类似的问题，因为即使在阅读了它的文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcolumn.valuemember.aspx)之后我也不确定该放什么。
3.  在链接的问题中，接受的答案使用 LINQ 一次绑定整个数据网格。我应该这样做吗？我不确定如何根据我的情况修改该代码，但我认为它会是这样的。

：

```
tagsColumn.DataPropertyName = "Tags";
tagsColumn.DisplayMember = ""; // I'm unsure of what to put here
tagsColumn.ValueMember = ""; // Once again, I don't know what to set this to 
```

我还认为我应该有一个设置`DataSource`列的行，例如

```
tagsColumn.DataSource = <some LINQ query, perhaps?> 
```

但我不知道，因为我能找到的唯一最相关的 C# 源代码就是那个问题。

# 更新：

我确实找到[了第二个问题，该问题](https://stackoverflow.com/questions/1390462/datagridviewcomboboxcolumn-name-value-how)建议使用与此类似的代码进行数据绑定：

```
// reference the combobox column
DataGridViewComboBoxColumn cboBoxColumn = (DataGridViewComboBoxColumn)dataGridView1.Columns[0];
cboBoxColumn.DataSource = Choice.GetChoices();
cboBoxColumn.DisplayMember = "Name";  // the Name property in Choice class
cboBoxColumn.ValueMember = "Value";  // ditto for the Value property 
```

基于此，我 a) 添加了该`GetTags()`方法`SearchResult`并将此代码添加到我的`DataGridView`初始化代码中：

```
 DataGridViewComboBoxColumn tagsColumn = new DataGridViewComboBoxColumn();
        tagsColumn.DataSource = SearchResult.GetTags(); // ERROR 
        tagsColumn.DisplayMember = ""; // Still not sure
        tagsColumn.ValueMember = ""; // ?? 
```

但是，当我尝试运行它时，Visual Studio 在第二行给我一个错误：

```
An object reference is required for the non-static field, method, or property 'SearchResult.GetTags()' 
```

# 更新 2：

我仍在寻找这个没有成功。我不明白如何使用其他属性（例如`EventId`）我可以简单地将数据属性名称声明为`EventId`，它将显示在表中，但我不能对`ComboBox`列执行此操作。

`Tags`由于对象是在一个单独的类中实例化并放入一个列表中，因此我应该遍历整个对象数组（其中可能有数百个）来绑定属性对我来说似乎没有意义到`ComboBox`每个实例的列，当*我不需要遍历`SearchResult`对象列表来绑定其他属性时，例如`EventId`*.

为什么这个 binding-properties-by-name 只适用于*某些*属性而不适用于其他属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T10:46:10.247

我不太明白您为什么要使用它`DataGridViewComboBoxColumn`来显示元素列表。此列类型旨在允许用户选择多种可能性中的一种。它接缝不是你的情况，因为你没有`public string SelectedTag{get;set;}`财产来存储它。据我了解您的模型，您已经为您选择了许多标签，`SearchResult`并且您希望在网格中显示它们。

如文档所述：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcolumn.datasource](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcolumn.datasource)

> 获取或设置此 [ *DataSource* ] 属性获取或设置由 CellTemplate 属性返回的对象的 DataSource 属性。设置此属性还会设置列中**每个单元格**的 DataSource 属性并刷新列显示。要覆盖单个单元格的指定值，请在设置列值后设置单元格值。

DataGridViewComboBoxColumn 根本无法将 items 属性绑定到数据源，因为它假定只有一个元素列表用作数据网格所有行的数据源。

我还假设您会`ReadOnly = true`像为所有其他列设置属性一样为该列设置属性。如果是这样，它将阻止用户表单查看标签列表，因为永远不会显示下拉列表。

如果您想以只读模式显示字符串列表，我建议将此标签列表展平为单个字符串：

```
public string Tags { get { return string.Join(", ", tags); } } 
```

并将其显示在文本列中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:13:08.973

对于这个错误，我可以建议你创建一个类的实例，然后调用该方法，因为它不是静态的，或者你可以使你的方法成为静态的。

此外，当您需要 comboboxcolumn 时，

```
DataGridViewComboBoxColumn tagsColumn = new DataGridViewComboBoxColumn();
        tagsColumn.DataSource = SearchResult.GetTags(); // ERROR 
        tagsColumn.DisplayMember = ""; // Still not sure
        tagsColumn.ValueMember = ""; // ?? 
```

大多数情况下，我们有 Country(id,name) 等对象的下拉列表，因此 DisplayMember = name 将在下拉列表中显示为文本，而 ValueMember = id 将在数据库中的引用表中使用。但这不是你的情况。

在这里，您有一个要在下拉列表中显示的字符串列表，因此您无需设置它们。[如此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcolumn.datasource.aspx)所写

> 如果 DataSource 属性设置为字符串数组，则不需要设置 ValueMember 和 DisplayMember，因为数组中的每个字符串都将用于值和显示。

# c++ - 矢量循环未到达所有元素

> ID：11268529
> 
> 赞同：0
> 
> 时间：2012-06-29T20:27:11.777
> 
> 标签：c++, loops, vector

我有以下一段代码，它接收一些单词，将它们存储到一个向量中，对它们进行排序，然后计算每个单词出现的次数并输出它：

```
typedef vector<double>::size_type vec_sz;
vector<string> words;

string c;

cout << "Enter some words!" << endl << endl;
while (cin >> c) {
    words.push_back(c);
}

vec_sz size = words.size();
sort(words.begin(), words.end());

string current_word = words[0];
int count = 1;

for (int i = 1; i < size; i++) {
    if (words[i] == current_word) {
        count++;
    }
    else {
        cout << "The word " + current_word + " appears " << count << " times." << endl;
        current_word = words[i];
        count = 1;
    }
} 
```

我输入一些词：

```
word
word
lol
hello
lol
word
hello
^Z 
```

然后我得到以下输出：

```
The word hello appears 2 times.
The word lol appears 2 times. 
```

但它永远不会到达最后的一组单词。我将循环更改为仅打印出向量中的每个元素，并且确实打印出所有元素。但是由于某种原因，这个循环不想到达最终的单词集。出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:30:55.233

最后一句话，在这里：

```
else {
    // Previous word printed
    cout << "The word " + current_word + " appears " << count << " times." << endl;
    // current_word set to last word
    current_word = words[i];
    count = 1;
} 
```

然后循环退出。因此，您需要循环外的最后一行来打印最后一个单词及其计数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T20:31:05.923

只有在找到不同的单词时才会打印计数消息。当找到最后一个单词时，不会遇到不同的单词，因此不会打印消息。您需要一段代码`for`来打印最后一个单词的计数。

还有其他方法可以实现这一点，`std::map<std::string, unsigned int>`例如：

```
map<string, unsigned int> word_counts;
string c;

cout << "Enter some words!" << endl << endl;
while (cin >> c) {
    word_counts[c]++;
}

for (map<string, unsigned int>::iterator wci = word_counts.begin();
     wci != word_counts.end();
     wci++)
{
    cout << "The word " << wci->first << " appears " << wci->second << "times.";
} 
```

# javascript - javascript将参数传递给兄弟对象

> ID：11268530
> 
> 赞同：1
> 
> 时间：2012-06-29T20:27:13.023
> 
> 标签：javascript, arguments

我有这样的事情：

```
function showFunction () {
  // need position and place
}

var obj = {
  position: 1,
  place: 2,
  onShow: showFunction
} 
```

如何从 showFunction 访问位置和地点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T20:31:59.733

[`this`](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)应该管用：

> 当一个函数作为对象的方法被调用时，它的*this*被设置为调用该方法的对象。

```
function showFunction() {
    console.log(this.position, this.place);
}
var obj = {
    position: 1,
    place: 2,
    onShow: showFunction
}
obj.onShow() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T20:30:54.660

由于函数是在 JavaScript 中提升的，因此您只需像在函数外部一样引用函数内部`.position`和`.place`内部：

```
function showFunction() {
  return obj.position;
} 
```

但是如果由于某种原因你不能访问`obj`，你可以，正如乔纳森所说，`obj`作为参数传递给`showFunction()`.

```
function showFunction(obj) {
    return obj.position;
}

var obj = {
  position: 1,
  place: 2,
  onShow: function() {
      return showFunction(obj);
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T20:30:56.050

因为您正在成为`showFunction`的成员`obj`，所以您可以通过 访问该对象`this`。

```
function showFunction () {
    var a, b;
    a = this.position;
    b = this.place;
}

var obj = {
  position: 1,
  place: 2,
  onShow: showFunction
} 
```

或者，您可以`obj`像在函数之外一样访问：

```
function showFunction () {
    var a, b;
    a = obj.position;
    b = obj.place;
} 
```

# c++ - 不能重载函数

> ID：11268535
> 
> 赞同：3
> 
> 时间：2012-06-29T20:27:31.430
> 
> 标签：c++, templates, specialization

所以我有一个模板化的类，我想在我有特定类型时重载函数的行为，比如 char。对于所有其他类型，让他们做自己的事情。但是，c++ 不会让我重载该函数。

为什么我不能重载这个函数？我**真的真的**不想做模板专业化，因为那样我就复制了整个班级。

这是一个演示问题的玩具示例：http: [//codepad.org/eTgLG932](http://codepad.org/eTgLG932)

为了您的阅读乐趣，此处发布了相同的代码：

```
#include <iostream>
#include <cstdlib>
#include <string>

struct Bar
{
  std::string blah() { return "blah"; }
};

template <typename T>
struct Foo
{
public:
  std::string doX()
  {
    return m_getY(my_t);
  }

private:
  std::string m_getY(char* p_msg)
  {
    return std::string(p_msg);
  }

  std::string m_getY(T* p_msg)
  {
    return p_msg->blah();
  }

  T my_t;
};

int main(int, char**)
{
  Foo<char> x;
  Foo<Bar> y;
  std::cout << "x " << x.doX() << std::endl;
  return EXIT_SUCCESS;
} 
```

* * *

谢谢大家的建议。已经提出了两种有效的解决方案。我可以专门化 doX 方法，或者专门化 m_ge​​tY() 方法。

归根结底，我更喜欢将我的专业化保密而不是公开，所以我接受了 Krill 的回答。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T20:30:36.987

您可以将整个模板类中的一个函数专门化为特定类型，而无需专门化整个类。它看起来像这样：

```
template <> void Foo<char>::doX() {
     /* custom implementation here */
} 
```

您在实践中很少看到这种情况，但这是完全合法的 C++ 代码。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T20:30:21.313

```
 std::string m_getY(char* p_msg)
  {
    return std::string(p_msg);
  }

  std::string m_getY(T* p_msg)
  {
    return p_msg->blah();
  } 
```

这里的问题是，当`T`是时`char`，您最终会得到两个具有相同签名的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T20:33:12.963

您可以使您的方法`m_getY`成为成员函数模板。他们使这个函数模板专门化`char*`或简单地定义一个带有`char*`参数的方法。在这种情况下，您不必复制整个班级。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T21:00:15.563

```
std::string m_getY(char* p_msg)
{
  return std::string(p_msg);
}

template<typename U> 
std::string m_getY(U* p_msg)
{
  return p_msg->blah();
} 
```

will not conflict with each other (and the former is *not* a specialisation of the latter, as it is not a template)

# javascript - 使用 d3.js 强制布局定位节点时出现问题。节点“重新输入”每个数据更新，内部示例

> ID：11268540
> 
> 赞同：4
> 
> 时间：2012-06-29T20:28:13.857
> 
> 标签：javascript, d3.js, visualization, force-layout

几天前我曾问过这个问题，但我认为除了 paxRoman 之外的任何人都没有真正弄清楚我在问什么，因为没有一个例子很难描述。

然而，我们确实设法找出可能是我的问题，并且我设法将代码放在 bl.ocks.org 上，这样您就可以看到我的意思的示例！

**这是示例：** [http ://bl.ocks.org/3020018](http://bl.ocks.org/3020018)

每次刷新数据（在本例中，只是从 json 文件中读取），所有节点都会重新创建并重新添加到绘图中。

**我想要发生的事情**

我希望节点在不移动的情况下更新。

如果新数组中存在一个新节点，它应该像现在一样出现，如果前一个数组中存在某些东西但新数组中没有，它应该简单地消失。

正如您在示例中看到的那样，这不是正在发生的事情，我无法弄清楚过去一周的原因。

**所以我的问题是：**

我实际上做错了什么？是我缺少链接吗？问题是什么？我们两个昨天花了一个多小时看这个，但无法理解，我已经花了一个星期的时间，但没有太大进展：/

我的旧问题/帖子[仍然存在](https://stackoverflow.com/questions/11209847/problems-adding-and-removing-nodes-in-a-force-layout-using-d3-js)，但它的表述很糟糕，我没有例子可以展示。

谢谢你帮助我:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T12:13:34.447

所以，我很确定我已经解决了我的大部分问题！

归结为我在更新数据时如何添加/修改节点。我完全忘记了 x/y 和类似属性，因为我自己没有设置它们，所以每次更新数据时我都会添加“新”对象，即使它们实际上并不是新的。

使用一些 jQuery 魔法，`$.extend()`我已经让它工作了，但每当我更新数据时它仍然会轻微移动/脉动。

我更新了要点以显示更改。[http://bl.ocks.org/3020018](http://bl.ocks.org/3020018)

我仍然想消除那个小脉动，所以如果你有任何想法，请告诉我:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-23T15:16:46.667

您是否尝试过设置摩擦参数（在哪里设置了链接距离和电荷）？将其设置为 0.9 将加快找到最终位置，因为我认为如果未设置它默认为 1。它只是添加的一个案例

```
.friction(0.9) // or any suitable value closer to 0 - have a play! 
```

希望有帮助

# mstest - 程序集绑定在 mstest 中不起作用

> ID：11268547
> 
> 赞同：3
> 
> 时间：2012-06-29T20:29:08.940
> 
> 标签：mstest, visual-studio-2012

我有一个非常简单的 MSTest 单元测试项目，它间接依赖于两个版本的 MVC。

app.config 中的 assemblybinding 配置为重定向到 MVC v4

当我运行 mstest 测试运行程序（内置 VS2012 RC）时 - 我收到异常，表明程序集绑定不起作用。

如果我创建 testsettings 文件并禁用部署（或启用部署并将 app.config 添加到要部署的项目列表中） - 测试通过。

**问题：**为什么装配绑定在部署设置为 false 的情况下工作？我可以在不使用 testsettings 文件的情况下通过此测试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T18:27:34.540

我在 vs2012、mstest 和 R# 上遇到了同样的事情，这似乎是一个已确认的错误： [http ://social.msdn.microsoft.com/Forums/en-US/vsunittest/thread/234926d1-42c0- 4ebb-af39-1626e72f6c39](http://social.msdn.microsoft.com/Forums/en-US/vsunittest/thread/234926d1-42c0-4ebb-af39-1626e72f6c39)

在 R# 中添加指向同一错误报告的链接：

[http://youtrack.jetbrains.com/issue/RSRP-329567](http://youtrack.jetbrains.com/issue/RSRP-329567)

# sublimetext2 - Sublime text 2：类导航器或浏览器侧边栏

> ID：11268552
> 
> 赞同：26
> 
> 时间：2012-06-29T20:29:23.230
> 
> 标签：sublimetext2

sublime2 中是否有插件（或设置）显示活动文件中的类的带有导航器（或树视图）的侧窗格？类似于 netbeans 中的类导航器？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-09T09:59:47.843

使用`CTRL`+`R`命令浏览当前文件上的符号，使用`CTRL`+ `SHIFT`+ `R`（仅在 Sublime Text 3 中可用）浏览选项卡中打开的所有文件中的符号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-14T22:55:15.513

**我认为[CTags](https://github.com/SublimeText/CTags)也是一个不错的候选人。**

它使用`ctags`可执行文件来索引您的所有项目文件，并允许您浏览整个项目中的符号。相当令人印象深刻。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T16:25:15.850

使用 Sublime2，`CMD`+`R`是“转到”菜单上的“转到符号”选项。你可能已经重新映射了它。虽然它不是一个永久性的屏幕导航器（例如 NetBeans），但它使用起来非常快捷。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-04T09:10:51.673

您必须在这里投票才能看到在 SublimeText 中实现的此功能：http: [//sublimetext.userecho.com/topics/1265-add-a-class-browser/](http://sublimetext.userecho.com/topics/1265-add-a-class-browser/)

与此同时，`CTRL+R`是唯一的选择......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-01T04:01:56.297

CMD+R 和 SHIFT+CMD+R 在 Mac 的 Sublime Text 3 上可用。CMD+R 将浏览当前打开文件中的符号，如前所述，而 SHIFT+CMD+R 将浏览所有打开文件中的所有符号，如果您没有打开 ST3 项目，或者浏览所有项目文件中的所有符号，如果一个项目是开放的。

# java - 使用代码运行 .jar

> ID：11268554
> 
> 赞同：2
> 
> 时间：2012-06-29T20:29:36.927
> 
> 标签：java, jar

我正在尝试从代码运行 jar 文件 - 在“启动器”中。启动器是一个小程序，用于下载所需的文件。

但是由于某种原因，它只适用于某些计算机？我似乎无法在它不起作用的计算机之间建立任何链接。下面是我的代码：

```
ProcessBuilder pb = new ProcessBuilder(System.getProperty("java.home") + "\\bin\\javaw", "-jar", data_jarToRun, data_authKey);
    pb.directory(new File(directory));
    try {
        pb.start();
        window.setStage("Launched!");
        System.exit(0);
    } catch (Exception e) {
        e.printStackTrace();
        window.setFailed();
        window.setData("Failed to launch!");
    } 
```

注意：

*   data_jarToRun 等于“theJar.jar”
*   data_authKey 是一个字符串，需要包含在“theJar”参数中。
*   directory 是找到“theJar”的文件夹。

# android - GPS 精度低且报告为零

> ID：11268555
> 
> 赞同：3
> 
> 时间：2012-06-29T20:29:39.543
> 
> 标签：android, gps, location, nmea

我们正在现实世界的设备上测试 Android 应用程序，并注意到其中一些报告的数据非常不准确（即使在晴朗的天空下，看到超过 10 个卫星和使用了 5 个卫星），甚至在设备实际上没有移动时报告的速度超过 10 公里/小时，同时某些设备在调用 location.getAccuracy 时会返回 0。

我们已经成功解析了 NMEA 数据，NMEA 报告“1”，这意味着数据是可靠的。

这有时会发生在基于不同硬件和不同 Android 版本的不同品牌和型号上。最不可靠的是 SE Xperia x8（有时我们会在距离真实位置 20-30 公里处得到修复）和阿尔卡特 918D（它总是以超过 5 公里/小时的速度移动，准确度 ==0）

关闭和打开 A-GPS 助手以及清除/重新请求 A-GPS 更新没有帮助。

有什么方法可以“手动”过滤这种不准确的修复（使用其他一些 NMEA 节等），因为其他一些软件在相同设备上更好地报告位置？

PS 在大多数设备上，正如预期的那样，我们得到了很好的结果。

PPS最准确的是我自己的Garmin-Asus。希望他们有一天再次加入。

# vim - 如何可视化阻止 Vim 中的所有内容

> ID：11268556
> 
> 赞同：3
> 
> 时间：2012-06-29T20:29:44.427
> 
> 标签：vim

在 Vim 中可视化阻止整个内容的命令是什么？我在这里找不到问题。请随时指出。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T20:31:04.787

`ggVG`

*   `gg`让您从文件中的任何位置到达文件的第一行。
*   `V`开始视觉选择，基于行，因此它将抓取整行。
*   `G`带您到文件的最后一行。

# css - DOCTYPE 影响行高的渲染

> ID：11268563
> 
> 赞同：11
> 
> 时间：2012-06-29T20:30:23.320
> 
> 标签：css, html, twitter-bootstrap, doctype

这是一个令人头疼的问题。

我创建了一个带注释的 jsFiddle 来演示我最近在使用 Twitter 的 Bootstrap 框架创建一些下拉按钮时遇到的现象。

[http://jsfiddle.net/jackwanders/WKvPv/](http://jsfiddle.net/jackwanders/WKvPv/)

基本上，当使用 HTML5、HTML 4 Strict 或 XHTML Strict DOCTYPE 时，按钮按设计呈现。但是，当使用 HTML4 或 XHTML**过渡**DOCTYPE 时，插入符号按钮以较短的高度呈现。这是来自 Bootstrap 的相关 CSS `<span class="caret">`（我已经删除了无关紧要的样式，例如颜色和渐变）：

```
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  vertical-align: top;
  border-top: 4px solid #000000;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
  content: "";
}

.btn .caret {
  margin-top: 7px;
  margin-left: 0;
}

.btn {
  display: inline-block;
  *display: inline;
  padding: 4px 10px 4px;
  margin-bottom: 0;
  *margin-left: .3em;
  line-height: 18px;
  *line-height: 20px;
  text-align: center;
  vertical-align: middle;
} 
```

为什么 DOCTYPE 会影响按钮的高度？如果`line-height`设置为 18px，为什么高度会小于 18px？

*PS - 是的，我知道 Bootstrap 需要 HTML5，但我想这与所使用的 HTML5 功能有关，而不是 DOCTYPE 如何呈现 CSS 样式*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T20:30:23.790

在写这个问题和相关的 jsFiddle 演示时，我做了一些更多的挖掘并发现了发生了什么。与其放弃这个问题，我想我也可以用这个答案发布它。

在切换 DOCTYPES 后，我通过检查 Chrome 中的元素收集到的是：

*   `.btn`没有指定高度，只有`line-height: 18px`和`padding: 4px 10px`
*   在 HTML5 中，仅插入符号按钮的最终高度为 18px，与定义的相同`line-height`
*   在 Transitional DOCTYPE 中，仅插入符号按钮的高度为 11px，与 (+) 的高度相同`outerHeight()`，`caret`但`border-top`小于`margin-top`按钮的`line-height`高度。

所以，我只能假设 Strict（和 HTML5）DOCTYPE 强制执行`line-height`为某种`min-height`; 即使元素中没有文本，它也适用`line-height`......而过渡 DOCTYPES 则不适用。

当我将一些文本添加到仅插入符号的按钮（`&nbsp;`例如）时，然后`line-height`启动过渡 DOCTYPE，并且按钮以全高呈现。

# ruby-on-rails - 公共文件夹中的文件是否可供外界访问？- 导轨

> ID：11268580
> 
> 赞同：2
> 
> 时间：2012-06-29T20:31:15.863
> 
> 标签：ruby-on-rails, security

这是一个简单的问题，但我似乎无法在任何地方找到答案。如果您在`public`目录中存储了一些文件（比如一些静态 PDF），是否有一种方法可以让无权查看这些文件的人通过输入类似的 url 来查看它们`example.com/public/static_document.pdf`？如果是这样，你可以在 Rails 中禁用它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:56:00.147

公众绝对是公开的，并且对猜测 URL 的人开放。

查看[Ruby On Rails - 确保下载区域](https://stackoverflow.com/questions/3893935/ruby-on-rails-securing-downloads-area)的其他人询问类似情况。

我通常将这些存储在 Rails.root/secure_files 中，然后在 Controller 中使用 send_file 来授权和发送这些文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:54:56.703

公共文件夹包含供客户端读取的静态文件和编译资产。默认情况下，访问您网站的任何人都可以访问该文件夹。通过键入当前在您的公用文件夹中的文件夹名称来测试它。

# c# - 大数据渲染问题

> ID：11268582
> 
> 赞同：0
> 
> 时间：2012-06-29T20:31:19.807
> 
> 标签：c#, .net, asp.net-mvc, large-data

在视图中呈现大数据的最佳方式是什么？是按部分呈现它的某种方式吗？

控制器的动作产生大数据集（1000x1000 矩阵）并将其返回给 View。当我渲染它时，浏览器挂起。数据是由其他服务生成的，我无法以较小的部分获得它。

矩阵是 INT 值的二维数组。

控制器代码：

```
public ActionResult GetData()
{
    var result = ThirdPartyService.GetData();

    return View(result);
} 
```

查看代码：

```
<table>             
        <% foreach (var x = 0; x < Model.Matrix.Count; x++) { %>
            <tr>
        <% foreach (var y = 0; y < Model.Matrix[x].Count; y++) { %>
            <td><% = Model.Matrix[x, y] %></td>
        <% } %>
        </tr>
    <% } %>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:40:33.070

我猜这个大小的矩阵并没有在页面上完整呈现，所以我的建议是在用户滚动时通过附加到滚动事件来动态操作 DOM。通过使用[SlickGird](https://github.com/mleibman/SlickGrid/)作为数据渲染组件，使用编写的自定义插件来处理超过 1k 个元素的自动完成下拉列表，这对我来说非常棒。浏览器在处理大型数据集方面没有问题（我已经测试了多达 400k 的 JS 对象），但是在尝试显示它们时它肯定会挂起。因此，只需渲染您用户所在的屏幕部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T06:44:57.773

您可以呈现一个空表并从服务器获取数据以使用 ajax 填充它。这样，您将下载布局和数据，而不是`<tr><td></td></tr>`内容。如果你做数学：

*   `<tr></tr>`每行给你 9*1000 = 9000 字节
*   `<td></td>`每行中的每个单元格为您提供 9*1000*1000 = 9000000 字节
*   总计：9009000

您可以从请求中减少大约 9 mb，这已经很多了！

此外，您可以在服务器上打开 GZip，以便压缩数据。

# jquery - 如何在后续右键单击时关闭 jquery 上下文菜单

> ID：11268584
> 
> 赞同：3
> 
> 时间：2012-06-29T20:31:25.287
> 
> 标签：jquery, jquery-plugins, contextmenu

我从 Javascript Toolbox 实现了 jQuery ContextMenu 插件，它运行良好。当我右键单击某些指定区域时，它会打开我想要的上下文菜单，因此它在除一件事之外的所有内容中都能正常工作：

当我在另一个菜单仍然打开的情况下右键单击打开上下文菜单时，它不会关闭原始上下文菜单。只要我单击表格的另一行，就会打开一个新的上下文菜单，而不会关闭其他菜单。

但是，当我左键单击时，它们都已关闭。

将不胜感激一些帮助，甚至是朝着正确方向的推动。

提前致谢！

**插件地址：** [http ://www.javascripttoolbox.com/lib/contextmenu/](http://www.javascripttoolbox.com/lib/contextmenu/)

编辑：这是用于调用上下文菜单的代码

```
$("#sku_table tbody").mousedown(function(event) {
    if (event.which === 3) {

        var sku = $(event.target).closest('tr').attr('id');
        sku = sku.replace('.', '\\.');
        var menu1 = [
            {
            'Open Item information': {
                onclick: function(menuItem, menu) {
                    //Function to open item info
                }
            }}
        ];
        $(function() {
            $('#' + sku).contextMenu(menu1, {
                theme: 'vista'
            });
        });

    }
});​ 
```

实际打开菜单的是`$().contextMenu()`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:52:48.367

似乎每次在表格主体内单击鼠标右键时，都会创建一个新的上下文菜单实例。相反，如果您为上下文菜单应出现的内容定义选择器，则菜单将仅显示在那里。

如果上下文菜单将显示在随机项目上，则应使用类定义这些项目，并且可以从该类实例化上下文菜单。

[http://jsfiddle.net/azSMq/](http://jsfiddle.net/azSMq/)

```
$(function() {
    var menu1 = [
        {
        'Open Item information': {
            onclick: function(menuItem, menu) {
                $(this).fadeOut();
                //Function to open item info
            }
        }}
    ];
    $("#sku_table tr").contextMenu(menu1, {
        theme: 'vista'
    });
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-02T08:55:54.673

试试这个代码：

```
$("#sku_table tr").contextMenu(menu1, { theme: 'vista',
    beforeShow: function () {
        $(document).click();
        return true;
    } 
}); 
```

强制单击文档将调用插件内的内部代码，该代码将自动隐藏其他上下文菜单

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T21:26:18.690

有趣的是，演示页面在 Firefox 中似乎可以正常工作，但在 Chrome 或 IE 中却不行。处理此问题的一种方法是在显示您刚刚右键单击的菜单之前隐藏所有打开的菜单。所以你可以添加这个代码：

```
$(".context-menu").hide(); 
```

在此行之后添加它

```
if(event.which === 3){ 
```

这应该会给你想要的效果。

# .net - 无法从 Visual Studio 2008 中的 WCF 服务访问成员

> ID：11268586
> 
> 赞同：0
> 
> 时间：2012-06-29T20:31:34.787
> 
> 标签：.net, wcf, visual-studio-2010, visual-studio-2008, wcf-binding

我有一个用 Visual Studio 2010 编写的应用程序作为测试原型。它正在使用 WCF 服务，一切都运行良好。当我决定在 Visual Studio 2008 中添加服务引用时，我能够添加绑定，在 app.config 文件中对其进行配置……但我无法从服务中访问任何方法。

如果您有任何问题或要求提供更多信息，请告诉我。

请注意：我是 WCF 新手

# javascript - 我可以检测网络用户是否有使用 javascript 的软件键盘？

> ID：11268594
> 
> 赞同：6
> 
> 时间：2012-06-29T20:32:19.173
> 
> 标签：javascript, smartphone

我想让我网站上的搜索字段在用户加载页面时自动获得焦点，但我不喜欢它如何为智能手机/平板电脑上的用户弹出键盘。是否有任何 javascript 属性可以用来检测用户是否连接了物理键盘？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:38:02.987

我不确定...但是如果您查看[此](http://www.abeautifulsite.net/blog/2011/11/detecting-mobile-devices-with-javascript/)链接，它将向您展示如何检测用户是否在移动平台上。你可以根据这个做出你的决定吗？

# rest - Erlang/OTP 架构：用于 SOAish 服务的 RESTful 协议

> ID：11268599
> 
> 赞同：10
> 
> 时间：2012-06-29T20:32:36.210
> 
> 标签：rest, architecture, erlang, soa, erlang-otp

让我们想象一下，我们有一个比萨店要设计和构建的订单处理系统。

要求是：

**R1。**系统应该与客户端和用例无关，这意味着系统可以被客户端访问，这在初始设计期间没有考虑到。例如，如果披萨店决定其许多客户稍后使用三星 Bada 智能手机，则为 Bada OS 编写客户端将不需要重写系统的 API 和系统本身；或者例如，如果事实证明使用 iPad 而不是 Android 设备对送货司机来说更好，那么创建 iPad 客户端将很容易，并且不会以任何方式影响系统的 API；

**R2。**可重用性，这意味着如果业务流程发生变化，系统可以很容易地重新配置，而无需重写太多代码。例如，如果稍后披萨店将开始接受在线付款以及接受送货司机的现金（接受订单前付款 VS 接受货到付款），那么系统很容易适应新的业务流程;

**R3。**高可用性和容错性，这意味着系统应该在线并且应该 24/7 全天候接受订单。

因此，为了满足 R3，我们可以使用 Erlang/OTP 并具有以下架构： ![带有一个 RESTful API 入口点的纯 Erlang/OTP 架构](../Images/ad51ff0cad555b02a3c26a03ef336da5.png)

这里的问题是这种架构中有很多“硬编码”的功能。例如，如果比萨店从接受货到付款转变为接受下单前的在线支付，那么重写整个系统和修改系统的 API 将需要大量的时间和精力。

此外，如果披萨店需要对其 CRM 客户端进行一些改进，那么我们将不得不再次重写 API、客户端和系统本身。

因此，以下架构旨在解决这些问题，从而帮助满足 R1、R2 和 R3： ![具有多个 RESTful API 入口点的面向服务的架构](../Images/775d462fd50d2576bc92358b8db04c10.png)

系统中的每个“服务”都是一个带有 RESTful API 的 Webmachine 网络服务器。这种方法有以下好处：

*   Erlang/OTP 的所有优点，因为每个 Web 机器都是一个 Erlang 应用程序，可以被监督并且可以放入一个 Erlang 版本中；
*   [具有 SOA 的所有优点](http://en.wikipedia.org/wiki/Service-oriented_architecture#Benefits)的面向服务的架构；
*   易于适应业务流程的[变化](http://kinderman.net/2010/06/23/approaching-pure-rest-learning-to-love-hateoas)；
*   易于向客户端（例如 CRM 客户端）添加新客户端和新功能，因为客户端可以使用系统中所有服务的 RESTful API，而不是一个“中央”API（SOA 方面的服务可组合性）。

因此，本质上，第二张图片中提出的系统架构是面向服务的架构，其中每个服务都有一个 RESTful API 而不是 WSDL 契约，每个服务都是一个 Erlang/OTP 应用程序。

这是我的问题：

1.  图2：我想在这里重新发明轮子吗？我应该坚持使用纯 Erlang/OTP 架构吗？（“纯 Erlang”是指打包到一个版本中的 Erlang 应用程序，通过 gen_server:call 和 gen_server:cast 函数调用相互通信）；
2.  您能说出建议的方法中的任何缺点吗？（图二）
3.  您认为维护和发展（R1 和 R2）这样的系统（图 2）比真正的 Erlang/OTP 系统更容易吗？
4.  这样一个系统的安全性（图 2）可能是一个问题，因为有许多对 Web 开放的入口点（所有服务的 RESTful API）而不是只有一个入口点（图 1），不是吗？
5.  在这样的系统中有几个“编排模块”是否可以，或者可能存在一些更好的做法？（“接单”、“CRM”和“派单”服务如图2）；
6.  就消息传递和协议的限制而言，纯 Erlang/OTP（图 1）是否比这种方法（图 2）有任何优势？（在我之前的类似[问题](https://stackoverflow.com/questions/11173252/soa-why-do-not-use-erlang-otp-web-servers-as-services)gen_server:call VS HTTP RESTful 调用中进行了部分讨论）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T20:43:07.730

关于 SOA 需要牢记的是架构与技术无关（REST、WS*）。因此，如果/需要时，您可以获得具有多种类型端点的良好 SOA（我称之为[边缘组件](http://rgoarchitects.bit.ly/6wTGjM)- 将业务逻辑与通信和协议等其他问题分开）此外，重要的是要注意服务边界是信任边界因此，当您跨过它时，您可能需要进行身份验证和授权、跨网络等。此外，分层（如数据和逻辑）不应驱动您划分服务的方式。

因此，根据我在您的问题中阅读的内容，我可能会将服务划分为更粗粒度的服务（见下文）。服务边界内的通信可以是任何东西，因为跨服务的通信使用公共 API（REST 或 Erlang 本机取决于您，但关键是它是受管理的、版本控制的、安全的等） - 再次，一个服务可能具有多种技术的端点以方便不同的用户（有时您会使用 ESB 在服务和协议之间进行调解，但是否需要取决于系统的大小和复杂性）

关于您的具体问题

*   1 如上所述，我认为有一个地方可以公开更多公共 API，而不仅仅是一个入口点，我不确定使用 public-api 将每个功能公开为服务是否是正确的查看方式。
*   2&3 暴露每一件小事的缺点是管理开销、性能下降（例如，您必须对这些调用进行身份验证）。你会得到[纳米服务](http://arnon.me/wp-content/uploads/2010/10/Nanoservices.pdf)服务，其开销超过了它们的效用。
*   关于安全性要添加的一件事是，某些服务具有 REST API 的事实不必转化为使该 API 可供公众使用。部署方面，您可以将其保留在防火墙后面，并限制对已知地址等的访问。

    *   5 拥有多个编排模块是可以的，但如果超出了几个，您可能应该考虑使用一些编排模块（以及 ESB 或编排引擎），或者您可以使用基于事件的集成并获得更灵活的基于编排的集成（但有点难以管理）

    *   6 第一个选项具有易于开发和可能更好的性能（如果这是一个问题）的优势。随着时间的推移，硬编码的集成层可能会更难维护。erlang 服务，如果你编写它们，如果你保持 API 集成和它们之间的消息传递，它们应该能够独立发展（幸运的是，Erland 通过其固有特性（例如不变性）相对容易做到这一点）

![服务](../Images/55e35facd79b6218734e97c357f36bb2.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T12:48:14.153

我将介绍第三种方式，它更具成本效益且对变化反应灵敏。架构绝对应该是面向服务的，因为你有明确的服务。但是没有要求将每个服务公开为 Restful 或 WSDL 定义的服务。我不是 Erlang 开发人员，但我相信有一种方法可以通过消息传递调用本地和远程进程，从而避免内部调用的不必要的序列化/序列化活动。但是有一天你会面临新的集成问题。例如，您将整合会计或物流系统。然后，如果您在 SOA 原则方面设计得很好，那么大部分工作将与使用 RESTful 前端包装器公开现有服务相关，而无需重构与其他服务的现有连接。但问题是要保持职责范围的清洁。我的意思是每个服务都应该对其最初设计的活动负责。

您提到的安全问题是已知的。例如，您应该在所有公开的服务中使用令牌进行身份验证/授权。

# java - 如何在应用程序运行时探索 SQLite 数据库？Eclipse (Juno) > Android (adb)

> ID：11268600
> 
> 赞同：1
> 
> 时间：2012-06-29T20:32:36.300
> 
> 标签：java, android, eclipse, sqlite, debugging

我有一个应用程序，目前它的行为很奇怪。它使用 SQLite 数据库，在我想改进它的某些部分之前它工作得很好。现在问题来了：当应用程序在我的手机上运行时，我如何“探索”我的数据库？

就像您可以观察变量一样，如果您在某个时候中断调试会话，请检查它们。
但是使用 SQLite 数据库。（当然，应用程序处于空闲状态的“主要”状态，我可以在其中检查数据库。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:44:45.687

尝试

```
adb shell
sqlite3 /data/data/com.app.name/databases/DatabaseName.db 
```

这将带您进入 SQLite 命令行。从那里，您可以在数据库上执行 SQLite 查询/数据转储以查看其中的数据。如果您想使用真实设备（即不是模拟器）来执行此操作，那么您需要先根您的设备。

* * *

## 笔记：

如果您的设备不允许您执行`sqlite3`二进制文件（或者二进制文件不存在于设备的路径中......或者它根本不存在，等等），您可以安装`sqlite3`在本地机器上然后执行

```
adb pull /data/data/com.app.name/databases/DatabaseName.db .
sqlite3 DatabaseName.db 
```

这会将数据库复制到您的本地目录，然后`sqlite3`在本地计算机上执行二进制文件。当我植根摩托罗拉 Xoom 时，这发生在我身上一次……但第一个建议在大多数设备上都可以正常工作（至少在我的经验中）。

# django - Django 登录 - 获取 AttributeError 无法设置属性

> ID：11268601
> 
> 赞同：1
> 
> 时间：2012-06-29T20:32:41.087
> 
> 标签：django, mongodb, attributeerror

每次尝试登录我的 Django 站点的本地副本时，我都会收到以下错误：

```
Environment:

Request Method: POST
Request URL: http://127.0.0.1:8000/users/process_login/

Django Version: 1.4
Python Version: 2.7.2
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'tweets',
 'users',
 'dashboard',
 'GChartWrapper.charts',
 'api',
 'prospector',
 'viz')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/Library/Python/2.7/site-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/Users/sheldonc/Tealeaf/users/views.py" in process_login
  184\.             login(request, user)
File "/Library/Python/2.7/site-packages/django/contrib/auth/__init__.py" in login
  71\.         request.session.cycle_key()
File "/Library/Python/2.7/site-packages/django/contrib/sessions/backends/base.py" in cycle_key
  241\.         self.create()
File "/Library/Python/2.7/site-packages/mongoengine-0.6.1-py2.7.egg/mongoengine/django/sessions.py" in create
  44\.             self.session_key = self._get_new_session_key()

Exception Type: AttributeError at /users/process_login/
Exception Value: can't set attribute 
```

和异常位置：

```
Exception Location: /Library/Python/2.7/site-packages/mongoengine-0.6.1-py2.7.egg/mongoengine/django/sessions.py in create, line 44 
```

使用 pdb，我进一步调试了它。在`login(request, user)`方法中：

```
def login(request, user):
 56         """
 57         Persist a user id and a backend in the request. This way a user doesn't
 58         have to reauthenticate on every request. Note that data set during
 59         the anonymous session is retained when the user logs in.
 60         """
 61         if user is None:
 62             user = request.user
 63         # TODO: It would be nice to support different login methods, like signed cookies.
 64         if SESSION_KEY in request.session:
 65             if request.session[SESSION_KEY] != user.id:
 66                 # To avoid reusing another user's session, create a new, empty
 67                 # session if the existing session corresponds to a different
 68                 # authenticated user.
 69                 request.session.flush()
 70         else:
 71             request.session.cycle_key() 
```

`SESSION_KEY`是 None ，所以`request.session.cycle_key()`被称为，并且在那里的某个地方出现了 AttributeError 被抛出（

这是我的 mongo 连接的问题吗？我一直在四处寻找，但我似乎无法弄清楚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T10:57:17.490

已知（并已修复）错误：[https ://github.com/hmarr/mongoengine/issues/469](https://github.com/hmarr/mongoengine/issues/469)

# c - 获取变量的当前日期

> ID：11268603
> 
> 赞同：0
> 
> 时间：2012-06-29T20:32:57.860
> 
> 标签：c, string, date

我有一个变量: `char date[11];`，我需要在其中放入当前日期，例如`29/06/2012`。

所以我会做类似的事情：

```
printf ("%s\n", date); 
```

输出将是：`29/06/2012`

我只找到了以文字形式打印日期的选项，例如`Fri, June 2012`，而不是数字中的实际日期。

那么如何以数字形式打印当前日期？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T20:34:53.057

你可以参考这个函数[strftime](http://linux.die.net/man/3/strftime)。我会让你弄清楚如何使用它:-)

既然您声称您已经搜索过它，我将提供答案：

```
// first of all, you need to include time.h
#include<time.h>

int main() {

  // then you'll get the raw time from the low level "time" function
  time_t raw;
  time(&raw);

  // if you notice, "strftime" takes a "tm" structure.
  // that's what we'll be doing: convert "time_t" to "tm"
  struct tm *time_ptr;
  time_ptr = localtime(&raw);

  // now with the "tm", you can format it to a buffer
  char date[11];
  strftime(date, 11, "%d/%m/%Y", time_ptr);

  printf("Today is: %s\n", date);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T20:35:00.043

您正在寻找 的[`strftime`](http://www.cplusplus.com/reference/clibrary/ctime/strftime/)一部分`time.h`。您需要将其传递给`struct tm *`.

对于您的示例，格式字符串将是: `"%d/%m/%Y"`，这是一种非常常见的情况。

基于文档中的代码：

```
char date[11];
time_t t;
struct tm *tmp;

t = time(NULL);
tmp = localtime(&t);
if (tmp != NULL)
{
    if (strftime(date, 11, "%d/%m/%Y", tmp) != 0)
        printf("%s\n", date);
} 
```

# powershell - Powershell脚本参数：显示错误使用的帮助？

> ID：11268610
> 
> 赞同：3
> 
> 时间：2012-06-29T20:33:45.550
> 
> 标签：powershell, parameters

在 Powershell V2 中，我尝试使用 Param() 声明来解析传递给脚本的开关。我的问题可以使用这个脚本（example.ps1）来说明：

```
Param(
    [switch] $A,
    [switch] $B,
    [switch] $C
)
echo "$A, $B, $C" 
```

我的问题是这个脚本会默默地忽略任何不正确的开关。例如，“example.ps1 -asdf”只会打印“False, False, False”，而不是向用户报告不正确的使用情况。

我注意到如果添加位置参数，行为会发生变化：

```
Param(
    [switch] $A,
    [switch] $B,
    [switch] $C,
    [parameter(position=0)] $PositionalParameter
)
echo "A:$A, B:$B, C:$C" 
```

现在，如果我运行“example2.ps1 -asdf”，将引发 ParameterBindingException。但是，“example2.ps1 asdf”（注意没有前导破折号的参数）仍将被静默接受。

我有两个问题：

1.  有没有办法让 Powershell 总是向我的脚本报告一个额外的参数作为错误？在我的脚本中，我只想允许一组固定的开关（-A、-B、-C），而任何其他参数都应该是错误的。

2.  当检测到参数错误时，我可以让 Powershell 打印用法（即“get-help example.ps1”）而不是引发 ParameterBindingException 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T16:24:26.067

您可以尝试使用`CmdletBinding`as explain in [about_Functions_CmdletBindingAttribute](http://technet.microsoft.com/en-us/library/hh847872)，在具有 CmdletBinding 属性的函数中，未知参数和没有匹配位置参数的位置参数会导致参数绑定失败。

```
[CmdletBinding()]
Param(
      [switch] $A,
      [switch] $B,
      [switch] $C)

echo "A:$A, B:$B, C:$C" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T21:18:17.820

您可以尝试以这种方式检查`$args`

```
Function myfunction
{
  param(
        [switch] $A,
        [switch] $B,
        [switch] $C
)

foreach ( $key in $PSBoundParameters.keys )
{    
  if ( $args -gt 0) 
        {$script:test = $false ; break}
    else
        {$script:test = $true}
}    

if ($test)     
{ 
 "Parameters are ok" # ... your code script here
}    
else
{
  "Parameters error. Check Command" # or get-help myfuction
}
} 
```

# gwt - GWT 如何将自定义单元格添加到 celltable/datagrid

> ID：11268616
> 
> 赞同：2
> 
> 时间：2012-06-29T20:34:32.070
> 
> 标签：gwt, datagrid, cell, custom-cell, gwt-celltable

我已经渲染了一个结合了图像和文本的自定义单元格。它看起来像这样：

```
 class ImageTextCell extends AbstractCell<String> 
```

我的问题是如何将此单元格添加到 celltable/datagrid 中。我已经厌倦了这个。

```
 Column<Message, String> iconColumn = new Column<Message, String>(new ImageTextCell())
            {
        @Override
        public String getValue(Message versionStatus) {

            return ? // I dont know what to type here. How to return the ImageTextCell object           }
    }; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-30T14:30:12.033

对象的作用`Cell`是将一个值变成一段 HTML。的作用`Column`是从每一行中获取该值。例如，您有一堆`Messages`，每个都在自己的行上 - Column 应该采用 a`Message`并弄清楚`String`要传递给`Cell`.

的输出`getValue`将馈入 的输入`render`。的输出`render`应该是您希望在应用程序中看到的 HTML。

伪代码，这是 GWT 为您所做的：

```
for each Message in your table {
    pass the Message into Column.getValue and get out a String
    pass that String into Cell.render and get out some HTML
    add that HTML inside a <td> element in the table we're drawing
} 
```

您只需定义 Column.getValue 和 Cell.render 以便此过程生成您想要的表格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T08:31:33.960

这是我在我的应用程序中显示 png 标志的一种方法：

> ```
>  Column<IStationMini, ImageResource> flag = new Column<IStationMini, ImageResource>( new ImageResourceCell()) {
>         @Override
>         public ImageResource getValue(IStationMini station) {
>             return FlagsTools.getFlag( station.getCountry());
>         }
>     };
> this.addColumn( flag ) ; 
> ```

“FlagsTools.getFlag()”返回一个 imageResource

# c++ - 动态转换智能指针

> ID：11268618
> 
> 赞同：0
> 
> 时间：2012-06-29T20:34:38.250
> 
> 标签：c++, pointers, dynamic, casting

TcpTahoe 类是套接字类的子类。看[http://www.nsnam.org/doxygen/classns3_1_1_tcp_tahoe.html](http://www.nsnam.org/doxygen/classns3_1_1_tcp_tahoe.html) （我想模拟一个小型网络。）

代码：

```
Ptr<Socket> ns3TcpSocket;
...
Ptr<TcpTahoe> ptr = dynamic_cast< Ptr<TcpTahoe> >(ns3TcpSocket);
uint32_t ssthresh = ptr->GetSSThresh2();
cout << ssthresh; 
```

所以我现在在运行时，ns3TcpSocket 将是一个 TcpTahoeSocket。但我得到一个编译错误。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:57:57.560

`dynamic_cast`可用于转换为指针或引用。在你的情况下，`Ptr<TcpTahoe>`两者都不是。您应该在这里使用原始指针。我不知道这`Ptr`门课，但是这些方面的东西应该可以工作：

```
Ptr<TcpTahoe> ptr = dynamic_cast<TcpTahoe*>(ns3TcpSocket->GetRawPtr()); 
```

（当然是编造的`GetRawPtr()`。如果存在，大多数机会都会成功）。`Ptr``operator&`

哦，请记住，如果演员无法完成，`dynamic_cast`可能会返回。`NULL`确保你处理这种情况。

# git - git可以跟踪“.git”文件夹吗？

> ID：11268620
> 
> 赞同：2
> 
> 时间：2012-06-29T20:34:52.757
> 
> 标签：git, recursion

我确实在不同的计算机上处​​理相同的项目，我想知道是否有办法跟踪那个 .git 文件夹，这样我就不必在所有本地文件中重新配置配置文件。

我把我所有的工作都推到了 bitbucket 上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T20:39:56.137

不，没有。

但是您可以在 git 中存储一个文本文件，其中包含用于重新配置每个存储库的 2 或 3 个命令。`.sh`如果它有帮助，你可以让它成为一个。

# signalr - SignalR - 永远使 DOM 超载的帧传输

> ID：11268622
> 
> 赞同：0
> 
> 时间：2012-06-29T20:34:56.827
> 
> 标签：signalr

我有一个 SignalR 实现，它每秒接收大约 15 条消息，并通过 Knockout 更新 DOM。我在 IE 中遇到严重退化，但在 Chrome 或 Firefox 中没有。

事实证明，ForeverFrame 传输永远不会清理消息，因此，大约 10 分钟后 DOM 过载，浏览器变得无响应，最终崩溃。

如果我将启动短路以仅使用长轮询，那么一切都很顺利。

永久帧传输是否存在已知问题？我是否有理由不强迫它使用 WebSockets/Long Polling？

我正在使用signalR-0.5.2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T18:36:39.810

> 我在 IE 中遇到严重退化，但在 Chrome 或 Firefox 中没有。

你的意思是客户端降级对吗？

在 0.5.2 中，我们每 50 条消息清理一次 dom，不确定您为什么会看到这种行为：

[https://github.com/SignalR/SignalR/blob/master/SignalR/Scripts/jquery.signalR.js#L962](https://github.com/SignalR/SignalR/blob/master/SignalR/Scripts/jquery.signalR.js#L962)

# r - R：如何在重叠的时间段内平均

> ID：11268627
> 
> 赞同：3
> 
> 时间：2012-06-29T20:35:56.017
> 
> 标签：r, time-series

我最近在[这里](https://stackoverflow.com/questions/11123008/r-how-to-average-data-within-different-time-periods-defined-in-a-data-frame/ "这里")发布了一个类似的问题，不过这有点过于简单了。因此，我们又来了：

假设我有一个数据框（下面的 dput 输出），其中包含许多不同变量的时间序列数据（本例中为 5 个，实际数据中更多）：

```
 date          a  b  c  d  e
1  2009-10-01 00:00:00 10 20 30 40 50
2  2009-10-01 01:00:00 11 21 31 41 51
3  2009-10-01 02:00:00 12 22 32 42 52
4  2009-10-01 03:00:00 13 23 33 43 53
5  2009-10-01 04:00:00 14 24 34 44 54
6  2009-10-01 05:00:00 15 25 35 45 55
7  2009-10-01 06:00:00 16 26 36 46 56
8  2009-10-01 07:00:00 17 27 37 47 57
9  2009-10-01 08:00:00 18 28 38 48 58
10 2009-10-01 09:00:00 19 29 39 49 59
11 2009-10-01 10:00:00 20 30 40 50 60
12 2009-10-01 11:00:00 21 31 41 51 61
13 2009-10-01 12:00:00 22 32 42 52 62
14 2009-10-01 13:00:00 23 33 43 53 63
15 2009-10-01 14:00:00 24 34 44 54 64
16 2009-10-01 15:00:00 25 35 45 55 65
17 2009-10-01 16:00:00 26 36 46 56 66
18 2009-10-01 17:00:00 27 37 47 57 67
19 2009-10-01 18:00:00 28 38 48 58 68
20 2009-10-01 19:00:00 29 39 49 59 69
21 2009-10-01 20:00:00 30 40 50 60 70
22 2009-10-01 21:00:00 31 41 51 61 71
23 2009-10-01 22:00:00 32 42 52 62 72
24 2009-10-01 23:00:00 33 43 53 63 73
25 2009-10-02 00:00:00 34 44 54 64 74 
```

另一个数据框“事件”具有由开始和停止日期定义的不同时间段（此处为 3，实际数据中更多）：

```
 id       start                stop
1 AGH 2009-10-01 02:00:00 2009-10-01 04:00:00
2 TRG 2009-10-01 03:00:00 2009-10-01 10:00:00
3 ZUH 2009-10-01 03:00:00 2009-10-01 20:00:00 
```

我想得到一张不同事件中变量平均值的表格，如下所示：

```
 id avg(y.a) avg(y.b) avg(y.c) avg(y.d) avg(y.e)
1 AGH     13.0     23.0     33.0     43.0     53.0
2 TRG     16.5     26.5     36.5     46.5     56.5
3 ZUH     21.5     31.5     41.5     51.5     61.5 
```

我从上一篇文章中了解到，我可以使用 sqldf 包和一个相当简单的 SQL 语句来做到这一点：

```
means <- sqldf("
+     SELECT x.id, avg(y.a), avg(y.b), avg(y.c), avg(y.d), avg(y.e) 
+     FROM events as x, data as y 
+     WHERE y.date between x.start and x.stop 
+     GROUP BY x.id 
+ ") 
```

但是，由于实际数据包含更多要平均的列，这些列在我必须处理的各种文件中的名称不同，因此在 SQL 语句中输入所有列名变得有点乏味。

因此，我更喜欢 R 中的解决方案，我可以简单地按列的编号 (data[2:100]) 引用列.

任何想法如何做到这一点将不胜感激！

输入（数据）

```
structure(list(date = structure(c(1254348000, 1254351600, 1254355200, 
1254358800, 1254362400, 1254366000, 1254369600, 1254373200, 1254376800, 
1254380400, 1254384000, 1254387600, 1254391200, 1254394800, 1254398400, 
1254402000, 1254405600, 1254409200, 1254412800, 1254416400, 1254420000, 
1254423600, 1254427200, 1254430800, 1254434400), class = c("POSIXct", 
"POSIXt"), tzone = "Europe/Berlin"), a = 10:34, b = 20:44, c = 30:54, 
    d = 40:64, e = 50:74), .Names = c("date", "a", "b", "c", 
"d", "e"), row.names = c(NA, -25L), class = "data.frame") 
```

输入（事件）

```
structure(list(id = structure(1:3, .Label = c("AGH", "TRG", "ZUH"
), class = "factor"), start = structure(c(1254355200, 1254358800, 
1254358800), class = c("POSIXct", "POSIXt"), tzone = "Europe/Berlin"), 
    stop = structure(c(1254362400, 1254384000, 1254420000), class = c("POSIXct", 
    "POSIXt"), tzone = "Europe/Berlin")), .Names = c("id", "start", 
"stop"), row.names = c(NA, -3L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T13:47:41.837

1.  基本问题是由于数据没有归一化；但是，如果不把它变成长格式，我们可以动态生成 sql 语句：

    ```
    library(sqldf)
    sql <- paste("select id, ", 
        toString(sprintf("avg(y.%s)", names(data)[-1])),
        "from events as x, data as y
        where y.date between x.start and x.stop
        group by x.id")
    sqldf(sql) 
    ```

2.  作为替代方案，我们展示了`melt`在 reshape2 包中使用 将数据转换为长格式，`data_long`处理它以给出`means.long`并将其转换回宽格式，使用`dcast`：

    ```
    library(reshape2)
    data_long <- melt(data, id.vars = "date")
    means_long <- sqldf("
         SELECT x.id, y.variable, avg(value)
         FROM events as x, data_long as y 
         WHERE y.date between x.start and x.stop 
         GROUP BY x.id, y.variable
    ")
    means <- dcast(id ~ variable, data = means_long, value.var = "avg(value)") 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:51:46.987

```
>  t( sapply(events$id , function(id) lapply (
            data[ data[["date"]] >= events[ events[['id']]==id, 'start'] & 
                  data[["date"]] <= events[ events[['id']]==id, 'stop' ] ,  -1 ], 
            mean) ) )
     a    b    c    d    e   
[1,] 13   23   33   43   53  
[2,] 16.5 26.5 36.5 46.5 56.5
[3,] 21.5 31.5 41.5 51.5 61.5
#  Or if you prefer:
t( sapply(events$id , function(id) data.frame( 
                       id=as.character(id), 
                       lapply (data[ data[["date"]] >= events[events[['id']]==id, 'start'] &  
                                     data[["date"]] <= events[ events[['id']]==id, 'stop' ] , -1 ],
                               mean) ,stringsAsFactors=FALSE) ) )
     id    a    b    c    d    e   
[1,] "AGH" 13   23   33   43   53  
[2,] "TRG" 16.5 26.5 36.5 46.5 56.5
[3,] "ZUH" 21.5 31.5 41.5 51.5 61.5 
```

# django - 如何在同一个模板中使用两个不同的 Django Form？

> ID：11268630
> 
> 赞同：6
> 
> 时间：2012-06-29T20:36:36.033
> 
> 标签：django, django-models, django-forms, django-templates, django-views

我的forms.py：

```
class AlertForm(forms.ModelForm):
class Meta:
    model=Alert
    fields = ('high','medium', 'user')
    widgets = {
        'user':  forms.HiddenInput()
    }

AlertCountFormset = modelformset_factory(Alert,
                                       form = AlertForm) 
```

另一个 Django 表单类：

```
class NotifierForm(forms.ModelForm):
high = forms.ChoiceField(choices=NOTIFIER_TYPE)
medium = forms.ChoiceField(choices=NOTIFIER_TYPE)
low = forms.ChoiceField(choices=NOTIFIER_TYPE)  

def save(self, commit=True):
    alert = super(NotifierForm, self).save(commit=False)
    alert.high = self.cleaned_data["high"]
    alert.medium = self.cleaned_data["medium"]
    alert.low = self.cleaned_data["low"]
    alert.save()
    return alert

class Meta:
    model=Notifier
    fields = ('high','medium', 'low', 'user')
    widgets = {
        'user': forms.HiddenInput()
    }

NotifierFormset = modelformset_factory(Notifier,
                                    form = NotifierForm) 
```

以下是选择字段：

```
NOTIFIER_TYPE = (
(0, _('E-mail')),
(1, _('Skype')),
(2, _('IRC'))
) 
```

我想在同一个模板中填写这两个表格。所以我选择为两者写相同的观点，即：

```
def profile_setting(request, slug):
if request.method == 'POST':
    alert_form = AlertForm(request.POST)
    notifier_form = NotifierForm(request.POST)
    if alert_form.is_valid() and notifier_form.is_valid():
        alert = alert_form.save(commit=False)
        notifier = notifier_form.save(commit=False) 
        alert.user = request.user.username
        notifier.user = request.user.username
        notifier.save()
        alert.save()
        return HttpResponseRedirect(reverse('profile_setting', args=[slug]))

extra_context = {
    'alert_form': AlertForm(),
    'notifier_form': NotifierForm()
}
return direct_to_template(request,'users/user_profile_setting.html',
                          extra_context) 
```

根据我的template.html中的：

```
{% block content %}
<h3>{% trans "Alerts limit" %}</h3>
<form action="" method="POST">{% csrf_token %}
    {{ alert_form.as_p }}
    <input type="submit" value="{% trans 'Update' %}" />
</form>

<h3>{% trans "Notifier setting" %}</h3>
<form action="" method="POST">{% csrf_token %}
    {{ notifier_form.as_p }}
    <input type="submit" value="{% trans 'Update' %}" />
</form> 
```

一切都是正确的，它也将数据保存到数据库中。但问题是每当我填写aler_form 并单击更新按钮时。它还使用相同的值更新另一个表单，反之亦然。例如，如果我选择

```
1 2 3 for high , medium and low for alert_Form 
```

然后它还为 notify_form 保存相同的值。为什么会这样。是观点有问题吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-29T20:54:15.140

使用该[`prefix`](https://docs.djangoproject.com/en/dev/ref/forms/api/#prefixes-for-forms)参数，以便您的字段名称不会发生冲突。

例如：

```
alert form = AlertForm(request.POST, prefix='alert') 
notifier_form = NotifierForm(request.POST, prefix='notifier') 
```

您需要在未绑定的表单中使用相同的前缀。

```
extra_context = { 'alert_form': AlertForm(prefix='alert'),  notifier_form': NotifierForm(prefix='notifier') } 
```

使用前缀的优点是您不需要手动重命名字段，正如 umnik700 在他们的回答中所建议的那样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T20:46:39.330

The problem is that on your forms the fields have the same names.

request.POST is a dictionary-like object. So it only contains the name/value pairs from the request. If the field names are the same on both of the forms then when you call

```
alert_form = AlertForm(request.POST)
notifier_form = NotifierForm(request.POST) 
```

they are initialized with the same values. To resolve this make the names to be unique between your two forms. For example prefix all the field names on the AlertForm with "alert_".

# cocoa - 如何在行选择中更改 NSTextField 文本颜色？

> ID：11268631
> 
> 赞同：18
> 
> 时间：2012-06-29T20:36:36.543
> 
> 标签：cocoa, nstextfield

对于可可，我有一个**NSTableView**设置为基于视图。选择一行后，文本字段的颜色将变为白色。如何保持黑色？

我还应该注意，突出显示设置为源列表（它在常规上做同样的事情）。 ![亮点设置](../Images/ce1c260f2b906fa58b86e1116931b668.png)

未选择的行![未选中](../Images/64fab1880208a38c4b7c2b6f8dd59a5c.png)

选定行![选定行](../Images/d3e0f50be7d2ee83ed85b6a94feb706f.png)

我希望有类似于 iOS 的状态配置的东西：

![在此处输入图像描述](../Images/7f3f6830e5acca01fef04ac55f8044e8.png)

这是在 WWDC 2011 Session 120 中提出的，但它有点延迟，所以我不会使用它。不过，它可能对其他人有用。

```
- (void)tableViewSelectionDidChange:(NSNotification *)notification
{
    [tableView enumerateAvailableRowViewsUsingBlock:^(NSTableRowView *rowView, NSInteger row){
        NSTableCellView *cellView = [rowView viewAtColumn:0];
        if(rowView.selected){
            cellView.textField.font = [NSFont boldSystemFontOfSize:14];
        }else{
            cellView.textField.font = [NSFont systemFontOfSize:14];
        }
    }];
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-04-16T11:57:01.037

不需要自定义代码来实现这一点。

只需在 Interface Builder 中将标签的颜色设置为“标签颜色”即可。仅当标签设置了“控制文本颜色”并且位于 NSTableCellView 中时，自动白/黑功能才有效。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-17T14:52:38.863

根据您需要这样做的原因，有两种方法。

您可以子类化`NSTableRowView`并覆盖`-[NSTableRowView interiorBackgroundStyle]`以返回`NSBackgroundStyleLight`。这将告诉单元格它们在浅色背景上并绘制黑色文本，这将是黑色的。

另一种方法是子类化`NSTableCellView`和覆盖`-[NSTableCellView setBackgroundStyle:]`并在那里自己设置颜色。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-02-11T19:23:29.050

覆盖 NSTableCellView 并添加此方法以在选择单元格时更改文本颜色。

```
- (void) setBackgroundStyle:(NSBackgroundStyle)backgroundStyle
{
    NSTableRowView *row = (NSTableRowView*)self.superview;
    if (row.isSelected) {
        self.textField.textColor = [NSColor blackColor];
    } else {
        self.textField.textColor = [NSColor whiteColor];
    }

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-01-27T17:40:54.933

我想出了一个不同的解决方案。如果 Cocoa 支持 @IBOutletCollection，子类化 NSTableCellView 会很好。因为那时我可以有一个 Cell 子类，其中包含单元格中所有 NSTextFields 的数组。但由于我有多种类型的单元格和不同数量的 NSTextField，我不喜欢这个选项。相反，我查看了 Apple 为`backgroundStyle`NSTableCellView 中的属性提供的文档。

> 默认实现会自动将调用转发到所有实现 setBackgroundStyle: 或者是 NSControl 的子视图，这些子视图具有响应 backgroundStyle 的 NSCell 类。

如果我的 TextFields 实现了 setBackgroundStyle，那么它们应该在单元格选择发生变化时得到通知。但是，背景样式的这种转发不是递归的。因为我的 NSTextFields 在 NSStackViews 中，所以他们没有收到消息。为了解决这个问题，我刚刚编写了一个扩展来在所有 NSView 上实现 setBackgroundStyle。它只是转发消息。最后，我为 NSTextField 添加了一个扩展来实现这个方法。从这个扩展中，我改变了文本颜色并调用了 super。这个解决方案也很好，因为不需要子类。没有 NSTableCellView 或 NSTextField 的子类。

将此功能添加到所有视图和所有 NSTextFields 可能会导致不在 NSTableViews 中的 NSTextFields 出现意外更改颜色的问题。但到目前为止，只有我的 TableViews/OutlineViews 中的那些正在改变颜色，而这正是我正在寻找的。如果您看到文本字段更改了您不期望的颜色，您可能希望继承 NSTextField 并仅在该子类上实现 setBackgroundStyle 覆盖，而不是将其添加到所有 NSTextFields。

我使用的 Swift 3 中的代码粘贴在下面。

```
extension NSView {
    func setBackgroundStyle(_ newValue: NSBackgroundStyle) {
        for view in self.subviews {
            view.setBackgroundStyle(newValue)
        }
    }
}

extension NSTextField {
    override func setBackgroundStyle(_ newValue: NSBackgroundStyle) {
        switch newValue {
        case .dark:
            self.textColor = NSColor.controlLightHighlightColor
        case .light, .lowered, .raised:
            self.textColor = NSColor.labelColor
        }
        super.setBackgroundStyle(newValue)
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-09-27T11:57:10.023

对于我的 Swift 应用程序，上述方法似乎都不能正常工作。此方法正确处理 NSTableView 失去焦点以及当窗口不是关键窗口但仍选择单元格时。

在`NSTableCellView`子类中使用以下内容：

```
override var backgroundStyle: NSView.BackgroundStyle {
  willSet {
    if newValue == .dark {
      title.textColor = NSColor.white
    } else {
      title.textColor = NSColor.labelColor
    }
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-01T16:48:56.863

根据@sabes 的回答，我创建了这个`NSTextFieldCell`子类，您可以在选择或取消选择一行时使用它来设置自定义文本颜色。您可以在 IB 中设置相关文本字段单元格的子类。

```
@interface SNBlueTextFieldCell : NSTextFieldCell

@end

@implementation SNBlueTextFieldCell

- (void)setBackgroundStyle:(NSBackgroundStyle)backgroundStyle {
    [self setTextColor:(backgroundStyle==NSBackgroundStyleDark ? [NSColor blackColor] : [NSColor blueColor])];
}

@end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-18T12:17:11.043

在 macOS 11 或更高版本中，不推荐使用`.dark`和`.light`背景样式。但您可以`.emphased`改用：

```
override var backgroundStyle: NSView.BackgroundStyle {
    willSet {
        textField.textColor = newValue == .emphasized ? .labelColor : .secondaryLabelColor
    }
} 
```

在示例中，`.labelColor`是选定的颜色和`.secondaryLabelColor`未选定的颜色。

# python - SciPy 中的拟合优度测试

> ID：11268632
> 
> 赞同：17
> 
> 时间：2012-06-29T20:36:41.553
> 
> 标签：python, statistics, scipy

我是 Python 新手，来自 R 世界。我正在尝试使用 SciPy 将分布拟合到样本数据并取得了很好的成功。我可以使`distribution.fit(data)`返回理智的结果。我一直无法做的是创建我习惯于使用`fitdistrplus`R 中的包的拟合优度统计。是否有一种通用方法可以将来自多个不同分布的“最佳拟合”与 SciPy 进行比较？

我正在寻找类似 Kolmogorov-Smirnov 测试或 Cramer-von Mises 或 Anderson-darling 测试的东西

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-29T20:41:14.857

请参阅 scipy.stats 库：[http ://docs.scipy.org/doc/scipy/reference/stats.html](http://docs.scipy.org/doc/scipy/reference/stats.html)

它包含 KS 和 Anderson-Darling，但显然不是 Cramer-von Mises。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-29T21:57:08.117

还有[statmodels 拟合优度测试](http://statsmodels.sourceforge.net/stable/stats.html#goodness-of-fit-tests-and-measures)。

# php - 将当前基于角色的程序 php 站点转换为 MVC 和 ACL

> ID：11268633
> 
> 赞同：1
> 
> 时间：2012-06-29T20:36:45.223
> 
> 标签：php, security, model-view-controller, codeigniter

我目前有一个项目，其中需要在 MVC 中重写具有基于奇怪角色的设置的程序 PHP 站点（可能是 codeigniter，因为我是 MVC 的新手），我无法完全了解最佳的继续方式。

当前站点使用某种前端控制器来检查数据库中登录用户的安全级别，并根据反映安全级别的目录结构构建页面。

IE

目录结构：

```
root
    -admin (sees everything and everyone elses subordinates)
        -- Reports listing managers, and their users
        -- CRUD for managers and their reports
        -- CRUD for users and their reports (types listed below)
    -manager (has users as subordinates, and can see all data related to them)
        -- Reports listing the manager's users
        -- CRUD for users and their reports (types listed below)
    -user (Can only see their own information)
        -- Reports listing the users information (lists, calendars, calls, etc.)
        -- CRUD for users reports (types listed above) 
```

db 用户表 psuedo

```
1 = admin
2 = manager
3 = user

UserAccountTable
    id
    pass
    user
    email
    security level (1,2,3)

manager Table
    manager ID
    User Account ID
    other fields containing personal info

user Info Table
    user Info id
    User Account ID
    Manager ID
    other fields containing personal info 
```

前控制器伪

```
load header
load menu
determine level from db
    if 1 load requested file from admin folder
    if 2 load requested file from manager folder
    if 3 load requested file from user folder
load footer 
```

主要问题：

当前设计中是否存在任何突出的固有问题（如果您需要有关当前结构的更多细节来回答，请告诉我）？

鉴于当前站点的上述结构，在 MVC 结构中使用当前自上而下的安全类型（1 看到 2 和 3，2 看到 3，3 只看到 3）重新设计安全性将是一种可靠的方法，是吗？可以对数据库进行最小的更改吗？

我不是在寻找代码（尽管如果有人知道这样的事情，我可以看看以收集一些理解，那将是有帮助的），但更多的是对过程的概念性理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T06:50:57.973

当前的设计有一些限制。角色的数量已固定，角色的权限也已固定。更好的设计方法将是以下方式。

```
User Table
----------
id
password
email
.....

permissions Table
-----------------
id
name

roles Table
-----------
id
name

user_roles Table
----------------
userid
roleid

roles_permission
----------------
roleid
permissionid 
```

在上表设计中，可以将权限分配给角色，然后将角色分配给用户。然后编写一些辅助函数，例如 hasPermission() 可以决定登录的用户是否具有访问某些内容所需的权限。为了获得更高的性能，可以创建一些视图来显示用户的权限并在视图上查询并检查用户是否具有权限。

[在www.thephpcode.com](http://www.thephpcode.com)设计 codeigniter 网站生成器时，我采用了相同的方法。您可以创建一个演示并免费检查管理门户以查看它在 UI 中的工作方式。

# iphone - Core Plot - 根据实时数据创建大小不断增加的图形

> ID：11268634
> 
> 赞同：0
> 
> 时间：2012-06-29T20:36:50.293
> 
> 标签：iphone, objective-c, ios5, core-plot

我做了一些搜索，但没有发现有人尝试过类似的事情，所以我想我在这里问一下。我要做的基本上是创建一个图表，每隔 5 秒获取一次数据并绘制它。到目前为止，我所做的最好的事情是允许用户平移静态图的静态图。

我目前正试图达到我可以按下一个按钮的地步，它将根据 X 轴的稳定时间间隔和 Y 轴上从 1 到 100 的随机数在图表上创建一个新点。我正在尝试如何做到这一点如下：

```
@synthesize scatterPlot = _scatterPlot;
@synthesize statusLabel, data, isPlotting;

CGFloat xCoord;

- (void)startPlot:(id)sender {

    if (isPlotting == FALSE) {
        xCoord = 0;
    }

    if (isPlotting == TRUE)
    {
        statusLabel.text = @"Starting Plot";

        xCoord += 5;
        [data addObject:[NSValue valueWithCGPoint:CGPointMake(xCoord, (arc4random() % 100 + 1))]];

        self.scatterPlot = [[TUTSimpleScatterPlot alloc] initWithHostingView:_graphHostingView andData:data];
        [self.scatterPlot initialisePlot];

        [NSTimer scheduledTimerWithTimeInterval:5 target:self selector:@selector(startPlot:) userInfo:nil repeats:NO];
    }
}

- (void)endPlot:(id)sender {
    statusLabel.text = @"Plotting Stopped";
    isPlotting = FALSE;
} 
```

这基本上是我尝试完成所描述任务的核心。这个想法是我按下调用**startPlot**并将**isPlotting**值设置为 true 的“开始”按钮，然后我将 xCoord 值增加任意 5，持续 5 秒，然后生成并添加我的新点到我的名为**data**的 NSMutableArray 数组。之后我重新初始化我的散点图并启动一个定时器休眠 5 秒并再次调用**startPlot**函数。

我遇到的问题是它要么没有更新，要么我得到一个没有点的空白 X 和 Y 轴。无论如何，我缺少一些我希望有人知道并可以帮助我的东西！

谢谢你！-卡罗利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T02:23:52.053

您所描述的是实时图，就像示波器一样，对吧？你看过示例应用程序吗？特别是实时情节中的情节画廊项目？应该就是这样，它在示例文件夹中。

查看`RealTimePlot`类（在项目树中，在 Plots 组下），基本上所做的是设置一个调用该方法的计时器，`-(void)newData:(NSTimer *)theTimer`向数据数组添加一个新点，重绘并移动`CPTPlotRange`s。

您使用的是什么版本的 CorePlot？

# javascript - jquery 或 js 事件处理程序？

> ID：11268635
> 
> 赞同：1
> 
> 时间：2012-06-29T20:36:51.850
> 
> 标签：javascript, jquery, optimization, event-handling

我想知道本机 js 和 jquery 事件处理程序，从内存消耗/性能的角度来看，我应该选择哪一个？假设我有这个 html 代码，一个简单的按钮。

```
<button id="herp">derp</button> 
```

将

```
herp.onclick = function()
{
    alert('hey');
} 
```

优于

```
$("#herp").click(function()
{
    alert('hey');
}); 
```

?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:40:04.703

尽管这是邪恶的过早的微优化 -

1.  jQuery 非常重地包装原生事件以规范浏览器兼容性问题，因此总是会（稍微）慢一些

2.  DOM3 样式`addEventListener`应该优于 DOM0 `.onxxx`，但不是出于我所知道的任何性能或内存原因

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:40:36.763

分析差异。如果你只做一次，你甚至不能分辨出区别，那没关系。

如果您执行一百万次，请查看速度和内存消耗的差异并做出决定。

尽量避免过早优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T02:58:47.570

如果页面由于其他原因已经包含 jQuery，那么添加一个事件处理程序不会对内存消耗/性能产生任何显着影响。

另一方面，如果页面由于任何其他原因不需要 jQuery，那么没有 jQuery 的页面会更小/更快。

# c - 多个小部件的 C/GTK+3 绘制事件

> ID：11268637
> 
> 赞同：2
> 
> 时间：2012-06-29T20:36:57.687
> 
> 标签：c, gtk, cairo

我目前正在尝试使用 C 学习 GTK+3/cairo。我编写了一个小应用程序，它使用 cairo 在 gtk 绘图区域上绘制仪表面和针。

到目前为止效果很好，我尝试创建多个绘图区域（多个仪表），它们都具有相同的绘图事件回调函数，这也适用于静态值。

现在我的问题是，我希望能够绘制多个仪表，每个仪表都有自己的值。但是我如何在我的回调函数中知道哪个仪表（绘图区域）发出了绘图信号？我想这还包括我如何为仪表“创建和存储”数据，以便可以从绘图回调中获取它们的属性。

我可能应该创建一个包含仪表数据的结构，并创建多个。这就是我通过查看使用 GTK 的各种项目所收集到的信息，但它对我来说太复杂了，无法完全理解它是如何工作的。

这就是我创建绘图区域的方式：

```
gaugearea1 = gtk_drawing_area_new();
gtk_box_pack_start(GTK_BOX(hbox), gaugearea1, FALSE, FALSE, 5);
gtk_widget_set_size_request(gaugearea1, 300, 300);
gtk_widget_realize(gaugearea1);
g_signal_connect(gaugearea1, "draw", G_CALLBACK(draw_event), NULL); 
```

而且回调函数是这样写的，很标准。

```
static gboolean draw_event(GtkWidget *widget, cairo_t *cr)
{
    GdkWindow *win;
    win = gtk_widget_get_window(widget);

    // Draw all arcs/lines using cr
} 
```

任何有关如何处理此类问题的提示将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T22:09:46.293

发出信号的`GtkDrawingArea`只是`widget`您在回调中收到的。如果需要，只需将其转换为适当的类型。

但请仔细查看`draw`信号中的文档：

### “平局”信号

```
gboolean     user_function                  (GtkWidget    *widget,
                                            CairoContext *cr,
                                            gpointer      user_data) : Run Last 
```

您的`draw_event`函数缺少最后一个参数`gpointer user_data`.

这就是调用的最后一个`NULL`参数的使用`g_signal_connect()`。因此，您可以在此处放置一个指向包含您需要的所有数据的结构的指针。

或者您可以使用该`g_object_set_data()`函数将指针附加到小部件，但对于这样一个简单的应用程序，我不建议这样做。

如果你有固定数量的仪表，一切都很好：只需创建相同数量的结构，但如果你的仪表数量是动态的，你必须在头部创建结构，所以出现了一个新问题：你什么时候释放数据？答案是`g_signal_connect_data()`：这个函数接收一个额外的回调，当结构不再需要时调用。

类似于以下内容：

```
struct GaugeData
{
    /* your data here */
};
static void gauge_data_free(gpointer ptr, GClosure *clo)
{
    struct GaugeData *data = ptr;
    /* free extra resources, if needed */
    g_free(data);
}
static gboolean draw_event(GtkWidget *widget, cairo_t *cr, gpointer ptr)
{
    struct GaugeData *data = ptr;

    // Draw all arcs/lines using cr and data
}

void CreateOneGauge()
{
    gaugearea1 = gtk_drawing_area_new();
    struct GaugeData *data = g_new(GaugeData, 1);
    /* init the data */

    /* ... */
    g_signal_connect_data(gaugearea1, "draw", G_CALLBACK(draw_event), 
                data, gauge_data_free, 0);
} 
```

# zend-framework - ZendX 选项卡内的 ZendX 对话框未正确加载

> ID：11268638
> 
> 赞同：1
> 
> 时间：2012-06-29T20:37:07.857
> 
> 标签：zend-framework, dialog, tabcontainer, zendx

我在加载 TabContainer 内的视图上的对话框时遇到了一些问题，所有这些都使用 ZendX。我不得不再次加载应用程序的所有布局和 JS，以便我可以使用这些资源。任何人都知道我需要在我的视图上加载什么，我可以加载通过 ajax 将其传递给我的 tabcontainer 的对话框？如果我再次加载洞的东西，它会变得太慢了。

这是问题的屏幕截图：

[http://i.stack.imgur.com/bdK0k.jpg](http://i.stack.imgur.com/bdK0k.jpg)

这就是我再次加载所有布局和脚本的效果：

[http://i.stack.imgur.com/T8qNr.jpg](http://i.stack.imgur.com/T8qNr.jpg)

# jquery - jquery .load() url 动态定位

> ID：11268639
> 
> 赞同：3
> 
> 时间：2012-06-29T20:37:09.837
> 
> 标签：jquery, load

我有

```
<div><a class='link' href='index.php' data-container='target'>Load</a></div>
<div class='target'></div> 
```

我需要编写将 href url 加载到数据容器属性的 jquery 代码

```
$('.link').click(function(e) {
    e.preventDefault();
    $(this.data-container).load(this.href);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:40:08.993

像这样使用`data`：

```
$('.link').click(function(e) {
    e.preventDefault();
    $('.' + $(this).data('container')).load(this.href);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:42:10.067

```
$('.link').click(function(e) {
    e.preventDefault();
    var container = $(this).data('container');
    $('.'+ container).load(this.href);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T22:30:22.453

我回答自己的问题以明确解决方案并使其变得更好

```
<div><a class='link' href='index.php' data-target='.target-class'>Load</a></div>
<div class='target-class'></div>

<div><a class='link' href='index.php' data-target='#target-id'>Load</a></div>
<div id='target-id'></div> 
```

jQuery 脚本，我使用 Claudio 的修复作为修改的基础（Blaster 相同但更短）

```
$('.link').click(function(e) {
    e.preventDefault();
    var target = $(this).data('target');
    $(target).load(this.href);
}); 
```

# c# - Linq to XML 顺序

> ID：11268641
> 
> 赞同：2
> 
> 时间：2012-06-29T20:37:32.757
> 
> 标签：c#, linq-to-xml

当使用 XDocument 读取带有 linq to XML 的 XML 文件并且查询没有排序时，我可以依赖返回的 IEnumerable 中的顺序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:39:39.277

是的。

[例如，查看.Descendants()](http://msdn.microsoft.com/en-us/library/bb360635.aspx)的文档。它表示元素按文档顺序返回。

# svn - TortoiseSVN 在显示 SVN 日志时会下载本地/临时副本，还是仅显示结果而不制作本地副本？

> ID：11268646
> 
> 赞同：1
> 
> 时间：2012-06-29T20:38:05.487
> 
> 标签：svn, logging, tortoisesvn, history

TortoiseSVN 允许您查看日志。当您这样做时，它是否会在计算机上创建临时/本地副本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:03:37.523

如果您打开 tortoisesvn 设置，则会有一个标记为 Log Caching 的选项和一个启用复选框（默认情况下应该启用）以及其他一些选项。

对于以前的版本，这里有一篇很棒的文章，但仍然适用。 [http://tortoisesvn.net/logcacheuuids.html](http://tortoisesvn.net/logcacheuuids.html)

# .net - 为什么 TimeSpan 是用 100ns 的“滴答声”构建的？

> ID：11268647
> 
> 赞同：1
> 
> 时间：2012-06-29T20:38:05.470
> 
> 标签：.net, timespan

TimeSpan 类可以用天、小时、分钟、秒和毫秒来构造：

```
public TimeSpan(int hours, int minutes, int seconds);
public TimeSpan(int days, int hours, int minutes, int seconds);
public TimeSpan(int days, int hours, int minutes, int seconds, int milliseconds); 
```

它也可以用 100 纳秒时间单位的“滴答”构建：

```
public TimeSpan(long ticks); 
```

当许多其他与时间相关的对象（例如 System.Timers.Timer.Interval）都基于毫秒单位时，100 纳秒有什么意义？另外，为什么不使用微秒，它长 10 倍，但更常见的时间单位？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:44:57.963

因为 Wintel 计算机基于使用 100ns 滴答的硬件时钟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T21:06:51.457

它是一个[clunk](http://en.wikipedia.org/wiki/OpenVMS#Timekeeping)，是 [Open]VMS 中使用的时间单位。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-17T12:29:57.150

除非您自己参与决策，否则很难回答“为什么”的问题。话虽如此，正如 HABO 的回答所表明的那样，100 ns 滴答声很可能是 VMS 的灵感（[Dave Cutler](https://en.wikipedia.org/wiki/Dave_Cutler)参与了 VMS 和 Windows NT 的设计）。

但是，由于您希望将时间跨度适合有符号的 64 位数字，因此使用 100 ns 作为刻度值是有意义的。最大时间跨度 ( `TimeSpan.MaxValue`) 为

```
0x7FFF FFFF FFFF FFFF 滴答声
  = 9 223 372 036 854 775 807 个滴答声
  = 9 223 372 036 854 775 807 滴答 / 10 000 000 滴答/秒
  = 922 337 203 685 秒
  ~ 30 000 年

```

不同的刻度值导致不同的最大时间跨度：

```
蜱虫 | 最大时间跨度（大约）
-------+------------
 10 纳秒 | 3000 年
100 纳秒 | 30 000 年
  1微秒| 30万年

```

忽略`DateTime.Kind`一个`DateTime`值基本上是`TimeSpan`与纪元 01-01-0001 00:00:00 ( `DateTime.MinValue`) 的偏移量，因此使用 100 ns 滴答声，您可以适应日期 31-12-9999 23:59:59 ( `DateTime.MaxValue`)。对于 10 ns 滴答声，您将在 3000 年之前用完滴答声，这是不可能的。而对于 1 μs 滴答声，您可以将时间分辨率降低 10 倍，而对于假设 10000 年的日期表示，您不会得到任何回报第一年“你不在乎”。

考虑到这一点，似乎使用带符号的 64 位值仍然允许您表示所有 4 位数年份的最小刻度值是 100 ns。

（如果你认为 2000 年的问题对 IT 行业来说很难，那就等 10000 年的问题吧。）

# android - 在没有上下文的情况下访问 SharedPreferences

> ID：11268648
> 
> 赞同：17
> 
> 时间：2012-06-29T20:38:05.750
> 
> 标签：android

我已阅读问题：[this](https://stackoverflow.com/questions/2614719/how-do-i-get-the-sharedpreferences-from-a-preferenceactivity-in-android)和[this](https://stackoverflow.com/questions/3806051/accessing-sharedpreferences-through-static-methods)关于阅读共享偏好。但是他们仍然需要 Context 来访问 SharedPreferences。我想知道如何在没有上下文的情况下访问 SharedPreferences。提前致谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-29T21:09:00.177

[我通过首先检索 ApplicationContext ( this](https://stackoverflow.com/questions/2002288/static-way-to-get-context-on-android) )来解决我的问题，然后使用该上下文来获取 SharedPreferences。感谢 K-ballo。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-10-29T15:01:26.483

应用类：

```
import android.app.Application;
import android.content.Context;

public class MyApplication extends Application {

    private static Context mContext;

    public void onCreate() {
        super.onCreate();
        mContext = getApplicationContext();
    }

    public static Context getAppContext() {
        return mContext;
    }

} 
```

在 AndroidManifest 中声明应用程序：

```
<application android:name=".MyApplication"
    ...
/> 
```

用法：

```
PreferenceManager.getDefaultSharedPreferences(MyApplication.getAppContext()); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-05-03T10:45:56.640

我们可以在具有 Getter 和 Setter 的帮助器类中使用 SharedPreference 实例，而不涉及[**此处解释的上下文**](http://www.freakyjolly.com/shared-preference-context-error-android/)

在**MainActivity**添加

```
public static SharedPreferences preferences;
preferences = getSharedPreferences( getPackageName() + "_preferences", MODE_PRIVATE); 
```

然后在**PreferenceHelper**中使用 set 并获取为

```
public static void setName(String value) {
    MainActivity.preferences.edit().putString(KEY_DEMO_NAME, value ).commit();
}
public static String getName() {
    return MainActivity.preferences.getString(KEY_DEMO_NAME,"");
} 
```

# coffeescript - 将键值数组映射到值数组

> ID：11268649
> 
> 赞同：1
> 
> 时间：2012-06-29T20:38:07.810
> 
> 标签：coffeescript

我在 Coffeescript 中有一组值，例如：

```
arr = ['key1': 1, 'key2': 2, 'key3': 3] 
```

我想将此数组转换为一个仅包含值的数组。基本上，

```
arr.map (iter) -> iter.value  # arr => [1,2,3]

=> [] 
```

我已经尝试了几种排列方式，但我只是不断地返回一个空数组。有小费吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-29T20:54:51.097

这是一个 CoffeeScript 问题，示例代码是有效的 CoffeeScript

`arr = ['key1': 1, 'key2': 2, 'key3': 3]`

转换为以下 JavaScript：

```
var arr;
arr = [
  {
    'key1': 1,
    'key2': 2,
    'key3': 3
  }
]; 
```

首先，你必须意识到

```
obj = 
  key1: 1 
  key2: 2
  key3: 3 
```

很可能是你想要的。

然后，您可以使用以下代码创建一个仅包含对象值的数组。

```
arr = null
arr.push val for key, val of obj 
```

**更新**

《亩太短》的这首单行字就更好了。

```
arr = (val for key, val of obj) 
```

# android - 以编程方式展开/折叠组

> ID：11268650
> 
> 赞同：0
> 
> 时间：2012-06-29T20:38:11.917
> 
> 标签：android, xamarin.android, expandablelistview

我想向用户显示所有单元及其所有子单元的列表，以在 ExpandableListView 中进行选择，他们可以在其中检查要移动的单元。由于在 ListView 中似乎有可点击的视图会阻止它自然展开和折叠，所以我将简单地允许 CheckedChange 事件根据 groupPosition 展开/折叠。但是，当我更改一个 CheckBox 上的检查时，几个或所有组都会响应，而不仅仅是我单击的组。

equilistparent.axml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="horizontal"
android:layout_width="fill_parent"
android:layout_height="35dp"
android:gravity="center_vertical">
<CheckBox
    android:id="@+id/check"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="45dp" />
<TextView
    android:id="@+id/info"
    android:layout_width="300dp"
    android:layout_height="wrap_content"
    android:layout_margin="5dp"
    android:textSize="20dp"
    android:gravity="left" />
<AutoCompleteTextView
    android:id="@+id/sites"
    android:layout_width="100dp"
    android:layout_height="wrap_content"
    android:textSize="20dp"
    android:textColor="@android:color/black"
    android:background="@android:color/white"
    android:layout_margin="5dp"
    android:textCursorDrawable="@null"
    android:gravity="center_horizontal"
    android:hint="To Store" />
</LinearLayout> 
```

自定义适配器

```
class EquipAdapter : BaseExpandableListAdapter
{
    private string[] Parent { get; set; }
    private List<List<CPEquipment>> Child { get; set; }
    private Context _context { get; set; }
    private IListAdapter _adapter { get; set; }
    private ExpandableListView _list { get; set; }

    public EquipAdapter(Context context, List<string> parent, List<List<CPEquipment>> child, IListAdapter adapter, ExpandableListView list)
    {
        _context = context;
        Parent = parent.ToArray();
        Child = child;
        _adapter = adapter;
        _list = list;
    }

    public override Object GetChild(int groupPosition, int childPosition)
    {
        List<CPEquipment> level1 = Child.ElementAt(groupPosition);
        CPEquipment level2 = level1.ElementAt(childPosition);

        return level2.Serial + " " + level2.Model;
    }

    public override long GetChildId(int groupPosition, int childPosition)
    {
        return Convert.ToInt32(groupPosition.ToString(CultureInfo.InvariantCulture) + childPosition.ToString(CultureInfo.InvariantCulture));
    }

    public override int GetChildrenCount(int groupPosition)
    {
        return Child.ElementAt(groupPosition).Count;
    }

    public override View GetChildView(int groupPosition, int childPosition, bool isLastChild, View convertView, ViewGroup parent)
    {
        if (convertView == null)
        {
            LayoutInflater inflater = (LayoutInflater) _context.GetSystemService(Context.LayoutInflaterService);
            convertView = inflater.Inflate(Android.Resource.Layout.SimpleExpandableListItem2, null);
        }

        TextView text = (TextView) convertView.FindViewById(Android.Resource.Id.Text2);
        text.Text = GetChild(groupPosition, childPosition).ToString();

        return convertView;
    }

    public override Object GetGroup(int groupPosition)
    {
        return Parent[groupPosition];
    }

    public override long GetGroupId(int groupPosition)
    {
        return groupPosition;
    }

    public override View GetGroupView(int groupPosition, bool isExpanded, View convertView, ViewGroup parent)
    {
        if (convertView == null)
        {
            LayoutInflater inflater = (LayoutInflater) _context.GetSystemService(Context.LayoutInflaterService);
            convertView = inflater.Inflate(Resource.Layout.equiplistparent, null);
        }

        TextView info = (TextView) convertView.FindViewById(Resource.Id.info);
        info.Text = GetGroup(groupPosition).ToString();
        AutoCompleteTextView acText = (AutoCompleteTextView) convertView.FindViewById(Resource.Id.sites);
        acText.Adapter = _adapter;

        CheckBox check = (CheckBox) convertView.FindViewById(Resource.Id.check);
        check.CheckedChange += (o, args) =>
                                   {
                                       int currGroup = groupPosition;
                                       if (args.IsChecked)
                                           _list.ExpandGroup(currGroup);
                                       else
                                       {
                                           _list.CollapseGroup(currGroup);
                                       }
                                   };
        return convertView;
    }

    public override bool IsChildSelectable(int groupPosition, int childPosition)
    {
        return true;
    }

    public override int GroupCount
    {
        get { return Parent.Length; }
    }

    public override bool HasStableIds
    {
        get { return true; }
    }

} 
```

我尝试使用[这个建议](https://stackoverflow.com/questions/2322390/android-row-becomes-unclickable-with-button/2323085#2323085)来解决这个问题，但它对 ListViews 自然展开或折叠的能力没有任何影响。

我尝试将复选框放在子级而不是父级中，并强制所有组打开。但是现在如果我检查其中的 3 个框，另外 3 个框将随机检查自己。我知道有一种方法可以在 ListViews 中使用复选框，但它们的行为与我的预期不同。MonoDroid 有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T21:23:41.750

我最近自己经历了这个，终于让这一切都正常工作了。[我在这里](https://stackoverflow.com/questions/10546200/onchildclick-inside-expandablelistactivity-does-not-fire/10578078#10578078)发布了我的原始问题以及我的最终解决方案，以使一切正常运行。不确定这是否会对您有所帮助，但这听起来很接近我遇到的问题并使用我的解决方案，我能够让它正常工作。

# r - 如何使用 lapply 在 R 中更改这样的列名？

> ID：11268651
> 
> 赞同：1
> 
> 时间：2012-06-29T20:38:27.263
> 
> 标签：r, functional-programming

?以下是 R 的交互环境的输出。

我尝试更改 , 和 的 colnames `P300.H1`，`P300.GM`但`Suz12.H1`没有奏效。

```
> lapply(list(P300.H1,P300.GM,Suz12.H1), function(x) {colnames(x) <- c("chrom","start", "end", "name", "score")})
[[1]]
[1] "chrom" "start" "end"   "name"  "score"

[[2]]
[1] "chrom" "start" "end"   "name"  "score"

[[3]]
[1] "chrom" "start" "end"   "name"  "score"

> colnames(P300.H1)
[1] "V1" "V2" "V3" "V4" "V5" 
```

我认为问题可能与作业有关，但我仍然对此感到困惑。

任何人都可以向我解释其中的原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:48:03.327

可能有更好的方法，`assign`像这样使用可能会给你带来麻烦：

```
d1 <- d2 <- data.frame(x=1, y=2)

myfun <- function(x) {
  x.df <- get(x)
  colnames(x.df) <- c('n1', 'n2')
  assign(x, x.df, env=.GlobalEnv)
}

lapply(c('d1', 'd2'), myfun) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:51:34.823

如果您真的要将每个列的名称更改为相同的名称集，这是一种简单的方法（仅适用于少量数据框）：

```
colnames(P300.H1) <- colnames(P300.GM) <- colnames(Suz12.H1) <- c("chrom","start", "end", "name", "score") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T20:49:47.333

在这里使用 for 循环可能比使用更容易和/或更安全`lapply`（或者至少这是星期五下午 4 点想到的）：

```
DF <- data.frame(x = c(1, 2, 3,NA), y = c(1,0, 10, NA), z=c(43,NA, 33, NA))
#make your list
yourList <- list(DF,DF)

for (i in seq(yourList)){
  colnames(yourList[[i]]) <- c("foo", "bar", "baz")
}
#Confirm output is right
> lapply(yourList, colnames)
[[1]]
[1] "foo" "bar" "baz"

[[2]]
[1] "foo" "bar" "baz" 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-29T20:41:54.953

R 按值传递，而不是按引用传递，因此在函数内更改数据框的列名不会在函数外更改它。

作为一个简单的、可重现的示例：

```
m <- matrix(rnorm(12), ncol=3)
colnames(m) <- c("A", "B", "C")

change.names = function(x) {
    colnames(x) <- c("X", "Y", "Z")
}

change.names(m)
print(colnames(m)) 
```

列名仍然是 A、B、C。该`x`函数中的不是矩阵`m`：它只是它的副本，您对它所做的任何更改都不会应用于原始矩阵。

# c# - DataPager 无法使用我的数据源

> ID：11268652
> 
> 赞同：0
> 
> 时间：2012-06-29T20:38:28.170
> 
> 标签：c#, linq

我似乎无法让我的数据寻呼机工作。我一直在寻找答案，似乎我得到的错误是“ID为'searchResults'的ListView必须有一个数据源，该数据源要么实现ICollection，要么如果AllowPaging为真，则可以执行数据源分页。” 很常见，通常答案是将 ToArray() 放在 DataSource 上。但是我不确定如何将数组放在我的链接语句中。有人可以请教。

```
 searchResults.DataSource = from r in response.Results
        select new
        {
            Title = r[SearchContentProperty.Title],
            Summary = r[SearchContentProperty.HighlightedSummary]
        };

    searchResults.DataBind(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:58:01.750

要将 ToArray() 添加到您的 LINQ 查询中，请尝试以下操作：

```
 searchResults.DataSource = (from r in response.Results
    select new
    {
        Title = r[SearchContentProperty.Title],
        Summary = r[SearchContentProperty.HighlightedSummary]
    }).ToArray();

searchResults.DataBind(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T09:39:23.743

```
searchResults.DataSource = (from r in response.Results
select new
{
    Title = r[SearchContentProperty.Title],
    Summary = r[SearchContentProperty.HighlightedSummary]
}).ToArray(); 
```

searchResults.DataBind(); 是真的，

编辑：我遇到了几乎同样的问题，但如果仍然没有分页，你可以使用 searchResults PagePropertiesChanging 事件并编写这样的代码来获得分页正常

```
protected void searchResults_PagePropertiesChanging(object sender,PagePropertiesChangingEventArgs e)
{
DataPager1.SetPageProperties(e.StartRowIndex, e.MaximumRows, false);

//write your codes again to bind data,for this example:

searchResults.DataSource = from r in response.Results
select new
{
    Title = r[SearchContentProperty.Title],
    Summary = r[SearchContentProperty.HighlightedSummary]
 };

 searchResults.DataBind();
} 
```

# spring - 基于spring的jar中的jndi数据源

> ID：11268664
> 
> 赞同：0
> 
> 时间：2012-06-29T20:39:17.467
> 
> 标签：spring

我已经开发了示例 api 作为 jar 文件。这个 jar 文件包含 10 个不同应用程序通用的代码，所以所有这些应用程序所要做的就是包含这个 jar 文件。现在这个 jar 文件使用 spring 和 jndi 数据源。当我在其中一个 spring mvc 应用程序中使用这个 jar 作为依赖项时，它没有找到在 jar 文件内的上下文文件之一中定义的 jndi 数据源 bean。如何告诉 spring 容器扫描 jar 中的所有应用程序上下文文件。

还有其他不是spring mvc的Web应用程序，它们也使用相同的jar文件作为依赖项，他们如何使用这个基于spring的jar文件。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:17:29.863

您应该在应用程序的 Web 中添加 jar 的应用程序上下文文件，例如：

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        classpath:main-context.xml,
        classpath:library-context.xml
    </param-value>
</context-param> 
```

您也可以使用 library-context*.xml 之类的东西来导入少量上下文文件，但我认为最好一一进行，这样您就可以准确地知道您正在使用哪些上下文文件。

如果你有没有使用 Spring MVC 的应用程序，这不是问题，因为你不需要 Spring MVC，只需要 Spring IoC

# javascript - 以不同的间隔依次显示内容

> ID：11268669
> 
> 赞同：1
> 
> 时间：2012-06-29T20:39:31.727
> 
> 标签：javascript

假设我的 javascript 中有两个数组：

```
var content = ["string1", "string2", "string3", "string4"],
    milliseconds = [500, 1500, 1000, 500]; 
```

我希望`content`数组的每个元素一个一个地显示在控制台中，并以`milliseconds`数组的间隔`string1`在 500 毫秒后显示，`string2`在 1500 毫秒后（从 的显示开始`string1`）等等。

我是一个初学者，我尝试过类似的东西：

```
for (var i = 0; i < content.length - 1; i++) {
    setTimeout(function() {
        console.log(content[i]);
    }, milliseconds[i]);
}; 
```

但是它只显示了最后一个字符串四次，看起来`setTimeout`方法都是同时开始的，而不是一个接一个。有没有办法达到我想要的效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:47:43.707

不确定每次都记录第四个字符串，不幸的是我的手机不允许我运行它，但我可以确切地看到为什么所有 4 个超时同时开始。这是因为它们都是同时创建的。如果您希望他们一个接一个地启动，您必须让每个启动下一个超时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:53:42.063

首先，`setTimeout`s 似乎都是同时开始的，因为您同时调用它们。JavaScript 不会阻塞——它不会等待`setTimeout`回调真正触发，它只会继续运行。这就是为什么，由于您使用的是循环，所有的回调或多或少地一次被安排。

第二个问题，所有的`console.log`s 似乎都打印相同的东西，是因为相同的循环问题。由于循环在任何回调完成之前完成，因此值`i`设置为循环的最后一个索引。那么，当回调发生时，猜猜`i`等于什么？

一种技术是只保留当前项目的运行索引。

```
// Don't pollute the global namespace
(function() {
    // Keep the index around
    var i = 0;

    // Setup the callback
    var callback = function() {
        console.log(content[i]);

        // Stop whenever there's nothing left to log
        if (i < content.length) {
            // Chain the next timeout, using the next string,
            // with the next wait period, using the callback
            i += 1;
            setTimeout(callback, milliseconds[i]);
        }
    };

    // Start the first setTimeout
    setTimeout(callback, milliseconds[i]);
})(); 
```

# image - 存储上传的图像：应该存储在服务器上还是数据库中？

> ID：11268675
> 
> 赞同：3
> 
> 时间：2012-06-29T20:40:05.497
> 
> 标签：image, oracle, upload

我一直致力于改造一个非常古老的基于 Java Servlet 的 web 应用程序。webapp 允许用户上传图片。webapp 会在数据库中存储对图像的路径引用，但会将图像上传到它们所在的服务器上的目录。

webapp 的数据库已升级到 Oracle 11g，我被告知可以处理二进制信息。

所以，我的问题是，哪个更聪明？

继续将图像作为文件存储在服务器上还是将图像填充到 Oracle 11g 数据库中？

非常感谢提前

史蒂夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T20:56:13.343

是的，您可以在 Oracle 中将 BLOB 用于二进制数据。（以及许多其他数据库。）我们在这里使用它们来存储 PDF 文件。

我已经看到它以两种方式完成。将图像存储在数据库中，或者将图像存储在文件系统中，然后将文件名保存在数据库中。

**存储在数据库中的优点**

一切都在数据库中。你拿出一个记录，相关的图像就在那里。

您可以在文件及其关联数据之间获得数据完整性（当然，假设有良好的架构设计。）

获取数据和图像的一种逻辑操作。

我发现扩展数据库以容纳大量二进制数据比文件系统替代方案更难且更昂贵。

**存储在数据库中的缺点**

并非所有工具都可以轻松浏览图像。

无法轻松访问网络上的图像。

根据文件大小和数量，您最终可能会在某些表中获得大量原始数据。

加载和存储 blob 数据并不总是直截了当的。（例如，我最近为 Hibernate 编写了一个自定义数据类型来处理我们的 blobbed PDF。）

**文件系统的优势**

读取和写入文件可能更有效。

如果您想在网络上提供图像，您可以直接从文件系统执行此操作。

在调试期间更容易浏览图像，并且有很多免费工具可以做到这一点。

我相信将 blob 放入文件系统时更容易扩展应用程序。

**文件系统的缺点**

数据完整性/一致性问题。改变一些关于文件结构的东西，你在数据库中还有一个步骤要做。

备份是另一回事。

多个逻辑操作（从数据库读取，从文件系统读取）来获取图像和数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:48:43.253

一个想法是将图像存储在服务器中并保留对图像实际位置的引用。这样您就可以为图片分配更多元数据，例如名称、大小、格式等，以便于查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T20:52:59.523

存储在服务器上，然后在数据库中获取图像的数据。

即，您可以在上传时从图像中提取 EXIF 数据，然后将它们与对图像的文件系统引用一起存储。

# c# - 使用 JSON 时类中的数组问题

> ID：11268676
> 
> 赞同：2
> 
> 时间：2012-06-29T20:40:06.330
> 
> 标签：c#, json, unity3d

我有一个序列化问题。我希望保存和加载一个简单的 3d 数据块。我有一个包含尺寸（宽度、高度和长度）以及一个 3D 整数数组的类。JSON 非常高兴地将类转换为字符串以供我保存，但是在再次转换回来时它的播放效果并不好。

数据类：

```
Public class cClusterData {
public int mWidth;
public int mHeight;
public int mLength;
public int[,,] mCellType;

public cClusterData()
{
    mCellType = new int[32,32,32];
}
} 
```

保存它的例程：

```
 public void SaveCluster()
{
    cClusterData lData = new cClusterData();
    lData.mWidth = mWidth;
    lData.mHeight = mHeight;
    lData.mLength = mLength;
    for (int lX = 0; lX < mWidth; lX++)
    {
        for (int lY = 0; lY < mHeight; lY++)
        {
            for (int lZ = 0; lZ < mLength; lZ++)
            {
                lData.mCellType[lX,lY,lZ] = (int)mCell[lX,lY,lZ].mType;
            }
        }
    }

    string lDataString = LitJson.JsonMapper.ToJson(lData);
    cFileUtils.WriteStringToFile("TestCluster", lDataString);
    Debug.Log("Done saving");
} 
```

以及再次加载它的函数：

```
 public void LoadCluster()
{
    string lDataString = cFileUtils.LoadStringFromFile("TestCluster");
    cClusterData lData = new cClusterData();
    lData = LitJson.JsonMapper.ToObject<cClusterData>(lDataString);
    Debug.Log("Loaded header " + lDataString);
    // convert cluster data to actual cluster
    mWidth = lData.mWidth;
    mHeight = lData.mHeight;
    mLength = lData.mLength;

    CreateBlankCluster();
    for (int lX = 0; lX < mWidth; lX++)
    {
        for (int lY = 0; lY < mHeight; lY++)
        {
            for (int lZ = 0; lZ < mLength; lZ++)
            {
                mCell[lX,lY,lZ].SetType((cCell.eCellType)lData.mCellType[lX,lY,lZ]);
            }
        }
    }
} 
```

一切都很好，直到它尝试访问 lData.mCellType ，此时它抛出了 NullReferenceException ：

NullReferenceException：对象引用未设置为对象的实例（包装器托管到托管）对象：ElementAddr（object，int，int，int）

我的猜测将涉及在构造函数中设置数组的方式，而我只是在某处遗漏了一行。但我无法解决。加油，互联网！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T07:10:07.277

我没有在您的代码片段中看到，但是您是否`[System.Serializable]`在此类之前添加了？[这](http://answers.unity3d.com/questions/304478/serialization-of-custom-class.html)和[这](http://answers.unity3d.com/questions/134168/how-to-serialize-an-array-of-classes.html)都是从同一个问题开始的，一个自定义类，所有的解决方案似乎都是通过将它添加到类的顶部来找到的。

# javascript - 如何将当前时间与使用 Javascript 格式化为字符串的时间范围进行比较

> ID：11268680
> 
> 赞同：2
> 
> 时间：2012-06-29T20:40:17.713
> 
> 标签：javascript, date, time, compare

我在我的数据库中有两次格式化为字符串，它们的格式分别为上午 8:30 和晚上 9:00。使用Javascript，我不想得到当前时间，看看我是否在两次的范围内。我该怎么做

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:00:55.600

将开始、结束和当前时间转换为 JavaScript Date 对象，然后检查是否`start <= current < end`. 如果开始日期小于结束日期，就会变得很棘手：

```
// The un-important bits
var d0 = new Date("01/01/2001 " + "8:30 AM");
var d1 = new Date("01/01/2001 " + "9:00 PM");
var d = new Date("01/01/2001");
d.setHours(new Date().getHours());
d.setMinutes(new Date().getMinutes());

// For testing
console.log(d0, d, d1);

// The important bit
console.log(
    d0 < d1
        ? (d0 <= d && d < d1)
        : (d1 <= d && d < d0) == false
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:03:41.727

像这样？

```
function validNow ( from, until ) {
    var toTime= function ( str ) {
        var match = str.match(/^(\d+):(\d+)\s*([AP])/);
        if ( !match ) throw "str has wrong format";
        return match[1] * 60 + +match[2] + (match[3] == 'P' ? 720 : 0);
    };

    var d= new Date();           
    var current= d.getHours() * 60 + d.getMinutes();
    console.log(current, toTime(until));
    return current >= toTime(from) && current <= toTime(until);
}

console.log(validNow('8:30PM', '10:11PM')); 
```

# winapi - DuplicateHandle 的 DUPLICATE_CLOSE_HANDLE 标志有什么意义？

> ID：11268687
> 
> 赞同：2
> 
> 时间：2012-06-29T20:41:04.670
> 
> 标签：winapi, pipe

我试图找出我继承的一些 Win32 管道代码中的问题。这是 x2 的[旧备用](http://blogs.msdn.com/b/oldnewthing/archive/2011/07/08/10184375.aspx)，`CreatePipe()`后跟`DuplicateHandle()`x2 和`CreateProcess()`.

```
 if (!CreatePipe(&child_stdout_read, &parent_write, &security, 0) ||
      !DuplicateHandle(GetCurrentProcess(), parent_write,
      GetCurrentProcess(), &child_stdout_write, 0, TRUE,
      DUPLICATE_SAME_ACCESS | DUPLICATE_CLOSE_SOURCE)) {
        throw std::system_error(GetLastError(), std::system_category());
    } 
```

让我感到困惑的是通话`DUPLICATE_CLOSE_SOURCE`中使用的标志。`DuplicateHandle()`根据 Microsoft 文档，这意味着源句柄将在复制后关闭。

将句柄（到管道）的副本复制到同一进程中，然后关闭原始句柄究竟有什么意义？为什么不直接使用原版？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T21:45:18.373

好吧，在我看来，关键在于`TRUE`参数。那就是`BOOL bInheritHandle`, 所以这段代码所做的是复制句柄以使其可继承。

通常，这可以通过在创建句柄时设置为`security.bInheritHandle`来轻松完成。`TRUE`但在这种情况下，这将使*两个*句柄都可以继承。而且很明显，原作者只想继承`child_stdout_write`.

请注意，使用较少人为的代码可以实现相同的效果：

```
SetHandleInformation(handle, HANDLE_FLAG_INHERIT, HANDLE_FLAG_INHERIT); 
```

# java - xml beans 类的“mangling”命名空间/包名称

> ID：11268690
> 
> 赞同：-1
> 
> 时间：2012-06-29T20:41:18.663
> 
> 标签：java, xml, xsd, schema, xmlbeans

我有一个xml，我需要使用java代码，并且认为xml beans很有意义。输入 xml 文件没有命名空间，我无法修改 xml 输入格式。

我使用[trang](http://www.dotkam.com/2008/05/28/generate-xsd-from-xml/)将 xml 转换为 xsd，然后使用 xmlbeans-maven-plugin 从 xsd 生成 java 类。这很好用，但是，我想将生成的类放入我选择的特定包中，除了添加命名空间（我做不到因为这需要更改输入 xml 文件）。

我觉得可能有一个简单的解决方案，我根本没有看到。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-29T20:43:05.527

几乎就在我发布这个的时候，我发现了这个。

[http://wiki.apache.org/xmlbeans/XmlBeansFaq#configPackageName](http://wiki.apache.org/xmlbeans/XmlBeansFaq#configPackageName)

# php - 显示当前的 Facebook 通知

> ID：11268699
> 
> 赞同：1
> 
> 时间：2012-06-29T20:42:09.150
> 
> 标签：php, javascript, jquery, facebook

我正在尝试在网页上显示用户的 Facebook 通知，就像它在 Facebook 本身中的显示方式一样。但是，我不知道如何准确地对 Facebook API 进行此查询，然后更新网页。

我创建了一个查询，希望能返回我需要的内容：

```
SELECT notification_id, sender_id, title_html, body_html, href
FROM notification
WHERE recipient_id=<uid>
AND is_unread = 1
AND is_hidden = 0 
```

我被困在上面并且无法真正找到有关如何使用 JavaScript 发送此查询的任何信息？我是否必须向返回响应或其他内容的单独 PHP 页面发出 AJAX 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:03:31.307

试试这个：

```
FB.api({
    method: 'fql.query',
    query: 'SELECT notification_id, sender_id, title_html, body_html, href'
        + ' FROM notification'
        + ' WHERE recipient_id=' + uid
        + ' AND is_unread = 1'
        + ' AND is_hidden = 0'
}, function(response){
    console.log(response);
}); 
```

# android - How do I map a host inside of an android application?

> ID：11268716
> 
> 赞同：1
> 
> 时间：2012-06-29T20:44:02.673
> 
> 标签：android, dns, apache-httpclient-4.x

We have several servers behind a load balancer, this balancer will point to different servers depending on what the requested domain was. Some of the domains are not public and therefore must be provided by an in-house dns solution or hosts file.

I have an android application which when in debug mode needs to be able to connect to our testing servers. The issue is that we want this to work in the field without having to alter the hosts file of everyone who will be testing this. I'm sure there has to be a way to map an IP address to a domain name inside of my application's network class before I make requests.

Can someone point me to documentation about mapping IPs to domains using the DefaultHttpClient or anything similar? Thanks.

# android - 将文件写入 /system

> ID：11268717
> 
> 赞同：3
> 
> 时间：2012-06-29T20:44:12.690
> 
> 标签：android, io, root

我知道这已经被问了很多，但从来没有回答过。我绝对需要将文件写入根目录，没有其他解决方案。我目前使用此代码，但它在 /system/ 中没有显示任何新内容。我想将文件从我的资产复制到 /system 文件夹（带有它的子目录）

```
public void installFiles(View v) {
            try {
        Runtime.getRuntime().exec("su");
    } catch (IOException e) {
        mDebugView.append(e.toString());
    }
    copyPath("system/bin", "/system/bin/");
    copyPath("system/lib", "/system/lib/");
    copyPath("system/etc", "/system/etc/");
    copyPath("system/etc/audio", "/system/etc/audio/");
    copyPath("system/etc/soundimage", "/system/etc/soundimage/");
    copyPath("system/lib/soundfx", "/system/bin/soundfx/");
}

public void copyPath(String from, String to) {
    mDebugView.append("Copying path assets/" + from + " to " + to + "\n");
    AssetManager assetManager = getAssets();
    String[] files = null;
    try {
        files = assetManager.list(from);
        for (String filename : files) {
            mDebugView.append(filename + "... \n");
            if (new File(filename).isFile()) {
                mDebugView.append("Copying " + filename + "\n");
                InputStream in = null;
                OutputStream out = null;
                in = assetManager.open(filename);
                out = new FileOutputStream(to);
                copyFile(in, out);
                in.close();
                in = null;
                out.flush();
                out.close();
                out = null;
            }
        }
    } catch (IOException e) {
        Log.e(this.getClass().toString(), e.toString());
        mDebugView.append(e.toString() + "\n");
    }
}

private void copyFile(InputStream in, OutputStream out) throws IOException {
    mDebugView.append("..");
    byte[] buffer = new byte[1024];
    int read;
    while ((read = in.read(buffer)) != -1) {
        out.write(buffer, 0, read);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T21:14:30.337

您的

```
Runtime.getRuntime().exec("su"); 
```

什么也没做。随着进程的创建然后被释放。要移动文件，您需要使用带有 su 的 cat 二进制文件。IE

```
Runtime.getRuntime().exec("su cat filepath1 > filepath2"); 
```

对于尽可能多的命令，最好获取 su 的流程实例，然后一次执行所有移动命令。

另请注意，您可能必须将系统分区挂载为 rw，因为默认情况下它可能不是 r/w。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T22:08:55.033

您看不到任何更改，`/system`因为它默认安装为只读。请确保在写入文件之前重新安装它。尽管正如其他人提到`su`的，应该与命令一起使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-01T16:53:19.687

我一直在挖掘，我找到了一种方法。

1.  经过一些尝试，我的 ROM（更确切地说是 /system 文件夹）严重损坏，以至于我总是看到错误流输入：“无权限”-> 使用擦除重新安装 ROM

2.  我将文件复制到外部存储（在本例中为 /sdcard，但请注意它可能是另一个路径 - 使用环境对象获取路径）。我将所有子文件夹提取到主文件夹。

3.  与之前的代码一样，新代码打开了一个 SU 会话并再次关闭它。

    ```
    Process proc = runtime.exec("su");
                new ProcessReader(proc).start();
                new ErrorReader(proc).start();
                DataOutputStream os = new DataOutputStream(
                        proc.getOutputStream());
                os.writeBytes("chmod 755 /system/" + "\n");
                os.writeBytes("find /sdcard/.beats_cache/systembin -exec mv '{}' /system/bin +\n");
                os.writeBytes("find /sdcard/.beats_cache/systemlib -exec mv '{}' /system/lib +\n");
                os.writeBytes("find /sdcard/.beats_cache/systemetc -exec mv '{}' /system/etc +\n");
                os.writeBytes("find /sdcard/.beats_cache/systemetcaudio -exec mv '{}' /system/etc/audio +\n");
                os.writeBytes("find /sdcard/.beats_cache/systemetcsoundimage -exec mv '{}' /system/etc/soundimage +\n");
                os.writeBytes("find /sdcard/.beats_cache/systemlibsoundfx -exec mv '{}' /system/lib/soundfx +\n");
                os.writeBytes("exit\n");
                os.flush(); 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T20:54:58.680

在开始时运行 'su' 可能不足以拥有对 /system 文件夹的写入权限。Root Explorer 和其他文件管理应用程序都必须将 /system 重新挂载为 r/w 并以只读方式重新挂载。[这个问题](https://stackoverflow.com/questions/7794659/how-to-change-the-hosts-file-on-android)的答案显示了重新挂载 /system 路径的命令。答案是使用 adb，但在设备上运行它应该也一样好。

附带说明一下，执行系统命令来移动文件可能比自己移动文件更容易。在我运行 Cyanogenmod 7.x 的 LG Optimus T 上，在 /system/xbin 中有`cp`and`mv`可以复制/移动文件而无需重新挂载 /system （如果是这样，可能只能通过`su mv`or `su cp`）。我对 android 的这一部分知之甚少，无法确定您（或安装您的应用程序的人）是否也会拥有这些文件，但值得研究。他们可能需要busybox，我没有调查过。

# sql - Publish / Subscribe pattern in SQL

> ID：11268724
> 
> 赞同：16
> 
> 时间：2012-06-29T20:44:47.120
> 
> 标签：sql, tsql, sql-server-2005, database-design, publish-subscribe

**Background:**

We have a large (15+ million) table of items which is updated frequently throughout the day (average 300K daily changes). Pending changes are stored in a staging table, and a job runs throughout the day to read changes from this table, make the updates, and mark the changes as processed.

Many other applications use the data in the items table to perform various tasks. Often, these tasks are scheduled and intensive, as they involve comparing live data with old snapshots, and updating other systems accordingly. For example, we list items on eBay, and compare live item data with our existing listings to see whether we need to insert any new eBay listings, remove items we've sold, update quantities, etc. Because the data is so large, most of these applications run infrequently, leaving things out of date much of the time.

**My Question:**

We are considering implementing a publisher/subscriber pattern using the Service Broker. The goal would be to publish a message when an item changes, which various other systems (like our eBay application) can subscribe to. This would enable us to make more granular updates closer to real-time, rather than large and infrequent updates that involve querying all data, not just what has changed. However, after using the Google it doesn't seem like this is a common database pattern, and that raises red flags. Is this not a valid use of the Service Broker (though I found a small section in *Pro Sql Server 2008 Service Broker* on doing Pub/Sub)? How is this problem normally solved? It seems like a common enough problem.

**TL;DR:**

Goal: Update various systems in a dynamic, loosely coupled way when single items change.

Question: Is a pub/sub style solution implemented with Service Broker a viable solution in a high volume setting?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T08:14:56.213

这是一种**非常常见**的集成模式。

我不熟悉 SQL Server Service Broker，但如果您查看任何集成中间件堆栈 - TIBCO、Oracle、webMethods、Mule、Informatica 等 - 它们都提供了一个“数据库适配器”来执行您描述的任务。

一般模式是数据库中的更新触发消息发布。这可以通过数据库表中的触发器或通过适配器“轮询”表以获取新更新来完成。任何一种方法都有优点和缺点。

这种模式的主要好处是（正如您所怀疑的）更频繁和及时地更新其他系统 - 一种更“实时”的业务方式。此外，如果您执行到规范消息格式的转换，那么系统之间的耦合会更松散，因此在需要更改/更新系统时会减少痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T23:45:24.273

通常这类问题最终会变得比以数据库为中心的 pub/sub 实现所能提供的更大（范围）。如果我可以提出建议，请考虑使用全面的服务总线：

[nServiceBus](http://nservicebus.com/)（免费到一定大小，过去相当便宜）

您将获得一个可靠的发布/订阅框架，但易于使用，并且拥有庞大的客户、文章和示例用户群。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T08:46:25.143

这不是一种常见的数据库模式，因为大多数关系数据库都非常缺乏开箱即用的能力。如果没有 Service Broker，SQL Server 也会如此。

Service Broker 的一位开发人员[谈到了 Service Broker 如何应对大多数公司转向 NoSQL 解决方案的挑战](http://rusanu.com/2011/06/01/scale-out-sql-server-by-using-reliable-messaging/)。

据我了解，Service Broker 旨在完全满足您的需求。当数据发生变化时，它甚至可以`External Activation`用来[运行自定义应用程序](https://web.archive.org/web/20151205144526/http://blogs.msdn.com/b/sql_service_broker/archive/2009/05/18/get-started-with-using-external-activator.aspx)。

# php - 带参数的多语言脚本

> ID：11268736
> 
> 赞同：0
> 
> 时间：2012-06-29T20:46:48.820
> 
> 标签：php

我一直在制作多语言脚本。我已经让它完美地工作了，有一个带有语言变量的数组。每种语言都有自己的带有变量的文件。脚本根据用户选择的语言决定加载哪个文件。

这是我在每个语言文件中的内容：

```
$lang = array();
$lang['var1'] = "Some text here";
$lang['var2'] = "Some text here";
...
$lang['var20'] = "Some text here"; 
```

现在我想让它更加动态并包含参数。我在 vBulletin 语言模板中看到了，有这样的：`text text text {1} text text text {2} text text`.

我想要这个文本：`Hello {1}, this is the User CP`。该参数应该是动态的，每个用户都不同。

这该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:54:36.020

这取决于您想如何使用它，但是您可以做的例如是使用`printf`或[`sprintf`](http://www.php.net/manual/en/function.sprintf.php)输出：

语言文件：

```
$lang['varxx'] = 'Hello %s, this is the User CP'; 
```

使用它的脚本：

```
$name = "test user";
printf($lang['varxx'], $name);
$modified_string = sprintf($lang['varxx'], $name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:57:03.703

通常使用包装函数。如果您到目前为止一直`$lang`直接访问数组，则必须适应。

这样做非常简单：

```
 function t ($textid) {

      $text = $GLOBALS["lang"][$textid];
      $args = func_get_args();

      $text = preg_replace('#\{(\d+)\}#e', '$args[$1]', $text);

      return $text;
 } 
```

不过，您可以使用另一种模式方案来避开正则表达式。

用法很简单：

```
 print t("var1", "placeholder", ...); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T20:58:00.477

```
$lang = array();
$lang['var1'] = "Hello %1$s, here's a %2$s";
echo vsprintf($lang['var1'], array("John", "cookie")); 
```

输出：

```
Hello John, here's a cookie 
```

更多关于[sprintf](http://php.net/manual/en/function.sprintf.php)和[vsprintf](http://www.php.net/manual/en/function.vsprintf.php)

# .net - Application using Microsoft Office interop v.11 with Windows 7, Microsoft Office 2010

> ID：11268742
> 
> 赞同：1
> 
> 时间：2012-06-29T20:47:26.667
> 
> 标签：.net, excel, powerpoint, office-interop, office-2010

I inherited a custom application that was built using Visual Studio 2003 and .NET 2.0\. It uses Microsoft Office PIA version 11 (for Office 2003), and it originally ran on Windows XP. The application relies on reading Excel, Word, and Powerpoint files, as well as Outlook for reading .PST files.

Now I am trying to get this application to work on a 64-bit, Windows 7 machine that has Office 2010\. For the most part, the application works--it correctly reads the .PST files and uploads emails and attachments (along with correct metadata) to a Sharepoint. It's just that after I close the application and try to open Microsoft Office 2010 products (Word, Excel, Powerpoint, Outlook), these programs tend to crash. The error message would say "Microsoft *_*_ has stopped working."

Looking at event viewer, the logs usually look like this:

```
Faulting application name: OUTLOOK.EXE, version: 14.0.6109.5005, time stamp: 0x4e79b881
Faulting module name: ntdll.dll, version: 6.1.7601.17514, time stamp: 0x4ce7ba58
Exception code: 0xc0000005
Fault offset: 0x0002e3fb
Faulting process id: 0x1b20
Faulting application start time: 0x01cd5631d6ed41d9
Faulting application path: C:\Program Files (x86)\Microsoft Office\Office14\OUTLOOK.EXE
Faulting module path: C:\WINDOWS\SysWOW64\ntdll.dll
Report Id: 2f11010e-c226-11e1-8b8d-9cb70de93ccf 
```

After doing lots of browsing, I am guessing that it has to do with the application referencing PIA version 11 for Office 2003, and the version that I have on this computer is PIA version 14 for Office 2010\. Also, I am 100% sure that it's this application that is causing Office 2010 applications to crash since it happens every time I run that legacy application. Restarting the computer fixes these crashes but I would rather not have to restart every time I run this application!

Short of actually updating the source code, is there anything I can do to fix this problem?

EDIT: I now have access to Visual Studio Express 2010 (C#) and I have source code files from using Reflector. So I guess I can start making code changes. I am still getting a lot of errors though, see my responses below...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T12:46:01.520

听起来遗留应用程序仍然持有两个共享组件，从而导致后续程序崩溃。

如果您无法更改旧版应用程序，那么您将无能为力。像上面的评论建议的那样调试它是一个好方法。但实际上，您需要能够更改应用程序。

你能得到源代码吗？或者这不是供应商“交付”的一部分？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T19:48:55.360

我在使用 VB.Net 2012、Interop.Excel for MSO 14.0 和 Windows 7、64 位时遇到了类似的问题。我能够通过目标 .Net 4.0 而不是 4.5 和 64 位 cpu 来消除这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T16:28:36.987

我尝试删除对旧 Microsoft Office PIA 版本 11（适用于 Office 2003）的引用，并添加对当前 PIA 版本 14（适用于 Office 2010）的新引用。我还将目标 .NET 更改为 .NET 4 ...我现在在构建包时遇到了很多奇怪的代码错误。

主文件将有

```
using System;
using Microsoft.Office.Interop.Excel;
using Microsoft.Office.Interop.Outlook;
using Microsoft.Office.Interop.PowerPoint;
using Microsoft.Office.Interop.Word; 
```

但是当我尝试构建项目时，我会得到所有这些错误，说

```
Microsoft.Office.Interop.Word.System does not contain a definition for 'IO'

The type name 'Drawing' does not exist in the type 'Microsoft.Office.Interop.Word.System' 
```

不知道为什么 Visual Studio 不读取“系统”命名空间。看起来 Word 命名空间正在覆盖 System 命名空间？当我删除“使用 Microsoft.Office.Interop.Word”命名空间时，所有构建错误都会消失（显然，实际使用 Word 的对象或方法除外）

# sql - SQL Server 在列上合并联接后选择

> ID：11268743
> 
> 赞同：2
> 
> 时间：2012-06-29T20:47:30.720
> 
> 标签：sql, sql-server-2008, select, join

使用填充的表类型作为 TSQL-Merge 的源。我想在合并后执行一个 select 语句，检索表类型的所有列/行，但我想要新插入的 id 而不是“-1”值。我不确定我能否以完全基于集合的方式做到这一点，可以吗？

这适用于将一堆插入发送到数据库中的 UI，并且需要返回相同的对象，但填充了它们的每个 ID 列值。SQL JOIN 操作没有“公共列”。

```
CREATE TYPE instype AS TABLE(
    instypeid [smallint] NOT NULL,
    instext [varchar](64) NOT NULL
)
Go
create table #desttable ( instypeid smallint identity(1,1) primary key , instext varchar(64) )
Go
declare @newids table ( idvalue smallint )
declare @thing1 instype
insert into @thing1 values ( -1 , 'zero' )
insert into @thing1 values ( -1 , 'one' )
    Merge #desttable desttbl
            Using @thing1  srctbl
            On desttbl.instypeid = srctbl.instypeid
            When Not Matched Then
                Insert ( instext )
                Values ( instext )
            Output inserted.instypeid Into @newids
        ;

/*
        Wanted shape of the result set
        instypeid   instext
        0           zero
        1           one

*/ 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T21:15:04.607

但是您可以通过稍微修改当前代码来获得该结果集：

```
if object_id('tempdb.dbo.#desttable') is not null
    drop table #desttable 

create table #desttable ( instypeid smallint identity(0,1) primary key
, instext varchar(64) )
Go
declare @inserted table ( idvalue smallint, instext varchar(64) )
declare @thing1 instype

insert into @thing1 values ( -1 , 'zero' ), ( -1 , 'one' )

Merge #desttable desttbl
        Using @thing1  srctbl
        On desttbl.instypeid = srctbl.instypeid
        When Not Matched Then
            Insert ( instext )
            Values ( instext )
        Output inserted.instypeid, inserted.instext Into @inserted
    ;

SELECT  *
FROM    @inserted 
```

# sql - Identify duplicate Records Based On Different Status in oracle

> ID：11268747
> 
> 赞同：0
> 
> 时间：2012-06-29T20:47:52.467
> 
> 标签：sql, oracle, oracle10g

I have the data set as below:

```
EMP_NAME   MGRNAME    STATUS    MODIFIED_DATE 
---------------------------------------------------
Amy        John       ACTIVE    01/15/2012 00:00:00 
Amy        Ken        INSERVICE 06/08/2000 00:00:00 
Amy        Tom        INACTIVE  04/02/2010 00:00:00 
Ron        David      ACTIVE    01/15/2008 00:00:00 
Keith      Jack       INACTIVE  08/10/2005 00:00:00 
Keith      Cat        INACTIVE  04/30/2008 00:00:00 
Keith      Ken        INACTIVE  02/04/2010 00:00:00
Mary       Stephen    INACTIVE  10/18/2010 00:00:00 
```

Now, i should identify the duplicate rows based on the below conditions:

*   If an Emp has 1 Mgr tagged, then we should not consider the same. Ex:- Ron, Mary
*   If an Emp has been tagged to multiple Managers, then we need to check if he is tagged to any of the manager as `ACTIVE` , then we should not consider the same. Fetch those records whose status is `<> ACTIVE` for that Emp. Ex:- For Amy, we should exclude the record with `ACTIVE` status. We should fetch the records with `INSERVICE` and `INACTIVE`
*   If an Emp has been tagged to multiple Managers, but he is in INACTIVE status with all of them, then leave the max(`MODIFIED_DATE`) record and fetch the remaining records Ex:- For Keith, as both the Mgr records Status is INACTIVE, fetch the (`MODIFIED_DATE`) records which are `08/10/2005 00:00:00` and `04/30/2008 00:00:00`

The final output should look like below:

```
EMP_NAME   MGRNAME     STATUS      MODIFIED_DATE 
------------------------------------------------------
Amy        Ken         INSERVICE   06/08/2000 00:00:00 
Amy        Tom         INACTIVE    04/02/2010 00:00:00 
Keith      Jack        INACTIVE    08/10/2005 00:00:00 
Keith      Cat         INACTIVE    04/30/2008 00:00:00 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T06:06:25.570

尝试这个：

```
SELECT EMP_NAME ,  MGRNAME ,   STATUS  ,  MODIFIED_DATE
FROM (
SELECT your_table.*,
rank() over (partition BY EMP_NAME ORDER BY decode(STATUS,'ACTIVE', to_date('31129999', 'ddmmyyyy'), MODIFIED_DATE) DESC ) r FROM your_table
) t
WHERE r > 1 
```

[这](http://www.sqlfiddle.com/#!4/c106b/7)是一个小提琴

# batch-file - ！文件名！（字符串变量）此时批量出乎意料？

> ID：11268752
> 
> 赞同：1
> 
> 时间：2012-06-29T20:48:08.463
> 
> 标签：batch-file, for-loop, unexpectendoffile

我正在运行一个批处理文件：
1\. 遍历 C:\ExecutionSDKTest_10.2.2 中的所有 *.properties 文件
2\. 运行它们
3\. 逐行比较输出日志与 ref log
但是 cmd.exe 一直在抛出我此错误：“！fileName！此时出乎意料。有什么想法吗？

```
CALL ant clean build compile 
REM Run ENG-zzz.properties  --> output to ENG-zzz.properties.log in Logs dir
REM loop thru/Run ALL .properties file names from "ExecutionSDKTest_10.2.2" folder
FOR %%G in (C:\ExecutionSDKTest_10.2.2\*.properties) DO (
set flag=true
Set fileName=%%~nxG
set testNum=!fileName:~0,7!
echo Running:!fileName!
java -jar Test.jar !fileName! > Logs\!fileName!.log

ECHO Create: Ref!fileName!.log at C:\ExecutionSDKTest_10.2.2\Logs
set logPath=C:\ExecutionSDKTest_10.2.2\Logs\!fileName!.log
set refLogPath=C:\ExecutionSDKTest_10.2.2\Logs\!testNum!-Ref.properties.txt
set lnCorrect=true
set errorLnCount=0
REM if ...Ref.txt doesnt Exist --> check certain lines of the log

REM assume ref.txt exists
<!logPath! (
    For /F "tokens=*" %%R in (!refLogPath!) DO (
        set logLine=
            set /p logLine=
        set refLogLine=%%R

        REM Check line by line of log against refLog
        REM assume ALL times have been replaced with: "xx:xx:xx"

        REM if corresponding lines mismatch
        if NOT !logLine!==!refLogLine! Do (
            set lnCorrect=false
            REM output to command line: can be put into .log/.txt later
            if errorLnCount==1 AND lnCorrect==false DO (
          ECHO The following line(s)  !fileName! are incorrect against corresponding line(s) in !testNum!-Ref.properties.txt 
             )
             ECHO !logLine!
        )
        )
    )

if lnCorrect=true Do Echo !fileName! Passed
  )
Pause 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:56:58.650

你的语法有点奇怪（这是错误的）
`if lnCorrect=true Do Echo !fileName! Passed`

1.  该`IF`语句不能有`DO`子句。
2.  compare 需要两个等号。
3.  没有像`AND`,这样的逻辑运算符`OR`
4.  必须扩展变量以便能够比较它们

所以你的线应该看起来像
`if "!lnCorrect!"=="true" Echo !fileName! Passed`

另一个错误是在线的

```
if errorLnCount==1 AND lnCorrect==false DO ( 
```

这可以重构为

```
if !errorLnCount!==1 if !lnCorrect!==false ( 
```

线路也有问题

```
ECHO The following line(s)  !fileName! are incorrect against 
```

右括号将导致您的问题，因为它关闭了 if 子句和循环。
删除它们或逃脱它们

```
ECHO The following line(s^)  !fileName! are ... corresponding line(s^) in ... 
```

# video - FPS 中的 FFMPEG 开始和持续时间

> ID：11268756
> 
> 赞同：2
> 
> 时间：2012-06-29T20:48:28.467
> 
> 标签：video, ffmpeg, ffmpeg-php

是否可以在帧中设置 FFMPEG 中的 -ss 和 -t 标志？

我正在使用 FFMPEG 在 PHP 中构建一个简单的视频修剪器，并且一直在使用 PHP-FFMPEG 来提取屏幕抓取等，它完全在帧中工作。此外，我的脚本要求我在视频的开头和结尾添加和减去可变的时间，这在 FPS 中更容易做到。PHP-FFMPEG 告诉我视频的 fps，因此我可以根据需要准确地定位帧。

或者，是否有人知道用于将帧转换为 HH:MM:SS.xx 格式的漂亮小脚本？我可以用它来代替。到目前为止，我的谷歌尝试都没有结果，而且我的尝试让我感到相当压力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T00:50:07.903

您无需转换为 HH:MM:SS.xx 格式。

FFmpeg的`-t`and`-ss`标志接受秒数（包括十进制）以及 HH:MM:SS.xx 格式。从[文档](http://ffmpeg.org/ffmpeg.html#Main-options)：

> **`-ss position (input/output)`**
> 当用作输入选项（之前`-i`）时，在此输入文件中查找`position`. 当用作输出选项时（在输出文件名之前），解码但丢弃输入，直到时间戳达到`position`. 这更慢，但更准确。
> 
> ***位置*****可以是秒或 hh:mm:ss[.xxx] 形式。**

因此，只需每秒执行帧数/帧数，您就得到了输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-23T03:52:39.917

我不知道，`-ss`但您可以使用`-vframes`而不是`-t`指定确切的视频帧数。

# php - 强制下载损坏文件重写文件内容

> ID：11268760
> 
> 赞同：0
> 
> 时间：2012-06-29T20:48:46.603
> 
> 标签：php, html, header, download, mime-types

PHP强制下载的另一个问题。它正在工作，然后我做了一些事情，现在它没有。

我们开始（我接受的每种文件类型都有 if 语句，但仅显示一个就足以帮助诊断问题）：

```
$string1 = 'home/myhost/aboveroot/reviews/';
$string2 = $username;
$string3 = '/';
$string4 = $filename;
$file= $string1.$string2.$string3.$string4;
$ext = strtolower (end(explode('.', $filename)));
//Finding MIME type
    if ($ext = pdf){
        header("Content-disposition: attachment; filename= '$filename'");
        header('Content-type: application/pdf');
        readfile('$file'); 
```

最终发生的是，它强制使用正确的文件名和正确的扩展名下载文件。它不会触发任何类型的损坏文件错误。但是，当我打开文件时，内容丢失了。如果它是一个word文档，它将拒绝打开。如果它是一个文本文档，则**文本将更改为一堆 php 错误，如下所示：**

**警告**：readfile（$file）[function.readfile]：无法打开流：第**68**行的**/home/myhost/public_html/wwww.mydomain.com/pagethatforceddownload.php中没有这样的文件或目录**

 **然后它为带有标题的每一行给出这个错误（即使是那些包含在不应该满足其条件的 if 子句中：

**警告**：无法修改标头信息 - 标头已由 /home/myhost/public_html/wwww.mydomain.com/pagethatforceddownload 中的（输出开始于 /home/myhost/public_html/wwww.mydomain.com/pagethatforceddownload.php:68）发送**。第****69**行的**php**

 **我真的迷路了。任何帮助将不胜感激。我终于让我的网站上的所有东西都能正常工作，并且 BAM，我意识到我遇到了一个非常混乱的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T20:52:46.423

这一行是错误的：

```
if ($ext = pdf){ 
```

它应该是 ：

```
if ($ext == "pdf"){ 
```

你可以添加：

```
if($ext == "pdf" && file_exists($file)) { 
```

以确保您获得有效的文件。

这也是错误的：

```
readfile('$file'); 
```

它应该是 ：

```
readfile($file); 
```****

# java - 在 Java 中读取多级 XML 文件

> ID：11268762
> 
> 赞同：3
> 
> 时间：2012-06-29T20:49:03.640
> 
> 标签：java, xml

直到最近，我的 XML 文件的标签结构还是相当简单的。但是现在我多了一层带标签的标签，解析 XML 变得更加复杂。

这是我的新 XML 文件的示例（我更改了标签名称以使其更易于理解）：

```
<SchoolRoster>
   <Student>
      <name>John</name>
      <age>14</age>
      <course>
         <math>A</math>
         <english>B</english>
      </course>
      <course>
         <government>A+</government>
      </course>
   </Student>
   <Student>
      <name>Tom</name>
      <age>13</age>
      <course>
         <gym>A</gym>
         <geography>incomplete</geography>
      </course>
   </Student>
</SchoolRoster> 
```

上述 XML 的重要特性是我可以有多个“课程”属性，并且在其中我可以有任意命名的标签作为它们的子标签。并且可以有任意数量的这些孩子，我想将它们读入“名称”、“值”的 HashMap 中。

```
public static TreeMap getAllSchoolRosterInformation(String fileName) {
    TreeMap SchoolRoster = new TreeMap();

    try {
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        DocumentBuilder db = dbf.newDocumentBuilder();
        File file = new File(fileName);
        if (file.exists()) {
            Document doc = db.parse(file);
            Element docEle = doc.getDocumentElement();
            NodeList studentList = docEle.getElementsByTagName("Student");

            if (studentList != null && studentList.getLength() > 0) {
                for (int i = 0; i < studentList.getLength(); i++) {

                    Student aStudent = new Student();
                    Node node = studentList.item(i);

                    if (node.getNodeType() == Node.ELEMENT_NODE) {
                        Element e = (Element) node;
                        NodeList nodeList = e.getElementsByTagName("name");
                        aStudent.setName(nodeList.item(0).getChildNodes().item(0).getNodeValue());

                        nodeList = e.getElementsByTagName("age");
                        aStudent.setAge(Integer.parseInt(nodeList.item(0).getChildNodes().item(0).getNodeValue()));

                        nodeList = e.getElementsByTagName("course");
                        if (nodeList != null && nodeList.getLength() > 0) {
                            Course[] courses = new Course[nodeList.getLength()];
                            for (int j = 0; j < nodeList.getLength(); j++) {

                                Course singleCourse = new Course();
                                HashMap classGrades = new HashMap();
                                NodeList CourseNodeList = nodeList.item(j).getChildNodes();

                                for (int k = 0; k < CourseNodeList.getLength(); k++) {
                                    if (CourseNodeList.item(k).getNodeType() == Node.ELEMENT_NODE && CourseNodeList != null) {
                                        classGrades.put(CourseNodeList.item(k).getNodeName(), CourseNodeList.item(k).getNodeValue());
                                    }
                                }
                                singleCourse.setRewards(classGrades);
                                Courses[j] = singleCourse;
                            }
                            aStudent.setCourses(Courses);
                        }
                    }
                    SchoolRoster.put(aStudent.getName(), aStudent);
                }
            }
        } else {
            System.exit(1);
        }
    } catch (Exception e) {
        System.out.println(e);
    }
    return SchoolRoster;
} 
```

我遇到的问题是，学生没有在“数学”中得到“A”，而是在“数学”中得到了一个空值。（如果这篇文章太长，我可以尝试找到一些缩短它的方法。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T20:58:09.220

如果这是我的项目，我会避免尝试手动剖析 HTML 中的数据，而是让 Java 使用 JAXB 为我做这件事。我使用这个工具的次数越多，我就越喜欢它。我强烈建议您考虑尝试一下，因为如果您这样做了，那么将 XML 更改为 Java 对象所需要做的就是在您的 Java 类中进行适当的注释，然后解组 XML。使用的代码会更简单，因此出错的可能性也会大大降低。

例如，下面的代码非常容易和干净地将信息编组到 XML 中：

```
import java.util.ArrayList;
import java.util.List;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Marshaller;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

@XmlRootElement
public class SchoolRoster {
   @XmlElement(name = "student")
   private List<Student> students = new ArrayList<Student>();

   public SchoolRoster() {
   }

   public List<Student> getStudents() {
      return students;
   }

   public void addStudent(Student student) {
      students.add(student);
   }

   public static void main(String[] args) {
      Student john = new Student("John", 14);
      john.addCourse(new Course("math", "A"));
      john.addCourse(new Course("english", "B"));

      Student tom = new Student("Tom", 13);
      tom.addCourse(new Course("gym", "A"));
      tom.addCourse(new Course("geography", "incomplete"));

      SchoolRoster roster = new SchoolRoster();
      roster.addStudent(tom);
      roster.addStudent(john);

      try {
         JAXBContext context = JAXBContext.newInstance(SchoolRoster.class);
         Marshaller marshaller = context.createMarshaller();
         marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

         String pathname = "MySchoolRoster.xml";
         File rosterFile = new File(pathname );
         marshaller.marshal(roster, rosterFile);
         marshaller.marshal(roster, System.out);

      } catch (JAXBException e) {
         e.printStackTrace();
      }
   }
}

@XmlRootElement
@XmlType(propOrder = { "name", "age", "courses" })
class Student {
  // TODO: completion left as an exercise for the original poster
}

@XmlRootElement
@XmlType(propOrder = { "name", "grade" })
class Course {
  // TODO: completion left as an exercise for the original poster
} 
```

这导致了以下 XML：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<schoolRoster>
    <student>
        <name>Tom</name>
        <age>13</age>
        <courses>
            <course>
                <name>gym</name>
                <grade>A</grade>
            </course>
            <course>
                <name>geography</name>
                <grade>incomplete</grade>
            </course>
        </courses>
    </student>
    <student>
        <name>John</name>
        <age>14</age>
        <courses>
            <course>
                <name>math</name>
                <grade>A</grade>
            </course>
            <course>
                <name>english</name>
                <grade>B</grade>
            </course>
        </courses>
    </student>
</schoolRoster> 
```

将其解组为一个充满数据的 SchoolRoster 类只需要几行代码。

```
private static void unmarshallTest() {
  try {
     JAXBContext context = JAXBContext.newInstance(SchoolRoster.class);
     Unmarshaller unmarshaller = context.createUnmarshaller();

     String pathname = "MySchoolRoster.xml"; // whatever the file name should be
     File rosterFile = new File(pathname );
     SchoolRoster roster = (SchoolRoster) unmarshaller.unmarshal(rosterFile);
     System.out.println(roster);
  } catch (JAXBException e) {
     e.printStackTrace();
  }
} 
```

在我的类中添加`toString()`方法后，结果如下：

```
SchoolRoster 
  [students=
    [Student [name=Tom, age=13, courses=[Course [name=gym, grade=A], Course [name=geography, grade=incomplete]]], 
    Student [name=John, age=14, courses=[Course [name=math, grade=A], Course [name=english, grade=B]]]]] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T21:26:35.653

```
for (int k = 0; k < CourseNodeList.getLength(); k++) {
    if (CourseNodeList.item(k).getNodeType() == Node.ELEMENT_NODE && CourseNodeList != null) {
        classGrades.put(CourseNodeList.item(k).getNodeName(),
        CourseNodeList.item(k).getNodeValue());
    }
} 
```

You're calling `getNodeValue()` on an `Element`. According to the JDK API docs, that returns null.

[http://docs.oracle.com/javase/6/docs/api/org/w3c/dom/Node.html](http://docs.oracle.com/javase/6/docs/api/org/w3c/dom/Node.html)

You need to get the child Text node and call `getNodeValue()` on that. Here's a really quick and dirty way to do so:

```
classGrades.put(CourseNodeList.item(k).getNodeName(),
        CourseNodeList.item(k).getChildNodes().item(0).getNodeValue()); 
```

Please don't use this in production code. It's ugly. But it'll point you in the right direction.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T21:40:18.457

像@Hovercraft 一样，我建议使用库来处理对 xml 的序列化。我发现 Xstream 具有出色的性能且易于使用。 [http://x-stream.github.io/](http://x-stream.github.io/)

例如：

```
public static void saveStudentsXML(FileOutputStream file) throws Exception {
    if (xstream == null)
        initXstream();

    xstream.toXML(proctorDAO.studentList, file);
    file.close(); 
 }

 public static void initXstream() {
    xstream = new XStream();
    xstream.alias("student", Student.class);

    xstream.useAttributeFor(Student.class, "lastName");
    xstream.useAttributeFor(Student.class, "firstName");
    xstream.useAttributeFor(Student.class, "id");
    xstream.useAttributeFor(Student.class, "gradYear");
    xstream.aliasAttribute(Student.class, "lastName", "last");
    xstream.aliasAttribute(Student.class, "gradYear", "gc");
    xstream.aliasAttribute(Student.class, "firstName", "first");
} 
```

用于演示嵌套属性的示例 XML：

```
<list>
  <student first="Ralf" last="Adams" gc="2014" id="100">
     <testingMods value="1" boolMod="2"/>
  </student>
  <student first="Mick" last="Agosti" gc="2014" id="102">
     <testingMods value="1" boolMod="2"/>
  </student>
  <student first="Edmund" last="Baggio" gc="2013" id="302">
     <testingMods value="1" boolMod="6"/>
  </student> 
</list> 
```

# python - 模型中的 Django 相关名称

> ID：11268763
> 
> 赞同：0
> 
> 时间：2012-06-29T20:49:06.477
> 
> 标签：python, django, models

关于在 models.py 中正确配置`related_name`以创建类别和子类别结构的任何建议？运行时出错`syncdb`：

`myapp.category: Accessor for field 'parent' clashes with related field 'Category.children'. Add a related_name argument to the definition for 'parent'. myapp.category: Reverse query name for field 'parent' clashes with related field 'Category.children'. Add a related_name argument to the definition for 'parent'. myapp.subcategory: Accessor for field 'parent' clashes with related field 'Category.children'. Add a related_name argument to the definition for 'parent'. myapp.subcategory: Reverse query name for field 'parent' clashes with related field 'Category.children'. Add a related_name argument to the definition for 'parent'.`

我正在尝试制作类别/子类别结构。例如，父类别是汽水公司（可口可乐、百事可乐等），子类别是汽水的类型（可乐、苏打水等）。子类别可以与不同的父类别相关联，反之亦然。

以下是我在弄清楚（使用[django-mptt](https://github.com/django-mptt/django-mptt/)）时遇到问题的模型：

```
class Category(MPTTModel):
   site = models.ForeignKey(Site)
   template_prefix = models.CharField(max_length=200, blank=True)
   name = models.CharField(max_length=200)
   parent = TreeForeignKey('self', null=True, blank=True, related_name='children')

       def __unicode__(self):
       return self.name + u' Category'

class SubCategory(MPTTModel):
   name = models.CharField(max_length=50, unique=True)
   parent = TreeForeignKey('Category', null=True, blank=True, related_name='children')

   def __unicode__(self):
       return self.name + u' SubCategory' 
```

非常感谢任何建议。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:08:07.377

您不能同时调用 Category 上的递归关系和从 SubCategory 到 Category “children”的 FK。为其中一个选择不同的名称。

不过，我必须说，这似乎根本不适合 MPTT。公司不会陷入树状关系，因为它们可能都处于同一水平，苏打水类型也不会：例如，“可乐”成为“苏打水”的孩子意味着什么？听起来您想要从 Company 到 SodaType 的简单多对多关系，以便每个公司可以有多种苏打水类型，并且每种类型都可以由几家公司生产。

# linux - 在系统调用中停止时如何获得正确的 orig_eax 值？

> ID：11268765
> 
> 赞同：3
> 
> 时间：2012-06-29T20:49:22.957
> 
> 标签：linux, debugging, system-calls, ptrace

我正在使用 ptrace(PTRACE_ATTACH...) 附加到一个进程，而它处于系统调用中（如 nanosleep()）。我可以使用 PTRACE_GETREGS 来获取寄存器内容，并且 eip 位于预期位置（在 __kernel_vsyscall 中）。但是，eax 和 orig_eax 寄存器有意外的内容：eax 通常包含 -516，而 orig_eax 通常为 0。

这是我使用的测试程序（取自[http://www.linuxjournal.com/article/6210](http://www.linuxjournal.com/article/6210)并稍作修改）：

```
 #include <stdlib.h>
    #include <stdio.h>
    #include <sys/ptrace.h>
    #include <sys/types.h>
    #include <sys/wait.h>
    #include <unistd.h>
    #include <sys/user.h>

    int main(int argc, char *argv[])
    {
        pid_t traced_process;
        struct user_regs_struct regs;
        long ins;
        if(argc != 2) {
            printf("Usage: %s <pid to be traced>\n",
                   argv[0]);
            exit(1);
        }
        traced_process = atoi(argv[1]);
        ptrace(PTRACE_ATTACH, traced_process,
               NULL, NULL);
        wait(NULL);
        ptrace(PTRACE_GETREGS, traced_process,
               NULL, &regs);
        printf("eax: %lx (%d); orig_eax: %lx\n",
               regs.eax, (int)regs.eax, regs.orig_eax);
        ins = ptrace(PTRACE_PEEKTEXT, traced_process,
                     regs.eip, NULL);
        printf("EIP: %lx Instruction executed: %lx\n",
               regs.eip, ins);
        ptrace(PTRACE_DETACH, traced_process,
               NULL, NULL);
        return 0;
    } 
```

附加到在另一个终端中运行的“sleep 10000”命令时的输出：

```
 eax: fffffdfc (-516); orig_eax: 0
    EIP: b7711424 Instruction executed: c3595a5d 
```

eax中的值是什么意思？为什么 orig_eax 不包含原始系统调用号（如 162）？在这种情况下，我如何实际获取系统调用号？

另外，为什么 gdb 正确显示“print $orig_eax”的“162”？

顺便提一句。这是在 Ubuntu 12.04 上，内核为 3.2.0：

*   uname -a：“Linux edgebox 3.2.0-24-generic-pae #37-Ubuntu SMP Wed Apr 25 10:47:59 UTC 2012 i686 athlon i386 GNU/Linux”
*   /proc/cpuinfo：“AMD Athlon(tm) II Neo K345 双核处理器”
*   文件`which sleep`：“/bin/sleep：ELF 32 位 LSB 可执行文件，Intel 80386，版本 1 (SYSV)，动态链接（使用共享库），适用于 GNU/Linux 2.6.24，BuildID[sha1]=0x0965431bde4d183eaa2fa3e3989098ce46b92129，已剥离”。

所以它是一个 32 位 PAE 内核和 64 位 CPU 上的 32 位 Ubuntu 安装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-01T16:16:43.830

当您附加到进程时，会向进程发送一个信号，该信号会中断正在进行的任何系统调用。如果发生这种情况，大多数系统调用只会返回 -EINTR，并期望用户空间代码在需要时重新启动它们。还有其他系统调用可以自动重新启动，但这是一个更大的话题。

在某些系统调用的情况下，其中 nanosleep() 是其中之一，进程已经休眠了指定时间的一部分，因此您不想从头开始重新启动，而是只想休眠剩余的时间。为此，每个线程在内核空间中都有一个“重启块”。当系统调用被中断时，它会填充重启块，并返回 -516 (ERESTART_RESTARTBLOCK)。内核特别对待这个返回码：它将 pc 倒回到系统调用之前，并将系统调用号更改为“restart_syscall”（在您的体系结构上为 0）。当进程重新启动时，它显然会调用 restart_syscall ，它使用重新启动块来确定要做什么。

这种重新启动通常对用户来说是不可见的，但 ptrace 是发现它的一种方法。但是我不知道 GDB 设法为 orig_eax 获得正确的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:30:50.480

> 这是在 Ubuntu 12.04 上，内核为 3.2.0

这不能唯一标识您的系统。什么处理器？

我的水晶球告诉我`sleep`你正在调用的是一个 64 位程序，而你的跟踪程序不是。或相反亦然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-04T02:15:45.440

当休眠进程被 ptrace(PTRACE_ATTACH) 停止时，tracer 进程可以获取 registers(user_regs_struct) 信息。系统调用号为 162，即**sys_nanosleep**， eax=-516 表示本次中断系统调用的返回值。

# ruby-on-rails - 耙中止！找不到文件 twitter/bootstrap

> ID：11268771
> 
> 赞同：0
> 
> 时间：2012-06-29T20:50:37.400
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap

我正在关注有关 ROR 3.2 的 Hartl 教程，我构建了一个在本地运行良好的简单应用程序，但是当我尝试将其部署到 heroku wit $git push heroku master 时，rake assets:precompile 失败，因为“找不到文件 twitter /引导”。（application.js 引发的错误）我已经用谷歌搜索了这个问题，但这些答案都不适合我： [Heroku deploy 在通过 twitter-bootstrap-rails gem 升级到 bootstrap 2.0.1 后失败](https://stackoverflow.com/questions/9423067/heroku-deploy-fails-after-upgrading-to-bootstrap-2-0-1-via-twitter-bootstrap-rai)

[在生产中找不到文件“twitter/bootstrap”](https://stackoverflow.com/questions/9047478/rails-app-with-twitter-bootstrap-works-in-development-but-not-in-production)

谁能帮我找出问题所在？如果我必须附加一些文件，或者如果您需要其他信息，请告诉我。谢谢

这里是 Gemfile

```
gem 'rails', '3.2.6'

group :development do
gem 'sqlite3'
gem 'annotate', '~> 2.4.1.beta'
end

group :production do
  gem 'pg'
end

group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'twitter-bootstrap-rails', '~> 2.0.1.0'
  gem 'bootstrap-sass', '~> 2.0.3'
  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'
gem 'bcrypt-ruby', '3.0.1' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T08:40:20.147

我有一个类似的问题，通过将引导相关的 gem 移出 gemfile 中的资产组来解决。将它粘贴在常规的宝石列表旁边，它应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:17:58.057

您是否添加了：

```
# Allow compilation of assests on Heroku
config.assets.initialize_on_precompile = false 
```

到您的 config/application.rb 文件？这是我解决 Heroku 问题的最后一步。

此外，尽管我在网上阅读过这些内容，但您应该可以将 gem 留`'bootstrap-sass', '~> 2.0.3'`在您的街区中。`group assets do`

听起来像是您的 gem 文件中的一个问题，这是一个在 Heroku 上运行良好的示例：

```
source 'https://rubygems.org'

group :development, :test do
  gem 'rspec-rails', '2.9.0'
  gem 'guard-rspec', '0.5.5'
end

group :test do
  gem 'capybara', '1.1.2'
end

group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'

  gem 'bootstrap-sass', '~> 2.0.3'
end

gem 'rails', '3.2.2'
gem 'pg', '0.13.2'
gem 'jquery-rails', '2.0.2'
gem 'simple_form', '2.0.1' 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-24T07:15:28.150

我通过使用以下步骤解决了这个问题：

1.  从 gemfile 中的 :assets 外部移动**twitter-bootstrap-rails gem**
2.  更新**twitter-bootstrap-rails** gem 版本**2.2.6**或直接粘贴到您的 gemfile 中。 **gem 'twitter-bootstrap-rails', :git => 'git://github.com/seyhunak/twitter-bootstrap-rails.git'**

如果 twitter-bootstrap-rails 2.2.6 不起作用，则使用 twitter-bootstrap-rails gem 最新版本。

# verilog - 使用 CPLD 闪烁 LED

> ID：11268772
> 
> 赞同：1
> 
> 时间：2012-06-29T20:50:49.683
> 
> 标签：verilog, led

所以我是`Verilog`CPLD的新手。我写了一些打开 LED 的代码，现在我想让它闪烁。

```
module LEDON(LED);    

    output LED;

    reg LED;

    always 
    begin
        LED=1'b1;
    end
 endmodule 
```

那么如何添加一个延迟来让我看到 LED 亮起和熄灭呢？我读过我必须使用触发器降低时钟速度，但我不太确定这意味着什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T20:57:26.593

您不必降低时钟频率。您要做的是制作一个计数器，在这么多时钟周期后切换 LED。

如果你有一个 1MHz 的时钟，并且你想每秒切换一次 LED，那么做这样的事情

```
reg [31:0] count;
reg        led_state;
wire count_max = 32'd1_000_000;

assign count_nxt = (count >= count_max) ? 32'd0 : count + 32'd1;
assign led_state_nxt = (count == count_max) ? ~led_state : led_state;

always @(posedge clk)
begin
    count <= count_nxt;
    led_state <= led_state_nxt;
end 
```

基本上这只是一个自由运行的计数器，每次达到某个值时，它都会切换 led_state 并自行重置。

您必须根据所需的闪烁率和时钟频率调整 count_max 的值。

# mysql - MySQL对最后一个进行排序和分组

> ID：11268774
> 
> 赞同：1
> 
> 时间：2012-06-29T20:51:14.243
> 
> 标签：mysql, sql, group-by, sql-order-by

您好，我的 MYSQL 查询需要帮助

我有桌子

```
id | tn   | title    | customer_id |create_time | comment              |
1  | 1342 | sample1  | customer1   | 2012-01-01 | hello world          |
2  | 1342 | sample1  | customer1   | 2012-01-02 | hello world          |
3  | 1342 | sample1  | customer1   | 2012-01-03 | hello new world      |
4  | 3362 | sample2  | customer1   | 2012-01-02 | good bye world       |
5  | 3362 | sample2  | customer1   | 2012-01-03 | good bye world       |
6  | 3362 | sample2  | customer1   | 2012-01-04 | good bye world       |
7  | 3362 | sample2  | customer1   | 2012-01-05 | good bye new world   | 
```

当我**按 tn 分组**时，我采取了

```
1  | 1342 | sample1  | customer1   | 2012-01-01 | hello world          |
4  | 3362 | sample2  | customer1   | 2012-01-02 | good bye world       | 
```

但我需要采取

```
3  | 1342 | sample1  | customer1   | 2012-01-03 | hello new world      |
7  | 3362 | sample2  | customer1   | 2012-01-05 | good bye new world   | 
```

这就像按 tn 分组，具有最大 id 或最大 create_time

我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:10:41.320

尝试这个：

```
mysql> select * from ( select * from tbl2 tn order by id desc ) t group by tn;
+------+------+---------+-------------+-------------+--------------------+
| id   | tn   | title   | customer_id | create_time | comment            |
+------+------+---------+-------------+-------------+--------------------+
|    3 | 1342 | sample1 | customer1   | 2012-01-03  | hello new world    |
|    7 | 3362 | sample2 | customer1   | 2012-01-05  | good bye new world |
+------+------+---------+-------------+-------------+--------------------+
2 rows in set (0.02 sec) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:07:31.723

```
SELECT t2.* FROM
(SELECT MAX(id) AS id,tn FROM my_table GROUP BY tn) AS t1
LEFT JOIN my_table AS t2 USING(id) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T21:09:36.090

尝试这个

```
Select t.* from 
table t right join
(Select max(id) as max_id from table group by tn) t1 on (t.id=t1.max_id) 
```

# javascript - 如果我不关心安全性，有没有办法通过客户端编程（特别是 JS）进行文件 IO？

> ID：11268778
> 
> 赞同：2
> 
> 时间：2012-06-29T20:51:43.310
> 
> 标签：javascript, file-io

我意识到这是一个**巨大**的**安全**风险，但我有我的理由。我不是在问这是否是一个好主意，只是它是否可能。不一定需要是 JS，但它确实需要基于浏览器和客户端。

规格：

1.  客户端必须能够创建和写入服务器端文件。
2.  跨浏览器/平台解决方案是首选，但特定于一种环境的解决方案也很好。
3.  最好该解决方案不需要超出浏览器默认状态的任何内容，但如果它需要一些插件才能工作，那就这样吧。

@Cheeso，绝对不是病毒。在这一点上，这比任何事情都更具理论性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T20:56:54.500

你会说 HTML5 吗？你能强迫你的用户使用谷歌浏览器吗？您可以使用文件系统 API：[在这里您可以找到开始读/写文件所需的内容](http://www.html5rocks.com/en/tutorials/file/filesystem/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:18:00.647

您刚刚在您的描述中添加了“读取和写入**服务器**端文件”......这是一个非常不同的问题。

如果您想读/写*客户端*文件，并且不能像普通网站那样只上传/下载文件，您应该考虑使用签名的 Java 小程序（有关详细信息，请参阅[此网站](http://www.coderanch.com/how-to/java/HowCanAnAppletReadFilesOnTheLocalFileSystem)）-IIRC Facebook 使用了这样早期的小程序，因此用户可以一次上传多张照片。不过，Java 小程序似乎正在走渡渡鸟的道路，所以 YMMV。

但是，如果您想读/写*服务器*端文件，那么几乎任何服务器都可以做到这一点，而无需任何浏览器端的诡计。Google 是您的朋友，即查找“PHP 写入文件”。

# android - Android 设备偶尔会重启

> ID：11268784
> 
> 赞同：6
> 
> 时间：2012-06-29T20:52:14.667
> 
> 标签：android, debugging

我们正在实际设备上测试我们的 Android 应用程序，并注意到其中一些应用程序在运行 2-3 小时后偶尔会重新启动。该应用程序由一个具有 3 个线程（带有 GPS 和网络）的服务和两个活动组成，其中一个是资源消耗的（显示地图）

Logcat 没有帮助，因为在设备重新启动之前我们没有看到任何重要消息。有时设备甚至无法启动，只有取出电池有助于重新启动它。

这些设备基于不同的硬件，在不同的国家（主要是中国，呵呵）生产并使用不同的 Android 版本。

可能导致设备重启的最常见问题是什么？如何调试它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T21:57:52.060

Android有两种重启方式：

1.  系统服务器故障。在这种情况下，不会发生重新启动，而是`Zygote`重新启动。常见原因：

    *   看门狗杀死了一个 system_server 进程，因为它正在运行的服务出现死锁。
    *   系统服务之一发生致命异常。但是，实际原因有时可能是硬件问题。例如，在某些情况下，恢复出厂设置后`ext2`分区的格式不如下。它会导致错误，并且`/data/`分区被安装为只读，这会产生一堆错误。
    *   在极少数情况下，看门狗可能会因为高内存和 CPU 使用率而超时。

    两者都非常罕见，主要可以在猴子测试中重现，而不是真实案例。您可以通过`service_manager`使用`adb shell`.

2.  内核恐慌。在这种情况下，设备实际上会重新启动。由于内核恐慌发生在 Android 之外的层上，它不会产生任何 logcat 输出。相反，它会将堆栈跟踪写入控制台。`/dev/kmsg`您可以从 ADB shell 或从 ADB shell中读取它： `adb shell dmesg`.

    `kmsg`不幸的是，在大多数设备上控制台输出被禁用并且缓冲区将在每次重新启动时被擦除，因此很难阅读这些内容。

PS 另外重启可能是硬件问题引起的。在这种情况下，它不太可能找到任何痕迹，但希望这应该只在特定设备上重现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:27:35.023

我有一个类似的问题（还有gps 和网络）我忘记将网络更新计时器设置为生产（15 分钟），所以设备每 15 秒更新一次使用（分析）或确保适当的冷却机制

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T04:52:14.840

当 GPS 接收器打开时，很可能是过热问题。关闭 GPS 并从手机网络获取位置后，该应用程序可以平稳运行数小时。

感谢大家的回复和想法！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T20:55:48.150

根据您提供的信息，听起来您很可能泄露了一个`Thread`. 您可以使用 DDMS 分析应用程序执行过程中的[线程使用](http://developer.android.com/tools/debugging/ddms.html#thread)情况。另一种可能性是您只是内存不足......您也可以使用 DDMS 来帮助您解决这个问题。

# java - server.sh 给了我以下错误异常“main” java.lang.NoClassDefFoundError：

> ID：11268785
> 
> 赞同：0
> 
> 时间：2012-06-29T20:52:17.130
> 
> 标签：java, exception

我正在尝试从终端启动“程序 D”，
终端“sh server.sh”中的命令给了我以下错误

```
Starting Alicebot Program D. Exception in thread "main"
java.lang.NoClassDefFoundError: org/alicebot/server/net/AliceServer
Caused by: java.lang.ClassNotFoundException:
org.alicebot.server.net.AliceServer     at
java.net.URLClassLoader$1.run(URLClassLoader.java:202)  at
java.security.AccessController.doPrivileged(Native Method)  at
java.net.URLClassLoader.findClass(URLClassLoader.java:190)  at
java.lang.ClassLoader.loadClass(ClassLoader.java:306)   at
sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)   at
java.lang.ClassLoader.loadClass(ClassLoader.java:247) 
```

我的 Server.sh 文件

```
ALICE_HOME=.SERVLET_LIB=lib/servlet.jar
ALICE_LIB=lib/aliceserver.jar
JS_LIB=lib/js.jar

# Set SQL_LIB to the location of your database driver.
SQL_LIB=lib/mysql_comp.jar

# These are for Jetty; you will want to change these if you are using a different http         server.
    HTTP_SERVER_LIBS=lib/org.mortbay.jetty.jar:lib/javax.xml.jaxp.jar:lib/org.apache.crimson.jar

PROGRAMD_CLASSPATH=$SERVLET_LIB:$ALICE_LIB:$JS_LIB:$SQL_LIB:$HTTP_SERVER_LIBS
java -classpath $PROGRAMD_CLASSPATH -Xms64m -Xmx64m org.alicebot.server.net.AliceServer $1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:12:44.937

这可能是问题吗？

```
ALICE_HOME=.SERVLET_LIB=lib/servlet.jar 
```

我发现[另一个问题](https://stackoverflow.com/questions/3527447/how-would-i-run-an-sh-file-using-nstask-and-get-its-output)使用类似的`server.sh`地方，这是在两行：

```
ALICE_HOME=.
SERVLET_LIB=lib/servlet.jar 
```

在您的情况下`SERVLET_LIB`，没有正确设置（或根本没有设置），并且嵌入的等号`PROGRAMD_CLASSPATH`稍后可能会中断。

# asp.net-mvc - 条件模型绑定

> ID：11268788
> 
> 赞同：2
> 
> 时间：2012-06-29T20:52:39.313
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model-view-controller

我有一组复选框，这些复选框是根据数据库中的信息动态创建的。如果选中任何复选框，则会打开一个相应的 div，其中包含可以填写的文本框。然后，我需要仅记录具有选中相应复选框的文本框的信息。我将如何仅绑定已选中父复选框的信息？顺便说一句：所有信息都是一个更大的复杂对象的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T20:55:55.720

像这样有条件的绑定是不可行的。而是这样做：

创建一组不同的属性或为每个部分创建一个对象，然后在将表单发布到服务器时检查复选框的值并从适当的字段中提取必要的数据，而忽略其他字段。

例如，假设您有两个部分，一个带有“名称”字段，另一个带有“地址”字段。检查Name复选框是否被勾选，如果是，则获取“Name”的值，否则忽略它。

# ruby - 我在哪里可以阅读 Ruby 的 File.open 函数？

> ID：11268790
> 
> 赞同：3
> 
> 时间：2012-06-29T20:52:42.523
> 
> 标签：ruby

我正在经历“Learn Ruby the Hard Way”，我无法让我的 Windows 命令提示符显示以下文档：ri File.open

它只是给了我一个错误：

ArgumentError：参数数量错误（0 表示 1..3）

我目前正在练习 16：[http ://ruby.learncodethehardway.org/book/ex16.html](http://ruby.learncodethehardway.org/book/ex16.html)

额外的功劳说：如果你用'w'模式打开文件，那么你真的需要target.truncate()吗？**去阅读 Ruby 的 File.open 函数的文档，看看这是不是真的。**

我在哪里可以看到 File.open 函数的文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T22:08:38.423

阅读,的父类[的文档。`IO`](http://ruby-doc.org/core/IO.html)`File`它描述了您在问题中提到的文件打开模式。以下是`w`打开模式的说明：

```
"w"  Write-only, truncates existing file
     to zero length or creates a new file for writing. 
```

`target.truncate`所以不，如果你以模式打开文件，你真的不需要打电话`w`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T20:55:51.653

[http://ruby-doc.org/core-1.9.3/File.html#method-c-open](http://ruby-doc.org/core-1.9.3/File.html#method-c-open)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T20:59:31.823

使用 ruby​​-doc.org 网站怎么样？

# ruby-on-rails - Rails 供应商文件夹

> ID：11268796
> 
> 赞同：4
> 
> 时间：2012-06-29T20:53:11.997
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gem, zurb-foundation

我正在使用[zurb-foundation](https://github.com/zurb/foundation-rails) gem，但它使用的是foundation 2，而foundation 3 今天出来了。查看 gem 存储库，有一个名为 vendor/assets 的文件夹，其中包含所有资产（javascripts/css/images）。如果我下载新的基础资产并将它们放在我的 Rails 应用程序的 vendor/assets 文件夹中，它会覆盖 gem 资产吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T21:20:05.947

您添加到 assets 文件夹的任何资产都将优先于从 gem 添加的任何资产 - 这将使用 vendor 文件夹。

因此，在您的情况下，将您的文件添加到资产文件夹 - 而不是供应商文件夹。

请注意，您将需要维护该代码，因此虽然在短期内这会起作用，但从长远来看，您可能希望自己更新 zurb-foundation gem，然后发出拉取请求。

# python - Python在网页上查找文件下载链接

> ID：11268805
> 
> 赞同：4
> 
> 时间：2012-06-29T20:54:27.923
> 
> 标签：python, regex, web-scraping, beautifulsoup, urllib2

我需要一个正则表达式，它将返回给我包含在双引号之间的文本，该双引号以指定的文本块开头，并以特定的文件扩展名（比如 .txt）结束。我正在使用 urllib2 来获取页面的 html（html 非常简单）。

基本上如果我有类似的东西

```
<tr>
  <td valign="top"><img src="/icons/unknown.gif" alt="[   ]"></td>
  <td><a href="Client-8.txt">new_Client-8.txt</a></td>
  <td align="right">27-Jun-2012 18:02  </td>
</tr> 
```

它应该回到我身边

```
Client-8.txt 
```

返回值包含在双引号中的位置。我知道文件名如何以“Client-”开头，文件扩展名为“.txt”。

我正在玩 r.search(regex, string) 我输入的字符串是页面的 html。但我讨厌正则表达式。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T20:56:27.480

您不应为此任务使用正则表达式。[使用BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)编写脚本来处理 HTML 并找到所需的元素要容易得多。

在您的情况下，您应该搜索其属性以 . 开头和结尾的所有`<a>`元素。这将为您提供所有文件的列表。`href``Client-``.txt`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:05:06.760

```
soup = BeautifulSoup('<tr><td valign="top"><img src="/icons/unknown.gif" alt="[   ]"></td><td><a href="Client-8.txt">new_Client-8.txt</a></td><td align="right">27-Jun-2012 18:02  </td>')
x=soup.findAll('a')
for i in x:
    if '.txt' in i['href']:
        print(i['href']) 
```

# google-app-engine - 如何测试是否在 App Engine SDK 1.7.0 (Java) 中删除了 blob？

> ID：11268806
> 
> 赞同：1
> 
> 时间：2012-06-29T20:54:34.333
> 
> 标签：google-app-engine, blob

将 App Engine SDK 更新到 1.7.0 后，我们的一些单元测试开始失败。

在 SDK 1.6.x 中，我断言删除了一个 blob，如下所示：

```
 try {
        fileService.getBlobFile(blobKey);
        Assert.fail("Blob not deleted: " + blobKey);
    } catch (FileNotFoundException expected) {
        // OK
    } 
```

在 SDK 1.7.0 getBlobFile() 不再抛出 FileNotFoundException。

我试图引发异常，但没有成功（没有抛出异常）：

```
 try {
        AppEngineFile blobFile = fileService.getBlobFile(blobKey);
        boolean readable = blobFile.isReadable();
        FileReadChannel channel = fileService.openReadChannel(blobFile, false);
        channel.position(1);
        try {
            channel.close();
        } catch (Exception e) {
            // Silent
        }
        Assert.fail("Blob not deleted: " + blobKey);
    } catch (Exception expected) {
        // OK
    } 
```

该 blob 应该被删除，但可以为它打开一个通道......

那么，有什么想法可以在单元测试中检查删除是否成功？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T23:02:44.880

尝试使用 blobstoreService.fetchData 检索文件的第一个字节。

如果文件不存在，它将抛出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T04:20:38.707

App Engine 尚不支持 JDK 1.7。

# php - PHP/MYSQL 数组里面有一组函数？

> ID：11268811
> 
> 赞同：0
> 
> 时间：2012-06-29T20:54:46.427
> 
> 标签：php, mysql, artificial-intelligence, procedural

我目前正在做一种战斗小游戏系统，其中对手由基于条件的人工智能系统控制。这个系统应该是相当“可编写脚本的”，任何在网站上工作的人都可以使用非常简单的函数创建一个新的对手。

我正在研究一组函数，其中许多函数需要数据库中的信息才能运行。但是，函数的范围以及它不是基于 OOP 的事实意味着它无法轻松访问脚本中早先已经进行的查询。

鉴于这都是程序性的，在每个函数中运行查询是唯一有效的方法吗？

更具体地说，我有一个简单的查询：

```
$arrayBattle = mysql_fetch_array( mysql_query ( 
                                 "SELECT * FROM `new_battles` WHERE 
                                 `id` = '$battle' AND `battle_status` = '0' 
                                  AND `user_id` = '".$ui['id']."'" ) ); 
```

你的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:29:13.993

由于这是一个如此简单的应用程序，我继续将查询结果存储在 $GLOBALS 变量中，以保持简单。

# php - 将php表单输出存储到变量

> ID：11268813
> 
> 赞同：0
> 
> 时间：2012-06-29T20:54:53.433
> 
> 标签：php, forms, heredoc, html2pdf, ob-get-contents

我已经成功编写了一个动态表单，表单输出和数据发布到 mysql。我现在想做的是将我的 php 的输出保存到一个变量中，然后我可以将其传递给 html2pdf 以生成 pdf。我试图在下面概述我当前的文件以及我想要的内容。

我有的：

```
if submitted do this {
   post data stored to variables
   dynamic form output including:
       field validation
       form data displayed in multiple tables
       multiple foreach loops of dynamic data with html tables and php variables within table cells.
   }
else do this {
   display form and collect user input
    submit buttons
   } 
```

我想要什么

```
if submitted do this {
   post data stored to variables

   $var1 = dynamic form output including:
       field validation
       form data displayed in multiple tables
       foreach loop of dynamic data

   echo $var1;
   }
else do this {
   display form and collect user input
    submit buttons
   } 
```

它看起来不像 ob_start(); 和 ob_get_clean(); 让我到达我需要的地方，也不需要 php 的 heredoc 字符串。任何想法或例子将不胜感激。

# python - 从 Python 或 R 中的大型数据集中获取高度相关对的有效方法

> ID：11268822
> 
> 赞同：4
> 
> 时间：2012-06-29T20:55:35.333
> 
> 标签：python, algorithm, r

我有一个大数据集（假设有 10,000 个变量，每个变量约有 1000 个元素），我们可以将其视为 2D 列表，例如：

```
[[variable_1],
 [variable_2],
 ............
 [variable_n]
] 
```

我想从该数据中提取高度相关的变量对。我希望“高度相关”成为我可以选择的参数。

我不需要提取所有对，也不一定想要最相关的对。只要有一种有效的方法可以让我得到高度相关的配对，我就会很高兴。

此外，如果一个变量的出现不超过一对，那就太好了。尽管这可能并不重要。

当然，找到这样的对有一种蛮力的方法，但对我来说太慢了。

我用谷歌搜索了一下，发现了一些关于这个问题的理论工作，但我无法找到一个可以做我正在寻找的包。我主要在 python 中工作，所以 python 中的包将是最有帮助的，但如果 R​​ 中存在一个包，它可以满足我的需求，它会很棒。

有谁知道在 Python 或 R 中执行上述操作的包？还是有其他想法？

先感谢您

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T22:34:36.147

你没有告诉我们你需要多快，所以这是一个天真的解决方案。

只需计算相关矩阵，然后用于`which`获取您所追求的对的索引：

```
x <- matrix(rnorm(10000*1000), ncol = 10000)
corm <- cor(x)
out <- which(abs(corm) > 0.80, arr.ind=TRUE) 
```

然后，您可以使用子集来摆脱对角线和冗余对：

```
out[out[,1] > out[,2]] 
```

在我的机器上计算相关矩阵大约需要 75 秒，该`which()`部分大约需要 3 秒……去除冗余大约需要 1.2 秒。是不是太慢了？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:05:31.620

10,000 x 1,000 听起来不是什么大小问题。看看[熊猫](http://pandas.pydata.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-04T00:07:23.043

**对于 R：**

```
# load data
library(ISLR)

# Corrlation of numeric columns
corr = cor(College[sapply(College, is.numeric)])

# Display |correlations| > 0.55
as.data.frame(apply(corr, 2, function(x) ifelse (abs(x) >=0.55, round(x,3), "-"))) 
```

**输出片段**

```
#>              Apps Accept Enroll Top10perc Top25perc F.Undergrad P.Undergrad
#> Apps            1  0.943  0.847         -         -       0.814           -
#> Accept      0.943      1  0.912         -         -       0.874           -
#> Enroll      0.847  0.912      1         -         -       0.965           -
#> Top10perc       -      -      -         1     0.892           -           -
#> Top25perc       -      -      -     0.892         1           -           -
#> F.Undergrad 0.814  0.874  0.965         -         -           1       0.571
#> P.Undergrad     -      -      -         -         -       0.571           1 
```

# android - Android系统如何确定滚动方向？如何改变这种行为？

> ID：11268824
> 
> 赞同：0
> 
> 时间：2012-06-29T20:55:36.740
> 
> 标签：android, scroll, android-ui

我在 Horizo​​ntalScrollView 中有一个 TableLayout，我把这个 Horizo​​ntalScrollView 和其他一些东西放在一个 ScrollView 中，这样这个 TableLayout 可以水平和垂直滚动。

但问题是，Android 系统似乎更喜欢垂直滚动。当我完全水平滑动时，TableLayout 可以水平滚动。但是如果我向侧面（或对角）滑动，Android 系统会将其解释为垂直滚动命令，并且 TableLayout 将垂直滚动。

是否可以更改滚动角度解释的阈值，以便如果我以小于 45 度的角度滑动（相对于水平线），这将被解释为水平滚动命令，否则将被解释为垂直滚动命令。

希望你能理解我糟糕的英语；）

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:02:21.953

你在某个地方有另一个滚动视图吗？如果您只使用水平滚动视图，您的布局如何垂直滚动？

我在滚动视图中使用滚动视图的经验一直很差。但是，您也可以只拦截触摸事件并弄清楚它发生了什么。请注意，我不建议这样做。我建议重新设计。

```
onGenericMotionEvent(MotionEvent event) 
```

# asp.net-mvc - 带有 MVC 的 RavenDB 寻找错误的路径和 404

> ID：11268825
> 
> 赞同：2
> 
> 时间：2012-06-29T20:55:38.987
> 
> 标签：asp.net-mvc, ravendb

我正在关注 Tekpub 上的 RavenDB，讨论将它与 ASP.NET MVC 一起使用。我在我的本地机器上运行 RavenServer.exe 程序，我有一个基本控制器设置如下：

```
public class RavenController : Controller
{
    public new IDocumentSession Session { get; set; }

    private static IDocumentStore documentStore;

    protected override JsonResult Json(object data, string contentType, System.Text.Encoding contentEncoding, JsonRequestBehavior behavior)
    {
        return base.Json(data, contentType, contentEncoding, JsonRequestBehavior.AllowGet);
    }

    public static IDocumentStore DocumentStore
    {
        get
        {
            if (documentStore != null)
                return documentStore;

            lock (typeof(RavenController))
            {
                if (documentStore != null)
                    return documentStore;

                documentStore = new DocumentStore
                {
                    Url = "http://localhost:8080"
                }.Initialize();
            }
            return documentStore;
        }
    }

    protected override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        Session = DocumentStore.OpenSession();
    }

    protected override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        using (Session)
        {
            if (Session != null && filterContext.Exception == null)
                Session.SaveChanges();
        }
    }
} 
```

我有一个使用 RavenDB 提供的示例专辑数据定义的简单模型（也来自视频）：

公共类专辑 { 公共字符串 AlbumArtUrl { 获取；放; } 公共字符串标题 { 获取；放; } 公共 int CountSold { 获取；放; } 公共小数价格 { 获取；放; }

```
 public ArtistReference Artist { get; set; }
    public GenreReference Genre { get; set; }
}

public class ArtistReference
{
    public string Id { get; set; }
    public string Name { get; set; }
}

public class GenreReference
{
    public string Id { get; set; }
    public string Name { get; set; }
} 
```

最后，这是我的控制器：

公共类 HomeController : RavenController { public ActionResult Album(string id) { var album = Session.Load(id); 返回视图（专辑）；}

```
} 
```

现在，当我转到 URL 时，`localhost:xxx/home/album/661`我根本没有得到任何结果；调试显示“专辑”为空，因此 RavenDB 没有加载任何内容。查看服务器，我看到以下内容，它收到了 404 请求路径`/docs/661`。但是，当我使用 RavenDb 工作室访问有问题的专辑时，它查找的 URL（返回数据）是`/docs/albums/661`. 因此，当 RavenDB 可以通过管理工作室正确找到它们时，似乎我在某个地方遗漏了一些东西，让 RavenDB 能够通过 MVC 请求找到文档。

有什么我忘记的想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T08:23:41.353

WayneM，您的问题在这里：

```
public ActionResult Album(string id) 
```

您正在使用字符串 id，但您只传递了数字部分，RavenDB 认为您正在给它完整的 id，并尝试加载 id 为“661”的文档

相反，您可以像这样定义它：

```
public ActionResult Album(int id) 
```

RavenDB knows then that you are passing it a value type, and the conventions supply the rest of the id.

# android - SharedPreferences.commit 因 java.io.IOException 失败：设备上没有剩余空间

> ID：11268830
> 
> 赞同：2
> 
> 时间：2012-06-29T20:56:03.313
> 
> 标签：android, sharedpreferences

问题是我的内部存储器上的磁盘空间不足，因此写入失败。当异常掉到地板上时，我无法自信地处理它（请参阅[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.3.3_r1/android /app/ContextImpl.java#3169](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.3.3_r1/android/app/ContextImpl.java#3169)）。.commit() 调用将返回 false，我可以使用它来处理写入错误，但我不知道失败是由于空间问题还是其他原因。

我怎么知道提交失败的原因是什么？

堆栈跟踪

```
06-29 20:01:17.507: WARN/ApplicationContext(19221): writeToFile: Got exception:
        java.io.IOException: No space left on device
        at org.apache.harmony.luni.platform.OSFileSystem.write(Native Method)
        at dalvik.system.BlockGuard$WrappedFileSystem.write(BlockGuard.java:171)
        at java.io.FileOutputStream.write(FileOutputStream.java:300)
        at com.android.internal.util.FastXmlSerializer.flushBytes(FastXmlSerializer.java:212)
        at com.android.internal.util.FastXmlSerializer.flush(FastXmlSerializer.java:233)
        at com.android.internal.util.FastXmlSerializer.endDocument(FastXmlSerializer.java:183)
        at com.android.internal.util.XmlUtils.writeMapXml(XmlUtils.java:185)
        at android.app.ContextImpl$SharedPreferencesImpl.writeToFile(ContextImpl.java:3191)
        at android.app.ContextImpl$SharedPreferencesImpl.access$800(ContextImpl.java:2756)
        at android.app.ContextImpl$SharedPreferencesImpl$1.run(ContextImpl.java:3106)
        at android.app.ContextImpl$SharedPreferencesImpl.enqueueDiskWrite(ContextImpl.java:3127)
        at android.app.ContextImpl$SharedPreferencesImpl.access$100(ContextImpl.java:2756)
        at android.app.ContextImpl$SharedPreferencesImpl$EditorImpl.commit(ContextImpl.java:3049) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T16:04:10.680

在写入文件之前检查可用空间并计算是否有足够的空间容纳您的文件怎么样？您可以在此处查看如何检查内存[检查内部和外部内存](https://stackoverflow.com/a/8133437/329034)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-29T21:07:44.040

你可以发布你的代码吗？这也是模拟器上的真实设备吗？SharedPerferences 实际上只是一个 xml 文件。您可以通过使用`adb shell`并转到 data/data/your.package.name/sharedpreferences自己浏览它们

您是否尝试过释放设备上的内存？删除一些旧文件或增加 VM 大小。此外，刚刚在 #IO2012 中提到使用 apply() 而不是 commit()。除非你真的想要你的返回值，而大多数人并不想要。

# wso2esb - 远程注册表错误

> ID：11268844
> 
> 赞同：1
> 
> 时间：2012-06-29T20:57:28.383
> 
> 标签：wso2esb

在 Windows 2008 R2 上安装 wso2 esb 4.0.3 版。使用嵌入式注册表时运行良好。从远程注册表配置时（运行 mysql 5.5），我收到以下错误

java.sql.SQLException：可用连接总数小于已提交连接总数

并且esb不会启动。任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T11:44:39.590

在 mysql 中执行以下命令以查看 max_connections：“显示变量”。并执行“S​​et global max_connections=500”来增加最大连接数。

# python - 如何有效地将二进制数据打包到 Python 中的文件中？

> ID：11268847
> 
> 赞同：0
> 
> 时间：2012-06-29T20:57:33.133
> 
> 标签：python, file-io, binary

我想将二进制数据写入 Python 中的文件，而不先通过临时缓冲区发送。如何`struct`直接在文件上使用模块？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:57:33.617

这是我在 Python 3 下如何将二进制数据直接打包到文件中的方法。唯一的缺点是您需要在写入数据之前猜测文件的最大大小。`truncate`（如果猜测太大，可以在最后进行额外的调用。）

这里发生了两件事。该文件正在被内存映射，`struct`并被用于将数据打包到`memoryview`该内存映射的一个。通过使用 a `memoryview`，可以使用 Python 缓冲区接口直接写入文件。`struct`的`pack_into`函数可以写入任何支持缓冲区接口的东西。也可以通过`memoryview`在套接字上使用 a 将二进制数据直接写入套接字来使用此技术。

```
import struct
import mmap

with open('test.bin', 'wb') as f:
    f.truncate(100)

with open('test.bin', 'r+b') as f:
    m = mmap.mmap(f.fileno(), 0)
    mv = memoryview(m)
    for ind in range(25):
        struct.pack_into('>l', mv, ind * 4, ind) 
```

另外，请注意，对 进行更少的调用可能会更好，`pack_into`此处在循环中调用它仅用于说明目的。

# php - CakePHP 重定向，状态码为 404

> ID：11268849
> 
> 赞同：9
> 
> 时间：2012-06-29T20:57:40.193
> 
> 标签：php, cakephp, redirect, http-status-code-404, cakephp-2.0

对于 CakePHP 错误，我知道存在 CakeError 和 AppError 解决方案。但我需要在控制器内进行重定向。

在**AppController**中存在：

```
function afterFilter() {
    if ($this->response->statusCode() == '404')
    {
        $this->redirect(array(
            'controller' => 'mycontroller',
            'action' => 'error', 404),404
        );
    }
} 
```

但这不会创建 404 状态代码。它创建一个 302 代码。我将代码更改为：

```
$this->redirect('/mycontroller/error/404', 404); 
```

但结果是一样的。

我添加了这个，它没有工作也被弃用：

```
$this->header('http/1.0 404 not found'); 
```

如何在控制器重定向中发送 404 代码？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-29T21:13:16.700

如果要返回 404 错误，请使用内置的 CakeError 支持：

```
throw new NotFoundException(); 
```

您可以从控制器中抛出此异常，它应该会生成 404 响应。

[这里](http://book.cakephp.org/2.0/en/development/exceptions.html)有更多的内置异常。

如果您有兴趣制作自定义错误页面，请参阅[这篇文章](https://stackoverflow.com/questions/9620363/cakephp-2-0-how-to-make-custom-error-pages?rq=1)。

否则，我认为不可能返回 404 标头代码并仍然重定向。Http 指定重定向状态代码为[300s](https://en.wikipedia.org/wiki/URL_redirection#HTTP_status_codes_3xx)，这是 CakePHP 遵循的约定。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-02T19:42:59.293

出于某种原因，使用 redirect() 会将状态码更改为 3xx。如果你想执行另一个动作并且仍然返回 404，你可以这样做：

```
$this->controller->response->statusCode(404);
$this->controller->render('/mycontroller/error/404');
$this->controller->response->send(); 
```

这将在没有重定向的情况下执行 Mycontroller::error(404)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-02T13:14:41.137

[蛋糕PHP 3](https://api.cakephp.org/3.5/class-Cake.Network.Exception.NotFoundException.html)

```
use Cake\Network\Exception\NotFoundException;
...
throw new NotFoundException(__('Article not found')); 
```

# video - 处理 - 从 kinect 数据导出电影或图像序列

> ID：11268850
> 
> 赞同：0
> 
> 时间：2012-06-29T20:57:45.163
> 
> 标签：video, image-processing, kinect, openni

我正在尝试找到通过处理导出 PNG 序列或电影的最快方法。我正在捕获 Kinect 数据，目前，在每个绘图调用中，我正在使用：

```
saveFrame("output/fames####.png"); 
```

但这太慢了。有什么我能做的更快的吗？

我正在使用 simple-openni 作为 kinect 提要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:01:31.600

您处理/编码一帧需要多长时间（以及您可以接受的时间）？您可以尝试缓冲数据并让固定数量的工作线程对其进行异步处理。否则，您将不得不求助于捕获视频，因为安装的编解码器可以使用基于硬件加速/优化 CPU 的编码。

**编辑：**为了吸收编码延迟，您可以使用[循环缓冲区](http://circularbuffer.codeplex.com/)来转储需要编码的帧。然后，启动并行编码一组帧的[Task 。](http://msdn.microsoft.com/en-us/library/dd321424.aspx)完成后，查看缓冲区中是否有帧并处理它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T22:53:59.033

您可以尝试保存为[.oni 格式](http://openni.org/docs2/ProgrammerGuide.html#RecordingandPlayingData)，并且已经有一个[SimpleOpenNI 示例](http://code.google.com/p/simple-openni/source/browse/trunk/SimpleOpenNI/dist/all/SimpleOpenNI/examples/OpenNI/RecorderPlay/RecorderPlay.pde)用于录制和播放。尽管这应该使用大量内存，但我想它可能仍然比 saveFrame() 快

使用 .oni 格式的优点是您可以轻松处理使用 SimpleOpeni 记录的节点（例如，可以在 .oni 记录上测试骨骼/手部跟踪或其他功能）。如果您需要图像，应该有[提取/解析 .oni](https://groups.google.com/forum/?fromgroups#!topic/openni-dev/KAXLEmCm-xI)文件的方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T05:05:13.833

这可能为时已晚，但如果将它们保存为 tif 而不是 png，您将获得更好的性能。

# lua - 如何强制执行 Lua 脚本运行时限制？

> ID：11268857
> 
> 赞同：3
> 
> 时间：2012-06-29T20:58:11.587
> 
> 标签：lua, timeout, sandbox

在 lua 中使用 dofile 运行一个几乎微不足道的脚本 10000 次，在这台机器上大约需要 52 秒，但如果我运行 10000 次“lua52 script.lua”，则需要 3 或 4 倍以上。我知道涉及更多系统调用和其他开销，但我试图实现的是运行脚本，超时时间为 3 秒，并打印输出。我的问题是带有无限循环的脚本，无论是否有意，例如：

```
while(true) do
end 
```

我可以在 Lua 中为 dofile 设置超时吗？每次使用 timeout(3) 调用解释器是我唯一的选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T03:14:02.220

对于像我这样的新手来说，在 Lua 问题上纠正 lhf 感觉有点不对，但是这里有；*将“count”传递给 debug.sethook 与传递“c”或“call”相同，在n 个*VM 指令之后传递以触发关联函数的正确掩码是“”。

因此，要限制从 dofile() 加载的代码的运行时间，请使用以下内容：

```
local f = function() error("timeout") end
local x,y = xpcall(function()
  debug.sethook(f, "", 1e8)
  local ret = dofile("script.lua")
  debug.sethook()
  return ret
end, debug.traceback) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T00:39:27.447

如果您不在脚本中调用 C 函数，您可以使用具有大计数值的*计数*钩子并在钩子内引发错误：

```
local function f() error"timeout!" end
debug.sethook(f,"count",1e6)
while true do end 
```

在您的应用程序中，在调用*dofile之前设置**计数*挂钩。

 **每n*条Lua VM 指令调用一次*计数挂钩。*但是，没有办法考虑 C 函数所花费的时间，因此我在上面提出警告。

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T21:07:12.950

没有内置设施，尝试使用[lalarm](http://www.tecgraf.puc-rio.br/~lhf/ftp/lua/#lalarm)库。**

# java - 使用核心服务流上传（来自 Java）将文件上传到 SDL Tridion 2011

> ID：11268858
> 
> 赞同：4
> 
> 时间：2012-06-29T20:58:14.850
> 
> 标签：java, tridion

首先，我的问题是基于我在网上找到的一些答案，我希望有人可以做出澄清的答案。

从我目前的发现中总结出来的问题非常简短：使用 CoreService，似乎 WCF 是默认上传大于 16,384 字节的文件的限制。我希望我只是忽略了一些非常基本的东西，这将允许我上传的不仅仅是空的 gif 文件，而无需更改服务器配置，因为我打算将此代码用于多个 SDL tridion 实例。

* * *

只是为了提供上下文和我发现的内容，您可能不需要阅读所有这些内容，但是由于我花了很多时间寻找和尝试各种事情，我想我不妨把它写下来以供下一个遇到的人使用这。

我正在使用 CoreService Stream Upload 上传文件，基于此示例： [如何使用核心服务将外部文件导入 SDL Tridion 2011？](https://stackoverflow.com/questions/10447494/how-can-i-import-external-files-into-sdl-tridion-2011-using-core-service)

我不想复制所有这些代码，但我可以成功地将一个小的（empty.gif）上传到一个临时位置，以此为基础，我得到一个 Windows 临时文件路径。

```
String tempFileLocationOnServer = streamUploadPort.uploadBinaryByteArray(
                                                                 fileName, data); 
```

对于稍大的文件，一个 80K 的 PDF，我得到一个例外：

> 反序列化操作“UploadBinaryByteArray”的请求消息正文时出错。读取 XML 数据时已超出最大数组长度配额 (16384)。可以通过更改创建 XML 阅读器时使用的 XmlDictionaryReaderQuotas 对象的 MaxArrayLength 属性来增加此配额。第 1 行，位置 2461。

我发现了这个[WCF readerQuotas settings - 缺点？](https://stackoverflow.com/questions/835114/wcf-readerquotas-settings-drawbacks)，这似乎解释了它是 WCF 的一个问题，并且是为了防止 DDOS，并且可以调整这些值。

我认为 80K 字节并不多，我没有做任何我无法通过具有相同凭据的 Web 界面做的事情。

而且由于 CoreService 已经需要用户名/密码，我不明白为什么会出现 DDOS 问题，因为在有效负载之前，该请求应该在身份验证中被拒绝。

我知道诸如 webdav 或在 Tridion 实例上映射网络驱动器之类的替代方法，或者使用单独的网络服务器来转储文件，因此我可以在创建多媒体组件时将它们引用为“外部”，但我宁愿不必走那条路.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T18:52:30.800

在那里阅读您的问题的标题（来自 java），您必须注意到 java 解析器没有 100% 实现 MTOM，这就是核心服务用于流上传/下载的内容。

确保您的解析器支持 MTOM 或使用类似的方法创建新的绑定和端点，检查 messageEnconding="Text" 属性。

```
<binding name="streamUpload_basicHttp" maxReceivedMessageSize="209715200"
         transferMode="StreamedRequest" messageEncoding="Text" 
         receiveTimeout="00:10:00">
  <security mode="None" />
</binding> 
```

它将传递 base 64 中的所有信息（不是性能最佳，但可互操作）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T21:07:50.210

您可以轻松更改 WCF 阅读器配额的大小。

如果您以编程方式创建 CoreService 绑定（如此处所示[）](http://code.google.com/p/tridion-practice/wiki/GetCoreServiceClientWithoutConfigFile)，您可以在代码中更改它。

如果您使用 App.Config 文件来配置端点（例如 Tridion 在 %Tridion%/bin/client/Tridion.ContentManager.CoreService.Client.dll.config 下附带的那个），则编辑此文件并更改其配额。

我自己倾向于使用相当大的配额，并且到目前为止还没有遇到任何问题 - 正如您所说，对核心服务的访问通常受到很好的保护。

# regex - 为什么正则表达式符号仍然用 ASCII 编写？

> ID：11268859
> 
> 赞同：2
> 
> 时间：2012-06-29T20:58:21.083
> 
> 标签：regex, unicode

正则表达式很难阅读。它们难以阅读的部分原因是它们使用非常小的字符列表 (ASCII) 进行编码。

为什么不使用 Unicode 中更广泛的字符创建正则表达式的新符号？

[反斜杠瘟疫](http://docs.activestate.com/activepython/2.5/python/regex/node8.html)是由于反斜杠被重载的事实造成的：它同时意味着“一个反斜杠”和“下一个字母不是它自己”。

但这有点疯狂，不是吗？反斜杠应该只是一个反斜杠，并且“下一个字母不是它本身”应该是不太可能出现在文本中的内容。

对此的明显反应将是“但您选择的任何内容也可能出现在文本中！” 是的，这是真的。但是想要匹配反斜杠的概率（考虑到我们发现自己的历史）比 Unicode 中的其他一些晦涩的符号要高得多。

或者用括号：当我们可以使用其他字符时，为什么我们必须写 [\[\]] ——我不知道，也许是东亚字符之类的：

```
《[]》 
```

叫我疯子但是

```
>>> re.compile('《[]》') 
```

对我来说看起来比以下更具可读性：

```
>>> re.compile('[\[\]]') 
```

甚至还有用于换行符之类的[特定字符：](http://www.fileformat.info/info/unicode/char/2424/index.htm)

```
␤ 
```

我不确定一个人的可读性很强，但你明白吗？也许应该是

```
↪ 
```

或者

```
↳ 
```

我并不是要暗示这些特定的角色选择中的任何一个都是“正确的”。据我所知，我很惊讶似乎没有关于这个话题的任何讨论。

为什么人们愿意忍受尝试用小字母编写正则表达式的痛苦后果？

**更新**

哇，我对这个问题引起的嘲笑感到惊讶。有什么大不了的？

由于我下面乱七八糟的评论与几条评论有关，我就写在这里：

恕我直言，“我们没有钥匙”的论点对我来说没有多大意义。我们在这里谈论多少个“特殊字符”？假设绝对最大值为 100。（这太疯狂了，实际上它可能更像是 20。）

输入法不是我要说的——毕竟，我们不会对那些想在除拉丁字母之外的书写系统中使用计算机的人说“对不起，那些键不在键盘上”？当然不是。

根本*不是*我们依靠硬件来确定我们用什么字符集来编写文本的情况。那些时光已逝。现在，每一种称职的编程语言都或多或少地支持Unicode，或者正在研究它。它迟早会普及。

不过，如果这里的态度代表了大多数科技行业，我想我们都会喜欢逃到 2050 年代。

惊人的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T21:00:10.137

你的键盘上有那些字符的键吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:00:26.297

因为它们更难打字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T21:24:02.670

如果我想使用只是一个字符而不是换行符的换行符怎么办？

“/\↳/”？

但是没有什么能阻止你为正则表达式实现某种语法糖，如果它有效，那么你是对的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T21:00:46.947

因为大多数人没有 Unicode 键盘。

你真的希望我们每次想要制作正则表达式时都启动charmap吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T21:08:36.640

我同意每个人的说法，即这会使输入正则表达式变得更加困难。我还认为它会减慢我查找字符的速度，而使用反斜杠更简单，这在许多编程语言中常用来转义字符。

如果可读性是主要问题，则应通过正则表达式上方的注释来解决。

# knockout.js - 使用ko.renderTemplate的插件中的knockoutjs“无法解析绑定”

> ID：11268863
> 
> 赞同：5
> 
> 时间：2012-06-29T20:58:56.367
> 
> 标签：knockout.js, knockout-2.0

我创建了一个 knockoutjs 插件，该插件最终在其绑定处理程序的“更新”部分中使用了 ko.renderTemplate。该代码会产生预期的输出，但也会引发“无法解析绑定”错误。

可以在 jsfiddle 上的[http://jsfiddle.net/rhoadsce/VSWK2/](http://jsfiddle.net/rhoadsce/VSWK2/)上找到此问题的重现。

javascript如下：

```
ko.plugin = function(configuration) {
    var self = this;
    self.content = configuration.content || '';
};

ko.bindingHandlers.plugin = {
    update: function(element, valueAccessor, allBindingsAccessor) {
        var viewModel = valueAccessor();

        $(element).append('<div id="pluginContainer"></div>');
        var $container = $(element).children('#pluginContainer');

        ko.renderTemplate("pluginTemplate", viewModel, {}, $container, 'replaceNode');
    }
};

$(function () {
    var vm = (function() {
        var plugin = new ko.plugin({ content: 'test content'});

        return {
            plugin: plugin
        }
    })();

    ko.applyBindings(vm);
}); 
```

html同样简单。

```
<div data-bind="plugin: plugin"></div>

<script id="pluginTemplate" type="text/html"><span data-bind="text: content"></span></script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T02:35:43.167

我认为问题在于 KO 正在尝试为 div 的后代应用绑定（并且它使用根视图模型作为上下文来执行此操作，而不是内部插件 VM），但是对`ko.renderTemplate`自身的调用已经将绑定应用于后代（使用正确的上下文）。

为防止这种情况，请让您的 bindingHandler 的 init 方法返回`{ controlsDescendantBindings: true }`。这可以防止 KO 尝试应用绑定。[这是更新的小提琴](http://jsfiddle.net/antishok/VSWK2/30/)。

有关更多信息，请参见此处：http: [//knockoutjs.com/documentation/custom-bindings-controlling-descendant-bindings.html](http://knockoutjs.com/documentation/custom-bindings-controlling-descendant-bindings.html)

# iphone - 如何将无效代码放入 IBAction？

> ID：11268864
> 
> 赞同：0
> 
> 时间：2012-06-29T20:59:00.803
> 
> 标签：iphone, ios, xcode, motion

> **可能重复：**
> [我如何在 IBAction（按钮）内放置一个 void（摇动手势）？](https://stackoverflow.com/questions/11264989/how-do-i-put-a-voidshake-gesture-inside-a-ibactionbutton)

我是创建应用程序的初学者，目前正在开发一个带有动画的项目。到目前为止，我有一个按钮，当用户按下按钮时，动画就会播放并结束。但我需要帮助，因为我需要用户在按下播放后摇晃 iPhone。当用户按下播放 uilabel 时，这正是我真正需要的，一旦用户摇动 iPhone，uilabel 就会消失并且动画播放时会显示摇晃播放。这是我到目前为止所拥有的：-(IBAction)startanimation {

```
animation.animationImages= [NSArray arrayWithObjects:
                            [UIImage imageNamed:@"Frame0.png"],
                            [UIImage imageNamed:@"Frame1.png"],
                            [UIImage imageNamed:@"Frame2.png"],
                            [UIImage imageNamed:@"Frame3.png"],
                            [UIImage imageNamed:@"Frame4.png"],
                            [UIImage imageNamed:@"Frame5.png"],
                            [UIImage imageNamed:@"Frame6.png"],
                            [UIImage imageNamed:@"Frame7.png"],
                            [UIImage imageNamed:@"Frame8.png"],
                            [UIImage imageNamed:@"Frame9.png"],
                            [UIImage imageNamed:@"Frame10.png"],
                            [UIImage imageNamed:@"Frame11.png"],
                            [UIImage imageNamed:@"Frame12.png"],
                            [UIImage imageNamed:@"Frame13.png"],
                            [UIImage imageNamed:@"Frame14.png"], 
                            nil];

[animation setAnimationRepeatCount:1];
animation.animationDuration = 1;
[animation startAnimating];

button.hidden = 1;
animation.hidden = 0;
Menu.hidden = 0;
replay.hidden = 0; 
```

}

这就是我打算放入的内容：

```
- (void)motionEnded:(UIEventSubtype)motion withEvent:(UIEvent *)event {
if (event.subtype == UIEventSubtypeMotionShake) 
```

谢谢，我是一个初学者，所以请解释一下，谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:06:24.293

您无法通过“在 IBAction 中放置 void”来解决此问题，因为 IBAction 和 void 在 Objective-C 中有些等价。

但是，您可以这样做：当用户按下按钮时，您放置一个标签**并设置一个 BOOL 标志，指示用户已按下该标签。**

在`motionEnded:withEvent`方法内部，然后`if (event.subtype == UIEventSubtypeMotionShake && flag)`在开始动画之前进行检查。

**不要忘记将标志初始化为 NO/false**

这是示例代码：

我假设您的 .h 文件看起来像这样

```
@interface MyController: UIViewController {
  BOOL buttonPressed;
}
@end 
```

这是您的 .m 文件中应该包含的内容

```
- (void)viewDidLoad {
  buttonPressed = NO;
}

- (IBAction)buttonPress:(id)sender {
  buttonPressed = YES;
  // show label
}

- (void)motionEnded:(UIEventSubtype)motion withEvent:(UIEvent *)event {
  if (event.subtype == UIEventSubtypeMotionShake && buttonPressed) {
    // start animation
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:04:50.697

你可以用`[self nameOfTheVoid];`

```
-(IBAction)youraction {

    //some code in here
    [self motionEnded];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T21:07:00.310

编写一个连接到您的按钮的函数，该函数将设置一个类似的标志`BOOL buttonPressed`并显示该标签，告诉用户摇动手机。

`motionEnded`您可以检查是否为“是”，在`buttonPressed`这种情况下，您将隐藏该标签，执行动画，然后设置`buttonPressed`回“否”。

# c# - 在 C# 中登录并连接到 SQL Server 数据库

> ID：11268866
> 
> 赞同：1
> 
> 时间：2012-06-29T20:59:02.070
> 
> 标签：c#, sql-server-2008, login

我正在尝试在用 C# 构建的网站中进行简单登录，但我无法连接到数据库，如果在 postbackurl 中的表单属性中我定义了登录后必须去的地方（`/inicio.aspx`），我的应用程序会发送用户而不检查该用户和通行证是否存在，如果我不这样做，则不会发生任何事情。

在我的课堂上，我有：

```
public DataSet sqlLogin(string usuario, string pass)//SOLO SE OCUPA 
{
    //SEOCUPA DATASERT YA QE NO SIRVE DATABALE Y EL DATASET SE LLENA CON ESE DATATABLE 
    string stSql = "select * from usuarios where usuario='"+usuario+"' and
pass='"+pass+"'";
    Bd miBd = new Bd();
    DataTable dt = miBd.sqlSelect(stSql);
    DataSet ds = new DataSet();
    ds.Tables.Add(dt);
    return ds;
} 
```

在我的表格中（在按钮中）：

```
protected void btnLogin_Click(object sender, EventArgs e)
{
    ClUsuario login = new ClUsuario();
    login.sqlLogin(txtUsuario.Text, txtPass.Text);

    try
    {
        Response.Redirect("/Inicio.aspx");
    }
    catch
    {
        lblMsg.Text = "usuario/password no validos";
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:05:27.990

您必须用此代码替换您的代码

```
protected void btnLogin_Click(object sender, EventArgs e)
{
    ClUsuario login = new ClUsuario();
    bool isAuthenticated = login.sqlLogin(txtUsuario.Text, txtPass.Text);
    if (isAuthenticated)
    {
        Response.Redirect("/Inicio.aspx");
    }
    else    
    {
        lblMsg.Text = "usuario/password no validos";
    }
}

And return bool in your sqlLogin

try with this code 

if(dt.Rows.Count > 0)
{
   return true;
} 
return false; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:07:43.183

尝试这个：

```
try
{
    var ds = login.sqlLogin(txtUsuario.Text, txtPass.Text);
    if(ds.Tables[0].rows.count > 0) {
      Response.Redirect("/Inicio.aspx");
    }
    else {lblMsg.Text = "usuario/password no validos";}

}
catch
{
    lblMsg.Text = "Error Occurred!";
} 
```

还尝试在查询中使用 sql 参数。

# string - 数据 Matlab 的字符串标题

> ID：11268869
> 
> 赞同：1
> 
> 时间：2012-06-29T20:59:17.010
> 
> 标签：string, matlab, header, numbers

我发现“在 Matlab 中向矩阵添加标题”[问题](https://stackoverflow.com/questions/7081721/adding-a-header-to-a-matrix-in-matlab)非常接近我需要做的。我希望将数据保留在单元格中，因为我的标题很大而且我多次运行它我不想使用文件 io，因为它会增加大量时间。

这就是我所拥有的...

*   header = ( '季度', '每月剩余金额', '每年剩余金额');

    数据 =

    ```
     1        30000    150000

        2        20000    130000 
    ```

我似乎无法得到这个

```
out = 

  Quarter    monthly am    annual am
        1         30000       150000

        2         20000      130000 
```

非常令人沮丧，我已经尝试过 num2str 和一堆其他东西……我要尝试 num2cell，然后制作一个大数组并填充它们……周五快乐，我要回家了 T_T

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-29T22:11:08.247

如果您有权访问统计工具箱，则可以创建[数据集数组](http://www.mathworks.com/help/toolbox/stats/dataset.html)

```
header = {'Quarter', 'monthly amount remaining', 'annual amountremaining'}
data =    [ 1        30000    150000;
    2        20000    130000];

ds = dataset({data,header{:}})

ds = 

    Quarter    monthlyAmountRemaining    annualAmountremaining
    1          30000                     1.5e+05              
    2          20000                     1.3e+05 
```

请注意，这会删除标题名称中的空格，但使用数据集，您可以使用这些名称方便地访问列，例如：

```
>> ds.Quarter

ans =

     1
     2 
```

如果您只想写入 Excel（而不使用数据集方法），则可以创建一个单元格数组：

```
 [header;num2cell(data)]

ans = 

    'Quarter'    'monthly amount remaining'    'annual amountremaining'
    [      1]    [                   30000]    [                150000]
    [      2]    [                   20000]    [                130000] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:27:49.967

据我所知，没有真正的内置支持。与Xurtio 提到的相关，您想要反向执行Matlab 在执行xlsread 时撤消的操作。他们的解决方案是为数字创建一个矩阵（具有固定大小，因此可以使用数组样式索引），并为具有可变大小的字符串创建一个元胞数组。

以下内容几乎来自 disp() Matlab 文档，它实现了效果，但不是以灵活的方式：

```
header='        Quarter  MonthlyAM   AnnualAM  ';
data=[1 30000 150000; 2 20000 130000];
disp(header);
disp(data);
    Quarter  MonthlyAM   AnnualAM  
       1       30000      150000
       2       20000      130000 
```

如果您想获得更灵活的格式，您可以查看数据矩阵的 sprintf 中介。

# mysql - 为什么 MySQL SLEEP() 函数返回 0？

> ID：11268871
> 
> 赞同：1
> 
> 时间：2012-06-29T20:59:29.870
> 
> 标签：mysql, function, unix, return-value

当我在 MySQL 中运行 sleep 命令时，例如`SELECT SLEEP(7)`，它返回零。为什么是这样？它是否遵循标准的 Unix 返回值约定？它是否只需要返回一些东西，所以零是一个很好的无害值？是否还有其他类似的 MySQL 函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T21:02:25.630

从[文档](http://dev.mysql.com/doc/refman/5.0/en/miscellaneous-functions.html#function_sleep)中：

> 睡眠（持续时间）
> 
> 休眠（暂停）持续时间参数给定的秒数，然后返回 0。如果 SLEEP() 被中断，则返回 1。持续时间可能有以微秒为单位的小数部分。此功能是在 MySQL 5.0.12 中添加的。

# c# - 如何从单击的 ToolStripDropDownButton 项目中获取字符串？

> ID：11268873
> 
> 赞同：2
> 
> 时间：2012-06-29T20:59:49.773
> 
> 标签：c#, winforms, toolstripdropdown

btn1 是 ToolStripDropDownButton

我怎么能这么说

```
private void btn1_DropDownItemClicked(object sender, ToolStripItemClickedEventArgs e)
{
 MessageBox.Show(btn1.CurrentItem.Text.ToString()); // CurrentItem = item clicked.
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T03:46:43.327

```
private void btn1_DropDownItemClicked(object sender, ToolStripItemClickedEventArgs e)
{
  MessageBox.Show(e.ClickedItem.Text); // ClickedItem = item clicked.
} 
```

# java - Maven插件：打包前修改资源

> ID：11268875
> 
> 赞同：1
> 
> 时间：2012-06-29T21:00:02.863
> 
> 标签：java, maven, maven-plugin

我找不到满足我最小化 javascript 和 css 需求的 maven 插件，所以我开始创建自己的插件。然而，我似乎遇到了障碍。文件的最小化版本总是被战争插件或其他东西覆盖。

我的文件结构是

```
src
   main
       java
       webapp
           assets
                 css
                   style1.css
                   style2.css
                   style3.css
                 js
                   script1.js
                   script2.js
                   script3.js 
```

我的插件采用这些，最小化它们，并且（应该）在构建目录中替换它们。如何确保它们不被覆盖？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T08:51:27.727

首先，我建议只使用[http://alchim.sourceforge.net/yuicompressor-maven-plugin/compress-mojo.html](http://alchim.sourceforge.net/yuicompressor-maven-plugin/compress-mojo.html)它能够为您压缩和合并 JS/CSS。

接下来，您需要弄清楚哪个插件实际上覆盖了您的压缩文件以及发生在哪个阶段。一旦你知道了你需要确保你的插件在另一个插件*之后运行的阶段。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:07:58.627

您的插件将更改后的文件输出到哪里？在我看来，它正在进行必要的更改（如果它有效），然后 maven war 插件将原始资源复制到它们之上。

也许您应该附上您的代码和 pom.xml，以获得更好的答案。

编辑：

在查看了您的测试项目之后，可以通过对 pom.xml 进行以下更改来解决问题：

```
diff --git a/pom.xml b/pom.xml
index 0fb6044..ee693f7 100644
--- a/pom.xml
+++ b/pom.xml
@@ -72,9 +72,17 @@
                                <version>2.2</version>
                                <configuration>
                                        <webappDirectory>${basedir}/src/main/webapp</webappDirectory>
+                                       <warSourceExcludes>assets</warSourceExcludes>
+
                                        <failOnMissingWebXml>false</failOnMissingWebXml>
+                                       <webResources>
+                                               <resource>
+                                                       <!-- this is relative to the pom.xml directory -->
+                                                       <directory>${project.build.directory}/minified</directory>
+                                               </resource>
+                                       </webResources>
                                </configuration>
                        </plugin>
                </plugins>
        </build>
-</project>
\ No newline at end of file
+</project> 
```

我也觉得您修改后的 css 文件被更改到`src/main/webapp/assets`不正确的目录中。这些文件只有在复制到目标目录下的相应目录后才能更改。

我已经分叉了您的存储库并向您发送了拉取请求。

# javascript - LearnBoost's Up for Node.js 似乎无法正确重启我的应用程序？

> ID：11268878
> 
> 赞同：0
> 
> 时间：2012-06-29T21:00:10.660
> 
> 标签：javascript, node.js, application-restart, downtime

我一直在使用[LearnBoost 的 Up](https://github.com/LearnBoost/up) for Node.js 作为我在为我的项目更改或上传新代码时实现零停机的一种方式。因为我的项目正在使用网络套接字（通过[Socket.io](http://socket.io/)），所以我不希望我的应用程序冷重新加载，因为这些实时连接将会丢失。

我正在使用 LearnBoost 的 Up，因为它说提供“零停机时间重新加载”，但是一旦我更改了代码，它似乎永远不会正确重新加载我的应用程序，我总是需要退出我的 Node 应用程序并再次手动重新启动它以获取它运行新代码。

我在我的本地 Mac 机器和我的 Linux 服务器上都运行了最新版本的 Up（写作时为[0.2.1 ）。](https://github.com/LearnBoost/up/tags)

我在本地开发人员上使用它来运行我的 Node 应用程序：

```
NODE_ENV=development up --watch --port 9001 init.js 
```

但是假设我做了一些简单（但激烈）的事情，例如更改应用程序的静态媒体文件夹或更改终端中的某些路由（例如），看起来它重新启动了我的应用程序，但实际更改并未发生。唯一的方法是我手动退出并重新启动 Node 应用程序。在我的远程服务器上也是如此，显然这是不对的。

我正确使用它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T23:11:22.340

从文档：

> 被丢弃的工人可能一直在处理请求，所以他们只有在配置的工人超时后才真正死亡，在生产中默认为 10 分钟

你配置好了`workerTimeout`吗？

# javascript - 即使调用了 stopPropagation （即通过第 3 方代码），也捕获点击？

> ID：11268880
> 
> 赞同：1
> 
> 时间：2012-06-29T21:00:23.440
> 
> 标签：javascript, jquery, stoppropagation

我想检测页面上发生的任何点击（关闭自定义上下文菜单）。我正在使用 jQuery 并尝试做

```
$(document).click(function(){ ...close my context menu ... }); 
```

但是，我在页面上的某些元素的点击处理程序中使用了一些调用 evt.stopPropagation() 的代码，而这些点击并没有构成我的顶级处理程序。有什么方法可以捕捉这些点击吗？可以是 jQuery 也可以不是 jQuery，只要它可以跨浏览器工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:12:01.723

如果遗留代码在冒泡阶段处理点击，您可以在捕获阶段处理点击。尝试：

```
element1.addEventListener('click', doSomethingFunction, true); 
```

这一切都在这里很好地解释了：[http ://www.quirksmode.org/js/events_order.html](http://www.quirksmode.org/js/events_order.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T00:02:55.677

您是否尝试过在您的页面中添加一个不可见的 div，然后在您的菜单启动时添加“显示”它（不是真的因为它不可见）。然后，您可以将事件侦听器附加到关闭弹出窗口并隐藏 div 的不可见 div。

# c# - 如何控制radgrid的宽度

> ID：11268881
> 
> 赞同：2
> 
> 时间：2012-06-29T21:00:23.773
> 
> 标签：c#, asp.net, radgrid

我有一个 RadGrid，但它跨越了整个页面的宽度，如果需要，我如何控制它并在单元格中设置宽度和 mae 内容？我找不到任何对我有帮助的东西。我尝试了 MasterTableView-TableLayout="fix" 但单元格中的任何内容都被切断了。任何帮助将非常感激：

```
 <RadGrid:CustomRadGrid ID="DetailsGrid" runat="server" AutoGenerateColumns="False"
 ShowFooter="True" OnNeedDataSource="DetailsGrid_NeedDataSource" OnItemDataBound="DetailsGrid_ItemDataBound"
OnItemCreated="DetailsGrid_ItemCreated" 
OnItemCommand="DetailsGrid_ItemCommand"
GridLines="None" AllowFilteringByColumn="True" 
AllowPaging="True" 
AllowSorting="True"
AllowMultiRowSelection="true"> 
```

**这是一个自定义网格**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:24:26.773

使用`Width`主`RadGrid`标签中的属性。单元格中的内容将自动换行。您可能还必须设置各个列的宽度以获得适当的外观。自动列宽并不总是包裹在您想要的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-15T21:33:52.457

对于 RadGrid 宽度，您只需要设置网格的宽度。

```
<telerik:RadAjaxPanel ID="RadAjaxPanel" runat="server">
    <telerik:RadGrid ID="ViewLogsGrid" FilterType="Combined"
            runat="server"
            AllowFilteringByColumn="true"                
            PageSize="50"
            ShowStatusBar="true"
            AllowPaging="True"
            AllowSorting="True"

            Width="1250px"

            AllowFiltering="True"
            AutoGenerateColumns="false"
            GridLines="None"
            CellSpacing="0">

    </telerik:RadGrid>
</telerik:RadAjaxPanel> 
```

网格内的列将根据需要进行调整，但如果您需要修复列宽，请执行以下操作（Telerik 不推荐）；

```
<telerik:RadGrid ID="ViewLogsGrid" ... ... >

   <MasterTableView TableLayout="Fixed">
      <Columns>
        <telerik:GridBoundColumn DataField="Comments" HeaderText="Comments" SortExpression="Comments"    UniqueName="Comments">

           <HeaderStyle Width="150px" />

        </telerik:GridBoundColumn>
      </Columns>
   </MasterTableView>

</telerik:RadGrid> 
```

# jquery - 使用固定列标题滚动 HTML 表：任何好的库或指南

> ID：11268884
> 
> 赞同：0
> 
> 时间：2012-06-29T21:00:35.097
> 
> 标签：jquery, html-table, internet-explorer-8, horizontal-scrolling, vertical-scrolling

我想制作具有水平滚动、垂直滚动并且列标题保持静止的 HTML 数据表，因此如果有人向下滚动以记录 #943，他们仍然可以看到列的名称。

我在谷歌上搜索了很多解决方案。我试了两个更好看的。我放弃了第一个使用 AJAX 获取和加载表格的方法。它使我的页面加载缓慢。

第二个是完美的，直到我尝试在 Internet Explorer 8 中加载 1000 条或更多记录的表。它只是冻结了。在 Firefox 和 Chrome 中运行良好且快速。不幸的是，我的大多数用户都是 Internet Explorer 用户。

我也很担心，因为有一位朋友联系了 DevExpress，因为他的库有问题，他被告知 JQuery 与 IE 存在兼容性问题。我在网上找到的几乎所有解决方案都基于 JQuery。

那么，任何人都可以向我推荐一个库，它可以让大（1000 行或更多行）保持列标题静止，进行垂直滚动，水平滚动，拥有免费许可并且在 Internet Explorer 8 中运行良好？

如果没有，我非常愿意接受一个非常好的教程来自己滚动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:50:11.393

我喜欢数据表<3。选项几乎是无限的，使用它的人数意味着社区的大量支持。 [数据表网](http://datatables.net)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:41:33.950

如果您不是在寻找 ajax 加载，那么您并不是在寻找一个库，您正在寻找一个带有固定标题的直接 HTML 表（HTML 不会冻结浏览器）。如果列是固定宽度的，您可以在具有水平滚动的 div 中创建一个仅包含标题的表，然后是具有垂直滚动的 div，以及其中的数据表。不需要Javascript。

我会发布一个 jsfiddle 示例，但该站点现在正在抛出 nginx 错误。

# javascript - 用于游戏绘制循环的 Javascript setInterval 运行不一致

> ID：11268885
> 
> 赞同：1
> 
> 时间：2012-06-29T21:00:36.927
> 
> 标签：javascript, canvas, rendering, setinterval

我正在开发一个使用 Node.js 作为服务器的多人游戏。目前它只是一个 2D 三角形，玩家可以在屏幕上行驶。游戏循环在服务器上运行并将游戏世界状态的更新发送到客户端。客户端有一个正在运行的绘制循环，它使用更新的位置和方向将三角形绘制到画布上。

问题：

我在绘制循环中使用了间隔为 30 毫秒的 setInterval。但是，游戏的动作可能会变得相当紧张。我试过测量从一个循环开始到下一个循环所花费的时间，如下面的代码所示。结果表明，循环之间的时间介于 1ms 到 200ms 之间。

控制台输出示例：

```
looptime: 59
looptime: 14
looptime: 22
looptime: 148
looptime: 27 
```

我在客户端运行的唯一其他事情是 onkeyup/onkeydown 侦听器和 socket.io 侦听器，用于将数据发送到服务器。任何帮助深表感谢。

代码：

```
...

function init(){
    var canvas = document.getElementById('canvas');
    if(canvas.getContext){
        setInterval(draw, 30);
    }
}

function draw(){

    timeNow = new Date().getTime();
    console.log('looptime: '+(timeNow-startDrawTime));
    startDrawTime = new Date().getTime();
    var ctx = document.getElementById('canvas').getContext('2d');
    triX = tri.pos.x;
    triY = tri.pos.y;

    ctx.save();
    ctx.clearRect(0,0,400,400);// clear canvas

    ctx.save();
    ctx.translate(triX, triY);
    ctx.rotate(tri.orientation);

    ctx.save();
    ctx.beginPath();
    ctx.arc(0,0,5,0,Math.PI*2, true);
    ctx.stroke();
    ctx.restore();

    //draw tri

    ctx.save();
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.moveTo(0, -5);
    ctx.lineTo(5, 5);
    ctx.lineTo(-5, 5);
    ctx.closePath();
    ctx.fill();
    ctx.restore();

    ctx.restore();

    ctx.restore();
    //console.log('looptime: '+((new Date().getTime())-time));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T05:50:34.213

这就是 setTimeout 的设计方式。Javascript按顺序运行，如果完成一个循环需要更长的时间，那么完成循环需要更长的时间。

在这种情况下，使其保持一致只是性能问题，并且您的代码原样有很多杂乱无章的东西。我用一些性能改进对其进行了注释。

它在 Firefox 中运行缓慢的原因是由于该`console.log`声明。把它拿出来，它会运行得更快。console.log 曾经在 chrome 中也很慢，而且我只有 dev 版本，但我认为它早就被修复了。任何调试器运行都会变慢，这是正常的。

```
function init() {
    // Never ever reference the DOM unless you absolutely have to
    // So we do it once, here, outside of the loop
    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    if (canvas.getContext) {
        setInterval(draw, 30, canvas, ctx);
    }
}

function draw(canvas, ctx) {

    timeNow = new Date().getTime();
    // console statements can be slow in some browsers, so make sure they're gone from the final product
    console.log('looptime: ' + (timeNow - startDrawTime));
    startDrawTime = new Date().getTime();

    triX = tri.pos.x;
    triY = tri.pos.y;
    // This clears the transformation matrix and resets the canvas
    canvas.width = canvas.width;

    ctx.save();
    ctx.translate(triX, triY);
    ctx.rotate(tri.orientation);

    ctx.beginPath();
    ctx.arc(0, 0, 5, 0, Math.PI * 2, true);
    ctx.stroke();
    ctx.restore();

    //draw tri
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.moveTo(0, -5);
    ctx.lineTo(5, 5);
    ctx.lineTo(-5, 5);
    // no need to close the path since we aren't stroking
    ctx.fill();
    //console.log('looptime: '+((new Date().getTime())-time));
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:04:25.080

好的，您可以采取一些措施来提高性能。第一个是缓存你的上下文。将它放在绘图函数之外的变量中，

```
var ctx = document.getElementById('canvas').getContext('2d'); 
```

然后只需`ctx`在绘图函数中引用。否则，您正在搜索可能很昂贵的 dom EVERY 循环。

我推荐的下一件事是使用`requestAnimationFrame`over`setTimeout`

```
// requestAnim shim layer by Paul Irish
    window.requestAnimFrame = (function(){
      return  window.requestAnimationFrame       || 
              window.webkitRequestAnimationFrame || 
              window.mozRequestAnimationFrame    || 
              window.oRequestAnimationFrame      || 
              window.msRequestAnimationFrame     || 
              function(/* function */ callback, /* DOMElement */ element){
                window.setTimeout(callback, 1000 / 60);
              };
    })(); 
```

**[MDN 来源](https://developer.mozilla.org/en/DOM/window.requestAnimationFrame)**

基本上，您的浏览器控制何时需要重新绘制，为您提供更流畅的动画/运动。上面的 shim 回退到`setTimeout`不支持的地方，但是由于您正在制作`canvas`游戏，因此无论您使用的浏览器如何，都应该支持它。

你会像这样实现它

```
draw(){
    // All your other code etc..
    requestAnimFrame( function(){draw()} );
} 
```

# asp.net-mvc - EF MVC Linq - 将模型传递给 MVC WebGrid 时出错

> ID：11268886
> 
> 赞同：0
> 
> 时间：2012-06-29T21:00:39.853
> 
> 标签：asp.net-mvc, entity-framework-4

当我尝试将 Linq 查询的结果传递给 MVC.Webgrid 时，出现错误（简化）：

```
The model item passed into the dictionary is of 
type'System.Data.Entity.Infrastructure.DbQuery but 
this dictionary requires a model item of type
'System.Collections.Generic.IEnumerable`1[MyModel.Models.MyMetric]' 
```

这是失败的 ActionResult：

```
 public ActionResult Test()
    {
        var metrics = db.Metrics
            .GroupBy(c => c.Year)
            .Select(g => new
            {
                Year = g.Key,
                Q1 = g.Where(c => c.Quarter == 1).Sum(c => c.Value),
                Q2 = g.Where(c => c.Quarter == 2).Sum(c => c.Value),
                Q3 = g.Where(c => c.Quarter == 3).Sum(c => c.Value),
                Q4 = g.Where(c => c.Quarter == 4).Sum(c => c.Value)
            });                        
        return View(metrics);
    } 
```

我假设因为我正在创建原始数据的一个支点，所以我需要创建某种新模型，但我不确定如何在这种情况下做到这一点。（只是用 EF 和 MVC 弄湿了我的脚）

有任何想法吗？

蒂亚杰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T07:42:48.057

您将匿名类型传递给视图，而您应该传递`IEnumerable<MyMetric>`. 所以，假设`MyMetric`看起来像这样：

```
public class MyMetric
{
    public int Year { get; set; }
    public int Q1 { get; set; }
    public int Q2 { get; set; }
    public int Q3 { get; set; }
    public int Q4 { get; set; }
} 
```

你只需`IEnumerable<MyMetric>`要从你的 LINQ 查询中返回一个：

```
public ActionResult Test()
{
    var metrics = db.Metrics
        .GroupBy(c => c.Year)
        .Select(g => new MyMetric
        {
            Year = g.Key,
            Q1 = g.Where(c => c.Quarter == 1).Sum(c => c.Value),
            Q2 = g.Where(c => c.Quarter == 2).Sum(c => c.Value),
            Q3 = g.Where(c => c.Quarter == 3).Sum(c => c.Value),
            Q4 = g.Where(c => c.Quarter == 4).Sum(c => c.Value)
        });                        
    return View(metrics);
} 
```

# java - 如何将 Java 类装箱/转换为父类类型？

> ID：11268892
> 
> 赞同：1
> 
> 时间：2012-06-29T21:00:56.520
> 
> 标签：java, oop

我正在尝试用 Java 编写一个屏幕管理器——一种我不熟悉的语言。这个类（ScreenManager）应该能够接受一个类类型，然后实例化它。用代码更容易解​​释，所以我希望能够做到这一点：

```
ScreenManager manager = new ScreenManager();
manager.setCurrentScreen(MenuScreen.class);
manager.runScreen(); 
```

MenuScreen 扩展了一个名为 Screen 的类，它扩展了 JFrame。我的想法是让 AScreen、BScreen、CScreen 等都扩展 Screen，这样我就可以将它们投射到 Screen 并将它们存储为一种类型。

所以 ScreenManager 是这样的：

```
import javax.swing.UIManager;

public class ScreenManager {

    private Class<Screen> _currentScreen;
    private Screen _currentScreenObject;

    public ScreenManager() { }

    public ScreenManager(Class<Screen> screen) {
        setCurrentScreen(screen);       
    }

    public Class<Screen> getCurrentScreen() {
        return _currentScreen;          
    }

    public void setCurrentScreen(Class<Screen> screen) {
        _currentScreen = screen;
    }

    public void runScreen() {
        if (_currentScreen == null) return;
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                UIManager.put("swing.boldMetal", Boolean.FALSE);                
                try {
                    _currentScreenObject = _currentScreen.newInstance();
                } catch (InstantiationException | IllegalAccessException e) {                   
                    e.printStackTrace();
                }
            }
        });
    }
} 
```

屏幕很简单，所有的 AScreen、BScreen 等在它们的构造函数中都有一些初始化代码。

```
import javax.swing.JFrame;

public class Screen extends JFrame {

    private static final long serialVersionUID = 1L;

} 
```

* * *

我绊倒的一点是将类类型传递给 ScreenManager 类。

```
ScreenManager manager = new ScreenManager();
manager.setCurrentScreen(MenuScreen.class);
manager.runScreen(); 
```

现在我可以像这样投射它：

```
Screen s = new MenuScreen(); 
```

但我似乎无法通过类类型。我试着像这样投射它：

```
manager.setCurrentScreen((Screen.class)MenuScreen.class); 
```

那是行不通的。

仅供参考，我来自 C# 背景，所以我的观点可能（并且可能）是错误的。如果是这样，请纠正我。

感谢您阅读到这里！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T21:07:18.833

使用`Class<? extends Screen>`而不是`Class<Screen>`. 然后它会同时接受`Screen.class`and `MenuScreen.class`，给定`MenuScreen`extends `Screen`。Java 与 C# 的泛型协变等价的排序...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:07:31.553

与 C# 不同，Java 中的类型参数是仅编译时的功能，并且不是协变的。

在 Java 中 a`List<Integer>`不是`List<Number>`.

您可以通过将“屏幕的某些未知子类型”声明为`Class<? extends Screen>`. 这是 Java 能做的最好的事情，因为它只在运行编译器时检查类型，而不是像 C# 那样运行代码时检查类型。

# c++ - boost::asio vs. libpcap：避免两次调用close

> ID：11268894
> 
> 赞同：3
> 
> 时间：2012-06-29T21:00:59.423
> 
> 标签：c++, boost, boost-asio, pcap

`strace`在以下程序上运行时：

```
#include <boost/asio.hpp>
#include <pcap.h>

using namespace boost;

int main(int argc, char* argv[])
{
    asio::io_service io;
    asio::posix::stream_descriptor stream(io);
    char errorBuffer[BUFSIZ];
    pcap_t* p = pcap_open_live("any", BUFSIZ, false, 0, errorBuffer);
    stream.assign(pcap_get_selectable_fd(p));
    io.run();
    stream.close();
    pcap_close(p);
    return 0;
} 
```

我得到：

```
close(6)                                = 0
setsockopt(6, SOL_PACKET, PACKET_RX_RING, {block_size=0, block_nr=0, frame_size=0, frame_nr=0}, 16) = -1 EBADF (Bad file descriptor)
munmap(0xb733c000, 4145152)             = 0
close(6)                                = -1 EBADF (Bad file descriptor) 
```

正如你所看到的，`close`在同一个上被调用了两次`fd`（第一次被`stream.close()`，然后被`pcap_close(p)`）。虽然该程序可能没有意义，但我需要同时调用`stream.close()`（以防止`io_service`调用`epoll_ctl`已关闭的`fd`）和`pcap_close(p)`（以释放 使用的内存`pcap_t`）——这发生在多线程程序上。

关于如何在不调用`close`相同`fd`两次的情况下执行此操作的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T21:28:00.693

A`posix::stream_descriptor`假定描述符的所有权，当超出范围时它将关闭它。要解决双重关闭，请在分配之前复制描述符`dup()`。

# android - 安卓 -> XMPP / MSSQL -> .NET

> ID：11268895
> 
> 赞同：0
> 
> 时间：2012-06-29T21:01:14.623
> 
> 标签：android, .net, sql-server, xmpp

我正计划制作能够将命令从移动设备发送到 .NET 应用程序的解决方案。示例：我运行 android 应用程序。在应用程序中，我按下“在 PC 上启动 Winamp”按钮。然后 PC 上的 Winamp 立即开始播放。我打算使用的组件：

1.  Android 应用程序（向网络服务发送命令）
2.  .NET Web 服务（它接收来自 android 的命令，检查 MS-SQL 数据库是否未禁用此命令。如果未禁用，则立即将命令发送到 XMPP）。
3.  XMPP 服务器捕获命令并立即发送到 .NET 应用程序（在 PC 上）。然后 .NET 应用程序执行命令（例如运行 Winamp 或任何其他操作）。

这是好的机制吗？它会起作用吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T04:05:32.900

是的，这种方法会奏效。尝试使用[XEP-0050](http://xmpp.org/extensions/xep-0050.html)作为您的协议：

```
<iq type='set' to='responder@domain' id='exec1'>
  <command xmlns='http://jabber.org/protocol/commands'
           node='start-winamp'
           action='execute'/>
</iq> 
```

# php - 在 PHP 中的 while / foreach 内包装 3 个或更少的对象

> ID：11268901
> 
> 赞同：3
> 
> 时间：2012-06-29T21:02:05.580
> 
> 标签：php, arrays, loops, foreach, while-loop

简单的问题。我有一个包含 21 个元素的数组，并在一个`<div>`块中显示它们中的每三个。代码是*这样*的：

```
<?php
$faces= array(
  1 => 'happy',
  2 => 'sad',
  (sic)
  21 => 'angry'
);

$i = 1;
foreach ($faces as $face) {
  echo $face;
  $i++;
}

?> 
```

问题出在这个数组没有 21 个元素时，有时它有 24 个，有时有 17 个。我如何包装每三个元素，然后单独包装其余元素？我想出了使用`switch`and `case`，但这仅在只有 21 个元素时才有效。我想我可以[事先计算它们](https://stackoverflow.com/questions/665135/find-the-last-element-of-an-array-while-using-a-foreach-loop-in-php)并在最后一个中关闭（即使它是一组一个元素）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T21:06:20.030

你已经在这里拥有了大部分。您所缺少的只是测试您是否准备好包装。因此，在您增加之前`$i`，请尝试：

```
$i = 1;

foreach ($faces as $face)
{
    echo $face;

    if ($i % 3 == 0)
    {
        echo "<br />"; // or some other wrapping thing
    }
    $i++;
} 
```

这将确保您每 3 个面包裹一次，将剩余部分留在最后一个单元中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T21:08:10.537

```
print '<div>';
$i = 1;
foreach ($faces as $face) {
  if ($i % 3 == 0) print '</div><div>';
  echo $face;
  $i++;
}
print '</div>'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T21:11:52.610

我会用[`array_chunk`](http://us2.php.net/manual/en/function.array-chunk.php). 您可以将数组分成三个一组的多维数组。如果元素的数量不是三的倍数，则最后一个元素将包含所有剩余的子元素，无论它们有多少。

# git - git 添加远程开发人员的本地分支

> ID：11268903
> 
> 赞同：2
> 
> 时间：2012-06-29T21:02:25.170
> 
> 标签：git, remote-branch

如何从另一个开发人员的本地分支中添加本地分支？我同事的分支不在原点。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T21:05:35.427

首先，为您同事的存储库添加一个“远程”（如存储库 URL 的昵称）：

```
git remote add colleague <URL-of-their-repository> 
```

然后从该存储库中获取所有分支到称为远程跟踪分支`refs/remotes/colleague/<branch-name>`（通常可以缩写为`colleague/<branch-name>`）：

```
git fetch colleague 
```

现在创建（并切换到）一个名为的本地分支`foo`，该分支跟踪您同事的分支`foo`：

```
git checkout --track colleague/foo 
```

# symfony - symfony2 / 教义2 - dql 子选择

> ID：11268905
> 
> 赞同：0
> 
> 时间：2012-06-29T21:02:29.990
> 
> 标签：symfony, doctrine-orm

是否可以使用 dql 中的子选择获取数据并将结果放入不是实体列的类属性中？

**hasfreelist**是类属性，但不是 mysql 中的实体列。

这是我的 dql：

```
SELECT e, DATE(e.begin) dbegin, 
(SELECT COUNT(g) FROM AcmeDemoBundle:list  g WHERE e.id = g.fkevent) AS e.hasfreelists     
FROM AcmeDemoBundle:event e JOIN e.fklocation l 
WHERE e.enabled=1 e.begin>=:from 
ORDER BY dbegin, e.topevent DESC 
```

我有以下错误：

```
An exception has been thrown during the rendering of a template 
("[Syntax Error] line 0, col 143: Error: 
Expected Doctrine\ORM\Query\Lexer::T_FROM, got '.'") 
```

但它什么也没告诉我。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T08:05:28.897

在我看来，您可以定义 and 之间的关联`Event`，`List`并使用该[`SIZE`功能](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html#dql-functions)添加您的选择。这样更容易和合乎逻辑：

```
SELECT e, DATE(e.begin) AS dbegin, SIZE(e.lists) AS number_of_lists
FROM [...] 
```

您仍然可以`hasFreeList`在实体类上定义一个方法，该方法将返回`sizeof($this->lists) > 0`.

但我认为，您收到此错误的原因是因为您将子选择定义为`e.hasfreelist`. 虽然它是您的类的属性，但这是一个 DQL 语法错误（应该是`(SELECT x FROM y) AS z`）。此外，您的日期选择缺少`AS`运算符。

# html - a：加载索引页面时的活动链接

> ID：11268907
> 
> 赞同：0
> 
> 时间：2012-06-29T21:02:35.910
> 
> 标签：html, css, hyperlink

当我加载我的 index.html 页面时，我怎么能做到这一点，它现在知道它是活动的并加载相应的`a:active`css？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T21:05:04.810

这不是什么`:active`意思。
链接是`:active`如果它被鼠标选中。

您需要添加`class="Current"`到链接并在 CSS 中使用该类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T21:09:36.840

你可以使用一点 Javascript 说`window.onLoad(){ *javascript to load css file*}`.

# php - 链式下拉选择列表代码 - 连接数据？

> ID：11268909
> 
> 赞同：0
> 
> 时间：2012-06-29T21:02:49.717
> 
> 标签：php, javascript, jquery, html, ajax

我正在努力将我在网上找到的链接下拉功能调整到我的网站。我在网上找到的一些代码如下。一个问题是我无法理解读取`var connection = selected.data('connection');`连接属性的行是 jquery 常见的吗？或者它是否设置在代码中的某个地方？如果是这样，该集合在代码中的什么位置？

```
$(function(){

    var questions = $('#questions');

    function refreshSelects(){
        var selects = questions.find('select');

        // Improve the selects with the Chose plugin
        selects.chosen();

        // Listen for changes
        selects.unbind('change').bind('change',function(){

            // The selected option
            var selected = $(this).find('option').eq(this.selectedIndex);
            // Look up the data-connection attribute
            var connection = selected.data('connection');

            // Removing the li containers that follow (if any)
            selected.closest('#questions li').nextAll().remove();

            if(connection){
                fetchSelect(connection);
            }

        });
    }

    var working = false;

    function fetchSelect(val){

        if(working){
            return false;
        }
        working = true;

        $.getJSON('ajax.php',{key:val},function(r){

            var connection, options = '';

            $.each(r.items,function(k,v){
                connection = '';
                if(v){
                    connection = 'data-connection="'+v+'"';
                }

                options+= '<option value="'+k+'" '+connection+'>'+k+'</option>';
            });

            if(r.defaultText){

                // The chose plugin requires that we add an empty option
                // element if we want to display a "Please choose" text

                options = '<option></option>'+options;
            }

            // Building the markup for the select section

            $('<li>\
                <p>'+r.title+'</p>\
                <select data-placeholder="'+r.defaultText+'">\
                    '+ options +'\
                </select>\
                <span class="divider"></span>\
            </li>').appendTo(questions);

            refreshSelects();

            working = false;
        });

    }

    $('#preloader').ajaxStart(function(){
        $(this).show();
    }).ajaxStop(function(){
        $(this).hide();
    });

    // Initially load the product select
    fetchSelect('productSelect');
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:06:41.637

查看 jQuery.data() 函数。此功能允许您存储和检索与指定元素关联的任意数据。

在您的示例中，“选项”具有名称连接的某些属性。查看代码，似乎属性连接用于决定选择链中的下一个链接。

# jquery - JQuery UI 对话框 - 未捕获的 TypeError：无法调用未定义的方法“getTitleId”

> ID：11268921
> 
> 赞同：0
> 
> 时间：2012-06-29T21:03:54.663
> 
> 标签：jquery, asp.net-mvc, jquery-ui, jquery-ui-dialog

我正在尝试在我的 ASP.NET MVC 应用程序中使用 JQuery UI Dialog 插件。我的问题是当我加载页面时，Chrome 控制台在 jquery-ui-min.js 文件中给出以下错误。

```
JQuery UI Dialog - Uncaught TypeError: Cannot call method 'getTitleId' of undefined 
```

我正在我的布局页面中加载所有 js 和 css 文件。以下是我的 JQuery 对话框事件。

```
$('.button').live('click', function () {
    $('.dialog').dialog('open');
});

$('.dialog').dialog({
    autoOpen: false,
    buttons: {
        'Ok': function () {
             $(this).dialog('close');
         }
    }
}); 
```

这两个事件位于一个单独的 .js 文件中，该文件也加载到布局页面中。（此文件加载正确，已调试。）

在我的部分视图中，我有以下一段 html 用于对话框。

```
<input type="button" value="Add Value" class="button" /> 
<div class="dialog"> 
    I am dialog.
</div> 
```

当我删除对话框的 JQuery 事件时，错误消失了。

有任何想法吗 ？提前致谢。

* * *

**编辑 ：**

下面是我的布局页面中的标签内部。

```
<head>
<meta charset="utf-8" />
<title>@ViewBag.Title </title>
<link href='http://fonts.googleapis.com/css?family=Cuprum' rel='stylesheet' type='text/css' />
<script type="text/javascript" src="../../Scripts/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="../../Scripts/jquery-ui.min.js"></script>
<link href="../../Content/Site.css" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="../../Scripts/plugins/spinner/jquery.mousewheel.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/spinner/ui.spinner.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/wysiwyg/jquery.wysiwyg.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/wysiwyg/wysiwyg.image.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/wysiwyg/wysiwyg.link.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/wysiwyg/wysiwyg.table.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/flot/jquery.flot.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/flot/jquery.flot.orderBars.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/flot/jquery.flot.pie.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/flot/excanvas.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/flot/jquery.flot.resize.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/tables/jquery.dataTables.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/tables/colResizable.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/forms.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/autogrowtextarea.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/autotab.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/jquery.validationEngine-en.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/jquery.validationEngine.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/jquery.dualListBox.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/chosen.jquery.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/jquery.maskedinput.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/jquery.inputlimiter.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/forms/jquery.tagsinput.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/other/calendar.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/other/elfinder.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/uploader/plupload.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/uploader/plupload.html5.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/uploader/plupload.html4.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/uploader/jquery.plupload.queue.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.progress.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.jgrowl.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.tipsy.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.alerts.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.colorpicker.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/wizards/jquery.form.wizard.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/wizards/jquery.validate.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.breadcrumbs.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.collapsible.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.ToTop.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.listnav.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.sourcerer.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.timeentry.min.js"></script>
<script type="text/javascript" src="../../Scripts/plugins/ui/jquery.prettyPhoto.js"></script>

// This is the file in which my dialog events are located.
<script type="text/javascript" src="../../Scripts/custom.js"></script>
<meta name="viewport" content="width=device-width" />
</head> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:27:57.723

我刚刚发现了问题。

```
<script type="text/javascript" src="../../Scripts/plugins/spinner/ui.spinner.js"></script> 
```

当我从 中删除此行时`<head>`，对话框开始工作。顺便说一句，这个文件确实存在。但是，我不知道为什么会这样。

# sql - 我可以在 T-SQL 中使用什么来进行无操作？

> ID：11268922
> 
> 赞同：16
> 
> 时间：2012-06-29T21:03:55.173
> 
> 标签：sql, tsql, syntax

T-SQL 中什么是好的空操作？我想将它用作样板代码片段中的占位符。例如，如果我正在删除一个查询/UDF 并且有这样的事情：

```
IF @parm = 1
    BEGIN
    END
IF @parm = 2
    BEGIN
    END 
```

我会收到以下错误：

> 单词“END”附近的语法不正确

我可以在其中加入什么会使编译器静音，即可执行？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-29T21:26:58.080

如前所述[，](https://stackoverflow.com/questions/3234871/empty-statement-in-t-sql)您可以声明一个虚拟变量。它根本不应该出现在任何地方（执行计划、打印输出等）：

```
IF @parm = 1
    BEGIN
        DECLARE @dummy1 bit
    END
IF @parm = 2
    BEGIN
        DECLARE @dummy2 bit
    END 
```

或者，您也可以使用标签：

```
IF @parm = 1
    BEGIN
        noop1:
    END
IF @parm = 2
    BEGIN
        noop2:
    END 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-29T21:08:35.267

你可以在那里扔一个`print`：

```
IF @parm = 1
    BEGIN
    print 'need to implement 1'
    END
IF @parm = 2
    BEGIN
    print 'need to implement 2'
    END 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-17T15:32:05.267

你也可以试试...

```
WAITFOR DELAY '0:0'; 
```

# c# - 如何将层次结构导出到excel？

> ID：11268923
> 
> 赞同：1
> 
> 时间：2012-06-29T21:04:11.320
> 
> 标签：c#, excel, export, hierarchy

我正在尝试使用像 npoi、epplus 或 closedxml 这样的 Excel 库来导出一个层次结构，就像这个 Telerik 示例中的那样：

[http://demos.telerik.com/aspnet-ajax/grid/examples/export/exporthierarchicalgrid/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/grid/examples/export/exporthierarchicalgrid/defaultcs.aspx)

有人可以指点我一些代码示例的方向来帮助我开始吗？我是新手。会使用合并单元格吗？

谢谢！

# c# - 删除 Where NOT 子句 - Linq-To-SQL

> ID：11268928
> 
> 赞同：1
> 
> 时间：2012-06-29T21:04:25.497
> 
> 标签：c#, winforms, linq-to-sql, quickbooks

目前，我正在编写一个 MiddleWare 应用程序，用于在会计应用程序（即 Quickbooks）和 SQL 数据库之间同步信息。我对 Linq-To-SQL 相当陌生，目前正在努力解决最初看起来很简单的问题。

简而言之，我有从会计应用程序（即 AR、收入、费用、负债等）查询会计科目表的逻辑。然后，我的中间件必须确定是否需要在 SQL 数据库的 Accounts 表中为每条记录插入、更新或删除一个帐户。弄清楚操作是插入还是删除很容易弄清楚，但是，我正在努力解决从 Quickbooks 中删除帐户并需要从我的 SQL 数据库中删除的情况。我想运行一个 Linq-To-Sql 查询，该查询基本上从 Account 表中删除所有记录，其中 ListID 不在从查询中检索到的 ListID 列表中。是否有一些简单的方法可以在 Linq-To-Sql 中执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T21:16:01.507

假设您在单独的查询中填充了 ListIDs (listOfIDs) 列表：

```
var accounts = from a in db.Accounts
               where !listOfIDs.Contains(a.ListID)
               select a;
db.Accounts.RemoveAll(accounts);
db.SubmitChanges(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T21:19:21.893

```
db.accounts.Where(x => !ListIDs.Contains(x.ID)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T21:28:45.350

如前所述，使用 lambda 或简单的 linq 请求它。然后

```
db.accounts.Attach(yourObject);
db.accounts.DeleteOnSubmit(yourObject);
db.SubmitChanges(); 
```

当然.. 用 try/catch 保护它，欢迎来到 Linq ！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T22:22:09.240

您没有说您使用的是哪个 SQL 驱动程序，但无论它是哪个（非常短的列表），可以肯定该驱动程序使用 QuickBooks SDK 来访问会计科目表。SDK 有一个特殊查询，用于查找已删除的实体（例如帐户），称为`ListDeletedQuery`. 作为一般规则，`ListDeletedQuery`如果您想找出已删除的内容，使用它会更有效。但是，由于会计科目表通常很小，因此扫描整个列表以查找缺失的元素可能是可以接受的。此外，`ListDeletedQuery`您使用的 SQL 驱动程序可能不会公开。

# c - C：基于区域的内存管理

> ID：11268929
> 
> 赞同：3
> 
> 时间：2012-06-29T21:04:26.877
> 
> 标签：c, memory-management

我正在寻找 C 应用程序的内存管理机制的详细描述，尤其是基于区域的内存管理。我找不到任何关于它的好的深入文章/书籍/教程:(

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T22:21:07.443

很好的参考是原始 Doom 源代码（区域内存分配器，请参见此处[http://doom.wikia.com/wiki/Zone_memory](http://doom.wikia.com/wiki/Zone_memory)）

进一步的开发是 Quake1 源代码（hunk/zone malloc）。

不是教程，而是一个非常好的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T13:01:13.420

有一些关于[APR](http://apr.apache.org/)的[内存池](http://en.wikipedia.org/wiki/Memory_pool)的信息：

*   版本控制与[Subversion](http://svn.gnu.org.ua/svnbook/index.html)书中的一[章。](http://svn.gnu.org.ua/svnbook/svn.developer.pools.html)
*   Inoue Seiichiro 的[libapr 编程教程](http://dev.ariel-networks.com/apr/apr-tutorial/html/apr-tutorial.html)中的一[章](http://dev.ariel-networks.com/apr/apr-tutorial/html/apr-tutorial-3.html)。
*   [Apache 中的基本资源管理：APR 池](http://www.apachetutor.org/dev/pools)，教程。
*   [应用程序接口](http://apr.apache.org/docs/apr/trunk/group__apr__pools.html)。

另一个例子是[nginx](http://nginx.org/)的池，它基本上是[区域](http://en.wikipedia.org/wiki/Region-based_memory_management)：

*   [ngx_palloc.h](https://github.com/git-mirror/nginx/blob/master/src/core/ngx_palloc.h) (65 sloc)。
*   [ngx_palloc.c](https://github.com/git-mirror/nginx/blob/master/src/core/ngx_palloc.c) (311 sloc)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T23:41:42.507

虽然不适用于 C，但我可以直接说下一篇论文中的实现是用 C 编写的，作为 gcc 插件。[此处](http://safari.ece.cmu.edu/MSPC2012/papers/p58-davis.pdf)*的论文[*PDF*](http://safari.ece.cmu.edu/MSPC2012/papers/p58-davis.pdf)标题为“Towards Region-Based Memory Management for Go”。有很多语义等来解释作者如何为 Go 编程语言实现 RBMM。*

# git - 如何使用 SHA git 还原提交

> ID：11268930
> 
> 赞同：28
> 
> 时间：2012-06-29T21:04:46.920
> 
> 标签：git

如何使用 GIVEN SHA 恢复提交？我只想删除给定 SHA 的更改？我想保留在给 SHA 之前和之后所做的所有提交。我只想删除该指定 SHA 的更改。

我已阅读[通过 Git 中的 SHA 哈希恢复提交？](https://stackoverflow.com/questions/1895059/git-revert-to-a-commit-by-sha-hash)，我的理解是重置在我想要恢复的 SHA 之后所做的所有提交。这不是我想要的方式。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-29T21:09:13.190

您可以使用`git revert <commit hash>`来尝试还原提交所做的更改。这不会从历史记录中删除提交，只需进行更改以将其作为新提交撤消。换句话说，您将在历史记录中保留第一个提交，并且在您的分支头部有一个额外的提交，这是原始提交的有效逆向。

如果您尚未与其他任何人共享您的更改，则可以使用`git rebase`. [这个 SO post](https://stackoverflow.com/questions/37219/how-do-you-remove-a-specific-revision-in-the-git-history)中有详细信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T21:05:58.807

`git revert <commit>`将尝试还原单个提交。

它不会更改任何其他提交。你可能会被`git reset`哪个完全不同的东西弄糊涂了。

欲了解更多信息：[https ://www.kernel.org/pub/software/scm/git/docs/git-revert.html](https://www.kernel.org/pub/software/scm/git/docs/git-revert.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-28T15:14:46.087

一个可以使用

```
git revert <commit hash> --no-commit 
```

如果他们想在再次提交之前调整提交还原产生的更改。有关更多信息，请查看[此处](https://git-scm.com/docs/git-revert#Documentation/git-revert.txt---no-commit)

# php - 我是否需要一个框架来在 PHP 中构建 REST API？

> ID：11268933
> 
> 赞同：68
> 
> 时间：2012-06-29T21:05:00.857
> 
> 标签：php, frameworks, rest

我对 PHP 相当陌生（大约 8 个月）。我正在构建一个 Web 应用程序，它几乎已准备好进行测试。我现在才开始考虑制作该应用程序的移动版本需要做什么。

据我了解，我应该构建一个 REST API（如果我错了，请纠正我）。我目前没有为我的网络应用程序使用 PHP 框架。我可以做？

我现在应该开始使用框架以便更轻松地实现我的 API 吗？或者我可以在没有任何框架的情况下构建我的 API？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-06-29T21:10:01.050

**简短的回答** 不，您不需要框架来实现您的目标。

**但是** ，如果您使用框架来管理您的 API，它会变得非常容易。我建议你选择一个轻量级的框架，也许你也可以轻松地将你的 webapp 转换为框架，让一个“应用程序”返回两个不同的“事物”（网络东西和 API）。

看看[Laravel](https://laravel.com/)、[基于 Laravel 4 的 REST API](https://github.com/akuzemchak/laracon-todo-api)或可用于构建的流行[php rest api 框架列表。](http://davss.com/tech/php-rest-api-frameworks)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-06-29T21:15:04.590

您当然*不需要*任何类型的框架来构建 PHP REST API。REST 只不过是建立在 HTTP 之上的协议约定。由于 PHP 显然可以处理 HTTP 请求，因此它拥有构建 RESTful API 所需的一切。

框架的全部意义在于处理常见的任务和其他乏味的事情。REST API 通常使用 PHP 构建，因此存在大量框架。就个人而言，我会使用像[slim](http://www.slimframework.com/)这样的轻量级框架来处理诸如 URI 路由、解析/清理请求数据和生成响应之类的事情。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-18T10:23:13.677

不，您不需要框架来构建 REST API，但强烈建议您这样做，因为构建良好的框架可以处理可能非常困难和复杂的事情，即会话身份验证和缓存以及分离良好的架构。重新发明轮子只能让你到目前为止。

我是[Wave Framework](http://www.waveframework.com)的开发人员，开发时牢记以 API 为中心的设计（[在此处](http://waher.net/archives/1158)阅读更多内容）。我鼓励你看看这个框架，看看它是否可以帮助你。它有一小部分开发人员，但它正在慢慢获得认可。

我鼓励您看一下它是否可以满足您的需求。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-17T05:34:14.930

还有一些工具可以从数据库创建 REST api，而无需额外的代码。

如果您使用 Postgres，那么有一个优秀的程序[postgREST](https://github.com/begriffs/postgrest)

> 提供来自任何现有 PostgreSQL 数据库的完全 RESTful API。它提供了比您从头开始编写的更清洁、更符合标准、更快的 API。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-03-23T09:58:52.583

不，您不需要任何 PHP 后端框架。

如果您使用 php 作为后端，那么您不需要使用任何 resetAPI 框架。只需创建您自己的 php 文件并为每个响应生成 JSON 输出。

您必须生成 JSON 输出。足够了。好处：-如果您使用自己的登录来生成 Json 输出，那么它将是巨大的光速（基于您的逻辑）。如果您使用任何框架，则会出现性能问题。

如果您可以设计自己的迷你框架来完成特定站点的工作，那就更好了。

谢谢

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-07-15T10:37:16.057

REST 与其说是一种语言框架，不如说是一种设计思想，所以不，你不需要使用任何框架。然而，重新发明轮子并没有什么好处（当然还有一些缺点，比如安全性、结构等）。

如果您想避免 MVC 的混乱（这不是 REST 架构的必需规范），您可以使用任何 PHP 微框架（Slim、Lumen 等），它们学习和实现非常快，并允许 PHP 开发人员编写基于路由的应用程序（类似于 MEAN 和 Express）节省大量时间。

这些框架中的大多数也带有 MVC，但如果您不想为 API 提供 CMS，MR（模型路由）就足以满足所有 REST 需求（实际上是最好的）。

自从 Angular 框架允许您的网站像任何其他 API 一样轻松地与服务器通信以来，我认为即使是 CMS 也应该像任何其他应用程序一样访问 API，只是具有提升的权限或特定的端点

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-26T08:12:23.907

世界很大很大，所以，没有人可以一个人做所有的事情。有人会帮助某人（做一些新的事情）做一些旧的事情。这就是我们 IT 世界中存在 libray 和 FW 的原因。

在生产/生活环境中，任何事情都比我们想象的要复杂得多。直到未来的某一天，我们需要为我们的项目构建这么多东西，而我们会看到这些东西之前完全是由 FW 构建的。

虽然只是一个纯 PHP 的 RESTful 服务器，但我们需要解决以下问题：URI 路由、解析/清理请求数据、数据访问、依赖管理、生成响应、bla bla bla ...

我建议使用 Slim 或 Phalcon（微型应用程序）。Slim 是一种简单快捷的方法，但 Phalcon 是一种有效且高性能的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-31T22:36:49.770

**不一定**，你真的**不需要**任何框架！该框架旨在为您提供工具来帮助您更快地构建项目。如今，在大多数情况下，使用框架会更聪明，因为谁喜欢重新发明轮子！

由于您是 PHP 开发人员，最好的答案建议您看看**Laravel**，我还建议您看看**Apiato** ( [apiato.io](http://apiato.io/) )，这是一个构建在 Laravel 之上的**PHP API 框架**。它可以让你以比从普通 Laravel 开始更快的方式创建 API，因为它为你提供了每个 API 已经需要的数十种功能。

# java - 如何在 Swing 中同步请求焦点？

> ID：11268936
> 
> 赞同：3
> 
> 时间：2012-06-29T21:05:07.110
> 
> 标签：java, swing, focus, awt, keyboardfocusmanager

当我调用时`component.requestFocusInWindow()`，Swing 将异步`FOCUS_GAINED`和`FOCUS_LOST`事件排入队列，而不是同步转移焦点。作为一种解决方法，似乎`DefaultKeyboardFocusManager`正在尝试通过延迟键盘事件的调度直到焦点事件完成调度来*模拟同步切换焦点。*但这似乎无法正常工作。

问题：有什么方法可以在 Swing 中同步改变焦点？真的是`DefaultKeyboardFocusManager`在尝试模拟同步焦点，是否存在严重错误？是否有正确执行此操作的焦点管理器？

动机：我有一个`JTextField`当它充满时会自动转移焦点的东西。在使用 编写集成测试`java.awt.Robot`时，我需要它的行为是确定性的，而不是依赖于时间的。

没有得到太多回应的相关问题：[*现在*](https://stackoverflow.com/questions/3389335/swing-how-to-grab-focus-now)[如何抓住焦点？](https://stackoverflow.com/questions/3389335/swing-how-to-grab-focus-now)

 *这是一个演示。预期行为：当您按住一个键时，每个键`JTextField`将包含一个字符。实际行为：焦点变化不够快，因此它们获得了多个字符。

**更新**：请注意，此行为并非特定于程序更改焦点。在第三个示例中，我取消了自定义焦点调用，而是简单地将文档更新延迟设置为 500 毫秒。然后我输入了`1``Tab``2``Tab``3``Tab``4``Tab``5``Tab``6``Tab``7``Tab``8``Tab``9``Tab``0`. 如您所见，数字已正确排队，但制表键被丢弃。

![截屏](../Images/e1de901169ab63a67e81ab7808864a12.png) ![按住 1 个按钮后的屏幕截图](../Images/b941aa2b6b8bf926c7bfb03ba16993d8.png) ![在此处输入图像描述](../Images/9b27a6b7a65c733df8e7a4d75a7655a1.png)

```
import java.awt.*;
import java.awt.event.*;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.logging.*;

import javax.swing.*;
import javax.swing.GroupLayout.Group;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;

public class AwtEventListenerDemo {
    public static final Logger logger = Logger.getLogger(AwtEventListenerDemo.class.getName());
    private static String keyEventToString(KeyEvent keyEvent) {
        int id = keyEvent.getID();
        String eventName =
            id == KeyEvent.KEY_PRESSED ? "key_pressed" :
            id == KeyEvent.KEY_TYPED ? "key_typed" :
            id == KeyEvent.KEY_RELEASED? "key_released" : "unknown " + id;
        String what = id == KeyEvent.KEY_TYPED ? "" + keyEvent.getKeyChar() : "#" + keyEvent.getKeyCode();
        String componentString = keyEvent.getComponent().getName();
        if (componentString == null) componentString = keyEvent.getComponent().toString();
        return String.format("%12s %4s on %s", eventName, what, componentString);
    }
    private static String focusEventToString(FocusEvent focusEvent) {
        int id = focusEvent.getID();
        String eventName = id == FocusEvent.FOCUS_GAINED ? "focus_gained" :
            id == FocusEvent.FOCUS_LOST ? "focus_lost" :
                null;
        if (eventName == null) return focusEvent.toString();
        String componentString = focusEvent.getComponent().getName();
        if (componentString == null) componentString = focusEvent.getComponent().toString();
        return String.format("%12s on %s", eventName, componentString);
    }
    private final AWTEventListener loggingListener = new AWTEventListener() {
        @Override public void eventDispatched(AWTEvent event) {
            if (event instanceof KeyEvent) {
                KeyEvent keyEvent = (KeyEvent) event;
                int id = keyEvent.getID();
                if (id == KeyEvent.KEY_PRESSED && keyEvent.getComponent() instanceof JTextField && ((JTextField)keyEvent.getComponent()).getDocument().getLength() == 1) {
                    EventQueue eventQueue = Toolkit.getDefaultToolkit().getSystemEventQueue();
                    ArrayList<AWTEvent> inQueue = new ArrayList<AWTEvent>();
                    int[] interestingIds = new int[] {KeyEvent.KEY_PRESSED, KeyEvent.KEY_TYPED, KeyEvent.KEY_RELEASED, FocusEvent.FOCUS_GAINED, FocusEvent.FOCUS_LOST};
                    for (int i: interestingIds) {
                        AWTEvent peek = eventQueue.peekEvent(i);
                        if (peek != null)
                            inQueue.add(peek);
                    }
                    ArrayList<String> inQueueString = new ArrayList<String>();
                    for (AWTEvent peek: inQueue) {
                        if (peek instanceof KeyEvent) {
                            inQueueString.add(keyEventToString((KeyEvent) peek));
                        } else if (peek instanceof FocusEvent) {
                            inQueueString.add(focusEventToString((FocusEvent) peek));
                        }
                    }

                    logger.info(String.format("Still in the queue (in no particular order): %s", inQueueString));
                }
                logger.info(keyEventToString(keyEvent));
            } else {
                logger.info(event.toString());
            }
        }
    };
    private JFrame jframe;

    public void init() {
        long mask = AWTEvent.KEY_EVENT_MASK;  //  AWTEvent.MOUSE_EVENT_MASK | 
        Toolkit.getDefaultToolkit().addAWTEventListener(loggingListener, mask);
        if (jframe == null) jframe = new JFrame(AwtEventListenerDemo.class.getSimpleName());
        SwingUtilities.invokeLater(new Runnable() {
            @Override public void run() {
                initUI();
            }
        });
    }
    public void cleanupForRestart() {
        Toolkit.getDefaultToolkit().removeAWTEventListener(loggingListener);
    }
    public void destroy() {
        cleanupForRestart();
        jframe.setVisible(false);
        jframe = null;
    }

    public void initUI() {
        GroupLayout groupLayout = new GroupLayout(jframe.getContentPane());
        jframe.getContentPane().removeAll();
        jframe.getContentPane().setLayout(groupLayout);

        JButton jbutton = new JButton(new AbstractAction("Restart") {
            private static final long serialVersionUID = 1L;
            @Override public void actionPerformed(ActionEvent e) {
                cleanupForRestart();
                init();
            }
        });
        groupLayout.setAutoCreateGaps(true);
        groupLayout.setAutoCreateContainerGaps(true);
        Group verticalGroup = groupLayout.createSequentialGroup()
                .addComponent(jbutton);
        Group horizontalGroup = groupLayout.createParallelGroup()
                .addComponent(jbutton);
        groupLayout.setVerticalGroup(verticalGroup);
        groupLayout.setHorizontalGroup(horizontalGroup);
        for (int i = 0; i < 10; i++) {
            final JTextField jtextfield = new JTextField();
            jtextfield.setName(String.format("JTextField %d", i));
            verticalGroup.addComponent(jtextfield);
            horizontalGroup.addComponent(jtextfield);
            boolean useDocumentListener = true;
            final boolean useFocusRootAncestor = false;
            if (useDocumentListener) {
                DocumentListener listener = new DocumentListener() {
                    @Override public void removeUpdate(DocumentEvent e) { }
                    @Override public void insertUpdate(DocumentEvent e) {

                        // Simulate a slow event listener. When the listener is
                        // slow, the problems get worse.
                        try {
                            Thread.sleep(50);
                        } catch (InterruptedException e1) {
                            logger.warning(e1.toString());
                        }
                        if (e.getDocument().getLength() > 0) {
                            // These two methods of transferring focus appear
                            // equivalent.
                            if (useFocusRootAncestor) {
                                Container focusRoot = jtextfield.getFocusCycleRootAncestor();
                                FocusTraversalPolicy policy = focusRoot.getFocusTraversalPolicy();
                                Component nextComponent = policy.getComponentAfter(focusRoot, jtextfield);
                                nextComponent.requestFocusInWindow();
                            } else {
                                KeyboardFocusManager.getCurrentKeyboardFocusManager().focusNextComponent(jtextfield);
                            }
                        }
                    }
                    @Override public void changedUpdate(DocumentEvent e) { }
                };
                jtextfield.getDocument().addDocumentListener(listener);
            }
        }

        if (!jframe.isVisible()) {
            jframe.pack();
            jframe.setDefaultCloseOperation(WindowConstants.DISPOSE_ON_CLOSE);
            jframe.setVisible(true);
        }
    }
    public static void main(String[] argv) {
        // Use a single-line console log handler.
        LogManager.getLogManager().reset();
        Formatter formatter = new Formatter() {
            private SimpleDateFormat dateFormat = new SimpleDateFormat("kk:mm:ss.SSS");
            @Override
            public String format(LogRecord logRecord) {
                Date date = new Date(logRecord.getMillis());
                DateFormat.getTimeInstance().format(date);
                return String.format("%s %s %s %s%n",
                        dateFormat.format(date),
                        logRecord.getLoggerName(),
                        logRecord.getLevel(),
                        logRecord.getMessage());
            }
        };
        ConsoleHandler consoleHandler = new ConsoleHandler();
        consoleHandler.setFormatter(formatter);
        consoleHandler.setLevel(Level.FINEST);
        logger.addHandler(consoleHandler);
        Logger focusLogger = Logger.getLogger("java.awt.focus.DefaultKeyboardFocusManager");
        focusLogger.setLevel(Level.FINEST);
        focusLogger.addHandler(consoleHandler);

        final AwtEventListenerDemo demo = new AwtEventListenerDemo();
        demo.init();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T17:40:00.457

是的，`Focus`是相当异步的，那么应该是int invokeLater包装的，没办法

编辑

[和@camickr 的不错的解决方法](http://tips4java.wordpress.com/2010/03/14/dialog-focus/)

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
//http://www.coderanch.com/t/342205/GUI/java/Tab-order-swing-components
public class Testing {

    private static final long serialVersionUID = 1L;
    private Component[] focusList;
    private int focusNumber = 0;
    private JFrame frame;

    public Testing() {
        JTextField tf1 = new JTextField(5);
        JTextField tf2 = new JTextField(5);
        JTextField tf3 = new JTextField(5);
        JButton b1 = new JButton("B1");
        JButton b2 = new JButton("B2");
        tf2.setEnabled(false);
        focusList = new Component[]{tf1, b1, tf2, b2, tf3};
        JPanel panel = new JPanel(new GridLayout(5, 1));
        panel.add(tf1);
        panel.add(b1);
        panel.add(tf2);
        panel.add(b2);
        panel.add(tf3);
        frame = new JFrame();
        frame.setFocusTraversalPolicy(new MyFocusTraversalPolicy());
        frame.add(panel);
        frame.pack();
        frame.setLocation(150, 100);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
        KeyboardFocusManager.getCurrentKeyboardFocusManager().addKeyEventDispatcher(new KeyEventDispatcher() {

            public boolean dispatchKeyEvent(KeyEvent ke) {
                if (ke.getID() == KeyEvent.KEY_PRESSED) {
                    if (ke.getKeyCode() == KeyEvent.VK_TAB) {
                        Component comp = KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner();
                        if (comp.isEnabled() == false) {
                            if (ke.isShiftDown()) {
                                KeyboardFocusManager.getCurrentKeyboardFocusManager().focusPreviousComponent();
                            } else {
                                KeyboardFocusManager.getCurrentKeyboardFocusManager().focusNextComponent();
                            }
                        }
                    }
                }
                return false;
            }
        });
    }

    private class MyFocusTraversalPolicy extends FocusTraversalPolicy {

        public Component getComponentAfter(Container focusCycleRoot, Component aComponent) {
            focusNumber = (focusNumber + 1) % focusList.length;
            return focusList[focusNumber];
        }

        public Component getComponentBefore(Container focusCycleRoot, Component aComponent) {
            focusNumber = (focusList.length + focusNumber - 1) % focusList.length;
            return focusList[focusNumber];
        }

        public Component getDefaultComponent(Container focusCycleRoot) {
            return focusList[0];
        }

        public Component getLastComponent(Container focusCycleRoot) {
            return focusList[focusList.length - 1];
        }

        public Component getFirstComponent(Container focusCycleRoot) {
            return focusList[0];
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                Testing testing = new Testing();
            }
        });
    }
} 
```*

# c# - 将重复组转换为多个文本行

> ID：11268937
> 
> 赞同：2
> 
> 时间：2012-06-29T21:05:25.830
> 
> 标签：c#, xslt, transformation, repeat

我想将示例 XML 中的重复组转换为两个分隔的文本行。这是我当前的代码版本：

```
string orderXml = 
@"<?xml version='1.0' encoding='utf-8'?>
<Order id='79223510'>
<Status>new</Status>
<ShipMethod>Standard International</ShipMethod>
<ToCity>Tokyo</ToCity>
<Items>
    <Item>
    <SKU>SKU-1234567890</SKU>
    <Quantity>1</Quantity>
    <Price>99.95</Price>
    </Item>
    <Item>
    <SKU>SKU-1234567899</SKU>
    <Quantity>1</Quantity>
    <Price>199.95</Price>
    </Item>
</Items>
</Order>";

StringReader str = new StringReader(orderXml);

var xslt = new XmlTextReader(new StringReader(
@"<?xml version='1.0' encoding='UTF-8'?>" +
"<xsl:stylesheet version='1.0' xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>" +

"<xsl:output method='text' indent='no'/>" +

"<!-- New line character variable -->" +
"<xsl:variable name='newline'>" +
"<xsl:text>&#13;&#10;</xsl:text>" +
"</xsl:variable>" +
"<xsl:variable name='empty'>" +
"<xsl:text></xsl:text>" +
"</xsl:variable>" +

"<xsl:template match='/'>" +         

"<xsl:for-each select='Order'>" +
"<xsl:value-of select='@id'/>|" + 
"<xsl:value-of select='Status'/>|" +
"<xsl:value-of select='ShipMetod'/>|" +
"<xsl:value-of select='ToCity'/>|" + 
"<xsl:value-of select='$newline'/>" +
"</xsl:for-each>" +

"<xsl:for-each select='Order/Items/Item'>" +
"<xsl:value-of select='SKU'/>|" +          
"<xsl:value-of select='Quantity'/>|" +   
"<xsl:value-of select='Price'/>|" +    
"<xsl:value-of select='$newline'/>" +
"</xsl:for-each>" + 

"</xsl:template>" +
"</xsl:stylesheet>"
                ));

var xDoc = new XPathDocument(str);
var xTr = new System.Xml.Xsl.XslCompiledTransform();
xTr.Load(xslt);

StringBuilder sb = new StringBuilder();
StringWriter writer = new StringWriter(sb);
xTr.Transform(xDoc, null, writer);

string[] lines = sb.ToString().Split(new string[] {"\n"}, StringSplitOptions.RemoveEmptyEntries);    

lines.ToList().ForEach(System.Console.Write); 
```

此代码当前产生以下输出：

```
79223510|new||Tokyo|
SKU-1234567890|1|99.95|
SKU-1234567899|1|199.95| 
```

我希望它产生以下内容：

```
79223510|new||Tokyo|SKU-1234567890|1|99.95|
79223510|new||Tokyo|SKU-1234567899|1|199.95| 
```

只需使用 XSL 转换。请指教。

PS 以文本形式添加了 XSL 以便于阅读：

```
@<?xml version='1.0' encoding='UTF-8'?>
<xsl:stylesheet version='1.0' xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>

<xsl:output method='text' indent='no'/>

<!-- New line character variable -->
<xsl:variable name='newline'>
<xsl:text>&#13;&#10;</xsl:text>
</xsl:variable>
<xsl:variable name='empty'>
<xsl:text></xsl:text>
</xsl:variable>

<xsl:template match='/'>         

<xsl:for-each select='Order'>
<xsl:value-of select='@id'/>| 
<xsl:value-of select='Status'/>|
<xsl:value-of select='ShipMetod'/>|
<xsl:value-of select='ToCity'/>| 
<xsl:value-of select='$newline'/>
</xsl:for-each>

<xsl:for-each select='Order/Items/Item'>
<xsl:value-of select='SKU'/>|          
<xsl:value-of select='Quantity'/>|   
<xsl:value-of select='Price'/>|    
<xsl:value-of select='$newline'/>
</xsl:for-each> 

</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:50:16.277

你犯了几个错误：

1.  您正在使用两个单独的 for-each 循环而不是循环中的循环，因此您的第一行输出来自`Order`元素，接下来的两行来自`Item`元素。（实际上你不需要任何循环。下面的解决方案。）
2.  您拼写错误`ShipMetod`，因此您的某个字段错误地为空白。
3.  您没有任何方法可以转义`|`字段值中可能存在的任何值。（我的解决方案不能解决这个问题，因为我不确定你想怎么做。）

更好的解决方案是使用模板匹配和字符串连接。

```
<xsl:stylesheet version="1.0" xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>
<xsl:output method="text" indent="no" media-type="text/plain" />

<xsl:variable name='newline'><xsl:text>&#13;&#10;</xsl:text></xsl:variable>
<xsl:variable name='delimiter'>|</xsl:variable>

<!-- by default, don't copy any nodes to output -->
<xsl:template match="node()|@*"><xsl:apply-templates select="node()|@*"/></xsl:template>

<xsl:template match="/Order/Items/Item"><xsl:value-of
select="concat(
../../@id, $delimiter,
../../Status, $delimiter,
../../ShipMethod, $delimiter,
../../ToCity, $delimiter,
SKU, $delimiter,
Quantity, $delimiter,
Price, $delimiter,
$newline)"/></xsl:template>

</xsl:stylesheet> 
```

这会产生以下输出：

```
79223510|new|Standard International|Tokyo|SKU-1234567890|1|99.95|
79223510|new|Standard International|Tokyo|SKU-1234567890|1|199.95| 
```

# ios - 在 Xcode 4.3 中的选项卡之间传递数据

> ID：11268942
> 
> 赞同：0
> 
> 时间：2012-06-29T21:05:45.180
> 
> 标签：ios, xcode, tabs, xcode4.3

我试图在 Xcode 4.3 中将数据从一个选项卡传递到另一个选项卡，但我正在努力让它工作。我正在关注 youtube 上的视频教程，直到最后一切都很好。由于他使用的是旧版本的 Xcode（我使用的是 Xcode 4.3.1），我无法找到实现他所做的事情的方法。

这是视频：

[http://www.youtube.com/watch?v=4WOWSgSTZO0](http://www.youtube.com/watch?v=4WOWSgSTZO0)

在 5:40 到 6:30 之间，他打开他的 mainwindow.xib 并控制从他的应用程序委托拖动到他想要在其间共享数据的 2 个视图，并完成了他的工作。我只是找不到使用情节提要在我的 Xcode 版本中实现这一点的方法，有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:10:31.183

根据您尝试传递的数据类型，您可能可以将其存储在 App Delegate 中，然后将其从每个视图控制器中拉出。

您可以从应用程序中的任何位置访问应用程序委托，如下所示：

`[[UIApplication sharedApplication] delegate].whateverProperty`

您需要将您的 App Delegate 头文件导入到任何执行此操作的文件中。

# signals - 是否可以以“延迟”方式捕获 Ctrl+C 信号并运行清理功能？

> ID：11268943
> 
> 赞同：250
> 
> 时间：2012-06-29T21:05:52.090
> 
> 标签：signals, go, sigterm

我想捕获从控制台发送的`Ctrl+C`( `SIGINT`) 信号并打印出一些部分运行总计。

这在 Golang 中可能吗？

注意：当我第一次发布这个问题时，我很困惑`Ctrl+C`是`SIGTERM`不是`SIGINT`.

* * *

## 回答 #1

> 赞同：309
> 
> 时间：2012-06-29T21:16:17.557

您可以使用[os/signal](http://golang.org/pkg/os/signal/)包来处理传入的信号。`Ctrl`+`C`是[SIGINT](http://en.wikipedia.org/wiki/SIGINT_(POSIX))，因此您可以使用它来捕获`os.Interrupt`。

```
c := make(chan os.Signal, 1)
signal.Notify(c, os.Interrupt)
go func(){
    for sig := range c {
        // sig is a ^C, handle it
    }
}() 
```

您使程序终止和打印信息的方式完全取决于您。

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2013-08-10T05:15:53.267

这有效：

```
package main

import (
    "fmt"
    "os"
    "os/signal"
    "syscall"
    "time" // or "runtime"
)

func cleanup() {
    fmt.Println("cleanup")
}

func main() {
    c := make(chan os.Signal)
    signal.Notify(c, os.Interrupt, syscall.SIGTERM)
    go func() {
        <-c
        cleanup()
        os.Exit(1)
    }()

    for {
        fmt.Println("sleeping...")
        time.Sleep(10 * time.Second) // or runtime.Gosched() or similar per @misterbee
    }
} 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-05-14T08:08:34.777

稍微补充一下其他答案，如果您真的想捕获 SIGTERM（kill 命令发送的默认信号），您可以使用`syscall.SIGTERM`os.Interrupt 代替。请注意，系统调用接口是特定于系统的，可能无法在任何地方工作（例如在 Windows 上）。但它很好地抓住了两者：

```
c := make(chan os.Signal, 2)
signal.Notify(c, os.Interrupt, syscall.SIGTERM)
.... 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2012-09-24T18:55:45.523

上面接受的答案中有（在发布时）一两个小错字，所以这里是清理后的版本。在此示例中，我在接收`Ctrl`+时停止 CPU 分析器`C`。

```
// capture ctrl+c and stop CPU profiler                            
c := make(chan os.Signal, 1)                                       
signal.Notify(c, os.Interrupt)                                     
go func() {                                                        
  for sig := range c {                                             
    log.Printf("captured %v, stopping profiler and exiting..", sig)
    pprof.StopCPUProfile()                                         
    os.Exit(1)                                                     
  }                                                                
}() 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-02-20T13:01:31.000

以上所有内容在拼接时似乎都有效，但是[gobyexample 的信号页面](https://gobyexample.com/signals)有一个非常干净和完整的信号捕获示例。值得添加到此列表中。

```
package main

import (
    "fmt"
    "os"
    "os/signal"
    "syscall"
)

func main() {
    sigs := make(chan os.Signal, 1)
    done := make(chan bool, 1)

    signal.Notify(sigs, syscall.SIGINT, syscall.SIGTERM)

    go func() {
        sig := <-sigs
        fmt.Println()
        fmt.Println(sig)
        done <- true
    }()

    fmt.Println("awaiting signal")
    <-done
    fmt.Println("exiting")
} 
```

来源：gobyexample.com/signals

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-16T10:56:51.393

[看例子](https://gobyexample.com/signals)

当我们运行这个程序时，它会阻塞等待信号。通过键入 ctrl-C（终端显示为 ^C），我们可以发送一个 SIGINT 信号，导致程序打印中断然后退出。

信号。通知注册给定通道以接收指定信号的通知。

```
package main

import (
    "fmt"
    "os"
    "os/signal"
    "syscall"
)

func main() {

    sig := make(chan os.Signal, 1)
    done := make(chan bool, 1)

    signal.Notify(sig, syscall.SIGINT, syscall.SIGTERM)

    go func() {
        sig := <-sig
        fmt.Println()
        fmt.Println(sig)
        done <- true

        fmt.Println("ctrl+c")
    }()

    fmt.Println("awaiting signal")
    <-done
    fmt.Println("exiting")
} 
```

检测 HTTP 请求取消

```
 package main

import (
    "fmt"
    "net/http"
    "time"
)

func main() {

    mux := http.NewServeMux()
    mux.HandleFunc("/path", func(writer http.ResponseWriter, request *http.Request) {

        time.Sleep(time.Second * 5)

        select {
        case <-time.After(time.Millisecond * 10):

            fmt.Println("started")
            return
        case <-request.Context().Done():
            fmt.Println("canceled")
        }
    })

    http.ListenAndServe(":8000", mux)

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-09T17:59:15.760

[您可以有一个不同的 goroutine 来检测 syscall.SIGINT 和 syscall.SIGTERM 信号并使用signal.Notify](https://golang.org/pkg/os/signal/#Notify)将它们中继到通道。您可以使用通道向该 goroutine 发送钩子并将其保存在函数切片中。当在通道上检测到关闭信号时，您可以在切片中执行这些功能。这可用于清理资源、等待运行的 goroutine 完成、保存数据或打印部分运行总数。

我编写了一个小而简单的实用程序来在关机时添加和运行钩子。希望它能有所帮助。

[https://github.com/ankit-arora/go-utils/blob/master/go-shutdown-hook/shutdown-hook.go](https://github.com/ankit-arora/go-utils/blob/master/go-shutdown-hook/shutdown-hook.go)

您可以以“延迟”方式执行此操作。

优雅关闭服务器的示例：

```
srv := &http.Server{}

go_shutdown_hook.ADD(func() {
    log.Println("shutting down server")
    srv.Shutdown(nil)
    log.Println("shutting down server-done")
})

l, err := net.Listen("tcp", ":3090")

log.Println(srv.Serve(l))

go_shutdown_hook.Wait() 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-20T00:52:29.897

这是另一个版本，可以在您有一些清理任务的情况下使用。代码将在他们的方法中留下清理过程。

```
package main

import (
    "fmt"
    "os"
    "os/signal"
    "syscall"

)

func main() {

    _,done1:=doSomething1()
    _,done2:=doSomething2()

    //do main thread

    println("wait for finish")
    <-done1
    <-done2
    fmt.Print("clean up done, can exit safely")

}

func doSomething1() (error, chan bool) {
    //do something
    done:=make(chan bool)
    c := make(chan os.Signal, 2)
    signal.Notify(c, os.Interrupt, syscall.SIGTERM)
    go func() {
        <-c
        //cleanup of something1
        done<-true
    }()
    return nil,done
}

func doSomething2() (error, chan bool) {
    //do something
    done:=make(chan bool)
    c := make(chan os.Signal, 2)
    signal.Notify(c, os.Interrupt, syscall.SIGTERM)
    go func() {
        <-c
        //cleanup of something2
        done<-true
    }()
    return nil,done
} 
```

如果您需要清理 main 函数，您还需要使用 go func() 在主线程中捕获信号。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-03-24T03:06:35.060

[Death](https://github.com/vrecan/death)是一个简单的库，它使用通道和等待组来等待关闭信号。收到信号后，它将在您要清理的所有结构上调用 close 方法。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2017-10-02T17:06:44.227

如果有人需要一种在 Windows 上处理信号的方法，仅作记录。

我需要通过 os/exec 从程序 A 调用程序 B 进行处理，但程序 B 永远无法正常终止，因为`cmd.Process.Signal(syscall.SIGTERM)`Windows 不支持通过发送信号或其他信号。

我通过创建一个临时文件作为信号来处理这个问题。例如，程序 A 创建文件`.signal.term`，程序 B 需要检查该文件是否存在于间隔基础上。如果文件存在，它将退出程序并在需要时进行清理。

我敢肯定还有其他方法，但这确实有效。

# java - 查找，然后在java中有效地用相反的替换

> ID：11268946
> 
> 赞同：2
> 
> 时间：2012-06-29T21:05:56.080
> 
> 标签：java, regex, performance

我正在使用非常大的 .txt 蛋白质文件数据库使用 Java。这些蛋白质具有一般结构，但还不够统一，无法硬编码“从 startIndex 到 endIndex，反向和替换”。唯一真正的统一性是它们由 分隔`>`，例如：

`...WERINWETI>gi|230498 [Bovine Albumin]ADFIJWOENAONFOAIDNFKLSADNFATHISDATFDAIFJ>sp|234235 (human) AGP1 QWIQWONOQWNROIWQRNOQWIRNSWELLE>gi|...`等等。

正如你所看到的，虽然实际的蛋白质序列（所有大写的长链）是一致的，因为它们是大写的链，但除此之外，前面的描述几乎可以是任何东西（很多时候不是空格在描述和顺序之间）。我的程序需要做的是将原始文本复制到一个新文件中，然后通过，`r-`在每个之后添加一个`>`（例如`...EERFDS>r-gi|23423...`）以及仅反转大写链。该过程完成后，我需要将其附加到原始文本的末尾。

我已经完成了`r-`功能，实际上我也完成了反转和追加，但是效率不够。接受这种处理的数据库非常庞大，而我的程序花费的时间太长。事实上，我不知道需要多长时间，因为我从不让它完成。我等了1个小时就结束了。这是我使用正则表达式（内置 Pattern 类）（计算密集型部分）进行反转的算法：

```
Pattern regexSplit = Pattern.compile(">");
String[] splits = regexSplit.split(rDash.toString());
StringBuilder rDashEdited = new StringBuilder();
Pattern regexProtein = Pattern.compile("[A-Z]{5,}");

for (int splitIndex = 1; splitIndex < splits.length; splitIndex++) {
    Matcher rDashMatcher = regexProtein.matcher(splits[splitIndex]);
    rDashMatcher.find();
    StringBuffer reverser = new StringBuffer(rDashMatcher.group());
    rDashEdited.append(rDashMatcher.replaceAll(reverser.reverse().toString()) + ">");
}
System.out.println(">" + rDashEdited); 
```

所以，基本上我将`rDash`（这是一个包含所有原始蛋白质的 StringBuilder`>r-`放入，但还没有经历反转）分成每个单独的蛋白质并将它们添加到一个字符串数组中。然后我遍历数组中的每个字符串并查找长度超过 5 个字母的大写字母链，将匹配项添加到 StringBuffer，反转它，并将正向版本替换为反向版本。请注意，此算法适用于较小的文本文件。

是否有更强大的正则表达式可以消除拆分/遍历数组的需要？当我尝试时，该`replaceAll()`调用将所有下游蛋白质替换为集合中 FIRST 蛋白质的反面。为了好玩，我检查了一下，`System.out.println(rDashMatcher.groupCount())`它为集合中的每种蛋白质打印了一个`0`。任何人都可以帮助我使用更有效/更强大的正则表达式吗？这对我来说是一个相当新的概念，但它让我想起了 MATLAB 中的矢量化（仅使用字母）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T00:22:05.920

我扔了 10,000,000 条记录（大约 379MB 文本文件），花了 1:06 分钟。（4core athlon，几年前）

大的 if 树处理你只得到一半的末端，因为分隔符位于元素的中间。

```
public void readProteins(BufferedReader br, BufferedWriter bw) throws IOException
{     
  Pattern regexSplit = Pattern.compile(">");
  Pattern proteinPattern = Pattern.compile("(.*?)([A-Z]{5,})");
  Matcher m;
  Scanner s = new Scanner(br);
  s.useDelimiter(regexSplit);         
  while (s.hasNext())
  {
      StringBuffer sb = new StringBuffer();
      String protein = s.next();
      m = proteinPattern.matcher(protein);            
      if (m.find())
          sb.append(m.group(2)).reverse().append(">r-").insert(0, m.group(1));
      else
          sb.append(protein);
      );          
  }
  bw.flush();
  bw.close();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:37:33.587

一些优化思路：

*   避免使用字符串缓冲区。StringBuilder 提供相同的功能并且速度更快。
*   您可以使用 stringBuilder.replace(int start, int end, String str) 而不是 replaceAll，这将避免再次尝试匹配整个字符串中的模式。
*   使用方法#b，您甚至可以跳过拆分继续搜索蛋白质并在出现时替换它们。

最好使用分析器运行，看看是什么在消耗时间而不是猜测。例如，可以通过增加程序的内存或避免某些慢速文件系统等来提高性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T05:29:42.040

您不需要更强大的正则表达式，您只需要简化您的流程，这样您就不会一遍又一遍地处理相同的文本位。在大多数情况下，这意味着使用 Java 的较低级别的正则表达式 API，即`appendReplacement()`and `appendTail()`。通过向我传递一个空字符串，`appendReplacement()`我避免了它对反向引用的自动处理。

请注意我是如何使用`find()`的。如果你发现自己调用`find()`（或`matches()`或`lookingAt()`）*而不*检查它的返回值，那么你做错了什么。这就是你如何知道匹配是否成功。

```
public static void main(String[] args) throws Exception
{
  // this I/O code is bare-bones so as not to distract from the fun stuff
  BufferedWriter bw = new BufferedWriter(new FileWriter("test_out.txt"));

  // I use a lookahead so the ">" doesn't get discarded
  Scanner sc = new Scanner(new File("test.txt")).useDelimiter("(?=>)");
  while (sc.hasNext())
  {
    bw.write(reverseCapBlocks(sc.next()));
  }
  sc.close();
  bw.close();
}

// cache these because recompiling them is fairly expensive
static final Pattern CAPS_PATTERN = Pattern.compile("\\b[A-Z]{5,}\\b");
static final Pattern BRACKET_PATTERN = Pattern.compile("^>");

static String reverseCapBlocks(String s)
{
  StringBuffer sb = new StringBuffer();
  Matcher m = CAPS_PATTERN.matcher(s);
  while (m.find())
  {
    // appends whatever was between the last match and this one
    // but hole off on appending the current match
    m.appendReplacement(sb, "");
    String temp = m.group();

    // do the reversing manually because it's trivial and it avoids
    // creating a new StringBuilder every time
    for (int i = temp.length() - 1; i >= 0; i--)
    {
      sb.append(temp.charAt(i));
    }
  }
  // append whatever was left after the last match
  m.appendTail(sb);

  // if the chunk began with ">", add the "r-"
  return BRACKET_PATTERN.matcher(sb).replaceFirst(">r-");
} 
```

我使用 StringBuffer 而不是 StringBuilder 因为这是 API 需要的，但这没什么大不了的；关于 StringBuffer 效率低下的报道虽然属实，但往往被夸大了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T22:46:16.770

正如我在评论中提到的，您不应该将整个文件加载到内存中。这将导致内存换入和换出并使您的程序变慢。

如果“蛋白质”的大小（即`>`分隔字符串）在内存中是可管理的，那么这应该可以解决问题

```
 Scanner scanner = null;
    BufferedWriter writer = null;
    try {
        writer = new BufferedWriter(new FileWriter("output.txt"));
        scanner  = new Scanner(new BufferedReader(new FileReader("input.txt")));
        scanner.useDelimiter(">");
        while ( scanner.hasNext() ) {
           doReverseAndWriteToFile(scanner.next(), writer);
        }
    } finally {
        if ( scanner != null) {
            scanner.close();
        }
        if ( writer != null ) {
            writer.flush();
            writer.close();
        }
    } 
```

在`doReverseAndWriteToFile()`你应该把你的程序的第二部分（我没有太在意:-)）。在此函数中，您还应该在执行过程中写入新文件。

如果你使用它，你一次只有“bufferSize”+“一种蛋白质的长度”在内存中。

看看这是否加快了速度..否则你必须寻找其他地方。

# vim - 了解 VimClojure 新安装启动错误

> ID：11268952
> 
> 赞同：2
> 
> 时间：2012-06-29T21:06:19.987
> 
> 标签：vim, clojure, vimclojure

我试图让 vimclojure 第一次工作。我对 vim 插件相当陌生。我遇到了一些问题（下面的错误消息），并且至少正在寻找一些提示。不知道从哪里开始。

我正在尝试遵循[如何驯服 VimClojure](http://blog.darevay.com/2010/10/how-i-tamed-vimclojure/)以及检查[VimClojure-Easy中的步骤](https://github.com/daveray/vimclojure-easy)

当我启动 vim 时，出现以下错误（发生在 VimClojure 2.3.1 和 2.3.3 中，后面的后面）：

```
Error detected while processing /home/nzucker/.vim/bundle/vimclojure/autoload/vimclojure.vim:
line  249:
E475: Invalid argument: 1
line  273:
E475: Invalid argument: 2
line  343:
E475: Invalid argument: 1
line  367:
E475: Invalid argument: 2
line  407:
E475: Invalid argument: 2
line  413:
E475: Invalid argument: 7
line  730:
E475: Invalid argument: 1
line  747:
E475: Invalid argument: 2
line  823:
E475: Invalid argument: 8
Press ENTER or type command to continue 
```

（第一个错误位置：[vimclojure.vim:249](https://github.com/vim-scripts/VimClojure/blob/da2683b9069e01c133f0c0129386fd6dc053019c/autoload/vimclojure.vim#L249)）

然而，该插件似乎部分工作。我有语法高亮。当我尝试使用 sr 命令打开 REPL 时，我得到以下信息：

```
Error detected while processing function vimclojure#ProtectedPlug..vimclojure#ReportError..6..3:
line    1:
E716: Key not present in Dictionary: _buffer
E15: Invalid expression: "buffer! " . self._buffer
Press ENTER or type command to continue 
```

值得我（丑陋）`.vimrc`在这里： [https ://github.com/noahlz/dotfiles/commit/d0df9d0c5500e1803981b959c7fdbf88114000c6](https://github.com/noahlz/dotfiles/commit/d0df9d0c5500e1803981b959c7fdbf88114000c6)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T07:20:00.193

在您引用的博客文章之后，我也无法使其正常工作。一旦我开始完全忽略它并且只按照 vimclojure-easy 中的说明进行操作，我就能让它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T05:41:40.110

请把这个贴在[vimclojure google group](https://groups.google.com/forum/?fromgroups#!forum/vimclojure)上。我不确定到底是什么问题。而这个网站是错误的媒体来回播放问题。

# c# - 从服务器发布的 SignalR 无法正常工作

> ID：11268953
> 
> 赞同：4
> 
> 时间：2012-06-29T21:06:19.700
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, signalr

这是我第一次尝试使用 signalR，我不知道我的代码是否正确，此代码仅用于测试，当从 Controller Action 调用时，signalR 应该发布给所有客户端：这是我所做的：

1.使用 NuGet 安装 SignalR（我在捆绑/缩小时遇到了一点问题）所以我单独导入 signalR js

2.在新文件夹 SingalR 中创建集线器：

```
 [HubName("messageHub")]
    public class MessagesHub : Hub
    {
        public void AddMessage(string htmlstring)
        {
            Clients.addMessage(htmlstring);
        }
    } 
```

3.创建客户端脚本，我只需要服务器 - >客户端，而不是两种方式：

```
<script src="@Url.Content("~/SignalR/jquery.signalR-0.5.2.min.js")" type="text/javascript"></script>
<script src="/signalr/hubs" type="text/javascript"></script>

<div class="content-wrapper">
        <h1 id="lq" class="subtitle">Public Messages</h1>
</div>

<script type="text/javascript">
    $(function () 
    {
        var message = $.connection.messageHub;

        message.addMessage= function (htmlstring) 
        {
            $(htmlstring).insertAfter('#lq');
        };

        $.connection.hub.start();
    });
</script> 
```

4.这是 Action wich，当有人访问它时，它应该向所有客户发布消息。

```
 public ActionResult Index(int id, string title)
   {
     MessagesModel model = new MessagesModel(id);
     var hubContext = GlobalHost.ConnectionManager.GetHubContext<SignalR.MessagesHub>();
     hubContext.Clients.addMessage("Sample Message");
     return View(model);
   } 
```

所以我打开 Firefox，我可以在 firebug 中看到协商成功，我打开 chrome 并转到此页面索引只是为了看到在 Firefox 中插入页面的“示例消息”但没有任何反应，我错过了什么？

**更新：** 在 Firebug 中离开页面时找不到“/signalr/hubs”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T22:25:35.177

听起来可能很傻，但问题是客户端和服务器方法的名称相同，尽管大小写不同，所以我只是更改了：

```
[HubName("messageHub")]
    public class MessagesHub : Hub
    {
        public void AddMessage(string htmlstring)
        {
            Clients.addMessage(htmlstring);
        }
    } 
```

到：

```
 [HubName("messageHub")]
        public class MessagesHub : Hub
        {
            public void SendMessage(string htmlstring)
            {
                Clients.addMessage(htmlstring);
            }
        } 
```

# ravendb - 从 RavenDB 检索整个数据集合

> ID：11268955
> 
> 赞同：17
> 
> 时间：2012-06-29T21:06:20.420
> 
> 标签：ravendb

我有一个需求，我需要从 RavenDB 获取整个数据集合`Users`，并将检索到的结果集与另一组数据进行比较。此特定集合中有近 4000 条记录。

因为 Raven 默认情况下是安全的，所以我不断收到异常，`Number of requests per session exceeded`否则它会返回最多 128 条记录。

我不想将属性设置`Session.Advanced.MaxNumberOfRequestsPerSession`为更高的值。

我应该使用什么查询来获取所有记录的计数？处理这种情况的理想方法是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-30T08:21:30.170

您使用分页，并一次阅读这 1024 个项目。

```
int start = 0;
while(true)
{
   var current = session.Query<User>().Take(1024).Skip(start).ToList();
   if(current.Count == 0)
          break;

   start+= current.Count;
   allUsers.AddRange(current);

} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-10-12T22:55:54.227

这个问题是在 RavenDB 中提供此功能之前发布的，但万一其他人现在偶然发现这个......

鼓励这样做的方法是通过[Streaming API](http://ravendb.net/docs/2.5/client-api/advanced/unbounded-results?version=2.5)。RavenDB 客户端对流进行批处理，以便它可以自动将请求/响应“分页”到/来自服务器。如果您选择使用 Streaming API，客户端会假定您“知道自己在做什么”，并且不会检查用于常规查询的 128/1024/30 限制。

```
var query = session.Query<User>();

using (var enumerator = session.Advanced.Stream(query)) {
    while (enumerator.MoveNext()) {
        allUsers.Add(enumerator.Current.Document);
    }
}

var count = allUsers.Count; 
```

提示：虽然这是解决问题的鼓励方式...一般来说，最好一开始就避免这种情况。如果有一百万条记录怎么办？这份`allUsers`清单将会变得庞大。也许可以首先进行索引或转换以过滤掉您实际需要向用户/进程显示的数据？这是为了报告目的吗？也许 RavenDB 应该自动导出到带有报告服务的 SQL 服务器？ETC...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T12:27:45.807

在 Ayende 答案的基础上，这是一个完整的方法，它确实克服了每个会话 30 个查询的问题，并且确实返回了所提供类的所有文档：

```
 public static List<T> getAll<T>(DocumentStore docDB) {
        return getAllFrom(0, new List<T>(), docDB);
    }

    public static List<T> getAllFrom<T>(int startFrom, List<T> list, DocumentStore docDB ) {
        var allUsers = list;

        using (var session = docDB.OpenSession())
        {
            int queryCount = 0;
            int start = startFrom;
            while (true)
            {
                var current = session.Query<T>().Take(1024).Skip(start).ToList();
                queryCount += 1;
                if (current.Count == 0)
                    break;

                start += current.Count;
                allUsers.AddRange(current);

                if (queryCount >= 30)
                {
                    return getAllFrom(start, allUsers, docDB);
                }
            }
        }
        return allUsers;
    } 
```

我希望这样做不会太笨拙。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T17:58:48.950

老实说，我更喜欢以下功能：

```
 public IEnumerable<T> GetAll<T>()
    {
        List<T> list = new List<T>();

        RavenQueryStatistics statistics = new RavenQueryStatistics();

        list.AddRange(_session.Query<T>().Statistics(out statistics));
        if (statistics.TotalResults > 128)
        {
            int toTake = statistics.TotalResults - 128;
            int taken = 128;
            while (toTake > 0)
            {
                list.AddRange(_session.Query<T>().Skip(taken).Take(toTake > 1024 ? 1024 : toTake));
                toTake -= 1024;
                taken += 1024;
            }
        }

        return list;
    } 
```

[]的

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-22T22:11:24.240

[@capaj 的帖子](https://stackoverflow.com/a/14040576/271992)略有变化。这是将所有文档 ID 作为字符串列表获取的通用方法。注意 , 和 的使用，`Advanced.LuceneQuery<T>(idPropertyName)`以使事情通用。默认假设是给定的有效属性（99.999% 的时间应该是这种情况）。如果您有其他财产，您也可以将其传递。`SelectFields<T>(idPropertyName)``GetProperty(idPropertyName)``"Id"``<T>``Id`

```
public static List<string> getAllIds<T>(DocumentStore docDB, string idPropertyName = "Id") {
   return getAllIdsFrom<T>(0, new List<string>(), docDB, idPropertyName);
}

public static List<string> getAllIdsFrom<T>(int startFrom, List<string> list, DocumentStore docDB, string idPropertyName ) {
    var allUsers = list;

    using (var session = docDB.OpenSession())
    {
        int queryCount = 0;
        int start = startFrom;
        while (true)
        {
            var current = session.Advanced.LuceneQuery<T>().Take(1024).Skip(start).SelectFields<T>(idPropertyName).ToList();
            queryCount += 1;
            if (current.Count == 0)
                break;

            start += current.Count;
            allUsers.AddRange(current.Select(t => (t.GetType().GetProperty(idPropertyName).GetValue(t, null)).ToString()));

            if (queryCount >= 28)
            {
                return getAllIdsFrom<T>(start, allUsers, docDB, idPropertyName);
            }
        }
    }
    return allUsers;
} 
```

我在哪里/如何使用它的一个例子是使用会话`PatchRequest`在 RavenDb 中创建一个。`BulkInsert`在某些情况下，我可能有数十万个文档，并且无法将所有文档加载到内存中，只是为了再次重新迭代它们以进行补丁操作......因此只加载它们的字符串 ID 以传递到`Patch`命令。

```
void PatchRavenDocs()
{
    var store = new DocumentStore
    {
        Url = "http://localhost:8080",
        DefaultDatabase = "SoMeDaTaBaSeNaMe"
    };

    store.Initialize();

    // >>>here is where I get all the doc IDs for a given type<<<
    var allIds = getAllIds<SoMeDoCuMeNtTyPe>(store);    

    // create a new patch to ADD a new int property to my documents
    var patches = new[]{ new PatchRequest { Type = PatchCommandType.Set, Name = "SoMeNeWPrOpeRtY" ,Value = 0 }};

    using (var s = store.BulkInsert()){
        int cntr = 0;
        Console.WriteLine("ID Count " + allIds.Count);
        foreach(string id in allIds)
        {
            // apply the patch to my document
            s.DatabaseCommands.Patch(id, patches);

            // spit out a record every 2048 rows as a basic sanity check
            if ((cntr++ % 2048) == 0)
                Console.WriteLine(cntr + " " + id);
        }
    }
} 
```

希望能帮助到你。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-25T00:40:00.280

我喜欢 Al Dass 让 id 进行操作而不是完整的大型对象的解决方案。还可以直接从索引中获取 id。然而递归让我有点害怕（尽管我认为它可能没问题）并且我删除了反射。

```
public List<string> GetAllIds<T>()
{
var allIds = new List<string>();
IDocumentSession session = null;

try
{
    session = documentStore.OpenSession();
    int queryCount = 0;
    int start = 0;
    while (true)
    {
        var current = session.Advanced.DocumentQuery<T>()
            .Take(1024)
            .Skip(start)
            .SelectFields<string>("__document_id")
            .AddOrder("__document_id")
            .ToList();

        if (current.Count == 0)
            break;
        allIds.AddRange(current);

        queryCount += 1;
        start += current.Count;

        if (queryCount == 30)
        {
            queryCount = 0;
            session.Dispose();
            session = documentStore.OpenSession();
        }
    }
}
finally
{
    if (session != null)
    {
        session.Dispose();
    }
}

return allIds;
} 
```

此外，这已更新为 ravendb 3

# c# - 如何在 C# 中的 ICollection 上创建回调事件 - 用于批处理

> ID：11268960
> 
> 赞同：0
> 
> 时间：2012-06-29T21:06:48.643
> 
> 标签：c#, .net, callback, icollection, batching

有没有办法创建一个回调函数，当列表对象（任何实现 C#.NET 的 ICollection 接口的类）达到一定容量（列表中的项目数）时触发？

例如，当我的列表对象有 5 个元素时，我希望触发一个事件。

为了将您置于上下文中，我正在执行批处理数据处理，因为我正在运行一个通过网络使用 HTTP 的服务，并且批处理对于我的应用程序的性能是必要的。

一个简单的实现是在内存中（在列表中）进行批处理，并在达到一定容量时触发，然后通过网络发送，或者如果有其他工具，我将不胜感激任何指向它们的指针。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:19:04.813

无法将事件添加到`ICollection`已经存在的每个类，但您可以使用其中一个`ObservableCollection`或`BindingList`作为替代方案。当列表更改时，这两者都会引发一个事件，因此您只需检查更改事件中的项目数。或者，您可以创建自己的类来实现`ICollection`简单地包装内部`List`对象的方法并将特殊代码添加到`Add`方法中以检查计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T21:16:30.817

您可以实现该事件：

```
public class YourClassName
{
    private List<Type> m_InnerList = new List<Type>();

    public event EventHandler OnBatch;

    public void Add(Type object)
    {
        m_InnerList.Add(object);
        if ((m_InnerList.Count % YourCountHere == 0) && OnBatch != null)
           OnBatch(this, new EventArgs());

    } 
```

}

您将不得不更改名称，选择您的类型（或使类也通用），实现更多逻辑（如访问您的项目） - 您可以更改它以在构造函数中获取批次数量

您可以改为从 List 派生

# datetime - Informix 按小时分组

> ID：11268963
> 
> 赞同：1
> 
> 时间：2012-06-29T21:06:58.837
> 
> 标签：datetime, informix, hour

如何在 Informix 中将 group by 子句与小时一起使用？

这里的 group by section 给出了一个错误：

```
 SELECT
     cqdr.targetid, 
     cqdr.profileid, 
     ccdr.startdatetime::DATETIME HOUR TO HOUR AS CallHour,
     Count(cqdr.sessionid), 
     (Sum(cqdr.queuetime) / Count(cqdr.sessionid)), 
     Max(cqdr.queuetime)
   FROM Contactqueuedetail cqdr, Contactcalldetail ccdr, Selected_csqs sc
   WHERE cqdr.sessionid = ccdr.sessionid AND
         cqdr.sessionseqnum = ccdr.sessionseqnum AND
         cqdr.profileid = ccdr.profileid AND
         cqdr.nodeid = ccdr.nodeid AND
         ccdr.startdatetime BETWEEN DATE('12/6/27') AND DATE('12/6/28') AND 
         --cqdr.targettype = l_typecsq AND
         cqdr.targetid = sc.csqrecordid AND
         cqdr.profileid = sc.profileid
   GROUP BY ccdr.startdatetime::DATETIME HOUR TO HOUR, cqdr.targetid, cqdr.profileid; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T07:48:06.257

要按派生列分组，请使用 GROUP BY 序号位置语法：

```
SELECT cqdr.targetid, 
     cqdr.profileid, 
     ccdr.startdatetime::DATETIME HOUR TO HOUR AS CallHour,
     Count(cqdr.sessionid), 
     (Sum(cqdr.queuetime) / Count(cqdr.sessionid)), 
     Max(cqdr.queuetime)
  FROM ...
  WHERE ...
GROUP BY 1, 2, 3 
```

# java - 将图像添加到 JPanel 时遇到问题

> ID：11268965
> 
> 赞同：2
> 
> 时间：2012-06-29T21:07:03.013
> 
> 标签：java, image, swing, jpanel, paintcomponent

我正在制作一个视频游戏，我需要将图像添加到 JPanel，然后将该 JPanel 添加到 JFrame。我见过的所有教程都说要将它添加到 JLabel 中，但图像需要能够移动。除非您可以移动 JLabel，否则我不能这样做。我如何能够将图像直接添加到 JPanel。这是我到目前为止所拥有的，但就像在 JApplet 上一样

```
class Penguin extends JPanel {

    public Image image;

    public void paintComponent( Graphics g ) {

        image = getImage( getDocumentBase(), "Penguins.jpg" );
        g.drawImage( image, 0, 0, this );
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T21:08:56.407

您可以轻松地移动 JLabel，因此这仍然是一个可行的选择，并且有一些技巧可以让您做到这一点，包括使用 JLayeredPane 或玻璃窗格。但是话虽如此，在 JPanel 中绘制图像仍然不难（我敢打赌，您的 Google 搜索已经向您展示了如何做到这一点）。`drawImage(...)`关键是在 JPanel 的`paintComponent(...)`方法覆盖中使用 Graphics 对象的方法绘制它。

如果您愿意，如果您向我们提供有关您当前代码和当前问题的更多详细信息，我们可能会为您提供更好和更具体的建议。

**编辑**：
关于您发布的代码：首先，不要在`paintComponent(...)`方法中读取文件。这会减慢您的 GUI 绘图速度并使您的 GUI 响应速度变差。另外，为什么每次重绘时都要在同一个图像文件中重新读取您的代码？不，而是*一次*读取文件并将其保存在 Image 变量中。也许您应该在 using 中阅读它`ImageIO.read(...)`。

接下来，您仍然需要按照之前向您推荐的方式将该文件移动到 jar 文件中。

**编辑 2**：
例如使用如下代码：

企鹅.java

```
package myPackage;

import java.awt.Graphics;
import java.awt.Image;
import java.io.IOException;
import java.io.InputStream;

import javax.imageio.ImageIO;
import javax.swing.JPanel;

@SuppressWarnings("serial")
public class Penguin extends JPanel {
   private Image image;

   public Penguin(String imageResource) throws IOException {
      InputStream inStream = getClass().getResourceAsStream(imageResource);
      image = ImageIO.read(inStream);
   }

   @Override
   protected void paintComponent(Graphics g) {
      super.paintComponent(g);
      if (image != null) {
         g.drawImage(image, 0, 0, this);
      }
   }
} 
```

企鹅Applet.java

```
package myPackage;

import java.awt.BorderLayout;
import java.io.IOException;
import java.lang.reflect.InvocationTargetException;

import javax.swing.*;

@SuppressWarnings("serial")
public class PenguinApplet extends JApplet {
   @Override
   public void init() {
      try {
         SwingUtilities.invokeAndWait(new Runnable() {
            public void run() {
               createAndShowGui();
            }
         });
      } catch (InterruptedException e) {
         e.printStackTrace();
      } catch (InvocationTargetException e) {
         e.printStackTrace();
      }
   }

   public void createAndShowGui() {
      String penguinImgResource = "images/MyImage.jpg";
      try {
         Penguin penguinPanel = new Penguin(penguinImgResource );
         getContentPane().add(penguinPanel, BorderLayout.CENTER);
      } catch (IOException e) {
         e.printStackTrace();
      }
   }
} 
```

您可以将图像包中的图像放在带有类文件的包中：

![在此处输入图像描述](../Images/67983f468ab9590ba09333ede3f48583.png)

这里的关键问题是图像相对于类文件存储在哪里？在我的示例中，类文件保存在 myPackage 中，而图像位于 myPackage/images 中，因此相对路径只是图像。因此，图像文件夹中的任何图像都必须使用此路径引用，此处为“images/MyImage.jpg”，并作为资源而不是文件获取。

# php - 客户评论部分？在 PHP 中

> ID：11268976
> 
> 赞同：2
> 
> 时间：2012-06-29T21:07:53.750
> 
> 标签：php, review

我对 PHP 比较陌生。我想让我的用户能够对位于我网站上的企业进行评论，但我不确定如何实现代码。在下面的 URL 中，我希望我的用户点击企业名称并能够撰写对此类企业的评论。我没有要求任何人为我编写代码，但我要问的是，下一个过程是什么？我如何攻击/解决我拥有的这个程序。接下来我该怎么办......

感谢大家。

[http://whatsmyowncarworth.com/practiceTemplate/practice1/33/loans/table3.php](http://whatsmyowncarworth.com/practiceTemplate/practice1/33/loans/table3.php)

```
<?php
include('init.php');

/*$sql = "SELECT * FROM cars WHERE id='1' ORDER BY year ASC";*/

$sql = "SELECT * FROM dealers";
if ($result = mysql_query($sql)) {

    echo "<table border='1'>";
    echo "<tr> <th>Name</th> <th>Address</th> <th>State</th> <th>City</th> <th>Website</th> ";

    // keeps getting the next row until there are no more to get
    while ($row = mysql_fetch_array($result)){

    $name = $row['name'];
    $address = $row['address'];
    $state = $row['state'];
    $city = $row['city'];
    $website = $row['website'];
    $maps = $row['maps'];
    $lat = $row['lat'];
    $lng = $row['lng'];

        echo("\t<tr>\n");
        echo("\t\t<td>" . "<a href='http://$website' target = '_blank'>" . "$name" . "</a></td>\n");
        echo("\t\t<td>" . "$address" . "</td>\n");
        echo("\t\t<td>" . "$state" . "</td>\n");
        echo("\t\t<td>" . "$city" . "</td>\n");
        echo("\t\t<td>" . "<a href='http://$website' target = '_blank'>" . "$name" . "</a></td>\n");

        /*echo("\t\t<td>" . "<a href='http://$website' target = '_blank'>" . "$name" . "</a></td>\n");

        echo("\t\t<td>" . "<a href='http://$maps' target = '_blank'>" . "$address" . "</td>\n"); 
        echo("\t\t<td>" . "<a href='http://$maps' target = '_blank'>" . "$address" . "</td>\n");
        echo("\t\t<td>" . "$state" . "</td>\n");
        echo("\t\t<td>" . "$city" . "</td>\n");

        echo ("\t\t<td>" . "<a href='http://$website' target = '_blank'>" . "$website" . "</a></td>\n");
        echo("\t\t<td>" . "$maps" . "</td>\n");
        echo("\t\t<td>" . "$lat" . "</td>\n");
        echo("\t\t<td>" . "$lng" . "</td>\n");*/

        // Print out the contents of each row into a table

    }
    echo "</table>";
}
else {
    trigger_error(mysql_error()); // for development only; remove when in production
}
?>

<html>
<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body bgcolor="#FFFFFF" text="#000000">

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:15:30.133

我将首先`id`在您的表格中添加一列。然后为评论创建一个新表。列包括`ID (int, PK), businessID (int), review (text or something)`. 然后，将更多信息的链接添加到链接到的每个条目`mysite.com/details.php?id=<id>`。

在该页面上，您再次显示该业务的相关信息（可选）、过去的评论（与您已经这样做的方式相同）和一个表格以获取用户的想法。当用户提交表单时，它将发送一个`POST`文件（可以是相同`details.php`或不同的文件以避免混乱），该文件将读取所有变量`$_POST[]`并将其插入数据库。

另一方面，您为什么要在标签`echo`上方添加东西？`<html>`所有这些东西都应该放在`<body>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T23:33:30.980

好的，如果您将评论按钮放在最后一列的网站名称旁边会更好。像这样，**John Doe 汽车销售**| **写评论**

这样，评论按钮将靠近网站或经销商的名称...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T15:55:47.937

是的，请保留评论之类的评论。为业务数据库使用唯一的 id 列，并在评论表中使用该 id 进行链接。最好在同一个窗口或使用 jQuery 对话框或其他东西的弹出窗口中使用评论。

# jquery - jCarousel 项目上的活动类

> ID：11268977
> 
> 赞同：0
> 
> 时间：2012-06-29T21:07:55.993
> 
> 标签：jquery, jquery-plugins, jcarousel

在这个例子中[http://sorgalla.com/projects/jcarousel/examples/static_controls.html](http://sorgalla.com/projects/jcarousel/examples/static_controls.html)我需要一个活动状态 li 所以每当我滑动时它应该看起来像这样。

有人知道吗？![在此处输入图像描述](../Images/c66b60897dc2f9eb274b65883393004b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:18:42.220

试试这个：

```
$('.jcarousel-control a').click(function(e){
   e.preventDefault();
   var txt = $(this).text();
   $('.jcarousel-list li').removeClass('active');
   $('.jcarousel-list li:eq(' + (txt - 1) + ')').addClass('active')
}) 
```

# windows - gedit 的首选项保存在哪里？

> ID：11268979
> 
> 赞同：0
> 
> 时间：2012-06-29T21:07:59.900
> 
> 标签：windows, linux, gedit

我正在使用 Gedit 2.28.3

从文件系统中，我想阻止程序显示“有新版本的 gedit (xxx)”

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T22:39:00.200

*好吧，这不是一个真正的编程问题，但我会尝试给出一个与编程相关的答案......*

一个软件最准确的文档是它的源代码；`gedit`我从[这里](http://ftp.gnome.org/mirror/gnome.org/sources/gedit/2.28/)下载了您的版本的源代码，并搜索了字符串“有一个新版本”。我中招了`plugins/checkupdate/gedit-check-update-plugin.c`。

可以合理地假设此功能是通过插件以模块化方式提供的 - 至少我的 Linux 发行版`--disable-updater` `configure`在编译时使用该选项显式禁用该插件。由于它是一个插件，因此处理此问题的最简单方法是通过`Edit->Preferences->Plugins`选项卡。

如果您想在不通过`gedit`用户界面的情况下禁用该插件，您可以尝试使用该`gconf-editor`工具直接修改 GConf 设置。只需导航到该插件并将其从列表中`apps/gedit-2/plugins`删除。`checkupdate`

如果您不想使用图形实用程序，您*可以*直接修改基础`GConf`文件 - 我的文件位于`~/.gconf/apps/gedit-2/plugins/%gconf.xml`. 这是一个XML文件，格式不言而喻......

*免责声明：不建议直接修改 GConf 文件 - 你自己...*

PS：哦，删除插件文件`libcheckupdate.so`或类似的东西也*可能*有效 - 或者它可能会让你的房子着火......

# django - 仅允许一条记录时尝试创建 Django 记录时的正确异常是什么

> ID：11268986
> 
> 赞同：4
> 
> 时间：2012-06-29T21:08:48.353
> 
> 标签：django, exception

如果它确实一直到数据库，那显然是一个 IntegrityError。但是，如果这是在它进入数据库*之前发生的——比如说，在 Manager 类的保存方法中——应该引发什么异常？*

例子：

```
class MyManager(models.Manager):
    def create_from_user(self, user):
        try:
            existing = self.get(user=user)
            raise Exception("There is already an object for this user.") # more specific exception needed
        except self.DoesNotExist:
            # begin creating the record 
```

由于记录的性质，我不希望出现 get_or_create 类型的情况（我希望在记录已经存在时使用此方法是抛出异常的硬错误）。

假设我在我的表上设置了唯一约束，显然最终会抛出一个 IntegrityError ，但我宁愿不依赖它，而是在代码中明确说明。但我不确定哪个例外是最准确的（或者我是否必须自己动手）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T21:31:05.210

我会说这是一个`ValidationError`. 这就是 Django 在遇到唯一字段上的重复条目时在表单和模型清理方法中抛出的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T21:23:02.310

为什么不`IntegrityError`自己扔？从某种意义上说，您的数据库相关代码已经检测到即将发生完整性问题。没有必要编造一个不同的错误/异常来描述已经有名字的东西。

# linux-kernel - 新安装的内核只能在 initramfs> 提示符下运行

> ID：11268988
> 
> 赞同：0
> 
> 时间：2012-06-29T21:08:53.600
> 
> 标签：linux-kernel, kernel

我刚刚编译了 Linux Kernel 2.6.27.62 并将其安装在 VitualBox 的 Ubuntu 中。现在，当我从 grub (legacy) 菜单中选择新内核时，结果如下：

```
[ 13.084002] cpufreq: No nForce2 chipset.
mount: mounting non on /dev/failed: No such device.
W: devtmpfs not available, falling back to tmpfs for /dev.
mount: mounting /dev/disk/by-uuid/7251a301-d971-4d8e-8077-c0ca9d759aa8 on /root
failed: No such device.
mount: mount /dev/ on /root/dev/ failed: No such file or directory.
mount: mounting /sys on /root/sys failed: No such file or directory.
mount: mounting /proc on /root/proc failed: No such or directory      
No init found. Try passing init= bootarg.
BusyBox v7.17.1 (Ubuntu 1:1.17.1-10ubuntu1) built-in shell(ash). 
```

然后我只得到`initramfs>`只提供很少命令的提示。帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T20:43:56.393

可能的解决方法： 1.尝试在引导期间进入 grub 编辑器（在 grub 菜单中按您要引导的内核上的“e”）。您将有一行：“/boot/vmlinuz-2.6.31-23-generic root=UUID=4614036b0-1c9a-4311-b452-c5c0d3762690 ro quiet splash”

2.删除“root=UUID=4614036b0-1c9a-4311-b452-c5c0d3762690”并尝试“/dev/sda1”

看这个帖子：[这里](http://ubuntuforums.org/showthread.php?t=1018403&page=5)（页面最后一个有截图）

# php - Mysql关闭连接出错

> ID：11268994
> 
> 赞同：1
> 
> 时间：2012-06-29T21:09:21.973
> 
> 标签：php, mysql

我有这个用于数据库交互的课程。它工作正常。

```
<?php require_once('inc/config.inc.php'); ?>
<?php
final class MySQL {
private $link;

public function __construct($hostname, $username, $password, $database) {
    if (!$this->link = mysql_connect($hostname, $username, $password)) {
        //error('Error: Could not make a database link using ' . $username . '@' . $hostname);

    }
    if (!mysql_select_db($database, $this->link)) {
        //error('Error: Could not connect to database ' . $database);
    }
    //echo "open". time();
}

public function __destruct() {
    mysql_close(); // Problem In here
    //echo "closed". time();
}
}

$database=new MySQL(DB_SERVER,DB_USER,DB_PASS,DB_NAME);
?> 
```

但是如果我替换 mysql_close(); 用 mysql_close($this->link);

我收到一个错误：警告：mysql_close() 期望参数 1 是资源，给定 null

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T21:14:16.917

我不会使用自制`mysql`包装器，而是使用`PDO`.

如果做不到这一点，PHP 会自行关闭非持久数据库连接。它可能会在调用对象析构函数之前执行此操作，从而避免对该方法的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T21:40:49.880

这个错误的原因很简单：$this->link 是一个资源。并且（引用[文档](http://www.php.net/manual/en/language.types.resource.php#language.types.resource.self-destruct)本身）...

> ...自动检测到不再引用它的资源，并由垃圾收集器释放。因此，很少需要手动释放内存。

换句话说，它在你的`__destruct`方法被调用之前就关闭了。更重要的是，在[mysql_close](http://www.php.net/manual/en/function.mysql-close.php)文档中说：

> 通常不需要使用 mysql_close()，因为非持久打开的链接会在脚本执行结束时自动关闭。

顺便说一句，我通常认为是`__destruct`内部方法（并且很少找到它的用途）：PHP 不是 C++，释放资源的整个概念在这里完全不同（有很多原因）。如果我需要执行一些清理任务，我通常使用[register_shutdown_function](http://php.net/manual/en/function.register-shutdown-function.php)，因为事实证明它更容易预测。

# iphone - 如何检查 sqlite 文件中存在多少表（Objective-C）

> ID：11268998
> 
> 赞同：1
> 
> 时间：2012-06-29T21:09:37.777
> 
> 标签：iphone, objective-c, sqlite, uitableview, persistence

我想要做的是让用户在 sqlite 表中保存数据列表。当用户加载一个 tableview 时，我希望有一个对应于当前存在的每个 sqlite 表的单元格。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T21:11:14.860

SQLite 包含一个名为 sqlite_master 的魔术表，它列出了数据库中的所有表和索引。您可以查询匹配正确类型但不以 SQLite 的簿记前缀开头的条目。

使用这个 SQLite 查询：

```
SELECT
    Count(*)
FROM
    sqlite_master
WHERE
    type = 'table'
    AND (NOT Name LIKE 'sqlite_%'); 
```

或者，如果您想要每个表的名称：

```
SELECT
    Name
FROM
    sqlite_master
WHERE
    type = 'table'
    AND (NOT Name LIKE 'sqlite_%'); 
```