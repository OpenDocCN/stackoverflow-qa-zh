# StackOverflow 问答 000856000-000856999

# asp.net - ASP.NET MVC vs. Webforms vs. HTTP Handlers (.ashx) - 哪个是最轻量级的？

> ID：856006
> 
> 赞同：4
> 
> 时间：2009-05-13T04:02:48.003
> 
> 标签：asp.net, asp.net-mvc, webforms, ashx

我计划构建一个简单但使用率很高的 web 应用程序，并且需要确定一个架构。

*   基本的服务器端逻辑/动态数据库驱动的内容大约六到十几个页面提供所有所说的内容
*   无需 URL 重写，
*   非常简单的页面流/路由

目标是发布此应用程序以使用尽可能少的带宽、内存和 CPU。也就是说，我的选择是

1.  在 ASP.NET MVC 中构建

2.  在禁用视图状态的情况下构建 Web 表单

3.  使用 .ashx 处理程序构建，其代码将所有 HTML 输出连接成它吐出的字符串

**哪个是最轻量级的解决方案？**

到目前为止，我很欣赏这些回应，但我**并不是在寻求最佳解决方案**。这是一个简单的应用程序，我想要使用最少机器/网络资源的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T04:31:07.317

**HttpHandlers** are the most **lightweight** from your list of 3 options.

Personally, I would use ASP.NET MVC because it gives you a richer development environment with very little extra *server* overhead, especially if u *turn most things off* ..

eg. roles, etc.

Also use IIS7 intergrated mode and turn as much IIS7 settings off etc.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T04:24:05.723

HttpHandler 是最轻量级的，因为 ASHX 文件背后的接口是 IHttpHandler，它是用于 Web 窗体和 MVC 的 Page 对象的基础。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T04:09:29.710

省略第三个选项，因为如果应用程序都是使用 HttpHandlers 构建的，则很难控制应用程序。

> 基本的服务器端逻辑/动态数据库驱动内容大约六到

ASP.NET MVC 的主要优点之一是易于分离关注点。+1

> 十几个页面提供所有所说的内容，无需 URL 重写，非常简单的页面流/路由

ASP.NET MVC 将为您提供一个简单的界面来设置您的路线，一个轻量级、清晰且可控的视图。+1

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T04:22:58.003

在大多数情况下，WebForms 将是最重的。与 WebForms 相比，ASP.Net MVC 非常轻巧且速度惊人。

在提供静态内容时，使用 HttpHandlers 构建应用程序来提供页面可能会很快，但是如果您打算使用某种模板来提供动态数据，那么您将给自己带来很多不必要的工作。至于性能，这个选项很难说，因为你的模板可能很糟糕，也可能不是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T04:41:14.477

ASP.NET MVC, Web Forms and the Generic Handler (.ashx) are all HttpHandlers implementing the IHttpHandler interface.

Out of these options the Generic Handler (.ashx) would be the most lightweight.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T04:06:28.997

ASp.NET MVC 尽可能接近 HtTP 和 Html。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T04:08:05.640

您应该使用 MVC，因为与 WebForms 相比，您对生成的客户端代码有更多的控制权，并且比 ashx 处理程序更简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T04:30:13.873

MVC 让您可以更好地控制生成的 HTML。因此，从带宽的角度来看，它肯定具有更好的性能。随之而来的是生成此 HTML 的代码的简洁性。

但是，MVC 并没有提高业务/数据层或数据库性能，它只是将它们分开。如果您想分析，拥有多个层并不能提高性能，只是程序的结构，这反过来可能有助于增加性能的方法。

MVC 的一个缺点是学习如何思考 MVC 和学习如何使用该框架。如果这不是问题，请选择 MVC，它会教你一些好习惯，如果你还没有的话。

最后，HTTP 处理程序并不是真的要以这种方式使用，它们是用于文件代理之类的。

# javascript - Jquery width() 通过迭代？

> ID：856007
> 
> 赞同：0
> 
> 时间：2009-05-13T04:03:20.077
> 
> 标签：javascript, jquery, width, each

我在迭代和检索 width() 值时遇到了一些麻烦。

```
$(".MyClass").each(
    function () {
        elemWidth = $(this).width();
    }); 
```

所以对于每个“MyClass”元素，我想找到宽度（有些是不同的）。

但是上面的代码只产生了 MyClass 的第一个实例的 width() 并在之后返回 0。

关于能够获得 MyClass 每个实例的宽度的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T04:36:34.237

使用`map`而不是`each`简化您的代码：

```
$('.MyClass').map( function() {
    return $(this).width();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T04:07:41.723

```
var widths = [];
$('.MyClass').each(function() {
    widths.push($(this).width());
}); 
```

应该工作得很好。如果您显示更多代码，我可能会找出问题所在。

**更新：**

你什么时候运行这个方法？您是等到 DOM 准备好，还是立即执行它？如果没有，浏览器可能还没有完成所有这些元素的渲染。

如果你还没有，试试这个：

```
var widths = [];
$(document).ready(function() {
    $('.MyClass').each(function() {
        widths.push($(this).width());
    }); 
}); 
```

# c# - LINQ2SQL 事务的性能

> ID：856010
> 
> 赞同：2
> 
> 时间：2009-05-13T04:04:44.897
> 
> 标签：c#, linq-to-sql

我遇到了 LINQ2SQL 和事务的主要性能问题。我的代码使用 IDE 生成的 LINQ2SQL 代码执行以下操作：

运行存储过程检查现有记录如果记录不存在则创建记录运行将自己的代码包装在事务中的存储过程

当我在没有事务范围的情况下运行代码时，我每秒获得 20 次迭代。一旦我将代码包装在事务范围内，它就会下降到每秒 3-4 次迭代。我不明白为什么在顶层添加事务会大大降低性能。请帮忙？

带有事务的伪存储过程：

```
begin transaction
update some_table_1;
insert into some_table_2;
commit transaction;

select some, return, values 
```

没有事务的伪 LINQ 代码：

```
var db = new SomeDbContext();
var exists = db.RecordExists(some arguments);

if (!exists) {
    var record = new SomeRecord 
    {
        // Assign property values
    };

    db.RecordsTable.InsertOnSubmit(record);
    db.SubmitChanges();

    var result = db.SomeStoredProcWithTransactions();
} 
```

带有事务的伪 LINQ 代码：

```
var db = new SomeDbContext();
var exists = db.RecordExists(some arguments);

if (!exists) {
    using (var ts = new TransactionScope()) 
    {
        var record = new SomeRecord 
        {
            // Assign property values
        };

        db.RecordsTable.InsertOnSubmit(record);
        db.SubmitChanges();

        var result = db.SomeStoredProcWithTransactions();
        ts.Complete();
    }
} 
```

我知道交易没有升级到 DTC，因为我已禁用 DTC。SQL Profiler 显示，在启用事务范围的情况下，一些查询需要更长的时间，但我不确定为什么。所涉及的查询非常短暂，并且我已经验证了正在使用的索引。我无法确定为什么添加父事务会导致性能如此下降。

有任何想法吗？

**编辑：**

我已将问题追溯到最终存储过程中的以下查询：

```
if exists 
(
    select * from entries where 
        ProfileID = @ProfileID and 
        Created >= @PeriodStart and 
        Created < @PeriodEnd
) set @Exists = 1; 
```

如果我有如下所示的 with(nolock)，问题就会消失。

```
if exists 
(
    select * from entries with(nolock) where 
        ProfileID = @ProfileID and 
        Created >= @PeriodStart and 
        Created < @PeriodEnd
) set @Exists = 1; 
```

但是，我担心这样做可能会导致问题。有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T05:32:58.497

一旦你得到一个事务，一件大事就会改变——[隔离级别](http://msdn.microsoft.com/en-us/library/system.transactions.isolationlevel.aspx)。您的数据库是否存在激烈争用？如果是这样：默认情况下 a`TransactionScope`处于最高的“可序列化”隔离级别，这涉及读锁、键范围锁等。如果它不能立即获取这些锁，它会在阻塞时减速。您可以通过降低事务的隔离级别（通过构造函数）进行调查。例如（但选择您自己的隔离级别）：

```
using(var tran = new TransactionScope(TransactionScopeOption.Required,
    new TransactionOptions { IsolationLevel = IsolationLevel.Snapshot })) {
    // code
    tran.Complete();
} 
```

然而，选择一个隔离级别是……棘手的；可序列化是最安全的（因此是默认值）。您还可以使用精细提示（但不能通过 LINQ-to-SQL），例如`NOLOCK`帮助`UPDLOCK`控制特定表的锁定。

* * *

您还可以调查减速是否是由于*试图*与 DTC 交谈。启用 DTC 并查看它是否加速。LTM 很好，但我之前见过对单个数据库的复合操作升级到 DTC...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T04:10:33.327

您调用的存储过程是否参与环境（父）事务？- 就是那个问题。

存储过程很可能参与了导致降级的环境事务。这里有一篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms172152.aspx)讨论它们如何相互关联。

来自文章：

“当 TransactionScope 对象加入现有的环境事务时，处置范围对象可能不会结束事务，除非范围中止事务。如果环境事务是由根范围创建的，只有在根范围被处置时，才会提交在事务上调用。如果事务是手动创建的，则事务在它被中止或由其创建者提交时结束。

还有一个关于嵌套事务的严肃文档，看起来它直接适用于[MSDN](http://msdn.microsoft.com/en-us/library/ms189336.aspx)上的本地化。

笔记：

“如果在事务处于活动状态时调用 TransProc，则 TransProc 中的嵌套事务在很大程度上被忽略，其 INSERT 语句将根据对外部事务采取的最终操作提交或回滚。”

我认为这解释了性能的差异——本质上是维护父事务的成本。Kristofer 的建议可能有助于减少开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T04:24:25.847

尽管您使用的是单个数据上下文，但您的代码示例可能会使用多个连接，这会将您的事务升级为分布式事务。

尝试使用显式数据库连接初始化您的数据上下文，或在创建数据上下文后立即调用 db.Connection.Open()。这消除了分布式事务的开销......

# sql-server - 如何让客户了解合格 DBA 的重要性？

> ID：856012
> 
> 赞同：15
> 
> 时间：2009-05-13T04:05:21.697
> 
> 标签：sql-server

我是一家软件开发公司的一员，我们为客户定制开发的应用程序。

我们的软件使用 MS SQL Server，我们遇到了一些客户，他们没有 DBA 来管理数据库，或者如果他们有，他们缺乏必要的知识来充分执行他们的工作。

我们正在与其中一位客户起草一份合同，以便在明年为我们软件的新功能提供开发服务，他们有大量时间可用于定制我们的软件。

现在他们希望我们还包含数据库管理服务的报价，问题是他们包含一个子句，说明这些服务仅在他们请求时提供。

我的第一反应是，数据库管理是一个持续的过程，而不是他们可以每个月打电话给我们一两天的事情。我说的是一个中央 1TB+ MSSql 集群和 100 个带有 MSSql Workgroup 版本的分支机构。

我的问题是关于我如何争辩说每个月必须有固定的 dba 工作时间的任何建议，而不仅仅是当他们的管理层认为他们需要它时（我猜只有当他们有问题时） .

PS：也许这会因为与编程无关而被关闭。但我是一名程序员，我有这个问题。我的工作是软件开发，但我不想失去这个客户，我能想到的唯一解决方案是找到一种方法让客户了解范围，以便我们可以聘请合格的 DBA 为他们提供所需的服务.

编辑：我们在一个拉丁美洲国家，客户在西班牙语地区。我的猜测是，在较发达的国家，有一种文化知道情况有多微妙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T04:10:44.357

在这样大小的系统上没有 DBA 是一场等待发生的灾难。如果他们不理解这一点，他们就没有资格运行这么大的数据库。我建议他们与其他拥有类似规模数据库的公司交谈，并让他们询问他们的 DBA 以及他们为他们做了什么，以及他们是否认为没有他们也能生存下去。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T05:33:18.463

也许下面来自 MS SQL Tips 的链接可以给你一些很好的谈话要点。但是，非技术人员不会对关于优秀 DBA 必要性的技术解释做出回应，您可能不得不努力证明糟糕 DBA 的成本。找出最坏的情况，看看他们对它们的感受。如果你能让它看起来像是一个很好的财务举措（我想我们都知道它是），那么它就会很容易卖出。

[http://www.mssqltips.com/tip.asp?tip=1278](http://www.mssqltips.com/tip.asp?tip=1278 "DBA 清单")

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T05:33:24.330

这绝对是“你可以把马牵到水边，但你不能让它们喝水”的情况之一。

我在这里的建议是按小时报价 DBA 服务，并让价格足够高，以便您可以根据需要外包工作。当（不是如果）SQL 服务器开始出现问题时，公司就会陷入困境。

我还建议您在报价中包含每年一次的非可选 2 小时数据库技术审查。这是你说‘你今年在数据库维护上花费了 XXX 的机会，其中大部分用于扑灭如果你刚刚花费 XXXX/4 并聘请了一名 DBA 就可以轻松避免的火灾。作为客户，我们关心您，希望您能省钱，因此我们真的建议您承诺使用 DBA 来执行定期预防性维护”。

我还建议您将任何支持请求归类为具有数据库维护的根本原因 b/c 与其他原因。这将让您在客户年度审查期间（他们将付钱让您执行）在客户面前放置一个漂亮的饼图。管理感知至关重要，这样他们就不会认为您的代码会导致问题。您甚至可以每季度与他们分享这些指标（数据库相关问题与非数据库相关问题）。

有时人们在改变之前需要经历痛苦。关键是在他们学习课程时不要夹在锤子和拇指之间，每小时引用的工作是这样做的一种方法。

附带说明一下，这类问题引起了许多开发人员的极大兴趣。我想说这种事情对程序员的生活质量的影响比任何算法或库问题都大。谢谢你的提问！

# google-chrome - Google Chrome 中 zip 文件的 Mime 类型

> ID：856013
> 
> 赞同：18
> 
> 时间：2009-05-13T04:05:54.957
> 
> 标签：google-chrome, mime-types

当我处理[Symfony 应用程序](https://stackoverflow.com/questions/852017/set-mimetypes-not-working-for-zip-file-in-symfony)时，我在 zip 文件的 mime 类型中发现了一个奇怪的问题。

根据[w3school](http://www.w3schools.com/media/media_mimeref.asp)，zip 文件的 mime 类型是`application/zip`. 这也是我相信的。

但是当我使用 IE 在 Symfony 应用程序中上传 zip 文件时，该 zip 文件的 mime 类型是`application/x-zip-compressed`. 当我在 Firefox 中上传 zip 文件时，该 zip 文件的 mime 类型是`application/octet-stream`.

没有一个是`application/zip`我愿意相信的。

最奇怪的行为是谷歌浏览器。当我在 Google Chrome 中上传 zip 文件时，我无法确定它的正确 mime 类型。虽然我***很***确定它***不是***

```
application/zip   
application/x-zip
application/octet-stream
application/x-zip-compressed 
```

`sfValidatorFile`Google Chrome 中 zip 文件的 mime 类型是一个空字符串，正如我通过转储返回的对象发现的那样。注意`sfValidatorFile.type`zip 文件是 ""。

但是`sfValidatorFile.type`为 jpeg 文件返回的对象是`jpeg`.

在我看来，Symfony 或 Google Chrome 中都存在错误

更多信息：Gmail 似乎将 zip 文件的 mime 类型解释为 Google Chrome 中的 application/zip。这是正确的行为。似乎确认这是 Symfony 的错误。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-08-29T11:09:39.890

截至目前，一个 zip 文件的 MIME 类型是Google Chrome 中的**application/octet-stream**。:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-13T14:00:28.480

这是 Google Chrome 的错误，而不是 Symfony。我对 Google Chrome 的 ZIP mime 也有同样的问题。

我有自己的用 php 编写的应用程序。

当您编写`echo $_FILES['yournameattr']['type'];`它时，当您上传 zip 文件时返回空字符串，但当您上传 gif 或 jpeg 文件时，它返回 image/jpeg 或 image/gif。

我有 Google Chrome 版本 3.0.195.6（测试版）。

尽管如果您需要快速解决方案，您可以使用 preg_match 来检查文件的扩展名（是否为 zip）。

```
if (preg_match('/(.*)\.zip/',$_FILES['yournameattr']['name'])) {echo 'This is zip.';} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T06:16:27.303

在我看来，Symfony 中有一个错误。

一张票已在[此处](http://trac.symfony-project.org/ticket/6461)打开。

# asp.net - 在 Parallels for mac 中运行 Visual Studio - 位于 os x 驱动器中的调试站点的问题

> ID：856016
> 
> 赞同：2
> 
> 时间：2009-05-13T04:06:31.460
> 
> 标签：asp.net, visual-studio, macos

我已经在我的 MacBook 上安装了 parallels 桌面，以便能够在 XP 安装中运行 Visual Studio 2008。一切都很好，除非我决定将我的网站放在 os x 文件系统中的我的站点文件夹中（默认情况下会自动发生，因为我的文档文件夹映射到 Mac 的文档文件夹，我宁愿把我的代码放在那里两个操作系统都可以轻松访问它。）。

尝试构建或调试时出现此错误：

无法开始监视对“Z:\xxx...”的更改

如何获取它，以便我可以从共享驱动器使其在 Parallels 下工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T16:11:28.187

Parallels 使用网络驱动器来模拟 OS X 上的文件夹，而 Windows 无法监控网络驱动器的变化，所以如果你直接这样做，它会被破坏。

但是，如果您想让它们保持同步，请使用 Live Mesh ( [http://www.mesh.com](http://www.mesh.com) ) 并将其安装在主机和来宾上。有点迂回，但它会做到，所以两个副本都被维护（而且 Live Mesh 也很方便做其他事情）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-10T13:57:54.323

我最近转而将我的源代码放到我的 Mac 卷上，这样我就可以使用 Time Machine 来备份它，并立即在我的 ASP.NET 应用程序中遇到同样的问题。顺便说一句，其他程序应用程序构建得很好。

我尝试了各种方法，包括在 Mac 端使用 Samba 共享目录，这导致了其他地方描述的“BIOS 命令过多”错误。对我来说不幸的是，由于某种原因，用于解决该问题的注册表黑客从未奏效。

我终于找到了另一种避免 Samba 并仅使用常规 Parallels 共享文件夹的解决方案。它也是一个注册表黑客，但这个只是关闭了 ASP.NET 的文件更改监视。这有点笨拙，但让我的构建再次工作。

此更改的参考在这里：

[http://support.microsoft.com/kb/911272](http://support.microsoft.com/kb/911272)

我发现这种方法的缺点是您需要更加谨慎地重新编译或重新启动 Web 服务器，因为开发过程中的更改不再只是神奇地出现。我仍在决定这是否是一个有用的权衡。

更新：几天后，开发太困难了，遗憾的是，我恢复到将源代码保存在 Parallels 虚拟磁盘中。为了启用 Time Machine 备份和 Spotlight 搜索，我使用了一个名为 SyncToy 的轻量级 MS 实用程序，每天数次将内容从 Parallels 推送到我的 Mac 驱动器。尽管黑客因素很高，但它运行良好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T21:19:14.073

我知道这并不是严格意义上的解决方案，但在虚拟机上的共享驱动器空间方面，VMware fusion 更胜一筹。它是我目前使用的，到目前为止还没有让我失望......

当人们在我的 Mac 上看到 Visual Studio 时，他们总是给我奇怪的表情：P

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T08:27:10.817

.NET 在尝试调试网络驱动器上的对象时遇到了有趣的问题。

确保您完全信任 Mac 和 XP 安装之间的本地网络。

查看：http: [//msdn.microsoft.com/en-us/library/aa302361.aspx](http://msdn.microsoft.com/en-us/library/aa302361.aspx)

如果在该研究结束时，恐怕您将不得不考虑将其保留在 VMDisk 上并在需要时移动它的选项。

我在连接到 windows 域的机器上看到了类似的问题。我的文档被映射到网络共享，我无法调试|运行|等。我最终不得不移动到我的本地磁盘进行调试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T20:14:17.827

尝试将项目移动到 VMs C 驱动器。这不是一个理想的情况，但您可以从 OS X 访问 VMs C 驱动器。

我对使用 MS Access 数据库（它的客户端系统）的 php 站点有类似的问题。我有指向 VM 上 php 站点的别名，这样我仍然可以在 OS X 中完成所有编码。为此，我在 VM 上创建了一个网络共享，然后从 OS X 连接到它。连接后，别名的。如果网络驱动器未打开并且您在 OS X 中打开文件，它将尝试重新连接。这意味着需要运行 VM 才能访问文件，但这通常不是问题，因为 VM 无论如何都在托管该站点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T16:02:52.427

我绝对推荐 Live Mesh 作为保持目录同步的一种方式。只需保持 VM 的目录与 Mac 的目录同步即可。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-06T23:04:36.297

或者使用 SVN 在两台机器上保存副本并根据需要进行提交/更新。通过这种方式，您可以获得版本控制、历史记录，并且如果您的项目变得更大，您可以与其他开发人员共享。

我知道保管箱也有历史和共享，但没有签入/签出/冲突以及真正源代码控制的所有其他优势。

哦，如果你有钱，你也可以去TFS。我会，但它太贵了:)

# iphone - 为 iPhone 本地化货币

> ID：856019
> 
> 赞同：16
> 
> 时间：2009-05-13T04:07:57.950
> 
> 标签：iphone, cocoa-touch, localization, currency

我希望我的 iPhone 应用程序允许用户使用适当的符号（$、€、₤、¥ 等）输入、显示和存储货币金额。

NSNumberFormatter 会做我需要的一切吗？当用户切换他们的区域设置并且这些金额（美元、日元等）存储为 NSDecimalNumbers 时会发生什么。我认为，为了安全起见，有必要在输入时以某种方式捕获语言环境，然后捕获货币符号并将它们与 NSDecimalNumber ivar 一起存储在我的实例中，以便它们可以在用户更改时展开并在路上适当显示自创建项目以来的语言环境？

抱歉，我几乎没有本地化经验，因此希望在深入研究之前获得一些快速指导。最后，鉴于 iPhone 键盘的限制，您对如何处理此类输入有任何见解吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-13T13:29:56.207

NSNumberFormatter 绝对是要走的路！您可以在 NSNumberFormatter 上设置 NSLocale，格式化程序将根据该语言环境自动运行。数字格式化程序的默认语言环境始终是用户选择的区域格式的货币。

```
NSDecimalNumber *someAmount = [NSDecimalNumber decimalNumberWithString:@"5.00"];

NSNumberFormatter *currencyFormatter = [[NSNumberFormatter alloc] init];
[currencyFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];

NSLog(@"%@", [currencyFormatter stringFromNumber:someAmount]); 
```

这将根据用户的默认区域格式记录数量“5.00”。如果要更改货币，您可以设置：

```
NSLocale *aLocale = [[NSLocale alloc] initWithLocaleIdentifier: "nl-NL"]
[currencyFormatter setLocale:aLocale]; 
```

它将选择该语言环境的默认货币。

通常，尽管您不是以用户的当地货币收费，而是以您自己的货币收费。要强制`NSNumberFormatter`以您的货币格式化，同时保持用户偏好的数字格式，请使用：

```
currencyFormatter.currencyCode = @"USD"
currencyFormatter.internationalCurrencySymbol = @"$"
currencyFormatter.currencySymbol = @"$" 
```

在 en-US 中，这将像`$5.00`在 nl-NL 中一样格式化为`$ 5,00`.

# iphone - iPhone 移动应用程序（safari）：哪些 javascript 事件（如 onblur、onfocus 或 onbeforeunload）可用？

> ID：856031
> 
> 赞同：2
> 
> 时间：2009-05-13T04:13:13.213
> 
> 标签：iphone, mobile-safari

所以我只是让我的网络应用程序“iPhone 友好”。所以你可以把它添加到你的主屏幕上，它有一个图标，没有镀铬等。

问题是我想在每次从 iPhone 主屏幕打开时显示一个自定义启动画面。现在它只显示最后一次查看的屏幕，而它基本上运行刷新。

我已经尝试将事件附加到 window.onfocus、window.onblur、window.onbeforeunload，当应用程序在“移动应用程序”模式下运行时，它们似乎都无法正常工作。

我是不是很笨？呃……不要回答。有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T04:18:34.343

不幸的是，由于苹果施加的限制，这是不可能的。
我的建议是创建一个具有全屏 WebView 的 App Store 应用程序。然后，您可以使用 default.png 文件和 ImageView 作为初始屏幕。此外，您可以在 App Store 上获得更多的知名度。（另外，如果你走这条路，请查看 PhoneGap - [http://phonegap.com/](http://phonegap.com/)）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-26T01:09:04.053

更新！！在 iPhone 3.0 更新中，移动 safari 现在支持指定要在启动时使用的图像的功能：

请记住，这仅适用于运行 3.0+ 的 iPhone

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T06:06:17.723

您所说的加载屏幕是应用程序的加载屏幕，而不是网页，即 Safari 的加载屏幕。这与“Apple 施加的限制”无关，只是因为您的 Web 应用程序仍在浏览器中运行，因此需要先加载浏览器。就像有人说的那样，如果您想解决这个问题，您需要构建自己的应用程序，您可以在其中指定启动画面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-30T12:10:59.707

你在用这个吗？

```
<meta name="apple-mobile-web-app-capable" content="yes" /> 
```

如果是，则每次退出 Web 应用程序并再次进入时它都应该刷新。它不会显示上次查看的屏幕。因此，您可以在每次打开时显示您的启动画面。换句话说，每次加载页面时都应该显示一个全屏的 div / 图像。

# html - IE 不支持 XHTML 但很多人仍在使用它，这是真的吗？

> ID：856043
> 
> 赞同：2
> 
> 时间：2009-05-13T04:18:43.483
> 
> 标签：html, internet-explorer, xhtml

所以我听说 IE 不支持 XHTML，因此无论如何它都被视为 HTML 4.01，但仍然有很多人仍在使用它……这是真的吗？

一个例子是

<div id="contentForAjax" />

在 XHTML 中，它是自关闭的，但 IE 将它视为不关闭，并弄乱以后的布局。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T04:21:29.860

`application/xhtml+xml`不支持使用推荐的内容类型提供 XHTML 。

有关这方面的更多信息，请参阅[XHTML - 神话和现实](http://www.dev-archive.net/articles/xhtml.html#types)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T04:24:10.077

不，IE 不能正确支持 XHTML。无论如何，很多 XHTML 实际上都是作为 HTML 提供的（即，它具有 text/html MIME 类型并被解析为 HTML）。

WebKit 的 Maciej在 Surfin 的 Safari 博客上发布了一个很好[的 XHTML 支持概要以及它通常是如何解析的。](http://webkit.org/blog/68/understanding-html-xml-and-xhtml/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T17:31:22.847

是的。

Googlebot 也做同样的事情。

# php - 如何限制 JSON 访问？

> ID：856045
> 
> 赞同：32
> 
> 时间：2009-05-13T04:19:22.970
> 
> 标签：php, json, api, rest

我有一个从我新创建的 JSON API 中提取数据的 Web 应用程序。

我的静态 HTML 页面通过 JavaScript 从静态 HTML 页面动态调用 JSON API。

**如何限制对我的 JSON API 的访问，以便只有我（我的网站）可以从中调用？**

如果有帮助，我的 API 类似于：[http](http://example.com/json/?var1=x&var2=y&var3=z) ://example.com/json/?var1=x&var2=y&var3=z ... 它会根据查询生成适当的 JSON。

我正在使用 PHP 生成我的 JSON 结果...限制对 JSON API 的访问是否可以像检查`$_SERVER['HTTP_REFERER']`以确保仅从我的域而不是远程用户调用 API 一样简单？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-13T04:46:26.340

我认为您可能误解了*从用户浏览器*而不是从您自己的服务器发起 JSON 请求的部分。静态 HTML 页面被传递到用户的浏览器，然后它转身并执行页面上的 Javascript 代码。此代码打开一个新连接返回到您的服务器以获取 JSON 数据。从您的 PHP 脚本的角度来看，JSON 请求来自外部世界的某个地方。

鉴于上述机制，您无法阻止任何人在您的 HTML 页面上下文之外调用 JSON API。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-13T04:35:36.420

限制对您的域的访问的常用方法是在内容之前添加无限运行的内容。

例如：

```
while(1);{"json": "here"} // google uses this method
for (;;);{"json": "here"} // facebook uses this method 
```

因此，当您通过 XMLHttpRequest 或任何其他仅限于您的域的方法获取它时，您知道您需要解析出无限循环。但如果它是通过脚本节点获取的：

```
<script src="http://some.server/secret_api?..."></script> 
```

它会失败，因为脚本永远不会超出第一条语句。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T05:51:26.703

在我看来，你不能限制访问，只能让它变得更难。这有点像默默无闻的访问限制。推荐人可以很容易地伪造，即使使用短暂的密钥，脚本也可以通过不断刷新密钥来获得响应。

那么，我们*能*做些什么呢？

找出这里的弱点：

> [http://www.example.com/json/getUserInfo.php?id=443](http://www.example.com/json/getUserInfo.php?id=443)

攻击者现在可以轻松地循环请求从 1 到 1.000.000 的所有用户信息。*ID的弱点`auto_increment`是它们的线性并且它们很容易被猜到*。

**解决方案：**为您的数据使用非数字唯一标识符。

> [http://www.example.com/json/getUserInfo.php?userid=XijjP4ow](http://www.example.com/json/getUserInfo.php?userid=XijjP4ow)

你不能循环这些。诚然，您仍然可以解析 HTML 页面以获取各种密钥的密钥，但是这种类型的攻击是不同的（并且更容易避免的）问题。

**缺点：**当然，您不能使用此方法来限制不依赖于键的查询，例如搜索。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-13T04:25:10.277

如果您使用 API 的静态页面需要在公共 Internet 上，那么这里的任何解决方案都将是不完美的。由于您需要能够让客户端的浏览器发送请求并得到响应，因此几乎任何人都可能确切地看到您是如何形成该 URL 的。

您可以让 API 背后的应用程序检查 http 引荐来源网址，但如果有人愿意，这很容易伪造。

如果页面不要求是静态的，您可以尝试一些方法，让 API 生成一个短暂的“密钥”并包含在第一页的 HTML 响应中，该响应作为参数传递回API。这会增加 API 的开销，因为您必须让该端的服务器维护有效的“密钥”列表、它们的有效时间等。

所以，你可以采取一些不会花费很多但如果有人真的想要的话也不会很难绕过的步骤，或者你可以花更多的时间让它变得更难一点，但没有完美的方法可以做到如果你的 API 必须是可公开访问的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-13T04:31:59.143

简短的回答是：任何可以访问您网站页面的人也可以访问您的 API。

您可以尝试通过以各种方式加密 API 来增加使用 API 的难度，但由于您必须包含用于解密 API 输出的 JavaScript 代码，因此您只是在为自己的军备竞赛做准备任何决定通过其他方式使用您的 API 的人。即使您使用短暂的密钥，一个坚定的“攻击者”也总是可以在使用 API 之前抓取您的 HTML（连同当前密钥）。

如果您只想阻止其他网站在其网页上使用您的 API，那么您可以使用 Referrer 标头，但请记住，并非所有浏览器都会发送 Referrer（有些代理也会删除它们！）。这意味着您希望允许所有缺少引用者的请求，而这只会给您部分保护。此外，Referrer 很容易被伪造，因此如果其他网站*真的*想使用您的 API，他们总是可以欺骗浏览器并从他们的服务器访问您的 API。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-07-12T18:03:44.450

抱歉，网上没有 DRM :-)

您不能将 HTML 视为受信任的客户端。这是一个在其他人的计算机上按照他们认为合适的方式解释的纯文本脚本。无论您允许什么“自己的”JavaScript 代码，您都允许任何人。你甚至无法用[Greasemonkey](http://en.wikipedia.org/wiki/Greasemonkey)和[Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29)在野外定义它是“你的”多长时间。

您必须在服务器中复制所有访问控制和业务逻辑限制，就好像它们都不存在于您的 JavaScript 客户端中一样。

将服务包含在您的 SSO 中，限制每个用户可以访问的 URL，设计服务时将 wget 牢记在心，而不是您表现良好的 JavaScript 代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-26T15:55:30.977

抱歉，也许我错了，但是...可以使用 HTTPS 制作吗？

您可以（？）通过 http **s** ://example.com/json/?var1=x&var2=y 访问您的 API，因此只有经过身份验证的消费者才能获取您的数据...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-30T21:04:51.543

您是，还是可以使用基于 cookie 的身份验证？我的经验是基于 ASP.NET 表单身份验证，但同样的方法在 PHP 上应该是可行的，只需要一点代码。

基本思想是，当用户通过 Web 应用程序进行身份验证时，将具有加密值的 cookie 返回给客户端浏览器。然后，json api 将使用该 cookie 来验证调用者的身份。

这种方法显然需要使用 cookie，因此这对您来说可能是也可能不是问题。

# javascript - Javascript中的Cookie（登录页面设计）

> ID：856047
> 
> 赞同：-1
> 
> 时间：2009-05-13T04:21:25.040
> 
> 标签：javascript, authentication, cookies

以前我发布了一个程序并询问有关在 Javascript 中处理 cookie 的问题。我已经发布了一个代码，你可以在我的另一个问题中找到它。许多人给出了很好的答案，我也尝试了他们的解决方案。但由于我是这个 html 和 javascript 的新手，我可能不知道如何找到错误并调试它。

所以任何人都可以请发布他们对这个问题的解决方案。我想要创建一个网页，它应该在加载时检查 cookie。如果 cookie 早了 20 分钟，它必须进入登录页面（询问用户名和密码）。否则不需要登录，它应该直接进入一个页面（它正在设计中）。

因此，如果有人已经拥有类似或确切的代码（在此时间 cookie 被维护），请发布它。

问候柴特拉

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T04:28:01.347

听起来您正在尝试使用 javascript 实现登录系统。如果是这种情况，请**停止**。所有形式的身份验证都应在服务器端进行，您可以使用会话来确定自该帐户的活动以来已经过了多长时间。“破解”客户端（例如：javascript）安全措施非常容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T05:03:26.267

正如 nickf 所说，会话超时最好由服务器端处理。cookie 的存在用于定位会话，而不是实现超时。会话 cookie 通常用于跟踪会话状态 - 而不是过期的。只要浏览器打开，它们就会持续存在。

服务器端在处理请求时，使用 cookie 的值（通常是一个长的随机的、难以猜测的字符串）来定位用户的会话。如果会话不存在，它可以响应重定向到登录页面。

编辑：在您说您正在使用 goAhead 的评论中 - 我无法访问他们的 wiki，但假设它接近 Microsoft 的 ASP，请参阅[webmaster-talk 的 asp-forum](http://www.webmaster-talk.com/asp-forum/8670-asp-login-and-session-object-problems.html)中的此链接以获取有关如何处理登录的示例。登录页面需要注意的部分是：

```
 session("UserID") = rs.Fields("usrName") 
```

并且检查每个页面加载会话的部分仍然很好是：

```
 if (session("UserID") = "") then
        response.redirect("default.asp") 
```

这就像我在下面的注释中概述的那样，从服务器端驱动超时检测并让框架（在您的情况下为 goAhead）执行所有 cookie 魔术并在不活动时超时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T05:21:47.673

简短的回答 -[这是一个很好的教程......点击这里......](http://www.ineedtutorials.com/code/php/complete-advanced-login-member-system-php-tutorial)

更好的答案 - 如果您要创建一个登录系统，您需要了解 cookie、会话、表单和**安全性**（注入！！！），然后再开始实施任何用于认真使用的东西。您应该知道在开始之前避免为诸如登录之类的事情编写客户端脚本。我建议你继续看教程。您可能想查看不同语言之间的差异以及何时最好使用哪种语言。

# assembly - 如何使用汇编 (NASM) 从 CD-ROM 将内核加载到内存中

> ID：856050
> 
> 赞同：4
> 
> 时间：2009-05-13T04:22:47.940
> 
> 标签：assembly, operating-system, kernel, nasm, bootstrapping

我正在为自己编写一个引导程序和内核，引导程序和内核都将刻录在 CD-R 上，并将用作 CD-live。它不是 linux CD-Live 或其他东西，完全是我自己的引导程序和内核。我不想使用其他的加载程序（即 GRUB），所以请不要建议我使用它们。

这是我的问题：在我的引导加载程序 ASM 代码中，我想将我的内核和内核条目**从 CD-ROM**（而不是从硬盘或软盘）加载到 RAM 中，并假设我们知道内核的确切位置在CD-ROM（扇区号）。据我所知，我必须使用 int 0x13, AH = 02h 将扇区从驱动器读取到 RAM 中。为了使用这个中断服务，我必须设置几个寄存器，我将在下面列出： 参数：AH 02h AL Sectors To Read Count CX Track + Sector / See remark DH Head DL Drive ES:BX Buffer Address Pointer

我的问题是关于 DL 和 DH。为了指向要读取的第一个硬盘驱动器，我们可以将其设置为 80h，或者对于软盘，我们可以将其设置为 00h。但是我想从 CD-ROM 中读取，但我不知道我必须为 DH 和 DL 使用什么值。

为了**从 CD-ROM 读取**几个扇区**到 RAM**，它是一个正确的中断（int 0x13）吗？如果是，我应该为 DH 和 DL 赋予什么价值。

问候， 波利亚。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T16:09:40.173

要让 BIOS 从 CD 加载引导扇区，您需要使用[“El Torito”](http://en.wikipedia.org/wiki/El_torito)标准使 CD 可引导。

一旦你使用它，你有两个选择
。模拟 - BIOS 模拟软盘或硬盘驱动器，您可以通过设备 00 或设备 80 的 INT13 调用来读取内核。
b．该设备不模拟，您可以使用 INT13 ExtendedRead 功能直接从 CD 读取。

要了解这是如何完成的，请查看 Linux “ISOLINUX”加载程序 - [ISOLINUX.ASM](http://git.kernel.org/?p=boot/syslinux/syslinux.git;a=blob;hb=HEAD;f=core/isolinux.asm)

为了为您的问题提供更具体的起点，El Torito 规范，第 5.3 节：

```
Once the system jumps to segment:0, the program can retrieve its boot
information by issuing INT 13, Function 4B, AL=01\.  After the boot process
has been initiated the INT 13 Extensions (functions 41-48) will access the
CD using 800 byte sectors and the LBA address provided to INT 13 is an
absolute sector number. This gives any program running in no emulation mode
the ability to locate the boot catalog, and any other information on the
CD, without providing a device driver. 
```

# wiki - 可换肤维基

> ID：856058
> 
> 赞同：0
> 
> 时间：2009-05-13T04:25:14.270
> 
> 标签：wiki, themes, skin

有没有可以用 html/css/images 换肤的 wiki？我们已经完成了为博客（wordpress）和我们的应用程序获取自定义 html 的过程，并且希望能够将这些设计与 wiki 一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T04:29:51.593

[Mediawiki](http://www.mediawiki.org/wiki/Skinning)对皮肤相当灵活，需要付出一些努力。例如，加拿大一个叫[Paul Gu](http://paulgu.com/wiki/Mediawiki_Skins)的人做了一些。其他一些 MediaWiki 皮肤和画廊：

*   [paulgu.com/wiki/Mediawiki_Skins](http://paulgu.com/wiki/Mediawiki_Skins)
*   [mediawiki2u.com](http://mediawiki2u.com)
*   [mediawiki.org/wiki/Gallery_of_user_styles](http://www.mediawiki.org/wiki/Gallery_of_user_styles)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-25T17:47:11.920

TWiki 有许多基于 CSS 的皮肤：

[http://twiki.org/cgi-bin/view/Plugins/SkinPackage](http://twiki.org/cgi-bin/view/Plugins/SkinPackage)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T04:27:45.623

[维基百科使用的 Wiki 软件Mediawiki](http://www.mediawiki.org/)是可换肤的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-19T02:27:19.057

尝试将[dooWiki](http://doowikis.com)嵌入您想要换肤的页面之一。它只是用于 HTML 发布的 SaaS，因此它采用您提供的任何 CSS。

# visual-studio-2008 - 刷新 DBML 图？

> ID：856063
> 
> 赞同：12
> 
> 时间：2009-05-13T04:28:57.977
> 
> 标签：visual-studio-2008, linq-to-sql

非常愚蠢的问题，抱歉，但我在谷歌上找不到它（我确定它在截屏视频或其他地方）。我有一个 DBML（linq2sql 类）图，并且我已经更改了底层数据库。在 VS2008 中，如何“刷新”图表？没有 View-->Refresh 或 RightClick->Refresh 或 Update 选项。

就目前而言，每次更新底层数据库时，我都必须重新创建整个 linq2sql 类。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T04:30:55.900

右键单击并选择“运行自定义工具”（在 dbml 文件的解决方案资源管理器中）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-06T12:28:29.893

如果您想将数据库更改带入您的 DBML 图表，那么您可以：

a) 从设计器图中删除更改的实体并重新拖动它们。您将丢失任何自定义项（例如类和属性名称更改等）。

b) 手动更新图表、添加/删除类、成员属性等。

c) 使用能够将 DBML 文件与底层数据库进行比较和更新的第三方工具。我的插件就是这样一个工具，[Huagati DBML/EDMX Tools](http://www.huagati.com/dbmltools/)。它为 VS2008 和 VS2010 中的 L2S 设计器添加了一系列功能，包括更新/同步、比较、批量重命名、命名规则实施、来自扩展属性/索引/等的文档、每个 dbml 图表的多个“视图”等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T20:57:09.190

首先，您必须将 .sdf 文件更新为 .dbml 文件。我通过打开 cmd 提示符并指定与 SqlMetal.exe 路径相同的路径来做到这一点。之后将目录更改为 .sdf 数据库所在的位置，然后输入“SqlMetal.exe (nameofdatabase).sdf /dbml:(nameofdatabase).dbml”。右键单击并选择“运行自定义工具”（在 dbml 文件的解决方案资源管理器中）。应该这样做（至少对我来说是这样）。

# ruby-on-rails - Active Record 模型的动态表名

> ID：856064
> 
> 赞同：1
> 
> 时间：2009-05-13T04:29:15.730
> 
> 标签：ruby-on-rails, activerecord

我有一个有趣的 Active Record 问题，我不太确定最干净的解决方案是什么。我正在与之集成的旧数据库在其架构中有一个奇怪的皱纹，其中一个逻辑表已被“分区”为多个物理表。每个表具有相同的结构，但包含有关不同项目的数据。

我不擅长清楚地解释这一点（如你所知！）。让我试着用一个具体的例子来解释。假设我们有一辆汽车，它有一个或多个车轮。通常我们会用 Car 表和 Wheels 表来表示，如下所示：

```
CREATE TABLE cars (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(255),
  ;etc
)

CREATE TABLE wheels (
  `id` int(11) NOT NULL auto_increment,
  `car_id` int(11) NOT NULL,
  `color` varchar(255),
  ;etc
) 
```

到目前为止，一切都很好。但是使用我的旧数据库中的“分区”策略，它看起来更像：

```
CREATE TABLE cars (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(255),
  ;etc
)

CREATE TABLE car_to_wheel_table_map (
  `car_id` int(11) NOT NULL,
  `wheel_table` varchar(255)
)

CREATE TABLE wheels_for_fords (
  `id` int(11) NOT NULL auto_increment,
  `car_id` int(11) NOT NULL,
  `color` varchar(255)
)

CREATE TABLE wheels_for_buicks (
  `id` int(11) NOT NULL auto_increment,
  `car_id` int(11) NOT NULL,
  `color` varchar(255)
)

CREATE TABLE wheels_for_toyotas (
  `id` int(11) NOT NULL auto_increment,
  `car_id` int(11) NOT NULL,
  `color` varchar(255)
) 
```

所以这里我们有一组wheels_for_x 表和一个car_to_wheel_table_map 表，其中包含从car_id 到特定wheels_for_x 的映射，其中包含特定汽车的轮子。如果我想为一辆车找到一组轮子，我首先必须通过 car_to_wheel_table_map 表找出要使用的轮子表，然后在 car_to_wheel_table_map 中指定的轮子表中查找记录。

首先，有人能告诉我这种技术是否有标准名称吗？

其次，是否有人对我如何以一种干净整洁的方式在 Active Record 中进行这项工作有任何指示。我看到它的方式可以有一个 Wheel 模型，其中可以为每个实例定义表名，或者我可以在运行时使用映射表中指定的正确表名动态创建模型类。

**编辑**：请注意，将架构更改为更接近 AR 想要的不是一种选择。各种遗留代码库依赖于这个模式，实际上无法修改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T05:36:47.303

数据库表分区确实是很常见的做法。如果有人以前没有这样做过，我会感到惊讶。ActsAsPartitionable 怎么样？[http://revolutiononrails.blogspot.com/2007/04/plugin-release-actsaspartitionable.html](http://revolutiononrails.blogspot.com/2007/04/plugin-release-actsaspartitionable.html)

另一种可能性：您的 DBMS 可以假装分区是一个大表吗？我认为 MySQL 支持这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T22:58:47.947

这个怎么样？（这是要点： http: [//gist.github.com/111041](http://gist.github.com/111041)）

```
#!/usr/bin/env ruby
%w|rubygems active_record irb|.each {|lib| require lib}
ActiveSupport::Inflector.inflections.singular("toyota", "toyota")

ActiveRecord::Base.logger = Logger.new(STDOUT)
ActiveRecord::Base.establish_connection(
  :adapter => "sqlite3",
  :database => ":memory:"
)

ActiveRecord::Schema.define do
  create_table :cars do |t|
    t.string :name
  end

  create_table :car_to_wheel_table_map, :id => false do |t|
    t.integer :car_id
    t.string :wheel_table
  end

  create_table :wheels_for_fords do |t|
    t.integer :car_id
    t.string :color
  end

  create_table :wheels_for_toyotas do |t|
    t.integer :car_id
    t.string :color
  end
end

class Wheel < ActiveRecord::Base
  set_table_name nil
  belongs_to :car
end

class CarWheelMap < ActiveRecord::Base
  set_table_name "car_to_wheel_table_map"
  belongs_to :car
end

class Car < ActiveRecord::Base
  has_one :car_wheel_map
  delegate :wheel_table, :to => :car_wheel_map

  def wheels
    @wheels ||= begin
      the_klass = "#{wheel_table.classify}Wheel"
      eval <<-END
        class #{the_klass} < ActiveRecord::Base
          set_table_name "wheels_for_#{wheel_table.pluralize}"
          belongs_to :car
        end
      END

      self.class.send(:has_many, "#{wheel_table}_wheels")
      send "#{wheel_table}_wheels"
    end
  end
end

rav4 = Car.create(:name => "Rav4")
rav4.create_car_wheel_map(:wheel_table => "toyota")

fiesta = Car.create(:name => "Fiesta")
fiesta.create_car_wheel_map(:wheel_table => "ford")

rav4.wheels.create(:color => "red")
fiesta.wheels.create(:color => "green")

# IRB.start if __FILE__ == $0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T14:15:44.010

这是您可以做到的一种方法。基础知识（在 70 行代码之前）是：

*   为每种汽车类型创建一个 has_many
*   定义一个方法“wheels”，它使用关联中的表名来获取正确的轮子

如果您有任何问题，请告诉我

```
#!/usr/bin/env ruby
%w|rubygems active_record irb|.each {|lib| require lib}
ActiveSupport::Inflector.inflections.singular("toyota", "toyota")
CAR_TYPES = %w|ford buick toyota|

ActiveRecord::Base.logger = Logger.new(STDOUT)
ActiveRecord::Base.establish_connection(
  :adapter => "sqlite3",
  :database => ":memory:"
)

ActiveRecord::Schema.define do
  create_table :cars do |t|
    t.string :name
  end

  create_table :car_to_wheel_table_map, :id => false do |t|
    t.integer :car_id
    t.string :wheel_table
  end

  CAR_TYPES.each do |car_type|
    create_table "wheels_for_#{car_type.pluralize}" do |t|
      t.integer :car_id
      t.string :color
    end
  end
end

CAR_TYPES.each do |car_type|
  eval <<-END
    class #{car_type.classify}Wheel < ActiveRecord::Base
      set_table_name "wheels_for_#{car_type.pluralize}"
      belongs_to :car
    end
  END
end

class Car < ActiveRecord::Base
  has_one :car_wheel_map

  CAR_TYPES.each do |car_type|
    has_many "#{car_type}_wheels"
  end

  delegate :wheel_table, :to => :car_wheel_map

  def wheels
    send("#{wheel_table}_wheels")
  end
end

class CarWheelMap < ActiveRecord::Base
  set_table_name "car_to_wheel_table_map"
  belongs_to :car
end

rav4 = Car.create(:name => "Rav4")
rav4.create_car_wheel_map(:wheel_table => "toyota")
rav4.wheels.create(:color => "red")

fiesta = Car.create(:name => "Fiesta")
fiesta.create_car_wheel_map(:wheel_table => "ford")
fiesta.wheels.create(:color => "green")

IRB.start if __FILE__ == $0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-28T05:17:43.770

可悲的是，我知道你的烦恼。想对数据库中的表进行分区的人一定被你的老板解雇并被我雇用了;-)

无论如何，解决方案（通过 RailsForum）： [http ://railsforum.com/viewtopic.php?id=674](http://railsforum.com/viewtopic.php?id=674)

是使用尼克博士的魔法模型。

干杯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T08:37:48.193

我会与模型中的自定义函数进行这种关联：

```
has_one :cat_to_wheel_table_map

def wheels
  Wheel.find_by_sql("SELECT * FROM #{cat_to_wheel_table_map.wheel_table} WHERE car_id == #{id}")
end 
```

也许您可以使用与 :finder_sql 的关联来做到这一点，但我不确定如何将参数传递给它。我使用了模型 Wheel，如果您希望 ActiveRecord 映射您的数据，您必须定义它。可能您可以从现有的一张带轮子的桌子上制作这个模型。

而且我没有测试它;)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-30T03:02:23.267

假设1：你知道你在看什么类型的车，所以你可以判断它是福特还是道奇。

让我们将汽车品牌放入一个名为（所有事物的）品牌的属性中。您应该稍后将其标准化，但现在让我们保持简单。

```
CREATE TABLE cars (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(255),
  'make' varchar(255),
  #ect
)

class Wheel < ActiveRecord::Base
   def find_by_make(iMake)
       select("wheels_for_#{iMake}.*").from("wheels_for_#{iMake}");
   end
 #...
end 
```

您可以在其中添加一些保护来验证和缩小您的 iMake。您还可以做一些事情来确保您的表存在。

现在写信给桌子..我不确定那会如何工作。我只读过它。也许它也很简单。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-13T04:46:50.133

为什么不简单地将所有轮子放在一张桌子上并使用标准：has_many？您可以在迁移中执行此操作：

1.  创建新的轮子表
2.  将其他表中的数据迁移到新创建的表中
3.  删除旧表

# sql - Using Environment variables in T-SQL

> ID：856073
> 
> 赞同：9
> 
> 时间：2009-05-13T04:30:27.617
> 
> 标签：sql, sql-server-2005, environment-variables

How can I read the value of a system environment variable in a T-SQL script?

This is to run on SQL Server 2005.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-27T17:43:27.707

To "read the value of a system environment variable in a T-SQL script" you can set SQL Management Studio to use "sqlcmd Mode".

Then you can use like this:

```
Print '$(TEMP)'

:r $(Temp)\Member.sql
go 
```

I'm not sure how this is done outside of "SQL Management Studio" but it should be hard to find out.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T04:37:11.987

This should give you a list (provided you allow people to execute xp_cmdshell)

exec master..xp_cmdshell 'set'

Note: xp_cmdshell is a security hazard ...

You could also do this with a managed stored proc an extended stored proc or via a com component.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-10T14:57:05.320

Hey, if you want to get the server name, just call `SELECT @@SERVERNAME`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T05:04:56.700

xp_cmdshell is generally best avoided for security reasons.

You're better off using a CLR assembly. Here's a good introduction to [creating a CLR assembly](http://msdn.microsoft.com/en-us/library/ms254956(VS.80).aspx).

You can use System.Environment.GetEnvironmentVariable() in C# - you'll find more info on how to do that [here](http://msdn.microsoft.com/en-us/library/system.environment.getenvironmentvariable.aspx).

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T05:13:10.400

Thanks for the answers. They helped me get to a working solution, although this is probably not the most advanced method:

```
declare @val varchar(50)
create table #tbl (h varchar(50))
insert into #tbl exec master..xp_cmdshell 'echo %computername%'
set @val = (select top 1 h from #tbl)
drop table #tbl 
```

Specifically I was trying to get the hostname, the echo %computername% could be replaced with the *hostname* system command. But this now works for any environment variable.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-09-10T15:11:17.357

To determine a specific environment variable in T-SQL (MS SQL Server) you can do something like:

**Grant Security Permissions**

```
use [master]

execute sp_configure 'show advanced options', 1
reconfigure
go

execute sp_configure 'xp_cmdshell', 1
reconfigure
go

grant execute on xp_cmdshell to [DOMAIN\UserName]

grant control server to [DOMAIN\UserName]
go 
```

Source: [https://stackoverflow.com/a/13605864/601990](https://stackoverflow.com/a/13605864/601990)

**Use Environment Variables**

```
-- name of the variable 
declare @variableName nvarchar(50) = N'ASPNETCORE_ENVIRONMENT'

-- declare variables to store the result 
declare @environment nvarchar(50)
declare @table table (value nvarchar(50))

-- get the environment variables by executing a command on the command shell
declare @command nvarchar(60) = N'echo %' + @variableName + N'%';
insert into @table exec master..xp_cmdshell @command;
set @environment = (select top 1 value from @table);

-- do something with the result 
if @environment = N'Development' OR @environment = N'Staging'
    begin
    select N'test code'
    end
else 
    begin
    select N'prod code'
    end 
```

Also remember to *restart the SQL Server Service* when changing the Environment Variables.

# database - 通用数据库表

> ID：856075
> 
> 赞同：2
> 
> 时间：2009-05-13T04:30:44.073
> 
> 标签：database, entity-attribute-value

以下数据库表设计是否有任何名称：

基本上我们有代表键/值对的通用列。

## 编号 | k1 | v1 | k2 | v2 | k3 | v3 | ……

1 | 姓名 | 山姆 | 姓氏| 史密斯 | 空 | 空 | ...

在我的应用程序中，我有许多只有一行的表，我想将它们合并到一个通用表中，该表有 X 列，每行代表单个表行。

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T04:33:25.380

[实体-属性-值。](http://en.wikipedia.org/wiki/Entity-attribute-value_model) 也称为“名称-值表”或“开放模式”。

这是一个[SQL 反模式](http://www.slideshare.net/billkarwin/sql-antipatterns-strike-back)。它不符合关系数据库设计的许多规则，并且难以维护。我建议反对。

[在我对“产品表，多种产品，每个产品都有很多参数](https://stackoverflow.com/questions/695752/#695860)”的问题的回答中，可以看到更多我对 EAV 的想法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T04:35:47.950

馊主意。基本上，您应该将关系数据库用作关系数据库。

键/值对通常不是建议的存储方法，但至少具有单个键和单个值的单行是“正确的”。

如果将多对放在一行中，则会引发许多问题：

1.  如何找到特定的钥匙？
2.  该密钥可以在 k1、k2 或 k3 中吗？或者它总是在一个特定的列中？
3.  你如何执行？
4.  你如何让它变得高效？

将您的实体建模为具有已知属性的实体。这就是数据库的用途。

# c# - 使用手工加密 (ASP.NET) 加密 Cookie 的问题

> ID：856082
> 
> 赞同：0
> 
> 时间：2009-05-13T04:34:45.330
> 
> 标签：c#, asp.net

我面临一个奇怪的问题：

我正在加密 cookie 的内容。

当我在 Visual Studio 中运行我的代码时，它运行良好，但给了我“错误请求，HTTP 错误 400。请求格式错误。” 当我从服务器运行它时。

这是加密类 Encrypt Cook.cs，位于 app_code 中：

```
public class EncryptCook
{
public EncryptCook()
{
    //
    // TODO: Add constructor logic here
    //
}

public  string EncryptString(string data)
{
    try
    {
        string encryptString = "";
        if (data != "")
        {
            char a;
            int key = Convert.ToInt16(DateTime.Now.Day);
            int j = 0;

            for (int i = 0; i < data.Length; i++)
            {

                j = (int)data[i];
                j = j + key;
                a = (char)j;
                encryptString = encryptString + Convert.ToString(a);

            }
        }
        return encryptString;
    }
    catch
    {
        return "";
    }
}

public   string DeEncryptString(string data)
{
    try
    {
        string encryptString = "";
        if (data != "")
        {

            char a;
            int j = 0;
            int key = Convert.ToInt16(DateTime.Now.Day);
            for (int i = 0; i < data.Length; i++)
            {

                j = (int)data[i];
                j = j - key;
                a = (char)j;
                encryptString = encryptString + Convert.ToString(a);

            }
        }
        return encryptString;
    }
    catch
    {
        return "";
    }

} 
```

很简单，它接受一个字符串，从中提取字符并用另一个字符替换该字符，例如，给定“a”并且今天的日期是 13，它将用“a”之后的第 13 个字符替换它，即“米”。

这是我的登录控件：

```
protected void Button1_Click(对象发送者，EventArgs e)
{
//检索用户的代码，工作正常
EncCook 厨师=新 EncCook();
HttpCookie cookie = new HttpCookie("登录状态");
            cookie["userid"] =cook.EncryptString(name);
            cookie["用户名"] = cook.EncryptString(医生);
            cookie["email"] = cook.EncryptString(email);
            cookie["address"] = cook.EncryptString(address);
 Response.Cookies.Add(cookie);
}

```

好吧，这段代码在本地机器上运行良好，但给了我一个“错误的请求 HTTP 错误 400。请求格式错误。” 错误。

我认为这是因为编码，但我不确定，如果它今天是 20 那么 ~ + 20 看起来像一个盒子字符。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T04:39:24.700

请不要使用自制加密。只能以尴尬收场。如果你捕捉到一个异常，你可能应该重新抛出它或返回 null，而不是空字符串。该错误可能是因为您所谓的加密正在创建在当前字符集中无效的字节序列。

# c# - 是否可以将列表添加到结构中？

> ID：856086
> 
> 赞同：7
> 
> 时间：2009-05-13T04:35:54.940
> 
> 标签：c#, list, data-structures

是否可以将列表添加到结构中？

```
public struct test
{
    public string x;
    list<string> y = new list<string>();
} 
```

类似的东西？

我一直在尝试，但我就是不明白

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T04:43:11.683

是的，您可以在 struct 中有一个列表，但您不能使用字段初始化程序对其进行初始化，而是必须使用构造函数。

```
struct MyStruct
{
    public List<string> MyList;
    public int MyInt;

    public MyStruct(int myInt)
    {
        MyInt = myInt;
        MyList = new List<string>();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T04:39:12.623

struct 可以有一个构造函数，您可以在构造函数中实例化列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T04:39:32.390

我不是 C# 方面的专家，但结构只是您的记忆外观的原型。您必须声明一个结构变量才能执行“new list()”并将其分配给列表变量。

类似 struct test a; ay = 新列表（）；

我从来没有用 C# 编程过，所以请将我的 C 语法转换为 C#。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T04:42:02.823

你可以这样做 - 为结构声明一个构造函数并在结构构造函数中创建一个列表实例。您不能按照代码片段中的建议使用初始化程序。

# struts2 - 拦截器在struts2中的动作之前执行的问题

> ID：856095
> 
> 赞同：0
> 
> 时间：2009-05-13T04:39:22.437
> 
> 标签：struts2

我正在研究struts2。我有一个在我的动作 claas 之前执行的拦截器。现在，当我在 jsp 页面上提交时，控件转到拦截器，经过一些处理后，控件转到操作类。这个完整的流程运行良好。但我发现了两件事——

1) 控制在进入动作类之前不会进入action-validation.xml。

2）在提交之前，它没有得到使用的文本字段等的值已经进入jsp页面。

谁能告诉我如何为这两点找到解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T13:01:50.923

我将查看您在 struts.xml 中定义拦截器的顺序。您需要确保您有一个 params 拦截器（至少 1 个，模型驱动模式需要 2 个）和一个在正确位置定义的验证拦截器。我通常会复制默认堆栈（[在此处](http://struts.apache.org/2.0.14/docs/struts-defaultxml.html)定义），然后根据需要对其进行修改。也许您可以将拦截器堆栈定义添加到您的问题中？

# sql - 从 select 语句中调用函数 - SQL

> ID：856098
> 
> 赞同：1
> 
> 时间：2009-05-13T04:40:28.207
> 
> 标签：sql, sql-server, performance, user-defined-functions

我有以下声明：

```
SELECT CASE WHEN (1 = 1) THEN 10 ELSE dbo.at_Test_Function(5) END AS Result 
```

我只是想确认在这种情况下该功能不会被执行？

我问的原因是该函数特别慢，如果条件是真的，我想避免调用该函数......

干杯安东尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T05:09:14.323

你的假设是正确的——它不会被执行。我理解您的担忧，但 CASE 构造以这种方式是“智能的”——它不会在第一个有效条件之后评估任何条件。这是一个证明它的例子。如果要执行此 case 语句的两个分支，您将收到“除以零”错误：

```
SELECT  CASE
                WHEN 1=1 THEN 1
                WHEN 2=2 THEN 1/0
            END AS ProofOfConcept 
```

这有意义吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T16:44:49.193

不要做这个假设，这是**错误**的。查询优化器可以完全自由地选择它喜欢的评估顺序，并且 SQL 作为一种语言不提供运算符短路。即使您可能在测试中发现该函数从未被评估，但在生产中您可能会时不时地遇到导致服务器选择不同执行计划并首先评估函数，然后是表达式的其余部分的条件。一个典型的例子是，当服务器注意到函数返回是确定性的并且不依赖于行数据时，在这种情况下，它会首先评估函数以获取值，然后*开始*扫描表并评估 WHERE 包含条件使用预先确定的函数值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T05:05:12.083

假设你正在做某种测试......如果你想避免 at_Test_Function，为什么不把它注释掉然后做

```
SELECT 10 AS Result 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T05:08:33.670

将 a`WaitFor Delay '00:00:05'`放入函数中。如果语句立即返回，则如果需要 5 秒才能返回，则它没有执行，则它已被执行。

# c# - 禁用视图中的所有控件（文本框、复选框、按钮等）（ASP.NET MVC）

> ID：856099
> 
> 赞同：6
> 
> 时间：2009-05-13T04:41:07.770
> 
> 标签：c#, asp.net, asp.net-mvc

在呈现视图页面时，根据控制器操作中的某些条件，我想禁用 MVC 视图页面中表单中存在的所有控件（文本框、复选框、按钮等）。有没有办法做到这一点？请帮忙。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T04:55:14.220

您可以将标志传递给视图以指示它必须禁用所有控件。

这是一个例子：

```
public ActionResult MyAction() {
 ViewData["disablecontrols"] = false;
 if (condition)
 {
    ViewData["disablecontrols"] = true;
 }
 return View();
} 
```

在视图中（使用 jQuery）：

```
 <script type="text/javascript">
$(document).ready(function() {
var disabled = <%=ViewData["disablecontrols"].ToString()%>;
  if (disabled) {
    $('input,select').attr('disabled',disabled);
  }
})
    </script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T05:07:03.810

这实际上取决于您的控件是如何呈现的。我们在实践中做了类似的事情，除了我们将控件设置为只读。这是为了让我们可以重用显示（只读）和编辑视图。

我个人建议这样做的方法是使用 ViewData 中的值在视图中设置一个只读标志。

从那里，编写一些辅助方法来区分禁用和非禁用标记。您可以自己构建此标记，或包装 ASP.NET MVC 提供的现有 HtmlHelper 方法。

```
// In your controller
ViewData["DisableControls"] = true;

<%-- In your view --%>
<% bool disabled = ViewData["DisableControls"] as bool; %>
...
<%= Html.TextBox("fieldname", value, disabled) %>
<%= Html.CheckBox("anotherone", value, disabled) %>

// In a helper class
public static string TextBox(this HtmlHelper Html, string fieldname, object value, bool disabled)
{
    var attributes = new Dictionary<string, string>();
    if (disabled)
        attributes.Add("disabled", "disabled");
    return Html.TextBox(fieldname, value, attributes);
} 
```

我们这样做的方法是使用 Page_Load()，就像在 WebForms 中一样，禁用服务器控件。我们构建了一些自定义服务器控件来处理我们的表单字段。这是 ASP.NET MVC 的起步阶段，我不建议这样做，但它是一种替代方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T04:45:46.983

我认为您不能从控制器中执行此操作，因为在完成所有其他逻辑之后会返回视图。但是，您可以使用 ASP.NET MVC 中包含的 AJAX 库来做一些事情。

# netbeans - 如何更改 Netbeans 6.5 中的设置以在非默认浏览器中运行 Web 应用程序？

> ID：856108
> 
> 赞同：9
> 
> 时间：2009-05-13T04:46:35.717
> 
> 标签：netbeans, netbeans6.5

我在我的计算机中使用 Firefox 作为默认浏览器。

我需要在 Netbeans 6.5 中开发 Web 应用程序 (JSP) 项目，并且每次运行该项目时，它都会在 Firefox 中运行。

我想在 IE 中运行我的 Web 应用程序进行测试，但不更改我的默认 Web 浏览器。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-13T05:21:34.943

在 Netbeans 6.5 的 Tools->Options->General 下，顶部有一个名为 Web Browser 的选项。你试过改变吗？这不适合你吗？

[编辑]：也许您必须以[这种方式进行更改](http://wiki.netbeans.org/TaT_FixExternalWebBrowserInRCPApp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-12-09T00:56:45.773

我刚刚发现了一些这里没有提到的东西，虽然我会分享。我的 NetBeans 配置（工具 >> 选项 >> 常规）将我的浏览器显示为“默认系统浏览器”，并且它似乎没有选择 Chrome 作为我的默认浏览器。不用说当 xdebug 被调用时，它不知道要打开哪个浏览器。我将其更改为我唯一的其他选项，即 Internet Explorer，瞧！只是下载正确的xdebug文件并在“正确”的php.ini中设置路径和其他4个常用选项的基本配置。可以选择编辑列表以包含其他浏览器，但一次只能包含一个。

我的系统是 windows 7、xampp 以及截至 2011 年 12 月的最新版本的 netbeans 和 xdebug。这个标志也将帮助其他具有类似配置的用户找到这篇文章。我希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T05:21:44.973

工具>选项>常规

单击“编辑”按钮添加浏览器路径并更改默认浏览器。

# asp.net - 向 Infragistics UltraWebGrid 添加新行（带有模板列）

> ID：856110
> 
> 赞同：0
> 
> 时间：2009-05-13T04:47:08.073
> 
> 标签：asp.net, javascript, web-applications, infragistics, ultrawebgrid

我正在使用 Infragistics UltraWebGrid 来捕获一些数据。我没有将此网格绑定到数据源，我只是在用户单击保存按钮时访问我需要的值。

我需要向此网格中的一列添加自动完成功能，这可以通过 asp.net 文本框和 ajaxtoolkit 自动完成扩展器轻松实现。

问题是，我必须尽我所能避免回发，如果我在客户端添加行，则模板列不起作用。

知道如何实现这一目标吗？如果我必须返回服务器，如何最小化它们？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T05:31:39.513

好吧，我第一次提出问题并没有得到中间答案。我将描述我将为遇到相同问题的任何人做些什么，或者以防万一有更好解决方案的人读到这篇文章。

我只是将 WebGrid 包装在 UpdatePanel 中，并在正确的时间调用 igtbl_doPostBack() 并让面板为我处理这件事。

它仍然是回发，但它为我省去了很多麻烦，而且还不错，因为您看不到完整回发的闪回。

# algorithm - m * n 矩阵的相等性

> ID：856111
> 
> 赞同：1
> 
> 时间：2009-05-13T04:47:57.713
> 
> 标签：algorithm, matrix

检查两个 m * n 矩阵是否相等的最有效方法是什么，更重要的是导致两个矩阵不相等的 [i][j] 索引（或索引）。

就我而言，“m”相对较小（<=4），n 相对较大（<=512）。

问题的背景：我的应用程序有一个 Active Standby 设置。每当发生导致状态更改的事件时，活动服务器都会向备用服务器发送更新。但是，我们观察到有时备用与活动不同步，即使活动已发送所有更新。因此，我们计划对同步的数据结构进行审核。审计将计算活动的校验和并将它们发送到从站。从站将执行相同的操作，如果它们不匹配，将返回 NAk。然后主动将再次同步从属。我的问题是我希望从站返回导致校验和不匹配的 [i][j] 位置。

编辑：语言 C

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T05:50:01.247

虽然对于 m >> n 的情况并没有多大用处，但如果 m ~ n 您可以单独校验所有行和列，从而为您提供总共 m + n 个校验和来传输。通过这样做，您知道当第`i`th 行校验和和`j`第 th 列校验和不匹配时，`A_ij`矩阵的输入存在问题。但是可能还有其他问题，这取决于您的校验和的稳健程度以及它们允许误报的频率。

对于您的情况，发送 516 个单独的校验和并不是发送整个 2048 个条目的矩阵的重大胜利，因此实现这可能只是在过早优化浪费您的时间。但是对于 512×512 矩阵，发送 1024 个校验和比发送 262,144 个条目要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T04:53:54.363

由于您不知道矩阵在哪里不匹配，因此您必须逐个元素地比较它们。只需迭代矩阵并进行比较。

您必须注意可能的缓存未命中惩罚 - 您需要以不会导致不必要的缓存行重新加载的顺序扫描矩阵。这取决于语言。例如，对于 C，您需要让外部循环迭代第一个索引，而内部循环迭代第二个索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T05:31:25.003

正如尖牙所说，校验和大多不能反转。如果您只能对矩阵的部分进行散列，则可以进行一种二分搜索，在每次迭代中消除剩余范围的一半。即使有多个不匹配的元素，这也可以工作：您必须检查两半。
此外，您的矩阵有大约 2000 个单元，实际上非常小。因此，比较它们应该很快。如果每个对象都包含大量数据，您可以对每个对象进行散列（因此您有 2000 个散列，应该比您的对象小得多），并比较散列矩阵 - 那么您将确定问题出在哪里。
同样，请记住，计算校验和意味着遍历整个矩阵，因此按照建议，比较它们的最佳方法可能是逐个比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T01:16:12.057

[信息论](http://en.wikipedia.org/wiki/Information_theory)告诉我们，你不能在这里不劳而获。如果有**m * n 个**单元，每个单元包含**k**位信息（例如 16 位整数），那么矩阵的可能性空间占用**m * n * k**位。

如果您希望能够发送一条“消息”并处理从“它们同步”到“每个单元格都以独特而奇怪的方式不同”的每个案例，那么自然法则要求您发送此消息*** n * k**位长。如果你使用**m * n * b - 1**位，我将能够构建两种你无法区分的情况。事实上，你一半的状态空间将变得无法区分。

现在，如果您进一步描述您的要求，我们可以削减一些可能性空间。例如，您*可以*以便宜的价格获得识别 1 个不同步的单元的能力，正如其他人所描述的那样。请记住，如果有 2 个差异，则旨在定位 1 个差异的算法将完全失败。例如，当它实际上是单元格 B 和 C 时，它会告诉您单元格 A 不同步。

# unit-testing - 应该测试内部实现，还是只测试公共行为？

> ID：856115
> 
> 赞同：52
> 
> 时间：2009-05-13T04:52:49.310
> 
> 标签：unit-testing, refactoring, automated-tests, integration-testing, code-coverage

给定软件...

*   该系统由几个子系统组成
*   每个子系统由几个组件组成
*   每个组件都使用许多类来实现

...我喜欢为每个子系统或组件编写自动化测试。

我不会为组件的每个内部类编写测试（除非每个类都有助于组件的公共功能，因此可以通过组件的公共 API 从外部进行测试/测试）。

当我重构组件的实现时（我经常这样做，作为添加新功能的一部分），因此我不需要更改任何现有的自动化测试：因为测试只依赖于组件的公共 API 和公共 API通常是扩大而不是改变。

我认为该政策与[Refactoring Test Code 之](http://www.agilealliance.org/system/article/file/995/file.pdf)类的文档形成鲜明对比，该文档说...

*   “……单元测试……”
*   “......系统中每个班级的测试班......”
*   “......测试代码/生产代码比率......理想情况下被认为接近1：1的比率......”

...我想我不同意所有这些（或者至少不练习）。

**我的问题是，如果您不同意我的政策，您能解释一下原因吗？这种程度的测试在什么场景下是不够的？**

总之：

*   公共接口经过测试（和重新测试），很少更改（它们被添加但很少更改）
*   内部 API 隐藏在公共 API 之后，无需重写测试公共 API 的测试用例即可更改

* * *

脚注：我的一些“测试用例”实际上是作为数据实现的。例如，UI 的测试用例由包含各种用户输入和相应的预期系统输出的数据文件组成。测试系统意味着拥有读取每个数据文件的测试代码，将输入重放到系统中，并断言它获得了相应的预期输出。

虽然我很少需要更改测试代码（因为通常会添加而不是更改公共 API），但我确实发现有时（例如每周两次）需要更改一些现有的数据文件。当我将系统输出更改为更好（即新功能改进现有输出）时，可能会发生这种情况，这可能会导致现有测试“失败”（因为测试代码仅尝试断言输出未更改）。为了处理这些情况，我执行以下操作：

*   重新运行自动化测试套件，其中有一个特殊的运行时标志，告诉它不要断言输出，而是将新输出捕获到新目录中
*   使用可视化差异工具查看哪些输出数据文件（即哪些测试用例）已更改，并验证这些更改是否良好且符合新功能的预期
*   通过将新输出文件从新目录复制到运行测试用例的目录来更新现有测试（覆盖旧测试）

* * *

脚注：“组件”是指“一个 DLL”或“一个程序集”之类的东西……大到足以在体系结构或系统部署图中可见的东西，通常使用数十个或 100 个类来实现，并且使用仅由大约 1 个或少数几个接口组成的公共 API……可以分配给一个开发团队的东西（其中不同的组件被分配给不同的团队），因此根据[康威定律](http://en.wikipedia.org/wiki/Conway's_Law)有一个相对稳定的公共 API。

* * *

脚注：文章*[面向对象测试：神话与现实](http://www.rbsc.com/pages/myths.html)*说，

> **误区：黑盒测试就足够了。** 如果您使用类接口或规范仔细地进行测试用例设计，您可以确信该类已被充分执行。白盒测试（查看方法的实现以设计测试）违反了封装的概念。
> 
> **现实：OO 结构很重要，第二部分。**许多研究表明，被开发人员认为极其彻底的黑盒测试套件仅在被测实现中执行了三分之一到一半的语句（更不用说路径或状态）了。这有三个原因。首先，选择的输入或状态通常使用正常路径，但不会强制所有可能的路径/状态。其次，仅靠黑盒测试无法揭示惊喜。假设我们已经测试了被测系统的所有指定行为。为了确保没有未指定的行为，我们需要知道系统的任何部分是否没有被黑盒测试套件执行过。获取此信息的唯一方法是通过代码检测。第三，

我应该补充一点，我正在做白盒功能测试：我看到代码（在实现中）并编写功能测试（驱动公共 API）来练习各种代码分支（功能实现的细节）。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-13T08:15:48.120

答案很简单：您正在描述功能测试，这是软件 QA 的重要组成部分。测试内部实现是单元测试，它是软件 QA 的另一部分，具有不同的目标。这就是为什么你觉得人们不同意你的方法。

功能测试对于验证系统或子系统是否完成了它应该做的事情很重要。客户看到的任何东西都应该以这种方式进行测试。

单元测试用于检查您刚刚编写的 10 行代码是否完成了它应该做的事情。它使您对代码有更高的信心。

两者是互补的。如果您在现有系统上工作，那么功能测试可能是首先要做的事情。但是，一旦您添加代码，进行单元测试也是一个好主意。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-13T05:27:46.587

我的做法是通过公共 API/UI 测试内部。如果无法从外部访问某些内部代码，那么我会重构以删除它。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-13T05:43:30.350

我面前没有我的[Lakos](http://www.librarything.com/work/195730)副本，所以与其引用，我只会指出他在解释为什么测试在各个层面都很重要方面做得比我做得更好。

只测试“公共行为”的问题是这样的测试给你的信息很少。它会捕获许多错误（就像编译器会捕获许多错误一样），但无法告诉您错误在哪里。执行不佳的单元通常会长时间返回良好的值，然后在条件发生变化时停止这样做；如果该单元直接进行了测试，那么它执行不力的事实就会很快显现出来。

测试粒度的最佳级别是单元级别。通过其接口为每个单元提供测试。这允许您验证和记录您对每个组件行为方式的信念，这反过来又允许您通过仅测试它引入的新功能来测试相关代码，从而使测试保持简短和目标。作为奖励，它使用他们正在测试的代码进行测试。

换一种说法，只测试公共行为是正确的，只要你注意到每个公开可见的类都有公共行为。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-13T18:28:38.683

到目前为止，这个问题已经有很多很好的回答，但我想添加一些我自己的注释。作为前言：我是一家大公司的顾问，该公司为广泛的大客户提供技术解决方案。我这样说是因为根据我的经验，我们需要比大多数软件商店进行更彻底的测试（也许 API 开发人员除外）。以下是我们为确保质量而采取的一些步骤：

*   **内部单元测试：**
    开发人员应该为他们编写的所有代码创建单元测试（阅读：每个方法）。单元测试应涵盖积极的测试条件（我的方法是否有效？）和消极的测试条件（当我需要的参数之一为 null 时，该方法是否抛出 ArgumentNullException？）。我们通常使用 CruiseControl.net 之类的工具将这些测试合并到构建过程中
*   **系统测试/组装测试：**
    有时这一步被称为不同的东西，但这是我们开始测试公共功能的时候。一旦您知道所有单独的单元都按预期运行，您就想知道您的外部功能也按您认为的方式工作。这是一种功能验证形式，因为目标是确定整个系统是否按应有的方式工作。请注意，这不包括任何集成点。对于系统测试，您应该使用模拟接口而不是真实接口，以便您可以控制输出并围绕它构建测试用例。
*   **系统集成测试：**
    在流程的这个阶段，您希望将集成点连接到系统。例如，如果您正在使用信用卡处理系统，您将希望在此阶段合并实时系统以验证它是否仍然有效。您可能希望执行与系统/组装测试类似的测试。
*   **功能验证测试：**
    功能验证是用户通过系统运行或使用 API 来验证它是否按预期工作。如果您已经构建了一个发票系统，那么您将在这个阶段从头到尾执行您的测试脚本，以确保一切都按照您的设计工作。这显然是这个过程中的一个关键阶段，因为它告诉你你是否已经完成了你的工作。
*   **认证测试：**
    在这里，您将真实用户放在系统前面，让他们试一试。理想情况下，您已经在某个时候与您的利益相关者测试过您的用户界面，但这个阶段将告诉您您的目标受众是否喜欢您的产品。您可能听说过其他供应商将其称为“候选版本”。如果在这个阶段一切顺利，你就知道你可以投入生产了。认证测试应始终在您将用于生产的相同环境（或至少相同的环境）中执行。

当然，我知道不是每个人都遵循这个过程，但是如果你从头到尾看，你可以开始看到单个组件的好处。我没有包括诸如构建验证测试之类的事情，因为它们发生在不同的时间线（例如，每天）。我个人认为单元测试至关重要，因为它们可以让您深入了解应用程序的哪个特定组件在哪个特定用例中失败。单元测试还将帮助您隔离哪些方法正常运行，这样您就不会在它们没有任何问题时花时间查看它们以获取有关失败的更多信息。

当然，单元测试也可能是错误的，但是如果您根据功能/技术规范开发测试用例（您有一个，对吗？;)），您应该不会有太多麻烦。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T05:19:12.527

如果您正在练习纯测试驱动开发，那么您只在有任何失败的测试之后才实施任何代码，并且只有在没有失败的测试时才实施测试代码。此外，只实现最简单的事情来进行失败或通过测试。

在我有限的 TDD 实践中，我已经看到这如何帮助我清除代码产生的每个逻辑条件的单元测试。我不完全相信我的私有代码的逻辑特性 100% 都被我的公共接口公开。实践 TDD 似乎与该指标相辅相成，但仍然存在公共 API 不允许的隐藏功能。

我想你可以说这种做法可以保护我免受公共接口未来缺陷的影响。要么你觉得这很有用（并且可以让你更快地添加新功能），要么你发现这是浪费时间。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-08-29T02:54:47.507

您可以编写功能测试代码；没关系。但是您应该在实现上使用测试覆盖率进行验证，以证明被测试的代码都具有与功能测试相关的目的，并且它实际上做了一些相关的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-15T09:42:10.850

你不应该盲目地认为一个单元==一个类。我认为这可能适得其反。当我说我编写单元测试时，我正在测试一个逻辑单元——提供一些行为的“东西”。一个单元可以是单个类，也可以是多个类一起工作以提供该行为。有时它开始是一个单一的班级，但后来演变成三或四个班级。

如果我从一个类开始并为此编写测试，但后来它变成了几个类，我通常不会为其他类编写单独的测试——它们是被测试单元中的实现细节。这样我就可以让我的设计成长，我的测试也不会那么脆弱。

我曾经在这个问题上的想法与 CrisW 的恶魔开始完全一样 - 更高级别的测试会更好，但是在获得更多经验之后，我的想法被缓和到“每个班级都应该有一个测试班”之间。每个单元都应该有测试，但我选择定义的单元与我以前所做的略有不同。它可能是 CrisW 所说的“组件”，但通常它也只是一个类。

此外，功能测试可以很好地证明您的系统完成了它应该做的事情，但是如果您想通过示例/测试 (TDD/BDD) 来推动您的设计，那么较低级别的测试是自然而然的结果。当你完成实现时，你可以扔掉那些低级测试，但这将是一种浪费——测试是一个积极的副作用。如果您决定进行剧烈的重构以使低级测试无效，那么您将它们扔掉并编写一次新的。

将测试/证明您的软件的目标分开，并使用测试/示例来驱动您的设计/实现可以使这个讨论更加清晰。

**更新：**此外，基本上有两种方式进行 TDD：由外向内和由内向外。BDD 促进由外而内，从而导致更高级别的测试/规范。但是，如果您从细节开始，您将为所有类编写详细的测试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-08T23:26:12.510

我同意这里的大多数帖子，但是我要补充一点：

测试公共接口的首要任务是测试，然后是受保护的，然后是私有的。

通常公共和受保护接口是私有和受保护接口的组合的总结。

个人：你应该测试一切。给定一个针对较小功能的强大测试集，您将更有信心相信隐藏的方法有效。我也同意另一个人关于重构的评论。代码覆盖率将帮助您确定额外的代码位在哪里，并在必要时将其重构出来。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-27T08:00:58.620

你还在遵循这种方法吗？我也相信这是正确的做法。您应该只测试公共接口。现在公共接口可以是从某种 UI 或任何其他来源获取输入的服务或某些组件。

但是您应该能够使用 Test First 方法来发展公共服务或组件。即定义一个公共接口并测试它的基本功能。它会失败。使用后台类 API 实现该基本功能。编写 API 以仅满足第一个测试用例。然后继续询问该服务可以做的更多和发展。

唯一应该采取的平衡决策是将一个大服务或组件分解为几个可以重用的较小服务和组件。如果您坚信组件可以跨项目重用。然后应该为该组件编写自动化测试。但是再次为大型服务或组件编写的测试应该复制已经作为组件测试的功能。

某些人可能会进行理论讨论，认为这不是单元测试。所以没关系。基本思想是进行自动化测试来测试您的软件。那么，如果它不在单位级别怎么办。如果它涵盖与数据库（由您控制​​）的集成，那么它只会更好。

让我知道您是否开发了任何适合您的良好流程..自从您的第一篇文章..

问候

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-13T05:06:27.650

我个人也测试了受保护的部分，因为它们对继承的类型是“公共的”......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-13T05:25:01.787

我同意理想情况下代码覆盖率应该是 100%。这并不一定意味着 60 行代码就有 60 行测试代码，而是每个执行路径都经过测试。唯一比 bug 更烦人的是尚未运行的 bug。

通过仅测试公共 API，您将面临无法测试内部类的所有实例的风险。我这样说确实是在说明显而易见的事情，但我认为应该提及。对每种行为进行的测试越多，就越容易识别出它不仅被破坏，而且更容易识别出什么被破坏。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-13T05:49:37.173

我测试私有实现细节以及公共接口。如果我更改了实现细节并且新版本有错误，这可以让我更好地了解错误的实际位置，而不仅仅是它的影响。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-13T18:44:07.860

[我自己的问题的答案]

也许很重要的变量之一是有多少不同的程序员在编码：

*   公理：每个程序员都应该测试自己的代码

*   因此：如果程序员编写并交付了一个“单元”，那么他们也应该测试过该单元，很可能通过编写“单元测试”

*   推论：如果单个程序员编写了整个包，那么程序员编写整个包的功能测试就足够了（无需编写包内单元的“单元”测试，因为这些单元是其他程序员的实现细节）没有直接访问/曝光）。

同样，构建可以测试的“模拟”组件的做法：

*   如果您有两个团队构建两个组件，则每个团队可能都需要“模拟”对方的组件，以便在他们的组件被视为准备好进行后续“集成测试”之前，他们有一些东西（模拟）来测试自己的组件，并且在其他团队交付可以测试您的组件的组件之前。

*   如果您正在开发整个系统，那么您可以扩展整个系统……例如，开发一个新的 GUI 字段、一个新的数据库字段、一个新的业务事务和一个新的系统/功能测试，所有这些都作为其中的一部分迭代，无需开发任何层的“模拟”（因为您可以改为针对真实事物进行测试）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-26T03:04:11.647

> 公理：每个程序员都应该测试自己的代码

我不认为这是普遍正确的。

在密码学中，有句名言：“创建一个密码很容易，安全到你不知道如何自己破解。”

在典型的开发过程中，您编写代码，然后编译并运行它以检查它是否按照您的想法执行。重复这个过程一段时间，你会对你的代码充满信心。

你的自信会让你成为一个不那么警惕的测试者。不与您分享代码经验的人不会遇到问题。

此外，一双新的眼睛可能不仅对代码的可靠性，而且对代码的作用有更少的先入之见。结果，他们可能会想出代码作者没有想到的测试用例。人们会期望这些人要么发现更多错误，要么更多地传播有关代码在组织中的作用的知识。

此外，还有一个论点是，要成为一名优秀的程序员，您必须担心边缘情况，但要成为一名优秀的测试人员，您必须过分担心；-) 此外，测试人员可能更便宜，因此值得单独使用出于这个原因，测试团队。

我认为最重要的问题是：哪种方法最适合发现软件中的错误？我最近看了一个视频（没有链接，抱歉），说明随机测试比人工测试更便宜，而且和人工测试一样有效。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-10-09T00:05:58.460

这取决于您的设计以及最大价值在哪里。一种类型的应用程序可能需要与另一种不同的方法。有时您几乎无法通过单元测试发现任何有趣的东西，而功能/集成测试会产生惊喜。有时，单元测试在开发过程中失败了数百次，从而捕获了许多正在形成的错误。

有时它是微不足道的。一些类挂在一起的方式使得测试每条路径的投资回报不那么诱人，所以你可以画一条线，继续敲击更重要/复杂/大量使用的东西。

有时仅仅测试公共 API 是不够的，因为其中潜藏着一些特别有趣的逻辑，并且让系统运行并执行这些特定路径过于痛苦。那是当测试它的胆量时，它确实得到了回报。

这些天来，我倾向于编写许多（通常非常）简单的类，它们只做一两件事。然后，我通过将所有复杂的功能委托给这些内部类来实现所需的行为。即我有稍微复杂的交互，但非常简单的类。

如果我改变了我的实现并且不得不重构其中的一些类，我通常不在乎。我尽我所能保持我的测试绝缘，所以让它们再次工作通常是一个简单的改变。但是，如果我**必须**丢弃一些内部类，我通常会替换一些类并编写一些全新的测试。我经常听到人们抱怨在重构之后必须保持测试的最新状态，虽然这有时是不可避免的和令人厌烦的，但如果粒度级别足够精细，那么丢弃一些代码 + 测试通常没什么大不了的。

我觉得这是为可测试性设计和不打扰之间的主要区别之一。

# python - 在运行时为 ctypes 更改 LD_LIBRARY_PATH

> ID：856116
> 
> 赞同：45
> 
> 时间：2009-05-13T04:52:49.373
> 
> 标签：python, ctypes

您如何在运行时更新此环境变量，以便 ctypes 可以在任何地方加载库？我尝试了以下方法，但似乎都不起作用。

```
from ctypes import *
os.environ['LD_LIBRARY_PATH'] = "/home/starlon/Projects/pyCFA635/lib"  
os.putenv('LD_LIBRARY_PATH', "/home/starlon/Projects/pyCFA635/lib")  
lib = CDLL("libevaluator.so") 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-13T05:57:52.107

当诸如 Python 之类的程序运行时，动态加载器（ld.so.1 或类似的东西）已经读取了 LD_LIBRARY_PATH 并且此后不会注意到任何更改。因此，除非 Python 软件本身评估 LD_LIBRARY_PATH 并使用它来构建库的可能路径名`dlopen()`或要使用的等效函数，否则在脚本中设置变量将无效。

鉴于您说它不起作用，假设 Python 没有构建并尝试所有可能的库名称似乎是合理的；它可能仅依赖于 LD_LIBRARY_PATH 。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2010-12-01T15:58:50.133

即使您提供了 CDLL 或 cdll.LoadLibrary() 的完全限定路径，您可能仍需要在调用 Python 之前设置 LD_LIBRARY_PATH。如果您加载的共享库显式引用另一个共享库，并且没有在 .so 中为该库设置“rpath”，那么即使它已经加载，也不会找到它。库中的 rpath 指定用于搜索该库所需的其他库的搜索路径

比如我有一组相互依赖的第三方库不是我自己制作的案例。b.so 引用 a.so。即使我提前加载 a.so ：

```
ctypes.cdll.LoadLibrary('/abs/path/to/a.so')
ctypes.cdll.LoadLibrary('/abs/path/to/b.so') 
```

第二次加载时出现错误，因为 b.so 仅指代“a.so”，没有 rpath，因此 b.so 不知道这是正确的 a.so。所以我必须提前设置 LD_LIBRARY_PATH 以包含'/abs/path/to'。

为避免必须设置 LD_LIBRARY_PATH，请修改 .so 文件中的 rpath 条目。在 Linux 上，我发现有两个实用程序可以做到这一点： chrpath 和[patchelf](http://nixos.org/patchelf.html)。chrpath 可从 Ubuntu 存储库中获得。它不能改变 .so 上从未有过的 rpath。patchelf 更灵活。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-08-04T08:20:48.670

CDLL 可以传递一个完全限定的路径名​​，例如，我在我的一个脚本中使用以下内容，其中 .so 与 python 脚本位于同一目录中。

```
import os
path = os.path.dirname(os.path.realpath(__file__))
dll = CDLL("%s/iface.so"%path) 
```

在您的情况下，以下内容就足够了。

```
from ctypes import *
lib = CDLL("/home/starlon/Projects/pyCFA635/lib/libevaluator.so") 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-02-08T14:19:27.273

使用相对于当前工作目录的 rpath 编译二进制文件，例如：

```
gcc -shared -o yourbinary.so yoursource.c otherbinary.so \
    -Wl,-rpath='.',-rpath='./another/relative/rpath' -fpic 
```

然后，您可以在运行时更改 python 中的工作目录：

```
import os
os.chdir('/path/to/your/binaries') 
```

像这样，加载器也会找到其他动态库，比如 *otherbinary.so*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-12T06:47:46.993

将 LD_LIBRARY_PATH 设置为放置库的路径在此处不起作用，并且 ctypes 不会注意到任何更改。因此，您需要在源代码中设置它并在脚本之前运行 ldconfig 以考虑到这一点。此外，在脚本中设置 os 环境或任何 PATH 变量都将无效。

我遇到了类似的问题，花了大约一天的时间来解决这个问题。

```
mkdir -p /etc/ld.so.conf.d/
echo "/home/starlon/Projects/pyCFA635/lib" > /etc/ld.so.conf.d/mycustomPath.conf

ldconfig 
```

然后验证路径是否设置为：

```
ldconfig -v | less 
```

完成后，尝试运行您的脚本。这对我有用，也应该对你有用。

你可以看到下面的 URL 帮助我解决了这个问题：

[https://www.cyberciti.biz/faq/linux-setting-changeing-library-path/](https://www.cyberciti.biz/faq/linux-setting-changing-library-path/)

注意：我意识到这个问题很老，但是我想为此做出贡献，因为仅接受的答案并不能真正解决我的问题。

# .net - WCF webservice 在升级到 framework 3.5 sp1 后停止工作

> ID：856117
> 
> 赞同：2
> 
> 时间：2009-05-13T04:53:41.167
> 
> 标签：.net, wcf, .net-3.5

我的一个测试服务器上有一个 wcf webservice。一切正常，直到我从框架 3.5 升级到 3.5 sp1。wcf Web 服务停止工作并返回错误：

> “调用服务失败。服务可能离线或无法访问。有关详细信息，请参阅堆栈跟踪。”
> 
> “远程服务器返回意外响应：(502) 代理错误（指定的网络名称不再可用。）。
> 
> 服务器堆栈跟踪：在 System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) 在 System.ServiceModel 的 System.ServiceModel.Channels.HttpChannelUtilities.ValidateRequestReplyResponse(HttpWebRequest request, HttpWebResponse response, HttpChannelFactory factory, WebException responseException)。 Channels.RequestChannel.Request（消息消息，TimeSpan 超时）在 System.ServiceModel.Dispatcher.RequestChannelBinder.Request（消息消息，TimeSpan 超时）在 System.ServiceModel.Channels.ServiceChannel.Call（字符串操作，布尔单向，ProxyOperationRuntime 操作，对象[] ins, Object[] outs, TimeSpan timeout) at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation,System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) 在 System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) 处的 Object[] ins, Object[] outs)"

有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T06:13:11.863

看来，您的 Windows 功能已重置，我曾经遇到过这个问题。只需转到控制面板-程序-打开 Windows 功能并选中 Microsoft .NET Framework 3.0 中所需的所有复选框 祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T03:14:17.070

如果像 diadiora 建议的那样，问题是 WCF 功能被禁用，您可以使用 ServiceModelReg.exe 启用它。 `ServiceModelReg.exe /i`应该注册 WCF 并更新 IIS 中的脚本映射。（在[MSDN 页面上](http://msdn.microsoft.com/en-us/library/ms732012.aspx)阅读更多内容。）如果失败（安装 SP1 时可能失败），那应该更准确地告诉您问题所在。

您也可以检查 IIS 以确保您的服务（如果它由 IIS 托管）仍在运行。

# ant - 是否有可以从 Ant 调用的简单的预处理器/代码生成器，例如 GNU M4？

> ID：856120
> 
> 赞同：0
> 
> 时间：2009-05-13T04:54:21.057
> 
> 标签：ant, code-generation, preprocessor

我需要维护一些旧的 XSL 代码，并且我发现 XSL 文件中有很多重复项。看起来 XSL 没有简单的包含/导入功能，它允许我将代码移动到不同的文件并在需要时包含它。

这听起来像是可以使用模型驱动开发工具来完成，但我只听说过它，并没有实际使用过它，而且它可能对这项工作来说太过分了。

是否有可以从具有包含/导入支持的 Ant 调用的简单预处理器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T12:11:30.827

XSL 有一个包含机制。有关详细信息，请参阅[http://www.w3.org/TR/xslt#section-Combining-Stylesheets](http://www.w3.org/TR/xslt#section-Combining-Stylesheets)。

如果你不能用它来实现你想要的，你可以用另一个 XSL 转换来预处理你的 XSL：XSL 只是 XML。但是……我不认为在你离开后必须维护你的项目的程序员会感谢你这样做！

如果您只想跨平台替换 M4，您可以调用[Velocity](http://velocity.apache.org/)、[Freemarker](http://freemarker.org/)或 Ant 的其他模板库。

# mysql - 在这种特定情况下是否需要主键？

> ID：856123
> 
> 赞同：0
> 
> 时间：2009-05-13T04:54:54.690
> 
> 标签：mysql, database, database-design

我有一个带有 (id,first_name,middle_name,last_name,sex) 的名称表和一个带有 (id_fk,email_add) 的电子邮件表

事实上，我将拥有类似的第二类表，例如电话表 (id_fk,phone_no)，其中 id_fk 是引用名称表中 id 的外键。

是否需要或者是否有充分的理由在第二个和第三个表中拥有主键？还是其他类似的表？或者你会建议一个不同的模式？

PS：表格用于联系人存储应用程序

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T04:56:36.370

在您描述的情况下，主键是整个表（id_fk，phone_no），因为这些行不是共享的，代表一个无序的集合并且只有值而不是它们自己的任何类型的标识。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T06:13:42.237

我会为每个表添加一个简单的自动递增“id”主键，它的成本非常低，并且以后更容易引用特定的行。

为您的外键查看不同的命名方案也可能是一个好主意，“id_fk”可能有点令人困惑，因为它没有提供它所指的表的“id”的指示，类似“name_id”的东西可能是一个更好的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T06:39:58.153

我的设计理念是每个表总是有一个 int identity pk 列。

正如之前对 SO 的评论所示，这似乎是一个有争议的决定，但它也非常方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T04:59:19.207

电话表有一个主键。每个 (id_fk, phone_no) 对唯一地定义每个条目，因此在这种情况下，主键是一个复合键。

[http://weblogs.sqlteam.com/jeffs/archive/2007/08/23/composite_primary_keys.aspx](http://weblogs.sqlteam.com/jeffs/archive/2007/08/23/composite_primary_keys.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T05:00:11.623

使用主键几乎总是更好。即使您认为随着数据库的增长和变得越来越复杂，现在不需要它，您也会很快遇到没有数据库的问题。

就我个人而言，我还建议为您的主键使用与数据无关的列，例如 guid/uuid/serial。通过使用不包含可用数据的字段，您将永远不会处于必须更新主键的情况，一旦您的数据库增长，这可能是另一个混​​乱的操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T05:12:11.697

您可以使（外键，电话号码）成为复合主键。

我个人倾向于使用严格的技术主键，通常意味着自动编号 ID 列。优点之一是使用 ID 更容易更新和删除记录，而不是记住 HTML 表单等中的旧值。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T06:19:20.730

您绝对应该拥有所有表的主键。在 (id_fk, phone_no) 的情况下，您可以使用由两列组成的复合键，也可以添加另一列作为主键。我会推荐后者，因为它最终会降低一切的复杂性，并且如果你使用 ORM 会更加适应。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T06:39:48.637

为什么电子邮件地址和电话号码需要单独的表格？将它们全部存储在同一张表中效率更高。您的架构可能如下所示：

（伪 SQL）

```
Create table ContactName (
       CONTACT_ID integer not null default auto_increment,
       etc
       )

CREATE TABLE TELECOM_CLASSES (
    CLASS_ID INTEGER NOT NULL DEFAULT AUTO_INCREMENT,
    CLASS_NAME VARCHAR(200) NOT NULL 
              CHECK (CLASS_NAME  IN ('email','tel','fax',etc)),
    etc
     );

CREATE TABLE CONTACT_TELECOMS (
    TELECOM_ID INTEGER NOT NULL DEFAULT AUTO_INCREMENT,
    CONTACT_ID INTEGER NOT NULL REFERENCES CONTACTNAME (CONTACT_ID),
    CLASS_ID INTEGER NOT NULL REFERENCES TELECOMS_CLASSES (CLASS_ID),
    TELECOM VARCHAR(200) NOT NULL,
    etc

); 
```

# java - 打破java中的递归

> ID：856124
> 
> 赞同：30
> 
> 时间：2009-05-13T04:55:11.617
> 
> 标签：java, recursion

递归是一种“分而治之”的风格，它在变小时分裂（树数据结构），如果发现违规，我希望它完全中断，这意味着打破所有递归路径，并返回 true。这可能吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-13T05:23:52.647

无论你做什么，你都将不得不展开堆栈。这留下了两个选择：

1.  魔术返回值（如汤姆之一所述）
2.  抛出异常（如 thaggie 所述）

如果您希望事情死掉的情况很少见，这可能是抛出异常可能是可行选择的情况之一。并且在每个人都对这件事嗤之以鼻之前，请记住，编程最重要的规则之一就是知道何时适合打破规则。

事实证明，我今天花了 google 代码评估 zxing 库。他们实际上对许多控制结构使用异常抛出。当我看到它时，我的第一印象是恐怖。他们实际上是用不同的参数调用方法数万次，直到该方法不抛出异常。

这看起来确实像是一个性能问题，所以我做了一些调整，将事情改为使用魔法返回值。你知道吗？在调试器中运行时，代码速度提高了 40%。但是当我切换到非调试时，代码的速度不到 1%。

在这种情况下，我仍然对使用异常进行流控制的决定并不疯狂（我的意思是，异常总是被抛出*）*。但考虑到几乎无法衡量的性能差异，我肯定不值得花时间重新实现它。

如果您触发迭代终止的条件不是算法的基本部分，则使用异常可能会使您的代码更清晰。对我来说，我做出这个决定的关键是如果整个递归需要展开，那么我会使用异常。如果只需要展开部分递归，请使用魔术返回值。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-13T05:01:40.810

您可以返回错误代码，或修改一些全局变量，以便每个递归实例都知道“杀死自己”。

之类的。

```
int foo(bar){
     int to_the_next;

      if (go_recursive){
            to_the_next = foo(whisky_bar);

            if (to_the_next ==DIE) return DIE;
      }

      if (something_unexpected_happened) return DIE;

      process;//may include some other recursive calls, etc etc
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T05:06:38.477

如果它是一个执行递归的线程，你可以抛出一个异常。不过有点难看——有点像使用异常作为 goto。

```
boolean myPublicWrapperMethod(...) {
    try {
        return myPrivateRecursiveFunction(...);
    } catch (MySpecificException e) {
        return true;
    } 
} 
```

更好的方法是消除递归并使用 Stack 集合，其中包含一个表示递归状态的类，在循环中迭代并在需要时返回 true。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-13T16:34:01.413

我建议使用异常处理。这清楚地表明，由于某些违规（或其他异常），递归被中止：

```
public void outer() {
  try {
    int i = recurse(0);
  } catch (OuchException ouch) {
    // handle the exception here
  }
}

private int recurse(int i) throws OuchException {

    // for tree-like structures
    if (thisIsALeaf) {
       return i;
    }

    // the violation test
    if (itHurts)
       throw new OuchException("That really hurts");

    // we also can encapsulate other exceptions
    try {
       someMethod();
    } catch (Exception oops) {
       throw new OuchException(oops);
    }

    // recurse
    return recurse(i++);
}
```

当然，它违反了在流产时返回“真”的初始要求。但我更喜欢将返回值和异常行为通知完全分开。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T05:02:36.940

您可以通过存储一个跟踪递归是否应该中断的变量来做类似的事情。不幸的是，您必须在每次递归时检查它，但您可以做到。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T13:49:58.403

您要问的是递归的定义。

在某些时候，所有递归路径都应该中断。否则会无限递归，发生[堆栈溢出异常](http://en.wikipedia.org/wiki/Stack_overflow#Infinite_recursion)。

所以你应该这样**设计**递归函数。[排序数组中](http://en.wikipedia.org/wiki/Binary_search)的示例二进制搜索：

```
BinarySearch(A[0..N-1], value, low, high) {
       if (high < low)
           return -1 // not found
       mid = low + ((high - low) / 2)  // Note: not (low + high) / 2 !!
       if (A[mid] > value)
           return BinarySearch(A, value, low, mid-1)
       else if (A[mid] < value)
           return BinarySearch(A, value, mid+1, high)
       else
           return mid // found
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T05:19:02.340

除非并行评估递归调用，否则您可能只需要添加一些逻辑来检查第一个递归调用的值，然后再进行第二次（以及后续，如果不是二叉树结构）递归调用。

```
public abstract class Tree {

    protected abstract boolean headIsViolation();

    protected abstract boolean isLeaf();

    public Tree getLeft();

    public Tree getRight();

    // Recursive
    public boolean checkViolation() {
        if(this.isLeaf()) {
            return this.headIsViolation();
        }

        // If needed, you could pass some sort of 'calculation state'
        // object through the recursive calls and evaluate the violation
        // through that object if the current node is insufficient
        if(this.headIsViolation()) {
            // Terminate the recursion
            return true;
        }

        // Fortunately, Java short-circuits ||
        // So if the left child is in violation, the right child will
        // not even be checked
        return this.getLeft().checkViolation() || this.getRight().checkViolation();
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-31T18:24:21.393

我能够使用全局变量移出所有递归调用。

```
boolean skipRecursivePaths = false;
private callAgain(){

if(callAgain){
  if(getOutCompletely){

    skipRecursivePaths = true;
    }
    if(skipRecursivePaths){
    return;
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-08T08:29:08.733

遇到错误时退出递归循环的最佳方法是抛出运行时异常。

```
throw new RuntimeException("Help!  Somebody debug me!  I'm crashing!"); 
```

当然，这会杀死你的程序，但你应该使用范围检查和算法分析来确保你的递归不会抛出这样的异常。您可能想要摆脱递归算法的一个原因是您的内存不足。在这里，可以确定您的算法将在堆栈上使用多少内存。如果您正在编写 Java 代码，例如，将该计算与

```
getMemoryInfo.availMem(). 
```

假设您正在使用递归来查找 n!。你的函数看起来像这样：

```
public long fact(int n)
{
    long val = 1;
    for (int i  = 1, i<=n,i++)
        return val *= fact(i);
    return val;
} 
```

在运行它之前，请检查内存中是否有（long 中的字节数，Java 中为 8）* n 字节来保存整个堆栈。基本上，在递归方法/函数之前进行范围和错误检查，您不需要中断。但是，根据您的算法，您可能需要向整个堆栈发出信号，表明您可以开始了。如果是这样的话，汤姆的回答是有效的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-12T20:27:57.060

也许您想避免递归并将其替换为堆栈。这使您可以控制中断操作，同时能够执行类似于递归操作的操作。实际上，您只是自己模拟递归。

我在这里找到了一个很好的解释：http: [//haacked.com/archive/2007/03/04/Replacing_Recursion_With_a_Stack.aspx/](http://haacked.com/archive/2007/03/04/Replacing_Recursion_With_a_Stack.aspx/)

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2016-02-12T20:10:39.537

最好有一个布尔数组

这样就没有全局状态

```
if(stop[0]) return; 
```

# c# - NHibernate - 使用 ICriteria 加入子查询

> ID：856131
> 
> 赞同：2
> 
> 时间：2009-05-13T04:57:41.953
> 
> 标签：c#, sql, nhibernate, subquery, icriteria

我有一个需要使用 NHibernate 的 ICriteria API 表示的 SQL 查询。

```
 SELECT u.Id as Id, 
    u.Login as Login, 
    u.FirstName as FirstName, 
    u.LastName as LastName, 
    gm.UserGroupId_FK as UserGroupId,
    inner.Data1,
    inner.Data2,
    inner.Data3
    FROM dbo.User u inner join 
    dbo.GroupMember gm on u.Id = gm.UserAnchorId_FK 
    left join
    (
        SELECT
        di.UserAnchorId_FK,
        sum(di.Data1) as Data1, 
        sum(di.Data2) as Data2, 
        sum(di.Data3) as Data3
        FROM
        dbo.DailyInfo di 
        WHERE di.Date between '2009-04-01' and '2009-06-01' 
        GROUP BY di.UserAnchorId_FK
    ) inner ON inner.UserAnchorId_FK = u.Id
    WHERE gm.UserGroupId_FK = 195 
```

迄今为止的尝试包括映射“用户”和“每日信息”类（我的实体）并将 DailyInfo 对象作为用户对象的属性。但是，如何映射它们之间的外键关系仍然是一个谜，即

```
<one-to-one></one-to-one>

<one-to-many></one-to-many>

<generator class="foreign"><param name="property">Id</param></generator> (!) 
```

Web 上的解决方案通常与 WHERE 子句中的子查询有关，但是我需要在此子查询上保留连接，以确保为未连接的行返回 NULL 值。

我觉得我应该对外部查询使用 Criteria，然后用 DetachedCriteria 形成一个“join”来表示子查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-05T06:09:41.560

我遇到了同样的问题，我没有得到任何解决方案。所以我用拦截器做了一个 hack

按条件生成的查询

```
SELECT u.Id as Id, 
u.Login as Login, 
u.FirstName as FirstName, 
u.LastName as LastName, 
gm.UserGroupId_FK as UserGroupId,
inner.Data1,
inner.Data2,
inner.Data3
FROM dbo.User u inner join 
dbo.GroupMember gm on u.Id = gm.UserAnchorId_FK 
InnerJoin inner ON inner.UserAnchorId_FK = u.Id
WHERE gm.UserGroupId_FK = 195 
```

这里的 InnerJoin 是一个虚拟表，它与 User 有 1-1 的关系。InnerJoin 中的列是内部连接子查询的返回值

用户和 InnerJoin 的标准

```
DetachedCriteria forUser = DetachedCriteria.For<User>();
forUser.CreateCriteria("InnerJoin"); 
```

现在您可以制作拦截器来编辑查询

```
public interface CustomInterceptor : IInterceptor, EmptyInterceptor
{    
 SqlString IInterceptor.OnPrepareStatement(SqlString sql)
 {
    string query = sql.ToString();
     if (query.Contains("InnerJoin "))
     {
        sql = sql.Replace("InnerJoin ", "(select [vals] form dbo.DailyInfo [where conditions])");
     }
     return sql;
 }
} 
```

对于来自多个表的返回值，包括连接子查询，您必须使用 NHibernate DTO 会话是这样的

```
CustomInterceptor custonInterceptor=new CustomInterceptor(); 

sessionFactory.OpenSession(custonInterceptor); 
```

最终的查询将就像您想要得到的一样

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T14:30:53.517

至于映射关系，听起来您在 User 和 DailyInfo 之间存在一对多的关系：

```
<!-- User mapping -->
<bag name="DailyInfos" inverse="true">
    <key column="UserAnchorId_FK" />
    <one-to-many class="Namespace.To.DailyInfo, Namespace" />
</bag>

<!-- DailyInfo mapping -->
<many-to-one name="User" column="UserAnchorId_FK" /> 
```

`User`至于其余的，我目前并不完全确定......听起来你可能在表之间和`Group`通过表之间存在多对多`GroupMember`，这可能是一个复杂的因素。请记住，您可以`.CreateCriteria("Association path", jointype)`根据条件创建具有指定连接类型的子条件。发布您的类/表关系的概要可能会有所帮助。

# c# - 如何使用 ASP.Net 在 SQL Server 中插入文件？

> ID：856132
> 
> 赞同：2
> 
> 时间：2009-05-13T04:58:32.517
> 
> 标签：c#, asp.net, upload

我正在开发一个使用 ADO.NET 实体框架连接到 SQL Server 2008 的 ASP.NET 应用程序 (C#)。

此应用程序的用户可以从他的本地硬盘驱动器中选择要插入 SQL Server 的图像。我怎样才能做到这一点？

我知道如何将图像存储到 SQL Server 中，但我不知道如何将图像上传到服务器（使用 FileUpload 服务器控件？）。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T05:09:18.533

好吧，要上传到网络服务器，您只需要一个`<input type="file" .../>`. 在 ASP.NET 中，这应该在[`Request.Files`](http://msdn.microsoft.com/en-us/library/system.web.httprequest.files.aspx)集合中可用。

在 SQL Server 中，您需要一个`varbinary(max)`（或`image`旧版本）。

在将它们推入 SQL Server 之前，最大的问题是：它们有多大？如果它们不是很大，您可以将它们视为`byte[]`; 只是缓冲[`InputStream`](http://msdn.microsoft.com/en-us/library/system.web.httppostedfile.inputstream.aspx)并发送。`Stream`这是一种将 a 缓冲到单个的相当通用的方法`byte[]`：

```
 byte[] buffer = new byte[1024];
        int bytesRead;
        MemoryStream ms = new MemoryStream();
        while ((bytesRead = inputStream.Read(buffer, 0, buffer.Length)) > 0)
        {
            ms.Write(buffer, 0, bytesRead);
        }
        byte[] data = ms.ToArray(); 
```

对于大量文件（除非您使用 SQL 2008 文件流扩展，否则它们可能不属于数据库），您需要对其进行分块。这是我用于分块[的旧回复（在 SQL 2005 之前） - 但它显示了整体想法。](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/6c9e5e75ae39826b#998c53ff8afb02eb)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T05:36:10.940

要将上传的文件存储到 SQL 服务器，您可以查看我的这个答案：

[如何将图片存储在图像列中？](https://stackoverflow.com/questions/744589/how-do-you-store-a-picture-in-an-image-column/744603#744603)

在本例中，**uploadInput**是一个文件输入控件，您可以将其用作 ASP.NET 中的 FileUpload 控件。

对于在 ASP.NET 中使用文件上传控件，[这里有一篇很好的 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa479405.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T05:07:51.690

您可以使用 varbinary(MAX) 列：http: [//msdn.microsoft.com/en-us/library/ms188362.aspx](http://msdn.microsoft.com/en-us/library/ms188362.aspx)

在谷歌上搜索得到了这个：[http ://www.informit.com/articles/article.aspx?p=398883&seqNum=2](http://www.informit.com/articles/article.aspx?p=398883&seqNum=2)

请注意，在他的示例中，他使用 SQL Server 2005 中的 Image 数据类型。该类型正在逐步淘汰，取而代之的是 varbinary。您还必须更改该代码以适应您的特定架构需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T05:04:42.567

不确定实体框架，但这是您[在 vanilla ado.net 中执行此操作的方式](http://support.microsoft.com/kb/309158)

# directory - 仅签出目录结构

> ID：856135
> 
> 赞同：1
> 
> 时间：2009-05-13T04:59:56.147
> 
> 标签：directory, structure, cvs, vcs-checkout

如何在 CVS 存储库中仅签出项目的目录结构（没有任何文件）？这可能很有用，例如了解结构本身，并在以后有选择地检出文件夹。例如，我可能对可能在本地硬盘上占用太多空间的测试用例文件夹不感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T05:38:31.187

如果您只想知道结构本身，您可以使用`cvs rls -R`which 递归地列出存储库的内容。从此输出中，您可以过滤掉文件并获取目录层次结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T05:22:51.883

添加有用的东西，可能不是您寻求的解决方案。:) [TortoiseCVS](http://www.tortoisecvs.org/)可以在不检查文件的情况下显示结构。

# .net - MVP 模式，一个演示者有多少视图？

> ID：856150
> 
> 赞同：9
> 
> 时间：2009-05-13T05:05:04.360
> 
> 标签：.net, mvp

我们正在尝试将模型-视图-演示者模式用于（实际上）我们承担的所有新开发工作。

我坚信有一个框架可以帮助人们满足设计要求，我们有一些用于各种不同组件（日志记录、电子邮件发送等）的内部框架，所以我正在尝试获得某种 MVP开发的框架。

*我已经设法为那些不熟悉 MVP 并且与我们目前的工作方式*相差不远的人提供了一些易于使用的东西。问题是它与 1 个视图与 1 个演示者建立了关系。

这是框架的粗略轮廓：

```
public abstract class Presenter<TView> where TView : IView {
  public virtual T View { get; set; }

  public virtual void Setup(TView view) {
    this.View = view; 
  }
}

public interface IView { } 
```

它的基本工作方式是创建的任何**视图**都从`IView`接口继承，并传递给从抽象类继承的**Presenter类。**`Presenter`

正如您所看到的，我正在使用 .NET 泛型，以便开发人员在使用演示者（然后最终是从演示者继承的类）时可以对视图进行强类型化。

所以我可以像这样设置一个基本的登录组件：

```
public class Login : Presenter<ILogin> {
  public override Setup(ILogin view){
    base.Setup(view);
    this.View.Login += new EventHandler(login);
  }
  void login(object sender, EventArgs e) { ... }
}

public interface ILogin : IView {
  string Username { get; set; }
  string Password { get; set; }
  event EventHandler Login;
} 
```

所以正如我所说的，我非常喜欢这个，有编译器强制类型、强类型视图和类似 MVP*的*模式。

虽然有些人对实现不太满意，因为它在演示者和视图之间具有 1 对 1 的关系，严格来说这不是 MVP 的本意。

我质疑这个论点的有效性，在我一直在跟踪这个框架的几个项目中（从中型到大型项目）我没有找到任何我认为“我需要为这个演示者提供多个视图”的好例子. 当我看到可以在多个视图之间共享的功能时，我质疑它是否应该与特定的演示者绑定，或者它是否应该在一个更中立的类中。

我试图实现的框架是否离 MVP 太远而不能被称为 MVP？MVP 的主要目标是需要对演示者有多个视图吗？是否有可能拥有一个真正支持 n-view 的 .NET MVP 框架？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T05:13:37.170

我认为您的方法没有问题。您不需要在演示者和视图之间建立一对多的关系 - 通常每个演示者只有一个视图。MVP 背后的想法是将演示者与视图**分离**，以便您可以在需要时更轻松地切换视图（例如，同时支持 Web 应用程序和桌面应用程序），但这并不意味着您必须使其动态化。

一个建议：我通常将.`IView`作为构造函数参数提供给`Presenter`. then的具体实现`IView`创建了演示者（通过硬编码`new Presenter (this)`或使用 IoC 容器来获取它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-21T08:49:31.253

您可能会发现[使用 Windows 窗体实现 MVC](https://stackoverflow.com/questions/654722/implementing-mvc-with-windows-forms)的答案很有帮助，因为他们讨论了实现 MVC 和 MVP 时的不同选项

# c# - 使用 Linq 将 ListBox 项值转换为 int

> ID：856152
> 
> 赞同：2
> 
> 时间：2009-05-13T05:05:12.847
> 
> 标签：c#, asp.net, linq, listbox, asp.net-3.5

我使用 ListBox 显示数据库中表的内容。每个列表框项都使用设置为友好名称的 Text 属性和设置为唯一 ID 列的 Value 属性填充。数据库结构可能类似于以下内容：

```
CREATE TABLE GENERIC { FRIENDLY_NAME TEXT, ID INT } 
```

我尝试了将近一个小时使用 LINQ 将列表框的项目转换为 int[] 并最终失败。区分已选项目和未选项目也很重要。这是我最后写的：

```
System.Collections.Generic.LinkedList<int> 
            selected = new LinkedList<int>(), 
            notSelected = new LinkedList<int>();

        foreach (ListItem item in PhotoGalleryEdit_PhotoShoots.Items)
        {
            if (item.Selected)
                selected.AddFirst(Convert.ToInt32(item.Value));
            else
                notSelected.AddFirst(Convert.ToInt32(item.Value));
        }

 int []arraySelected = selected.ToArray();
 int []arrayNotSelected = notSelected.ToArray(); 
```

任何人都可以展示这是如何在 LINQ 中完成的吗？

*（我所有的代码都是用 C# 编写的，但任何用 VB 编写的答案都非常受欢迎）*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T05:20:27.457

根据您的描述，我能想到的最不混乱的是：

```
var qry = from ListItem item in listbox.Items
          select new {item.Selected, Value = Convert.ToInt32(item.Value)};

int[] arrSelected=qry.Where(x=>x.Selected).Select(x=>x.Value).ToArray();
int[] arrNotSelected=qry.Where(x=>!x.Selected).Select(x => x.Value).ToArray(); 
```

由于您使用的是 AddFirst，因此您可能还需要`.Reverse()`在某处使用 - 或`Array.Reverse()`之后使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T05:15:15.437

```
int[] selected = (from item in PhotoGalleryEdit_PhotoShoots.SelectedItems.OfType<MyItem>() select item.Value).ToArray(); 
```

编辑：添加了 OfType 调用以将选定项目获取到 IEnumerable。

编辑二：对于未选中的项目：

```
int[] notSelected = (from item in PhotoGalleryEdit_PhotoShoots.Items.OfType<MyItem>() where !Array.Exists(selected, x => x == item.Value) select item.Value).ToArray(); 
```

# c# - 枚举中定义的项目总数

> ID：856154
> 
> 赞同：392
> 
> 时间：2009-05-13T05:06:36.013
> 
> 标签：c#, .net, enums

如何获取枚举中定义的项目数？

* * *

## 回答 #1

> 赞同：528
> 
> 时间：2009-05-13T05:10:25.757

您可以使用静态方法[`Enum.GetNames`](https://msdn.microsoft.com/en-us/library/system.enum.getnames)返回一个数组，该数组表示枚举中所有项目的名称。此数组的长度属性等于枚举中定义的项目数

```
var myEnumMemberCount = Enum.GetNames(typeof(MyEnum)).Length; 
```

* * *

## 回答 #2

> 赞同：191
> 
> 时间：2013-06-05T17:44:23.337

问题是：

> 如何获取枚举中定义的项目数？

“项目”的数量实际上可能意味着两个完全不同的东西。考虑以下示例。

```
enum MyEnum
{
    A = 1,
    B = 2,
    C = 1,
    D = 3,
    E = 2
} 
```

中定义的“项目”数量是多少`MyEnum`？

物品的数量是 5 吗？( `A`, `B`, `C`, `D`, `E`)

还是3？( `1`, `2`, `3`)

(5) 中定义的*名称*的数量`MyEnum`可以计算如下。

```
var namesCount = Enum.GetNames(typeof(MyEnum)).Length; 
```

(3) 中定义的*值*的数量`MyEnum`可以计算如下。

```
var valuesCount = Enum.GetValues(typeof(MyEnum)).Cast<MyEnum>().Distinct().Count(); 
```

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2009-05-13T05:09:12.857

[Enum.GetValues](http://msdn.microsoft.com/en-us/library/system.enum.getvalues.aspx) (typeof(MyEnum)).Length;

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2020-08-10T21:32:33.430

我今天运行了一个基准测试并得出了有趣的结果。这三者之中：

```
var count1 = typeof(TestEnum).GetFields().Length;
var count2 = Enum.GetNames(typeof(TestEnum)).Length;
var count3 = Enum.GetValues(typeof(TestEnum)).Length; 
```

GetNames(enum) 是迄今为止最快的！

```
|         Method |      Mean |    Error |   StdDev |
|--------------- |---------- |--------- |--------- |
| DeclaredFields |  94.12 ns | 0.878 ns | 0.778 ns |
|       GetNames |  47.15 ns | 0.554 ns | 0.491 ns |
|      GetValues | 671.30 ns | 5.667 ns | 4.732 ns | 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2013-06-05T17:29:18.260

我在这个问题的 C 回答中看到了一个绝妙的技巧，只需将最后一个元素添加到枚举中并用它来判断枚举中有多少元素：

```
enum MyType {
  Type1,
  Type2,
  Type3,
  NumberOfTypes
} 
```

如果您定义的起始值不是 0，您可以使用 NumberOfTypes - Type1 来确定元素的数量。

我不确定这种方法是否比使用 Enum 更快，我也不确定它是否被认为是正确的方法，因为我们有 Enum 来为我们确定这些信息。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-13T05:10:03.573

您可以使用在枚举`Enum.GetNames`中返回一个`IEnumerable`值，然后。`Count`生成的 IEnumerable。

`GetNames`产生几乎相同的结果，`GetValues`但速度更快。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-13T05:17:36.417

从以前的答案中只需添加代码示例。

```
 class Program
    {
        static void Main(string[] args)
        {
            int enumlen = Enum.GetNames(typeof(myenum)).Length;
            Console.Write(enumlen);
            Console.Read();
        }
        public enum myenum
        {
            value1,
            value2
        }
    } 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-09-19T11:08:57.947

如果您发现自己像我一样经常编写上述解决方案，那么您可以将其实现为泛型：

```
public static int GetEnumEntries<T>() where T : struct, IConvertible 
{
    if (!typeof(T).IsEnum)
        throw new ArgumentException("T must be an enumerated type");

    return Enum.GetNames(typeof(T)).Length;
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-08-17T04:47:18.253

对于 Visual Basic：

`[Enum].GetNames(typeof(MyEnum)).Length`没有和我一起工作，但是 `[Enum].GetNames(GetType(Animal_Type)).length`做了。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-11-12T23:07:00.273

我刚才正在研究这个，对当前解决方案的可读性不满意。如果您正在非正式地编写代码或在一个小型项目中编写代码，您可以在枚举的末尾添加另一个项目，称为“长度”。这样，您只需键入：

```
var namesCount = (int)MyEnum.Length; 
```

当然，如果其他人要使用您的代码 - 或者我确信在这种情况下不适用于我的许多其他情况 - 这个解决方案可能从不明智到糟糕。

# python - 从 mysql 行插入启动一个进程

> ID：856173
> 
> 赞同：3
> 
> 时间：2009-05-13T05:15:21.957
> 
> 标签：python, mysql, linux, perl

我需要从 mysql 行插入中启动服务器端进程。我会很感激一些反馈/建议。到目前为止，我可以想到三个选项：

第一个（最不吸引人）：我的初步理解是我可以用 C 语言编写一种“自定义触发器”，它可以触发行插入。除了必须更新我的 C 技能之外，这还需要（自定义？）重新编译 MySQl ......糟糕！

第二（更有吸引力）：我可以安排我编写的程序的 cron 任务服务器端，该程序将定期查询表中的新行。这具有独立于数据库和语言的好处。这样做的问题是我遭受了 cron 计划的延迟。

第三个（我正在使用的选项）：我可以编写一个多线程程序，该程序将在单个线程上查询表的更改，产生新线程以根据需要处理新插入的行。这具有选项 2 的所有优点，且延迟更少。

我还要提到我倾向于使用 python 来完成这项任务，因为轻松访问系统 (linux) 命令以及一些内部 perl 脚本将非常有用。

我很感激任何反馈/建议

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T05:28:42.357

编写一个插入触发器，将插入的行复制到辅助表中。定期轮询辅助表以获取具有外部应用程序/cronjob 的行；如果表中有任何行，请删除它们并进行处理（或设置“处理开始”标志，仅在成功处理后从辅助表中删除）。

这对于中低插入量非常有效。如果您的表中有大量数据，那么 C 中的某种自定义触发器可能是您唯一的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T05:30:23.493

大约 2 年前，我在 .NET 中遇到了这个问题，我采用了第三种方法。但是，回头看，我想知道使用 PhpMyAdmin 和 MySQL 调查触发器是否不是要调查的方法。

# python - python reload函数有哪些应用？

> ID：856174
> 
> 赞同：1
> 
> 时间：2009-05-13T05:15:30.460
> 
> 标签：python

我一直想知道 python 中的 reload() 函数，如果不小心使用它似乎会导致问题。

为什么要重新加载模块，而不是再次停止/启动 python？

我想一个应用程序可能会以交互方式测试对模块的更改。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T05:21:54.083

reload 对于重新加载 Python 模块中可能已更改的代码很有用。通常这意味着一个插件系统。

看看这个链接：

[http://www.codexon.com/posts/a-better-python-reload](http://www.codexon.com/posts/a-better-python-reload)

它将告诉您重新加载的缺点和可能的修复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T05:18:02.703

> 我想一个应用程序可能会以交互方式测试对模块的更改。

这真的是它的唯一用途。从[Python 文档](http://docs.python.org/library/functions.html#reload)：

> 如果您使用外部编辑器编辑了模块源文件并且想要在不离开 Python 解释器的情况下试用新版本，这将非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T16:51:02.797

添加指向我昨天发布的新[重新导入模块的链接。](http://code.google.com/p/reimport/)这提供了比内置 reload() 更彻底的重新导入。通过此重新导入，您可以确保类更改和函数更新将反映在所有实例和回调中。

[http://code.google.com/p/reimport/](http://code.google.com/p/reimport/)

# .net - 是否有可以直接编辑 .NET dll 的工具？

> ID：856176
> 
> 赞同：4
> 
> 时间：2009-05-13T05:15:59.507
> 
> 标签：.net, dll

是否有可以直接编辑 .NET dll 的工具？.net 反射器允许您查看 dll，但不允许您直接修改它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T05:20:54.053

[反射](http://www.codeproject.com/KB/msil/reflexil.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-05-25T23:04:23.873

我推荐[dnSpy](https://github.com/0xd4d/dnSpy/releases)。经过数小时修补 Reflexil 无济于事后，我发现了 dnSpy 并在 5 分钟内解决了我的问题。

它优雅地集成了反编译器、程序集编辑器和十六进制编辑器，允许您进行非常具体的更改，即使在不会重新编译的程序集中（由于混淆、签名等）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T05:23:23.597

[单音塞西尔](http://www.mono-project.com/Cecil)

# php - iPhone App：如何从 API 获取数据、解析和存储以供以后使用？

> ID：856185
> 
> 赞同：2
> 
> 时间：2009-05-13T05:19:25.693
> 
> 标签：php, iphone, zend-framework, uitableview, rest

我是 iPhone 应用程序开发的新手，如果我使用了错误的术语，或者问了错误的问题，请见谅。基本上，我正在尝试编写一个应用程序，其中包括下载数据集、保存以供以后使用以及检查数据集是否已更新，但我不知道从哪里开始。

当我说数据集时，我的意思是键/值对的多维数组。

我将创建一个站点，我的应用程序将从中提取数据。我认为 REST 是它将使用的技术（对于 REST 来说也是新的），由 Zend Framework 应用程序提供服务，使用 MySQL 作为后端数据库。

所以数据将存储在 MySQL 数据库中，我需要能够下载块，我假设这些块将存储在我的应用程序的 SQLite 数据库中，以便稍后访问（当不存在互联网访问时）。在我的应用程序生命周期的某个时刻，我想检查我下载的数据集是否是最新版本。

我仍然对此感到困惑。任何人都可以对我所触及的任何/所有领域有所了解。是否有任何我应该知道的 iPhone 框架可以使这个过程更快/更容易？

谢谢！

**更新：**也许我应该将其分解以使其更容易回答：

1.  我假设我的 API 将从数据库中检索数据并将响应输出为 XML。这是最好/唯一的选择吗？
2.  在我的应用程序中，如何进行 API 调用？
3.  如何解析来自 API 调用的响应（可能是 XML）并将其存储以供以后检索？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-09T14:59:02.407

我发现用于制作只为 iPhone 服务的 Web 服务的一个非常酷的技术是为你的框架找到一个 plist 库。我通常使用 Django，而 Python 有一个内置的 plist 库。这意味着您可以将数据转换为 plist 对象，而不是标准的 XML 文件。这可以像标准 XML 文件一样被序列化并通过网络发送，但您不需要使用 NSXMLParser 来解析文件。

在您的应用程序中，您可以使用 NSData 对象的方法进行 API 调用：

```
+ (id)dataWithContentsOfURL:(NSURL *)aURL 
```

此方法将创建一个包含 URL 内容的数据对象，其中指定的 url 是您的 api 的地址。然后，您可以将该数据对象转换为字符串、字典或 plist 文件中的任何根对象。

为了管理更新，我通常使用水位法。iPhone 将上次更新的时间存储在 NSUserDefaults 等简单的东西中，服务器将每个条目或更新的时间存储在数据库中。在 api 调用中，您应该将上次更新时间作为 GET 或 POST 参数传递给服务器。然后，服务器将在其数据库中搜索从那时起更新或输入的内容，并仅将这些对象发送到手机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T16:20:27.670

如果只是想获取 (GET) 数据，则 REST API 调用只是您访问的 URL，通常返回 XML 而不是 HTML。您的 URL 可能是 www.site.com/rest/fetchstuff 或 www.site.com/dosomethigncool，没关系。为了让应用程序“调用”API，它会连接到该 URL 并包含任何参数，然后从服务器下载 XML。

假设您的应用查找待售汽车。URL/REST API 将是 www.site.com/rest/cars/findAll。您的应用会调用此 URL：www.site.com/rest/cars/findAll?make=jeep&model=wrangler。服务器将在数据库中搜索所有属于 Jeep Wranglers 的汽车，然后返回 XML 格式的结果。您的应用程序将下载该 XML，然后对其进行解析。

查看 SeismicXML 示例项目。NSURLConnection 连接到您的 REST API 并下载数据 (XML)。NSXMLParser 可以解析你下载的 XML。

# c# - VSTO 写入 Excel 中的单元格！

> ID：856196
> 
> 赞同：6
> 
> 时间：2009-05-13T05:22:24.347
> 
> 标签：c#, .net, excel

为什么会这样：

```
((Excel.Worksheet)Application.ActiveSheet).get_Range("A1", "A1").Value2 = text; 
```

但这不会：

```
Excel.Worksheet activeSheet = ((Excel.Worksheet)Application.ActiveSheet);
activeSheet.Cells[0, 0] = text; 
```

我需要使用第二种方式，因为我需要使用 rowIndex 和 colIndex 循环。我怎样才能做到这一点？

我得到错误：

> mscorlib.dll 中出现“System.Runtime.InteropServices.COMException”类型的未处理异常附加信息：来自 HRESULT 的异常：0x800A03EC

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-12-04T07:09:47.350

您唯一缺少的（除了使用基于 1 的索引）是将单元格引用显式转换为范围：

```
Excel.Worksheet activeSheet = ((Excel.Worksheet)Application.ActiveSheet);
int endRow = 5;
int endCol = 6;

for(int idxRow = 1; idxRow <= endRow; idxRow++)
{
    for(int idxCol = 1; idxCol <= endCol; idxCol)
    {
        ((Excel.Range)activeSheet.Cells[idxRow, idxCol]).Value2 = "Kilroy wuz here";
    }
} 
```

# c++ - C++：向量“损坏”的第一个元素

> ID：856200
> 
> 赞同：3
> 
> 时间：2009-05-13T05:23:53.753
> 
> 标签：c++, stl, vector, iterator, cout

我有一个包含向量的类（foo）。

如果我尝试像这样迭代向量中的元素：

```
for(vector<random>::iterator it = foo.getVector().begin();
        it != foo.getVector().end(); ++it) {
  cout << (*it) << endl;

} 
```

第一个元素总是损坏并返回垃圾数据。

但是，如果执行以下操作：

```
 vector<random> v = foo.getVector();
 for(vector<random>::iterator it = v.begin();
            it != v.end(); ++it) {
      cout << (*it) << endl;

 } 
```

一切似乎都运行良好。有没有我不知道的“陷阱”？

我也试过做 cout << foo.getVector()[0] << endl; 在循环之外，但这似乎工作正常。

谢谢。

**编辑：**

这是我的头文件：

```
#ifndef HITS
#define HITS

#include <vector>
#include "wrappers.h"

class Hits {

    public:
        Hits();
        std::vector<word_idx_value> getVector() {return speech_hits;}
        const std::vector<word_idx_value> getVector() const {return speech_hits;}
        void add(const word_idx_value&);
        Hits &operator+=(const Hits&);
    private:
        std::vector<word_idx_value> speech_hits;
};

#endif 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T05:55:16.243

```
for(vector<random>::iterator it = foo.getVector().begin(); 
```

当您这样做时会返回临时向量，并且在因此迭代器在循环内变得无效后遇到`foo.getVector()`它时会被销毁。`;``foo.getVector().begin();`

如果将 的值存储 `foo.getVector();`在向量 v ( `v = foo.getVector();`) 中，然后使用向量 v，它就可以正常工作。这是因为向量 v 在整个循环中都是有效的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-13T05:55:00.690

getVector() 按值返回一个向量。getVector 的两次调用（begin() 和 end()）返回向量的不同副本，因此您在一个对象上调用 begin()，在另一个对象上调用 end()。你得到的是两个迭代器进入两个不同的容器。将这两个迭代器与 != 进行比较会产生一个未定义的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T05:56:17.880

getVector() 按值返回向量，在第一种情况下，您会得到一个临时变量，一旦您进入循环，该变量就会被销毁。在第二种情况下，您将结果复制到在循环内仍然存在的局部变量中。可能的解决方案是通过 const 引用返回向量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T14:14:35.680

您的错误在 getVector() 方法中。通过引用返回。

```
class Hits
{
    public:
    std::vector<word_idx_value>&   getVector() {return speech_hits;}
    //                         ^
    //                      Add the & to return by reference.

    // You may also want a const version at some point.
    std::vector<word_idx_value> const&   getVector() const {return speech_hits;} 
```

如果您不通过引用返回，则您正在创建一个临时副本。副本在使用后被销毁。在这种情况下，在 begin() 执行后临时对象被销毁，因此 begin() 返回的迭代器无效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T06:20:23.927

修改 getVector 函数以返回对象引用，如下所示： std::vector<word_idx_value>& getVector() {return speech_hits;}

# xml - 如何从 XML 文件中提取数据

> ID：856201
> 
> 赞同：0
> 
> 时间：2009-05-13T05:24:11.443
> 
> 标签：xml, vb6

我在 VB6 中使用 MSXML4.0 解析器。我有一个用户浏览和选择的 XML 文件。XML 包含很多标签。我有兴趣挖掘出名为 Leadmeasurements 的标签的子节点中包含的数据。铅测量标签还将包含很多子节点...我不知道如何使用 MSXML 4.0 。谁能帮我 ？？我需要知道我需要调用的所有函数来获取名为leadmeasurements的节点，然后从子节点中提取数据。请给我一个示例代码，我可以参考并了解如何有效地使用 MSXML4.0 功能..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T17:33:25.573

好的，这是获取leadmeasurements节点内容的方法，

```
Dim oDoc AS DOMDocument
Dim oNode AS IXMLDOMNode
Set oDoc = new DOMDocument40
oDoc.Load "MyXmlFile.xml"

Set oNode = oDoc.SelectSingleNode("//leadmeasurements")

MsgBox oNode.Text 
```

现在，你想用它做什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T05:33:02.427

当我面临在 VB6 中解析 Xml 数据的前景时，我在 DotNet 中创建了一个新的 COM 可见类，并利用了它可以从 VB6 调用的 Xml 处理函数。

# django - 在 Django 中返回 html 标签

> ID：856205
> 
> 赞同：0
> 
> 时间：2009-05-13T05:27:27.867
> 
> 标签：django

我有一个视图函数，它返回一个 HTML 页面：

```
render_to_response("test.html", {test: value, somehtml: '<h1>t<h1>'}) 
```

现在，该`somehtml`值呈现为字符串，而不是带有标签的 HTML。如何在我的模板中返回 HTML 标签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T05:33:15.580

好的，得到答案：使用`safe`过滤器。

```
{{ somehtml|safe }} 
```

# wcf - 用于开发 WCF 应用程序的模型

> ID：856207
> 
> 赞同：2
> 
> 时间：2009-05-13T05:27:51.267
> 
> 标签：wcf, web-services, architecture, soa

您知道以类似于服务工厂的方式组织 WCF 应用程序的任何蓝图吗？

问题是，尽管服务工厂组织得很好，但我的应用程序是一个中型的应用程序，使用工厂将是一种矫枉过正——工厂为我创建的一些子项目，我永远不会使用。

那么用于组织中型项目的 WCF 应用程序结构的常见模型/架构/蓝图/模式是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T05:37:53.823

这篇文章非常适合如何以正确的方式设置项目结构：

[http://code-magazine.com/Article.aspx?quickid=0809101](http://code-magazine.com/Article.aspx?quickid=0809101)

# ssl - https协议和SSL证书的区别

> ID：856209
> 
> 赞同：53
> 
> 时间：2009-05-13T05:29:11.310
> 
> 标签：ssl, https, ssl-certificate, protocols

我们在 Web 浏览器中使用的 https 协议和 SSL 证书有什么区别？

这两个不是用于加密客户端（浏览器）和服务器之间的通信吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-13T05:37:08.753

HTTPS 是 HTTP（超文本传输​​协议）加上 SSL（安全套接层）。您需要证书才能使用任何使用 SSL 的协议。

SSL 允许安全地通信任意协议。它使客户端能够 (a) 验证他们确实在与他们期望的服务器通信，而不是中间人，以及 (b) 加密网络流量，以便客户端和服务器以外的各方无法看到通信。

SSL 证书包含公钥和证书颁发者。客户端不仅可以使用证书与服务器通信，客户端还可以验证证书是否由官方证书颁发机构加密签名。例如，如果您的浏览器信任 VeriSign 证书颁发机构，并且 VeriSign 签署了我的 SSL 证书，那么您的浏览器将天生信任我的 SSL 证书。

这里有一些很好的阅读：[http ://en.wikipedia.org/wiki/Transport_Layer_Security](http://en.wikipedia.org/wiki/Transport_Layer_Security)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-05-13T05:32:37.623

两件合一的解决方案。

https 是定义客户端和服务器如何协商安全连接的协议。

SSL 证书是他们将用来同意服务器真实性的文件。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-11-28T13:44:49.640

HTPS 是新的 HTTPS。HTTPS 极易受到 SSL Stripping / MITM（中间人）的攻击。引用亚当兰利（谷歌）的博客帝国紫罗兰：

“HTTPS 往往会导致人们发表演讲，嘲笑证书安全性及其周围的生态系统。”

问题是页面不是通过 HTTPS 提供的。应该是这样，但是当用户在浏览器中键入主机名时，默认方案是 HTTP。服务器可能会尝试将用户重定向到 HTTPS，但这种重定向是不安全的：MITM 攻击者可以重写它并使用户保持在 HTTP 上，从而始终欺骗真实站点。攻击者现在可以拦截到这个配置良好且安全的网站的所有流量。

这被称为 SSL 剥离，它非常简单且非常有效。我们可能不会经常看到它，因为它不是公司代理需要做的事情，所以它不在现成的设备中。但这种喘息的时间不太可能持续很长时间，而且可能已经结束：我们怎么知道它是否被使用了？

为了停止 SSL 剥离，我们需要使 HTTPS 成为唯一的协议。我们不能为整个 Internet 做到这一点，但我们可以使用 HTTP 严格传输安全 (HSTS) 逐个站点地做到这一点。

HSTS 告诉浏览器始终通过 HTTPS 向 HSTS 站点发出请求。网站通过内置在浏览器中或通过标头广告成为 HSTS：

严格的传输安全性：max-age=8640000；包括子域

标头在给定的秒数内有效，也可能适用于所有子域。必须通过干净的 HTTPS 连接接收标头。

一旦浏览器知道一个站点仅是 HTTPS，输入 mail.google.com 的用户是安全的：初始请求使用 HTTPS，攻击者没有漏洞可以利用。

（mail.google.com 和许多其他网站已经作为 HSTS 网站内置在 Chrome 中，因此实际上无法使用 Chrome 通过 HTTP 访问 accounts.google.com - 我必须修改该图像！如果你想被包括在内在 Chrome 的内置 HSTS 列表中，给我发电子邮件。）

HSTS 还可以保护您（网站管理员）免于犯愚蠢的错误。假设您已经告诉您的母亲，在访问她的银行网站之前，她应该始终键入 https://，或者您可能为她设置了一个书签。老实说，这超出了我们对用户的期望。但是假设我们的伪用户...]

由于stackoverflow上新用户的阻碍/非常愚蠢的链接规则，我不能给你亚当的其余答案，你必须自己访问亚当兰利的博客 [https://www.imperialviolet.org/2012/07/19 /hope9talk.html](https://www.imperialviolet.org/2012/07/19/hope9talk.html)

“Adam Langley 在 Google 的 HTTPS 服务基础设施和 Google Chrome 的网络堆栈上工作。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-28T13:54:30.427

HTTPS 是一种应用层协议。它可以通过数字签名提供对个别请求或响应的不可否认性。

SSL 是较低级别的协议，没有此功能。SSL 是一种传输级加密。

HTTPS 比 SSL 更灵活：应用程序可以配置它需要的安全级别。SSL 的选项较少，因此更易于设置和管理。

# c# - Linq to XML vs DOM

> ID：856215
> 
> 赞同：6
> 
> 时间：2009-05-13T05:31:59.747
> 
> 标签：c#, linq, dom, xpath

在我们正在开发的其中一个应用程序中，我们进行了大量的 XML 处理。目前我们使用 DOM 和 XPath 进行大部分处理，我们对性能不太满意。

目前我们正在考虑将 XML 处理逻辑转移到 LINQ，我们的初步调查表明 LINQ 性能比 DOM 好得多。

在进行这些更改之前，我想知道其他人对此有何看法。使用 LINQ 是更好的选择吗？任何缺点等等...

谢谢， 沙米卡

* * *

非常感谢您的回答。我做了一些性能测试，正如预期的那样，XmlReader 执行了 XmlDocument 和 LINQ。请注意，这仅适用于 XML 读取。

此外，如果您需要 LINQ 的易用性，您可以通过使用 XmlReader 的某些功能来实现 LINQ XML 处理，并且可以获得比 XmlDocument 更好的性能。请参阅“rwwilden”评论以获取更多信息。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T10:45:14.633

[`System.Xml.XmlDocument`](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)由于丰富的导航支持（所有这些引用开始加起来），使用 DOM（即。 ）可能会更慢，并且随着节点数量的增加，这种开销将变得更加显着。

更简单的对象模型 ([`System.Xml.Linq.XDocument`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)和[`System.Xml.XPath.XPathDocument`](http://msdn.microsoft.com/en-us/library/system.xml.xpath.xpathdocument.aspx)) 没有如此复杂的结构，但允许通过其他方式导航。这可能会增加 CPU 开销，但应该可以节省内存。

最后，您需要在您的案例中分析（时间和空间），并考虑它产生的真实（用户感知）差异。

但是，为了获得最佳性能，根本不要将整个文档加载到内存中：在流中使用[`System.Xml.XmlReader`](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.aspx)和[`System.Xml.XmlWriter`](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)执行所有操作。当然，这会增加开发成本。

.NET 有一组丰富（可能过于丰富）的 XML API，这对您来说是最好的（或至少是最差的）只能由您做出最适合您的权衡来决定。

就我个人而言，我会避免`XmlDocument`并使用`XPathDocument`（尤其是使用 XPath 读取和查询）或`XDocument`（尤其是创建） where `XmlReader`/`XmlWriter`没有提供足够的性能提升来证明是合理的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T05:43:22.207

我不确定您是否会注意到使用 LINQ2XML 而不是 DOM/XPath 会显着提高性能。对于 DOM 和 LINQ2XML，您迭代的文档都表示为内存中的树。

如果性能确实是一个问题并且您有相当大的 XML 文档，您可以查看框架中实现的基本 XML 流支持（通过[`XStreamingElement`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xstreamingelement.aspx)）。另请查看此 Microsoft XML 团队[博客条目](https://web.archive.org/web/20200723151354/https://docs.microsoft.com/en-us/archive/blogs/xmlteam/streaming-with-linq-to-xml-part-1)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T05:34:34.407

我的看法是 LINQ -> XML 比 DOM 更容易使用。它对我来说更直观，更容易阅读 IMO。

# winforms - Whats the big Advantage of WCF other than hosting for Windows APps?

> ID：856222
> 
> 赞同：1
> 
> 时间：2009-05-13T05:33:22.410
> 
> 标签：winforms, wcf, web-services

I've been using Webservices so long.

But,so far up to what I know,I haven't found a solid point for using WCF over Webservices.

Webservices hosted with Cassini webserver = WCF?? Is that all?

Thanks

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T06:09:04.693

WCF is an much larger communication framework that offers support for web services, message queues, TCP-based connections, named-pipes, RESTful services, etc. It allows you to host a service in different ways (IIS, console app, windows service, winforms app, etc.) with any number of different types of endpoints.

To answer your question, if your web-service is an .asmx service, then you are not using WCF. If you service uses classes from the System.ServiceModel namespace, or your config file includes a `<system.serviceModel>` section, then you are using WCF. I'm not sure if Cassini supports WCF.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T06:16:04.637

WCF is a communication stack that allows services to be exposed over HTTP (like ASMX) and TCP (like Remoting) as well as Named Pipes, MSMQ and with .NET 3.5 REST.

It allows this because it allows for **decoupling** the communcation parts of the service away from the business logic parts. All you need to do is decorate your service classes, methods and DTO's with the appropriate contract attribute ([SeriviceContract], [OperationContract] and [DataContract] respectivly.)

This had the benefit of being able to write a service once, and allowing many different kinds of clients to consume the same service (i.e. Java clients can use HTTP, .NET clients can use TCP, legacy can use MSMQ, etc.) using multiple bindings and endpoints.

WCF will still allow you do use all the features of each transport, including security, transactions, reliable messaging, etc., but you need to use some care. Not all features work on all transports, and you need to design accordingly. WCF allows you to specify in your contract which features are required. This prevents somone from trying to expose your service in a way that does not support the required feature set (i.e. if your service requires transactions, the WCF runtime will not allow the service to be accessed via a basic HTTP endpoint).

WCF is also highly extensible via custom behaviors (which influence how the WCF runtime works) and custom channels (which control how WCF services communicate with the outside world.)

WCF has a bit of a learning curve compared to ASMX, but the benefits ABSOLUTLY out weight this learning curve.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T05:45:03.343

A couple of pretty big advantages would be multiple end point binding, greater support for WS-* standards, it can be self hosting and has transaction management for a start.

# svn - TextMate是怎么做SVN和ftp的？

> ID：856225
> 
> 赞同：1
> 
> 时间：2009-05-13T05:34:08.103
> 
> 标签：svn, ftp, textmate, sftp

到目前为止，我只知道在 TextMate 中使用 Ctrl-Shift-A 来执行 SVN。有没有像Ctrl点击文件这样的简单方法？ftp可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T05:56:08.940

它是通过使用 FTP/SSH Textmate 包： http: [//fuerstnet.de/ftpssh-bundle-textmate](http://fuerstnet.de/ftpssh-bundle-textmate)

# c# - 如何改进这种平方根方法？

> ID：856228
> 
> 赞同：5
> 
> 时间：2009-05-13T05:34:45.827
> 
> 标签：c#, algorithm, optimization, math, performance

我知道这听起来像是家庭作业，但事实并非如此。最近我对用于执行某些数学运算的算法感兴趣，例如正弦、平方根等。目前，我正在尝试用 C# 编写计算平方根的[巴比伦方法。](http://en.wikipedia.org/wiki/Babylonian_method#Babylonian_method)

到目前为止，我有这个：

```
public static double SquareRoot(double x) {
    if (x == 0) return 0;

    double r = x / 2; // this is inefficient, but I can't find a better way
                      // to get a close estimate for the starting value of r
    double last = 0;
    int maxIters = 100;

    for (int i = 0; i < maxIters; i++) {
        r = (r + x / r) / 2;
        if (r == last)
            break;
        last = r;
    }

    return r;
} 
```

它工作得很好，每次都产生与 .NET Framework 的 Math.Sqrt() 方法完全相同的答案。不过，正如您可能猜到的那样，它比本机方法慢（大约 800 滴答声）。我知道这种特殊方法永远不会比本机方法快，但我只是想知道是否可以进行任何优化。

我立即看到的唯一优化是计算将运行 100 次，即使在答案已经确定之后（此时，r 始终是相同的值）。因此，我添加了一个快速检查，以查看新计算的值是否与先前计算的值相同并跳出循环。不幸的是，它在速度上并没有太大的不同，但似乎是正确的做法。

在您说“为什么不直接使用 Math.Sqrt()？”之前……我将其作为学习练习，并不打算在任何生产代码中实际使用此方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T05:53:44.623

首先，您应该检查收敛性，而不是检查相等性（r == last），其中 r 接近最后一个，其中 close 由任意 epsilon 定义：

```
eps = 1e-10  // pick any small number
if (Math.Abs(r-last) < eps) break; 
```

正如您链接到的维基百科文章所提到的那样-您不能使用牛顿法有效地计算平方根-而是使用对数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-02-01T20:31:14.547

```
float InvSqrt (float x){
  float xhalf = 0.5f*x;
  int i = *(int*)&x;
  i = 0x5f3759df - (i>>1);
  x = *(float*)&i;
  x = x*(1.5f - xhalf*x*x);
  return x;} 
```

这是我最喜欢的快速平方根。实际上它是平方根的倒数，但是如果你愿意的话，你可以在之后把它取反...... .
[http://www.beyond3d.com/content/articles/8/](http://www.beyond3d.com/content/articles/8/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T05:49:28.767

您在这里所做的是执行[牛顿的查找根的方法](http://en.wikipedia.org/wiki/Newton%27s_method)。所以你可以使用一些更有效的寻根算法。[您可以在此处](http://en.wikipedia.org/wiki/Category:Root-finding_algorithms)开始搜索。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T05:45:09.333

您可以只返回 r，而不是中断循环然后返回 r。可能不会提供任何显着的性能提升。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T05:50:11.853

用位移来代替除以 2 不太可能有那么大的不同。考虑到除法是一个常数，我希望编译器足够聪明，可以为你做到这一点，但你不妨试试看。

通过提前退出循环，您更有可能获得改进，因此要么将新 r 存储在变量中并与旧 r 进行比较，或者将 x/r 存储在变量中并在进行加法和除法之前将其与 r 进行比较.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T09:53:26.917

使用您的方法，每次迭代都会使正确位数增加一倍。

使用表格获取最初的 4 位（例如），第一次迭代后您将有 8 位，第二次后将有 16 位，第四次迭代后您需要的所有位（因为 a`double`存储 52+1 位尾数）。

对于表查找，您可以提取 [0.5,1[ 中的尾数并从输入中提取指数（使用类似 frexp 的函数），然后使用 2 的适当幂乘以规范 [64,256[ 中的尾数。

```
mantissa *= 2^K
exponent -= K 
```

在此之后，您输入的数字仍然是`mantissa*2^exponent`。K 必须是 7 或 8，以获得偶数指数。您可以从包含尾数整数部分的所有平方根的表中获取迭代的初始值。执行 4 次迭代以获得尾数的平方根 r。结果是`r*2^(exponent/2)`，使用类似的函数构造`ldexp`.

编辑。我在下面放了一些 C++ 代码来说明这一点。OP 的函数 sr1 经过改进的测试需要 2.78s 来计算 2^24 平方根；我的函数 sr2 需要 1.42s，而硬件 sqrt 需要 0.12s。

```
#include <math.h>
#include <stdio.h>

double sr1(double x)
{
  double last = 0;
  double r = x * 0.5;
  int maxIters = 100;
  for (int i = 0; i < maxIters; i++) {
    r = (r + x / r) / 2;
    if ( fabs(r - last) < 1.0e-10 )
      break;
    last = r;
  }
  return r;
}

double sr2(double x)
{
  // Square roots of values in 0..256 (rounded to nearest integer)
  static const int ROOTS256[] = {
    0,1,1,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,
    7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,
    9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,
    11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,
    12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,
    14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
    15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16 };

  // Normalize input
  int exponent;
  double mantissa = frexp(x,&exponent); // MANTISSA in [0.5,1[ unless X is 0
  if (mantissa == 0) return 0; // X is 0
  if (exponent & 1) { mantissa *= 128; exponent -= 7; } // odd exponent
  else { mantissa *= 256; exponent -= 8; } // even exponent
  // Here MANTISSA is in [64,256[

  // Initial value on 4 bits
  double root = ROOTS256[(int)floor(mantissa)];

  // Iterate
  for (int it=0;it<4;it++)
    {
      root = 0.5 * (root + mantissa / root);
    }

  // Restore exponent in result
  return ldexp(root,exponent>>1);
}

int main()
{
  // Used to generate the table
  // for (int i=0;i<=256;i++) printf(",%.0f",sqrt(i));

  double s = 0;
  int mx = 1<<24;
  // for (int i=0;i<mx;i++) s += sqrt(i); // 0.120s
  // for (int i=0;i<mx;i++) s += sr1(i);  // 2.780s
  for (int i=0;i<mx;i++) s += sr2(i);  // 1.420s
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T05:52:38.060

定义一个容差并在后续迭代落在该容差范围内时尽早返回。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-13T06:20:23.287

既然你说下面的代码不够快，试试这个：

```
 static double guess(double n)
    {
        return Math.Pow(10, Math.Log10(n) / 2);
    } 
```

它应该非常准确并且希望很快。

[这是此处](http://en.wikipedia.org/wiki/Methods_of_computing_square_roots#Rough_estimation)描述的初始估计的代码。看起来还不错。使用此代码，然后您还应该进行迭代，直到值收敛在一个 epsilon 的差异内。

```
 public static double digits(double x)
    {
        double n = Math.Floor(x);
        double d;

        if (d >= 1.0)
        {
            for (d = 1; n >= 1.0; ++d)
            {
                n = n / 10;
            }
        }
        else
        {
            for (d = 1; n < 1.0; ++d)
            {
                n = n * 10;
            }
        }

        return d;
    }

    public static double guess(double x)
    {
        double output;
        double d = Program.digits(x);

        if (d % 2 == 0)
        {
            output = 6*Math.Pow(10, (d - 2) / 2);
        }
        else
        {
            output = 2*Math.Pow(10, (d - 1) / 2);
        }

        return output;
    } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-31T21:27:26.090

为了学习目的，我也一直在研究这个。您可能对我尝试的两个修改感兴趣。

第一个是在 x0 中使用一阶泰勒级数逼近：

```
 Func<double, double> fNewton = (b) =>
    {
        // Use first order taylor expansion for initial guess
        // http://www27.wolframalpha.com/input/?i=series+expansion+x^.5
        double x0 = 1 + (b - 1) / 2;
        double xn = x0;
        do
        {
            x0 = xn;
            xn = (x0 + b / x0) / 2;
        } while (Math.Abs(xn - x0) > Double.Epsilon);
        return xn;
    }; 
```

第二个是尝试第三个订单（更贵），迭代

```
 Func<double, double> fNewtonThird = (b) =>
    {
        double x0 = b/2;
        double xn = x0;
        do
        {
            x0 = xn;
            xn = (x0*(x0*x0+3*b))/(3*x0*x0+b);
        } while (Math.Abs(xn - x0) > Double.Epsilon);
        return xn;
    }; 
```

我创建了一个辅助方法来计时功能

```
public static class Helper
{
    public static long Time(
        this Func<double, double> f,
        double testValue)
    {
        int imax = 120000;
        double avg = 0.0;
        Stopwatch st = new Stopwatch();
        for (int i = 0; i < imax; i++)
        {
            // note the timing is strictly on the function
            st.Start();
            var t = f(testValue);
            st.Stop();
            avg = (avg * i + t) / (i + 1);
        }
        Console.WriteLine("Average Val: {0}",avg);
        return st.ElapsedTicks/imax;
    }
} 
```

原始方法更快，但同样，可能很有趣:)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-07-30T13:45:42.513

将“/ 2”替换为“* 0.5”使我的机器上的速度提高了约 1.5 倍，但当然不如本机实现快。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-13T05:57:08.410

好吧，本机 Sqrt() 函数可能没有用 C# 实现，它很可能用低级语言完成，而且肯定会使用更有效的算法。所以试图匹配它的速度可能是徒劳的。

但是，关于仅尝试优化 heckuvit 的功能，您链接的 Wikipedia 页面建议“起始猜测”为 2^floor(D/2)，其中 D 表示数字中的二进制位数。您可以尝试一下，我看不到其他可以在您的代码中显着优化的内容。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-05-13T05:45:22.470

你可以试试 `r = x >> 1;`

而不是 / 2 （也在你设备 2 的其他地方）。它可能会给你一点优势。我也会将其`100`移入循环。可能没什么，但我们在这里谈论蜱虫。

现在只是检查它。

编辑：将 > 修复为 >>，但它不适用于双打，所以没关系。100的内联没有给我速度增加。

# c# - .NET WPF Process.Start() 在 Vista 和 Windows 7 上不起作用

> ID：856236
> 
> 赞同：1
> 
> 时间：2009-05-13T05:38:27.193
> 
> 标签：c#, .net, wpf, windows-7, windows-vista

我有 WPF 应用程序。在 Windows7 上测试我的应用程序并意识到打开帮助不起作用后。

基本上要打开我调用的 chm 帮助文件：

```
Process.Start("help.chm"); 
```

什么也没有发生。我也在 Vista SP1 上尝试过我的应用程序，结果相同。我是两个操作系统的管理员

我已经用谷歌搜索了这个问题，但没有找到解决方案。

有没有办法解决这个问题？

您是否遇到过这种类型的不兼容问题。

谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T20:31:13.957

你试过 ShellExecute 吗？

使用 System.Runtime.InteropServices；

[DllImport("shell32.dll", CharSet = CharSet.Auto)] static extern bool ShellExecuteEx(ref SHELLEXECUTEINFO lpExecInfo);

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
public struct SHELLEXECUTEINFO
{
    public int cbSize;
    public uint fMask;
    public IntPtr hwnd;
    [MarshalAs(UnmanagedType.LPTStr)]
    public string lpVerb;
    [MarshalAs(UnmanagedType.LPTStr)]
    public string lpFile;
    [MarshalAs(UnmanagedType.LPTStr)]
    public string lpParameters;
    [MarshalAs(UnmanagedType.LPTStr)]
    public string lpDirectory;
    public int nShow;
    public IntPtr hInstApp;
    public IntPtr lpIDList;
    [MarshalAs(UnmanagedType.LPTStr)]
    public string lpClass;
    public IntPtr hkeyClass;
    public uint dwHotKey;
    public IntPtr hIcon;
    public IntPtr hProcess;
} 
```

您可以尝试使用以下方法开始流程：

```
 SHELLEXECUTEINFO info = new SHELLEXECUTEINFO();
        info.cbSize = System.Runtime.InteropServices.Marshal.SizeOf(info);
        info.lpVerb = "open";
        info.lpFile = "help.chm";
        info.nShow = 5;
        info.fMask = 12;

        ShellExecuteEx(ref info); 
```

（[http://www.pinvoke.net/default.aspx/shell32.ShellExecuteEx](http://www.pinvoke.net/default.aspx/shell32.ShellExecuteEx)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T05:50:50.947

这个[SO 线程](https://stackoverflow.com/questions/133379/elevating-process-privilege-programatically)应该可以帮助你。另外，这里有一篇关于 UAC 以及如何提升的[非常详细的文章。](http://codefromthe70s.org/vistatutorial.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T20:40:06.487

它只是 .chm 文件吗？如果是这样，它可能无法打开，因为默认情况下，不受信任位置的 chm 文件被阻止。请参阅：[KB902225](http://support.microsoft.com/kb/902225)。从[这篇文章](http://intellects.in/2008/11/06/utility-to-recursively-unblock-files-downloaded-from-internet/)看来，您可以通过编程方式解除对它们的阻止，即使它只是首先启动 Sysinternals streams.exe（如文章中所引用）。

# javascript - 使用 javascript 绘制圆弧

> ID：856246
> 
> 赞同：0
> 
> 时间：2009-05-13T05:43:01.960
> 
> 标签：javascript, drawing

有没有办法在 JavaScript 中使用点来绘制弧线？

当我指定一组点时，我需要画一条弧线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T06:01:54.423

根据您想要支持的平台和绘图的复杂性，我建议使用[DHTML](http://www.walterzorn.com/jsgraphics/jsgraphics_e.htm)、[画布](https://developer.mozilla.org/en/Canvas_tutorial/Drawing_shapes)（对于 IE 使用[ExplorerCanvas](http://excanvas.sourceforge.net/)）。

尽管 DHTML 是跨浏览器的，但 canvas 似乎是未来项目的必经之路，因为它的功能更多，实际上*是*用于图形。

**编辑：**我最初写这篇文章时我错了，或者 ExplorerCanvas*实际上*是使用 Flash 来渲染它的画布。但现在他们似乎已转向 VML 和/或 Silverlight。我已经编辑了我的答案以排除该变量依赖性。我还对画布添加了更强的建议。

# paypal - 使用 cURL 或 Paypal API 从网站进行 Paypal cc 验证？

> ID：856251
> 
> 赞同：0
> 
> 时间：2009-05-13T05:43:52.707
> 
> 标签：paypal, payment

我在网站上有一份抄送表格。客户填写表格后，在后台（使用 curl 或 fsock 等或通过 API 调用）可以使用 Paypal 验证 cc 详细信息吗？是否存在任何 API？这类似于 authorize.net 支付集成

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T09:48:16.677

您想要[Paypal 的即时付款通知](https://www.paypal.com/ipn)。

# c# - 多个更新面板 --> 一个一个加载和显示

> ID：856258
> 
> 赞同：-1
> 
> 时间：2009-05-13T05:49:48.517
> 
> 标签：c#, asp.net, ajax

这里我放了我的示例代码。请改正错误。在示例代码中，我想一一加载更新面板“UpdatePanelBodySub1”、“UpdatePanelBodySub2”、“UpdatePanelBodySub3”和“UpdatePanelBodySub4”。如果一个更新面板加载了所有记录，然后立即显示，那么下一个更新面板将开始工作……。请帮我。（Visual Studio 2008 和框架 3.5）

默认.aspx

主页 - 多个更新面板

```
 <UsrCtrl:MainControl ID="mainControl1" runat="server" EnableViewState="true" />
    </div>
</form> 
```

Default.aspx.cs 使用系统；使用 System.Web.UI；使用 System.Web.UI.WebControls；

public partial class _Default : Page { /// /// /// /// protected override void OnPreRenderComplete(EventArgs e) { TextBox txtIsSearch = (TextBox) mainControl1.FindControl("headerControl1").FindControl("txtIsSearch");

```
 if (Convert.ToBoolean(txtIsSearch.Text))
    {
        UpdatePanel updatePanelBodySub;

        updatePanelBodySub =
            (UpdatePanel)
            mainControl1.FindControl("bodyControl1").FindControl("bodySubControl1").FindControl(
                "UpdatePanelBodySub1");
        updatePanelBodySub.DataBind();

        updatePanelBodySub =
            (UpdatePanel)
            mainControl1.FindControl("bodyControl1").FindControl("bodySubControl2").FindControl(
                "UpdatePanelBodySub2");
        updatePanelBodySub.DataBind();

        updatePanelBodySub =
            (UpdatePanel)
            mainControl1.FindControl("bodyControl1").FindControl("bodySubControl3").FindControl(
                "UpdatePanelBodySub3");
        updatePanelBodySub.DataBind();

        updatePanelBodySub =
            (UpdatePanel)
            mainControl1.FindControl("bodyControl1").FindControl("bodySubControl4").FindControl(
                "UpdatePanelBodySub4");
        updatePanelBodySub.DataBind();

        txtIsSearch.Text = "false";
    }

    base.OnPreRenderComplete(e);
} 
```

}

主控件.ascx

```
 <asp:UpdateProgress ID="UpdateProgressMain" runat="server" AssociatedUpdatePanelID="UpdatePanelMain" DisplayAfter="50">
        <ProgressTemplate>
            <img src="loading.gif" alt="Loading ... " title="Loading ... " />
        </ProgressTemplate>
    </asp:UpdateProgress>

    <h1>Search data from 4 different databases</h1>

    <UsrCtrl:HeaderControl ID="headerControl1" runat="server" EnableViewState="true" />

    <UsrCtrl:BodyControl ID="bodyControl1" runat="server" EnableViewState="true" />

</ContentTemplate> 
```

MainControl.ascx.cs

使用系统；

公共部分类 MainControl : System.Web.UI.UserControl { protected void Page_Load(object sender, EventArgs e) {

```
} 
```

}

页眉控件.ascx

## 搜索条件

HeaderControl.ascx.cs

使用系统；使用 System.Web.UI.WebControls；

公共部分类 HeaderControl : System.Web.UI.UserControl { protected void Page_Load(object sender, EventArgs e) {

```
}
protected void btnSearch_Click(object sender, EventArgs e)
{
    TextBox txtPageNumber;

    txtPageNumber =
        (TextBox)
        this.Parent.Parent.Parent.FindControl("bodyControl1").FindControl("bodySubControl1").FindControl(
            "txtPageNumber");
    // this                         --> ASP.hedercontrol_ascx
    // this.Parent                  --> System.Web.UI.Control
    // this.Parent.Parent           --> System.Web.UI.UpdatePanel
    // this.Parent.Parent.Parent    --> ASP.maincontrol_ascx

    txtPageNumber.Text = "1";

    txtPageNumber =
        (TextBox)
        this.Parent.Parent.Parent.FindControl("bodyControl1").FindControl("bodySubControl2").FindControl(
            "txtPageNumber");
    txtPageNumber.Text = "1";

    txtPageNumber =
        (TextBox)
        this.Parent.Parent.Parent.FindControl("bodyControl1").FindControl("bodySubControl3").FindControl(
            "txtPageNumber");
    txtPageNumber.Text = "1";

    txtPageNumber =
        (TextBox)
        this.Parent.Parent.Parent.FindControl("bodyControl1").FindControl("bodySubControl4").FindControl(
            "txtPageNumber");
    txtPageNumber.Text = "1";

    txtIsSearch.Text = "true";
} 
```

}

身体控制.ascx

## 搜索结果

身体控制.ascx.cs

使用系统；

公共部分类 BodyControl : System.Web.UI.UserControl { protected void Page_Load(object sender, EventArgs e) {

```
} 
```

}

BodySubControl1.ascx

```
 <asp:UpdateProgress ID="UpdateProgressBodySub1" runat="server" AssociatedUpdatePanelID="UpdatePanelBodySub1" DisplayAfter="50">
        <ProgressTemplate>
            <img src="loading.gif" alt="Loading ... " title="Loading ... " />
        </ProgressTemplate>
    </asp:UpdateProgress>

    <h3>From database 1</h3>

    <asp:GridView ID="GridViewBodySub1" runat="server" AutoGenerateColumns="false">
        <Columns>
            <asp:BoundField HeaderText="Search Answer" DataField="SearchAns" />
        </Columns>
    </asp:GridView>

    <asp:LinkButton ID="lnkPrevious" runat="server" Text="Previous" 
        ForeColor="Blue" onclick="lnkPrevious_Click"></asp:LinkButton>
    <asp:LinkButton ID="lnkNext" runat="server" Text="Next" ForeColor="Blue" 
        onclick="lnkNext_Click"></asp:LinkButton>
    <asp:TextBox ID="txtPageNumber" runat="server" Text="1" Visible="false"></asp:TextBox>

</ContentTemplate> 
```

BodySubControl1.ascx.cs

使用系统；使用 System.Collections.Generic；使用 System.Web.UI；使用 System.Web.UI.WebControls；

公共部分类 BodySubControl1 : UserControl { protected void UpdatePanel_DataBinding(object sender, EventArgs e) { GridViewBodySub1.DataSource = GetRecords(); GridViewBodySub1.DataBind(); }

```
/// <summary>
/// 
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
protected void lnkPrevious_Click(object sender, EventArgs e)
{
    int pageNumber = Convert.ToInt32(txtPageNumber.Text);

    if (pageNumber > 1)
    {
        pageNumber -= 1;
    }

    txtPageNumber.Text = Convert.ToString(pageNumber);

    UpdatePanelBodySub1.DataBind();
}

/// <summary>
/// 
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
protected void lnkNext_Click(object sender, EventArgs e)
{
    int pageNumber = Convert.ToInt32(txtPageNumber.Text);

    pageNumber += 1;

    txtPageNumber.Text = Convert.ToString(pageNumber);

    UpdatePanelBodySub1.DataBind();
}

/// <summary>
/// In actual case this function fetching record from database
/// For testing purpose I wrote like this.
/// </summary>
/// <returns></returns>
private List<SearchResult> GetRecords()
{
    List<SearchResult> strList = new List<SearchResult>();

    TextBox txtSearchCriteria =
        (TextBox) this.Parent.Parent.Parent.Parent.FindControl("headerControl1").FindControl("txtSearchCriteria");

    // this                                 --> ASP.bodysubcontrol1_ascx
    // this.Parent                          --> ASP.bodycontrol_ascx
    // this.Parent.Parent                   --> System.Web.UI.Control
    // this.Parent.Parent.Parent            --> System.Web.UI.UpdatePanel
    // this.Parent.Parent.Parent.Parent     --> ASP.maincontrol_ascx

    int recordNumberStart = ((Convert.ToInt32(txtPageNumber.Text) - 1) * 10) + 1;
    int recordNumberEnd = recordNumberStart + 9;

    for (int i = recordNumberStart; i <= recordNumberEnd; i++)
    {
        strList.Add(new SearchResult(string.Concat("DB1 :", txtSearchCriteria.Text.Trim(), " ", i.ToString())));
    }

    for (long i = 0; i < 999999999; i++)
    {
        // real case it will not come
    }

    return strList;
} 
```

}

BodySubControl2.ascx

```
 <asp:UpdateProgress ID="UpdateProgressBodySub2" runat="server" AssociatedUpdatePanelID="UpdatePanelBodySub2" DisplayAfter="50">
        <ProgressTemplate>
            <img src="loading.gif" alt="Loading ... " title="Loading ... " />
        </ProgressTemplate>
    </asp:UpdateProgress>

    <h3>From database 2</h3>

    <asp:GridView ID="GridViewBodySub2" runat="server" AutoGenerateColumns="false">
        <Columns>
            <asp:BoundField HeaderText="Search Answer" DataField="SearchAns" />
        </Columns>
    </asp:GridView>

    <asp:LinkButton ID="lnkPrevious" runat="server" Text="Previous" 
        ForeColor="Blue" onclick="lnkPrevious_Click"></asp:LinkButton>
    <asp:LinkButton ID="lnkNext" runat="server" Text="Next" ForeColor="Blue" 
        onclick="lnkNext_Click"></asp:LinkButton>
    <asp:TextBox ID="txtPageNumber" runat="server" Text="1" Visible="false"></asp:TextBox>

</ContentTemplate> 
```

BodySubControl2.ascx.cs

使用系统；使用 System.Collections.Generic；使用 System.Web.UI；使用 System.Web.UI.WebControls；

公共部分类 BodySubControl2 ： UserControl { protected void UpdatePanel_DataBinding(object sender, EventArgs e) { GridViewBodySub2.DataSource = GetRecords(); GridViewBodySub2.DataBind(); }

```
/// <summary>
/// 
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
protected void lnkPrevious_Click(object sender, EventArgs e)
{
    int pageNumber = Convert.ToInt32(txtPageNumber.Text);

    if (pageNumber > 1)
    {
        pageNumber -= 1;
    }

    txtPageNumber.Text = Convert.ToString(pageNumber);

    UpdatePanelBodySub2.DataBind();
}

/// <summary>
/// 
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
protected void lnkNext_Click(object sender, EventArgs e)
{
    int pageNumber = Convert.ToInt32(txtPageNumber.Text);

    pageNumber += 1;

    txtPageNumber.Text = Convert.ToString(pageNumber);

    UpdatePanelBodySub2.DataBind();
}

/// <summary>
/// In actual case this function fetching record from database
/// For testing purpose I wrote like this.
/// </summary>
/// <returns></returns>
private List<SearchResult> GetRecords()
{
    List<SearchResult> strList = new List<SearchResult>();

    TextBox txtSearchCriteria =
        (TextBox)this.Parent.Parent.Parent.Parent.FindControl("headerControl1").FindControl("txtSearchCriteria");

    // this                                 --> ASP.bodysubcontrol2_ascx
    // this.Parent                          --> ASP.bodycontrol_ascx
    // this.Parent.Parent                   --> System.Web.UI.Control
    // this.Parent.Parent.Parent            --> System.Web.UI.UpdatePanel
    // this.Parent.Parent.Parent.Parent     --> ASP.maincontrol_ascx

    int recordNumberStart = ((Convert.ToInt32(txtPageNumber.Text) - 1) * 10) + 1;
    int recordNumberEnd = recordNumberStart + 9;

    for (int i = recordNumberStart; i <= recordNumberEnd; i++)
    {
        strList.Add(new SearchResult(string.Concat("DB2 :", txtSearchCriteria.Text.Trim(), " ", i.ToString())));
    }

    for (long i = 0; i < 999999999; i++)
    {
        // real case it will not come
    }

    return strList;
} 
```

}

BodySubControl3.ascx

```
 <asp:UpdateProgress ID="UpdateProgressBodySub3" runat="server" AssociatedUpdatePanelID="UpdatePanelBodySub3" DisplayAfter="50">
        <ProgressTemplate>
            <img src="loading.gif" alt="Loading ... " title="Loading ... " />
        </ProgressTemplate>
    </asp:UpdateProgress>

    <h3>From database 3</h3>

    <asp:GridView ID="GridViewBodySub3" runat="server" AutoGenerateColumns="false">
        <Columns>
            <asp:BoundField HeaderText="Search Answer" DataField="SearchAns" />
        </Columns>
    </asp:GridView>

    <asp:LinkButton ID="lnkPrevious" runat="server" Text="Previous" 
        ForeColor="Blue" onclick="lnkPrevious_Click"></asp:LinkButton>
    <asp:LinkButton ID="lnkNext" runat="server" Text="Next" ForeColor="Blue" 
        onclick="lnkNext_Click"></asp:LinkButton>
    <asp:TextBox ID="txtPageNumber" runat="server" Text="1" Visible="false"></asp:TextBox>

</ContentTemplate> 
```

BodySubControl3.ascx.cs

使用系统；使用 System.Collections.Generic；使用 System.Web.UI；使用 System.Web.UI.WebControls；

公共部分类 BodySubControl3 ： UserControl { protected void UpdatePanel_DataBinding(object sender, EventArgs e) { GridViewBodySub3.DataSource = GetRecords(); GridViewBodySub3.DataBind(); }

```
/// <summary>
/// 
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
protected void lnkPrevious_Click(object sender, EventArgs e)
{
    int pageNumber = Convert.ToInt32(txtPageNumber.Text);

    if (pageNumber > 1)
    {
        pageNumber -= 1;
    }

    txtPageNumber.Text = Convert.ToString(pageNumber);

    UpdatePanelBodySub3.DataBind();
}

/// <summary>
/// 
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
protected void lnkNext_Click(object sender, EventArgs e)
{
    int pageNumber = Convert.ToInt32(txtPageNumber.Text);

    pageNumber += 1;

    txtPageNumber.Text = Convert.ToString(pageNumber);

    UpdatePanelBodySub3.DataBind();
}

/// <summary>
/// In actual case this function fetching record from database
/// For testing purpose I wrote like this.
/// </summary>
/// <returns></returns>
private List<SearchResult> GetRecords()
{
    List<SearchResult> strList = new List<SearchResult>();

    TextBox txtSearchCriteria =
        (TextBox)this.Parent.Parent.Parent.Parent.FindControl("headerControl1").FindControl("txtSearchCriteria");

    // this                                 --> ASP.bodysubcontrol3_ascx
    // this.Parent                          --> ASP.bodycontrol_ascx
    // this.Parent.Parent                   --> System.Web.UI.Control
    // this.Parent.Parent.Parent            --> System.Web.UI.UpdatePanel
    // this.Parent.Parent.Parent.Parent     --> ASP.maincontrol_ascx

    int recordNumberStart = ((Convert.ToInt32(txtPageNumber.Text) - 1) * 10) + 1;
    int recordNumberEnd = recordNumberStart + 9;

    for (int i = recordNumberStart; i <= recordNumberEnd; i++)
    {
        strList.Add(new SearchResult(string.Concat("DB3 :", txtSearchCriteria.Text.Trim(), " ", i.ToString())));
    }

    for (long i = 0; i < 999999999; i++)
    {
        // real case it will not come
    }

    return strList;
} 
```

}

BodySubControl4.ascx

```
 <asp:UpdateProgress ID="UpdateProgressBodySub4" runat="server" AssociatedUpdatePanelID="UpdatePanelBodySub4" DisplayAfter="50">
        <ProgressTemplate>
            <img src="loading.gif" alt="Loading ... " title="Loading ... " />
        </ProgressTemplate>
    </asp:UpdateProgress>

    <h3>From database 4</h3>

    <asp:GridView ID="GridViewBodySub4" runat="server" AutoGenerateColumns="false">
        <Columns>
            <asp:BoundField HeaderText="Search Answer" DataField="SearchAns" />
        </Columns>
    </asp:GridView>

    <asp:LinkButton ID="lnkPrevious" runat="server" Text="Previous" 
        ForeColor="Blue" onclick="lnkPrevious_Click"></asp:LinkButton>
    <asp:LinkButton ID="lnkNext" runat="server" Text="Next" ForeColor="Blue" 
        onclick="lnkNext_Click"></asp:LinkButton>
    <asp:TextBox ID="txtPageNumber" runat="server" Text="1" Visible="false"></asp:TextBox>

</ContentTemplate> 
```

BodySubControl4.ascx.cs

使用系统；使用 System.Collections.Generic；使用 System.Web.UI；使用 System.Web.UI.WebControls；

公共部分类 BodySubControl4 ： UserControl { protected void UpdatePanel_DataBinding(object sender, EventArgs e) { GridViewBodySub4.DataSource = GetRecords(); GridViewBodySub4.DataBind(); }

```
/// <summary>
/// 
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
protected void lnkPrevious_Click(object sender, EventArgs e)
{
    int pageNumber = Convert.ToInt32(txtPageNumber.Text);

    if (pageNumber > 1)
    {
        pageNumber -= 1;
    }

    txtPageNumber.Text = Convert.ToString(pageNumber);

    UpdatePanelBodySub4.DataBind();
}

/// <summary>
/// 
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
protected void lnkNext_Click(object sender, EventArgs e)
{
    int pageNumber = Convert.ToInt32(txtPageNumber.Text);

    pageNumber += 1;

    txtPageNumber.Text = Convert.ToString(pageNumber);

    UpdatePanelBodySub4.DataBind();
}

/// <summary>
/// In actual case this function fetching record from database
/// For testing purpose I wrote like this.
/// </summary>
/// <returns></returns>
private List<SearchResult> GetRecords()
{
    List<SearchResult> strList = new List<SearchResult>();

    TextBox txtSearchCriteria =
        (TextBox)this.Parent.Parent.Parent.Parent.FindControl("headerControl1").FindControl("txtSearchCriteria");

    // this                                 --> ASP.bodysubcontrol4_ascx
    // this.Parent                          --> ASP.bodycontrol_ascx
    // this.Parent.Parent                   --> System.Web.UI.Control
    // this.Parent.Parent.Parent            --> System.Web.UI.UpdatePanel
    // this.Parent.Parent.Parent.Parent     --> ASP.maincontrol_ascx

    int recordNumberStart = ((Convert.ToInt32(txtPageNumber.Text) - 1) * 10) + 1;
    int recordNumberEnd = recordNumberStart + 9;

    for (int i = recordNumberStart; i <= recordNumberEnd; i++)
    {
        strList.Add(new SearchResult(string.Concat("DB4 :", txtSearchCriteria.Text.Trim(), " ", i.ToString())));
    }

    for (long i = 0; i < 999999999; i++)
    {
        // real case it will not come
    }

    return strList;
} 
```

}

搜索结果.cs

/// /// SearchResult 的摘要描述 /// public class SearchResult { /// /// 私有变量 /// 私有字符串 _SearchAns;

```
/// <summary>
/// Property
/// </summary>
public string SearchAns
{
    get
    {
        return _SearchAns;
    }
    set
    {
        _SearchAns = value;
    }
}

/// <summary>
/// Constructor
/// </summary>
/// <param name="CurrentSeachAns"></param>
public SearchResult(string CurrentSeachAns)
{
    _SearchAns = CurrentSeachAns;
} 
```

}

网络配置

Visual Studio 中的 Asp.Net 配置选项。设置和注释的完整列表可以在 machine.config.comments 中找到，通常位于 \Windows\Microsoft.Net\Framework\v2.x\Config --> 部分允许配置 ASP.NET 使用的安全身份验证模式以识别传入用户。--> 部分可以配置如果/当在执行请求期间发生未处理的错误时要做什么。

```
 <customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
        <error statusCode="403" redirect="NoAccess.htm" />
        <error statusCode="404" redirect="FileNotFound.htm" />
    </customErrors>
    -->
    <pages>
        <controls>
            <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        </controls>
    </pages>
    <httpHandlers>
        <remove verb="*" path="*.asmx"/>
        <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
    </httpHandlers>
    <httpModules>
        <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </httpModules>
</system.web>
<system.codedom>
    <compilers>
        <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
            <providerOption name="CompilerVersion" value="v3.5"/>
            <providerOption name="WarnAsError" value="false"/>
        </compiler>
        <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" warningLevel="4" type="Microsoft.VisualBasic.VBCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
            <providerOption name="CompilerVersion" value="v3.5"/>
            <providerOption name="OptionInfer" value="true"/>
            <providerOption name="WarnAsError" value="false"/>
        </compiler>
    </compile 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T05:58:19.500

这必须是更新面板吗？如果是我，我会使用 jQuery 和（理想情况下）MVC；那么它非常简单，例如：

```
$('#div1').load(url1, function() {
    $('#div2').load(url2, function() {
        $('#div3').load(url3, function() {
            $('#div4').load(url4);
        });
    });
}); 
```

即，我们使用每个 div 的回调来开始下一个 div 加载，但将每个 div 视为一个不相关的请求。

# sql - 日期范围的 SQL 查询

> ID：856266
> 
> 赞同：2
> 
> 时间：2009-05-13T05:51:31.603
> 
> 标签：sql, date-range

让我们再次提出问题——

```
 table1{date, bID, sName, fID}
    {11/05,B1,A1,P1}
    {12/05,B2,A2,P2}
    {13/05,B1,A3,P1}
    {15/05,B3,A4,P1}
    {16/05,B1,A5,P2}
    {19/05,B1,A6,P2} 
```

这是表，并且还指定了存储在表中的数据...

现在我想要的查询是： -

根据 fId（假设选择了 P1），它应该显示表中的数据，比如 11/05-17/05（不应该错过任何日期）。检索到的数据如下：-

```
11/05,B1,A1
12/05,--,--
13/05,B1,A3
14/05,--,--
15/05,B3,A4
16/05,--,--
17/05,--,-- 
```

显示为特定 fID（例如 P1）检索的数据。解释结果...

1) 它显示了 11/05-17/05 的所有数据，其中 fId 为 P1，如果数据库中没有日期，那么它也应该显示该日期的空值（即 14/05 日期在数据库中不存在，但是它仍然显示为空值）..

2) 如果该特定日期的 fId 不是 P1，那么它也在结果集中存储一个空值。

Atlast 在结果集中检索数据，并进一步处理..

所以我想为这个问题编写查询，是否有可能..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T07:01:53.093

这里没有代码，只是我的想法。

您需要创建一个临时表，其中包含从开始日期到结束日期的日期（包括日期）。然后`left join` `table1`使用列上的临时表`date`加上 add `where fID = ?`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T07:11:31.673

正如此处的另一个答案所提到的，一个包含所有日期的表格，并且 a`LEFT JOIN`是您所需要的。

假设你有这张桌子：

```
CREATE TABLE table1
{
    date    DATETIME
    bID     VARCHAR(10),
    sName   VARCHAR(10),
    fID     VARCHAR(10)
} 
```

然后是这个日期表：

```
CREATE TABLE dates
(
    dt      DATETIME
) 
```

在此表中，您需要拥有要显示的范围的所有日期。通常你会在两个方向上填充几年，但这取决于你。

*注意：为简单起见，我没有在任何一个表中使用主键。你当然应该确保你有一个主键，在`dates`表的情况下，它可能是`dt`列。*

然后显示你想要的结果：

```
SELECT
    dt,
    bID,
    sName
FROM
    dates
    LEFT JOIN table1 ON dt = date AND fld = 'P1'
ORDER BY
    dt 
```

请注意，仅选择`P1`行是在`JOIN`条件中完成的。如果您添加一个`WHERE`子句来做同样的事情，您将丢失所有没有数据的日期。

# java - Spring MVC isFormSubmission() 等效于注释？

> ID：856268
> 
> 赞同：3
> 
> 时间：2009-05-13T05:53:37.840
> 
> 标签：java, spring, spring-mvc

使用 Spring MVC，很容易表达一个概念，例如“如果用户使用 POST 或者如果他们包含 'isSubmit' 参数，则他们正在提交表单”。您只需扩展`SimpleFormController`并覆盖该`isFormSubmission`方法。

然而，Spring MVC 现在使用这些简洁的注解`@RequestMapping`来处理请求。 `@RequestMapping`对于某人是否使用 GET 或 POST 有一个明显的过滤器，但我看不到对 SimpleFormController 提供的所有有用逻辑的任何内在支持。我仍然可以使用注释吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T08:46:27.640

因此，经过一番调查，实际上有几种方法可以处理这种情况。

第一种方法是继续在类级别使用`SimpleFormController`with with注释。`@RequestMapping`@RequestMapping 的一个鲜为人知但非常酷的特性是它非常清楚如何处理实现 Spring`Controller`接口的类。这里唯一的缺点是我仍在使用旧的 MVC 接口和类，它们将在 Spring 3.0 中被弃用。

上面的kgiannakakis指出了第二种方式。只需为可以调用提交的每种方式创建一个`@RequestMapping`方法，并让它们都调用一个提交方法，无论是构造函数链接样式还是使用一些私有方法。简单易懂。谢谢，吉安纳卡基斯！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T07:43:29.750

[从这里](http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html#mvc-annotation)复制：

```
Path mappings can be narrowed through parameter conditions: a sequence of 
"myParam=myValue" style expressions, with a request only mapped if each such 
parameter is found to have the given value. "myParam" style expressions are 
also supported, with such parameters having to be present in the request
(allowed to have any value). Finally, "!myParam" style expressions indicate 
that the specified parameter is not supposed to be present in the request. 
```

您只能使用 RequestMapping 选项来定义所需的功能。Annotations Controller 没有实现任何可使用的接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-17T15:17:33.573

这是使用路径映射的一个示例：

```
 @RequestMapping(params = "formAction=APPROVE", method = RequestMethod.POST)
    public String myMethod ().... 
```

只有在 POST 中有一个名为“formAction”且值为“APPROVE”的字段时，才会调用此方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-15T00:00:04.077

列出的其他答案适用于使用 @RequestMapping 注释的方法。

但是，如果您想在使用 @InitBinder 注释的方法上实现相同的功能，您可以简单地执行以下操作：

```
@InitBinder
public void initBinder(HttpServletRequest request) {
    if ("POST".equals(request.getMethod()){
        //Do something
    }
} 
```

# web-services - 用于 SSRS 的动态 Web 参考

> ID：856271
> 
> 赞同：1
> 
> 时间：2009-05-13T05:54:34.780
> 
> 标签：web-services, reporting-services, asmx

要使用作为 SSRS 安装一部分的 Web 服务，您似乎需要为您的项目添加一个 Web 引用，以便您可以调用它等（请参阅[我以前的问题之一](https://stackoverflow.com/questions/818714/ssrs-get-meta-data-of-remote-report)）。

但是，如果我需要为不同的 SSRS 安装调用 Web 服务，那么我需要继续添加额外的 Web 引用。我的 asp.net 应用程序当前显示来自多个不同 SSRS 安装的报告，而不仅仅是单个服务器...

有没有办法动态添加 Web 引用或动态更改 Web 服务所在的服务器地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T13:08:14.760

您无需添加额外的网络参考。

如果您在解决方案资源管理器中选择 Web 引用，然后查看属性网格，您将看到可以将 URL 设置为动态。这将从 app.config 或 web.config 获取 URL。更改服务器时只需更改配置即可。

如果您需要在运行时执行此操作，您的服务的代理类具有`Url`您可以设置的属性。

# asp.net - 在一个站点中同时拥有 HTML 和 ASPX 网页

> ID：856273
> 
> 赞同：1
> 
> 时间：2009-05-13T05:54:54.420
> 
> 标签：asp.net, html, iis-6

我有一个在 IIS6 上运行的现有网站，它只有静态 HTML 页面。我有一个页面，有人可以通过电子邮件发送他们的信息，但想使用 ASP.NET 对此页面进行编码。

我以前从未混合过 HTML 和 ASP.NET，我想如果我从 ASP.NET 发布我需要的页面并将其放在现有网站的根目录中，这将是我所需要的，但是当我收到错误时页面尝试提交到 ASP.NET 页面。

我收到以下错误：

谢谢你的帮助！

==================================================== ==========

```
“/”应用程序中的服务器错误。
配置错误
说明：处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。

解析器错误消息：在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。

源错误：

第 44 行：ASP.NET 识别传入用户。
第 45 行：-->
第 46 行：<authentication mode="Windows" />
第 47 行：<!--
第 48 行：<customErrors> 部分启用配置

```

==================================================== ==========

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T06:13:19.537

如果您在 IIS 的虚拟目录中运行 ASP.NET，则需要将其配置为应用程序。去做这个：

1.  打开 IIS 管理器（如果开始菜单中有管理工具，则可以从那里访问 IIS）。
2.  在左侧的树中，找到您的虚拟目录
3.  右键单击目录，然后选择属性
4.  找到“应用程序名称”字段。
5.  如果文本框旁边有“创建”按钮，请单击它。如果它是“删除”按钮，那么您应该评论说这个答案是错误的。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T06:02:13.863

如果你用谷歌搜索你的错误信息，你会得到很多应该为你的问题提供解决方案的点击。

例如[这里](http://geekswithblogs.net/ranganh/archive/2005/04/25/37609.aspx)和[这里](http://forums.iis.net/p/1148147/1864289.aspx)。

# c# - 为什么不将本机 DLL 复制到输出目录

> ID：856278
> 
> 赞同：9
> 
> 时间：2009-05-13T05:55:33.937
> 
> 标签：c#, visual-studio-2008, dll

我有一个使用 .net 包装 DLL 和本机 DLL 的 C# 项目 A。我将.net包装器DLL添加到项目A的引用列表中。由于包装器DLL仅在它们位于同一文件夹中时才与本机DLL一起使用，因此应将本机DLL复制到项目A的输出目录中。我实现了这一点通过将本机 DLL 添加为项目 A 下的内容文件，并将其复制操作设置为复制（如果更新）。这可以。

如果 C# 项目 B 直接引用项目 A，VS 会将项目 A 使用的所有依赖文件复制到项目 B 的输出目录。这意味着包装 DLL 和本机 DLL 也将复制到项目 B 的输出目录。这也很好。

然后我又多了一个C#项目C，它只直接引用了项目B，而不是项目A。有趣的是VS不会将native DLL复制到项目C的输出目录，否则我打算这样做当项目 C 使用项目 B 的功能并寻找本机 DLL 以使用包装 DLL 时，它不会找到它。

有人能解释一下为什么VS不将本机DLL复制到项目C的输出目录吗？VS中复制依赖链文件的机制是什么？非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T06:02:18.650

基本上，引用链不会传播，它由最顶层的程序集（exe、网站等）来确保它拥有所需的一切，无论是在本地还是在 GAC 中（例如使用托管 dll）。您需要将文件作为“复制到输出”添加到 exe/网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T08:33:12.243

为什么不在项目 A 中添加本机 dll 作为参考？这将确保在其他库使用 A 时始终包含它。

编辑：没关系，这仅在 dll 是 COM 或 .NET 组件时才有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T11:46:17.217

因为项目中没有明确的依赖关系，所以构建器不知道那些需要与已知的二进制文件一起输出。您可以做的是创建一个构建后配置，以便在编译时将这些 DLL 复制到构建目标。您可以[谷歌如何做到这一点](http://www.google.com/search?q=visual+studio+post+build+operations&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)，这是解释如何做到这一点的第一个结果：

[http://visualstudiohacks.com/articles/general/customize-your-project-build-process/](http://visualstudiohacks.com/articles/general/customize-your-project-build-process/)

# php - 如何在 Windows XP 上使用 PHP？

> ID：856279
> 
> 赞同：0
> 
> 时间：2009-05-13T05:56:12.170
> 
> 标签：php

我想在 Windows XP 上用 PHP 编写一个示例程序。

我需要任何特殊的软件才能让它工作吗？

恐怕我只是简单地打开记事本输入 PHP 程序并使用 php 扩展名保存它。然后我用浏览器将它作为 HTML 文件打开。但它不起作用。

请帮忙

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T05:57:41.887

您需要在您的 PC 上安装一个带有 PHP 的 Web 服务器才能完成这项工作。

我强烈建议在您的计算机上安装[wampserver 。](http://www.wampserver.com/en/)它是一个 Windows 安装程序，可将 PHP、MySQL 和 Apache 放入您的计算机，让您轻松管理所有服务*等*。如果您在使用它时遇到问题，您也可以尝试[XAMPP](http://www.apachefriends.org/en/xampp-windows.html)，尽管我自己从未使用过它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T06:02:10.650

但是，您决定安装网络服务器和 php（或者只是 php 并像有人提到的那样在控制台中使用它）：

*   查看[PHP 手册](http://php.net/manual/en/)，尤其是[入门](http://php.net/manual/en/getting-started.php)部分。

**Apache**（非常非常容易）

1.  查看 WampServer[入门演示文稿](http://www.wampserver.com/en/presentation.php)。
2.  下载并安装[WampServer](http://www.wampserver.com/en/)。
3.  你准备好了。

**微软**（我自己没有测试过）

1.  查看[Windows 上的 PHP](http://www.microsoft.com/web/platform/phponwindows.aspx)。
2.  下载并安装[Microsoft Web 平台安装程序](http://www.microsoft.com/Web/downloads/platform.aspx)。
3.  让我知道结果如何......（我自己从未尝试过，因为 WampServer 非常简单）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T08:55:40.657

一些答案包含使用 wamp 的提示。您最好使用 Zend Server Community Edition。

这也是免费的，可以在这里下载： [http ://www.zend.com/de/community/zend-server-ce](http://www.zend.com/de/community/zend-server-ce)

这包含 Apache、Mysql、PHP 和一些 Zend 相关的工具。好处：它的预配置比 wamp 好得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T05:59:56.160

另一个易于设置（尽管需要额外的配置来支持 PHP5）是[easyPHP](http://www.easyphp.org/index.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T06:00:57.670

您可以简单地安装[PHP](http://www.php.net/downloads.php)，然后运行程序并重定向输出

php foo.php > output.html

然后使用任何浏览器打开该 html 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T06:07:53.760

由于您在 windows cd 上有 IIS，我建议您转到控制面板，安装/卸载程序，然后单击 windows 组件并安装 IIS。[然后从www.asp.net](http://www.asp.net)安装 ASP.NET 3.5 ，最后从[http://www.php-compiler.net/安装 Phalanger](http://www.php-compiler.net/)

这将为您带来两全其美的好处，您可以使用 PHP 作为语言在 ASP.NET 中编程，如果您愿意，您可以只使用 PHP，或者您可以在某些页面上混合使用 ASP.NET/C#，在其他页面上混合使用 PHP在同一个应用程序中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T09:55:41.563

我使用[XAMPP](http://www.apachefriends.org/en/xampp.html)，使用他的安装程序开箱即用，对于简单的开发人员 Windows 环境来说已经绰绰有余了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T03:10:32.700

最简单的方法 - 使用 www.microsoft.com/web 平台安装程序。让整个堆栈从一个地方运行 PHP。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-23T06:48:17.000

我想分享一下，在开始 PHP 之前，我们必须为此设置环境，然后我们才能开始使用 PHP。

[http://code.freefeast.info/php-tutorials/setting-up-the-environment-for-php-php-tutorial/](http://code.freefeast.info/php-tutorials/setting-up-the-environment-for-php-php-tutorial/)

# windows - 使 Windows 程序拇指驱动器可移植

> ID：856284
> 
> 赞同：1
> 
> 时间：2009-05-13T05:57:24.993
> 
> 标签：windows, portable-applications

我目前正在尝试使应用程序可移植。

应用程序将其设置放在 Windows 机器中的常见位置在哪里？

你知道除了

-注册表

-当前用户/应用程序数据

-应用程序文件夹

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T13:28:17.457

在你浏览了所有你能想到的地方之后，尝试在后台使用[Process Monitor运行你的应用程序。](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)使用正确的过滤器，它会显示哪些注册表项和文件已被访问。而且，它将显示每个操作的确切堆栈跟踪，因此您不会很难找到这些调用的来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T06:05:57.537

仅出于完整性考虑 - 注册表中有几个位置（当前用户和本地计算机）。这取决于开发人员如何存储它。

正如肖恩在评论中所说，这也取决于应用程序框架和 Windows 版本。（谢谢肖恩）

# networking - BlackBerry Simulator 上的 UDP 连接测试

> ID：856288
> 
> 赞同：1
> 
> 时间：2009-05-13T05:58:19.297
> 
> 标签：networking, blackberry, java-me, udp, rim-4.5

我正在尝试使用 UDP（数据报）发送数据。我无法在模拟器上测试应用程序。我尝试先运行 MDS，然后运行模拟器，但它不起作用。该错误显示为端口 8080 已在 BlackBerry 模拟器控制台上使用。如何更改模拟器中的端口？我连接的 UDP 端口是 localhost:5014

我正在为 BlackBerry Pearl 8100 使用模拟器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T20:36:58.730

在[Blackberry 论坛](http://supportforums.blackberry.com/rim/board/message?board.id=java_dev&message.id=15967)上有关于 4.5.0.x 到 4.5.0.83 的数据报问题的评论。难怪 sdk 中没有 UDP 样本。[您始终可以从http://na.blackberry.com/eng/developers/](http://na.blackberry.com/eng/developers/)下载带有 4.5.0.108 模拟器的 8100

另一件事是使用 ip，虽然 api 引用中允许使用主机名，但是[当您使用 MDS 模拟器时，它会获取 localhost 别名](http://www.blackberryforums.com/developer-forum/117869-http-error-403-forbidden-while-accessing-http-localhost-iis-blackberry.html)。

在下面的代码中，您有一个简单的服务器正在侦听端口 135，而 bb 客户端正在将数据包发送到端口 135 上的 127.0.0.1。

桌面服务器代码：

```
public static void main(String[] args) {
    byte[] inBuff = new byte[32];
    DatagramSocket socket;
    try {
        socket = new DatagramSocket(137);
        DatagramPacket pckt = new DatagramPacket(inBuff, inBuff.length);
        while (true) {
            socket.receive(pckt);
            System.out.println(new Date() + " " + pckt.getAddress()
                    + ":" + pckt.getPort());
            socket.send(pckt);
        }
    } catch (Exception e) {
        System.out.println(e.getMessage()+":");
        System.out.println(e.getClass().getName());
    }
} 
```

黑莓客户端代码（在 4.6.1 下使用 Bold 8900 测试）：

```
 UDPDatagramConnection connection = null;
    byte[] outBuff = "Hello!".getBytes();
    Datagram outDatagram = null;
    try {
        connection = (UDPDatagramConnection) Connector
                .open("datagram://127.0.0.1:137");
        outDatagram = connection.newDatagram(outBuff, outBuff.length);
        connection.send(outDatagram);
        System.out.println("Datagram packet was sent");
    } catch (Exception e) {
        System.out.println(e.getMessage()+":");
        System.out.println(e.getClass().getName());
    } 
```

# google-maps - 如何在地图集群而不是堆栈上有标记

> ID：856294
> 
> 赞同：0
> 
> 时间：2009-05-13T06:00:52.943
> 
> 标签：google-maps, map, cluster-analysis, geotagging

我的团队正试图在有限的时间内解决问题。我们在我们的网站上开发了一个相当复杂的地图界面来显示内容（旅行、社交内容等）。例如，当用户搜索“旧金山皮划艇”时，地图会显示旧金山的所有皮划艇旅行，但由于它们都被地理标记（使用 geonames.org）到同一个计划，地图堆栈上的标志而不是聚类。我正在四处寻找解决方案 - 你有什么想法吗？我们有 RoR - [http://www.ekoventure.com](http://www.ekoventure.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-06T14:29:44.867

不完全确定这是否会遇到您的问题，但也许您还可以查看以下文章：[在 Google 地球中分组功能以在缩小时隐藏细节](https://stackoverflow.com/questions/689336/group-features-in-google-earth-to-hide-detail-when-zoomed-out/689399#689399)

检查您链接的网站后，我会说问题更可能出在您的数据或搜索中。当我搜索“San Fransisco”时，我会得到一个与 SF 无关的搜索结果列表（例如拉斯维加斯、俄勒冈州、圣地亚哥）。地图仍然只显示旧金山市中心的标记。

您的数据是否真的经过地理编码？您是否对搜索词进行地理编码（例如使用地名），然后搜索您的数据以获取该位置某个半径范围内的项目？您实际上是根据他们自己的位置还是根据搜索的坐标在地图上绘制找到的项目？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-11T11:35:14.220

您可以在以下位置找到有关 gmap 标记聚类选项的精彩概述：[http ://www.svennerberg.com/2009/01/handling-large-amounts-of-markers-in-google-maps/](http://www.svennerberg.com/2009/01/handling-large-amounts-of-markers-in-google-maps/)

# java - 重命名所有java类、字段和方法的简单方法？

> ID：856298
> 
> 赞同：3
> 
> 时间：2009-05-13T06:01:58.980
> 
> 标签：java, obfuscation

我需要为我们的一个工具供应商发送部分代码，并且我想从我们的类中删除对我们项目的所有引用。

有几十个可用于 java 的混淆器，但我不想打乱代码，只是尽可能简单和一致地重命名。（也许这在某些混淆器中是可配置的？）最好的选择是使用类 A、B、C、方法 a1、a2、a3 之类的东西......

如果该工具以某种方式与 Eclipse 的重构/重命名选项集成，那也很棒，但这不是必需的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T06:25:26.133

[ProGuard](http://proguard.sourceforge.net/)可用于使用带有`-applymapping filename`选项的预定义映射进行混淆。结合`-dontshrink`和`-dontoptimize`选项，它可以做你想做的事。我不知道通用的 Eclipse 插件，但是如果您使用 ant 构建，则分发中包含一个任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T08:45:02.020

Eclipse 的重命名功能有什么问题？听起来您必须对重命名有所选择，因此这可能与创建某种映射文件一样快。

# c# - 使用私钥数字登录 PHP，在 C# 中验证

> ID：856302
> 
> 赞同：3
> 
> 时间：2009-05-13T06:02:25.080
> 
> 标签：c#, php, openssl, digital-signature

我正在开发一项功能，需要我在 PHP 中对短字符串进行数字签名，并在 C# 中验证字符串的签名。

我真的很想在 PHP 中使用[openssl_sign](http://php.net/openssl_sign)，因为它很简单，但我在 Google 上找到的所有信息都表明这不起作用。

有[一些外部库](http://deusty.blogspot.com/2008/08/openssl-and-rsacryptoserviceprovider.html)声称做得很好，但是由于这是一个爱好项目，我宁愿不购买这样的库。

那么这里有什么替代方案呢？需要 C# 和 PHP 之间的完全互操作性。可以使用 OpenSSL 以外的库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-01T02:26:55.690

我使用[Bouncy Castle Crypto APIs](http://www.bouncycastle.org/)做了一些非常相似的事情。看来 PHP openssl_sign 默认使用 SHA1。如果您使用的不是默认值，则需要更改 GetSigner 的算法参数。

```
string base64pubkey = "<!-- BASE64 representation of your pubkey from open ssl -->";
RsaKeyParameters pubKey = PublicKeyFactory.CreateKey(Convert.FromBase64String(base64pubkey)) as RsaKeyParameters;
byte[] signature = Convert.FromBase64String("<!-- BASE64 representation of your sig -->");
byte[] message = Encoding.ASCII.GetBytes("Something that has been signed");

ISigner sig = SignerUtilities.GetSigner("SHA1WithRSAEncryption");
sig.Init(false, pubKey);
sig.BlockUpdate(message, 0, message.Length);
if (sig.VerifySignature(signature))
{
    Console.WriteLine("all good!");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T07:34:50.060

您可以像这样检查数字签名：

```
string publicKey = "some key";
// Verifying Step 1: Create the digital signature algorithm object
DSACryptoServiceProvider verifier = new DSACryptoServiceProvider();

// Verifying Step 2: Import the signature and public key.
verifier.FromXmlString(publicKey);

// Verifying Step 3: Store the data to be verified in a byte array
FileStream file = new FileStream(args[0], FileMode.Open, FileAccess.Read);
BinaryReader reader = new BinaryReader(file2);
byte[] data = reader.ReadBytes((int)file2.Length);

// Verifying Step 4: Call the VerifyData method
if (verifier.VerifyData(data, signature))
    Console.WriteLine("Signature verified");
else
    Console.WriteLine("Signature NOT verified");
reader.Close();
file.Close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T06:08:34.553

您是否有理由需要像 SSL 签名这样复杂的东西？你不能只在字符串上使用像 MD5/SHA-1 这样的简单单向哈希吗？如果您正在寻找的只是验证字符串没有被篡改，那就足够了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T06:13:27.057

所以看看[这个](http://www.csharpbydesign.com/2008/04/asymmetric-key-encryption-with.html)- 这个家伙似乎在 PHP 和 C# 之间进行了非对称签名和加密工作。签名应该不是问题，SHA* 和 MD* 是标准的，因此不太可能不兼容（尽管您应该查看 SHA256，因为 MD* 和 SHA1 由于漏洞而被弃用）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T06:36:21.653

我们缺少一些关于您为什么需要签名的上下文。你可能不需要。

重要的问题是：您需要从数据中获得哪些保证？

如果您需要做的只是验证数据的完整性，那么哈希就可以完成这项工作。如果您需要验证它的来源，则需要对其进行签名。如果两者都需要，请对其进行哈希处理，将有效负载与哈希连接起来，然后对整个内容进行签名。

关于跨平台库......你真的应该担心它。一个 SHA1 是一个 SHA1 是一个 SHA1，不管是哪个库生成的。生成和验证数字签名也是如此。使用 PHP 中最简单的东西并使用 C# 中最简单的东西。如果它们都设置正确，则无需担心。

# c# - 文本框中不允许零

> ID：856303
> 
> 赞同：2
> 
> 时间：2009-05-13T06:03:22.690
> 
> 标签：c#, wpf, forms, input-filtering

我需要一个只有用户才能允许输入整数的文本框。但是用户不能输入零​​。即，他可以输入 10,100 等，而不仅仅是 0。如何在 KeyDown 中进行活动？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T07:20:14.407

The way you plan to do this, is very annoying for a user. You're guessing what a user wants to enter, and act upon your guess, but you can be so wrong.

It also has holes, for example, a user can enter "10" and then delete the "1". Or he could paste in a "0" -- you do allow paste, don't you?

So my solution would be: let him enter any digit he likes, any way he likes, and validate the input only *after* he finished, for example, when the input loses focus.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T06:27:22.497

为什么不使用 NumericUpDown 并进行以下设置：

```
upDown.Minimum = 1;
upDown.Maximum = Decimal.MaxValue; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T06:19:12.803

使用[int.TryParse](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)将文本转换为数字并检查该数字是否不为 0。使用[Validating](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.validating.aspx)事件进行检查。

```
// this goes to you init routine
textBox1.Validating += textBox1_Validating;

// the validation method
private void textBox1_Validating(object sender, CancelEventArgs e)
{
    if (textBox1.Text.Length > 0)
    {
        int result;
        if (int.TryParse(textBox1.Text, out result))
        {
            // number is 0?
            e.Cancel = result == 0;
        }
        else
        {
            // not a number at all
            e.Cancel = true;
        }
    }
} 
```

**编辑：**

好的，既然您使用 WPF，您应该看看如何实现[WPF 方式的验证](http://www.codeproject.com/KB/WPF/wpfvalidation.aspx)。这是一个实现上述逻辑的验证类：

```
public class StringNotZeroRule : ValidationRule
{
    public override ValidationResult Validate(object value, CultureInfo cultureInfo)
    {
        if (textBox1.Text.Length == 0)
            return new ValidationResult(true, null);

        int result;
        if (int.TryParse(textBox1.Text, out result))
        {
            // number is 0?
            if (result == 0)
            {
                return new ValidationResult(false, "0 is not allowed");
            }
        }
        else
        {
            // not a number at all
            return new ValidationResult(false, "not a number");
        }

        return new ValidationResult(true, null);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T06:35:55.727

这是主题的另一个变体：

```
private void textBox1_KeyDown(object sender, KeyEventArgs e)
{
    char newChar = Convert.ToChar(e.KeyValue);
    if (char.IsControl(newChar))
    {
        return;
    }
    int value;
    e.SuppressKeyPress = int.TryParse((sender as TextBox).Text + newChar.ToString(), out value) ? value == 0 : true;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T06:28:23.197

```
 private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
    {
        if (textBox1.Text == "" && e.KeyChar == '0')
        {
            e.Handled = true;
            return;
        }
        if (e.KeyChar < '0' || e.KeyChar > '9')
        {
            e.Handled = true;
            return;
        }

    } 
```

不好，但它有效

# sql-server - 在 Visual Studio 数据库项目中更改运行操作

> ID：856304
> 
> 赞同：2
> 
> 时间：2009-05-13T06:04:29.583
> 
> 标签：sql-server, visual-studio-2008

我在 Visual Studio 2008 中有一个数据库项目，我希望能够在我的 sql 代码上运行预处理器（使用它来允许可变数据库名称而不诉诸动态 sql）。所以我想改变当我点击运行按钮时发生的动作，包括通过预处理器自动运行代码。

有没有办法做到这一点？我查看了 dbp 文件，似乎没有任何选项接近这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T11:49:39.910

一种选择是在您的数据库项目脚本中 使用**[SQLCMD 模式。](http://msdn.microsoft.com/en-us/library/aa833281.aspx)**
（VS 菜单：数据 -> TSQL 编辑器 -> SQLCMD 模式）。

在您的脚本中，您可以定义在运行它们时被替换的变量。例子：

```
:SETVAR tablevar Customers
GO
SELECT * FROM $(tablevar) /* translates to SELECT * FROM Customers */ 
```

# css - wordwrap 一个很长的字符串

> ID：856307
> 
> 赞同：74
> 
> 时间：2009-05-13T06:05:58.583
> 
> 标签：css, string, long-integer, word-wrap

如何使用自动换行符显示长字符串、网站地址、单词或符号集以保持 div 宽度？我猜是一种自动换行。通常添加空格是可行的，但是否有 CSS 解决方案，例如自动换行？

例如，它（非常讨厌）重叠 div，强制水平滚动等。

我可以在上面的字符串中添加什么以使其整齐地放在 div 或浏览器窗口的几行中？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-05-13T06:09:53.663

这个问题之前在这里被问过：

*   [谁解决了 long-word-breaks-my-div 问题？（提示：不是stackoverflow）](https://stackoverflow.com/questions/320184/who-has-solved-the-long-word-breaks-my-div-problem-hint-not-stackoverflow)
*   [css / js中的自动换行](https://stackoverflow.com/questions/322929/word-wrap-in-css-js)
*   [CSS：如何强制将长字符串（没有任何空白）包装在 XUL 和/或 HTML 中](https://stackoverflow.com/questions/499137/css-how-can-i-force-a-long-string-without-any-blank-to-be-wrapped-in-xul-and-o)
*   [带有长 URL 的 CSS 溢出](https://stackoverflow.com/questions/850055/css-overflow-with-long-url)

长话短说：

就 CSS 解决方案而言，您有：`overflow: scroll;`强制元素显示滚动条并`overflow:hidden;`截断任何额外的文本。有`text-overflow:ellipsis;`，`word-wrap: break-word;`但它们只是 IE（`break-word`但是在 CSS3 草案中，所以这将是 5 年后的解决方案）。

底线是，如果通过将文本换行到下一行来阻止这种情况发生对您来说非常重要，那么唯一合理的解决方案是注入 `&shy;`（软连字符）、[`<wbr>`](http://www.quirksmode.org/oddsandends/wbr.html)（分词标记）或[`&#8203;`](http://en.wikipedia.org/wiki/Zero-width_space)（零宽度空格，与`&shy;`字符串服务器端中的减号连字符相同的效果。但是，如果您不介意 Javascript，那么有一个似乎相当可靠的[连字符。](http://code.google.com/p/hyphenator/)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-12-15T07:28:18.847

`word-wrap: break-word;`适用于 IE7+、FF 3.5 和支持 Webkit 的浏览器（Safari/Chrome 等）。要处理 IE6，您还需要声明`word-wrap: break-all;`

如果 FF 2.0 不在您的浏览器矩阵中，那么使用这些是一个可行的解决方案。不幸的是，它不会在单词被破坏的前一行连字，这是一个印刷噩梦。我建议使用 Paolo 建议的连字符，这是不显眼的 JavaScript。非 JavaScript 用户的后备将是不带连字符的断词。我暂时可以忍受。这个问题很可能出现在 CMS 中，其中网页设计者无法控制将输入的内容或可以实现换行符和软连字符的位置。

我查看了讨论 CSS3 中的断字的[W3 规范。](http://www.w3.org/TR/css3-text/#hyphenate)不幸的是，似乎有一些建议，但还没有具体的建议。似乎浏览器供应商还没有实现任何东西。我已经检查了 Mozilla 和 Webkit 的专有代码，但没有任何迹象。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-07-19T15:47:46.850

`word-break:break-all`工作一种享受

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-04-27T02:37:03.273

刚刚在[这里](https://stackoverflow.com/questions/5356752/webkit-hyphenation/10344017#10344017)提到了这一点，但可能与这个问题更相关。很快最好的属性将是溢出包装。如果它得到实施，最好的价值是：

```
* {
   overflow-wrap:hyphenate. 
} 
```

在 iphone 或 firefox 上撰写本文时，似乎还没有以任何方式得到支持，并且 overflow-wrap:hyphenate 甚至不在工作草案中。

同时我会使用：

```
p {
    word-wrap: break-word;
    -moz-hyphens:auto; 
    -webkit-hyphens:auto; 
    -o-hyphens:auto; 
    hyphens:auto; 
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-25T16:06:45.273

```
显示：块；
溢出：隐藏；
文本溢出：省略号；
宽度：200px；// 或者任何最适合你的

```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-02-14T07:21:28.897

我使用代码来防止所有长字符串、url 等..

```
 -ms-word-break: break-all;

/* Be VERY careful with this, breaks normal words wh_erever */
     word-break: break-all;

/* Non standard for webkit */
     word-break: break-word;
-webkit-hyphens: auto;
   -moz-hyphens: auto;
        hyphens: auto; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-13T06:19:24.660

希望有一天我们可以访问`word-wrap`CSS3 中的属性：[Force Wrapping: the 'word-wrap' property](http://www.w3.org/TR/css3-text/#word-wrap)。

总有一天...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-02T01:55:09.870

通常 Cells 会自然而然地执行此操作，但您可以使用以下命令强制 div 执行此行为：

```
div {
  width: 950px;
  word-wrap: break-word;
  display: table-cell;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-20T11:16:58.753

始终指定 line-height 属性 - 如果您不指定，可能会导致您的`word-break: break-all;`属性失败。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-01T16:46:18.737

似乎这对最新的 Chrome 有用：

```
[the element],
[the element] * {
  word-wrap: break-word;
  white-space: pre;
} 
```

除了 Chrome，我没有检查任何浏览器。

# dll - 如何在 ActiveX/COM 对象中搜索方法？

> ID：856309
> 
> 赞同：1
> 
> 时间：2009-05-13T06:06:21.157
> 
> 标签：dll, scripting, activex, tlbinf32

我有一个 ActiveX/COM DLL。它包含许多方法和属性。根据以下代码段，我希望能够询问它是否具有特定符号：

```
If HasMethod( "StdLib.DLL", "ReadFileE" ) Then
    ...
End If 
```

有没有办法从 VBScript 或 JScript 中做到这一点？如果没有，我应该去哪里获取我需要的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T02:33:22.777

在谷歌搜索并没有找到我想要的东西之后，我想起了[Edanmo](http://www.mvps.org/emorcillo/en/code/vb6/index.shtml)网站，它让我想到了 TLBINF32.DLL，下载了微软的[TLBINF32.CHM](http://support.microsoft.com/kb/224331)并阅读了 GetMembersWithSubStringEx。下面是它的实现（在 VB6 中完成，参考 TLBINF32.DLL），一些演示 VBScript 和输出，以及在一些 VBA 中包装该功能。

```
Public Function SearchTLIMethodsAndProperties(sTypelib As Variant, sSymbol As Variant) As Variant
    Dim SI As SearchItem
    Dim aResults As Variant
    Dim bFound as boolean
    Dim Groups(1) As InvokeKinds
    Groups(0) = INVOKE_FUNC Or INVOKE_PROPERTYGET Or _
        INVOKE_PROPERTYPUT Or INVOKE_PROPERTYPUTREF

    ReDim aResults(0)
    bFound = False
    With TypeLibInfoFromFile(sTypelib)
    .SearchDefault = tliStClasses Or tliStEvents
    For Each SI In .GetMembersWithSubStringEx(sSymbol, Groups)
        bFound = True
        arr.AAdd_PostIncrement aResults, SI.Name
    Next
    End With
    if bFound then 
    ReDim Preserve aResults(UBound(aResults) - 1)
    end if
    SearchTLIMethodsAndProperties = aResults
End Function 
```

VBScript 演示。上面的代码包含在我的注册表 coclass 中的 StdLib DLL 中。

```
Dim O, R
Set O = CreateObject("Std.Registry")
Set R = CreateObject("Std.Arrays")
WScript.Echo R.ShowStructure( O.SearchTLIMethodsAndProperties( "MSSCRIPT.OCX","")) 
```

演示的输出（脚本在 SciTE 中运行）。

```
>cscript "C:\foo\foo.vbs"
{Add,AddCode,AddObject,AllowUI,Clear,CodeObject,Column,Count,Description,Error,Eval,ExecuteStatement,HasReturnValue,HelpContext,HelpFile,Item,Language,Line,Modules,Name,NumArgs,Number,Procedures,Reset,Run,SitehWnd,Source,State,Text,Timeout,UseSafeSubset}
>Exit code: 0 
```

最后是 VBA 代码。一个单元格中有一个符号，这个例程找到它或返回一个错误字符串。

```
Public Function LookupSymbol(sSym As String) As String
    Dim aRes As Variant
    aRes = reg.SearchTLIMethodsAndProperties("MSSCRIPT.OCX", sSym)
    Dim i As Integer
    LookupSymbol = "!!NotFound!!"
    For i = 0 To UBound(aRes)
    If LCase$(aRes(i)) = LCase$(sSym) Then
        LookupSymbol = sSym
        Exit For
    End If
    Next
End Function 
```

现在回想起来，我想我可能会将 DLL/OCX 的路径作为第一个参数传入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T10:22:13.173

我使用 Microsoft 的交互式 OLE/COM-Object 查看器在 ActiveX-DLL 中查找方法及其参数。也许查看查看器的源代码会引导您朝着正确的方向前进：[MSDN OleView 示例](http://msdn.microsoft.com/en-us/library/w9yyfff5(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T00:02:37.077

如果您想以编程方式执行此操作 - 我不知道有一种*简单*的方法可以做到这一点。[无论如何，如果您真的需要（并且如果您的编程语言足够强大） - 您可以查询类型库（请参阅http://msdn.microsoft.com/en-us/library/ms221549.aspx](http://msdn.microsoft.com/en-us/library/ms221549.aspx)上的 ITypeLib 描述）。

此外，如果您已经有一个 IDispatch 指针 - 您可能会考虑使用它的服务来动态枚举接口支持的方法（请参阅 MSDN 中的 IDispatch 描述）。

# jquery - ASP.Net UpdatePanel + Gridview + Hyperlinks + jQuery nyroModal 插件 - 整个新窗口打开，但我只想要一个模式

> ID：856311
> 
> 赞同：0
> 
> 时间：2009-05-13T06:07:03.340
> 
> 标签：jquery, asp.net-ajax, updatepanel, nyromodal

我有一个 UpdatePanel，里面有一个 GridView。

Gridview 有一个包含超链接的 TemplateColumn。

在页面的开头使用 jQuery，我将所有这些超链接设置为 nyroModal 模态超链接。也就是说，当您单击它们时，目标页面将加载到模式对话框中。这段代码是：

```
<script type="text/javascript">
    $(document).ready(function(){
        $(".modal").nyroModal();
    });
</script> 
```

如果我删除了 UpdatePanel，那么上面的 nyromodal 代码可以很好地工作。但是有了 UpdatePanel，它会填充 nyroModal 调用，并在 Firefox 中将链接作为原始的全新窗口/标签打开。UpdatePanel 试图太聪明并启动回发等。

我是否必须在渲染时以某种方式注册每个按钮的 nyromodal 调用，或者告诉.Net/UpdatePanel“远离地狱”？我玩了一下 RegisterClientScriptBlock 等，但似乎无法让它开心。使用 .Net 服务器端代码注册客户端脚本似乎很麻烦。我觉得它很麻烦而且令人沮丧:)

非常感谢您的任何建议或见解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T06:50:45.343

试试这个：

```
<script type="text/javascript">
    $(document).ready(function(){
        /*
            This binds a callback to the click event of all 
            elements with the 'modal' class, even ones that are
            updated inside an UpdatePanel.
        */
        $(".modal").live('click', function(){
            /*
                When the element is clicked, open the nyroModal dialog
                manually. (If the element is a link, nyroModal will 
                automatically get the content based on the link's href attribute.)
            */
            $(this).nyroModalManual();
        });
    });
</script> 
```

## 编辑

我创建了一个看起来运行良好的页面。完整的源代码如下。

**注意：**在上面的代码中有一件重要的事情我没有做。我忘了阻止链接实际更改浏览器位置，所以请注意`evt.preventDefault();`下面的代码（抱歉：P）。

```
<%@ Page Language="C#" %>
<script runat="server">
  public void Page_Load()
  {
    BindGridViewUrls();
  }

  public void GridViewUrls_PageIndexChanging(object sender, GridViewPageEventArgs e)
  {
    GridViewUrls.PageIndex = e.NewPageIndex;
    BindGridViewUrls();  
  }

  public void BindGridViewUrls() {
    var Urls = new[]{
      new {UrlText="Google", Url="http://google.com"},
      new {UrlText="Stack Overflow", Url="http://stackoverflow.com"},
      new {UrlText="XKCD", Url="http://xkcd.com"},
      new {UrlText="Google Reader", Url="http://google.com/reader"},
      new {UrlText="reddit", Url="http://reddit.com"},
      new {UrlText="Hacker News", Url="http://news.ycombinator.com"},
      new {UrlText="Ubuntu", Url="http://ubuntu.com"},
      new {UrlText="Twitter", Url="http://twitter.com"},
      new {UrlText="YouTube", Url="http://youtube.com"},
      new {UrlText="Wikipedia", Url="http://en.wikipedia.org"},
      new {UrlText="Coding Horror", Url="http://codinghorror.com"},
      new {UrlText="Mozilla", Url="http://mozilla.org"},
      new {UrlText="jQuery", Url="http://jquery.com"},
      new {UrlText="NyroModal", Url="http://nyromodal.nyrodev.com/"},
    };
    GridViewUrls.DataSource = Urls;
    GridViewUrls.DataBind();
  }
</script>
<!DOCTYPE
  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
  <title>UpdatePanel Test</title>
  <script 
    src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js">
  </script>
  <script src="jquery.nyroModal-1.4.2.js"></script>
  <script>
    $(function(){
      $('.modal').live('click', function(evt){
        $(this).nyroModalManual({minWidth:750});
        evt.preventDefault();
      });
    });
  </script>
</head>
<body>
  <form runat="server">
  <div>
    <asp:ScriptManager runat="server">
    </asp:ScriptManager>
    <asp:UpdatePanel runat="server">
      <ContentTemplate>
        <asp:GridView runat="server" ID="GridViewUrls" AllowPaging="true"
          PageSize="5" OnPageIndexChanging="GridViewUrls_PageIndexChanging">
          <Columns>
            <asp:HyperLinkField DataTextField="UrlText"
              DataNavigateUrlFields="Url" ControlStyle-CssClass="modal"
            />
          </Columns>
        </asp:GridView>
      </ContentTemplate>
    </asp:UpdatePanel>
  </div>
  </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T09:35:11.363

我建议您使用 jquery UI 中的对话框。

参考这个如何使用它：http: [//jqueryui.com/demos/dialog](http://jqueryui.com/demos/dialog)

我已经实现了类似于你想要使用对话框的东西，它工作正常。
您只需要将对话框添加回表单，如下所示：

```
jQuery(".modal").each(function() {
      var popup = jQuery(this);
      popup.parent().appendTo(jQuery("form:first"));
}); 
```

# mono - 我在哪里可以查看 Math.* 或 Substring 等的 Mono 实现

> ID：856312
> 
> 赞同：0
> 
> 时间：2009-05-13T06:07:16.537
> 
> 标签：mono, open-source

问题说明了一切。我尝试浏览最新的[标签](http://anonsvn.mono-project.com/viewvc/tags/moon/1.9.1/mono/)，但找不到上述功能的实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T06:15:19.193

[Math.cs](http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/corlib/System/Math.cs?view=markup)和[String.cs](http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/corlib/System/String.cs?view=markup)。我同意这有点棘手，尽管月亮绝对是错误的地方。

# c# - C# 后台工作人员在 DoWork 中设置 e.Result 并在 WorkCompleted 中获取价值

> ID：856313
> 
> 赞同：17
> 
> 时间：2009-05-13T06:07:28.410
> 
> 标签：c#, backgroundworker

C# 2008 SP1

我正在使用后台工作人员

如果其中一个条件失败，我会将 e.cancel 设置为 true，并将字符串分配给 e.result。一切都在那里工作。

但是，当 workCompleted 触发时，我测试 e.Result 并得到一个异常“e.result 抛出 systeminvalidoperation 类型的异常”。

我想我可以使用全局变量在 DoWork 中设置并在完成的工作中进行比较。但这可能不是线程安全的。

谁能告诉我为什么我用 e.Result 得到这个，我该如何解决这个问题？

非常感谢，

```
 private void bgwPrepareCall_DoWork(object sender, DoWorkEventArgs e)
    {
        // Check to see if the called number is blocked. 
        // If the nubmer is blocked display error message.
        if (this.IsNoGateway(sipUsername, statusDisplay1.PhoneNumber))
        {
            // this.SetIdleState(DialerErrorMessage.GetErrorDescription(12));
            e.Cancel = true;
            e.Result = "NoGateway";
            return;
        }

        if (!this.IsInvalidTelephoneNumber(sipUsername, statusDisplay1.PhoneNumber))
        {
            // this.SetIdleState(DialerErrorMessage.GetErrorDescription(13));
            e.Cancel = true;
            e.Result = "InvalidNumber";
            return;
        }
    }

    private void bgwPrepareCall_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        if (e.Error == null)
        {
            if (e.Cancelled)
            {
                // Failed
                switch (e.Result.ToString())
                {
                    case "NoGateway":
                        Console.WriteLine("NoGateway: [ Failed ]");
                        break;

                    case "InvalidNumber":
                        Console.WriteLine("InvalidNumber: [ Failed ]");
                        break;

                    default:
                        Console.WriteLine("Unknown");
                        break;
                }
            }
            if (!e.Cancelled)
            {
                // Successfull
                Console.WriteLine("NoGateway: [ ok ]");    
                Console.WriteLine("InvalidNumber: [ ok ]");
            }
        }
        else
        {
            Console.WriteLine("PrepareCall Failed: [ " + e.Error.Message + " ]");
        }
    } 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-13T06:13:51.207

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.runworkercompleted.aspx)：

> 如果操作成功完成并在 DoWork 事件处理程序中分配其结果，则可以通过 RunWorkerCompletedEventArgs.Result 属性访问结果。

[和](http://msdn.microsoft.com/en-us/library/system.componentmodel.runworkercompletedeventargs.result.aspx)：

> 您的 RunWorkerCompleted 事件处理程序应始终在访问 Result 属性之前检查 Error 和 Canceled 属性。如果引发异常或取消操作，则访问 Result 属性会引发异常。

因此，如果它*没有*成功完成（即您取消它），它看起来将无法正常工作。也许考虑返回您的取消详细信息作为您的中止案例的结果（作为成功），以检测完成处理程序中的差异？

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-13T06:11:00.197

该`Result`属性旨在表示已*完成*操作的结果。您已设置`Cancel`为 true，这意味着操作已取消，因此不应该有结果。

听起来您应该将“我因出现问题而中止”编码到您的结果中，或者抛出一个异常，该异常将被设置为`Error`结果中的属性 -`Cancel`如果工作人员注意到调用被外部取消，则应设置该异常.

状态的文档[`RunWorkerCompletedEventArgs.Result`](http://msdn.microsoft.com/en-us/library/system.componentmodel.runworkercompletedeventargs.result.aspx)：

> 您的 RunWorkerCompleted 事件处理程序应始终在访问 Result 属性之前检查 Error 和 Canceled 属性。如果引发异常或取消操作，则访问 Result 属性会引发异常。

`Cancelled`文档的“异常”部分还指出，如果为真，它将引发异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T06:21:06.513

这很可能是因为代码取消了工作而不是完成它。所以尝试访问 if(!e.Cancel) 分支中的结果。

# jquery - Jquery手风琴和thickbox冲突

> ID：856320
> 
> 赞同：1
> 
> 时间：2009-05-13T06:09:46.173
> 
> 标签：jquery, accordion, thickbox

我在同一页面上使用thickbox 和手风琴时遇到问题，即它们都不起作用。我已经检查过他们都使用最新版本的 jquery。以下是我的包括。不包含其他 jscript 文件。如果这会导致问题，我会在 wordpress 模板上使用它。

```
<script type="text/javascript" src="<?php bloginfo('url'); ?>/wp-content/themes/foxintouch/javascript/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="<?php bloginfo('url'); ?>/wp-content/themes/foxintouch/javascript/jquery.accordion-1.2.2.js"></script>
<script type="text/javascript" src="<?php bloginfo('url'); ?>/wp-content/themes/foxintouch/javascript/jquery.accordion-1.2.2.source.js"></script>

<!-- thickbox -->

<script type="text/javascript" src="<?php bloginfo('url'); ?>/wp-content/themes/foxintouch/javascript/thickbox/thickbox.js"></script>
<link rel="stylesheet" href="<?php bloginfo('url'); ?>/wp-content/themes/foxintouch/javascript/thickbox/thickbox.css" type="text/css" media="screen" /> 
```

这是对手风琴的调用：

```
$(document).ready(function () {
 $('#sidebar ul').accordion();
 }); 
```

我网站的网址是[http://clients.bionic-comms.co.uk/fox/foxintouch-wp/issue/13/wesco-new-range/](http://clients.bionic-comms.co.uk/fox/foxintouch-wp/issue/13/wesco-new-range/) 任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T08:35:38.777

您的编码包括对两个版本的 jquery 库的引用。第一个 (jquery-1.3.2.min.js) 使用手风琴插件进行了扩展，但随后被第二个库 (jquery.js) 覆盖。

这破坏了您的`$('#sidebar ul').accordion();`代码，因为第二个 jquery 库不包含该`accordion`函数的定义（只有第一个 jquery 库使用手风琴插件进行了扩展）。

一旦你删除了第二个 jquery 库，thickbox 就会停止工作，因为thickbox 3.1 不支持 jQuery 1.3+，但这可以通过[在thickbox.js 中更改一行](http://codylindley.com/thickboxforum/comments.php?DiscussionID=1726&page=1#Item_0)来轻松解决：

```
TB_TempArray = $("a[@rel="+imageGroup+"]").get(); 
```

到

```
TB_TempArray = $("a[rel="+imageGroup+"]").get(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T06:31:02.147

我不确定你为什么在你的网站上使用 noConflict 函数——这是为了禁用 jQuery 中的 $ 快捷方式，以便它可以与 Prototype 等冲突库一起使用。由于您的网站似乎只使用基于 jQuery 的代码，因此您不需要它。

禁用 $ 快捷方式会导致 Thickbox 的代码出现致命错误，进而导致整个页面的 JS 崩溃。

尝试摆脱 noConflict 代码，直接调用accordian 函数，如下所示：

```
 $(document).ready(function () {
     $('#sidebar ul').accordion();
 }); 
```

此外，您不应该同时包含 jquery.accordion-1.2.2.js 和 jquery.accordion-1.2.2.source.js，只需单独使用压缩版本 jquery.accordion-1.2.2.js。

# c++ - Why is it necessary to add new events to the *end* of an IDL interface?

> ID：856321
> 
> 赞同：2
> 
> 时间：2009-05-13T06:09:50.683
> 
> 标签：c++, events, com, dll, idl

I have found that when I add new events to an existing COM/IDL interface, I sometimes run into strange issues unless they are added to the end of the interface.

For example, say I have the following interface:

```
interface IMyEvents
{
    HRESULT FooCallback(
        [in] long MyParam1,
        [in] long MyParam2,
        [in] long MyParam3);

    HRESULT BarCallback(
        [in] long MyParam1,
        [in] BSTR MyParam2,
        [in] BSTR MyParam3);
}; 
```

Now let's say I want to add a new callback event, `NewCallback`. If I add it like this, I tend not to have any problems when the event is fired across COM:

```
interface IMyEvents
{
    HRESULT FooCallback(
        [in] long MyParam1,
        [in] long MyParam2,
        [in] long MyParam3);

    HRESULT BarCallback(
        [in] long MyParam1,
        [in] BSTR MyParam2,
        [in] BSTR MyParam3);

    /* New event added to the end */
    HRESULT NewCallback(
        [in] BSTR MyParam1,
        [in] BSTR MyParam2,
        [in] BSTR MyParam3);
}; 
```

But if I add it like this, I can run into all sorts of problems (e.g. buffer overruns) when the event is fired.

```
interface IMyEvents
{
    HRESULT FooCallback(
        [in] long MyParam1,
        [in] long MyParam2,
        [in] long MyParam3);

    /* New event added to the middle */
    HRESULT NewCallback(
        [in] BSTR MyParam1,
        [in] BSTR MyParam2,
        [in] BSTR MyParam3);

    HRESULT BarCallback(
        [in] long MyParam1,
        [in] BSTR MyParam2,
        [in] BSTR MyParam3);
}; 
```

I'm guessing it has something to do with DLL entry points, address offsets, or something similar. Or maybe it's because I haven't re-built something properly, and adding it to the end allows it to work by sheer luck.

Can anyone explain this behaviour?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T07:03:24.450

You are not supposed to modify an existing COM interface. Clients that were not compiled with the change are not aware of it and will continue calling as they had done before the change.

The result is that existing clients call BarCallback with a long integer, but instead get NewCallback that thinks this long integer is a BSTR. The results are often unpleasent.

You'll get similar problems with adding new functions at the end. Older COM object do not have the new function implemented and will likely just crash when you try to call it.

However, if you do not have existing clients in the wild using the old interface, just make sure you unregister everything and replace the object, clients and proxies and stubs you generated.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T07:23:49.843

I do not think it has anything to do with adding the code at the end.

I remember adding function in the mid of the interface file.

But whenever you modify it, ensure that you unregister the dll and regenerate all the files again. (as mentioned in previous post) Be precise in all the steps because debugging this stuff at runtime is tough.

# iconv - 任何 PHP 或 Ruby 库可以将繁体中文转换为简体中文，反之亦然？

> ID：856323
> 
> 赞同：0
> 
> 时间：2009-05-13T06:10:09.637
> 
> 标签：iconv, big5

是否有任何 PHP 或 Ruby 库可以将繁体中文转换为简体中文或反之亦然（Big5 <--> GB）？iconv 库不会这样做，因为它只是转换编码，但字形保持不变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T06:12:27.310

试试这个类的 PHP - [http://www.phpclasses.org/browse/package/3130.html](http://www.phpclasses.org/browse/package/3130.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-09T18:38:05.733

您可能会在 1.9 中获得一些杠杆作用

> > Encoding.constants.grep /gb/i => [:GB18030, :GBK, :GB1988, :GB12345]
> > 
> > Encoding.constants.grep /big5/i => [:Big5, :BIG5, :Big5_HKSCS, :BIG5_HKSCS, :Big5_UAO, :BIG5_UAO]

所以它就像

[如何在 Ruby 中将字符串从 windows-1252 转换为 utf-8？](https://stackoverflow.com/questions/951891/how-can-i-convert-a-string-from-windows-1252-to-utf-8-in-ruby)

original = File.open('name', 'r:original_encoding').read

original.force_encoding('new_encoding')

虽然我从未尝试过。

# javascript - Javascript中new Boolean()的目的是什么？

> ID：856324
> 
> 赞同：72
> 
> 时间：2009-05-13T06:10:21.430
> 
> 标签：javascript, boolean

有什么用：

```
var flag = new Boolean(false); 
```

相比：

```
var flag = false; 
```

你什么时候真正使用`new Boolean`？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-05-13T09:35:47.837

全局函数`Boolean()`可用于在不带 的情况下进行类型转换`new`，例如

```
var foo = Boolean(bar); // equivalent to `var foo = !!bar` 
```

当使用 调用时`new`，将另外创建一个包装器对象，这意味着您可以为该对象分配任意属性：

```
var foo = new Boolean(bar); // equivalent to `var foo = Object(Boolean(bar));`
foo.baz = 'quux';
alert(foo.baz); 
```

这对于原始值是不可能的，因为原始值不能保存属性：

```
var foo = true;
foo.baz = 'quux';
alert(foo.baz); // `foo.baz` is `undefined` 
```

由于自动装箱，将属性分配给基元不会产生错误，即

```
foo.baz = 'quux'; 
```

将被解释为

```
// create and immediately discard a wrapper object:
(new Boolean(foo)).baz = 'quux'; 
```

要取回原始值，您必须调用该`valueOf()`方法。如果您想实际使用包装的值，则需要这样做，因为对象总是`true`在布尔上下文中求值 - 即使包装的值是`false`.

我从来没有遇到过能够将属性分配给布尔值的有用应用程序，但是在需要引用原始值的情况下，装箱可能很有用。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-06-21T06:29:06.320

在其他人提到理论的时候，让我谈谈实践部分：

因为`Boolean`对象（作为一般对象）总是真实的，所以使用它们被认为是不好的做法。在多年的JS编程中，我从来没有使用过它们，我也不记得`Boolean`在别人的代码中看到过s。一次都无。

使用原始值将避免混淆，并使您的代码更短一些。

如果您需要一个包含在对象中的 bool，您不妨使用`Object`这样的对象：

```
foo = { value: false }; 
```

此外，将`Boolean()`构造函数作为函数调用（如在 中`foo = Boolean(bar)`）与使用的显式类型转换具有相同的效果`!!`，并且后者通常优于前者。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-14T01:18:30.563

在上述问题之前首先是布尔函数，`Boolean ()`

```
Boolean(10 > 4) // return true
Boolean(4 > 9) // return false 
```

下一步：所有具有真实值的东西都返回 true。例如

```
100
-4
4.4
"hello"
"false" // note even the string value false return true. 
```

没有实际价值的一切都返回假，例如

```
NaN 
var x = 10 / "H"; // Boolean(x); return false.
undefined
"" 
0
-0
false 
null 
```

现在该`Boolean`对象是一个布尔值的对象包装器。如有必要，作为第一个参数传递的值将转换为布尔值。如果省略 value 或 is`0, -0, null, false, NaN, undefined`或空字符串 ( `""`)，则对象的初始值为 false。所有其他值，包括任何对象或字符串“false”，都会创建一个初始值为 true 的对象。

这允许非常强大的技巧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-23T20:59:45.027

有趣的问题：

您使用 new Boolean 创建一个布尔对象。可能有很多情况，但我在下面讨论了一种情况。

假设您想要在代码中进行比较，您想要匹配字符串值及其数据类型，并且它必须为 bool (true/false)，那么您将使用新的 boolean 而不是分配简单的 false 值。

```
var flag = false;  
var flag2 = new Boolean (false);
alert(typeof flag);  //boolean object
alert(typeof flag2); //simple object

if (flag === flag2){
    alert("Value and datatype match");
}
else{
    alert("Value and datatype do not match");
} 
```

# regex - 正则表达式从电子邮件回复中获取指导

> ID：856327
> 
> 赞同：14
> 
> 时间：2009-05-13T06:12:03.457
> 
> 标签：regex, guid

如果电子邮件包含 Guid，则试图找出匹配的正则表达式模式，例如

> a141aa94-3bec-4b68-b562-6b05fc2bfa48-reply@site.com

Guid 可能位于 @ 之前的任何位置，例如

> 回复-a141aa94-3bec-4b68-b562-6b05fc2bfa48@wingertdesign.com

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-13T06:14:41.783

我用它来查找指南

```
Regex isGuid = new Regex(@"^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$", RegexOptions.Compiled); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-13T06:34:05.260

一个懒惰的变体是

([0-9a-f-]{36}).*?@

它易于阅读，我敢打赌它匹配所有案例的 99.99% ;) 但是在所有案例的 0,00001% 中，某人可能有一个适合 GUID 方案的电子邮件地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T06:17:19.407

好吧，假设它总是采用这样的标准 GUID 表示法，如果以下正则表达式匹配，则存在 GUID。您还应该应用您的语言使其不区分大小写的方法。

```
[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}[^@]*@ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T06:18:49.840

```
^[^@]*([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}) 
```

将匹配 @ 之前的 8-4-4-4-12 格式中的任何十六进制

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-21T16:32:44.467

还有一种方法可以在一行中获取 GUID

```
 string findGuid = "hi Aether experiment 1481de3f-281e-9902-f98b-31e9e422431f @sdfsf 1481de3f-281e-9902-f98b-31e9e422431f"; //Initialize a new string value
 var guids = Regex.Matches(Regex.Split(findGuid, "@")[0], @"(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}")[0]; //Match all substrings in findGuid 
```

# 64-bit - 在 64 位 Linux 上使用 DMD 编译或使用 32 位目标文件链接

> ID：856328
> 
> 赞同：2
> 
> 时间：2009-05-13T06:12:17.357
> 
> 标签：64-bit, linker, 32-bit, d, dmd

在 64 位机器上用 DMD 编译程序的最佳方法是什么？它不需要编译为 64 位代码。我知道 GDC，但也想与 D2 合作。还有 chroot，但我希望有一个更简单的方法。

实际问题不在于编译，而在于链接。DMD 调用 GCC 以执行与系统库的链接。我可以让 DMD 拥有针对 32 位库的 GCC 链接吗？或者我将如何手动完成？

我已经安装了 ia32 库，这就是我可以运行 DMD 的原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T06:37:54.070

`'-m32'`要求 GCC 通过传递它的标志来执行 32 位链接。

似乎`DMD`没有调用`gcc`来执行链接，而是`ld`直接调用。等效的`ld`开关是`'-melf_i386'`，显然将该`DMD`选项传递给链接器的方法是使用`'-L-melf_i386'`标志。

请注意，许多系统将运行时库和开发库分开。默认情况下几乎总是安装 32 位运行时包，但可能不会安装 32 位开发包。

您需要*开发*32 位软件包来构建 32 位程序。32 位`DMD`可以运行的事实本身并不能证明您拥有构建 32 位程序所需的所有 32 位库。

# encoding - Iconv 库的编码转换有什么好的替代方案吗？

> ID：856336
> 
> 赞同：3
> 
> 时间：2009-05-13T06:14:08.477
> 
> 标签：encoding, iconv, big5

我在 Ruby 上使用 Iconv 库将编码从 UTF-8 转换为 UTF-32、UTF-16 等，效果非常好。

但是，在从 Big5 转换为 UTF-8 时，我确实看到了一个问题——无效序列引发了异常......

当它从 CP950 转换为 UTF-8 时问题就消失了，其中 CP950 本质上是 Big5 ......

所以我想知道除了使用Iconv之外是否还有其他好的选择？还是CP950是Big5的更好版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T07:12:10.580

看看[ICU](http://site.icu-project.org/)，它是一个进行字符转换的库。

另一方面，其他答案表明您可能需要更仔细地检查您的编码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T06:31:34.843

Big5和CP950虽然差不多，但还是有区别的。在 Unicode 网站上有将不同编码转换为 Unicode 的参考文件，您会看到[Big5](http://www.unicode.org/Public/MAPPINGS/OBSOLETE/EASTASIA/OTHER/BIG5.TXT)和[CP950](http://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WINDOWS/CP950.TXT)是不同的。我对 Iconv 的体验很好——我怀疑它的行为可能是正确的。

在 CP950 中找到但在 Big5 中没有找到的一些字符具有十六进制值：`0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F, 0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D, 0x2E, 0x2F, 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E, 0x3F, 0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x49, 0x4A, 0x4B, 0x4C, 0x4D, 0x4E, 0x4F, 0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57, 0x58, 0x59, 0x5A, 0x5B, 0x5C, 0x5D, 0x5E, 0x5F, 0x60, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6A, 0x6B, 0x6C, 0x6D, 0x6E, 0x6F, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7A, 0x7B, 0x7C, 0x7D, 0x7E, 0x7F, 0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87, 0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F, 0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97, 0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F, 0xA0, 0xA1, 0xA15A, 0xA1C3, 0xA1C5, 0xA1FE, 0xA240, 0xA3E1, 0xA2CC, 0xA2CE`. 如果您的任何输入包含这些值，则该文件不是有效的 Big5。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T06:43:05.573

有很多很多 big5 变体。CP950 只是其中之一。 [http://www.moztw.org/docs/big5/](http://www.moztw.org/docs/big5/)

对于big5，我建议使用“big5-2003”，这是官方更新版本。

# business-objects - 备用行着色：业务对象 - WebIntelligence

> ID：856337
> 
> 赞同：0
> 
> 时间：2009-05-13T06:14:10.643
> 
> 标签：business-objects, business-intelligence

我是 WebI 上的 n00b。有人可以告诉我如何在 BO CrossTab 中进行交替行着色。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T08:54:43.970

您没有说您使用的是什么版本，但在 XI R2 及更高版本中，它会自动应用于块。要手动应用它，请选择块（整个交叉表周围的虚线边框），然后在“显示”下的属性中，有一组称为“交替行/颜色”的选项。指定非白色行的颜色，频率告诉 XI 应用替代颜色的频率。

在以前的版本中，您可以使用以下代码创建一个新变量：

```
=Mod(LineNumber(),2) 
```

然后在此变量等于 1 时（即奇数行）将警报器添加到交叉表以将背景颜色设置为您的替代颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T06:05:27.610

我正在 BO XI 3.0 中创建一个网络智能报告，我需要在行中创建具有所需替代颜色 (239,239,239) 的块。当我尝试将非白色行的默认颜色（240,240,240）更改为任何其他颜色时，颜色将应用于块的所有行中的所有主体单元格。我也检查了频率，它设置为 2。但我不确定为什么会出现这个问题..??

# c# - 代码与数据库中事务的效率

> ID：856342
> 
> 赞同：5
> 
> 时间：2009-05-13T06:15:47.133
> 
> 标签：c#, .net, database

什么更有效——在 .net 代码中有一个 IDbTransaction 或在数据库中处理它？为什么？

应该使用其中任何一个的可能场景是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T06:20:07.967

`IDbTransaction`对于基于连接的事务（如果您**在**TSQL 中进行事务管理，您应该将其限制为单个 TSQL 查询。开始/结束可能会有额外的往返，但这不太可能伤害你。

我手动编写基于 TSQL 的事务非常罕见（这些天）——也许如果我正在编写由服务器通过代理（而不是从我自己的应用程序代码）直接调用的东西。

更大的区别在于`IDbTransaction`和`TransactionScope`查看[.net 中的事务以](https://stackoverflow.com/questions/224689/transactions-in-net/224702#224702)获取更多信息，但简短版本`TransactionScope`稍慢（取决于场景），但可以跨越多个连接/数据库（或其他资源）。

# iphone - How do I draw a line on the iPhone?

> ID：856354
> 
> 赞同：43
> 
> 时间：2009-05-13T06:20:19.527
> 
> 标签：iphone, cocoa-touch, quartz-graphics

I am a beginner at iPhone programming, and would like to draw a line to the phone screen for the purpose of study using Quartz and UIKit.

How do I start drawing?

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-05-13T09:19:57.237

The first step is to define a subclass of UIView, to create a space to draw in.

If you're starting with a new application, the easiest way will be to start with the "Window-based application" template.

Then go New File and create an "Objective-C Class" with "Subclass of" set to "UIView", and give it a name, say MyView.m.

Now open up the "Resources" group and double click on "MainWindow.xib" to open it in Interface Builder. From here you should see a window named "Window". Hit Cmd+Shift+L to bring up the Library, and drag a "View" component onto your window, and position it so you can see all of it. With your new View selected, hit Cmd+4 to bring up the Identity Inspector and under "Class Identity", click the dropdown and choose MyView.

Next, you need to implement the drawRect: method in MyView.m, here's some example code that draws a line:

```
- (void)drawRect:(CGRect)rect {
    CGContextRef c = UIGraphicsGetCurrentContext();

    CGFloat red[4] = {1.0f, 0.0f, 0.0f, 1.0f};
    CGContextSetStrokeColor(c, red);
    CGContextBeginPath(c);
    CGContextMoveToPoint(c, 5.0f, 5.0f);
    CGContextAddLineToPoint(c, 50.0f, 50.0f);
    CGContextStrokePath(c);
} 
```

Save everything and click "Build and Run", you should now see a short red line on the iPhone.

For more information about Core Graphics, look up the Apple Documentation. I've also found it helpful to search for functions beginning with CGContext in the Xcode documentation viewer, and browse through those - most of the Core Graphics functions you'll end up using will start with the term "CGContext".

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-21T05:53:11.513

You can also draw a line using `UIBezierPath`. The following will draw a vertically-centered horizontal line:

```
- (void)drawRect:(CGRect)rect {
    CGFloat rectHeight = CGRectGetHeight(rect);
    CGFloat rectWidth = CGRectGetWidth(rect);

    UIBezierPath *line = [UIBezierPath bezierPath];
    [line moveToPoint:CGPointMake(0, rectHeight / 2)];
    [line addLineToPoint:CGPointMake(rectWidth, rectHeight / 2)];

    [[UIColor lightGrayColor] setStroke];
    [line stroke];
} 
```

# sql - Oracle死锁检测工具

> ID：856358
> 
> 赞同：0
> 
> 时间：2009-05-13T06:20:51.367
> 
> 标签：sql, oracle, deadlock, code-analysis, static-analysis

我正在寻找一个 Oracle 查询和 PL/SQL 过程（触发器、约束等）的静态分析器 - 一个将传递我们的数据库方案并指向潜在死锁的工具。就像Java 的[FindBugs](http://findbugs.sourceforge.net/)一样。

如果这样的工具不存在，你想要吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:31:48.957

从 10g 开始，数据库现在内置了一个静态 PL/SQL 分析器：

```
ALTER SESSION SET PLSQL_WARNINGS = 'ENABLE:ALL'; 
```

有一个 PLSQL_WARNINGS 的谷歌，你会发现一些有用的参考资料

不过，我同意 Matthew 的观点，您不太可能找到一种能够特别有效地检测死锁的分析器……有太多变量在起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T23:11:59.610

死锁将取决于事务而不是静态代码。Oracle 中没有“BEGIN TRANSACTION”语句的概念，因此静态分析器无法知道事务的起点是什么。假设，可以编写一个分析器，如果给定一个起始 SQL 或 PL/SQL 语句，它可以跟踪所有潜在的执行路径并确定哪些表以什么顺序受到更新/删除/插入/合并语句的影响。然后，您可以“比较”其中的两个（或更多）结果，并确定是否有任何表以不同的顺序进行操作（例如，TAB_A 然后 TAB_B 一个，TAB_B 然后 TAB_A 另一个）。我怀疑这会引发很多误报。

在 Oracle 中，选择不锁定（SELECT...FOR UPDATE 除外）。因此，死锁仅在数据更新时发生，并且仅在两个并发事务尝试更新相同行时发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T09:28:49.627

TOAD 有一些静态分析（或至少某种代码质量）工具。我怀疑他们是否能够找到死锁。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-13T11:34:42.510

任何数据库中都有无穷无尽的死锁可能性。因此，该工具需要使用统计数据来了解哪些死锁在统计上每年会发生一次以上。这样的工具过于复杂，无法证明开发工作的合理性。

最常见的做法是将数据库安装在问答或生产环境中。然后监控实际发生的死锁。您可以针对问答环境运行自动化单元测试来模拟负载。

# vb6 - 从 VB6 在 Excel 中格式化

> ID：856361
> 
> 赞同：1
> 
> 时间：2009-05-13T06:21:44.890
> 
> 标签：vb6, excel, vba

我正在使用 Excel 自动化创建一个 Excel 工作表并向其写入数据。我想知道如何仅将特定单元格设为 BOLD，以及如何使单元格大小自动适应其内容。请帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T06:43:28.397

有一种简单的方法可以了解如何使用代码在 Excel 中执行操作：宏录制。

由于 Excel 通过 COM 接口提供他的 API，因此 VBA、VB 脚本和用其他语言编写的程序非常相似。所以，运行宏录制，做你想要自动化的事情，打开录制的宏进行编辑并查看代码。

在您的情况下，它看起来像这样：

```
Range("B2").Select                      -- particular cell selection
ActiveCell.FormulaR1C1 = "123"          -- cell text fill
Selection.Font.Bold = True              -- enabled bold cell style
Columns("B:B").EntireColumn.AutoFit     -- autofitted column 
```

那是VBA代码。VB6 将几乎相同，除了一件事：您应该使用 Excel.Worksheet 对象执行此命令。请参考这样的教程：[http](http://www.vbforums.com/showthread.php?t=391665) ://www.vbforums.com/showthread.php?t=391665 - 了解更多信息。

祝你好运！

# c# - 覆盖 DataGridView 的 OnMouseDown 会禁用复选框，即使在调用父方法时也是如此

> ID：856363
> 
> 赞同：1
> 
> 时间：2009-05-13T06:23:12.907
> 
> 标签：c#, winforms, datagridview, drag-and-drop

我正在研究 .NET 2008 winforms，我正在尝试将对象从 DataGridView 拖放到其他控件。所以我不得不重写 OnMouseDown 事件处理程序。因为我在那里有复选框，所以它们的状态永远不会改变。这是我的重写方法

```
public class SeriesGrid : DataGridView
{

    protected override void OnMouseDown(MouseEventArgs e)
    {
        base.OnMouseDown(e);
        DataGridViewSelectedRowCollection selectedRows = this.SelectedRows;
        if (selectedRows.Count == 0) return;

        List<AppDataSeries> toDrag = new List<AppDataSeries>();
        for (int i = 0; i < selectedRows.Count; i++)
        {
            toDrag.Add((AppDataSeries)selectedRows[i].DataBoundItem);
        }
        this.DoDragDrop(toDrag, DragDropEffects.Copy);

    }

} 
```

DoDragDrop 似乎是导致问题的原因，因为如果我删除它，复选框可以正常工作，但是我没有任何东西可以放入其他控件

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T06:51:32.923

好的，这很hacky - 但它有效。它会在拖动中插入一个小延迟，允许检查/取消检查正常工作：

（已编辑以包含`cancelDrag`以帮助避免一些 UI 故障与点击）

```
volatile bool cancelDrag;
protected override void OnMouseUp(MouseEventArgs e)
{
    cancelDrag = true;
    base.OnMouseUp(e);
}
protected override void OnMouseDown(MouseEventArgs e)
{
    base.OnMouseDown(e);
    cancelDrag = false;
    ThreadPool.QueueUserWorkItem(delegate
    {
        Thread.Sleep(250);
        if (!cancelDrag)
        {
            BeginInvoke((MethodInvoker)delegate
            {
                if (!cancelDrag)
                {
                    // your code here...
                    var sel = this.SelectedRows;
                    if (sel.Count > 0)
                    {
                        this.DoDragDrop("test", DragDropEffects.All);
                    }
                }
            });
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T06:30:10.523

尝试`base.OnMouseDown(e);`在方法结束时调用。

# wcf - WCF 平台独立吗？

> ID：856368
> 
> 赞同：6
> 
> 时间：2009-05-13T06:26:43.103
> 
> 标签：wcf, cross-platform

我只需要知道 WCF 是否像 Webservices 一样独立于平台？Java和Php可以访问WCF中的函数吗？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-13T06:30:35.750

是的，当然——WCF 本身只能在 Windows 上运行——但它提供的服务可以从任何其他语言/工具访问。

并且使用 WCF 作为客户端，您还可以访问任何其他工具的服务，例如，您可以访问用 PHP、Java 等编写的 Web 服务。

这就是SOA的全部**意义所在！**:-)

马克

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T06:30:36.217

是的，WCF 是 Web 服务的超集。它既可以进行独立于平台的通信，也可以进行依赖于平台的通信。您只需要选择 wsXXX 绑定之一。

有关 WCF 支持的绑定列表，请参见此处：http: [//msdn.microsoft.com/en-us/library/ms730879.aspx](http://msdn.microsoft.com/en-us/library/ms730879.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T10:41:54.687

是的，如果您使用符合标准的绑定（名称中包含 WS 的任何绑定，例如 WsHttpBinding）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T13:04:43.983

WCF*是*Web 服务——还有更多。它取代了旧的 ASMX 服务功能。

# .net - 接口中的委托和事件？

> ID：856371
> 
> 赞同：1
> 
> 时间：2009-05-13T06:27:24.133
> 
> 标签：.net

我们可以在接口中实现委托和事件吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T06:30:25.767

您可以在接口中指定事件，但不能声明委托（或任何其他类型）——至少在 C# 中不能。例如：

```
// Valid
public delegate void BarHandler(object sender, EventArgs e);        
public interface IFoo
{
    event BarHandler Bar;
}

// Invalid
public interface IFoo
{
    delegate void BarHandler(object sender, EventArgs e);        
    event BarHandler Bar;
} 
```

# vim - 我可以将程序的输出重定向到 gvim 吗？

> ID：856372
> 
> 赞同：44
> 
> 时间：2009-05-13T06:28:10.480
> 
> 标签：vim

我想将某些 Windows 程序的输出直接重定向到 gvim，基本上是为了搜索输出。比如说 findstr cmd 的结果。是否可以在不将其转储到文件并随后将该文件加载到 gvim 的情况下执行此操作？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-05-13T06:30:19.697

当然：

```
dir | gvim - 
```

该`-`选项告诉`vim`打开`stdin`

这适用于 Windows 和 Linux 版本。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-13T06:33:04.653

如果您已经在 Vim 中，您可以使用以下`r`命令读取：

```
:r !<cmd> 
```

例如

```
:r !dir 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T06:33:55.277

你可以从 vim 中读取它

```
:r !dir (for example) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-27T17:26:03.030

AFAIK，Mac OS 上没有 gvim。

如果你在 mac 上使用 MacVim，我会这样做：

```
dir | /Applications/MacVim.app/Contents/MacOS/Vim - 
```

当 Vim 在终端启动时，输入

```
<esc>:gui 
```

那应该启动 MacVim（vim 的 gui 版本）

# c# - 列出一些免费 C# 视频播客的网站

> ID：856375
> 
> 赞同：13
> 
> 时间：2009-05-13T06:29:16.253
> 
> 标签：c#

有人可以列出一些网站，我可以在其中找到一些与 C# 相关的视频播客吗？（当然是免费的）。

我知道的唯一一个是 dnrtv.com。

谢谢

编辑：到目前为止根据我的搜索和您的答案建立的列表......请继续添加更多......谢谢

1.  [http://www.dnrtv.com](http://www.dnrtv.com)
2.  [http://www.ScreenCastADay.com](http://www.ScreenCastADay.com)
3.  [http://www.videos.gridviewguy.com/VideoCategories.aspx](http://www.videos.gridviewguy.com/VideoCategories.aspx)
4.  [http://msdn.microsoft.com/en-us/vcsharp/bb798022.aspx?wt.slv=TopSectionSee](http://msdn.microsoft.com/en-us/vcsharp/bb798022.aspx?wt.slv=TopSectionSee)
5.  [http://www.dimecasts.net/](http://www.dimecasts.net/)
6.  [http://www.learncsharp.com/FreeVideos/](http://www.learncsharp.com/FreeVideos/)
7.  [http://channel9.msdn.com/shows/ARCast_with_Ron_Jacobs/](http://channel9.msdn.com/shows/ARCast_with_Ron_Jacobs/)
8.  [http://www.intelligentedu.com/blogs/post/best_new_training_sites/3710/top-19-c-tutorial-videos-on-youtube](http://www.intelligentedu.com/blogs/post/best_new_training_sites/3710/top-19-c-tutorial-videos-on-youtube)
9.  [http://www.free-ebook-download.net/video-training/2894-c-complete-video-tutorials.html](http://www.free-ebook-download.net/video-training/2894-c-complete-video-tutorials.html)
10.  [http://knowfree.net/2006/12/03/visual-c-video-tutorial.kf](http://knowfree.net/2006/12/03/visual-c-video-tutorial.kf)
11.  [http://highoncoding.com/Categories/22_Videos.aspx](http://highoncoding.com/Categories/22_Videos.aspx)
12.  [http://windowsclient.net/learn](http://windowsclient.net/learn)
13.  [http://www.asp.net/learn/](http://www.asp.net/learn/)
14.  [http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2007/05/10/9322.aspx](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2007/05/10/9322.aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T07:07:50.743

惊讶地发现[DimeCast](http://www.dimecasts.net/)还没有被提及 - 短（大约 10 分钟）、专注和高质量。推荐的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T06:36:59.843

[第九频道](http://channel9.msdn.com) （各种视频）

[MSDN How Do I Videos for C#](http://msdn.microsoft.com/en-us/vcsharp/bb798022.aspx?wt.slv=TopSectionSee)（仅与 c# 相关）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T07:05:22.510

这是另一个。

[http://www.learnvisualstudio.net/](http://www.learnvisualstudio.net/)

你可以在这里获得很棒的 C# 视频。但它不是免费的。

对于免费视频，您可以访问以下网站： http: [//www.learncsharp.com/FreeVideos/](http://www.learncsharp.com/FreeVideos/)

[http://www.intelligentedu.com/blogs/post/best_new_training_sites/3710/top-19-c-tutorial-videos-on-youtube](http://www.intelligentedu.com/blogs/post/best_new_training_sites/3710/top-19-c-tutorial-videos-on-youtube)

[http://www.free-ebook-download.net/video-training/2894-c-complete-video-tutorials.html](http://www.free-ebook-download.net/video-training/2894-c-complete-video-tutorials.html)

[http://knowfree.net/2006/12/03/visual-c-video-tutorial.kf](http://knowfree.net/2006/12/03/visual-c-video-tutorial.kf)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T04:32:50.250

对于 Windows 窗体和 WPF： http:
[//windowsclient.net/](http://windowsclient.net/)

对于 ASP.NET Web 窗体和 ASP.NET MVC：
[http ://www.asp.net/](http://www.asp.net/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T17:33:45.910

[http://www.ScreenCastADay.com](http://www.ScreenCastADay.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T06:32:46.793

毫不奇怪，之前有人问过这个问题：[https ://stackoverflow.com/questions/54423/best-net-podcasts/393209#393209](https://stackoverflow.com/questions/54423/best-net-podcasts/393209#393209)

关于视频有 ArchCast.tv（现在是第 9 频道的一部分）

[http://channel9.msdn.com/shows/ARCast_with_Ron_Jacobs/](http://channel9.msdn.com/shows/ARCast_with_Ron_Jacobs/)

# html - 提交到外部网站并让网站从重定向提交到另一个页面

> ID：856378
> 
> 赞同：0
> 
> 时间：2009-05-13T06:29:44.550
> 
> 标签：html, redirect, web, submit, external

我必须有一个页面提交到外部网站。不是问题。

问题是外部网站显示成功消息，不好，我需要获取提交它的网站以重定向到更用户友好的网站。外部网站不会重定向，如果我将重定向页面传递给它，我认为这可能是最简单的。

无论如何，对于最简单和省力的方法有什么建议吗？我读到有一个 iFRAME。还有其他方法吗？

提前致谢！

这些是静态 HTML 页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T09:34:53.327

既然您说“外部站点不会重定向”，我假设您无法控制它。

这意味着你有我能想到的三种可能的方法。

1.  通过您自己的服务器代理请求。这是安全的选项，但不会使用第三方网站期望用户提供的任何 cookie。
2.  使用 iframe 并假设它永远不会失败（因为您无法读取结果）。它可能会出错或超时，而您无法进行补偿。
3.  使用 Java Applet（或类似的），并让用户接受一系列可怕的安全警告（如果他们甚至安装了 Java 插件）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T06:34:33.247

我假设您无法触摸外部站点的标记。

如果它们是静态的，那么您就缺少解决方案。我经常使用 cURL 库来提供这种功能（在幕后发布到外部站点）。

您也许可以使用 iframe 和 JavaScript 来实现。将表单的目标设置为 iframe 的名称（可能使用 CSS 隐藏 iframe）。然后，它应该提交罚款。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-13T07:48:50.507

IFRAME 解决方案似乎是最简单的，但如果发生错误，您可能不会注意到。

如果要提交的站点返回可预测的标记，那么 AJAX 路由会更可取，因为它允许您的站点解析并响应帖子的结果。但是，它很容易受到禁用 JavaScript 的用户的攻击。

可能最好的解决方案是编写您的标记以使用 IFRAME 技术，但在表单上放置一个“onsubmit”处理程序。如果启用了 JavaScript，则处理程序可以执行 AJAX 操作 - 否则 IFRAME 解决方案将启动。

请记住在启用 JavaScript 时将“return false”添加到 onsubmit 属性，以防止 IFRAME 提交。

```
<form action="http://external.server/submission.html" 
      target="id_of_your_IFRAME" 
      onsubmit="submitViaAJAX(); return false">
    ... form fields ...
</form> 
```

# svn - 我的 Windows 服务器 Subversion 文件位于何处？

> ID：856386
> 
> 赞同：0
> 
> 时间：2009-05-13T06:31:20.257
> 
> 标签：svn

我刚刚使用博客文章*[http://blogs.vertigosoftware.com/teamsystem/archive/2006/01/16/Setting_up_a_Subversion_Server_under_Windows.aspx](http://blogs.vertigosoftware.com/teamsystem/archive/2006/01/16/Setting_up_a_Subversion_Server_under_Windows.aspx)* 在 Windows Server 2003 上设置了 Subversion 。

我想通过 Web 访问查看更改，以便我提交的任何更改都将直接显示在我的网站上。

SVN 服务器的那些文件在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T07:02:30.707

Subversion 存储库被烘焙到存储在“c:\Documents and Settings\Subversion Repository”中的关系数据库中（根据您提供的链接）。

如果您想使用 HTTP 浏览存储库的 HEAD，您需要使用 Subversion 模块安装 Apache。

一旦你配置了它，你将能够浏览你的存储库访问（例如）[http://localhost/svn/myproject](http://localhost/svn/myproject)。有关详细信息，请参阅[SVN 书](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.httpd.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T02:29:53.657

我为此找到了一个很好的解决方案。

我所要做的就是玩一个提交后的脚本。您深入了解存储库文件夹的挂钩目录，您所需要的就在那里。

我刚刚使用“svn update”命令更新了服务器的目录。并且您需要在 post-commit 文件中编写脚本。

最终，任何提交都会更新服务器的文件，我可以直接从 URL 中看到更改。

在 Windows 上，我创建了 post-commit.bat 文件，并在其中放置了以下脚本。

```
@ECHO ON

set repo=%1
set rev=%2
set log=C:\subversion\logs\post-commit_log.log
set err=C:\subversion\logs\post-commit_err-log.txt
set svn=svn
set svnpath=C:\subversion\bin
set working=C:\wamp\www\myproject

( echo ========================================================================
echo Start commit %repo% r%rev%
date /t
time /t
) >> %log%

set cmd=%svn% update --username uSeRnAmE  --password StRoNgPaSsWoRd %working%
(start "start-title" /D"%svnpath%" /NORMAL /B %cmd% >> %log%) 
```

# java - 在 Java 中设置断点

> ID：856388
> 
> 赞同：16
> 
> 时间：2009-05-13T06:31:43.160
> 
> 标签：java, debugging, jvm, breakpoints

在 Java 中设置断点是如何工作的？它只是基于源文件名和行号吗？类或方法名称是否也包含在内？

如果我的调试器中有旧版本的源代码并设置了断点，那么当我单步执行时光标会关闭。能走多远？它会进入错误的方法（如果该文件中有多个类，甚至是错误的类）？

当 JVM 中有多个同名的类时会发生什么（如果您有多个类加载器，可能会发生这种情况）？他们都得到断点吗？

在 Web 应用程序容器中，我可以只为一个 Web 应用程序（而不是其他应用程序）设置断点吗？

其中有多少是特定于 IDE 的，又有多少是由 JVM 提供的调试接口决定的？例如：在 Eclipse 中，我可以根据变量的值设置条件断点。这只是 Eclipse 在 JVM 中的无条件断点上完成的过滤吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-13T07:04:54.663

有不同种类的断点。有些断点是基于行的，有些则不是。这如何影响您的实际调试取决于您的 IDE 实际执行的操作。例如，在 Eclipse 中，如果您在方法的中间添加断点，那将是基于行的断点。如果在包含方法签名的行上添加断点，那将是方法入口断点。

如果您正在查看的源代码不是正在运行的类的确切源代码，那么行断点当然不会映射到正确的行上。所以 java 可能不会停在你想要的那一行，你的 IDE 确实可能会向你显示错误的方法甚至错误的类。但是方法入口断点仍然有效（在正确的时刻停止），即使定义方法的行发生了变化；但是 IDE 可能再次在调试器中显示错误的行。（还有其他类型的事件/断点，例如类加载，...如果您想了解更多关于内部的信息，可以查看[EventRequest的子接口）。](http://docs.oracle.com/javase/7/docs/jdk/api/jpda/jdi/com/sun/jdi/request/EventRequest.html)

回答您的另一个问题：断点适用于 JVM 中的所有类加载器。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T05:23:59.697

JVM 支持用于调试的标准 API（请参阅[Java Platform Debugger Architecture](http://docs.oracle.com/javase/7/docs/technotes/guides/jpda/)），并且所有 IDE 都使用 JPDA 来完成设置断点、计算表达式等所有繁重的工作。IDE“只是”将其包装在漂亮的用户界面中。

当您设置断点时，IDE 会与 JVM 的工具接口（JDPA 的一部分）对话，并为其提供断点的源文件和行号。JVM 拥有将断点的物理位置映射到类的已编译代码中 Java 语句的实际位置所需的信息。当 JVM 到达断点时，它会停止执行该线程并告诉 IDE 断点的源文件和行号。然后 IDE 会向您显示该位置。

当我调试时，我有时会添加或删除行来解决问题，然后继续处理下一个问题。但是事情变得很奇怪，因为断点现在似乎比我预期的早或晚，而且如果我设置新的断点，它们实际上并不在我设置它们的源代码行。发生这种情况时，我重新启动程序，然后 IDE 和 JVM 再次保持一致。

# asp.net - Web 应用程序的 LINQ 数据上下文生命周期管理

> ID：856392
> 
> 赞同：0
> 
> 时间：2009-05-13T06:33:46.383
> 
> 标签：asp.net, linq

我阅读[了 Linq to SQL DataContext 的多个/单个实例](https://stackoverflow.com/questions/226127/multiple-single-instance-of-linq-to-sql-datacontext)和[http://www.west-wind.com/weblog/posts/246222.aspx](http://www.west-wind.com/weblog/posts/246222.aspx)

我正在开发一个网络应用程序。在我的 blclass 中，有许多方法可以对 DB 进行一些查询，在每种方法中，我声明：

> Dim db 作为新的 DemoDataClassesDataContext

为每个事务创建一个新的 DataContext 实例。我想知道这是否会成为性能**问题**或我不知道的任何其他问题。这是正确的方法吗？

我应该使用：

> **将db 作为新的 DemoDataClassesDataContext**或**使用 db 作为新的 DemoDataClassesDataContext**

我知道 .NET 中的所有对象最终都会由自动垃圾收集器自动处理。

using 语句是在语句之​​间的代码运行后处理对象。

在这篇博客文章[http://lee.hdgreetings.com/2008/06/linq-datacontex.html](http://lee.hdgreetings.com/2008/06/linq-datacontex.html)中说“**在 Datacontext 上调用 Dispose 通常并不重要。** ”

我还不清楚如何管理 Web 应用程序的 LINQ 数据上下文提升时间。任何建议都非常感谢。

谢谢你。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-13T06:43:40.457

> using 语句是在语句之​​间的代码运行后处理对象。

这是不正确的。当代码退出 using 范围时， using 将在对象上调用 finally。这将反过来在底层数据库连接上调用 close。因此，您需要 using 语句来确保数据库连接已关闭。

**编辑：**

您实际上不必在数据合同上调用 dispose，只要您按此处讨论的那样枚举整个结果集：[我何时应该处理数据上下文](https://stackoverflow.com/questions/389822/when-should-i-dispose-of-a-data-context)

# c# - 突出显示组合框中的特定项目

> ID：856397
> 
> 赞同：2
> 
> 时间：2009-05-13T06:34:27.943
> 
> 标签：c#, winforms, .net-2.0

我有一个场景，我正在使用模板名称填充组合框。在模板中，一个是默认模板。我想在填充组合框时突出显示默认模板名称（以便用户知道项目中的哪一个是默认的）。有可能这样做吗？如果是怎么办？我在 C# 2.0 中使用 Windows 窗体。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T10:41:44.013

这在一定程度上取决于您希望如何突出显示该项目。如果您想以粗体呈现默认项目的文本，您可以这样实现（为此，您需要将`DrawMode`ComboBox 的 设置为`OwnerDrawFixed`，当然还要将 DrawItem 事件连接到事件处理程序）：

我已经用模板对象填充了组合框，定义如下：

```
private class Template
{
    public string Name { get; set; }
    public bool IsDefault { get; set; }

    public override string ToString()
    {
        return this.Name;
    }
} 
```

...并且 DrawItem 事件是这样实现的：

```
private void ComboBox_DrawItem(object sender, DrawItemEventArgs e)
{
    if (e.Index < 0)
    {
        return;
    }
    Template template = comboBox1.Items[e.Index] as Template;
    if (template != null)
    {

        Font font = comboBox1.Font;
        Brush backgroundColor;
        Brush textColor;

        if ((e.State & DrawItemState.Selected) == DrawItemState.Selected)
        {
            backgroundColor = SystemBrushes.Highlight;
            textColor = SystemBrushes.HighlightText;
        }
        else
        {
            backgroundColor = SystemBrushes.Window;
            textColor = SystemBrushes.WindowText;
        }
        if (template.IsDefault)
        {
            font = new Font(font, FontStyle.Bold);
        }
        e.Graphics.FillRectangle(backgroundColor, e.Bounds);
        e.Graphics.DrawString(template.Name, font, textColor, e.Bounds);

    }
} 
```

我希望这应该让你朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T06:41:18.090

设置组合框的 DrawMode = System.Windows.Forms.DrawMode.OwnerDrawVariable。并且，重写 Combobox_MeasureItem() 和 Combobox_DrawItem() 方法来实现这一点。

# asp.net-mvc - ASP.NET MVC，模型文件夹是干什么用的？

> ID：856405
> 
> 赞同：6
> 
> 时间：2009-05-13T06:36:34.663
> 
> 标签：asp.net-mvc

App_Code 的另一个存储库？在 NerdDinner 示例中，它包含一些共享接口、函数、具有属性的类等。与 App_Code 没有太大区别。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T08:05:35.190

Models 文件夹存在的基本思想是保留您使用的对象。这是为了维护 MVC 范式（模型-视图-控制器）的约定。在基本的 ASP.NET MVC 应用程序中，您将 L2S DataContext 类或 EF 上下文类存储到 Models 文件夹中。

Models 文件夹中需要额外的类（文件）可以用部分类的概念来解释：DataContext 文件中的所有类都是部分的，因此可以使用额外的属性和方法进行扩展。

如果您将 MVC 应用程序划分为多个项目，则根本不需要使用 Models 文件夹，因为您的 DAL 将位于您从 MVC Web 应用程序引用的 DLL 中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T06:39:46.873

与 App_Code 非常不同，因为 App_Code 文件夹被视为内容并在运行时编译。App_Code 在这方面很特别。顺便说一句，如果您想从代码中获取编译器错误而不是运行时错误，则应该远离 App_Code。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T16:56:32.670

模型是 MVC 中的 M。尽管默认项目模板中没有提供任何功能，但它旨在供数据访问技术使用。无论是 Web 服务、ado.net、linq to sql、nhibernate 等。

当然你不必把它放在那里你可以把项目的每个部分放在它自己的项目中，这取决于你。它只是用来帮助促进 MVC 模式，并没有实际功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T06:39:14.550

模型文件夹更像是 MVC-模型视图控制器的约定。您可以使用任何文件夹来存储您的模型，甚至在另一个程序集中，这取决于您的项目结构要求或愿望。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T06:51:01.317

我们通常将 dbml 存储在该文件夹中。正如@diadiora 解释的那样，您可以添加程序集或数据层代码。

这是一种聚合 MVC 模式的功能方面的方法。就像您启动 Ruby on Rails 应用程序时一样，我认为 Microsoft 正在尝试执行固执己见的编程和结构原则。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T07:30:40.987

在我们使用 llblgen 模型的项目中，我有一个名为 llblgen 的文件夹用于生成模型，还有一个文件夹 custom 用于我们自己构建的东西。

你可以对文件夹做你想做的事，只是试着把事情组织得有点合乎逻辑，这样不熟悉你项目的人就能理解它。

# asp.net - 关于 AjaxControlToolKit 的错误

> ID：856410
> 
> 赞同：0
> 
> 时间：2009-05-13T06:37:45.053
> 
> 标签：asp.net, ajaxcontroltoolkit

当我运行一个页面时，我收到以下解析错误。

> 解析器错误
> 
> 说明：解析服务此请求所需的资源时出错。请查看以下特定的解析错误详细信息并适当地修改您的源文件。
> 
> 解析器错误消息：无法加载文件或程序集“AjaxControlToolkit，版本=1.0.10618.0，文化=中性，PublicKeyToken=28f01b0e84b6d53e”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）
> 
> 源错误：
> 
> 第 1 行：<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="AppointmentSchedule.aspx.vb" Inherits="AFKLogin.AppointmentSchedule" MasterPageFile="~/Login/PatientMaster.Master" %>
> 
> 第 2 行：
> 
> 第 3 行：<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="cc1" %>
> 
> 源文件：/Allforkids/Login/AppointmentSchedule.aspx 行：1
> 
> 程序集加载跟踪：以下信息有助于确定为什么无法加载程序集“AjaxControlToolkit，Version=1.0.10618.0，Culture=neutral，PublicKeyToken=28f01b0e84b6d53e”。
> 
> 警告：程序集绑定日志记录已关闭。要启用程序集绑定失败日志记录，请将注册表值 [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) 设置为 1。注意：与程序集绑定失败日志记录相关的一些性能损失。要关闭此功能，请删除注册表值 [HKLM\Software\Microsoft\Fusion!EnableLog]。
> 
> 版本信息：Microsoft .NET Framework 版本：2.0.50727.3082；ASP.NET 版本：2.0.50727.3082

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T06:45:28.877

您使用的是 1.0 版还是 3.0 版的 AjaxControlToolkit？你可能在不应该的时候不小心引用了 1.0 版本。

# nhibernate - NHibernate CompositeUserType：如何指定 Sql 类型？

> ID：856421
> 
> 赞同：4
> 
> 时间：2009-05-13T06:40:27.997
> 
> 标签：nhibernate, usertype, compositeusertype

使用 NH 2.0，我有一个自定义类型。它由四个属性组成，所以我实现了`ICompositeUserType`.

**我想为**用户类型中的字符串和小数属性指定长度和精度，以避免在映射文件中的每次使用时都指定它。

但是只有一个`PropertyTypes`属性要实现，它返回 IType。有趣的是，`IUserType`有一个`SqlTypes`属性， `ICompositeUserType`没有。

*   我必须实现这两个接口吗？
*   我是否必须实现一个用户类型来包装我要指定的每个 sql 类型？
*   或者如何为复合用户类型指定 Sql 类型？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T23:52:15.397

我建议下载此类挖掘的源代码（NH 2.0）。

首先看一下构建 IType 实例的 TypeFactory.HeuristicType 方法。

```
...
else if (typeof(ICompositeUserType).IsAssignableFrom(typeClass))
{
    type = new CompositeCustomType(typeClass, parameters);
}
else if (typeof(IUserType).IsAssignableFrom(typeClass))
{
    type = new CustomType(typeClass, parameters);
}
... 
```

因此，如果您的自定义类型实现了 ICompositeUserType，它将被实例化为 CompositeCustomType 类。这消除了实现 ICompositeUserType 和 IUserType 接口的可能性。

现在让我们来看看 CompositeCustomType

```
public override SqlType[] SqlTypes(IMapping mapping)
{
    IType[] types = userType.PropertyTypes;
    SqlType[] result = new SqlType[GetColumnSpan(mapping)];
    int n = 0;
    for (int i = 0; i < types.Length; i++)
    {
        SqlType[] sqlTypes = types[i].SqlTypes(mapping);
        for (int k = 0; k < sqlTypes.Length; k++)
        {
            result[n++] = sqlTypes[k];
        }
    }
    return result;
} 
```

因此，它采用从 PropertyTypes 返回的类型并为每个属性构建 SqlType。这意味着为每个属性提供您自己的用户类型包装器就可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-01T10:36:16.887

我找到了解决方案，这很简单。我必须使用以下方法创建 NHibernate 类型`TypeFactory`：

```
public IType[] PropertyTypes
{
  get
  {
    return new []
    {
      TypeFactory.GetDecimalType(36, 18),
      TypeFactory.GetStringType(100)
    }
  }
} 
```

# sql - 即使发生错误，如何强制创建存储过程？

> ID：856442
> 
> 赞同：3
> 
> 时间：2009-05-13T06:48:13.880
> 
> 标签：sql, sql-server, tsql

当我执行数据库脚本时，我在存储过程中遇到错误，然后它无法创建有错误的存储过程。即使存储过程发生错误，我也想强制创建存储过程。

如果在创建过程语句中发生错误，它将不会创建存储过程。我想要的是无论如何都会创建存储过程，无论是否发生错误。

实际上我们在 SQL Server 2000 中有数据库，我在 SQL Server 2005 中附加了它，然后将兼容性级别更改为 90。最后我想执行脚本，但我也希望如果发生一些错误，它将忽略错误并创建对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T08:44:47.560

您可以通过以不会失败的方式创建存储过程来强制创建它。看这个例子：

```
if object_id('sp_name') is null
    exec sp_executesql N'create procedure dbo.sp_name as select 1'
go
alter procedure db.sp_name
as
...
go 
```

现在如果改变失败，无论如何都会有一个存储过程。

# c++ - 如何在 Eclipse 中的远程计算机上构建 c++ 项目？

> ID：856444
> 
> 赞同：27
> 
> 时间：2009-05-13T06:50:17.433
> 
> 标签：c++, eclipse, eclipse-cdt

我有一台安装了 Eclipse Ganymede 的 Windows 电脑，以及我的 C++ 项目文件所在的 Linux 电脑。我使用 Eclipse 通过 SMB 编辑文件，并且也想使用 Eclipse 构建项目。目前我使用 putty 连接到我的 linux 机器，并从适当的目录运行 ./make 。我将如何在 Eclipse 中运行相同的命令并查看其中的结果？我已经安装了 RSE 插件，但仍然无法掌握如何安装。

只是为了让自己清楚 - 我可以使用 VNC 在安装在我的 linux 机器上的 Eclipse 上工作，但我不喜欢这样做。通过 VNC 的 Eclipse 速度很慢，而且响应速度不如我的 Windows 机器上安装的 Eclipse。

谢谢， 柔里

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-08-15T16:47:00.173

我也遇到过类似的情况，在 windows 工作站上开发，在 linux 服务器上编译。这就是我结束做的事情：

1.  使用 putty 设置编译器服务器的无密码登录，例如您可以按照本[教程](https://web.archive.org/web/20160628030333/http://www.blindhog.net/linux-ssh-passwordless-login-with-putty/)进行操作。
2.  使用 putty 创建登录会话，确保在 Connections/SSH/Auth 中指向您的私钥。
3.  将 eclipse make 命令修改为`plink.exe -load "saved_session" make -C /remote/path/project`（此设置在 Project/Properties/C++Build/Builder Settings/Build 命令中）。如果您必须传递更多参数和/或您的设置更复杂，您可以使用批处理/shell 文件自动执行此操作。

如果您使用私钥存储了密码，那么您可以使用 pageant.exe 仅加载一次您的密钥，因此您不必每次都输入密码。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-16T23:37:33.063

您可以使用 RSE 在远程计算机上创建项目。为此，您必须在远程计算机上安装 RSE 服务器组件。使用 RSE 远程系统视图创建与机器的连接。创建一个新的 C/C++ 项目并在向导的第一页取消选中“使用默认位置”复选框。这将启用文件系统提供程序的下拉列表，选择 RSE。然后，当您单击“浏览”时，您将看到一个对话框，让您可以浏览远程系统以查找您希望项目所在的文件夹。

这种方法存在一些问题。首先，当 CDT 索引器要构建索引时，它需要解析项目中的所有文件，这意味着将所有文件下载到本地计算机。如果您有大型项目或连接速度较慢，这可能会很慢。

另一个问题是，当您重新启动 Eclipse 时，远程项目将被关闭。这是因为您还没有连接到远程机器，所以 eclipse 无法读取 .project 文件。每次启动 Eclipse 时，您都必须重新打开远程项目。

目前有一个名为 RDT（远程开发工具）的项目正在进行中，它为 CDT 添加了远程索引功能。这意味着索引器将与您的代码一起存在于远程计算机上，因此不必为索引器下载文件。它仍处于“alpha”状态，但如果您喜欢冒险并想尝试一下，请前往[此处](http://wiki.eclipse.org/PTP/rdt-setup)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T07:09:52.333

您是否尝试过诸如[nx](http://www.nomachine.com/)之类的远程桌面工具在也拥有源代码的机器上本地运行 eclipse？

这可能是更简单的解决方案。此外，您在运行该工具的任何 PC 上都拥有相同的环境。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-06-04T14:57:59.940

对于在 Linux 主机上工作，在 [不同的] Linux 远程环境中编译，指令的顺序是，

1`$ ssh-keygen`创建一个无密码的ssh密钥对[这里，`id_rsa_nopassphrase`]，然后`scp`是`id_rsa_nopassphrase.pub`从主机`~/.ssh/`到远程的密钥`~/.ssh/authorized_keys`[追加内容，以防远程已经有这样的文件]；然后

2 向主机添加一个条目，`~/.ssh/config`例如 `Host my_remote_ssh_alias HostName MY_REMOTE_SERVER User remote_username Port 22 IdentityFile /home/<host_username>/.ssh/id_rsa_nopassphrase`then

3 Eclipse make 命令是然后`ssh my_remote_ssh_alias -F /home/host_username/.ssh/config 'make -C /remote/path/to/project'`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T08:02:41.280

Have you tried running Eclipse from the Linux machine with [X11 forwarding](http://tartarus.org/~simon/putty-snapshots/htmldoc/Chapter3.html#using-x-forwarding) ? You should have Eclipse installed on the Linux machine first.

Haven't tried it myself.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T12:49:22.620

就像 Liran Orevi 说的你可以使用 x windows。

1.  在 Windows 系统上安装 cygwin x 服务器。
2.  使用“xhost +”或类似的方式启用到此 X 服务器的远程连接（xhost + 不被认为是安全的，所以不要在公共网络上这样做，但在大多数情况下都可以）
3.  ssh 到 linux 机器上
4.  设置 DISPLAY 环境变量，例如 "export DISPLAY=":0"
5.  从命令行运行 Eclipse Eclipse 现在应该出现在 Windows 系统的 xserver 上。

ssh 可以自动转发，无需 xhost + 和 DISPLAY 环境。

# .net - 重载、覆盖和隐藏？

> ID：856449
> 
> 赞同：5
> 
> 时间：2009-05-13T06:51:44.077
> 
> 标签：.net, oop

谁能解释什么是.Net 中的重载、覆盖和隐藏？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-13T07:01:55.170

**重载**是对单个方法或运算符的多个可能“签名”的定义。每个签名采用不同的参数，本质上是一个不同的函数，与多个函数具有不同名称的情况没有什么不同。这通常用于对概念上相似的操作进行分组，例如重载`+`以使用`BigInteger`和使用`String`：这两种操作似乎都适合使用`+`（除非您认为 + 的所有重载都应该定义[阿贝尔群](http://en.wikipedia.org/wiki/Abelian_group)——`String`重载没有）。

**覆盖**是同一方法签名的多个可能*实现*的定义，这样实现由第零个参数的运行时类型确定（通常由`this`C# 中的名称标识）。

**隐藏**是派生类型中方法的定义，其签名与其基类型之一中的签名相同，*没有*覆盖。

覆盖和隐藏之间的实际区别如下：

*   如果方法被*覆盖*，则调用的实现基于参数的*运行时类型*`this`。
*   如果一个方法只是简单地*隐藏*，则调用的实现基于参数的*编译时*类型`this`。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-13T07:01:40.363

重载提供了多个具有相同名称和不同签名的方法：

```
void Foo() {...}
void Foo(int i) {...} 
```

在继承中使用覆盖来更改每个子类的实现：

```
class SomeBase {
    public virtual void Foo() {}
}
class SomeOther : SomeBase {
    public override void Foo() {
        // different implementation, possibly calling base.Foo();
    }
} 
```

有了上述，即使我这样做：

```
SomeBase obj = new SomeOther();
obj.Foo(); 
```

它将调用`SomeOther.Foo`实现。调用的方法取决于**实例**类型，而不是变量。

方法隐藏则相反；它*替换*了方法签名，但仅适用于从派生类型调用方法：

```
class SomeBase {
    public void Foo() {}
}
class SomeOther : SomeBase {
    public new void Foo() {
        // different implementation, possibly calling base.Foo();
    }
} 
```

现在：

```
SomeOther obj = new SomeOther();
SomeBase baseObj = obj;
obj.Foo(); // calls SomeOther.Foo
baseObj.Foo(); // calls SomeBase.Foo 
```

即方法调用取决于**变量**，而不是实例。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T06:58:09.793

重载是当您创建多个具有不同参数的方法时。例如：

```
公共级汽车
{
  公共汽车（）
  {
    // 做东西
  }

  公共汽车（int numberOfCylinders）
  {
    // 做东西
  }
}

```

您可以看到构造函数具有相同的名称，但参数不同。您将在 Intellisense 的 Visual Studio 中看到重载的方法和构造函数，带有上下上下的小箭头，因此您可以浏览签名。

覆盖是当您为基类中的方法提供新实现时。例子：

```
   公共课广场
   {
      公共双x；

      // 构造函数：
      公共广场（双x）
      {
         这个.x = x;
      }

      公共虚拟双区域（）
      {
         返回 x*x；
      }
   }

   立方体类：正方形
   {
      // 构造函数：
      公共立方体（双 x）：基数（x）
      {
      }

      // 调用区域基方法：
      公共覆盖双区域（）
      {
         返回 (6*(base.Area()));
      }
   }

```

请注意，在 C# 中，您不能[覆盖](http://msdn.microsoft.com/en-us/library/ebca9ah3%28VS.71%29.aspx)非虚拟或静态方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-13T07:24:29.547

假设您理解其他海报给出的解释，记住重载和覆盖之间区别的一种方法是，当使用 overloading 时，可能会“**加载****”**同名的函数。

 **傻，我知道，但它对我有用。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-13T07:02:12.923

简单来说：

重载是当您具有具有不同签名的相同方法名称时。这可以在同一个班级。例如：

```
int Add (int a, int b)
{
  return a + b; // returns int
}
float Add (float a, float b)
{
return a + b; // returns float
} 
```

覆盖是指派生类中的方法名称和签名与基类中的方法名称和签名相同。在这种情况下，我们说派生类覆盖了基类方法。运行哪个方法取决于哪个实例调用该方法

例如

```
public class Shape
    {
        public virtual void Draw() { }

    }

    public class Square : Shape
    {
        public override void Draw()
        {
            // Code to draw square
        }
    }

    public class Circle : Shape
    {
        public override void Draw()
        {
            // Code to draw circle
        }
    } 
```

隐藏或封装是当您将类的成员变量和方法声明为私有时，任何其他类（甚至派生类）都无法访问它们

例如

```
private int onlyICanAccess;

private void OnlyICanExecute()
{
  // ...
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-13T07:03:38.800

重载是多态的一个例子，你可以重载两个方法之间传递的数字、数据类型和参数序列。

覆盖（与虚拟不同）意味着存在一些已定义的功能，但您可以在继承时给出更清晰的想法

隐藏意味着隐藏内部特征并表示本质特征，OOP概念的特征之一

GOOGLe获取详细信息

# asp.net - 如何将整个 asp.net 网站放入一个 dll 中？

> ID：856453
> 
> 赞同：1
> 
> 时间：2009-05-13T06:54:28.707
> 
> 标签：asp.net, dll, httphandler, resources

我正在用 C# 为 Asp.Net 构建一个 Web 应用程序框架。该框架由 dll 文件、带有代码隐藏文件的 aspx 文件、App_Code 中的代码文件、css 文件和图像的混合组成。

我查看了 Visual Studio 2008 中的“Web 应用程序”项目。这有助于删除所有代码文件并将它们放入 bin 文件夹中的一个 dll 中。但是，所有其他文件仍然存在。

我认为必须可以将这些文件放在资源文件中并将其包含到 dll 文件中。我看到一些控制提供商会这样做，比如 Telerik。

你怎么做呢？由于文件数量超过 1000 个，是否有一些自动化过程可以做到这一点。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T09:11:11.417

您实际上可以将站点简化为一个程序集、一个 web.config 文件和一个 global.asax 文件。

为此，请使用嵌入式资源将所有静态内容（图像等）嵌入到程序集中。这就是 Telerik 等组件供应商为他们的控件提供单一组件部署所做的工作。然后可以使用虚拟路径提供程序提供嵌入式资源。在 msdn 上有一篇[很好的文章介绍了虚拟路径提供程序。](http://msdn.microsoft.com/en-us/library/aa479502.aspx)使用 Web 应用程序项目时，您甚至可以将页面 (.aspx) 和用户控件 (.ascx) 作为资源嵌入。

使用路由模块，您可以实现几乎透明的 URL 到程序集中嵌入页面的转换。

但是有一些限制。

*   默认情况下，IIS6 不会从您的程序集中提供静态内容。使用自定义处理程序（例如 files.ashx/my/static/content.jpg）或配置 IIS 以使用通配符映射将所有请求路由到您的应用程序。
*   在程序集中嵌入页面时，您将失去 Visual Studio 中的一些设计器支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T08:04:44.647

ASP.NET 确实没有“编译为单个 DLL”的方法（不幸的是 - 我自己曾多次希望它！）。

正如您所指出的，Web 应用程序有助于在一定程度上减少混乱。

Web 部署也有帮助，因为网页的代码被编译成单个 DLL，您实际上可以`*.aspx/*.ascx`从安装中删除文件（如果它是不可更新的），但您仍然有大量`*.compiled`文件存在。

所以不幸的是，我认为，在这个时间点上，没有“开箱即用”的解决方案可以满足您的要求（据我目前所知，VS2010 / ASP.NET 没有类似的计划4.0）。

马克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-09T21:29:10.037

ASP.Net 有一个“编译为单个 DLL”，带有来自 Microsoft 的插件。查看“Web 部署”插件。这将使您能够将*几乎*所有内容编译到单个 DLL 中，包括 ASCX 控件（这是一种轻松重新分发这些控件的好方法）。

# javascript - 使用javascript缩小图像

> ID：856460
> 
> 赞同：0
> 
> 时间：2009-05-13T06:57:57.203
> 
> 标签：javascript, html, css, dhtml

我需要使用 javascript.for 缩小保存在 div background-image 中的图像，因为该图像的四边具有圆角。

在javascript中可以吗？

有什么建议么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T07:14:36.817

您*无法*使用 JS 调整背景大小。

您*可以*将图像分成 4 个角图像并嵌套 div 以显示它们：

```
<div style="background:url(tl.jpg) top left no-repeat">
    <div style="background:url(tr.jpg) top right no-repeat">
        <div style="background:url(bl.jpg) bottom left no-repeat">
            <div style="background:url(br.jpg) bottom right no-repeat">
                content
            </div>
        </div>
    </div>
</div> 
```

当然，如果您 div 仅在一个轴上增长，您可以简化这一点：

```
<div style="background:url(top.jpg) top no-repeat">
    <div style="background:url(bottom.jpg) bottom no-repeat">
        content
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T07:13:08.380

CSS 不支持调整背景图像的大小。

如果您只是在寻找圆角，那么有多种可用的解决方案可以使用 HTML、CSS 和 Javascript 的各种组合。

[谷歌：圆角](http://www.google.com/search?hl=en&q=rounded+corners)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T07:14:43.993

CSS 3 具有允许您执行此操作的 background-size 属性，但大多数浏览器不支持它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T07:49:55.747

大多数现代浏览器都可以让您绕过元素的角落，而无需求助于背景图像。查看以下 CSS 样式...

```
-moz-border-radius:4px; 
border-radius:4px; 
-webkit-border-radius:4px; 
```

这些中的每一个都会给你一个4像素的半径。第一个是 Mozilla 浏览器（例如 Firefox），第二个是较新的 css3 浏览器，最后一个是 Safari 等。

# python - 我如何以 Google App Engine 的形式表示多对多关系？

> ID：856462
> 
> 赞同：1
> 
> 时间：2009-05-13T06:58:45.207
> 
> 标签：python, google-app-engine

```
class Entry(db.Model):
    ...

class Tag(db.Model):
    ...

class EntryTag(db.Model):
    entry = db.ReferenceProperty(Entry, required=True, collection_name='tag_set')
    tag = db.ReferenceProperty(Tag, required=True, collection_name='entry_set') 
```

模板应该是 {{form.as_table}}

问题是如何制作一个表单来创建条目，我可以在其中选择添加一些标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T23:20:55.607

您将需要为您的`EntryTag`班级创建一个表单集。有关更多信息，请参阅[Django 表单集文档](http://docs.djangoproject.com/en/dev/topics/forms/formsets/#topics-forms-formsets)。

否则，您可能希望使用 a 创建自定义表单[`ModelMultipleChoiceField`](http://docs.djangoproject.com/en/dev/ref/forms/fields/#modelmultiplechoicefield)并使用自定义视图添加`EntryTag`实体。

# c++ - 如何仅删除/删除可执行文件（即没有扩展名的文件）

> ID：856463
> 
> 赞同：9
> 
> 时间：2009-05-13T06:58:49.947
> 
> 标签：c++, linux, unix, file

我有一个目录 src/ ，其中包含许多 .cc 文件及其二进制文件。例如：

```
src/
  |_ foo.cc
  |_ bar.cc
  |_ qux.cc
  |_ thehead.hh
  |_ foo  (executable/binary)
  |_ bar  (executable/binary)
  |_ qux  (executable/binary)
  |_ makefile 
```

实际上有很多 .cc 和可执行文件。

我需要以全局方式删除这些二进制文件，而不必列出所有文件。有没有一种快速而紧凑的方法来做到这一点？

我试过：

```
$ rm * 
```

但它会删除所有文件，包括 .cc 和 .hh 文件。

我知道这个命令：

```
$ rm foo bar qux .... 
```

但是我们仍然必须一一列出所有文件。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-13T07:02:08.180

干得好：

```
ls | grep -v "\." | xargs rm 
```

`grep -v`上面写着“只允许不包含点的文件名”，上面写着`xargs rm`“然后将文件名列表传递给`rm`”。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-13T07:05:21.200

你可以跑

```
find . -perm +100 -type f -delete 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-13T07:03:53.590

使用`find`. 你想要的是这样的：

```
find . -type f -executable -exec rm '{}' \; 
```

也可以删除没有扩展名的所有内容：

```
find . -type f -not -iname "*.*" -exec rm '{}' \; 
```

前一个选项不会删除`Makefile`, 因此是首选。我认为[kcwu 的回答](https://stackoverflow.com/questions/856463/how-to-remove-delete-executable-files-aka-files-without-extension-only/856486#856486)`-delete`显示了使用以下选项改进上述内容的好方法：

```
find . -type f -executable -delete
find . -type f -not -iname "*.*" -delete 
```

* * *

**编辑**：我在 Ubuntu 8.10 下使用 GNU findutils`find`版本 4.4.0。我不知道这种`-executable`开关是如此罕见。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-13T22:14:27.813

我宁愿在 Makefile 中寻找一个*干净的目标。*很可能它已经包含这些二进制文件的列表，因此添加一个*干净*的目标不需要太多努力。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-13T07:11:23.657

```
find . -perm /ugo+x -delete 
```

Stephan202 的第一个命令的更正版本。

编辑：也尝试：

```
find . -perm /111 -delete 
```

它使用八进制等价物

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T07:06:55.270

而不是通过`-exec rm '{}' \;`查找一个可以使用`-delete`arg。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-13T07:10:29.787

使用 find 删除所有不包含点字符的文件（不是文件夹）：

```
find . \! -name "*.*" -type f -exec rm {} \; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-13T07:12:10.347

我建议先使用

```
find . -not -name "*.*" -exec ls -l {} \; 
```

查看匹配的文件的名称。

然后，将 ls -l 更改为 rm

```
find . -not -name "*.*" -exec rm {} \; 
```

此外，您可以使用确认提示使其更安全：

```
find . -not -name "*.*" -exec rm -i {} \; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-03-08T21:03:11.000

`findutils`不推荐使用`+omode`的语法，现在您可以`/omode`改用：

```
find . -perm /100 -type f -delete 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-02-07T01:17:20.837

你可以简单地编译你的可执行`/bin`文件`rm /bin/*`。简单易行。

# javascript - 如何风格化组合框？

> ID：856464
> 
> 赞同：0
> 
> 时间：2009-05-13T06:59:05.453
> 
> 标签：javascript, combobox

如何设置组合框的样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T07:01:37.073

如果不将其替换为模拟功能而不真正成为“选择元素”的东西，您将无能为力。

如果你对此感兴趣，这里有几篇关于它的好文章：

[`<select>`新事物，第 1 部分](http://v2.easy-designs.net/articles/replaceSelect/)

[`<select>`新事物，第 2 部分](http://v2.easy-designs.net/articles/replaceSelect2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T07:13:06.257

如果您想更改选择框的整体外观（将自定义图像制作为箭头按钮等），您可以使用 div 并且可以在 JavaScript 中进行编码以使其表现得像组合框。

在 javascript 中检查[这](http://www.dotnetgoodies.com/article/Javascript/63/How_to_create_a_ComboBox_using_JavaScript.aspx)是一个不错的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T07:39:47.680

你不能用常规的 CSS 做很多事情。尝试使用 jQuery 插件，例如[这个](http://jquery.sanchezsalvador.com/page/jquerycombobox.aspx)或阅读更多关于[增强下拉菜单](http://www.reynoldsftw.com/2009/03/11-jquery-plugins-to-enhance-html-dropdowns/)的信息。

# c++ - 非常奇怪的视觉工作室行为，带有过多的空白行

> ID：856466
> 
> 赞同：0
> 
> 时间：2009-05-13T07:01:00.817
> 
> 标签：c++, visual-studio-2005, perforce

昨天我们更新到我们正在使用的一些中间件的新版本，并且有一个非常奇怪的 perforce 合并问题......它在我的一个函数中创建了大约 10-20,000 行空白，这一切都编译得很好，在运行程序它崩溃表明一些内存问题，通过调用堆栈回溯我发现Visual Studio将调试器指向其中有数千行空白的函数的中间，删除多余的行并重新编译已修复这个问题，我只是想知道这是怎么回事？，代码没有区别，编译器应该忽略所有空格，这是视觉工作室中的某种错误吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T07:15:21.077

你确定它是空白而不是[空白](http://en.wikipedia.org/wiki/Whitespace_(programming_language))吗？

# c# - 如何审核共享点搜索？

> ID：856477
> 
> 赞同：0
> 
> 时间：2009-05-13T07:02:53.187
> 
> 标签：c#, sharepoint, moss, sharepoint-2007

我想使用 Sharepoint 对象模型审核共享点搜索...怎么做？使用 sharepoint 对象模型我如何获得这些搜索的审计报告。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T04:07:34.453

您需要哪些具体信息？SharePoint 已经附带了[搜索使用报告](http://technet.microsoft.com/en-us/library/cc262541.aspx)。

您可以跟踪以下内容： - 过去 30 天内每天的查询。- 过去 12 个月的每月查询次数。- 过去 30 天内的热门查询。- 过去 30 天内每个搜索范围的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:36:38.847

我认为您对搜索 web 部件在提供搜索结果时所做的事情有一点误解。

当搜索爬虫在网站上运行时，所有文档的“获取”都完成了。这可以通过将 stslog 导入数据库并将其限制为搜索爬虫使用的用户名来进行审计。

执行实际搜索的搜索结果 Web 部件仅查看搜索爬虫创建的索引。审核搜索返回的结果可以通过自定义搜索结果 Web 部件完成，该 Web 部件存储搜索完成时提供的 url，但我不确定这会提供多大价值。

# multithreading - 到达gdb中的断点时是否可以停止所有其他线程的执行？

> ID：856488
> 
> 赞同：3
> 
> 时间：2009-05-13T07:05:26.207
> 
> 标签：multithreading, debugging, gdb

那么，一旦我在某个线程中遇到断点，是否可以停止其他线程直到我继续？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T07:14:05.913

当你的程序因任何原因在 gdb 下停止时，例如到达断点，所有执行线程都将停止，而不仅仅是当前线程。

问题是，当您在一个线程中单步执行代码时，其他线程可能会执行不止一个步骤。另一个问题是其他线程停止在语句中间而不是语句边界处，因此它可能看起来有点混乱。

除此之外，如果其他线程在系统调用中被阻塞，一旦“你的”线程停止，系统调用将过早返回，所以你会得到有趣的结果，除非你专门以检查这一点并重新启动阻塞调用的方式进行编码信号后。

[您可以在使用 GDB 调试 - 第 5.4 节停止和启动多线程程序](http://www.gnu.org/software/gdb/)中找到更多信息，这些信息可以在 gdb 网站的文档部分找到。

编辑：看起来不间断模式是你所追求的。看起来[这个版本](http://sources.redhat.com/gdb/current/onlinedocs/gdb_6.html#SEC47)有一节 5.4.2 讨论不间断模式，[gnu 网站](http://sourceware.org/gdb/download/onlinedocs/)上的版本没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T14:48:26.110

在全停止模式（当前发布的版本支持的唯一模式）下，只要任何线程停止（由于断点或信号），GDB 就会停止所有线程。

当您继续停止的线程时，所有其他线程也将继续，除非您这样做`set scheduler-locking on`。请注意，任何`step`,`next`等都将*继续*当前（以及所有其他）线程（在适当的位置设置临时断点之后，例如在`next`命令的下一行）。

也许您希望能够在不恢复所有其他线程的情况下单步停止线程？在那种情况下，`set scheduler-locking on`就是答案。

请注意：如果另一个线程持有锁，您打开调度程序锁定，并且您当前的线程也需要相同的锁，您的程序将无限期等待。如果其中一个线程在 malloc/realloc 中，并且您当前的语句尝试分配一些内存，则通常会出现这种情况。

也不要忘记`set scheduler-locking off`before `continue`，否则只有当前线程会向前推进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T07:19:19.430

这是 GDB 的默认设置。要启用 [不间断模式](http://sources.redhat.com/gdb/current/onlinedocs/gdb_6.html#SEC47)，请使用*set non-stop on*。

# iphone - 如何通过 iphone 开发存储 SQLite 数据库中的数据

> ID：856491
> 
> 赞同：1
> 
> 时间：2009-05-13T07:06:24.100
> 
> 标签：iphone, objective-c, ios, sqlite, soap

我在将数据从 SQLite 数据库存储在服务器上时遇到问题。这是我的代码：

```
 NSString *query = @"SELECT ROW,PHOTO1 BLOB,BLG_NAME TEXT,ST_NO TEXT,ST_NAME TEXT,ST_DIR TEXT,MUNI TEXT,PROVINCE TEXT,BLG_TYPE TEXT,BLG_ACC TEXT,BLG_AMN TEXT,LONGI TEXT,LATI TEXT FROM ATTRI4 WHERE FLAG = ?";

    sqlite3_stmt *statement;
    if(sqlite3_prepare_v2(database, [query UTF8String], -1, &statement, nil) == SQLITE_OK)
    {
        sqlite3_bind_int(statement,1,0);

        while(sqlite3_step(statement)==SQLITE_ROW)
        {
            NSLog(@"Data==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 0)]);
            NSLog(@"Data1==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 1)]);
            NSLog(@"Data==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 2)]);
            NSLog(@"Data1==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 3)]);
            NSLog(@"Data==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 4)]);
            NSLog(@"Data1==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 5)]);
            NSLog(@"Data==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 6)]);
            NSLog(@"Data1==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 7)]);
            NSLog(@"Data==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 8)]);
            NSLog(@"Data1==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 9)]);
            NSLog(@"Data==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 10)]);
            NSLog(@"Data1==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 11)]);
            NSLog(@"Data==>%@",[NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 12)]);

            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"in retrival!!!!"
                                                            message:nil
                                                           delegate:nil
                                                  cancelButtonTitle:@"OK"
                                                  otherButtonTitles:nil];

            [alert show];
            [alert release];

            NSString *data0 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 2)];
            NSString *data1 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 3)];
            NSString *data2 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 4)];
            NSString *data3 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 5)];
            NSString *data4 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 6)];
            NSString *data5 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 7)];
            NSString *data6 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 8)];
            NSString *data7 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 9)];
            NSString *data8 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 10)];
            NSString *data9 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 11)];
            NSString *data10 = [NSString stringWithFormat: @"%s",(char *)sqlite3_column_text(statement, 12)];
            NSString *data11 = @"123456788";
            NSString *data12 = @"png";

            NSData *data = [[NSData alloc] initWithBytes:sqlite3_column_blob(statement, 1) length:sqlite3_column_bytes(statement,1)];

            if(data == nil)
            {
                NSLog(@"No image");
            }
            else
            {
                base64EncodedimageData = [self base64StringFromData:data length:[data length]];

                NSLog(@"imagedataencded=%@",base64EncodedimageData);
                // [imgarray1 addObject: base64EncodedimageData];

            }

            /********************** SYNC WITH THE SERVER ****************************/

            NSString *soapMessage = [NSString stringWithFormat:
                                                  @"<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n"
                                                    "<SOAP-ENV:Envelope SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\" xmlns:ns7475=\"some URL/\">\n"
                                                    "<SOAP-ENV:Body>\n"
                                                      "<ns7475:saveFile xmlns:ns7475=\"http://demo.digi-corp.com:82/Nilesh/FDCT/img_server.php\">\n"
                                            "<buildingName xsi:type=\"xsd:string\">%@</buildingName>\n"
                                            "<streetNumber xsi:type=\"xsd:string\">%@</streetNumber>\n"
                                              "<streetName xsi:type=\"xsd:string\">%@</streetName>\n"
                                         "<streetDirection xsi:type=\"xsd:string\">%@</streetDirection>\n"
                                            "<municipality xsi:type=\"xsd:string\">%@</municipality>\n"
                                                "<province xsi:type=\"xsd:string\">%@</province>\n"
                                            "<buildingType xsi:type=\"xsd:string\">%@</buildingType>\n"
                                          "<buildingAccess xsi:type=\"xsd:string\">%@</buildingAccess>\n"
                                       "<buildingAmenities xsi:type=\"xsd:string\">%@</buildingAmenities>\n"
                                               "<longitude xsi:type=\"xsd:string\">%@</longitude>\n"
                                                "<latitude xsi:type=\"xsd:string\">%@</latitude>\n"
                                                   "<devID xsi:type=\"xsd:string\">%@</devID>\n"
                                                "<filetype xsi:type=\"xsd:string\">%@</filetype>\n"
                                                "<filedata xsi:type=\"xsd:base64Binary\">%@</filedata>\n"
                                                     "</ns7475:saveFile>\n"
                                                   "</SOAP-ENV:Body>\n"
                                                   "</SOAP-ENV:Envelope>\n",data0,
                                              data1,
                                              data2,
                                              data3,
                                              data4,
                                              data5,
                                              data6,
                                              data7,
                                              data8,
                                              data9,
                                              data10,
                                              data11,
                                              data12,
                                              base64EncodedimageData];

            data0 = nil;
            data1 = nil;
            data2= nil;
            data3= nil;
            data4= nil;
            data5= nil;
            data6= nil;
            data7= nil;
            data8= nil;
            data9= nil;
            data10= nil;
            data11= nil;
            data12= nil;
            base64EncodedimageData= nil;
            recordctr++;

            NSLog(soapMessage);
            NSURL *url = [NSURL URLWithString:@"someURL"];
            NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:url];
            NSString *msgLength = [NSString stringWithFormat:@"%d", [soapMessage length]];

            [theRequest addValue: @"text/xml; charset=ISO-8859-1" forHTTPHeaderField:@"Content-Type"];
            [theRequest addValue: @"some URL" forHTTPHeaderField:@"SOAPAction"];

            [theRequest addValue: msgLength forHTTPHeaderField:@"Content-Length"];
            [theRequest setHTTPMethod:@"POST"];
            [theRequest setHTTPBody: [soapMessage dataUsingEncoding:NSUTF8StringEncoding]];
            NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];

            if(theConnection)
            {
                webData = [[NSMutableData data] retain];
                NSLog(@"connection established");
                //NSLog( webData);
            }
            else
            {
                NSLog(@"theConnection is NULL");
            }
            NSHTTPURLResponse *response = nil;

            NSError *error = [[NSError alloc] init];
            NSData *responseData = [NSURLConnection sendSynchronousRequest: theRequest
                                                         returningResponse:&response
                                                                    error : &error];

            NSLog(@"Response code= %d", [response statusCode] );
            NSLog(@"Content-type : @", [[response allHeaderFields] objectForKey: @"Content-type"]);

            if([response statusCode] >=200 && [response statusCode ] <300)
                NSLog(@"connection established  1");
        }

        sqlite3_finalize(statement);         
    }           
}

-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    [webData setLength: 0];
}

-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    [webData appendData:data];
    NSLog(@"webdatappende %@",webData);
}

-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    NSLog(@"ERROR with theConenction");
    NSLog(@"webdata=%@",webData);
    [connection release];
    [webData release];
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSLog(@"DONE. Received Bytes: %d", [webData length]);
    NSString *theXML = [[NSString alloc] initWithBytes: [webData mutableBytes] length:[webData length] encoding:NSUTF8StringEncoding];
    NSLog(theXML);
    [theXML release];

    if(xmlParser)
    {
        [xmlParser release];
    }

    xmlParser = [[NSXMLParser alloc] initWithData: webData];
    [xmlParser setDelegate: self];
    [xmlParser setShouldResolveExternalEntities: YES];
    [xmlParser parse];

    [connection release];
    [webData release];  
}

-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *) namespaceURI qualifiedName:(NSString *)qName
   attributes: (NSDictionary *)attributeDict
{
    if([elementName isEqualToString:@"SOAP-ENV:Envelope"])
    {
        if(!soapResults)
        {
            soapResults = [[NSMutableString alloc] init];
        }
        recordResults = TRUE;
    }
}
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{
    if(recordResults)
    {
        [soapResults appendString: string];
        NSLog(@" %@* ",string);
    }
}
-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{
    if([elementName isEqualToString:@"SOAP-ENV:Envelope"])
    {
        recordResults = FALSE;
        NSLog( @"soap results= %@" ,soapResults);
        NSLog( @"ele name=%@ ",elementName);

        soapResults = nil;
    }
} 
```

问题是，我从服务器得到响应，但随后控制转到 [XML 解析]，在这里我得到一个异常：

```
DONE. Received Bytes: 484
2009-05-13 12:33:34.215 Camera[1854:20b] <?xml version="1.0" encoding="ISO-8859-1"?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><ns1:saveFileResponse xmlns:ns1="http://demo.digi-corp.com:82/Nilesh/FDCT/img_server.php"><return xsi:type="xsd:string">32</return></ns1:saveFileResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

Program received signal:  “EXC_BAD_ACCESS”.

Unable to disassemble objc_msgSend. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T07:26:05.333

试穿`NSLog(@"%@", theXML)`_`connectionDidFinishLoading`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-20T09:35:48.777

`NSError *error = [[NSError alloc] init];`

这是错误的，只是泄漏内存。不要初始化`*error`或使用`nil`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T10:32:32.547

如果你设置

```
 [xmlParser setShouldResolveExternalEntities: YES]; 
```

你的委托必须有这个方法

```
 parser:foundExternalEntityDeclarationWithName:publicID:systemID: 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-20T09:44:21.283

看起来您的程序在 connectionDidFinishLoading: 方法中崩溃了 就我个人而言，我不喜欢

```
if( xmlParser )
{
    [xmlParser release];
} 
```

xmlParser 可能已经在某处发布，并且您尝试将 -release 发送到死实例

# perl - 如何使用 Perl 从文件中准确获取 n 个随机行？

> ID：856494
> 
> 赞同：7
> 
> 时间：2009-05-13T07:07:41.617
> 
> 标签：perl, random-sample, file-processing

跟进[这个](https://stackoverflow.com/questions/448005/whats-an-easy-way-to-read-random-line-from-a-file-in-unix-command-line "在 Unix 命令行中从文件中读取随机行的简单方法是什么？")问题，我需要从文件（或）`n`中随机获取准确的行。`stdin`这将类似于`head`or `tail`，除了我想要一些来自中间的。

现在，除了使用链接问题的解决方案循环文件之外，`n`在一次运行中获得精确行的最佳方法是什么？

作为参考，我试过这个：

```
#!/usr/bin/perl -w
use strict;
my $ratio = shift;
print $ratio, "\n";
while () {
    print if ((int rand $ratio) == 1); 
} 
```

`$ratio`我想要的线条的粗略百分比在哪里。例如，如果我想要 10 行中的 1 行：

```
random_select 10 a.list 
```

但是，这并没有给我一个确切的数量：

```
aaa> foreach i ( 0 1 2 3 4 5 6 7 8 9 )
foreach? random_select 10 a.list | wc -l
foreach? end
4739
4865
4739
4889
4934
4809
4712
4842
4814
4817 
```

我的另一个想法是吞食输入文件，然后`n`从数组中随机选择，但如果我有一个非常大的文件，那就是个问题。

有任何想法吗？

**编辑：**这是[这个](https://stackoverflow.com/questions/692312/randomly-pick-lines-from-a-file-without-slurping-it-with-unix "从文件中随机选择行而不用 Unix 啜饮它")问题的完全重复。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T07:33:19.657

这是我刚刚提出的一个很好的一次性算法，具有 O(N) 时间复杂度和 O(M) 空间复杂度，用于从 N 行文件中读取 M 行。

假设 M <= N。

1.  让`S`是一组选定的行。初始化`S`到文件的第一`M`行。如果最终结果的顺序很重要，请`S`立即洗牌。
2.  阅读下一行`l`。到目前为止，我们已经阅读了`n = M + 1`总行数。因此，我们想要选择`l`作为最终线路之一的概率是`M/n`。
3.  `l`有概率地接受`M/n`；使用 RNG 来决定是接受还是拒绝`l`。
4.  如果`l`已被接受，则随机选择其中的一行`S`并将其替换为`l`.
5.  重复步骤 2-4，直到文件中的行用尽，`n`每读取一个新行就递增。
6.  返回`S`所选行的集合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T07:47:08.027

这需要一个命令行参数，即您想要的行数 N。前 N 行被保留，因为您可能再也看不到了。此后，您随机决定是否走下一行。如果这样做，您会随机决定要覆盖当前 N 列表中的哪一行。

```
#!/usr/bin/perl
my $bufsize = shift;
my @list = ();

srand();
while (<>)
{
    push(@list, $_), next if (@list < $bufsize);
    $list[ rand(@list) ] = $_ if (rand($. / $bufsize) < 1);
}
print foreach @list; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T07:15:35.880

可能的解决方案：

1.  扫描一次以计算行数
2.  决定随机选择的行号
3.  再次扫描，挑线

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T07:39:17.683

```
@result = ();

$k = 0;
while(<>) {
    $k++;
    if (scalar @result < $n) {
        push @result, $_;
    } else {
        if (rand <= $n/$k) {
            $result[int rand $n] = $_;
        }
    }
}

print for @result; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T05:40:42.013

无需知道文件中的实际行号。只需寻找一个随机的地方并保留*下一*行。（当前行很可能是部分行。）

这种方法对于大文件应该非常快，但它不适用于 STDIN。哎呀，没有任何一种将整个文件缓存在内存中的方式适用于 STDIN。所以，如果你必须有 STDIN，我看不出你如何能快速/便宜地处理大文件。

您可以检测 STDIN 并切换到缓存方法，否则会很快。

```
#!perl
使用严格；

我的 $file='file.txt';
我的 $count=班次 || 10个；
我的 $size=-s $file;

打开（文件，$文件）|| die "无法打开 $file\n";

而（$count--）{
   寻求（文件，int（rand（$size）），0）；
   $_=readline(文件); # 忽略部分行
   重做，除非定义 ($_ = readline(FILE)); # 捕获 EOF
   打印 $_;
}

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T07:21:23.063

在伪代码中：

```
use List::Util qw[shuffle];

# read and shuffle the whole file
@list = shuffle(<>);

# take the first 'n' from the list
splice(@list, ...); 
```

这是最简单的实现，但您必须先读取整个文件，这需要您有足够的可用内存。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T00:33:42.143

下面是一些适用于大文件的冗长 Perl 代码。

这段代码的核心是它不会将整个文件存储在内存中，而只是将偏移量存储在文件中。

用于`tell`获取偏移量。然后`seek`到适当的地方恢复线路。

更好的目标文件规范和要获取的行数留给那些不那么懒惰的人作为练习。这些问题已经得到了很好的解决。

```
#!/usr/bin/perl

use strict;
use warnings;

use List::Util qw(shuffle);

my $GET_LINES = 10; 

my @line_starts;
open( my $fh, '<', 'big_text_file' )
    or die "Oh, fudge: $!\n";

do {
    push @line_starts, tell $fh
} while ( <$fh> );

my $count = @line_starts;
print "Got $count lines\n";

my @shuffled_starts = (shuffle @line_starts)[0..$GET_LINES-1];

for my $start ( @shuffled_starts ) {

    seek $fh, $start, 0
        or die "Unable to seek to line - $!\n";

    print scalar <$fh>;
} 
```

# sql-server - 如何编写按钮以从数据库中的表中获取数据并在数据网格视图中显示？

> ID：856496
> 
> 赞同：0
> 
> 时间：2009-05-13T07:09:20.460
> 
> 标签：sql-server, vb.net, datagrid, datagridview

我正在尝试编写一个按钮，该按钮具有 SELECT 语句以从一个表中获取信息，但我希望将信息显示在数据网格视图中。

从数据网格视图中，这些数据将存储在同一数据库中的**不同表中。**

以前我使用列表框来显示信息，但我无法将其保存在数据库中。

这是我用于列表框的代码：

```
listbox.items.add
{while mydatareader.read
{add.("item_name") 
```

有什么方法可以像我在列表框上那样在数据网格视图上显示它？

我使用数据网格视图 textboxcolumn 列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:28:13.487

我确信有很多方法可以做到这一点，但试试这个。假设您有一个数据库，其中包含一个名为“TestSample”的表，其中包含三个名为“Column1”、“Column2”、“Column3”的列。接下来在您的表单上添加一个 ListView 控件并将其命名为“ListDisplay”，并且可能还有两个按钮用于测试目的。接下来你需要创建列，你可以通过这样的代码来完成

```
Private Sub CreateColumns()
    'ListDisplay is the name of the ListView Control'
    ListDisplay.View = View.Details
    ListDisplay.FullRowSelect = True

    'Create Columns'
    ListDisplay.Columns.Add("Column1", 200, HorizontalAlignment.Left)
    ListDisplay.Columns.Add("Column2", 200, HorizontalAlignment.Left)
    ListDisplay.Columns.Add("Column3", 200, HorizontalAlignment.Left)
End Sub 
```

可以从“表单加载”事件中调用此代码，例如

```
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    'Setup Colums'
    CreateColumns()
End Sub 
```

接下来是从数据库中收集数据并插入回数据库..这两个功能可以提供帮助

```
 Private Sub FillTable(ByVal connString As String, ByVal QueryString As String)
    'Clear Populated Items'
    ListDisplay.Items.Clear()

    'Setup Connection and query'
    Dim conn As SqlConnection = New SqlConnection(connString)
    Dim cmd As SqlCommand = New SqlCommand(QueryString, conn)
    Dim da As SqlDataAdapter = New SqlDataAdapter(cmd)

    'Setup Dataset'
    Dim ds As New DataSet

    'Populate Dataset'
    conn.Open()
    da.Fill(ds, "TestSample")
    conn.Close()

    'Free up memory'
    cmd.Dispose()
    conn.Dispose()

    'Populate ListView Control'
    For Each dr As DataRow In ds.Tables("TestSample").Rows
        Dim items As New ListViewItem
        items.Text = dr.Item(0).ToString()
        items.SubItems.Add(dr.Item(1).ToString())
        items.SubItems.Add(dr.Item(2).ToString())

        ListDisplay.Items.Add(items)
    Next

End Sub

Private Sub InsertBack(ByVal connString As String, ByVal QueryString As String, ByVal ParameterOne As String, ByVal ParameterTwo As String, ByVal ParameterThree As String)
    'Setup Connection'
    Dim conn As SqlConnection = New SqlConnection(connString)
    Dim cmd As SqlCommand = New SqlCommand(QueryString, conn)

    'Setup Parameters'
    cmd.Parameters.Add("@Column1", SqlDbType.Text).Value = ParameterOne
    cmd.Parameters.Add("@Column2", SqlDbType.Text).Value = ParameterTwo
    cmd.Parameters.Add("@Column3", SqlDbType.Text).Value = ParameterThree

    'Process data: Insert to database'
    conn.Open()
    cmd.ExecuteNonQuery()
    conn.Close()

    'Free up memory'
    cmd.Dispose()
    conn.Dispose()

End Sub 
```

在您可以调用的表单中使用按钮的“单击事件”来填充 ListView，如下所示

```
 'Get data from database and populate ListView: Parameter requires connection string'
    FillTable("Data Source=SERVER-PC;Initial Catalog=Database;Persist Security Info=True;User ID=UsernameIfRequired;Password=PasswordIfRequired", "SELECT * FROM TestSample") 
```

连接字符串是一个示例，您必须提供自己的，查询字符串也需要根据您的数据库进行修改。最后，将数据插入数据库，让我们从您的 ListView 项目中说，如果它们已被修改，您可以这样做......

```
 'Loop through all Items in the ListView and send to database'
    For Each item As ListViewItem In ListDisplay.Items
        'Add data to the database from ListView Items: Parameter requres connection string and the 3 input items (could be as many as you want)'
        InsertBack("Data Source=SERVER-PC;Initial Catalog=Database;Persist Security Info=True;User ID=UsernameIfRequired;Password=PasswordIfRequired", "INSERT INTO TestSample (Column1,Column2,Column3) values (@Column1,@Column2,@Column3)", item.Text, item.SubItems(1).Text, item.SubItems(2).Text)

        'Add data to the database from ListView Items: Parameter requres connection string and the 3 input items (could be as many as you want)'
        InsertBack("Data Source=SERVER-PC;Initial Catalog=Database;Persist Security Info=True;User ID=UsernameIfRequired;Password=PasswordIfRequired", "INSERT INTO AnotherSample (Column1,Column2,Column3) values (@Column1,@Column2,@Column3)", item.Text, item.SubItems(1).Text, item.SubItems(2).Text)
    Next 
```

如您所见，数据可以发送到两个不同的表..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T07:12:27.040

为什么不直接将第一个表复制到第二个表，然后将 gridview 绑定到第二个表，而不是尝试将 gridview 绑定到两者？

# ms-access - 按表关系顺序导入数据

> ID：856502
> 
> 赞同：0
> 
> 时间：2009-05-13T07:11:24.840
> 
> 标签：ms-access, import

我正在尝试在 access 数据库中创建一个通用的导入 VBA 函数。（我将链接一个类似数据库的外部表，然后将它们的数据导入本地表。）

对于初学者，该函数应该获取本地数据库中的表列表，按主键/外键排序，以便根据表关系规则进行导入。

因此，我正在尝试做类似以下的事情： [http://education.sqlfarms.com/education/ShowPost.aspx?PostID=50](http://education.sqlfarms.com/education/ShowPost.aspx?PostID=50)，但在访问 VBA 中。

因此，我需要帮助获取本地表的列表，以允许插入的方式排序（具有主键的表在关系中具有相应外键的表之前列出）

请帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T14:02:29.703

这是一个粗略的大纲，可能会有所帮助。

```
Option Explicit

Public i

Sub GetTableOrder()
Dim tdf As TableDef
Dim db As Database
Dim rs As New ADODB.Recordset

Set db = CurrentDb

''Create a disconnected recordset
rs.Fields.Append "TableName", adVarChar, 50
rs.Fields.Append "Level", adInteger

rs.CursorType = adOpenStatic
rs.Open

For Each tdf In db.TableDefs
    ''Skip system tables
    If Left(tdf.Name, 4) <> "Msys" Then
        rs.AddNew "TableName", tdf.Name
        rs.Update

        i = 0
        RelRun tdf.Name, i

        rs!Level = i
        rs.Update
    End If
Next

rs.MoveFirst

''Delete order
''ASC is the default sort order, so it is not
''necessary, and only included for illustration.

rs.Sort = "Level ASC"

''Not a good place for this line
''It is only here for convenience (mine :) )
DelRecs rs

End Sub

Function RelRun(TableName, i)
Dim rel As Relation
Dim db As Database
Dim blnFound As Boolean
Dim TableForeign As String

Set db = CurrentDb

    For Each rel In db.Relations

        If rel.Table = TableName Then
            i = i + 1
            TableForeign = rel.ForeignTable
            blnFound = True
        End If

    Next

    If blnFound Then
        ''Round and round to the end of the line
        RelRun TableForeign, i
    End If

End Function

Sub DelRecs(rs As ADODB.Recordset)
Dim strSQL As String
Dim db As Database

Set db = CurrentDb

    Do While Not rs.EOF
        strSQL = "DELETE FROM [" & rs!TableName & "]"
        db.Execute strSQL
        Debug.Print rs!TableName & " : " & db.RecordsAffected
        rs.MoveNext
    Loop

End Sub 
```

# version-control - Mercurial 中的版本控制扩展配置

> ID：856523
> 
> 赞同：8
> 
> 时间：2009-05-13T07:18:46.467
> 
> 标签：version-control, configuration, mercurial, dvcs, mercurial-extension

通常，我会通过添加以下内容来启用扩展`.hg/hgrc`：

```
[extensions]
hgext.win32text=
[encode]
** = cleverencode:
[decode]
** = cleverdecode: 
```

但是，我希望对这个配置进行版本控制，即存储库的一部分，以便为克隆存储库的任何其他人（同事、构建机器）启用它。请注意，不应该要求克隆存储库的任何人执行*任何*操作来启用这些扩展。

[从文档](http://www.selenic.com/mercurial/wiki/UsingExtensions)看来这是不可能的，但是有没有人知道任何可以帮助我的巧妙技巧？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T08:09:58.613

您希望 mercurial 在克隆存储库时自动执行某些操作（更新挂钩或配置）。[文档](http://hgbook.red-bean.com/read/handling-repository-events-with-hooks.html)说这是不可能的，并给出了一些很好的理由：

```
Hooks do not propagate

In Mercurial, hooks are not revision controlled, and do not propagate when you clone,
or pull from, a repository. The reason for this is simple: a hook is a completely    
arbitrary piece of executable code. It runs under your user identity, with your 
privilege level, on your machine. No comments

It would be extremely reckless for any distributed revision control system to 
implement revision-controlled hooks, as this would offer an easily exploitable way to 
subvert the accounts of users of the revision control system. No comments 
```

很明显，mercurial 本身并不能解决你的问题。你明确表示你只想要善变来解决你的问题，所以答案是：你所要求的是不可能的。

解决您的问题的唯一方法是，您的所有用户都必须至少运行/安装一次执行您想要的操作的给定脚本，例如安装正确的钩子。

如果你想聪明一点：

*   创建一个一次性脚本来运行，该脚本将安装一个挂钩以将正确的配置复制到 .hg 或用户
*   确保钩子一旦安装，就可以更新脚本以将配置更新分发给用户
*   使钩子添加一些特殊标记以提交消息
*   拒绝不携带特殊消息的中央存储库提交

有点复杂，但这是我能想象到的最接近您的要求：

*   用户运行一次脚本，他们忘记了
*   你可以确保如果没有运行它，他们就不能提交到你的中央仓库

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-22T09:40:25.823

当前的 Mercurial 开发版本（将于 7 月 1 日作为 Mercurial 1.3 发布）`%include`在其配置文件中支持指令。

这意味着你可以要求人们把

```
%include ../common-hgrc 
```

进入`.hg/hgrc`. 完成后，您可以通过提交更改来有效控制他们的 Mercurial 设置`common-hgrc`。当他们取消更改时，新设置将生效。

请注意，这很危险：任何可以让您将更改拉入存储库的人现在都可以插入任意挂钩`common-hgrc`，您将在下一个 Mercurial 命令（甚至是“安全”命令行`hg status`）上执行它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T09:46:43.120

您也许可以通过[ProjRC 扩展](http://mercurial.selenic.com/wiki/ProjrcExtension)解决这个问题。

“这个扩展使 Mercurial 可以查找并解析 .hg/projrc 以获取其他配置设置。文件在克隆和拉取时传输（但从不推送）”</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T07:23:52.090

如何创建一个从`.hg/hgrc`到的链接，例如`customhg/hgrc`，以便对其进行版本控制。然后您需要创建一些将其复制回的钩子`.hg/hgrc`- 例如在每次更新之后。

# facebook - Facebook 创建一个带有图像的单线故事模板

> ID：856529
> 
> 赞同：0
> 
> 时间：2009-05-13T07:19:40.600
> 
> 标签：facebook, feed

是否可以在用户名前面的 One Line Story 模板中添加一个小图像（大约 16x16 像素）？我正在使用 facebook 工具创建提要，但不知道如何在单行故事前面获得一张小图像。对于较大的故事，它适用于下面的代码，但不是单行故事？

```
{"images":[{"src":"http://pad.thedigitalmovement.com/_blaise/2007-06-15-dgen-breakfast.jpg", "href":"http://www.facebook.com"}, {"src": "http://pad.thedigitalmovement.com/_blaise/2007-06-13-roger-waters.jpg", "href":"http://www.facebook.com"}]} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T09:10:28.657

不，它不可能。虽然帖子会在墙上显示您的应用程序徽标，但您可以在开发人员应用程序中的应用程序设置中设置或更改。

# c++ - 复制、常量和非常量、getter 的优雅解决方案？

> ID：856542
> 
> 赞同：141
> 
> 时间：2009-05-13T07:25:08.767
> 
> 标签：c++, constants

当你有的时候你不讨厌它

```
class Foobar {
public:
    Something& getSomething(int index) {
        // big, non-trivial chunk of code...
        return something;
    }

    const Something& getSomething(int index) const {
        // big, non-trivial chunk of code...
        return something;
    }
} 
```

我们不能用另一种方法来实现这两种方法，因为你不能`const`从版本中调用非`const`版本（编译器错误）。需要演员才能`const`从非演员中调用版本`const`。

是否有一个真正优雅的解决方案，如果没有，最接近的解决方案是什么？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-05-13T08:48:28.833

我从一本 Effective C++ 书籍中回忆起，这样做的方法是通过从另一个函数中丢弃 const 来实现非常量版本。

它不是特别漂亮，但它是安全的。由于调用它的成员函数是非常量的，因此对象本身也是非常量的，并且允许丢弃 const。

```
class Foo
{
public:
    const int& get() const
    {
        //non-trivial work
        return foo;
    }

    int& get()
    {
        return const_cast<int&>(const_cast<const Foo*>(this)->get());
    }
}; 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-13T16:14:04.907

怎么样：

```
template<typename IN, typename OUT>
OUT BigChunk(IN self, int index) {
    // big, non-trivial chunk of code...
    return something;
}

struct FooBar {
    Something &getSomething(int index) {
        return BigChunk<FooBar*, Something&>(this,index);
    }

    const Something &getSomething(int index) const {
        return BigChunk<const FooBar*, const Something&>(this,index);
    }
}; 
```

显然，您仍然会有目标代码重复，但没有源代码重复。与 const_cast 方法不同，编译器将检查您的方法的两个版本的 const 正确性。

您可能需要将 BigChunk 的两个有趣实例声明为类的朋友。这是对朋友的一个很好的使用，因为朋友功能隐藏在靠近朋友的地方，所以没有无约束耦合的风险（哦，呃！）。但我现在不会尝试这样做的语法。随意添加。

BigChunk 可能需要尊重 self，在这种情况下，上述定义顺序不会很好地工作，并且需要一些前向声明来解决它。

此外，为了避免在标头中发现 BigChunk 并决定实例化并调用它，即使它在道德上是私有的，您可以将全部内容移到 FooBar 的 cpp 文件中。在匿名命名空间中。带内部联动。还有一个牌子上写着“小心豹子”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-13T07:34:51.667

我会将 const 转换为非常量（第二个选项）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T07:50:56.977

尝试通过重构代码来消除吸气剂。如果只有极少数其他事物需要Something，请使用友元函数或类。

一般来说，Getter 和 Setter 打破了封装，因为数据是公开的。使用朋友只向少数人公开数据，因此可以提供更好的封装。

当然，这并不总是可能的，因此您可能会被吸气剂卡住。至少，大部分或所有“重要的代码块”应该在一个或多个私有函数中，由两个 getter 调用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T07:55:45.283

对对象的`const`引用是有意义的（您限制了对该对象的只读访问），但如果您需要允许非`const`引用，您不妨将成员设为公开。

我相信这是一个 la Scott Meyers (Efficient C++)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T16:43:02.350

为什么不直接将公共代码提取到一个单独的私有函数中，然后让其他两个调用它呢？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T07:51:42.233

'const' 的概念是有原因的。对我来说，它建立了一个非常重要的合同，基于该合同编写程序的进一步指令。但是您可以在以下几行中做一些事情：-

1.  使您的成员“可变”
2.  使“吸气剂”成为常量
3.  返回非常量引用

有了这个，如果您需要维护使用 getter 的 const 功能以及非常量用法（危险），可以在 LHS 上使用 const 引用。但是现在程序员有责任维护类不变量。

正如之前在 SO 中所说，丢弃最初定义的 const 对象的 const 并使用它是 UB 所以我不会使用强制转换。同样制作一个非常量对象 const 然后再次抛弃 const 看起来不太好。

我在某些团队中看到的另一个编码指南是：-

*   如果需要在类外部修改成员变量，请始终通过非常量成员函数返回指向它的指针。
*   没有成员函数可以返回非常量引用。const 成员函数只允许 const 引用。

这允许在整个代码库中保持一定的一致性，并且调用者可以清楚地看到哪些调用可以修改成员变量。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2010-01-29T05:42:00.193

我敢建议使用预处理器：

```
#define ConstFunc(type_and_name, params, body) \
    const type_and_name params const body \
    type_and_name params body

class Something
{
};

class Foobar {
private:
    Something something;

public:
    #define getSomethingParams \
    ( \
        int index \
    )

    #define getSomethingBody \
    { \
        return something; \
    }

    ConstFunc(Something & getSomething, getSomethingParams, getSomethingBody)
}; 
```

# c++ - C++ 库需要 LibCurl - 应用程序的用户是否需要 libcurl？

> ID：856545
> 
> 赞同：4
> 
> 时间：2009-05-13T07:26:10.870
> 
> 标签：c++, libcurl

我通常是一名 Java 开发人员，但我现在正在编写一个 C++ 库，他们将使用 LibCurl。而且我对 C++ 世界一无所知！

我正在写的实际上是一个供其他开发人员使用的库（它是用于访问我们 API 的客户端代码）。

最终用户是否需要安装 libcurl，或者开发人员可以以某种方式将其包含在 EXE 中或以某种方式将其打包？

其实也是一样，我可能会在库中使用 QT，他们需要安装这个吗？我猜它的工作方式是开发人员当然会需要它，但是一旦它编译成二进制就不需要了？与你需要 Jar 文件的 java 不同......

为任何帮助干杯，艾伦

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T07:42:11.437

如果静态链接 libcurl，则最终用户不需要 libcurl，因为它将在编译时直接链接到可执行文件。

如果动态链接 libcurl，则最终用户确实需要将 libcurl 安装在他们的系统上并作为共享对象库提供。

但是，您处于不同的位置。您正在编写一个供其他开发人员使用的库。因此，您的最终用户实际上并不是真正的最终用户。在这种情况下，提供动态链接到 libcurl 是“更好的”。

如果您静态链接，那么您的库将在其代码中封装 libcurl 库的副本。现在想象一个使用你的库的开发者也在使用其他 10 个库，所有这些库都静态链接到 libcurl。该开发人员基本上将在他/她的最终产品中包含 10 个 libcurl 副本。这不是很有效，因此在开发库时首选针对依赖项的动态链接。

然而...

如果开发人员正在使用 10 个需要 libcurl 的不同库，但其中一些库需要特定的旧/新版本，那么静态链接将很有用。

希望有帮助...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T07:33:09.597

许多库可以[静态](http://en.wikipedia.org/wiki/Static_linking)或[动态](http://en.wikipedia.org/wiki/Dynamic_library#Dynamic_linking)链接使用。Curl 就是其中之一（参见例如[此消息](http://curl.haxx.se/mail/lib-2006-09/0128.html)，我会说这样做是合理的。QT 相当庞大，因此您应该尽可能动态链接它。但是，即使它也可以[静态链接](http://doc.trolltech.com/4.1/deployment-windows.html#static-linking)。

静态链接和动态链接之间的本质区别在于，静态链接将库包含在应用程序的目标代码中，而动态链接则应用程序从安装它的系统按需访问库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T02:46:00.463

我用 C++ 编写了一个闭源应用程序，它在早期版本中链接到 libcurl。

结果证明这是一个错误，因为每个 Linux 版本都有不同的 libcurl。与 glibc 和 libstdc++ 相比，它的跨版本兼容性要差得多。我不想随应用程序一起提供 libcurl 库。

我有简单的需求。所以我改写了应用程序来调用 curl 使用 system() 代替。这适用于每个版本的 Linux。

# php - PHP：将 64 位整数转换为字符串

> ID：856549
> 
> 赞同：3
> 
> 时间：2009-05-13T07:26:47.763
> 
> 标签：php, casting, 64-bit, long-integer

我正在尝试在字符串变量中使用硬编码的 64 位整数。

简化我想做这样的事情：

```
$i = 76561197961384956;
$s = "i = $i"; 
```

这应该导致`s`：

```
i = 76561197961384956 
```

这显然不起作用，因为 PHP 将大整数转换为浮点数，因此`s`是：

```
i = 7.65611979614E+16 
```

虽然铸造等其他几种方法都失败了，但我发现`number_format()`并像这样使用它：

```
$s = "i = " . number_format($i, 0, '.', ''); 
```

但这导致`s`：

```
i = 76561197961384960 
```

看起来像一个近似问题，但如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T07:40:52.437

您正在失去分配的精度，而不是字符串转换。如果此变量的值实际上是硬编码的，并且您无法更改它，那么您无能为力。

像这样的一行：

```
$i = 76561197961384956; 
```

总是会失去精度。如果您需要保留整个内容，请将其存储到一个字符串中，您不能将它存储为这样的 int 并保留所有数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T07:34:02.760

我认为唯一的方法是使用这些[`bcmath`](http://uk3.php.net/manual/en/book.bc.php)功能。

> 对于任意精度的数学，PHP 提供了二进制计算器，它支持任何大小和精度的数字，以字符串表示。

这是你`$i`的错误，而不是字符串转换 - PHP 在内部使用 32 位整数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T08:14:09.763

目前，在 php 中进行大整数数学运算的唯一方法是使用 bcmath 或 gmp 扩展，将大数字作为字符串处理。64 位整数在 php6 中进行了规划。

因此，当使用大整数时，将它们转换为字符串，否则您将失去分配精度（自动转换为 float），然后使用字符串数学库中的一个来进一步处理您的数字。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-13T07:34:44.227

您是否尝试过使用 PHP 的 intval() 函数？

# c++ - C ++干净地将日期时间字符串转换为纪元

> ID：856551
> 
> 赞同：9
> 
> 时间：2009-05-13T07:28:01.290
> 
> 标签：c++, datetime, stl, boost

是否有 C/C++/STL/Boost clean 方法将日期时间字符串转换为纪元时间（以秒为单位）？

```
yyyy:mm:dd hh:mm:ss 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T07:41:02.423

请参阅：[日期/时间转换：字符串表示到 time_t](https://stackoverflow.com/questions/321793/date-time-conversion-string-representation-to-timet)

并且：[[Boost-users] [date_time] 那么为什么没有 to_time_t 辅助函数呢？](http://archives.free.net.ph/message/20060504.123105.73e1c873.en.html#boost-users)

所以，显然这样的事情应该有效：

```
#include <boost/date_time/posix_time/posix_time.hpp>
using namespace boost::posix_time;

std::string ts("2002-01-20 23:59:59");
ptime t(time_from_string(ts));
ptime start(gregorian::date(1970,1,1)); 
time_duration dur = t - start; 
time_t epoch = dur.total_seconds(); 
```

但我认为它并不比[Rob 的建议](https://stackoverflow.com/questions/321793/date-time-conversion-string-representation-to-timet/321847#321847)干净得多： use `sscanf`to parse the data into a`struct tm`然后调用`mktime`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T07:43:32.387

在 Windows 平台上，如果不想使用 Boost，您可以执行以下操作：

```
// parsing string
SYSTEMTIME stime = { 0 };
sscanf(timeString, "%04d:%02d:%02d %02d:%02d:%02d",
       &stime.wYear, &stime.wMonth,  &stime.wDay,
       &stime.wHour, &stime.wMinute, &stime.wSecond);

// converting to utc file time
FILETIME lftime, ftime;
SystemTimeToFileTime(&stime, &lftime);
LocalFileTimeToFileTime(&lftime, &ftime);

// calculating seconds elapsed since 01/01/1601
// you can write similiar code to get time elapsed from other date
ULONGLONG elapsed = *(ULONGLONG*)&ftime / 10000000ull; 
```

如果你更喜欢标准库，你可以使用 struct tm 和 mktime() 来做同样的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T07:30:55.963

[http://www.boost.org/doc/libs/1_39_0/doc/html/date_time.html](http://www.boost.org/doc/libs/1_39_0/doc/html/date_time.html) 应该可以解决问题。

# c# - 如何在 jquery 方法中获取 asp.net 会话值？

> ID：856553
> 
> 赞同：12
> 
> 时间：2009-05-13T07:30:07.977
> 
> 标签：c#, asp.net, jquery, asp.net-mvc

我想在 ASP.NET MVC 视图页面中访问 jquery 方法中的 Session 值。看下面的代码，

```
$('input[type=text],select,input[type=checkbox],input[type=radio]').attr('disabled', '<%= Session["CoBrowse"].ToString() %>'); 
```

如何在 jquery 中获取 Session 值。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-13T07:39:34.983

```
$('input,select').attr('disabled','<%=Session["CoBrowse"].ToString() %>'); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-13T07:39:56.120

不确定这是否是最佳路线，但在您的 aspx 页面中，您可以创建一个返回会话变量值的方法，例如

服务器端：

```
using System.Web.Services;
 [WebMethod(EnableSession = true)]
public static string GetSession()
{
   return Session["CoBrowse"].ToString();
} 
```

然后使用jQuery调用这个方法客户端：

```
$.ajax({
    type: "POST",
    url: "./Default.aspx/GetSession",
    data: "{}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(result){
        ('input[type=text],select,input[type=checkbox],input[type=radio]').attr('disabled', result.d);
    }
}); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-13T08:49:33.183

很多评论：

1.  您不能“从 jQuery 访问会话”。您使用 MVC 和 asp.net 创建 HTML 页面（使用 JavaScript）。Session 是服务器端的对象，JavaScript 运行在客户端。
2.  看看[jQuery 的选择器](http://docs.jquery.com/Selectors)。它们有有用的选择器，例如`:checkbox`,`:text`等。
3.  `true`您的代码生成您期望的 JavaScript：它在正确的位置或`false`在正确的位置编译、运行和生成 JavaScript 。
4.  这不是禁用元素的方法。如果一个元素具有 'disabled' 属性，它将被禁用，无论值如何。`<input type="checkbox" disabled="false" />`也是一个禁用的复选框，因此**您的控件始终处于禁用**状态。
5.  如果这是您无论如何选择的方式，请考虑：

    ```
    var isCoBrowse = <%= Session["Name"].ToString().ToLower() %>;
    if(!isCoBrowse) //disable controls
      $(":text,:checkbox,:radio").attr("disabled","disabled"); //standard. 
    ```

    这将生成客户端 JavaScript 代码：

    ```
    var isCoBrowse = true; 
    ```

    并且，要启用一个元素：

    ```
    $("input").removeAttr("disabled"); 
    ```

此外，还有更好的方法来实现这一点。如果可能的话，您是否考虑过禁用服务器端的控件？

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-06-13T18:35:24.063

```
<input id="sessionInput" type="hidden" value='<%= Session["name"] %>' />

var getSessionValue = $('#sessionInput').val(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-28T16:21:33.470

如果该 Session 变量是敏感数据（在这种情况下可能不是），我不会使用此解决方案，因为当您查看 javascript 源时它会显示 Session 数据。如果它是敏感的会话数据，最好通过 Web 方法访问它（参见上面的答案）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-07-05T14:38:49.330

简单的！当你知道如何：

@Html.Encode(Session("classificationTitle"))

...并在 .js 文件中：

```
var classificationTitle = document.getElementById('classificationTitle').innerHTML; 
```

抱歉 - 我不能发布完整的 html，因为这个网站去掉了尖括号:(

# c# - 优化 NHibernate 查询

> ID：856560
> 
> 赞同：0
> 
> 时间：2009-05-13T07:33:26.380
> 
> 标签：c#, .net, sql-server, nhibernate, orm

在我的系统中，我对包含大量集合的聚合进行集中计算。我需要在计算之前加载所有集合，因此我使用一个多标准来连接根上的集合。

我在下面列出的标准。在我的本地设置上运行大约需要 500 毫秒，这需要用户等待很多。有人对我如何优化这个有任何想法吗？感谢任何可以使此查询更快的帮助！

（为了一点隐私，我更改了集合的名称 :)）

```
IMultiCriteria criteria = session.CreateMultiCriteria()
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("ACollection", JoinType.LeftOuterJoin)
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("BCollection", JoinType.LeftOuterJoin)
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("CCollection", JoinType.LeftOuterJoin)
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("ECollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("FCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("GCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("HCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("JCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("KCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("LCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("MCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("NCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("OCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("PCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("QCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("RCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("SCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("TCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("UCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("VCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("WCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("XCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("YCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("ZCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("AACollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("ABCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("ACCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("ADCollection", JoinType.LeftOuterJoin))
.Add(DetachedCriteria.For<Building>()
     .Add(Restrictions.Eq("Id", BuildingId))
     .CreateCriteria("AECollection", JoinType.LeftOuterJoin)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-06T08:57:24.390

一段时间后，我终于意识到，对于这个确切的场景，使用像 MongoDB 这样的面向文档的数据库或对象数据库可能更有意义。

这样我就可以一次性加载整个聚合而忘记连接。

因此，对于遇到上述情况的任何人，请考虑使用面向文档的方法。

我最初的测试显示了承诺:)

可以在此处找到对 MongoDB 的介绍：http: [//mookid.dk/oncode/archives/1057](http://mookid.dk/oncode/archives/1057)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-05T21:47:13.083

我可以推荐的第一件事是启动您的 Sql Profiler 并获取传入的 sql 的精确副本。然后我会将其放入 Sql Tuner 中，这很可能会建议创建新索引并添加/更新部分或全部表的统计信息。

在这一点上，我将在潜入尝试对 HQL 进行性能调整之前运行性能测试。

# java - 我们从哪里开始使用单元测试？

> ID：856561
> 
> 赞同：0
> 
> 时间：2009-05-13T07:33:34.073
> 
> 标签：java, jakarta-ee, junit

**我们从哪里开始使用单元测试？**
我对从哪里开始使用单元测试有一些疑问。
我正在 RAD 中使用 Junit 进行单元测试。在所有代码都准备好部署或可能在部署之后，我正在这样做。我很困惑为什么我们在代码几乎准备好部署之后进行单元测试。
我的问题是我们应该什么时候开始单元测试？

我还有一些问题......
我在单元测试中所做的是我从一个类中获取一个方法并为该方法创建一个测试类。
在那个类中，我为方法提供了一些输入值，并期望从数据库中得到尊重的输出值。
现在这里单个测试类确实获取输入值->将其传递给方法->从原始类调用方法->数据库连接->从数据库中获取值->将其返回给测试类。

如果测试成功运行，则 Junit 控制台显示绿色条，否则显示红色条。
错误原因的红色条。但它不会生成任何单元测试报告。

**现在这是我的问题......**
我在做正确的单元测试吗？由于单个单元测试方法包含所有代码流并给出结果......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T07:50:18.990

如果您还没有开始单元测试，最好的时机就是现在。单元测试最有效的用途是测试驱动开发 (TDD)，在这种开发中，您在实现每个方法时为每个方法编写测试（编写一个失败的测试，然后实现该方法以使其通过）。但是，稍后添加测试还为时不晚。JUnit 测试巩固了关于以后可能会改变的代码的某些假设。如果假设发生变化，测试就会中断，您可能会避免一些很难检测到的错误。

我不知道报告工具，但您可以添加一个 JUnit ANT 任务，它将测试结果输出到您的构建控制台（或日志，如果捕获了 ant 输出）。

您的数据库测试听起来像是小型集成测试，而不是单元测试。这很好，但如果测试太慢，您可能需要考虑使用模拟对象（通过 JMock 或 EasyMock 之类的框架）将真实的数据库连接替换为假的。这将方法的逻辑与数据库的状态和行为隔离开来，让您运行测试而不必担心数据库是否正在运行并存储有测试数据。

有用的链接：

[http://en.wikipedia.org/wiki/Test-driven_development](http://en.wikipedia.org/wiki/Test-driven_development)

[http://www.jmock.org/](http://www.jmock.org/)

[http://easymock.org/](http://easymock.org/)

[http://ideoplex.com/id/25/ant-and-junit](http://ideoplex.com/id/25/ant-and-junit)

[http://ant.apache.org/manual/Tasks/junit.html](http://ant.apache.org/manual/Tasks/junit.html)

[http://misko.hevery.com/code-reviewers-guide/](http://misko.hevery.com/code-reviewers-guide/) （编写可单元测试代码的指南）

[编辑-回应评论]：关于您所做的是否是正确的单元测试，从技术上讲，答案是“否”。正如我所说，它更像是一个集成测试，这很好，但是它做的太多并且有太多的依赖关系，不能被认为是真正的单元测试。理想情况下，单元测试将测试方法中的逻辑而不是依赖关系。上面提到的编写可测试代码的指南（以及 Misko Hevery 的相关博客）就如何编写带有接缝的代码以插入依赖项的模拟提供了一些很好的建议。[Michael Feathers 在其出色的著作《有效地使用遗留代码》](https://rads.stackoverflow.com/amzn/click/com/0131177052)中深入探讨了该主题。

关键因素是依赖注入：可测试的方法不寻找它们的依赖——它们在构造函数中或作为参数接收它们。如果这需要太多重构，您可以尝试一些技巧，例如将查找依赖项的代码移动到您可以覆盖的受保护或包可见的方法中。因此，您在从这些方法返回模拟对象的子类上运行测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T07:49:33.000

您应该尽早编写测试，最好是在编写实现之前。

这是一本我发现对这个主题很有用的书，可能值得一读...... [http://www.amazon.com/Test-Driven-Development-Addison-Wesley-Signature/dp/0321146530](https://rads.stackoverflow.com/amzn/click/com/0321146530)

为了尝试解决您的第二点，您所描述的是“集成测试”，即它不仅测试您的代码单元，还测试您的数据库连接性、配置、数据等。

单元测试应该只测试你关心的代码的特定“部分”。即调用你的方法应该只是测试那个方法。它不应该与数据库连接和数据访问有关。您可以使用“模拟”对象来临时替代您的依赖项来实现这一点。

请参阅：http: [//msdn.microsoft.com/en-us/library/aa730844.aspx](http://msdn.microsoft.com/en-us/library/aa730844.aspx)

虽然本文档来自 Microsoft，并且您使用的是 java，但同样的原则也适用。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T07:50:48.460

您应该尽早开发单元测试。事实上，最好的解决方案是在您实现要测试的类之前开发它们。然后，每次将重要的功能添加到您的类时，您都运行它们。

单元测试，顾名思义，用于测试操作的“单元”。你不应该让一个测试执行太多。此外，单元测试应该测试单个类的功能。

您在这里描述的似乎更像是系统测试。这是一件好事，但它与单元测试完全不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T08:14:49.027

进行认证开发需要您遵循已定义的开发模型。最常用的模型是 V 模型，简单地说，它定义了需求、规格、子规格（例如组件、模块或单元的规格）等。在 V 的左分支上自上而下。你比最终到达底部V 当规范定义了一个不能合理地分解成更小部分的原子单元时。

在 V 模型的右分支上，您可以验证开发的模块是否符合其规范和/或要求。它通常用于并行或在实施 UUT（被测单元）之前创建测试。通过这种方式，您可以确保任何模块从一开始甚至在进行一些返工时都适合其框架。

正如其他人所说，尽可能使用模拟等保持测试尽可能简单。您还应该自动化您的测试，至少是那些与位于 V 底部附近的模块相关的测试，因为这些测试通常比靠近顶部的那些测试运行得更频繁。

当您的测试有明确定义的输出时，做正确的报告会容易得多。我们通常有一个枚举结构（通过、失败、错误）、状态编号和消息文本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T10:07:45.943

每次您进行更改或编写新代码时，您都应该对每个输入组合进行测试。编写代码永无止境，有些人有时必须回来进行修复或增强，您的测试将帮助他们知道他们所做的更改并没有破坏任何东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T16:59:01.653

> 我的问题是我们应该什么时候开始单元测试？

不是“在所有代码都准备好部署之后”。不是“部署后”。为时已晚。正如许多其他人所建议的那样，最好的时间是（就）在编写代码之前，TDD 风格。

> 现在这是我的问题......我在做正确的单元测试吗？由于单个单元测试方法包含所有代码流并给出结果......

您没有进行“正确”的单元测试。您正在测试的*单元*是类方法，但它也在测试数据库连接，这通常会使测试太慢而无法按照我们的意愿频繁运行，而且很脆弱。这并不是说您的测试没有用——它们可能很有用——它们只是不是好的单元测试。

假设您的数据库中有正确的数据，并且您的程序与它有可靠的连接。在测试过程中，您的方法将从数据库中获得什么价值？只需将该值直接放入，即可测试此方法的功能。所以即使没有数据库它也能运行。那是什么？你的方法不行吗？也许它做得太多了。也许它是（a）从数据库中获取数据和（b）进行计算。也许您真的只想测试（b）（我想您会这样做）。因此，将 (a) 和 (b) 分开，给自己一个接缝（根据 Michael Feathers 的术语），您可以在该接缝处从测试方法中注入测试数据。你现在有什么？更好的设计。每种方法只做*一*件事。松耦合。你到达那里是因为你的测试引导你到达那里。 **是测试驱动的开发。**

 *** * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T16:34:35.640

在我看来，测试应该从你写完第一个方法的那一刻开始。

编写方法时的测试方法对很多事情都有帮助。一方面，当出现问题而你唯一的线索是它在一个特定的类中时，如果该类有无数的方法和属性，那么很难弄清楚哪里出了问题。如果您遇到语法错误，显然不会，但是当您将一百万个方法投入战斗时，语义错误会变得非常棘手。

确保每个单独的方法都有效，这是最细粒度的保证，说明了整个类的稳定性。如果您对特定方法应该做什么有一个具体的定义，单元测试不仅可以防止边缘情况下的语义错误，还可以帮助您提前规划程序流程，这可以帮助您避免大规模重构，或者更糟，重写。

为了进行有效的测试，请确保您将您的课程分解为尽可能多的方法。我知道有些人可能不同意这一点，但是在远离函数其余部分的上下文中执行操作的重要部分逻辑应该移到它们自己的函数中，以便可以独立测试。我不会在您的单元测试中执行 SQL 查询。相反，使用模拟对象来模拟数据库。测试数据库不是单元测试。

这不仅可以帮助您确保应用程序的完整性，而且还可以在将来需要重构类的某些部分时为您提供帮助。在 100 行函数中搜索三行逻辑是没有意义的。如果这些逻辑部分在它们自己的方法中，您可以放心，您的方法不会因为该逻辑而失败。如果那个怪物的函数失败了，那么关于函数的哪个部分实际上导致错误的线索就会更少。

我知道这一切听起来可能是多余的，但我的观点是尽早进行测试，并且经常进行测试不仅有助于提高程序的稳定性，还有助于编写干净的代码并避免因寻找小错误而头疼的问题。

# project-management - 在编码期间对抗切换项目的冲动？

> ID：856563
> 
> 赞同：4
> 
> 时间：2009-05-13T07:34:14.803
> 
> 标签：project-management

我今年 22 岁，从 13 岁开始接触计算机，过去 3 年一直在编程。我在当地大学的 CSE 课程中。我一直在不停地思考创业想法和开源贡献项目，但我发现坚持这个项目非常困难。我开始编码，然后在编码时我停下来思考一些我认为可能是个好主意的新东西。这对程序员来说是正常的吗？如果不是，我该如何对抗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T07:48:44.093

我自己也经常有这个。你开始做一个项目，充满热情，充满激情，充满了伟大的想法，然后慢慢地，随着你的进步，你开始渴望别的东西，想做一个新的项目，等等。

在我看来这*是*正常的。我认为有很好的解释：

*   其中大部分与经典的“80%-20%”规则（[帕累托原则](http://en.wikipedia.org/wiki/Pareto_principle)）有关，*我认为*这里也适用。你设计了这个伟大的架构，开始编码，一切似乎都很好，你很自豪，你觉得你已经取得了伟大的成就，然后……无聊的东西来了。你已经完成了有趣的事情，现在你必须修复错误，做一些小改动，剩下的架构挑战很少，更糟糕的是：你可能已经完成了 80% 的项目，但剩下的 20%（无聊东西）仍然会占用你总时间的 80%。令人沮丧。请给我一些新的东西！
*   我能想到的另一个原因是，在你的脑海中，你的小软件程序总是比事实证明的要酷得多*。*你认为你已经提出了这个伟大的架构，非常酷的用户界面——你说出它的名字，结果证明它只是另一个软件。

我不认为你一个人在这个。尽管写一个“待办事项”清单可以有所帮助（就像其他一些人提到的那样），但它并不总是能摆脱那种感觉 :-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T07:43:08.673

为您当前的项目写一个待办事项列表。
在完成当前项目的同时，考虑/计划下一个项目。

我已经完成了开发[ChgDoc](http://www.ianquigley.com/T2_chgdoc.html)的一半，想完成并开始[Twipler](http://www.ianquigley.com/A15_Twipler.html)。因此，我为 ChgDoc 编写了一个“待办事项”列表，完成后我将开始我的下一个项目，该项目仍处于规划阶段。也许当我开始下一个项目时，我会不再喜欢这个想法并转向其他事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T08:12:18.643

是的，冷漠一直是我自己编程生涯中最大的挑战。不过，我从少数几个确实在某个地方取得成功的项目中发现，我从制作可靠的东西中获得的满足感是无与伦比的，尤其是当我不得不努力度过难关时.

当事情变得艰难时，我会尽量记住这一点，我花在项目无聊部分上的时间和精力实际上会增强我最终获得的成就感。此外，我发现我花在完成平凡任务上的时间和精力越多，我的效率就越高，因此完成它们所需的时间就越少，工作也变得不那么无聊。如果您在项目之间有空闲时间，请尝试考虑如何优化处理无聊部分的过程（通过各种工具、技术和技术）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T07:46:57.483

我会说是的（无论如何对我来说都很好）。有时事情会变得无聊——你只需要克服困难。如果这个项目真的很无聊，那么一定要离开它——但想想你为什么首先选择它？它是否满足了您作为消费者的某些用例。如果确实如此，并且您已经实现了目标，那很好，否则请自问为什么不这样做。另一个需要考虑的重要事情是，如果你在大学，那么完成项目将是未来招聘活动的一个加分点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T08:26:41.363

这并不少见，但如果你不学会完成项目，你将永远无法完成任务。未完成的 SW 毫无价值，最终浪费资源——反正没人能用。在我的职业生涯中，总是有几个项目在不同阶段并行运行。但是我们必须分配优先级和资源，以便在截止日期（或延长的截止日期:-)）内完成和完成所有事情。否则你最终必须关闭你的工作、服务甚至整个公司。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-04T21:04:44.000

我一直认为这种冲动是我的大脑告诉我它很无聊。我开始很容易分心，我的大脑说新项目。

我使用的一种技术是给自己发送一封电子邮件，其中包含这个想法的大脑转储。一旦它在电子邮件中，它可以被归档到一个待办事项文件夹中，以供以后检查。这似乎有助于减轻压力。

# cocoa - 使用 NSURLConnection 强制 HTTP v1.0 请求

> ID：856564
> 
> 赞同：2
> 
> 时间：2009-05-13T07:34:30.873
> 
> 标签：cocoa, cocoa-touch, http, http-headers

NSURLConnection 默认使用 HTTP v1.1 执行 GET 请求。

如何让它使用 HTTP v1.0 执行 GET 请求？

或者我可以设置一个 HTTP 标头来为我执行此操作吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T21:28:26.657

在快速浏览了 NSURLRequest API 之后，我没有看到任何从该级别执行此操作的方法，但是您可以通过下拉到 CFNetwork.framework（Mac 上的 CoreServices.framework）中的 HTTPMessage API 来实现。例如：

```
CFHTTPMessageRef request = CFHTTPMessageCreateRequest( kCFAllocatorDefault,
    CFSTR("GET"), theURL, kCFHTTPVersion1_0 ); 
```

如果你想要一个围绕这个的 ObjC 包装器，有一些可用的，包括[我自己设计的一个](http://github.com/AlanQuatermain/aqtoolkit/tree/master). 那是一个相当基本的 CF API 包装器，但您可以从中获取 NSInputStream，您可以使用标准 NSInputStream API 读取响应数据。

其他的，比如[ASIHTTPRequest](http://github.com/pokeb/asi-http-request/tree/master)提供了一个更大的 API，你可能更喜欢它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-09T12:34:56.863

最新版本的 ASIHTTPRequest 有一个简单的方法来做到这一点：

```
[request setUseHTTPVersionOne:YES]; 
```

# batch-file - 连接变量

> ID：856573
> 
> 赞同：61
> 
> 时间：2009-05-13T07:37:28.463
> 
> 标签：batch-file

我需要为执行以下操作的 DOS 做一个 .bat：

```
set ROOT = c:\programas\
set SRC_ROOT = (I want to put the ROOT Here)System\Source 
```

所以在定义 ROOT 我想要 SRC_ROOT = c:\programas\System\Source

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-13T07:42:02.983

```
set ROOT=c:\programs 
set SRC_ROOT=%ROOT%\System\Source 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-06-23T09:41:39.920

请注意，如果字符串有空格，则在定义时需要引号，并且在连接时必须切掉：

```
rem The retail files set
set FILES_SET="(*.exe *.dll"

rem The debug extras files set
set DEBUG_EXTRA=" *.pdb"

rem Build the DEBUG set without any
set FILES_SET=%FILES_SET:~1,-1%%DEBUG_EXTRA:~1,-1%

rem Append the closing bracket
set FILES_SET=%FILES_SET%)

echo %FILES_SET% 
```

干杯...

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-05-02T11:15:26.477

如果需要用引号连接路径，可以使用`=`替换变量中的引号。这不需要您知道路径是否已经包含引号。如果没有引号，则没有任何更改。

```
@echo off
rem Paths to combine
set DIRECTORY="C:\Directory with spaces"
set FILENAME="sub directory\filename.txt"

rem Combine two paths
set COMBINED="%DIRECTORY:"=%\%FILENAME:"=%"
echo %COMBINED%

rem This is just to illustrate how the = operator works
set DIR_WITHOUT_SPACES=%DIRECTORY:"=%
echo %DIR_WITHOUT_SPACES% 
```

# sql-server - SQL Server 2008 占用大量内存？

> ID：856575
> 
> 赞同：11
> 
> 时间：2009-05-13T07:38:55.170
> 
> 标签：sql-server, sql-server-2008, memory-consumption

我正在对我的数据库进行压力测试，该数据库托管在 SQL Server 2008 64 位上，运行在具有 10 GB RAM 的 64 位机器上。

我有 400 个线程。每个线程每秒查询一次数据库，但查询时间并不像 SQL 分析器所说的那样花费时间，但 18 小时后 SQL Server 会占用 7.2 GB 的 RAM 和 7.2 GB 的虚拟内存。

这是正常行为吗？如何调整 SQL Server 以清理未使用的内存？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-13T07:46:16.627

SQL Server 旨在使用尽可能多的内存，通过在内存中缓存大量内容来提高性能。建议为 SQL Server 使用专用机器，这使得这是一种完全有效的方法，因为它不期望其他任何人需要内存。所以你不应该担心这个；这是完全正常的。

也就是说，如果您使用的是开发机器而不是实时环境，您可能希望限制内存量以阻止您的机器被接管。在这种情况下，最简单的方法是打开 SQL Server Management Studio，右键单击服务器并选择“属性”，然后在“内存”选项卡上可以设置最大服务器内存。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-07T19:49:38.893

实际上，有一个巧妙的小技巧可以得到你想要的东西。问题/问题是如何让SQL Server“暂时”放弃它可能不需要的内存，然后让它根据需要重新使用它。

为此，请运行以下脚本：

```
EXEC sys.sp_configure N'show advanced options', N'1'

RECONFIGURE WITH OVERRIDE

GO

EXEC sys.sp_configure N'max server memory (MB)', N'{low water mark}'

GO

RECONFIGURE WITH OVERRIDE

GO

EXEC sys.sp_configure N'max server memory (MB)', N'{High water mark}'

GO

RECONFIGURE WITH OVERRIDE

GO

EXEC sys.sp_configure N'show advanced options', N'0'

RECONFIGURE WITH OVERRIDE

GO 
```

输入您自己的 {low water mark} 和 {high water mark} 值（以 MB 为单位）。

这将强制内存减少到最小数量，然后如果 SQL Server 需要/想要它，则立即再次打开它。

唯一剩下要做的就是安排脚本定期运行。

推荐：

如果 SQL Server 没有大量使用，请尝试每 6 小时自动运行一次。如果它被大量使用，则每 24 小时运行一次（比如在半夜或一天开始之前）。您的使用情况会有所不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T12:08:50.357

离开 Greg 的回答，当您配置内存时，请尝试为操作系统留出至少 10% 的可用内存。如果 SQL 在长查询中失控，您希望该缓冲能够远程进入并仍然管理该框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T05:36:48.543

[http://support.microsoft.com/kb/961323](http://support.microsoft.com/kb/961323)

我认为这是解决此问题的方法。它建议进行累积更新。 [http://hotfixv4.microsoft.com/SQL%20Server%202008/nosp/SQL_Server_2008_Cumulative_Update_3/10.00.1787.00/free/370328_intl_x64_zip.exe](http://hotfixv4.microsoft.com/SQL%20Server%202008/nosp/SQL_Server_2008_Cumulative_Update_3/10.00.1787.00/free/370328_intl_x64_zip.exe)

# c# - 实现具有许多插入、删除和读取的数据表的最佳实践是什么？

> ID：856576
> 
> 赞同：0
> 
> 时间：2009-05-13T07:38:58.430
> 
> 标签：c#, sql-server-2005, ado.net

我正在创建一个功能，我们的 wcf 服务会记录通过它们存储的所有更改，并且这些更改需要发送到其他系统。

在每次带有更改的服务调用之后，我们将更改存储在一个表中（更改是序列化的）。定期我们有 biztalk 从表中提取更改并删除已拉出的更改。

这意味着在高负载期间插入和删除的数量很高，我们为选择超时而挣扎，因为它被插入阻塞了。

我尝试过使用不同的隔离级别，但还没有找到任何有效的方法。

为此，我们使用 ado.net 和 sql server 2005。

使用 sql server 2005 和 ado.net 时，实现具有许多插入、删除和读取的数据表的最佳实践是什么。

已编辑：我们今天的解决方案中的问题是所有继续插入都停止了从表中读取的所有内容。可能是因为如果聚集索引扫描我暂时看不到删除的好方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T08:34:36.907

在数据库方面：

*   尝试使用称为 READPAST 的锁定提示，它会跳过被其他事务锁定的行。有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms187373(SQL.90).aspx)。
*   Sql Server 有时会在认为更经济的情况下将锁从行级别升级到页面或表级别。您可以使用提示 ROWLOCK 强制将锁保持在行级别。
*   删除任何不必要的索引，因为它们会减慢插入、更新和删除的速度，并且还会导致索引数据出现锁定问题。

在 C# 代码方面：

*   使用“尽可能晚地获取资源并尽可能早地释放它们”的最佳实践。在对结果执行任何耗时的操作之前，打开您的 ADO.NET 连接，运行您的 sql 命令并关闭您的连接。您不必担心连接池，只要您始终使用相同的连接字符串，它就会自动完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T07:48:24.640

这是您的 DBA 应该做的事情。你是DBA吗？如果是这样，那么您需要查看运行一些性能测试以了解瓶颈是什么。这篇文章应该有助于介绍性能调整： http: [//www.devx.com/getHelpOn/Article/8202/](http://www.devx.com/getHelpOn/Article/8202/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T08:22:33.447

如果您的应用程序的语义允许，请考虑在单独的“辅助表”中进行插入，并在单个大型事务中定期将它们应用到“主表”；可以类似地处理删除（您现在要进行删除，而是插入到一个单独的辅助表中，该记录标识要删除的主表记录，并定期在一个大表中从主表中执行一堆删除交易）。

当然，如果您这样做，主表将不会反映“最新状态”，而是“几分钟[或任何时间单位]前的状态”，这就是我说“如果语义允许”的原因。有时可以让许多 SELECT 依赖于“上次更新时的状态”（即主表中的内容），而一些真正需要立即反映最新更新的 SELECT 可以通过更复杂的方式来满足（可能会慢一点）使用主表和辅助表进行查询（通过 UNION、连接或其他方式，具体取决于您需要实现的语义细节）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T08:24:42.723

您提到您尝试过不同的隔离级别，但您是否尝试过快照隔离？

快照隔离基本上是在插入/更新之前制作该行的副本，并且任何尝试选择该行的查询都会获取旧副本，直到插入完成。这意味着您偶尔会得到稍旧的数据，但在插入发生时选择不会阻塞。

这样做的缺点是您的插入/更新将需要更长的时间，因为需要复制。我不确定它会受到多少惩罚。

# asp.net - 如何从网络应用程序验证到谷歌帐户服务以使用谷歌数据

> ID：856577
> 
> 赞同：1
> 
> 时间：2009-05-13T07:39:13.830
> 
> 标签：asp.net, authentication, service, using

有人可以告诉我如何使用用户名和密码通过网络应用程序访问谷歌服务，例如谷歌阅读器中的用户提要项目。我不希望用户进行身份验证。我想要 ASP.net 中的解决方案。

在[http://dalelane.co.uk/blog/?p=303上已经有一个 Python 可用的解决方案](http://dalelane.co.uk/blog/?p=303)

但是我不知道python。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T07:42:46.007

python代码并没有按照你的想法做。它要求用户已经登录。

请在此处查看您链接到的文章中的链接：[http ://code.google.com/appengine/docs/python/config/appconfig.html#Requiring_Login_or_Administrator_Status](http://code.google.com/appengine/docs/python/config/appconfig.html#Requiring_Login_or_Administrator_Status)

用户必须在某个时候进行身份验证。

# javascript - 使用 jQuery 构建动态表单部件

> ID：856583
> 
> 赞同：1
> 
> 时间：2009-05-13T07:39:45.497
> 
> 标签：javascript, jquery, asp.net-mvc

（希望这不会被重复；第二次尝试提交这个问题）

我正在处理一个表单，我希望用户能够在其中添加未确定数量的联系人（姓名和电话号码）。我只想显示这些表单字段的一行开始，并允许用户单击一个元素，该元素将添加初始行的副本（当然是空的，并且在返回控制器时使用更新的 id 来操作该数据（ASP.NET MVC 应用程序）。

我发现了一些使用 jQuery 库 1.2.x 版本的示例，但我似乎无法让它们中的任何一个与 1.3.2 一起使用。该问题与 $.clone() 方法有关。当我在选择器/元素上调用此方法时，页面会进行完全刷新，并且会向用户呈现一个干净的表单。

我一直在使用的当前示例（来自[http://devblog.jasonhuck.com/assets/infiniteformrows.html](http://devblog.jasonhuck.com/assets/infiniteformrows.html)）看起来像：

桌子 -

```
<table id="tabdata">
            <thead>
                <tr>
                    <th>Row</th>
                    <th>Cell 1</th>
                    <th>Cell 2</th>
                    <th>Cell 3</th>

                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><a id="addnew" href="">Add</a></td>
                    <td><input id="n0_1" name="n0_1" type="text" /></td>
                    <td><input id="n0_2" name="n0_2" type="text" /></td>

                    <td><input id="n0_3" name="n0_3" type="text" /></td>
                    <td></td>
                </tr>
            </tbody>
        </table> 
```

剧本 -

```
<script type="text/javascript">
    $(function() {
        var newRowNum = 0;

        $('#addnew').click(function() {
            newRowNum++;
            var addRow = $(this).parent().parent();
            var newRow = addRow.clone();
            $('input', addRow).val('');
            $('td:first-child', newRow).html(newRowNum);
            $('td:last-child', newRow).html('<a href="" class="remove">Remove<\/a>');
            $('input', newRow).each(function(i) {
                var newID = newRowNum + '_' + i;
                $(this).attr('id', newID).attr('name', newID);
            });
            addRow.before(newRow);

            $('a.remove', newRow).click(function() {
                $(this).parent().parent().remove();
                return false;
            });

            return false;
        });
    });
 </script> 
```

当方法声明“var newRow = addRow.clone();”时，页面重新加载。不知道为什么，但是针对早期的 jQuery 版本运行脚本，它工作得很好。如果我能提供帮助，我宁愿不要退回版本。

有什么想法吗？有没有更好的方法来解决这个问题？它应该很简单，但事实证明它比我希望使用我选择的库更乏味。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T07:59:32.500

[Here is an example](http://jsbin.com/ageme) of your code. It is working fine for me in Firefox 3 and also in IE 7\. The code is using jQuery 1.3.2\. If you want to edit the code, just add `/edit` to the URL.

A couple of ideas -

*   What browser are you viewing the code in that's not working?
*   Do you have any other JavaScript libraries that you are using that may be causing conflicts?

# wpf - WPF 基础知识：如何在 DataTrigger 中设置外部属性？

> ID：856588
> 
> 赞同：1
> 
> 时间：2009-05-13T07:41:07.367
> 
> 标签：wpf, visual-studio-2008, datatrigger

我试图让我的头脑围绕 WPF 模型。

我有一个项目列表框。列表框内的项目是字符串标识符。这工作正常。我想要的是拥有它，以便在封闭控件的代码隐藏中可以访问当前所选项目的标识符。

我有这个：

```
<ListBox.ItemTemplate>
 <DataTemplate>
   <StackPanel Width="320">
    <Label Content="{Binding Path=ShortName}" Style="{StaticResource ListHeader}"/>
      <TextBlock TextWrapping="Wrap" Text="{Binding Path=Description}" Style="{StaticResource ListText}" />
   </StackPanel>
 </DataTemplate>
 </ListBox.ItemTemplate> 
```

我想我应该添加类似的内容：

```
<DataTemplate.Triggers>
    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type ListBoxItem}},Path=IsSelected}" Value="True">
    <Setter Property="" TargetName="">
     <Setter.Value>

     </Setter.Value>
   </Setter>
 </DataTrigger> 
```

但是我不知道如何设置设置器来设置作为封闭控件一部分的属性（即外部世界）。我想我有这个倒退？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T08:04:39.107

If you are trying to access a property on a selected list box item from outside of the listbox then you can do the following in your code behind:

```
CustomItem item = (CustomItem)listBox1.SelectedItem;
MessageBox.Show(item.ShortName); 
```

And your xaml is as follows:

```
<ListBox Height="100" Name="listBox1">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Name="stackPanel1">
                    <Label Content="{Binding Path=Shortname}"/>
                    <TextBlock Text="{Binding Path=Description}"/>
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

You just cast the selecteditem from the listbox to your object type, then access the property on the object.

Hope this is what you were after.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T08:19:17.553

您是否尝试过使用[SelectedValuePath](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectedvaluepath.aspx)属性？

当您在 ItemsSource 属性上有一个说客户的列表并将 SelectedValuePath 设置为 Name 时，您的 SelectedValue 属性将返回客户的名称而不是客户的名称...

在您后面的代码中，SelectedValue 将是名称，SelectedItem 将返回您的客户对象..在我的示例中..

希望这会有所帮助..

祝你好运！

# java - GData Java 客户端无法正常工作，因为 Google 重定向到本地化站点

> ID：856590
> 
> 赞同：1
> 
> 时间：2009-05-13T07:41:45.183
> 
> 标签：java, gdata, google-analytics-api

我正在关注[Google Analytics Data API - Java](http://code.google.com/apis/analytics/docs/gdata/1.0/gdataJava.html)上的文档 并遇到`RedirectRequiredException`异常，因为 Google 正在将我重定向到该站点的本地版本 (www.google.si)。

编码：

```
AnalyticsService as = new AnalyticsService("me-myapp-1.0"); 
as.setUserCredentials(username, password); 
AccountFeed accountFeed = as.getFeed( 
    new URL("https://www.google.com/analytics/accounts/default"), 
    AccountFeed.class); 
```

最后一个方法调用抛出：

```
Exception in thread "main" com.google.gdata.util.RedirectRequiredException: Found 
<HTML><HEAD><meta http-equiv="content-type" content="text/ 
html;charset=utf-8"> 
<TITLE>302 Moved</TITLE></HEAD><BODY> 
<H1>302 Moved</H1> 
The document has moved 
<A HREF="http://www.google.si/">here</A>. 
</BODY></HTML> 
        at com.google.gdata.client.http.GoogleGDataRequest.handleErrorResponse (GoogleGDataRequest.java:541) 
        at com.google.gdata.client.http.HttpGDataRequest.checkResponse (HttpGDataRequest.java:535) 
        at com.google.gdata.client.http.HttpGDataRequest.execute (HttpGDataRequest.java:514) 
        at com.google.gdata.client.http.GoogleGDataRequest.execute (GoogleGDataRequest.java:515) 
        at com.google.gdata.client.Service.getFeed(Service.java:1016) 
        at com.google.gdata.client.Service.getFeed(Service.java:879) 
        at com.google.gdata.client.GoogleService.getFeed(GoogleService.java:638) 
        at com.google.gdata.client.Service.getFeed(Service.java:898) 
        at org.kubje.jaka.gapump.App.main(App.java:42) 
```

有任何想法吗？

我也已将这个问题发布到 Analytics API 的 Google 组，[这里](http://groups.google.com/group/google-analytics-data-export-api/browse_thread/thread/8b4dc0860af1a030#)是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T10:47:46.500

网址不正确。我从示例中复制了它，这是不正确的。

# c# - Vista 上的 PrinterSettings.InstalledPrinters

> ID：856591
> 
> 赞同：0
> 
> 时间：2009-05-13T07:41:45.773
> 
> 标签：c#, wcf, windows-services, printing

我有一个托管在 Windows 服务应用程序上的 WCF 服务，它应该返回托管它的机器上所有已安装的打印机。我使用**System.Drawing.Printing.PrinterSettings.InstalledPrinters**来检索已安装打印机的列表，但我不知道为什么在 Windows Vista 中它不会返回所有打印机。

主机 Windows 服务使用管理员组成员的帐户运行，具有“作为服务登录”权限并添加了具有“requireAdministrator”执行级别的 app.Manifest。

更新：如果我在 Vista 中的 Windows 应用程序上使用 InstalledPrinters 属性，它会返回所有打印机！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-22T15:54:41.680

您应该在本地安装打印机以通过 Windows 服务使用它们。当您启动添加打印机向导时，您可以选择是添加本地打印机还是远程打印机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T21:05:16.973

您是否为运行其他成员未安装的应用程序的用户安装了任何打印机？

这可能是检查的一种途径，因为仅为您运行应用程序的用户设置的任何打印机可能不是为您运行服务的用户设置的。

（当然，如果您以同一用户身份运行两者，这当然是一个有争议的问题）

# asp.net - 在asp.net中运行时加载图像的问题

> ID：856600
> 
> 赞同：0
> 
> 时间：2009-05-13T07:43:54.210
> 
> 标签：asp.net

我有一个图像，我已添加到我的应用程序的 app_data 文件夹中的图像文件夹中。现在的问题是它在设计时显示图像但在运行时它不显示。现在如果页面是回发现在它显示图像。

这有什么问题。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T07:46:27.623

您应该在 html 代码 pre-postback 中验证图像具有有效的 url。您不是仅在回发事件处理程序上设置 url 吗？

发布代码以获得更多帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T08:41:12.743

您不应该将图像放在 App_Data 文件夹中 - 它用于存储无法通过 URL 访问的数据。

将图像移出该文件夹，它应该可以正常工作。

# javascript - xmlHttpRequest 响应

> ID：856601
> 
> 赞同：0
> 
> 时间：2009-05-13T07:44:26.223
> 
> 标签：javascript, xmlhttprequest, response

我遇到了一些令人困惑的问题，我需要帮助我已经编写了一些代码来初始化 xmlHttpRequest 以发送请求并接收一些响应，这是我的代码：

```
function initRequest(url)
  {
    if(window.XMLHttpRequest){
       req=new XMLHttpRequest();
    }
    else if(window.ActiveXObject)
     {
      isIE=true;
      req=new ActiveXObject("Microsoft.XMLHTTP");
     }
   }

function validateUser()
   {           
      var sPath = window.location.pathname;
      var sAddress = sPath.substring(0,sPath.lastIndexOf('/') + 1);
     var url=sAddress+"WebService2.asmx?op=HelloWorld";               
     initRequest(url);
     req.onreadystatechange=processRequest;
     req.open("GET",url,true);
     req.setRequestHeader("Content-Type", "text/xml;charset=UTF-8");
     req.send(null);      
  }

function processRequest()
  {
    if(req.readyState==4){
     if(req.status==200)
       {
        var message="invalid";
        alert(req.responseText);           
        //message=req.responseXML.getElementsByTagName("valid")[0].childNodes[0].nodeValue;
        //SetMessage(message);
       }
       else
       {
       alert(req.statusText);
       }
     }       
  } 
```

我的问题是：我不知道在哪里/如何从我指定的 Url 获取正确的 XML 响应，我在我的 WebService 的 HelloWorld 方法中使用了 Respose 对象，但结果是页面的一些 DOM 架构来调用该方法......

每一条线索都会被欣赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T07:58:53.780

There are 2 possible answers to this question..

1.  A long and detailed discussion about interpreting status codes and parsing results
2.  A suggestion that you look at using an established library to take the pain out of this for you.

I'm going to take the second approach and reccommend that you investigate [jquery](http://jquery.com) as this does all of the donkey work for you - and provides loads of other benefits too. You are then free to develop your application, not spend hours fiddling with issues that have already been solved by others.

P.S. I acknowledge the existence of other javascript libraries, sucah as 'prototype', but have found jquery to meet all of my needs, as well as being included with the ASP.NET MVC framework, which makes it a no-brainer.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T07:59:17.260

If you don't want DOM but rather XML response as a string, use responseText instead of responseXML.

Also, consider using prototype or jquery instead of writing that by hand.

If the response is different from that you've expected, maybe you're misusimg that server's api. I'd recommend reading documentation on it or tcpdumping the data exchange.

You didn't specify which server are you trying to connect to, so we can't help you on its api.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T08:35:18.450

这是一个使用 XMLHttpRequest 的教程：

[Ajax 教程](http://www.xul.fr/en-xml-ajax.html#ajax-in-depth)

另外，您知道，在英语中，通常唯一应该以大写字母开头的单词是句子中的第一个单词、专有名词（例如名称）和人称代词“I”。

# html - 在此测试用例中禁用边框折叠

> ID：856602
> 
> 赞同：0
> 
> 时间：2009-05-13T07:45:07.780
> 
> 标签：html, css

如果您检查以下演示 HTML，您会看到所有浏览器的页面顶部都有一个意外的橙色边框（我检查过）。如果 <p> 标记被 <div> 标记替换，则一切正常。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Test Lay-Out</title>         
        <style>
            html{
                overflow: auto; /*for IE*/
                height: 100%;
            }

            body{
                background-color: orange;
                margin: 0;
                height: 100%;
            }
            #page{
                background-color: green;

                height: 100%;
                margin-bottom: -50px;
            }
            #footer{
                background-color: red;
                height: 50px;
            }
        </style>
    </head>
    <body>
        <div id="page">
            <p>test</p>
        </div>
        <div id="footer">footer</div>
    </body>
</html> 
```

这是因为 <p> 有一个上边距，并且通过边框折叠会折叠到父元素。虽然这是创建文本段落等所需的效果，但它很少用于布局。
如何确保边框不会提升到某些元素（在本例中是从 <p; 到父 div）？

**--更新--**
因为答案似乎都在“禁用段落上的填充”这条路上，所以我稍微修改了我的问题并改变了标题。
从 p 中删除填充是消除 simptom 的一种方法，而不是原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T21:25:33.603

the padding for body/html needs to be reset as well.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T07:59:16.433

All browsers load a default stylesheet before any styles you define.

This is the style you see when you load a "plain" HTML into your browser.

You should look into and use a [CSS reset](http://www.google.co.uk/search?hl=en&q=css+reset&meta=) in pretty much all your projects.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T07:55:44.487

默认情况下，该`<p>`元素有一个`margin-top`，它将整个内容向下推。您可以使用它来摆脱`margin-top: 0`它`<p>`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T07:56:57.373

It is because `<p>` is block element and always starts in new line. if you want your code to work with the `<p>` tag then add to you CSS

```
p
{
    display:inline;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T07:58:41.567

This is kinda lame, but I actually found it myself.
Once again it's the collapsing borders tricking me. [Here](http://www.webmasterworld.com/css/3530816.htm) is a good forum post that describes it. In my design it was appropriate to remove the margin from the <p> element. From what I read the next best thing is giving the parent a tiny margin of it's own.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T07:59:46.650

add this to your styles:

```
#page p{ margin-top: 0; } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T08:12:53.023

Yep there will be a gap at the top, because paragraph leaves some space before and after. The following removes the space try it:

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
        <head>
                <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
                <title>Test Lay-Out</title>                     
                <style>
                        html{
                                overflow: auto; /*for IE*/
                                height: 100%;
                        }

                        body{
                                background-color: orange;
                                margin: 0;
                                height: 100%;
                        }
                        #page{
                                background-color: green;
                                height: 100%;
                                margin-bottom: -50px;
                        }
                        #page p.first{
                                margin-top:0;
                        }
                        #footer{
                                background-color: red;
                                height: 50px;
                        }
                </style>
        </head>
        <body>
                <div id="page">
                 <p class="first">test</p>
                </div>
                <div id="footer">footer</div>
        </body>
</html> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T08:15:39.400

添加`overflow: hidden;`到父元素怎么样？

# xml - 对网站使用 XML 和 XSLT 是个好主意吗？

> ID：856604
> 
> 赞同：5
> 
> 时间：2009-05-13T07:45:26.703
> 
> 标签：xml, xslt

我想知道当使用 XML 文档作为网页内容和 XSLT 管理显示部分而不使用纯 HTML 时，它是否会带来优点或缺点。

在我看来，第一个条件是浏览器支持 XML 和 XSLT。但据我所知，现代浏览器没有任何问题。（如我错了请纠正我。）

但是在搜索引擎的排名中是否有好处（语义网等）或损失（HTML标签更常见）？

或者您是否看到应该或不应该将 XML 和 XSLT 组合用于网页的其他原因？

### 有关的：

> [为什么选择 XSL 转换？](https://stackoverflow.com/questions/803007/why-choose-an-xsl-transformation)
> 
> [使用 XSLT 创建网站是否有意义](https://stackoverflow.com/questions/560635/is-there-a-point-creating-a-site-using-xslt)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T08:01:13.777

Personally I wouldn't use **clientside** xslt very often; there are issues with browser support, and the fact that you may have data in the xml that you need to strip out (i.e. that the client doesn't need to know, or shouldn't know).

But serverside... back a few years, I used to routinely use this approach as an MVC implementation from VB6 - i.e. the VB6 code (the controller) gathers data as xml (the model), and uses xslt to shape the html (the view). It worked well in terms of separation of concerns. These days I would use ASP.NET MVC to do the same, but with ascx/aspx view templates.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-21T03:42:34.833

这是一个非常重要的话题。10 年前，人们开始问这个问题......我们可以向浏览器发送数据包并让浏览器呈现内容吗？设计目标如此重要的原因是为了解决我们今天面临的问题......不完全支持桌面浏览模式的多种设备和平板电脑。XHTML 已经把我们带到了这么远......现在人们正在尝试创建 ECMAScripting 来做这样的事情。但从长远来看，这是一个非常糟糕的模型。它打破了网络上标记和内容的再利用目标。

答案是肯定的……您可以构建 XSL/XSLT/XML 类型系统。您可以发送一个 XML 数据包，并带有指向其 XSLT 样式表的链接，并且大多数（如果不是全部）现代浏览器将文件解析为客户端上的标记。我已经做到了，它的工作速度令人难以置信。

现在，该小组提到的缺点是真实的。浏览器如何解析 XSLT，然后渲染脚本元素和缓存陈旧的 XML 等存在问题。与设计团队的接口以及学习将内容、设计和结构抽象为这些类型的部分存在真正的问题。但这是 Web 长期的真正目标，也是 XSL 设计成这样的原因。它的力量在于分离结构、数据和设计，并将服务器和客户端从锁定在设计元素中的内容奴役中解放出来。Javascripted 解决方案，编译并分层到 UI 中，并没有帮助反而使情况变得更糟，因为标记设计和数据通常是网格在一起的。我会鼓励所有新的 Web 开发人员开始考虑 XSLT/XML 解决方案，因为最终目标是能够专注于将 XML 数据交付给桌面浏览器之外的大量客户端。如果您拥有为大量不同设备设计的 XSLT/CSS，并且除了缓存之外发送给客户端的所有内容都是 XML，那么您将拥有一个非常简单、快速且功能强大的再利用数据交付系统，它超越了当前桌面应用程序/基于桌面浏览器的网站现在为我们提供了一个真正可扩展且功能强大的 Web 数据交付时代。所以，我说是的，试试 XSLT！和强大的再利用数据交付系统，超越了当前桌面应用程序/基于桌面浏览器的网站现在为我们提供的功能，并为 Web 迎来了一个真正可扩展且强大的数据交付时代。所以，我说是的，试试 XSLT！和强大的再利用数据交付系统，超越了当前桌面应用程序/基于桌面浏览器的网站现在为我们提供的功能，并为 Web 迎来了一个真正可扩展且强大的数据交付时代。所以，我说是的，试试 XSLT！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-11-19T05:40:20.470

这是一个基于 xsl 的网站的示例。

[http://www.skechers.com](http://www.skechers.com)。

说够了

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T08:01:59.703

You should do the transformation on the server side and not rely on the browser support.

We use it to support multiple languages on our website. Disadvantage is that sometimes our designers have a steep learning curve with designing their pages using XSL/XSLT/XPATH.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T12:40:38.190

（因为我还不能发表评论，所以这是对“圣格比尔”的回复）

实际上，您可以在 XSL 中使用 ASP.NET 控件，这非常简单，将命名空间 asp 添加到 XSL，转换为字符串编写器，然后解析转换后的字符串中的控件：

```
// Transform
xsltrans.Transform(xmldoc, xslArg, oSW);

// Get transformed content
string sPage = oSW.ToString();

// Add to page
Page.Controls.Clear();
Page.Controls.Add(Page.ParseControl(sPage)); 
```

这将解析转换后的内容中的任何 ASP.NET 控件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T09:03:07.450

我有时会使用 XML，因为当网站没有 MySQL DB 或仅用于记录一小部分项目（需要进行大量更改）时，然后使用 PHP 在我的网页中使用 HTML/CSS 对其进行解析。

但是，这确实需要您手动编辑每个 xml 条目，因此只需将其用于小型应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T08:05:05.970

If you compare it to the power of server side code, XSLT falls short on several parameters.

If your page is entirely dynamic, it would still be worthwhile to create it in the server side code. If your data source is XML, your could still use server-side XML parsing and transformation to create the transformed XHTML and serve it to the client.

It is rarely necessary to exclusively transform HTML on the client completely relying on the capabilities of the browser. Most modern browsers have a good XML/XSLT support, but their main difference lies in the type of XSLT processor used.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T12:46:44.530

我不得不在我的主页上使用客户端 XSL(T) 来防止 freehoster 自动插入广告 ;-) （IE 和 Firefox 有这个问题！）

我会在服务器端使用 XML，但只传输纯 XHTML+CSS 之外的任何东西。对于互联网来说，一切都建立在一种技术中，而不是成千上万的个人语言和语义中，这一点至关重要。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T07:49:21.083

XHTML 是 HTML 的 XML 版本。我可能会避免将 XSLT 用于网站。我会使用 XHTML 和 CSS 来控制演示。我这样说是因为 (X)HTML/CSS 几乎是 Web 应用程序的事实标准，而且还有更多的工具可用于开发和调试。

如果您想利用 XHTML 中的一些非理想 HTML 内容，则 XHTML 有不同级别的验证。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-13T07:56:19.073

它是一种很好的做事方式，但不幸的是很多服务器端技术不支持这个想法。

例如，在 ASP.NET 中，您不能通过这种方法使用服务器控件，这通常足以让人们失望。

XSLT 非常适合没有像报告这样的交互的页面。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-03-16T13:37:44.347

我从未听说过其他人这样做，但我使用 XSLT 作为一种宏语言，用于基于 XML 的 html 模板语言。我不将它用于从一个文档到另一个文档的大规模转换，而是用于本质上的自定义标签。模板在编译之前通过 xslt 运行，因此它不需要实际操作数据。然而，它提供的是一种尽可能简洁地使用一段 xml 的方法，然后执行一个非常简单的转换以输出代码，这种方式在模板语言本身中是不可能的，或者至少更难做到。

使用 html，通常需要嵌套 div，并添加类等，只是为了让它看起来正确而没有添加任何实际意义。无需到处重复该模式，只需创建一个自定义元素，然后编写一个简单的 XSLT 转换来获取该元素及其属性并将其转换为完全扩展的 html，这很容易。但是，我永远不会梦想使用 XSLT 作为模板化数据的唯一方法。就是太毛了。

# c++ - xcode 在 cpp 代码上给出语法错误

> ID：856617
> 
> 赞同：0
> 
> 时间：2009-05-13T07:47:55.327
> 
> 标签：c++, iphone, xcode

我正在尝试在我自己的 iPhone 应用程序中重用 Apple 的 Speak Here[示例代码。](http://developer.apple.com/iphone/library/samplecode/SpeakHere/index.html#//apple_ref/doc/uid/DTS40007802)我下载并编译了项目没有任何问题，因此我将一些文件添加到我自己的应用程序中。当我尝试编译自己的应用程序时，编译器给了我

MeterTable.h:54：错误：“MeterTable”之前的语法错误

相关代码为：

```
#include <stdlib.h>
#include <stdio.h>
#include <math.h>

class MeterTable  // line 54
{
public: 
```

它看起来有点像 xcode 没有将 MeterTable.h 和 MeterTable.mm 识别为 C++ 文件。不过，我已经检查了 MeterTable.mm 的 File>>GetInfo，它将文件类型列为 sourcecode.cpp.cpp。

为什么编译不出来？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:24:46.620

执行以下操作，然后尝试：

1.  转到构建设置并搜索“将源编译为”
2.  选择“根据文件类型”
3.  如果您在任何 Objective C 类中包含 CPP 文件，那么它的实现类应该是 .mm，只需将其扩展名从.m 更改为 .mm。
4.  请记住，即使您分层使用 CPP 代码，您也需要将扩展​​名更改为 .mm。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T11:47:00.833

1.  您在 MasterTable.mm 以外的非 C++ 文件中包含“MeterTable.h”。
2.  错误不在“MeterTable.h”中，而是在它之前包含的标题中。请注意，`<stdlib.h>`如果之前包含 ... 可以是 noop。

如果您想确保您的文件是使用 C++ 编译的，可以将此代码添加到 MasterTable.mm 的开头：

```
#ifdef __cplusplus
#error "compiled as C++"
#else
#error "compiled as C"
#endif 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T08:08:45.870

尝试将`#include`指令与`extern "C" { }`

# c# - 如何在 C# 中编写事件和事件处理程序？

> ID：856632
> 
> 赞同：6
> 
> 时间：2009-05-13T07:51:11.873
> 
> 标签：c#, .net, events

一段时间以来，我一直在尝试一种很好的方法来记住如何在 C# 中编写事件和事件处理程序。每当我想参考 Internet 上的教程时，它们往往很冗长。

问题是如何在 C# 中编写事件和事件处理程序？您是否有一个代码示例可以轻松说明如何编写这样的代码？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-13T07:53:20.403

它们不必很冗长：

```
// declare an event:
public event EventHandler MyEvent;

// raise an event:
var handler = MyEvent;
if(handler != null) handler(this, EventArgs.Empty);

// consume an event with an anon-method:
obj.MyEvent += delegate { Console.WriteLine("something happened"); };

// consume an event with a named method:
obj.MyEvent += SomeHandler;

void SomeHandler(object sender, EventArgs args) {
    Console.WriteLine("something happened");
} 
```

麻烦的是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-15T15:52:58.307

一旦你有胃口，试试这个：

对于 VS2005：如何：发布符合 .NET Framework 指南（C# 编程指南）的事件 [http://msdn.microsoft.com/en-us/library/w369ty8x(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/w369ty8x(v=vs.80).aspx)

对于 Visual Studio 11： http: [//msdn.microsoft.com/en-us/library/w369ty8x (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/w369ty8x(v=vs.110).aspx)

# c - extern 关键字对 C 函数的影响

> ID：856636
> 
> 赞同：206
> 
> 时间：2009-05-13T07:51:53.073
> 
> 标签：c, syntax, standards

在 C 语言中，我没有注意到`extern`函数声明之前使用的关键字的任何影响。起初，我认为`extern int f();`在单个文件中定义时会**强制**您在文件范围之外实现它。但是我发现两者：

```
extern int f();
int f() {return 0;} 
```

和

```
extern int f() {return 0;} 
```

编译得很好，没有来自 gcc 的警告。我用过`gcc -Wall -ansi`；它甚至不接受`//`评论。

`extern` **在函数定义之前**使用有什么影响吗？或者它只是一个可选关键字，对函数没有副作用。

在后一种情况下，我不明白为什么标准设计者选择在语法中添加多余的关键字。

**编辑：**澄清一下，我知道 in variables 的用法`extern`，但我只是询问`extern`in **functions**。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2009-05-13T08:19:37.537

我们有两个文件，foo.c 和 bar.c。

这是 foo.c

```
#include <stdio.h>

volatile unsigned int stop_now = 0;
extern void bar_function(void);

int main(void)
{
  while (1) {
     bar_function();
     stop_now = 1;
  }
  return 0;
} 
```

现在，这里是 bar.c

```
#include <stdio.h>

extern volatile unsigned int stop_now;

void bar_function(void)
{
   if (! stop_now) {
      printf("Hello, world!\n");
      sleep(30);
   }
} 
```

如您所见，我们在 foo.c 和 bar.c 之间没有共享标头，但是 bar.c 在链接时需要在 foo.c 中声明的内容，而 foo.c 在链接时需要来自 bar.c 的函数。

***通过使用'extern'，您告诉编译器在链接时将找到（非静态）后面的任何内容；在当前通行证中不要为它保留任何东西，因为它稍后会遇到。在这方面，函数和变量被同等对待。***

如果您需要在模块之间共享一些全局并且不想将其放在/初始化它在标头中，这将非常有用。

从技术上讲，库公共头文件中的每个函数都是“extern”，但是将它们标记为这样几乎没有好处，具体取决于编译器。大多数编译器可以自己解决这个问题。如您所见，这些函数实际上是在其他地方定义的。

在上面的例子中，main() 只会打印一次 hello world，但会继续输入 bar_function()。另请注意， bar_function() 在此示例中不会返回（因为它只是一个简单的示例）。想象一下 stop_now 在服务信号时被修改（因此，不稳定），如果这看起来不够实用的话。

外部对象对于信号处理程序、您不想放入标头或结构中的互斥锁等非常有用。大多数编译器会优化以确保它们不会为外部对象保留任何内存，因为它们知道它们'将在定义对象的模块中保留它。然而，在对公共函数进行原型设计时，用现代编译器指定它并没有什么意义。

希望有帮助:)

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2009-05-13T08:03:01.293

据我记得标准，默认情况下，所有函数声明都被视为“外部”，因此无需显式指定。

这不会使这个关键字无用，因为它也可以与变量一起使用（在这种情况下 - 它是解决链接问题的唯一解决方案）。但是有了这些功能 - 是的，它是可选的。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-05-13T16:33:48.057

您需要区分两个独立的概念：函数定义和符号声明。"extern" 是一个链接修饰符，向编译器提示后面引用的符号的定义位置（提示是“不在此处”）。

如果我写

```
extern int i; 
```

在 C 文件的文件范围内（在功能块之外），那么您说的是“变量可能在其他地方定义”。

```
extern int f() {return 0;} 
```

既是函数 f 的声明，又是函数 f 的定义。在这种情况下，定义覆盖了外部。

```
extern int f();
int f() {return 0;} 
```

首先是声明，然后是定义。

`extern`如果要声明并同时定义文件范围变量，则使用 of是错误的。例如，

```
extern int i = 4; 
```

将给出错误或警告，具体取决于编译器。

如果您明确希望避免定义变量，则使用 of`extern`很有用。

让我解释：

假设文件 ac 包含：

```
#include "a.h"

int i = 2;

int f() { i++; return i;} 
```

文件 ah 包括：

```
extern int i;
int f(void); 
```

并且文件 bc 包含：

```
#include <stdio.h>
#include "a.h"

int main(void){
    printf("%d\n", f());
    return 0;
} 
```

头文件中的 extern 很有用，因为它在链接阶段告诉编译器，“这是一个声明，而不是一个定义”。如果我删除 ac 中定义 i 的行，为其分配空间并为其分配值，则程序应该无法使用未定义的引用进行编译。这告诉开发人员他已经引用了一个变量，但还没有定义它。另一方面，如果我省略“extern”关键字并删除该`int i = 2`行，程序仍然可以编译 - i 将被定义为默认值 0。

文件范围变量隐式定义为默认值 0 或 NULL 如果您没有显式地为它们分配值 - 与您在函数顶部声明的块范围变量不同。extern 关键字避免了这种隐式定义，从而有助于避免错误。

对于函数，在函数声明中，关键字确实是多余的。函数声明没有隐式定义。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-05-13T08:56:07.400

`extern`关键字根据环境采用不同的形式。如果声明可用，则`extern`关键字采用前面在翻译单元中指定的链接。在没有任何此类声明的情况下，`extern`指定外部链接。

```
static int g();
extern int g(); /* g has internal linkage */

extern int j(); /* j has tentative external linkage */

extern int h();
static int h(); /* error */ 
```

以下是 C99 草案 (n1256) 中的相关段落：

> **6.2.2 标识符的链接**
> 
> [...]
> 
> **4**对于使用存储类说明符 extern 声明的标识符，在该标识符的先前声明可见的范围内，23) 如果先前的声明指定内部或外部链接，则后面声明的标识符的链接是相同的作为先前声明中指定的链接。如果前面的声明不可见，或者前面的声明没有指定链接，则标识符具有外部链接。
> 
> **5**如果函数标识符的声明没有存储类说明符，则它的链接将完全确定，就好像它是使用存储类说明符 extern 声明的一样。如果对象标识符的声明具有文件范围且没有存储类说明符，则其链接是外部的。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-05-13T16:44:19.103

内联函数对含义有[特殊的规则](http://www.greenend.org.uk/rjk/2003/03/inline.html)`extern`。（请注意，内联函数是 C99 或 GNU 扩展；它们不在原始 C 中。

对于非内联函数，`extern`不需要，因为默认情况下它是打开的。

请注意，C++ 的规则是不同的。例如，`extern "C"`在您将从 C++ 调用的 C 函数的 C++ 声明中需要 ，并且关于`inline`.

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-05-18T20:25:35.677

> IOW, extern 是多余的，什么都不做。

这就是为什么，10年后：

*   像[Coccinelle](http://coccinelle.lip6.fr/)这样的代码转换工具会倾向于[在函数声明中](http://coccinelle.lip6.fr/docs/main_grammar007.html)[标记`extern`](http://coccinelle.lip6.fr/docs/main_grammar007.html)删除；
*   类似的代码库[`git/git`](https://github.com/git/git)遵循该结论并`extern`从其代码中删除（对于 Git 2.22，2019 年第二季度）。

请参阅[Denton Liu ( ) 的](https://github.com/Denton-L)[提交 ad6dad0](https://github.com/git/git/commit/ad6dad0996f9226b2c3a5a3c725bf2952e52d7e7)、[提交 b199d71](https://github.com/git/git/commit/b199d7147a218c3b10b077f9caad0f207bc34d7a)、[提交 5545442](https://github.com/git/git/commit/554544276a604c144df45efcb060c80aa322088c)（2019 年 4 月 29 日[）](https://github.com/Denton-L)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([4aeeef3 提交中](https://github.com/git/git/commit/4aeeef377347934d6f459e27f7d793de4ce384bb))^(，2019 年 5 月 13 日）)[`Denton-L`](https://github.com/Denton-L)
^([`gitster`](https://github.com/gitster))

> ## `*.[ch]`:`extern`从函数声明中删除使用[`spatch`](http://coccinelle.lip6.fr/sp.php)
> 
> 一直在推动`extern`从函数声明中删除。
> 
> 删除一些`extern`被 Coccinelle 捕获的函数声明的“”实例。
> 请注意，Coccinelle 在处理带有`__attribute__`或可变参数的函数时存在一些困难，因此一些`extern`声明被留下以在未来的补丁中处理。
> 
> 这是使用的 Coccinelle 补丁：
> 
> ```
>  @@
>     type T;
>     identifier f;
>     @@
>     - extern
>     T f(...); 
> ```
> 
> 它的运行方式是：
> 
> ```
>  $ git ls-files \*.{c,h} |
>     grep -v ^compat/ |
>     xargs spatch --sp-file contrib/coccinelle/noextern.cocci --in-place 
> ```

* * *

但这并不总是那么简单：

请参阅[Denton Liu ( ) 的](https://github.com/Denton-L)[提交 7027f50](https://github.com/git/git/commit/7027f508c767f57d9e8d5edeacf99d13950f6b69)（2019 年 9 月 4 日[）](https://github.com/Denton-L)。^(（由)^([Denton Liu 合并 --](https://github.com/Denton-L)) ^([--](https://github.com/Denton-L))^在^([commit 7027f50](https://github.com/git/git/commit/7027f508c767f57d9e8d5edeacf99d13950f6b69))^(中，2019 年 9 月 5 日）)[`Denton-L`](https://github.com/Denton-L)
^([`Denton-L`](https://github.com/Denton-L))

> ## `compat/*.[ch]`:`extern`使用 spatch 从函数声明中删除
> 
> 在 5545442 ( `*.[ch]`: remove `extern`from function declarations using spatch, 2019-04-29, Git v2.22.0-rc0) 中，我们从函数声明中删除了 externs，`spatch`但我们故意排除了文件，`compat/`因为有些文件是直接从上游复制的，我们应该避免搅动它们，以便手动合并未来的更新会更简单。
> 
> 在最后一次提交中，我们确定了从上游获取的文件，因此我们可以排除它们并`spatch`在其余部分上运行。
> 
> 这是使用的 Coccinelle 补丁：
> 
> ```
> @@
> type T;
> identifier f;
> @@
> - extern
>   T f(...); 
> ```
> 
> 它的运行方式是：
> 
> ```
> $ git ls-files compat/\*\*.{c,h} |
>     xargs spatch --sp-file contrib/coccinelle/noextern.cocci --in-place
> $ git checkout -- \
>     compat/regex/ \
>     compat/inet_ntop.c \
>     compat/inet_pton.c \
>     compat/nedmalloc/ \
>     compat/obstack.{c,h} \
>     compat/poll/ 
> ```
> 
> Coccinelle 在处理`__attribute__`varargs 时遇到了一些麻烦，因此我们运行了以下命令以确保没有留下任何剩余的更改：
> 
> ```
> $ git ls-files compat/\*\*.{c,h} |
>     xargs sed -i'' -e 's/^\(\s*\)extern \([^(]*([^*]\)/\1\2/'
> $ git checkout -- \
>     compat/regex/ \
>     compat/inet_ntop.c \
>     compat/inet_pton.c \
>     compat/nedmalloc/ \
>     compat/obstack.{c,h} \
>     compat/poll/ 
> ```

* * *

请注意，使用 Git 2.24（2019 年第四季度），任何虚假`extern`都会被丢弃。

请参阅[Emily Shaffer ( ) 的](https://github.com/nasamuffin)[提交 65904b8](https://github.com/git/git/commit/65904b8b2b27c71a96d8a9c37c19bcc8f2d1380c)（2019 年 9 月 30 日[）](https://github.com/nasamuffin)。 帮助者：[Jeff King (](https://github.com/peff) [)](https://github.com/peff)。 请参阅[Denton Liu ( ) 的](https://github.com/Denton-L)[commit 8464f94](https://github.com/git/git/commit/8464f94aeb2a5eb1ba834460b695b171b95e3fc0)（2019 年 9 月 21 日[）](https://github.com/Denton-L)。 帮助者：[Jeff King (](https://github.com/peff) [)](https://github.com/peff)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 59b19bc](https://github.com/git/git/commit/59b19bcd9ff8193c3197fb9e2f18ce85e4f86335))^(中，2019 年 10 月 7 日）)[`nasamuffin`](https://github.com/nasamuffin)
[`peff`](https://github.com/peff)
[`Denton-L`](https://github.com/Denton-L)
[`peff`](https://github.com/peff)
^([`gitster`](https://github.com/gitster))

> ## `promisor-remote.h``extern`:从函数声明中删除
> 
> 在创建此文件期间，每次引入新的函数声明时，它都包含一个`extern`.
> 但是，从[5545442](https://github.com/git/git/commit/554544276a604c144df45efcb060c80aa322088c)（`*.[ch]`：`extern`从函数声明中删除使用`spatch`，2019-04-29，Git v2.22.0-rc0）开始，我们一直在积极尝试防止在函数声明中使用外部变量，因为它们是不必要的。
> 
> 删除这些虚假`extern`的 s。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-13T08:02:41.730

关键字通知编译器该`extern`函数或变量具有外部链接 - 换句话说，它在定义它的文件之外的文件中可见。`static`从这个意义上说，它与关键字具有相反的含义。在定义时放置`extern`有点奇怪，因为没有其他文件可以看到定义（或者它会导致多个定义）。通常，您`extern`在具有外部可见性的某个点（例如头文件）放入声明并将定义放在其他地方。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-07-15T06:40:47.087

声明一个函数 extern 意味着它的定义将在链接时解析，而不是在编译期间解析。

与未声明为 extern 的常规函数​​不同，它可以在任何源文件中定义（但不能在多个源文件中，否则您将收到链接器错误，说明您已经给出了函数的多个定义），包括它被声明为 extern。所以，在你的情况下，链接器在同一个文件中解析函数定义。

我不认为这样做会有多大用处，但是做这样的实验可以更好地了解语言的编译器和链接器是如何工作的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-15T01:16:57.747

它没有效果的原因是因为在链接时链接器试图解析外部定义（在你的情况下`extern int f()`）。不管是在同一个文件中找到还是在不同文件中找到，只要找到就行。

希望这能回答你的问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-03-22T03:50:27.540

在 C 中，函数被隐式定义为`extern`，而不管关键字是否实际声明。

所以，代码：

```
 int f() {return 0;} 
```

编译器将视为

```
 extern int f() {return 0;} 
```

本质上，典型的函数定义与关键字前面的函数定义之间没有语义差异`extern`，如本例所示。[您可以在https://www.geeksforgeeks.org/understanding-extern-keyword-in-c/](https://www.geeksforgeeks.org/understanding-extern-keyword-in-c/)阅读更深入的解释

# asp.net - 为什么调试器不会在我的 ASP.NET 应用程序的断点处停止？

> ID：856643
> 
> 赞同：46
> 
> 时间：2009-05-13T07:54:18.593
> 
> 标签：asp.net, debugging

我正在尝试调试大型 ASP.NET 应用程序。

我在 Default.aspx.cs 的 Page_Load 的第一行设置了一个断点。

当我启动应用程序时，我的**断点会短暂地变成一个带有感叹号的红色圆形轮廓**，然后又变回常规断点，然后**应用程序启动而不会在我的断点处停止**。

MSDN 告诉我这个符号表示“断点位置尚未加载”。那么如何获取要加载的断点位置呢？几周前它还在工作。什么样的事情会导致断点“未加载”？

**我该怎么做才能让调试器再次在我的断点处停止？**

# 附录：

按 F5 仍然无法进行调试，但我可以启动网站，然后执行调试/附加过程以进入调试模式。如果有人知道为什么这会起作用，但是当我按 F5 时它不起作用（调试按钮甚至不会出现在 F5 上），任何想法都会受到欢迎。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-13T07:56:58.777

尝试对应用程序进行完全重建。请注意它在“调试”配置中。

据我了解（但我不是这些方面的专家），当调试信息文件（.PDB）与实际编译的东西不同步时，可能会发生这种情况。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-08-28T11:33:11.327

人们....我找到了断点的其他解决方案不要停止。在 Visual Studio 2010 的附加到进程窗口中并使用 Framework 3.5，默认情况下会自动确定要调试的代码类型（v2.0、v1.1、v1.0）和（v4.0）。

Visual Studio 有时会感到困惑并自动将 2.0 托管代码确定为 4.0 托管代码。

在这种情况下，您需要单击“附加到”字段上的“选择...”按钮并选择管理（v2.0、v1.1、v1.0）。

问候

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-11-30T16:56:46.623

IE8 的 VS 调试问题

由于这是我在博客上的第一篇文章，所以我决定写一篇在 ASP.NET 官方论坛上经常打开的问题，即 VS 调试器在 IE8 上崩溃。

我已经回答了 4 次相同的问题，所以如果有人遇到同样的问题，我希望这篇文章对他很有帮助。

VS 调试器怎么会在 IE8 上崩溃？

如果您打开了多个 IE8 实例并尝试调试您的项目，您通常会遇到 VS 调试器停止并忽略您的断点的问题！

那是为什么？

IE 8 有一个称为松耦合 Internet Explorer (LCIE) 的功能，它导致 IE 跨多个进程运行。 [http://www.microsoft.com/windows/internet-explorer/beta/readiness/developers-existing.aspx#lcie](http://www.microsoft.com/windows/internet-explorer/beta/readiness/developers-existing.aspx#lcie)

旧版本的 Visual Studio 调试器对此感到困惑，无法弄清楚如何附加到正确的进程。

要解决此问题，您需要按照以下步骤禁用 LCIE 的进程增长功能：

1) 打开 RegEdit 2) 浏览到 HKEY_LOCALMACHINE -> SOFTWARE -> Microsoft -> Internet Explorer -> Main 3) 在此键下添加一个名为 TabProcGrowth 的 dword 4) 将 TabProcGrowth 设置为 0

如果您在 Vista 或更新版本上遇到同样的问题，您还需要关闭保护模式。

然后继续并开始调试您的代码:)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-13T08:02:16.240

您还可以尝试以下方法：

1.  关闭解决方案和视觉工作室。
2.  运行 iisreset /stop
3.  删除 C:\windows\microsoft.net\framework\v2.0.50727\Temporary ASP.NET Files 下的所有内容。如果您在删除其中一些文件时遇到问题，您可能有一个 Visual Studio 版本，或者它的调试器仍在运行。
4.  运行 iisreset /start
5.  在VS中打开解决方案
6.  将构建设置为调试
7.  在解决方案级别运行 Rebuild all
8.  按 F5

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-12-18T05:51:20.580

如果您使用的是 Visual Studio 2005 和 IE8，我可能会有一个解释：IE8 引入了一个称为松散耦合 IE (LCIE) 的新功能，它在调试 VS2005 ASP.NET 应用程序时会导致已知问题。有关更多详细信息和一些解决方案，请参阅 SO 上的此[线程。](https://stackoverflow.com/questions/663144/why-cant-i-debug-from-visual-studio-2005-after-installing-ie8)

当我在我的 ASP.NET 项目中开始调试运行之前关闭所有正在运行的 IE8 实例时，我的所有调试问题都消失了。

我在这里发帖的另一个原因是[分享一个我发现的博客](http://it.toolbox.com/blogs/programming-life/debugging-net-applications-stopping-the-breakpoint-will-not-currently-be-hit-message-26262)，其中列出了“断点不起作用”问题的大量潜在解决方案。这很好，因为博客在一个地方列出了我在互联网上发现的大多数解决方案。无论如何，该博客的作者是 George P. Alexander；我将在这里复制并粘贴多汁的部分，以防文章出现问题：

> 1.  使用精确制导导弹：删除 obj 和 bin 文件夹中的 .pdb 文件。重新编译。跑。
>     
>     
> 2.  地毯炸弹所有 .dll：删除并重新加载所有引用的 .dll（就像您的课程项目一样）
>     
>     
> 3.  释放 WMD：如果 #1 和 #2 不起作用，请删除 obj 和 bin 文件夹本身的内容，以便消灭所有 .pdbs 和 .dlls。重新加载所需的 .dll 并试一试。
>     
>     
> 4.  VS.Net 魔术：关闭 VS.Net 并重新启动。重建。跑。是的，它有时确实有效。
>     
>     
> 5.  Windows 魔法：关闭计算机并重新启动。重建。跑。
>     
>     
> 6.  执行模式：确保 VS.Net 执行模式设置为“调试”而不是“发布”
>     
>     
> 7.  Web.config 设置：确保 web.config 文件中的 XML 元素“编译”标记具有 debug = “true”的属性。只有启用此功能，Web 应用程序和服务才会使用 .dll 生成其 .pdb 文件
>     
>     
> 8.  项目属性 #1：确保项目属性 --> 调试 --> 启用“ASP.Net 调试为真”或“启用 Visual Studio 托管进程”（取决于您使用的 VS.Net 版本）。
>     
>     
> 9.  项目属性#2：确保项目属性-->配置属性-->构建-->“生成调试信息”设置为“真”。
>     
>     
> 10.  附加了错误的进程：您的调试会话可能未附加到正确的进程。您可能必须介入以手动附加该过程。这可以通过 Web 服务实现。附加进程的选项位于调试菜单中。
>     
>     
> 11.  脚本和非托管代码调试：无法调试脚本或非托管代码？确保项目属性 --> 调试 --> “启用 ASP 调试”或“启用非托管调试”（取决于您的 VS.Net 版本）设置为 true。
>     
>     
> 12.  @Page 指令 #1：确保 .aspx 文档的 @Page 指令中的 AutoEventWireup 属性设置为“true”。
>     
>     
> 13.  @Page 指令 #2：确保 .aspx 文档的 @Page 指令中的 Debug 属性设置为“true”。如果没有找到属性，没关系。默认情况下为真。
>     
>     
> 14.  流氓 .DLL：确保您没有运行 .dll 的另一个实例，该实例位于您预期的项目路径的其他位置。
>     
>     
> 
> 14.1 Rogue .dlls sleeper cell #1：您是否在 GAC 文件夹中安装了项目 .dll？您可能正在运行 GAC 文件夹中托管的 .dll，而不是 bin 文件夹中的那个。从 GAC 中删除/卸载 .dll，然后重试。
> 
> 14.2 流氓 .DLLs 休眠单元 #2：
> 
> C:\Documents and Settings[用户名]\VSWebCache[机器名]：
> 
> 在与您的项目相关的文件夹上释放 WMD (#3)。
> 
> 14.3 Rogue DLLs sleeper cell #3：来自您项目的.dll，它们位于其他位置，但在您的项目中被引用。您可以通过检查项目属性找到这些。简而言之，VS.Net 指的是其他一些 .dll，而不是在您的开发环境中加载的那个。
> 
> 14.4 Rogue .DLLs sleeper cell #4：希望您在完成上述要点时不必使用此文件夹...
> 
> 介绍 C:\WINDOWS\Microsoft.NET\Framework[.Net 版本]\Temporary ASP.NET Files\
> 
> 此文件夹可能包含存储在 Windows 文件夹中的旧版本的 .dll，在从 VS.Net 运行时可能会被引用。如果发生这种情况，那就糟了。您可以删除与您的项目相关的尽可能多的文件夹和内容。您可能需要通过关闭进程来禁用只读锁。这更像是最后的努力。如果您从未使用过 Windows 文件夹，请不要这样做。在大多数情况下，在此之前完成的某些操作通常会修复它。因此，理想情况下，当您完成上述指示时，您不必阅读这一点。仅作记录，如果您没有物理、数学、Windows 和 .Net 方面的博士学位，我不建议任何人探索此选项或玩弄您的 Windows 文件夹。
> 
> 其他提示：
> 
> 1.  模块窗口：可以在应用程序从 VS.Net 运行时查看模块窗口（调试 --> 窗口 --> 模块）。您项目中的所有模块都应在此处列出。如果您的项目的 .dll 已列出并且符号的状态是“符号已加载”，那么您没有问题。
> 
> 如果它是与您的 .pdb 文件相关的消息，请转到“选择符号”和相应的 .pdb 文件。您可能需要重新启动调试或再次加载 VS.Net。状态现在应更改为“已加载符号”。
> 2\. VS.Net 选项：工具 --> 选项 --> 调试 从 VS.Net 2005 开始，还有一个称为“符号”的节点，您可以在其中要求 VS.Net 查找符号。这也可以在调试时通过模块窗口访问。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-13T07:56:13.643

你`<compilation debug="true">`在 web.config 中设置了吗？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-18T01:05:44.630

我遇到了类似的问题，断点不起作用，同时，在 IIS 控制台中，我无法编辑项目的配置，即“编辑配置”按钮显示为灰色。

[要找到编辑配置按钮：开始 | 所有程序 | 管理工具 | Internet 信息服务，然后展开所需的计算机，展开网站，展开默认网站，找到并右键单击所需的项目，选择属性，然后选择 ASP.Net 选项卡。]

我发现在 IIS 中，我的项目的**ASP.Net 版本**设置为 4.0.30319。一旦我**将其设置为 2.0.50727**，“编辑配置”按钮就变得可用（可点击）并且我的断点再次起作用。

我还意识到可能值得检查 IIS 中为“默认网站”设置的 ASP.Net 版本[在 IIS 控制台中，展开网站，右键单击**默认网站**并选择属性，然后选择 ASP.Net 选项卡]，以便在 Visual Studio 中创建的任何新项目都获得默认网站设置。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-17T20:40:16.083

我最近遇到了这个问题（WinXP，VS2003），并尝试了上面的许多解决方案，但没有成功。然后，我意识到安装了多个版本的 .Net 运行时。所以，我启动了 IIS 5.1，找到了正确的虚拟文件夹，进入属性，然后是 ASP.NET 选项卡，然后将 ASP.NET 版本从 4 更改。到1.1，看来这解决了这个问题。解决方案可能是这个，加上上述的一项或多项。

此外，以上所有内容构成了一个“厨房水槽”，可以尝试不同的东西。这就像把一串意大利面条扔到墙上，希望其中一些能粘住。而且，其中一些“解决方案”可能会导致您的程序出现其他问题。例如，设置 AutoEventWireup="true" 的建议可能会导致您的某些事件触发两次！！！（见[http://support.microsoft.com/kb/814745](http://support.microsoft.com/kb/814745)）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-06-20T10:12:14.900

始终寻找要设置为**“调试”的****解决方案配置**以进行调试。发布后可能会更改为发布配置。

 *** * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-01T16:41:06.860

对我来说，项目属性已被另一个开发人员重置为使用 IIS Express 而不是我的本地 IIS。所以项目运行正常，但没有受到任何影响。

右键单击项目 > 属性 > Web > 服务器 - 更改为本地 IIS。我知道这对每个人都不起作用，但希望这对某人有所帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-05-17T10:44:39.617

1.  转到您的解决方案属性。
2.  在配置属性中，将解决方案中所有项目的构建配置设置为“调试”而不是“发布”。
3.  单击应用，然后单击确定按钮。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-12-04T20:04:46.727

在我的情况下，这个问题最终与使用完整的 IIS（不是 Express）和调试版本有关，其中包含完整的调试符号，但也有项目属性`Build`，，，`Optimize code`检查。

在 Express 下，这可以正常工作，但在完整的 IIS 下，这不起作用。Visual Studio 正确附加到 w3wp 进程，但它不会为优化的 dll 加载符号。在 Visual Studio 中，您可以转到`Debug`、`Windows`，`Modules`然后滚动查看特定的 dll 并查看`Symbol Status`它是否显示在列下`Skipped Loading Symbols.`。右键单击它并选择`Load Symbols`使其工作。

可能会影响这一点的另一个设置是，如果 Visual Studio 设置为仅调试`Debug`, `Options and Settings`, `Debugging`,`General`下的用户代码`Enable Just My Code`。优化后，在完整 IIS 下运行时，dll 将被标记为非用户代码，因此启用 Just My Code 时，将跳过其中的任何断点。您可以将 VS 设置为调试非用户代码，或者将构建设置为不优化以允许命中断点。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-01-09T17:35:07.793

这让我发疯了一个星期，直到我终于注意到一个缺失的设置。这建立在 Jay Riggs 的答案之上，但适用于 Visual Studios 2010 而不是 2005。在项目属性 -> Web -> 调试器中，确保选中 ASP.NET 调试器。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-08-17T10:54:52.053

听起来很傻，但是在进程的早期放置一个断点：也许进程没有到达断点。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-07-12T14:07:59.217

只是从我在 C# WPF 中发生的一些事情中添加一点，但我认为它也适用于这里。我尝试了上述答案，但都没有奏效。

代码 ---> 线程 ---> 函数 START -**断点**- END

这可能不是你的情况，但我希望这可能对某人有所帮助。从我的代码中，我启动了一个线程，从中启动了一个外部函数。所以尽我所能，我无法让断点从外部函数工作。并且行为（尽管我的重建或更改选项）正是问题中所解释的。

所以我不得不将断点从外部函数移动到线程并且有效。停止时，我继续 F10-F11

代码 ---> 线程 **断点**---> 函数 START - END

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2019-09-06T18:45:49.443

Debug=>Options=>General => 去掉“Enable Just My Code”的复选标记

这对我有用

# c++ - ARM RealViewICE 的 C++ 命名空间问题

> ID：856653
> 
> 赞同：0
> 
> 时间：2009-05-13T07:58:02.643
> 
> 标签：c++, debugging, embedded, arm

我正在使用 ARM RealView 调试 3.1，我无法查看 C++ 命名空间中定义的函数内的变量，代码运行良好并且使用 armcc 编译。你们中有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T20:24:10.680

您真的无法观察命名空间内的变量吗？当你尝试时会发生什么？

GDB 要求你明确地给出命名空间 ::

我不确定 ARM 调试器需要什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-03T12:18:45.843

好吧，arm 确认了这个错误。

# asp.net-mvc - 我应该如何延迟生成缩略图？

> ID：856654
> 
> 赞同：0
> 
> 时间：2009-05-13T07:58:23.830
> 
> 标签：asp.net-mvc, linq-to-sql, domain-driven-design, lazy-loading, iqueryable

作为背景，我有一个数据层和服务层，松散地基于[Rob Conery 的店面](http://blog.wekeroad.com/mvc-storefront)模型，就像 Rob 的一样，我的许多域对象都用`LazyList<>`'s 和`LazyItem<>`'s 链接，以利用 Linq2Sql 提供的延迟执行，因为我的`Lazy*`类型利用`IQueryable<T>`而不是[这种令人敬畏的委托方法](https://stackoverflow.com/questions/375881/lazy-loading-and-lazy-execution-patterns)。

所以我有一个像这样的对象图（基本上，每个活动都应该有一个包含许多图像的照片库 - 缩略图和全尺寸照片）：

```
latest3Activities[0].Gallery.Images.Inner[1].FullImage 
```

该`Gallery`类型具有 Images 属性，`LazyList<PhotoGalleryImage>`因此`IList<PhotoGalleryImage>`LazyList 就是`Inner`您所看到的。每个`PhotoGalleryImage`项目都有一个`FullImage`属性和一个`Thumbnail`属性，两者都是 type `Image`。

这个想法是将完整的 rez 上传照片存储在`PhotoGalleryImage.FullImage`属性中，最初，`Thumbnail`属性是`Null`. 我要的是：当`Thumbnail`第一次访问该属性时，如果`Null`我希望我的服务层生成 Thumb，将其保存到数据库，然后返回`Image`较小照片的实例。我拥有从全尺寸图像创建缩略图的所有代码，所以这不是这里的问题。

我想不通的是如何捕获`Thumbnail`属性的第一次访问（在我的`IQueryable<>`架构上下文中），然后让服务层进行调整大小而不是存储库（DAL）。我强烈认为服务（业务）层应该负责这个功能决策，但我不知道如何使它工作。

目前，我正在考虑从存储库中的域类到 Linq2Sql 类的映射将是识别我所指的这种“首次访问”的好地方，但我不知道较低层如何调用服务层并执行收缩（或者即使可以，也*应该*这样做）。

也许我的设计限制了我让 Repos 进行转换。也许我根本不希望服务层执行这个逻辑。也许我的设计太可怕了，我真的不应该面对这个烂摊子。

请帮忙。感谢所有反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T08:25:06.657

几个月前，我在上传图像、缩略图生成以及生成缩略图的代码应该去哪里的问题上遇到了一个非常相似的问题。我也真的觉得这段代码属于服务层（尤其是因为图像文件和缩略图的存储被抽象出一个接口并通过 IOC 容器注入，我不想在我的域中注入任何依赖项层）。

最后，我在通过从 UI 控制器调用服务层上传图像时创建了所有缩略图。不过，在此之前，我确实尝试在域层中生成图像。为此，我使用了一种模式，当域层需要生成图像时，它会引发一个连接到服务层的事件。然后，服务层通过事件 args 将存储接口的实例传回给域层，以便域层可以持久保存图像。这非常松散地基于[Udi Dahan 博客上的一些想法](http://www.udidahan.com/)我遇到了关于在域模型中使用事件作为在服务层中利用逻辑的一种方式。不幸的是，我现在在 Udi 的网站上找不到参考资料，但它在某处。无论如何，它从来没有真正感觉正确 - 它似乎通过另一条路线紧密耦合，这就是为什么我恢复到在图像首次通过服务层上传时创建缩略图。但是，也许在您的情况下，您可以使用来自领域层的事件的想法来调用服务层中的逻辑。我确信这个想法本身有很多价值，它只是不太适合我正在做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T08:33:10.107

延迟初始化的目的是推迟分配资源，因为您不知道何时或是否需要它们。

在您的情况下，这没有任何意义：一旦上传图像，服务器将需要缩略图 - 用户希望立即看到新图像，对吗？因此，推迟创建缩略图没有积极的 ROI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T08:02:29.843

我假设为了显示图像，您需要图像 URI，它可以由 a 传递给您`IThumbnailingService`，如果需要，它将生成缩略图并返回指向生成图像的有效 URI。

# widget - 如何从头开始创建小部件平台

> ID：856656
> 
> 赞同：2
> 
> 时间：2009-05-13T07:58:25.403
> 
> 标签：widget, platform

我们想为特定网站创建一个小部件平台。

我找不到任何关于这样做的文章，但我现在需要的是有人指出我正确的方向。

我们应该使用什么框架？我精通 RoR，对 Java/.Net 也很熟悉，但我不知道在 rails 中执行此操作是否容易，因为我看不出这与通常的 Web 应用程序有何不同。

许多小部件平台允许第三方开发人员使用 Javascript。这有多容易，我们是否必须创建一个解释器或类似的东西？

我们应该遵循什么样的架构？我们是否将小部件存储在数据库中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T19:27:26.100

看一下[**Java Portlet**](http://en.wikipedia.org/wiki/Portlet)规范。Protlets 似乎正是您正在寻找的。至少您应该阅读技术概述。有许多可用的 portlet 容器（框架）。

如果您***真的***必须***从 stratch***创建所有内容，请查看**[Android AppWidget](http://developer.android.com/guide/topics/appwidgets/index.html)**框架。Android 是 Google 的一款用于移动设备的开源操作系统。它们在操作系统代码（小部件容器）和第三方代码（小部件提供者）之间完全分离 - 如果您必须处理不受信任的用户提供的代码，这非常有用。

摩托罗拉还为手机提供了自己的[Widget 框架](http://developer.motorola.com/technologies/widgets/)，但它不是开源的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T08:51:11.907

你到底想做什么？

你的网站是新的吗？还是它已经存在于某个环境中？

我建议您可以从 xml 模板构建您的页面，并使用某种自定义 sax 解析器来用服务器上的 html 块替换对小部件的引用，您可以使用 xslt，但我怀疑调用任意使用 sax 解析器编写代码。

我喜欢 java，因为那是我的空间，但我确信 ruby​​ 和 .net 可以胜任简单的 dom 操作。

第 3 方开发人员可以提供上述 html 块，包括脚本标签以提供他们想要的任何功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T02:21:02.707

我想我的问题是：

*   小部件是什么意思，以及

*   “从头开始”是什么意思？

如果“从头开始”你的意思是你不想只对以前存在的小部件进行皮肤，我会首先选择一个符合你的规范（jquery、dojo、aria 等）的 javascript 框架，然后看看它们是否可以延伸为只要你能推动他们。（这是假设您不介意小部件是开源的。此外，您可以弥补任何缺乏可访问性或不认为这是一个问题。）

除了输出代码、保存更改和为小部件加载保存的数据之外，我不会依赖服务器端。如果您已经需要 ajax 将交互从客户端传递到服务器，为什么要停止小部件让服务器关注小部件的其他机制？

我不会使用 Java，但出于同样的原因 NSherwin 会。这不是我的强项。但我也认为，我们正在超越对编译器和成熟应用程序的依赖，让事情在网络上执行。Java 将在可预见的未来占有一席之地，但是当我们的浏览器（和开发人员！）可以更快地完成工作并且开销更少时，我们不需要依赖它（或 Flash，就此而言）。（更不用说这有助于提高可访问性和可用性。想想不需要特殊应用程序即可查看 Facebook 或 Twitter 的手机！）

基于我的第一个问题，所有这些都发生了一些变化：小部件是什么意思？如果您指的是约会日历、相框或倒数计时器（上帝，我很无聊，抱歉），请记住我上面所说的一切。使用 php 或 RoR 生成代码，通过良好的框架使用 js 使其打勾，并使用 ajax 到 xml 到 MySQL 来处理事件处理之外的交互。

但是如果你想要的是一个供游客玩吃豆人的小部件，或者设计他们梦想中的家庭平面图，或者一些真正的数学/图形重的东西，那么我会向那些比我更了解 Java/Flash 的人鞠躬. 我认为即使在那些情况下我也可以敲鼓的那一天即将到来，但是今天即使是接近的东西也不值得花工时。

这是我目前正在努力解决的问题，可能有助于完善您的需求......

让我们想象一个像西南航空丁这样的小部件！桌面小部件，但在网络上。它会在出现好交易时提醒您。时间很重要，因为名额有限。您是否让浏览器每半秒查询一次服务器以查看是否有更新？您是否设置了一个数据库，该数据库在更新时向服务器发送一个 crontask 以运行更新 xml 文件的脚本，该脚本更容易让浏览器检查文件大小的更改？所有这一切都是为了让用户可以在这里 DING 而不必点击刷新（这可能会在服务器上产生一个效率较低的相同版本）？

我有一个 js 脚本，它每半秒查询一次活动页面的 cookie，以便用户在即将被踢出时收到警告。我确信有一些事件侦听器可能会消除循环的需要，但是当服务器上发生某些事情并且浏览器只是挂出时，是否有等价物？

只是我对小部件和网络应用程序的想法。希望对您有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T09:37:11.283

您正在寻找[http://jswaf.googlecode.com/](http://jswaf.googlecode.com/)

我是该工具的合著者……但是在线提供的版本已经过时了。

我的家用电脑上有一个更好的版本，但不幸的是，在接下来的两个月里我无法访问它:(

* * *

如果你想从头开始编写自己的框架，即使是现在在线可用的版本也会让你很好地了解如何去做。

是的，您是对的：要创建运行时小部件，您需要使用解释器。幸运的是，您可以直接使用浏览器中提供的 javascript 解释器。

这一切都在 JSWAF 的代码中。

请务必发送有关 JSWAF 的评论，特别是如果您发现它有些愚蠢。

干杯，jrh。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T14:46:51.083

不久前，我为我的项目创建了自己的小部件集。这还不错。另一方面，它不如 ExtJS，所以我最近终于转向了这个小部件集。出于您的目的，请查看 Ext-GWT 小部件库。

# c# - 使用 GZip 往返截断 1 个或多个字节

> ID：856663
> 
> 赞同：3
> 
> 时间：2009-05-13T08:00:33.060
> 
> 标签：c#, .net, gzip, compression

我不明白。多年来，我一直使用类似/相同的方法，但从未经历过这种情况。

出于某种原因，直到今天我才知道，GZip 往返会导致 1 个或多个字节被截断或数据出现乱码。

我写了一个简单的测试来验证其他东西没有影响它。

这总是因“长度不匹配”而失败。

有人可以按照我的说法说我不疯吗？:)

谢谢

雷比

**测试**

```
using System;
using System.Diagnostics;
using System.IO;
using System.IO.Compression;

class Program
{
  const int BUFFER_SIZE = 8192;

  static void Main(string[] args)
  {
    var filename = args[0];
    var filedata = File.ReadAllBytes(filename);
    var cmp = Compress(filedata);
    var dec = Decompress(cmp);

    Assert(filedata, dec);

    Console.ReadLine();
  }

  static void Assert(byte[] orig, byte[] data)
  {
    if (orig.Length != data.Length)
    {
      Debug.Fail("length mismatch");
    }
    for (int i = 0; i < orig.Length; i++)
    {
      Debug.Assert(orig[i] == data[i], "data mismatch");
    }
  }

  static byte[] Compress(byte[] data)
  {
    var input = new MemoryStream(data);
    var output = new MemoryStream();

    var s = new GZipStream(output, CompressionMode.Compress);
    byte[] buffer = new byte[BUFFER_SIZE];
    int read = 0;
    while ((read = input.Read(buffer, 0, buffer.Length)) > 0)
    {
      s.Write(buffer, 0, read);
    }

    return output.ToArray();
  }

  static byte[] Decompress(byte[] data)
  {
    var input = new MemoryStream(data);
    var s = new GZipStream(input, CompressionMode.Decompress);

    var output = new MemoryStream();
    byte[] buffer = new byte[BUFFER_SIZE];
    int read = 0;
    while ((read = s.Read(buffer, 0, buffer.Length)) > 0)
    {
      output.Write(buffer, 0, read);
    }

    return output.ToArray();
  }
} 
```

我也尝试过正确关闭流，使用不同的缓冲区大小，结果都是一样的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T08:13:44.100

好的，找到问题了。

您需要在检索字节之前关闭压缩流。

例如：

```
s.Close();
return output.ToArray(); 
```

# c# - 如何将 Type 实例转换为泛型类型参数

> ID：856665
> 
> 赞同：10
> 
> 时间：2009-05-13T08:00:56.633
> 
> 标签：c#, generics, types, generic-type-argument

我基本上有这样的东西：

```
void Foo(Type ty)
{
    var result = serializer.Deserialize<ty>(inputContent);
}

Foo(typeof(Person)); 
```

`Deserialize<ty>`不起作用，因为它期望相反`Deserialize<Person>`。我该如何解决这个问题？

我还想了解泛型是如何工作的，以及为什么它不接受`ty`which is `typeof(Person)`.

编辑：我应该提到这是一个人为的例子。我实际上无法更改函数的签名，因为它实现了一个接口。

编辑：序列化器是一个 JavascriptSerializer 并在此处实现为操作过滤器。它是这样称呼的：

```
[JsonFilter(Param="test", JsonDataType=typeof(Person))] 
```

## 解决方案

根据 Marc 和 Anton 的回答：

```
var result = typeof(JavaScriptSerializer).GetMethod("Deserialize")
                 .MakeGenericMethod(JsonDataType)
                 .Invoke(serializer, new object[] { inputContent }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T08:05:31.680

那是哪个序列化程序？如果您只知道`Type`在运行时（而不是编译时），并且它没有非通用 API，那么您可能必须使用`MakeGenericMethod`：

```
void Foo(Type ty)
{
    object result = typeof(ContainingClass).GetMethod("Bar").
        .MakeGenericMethod(ty).Invoke(null, new object[] {inputContent});
}
public static T Bar<T>(SomeType inputContent) {
    return serializer.Deserialize<T>(inputContent);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T08:06:39.277

如果`ty`在编译时已知，为什么不只是

```
void Foo<T>()
{
    var result = serializer.Deserialize<T>(inputContext);
} 
```

除此以外，

```
MethodInfo genericDeserializeMethod = serializer.GetType().GetMethod("Deserialize");
MethodInfo closedDeserializeMethod = genericDeserializeMethod.MakeGenericMethod(ty);
closedDeserializeMethod.Invoke(serializer, new object[] { inputContext }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T08:04:17.843

采用

```
void Foo<T>(){ var result = serializer.Deserialize<T>(inputContent); } 
```

通过以下调用

```
Foo<Person>(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T08:06:00.633

在这种情况下，只需执行以下操作：

```
void Foo<ty>()
{
    var result = serializer.Deserialize<ty>(inputContent);
}

Foo<Person>(); 
```

否则，您需要调用后期绑定的泛型方法，因为您必须首先为其获取正确的泛型方法（在编译时不知道）。看看[MethodInfo.MakeGenericMethod](http://msdn.microsoft.com/de-de/library/system.reflection.methodinfo.makegenericmethod(VS.95).aspx)方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T08:08:48.290

就像卢塞罗说的，

```
void Foo<ty>()
{
    var result = serializer.Deserialize<ty>(inputContent);
}

Foo<Person>(); 
```

typeof(Person) 与 Person 不同。Person 是一个编译时类型，而 typeof(Person) 是一个表达式，它*返回一个表示 Person 的运行时类型信息的 Type 实例*。

# c# - Directory.GetFiles() 给出奇怪的返回值

> ID：856672
> 
> 赞同：0
> 
> 时间：2009-05-13T08:02:31.093
> 
> 标签：c#, .net, file, io, locking

当我尝试使用名为[File Lock](http://www.toplang.com/filelock.htm)的工具隐藏目录中的文件时，会出现此问题。这不是常规隐藏，因为我在 Windows 资源管理器中看不到它。代码：

```
string[] textFiles = Directory.GetFiles(@"c:\mydir")
//0 files returned

string[] textFiles = Directory.GetFiles(@"c:\mydir", "*.txt")
//1 file returned: "c:\mydir\."
File.Exists(textFiles[0])
//false 
```

第二个函数如何返回“c:\mydir\”。文件？我可以删除所有不存在的文件来解决我的问题，但我想知道为什么我得到一个“。” 文件放在第一位。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T08:13:09.187

我没有使用 File Lock 工具的经验，但我可以假设它挂钩 FindFirstFile WinAPI 函数以保护某些文件不被列出（该函数由 .NET Directory.GetFiles() 函数使用）。而且这个钩子可以写一点......越野车:)

您能否尝试禁用该工具并重新进行测试？
你很可能会解决问题。
但是如果你得到同样的结果，那就怪 Directory.GetFiles()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T09:24:41.830

多一点调查：

*   `C:\Test\`是一个普通目录
*   `C:\Test\text.txt`是一个普通的文本文件。
*   `C:\Text\text2.txt`是文件锁隐藏的文本文件

以下代码...

```
using System;
using System.IO;

public static class GetFilesTest {
  public static void Main() {
    int counter = 0;
    DirectoryInfo dir = new DirectoryInfo(@"C:\Test");
    foreach (FileSystemInfo fsi in dir.GetFileSystemInfos("*.txt")) {
      Console.WriteLine("########### FileSystemInfo {0} ###########", ++counter);
      Console.WriteLine("fsi: {0}", fsi);
      Console.WriteLine("Exists: {0}", fsi.Exists);
      Console.WriteLine("FullName: {0}", fsi.FullName);
      Console.WriteLine("Name: {0}", fsi.Name);
      Console.WriteLine("Extension: {0}", fsi.Extension);
      Console.WriteLine("Attributes: {0}", fsi.Attributes);
    }

    counter = 0;
    string[] files = {@"C:\Test\test.txt", @"C:\Test\test2.txt"};
    foreach(string file in files) {
      FileSystemInfo fi = new FileInfo(file);
      Console.WriteLine("########### FileInfo {0} ###########", ++counter);
      Console.WriteLine("fi: {0}", fi);
      Console.WriteLine("Exists: {0}", fi.Exists);
      Console.WriteLine("FullName: {0}", fi.FullName);
      Console.WriteLine("Name: {0}", fi.Name);
      Console.WriteLine("Extension: {0}", fi.Extension);
      Console.WriteLine("Attributes: {0}", fi.Attributes);
      Console.WriteLine("Contents: {0}", File.ReadAllText(fi.FullName));
    }
  }
} 
```

...输出：

```
########### FileSystemInfo 1 ###########
fsi: test.txt
Exists: True
FullName: C:\Test\test.txt
Name: test.txt
Extension: .txt
Attributes: Archive
########### FileSystemInfo 2 ###########
fsi: .
Exists: False
FullName: C:\Test\.
Name: .
Extension: .
Attributes: Directory
########### FileInfo 1 ###########
fi: C:\Test\test.txt
Exists: True
FullName: C:\Test\test.txt
Name: test.txt
Extension: .txt
Attributes: Archive
Contents: test
########### FileInfo 2 ###########
fi: C:\Test\test2.txt
Exists: True
FullName: C:\Test\test2.txt
Name: test2.txt
Extension: .txt
Attributes: Archive

Unhandled Exception: System.UnauthorizedAccessException: Access to the path 'C:\Test\test2.txt' is denied.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)
   at System.IO.StreamReader..ctor(String path, Encoding encoding, Boolean detectEncodingFromByteOrderMarks, Int32 bufferSize)
   at System.IO.StreamReader..ctor(String path, Encoding encoding)
   at System.IO.File.ReadAllText(String path, Encoding encoding)
   at System.IO.File.ReadAllText(String path)
   at GetFilesTest.Main() in c:\Users\Yvonne\Temp\GetFilesTest.cs:line 29 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T08:11:41.013

“。” 指当前目录。尝试：

```
Directory.Exists(textFiles[0]); 
```

看到它在行动。

为什么第二个重载返回他的条目而第一个没有，我不知道。

# sql-server - 减少 MS SQL 数据库备份文件大小的方法

> ID：856680
> 
> 赞同：3
> 
> 时间：2009-05-13T08:04:26.737
> 
> 标签：sql-server, backup, filesize, minimize

这个问题可能会让人微笑，真的，今天的硬盘空间和泥土一样便宜。但是，尽管如此，由于互联网连接速度极慢（世界上大部分地区仍然如此），从不同的分支机构传输备份可能是真正的痛苦。

那么，您对如何将数据库文件大小降至最低有任何想法吗？绝对欢迎任何想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T08:10:37.520

1.  压缩备份。
2.  划分为多个文件组，以便您可以单独备份文件。
3.  备份前删除索引。在执行此操作之前，您可能希望在本地复制数据库。
4.  在单独的文件组上有索引，因此您不必备份它们。
5.  将文本/二进制/图像数据放在单独的文件组中。
6.  做增量备份。
7.  [在http://www.serverfault.com](http://www.serverfault.com)上问这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T08:07:51.817

如果您只是在谈论备份，那么有一些 SQL 备份解决方案可以提供备份压缩。SQL Server 2008 还内置了备份压缩功能。

请参阅：Red Gate 的[SQL Backup Pro](http://www.red-gate.com/products/sql_backup/index_2.htm)

或者这里是各种产品的列表：[http ://www.mssqltips.com/products.asp?catid=15](http://www.mssqltips.com/products.asp?catid=15)

如果您正在谈论实际减少数据库本身的大小 - 选择正确（= 最小）的数据类型，使用维护计划来压缩和回收数据库中的空间，不要过度索引（总是使用大量空间）等。

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T08:10:32.000

你试过压缩吗？数据库文件往往压缩得非常好，因为它们通常主要是文本。

# eclipse - 如何解决 Eclipse IDE 中的“同步 CVS”问题？

> ID：856686
> 
> 赞同：10
> 
> 时间：2009-05-13T08:05:08.497
> 
> 标签：eclipse, cvs, synchronizing

我正在尝试更新我的一个项目，但我无法管理。当我尝试时，我得到了错误

```
'Synchronizing CVS' has encountered a problem.
Problems reported while synchronizing CVS Workspace. 0 of 1 resources were synchronized.

Details:
Problems reported while synchronizing CVS Workspace. 0 of 1 resources were synchronized.
  An error occurred synchronizing /<Project name>: The server reported an error while performing the "cvs update" command.
    The server reported an error while performing the "cvs update" command.
      <project name>: The server did not provide any additional information. 
```

我应该关心这个错误吗？看起来一切都很好，但它困扰着我。

感谢您阅读

**更新**

我发现有一个文件更新了，但结果没有更新。我这样做的另一个错误是我在项目级别同步，在这些情况下，我认为最好在文件夹级别同步并打开 CVS 控制台。要打开 CVS 控制台，请按窗口 > 打开视图 > 控制台。然后在控制台视图中有一个外壳图标，需要按下它，然后按下 CVS。像它所显示的 CVS 输出那样做，它会有所帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T08:25:38.417

发生这种情况有几个原因：

*   其他一些进程更改了文件，Eclipse 没有刷新工作区。要检查，请选择有问题的文件，然后从上下文菜单中选择“刷新”。这可能不是您的问题，但这是一个常见问题，所以我想提一下。

*   CVS 服务器出现问题（文件或目录权限、硬盘故障、RAM 损坏等）。您必须查看 CVS 日志文件以找出可能导致问题的原因。您还应该尝试找出导致问题的文件。检查 cvs 提交日志，哪些文件被更改，然后手动一个接一个地更新，直到它中断。

作为一般规则：如果有东西坏了，你应该修理它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-28T19:29:40.440

我遇到了同样的问题，原因是我在一个文件上发生了合并冲突，而 CVS 已经创建了该文件的备份版本 - (.# 文件)。一旦我删除它们，问题就消失了。以为我会提到这一点，以防有人遇到同样的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-24T14:46:04.203

mering 后不久出现错误。这是我设法为我解决的方法：

1.  找到导致它的坏文件。
2.  通过选择eclipse中的所有文本并复制来复制内容。
3.  将文件替换为服务器上的最新版本。
4.  粘贴复制的文本。

覆盖修复了导致错误的损坏，并且复制文本意味着您不会丢失内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-22T08:16:24.210

转到 Windows >> 首选项 >> 网络连接，尝试更改活动提供程序 - 手动、直接和本机。我也面临同样的问题，并且能够通过将 IP 添加到 cvs repos 的代理来解决它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T08:27:04.077

您是否在 eclipse 之外更改了资源/类并且没有在 eclipse 中更新插件？当您调用 synchronize 时，eclipse 会显示一条错误消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-31T21:19:34.857

有同样的问题，当我用问题/CVS/Entries 删除我的工作区/项目/WebContent/文件夹的内容时解决了它，然后我在 Eclipse 中刷新了我的文件并且它工作了。
我猜那里的东西已经损坏了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-09T17:49:51.247

除了删除以 .# 开头的文件之外，我还必须“覆盖并更新”该文件，以便 Eclipse CVS 知道它处于什么状态。

如果在更新代码时发生这种情况，可以通过首先同步工作空间并解决任何合并问题来避免此错误。我意识到这不是切换分支时的选择。

我学会了使用以“.#”开头的文件作为清理的地方。如果我删除了这些文件，然后我会去逐个文件夹同步文件夹。

之后，清理旧的 .# 文件，以免以后产生误导。

在 DOS 中，“del /s .#*”

# ruby-on-rails - 使用 Ruby/JRuby 将 pdf 转换为图像

> ID：856690
> 
> 赞同：1
> 
> 时间：2009-05-13T08:06:29.713
> 
> 标签：ruby-on-rails, ruby, pdf, jruby, imagemagick

我正在寻找一种简单的方法来为生成为 pdf 的标签生成预览。如果我可以将这些 pdf 文件转换为图像并在实际打印/下载之前将它们展示给用户，那就太好了。

该应用程序当前在 Jruby on rails 环境中运行，但我们很有可能切换到两个应用程序，一个在本机 ruby​​（主应用程序）中运行，一个在 jruby（pdf 工具）中运行。因此，选择并不仅限于这些世界之一。

到目前为止，我看到以下选项：

*   RMagick：看起来很成熟，ImageMagick 作为后端，可能不适用于 jruby
*   RMagick4J：与 RMagick 一样，但可用于 JRuby，显示为非活动状态，仅支持子集。
*   Jmagick：Java 的 JNI 接口，仅适用于 JRuby

PDF 生成本身将始终在 Jruby 环境中，因此 JMagick 听起来是个好主意（预计可能的 JNI 麻烦）。另一方面，如果解决方案不限于一个平台，那就太好了。

有任何想法吗？建议？糟糕的经历？也许是一个完全不同的想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:54:43.080

你在 Linux 上吗？

```
sudo apt-get install imagemagick 
```

在你的红宝石代码做

```
system "convert -colorspace rgb -density 150 ../path/whatever.pdf ../path/whatever.jpg" 
```

-density 是最终图像的 DPI

-colorspace 修复了我在颜色消失时遇到的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T18:06:29.453

这是 ImageMagick 的一个非常薄的纯 Ruby 包装器。您可以通过一些模块方法轻松地将您想要的任何命令发送到 ImageMagick：

www.misuse.org/science/2008/01/30/mojomagick-ruby-image-library-for-imagemagick/

它在 jruby 上也应该可以正常工作，因为没有 DLL 魔法或引擎盖下的任何东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T14:46:09.607

我使用[IText](http://www.lowagie.com/iText/)生成/操作 PDF。它是一个 Java jar，但从 JRuby 调用它真的很容易。如果将它与[FlyingSaucer](http://code.google.com/p/flying-saucer//)项目结合使用，您还可以生成图像。两者都非常易于使用。

# c - 为嵌入式应用程序选择 C 中的唯一标识符

> ID：856693
> 
> 赞同：4
> 
> 时间：2009-05-13T08:07:14.190
> 
> 标签：c, algorithm, embedded

我目前正在尝试实现一种算法来选择一个唯一的（16 位）标识符。挑战在于以不使用太多内存的快速方式执行此操作。当前使用的标识符列表是通过一系列 SPI 事务扫描外部闪存设备来确定的，因此是一个相对较慢的过程。此外，该算法将在一个小型微控制器上运行，所以我不能真的将所有条目读入 RAM 并在那里处理它们。

到目前为止我的想法是：

1.  选择一个号码，然后浏览列表并查看它是否已被使用。冲洗并重复。速度相当慢（特别是如果有很多文件）。
2.  如上所述，但使用带有适当种子的伪随机数生成器来选择数字。这样做的好处是不太可能出现如此大量的迭代。
3.  扫描列表并用找到的所有条目填充一个数组。对其进行排序，然后它变得微不足道。这可能会使用大量内存。
4.  使用一个巨大的（好吧，*非常*大的）位掩码。不太实用。
5.  接受该工具的生命周期，它会在将 65534 个文件写入闪存之前很久就被丢弃或“格式化”，因此只需将目前使用的最高值存储在闪存或备份内存中并保持递增. 老实说，这对于这个特定的应用程序可能会非常有效。

目前，我正接近使用第二个或第五个，但我很想知道是否有人有任何其他想法。我想认为有一种形式类似于 CRC 的算法，可用于依次处理每个数字并给出一个尚未使用的数字的公平概念，但我不知道这怎么可能工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T08:29:03.827

我认为您在这里有一些选择，但还有一个需要考虑的是[Bloom Filter](http://en.wikipedia.org/wiki/Bloom_filter)。这有可能出现误报（即，您可以排除一个已经使用过的 ID，即使它还没有使用过），但它可以让您选择可以专门用于该数据的确切空间量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T12:06:25.903

如果没有足够的 RAM 来实现足以容纳 64K 条目的位图，则可以通过为每次扫描使用较小的临时位图来减少通过 FLASH 扫描以查找未使用 ID 的次数。如果位图中至少有一个未标记的位，则 16 字节位图可以在第一次扫描时记录在 0-255 范围内找到的 ID，在第二次扫描时记录 256-511 等，在每次扫描结束时重做。我相信这与使用随机起始范围相结合会很好。

另一方面，如果我对选项 5 有很高的信心，我可能会选择它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T08:16:28.573

我猜由于提到了 SPI，闪存设备是不可移动的，但是 IIRC SD 卡具有 SPI 访问模式，所以这可能不是真的。

如果 FLASH 是永久性的，并且您有一个健壮的、非易失性的地方来记住最后发布的 ID，那么这可能就是要做的事情。它在运行时肯定是快速和低内存。它应该易于解释、实施和测试。

如果 FLASH 是可移动的，那么使用伪随机数生成器并测试碰撞可能是可行的方法。假设您的号码分布良好，那么您的碰撞几率很容易从使用中的总数中预测出来。只需选择一个具有相当长的重复间隔的生成器。在模拟中模拟它作为所选算法的验收测试可能是一个好主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T08:37:04.500

我想知道为什么你不简单地存储最后一个 ID 并增加它。你有犹豫的理由吗？你没有回答你的问题，只是普遍的不安。

如果出于安全原因需要 ID 有点随机，则使用随机数生成器并将生成器的当前寄存器值保存在闪存中。这样，您可以为下一个 ID 加载它们，如果您仔细选择算法，可以确保您获得完整的循环长度而不会重复。

[编辑] 由于您关心冲突，因此必须有一些可能发生冲突的数据，例如文件名等。如果明显的方法（创建一个文件名并检查它是否存在）太慢并且您在“分配图”中有巨大的差距，那么生成一个随机 ID 并检查它。这应该允许您通过几次迭代找到未使用的 ID。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T17:58:28.827

使用[最大线性反馈移位寄存器](https://stackoverflow.com/questions/196017/unique-random-numbers-in-o1/202225#202225)并存储您分发的最后一个值。给定一个特定的起点（不包括零），LFSR 将以伪随机顺序为您提供序列 1..2^n 中的所有数字。如果你从第 k 个元素开始，你总是会得到相同的第 k+1 个元素。实现很小：

```
if (IsEven(sequence)) {
    sequence /= 2;
}
else {
    sequence = (sequence / 2) ^ feedback;
} 
```

其中反馈是您想要生成的位数的最大反馈表中的位模式。这意味着要生成下一个数字，您读取最后一个分发的数字，通过上面的代码运行它，然后使用它。

或者，您为什么不只是数数并存储最后给出的数字？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T08:12:41.433

我会选择 2。但是要小心你如何选择生成器和种子。所有的伪数序列在经过一定次数的迭代后都会自我重复。所以你需要测试你的，它不会很快重演。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T08:22:24.070

我会尝试 3 的变体。我不会存储排序的值数组，而是存储排序的范围数组。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T11:47:35.967

你有多少内存？很难说，如今“嵌入式”可能意味着这么多。:) 位图在生成期间需要 8192 个字节，并且每次都保证完美的结果。

我还考虑了某种“稀疏”位图，但我不知道合适的数据结构，但可能值得研究。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T14:44:02.527

将运行计数保留为顺序 ID。
通过 MD5 运行 ID。
使用最低的 16 位。

理论是 MD5 为每个输入创建不同的散列。最低的 16 位应该和整个散列一样“随机”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-13T16:21:31.260

如果您可以使用更大的 id，那么 5 将是明智之举。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-13T17:13:19.897

关于您对算法感兴趣的 CRC...

看来您正在寻找一种算法，该算法将遍历少于 64K 的 16 位数字的随机列表，并生成列表中尚未出现的新 16 位数字；最好在给定列表中一次通过。

如果释放 ID 的顺序与分配它们的顺序无关（就像我觉得是您的情况），那么您无法通过生成或分配 ID 来获取您的算法。

最好的选择似乎是您列表中的 5 个。

如果你喜欢冒险...

并且，如果您可以重新编号您的 ID（即将分配的 ID 更改为另一个未分配的 ID），您可以不时运行“碎片整理”类型的迭代以将所有分配的 ID 移动到较低的值并找到最高的空闲下次分配的 ID 号。这将有助于记住自上次此类“碎片整理”运行以来完成的分配和释放总数。从 0 开始按顺序递增分配。

这样你只需要记住内存中的 3 个无符号短整数。是的，根据它们的值不时进行一次稍微昂贵的重新分配迭代。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-13T17:47:02.337

Another option would be to keep a file of valid ids on the flash drive. This way, you aren't querying all the possibilities every time. If you want random IDs, then randomize the file. Store the offset to the final one as the first number in the file. When you need one, remove the last from the file, and when you free one, add it back to the file. With the offset and a flash drive, it should be a nearly constant-time operation no matter the number of IDs left. As a bonus, the offset at the beginning will tell you how many IDs you have left, if you need to know that at any point. The downside would be that you do have to access the flash memory for each ID (constant-time, but still an access), and how to handle the error case if the file is not present.

# sql - Creating an entity diagram of a database without any foreign keys

> ID：856702
> 
> 赞同：3
> 
> 时间：2009-05-13T08:10:10.003
> 
> 标签：sql, reverse-engineering, entity-relationship, foreign-key-relationship

I need to create an entity diagram of a MSSQL 2005 database.

Relationships are defined by using primary keys consistently, but there are no foreign keys anywhere. I tried Microsoft Visio's "Reverse Engineer" function, which of course failed due to the lack of foreign keys.

Therefore, I need a diagram tool which doesn't solely rely on foreign keys when drawing relationships.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T08:18:42.080

创建一个创建正确外键关系的脚本，运行图表工具，然后运行第二个脚本来删除外键。

这将允许您使用您的工具而不会过多地破坏数据库。如果第一个脚本失败，那么您就会知道数据也有问题。

[编辑] 如果有一些如何命名外键列的规则，您可以使用脚本语言为您生成 SQL。

如果这也失败了，任何设计工具都应该允许您创建缺失的关系。这意味着您可能会遇到数据不一致的情况。这里的解决方案是制作表定义的快照并在私有数据库服务器上重新创建数据库（没有数据）。在那里，您可以在不破坏原始系统的情况下随心所欲地弄乱设计。

完成设计修复后，您可以提取命令以创建外键并将其应用于实际系统——如果您愿意的话。这样，您就可以感觉到数据库中的混乱已经有多大了。如果没有，那么您可以简单地保留新副本，在那里进行任何设计更改，并且在检查完它们之后，您可以将更改迁移到生产数据库。

在我自己的系统中，我总是有脚本来快速创建当前开发和生产数据库的克隆。通常，我使用像 Derby 或 HSQL 这样的嵌入式数据库。但是，如果您在流程中添加过滤器，则可以`$(SCHEMA)`在 DDL 文件中使用并将相同的数据库安装到同一台服务器上的不同模式中。我们在数据迁移项目中使用它取得了巨大成功，我们将每个迁移测试的结果保存在一个新模式中（`TABLE_DATE_XX`其中`XX`是一个两位数，因此您每天可以创建多个测试）。

这使我们能够验证各种修复，比较两个迁移等。由于整个过程是 100% 自动化的，因此创建新模式比修复现有模式更便宜。

# ruby - 从href html标签中提取带有红宝石中nokogiri的链接（URL）？

> ID：856706
> 
> 赞同：41
> 
> 时间：2009-05-13T08:11:11.733
> 
> 标签：ruby, parsing, nokogiri

我想从网页中提取所有 URL，如何使用 nokogiri 来做到这一点？

例子：

```
<div class="热">
   <a href='http://example.org/site/1/'>站点 1</a>
   <a href='http://example.org/site/2/'>站点 2</a>
   <a href='http://example.org/site/3/'>站点 3</a>
</div>

```

结果应该是一个列表：

```
l = ['[http://example.org/site/1/](http://example.org/site/1/)', '[http://example.org/site/2/](http://example.org/site/2/)', '[http://example.org/site/3/](http://example.org/site/3/)'
```

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-05-13T09:01:34.693

你可以这样做：

```
doc = Nokogiri::HTML.parse(<<-HTML_END)
<div class="heat">
   <a href='http://example.org/site/1/'>site 1</a>
   <a href='http://example.org/site/2/'>site 2</a>
   <a href='http://example.org/site/3/'>site 3</a>
</div>
<div class="wave">
   <a href='http://example.org/site/4/'>site 4</a>
   <a href='http://example.org/site/5/'>site 5</a>
   <a href='http://example.org/site/6/'>site 6</a>
</div>
HTML_END

l = doc.css('div.heat a').map { |link| link['href'] } 
```

此解决方案使用 css 选择器查找所有锚元素并收集它们的 href 属性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-13T09:18:35.447

好的，感谢 sris，这段代码非常适合我

```
p doc.xpath('//div[@class="heat"]/a').map { |link| 链接['href'] }
```

# sql - SQL: INSERT INTO...VALUES..SELECT

> ID：856707
> 
> 赞同：23
> 
> 时间：2009-05-13T08:11:17.427
> 
> 标签：sql, sql-server, insert

How do i write INSERT statement if i get the values of colA from TableX, colB from TableY and colC from TableZ?

eg: INSERT INTO TableA (colA, colB, colC) VALUES (?,?,?)

Any ideas if it is possible?

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-13T08:13:03.743

```
INSERT INTO TableA(colA, colB, colC)
  SELECT TableX.valA, TableY.valB, TableZ.valC
    FROM TableX
   INNER JOIN TableY ON :......
   INNER JOIN TableZ ON ........ 
```

Of course, TableX, TableY and TAbleZ might also be related in some other way (not INNER JOIN).

If you cannot find any relation between the tables AT ALL, you could also do three separate

```
SELECT @value1 = valA FROM TableX WHERE ......
SELECT @value2 = valB FROM TableY WHERE ......
SELECT @value3 = valC FROM TableZ WHERE ...... 
```

and then an insert like this:

```
INSERT INTO TableA(colA, colB, colC)
             VALUES(@value1, @value2, @value3) 
```

That's the ultimate last resort, you can can't express everything in a single `SELECT` statement.

Marc

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-13T09:23:34.720

响应 marc_s 的回答，您可以在自选择中从不相关的表中查询，例如：

```
INSERT INTO TableA
    (colA, colB, colC)
SELECT
    (SELECT valA FROM TableX WHERE ...),
    (SELECT valB FROM TableY WHERE ...),
    (SELECT valC FROM TableZ WHERE ...) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T08:14:42.460

```
Insert into TableA (ColA, ColB, ColC) . . . 
```

必须是表A中的列名。没有错

```
Insert into TableA (ColA, ColB, ColC) . . .
Select TableX.Col1, TableY.Col1, TableZ.Col5 
From TableX, TableY, TableZ
Where . . . 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T08:19:53.823

您将需要加入要从中进行选择的表。

这是有关 SQL 连接的资源：

[www.w3schools.com/sql/sql_join.asp](http://www.w3schools.com/sql/sql_join.asp)

您可能还想在[www.simple-talk.com](http://www.simple-talk.com/)上查看这本免费的 PDF 书籍，其中涵盖了 SQL 基础知识：

[SQL Server 婴儿床单纲要](http://www.simple-talk.com/sql/learn-sql-server/free-ebook-sql-server-crib-sheet-compendium/)

# asp-classic - 旧 ASP 中的“on error goto 0”和“error resume next”是什么意思？

> ID：856710
> 
> 赞同：7
> 
> 时间：2009-05-13T08:12:34.103
> 
> 标签：asp-classic, vbscript

我正在使用旧的 ASP 代码，但我不确定语义`on error goto 0`和`error resume next`构造。

能给我推荐一些有用的资源或者直接启发我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T08:20:41.763

On error resume next：如果程序中出现异常，则忽略它并继续下一条语句。被认为非常糟糕和丑陋，在我看来是正确的。这就像有一个大的：

```
try
{
  // your code
}
catch
{
  // nothing! muhaha
} 
```

在代码的每个方法中（或更糟糕的是，围绕*整个程序*）。

On error goto 0：禁用当前过程中定义的任何错误处理程序。这就像在你的代码周围有一个很大的尝试，一旦它到达这一行就会被禁用。

有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/5hsw66as(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T16:19:31.140

`on error resume next`意味着忽略错误并继续下一步 `on error goto 0`意味着结束错误恢复下一步你也可以这样做

```
 <%
        on error resume next '<-- This code will resume and continue executing the code if there is an error

'YOUR CODE HERE

if err.number > 0 then  '<-- This code will look if there are any errors (even if resumed)
' or use If Err.Number <> 0 Then

        'DO SOMETHING IF ERROR
    %>
        Error Number <%= Err.Number %><BR>
        Error Description <%= Err.Description %><BR>        
        Source <%= Err.Source %><BR>

        LineNumber <%= Err.Line %><BR>

        <%end if%> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T08:23:02.540

出错时转到将执行代码带到页面中定义的特定代码书签。当您想要执行任何操作以防遇到错误时，这很有用。

On error resume next 继续执行错误代码之后的下一个代码。基本上忽略错误并继续代码。当您处理 100 条记录并且不希望代码停止执行以防任何记录引发错误时，这特别有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-11T17:12:27.713

我曾经使用“单次运行”Do Loops 来构建涵盖多行代码和多个错误情况的经典 ASP 错误处理程序。该技术依赖于（补偿？）“On Error Resume Next”的使用，通过在发生错误时立即中断循环，然后在一些后续错误处理代码中测试和响应错误类别。请注意，由于中断发生在与循环相同的函数中的循环中，因此您仍然拥有在循环仍在执行时设置的上下文（变量），因此您的错误处理程序应该使用该上下文来记录智能错误并清除酌情整理任何挥之不去的参考资料。

查看为类似问题提供的答案“Larry”，以获得一个简单的示例。
[如何处理 VB 脚本中的错误](https://stackoverflow.com/questions/207646/how-to-handle-errors-in-vb-script)

# c++ - Refresh Window in Visual C++

> ID：856715
> 
> 赞同：0
> 
> 时间：2009-05-13T08:13:38.860
> 
> 标签：c++, visual-c++, refresh

I've a Visual C++ project but I don't be able to refresh the window and redraw itself. I've used

```
RedrawWindow();
m_ProgressDlg->RedrawWindow(); 
```

and also

```
UpdateData(false);
m_ProgressDlg->UpdateData(false); 
```

but never seems go well.

How can I do?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T08:54:37.573

您可以将[UpdateWindow](http://msdn.microsoft.com/en-us/library/dd145167%28VS.85%29.aspx)与[InvalidateRect](http://msdn.microsoft.com/en-us/library/dd145002%28VS.85%29.aspx)结合使用来立即重绘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T12:03:52.337

对于客户区，使用 InvalidateRect + UpdateWindow。如果要重绘窗口的非客户区，请尝试使用 SWP_DRAWFRAME | 调用 SetWindowPos SWP_NOSIZE | SWP_NOMOVE | SWP_NOACTIVATE。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T08:18:32.157

::InvalidateRect(hwnd, NULL, TRUE) WinAPI 函数（或 wnd->InvalidateRect(NULL) 方法）应该可以解决问题：它使客户区无效并导致系统将 WM_PAINT 发送到窗口以重绘它。如果您想立即重绘，您还应该在失效后立即调用 UpdateWindow()。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T08:31:26.067

看起来你正在使用 MFC。

我相信您的应用程序很忙并且没有处理来自队列的消息，因此它没有处理会更新窗口的 WM_PAINT。

使用带有 RedrawWindow 的 RDW_UPDATENOW 参数来强制重绘，即使您的窗口很忙。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T10:22:05.060

但是在发布版本中，如果使用 openeed worspace 它似乎也无法正常运行

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-03T18:18:08.827

您可能还尝试在 m_hWnd 为 NULL 时调用 Invalidate() 和 RedrawWindow()，如果“不顺利”意味着崩溃。尝试：

```
if (m_hWnd)
{
   Invalidate();
   RedrawWindow();
} 
```

（我知道这已经过时了，但我们中的一些人仍然将一只脚卡在 MFC 的垃圾中。）

# java - Can I simplify this Java Generics Hierarchy

> ID：856717
> 
> 赞同：4
> 
> 时间：2009-05-13T08:13:56.503
> 
> 标签：java, generics

Sometimes in my code I'd like to refer to (what I think of as) the implicit type in a generics heirarchy (basically the type implied by the first ? in the following).

```
public class Foo<BAR extends Bar<?>> {
  public void t(BAR x) {
    List l = new ArrayList();
    Object baz = x.makeBaz(null);
    l.add(baz);
    x.setBazList(l);
  }
}

public interface Bar<BAZ extends Number> {
  public BAZ makeBaz(Object arg1);
  public List<BAZ> getBazList();
  public void setBazList(List<BAZ> baz);
} 
```

For example in the above code would it be possible to replace the lines

```
 List l = new ArrayList();
    Object baz = x.makeBaz(null); 
```

with something using generics?

I would prefer to avoid having to write:

```
public class Foo<BAZ extends Number, BAR extends Bar<BAZ>> {
  public void t(BAR x) {
    List<BAZ> l = new ArrayList<BAZ>();
    BAZ baz = x.makeBaz(null);
    l.add(baz);
  }
} 
```

since it feels unnatural to force this on the declaration of any derived classes.

I know the above is a bit contrived, but it's a lot simpler than trying to show the actual code I'm looking at.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T08:30:34.277

我想主要的问题是你需要以某种方式强制你得到`x.makeBaz()`的类型与你给出的列表的类型参数相同`x.setBazList(l)`，并且如果你只是使用`?`你就会失去这种强制能力，所以你需要一个泛型类型参数。但从某种意义上说，类型参数仅在这几行中“本地”需要，并且类的其余部分不需要知道。

您可以使用 type 参数`BAZ`来参数化方法而不是类：

```
public <BAZ extends Number> void t2(Bar<BAZ> x) {
  List<BAZ> l = new ArrayList<BAZ>();
  BAZ baz = x.makeBaz(null);
  l.add(baz);
  x.setBazList(l);
} 
```

这用于本地化我们需要这个临时类型变量的代码区域`BAZ`。注意这个方法的签名是有效的`public void t2(Bar<?> x)`，即外界不需要知道这个`BAZ`。

现在当然这个方法现在接受 all`Bar<anything>`而不是 just `BAR`。如果这是一个问题，您可以“包装”上述方法。我们没有和以前一样的问题，因为所有的`BAZ`东西都已经包含在里面`t2()`了，它需要 a `Bar<anything>`，所以我们可以安全地传递 a `BAR`：

```
public void t(BAR x) {
  t2(x);
} 
```

我同意这似乎有点迂回。也许其他人会想出更好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T08:33:56.173

您至少可以绑定到 Number 作为 BAZ 扩展 Number

```
public class Foo<BAR extends Bar<?>> {
    public void t(BAR x) {    
        List<Number> l = new ArrayList<Number>();
        Number baz = x.makeBaz(null);
        l.add(baz);
        // l.add(Integer.valueOf(1)); compiles but with this here the next line throws ClassCastException
        x.setBazList(l);
    }
}

public interface Bar<BAZ extends Number> {
    public BAZ makeBaz(Object arg1);
    public List<BAZ> getBazList();
    public void setBazList(List<BAZ> baz);
}

public class BarConcreate implements Bar<BigDecimal>{
    long counter = 1;

    private List<BigDecimal> list = new ArrayList<BigDecimal>();
    public List<BigDecimal> getBazList() {
        return list;
    }

    public BigDecimal makeBaz(Object arg1) {
        return BigDecimal.valueOf(counter++);
    }

    public void setBazList(List<BigDecimal> baz) {
        list = baz;         
        for(BigDecimal d : baz){
            logger.debug("value:" + d.toString());
        }
    }

}

public void TestFooBar(){
    Foo<Bar<BigDecimal>> foo = new Foo<Bar<BigDecimal>>();
    Bar<BigDecimal> bar = new BarConcreate();
    foo.t(bar);
} 
```

如果 List 仅填充 BigDecimal，则此 java 编译并运行，如果 List 中有一个整数，则一切正常，我们在行 x.setBazList(l); 上得到一个类转换异常；

我觉得这很有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T08:34:37.577

如果你喜欢，我会这样做：

```
List<Number> l = new ArrayList<Number>();
Number baz = x.makeBaz(null); 
```

希望这可以帮助。

编辑：这也是有道理的：

```
public class Foo<BAR extends Bar<? extends Number>> 
```

# c# - 在泛型方法中将值转换为 T

> ID：856723
> 
> 赞同：20
> 
> 时间：2009-05-13T08:15:21.587
> 
> 标签：c#, generics

我有一个吱吱作响的属性映射的接口：

```
interface IPropertyMap
{
   bool Exists(string key);
   int GetInt(string key);
   string GetString(string key);
   //etc..
} 
```

我想像这样创建一个扩展方法：

```
public static T GetOrDefault<T>(this IPropertyMap map, string key, T defaultValue)
{
    if (!map.Exists(key))
        return defaultValue;
    else
    {
        if (typeof(T) == typeof(int)) return (T)map.GetInt(key);
        //etc..
    }
} 
```

但是编译器不允许我转换为 T。我尝试添加`where T : struct`，但这似乎没有帮助。

我错过了什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-13T08:18:12.143

我相信这是因为编译器不知道它需要执行什么类型的操作。IIRC，如果你介绍拳击，你可以让它工作：

```
if (typeof(T) == typeof(int)) return (T)(object)map.GetInt(key); 
```

但这在性能方面并不理想。

不幸的是，我认为这只是泛型的限制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T08:21:50.437

`GetInt`, `GetString`etc 在内部做什么？使用“对象”索引器可能还有其他选项涉及`Convert.ChangeType(...)`or`TypeDescriptor.GetConverter(...).ConvertFrom(...)`和单个强制转换：

例如，如果对象已经正确键入：

```
public T GetOrDefault<T>(this IPropertyMap map, string key, T defaultValue)
{
    return map.Exists(key) ? (T)map[key] : defaultValue;
} 
```

或者如果它们存储为字符串并需要转换，则涉及：

```
T typedVal = (T) TypeDescriptor.GetConverter(typeof(T)).ConvertFrom(map[key]); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T08:22:56.473

我想这只是一个错字，但`bool GetInt(string key)`看起来很奇怪。应该是`int GetInt(string key)`，或者更好`int GetInt32(string key)`。

接下来，Jon 已经注意到你的代码需要装箱才能工作，所以这就是你要做的。

最后，在你的界面中添加一个“包罗万象”的方法`IPropertyMap`——比如说`object GetValue(string key)`然后重写`GetOrDefault<T>`以利用这个方法，而不是无休止的和容易出错的`Type`比较：

```
else
    return (T)(object)map.GetValue(key); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T05:54:07.783

仅供参考，我发现了另一个具有 GetType() 和 GetAsObject() 方法的接口，它允许我集成这些答案的元素来执行此操作：

```
public static T GetOrDefault<T>(this IInfosContainer container, string key, T defaultValue)
{
    //I just read p273 of C# in Depth, +1 Jon Skeet :)
    if (container == null) throw new ArgumentNullException("container");
    if (container.Exist(key))
    {
        if (container.GetType(key) != typeof(T))
            throw new ArgumentOutOfRangeException("key",
                "Key exists, but not same type as defaultValue parameter");
        else
            return (T)container.GetAsObject(key);
    }
    else
        return defaultValue;
} 
```

（*纯粹主义者会注意到，我不是“支持一个声明”的学校......*）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T07:14:21.243

我不认为这是一个好方法。你无法控制 T 是什么。例如

浮点值 = map.GetOrDefault("blah", 2.0);

也不会编译，因为不能将类型“double”隐式转换为“float”。存在显式转换（您是否缺少强制转换？）另一个失败点是所需的默认值为 null。这种方法让开发人员任由编译器来解决它认为开发人员的意图。

如果您可以更改接口，则添加一个 GetObject 方法。由于您使用的是扩展方法，我假设您不能将其转换为对象然后转换为 int。无论哪种方式，将方法更改为

public static void GetOrDefault(this IPropertyMap map, string key, ref T value) { if (map.Exists(key)) { if (typeof(T) == typeof(int)) { value = (T)(object)map .GetInt(key); } 值 = 默认值（T）；// 这很好，因为我很懒， // 在此处添加真实代码。} } 并像这样调用

```
 PropertyMap map = new PropertyMap();
        float value = 2.0f;
        map.GetOrDefault("blah", ref value); 
```

我讨厌 ref 参数，但我明白了这一点。注册表是这种方法何时有用的经典示例。上面的代码强制开发用户明确指定输出的类型并保留概念默认值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-21T09:29:45.663

我不喜欢双重演员的样子。所以我想出了这个解决方案：

```
public T Get<T>(Guid id) where T : IEntity
{
    object value;

    value = Activator.CreateInstance(typeof(T)) switch
    {
        Vehicle => database.GetVehicles().FirstOrDefault(x => x.Id == id),
        UserAccount => database.GetUserAccounts().FirstOrDefault(x => x.Id == id),
        _ => throw new NotImplementedException("No data for type: " + typeof(T).ToString()),
    };

    return (T)value;
} 
```

如果您不熟悉 switch 表达式，以下是使用 switch 语句的示例：

```
public T Get<T>(Guid id) where T : IEntity
{
    object value;

    switch(Activator.CreateInstance(typeof(T)))
    {
        case Vehicle:
            value = database.GetVehicles().FirstOrDefault(x => x.Id == id);
            break;
        case UserAccount:
            value = database.GetUserAccounts().FirstOrDefault(x => x.Id == id);
            break;
        default:
            throw new NotImplementedException("No data for type: " + typeof(T).ToString());
    }

    return (T)value;
} 
```

PS：如果您正在使用`where T : IEntity`，您可以更改`object value;`为`IEntity value;`

# resharper - Resharper 规则集，我们可以分享它们吗？

> ID：856730
> 
> 赞同：3
> 
> 时间：2009-05-13T08:18:13.093
> 
> 标签：resharper

我在一个小型开发团队工作，我们最近收购了 Resharper。是否可以在一台机器上配置 Resharper 的规则集（例如，禁止 resharper 将所有内容重命名为 "var" ）并将该规则集分发给所有开发人员？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T08:25:26.687

我相信你可以在 Resharper -> Options -> Languages -> Common -> Code Style Sharing 中找到它。

**更新**：在 Resharper 6 中，可以在 Resharper -> 管理选项中找到设置管理...从那里您可以导入/导出设置文件并应用分层配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T08:25:56.903

是的，共享代码样式是很有可能的（您必须更仔细地研究它们在“代码样式”下的含义）。看到[这个](http://geekswithblogs.net/alternativedotnet/archive/2008/10/20/125936.aspx)：

[替代文字 http://geekswithblogs.net/images/geekswithblogs_net/alternativedotnet/WindowsLiveWriter/SharingReSharpersettingsinyourteam_14F1A/shared_code_style_thumb_1.jpg](http://geekswithblogs.net/images/geekswithblogs_net/alternativedotnet/WindowsLiveWriter/SharingReSharpersettingsinyourteam_14F1A/shared_code_style_thumb_1.jpg)

# nhibernate - NHibernate：找出一个属性是否映射到一个字段

> ID：856746
> 
> 赞同：3
> 
> 时间：2009-05-13T08:24:19.107
> 
> 标签：nhibernate, properties, nhibernate-mapping, nhibernate-metadata

有什么方法可以找出属性是否映射到字段。我希望这能生成类似“通用搜索”的东西：

```
 string[] words.
    words = search.Split(' ');
    Type type = typeof(T);

    Disjunction disjunction = new Disjunction();
    foreach (System.Reflection.PropertyInfo property in type.GetProperties())
    {
        if ((property.PropertyType == typeof(string)))
        {

            foreach (string word in words)
            {
                disjunction.Add(
                    Expression.InsensitiveLike(
                        property.Name,
                        "%" + word + "%"));
            }
        }
    } 
```

如果我添加一个未映射到 NHibernate 的属性，则搜索会引发 NHibernate.QueryException，其描述为“无法解析属性：Text1 of: C”

我正在映射这样的属性：

```
class C
{    
    [Property(0, Column = "comment")]
    public virtual string Comment {get; set;}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T08:35:40.617

使用 NHibernate 元数据 API。

```
ISessionFactory sessionFactory;

Type type = typeof(T);
IClassMetadata meta = sessionFactory.GetClassMetadata(type);

Disjunction disjunction = new Disjunction();
foreach (string mappedPropertyName in meta.PropertyNames)
{
    IType propertyType = meta.GetPropertyType(mappedPropertyName);

    if (propertyType == NHibernateUtil.String)
    {
        foreach (string word in words)
        {
            disjunction.Add(
                Expression.InsensitiveLike(
                    mappedPropertyName,
                    "%" + word + "%"));
        }
    }
} 
```

# liferay - Liferay 与 Weblogic 和其他门户服务器相比如何？

> ID：856756
> 
> 赞同：2
> 
> 时间：2009-05-13T08:26:44.360
> 
> 标签：liferay

我需要在 Liferay、Weblogic 和市场上的其他门户服务器之间进行选择吗？有人做过性能测试吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-20T23:16:23.373

不知道你从哪里得到 Liferay 是最好的品种。我实际上已经在许多网站上使用过，我正试图摆脱它。文档真的很糟糕而且过时了，开箱即用的 portlet 是荒谬的。博客和 wikis portlet 不适合任何好的 web2.0 站点，而且该框架相当笨拙而不是很好用。portlet 的配置模式必须使用 liferay 框架开发……祝你好运。它很容易上手，但扩展和使用却是一场噩梦。如果您正在寻找企业门户，请注意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T10:32:17.727

我已经使用了几个，你会发现 Liferay 是最好的品种。它通常最先实施新的行业标准，是最安全的，甚至经过认证可以同时在数千个 CPU 上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:43:34.173

Gartner 曾报告称，WebLogic Portal 在技术方面领先其他所有人 2 年。Verizon、Wells Fargo、Level 3、CitiGroup 等公司都在使用它，他们花了很多钱做功课，看看他们投资了哪些技术。我的专长主要是 WebLogic 门户（完全披露：我曾在BEA Systems 在他们的门户组中），但自从离开后，我一直在使用 LifeRay 和 WebSphere。坦率地说，它们甚至远不及 WebLogic Portal 中的成熟度、技术特性集和易于开发性。

# c# - NHibernate Criteria API 是否支持对集合属性的投影？

> ID：856761
> 
> 赞同：8
> 
> 时间：2009-05-13T08:27:56.527
> 
> 标签：c#, nhibernate, criteria

我需要使用标准 API 复制以下工作 HQL 查询。

```
session.CreateQuery(
    "select c " +
    "from Parent p " +
    "inner join p.Children c " +
    "where p.Id = 9 " +
    "and c.Id = 33")
    .SetMaxResults(3)
    .List(); 
```

该查询选择满足某个条件的所有子代，这些子代属于满足另一个条件的父代。在我的示例中，这两个标准都是简单的 Id 等式，但它们可以是任何东西。

由于某种原因，等效条件 API 查询返回一个包含正确数量的项目的列表，但这些项目都是空的。

```
session.CreateCriteria(typeof (Parent))
    .Add(Restrictions.Eq("Id", 9))
    .CreateCriteria("Children")
    .Add(Restrictions.Eq("Id", 33))
    .SetProjection(Projections.Property("Children"))
    .SetMaxResults(3)
    .List(); 
```

为什么这两个查询不返回相同的结果？

这是从 HQL 查询生成的 SQL：

```
SELECT   TOP 3 childid7_,
               name7_
FROM     (SELECT children1_.childid                 AS childid7_,
                 children1_.name                    AS name7_,
                 Row_number()
                   OVER(ORDER BY current_timestamp) AS __hibernate_sort_row
          FROM   dbo.parent parent0_
                 LEFT OUTER JOIN dbo.child children1_
                   ON parent0_.parentid = children1_.parentid
          WHERE  (parent0_.parentid = 9)
                 AND (children1_.childid = 33)) AS QUERY
WHERE    QUERY.__hibernate_sort_row > 0
ORDER BY QUERY.__hibernate_sort_row 
```

这是来自 Criteria API 查询的 SQL：

```
SELECT   TOP 3 y0_
FROM     (SELECT this_.parentid                     AS y0_,
                 Row_number()
                   OVER(ORDER BY current_timestamp) AS __hibernate_sort_row
          FROM   dbo.parent this_
                 INNER JOIN dbo.child child1_
                   ON this_.parentid = child1_.parentid
          WHERE  this_.parentid = @p0
                 AND child1_.childid = @p1) AS QUERY
WHERE    QUERY.__hibernate_sort_row > 0
ORDER BY QUERY.__hibernate_sort_row 
```

请注意，父子节点之间的连接是单向的。子实体没有指向其父实体的引用属性。

任何人都可以提出一个可以让我解决这个限制的替代方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-24T18:13:44.537

看起来您只希望孩子回来，因此您需要更改标准以获取子对象的类型，然后使用父 ID 作为选择。

```
session.CreateCriteria(typeof (Child))
.Add(Restrictions.Eq("Id", 33))
.CreateCriteria("Parent")
.Add(Restrictions.Eq("Id", 9))
.SetProjection(Projections.Property("Children"))
.SetMaxResults(3)
.List(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-26T07:28:46.957

在此处查看“仅查询”属性[http://ayende.com/Blog/archive/2009/06/10/nhibernate-ndash-query-only-properties.aspx](http://ayende.com/Blog/archive/2009/06/10/nhibernate-ndash-query-only-properties.aspx)

这将允许您使查询的链接看起来是双向的。

# objective-c - [NSString hash] 是否每次都计算？

> ID：856764
> 
> 赞同：15
> 
> 时间：2009-05-13T08:28:27.010
> 
> 标签：objective-c, cocoa

如果我有一个不可变的字符串，那么每次我调用散列时都会运行散列算法，还是它记得值（假设字符串不能改变）？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-13T11:32:39.453

它被重新计算。

-[NSString hash] 实际上是对 -[NSCFString hash] 的调用（由于免费桥接）。

如果您创建一个程序，在同一字符串上调用 -[NSString hash] 并在调用之间中断并更改备份字符串的内存，您将获得重新计算的哈希值。这告诉我不涉及缓存。

```
(gdb) b -[NSCFString hash]
Breakpoint 1 at 0x3b02fa3
(gdb) r
Breakpoint 1, 0x93652fa3 in -[NSCFString hash] ()
(gdb) c
Continuing.
2009-05-13 14:23:39.003 a.out[1754:813] Hash: -327163326 
```

注意哈希值。

```
Breakpoint 1, 0x93652fa3 in -[NSCFString hash] ()
(gdb) bt          
#0  0x93652fa3 in -[NSCFString hash] ()
#1  0x00001f73 in main () at test.m:10
(gdb) fra 1
#1  0x00001f73 in main () at test.m:10
10      NSLog(@"Hash: %d", [m hash]);
(gdb) info locals
pool = (NSAutoreleasePool *) 0x109760
m = (NSString *) 0x2030
(gdb) x/20x 0x2030
0x2030 <dyld__mach_header+32>:  0xa06f54a0  0x000007c8  0x00001fa2  0x00000012 
```

0xa06f54a0 是“isa”指针，0x00001fa2 是指向“XXXXXX”字符串的指针。

```
(gdb) set {int}0x1fa2 = 0x59595959 
```

将“XXXXXX”字符串更改为“YYYYXXXX”，然后继续进行第二个哈希调用

```
(gdb) c
Continuing.
2009-05-13 14:24:35.884 a.out[1754:813] Hash: -246144954 
```

请注意，就 ObjC 所知的不可变字符串而言，哈希值是不同的。

我已经（调试）调试的程序是：

```
#import <Cocoa/Cocoa.h>

int main()
{
    NSAutoreleasePool * pool = [NSAutoreleasePool new];

    NSString * m = [NSString stringWithString:@"XXXXXXXXXXXXXXXXXX"];

    NSLog(@"Hash: %d", [m hash]);
    NSLog(@"Hash: %d", [m hash]);

    [pool release];
} 
```

# c# - 使用 WatiN 脚本将击键（即 Enter Key）传递到应用程序

> ID：856766
> 
> 赞同：13
> 
> 时间：2009-05-13T08:29:39.020
> 
> 标签：c#, watin

我正在使用 WatiN 测试工具。我可以使用 WatiN 脚本向应用程序传递击键（即按下回车键）吗？

此选项在 WatiR 中可用。这个选项在 WatiN 中可用吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T13:29:52.617

**编辑：**经过进一步检查，我发现发送 ENTER 键的标准方式在 WatiN 中不像在 WatiR 中那样工作。您需要使用[System.Windows.Forms.SendKeys](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)

另外，我建议您下载**[WatiN 测试记录器](http://watintestrecord.sourceforge.net/)**。

这是示例代码。

```
using(IE ie = new IE("http://someurl"))
{
  TextField myTxt = ie.TextField(Find.ById("myTextBox")).TypeText("some value");
  System.Windows.Forms.SendKeys.SendWait("{ENTER}");      
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-03-29T10:20:13.360

[学位开发博客](http://blog.degree.no/2012/03/watinpressing-enter-key-in-a-textbox/)上有一篇非常好的博客文章

它解释了如何将 Enter press 添加为扩展方法，如下所示：

```
public static class MyWatiNExtensions
{
    [DllImport("user32.dll")]
    private static extern IntPtr SetFocus(IntPtr hWnd);

    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool SetForegroundWindow(IntPtr hWnd);

    public static void TypeTextQuickly(this TextField textField, string text)
    {
        textField.SetAttributeValue("value", text);
    }

    public static void PressEnter(this TextField textField)
    {
        SetForegroundWindow(textField.DomContainer.hWnd);
        SetFocus(textField.DomContainer.hWnd);
        textField.Focus();
        System.Windows.Forms.SendKeys.SendWait("{ENTER}");
        Thread.Sleep(1000);
    }
} 
```

这使得在测试中按 Enter 键变得非常容易。

```
browser.TextField("txtSearchLarge").PressEnter(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-05T13:06:46.860

```
var textUrl = ie.TextField("txtUrl");
textUrl.Focus();
textUrl.TypeText("www.mydomain.com");
Thread.Sleep(3000);
textUrl.KeyDown((char)Keys.Down);
textUrl.KeyDown((char)Keys.Down);
textUrl.KeyDown((char)Keys.Enter); 
```

你必须使用`System.Windows.Forms`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-16T20:29:37.457

为什么不只做以下事情？

```
using(IE ie = new IE("http://someurl"))
{
  TextField myTxt = ie.TextField(Find.ById("myTextBox")).TypeText("some value");
  TextField.KeyPress('\r');   \\ \r is a carriage return   
} 
```

为我正在使用 Watin 开发的测试工作

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-14T15:50:51.540

只要浏览器有焦点，上面的答案就可以正常工作，如果没有，则 SendKeys.SendWait 会触发任何有焦点的应用程序。

```
ie.Eval("var e = $.Event('keydown');e.which = $.ui.keyCode.ENTER;$('#myTextBox').trigger(e);"); 
```

虽然有点笨拙，但无论如何这都会触发输入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-18T20:48:51.227

试试这个：

```
//  This method is designed to simulate an end-user pressing the ENTER key.
private void CheckKeys(object sender, KeyPressEventArgs e)
{
    //  Set the key to be pressed; in this case, the ENTER key.
    if (e.KeyChar == (char)13)
    {
        //  ENTER key pressed.
        e.Handled = true;
    }
} 
```

然后，当您需要模拟按下的 ENTER 键时，只需调用此方法即可。

# c# - 嵌套用户控件中的链接按钮未触发命令事件

> ID：856767
> 
> 赞同：1
> 
> 时间：2009-05-13T08:29:54.073
> 
> 标签：c#, asp.net, events, user-controls, linkbutton

我有一个嵌套的`UserControl`（这个控件是由另一个`UserControl`由 MasterPage 内的 aspx 页面动态加载的控件动态加载的），我想在其中使用一个`LinkButton`和`OnCommand`事件。

这个按钮必须添加到某个面板，所以我连接到`OnLoad`面板的事件（它需要在生命周期中触发事件之前创建）：

```
protected void PatentAssignee_Load(object sender, EventArgs e) {
    Label label = (Label)sender;

    LinkButton link = new LinkButton();
    link.Text = name;
    link.Command += Link_OnCommand;
    link.CommandArgument = "argument";
    link.ID = "someID";

    label.Controls.Add(link)
}

protected void Link_OnCommand(object sender, CommandEventArgs e) {
    Response.Write(e.CommandArgument);
} 
```

但我无法调用 Link_OnCommand 方法。我与此问题相关的另一件事是：UserControl 在 UpdatePanel 中。我还尝试使链接触发完整的回发：

```
ScriptManager s = (ScriptManager)this.Page.Master.FindControl("__scriptManager");
s.RegisterPostBackControl(link); 
```

...但变化不大，页面已完全重新加载，但没有触发任何事件。

编辑：根据评论中的要求，这里有更多关于嵌套的详细信息：

```
MasterPage
  PlaceHolder
    Page
      UpdatePanel
        UserControl1
          FormView
            PlaceHolder
              UserControl2
                LinkButton 
```

这意味着它`UserControl2`是动态加载的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-21T09:12:52.847

层次结构中的一个控件缺少 ID。设置 ID，事件将触发。这也会对 AjaxControlToolkit 造成严重破坏（确保每个扩展程序都有一个 ID，否则客户端行为通常无法加载）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T08:37:25.060

我记得也有这个问题。我没有找到真正的问题，但我所做的是将事件处理程序连接到 aspx 标记中并且它起作用了。

您也可以尝试在页面生命周期的某个早期阶段挂钩事件处理程序。

试试 PreInit 事件处理程序。

有关页面生命周期的更多信息，请[点击此处](http://msdn.microsoft.com/en-us/library/ms178472.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-22T03:53:34.023

对于ajax，我认为你可以创建一个可重用的类

```
public void registerUCAsyncPostBack(Page page, WebControl webcontrol, UserControl usercontrol){
            Control ControlAjaxNew = null;
            if (webcontrol.GetType() == typeof(LinkButton))
            {
                ControlAjaxNew = (LinkButton)usercontrol.FindControl(webcontrol.ID);
            }
            ScriptManager.GetCurrent(page).RegisterAsyncPostBackControl(ControlAjaxNew);
        } 
```

# python - 标记模块

> ID：856769
> 
> 赞同：1
> 
> 时间：2009-05-13T08:31:23.337
> 
> 标签：python, tokenize

请帮忙

模块标记化中有许多标记，如 STRING、BACKQUOTE、AMPEREQUAL 等。

```
>>> import cStringIO
>>> import tokenize
>>> source = "{'test':'123','hehe':['hooray',0x10]}"
>>> src = cStringIO.StringIO(source).readline
>>> src = tokenize.generate_tokens(src)
>>> src
<generator object at 0x00BFBEE0>
>>> src.next()
(51, '{', (1, 0), (1, 1), "{'test':'123','hehe':['hooray',0x10]}")
>>> token = src.next()
>>> token
(3, "'test'", (1, 1), (1, 7), "{'test':'123','hehe':['hooray',0x10]}")
>>> token[0]
3
>>> tokenize.STRING
3
>>> tokenize.AMPER
19
>>> tokenize.AMPEREQUAL
42
>>> tokenize.AT
50
>>> tokenize.BACKQUOTE
25 
```

这就是我尝试过的。但我无法找到它们的意思？

从哪里我会明白这一点。我需要一个立即的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T08:52:08.310

各种 AMPER、BACKQUOTE 等值对应于 python 标记/运算符的适当符号的标记编号。即 AMPER = &（与号），AMPEREQUAL = "&="。

但是，您实际上不必关心这些。它们由内部 C 标记器使用，但 python 包装器简化了输出，将所有运算符符号转换为`OP`标记。您可以使用令牌模块的 tok_name 字典将符号令牌 ID（每个令牌元组中的第一个值）转换为符号名称。例如：

```
>>> import tokenize, token
>>> s = "{'test':'123','hehe':['hooray',0x10]}"
>>> for t in tokenize.generate_tokens(iter([s]).next):
        print token.tok_name[t[0]],

OP STRING OP STRING OP STRING OP OP STRING OP NUMBER OP OP ENDMARKER 
```

作为更好地描述令牌的快速调试语句，您还可以使用 tokenize.printtoken。这是未记录的，并且看起来它在 python3 中不存在，因此不要依赖它来生成生产代码，但作为对令牌含义的快速浏览，您可能会发现它很有用：

```
>>> for t in tokenize.generate_tokens(iter([s]).next):
        tokenize.printtoken(*t)

1,0-1,1:        OP      '{'
1,1-1,7:        STRING  "'test'"
1,7-1,8:        OP      ':'
1,8-1,13:       STRING  "'123'"
1,13-1,14:      OP      ','
1,14-1,20:      STRING  "'hehe'"
1,20-1,21:      OP      ':'
1,21-1,22:      OP      '['
1,22-1,30:      STRING  "'hooray'"
1,30-1,31:      OP      ','
1,31-1,35:      NUMBER  '0x10'
1,35-1,36:      OP      ']'
1,36-1,37:      OP      '}'
2,0-2,0:        ENDMARKER       '' 
```

您为每个令牌返回的元组中的各种值按顺序排列：

1.  令牌 ID（对应于类型，例如 STRING、OP、NAME 等）
2.  字符串 - 此标记的实际标记文本，例如“&”或“'a string'”
3.  输入中的开始（行、列）
4.  输入中的结尾（行、列）
5.  令牌所在行的全文。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T08:43:01.573

您需要阅读 python 的代码[tokenizer.c](http://svn.python.org/view/python/trunk/Parser/tokenizer.c?revision=65543&view=markup)以了解详细信息。只需搜索您想知道的关键字。应该不难。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T08:44:21.710

Python 的词法分析（包括标记）记录在[http://docs.python.org/reference/lexical_analysis.html](http://docs.python.org/reference/lexical_analysis.html)。正如[http://docs.python.org/library/token.html#module-token](http://docs.python.org/library/token.html#module-token)所说，“有关语言语法上下文中名称的定义，请参阅 Python 发行版中的文件 Grammar/Grammar。”。

# tsql - 如何从 T-SQL 中的两个子查询中获取项目的排列？

> ID：856770
> 
> 赞同：1
> 
> 时间：2009-05-13T08:31:24.197
> 
> 标签：tsql, permutation

假设我有两个子查询：

```
SELECT Id AS Id0 FROM Table0

=>

Id0
---
1
2
3

and

SELECT Id AS Id1 FROM Table1

=>

Id1
---
4
5
6 
```

我如何结合这些来获得查询结果：

```
Id0 Id1
-------
1   4
1   5
1   6
2   4
2   5
2   6
3   4
3   5
3   6 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T08:33:11.510

笛卡尔连接，无连接条件的连接

```
select id0.id as id0, id1.id as id1 
from id0, id1 
```

或者，如果您愿意，也可以使用 CROSS JOIN 语法

```
select id0.id as id0, id1.id as id1 
from id0 cross join id1 
```

如果你想要一个特定的订单，你可以订购你的查询，从你的例子来看，它看起来像你想要的

```
select id0.id as id0, id1.id as id1
from id0 cross join id1 order by id0.id, id1.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T08:35:40.040

试试这个 ：

```
SELECT A.Id0, B.Id1
FROM (SELECT Id AS Id0 FROM Table0) A, 
     (SELECT Id AS Id1 FROM Table1) B 
```

格雷瓜尔

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-22T09:06:06.467

SELECT Table0.Id0, Table1.Id1 FROM Table0 在 1=1 上完全连接 Table1

# java - 如何创建包含 Tomcat 和 MySQL 的 Java webapp 安装程序 (.exe)？”

> ID：856772
> 
> 赞同：16
> 
> 时间：2009-05-13T08:31:56.583
> 
> 标签：java, tomcat, installation, web-applications

如何使用结合了tomcat、mysql和war文件的Java创建安装程序并输出最终的exe？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-13T08:53:42.520

你可以使用任何安装程序，真的。我个人使用过[InnoSetup](http://www.innosetup.com/isinfo.php)，它非常简单，但在安装时仍然可以执行几乎任何任务。

在您的情况下，您可能希望将 Tomcat 文件放在某个地方，包括 webapp。自定义一些配置文件并以静默模式运行 MySQL 安装程序。所有这些都可以通过 InnoSetup 完全实现。

如果您需要更大的灵活性，您可以查看[NSIS](http://nsis.sourceforge.net/Main_Page)，这是另一个非常简单但非常强大的安装程序应用程序。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-13T08:42:04.740

可能的选项已经在几个问题中得到了广泛的介绍，尤其是：

*   [分发 Java 应用程序的最佳方式是什么？](https://stackoverflow.com/questions/80105/whats-the-best-way-to-distribute-java-applications)
*   [java最好的安装工具是什么？](https://stackoverflow.com/questions/173392/what-is-the-best-installation-tool-for-java)
*   [安装 Java EE 应用程序有哪些好的 InstallAnywhere 替代品？](https://stackoverflow.com/questions/759855/what-are-good-installanywhere-replacements-for-installing-a-java-ee-application)

...和其他[标记为 java + 安装程序的问题](https://stackoverflow.com/questions/tagged/java+installer)

尽管这些问题中提到的一些选项不能产生自给自足的 .exe 安装程序，但不可否认。如果商业工具适合你，我个人可以推荐[install4j](http://www.ej-technologies.com/products/install4j/overview.html)（成本 $）；除其他外，它可以创建 .exe 安装程序（[有关我使用它的经验的详细信息](https://stackoverflow.com/questions/759855/what-are-good-installanywhere-replacements-for-installing-a-java-ee-application/786307#786307)）。或者，有关从 Java 程序生成 Windows 可执行文件的更简单、免费的工具，请参阅[Launch4j](http://launch4j.sourceforge.net/)。

*根据 OP 的评论*更新我的 install4j 建议：**

 *> 是的，exe安装程序需要一次安装tomcat、mysql、web应用程序和db脚本。最后，用户只需要启动tomcat和mysql服务即可。转到浏览器可以访问 Web 应用程序。

使用 install4j，

*   你可以很好地捆绑 Tomcat、MySQL 和你的 webapp
*   您也可以从安装程序自动启动服务（或按照您的建议将其留给用户）
*   如果您愿意，安装程序甚至可以直接启动浏览器并将其指向您的 webapp :-)

我刚刚用 install4j 做了类似的事情（捆绑应用程序服务器、webapp、运行数据库脚本和许多其他东西；但是没有捆绑数据库），所以我相对确定它可以完成。我不知道您是否可以（轻松地）使用 Launch4j 等免费工具来做到这一点。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-06-27T08:16:55.223

这是我对这个问题的简约解决方案。我已经下载了没有安装程序的 tomcat 和 MySQL 安装，所以我只是解压缩了它们，我试了一下它们工作正常。此时您将安装war文件到tomcat，并将相关架构安装到mysql。因此，当您复制文件夹时，所有内容都会被复制。你可以测试它是如何工作的。也许您可以对它们进行一些调整，但对我来说，它们开箱即用就可以正常工作，因为我的应用程序要求不高。除此之外，我已经下载了 32 位和 64 位版本的程序，因此它们都可以安装。我使用 Inno setup 打包安装程序。基本上它只通过选择 32 或 64 架构复制两个文件夹，并将 tomcat 和 mysql 都安装为 Windows 服务。

```
[Setup]
AppName=MyApp
AppVersion=1.0
DefaultDirName={pf}\MyApp
DefaultGroupName=MyApp
Compression=lzma2
SolidCompression=yes
OutputDir=output   
; "ArchitecturesInstallIn64BitMode=x64" requests that the install be
; done in "64-bit mode" on x64, meaning it should use the native
; 64-bit Program Files directory and the 64-bit view of the registry.
; On all other architectures it will install in "32-bit mode".
ArchitecturesInstallIn64BitMode=x64
; Note: We don't set ProcessorsAllowed because we want this
; installation to run on all architectures (including Itanium,
; since it's capable of running 32-bit code too).

[Files]              
; Install x64 if running in 64-bit mode (x64; see above), x86.exe otherwise.   
Source: "mysql-5.5.13-winx64\*.*"; DestDir: "{app}\mysql"; Check: Is64BitInstallMode; Flags: ignoreversion recursesubdirs createallsubdirs 
Source: "mysql-5.5.13-win32\*.*"; DestDir: "{app}\mysql"; Check: not Is64BitInstallMode; Flags: ignoreversion recursesubdirs createallsubdirs  
; Install x64 if running in 64-bit mode (x64; see above), x86.exe otherwise.   
Source: "apache-tomcat-6.0.32-x64\*.*"; DestDir: "{app}\tomcat"; Check: Is64BitInstallMode; Flags: ignoreversion recursesubdirs createallsubdirs 
Source: "apache-tomcat-6.0.32-x86\*.*"; DestDir: "{app}\tomcat"; Check: not Is64BitInstallMode; Flags: ignoreversion recursesubdirs createallsubdirs
;   
Source: "start.bat"; DestDir: "{app}"; DestName: "start.bat"; 
Source: "stop.bat"; DestDir: "{app}"; DestName: "stop.bat"; 

[Icons]    
Name: "{group}\Start MyApp"; Filename: "{app}\start.bat"
Name: "{group}\Stop MyApp"; Filename: "{app}\stop.bat"

[Run]     
; install mysql and tomcat as services
Filename: "{app}\mysql\bin\mysqld.exe"; Parameters: "--install MyApp_MySQL"
Filename: "{app}\tomcat\bin\service.bat"; Parameters: "install"   
Filename: "{app}\start.bat"; Description: {cm:LaunchProgram,{cm:AppName}}; Flags: nowait postinstall skipifsilent

[UninstallRun]   
; uninstall mysql and tomcat as services  
Filename: "{app}\stop.bat";
Filename: "{app}\mysql\bin\mysqld.exe"; Parameters: "--remove MyApp_MySQL" 
Filename: "set"; Parameters: "CATALINA_HOME={app}\tomcat"
Filename: "{app}\tomcat\bin\tomcat6.exe"; Parameters: "//DS//MyApp_Tomcat"

[CustomMessages]
AppName=MyApp
LaunchProgram=Start MyApp after finishing installation 
```

为了现在运行您的应用程序，您只需要启动/停止注册服务。开始.bat

```
NET START MyApp_MySQL
NET START MyApp_Tomcat
START "" "http://localhost:8080/myapp/" 
```

停止.bat

```
NET STOP MyApp_MySQL
NET STOP MyApp_Tomcat 
```

对我来说它工作得很好。

*   也许您也可以包括 JRE 安装，因为某些组合可能没有它。
*   另外，如果有人知道如何检查 tomcat 和 mysql 端口是否已被占用，以及如何在 conf 文件中更改它们，请告诉我们。
*   此外，如果您可以检查 IP 地址并键入它而不是 localhost，那就太好了。

问候

阿米尔

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T08:37:01.347

我建议您为此使用 Java，installer.jar。由于您无论如何都想运行tomcat，因此无需放入exe文件。我们已经做了类似的事情，在 Ant API 的帮助下编写了一个 jar 安装程序（Ant 以编程方式使用）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-04T12:51:49.783

您可以为此使用[BitRock InstallBuilder](http://installbuilder.bitrock.com)（成本 $）。[对于此类程序的示例，请在BitNami](http://bitnami.org/stacks/)上查看 Alfresco、Liferay 等应用程序安装程序，包括 Tomcat、MySQL 等

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-19T19:07:07.010

更好的方法是使用[IzPack](http://izpack.org/)，它比其他方法更好，因为它只需要打包一次，并且可以在任何具有相同编译 jar 的操作系统上使用。

我个人用它来打包我的 web 应用程序的 tomcat、mysql 和其他一些先决条件。

我使用[Launch4J](http://launch4j.sourceforge.net/)从 IzPack 生成的 jar 文件创建可执行文件（.exe）。

# oracle - Oracle 导出：ORA-31600：函数 SET_TRANSFORM_PARAM 中参数 NAME 的输入值无效 EMIT_SCHEMA

> ID：856773
> 
> 赞同：1
> 
> 时间：2009-05-13T08:32:26.283
> 
> 标签：oracle

我试图导出一个 oracle 数据库的 .dmp，但是当我运行 exp 命令时出现以下错误

ORA-31600: 函数 SET_TRANSFORM_PARAM 中参数 NAME 的无效输入值 EMIT_SCHEMA

这是我自设置后第一次尝试从该服务器导出。我需要做些什么才能让导出以正确的方式运行。

我的完整解决方案是（WINDOWS 机器）

1) 在 C:\Oracle\Ora92\rdbms\admin 打开命令提示符

2) 以 sysdba 身份登录到 sqlplus，要在命令提示符下执行此操作，您需要执行命令 sqlplus "sys as sysdba"

3) 运行 catexp.sql - 这消除了一些错误（在命令提示符下运行类型 @@catexp.sql）

4) 运行 catproc.sql

5) 运行 catmeta.sql 这需要关闭 oracle，运行补丁并重新启动，如下所述。

1) 登录 sqlpus sysdba 2) 立即关机；3）启动迁移；4)@@catpatch.sql; 5）立即关机；6）启动；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T15:12:08.380

您使用的是哪个版本的 Oracle？如果未正确应用补丁集，9.2 版会出现以下问题：

```
Symptom(s)
~~~~~~~~~~
You are performing a database export against your 9.2 database.  The database 
export abnormally ends with the following errors:

EXP-00056: ORACLE error 31600 encountered
ORA-31600: invalid input value EMIT_SCHEMA for parameter NAME in function 
SET_TRANSFORM_PARAM
ORA-06512: at "SYS.DBMS_SYS_ERROR", line 105
ORA-06512: at "SYS.DBMS_METADATA_INT", line 3926
ORA-06512: at "SYS.DBMS_METADATA_INT", line 4050
ORA-06512: at "SYS.DBMS_METADATA", line 836
ORA-06512: at line 1
EXP-00000: Export terminated unsuccessfully 
```

这在 Metalink 文档 ID 257986.1 中有详细说明。

除非您正在运行 RAC，否则修复方法是运行 /rdbms/admin/catpatch.sql。可能的原因是未完全应用的补丁集。您可能需要处于受限模式。

# c# - 在 C# 3.0 中，我们使用 "var" 在 C# 2.0 中它的替代方案是什么？

> ID：856780
> 
> 赞同：2
> 
> 时间：2009-05-13T08:33:59.900
> 
> 标签：c#, c#-3.0, mef, var

我正在使用 Managed Extensibility Framework (MEF) 在 .Net 中学习可插入架构。我在网上看到了示例代码，但是当我尝试实现它时，我一度陷入困境。

该代码正在使用：

```
 var catalog = new AttributedAssemblyPartCatalog(Assembly.GetExecutingAssembly());
 var container = new CompositionContainer(catalog.CreateResolver()); 
```

这`var`在 C# 3.0 上可用，因为我在 C# 2.0 中编码。

以上两种说法的替代方案是什么？如何使用 VS 2005 使它们在 c# 2.0 中工作？

* * *

我现在试过这个bt它的说法

错误 1**​​找不到类型或命名空间名称“AttributedAssemblyPartCatalog”（是否缺少 using 指令或程序集引用？）** C:\Documents and Settings\test\Desktop\MEFDemo\MEFDemo\Program.cs 31 13 MEFDemo

我在哪里添加了对 SystemComponentModel.Composition 的引用

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T08:38:12.703

基本上，`var`强制编译器根据变量的“初始化程序”来确定（推断）变量的*编译时*`=`类型——实际上是从符号向右的表达式。这里的类型很明显：

```
AttributedAssemblyPartCatalog catalog = 
    new AttributedAssemblyPartCatalog(Assembly.GetExecutingAssembly());
CompositionContainer container = 
    new CompositionContainer(catalog.CreateResolver()); 
```

并确保添加`using System.ComponentModel.Composition;`声明。另外，请注意`AttributedAssemblyPartCatalog`已重命名为`AssemblyCatalog`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T08:36:20.723

```
AttributedAssemblyPartCatalog catalog = new 
    AttributedAssemblyPartCatalog(Assembly.GetExecutingAssembly());

CompositionContainer container = new 
    CompositionContainer(catalog.CreateResolver()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T08:43:03.413

C# 中的变量仍然是强类型的。`var`是隐式键入 - 请参阅[MSDN](http://msdn.microsoft.com/en-us/library/bb383973.aspx)。

在大多数情况下，这只是意味着您必须少输入，但在某些情况下是必要的 - 在我链接到的页面上的第二个示例中：

> `var`必须使用，因为结果是匿名类型的集合，并且除了编译器本身之外，无法访问该类型的名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T08:47:26.587

这是 C# 3.0 中类型推断的使用。

使用关键字时

```
var 
```

在 c# 3.0 中，编译器推断类型。见[斯科特·古思里斯的解释](http://weblogs.asp.net/scottgu/archive/2007/05/15/new-orcas-language-feature-anonymous-types.aspx)

在 c# 2.0 中，您必须声明变量的类型与 c# 1.1 相同

例如

```
Type variableName = new Type(); 
```

让你上面的代码示例

```
AttributedAssemblyPartCatalog catalog = new AttributedAssemblyPartCatalog(Assembly.GetExecutingAssembly());

CompositionContainer container = new CompositionContainer(catalog.CreateResolver()); 
```

高温高压

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T08:41:43.883

*var*是 C# 3.0 关键字，除了从初始化值推断强类型外，什么也不做。

在没有 var 的情况下，您手动执行编译器在幕后执行的操作；您在声明中指定变量的类型。

因此;

```
AttributedAssemblyPartCatalog catalog = new 
    AttributedAssemblyPartCatalog(Assembly.GetExecutingAssembly());

CompositionContainer container = new 
    CompositionContainer(catalog.CreateResolver()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T18:23:32.793

MEF 使用 LINQ，因此需要 .NET 3.5。尝试在 .NET 2.0 上使用它不会有任何运气。

# view - 如何将 Lotus 视图限制为某些文件夹的内容？

> ID：856786
> 
> 赞同：1
> 
> 时间：2009-05-13T08:35:18.793
> 
> 标签：view, designer, lotus-notes, lotus-domino, lotus

我正在尝试创建一个视图来选择所有未读邮件，这些邮件也属于特定的文件夹和子文件夹列表。

我通过复制现有的“查看未读”视图创建了一个视图，但是尽管我在文档和谷歌中进行了研究，但我对如何将视图的内容限制为文件夹列表中的文档感到茫然。文件夹列表可以硬编码，更好的是只需要提供顶级文件夹名称。

文件夹结构如下： mailer-daemon alerts app1 prod rec dev app2 prod rec dev

我希望视图限制为 app1/prod 和 app2/prod。这是莲花笔记 6.5.4 CCH6

未读公式如下所示（并且工作正常）：

```
SELECT @IsNotMember("A"; ExcludeFromView) & IsMailStationery != 1 & Form != "Group" & Form != "Person" 
```

如何限制它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T09:28:46.583

我不认为这是可能的。文件夹成员资格不是文档中的属性，并且由于您无法在 SELECT 公式中执行 @dblookup，因此您无法在视图构建期间检查文件夹中是否存在文档。

如果您可以控制将文档分类到文件夹中的过程，则可以在文档上标记一些值并将其用于选择 - 或者将文档添加到“全局”文件夹并使用它而不是视图。

# firefox - 混合代码在 FF 中不起作用

> ID：856787
> 
> 赞同：0
> 
> 时间：2009-05-13T08:35:34.970
> 
> 标签：firefox, forms, doctype

我知道这个页面是不同事物的混搭，并且违反了许多规则，但在制作新的测验系统之前，它是一个短期解决方案。我在另一个站点上做了这个测验系统，它可以工作，但是当把它带到这个站点时，FF3（可能是其他站点）已经停止提交代码。从那以后我发现这是因为文档类型。任何人都可以建议如何让它再次运行，请记住，如果我将 docotype 更改为通常的 4.01 过渡版，该网站将在 ie6 中变为 bunta :( [http://abc.net.au/news/btn/quiz/index.html。 html?file=js/2009-08sugaryinventions.js](http://abc.net.au/news/btn/quiz/index.html?file=js/2009-08sugaryinventions.js)

我知道这是一个非常模糊的问题，但我认为它与表单/输入提交组合有关......

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T08:55:11.860

我知道这是一个混乱的问题，所以感谢那些（你们 12 个人）至少看过 :) 答案在于需要完全声明 js 中的所有变量：

`buttons.style.display='none';`

到

`document.getElementById("buttons").style.display='none';`

感谢工作中帮助我的人。

# vb.net - 通过 FileInfo 访问笔式驱动器（MP3 播放器）？

> ID：856788
> 
> 赞同：1
> 
> 时间：2009-05-13T08:35:38.760
> 
> 标签：vb.net, filesystems

我的计算机上连接了三星 Q1，我希望使用 FileInfo / DirectoryInfo 对象来访问设备上的文件，但是我在 Windows 资源管理器中右键单击文件，我得到了 COMPUTER/Q1 的位置/DATACASTS/mine.mp3，当我将其输入 DirectoryInfo 对象时，我得到“无效的网络驱动器”

有些东西告诉我我的方法是错误的......我应该使用不同的对象，还是我的位置字符串格式不正确

提前致谢

# jquery - 滚动查看更多脚本——如何？

> ID：856792
> 
> 赞同：4
> 
> 时间：2009-05-13T08:35:42.473
> 
> 标签：jquery, load, scroll

如果您查看[http://soup.io](http://soup.io)或[http://hashtags.org](http://hashtags.org)并一直向下滚动，您将看到页面在您到达底部时如何自动加载更多信息。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T08:42:49.997

这可以使用[Scroll Event](http://docs.jquery.com/Events/scroll)来实现，进行[Ajax 调用](http://docs.jquery.com/Ajax)并将生成的 HTML 附加到 DIV 的内容中。

以下是有关如何执行此操作的更多信息：[load-content-while-scrolling-with-jquery](http://www.webresourcesdepot.com/load-content-while-scrolling-with-jquery/)

# cocoa - 使用 NSWindowController 加载 NIB 文件不会设置窗口或顶级对象

> ID：856808
> 
> 赞同：10
> 
> 时间：2009-05-13T08:38:34.933
> 
> 标签：cocoa, interface-builder

我有一个使用 NSWindowController initWindowNibName 加载的 NIB 文件。NIB 文件包含一个 NSWindow。它的文件所有者属于 NSWindowController 类。我已将文件所有者的窗口插座连接到窗口。

当我加载 NIB 时，[windowController window] 为 nil，顶级对象数组也是如此。但是，我仍然可以调用 [windowController showWindow:nil] 并成功显示窗口​​。

这里似乎有些不对劲。我已经确认连接和文件所有者是好的。事实上，当我在调试器中查看 windowController 实例的 _owner 值时，我看到它像我预期的那样指向自身。

关于可能发生的事情有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T18:38:29.087

当你说`[windowController window]`是 nil 时，你如何确定这个？`-window`直到第一次调用NIB 才真正加载。因此，如果您正在查看调试器，您将看到`_window`nil，直到您调用`showWindow:`. 之后，`_window`应该有一个非零值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T09:58:25.740

你有继承 NSWindowController 吗？

当我这样做时，我使用一个名为 MyWindowController 的 NSWindowController 并调用`initWithWindowNibName:`子类的`init`

然后，将 File's Owner 设置为指向 MyWindowController 类。

# xml - 其他 ColdFusion XML 操作函数/库

> ID：856809
> 
> 赞同：1
> 
> 时间：2009-05-13T08:40:54.227
> 
> 标签：xml, coldfusion

在我看来，ColdFusion 8 中的 XML 操作函数不像操作数组和结构的函数那样成熟。您对其他功能/标签有什么建议吗？这些功能/标签可以更直接地操作已解析的 XML 文档？（我遇到过[XML2Struct](http://xml2struct.riaforge.org/)但由于我要将操纵的 XML 写回文件，我宁愿不转换它然后必须转换回来）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T12:46:55.887

[您可能会在cflib.org](http://www.cflib.org/)上找到一些要使用的函数。

[Ben Nadel](http://www.bennadel.com/blog/recent-blog-entries.htm)有很多关于 xml 操作的博客文章，并且可能会提供很多关于使用 ColdFusion 的 xml 函数的技巧，超出您的想象。

另一种选择是通过使用 createObject("java","some.java.class") 进入 java 并操作 xml。我相信你可以在 java api 中找到你需要的任何东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T16:02:38.297

阿利斯塔，

Jayson 有很好的建议，真的很棒，但我还有另一个建议 - 在 ColdFusion 解析的 XML 对象中，您可以将数据视为结构和数组 - 无论如何，它们本质上就是这样，只是以 XML 方式排列。StructCount、structInsert、structDelete、arrayLen、arrayAppend、arrayDeleteAt 等。它们都适用于 XML 节点。

不过，我同意 CF 的 XML 工具缺乏成熟度。似乎它缺少 CF 如此擅长的简单的令人惊叹的因素。

高温高压

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T21:37:51.323

我知道您说过您不想将 XML 转换为可用对象，然后再将其转换回来，但由于我们讨论的是主题，我想我会为您提到的两个类似于 XML2Struct 的应用程序发布一个插件。

我过去曾使用过[XMLToAnything](http://xmltoanything.riaforge.org/)（以及它的伴侣[AnyToXML](http://anythingtoxml.riaforge.org/)）并取得了巨大的成功。

# oracle - 在Oracle中查找字符串的最后一个索引

> ID：856817
> 
> 赞同：74
> 
> 时间：2009-05-13T08:42:27.923
> 
> 标签：oracle, string

我需要`-`在另一个字符串中（例如`JD-EQ-0001`在 Oracle 的 SQL（*版本 8i*`INSTR()` ）中找到一个字符串的最后一个索引（例如）。有没有办法用其他函数来做到这一点？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2009-05-13T08:46:30.270

使用 -1 作为起始位置：

```
INSTR('JD-EQ-0001', '-', -1) 
```

# java - 进口的实施

> ID：856821
> 
> 赞同：1
> 
> 时间：2009-05-13T08:43:03.180
> 
> 标签：java, import, implementation

首先，我不是 Java 人，但我发现表面上看起来与导入的工作方式不一致。

假设你有一个文件，在这个文件中你有你的 main 函数，并且你还定义了一个类**Foo**，现在一个不同的**Foo**实现也存在于一个包中。假设您想在您的功能中使用这两个版本。

您不能从它的包中显式导入**Foo**，即*import mypackage.Foo;*

由于这将导致与文件中本地定义的类发生冲突，因此在编译时会产生错误。

你**可以**做的是导入整个包，即*import mypackage.*；*

这将起作用，您可以使用完全限定名称访问**Foo**，使用简单名称将导致使用本地**Foo**。我看到的不一致之处在于，虽然前者会产生错误（您已经导入了一个类，并且导入的唯一目的是能够使用简单名称而不是完全限定名称），但后者甚至不会导致警告.

我原以为这两种情况都会产生警告，即您可能使用了错误的类，因为它在 2 个地方定义，或者 import 语句是多余的，因为使用简单名称将解析为本地定义的类，而不是导入的一。

所以我的问题是：以这种方式实施是否有根本原因？

是的，这是一个异常情况，我明白这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T08:45:42.020

即使不导入 mypackage.*，您也可以使用完全限定名称访问 Foo；

关于警告：我想没有什么危险的事情发生。你没有使用任何模棱两可的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T09:17:16.087

`Foo`正如上面的答案所说，导入实际上对另一个包中的没有任何作用；无论您是否导入，*都不能通过*短类名引用其他 Foo ，您*可以*通过完全限定的类名引用它。

从概念上讲，您`import mypackage.*`不一定可以将其视为“从“导入所有类`mypackage`”，而可​​以认为“从“导入所有非冲突类`mypackage`”。我不知道 Sun 的编译器实现是如何做到的，但它肯定会决定不匹配 mypackage.Foo 作为通配符的一部分（因此根本不导入它），并且代码将以任何方式工作。

导入实际上只是设置一个从短类名到完全限定类名的别名（例如，当我说`Date`解释为时`java.util.Date`）。如果你做了一些完全多余的事情，比如只导入冲突的类，你会收到警告。但是，如果您使用 拉入整个包`*`，编译器抱怨其中一个类名发生冲突对我来说似乎是错误的。这在实践中经常发生，并且在 99% 以上的情况下都是无害的，以至于它会产生“狼来了的男孩”综合症，以至于你不太可能注意这些和其他警告，因为你只是习惯被他们轰炸。

顺便说一句，如果你同时导入`java.util.*`and `java.sql.*`，这是允许的，它本身不会导致任何警告；但是，如果您尝试仅引用`Date`（在本地包中没有这样的类），您将收到编译错误，因为名称不明确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T11:21:51.920

您可以将“import p.*”视为“当您无法解析当前文件中的名称时，尝试在包 p 中解析它”。编译器在看到 import 语句时不会导入*p中的所有内容。*相反，当它找到一个在直接编译单元中无法解析的名称时，它会在*p （以及 import ...* 语句中命名的其他包）中查找。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T09:16:04.607

对于 mypackage 中的所有其他内容，import mypackage.* 可能是必需的。如果有警告，则根本很难避免，即您必须完全限定您在 mypackage 中使用的所有其他类等。更糟糕的是，考虑 mypackage 版本 1 不包含 Foo 的情况，因此没有冲突，因此根本没有理由发出警告。版本 2 包含 Foo，但它当然不是您要在程序中访问的 Foo。因此，如果编译器警告“import package.*”冲突，它会使“import package.*”潜在地降低向上兼容性。

# c - 线程安全与可重入

> ID：856823
> 
> 赞同：93
> 
> 时间：2009-05-13T08:43:13.957
> 
> 标签：c, thread-safety, reentrancy

最近，我问了一个问题，标题为[“malloc线程安全吗？”](https://stackoverflow.com/questions/855763/malloc-thread-safe) ，在里面我问，“malloc 是可重入的吗？”

我的印象是所有可重入都是线程安全的。

这个假设是错误的吗？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2015-10-30T22:34:32.937

*TL;DR：一个函数可以是可重入的、线程安全的，或者两者都不是。*

[关于线程安全](https://en.wikipedia.org/wiki/Thread_safety)和[重入](https://en.wikipedia.org/wiki/Reentrancy_(computing))的维基百科文章非常值得一读。以下是一些引文：

如果满足以下条件，则函数是**线程安全的**：

> 它仅以保证多个线程同时安全执行的方式操作共享数据结构。

如果满足以下条件，函数是**可重入**的：

> 它可以在其执行期间的任何时候被中断，然后在其先前的调用完成执行之前再次安全地调用（“重新进入”）。

作为可能的重入示例，Wikipedia 给出了一个设计为由系统中断调用的函数的示例：假设在另一个中断发生时它已经在运行。但是不要仅仅因为你没有使用系统中断来编写代码就认为你是安全的：如果你使用回调或递归函数，你可能会在单线程程序中遇到重入问题。

> 避免混淆的关键是可重入是指只执行一个线程。这是从不存在多任务操作系统时的概念。

**例子**

*（根据维基百科的文章略有修改）*

示例 1：非线程安全，不可重入

```
/* As this function uses a non-const global variable without
   any precaution, it is neither reentrant nor thread-safe. */

int t;

void swap(int *x, int *y)
{
    t = *x;
    *x = *y;
    *y = t;
} 
```

示例 2：线程安全，不可重入

```
/* We use a thread local variable: the function is now
   thread-safe but still not reentrant (within the
   same thread). */

__thread int t;

void swap(int *x, int *y)
{
    t = *x;
    *x = *y;
    *y = t;
} 
```

示例 3：不是线程安全的，可重入的

```
/* We save the global state in a local variable and we restore
   it at the end of the function.  The function is now reentrant
   but it is not thread safe. */

int t;

void swap(int *x, int *y)
{
    int s;
    s = t;
    t = *x;
    *x = *y;
    *y = t;
    t = s;
} 
```

示例 4：线程安全、可重入

```
/* We use a local variable: the function is now
   thread-safe and reentrant, we have ascended to
   higher plane of existence.  */

void swap(int *x, int *y)
{
    int t;
    t = *x;
    *x = *y;
    *y = t;
} 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-05-13T09:08:53.713

这取决于定义。例如[Qt 使用](http://doc.qt.io/qt-5/threads-reentrancy.html)以下内容：

> *   可以从多个线程同时调用线程安全* 函数，即使调用使用共享数据也是如此，因为对共享数据的所有引用都是序列化的。
>     
>     
> *   也可以从多个线程同时调用可*重入*函数，但前提是每次调用都使用自己的数据。
>     
>     
> 
> 因此，*线程安全*函数总是可重入的，但*可重入*函数并不总是线程安全的。
> 
> 通过扩展，如果一个类的成员函数可以从多个线程安全地调用，只要每个线程使用该类的不同实例，则称该类是可*重入的。*如果可以从多个线程安全地调用该类的成员函数，则该类是*线程安全*的，即使所有线程都使用该类的相同实例。

但他们也警告说：

> **注意：**多线程领域的术语不是完全标准化的。POSIX 使用与其 C API 有所不同的可重入和线程安全定义。在 Qt 中使用其他面向对象的 C++ 类库时，请确保理解这些定义。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-05-13T08:55:26.590

可重入函数不依赖于 C 库头文件中公开的全局变量。以 C 中的 strtok() 与 strtok_r() 为例。

有些函数需要一个地方来存储“正在进行的工作”，可重入函数允许您在线程自己的存储中指定这个指针，而不是在全局中。由于此存储是调用函数独有的，因此它可以被中断并*重新进入*（重入），并且由于在大多数情况下，超出函数实现的互斥不是此工作所必需的，因此它们通常被认为是*线程安全*。然而，这并不能通过定义来保证。

然而，errno 在 POSIX 系统上的情况略有不同（并且在任何解释这一切如何工作时往往是奇怪的）:)

简而言之，可重入*通常*意味着线程安全（如“如果您正在使用线程，请使用该函数的可重入版本”），但线程安全并不总是意味着可重入（或相反）。当您查看线程安全时，您需要考虑*并发性。*如果您必须提供一种锁定和互斥的方法来使用函数，那么该函数本质上不是线程安全的。

但是，并非所有功能都需要检查。`malloc()`不需要可重入，它不依赖于任何给定线程的入口点范围之外的任何内容（并且本身是线程安全的）。

如果不使用 mutex、futex 或其他原子锁定机制，则返回静态分配值的函数*不是线程安全的。*然而，如果它们不会被打断，它们就不需要可重入。

IE：

```
static char *foo(unsigned int flags)
{
  static char ret[2] = { 0 };

  if (flags & FOO_BAR)
    ret[0] = 'c';
  else if (flags & BAR_FOO)
    ret[0] = 'd';
  else
    ret[0] = 'e';

  ret[1] = 'A';

  return ret;
} 
```

因此，如您所见，让多个线程在没有某种锁定的情况下使用它将是一场灾难......但它没有可重入的目的。当动态分配内存在某些嵌入式平台上是禁忌时，您会遇到这种情况。

在纯函数式编程中，可重入通常*并不*意味着线程安全，它取决于传递给函数入口点的已定义或匿名函数的行为、递归等。

放置“线程安全”的更好方法是***对并发访问安全***，这更好地说明了需求。

# php - 有没有办法在 PHP 中将 json 转换为 xml？

> ID：856833
> 
> 赞同：42
> 
> 时间：2009-05-13T08:47:09.770
> 
> 标签：php, xml, json

有什么办法可以转换`json`成`xml`in`PHP`吗？我知道 xml 到 json 是很有可能的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-13T09:03:28.980

如果您愿意使用 PEAR 的[XML 序列化](http://pear.php.net/package/XML_Serializer)器，您可以通过两个简单的步骤将 JSON 转换为 PHP 对象，然后将 PHP 对象转换为 XML：

```
include("XML/Serializer.php");

function json_to_xml($json) {
    $serializer = new XML_Serializer();
    $obj = json_decode($json);

    if ($serializer->serialize($obj)) {
        return $serializer->getSerializedData();
    }
    else {
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-13T09:01:59.107

这取决于您希望 XML 看起来如何。我会尝试结合[`json_decode()`](http://us.php.net/json_decode)和[`PEAR::XML_Serializer`](http://pear.php.net/XML_Serializer)（[更多信息和示例在 sitepoint.com 上](http://www.sitepoint.com/article/xml-php-pear-xml_serializer/)）。

```
require_once 'XML/Serializer.php';

$data = json_decode($json, true)

// An array of serializer options
$serializer_options = array (
  'addDecl' => TRUE,
  'encoding' => 'ISO-8859-1',
  'indent' => '  ',
  'rootName' => 'json',
  'mode' => 'simplexml'
); 

$Serializer = &new XML_Serializer($serializer_options);
$status = $Serializer->serialize($data);

if (PEAR::isError($status)) die($status->getMessage());

echo '<pre>';
echo htmlspecialchars($Serializer->getSerializedData());
echo '</pre>'; 
```

（未经测试的代码 - 但你明白了）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-12-03T12:23:59.203

用 破解打开 JSON `json_decode`，并遍历它以生成您想要的任何 XML。

如果您想知道，JSON 和 XML 之间没有规范的映射，因此您必须根据应用程序的需要自己编写 XML 生成代码。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-02-01T14:44:09.193

我将之前的两个建议合并为：

```
/**
 * Convert JSON to XML
 * @param string    - json
 * @return string   - XML
 */
function json_to_xml($json)
{
    include_once("XML/Serializer.php");

    $options = array (
      'addDecl' => TRUE,
      'encoding' => 'UTF-8',
      'indent' => '  ',
      'rootName' => 'json',
      'mode' => 'simplexml'
    );

    $serializer = new XML_Serializer($options);
    $obj = json_decode($json);
    if ($serializer->serialize($obj)) {
        return $serializer->getSerializedData();
    } else {
        return null;
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-03T13:26:44.663

A native approch might be

```
function json_to_xml($obj){
  $str = "";
  if(is_null($obj))
    return "<null/>";
  elseif(is_array($obj)) {
      //a list is a hash with 'simple' incremental keys
    $is_list = array_keys($obj) == array_keys(array_values($obj));
    if(!$is_list) {
      $str.= "<hash>";
      foreach($obj as $k=>$v)
        $str.="<item key=\"$k\">".json_to_xml($v)."</item>".CRLF;
      $str .= "</hash>";
    } else {
      $str.= "<list>";
      foreach($obj as $v)
        $str.="<item>".json_to_xml($v)."</item>".CRLF;
      $str .= "</list>";
    }
    return $str;
  } elseif(is_string($obj)) {
    return htmlspecialchars($obj) != $obj ? "<![CDATA[$obj]]>" : $obj;
  } elseif(is_scalar($obj))
    return $obj;
  else
    throw new Exception("Unsupported type $obj");
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-08T13:38:57.770

另一种选择是使用[JSON 流解析器](https://github.com/search?l=PHP&p=2&q=json%20parser&ref=searchresults&type=Repositories)。

如果您想绕过 PHP 在使用`json_decode`. 例如，当您有一个大型 JSON 文档并且内存存在问题时，您可以在[`XMLWriter`](http://php.net/xmlwriter)使用流解析器读取文档时直接输出 XML。

一个例子是[https://github.com/salsify/jsonstreamingparser](https://github.com/salsify/jsonstreamingparser)

```
$writer = new XMLWriter;
$xml->openURI('file.xml');
$listener = new JSON2XML($writer); // you need to write the JSON2XML listener
$stream = fopen('doc.json', 'r');
try {
    $parser = new JsonStreamingParser_Parser($stream, $listener);
    $parser->parse();
} catch (Exception $e) {
    fclose($stream);
    throw $e;
} 
```

JSON2XML 侦听器需要实现[侦听器接口](https://github.com/salsify/jsonstreamingparser/blob/master/src/JsonStreamingParser/Listener.php)：

```
interface JsonStreamingParser_Listener 
{
  public function start_document();
  public function end_document();
  public function start_object();
  public function end_object();
  public function start_array();
  public function end_array();
  public function key($key);
  public function value($value);
} 
```

在运行时，监听器会从解析器接收各种事件，例如当解析器找到一个对象时，它会将数据发送给`start_object()`方法。当它找到一个数组时，它会触发`start_array()`等等。然后，在这些方法中，您可以将值委托给 .eg 中的适当方法，`XMLWriter`依此[`start_element()`](http://www.php.net/manual/de/function.xmlwriter-start-element.php)类推。

**免责声明：**我不隶属于作者，也没有使用过该工具。我之所以选择这个库，是因为它的 API 看起来非常简单，可以说明如何使用基于事件的 JSON 解析器。

# sql-server - SQL Server 2005 Standard 升级仍显示为 Express

> ID：856836
> 
> 赞同：1
> 
> 时间：2009-05-13T08:47:49.660
> 
> 标签：sql-server, sql-server-2005

我已使用其他帖子中描述的最佳实践将 SQL Server Express 2005 实例升级到标准。我已重新启动 SQL Server，但在 Management Studio 中仍显示为 Express，并且在执行时选择 @@version

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-03T09:00:28.443

我没有找到这个问题的原因。我再次执行了升级并且它工作了所以它一定是我在最初尝试时错过的东西

# django - 管理员中的 list_filter

> ID：856837
> 
> 赞同：3
> 
> 时间：2009-05-13T08:47:50.783
> 
> 标签：django, django-admin

```
DECOM_CHOICES = (
    ('N', 'No'),
    ('Y', 'Yes'),
)

class Host(models.Model):
    hostname = models.CharField(max_length=36, unique=True)
    decommissioned = models.CharField(max_length=1, choices=DECOM_CHOICES, default='N')
    ip_address = models.IPAddressField()
    def __unicode__(self):
        return self.hostname

class HostAdmin(admin.ModelAdmin):
    fieldsets = [
        ('Host Info', {'fields': ['hostname','decommissioned','ip_address']}),
    list_display = ('hostname', 'ip_address', 'decommissioned')
    list_filter = ('decommissioned') 
```

**现在有什么办法可以让我将退役过滤器`'N'`默认设置为而不是`'All'`？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T09:02:59.277

看起来您使用的代码几乎完全来自[Django ticket](http://code.djangoproject.com/ticket/8851)，它在评论中有一个解决方法来设置默认过滤器值。目前还没有一种特别优雅的方式来做到这一点。

顺便说一句 - 你会不会更好地使用布尔字段，因为你存储的是或否？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T14:21:34.357

我通过在将请求对象中的 GET 数据传递给`changelist_view()`. 不优雅，但它有效。

```
class MyModelAdmin(admin.ModelAdmin):    
    def changelist_view(self, request, extra_context=None):
        if not request.GET.has_key('decommissioned__exact'):
            q = request.GET.copy()
            q['decommissioned__exact'] = 'N'
            request.GET = q
            request.META['QUERY_STRING'] = request.GET.urlencode()
        return super(MyModelAdmin,self).changelist_view(request, extra_context=extra_context) 
```

**注意：**我没有在这里尝试过这个确切的代码，但你应该明白了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T05:45:52.290

if ('HTTP_REFERER' in request.META) and (request.META['HTTP_REFERER'].find('?') == -1) and (not request.GET.has_key('status__exact')):

**使用此保存条件而不是 'gerdemb' 给出的上述解决方案中给出的条件，以便也可以选择所有**

# asp.net - 迁移：从 ASP.NET 1.1 到 ASP.NET 2.0，回发中断

> ID：856838
> 
> 赞同：0
> 
> 时间：2009-05-13T08:47:59.053
> 
> 标签：asp.net, migration, postback

我们最近刚刚将我们的 Web 应用程序从 .NET 1.1 迁移到 .NET 2.0。

Web 应用程序最初是使用 Visual Studio 2003 在 .NET 1.1 中编写的。为了迁移它，我们将解决方案转换为 VS2005。

除了一些小问题，如 RESX 不兼容和损坏的日历控件，Web 应用程序工作正常。

但是，我们今天刚刚测试它，一些回发功能突然坏了。特别是“文件浏览器”之一。当用户单击浏览按钮时，将打开一个新窗口（自定义页面），允许他浏览文件，然后将 PATH 传递给父页面，然后保存在文本框中，然后回发到对路径进行一些验证。但是，在 POSTBACK 中，存储在文本框中的路径现在消失了，并被“默认”路径替换。

在从 1.1 迁移到 2.0 时我们应该注意哪些可以破坏回发的东西？

谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T11:59:51.483

这是 ASP.NET 2.0 中的设计问题。

我的文本框设置为只读。这种行为是在 ASP.NET 2.0 中设计的，它的设计理念是不应该在客户端被恶意代码修改 ReadOnly TextBox。

解决方法：您应该在运行时设置，而不是在设计时设置只读属性。

TextBox1.Attributes.Add("readonly", "readonly");

参考资料： http: [//www.dotnetspider.com/resources/3120-ASP-NET--TextBox-Ready-Only-losing-client-side-changes-values-across-postback.aspx](http://www.dotnetspider.com/resources/3120-ASP-NET--TextBox-Ready-Only-losing-client-side-changes-values-across-postback.aspx)

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.readonly.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.readonly.aspx)

# .net - 在我的 Web 项目中使用代码契约将如何影响部署？

> ID：856844
> 
> 赞同：1
> 
> 时间：2009-05-13T08:49:59.220
> 
> 标签：.net, deployment, code-contracts

如果在应用程序中使用[代码契约](http://research.microsoft.com/en-us/projects/contracts/)，那么我们是否需要在生产服务器上安装任何东西（来自代码契约包），例如将程序集放入 GAC 或在生产服务器上运行代码契约安装包？

或者只是将库放在 bin 文件夹中会起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T11:16:14.873

将它们放在 bin/ 文件夹中就足够了。

几周前做了这样的事情，我下载了一个图表引擎的试用版，将 .dll 放在我的 lib 文件夹中，并在我的网络项目中添加了对它们的引用。

当我们部署网站时，我们曾经在 Visual Studio 中使用“发布”选项，因此我们可以上传一个漂亮、干净的构建（现在我们有一个构建服务器）。

这一切都很完美，直到我们决定购买该组件，我安装了它，并将我们移动/安装的所有程序集添加到 GAC。我拿了这些程序集并将它们放在我们的 lib 文件夹中并重新添加了引用。

在我们决定使用新的图表引擎程序集发布项目更新之前，我们一切正常。该网站停止工作！:(

经过一段时间的调试，我们发现错误是图表引擎的新 .dll 没有输出到 bin 文件夹，因为它们在 GAC 中。但是当我们发布到我们的服务器时，它们不存在，所以为了解决这个问题，我们只是将它们复制过来，一切都再次像魅力一样工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-25T21:02:52.153

从您问题中链接的代码合同网站：

> 合同充当您的外部和内部 API 的检查文档。合约用于通过运行时检查改进测试、启用静态合约验证和文档生成。

如果我错了，请纠正我，但我认为代码合同只是为了开发时的帮助而设计的。因此，假设您在编译用于部署/生产的程序集时将禁用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T15:46:06.517

我意识到这是一个较旧的线程，但这个问题仍然是一个有效的问题......

假设使用 .NET 4.0，System.Diagnostics.Contract 类已经包含在 mscorlib.dll 中。因此，您需要在任何地方安装 .NET 4.0 运行时。

您只需将 CodeContracts 包安装到开发机器和将二进制文件编译为 IL 的任何其他机器（即通过 VisualStudio、使用 csc.exe 的 msbuild - C# 编译器等）。该安装包中包含多个 .exe。其中之一是“ccrewrite.exe”。这是一个 IL 重写器，可在编译器完成**后将**IL 代码注入您的程序集中。请注意，您使用的任何语言的 ccrewrite 和 .NET 编译器都**没有**关联、连接或共享任何依赖项。

一旦您的二进制文件被编译，就无需安装或部署任何东西到您的代码将执行的任何服务器。**无论**您在项目设置中配置的选项如何，都是如此：

*   使用运行时契约检查
*   使用静态合约检查
*   配置为构建 CodeContract 参考程序集（您也不需要部署这些）。
*   等等

CodeContract 参考程序集仅在您需要将合同公开给解决方案之外的库/API 并且为该项目启用静态检查时使用。您也不应该直接引用它们，也不需要任何类型的构建后步骤将它们复制到任何 bin 文件夹中（除了我刚才提到的将它们暴露给另一个库/API 的情况）。

高温高压

# c# - 操作方法：在控制台应用程序中绘制表格的最佳方法 (C#)

> ID：856845
> 
> 赞同：121
> 
> 时间：2009-05-13T08:50:12.123
> 
> 标签：c#, console, drawing

我有一个有趣的问题。想象一下，我有很多数据以非常快的间隔发生变化。我想在控制台应用程序中将该数据显示为表格。前：

```
-------------------------------------------------------------------------
|    Column 1     |    Column 2     |    Column 3     |    Column 4     |
-------------------------------------------------------------------------
|                 |                 |                 |                 |
|                 |                 |                 |                 |
|                 |                 |                 |                 |
------------------------------------------------------------------------- 
```

如何保持快速以及如何固定列宽？我知道如何在 java 中做到这一点，但我不知道它是如何在 C# 中完成的。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-05-13T08:59:21.233

将[String.Format](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)与对齐值一起使用。

例如：

```
String.Format("|{0,5}|{1,5}|{2,5}|{3,5}|", arg0, arg1, arg2, arg3); 
```

创建一个格式化的行。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-05-13T09:13:08.560

您可以执行以下操作：

```
static int tableWidth = 73;

static void Main(string[] args)
{
    Console.Clear();
    PrintLine();
    PrintRow("Column 1", "Column 2", "Column 3", "Column 4");
    PrintLine();
    PrintRow("", "", "", "");
    PrintRow("", "", "", "");
    PrintLine();
    Console.ReadLine();
}

static void PrintLine()
{
    Console.WriteLine(new string('-', tableWidth));
}

static void PrintRow(params string[] columns)
{
    int width = (tableWidth - columns.Length) / columns.Length;
    string row = "|";

    foreach (string column in columns)
    {
        row += AlignCentre(column, width) + "|";
    }

    Console.WriteLine(row);
}

static string AlignCentre(string text, int width)
{
    text = text.Length > width ? text.Substring(0, width - 3) + "..." : text;

    if (string.IsNullOrEmpty(text))
    {
        return new string(' ', width);
    }
    else
    {
        return text.PadRight(width - (width - text.Length) / 2).PadLeft(width);
    }
} 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2013-10-14T05:30:47.500

**编辑：**感谢@superlogical，您现在可以在[github](https://github.com/Robert-McGinley/TableParser)中找到并改进以下代码！

* * *

我根据这里的一些想法编写了这门课。列的宽度是最佳的，它可以使用这个简单的 API 处理对象数组：

```
static void Main(string[] args)
{
  IEnumerable<Tuple<int, string, string>> authors =
    new[]
    {
      Tuple.Create(1, "Isaac", "Asimov"),
      Tuple.Create(2, "Robert", "Heinlein"),
      Tuple.Create(3, "Frank", "Herbert"),
      Tuple.Create(4, "Aldous", "Huxley"),
    };

  Console.WriteLine(authors.ToStringTable(
    new[] {"Id", "First Name", "Surname"},
    a => a.Item1, a => a.Item2, a => a.Item3));

  /* Result:        
  | Id | First Name | Surname  |
  |----------------------------|
  | 1  | Isaac      | Asimov   |
  | 2  | Robert     | Heinlein |
  | 3  | Frank      | Herbert  |
  | 4  | Aldous     | Huxley   |
  */
} 
```

这是课程：

```
public static class TableParser
{
  public static string ToStringTable<T>(
    this IEnumerable<T> values,
    string[] columnHeaders,
    params Func<T, object>[] valueSelectors)
  {
    return ToStringTable(values.ToArray(), columnHeaders, valueSelectors);
  }

  public static string ToStringTable<T>(
    this T[] values,
    string[] columnHeaders,
    params Func<T, object>[] valueSelectors)
  {
    Debug.Assert(columnHeaders.Length == valueSelectors.Length);

    var arrValues = new string[values.Length + 1, valueSelectors.Length];

    // Fill headers
    for (int colIndex = 0; colIndex < arrValues.GetLength(1); colIndex++)
    {
      arrValues[0, colIndex] = columnHeaders[colIndex];
    }

    // Fill table rows
    for (int rowIndex = 1; rowIndex < arrValues.GetLength(0); rowIndex++)
    {
      for (int colIndex = 0; colIndex < arrValues.GetLength(1); colIndex++)
      {
        arrValues[rowIndex, colIndex] = valueSelectors[colIndex]
          .Invoke(values[rowIndex - 1]).ToString();
      }
    }

    return ToStringTable(arrValues);
  }

  public static string ToStringTable(this string[,] arrValues)
  {
    int[] maxColumnsWidth = GetMaxColumnsWidth(arrValues);
    var headerSpliter = new string('-', maxColumnsWidth.Sum(i => i + 3) - 1);

    var sb = new StringBuilder();
    for (int rowIndex = 0; rowIndex < arrValues.GetLength(0); rowIndex++)
    {
      for (int colIndex = 0; colIndex < arrValues.GetLength(1); colIndex++)
      {
        // Print cell
        string cell = arrValues[rowIndex, colIndex];
        cell = cell.PadRight(maxColumnsWidth[colIndex]);
        sb.Append(" | ");
        sb.Append(cell);
      }

      // Print end of line
      sb.Append(" | ");
      sb.AppendLine();

      // Print splitter
      if (rowIndex == 0)
      {
        sb.AppendFormat(" |{0}| ", headerSpliter);
        sb.AppendLine();
      }
    }

    return sb.ToString();
  }

  private static int[] GetMaxColumnsWidth(string[,] arrValues)
  {
    var maxColumnsWidth = new int[arrValues.GetLength(1)];
    for (int colIndex = 0; colIndex < arrValues.GetLength(1); colIndex++)
    {
      for (int rowIndex = 0; rowIndex < arrValues.GetLength(0); rowIndex++)
      {
        int newLength = arrValues[rowIndex, colIndex].Length;
        int oldLength = maxColumnsWidth[colIndex];

        if (newLength > oldLength)
        {
          maxColumnsWidth[colIndex] = newLength;
        }
      }
    }

    return maxColumnsWidth;
  }
} 
```

* * *

**编辑：**我添加了一个小改进 - 如果您希望列标题成为属性名称，请添加以下方法`TableParser`（请注意，由于反射，它会有点慢）：

```
public static string ToStringTable<T>(
    this IEnumerable<T> values,
    params Expression<Func<T, object>>[] valueSelectors)
{
  var headers = valueSelectors.Select(func => GetProperty(func).Name).ToArray();
  var selectors = valueSelectors.Select(exp => exp.Compile()).ToArray();
  return ToStringTable(values, headers, selectors);
}

private static PropertyInfo GetProperty<T>(Expression<Func<T, object>> expresstion)
{
  if (expresstion.Body is UnaryExpression)
  {
    if ((expresstion.Body as UnaryExpression).Operand is MemberExpression)
    {
      return ((expresstion.Body as UnaryExpression).Operand as MemberExpression).Member as PropertyInfo;
    }
  }

  if ((expresstion.Body is MemberExpression))
  {
    return (expresstion.Body as MemberExpression).Member as PropertyInfo;
  }
  return null;
} 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2018-02-28T15:09:07.723

有几个开源库允许控制台表格格式化，范围从简单（如此处答案中的代码示例）到更高级。

## 控制台表

从 NuGet 统计数据来看，最流行的表格格式化库是[ConsoleTable](https://github.com/khalidabuhakmeh/ConsoleTables)。表的构造如下（来自自述文件）：

```
var table = new ConsoleTable("one", "two", "three");
table.AddRow(1, 2, 3)
     .AddRow("this line should be longer", "yes it is", "oh"); 
```

可以使用其中一种预定义样式对表格进行格式化。它看起来像这样：

```
--------------------------------------------------
| one                        | two       | three |
--------------------------------------------------
| 1                          | 2         | 3     |
--------------------------------------------------
| this line should be longer | yes it is | oh    |
-------------------------------------------------- 
```

这个库需要没有格式的单行单元格。

有几个基于 ConsoleTable 的库具有略微扩展的功能集，比如更多的线条样式。

## CsConsoleFormat

如果您需要更复杂的格式，您可以使用[CsConsoleFormat](https://github.com/Athari/CsConsoleFormat)。† 这是从流程列表（来自示例项目）生成的表格：

```
new Grid { Stroke = StrokeHeader, StrokeColor = DarkGray }
    .AddColumns(
        new Column { Width = GridLength.Auto },
        new Column { Width = GridLength.Auto, MaxWidth = 20 },
        new Column { Width = GridLength.Star(1) },
        new Column { Width = GridLength.Auto }
    )
    .AddChildren(
        new Cell { Stroke = StrokeHeader, Color = White }
            .AddChildren("Id"),
        new Cell { Stroke = StrokeHeader, Color = White }
            .AddChildren("Name"),
        new Cell { Stroke = StrokeHeader, Color = White }
            .AddChildren("Main Window Title"),
        new Cell { Stroke = StrokeHeader, Color = White }
            .AddChildren("Private Memory"),
        processes.Select(process => new[] {
            new Cell { Stroke = StrokeRight }
                .AddChildren(process.Id),
            new Cell { Stroke = StrokeRight, Color = Yellow, TextWrap = TextWrapping.NoWrap }
                .AddChildren(process.ProcessName),
            new Cell { Stroke = StrokeRight, Color = White, TextWrap = TextWrapping.NoWrap }
                .AddChildren(process.MainWindowTitle),
            new Cell { Stroke = LineThickness.None, Align = HorizontalAlignment.Right }
                .AddChildren(process.PrivateMemorySize64.ToString("n0")),
        })
    ) 
```

最终结果将如下所示：

![](https://i.imgur.com/jqESPzN.png)

它支持任何类型的表格行（包括几个和可定制的）、带有自动换行的多行单元格、颜色、基于内容或百分比增长的列、文本对齐等。

[† CsConsoleFormat 是我开发的。]

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2011-06-06T09:27:17.683

```
class ArrayPrinter
    {
    #region Declarations

    static bool isLeftAligned = false;
    const string cellLeftTop = "┌";
    const string cellRightTop = "┐";
    const string cellLeftBottom = "└";
    const string cellRightBottom = "┘";
    const string cellHorizontalJointTop = "┬";
    const string cellHorizontalJointbottom = "┴";
    const string cellVerticalJointLeft = "├";
    const string cellTJoint = "┼";
    const string cellVerticalJointRight = "┤";
    const string cellHorizontalLine = "─";
    const string cellVerticalLine = "│";

    #endregion

    #region Private Methods

    private static int GetMaxCellWidth(string[,] arrValues)
    {
        int maxWidth = 1;

        for (int i = 0; i < arrValues.GetLength(0); i++)
        {
            for (int j = 0; j < arrValues.GetLength(1); j++)
            {
                int length = arrValues[i, j].Length;
                if (length > maxWidth)
                {
                    maxWidth = length;
                }
            }
        }

        return maxWidth;
    }

    private static string GetDataInTableFormat(string[,] arrValues)
    {
        string formattedString = string.Empty;

        if (arrValues == null)
            return formattedString;

        int dimension1Length = arrValues.GetLength(0);
        int dimension2Length = arrValues.GetLength(1);

        int maxCellWidth = GetMaxCellWidth(arrValues);
        int indentLength = (dimension2Length * maxCellWidth) + (dimension2Length - 1);
        //printing top line;
        formattedString = string.Format("{0}{1}{2}{3}", cellLeftTop, Indent(indentLength), cellRightTop, System.Environment.NewLine);

        for (int i = 0; i < dimension1Length; i++)
        {
            string lineWithValues = cellVerticalLine;
            string line = cellVerticalJointLeft;
            for (int j = 0; j < dimension2Length; j++)
            {
                string value = (isLeftAligned) ? arrValues[i, j].PadRight(maxCellWidth, ' ') : arrValues[i, j].PadLeft(maxCellWidth, ' ');
                lineWithValues += string.Format("{0}{1}", value, cellVerticalLine);
                line += Indent(maxCellWidth);
                if (j < (dimension2Length - 1))
                {
                    line += cellTJoint;
                }
            }
            line += cellVerticalJointRight;
            formattedString += string.Format("{0}{1}", lineWithValues, System.Environment.NewLine);
            if (i < (dimension1Length - 1))
            {
                formattedString += string.Format("{0}{1}", line, System.Environment.NewLine);
            }
        }

        //printing bottom line
        formattedString += string.Format("{0}{1}{2}{3}", cellLeftBottom, Indent(indentLength), cellRightBottom, System.Environment.NewLine);
        return formattedString;
    }

    private static string Indent(int count)
    {
        return string.Empty.PadLeft(count, '─');                 
    }

    #endregion

    #region Public Methods

    public static void PrintToStream(string[,] arrValues, StreamWriter writer)
    {
        if (arrValues == null)
            return;

        if (writer == null)
            return;

        writer.Write(GetDataInTableFormat(arrValues));
    }

    public static void PrintToConsole(string[,] arrValues)
    {
        if (arrValues == null)
            return;

        Console.WriteLine(GetDataInTableFormat(arrValues));
    }

    #endregion

    static void Main(string[] args)
    {           
        int value = 997;
        string[,] arrValues = new string[5, 5];
        for (int i = 0; i < arrValues.GetLength(0); i++)
        {
            for (int j = 0; j < arrValues.GetLength(1); j++)
            {
                value++;
                arrValues[i, j] = value.ToString();
            }
        }
        ArrayPrinter.PrintToConsole(arrValues);
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2013-02-05T01:41:23.733

我想要可变宽度的列，而且我并不特别关心方框字符。另外，我需要为每一行打印一些额外的信息。

因此，如果其他人需要，我会为您节省几分钟：

```
public class TestTableBuilder
{

    public interface ITextRow
    {
        String Output();
        void Output(StringBuilder sb);
        Object Tag { get; set; }
    }

    public class TableBuilder : IEnumerable<ITextRow>
    {
        protected class TextRow : List<String>, ITextRow
        {
            protected TableBuilder owner = null;
            public TextRow(TableBuilder Owner)
            {
                owner = Owner;
                if (owner == null) throw new ArgumentException("Owner");
            }
            public String Output()
            {
                StringBuilder sb = new StringBuilder();
                Output(sb);
                return sb.ToString();
            }
            public void Output(StringBuilder sb)
            {
                sb.AppendFormat(owner.FormatString, this.ToArray());
            }
            public Object Tag { get; set; }
        }

        public String Separator { get; set; }

        protected List<ITextRow> rows = new List<ITextRow>();
        protected List<int> colLength = new List<int>();

        public TableBuilder()
        {
            Separator = "  ";
        }

        public TableBuilder(String separator)
            : this()
        {
            Separator = separator;
        }

        public ITextRow AddRow(params object[] cols)
        {
            TextRow row = new TextRow(this);
            foreach (object o in cols)
            {
                String str = o.ToString().Trim();
                row.Add(str);
                if (colLength.Count >= row.Count)
                {
                    int curLength = colLength[row.Count - 1];
                    if (str.Length > curLength) colLength[row.Count - 1] = str.Length;
                }
                else
                {
                    colLength.Add(str.Length);
                }
            }
            rows.Add(row);
            return row;
        }

        protected String _fmtString = null;
        public String FormatString
        {
            get
            {
                if (_fmtString == null)
                {
                    String format = "";
                    int i = 0;
                    foreach (int len in colLength)
                    {
                        format += String.Format("{{{0},-{1}}}{2}", i++, len, Separator);
                    }
                    format += "\r\n";
                    _fmtString = format;
                }
                return _fmtString;
            }
        }

        public String Output()
        {
            StringBuilder sb = new StringBuilder();
            foreach (TextRow row in rows)
            {
                row.Output(sb);
            }
            return sb.ToString();
        }

        #region IEnumerable Members

        public IEnumerator<ITextRow> GetEnumerator()
        {
            return rows.GetEnumerator();
        }

        System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
        {
            return rows.GetEnumerator();
        }

        #endregion
    }

    static void Main(String[] args)
    {
        TableBuilder tb = new TableBuilder();
        tb.AddRow("When", "ID", "Name");
        tb.AddRow("----", "--", "----");

        tb.AddRow(DateTime.Now, "1", "Name1");
        tb.AddRow(DateTime.Now, "1", "Name2");

        Console.Write(tb.Output());
        Console.WriteLine();

        // or

        StringBuilder sb = new StringBuilder();
        int i = 0;
        foreach (ITextRow tr in tb)
        {
            tr.Output(sb);
            if (i++ > 1) sb.AppendLine("more stuff per line");
        }
        Console.Write(sb.ToString());
    }
} 
```

输出：

```
当 ID 名称
---- -- ----
2/4/2013 8:37:44 PM 1 姓名1
2/4/2013 8:37:44 PM 1 姓名2

当 ID 名称
---- -- ----
2/4/2013 8:37:44 PM 1 姓名1
每行更多的东西
2/4/2013 8:37:44 PM 1 姓名2
每行更多的东西

```

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2019-07-02T12:21:57.247

我在 GitHub 上有一个项目，你可以使用

[https://github.com/BrunoVT1992/ConsoleTable](https://github.com/BrunoVT1992/ConsoleTable)

你可以像这样使用它：

```
var table = new Table();

table.SetHeaders("Name", "Date", "Number");

for (int i = 0; i <= 10; i++)
{
    if (i % 2 == 0)
        table.AddRow($"name {i}", DateTime.Now.AddDays(-i).ToLongDateString(), i.ToString());
    else
        table.AddRow($"long name {i}", DateTime.Now.AddDays(-i).ToLongDateString(), (i * 5000).ToString());
}

Console.WriteLine(table.ToString()); 
```

它将给出以下结果：

[![在此处输入图像描述](https://i.stack.imgur.com/ByQ9T.png)](https://i.stack.imgur.com/ByQ9T.png)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2019-03-01T10:50:21.170

如果这对某人有帮助，这是我为我的需要编写的一个简单的类。您可以轻松更改它以满足您的需求。

```
using System.Collections.Generic;
using System.Linq;

namespace Utilities
{
    public class TablePrinter
    {
        private readonly string[] titles;
        private readonly List<int> lengths;
        private readonly List<string[]> rows = new List<string[]>();

        public TablePrinter(params string[] titles)
        {
            this.titles = titles;
            lengths = titles.Select(t => t.Length).ToList();
        }

        public void AddRow(params object[] row)
        {
            if (row.Length != titles.Length)
            {
                throw new System.Exception($"Added row length [{row.Length}] is not equal to title row length [{titles.Length}]");
            }
            rows.Add(row.Select(o => o.ToString()).ToArray());
            for (int i = 0; i < titles.Length; i++)
            {
                if (rows.Last()[i].Length > lengths[i])
                {
                    lengths[i] = rows.Last()[i].Length;
                }
            }
        }

        public void Print()
        {
            lengths.ForEach(l => System.Console.Write("+-" + new string('-', l) + '-'));
            System.Console.WriteLine("+");

            string line = "";
            for (int i = 0; i < titles.Length; i++)
            {
                line += "| " + titles[i].PadRight(lengths[i]) + ' ';
            }
            System.Console.WriteLine(line + "|");

            lengths.ForEach(l => System.Console.Write("+-" + new string('-', l) + '-'));
            System.Console.WriteLine("+");

            foreach (var row in rows)
            {
                line = "";
                for (int i = 0; i < row.Length; i++)
                {
                    if (int.TryParse(row[i], out int n))
                    {
                        line += "| " + row[i].PadLeft(lengths[i]) + ' ';  // numbers are padded to the left
                    }
                    else
                    {
                        line += "| " + row[i].PadRight(lengths[i]) + ' ';
                    }
                }
                System.Console.WriteLine(line + "|");
            }

            lengths.ForEach(l => System.Console.Write("+-" + new string('-', l) + '-'));
            System.Console.WriteLine("+");
        }
    }
} 
```

示例用法：

```
var t = new TablePrinter("id", "Column A", "Column B");
t.AddRow(1, "Val A1", "Val B1");
t.AddRow(2, "Val A2", "Val B2");
t.AddRow(100, "Val A100", "Val B100");
t.Print(); 
```

输出：

```
+-----+----------+----------+
| id  | Column A | Column B |
+-----+----------+----------+
|   1 | Val A1   | Val B1   |
|   2 | Val A2   | Val B2   |
| 100 | Val A100 | Val B100 |
+-----+----------+----------+ 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2015-02-25T20:58:36.527

这是对先前答案的改进。它增加了对具有不同长度的值和具有不同数量的单元格的行的支持。例如：

```
┌──────────┬─────────┬──────────────────────────┬────────────────┬─────┬───────┐
│Identifier│     Type│               Description│  CPU Credit Use│Hours│Balance│
├──────────┼─────────┼──────────────────────────┼────────────────┼─────┼───────┘
│ i-1234154│ t2.small│       This is an example.│         3263.75│  360│
├──────────┼─────────┼──────────────────────────┼────────────────┼─────┘
│ i-1231412│ t2.small│  This is another example.│         3089.93│
└──────────┴─────────┴──────────────────────────┴────────────────┘ 
```

这是代码：

```
public class ArrayPrinter
{
    const string TOP_LEFT_JOINT = "┌";
    const string TOP_RIGHT_JOINT = "┐";
    const string BOTTOM_LEFT_JOINT = "└";
    const string BOTTOM_RIGHT_JOINT = "┘";
    const string TOP_JOINT = "┬";
    const string BOTTOM_JOINT = "┴";
    const string LEFT_JOINT = "├";
    const string JOINT = "┼";
    const string RIGHT_JOINT = "┤";
    const char HORIZONTAL_LINE = '─';
    const char PADDING = ' ';
    const string VERTICAL_LINE = "│";

    private static int[] GetMaxCellWidths(List<string[]> table)
    {
        int maximumCells = 0;
        foreach (Array row in table)
        {
            if (row.Length > maximumCells)
                maximumCells = row.Length;
        }

        int[] maximumCellWidths = new int[maximumCells];
        for (int i = 0; i < maximumCellWidths.Length; i++)
            maximumCellWidths[i] = 0;

        foreach (Array row in table)
        {
            for (int i = 0; i < row.Length; i++)
            {
                if (row.GetValue(i).ToString().Length > maximumCellWidths[i])
                    maximumCellWidths[i] = row.GetValue(i).ToString().Length;
            }
        }

        return maximumCellWidths;
    }

    public static string GetDataInTableFormat(List<string[]> table)
    {
        StringBuilder formattedTable = new StringBuilder();
        Array nextRow = table.FirstOrDefault();
        Array previousRow = table.FirstOrDefault();

        if (table == null || nextRow == null)
            return String.Empty;

        // FIRST LINE:
        int[] maximumCellWidths = GetMaxCellWidths(table);
        for (int i = 0; i < nextRow.Length; i++)
        {
            if (i == 0 && i == nextRow.Length - 1)
                formattedTable.Append(String.Format("{0}{1}{2}", TOP_LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), TOP_RIGHT_JOINT));
            else if (i == 0)
                formattedTable.Append(String.Format("{0}{1}", TOP_LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
            else if (i == nextRow.Length - 1)
                formattedTable.AppendLine(String.Format("{0}{1}{2}", TOP_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), TOP_RIGHT_JOINT));
            else
                formattedTable.Append(String.Format("{0}{1}", TOP_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
        }

        int rowIndex = 0;
        int lastRowIndex = table.Count - 1;
        foreach (Array thisRow in table)
        {
            // LINE WITH VALUES:
            int cellIndex = 0;
            int lastCellIndex = thisRow.Length - 1;
            foreach (object thisCell in thisRow)
            {
                string thisValue = thisCell.ToString().PadLeft(maximumCellWidths[cellIndex], PADDING);

                if (cellIndex == 0 && cellIndex == lastCellIndex)
                    formattedTable.AppendLine(String.Format("{0}{1}{2}", VERTICAL_LINE, thisValue, VERTICAL_LINE));
                else if (cellIndex == 0)
                    formattedTable.Append(String.Format("{0}{1}", VERTICAL_LINE, thisValue));
                else if (cellIndex == lastCellIndex)
                    formattedTable.AppendLine(String.Format("{0}{1}{2}", VERTICAL_LINE, thisValue, VERTICAL_LINE));
                else
                    formattedTable.Append(String.Format("{0}{1}", VERTICAL_LINE, thisValue));

                cellIndex++;
            }

            previousRow = thisRow;

            // SEPARATING LINE:
            if (rowIndex != lastRowIndex)
            {
                nextRow = table[rowIndex + 1];

                int maximumCells = Math.Max(previousRow.Length, nextRow.Length);
                for (int i = 0; i < maximumCells; i++)
                {
                    if (i == 0 && i == maximumCells - 1)
                    {
                        formattedTable.Append(String.Format("{0}{1}{2}", LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), RIGHT_JOINT));
                    }
                    else if (i == 0)
                    {
                        formattedTable.Append(String.Format("{0}{1}", LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
                    }
                    else if (i == maximumCells - 1)
                    {
                        if (i > previousRow.Length)
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", TOP_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), TOP_RIGHT_JOINT));
                        else if (i > nextRow.Length)
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", BOTTOM_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), BOTTOM_RIGHT_JOINT));
                        else if (i > previousRow.Length - 1)
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), TOP_RIGHT_JOINT));
                        else if (i > nextRow.Length - 1)
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), BOTTOM_RIGHT_JOINT));
                        else
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), RIGHT_JOINT));
                    }
                    else
                    {
                        if (i > previousRow.Length)
                            formattedTable.Append(String.Format("{0}{1}", TOP_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
                        else if (i > nextRow.Length)
                            formattedTable.Append(String.Format("{0}{1}", BOTTOM_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
                        else
                            formattedTable.Append(String.Format("{0}{1}", JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
                    }
                }
            }

            rowIndex++;
        }

        // LAST LINE:
        for (int i = 0; i < previousRow.Length; i++)
        {
            if (i == 0)
                formattedTable.Append(String.Format("{0}{1}", BOTTOM_LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
            else if (i == previousRow.Length - 1)
                formattedTable.AppendLine(String.Format("{0}{1}{2}", BOTTOM_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), BOTTOM_RIGHT_JOINT));
            else
                formattedTable.Append(String.Format("{0}{1}", BOTTOM_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
        }

        return formattedTable.ToString();
    }
} 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2021-07-16T18:46:29.803

[Spectre.Console](https://github.com/spectreconsole/spectre.console)可以做到这一点。

例子：

[![表格是在终端中显示表格数据的完美方式。](https://i.stack.imgur.com/7IJQh.png)](https://i.stack.imgur.com/7IJQh.png)

简单用法：

```
// Create a table
var table = new Table();

// Add some columns
table.AddColumn("Foo");
table.AddColumn(new TableColumn("Bar").Centered());

// Add some rows
table.AddRow("Baz", "[green]Qux[/]");
table.AddRow(new Markup("[blue]Corgi[/]"), new Panel("Waldo"));

// Render the table to the console
AnsiConsole.Render(table); 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-04-20T19:18:29.930

使用 MarkDownLog 库（你可以在 NuGet 上找到它）

您可以简单地将扩展名 ToMarkdownTable() 用于任何集合，它会为您完成所有格式设置。

```
 Console.WriteLine(
    yourCollection.Select(s => new
                    {
                        column1 = s.col1,
                        column2 = s.col2,
                        column3 = s.col3,
                        StaticColumn = "X"
                    })
                    .ToMarkdownTable()); 
```

输出看起来像这样：

```
Column1  | Column2   | Column3   | StaticColumn   
--------:| ---------:| ---------:| --------------
         |           |           | X 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-01-02T17:15:28.357

```
public static void ToPrintConsole(this DataTable dataTable)
    {
        // Print top line
        Console.WriteLine(new string('-', 75));

        // Print col headers
        var colHeaders = dataTable.Columns.Cast<DataColumn>().Select(arg => arg.ColumnName);
        foreach (String s in colHeaders)
        {
            Console.Write("| {0,-20}", s);
        }
        Console.WriteLine();

        // Print line below col headers
        Console.WriteLine(new string('-', 75));

        // Print rows
        foreach (DataRow row in dataTable.Rows)
        {
            foreach (Object o in row.ItemArray)
            {
                Console.Write("| {0,-20}", o.ToString());
            }
            Console.WriteLine();
        }

        // Print bottom line
        Console.WriteLine(new string('-', 75));
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-04T20:39:48.213

扩展到@grampa 答案。现在表格居中对齐。从两端添加额外的填充。

```
public class TablePrinter
{
    const string TOP_LEFT_JOINT = "┌&quot;;
    const string TOP_RIGHT_JOINT = "┐&quot;;
    const string BOTTOM_LEFT_JOINT = "└&quot;;
    const string BOTTOM_RIGHT_JOINT = "┘&quot;;
    const string TOP_JOINT = "┬&quot;;
    const string BOTTOM_JOINT = "┴&quot;;
    const string LEFT_JOINT = "├&quot;;
    const string JOINT = "┼&quot;;
    const string RIGHT_JOINT = "┤&quot;;
    const char HORIZONTAL_LINE = '─';
    const char PADDING = ' ';
    const string VERTICAL_LINE = "│&quot;;

    private static int[] GetMaxCellWidths(List<string[]> table)
    {
        int maximumCells = 0;
        foreach (Array row in table)
        {
            if (row.Length > maximumCells)
                maximumCells = row.Length;
        }

        int[] maximumCellWidths = new int[maximumCells];
        for (int i = 0; i < maximumCellWidths.Length; i++)
            maximumCellWidths[i] = 0;

        foreach (Array row in table)
        {
            for (int i = 0; i < row.Length; i++)
            {
                if (row.GetValue(i).ToString().Length > maximumCellWidths[i])
                    maximumCellWidths[i] = row.GetValue(i).ToString().Length +2;
            }
        }

        return maximumCellWidths;
    }

    public static string GetDataInTableFormat(List<string[]> table)
    {
        StringBuilder formattedTable = new StringBuilder();
        Array nextRow = table.FirstOrDefault();
        Array previousRow = table.FirstOrDefault();

        if (table == null || nextRow == null)
            return String.Empty;

        // FIRST LINE:
        int[] maximumCellWidths = GetMaxCellWidths(table);
        for (int i = 0; i < nextRow.Length; i++)
        {
            if (i == 0 && i == nextRow.Length - 1)
                formattedTable.Append(String.Format("{0}{1}{2}", TOP_LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE), TOP_RIGHT_JOINT));
            else if (i == 0)
                formattedTable.Append(String.Format("{0}{1}", TOP_LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE)));
            else if (i == nextRow.Length - 1)
                formattedTable.AppendLine(String.Format("{0}{1}{2}", TOP_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE), TOP_RIGHT_JOINT));
            else
                formattedTable.Append(String.Format("{0}{1}", TOP_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE)));
        }

        int rowIndex = 0;
        int lastRowIndex = table.Count - 1;
        foreach (Array thisRow in table)
        {
            // LINE WITH VALUES:
            int cellIndex = 0;
            int lastCellIndex = thisRow.Length - 1;
            foreach (object thisCell in thisRow)
            {
                string thisValue = String.Format("{0}{1}{2}", String.Empty.PadLeft((maximumCellWidths[cellIndex] - thisCell.ToString().Length)/ 2),thisCell.ToString(),String.Empty.PadRight(((maximumCellWidths[cellIndex] - thisCell.ToString().Length + 1) / 2)));

                if (cellIndex == 0 && cellIndex == lastCellIndex)
                    formattedTable.AppendLine(String.Format("{0}{1}{2}", VERTICAL_LINE, thisValue, VERTICAL_LINE));
                else if (cellIndex == 0)
                    formattedTable.Append(String.Format("{0}{1}", VERTICAL_LINE, thisValue));
                else if (cellIndex == lastCellIndex)
                    formattedTable.AppendLine(String.Format("{0}{1}{2}", VERTICAL_LINE, thisValue, VERTICAL_LINE));
                else
                    formattedTable.Append(String.Format("{0}{1}", VERTICAL_LINE, thisValue));

                cellIndex++;
            }

            previousRow = thisRow;

            // SEPARATING LINE:
            if (rowIndex != lastRowIndex)
            {
                nextRow = table[rowIndex + 1];

                int maximumCells = Math.Max(previousRow.Length, nextRow.Length);
                for (int i = 0; i < maximumCells; i++)
                {
                    if (i == 0 && i == maximumCells - 1)
                    {
                        formattedTable.Append(String.Format("{0}{1}{2}", LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), RIGHT_JOINT));
                    }
                    else if (i == 0)
                    {
                        formattedTable.Append(String.Format("{0}{1}", LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
                    }
                    else if (i == maximumCells - 1)
                    {
                        if (i > previousRow.Length)
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", TOP_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE), TOP_RIGHT_JOINT));
                        else if (i > nextRow.Length)
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", BOTTOM_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE), BOTTOM_RIGHT_JOINT));
                        else if (i > previousRow.Length - 1)
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE), TOP_RIGHT_JOINT));
                        else if (i > nextRow.Length - 1)
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight((maximumCellWidths[i]), HORIZONTAL_LINE), BOTTOM_RIGHT_JOINT));
                        else
                            formattedTable.AppendLine(String.Format("{0}{1}{2}", JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight((maximumCellWidths[i]), HORIZONTAL_LINE), RIGHT_JOINT));
                    }
                    else
                    {
                        if (i > previousRow.Length)
                            formattedTable.Append(String.Format("{0}{1}", TOP_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE)));
                        else if (i > nextRow.Length)
                            formattedTable.Append(String.Format("{0}{1}", BOTTOM_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE)));
                        else
                            formattedTable.Append(String.Format("{0}{1}", JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE).PadRight(maximumCellWidths[i], HORIZONTAL_LINE)));
                    }
                }
            }

            rowIndex++;
        }

        // LAST LINE:
        for (int i = 0; i < previousRow.Length; i++)
        {
            if (i == 0)
                formattedTable.Append(String.Format("{0}{1}", BOTTOM_LEFT_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
            else if (i == previousRow.Length - 1)
                formattedTable.AppendLine(String.Format("{0}{1}{2}", BOTTOM_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE), BOTTOM_RIGHT_JOINT));
            else
                formattedTable.Append(String.Format("{0}{1}", BOTTOM_JOINT, String.Empty.PadLeft(maximumCellWidths[i], HORIZONTAL_LINE)));
        }

        return formattedTable.ToString();
    } 
```

}

输出格式很好，看起来很漂亮┌─────────┬────────────┬───────────┬─────── ──────┬──────────┬────────┐ │ Root Id │ HotelRate │ percentan │ RightValue │ Occupied │ Closed │ ├───────── ┼────────────┼────────────┼──────────┼──────────┼─ ────────┤ │ 3034 │ 100 │ 40.816306 │ 15 │ -0 │ -0 │ ├─────────┼──────────┼──── ────────┼────────────┼──────────┼────────┤ │ 3035 │ 100 │ 16.666666 │ 0 │ -0 │ 45 │ ├─────────┼────────────┼───────────┼────────── ──┼──────────┼────────┤ │ 3036 │ 100 │ 44.44444 │ 0 │ -0 │ 30 │ └──────────┴── ──────────┴───────────┴────────────┴──────────┴──── ────┘ └──────────┴────────────┴────────────┴────────── ──┴──────────┴────────┘ 不知怎的，我无法在这里格式化。

* * *

## 回答 #14

> 赞同：-7
> 
> 时间：2016-03-22T14:19:52.090

在 VisualBasic.net 中更容易！

如果您希望用户能够手动将数据输入到表中：

```
Console.Write("Enter Data For Column 1: ")
    Dim Data1 As String = Console.ReadLine
    Console.Write("Enter Data For Column 2: ")
    Dim Data2 As String = Console.ReadLine

    Console.WriteLine("{0,-20} {1,-10} {2,-10}", "{Data Type}", "{Column 1}", "{Column 2}")
    Console.WriteLine("{0,-20} {1,-10} {2,-10}", "Data Entered:", Data1, Data2)

    Console.WriteLine("ENTER To Exit: ")
    Console.ReadLine() 
```

它应该如下所示：

![它应该看起来像这样（单击我）。](https://i.stack.imgur.com/Dk7Mu.png)

# python - PyAMF / Django - Flex 类映射错误

> ID：856846
> 
> 赞同：2
> 
> 时间：2009-05-13T08:51:47.097
> 
> 标签：python, django, apache-flex, pyamf

我正在使用 PyAmf 与 Flex 应用程序进行通信。但我不断收到错误。

我的模型：

```
from django.contrib.auth.models import User

class Talent(User):
    street = models.CharField(max_length=100)
    street_nr = models.CharField(max_length=100)
    postal_code = models.PositiveIntegerField()
    city = models.CharField(max_length=100)
    description = models.CharField(max_length=100) 
```

我的网关文件：

```
from pyamf.remoting.gateway.django import DjangoGateway
from addestino.bot.services import user
from addestino.bot.models import *
from django.contrib.auth.models import User
import pyamf

pyamf.register_class(User, 'django.contrib.auth.models.User')
pyamf.register_class(Talent, 'addestino.bot.models.Talent')

services = {
    'user.register': user.register,
    'user.login': user.login,
    'user.logout': user.logout,
}

gateway = DjangoGateway(services, expose_request=True) 
```

Flex Talent 对象：

```
package be.addestino.battleoftalents.model
{
    [Bindable]
    public class Investor
    {
    public static var ALIAS : String = 'be.addestino.battleoftalents.model.Investor';

    public var id:Object;
    public var street:String;
    public var street_nr:String;
    public var postal_code:uint;
    public var city:String;
    public var cash:Number;
    public var date_created:Date;
    public var date_modified:Date;
    public var username:String;
    public var password:String;
    public var email:String;

    public function Investor()
    {
    }      
} 
```

}

如果 Flex 调用我的`register`servicemethod（一种将 flex Investor 发送到 python 的方法），我会收到一个错误`'KeyError: first_name'`。然后，当我们`first_name`向 Flex VO 添加字段时，我们会收到`last_name`错误消息。等等。这个错误意味着我们的 flex VO 必须具有与我们的 django 模型完全相同的字段。对于简单的对象，这不是问题。但是我们使用 django User 对象的子类。这意味着我们的投资者也需要一个`user_ptr`领域。注意：我在 servicemethod 之前得到所有错误。

有没有更简单的方法？理想情况下，我们将拥有一个 Flex Investor VO，其中仅包含我们使用的字段（无论它们来自 Django User 还是我们的 django`Investor`扩展自`User`）。但是现在 Flex 对象必须完全按照我们的 Django 对象建模。我什至不确切知道 Django User 对象是什么样的（我不应该这样）。

我真的可以使用一些帮助。提前非常感谢:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T00:33:11.317

这是使用 IExternalizable 接口完成的。

*   [PyAMF 文档](http://dev.pyamf.org/wiki/IExternalizable)
*   [Adobe 文档](http://livedocs.adobe.com/flex/3/langref/flash/utils/IExternalizable.html)

它允许您显式地写入和读取对象。如果这类似于 Java 隐式序列化，它不会让您限制默认发送的内容。我无法使用 PyAMF 找到任何此类示例。

我发现的关于序列化[的最佳帖子。](http://www.brooksandrus.com/blog/2008/03/25/flex-air-serialization-lessons-learned/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-12T23:55:34.360

随着 PyAMF 0.6b2 的发布，我终于可以回答这个问题了。

在编码 Django 模型时，0.5.1 在处理继承方面非常严格。它确保所有属性都保证在每个对象上进行编码 - 并期望在解码请求时所有属性都可用。

这很糟糕，随着新版本的发布，行为现在已经改变。PyAMF对您从 Flex 提供的内容更加宽容*。*您不应再收到该`KeyError`错误（如果您这样做，则将其视为错误）。

# dynamics-crm - 如何复制 Microsoft Dynamics CRM 4.0 解决方案

> ID：856848
> 
> 赞同：0
> 
> 时间：2009-05-13T08:51:54.287
> 
> 标签：dynamics-crm, test-environments

我在生产中有一个 CRM 4.0 解决方案，我想复制它，以便我可以将它用作测试服务器。

有什么替代方法可以做到这一点？缺点/优点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T18:14:58.330

您可以将所有自定义导出到一个文件，然后将它们导入您的测试系统。理想情况下，您将朝着另一个方向工作（在测试中进行更改，然后转向生产）。

要导出，请转到设置-自定义。您将看到导入自定义和导出自定义的选项。如果单击导出自定义项，您可以导出选定的实体自定义项。还有一个菜单选项可以导出所有自定义项。CRM 将创建一个 .zip 文件，该文件是一个 XML 文件，其中包括实体定义、表单、视图、关系和工作流。您只需反转该过程即可将更改导入另一个环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-19T17:13:03.327

最终遵循Microsoft的流程：

“如何移动 Microsoft Dynamics CRM 4.0 部署”

[https://support.microsoft.com/en-us/kb/952934](https://support.microsoft.com/en-us/kb/952934)

看起来没有其他选择。

# html - 我们可以在单个页面中混合使用 struts 和 html 标签吗

> ID：856849
> 
> 赞同：0
> 
> 时间：2009-05-13T08:52:26.657
> 
> 标签：html, struts2

我有 jsp 文件，其中大部分 tha struts 标记现在对于某些字段我必须使用简单的 html 标记，但是当我放置 html 标记时，页面的格式会被更改。如果我只使用 struts 标签，那么每个 strut 标签都写在新行中。如何在单行中显示两个不同的 struts 标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T06:11:45.177

您*可以在 JSP 中使用*普通的 HTML 标记和 Struts 标记。Struts 在这方面并不严格。关于你得到的错误，如果你能发布你使用的代码并详细描述你得到的错误会更好。

请注意，我并没有真正在 Struts2 中工作过——仅在 Struts 1 中工作过，但我认为您仍然应该能够在 Struts2 中将普通 HTML 标记与 Struts 标记混合...

# testing - XML Schema 测试一个值并应用额外的限制

> ID：856861
> 
> 赞同：0
> 
> 时间：2009-05-13T08:55:43.750
> 
> 标签：testing, xsd

我有以下情况：所有船都有一个船型，如鲨鱼、游艇等。我需要注册哪种类型的船名以及船有多少英尺，但这就是问题所在。如果用户输入鲨鱼，我需要验证它在 15-30 英尺之间，如果他输入 yatch，它需要在 30-60 之间。

对此有什么帮助吗？

```
<boat>
    <type>shark</type>
    <foot>18</foot> //validates
</boat>
<boat>
    <type>shark</type>
    <foot>14</foot> //fails
</boat>
<boat>
    <type>AnyOtherBoat</type>
    <foot>14</foot>//validates since its another type of boat than shark and yatch
</boat> 
```

帮助赞赏！谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T09:06:48.430

[**Schematron**](http://www.schematron.com)（ *“一种用于对 XML 文档中的模式进行断言的语言”*）可能能够满足您的需求。它允许指定无法在常规 XML 模式定义（XSD、RelaxNG）中表达的附加规则。

以下是一些帮助您入门的文章：

1.  [**维基百科上的 Schematron**](http://en.wikipedia.org/wiki/Schematron)
2.  [**Schematron：在树中使用模式的 XML 结构验证语言**](http://xml.coverpages.org/schematron.html)
3.  [**使用 Schematron 改进 XML 文档验证**](http://msdn.microsoft.com/en-us/library/aa468554.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T08:59:24.923

回答您的问题：不，您不能在 XML Schema 中这样做。

*   首先，您不能使用值来选择要应用的约束（但您可以使用类似的元素`<shark>`）
*   其次，你不能做算术测试（但你可以使用正则表达式来指定允许的字符串......所以你可以破解它。）

# c# - 在 WPF 中设置监视器 DPI

> ID：856867
> 
> 赞同：1
> 
> 时间：2009-05-13T08:57:03.407
> 
> 标签：c#, wpf, .net-3.5

在我的 PC 上，默认 DPI 是 96dpi，但我希望我的 WPF 应用程序在 120dpi 上缩放，有什么办法吗？？？

PS：我不想更改电脑设置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T10:56:32.223

为什么不把你的视觉效果/文字放大 30% 呢？

# wcf - 从 WCF UserNamePasswordValidator 正确捕获 SecurityTokenException

> ID：856871
> 
> 赞同：4
> 
> 时间：2009-05-13T08:59:11.920
> 
> 标签：wcf

根据[http://msdn.microsoft.com/en-us/library/system.identitymodel.selectors.usernamepasswordvalidator.aspx](http://msdn.microsoft.com/en-us/library/system.identitymodel.selectors.usernamepasswordvalidator.aspx)上的 UserNamePasswordValidator 示例，如果用户名或密码错误，应该抛出**SecurityTokenException 。**这很好用，但是我没有得到**SecurityTokenException** ，而是得到了**MessageSecurityException**并且我传递的文本消息在某处丢失了。我没有发送“故障细节”。

任何想法如何正确捕获这些错误？我将自己尝试一些事情，看看我是否能做对。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T09:31:08.530

快速查找（为什么我之前没有看到...），我在问题中提供的链接指向[http://msdn.microsoft.com/en-us/library/aa702565.aspx的另一个示例](http://msdn.microsoft.com/en-us/library/aa702565.aspx)

它与第一个示例有些不同，如果您想提供消息详细信息，它有一个关于使用 FaultException 而不是 SecurityTokenException 的评论。

```
public override void Validate(string userName, string password)
{
    if (null == userName || null == password)
    {
        throw new ArgumentNullException();
    }

    if (!(userName == "test1" && password == "1tset") && !(userName == "test2" && password == "2tset"))
    {
        // This throws an informative fault to the client.
        throw new FaultException("Unknown Username or Incorrect Password");
        // When you do not want to throw an infomative fault to the client,
        // throw the following exception.
        // throw new SecurityTokenException("Unknown Username or Incorrect Password");
    }
} 
```

客户端捕获的异常现在包含一个 FaultException 类型的内部异常，其中包含我要公开的文本消息。

# mod-rewrite - Mod重写 - 简单的问题

> ID：856873
> 
> 赞同：0
> 
> 时间：2009-05-13T08:59:24.667
> 
> 标签：mod-rewrite, url-rewriting

这是我当前的 .htaccess

```
Options +FollowSymLinks
DirectoryIndex index.php

RewriteEngine On
RewriteBase /product/

RewriteCond %{ENV:REDIRECT_STATUS} ^$
RewriteRule ^(.+)\.php$ ./$1/ [R=301,L]

RewriteCond %{SCRIPT_FILENAME} !-f
RewriteRule [^/]$ %{REQUEST_URI}/ [R=301,L]

RewriteRule ^contact/?$ ./contact.php [QSA,L] 
```

现在一切正常..

*   /product/contact 返回/product/contact/
*   /product/contact.php 返回 /product/contact/

**问题..**

*   如何使我所有的 .php 文件成为 /contact/ /help/ /faq/
*   现在我应该将contact.php help.php faq.php 添加到htaccess
*   我尝试添加 RewriteRule ^(.*)/$ $1.php [QSA,L] 但它将是返回循环。

让我知道如何解决它；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T09:07:52.203

这条线有可能是倒退的吗？

```
RewriteRule ^(.*)/$ $1.php [L,QSA] 
```

据我了解，这会将 domain.com/product/help/ 重写为 domain.com/product/help.php。尝试

```
RewriteRule ^(.*).php $1/ [L,QSA] 
```

这应该将 domain.com/product/help.php 重写为 domain.com/product/help/ 并将 domain.com/foobar/baz.php 重写为 domain.com/foobar/baz/ 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T09:15:28.570

可悲的是，在你的重写语句中这样做会造成一个无限循环，因为 Apache 会尝试重写`help/`到`help.php`，然后`help.php`再到`help/`等等等等。

如果确实有必要，请在您的应用程序中执行（PHP 中的示例）：

```
<?php 
// The (\?.*)? so it "ignores" query strings
if (preg_match('/\.php(\?.*)?$/', $_SERVER['REQUEST_URI'])) {
  header('Location: ' . str_replace('.php', '/', $_SERVER['REQUEST_URI']));
  exit;
} 
```

# visual-studio - 应该如何管理共享彼此代码的 SharePoint Visual Studio 项目？

> ID：856876
> 
> 赞同：2
> 
> 时间：2009-05-13T09:00:58.687
> 
> 标签：visual-studio, sharepoint, projects-and-solutions, solution, wspbuilder

我的 SharePoint Visual Studio 解决方案结构当前包含以下项目：

*   **Common：**包含扩展方法、助手、常用控件等。
*   **日志记录：**通常会包含在 Common 中，但包含对本地方法的调用，因此标记为“不安全”
*   **特定于站点的项目：**每个不同站点一个，包含特定于该站点的功能、Web 部件、事件接收器等
*   **控制台应用程序：**根据需要/如果需要控制台应用程序项目

我正在使用 WSPBuilder，因此每个项目（除了控制台应用程序）都有自己的 SharePoint WSP 解决方案文件。

这是拆分 SharePoint 代码的好方法吗？你使用什么方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T15:52:43.913

如果您还没有这样做，我会考虑将您的通用代码捆绑到一个或多个功能中，并将非通用代码放在对通用代码具有功能依赖性的功能中。您可能希望公共代码使用不同的 WSP 或相同的 WSP - 不确定所有的优点/缺点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T10:26:58.720

这似乎是合理的，尽管您可能要小心部署共享项目 - 部署脚本可能包括更新公共包，这对于旧的站点特定项目不利。

对于大多数项目，我更喜欢使用包含必要共享库的单个解决方案包 - 通常安装到 GAC。

# java - 如何在我的 JVM 上激活 JMX 以使用 jconsole 进行访问？

> ID：856881
> 
> 赞同：251
> 
> 时间：2009-05-13T09:02:12.837
> 
> 标签：java, jvm, monitoring, jmx, jconsole

如何在 JVM 上激活 JMX 以使用 jconsole 进行访问？

* * *

## 回答 #1

> 赞同：318
> 
> 时间：2009-05-13T09:02:34.410

相关文档可以在这里找到：

[http://java.sun.com/javase/6/docs/technotes/guides/management/agent.html](http://java.sun.com/javase/6/docs/technotes/guides/management/agent.html)

使用以下参数启动您的程序：

```
-Dcom.sun.management.jmxremote
-Dcom.sun.management.jmxremote.port=9010
-Dcom.sun.management.jmxremote.rmi.port=9010
-Dcom.sun.management.jmxremote.local.only=false
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false 
```

例如像这样：

```
java -Dcom.sun.management.jmxremote \
  -Dcom.sun.management.jmxremote.port=9010 \
  -Dcom.sun.management.jmxremote.local.only=false \
  -Dcom.sun.management.jmxremote.authenticate=false \
  -Dcom.sun.management.jmxremote.ssl=false \
  -jar Notepad.jar 
```

`-Dcom.sun.management.jmxremote.local.only=false`不一定需要，但没有它，它在 Ubuntu 上不起作用。错误将是这样的：

```
01 Oct 2008 2:16:22 PM sun.rmi.transport. customer .TCPTransport$AcceptLoop executeAcceptLoop
WARNING: RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,port=0,localport=37278] throws
java.io.IOException: The server sockets created using the LocalRMIServerSocketFactory only accept connections from clients running on the host where the RMI remote objects have been exported.
    at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(LocalRMIServerSocketFactory.java:89)
    at sun.rmi.transport. customer .TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:387)
    at sun.rmi.transport. customer .TCPTransport$AcceptLoop.run(TCPTransport.java:359)
    at java.lang.Thread.run(Thread.java:636) 
```

见[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6754672](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6754672)

**还要小心`-Dcom.sun.management.jmxremote.authenticate=false`**哪个使任何人都可以访问，但是如果您只使用它来跟踪本地机器上的 JVM，那没关系。

**更新**：

在某些情况下，我无法访问服务器。如果我也设置了这个参数，这个问题就得到了修复：`-Djava.rmi.server.hostname=127.0.0.1`

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2016-11-17T22:34:21.513

在 Docker 容器中运行会带来一系列额外的连接问题，因此希望这对某人有所帮助。我最终需要添加以下选项，我将在下面解释：

```
-Dcom.sun.management.jmxremote=true
-Dcom.sun.management.jmxremote.local.only=false
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false
-Djava.rmi.server.hostname=${DOCKER_HOST_IP}
-Dcom.sun.management.jmxremote.port=9999
-Dcom.sun.management.jmxremote.rmi.port=9998 
```

**DOCKER_HOST_IP**

与在本地使用 jconsole 不同，您必须通告与您可能在容器中看到的不同的 IP。您需要替换`${DOCKER_HOST_IP}`为 Docker 主机的外部可解析 IP（DNS 名称）。

**JMX 远程和 RMI 端口**

看起来 JMX 还需要访问远程管理接口 ( [jstat](http://docs.oracle.com/javase/7/docs/technotes/tools/share/jstatd.html) )，该接口在仲裁连接时[使用不同的端口](https://johnpfield.wordpress.com/2014/01/29/how-to-monitor-a-remote-jvm-running-on-rhel/)来传输一些数据。我没有看到任何明显的`jconsole`设置这个值的地方。在链接的文章中，过程是：

*   `jconsole`在启用日志记录的情况下尝试连接
*   失败
*   找出`jconsole`试图使用的端口
*   根据需要使用`iptables`/`firewall`规则以允许该端口连接

虽然可行，但它肯定不是一个可自动化的解决方案。我选择从 jconsole 升级到[VisualVM](https://visualvm.github.io/index.html)，因为它让您明确指定`jstatd`正在运行的端口。在 VisualVM 中，添加一个新的远程主机并使用与上面指定的值相关的值对其进行更新：

[![添加远程主机](https://i.stack.imgur.com/FT8Uw.png)](https://i.stack.imgur.com/FT8Uw.png)

然后右键单击新的远程主机连接并`Add JMX Connection...`

[![添加 JMX 连接](https://i.stack.imgur.com/Wdn0f.png)](https://i.stack.imgur.com/Wdn0f.png)

不要忘记选中 的复选框`Do not require SSL connection`。希望这应该允许您连接。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-13T16:48:09.627

请注意，最新版本的 Java 6 允许 jconsole 将自身附加到正在运行的进程，即使它已在没有 JMX 咒语的情况下启动。

如果您可以使用它，还可以考虑使用 jvisualvm，因为它提供了有关正在运行的进程的大量信息，包括分析器。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-11-20T14:47:55.950

我正在使用 WAS ND 7.0

我的 JVM 需要在 JConsole 中监控以下所有参数

```
 -Djavax.management.builder.initial= 
    -Dcom.sun.management.jmxremote 
    -Dcom.sun.management.jmxremote.port=8855 
    -Dcom.sun.management.jmxremote.authenticate=false 
    -Dcom.sun.management.jmxremote.ssl=false 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-04-18T15:24:45.727

在 Linux 上，我使用了以下参数：

```
-Djavax.management.builder.initial= 
-Dcom.sun.management.jmxremote 
-Dcom.sun.management.jmxremote.port=9010 
-Dcom.sun.management.jmxremote.local.only=false
-Dcom.sun.management.jmxremote.authenticate=false 
-Dcom.sun.management.jmxremote.ssl=false 
```

我还进行了编辑`/etc/hosts`，以便主机名解析为主机地址（192.168.0.x）而不是环回地址（127.0.0.1）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-07-29T07:06:55.177

以下选项对我有用：

```
-Dcom.sun.management.jmxremote=true
-Dcom.sun.management.jmxremote.port=9010
-Dcom.sun.management.jmxremote.rmi.port=9010
-Dcom.sun.management.jmxremote.local.only=false
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false
-Djava.rmi.server.hostname={host name} 
```

并且记得在服务器中打开9010端口

```
sudo ufw allow 9010/udp
sudo ufw allow 9010/tcp
sudo ufw reload 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-11-30T05:11:17.080

连同以下命令行参数，

```
-Dcom.sun.management.jmxremote.port=9999
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false 
```

有时在 linux 服务器中，imx 连接没有成功。那是因为，在云 linux 主机中，在 /etc/hosts 中，主机名解析为主机地址。

修复它的最好方法是，从网络中的其他机器 ping 特定的 linux 服务器，并在

```
-Djava.rmi.server.hostname=IP address that obtained when you ping that linux server. 
```

但永远不要依赖使用 ifconfig.me 从 linux 服务器获得的 ipaddress。您在那里获得的 ip 被屏蔽，它存在于主机文件中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-12T10:22:42.117

使用以下命令行参数运行您的 java 应用程序：

```
-Dcom.sun.management.jmxremote.port=8855
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false 
```

如果您不想在 jmx 主机上设置数字证书，请务必使用**-Dcom.sun.management.jmxremote.ssl=false参数。**

*如果您在 IP 地址为192.168.0.1*的机器上启动应用程序，请打开**jconsole**，将**192.168.0.1:8855**放在*Remote Process*字段中，然后单击*Connect*。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-01-10T05:33:12.213

**第 1 步：**使用以下参数运行应用程序。

```
-Dcom.sun.management.jmxremote.port=9999 
-Dcom.sun.management.jmxremote.authenticate=false 
-Dcom.sun.management.jmxremote.ssl=false 
```

以上参数将应用程序绑定到端口 9999。

**第 2 步：**通过在命令提示符或终端中执行命令 jconsole 来启动 jconsole。

选择“远程进程：”并输入网址为 {IP_Address}:9999，然后单击“连接”按钮以连接到远程应用程序。

您可以参考此[链接](https://self-learning-java-tutorial.blogspot.com/2018/07/jmx-expose-resource-for-remote.html)以获取完整的应用程序。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-03-05T15:18:52.513

**使用远程进程选项运行本地进程 JCONSOLE**

要在本地运行，这对我有用 -

我在我的*vm* args 中添加了这个 -

```
-Dcom.sun.management.jmxremote=true
-Dcom.sun.management.jmxremote.port=6001
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false
-Djava.rmi.server.hostname=localhost
-Dcom.sun.management.jmxremote.rmi.port=6001 
```

*   我通过**Intellij**终端打开了**JConsole**
***   它在本地向我显示所有 PID 为灰色*   所以我选择了远程进程并使用主机登录 - localhost:6001*   保留空的用户名和密码*   然后点击连接**

 *** * *

*   确保没有其他进程在端口 6001 上运行。您也可以使用其他端口。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-01-31T07:51:15.527

首先，您需要检查您的 java 进程是否已经使用 JMX 参数运行。做这个：

```
ps -ef | grep java 
```

检查您需要监控的 java 进程。如果你可以看到 jmx rmi 参数**Djmx.rmi.registry.port=xxxx**然后使用你的 java visualvm 中提到的端口在 jmx 连接下远程连接它。

如果它没有通过 jmx rmi 端口运行，那么您需要使用以下参数运行您的 java 进程：

```
-Djmx.rmi.registry.port=1234 -Djmx.rmi.port=1235 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false 
```

注意：端口号取决于您的选择。

现在您可以将此端口用于 jmx 连接。这里是端口`1234`。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-03-23T10:43:55.800

我遇到了这个确切的问题，并[创建了一个 GitHub 项目来测试和找出正确的设置](https://github.com/cstroe/java-jmx-in-docker-sample-app)。

它包含一个`Dockerfile`支持脚本的工作，以及一个简单`docker-compose.yml`的快速测试。

# .net - HttpWebRequest 到最后带有点的 URL

> ID：856885
> 
> 赞同：28
> 
> 时间：2009-05-13T09:03:09.557
> 
> 标签：.net, httpwebrequest, webrequest

当我使用 WebRequest.Create(" [http://abc/test](http://abc/test) .") 执行 GET 时，我得到 404，因为根据提琴手的说法，.NET 将尾随点剥离，并且 Web 服务器需要该点。我该如何防止或解决它。任何解决方法表示赞赏！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-02-17T23:44:47.427

官方错误报告中解决方法选项卡中的解决方法：

[https://connect.microsoft.com/VisualStudio/feedback/details/386695/system-uri-incorrectly-strips-trailing-dots?wa=wsignin1.0#tabs](https://connect.microsoft.com/VisualStudio/feedback/details/386695/system-uri-incorrectly-strips-trailing-dots?wa=wsignin1.0#tabs)

..似乎是有效的。基本上，在使用 System.Uri 之前，运行此代码以重置 .NET 中的静态标志：

```
MethodInfo getSyntax = typeof(UriParser).GetMethod("GetSyntax", System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic);
FieldInfo flagsField = typeof(UriParser).GetField("m_Flags", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic);
if (getSyntax != null && flagsField != null)
{
    foreach (string scheme in new[] { "http", "https" })
    {
        UriParser parser = (UriParser)getSyntax.Invoke(null, new object[] { scheme });
        if (parser != null)
        {
            int flagsValue = (int)flagsField.GetValue(parser);
            // Clear the CanonicalizeAsFilePath attribute
            if ((flagsValue & 0x1000000) != 0)
                flagsField.SetValue(parser, flagsValue & ~0x1000000);
        }
    }
} 
```

证明：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Reflection;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            var surl = "http://x/y./z";

            var url = new Uri(surl);
            Console.WriteLine("Broken: " + url.ToString());

            MethodInfo getSyntax = typeof(UriParser).GetMethod("GetSyntax", System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic);
            FieldInfo flagsField = typeof(UriParser).GetField("m_Flags", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic);
            if (getSyntax != null && flagsField != null)
            {
                foreach (string scheme in new[] { "http", "https" })
                {
                    UriParser parser = (UriParser)getSyntax.Invoke(null, new object[] { scheme });
                    if (parser != null)
                    {
                        int flagsValue = (int)flagsField.GetValue(parser);
                        // Clear the CanonicalizeAsFilePath attribute
                        if ((flagsValue & 0x1000000) != 0)
                            flagsField.SetValue(parser, flagsValue & ~0x1000000);
                    }
                }
            }

            url = new Uri(surl);
            Console.WriteLine("Fixed: " + url.ToString());

            Console.WriteLine("Press ENTER to exit ...");
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-22T09:46:44.473

将其中的一些重写为不需要您添加任何命名空间的函数

```
 private Uri MyUri(string url)
    {
        Uri uri = new Uri(url);
        System.Reflection.MethodInfo getSyntax = typeof(UriParser).GetMethod("GetSyntax", System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic);
        System.Reflection.FieldInfo flagsField = typeof(UriParser).GetField("m_Flags", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic);
        if (getSyntax != null && flagsField != null)
        {
            foreach (string scheme in new[] { "http", "https" })
            {
                UriParser parser = (UriParser)getSyntax.Invoke(null, new object[] { scheme });
                if (parser != null)
                {
                    int flagsValue = (int)flagsField.GetValue(parser);
                    // Clear the CanonicalizeAsFilePath attribute
                    if ((flagsValue & 0x1000000) != 0)
                        flagsField.SetValue(parser, flagsValue & ~0x1000000);
                }
            }
        }
        uri = new Uri(url);
        return uri;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-13T00:20:03.520

这是在 Microsoft 论坛上多次出现的已知问题。

该类`Uri`错误地认为所有 URI 都像 Windows 磁盘文件一样，其中尾随点（无文件扩展名）不相关。

[http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/5206beca-071f-485d-a2bd-657d635239c9/](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/5206beca-071f-485d-a2bd-657d635239c9/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-29T10:18:01.347

你把点变成字符串到十六进制

```
  string.format("{0:x2}",yoururl);
```

我认为它对你很有用，因为我在 twitter API Oauth 格式中使用了它

# sharepoint - 从 Word 签入后文档未更新

> ID：856886
> 
> 赞同：1
> 
> 时间：2009-05-13T09:03:21.210
> 
> 标签：sharepoint, ms-word, ms-office, checkin

我们的一位客户在将文档签入到 SharePoint 库表单 Word 2007 时遇到很大问题。每当她将文档签入到库中时，元数据作为版本号和签入注释都会更新，但不会更新文档本身。

该库的配置方式是激活版本控制并且在编辑之前必须签出文档。

我认为这与某些 Office 2007 或操作系统设置有关，因为她的所有其他大学都可以毫无问题地签入文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T10:20:46.327

我最近遇到了类似的问题。该文档可能正在上传，但是当您尝试下载它时，某种缓存或代理问题导致出现旧版本。

为了隔离问题，我建议您尝试多次上传文本文件。

不确定您是否可以访问实际导致问题的组件，但作为一种解决方法，重命名文件应该会有所帮助。

# java - 通过 AbstractTableModel 获取选定的行

> ID：856888
> 
> 赞同：5
> 
> 时间：2009-05-13T09:03:47.747
> 
> 标签：java, swing, jtable

是否可以从我的表模型中获取选定的行索引？

我的对象已经知道表模型。我可以使用模型获取选定的索引，而不是传递对它自己的表的引用吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-13T10:23:00.223

就像 MrWiggles 说的那样，您可以从 ListSelectionModel 中获取它，您可以从表本身访问它。但是，JTable 中也有一些方便的方法来获取选定的行。如果您的表是可排序的等，您还需要通过 convertRowIndexToModel 方法:)

来自 JTable JavaDoc：

```
 int[] selection = table.getSelectedRows();
   for (int i = 0; i < selection.length; i++) {
     selection[i] = table.convertRowIndexToModel(selection[i]);
   }
   // selection is now in terms of the underlying TableModel 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T10:12:04.127

TableModel 只关注数据，ListSelectionModel 关注当前选择的内容，因此，不，您无法从 TableModel 中获取选定的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T10:25:36.567

如果您让您的模型类实现 ListSelectionModel 以及 TableModel，您将能够从一个模型中进行选择......但是您不能扩展两个抽象模型类:-(（作为您的类，这也不是一个好主意会承担太多的责任）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-31T12:34:53.330

您可以从绑定的 Table 中获取索引，然后您可以使用它来操作表模型。例如，如果我想在我的表模型中删除一个 Row：

```
myTableModel.removeValueAt(myTable.getSelectedRow()); 
```

# c# - C# 编程风格问题 - 实赋值前的 Null 赋值

> ID：856889
> 
> 赞同：5
> 
> 时间：2009-05-13T09:03:58.543
> 
> 标签：c#, coding-style

编程这种风格是否有充分的理由（优势）

```
XmlDocument doc = null;
doc = xmlDocuments[3]; 
```

对比

```
XmlDocument doc = xmlDocuments[3]; 
```

我看过很多次，但对我来说它似乎过于冗长

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-13T09:07:42.780

不 - 通常认为最好的做法是尽可能晚地声明变量，最好在声明时设置它。我唯一不这样做的时候是我必须有条件地设置一个变量，或者它被设置在一个更严格的范围内：

```
String name;
using (TextReader reader = ...)
{
    // I can't declare name here, because otherwise it isn't
    // accessible afterwards
    name = reader.ReadToEnd();
} 
```

在可能的情况下在首次使用时声明的原因：

*   它使变量的类型接近其使用 - 无需在方法中向上滚动即可找到它。
*   它使范围尽可能窄，这使得变量的使用更加明显。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-13T09:07:13.653

我会用

```
XmlDocument doc = xmlDocuments[3]; 
```

在使用它们的地方声明变量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T09:14:23.597

它们是不同的风格，客观上它们都不比另一个更好。这只是口味问题。您可以先声明变量，然后为其赋值：

```
XmlDocument doc;
doc = xmlDocuments[3]; 
```

或者您可以在同一个语句中同时执行这两项操作：

```
XmlDocument doc = xmlDocuments[3]; 
```

但是，这种形式：

```
XmlDocument doc = null;
doc = xmlDocuments[3]; 
```

为变量分配空引用然后立即用不同的引用替换它是完全没有意义的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T09:11:15.613

理想情况下，声明和赋值应该配对以提高代码的可读性。事实上，ReSharper 会发现任何例外情况并建议将它们加入。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T09:23:17.373

正如其他人指出的那样，如果您需要在循环范围之外声明变量，则第一种样式可能很有用，如果或其他。但在大多数情况下，我认为这种风格是 Visual Basic 6（及更早版本）的旧时代的遗留物，在这种情况下，您总是必须在使用 in 之前声明一个变量。

旧 VB 不支持您的第二种风格，因此第一种风格仍然很流行......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T09:30:30.090

我喜欢将变量视为“共享”或“不共享”，因为有些变量需要在类或方法的多个位置使用，而有些则只需要使用一次。对于前者，我将它们全部声明在相关块的顶部，后者我在使用它们之前声明它们。

这完全取决于您需要在哪里使用它们。

情况1：

```
Xyz xyz = new Xyz; // Declared at the top.
// Loads of unrelated code in-between...
xyz.abc();
// More unrelated code in-between...
xyz.def(stuff); 
```

案例二：

```
// Loads of unrelated code above...
Xyz xyz = new Xyz; // Declared in a 'block'.
xyz.abc();
xyz.def(stuff);
xyz.destroy();
// More unrelated code below... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T09:08:33.543

如果变量“doc”在声明*后*立即分配，那么不，我看不出您有任何理由要这样做。无论如何，这肯定不是我的风格。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T10:44:46.380

我主要同意乔恩（更不用说通常我必须同意他:-)。

你有选择：

1.

```
//Do something...
XmlDocument doc = xmlDocuments[3];
//use doc
//Do something... 
```

2.

```
//Do something...
XmlDocument doc = null;
doc = xmlDocuments[3];
//Use doc
//Do something... 
```

3.

```
//Do something...
XmlDocument doc = null;
//...Do something with other variables etc...
doc = xmlDocuments[3];
//Do something...
//Use doc 
```

4.

```
//Do something...
XmlDocument doc = null;
//...Do something with other variables etc...
doc = xmlDocuments[3];
//Use doc
//Do something... 
```

5.

```
//Do something...
XmlDocument doc = null;
doc = xmlDocuments[3];
//Do something...
//Use doc 
```

6.

```
//Do something...
XmlDocument doc = xmlDocuments[3];
//Do something...
//use doc 
```

我希望你能看到选项 1 很有意义。

最好将声明、定义和初始化尽可能“放在一起”。选项 1 是在一行中一起完成声明、定义和初始化的示例。您可以进一步压缩它：

```
var doc = xmlDocuments[3]; 
```

词汇（与语言无关）：

*   声明：Coder 为编译器引入了新名称。
*   类型绑定：类型推断、使用超类型等。
*   定义：编码器使编译器保留空间。（在堆栈等 - 请注意外部名称不需要空间）
*   初始化：编码器在定义过程中第一次赋值。在大多数情况下，如果编码器忽略初始化，编译器会进行初始化（对 null、0、false、默认值等）。
*   用法：明显！
*   范围：很明显！
*   可访问性（如适用）。： 明显的！
*   修饰符：实例级别、类级别、方法级别、常量、只读等。

我希望这有帮助。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-13T09:08:22.543

我更喜欢使用这个：

```
XmlDocument doc = null;
//blah blah
doc = xmlDocuments[3]; 
```

我只想在需要时分配和使用'doc'..

如果我想在分配后立即使用它，我会选择

```
 XmlDocument doc = xmlDocuments[3]; 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-05-13T09:05:49.100

我会去

```
void Foo()
{
  XmlDocument doc;

  //Do other code here

  //Create doc
  doc = xmlDocuments[3];
} 
```

因为 doc 可能直到稍后在该方法中才被使用。在使用之前创建文档更有意义。更容易阅读（更少滚动）。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-05-13T09:07:56.507

如果可能，我总是尝试在同一行上声明和分配变量，所以在这种情况下，我会尝试使用第二个选项。在阅读代码时也要记住更少的代码行，更少的声明变量。最后，我认为这完全取决于您和您的团队使用的编码规则。我们有编码规则，规定在方法的开头声明所有局部变量，所以我已经看到了这两种编程风格。

# ruby - 用 ruby 解压（zip、tar、tag.gz）文件

> ID：856891
> 
> 赞同：34
> 
> 时间：2009-05-13T09:05:29.023
> 
> 标签：ruby, zip, gzip, tar, unzip

我想解压缩很多 zip 文件。是否有一个模块或脚本可以检查 zip 文件的格式并解压缩它？这应该适用于 Linux，我不关心其他操作系统。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-16T13:41:44.567

要从 .tar.gz 文件中提取文件，您可以从随 Ruby 分发的包中使用以下方法：

```
require 'rubygems/package'
require 'zlib'
tar_extract = Gem::Package::TarReader.new(Zlib::GzipReader.open('Path/To/myfile.tar.gz'))
tar_extract.rewind # The extract has to be rewinded after every iteration
tar_extract.each do |entry|
  puts entry.full_name
  puts entry.directory?
  puts entry.file?
  # puts entry.read
end
tar_extract.close 
```

每个[Gem::Package::TarReader::Entry](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/rubygems/rdoc/Gem/Package/TarReader/Entry.html)类型的条目都指向 .tar.gz 文件中的一个文件或目录。

可以使用类似的代码（将 Reader 替换为 Writer）将文件写入 .tar.gz 文件。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2010-01-06T16:13:46.627

最简单的方法可能是使用 Zlib

Zlib 是一个 Ruby 库。下面是一个简单的程序，用于从特定 URL 获取压缩文件，解压缩，然后将其内容粘贴到屏幕上。

```
require 'zlib' 
require 'open-uri'

uri = "www.somedomain.com/filename.gz"
source = open(uri)
gz = Zlib::GzipReader.new(source) 
result = gz.read
puts result 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-10-02T14:16:29.687

虽然[Florian 的回答](https://stackoverflow.com/a/11505644/170230)是正确的，但它没有考虑[tar LongLinks](https://stackoverflow.com/q/2078778/170230) （尝试从 oracle :P 中提取[jdk-7u40-linux-i586.tar.gz ）。](http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html)以下代码应该能够做到这一点：

```
require 'rubygems/package'
require 'zlib'

TAR_LONGLINK = '././@LongLink'
tar_gz_archive = '/path/to/archive.tar.gz'
destination = '/where/extract/to'

Gem::Package::TarReader.new( Zlib::GzipReader.open tar_gz_archive ) do |tar|
  dest = nil
  tar.each do |entry|
    if entry.full_name == TAR_LONGLINK
      dest = File.join destination, entry.read.strip
      next
    end
    dest ||= File.join destination, entry.full_name
    if entry.directory?
      File.delete dest if File.file? dest
      FileUtils.mkdir_p dest, :mode => entry.header.mode, :verbose => false
    elsif entry.file?
      FileUtils.rm_rf dest if File.directory? dest
      File.open dest, "wb" do |f|
        f.print entry.read
      end
      FileUtils.chmod entry.header.mode, dest, :verbose => false
    elsif entry.header.typeflag == '2' #Symlink!
      File.symlink entry.header.linkname, dest
    end
    dest = nil
  end
end 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-09T07:17:52.313

德拉科，谢谢你的[片段](https://stackoverflow.com/a/19139114)。一些 TAR 将目录编码为以“/”结尾的路径 - 请参阅[此](https://en.wikipedia.org/wiki/Tar_%28computing%29)Wiki。示例 tar 是[适用于 Windows 的 Oracle Server JRE 7u80](http://www.oracle.com/technetwork/java/javase/downloads/server-jre7-downloads-1931105.html)。这对他们有用：

```
require 'fileutils'
require 'rubygems/package'
require 'zlib'

TAR_LONGLINK = '././@LongLink'

Gem::Package::TarReader.new( Zlib::GzipReader.open tar_gz_archive ) do |tar|
        dest = nil
        tar.each do |entry|
            if entry.full_name == TAR_LONGLINK
                dest = File.join destination, entry.read.strip
                next
            end
            dest ||= File.join destination, entry.full_name
            if entry.directory? || (entry.header.typeflag == '' && entry.full_name.end_with?('/'))
                File.delete dest if File.file? dest
                FileUtils.mkdir_p dest, :mode => entry.header.mode, :verbose => false
            elsif entry.file? || (entry.header.typeflag == '' && !entry.full_name.end_with?('/'))
                FileUtils.rm_rf dest if File.directory? dest
                File.open dest, "wb" do |f|
                    f.print entry.read
                end
                FileUtils.chmod entry.header.mode, dest, :verbose => false
            elsif entry.header.typeflag == '2' #Symlink!
                File.symlink entry.header.linkname, dest
            else
                puts "Unkown tar entry: #{entry.full_name} type: #{entry.header.typeflag}."
            end
            dest = nil
        end
    end
end 
```

# xcode - 可以告诉clang不要分析某些文件吗？

> ID：856895
> 
> 赞同：23
> 
> 时间：2009-05-13T09:06:41.643
> 
> 标签：xcode, profiling, clang

我正在尝试使用 clang 来分析我正在从事的项目。该项目包括一个相当大的静态库，它作为依赖项包含在 Xcode 中。

我真的希望 clang 不分析依赖项的文件，因为它似乎使 clang 失败。这可能吗？我一直在阅读clang文档，但我没有找到它。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-03-10T20:32:41.630

作为最后的手段，有一个蛮力选项。

将此添加到文件的开头：

```
// Omit from static analysis.
#ifndef __clang_analyzer__ 
```

将此添加到末尾：

```
#endif // not __clang_analyzer__ 
```

并且 clang --analyze 不会看到文件的内容。

参考：[控制静态分析器诊断](http://clang.llvm.org/docs/UsersManual.html#controlling-static-analyzer-diagnostics)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-22T23:55:53.810

所以，这不是一个真正的答案，但它工作得很好。

我最终做的是提前构建静态库，然后使用 scan-build 构建项目。由于静态库已经有一个最新的构建，它没有被重建，因此没有被扫描。

不过，我仍然希望对此有一个真正的答案。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-04-02T05:31:39.997

最后，在 2018 年实施了该选项。

使用`--exclude <path>` [[1]](https://bugs.llvm.org/show_bug.cgi?id=22594) [[2]](https://reviews.llvm.org/D52153)选项

> - 排除
> 
> 不要针对在此目录中找到的文件运行静态分析器（您可以多次指定此选项）。当项目包含 3rd 方库时可能很有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-07T21:52:47.403

我不使用 XCode，但在 linux 中使用 scan-build 以下对我有用。我的情况是，我想对所有第一方非生成代码运行静态分析。但是，我想避免在第三方代码和生成的代码上运行它。

在命令行上，当 scan-build 将 CC 和 CXX 环境变量设置为 ccc-analyzer 和 c++-analyzer 位置时，clang-analyzer 会挂接到构建中。我编写了两个名为 ccc-analyzer.py 和 c++-analyzer.py 的简单脚本，并将它们连接到编译器中以代替默认值。在这些包装脚本中，我只是查看了正在编译的文件的路径，然后直接运行原始编译器（如果我希望避免静态分析）或 c*-analyzer（如果我希望进行静态分析）。我的脚本在 python 中并与我的特定构建系统相关联，但作为需要修改的示例：

```
import subprocess
import sys

def main(argv):
  is_third_party_code = False
  for i in range(len(argv)):
    arg = argv[i]
    if arg == '-c':
      file_to_compile = argv[i + 1]
      if '/third_party/' in file_to_compile or \
            file_to_compile.startswith('gen/'):
        is_third_party_code = True
      break
  if is_third_party_code:
    argv[0] = '/samegoal/bin/clang++'
  else:
    argv[0] = '/samegoal/scan-build/c++-analyzer'
  return subprocess.call(argv)

if __name__ == '__main__':
  sys.exit(main(sys.argv)) 
```

# c# - 以通用/抽象方式添加关系实体

> ID：856903
> 
> 赞同：0
> 
> 时间：2009-05-13T09:07:58.550
> 
> 标签：c#, wcf, entity-framework

我正在尝试编写一个 WCF 方法，该方法将从客户端接收一个分离的 EntityObject，并将能够判断该实体的哪些属性和哪些关系已更改，并将其与上下文中已有的内容进行比较。当然，如果这个实体是一个新实体，或者它的其中一个关系被添加/删除/修改，它也应该认识到这一点并采取相应的行动。

我已经能够识别实体的关系是否是新关系，但似乎无法正确添加它。- 对于我尝试的每一种方法，我都会遇到不同的异常。

这是我用来更新分离对象的方法：

```
public static void AttachUpdated(this ObjectContext context, EntityObject objectDetached)
{
    if (objectDetached.EntityState == EntityState.Detached)
    {
        object currentEntityInDb = null;

        if (context.TryGetObjectByKey(objectDetached.EntityKey, out currentEntityInDb))
        {
            context.ApplyPropertyChanges(objectDetached.EntityKey.EntitySetName, objectDetached);
            //Apply property changes to all referenced entities in context 
            context.ApplyReferencePropertyChanges((IEntityWithRelationships)objectDetached,
                                                  (IEntityWithRelationships)currentEntityInDb); //Custom extensor method 
        }
        else
        {
            //The entity should be added
            //?????
        }
    }
} 
```

这是我用来更新实体关系的一种方法：

```
public static void ApplyReferencePropertyChanges(this ObjectContext context,
                                                         IEntityWithRelationships newEntity,
                                                         IEntityWithRelationships oldEntity)
{
    foreach (var oldRelatedEnd in oldEntity.RelationshipManager.GetAllRelatedEnds())
    {
        var oldRef = oldRelatedEnd as EntityReference;

        if (oldRef != null)
        {
            // this related end is a reference not a collection 
            var newRef = newEntity.RelationshipManager.GetRelatedEnd(oldRef.RelationshipName, oldRef.TargetRoleName) as EntityReference;
            if (newRef.EntityKey != null)
            {
                oldRef.EntityKey = newRef.EntityKey;
            }
            else
            {   
                //When oldRed is a 1:Many relationship
                //newRef is an EntityReference<TEntity> object
                EntityObject entity = newRef.GetType().GetProperty("Value").GetValue(newRef, null) as EntityObject;
                oldRef.EntityKey = entity.EntityKey;
            }
        }
        else
        {
            IRelatedEnd newRelatedEnd = newEntity.RelationshipManager.GetRelatedEnd(oldRelatedEnd.RelationshipName, oldRelatedEnd.TargetRoleName);
            foreach (IEntityWithRelationships e in newRelatedEnd)
            {
                if (!oldRelatedEnd.Contains((e as IEntityWithKey).EntityKey))
                {
                    //this is a new relation and it needs to be added.
                    //???????
                }
                else
                {
                    //Find out if relation was modified - and update it if needed
                    //????????
                }
            }
            IEnumerable entities = oldRelatedEnd as IEnumerable;

        }
    }
} 
```

应该如何实施？

请帮忙 ：（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-11T19:16:41.523

I'm not sure what you want to achieve - if you want to save the changes in the server side you can use ADO .Net Data Services. Is that the case?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-12T00:01:42.883

见[英仙座](http://code.msdn.microsoft.com/entitybag)：

> Perseus 是一个小型项目，旨在探索通过 WCF Web 服务交换实体框架实体图的方法。该项目的关键部分是 EntityBag，它存储实体图以及更改跟踪信息。希望没有人会用它来存储和运输像美杜莎的头这样讨厌的东西。;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T21:53:05.230

你的 ObjectContext 来自哪里？（我假设这是您的实体框架数据库参考）

这里可能有两个问题：

首先，我不认为 ObjectContext 是可序列化的，所以如果你将它发送到客户端然后再发送回来，你会得到一个错误。

其次，如果您将 ObjectConext 保留在服务器上，则服务器对象默认是每次调用，而不是每次会话，因此您将尝试将您的实体与新的 ObjectContext 相关联。

在我们的项目中，我们将实体框架对象映射到数据传输对象，以便通过 WCF 进行发送。在实体框架的下一个版本中，您尝试做的事情可能会更容易（可能吗？）。

# javascript - 用于命令行实用程序的 Javascript

> ID：856908
> 
> 赞同：6
> 
> 时间：2009-05-13T09:09:21.060
> 
> 标签：javascript, command-line

鉴于需要编写命令行实用程序来执行常见任务，例如将文件上传到远程 FTP 站点、从远程 MySQL 数据库下载数据等。

将 JavaScript 用于此类事情是否可行？我知道有可以从命令行运行的 JavaScript 解释器，但是是否有用于 FTP 和数据库访问之类的库，例如 Java？如果是这样，寻找它们的最佳地点是什么？（在关键字中使用 JavaScript 进行 Google 搜索似乎总是返回许多浏览器特定内容的页面。）

有没有办法将 JavaScript 程序打包为 Windows 上的独立可执行文件？

更新：我认为 Python 是完成此类工作的更好工具，但对原始问题的答案仍然很好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T11:09:22.130

独立可执行文件？

顺便说一句，我不确定您是否知道，但 Windows 脚本主机（包含在 Windows 中）允许您从命令行运行 .js 文件。您的 javascript 将不是可执行文件，它仍将是一个脚本、一个文本文件。该脚本在 WSH 提供的 cscript.exe 中运行。不需要编译。也许你知道这一切。

我以这种方式将 Javascript 用于 Windows 上的各种实用程序。

我认为您对图书馆的可用性的直觉是正确的。您可以*靠自己*找到所有这些东西。虽然，一旦找到它们，将 Javascript 库打包为 COM 组件并允许在任何地方重用并不难。 有关在 COM 中打包 Google Diff/Patch/Match Javascript 库[的示例，请参见此处。](https://stackoverflow.com/questions/848246/how-can-i-use-javascript-within-an-excel-macro)

**附录**：一旦在 COM 中有一些代码可用，它就可以被机器上运行的任何 Javascript 使用。在 WSH 中运行的 Javascript 脚本可用的一些 COM 对象示例：

*   [MSXML2.XMLHTTP 对象](http://support.microsoft.com/kb/296772)- 用于 AJAX，但可用于任何 HTTP 通信。XSLT 引擎还有一个对象，因此您可以从脚本进行转换。
*   [Excel.Application](http://msdn.microsoft.com/en-us/library/7sw4ddf8(VS.85).aspx) - 允许您打开 Excel 电子表格并从 Javascript 自动化它们。
*   [Communicator.UIAutomation](http://msdn.microsoft.com/en-us/library/bb758725.aspx) - 自动化 MS Communicator（通过脚本发送 IM）
*   [谷歌地球的 COM 对象](http://search.live.com/results.aspx?q=%2bgoogleearth.applicationge)。
*   [SlowAES](https://stackoverflow.com/questions/270510/how-to-encrypt-in-vbscript-using-aes/858525#858525) - AES 加密的全 Javascript 实现。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-13T09:16:40.957

您可以使用 Rhino 将 Javascript 编译成 Java 字节码，并访问所有 J​​ava 库。

或者您可以使用 JScript.net，并访问 .net 库。.net 包含一个生成 exe 文件的 jsc.exe。

这两个都需要安装相应的框架才能运行。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-03T00:05:43.133

[Node.js](http://nodejs.org/#download)是迄今为止运行非浏览器 JS 的最佳环境。我使用过 Rhino 和 SpiderMonkey，从基础知识（如如何处理错误）到使用该工具的社区规模，一切都有很大的不同。Node 被定位为“服务器端”JS——在 JS 中构建服务器应用程序。这很好。但它同样适用于构建命令行工具。

NPM 包管理器（与 Node 捆绑在一起）为查找和安装包提供了一个很好的全局目录。它比 PECL / Pear / CPAN / 等其他语言等价物工作得更好。一些高质量的工具，如[JSHint](http://www.jshint.com/)、[Jade](http://jade-lang.com/)模板语言和[CoffeeScript](http://coffeescript.org/)编译器都已经可以通过 NPM/Node 获得：

```
npm install -g jshint, coffee-script, jade
jshint my_code.js
jade < my.jade > my.html 
```

对于 args 解析，有诸如 command.js 之类的[包](http://tjholowaychuk.com/post/9103188408/commander-js-nodejs-command-line-interfaces-made-easy)。[我目前在我的underscore-cli](http://github.com/ddopson/underscore-cli)命令行工具中使用了一个高度扩展的 Commander 版本。

对于搞乱 JSON 或进行命令行 JS 工作（类似于“perl -pe”），请查看[underscore-cli](http://github.com/ddopson/underscore-cli) - 它是一个非常强大的工具，用于处理 JSON 数据、处理下划线模板和从命令运行 JS 表达式 -线。我将它用于 1001 种不同的事情，否则这些事情会很烦人。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-13T11:25:47.500

Rhino 与 JDK 1.6 捆绑在一起，bin 目录中的 jrunscript.exe 将允许您运行任何您想要的 Javascript。由于它在 Java 下运行，因此您可以访问您可能拥有的任何 Java 库。

我们从命令行广泛使用它。它非常擅长这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T09:17:22.670

一种方法是将这些实用程序编写为 AIR 应用程序 - 它们可以用 JavaScript 编写并且不需要 UI。他们可以访问命令行，并且现有的 ActionScript 3 库可以处理 FTP 等。这些 ActionScript API 可以在 AIR 应用程序中从 JS 调用。AIR 应用程序还可以访问 sqlite 数据库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-04T10:08:27.553

[jslibs](http://code.google.com/p/jslibs/)是一个很好的独立 JavaScript 运行时，支持许多 3rd 方开源库，如 zlib、SQLite、NSPR、libiconv、libTomCrypt、OpenGL...

# algorithm - 为软件实施许可机制

> ID：856910
> 
> 赞同：10
> 
> 时间：2009-05-13T09:09:34.353
> 
> 标签：algorithm, licensing, piracy-prevention

我正在考虑实施一个良好的许可机制，该机制具有良好的反盗版能力。所需的机制不应在每次使用软件时都使用互联网连接。我正在考虑一种基于硬件 ID 等的机制。你们有更好的建议吗？制作防黑客许可机制需要关注哪些参数/算法/特征？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T09:33:36.700

理想情况下，您需要与操作系统无关的东西。

我建议您将许可证保护嵌入到您的代码中，或者将您的应用程序包装在其中，以使其在没有首先运行复制保护代码的情况下无法运行。

如果您的应用程序需要一个许可证密钥文件才能运行，并且该文件不是在本地生成的，那将是最好的。

这样做的一种方法是，您的应用程序会根据其初始运行时的硬件生成某种形式的图像代码。这是提供给您的，作为回报，您提供允许代码运行的许可证密钥。最好以 CPU 和主板为基础的硬件映像，因为这些更改最少。

你的应用程序。应在运行时检查硬件映像和许可证密钥。

如果你想要你的应用程序。许可证时间有限，那么它还应该跟踪它运行了多长时间并将其嵌入到许可证密钥文件中。

不要忘记加密许可证文件。

也不要忘记通过使用 dotfuscator 或类似工具来增加反向编译可执行文件的难度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T09:13:55.687

检查这个问题：[您使用什么复制保护技术？](https://stackoverflow.com/questions/515020/what-copy-protection-technique-do-you-use)

它还链接到其他相关问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T09:21:22.180

首先，没有什么是防黑客的，所以我不会花太多时间来保护您的软件。

基于硬件 ID 的机制的缺点是，当用户购买新计算机或升级他的大部分计算机时，他也需要更新密钥。 ~~[HWHash](http://www.hwhash.com)是一个很好的 HardwareID 实现，但我想还有更多（免费）解决方案。~~ 在工作中，我们使用 Hardlock 和[Hasp](http://www.aladdin.com/hasp/default.aspx)密钥，但这些是 usbkey 解决方案，对于小型应用程序不是很有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-27T08:01:54.283

> 我正在考虑实施一个良好的许可机制，该机制具有良好的反盗版能力。所需的机制不应在每次使用软件时都使用互联网连接。

那么如何定期在线检查许可证呢？

当用户第一次登录时，用户根据他的帐户验证安装，并且许可证文件存储在用户 PC 上。此许可证文件已加密，并包含唯一标识许可证所需的所有数据。这一切都存储在您的服务器上。

许可证文件在设定的天数甚至数月内到期。文件过期后登录会检查帐户并验证其合法性。此时您甚至可以考虑生成新的许可证文件。

在用户互联网中断并且无法注册许可证的情况下，应该有一些聪明的做法。也许7天。

如果在新计算机上重新安装软件，用户必须重复验证过程。

正如其他人所说，没有办法打败一个坚定的盗版者，因为这样的人会破解代码，但这应该可以防止或减缓随意的盗版行为。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T09:29:33.947

你可以看看[微软的](http://msdn.microsoft.com/en-us/library/bb931699.aspx)SLP——我没用过，但它看起来确实很有趣（你知道，如果你喜欢 MS 的东西......）

需要注意的重要一点 - 没有任何许可机制可以保护您免受盗版，甚至大大减少盗版。根据定义，许可机制将是客户端的——这本质上是可破解的。看看 DRM 发生了什么...

因此，您的指导方针应该是可用性 - 意图*应该*是把它用作一般政策，好人将轻松地限制他们应该被允许做的事情，而坏人 - 好吧，坏人会得到无论如何，围绕你的意图，你最好的希望是让它更有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T09:44:18.617

我会非常警惕已发布的软件保护机制，因为它们更有可能发布黑客攻击。您最好使用一些技术来获得唯一的持久 ID，并使用它来滚动您自己的保护机制。我还认为，在运行程序时简单地检查许可证是一个糟糕的主意，因为这会将黑客引导到您的保护机制的位置。IMO，您最好以更随机的方式检查许可证，并且每个会话不止一次。

FWIW，我为我的高端桌面软件使用硬件锁 (hasp)，并在移动解决方案上使用基于设备 ID 的许可。如果您在垂直市场上销售少量高成本软件，恕我直言，良好的许可证保护机制是有意义的，并且硬件加密狗运行良好。我的经验是，如果不这样做，人们将使用比购买更多的许可证。对于大容量、低成本的软件，我倾向于忍受基于增加用户群规模和产品知名度的盗版。

# security - 软暴力破解您自己的 GPG/PGP 密码的最佳方法？

> ID：856912
> 
> 赞同：26
> 
> 时间：2009-05-13T09:10:36.037
> 
> 标签：security, gnupg, gpgme

我创建了一个不错的长密码，使用了几次，然后就忘记了；）扭曲的是，我知道一般主题，可能几乎所有字符。我的完美主义者不想撤销密钥或类似的东西（而且我认为无论如何我都需要密码来撤销它，对吧？）。我觉得我应该能够通过暴力破解我输入错误/错误输入的可能布局/字符来解决这个问题。我编写了一个 C 程序来产生这样的组合。不幸的是，我手头没有代码（我现在会以“它不相关”的借口去；）。我也遇到了一些[代码](http://www.vanheusden.com/nasty/)在网络上使用 GPGME 来做这个作为概念验证。它有评论“这很容易快 100 倍”。问题是，分析代码显示瓶颈是 GPGME 调用本身。这是预期的，还是 GPGME 的限制可以使用完整的库或专用实现来解决？

你会怎么做呢？显然，这种方法对于任何像样的*未知*密码短语都是不可行的，但我认为关键是我知道我输入*了什么而不**知道*我输入它的确切格式- 应该是可行的，不是吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-05T08:25:05.217

> （而且我认为无论如何我都需要密码来撤销它，对吧？）

不，您需要撤销密钥。您应该在创建密钥时生成并打印出来。然后将其存储在安全的地方，而不是当您不希望有人使用它来撤销您的密钥时。

我试图暴力破解我几乎记得的密码，但没有成功。仍然有*很多*排列，并且需要很多规则才能将其缩小到合理的问题规模。我从来没有在这方面努力过，因为幸运的是我从来没有忘记我的 GPG 密码。大多数情况下，当我忘记密码时，它是对大学远程机器的登录，而且我从不想用我的猜测来敲击 ssh 端口或 webmail。

也许你调用的函数做了很多不依赖于键的设置？因此，您可以通过将代码从库中复制出来并稍后将蛮力循环放入其中来加快速度。

# reporting-services - 如何在 SSRS 中使用另一个数据集表值过滤一个数据集值

> ID：856913
> 
> 赞同：12
> 
> 时间：2009-05-13T09:10:57.860
> 
> 标签：reporting-services

如何在 SSRS 中使用另一个数据集表值过滤一个数据集表。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-29T21:08:48.137

不确定在 SSRS 2005 中是否有更好的方法来执行此操作，但这应该可以：

1.  创建数据集 A。这将是您的过滤器数据集。您应该只返回一个值列。（如果您需要多个值，则必须加入它们）
2.  创建一个名为 ParameterA 的新报表参数。将可用值和默认值设置为数据集 A 的值列结果。将参数设置为隐藏（我认为内部可能是更好的选择..试试看）
3.  创建第二个数据集 B。将 ParameterA 作为参数添加到数据集 B，称为 @parameterA。
4.  在您的查询中，使用如下参数：

> SELECT blah blah WHERE valueColumn IN (@parameterA)

这应该可以满足您的需求。它不漂亮，但它应该工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-14T18:02:00.207

要过滤第二个数据集，如主/详细信息，您需要使用子报表，将第二个数据集放在子报表中并通过子报表参数过滤它。子报表，当放置在报表上时，可以具有来自第一个数据集字段的参数值。

# mobile-phones - GSM 手机是否默认配备 RFID 芯片？

> ID：856916
> 
> 赞同：0
> 
> 时间：2009-05-13T09:11:25.893
> 
> 标签：mobile-phones, rfid

前几天我听到了一些有趣的事情，我不确定我是否相信，但同时我很好奇我是否弄错了。

我听说*每个*GSM 手机里面都有一个 RFID 芯片，因为 SIM 卡的功能是 RFID 芯片。这是对还是错？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T09:25:50.503

我不明白这是如何与编程相关的，但无论如何。

SIM 卡确实为无线（“RF”）设备提供“ID”，但是，它不提供通用 RFID 定义下的 RFID 功能。（SIM 卡不通过 RF 发送 ID）

SIM： [http ://en.wikipedia.org/wiki/Subscriber_Identity_Module](http://en.wikipedia.org/wiki/Subscriber_Identity_Module)

RFID： [http ://en.wikipedia.org/wiki/RFID](http://en.wikipedia.org/wiki/RFID)

# c# - 我如何知道系统滚动条的当前宽度？

> ID：856917
> 
> 赞同：105
> 
> 时间：2009-05-13T09:12:31.180
> 
> 标签：c#, winforms

如您所知，可以在显示属性 -> 外观 -> 高级 -> 项目：滚动条中自定义滚动条宽度的宽度。默认值为 17。但是，我不能假设总是如此，我可以检索这个值吗？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-05-13T09:13:35.767

看看`System.Windows.Forms.SystemInformation`班级成员：[`HorizontalScrollBarHeight`](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.horizontalscrollbarheight.aspx)和[`VerticalScrollBarWidth`](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.verticalscrollbarwidth.aspx)。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2010-01-21T22:32:19.463

垂直滚动条宽度

```
System.Windows.Forms.SystemInformation.VerticalScrollBarWidth; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-04-02T12:34:28.900

如果你想知道a的大小`ScrollableControl`减去滚动条的大小，最简单的方法是使用`Control.ClientSize`属性。

从[文档](http://msdn.microsoft.com/library/system.windows.forms.control.clientsize%28v=vs.110%29.aspx)中：

> 获取或设置控件工作区的高度和宽度。控件的客户区是控件的边界，**减去滚动条**、边框、标题栏和菜单等非客户元素。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-01-12T23:57:42.670

跳过控件的 ClientSize 属性。至少在 VS2013 中，滚动条包含在 ClientSize 中。

当我格式化一个宽度为 304 和垂直滚动条的 RichTextBox 时，Client Size 宽度为 300，仅占边框。

坚持使用 System.Windows.Forms.SystemInformation.VerticalScrollBarWidth 来获取滚动条宽度。

# c# - C# 反射：获取嵌套对象的属性

> ID：856922
> 
> 赞同：4
> 
> 时间：2009-05-13T09:14:13.220
> 
> 标签：c#, reflection

我在获取嵌套对象属性时遇到问题。对于我正在使用的示例，我有 2 个类：

```
public class user 
{
  public int _user_id {get; set;}
  public string name {get; set;}
  public category {get; set;}
}

public class category 
{
  public int category_id {get; set;}
  public string name {get; set;}
} 
```

那里很简单，如果我反映其中任何一个，我会得到正确的**GetProperties()**集，例如，如果我这样做：

```
PropertyInfo[] props = new user().GetType().GetProperties(); 
```

我将获得属性**user_id**、**name**和**category**，如果我这样做：

```
PropertyInfo[] props = new category().GetType().GetProperties(); 
```

我将获得属性**category_id**和**category**；这很好用。 *但是*，这就是我感到困惑的地方......

如您所见，**category**是**user**的最后一个属性，如果我这样做

```
//this gets me the Type 'category'
Type type = new user().GetType().GetProperties().Last().PropertyType;
//in the debugger, I get "type {Name='category', FullName='category'}"
//so I assume this is the proper type, but when I run this:
PropertyInfo[] props = type.GetType().GetProperties();
//I get a huge collection of 57 properties 
```

知道我在哪里搞砸了吗？这可以做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T09:17:10.347

通过这样做`type.GetType()`，您得到`typeof(Type)`的是 ，而不是属性类型。

做就是了

```
PropertyInfo[] props = type.GetProperties(); 
```

得到你想要的属性。

但是，您应该通过名称而不是顺序来查找属性，因为不能保证顺序与您期望的一样（请参阅[文档](http://msdn.microsoft.com/en-us/library/aky14axb.aspx)）：

> GetProperties 方法不按特定顺序返回属性，例如字母顺序或声明顺序。您的代码不得依赖于返回属性的顺序，因为该顺序会有所不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T09:17:42.793

从类型中删除 GetType()。您正在查看 Type 类型本身的属性。

# winapi - 公共桌面上的 SHGetFileInfo

> ID：856933
> 
> 赞同：0
> 
> 时间：2009-05-13T09:17:30.407
> 
> 标签：winapi, icons

我在公共桌面上使用 SHGetFileInfo 和公共桌面上的文件时遇到问题。我将专注于实际的桌面文件夹（CSIDL_COMMON_DESKTOPDIRECTORY 或通常是“C:\Users\Public\Desktop”）。另外 - 我最近才开始看到这种行为，但我无法确定导致它出现故障的确切变化。对 ShGetFileInfo 的实际调用没有改变（据我所知）。

所以我有了这个（我省略了中间错误检查以缩短 - 函数调用成功返回）：

```
SHFILEINFOW info;
uint32_t return_value = 0;
uint32_t flags = SHGFI_TYPENAME|SHGFI_ICON|SHGFI_SMALLICON|SHGFI_SYSICONINDEX;
uint32_t attributes = FILE_ATTRIBUTE_NORMAL;
wchar_t *path = L"C:\\Users\\Public\\Desktop";
return_value = SHGetFileInfoW(path, attributes, &info, sizeof(SHFILEINFOW), flags);

printf("[%ls] %u ", path, return_value); 
```

这将返回 0 作为返回值。如果我使用以下方法填充路径：

```
SHGetFolderPathW(NULL, CSIDL_COMMON_DESKTOPDIRECTORY, NULL, 0, path) 
```

我得到相同的结果。但是，如果我使用 pidl，如下所示：

```
LPITEMIDLIST pidl = NULL;
SHGetSpecialFolderLocation(NULL, CSIDL_COMMON_DESKTOPDIRECTORY,  &pidl);
return_value = SHGetFileInfoW((LPCWSTR) pidl, attributes, &info, sizeof(SHFILEINFOW), flags | SHGFI_PIDL); 
```

然后我得到了一些我期望的东西，一个系统小图标列表的句柄。

我不知道我做错了什么 - 它只发生在这个特定的文件夹上。我实际上需要目录中项目的图标，所以现在使用 pidl 似乎不是一个选项。关于从公共桌面检索图标的预期方式有什么想法吗？

--

我应该提到这种行为发生在 Windows Vista 上 - 在 XP 上使用 SHGetFolderPathW 填充的路径可以正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-08T18:43:16.047

我有同样的问题。它可以通过在程序启动时从 OLE32.DLL 中调用 CoInitialize 函数来修复。

```
CoInitialize(0);
return_value = SHGetFileInfoW(path, attributes, &info, sizeof(SHFILEINFOW), flags);
```

# gdi - StretchDIBits 似乎很慢，有更快的 API 吗？

> ID：856938
> 
> 赞同：6
> 
> 时间：2009-05-13T09:19:34.710
> 
> 标签：gdi, performance, stretchdibits

我想在同样大小的 HDC 上画一个 dib。我正在使用：des 和 src 大小相同。

```
 ::StretchDIBits(hdc,
                des.left,des.top,des.right - des.left,des.bottom - des.top,
                src.left, GetHeight() - src.bottom, src.right - src.left,src.bottom - src.top,
                m_pImg->accessPixels(),m_pImg->getInfo(), DIB_RGB_COLORS, SRCCOPY); 
```

但我发现它很慢，因为 des 大小是相同的，我只需要将 dib 复制到 dc 上。有没有比 StretchDIBits 更快的方法？

正如

```
StretchBlt (slow)  vs  Bitblt.(faster)
StretchDIBits (slow ) vs ?(faster) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T19:57:51.610

除了处理拉伸所需的通用性（即使您的目标尺寸与源尺寸相同）之外，速度差异还来自于进行任何必要的颜色转换。

如果您只绘制一次图像，那么我认为您正在寻找的功能是`SetDIBitsToDevice`.

如果您因为多次绘制相同的 DIB 而关心速度，那么您可以通过将 DIB 复制到兼容的内存 DC 一次，然后`BitBlt`每次从内存 DC 到屏幕（或打印机）来提高性能你需要它。使用`CreateCompatibleDC`创建内存DC，然后使用`StretchDIBits`或`SetDIBitsToDevice`获取图像就可以了。之后就可以`BitBlt`直接使用了。您还可以考虑使用`DIBSECTION`，它在真正的 DIB 和兼容的 DC 之间提供了性能折衷。

# sql - 如何将 nvarchar 更改为日期时间格式？

> ID：856940
> 
> 赞同：0
> 
> 时间：2009-05-13T09:19:47.813
> 
> 标签：sql, sql-server, sql-server-2005

我的代码每 10 分钟日志或每 30 分钟日志生成一些数据集，但 DateTime 格式为`'1900-01-01 14:20:00'`. 我需要`'2009-05-13 14:20:00'`，所以我想改变它。

见下表 1 和表 2。

```
declare @date1 nvarchar(100) , @date2 nvarchar(100) , @countgap int,@count int 
set @date1='2009-05-12'
set @date2 = '2009-05-13'
set @countgap = 10 --per ten minutes

CREATE TABLE #Temp (VisitingCount int, [Time] int, [Date] datetime )
DECLARE @DateNow DATETIME,@i int,@Time int, @Date datetime
set @DateNow='00:00'  
set @i=1;  
insert into #Temp(VisitingCount,[Time],[Date]) values(0,0,@DateNow )
while(@i&#60;(24*60)/@countgap)  
    begin  
        set @DateNow = DATEADD(minute, @countgap, @DateNow)
        set @Time = (datepart(hour,@DateNow)*60+datepart(minute,@DateNow))/@countgap 
        set @Date = CONVERT(VARCHAR(5),@DateNow, 108)
        insert into #Temp(VisitingCount,[Time],[Date]) values(0,@Time,@Date )
        set @i=@i+1
    end

select 
Sum(VisitingCount) as VisitingCount, [Time], 
Cast( RIGHT('00'+Cast([Time]*@countgap/60 as varchar(2)  ),2) +':'+RIGHT('00'+Cast( [Time]*@countgap%60 as varchar(2)  ),2)  as Smalldatetime)as VisitingGap
from (
  select 0 as VisitingCount, [Time] from #Temp
  Union All
    select count(page) as VisitingCount, 
    (datepart(hour,Date)*60+datepart(minute,Date))/@countgap as [Time] 
    from scr_SecuristLog
    where Date between @date1 and @date2
    GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/@countgap
  ) X
group by [Time]
order by  2 asc 
```

表格1

```
VCount Time VisitingGap
 6 86 1900-01-01 14:20:00
17 87 1900-01-01 14:30:00
 9 88 1900-01-01 14:40:00
20 89 1900-01-01 14:50:00
19 90 1900-01-01 15:00:00
 0 91 1900-01-01 15:10:00
 7 92 1900-01-01 15:20:00
 4 93 1900-01-01 15:30:00
 8 94 1900-01-01 15:40:00
 9 95 1900-01-01 15:50:00
 0 96 1900-01-01 16:00:00
20 97 1900-01-01 16:10:00
24 98 1900-01-01 16:20:00

```

表2

```
VCount Time VisitingGap
...
 6 86 2009-05-13 14:20:00
17 87 2009-05-13 14:30:00
 9 88 2009-05-13 14:40:00
20 89 2009-05-13 14:50:00
19 90 2009-05-13 15:00:00
...

```

我想我需要改变这个：

```
Cast( RIGHT('00'+Cast([Time]*@countgap/60 as varchar(2)  ),2) +':'+RIGHT('00'+Cast( [Time]*@countgap%60 as varchar(2)  ),2)  as Smalldatetime)as VisitingGap 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T09:25:28.803

为什么不将日期变量声明为日期时间？

```
 declare @date1 datetime
  declare @date2 datetime

  set dateformat ymd

  set @date1 = '2009-05-12'
  set @date1 = '2009-05-13'

  ... 
```

这样，您不必进行任何从 nvarchar 到 datetime 的转换。

或者，如果数据来自外部，使用`set dateformat`，您可以首先转换它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T09:49:22.930

您正在使用 SmallDateTime 值。最小值为 01/01/1900。

我看到您将 DateNow 设置为“00:00”，这会将其设置为日期最小值加上时间“00:00”。

您需要将其设置为当前日期或至少您的计时器首先基于的任何开始日期。

# c++ - 编译器生成的代码覆盖率

> ID：856942
> 
> 赞同：1
> 
> 时间：2009-05-13T09:20:45.910
> 
> 标签：c++, code-coverage

我正在使用 g++ 编译器在 Linux 上使用英特尔代码覆盖工具。对于特定类，覆盖工具显示的功能比源代码中实际存在的功能多 2/3。

这些额外的功能是什么？它们是编译器生成的函数吗？

我将头文件排除在代码覆盖范围之外。我的课程很简单，带有空 ctor 和 dtor。

我猜以下函数是由编译器生成的。

1.  复制构造函数
2.  赋值运算符
3.  宏（在我的情况下不是）
4.  信号槽连接机制（例如在 Qt moc 编译器中生成这些）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T15:39:42.217

这篇[博](http://vladimir_prus.blogspot.com/2007/11/breakpoints-in-constructors.html)文（关于使用 GDB 进行调试）解释了为什么您会看到“额外的”构造函数。

> gcc 为构造函数生成两个不同的函数体。一个是构造整个对象的常规对象，包括所有基础。另一个构造除了虚拟基类之外的所有东西。碰巧的是，即使对于根本没有虚基的类，gcc 也会发出这两个构造函数。

# database - 如何在 Perl 中使多个数据库查询更高效？

> ID：856945
> 
> 赞同：5
> 
> 时间：2009-05-13T09:21:42.587
> 
> 标签：database, perl

我有一个位于多个方法中的查询，每个方法（查询）都可以包含多个参数。我正在尝试减少文件大小和行数以使其更易于维护。下面是这样的一个事件：

```
$sql_update = qq { UPDATE database.table
                    SET column = 'UPDATE!'
                   WHERE id = ?
                };

$sth_update = $dbh->prepare($sql_update);

if ($dbh->err) {
    my $error = "Could not prepare statement. Error: ". $dbh->errstr ." Exiting at line " . __LINE__;
    print "$error\n";
    die;
}

$sth_rnupdate->execute($parameter);

if ($dbh->err) {
    my $error = "Could not execute statement. Error: ". $dbh->errstr ." Exiting at line " . __LINE__;
    print "$error\n";
    die;
} 
```

这只是一个示例，但是，还有其他各种选择示例仅包含要传入的一个参数，但是也有一些具有两个或多个参数的示例。我想我只是想知道是否可以将这一切封装到一个函数/方法中，传入一个参数数组，如何将参数填充到 execute() 函数中？

如果这是可能的，我可以编写一个方法，您只需传入 SQL 查询和参数并返回对获取记录的引用。这听起来安全吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T09:56:44.713

如果行数和可维护的代码是您的唯一目标，那么您最好的选择是使用可用的几个优秀的 ORM 框架/库中的任何一个。[Class::DBI](http://search.cpan.org/~tmtm/Class-DBI-v3.0.17/lib/Class/DBI.pm "类::DBI")和[DBIx::Class](http://search.cpan.org/~ribasushi/DBIx-Class-0.08102/lib/DBIx/Class.pm "DBIx::类")是两个很好的起点。以防万一，您担心花费额外的时间来学习这些模块 - 不要：我只花了一个下午就开始并富有成效。以 Class::DBI 为例，您的示例只是一行：

```
Table->retrieve(id => $parameter)->column('UPDATE!')->update; 
```

这些框架的唯一缺点（如果有的话）是非常复杂的 SQL 语句需要编写自定义方法来学习，这可能需要你一些额外的时间（不是太多）来解决。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T20:47:52.737

在每次数据库调用后检查错误是没有意义的。多么乏味！

相反，当您连接到数据库时，将 RaiseError 选项设置为 true。那么如果发生数据库错误，就会抛出异常。如果您没有捕捉到它（在 eval{} 块中），您的程序将终止并显示一条消息，类似于您在上面手动执行的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T10:14:26.570

“执行”函数*确实*接受包含所有参数的数组。

您只需要找到一种方法来指示您要执行哪个语句句柄，然后您就完成了...

将语句句柄保留在某个地方会更好，因为如果您每次都创建一个新句柄并每次都准备它，那么您并没有真正剥夺“准备”的好处......

关于返回所有行，你可以这样做（比如“当 fetchrow_hashref push”）要小心可能会吃掉你所有内存的大型结果集！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T11:54:03.773

这是一个简单的方法，使用按关键字名称存储在哈希中的闭包/匿名 subs（编译，但未经其他测试），编辑为包括使用`RaiseError`：

```
# define cached SQL in hash, to access by keyword
#
sub genCachedSQL {
  my $dbh = shift;
  my $sqls = shift;  # hashref for keyword => sql query
  my %SQL_CACHE;
  while (my($name,$sql) = each %$sqls) {
     my $sth = $dbh->prepare($sql);
     $SQL_CACHE{$name}->{sth} = $sth;

     $SQL_CACHE{$name}->{exec} = sub {  # closure for execute(s)
        my @parameters = @_;
        $SQL_CACHE{$name}->{sth}->execute(@parameters);

        return sub {  # closure for resultset iterator  - check for undef
           my $row; eval { $row = $SQL_CACHE{$name}->{sth}->fetchrow_arrayref(); };
           return $row;
        }  # end resultset closure

     }  # end exec closure

  }  # end while each %$sqls

  return \%SQL_CACHE;

}  # end genCachedSQL

my $dbh = DBI->connect('dbi:...', { RaiseError => 1 });

# initialize cached SQL statements
#
my $sqlrun = genCachedSQL($dbh,
 {'insert_table1' => qq{ INSERT INTO database.table1 (id, column) VALUES (?,?) },
  'update_table1' => qq{ UPDATE database.table1 SET column = 'UPDATE!' WHERE id = ? },
  'select_table1' => qq{ SELECT column FROM database.table1 WHERE id = ? }});

# use cached SQL
#
my $colid1 = 1;
$sqlrun->{'insert_table1'}->{exec}->($colid1,"ORIGINAL");
$sqlrun->{'update_table1'}->{exec}->($colid1);
my $result = $sqlrun->{'select_table1'}->{exec}->($colid1);
print join("\t", @$_),"\n" while(&$result());

my $colid2 = 2;
$sqlrun->{'insert_table1'}->{exec}->($colid2,"ORIGINAL");

# ... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T01:47:25.787

我对 bubaker 使用闭包的例子印象深刻。

同样，如果最初的目标是让代码库更小、更易于维护，我不禁想到在任何人开始转换到 CDBI 或 DBIC 之前，需要从原始代码中删除很多噪音等等（尽管它们都是很棒的图书馆。）

如果`$dbh`已`RaiseError`在属性中使用 set 实例化，则大部分代码都会消失：

```
$sql_update = qq { UPDATE database.table
                   SET column = 'UPDATE!'
                   WHERE id = ?
              };
$sth_update = $dbh->prepare($sql_update);
$sth_update->execute($parameter); 
```

我看不出原始代码中的错误处理增加`die`了很多您不会从.`RaiseError``HandleError``DBI`

此外，如果这些语句没有被重用（这通常是准备它们的主要目的，缓存它们的优化方式；另一个原因是通过使用占位符来减轻 SQL 注入），那么为什么不使用`do`?

```
$dbh->do($sql_update, \%attrs, @parameters); 
```

# javascript - 有没有人让 processing.js 在 IE 中工作？

> ID：856947
> 
> 赞同：7
> 
> 时间：2009-05-13T09:22:49.743
> 
> 标签：javascript, internet-explorer, canvas, processing.js

我正在寻找通过[ExplorerCanvas](http://code.google.com/p/explorercanvas/)或类似工具在 Internet Explorer 中工作的[processing.js示例。](http://processingjs.org/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-11-10T07:09:04.440

**可以办到！**然而，有一些陷阱。[就目前而言， htxt 链接到的页面](http://www.hyper-metrix.com/processing-js/docs/index.php?page=Using%20exCanvas.js%20with%20Processing.js)很好，但请注意以下几点：

1) script 和 canvas 元素都必须有 id 属性。init 函数使用这些属性 id 将给定脚本与给定画布相关联。我发现简化的 init 函数比官方的更容易理解。如果您在一页上有多个画布，您将想要掌握官方的。

2) 如果您使用互联网风格的颜色名称，例如#23ff9a，请注意！IE 8需要 Processing.js/canvas 中的*所有大写十六进制颜色数字*。写#23FF9A！这是文档显示的内容，因此不应完全令人惊讶。错误是有时会发生的事情，这让人很想弄清楚。大多数情况下，带有很多 f 的较大数字（对于较浅的颜色）似乎受到影响。白色 #ffffff 可以，但 #ff00ff 不行。Firefox 和 Safari 在这方面不区分大小写。[文档](http://processingjs.org/reference/color%20datatype)说您可以使用看起来像 0xCC006699 的 alpha 通道 (CC) 的替代十六进制表示法。这对我不起作用；也许它在待办事项清单上。

3) 缺少字符串上的 .equals() 方法！Andor Salga 是 Seneca College 的一名处理 Processing.js 的工作人员，他编写了一个简单的布尔型 stringsEqual(str1, str2) 函数，您可以[在此处查看](http://asalga.wordpress.com/2009/10/16/strlenyarn/)。这将一直持续到问题得到彻底解决。

4) stroke() 不适用于 excanvas.js 是不正确的。确实如此。但是，如果您的 Processing.js 代码甚至有一点语法错误（我无法真正分类哪些类型，但尝试使用 .equals() 会做到这一点）您的例程可能会在 IE8 中静默失败，而在 Safari 或Firefox，您的矩形可能会失去轮廓，即 stroke() 将停止工作。Vista 上的 IE 和 Mac 上的 Safari 都表现出比 Vista 上的 Safari 或 Firefox 更强大的语法检查，这将导致某些错误并呈现有缺陷的图形。

5) 使用 text() 函数调用的文本在 Firefox 中呈现（以 Firefox 选择的不可更改字体），但据我所知，不在 IE8 或 Safari 中。这里建议使用*Glyph*方法[。](http://hyper-metrix.com/processing-js/docs/?page=Cross-Browser%20Canvas%20Fonts)代码已经到位，但获取字体似乎是个问题。Inkscape 对我来说看起来非常难以理解。据我所知，所需要的很像旧的笔式绘图仪字体——在节点运行之间带有上笔和下笔命令的矢量路径。事实证明 FSF/GNU 有一些可以在没有太多麻烦的情况下被按摩成正确的格式。我不知道格式是在哪里定义的，但它可能在 W3C 的某个地方结束了。真正具有可展示字体潜力的方法是 Cufon 的 IE/VML 翼。看看[它是如何工作的？](http://wiki.github.com/sorccu/cufon/about)我真的很想要这个链条中的最后一个环节，但我可以使用一些帮助。

Processing.js 是一个值得我们支持的项目。它具有巨大的潜力。如果可以的话，我会鼓励你参与进来。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T09:38:31.653

[processing.js 展示](http://processingjs.org/exhibition)页面上的[迷你图示例](http://willarson.com/code/sparklines/sparklines.html)使用 ExplorerCanvas。看起来它只是一个插入式解决方案，不需要额外的编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T11:28:42.783

[这个页面](http://www.hyper-metrix.com/processing-js/docs/index.php?page=Using%20exCanvas.js%20with%20Processing.js)描述了如何让 processing.js + excanvas 一起工作。

它基本上涉及编写自己的 IE 可以理解的 onload init 方法。

# python - Python中的二维数组

> ID：856948
> 
> 赞同：26
> 
> 时间：2009-05-13T09:22:51.117
> 
> 标签：python, arrays, list, tuples, multidimensional-array

在 Python 中创建二维数组的最佳方法是什么？

我想要的是存储这样的值：

```
X , Y , Z 
```

这样我就可以访问类似`X[2],Y[2],Z[2]`或可变的`X[n],Y[n],Z[n]`数据。`n`一开始我不知道会有多大`n`，所以我想在最后附加值。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-13T09:29:01.763

```
>>> a = []

>>> for i in xrange(3):
...     a.append([])
...     for j in xrange(3):
...             a[i].append(i+j)
...
>>> a
[[0, 1, 2], [1, 2, 3], [2, 3, 4]]
>>> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-13T10:21:14.860

根据您的操作，您可能没有真正的二维数组。

80% 的时间你有“行状对象”的简单列表，这可能是正确的序列。

```
myArray = [ ('pi',3.14159,'r',2), ('e',2.71828,'theta',.5) ]

myArray[0][1] == 3.14159
myArray[1][1] == 2.71828 
```

更常见的是，它们是类或字典或集合的实例，或者是您以前的语言中没有的更有趣的东西。

```
myArray = [ {'pi':3.1415925,'r':2}, {'e':2.71828,'theta':.5} ] 
```

20% 的时间你有一本字典，由一对键控

```
myArray = { (2009,'aug'):(some,tuple,of,values), (2009,'sep'):(some,other,tuple) } 
```

很少，你真的需要一个矩阵。

您在 Python 中有大量的集合类。很有可能你有比矩阵更有趣的东西。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-13T09:28:51.917

在 Python 中，通常会为此目的使用[列表。](http://docs.python.org/tutorial/datastructures.html)列表可以任意嵌套，从而允许创建二维数组。并非每个子列表都需要具有相同的大小，这样才能解决您的其他问题。看看我链接到的例子。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-13T09:42:42.457

如果你想对数组做一些认真的工作，那么你应该使用[numpy 库](http://numpy.scipy.org/)。例如，这将允许您进行向量加法和矩阵乘法，并且对于大型数组，它比 Python 列表快得多。

但是，numpy 要求预定义大小。当然，您也可以将 numpy 数组存储在列表中，例如：

```
import numpy as np
vec_list = [np.zeros((3,)) for _ in range(10)]
vec_list.append(np.array([1,2,3]))
vec_sum = vec_list[0] + vec_list[1]  # possible because we use numpy
print vec_list[10][2]  # prints 3 
```

但是由于您的 numpy 数组非常小，我想与使用元组相比会有一些开销。这完全取决于您的优先事项。

另请参阅this other [question](https://stackoverflow.com/questions/261006/multidimensional-array-python)，它非常相似（除了可变大小）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-13T10:47:14.410

我建议你使用这样的字典：

```
arr = {}

arr[1] = (1, 2, 4)
arr[18] = (3, 4, 5)

print(arr[1])
>>> (1, 2, 4) 
```

如果您不确定字典中是否定义了条目，则在调用“arr[x]”时需要一个验证机制，例如try-except。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-13T12:33:18.637

如果您担心内存占用，Python 标准库包含[数组模块](http://docs.python.org/library/array.html)；这些数组包含相同类型的元素。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-12T07:13:45.427

请考虑以下代码：

```
from numpy import zeros
scores = zeros((len(chain1),len(chain2)), float) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-02-05T18:24:26.823

```
x=list()
def enter(n):
    y=list()
    for i in  range(0,n):
        y.append(int(input("Enter ")))
    return y
for i in range(0,2):
    x.insert(i,enter(2))
print (x) 
```

在这里，我创建了创建一维数组并作为数组成员插入到另一个数组中的函数。一个数组中的多个一维数组，随着 n 和 i 的值的变化你创建多维数组

# mysql - MySQL：防止竞争条件 - FOR UPDATE 或 LOCK IN SHARE MODE？

> ID：856958
> 
> 赞同：3
> 
> 时间：2009-05-13T09:23:54.920
> 
> 标签：mysql, race-condition

这是我想要的交易顺序：

1.  User1 选择字段，执行操作，用新值更新。
2.  User2 选择字段，执行操作，用新值更新。
3.  User3 选择字段，执行操作，用新值更新。

据我[了解](http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html)，第一个选择仅执行写锁定，而第二个选择执行读写锁定。

两者似乎都可用，但在第一种情况下，User2 会读取什么值？User1 更新前的初始值，还是 User1 更新后的值（这是我想要的）？

所以我很困惑，我应该使用 SELECT ... FOR UPDATE 还是 SELECT ... LOCK IN SHARE MODE？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T02:37:43.933

您可能想使用 FOR UPDATE。

使用“锁定共享模式”，第二个用户仍然可以在更新之前读取该值。

来自 MySQL 文档：

> 如果将 FOR UPDATE 与使用页锁或行锁的存储引擎一起使用，则查询检查的行将被写锁定，直到当前事务结束。使用 LOCK IN SHARE MODE 设置一个共享锁，允许其他事务读取检查的行，但不能更新或删除它们。

因此，即使 LOCK IN SHARE MODE 阻止更新，如果您的操作依赖于读取的值，您最终可能会处于不一致的状态。

# asp.net - 哪个分布式缓存？

> ID：856959
> 
> 赞同：2
> 
> 时间：2009-05-13T09:24:10.647
> 
> 标签：asp.net, caching

我需要找到一种方法让两个应用程序可以使用相同的缓存，经过一些快速研究，似乎我们需要一个分布式缓存来实现这一点。进一步谷歌搜索出现了许多解决方案，[NCache](http://www.alachisoft.com/ncache/ncache_express.html)，[SharedCache](http://www.codeplex.com/SharedCache)，[Velocity](http://msdn.microsoft.com/en-us/data/cc655792.aspx)，[memcached](http://www.codeplex.com/memcachedproviders)。此缓存将用于在使用 Asp.Net 3.5 的 Microsoft 环境中缓存网页。

所以我的问题是你对这些或其他技术有什么经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T02:54:17.053

我们使用 Memcached 已经有一段时间了，它就像一个魅力。它确实很稳定，整体性能也不错。

您可以利用 codeplex.com 上的“Memcached Providers”项目轻松地将其与 .net 集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:11:48.927

根据您需要的低技术选项的解决方案，可能是将结果/数据保存到网络共享。

然后让每台机器保存一个缓存版本（可能使用 ASP.NET 缓存或企业库）具有相应缓存依赖项的数据。

为了回答您的问题，我听说过有关 NCache 和 Memcached 的出色信息。

# batch-file - 从txt文件中获取路径

> ID：856966
> 
> 赞同：1
> 
> 时间：2009-05-13T09:26:21.580
> 
> 标签：batch-file

想象一下，我有一个 txt 文件，其路径如下：

```
c:\programs\SRC_CODE\ 
```

如何创建一个打开 txt 文件并获取字符串的 .bat 文件，以便使用从 txt 中捕获的路径设置变量？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T09:57:15.147

您至少有两种可能的选择。您可以使用`set`和输入重定向：

```
set /p myPath=<mypath.txt>nul 
```

where`set /p`将提示输入路径，并且`<mypath.txt`实际上将像直接输入文本文件的内容一样工作。

您还可以使用`for`可以遍历文本文件中的行的命令：

```
for /f "tokens=*" %%x in (mypath.txt) do set myPath=%%x 
```

这两种方法实际上对多行文件的语义略有不同。第一个变体将文件的第一行存储在变量中，`for`变体将使用最后一行。不过，对于单行文件应该没关系。哦，第一个变体可能会输出一个空行；我添加了一个重定向`nul`来取消它。

# regex - 如何使用正则表达式替换部分字符串？

> ID：856972
> 
> 赞同：1
> 
> 时间：2009-05-13T09:28:40.187
> 
> 标签：regex, perl, string, replace

嗨，
我有一个看起来像的字符串

```
/dir/dir1/filename.txt 
```

我想用其他名称替换“filename.txt”，使“/dir/dir1”保持不变，因此替换后的字符串看起来像

```
/dir/dir1/newfilename.txt 
```

考虑到我不知道“文件名”的值，我将如何在 Perl 中使用 RegExp

非常感谢

PS：“filename.txt”和“newfilename.txt”用于在询问原始文件名会有所不同时使事情变得简单。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T09:43:12.363

我建议不要使用正则表达式来摆弄文件名/路径。目录分隔符，有效/无效字符因平台而异，可能是一个问题。我建议您尝试[File::Spec](http://search.cpan.org/~smueller/PathTools-3.30/lib/File/Spec.pm "文件::规范")提取文件名，然后用您想要的任何内容替换它

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-13T19:11:41.763

正则表达式是解决您问题的错误工具。正则表达式很棒，大部分时间都可以工作，但并不总是最干净（可读性）或最快的解决方案。

我建议使用经典的[File::Basename](http://search.cpan.org/~nwclark/perl-5.8.9/lib/File/Basename.pm)。与 File::Spec 相比，File::Basename 是一个核心模块（无需安装！）并且非常易于使用：

```
 use File::Basename;

    my $basename = basename($fullname,@suffixlist);
    my $dirname  = dirname($fullname); 
```

我最喜欢的用途：

```
 my $filename = basename($path); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-13T09:32:42.893

```
$filename =~ s%/[^/]*$%/newfilename.txt%; 
```

*   `s%...%...%`-`%`用作分隔符，因此您可以`/`在模式中使用
*   `/`- 匹配斜线
*   `[^/]*`- 以及任何不包含斜杠的字符串
*   `$`- 直到字符串的结尾

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T22:23:30.857

尝试这样的事情......

```
#!/usr/bin/perl

use strict;

my $string = "/dir/dir1/filename.txt";
my @string = split /\//, $string;
$string[-1] = "newfilename.txt";
print join "/", @string; 
```

# java - AutoCAD 与 JAVA 的接口

> ID：856973
> 
> 赞同：5
> 
> 时间：2009-05-13T09:28:45.630
> 
> 标签：java, autocad, objectarx

关于通过 JAVA 程序与 AutoCAD 交互的任何想法。我正在寻找一种可以直接与 AutoCAD 会话（甚至启动一个）交互的解决方案，它与 AutoCAD 的 .NET 扩展一起工作的方式。或者通过 JAVA 使用 ObjectARX 的任何方式，绝对不会在其上编写完整的 JNI 包装器。

补充：我们正在寻找开源的东西。如果没有，我们准备在开源中创建一个，如果有人可以伸出援助之手解释如何做到这一点。我们已经了解了 JNA 和 JaWin。JNA 与 JNI 结合可能会有所帮助，但太丑陋了。另一方面，JaWin 在过去 4 年没有更新，所以对使用它持怀疑态度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T09:42:36.327

我唯一能想到的就是使用像[JNBridge](http://www.jnbridge.com/)这样的 Java <-> .Net 网桥。我在其他场景中使用过它，它工作正常。从来没有用 Java 和 AutoCad 做过任何工作，所以可能有其他更便宜的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T18:20:12.007

如果您尝试与 AutoCAD 应用程序交互，您将遇到困难。如果您想与 dwg 文件本身进行交互，可以使用 Open Design Alliance，它的库允许在没有 AutoCAD 的情况下使用 dwg 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-22T22:40:22.473

您可以尝试使用 JavaBeans ActiveX 桥和 COM 自动化来打开 AutoCAD 并对其进行操作。

也就是说，JavaBeans ActiveX 桥已经有一段时间没有发展了（我早在 2003 年就使用过它），Autodesk 正在认真投资 .Net，用于与 AutoCAD 中的扩展和自动化相关的所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-15T20:27:34.633

我们正在做一个类似的项目。我们正在做的是用 C# 编写集成代码，并用 Java 为我们的项目编写业务逻辑。

我们正在使用一个 C++ 桥接器，该桥接器利用 JNI 将 Java 调用向下传递到 C++，然后将它们转换回 C#，反之亦然。每个需要从 C# 到 Java 的函数都必须在桥代码中实现。这是相当复杂的，让非托管 C++ 代码与 C# 一起工作存在一些问题，以及将 Jstrings 转换为 C# Strings 等的标准开销。结果相对较快，在我们进行了一些优化以确保我们不会在每次调用 Java 层时启动和停止 JVM。

我们之前使用了由 AutoCAD 插件调用的 COM 对象，因此这是另一种方法。

# javascript - Javascript获取ID

> ID：856977
> 
> 赞同：1
> 
> 时间：2009-05-13T09:28:57.177
> 
> 标签：javascript, get

```
function check(id){
    var _id = document.getElementById(id);
    url = "test.php?check=1&id=" + _id;
} 
```

我想要它工作的 url 中的 id，但没有 check('123') 中的 id；

用于加载内容的 innerHTML

希望你能帮我拿到身份证

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T09:37:38.503

该`document.getElementId()`函数根据您提供的标识符字符串 (ID) 返回一个对象值；因此，如果您的页面上有一个 id 为的元素，`foo`那么您调用

```
document.getElementById("foo"); 
```

返回该元素的*对象*，以便您可以操作它（更改样式或属性等）。

如果你想将 id 插入到 test.php 页面的 URL 中，为什么不简单地传递你用函数传入的元素的标识符字符串呢？：

```
function check(id){
    url = "test.php?check=1&id=" + id;
} 
```

然后打电话

```
check("123"); 
```

将`url`变量设置为`test.php?check=1&id=123`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T09:31:37.000

```
var _id = document.getElementById(id).id; 
```

# asp.net - 需要通过 .net 代码运行 BCP 实用程序

> ID：856983
> 
> 赞同：3
> 
> 时间：2009-05-13T09:30:46.267
> 
> 标签：asp.net, sql-server

如何通过 .Net 代码运行 SQL Server 的批量复制程序 (BCP) 实用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T09:33:07.480

看一下[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)类。还有[另一篇](http://msdn.microsoft.com/en-us/library/7ek5da1a.aspx)带有示例的文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T09:35:18.880

您可以在 Command 对象中执行此 SQL 命令

```
BULK INSERT <TableName> from '<FileName>' with (FORMATFILE='<FmtFile>') 
```

用正确的项目名称替换尖括号中的项目

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T09:41:51.180

以下是一些可能的选项：

1.  从 .NET 2.0 开始，我们可以使用 SqlBulkCopy 类
2.  使用 BULK INSERT 查询
3.  使用集成服务包 (SISS)。

...和

4.  如果您仍然需要 bcp 实用程序，那么您可以将它作为一个进程运行......我会少推荐一些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-08T22:56:11.457

我很晚了，但可能对其他人有帮助。

我已经测试过这段代码。

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ExportLargeData
{
    class Program
    {
        static void Main(string[] args)
        {
            string strCmdText;
            strCmdText = "/C bcp databasname..tablename out D:\\NewFolder\\filename.csv -S .\\ -c -C RAW -T"; 
```

重要的是参数以 /C 开头，否则它将不起作用。在 -S 之后，您必须在我的情况下传递 SQL Server 实例，它是本地的，所以我通过 .\

```
 System.Diagnostics.Process process = new System.Diagnostics.Process();
            System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
            startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
            startInfo.FileName = "cmd.exe";
            startInfo.Arguments = strCmdText;
            process.StartInfo = startInfo;
            process.Start();
            process.WaitForExit();
            process.Close();
            process.Dispose();
        }
    }
} 
```

如果要执行存储过程，那么命令将是

```
string proc = "Exec database..storedprocedurename";
string strCmdText = "/C bcp "+ proc + " queryout D:\\NewFolder\\filename.csv -T -c -S .\\"; 
```

# .net - 使用带有字符串键和不区分大小写的搜索的哈希表/字典

> ID：856989
> 
> 赞同：17
> 
> 时间：2009-05-13T09:32:52.520
> 
> 标签：.net, .net-3.5, dictionary, hashtable, case-insensitive

想知道这是否可能。

我们有一个第 3 方库，其中包含有关用户的识别信息......

与库的主要交互是通过一个以字符串为键的 HashTable，并返回该键的信息对象图。

问题是，密钥显然是区分大小写的，但我们从用户浏览器获得的不一定与大小写匹配......（我们经常得到完全小写的密钥）

我想知道是否可以对哈希表进行不区分大小写的键搜索。

例如

```
Hashtable ht = new Hashtable();
ht.Add("MyKey", "Details");

string result = ht["MyKey"];
string result = ht["MYKEY"];
string result = ht["mykey"]; 
```

如果我们可以向公司提交支持票以添加此功能，是否有任何其他 DataStructures（即新的通用集合/字典）支持此功能

最后，是否可以覆盖 System.String GetHashCode() 方法，以使所有大小写不变的字符串返回相同的哈希码...例如，我认为这是一个禁止`string`使用的密封类

如果有人有任何建议，请欢呼

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-13T09:49:01.200

使哈希表比较不区分大小写的代码

对于 2.0、3.0、3.5

```
Hashtable ht = new Hashtable(StringComparer.InvariantCultureIgnoreCase); 
```

[您可以在此](https://stackoverflow.com/questions/188241/which-version-of-stringcomparer-to-use)SO 链接上获取有关 InvariantCultureIgnoreCase 与 OrdinalIgnoreCase 的信息

或者

```
Hashtable ht = System.Collections.Specialized.CollectionsUtil.CreateCaseInsensitiveHashtable(); 
```

由于不区分大小写的字典集合非常常见，因此 .NET Framework 有一个 CollectionUtil 类，该类支持创建不区分大小写的 Hashtable 和 SortedList 对象。通过调用 CreateCaseInsensitiveHashtable 或 CreateCaseInsensitiveSortedList 来使用。

对于 .Net 1.0（我不确定 1.0 是否支持 StringComparer）

```
public class InsensitiveComparer : IEqualityComparer
{
    CaseInsensitiveComparer _comparer = new CaseInsensitiveComparer();
    public int GetHashCode(object obj)
    {
        return obj.ToString().ToLowerInvariant().GetHashCode();
    }

    public new bool Equals(object x, object y)
    {
        if (_comparer.Compare(x, y) == 0)
        {
            return true;
        }

        else
       {
           return false;
       }
    }
}

Hashtable dehash = new Hashtable(new InsensitiveComparer()); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-13T09:39:22.743

用字典：

```
new Dictionary<string, string>(StringComparer.OrdinalIgnoreCase); 
```

但更简单，我相信`StringDictionary`也是不区分大小写的：

```
 StringDictionary ht = new StringDictionary();
    ht.Add("MyKey", "Details");

    string result1 = ht["MyKey"];
    string result2 = ht["MYKEY"];
    string result3 = ht["mykey"]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T09:39:32.587

`IEqualityComparer`您可以为构造函数提供不区分大小写的值`HashTable`，但这要求您可以影响`HashTable`3rd 方库中的构造。

如果您从代码中填充哈希表，您可以在插入时规范化键并再次检索规范化的键。

如果您无法影响哈希表的内容，但您知道键的结构，则可以在访问哈希表之前更正用户输入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T10:16:47.707

这不是一种非常有效的方法，但您始终可以获取哈希表并从中创建一个 StringDictionary：

```
Hashtable ht = new Hashtable();
ht.Add("FOO", "bar");

StringDictionary dict = new StringDictionary();

foreach(string key in ht.Keys)
    dict.Add(key, ht[key].ToString());

string result = dict["foo"]; // Assigns "bar" to result 
```

# .net - 为什么 .NET Framework StreamReader / Writer 默认为 UTF8 编码？

> ID：856990
> 
> 赞同：1
> 
> 时间：2009-05-13T09:32:58.370
> 
> 标签：.net, encoding, streamreader, streamwriter

我只是在查看 StreamReader / Writer 的构造函数，我注意到它默认使用 UTF8。有谁知道这是为什么？我原以为默认使用 Unicode 会更安全。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T09:36:03.373

UTF-8 将适用于任何 ASCII 文档，并且通常比 UTF-16 更紧凑——但它仍然涵盖了整个 Unicode。我想说 UTF-8*比*UTF-16 更常见。它也是 XML 的默认值（当没有 BOM 并且没有指定显式编码时）。

为什么您认为默认使用 UTF-16 会更好？（就是这样`Encoding.Unicode`。）

编辑：我怀疑你对 UTF-8 到底能处理什么感到困惑。[这个页面](http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8)描述得很清楚，包括任何特定的 Unicode 字符是如何编码的。这是一种可变宽度编码，但它涵盖了整个 Unicode。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T09:36:54.493

UTF8**是**Unicode，更具体地说是 Unicode 编码类型之一。

更重要的是它向后兼容 ASCII，而且它是 XML 和 HTML 的标准默认设置

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T09:38:10.733

“Unicode”是标准的名称，因此没有“Unicode”这样的编码。相反，有两种映射方法：[UTF](http://en.wikipedia.org/wiki/UTF)和[UCS](http://en.wikipedia.org/wiki/Universal_Character_Set)。

至于“为什么”部分，UTF-8 与 ASCII 具有最大的兼容性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T09:58:58.733

正如所有其他人已经说过的，UTF-8 是 Unicode 中的一种编码标准。UTF-8 使用可变数量的字节来编码所有的 unicode 字符。

所有 ASCII 字符都按原样表示，因此现在可以轻松读取 ASCII 文件。一旦流中的一个字节设置了它的第 8 位（最高位，> 127），就会触发阅读器将其与下一个字节组合，直到小于 128。则该组合被视为 1 个字符。

LATIN-1 (ANSII) 中有一些字符使用两个字符进行编码：例如 é 被编码为 e 和 ´。因此长度('é') 为 2。

Windows 内部使用 UTF-16，它将可编码字符限制为 64K，这绝不是所有 Unicde 字符。UTF-32 暂时允许所有字符，但也受到人为限制。并且两者都与 ASCII 不向上兼容，因为它们具有前导零：

```
A = ASCII h41 = UTF-8 h41 = UTF-16 h0041 = UTF-32 h00000041 
```

还有大小端编码：

```
A = UTF-16 big endian h0041 = UTF-16 little endian h4100 
```

想象一下使用 UTF16 或 UTF32 来保存您的文件。与 ASCII 和 UTF-8（如果仅使用 ascii 字符，则为 UTF-8）相比，它们（对于文本文件）的大小会增加一倍或四倍。UTF-8 不仅允许 unicode 标准中的所有字符，甚至未来的增强功能，而且还有效地节省了空间。

通常文件的前两个字节，BOM 或字节顺序标记，会告诉您使用哪种编码标准。如您所见，如果省略，XML 和 StreamRedaer 使用 UTF-8。这又是有意义的，因为 ASCII 文件没有 BOM，因此在大多数情况下都可以正确读取。对于使用所有 LATIN-1 的文件，这可能并非如此。

# php - python 有没有像 PHP 一样的 call_user_func() ？

> ID：856992
> 
> 赞同：1
> 
> 时间：2009-05-13T09:33:23.580
> 
> 标签：php, python

python有没有像`call_user_func()`PHP一样的功能？

PHP版本：

```
call_user_func(array($object,$methodName),$parameters) 
```

如何在 Python 中实现上述目标？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T09:42:54.390

我没有看到问题，除非`methodName`是字符串。在这种情况下，[getattr](http://docs.python.org/library/functions.html#getattr)可以完成这项工作：

```
>>> class A:
...     def func(self, a, b):
...         return a + b
... 
>>> a = A()
>>> getattr(a, 'func')(2, 3)
5 
```

如果`object`也是一个字符串，那么这将起作用，使用[全局变量](http://docs.python.org/library/functions.html#globals)或[局部](http://docs.python.org/library/functions.html#locals)变量（但你可能还有其他更大的问题）：

```
>>> getattr(locals()['a'], 'func')(2, 3)
5
>>> getattr(globals()['a'], 'func')(2, 3)
5 
```

* * *

**编辑**：重新澄清。要基于字符串初始化对象：

```
>>> class A:
...     def __init__(self): print('a')
... 
>>> class B:
...     def __init__(self): print('b')
... 
>>> clsStr = 'A'
>>> myObj = locals()[clsStr]()
a 
```

我不确定这是否真的是您想要的……除非您有许多不同的类，否则为什么不执行字符串匹配？

* * *

**另一个编辑：虽然上述方法有效，但您应该认真考虑使用**[Ignacio Vazquez-Abrams](https://stackoverflow.com/questions/856992/does-python-have-a-calluserfunc-like-php/857294#857294)提供的解决方案。一方面，通过将所有可能的类存储在 a 中`dict`，您可以避免由于传递不正确的字符串参数而导致的奇怪行为，该参数恰好与当前范围内不相关类的名称匹配。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T10:55:52.527

如果您需要使用来自遥远地方的课程（事实上，如果您需要任何课程），那么您最好为它们创建和使用字典：

```
funcs = {'Eggs': foo.Eggs, 'Spam': bar.Spam}

def call_func(func_name, *args, **kwargs):
    if not func_name in funcs:
        raise ValueError('Function %r not available' % (func_name,))
    return funcs[func_name](*args, **kwargs) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T10:12:52.143

选择要实例化的对象并不难。类是第一类对象，可以分配给变量或作为参数传递给函数。

```
class A(object):
    def __init__( self, arg1, arg2 ):
         etc.

class B(object):
    def __init__( self, arg1, arg2 ):
         etc.

thing_to_make = A
argList= ( some, pair )
thing_to_make( *argList )

thing_to_make = B
argList- ( another, pair )
thing_to_make( *argList )

def doSomething( class_, arg1, arg2 ):
    thing= class_( arg1, arg2 )
    thing.method()
    print thing 
```

一切都很好，没有太多痛苦。你不需要 Python 中的“call_user_function”之类的东西

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T09:49:43.583

对于给定的对象“obj”、给定的方法名称“meth”和给定的一组参数“args”：

```
 obj.__getattribute__(meth)(*args) 
```

应该送你到那里。

当然，这是不言而喻的——你到底想做什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T10:00:35.843

您可以调用 use getattr with locals() 或 globals() 来做类似的事情

```
# foo.method() is called if it's available in global scope
getattr(globals()['foo'], 'method')(*args)

# Same thing, but for 'foo' in local scope
getattr(locals()['foo'], 'method')(*args) 
```

另请参阅：在[getattr()](http://www.diveintopython.org/power_of_introspection/getattr.html)、[locals() 和 globals()上](http://www.diveintopython.org/html_processing/locals_and_globals.html)**深入 Python**

# c# - 通过 Web 服务正确捕获特定异常

> ID：856993
> 
> 赞同：1
> 
> 时间：2009-05-13T09:33:26.700
> 
> 标签：c#, web-services, exception-handling

我目前在我们的客户端程序中使用 C# .NET 服务。作为服务器设计的一部分，会抛出几个自定义异常以指示特定错误（就像在任何普通桌面程序中一样）。

问题是 Web 服务捕获这些错误并将它们序列化为 FaultException，而实际异常（如 NoRoomsAvailableException）写入 Message 字段。

我的问题是是否有处理这些错误的最佳实践。我们刚刚开始研究这个，我们可能会做一些文本模式匹配来提取异常类型和错误消息，但这似乎是一种 hacky 方式，所以任何“干净”的方式都可以赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T09:51:03.583

正确的方法是定义故障合同。例如，在您的 Web 服务中，您可以执行以下操作：

```
[DataContract]
public class NoRoomsAvailableFaultContract
{
    [DataMember]
    public string Message { get; set; }
} 
```

接下来，您为给定的服务操作声明此合同

```
[ServiceContract]
public interface IMyServiceContract
{
    [OperationContract]
    [FaultContract(typeof(NoRoomsAvailableFaultContract))]
    void MyOperation();
} 
```

你像这样实现它：

```
public class MyService : IMyServiceContract 
{
    public void MyOperation()
    {
        if (somethingWentWrong)
        {
            var faultContract = new NoRoomsAvailableFaultContract()
            {
                Message = "ERROR MESSAGE"
            };
            throw new FaultException<NoRoomsAvailableFaultContract>(faultContract);
        }
    }
} 
```

在这种情况下，NoRoomsAvailableFaultContract 将在 WSDL 中公开，并且 svcutil.exe 可以生成代理类。然后你可以捕捉到这个异常：

```
try
{
    myServiceProxy.MyOperation();
}
catch (FaultException<NoRoomsAvailableFaultContract> ex)
{
    Console.WriteLine(ex.Message);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T09:58:03.133

达林有正确的答案。我只会明确地说出他的暗示：Web 服务不会传递异常。它们返回 SOAP 错误。如果你像他一样正确地定义你的错误，那么你就会抛出 FaultException< *fault* >。这将成为详细元素中出现*错误的 SOAP 错误。*在 .NET 客户端的情况下，这将变成一个 FaultException< *fault* >，您可以捕获它。

其他平台可能会有所不同。我已经看到 IBM 的 Rational Web Developer 生成 Java 代理代码，它为每个声明的错误创建一个单独的异常。那是 Java 泛型之前的一个版本，所以现在它的功能可能与 .NET 相同。

# sql-server - 以 sqlserver 作为后端的颠覆

> ID：856996
> 
> 赞同：-1
> 
> 时间：2009-05-13T09:33:58.307
> 
> 标签：sql-server, svn, fsfs

> **可能重复：**
> [将 MSSQL 后端用于 Subversioning 存储库](https://stackoverflow.com/questions/398802/using-mssql-backend-for-subversioning-repositories)

我们可以在 subversion 中使用 sqlserver 作为后端（instaed of fsfs）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T09:40:04.350

抱歉，Subversion 仅提供两种类型的存储库存储——FSFS（快速安全文件系统）和 Berkeley DB。FSFS 在具有大量文件的目录上工作得更快，并且由于日志记录较少而占用更少的磁盘空间。 [3] Subversion 对 Berkeley DB 的使用有一些限制，当访问数据库的程序崩溃或被强制终止时，会导致存储库损坏和数据丢失。

[资源](http://en.wikipedia.org/wiki/Subversion_(software))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T09:44:18.837

这不可能。*********