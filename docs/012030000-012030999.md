# StackOverflow 问答 12030000-12030999

# r - R验证源代码

> ID：12030005
> 
> 赞同：10
> 
> 时间：2012-08-19T21:04:53.500
> 
> 标签：r, verification

有没有办法在采购时在 R 中“检查”或“验证”源代码文件？例如，我在文件“source.R”中有这个函数

```
MyFunction <- function(x)
{
print(x+y)
} 
```

在采购“source.R”时，我希望看到某种警告：`MyFunctions refers to an undefined object Y.`

关于如何检查/验证 R 代码的任何提示？

干杯!

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-19T23:33:22.563

我使用这样的函数来扫描文件中的所有函数：

```
critic <- function(file) {

   require(codetools)
   tmp.env <- new.env()
   sys.source(file, envir = tmp.env)
   checkUsageEnv(tmp.env, all = TRUE)

} 
```

假设`source.R`包含两个写得很糟糕的函数的定义：

```
MyFunction <- function(x) {
   print(x+y)
}

MyFunction2 <- function(x, z) {
   a <- 10
   x <- x + 1
   print(x)
} 
```

这是输出：

```
critic("source.R")
# MyFunction: no visible binding for global variable ‘y’
# MyFunction2: local variable ‘a’ assigned but may not be used
# MyFunction2: parameter ‘x’ changed by assignment
# MyFunction2: parameter ‘z’ may not be used 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-19T21:08:43.077

为此，您可以使用 base R 中的 codetools 包。如果您将代码放在一个包中，它会告诉您：

# jquery - CSS 过渡

> ID：12030007
> 
> 赞同：1
> 
> 时间：2012-08-19T21:05:02.060
> 
> 标签：jquery, css, html, css-transitions

我在下面创建了 jQuery 脚本，但是在将其转换为最好仅使用转换的 CSS 时遇到了一些问题。如果有人可以帮助我，我会很高兴的。

**下面的示例说明：**
- 当您单击文本框时，一个空的 div 容器会下拉，但我在编写脚本时遇到了一些问题，主要是 CSS3 过渡。

**HTML：**

```
<div class="div">
    <input type="text" class="textbox" id="textbox"/>
    <p>example</p>
</div> 
```

**CSS：**

```
.textbox {width:300px;}
.div { width:300px; background-color:#f8f8f8; }
p {width:300px; height:300px; background-color: #f8f8f8;} 
```

**jQuery：**

```
$("#textbox").click(function() {
    $("p").slideToggle();
}); 
```

**现场演示：[jsFiddle](http://jsfiddle.net/58VHE/28/)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:11:05.977

```
p {
    height: 0;
    overflow: hidden;
    transition: height .3s;
}
input:focus + p {
    height: 20px;
} 
```

这是你的小提琴：http: [//jsfiddle.net/58VHE/33/](http://jsfiddle.net/58VHE/33/)（点击关注`input`）。

* * *

**PS**不要忘记供应商前缀。小提琴用于[`-prefix-free`](https://raw.github.com/LeaVerou/prefixfree/gh-pages/prefixfree.min.js)自动添加供应商前缀。

# javascript - Chrome 扩展消息传递错误

> ID：12030011
> 
> 赞同：1
> 
> 时间：2012-08-19T21:05:25.787
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在尝试将消息从后台页面传递到内容脚本，但我收到此错误（来自控制台）：

**端口错误：无法建立连接。接收端不存在。**

这是我的代码：***//内容脚本：***

```
var port = chrome.extension.connect({name:"connection"});
chrome.extension.onConnect.addListener(function(port) {
port.onMessage.addListener(function(msg) {
alert('I never get to see this message...');
 });
}); 
```

在 background.js 中，我首先创建一个包含内容脚本的选项卡，然后在创建选项卡后，我尝试连接到它的内容脚本

***//背景.js***

```
chrome.tabs.create({url:"http://myextension.uphero.com/"},function(tab){
var port = chrome.tabs.connect(tab.id,{name:"connection"});
console.log('port is :' +port.name);
console.log(port.onMessage);
port.postMessage({msg:"whatever"});
  }); 
```

现在我知道问题不在于 manifest.json 或类似的东西（内容脚本定义正常，只是端口和连接有问题）。非常感谢任何帮助...

# java - Java 仪器

> ID：12030013
> 
> 赞同：0
> 
> 时间：2012-08-19T21:05:46.960
> 
> 标签：java, instrumentation

我有一个 javaagent，它打印出所有加载的类的名称，以及它们的来源（它们来自哪里）。

```
public byte[] transform(ClassLoader loader, String className, Class redefiningClass, ProtectionDomain domain, byte[] bytes) throws IllegalClassFormatException {
        System.out.print("Loading class: " + className + "\t");
        if (domain != null) {
          final CodeSource cs = domain.getCodeSource();
          if (cs != null) {
            System.out.println(cs.getLocation());
          }
        }
        System.out.println();
        return bytes;
    } 
```

对于某些类，它会打印出“null”（意味着 cs.getLocation() 为 null）。为什么会这样，还有什么可以查看这些课程的来源吗？请注意，我不是在我自己的 Java 应用程序上执行此操作，因此我不知道它使用的任何自定义类加载器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:06:32.597

根据[Jetty 7.0.0RC4](http://archive.eclipse.org/jetty/7.0.0.RC4/xref/org/eclipse/jetty/policy/JettyPolicy.html#114)，它似乎`null` `CodeSource`反映了该类具有*全局*权限。

> ```
> // 1) if protection domain codesource is null, it is the global permissions (grant {}) 
> ```

此行为记录在 的规范中[`ClassLoader.defineClass`](http://goo.gl/yVP5a)，因此它不是任意的；-)

> `ProtectionDomain`此方法为新定义的类分配默认值。被`ProtectionDomain`有效地授予了`Policy.getPolicy().getPermissions(new CodeSource(null, null))`调用时返回的相同权限集。默认域在第一次调用时创建`defineClass`，并在后续调用中重新使用。

* * *

实际上，仔细观察，我相信这是[`SecureClassLoader.defineClass`](http://goo.gl/MYFh1)...

> 如果`null` `CodeSource`提供了一个非 - ，`ProtectionDomain`则构造一个并与正在定义的类相关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T21:15:48.903

看起来 getLocation() 返回一个表示正在加载的代码源的 URL。但这并不总是有意义的。你对机器本地的标准库和代码做了什么？第一个也可能是第二个必须返回 null。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T04:11:07.380

不知道你究竟想在这里得到什么，但不会 jvm 参数：

```
-verbose:class 
```

已经在做你正在做的事情了吗？

> ```
> [Loaded sun.nio.cs.SingleByte$Encoder from C:\Program Files\Java\jre7\lib\rt.jar]
> [Loaded java.nio.charset.CodingErrorAction from C:\Program Files\Java\jre7\lib\rt.jar]
> [Loaded java.nio.ByteBuffer from C:\Program Files\Java\jre7\lib\rt.jar]
> [Loaded java.nio.HeapByteBuffer from C:\Program Files\Java\jre7\lib\rt.jar]
> [Loaded java.nio.Bits from C:\Program Files\Java\jre7\lib\rt.jar]
> [Loaded java.nio.ByteOrder from C:\Program Files\Java\jre7\lib\rt.jar] 
> ```

如果这就是您正在做的所有事情，则无需为其创建代理，尽管我不清楚除此之外您还可能尝试做什么。

# php - 使用递归组织多维数组

> ID：12030016
> 
> 赞同：0
> 
> 时间：2012-08-19T21:06:29.953
> 
> 标签：php, recursion, multidimensional-array

我有一个动态构建的数组。由于它的构建方式，它有许多嵌套数组，但是深度对我来说没用，所以我在之后组织它。它可能看起来像这样：

```
Array
(
    [0] => Array
        (
            [0] => Array
                (
                    [0] => Array
                        (
                            [0] => Array
                                (
                                    [index] => -1
                                    [cost] => 0.189956571618
                                )
                        )         
                )
        )

    [1] => Array
        (
            [index] => -1
            [cost] => 2.18650011647
        )
) 
```

我想几乎展平这个数组（即在所有条目上使用 $array[$i]['cost'] 访问它的数据，无论它们在我处理它们之前是否嵌套很深）。到目前为止，我一直在使用 SPL 递归，其中包含以下内容：

```
function flatten($array) {
    $return = array();
    $it = new RecursiveIteratorIterator(new ParentIterator(new RecursiveArrayIterator($array)), RecursiveIteratorIterator::SELF_FIRST);
    foreach($it as $value) {
        if(isset($value['cost'])) {
            $return[] = $value;
        }
    }
    return $return;
} 
```

它在大多数情况下都有效，但是原始数组中的某些值（其中确实有一个“成本”索引）无法添加到新数组中，因为它们本身是作为嵌套数组传递的，如下所示：

```
Array
(
    [0] => Array
        (
            [index] => -1
            [cost] => 0.189956571618
        )

    [1] => Array
        (
            [index] => -1
            [cost] => 2.18650011647
        )
) 
```

...而不仅仅是（大多数时候我得到）：

```
Array
        (
            [index] => -1
            [cost] => 0.189956571618
        ) 
```

我认为使用 RecursiveIterator 的全部意义在于深入数组并获取其中没有数组的条目（即我想要的“值”）。我是否为这项工作使用了错误的工具？如果是这样，循环遍历我不知道深度的数组会更合适吗？如果 SPL 是要走的路，我做错了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:17:52.440

你可以使用 array_walk_recursive

**编辑**

```
function flatten($array) {
    $return = array();
    array_walk_recursive($array, function($value, $key) use (&$return) {
        if(isset($value['cost']) $return[] = $value;
    });
    return $return;
} 
```

在 SPL 部分**编辑**聊天室中的长时间讨论，检查 OP 的答案

# iphone - AFNetworking 停止下载具有相同 url 的图像

> ID：12030019
> 
> 赞同：0
> 
> 时间：2012-08-19T21:07:14.513
> 
> 标签：iphone, ios, afnetworking

在我的应用程序中，我下载图像并将它们插入到表格视图中。在我的情况下，可能有几个相同的图像具有相同的 URL。为了减少服务器过载，我只想下载每个图像一次。有对此的内置支持吗？或者实现我的目标的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:52:23.197

创建一个`NSMutableDictionary`并在下载图像并将其放置在表格视图中时，将 URL 添加为字典中的键，并将表格视图行添加为值。在下载图像之前，请检查以确保字典中不包含 URL ( `if ([[dictionary allKeys] containsObject:url])`。如果没有，请下载图像。如果包含，则获取行号并使空行的图像与字典中行的图像。

```
http://example.com/image => 1 
```

# c++ - 使用按位运算符消除分支

> ID：12030022
> 
> 赞同：8
> 
> 时间：2012-08-19T21:07:32.267
> 
> 标签：c++, optimization, bit-manipulation

我在一个运行了大约 2^26 次的循环中有一些关键的分支代码。分支预测不是最优的，因为`m`它是随机的。我将如何删除分支，可能使用按位运算符？

```
bool m;
unsigned int a;
const unsigned int k = ...; // k >= 7
if(a == 0)
    a = (m ? (a+1) : (k));
else if(a == k)
    a = (m ?     0 : (a-1));
else
    a = (m ? (a+1) : (a-1)); 
```

这是由以下生成的相关程序集`gcc -O3`：

```
.cfi_startproc
movl    4(%esp), %edx
movb    8(%esp), %cl
movl    (%edx), %eax
testl   %eax, %eax
jne L15
cmpb    $1, %cl
sbbl    %eax, %eax
andl    $638, %eax
incl    %eax
movl    %eax, (%edx)
ret
L15:
cmpl    $639, %eax
je  L23
testb   %cl, %cl
jne L24
decl    %eax
movl    %eax, (%edx)
ret
L23:
cmpb    $1, %cl
sbbl    %eax, %eax
andl    $638, %eax
movl    %eax, (%edx)
ret
L24:
incl    %eax
movl    %eax, (%edx)
ret
.cfi_endproc 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-19T21:32:33.143

我发现最快的是现在的表实现

我得到的时间（更新了新的测量代码）

HVD 的最新：9.2s

表版本：7.4s（k=693）

建表代码：

```
 unsigned int table[2*k];
    table_ptr = table;
    for(int i = 0; i < k; i++){
      unsigned int a = i;
      f(0, a);
      table[i<<1] = a;

      a = i;
      f(1, a);
      table[i<<1 + 1] = a;
    } 
```

表运行时循环：

```
void f(bool m, unsigned int &a){
  a = table_ptr[a<<1 | m];
} 
```

使用 HVD 的测量代码，我看到 rand() 支配运行时的成本，因此无分支版本的运行时与这些解决方案的范围大致相同。我将测量代码更改为此（更新以保持随机分支顺序，并预先计算随机值以防止 rand() 等破坏缓存）

```
int main(){
  unsigned int a = k / 2;
  int m[100000];
  for(int i = 0; i < 100000; i++){
    m[i] = rand() & 1;
  }

  for (int i = 0; i != 10000; i++
  {
    for(int j = 0; j != 100000; j++){
      f(m[j], a);  
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-19T21:45:48.563

无分支无除法模*可能*有用，但测试表明在实践中并非如此。

```
const unsigned int k = 639;
void f(bool m, unsigned int &a)
{
    a += m * 2 - 1;
    if (a == -1u)
        a = k;
    else if (a == k + 1)
        a = 0;
} 
```

测试用例：

```
unsigned a = 0;
f(false, a);
assert(a == 639);
f(false, a);
assert(a == 638);
f(true, a);
assert(a == 639);
f(true, a);
assert(a == 0);
f(true, a);
assert(a == 1);
f(false, a);
assert(a == 0); 
```

实际上，使用测试程序计时：

```
int main()
{
    for (int i = 0; i != 10000; i++)
    {
        unsigned int a = k / 2;
        while (a != 0) f(rand() & 1, a);
    }
} 
```

（注意：没有`srand`，所以结果是确定性的。）

我原来的答案：5.3s

问题中的代码：4.8s

查表：4.5s ( `static unsigned lookup[2][k+1];`)

查表：4.3s ( `static unsigned lookup[k+1][2];`)

埃里克的回答：4.2s

本版本：4.0s

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T21:11:37.843

我不认为你可以完全删除分支，但你可以通过首先在 m 上分支来减少数量。

```
if (m){
    if (a==k) {a = 0;} else {++a;}
}
else {
    if (a==0) {a = k;} else {--a;}
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-19T21:19:00.123

添加到锑的重写：

```
if (a==k) {a = 0;} else {++a;} 
```

看起来像环绕增加。你可以这样写

```
a=(a+1)%k; 
```

当然，只有当划分实际上比分支快时才有意义。

不确定另一个；懒得去想 (~0)%k 会是什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-19T22:15:34.863

这没有分支。因为 K 是常数，编译器可能能够根据它的值优化模数。如果 K 是“小”，那么完整的查找表解决方案可能会更快。

```
bool m;
unsigned int a;
const unsigned int k = ...; // k >= 7
const int inc[2] = {1, k};

a = a + inc[m] % (k+1); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-19T22:19:39.433

如果 k 不足以导致溢出，您可以执行以下操作：

```
int a; // Note: not unsigned int
int plusMinus = 2 * m - 1;
a += plusMinus;
if(a == -1) 
    a = k; 
else if (a == k+1) 
    a = 0; 
```

仍然是分支，但分支预测应该更好，因为边缘条件比 m 相关条件更罕见。

# bundler - 通过 Node 运行 lessc - 而不是 Bundler

> ID：12030024
> 
> 赞同：1
> 
> 时间：2012-08-19T21:07:45.653
> 
> 标签：bundler, less, npm

有一点问题 - 如果我只知道询问 Google 的正确方法，我肯定会相当直截了当。

我最近掌握了 LESS 的窍门，最初是通过 NPM 全局安装它，即`npm install lessc -g`与[初始化](http://www.initializr.com/)项目一起使用 -`lessc less/style.less style.css`在我将其部署到本地计算机之前像冠军一样运行。

喜欢它 - 工作得很好 - 决定将 LESS 与单独的 Rails 项目一起使用 - 将其添加`gem 'less-rails'`到项目中 -`bundle install`让它滚动并顺利运行。

不幸的是，现在我回到了我的初始化项目——`lessc less/style.less style.css`抛出了一条引用 RVM 和 Bulder 的错误消息。

最终，我通过在本地安装 LESSC`npm install lessc -g`并运行找到了解决方法，`node_modules/less/bin/lessc less/style.less style.css`但这很痛苦。

**那么：**我如何让 LESSC 重新专门使用 Node 并忽略所有 RVM / Ruby / Bundler 废话？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:42:07.273

`.bash_profile`好的 - 我可以通过在我的用户目录中的文件中添加一个指向 LESS 的全局节点安装的变量来做到这一点。

基本上加

`export lessc=~/.npm/less/1.3.0/package/bin/lessc`

到`.bash_profile`或`.profile`或`.bashrc`在您的用户目录中。并运行`source ~/.bash_profile`。

# mysql - Mysql - “选择喜欢”不使用索引

> ID：12030028
> 
> 赞同：9
> 
> 时间：2012-08-19T21:08:31.050
> 
> 标签：mysql, indexing, explain

我一直在使用 MySQL（5.5.24，WinXP）上的索引，但我找不到在使用 a 时服务器不使用一个索引的原因`LIKE`。

这个例子是这样的：

我创建了一个测试表：

```
create table testTable (
  id varchar(50) primary key,
  text1 varchar(50) not null,
  startDate varchar(50) not null
) ENGINE = innodb; 
```

然后，我添加了一个索引到`startDate`. （请不要问为什么该列是文本而不是日期时间。这只是一个简单的测试）：

```
create index jeje on testTable(startdate);
analyze table testTable; 
```

之后，我添加了近 200,000 行，其中**startDate**有 3 个可能的值。（每一个出现三分之一......接近70,000次）

所以，如果我运行这样的**EXPLAIN**命令：

```
explain select * from testTable use index (jeje) where startDate = 'aaaaaaaaa'; 
```

答案如下：

```
id = 1
select_type = SIMPLE
type = ref
possible_keys = jeje
key = jeje
rows = 88412
extra = Using where 
```

因此，使用了密钥，并且行数接近 200,000/3，所以一切正常。

问题是，如果我将查询更改为：（只需将 '=' 更改为 'LIKE'）：

```
explain select * from testTable use index(jeje) where startDate LIKE 'aaaaaaaaa'; 
```

在这种情况下，答案是：

```
id = 1
select_type = SIMPLE
type = ALL
possible_keys = jeje
key = null
rows = 176824
extra = Using where 
```

因此，现在没有使用索引（键为空，并且行接近完整表......正如 type=all 所暗示的那样）。

MySQL 文档说 LIKE 确实使用了索引。

那么，我在这里没有看到什么？哪里有问题？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T06:30:04.883

如果索引导致访问超过 30% 的表行，MySql 可以忽略索引。您可以尝试 FORCE INDEX [index_name]，它无论如何都会使用索引。

sysvar_max_seeks_for_key 的值也会影响索引是否被使用：

*   [http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_max_seeks_for_key](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_max_seeks_for_key)

    尝试将此值更改为较小的数字。

在 SO 上搜索类似的请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T14:20:24.237

根据[Ubik 评论](https://stackoverflow.com/a/12033130/3056278)和数据更改，我发现：在这些情况下使用了**索引：**

```
- explain select * from testTable force index jeje where startDate like 'aaaaaaadsfadsfadsfasafsafsasfsadsfa%';
- explain select * from testTable force index jeje where startDate like 'aaaaaaadsfadsfadsfasafsafsasfsadsfa%';
- explain select * from testTable force index jeje where startDate like 'aaa'; 
```

**但是**当我使用这个查询时，索引**没有被使用：**

```
- explain select * from testTable force index jeje where startDate like 'aaaaaaaaa'; 
```

基于在**startDate**列中所有值都具有相同长度（9 个字符）的事实，当我使用 LIKE 命令和 9 个字符常量进行查询时， 可能由于某些性能算法， **MySQL**更喜欢不使用该原因，并且走到桌边。

我担心的是看看我在最初的测试中是否犯了某种错误，但现在我认为索引和测试是正确的，并且 MySQL 在某些情况下决定不使用索引......我会继续这。

对我来说，这是一个封闭的任务。如果有人想在线程中添加一些内容，欢迎您。

# c# - 将所有低位设置为 0，直到剩下两个 1（对于存储为字节数组的数字）

> ID：12030031
> 
> 赞同：3
> 
> 时间：2012-08-19T21:09:11.157
> 
> 标签：c#, .net, binary, bit-manipulation, biginteger

我需要将给定 BigInteger 的所有低位设置为 0，直到只剩下两个 1 位。换句话说，保留最高位和次高位设置，同时取消设置所有其他位。

该数字可以是位的任意组合。它甚至可能全为 1 或全为 0。例子：

```
MSB    0000 0000
       1101 1010
       0010 0111
       ...
       ...
       ...
LSB    0100 1010 
```

我们可以轻松解决诸如 0、1、PowerOf2 等极端情况。不知道如何在表示一个数字的字节数组上应用流行的位操作算法。

我已经看过[bithacks](http://www-graphics.stanford.edu/~seander/bithacks.html#CountBitsSetParallel)但有以下限制。BigInteger 结构仅通过 ToByteArray 方法公开底层数据，这本身是昂贵且不必要的。由于没有办法解决这个问题，我不想通过实现针对 32/64 位整数（大多数都是）优化的位计数算法来进一步减慢速度。

简而言之，我有一个字节 [] 代表一个任意大的数字。速度是这里的关键因素。

**注意：**如果有帮助，我正在处理的数字大约有 5,000,000 位。它们随着算法的每次迭代而不断减少，因此我可能会随着数量的减少而切换技术。

**为什么我需要这样做：**我正在使用 2D 图形，并且对 x 和 y 值是 2 的幂的坐标特别感兴趣。因此 (x+y) 将始终设置两个位，并且 (xy) 将始终具有连续的位设置。给定一个任意坐标 (x, y)，我需要通过获取除前两个 MSB 之外的所有位未设置的值来转换交集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T21:25:27.670

尝试以下操作（不确定它是否实际上是有效的 C#，但它应该足够接近）：

```
// find the next non-zero byte (I'm assuming little endian) or return -1
int find_next_byte(byte[] data, int i) {
    while (data[i] == 0) --i;
    return i;
}

// find a bit mask of the next non-zero bit or return 0
int find_next_bit(int value, int b) {
    while (b > 0 && ((value & b) == 0)) b >>= 1;
    return b;
}

byte[] data;

int i = find_next_byte(data, data.Length - 1);
// find the first 1 bit
int b = find_next_bit(data[i], 1 << 7);
// try to find the second 1 bit
b = find_next_bit(data[i], b >> 1);
if (b > 0) {
    // found 2 bits, removing the rest
    if (b > 1) data[i] &= ~(b - 1);
} else {
    // we only found 1 bit, find the next non-zero byte
    i = find_next_byte(data, i - 1);
    b = find_next_bit(data[i], 1 << 7);
    if (b > 1) data[i] &= ~(b - 1);
}

// remove the rest (a memcpy would be even better here,
// but that would probably require unmanaged code)
for (--i; i >= 0; --i) data[i] = 0; 
```

未经测试。

如果编译为非托管代码，甚至使用 C 或 C++ 编译器，这可能会更高效。

正如哈罗德正确指出的那样，如果您对自己的号码没有先验知识，那么这种`O(n)`方法是您能做的最好的。如果可以，您应该保留最高两个非零字节的位置，这将大大减少执行转换所需的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:16:29.460

我不确定这是否得到优化，但这段代码似乎比 ToByteArray 快 16 倍。它还避免了内存复制，这意味着您以 uint 而不是 byte 形式获得结果，因此您应该在那里进行进一步的改进。

```
//create delegate to get private _bit field
var par = Expression.Parameter(typeof(BigInteger));
var bits = Expression.Field(par, "_bits");
var lambda = Expression.Lambda(bits, par);
var func = (Func<BigInteger, uint[]>)lambda.Compile();

//test call our delegate
var bigint = BigInteger.Parse("3498574578238348969856895698745697868975687978");
int time = Environment.TickCount;
for (int y = 0; y < 10000000; y++)
{
    var x = func(bigint);
}
Console.WriteLine(Environment.TickCount - time);

//compare time to ToByteArray
time = Environment.TickCount;
for (int y = 0; y < 10000000; y++)
{
    var x = bigint.ToByteArray();
}
Console.WriteLine(Environment.TickCount - time); 
```

从那里找到前 2 位应该很容易。第一位将在我假设的第一个 int 中，然后只需搜索第二个最高位即可。如果它在同一个整数中，则只需将第一位设置为零并找到最高位，否则搜索下一个非零 int 并找到最高位。

编辑：为了简单起见，只需将此类复制/粘贴到您的项目中即可。这会创建扩展方法，这意味着您只需调用 mybigint.GetUnderlyingBitsArray()。我还添加了一个获取 Sign 的方法，并且为了使其更通用，创建了一个函数，该函数将允许访问任何对象的任何私有字段。我发现这比调试模式下的原始代码慢，但在发布模式下速度相同。我建议您自己进行性能测试。

```
static class BigIntegerEx
{
    private static Func<BigInteger, uint[]> getUnderlyingBitsArray;
    private static Func<BigInteger, int> getUnderlyingSign;

    static BigIntegerEx()
    {
        getUnderlyingBitsArray = CompileFuncToGetPrivateField<BigInteger, uint[]>("_bits");
        getUnderlyingSign = CompileFuncToGetPrivateField<BigInteger, int>("_sign");
    }

    private static Func<TObject, TField> CompileFuncToGetPrivateField<TObject, TField>(string fieldName)
    {
        var par = Expression.Parameter(typeof(TObject));
        var field = Expression.Field(par, fieldName);
        var lambda = Expression.Lambda(field, par);
        return (Func<TObject, TField>)lambda.Compile();
    }

    public static uint[] GetUnderlyingBitsArray(this BigInteger source)
    {
        return getUnderlyingBitsArray(source);
    }

    public static int GetUnderlyingSign(this BigInteger source)
    {
        return getUnderlyingSign(source);
    }
} 
```

# javascript - 如何将静态数组分配给 Dojo 中的对象？

> ID：12030034
> 
> 赞同：0
> 
> 时间：2012-08-19T21:10:04.103
> 
> 标签：javascript, actionscript, dojo

```
define(["dojo/_base/declare"], function (declare) {
    // module:
    //      StyleNames
    // summary:
    //      Style element names.
    var StyleNames = declare(null, 
        {
            PROP1: "Style1",
            PROP2: "Style2"
        }
    );

    StyleNames.dataContexts = [
        StyleNames.PROP1,
        StyleNames.PROP2,
    ];

    return StyleNames;
});

var styleNames = new StyleNames();
console.log("PROP1 is defined as: ", styleNames.PROP1); // prints "Style1"
console.log("dataContexts is undefined: ", styleNames.dataContexts); // Error: styleNames.dataContexts is undefined 
```

我的设置类似于[https://stackoverflow.com/a/11329956/1610451](https://stackoverflow.com/a/11329956/1610451)但查看 DOM，我可以看到它设置为`styleNames.constructor.dataContexts`具有未定义值的构造函数。

背景故事：我正在将 ActionScript 代码移植到 JavaScript，并且需要维护现有接口。我要移植的 ActionScript 代码示例是：

```
public class StyleNames {
    public static const PROP1 : String = "Style1";
    public static const PROP2 : String = "Style2";

    public static const dataContexts : Array = [
        PROP1,
        PROP2
    ];

    public function StyleNames(){}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T21:35:22.870

你在你的声明中说得对。在我看来，这是定义静态变量的最明确的方式。在您的`console.log`代码中，您只是没有`dataContexts`正确引用变量。它是一个*静态*变量，所以它不属于任何一个实例。你想这样引用它：`StyleNames.dataContexts`.

编辑：您那里也可能存在语法错误。取出`StyleNames.dataContexts`声明下的第二个逗号：

```
StyleNames.dataContexts = [
    StyleNames.PROP1,
    StyleNames.PROP2
]; 
```

像这样访问变量：

```
StyleNames.dataContexts 
```

相对于`this.dataContexts`或`instanceRef.dataContexts`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T09:06:44.737

这是按照我的思维方式正确完成的：

```
require(["dojo/_base/declare"], function(declare) {

    var StyleNames = declare(null, {

        constructor: function() {
            // a.k.a public function StyleNames(){}
        },

        // non-static properties and functions here

    });

    // static properties and functions
    StyleNames.PROP1 = "Style1";
    StyleNames.PROP2 = "Style2";

    StyleNames.dataContexts = [
        StyleNames.PROP1,
        StyleNames.PROP2
    ];

    console.log("PROP1: ", StyleNames.PROP1);
    console.log("dataContexts: ", StyleNames.dataContexts);

});​ 
```

在 jsFiddle 上查看一个工作示例：http: [//jsfiddle.net/phusick/6nfhJ/](http://jsfiddle.net/phusick/6nfhJ/)

# php - TCPDF 模板 - 无法重新声明函数

> ID：12030036
> 
> 赞同：0
> 
> 时间：2012-08-19T21:10:30.217
> 
> 标签：php, tcpdf

并有一个模板用于创建我想要的页面。
我有功能 TextBox($ ---- 和模板设置)

当我在创建页面后运行它时，当我将它放在 cron 中时，它只运行一次，然后在 php 中出现这样的错误

> 致命错误：无法在第 12 行的 pdf.tpl 中重新声明 TextBox()（之前在 pdf.tpl:7 中声明）

这是我第 7-13 行的代码

```
function TextBox($pdf,$textval, $x = 0, $y, $width = 0, $height = 10, $fontsize = 8, $fontstyle = '', $align = 'L',$ltr='',$fil='') {
    $pdf->SetXY($x+15, $y); // 20 = margin left
    $pdf->SetFont('freesans', $fontstyle, $fontsize);
    $pdf->Cell($width, $height, $textval,$ltr,false , $align,$fil);

}
$startpage = $pdf->GetPage(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T07:54:32.520

TextBox 是 TCPDF 也使用的函数名称。选择另一个。

# php - 比较网站负载上的 cookie

> ID：12030038
> 
> 赞同：1
> 
> 时间：2012-08-19T21:10:41.840
> 
> 标签：php, codeigniter, cookies

我正在使用 Code Igniter，并且正在实现记住用户功能。

基本上，从另一个堆栈溢出帖子中，我以正确的方式实现了这一点，即为该用户生成随机字符串，将其保存在数据库和 cookie 中。在站点加载时，我检查该 cookie，如果找到该 cookie，我将在数据库中检查它。如果在数据库中找到它，则为该用户重新创建会话。

我遇到的问题是当我加载网站时。我得到了 cookie 的值，也得到了 AJAX 调用的正确响应。但是，我必须单击一个链接才能重新创建会话（例如为登录用户显示菜单等）。

我在想我在调用主控制器的 index 方法之后重新创建会话。如何在 Code Igniter 中解决这个问题？我可以在哪里放置这个最好在每个页面上首先运行的代码？例如，如果用户进入网站的联系我们页面而不是主页，我还想重新创建会话。

提前谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T21:21:42.023

CodeIgniter 允许开发人员创建在调用控制器方法之前的不同时刻调用的钩子。

以下是如何使用钩子的简短说明：

[http://codeigniter.com/user_guide/general/hooks.html](http://codeigniter.com/user_guide/general/hooks.html)

如果你想访问会话，我建议使用一个`post_controller_constructor`钩子，它在控制器构造函数执行之后，但在调用 action 方法之前调用。（[在预控制器 codeigniter 挂钩中访问 CI 会话](https://stackoverflow.com/questions/8674166/access-the-ci-session-in-a-pre-controller-codeigniter-hook)）

# android - Android ActionBarSherlock 在 Honeycomb / Galaxy Tab 上出错了

> ID：12030039
> 
> 赞同：1
> 
> 时间：2012-08-19T21:10:48.287
> 
> 标签：android, android-actionbar, android-3.0-honeycomb, actionbarsherlock

我已经创建了适用于从 2.2 开始的每个 Android 版本的应用程序，但现在我在运行 Android 3.2/Honeycomb 的 Galaxy Tab 上尝试了它，应用程序在运行时异常时死机！

> 08-19 23:45:54.800: E/AndroidRuntime(29531): java.lang.RuntimeException: 无法启动活动 ComponentInfo{PACKAGE+ACTIVITY HERE}: java.lang.IllegalStateException: 你必须使用 Theme.Sherlock, Theme.Sherlock .Light、Theme.Sherlock.Light.DarkActionBar 或派生类。

但是在我的styles.xml中，我已经声明为我的主题

```
<style name="AppTheme" parent="Theme.Sherlock" /> 
```

在 AndroidManifest 上

```
android:theme="@style/AppTheme" > 
```

什么可能是错的？适用于所有其他设备！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T15:42:41.023

对不起，如果这听起来像一个愚蠢的答案，但你检查过这个：

Honeycomb 有一个 values-v11 文件夹。所以也许你得到了一个例外，因为 -v11 中的样式仍然不是 Sherlock 样式，而你只更改了值中的普通样式？

也许这对任何人都有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T21:14:42.003

更改`parent="Theme.Sherlock"`为`parent="@style/Theme.Sherlock`

遗憾的是，Android 在指定不存在的父母时不会抱怨，因此您不会因此而收到编译错误。

# vb.net - wacom stu-300，wintab32.dll？在哪里，我该如何开始？找不到wintab32...？VB.NET

> ID：12030042
> 
> 赞同：1
> 
> 时间：2012-08-19T21:11:04.520
> 
> 标签：vb.net, signature, wacom, electronic-signature

我购买了两个 Wacom stu-300 签名标签。我可以选择购买重要的 SDK/软件，但我想自己与他的 pad 进行交互。从研究中我发现我基本上需要访问 wintab32.dll。我到处都找不到？有人可以指出我正确的方向吗？

我只想捕获一个基本签名。没有花哨的图形。只是盖章签名。我尝试了一些示例应用程序，但其中大多数都抱怨缺少 wintab。Wacom 似乎明确声明 stu-300 将用作强制解决方案的一部分，并且他们不提供任何驱动程序或软件。签名板已安装，并显示在设备中。此选项卡是否有效/属于“平板电脑”PC 功能的范畴？

我真的很感激一些帮助，也许是一个示例应用程序？我更喜欢 vb.net。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:32:51.080

它最后由 Wacom 维护。DLL 隐藏在他们的驱动程序安装中。我发现它是 PenTablet 驱动程序版本 5.2.5-5a 的一部分，可在[http://www.wacom.com/en/customercare/Drivers.aspx?model=Bamboo&os=](http://www.wacom.com/en/customercare/Drivers.aspx?model=Bamboo&os=)

您可以从自解压安装程序中提取 wintab32.dll，而不是安装整个驱动程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-03T07:04:37.380

stu-300没有wintab，wacom有一套stu平板的SDK，可以从[https://ssl.wacom.eu/signature.wacom.eu/index.php?page_id=18索取](https://ssl.wacom.eu/signature.wacom.eu/index.php?page_id=18)

# javascript - 如何在不滚动的情况下将 PDF 嵌入网站实际大小？

> ID：12030044
> 
> 赞同：1
> 
> 时间：2012-08-19T21:11:34.797
> 
> 标签：javascript, pdf

我尝试在网页中包含 pdf 文档的片段。这些碎片大小不一。我想以实际尺寸完整显示它们。

我正在寻找用 javascript 编程的东西，例如：

```
<embed src="my_document.pdf#zoom=100" width="my_document.pdf".width height="my_document.pdf".height /> 
```

我不知道如何在 javascript 中检索我的文档元数据中的文档大小。

我没有问题显示pdf。此代码有效，但 100% 是网页的 100%，而不是 pdf 文档。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:07:57.403

**你不能用javascript做到这一点**

也许您最多可以获得一些元数据，例如文件大小和文件类型（应用程序/pdf）。“展开”pdf内容以获得宽度/高度并不是真正的标准，所以我怀疑它甚至在元数据中。

**可能的解决方案**

如果您的 pdf 文档包含文本并具有每个页面高度相同的布局，并且您可以访问 pdf 中的页面数量。如果是这样，您可以添加一个`<embed page_type='A4' page_count='$page_count' ..`可由 javascript 访问的属性。

A4 纸是 842 像素（我们称之为 paper_height），所以你可以做类似 pdf_height = paper_height * page_count * zoom;

**可选的东西**

我假设缩放是自定义的，因此您可以在其上添加一个 javascript 处理程序：

```
$('embed').height(paper_height * zoom);

// or

$('embed').css('height', paper_height * zoom); 
```

但是，如果缩放没有太多状态，您可能会使用一些预定义的 CSS 类。一开始你可以做`<embed class='pdf_height_no_zoom' ..`。如果用户单击缩放按钮`$('embed').attr('class', 'pdf_zoom_level2');`

# java - Java中的数学算法

> ID：12030048
> 
> 赞同：0
> 
> 时间：2012-08-19T21:11:48.410
> 
> 标签：java, math

这是我需要帮助的代码。

```
if (itemAmount >= usedWithAmount) {
    for (int i = 0; i < 10; i++) {
        if (amountToTransfer == 6) {
            usedWithAmount = i;
            break;
        }
        amountToTransfer = itemAmount - i;
        System.out.println(amountToTransfer);
    }
} else if (itemAmount < usedWithAmount) {
    for (int i = 0; i < 10; i++) {
        if (amountToTransfer == 6) {
            itemAmount = i;
            break;
        }
        amountToTransfer = usedWithAmount - i;
    }
} 
```

好吧，第一次大家看不懂，我再深入一点。

这用于在我的游戏中你有药水。药水里面有一定的量。结尾有 (6) 的药水，还剩 6 剂，(5) 还剩 5 剂，依此类推。

我正在这样做，所以当你在另一种药水上使用一种药水时，它会将药水从药水转移到另一种药水以使其充满。

因此，假设我有一瓶药水还剩 5 剂（表示为 itemAmount），我将它用在另一种剩余 2 剂的药水上（表示为 usedWithAmount）。

我希望上面的算法做的是使用第一个药水的值（itemAmount），并找出它应该转移到另一个药水的剂量以使其充满（6 剂量 = 满）。

因此，如果我将 5 剂药水与 2 剂药水一起使用，5 剂药水应该减掉 4 剂药，而 2 剂药水得到 4 剂药，我希望 amountToTransfer（在这种情况下为 4）表示要去除多少剂从第一项开始，并添加到第二项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T21:36:11.760

见[我的评论](https://stackoverflow.com/questions/12030048/math-algorithm-in-java#comment16056518_12030048)。你可以很容易地使用[`Math.min`](http://goo.gl/SeoBr).

```
amountToTransfer = Math.min(itemAmount, 6 - usedWithAmount); 
```

这将返回较小的那个——源药水的剩余部分或填充目标药水所需的量。

* * *

这也可以重写：

```
final int space = 6 - usedWithAmount;
amountToTransfer = itemAmount < space ? itemAmount : space; 
```

或者，类似于大卫的写作方式，

```
final int space = 6 - usedWithAmount;
if (itemAmount < space) {
  amountToTransfer = itemAmount;
} else {
  amountToTransfer = space;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T21:32:17.890

怎么样：

```
// Figure out how much room is available in the one getting the transfer
amountMissing = 6 - usedWithAmount

// If it has room to hold everything, transfer it all
if (amountMissing >= itemAmount)
{
    amountToTransfer = itemAmount;
}
// Otherwise, transfer as much as it can hold
else
{
    amountToTransfer = amountMissing;
} 
```

# django - 如何显示多对多关系中的所有属性？

> ID：12030051
> 
> 赞同：0
> 
> 时间：2012-08-19T21:12:08.677
> 
> 标签：django, templates, view, model, many-to-many

我的 Django 应用程序中有 2 个模型具有多对多关系。如何显示产品将拥有的每个类别？我在视图和模板中包含什么？

```
class Product(models.Model):
    website = models.CharField('Product name', max_length = 200)
    mutliple_cat = models.ManyToManyField(Multicat, null=True, blank=True)
    def __unicode__(self):
        return self.website

class Multicat(models.Model):
    mutlicat = models.CharField('Multi cat', max_length = 200, null=True, blank=True)
    mutlicat_url = models.CharField('Multi cat url', max_length = 200, null=True, blank=True)
    def __unicode__(self):
        return unicode(self.mutlicat) 
```

这是我的看法：

```
product = Product.objects.order_by("website") 
```

模板：

```
{% for prod in product %}
    {% for cat in prod.multiple_cat.all %}
            {{ cat.multicat }}
    {% endfor %}
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T21:15:10.350

假设您在名为`my_product`模板的变量中传递产品：

```
{% for cat in my_product.multiple_cat.all %}
    multicat name: {{ cat.multicat }}
    multicat url: {{ cat.multicat_url }}
{% endfor %} 
```

# c++ - 为 C++ 程序在“安全模式”下编译

> ID：12030055
> 
> 赞同：0
> 
> 时间：2012-08-19T21:12:56.130
> 
> 标签：c++

make 是否有一个选项可以使程序安全编译，以便导致未定义行为的事情会产生运行时错误；一个数组越界的例子？当然，这意味着程序运行得更慢。

如果 make 本身没有选项，是否会有另一个与 make 兼容的调试工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:39:17.060

据我所知（15 年以上的经验）MSVC 没有这样的东西。我也从未在其他编译器中听说过这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T21:41:28.770

如果 C++ 有这个特性，那就是 Java。或 Python。或 C#。或者……你明白了。

还有“托管 C++”，它有点像骆驼，也许可以满足您的目的。

在非 Windows 平台上，valgrind 工具是次佳。

各种版本的 Microsoft C++ 都有添加一些额外检查的选项，但在这些其他东西的规模上没有。

# jquery - jQuery 动画顶栏

> ID：12030061
> 
> 赞同：0
> 
> 时间：2012-08-19T21:14:11.890
> 
> 标签：jquery, html, jquery-animate

我有一个顶部导航栏，当我单击它时需要向上移动。

```
 var foo = false
$(document).ready(function(){
    $(".topBar").click(function(){
        findOut();
    });
});
function up()
{
    $(".topBar").animate({height:5},"slow");
}
function down()
{

    $(".topBar").animate({height:30},"slow");
}
function findOut()
{
    if (foo===true)
    {
        down();
        up =  false;
    }
    elseif (foo===false)
    {
        up();
        up = true;
    }
} 
```

在你问之前，是的，我确实安装了 jQuery 文件。

这是我的网站：learntc.net 最上面的吧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:16:31.103

您是否考虑过：

```
 $("#topBar").click(function()
    {
        $(this).slideToggle()
    }); 
```

这将使您的酒吧上升或下降，而无需使用标志。

[文档](http://api.jquery.com/slideToggle/)

如果您不想一直滑动它，您的代码看起来很好，除了`elseif(up===false)`.

如果您在您的网站上尝试它，您会看到即使您将高度设置为 5px，文本仍然可见，我建议您添加一个`overflow:hidden`以便它可以保持隐藏

**编辑** 工作代码：

```
var up = false
$(document).ready(function(){
        $(".topBar").click(function(){
            findOut();
        });
    });
    function upFunc()
    {
        $(".topBar").animate({height:5},"slow");
    }
    function down()
    {

        $(".topBar").animate({height:30},"slow");
    }
    function findOut()
    {
        if (up===true)
        {
            down();
            up =  false;
        }
        else if (up===false)
        {
            upFunc();
            up = true;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T21:26:29.403

您正在重新定义 up 变量以等于 up() 函数。也许改为：

```
var isup = false; 
```

# javascript - 如何检查 iframe 中的锚标记是否包含 URL

> ID：12030062
> 
> 赞同：0
> 
> 时间：2012-08-19T21:14:13.097
> 
> 标签：javascript, iframe

我正在处理一个通过 CGI 系统动态生成的页面，该网站的真正开发人员没有时间为我更改 python 代码。也就是说，我被迫构建页面（相同域）并使用一些 JavaScript 来修改其内容......现在，我正在尝试找到包含 URL 的锚标记并将目标属性设置为“_top” . 这样，打开菜单等的页面上的锚点被加载到框架中，并且指向场外的任何内容都被加载到整个窗口中。这是我尝试过的：

```
function pointOutside(){
    var anchorS = window.frames[0].document.getElementsByTagName("a");
    for(i=0;i<anchorS.length;i++){
        var foo = anchorS[i].getAttribute('href');
        foo = foo.toString();
        if(foo.search(/http/i) != -1){
            anchorS[i].setAttribute('target','_top');
        };
    };
};
setTimeout("pointOutside()",2000); 
```

超时使框架的内容在被调用之前有足够的时间加载，但我遇到麻烦的地方是检查 href 属性是否以“http”开头。我最初在没有“foo = foo.toString();”的情况下尝试了这个 行，但出现“未捕获的类型错误：无法在 null 上调用方法‘搜索’”的错误。我心想，“啊哈，我会确保它是一个字符串！” 但没有运气。现在，当我调用 toString() 时，我遇到了类似的错误...“未捕获的 TypeError：无法调用方法‘toString’ of null。”

奇怪的是，为了确保我的选择器正常工作，我使用了“alert(foo)”，并且能够为每个锚标记获取一个弹出窗口，显示 href 属性的值。

不知道我要去哪里错了。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T22:04:20.800

[首先，如果您在该浏览器窗口中有任何可用的 javascript 框架，请通过使用 DOMReady 函数（如 jQuery 的 .ready http://api.jquery.com/ready/](http://api.jquery.com/ready/)）来利用它们

此外，您需要考虑 .href 和 .getAttribute('href') 返回不同的值。例如，在 Chrome 中，.href 会返回您单击链接时将导航到的 url。.getAttribute('href') 但是返回锚标签中的实际内容，这可能是一个相对 url。

最后，您得到异常的原因是页面上可能有一些锚点没有 href 并且纯粹出于结构目的。对于这些元素，您可以在尝试使用 .toString() 之前插入一行，如下所示：

```
if (typeof foo !== "string") { continue; } 
```

如果未在该链接上设置 href，则 continue 语句会导致 for 循环忽略该链接并继续循环的下一次迭代。

# algorithm - 区分用户城市

> ID：12030065
> 
> 赞同：0
> 
> 时间：2012-08-19T21:14:45.553
> 
> 标签：algorithm, web-applications, geolocation, ip

假设我有一组用户，我想根据他们的 IP 地址检查用户是否在两个不同的城市。

我真的必须保留一个数据库映射IP组->城市吗？有没有更有效的方法来做到这一点？

我不关心用户来自*哪个*城市，只关心他们是否来自*不同*的城市。而且它也不必完全准确，我会对用户在不同城市的高百分比机会感到满意。

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T21:56:31.007

你如何定义高百分比？如果你愿意，你可以使用下面的地图[http://xkcd.com/195/](http://xkcd.com/195/)来帮助你确定他们是否在同一个大陆......

# facebook - 如何更改 facebook 的用户注册验证码测试样式？

> ID：12030068
> 
> 赞同：0
> 
> 时间：2012-08-19T21:14:57.883
> 
> 标签：facebook, recaptcha

我正在使用 facebook 插件在网站上进行用户注册。我通过设置此字段来激活验证码：

```
 {'name':'captcha'} 
```

一切都很好，但我只是不喜欢它的外观。它太硬核了。我需要刷新它几次，直到我了解图像中的内容。

那么，是否有可能将外观更改为更容易的东西？

![](../Images/d82187d647cac11f833daaa524e3c0e5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:52:43.053

Facebook 使用一个名为 reCaptcha 的系统来处理验证码。没有办法改变使用哪个系统。

# php - 使用 PHP 和 AJAX 将数据从表单加载到 MySQL

> ID：12030072
> 
> 赞同：0
> 
> 时间：2012-08-19T21:15:14.063
> 
> 标签：php, mysql, ajax, jquery

我有一个标准的 HTML 表单，我想将该表单中的数据存储到 MySQL 数据库中。我的一切工作正常，但现在我想实现 AJAX 以防止页面刷新，突然间我遇到了麻烦。

**问题：没有生成“成功”警报，并且没有将数据保存到数据库中。**

我对 Jquery/AJAX 的接触非常非常少，并且正在学习中，所以如果我犯了一个基本的错误，请多多包涵。

*****更新 1*******

 **这是我的新 AJAX 代码。表单中的数据现在正在保存到数据库中，但仍然没有成功警报。事实上，没有弹出窗口出现。

```
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script type="text/javascript">
        $(function() {
            $('form').bind('submit', function(){
                $.ajax({
                    type: 'post',
                    url: "InsertNewMentor.php",
                    data: $("form").serialize(),
                    success: function() {
                        alert("Success!");
                    }
                });
                return false;
            });
        });
    </script> 
```

这是表格（最后包括 AJAX 代码）。（更新：不再使用此代码，见上文）

```
<form>
<table cellpadding="10">

<tr>
<td><b>Chapter:</b></td>
<td><input type="text" name="chapter"></td>
</tr>

<tr>
<td>First Name:</td>
<td><input type="text" name="first"></td>

<td>Last Name:</td>
<td><input type="text" name="last"></td>
</tr>

<tr>
<td>Gender:</td>
<td>
<select name="gender">
<option value="male">Male</option>
<option value="female">Female</option>
</select>
</td>

<td>Ethnicity:</td>
<td>
<form action="">
<select name="ethnicity">
<option value="white">White/Caucasian</option>
<option value="hispanic">Hispanic</option>
<option value="asian">Asian/Pacific Islander</option>
<option value="native_american">Native American Indian</option>
<option value="other">Other</option>
</form>
</td>
</tr>

<tr>
<td>Year in School</td>
<td>
<form action="">
<select name="year_in_school">
<option value="freshman">Freshman</option>
<option value="sophomore">Sophomore</option>
<option value="junior">Junior</option>
<option value="senior">Senior</option>
</select>
</form>
</td>

<td>Phone Number:</td>
<td><input type="text" name="phone"></td>
</tr>

<tr>
<td>Email Address:</td>
<td><input type="text" name="email"></td>

<td>Street Address:</td>
<td>
<input type="text" name="address">
</td>
</tr>

<tr>
<td>Apt/Suite:</td>
<td>
<input type="text" name="suite_num">
</td>

<td>City:</td>
<td>
<input type="text" name="city">
</td>
</tr>

<tr>
<td>State:</td>
<td>
<select name="state">
<option value="Alabama">Alabama</option>
<option value="Alaska">Alaska</option>
<option value="Arizona">Arizona</option>
<option value="Arkansas">Arkansas</option>
<option value="California">California</option>
<option value="Colorado">Colorado</option>
<option value="Connecticut">Connecticut</option>
<option value="Delaware">Delaware</option>
<option value="Florida">Florida</option>
<option value="Georgia">Georgia</option>
<option value="Hawaii">Hawaii</option>
<option value="Idaho">Idaho</option>
<option value="Illinois">Illinois</option>
<option value="Indiana">Indiana</option>
<option value="Iowa">Iowa</option>
<option value="Kansas">Kansas</option>
<option value="Kentucky">Kentucky</option>
<option value="Louisiana">Louisiana</option>
<option value="Maine">Maine</option>
<option value="Maryland">Maryland</option>
<option value="Massachusetts">Massachusetts</option>
<option value="Michigan">Michigan</option>
<option value="Minnesota">Minnesota</option>
<option value="Mississippi">Mississippi</option>
<option value="Missouri">Missouri</option>
<option value="Montana">Montana</option>
<option value="Nebraska">Nebraska</option>
<option value="Nevada">Nevada</option>
<option value="New Hampshire">New Hampshire</option>
<option value="New Jersey">New Jersey</option>
<option value="New Mexico">New Mexico</option>
<option value="New York">New York</option>
<option value="North Carolina">North Carolina</option>
<option value="North Dakota">North Dakota</option>
<option value="Ohio">Ohio</option>
<option value="Oklahoma">Oklahoma</option>
<option value="Oregon">Oregon</option>
<option value="Pennsylvania">Pennsylvania</option>
<option value="Rhode Island">Rhode Island</option>
<option value="South Carolina">South Carolina</option>
<option value="South Dakota">South Dakota</option>
<option value="Tennessee">Tennessee</option>
<option value="Texas">Texas</option>
<option value="Utah">Utah</option>
<option value="Vermont">Vermont</option>
<option value="Virginia">Virginia</option>
<option value="Washington">Washington</option>
<option value="West Virginia">West Virginia</option>
<option value="Wisconsin">Wisconsin</option>
<option value="Wyoming">Wyoming</option>
</select>

</td>

<td>Zip Code:</td>
<td>
<input type="text" name="zip_code">
</td>
</tr>

<tr>
<td>Cumulutative GPA:</td>
<td><input type="text" name="gpa"></td>

<td>Major/Area of Study:</td>
<td><input type="text" name="major"></td>
</tr>

<tr>
<td>Twitter handle:</td>
<td>
<input type="text" name="twitter_handle">
</td>
</tr>

<tr>
<td colspan="2">
<p>Please describe any relevant teaching experience:</p>
<textarea rows="6" cols="45" name="teaching_experience">
</textarea>
</td>

<td colspan="2">
<p>Why do you want to join Moneythink?</p>
<textarea rows="6" cols="43" name="why_moneythink">
</textarea>
</td>
</tr>

</table>

<table>
<tr>
<td><input type="submit" value="Apply"></td>
<td><input type="reset" value="Clear"></td>
</tr>
</table>

</form>

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script type="text/javascript">
        $(function() {
            $('form').bind('submit', function(){
                $.ajax({
                    type: 'post',
                    url: "/InsertNewMentor.php",
                    data: $("form").serialize(),
                    success: function() {
                        alert("form was submitted");
                    }
                });
                return false;
            });
        });
    </script> 
```

这是 InsertNewMentor.hp

```
<?php
$username="";
$password="";
$database="";

$first = $_POST['first'];
$last = $_POST['last'];
$email = $_POST['email'];
$gpa = $_POST['gpa'];
$year = $_POST['year_in_school'];
$address = $_POST['address'];
$phone = $_POST['phone'];
$gender = $_POST['gender'];
$ethnicity = $_POST['ethnicity'];
$year_in_school = $_POST['year_in_school'];
$suite_number = $_POST['suite_num'];
$city = $_POST['city'];
$state = $_POST['state'];
$zip_code = $_POST['zip_code'];
$major = $_POST['major'];
$twitter_handle = $_POST['twitter_handle'];
$why_moneythink = $_POST['why_moneythink'];
$teaching_experience = $_POST['teaching_experience'];
$date = date("m/d/Y");

mysql_connect(localhost,$username,$password);
@mysql_select_db($database) or die( "Unable to select database");

$query = "INSERT INTO students VALUES ('','$address','$phone','$first','$last','$gender', '$ethnicity', '$year_in_school', '$email', '$suite_number','$city','$state','$zip_code','$major','$gpa','$twitter_handle','$why_moneythink','$teaching_experience','pending','$date')";
mysql_query($query);

mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:23:38.153

首先，serialize() 函数返回一个文本字符串，而不是一个值数组——更多信息请阅读[jQuery 文档。](http://api.jquery.com/serialize/) 现在提交 ajax -

```
 $(function() {
        $('form').bind('submit', function(){
            $.ajax({
                type: 'post',
                url: "/InsertNewMentor.php",
                **data: {dataString:  $("form").serialize()} ,**
                success: function() {
                    alert("form was submitted");
                }
            });
            return false;
        }); 
```

如上所述，您必须发送 JSON 格式的数据（注意数据字段的变化）

在 PHP 代码中，发布时，您只发布您通过 ajax -ie-dataString 发送的字段。此外，在成功功能中，您可能会使用：

```
 success: function(result) {
                alert(result);
            }
        }); 
```

因此您可以调试任何错误（如果存在）。祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T21:30:51.033

```
 <form id="formPost" method="POST">
 <table cellpadding="10">

 <tr>
 <td><b>Chapter:</b></td>
 <td><input type="text" name="chapter"></td>
 </tr>

 <tr>
 <td>First Name:</td>
 <td><input type="text" name="first"></td>

 <td>Last Name:</td>
 <td><input type="text" name="last"></td>
 </tr>

 <tr>
 <td>Gender:</td>
 <td>
 <select name="gender">
 <option value="male">Male</option>
 <option value="female">Female</option>
 </select>
 </td>

 <td>Ethnicity:</td>
 <td>

 <select name="ethnicity">
 <option value="white">White/Caucasian</option>
 <option value="hispanic">Hispanic</option>
 <option value="asian">Asian/Pacific Islander</option>
 <option value="native_american">Native American Indian</option>
 <option value="other">Other</option>

 </td>
 </tr>

 <tr>
 <td>Year in School</td>
 <td>

 <select name="year_in_school">
 <option value="freshman">Freshman</option>
 <option value="sophomore">Sophomore</option>
 <option value="junior">Junior</option>
 <option value="senior">Senior</option>
 </select>

 </td>

 <td>Phone Number:</td>
 <td><input type="text" name="phone"></td>
 </tr>

 <tr>
 <td>Email Address:</td>
 <td><input type="text" name="email"></td>

 <td>Street Address:</td>
 <td>
 <input type="text" name="address">
 </td>
 </tr>

 <tr>
 <td>Apt/Suite:</td>
 <td>
 <input type="text" name="suite_num">
 </td>

 <td>City:</td>
 <td>
 <input type="text" name="city">
 </td>
 </tr>

 <tr>
 <td>State:</td>
 <td>
 <select name="state">
 <option value="Alabama">Alabama</option>
 .....
 </select>

 </td>

 <td>Zip Code:</td>
 <td>
 <input type="text" name="zip_code">
 </td>
 </tr>

 <tr>
 <td>Cumulutative GPA:</td>
 <td><input type="text" name="gpa"></td>

 <td>Major/Area of Study:</td>
 <td><input type="text" name="major"></td>
 </tr>

 <tr>
 <td>Twitter handle:</td>
 <td>
 <input type="text" name="twitter_handle">
 </td>
 </tr>

 <tr>
 <td colspan="2">
 <p>Please describe any relevant teaching experience:</p>
 <textarea rows="6" cols="45" name="teaching_experience">
 </textarea>
 </td>

 <td colspan="2">
 <p>Why do you want to join Moneythink?</p>
 <textarea rows="6" cols="43" name="why_moneythink">
 </textarea>
 </td>
 </tr>

 </table>

 <table>
 <tr>
 <td><input type="submit" value="Apply"></td>
 <td><input type="reset" value="Clear"></td>
 </tr>
 </table>

 </form>

 <script type="text/javascript"      src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script type="text/javascript">
    $(function() {
        $('form').bind('submit', function(){
            $.ajax({
                type: 'post',
                url: "/InsertNewMentor.php",
                data: $("#formPost").serialize(),
                success: function() {
                    alert("form was submitted");
                }
            });
            return false;
        });
    });
</script> 
```

尝试这个**

# c# - 从 unicode 字符串中去除空字节

> ID：12030073
> 
> 赞同：-1
> 
> 时间：2012-08-19T21:15:22.560
> 
> 标签：c#

我的路径是 UTF-16 字符串。他们中的大多数只使用 ASCII 集，所以像这样的文件名将`test`被存储为

```
T \x00 E \x00 S \x00 T \x00 
```

我`Encoding.Unicode.GetString(bytes)`用来读取字符串并且它工作正常（当我将它们打印到控制台或表单控件时，它会按我的预期显示），但是当我想使用以下代码实际创建具有给定文件名的文件时

```
BinaryWriter outFile = new BinaryWriter(File.OpenWrite(path)); 
```

我得到一个例外

```
Unhandled Exception: System.ArgumentException: Illegal characters in path.
   at System.IO.Path.CheckInvalidPathChars(String path)
   at System.IO.Path.GetFileName(String path) 
```

这可能是因为那里有空字符（可能它在内部存储了原始字节数组），但我不知道如何处理它。不过，并非所有字符串都是 ASCII，并且一些字符使用两个字节。

更新：

原来非法字节只是填充到字符串中的空字节。但是，我不能简单地去除所有尾随空字节，但我也不知道字符串的长度。如何从每个字符存储在 n 个字节中的字符串中去除空字节？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T21:19:39.193

[来自 MSDN 上的“Path.GetInvalidPathChars”](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidpathchars.aspx)

> 完整的无效字符集可能因文件系统而异。例如，在基于 Windows 的桌面平台上，无效路径字符可能包括 ASCII/Unicode 字符 1 到 31，以及引号 (")、小于 (<)、大于 (>)、竖线 (|)、退格 ( \b)、空 (\0) 和制表符 (\t)。

您可以`Path.GetInvalidPathChars`用作过滤器。将输入字符串复制到输出字符串，同时过滤与`Path.CheckInvalidPathChars`.

这是我制作的一个例子：

```
string input = @"This <path> ""contains"" |some| ~invalid~ characters";

var invalidChars = Path.GetInvalidPathChars();

string output = input.Aggregate(new StringBuilder(), (sb, c) => invalidChars.Contains(c) ? sb : sb.Append(c), sb => sb.ToString());

// output contains: This path contains some ~invalid~ characters 
```

请注意，大多数符号都会被过滤掉，但波浪号不会，因为它们是有效的路径字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T21:20:08.607

您最有可能收到此错误，因为您的路径包含一个无效字符，如果您调用`Path.GetInvalidPathChars()`.

其中一些字符是`"`,`<`和。`|``>`

因为您已经使用`Encoding.Unicode.GetString`此问题对字符串进行了解码，所以与任何 UNICODE 编码问题无关。

这是一些简单（但不是很有效）的代码，可以用下划线替换路径中的无效字符：

```
var stringBuilder = path
  .Select(c => Path.GetInvalidPathChars().Contains(c) ? '_' : c)
  .Aggregate(new StringBuilder(), (a, c) => a.Append(c));
path = stringBuilder.ToString(); 
```

# python - 生成特定格式的数字列表

> ID：12030074
> 
> 赞同：21
> 
> 时间：2012-08-19T21:15:41.177
> 
> 标签：python, list, python-2.7

我需要生成特定格式的数字列表。格式是

```
mylist = [00,01,02,03,04,05,06,07,08,09,10,11,12,13,14,15]
#Numbers between 0-9 are preceded by a zero. 
```

我知道如何使用`range`

```
>>> for i in range(0,16):
...     print i 
```

那么，python中是否有任何内置方法可以生成指定格式的数字列表。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-08-19T21:18:14.927

Python[字符串格式化](http://docs.python.org/library/stdtypes.html#string-formatting)允许您指定精度：

> 精度（可选），以“.”形式给出 （点）后跟精度。

在这种情况下，您可以使用它的值 2 来获得您想要的：

```
>>> ["%.2d" % i for i in range(16)]
['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12',
 '13', '14', '15'] 
```

您还可以使用 zfill 函数：

```
>>> str(3).zfill(2)
'03' 
```

或字符串格式函数：

```
>>> "{0:02d}".format(3)
'03' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T05:58:48.907

在 oracle 中编写此查询以生成 01 02 03 系列

```
select lpad(rownum+1, decode(length(rownum),1,2, length(rownum)),0) from employees 
```

# javascript - Javascript测试是否设置了变量

> ID：12030078
> 
> 赞同：5
> 
> 时间：2012-08-19T21:16:16.130
> 
> 标签：javascript

一般来说，我测试一个变量是否设置了这样的东西：

```
if (variable !== '') {

   do something...

} 
```

我知道还有其他方法可以测试变量，`typeof`但我没有看到任何优势 - 这是测试是否设置变量的合适方法吗？我应该注意它有什么问题吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-19T21:21:17.940

两个原因：

1）如果通过获取空输入框的内容来设置变量怎么办？

```
if(someScenario){
    var variable = $('empty-box').val(); } 
```

也许这仅在某些情况下才会这样做，例如何时`someScenario`为真。稍后，您要检查是否设置了该变量。你的手段返回假而不是真。关键是，你可以想出你得到错误答案的场景。

没有理由*不*以公认的方式去做。

```
if(typeof variable !== 'undefined') 
```

它没有变慢，没有真正的缺陷，只是多了几个字符。

2）**最重要的是，使用`typeof`可以完全清楚您的要求**。可读性至关重要，如果另一个程序员阅读了第一个代码，他们会认为您正在检查它是否不是空字符串。使用的方法`typeof`可以完全清楚您的条件正在寻找什么，并减少以后出错的几率。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-19T21:42:14.913

如果`variable`已声明但可能没有值，那么您的代码：

```
if (variable !== '') { 
```

测试它是否不是空字符串。那是你要的吗？空字符串可能是有效值。最好测试`undefined`，或将其显式初始化为一个值，然后您可以将其视为“无效”（可能是`null`，或任何适合的值）。

**如果`variable`根本没有声明，上面的代码会导致一个*错误*，以至于执行会在那个时候停止**——你不能测试一个不存在的变量的值。因此，例如，如果您尝试测试在可能尚未调用的函数内创建的全局变量，或者您可能正在使用多个 JS 文件并且需要测试可能或可能不会的变量已由其他文件之一创建，那么唯一的方法是：

```
if (typeof variable != "undefined") { 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-19T21:46:04.803

通过在此页面上搜索“存在运算符”来查看咖啡脚本的存在运算符：http: [//coffeescript.org/](http://coffeescript.org/)

您的方法的功能问题是，您可能在脚本之前的某个时刻无意中为变量分配了一个空白字符串，而您的逻辑块现在会做错事。

从风格的角度来看，您的解决方案不太理想，因为您检查变量是否存在的意图并不明确。第一次阅读您的代码的人可能会误解您所写的意思是“我希望有一个名为 variable 的变量设置为空白字符串”而不是“如果此变量不存在，请执行某些操作。”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-19T21:21:07.483

由于您正在使用严格的相等测试，以下都将返回 true：

*   错误的
*   不明确的
*   无效的
*   0

您的支票将返回的唯一一次`false`是您传入一个空字符串。
那是你要的吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-19T21:24:27.413

这可能是非常主观的，但我的建议是避免代码，需要检查是否**设置**了变量（aot 具有某些值或类型）。

考虑这个snipplet

```
var a=false;
if (some_condition) a="Blah";
if (typeof(a)=='string') ....
if (a===false) ... 
```

这确保 ,`a`总是被设置，同时保持它很容易与`''`,`null`或`0`

# android - Roboto字体高度不一致

> ID：12030081
> 
> 赞同：7
> 
> 时间：2012-08-19T21:16:30.957
> 
> 标签：android, font-size

我目前正面临着 Android 字体 Roboto 的奇怪问题。起初，我在一个水平 LinearLayout 中有两个 TextView，垂直和水平居中。第一个 TextView 的字体设置为 Roboto-Black.ttf，第二个为 Roboto-Light.ttf。两者都设置为 textSize="12sp"，但带有 Roboto-Light.ttf 的那个仅比 Roboto-Black.ttf TextView 高一个像素。但是当我设置 textSize="13sp" 时它并没有发生。因此，我创建了新的 Android 项目，以确保它不仅在一个应用程序中。结果几乎相同，但在这种情况下， textSize="12sp" 按预期工作，但 textSize="13sp" 没有。我已经制作了屏幕截图来显示问题。

12sp 按预期工作。顶部边缘对齐。 ![图片](../Images/6a02010e914668dd1f7887375cdea62d.png)

13sp 有这种奇怪的行为。 ![图片](../Images/06098d9608453d7ec09e868a9d952d4b.png)

奇怪的是，这种情况只有在我尝试混合薄衬里和厚衬里变体时才会发生。当我制作一个 TextView Roboto-Bold.ttf 和第二个 Roboto-Black.ttf 时，结果很好。当我尝试 Roboto-Light.ttf 和 Roboto-Thin.ttf 时，它也能正常工作。

所以我也尝试在 Photoshop 中对此进行测试，这就是我发现的：

![图片](../Images/9faf24181e5787027ba16bcfc30d9ded.png)

除了 Roboto-Light.ttf 之外，Roboto 系列的所有字体都是一样的。如果需要，我还可以发布布局的源代码。

提前致谢。

PS：对于链接，我很抱歉，但由于声誉低（全新帐户），我无法发布图片。同样在最后一个链接中，我必须从“http”中删除“h”，因为它不允许我超过两个链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T09:53:23.783

我不能告诉你它是否是字体，或者你的手机如何解释字体并将它们显示在屏幕上，但我可以告诉你，我以前在中间居中视图时遇到过问题。

您是否尝试过使用 relativelayout，然后将第二个 textviews 顶部和 bot 与第一个 textview 对齐？那可能会解决问题。

# soap - 使用 Web 服务将 MS Infopath 与 Siebel CRM On Demand 连接

> ID：12030084
> 
> 赞同：0
> 
> 时间：2012-08-19T21:17:00.047
> 
> 标签：soap, infopath, credentials, siebel, ondemand

我必须创建一个表单，我想将客户 ID 发送到 CRMOD，并且应该获取客户地址……客户联系人。

我做到了，但是当我单击“运行查询”按钮时，它给了我错误：

SOAP 响应表明服务器上发生了错误：

服务器 SBL-ODU-01006 内部错误：会话不可用。中止。

如何避免这种情况。如何传递我的 Siebel 凭据。如何查看 MS Infopath 正在发送的 SOAP 请求？？？？请帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T22:11:10.030

该错误是因为您没有活动会话，或者您没有在soap 请求标头中包含凭据。

我不确定你是如何在 MS Infopath 中做到这一点的，但这就是 SOAPUI 添加它的方式。

```
<soapenv:Envelope xmlns:acc="urn:/crmondemand/xml/account" xmlns:ns="urn:crmondemand/ws/account/10/2004" xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
   <soapenv:Header>
      <wsse:Security soapenv:mustUnderstand="1" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-1" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
            <wsse:Username>USERNAME</wsse:Username>
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">PASSWORD</wsse:Password>
            <wsse:Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">ICC4Ho6oURr/yaJI9uN/+Q==</wsse:Nonce>
            <wsu:Created>2013-04-11T22:07:18.772Z</wsu:Created>
         </wsse:UsernameToken>
      </wsse:Security>
   </soapenv:Header>
   <soapenv:Body>
      <ns:AccountWS_AccountQueryPage_Input>     
         <acc:ListOfAccount>
            <acc:Account>
              .....
            </acc:Account>
         </acc:ListOfAccount>
      </ns:AccountWS_AccountQueryPage_Input>
   </soapenv:Body>
</soapenv:Envelope> 
```

# python - Python-Twisted Reactor 启动得太早

> ID：12030085
> 
> 赞同：1
> 
> 时间：2012-08-19T21:17:11.997
> 
> 标签：python, twisted

我有一个应用程序使用 PyQt4 和 python-twisted 来保持与另一个程序的连接。我正在使用[此处](https://code.launchpad.net/qt4reactor)找到的“qt4reactor.py” 。这都是使用 py2exe 打包的。该应用程序对 99% 的用户都运行良好，但一位用户报告说，他的 Windows 系统上的网络完全*失败。*没有其他用户报告此问题，我无法在我自己的 Windows VM 上复制它。用户*报告*无异常配置。

调试日志显示`reactor.connectTCP()`调用正在*立即*执行，即使反应器尚未启动！没有错误的运行顺序，因为这是一个单线程进程，计算时间为 60 秒，并且在这条线和反应器应该启动的时间之间有多个日志消息。

代码很多，所以我只放伪代码，希望有一个通用的解决方案。我将链接到它下面的实际代码。

```
import qt4reactor
qt4reactor.install()

# Start setting up main window
# ...

from twisted.internet import reactor

# Separate listener for detecting/processing multiple instances
self.InstanceListener = ListenerFactory(...)
reactor.listenTCP(LISTEN_PORT, self.InstanceListener)

# The active/main connection
self.NetworkingFactory = ClientFactory(...)
reactor.connectTCP(ACTIVE_IP, ACTIVE_PORT, self.NetworkingFactory)

# Finish setting up main window
# ...

from twisted.internet import reactor
reactor.runReturn() 
```

代码嵌套在整个[军械库项目文件](https://github.com/etotheipi/BitcoinArmory)中。ArmoryQt.py（包含上述代码）和armoryengine.py（包含`ReconnectingClientFactory`用于此连接的子类）。

因此，`reactor.connectTCP()`调用立即执行。客户端代码执行发送命令，然后立即`connectionLost()`被调用。它似乎没有尝试重新连接。它也不会抛出除`connectionLost()`. 更神秘的是，它稍后会收到来自远程节点的消息，而这个应用程序甚至会处理它们！但它认为它没有连接（并且握手从未完成，因此远程节点*不*应该发送消息，但可能是该程序中的错误/疏忽）。

到底是怎么回事！？反应堆怎么能在我告诉它启动之前启动呢？我搜索了代码，发现没有其他代码（我相信）可以启动反应堆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:07:28.693

您正在寻找的 API 是[twisted.internet.reactor.callWhenRunning](http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorCore.html#callWhenRunning)。

但是，启动时的计算时间少于 60 秒也没有什么坏处：）。如果它是相对独立的，也许你应该把它分散开，或者将它委托给一个线程？

# javascript - 从 Javascript 函数返回一个变量

> ID：12030086
> 
> 赞同：2
> 
> 时间：2012-08-19T21:17:13.857
> 
> 标签：javascript, jquery

如何访问 的值`imgWidth`？这是给我`undefined`的。

```
somejQueryMethod(function() { 
    var imgWidth;
    $("<img/>").attr(
        "src", 
        $("#SomeImgSelector").attr("src")
    ).load(function() {
        imgWidth = this.width;
    });
    // use imgWidth here
    // imgWidth is undefined here
}); 
```

> **背景信息**：从[这个 SO question](https://stackoverflow.com/a/670433/31399)我假设，正如在方法`imgWidth`之外定义的那样`load()`，它总是可以在`load()`. 这让我想知道为什么定义`imageWidth`there 而不是 in `load()`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-19T21:21:29.557

您不能在那里使用该值，因为它还不存在。命令中的回调函数在`load`内容加载后运行，并且发生在使用`load`命令的函数结束之后。

将需要该值的代码放入`load`命令的回调函数中：

```
...somejQueryMethod(
    function() { 
        var imgWidth;
        $("<img/>").attr("src", $("#SomeImgSelector").attr("src")).load( function() {
          imgWidth = this.width;
          // use imgWidth here
        } );
    }
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-19T21:21:00.933

你的问题对我来说没有多大意义。您不能在那里使用它，因为它还没有值 - 您应该在定义负载处理程序函数内或之后使用它。

编辑：只是补充一下，花点时间想想你在做什么。当您更改 src 属性时，您是在告诉它从某个 url 加载图像。然后，您将附加一个加载事件以触发（当它完成加载时）以捕获加载图像的宽度。现在，在代码完成加载图像之前，您当然不能使用该值。在这里，您使用的是异步加载，这实际上意味着您的代码将被处理到最后，并且加载将“同时”发生，因此它不会等待图像加载完成。如果你愿意，你也可以改变你的代码，让它真正等待它完成，或者你可以在负载处理程序中使用宽度，正如其他人所展示的那样。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-19T21:24:05.813

该`load`函数是**异步**的，这意味着您需要在回调函数中提供所有功能。

```
somejQueryMethod(function() {         
    $("<img/>").attr(
        "src", 
        $("#SomeImgSelector").attr("src")
    ).load(function() {
        var imgWidth = this.width;
        // use imgWidth here
    });
}); 
```

# php - 在动态表中使用 jQuery 替换文本链接

> ID：12030087
> 
> 赞同：0
> 
> 时间：2012-08-19T21:17:22.703
> 
> 标签：php, html, jquery

我正在使用 Zend Framework 并使用 Zend_Db 从数据库中检索行。HTML如下。目的是在单击时切换幻灯片列中的“是/否”文本。ajax 调用有效并返回正确的结果。但是，我无法选择单元格并更改文本。

```
<table class="table table-bordered table-striped">
            <thead>
            <tr>

                <th>ID</th>
                <th>title</th>
                <th>Caption</th>
                <th>Image</th>
                <th></th>
                <th></th>
                <th>Slideshow</th>
            </tr>
            </thead>
            <tbody>
                <?php
                foreach($this->sections as $section){
                    if($section['slide']==0){ $slideText='No';  }
                    if($section['slide']==1){ $slideText='Yes';  }
                    ?>
                <tr>

                    <td>
                        <span class="badge"><?php echo $section['id']; ?></span>
                    </td>
                    <td>
                        <?php echo $section['caption']; ?>
                    </td>
                    <td>
                        <?php echo $section['comment']; ?>
                    </td>
                    <td>
                        <img src="/images/uploads/<?php echo $section['image_url']; ?>" width="180" height="100">
                    </td>
                    <td><a href="<?php echo $this->url(array('id'=>$section['id'],'sid'=>$this->id, 'type'=>'edit'),'admin-edit')  ?>">Edit</a></td>
                    <td><a href="<?php echo $this->url(array('id'=>$section['id'],'sid'=>$this->id,'type'=>'delete'),'admin-edit')  ?>">Delete</a></td>
                    <td class="imgajax"><a href="<?php echo $this->url(array('id'=>$section['id'],'type'=>'update'),'ajax-admin',true,true)  ?>" class="slide"><?php echo $slideText; ?></a></td>
                </tr>
                    <?php }?>

            </tbody>
        </table>
        <?php } ?> 
```

javascripts如下；

```
$(".imgajax a").click(function(event){
        event.preventDefault();
        var url = $(this).url();
        id = url.segment(4);

        $.ajax({
            type: 'GET',
            url:"/admin/ajax",
            data:"id="+id,
            success: function(data) {
                console.log(data);

                if(data==1){
                    $('.slide').text('Yes');
                }
                if(data==0)
                {
                    $('.slide').text('No');
                }
            }
        });

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T08:59:36.280

你应该使用

```
$('.slide').html('Yes'); 
```

代替

```
$('.slide').text('Yes'); 
```

# iphone - 使用 GCD 的 dispatch_group_wait

> ID：12030092
> 
> 赞同：5
> 
> 时间：2012-08-19T21:18:00.120
> 
> 标签：iphone, ios, multithreading, concurrency, grand-central-dispatch

所以我将一组图像发布到我的服务器。我想使用 GCD 异步发布数组，但我也想让发生这种情况的方法同步，以便我可以传回单个响应对象。但是方法 dispatch_group_wait 似乎立即返回（而不是等待我的块完成）。这是一个问题，因为我在一个块中使用一个块吗？

```
NSArray *keys = [images allKeys];
__block NSMutableDictionary *responses = [NSMutableDictionary dictionaryWithCapacity:[images count]];

dispatch_group_t group = dispatch_group_create();
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
for (int i = 0; i < [keys count]; i++) {
    __block NSString *key = [keys objectAtIndex:i];
    dispatch_group_async(group, queue, ^{
        [self postImage:[images objectForKey:key] completionHandler:^(ServerResponse *response){
            @synchronized(responses){
                if ([response succeeded]) {
                    NSString *value = [[response data] objectForKey:@"image_token"];
                    [responses setObject:value forKey:key];
                    NSLog(@"inside success %@",responses);
                } else {
                    NSString *error = response.displayableError;
                    if (!error) {
                        error = @"Sorry something went wrong, please try again later.";
                    }
                    [responses setObject:error forKey:@"error"];
                    [responses setObject:response forKey:@"response"];
                }
            }
        }];
    });
}
dispatch_group_wait(group, DISPATCH_TIME_FOREVER);
dispatch_release(group); 
```

我只想等待所有 [self postImage] 方法从服务器回调并修改响应字典。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-19T23:39:44.887

乔纳森的信号量示例是正确的。但是，我提到使用条件变量作为替代方案，所以我想我至少会发布一个示例。通常，CV 可用于等待更一般的条件，而不仅仅是 N 个工人。

请注意，条件变量有它们的位置（尽管不一定在这里），通常最好是在已经需要锁来改变共享状态时，然后其他线程可以等待特定条件。

```
NSUInteger numKeys = [keys count];

NSConditionLock *conditionLock = [[NSConditionLock alloc] initWithCondition:numKeys];
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
for (NSUInteger i = 0; i < numKeys; i++) {
    __block NSString *key = [keys objectAtIndex:i];
    dispatch_async(queue, ^{
        [self postImage:[images objectForKey:key] completionHandler:^(ServerResponse *response){
            // Basically, nothing more than a obtaining a lock
            // Use this as your synchronization primitive to serialize access
            // to the condition variable and also can double as primitive to replace
            // @synchronize -- if you feel that is still necessary
            [conditionLock lock];

            ...;

            // When unlocking, decrement the condition counter
            [conditionLock unlockWithCondition:[conditionLock condition]-1];
        }];
    });
}

// This call will get the lock when the condition variable is equal to 0
[conditionLock lockWhenCondition:0];
// You have mutex access to the shared stuff... but you are the only one
// running, so can just immediately release...
[conditionLock unlock]; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-19T22:32:20.703

没有看到 的代码`-postImage:completionHandler:`，很难说事情是在哪里安排的，但我假设他们调用了 iOS 提供的东西。如果是这样，块内的处理程序块将异步分派到全局队列，然后 iOS 提供的函数或方法会立即返回。就您的调度组而言，工作几乎是立即完成的。

没有简单的方法可以让团队等待在调用时间之前尚未安排好的工作`dispatch_group_wait()`。*但是，我们可以添加一个称为信号量*的较低级别的thingamajigger ，以确保我们的操作以正确的顺序完成，并将其安排在内部（异步）块的范围之外。

```
NSUInteger numKeys = [keys count];

dispatch_group_t group = dispatch_group_create();
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
for (NSUInteger i = 0; i < numKeys; i++) {
    __block NSString *key = [keys objectAtIndex:i];
    dispatch_group_async(group, queue, ^{
        // We create a semaphore for each block here. More on that in a moment.
        // The initial count of the semaphore is 1, meaning that a signal must happen
        // before a wait will return.
        dispatch_semaphore_t sem = dispatch_semaphore_create(1);
        dispatch_semaphore_wait(sem, DISPATCH_TIME_FOREVER);
        [self postImage:[images objectForKey:key] completionHandler:^(ServerResponse *response){
            ...
            // This instructs one caller (i.e. the outer block) waiting on this semaphore to resume.
            dispatch_semaphore_signal(sem);
        }];

        // This instructs the block to wait until signalled (i.e. at the end of the inner block.)
        dispatch_semaphore_wait(sem, DISPATCH_TIME_FOREVER);

        // Done with the semaphore. Nothing special here.
        dispatch_release(sem);
    });
}
dispatch_group_wait(group, DISPATCH_TIME_FOREVER);
// Now all the tasks should have completed.
dispatch_release(group); 
```

**不过这里有个问题。**信号量是一种*内核资源*。如果我们有 100 个任务要执行，但内核只能提供 99 个信号量怎么办？坏事™发生。我们可以重建代码以仅使用一个信号量，尽管等待它会显得有点不靠谱。顺便说一句，这样做实际上完全消除了调度组，所以我们实际上是用信号量替换了组。让我们来看吧！

```
NSUInteger numKeys = [keys count];

// set the count of the semaphore to the number of times it must be signalled before
// being exhausted. Up to `numKeys` waits will actually wait for signals this way.
// Additional waits will return immediately.
dispatch_semaphore_t sem = dispatch_semaphore_create(numKeys);
for (int i = 0; i < numKeys; i++) {
    dispatch_semaphore_wait(sem, DISPATCH_TIME_FOREVER);
}

dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
for (NSUInteger i = 0; i < numKeys; i++) {
    __block NSString *key = [keys objectAtIndex:i];
    dispatch_async(queue, ^{
        [self postImage:[images objectForKey:key] completionHandler:^(ServerResponse *response){
            ...;

            // This decrements the semaphore's count by one. The calling code will be
            // woken up by this, and will then wait again until no blocks remain to wait for.
            dispatch_semaphore_signal(sem);
        }];
    });
}

// At this point, all the work is running (or could have already completed, who knows?).
// We don't want this function to continue running until we know all of the blocks
// have run, so we wait on our semaphore a number of times equalling the number
// of signals we expect to get. If all the blocks have run to completion before we've
// waited for all of them, the additional waits will return immediately.
for (int i = 0; i < numKeys; i++) {
    dispatch_semaphore_wait(sem, DISPATCH_TIME_FOREVER);
}
// Now all the tasks should have completed.
dispatch_release(sem); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-20T00:44:01.917

是的，如前所述，`dispatch_group_wait()`不等待，因为`postImage:completionHandler:`调用似乎是异步的。如果你真的需要这段代码同步执行，那么信号量或锁似乎是一个合适的解决方案。

但是，如果您只想将所有响应收集到一本字典中进行处理，我相信最合适的解决方案是充分利用 GCD。并使用调度队列来管理可变字典；在我看到的大多数文件中，这似乎是苹果首选的解决方案。

解决方案的关键是本质上将可变字典的所有权转移到单个队列，然后仅从该队列中修改它。我所指的“所有权”不是内存管理意义上的对象所有权，而是修改权意义上的所有权。

我会考虑做这样的事情：

```
NSArray *keys = [images allKeys];
// We will not be reasigning the 'responses' pointer just sending messages to the NSMutableDictionary object __block is not needed.
NSMutableDictionary *responses = [NSMutableDictionary dictionaryWithCapacity:[images count]];
// Create a queue to handle messages to the responses dictionary since mutables are not thread safe.
// Consider this thread the owner of the dictionary.
dispatch_queue_t responsesCallbackQueue = dispatch_queue_create("com.mydomain.queue", DISPATCH_QUEUE_SERIAL);

for (NSString *key in keys) {
    // This async call may not be needed since postImage:completionHandler: seems to be an async call itself.
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{ 
        [self postImage:[images objectForKey:key] completionHandler:^(ServerResponse *response){
            dispatch_async(responsesCallbackQueue, ^{
                [responses setObject:response forKey:key];
                // Perhaps log success for individual requests.
                if (responses.count == keys.count){
                    NSLog(@"All requests have completed");
                    // All responses are available to you here.
                    // You can now either transfer back 'ownership' of the dictionary.
                    dispatch_async(dispatch_get_main_queue(), ^{
                        [self requestsHaveFinished:responses];
                    });
                }
            });
        }];
    });
} 
```

# ruby-on-rails - 错误测试创建操作

> ID：12030096
> 
> 赞同：0
> 
> 时间：2012-08-19T21:18:22.760
> 
> 标签：ruby-on-rails, ruby-on-rails-3, unit-testing, testing, ruby-on-rails-3.2

我正在尝试使用工厂女孩来测试我在 Rails 中的创建操作。我不断得到：

```
"Event.count" didn't change by 1.
<2> expected but was
<1>. 
```

当我运行测试时。我不相信我做过任何改变我的测试或控制器的事情：

我的测试如下所示：

```
test "should get create" do
    assert_difference('Event.count') do
      post :create, FactoryGirl.attributes_for(:event)
    end
    assert_not_nil assigns(:event)
    assert_response :success
  end 
```

我也尝试过使用`FactoryGirl.build(:event)`。我以前用过，我认为这是我所读到的正确使用方法。

这是我的工厂：

```
 factory :event do
        name 'First Event'
        street '123 street'
        city 'Chicago'
        state 'IL'
        date '1/12/2012'
      end 
```

这是我的控制器动作

```
def create
    @event = Event.new(params[:event])
    @event.save
end 
```

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:09:27.130

为了确定您的错误范围，请尝试`debugger`在您的操作中抛出 a ：

```
def create
  @event = Event.new(params[:event])
  debugger
  @event.save
end 
```

看看你是否手动解决了 @event.save 以及哪些错误可能会阻止它。:D

# c# - 触发 RowUpdating 事件时，ADO.net Entity Gridview 为空

> ID：12030098
> 
> 赞同：1
> 
> 时间：2012-08-19T21:18:42.830
> 
> 标签：c#, asp.net, entity-framework

所以我在 ASP.Net (C#) 网页中使用 ADO.net 实体数据模型。我正在使用 gridviews 向我的数据库动态添加和检索数据。我正在使用母版页，而我的 gridview 位于 contentplaceholder 中。这段代码的唯一问题是，当我的 RowUpdating 事件触发时，gridview 为空。我可以通过 BindGV 函数调用，然后其余代码完美地更新数据库，使用我刚刚绑定到它的数据库中的原始数据，因为数据库尚未更新。无论如何，如果我将 bindGV() 更改为 Gridview1.databind()，则 gridview 为空。我认为当数据连接关闭时，gridview 所引用的数据源在事件结束时变为空，有没有办法防止这种情况发生？

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
    onrowcancelingedit="GridView1_RowCancelingEdit" 
    onrowediting="GridView1_RowEditing" onrowupdating="GridView1_RowUpdating" 
    onrowdatabound="GridView1_RowDataBound" 
    >
<Columns>

    <asp:TemplateField Visible="false">
        <ItemTemplate>
            <asp:Label ID="lblId" runat="server" Text='<%# Eval("id") %>'></asp:Label>
        </ItemTemplate>
        <EditItemTemplate>
            <asp:Label ID="lblId" runat="server" Text='<%# Eval("id") %>'></asp:Label>
        </EditItemTemplate>
    </asp:TemplateField>
    <asp:TemplateField HeaderText="Machine">
        <ItemTemplate>
            <asp:Label ID="lblMachine" runat="server" Text='<%# Eval("MachineName") %>'></asp:Label>
        </ItemTemplate>
        <EditItemTemplate>
            <asp:TextBox ID="txtMachine" runat="server" Text='<%# Eval("MachineName") %>'></asp:TextBox>
        </EditItemTemplate>
        <ControlStyle Width="60px" />
    </asp:TemplateField>
    <asp:TemplateField HeaderText="Dept">
        <ItemTemplate>
            <asp:Label ID="lblDept" runat="server" Text='<%# Eval("WorkCenterFK") %>'></asp:Label>
        </ItemTemplate>
        <EditItemTemplate>
            <asp:DropDownList ID="ddldept" runat="server" >
            </asp:DropDownList>
        </EditItemTemplate>
        <ControlStyle Width="120px" />
    </asp:TemplateField>
    <asp:CommandField HeaderText="Actions" ShowEditButton="true" ShowDeleteButton="True"
        ControlStyle-Width="50px" CausesValidation="false">
    </asp:CommandField>

</Columns> 
```

```
protected void BindGV()
{
    QualityEntities database = new QualityEntities();
    GridView1.DataSource = (from m in database.Machines
                            from d in database.Workcenters
                            where m.WorkcenterFK == d.id
                            select
                                new { id = m.id, MachineName = m.MachineName, WorkCenterFK = d.WorkCenterName }); ;
    GridView1.DataBind();
}
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack) BindGV();
}

protected void GridView1_RowEditing(object sender, GridViewEditEventArgs e)
{
    GridView1.EditIndex = e.NewEditIndex;
    BindGV();
}

protected void GridView1_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)
{
    GridView1.EditIndex = -1;
    BindGV();
}

protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
    QualityEntities database = new QualityEntities();
    BindGV();
    Int32 id = Convert.ToInt32(((Label)GridView1.Rows[e.RowIndex].FindControl("lblId")).Text);
    DropDownList ddl = ((DropDownList)GridView1.Rows[e.RowIndex].FindControl("ddlDept"));
    TextBox txt = ((TextBox)GridView1.Rows[e.RowIndex].FindControl("txtMachine"));
    Machine mch = (from m in database.Machines where m.id == id select m).Single();
    mch.MachineName = txt.Text;
    mch.WorkcenterFK = Convert.ToInt32(ddl.SelectedItem.Value);
    database.SaveChanges();
    GridView1.EditIndex = -1;
    BindGV();
}
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    QualityEntities database = new QualityEntities();
    DropDownList temp = (DropDownList)(e.Row.FindControl("ddlDept"));

    if (temp != null)
    {
        temp.DataSource = (from w in database.Workcenters select w);
        temp.DataTextField = "WorkCenterName";
        temp.DataValueField = "id";
        temp.DataBind();
        Int32 id = Convert.ToInt32(((Label)e.Row.FindControl("lblId")).Text);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:29:52.000

不知道为什么`GridView`是空的，但我不会使用成员变量，而是使用`sender`始终是事件源的事件（在这种情况下`GridView`）

```
// ...
GridView grid = (GridView)sender;
Int32 id = Convert.ToInt32(((Label)grid.Rows[e.RowIndex].FindControl("lblId")).Text);
// ... 
```

# html - Wordpress 样式没有延续到其他页面——为什么？

> ID：12030099
> 
> 赞同：0
> 
> 时间：2012-08-19T21:18:46.620
> 
> 标签：html, css, wordpress, wordpress-theming

***您是否曾经为 wordpress 标题设置样式，然后发现该标题忽略了您在较低级别页面上的 CSS 样式？**真的可以使用你的帮助来调试这个烦人的问题——提前谢谢你！*

我在这里为朋友创建一个简单的投资组合网站：http: [//sundryspirit.com/](http://sundryspirit.com/)

主页在页面顶部有一个全局标题，应该出现在网站的每个页面上：

```
<div id="header">
    <div id="header-top">                   
        <div id="logo">
            <a href="<?php bloginfo('url'); ?>">
            <h1>Sundry &amp; Spirit</h1>                
            <h2>Burning Man Apparel</h2>
            </a>            
        </div>

        <div id="mainNav">
            <?php wp_nav_menu(); ?> 
        </div>
    </div>
</div> 
```

我现在在 style.css 文件中为这个头添加了一些基本的样式：

```
#header {
width: 100%;
height: auto;
background: #e1e1e1;
opacity: 0.75;
margin: 0 auto;
max-width: 960px;
}

#header-top {   
height: 50px;
margin: 10px;
position: relative;
padding: 10px;
text-align: center;
} 
```

**这是令人讨厌的问题：基本的标题样式不会延续到其他页面，例如[http://sundryspirit.com/gallery/](http://sundryspirit.com/gallery/)**

如果标头只是来自 header.php 文件，那怎么可能？！感谢您的帮助——我在这里的经验不足让我发疯了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:22:17.877

您正在使用相对 URL 链接到您的样式表：

```
<link rel="stylesheet" href="wp-content/themes/sundry/style.css" /> 
```

将其更改为绝对 URL：

```
<link rel="stylesheet" href="/wp-content/themes/sundry/style.css" />
                             ^ 
```

或使用[`get_stylesheet`](http://codex.wordpress.org/Function_Reference/get_stylesheet).

# opengl-es - 片段着色器中的轮廓/清晰过渡

> ID：12030101
> 
> 赞同：3
> 
> 时间：2012-08-19T21:18:47.810
> 
> 标签：opengl-es, opengl-es-2.0, glsl

我想在我的片段着色器中的像素之间创建一个锐利的过渡效果，但我不确定我该如何做到这一点。

在我的顶点着色器中，我有一个`varying float x;`，在我的片段着色器中，我使用这个值来设置颜色的不透明度。我量化当前值以产生分层效果。我想做的是在一个非常小的效果水平上产生一个独特的边框（完全不同的颜色）。例如，如果`x>0.1`并且对于任何相邻像素`x<0.1`，则生成的颜色应该是黑色。

它在 GLSL 中看不到任何访问相邻像素的方法（我可能是错的）。我怎么能达到这样的效果。我仅限于 OpenGL-ES2.0（尽管如果在这个版本上根本不可能，那么任何解决方案都会有所帮助）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-19T21:25:08.967

您是正确的，您无法访问相邻像素，这是因为无法保证写入像素的顺序，它们都是并行绘制的。如果您可以访问帧缓冲区中的相邻像素，您将得到不一致的结果。

但是，如果需要，您可以在后期处理中执行此操作。将整个场景绘制到帧缓冲区纹理中，然后使用过滤着色器将该纹理绘制到屏幕上。

从着色器中的纹理绘制时，您可以随意采样相邻的纹素，因此您可以轻松比较两个相邻纹素之间的增量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T00:48:03.607

如果您的 OpenGL ES 实现支持[`OES_standard_derivatives`](http://www.khronos.org/registry/gles/extensions/OES/OES_standard_derivatives.txt)扩展，您可以通过与 2×2 四边形中的相邻像素进行前向/后向差分来获得变量的变化率：

```
float outline(float t, float threshold, float width)
{
    return clamp(width - abs(threshold - t) / fwidth(t), 0.0, 1.0);
} 
```

此函数返回指定宽度的线的覆盖范围，其中`t`≈ `threshold`，`fwidth`用于确定它与截止点的距离。请注意，`fwidth(t)`它等效于`abs(dFdx(t)) + abs(dFdy(t))`并计算[曼哈顿距离](http://en.wikipedia.org/wiki/Taxicab_geometry)中的宽度，这可能会使对角线过胖。如果您更喜欢[欧几里得距离](http://en.wikipedia.org/wiki/Euclidean_distance)：

```
float outline(float t, float threshold, float width)
{
    float dx = dFdx(t);
    float dy = dFdy(t);
    float ewidth = sqrt(dx * dx + dy * dy);
    return clamp(width - abs(threshold - t) / ewidth, 0.0, 1.0);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T17:37:20.693

除了基于导数的 Pivot 实现之外，您还可以使用基于源像素尺寸的偏移量从源图像中抓取相邻像素。以像素为单位的宽度或高度的倒数是您需要在此处使用的当前纹理坐标的偏移量。

例如，这是一个顶点着色器，我用来计算围绕中心像素的八个像素的这些偏移量：

```
 attribute vec4 position;
 attribute vec4 inputTextureCoordinate;

 uniform highp float texelWidth; 
 uniform highp float texelHeight; 

 varying vec2 textureCoordinate;
 varying vec2 leftTextureCoordinate;
 varying vec2 rightTextureCoordinate;

 varying vec2 topTextureCoordinate;
 varying vec2 topLeftTextureCoordinate;
 varying vec2 topRightTextureCoordinate;

 varying vec2 bottomTextureCoordinate;
 varying vec2 bottomLeftTextureCoordinate;
 varying vec2 bottomRightTextureCoordinate;

 void main()
 {
     gl_Position = position;

     vec2 widthStep = vec2(texelWidth, 0.0);
     vec2 heightStep = vec2(0.0, texelHeight);
     vec2 widthHeightStep = vec2(texelWidth, texelHeight);
     vec2 widthNegativeHeightStep = vec2(texelWidth, -texelHeight);

     textureCoordinate = inputTextureCoordinate.xy;
     leftTextureCoordinate = inputTextureCoordinate.xy - widthStep;
     rightTextureCoordinate = inputTextureCoordinate.xy + widthStep;

     topTextureCoordinate = inputTextureCoordinate.xy - heightStep;
     topLeftTextureCoordinate = inputTextureCoordinate.xy - widthHeightStep;
     topRightTextureCoordinate = inputTextureCoordinate.xy + widthNegativeHeightStep;

     bottomTextureCoordinate = inputTextureCoordinate.xy + heightStep;
     bottomLeftTextureCoordinate = inputTextureCoordinate.xy - widthNegativeHeightStep;
     bottomRightTextureCoordinate = inputTextureCoordinate.xy + widthHeightStep;
 } 
```

这是一个片段着色器，它使用它来执行 Sobel 边缘检测：

```
 precision mediump float;

 varying vec2 textureCoordinate;
 varying vec2 leftTextureCoordinate;
 varying vec2 rightTextureCoordinate;

 varying vec2 topTextureCoordinate;
 varying vec2 topLeftTextureCoordinate;
 varying vec2 topRightTextureCoordinate;

 varying vec2 bottomTextureCoordinate;
 varying vec2 bottomLeftTextureCoordinate;
 varying vec2 bottomRightTextureCoordinate;

 uniform sampler2D inputImageTexture;

 void main()
 {
    float bottomLeftIntensity = texture2D(inputImageTexture, bottomLeftTextureCoordinate).r;
    float topRightIntensity = texture2D(inputImageTexture, topRightTextureCoordinate).r;
    float topLeftIntensity = texture2D(inputImageTexture, topLeftTextureCoordinate).r;
    float bottomRightIntensity = texture2D(inputImageTexture, bottomRightTextureCoordinate).r;
    float leftIntensity = texture2D(inputImageTexture, leftTextureCoordinate).r;
    float rightIntensity = texture2D(inputImageTexture, rightTextureCoordinate).r;
    float bottomIntensity = texture2D(inputImageTexture, bottomTextureCoordinate).r;
    float topIntensity = texture2D(inputImageTexture, topTextureCoordinate).r;
    float h = -topLeftIntensity - 2.0 * topIntensity - topRightIntensity + bottomLeftIntensity + 2.0 * bottomIntensity + bottomRightIntensity;
    float v = -bottomLeftIntensity - 2.0 * leftIntensity - topLeftIntensity + bottomRightIntensity + 2.0 * rightIntensity + topRightIntensity;

    float mag = length(vec2(h, v));

    gl_FragColor = vec4(vec3(mag), 1.0);
 } 
```

我传入`texelWidth`和`texelHeight`制服，它们分别是图像的 1/宽度和 1/高度。这确实需要您跟踪输入图像的宽度和高度，但它应该适用于所有 OpenGL ES 设备，而不仅仅是那些具有衍生扩展的设备。

我在顶点着色器中进行纹理偏移计算有两个原因：因此偏移计算只需要每个顶点执行一次，而不是每个片段一次，更重要的是因为一些基于图块的延迟渲染器对依赖纹理的反应很差读取在片段着色器中计算纹理偏移的位置。对于在这些设备上删除这些依赖纹理读取的着色器程序，性能可以提高 20 倍。

# ios - 使用 Wifi 网络连接 iOS 一组 iOS 设备

> ID：12030105
> 
> 赞同：2
> 
> 时间：2012-08-19T21:19:16.757
> 
> 标签：ios, sdk, wifi, sync, device

我正在寻找一种在连接到同一 Wi-fi 网络的 iOS 设备之间同步数据的新方法。

我的应用程序使用 iCloud 来同步其 CoreData UIManagedDocument，但 iCloud 延迟对于我的目标来说太大了。

有什么方法可以将同一 Wi-Fi 网络中的 iOS 设备与 iOS SDK 连接起来吗？有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T21:23:48.600

任何两个支持 IP 的设备都可以使用 BSD 套接字相互连接——我编写了一个 Objective-C 包装器来促进这样的网络操作——[就是这样。](http://github.com/H2CO3/TCPHelper)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-22T11:34:05.607

从 iOS 7 开始，您应该研究[Multipeer Connectivity Framework](https://developer.apple.com/library/prerelease/ios/documentation/MultipeerConnectivity/Reference/MultipeerConnectivityFramework/index.html)。它允许在同一 Wi-Fi 网络或蓝牙个人局域网上的 iOS 设备之间进行连接，并且 API 使用起来极其简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T21:25:05.843

您可以使用 Gamekit 连接 WiFi 和蓝牙并来回发送数据。

这里有一个很好但很长的教程[http://www.raywenderlich.com/12735/how-to-make-a-simple-playing-card-game-with-multiplayer-and-bluetooth-part-1](http://www.raywenderlich.com/12735/how-to-make-a-simple-playing-card-game-with-multiplayer-and-bluetooth-part-1) 你应该可以挑选出所有的连接位。

# javascript - Express.js - 如何检查标头是否已发送？

> ID：12030107
> 
> 赞同：82
> 
> 时间：2012-08-19T21:19:36.387
> 
> 标签：javascript, node.js, express, response-headers

我正在编写一个可以设置标题的库。如果已经发送了标头，我想给出一条自定义错误消息，而不是让它失败并显示 Node.js 给出的“发送后无法设置标头”消息。那么如何检查标头是否已经发送？

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2014-06-06T08:46:21.310

Node 支持`res.headersSent`这些天，所以你可以/应该使用它。它是一个只读布尔值，指示标头是否已发送。

```
if(res.headersSent) { ... } 
```

见[http://nodejs.org/api/http.html#http_response_headerssent](http://nodejs.org/api/http.html#http_response_headerssent)

注意：与 Niko 提到的较旧的 Connect 'headerSent' 属性相比，这是首选的方法。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2012-08-19T22:20:12.760

**编辑：从 express 4.x 开始，您需要使用 res.headersSent。另请注意，您可能希望在检查之前使用 setTimeout，因为它不会在调用 res.send() 后立即设置为 true。[来源](https://github.com/expressjs/express/issues/2109 "文档参考“res.headerSent”；")**

很简单：Connect 的 Response 类提供了一个公共属性“headerSent”。

`res.headerSent`是一个布尔值，指示标头是否已发送到客户端。

从源代码：

```
/**
   * Provide a public "header sent" flag
   * until node does.
   *
   * @return {Boolean}
   * @api public
   */

  res.__defineGetter__('headerSent', function(){
    return this._header;
  }); 
```

[https://github.com/senchalabs/connect/blob/master/lib/patch.js#L22](https://github.com/senchalabs/connect/blob/master/lib/patch.js#L22)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-08-13T05:24:25.347

其他答案指向 Node.js 或 Github 网站。

以下来自 Expressjs 网站：[https ://expressjs.com/en/api.html#res.headersSent](https://expressjs.com/en/api.html#res.headersSent)

```
app.get('/', function (req, res) {
  console.log(res.headersSent); // false
  res.send('OK');
  console.log(res.headersSent); // true
}); 
```

# android - 安卓应用注销

> ID：12030110
> 
> 赞同：1
> 
> 时间：2012-08-19T21:19:54.487
> 
> 标签：android, sqlite

我正在使用 contentprovider，以及共享首选项上的 3 个变量，我想知道如何最好地“注销用户”..

我希望它会截断数据库，并清除/删除共享首选项变量..

目前我正在清除共享首选项，并删除数据库，然后将用户带回登录屏幕。

```
SharedPreferences app_preferences = PreferenceManager
        .getDefaultSharedPreferences(this);
SharedPreferences.Editor editor = app_preferences.edit();

// wipe user specific data
editor.remove("authenticated_user_id");
editor.remove("api_key");
editor.remove("last_sync_updates");

editor.commit();

// TODO possibly truncate rather than delete
// the apps database
getApplicationContext().deleteDatabase(
        DatabaseConstants.DATABASE_NAME);

// send the user to the login screen
Intent logoutIntent = new Intent(this, SplashActivity.class);
startActivity(logoutIntent); 
```

但它似乎没有清除数据库，并且在注销后的第一个事务中随机出现数据库访问错误..

这通常是如何完成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-19T21:39:07.160

[**Google I/O 2012**](http://code.google.com/p/iosched/source/browse/#git/android)应用程序做了类似的事情，所以您可能想检查一下。当用户[**注销时**](http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/ui/HomeActivity.java#361)，将进行以下[**调用**](http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/util/AccountUtils.java#148)`ContentResolver`：

```
getContentResolver().delete(ScheduleContract.BASE_CONTENT_URI, null, null); 
```

这调用了`ScheduleProvider`的删除方法：

```
@Override
public int delete(Uri uri, String selection, String[] selectionArgs) {
    if (uri == ScheduleContract.BASE_CONTENT_URI) {
        // Handle whole database deletes (e.g. when signing out)
        deleteDatabase();
        getContext().getContentResolver().notifyChange(uri, null, false);
        return 1;
    }

    /* ... */
} 
```

`deleteDatabase()`以下私有辅助方法在哪里：

```
private void deleteDatabase() {
    mOpenHelper.close();
    Context context = getContext();
    context.deleteDatabase(ScheduleContract.DATABASE_NAME);
    mOpenHelper = new ScheduleDatabase(context);
} 
```

您可以看到从 开始发生的事件的确切顺序[**`ScheduleProvider.java`**](http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/provider/ScheduleProvider.java)。

# php - Codeigniter：Facebook 库使应用程序非常慢

> ID：12030113
> 
> 赞同：0
> 
> 时间：2012-08-19T21:20:24.470
> 
> 标签：php, codeigniter, facebook-authentication

我正在使用 Codeigniter 并包含 Facebook 库来实现 Facebook 身份验证。我将库自动加载为：

```
$autoload['libraries'] = array('database', 'session', 'facebook_lib', 'aescryption'); 
```

facebook_lib.php 库正在调用 facebook.php（它又调用 base_facebook.php）。现在，这使网站变得非常缓慢。在我的本地主机上加载页面大约需要 4-8 秒。我以前不知道这一点。页面加载速度非常慢。然后我分析了应用程序，发现即使我只是调用一个空白页面，它也确实很慢。然后我认为发生了其他事情，我的第一个想法是自动加载配置。如果我删除 'facebook_lib' 库，那么页面会立即加载。

有什么想法可以在这里做吗？有没有人遇到过类似的问题？

谢谢。

更新：

这是我在 facebook 库中的代码： $this->ci =& get_instance();

```
 // Create our Application instance
    //(replace this with your appId and secret).
    $this->ci->load->file(APPPATH.'/third_party/facebook.php');

    $this->data['facebook'] = new Facebook(array(
                                            'appId'  => $this->ci->config->item('fb_app_id'),
                                            'secret' => $this->ci->config->item('fb_secret_key')));

    $this->data['fb_user'] = $this->data['facebook']->getUser();

    if ($this->data['fb_user']) {           
     try {
            $this->data['$user_profile']=$this->data['facebook']->api('/me');
            $this->ci->load->model('login_signup_model');
            $this->ci->login_signup_model->storeFBUser($this->data['$user_profile']['id']);

            return true;
        } catch (FacebookApiException $e){
            error_log($e);
            $this->data['fb_user']=null;
        }
     } 
```

# php - 找不到 PHP 类，从头开始创建 XML 文档

> ID：12030114
> 
> 赞同：0
> 
> 时间：2012-08-19T21:20:34.913
> 
> 标签：php, xml

我正在尝试从 php.net（下面的代码）中完成一个示例，该示例允许您创建 SDO 数据图并将其保存到 XML 字符串。

```
<?php
/**
 * Create an XML document from scratch
 */
try {
   $xmldas = SDO_DAS_XML::create("letter.xsd");
   try {
       $doc = $xmldas->createDocument();
       $rdo = $doc->getRootDataObject();
       $seq = $rdo->getSequence();
       $seq->insert("April 09, 2005", NULL, 'date');
       $seq->insert("Acme Inc. ", NULL, NULL);
       $seq->insert("United Kingdom. ");
       $seq->insert("Dear", NULL, NULL);
       $seq->insert("Tarun", NULL, "firstName");
       $seq->insert("Nayaraaa", NULL, "lastName");
       $rdo->lastName = "Nayar";
       $seq->insert("Please note that your order number ");
       $seq->insert(12345);
       $seq->insert(" has been dispatched today. Thanks for your business with us.");
       print($xmldas->saveString($doc));
   } catch (SDO_Exception $e) {
       print($e);
   }
} catch (SDO_Exception $e) {
   print("Problem creating an XML document: " . $e->getMessage());
}
?> 
```

当我尝试运行代码时，出现以下错误：

`Fatal error: Class 'SDO_DAS_XML' not found in C:\xampp\htdocs\test.php on line 6`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T21:23:05.840

您需要先安装 SDO 包。

有关详细信息，请参阅[SDO 安装文档](http://www.php.net/manual/en/sdo.installation.php)

`sdo.dll`编辑：对于windows，如果有人已经编译了一个，你要么需要为你的php版本找到一个，要么自己构建它。

请参阅[在 Windows 上安装 PHP 扩展](http://php.net/manual/en/install.pecl.windows.php)

# c# - 在情节提要隐藏标签后无法使标签可见

> ID：12030124
> 
> 赞同：0
> 
> 时间：2012-08-19T21:21:47.197
> 
> 标签：c#, wpf

> **可能重复：**
> [程序在最小化后未从任务栏检索](https://stackoverflow.com/questions/11065518/program-isnt-retrieving-from-taskbar-after-minimizing-it)

背景 - 我有一个 ListBox，每个项目都包含几个按钮。单击按钮时，我希望标签与消息一起显示，然后淡出。我有一种方法来处理设置内容，使其可见，然后使用故事板将其淡出（见下文）。

这第一次工作正常，但是在同一个列表框项目中的任何进一步单击都不会导致任何事情发生 - 调试显示内容正在更改等，但控件永远不会变得可见。谁能指出我缺少的明显的东西（或者，一种可行的方式）？

```
private void SetLabelMessageContent(Panel panel, string message)
{
  Label lblMessage = panel.Children.OfType<Label>().First();
  if (lblMessage != null)
  {
    // Set content and make sure its visible
    lblMessage.Content = message;
    lblMessage.Visibility = Visibility.Visible;
    lblMessage.Opacity = 1.0;

    // Set the storyboard going - will fade it out
    var storyboard = lblMessage.FindResource("MessageFadeOut");
    if (storyboard is Storyboard)
    {
      ((Storyboard)storyboard).Clone().Begin(lblMessage);
    }
  }
} 
```

MessageFadeOut 资源是：

```
<Storyboard x:Key="MessageFadeOut">
  <DoubleAnimation BeginTime="0:0:2.0" Storyboard.TargetProperty="Opacity" From="1" To="0" Duration="0:0:0.25"/>
  <ObjectAnimationUsingKeyFrames BeginTime="0:0:2.25" Storyboard.TargetProperty="Visibility">
    <DiscreteObjectKeyFrame KeyTime="0">
      <DiscreteObjectKeyFrame.Value>
        <Visibility>Hidden</Visibility>
      </DiscreteObjectKeyFrame.Value>
    </DiscreteObjectKeyFrame>
  </ObjectAnimationUsingKeyFrames>
</Storyboard> 
```

# android - 当 seekBar 更新 Android 的 MediaPlayer 视频不流畅时

> ID：12030125
> 
> 赞同：1
> 
> 时间：2012-08-19T21:21:57.347
> 
> 标签：android, android-videoview, android-mediaplayer

我在我的 android 应用程序中通过 MediPlayer 播放视频并显示了 SeekBar。现在我希望这个搜索栏随着视频的进行自动更新，所以它应该自动从左到右移动。目前，（下面的代码）栏更新，这是通过运行线程完成的，每秒更新 seekBar 的进度。问题是它不流畅，并且当 seekBar 通过其 seekProgress() 更新时，视频会瞬间停止，一切都非常跳跃。现在我希望它比每秒更频繁地更新，并保留我已经实现的功能，以允许用户点击栏并更改视频的进度。

我在寻找类似 Android MediaPLayer 应用程序的东西，seekBar 在透明背景上，一切都很顺利，我不知道它是如何完成的。

不，目前正如您从下面的代码中看到的那样，线程每秒更新一次，因为它在 f run 方法中休眠。我也尝试过使用处理程序来更新 UI 线程，效果是一样的。我还将 SeekBar 扩展到它自己的类，在那里有线程，这也不好，完全一样的效果。

如果有人可以向我解释如何解决这个问题以及它是如何与其他播放器应用程序一起完成的，那就太好了。

```
public class FightPlayerActivity extends Activity implements Runnable, OnSeekBarChangeListener, SurfaceHolder.Callback, OnPreparedListener {

    private MediaPlayer mp=null;
    private SeekBar seekBar;
    private Thread progressBarUpdater;
    private String filePath;
    private Handler handler=new Handler();

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        Toast.makeText(this,"Create ", 2000).show();

    }

    public void surfaceChanged(SurfaceHolder holder, int format, int width,
            int height) {
        // TODO Auto-generated method stub

    }

    public void onStop()
    {
        super.onStop();

        mp.stop();
        mp.reset();
        mp.release();
    }

    public void run()
    {
        while(true)
        {
            try {
                progressBarUpdater.sleep(1000);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            seekBar.setProgress(mp.getCurrentPosition());

            // handler does have same effect, so video stops for split second
            //handler.postDelayed(this, 1000);

        }
    }

    public void onStart()
    {
        super.onStart();

        setContentView(R.layout.fight_player);

        filePath=getIntent().getStringExtra("filename");
        filePath=Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM)+"/FightAll_BJJ_Scoring/"+filePath;

        Toast.makeText(this,filePath, 2000).show();
        // seek bar

        seekBar=(SeekBar) findViewById(R.id.seek_bar);
        seekBar.setOnSeekBarChangeListener(this);

        try {
            SurfaceView sv=(SurfaceView) findViewById(id.video_preview);

            SurfaceHolder sh=sv.getHolder();
            sh.addCallback(this);

            sh.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

        } catch (IllegalArgumentException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (SecurityException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IllegalStateException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }    

    }

    public void stop(View view)
    {
        mp.seekTo(0);
        mp.pause();
    }

    public void pause(View view)
    {
        mp.pause();
    }

    public void play(View view)
    {
        mp.start();
    }

    public void surfaceCreated(SurfaceHolder holder) {

        try {
            mp=new MediaPlayer();
            mp.setDataSource(filePath);
            mp.setDisplay(holder);  
            mp.setOnPreparedListener(this);
            mp.setAudioStreamType(AudioManager.STREAM_MUSIC);
            mp.prepare();

            //handler.removeCallbacks(this);

            //handler.postDelayed(this, 1000);

        } catch (IllegalStateException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub

    }

    public void onPrepared(MediaPlayer mediaplayer) {
         mp.start(); 
         seekBar.setMax(mp.getDuration());

         progressBarUpdater=new Thread(this);
         progressBarUpdater.start();

         //handler.postDelayed(this, 1000);
    }

    public void onProgressChanged(SeekBar sb,int progress,boolean fromUser)
    {
        //Toast.makeText(this, progress, 2000).show();
        mp.seekTo(progress);
    }

    public void onStartTrackingTouch(SeekBar seekBar) {
        // TODO Auto-generated method stub
        onProgressChanged(seekBar,seekBar.getProgress(),true);
    }

    public void onStopTrackingTouch(SeekBar seekBar) {
        // TODO Auto-generated method stub

    }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:11:47.037

你的主要问题在于你的`onProgressChanged()`方法。

每次 seekBar 进度发生变化时，您都在寻找指定位置，即使它是以编程方式完成的。这意味着每次调用`seekBar.setProgress(mp.getCurrentPosition())`，`onProgressChanged()`都会被解雇。

所以我们将其更改为以下内容：

```
public void onProgressChanged(SeekBar sb, int progress, boolean fromUser) {
    if (fromUser) {
        mp.seekTo(progress);
    }
} 
```

这样它只会在用户移动 seekBar 时被触发。

此外，根据这个[答案](https://stackoverflow.com/a/5825280/1117415)，最好将您的 while(true) 循环替换为：

```
public void run() {
    seekBar.setProgress(mp.getCurrentPosition());
    if (mp.getCurrentPosition() < mp.getDuration()) {
        seekBar.postDelayed(this, MILLISECONDS);
    }

} 
```

# jsf - JSTL c:forEach 在 JSF h:dataTable 中不起作用

> ID：12030126
> 
> 赞同：1
> 
> 时间：2012-08-19T21:22:01.993
> 
> 标签：jsf, foreach, datatable, jstl

我有一个 JSF 项目的问题。

*   GlassFish 服务器 3.1.2
*   莫哈拉 2.1.6

我正在尝试显示一个包含请求标头字段的表。因此，我编写了这个托管 bean：

```
import java.util.Collections;
import java.util.LinkedHashMap;
import java.util.List;
import javax.annotation.PostConstruct;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.RequestScoped;
import javax.faces.context.FacesContext;
import javax.servlet.http.HttpServletRequest;

@ManagedBean
@RequestScoped
public class RequestHeader extends LinkedHashMap<String, List<String>> {
    private List<String> keys;

    @PostConstruct
    public void init() {
        final HttpServletRequest request = (HttpServletRequest) FacesContext.getCurrentInstance().getExternalContext().getRequest();
        keys = Collections.list(request.getHeaderNames());
        for (final String key : keys) {
            final List<String> value = Collections.list(request.getHeaders(key));
            final List<String> oldValue = get(key);
            if (oldValue == null) {
                put(key, value);
            } else {
                oldValue.addAll(value);
            }
        }
    }

    public List<String> keys() {
        return keys;
    }
} 
```

这是我的 JSF 页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <title>HTTP request headers</title>
    </h:head>
    <h:body>
        <h:dataTable value="#{requestHeader.keys()}" var="k" border="1">
            <f:facet name="header">HTTP request headers</f:facet>
            <h:column>
                <f:facet name="header">Key</f:facet>
                <h:outputText value="#{k}" />
            </h:column>
            <h:column>
                <f:facet name="header">Value</f:facet>
                <!-- This forEach seems to be ignored. -->
                <c:forEach items="#{requestHeader[k]}" var="v">
                    <h:outputText value="#{v}" /><br />
                </c:forEach>
            </h:column>
        </h:dataTable>
    </h:body>
</html> 
```

单元格不是在表的第二列中包含值，而是为空：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>HTTP request headers</title>
    </head>
    <body>
        <table border="1">
            <thead>
                <tr><th colspan="2" scope="colgroup">HTTP request headers</th></tr>
                <tr>
                    <th scope="col">Key</th>
                    <th scope="col">Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>user-agent</td>
                    <td></td>
                </tr>
                <tr>
                    <td>host</td>
                    <td></td>
                </tr>
                <tr>
                    <td>accept</td>
                    <td></td>
                </tr>
                <tr>
                    <td>accept-language</td>
                    <td></td>
                </tr>
                <tr>
                    <td>accept-encoding</td>
                    <td></td>
                </tr>
                <tr>
                    <td>cache-control</td>
                    <td></td>
                </tr>
                <tr>
                    <td>connection</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </body>
</html> 
```

我做了几个测试。`<h:outputText value="#{requestHeader[k]}" />`并且`c:forEach`在其他列表上将起作用。

为什么它不能以这种方式工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T12:57:33.110

像 JSTL 标签这样的标签处理程序在视图构建时运行，而像 JSF`<h:xxx>`标签这样的 UI 组件在视图渲染时运行。因此它们不会像您对编码所期望的那样同步运行。在您的代码中，在`<c:forEach>`运行时，`<h:dataTable>`根本没有运行，因此它的`var`属性没有设置，因此`#{k}`在运行时不可用`<c:forEach>`，因此它检索一个空/不存在的集合。

如果您想在另一个 UI 组件中进行嵌套迭代，则需要一个 UI 组件。其中之一是 Facelets `<ui:repeat>`。

```
<ui:repeat value="#{requestHeader[k]}" var="v">
    <h:outputText value="#{v}" /><br />
</ui:repeat> 
```

如果您仍在使用 JSF 1.x，请改用 Tomahawk `<t:dataList>`，或者干脆使用另一个`<h:dataTable>`.

### 也可以看看：

*   [JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)
*   [JSTL c:if 在 JSF h:dataTable 中不起作用](https://stackoverflow.com/questions/3442380/jstl-cif-doesnt-work-inside-a-jsf-hdatatable)

* * *

**与具体问题无关**：您根本不需要支持 bean。所有请求标头都已*作为*隐`Map`式 EL 对象可用`#{header}`。

总而言之，您的方法可以简化如下，*无需*任何支持 bean：

```
<h:dataTable value="#{header.keySet().toArray()}" var="headerName" border="1">
    <f:facet name="header">HTTP request headers</f:facet>
    <h:column>
        <f:facet name="header">Name</f:facet>
        <h:outputText value="#{headerName}" />
    </h:column>
    <h:column>
        <f:facet name="header">Value</f:facet>
        <ui:repeat value="#{header[headerName]}" var="headerValue">
            <h:outputText value="#{headerValue}" /><br />
        </ui:repeat>
    </h:column>
</h:dataTable> 
```

### 也可以看看：

*   [隐式 EL 对象](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ImplicitELObjects)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T03:33:54.700

Try to use **ui:repeat** tag instead of c:forEach.See this [link](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense) for why ui:repeat use instead of c:forEach.

# android - 为 SQLite 设置 AsyncTask 进度 - 无法获得进度百分比

> ID：12030131
> 
> 赞同：0
> 
> 时间：2012-08-19T21:22:38.623
> 
> 标签：android, sqlite, android-asynctask

我为我的应用程序创建了一个启动屏幕，以隐藏将大量记录定期插入（在发布更新之后）到我的应用程序 SQLite 数据库的不同表中。我一直在实现一个 AsyncTask 来处理 UI 线程的插入。

我需要创建一个 ProgressDialog（带有进度条，而不是简单的旋转轮）来通知用户插入操作的当前进度百分比。

在大多数设置对话框进度条的示例中，代表冗长操作的 for 循环的计数器变量或文件下载的百分比用于设置对话框的此进度。但是，由于插入不同的表可能需要不同的时间（取决于列数等），这种方法似乎失败了。我能看到的最接近的解决方案是在我的 doInBackground() 方法中的每个记录插入之后编写一个 publishProgress(some_percentage) 行，使用插入的记录的百分比作为 publishProgress() 的参数，但这看起来非常不优雅和低效实践。

我的 AsyncTask 实现的当前代码如下。对于确定当前进度百分比的最佳实践的任何建议将不胜感激。谢谢！

```
private class InsertionAction extends AsyncTask<Void,Integer,Void> {

    Context context;
    private ProgressDialog dialog;

    private ForwardAction(Context context) {
        this.context = context;
        dialog = new ProgressDialog(context);

    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();

        this.dialog.setMessage("Initializing Database. Please Wait...");
        this.dialog.show();
        this.dialog.getWindow().setGravity(Gravity.BOTTOM);
        this.dialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        this.dialog.setCancelable(false);
    }

    @Override
    protected Void doInBackground(Void... params) {

            // Large block of record insertions

        return null;
    }

    @Override
    protected void onPostExecute(Void aVoid) {
        super.onPostExecute(aVoid);

        // Forward to the main activity
        if (dialog.isShowing()) {
            dialog.dismiss();
        }

        animatedTransition(SPLASH_DISPLAY_TIME/2);
    }

    @Override
    protected void onProgressUpdate(Integer... values) {
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:44:29.143

不幸的是，没有办法以编程方式计算您的代码行数，计算它们需要执行多少时间并生成与时间成比例的准确进度。

我建议在一定的行间隔后更新进度条，例如每 90 次插入 (10%)。

或者根据你正在做的事情更新并修改进度信息（尽量有创意），例如“添加用户”、“生成死亡射线”、“创造宇宙”、“再长一点”等。

# mysql - 删除部分字符串的 SQL 语句

> ID：12030143
> 
> 赞同：20
> 
> 时间：2012-08-19T21:24:29.450
> 
> 标签：mysql, sql

> **可能重复：**
> [SQL UPDATE 中的 str_replace？](https://stackoverflow.com/questions/3944000/str-replace-in-sql-update)
> [如何在mysql中删除部分字符串？](https://stackoverflow.com/questions/7481361/how-to-remove-part-of-string-in-mysql)
> [SQL查找和替换字符串的一部分](https://stackoverflow.com/questions/10153852/sql-find-replace-part-of-a-string)

我有一个包含网站 url 列表的数据库表，例如`http://website.com/`，我想从它们中删除所有`http://`和`https://`。他们是我可以在列上运行以删除它的简单 SQL 语句吗？

我已经四处搜索，但找不到我需要的东西。我假设我需要同时使用 REPLACE 和 UPDATE 但我很挣扎。

到目前为止，我有：

```
UPDATE list
SET    website
WHERE  website LIKE 'http://%'; 
```

那是对的吗？我正在使用 MySQL，表是列表，列是网站，我想删除`http://`这样的 url，例如：`http://website.com/`变成：`website.com`

**编辑：是否也可以删除尾部斜杠？**

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-08-19T21:31:49.100

看看`REPLACE`功能。您需要使用它两次才能同时删除 http 和 https。

```
UPDATE    list
SET       website = REPLACE(REPLACE(website, 'https://', ''), 'http://', '')
WHERE     website like 'https://%' 
  OR      website like 'http://%' 
```

要处理尾部斜杠，您可以使用`RIGHT`、`LEFT`和`LENGTH`函数。

```
UPDATE    list
SET       website = LEFT(website, LENGTH(website) - 1)
WHERE     RIGHT(website, 1) = '/' 
```

以下是一些您可能会觉得有用的文档： [MySQL 字符串函数](http://w3resource.com/mysql/string-functions/mysql-ascii-function.php)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-19T21:28:17.453

如果字符串存在，为什么不直接替换它：

```
UPDATE list
SET    website = Replace(website, 'http://', '') 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-19T21:29:11.810

```
update TABLE_NAME set FIELD_NAME = replace(FIELD_NAME, ‘find this string’, ‘replace found string with this string’) where CONDITION 
```

# css - 在 PNG 上为 webkit 蒙版使用颜色

> ID：12030150
> 
> 赞同：2
> 
> 时间：2012-08-19T21:25:53.627
> 
> 标签：css, google-chrome-extension, css-mask

我知道如何通过使用图像来做到这一点，但它需要动态变化。使用颜色代替图像有什么技巧吗？似乎很少有关于使用 webkit 掩码的文档。

我在可以离线使用的 Chrome 扩展程序中使用它（即我不能为此使用 PHP）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T15:05:28.073

您可以使用带有彩色背景的伪元素，如[http://www.impressivewebs.com/image-tint-blend-css/中的示例](http://www.impressivewebs.com/image-tint-blend-css/)

HTML

```
<figure class="tint">
  <img src="image.jpg" alt="Example" width="400" height="260">
</figure> 
```

CSS

```
.tint {
    position: relative;
    float: left;
    cursor: pointer;
}

.tint:before {
    content: "";
    display: block;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0,255,255, 0.5);
    -moz-transition: background .3s linear;
    -webkit-transition: background .3s linear;
    -ms-transition: background .3s linear;
    -o-transition: background .3s linear;
    transition: background .3s linear;
}

.tint:hover:before {
    background: none;
} 
```

# php - Ajax PHP 上传

> ID：12030151
> 
> 赞同：-6
> 
> 时间：2012-08-19T21:26:18.710
> 
> 标签：php, ajax, file-upload

> **可能重复：**
> [如何使用 jQuery 异步上传文件？](https://stackoverflow.com/questions/166221/how-can-i-upload-files-asynchronously-with-jquery)

我需要用ajax上传文件。
有什么方法可以使用 ajax 发送文件，但不能通过 flash 发送。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:34:31.620

除了 IE，任何现代浏览器都可以。

基本上，您需要获取 Javascript 来加载文件（请参见[此处](http://www.html5rocks.com/en/tutorials/file/dndfiles/)）。然后，您可以使用该数据通过 AJAX 发布它。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-19T21:26:59.067

无法使用 AJAX 发送文件。

# javascript - 现代网络爬虫是使用点击事件还是直接导航到锚标签上的 href？

> ID：12030155
> 
> 赞同：10
> 
> 时间：2012-08-19T21:26:50.523
> 
> 标签：javascript, html, seo, web-crawler

我正在构建一个网站，我想对用户表现得像花哨一样，但希望网络爬虫仍然能够正确导航。

我有以下锚标签：

```
<a class="overrideClick" href="/projects">Projects</a> 
```

使用以下 jQuery：

```
$(document).on('click', '.overrideClick', function(e) { 
    e.preventDefault(); 
    ( ... ) 
}); 
```

这会杀死 SEO 还是我可以期待 Google/Bing/etc 像我希望的那样行事并遵循 /projects？我假设他们在历史上只使用过 href 值，但我知道谷歌现在正在评估一些 JavaScript。

我知道我可以不包含爬虫客户端的 js，但知道会很有趣。对于科学...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-19T21:34:13.540

我相当肯定，在你的 href 中有一个 URL 并在脚本中覆盖行为是正确的做法。这样，如果机器人无法执行 JS，它们仍然会导航到您的页面。如果可以，他们会看到您加载的任何新内容（假设您正在加载与基本链接 href 和链接文本相关的内容）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T21:47:12.763

我认为[这个](http://www.seomoz.org/ugc/new-reality-google-follows-links-in-javascript-4930)链接对你有用。谷歌似乎确实将 Javascript 超链接考虑在内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T16:07:43.153

“使用诸如 Lynx 之类的文本浏览器来检查您的网站，因为大多数搜索引擎蜘蛛看到您的网站的方式与 Lynx 一样。如果 JavaScript、cookie、会话 ID、框架、DHTML 或 Flash 等花哨的功能让您看不到所有您的网站在文本浏览器中，那么搜索引擎蜘蛛可能无法抓取您的网站。”

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=35769](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=35769)

我见过的所有这些都只分析标记以确定引用，因为它们通常会取出这些地址并将它们传递给其他分布式代理进行处理。我知道现在很少有人会看 javascript，但如果你只在所有这些中包含 href，你就会得到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-14T18:25:45.510

似乎 Google bot 不喜欢`e.preventDefault()`.

我有一个在 jQuery UI 对话框中打开一些锚点的页面。这个锚点或锚点后面的内容永远不会被索引，所以我认为 Google bot 会停止`e.preventDefault()`。

有人知道如何解决这个问题吗？如果 return false 会这样做，我会尝试。

# jsp - 如何在 Struts 1.0.2 中模拟 JSTL 核心集 (c:set)

> ID：12030160
> 
> 赞同：0
> 
> 时间：2012-08-19T21:28:41.163
> 
> 标签：jsp, jstl, struts-1

是的，这是正确的。旧版应用程序维护。

我如何模仿`<c:set var='myvar' scope='requqst' value='val' />`老式的 Struts 1.0.2？

假设我无法将 JSTL 添加到应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:32:23.627

你可以在完全不接触 Struts 的情况下使用 scriptlet 来做到这一点——考虑这是**最后的手段**：

```
<%
    request.setAttribute("myvar", "val");
%> 
```

我不确定 Struts 1.0.2（[应该没*问题*](http://struts.apache.org/1.0.2/api/org/apache/struts/taglib/bean/DefineTag.html)），但我知道在 v1.3.8 中，这也可以：

```
<bean:define id="myvar" type="java.lang.String" value="val"/> 
```

请注意，[允许`type`的 s 非常有限](https://stackoverflow.com/questions/2911476/how-to-define-an-integer-bean-in-struts-1-x)。

# ios - 对于 jpeg 和 png 文件，如何使我的应用程序出现在 Apple Mail 的“打开方式”对话框中？

> ID：12030168
> 
> 赞同：2
> 
> 时间：2012-08-19T21:30:16.317
> 
> 标签：ios, png, jpeg

我正在开发一个从电子邮件导入文件的程序。我可以通过将 UTI 正确写入我的 p-info 列表来导入大多数扩展，但我找不到有关如何使我的应用程序出现在 jpeg 和 png 文件的 Apple Mail 应用程序的“打开方式”对话框中的可行信息。此外，虽然 .pages 文件可以从电子邮件中导入，但我的应用程序不会出现在 Pages 应用程序的“打开方式”或“共享”对话框中。

任何建议将不胜感激。

一个类似的问题[https://stackoverflow.com/questions/7736812/how-to-register-the-app-to-open-the-jpeg-png-and-gif-image-file-in-my-app-in](https://stackoverflow.com/questions/7736812/how-to-register-the-app-to-open-the-jpeg-png-and-gif-image-file-in-my-app-in-i) -我去年被问到但没有回答[。](https://stackoverflow.com/questions/7736812/how-to-register-the-app-to-open-the-jpeg-png-and-gif-image-file-in-my-app-in-i)

# android - Facebook Connect 上传到 google play 后停止工作

> ID：12030174
> 
> 赞同：2
> 
> 时间：2012-08-19T21:31:17.530
> 
> 标签：android, facebook, google-play

我正在尝试在我的应用程序上使用 FB Connect，并且在模拟器中一切正常并在 Galaxy Nexus 中进行调试，但在将其上传到谷歌播放后它停止工作。

如果我安装从 Play 下载的应用程序，我的 facebook.authorize 函数会返回一个 DialogError（我只是不知道是什么错误，因为我只能在使用 eclipse 进行安装时查看 logcat）。只有当我安装了 facebook 应用程序时才会发生这种情况。因此，当我卸载 fb 应用程序时，它运行良好...

也许是我在计算机上准备 facebook SDK 时所做的一些错误配置？我在下面粘贴了所有代码，但没有任何日志...

```
public class FacebookConnectActivity extends Activity {
private static final String TAG_JSON = "json";
static Facebook facebook = new Facebook("11111111111111");
AsyncFacebookRunner mAsyncRunner;
private static SharedPreferences mPrefs;
JSONObject json = null;
Context ctx = this;
boolean callback = false;
private static Context staticContext;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.resgatar_produto_layout);
    FacebookConnectActivity.staticContext = getApplicationContext();
    Log.e("FacebookConnect", "Activity Started");

    mPrefs = getSharedPreferences("PREFS_LOGIN", MODE_PRIVATE);
    String access_token = mPrefs.getString("access_token", null);
    long expires = mPrefs.getLong("access_expires", 0);
    if (access_token != null) {
        facebook.setAccessToken(access_token);
        Log.e("FacebookConnect",
                "Access Token retrieved from SharedPreferences");
    }
    if (expires != 0) {
        facebook.setAccessExpires(expires);
        Log.e("FacebookConnect",
                "Access Expires retrieved from SharedPreferences");
    }

    if (!facebook.isSessionValid()) {
        facebook.authorize(this, new String[] { "email", "user_photos",
                "user_birthday", "user_hometown", "user_relationships",
                "user_location", "user_work_history", "publish_actions" },
                new DialogListener() {
                    @Override
                    public void onComplete(Bundle values) {
                        Log.e("FacebookConnect", "User authorized");
                        Log.e("FacebookConnect",
                                "onComplete called at facebook.authorize");
                        Log.e("FacebookConnect", "Access Token: "
                                + facebook.getAccessToken().toString());
                        try {
                            mAsyncRunner = new AsyncFacebookRunner(facebook);
                            mAsyncRunner.request("me",
                                    new SampleRequestListener());
                            Log.e("FacebookConnect",
                                    "AsyncFacebookRunner request started (facebook.authorize.onComplete)");
                            Bundle params = new Bundle();
                            params.putString("link",
                                    "https://apps.facebook.com/qranio_game/");
                            params.putString("picture", "http://www.qranio.com/site/images/logo_qranio_facebook.png");
                            int count = 0;
                            while (json == null && count<20){
                                Log.e("FacebookConnect",
                                        "Waiting for json (facebook.authorize.onComplete)");
                                waiting(1000);
                                count++;
                            }
                            if (!(count<20)){
                                noConnectionAlert();
                            }
                            String usuario = json.getString("first_name");
                            params.putString("name", usuario+" está jogando Qranio para Android");
                            params.putString("caption", "Qranio - Making Learning Fun");
                            params.putString("description", "O Qranio é uma plataforma online que propicia o Saber. Você joga, " +
                                    "aprende, acumula Qi$ e troca por prêmios incríveis! Venha jogar também!");
                            //JSONArray fbArr = new JSONArray("{\"name\":\"Jogar\",\"link\":\"https://apps.facebook.com/qranio_game/\"}");
                            params.putString("actions", "{\"name\":\"Jogar\",\"link\":\"https://apps.facebook.com/qranio_game/\"}");
                            params.putString("display", "touch");
                            facebook.dialog(ctx, "feed", params,
                                    new SampleDialogListener());
                            Log.e("FacebookConnect",
                                    "Post on Wall Dialog called (facebook.authorize.onComplete)");

                            // facebook.
                            // if (facebook.isSessionValid()){

                            // }else{
                            // Log.e("FacebookConnect",
                            // "Invalid facebook session while trying to fetch user data");
                            // }

                        } catch (FacebookError fbe) {
                            Log.e("FacebookConnect",
                                    "facebook.authorize FacebookError "
                                            + fbe.toString());

                        } catch (Exception e) {
                            Log.e("FacebookConnect",
                                    "facebook.authorize Exception "
                                            + e.toString());
                        }
                    }

                    @Override
                    public void onFacebookError(FacebookError error) {
                        Log.e("FacebookConnect",
                                "FacebookError authorizing: "
                                        + error.toString());
                        final AlertDialog alertDialog = new AlertDialog.Builder(
                                FacebookConnectActivity.this).create();
                        alertDialog.setTitle("Erro");
                        alertDialog
                                .setMessage("Ocorreu um erro com o Facebook, por favor tente novamente.");
                        alertDialog.setButton("OK",
                                new DialogInterface.OnClickListener() {
                                    public void onClick(
                                            DialogInterface dialog,
                                            int which) {
                                        alertDialog.dismiss();
                                        finish();
                                    }
                                });
                        alertDialog.show();
                    }

                    @Override
                    public void onError(DialogError e) {
//Here is where I'm getting the error when downloaded from Play
                        Log.e("FacebookConnect",
                                "Error authorizing: " + e.toString());
                        final AlertDialog alertDialog = new AlertDialog.Builder(
                                FacebookConnectActivity.this).create();
                        alertDialog.setTitle("Erro");
                        alertDialog
                                .setMessage("Erro ao tentar conectar com o facebook, tente novamente.");
                        alertDialog.setButton("OK",
                                new DialogInterface.OnClickListener() {
                                    public void onClick(
                                            DialogInterface dialog,
                                            int which) {
                                        alertDialog.dismiss();
                                        finish();
                                    }
                                });
                        alertDialog.show();
                    }

                    @Override
                    public void onCancel() {
                        Log.e("FacebookConnect", "Autorizing canceled");
                        finish();
                    }
                });

    } else {
        mAsyncRunner = new AsyncFacebookRunner(facebook);
        mAsyncRunner.request("me", new SampleRequestListener());
        Log.e("FacebookConnect",
                "Valid session found, AsyncFacebookRunner request started");

        startDataProcess();
    }

}

public void noConnectionAlert(){
    final AlertDialog alertDialog = new AlertDialog.Builder(
            FacebookConnectActivity.this).create();
    alertDialog.setTitle("Erro");
    alertDialog
            .setMessage("Verifique sua conexão com a internet e tente novamente.");
    alertDialog.setButton("OK",
            new DialogInterface.OnClickListener() {
                public void onClick(
                        DialogInterface dialog,
                        int which) {
                    alertDialog.dismiss();
                    finish();
                }
            });
    alertDialog.show();
}

public static void waiting (int n){

    long t0, t1;

    t0 =  System.currentTimeMillis();

    do{
        t1 = System.currentTimeMillis();
    }
    while (t1 - t0 < n);
}

public static void logoutFB() {
    if (facebook.isSessionValid()) {
        Log.e("AndroidDashboarDesign",
                "Valid FB session found, logging out");
        AsyncFacebookRunner mAsyncRunner = new AsyncFacebookRunner(facebook);
        mAsyncRunner.logout(staticContext, new BaseRequestListener() {
            @Override
            public void onComplete(String response, Object state) {
                Log.e("AndroidDashboarDesign", "Complete FB logout");
            }

            @Override
            public void onIOException(IOException e, Object state) {
                Log.e("AndroidDashboarDesign",
                        "(logout) IOException: " + e.getMessage());
            }

            @Override
            public void onFileNotFoundException(FileNotFoundException e,
                    Object state) {
                Log.e("AndroidDashboarDesign",
                        "(logout) FileNotFoundException: " + e.getMessage());
            }

            @Override
            public void onMalformedURLException(MalformedURLException e,
                    Object state) {
                Log.e("AndroidDashboarDesign",
                        "(logout) MalFormedURLException: " + e.getMessage());
            }

            @Override
            public void onFacebookError(FacebookError e, Object state) {
                Log.e("AndroidDashboarDesign", "(logout) FacebookError: "
                        + e.getMessage());
            }
        });
    }
}

public void startDataProcess() {
    int count = 0;
    while (json == null && count<20){
        Log.e("FacebookConnect",
                "Waiting for json (Valid session found)");
        waiting(1000);
        count++;
    }
    if (!(count<20)){
        noConnectionAlert();

    }else{
    SharedPreferences.Editor editor = mPrefs.edit();
    editor.putString("access_token", facebook.getAccessToken());
    editor.putLong("access_expires", facebook.getAccessExpires());
    editor.commit();

    Log.e("FacebookConnect", "startDataProcess() executed");
    Intent a = new Intent(FacebookConnectActivity.this,
            FacebookDataProcess.class);
    a.putExtra(TAG_JSON, json.toString());
    startActivity(a);
    finish();
    }
}

public class SampleDialogListener extends BaseDialogListener {

    public void onComplete(Bundle values) {
        Log.e("FacebookConnect", "SampleDialogListener complete");
        final String postId = values.getString("post_id");
        if (postId != null) {
            Log.e("FacebookConnect",
                    "(SampleDialogListener) Dialog Success! post_id="
                            + postId);
            //mAsyncRunner.request(postId, new WallPostRequestListener());
            //Log.e("FacebookConnect", "WallPostRequestListener started");
            Toast.makeText(FacebookConnectActivity.this, "Mensagem postada com sucesso!", Toast.LENGTH_LONG).show();
            startDataProcess();
        } else {
            Log.e("FacebookConnect",
                    "(SampleDialogListener) No wall post made, maybe canceled by user."); // Usuario
                                                                                            // clicou
                                                                                            // em
                                                                                            // Cancelar
            startDataProcess();
        }
    }

    public void onError(DialogError e) {
        Log.e("FacebookConnect",
                "Error authorizing: " + e.toString());
        final AlertDialog alertDialog = new AlertDialog.Builder(
                FacebookConnectActivity.this).create();
        alertDialog.setTitle("Erro");
        alertDialog
                .setMessage("Erro ao tentar conectar com o facebook, não foi possível publicar em seu mural.");
        alertDialog.setButton("OK",
                new DialogInterface.OnClickListener() {
                    public void onClick(
                            DialogInterface dialog,
                            int which) {
                        startDataProcess();
                        alertDialog.dismiss();
                    }
                });
        alertDialog.show();
    }

    public void onCancel() { // Usuario clicou no X do dialog
        Log.e("FacebookConnect", "Post to Wall Canceled with \"X\" button");
        startDataProcess();
    }
}

public class WallPostRequestListener extends BaseRequestListener {

    public void onComplete(final String response, final Object state) {
        Log.e("FacebookConnect", "WallPostRequestListener complete");
        Log.e("FacebookConnect", "(WallPostRequestListener) Got response: "
                + response);
        String message = "<empty>";
        try {
            JSONObject json = Util.parseJson(response);
            message = json.getString("message");
        } catch (JSONException e) {
            Log.e("FacebookConnect",
                    "(WallPostRequestListener) JSON Error in response: "
                            + e.toString());
        } catch (FacebookError e) {
            Log.e("FacebookConnect",
                    "(WallPostRequestListener) Facebook Error: "
                            + e.getMessage());
            // Toast.makeText(ctx, "Erro ao postar no Facebook.",
            // Toast.LENGTH_LONG).show();
        }
        startDataProcess();
    }
}

public class SampleRequestListener extends BaseRequestListener {

    public void onComplete(final String response, final Object state) {
        try {

            // process the response here: executed in background thread
            Log.e("FacebookConnect", "SampleRequestListener complete");
            Log.e("SampleRequestListener",
                    "Response: " + response.toString());
            json = Util.parseJson(response);
            Log.e("FacebookConnect", "JSON: " + json.toString());

            // postOnWall();
            // startDataProcess();

            // then post the processed result back to the UI thread
            // if we do not do this, an runtime exception will be generated
            // e.g. "CalledFromWrongThreadException: Only the original
            // thread that created a view hierarchy can touch its views."

        } catch (JSONException e) {
            Log.e("FacebookConnect",
                    "JSON Error in response (SampleRequestListener): "
                            + e.getMessage());
        } catch (FacebookError e) {
            Log.e("FacebookConnect",
                    "Facebook Error at SampleRequestListener: "
                            + e.getMessage());
        }

    }
}

public void postOnWall() {
    Looper.prepare();
    Bundle params = new Bundle();
    params.putString("link", "www.qranio.com");
    facebook.dialog(ctx, "feed", params, new SampleDialogListener());
    Log.e("FacebookConnect", "SampleDialogListener started");
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    facebook.authorizeCallback(requestCode, resultCode, data);
    callback = true;
    Log.e("FacebookConnect",
            "Authentication authorizeCallback called (onActivityResult)");

}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T18:54:54.327

当您签署应用程序以进行分发时，您使用了不同的密钥库文件。

要解决此问题，请运行相同的命令，但将密钥库的别名和位置更改为您用于分发的密钥库文件

`keytool -exportcert -alias YOUR_ALIAS_HERE -keystore ~/path/to/yourapp.keystore | openssl sha1 -binary | openssl base64`

并将生成的字符串粘贴到您的 Facebook 应用程序的仪表板设置中的 Android Key Hash 部分下。

# rdp - 使用提供的 IP 启动 RDP (mstsc.exe) 而不自动连接

> ID：12030177
> 
> 赞同：-1
> 
> 时间：2012-08-19T21:32:15.757
> 
> 标签：rdp, mstsc

我正在创建一个程序（在 C#，.net 4 中），它允许用户从文本框中突出显示 IP 地址，然后单击一个按钮，该按钮启动带有突出显示的 IP 的 RDP（MSTSC.EXE）。我想做的不是让 RDP 尝试自动连接到 IP（如果您提供 -v: 参数，就会发生这种情况）。相反，打开通常的 RDP 对话框，允许用户编辑 IP 或单击“连接”继续连接。

这可能吗？似乎没有任何命令行开关阻止自动连接。我唯一能想到的就是使用 IP 创建一个 .RDP 文件，然后使用 -edit 开关。虽然我想知道是否可以启动 mstsc.exe 然后做某种剪贴板粘贴来将 IP 粘贴到 mstsc.exe 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T21:45:52.260

改写我的问题后找到了答案。

SendKeys.SendWait("^V") 成功了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T21:46:09.157

[为避免重新连接，请参阅此链接](http://support.microsoft.com/kb/323258)

其余使用

```
using System;
using System.Diagnostics;
using System.ComponentModel;

namespace MyProcessSample
{
    class MyProcess
    {

        static void Main()
        {
            // Get the path that stores favorite links.
           Process.Start("mstsc.exe", "/v:10.58.45.24"); //Or whatever 

        }
    }
} 
```

# python - 用python发送电子邮件问题？

> ID：12030179
> 
> 赞同：5
> 
> 时间：2012-08-19T21:32:17.357
> 
> 标签：python, smtp

我正在尝试在 python 中制作电子邮件脚本。这是我所拥有的（来自 pythonlibrary.org）：

```
#! /usr/bin/env python

import smtplib
import string

SUBJECT = "An email!"
TO = "me@icloud.com"
FROM = "me@gmail.com"
text = "This text is the contents of an email!"
BODY = string.join((
        "From: %s" % FROM,
        "To: %s" % TO,
        "Subject: %s" % SUBJECT ,
        "",
        text
        ), "\r\n")
server = smtplib.SMTP('smtp.gmail.com')
server.login('me@gmail.com', 'mypassword') # Not very secure, I know, but this email is dedicated to this script
server.sendmail(FROM, [TO], BODY)
server.quit() 
```

我得到`smtplib.SMTPException: SMTP AUTH extension not supported by server.`是这样的，那么为什么 smtp.gmail.com 完全响应？这是 Gmail 的问题，还是我的脚本或其他问题？

错误信息：

```
Traceback (most recent call last):
  File "/Users/student/Desktop/mail.py", line 18, in <module>
    server.login('*******@gmail.com', '**************')
  File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/smtplib.py", line 552, in login
smtplib.SMTPException: SMTP AUTH extension not supported by server. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-19T21:35:46.383

您需要在提交端口（587）上联系gmail邮件服务器，而不是默认的25：

```
server = smtplib.SMTP('smtp.gmail.com', 587) 
```

您还需要`server.starttls()`在登录前使用（这样您的密码就不会被明文发送！）。这是来自我拥有的脚本，它适用于我：

```
server = smtplib.SMTP()
server.connect("smtp.gmail.com", "submission")
server.starttls()
server.ehlo()
server.login(user, password) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-19T22:07:52.130

以下是在 Python 中使用 gmail 发送电子邮件的方法：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
from email.header    import Header
from email.mime.text import MIMEText
from getpass         import getpass
from smtplib         import SMTP_SSL

login, password = 'user@gmail.com', getpass('Gmail password:')

# create message
msg = MIMEText('message body…', _charset='utf-8')
msg['Subject'] = Header('subject…', 'utf-8')
msg['From'] = login
msg['To'] = login

# send it via gmail
s = SMTP_SSL('smtp.gmail.com', 465, timeout=10)
s.set_debuglevel(1)
try:
    s.login(login, password)
    s.sendmail(msg['From'], msg['To'], msg.as_string())
finally:
    s.quit() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-19T21:51:03.287

我发现在通过 gmail 发送邮件之前，我必须执行 ehlo() 和 starttls() ：

```
server = smtplib.SMTP('smtp.gmail.com', 587)
server.ehlo()
server.starttls()
server.ehlo()
server.login(SERVER_EMAIL,EMAIL_HOST_PASSWORD) 
```

它不应该对登录产生影响，但我使用来自 email.mime.multipart 的 MIMEMultipart 作为正文，例如：

```
msg = MIMEMultipart('alternative')
msg['Subject'] = subject
msg['From'] = mFrom
msg['To'] = mTo
if textBody:
   part1 = MIMEText(textBody, 'plain')
   msg.attach(part1)
if htmlBody:
   part2 = MIMEText(htmlBody, 'html')
   msg.attach(part2)
BODY = msg.as_string() 
```

# ruby-on-rails - Rails 单表继承中模型之间的关系

> ID：12030183
> 
> 赞同：0
> 
> 时间：2012-08-19T21:32:42.620
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我一直在使用 Rails 中的 STI，并且有一个关于将记录与特定模型相关联的问题。

假设我有一个具有以下架构的产品模型：

```
#  id         :integer          not null, primary key
#  url_name   :string(255)      not null
#  cover_img  :string(255)
#  created_at :datetime         not null
#  updated_at :datetime         not null 
```

从这个产品模型中，我创建了 2 个继承模型：

福：

```
class Foo < Product

end 
```

酒吧：

```
class Bar < Product

end 
```

假设我将一条记录保存到 Foo(A)，并将一条记录保存到 Bar(B)。当我调用 Product.all 时，我希望得到所有记录 A 和 B。但是，当我调用 Foo.all 或 Bar.all 时，我希望分别只检索 A 和 B，但是当我调用 Foo.all 时会发生什么或 Bar.all，我得到调用 Product.all 时得到的结果。如何配置这种关系以获得预期的结果？

我正在使用 rails 3.2.6 和 Ruby 1.9.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T21:53:41.677

您需要在您的产品表中添加一个“类型”列，以便 ActiveRecord 可以区分不同类型的实例。此列应具有字符串类型，例如：

```
create_table :products do |t|
  # your other columns
  t.string :type
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T21:43:20.627

答案在于您如何保存对象。您可能将它们保存为 Foo 或 Bar，而*不是*您应该保存的 Product。当我像你一样使用继承模型时，我通常只是为了继承公共方法来识别他们的数据。

因此，例如，我将有一个问题，以及两种不同类型的问题，例如语法和视觉，它们都将继承问题。但我会将对象保存为 QuestionsController 中的问题。

就像您应该使用 ProductsController 保存对象一样。

# export - Neo4j 从 java 导出 gml

> ID：12030184
> 
> 赞同：0
> 
> 时间：2012-08-19T21:33:12.567
> 
> 标签：export, neo4j, gml

我正在玩很多节点，我真的很喜欢 neo4j！但我不知道如何将嵌入的图形导出到 gml 或类似的标准图形文件以在第三方应用程序中可视化它。

你有我的示例代码吗？

提前致谢！约恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:47:14.713

您可以通过 REST 在[http://docs.neo4j.org/chunked/snapshot/gremlin-plugin.html#rest-api-load-a-sample-graph](http://docs.neo4j.org/chunked/snapshot/gremlin-plugin.html#rest-api-load-a-sample-graph)看到一个示例，在这种情况下导入 GML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:31:17.067

您应该查看 Gremlin 的 saveGML[方法](https://github.com/tinkerpop/gremlin/wiki/Gremlin-Methods)（一种图形遍历语言）

# python - 如何在 Django 中分别获取当前日期和当前时间？

> ID：12030187
> 
> 赞同：86
> 
> 时间：2012-08-19T21:33:51.560
> 
> 标签：python, django, django-models

我在使用这个类时遇到了一个有趣的情况：

```
class Company(models.Model):
    date = models.DateField()
    time = models.TimeField() 
```

```
c = Company(date=datetime.datetime.now(), time=datetime.datetime.now()) 
```

Django 决定使用`DATETIME_INPUT_FORMATS`在**formats.py**文件中定义。这是有道理的，因为我将 a 传递`datetime.now()`给这两个领域。

如果我只传入当前日期和当前时间，我想我可以让 Django 分别使用`DATE_INPUT_FORMATS`和。`TIME_INPUT_FORMATS`

像这样的东西：

```
c = Company(date=datetime.date.now(), time=datetime.time.now()) 
```

但这显然会引发异常，因为现在不存在这样的情况。有没有不同的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2012-08-19T21:40:18.983

对于日期，您可以使用`datetime.date.today()`或`datetime.datetime.now().date()`。

暂时，您可以使用`datetime.datetime.now().time()`.

* * *

但是，为什么首先要为这些设置单独的字段？为什么不使用单个`DateTimeField`？

`.date()`如果您只需要一个或另一个，您始终可以在模型上定义返回或`.time()`稍后的辅助函数。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2015-10-15T07:51:32.017

```
import datetime
datetime.datetime.now().strftime ("%Y%m%d")
20151015 
```

当时

```
from time import gmtime, strftime
showtime = strftime("%Y-%m-%d %H:%M:%S", gmtime())
print showtime
2015-10-15 07:49:18 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2018-01-15T14:00:44.107

```
import datetime

datetime.date.today()  # Returns 2018-01-15

datetime.datetime.now() # Returns 2018-01-15 09:00 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-09-08T04:19:56.730

```
 import datetime 
```

**当前日期和时间**

```
 print(datetime.datetime.now())
     #2019-09-08 09:12:12.473393 
```

**仅限当前日期**

```
 print(datetime.date.today())
     #2019-09-08 
```

**仅限当年**

```
 print(datetime.date.today().year)
     #2019 
```

**仅当月**

```
 print(datetime.date.today().month)
     #9 
```

**仅限当天**

```
 print(datetime.date.today().day)
     #8 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-12-11T09:16:31.640

A related info, to the question...

In django, use `timezone.now()` for the datetime field, as django supports [timezone](https://docs.djangoproject.com/en/3.1/topics/i18n/timezones/), it just returns datetime based on the `USE TZ` settings, or simply timezone 'aware' datetime objects

For a reference, I've got `TIME_ZONE = 'Asia/Kolkata'` and `USE_TZ = True`,

```
from django.utils import timezone
import datetime

print(timezone.now())  # The UTC time
print(timezone.localtime())  # timezone specified time, 
print(datetime.datetime.now())  # default local time

# output
2020-12-11 09:13:32.430605+00:00
2020-12-11 14:43:32.430605+05:30  # IST is UTC+5:30
2020-12-11 14:43:32.510659 
```

refer [timezone settings](https://docs.djangoproject.com/en/3.1/ref/settings/#time-zone) and [Internationalization and localization](https://docs.djangoproject.com/en/3.1/topics/i18n/) in django docs for more details.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-10-29T14:49:05.543

以毫秒为单位获取日期时间 UTC 的另一种方法。

```
from datetime import datetime

datetime.utcnow().isoformat(sep='T', timespec='milliseconds') + 'Z'

2020-10-29T14:46:37.655Z 
```

# java-me - 在 J2ME 应用程序中使用 vserv，没有显示广告

> ID：12030194
> 
> 赞同：0
> 
> 时间：2012-08-19T21:34:36.347
> 
> 标签：java-me, ads, in-app

我正在尝试在我的 J2ME 应用程序（横幅广告之一）中使用 Vserv 广告网络，但直到现在我无法接收任何广告，我没有收到任何异常，我只是注意到 vservAdFailed() 方法总是被执行首先，调试结果是：

**广告失败 o=vInAppAdEngine.VservAd@e5125d64**

这是必须有广告的屏幕，我把所有的代码都放在里面。什么不见​​了？！

```
 public class Vserv extends Screen implements  VservAdListener{

private VservManager vservManager;
private VservAd vservAd;
public Vserv(byte screenName,AppMidletBuilder app,AppData appData,Operation operation  ){
    super(screenName,app,appData.getLocalizationUtil(),appData.getImageUtil(),appData,operation);
    //This is required only once in your application life cycle
    Hashtable vservConfigTable=new Hashtable();
    vservConfigTable.put("appId","My app Id");
    vservManager=new VservManager(app,vservConfigTable);

} 

protected void initScreen() {

   //This is required for requesting new ad
    vservAd=new VservAd(Vserv.this);
    vservAd.requestAd();
}

protected void screenDefinition() {

}

public void vservAdReceived(Object obj) {

     System.out.println("Ad Recieved");
         if(((VservAd)obj).getAdType().equals(VservAd.AD_TYPE_IMAGE))
    {
    //Use retrived image ad for rendering
    Image imageAd=(Image)((VservAd)obj).getAd();
    } else if(((VservAd)obj).getAdType().equals(VservAd.AD_TYPE_TEXT))
    {
    //Use retrieved text ad for rendering
    String textAd=(String)((VservAd)obj).getAd();
}
}

public void vservAdFailed(Object o) {

     System.out.println("Ad Failed o="+o);
}

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-08T19:02:37.227

您应该有一个按钮来处理呈现的图像（图像广告）。就像是

```
imageItem = new ImageItem("", imageAd, ImageItem.LAYOUT_DEFAULT, "", Item.BUTTON); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T10:34:37.883

你换过`My app Id`这里吗

```
vservConfigTable.put("appId","My app Id"); 
```

`vservAdFailed()`当您的请求没有可用的广告时，也会执行该方法。

# python - CherryPy 重定向到根目录

> ID：12030195
> 
> 赞同：7
> 
> 时间：2012-08-19T21:34:41.730
> 
> 标签：python, redirect, cherrypy

快速提问：我使用 CherryPy 创建了一个 Web 服务器。它需要对所有页面进行身份验证，因此我的默认处理程序返回登录页面对象。由于 CherryPy 处理调度的方式，有人要求：

```
localhost:80/a/b/c 
```

将被重定向到：

```
localhost:80/a/b/login 
```

但是，我希望从根级别调用所有未经身份验证的请求，独立于 HTML 请求中添加的潜在附加参数，例如：

```
localhost:80/a/b/c --> localhost:80/login 
```

目前我正在通过返回一个基于 HTML 的重定向来解决这个问题：

```
'<meta http-equiv="REFRESH" content="0;url=/login">' 
```

我觉得这是一个非常不干净的解决方案，宁愿使用基于 CherryPy 的解决方案。我查看了cherrypy.HTTPRedirect 和cherrypy.url，但我还没有找到让它们解决这个问题的方法。

有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-19T23:08:34.260

您可以使用重定向指定登录页面：`raise cherrypy.HTTPRedirect("/auth/login")`

但是，看看这里，有一个如何编写身份验证例程的示例：

[http://tools.cherrypy.org/wiki/AuthenticationAndAccessRestrictions](http://tools.cherrypy.org/wiki/AuthenticationAndAccessRestrictions)

还有一个示例说明如何在登录后将用户重定向回请求的页面。

# c# - 使用列表项或变量作为数据绑定的来源

> ID：12030196
> 
> 赞同：1
> 
> 时间：2012-08-19T21:35:05.683
> 
> 标签：c#, windows-phone-7, data-binding

我有一个关于使用 c# 代码在 WP7 中进行数据绑定的问题。

如果我有自定义课程，一切都很清楚。我将 Source 属性设置为我的类实例，将 Path 属性设置为该类中的一个属性。像这样（并且有效）

```
Binding binding = new Binding()
{
  Source = myclass,
  Path = new PropertyPath("myproperty"),
  Mode = BindingMode.TwoWay
};
myButton.SetBinding(dp, binding); 
```

现在，我如何绑定简单的结构，例如布尔变量或 List<> 中的单个项目？如果我要写`Source = myBoolean`或者`Source = List[5]`我应该在 Path 属性中写什么？（请注意，我需要 TwoWay 绑定，因此必须设置 Path 属性）

**最终解决方案：**

要绑定一个变量，这个变量应该是一个公共属性，并且应该实现 INotifyPropertyChanged。为此，可以将 List 替换为 ObservableCollection。

其余的应该看起来像 nmaait 的答案，整个代码应该是这样的：

```
public partial class Main : PhoneApplicationPage, INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    private Boolean _myBoolean { get; set; }
    public Boolean myBoolean
    {
        get { return _myBoolean; }
        set { _myBoolean = value; OnPropertyChanged("myBoolean"); }
    }
    ObservableCollection<Int32> myList { get; set; }

    public Main()
    {
        InitializeComponent();

        this.Loaded += new RoutedEventHandler(Main_Loaded);
    }

    protected void OnPropertyChanged(String name)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(name));
    }

    void Main_Loaded(object sender, RoutedEventArgs e)
    {
        myBoolean = false;
        myList = new ObservableCollection<int>() { 100, 150, 200, 250 };

        Binding binding1 = new Binding()
        {
            Source = this,
            Path = new PropertyPath("myBoolean"),
            Mode = BindingMode.TwoWay
        };
        myButton.SetBinding(Button.IsEnabledProperty, binding1);

        Binding binding2 = new Binding()
        {
            Source = myList,
            Path = new PropertyPath("[1]"),
            Mode = BindingMode.TwoWay
        };

        myButton.SetBinding(Button.WidthProperty, binding2);
    }

    private void changeButton_Click(object sender, RoutedEventArgs e)
    {
        myList[1] +=50;
        myBoolean = !myBoolean;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:36:38.080

您的源是数据上下文，因此您不会真正将源设置为布尔值本身，而是将源设置为布尔值所属的类/元素，就像您已经完成的那样。路径将是 myBoolean 或 List[5]。

如果布尔值在当前类中，您可以执行

```
Binding binding = new Binding()
{
  Source = this,
  Path = new PropertyPath("myBoolean"),
  Mode = BindingMode.TwoWay
};
myButton.SetBinding(dp, binding); 
```

您到底想通过绑定到列表项来实现什么。如果您的列表发生更改，那么您不想绑定到特定索引，但您可以像这样绑定到所选项目。通过绑定到特定列表项，提供有关您需要实现的更多信息。

```
Binding binding = new Binding()
{
  Source = List,
  Path = new PropertyPath("SelectedItem"),
  Mode = BindingMode.TwoWay
};
myButton.SetBinding(dp, binding); 
```

# haskell - 以下某些树数据类型在计算机科学中使用的名称是什么？

> ID：12030199
> 
> 赞同：6
> 
> 时间：2012-08-19T21:35:25.130
> 
> 标签：haskell, types, tree

有时我让自己在 Haskell 中使用不同类型的树，但我不知道它们被称为什么，也不知道从哪里获得有关使用它们的算法或它们的类实例的更多信息，甚至不知道一些关于 hackage 的预先存在的代码或库。

例子：

标签在叶子或树枝上的二叉树：

```
data BinTree1 a = Leaf | 
                  Branch {label :: a, leftChild :: BinTree1 a, rightChild :: BinTree1 a}

data BinTree2 a = Leaf {label :: a} | 
                  Branch {leftChild :: BinTree2 a, rightChild :: BinTree2 a} 
```

类似地，带有每个子节点标签的树或所有子节点的通用标签：

```
data Tree1 a = Branch {label :: a, children :: [Tree1 a]}

data Tree2 a = Branch {labelledChildren :: [(a, Tree2 a)]} 
```

有时我开始使用`Tree2`，并且在开发过程中不知何故被重构为`Tree1`，这似乎更容易处理，但我从来没有考虑过很多。这里有某种二元性吗？

另外，如果您可以发布一些您认为有用的其他不同种类的树，请发布。

总而言之：你能告诉我的关于这些树的一切都会很有用！:)

谢谢。

编辑：

澄清：这不是家庭作业。只是我通常最终会使用这些数据类型并创建实例（Functor、Monad 等），也许如果我重新命名它们的名称，我会找到包含已实现的东西和更多理论信息的库。

通常，当 Hackage 上的库名称中有 Tree 时，它​​会实现 BinTree2 或仅在叶子上带有标签的非二叉树的某些版本，所以在我看来，Tree2 和 BinTree2 可能有其他名称或标识符。

另外我觉得可能存在某种对偶性或同构，或者一种将使用 Tree1 的代码转换为使用 Tree2 并进行一些转换的代码的方法。在那儿？可能只是印象。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-19T23:08:25.467

我听过的名字：

*   `BinTree1`是[二叉树](http://en.wikipedia.org/wiki/Binary_tree)
*   `BinTree2`不知道名称，但您可以使用这样的树来表示无前缀代码，例如霍夫曼编码
*   `Tree1`是一棵[玫瑰树](http://en.wikipedia.org/wiki/Rose_Tree)
*   `Tree2``[Tree1]`与（的森林）等距`Tree1`或以其他方式查看它是`Tree1`没有根标签的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-19T22:20:20.687

`BinTree2`仅在叶子（

因此，如果您有 4 个具有以下哈希码的值：

```
...000001 A
...000010 B
...000011 C
...000010 D 
```

...您可以将它们存储在二叉树（隐式帕特里夏树）中，如下所示：

```
 +          <- Bit #1 (least significant bit) of hash code
    / \            0 = left, 1 = right
   /   \
[B, D]  +       <- Bit #2
       / \
      /   \
     [A]  [C] 
```

我们看到，由于`B`和`D`“开始”的哈希码是`0`，它们存储在左根孩子中。它们具有完全相同的哈希码，因此不再需要分叉。`A`和的哈希码`C`都以 1 “开始”，因此需要另一个分叉。`A`位 2 as `0`，所以它向左，而 C with`1`向右。

这种哈希表实现有点糟糕，因为当插入某些元素时可能必须重新计算哈希值，但没关系。

* * *

`BinTree1`只是一个普通的二叉树，用于快速基于顺序的集合。没什么好说的了，真的。

* * *

`Tree1`和之间的唯一区别`Tree2`是`Tree2`不能有根节点标签。这意味着如果用作前缀树，它不能包含空字符串。它的用途非常有限，我在实践中还没有看到类似的东西。`Tree1`但是，正如我所说，显然可以用作非二进制前缀树。

# c# - WP7 滚动视图中 600 多个元素的更好解决方案

> ID：12030207
> 
> 赞同：0
> 
> 时间：2012-08-19T21:36:42.120
> 
> 标签：c#, silverlight, windows-phone-7

我有一个滚动视图，其中包含大约 614 个网格控件（它用作书籍索引，每个网格指向书中的某个位置），在每个网格内大约 4 个文本块显示有关该选择的信息......

所有文本块内的内容都是静态的。问题是，当加载所有内容时，手机会在一段时间内变得安静无响应……加载该页面并从其他页面导航到该页面需要时间。

我想要另一种解决方案来正确显示所有项目，并且 600 的每个网格视图都有自己的单击事件处理程序，以便能够将其指向书中的页面。

我读到了一些很难做到的方法，我在想也许我只能将索引加载为一个非常“高”的图像，其中写有索引，然后检测用户点击的位置并从中计算索引页面？那效率高吗？或者也许还有别的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:31:57.327

正在发生的事情是滚动视图正在遍历所有 600 个项目以测量每个条目的高度，以便它知道渲染滚动条的大小。

在这种情况下，最好在 WP7 仅呈现可见项目之前使用 ListBox。即便如此，当您达到 2000 行时，我也听说过性能问题。

如果您对虚拟化的工作原理感兴趣，Samuel Jack 写了一个可扩展性很好的文章（尽管不是针对 WP7），但他对他所做的决定有详细的记录。

[https://github.com/samueldjack/VirtualCollection/tree/master/VirtualCollection/VirtualCollection](https://github.com/samueldjack/VirtualCollection/tree/master/VirtualCollection/VirtualCollection)

请参阅他的文章：

1.  [数据虚拟化和隐形分页](http://blogs.hibernatingrhinos.com/12513/data-virtualization-lazy-loading-stealth-pagingndash-whatever-you-want-to-call-it-herersquo-s-how-to-do-it-in-silverlight)

2.  [Silverlights 虚拟收藏](http://blogs.hibernatingrhinos.com/12514/data-virtualization-in-silverlight-digging-into-virtualcollection)

3.  [虚拟化包装面板](http://blogs.hibernatingrhinos.com/12515/implementing-a-virtualizingwrappanel)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T03:32:02.957

假设有两个可观察的集合`A`和`B`。将您的收藏绑定`A`到您的 UI。每次填满你的收藏`B`。每次刷新 UI 时都清晰`A`。加载 UI 后，通过事件触发器开始填充来自的项目`B -> A`，因为它是一个 Observable 集合，如果您正确使用 INotifyPropertyChanged，项目将开始一个接一个地出现在 UI 上。( `Lazy Loading`)。您可以根据您的实现更改此方法。我自己正在遵循这种方法。希望它对你也有帮助。

# android - 使用 spring android resttemplate 和 android annotations 设置 headers

> ID：12030209
> 
> 赞同：4
> 
> 时间：2012-08-19T21:36:49.653
> 
> 标签：android, spring, rest, http-headers, resttemplate

我目前正在使用 Spring Android Resttemplate 与 java 支持的 REST API 进行交互。实际上，我正在使用[android 注释](http://androidannotations.org/)向这个后端服务发送 http 调用，我必须说它很震撼。基本上，Android 注释允许您为服务调用定义一个接口以及用于每个可用 api 调用的 http 方法：它将生成与编组/解编组等低级内容相关的所有样板代码，调用正确的根据接口定义的http方法。

现在，我想为 http 请求设置一些标头：知道我只有对定义所有调用的 Service 接口的引用，如何实现这一点？我也可以引用 RestTemplate 对象，但现在似乎有设置标题的方法。

任何帮助将不胜感激谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T08:30:23.740

我接近它的方法是`ApiClient`在应用程序类中创建一个实例并设置一个自定义 REST 模板。

就我而言，我使用 Jackson 进行 JSON 消息转换：

```
RestTemplate restTemplate = new RestTemplate(fac);
MappingJacksonHttpMessageConverter converter =
        new MappingJacksonHttpMessageConverter();
converter.getObjectMapper().configure(Feature.UNWRAP_ROOT_VALUE, true);
restTemplate
        .getMessageConverters()
        .add(converter);
mClient.setRestTemplate(restTemplate); 
```

我的请求工厂`fac`看起来像这样：

```
ClientHttpRequestFactory fac = new HttpComponentsClientHttpRequestFactory() {

    @Override
    protected HttpUriRequest createHttpRequest(HttpMethod httpMethod, URI uri) {
        HttpUriRequest uriRequest = super.createHttpRequest(httpMethod, uri);
        // Add request headers
        uriRequest.addHeader(
                "Content-Type",
                MediaType.APPLICATION_JSON_VALUE);
        return uriRequest;
    }

    @Override
    public ClientHttpRequest createRequest(URI uri, HttpMethod httpMethod)
            throws IOException {
        if (Config.DEBUG_REQUESTS) {
            Log.d(TAG, uri);
        }
        return super.createRequest(uri, httpMethod);
    }

}; 
```

## 警告

尽管这适用于我们办公室的所有 Android 设备，**但我最近发现似乎并非*所有*设备都添加了标题！**我不确定这是为什么（或具体是哪些设备），但我正在研究它，并在找到解决方案后尝试更新此答案。

# mysql - mysql奇怪的存储数据

> ID：12030210
> 
> 赞同：0
> 
> 时间：2012-08-19T21:36:52.890
> 
> 标签：mysql

我对保存在 mysql 中的一些数据有一个奇怪的问题。我将某个值作为文本保存在我的数据库中，但由于某种原因，某些文本被转换为这种“ï¼¡ï¼´ï¼¥ï¼¬ï¼¯ï¼°ï¼¨ï¼¯ï¼¢ï¼©ï¼¡”类型的符号。

编码：

```
$data = mysql_real_escape_string($_GET['data']);
$id = $_GET["id"];
mysql_query("INSERT INTO table (ID, name, pos,data) VALUES ('$id', '$regionname','$regionps[0]','$data')"); 
```

表结构：

```
CREATE TABLE IF NOT EXISTS `sim_scanner` (
  `ID` varchar(64) COLLATE latin1_general_ci NOT NULL,
  `simname` varchar(36) COLLATE latin1_general_ci NOT NULL,
  `simpos` varchar(25) COLLATE latin1_general_ci NOT NULL,
  `time` varchar(25) COLLATE latin1_general_ci NOT NULL,
  `data` text COLLATE latin1_general_ci NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci; 
```

将自身转换为该值的数据是这样的值，<151.25,255.54,1254.12>(vector)，因为数据是由脚本生成的，所以我不知道确切的值，它基本上是移动后的字符位置数据是另一个向量谢谢你的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:08:48.993

您的 mysql 字符编码与数据字符编码不同，这就是为什么...

```
for example try use the utf-8_general_ci in DB character set.. 
```

他们支持的字符的UTF-8定义，通常UTF8支持大部分字符

# html - CSS RGBA 颜色背景表现奇怪

> ID：12030214
> 
> 赞同：0
> 
> 时间：2012-08-19T21:37:03.993
> 
> 标签：html, css

我尝试使用`rgba()`来定义 div 的背景颜色，但不是更改不透明度，而是第四个值更改亮度（显然），并将圆形边框渲染为黑色。这是我的 CSS，非常简单的东西：

```
#content {
    min-height: 200px;
    padding: 25px;
    border-radius: 50px;
    background-color: rgba(169, 245, 208, 0.4);
} 
```

这是 Firefox 和 Chrome 中这个问题的图片： ![超诡异的bug](../Images/0e1af67c37caae491ad7344e2dd86762.png) 最后，网站的 URL：http: [//lksonorizacao.com.br/newsite/](http://lksonorizacao.com.br/newsite/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:46:25.200

`#container`父母`background:#000`有一套。`#content`的圆角刚好露出那黑色。`rgba()`确实按照您认为的方式工作。

# mysql - 跨多个表查找重复项

> ID：12030215
> 
> 赞同：0
> 
> 时间：2012-08-19T21:37:12.893
> 
> 标签：mysql, sql

我有一个表（T1）和一个带有属性的表（T2）。我正在寻找与提供 id 的记录具有相同属性的记录。

这是示例。给定 1 我想找到 2（确保属性也匹配）。

```
T1
ID | A | B
----------
1  | k | l
2  | k | l

T2
IDFK | C | D
-------------    
1    | w | x
1    | y | z
2    | w | x
2    | y | z 
```

这是我到目前为止的SQL：

```
SELECT * FROM T1 
JOIN T1 AS T1COPY ON T1.A = T1COPY.A, T1.B = T1COPY.B 
JOIN T2 ON T1.ID = T2.IDFK 
JOIN T2 AS T2COPY ON T1COPY.ID = T2COPY.IDFK 
   AND T2.C = T2COPY.C 
   AND T2.D = T2COPY.D
WHERE T1.ID = 1 
```

但它不能正常工作，因为它匹配 2 即使属性不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T08:04:55.510

这是 MySQL 的答案：[http ://www.sqlfiddle.com/#!2/ec4fa/2](http://www.sqlfiddle.com/#!2/ec4fa/2)

```
select h.* 
from 
(
    select x.*
    from t join t x using(a,b)
    where t.id = 1 and x.id <> 1  
) h
join 
(

    select coalesce(x.cpIdFk, x.uIdFk) as idFk  
    from
    (
      select cp.idFk as cpIdFk, u.idFk as uIdFk
      from 
      (
        select t.id as idFk, x.*
        from t cross join (select c, d from u where idFk = 1) as x
        where t.id <> 1      
      ) cp
      left join (select * from u where idFk <> 1) u using(idfk,c,d)

      union

      select cp.idFk,u.idFk
      from 
      (
        select t.id as idFk, x.*
        from t cross join (select c, d from u where idFk = 1) as x
        where t.id <> 1      
      ) cp
      right join (select * from u where idFk <> 1) u using(idfk,c,d)

    ) as x

    group by idFk
    having bit_and(cpidFk is not null and uIdFk is not null)

) d on d.idFk = h.id 
order by h.id; 
```

过滤器 ID == 1 的输出：

```
| ID | A | B |
--------------
|  2 | k | l |
|  5 | k | l | 
```

从这些输入：

```
CREATE TABLE t
    (ID int, A varchar(1), B varchar(1));

INSERT INTO t
    (ID, A, B)
VALUES
    (1, 'k', 'l'),
    (2, 'k', 'l'),
    (3, 'k', 'l'),
    (4, 'k', 'l'),
    (5, 'k', 'l'),
    (6, 'k', 'j');

CREATE TABLE u
    (IDFK int, C varchar(1), D varchar(1));

INSERT INTO u
    (IDFK, C, D)
VALUES
    (1, 'w', 'x'),
    (1, 'y', 'z'),

    (2, 'w', 'x'),
    (2, 'y', 'z'),

    (3, 'w', 'x'),
    (3, 'y', 'z'),
    (3, 'm', 'z'),

    (4, 'w', 'x'),

    (5, 'w', 'x'),
    (5, 'y', 'z'),

    (6, 'w', 'x'),
    (6, 'y', 'z'); 
```

此处说明：[在多个表中查找重复项](https://stackoverflow.com/questions/12030215/find-duplicates-across-multiple-tables/12031658#12031658)

MySQL 查询看起来有点复杂，因为它不支持 FULL JOIN 并且也没有 CTE。我们通过合并和`FULL JOIN`的结果来模拟`LEFT JOIN``RIGHT JOIN`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T22:47:04.473

我的方法是使用 group_concat 将两列属性组合成单个值。然后我可以轻松找到所有具有相同属性的 id，并将它们作为属性返回。

```
select allts.id
from (select group_concat(c separator ';' order by c) as allcs,
             group_concat(d separator ';' order by d) as allds
      from t2
      where t2.id = 1
     ) t2_1 join
     (select t2.id, group_concat(c separator ';' order by c) as allcs,
             group_concat(d separator ';' order by d) as allds
      from t2
      group by t2.id
     ) allts
     on t2_1.allcs = allts.allcs and t2_1.allds = t2_1.allds join 
```

这个版本没有考虑到 t1 中的任何信息。你的问题只提到了t2中的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T02:27:36.223

如果您偶然将系统移植到 Postgresql，您可以使用 FULL JOIN：[http ://www.sqlfiddle.com/#!1/1f0ef/1](http://www.sqlfiddle.com/#!1/1f0ef/1)

```
with headers_matches as
(
    select x.*
    from t join t x using(a,b)
    where t.id = 1 and x.id <> 1
)
,cp as
(
    select t.id as idFk, x.*
    from t cross join (select c, d from u where idFk = 1) as x
    where t.id <> 1
)
,details_matches as
(
    select coalesce(cp.idFk,u.idFk) as idFk
    from cp
    full join (select * from u where idFk <> 1) u using(idfk,c,d)
    group by idFk
    having every(cp.idFk is not null and u.idFk is not null)
)
select h.* 
from headers_matches h
join details_matches d on d.idFk = h.id 
order by h.id; 
```

过滤器 ID == 1 的输出：

```
| ID | A | B |
--------------
|  2 | k | l |
|  5 | k | l | 
```

从这些输入：

```
CREATE TABLE t
    (ID int, A varchar(1), B varchar(1));

INSERT INTO t
    (ID, A, B)
VALUES
    (1, 'k', 'l'),
    (2, 'k', 'l'),
    (3, 'k', 'l'),
    (4, 'k', 'l'),
    (5, 'k', 'l'),
    (6, 'k', 'j');

CREATE TABLE u
    (IDFK int, C varchar(1), D varchar(1));

INSERT INTO u
    (IDFK, C, D)
VALUES
    (1, 'w', 'x'),
    (1, 'y', 'z'),

    (2, 'w', 'x'),
    (2, 'y', 'z'),

    (3, 'w', 'x'),
    (3, 'y', 'z'),
    (3, 'm', 'z'),

    (4, 'w', 'x'),

    (5, 'w', 'x'),
    (5, 'y', 'z'),

    (6, 'w', 'x'),
    (6, 'y', 'z'); 
```

* * *

## 这个怎么运作

我们先做最难的部分，也就是细节。我们将在这个答案的后半部分做标题。

它是如何工作的，首先我们需要交叉填充细节，以便我们可以对细节进行适当的完全连接，以便稍后可以检测到差距：

```
with cp as -- cross populate
(
    select t.id as idFk, x.*
    from t cross join (select c, d from u where idFk = 1) as x
    where t.id <> 1
)
select *
from cp; 
```

输出：

```
| IDFK | C | D |
----------------
|    2 | w | x |
|    2 | y | z |
|    3 | w | x |
|    3 | y | z |
|    4 | w | x |
|    4 | y | z |
|    5 | w | x |
|    5 | y | z |
|    6 | w | x |
|    6 | y | z | 
```

然后从交叉填充的细节中，我们可以进行正确的 FULL JOIN：

```
with cp as 
(
    select t.id as idFk, x.*
    from t cross join (select c, d from u where idFk = 1) as x
    where t.id <> 1
)
select 
    cp.idFk as cpIdFk, cp.c as cpC, cp.d as cpD,
    u.idFk as uFk, u.c as uC, u.d as Ud
from cp
full join (select * from u where idFk <> 1) u using(idfk,c,d); 
```

输出：

```
| CPIDFK |    CPC |    CPD |    UFK |     UC |     UD |
-------------------------------------------------------
|      2 |      w |      x |      2 |      w |      x |
|      2 |      y |      z |      2 |      y |      z |
| (null) | (null) | (null) |      3 |      m |      z |
|      3 |      w |      x |      3 |      w |      x |
|      3 |      y |      z |      3 |      y |      z |
|      4 |      w |      x |      4 |      w |      x |
|      4 |      y |      z | (null) | (null) | (null) |
|      5 |      w |      x |      5 |      w |      x |
|      5 |      y |      z |      5 |      y |      z |
|      6 |      w |      x |      6 |      w |      x |
|      6 |      y |      z |      6 |      y |      z | 
```

有了这些信息，我们现在可以执行适当的逻辑来检测两组之间是否存在间隙，从上面的集合中，我们可以看到没有间隙的是#2、#5 和#6。为此，我们执行以下查询：

```
with cp as
(
    select t.id as idFk, x.*
    from t cross join (select c, d from u where idFk = 1) as x
    where t.id <> 1
)
,details_matches as
(
    select coalesce(cp.idFk,u.idFk) as idFk
    from cp
    full join (select * from u where idFk <> 1) u using(idfk,c,d)
    group by idFk
    having every(cp.idFk is not null and u.idFk is not null)
)
select * from details_matches
order by idFk; 
```

输出：

```
| IDFK |
--------
|    2 |
|    5 |
|    6 | 
```

然后现在我们进行标题比较，这更容易：

```
with headers_matches as
(
    select x.*
    from t join t x using(a,b)
    where t.id = 1 and x.id <> 1
)
select * from headers_matches; 
```

这应该返回标题#2、#3、#4、#5，因为它们与#1 的标题值相同：

输出：

```
| ID | A | B |
--------------
|  2 | k | l |
|  3 | k | l |
|  4 | k | l |
|  5 | k | l | 
```

最后，我们结合两个查询：

```
with headers_matches as
(
    select x.*
    from t join t x using(a,b)
    where t.id = 1 and x.id <> 1
)
,cp as
(
    select t.id as idFk, x.*
    from t cross join (select c, d from u where idFk = 1) as x
    where t.id <> 1
)
,details_matches as
(
    select coalesce(cp.idFk,u.idFk) as idFk
    from cp
    full join (select * from u where idFk <> 1) u using(idfk,c,d)
    group by idFk
    having every(cp.idFk is not null and u.idFk is not null)
)
select h.* 
from headers_matches h
join details_matches d on d.idFk = h.id 
order by h.id; 
```

输出：

```
| ID | A | B |
--------------
|  2 | k | l |
|  5 | k | l | 
```

在此处查看查询进度：[http ://www.sqlfiddle.com/#!1/1f0ef/1](http://www.sqlfiddle.com/#!1/1f0ef/1)

稍后我会将 Postgresql 查询转换为 Mysql。

**更新**

这是 MySQL 版本：[在多个表中查找重复项](https://stackoverflow.com/questions/12030215/find-duplicates-across-multiple-tables/12034144#12034144)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-19T21:48:49.827

## 第二个修订答案

由于评论指出 T2 中可能存在重复行，因此需要更复杂的解决方案。我相信这是一个生成正确数据的查询。

```
-- Query 8B
SELECT x.id
  FROM (SELECT d2.id, d2.c, d2.d
          FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS d2
          JOIN (SELECT id
                  FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS x
                 GROUP BY id
                HAVING COUNT(*) = (SELECT COUNT(*)
                                     FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS x
                                    GROUP BY id)
               ) AS j2
            ON j2.id = d2.id
       ) AS x
  JOIN (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS y
    ON x.c = y.c AND x.d = y.d
 GROUP BY x.id
HAVING COUNT(*) = (SELECT COUNT(*)
                     FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS x
                    GROUP BY id); 
```

我怀疑这是否是最简单的，但它是先前修订答案的合乎逻辑的延续。

### 示例运行

这是查询的跟踪输出，显示了开发过程中的步骤。DBMS 是在 Mac OS X 10.7.4 上运行的 IBM Informix Dynamic Server 11.70.FC2，使用 SQLCMD v88.00 作为 SQL 命令解释器（不，不是微软的 johnny-come-lately；我二十多年前第一次写的那个） .

```
+ BEGIN;
+ CREATE TABLE T1
(ID INTEGER NOT NULL PRIMARY KEY, a CHAR(1) NOT NULL, b CHAR(1) NOT  NULL);
+ INSERT INTO T1 VALUES(1, 'k', 'l');
+ INSERT INTO T1 VALUES(2, 'k', 'l');
+ INSERT INTO T1 VALUES(3, 'a', 'b');
+ INSERT INTO T1 VALUES(4, 'p', 'q');
+ INSERT INTO T1 VALUES(5, 't', 'v');
+ CREATE TABLE T2
(IDFK INTEGER NOT NULL REFERENCES T1, c CHAR(1) NOT NULL, d CHAR(1) NOT  NULL);
+ INSERT INTO T2 VALUES(1, 'w', 'x');
+ INSERT INTO T2 VALUES(1, 'y', 'z');
+ INSERT INTO T2 VALUES(2, 'w', 'x');
+ INSERT INTO T2 VALUES(2, 'w', 'x');
+ INSERT INTO T2 VALUES(2, 'y', 'z');
+ INSERT INTO T2 VALUES(3, 'w', 'x');
+ INSERT INTO T2 VALUES(3, 'y', 'b');
+ INSERT INTO T2 VALUES(3, 'y', 'z');
+ INSERT INTO T2 VALUES(4, 'w', 'x');
+ INSERT INTO T2 VALUES(5, 'w', 'x');
+ INSERT INTO T2 VALUES(5, 'y', 'z');
+ INSERT INTO T2 VALUES(5, 'w', 'x');
+ INSERT INTO T2 VALUES(5, 'y', 'z');
+ SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1;
2|w|x
2|y|z
3|w|x
3|y|b
3|y|z
4|w|x
5|w|x
5|y|z
+ SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1;
1|w|x
1|y|z
+ SELECT id, COUNT(*) FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS x GROUP BY id;
2|2
5|2
3|3
4|1
+ SELECT id, COUNT(*) FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS x GROUP BY id;
1|2
+ -- Query 5B - IDs having same count of distinct rows as ID = 1
SELECT id
  FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS x
 GROUP BY id
HAVING COUNT(*) = (SELECT COUNT(*)
                     FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS x
                    GROUP BY id);
2
5
+ -- Query 6B
SELECT d2.id, d2.c, d2.d
  FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS d2
  JOIN (SELECT id
          FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS x
         GROUP BY id
        HAVING COUNT(*) = (SELECT COUNT(*)
                             FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS x
                            GROUP BY id)
       ) AS j2
    ON j2.id = d2.id
 ORDER BY id;
2|w|x
2|y|z
5|w|x
5|y|z
+ -- Query 7B
SELECT x.id, y.id, x.c, y.c, x.d, y.d
  FROM (SELECT d2.id, d2.c, d2.d
          FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS d2
          JOIN (SELECT id
                  FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS x
                 GROUP BY id
                HAVING COUNT(*) = (SELECT COUNT(*)
                                     FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS x
                                    GROUP BY id)
               ) AS j2
            ON j2.id = d2.id
       ) AS x
  JOIN (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS y
    ON x.c = y.c AND x.d = y.d
 ORDER BY x.id, y.id, x.c, x.d;
2|1|w|w|x|x
2|1|y|y|z|z
5|1|w|w|x|x
5|1|y|y|z|z
+ -- Query 8B
SELECT x.id
  FROM (SELECT d2.id, d2.c, d2.d
          FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS d2
          JOIN (SELECT id
                  FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk != 1) AS x
                 GROUP BY id
                HAVING COUNT(*) = (SELECT COUNT(*)
                                     FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS x
                                    GROUP BY id)
               ) AS j2
            ON j2.id = d2.id
       ) AS x
  JOIN (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS y
    ON x.c = y.c AND x.d = y.d
 GROUP BY x.id
HAVING COUNT(*) = (SELECT COUNT(*)
                     FROM (SELECT DISTINCT idfk AS id, c, d FROM t2 WHERE idfk  = 1) AS x
                    GROUP BY id);
2
5
+ ROLLBACK; 
```

## 第一次修订答案

### 第 1 步：具有与 ID = 1 相同行数的 ID

```
SELECT idfk AS id -- Query 5
  FROM t2
 WHERE idfk != 1
 GROUP BY idfk
HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1); 
```

### 第二步：数据对应Query 5

```
SELECT idfk AS id, c, d -- Query 6
  FROM t2
  JOIN (SELECT idfk AS id
          FROM t2
         WHERE idfk != 1
         GROUP BY idfk
        HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1)
       ) AS j2
    ON j2.id = t2.idfk
 ORDER BY id; 
```

### 第 3 步：将查询 6 中的行与 ID = 1 的行连接起来

```
SELECT x.id, y.id, x.c, y.c, x.d, y.d -- Query 7
  FROM (SELECT idfk AS id, c, d
          FROM t2
          JOIN (SELECT idfk AS id
                  FROM t2
                 WHERE idfk != 1
                 GROUP BY idfk
                HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1)
               ) AS j2
            ON j2.id = t2.idfk
       ) AS x
  JOIN (SELECT idfk AS id, c, d
          FROM t2 WHERE idfk = 1
       ) AS y
    ON x.c = y.c AND x.d = y.d
 ORDER BY x.id, y.id, x.c, x.d; 
```

### 第 4 步：来自查询 7 的 ID，其中计数与 ID = 1 的计数相同

```
SELECT x.id
  FROM (SELECT idfk AS id, c, d
          FROM t2
          JOIN (SELECT idfk AS id
                  FROM t2
                 WHERE idfk != 1
                 GROUP BY idfk
                HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1)
               ) AS j2
            ON j2.id = t2.idfk
       ) AS x
  JOIN (SELECT idfk AS id, c, d
          FROM t2 WHERE idfk = 1
       ) AS y
    ON x.c = y.c AND x.d = y.d
 GROUP BY x.id
HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1); 
```

### 示例运行

DBMS 是在 Mac OS X 10.7.4 上运行的 IBM Informix Dynamic Server 11.70.FC2，使用 SQLCMD v88.00 作为 SQL 命令解释器（不，不是微软的 johnny-come-lately；我二十多年前第一次写的那个） .

```
+ BEGIN;
+ CREATE TABLE T1
(ID INTEGER NOT NULL PRIMARY KEY, a CHAR(1) NOT NULL, b CHAR(1) NOT  NULL);
+ INSERT INTO T1 VALUES(1, 'k', 'l');
+ INSERT INTO T1 VALUES(2, 'k', 'l');
+ INSERT INTO T1 VALUES(3, 'a', 'b');
+ INSERT INTO T1 VALUES(4, 'p', 'q');
+ CREATE TABLE T2
(IDFK INTEGER NOT NULL REFERENCES T1, c CHAR(1) NOT NULL, d CHAR(1) NOT  NULL);
+ INSERT INTO T2 VALUES(1, 'w', 'x');
+ INSERT INTO T2 VALUES(1, 'y', 'z');
+ INSERT INTO T2 VALUES(2, 'w', 'x');
+ INSERT INTO T2 VALUES(2, 'y', 'z');
+ INSERT INTO T2 VALUES(3, 'w', 'x');
+ INSERT INTO T2 VALUES(3, 'y', 'b');
+ INSERT INTO T2 VALUES(3, 'y', 'z');
+ INSERT INTO T2 VALUES(4, 'w', 'x');
+ SELECT t1.id AS id, t2.c, t2.d -- Query 1
  FROM t1
  JOIN t2 ON t1.id = t2.idfk;
1|w|x
1|y|z
2|w|x
2|y|z
3|w|x
3|y|b
3|y|z
4|w|x
+ -- Query 5 - IDs having same count of rows as ID = 1

SELECT idfk AS id
  FROM t2
 WHERE idfk != 1
 GROUP BY idfk
HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1);
2
+ SELECT idfk AS id, c, d
  FROM t2
  JOIN (SELECT idfk AS id
          FROM t2
         WHERE idfk != 1
         GROUP BY idfk
        HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1)
       ) AS j2
    ON j2.id = t2.idfk
 ORDER BY id;
2|w|x
2|y|z
+ SELECT x.id, y.id, x.c, y.c, x.d, y.d
  FROM (SELECT idfk AS id, c, d
          FROM t2
          JOIN (SELECT idfk AS id
                  FROM t2
                 WHERE idfk != 1
                 GROUP BY idfk
                HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1)
               ) AS j2
            ON j2.id = t2.idfk
       ) AS x
  JOIN (SELECT idfk AS id, c, d
          FROM t2 WHERE idfk = 1
       ) AS y
    ON x.c = y.c AND x.d = y.d
 ORDER BY x.id, y.id, x.c, x.d;
2|1|w|w|x|x
2|1|y|y|z|z
+ SELECT x.id
  FROM (SELECT idfk AS id, c, d
          FROM t2
          JOIN (SELECT idfk AS id
                  FROM t2
                 WHERE idfk != 1
                 GROUP BY idfk
                HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1)
               ) AS j2
            ON j2.id = t2.idfk
       ) AS x
  JOIN (SELECT idfk AS id, c, d
          FROM t2 WHERE idfk = 1
       ) AS y
    ON x.c = y.c AND x.d = y.d
 GROUP BY x.id
HAVING COUNT(*) = (SELECT COUNT(*) FROM t2 WHERE t2.idfk = 1);
2
+ ROLLBACK; 
```

* * *

### 原始答案

*这至少引出了对问题的充分澄清。*

据我所知，如果您有如下子查询：

```
SELECT t1.id AS id, t2.c, t2.d  -- Query 1
  FROM t1
  JOIN t2 ON t1.id = t2.idfk 
```

那么您正在结果集中寻找成对的行，其中`c`和的值`d`相同但`id`值不同。因此，我们基于此编写主查询：

```
SELECT j1.id, j2.id  -- Query 2
  FROM (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk
       ) AS j1
  JOIN (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk
       ) AS j2
    ON j1.c = j2.c AND j1.d = j2.d AND j1.id != j2.id 
```

`!=`您可以通过将条件更改为`<`or来确保不会同时获得 '1, 2' 和 '2, 1' `>`。

如果您希望行与 T1 中的特定 ID 值匹配，则可以在 WHERE 子句中指定它：

```
SELECT j2.id  -- Query 3
  FROM (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk
       ) AS j1
  JOIN (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk
       ) AS j2
    ON j1.c = j2.c AND j1.d = j2.d AND j1.id != j2.id
 WHERE j1.id = 1;  -- 1 is the ID for which matches are sought 
```

如果您愿意，您可以将条件添加到子查询中（尽管一个好的优化器可能会为您做到这一点）：

```
SELECT j2.id  -- Query 4
  FROM (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk AND t1.id = 1
       ) AS j1
  JOIN (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk AND t1.id != 1
       ) AS j2
    ON j1.c = j2.c AND j1.d = j2.d
 WHERE j1.id = 1;  -- 1 is the ID for which matches are sought 
```

主 ON 子句中的第三个条件是多余的，因为根据构造，`j1`子查询中的 ID 值全为 1，而子查询中的 ID 值`j2`全为“非 1”。

* * *

我用SQL 中的`t2.id`vs解决了这个问题`t2.idfk`，并且我已经运行了上面的 4 个查询。每个都会产生我期望的答案。例如，查询 4 ​​的结果集中有两行，因为 T1 中有两对行，使得 { 1, *a* , *b* } 和 { 2, *a* , *b* } 都存在于 T2 中。如果您只希望这两个出现一次，尽管有许多匹配的行，那么您需要将 DISTINCT 应​​用于 SELECT。

在评论中，你说：

> 不幸的是，即使其中一个属性不匹配，它仍然会返回结果。如何匹配 T2 中的每个属性？

这需要一个扩展的数据集来演示。当我添加：

```
INSERT INTO T1 VALUES(3, 'a', 'b');
INSERT INTO T2 VALUES(3, 'a', 'z');
INSERT INTO T2 VALUES(3, 'y', 'b'); 
```

值 3 只出现在查询 1 的结果中，这是它应该出现的唯一位置。

请说明您所看到的错误行为，并显示示例数据。我用下面的 SQL 和交错的查询结果测试了上面的查询。DBMS 是在 Mac OS X 10.7.4 上运行的 IBM Informix Dynamic Server 11.70.FC2，使用 SQLCMD v88.00 作为 SQL 命令解释器。

```
+ BEGIN;
+ CREATE TEMP TABLE T1
(ID INTEGER NOT NULL PRIMARY KEY, A CHAR(1) NOT NULL, B CHAR(1) NOT  NULL);
+ INSERT INTO T1 VALUES(1, 'k', 'l');
+ INSERT INTO T1 VALUES(2, 'k', 'l');
+ INSERT INTO T1 VALUES(3, 'a', 'b');
+ CREATE TEMP TABLE T2
(IDFK INTEGER NOT NULL, C CHAR(1) NOT NULL, D CHAR(1) NOT  NULL);
+ INSERT INTO T2 VALUES(1, 'w', 'x');
+ INSERT INTO T2 VALUES(1, 'y', 'z');
+ INSERT INTO T2 VALUES(2, 'w', 'x');
+ INSERT INTO T2 VALUES(2, 'y', 'z');
+ INSERT INTO T2 VALUES(3, 'a', 'z');
+ INSERT INTO T2 VALUES(3, 'y', 'b');
+ SELECT t1.id AS id, t2.c, t2.d -- Query 1
  FROM t1
  JOIN t2 ON t1.id = t2.idfk;
1|w|x
1|y|z
2|w|x
2|y|z
3|a|z
3|y|b
+ SELECT j1.id, j2.id -- Query 2
  FROM (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk
       ) AS j1
  JOIN (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk
       ) AS j2
    ON j1.c = j2.c AND j1.d = j2.d AND j1.id != j2.id;
1|2
1|2
2|1
2|1
+ SELECT j2.id -- Query 3
  FROM (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk
       ) AS j1
  JOIN (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk
       ) AS j2
    ON j1.c = j2.c AND j1.d = j2.d AND j1.id != j2.id
 WHERE j1.id = 1;
2
2
+ SELECT j2.id  -- Query 4
  FROM (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk AND t1.id = 1
       ) AS j1
  JOIN (SELECT t1.id AS id, t2.c, t2.d
          FROM t1
          JOIN t2 ON t1.id = t2.idfk AND t1.id != 1
       ) AS j2
    ON j1.c = j2.c AND j1.d = j2.d
 WHERE j1.id = 1;
2
2
+ ROLLBACK; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-19T23:06:39.177

让我们从定义代表输入 ID 的属性数据开始：

```
select idfk, c, d
from t2
where idfk = @ID 
```

现在我们可以使用此信息来选择 T2 中存在的潜在匹配项，其中 IDFK 不是 @ID：

```
select x.idfk, x.c, x.d y.idfk as id2 from (
    select idfk, c, d
    from t2
    where idfk = @ID
) x left join t2 y on x.c = y.c and x.d = y.d
where y.idfk <> @ID 
  and y.idfk is not null 
```

如果 id2 的每个值的行数与第一个查询的行数相同，则数据是第二个查询与第一个查询中的数据相匹配。

因此：

```
select id2 from ( 
    select id2, count(*) as rowcount from (
        <second query>
    ) z
) rowsByID
where rowcount = (select count(*) from (<first query>) IDattributes) 
```

我不确定您是否打算返回的行也必须在 A & B 上匹配，或者仅在表 2 中的数据上匹配，但如果我假设它们必须在 A & B 上匹配，那么：

```
select ID from t1 
    join <third query> m on t1.id = m.id2
    join (select a, b from t1 where id = @id) prime_row on t1.a = prime_row.a and t1.b = prime_row.b 
```

如果您不需要 A & B 匹配，请删除第二个连接。

这个怎么样？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-20T01:50:04.057

这在一张大桌子上可能会非常慢。（编辑：我现在知道完全连接不适用于 mysql；但第一个查询对其他系统仍然有效，并且可能更容易理解。如果您不关心它，请跳到第二个。）

我使用问号作为参数标记。所有人都应该收到被匹配的“重复”ID的相同值。添加条件`and T.id <> ?`以从结果集中排除匹配的行。（我原以为 OP 想要第 1 行和第 2 行。） tX 代表搜索空间，因此它也可以在那里被排除并在过程的早期被消除。

```
select *
from T1 as T
where T.id in (
    select coalesce(attrR.idfk, tX.id)
    from
        T1 as tX
        cross join
        (select * from T2 where T2.idfk = ?) as attrL
        full outer join T2 as attrR
            on      attrR.idfk = tX.id
                and attrR.c = attrL.c
                and attrR.d = attrL.d
    group by coalesce(attrR.idfk, tX.id)
    having count(*) =
        sum(case
                when attrR.c = attrL.c and attrR.d = attrL.d
                then 1 else 0
            end
        )
); 
```

这绕过了`full outer join`.

```
select *
from T1 as T
where T.id in (
    select attrR.idfk
    from
        T1 as tX
        cross join
        (select * from T2 where idfk = ?) as attrL
        right outer join
        T2 as attrR
            on      attrR.idfk = tX.id
                and attrR.c = attrL.c
                and attrR.d = attrL.d
        cross join
        (select count(*) as cnt from T2 where idfk = ?) as tC
    group by attrR.idfk
    having
        sum(case
                when attrR.c = attrL.c and attrR.d = attrL.d
                then 1 else 1000000
            end
        ) = min(tC.cnt)
); 
```

这种复合检查等价于`sum(case...)`表达式。一个人可能会比另一个人感觉更好。

```
 having
            count(attrL.idfk) = min(tC.cnt)
        and count(*) = min(tC.cnt) 
```

我提供的第一个和第二个查询确实有效，但前提是每个 T1 在 T2 中至少有一个属性。这是一个版本，它通过添加一个虚拟属性来进行补偿，以防止中间结果中出现空集而造成混乱。它更丑陋，所以如果这种情况没有必要，请不要使用它。（完整的加入版本需要类似的调整。）

```
select *
from T1 as T
where T.id in (
    select attrR.idfk
    from
        T1 as tX
        cross join
        (
            select c, d from T2 where idfk = ?
            union all
            select '!@#$%', '' -- add a dummy attribute
        ) as attrL
        right outer join
        (
            select idfk, c, d from T2
            union all
            select id, '!@#$%', '' from T1
        ) as attrR
            on      attrR.idfk = tX.id
                and attrR.c = attrL.c
                and attrR.d = attrL.d
        cross join
        (select count(*)+1 as cnt from T2 where idfk = ?) as tC -- note the +1
    group by attrR.idfk
    having
            count(tX.id) = min(tC.cnt)
        and count(*) = min(tC.cnt)
); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-20T02:30:13.877

我已经考虑过您的评论是我之前的回答，并会提出一种不同的方法。

```
select idfk, c, d from t2 where idfk = @ID 
```

此查询标识@ID 的所有属性集。假设我们把它放到一个临时表中，那么对于这个表中的每一行，识别T2中的所有IDFK，其中IDFK <> @ID，在所有属性值上都与源行匹配；将所有这些行放入一个新表中。

我的 sql 这样做是：（你可能需要为 mysql 调整它）

```
create table #attribs (row# int, c, d);
insert #attribs (row#, c, d) values (0, null, null);

insert #attribs (row#, c, d)
select (select max row# from #attribs) + 1, c, d
from T2 where idfk = @ID;

delete #attribs where row# = 0;

create table #matchedattrib (idfk int)

while (select count(*) from #attribs) > 0 begin
    select @c = c, @d = d from #attribs where row# = (select min(row#) from #attribs);
    delete #attribs where row# = (select min(row#) from #attribs);

    insert #matchedattrib (idfk)
    select idfk from T2 where idfk <> @ID and T2.c = @c and T2.d = @d;
end 
```

完成此操作后，这个较新表中的任何 IDFK，其行数与 @ID（第一个查询）的属性集相同，都具有 @ID 的所有属性。

```
select idfk, count(*) as tot_attribs
into #counts
from #matchedattrib
group by idfk
having count(*) = (select count(*) from (select idfk from T2 where idfk = @ID) x); 
```

但是，正如您在我之前的回答中指出的那样，这些 IDFK 也可能具有其他属性，因此对于第二个表中具有正确行数的 IDFK，您需要计算 T2 中为它们存在的行是相同的number - 验证这些匹配的属性实际上是该 IDFK 的所有属性 - 表示属性的完全匹配。

```
select idfk from #counts
where tot_attribs = (select count(*) from T2 where idfk = #counts.idfk) 
```

如果您还需要匹配 A + B，则必须自己填写！

# actionscript-3 - Custom Event from Item Renderer not detected by a class

> ID：12030218
> 
> 赞同：0
> 
> 时间：2012-08-19T21:37:32.650
> 
> 标签：actionscript-3, apache-flex, events, itemrenderer, custom-event

I am trying to dispatch a custom event from an item renderer(which is a child of the Main application file / root).

Code in Main.mxml:

```
<s:List id="movieGrid"itemRenderer="views.MovieRenderer" dataProvider="{new ArrayCollection()}">
    </s:List>

<s:Group width="100%" height="100%" bottom="60">
            <views:DetailedViewInfo id="detailed" includeIn="MoviePage" />
    </s:Group> 
```

Renderer (something clicked):

```
MyEventDispatcher.Dispatcher.dispatchEvent(new MovieClickEvent(MovieClickEvent.CLICKED, data)); 
```

DetailedViewInfo (creation complete):

```
MyEventDispatcher.Dispatcher.addEventListener(MovieClickEvent.CLICKED, clickHandler); 
```

MyEventDispatcher:

```
package events
{
    import flash.events.EventDispatcher;

    public class MyEventDispatcher
    {   
        public static var Dispatcher:EventDispatcher = new EventDispatcher();
    }
} 
```

Event:

```
package events
{
    import flash.events.Event;

    public class MovieClickEvent extends Event
    {
        public function MovieClickEvent(type:String, theMovieData:Object, bubbles:Boolean=true, cancelable:Boolean=false)
        {
            super(type, bubbles, cancelable);
            this._result = theMovieData;
        }

        public function get result():Object
        {
            return this._result;
        }

        override public function clone():Event
        {
            return new MovieClickEvent(type, result, bubbles, cancelable)
        }

        public static const CLICKED:String = "MovieClickEvent.CLICKED";

        private var _result:Object;

    }
} 
```

I am able to listen for the event successfully in the Main.mxml but I also need to detect it in a SkinnableContainer - "DetailedViewInfo" that is also a child of Main.mxml:

It his possible at all? I tried importing all related events / classes and same for declarations. It does not work even if I comment out the event listener in Main.mxml. I tried adding a declaration to the item renderer in DetailedViewInfo but that crashes the application with no understandable error.

Could someone explain to me how this should be done? I am using custom events all over the place in my application and hadn't had this happen before. Any help highly appreciated!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T21:47:12.200

It would seem you're adding the event listener *after* the event was dispatched. I see you have an `includeIn` statement there: this means the `DetailedViewInfo` component will not be immediately created, but only when the `MoviePage` state is entered. The event may be dispatched before the component is created and the event listener attached.

The quick fix for this issue, is to not use `includeIn`, but set the component's visibility according to the current state:

```
<views:DetailedViewInfo id="detailed" visible="false" includeInLayout="false"
    visible.MoviePage="true" includeInLayout.MoviePage="true" /> 
```

However, you may want to review your architecture if you need to resort to this. Unfortunately I can't tell you much more than that, since I don't know your current architecture.

# less - 关于保存动作 Sublime Text 2

> ID：12030219
> 
> 赞同：1
> 
> 时间：2012-08-19T21:37:46.290
> 
> 标签：less, sublimetext2

我正在使用 Sublime Text 2 开发网站，我正在使用 LESS 和 FTP Sync。问题是两个插件的操作都是在保存后触发的。Less 正在构建 CSS 文件，而 FTP 正在同步。

我有两个问题：

1.  如何设置插件一个接一个地运行？（先 LES​​S，然后 FTP 同步）
2.  生成的 CSS 未同步（因为它不是由我保存的，而是由插件保存的）。如何设置 FTP 同步以监视所有文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T00:47:30.690

对于（1），您可以延迟上传。检查第 67 行“upload_delay”。对于（2）我不知道，尝试创建一个宏/脚本。

# caching - 分层内存 SMP 是矛盾的吗？

> ID：12030220
> 
> 赞同：0
> 
> 时间：2012-08-19T21:37:48.710
> 
> 标签：caching, smp

对称多处理系统是共享内存的同构处理器。我刚刚看到[Tim Mattson 的这个演讲](http://www.youtube.com/watch?v=TzERa9GA6vY)，他说分层内存（缓存级别）使 SMP 的规则无效。这是真的？为什么我不能说，例如，分层内存 SMP 系统？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:49:04.017

这听起来更像是一种意识形态纯洁性的声明，因为这意味着人们认为是 SMP（并在其上运行 SMP 内核等）实际部署的系统中有很大一部分实际上并不是 SMP。

如果 SMP 系统没有分层存储器，这对硬件设计人员和程序员来说都很好，因为在存在高速缓存的情况下，硬件在不同处理器的共享地址空间视图之间呈现某种一致性是很麻烦*的*，*并*让程序员处理硬件确实让他们观察到的不一致量。

不幸的是，完全拒绝缓存层次结构也会在返回单处理器阶段的大部分时间里破坏性能，除非人们花费大量时间计算内部循环中的所有内容都适合寄存器的 Mandelbrot 图像。

# ruby-on-rails - 如何在 Rails 视图中循环遍历 3 个值

> ID：12030232
> 
> 赞同：1
> 
> 时间：2012-08-19T21:41:04.340
> 
> 标签：ruby-on-rails, ruby, loops

有一个更好的方法吗：

```
row_bg_color_group = row_bg_color_group == 1 ? 2 : row_bg_color_group == 2 ? 3 : 1 
```

理想情况下像

```
row_bg_color_group = (1,2,3).cycle 
```

并且每次通过较大的循环都会使用下一个值。

请注意，这是作为不同组大小的一部分有条件地执行的，例如

```
1111
1111
1111
2222
3333
3333
3333
333 
```

不只是

```
111
222
333
111
222
333
111
222
333 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-19T21:47:30.180

您可以使用模运算符：

```
row_bg_color_group = ((row_bg_color_group + 1) % 3) + 1 
```

我不知道您的情况，但是如果您可以使用编号为 0 到 2 而不是 1 到 3 的组，这看起来会更干净一些。

```
row_bg_color_group = (row_bg_color_group + 1) % 3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T22:27:01.653

```
<% outer_loop_control do %>
  <% row_bg_color_group = cycle(1,2,3)
  <% inner_loop_control do %>
    ... # all uses of row_bg_color_group in the inner loop will be the same
  <% end %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T01:25:38.870

Rails 中有一个`cycle()`（[文档](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-cycle)）。所以你可以这样做：

```
row_bg_color_group = cycle(1,2,3) 
```

如果您需要有多个循环，您可以给它们命名：

```
row_bg_color_group = cycle(1,2,3, :name => "row_bg_color_group") 
```

然后他们就不会冲突了。

# java - Java匹配字符串的最佳方法是什么？

> ID：12030234
> 
> 赞同：0
> 
> 时间：2012-08-19T21:41:24.193
> 
> 标签：java, search, grouping, categories

我有几个字符串列表。每个列表代表一个类别。我正在尝试查找特定字符串所在的类别。我只能想到两种方法来做到这一点：

1.  遍历类别并返回包含它的第一个类别。

2.  创建字符串及其类别的运行哈希图。

哪一个更快/更有效，或者有比上面列出的方法更好的方法来查找字符串所在的类别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:46:35.520

因此，在哈希映射中查找某些内容是常数时间（摊销），而遍历每个列表是 m*n 时间，其中 m 是列表长度，n 是列表的数量。一定要使用哈希图。

或者，使每个字符串成为包含该类别的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T22:05:31.987

> 我有几个字符串列表。每个列表代表一个类别。我正在尝试查找特定字符串所在的类别。我只能想到两种方法来做到这一点：

提出这个问题的方式对我来说毫无意义。
如果每个列表代表一个类别并且 a`String`最终出现在一个*特定*列表中（并且您正在尝试找出哪个），那么您必须已经有一种方法可以将 a 映射`String`到一个类别并因此映射到一个 List 以便您应该能够使用该映射反向查找哪个 List 是作为成员的候选`contain`者`String`。
如果您没有这样的映射，那么这意味着每个`String`都随机放在一个列表中，但是该列表不能代表您在 OP 中提到的类别。

**更新：**
从您的评论看来，您没有列表类别，但您正在存储`Players`并尝试使用特定属性检索它们。在我看来，您应该首先使用 a`HashMap`而不是`List`s

# joomla2.5 - Joomla 开发发布/取消发布不起作用

> ID：12030235
> 
> 赞同：1
> 
> 时间：2012-08-19T21:41:24.560
> 
> 标签：joomla2.5

在大多数情况下，我有一个简单的组件遵循 hello world 教程，除了我在工具栏和列表本身（绿色/红色小圆圈）中添加了发布/取消发布图标之外，一切正常。

工具栏图标工作，他们可以改变状态没问题，但小图标没有，这是我的代码：

**视图.html.php：**

```
 protected function addToolBar() 
  {
    JToolBarHelper::title(JText::_('COM_MADS_MANAGER_OBJECTS'));
    JToolBarHelper::publishList($task = 'objects.publish', $alt = 'Publish');
    JToolBarHelper::unpublishList($task = 'objects.unpublish', $alt = 'Unpublish');
    JToolBarHelper::deleteListX('', 'objects.delete');
    JToolBarHelper::editListX('object.edit');
    JToolBarHelper::addNewX('object.add');
  } 
```

**tmpl > 正文：**

```
<?php
// No direct access to this file
defined('_JEXEC') or die;
?>
<?php foreach($this->items as $i => $item): ?>
  <tr class="row<?php echo $i % 2; ?>">
  <td><?php echo $item->id; ?></td>
  <td><?php echo JHtml::_('grid.id', $i, $item->id); ?></td>
  <td><a href="<?php echo JRoute::_('index.php?option=com_mads&task=object.edit&id=' . $item->id); ?>"><?php echo $item->title; ?></a></td>
  <td><?php echo $item->description; ?></td>  
  <td align="center"><?php $published = JHTML::_('grid.published', $item, $i); echo $published;?></td>
  </tr>
<?php endforeach; ?> 
```

我正在使用内置的发布/取消发布功能，并没有创建我自己的功能。

**表：**

```
<?php
// No direct access to this file
defined('_JEXEC') or die;

jimport('joomla.database.table');

class MAdsTableObjects extends JTable
{
    var $id = null;
    var $title = null;
    var $description = null;
    var $published = 0;

  function __construct(&$db) 
  {
    parent::__construct('#__mads_objects', 'id', $db);
  }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:13:27.230

在 A LOT FREKIN HEADACHE 和浪费时间之后，我想通了，应该是：

```
<?php echo JHtml::_('jgrid.published', $item->published, $i, 'objects.',true); ?> 
```

对象在哪里**。**是列表中我的视图/控制器/模型的名称。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-20T12:29:58.463

我认为您应该在数据库中有一个状态字段来存储状态

```
state   tinyint(3) 
```

比尝试使用：

```
 echo JHtml::_('grid.sort',  'JSTATUS', 'a.state', $listDirn, $listOrder); 
```

# java - LRU 缓存的 LinkedHashMap 结构

> ID：12030236
> 
> 赞同：6
> 
> 时间：2012-08-19T21:41:25.650
> 
> 标签：java, linkedhashmap

我对如何使用 LinkedHashMap 构建 LRU 缓存感到有些困惑（[您将如何在 Java 6 中实现 LRU 缓存？](https://stackoverflow.com/questions/221525/how-would-you-implement-an-lru-cache-in-java-6)），并且我想确保我了解它在幕后内部是如何工作的。

假设我定义了一个类 LRUMap，它扩展了 LinkedHashMap 并`removeEldestEntry(final Map.Entry<A, B> eldest)`像它一样覆盖它。

然后我构造数据结构并将 4 个项目插入到地图中

```
 LRUMap<String,String> map = new LRUMap<String,String>(3); //capacity 3
    map.put("a", "a");
    map.put("b", "b");
    map.put("c", "c");
    map.put("d", "d"); 
```

并且内部`LinkedHashMap`使用被`Entry object`调用`header`作为起始节点来链接您添加到地图的所有项目。所以在这种情况下它将是

```
 [header] ->  ["a"] -> ["b"] -> ["c"] -> ["d"] -> [header] 
```

header Entry 对象是双向链表的开始和结束，因为 header.before = header.after = header 在最初构造时。

假设地图达到了我想要的最大条目（3 个项目），并且从

```
 Entry<K,V> eldest = header.after;
    if (removeEldestEntry(eldest)) {
         removeEntryForKey(eldest.key);
    }
    ..... 
```

那么这是否意味着它将首先删除 ["a"] ？
当我们调用它时`get(Object key)`，它会重新排列列表顺序，它将那个键（比如说“b”）放在头节点之前，所以它变成了

```
 [header] ->  ["c"] -> ["d"] -> ["b"] -> [header] 
```

只是想澄清一下。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-19T21:49:37.490

1.  是的; 该条目`<"a", "a">`将首先被删除:-)
2.  也许; `LinkedHashMap`默认情况下使用*insert-order*，而不是*access-order* ...直接来自[规范](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html)：

    > 接口的哈希表和链表实现`Map`，具有可预测的迭代顺序。此实现的不同之处`HashMap`在于它维护一个贯穿其所有条目的双向链表。这个链表定义了迭代顺序，通常是键插入映射*的顺序（插入顺序*）。

    话虽如此，`LinkedHashMap`也支持*access-order*；

    > 提供了一个特殊[`constructor`](http://goo.gl/3Ts4p)的方法来创建链接哈希映射，其迭代顺序是其条目最后一次访问的顺序，从最近最少访问到最近访问（*访问顺序*）。这种映射非常适合构建 LRU 缓存。调用`put`or`get`方法会导致访问相应的条目（假设它在调用完成后存在）。

    因此，如果您使用*的是插入顺序*，则顺序不会从`get("b")`;更改。如果您使用*的是访问顺序*（通常是 LRU 缓存；-） *，*那么顺序**将会**改变。

 *还有其他问题吗？:-)*

# javascript - 如何测试是否使用 typeof 设置了变量？

> ID：12030244
> 
> 赞同：0
> 
> 时间：2012-08-19T21:42:25.353
> 
> 标签：javascript

我试图使用 typeof 来确定变量是否未定义：

```
function reset_textarea(reset) {

if (typeof(reset) != 'undefined') {
   ...do stuff
  }

} 
```

我这样称呼它：

```
reset_textarea('hello'); 
```

它不工作，我似乎无法弄清楚为什么。如果我删除 if 语句，该函数会正常触发，因此 - 问题似乎在于我测试变量是否设置的方式。知道发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T21:44:22.493

好吧，`typeof("hello")`（*字符串*的类型）已定义。这是一个`String`。`typeof(hello)`（注意缺少引号）是你需要的。这对你有用吗？

```
if(typeof(window[reset]) !== 'undefined') {
  //...
} 
```

`hello`您必须了解变量 ( ) 和字符串 ( )之间的区别`"hello"`。请记住，`window["hello"]`它等同于`window.hello`，但更灵活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T21:44:33.043

您可以测试是否存在具有指定名称的属性`window`：

```
function reset_textarea(reset) {

    if (typeof(window[reset]) !== 'undefined') {
       // ...do stuff
    }

} 
```

# javascript - 在 Node.js 中进行同步 MongoDB 查询的正确方法是什么？

> ID：12030248
> 
> 赞同：35
> 
> 时间：2012-08-19T21:43:07.227
> 
> 标签：javascript, node.js, mongodb, synchronous

我正在为 MongoDB 使用 Node.JS 驱动程序，并且我想执行一个同步查询，如下所示：

```
function getAThing()
{
    var db = new mongo.Db("mydatabase", server, {});

    db.open(function(err, db)
    {
        db.authenticate("myuser", "mypassword", function(err, success)
        {
            if (success)
            {
                db.collection("Things", function(err, collection)
                {
                    collection.findOne({ name : "bob"}, function(err, thing)
                    {                           
                        return thing;
                    });
                });
            }
        });
    });
} 
```

问题是，db.open 是一个异步调用（它不会阻塞），所以 getAThing 返回“未定义”，我希望它返回查询结果。我确信我可以使用某种阻塞机制，但我想知道做这样的事情的正确方法。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-06-07T10:51:53.870

**ES 6**（节点 8+）

您可以使用[异步/等待](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await)

`await`运算符暂停异步函数的执行，直到 Promise 被解决并返回值。

这样您的代码将以同步方式工作：

```
const query = MySchema.findOne({ name: /tester/gi });
const userData = await query.exec();
console.log(userData) 
```

* * *

较旧的解决方案 - 2013 年 6 月 ;)

现在[Mongo Sync](https://npmjs.org/package/mongo-sync)可用，这是在 Node.js 中进行同步 MongoDB 查询的正确方法。

我也用这个。您可以编写如下同步方法：

```
var Server = require("mongo-sync").Server;
var server = new Server('127.0.0.1');
var result = server.db("testdb").getCollection("testCollection").find().toArray();
console.log(result); 
```

注意：它依赖于[节点光纤](https://npmjs.org/package/fibers)，并且在 Windows 8 上存在一些问题。

快乐编码:)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-08-19T22:03:08.877

没有办法使这种同步而没有某种可怕的黑客攻击。正确的方法是`getAThing`接受一个回调函数作为参数，然后在该函数`thing`可用时调用该函数。

```
function getAThing(callback)
{
    var db = new mongo.Db("mydatabase", server, {});

    db.open(function(err, db)
    {
        db.authenticate("myuser", "mypassword", function(err, success)
        {
            if (success)
            {
                db.collection("Things", function(err, collection)
                {
                    collection.findOne({ name : "bob"}, function(err, thing)
                    {       
                        db.close();                    
                        callback(err, thing);
                    });
                });
            }
        });
    });
} 
```

**节点 7.6+ 更新**

[`async`/`await`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function)现在在使用返回 Promise 的异步 API 时提供了一种同步*风格*的编码方式（就像本机 MongoDB 驱动程序一样）。

使用这种方法，上述方法可以写成：

```
async function getAThing() {
    let db = await mongodb.MongoClient.connect('mongodb://server/mydatabase');
    if (await db.authenticate("myuser", "mypassword")) {
        let thing = await db.collection("Things").findOne({ name: "bob" });
        await db.close();
        return thing;
    }
} 
```

然后您可以从另一个`async`函数调用它作为`let thing = await getAThing();`.

但是，值得注意的是它`MongoClient`提供了一个连接池，因此您不应该在此方法中打开和关闭它。相反，`MongoClient.connect`在您的应用启动期间调用，然后将您的方法简化为：

```
async function getAThing() {
    return db.collection("Things").findOne({ name: "bob" });
} 
```

请注意，我们不是`await`在方法内调用，而是直接返回由`findOne`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-20T13:56:06.853

虽然它不是严格同步的，但我反复采用并发现非常有用的一种模式是在异步函数上使用[co](https://www.npmjs.com/package/co)和[promisify yield。](https://www.npmjs.com/package/promisify)对于 mongo，你可以重写上面的：

```
var query = co( function* () {

    var db = new mongo.Db("mydatabase", server, {});
    db = promisify.object( db );
    db = yield db.open();

    yield db.authenticate("myuser", "mypassword");

    var collection = yield db.collection("Things");
    return yield collection.findOne( { name : "bob"} );

});

query.then( result => {

} ).catch( err => {

} ); 
```

这表示：

1.  您可以使用任何异步库编写类似“同步”的代码
2.  回调会抛出错误，这意味着您不需要成功检查
3.  您可以将结果作为承诺传递给任何其他代码

# wpf - 缓慢加载 WPF

> ID：12030251
> 
> 赞同：2
> 
> 时间：2012-08-19T21:43:26.827
> 
> 标签：wpf

我一直在寻找加载缓慢的 wpf 表单的解决方案。似乎虚拟化应该可以帮助我，但我一定遗漏了一些东西。

我正在加载 35k 订单，加载需要 15 秒。我的猜测是虚拟化实际上并不适合我。

```
<UserControl x:Class="IntTranWin.Modules.Orders.OrderSummary.OrdersSummaryView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" mc:Ignorable="d" d:DesignHeight="300" d:DesignWidth="300">
  <ListView BorderThickness="0" Width="Auto" ItemsSource="{Binding Path=Orders.Items}" AlternationCount="2"
            IsSynchronizedWithCurrentItem="True" VirtualizingStackPanel.IsVirtualizing="True"
            VirtualizingStackPanel.VirtualizationMode="Recycling" ScrollViewer.IsDeferredScrollingEnabled="True">
    <ListView.ItemsPanel>
      <ItemsPanelTemplate>
        <VirtualizingStackPanel />
      </ItemsPanelTemplate>
    </ListView.ItemsPanel>
    <ListView.View>
      <GridView AllowsColumnReorder="true" ColumnHeaderToolTip="Orders">
        <GridViewColumn Header="Number" DisplayMemberBinding="{Binding Path=OrderNumber}" Width="65" />
      </GridView>
    </ListView.View>
  </ListView>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T18:28:12.653

谢谢你的建议。恐怕我提供的信息不完整。

我提供的 wpf 没有任何问题。问题在于禁用虚拟化的 GridView 的 ScrollViewer 样式。

```
<Style x:Key="{x:Static GridView.GridViewScrollViewerStyleKey}" TargetType="{x:Type ScrollViewer}">
<Setter Property="Template">
  <Setter.Value>
    <ControlTemplate TargetType="{x:Type ScrollViewer}">
      <Grid Background="{TemplateBinding Background}">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
          <RowDefinition Height="*" />
          <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <DockPanel Margin="{TemplateBinding Padding}">
          <ScrollViewer DockPanel.Dock="Top" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden"
                        Focusable="false">
            <Border CornerRadius="4" Background="{StaticResource DefaultedBorderBrush}" Padding="4" Margin="0,4,0,4">
              <GridViewHeaderRowPresenter Margin="2,0,2,0"
                                          Columns="{Binding Path=TemplatedParent.View.Columns,RelativeSource={RelativeSource TemplatedParent}}"
                                          ColumnHeaderContainerStyle="{Binding Path=TemplatedParent.View.ColumnHeaderContainerStyle,RelativeSource={RelativeSource TemplatedParent}}"
                                          ColumnHeaderTemplate="{Binding Path=TemplatedParent.View.ColumnHeaderTemplate,RelativeSource={RelativeSource TemplatedParent}}"
                                          ColumnHeaderTemplateSelector="{Binding Path=TemplatedParent.View.ColumnHeaderTemplateSelector,RelativeSource={RelativeSource TemplatedParent}}"
                                          AllowsColumnReorder="{Binding Path=TemplatedParent.View.AllowsColumnReorder,RelativeSource={RelativeSource TemplatedParent}}"
                                          ColumnHeaderContextMenu="{Binding Path=TemplatedParent.View.ColumnHeaderContextMenu,RelativeSource={RelativeSource TemplatedParent}}"
                                          ColumnHeaderToolTip="{Binding Path=TemplatedParent.View.ColumnHeaderToolTip,RelativeSource={RelativeSource TemplatedParent}}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
            </Border>

          </ScrollViewer>

          <ScrollContentPresenter Name="PART_ScrollContentPresenter" KeyboardNavigation.DirectionalNavigation="Local" />
        </DockPanel>

        <ScrollBar Name="PART_HorizontalScrollBar" Orientation="Horizontal" Grid.Row="1"
                   Maximum="{TemplateBinding ScrollableWidth}" ViewportSize="{TemplateBinding ViewportWidth}"
                   Value="{TemplateBinding HorizontalOffset}" Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" />

        <ScrollBar Name="PART_VerticalScrollBar" Grid.Column="1" Maximum="{TemplateBinding ScrollableHeight}"
                   ViewportSize="{TemplateBinding ViewportHeight}" Value="{TemplateBinding VerticalOffset}"
                   Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" />

      </Grid>
    </ControlTemplate>
  </Setter.Value>
</Setter> 
```

我还没想出解决办法。我可能不得不放弃样式并换一种不同的外观。

# mysql - 创建从多个表中获取数据的 SQL 查询 WHEN ID 在一个表中

> ID：12030252
> 
> 赞同：0
> 
> 时间：2012-08-19T21:43:30.727
> 
> 标签：mysql, sql

我正在尝试创建新闻提要，并且从以前的问题中找到了执行它的最简单方法，但不知道我应该在 SQL 中进行哪种查询。

我有一个标题为艺术家的表格，其中包含成员 ID、艺术家姓名和他们页面的 url，都需要检索。如果 ID 不在此表中，则不应将其包含在语句的输出中。

我有几个具有相似结构的表，例如曲目、状态和新闻。还有更多，但对于这个问题，我们将坚持这三个，我可以稍后添加更多。在这些表中是 ID 以及其他内容，我将在稍后提供这些内容。

第三个表是一个标题为事件。在将数据添加到我引用的任何其他表之后，数据通过触发器插入到此处。此表包含 ID、操作（例如“已上传曲目。”）和时间戳。

艺术家表；

```
CREATE TABLE `artists` (
`ID` int(11) NOT NULL,
`name` varchar(100) COLLATE latin1_general_ci NOT NULL,
`url` varchar(100) COLLATE latin1_general_ci NOT NULL,
`DP` varchar(200) COLLATE latin1_general_ci NOT NULL,
`timestamp` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,
UNIQUE KEY `url` (`url`),
UNIQUE KEY `DP` (`DP`),
KEY `ID` (`ID`),
CONSTRAINT `artists_ibfk_1` FOREIGN KEY (`ID`) REFERENCES `members` (`ID`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci 
```

曲目

```
CREATE TABLE `tracks` (
`ID` int(11) NOT NULL,
`url` varchar(200) COLLATE latin1_general_ci NOT NULL,
`name` varchar(100) COLLATE latin1_general_ci NOT NULL,
`timestamp` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,
`track_ID` int(11) NOT NULL AUTO_INCREMENT,
PRIMARY KEY (`track_ID`),
UNIQUE KEY `url` (`url`),
UNIQUE KEY `track_ID` (`track_ID`),
KEY `ID` (`ID`),
CONSTRAINT `tracks_ibfk_1` FOREIGN KEY (`ID`) REFERENCES `members` (`ID`)
) ENGINE=InnoDB AUTO_INCREMENT=111112 DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci 
```

消息

```
CREATE TABLE `news` (
`ID` int(11) NOT NULL,
`article` text COLLATE latin1_general_ci NOT NULL,
`timestamp` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,
KEY `ID` (`ID`),

) ENGINE=InnoDB DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci 
```

地位

```
CREATE TABLE `status` (
`ID` int(11) NOT NULL,
`status` varchar(300) COLLATE latin1_general_ci NOT NULL,
`timestamp` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,
KEY `ID` (`ID`),
CONSTRAINT `status_ibfk_1` FOREIGN KEY (`ID`) REFERENCES `artists` (`ID`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci 
```

活动

```
CREATE TABLE `events` (
`ID` int(11) NOT NULL,
`action` varchar(100) COLLATE latin1_general_ci NOT NULL,
`timestamp` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,
KEY `ID` (`ID`),
CONSTRAINT `events_ibfk_1` FOREIGN KEY (`ID`) REFERENCES `members` (`ID`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci COMMENT='This table shows what the artist has done and is used feed' 
```

我尝试过的查询失败了。这仅引用曲目和事件表。我不确定如何将其他表添加到查询中。

```
SELECT
T.url,
T.ID,

E.action,
E.ID,
E.timestamp

FROM tracks T
JOIN events E ON T.ID = E.ID
WHERE T.ID = E.ID AND E.action = 'has uploaded a track.'
ORDER BY E.timestamp DESC 
```

为了回答非常有效的评论，查询位于新闻提要的 AJAX 请求页面中。输出将类似于以下内容；

一位艺术家上传了曲目。
**跟踪在这里**
**格式化的时间戳在这里**

* * *

另一位艺术家有一些消息。
**新闻在这里**
**格式化的时间戳在这里**

* * *

希望这会给你一个想法。

它末尾的所有数据都应按时间戳排序。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:44:56.797

如果您有一个包含所有事件的表，以及您想要显示的消息，我很困惑为什么您必须加入任何其他表——也许除了您的成员表之外，这会给你是用户名。由于您希望每个事件都有自己的记录，因此不需要任何类型的聚合。（不过，如果您确实想为用户显示逗号分隔的操作列表，请查看[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)。）

例如像这样的查询：

```
SELECT
    CASE
      WHEN events.table_name = "tracks" THEN "has uploaded a track."
      WHEN events.table_name = "news" THEN "has some news."
    END AS description
  , events.action
  , DATE_FORMAT(events.when_it_happened, "%a %l%p") AS when_it_happened
  , members.username
  , members.ID
FROM events
INNER JOIN members ON (events.ID = members.ID)
WHERE events.when_it_happened >= NOW() - INTERVAL 5 DAY
ORDER BY events.when_it_happened DESC 
```

将为您提供所有用户在过去 5 天内执行的所有事件；最近的第一个。

# java - 覆盖二维数组列表

> ID：12030253
> 
> 赞同：0
> 
> 时间：2012-08-19T21:43:47.817
> 
> 标签：java, arrays, list, pass-by-reference

我有一个问题，我输入的数据正在写入列表中的所有元素而不是一个，我真的很难弄清楚为什么，感谢任何人的帮助..

```
public class Courts implements Serializable {

private static final long serialVersionUID = 1;
List<String[][]> allCourts = new ArrayList<String[][]>(10);

} 
```

这是我用来更改此列表的方法

```
public String bookCourt(int courtNo,int day,int time) throws RemoteException{
    String [][] tmp = court.allCourts.get(courtNo - 1);

    if(tmp[day-1][time-1].equals("Available")){

        tmp[day-1][time-1] = logged.name;

        court.allCourts.set(courtNo - 1,tmp);
        return "Your booking has been accepted, booking is on (" + court.courtNames[courtNo - 1] + 
                                                               "),(" + court.days[day - 1] + ") at ("
                                                               + court.times[time - 1]  + ").\n";
    }

    return "Court already taken by " + tmp[day-1][time-1] + ".\n";
} 
```

那里的格式有点不稳定，对此感到抱歉..

我认为这应该做的是从 courtNo-1 索引处的 allCourts 列表中获取 2D 数组，检查指定位置的字符串是否为“可用”以及是否将其设置为logged.name。

然后它应该采用这个更新的二维数组并用它覆盖列表中的数组，唯一的问题是它将名称或数组写入 allCourts 列表中的每个元素，我不知道为什么，再次感谢您提供的任何帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T21:54:57.013

我不确定它为什么会执行您提到的特定行为，因为对我来说，由于缺乏初始化，它看起来应该只是抛出 NullPointerExceptions。我猜在某个地方，您正在初始化`allCourts`，以便所有元素都是同一个数组。

但是，有些事情要记住。在 Java 中，数组只是一个对象，就像其他任何东西一样。`tmp`是对数组对象的**引用**，该对象也被存储在位置`courtNo-1`in的引用所引用`allCourts`。调用 set 不会覆盖数组，它会覆盖数组引用，它已经等于`tmp`. 所以`court.allCourts.set(courtNo - 1,tmp);`什么都不做。

# c - C 中的实例级抽象

> ID：12030261
> 
> 赞同：2
> 
> 时间：2012-08-19T21:44:32.123
> 
> 标签：c, unit-testing, design-patterns, function-pointers, instance-variables

我不是 C 专家。自从我的 CS1 和大学 2 天以来，我没有做过任何 C。我在这里和那里做了一点 C++，但已经有一段时间了。所以我要问的是解决我正在感知的问题的正确*模式。*

我决定接受一个相当雄心勃勃的挑战，我正在用 C 来做。我正在（重新）学习的一件事是 C 中的不同抽象技术与我习惯于使用高级语言的抽象技术。我遇到并询问的问题特别与测试和功能有关。

例如，我有两个函数`f`，如果某些条件为真`g`，`f`就会调用。`g`

```
void f(object* obj) {
  // ...
  if(obj->state)
    g(obj);
  // ...
} 
```

我需要验证它`g`实际上是被调用的，但我也不想实际执行它，因为它可以做各种各样的其他事情。这通常可以通过接口或抽象类或继承在更高级别的语言中解决。但是在 CI 中没有这些技术。

事实上，我能想到的解决这个问题的唯一方法是利用函数指针。而不是直接调用`g`，我认为我应该添加一个指向`object`它的指针，它有一个指向 的指针`g`，我可以用指向测试中不同函数的指针替换它。

```
typedef struct object {
  int state;
  void (*g)(object* obj);
} object;

void f(object* obj) {
  // ...
  if(obj->state)
    obj->g(obj);
  // ...
} 
```

然后通常我只是`g`在分配实例时指向，`g`但在我的测试中，我将 obj->g 指向不同的函数，该函数仅验证传入的值并注意它实际上被调用了。

这是我现在的想法，但我不确定这是否是解决这个问题的正确 C-ish 方法。希望我的描述能说明我遇到的问题，但我真正想知道的是如何最好地处理它。

在 C 中解决这个问题的推荐设计模式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:33:37.933

如果你想改变`g`在不同调用中调用的函数，也许你应该作为参数`f`传入：`g``f`

```
typedef void (*gFunc)(object* obj);

void f(object *obj, gFunc g) {
    ...
    if (obj->state) {
        g(obj);
    }
    ...
} 
```

如果你不想弄乱 的函数签名`f`，你可以定义一个版本`f`来调用上面的实现：

```
void gNormal(object* obj);           //normal implementation of g
void gTest(object* obj);             //test version of g

void fGeneral(object* obj, gFunc g); //general implementation of f as above

void fNormal(object* obj)            
{
    fGeneral(obj, &gNormal);         //use the default version of g
} 
```

从语言的角度来看，无论您选择此方法还是使函数指针`g`成为对象的成员，都可能大致相同——您需要考虑什么对您的对象结构更有意义。

再说一次，如果你正在做很多这样的事情，也许你应该使用面向对象的语言！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T21:59:37.493

如果您在编译时知道是否要进入测试用例，则可以有两种不同的 g 实现，它们通过预处理器宏进行控制，例如：

```
#ifdef TESTING

    int g() { // implement test version here }

#else

    int g() { // implement real version here }

#endif 
```

如果您只在编译时知道，则可以以相同的方式使用全局变量，但在同一函数定义中使用两个实现：

```
 int g() {
     if (gTesting) {
         // implement test version here
     }
     else {
         // implement real version here
     }
 } 
```

# android - 为 Android 构建 Autotools

> ID：12030266
> 
> 赞同：2
> 
> 时间：2012-08-19T21:45:58.733
> 
> 标签：android, gcc

也许你们中的一些人知道 GCC 4.7 有一个 Android 端口。

我已经对其进行了测试，并且效果很好，但是当“make”和“configure”不在图片中时，它就毫无用处了。

移植 Autotools 需要什么，包括制作和配置到 Android 本身？

如果你想知道世界上谁会在手机上开发，你会忘记一些平板电脑运行 Android，尽管我自己有手机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T13:43:41.670

make 不需要任何东西，只需要 C 库和 shell；configure 实际上是 shell 脚本，由 autoconf 生成，它又依赖于 awk、m4 和 diffutils。最难的部分是使用 autoconf 和 make 与 Android 内置的 shell，据说缺少很多功能。幸运的是，bash 的 Android 端口已经存在。

将 GNU 编程堆栈移植到 Android 最有问题的部分是未记录的文件层次结构（设备供应商倾向于随时修改它）和严重缺乏仿生库。有许多项目试图解决这个问题（例如[http://sourceforge.net/projects/droidoverlay/](http://sourceforge.net/projects/droidoverlay/)），但通常这个领域仍有待探索。

# c - 为什么“int i;”的位置 在这种情况下重要吗？

> ID：12030272
> 
> 赞同：2
> 
> 时间：2012-08-19T21:46:34.443
> 
> 标签：c, visual-studio

我正在自学 C，因为我的 uni 似乎对 java 很着迷，所以我编写了一个 int 类型的堆栈实现（我担心以后让它泛型）。我遇到了一个对我来说没有意义的错误，`missing ';' before 'type'`. 据我所知，我的语法是正确的，如果不是，请告诉。无论如何，这是我的代码：

堆栈.h

```
typedef struct{
    int *elements;
    int size;
    int capacity;
}Stack;

void newStack(Stack *s);
void delStack(Stack *s);
void pushToStack(Stack *s, int value);
int popFromStack(Stack *s); 
```

堆栈.c

```
#include "stack.h"
#include <stdlib.h>
#include <stdio.h>
#include <assert.h>

void newStack(Stack *s){
    s->size = 0;
    s->capacity = 4;
    s->elements = (int*) malloc(4 * sizeof(int));

    assert(s->elements != NULL); // allocation worked?
}

void delStack(Stack *s){
    free(s->elements);
}

void pushToStack(Stack *s, int value){
    if(s->size == s->capacity){
        s->size *= 2;
        s->elements = (int *) realloc(s->elements, s->size * sizeof(int));

        assert(s->elements !=NULL); //reallocation worked?
    }
    s->elements[s->size] = value;
    s->size++;
}

int popFromStack(Stack *s){
    assert(s->size>0);
    s->size --;
    return s->elements[s->size];
}

int main()
{
    Stack s1;
    newStack(&s1);
    int i;
    for(i=0; i<3; i++){
        pushToStack(&s1, i);
        printf("%d ", i);
    }
        printf("\n");
    for(i=0; i<3; i++){
        printf("%d ", popFromStack(&s1));
    }

    delStack(&s1);

    getchar();
    return 0;
} 
```

错误发生在主线上`int i;`，但如果我将线向上移动，错误就会消失，程序运行完美。我想知道为什么。

导致错误：

```
 newStack(&s1);
    int i; 
```

没有错误：

```
 int i;
    newStack(&s1); 
```

PS：以防万一……我正在使用 MS Visual Studio 2010

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-19T21:49:05.817

Visual Studio 在 1998 年之前的某个地方陷入了时间循环，当时标准要求所有声明都应位于块的开头。

这在 C99 中有所改变，MS 确实表示它支持最流行的功能。可悲的是，这不是其中之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T21:49:01.697

在 C 中，您必须在作用域的开头声明所有变量。所以你不能`i`在你`newStack`打电话后声明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T21:50:24.753

在 C89 中，声明是在作用域的顶部进行的，因此在任何其他函数调用之前。

然而，这个限制在 C99 中被删除了。

# ruby-on-rails - Ruby on rails before_filter 函数未执行

> ID：12030274
> 
> 赞同：0
> 
> 时间：2012-08-19T21:46:36.147
> 
> 标签：ruby-on-rails, before-filter, applicationcontroller

因此，我想对我的 rails 应用程序发出的每个请求执行一些代码，并通过谷歌搜索发现我可以使用 before_filter 来完成它。当我进入初始页面时，购买它似乎没有运行，即 localhost:3000。有谁知道为什么它不运行？

我在 Lubuntu Linux 上使用 Ruby on Rails 3、WebBrick 服务器。

```
class ApplicationController < ActionController::Base
  before_filter :run

  private
  def run
    logger.debug "run? I'm too tired"
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T21:49:26.067

如果您的初始页面是从公共目录提供的“静态”页面，则**不会**运行此代码。要解决此问题，请使页面呈现为某些控制器操作的结果，该操作继承自`ApplicationController`.

# preg-match - 使用 preg_match 匹配超链接图像

> ID：12030275
> 
> 赞同：0
> 
> 时间：2012-08-19T21:46:37.043
> 
> 标签：preg-match

一直在研究 preg_match 表达式以匹配超链接图像。需要使用 preg_match ，因为数据来自数据库，在以 html 呈现之前需要进行一些更改

这是我的匹配 experession 但这不会在下面的示例超链接上进行匹配。

```
 /<a\s[^>]*href=(\"??)([^\" >]*?)\\1[^>]*><img(.*)<\/a>/msU

 <a href="http://lifehacker.com/5936040/improvise-a-laptop-cooling-pad-with-plastic-bottle-caps"  caps"="" bottle="" plastic="" with="" pad"="" title="Click here to read Improvise a Laptop Cooling "> 
```

我（显然）没有看到的表达有什么问题吗？

谢谢。

# android - 没有启动活动的android putextra

> ID：12030276
> 
> 赞同：3
> 
> 时间：2012-08-19T21:46:42.680
> 
> 标签：android, database, listview, android-intent

我需要帮助。我有两个活动和一个分贝。我想要做的就是当我在活动 A 中按下一个按钮时，我将我的 editText 中的字符串发送到活动 B。在活动 B 中，我尝试将该字符串插入到我的数据库中并将其显示在列表视图中。如果我在活动 A 中启动活动 B，则一切正常，但我不会显示活动 B。

这是我的代码：

活动一：

```
public class Example extends Activity {

public final static String ID_EXTRA2="com.example.activities";
public EditText MyInputText = null;
ImageView MyButton;
TextView MyOutputText, MyInputtext;

 /** Called when the activity is first created. */
 @Override
 public void onCreate(Bundle savedInstanceState) {
 super.onCreate(savedInstanceState);
 setContentView(R.layout.diccionary);

MyInputText = (EditText)findViewById(R.id.InputText);
MyOutputText = (TextView)findViewById(R.id.OutputText);
    MyButton = (ImageView)findViewById(R.id.botonaceptar);
    MyButton.setOnClickListener(MyButtonOnClickListener);

 public ImageView.OnClickListener MyTranslateButtonOnClickListener = new ImageView.OnClickListener(){
 public void onClick(View v) {

    String InputString; 

    InputString = MyInputText.getText().toString();

    try{

    Intent d = new Intent(Example.this, Secondactivity.class);
           d.putExtra(ID_EXTRA2, InputString);

           //startActivity(d); <----- If i start the secondactivity, that works...

    }catch (Exception e){

        }

}
};

public boolean onCreateOptionsMenu(Menu menu){
    super.onCreateOptionsMenu(menu);
    MenuInflater awesome = getMenuInflater();
    awesome.inflate(R.menu.main_menu, menu);
    return true;

}
public boolean onOptionsItemSelected(MenuItem item){
    switch(item.getItemId()){
    case R.id.menu1:

        startActivity(new Intent("com.example.activities.SECONDACTIVITY"));
        return true;
        case R.id.menu2:

        //something to do
        return true;

}

    return false;
}

}; 
```

活动 B：

```
public class Secondactivity extends Activity  {

NoteAdapter2 adapter = null;
NoteHelper2 helper2 = null;
Cursor dataset_cursor2 = null;

String entriId = null;
public ListView list2;
String passedword = null;

@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.second);

    try{

    list2 = (ListView)findViewById(R.id.list2);

    helper2 = new NoteHelper2(this);

    ---->passedword = getIntent().getStringExtra(Example.ID_EXTRA2);

    ---->helper2.insert(passedword); //here i insert the string in my db

        startManagingCursor(dataset_cursor2);

        dataset_cursor2 = helper2.getAll();

    adapter = new NoteAdapter2(dataset_cursor2);

    list2.setAdapter(adapter);

    dataset_cursor2.requery();

    adapter.notifyDataSetChanged();

    //this is how we know to do when a list item is clicked

    list2.setOnItemClickListener(onListClick);

    }

    catch (Exception e){

    // this is the line of code that sends a real error message to the log

    Log.e("ERROR", "ERROR IN CODE" + e.toString());

    //this is the line that prints out the location in the code where the error ocurred
    e.printStackTrace();
    }

}

@Override
protected void onDestroy() {

    super.onDestroy();
    helper2.close();
}

private AdapterView.OnItemClickListener onListClick = new AdapterView.OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view, int position, long id){

        entriId = String.valueOf(id);

    }
};

class NoteAdapter2 extends CursorAdapter {
    NoteAdapter2(Cursor c){
        super(Zhistorytranslate.this, c);

    }

    public void bindView(View row2, Context ctxt, Cursor c) {
        NoteHolder2 holder2 = (NoteHolder2)row2.getTag();
        holder2.populateFrom2(c, helper2);
    }

    public View newView(Context ctxt, Cursor c, ViewGroup parent) {
        LayoutInflater inflater = getLayoutInflater();
        View row2 = inflater.inflate(R.layout.row2, parent, false);
        NoteHolder2 holder2 = new NoteHolder2(row2);

        row2.setTag(holder2);
        return (row2);
    }
    }
static class NoteHolder2 {
    private TextView entriText = null;

    NoteHolder2(View row2){
        entriText = (TextView)row2.findViewById(R.id.entri);

    }

    void populateFrom2(Cursor c, NoteHelper2 helper2) {
        entriText.setText(helper2.getEntri(c));
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-19T22:01:33.703

如果我理解正确，您希望在*不启动 B 的情况下将数据从 A 发送到 B*。在这种情况下，您需要忘记 Intent 并考虑一种在您的应用程序中[存储数据](http://developer.android.com/guide/topics/data/data-storage.html)的方法。我的建议是使用[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)。

以下是如何使用它：

*   在您的活动 A 中，存储字符串：

    ```
    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
    SharedPreferences.Editor editor = prefs.edit();
    editor.putString("string_id", InputString); //InputString: from the EditText
    editor.commit(); 
    ```

*   在您的活动 B 中，您可以通过以下方式获取价值：

    ```
    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
    String data = prefs.getString("string_id", "no id"); //no id: default value 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T21:58:09.817

您的问题很难理解，但您似乎希望能够在不启动另一个活动的情况下将 EditText 的内容添加到您的数据库中。只需在 Image 的 OnClickListener 中执行此操作：

```
public void onClick(View v) {
    NoteHelper2 helper2 = new NoteHelper2(this);
    helper2.insert(MyInputText.getText().toString());
} 
```

您还应该阅读[Java 命名约定](http://java.about.com/od/javasyntax/a/nameconventions.htm)。

# sync - 可以只下载 OpenStreetMap 数据的更新吗？

> ID：12030277
> 
> 赞同：1
> 
> 时间：2012-08-19T21:46:50.160
> 
> 标签：sync, openstreetmap

鉴于 OpenStreetMap 项目及其数据以及为客户提供离线地图的可能性，是否有一种既定方法可以仅下载每周更新的增量？

我正在考虑为智能手机（安卓优先）和网络客户端开发一个支持离线的应用程序。这将涉及下载该地区的 OSM 数据，这对于移动连接来说可能非常大。理想情况下，最初会进行大量下载，然后每周随着新 OSM 数据的更新，客户端将仅检索新数据或已更改的数据。

我还没有深入研究 OSM 的工作原理，看看这些数据是否包含时间戳。如果是这样，您理论上可以设置一个只能为 delta 服务的服务器。这个时候有人在做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T14:55:47.620

是的。请参阅wiki 中的[Planet.osm/diffs](http://wiki.openstreetmap.org/wiki/Planet.osm/diffs)。有可用的分钟、每小时和每日差异。

# vim - 使用 macOS Terminal.app 进入插入模式时如何更改 Vim 中的光标形状？

> ID：12030278
> 
> 赞同：4
> 
> 时间：2012-08-19T21:47:06.613
> 
> 标签：vim, terminal, xterm

在 Terminal.app 中运行的 VIM 中进入插入模式时，我想将光标形状从下划线更改为垂直。（注意：我知道这是 macvim 下的默认行为。）

此参考： http: [//vim.wikia.com/wiki/Change_cursor_shape_in_different_modes](http://vim.wikia.com/wiki/Change_cursor_shape_in_different_modes)提供了有关如何执行此操作的说明。例如，以下内容适用于 iterm2：

```
let &t_SI = "\<Esc>]50;CursorShape=1\x7"
let &t_EI = "\<Esc>]50;CursorShape=0\x7" 
```

不幸的是，这不适用于 Terminal.app（在 Lion 下）。

Terminal.app 是否有任何技巧 - 或者这只是不支持？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T06:33:06.083

我绝对确定我在过去看到过基于 Applescript 的解决方案，但 5 分钟的 google 并没有带来任何东西。这有点野蛮，但似乎奏效了…… IIRC 它动态更改了光标形状偏好，并由`autocmd`.

继续寻找，它在某个地方。

你有什么理由不想使用 iTerm 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-28T23:23:29.577

OP 在 2012 年 8 月提出了这个问题。当时 Terminal.app 不太可能支持将光标形状更改为垂直条的能力，因为 Terminal.app 作为一般规则提供的功能很少不模仿 xterm。（未记录的 OSC 6 和 7 是该规则的唯一例外）。

大约 6 周后， xterm[补丁 #282](https://invisible-island.net/xterm/xterm.log.html#xterm_282)引入了此功能，作为其仿真的扩展[`DECSCUSR`](https://invisible-island.net/xterm/ctlseqs/ctlseqs.html#h4-Functions-using-CSI-_-ordered-by-the-final-character-lparen-s-rparen:CSI-Ps-SP-q.1D81)：

> 扩展 DECSCUSR 以提供一种将光标设置为垂直条的方法（Paul Bolle 的补丁）。

记录如下：

```
CSI Ps SP q
          设置光标样式（DECSCUSR），VT520。
            Ps = 0 ⇒ 闪烁块。
            Ps = 1 ⇒ 闪烁块（默认）。
            Ps = 2 ⇒ 稳定块。
            Ps = 3 ⇒ 闪烁的下划线。
            Ps = 4 ⇒ 稳定的下划线。
            Ps = 5 ⇒ 闪烁条，xterm。
            Ps = 6 ⇒ 稳定条，xterm。

```

如类似问题（[*Customize vim cursor style under Mac OS X Terminal*](https://superuser.com/questions/712098/customize-vim-cursor-style-under-mac-os-x-terminal) , July 2017）中所示，您可以设置 vim 的变量以使用这些转义序列：

```
let &t_SI="\033[6 q" " start insert mode (steady bar, xterm)
let &t_EI="\033[1 q" " end insert mode 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-26T05:17:42.437

我自己也遇到了类似的问题，发现这个答案有帮助：

[https://superuser.com/questions/712098/customize-vim-cursor-style-under-mac-os-x-terminal](https://superuser.com/questions/712098/customize-vim-cursor-style-under-mac-os-x-terminal)

当我开始在 tmux 中运行 vim（仍然使用终端）时，更改光标的命令开始工作！

Tmux 是一个非常酷的终端管理器，它可以让你拥有多个终端窗口、选项卡、分屏，你可以命名它，以及保存你的会话。这是我用来安装它并且有用的一个很好的教程：

[http://fideloper.com/mac-vim-tmux](http://fideloper.com/mac-vim-tmux)

# java - 如何从本机 IOS 应用程序与 Java servlet 通信

> ID：12030279
> 
> 赞同：0
> 
> 时间：2012-08-19T21:47:09.457
> 
> 标签：java, ios, stripes

我们制作了一个 HTML5 移动应用程序，现在我们正在创建一个 IOS 原生应用程序。我们希望 IOS 应用程序调用 Java servlet（带有条纹）（运行 HTML5 应用程序）上的方法，以便我们可以使用相同的幕后逻辑。我们是否需要设置 Web 服务来执行此操作？

IE 我们只想从 IOS 调用现有的 Stripes 动作 bean（因为它们已经设置为接收 ajax 请求，但这会违反跨域法）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:08:30.733

如果您从本机应用程序发出请求，跨域不是问题，因此应该可以直接向您的 AJAX ActionBeans 发出请求。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-19T22:06:18.293

您可以使用 API 直接调用逻辑并获取响应。将 servlet 映射到您需要的 url 模式。然后在 servlet 中扩展 HttpServlet 并覆盖 doGet 和 doPost 方法，该方法以 HttpServletRequest 和 HttpServletResponse 作为输入参数，可用于与您的移动应用程序进行通信。

# krl - 在 KRL/Kynetx 中打开和控制新窗口

> ID：12030281
> 
> 赞同：0
> 
> 时间：2012-08-19T21:47:22.577
> 
> 标签：krl

我想通过单击一个按钮（通过 Kynetx 注入）打开一个新窗口，但我希望这个新窗口在 Kynetx 沙箱环境中运行。这是因为新窗口将有一个与 REST API 对话的按钮，我想避免浏览器同源策略。我还想修改这个新窗口的 DOM。

```
//code in Kynetx extension
ruleset a2031x3 {
meta {
    name "Open a new window (SO 12030281)"
    description << >>
    author "Steve Nay"
    logging off
}

dispatch { 

    domain "exampley.com"

    }

global { }

rule first_rule {
    select when pageview ".*" setting ()
    emit <|
        // Open a new window and write some content
        var newContent = 'some content';
        newWin = window.open();
        newWin.document.write(newContent);
    |>;        
 }
} 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T23:09:39.387

您需要将该 JavaScript 代码包装在一个`emit`块中，如下所示：

```
ruleset a000x0 {
    meta {
        name "Open a new window (SO 12030281)"
        description << >>
        author "Steve Nay"
        logging off
    }

    dispatch { }

    global { }

    rule first_rule {
        select when pageview ".*" setting ()
        emit <|
            // Open a new window and write some content
            var newContent = 'some content';
            newWin = window.open();
            newWin.document.write(newContent);
        |>;        
    }
} 
```

这将打开一个您想要的弹出窗口，并且`write()`调用成功：

![弹出窗口，](../Images/a9386f212a0cad9d60f0fa74cb48e0e5.png)

# php - jQuery Mobile 中的 PHP 标头重定向

> ID：12030284
> 
> 赞同：1
> 
> 时间：2012-08-19T21:47:34.703
> 
> 标签：php, jquery-mobile, header, redirecttoaction

我正在开发一个 jquery 移动网络应用程序，并在我需要用户登录的页面上使用 php 进行会话检查。如果没有，用户将被重定向到 login.php?r=L29yZGVyLnBocD9kZWFsX2lkPTEwMDM2MjM= (base64_encode($_SERVER['REQUEST_URI']) 登录。登录后他必须被重定向到他实际请求的页面。

不幸的是，JQM 没有更新 URL，所以我无法获取 GET 参数 ?r=.... 因为它不存在。只需重新加载页面 (F5) 即可更新 url。

如果用户未登录，这里是执行重定向的 sessioncheck 代码：

```
if(!isset($_SESSION["member"]) || (isset($_SESSION["member"]) && (int)$_SESSION["member"]["member_id"]==0)){
unset($_SESSION["member"]); 
Header("Location: " . SITE_ROOT . "/login.php?r=".base64_encode($_SERVER['REQUEST_URI']));
exit; 
```

}

你们有什么建议告诉 jQuery mobile 目标已更改。当然，我的重定向发生在 DOCTYPE 标记之前

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T07:59:21.637

您是否在页面 div 中指定了一个`data-url`属性？

```
<div data-role="page" data-url="/login" id="login-page"> 
```

# html - css - 侧边栏 - 具有固定定位的背景图片

> ID：12030290
> 
> 赞同：0
> 
> 时间：2012-08-19T21:48:52.550
> 
> 标签：html, css

我有一个用于我正在开发的网站的标准模板，该模板是一个带有可移动左侧栏的标准页面。

这是页面：

![在此处输入图像描述](../Images/2018a707f42ed06142aacdd30079a10f.png)

但是，当用户滚动到底部时：

![在此处输入图像描述](../Images/c19b9fd352defd02ed5797a5a033ec3f.png)

我使用了边框，因此您可以看到页面的底部。

如果您明白我的意思，我似乎找不到导致此问题或未解决此问题的类。

这是该网站的链接：

[https://accounts.dpwebdev.co.uk/dashboard/](https://accounts.dpwebdev.co.uk/dashboard.php)

任何想法将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T21:56:34.683

`maincontainer`和之间`cboxOverlay`有一些空格。

只需删除它们。

或者您可以添加

```
.sidebar_inner{
   background-color:#F1F1F1;
} 
```

# python - Python chatserver - 由于阻塞呼叫而无法关闭服务器

> ID：12030295
> 
> 赞同：0
> 
> 时间：2012-08-19T21:49:16.237
> 
> 标签：python, sockets, blocking

我正在用 Python 编写一个聊天服务器来完成一项任务。但是，我在关闭服务器时遇到问题。这是正在发生的事情：

当客户端连接时，我生成两个线程：`readThread`和`writeThread`. `readThread`负责从客户端读取数据并将其打印到`stdout`，并`writeThread`负责从客户端读取消息`stdin`并将其发送给客户端。

当客户端发送`'EXIT'`时，我想关闭服务器。我`writeThread`在这样的循环中运行：

```
def write(self) :
        while self.dowrite :
            data = sys.stdin.readline().strip();            
            self.conn.send(data);
        print 'WriteThread loop ended'; 
```

现在，当我收到 时`EXIT`，我设置`dowrite`为 false，但是，当然，这不会因为阻塞调用而中断 while 循环`sys.stdin.readline().strip()`。

所以，会发生什么：断开连接，客户端需要发送`EXIT`，然后我需要在控制台上点击返回。有什么办法可以解决这个问题，这样当客户端发送退出消息时，我会立即跳出`write()`.

**编辑** 它是如何结合在一起的：

主线程产生两个线程 :`read`和`write`，然后等待（连接）`read`完成。`Read`当它读取时完成`EXIT`。线程一`read`结束，主线程就会继续并`dowrite`在写线程中设置为 false，这应该结束写循环，但这只能在 while 循环再迭代一次时发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:45:08.733

使子线程成为守护进程：

```
t.daemon = True 
```

如果您的程序退出，守护线程将停止。

您可以使用[事件](http://docs.python.org/library/threading#event-objects)来通知其他线程。在事件发生的线程中：

```
event.set() # event occurred 
```

在其他线程中：

```
event.wait() # wait for event 
```

# html - 防止在评论中显示html标签

> ID：12030296
> 
> 赞同：1
> 
> 时间：2012-08-19T21:49:17.990
> 
> 标签：html

我正在寻找一种方法来防止在评论中显示 html 标签，例如，如果用户放置一个 html 标签，例如`<br>`或`<hr>`不显示水平行或换行符，就按原样显示（打印输出`<br> or <hr>`：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-19T21:50:50.837

您应该使用它[`htmlspecialchars()`](http://php.net/manual/en/function.htmlspecialchars.php)来防止这种情况。这也将防止[XSS 攻击](http://en.wikipedia.org/wiki/Cross-site_scripting)。

[http://codepad.viper-7.com/w5U8qs](http://codepad.viper-7.com/w5U8qs)

# wpf - WPF中如何实现metro用户区？

> ID：12030299
> 
> 赞同：0
> 
> 时间：2012-08-19T21:49:57.650
> 
> 标签：wpf, microsoft-metro

[http://ledfrog.com/uploads/2011/06/zune-sw-screenshot-client-mossyroc.jpg](http://ledfrog.com/uploads/2011/06/zune-sw-screenshot-client-mossyroc.jpg)

我希望我的用户能够登录并访问他的个人资料，就像在右上角的最小化/最大化/关闭按钮下方的那个 zune 软件屏幕截图中显示的一样。

[感谢MahApps.Metro](http://mahapps.com/MahApps.Metro/)库，我已经设置了 Metro 窗口。当用户（感谢 Syncfusion 的 Metro Studio 在 XAML 中完成）尚未登录并且我可以轻松登录用户时，我给自己做了一个很好的地铁图标。我现在面临的问题是图标是在 XAML 中完成的，但是每个用户的图片都在远程存储的位图中。是否有可以动态托管 XAML 或位图的控件？还是我必须将图标光栅化为纯png？另外，有没有一种方法可以将构成图标的 XAML 存储在另一个文件中，这样我就不必将它嵌入到我的窗口的 XAML 文件中？

在旁注中，我不希望对图标进行光栅化以避免像素化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:21:26.983

回答我自己的问题：

使用 App.xaml ResourceDictionary 条目，我可以存储该工具生成的 XAML，然后使用一个矩形，将其填充属性设置为一个视觉刷，其视觉属性设置为 {StaticResource xxx}，其中 xxx 是我放在资源字典。用户登录后，我只是将画笔的视觉属性替换为指向用户头像的url的图像。

问题解决了。

# c# - 匿名函数/委托？

> ID：12030301
> 
> 赞同：1
> 
> 时间：2012-08-19T21:50:48.320
> 
> 标签：c#, delegates, c++-cli, anonymous-function

我正在将我的 C# Windows 应用程序转换为 C++\CLI 应用程序。

我坚持“转换”这段代码：

```
void LoadWindow(Mode mode) {
        if (timer != null && timer.Enabled) return;

        int currentIndex = Windows.IndexOf(panel.Controls[0]);
        int loadInex = 0, exitLeft = 0, entranceLeft = 0, stopLeft = 0;

        if (mode == Mode.Next)
        {
            loadInex = currentIndex == Windows.Count - 1 ? 0 : ++currentIndex;
            exitLeft = -((panel.Width / 2 - Windows[currentIndex].Width / 2) + Windows[currentIndex].Width);
            entranceLeft = panel.Width;
        }
        else
        {
            loadInex = currentIndex == 0 ? Windows.Count - 1 : --currentIndex;
            exitLeft = panel.Width;
            entranceLeft = -panel.Width;
        }

        stopLeft = panel.Width / 2 - Windows[loadInex].Width / 2;

        Windows[loadInex].Left = entranceLeft;
        panel.Controls.Add(Windows[loadInex]);

        timer = new System.Windows.Forms.Timer();
        timer.Interval = 10;
        timer.Tick += new EventHandler(delegate(object sender, EventArgs e) {
            if (mode == Mode.Next)
            {
                if (exitLeft <= panel.Controls[0].Left)
                    panel.Controls[0].Left -= 50;

                if (stopLeft <= panel.Controls[1].Left)
                    panel.Controls[1].Left = panel.Controls[1].Left - 50 < stopLeft ? stopLeft : panel.Controls[1].Left - 50;

                if (exitLeft >= panel.Controls[0].Left && stopLeft >= panel.Controls[1].Left)
                {
                    panel.Controls.RemoveAt(0);
                    timer.Enabled = false;
                }
            }

            if (mode == Mode.Previous)
            {
                if (exitLeft >= panel.Controls[0].Left)
                    panel.Controls[0].Left += 50;

                if (stopLeft >= panel.Controls[1].Left)
                    panel.Controls[1].Left = panel.Controls[1].Left + 50 > stopLeft ? stopLeft : panel.Controls[1].Left + 50;

                if (exitLeft <= panel.Controls[0].Left && stopLeft <= panel.Controls[1].Left)
                {
                    panel.Controls.RemoveAt(0);
                    timer.Enabled = false;
                }
            }
        });

        timer.Enabled = true;
    } 
```

AFAIK C++\CLI 不支持匿名方法（我什至不能利用 lambdas）。

如果 EventHandler 委托没有在 LoadWindow 函数中使用局部变量，这不会成为问题。

我该如何实施？我考虑过使用一个简单的仿函数类，但有没有更“优雅”的方式？

谢谢，亚历克斯

# travis-ci - 为什么我的 travis-ci 构建状态总是反映为未知？

> ID：12030304
> 
> 赞同：20
> 
> 时间：2012-08-19T21:51:14.653
> 
> 标签：travis-ci, github-services

[我为一个新的rails 项目](https://github.com/briandavidwetzel/white_dog)设置了 travis-ci ，但由于某种原因，构建状态在我的 README 中总是显示为未知。我用谷歌搜索了一下，找不到任何解决方案。虽然我和其他人有一些类似的症状。例如，[我所有的构建](http://travis-ci.org/#!/briandavidwetzel/white_dog)都显示它们仍在构建，但是如果您查看各个构建，它们是通过还是失败。

顺便说一句，这应该被报告为 travis-ci 问题吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-09T10:42:25.150

我遇到了同样的问题。我能够通过将`branch`参数添加到图像 url 来解决这个问题：

**此网址无效**

```
https://travis-ci.org/kandadaboggu/iprofiler.png 
```

**这个网址有效**

```
https://travis-ci.org/kandadaboggu/iprofiler.png?branch=master 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-01-13T18:02:18.073

**.com 在这里不起作用，根据最新的。这对我有用**

```
## Travis-Build
[![Build Status](https://api.travis-ci.org/sananand007/genTspsolver.png?branch=master)](https://travis-ci.org/sananand007/genTspsolver) 
```

> ## Travis-构建
> 
> [![构建状态](../Images/b2d53b8130d3e912c909c65fe080cc42.png)](https://travis-ci.org/sananand007/genTspsolver)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-02T14:52:19.683

就我而言，截至 2018 年 5 月，我使用的链接基于 travis-ci.org，所有链接都应使用 travis-ci.com

看到[这个公告](https://blog.travis-ci.com/2018-05-02-open-source-projects-on-travis-ci-com-with-github-apps)

**这个注册未知**

`https://travis-ci.org/jlboat/FastaUtils.png?branch=master`

**本次登记通过**

`https://travis-ci.com/jlboat/FastaUtils.png?branch=master`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-02-05T21:55:38.253

我在 Github 的项目自述文件中使用了 Travis 徽章，我遇到了同样的问题。原来我在 Travis 中没有正确的设置。

在 Travis 仪表板中，转到更多选项 => 设置。对我来说，我需要打开“构建推送分支”。之后，我点击了更多选项 => 触发构建，并触发了构建。

一旦 Travis 跑（并通过），我就回到 Github 并努力刷新页面。Travis 徽章已更新为绿色，即“构建：通过”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-14T17:42:22.503

我的问题是，在我将应用程序公开而不是私有之后，这是我在 travis-ci.org 上的第一个构建。我只需要等待图像更新以反映新的构建状态，这需要几分钟。它是 .org 上的免费服务，而不是 travis-ci.com 上的付费服务，因此我们必须等待共享资源来创建构建状态图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-15T08:15:27.597

`image url`在我的情况下，通过打开浏览器解决了这个问题。您可以通过单击项目仪表板上的构建状态徽章`image url`从弹出窗口中获取。在浏览器上完全加载`Status Image`后，构建状态立即更改。`image url`比如[点我](https://api.travis-ci.org/yohaneslumentut/ng-ripple-module.svg?branch=master)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-18T09:22:43.403

遵循一个简单的规则：使用 travis 存储库仪表板的链接。
在我的情况下`https://travis-ci.com/<username>/<repository>`

# delay - for 循环产生的延迟

> ID：12030305
> 
> 赞同：0
> 
> 时间：2012-08-19T21:51:27.697
> 
> 标签：delay, microcontroller, 8051

`//say delay_ms = 1`

`void Delay(const unsigned int delay_ms)`

```
{
unsigned int x,y;
for(x=0;x<delay_ms;x++)
{
    for(y=0;y<120;y++);
} 
```

}

我正在尝试将上面的 C 代码用于我的 8051 微控制器。我想知道上面产生的延迟时间是多少。我正在使用 12MHz 振荡器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T10:06:45.873

这是产生时间延迟的真正糟糕的方式。

如果您查看编译器生成的汇编程序，然后从您正在使用的处理器变体的数据表中，您可以查找列表中每条指令所需的时钟周期。将这些加起来，您将获得此代码将产生的最小延迟时间。

如果您在处理器上启用了中断，则延迟时间将被延迟期间触发的任何中断处理程序的执行时间延长。这些将根据每个中断的频率和处理要求为每个延迟函数调用添加一个基本上随机的时间量。

8051 内置硬件定时器/计数器，旨在在用户可编程延迟后产生信号。这些不受中断处理的影响（确实，它们的触发事件的服务可能会被另一个中断源延迟），因此为延迟提供了更可靠的持续时间。

# android - Android 上的 ListView 设计

> ID：12030308
> 
> 赞同：0
> 
> 时间：2012-08-19T21:51:50.347
> 
> 标签：android, android-listview

这是我在 上显示`user's information`的XML `ListView`，所以目前它包含两个`TextView`我正在显示用户信息的 XML。

**问题陈述：-**

每当我运行我的应用程序时，我总是看到我的两个`Text View`并排出现。例如，我总是得到类似下面的东西 -

```
SomeImage             TextView1             TextView2 
```

这是我不想要的。我需要这样的东西 - 假设我将来有三个 TextView。

```
SomeImage             TextView1

                      TextView2

                      TextView3 
```

下面是我目前正在使用的 XML 文件。如何修改它以便始终获得所需的输出？

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <ImageView
        android:id="@+id/image"
        android:layout_width="50dip"
        android:layout_height="50dip"
        android:scaleType="centerCrop"
        android:src="@drawable/stub" />

    <TextView
        android:id="@+id/text"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="left|center_vertical"
        android:layout_marginLeft="10dip"
        android:layout_weight="1"
        android:textSize="10dip" />

    <TextView
        android:id="@+id/text1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="left|center_vertical"
        android:layout_marginLeft="10dip"
        android:layout_weight="1"
        android:textSize="10dip" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T22:10:44.950

尝试这个：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:padding="10dp" >

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="50dip"
    android:layout_height="50dip"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginRight="10dp"
    android:src="@drawable/stub" />

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignTop="@+id/imageView1"
    android:layout_toRightOf="@+id/imageView1"
    android:text="TextView1" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView1"
    android:layout_toRightOf="@+id/imageView1"
    android:text="TextView2" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView2"
    android:layout_toRightOf="@+id/imageView1"
    android:text="TextView3" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T22:14:15.053

`LinearLayout`的方向默认是*[水平的](http://developer.android.com/reference/android/widget/LinearLayout.html#attr_android%3aorientation)*。只需将此行添加到您的`<LinearLayout>`

```
android:orientation="vertical" 
```

# php - 通过一个键对对象数组进行排序和搜索

> ID：12030309
> 
> 赞同：-1
> 
> 时间：2012-08-19T21:51:59.100
> 
> 标签：php, arrays, search, sorting

```
$data = Array ( 
           [0] => stdClass Object ( [ID] => 1 [top_level] => gold [sub_level] => coal ) 
           [1] => stdClass Object ( [ID] => 3 [top_level] => bronze [sub_level] => dirt ) 
           [2] => stdClass Object ( [ID] => 4 [top_level] => silver [sub_level] => aluminum ) 
    ) 
```

使用 PHP，我如何排序，例如，通过 [sub_level] 升序（或降序）来生成以下内容？

```
Array ( 
       [0] => stdClass Object ( [ID] => 4 [top_level] => silver [sub_level] => aluminum ) 
       [1] => stdClass Object ( [ID] => 1 [top_level] => gold [sub_level] => coal ) 
       [2] => stdClass Object ( [ID] => 3 [top_level] => bronze [sub_level] => dirt )  
) 
```

此外，在 [sub_level] 中搜索特定值的最有效方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T21:58:16.987

您可以使用[`usort`](http://php.net/usort). 在函数中，比较您想要的两个属性并返回适当的值。有关更多信息，请参阅[建议的副本](https://stackoverflow.com/questions/2146749/how-do-i-sort-the-following-array-stdclass-object-in-php)。

# algorithm - 如何将主要变体搜索与 negamax 一起用于跳棋游戏？

> ID：12030310
> 
> 赞同：0
> 
> 时间：2012-08-19T21:52:05.483
> 
> 标签：algorithm, artificial-intelligence

我正在 j2me 中开发跳棋游戏。到目前为止，我正在使用 Negamax，但它太慢了（带有 alpha-beta 截止）。我正在搜索 Stack 并开始了解术语“主要变体搜索”。帖子有这个链接：[国际象棋编程](https://chessprogramming.wikispaces.com/Principal+Variation)

我正在使用的 negamax 是这样的：

```
 public double Negamax(int[] board, int depth, int turn, double alpha, double beta){
//check for depth, if its zero then call evaluation()
//generate moves
newScore = -Negamax(newBoard, depth - 1, opponent(turn), -beta, -alpha);
//alpha-beta cutoff
} 
```

**问题：** 来自 Wiki 的 Puesocode 是：[pvs](http://en.wikipedia.org/wiki/Negascout)

现在我很困惑如何使用pvs。我应该在 negamax 内使用它，还是代替 negamax。它的标题也令人困惑，因为它接受一个节点，而不是整个黑客板。

```
function pvs(node, depth, α, β) 
```

我不愿意使用转置表，因为我正在开发一个移动应用程序。谢谢

# python - 从 FASTA 文件中计算二氨基酸频率（Bigram 频率）

> ID：12030312
> 
> 赞同：-1
> 
> 时间：2012-08-19T21:52:47.167
> 
> 标签：python, bioinformatics, biopython, n-gram, fasta

给定大量的 FASTA 文件（用于分泌肽的各种生物的肽组），我如何使用 Python（或 Matlab）读取 FASTA 文件（来自 UNIProt），并计算每个氨基酸的频率，和氨基酸“双”配对？

（IE - 输出应该有每个单独氨基酸的百分比（22 个字母/字符中）和氨基酸配对的频率。

实际上，我想计算字母对的二元组（或 n-gram，如果易于实现）频率。

在 FASTA 文件中，这 22 个氨基酸分别由一个唯一的字母表示，每个蛋白质的名称在其行前以 > 开头。（已经解析过了，所以只剩下相关的字符）

> 文件样本：
> 
> FFKA
> 
> FLRN
> 
> MTTVSYVTILLTVLVQVLTSDAKATNNKRELSSGLKERSLSDDAPQFWKGRFSRSEEDPQ FWKGRFSDPQFWKGRFSDPQFWKGRFSDPQFWKGRFSDPQFWKGRFSDPQFWKGRFSDPQ FWKGRFSDGTKRENDPQYWKGRFSRSFEDQPDSEAQFWKGRFARTSSGEKREPQYWKGRF SRDSVPGRYGRELQGRFGRELQGRFGREAQGRFGRELQGRFGREFQGRFGREDQGRFGRE DQGRFGREDQGRFGREDQGRFGREDQGRFGREDQGRFGRELQGRFGREFQGRFGREDQGR FGREDQGRFGRELQGRFGREDQGRFGREDQGRFGREDLAKEDQGRFGREDLAKEDQGRFG REDIAEADQGRFGRNAAAAAAAAAAAKKRTIDVIDIESDPKPQTRFRDGKDMQEKRKVEK KDKIEKSDDALAKTS

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T01:17:23.183

这看起来怎么样？

```
>>> sequence = "LTSDAKAARFSDPQFWKGRFSDPQFWKGRSAAKGRFARTSSGAAEKREPQAAYWKGRF "
>>> occurrenceAA = str(sequence.count("AA"))   # counting occurence of n-aminos
>>> percent_occurrenceAA = float(occurrenceAA)/len(sequence)*100   # calculate percent total of protein
>>> print occurrenceAA, " Double-alanines in your sequence"
4 Double-alanines in your sequence
>>> print round(percent_occurrenceAA,2), " % of total"   # rounding off % to 2 decimal places
6.78  % of total 
```

# c++ - c++ builder - 显示不带标题的字节数组颜色信息

> ID：12030313
> 
> 赞同：0
> 
> 时间：2012-08-19T21:52:49.313
> 
> 标签：c++, image, bytearray, c++builder

我有一个 Byte* 类型的 RGB 字节信息数组。
我可以使用电晕库将它保存到 PNG 文件中。
但是，我想以某种方式在 TImage-Object 上显示 Bytearray 而不必每次都保存和加载文件......
我已经找到了 memorystream 的解决方案

```
Byte* pBuffer;//data
long cbBuffer;//length of data
TMemoryStream *tmem=new TMemoryStream();
tmem->Write(pBuffer,cbBuffer);
TPngImage *saf=new TPngImage();
saf->LoadFromStream(tmem); 
```

然而，这抱怨缺少标题，因为 bytearray 没有标题。
所以，我想创建一张空白图片并在上面绘制像素信息......

```
Graphics::TBitmap *Bitmap = new Graphics::TBitmap();  
Bitmap->Width = pVih->bmiHeader.biWidth;               
Bitmap->Height = pVih->bmiHeader.biHeight;              
for(int j=0;j<pVih->bmiHeader.biHeight;j++){
    Byte* y=(Byte*) Bitmap->ScanLine[j];
    for(int x=0;x<pVih->bmiHeader.biWidth;x++)
        y[x]=pBuffer[j*pVih->bmiHeader.biWidth+x];
}
Image1->Picture->Graphic=Bitmap;
Application->ProcessMessages(); 
```

但是，这保持空白。而且我真的不喜欢画像素，即使使用更快的 ScanLine ......

那么，有人知道如何在 TImage-Object 中显示颜色的 Bytearray 吗？
如果有一个整洁的库，你也可以建议它，但我尝试使用 pnglib 几次，我似乎不知道如何使用它。
我正在使用 Embarcadero 的 XE2 16 中的 C++Builder。

问候，
朱利安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:44:28.290

事后看来，可能有必要告诉我我收到的是 pf24Bit 图片......

而且，当然，因为它不是一个，而是每个像素 3 个字节，所以缺少因子 3：

```
TBitmap *Bitmap = new TBitmap();  
Bitmap->Width = pVih->bmiHeader.biWidth;              
Bitmap->Height = pVih->bmiHeader.biHeight;
Bitmap->PixelFormat=pf24bit;
for(int j=0;j<Bitmap->Height;j++){
    Byte *y=(Byte*)Bitmap->ScanLine[j];
    for(int x=0;x<Bitmap->Width*3;x++){
        y[x]=pBuffer[j*Bitmap->Width*3+x];
    }
}
Image1->Picture->Bitmap->Assign(Bitmap); 
```

它仍然有点慢，但我想我无法直接访问位图中的颜色字节......

# java - phonegap jquery 移动应用程序和 java 服务器之间的双向通信

> ID：12030314
> 
> 赞同：0
> 
> 时间：2012-08-19T21:53:07.680
> 
> 标签：java, jquery, ajax, cordova, publish-subscribe

任何人都可以建议我如何解决这个问题。

我希望在 phonegap 上的 jquery 移动应用程序和 java 服务器之间建立双向通信。

可以建立发布/订阅通信吗？

有没有办法使用JMS？

我尝试过 websockets，但我觉得它缺乏控制，即：我无法找到一种方法来列出服务器上连接的客户端数量等。这可能是因为我对 web sockets 缺乏了解，但是 web插座对我来说看起来欠发达。

有什么建议么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-30T08:17:20.393

双向通信可以通过 PhoneGap 底层的 Cordova 机制实现。为此，您应该编写自己的插件。

从 JavaScript 到本机应用程序的通信非常简单，并在此处记录： [https](https://cordova.apache.org/docs/en/5.0.0/guide_hybrid_plugins_index.md.html#Plugin%20Development%20Guide)
://cordova.apache.org/docs/en/5.0.0/guide_hybrid_plugins_index.md.html#Plugin%20Development%20Guide 要点是使用cordova.exec() 方法触发插件中的相应功能。

此处记录了从本机到 JavaScript 的通信： [how to send data or message from java application / plugin to javascript with cordova / phonegap](https://stackoverflow.com/questions/27219376/how-to-send-data-or-message-from-java-application-plugin-to-javascript-with-co)

> 您可以随时从 java 执行 javascript 执行此操作：
> 
> 字符串 js = "alert('test')"; webView.loadUrlNow("javascript:" + js);
> 
> 或者您可以初始化插件并保持回调这样做
> 
> PluginResult pgRes = new PluginResult(PluginResult.Status.OK, "message"); pgRes.setKeepCallback(true); callbackContext.sendPluginResult(pgRes);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T02:07:15.873

PhoneGap 建立在所有受支持平台的系统 Web 视图之上……您可以在 Web 视图内部做的最好的事情是 Web 套接字（在支持的情况下），或短时间间隔轮询。如果这不适合，您可以创建一个本机插件来利用基于 JS 的应用程序中的本机代码/本机通信库。问题是本机插件必须用本机代码（iOS 的 obj-c，Android 的 java 等）编写，并且不是跨平台的，但可以做到。您可以在此处阅读有关本机插件的更多信息：http: [//docs.phonegap.com/en/2.0.0/guide_plugin-development_index.md.html#Plugin%20Development%20Guide](http://docs.phonegap.com/en/2.0.0/guide_plugin-development_index.md.html#Plugin%20Development%20Guide)

# php - PHP 在乘法运算后返回 0

> ID：12030315
> 
> 赞同：1
> 
> 时间：2012-08-19T21:53:10.117
> 
> 标签：php, integer

我需要将值临时存储在 PHP 变量中，因为该值应与注释一起发送。用户不能在不输入评论的情况下发送评分，这就是我决定这样做的原因。

为什么当 PHP 计算值时我的变量返回值为零？

我有这个代码：

`<a href='#' onclick='rate(1); return false;' class='one-star'>1</a>`

```
<script type="text/javascript">
     function rate (amnt){
     <?php
         $currentRating = amnt;
         $ratingImageWidth = $currentRating * 25;
         echo "alert($ratingImageWidth)";
     ?>
     }
</script> 
```

笔记：

*   它输出 0 的警报；*   `$currentRating`变量不为空，我尝试将它包含在警报函数中，它返回正确的值。*   我尝试了这些将`$currentRating`变量转换为int：*   `settype($currentRating, "integer");`*   `(int)$currentRating;`

    什么也没发生，它仍然返回零。有谁知道如何解决这个问题？非常感谢那些愿意提供帮助的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T21:56:45.083

PHP 在服务器上运行，所以你的 JavaScript 实际上看起来像：

```
function rate(amnt) {
    alert(0) 
```

令人惊讶的是，考虑到`}`最后的失踪，它完全有效......

关键是，你不能以这种方式混合 PHP 和 JS。你为什么不做`alert(amnt*25)`呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T21:57:52.420

你为什么要为此使用 PHP？只需在javascript中进行计算：

```
<script type="text/javascript">
     function rate (amnt){
         var ratingImageWidth = amnt * 25;
         alert(ratingImageWidth);
     }
</script> 
```

PHP 在浏览器加载页面之前在服务器上运行。加载页面后，Javascript 在客户端的浏览器中运行。两人不能互相打电话，因为他们跑在不同的地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-19T21:58:06.027

PHP 代码在发送给用户之前运行。尝试查看已处理页面的来源以了解其工作原理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-19T21:57:03.383

```
$ php << EOF
<?php
echo amnt * 25;
EOF
PHP Notice:  Use of undefined constant amnt - assumed 'amnt' in - on line 2

Notice: Use of undefined constant amnt - assumed 'amnt' in - on line 2
0 
```

**你不能像这样从 JavaScript 运行 PHP。**改用 XHR，或坚持使用 JavaScript

# bash - 在 for 循环中嵌套 if

> ID：12030316
> 
> 赞同：24
> 
> 时间：2012-08-19T21:53:20.457
> 
> 标签：bash, for-loop, if-statement

我对 bash 脚本还很陌生，所以这可能是一个愚蠢的语法错误，但为什么这段代码不起作用？

```
for x in $(ls)
do
  if [ -d $x ]
  then
  echo $x
  fi
done 
```

单独的 for 和 if 部分可以自己正常工作，但这不会产生任何输出。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-19T21:57:13.523

两件事情。永远不要使用`ls`迭代文件和引用参数扩展`"$x"`。for 和 if 语法本身是正确的。我更喜欢把`do`and`then`放在同一行

```
for file in *; do
    if [[ -d "$file" ]]; then
        echo "$file is a directory"
    elif [[ -f "$file" ]]; then
        echo "$file is a regular file"
    fi
done 
```

对于学习 bash，我建议阅读[http://mywiki.wooledge.org/BashGuide](http://mywiki.wooledge.org/BashGuide)大多数其他教程和指南很遗憾不是很好。

不做`for x in $(ls)`迭代文件的原因是因为`for`迭代*单词*并`ls`输出带有文件名的行。如果这些文件名恰好包含空格，则这些文件名将进一步拆分为单词，因此您将迭代文件名的*单词*，而不是文件名。显然，对于有效的简单案例，但是当有一种更短、更优雅的方式来处理所有案例时，为什么要使用半有效的解决方案呢？

使用`for x in *`shell 将 替换为`*`当前目录中与该模式匹配的所有文件名（称为路径名扩展），并且每个文件名将是一个单独的单词，因此无论文件名包含什么字符，它都会起作用。文件名可以包含任何字符（包括换行符），但`/`NUL 字节 (\0) 除外。

有关更多信息，请参阅[http://mywiki.wooledge.org/ParsingLs](http://mywiki.wooledge.org/ParsingLs)。

至于使用`[[`vs `[`。`[`是继承自 bourne shell 的命令，用于测试字符串、文件和数字。Bash 添加了一个更强大的`[[`关键字，可以做任何事情`[`，甚至更多。如果你正在编写一个 sh 脚本，你必须使用`[`，但是在 bash 脚本中你应该使用更强大的`[[`和`((`语法。有关和之间区别的更多信息，请参阅[http://mywiki.wooledge.org/BashFAQ/031](http://mywiki.wooledge.org/BashFAQ/031)。`[``[[`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-19T21:58:20.867

也许用于分隔语句不同部分的字符存在问题？

如果您尝试过：

```
for x in $(ls); do if [ -d $x ]; then echo $x; fi; done 
```

这会产生输出吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T21:56:18.833

1) 语法完全合法

2) 是的，您可以在循环内嵌套“if/else”块。您还可以在外循环中嵌套内循环:)

3) "if [ -d $x ]" 检查"x" 是否是一个"目录"。

如果您没有看到任何输出，那么也许您没有任何子目录？

建议：

*   打开终端窗口

*   运行你的脚本。看看你是否得到任何输出。

*   如果没有，则键入`mkdir moose`. 这将创建一个名为（意外地）“moose”的子目录。

*   重新运行您的脚本。*您至少*应该看到“驼鹿”。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2019-06-20T08:10:03.013

```
#!/bin/bash

name=c
for command in "cd $home" " cd XSStrike" "python xsstrike.py"
do
    if [[ $name == "c" ]]; 
    then
        echo "<==========> access granted <==========>"
        $command
    else
        echo "<==========> access denied <==========>"
    fi
done 
```

# coldfusion - 为什么我不能在 Coldfusion 组件中调用方法？

> ID：12030318
> 
> 赞同：1
> 
> 时间：2012-08-19T21:53:32.287
> 
> 标签：coldfusion, coldfusion-8, cfc, application.cfc, cfinvoke

我正在使用`Coldfusion8`并且一直试图调用一个组件。这一直持续到几天前，虽然我不记得改变了什么，但我对这个组件的所有调用现在都失败了。

这里的代码：

```
<cfinvoke component="form_mailer_user" method="msg_contact">
     <cfinvokeargument name="userData" value="#Local.User#"/>
</cfinvoke> 
```

没有什么特别的，除了可能传递一个结构是参数。

我收到以下错误：

```
 Could not find the ColdFusion Component or Interface form_mailer_user. 
 Ensure that the name is correct and that the component or interface exists 
```

它确实存在...那么我该怎么做才能尝试访问它？

感谢帮助！

**编辑：**
这两个文件都在同一个文件夹中，名为`services`. 我在我的文件夹中有一个映射`application.cfc`

```
THIS.mappings["/services"] = GetDirectoryFromPath( GetCurrentTemplatePath() ) & "services"; 
```

但是尝试像这样调用组件：

```
services.form_mailer_user
services.form_mailer_user.cfc 
```

也不起作用。

**编辑：**
我的 application.cfc

```
<cfcomponent displayname="Application" output="false" hint="Application handler">   
    <cfscript>
        THIS.name = "abc";
        THIS.sessionManagement = "true";        
        THIS.sessionTimeout = createTimeSpan(0,2,0,0);
        THIS.s3.acceesKeyid = "___";
        THIS.s3.awsSecretKey = "___";
        // mappings
        THIS.mapping = {};
        THIS.mappings["/controllers"] = GetDirectoryFromPath( GetCurrentTemplatePath() ) & "controllers";
        THIS.mappings["/services"] = GetDirectoryFromPath( GetCurrentTemplatePath() ) & "services";
    </cfscript>

    <cffunction name="onApplicationStart" returnType="boolean" output="false" hint="">
        <cfscript>
            Application.strConfig = structNew();
            Application.strConfig.datasource = "___";
            Application.strConfig.rootDir = "test/members/";
            Application.strConfig.emailErrorMessaging = "on";
        // pre
            Session.activeSession = "No";
            Session.activeLog = "No";
        </cfscript>
        <cfreturn true />
    </cffunction>

    <cffunction name="onSessionStart" returnType="boolean" output="false" hint="session initalizer">
        <cfscript>
            var Local = {};
            Local.cfid = Session.cfid;
            Local.cftoken = Session.cftoken;
            StructClear( SESSION );
        </cfscript>

        <!---SESSION  --->
        <cfparam name="Session.log" default="">
        <cfparam name="Session.activeLog" default="No">
        <cfscript>
            Session.cfid = Local.cfid;
            Session.cftoken = Local.cftoken;
            Session.activeSession = "Yes";              
            Session.datasource = Application.strConfig.datasource;
            Session.testpath = "tes/";
            Session.tpu = "../";
            Session.bucketPath = "http://s3.amazonaws.com/";
            Session.bucketName = "___";
        </cfscript> 
        <cfreturn true />
    </cffunction>

    <cffunction name="onRequestStart" returnType="boolean" output="false" hint="Pre page processing!">         
        <cfscript>
            var LOCAL = {};             
        </cfscript> 
        <!--- DEBUG --->
        <!---
            <cfif structKeyExists(url,'reset')>
                <cfcache action="flush">
                <cfset OnApplicationStart() />
                <cfset THIS.OnSessionStart() />
            </cfif>
            --->
            <cfif len( Session.errMsgs ) EQ 0> 
                <cfinvoke component="services.errorMsg" method="createErrMsgsLog" returnvariable="errMsgs"></cfinvoke>
                <cfset Session.errMsgs = errMsgs> 
            </cfif> 
        <cfreturn true />
    </cffunction>
    <!--- custom functions --->
<cfinclude template="templates/tmp_functions.cfm">
</cfcomponent> 
```

**编辑**：
我想我越来越近了。我有另一个邮件（同一个文件夹），我只是换了这个来替换我的

```
 <cfinvoke component="form_mailer_other" method="msg_contact">
     <cfinvokeargument name="userData" value="#Local.User#"/>
</cfinvoke> 
```

现在 Coldfusion 找不到方法，但这意味着它找到了 cfc。那会不会是我的 mailer.cfc 中的错误？

**解决方案：**
我不敢告诉...

**在**_mailer_user的文件名中输入错误...感谢大家的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T22:11:51.213

如果 CFC 和 CFM 文件不在同一个目录中，则需要在 CFC 所在的目录名称后面加上一个点。见下文。（目录.form_mailer_user）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T19:04:35.547

在您无法“看到”的方法的定义中添加属性***access="public" ，如下所示：***

```
<cffunction name="onRequestStart" access="public" returnType="boolean" output="false" hint="Pre page processing!"> ... 
```

# html - iPad在网页中追踪手指的路径

> ID：12030320
> 
> 赞同：0
> 
> 时间：2012-08-19T21:53:36.963
> 
> 标签：html, ipad, touch

在 ipad 网页上让路径跟随手指的最简单方法是什么？

我希望它是基于矢量图形的，所以它是一条很好的平滑曲线 - 有没有带有演示代码的库来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T22:54:20.833

我最终和拉斐尔一起做了，然后暂停了。

```
start = null

document.getElementById("jw").addEventListener("touchstart",function(e){
  paper.clear()
  lastloc = ""
  chain = ""
  start = "M"+[e.pageX,e.pageY]
  // alert(start)
})

lastloc = ""

document.getElementById("jw").addEventListener("touchmove",function(e){
  lastloc = [e.pageX,e.pageY]
})

document.getElementById("jw").addEventListener("touchend",function(e){
  // paper.clear()
})

chain = ''

setInterval(function(){
  chain += 'L'+lastloc
  lastloc = ''
  if(start){
    paper.clear()
    var path = paper.path(start+chain)
    path.attr("stroke", "#fff")
    path.attr("stroke-width", "15")
  }
}, 30)

// Creates canvas 320 × 200 at 10, 50
var paper = Raphael("jw", 800, 400); 
```

# java - 迭代 Joda Time 的时间间隔

> ID：12030322
> 
> 赞同：8
> 
> 时间：2012-08-19T21:53:42.500
> 
> 标签：java, clojure

是否可以一次一天地迭代间隔的开始日期和结束日期之间的时间？使用`clj-time`Clojure 库也可以！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-19T22:01:42.737

是的。

像这样的东西：

```
DateTime now = DateTime.now();
DateTime start = now;
DateTime stop = now.plusDays(10);
DateTime inter = start;
// Loop through each day in the span
while (inter.compareTo(stop) < 0) {
    System.out.println(inter);
    // Go to next
    inter = inter.plusDays(1);
} 
```

此外，这里是 Clojure 的 clj-time 的实现：

```
(defn date-interval
  ([start end] (date-interval start end []))
  ([start end interval]
   (if (time/after? start end)
     interval
     (recur (time/plus start (time/days 1)) end (concat interval [start]))))) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-20T00:12:28.130

这应该有效。

```
(take-while (fn [t] (cljt/before? t to)) (iterate (fn [t] (cljt/plus t period)) from)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-19T22:15:50.033

使用 clj-time，the-interval 是 Joda Interval ：

```
(use '[clj-time.core :only (days plus start in-days)])
(defn each-day [the-interval f]
 (let [days-diff (in-days the-interval)]
    (for [x (range 0 (inc days-diff))] (f (plus (start the-interval) (days x)))))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-29T01:28:49.287

Clj-time 具有periodic-seq 功能。它看起来非常像 Hendekagon 的解决方案。这可以与开始/结束功能相结合，以创建类似：

```
(defn interval-seq 
  "Returns sequence of period over interval. 
   For example, the individual days in an interval using (clj-time.core/days 1) as the period."
  [interval period]
  (let [end (clj-time.core/end interval)]
      (take-while #(clj-time.core/before? % end) (clj-time.periodic/periodic-seq  (clj-time.core/start interval) period )))) 
```

# java - 如何将 Vector3F 舍入为整数向量？

> ID：12030324
> 
> 赞同：0
> 
> 时间：2012-08-19T21:54:34.960
> 
> 标签：java

我目前正在制作一个程序来构建和拆除块。这很简单但很有趣。我已经走了很远，但遇到了障碍。

到目前为止，我有它，所以当我点击时，它会在我正在查看的位置创建一个块，无论是在另一个块上还是在地面上。这是通过使用来自相机的光线追踪并在由光线与其他对象之间的碰撞创建的 Vector3F 处创建一个块来实现的。我不能做的是对 Vector3F 进行四舍五入，以便数字都是个位数整数。有谁知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:20:42.910

您可以使用 Math.round()： [http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html#round(float)](http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html#round(float))

示例：
1：

```
// It will round the floats in Vector3F and leave the results as floats
Vector3F vect = new Vector3F(2.3f, 1.114124f, 0f);
vect.x = Math.round(vect.x); // 2f
vect.y = Math.round(vect.x); // 1f
vect.z = Math.round(vect.x); // 0f 
```

2：

```
// It will round the floats in Vector3F and leave the results as ints
Vector3F vect = new Vector3F(2.3f, 1.114124f, 0f);
int x = Math.round(vect.x);
int y = Math.round(vect.x);
int z = Math.round(vect.x); 
```

还有更多信息：[How to convert float to int with Java](https://stackoverflow.com/questions/1295424/how-to-convert-float-to-int-with-java)

# objective-c - 具有 5 个相同 UITablesViewControllers 的 UITabBarController - 如何使用 storyBoard 实现？

> ID：12030325
> 
> 赞同：0
> 
> 时间：2012-08-19T21:54:46.030
> 
> 标签：objective-c, xcode4.2, uistoryboard

我正在开发一个带有情节提要的待办事项应用程序，并希望实现这种情况：

我的根控制器是一个标签栏。

我有五个标签栏按钮：今天明天和未来以及另外两个 - 每个都有一个 UINavigationController，它通向一个 UITableViewController。

事情是所有五个在实现上都是相同的，它们之间的唯一区别是它们的数据。

我的问题是如何用故事板实现这个场景？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T11:59:10.840

在故事板中，您必须创建三个（或更多）与 连接的 UIViewController（或 UITableViewController）`Tab Bar Controller`，如下所示：
![示例 01](../Images/b56eaf5c22b0e1c93346765aaa8a5b43.png)

这三个`tableView cells`必须具有相同的`cell identifier`： ![示例 02](../Images/dd1d079415df8d9071977e134f718f42.png)

并且您需要为每个设置相同的类`UIViewController`（或者`UITableViewController`- 我假设该类被调用`FirstViewController`）： ![示例 03](../Images/f8542155c606fd0628679aa5de5344af.png)

最后，您需要选择 tableViews 并以不同的方式设置标签： ![示例 04](../Images/2de3cb9b22578e9f9ecf2d4985b82190.png) ![在此处输入图像描述](../Images/529c15dcd85b41fd9a4aee7b3dc7110a.png)

现在让我们来看代码。在您的 FirstViewController.h（或其他类名）中，添加 tableView 委托和数据源方法：

```
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if ([tableView tag] == 0) {

        // today table
        return [todayArray count];

    }else if ([tableView tag] == 1) {

        // tomorrow table
        return [tomorrow count];

    } else if ([tableView tag] == 2) {

        // future table
        return [future count];

    }
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    if ([tableView tag] == 0) {
        // today table
        // Do something with the today tableView

    }else if ([tableView tag] == 1) {
        // tomorrow table
        // Do something with the tomorrow tableView

    } else if ([tableView tag] == 2) {
        // future table
        // Do something with the future tableView
    }

    return cell;
} 
```

希望这对您有所帮助，并让您解决问题...

# regex - 如何将 html 标签与 perl 正则表达式匹配？

> ID：12030326
> 
> 赞同：-2
> 
> 时间：2012-08-19T21:54:51.890
> 
> 标签：regex, perl, match, lookahead

鉴于下面的代码，我想匹配第一次`form`出现。我发现`?!`可以使用负前瞻来实现这一目标，但它不起作用。我的正则表达式有什么问题？

```
#test
$test = "<form abc> foo </form> <form gg> bar </form>";
$test =~ m/<form[^>]*abc[^>]*>(?!.*form>.*)form>/s;
print $&; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-19T22:19:00.247

首先，在解释正则表达式之前：使用像`HTML::TreeBuilder`创建文档树这样的模块，然后从那里获取您的信息。使用正则表达式解析 HTML 太容易出错，无法在现实世界中使用。

### 你的正则表达式的问题

这是你的字符串：

```
"<form abc> foo </form> <form gg> bar </form>" 
```

还有你的正则表达式（为了可读性而写扩展，与`/x`标志一样）：

```
<form [^>]* abc [^>]* > (?! .* form> .* ) form> 
```

*   `<form`找到文字字符序列时锚定

*   `[^>]*`搜索多个非`>`字符。最初它匹配` abc`

*   `abc`匹配文字字符序列`abc`。但是因为正则表达式引擎当前看到 a `>`它必须回溯，直到`[^>]*`匹配。

*   `[^>]*`将不匹配，因为引擎看到`>`

*   `>`匹配`>`

*   当表达式`.* form .*`不匹配时，否定前瞻匹配。

    *   将`.*`消耗所有字符，直到字符串结束。

    *   `form>`导致引擎回溯直到`.*`匹配`foo </form> <form gg> bar </`。

    *   什么都不匹配，`.*`但这没关系。

所以前瞻成功，但它是负前瞻，所以断言失败。Regex 的最后一部分甚至不会被执行。

### 策略

在我们的`.*`例子中消耗了太多的字符。这称为*贪心*匹配。

非贪心匹配是用一个尾随的`?`like编写的`.*?`。此版本最初使用零个字符，并首先检查模式的下一部分。如果这不起作用，它会迭代地消耗另一个字符，直到匹配。

### 更好的正则表达式

```
<form [^>]* > .*? </form> 
```

在开始标签内，只`>`允许使用非字符。在标签之间，允许任何字符。我们进行非贪婪匹配，因此第一个结束标记匹配并结束正则表达式。

但是，这个解决方案有点问题。宽容的 HTML 解析器不会在`attr="val<u>e"`. 我们会。此外，第一个`</form>`是匹配的，如果我们有*嵌套*表单，这是不可取的。虽然在这个用例中没有问题，但这个正则表达式在匹配`<div>`s 等时完全没用。

### 正则表达式语法

Perl 正则表达式非常强大，允许您声明递归语法。内置语法有点笨拙，但我建议该`Regexp::Grammars`模块轻松做到这一点。更好的是，只需使用已经存在的成熟的 HTML 解析器。

### 获取比赛

不鼓励使用`$&`(and `$``and `$'`)，因为它使 perl 非常低效。这不会在一个小脚本中体现出来，但无论如何它*的风格很糟糕。*而是用括号将整个正则表达式括起来以*捕获*匹配项

```
m{ ( <form [^>]* > .*? </form> ) } 
```

然后使用`$1`.

本[`perlretut`教程](http://perldoc.perl.org/perlretut.html)可能是理解 Perl 正则表达式的一个很好的介绍。

# jquery - Jquery - 将面板向右滑动 X 像素

> ID：12030327
> 
> 赞同：1
> 
> 时间：2012-08-19T21:54:55.200
> 
> 标签：jquery, mobile, user-interface

我正在开发移动用户界面。这是一个混合应用程序，Html5、CSS3、Jquery 等。

您可能已经看到一些移动应用程序，其中在用户交互时显示的“屏幕”的右侧或左侧有一个面板。这些将向右或向左滑动等。

我找到了通过切换向下滑动面板的代码。我还看到了将面板一直滑过屏幕的代码。

问，我如何从左到右滑动面板但只说 50 像素。将原始面板向右推 50 像素？这也需要是一个切换。

用户界面示例：[http ://edi.io/wires/mobile/Home.html](http://edi.io/wires/mobile/Home.html)

谢谢您的帮助。

# nhibernate - nhibernate queryover join alias with a where-or 子句

> ID：12030329
> 
> 赞同：10
> 
> 时间：2012-08-19T21:55:02.127
> 
> 标签：nhibernate, join, alias, queryover

我将发布代码：

```
public IList<Dish> GetByNameDishTypes(IEnumerable<string> names,
    IEnumerable<string> dishTypes)
{
    // return dishes (ie food) whose name is in the names enumerable,
    // or whose type is in the dish types enumerables
    // (this would be 'breakfast', 'dinner') ..

    var namesArr = names != null ? names.ToArray() : new string[0];
    var dishTypesArr = dishTypes != null ? dishTypes.ToArray() : new string[0];

    var criteria = this.Session.CreateCriteria<Dish>();
    criteria.CreateAlias("DishType", "dt");
    criteria.Add(
        Restrictions.Or
        (
            Restrictions.In("Name", namesArr),
            Restrictions.In("dt.Name", dishTypesArr)
        ));

    return criteria.List<Dish>();

    /* get this to work?
    Dish d = null;
    DishType dt = null;
    return this.Session.QueryOver<Dish>(() => d)
        .JoinAlias(() => d.DishType, () => dt)
        .Where(
            Restrictions.Or
            (
                Restrictions.In(d.Name, namesArr),
                Restrictions.In(dt.Name, dishTypesArr)
            ))
        .List<Dish>(); */
} 
```

所以，我想知道如何使用 QueryOver 来做到这一点。我发布的这个 QueryOver 代码引发了一个空引用异常。标准代码有效。

谢谢 ：）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-19T23:15:18.200

有几种方法可以在 QueryOver 中重写它，但最干净的可能是：

```
Dish d = null;
DishType dt = null;
return this.Session.QueryOver<Dish>(() => d)
    .JoinAlias(() => d.DishType, () => dt)
    .Where(() => d.Name.IsIn(namesArr) || dt.Name.IsIn(dishTypesArr))
    .List<Dish>(); 
```

这将生成如下所示的 SQL：

```
SELECT this_.*
FROM   [Dish] this_
       inner join [DishType] dt1_
         on this_.DishTypeId = dt1_.Id
WHERE  (this_.Name in (/* Comma separated list of names */)
         or dt1_.Name in (/* Comma separated list of types */)) 
```

# java - 是否同步 PoolingClientConnectionManager

> ID：12030331
> 
> 赞同：4
> 
> 时间：2012-08-19T21:55:03.313
> 
> 标签：java, android, http, singleton, synchronize

在我的应用程序中，多个*IntentService以随机间隔与**Tomcat*服务器连接/通信，具体取决于用户与应用程序的交互。

我正在为 Http 使用以下 Singleton

```
public class CustomHttpClient { 
    private static HttpClient customHttpClient; 
    /** A private Constructor prevents instantiation */ 
    private CustomHttpClient() { 
    } 

    public static synchronized HttpClient getHttpClient() { 
        if (customHttpClient == null) { 
            HttpParams params = new BasicHttpParams(); 
            HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1); 
            HttpProtocolParams.setContentCharset(params, HTTP.DEFAULT_CONTENT_CHARSET); 
            HttpProtocolParams.setUseExpectContinue(params, true); 
            HttpProtocolParams.setUserAgent(params,"Mozilla/5.0 (Linux; U; Android 2.2.1; en-us; Nexus One Build/FRG83)" +
                    " AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1"); 
            ConnManagerParams.setTimeout(params, 1000); 
            HttpConnectionParams.setConnectionTimeout(params, 5000); 
            HttpConnectionParams.setSoTimeout(params, 10000); 
            SchemeRegistry schReg = new SchemeRegistry(); 
            schReg.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80)); 
            schReg.register(new Scheme("https", SSLSocketFactory.getSocketFactory(), 443)); 
            ClientConnectionManager conMgr = new ThreadSafeClientConnManager(params,schReg); 
            customHttpClient = new DefaultHttpClient(conMgr, params); 
        } 
        return customHttpClient; 
    } 
    public Object clone() throws CloneNotSupportedException { 
        throw new CloneNotSupportedException(); 
    } 
} 
```

该类工作正常，除了当两个尝试同时尝试 Http 或一个连接正在进行并建立另一个连接时，它会提供*connectTimeOut 。*`IntentService`

代码中一项明显的改进是将 deprecated 替换`ThreadSafeClientConnManager`为`PoolingClientConnectionManager.`

我应该`synchronize`在这里 ->`public static synchronized HttpClient getHttpClient()`

Singleton 中的什么错误导致*connectTimeOut*？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T21:06:21.990

> 是否同步 PoolingClientConnectionManager？

是和不是。如果您想`getHttpClient()`成为单身人士（IMO 是个好主意），则必须使其线程安全。这需要`synchronized`. 没有`synchronized`两个线程可以同时进入 if 块（因为`customHttpClient == null`两个线程都是如此）并创建两个实例。

但是有更好的（如更快的）方法而无需`synchronized`创建线程安全的单例。例如，我喜欢[Singleton Holder](https://stackoverflow.com/a/71683/995891)方法。

但无论您在此处使用何种单例，都不应出现连接超时。如果您`HttpClient`为每个线程使用新实例，它也应该工作。

* * *

如果发生连接超时，则您的一个线程无法在您设置的时间限制内连接到服务器`HttpConnectionParams.setConnectionTimeout(params, 5000);`= 5 秒。

这可能有几个原因。例如，如果您的连接速度较慢且不稳定，则可能需要更长的时间，因为您的连接可能会在几秒钟内失效。或者，如果您的服务器由于配置（例如每个 IP 的连接限制）或由于硬件无法处理更多连接而无法处理更多连接，您也会看到这个问题。基本上任何阻止`HttpClient`向/从服务器发送和接收数据包的东西都可能触发该问题。表示您的问题出在设备上、网络上或服务器上。

我不知道您的网络设置，但您可以尝试增加超时，看看是否有任何效果。例如[`AndroidHttpClient`](http://developer.android.com/reference/android/net/http/AndroidHttpClient.html)，将这些超时设置为 60 秒。如果您使用 WiFi 并且连接稳定，这远远超出了要求，但当连接非常弱时，这很好。

您还可以检查`AndroidHttpClient`应用的其他设置是否有帮助。

`AndroidHttpClient`下面的设置

```
// Default connection and socket timeout of 60 seconds.  Tweak to taste.
private static final int SOCKET_OPERATION_TIMEOUT = 60 * 1000;

// ---------------------------------------------------------------------- //
HttpParams params = new BasicHttpParams();

// Turn off stale checking.  Our connections break all the time anyway,
// and it's not worth it to pay the penalty of checking every time.
HttpConnectionParams.setStaleCheckingEnabled(params, false);

HttpConnectionParams.setConnectionTimeout(params, SOCKET_OPERATION_TIMEOUT);
HttpConnectionParams.setSoTimeout(params, SOCKET_OPERATION_TIMEOUT);
HttpConnectionParams.setSocketBufferSize(params, 8192);

// Don't handle redirects -- return them to the caller.  Our code
// often wants to re-POST after a redirect, which we must do ourselves.
HttpClientParams.setRedirecting(params, false);

// Use a session cache for SSL sockets
SSLSessionCache sessionCache = context == null ? null : new SSLSessionCache(context);

// Set the specified user agent and register standard protocols.
HttpProtocolParams.setUserAgent(params, userAgent);
SchemeRegistry schemeRegistry = new SchemeRegistry();
schemeRegistry.register(new Scheme("http",
        PlainSocketFactory.getSocketFactory(), 80));
schemeRegistry.register(new Scheme("https",
        SSLCertificateSocketFactory.getHttpSocketFactory(
        SOCKET_OPERATION_TIMEOUT, sessionCache), 443));

ClientConnectionManager manager =
        new ThreadSafeClientConnManager(params, schemeRegistry);

return new DefaultHttpClient(manager, params); 
```

要确定您的问题出在哪里，您可以查看您的服务器连接日志并检查设备是否尝试启动连接，如果是，是否有未建立连接的原因。如果在超时发生时您没有看到任何连接尝试，则很可能是设备或网络问题。

如果您可以访问设备连接到的网络 (=WiFi)，您可以使用例如[Wireshark](http://www.wireshark.org/)检查网络流量，以了解连接尝试超时的原因。您可以在此处查看设备是否发送连接请求。

最后但并非最不重要的一点是，它可能是由您的某些代码引起的。如果您找不到其他解决方案，请尝试实施它，`HttpURLConnection`看看是否有帮助。

# php - 检查多个课程/会话是否在同一时间范围内

> ID：12030332
> 
> 赞同：-1
> 
> 时间：2012-08-19T21:55:12.957
> 
> 标签：php, mysql

我正在为课程制作一个内部注册表单。我正在开发一个简单的功能，该功能将检查用户是否选择了具有冲突时间表的课程（例如，下午 1-2 点的课程以及同一天下午 1-3 点的课程。）

假设我正在使用`mysqli`并获取用户从具有开始和结束`datetime`字段的 MySQL 表中选择的类，那么比较多个类以查看它们是否冲突的最有效和/或有效的方法是什么？

编辑：这是一个示例表：

```
====================================================
|  id  |        start        |         end         | 
====================================================
|  1   | 2012-10-01 08:00:00 | 2012-10-01 08:00:00 |
==================================================== 
```

显然，表中还会有其他数据（如标题、描述等），但我想我可能只需要上面的数据来做比较。`id`我将拥有一个包含用户注册的每个课程的数组。

抱歉，如果这是重复的，我确实搜索过，但之前没有看到这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T02:38:15.633

我不确定这张表的主键是什么。我相当有信心我的错误对您来说是错误的，但这对于您提出问题的目的并不重要。

```
-- student_id and class_id are foreign keys, not shown
create table times (
  student_id integer not null,
  class_id integer not null,
  primary key (student_id, class_id), 

  start_time timestamp not null,
  end_time timestamp not null
); 
```

第一个学生在第 2 班和第 3 班之间有重叠。

```
insert into times values
(1, 1, '2012-09-01 08:00', '2012-09-01 08:55'),
(1, 2, '2012-09-01 10:00', '2012-09-01 11:55'),
(1, 3, '2012-09-01 11:45', '2012-09-01 12:45'); 
```

第二个学生，没有重叠。

```
insert into times values
(2, 1, '2012-09-01 08:00', '2012-09-01 08:55'),
(2, 2, '2012-09-01 10:00', '2012-09-01 11:55'); 
```

第三个学生在第 1 班和第 2 班之间有重叠。

```
insert into times values
(3, 1, '2012-09-01 08:00', '2012-09-01 10:00'),
(3, 2, '2012-09-01 09:55', '2012-09-01 11:55'),
(3, 3, '2012-09-01 12:00', '2012-09-01 12:55'); 
```

如果您的平台符合 SQL-92，则可以使用 OVERLAPS 运算符。（如果任何 dbms 支持断言，您可以以无法插入重叠类的方式声明表。）

```
select t1.*
from times t1
inner join times t2 on t1.student_id = t2.student_id
       and (t1.class_id <> t2.class_id and t1.start_time <> t2.start_time and t1.end_time <> t2.end_time )
       and (t1.start_time, t1.end_time) overlaps (t2.start_time, t2.end_time); 
```

MySQL 似乎不支持这一点，因此您可以使用 SQL 标准委员会的等效定义。

```
select t1.*
from times t1
inner join times t2 on t1.student_id = t2.student_id
       and (t1.class_id <> t2.class_id and t1.start_time <> t2.start_time and t1.end_time <> t2.end_time )
       and (
             (t1.start_time > t2.start_time and not (t1.start_time >= t2.end_time and t1.end_time >= t2.end_time))
             or
             (t2.start_time > t1.start_time and not (t2.start_time >= t1.end_time and t2.end_time >= t1.end_time))
             or
             (t1.start_time = t2.start_time and (t1.end_time <> t2.end_time or t1.end_time = t2.end_time))
       ); 
```

我希望连接条件能够为您提供良好的性能，只要您的表被仔细索引。在您的情况下，您将为单个学生选择行，这应该是非常有选择性的。（我的示例代码中没有这样做。）

# google-maps - 将 GPS 坐标转换为 Google 地图

> ID：12030333
> 
> 赞同：0
> 
> 时间：2012-08-19T21:55:34.193
> 
> 标签：google-maps, gps, latitude-longitude

这是一个奇怪的问题。我有一个 GPS 设备正在回传此信息：

经度：115.91080W 纬度：5222.70110N

它还可以将其作为 Google 地图链接返回，显示如下：

经度：-1.26518 纬度：+52.37835

谁能建议系统如何在内部在两个数据点之间进行转换？我发现[这个堆栈溢出线程](https://stackoverflow.com/questions/4091530/gps-tracker-coordinate-conversion-into-google-maps-format-and-preciseness)看起来有些相似，但转换似乎没有加起来：S

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T22:21:27.073

假设格式为 DDMM.MMMM (D=degrees, M=minutes)，那篇文章对我有用

115.91080W -> 1 + 15.91080/60 = 1.26518 (W -> -) = -1.26518 5222.7011N -> 52 + 22.7011/60 = 52.3783516666666 (N -> +) = +52.37835

为什么你认为“转换似乎没有加起来”？

# php - 比较多维数组中的元素

> ID：12030334
> 
> 赞同：0
> 
> 时间：2012-08-19T21:55:42.650
> 
> 标签：php, multidimensional-array

假设我有一个多维数组。例如：

```
 Array ( 
         [0] => Array ( 
             [animal_id] => 5494 
             [animal_name] => "Suzy"
             [animal_type] => "zebra" 
             [animal_location] => 0 
             [animal_awake] => 1
             [animal_age] => 3 ) 
         [1] => Array ( 
             [animal_id] => 5494 
             [animal_name] => "Joshua"
             [animal_type] => "panda"
             [animal_location] => 5
             [animal_awake] => 0
             [animal_age] => 8 )
        [2] => Array ( 
             [animal_id] => 5494 
             [animal_name] => "Debra"
             [animal_type] => "snake" 
             [animal_location] => 7 
             [animal_awake] => 1
             [animal_age] => 3 ) 
        [3] => Array ( 
             [animal_id] => 5495 
             [animal_name] => "Caleb"
             [animal_type] =>  "zebra"
             [animal_location] => 0
             [animal_awake] => 1
             [animal_age] => 3 ) 
        [4] => Array ( 
             [animal_id] => 5495 
             [animal_name] => "Joshua"
             [animal_type] =>  "panda"
             [animal_location] => 5 
             [animal_awake] => 0
             [animal_age] => 8 )    
        [5] => Array ( 
             [animal_id] => 5495 
             [animal_name] => "Debra"
             [animal_type] =>  "snake"
             [animal_location] => 7 
             [animal_awake] => 1
             [animal_age] => 3 ) 
        [6] => Array ( 
             [animal_id] => 5496 
             [animal_name] => "Emily"
             [animal_type] =>  "zebra"
             [animal_location] => 0
             [animal_awake] => 1
             [animal_age] => 3 ) 
        [7] => Array ( 
             [animal_id] => 5496 
             [animal_name] => "Joshua"
             [animal_type] =>  "panda"
             [animal_location] => 5 
             [animal_awake] => 0
             [animal_age] => 8 )    
        [8] => Array ( 
             [animal_id] => 5496 
             [animal_name] => "Debra"
             [animal_type] =>  "snake"
             [animal_location] => 7 
             [animal_awake] => 1
             [animal_age] => 3 )             
         ) 
```

我想将所有蛇与蛇进行比较，将所有熊猫与熊猫等进行比较（但不是蛇与熊猫进行比较）并将唯一元素放入一个数组中（所有唯一元素放入一个数组中），我将如何去做这件事。由于它们是数组中的元素，我有点难过。另外，我不会提前知道会有多少种不同的类型。例如，有一次我可以传递一个包含 Panda、Bear、Snake 的多维数组——下一次我可以传递一个包含 Bird、Cat、Panda、Zebra 的数组。

有任何想法吗？

**最终输出**

```
 Array ( 
     [0] => Array ( 
         [animal_id] => 5494 
         [animal_name] => "Suzy"
         [animal_type] => "zebra" 
         [animal_location] => 0 
         [animal_awake] => 1
         [animal_age] => 3 ) 
     [1] => Array ( 
         [animal_id] => 5494 
         [animal_name] => "Joshua"
         [animal_type] => "panda"
         [animal_location] => 5
         [animal_awake] => 0
         [animal_age] => 8 )
    [2] => Array ( 
         [animal_id] => 5495 
         [animal_name] => "Caleb"
         [animal_type] =>  "zebra"
         [animal_location] => 0
         [animal_awake] => 1
         [animal_age] => 3 )    
    [3] => Array ( 
         [animal_id] => 5495 
         [animal_name] => "Debra"
         [animal_type] =>  "snake"
         [animal_location] => 7 
         [animal_awake] => 1
         [animal_age] => 3 ) 
    [4] => Array ( 
         [animal_id] => 5496 
         [animal_name] => "Emily"
         [animal_type] =>  "zebra"
         [animal_location] => 0
         [animal_awake] => 1
         [animal_age] => 3 )    

     ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T23:12:27.297

数组键必须是唯一的，所以让我们利用它来发挥我们的优势。

```
function get_animal_key($animal) {
    return $animal['animal_type'] . '-' . $animal['animal_name'];
}

$uniques = array();
foreach ($array as $animal) {
    $key = get_animal_key($animal);
    $uniques[$key] = $animal;
}

var_export($uniques); 
```

给出以下数组

```
array (
  'zebra-Suzy' => 
  array (
    'animal_id' => 5494,
    'animal_name' => 'Suzy',
    'animal_type' => 'zebra',
    'animal_location' => 0,
    'animal_awake' => 1,
    'animal_age' => 3,
  ),
  'panda-Joshua' => 
  array (
    'animal_id' => 5496,
    'animal_name' => 'Joshua',
    'animal_type' => 'panda',
    'animal_location' => 5,
    'animal_awake' => 0,
    'animal_age' => 8,
  ),
  'snake-Debra' => 
  array (
    'animal_id' => 5496,
    'animal_name' => 'Debra',
    'animal_type' => 'snake',
    'animal_location' => 7,
    'animal_awake' => 1,
    'animal_age' => 3,
  ),
  'zebra-Caleb' => 
  array (
    'animal_id' => 5495,
    'animal_name' => 'Caleb',
    'animal_type' => 'zebra',
    'animal_location' => 0,
    'animal_awake' => 1,
    'animal_age' => 3,
  ),
  'zebra-Emily' => 
  array (
    'animal_id' => 5496,
    'animal_name' => 'Emily',
    'animal_type' => 'zebra',
    'animal_location' => 0,
    'animal_awake' => 1,
    'animal_age' => 3,
  ),
) 
```

如您所见，这将动物的类型和名称作为唯一标识符。您的问题没有说明是什么使动物独一无二，因此请根据您的需要更改上述内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T21:59:09.697

如何按类型对它们进行排序：

```
$animalsByType = array();
foreach ($array as $animal) {
    $type = $animal['animal_type'];
    if (!isset($animalsByType[$type])) {
        $animalsByType[$type] = array();
    }
    $animalsByType[$type][] = $animal;
} 
```

我不确定您要进行哪种比较，但这至少可以按类型为您提供单独的子列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T22:10:45.443

您可以遍历数组，然后交叉检查每个项目：

```
foreach($aAnimals AS $iKey => $aAnimalData
{
    foreach($aAnimals AS $iSubKey => $aData)
    {
        if($aAnimalData['animal_type'] == $aData['animal_type'] && $iKey != $iSubKey)
        {
            // Start doing whatever you want to do when the types match.
            // The last part makes sure the second foreach does not 
            // match with the first one.
        }
    }
} 
```

如果您指定要进行哪种比较，我可以用它来改进这个答案。

# c++ - 对象工厂和这个指针

> ID：12030339
> 
> 赞同：-1
> 
> 时间：2012-08-19T21:56:21.753
> 
> 标签：c++, this, factory

我想了解这样一个简单的**对象工厂**。

```
template <class Base>
class Factory
{
protected:
Factory (std::string name)
...
}
Factory<Base>::Factory (std::string name)
{
        Factory_Map[name] = this;
}
//-------------------------------------
template <class Derived, class Base>
class Factory_Der: public Factory<Base>
{
public:
Factory_Der(std::string name) : Factory<Base>(name) { }
...
}; 
```

所以**Factory_Der**的构造函数会调用**Factory**的构造函数。但我不知道**Factory的构造函数中的****这个**指针将引用**Factory**对象或**Factory_Der**对象。似乎**这**将引用**工厂**对象，但代码不应该工作！（它正在工作）。

 ******谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T09:28:10.490

首先，你创建了一个对象，一个`Factory_Der`对象，对吧？所以当你问，`this`指针指向什么对象，那么，它*可以*指向什么对象呢？你只有一个对象——一个`Factory_Der`对象。

由于`Factory_Der`继承自`Factory`，因此可以将对象的部分内存布局`Factory_Der`视为`Factory`对象。但它是*同一个对象*的一部分。`Factory`它可以指向的任何地方都没有“单独的”对象。

您似乎陷入了这些是构造函数的事实。但构造函数的工作方式与方法非常相似，只是它们的特殊之处在于它们在内存分配后的对象构造期间“自动调用”。你可以想象这个对象构造：

```
Factory_Der *foo = new Factory_Der; 
```

在下面翻译成这样的东西（不是真正的语法；这是 Objective-C 的做法）：

```
Factory_Der *foo = malloc(sizeof(Factory_Der));
foo->constructor(); 
```

这就解释了为什么`this`在构造函数中指向对象。

在每个构造函数的开头，可以指定一个可选的初始化列表，它指定如何初始化基类和字段。（如果你跳过某些东西的初始化程序，就会选择默认值。）所以基本上，构造函数在一开始就自动调用超类的构造函数。

同样，我们可以想象您的构造函数：

```
Factory_Der(std::string name) : Factory<Base>(name) { } 
```

在下面被翻译成这样的东西：

```
void constructor(std::string name) { this->Factory<Base>::constructor(name); } 
```

所以你看，派生类的构造函数本质上是“传递”`this`给基类的构造函数。所以他们看到的对象`this`是*同一个对象*。

当然，在基类的构造函数运行时，派生类的状态并没有建立。所以对象是否可以真正被认为是派生类对象是一个有争议的问题。但是，如果您的问题是`Factory`构造函数从中看到`this`的对象是否是最终将成为对象的`Factory_Der`对象，那么答案无疑是肯定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T22:22:18.537

您的逻辑问题是您认为 a`Factory*`仅限于指向一个`Factory`对象。尽管这样的指针被限制为指向一个`Factory`或其任何子类（因为它们是`Factory`s）。在这种情况下`this`，它指向真正的实例化对象，它确实是 type `Factory_Der`。你真的应该重新阅读继承，因为在我看来你还没有完全理解它。******

# jquery - jQuery .toggle 函数在 IE9 中不起作用

> ID：12030340
> 
> 赞同：0
> 
> 时间：2012-08-19T21:56:23.327
> 
> 标签：jquery, html, internet-explorer-9, toggle

第一次在这里问问题，但我之前在网站上找到了很多次答案。

我的问题是为什么这段代码不能在 IE 中运行，但在 Chrome 中运行良好。我阅读了与此类似的另一个主题，但答案是用 if .show .hide 替换切换。那不是我想做的，我想使用切换，我似乎不明白为什么 IE 不喜欢它。这有点像一个菜单和一个公司提供的服务列表，而切换是一个包含服务细节的 div。我知道 div 标签在 li 标签中是可以的，所以不应该这样，我使用 divs 的原因是因为我使用了很多 CSS 来设置它的样式，尽管它可以以更智能和更清洁的方式完成.. .我知道有与此非常相似的问题，但我找不到为什么我的代码在 IE9 中不起作用的答案。如果有人帮助我，我将不胜感激，谢谢！:)

HTML

```
 <div id="text">
        <ul id="serv">

           <li><div class="head"><a href="#">SERVICE1</a></div>
           <li><div class="cont">
           <p>CONTENTS <p>
               </div></li>
        </ul>
        </li>

              <li><div class="head"><a href="#">SERVICE2/a></div>
              <ul>
             <li><div class="cont">
         <p>CONTENTS2</p>       
        </div></li>
        </ul>
        </li>

    </div> 
```

脚本

```
$(document).ready(function(){
$( '#serv > li > ul' )
    .hide()
    .click(function( e ){
        e.stopPropagation();
    });

  $('#serv > li').toggle(function(){
      $(this)
      .find('ul').slideDown();

  }, function(){
    $( this )
      .find('ul').slideUp();
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:10:21.053

完全解释你的标记，这是混乱和无效的：

```
<div id="text">
    <ul id="serv">        
        <li><div class="head"><a href="#">SERVICE 1</a></div></li>
        <li>
            <div class="cont"><p>CONTENTS </p></div>
            <ul><li>sub list</li></ul>
        </li>
        <li><div class="head"><a href="#">SERVICE 2</a></div></li>
        <li>
            <div class="cont"><p>CONTENTS 2</p></div>
            <ul><li>sub list</li></ul>
        </li>
    </ul>
</div>

$(document).ready(function(){
    $('#serv > li > ul')
        .hide()
        .click(function(e){
            e.stopPropagation();
        });

    $('#serv > li').toggle(function(){
        $(this).find('ul').slideDown();
    }, function(){
        $(this).find('ul').slideUp();
    });
}); 
```

[http://jsfiddle.net/userdude/tCFCJ/5](http://jsfiddle.net/userdude/tCFCJ/5)

单击`CONTENTS`文本以查看向上/向下滑动功能。

# c++ - 变量不能出现在常量表达式中

> ID：12030346
> 
> 赞同：1
> 
> 时间：2012-08-19T21:57:12.300
> 
> 标签：c++, visual-studio-2010, gcc, constant-expression

我很难弄清楚为什么 GCC 4.5 不允许我编译这个：

```
#include <iostream>
#include <bitset>

#define WIDTH 512
#define HEIGHT 512

#define CEIL_POS(X) ((X - (unsigned int)(X)) > 0 ? (unsigned int)(X + 1) : (unsigned int)(X))

int main ()
{
    const unsigned int length = static_cast<const unsigned int>(CEIL_POS(static_cast<float>(WIDTH * HEIGHT) / 8.0));

    std::bitset<length> bits;

    return 0;
} 
```

它在 VS2010 中运行良好。我错过了什么？

**更新：**我很着急，我没有粘贴整个代码。对于那个很抱歉 ：（

PS：正如标题所说，我收到的错误是：“长度不能出现在常量表达式中。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:50:56.500

我不知道您遇到的问题是否是由编译器中的错误引起的，或者这是否是预期的行为，但简单地将 static_cast 删除为 float 似乎可以解决问题，并产生完全相同的值。

```
#include <iostream>
#include <bitset>

#define WIDTH 512
#define HEIGHT 512

#define CEIL_POS(X) ((X - (unsigned int)(X)) > 0 ? (unsigned int)(X + 1) : (unsigned int)(X))

int main ()
{
    const unsigned int length_1 = static_cast<const unsigned int>(CEIL_POS(static_cast<float>(WIDTH * HEIGHT) / 8.0));
    const unsigned int length_2 = static_cast<const unsigned int>(CEIL_POS(WIDTH * HEIGHT / 8.0));

    std::cout << length_1 << '\n' << length_2 << '\n';
    if (length_1 == length_2)
        std::cout << "They are exactly the same.";

    std::bitset<length_2> bits;
} 
```

# css - 将高度设置为自动加 10%

> ID：12030361
> 
> 赞同：12
> 
> 时间：2012-08-19T21:59:25.847
> 
> 标签：css, height

我正在制作一个简单的盒子和内盒。外盒为白色，内盒为紫色。内框宽度是静态的（95%，我知道这不一定是静态的，但在您将理解的高度的上下文中）但高度设置为自动以反映内容文本的高度。我面临的诀窍是在底部有一个边距。设置侧面很容易。外框宽度设置为97%，内框宽度设置为95%。顶部有 10% 的保证金。但由于内盒高度设置为自动，外盒垂直结束于内盒所在的位置。有什么办法可以将外框的高度设置为 auto + 10%？或者类似的东西？谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-19T22:42:24.480

比利护城河的答案是完美的！我曾经`padding-bottom`让它工作。

# android - 通过单击 ListItem 中的 ImageView 删除 ListItem

> ID：12030363
> 
> 赞同：1
> 
> 时间：2012-08-19T21:59:30.240
> 
> 标签：android, listview, adapter, listitem

我有一个包含 ImgaeView 的 ListItem。每当单击其图像或图标时，我都想删除 ListItem。这是我的 ListItemActivity。如何调用适配器的 remove 方法来删​​除 ListItem？我在引用时遇到问题。请让我知道是否有更好的方法。

```
public class TaskListItem extends LinearLayout {

    private Task task;
    private TextView taskName;
    private TextView responsible;
    private TextView priority;
    private ImageView bin;
    protected TaskListAdapter adapter;

    public TaskListItem(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    protected void onFinishInflate() {
        super.onFinishInflate();
        taskName = (TextView)findViewById(R.id.task_name);
        responsible = (TextView)findViewById(R.id.responsible);
        priority = (TextView)findViewById(R.id.priority);
        bin = (ImageView)findViewById(R.id.remove_task);        
    }

    public void setTask( final Task task) {
        this.task = task;
        taskName.setText(task.getName() + " ");
        //Set responsibility text
        responsible.setText("Resp: " + task.getReponsible());
        //Set priority text
        priority.setText(" Prio: " + task.getPiotiry());
        /*
         * onClickListener for image to delete
         */
        bin.setOnClickListener(new OnClickListener() {          
            public void onClick(View v) {
                **call the adapters remove method to delete this item with parameter (this).**  
            }
        });
    }

    public Task getTask() {
        return task;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:17:03.190

如果您只想将其隐藏在 ListView 上，您可以使用：

```
TaskListItem.this.setVisibility(View.GONE); 
```

如果您想从列表中删除它，您将需要在适配器的数据源中放置此项。

您可以在适配器的 getView() 方法中创建 onClickListener 并将其分配给 ImageView。它可能看起来像这样：

```
public class MyAdapter extends BaseAdapter{

    List<Task> mData = null;

  public MyAdapter(List<Task> dataSource){
    mData = dataSource;
  }

  @Override
  public View getView(int position, View convertView, ViewGroup parent) {
//    ... 
    final Tast task = getItem(position);
    TaskListItem listItem = new TaskListItem();
    listItem.setTask(task);
    listItem.bin.setOnClickListener(new OnClickListener(){
      public void onClick(View v) {
        mData.remove(task); // or mData.remove(position);
        // might need to call notifyDataSetChanged() depending on the adapter you're using
      }
     };
    return listItem;
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:09:25.363

您想从包含列表的活动中捕获对列表项的单击，例如在 list.setOnListItemClick() 的回调中或在 ListActivtiy 的 onListItemClick 中。

当你得到点击事件时，你调用adapter.remove(index)。

# java - 尾递归渗透

> ID：12030366
> 
> 赞同：0
> 
> 时间：2012-08-19T22:00:25.577
> 
> 标签：java, data-structures, heap, tail-recursion, heapsort

```
public void insert(int number) {
    heapArr.add(number);
    percolateUp(this.heapArr.size()-1);
}

public void percolateUp(int key) {
    if (getParent(key) >=0 && heapArr.get(getParent(key)) < heapArr.get(key)) {
        int temp = heapArr.get(getParent(key));
        heapArr.set(getParent(key), heapArr.get(key));
        heapArr.set(key, temp);
        percolateUp(getParent(key));
    } else {
        return;
    }
} 
```

我正试图将我的头包裹在尾递归上，据我所知，一些编译器可以判断你是否有尾递归函数并且不会创建任何额外的堆栈帧。在我上面的例子中，我试图弄清楚递归渗透是否是尾递归的。它不一定要等待函数的返回，所以编译器会将其识别为尾递归吗？

# c++ - int64_t 转换为“long double”问题

> ID：12030367
> 
> 赞同：1
> 
> 时间：2012-08-19T22:00:29.403
> 
> 标签：c++

以下代码产生显示的输出，我很困惑......我使用的是英特尔编译器版本 2013 beta update 2 `/opt/intel/composer_xe_2013.0.030/bin/intel64/icpc`：

```
// all good
int64_t fops_count1 = 719508467815;
long double fops_count2 = boost::static_cast<long double>(fops_count1);
printf("%" PRIu64 "\n", fops_count1); // OK outputs 719508467815
printf("%Le\n", fops_count2);         // OK outputs 7.195085e+11

// bad! why this?
int64_t fops_count1 = 18446743496931269238;
long double fops_count2 = boost::static_cast<long double>(fops_count1);
printf("%" PRIu64 "\n", fops_count1); // OK outputs 18446743496931269238
printf("%Le\n", fops_count2);         // FAIL outputs -5.767783e+11 <<<<<<<<<<<<<<<<< WHY? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-19T22:07:38.147

忽略`boost::static_cast`我不明白的 64 位有符号整数不能代表您显示的数字，但是

18446743496931269238 - 2 ^(64) = -576778282378

即这是当一个二进制补码 64 位有符号整数环绕时得到的值。

现在那是什么`boost::static_cast`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T22:11:39.620

```
int64_t fops_count1 = 18446743496931269238; 
```

这是有符号溢出，也就是UB。an 的最大值`int64_t`在 2^63 的数量级上，肯定小于这个值。似乎您的处理器实现了环绕，给出了您看到的负值。

# c# - 从 FlickrAPI 反序列化 JSON

> ID：12030368
> 
> 赞同：-1
> 
> 时间：2012-08-19T22:00:34.020
> 
> 标签：c#, .net, flickr

我正在寻求一些奇怪行为的帮助。Flickr API。他们在 .NET 中有一个库，但由于某种原因它不适用于 Azure。无论如何，图书馆对我来说可能不是矫枉过正。

我只是想通过标签搜索并从结果中获取第一个图像 URL，使用 C# 而不是 Javascript。Flickr 呼叫位于：`http://api.flickr.com/services/rest/?method=flickr.photos.search&format=json&api_key=[xxx]&tags=[yyy]&safe_search=1&per_page=1`。

我定义了一些数据类并返回一个字符串，但是 JSON.NET 和内置的 Json.Decode 和 DataContractSerializer 都对我不起作用。我显然做错了什么。有没有人有这个工作的例子？

我感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T06:50:18.567

我在反序列化之前的 Json 是： {\"photos\":{\"page\":1, \"pages\":481961, \"perpage\":1, \"total\":\"481961\ ", \"照片\":[{\"id\":\"7803745990\", \"所有者\":\"23857115@N08\", \"秘密\":\"c5236cc411\", \" server\":\"7109\", \"farm\":8, \"title\":\"Redwood Burns\", \"ispublic\":1, \"isfriend\":0, \"isfamily \":0}]}, \"stat\":\"ok\"}"

# memory - 大于一个地址整数类型的内存对齐

> ID：12030369
> 
> 赞同：1
> 
> 时间：2012-08-19T22:00:37.817
> 
> 标签：memory, computer-architecture

我正在做一些我必须解释原始内存地址的值的事情，并且我试图找到本质上大于`int`整数类型的存储方式。

为了这个论点，我们假设一个 32 位架构，其中寄存器大小为 32 位，int 为 32 位，long 为 64 位。关于两个寄存器值如何对齐，是否有一些经验法则或指南？

让我们把“它取决于架构/操作系统/语言”的论点排除在外。我知道这方面的任何东西都不是远程可移植或标准化的（实际上，标准中没有特意指定）。我只是好奇这里是否有一般模式。我不会向任何人开枪，任何答案都可能抹去我的硬盘，标准警告。我只是好奇。

我对结构打包以及编译器将如何（通常）确保在它们占用的空间少于适合地址边界的空间时正确对齐 - 但是当它们大于地址边界时会发生什么？

我可以看到几个合理的布局：

假设我们使用地址`0x10`并`0x11`存储 a`long`的值，我不知道，99。我将在这里编造一些术语：`lowint`是 long 中最不重要的一半，并且`highint`是最重要的一半。

如果布局是`0x10 => lowint`, ，那么如果类型是or并且不会溢出 MAX_INT，`0x11 => highint`则读取将产生一致的值，这是一个很好的功能 -在任何一种情况下都是“99”。我们还占用了两个从我们的基地址*向上*增长的地址。另一方面，高低部分似乎“颠倒”了。`0x10``int``long``0x10`

 *如果布局是`0x10 => highint`，`0x11 => lowint`则高低部分是有序的，但是如果是 int 则读取`0x10`将产生“99”，如果是 long 则将产生“0” - 因此`0x11`需要对以下地址进行一些调查以假设我们正在处理一个长整数，而不是两个整数。我们仍然向上成长。

如果布局是`0x10 => lowint`，`0x0F => highint`那么我们已经向后增长（即占用了一个奇怪的先前地址来获得我们的第二个 int 存储），但是我们的 int 是有序的，并且对`0x10`数据类型的读取是一致的。这对我来说似乎是最不可能的，因为它会完全搞砸缓存和数据线读取，但它仍然是另一种选择。

那么最有可能的是什么？我的直觉告诉我选项 2 - 具有两个整数存储空间的有序高低部分 - 对硬件来说是最方便的，但我不肯定这是真的。有人有任何布局的轶事证据吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T22:17:01.870

你在这里问的是[endianess](http://en.wikipedia.org/wiki/Endianess)。事实证明，大端与小端与混合端是计算机体系结构中的一个主要问题。你提到的第一个（即0x10作为lowint）被称为小端，第二个是大端。

我们不需要对加载的方向感到困惑如果我们从 0x10 加载 16 位，那么无论采用哪种字节序方案，我们都会从 0x10 和 0x11 获得两个字节。指针很少指向下方，因此根据我的经验，您的最后一个示例永远不会发生。

寄存器确实很重要，因为处理器解释高字节和低字节（字节序）的方式决定了它在内存中的存储方式。在依赖于跨架构移动的特定数据结构的便携式软件中，当处理器的字节序与它正在操作的数据结构的字节序不同时，有必要反转字节顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T22:08:30.940

> 关于两个寄存器值如何对齐，是否有一些经验法则或指南？

对齐（如字节序）是一个内存问题。它与寄存器无关*

# javascript - 从 node.js 应用程序调用 Mongoose Model.save() 时挂起

> ID：12030371
> 
> 赞同：9
> 
> 时间：2012-08-19T22:00:50.520
> 
> 标签：javascript, node.js, mongodb, express, mongoose

我正在尝试学习 node 和 mongo 以构建一个简单的 web 应用程序/自学更多关于 web 应用程序的知识。但是，当我调用 Model.save() 时，延续函数似乎永远不会执行，并且数据也没有保存。

这是我到目前为止所拥有的：

```
/* app.js */

var express = require('express')
  , app = express()
  , routes = require('./routes')
  , http = require('http')
  , path = require('path')
  , mongoose = require('mongoose')
  , db 
  , Track
  , models = require('./models.js');

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'ejs');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('secretstuff'));
  app.use(express.session());
  app.use(app.router);
  app.use(require('less-middleware')({ src: __dirname + '/public' }));
  app.use(express.static(path.join(__dirname, 'public')));
  app.use(function(err, req, res, next){
    console.error(err.stack);
    res.send(500, 'Something broke!');
  });
});

models.defineModels(mongoose, function(){
  app.Track = Track = mongoose.model('Track');
  db = mongoose.createConnection('localhost','nextrak')
});

app.get('/', routes.index);

app.get('/dbTest', function(req, res){
  console.log("Here goes...");
  var t = new Track({
    name: "TestTrack",
    artist: "Artist",
    tags: ["test"],
    next: ["track1","track2"]
  });
  console.log("Test Track:");
  console.log(t);

  t.save(function(){
    if(err)
      console.log("Error! Couldn't complete dbTest successfully.");
    else
      console.log("Aw yiss, got dbTest working");
  })
});

http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
});

/*models.js*/

function defineModels(mongoose, cont){
  var Schema = mongoose.Schema;
  Track = new Schema({
    'name': { type: String, index: true },
    'artist': String,
    'tags': [String],
    'next': [String],
  });
  mongoose.model('Track', Track);
  cont();
}

exports.defineModels = defineModels; 
```

没有抛出错误，mongo 日志表明当我启动我的应用程序时启动了 5 个新连接。不会出现新的日志（[clientcursormon] 日志除外）。当我在 Chrome 中加载 /dbTest 时，该应用程序会打印出以下内容：

开始...

```
 Test Track:
    { name: 'TestTrack',
      artist: 'Basik',
      _id: 5031606aa11cf95815000001,
      next: [ 'track1', 'track2' ],
      tags: [ 'test' ] } 
```

Mongo 似乎配置正确。当我让节点运行 Mongoose 引导您完成的简单“入门”脚本时，一切正常。

谁能指出我做错了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-19T23:07:41.373

您还没有为 Mongoose 创建默认使用的连接。替换这个：

```
db = mongoose.createConnection('localhost','nextrak') 
```

有了这个：

```
db = mongoose.connect('localhost', 'nextrak'); 
```

结合其他尼特：

1.  您`Track`在 models.js 中设置为全局变量
2.  您需要在回调中添加一个`err`参数。`t.save`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T22:40:52.640

首先，如果你只需要一个连接，你应该使用 mongoose.connect()。

其次，我认为您正在混淆轨道模式和轨道模型。这是两个不同的东西。new Schema() 创建一个 Schema 对象，该对象被传递给 mongoose.model()。mongoose.model 的结果（您似乎正在丢弃）是您在创建要存储在数据库中的新实例而不是模式时要使用的结果。

# goliath - 如何使用 goliath 和葡萄发送数据或附件？

> ID：12030380
> 
> 赞同：1
> 
> 时间：2012-08-19T22:01:51.843
> 
> 标签：goliath, grape-api

不知道这是如何完成的，但是按照它在 Sinatra 中的完成方式不会在 Goliath 上削减它 -[如何从 Sinatra 发送二进制数据？](https://stackoverflow.com/questions/6083974/how-can-i-send-binary-data-from-sinatra)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T05:18:55.227

如果您的文件足够小，您可以将“Content-Type”标头设置为标头哈希，然后将数据发回。

```
[200, {'Content-Type' => 'application/octet-stream'}, "\x01\x02\x03"] 
```

如果文件很大，您可以对响应进行分块流式处理，查看 Goliath 的示例目录以查看几个流式处理示例。

# ruby-on-rails - 关键字控制器#index 中的 OpenSSL::SSL::SSLError

> ID：12030381
> 
> 赞同：0
> 
> 时间：2012-08-19T22:02:12.240
> 
> 标签：ruby-on-rails, error-handling, openssl

我不知道这里发生了什么。我已经运行这个控制器方法好几天了，现在突然间我得到了这个 oppenssl 错误，而且我没有做任何我能想象到的改变。我的应用程序调用了外部 SOAP api，我突然注意到这个错误只显示在与所述 API 交互的操作中。最近在此 API 的另一端所做的更改是否可能导致此问题？这是什么意思呢？这是我的来源和错误堆栈：

关键字控制器#index

```
def index
    user = User.find session[:user_id]
    user = user.as_json
    @keywords = Keyword.get_keywords(user)
    @keywords = @keywords.to_array(:get_response, :return, :data, :item)

end 
```

错误跟踪：

```
 /home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/net/http.rb:678:in `connect'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/net/http.rb:678:in `block in connect'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/timeout.rb:44:in `timeout'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/timeout.rb:89:in `timeout'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/net/http.rb:678:in `connect'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/net/http.rb:637:in `do_start'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/net/http.rb:626:in `start'
httpi (1.1.1) lib/httpi/adapter/net_http.rb:75:in `do_request'
httpi (1.1.1) lib/httpi/adapter/net_http.rb:22:in `get'
httpi (1.1.1) lib/httpi.rb:86:in `block in get'
httpi (1.1.1) lib/httpi.rb:193:in `with_adapter'
httpi (1.1.1) lib/httpi.rb:84:in `get'
savon (1.1.0) lib/savon/wasabi/document.rb:34:in `resolve_document'
savon (1.1.0) lib/savon/wasabi/document.rb:15:in `xml'
wasabi (2.5.0) lib/wasabi/document.rb:131:in `parse'
wasabi (2.5.0) lib/wasabi/document.rb:118:in `parser'
wasabi (2.5.0) lib/wasabi/document.rb:34:in `endpoint'
savon (1.1.0) lib/savon/client.rb:114:in `preconfigure'
savon (1.1.0) lib/savon/client.rb:80:in `request'
app/models/keyword.rb:15:in `get_keywords'
app/controllers/keywords_controller.rb:7:in `index'
actionpack (3.2.6) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.6) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.6) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.6) lib/active_support/callbacks.rb:414:in `_run__37600477__process_action__984091946__callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.6) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.6) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.6) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.6) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.6) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.6) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/params_wrapper.rb:206:in `process_action'
activerecord (3.2.6) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.6) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.6) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.6) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.6) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.6) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:600:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/cookies.rb:338:in `call'
activerecord (3.2.6) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `_run__633773016__call__27066224__callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.6) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.6) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.6) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.6) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.6) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.6) lib/rails/engine.rb:479:in `call'
railties (3.2.6) lib/rails/application.rb:220:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.6) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread' 
```

本地服务器日志：

```
 HTTPI executes HTTP GET using the net_http adapter

Started GET "/keywords" for 127.0.0.1 at 2012-08-19 17:44:45 -0500
Processing by KeywordsController#index as HTML
Completed 500 Internal Server Error in 621ms

OpenSSL::SSL::SSLError (SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed):
  app/models/keyword.rb:15:in `get_keywords'
  app/controllers/keywords_controller.rb:7:in `index'

  Rendered /home/edu/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.6/lib/action_dispatch/middleware/templates/rescues/_trace.erb (30.2ms)
  Rendered /home/edu/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.6/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (13.1ms)
  Rendered /home/edu/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.6/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (95.3ms) 
```

# objective-c - iOS - 从 willEnterForeground 执行来自 UIViewController 的选择器

> ID：12030385
> 
> 赞同：1
> 
> 时间：2012-08-19T22:03:25.763
> 
> 标签：objective-c, ios, uitableview, multitasking, background-foreground

我的主 UITableView 类中有一个 -(void) 方法，用于刷新数据。有点复杂，这里就不贴了，不过在viewWillAppear过程中也会调用，所以每次tableView出现的时候，数据都会正常刷新，除了从多任务打开的时候。

我知道它只是应该提供确切的暂停状态，但在我的应用程序类型中，每次打开应用程序时都需要刷新它。

我已经成功地做到了这一点：

```
- (void)applicationWillEnterForeground:(UIApplication *)application
{
    [self.window.rootViewController viewWillAppear:YES];
} 
```

这完美地刷新了数据，但产生了许多其他问题，比如在我的 UINavigationController 中搞砸了 popViewController 动画。我猜这首先不是最好的方法。（有人知道如何解决吗？）

我想要做的是在我启动应用程序时执行我的 refreshTableviewData 方法，包括当它是多任务处理时。

不知道从这里去哪里，但我会**非常感谢任何建议！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:25:57.390

我会抛出一些想法，这些想法可能适用也可能不适用，但由于我没有等效的代码来测试它们，所以你必须尝试它们而不是我。:-)

由于`viewWillAppear:`必须调用`super viewWillAppear:`，我认为那里发生了一些特殊的 UIViewController 魔法，这可能不应该在应用程序加载过程中发生。您说您有一个`refreshTableviewData`方法，那么为什么不调用它 in `applicationWillEnterForeground:`，或者至少尝试找到您可以在不调用`viewWillAppear`.

其他选择：你也可以让你的视图控制器注册`/UIApplicationWillEnterForegroundNotification`. 或者，如果这不起作用，您可以尝试使用 `applicationDidBecomeActive`（和/或等效通知）。作为最后的手段，（这是一个边界黑客）当您加载应用程序时，您可以在屏幕上放置“刷新数据...”消息，然后使用 NSTimer 刷新表的数据，例如 1/4或 1/2 秒后。

# asp.net - 如何从包含 asp.net 应用程序的母版页将数据发布到外部 URL

> ID：12030386
> 
> 赞同：0
> 
> 时间：2012-08-19T22:03:26.323
> 
> 标签：asp.net, post

我必须将五个字段值发布到外部 url 以处理来自 asp.net 应用程序的付款。外部公司给了我html中的示例代码。问题是我不能使用 html，因为我必须在代码隐藏中填充其中一些值并使用 aspx 页面。由于我的网站有一个母版页，我无法使用该行

```
 <FORM name=thisForm action="https://abc.com/xyz/default.asp" method=post> 
```

请让我知道如何使用 asp.net 从后面的代码中发布这些值。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:12:22.540

`Since my website has a master page I can't use the line`这不是真的。您可以在任何 aspx 页面的代码隐藏中设置这些属性，例如：

```
Form.Action = "https://abc.com/xyz/default.asp";
Form.Method = "post"; 
```

# c# - 最新的 SQLite 版本错误

> ID：12030388
> 
> 赞同：4
> 
> 时间：2012-08-19T22:03:50.587
> 
> 标签：c#, visual-studio, sqlite, nhibernate

刚刚通过 Nuget 将我的 SQLite dll 更新到 v1.0.81.0，我收到如下错误。这发生在第一次成功执行一次或多次之后（不确定）。环境是 x64 机器上的 vs2010，但构建设置针对 x86。

我使用 SQLite 对我的 NHibernate 映射进行单元测试。过去经常发现 SQLite 有点“古怪”，我不愿意弄乱工作单元测试夹具（见下文）

有人知道这里出了什么问题吗？

干杯，
贝里尔

**错误信息**

```
Unable to copy file "...\x86\SQLite.Interop.dll" to "bin\Debug\x86\SQLite.Interop.dll". The process cannot access the file 'bin\Debug\x86\SQLite.Interop.dll' because it is being used by another process. Parties.Data.Impl.NHib.Tests 
```

**单元测试夹具（无论如何都足以显示文件访问）**

```
public abstract class SQLiteTestFixture
{

    protected override void BeforeAllTests()
    {
        _configureDbFile();
        base.BeforeAllTests();
    }

    protected override void AfterAllTests()
    {
        base.AfterAllTests();

        _deleteAllDbFiles();
    }

    #region Db File Maintenance

    /// <summary>
    /// Using a file is likely slower than just memory but not noticeably so far,
    /// AND seems to be a bit more stable
    /// </summary>
    private const string DB_FILE_SUFFIX = ".Test.db";

    /// <summary>
    /// Just make some random file name with a known suffix, so we can clean up when done.
    /// </summary>
    private void _configureDbFile()
    {
        _dbFile = Path.GetFullPath(Guid.NewGuid().ToString("N") + DB_FILE_SUFFIX);

        // highly unlikely but just in case the same file is already out there
        _deleteDbFile();
    }

    private void _deleteDbFile()
    {
        if (File.Exists(_dbFile)) File.Delete(_dbFile);
    }

    private static void _deleteAllDbFiles()
    {
        var files = Directory.GetFiles(Directory.GetCurrentDirectory(), "*" + DB_FILE_SUFFIX);
        foreach (var file in files)
        {
            File.Delete(file);
        }
    }

    private string _dbFile;

    #endregion

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-08T14:28:20.277

我在使用 VS2010 和 TestDriven.Net 的 SQLite 1.0.88.0 时遇到了这个问题。我尝试了几个 SO 问题的答案，但唯一对我有用的是：

1.  工具 -> 选项 -> TestDriven.Net -> 常规
2.  在*Run Test(s)*下，取消选中“Cache tests process between test runs”
3.  重新启动 Visual Studio

您现在应该能够运行测试、调试测试、重建等，而无需重新启动进程或 Visual Studio。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T17:48:41.410

描述一种可能原因的知识库文章

*   [http://support.microsoft.com/kb/313512/en-us](http://support.microsoft.com/kb/313512/en-us)

以下大部分内容暂时解决了问题

*   重新启动 Visual Studio
*   [http://aspadvice.com/blogs/ssmith/archive/2005/03/21/1849.aspx](http://aspadvice.com/blogs/ssmith/archive/2005/03/21/1849.aspx)
*   关闭赌场网络服务器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-09T12:52:30.640

将 SQLLite dll“复制到输出目录”更改为“如果更新则复制”就可以了。（您可能需要在更改属性后重新启动 VS）

# ruby-on-rails - 如何使用测试单元在 Rails 中登录用户

> ID：12030391
> 
> 赞同：1
> 
> 时间：2012-08-19T22:04:52.923
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

在 Rails 中，我有一个 before_filter 来检查并要求用户是控制器中某些操作的管理员。

但是，我需要为这些控制器编写测试。

所以，我有一些看起来像这样的东西：

```
test "should get create" do
    assert_difference('Event.count') do
      post :create, FactoryGirl.build(:event)
    end
    assert_not_nil assigns(:event)
    assert_response :success
  end 
```

用户工厂.rb：

```
FactoryGirl.define do

  factory :admin do
   email 'aa@example.com'
   password 'password'
   password_confirmation 'password'
   admin true
  end
end 
```

但需要以管理员身份登录才能创建事件。关于如何做到这一点的任何想法？admin 列只是 users 表中的 true/false 列。

编辑：第一次尝试：

```
 test "should get create" do
    admin = Factory(:admin)
    login_as(admin)
    assert_difference('Event.count') do
      post :create, FactoryGirl.build(:event)
    end
    assert_not_nil assigns(:event)
    assert_response :success
  end 
```

产生错误：

```
 1) Error:
test_should_get_create(EventsControllerTest):
NameError: uninitialized constant Admin 
```

**更新：**

```
FactoryGirl.define do

  factory :user do
   email 'aa@example.com'
   password 'password'
   password_confirmation 'password'
  end
end 
```

和

```
test "should get create" do
    login_as(FactoryGirl.create(:user, admin: true))
    assert_difference('Event.count') do
      post :create, FactoryGirl.build(:event)
    end
    assert_not_nil assigns(:event)
    assert_response :success
  end 
```

我得到了错误`test_should_get_create(EventsControllerTest): NoMethodError: undefined method 'login_as' for #<EventsControllerTest:0x007fb4faec1b28>`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-19T22:33:45.630

当您定义您的`factory(:admin)`时，FactoryGirl 会查找一个名为 的类`Admin`，这就是您收到该错误的原因。

您无需为`admin`;创建单独的工厂。您可以简单地使用您的用户工厂，传入`admin: true`（这将覆盖默认的工厂设置）。就这样吧`admin = Factory(:user, admin: true)`。当然，请确保您`user`定义了工厂。

如果要保留`:admin`工厂，则需要指定类为`User`. 语法是这样的：`factory(:admin, class: "User")`.

# html5-canvas - fillRect 不应用大的宽度和高度值

> ID：12030393
> 
> 赞同：1
> 
> 时间：2012-08-19T22:05:17.150
> 
> 标签：html5-canvas

我使用带有 Javascript 代码的 canvas 标签来绘制一个矩形：

```
var canvas=document.getElementById('myCanvas');
var ctx=canvas.getContext('2d');
ctx.fillStyle='#FF0000';

ctx.fillRect(0,0,80,100); 
```

对于 fillRect 方法，如果我为宽度和高度提供较大的值，我注意到它们不会被应用，例如：

```
ctx.fillRect(0,0,1000,1000); 
```

会给出类似的东西：

![在此处输入图像描述](../Images/8be8724829bcd7d03ff65659fedab93b.png)

我错过了什么吗？宽度和高度是否有任何限制。根据文档，我没有找到与此相关的任何内容。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T20:12:26.290

我猜你已经把你的and`width`设置为小于矩形的尺寸。尝试像这样明确设置：`height``canvas`

```
<canvas width="1500" height="1500"></canvas> 
```

# javascript - JS下拉菜单出现在图像旋转器上

> ID：12030397
> 
> 赞同：0
> 
> 时间：2012-08-19T22:05:54.503
> 
> 标签：javascript, css, drop-down-menu, z-index

希望有人可以帮助我解决这个问题。我正在尝试让下拉菜单出现在此页面上的 javascript 图像滑块上...

[http://www.spektroskopy.com/SNSv2/index.php](http://www.spektroskopy.com/SNSv2/index.php)

我似乎记得很久以前遇到过这个问题，但对于我的生活，我似乎找不到解决方案，我什至玩过 z-index .. 但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T22:09:46.357

这是一个 CSS 问题，在 navigation.css 第 52 行你会发现`.dropmenu li ul, .dropmenu li > div`add there`z-index:2`

# python - 根据熊猫中的索引连接多个列

> ID：12030398
> 
> 赞同：2
> 
> 时间：2012-08-19T22:06:01.660
> 
> 标签：python, pandas

作为[这篇文章](https://stackoverflow.com/questions/12021730/can-pandas-handle-variable-length-whitespace-as-column-delimeters)的后续，我想根据它们的索引连接一些列，但我遇到了一些问题。在此示例中，我收到与 map 函数相关的属性错误。解决此错误的帮助以及对列进行等效连接的代码将不胜感激。

```
 #data
    df = DataFrame({'A':['a','b','c'], 'B':['d','e','f'], 'C':['concat','me','yo'], 'D':['me','too','tambien']})

    #row function to concat rows with index greater than 2
    def cnc(row):
        temp = []
        for x in range(2,(len(row))):
            if row[x] != None:
                temp.append(row[x])
        return map(concat, temp)

    #apply function per row
    new = df.apply(cnc,axis=1)

    #Expected Output
    new

    concat me
    me too
    yo tambien 
```

谢谢，扎克cp

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-19T22:20:15.253

这样的事情怎么样？

```
>>> from pandas import *
>>> df = DataFrame({'A':['a','b','c'], 'B':['d','e','f'], 'C':['concat','me','yo'], 'D':['me','too','tambien']})
>>> df
   A  B       C        D
0  a  d  concat       me
1  b  e      me      too
2  c  f      yo  tambien
>>> df.columns[2:]
Index([C, D], dtype=object)
>>> df[df.columns[2:]]
        C        D
0  concat       me
1      me      too
2      yo  tambien
>>> [' '.join(row) for row in df[df.columns[2:]].values]
['concat me', 'me too', 'yo tambien']
>>> df["new"] = [' '.join(row) for row in df[df.columns[2:]].values]
>>> df
   A  B       C        D         new
0  a  d  concat       me   concat me
1  b  e      me      too      me too
2  c  f      yo  tambien  yo tambien 
```

如果你有`None`漂浮的物体，你也可以处理它。例如：

```
>>> df["C"][1] = None
>>> df
   A  B       C        D
0  a  d  concat       me
1  b  e    None      too
2  c  f      yo  tambien
>>> rows = df[df.columns[2:]].values 
```

近乎英语：

```
>>> new = [' '.join(word for word in row if word is not None) for row in rows]
>>> new
['concat me', 'too', 'yo tambien'] 
```

使用`filter`：

```
>>> new = [' '.join(filter(None, row)) for row in rows]
>>> new
['concat me', 'too', 'yo tambien'] 
```

等等。你可以在一行中完成，但我认为将它分开更清楚。

# python - 使用 Flask-Cache 缓存一个 lxml.html 对象

> ID：12030403
> 
> 赞同：2
> 
> 时间：2012-08-19T22:06:49.770
> 
> 标签：python, caching, flask

我正在尝试制作一个 Flask Web 应用程序，您必须在其中请求整个非本地网站，我想知道是否可以缓存它以加快速度，因为该网站不会经常更改但我仍然希望它每天左右更新一次缓存。

无论如何，我查了一下，发现 Flask-Cache，它似乎做了我想要的，所以我对它进行了适当的更改，并想出了添加这个：

```
from flask.ext.cache import Cache
[...]
cache = Cache()
[...]
cache.init_app(app)
[...]
@cache.cached(timeout=86400, key_prefix='content')
def get_content():
    return lxml.html.fromstring(urllib2.urlopen('http://WEBSITE.com').read()) 
```

然后我从需要内容的函数中调用，如下所示：

```
content = get_content() 
```

现在我希望它在每次调用时重用缓存的 lxml.html 对象，但这不是我所看到的。每次进行调用时，对象的 id 都会发生变化，并且根本没有加速。那么我是否误解了 Flask-Cache 的作用，或者我在这里做错了什么？我尝试使用 memoize 装饰器，我尝试减少超时或将其全部删除，但似乎没有任何区别。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T20:30:01.070

默认`CACHE_TYPE`是`null`给你一个[`NullCache`](http://werkzeug.pocoo.org/docs/contrib/cache/#werkzeug.contrib.cache.NullCache)- 所以你根本没有缓存，这是你观察到的。[该文档](http://packages.python.org/Flask-Cache/)没有明确说明这一点，但源代码中的这一行`Cache.init_app`确实：

```
self.config.setdefault('CACHE_TYPE', 'null') 
```

要实际使用一些缓存，请初始化您的`Cache`实例以使用适当的缓存。

```
cache = Cache(config={'CACHE_TYPE': 'simple'}) 
```

旁白：*请注意，这[`SimpleCache`](http://werkzeug.pocoo.org/docs/contrib/cache/#werkzeug.contrib.cache.SimpleCache)对于开发和测试以及此示例非常有用，但您不应该在生产中使用它。类似[`MemCached`](http://werkzeug.pocoo.org/docs/contrib/cache/#werkzeug.contrib.cache.MemcachedCache)或[`RedisCache`](http://werkzeug.pocoo.org/docs/contrib/cache/#werkzeug.contrib.cache.RedisCache)会更好的东西*

现在，有了实际的缓存，您将遇到下一个问题。在第二次调用时，`lxml.html`将从 中检索缓存的对象`Cache`，但由于这些对象不可缓存，因此已损坏。Stacktrace 看起来像这样：

```
Traceback (most recent call last):
  File "/home/day/.virtualenvs/so-flask/lib/python2.7/site-packages/flask/app.py", line 1701, in __call__
    return self.wsgi_app(environ, start_response)
  File "/home/day/.virtualenvs/so-flask/lib/python2.7/site-packages/flask/app.py", line 1689, in wsgi_app
    response = self.make_response(self.handle_exception(e))
  File "/home/day/.virtualenvs/so-flask/lib/python2.7/site-packages/flask/app.py", line 1687, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/day/.virtualenvs/so-flask/lib/python2.7/site-packages/flask/app.py", line 1360, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/day/.virtualenvs/so-flask/lib/python2.7/site-packages/flask/app.py", line 1358, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/day/.virtualenvs/so-flask/lib/python2.7/site-packages/flask/app.py", line 1344, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "/home/day/q12030403.py", line 20, in index
    return "get_content returned: {0!r}\n".format(get_content())
  File "lxml.etree.pyx", line 1034, in lxml.etree._Element.__repr__ (src/lxml/lxml.etree.c:41389)

  File "lxml.etree.pyx", line 881, in lxml.etree._Element.tag.__get__ (src/lxml/lxml.etree.c:39979)

  File "apihelpers.pxi", line 15, in lxml.etree._assertValidNode (src/lxml/lxml.etree.c:12306)

AssertionError: invalid Element proxy at 3056741852 
```

因此`lxml.html`，您不应该缓存对象，而应该只缓存简单的字符串——您下载的网站的内容，然后重新解析它以`lxml.html`每次都获得一个新的对象。您的缓存仍然有帮助，因为您不会每次都访问其他网站。这是一个完整的程序来演示有效的解决方案：

```
from flask import Flask
from flask.ext.cache import Cache
import time
import lxml.html
import urllib2

app = Flask(__name__)

cache = Cache(config={'CACHE_TYPE': 'simple'})
cache.init_app(app)

@cache.cached(timeout=86400, key_prefix='content')
def get_content():
    app.logger.debug("get_content called")
#    return lxml.html.fromstring(urllib2.urlopen('http://daybarr.com/wishlist').read())
    return urllib2.urlopen('http://daybarr.com/wishlist').read()

@app.route("/")
def index():
    app.logger.debug("index called")
    return "get_content returned: {0!r}\n".format(get_content())

if __name__ == "__main__":
    app.run(debug=True) 
```

当我运行程序并向 发出两个请求时`http://127.0.0.1:5000/`，我得到了这个输出。请注意，这`get_content`不是第二次调用，因为内容是从缓存中提供的。

```
 * Running on http://127.0.0.1:5000/
 * Restarting with reloader
--------------------------------------------------------------------------------
DEBUG in q12030403 [q12030403.py:20]:
index called
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
DEBUG in q12030403 [q12030403.py:14]:
get_content called
--------------------------------------------------------------------------------
127.0.0.1 - - [21/Dec/2012 00:03:28] "GET / HTTP/1.1" 200 -
--------------------------------------------------------------------------------
DEBUG in q12030403 [q12030403.py:20]:
index called
--------------------------------------------------------------------------------
127.0.0.1 - - [21/Dec/2012 00:03:33] "GET / HTTP/1.1" 200 - 
```

# ruby-on-rails-3 - 价格的活动记录嵌套属性

> ID：12030405
> 
> 赞同：0
> 
> 时间：2012-08-19T22:07:39.733
> 
> 标签：ruby-on-rails-3, activerecord

我是一个全新的 Rails 开发人员，所以请多多包涵:-)

我在 Rails 中有两个名为 Product 和 ProductPrice 的模型。

这是 ProductPrices 的外观：

```
class CreateProductPrices < ActiveRecord::Migration
  def change
    create_table :product_prices do |t|
      t.integer :product_id
      t.date :since
      t.decimal :price
      t.boolean :current

      t.timestamps
    end
  end
end 
```

这就是模型的外观：

```
class ProductPrice < ActiveRecord::Base
  belongs_to :product
  attr_accessible :current, :price, :product_id, :since
end 
```

现在我希望通过产品可以访问价格。它应该始终显示当前价格（只能有一个当前价格/产品。用户还应该能够通过产品编辑价格。如果价格在产品更新中发生变化，则应插入新的 ProductPrice current = true and since = 当前日期。旧的 ProductPrice 应该不再是最新的。

我已经找到了有关嵌套属性的文章，我认为这就是要走的路。谁能告诉我应该怎么做？

编辑：感谢您的回复，我尝试按照您的说法实施，我现在在 product.rb 中有这个：

```
class Product < ActiveRecord::Base
  belongs_to :menu_category
  belongs_to :menu
  has_many :product_prices, :dependent => :delete_all

  scope :latest_price, lambda {product_prices.where("since <= ?",DateTime.now).order(:since).last}
  attr_accessible :active, :descFR, :descNL, :image, :menu_category_id, :menu_id, :nameFR, :nameNL
  mount_uploader :image, ImageUploader    
end 
```

在我的产品索引页面中，我拥有：

```
<tbody>
  <% @products.each do |product| %>
  <tr>
        <td><%= product.nameNL %></td>
        <td><%= product.nameFR %></td>
        <td><%= product.descNL %></td>
        <td><%= product.descFR %></td>
        <td><%= product.latest_price.price.to_s %></td> 
```

我也尝试过：product.latest_price.price 或 product.latest_price 我还尝试将 latest_price 添加到 attr_accessible

但我总是得到这个错误：

```
undefined method `latest_price' for #<Product:0x49e1e48> 
```

EDIT2：它现在可以工作了。我还发现如果我添加这个：

```
 def latest_price=(val)
    pp = ProductPrice.where(:product_id => self.id, :since => DateTime.now.to_date).first_or_create(:price => val)
    pp.price = val
    pp.save
  end 
```

然后它完全完成了我在问题中所要求的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T22:29:13.970

我假设你有一个产品模型。确保您的模型中有以下内容：

```
class Product < ActiveRecord::Base
  has_many :product_prices

  def latest_price
    product_prices.where("since <= ?",DateTime.now).order(:since).last
  end
end 
```

现在您可以通过以下方式访问所有价格：

```
@product.find(123)
@product.product_prices.each do |price|
  # each price for the product found here
end 
```

但要访问最新价格，该方法为您提供：

```
@product.latest_price.price # latest price
@product.latest_price.since # when the latest price was active since 
```

注意我添加了`where("since <= ?",DateTime.now)`. 这使您可以提前安排价格（如果是在将来）。

为产品添加新价格：

```
@new_price = ProductPrice.create(:price => ?,
                                 :product_id => @product.id,
                                 :since => DateTime.now) 
```

为产品添加价格的另一种方法：

```
@new_price = ProductPrice.create(:price => ?, :since => DateTime.now)
@product.product_prices.push(@newprice)
@product.save 
```

或者：

```
@product.product_prices << @newprice # this autosaves 
```

# javascript - JavaScript 对象的“值是引用”是什么意思

> ID：12030407
> 
> 赞同：3
> 
> 时间：2012-08-19T22:08:21.133
> 
> 标签：javascript, pass-by-reference, pass-by-value

我试图理解 JavaScript 中变量和对象的传递，并遇到了[这个页面](https://stackoverflow.com/questions/518000/is-javascript-a-pass-by-reference-or-pass-by-value-language)。

说明 JavaScript 对象是按值传递的，但值本身是一个引用。尽管我了解该页面上给出的示例中发生了什么，但我仍然对为什么感到困惑。谁能解释一下“价值本身就是参考”是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T22:19:50.170

某些语言对函数参数有“按引用传递”概念，这意味着当您调用函数并通过*引用*传入变量时，该函数可以修改原始变量以保存其他值 - 它具有对原始变量的引用。

当您调用函数并传入变量时，使用“按值传递”，函数只能获取值，因此无法更改传入的原始变量。

JS 只有“按值传递”，但是当您将对象作为参数传递时，“值”是对原始对象的引用，因此函数可以修改、创建或删除该对象的属性，但函数*不能*修改原始变量以引用其他对象或值。

例子：

```
function changeObj(someObj) {
    someObj.a = 1000;
    someObj.c = "test";

    someObj = { "x" : 5 };
    console.log(someObj);   // { "x" : 5 }
}

var o = { "a" : 1, "b" : 2 };
changeObj(o);
console.log(o);   // { "a" : 1000, "b" : 2, "c" : "test" } 
```

我展示的代码创建了一个变量 ，`o`它引用了一个具有`a`和`b`属性的对象。然后它调用该函数`changeObj`并传入`o`. 该函数更改`a`属性的值并创建一个新`c`属性 - 该函数正在修改该变量`o`引用的同一对象，因为它具有对该对象的引用。但是随后该函数分配`someObj`了一个全新的对象。这根本*没有*影响`o`，因为该函数只有对`o`所指向对象的引用，它无权访问`o`变量本身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T09:44:27.653

与 Java、Python 和许多其他语言一样，在 JavaScript 中，**对象不是值**。

这意味着，当您评估一个表达式时，您从中获得的值要么是原始值，要么是引用（引用是指向对象的指针）。当您创建一个对象时，该表达式的计算结果为一个引用。当您访问对象的字段或调用对象的方法时，左边的东西是引用。基本上，您对对象所做的任何事情都必须通过对对象的引用来完成。没有直接处理对象的语法。

您不能拥有一个其值“是”一个对象的变量（与 C++ 不同，您可以同时拥有一个值为对象的变量和一个其值为指向对象的指针的变量）；您只能拥有一个变量，其值是指向对象的引用。

从以下事实可以看出这一点：当您分配一个变量时，永远不会创建一个新对象。分配引用时，分配的变量具有原始引用值的副本，因此指向与原始引用相同的对象。没有任何东西可以放入变量中，导致分配它以创建新对象。

因此，如果有人说“将对象传递给函数”，我会说，不，你不能传递对象，因为对象不是值。您必须传递对对象的引用。就像在赋值中一样，当你传递一个引用时，它的值会被复制。JavaScript 始终是按值传递的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T22:11:36.350

> 说明 JavaScript 对象是按值传递的，但值本身是一个引用。

这是相当混乱的措辞。他们的意思是当对象被传递给函数时，指向对象的引用值被传递而不是实际的对象。

# javascript - 为什么我的表单没有删除多个条目？

> ID：12030409
> 
> 赞同：1
> 
> 时间：2012-08-19T22:08:45.853
> 
> 标签：javascript, jquery, forms

所以我有一个`Array`充满一堆重复的东西`['hey','hey','yeh']`，如果提交的文本与它匹配，我有一个 html 表单，它会从我的数组中删除任何条目。但是，我的 JS/jQuery 似乎并没有按照我喜欢的方式运行。每次我按下按钮时，似乎只有前几个条目被删除，而不是所有匹配项（这是我想要的）。我的“每个”函数不应该遍历数组中的所有项目并删除与提交的内容匹配的所有条目吗？

HTML：

```
<form id="remove_user" action="#" method="post">
        <label for="user_num">Remove user:</label>
        <input type="text" id="user_num" name="user_num" placeholder="number">
        <input type="submit" value="(-) remove">
    </form><!-- #remove_user -->

    <ul id="user_list"></ul><!-- #user_list --> 
```

JS 更新了一个更改，但仍然无法正常工作：

```
$('#remove_user').submit(function(){
    id = $('#user_num').val();
    $.each(myArr, function(i, value){
        if (value == id){
            myArr.splice(i, 1);
        };
    });
    $('#user_list').html('');
    for (var i=0; i < myArr.length; i += 1) {
        $('#user_list').append('<li>' +myArr[i]+ '</li>');
    };
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T22:20:47.267

嘿，我认为这应该是这样的。

```
$.each(myArr, function(i, value){
    if (value == id){
        // delete myArr[myArr.indexOf(value)];
        myArr.splice(i, 1); //i is current index 
```

};

**编辑**

```
$('#remove_user').submit(function() {
id = $('#user_num').val();
$.each(myArr, function(i, value) {
    if (value == id) {
        myArr.splice(i, 1, '');
    };
}); 
```

[小提琴](http://jsfiddle.net/j8M4r/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T22:14:28.423

替换这部分：

```
$.each(myArr, function(i, value){
        if (value == id){
            // delete myArr[myArr.indexOf(value)];
            myArr.splice(myArr.indexOf(value), 1);
}; 
```

这个使用[`$.grep`](http://api.jquery.com/jQuery.grep/)：

```
myArr = $.grep(myArr, function(value) {
  return value != id;
}); 
```

还有一种更漂亮的方法可以使用[`.splice`](http://www.w3schools.com/jsref/jsref_splice.asp)and [`$.inArray`](http://api.jquery.com/jquery.inarray/)：

```
var myArr = ['le', 'le', 'la']
var removeItem = 'la';

myArr.splice($.inArray(removeItem, myArr), 1);

// Will print only 'le', 'le'
alert(myArr); 
```

这是一个 jsFiddle 供您尝试：http: [//jsfiddle.net/leniel/4zENw/2/](http://jsfiddle.net/leniel/4zENw/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T22:21:32.697

jQuery 的 .each 函数使用从 0 开始的整数对数组进行迭代，以对它们进行索引。当您在发生这种情况时从数组中取出某些内容时，jQuery 的 index var 不会被告知它，您最终会跳过一个项目。

如果从数组的另一端迭代，这不是问题；

```
var i = myArr.length;
while (i--) {
    if (myArr[i] === value) {
        myArr.splice(i, 1);
    }
} 
```

# android - 从 osmdroid MapView 获取 MyLocationOverlay

> ID：12030422
> 
> 赞同：1
> 
> 时间：2012-08-19T22:11:07.520
> 
> 标签：android, location, overlay, osmdroid, mylocationoverlay

我正在创建一个应用程序，您可以在其中使用 MyLocationOverlay 打开和关闭 FollowLocation。

我的问题是，当我之前已经设置了 MyLocationOverlay，并且想要打开 FollowLocation，但我似乎无法在 MapView 的 OverlayManager 中找到/获取 MyLocationOverlay 对象。OverlayManager 似乎只返回一个 Overlay 对象，而不是 MyLocationOverlay 对象。

这就是我添加 MyLocationOverlay 的方式：

```
main_mapView = (MapView) findViewById(R.id.main_mapView);   
MyLocationOverlay mMyLocationOverlay = new MyLocationOverlay(mContext, main_mapView);
mMyLocationOverlay.enableMyLocation();
mMyLocationOverlay.enableCompass();
mMyLocationOverlay.main_mapView.getOverlays().add(mMyLocationOverlay);
main_mapView.invalidate(); 
```

后来我想找到 MyLocationOverlay 做这样的事情，但如前所述，它返回一个 Overlay 对象。

```
MyLocationOverlay mMyLocationOverlay = main_mapView.getOverlayManager().get(i);
mMyLocationOverlay.enableFollowLocation() 
```

任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:32:44.337

只需保留对您最初新建的 MyLocationOverlay 的引用...无需从覆盖管理器中取回它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T14:51:01.307

或者，检查返回的 Overlay 对象的 getClass() 方法。它可能会向您显示请求的 Overlay 实际上是 MyLocationOverlay，在这种情况下您可以投射它。例如：

```
Overlay overlay = main_mapView.getOverlayManager().get(i);

if ( overlay.getClass().equals(MyLocationOverlay.class) ) {
    ((MyLocationOverlay)mMyLocationOverlay).enableFollowLocation()
} 
```

# jquery - 通过 If/Else 语句定位 CSS 属性

> ID：12030432
> 
> 赞同：1
> 
> 时间：2012-08-19T22:12:57.957
> 
> 标签：jquery, css, if-statement

好的，希望这是一个非常直截了当的问题。正如标题所暗示的，在 if else 语句中使用 opacity 属性时是否可以定位它？如果是这样，您将如何编写代码？

你能做这样的事情，还是我走远了？

```
if ($("#someObject").css().opacity == 1) {
    // do this
} else if {$("#someObject").css().opacity == 0){
    // do this instead
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T22:14:58.217

如果您使用的是 jQuery（看起来就像是），那么您就快到了：

```
if ($("#someObject").css('opacity') == 1) {
  // do this
} else if ($("#someObject").css('opacity') == 0){
  // do this instead
}; 
```

将是正确的代码。

为了更具体地说明这是做什么的，`.css()`jQuery 中的方法在与单个参数一起使用时是元素上计算的 CSS 的访问器 - 传入 CSS 规则，您将返回设置值。

如果我要进行任何更改，那么首先要缓存该值，这样您就不会进行可能的多项选择/评估调用。例如

```
var setOpacity = $("#someObject").css('opacity');
if (setOpacity == 1) {
  // do this
} else if (setOpacity == 0){
  // do this instead
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T01:15:08.760

根据 Robin 的回答，您可以使用`switch`：

```
switch($("#someObject").css('opacity')){
  case 1:
    // do this
    break;
  case 0:
    // do this instead
    break;
} 
```

# jquery - 在 jQuery 中选择嵌套的 .children()

> ID：12030433
> 
> 赞同：2
> 
> 时间：2012-08-19T22:13:17.673
> 
> 标签：jquery

我正在学习 jQuery，我想知道这两个选择器之间有什么区别：

```
 $('#puzzleGrid table tr td img'); 
```

和

```
 $('#puzzleGrid').children('table').children('tr').children('td').children('img'); 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-19T22:17:49.500

这个[children()](http://api.jquery.com/children/)选择器——正如 Fraicio Matte 所指出的——

第一个将在可用时使用 DOM QSA，这比充满函数调用开销的第二个示例快千万亿倍。

```
$('#puzzleGrid').children('table').children('tr').children('td').children('img'); 
```

非常特定于获取前一个元素的子元素

而这个 -[后代选择器](http://api.jquery.com/descendant-selector/)

```
$('#puzzleGrid table tr td img') 
```

将找到具有 id=puzzleGrid.. 的元素的任何“表”后代（下的任何表元素）以及找到的表的任何后代 tr.. 等等。

与第一个等效的是使用`>` [子选择器](http://api.jquery.com/child-selector/)

```
$('#puzzleGrid > table > tr > td > img') 
```

# c# - 我收到类型初始化程序异常并且无法找出问题所在

> ID：12030434
> 
> 赞同：0
> 
> 时间：2012-08-19T22:13:22.057
> 
> 标签：c#

当我启动应用程序时，我得到异常可能是什么？

异常在构造函数中的一行：

```
checkBox1.Checked = Options_DB.Get_Automatic_Start(); 
```

这是`options_db`课程，但我在那里使用了一个断点，它永远不会到达`options_db`

这是在 form1 中引发异常的构造函数：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using DannyGeneral;
using System.Drawing.Drawing2D;

namespace Batch_Images_Convertion
{
    public partial class Form1 : Form
    {
        int i;
        bool cancel_;
        bool automatic_;
        public Form1()
        {

            InitializeComponent();
            i = 0;
            automatic_ = false;
            checkBox1.Checked = Options_DB.Get_Automatic_Start(); 
```

它永远不会超出这条线。

这是异常错误消息：

```
System.TypeInitializationException was unhandled
  Message=The type initializer for 'Batch_Images_Convertion.Options_DB' threw an exception.
  Source=Batch_Images_Convertion
  TypeName=Batch_Images_Convertion.Options_DB
  StackTrace:
       at Batch_Images_Convertion.Options_DB.Get_Automatic_Start()
       at Batch_Images_Convertion.Form1..ctor() in D:\C-Sharp\Batch_Images_Convertion\Batch_Images_Convertion\Batch_Images_Convertion\Form1.cs:line 26
       at Batch_Images_Convertion.Program.Main() in D:\C-Sharp\Batch_Images_Convertion\Batch_Images_Convertion\Batch_Images_Convertion\Program.cs:line 18
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: System.IO.DirectoryNotFoundException
       Message=Could not find a part of the path 'C:\Users\Chocolade\AppData\Local\Microsoft\Batch_Images_Convertion\settings\settings_convertion.txt'.
       Source=mscorlib
       StackTrace:
            at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
            at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath)
            at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)
            at System.IO.File.Create(String path)
            at DannyGeneral.OptionsFile..ctor(String settings) in D:\C-Sharp\Batch_Images_Convertion\Batch_Images_Convertion\Batch_Images_Convertion\OptionsFile.cs:line 72
            at Batch_Images_Convertion.Options_DB..cctor() in D:\C-Sharp\Batch_Images_Convertion\Batch_Images_Convertion\Batch_Images_Convertion\Options_DB.cs:line 25
       InnerException: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:21:09.843

看起来它试图加载文件`'C:\Users\Chocolade\AppData\Local\Microsoft\Batch_Images_Convertion\settings\settings_convertion.txt'`但目录`settings`不存在。

在您的构造函数中，通过执行以下操作检查以确保目录存在：

```
Directory.Exists(@"path\to\your\folder") 
```

在尝试访问文件之前。

# symfony - Symfony2 渲染表单小部件 form_row()（HTML5 注意事项）

> ID：12030441
> 
> 赞同：3
> 
> 时间：2012-08-19T22:15:04.840
> 
> 标签：symfony, twig

我想呈现一个表单小部件。这是我要生成的原始 HTML：

```
<input type="email" class="input-long" placeholder="Enter Email" name="email" id="email" required="required"> 
```

使用这个：

```
{{ form_row(form.email, { 'type' : 'email', 'attr' : { 'class' : 'input-long', 'placeholder': "Enter Email", 'name': "email", 'id':"email", 'required': "required"}}) }} 
```

未生成所需的输出（例如，输入类型为“文本”）。

如何自定义呈现表单小部件以指定输入类型、占位符等？

**更新**

这是我的表单类：

```
class ContactType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('fist_name')
            ->add('last_name')
            ->add('email')
            ->add('token')
            ->add('is_validated')
            ->add('created_at')
            ->add('updated_at')
            ->add('promotion')
            ->add('refferer')
        ;
    }

    public function getName()
    {
        return 'acme_contactlistbundle_contacttype';
    }

    public function getDefaultOptions(array $options)
    {
        return array(
            'data_class' => 'Acme\ContactlistBundle\Entity\Contact',
        );
    }
} 
```

`{{ form.email }}`呈现这个：

```
<label for="acme_contactlistbundle_contacttype_email" class=" required">Email</label><input id="acme_contactlistbundle_contacttype_email" name="acme_contactlistbundle_contacttype[email]" required="required" type="text"> 
```

表单构建时添加小部件电子邮件为`add->('email','email')`

它呈现了这个：

```
<label for="acme_contactlistbundle_contacttype_email" class=" required">Email</label><input id="acme_contactlistbundle_contacttype_email" name="acme_contactlistbundle_contacttype[email]" required="required" type="email"> 
```

但是，我不想渲染标签（它弄乱了我精心布置的页面！）。

最后，我受够了，使用了这个丑陋的hackery ...（fobj是从控制器动作传入的表单对象）：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T06:21:34.543

如果您对表单渲染的要求与 Symfony2 提供的不同，那么您可以定义自己的小部件。只需扩展表单主题并重新定义所需的块：

```
{% form_theme form _self %}
{% block field_widget %}
    {% set type = type|default('text') %}
    <input type="{{ type }}" {{ block('widget_attributes') }} value="{{ value }}" />
{% endblock field_widget %} 
```

当然，检查[有关表单主题的文档](http://symfony.com/doc/current/cookbook/form/form_customization.html#what-are-form-themes)

* * *

**更新**

如果你想只呈现`<input>`标签而没有`<label>`- 那么你应该用下一种方式重新定义你的字段小部件：

```
{% block _contact_email_row %}
    <div>
        {{ form_errors(form) }}
        {{ form_widget(form) }}
    </div>
{% endblock %} 
```

`_contact`是为了你的`Type`名字。
`_email`用于字段名称。

# javascript - Google Maps API v3 调整大小事件

> ID：12030443
> 
> 赞同：10
> 
> 时间：2012-08-19T22:15:05.783
> 
> 标签：javascript, google-maps-api-3

使用地图 API v3。根据 Google 文档，如果地图容器以编程方式调整大小，则必须手动触发地图调整大小事件。

Resize 事件：当 div 改变大小时，开发者应该在地图上触发这个事件。

因此我使用：

```
google.maps.event.trigger(map, 'resize'); 
```

我应该使用哪个侦听器来根据调整大小的地图容器的新边界来更新我的标记？

```
google.maps.event.addListener(map, 'resize', function() {

    console.log(map.getBounds());
}); 
```

上面仍然显示了调整大小之前的界限。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-19T22:24:14.583

每当调整地图大小时，边界都会改变。因此，您可以使用该`bounds_changed`事件：

```
google.maps.event.addListener(map, 'bounds_changed', function() {
    var bounds = map.getBounds();
}); 
```

它有以下描述：

> 当视口边界发生变化时会触发此事件。

* * *

如果您只想在地图调整大小后调用事件，则可以使用布尔变量来跟踪地图是否刚刚调整大小，如下所示：

```
var mapResized = false; 
```

然后，无论何时触发该`resize`函数，都可以将`mapResized`变量设置为`true`. 你可以使用一个函数来做到这一点：

```
function resizeMap(map) {
    google.maps.event.trigger(map, 'resize');
    mapResized = true;
} 
```

然后，在这种情况`bounds_changed`下，您只能对调用 if`mapResized`为 true 做出反应，然后设置`mapResized`为`false`：

```
google.maps.event.addListener(map, 'bounds_changed', function() {
    if (mapResized) {
        // react here
    }
    mapResized = false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T22:24:00.083

如果你想知道bounds什么时候改变，你需要监听“bounds_changed”事件

```
google.maps.event.addListener(map, 'bounds_changed', function() {
    console.log(map.getBounds());
}); 
```

如果您只想要触发调整大小事件后的第一个 bounds changed 事件，您可以使用：

```
google.maps.event.addListenerOnce(map, 'bounds_changed', function() {
    console.log(map.getBounds());
}); 
```

在触发调整大小事件之前。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-26T12:44:58.357

在 Angular.js 和 IONIC 上，我通过在 ** 之后插入此代码来解决

```
declaration of var map = new google..... :
google.maps.event.addListenerOnce(map, 'bounds_changed', function () {
   google.maps.event.trigger(map, 'resize');
   var bounds = map.getBounds();
}); 
```

# php - php fopen 静默失败

> ID：12030444
> 
> 赞同：0
> 
> 时间：2012-08-19T22:15:26.897
> 
> 标签：php, fopen

我无法使用 fopen 打开此网址

> [http://sim8430.agni.lindenlab.com:12046/cap/ccab53e3-49d8-c4f8-b3ad-51ff22c1fa17/](http://sim8430.agni.lindenlab.com:12046/cap/ccab53e3-49d8-c4f8-b3ad-51ff22c1fa17/)

但是由于某种原因它默默地失败了，它可以很好地打开其他网址，但没有像上面那样的网址

它没有给出错误的事实不是真正的问题，不加载是我试图解决的问题

```
$file = fopen("http://sim8430.agni.lindenlab.com:12046/cap/ccab53e3-49d8-c4f8-b3ad-51ff22c1fa17/", "r") or exit("Unable to open file!"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:19:47.880

像这样抓住它

```
// add extensive logging
error_reporting(E_ALL);
$file = fopen("http://sim8430.agni.lindenlab.com:12046/cap/xyz/", "r");
if($file === false) { 
      // try through socket open
      $file = fsockopen("sim8430.agni.lindenlab.com", 12046, $errno, $errstr);
      if($file == false && $errno == 0) die("Socket initialization failed");
      else if(!$file) {
          die($errstr);
      } else {
          $out = "GET /cap/xyz/ HTTP/1.1\r\n";
          $out .= "Host: sim8430.agni.lindenlab.com\r\n";
          $out .= "Connection: Close\r\n\r\n";
          fwrite($file, $out);
      }
}
if($file) {
    while (!feof($file)) {
        $contents = fgets($file, 128);
    }
    fclose($file);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T08:20:07.733

在读取/解析 WWW 服务器上的文件内容时，始终使用 cURL。

```
<?php

class CurlTool {

    public static $userAgents = array(
        'FireFox3' => 'Mozilla/5.0 (Windows; U; Windows NT 5.1; pl; rv:1.9) Gecko/2008052906 Firefox/3.0',
        'GoogleBot' => 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)',
        'IE7' => 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)',
        'Netscape' => 'Mozilla/4.8 [en] (Windows NT 6.0; U)',
        'Opera' => 'Opera/9.25 (Windows NT 6.0; U; en)'
    );
    public static $options = array(
        CURLOPT_USERAGENT => 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)',
        CURLOPT_AUTOREFERER => true,
        CURLOPT_FOLLOWLOCATION => true,
        CURLOPT_RETURNTRANSFER => true,
        CURLOPT_FRESH_CONNECT => true,
        CURLOPT_COOKIEJAR => "cookies.txt",
        CURLOPT_COOKIEFILE => "cookies.txt",
        CURLOPT_SSL_VERIFYPEER => false,
            //CURLOPT_COOKIESESSION => false,
    );
    private static $proxyServers = array();
    private static $proxyCount = 0;
    private static $currentProxyIndex = 0;
    public static $getinfo;

    public static function addProxyServer($url) {
        self::$proxyServers[] = $url;
        ++self::$proxyCount;
    }

    public static function fetchContent($url, $fields = null, $verbose = false) {
        //print '*'.$fields.'*';
        if (($curl = curl_init($url)) == false) {
            throw new Exception("curl_init error for url $url.");
        }
        if (self::$proxyCount > 0) {
            $proxy = self::$proxyServers[self::$currentProxyIndex++ % self::$proxyCount];
            curl_setopt($curl, CURLOPT_PROXY, $proxy);
            if ($verbose === true) {
                echo "Reading $url [Proxy: $proxy] ... ";
            }
        } else if ($verbose === true) {
            echo "Reading $url ... ";
        }
        //$verbose=TRUE;
        //print_r($fields);
//        debug_print_backtrace();
//url-ify the data for the POST
        $fields_string = '';
        if (is_array($fields))
            foreach ($fields as $key => $value) {
                if (empty($key))
                    continue;
                $fields_string .= $key . '=' . urlencode($value) . '&';
                if ($verbose === true) {
                    echo $key . ": " . $value;
                }
            }
        rtrim($fields_string, '&');

        if (count($fields) > 0) {
            curl_setopt($curl, CURLOPT_POST, count($fields));
            curl_setopt($curl, CURLOPT_POSTFIELDS, $fields_string);
        }

        if ($verbose === true) {
            echo "Fields string $fields_string ... ";
        }

        curl_setopt_array($curl, self::$options);

        $content = curl_exec($curl);
        self::$getinfo = curl_getinfo($curl);
        if ($content === false) {
            throw new Exception("curl_exec error for url $url " . curl_error($curl));
        }

        curl_close($curl);
        if ($verbose === true) {
            echo "Done.\n";
        }
        $content = preg_replace('#\n+#', ' ', $content);
        $content = preg_replace('#\s+#', ' ', $content);

        return $content;
    }

    public static function downloadFile($url, $fileName, $fields = null, $verbose = false) {
        if (($curl = curl_init($url)) == false) {
            throw new Exception("curl_init error for url $url.");
        }

        if (self::$proxyCount > 0) {
            $proxy = self::$proxyServers[self::$currentProxyIndex++ % self::$proxyCount];
            curl_setopt($curl, CURLOPT_PROXY, $proxy);
            if ($verbose === true) {
                echo "Downloading $url [Proxy: $proxy] ... ";
            }
        } else if ($verbose === true) {
            echo "Downloading $url ... ";
        }

        //url-ify the data for the POST
        $fields_string = '';
        if (is_array($fields))
            foreach ($fields as $key => $value) {
                if (empty($key))
                    continue;
                $fields_string .= $key . '=' . urlencode($value) . '&';
            }
        rtrim($fields_string, '&');

        curl_setopt($curl, CURLOPT_POST, count($fields));
        curl_setopt($curl, CURLOPT_POSTFIELDS, $fields_string);

        curl_setopt_array($curl, self::$options);

        if (is_file($fileName)) {
            $contents = file_get_contents($fileName, false, null, -1, 3 * 1024);
            $pattern = "__VIEWSTATE";
            if (strpos($contents, $pattern) === false) {
                return $fileName;
            }
        }

//        if (is_file($fileName)) {
//            // make a HEAD request and try to get the file size HEAD
//            // if they differ then redownload the file, otherwise no need
//            curl_setopt($curl, CURLOPT_NOBODY, true);
//            curl_setopt($curl, CURLOPT_HEADER, true);
//            $ret = curl_exec($curl);
//            //echo $fileName;
//            $size = curl_getinfo($curl, CURLINFO_CONTENT_LENGTH_DOWNLOAD);
//            if ($size == filesize($fileName)) {
//                return $fileName;
//            } else {
//                unlink($fileName);
//                return self::downloadFile($url, $fileName, $fields, $verbose);
//            }
//        }

        if (substr($fileName, -1) == '/') {
            $targetDir = $fileName;
            $fileName = tempnam(sys_get_temp_dir(), 'c_');
        }
        if (($fp = fopen($fileName, "w")) === false) {
            throw new Exception("fopen error for filename $fileName");
        }

        curl_setopt($curl, CURLOPT_FILE, $fp);

        curl_setopt($curl, CURLOPT_BINARYTRANSFER, true);

        $ret = curl_exec($curl);
        self::$getinfo = curl_getinfo($curl);

        if ($ret === false) {
            fclose($fp);
            unlink($fileName);
            throw new Exception("curl_exec error for url $url.");
        } elseif (isset($targetDir)) {
            $eurl = curl_getinfo($curl, CURLINFO_EFFECTIVE_URL);
            preg_match('#^.*/(.+)$#', $eurl, $match);
            fclose($fp);
            rename($fileName, "$targetDir{$match[1]}");
            $fileName = "$targetDir{$match[1]}";
        } else {
            fclose($fp);
        }

        curl_close($curl);
        if ($verbose === true) {
            echo "Done.\n";
        }
        return $fileName;
    }

}

?> 
```

cURL 始终发送浏览器标头，并且您不会超时，或被重定向或死效果

下载文件或获取文件内容，任君选择！

# c# - 读取文本文件中的行，然后查看 XML 文件是否包含文本文件中出现的这些词

> ID：12030446
> 
> 赞同：1
> 
> 时间：2012-08-19T22:15:41.293
> 
> 标签：c#, winforms

请耐心等待，因为我对编程本身和 C# winforms 非常陌生。

我有一个`AAA.txt`文件，我让它在组合框中显示为“AAA”。我的主要目的是允许用户从下拉组合中选择 AAA，然后单击搜索。在点击事件上，该函数应该逐行读取文本文件的内容，然后查找这些词（例如你好）或短语（例如早上好）是否出现在我所有的 20 个 XML 文件的`<description></description>`子节点中。如果这些单词/短语确实出现在某些`<description></description>`子节点中，那么整个`<item></item>`父节点的数据将作为结果出现。

AAA.txt：

```
hello
good morning
great
bye 
```

我的功能：

```
private void searchComByKeywords()
{ 
    string[] fileEntries = Directory.GetFiles(sourceDir);
    foreach (string fileName in fileEntries)
    {
        XmlDocument xmlDoc = new XmlDocument();
        string docPath = fileName;
        xmlDoc.Load(docPath);
        XmlNodeList nodeList = xmlDoc.GetElementsByTagName("item");

        foreach (XmlNode node in nodeList)
        {
            XmlElement itemElement = (XmlElement)node;
            string itemDescription = itemElement.GetElementsByTagName("description")[0].InnerText;

            if (itemDescription.ToLower().Contains(comboTemplates.SelectedItem.ToString()))
            {
                string itemTitle = itemElement.GetElementsByTagName("title")[0].InnerText;
                string itemDate = itemElement.GetElementsByTagName("pubDate")[0].InnerText;
                string itemAuthor = itemElement.GetElementsByTagName("author")[0].InnerText;

                richComByTemplate.AppendText("Author: " + itemAuthor + "\nDate: " + itemDate + "\nTitle: " + itemTitle + "\nDescription: " + itemDescription + "\n\n--------\n\n");
            }
        }
    }
} 
```

我知道有些人可能会告诉我使用 LINQ-to-XML，但这不是我现在关心的问题。我知道这条线`if (itemDescription.ToLower().Contains(comboTemplates.SelectedItem.ToString()))`没有做我想要的（它会搜索单词“AAA”而不是查看选定的 AAA 文本文件）。我可以知道如何正确编写此行以阅读所选文本文件中出现的单词/短语吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T22:42:28.117

静态`System.IO.File`类有一个`ReadAllLines`将文本文件的所有行读入数组的方法。

```
string[] words = File.ReadAllLines(filepath); 
```

如果组合只包含文件名，您可能需要先用目录名补充它

```
string dir = @"C:\MyDataPath";
string filename = comboTemplates.SelectedItem.ToString();
string filepath = Path.Combine(dir, filename); 
```

然后把这些词放到一个`HashSet<string>`

```
var wordSet = new HashSet<string>(words); 
```

然后使用正则表达式将您的描述拆分为单个单词

```
var descrWords = 
    new HashSet<string>(
        Regex.Matches(itemDescription.ToLower(), @"\w+")
        .Cast<Match>()
        .Select(m => m.Value)
    );
descrWords.UnionWith(wordSet);
if (descrWords.Count > 0) {
    // Your description contains at least one of the words
} 
```

* * *

您可以通过许多不同的方式进行比较。例如通过使用 LINQ

```
if (words.Union(
    Regex.Matches(itemDescription.ToLower(), @"\w+")
        .Cast<Match>()
        .Select(m => m.Value)
    ).Any())
{
    ...
} 
```

* * *

注意：只看一个字符串是否包含一个单词是不够的

```
s.Contains("great") 
```

因为它也会找到像“伟大”这样的词的一部分。

* * *

如果您还需要查找短语，则上述方法不起作用。您需要将 Regex 搜索与循环或 LINQ 语句结合起来。让我们使用类型的正则表达式

```
\bWordOrPhrase\b 
```

`\b`匹配单词边界。为了确保不会在正则表达式中引入一些特殊的正则表达式字符，我们需要对单词或短语进行转义。

```
bool found = Regex.IsMatch(description, @"\b" + Regex.Escape(wordOrPhrase) + @"\b"); 
```

最后，我们必须对列表中的所有单词和短语进行此测试。让我们把所有东西放在一起：

```
string dir = @"C:\MyDataPath";
string filename = comboTemplates.SelectedItem.ToString();
string filepath = Path.Combine(dir, filename);

string[] words = File.ReadAllLines(filepath); 
```

然后测试你的描述

```
string itemDescription = itemElement.GetElementsByTagName("description")[0].InnerText;
if (words.Any(
    wordOrPhrase =>
    Regex.IsMatch(itemDescription,
                  @"\b" + Regex.Escape(wordOrPhrase) + @"\b",
                  RegexOptions.IgnoreCase)))
{
    ...
} 
```

# python - 有人可以向我解释这个 python while 循环吗？

> ID：12030451
> 
> 赞同：0
> 
> 时间：2012-08-19T22:16:54.257
> 
> 标签：python, while-loop

我是python/编程初学者。我被分配了一个关于 MIT 开放课件的问题：

编写一个程序，计算每月最低固定还款额，以便在 12 个月内还清信用卡余额。

取`raw_input()`如下浮点数：

1) 信用卡未结余额 2) 年利率小数

打印出固定的最低还款额、偿还债务所需的月数（最多 12 个月，可能少于 12 个月）以及余额（可能为负数）。

假设利息按月初的余额按月复利（当月还款前）。每月付款必须是 10 美元的倍数，并且所有月份都相同。请注意，使用此付款方案，余额可能会变为负数。

答案是：

```
balance = float(raw_input('Enter the outstanding balance on your credit card: '))
interest = float(raw_input('Enter the annual credit card interest rate as a decimal: '))
minPay = 10
newBalance = balance

while balance > 0:
    for month in range(1,13):
        newBalance = newBalance*(1+(interest/12))-minPay
        if newBalance <=0:
            break
    if newBalance <= 0:
        balance = newBalance
    else:
        newBalance = balance
        minPay = minPay+10

print 'RESULT'
print 'Monthly payment to pay off debt in 1 year: ' + str(minPay)
print 'Number of months needed: ' + str(month)
print 'Balance: ' + str(round(balance,2)) 
```

我的问题：

1) 使用 1200 作为原始输入余额，使用 0.18 作为利率。有人能用文字解释一下你将如何得出 minPay = 120、month = 11 和 balance = - 10.05 吗？

我对 newBalance = newBalance* (1 +(interest/12)) - minPay 感到困惑。

使用 1200 作为余额将使 newBalance = 1200 * (1 +(.18/12)) - 10 = 1218 - 10 = 1208。

2) 由于 newBalance 不是 <= 0，程序将继续执行 else 语句。else 语句的 newBalance = balance 部分发生了什么。是否将 newBalance 分配回 1200（原始余额输入）。

我在理解这个问题时遇到了一些麻烦。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:40:50.840

我强烈建议像 python 解释器那样遍历代码的每一行，然后查看程序为什么按预期执行。

如果您对此很懒惰，请尝试在循环本身中放置一个打印语句，以查看每个变量在每一步的值是什么。这总是可以帮助我弄清楚代码在做什么。

至于你的问题，

1.  是的，New balance 确实具有您期望的价值

2.  是的，它确实被重新分配到平衡，在其他部分。您可能想要更改此设置。

因为，我不明白代码实际上在做什么，我无法帮助你正确的方法是什么，但尝试添加打印语句，它应该会有所帮助。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T22:27:41.987

> else 语句的`newBalance = balance`部分发生了什么？是否将 newBalance 分配回 1200（原始余额输入）。

对，就是那样。然后`minPay`增加并且循环再次开始。

随着`minPay`每次迭代的增加，`newBalance`最终将变为负数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-28T21:52:19.747

```
balance = 3329
annualInterestRate = 0.2

minimum_fixed_payment = 10
unpaid_balance = balance
MonthlyInterestRate = annualInterestRate / 12
month_count = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

while balance > 0:
    for month in month_count:
        unpaid_balance = unpaid_balance - minimum_fixed_payment
        interest = MonthlyInterestRate * unpaid_balance
        unpaid_balance = unpaid_balance + interest

        if unpaid_balance <= 0:
            break
    if unpaid_balance <= 0:
        balance = unpaid_balance
    else:
        unpaid_balance = balance
        minimum_fixed_payment = minimum_fixed_payment + 10

print "Lowest Payment: %s" % (minimum_fixed_payment) 
```

回答这个问题最简单的方法就是从这个角度来看，即使用最低固定还款，我们每月从未付余额中减去最低固定还款，然后检查剩余的值是否小于0。如果是是不是我们将最低固定付款增加 10 并重复该过程，直到我们的余额小于或等于零。

这就是我对代码所做的修改。

# javascript - Javascript Cookie 不工作

> ID：12030456
> 
> 赞同：0
> 
> 时间：2012-08-19T22:18:20.527
> 
> 标签：javascript, cookies

我有以下代码，但它似乎并没有达到它的意思。切换功能可以正常工作，只是 cookie 情况不行。当页面重新加载时，即使我在关闭框后刷新它，刷新框也不会重新关闭，而是保持打开状态。

```
<script type="text/javascript">
// this tells jquery to run the function below once the DOM is ready
$(document).ready(function() {

$("#forumposts-icon").toggle(function(){

if($.cookie('forumpoststoggle') == "toggle"){ 

$("#forumposts-toggle").slideUp('slow');
  this.src = "<?php bloginfo('template_url')?>/images/header_toggle_down.png";
  $("#forumposts-toggle").parent('.widget-content-wrapper').animate({ 
'padding-top' : 0,
'padding-right' : 20,
'padding-bottom' : 0,
'padding-left' : 20,
  }, "slow");

 }

$("#forumposts-toggle").slideUp('slow');
this.src = "<?php bloginfo('template_url')?>/images/header_toggle_down.png";
$("#forumposts-toggle").parent('.widget-content-wrapper').animate({ 
'padding-top' : 0,
'padding-right' : 20,
'padding-bottom' : 0,
'padding-left' : 20,
}, "slow"); 
$.cookie('forumpoststoggle','toggle');
} , 

function() { 
$("#forumposts-toggle").slideDown('slow');
this.src = "<?php bloginfo('template_url')?>/images/header_toggle_up.png";
$("#forumposts-toggle").parent('.widget-content-wrapper').animate({ 
'padding-top' : 20,
'padding-right' : 20,
'padding-bottom' : 20,
'padding-left' : 20,
}, "slow");
$.cookie('forumpoststoggle','NULL');
});

});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T22:22:08.250

没关系。得到它的工作。

认为问题是我在按钮切换中关闭了！傻我！

任何感兴趣的人的工作代码：

```
<script type="text/javascript">
// this tells jquery to run the function below once the DOM is ready
$(document).ready(function() {

$("#forumposts-icon").toggle(function(){

  $("#forumposts-toggle").slideUp('slow');
  this.src = "<?php bloginfo('template_url')?>/images/header_toggle_down.png";
  $("#forumposts-toggle").parent('.widget-content-wrapper').animate({ 
'padding-top' : 0,
'padding-right' : 20,
'padding-bottom' : 0,
'padding-left' : 20,
  }, "slow"); 
  $.cookie('forumpoststoggle','closed');
} , 

function() { 
$("#forumposts-toggle").slideDown('slow');
this.src = "<?php bloginfo('template_url')?>/images/header_toggle_up.png";
$("#forumposts-toggle").parent('.widget-content-wrapper').animate({ 
'padding-top' : 20,
'padding-right' : 20,
'padding-bottom' : 20,
'padding-left' : 20,
}, "slow");
$.cookie('forumpoststoggle','open');
});

var forumposts = $.cookie('forumpoststoggle');
 if (forumposts == 'closed') {

$("#forumposts-toggle").slideUp('slow');
this.src = "<?php bloginfo('template_url')?>/images/header_toggle_down.png";
$("#forumposts-toggle").parent('.widget-content-wrapper').animate({ 
'padding-top' : 0,
'padding-right' : 20,
'padding-bottom' : 0,
'padding-left' : 20,
}, "slow");

 }

});
</script> 
```

# database - SQLite 3 将旧表中的数据复制到新表中

> ID：12030468
> 
> 赞同：0
> 
> 时间：2012-08-19T22:20:32.790
> 
> 标签：database, sqlite

我有两个结构相同的表，我需要将几列从一个复制到另一个。像这样的东西：

*** 更新 ****

显然我需要更新新表。对于名称匹配的每条记录，我想将旧表中的数据复制到新表中。我不确定要使用什么命令。这是一个近似值：

```
copy from OLDTABLE columns category, key into NEWTABLE when the names match 
```

任何帮助或建议将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T23:30:47.760

您的查询没有正确的语法。它有两个 select 子句，其中第二个没有 from：

```
insert into newdata
    select category, key
    from olddata
    select category, key
    where olddata.name = newdata.name 
```

我猜你想要类似的东西：

```
insert into newdata(cateogry, key)
    select olddata.category, olddata.key
    from olddata 
    where olddata.name 
```

您真的想要插入，还是正在寻找更新？

# python - 返回给定字符数下的句子的函数

> ID：12030470
> 
> 赞同：2
> 
> 时间：2012-08-19T22:20:48.213
> 
> 标签：python

让我们假设我有以下段落：

```
"This is the first sentence. This is the second sentence? This is the third
 sentence!" 
```

我需要创建一个函数，它只返回给定字符数下的句子数。如果小于一个句子，它将返回第一个句子的所有字符。

例如：

```
>>> reduce_paragraph(100)
"This is the first sentence. This is the second sentence? This is the third
 sentence!"

>>> reduce_paragraph(80)
"This is the first sentence. This is the second sentence?"

>>> reduce_paragraph(50)
"This is the first sentence."

>>> reduce_paragraph(5)
"This " 
```

我从这样的事情开始，但我似乎无法弄清楚如何完成它：

```
endsentence = ".?!"
sentences = itertools.groupby(text, lambda x: any(x.endswith(punct) for punct in endsentence))
for number,(truth, sentence) in enumerate(sentences):
    if truth:
        first_sentence = previous+''.join(sentence).replace('\n',' ')
    previous = ''.join(sentence) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-19T22:40:45.570

由于英语的句法结构，处理句子非常困难。正如有人已经指出的那样，即使是最好的正则表达式，缩写之类的问题也会导致无休止的头痛。

您应该考虑[Natural Laungauge Toolkit](http://www.nltk.org)。特别是[punkt](http://nltk.org/api/nltk.tokenize.html#module-nltk.tokenize.punkt)模块。它是一个句子标记器，它将为您完成繁重的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T23:45:41.770

以下是使用[@BigHandsome 提到](https://stackoverflow.com/a/12030548/4279)[`punkt`](http://nltk.org/api/nltk.tokenize.html)的模块截断段落的方法：

```
from nltk.tokenize.punkt import PunktSentenceTokenizer

def truncate_paragraph(text, maxnchars,
                       tokenize=PunktSentenceTokenizer().span_tokenize):
    """Truncate the text to at most maxnchars number of characters.

    The result contains only full sentences unless maxnchars is less
    than the first sentence length.
    """
    sentence_boundaries = tokenize(text)
    last = None
    for start_unused, end in sentence_boundaries:
        if end > maxnchars:
            break
        last = end
    return text[:last] if last is not None else text[:maxnchars] 
```

### 例子

```
text = ("This is the first sentence. This is the second sentence? "
        "This is the third\n sentence!")
for limit in [100, 80, 50, 5]:
    print(truncate_paragraph(text, limit)) 
```

### 输出

```
这是第一句话。这是第二句？这是第三个
 句子！
这是第一句话。这是第二句？
这是第一句话。
这

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T22:43:47.477

如果我们忽略自然语言问题（即返回由“.?!”分隔的完整块的算法，其中总和小于 k），那么以下基本方法将起作用：

```
def sentences_upto(paragraph, k):
    sentences = []
    current_sentence = ""
    stop_chars = ".?!"
    for i, c in enumerate(paragraph):
        current_sentence += c
        if(c in stop_chars):
            sentences.append(current_sentence)
            current_sentence = ""
        if(i == k):
            break
    return sentences
        return sentences 
```

您的 itertools 解决方案可以这样完成：

```
def sentences_upto_2(paragraph, size):
    stop_chars = ".?!"
    sentences = itertools.groupby(paragraph, lambda x: any(x.endswith(punct) for punct in stop_chars))  
    for k, s in sentences:
        ss = "".join(s)
        size -= len(ss)
        if not k:
            if size < 0:
                return
            yield ss 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T00:02:00.220

您可以将此问题分解为更简单的步骤：

1.  给定一个段落，将其[拆分](http://docs.python.org/library/re.html#re.split)为句子
2.  弄清楚我们可以在不超过字符限制的情况下连接多少个句子
3.  如果我们至少可以容纳一个句子，那么将这些句子连接在一起。
4.  如果第一句话太长，就把第一句话删掉。

示例代码（未测试）：

```
 def reduce_paragraph(para, max_len):
        # Split into list of sentences
        # A sentence is a sequence of characters ending with ".", "?", or "!".
        sentences = re.split(r"(?<=[\.?!])", para)

        # Figure out how many sentences we can have and stay under max_len
        num_sentences = 0
        total_len = 0
        for s in sentences:
            total_len += len(s)
            if total_len > max_len:
                break
            num_sentences += 1

        if num_sentences > 0:
            # We can fit at least one sentence, so return whole sentences
            return ''.join(sentences[:num_sentences])
        else:
            # Return a truncated first sentence
            return sentences[0][:max_len] 
```

# javascript - 在javascript中将日期时间字符串转换为时间戳

> ID：12030478
> 
> 赞同：3
> 
> 时间：2012-08-19T22:23:07.080
> 
> 标签：javascript, date, time, timestamp

如果`dd = "2012-08-20 01:16:00";` 将此日期转换为时间戳（如以下代码所示）

```
var t = new Date(dd).getTime(); 
```

[http://jsfiddle.net/userdude/DHxwR/](http://jsfiddle.net/userdude/DHxwR/)

结果`t = NaN`为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-19T22:25:59.007

根据[ECMA-262](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)（第 15.9.1.15 节，*日期时间字符串格式*，第 169 页），唯一需要接受的日期字符串格式是：

```
[+YY]YYYY[-MM[-DD]][THH:mm[:ss[.sss]]]Z 
```

其中`Z`是`Z`（对于 UTC）或由 a`+`或 a组成的偏移量，`-`后跟`HH:mm`. 不应依赖特定浏览器碰巧支持的任何其他格式，因为不能保证持续支持。

因此，将空格替换为 a`T`并附加 a`Z`或固定时区偏移量，然后再将其传递给`Date`构造函数。例如，如果日期和时间在 UTC+8 时区：

```
var dd = "2012-08-20 01:16:00";
var t = new Date(dd.replace(' ', 'T') + '+08:00').getTime(); 
```

这将返回从 1970 年 1 月 1 日午夜 UTC 到您指定的日期的毫秒数，被视为通用时间（如果您附加`Z`了 ）或您指定的固定时区偏移的本地时间。

请注意，这会有所不同，因为日期不会像您的问题示例那样被简单地视为用户系统时区的本地时间。但是，我想不出这样做会有用的情况，因为根据用户的配置，您会得到不同的结果——但实际上，无论您身在何处，两个日期之间的时间差总是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T22:34:06.100

尝试在年、月和日值之间使用空格或逗号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T06:11:44.750

这很简单：

```
+(new Date("2012-08-20 01:16:00")); 
```

# javascript - Javascript 为用户名解析 Reddit 评论页面

> ID：12030480
> 
> 赞同：0
> 
> 时间：2012-08-19T22:23:32.380
> 
> 标签：javascript, bookmarklet, reddit

我正在为 Sub reddit 制作一个书签，我正在尝试获取评论页面上的所有用户名，以便我可以解析它们，然后返回并更新它们旁边的信息，类似于 RES 所做的。每个评论的作者都有一个以 Author 为前缀的类，但在类名的末尾有不同的内容。我将如何获取所有用户名？

然后，一旦我有了列表，我将如何使用附加图标来更新每个列表？

任何做类似事情的建议/教程都会很棒。

编辑：我不太确定标记的哪些部分会有所帮助，而不会给出一个巨大的块。这是我在 Javascript Subreddit 中提出的相同问题。[http://www.reddit.com/r/javascript/comments/yhp7j/best_way_to_find_all_the_usernames_on_a_reddit/](http://www.reddit.com/r/javascript/comments/yhp7j/best_way_to_find_all_the_usernames_on_a_reddit/)

您应该能够检查名称元素并查看我正在使用的内容。

目前正在使用这个： http: [//net.tutsplus.com/tutorials/javascript-ajax/create-bookmarklets-the-right-way/](http://net.tutsplus.com/tutorials/javascript-ajax/create-bookmarklets-the-right-way/)

所以我有一个 Hello World Style Bookmarklet 工作，它检查 Jquery 并在它不存在时加载它，并且只是抛出一个警报。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:08:23.747

快速查看您在问题中链接到的页面，*似乎*围绕用户名的标记如下（可能使用您的用户名作为示例）：

```
<a href="http://www.reddit.com/user/DiscontentDisciple" class="author id-t2_4allq" >DiscontentDisciple</a> 
```

如果是这种情况，并且 jQuery 库可用（同样，从您的问题来看），一种方法是简单地使用：

```
var authors = [];

$('a.author').html(
    function(i, h) {
        var authorName = $(this).text();
        if ($.inArray(authorName, authors) == -1) {
            authors.push(authorName); // an array of author-names
        }
        return '<img src="path/to/' + encodeURIComponent(authorName) + '-image.png" / >' + h;
    });

console.log(authors); 
```

[JS Fiddle 概念验证](http://jsfiddle.net/davidThomas/qBdLk/1/)。

或者，类似地，只需使用用户名似乎是可以预见的`a`元素`href`属性中 URL 的最后一部分的事实：

```
var authors = [];

$('a.author').html(
    function(i, h) {
        var authorName = this.href.split('/').pop();
        if ($.inArray(authorName, authors) == -1) {
            authors.push(authorName);
        }
        return '<img src="http://www.example.com/path/to/' + authorName+ '-image.png" />' + h;
    });

console.log(authors); 
```

[JS Fiddle 概念验证](http://jsfiddle.net/davidThomas/qBdLk/2/)。

这两种方法都将 in 放入元素`img` *中*`a`。如果你想要它*在*元素之前，`a`那么只需使用：

```
// creates an 'authors' variable, and sets it to be an array.
var authors = [];

$('a.author').each( // iterates through each element returned by the selector
    function() {
        var that = this, // caches the this variable, rather than re-examining the DOM.
            // takes the href of the current element, splits it on the '/' characters,
            // and returns the *last* of the elements from the array formed by split()
            authorName = that.href.split('/').pop();

        // looks to see if the current authorName is in the authors array, if it *isn't*
        // the $.inArray returns -1 (like indexOf())
        if ($.inArray(authorName, authors) == -1) {
            // if authorName not already in the array it's added to the array using
            // push()
            authors.push(authorName);
        }

        // creates an image element, concatenates the authorName variable into the
        // src attribute-value
        $('<img src="http://www.example.com/path/to/' + authorName+ '-image.png" />')
            // inserts the image before the current (though converted to a jQuery
            // object in order to use insertBefore()
            .insertBefore($(that));
    });

console.log(authors);
​ 
```

[JS Fiddle 概念验证](http://jsfiddle.net/davidThomas/qBdLk/5/)。

参考：

*   [`each()`](http://api.jquery.com/each/).
*   [`$.inArray()`](http://api.jquery.com/jQuery.inArray/).
*   [`insertBefore()`](http://api.jquery.com/insertBefore/).

# canvas - 如何在视口中将动态大小的画布居中？

> ID：12030481
> 
> 赞同：0
> 
> 时间：2012-08-19T22:23:39.797
> 
> 标签：canvas, resize, center

我已经为此苦苦挣扎了一段时间，希望大家能提供帮助。我有一个动态大小的画布，它根据拒绝居中的画布大小绘制一个网格。我已经尝试了这个网站的很多建议，但它们似乎都适用于固定宽度的画布。这对我不起作用..

这是所有代码，因此您可以看到我正在做的一切。我正在使用 mootools 来动态调整画布和内容的大小。如果有一种方法可以在没有任何人都知道的 mootools 的情况下调整大小，那也很棒。

谢谢！

HTML

```
<!doctype html>
<html>
        <LINK href="style.css" rel="stylesheet" type="text/css">
<head>
<meta charset="utf-8">
        <script type='text/javascript' src='https://my-youtube.googlecode.com/files/mootools-core-1.4.2-full-nocompat.js'></script>
        <script type='text/javascript' src="chessboard.js"></script>
<title>Untitled Document</title>
</head>

<body>

<div id="header"></div>
<div id="content">
    <canvas id="canvas">TEST</canvas>
</div>

<div id="footer"></div>

</body>
</html> 
```

CSS

```
@charset "utf-8";
/* CSS Document */

#header {
    margin-top: 0px;
    height: 75px;
    width: 100%;
    background: url(images/logo1.png) no-repeat top center;
}

#content {
    width: 100%;
    height: 100%-75px;
}

#footer {

}

body, html {
    margin-left: auto;
    margin-right: auto;
    margin-top: 0;
    background-color: #a6a6a6;
    background-image: url(images/background_image3.jpg);
    background-repeat: repeat-x;
    height: 100%;
} 
```

Javascript

```
window.addEvent('load', function() {
(function() {
    var canvas = document.getElementById('canvas'),
    context = canvas.getContext('2d');

// resize the canvas to fill browser window dynamically
    window.addEventListener('resize', resizeCanvas, false);

    function resizeCanvas() {
        canvas.height = window.innerHeight-100;
        canvas.width = canvas.height;

        drawStuff();
    }

resizeCanvas();

    function drawStuff() {

        var width = canvas.height/8;
        var baseX = 0.5, baseY = 0.5;

// draws the 8 by 8 chessboard
        for (var i = 0; i < 8; i++) {
            for (var j = 0; j < 8; j++) {
                var x = baseX + width * i, y = baseY + width * j;
                context.strokeRect(x, y, width, width);
                if ((i + j) % 2 != 0) {
                    context.fillStyle = '#BA1A1A';
                    context.fillRect(x, y, width, width);
                }
                if ((i + j) % 2 == 0) {
                    context.fillStyle = 'E6A3A3';
                    context.fillRect(x, y, width, width);
                }
            }
        }
    }
})();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T22:57:31.007

多亏了这个问题的答案，我才明白了这一点：[Centering a div block without the width](https://stackoverflow.com/questions/283961/centering-a-div-block-without-the-width)

简而言之，`display: inline block;`在 CSS 中使用 div 容器。然后`text-align: center;`在该 div 的父容器中使用。

所以，就我而言：

```
#content {
    margin: 0 auto;
    text-align: left;
    background-color: black;
    display: inline-block;
    margin-left: auto;
    margin-right: auto;
}

body, html {
    margin-left: auto;
    margin-right: auto;
    margin-top: 0;
    background-color: #a6a6a6;
    background-image: url(images/background_image3.jpg);
    background-repeat: repeat-x;
    height: 100%;
    text-align:center;
} 
```

# php - 执行我的查询时出现 sql 语法错误

> ID：12030485
> 
> 赞同：0
> 
> 时间：2012-08-19T22:25:17.243
> 
> 标签：php, mysql, sql

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 12 行的“CREATE TABLE IF NOT EXISTS administracia(userID INT(255) NOT NULL AUTO_INCREME”附近使用正确的语法

这是查询或多或少也更具可读性的[版本](http://pastebin.com/4aw1buTp)

```
$data = "
CREATE TABLE IF NOT EXISTS zamestnanci(
userID INT(255) NOT NULL AUTO_INCREMENT,
osobnecislo VARCHAR(50) NOT NULL,
meno VARCHAR(50) NOT NULL,
priezvisko VARCHAR(50) NOT NULL,
nick VARCHAR(50) NOT NULL,
heslo CHAR(128) NOT NULL,
previerka VARCHAR(15) NOT NULL,
PRIMARY KEY (userID,nick)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS administracia(
userID INT(255) NOT NULL AUTO_INCREMENT,
osobnecislo VARCHAR(50) NOT NULL,
meno VARCHAR(50) NOT NULL,
priezvisko VARCHAR(50) NOT NULL,
nick VARCHAR(50) NOT NULL,
heslo CHAR(128) NOT NULL,
previerka VARCHAR(15) NOT NULL,
PRIMARY KEY (userID,nick)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS navrhy(
navrhID INT(255) NOT NULL AUTO_INCREMENT,
nazov VARCHAR(50) NOT NULL,
text VARCHAR(505) NOT NULL,
schvalenie VARCHAR(15) NOT NULL,
datum VARCHAR(50)  NOT NULL,
pridal VARCHAR(50) NOT NULL,
hlasovali VARCHAR(8000) NOT NULL,
kategoria VARCHAR(50) NOT NULL,
stroj VARCHAR(50) NOT NULL,
ano VARCHAR(1000) NOT NULL,
nie VARCHAR(1000) NOT NULL default '0',
PRIMARY KEY (navrhID)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS problemovyartikel(
artikelID INT(255) NOT NULL AUTO_INCREMENT,
artikelcisloVARCHAR(50) NOT NULL,
text VARCHAR(255) NOT NULL,
datum VARCHAR(50) NOT NULL,
pridal tinytext NOT NULL,
problem_cislo VARCHAR(100) NOT NULL,
PRIMARY KEY (artikelID)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS kategorie(
kategoriaID INT(255) NOT NULL AUTO_INCREMENT,
Nkategoria VARCHAR(50) NOT NULL,
Pkategoria VARCHAR(50) NOT NULL,
PRIMARY KEY (kategoriaID)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS novinky(
novinkaID INT(255) NOT NULL AUTO_INCREMENT,
novinka mediumtext NOT NULL,
PRIMARY KEY (novinkaID)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS stroje(
strojID INT(255) NOT NULL AUTO_INCREMENT,
stroj text NOT NULL,
PRIMARY KEY (strojID)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS kontakt(
kontaktID INT(255) NOT NULL AUTO_INCREMENT,
pole1 text NOT NULL,
pole2 text NOT NULL,
PRIMARY KEY (kontaktID)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS problem_cislo(
problem_cisloID INT(255) NOT NULL AUTO_INCREMENT,
problem_cislo VARCHAR(100) NOT NULL,
PRIMARY KEY (problem_cisloID)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS stranky(
strankaid INT(255) NOT NULL AUTO_INCREMENT,
stranka mediumtext NOT NULL,
stranka_obsah longtext NOT NULL,
subor mediumtext NOT NULL,
PRIMARY KEY (strankaid)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS chyby(
strankaid INT(255) NOT NULL AUTO_INCREMENT,
stranka CHAR(128) NOT NULL,
stranka_obsah VARCHAR(15) NOT NULL,
PRIMARY KEY (strankaid)) 
ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;

INSERT INTO administracia (userID,osobnecislo,meno,priezvisko,nick,heslo,previerka) VALUES('1','admin','admin','admin','admin','59db9e61d015935901442385d992dd34346dbe3439174fee700b56f27ad445ee42e052c0c014892a70cea63b912c7a3ee55c7c42e9e36e0f169ab7e6b886fd21','admin');
INSERT INTO kategorie (kategoriaID,Nkategoria) VALUES('1','kategoria1');
INSERT INTO novinky (novinkaID,novinka) VALUES('1','novinka1<br>novinka2');
INSERT INTO stroje (strojID,stroj) VALUES('1','stroj1');
INSERT INTO kontakt (kontaktID,pole1,pole2) VALUES('1','testificate','0912 345 678');
INSERT INTO problem_cislo (problem_cisloID,problem_cislo) VALUES('1','problem1');
INSERT INTO chyby (strankaid,stranka_obsah,stranka) VALUES('1','Registrácia prebehla úspešne!','úspech'),('2','Návrh bol úspešne pridaný!','úspech'),('3','Problémový artikel bol úspešne pridaný!','úspech'),('4','Aktivácia prebehne čo najskôr alebo ste zadali nesprávne údaje!,'totok')"; 
```

### 编辑：

使用以下函数拆分和执行查询：

```
$queries = preg_split("/;+(?=([^'|^\\\']*['|\\\'][^'|^\\\']*['|\\\'])*[^'|^\\\']*[^'|^\\\']$)/",$data); 
foreach ($queries as $query) 
  if(strlen(trim($query)) > 0) 
     mysql_query($query); { 
     $spracovat = mysql_query($data,$prepojenie) or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-19T22:31:16.897

您似乎将整个事情都塞进了一个 PHP 变量中。大多数 PHP MySQL API 每次执行只接受一个语句，所以你不能将所有这些组合成一个语句，除非你使用类似[`MySQLi::multi_query()`](http://php.net/manual/en/mysqli.multi-query.php).

与其将所有这些打包到一个变量中并尝试使用 解析单个查询`preg_split()`，我建议创建一个查询数组并循环执行它们。这使得代码更清晰，更不容易出错。

```
$queries = array(

     'CREATE TABLE IF NOT EXISTS zamestnanci(
    userID INT(255) NOT NULL AUTO_INCREMENT,
    osobnecislo VARCHAR(50) NOT NULL,
    meno VARCHAR(50) NOT NULL,
    priezvisko VARCHAR(50) NOT NULL,
    nick VARCHAR(50) NOT NULL,
    heslo CHAR(128) NOT NULL,
    previerka VARCHAR(15) NOT NULL,
    PRIMARY KEY (userID,nick)) 
    ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;',

    'CREATE TABLE IF NOT EXISTS administracia(
    userID INT(255) NOT NULL AUTO_INCREMENT,
    osobnecislo VARCHAR(50) NOT NULL,
    meno VARCHAR(50) NOT NULL,
    priezvisko VARCHAR(50) NOT NULL,
    nick VARCHAR(50) NOT NULL,
    heslo CHAR(128) NOT NULL,
    previerka VARCHAR(15) NOT NULL,
    PRIMARY KEY (userID,nick)) 
    ENGINE=INNODB DEFAULT CHARSET=UTF8 AUTO_INCREMENT=1;',
    ...
);

foreach ($queries as $query) {
   // Execute the query, test for errors, etc.
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-19T22:31:20.143

您可能会使用 发出这个`mysql_query`，它只能发送一个查询，而不是包含 18 的字符串。

# python - Mongo 条件为“密钥不存在”？

> ID：12030487
> 
> 赞同：22
> 
> 时间：2012-08-19T22:26:06.870
> 
> 标签：python, mongodb, pymongo, key-value

如果 key == None 或 key 不存在，我想使用条件查找文档。像这样的东西：

```
myDoc = self.request.root.db.myDocs.find_one({
                          '$or': [
                              {'myKey' : $doesNotExist } ,
                              {'myKey' : None }
                            ]
                    }) 
```

我还希望能够通过这样的缺失键找到文档：

```
myDoc = self.request.root.db.myDocs.find_one( {'myKey' : $doesNotExist } ) 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-18T21:31:23.687

对于“如果键存在”检查，使用 a`.find()`明显[快](http://blog.serverdensity.com/checking-if-a-document-exists-mongodb-slow-findone-vs-find/)于`find_one()`.

*单一文件：* `cursor = db.myDocs.find({"mykey": {"$exists": True}}).limit(1)`

*多个文件：* `cursor = db.myDocs.find({"mykey": {"$exists": True}})`

```
if cursor.count() > 0:
    keyExists = True
else:
    keyExists = False 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-19T22:49:08.087

您可以使用以下方法测试不存在的密钥：

```
db.myDocs.find_one({'myKey': { '$exists': False }}) 
```

关于[$exists 运算符的 Mongo 文档](http://docs.mongodb.org/manual/reference/operator/query/exists/#op._S_exists)

# mercurial - HG 测试合并然后提交

> ID：12030489
> 
> 赞同：0
> 
> 时间：2012-08-19T22:26:19.373
> 
> 标签：mercurial, merge, branch, commit

我想将一个功能分支与另一个合并，并测试代码。

我可以做一个合并，在分支上运行代码，然后如果我满意，`Commit`？

这会有什么负面影响吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T22:33:41.157

不，它不会产生任何负面影响——事实上，这就是你应该做的。

# c++ - C++ 使用模板来避免编译器检查布尔值

> ID：12030497
> 
> 赞同：22
> 
> 时间：2012-08-19T22:28:36.770
> 
> 标签：c++, templates, boolean

假设我有一个功能：

```
template <bool stuff>
inline void doSomething() {
    if(stuff) {
        cout << "Hello" << endl;
    }
    else {
        cout << "Goodbye" << endl;
    }
} 
```

我这样称呼它：

```
doSomething<true>();
doSomething<false>(); 
```

它会弹出：

```
Hello
Goodbye 
```

我真正想知道的是编译器是否完全优化了这个？当我用 true 调用模板化函数时，它会创建一个只输出“Hello”并避免 if 语句和“Goodbye”代码的函数吗？

这对于我刚刚编写的这个巨大的函数非常有用，它应该是非常优化的，并且尽可能地避免了不必要的 if 语句检查。我有一种很好的感觉，至少在带有优化的发布版本中，如果不是在没有优化的调试版本中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-25T12:13:29.770

免责声明：没有人可以保证任何事情。

也就是说，对于任何编译器来说，这都是一个明显而简单的优化。可以肯定地说，它将被优化掉，除非优化器实际上是无用的。

由于您的“真”和“假”是常量，因此您明确地在每个类中创建了一个明显的死分支，编译器应该优化它。应该在这里按字面意思理解 - 如果“优化”编译器没有删除死分支，我会认为这是一个主要的主要问题。

换句话说，如果您的编译器无法对此进行优化，那么应该评估的是该编译器的使用，而不是代码。

所以，我想说你的直觉是正确的：虽然是的，不能对每个编译器做出这样的“保证”，但我不会使用无法在任何生产环境中执行简单优化的编译器，当然也不会在任何对性能至关重要的。（当然在发布版本中）。

**所以，使用它。任何现代优化编译器都会将其优化掉，因为它是一种微不足道的优化。如果有疑问，请检查反汇编，如果未优化，请将编译器更改为更现代的编译器。**

一般来说，如果您正在编写任何类型的性能关键代码，您必须至少在某种程度上依赖编译器优化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-19T22:40:29.350

这本质上取决于编译器，因此您必须检查编译器的文档或生成的代码。但是在像这样的简单情况下，您可以轻松地自己实现优化：

```
template <bool stuff>
inline void doSomething();

template<>
inline void doSomething<true>() {
    cout << "Hello" << endl;
}

template<>
inline void doSomething<false>() {
    cout << "Goodbye" << endl;
} 
```

但是“优化”并不是一个真正合适的词，因为这实际上可能会降低性能。如果它确实有益于您的代码性能，它只是一种优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T22:37:13.230

确实，它确实创建了两个功能，但是

> 过早优化是万恶之源

特别是如果您因为一个简单的 if 语句而更改了代码结构。我怀疑这会影响性能。此外，布尔值必须是静态的，这意味着您不能获取运行时评估的 var 并将其传递给函数。链接器应该如何知道要调用哪个函数？在这种情况下，您必须手动评估它并自行调用相应的函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-19T23:01:13.393

编译器非常擅长不断折叠。也就是说，在这种情况下，如果检查会一直保留到优化之后，我会感到惊讶。未优化的构建可能仍然有检查。最简单的验证方法是创建汇编程序输出并检查。

也就是说，值得注意的是编译器必须检查两个分支的正确性，即使它只使用一个分支。这经常出现，例如，当对随机访问迭代器和其他迭代器使用稍微不同的算法时。该条件将取决于类型特征，并且其中一个分支可能无法编译，具体取决于特征测试的操作。*委员会已经讨论过在静态*术语下关闭这种检查，如果虽然没有达成共识，但是关于功能的外观如何（如果它被添加）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-19T22:37:24.633

如果我对您的理解正确，您希望（本质上）最终得到“两个”功能，这些功能针对真或假输入进行了优化，以便他们不需要检查该标志？

除了可能产生的任何微不足道的优化（我反对过早的优化 - 我相信在优化之前测量之前的可维护性），我会说为什么不将你的函数重构为实际上是两个函数呢？如果他们有共同的代码，那么该代码也可以被重构出来。但是，如果要求是重构不是最佳的，那么我将用#define 重构替换它。

# jquery - jsTree 搜索不起作用：未捕获的类型错误：无法读取未定义的属性“3”

> ID：12030502
> 
> 赞同：0
> 
> 时间：2012-08-19T22:30:24.633
> 
> 标签：jquery, search, jstree, typeerror, uncaught-exception

有一次我有这个工作，然后当我更新代码以添加其他功能时，搜索功能不知何故坏了。我试过到处寻找，但我没有想法。有任何想法吗？

这是我的代码：

```
<!-- jsTree -->
<script type="text/javascript" src="<?php echo $ROOTPATH; ?>assets/jstree/_lib/jquery.cookie.js"></script>
<script type="text/javascript" src="<?php echo $ROOTPATH; ?>assets/jstree/_lib/jquery.hotkeys.js"></script>
<script type="text/javascript" src="<?php echo $ROOTPATH; ?>assets/jstree/jquery.jstree.js"></script>

<div id="description">
    <div id="mmenu" style="height:30px; overflow:auto;">
        <input type="button" class="button_tasklist" id="add_folder" value="Add Unit" style="display:block; float:left;"/>
        <input type="button" class="button_tasklist" id="add_default" value="Add Task" style="display:block; float:left;"/>
        <!-- <input type="button" class="button_tasklist" id="rename" value="Rename" style="display:block; float:left;"/> -->
        <input type="button" class="button_tasklist" id="remove" value="Remove" style="display:block; float:left;"/>
        <input type="button" class="button_tasklist" id="cut" value="Cut" style="display:block; float:left;"/>
        <input type="button" class="button_tasklist" id="copy" value="Copy" style="display:block; float:left;"/>
        <input type="button" class="button_tasklist" id="paste" value="Paste" style="display:block; float:left;"/>
        <input type="button" class="button_tasklist" id="clear_search" value="Clear" style="display:block; float:right;"/>
        <input type="button" class="button_tasklist" id="search" value="Search" style="display:block; float:right;"/>
        <input type="text" id="search_text" value="" style="display:block; float:right;" />
    </div>
</div>

<!-- the tree container (notice NOT an UL node) -->
<div id="demo" class="demo" style="min-height: 400px; overflow-y:visible; overflow-x:scroll"></div>

    <!-- JavaScript neccessary for the tree -->
    <script type="text/javascript">
        $(function () {

        $("#demo")
            .bind("loaded.jstree", function (e, data) {
                    data.inst.open_all(-1); // -1 opens all nodes in the container
                })
            .jstree({ 

                // List of active plugins
                "plugins" : [ 
                    "themes","json_data","ui","crrm","cookies","dnd","search","types","hotkeys","contextmenu" 
                ],

                // I usually configure the plugin that handles the data first
                // This example uses JSON as it is most common
                "json_data" : { 
                    // This tree is ajax enabled - as this is most common, and maybe a bit more complex
                    // All the options are almost the same as jQuery's AJAX (read the docs)
                    "ajax" : {
                        // the URL to fetch the data
                        "url" : "server.php",
                        // the `data` function is executed in the instance's scope
                        // the parameter is the node being loaded 
                        // (may be -1, 0, or undefined when loading the root nodes)
                        "data" : function (n) { 
                            // the result is fed to the AJAX request `data` option
                            return { 
                                "operation" : "get_children", 
                                "id" : n.attr ? n.attr("id").replace("node_","") : 1 
                            }; 
                        }
                    }
                },
                // Configuring the search plugin
                "search" : {
                    "case_insensitive" : true,

                    // As this has been a common question - async search
                    // Same as above - the `ajax` config option is actually jQuery's AJAX object
                    "ajax" : {
                        "url" : "server.php",
                        // You get the search string as a parameter
                        "data" : function (str) {
                            return { 
                                "operation" : "search", 
                                "search_str" : str 
                            }; 
                        }
                    }
                },
                // Using types - most of the time this is an overkill
                // read the docs carefully to decide whether you need types
                "types" : {
                    // I set both options to -2, as I do not need depth and children count checking
                    // Those two checks may slow jstree a lot, so use only when needed
                    "max_depth" : 3,
                    "max_children" : -2,
                    // I want only `drive` nodes to be root nodes 
                    // This will prevent moving or creating any other type as a root node
                    "valid_children" : [ "drive" ],
                    "types" : {
                        // The default type
                        "default" : {
                            // I want this type to have no children (so only leaf nodes)
                            // In my case - those are files
                            "valid_children" : "none",
                            // If we specify an icon for the default type it WILL OVERRIDE the theme icons
                            "icon" : {
                                "image" : "file.png"
                            }
                        },
                        // The `folder` type
                        "folder" : {
                            // can have files and other folders inside of it, but NOT `drive` nodes
                            "valid_children" : [ "default" ],
                            "icon" : {
                                "image" : "folder.png"
                            }
                        },
                        // The `drive` nodes 
                        "drive" : {
                            // can have files and folders inside, but NOT other `drive` nodes
                            "valid_children" : [ "folder" ],
                            "icon" : {
                                "image" : "root.png"
                            },
                            // those prevent the functions with the same name to be used on `drive` nodes
                            // internally the `before` event is used
                            "start_drag" : false,
                            "move_node" : false,
                            "delete_node" : false,
                            "remove" : false
                        }
                    }
                },
                // UI & core - the nodes to initially select and open will be overwritten by the cookie plugin

                // the UI plugin - it handles selecting/deselecting/hovering nodes
                "ui" : {
                    // this makes the node with ID node_2 selected onload
                    "initially_select" : [ "node_2" ]
                },
                // the core plugin - not many options here
                "core" : { 
                    // just open those two nodes up
                    // as this is an AJAX enabled tree, both will be downloaded from the server
                    //"initially_open" : [ "node_2" , "node_3" ],
                    "strings" : { "new_node" : "Type task/unit title..." } 
                }
            })
            .bind("create.jstree", function (e, data) {
                $.post(
                    "server.php", 
                    { 
                        "operation" : "create_node", 
                        "id" : data.rslt.parent.attr("id").replace("node_",""), 
                        "position" : data.rslt.position,
                        "title" : data.rslt.name,
                        "type" : data.rslt.obj.attr("rel")
                    }, 
                    function (r) {
                        if(r.status) {
                            $(data.rslt.obj).attr("id", "node_" + r.id);
                        }
                        else {
                            $.jstree.rollback(data.rlbk);
                        }
                    }
                );
            })
            .bind("search.jstree", function (e, data) {
                alert("Found " + data.rslt.nodes.length + " nodes matching '" + data.rslt.str + "'.");
            })
            .bind("remove.jstree", function (e, data) {
                data.rslt.obj.each(function () {
                    $.ajax({
                        async : false,
                        type: 'POST',
                        url: "server.php",
                        data : { 
                            "operation" : "remove_node", 
                            "id" : this.id.replace("node_","")
                        }, 
                        success : function (r) {
                            if(!r.status) {
                                data.inst.refresh();
                            }
                        }
                    });
                });
            })
            .bind("rename.jstree", function (e, data) {
                $.post(
                    "server.php", 
                    { 
                        "operation" : "rename_node", 
                        "id" : data.rslt.obj.attr("id").replace("node_",""),
                        "title" : data.rslt.new_name
                    }, 
                    function (r) {
                        if(!r.status) {
                            $.jstree.rollback(data.rlbk);
                        }
                    }
                );
            })
            .bind("move_node.jstree", function (e, data) {
                data.rslt.o.each(function (i) {
                    $.ajax({
                        async : false,
                        type: 'POST',
                        url: "server.php",
                        data : { 
                            "operation" : "move_node", 
                            "id" : $(this).attr("id").replace("node_",""), 
                            "ref" : data.rslt.cr === -1 ? 1 : data.rslt.np.attr("id").replace("node_",""), 
                            "position" : data.rslt.cp + i,
                            "title" : data.rslt.name,
                            "copy" : data.rslt.cy ? 1 : 0
                        },
                        success : function (r) {
                            if(!r.status) {
                                $.jstree.rollback(data.rlbk);
                            }
                            else {
                                $(data.rslt.oc).attr("id", "node_" + r.id);
                                if(data.rslt.cy && $(data.rslt.oc).children("UL").length) {
                                    data.inst.refresh(data.inst._get_parent(data.rslt.oc));
                                }
                            }
                            $("#analyze").click();
                        }
                    });
                });
            });
        });

        $("#demo").on("dblclick", "a", function(e) {
            // double-click to add additional info for each node
            var node = $(event.target).closest("li");
            var data = node.data("jstree");
            var idn = $(this).parent().attr("id").split("_")[1];
            // or
            //var id = node[0].id; //id of the selected node

            //alert("Dbl-clicked Node ID: "+idn); //return NodeID   

            showFancybox("edit_task.php?id="+idn);

            // or do something via ajax!
            //$.ajax({
            //  type: "POST",
            //    url: "http://www.google.com",
            //  data: "id="+$(this).parent().get(0).id,
            //  success: function(data){
            //      $("#ajaxcontent").html(data);
            //  }
            //});
        });

        $("#demo").bind("before.jstree", function (e, data) { 
          if(data.func === "remove" && !confirm("Are you sure you want to delete?")) { 
            e.stopImmediatePropagation(); 
            return false; 
          } 
        })
    </script>
    <script type="text/javascript">
        // Code for the menu buttons
        $(function () { 
            $("#mmenu input").click(function () {
                switch(this.id) {
                    case "add_default":
                    case "add_folder":
                        $("#demo").jstree("create", null, "last", { "attr" : { "rel" : this.id.toString().replace("add_", "") } });
                        break;
                    case "search":
                        $("#demo").jstree("search", document.getElementById("search_text").value);
                        break;
                    case "text": break;
                    default:
                        $("#demo").jstree(this.id);
                        break;
                }
            });
        });
    </script>
</div> 
```

这是错误所在：

![在此处输入图像描述](../Images/e012481b16b4417e7b31185fb9bf2640.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T03:02:51.903

我不太确定问题出在哪里，但它似乎已经自行解决，现在又可以正常工作了。我认为我在页面某处的其他代码与 jsTree 冲突？没有把握。

# ruby-on-rails-3 - Rails 3为DataTable中的选定行加载编辑视图

> ID：12030510
> 
> 赞同：0
> 
> 时间：2012-08-19T22:32:08.577
> 
> 标签：ruby-on-rails-3, datatables

我已经为此苦苦挣扎了一段时间。除了一些具体的帮助外，我将不胜感激一些指示，我可以如何填补我的知识空白。顺便说一句，我是 Rails 和 Web 开发的新手。我使用 DataTables 来显示表记录，并有一些代码向我显示用户选择的行的 ID。在我的索引视图中，我想使用该行 ID 来加载该数据行的编辑视图。我的 .js 代码如下：

```
$(document).ready(function() {

/* Init the table */
TableTools.DEFAULTS.aButtons = [];
oTable = $("#highways").dataTable({
     sPaginationType: "full_numbers",
     bJQueryUI: true, 
     "bProcessing": true,
     "bServerSide": true,
     iDisplayLength: 25,
     sAjaxSource: $('#highways').data('source'),
     "aoColumns": [
        null,
        null,
        null,
        null,
        null
     ],
     "sDom": 'T<"clear">lfrtip',
     "oTableTools": {
       "sRowSelect": "single",
       "fnRowSelected": function ( node ) {
         var oTT = TableTools.fnGetInstance('highways');
         var aData = oTT.fnGetSelectedData();
         var n = '/highways/' + aData[0][4] + '/edit'
         alert(n);
         var jqxhr = $.get(n, function() {
          alert("success");
          })
       }
     },

});
} ); 
```

开发日志显示：

> 在 2012-08-21 07:57:14 +1000 开始 GET "/highways/8/edit" for 127.0.0.1 由 HighwaysController#edit as */* 参数处理：{"id"=>"8"} [1m[35mHighway加载（0.3ms）[0m SELECT `highways`.* FROM `highways`WHERE `highways`. `id`>= 8 LIMIT 1 Highway BARKLY HIGHWAY 渲染的 Highways/_form.html.erb (67.1ms) 在 layouts/highways 内渲染的 Highways/edit.html.erb (258.5ms) 在 276ms 内完成 200 OK (Views: 274.6ms | ActiveRecord: 0.3小姐）

我在控制器代码中尝试了各种方法，在某些情况下，日志显示编辑视图已被重新渲染，但它没有显示在浏览器中。当前控制器代码：

```
class HighwaysController < ApplicationController
  respond_to :html, :json

def index
 #   @highways = Highway.all
 #   logger.debug "Highway Count: #{@highways.size}"
  respond_to do |format|
    format.html
    format.json { render json: HighwaysDatatable.new(view_context) }
  end 
```

结尾

def edit # logger.debug "Edit (render :layout => false) Highway ID #{params[:id]}" @highway = Highway.find(params[:id]) logger.debug "Highway #{@highway. name}" # 渲染 response_to 做 |format| format.html format.json { 渲染 json: HighwaysDatatable.edit(view_context) } 结束

$.get 返回 JSON 吗？

我也尝试过不同的方法。我在索引视图中有一个 link_to：

```
 <div id ="highway_edit" >
   <% @n = 11.to_s %>
   <%= link_to "Edit 2", edit_highway_path(@n), :remote => true %>
 </div> 
```

这个硬编码版本有效，但我找不到从 javascript 代码中修改该链接以使其反映所选行 ID 的方法，或者调用将行 ID 返回到变量 @n 的函数。

我意识到我必须缺少一些基础知识，因此我将不胜感激一些建议的教育起点。我已经阅读了许多其他相关问题，但没有足够的知识来提取我需要的东西。

PS 我看到 DataTables 有一个编辑器功能，从长远来看，它几乎可以实现我想要实现的目标，但它还没有“准备好 Rails”。

谢谢！

**编辑：** 在准备这个问题时，我没有正确地将我的代码恢复到我想讨论的阶段。所以我更改了控制器代码和后续的开发日志。因此，问题不是模板错误，而是视图未呈现。

**编辑** 我已经解决了这个问题，现在有了结果。我在索引视图的顶部添加了一个新的 div（'result' 类）并更改了我的 js 代码，如下所示：

```
var n = '/highways/' + aData[0][4] + '/edit'
$.get(n, function(data) {
    $('.result').html(data); 
```

并且编辑视图呈现在该 div 中。结果很难看，因为它会将表格向下推，并使 DataTable 的页眉和页脚翻倍。但至少它呈现。我不明白为什么这两种方式都通过控制器中的 Edit 方法起作用。我现在可以处理化妆品，或者更好地让编辑视图显示为模态覆盖。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T21:45:23.230

我希望能够单击（或最好双击）一行并加载该行的编辑视图。我将继续寻求这样做。与此同时，我添加了一个指向视图的链接：

```
<div id="EditLink">
   <%= link_to "Edit Highway", :controller => :highways, :action => :edit, :id => 1 %>
</div> 
```

并在回调函数中有以下代码：

```
"oTableTools": {
                      "sRowSelect": "single",
                      "fnRowSelected": function(node) {
                        var oTT = TableTools.fnGetInstance('highways');
                        var aData = oTT.fnGetSelectedData();
                        $("div#EditLink a").attr('href','/highways/' + aData[0][4] +  '/edit')
                        }
                      }, 
```

它根据所选行的 id 修改链接。使用这种方法，用户必须知道首先选择一行，然后单击链接。如果他们不首先选择一行，他们将转到默认值 (id = 1)。您必须确保表中存在这样的 id。

# list - Prolog - 递归调用

> ID：12030515
> 
> 赞同：2
> 
> 时间：2012-08-19T22:33:37.527
> 
> 标签：list, recursion, prolog

我在递归搜索列表和从结果中创建列表列表时遇到问题..

知识库包含团队名称、获胜次数和他们所在的区域，所有这些都与他们的团队编号相关联。我正在传递团队编号列表，`Teams`并且正在寻找与`findMinMax/3`. 我需要的结果是...

配对团队列表列表（例如`X = [[gonzaga, washington], [iowa, oklahoma], …]`）和 1 个不匹配的团队（由奇数个团队产生）或 0（在偶数的情况下）

我想通了其他一切，可以完成部分`[gonzaga, washington]`，但在递归部分失败......

```
findPair(Teams,[HL|TL],Rest) :-
    findMinMax(Teams,Min,Max),
    delete(Teams,Min,TeamsNoMin),
    delete(TeamsNoMin,Max,Rest),
    createPair(Min,Max,Pair), %Pair = "["Min_team","Max_team"]"
    append(HL,[Pair],TL),
    findPair(Rest,TL,[]). 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T00:00:11.147

## 通用递归方案

在这里，我将尝试向您展示我们通常如何在 Prolog 中执行递归。对于初学者来说，这并不容易，因为列表是“向后”构建的：在我们到达列表末尾之前，什么都不会真正构建。

这种“向后构建”原则的原因是，一旦设置了变量，就不能将其设置为另一个值，因此很难说结果是`[1]`递归的第一步，然后变成`[1, 2]`. 相反，我们在 Prolog 中所说的是结果头是`1`，结果尾是递归调用的结果（是的，如果它变得混乱，请阅读两次：d）。因此，只要我们没有遇到基本情况（不执行递归的情况），我们就不会明确绑定变量（即我们总是让术语的一部分未绑定）。

`rec/2: rec(Input, Result)`对于通过将其元素与 链接来从输入列表生成结果列表的谓词`somepredicate/2`，我们将编写：

```
rec([InputHead|InputTail], [ResultHead|ResultTail]) :-
    somepredicate(InputHead, ResultHead),
    rec(InputTail, ResultTail). 
```

来代表。

在这里你可以看到我们声明结果的头部是`ResultHead`，并且它的尾部是通过调用计算出来的`rec(InputTail, ResultTail).`

现在这很好，但我们需要在某个时候停止，例如，当列表为空时。我们会这样写：

```
rec([], []). 
```

这意味着：当输入列表为空时，结果列表也为空。

## 对您的谓词的应用

现在，要解决您的问题，您首先必须修复递归子句：

```
findPair(Teams,[HL|TL],Rest) :-
    findMinMax(Teams,Min,Max),
    delete(Teams,Min,TeamsNoMin),
    delete(TeamsNoMin,Max,Rest),
    createPair(Min,Max,Pair), %Pair = "["Min_team","Max_team"]"
    append(HL,[Pair],TL),
    findPair(Rest,TL,[]). 
```

会成为

```
findPair(Teams, [Pair|Tail], LeftOver) :-
    findMinMax(Teams, Min, Max),
    delete(Teams, Min, TeamsNoMin),
    delete(TeamsNoMin, Max, Rest),
    createPair(Min, Max, Pair), %Pair = "["Min_team","Max_team"]"
    findPair(Rest, Tail, LeftOver). 
```

需要注意的重要一点：现在`Rest`已经成为两个独立的变量。的最后一个参数`findPair/3`不再改变，因为在递归调用中我们还不知道它，所以我们不能绑定它，`Rest`因此 in-predicate 现在是独立的，只代表没有尚未处理，因此对我们的结果列表的尾部（和`LeftOver`）感兴趣。

现在我们必须处理基本情况：

*   当没有队伍时

    ```
    findPair([], [], []). 
    ```

    这里我们说 when`Teams`是空的，`Result`and 也是`LeftOver`。

*   当只剩下一队时

    ```
    findPair([Last], [], [Last]). 
    ```

    这里我们说when`Teams`只有一个元素，`LeftOver`等于`Teams`且`Result`为空。

结果代码是：

```
findPair([], [], []).
findPair([Last], [], [Last]).
findPair(Teams, [Pair|Tail], LeftOver) :-
    findMinMax(Teams, Min, Max),
    delete(Teams, Min, TeamsNoMin),
    delete(TeamsNoMin, Max, Rest),
    createPair(Min, Max, Pair), %Pair = "["Min_team","Max_team"]"
    findPair(Rest, Tail, LeftOver). 
```

要使您的子句排他性，您可以替换`Teams`为`[Not, Empty|AtAll]`以确保最后一个子句仅用于长度为 2 或更长的列表，或者仅`Teams = [_, _|_],`在子句开头添加一个保护。

希望它有所帮助，并毫不犹豫地在评论中要求澄清:)

# html - 带有定位链接容器的 HTML5 响应式 Bg

> ID：12030520
> 
> 赞同：0
> 
> 时间：2012-08-19T22:34:19.907
> 
> 标签：html, responsive-design

经过非常谦卑的 15 个小时的尝试，我被难住了。:/ 我正在做一个免费赠品，因为它看起来像一个简单的 opp 来测试设备响应站点的理论。不是。我有一种感觉，也许我想多了。这是我正在努力学习的东西。任何反馈或推动正确方向将不胜感激。我对 HTML5 和设备编码都是新手。

使用：[http](http://byevan.com/web-template/BuzzApp/) ://byevan.com/web-template/BuzzApp/ 测试站点： http: [//justimaginewebdesigns.com/nathalie/mobile/](http://justimaginewebdesigns.com/nathalie/mobile/)附上它在所有设备上最终*应该* 是什么样子的图像。使用 javascript 将 div 锚定到底部的链接。

问题：链接的 Div 容器与 bg 图像的响应不一致。

*   对主背景图像使用 CSS3 可以使其具有响应性，并且 @media 条目可以完成他们的工作，尽管由于背景图像本身，它最好在横向模式下查看。
*   使用基于百分比的边距不一致
*   使用基于 % 的相对定位不一致
*   尝试放弃保留文本并仅使用带有热点翻转的图像在设备上惨遭失败。
*   向上面提到的 javascript 添加左位置属性在设备之间是不一致的。
*   更多的实验尝试......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T03:00:37.247

假设您将使用移动优先设计，这应该得到您所追求的。随着屏幕尺寸的增加，您可能需要再添加几个断点以使左边距正确。

您还应该从导航项中删除图像宽度和高度并使用

```
img {
width: 100%;
max-width: 100%;
} 
```

然后在容器 div 上设置图像的宽度。

```
.homelinks { 
             position:fixed;
             bottom:100px;
             left: 5%;
             -webkit-transition: all 0.3s ease-out; 
             -moz-transition: all 0.3s ease-out; 
             -o-transition: all 0.3s ease-out; 
             transition: all 0.3s ease-out; 
            }

 @media Screen and min-width(700px){
.homelinks { 
             position:fixed;
             bottom:100px;
             left: 26%;
            }} 
```

# node.js - 将变量传递给 expressjs 3 条路线

> ID：12030521
> 
> 赞同：1
> 
> 时间：2012-08-19T22:34:29.067
> 
> 标签：node.js, express

我有一个 ExpressJS 3 应用程序并将我的路线放在一个单独的文件中。我想在我的 app.js 中声明一些在路由文件中可用的配置 - 在路由定义本身之外。

在我的 app.js 中，我想做一些事情，例如：

```
app.set('path_to_models', '/path/models/'); 
```

然后在我的 routes/index.js 文件中，我希望能够做到这一点：

```
var Product = require(app.get('path_to_models') + 'product');

exports.list = function(req, res){
  return Product.find(function (err, products) {
    if (!err) {
       res.render('product/manage', { products: products });
    } else {
       res.render('5xx');
    }
  });
}; 
```

我看过一些与此相关的帖子，但没有一个真正解决我正在寻找的内容。我知道我可以将路由包装在一个函数中，但希望有一种替代方法可以让我的代码尽可能保持原样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:18:25.290

我只是制作了一个单独的`config`模块来保存我的配置，并且在任何需要来自配置的信息的模块中，我只是像往常一样需要它。当更松散耦合的方法可以正常工作时，为什么还要将 express 加入混合中。

配置.js

```
exports.pathToModels = "/path/to/models"; 
```

路由.js

```
var config = require("./config");
console.log(config.pathToModels); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T08:13:45.790

只需将`app`作为参数传递给 `routes/index.js'：

```
var routes = require('./routes/index.js')(app); 
```

更新：这应该是

```
var routes = require('./routes/index.js').init(app); 
```

并在`routes/index.js`：

```
var app;
exports=function(whichApp) { 
```

更新：这应该是

```
exports.init=function(whichApp) {

  app=whichApp;
  // do initialization stuff
  return exports;
}

exports.list=... 
```

# c# - 在 2 个 asp.net Web 应用程序之间发送消息？

> ID：12030525
> 
> 赞同：1
> 
> 时间：2012-08-19T22:35:09.283
> 
> 标签：c#, asp.net, xml, web-services

我有 2 个用 c#asp.net 编写的 Web 表单应用程序。这是我需要的东西：

1.  用户单击 Web 应用程序 1 中的按钮
2.  Web 应用 1 需要向 Web 应用 2 发送一些参数并获得响应
3.  Web 应用 1 使用来自 Web 应用 2 的响应来完成回发处理
4.  用户很高兴

所以我想我需要在我的网络应用程序中加入某种网络服务的东西？请指出我正确的方向。

**更新：**

我做了更多的研究，发现 WCF 似乎很受欢迎。我以前使用过一次 WCF（偶然发现），但是如何在 Web 应用程序中使用 WCF - 或者我是否需要为 WCF 创建另一个应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:51:13.890

进程间通信是一个相当大的话题，有很多方法可以做到这一点。

需要考虑的一些问题是

1.  同步与异步 - 如果用户快速连续单击按钮两次，应该是什么行为？
2.  如果用户单击按钮但 web app2 关闭了几分钟会发生什么？
3.  授权和安全
4.  拒绝服务式攻击

对于这种性质的东西，我倾向于使用消息队列之类的东西，可能由[nservicebus](http://nservicebus.com/)之类的东西管理，这将是一个非常简单但强大的解决方案。WCF 是另一种选择，MVC 4.0 Web 服务也是如此。

# r - 无法更改 googleVis 中 hAxis.showTextEvery 的值

> ID：12030526
> 
> 赞同：1
> 
> 时间：2012-08-19T22:35:21.410
> 
> 标签：r, charts

我正在尝试使用 googleVis 包在 R 中生成一个“柱形”图表。我在水平轴（X 轴）上有太多的值，所以我想“隐藏”文本（我的意思是全部！）

我现在能看到的唯一解决方案是将**hAxis.showTextEvery**设置为一个非常高的数字。但是，这似乎不起作用......

```
library(googleVis)
    my.data.frame <- data.frame( SampleName = c(seq(1:2500)), Value = c(seq(1:2500)) ) 
    my.data.frame$Value <- my.data.frame$Value / 100
    g3 <- gvisColumnChart(my.data.frame, xvar = "SampleName", yvar = "Value" , options=list(hAxis.showTextEvery = 77777 ))
plot(g3) # something is broken here!! 
```

见：http: [//i46.tinypic.com/2wnwwo2.png](http://i46.tinypic.com/2wnwwo2.png)

总而言之，我希望删除 X 轴上的所有文本。我看到的第二个问题是我只能得到 1 到 ~177 之间的值……这是为什么呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:22:19.333

你尝试使用

```
options = list(hAxis.showTextEvery = 77777) 
```

但正确的语法是

```
options = list(hAxis = "{showTextEvery: 77777}") 
```

即便如此，您将获得第一个点的一个文本值 ( `1`)。完全没有文本的更好方法是使用

```
options = list(hAxis = "{textPosition: 'none'}") 
```

# linux - 如何在linux中从一个文件中的另一个文件中搜索行

> ID：12030527
> 
> 赞同：-1
> 
> 时间：2012-08-19T22:35:52.087
> 
> 标签：linux

我有file1和file2。如果file1中的任何行存在于file2中，我需要搜索并打印出来。如果不存在，我需要知道不存在任何条目。如何在 linux 命令中实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T22:45:08.460

只需要grep：

```
grep -f file1 file2 
```

如果您希望将 file1 处理为固定字符串，而不是正则表达式模式，则需要添加参数 -F。

```
grep -F -f file1 file2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T22:46:43.180

grep 可以完成这项任务。

`grep -f File1 File2`

但是，也可以使用其他命令，例如`diff`和。`cmp`

# tcl - TCL/TK - 获取桌面路径

> ID：12030528
> 
> 赞同：1
> 
> 时间：2012-08-19T22:36:24.390
> 
> 标签：tcl, expect, tk

我的 TCL/TK 应用程序提示用户选择保存文件的位置。

-initialdir 选项的值应该是多少才能使桌面成为默认位置？

我尝试了 %userprofile%\desktop，但它不起作用。

```
set dir [tk_chooseDirectory -title "Where do you want to save the config file?" -initialdir %userprofile%\desktop] 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T03:05:49.553

最安全的方法是使用带有参数“ [csidl_common_desktopdirectory](http://twapi.magicsplat.com/) ”的 twapi 的[get_shell_folder](http://twapi.magicsplat.com/shell.html#get_shell_folder)命令来获取“所有用户”桌面目录的路径，或者使用“csidl_desktopdirectory”来获取当前用户的桌面。

如果你不想依赖twapi，路径可以在注册表中找到，但我不知道它有多可靠。例如：

```
package require registry

puts [registry get "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders" "Desktop"] 
```

这将在我的系统上返回“%USERPROFILE%\Skrivbord”。您仍然需要扩展 USERPROFILE 变量（和任何其他变量）。最好使用 twapi::expand_environment_strings 来完成，但由于您没有使用 twapi，请尝试使用 $env(HOME) 代替 regsub:ing %USERPROFILE%。

或者，如果您不关心使用非英语 Windows 的人，只需使用“~/Desktop”。

# c# - 使用 SelectMany() 展平字典

> ID：12030529
> 
> 赞同：-4
> 
> 时间：2012-08-19T22:36:46.047
> 
> 标签：c#, linq, dictionary

我有这些字典：

```
public class CiscoVSAN
{
    private string _VSANName;
    private string _VSANNum;
    public string VSANName{ get{return _VSANName;} set{_VSANName=value;} }
    public string VSANNum{ get{return _VSANNum;} set{_VSANNum=value;} }

    public Dictionary<int, CiscoSwitch> MemberSwitches = new Dictionary<int, CiscoSwitch>();
}

public Dictionary<int, CiscoVSAN> VSANList = new Dictionary<int, CiscoVSAN>(); 
```

我正在尝试替换这个 foreach

```
foreach (KeyValuePair<int, CiscoVSAN> vsanpair in this.VSANList)
{
    var currSwitchAsEnumerable  = vsanpair.Value.MemberSwitches.Where(cs => cs.Value.switchName == RemoteSwitchName);
    if (currSwitchAsEnumerable != null)
    {
        //currVSAN.MemberSwitches.Add(DomainID, currSwitchAsEnumerable.FirstOrDefault().Value);
        currSwitch = currSwitchAsEnumerable.FirstOrDefault().Value;
        break;
    }
} 
```

在外部字典上有一个 SelectMany。我想要 MemberSwitches 中与条件匹配的第一个匹配项。并非所有 VSAN 在其各自的字典中都有相同的成员交换机。我试过这个：

```
var selectmany = this.VSANList.SelectMany(cs => cs.Value).Where( => cs).Where(cs.Value.SwitchName == RemoteSwitchName).First(); 
```

和这个：

```
var selectmany = this.VSANList.Values.SelectMany(cs => cs.Value).Where( => cs).Where(cs.Value.SwitchName == RemoteSwitchName).First(); 
```

但是每次编译器告诉我它不能从使用中推断出类型参数。我还尝试在 SelectMany 语句之后为其提供类型参数，但这也不起作用。我查看的大多数示例要么是扁平化的列表列表，要么是简单的字典。他们也没有在 SelectMany 上指定任何类型。

编辑添加我试过这个：

```
Dictionary<int, List<string>> mydict = new Dictionary<int, List<string>>();
var selectlist = mydict.Values.SelectMany(n => n).ToList(); 
```

并且没有得到关于推断类型的编译器错误。所以然后我尝试了这个，只是为了展平字典并将其变成一个列表：

```
var selectmany = this.VSANList.Values.SelectMany(vs => vs).ToList(); 
```

我再次收到编译器警告。我不确定要指定什么类型或如何指定它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:50:28.797

假设没有拼写错误，您有一个语法错误：该部分`.Where ( => cs )`是非法的。你想在这里表达什么？

编辑：

实际上，仔细想想，你的整个表达都是非法的或输入错误的。

您传递给 SelectMany 的委托应该返回`IEnumerable<T>`，但您的表达式返回`CiscoVSAN`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T00:51:07.643

我想到了：

```
var selectmany = this.VSANList.Values.SelectMany(vs => vs.MemberSwitches).Where(cs => cs.Value.switchName == RemoteSwitchName).First(); 
```

# linq - EF Code First 和 linq 扩展方法 - 外键，我做错了吗？

> ID：12030531
> 
> 赞同：0
> 
> 时间：2012-08-19T22:37:05.943
> 
> 标签：linq, entity-framework, key

我有这样的东西：（伪代码）

```
public class Author
{
   int id;
   public List<Thread> Threads;
   public List<ThreadPoints> ThreadPointses;
}

public class Thread
{
   int id;
   public List<ThreadPoints> ThreadPointses;
}

public class ThreadPoints
{
   int id;
   int Points;
} 
```

而且我不确定上面是否正确，但现在我想获得指定作者在指定线程中的点数。我不能直接调用`ThreadPoints.Thread_id`，因为它不可访问，即使它物理上在数据库中。那么我需要改变我的模型，还是我不知道一些有用的方法？

* * *

所以基本上，我的模型看起来像这样：

```
 public class Account
    {
        [Key]
        public Guid AccountId { get; set; }
        public string UserName { get; set; }
        public List<Post> Posts { get; set; }
        public List<Post> ModifiedPosts { get; set; }
        public List<Thread> Threads { get; set; }
        public List<ThreadPoints> ThreadPointses { get; set; }
        public List<Thread> LastReplied { get; set; }
        public int Points { get; set; }
    }

    public class Thread
    {
        [Key]
        public int Id { get; set; }
        public List<ThreadPoints> ThreadPointses { get; set; } 
        public List<Post> Posts { get; set; }
        public int CurrentValue { get; set; }
        public int NumberOfPosts { get; set; }
        public int TotalValue { get; set; }
        public int Views { get; set; }
        public string Title { get; set; }
        public DateTime DateCreated { get; set; }
    }

    public class ThreadPoints
    {
        [Key]
        public int Id { get; set; }
        public int Points { get; set; }
    } 
```

我需要的是，当用户创建一个线程时，他会给它一些分数。在下一个动作中，我想（从数据库中）获取那么多点，并增加它。但我只有线程 ID 作为输入信息。

您的答案可能很好，（就我正在尝试实现它而言），但无论如何，我不确定这个模型。也许我应该手动将外键添加到我的模型中？它肯定会更简单，但是我的数据库中有两个外键......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T22:49:33.350

由于您没有显式映射 FK，实体框架正在生成它们并将它们隐藏起来，因此要获取属性的 Id，您需要遵循导航集合。

我不确定您的问题，但是您是否想要给定作者`Points`的特定内容中的 ,数量？`Threadpoint`你的模型似乎不能很好地支持这一点，但你可以做这样的事情-

```
public int GetPoints(Author author, Thread thread)

    {
      int points = author.Threads.FirstOrDefault(t => t.id == thread.id).ThreadPointses.Sum(tp => tp.Points);
    } 
```

这将返回指定作者的线程点列表中包含的所有点的总和，这些点包含在与您传入的线程具有相同 id 的线程列表中。

如果这对您不起作用 - 您可以发布您的实际模型吗？

# c++ - 使用 QTestLib 编写单元测试

> ID：12030534
> 
> 赞同：1
> 
> 时间：2012-08-19T22:37:23.637
> 
> 标签：c++, unit-testing, qt4, qtestlib

这是我进入单元测试世界的第一步，所以请耐心等待。我正在编写一个 Qt 4.8.1 C++ 程序，作为测试框架，我正在使用集成的 QTestLib。我应该测试一个从基类继承的类，并加载某个 XML 文件以稍后使用一个函数读取和解析它，该函数将返回一个 C++ 类对象，该对象具有我可以通过 set/get 函数检索和设置的 xml 值。构造函数中的类实例化了一个 QFile 对象，在 readXml 函数中我使用它与 QXmlStreamReader 一起解析文件。使用单元测试测试所有此类的最佳方法是什么？我看不到如何绕过文件读取操作来注入自己的代表文件内容的字符串。或者我应该使用不同的临时 XML 文件作为测试内容吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T19:45:27.507

注入一个字符串来表示文件内容似乎是测试诸如此类的最直接的方法。但是，直接`QFile`在您的类构造函数中实例化一个实例使得这不可能（换句话说，不可能[注入您的依赖](http://en.wikipedia.org/wiki/Dependency_injection)项）。此外，创建 a 的“假”或“模拟”版本`QFile`（又名 a 的[测试替身](http://xunitpatterns.com/Test%20Double.html)）是一项相当多的工作`QFile`。

解决此问题的最简单方法是将 a 传递给`QIODevice`您的类构造函数（`QFile`继承自`QIODevice`）。`QIODevice`在你的单元测试中，你可以通过传入你想要测试的内容来伪造文件的内容。在这种情况下，您可以使用[QBuffer](http://qt-project.org/doc/qt-4.8/qbuffer.html)来完成此操作，它允许您任意设置其内容。因此，您的班级会喜欢以下内容：

```
class MyXmlParser
{
   MyXmlParser(QIODevice* device);

   ...
}; 
```

`QBuffer`您的单元测试使用;构造类 您的生产代码使用`QFile`.

**我应该在测试中使用真正的 XML 文件吗？**

一般来说，您的单元测试具有的外部依赖项越多，确保它在未来不会中断的成本就越高（它可能使您的单元测试[对其上下文敏感](http://xunitpatterns.com/Fragile%20Test.html#Context%20Sensitivity)）。因此，建议避免使用真正的 XML 文件，以确保您的测试是独立的。此外，传入真正的 XML 意味着您现在正在隐式测试 QFile 以及您的 XML 解析器（换句话说，它不再是单元测试，而是集成测试）。您通常可以假设您传递给解析器的 IO 设备可以正常工作；您只需要验证您的解析器是否正确使用了 IO 设备并且它可以正确解析 XML。

考虑通读 xunitpatterns.com 上的材料，尤其是关于[测试气味](http://xunitpatterns.com/TestSmells.html)的部分。

# c++ - 为每个可变参数模板参数和一个数组调用一个函数

> ID：12030538
> 
> 赞同：28
> 
> 时间：2012-08-19T22:37:48.143
> 
> 标签：c++, templates, c++11, variadic-templates

所以我有一些类型`X`：

```
typedef ... X; 
```

和一个模板函数`f`：

```
class <typename T>
void f(X& x_out, const T& arg_in); 
```

然后是一个函数`g`：

```
void g(const X* x_array, size_t x_array_size); 
```

我需要编写一个可变参数模板函数`h`来执行此操作：

```
template<typename... Args>
void h(Args... args)
{
    constexpr size_t nargs = sizeof...(args); // get number of args
    X x_array[nargs]; // create X array of that size

    for (int i = 0; i < nargs; i++) // foreach arg
        f(x_array[i], args[i]); // call f (doesn't work)

    g(x_array, nargs); // call g with x_array
} 
```

它不起作用的原因是因为您不能在运行时像这样下标 args。

更换中间部分的最佳技术是`h`什么？

**获胜者是 Xeo：**

```
template<class T> X fv(const T& t) { X x; f(x,t); return x; }

template<class... Args>
void h(Args... args)
{
  X x_array[] = { fv(args)... };

  g(x_array, sizeof...(Args));
} 
```

（实际上在我的具体情况下，我可以重写 f 以按值返回 x 而不是作为输出参数，所以我什至不需要上面的 fv ）

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-19T23:03:46.590

您可以重构或包装`f`以返回一个新`X`的而不是让它通过，因为这会在手中发挥包扩展并使函数真正简洁：

```
template<class T>
X fw(T const& t){ X x; f(x, t); return x; }

template<class... Args>
void h(Args... args){
  X xs[] = { fw(args)... };
  g(xs, sizeof...(Args));
} 
```

[活生生的例子。](http://liveworkspace.org/code/2667351a3a6fd53c54c1ba1abf6d8466)

如果您可以更改`g`为只接受一个`std::initializer_list`，它会变得更加简洁：

```
template<class... Args>
void h(Args... args){
  g({f(args)...});
} 
```

[活生生的例子。](http://liveworkspace.org/code/363aeabcede4f39ac3bf9c14c71cc46a)或者（也许更好），您也可以只提供一个`g`转发到真实的包装器`g`：

```
void g(X const*, unsigned){}

void g(std::initializer_list<X> const& xs){ g(xs.begin(), xs.size()); }

template<class... Args>
void h(Args... args){
  g({f(args)...});
} 
```

[活生生的例子。](http://liveworkspace.org/code/43b68fff53eac856768e60e855f05465)
**编辑：**另一个选择是使用临时数组：

```
template<class T>
using Alias = T;

template<class T>
T& as_lvalue(T&& v){ return v; }

template<class... Args>
void h(Args... args){
  g(as_lvalue(Alias<X[]>{f(args)...}), sizeof...(Args));
} 
```

[活生生的例子。](http://liveworkspace.org/code/6667474973ad0dba0fa8c0124f86d83c)请注意，该`as_lvalue`函数是危险的，数组仍然只存在到完整表达式的末尾（在这种情况下`g`），所以使用它时要小心。`Alias`是必需的，因为`X[]{ ... }`由于语言语法，just 是不允许的。

如果所有这些都不可能，您将需要递归来访问`args`包的所有元素。

```
#include <tuple>

template<unsigned> struct uint_{}; // compile-time integer for "iteration"

template<unsigned N, class Tuple>
void h_helper(X (&)[N], Tuple const&, uint_<N>){}

template<unsigned N, class Tuple, unsigned I = 0>
void h_helper(X (&xs)[N], Tuple const& args, uint_<I> = {}){
  f(xs[I], std::get<I>(args));
  h_helper(xs, args, uint_<I+1>());
}

template<typename... Args>
void h(Args... args)
{
    static constexpr unsigned nargs = sizeof...(Args);
    X xs[nargs];

    h_helper(xs, std::tie(args...));

    g(xs, nargs);
} 
```

[活生生的例子。](http://liveworkspace.org/code/97da6870842756030cb7815367297e33)

**编辑：**受 ecatmur 评论的启发，我使用了[索引技巧](http://loungecpp.wikidot.com/tips-and-tricks%3aindices)使其仅与包扩展和原样工作`f`，`g`而不改变它们。

```
template<unsigned... Indices>
struct indices{
  using next = indices<Indices..., sizeof...(Indices)>;
};
template<unsigned N>
struct build_indices{
  using type = typename build_indices<N-1>::type::next;
};
template <>
struct build_indices<0>{
  using type = indices<>;
};
template<unsigned N>
using IndicesFor = typename build_indices<N>::type;

template<unsigned N, unsigned... Is, class... Args>
void f_them_all(X (&xs)[N], indices<Is...>, Args... args){
  int unused[] = {(f(xs[Is], args), 1)...};
  (void)unused;
}

template<class... Args>
void h(Args... args){
  static constexpr unsigned nargs = sizeof...(Args);
  X xs[nargs];
  f_them_all(xs, IndicesFor<nargs>(), args...);
  g(xs, nargs);
} 
```

[活生生的例子。](http://liveworkspace.org/code/cbeb0698d38787368557e7b60e283220)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-02-02T14:04:06.447

很好的模板作为问题第一部分的答案：

```
template <class F, class... Args> 
void for_each_argument(F f, Args&&... args) {
    [](...){}((f(std::forward<Args>(args)), 0)...);
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-19T22:49:50.060

很明显：您不使用迭代，而是使用递归。在处理可变参数模板时，总是会出现递归。即使将元素绑定到`std::tuple<...>`使用`tie()`它也是递归的：恰好递归业务是由元组完成的。在您的情况下，您似乎想要这样的东西（可能有一些拼写错误，但总的来说应该可以）：

```
template <int Index, int Size>
void h_aux(X (&)[Size]) {
}

template <int Index, int Size, typename Arg, typename... Args>
void h_aux(X (&xs)[Size], Arg arg, Args... args) {
    f(xs[Index], arg);
    h_aux<Index + 1, Size>(xs, args...);
}

template <typename... Args>
void h(Args... args)
{
    X xs[sizeof...(args)];
    h_aux<0, sizeof...(args)>(xs, args...);
    g(xs, sizeof...(args));
} 
```

我认为您也无法使用它`nargs`来定义数组的大小：没有任何东西向编译器表明它应该是一个常量表达式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-19T23:46:09.873

使用参数包扩展非常简单，即使您无法重写`f`以按值返回输出参数：

```
struct pass { template<typename ...T> pass(T...) {} };

template<typename... Args>
void h(Args... args)
{
    const size_t nargs = sizeof...(args); // get number of args
    X x_array[nargs]; // create X array of that size

    X *x = x_array;
    int unused[]{(f(*x++, args), 1)...}; // call f
    pass{unused};

    g(x_array, nargs); // call g with x_array
} 
```

应该可以写

```
 pass{(f(*x++, args), 1)...}; // call f 
```

但似乎 g++（至少 4.7.1）有一个错误，它无法将大括号初始化器列表参数的评估排序为类初始化器。数组初始化器虽然没问题；有关更多信息和示例，请参阅[可变参数扩展中的排序。](https://stackoverflow.com/questions/10764867/sequencing-among-a-variadic-expansion)

[活生生的例子](http://liveworkspace.org/code/f88c255cbfd03830476f31768eca8183)。

* * *

作为替代方案，这是 Xeo 提到的使用生成的索引包的技术；不幸的是，它确实需要一个额外的函数调用和参数，但它相当优雅（特别是如果你碰巧有一个索引包生成器）：

```
template<int... I> struct index {
    template<int n> using append = index<I..., n>; };
template<int N> struct make_index { typedef typename
    make_index<N - 1>::type::template append<N - 1> type; };
template<> struct make_index<0> { typedef index<> type; };
template<int N> using indexer = typename make_index<N>::type;

template<typename... Args, int... i>
void h2(index<i...>, Args... args)
{
    const size_t nargs = sizeof...(args); // get number of args
    X x_array[nargs]; // create X array of that size

    pass{(f(x_array[i], args), 1)...}; // call f

    g(x_array, nargs); // call g with x_array
}

template<typename... Args>
void h(Args... args)
{
  h2(indexer<sizeof...(args)>(), std::forward<Args>(args)...);
} 
```

请参阅[C++11：我可以从多个 args 转到 tuple，但我可以从 tuple 转到多个 args 吗？](https://stackoverflow.com/questions/10766112/c11-i-can-go-from-multiple-args-to-tuple-but-can-i-go-from-tuple-to-multiple)了解更多信息。 [活生生的例子](http://liveworkspace.org/code/44e8ec1545dcbdad55d448c603195c3d)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-01T15:58:47.067

Xeo 的想法是正确的——你想要构建某种“可变参数迭代器”，它可以从其余代码中隐藏很多这种讨厌的东西。

我会获取索引内容并将其隐藏在以 std::vector 为模型的迭代器接口后面，因为 std::tuple 也是数据的线性容器。然后，您可以重用所有可变参数函数和类，而无需在其他任何地方使用显式递归代码。

# c# - 字符串参数占位符

> ID：12030540
> 
> 赞同：3
> 
> 时间：2012-08-19T22:38:39.517
> 
> 标签：c#, string, parameters

```
 string str = "({{0}})";
        int i = 0;
        string str2 = string.Format(str, i++);
        string str3 = string.Format(str, i++); 
```

为什么是 str3 ({0}) 而不是 ({1})？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-19T22:40:09.343

您逃脱了花括号，因此它们没有特殊含义。从[文档](http://msdn.microsoft.com/en-us/library/b1csw23d.aspx)中：

> 要在格式中指定单个文字大括号字符，请指定两个前导或尾随大括号字符；即，`"{{"`或`"}}"`。

您可以简化程序并仍然演示问题：

```
Console.WriteLine("{{0}}", 1); 
```

输出：

```
{0} 
```

在线查看它：[ideone](http://ideone.com/WUQOp)

* * *

要获得所需的输出，您需要使用，`{{`然后是`{0}`finally `}}`：

```
string str = "({{{0}}})"; 
```

# jquery - Google Charts - 是否可以在图表中向下钻取内容？

> ID：12030541
> 
> 赞同：4
> 
> 时间：2012-08-19T22:39:11.170
> 
> 标签：jquery, google-visualization

HighCharts 有一个非常好的向下钻取功能：[http](http://www.highcharts.com/demo/column-drilldown) ://www.highcharts.com/demo/column-drilldown - 但我想知道它是否在谷歌图表可视化 API 中可用？据我所知，这是不可能的——但让我描述一下我的想法：

鼠标悬停时，会出现一个小弹出窗口，其中包含有关数据的其他信息。是否可以在其中放置链接？

因为我们在图表上有这些鼠标悬停事件，也许可以添加一个“单击”事件，我们可以用它做任何我们想做的事情？在这种情况下，我要么只是单击将用户发送到另一个 URL，要么可能强制图表进入新的图表动画（基本上是在这个庄园中创建向下钻取）。

我对 jQuery 不太熟悉，所以在这里我会很感激一些专业知识。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-11-18T08:26:51.713

对的，这是可能的。尽管没有直接的方法可以做到这一点。

我也在寻找这个，我想出了一个方法。

您必须使用 PHP（或任何其他后端语言）准备 JSON 字符串。PHP 应该递归地与数据库对话，并为每个向下钻取图表生成所需的 Javascript 文字语法，并将其嵌入 JSON 格式。JSON 字符串准备好后，将 JSON 字符串复制粘贴到您的 HTML 脚本标记中。添加单击事件处理程序以切换到适当的 Javascript 文字。一旦数据表准备好调用chart.draw()。

你可以看看[这个](https://rawgit.com/shaw92g/GoogleChartsDrillDown/master/chart.html "谷歌图表向下钻取")。链接到[存储库](https://github.com/shaw92g/GoogleChartsDrillDown)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T10:33:08.440

我也一直在研究这个问题，根据我的发现，我认为你不能从他们的“仪表板”中做到这一点，但我认为你可以通过图表上的控件或事件来做到这一点。

以下是在数据视图上使用“组”功能的示例，因此您可以在图表上的单击事件或控件的单击事件上使用它，然后重绘图表。 [http://code.google.com/apis/ajax/playground/?type=visualization#group](http://code.google.com/apis/ajax/playground/?type=visualization#group)

然后，诀窍将是跟踪哪些过滤器当前处于活动状态以及诸如此类的事情。如果这很容易集成，甚至能够查询数据集/视图（如[http://code.google.com/apis/ajax/playground/?type=visualization#using_the_query_language](http://code.google.com/apis/ajax/playground/?type=visualization#using_the_query_language)中） ，那就太好了

如果您/其他人知道另一种方法，我很想听听。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-12T14:29:48.470

您可以在此处解释的 Google 图表中使用事件处理： [https ://developers.google.com/chart/interactive/docs/dev/events](https://developers.google.com/chart/interactive/docs/dev/events)

诀窍是使用图表的“选择”事件并在处理程序中编写代码。

```
var chart = new google.visualization.ComboChart(document.getElementById('chart_div'));

chart.draw(data, options);

google.visualization.events.addListener(chart,'select',selectHandler);

function selectHandler()
{
  //your code here

} 
```

您可以在这里查看示例实现：[https ://jsfiddle.net/Abhishek1191/zggv80jo/](https://jsfiddle.net/Abhishek1191/zggv80jo/)

在这里，我创建了一个组合图表，单击在线上的任何数据点，您将看到在原始图表下方添加了一个饼图

# c++ - gcc 4.7.1 构建以未定义的引用结束

> ID：12030543
> 
> 赞同：0
> 
> 时间：2012-08-19T22:40:06.167
> 
> 标签：c++, c, gcc, mpfr

我得到一个

> fortran/arith.o：在函数`gfc_mpfr_to_mpz(__mpz_struct*, __mpfr_struct*, locus*)': arith.c:(.text+0x1169): undefined reference to`mpfr_get_z_2exp'

来自 gcc 4.7.1 构建过程。我正在关注

[gcc-wiki](http://gcc.gnu.org/wiki/InstallingGCC)

但是，我对

下载_先决条件

脚本。那就是我正在下载 gcc 的所有先决条件的最新版本，因为上面的链接是为 gcc 4.6 提供的，所以原始版本正在下载一些较旧的先决条件。但是，它找不到一些与 mpfr 库相关的符号。

一个相关的谷歌搜索给了我这个线程，但它也没有帮助我，也许其他人的理解与我不同：

[类似的线程](http://www.spinics.net/lists/gcchelp/msg37496.html)

有关如何解决此问题的任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:07:29.270

我最近为 Mountain Lion 构建了 gcc 4.7.1，并遵循了一个非常好的教程，介绍了如何进行 gcc 构建。在其中，它描述了所有必要的 lib 编译，包括 mpfr、gmp 和其他。如果您正在运行 linux，我认为它也适用于您，试一试：

[http://solarianprogrammer.com/2012/07/21/compiling-gcc-4-7-1-mac-osx-lion/](http://solarianprogrammer.com/2012/07/21/compiling-gcc-4-7-1-mac-osx-lion/)

让我知道这是否有帮助。

# cordova - Phonegap iOS 命令行工具 ./create

> ID：12030546
> 
> 赞同：0
> 
> 时间：2012-08-19T22:40:25.120
> 
> 标签：cordova, command-line-tool, cordova-2.0.0

我想使用 phonegap 创建一个 iOS 应用程序。我的问题是这`./create <project_folder_path> <bundle_id> <project_name>`根本不起作用。`./create ~/Desktop/projects/mbs/mastercard-iphone do.com.mbs.mastercard-iphone Mastercard` 由于目录不存在，正在返回无法复制所需文件的信息。实际错误的要点。[https://gist.github.com/3398261](https://gist.github.com/3398261)听起来像是用户权限问题？我应该将该命令作为 sudo 运行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T22:48:32.050

好吧，我不确定问题是什么，但我手动创建了目录，然后运行 ​​./create 并且一切正常。

# mysql - 如何在 MySql 和 Entity Framework 4.2 Code First 中使用全文搜索？

> ID：12030555
> 
> 赞同：2
> 
> 时间：2012-08-19T22:41:18.033
> 
> 标签：mysql, entity-framework-4, full-text-search

我正在使用 Entity Framework 4.2 Code First 和 MySQL。我需要能够对表格的多个字段进行全文搜索。但是，我对此有很多问题：

1）MySQL下全文搜索需要MyISAM表类型。但是，当我运行 DropCreateDatabaseAlways 初始化程序时，我得到的表类型是 InnoDB。这是我的表定义的示例：

```
[Table("Patient")]
[Serializable]
public class Patient
{
    public Patient()
    {
    }

    [Key]
    public int PatientID { get; set; }

    [MaxLength(50)]
    public string FirstName { get; set; }
    [MaxLength(50)]
    public string LastName { get; set; }
} 
```

是否可以指定 MyISAM 表类型？如果是这样，怎么做？

2）我需要指定全文索引：

```
ALTER TABLE `patient` ADD FULLTEXT INDEX `Name`(`FirstName`, `LastName`); 
```

我能想到的一种可能性是：

```
public class MyDbInitializer : DropCreateDatabaseAlways<MyDbContext>
{
    protected override void Seed(MyDbContext context)
    {
        context.Database.ExecuteSqlCommand(
            "ALTER TABLE `patient` ADD FULLTEXT INDEX `Name`(`FirstName`, `LastName`)");
    }
} 
```

有没有更好的办法？

3) 我需要能够使用全文索引进行搜索。理想情况下，它可以与我现有的 linq to SQL 一起使用。

我能想到的一种不太理想的可能性是创建一个存储过程（同样，使用 ExecuteSqlCommand），它接受一个字符串并返回匹配的 PatientID 列表或 Patient 行列表。例如：

```
IEnumerable<int> patientIDs = [...call stored proc to get matching ids...]
var patients = from p in patients 
               where patientIDs.Any(pid => pid == p.PatientID) 
               select new {...} 
```

或者：

```
var patients = from p in [...call stored proc to get matching patient records...]
               select new {...} 
```

我该怎么做？有没有更好的办法？

4) 额外问题：即使我指定了 [MaxLength(50)] 属性，我的字符串也被存储为 MEDIUMTEXT 而不是 VARCHAR(50) 正如我所期望的那样。如果没有 [MaxLength] 属性，我会得到 LONGTEXT。如何为字符串类型指定 VARCHAR(n)？

有任何想法吗？

提前致谢，

担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T08:50:45.880

1.  它是特定于提供者的，因此除非您的 MySQL 提供者提供某种更改它的方法，否则您将无法首先从代码中做到这一点。我认为您应该能够`ALTER TABLE`在自定义数据库初始化程序中运行以更改引擎。
2.  如果您使用迁移功能（EF 4.3 和更新版本），您可以在迁移中编写索引脚本，否则您需要使用初始化程序。
3.  您需要使用 SQL 查询数据库。EF 不支持全文搜索查询。要调用存储过程，您必须使用`SqlQuery`并填充具有与结果集相同属性的类型。
4.  尝试使用`[Column(TypeName="VARCHAR(50)]`注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T06:48:59.147

如果您是 dotConnect for MySQL 用户，我们建议您看看[这篇文章](http://blogs.devart.com/dotconnect/using-mysql-full-text-search-in-entity-framework.html)。如果您使用其他提供商，我们建议您联系其供应商。

# ios - 使用 Core Data 为 UITableViewController 添加动画行

> ID：12030558
> 
> 赞同：0
> 
> 时间：2012-08-19T22:41:36.540
> 
> 标签：ios, cocoa-touch, ipad, core-data, uitableview

我正在开发一个使用 Master Detail 设计模式的 Core Data iPad 应用程序。我正在尝试在更新`managedObjectContext`. 目前，当我添加一个对象时，它只会出现在表格视图中。我正在使用斯坦福核心数据表视图类。

这是我添加对象委托的保存方法：

```
 - (void)addObjectSaveButtonTapped:(iPadAddObjectViewController *)controller {

    [self dismissModalViewControllerAnimated:YES];
    [self setupFetchedResultsController];
} 
```

这是我的`setupFetchedResultsController`方法：

```
 - (void)setupFetchedResultsController {

        NSString *entityName = @"Object";

        NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:entityName];

        request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"objectName" ascending:YES selector:@selector(localizedCaseInsensitiveCompare:)]];

        self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:nil];

        [self performFetch];

    } 
```

这是`performFetch`方法。

```
- (void)performFetch
{
    _debug = YES;

    if (self.fetchedResultsController) {
        if (self.fetchedResultsController.fetchRequest.predicate) {
            if (self.debug) NSLog(@"[%@ %@] fetching %@ with predicate: %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd), self.fetchedResultsController.fetchRequest.entityName, self.fetchedResultsController.fetchRequest.predicate);
        } else {
            if (self.debug) NSLog(@"[%@ %@] fetching all %@ (i.e., no predicate)", NSStringFromClass([self class]), NSStringFromSelector(_cmd), self.fetchedResultsController.fetchRequest.entityName);
        }
        NSError *error;
        [self.fetchedResultsController performFetch:&error];
        if (error) NSLog(@"[%@ %@] %@ (%@)", NSStringFromClass([self class]), NSStringFromSelector(_cmd), [error localizedDescription], [error localizedFailureReason]);
    } else {
        if (self.debug) NSLog(@"[%@ %@] no NSFetchedResultsController (yet?)", NSStringFromClass([self class]), NSStringFromSelector(_cmd));
    }
    [self.tableView reloadData];
} 
```

有没有办法将动画添加到对象添加中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:46:20.340

```
[self.tableView beginUpdates];
[self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:yourIndexPath] withRowAnimation:UITableViewRowAnimationFade];
[self.tableView endUpdates]; 
```

`UITableView`也有类似的方法，`insertSections:withRowAnimation:`

# php - 奇怪的 elseif 行为

> ID：12030563
> 
> 赞同：0
> 
> 时间：2012-08-19T22:42:29.643
> 
> 标签：php, if-statement

我想根据用户所处的阶段设置等待时间。我只是想快速测试一下并把这个：

```
function towait(){
    if ($query = mysql_query('select fase, lastone from users where id = "'.$_SESSION['id'].'"')){
        while($r[]=mysql_fetch_array($query));

        if ($r[0]['fase'] == 0) {
            $wait = 0;
        } elseif ($r[0]['fase'] == 1) {
            $wait = 300;
        } elseif ($r[0]['fase'] == 2) {
            $wait = 600;
        } elseif ($r[0]['fase'] == 3) {
            $wait = 900;
        } elseif ($r[0]['fase'] == 4) {
            $wait = 1500;
        } elseif ($r[0]['fase'] == 5) {
            $wait = 2100;
        } elseif ($r[0]['fase'] == 6) {
            $wait = 2700;
        } elseif ($r[0]['fase'] == 7) {
            $wait = 3600;
        } elseif ($r[0]['fase'] == 8) {
            $wait = 5400;
        } elseif ($r[0]['fase'] > 8) {
            $wait = 7200;
        } else {
            $wait = 0;
        }

        if((time() - $r[0]['lastone']) > $wait) {
            //go ahead
            $go = 1;
        } else {
            //you have to wait
            //I know this looks weird, but I just save the hour when OK to go as a string in the format "HHuMM"
            $go = date("H", ($r[0]['lastone'] + $wachten + 60)) . "u" . date("i", ($r[0]['lastone'] + $wachten + 60));
        }

        return $go;
    } else {
        $go = -1;

        return $go;
    }
} 
```

奇怪的是，在第 7 阶段之前一切正常，但只要用户处于第 7 阶段，它就会停止工作（脚本不会让用户等待）。第 8 阶段也是如此。在第 9 阶段和 9+ 阶段，一切都恢复正常。

我知道这听起来很疯狂（而且代码写得不好），但我想知道是什么导致了这件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T03:22:33.547

最可能的解释是您的会话超时。这意味着，当您返回 $_SESSION['id'] 时，它将为空并且它将不起作用。

您可以在 php.ini 中增加会话时间：最容易阅读解释这一切的博客：http: [//prajapatinilesh.wordpress.com/2009/01/14/manually-set-php-session-timeout-php-session /](http://prajapatinilesh.wordpress.com/2009/01/14/manually-set-php-session-timeout-php-session/)

# c++ - 两个相同的程序使用 Boost::tokenizer，但有两个不同的输出

> ID：12030568
> 
> 赞同：2
> 
> 时间：2012-08-19T22:43:36.143
> 
> 标签：c++, boost

以下 C++ 程序

```
#include <iostream>
#include <boost/tokenizer.hpp>
using namespace std;
int main()
{
    typedef boost::tokenizer<boost::char_separator<char> > tokenizer;

    string s ("(0,30,0)");

    tokenizer tokens(s.substr(1,s.size()-2), boost::char_separator<char>(","));
    for (tokenizer::iterator tok_iter = tokens.begin(); tok_iter != tokens.end(); ++tok_iter)
        cout<<*tok_iter<<endl;

    return 0;
} 
```

有问题，因为它输出`0 0 0`而不是`0 30 0`...

但是，如果我像这样稍微改变它：

```
#include <iostream>
#include <boost/tokenizer.hpp>
using namespace std;
int main()
{
    typedef boost::tokenizer<boost::char_separator<char> > tokenizer;

    string s ("(0,30,0)");

    //Modified lines:
    string t (s.substr(1,s.size()-2));
    tokenizer tokens(t, boost::char_separator<char>(","));

    for (tokenizer::iterator tok_iter = tokens.begin(); tok_iter != tokens.end(); ++tok_iter)
        cout<<*tok_iter<<endl;

    return 0;
} 
```

它工作正常！这怎么可能 ？乍一看，我会认为这两个版本是一样的......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-19T23:30:24.517

在您的第一个示例中，`s.substr(1,s.size()-2)`返回一个**临时对象**，其生命周期在表达式末尾到期。但是，`boost::tokenizer`有一个接受 const 引用的构造函数，这意味着只要该引用存在，对象的生命周期就会延长。问题是`boost::tokenizer`只将迭代器存储到传入的引用，所以对对象的引用过期并且迭代器现在无效。

# mysql - 缩短 SQL COUNT 语句

> ID：12030570
> 
> 赞同：0
> 
> 时间：2012-08-19T22:44:11.590
> 
> 标签：mysql, sql, join, count

所以这是我很长的 SQL 查询。

基本上，我有 2 个学校级别，JC1 和 JC2，我正在计算当前日期和前一个日期的每个级别的字段，如下所示。

这是我今天的原始子查询，我使用另一个日期不同的子查询。

```
SELECT
level,
COUNT(studentid) AS total,
SUM(leader1 <> '' OR leader2 <> '') AS leaders,
SUM(scholarship <> '') AS scholarship,
SUM(pegasus <> '') as pegasus
FROM `laterec-students` 
WHERE latetime > '2012-05-25 00:00:00' 
GROUP BY level; 
```

它会回来

```
level | total | leaders | scholarship |pegasus
  JC1 |  28   |    7    |      0      |   2
  JC2 |  14   |    6    |      0      |   3 
```

现在对于某些日期，我可能不会同时返回 JC1 和 JC2。（如2012-05-25上面我得到了JC1和JC2，前一天我只得到了JC2，因为没有JC1数据）

所以这就是为什么我没有使用 JOIN 来帮助我，或者可能是因为我真的不知道如何正确使用 JOIN。

对于下面我的 SQL 查询，

子查询返回这个（子查询 tjc1 的示例）

```
total | leaders | scholarship |pegasus
 28   |    7    |      0      |   2

SELECT

SUM(tjc1.total) AS JC1total,
SUM(yjc1.ytotal) AS JC1ytotal,
SUM(tjc1.leaders) AS JC1leaders,
SUM(yjc1.yleaders) AS JC1yleaders,
SUM(tjc1.scholarship) AS JC1scholarship,
SUM(yjc1.yscholarship) AS JC1yscholarship,
SUM(tjc1.pegasus) AS JC1pegasus,
SUM(yjc1.ypegasus) AS JC1ypegasus,

SUM(tjc2.total) AS JC2total,
SUM(yjc2.ytotal) AS JC2ytotal,
SUM(tjc2.leaders) AS JC2leaders,
SUM(yjc2.yleaders) AS JC2yleaders,
SUM(tjc2.scholarship) AS JC2scholarship,
SUM(yjc2.yscholarship) AS JC2yscholarship,
SUM(tjc2.pegasus) AS JC2pegasus,
SUM(yjc2.ypegasus) AS JC2ypegasus

FROM

(
SELECT
COUNT(studentid) AS total,
SUM(leader1 <> '' OR leader2 <> '') AS leaders,
SUM(scholarship <> '') AS scholarship,
SUM(pegasus <> '') as pegasus
FROM `laterec-students` 
WHERE latetime > '2012-05-25 00:00:00' 
AND level = 'JC1'
) tjc1,
(
SELECT
COUNT(studentid) AS ytotal,
SUM(leader1<>'' or leader2<>'') AS yleaders,
SUM(scholarship<>'') AS yscholarship,
SUM(pegasus<>'') as ypegasus
FROM `laterec-students` 
WHERE latetime BETWEEN '2012-05-24 00:00:00' AND '2012-05-24 23:59:59'
AND level = 'JC1'
) yjc1,
(
SELECT
COUNT(studentid) AS total,
SUM(leader1 <> '' OR leader2 <> '') AS leaders,
SUM(scholarship <> '') AS scholarship,
SUM(pegasus <> '') as pegasus
FROM `laterec-students` 
WHERE latetime > '2012-05-25 00:00:00' 
AND level = 'JC2'
) tjc2,
(
SELECT
COUNT(studentid) AS ytotal,
SUM(leader1<>'' or leader2<>'') AS yleaders,
SUM(scholarship<>'') AS yscholarship,
SUM(pegasus<>'') as ypegasus
FROM `laterec-students` 
WHERE latetime BETWEEN '2012-05-24 00:00:00' AND '2012-05-24 23:59:59'
AND level = 'JC2'
) yjc2 
```

因此，如果您认为您可以找到一种方法来帮助我缩短查询、提高查询效率等。我将永远感激不尽，并且能够在此过程中学到一些东西。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:54:37.987

试试这个：

```
select the_type, 
       level, 
       sum(total), 
       sum(leaders), 
       sum(scholarship), 
       sum(pegasus)

FROM
(
  (
  SELECT 
  't' the_type, 
  level,
  COUNT(studentid) AS total,
    SUM(leader1 <> '' OR leader2 <> '') AS leaders,
    SUM(scholarship <> '') AS scholarship,
    SUM(pegasus <> '') as pegasus
   FROM `laterec-students` 
  WHERE latetime > '2012-05-25 00:00:00' 
  AND level in('JC1', 'JC2')
  GROUP BY the_type, level
  ) 
UNION ALL
  (
  SELECT
   'y' the_type,
    level,
    COUNT(studentid) AS ytotal,
    SUM(leader1<>'' or leader2<>'') AS yleaders,
    SUM(scholarship<>'') AS yscholarship,
    SUM(pegasus<>'') as ypegasus
   FROM `laterec-students` 
  WHERE latetime BETWEEN '2012-05-24 00:00:00' AND '2012-05-24 23:59:59'
  AND level in('JC1', 'JC2')
  GROUP BY the_type, level
  )
) AS the_union
GROUP BY the_type, level; 
```

另一种方法可能是这样的：

```
SELECT
date(latetime) the_date,
level,
COUNT(studentid) AS total,
SUM(leader1<>'' or leader2<>'') AS leaders,
SUM(scholarship<>'') AS scholarship,
SUM(pegasus<>'') as pegasus
FROM `laterec-students` 
WHERE latetime between '2012-05-24 00:00:00' AND '2012-05-25 23:59:59'
AND level in('JC1', 'JC2')
group by the_date, level; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T03:19:06.003

也许您可以尝试使用与仅对 leader1<>'' 或 leader2<>'' （例如）所在的行求和的相同技巧，并添加您的级别和日期条件以执行此类操作

```
SELECT
SUM(level = 'JC1' AND latetime > '2012-05-25 00:00:00' ) AS total_TJC1,
SUM(leader1 <> '' OR leader2 <> '' AND level = 'JC1' AND latetime > '2012-05-25 00:00:00') AS leaders_TJC1,
SUM(scholarship <> '' AND level = 'JC1' AND latetime > '2012-05-25 00:00:00' ) AS scholarship_TJC1,
SUM(pegasus <> '' AND level = 'JC1' AND latetime > '2012-05-25 00:00:00' ) as pegasus_TJC1
FROM `laterec-students` 
```

# php - 在条件中使用变量名作为函数名是不好的做法吗？

> ID：12030571
> 
> 赞同：0
> 
> 时间：2012-08-19T22:44:23.717
> 
> 标签：php

**例子：**

```
$var = 'post_type_archive';
$name = 'some-archive';
$condition = 'is_'.$var;
if($condition($name)) 
```

这被认为是一个很大的禁忌吗？如果是这样，还有什么办法可以完成类似的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:47:59.550

有时您需要这样做。只需确保仅在实际需要时才这样做，因为正如评论者所说，这很容易成为可读性问题。如果要调用的可能函数列表很短，请考虑改用 switch 语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T22:58:30.833

如果您要这样做，您需要确保动态创建的函数名称始终有效，否则您将在运行时遇到致命错误。至少，您应该使用`is_callable()`来检查该函数是否存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T22:58:37.820

当您将使用限制在某些情况下时，这不是一个坏习惯。其中一种情况可能是基于给定的 GET 参数动态调用函数。

但我建议[`call_user_func()`](http://php.net/call-user-func)改用。它清楚地表明了您将要做什么，并且代码更具可读性。请记住始终使用 来检查函数是否存在[`is_callable()`](http://php.net/is-callable)。

`call_user_func()`但不适用于内置函数。

# iphone - NSURLConnection didFailWithError “不支持的 URL” 用于字母数字链接

> ID：12030576
> 
> 赞同：0
> 
> 时间：2012-08-19T22:45:23.990
> 
> 标签：iphone, ios, web, nsurlconnection

我正在尝试使用`NSURLConnection`. 文件加载失败，并且委托`didFailWithError`在`error`对象中声明：**不支持的 URL**

我的 URL 是字母数字的，如下例所示：

```
http://www.mySite.com/myFolder/123456789_123456789_12-34-56_1234_abcd.jpg 
```

我还尝试使用`CFURLCreateStringByAddingPercentEscapes`对下划线和减号进行编码，但这没有帮助。如果我将代码中的链接复制/粘贴到我的网络浏览器，它会正常打开。

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-19T22:56:41.960

你为什么不使用 NSURL？这将返回一个完全有效的 URL，可以将其传递给 NSURLConnection：

```
[NSURL URLWithString:@"http://www.mySite.com/myFolder/123456789_123456789_12-34-56_1234_abcd.jpg"]; 
```

或者，如果您想转义：

```
[NSURL URLWithString:[@"http://www.mySite.com/myFolder/123456789_123456789_12-34-56_1234_abcd.jpg" stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T20:29:06.600

我解决了这个问题，链接或文件名没有问题，它是字母数字。问题在于`NSURL`我错误地将**文件**名而不是完整的链接名称。这是显示错误的代码：

```
NSURLRequest *downloadRequest = [NSURLRequest requestWithURL:[NSURL URLWithString:fileName] cachePolicy:NSURLRequestReloadIgnoringLocalCacheData timeoutInterval:60.0]; 
```

解决方案是简单地将完整的 URL 字符串与文件名一起放置，而不是**fileName 。**

# recursion - 什么会影响递归中的堆栈大小？

> ID：12030577
> 
> 赞同：0
> 
> 时间：2012-08-19T22:45:30.213
> 
> 标签：recursion, stack-overflow

递归方法调用的具体哪些部分对堆栈有贡献——比如返回的对象、参数、局部变量等？

我正在尝试优化 Android 应用程序在遇到 StackOverflowException 之前可以在有限内存上执行的递归级别。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T22:56:19.273

如果堆栈空间不足，请不要优化堆栈使用。这样做只是意味着同样的问题稍后会再次出现，输入集稍大或从其他地方调用。在某些时候，您已经达到了可以用于解决问题的理论或实际最小空间。相反，将有问题的代码转换为使用机器堆栈以外的集合（例如，堆分配的堆栈或队列）。这样做有时会导致代码非常难看，但至少不会崩溃。

但是要回答这个问题：通常，您命名的所有内容都可以占用堆栈空间，而临时值也占用空间（因此疯狂地嵌套表达式只是为了保存局部变量将无济于事）。其中一些将存储在寄存器中，具体取决于调用约定，但无论如何可能都必须被溢出（*）。但是不管调用约定如何，这只会为您节省几个字节，并且由于被调用者通常在调用期间可以自由支配寄存器，因此调用时必须溢出所有内容。因此，当您的堆栈溢出时，堆栈确实挤满了参数、局部变量和早期调用的临时变量。如果同时不需要它们，一些可能会被完全优化掉或共享一个堆栈槽。最终这取决于 JIT 编译器。

(*) 溢出：将值从寄存器移动到内存（即堆栈），因为其他东西需要寄存器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:00:14.733

每个方法都有两个与之关联的堆栈帧大小，参数和局部变量所需的堆栈，以及表达式求值所需的堆栈。返回值仅计为表达式评估所需的堆栈的一部分。JVM 能够验证方法在执行时不超过这些大小。

变量和表达式评估究竟需要多少堆栈取决于字节码编译器。例如，它通常能够在具有非重叠生命周期的变量之间共享局部变量槽。

# ruby-on-rails - Rails嵌套表单，属性未通过

> ID：12030578
> 
> 赞同：0
> 
> 时间：2012-08-19T22:45:51.383
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, nested-forms, nested-attributes

所以我有一个`Conversation`模型，它`has_many` `messages`。创建对话时，我正在尝试创建新消息。这是我的`ConversationsController`：

```
class ConversationsController < ApplicationController
  before_filter :authenticate_user!
  def new
    recipient = User.find(params[:user])
    @conversation = Conversation.new(from: current_user, to: recipient)
    @conversation.messages.build(from: current_user, to: recipient)
  end

  def create
    @conversation = Conversation.create(params[:conversation])
    redirect_to @conversation
  end
end 
```

这是我的表格（`conversations/new.html.erb`）：

```
<%= form_for @conversation do |f| %>
  <%= f.fields_for :messages do |g| %>
    <%= g.label :subject %>
    <%= g.text_field :subject %>
    <%= g.label :content %>
    <%= g.text_field :content %>
  <% end %>
  <%= f.submit "Send" %>
<% end %> 
```

问题：当我提交表单时，对话的消息被保存，但我指定为参数的`to`和字段没有保存（它们为零）。但是，在此表单中填写的和字段保存得很好。`from``build``subject``content`

我已经进行了一些挖掘......如果我在动作中或在 中执行`puts`on ，则消息似乎具有and 。只有当消息到达操作时，这些字段才会消失。`@conversation.messages``new``new.html.erb``to``from``create`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:15:12.190

更新：

```
class ConversationsController < ApplicationController
  before_filter :authenticate_user!
  def new
    recipient = User.find(params[:user])
    @conversation = Conversation.new(to: recipient)
    @conversation.messages.build
  end

  def create
    @conversation = current_user.conversations.build(params[:conversation])

    # Set all the attributes for conversation and messages which
    # should not be left up to the user.
    @conversation.to = current_user
    @conversation.messages.each do |message|
      message.to = @conversation.to
      message.from = @conversation.from
    end

    redirect_to @conversation
  end
end

<%= form_for @conversation do |f| %>
  <%= f.hidden_field :recipient %>
  <%= f.fields_for :messages do |g| %>
    <%= g.label :subject %>
    <%= g.text_field :subject %>
    <%= g.label :content %>
    <%= g.text_field :content %>
  <% end %>
  <%= f.submit "Send" %>
<% end %> 
```

您可能仍想在对话模型中验证收件人。

# facebook - facebook 分享链接不会显示来自我服务器的图像

> ID：12030582
> 
> 赞同：0
> 
> 时间：2012-08-19T22:46:15.163
> 
> 标签：facebook, image, share

我正在尝试在 facebook 上分享我的网站上的内容，但它不会显示图像。我尝试了调试工具，它说一切都很好......

最连线的事情是，当我将相同的页面放在不同的服务器上时，它工作正常！！！

以及如何清除 facebook 缓存？

多谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T08:12:08.230

检查以确保您的服务器上没有设置阻止 Facebook 以编程方式抓取图像数据。我最近遇到了这个问题，服务器上的设置受到限制，以至于 Facebook 无法获取图像数据以用于共享目的并将图像副本复制到其 CDN 中。

# javascript - Javascript“结束”函数工作不正常

> ID：12030585
> 
> 赞同：0
> 
> 时间：2012-08-19T22:46:43.743
> 
> 标签：javascript, audio, multiple-browsers

为两个 mp3 的音频播放列表设置简单的代码，并在 JSFiddle 中进行了测试……似乎可以正常工作，但在上传时，只在 Chrome 和 Safari 中播放第一个剪辑，在 Opera 和 Firefox 中根本不播放。我正在使用 mp3 和 ogg，所以也许这与我的“结束”功能有关......？“结束”不一定意味着“加载”对吗？救命！，有人...？

JS：

```
var chant = document.getElementById("music");
chant.addEventListener("ended", function() {
chant2 = document.getElementById("music2");
chant2.play();
}); 
```

HTML：

```
<audio id="music" autoplay="autoplay"><br>
<source src="http://www.siddhicenter.org/media/GANAPATIVEDCSTUTI.ogg" type="audio/ogg" /><br>
<source src="http://www.siddhicenter.org/media/GANAPATIVEDCSTUTI.mp3" type="audio/mpeg" /><br>
Your browser does not support the audio element.<br>
</audio>
<audio id="music2" loop="loop" ><br>
<source src="http://www.siddhicenter.org/media/OmNamahShivaya.ogg" type="audio/ogg" /><br>
<source src="http://www.siddhicenter.org/media/OmNamahShivaya.mp3" type="audio/mpeg" /><br>
Your browser does not support the audio element.<br>
</audio> 
```

提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T11:36:33.420

我猜你在windows主机中。

在根目录中添加 web.config。添加添加ff代码：

```
<configuration>
 <system.webServer>
   <staticContent>
   <remove fileExtension=".ogg" />
     <mimeMap fileExtension=".ogg" mimeType="audio/ogg" />
   </staticContent>
 </system.webServer>
</configuration> 
```

如果您已经有配置标签

插入ff：

```
<staticContent>
   <remove fileExtension=".ogg" />
 <mimeMap fileExtension=".ogg" mimeType="audio/ogg" />
</staticContent> 
```

在您的 system.webServer 标签下。

前任：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <rewrite>
      <rules>
        <rule name="wordpress" patternSyntax="Wildcard">
            <match url="*"/>
                <conditions>
                    <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true"/>
                    <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true"/>
                </conditions>
            <action type="Rewrite" url="index.php"/>
        </rule></rules>
    </rewrite>
<staticContent>
   <remove fileExtension=".ogg" />
 <mimeMap fileExtension=".ogg" mimeType="audio/ogg" />
   </staticContent>
  </system.webServer>  
</configuration> 
```

# php - 点击链接时设置cookie

> ID：12030589
> 
> 赞同：2
> 
> 时间：2012-08-19T22:47:42.310
> 
> 标签：php, javascript, ajax, wordpress, translation

所以有这个 wordpress 插件，Transposh：[http](http://transposh.org/) ://transposh.org/它基本上是一个翻译引擎。我有这个网站，当用户访问该网站时，该网站会检查 Transposh 的语言首选项 cookie，如下所示：

```
<?php if( isset( $_COOKIE['TR_LNG'] ) ) {} else { ?> 
```

如果没有找到 cookie（称为 TR_LNG），它会继续显示语言选择对话，其中包含指向该网站的英语和法语版本的链接。问题是 transposh 自己的小部件设置默认语言是这样的：用户在小部件上选择语言。小部件加载所需的语言页面并在小部件下方显示一个链接，该链接显示将此语言设置为默认值。链接如下所示：

```
<a id="tr_setdeflang" class="tr_setdeflang" onclick="return false;" href="http://sarvatma.org/wp-admin/admin-ajax.php?action=tp_cookie_bck">Set this lang....</a> 
```

我需要发生的是，当用户在语言首选项对话框中单击一种语言时，如下所示：

```
<a href="http://www.sarvatma.org/en/">In English</a> 
```

我还需要它来设置语言，上面例子中的英语作为默认值。这是我能解释的最好的情况，如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:23:02.143

如果我理解，您只需要将cookie的设置绑定到点击链接？

如果是这样，您需要将 ID 添加到您的`<a>`:

```
<a href="http://www.sarvatma.org/en/" id="mylink">In English</a> 
```

然后将一些 cookie 设置代码绑定到 click 事件：

（使用 jQuery）

```
$("a#mylink").bind("click", function() {
    $.cookie("TR_LNG", "English");
}); 
```

# c++ - DirectShow BindToObject 返回无效句柄

> ID：12030590
> 
> 赞同：0
> 
> 时间：2012-08-19T22:47:48.670
> 
> 标签：c++, directshow

**编辑**

刚刚测试了 playcap.cpp，我也遇到了同样的错误，所以我知道这不是我的代码的错误。

--

**编辑 2**

编辑我的代码以保留 goodMoniker 指针。然而，同样的错误。

```
+if(pMoniker != goodMoniker)
+{
    pMoniker->Release();
+} 
```

--

让我的网络摄像头与 DirectShow 一起工作时遇到问题。这一行：

```
hr = goodMoniker->BindToObject(0, 0, IID_IBaseFilter, (void**)(&pCap)); 
```

从 MSVC++ 2010 EE 返回以下错误：

> WebcamControlTest.exe 中 0x777ff9d2 处的第一次机会异常：0xC0000008：指定了无效句柄。

此处的完整代码（几乎完全来自[MSDN](http://msdn.microsoft.com/en-us/library/ms787514%28v=vs.85%29.aspx)）：

```
#include <DShow.h>
#include <iostream>

int main(void)
{
    IGraphBuilder* pGraph = NULL;
    ICaptureGraphBuilder2* pBuild = NULL;

    HRESULT hr;

    //Initialize pGraph
    hr = CoInitialize(NULL);
    hr = CoCreateInstance(CLSID_CaptureGraphBuilder2, NULL, CLSCTX_INPROC_SERVER, IID_ICaptureGraphBuilder2, (void**) &pBuild);
    if(FAILED(hr))
    {
        printf("ERROR - Could not initialize COM library");
        return 1;
    }

    //Initialize pBuild
    hr = CoCreateInstance(CLSID_FilterGraph, NULL, CLSCTX_INPROC_SERVER, IID_IGraphBuilder, (void **) &pGraph);
    if(FAILED(hr))
    {
        printf("ERROR - Could not create the Filter Graph Manager.");
        return 2;
    }
    pBuild->SetFiltergraph(pGraph);

    //Initialize pCap
    ICreateDevEnum* pDevEnum = NULL;
    IEnumMoniker* pEnum = NULL;

    hr = CoCreateInstance(CLSID_SystemDeviceEnum, NULL, CLSCTX_INPROC_SERVER, IID_ICreateDevEnum, reinterpret_cast<void**>(&pDevEnum));
    if(SUCCEEDED(hr))
    {
        hr = pDevEnum->CreateClassEnumerator(CLSID_VideoInputDeviceCategory, &pEnum, 0);
    }

    IMoniker* goodMoniker = NULL; 

    HWND hList;
    IMoniker *pMoniker = NULL;
    while(pEnum->Next(1, &pMoniker, NULL) == S_OK)
    {
        IPropertyBag* pPropBag;
        hr = pMoniker->BindToStorage(0, 0, IID_IPropertyBag, (void**)(&pPropBag));
        if(FAILED(hr))
        {
            pMoniker->Release();
            continue;
        }

        VARIANT varName;
        VariantInit(&varName);
        hr = pPropBag->Read(L"Description", &varName, 0);
        if(FAILED(hr))
        {
            hr = pPropBag->Read(L"FriendlyName", &varName, 0);
        }
        if(SUCCEEDED(hr))
        {
            for(int i=0;i<8;i++)
            {
                std::cout<<(char)*(varName.bstrVal + i);
            }

            char yn;
            std::cin>>yn;

            if(yn=='Y')
            {
                std::cout<<"SUCCESSFUL"<<std::endl;
                goodMoniker = pMoniker;
                VariantClear(&varName);
            }
        }
        pPropBag->Release();
        if(pMoniker != goodMoniker)
        {
            pMoniker->Release();
        }
    }

    IBaseFilter* pCap;
    hr = goodMoniker->BindToObject(0, 0, IID_IBaseFilter, (void**)(&pCap));
    if(SUCCEEDED(hr))
    {
        hr = pGraph->AddFilter(pCap, L"Capture Filter");
    }

    hr = pBuild->RenderStream(&PIN_CATEGORY_PREVIEW, &MEDIATYPE_Video, pCap, NULL, NULL);
    while(SUCCEEDED(hr));

    pGraph->Release();
    pBuild->Release();
    pCap->Release();
} 
```

这可能是一个驱动程序问题，因为有一个设备可以工作（一个用于屏幕截图的虚拟驱动程序，而不是实际的网络摄像头输入），但我已经更新、卸载和重新安装，但没有成功。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T10:20:47.937

在 goodMoniker 中保存指针后，在下面几行（pMoniker->Release()）释放对象。现在 goodMoniker 指向一个释放的对象。你应该增加它的引用计数。

# mysql - 在 MySQL 中更改表之间的关系类型

> ID：12030595
> 
> 赞同：0
> 
> 时间：2012-08-19T22:48:40.777
> 
> 标签：mysql, database

我有两个具有一对多关系的表。表 1 的主键是表 2 中的外键，但不是主键。主键是自动生成的。关系应该是一对一的关系，而不是一对多的关系。

这是我想要改变的，但我相信它已经自动默认为一对多关系，因为外键不是这个表的主键

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:17:59.313

如果两个表之间是一对一的关系，则意味着对于T1中的一条记录，T2中最多有一条对应的记录，反之亦然。

在您的情况下，如果您想确保 t2 中的一条记录（语义记录，即忽略 t2 的主键）在 t1 中最多有一个对应记录，您应该在 t2 中的所有语义列上添加一个 UNIQUE 约束（即语义上描述 t2 记录的列，不包括主键和外键）。这样，您将确保 t2 中的一条记录不会指向 t1 中的两条或更多条记录。

如果您想确保一对一关系的另一个方向（即 t1 中的记录最多被 t2 中的一条记录引用），您应该使 t2 中的外键唯一。

# javascript - 用于 chrome ext 的简单流行的 javascript 框架。发展

> ID：12030596
> 
> 赞同：1
> 
> 时间：2012-08-19T22:48:54.970
> 
> 标签：javascript, frameworks, backbone.js, google-chrome-extension, knockout.js

我正在为我的 Chrome 扩展开发寻找一个简单的 Javascript 框架。我正在使用 jQuery 和 jQuery UI，但是随着我的项目的增长，我在代码中的方向变得更糟。所以我需要某种一致的 MV* 框架，它非常简单、轻量、流行（因为有帮助和教程），并且可以与 jQuery 和 jQuery UI 一起使用（或者该框架可以包含任何类似的东西）。有任何想法吗？不要建议我 TodoMVC - 我试过了，除了 jQuery 之外的每个实现都不必要地复杂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T23:03:22.203

您已经使用 Knockout.js 标记了您的问题 - 您是否找到任何令人信服的理由不使用它？我一直在将它与 jQuery 和 jQuery UI 一起广泛使用，它运行良好并且有很多干净的扩展点。在这里和其他地方都有一个很大的支持社区，文档非常好。我强烈推荐它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:37:37.303

对于构建您的 javascript 应用程序，我建议使用 Backbonejs。它是轻量级的，它甚至使用 jQuery，所以你应该有宾至如归的感觉。假设您需要比浏览器内置的更丰富的小部件，而不是使用 jQueryUI，您可能想要查看“Twitter Bootstrap”，它使用起来非常愉快，看起来很棒并且已经支持响应式应用程序（可能会也可能不会Chrome 扩展程序所必需的）。我也相信它比 jQueryUI 更轻量级，但我真的没有自己详细研究过。同样的组合也适用于传统网页、Web 应用程序、单页应用程序，甚至在移动设备上也能很好地工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:32:54.250

骨干是赢家。我找到了最好的资源。

# android - 将我的 JSON 对象从列表视图上的选定索引发送到我的下一个活动 (android)

> ID：12030598
> 
> 赞同：-1
> 
> 时间：2012-08-19T22:49:08.287
> 
> 标签：android, json, android-intent

嘿大家提前对不起我一直在疯狂地寻找这个问题的答案。我知道理论上我应该使用

```
i.putExtra("jsonArray", jArray.toString()); 
```

在我的意图中，但它要么无法解决，要么给我错误。

我正在尝试从数组中传递此人的姓名和 ID（我的查询中的 ID 和姓名）。并传递它，以便我可以在下一个活动的下一个查询中使用该 ID。

```
 Person resultRow = new Person();
                //set that person's attributes

                resultRow.id = json_data.getString("id");
                resultRow.icon = json_data.getString("birthday");
                resultRow.name = json_data.getString("name");
                resultRow.address = json_data.getString("address");
                resultRow.city = json_data.getString("city");

                //this is our arrayList object, we add our Person object to it
                arrayOfWebData.add(resultRow);
            }
        }
        catch(JSONException e){
            Log.e("log_tag", "Error parsing data "+e.toString());
        }

        //get our listview
        ListView myListView = (ListView)findViewById(R.id.myListView);

        //we initialize our fancy adapter object, we already declared it above
        //in the class definition
        aa=new FancyAdapter();

        // here we set the adapter, this turns it on
        myListView.setAdapter(aa);
        myListView.setOnItemClickListener(onListClick);
        }
        catch (Exception e)
        {
            // this is the line of code that sends a real error message to the log
            Log.e("ERROR", "ERROR IN CODE: " + e.toString());

            // this is the line that prints out the location in
            // the code where the error occurred.
            e.printStackTrace();
        } 
    }

    // here is where the magic begins
    //we extend our ArrayAdapter, and use it to create custom views 
    //as well as execute other more complicated functions
    //this time, our ArrayAdapter is an array of Persons, instead of strings like in other tutorials
    class FancyAdapter extends ArrayAdapter<Person> {
        FancyAdapter() {
            super(ListActivity.this, android.R.layout.simple_list_item_1, arrayOfWebData);
        }

        public View getView(int position, View convertView,
                ViewGroup parent) {
            ViewHolder holder;

            //we call an if statement on our view that is passed in,
            //to see if it has been recycled or not.  if it has been recycled,
            //then it already exists and we do not need to call the inflater function
            //this saves us A HUGE AMOUNT OF RESOURCES AND PROCESSING
            //this is the proper way to do it
            if (convertView==null) {                         
                LayoutInflater inflater=getLayoutInflater();
                convertView=inflater.inflate(R.layout.row, null);

                //here is something new.  we are using a class called a view holder
                holder=new ViewHolder(convertView);
                //we are using that class to cache the result of the findViewById function
                //which we then store in a tag on the view 
                convertView.setTag(holder);
            }
            else {
                holder=(ViewHolder)convertView.getTag();
            }
            holder.populateFrom(arrayOfWebData.get(position));

            return(convertView);
        }           
    }

    class ViewHolder {
        public TextView name=null;
        public TextView address=null;
        public TextView icon=null;

        ViewHolder(View row) {
            name=(TextView)row.findViewById(R.id.name);
            address=(TextView)row.findViewById(R.id.birthday);
            birthday=(TextView)row.findViewById(R.id.favorite_color);
        }
        //notice we had to change our populate from to take an arguement of type person
        void populateFrom(Person r) {
            name.setText(r.name);
            address.setText(r.address);
            icon.setText(r.birthday);
        }
    }

    private AdapterView.OnItemClickListener onListClick=new android.widget.AdapterView.OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            Intent i= new Intent(ListActivity.this, bar.class);
            i.putExtra("jsonArray", Person(name).toString());
            startActivity(i);
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:19:50.393

您还可以在您的 Person 类中实现[Parcelable](http://developer.android.com/reference/android/os/Parcelable.html)以发送 Person 类的当前实例

或者只是将人的 id 发送到下一个具有额外意图的活动，然后获取 Json 来比较 id：

```
intent.putExtra("PERSON_ID", current_person.id); 
```

# html - HTML标题的正则表达式？

> ID：12030599
> 
> 赞同：-1
> 
> 时间：2012-08-19T22:49:15.517
> 
> 标签：html, regex

我正在尝试使用正则表达式抓取 HTML 页面的标题。这是我正在尝试的：

```
\<title\>\A\Z\</title\> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-19T22:52:17.767

```
<title>(.*?)</title> 
```

周围的括号`.*?`让您可以引用捕获组。您的正则表达式库可能会返回捕获组中匹配的内容。索引为 0 的组是整个匹配项。因此，您可能应该选择组索引 1，这是它遇到的第一个起始括号（这里只有一组括号）。

在某些库中，您需要：

```
.*?<title>(.*?)</title>.* 
```

因为有些需要字符串的完全匹配。

*   \A 用于匹配字符串容器的开头
*   \< 用于匹配空格和字符之间的边界
*   \> 匹配字符和空格之间的边界

请注意，这并非万无一失。网页可以使用以下页面破坏您的正则表达式：

```
<html>
    <script>
      // <title>HAHA YOU GOT THE WRONG TITLE</title>
    </script>
    <title>The Actual title</title>
  </head><body></body>
</html> 
```

您可以通过在匹配标题之前使您的正则表达式更加复杂来避免这种可能性。然而，这并不真正奏效。因为假标题可能在 HTML 评论`<!-- <title></title> -->`或`/* javascript */`评论中。

因此，最好使用实际的 HTML 解析器。你可以搜索谷歌找到其中的许多。

*   如果您使用的是 Ruby，则可以使用 nokogiri gem - [http://nokogiri.org/](http://nokogiri.org/)。

*   对于 Java - [http://htmlparser.sourceforge.net/](http://htmlparser.sourceforge.net/)。

*   对于 python - [http://docs.python.org/library/htmlparser.html](http://docs.python.org/library/htmlparser.html)。

# java - 使用 maven 启动两个 activeMQ 代理

> ID：12030601
> 
> 赞同：0
> 
> 时间：2012-08-19T22:49:38.433
> 
> 标签：java, maven, activemq

我有带有activeMQ config xml的maven项目，仅用于启动代理：mvn activemq：run。问题是，我需要启动 2 个实例（在代理网络中连接 2 个主控），有没有办法做到这一点。Ofcouse，我可以在 java 代码中公开它，例如： Broker b1 = ... Broker b2 = .... 配置并启动它们。（但我不会有 maven）我需要它来进行集成测试，它们不是自动化的，手动启动 2 个代理，运行测试非常困难，如果出现错误消息并出现故障，很难理解是测试失败还是只是环境问题。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:42:32.537

我不明白你到底想做什么，但如果启动和拆除你的经纪人可以使用你已经知道的 Java 代码的自定义插件来完成， [http ://maven.apache.org/plugins/maven- invoker-plugin/](http://maven.apache.org/plugins/maven-invoker-plugin/)可以帮助您在代理的启动和拆卸之间运行测试。

如果没有，那么该插件的源代码中可能有一些很好的线索来说明它是如何完成的。

# ember.js - emberjs 1.0pre 示例

> ID：12030605
> 
> 赞同：2
> 
> 时间：2012-08-19T22:50:35.933
> 
> 标签：ember.js, handlebars.js

并提前感谢您。我最近将我的应用程序中的 emberjs 依赖项更改为 1.0.0pre，并且在视图渲染方面遇到了问题。我尝试从github 上的[emberjs/examples](https://github.com/emberjs/examples)下载，看看最新提交是如何切换到 1.0.0pre 的。

当我尝试打开应用程序时，我注意到把手没有被引用，但是在修复了所有应用程序后，我遇到了同样的问题：渲染视图产生空容器并且控制台是静默的（在我的应用程序上，甚至是 console.trace()在控制台的其余部分保持沉默时，ember 的开发版本没有帮助）。

我想知道是否有人知道我可以在 ember 1.0 pre 上查看 ArrayControllers 和/或 CollectionViews 的任何工作示例，以便我可以将其用作参考。

> 我没有足够的声誉对答案进行投票，但感谢您抽出时间提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T02:27:57.193

请参阅[在 EmberJS 0.9.8.1 中工作的 Handlebars 操作助手，但在 Ember 1.0 Pre 中不工作确保您拥有来自](https://stackoverflow.com/questions/12492003/handlebars-action-helper-works-in-emberjs-0-9-8-1-but-not-ember-1-0-pre)[https://github.com/wycats/handlebars.js/downloads](https://github.com/wycats/handlebars.js/downloads) 的绝对最新的车把

# backbone.js - Qunit + Sinon 测试 Backbone 的模型事件

> ID：12030606
> 
> 赞同：1
> 
> 时间：2012-08-19T22:50:45.530
> 
> 标签：backbone.js, qunit, sinon

这些天来，我正在尝试为我的第一个严肃的 Backbone 应用程序进行一些测试。到目前为止，我的正常测试没有问题，但现在我一直在尝试设置异步测试。

基本上，如果我尝试保存具有无效属性的模型并且我想检查这是否触发了 Backbone 中的正确“错误”状态，我的服务器 API 会返回一个带有 500 HTTP 代码错误的页面。

我试图以这种方式设置测试：

```
asyncTest("Test save Model function", function(){
        expect(1);

        var user = new User({});

        var err_spy = this.spy();
        user.on('error',err_spy);         

        user.save(user,{error:function(){
            start();
            equal( err_spy.callCount, 1, "Callback 'error' called once");

        }});

    }); 
```

问题是保存函数的错误回调会覆盖模型中的错误回调，因此触发它的唯一方法是手动执行：

```
user.trigger("error"); 
```

我认为这不是正确的测试方法，因为在我的生产环境中，模型的保存功能没有错误回调，但另一方面我不知道如何告诉 Qunit 等待 ajax 响应来评估测试断言。

有人可以建议我一种使它起作用的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T06:07:21.283

像这样的东西应该可以解决问题。我这里是凭记忆说的，但是 sinon fake server 应该允许你立即返回 500 错误状态并随后调用 spy-on 函数。您可能需要调整 server.respondWith(...) 调用。

```
asyncTest("Test save Model function", function(){
            expect(1);

            var user = new User({});

            // Set up a fake 500 response.
            var server = sinon.fakeServer.create();
            server.respondWith(500, {}, "");

            // Create the error callback.
            var err_callback = function(){};

            var err_spy = sinon.spy(err_callback);         

            user.save(user, {error: err_callback});

            server.respond();

            equal( err_spy.callCount, 1, "Callback 'error' called once");

            server.restore();

        }); 
```

# python - 如何将变量传递给 django 中的所有模板？

> ID：12030611
> 
> 赞同：10
> 
> 时间：2012-08-19T22:52:12.037
> 
> 标签：python, django, templates, view, base

我正在尝试将变量（浏览器变量）传递给我的应用程序中的所有模板。关于如何让它工作的任何建议？

看法：

```
def browser(request):
    primary_cat_list = Categories.objects.order_by("category")
    subcat_list = SubCategories.objects.order_by("sub_category")
    product = Productbackup.objects.order_by("website")
    browser =  list(chain(primary_cat_list, subcat_list, product))
    return render_to_response('reserve/templates/base.html', locals(), context_instance=RequestContext(request)) 
```

模板：

```
{% for prod in browser %} {{ prod }}, {% endfor %} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-20T00:49:50.000

你，我的朋友，正在市场上购买**上下文处理器。**

从一个比我更敏捷和博学的技术作家写[的博客文章中：](http://blog.madpython.com/2010/04/07/django-context-processors-best-practice/)

> **什么是模板上下文处理器？**
> 
> Django 的上下文处理器是一种允许您向模板提供数据和回调的工具。
> 
> 您可以通过以下两种方式之一执行此操作：
> 
> *   根据个人请求：通过将自定义`Context`值传递给您的`render_to_response()`调用
> *   全局：通过创建一个接受`HttpRequest`对象作为输入并返回有效负载或回调的上下文处理器方法，然后在`settings.py`您的.当然，根据个人请求添加更多数据）。`render_to_response()``RequestContext``RequestContext`
> 
> 如果将数据传递给模板的这种方法对您来说听起来很荒谬且令人困惑，那么您并不孤单。如此简单的操作所涉及的复杂性是没有根据的，而且会适得其反，但每个系统都有其缺点。

官方文档在这里：

[https://docs.djangoproject.com/en/dev/ref/templates/api/](https://docs.djangoproject.com/en/dev/ref/templates/api/)

所以，但是，是的，我已经用 Django 编程了一段时间，我真正喜欢用它来解决问题的原因之一是它的复杂性几乎是拜占庭式的，但不是以一种霸道的方式。它有很多可能不会立即看起来有用的东西。当您需要它们时，它们中的每一个都非常方便，如果不需要，它将不会妨碍您。

这里给你的结果是：上下文处理器就是一个很好的例子。是的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-19T23:02:42.833

目前你`locals()`作为变量范围传递，它也应该包括在内`browser`，但我发现使用`locals()`非常难看。

就个人而言，我总是更喜欢这样的模式：

```
def browser(request):
    context = RequestContext(request)

    primary_cat_list = Categories.objects.order_by("category")
    subcat_list = SubCategories.objects.order_by("sub_category")
    product = Productbackup.objects.order_by("website")
    browser =  list(chain(primary_cat_list, subcat_list, product))

    context['browser'] = browser

    return render_to_response('reserve/templates/base.html', context_instance=context) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-20T02:54:47.477

我可以给你一个我的代码示例，它工作正常。这是名为的文件`context_processors.py`：

# context_processors.py

```
def base(request):
    user = request.user

#======================
#Login form
#=====================

# here is the code for login user or check if he is logged in already

return  {
        'user': user,
        } 
```

那就是我的 base.html 的一部分（我在所有页面中都使用的模板）

# base.html

```
{% if user.username %}
                    <h3>
                        Welcome {{ user.username }}
                    </h3> 
```

# list - 如何删除飞镖列表中的重复项？list.distinct()？

> ID：12030613
> 
> 赞同：116
> 
> 时间：2012-08-19T22:52:23.283
> 
> 标签：list, dart

我如何从列表中删除重复项而不用乱搞一套？有没有类似 list.distinct() 的东西？还是 list.unique()？

```
void main() {
  print("Hello, World!");

  List<String> list = ['abc',"abc",'def'];
  list.forEach((f) => print("this is list $f"));

  Set<String> set = new Set<String>.from(list);
  print("this is #0 ${list[0]}");
  set.forEach((f) => print("set: $f"));

  List<String> l2= new List<String>.from(set);
  l2.forEach((f) => print("This is new $f"));
} 
```

```
Hello, World!
this is list abc
this is list abc
this is list def
this is #0 abc
set: abc
set: def
This is new abc
This is new def 
```

* * *

**设置**似乎更快！但它失去了项目的顺序：/

* * *

## 回答 #1

> 赞同：347
> 
> 时间：2018-07-20T16:32:01.140

**使用`toSet`然后`toList`**

```
 var ids = [1, 4, 4, 4, 5, 6, 6];
  var distinctIds = ids.toSet().toList(); 
```

结果：[1、4、5、6]

**或使用扩展运算符：**

```
var distinctIds = [...{...ids}]; 
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2020-08-06T05:28:46.300

我没有发现任何提供的答案很有帮助。以下是我通常会做的事情：

```
final ids = Set();
myList.retainWhere((x) => ids.add(x.id)); 
```

当然，您可以使用任何唯一标识您的对象的属性。它不必是一个`id`字段。

与其他方法相比的好处：

*   保留列表的原始顺序
*   适用于丰富的对象，而不仅仅是基元/可散列类型
*   不必将整个列表复制到集合并返回到列表

**21 年 9 月 12 日更新**
您还可以为列表声明一次扩展方法：

```
extension Unique<E, Id> on List<E> {
  List<E> unique([Id Function(E element)? id, bool inplace = true]) {
    final ids = Set();
    var list = inplace ? this : List<E>.from(this);
    list.retainWhere((x) => ids.add(id != null ? id(x) : x as Id));
    return list;
  }
} 
```

此扩展方法与我的原始答案相同。用法：

```
// Use a lambda to map an object to its unique identifier.
myRichObjectList.unique((x) => x.id);
// Don't use a lambda for primitive/hashable types.
hashableValueList.unique(); 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2019-07-29T18:07:25.370

`Set`工作正常，但它不保留订单。这是另一种使用方式`LinkedHashSet`：

```
import "dart:collection";

void main() {
  List<String> arr = ["a", "a", "b", "c", "b", "d"];
  List<String> result = LinkedHashSet<String>.from(arr).toList();
  print(result); // => ["a", "b", "c", "d"]
} 
```

[https://api.dart.dev/stable/2.4.0/dart-collection/LinkedHashSet/LinkedHashSet.from.html](https://api.dart.dev/stable/2.4.0/dart-collection/LinkedHashSet/LinkedHashSet.from.html)

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2020-05-26T19:28:00.127

尝试以下操作：

```
List<String> duplicates = ["a", "c", "a"];

duplicates = duplicates.toSet().toList(); 
```

[在 Dartpad 上](https://dartpad.dev/4d3a724429bbd605f4682b7da253a16e)检查此代码。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2019-09-30T11:36:39.980

如果您想继续排序或处理比原始类型更复杂的对象，请将看到的 id 存储到[Set](https://api.dartlang.org/stable/2.5.1/dart-core/Set-class.html)并过滤掉那些已经在集合中的对象。

```
final list = ['a', 'a', 'b'];
final seen = Set<String>();
final unique = list.where((str) => seen.add(str)).toList();

print(unique); // => ['a', 'b'] 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2021-02-10T13:03:52.273

我将此添加到[atreeon 的答案](https://stackoverflow.com/questions/12030613/how-can-i-delete-duplicates-in-a-dart-list-list-distinct/51446910#51446910)中。对于任何想要使用它的人`Object`：

```
class MyObject{
  int id;

  MyObject(this.id);

  @override
  bool operator ==(Object other) {
    return other != null && other is MyObject && hashCode == other.hashCode;
  }

  @override
  int get hashCode => id;
}

main(){
   List<MyObject> list = [MyObject(1),MyObject(2),MyObject(1)];

   // The new list will be [MyObject(1),MyObject(2)]
   List<MyObject> newList = list.toSet().toList();
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2019-10-03T13:09:35.217

使用 Dart 2.3+，您可以使用扩展运算符来执行此操作：

```
final ids = [1, 4, 4, 4, 5, 6, 6];
final distinctIds = [...{...ids}]; 
```

`ids.toSet().toList()`这是否比我让读者决定的可读性或多或少:)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2021-04-29T17:56:54.033

对于不同的列表，`objects`您可以使用[Equatable](https://pub.dev/packages/equatable)包。

例子：

```
// ignore: must_be_immutable
class User extends Equatable {
  int id;
  String name;

  User({this.id, this.name});

  @override
  List<Object> get props => [id];
}

List<User> items = [
  User(
    id: 1,
    name: "Omid",
  ),
  User(
    id: 2,
    name: "Raha",
  ),
  User(
    id: 1,
    name: "Omid",
  ),
  User(
    id: 2,
    name: "Raha",
  ),
];

print(items.toSet().toList()); 
```

输出：

```
[User(1), User(2)] 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2021-11-28T19:56:29.890

//这个简单的方法很好用

```
List<String> myArray = [];
myArray = ['x', 'w', 'x', 'y', 'o', 'x', 'y', 'y', 'r', 'a'];

myArray = myArray.toSet().toList();

print(myArray); 
```

// 结果 => myArray =['x','w','y','o','r','a']

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-07-15T09:55:09.497

这是一个可行的解决方案：

```
var sampleList = ['1', '2', '3', '3', '4', '4'];
//print('original: $sampleList');
sampleList = Set.of(sampleList).toList();
//print('processed: $sampleList'); 
```

输出：

```
original: [1, 2, 3, 3, 4, 4]
processed: [1, 2, 3, 4] 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-08-19T23:22:50.863

```
void uniqifyList(List<Dynamic> list) {
  for (int i = 0; i < list.length; i++) {
    Dynamic o = list[i];
    int index;
    // Remove duplicates
    do {
      index = list.indexOf(o, i+1);
      if (index != -1) {
        list.removeRange(index, 1);
      }
    } while (index != -1);
  }
}

void main() {
  List<String> list = ['abc', "abc", 'def'];
  print('$list');
  uniqifyList(list);
  print('$list');
} 
```

给出输出：

```
[abc, abc, def]
[abc, def] 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-12-16T14:32:43.597

使用[fast_immutable_collections](https://pub.dev/packages/fast_immutable_collections)包：

```
[1, 2, 3, 2].distinct(); 
```

或者

```
[1, 2, 3, 2].removeDuplicates().toList(); 
```

注意：虽然`distinct()`返回一个新列表，`removeDuplicates()`但它**通过**返回一个`Iterable`. 这意味着当您进行一些额外的处理时，效率会更高。例如，假设您有一个包含一百万个项目的列表，并且您想要删除重复项并获取前五个：

```
// This will process five items:
List<String> newList = list.removeDuplicates().take(5).toList();

// This will process a million items:
List<String> newList = list.distinct().sublist(0, 5);

// This will also process a million items:
List<String> newList = [...{...list}].sublist(0, 5); 
```

这两种方法也接受一个`by`参数。例如：

```
// Returns ["a", "yk", "xyz"]
["a", "yk", "xyz", "b", "xm"].removeDuplicates(by: (item) => item.length); 
```

如果你不想在你的项目中包含一个包但需要惰性代码，这里是一个简化的`removeDuplicates()`：

```
Iterable<T> removeDuplicates<T>(Iterable<T> iterable) sync* {
  Set<T> items = {};
  for (T item in iterable) {
    if (!items.contains(item)) yield item;
    items.add(item);
  }
} 
```

注意：我是*fast_immutable_collections*包的作者之一。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-12-17T05:15:19.183

对我来说，最佳实践之一是对数组进行排序，然后对其进行重复数据删除。这个想法是从低级语言中偷来的。因此，首先按您自己的方式进行排序，然后对彼此之后的相等值进行重复数据删除。

```
// Easy example
void dedup<T>(List<T> list, {removeLast: true}) {
  int shift = removeLast ? 1 : 0;
  T compareItem;
  for (int i = list.length - 1; i >= 0; i--) {
    if (compareItem == (compareItem = list[i])) {
      list.removeAt(i + shift);
    }
  }
}

// Harder example
void dedupBy<T, I>(List<T> list, I Function(T) compare, {removeLast: true}) {
  int shift = removeLast ? 1 : 0;
  I compareItem;
  for (int i = list.length - 1; i >= 0; i--) {
    if (compareItem == (compareItem = compare(list[i]))) {
      list.removeAt(i + shift);
    }
  }
}

void main() {
  List<List<int>> list = [[1], [1], [2, 1], [2, 2]];
  print('$list');
  dedupBy(list, (innerList) => innerList[0]);
  print('$list');

  print('\n removeLast: false');

  List<List<int>> list2 = [[1], [1], [2, 1], [2, 2]];
  print('$list2');
  dedupBy(list2, (innerList) => innerList[0], removeLast: false);
  print('$list2');
} 
```

输出：

```
[[1], [1], [2, 1], [2, 2]]
[[1], [2, 1]]

removeLast: false
[[1], [1], [2, 1], [2, 2]]
[[1], [2, 2]] 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-07-27T03:08:09.607

这是另一种方式...

```
final reducedList = [];

list.reduce((value, element) {
    if (value != element) 
        reducedList.add(value);
    return element;
});

reducedList.add(list.last);

print(reducedList); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-03-05T18:08:36.157

```
List<Model> bigList = [];
List<ModelNew> newList = [];  

for (var element in bigList) {
      var list = newList.where((i) => i.type == element.type).toList();
      if(list.isEmpty){
       newList.add(element);
      }
    } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-12-09T01:03:59.510

这个对我有用。

```
var list = [
 {"id": 1, "name": "Joshua"},
 {"id": 2, "name": "Joshua"},
 {"id": 3, "name": "Shinta"},
 {"id": 4, "name": "Shinta"},
 {"id": 5, "name": "Zaidan"}
];
list.removeWhere((element) => element.name == element.name.codeUnitAt(1));
list.sort((a, b) => a.name.compareTo(b.name)); 
```

输出：

```
[{"id": 1, "name": "Joshua"}, 
{"id": 3, "name": "Shinta"}, 
{"id": 5, "name": "Zaidan"}] 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2020-12-21T23:27:49.740

这是我的解决方案

```
 List<T> removeDuplicates<T>(List<T> list, IsEqual isEqual) {
      List<T> output = [];
      for(var i = 0; i < list.length; i++) {
        bool found = false;
        for(var j = 0; j < output.length; j++) {
          if (isEqual(list[i], output[j])) {
            found = true;
          }
        }
        if (found) {
          output.add(list[i]);
        }
      }

      return output;
    } 
```

像这样使用它：

```
 var theList = removeDuplicates(myOriginalList, (item1, item2) => item1.documentID == item2.documentID); 
```

或者...

```
 var theList = removeDuplicates(myOriginalList, (item1, item2) => item1.equals(item2)); 
```

或者...

* * *

## 回答 #18

> 赞同：-9
> 
> 时间：2012-08-20T00:53:11.620

我有一个名为[Reactive-Dart](https://github.com/ReactiveX/rxdart)的库，其中包含许多用于终止和非终止序列的可组合运算符。对于您的场景，它看起来像这样：

```
final newList = [];
Observable
   .fromList(['abc', 'abc', 'def'])
   .distinct()
   .observe((next) => newList.add(next), () => print(newList)); 
```

产量：

```
[abc, def] 
```

我应该补充一点，还有其他具有类似功能的库。在 GitHub 上查看一下，我相信你会找到合适的。

# mysql - 有没有办法在 CREATE TABLE 语句中使用用户定义的变量作为列长度？

> ID：12030614
> 
> 赞同：3
> 
> 时间：2012-08-19T22:52:34.267
> 
> 标签：mysql, sql, varchar, create-table, user-variables

测试.sql：

```
SET @my_var = 50;

CREATE TABLE test_table (
    id SMALLINT NOT NULL,
    my_text VARCHAR(@my_var),
    PRIMARY KEY (id)
); 
```

命令行交互：

```
mysql> source d:/test.sql;
Query OK, 0 rows affected (0.00 sec)

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use near
'@my_var),
    PRIMARY KEY (id)
)' at line 3 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:05:15.183

`CREATE TABLE`除了将整个编译为字符串并执行它之外，我想不出其他方法：

```
SET @my_var = 50;

PREPARE sql FROM '
CREATE TABLE test_table (
    id SMALLINT NOT NULL,
    my_text VARCHAR(' + @my_var + '),
    PRIMARY KEY (id)
);
'
EXECUTE sql;
DEALLOCATE PREPARE sql; 
```

它非常丑陋，但应该可以。

# algorithm - 递归与非递归排序算法

> ID：12030618
> 
> 赞同：4
> 
> 时间：2012-08-19T22:53:46.157
> 
> 标签：algorithm, sorting, recursion

有人可以用英语解释排序算法的非递归和递归实现有何不同吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-19T23:01:05.410

它们有何不同，在什么意义上？请记住：任何递归算法都可以实现为迭代算法，反之亦然（看看这篇[文章](https://stackoverflow.com/questions/931762/can-every-recursion-be-converted-into-iteration)）。迭代或递归——它只是一个实现细节；尽管它可能会对性能产生重大影响，具体取决于选择，但算法将是相同的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T22:56:27.980

递归排序算法的工作原理是将输入拆分为两个或多个较小的输入，然后对它们进行排序，然后组合结果。[合并排序](http://en.wikipedia.org/wiki/Merge_sort)和[快速排序](http://en.wikipedia.org/wiki/Insertion_sort)是递归排序算法的示例。

非递归技术是任何不使用递归的技术。[插入排序](http://en.wikipedia.org/wiki/Insertion_sort)是非递归排序算法的一个简单示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T22:56:38.400

递归排序算法调用自身对数组的较小部分进行排序，然后组合部分排序的结果。快速排序就是一个例子。

非递归算法一次完成所有排序，而不调用自身。冒泡排序是非递归算法的一个例子。

# php - 在 OSX 上启用对 Gearman 的 libdrizzle 支持

> ID：12030621
> 
> 赞同：0
> 
> 时间：2012-08-19T22:54:48.507
> 
> 标签：php, macos, gearman, libdrizzle

有谁知道如何让 libdrizzle 支持在 OSX 上为 gearman 工作？

我使用以下命令通过端口安装了 gearmand：

```
sudo port install gearmand +drizzle 
```

但是，当我尝试使用 libdrizzle 标志时，gearmand 会引发错误：

```
$ gearmand -q libdrizzle --libdrizzle-mysql
gearmand: unrecognised option '--libdrizzle-mysql' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:49:04.507

我会使用 MySQL 驱动程序后端。这有点可悲。

干杯，-布赖恩

# c# - 如何防止客户端使用 WCF 修改 DataContract 的内容？

> ID：12030622
> 
> 赞同：1
> 
> 时间：2012-08-19T22:54:47.667
> 
> 标签：c#, .net, wcf

我正在构建一个需要用户在启动时登录的应用程序。

认证过程如下：

*   用户输入用户名/密码。
*   客户端将用户名 + 密码发送到 Web 服务。
*   Web 服务使用来自数据库的散列密码对用户进行身份验证。
*   Web 服务向客户端返回一个令牌，其中包含以下三个值之一：

    1) 用户名​​无效。

    2) 密码无效。

    3) 用户被认证。

*   客户端使用令牌来确定下一步行动。

*   令牌会在客户端进行的每个后续调用中传递给服务。如果用户未通过身份验证，服务将拒绝呼叫。

令牌被封装在一个 DTO 中，它是一个 DataContract。令牌本身是一个 DataMember。DataMembers 要求该属性有一个 setter 和一个 getter。这意味着客户端现在可以为令牌设置一个值，这很糟糕。客户现在可以在技术上将自己标记为经过身份验证。

我将如何阻止客户修改令牌的值？有什么模式可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:16:00.280

服务器必须“知道”令牌并对其进行验证。

您无法限制客户端更改令牌。想想看——我给你发了一个 DTO，基本上是一堆信息。稍后，你把那个包裹寄回给我。我怎么可能阻止您更改捆绑包中的内容？我唯一能做的就是检查捆绑包是否有效，您没有更改任何我不希望您更改的内容，等等。

如果您的令牌是一个简单的`authenticated`标志，那将是一场灾难。想象一个网站接受了一个`logged in`刚刚信任我的参数。您告诉网络服务器您已登录并且它相信您？`www.visa.com/account.html?account=123456&loggedIn=true`似乎不是很安全。

在平台不可知论的世界中，您可以使用加密来创建可以验证的安全令牌。您已经有一个令牌，所以也许您可以将一些加密内容添加到验证用户的令牌中。客户端不知道数据是什么，也不能轻易解密。他们需要在每次请求时将令牌返回给服务器。服务器可以解密确认用户已通过身份验证的令牌。

当然，令牌需要过期，并且需要安全且不可猜测。在 Windows 世界中，使用 Windows 身份验证或滚动的 .NET 身份验证模式之一可能更简单。

# ant - 检查多个属性已设置且不为空（ant）

> ID：12030623
> 
> 赞同：5
> 
> 时间：2012-08-19T22:55:26.367
> 
> 标签：ant, ant-contrib

我的情况涉及运行带有可选参数的 ant 构建，这些可选参数总是指定但并不总是定义，就像这样

```
ant -DBUILD_ENVIRONMENT=test -Dusername_ext= -Dconf.dir_ext= -Dcgi-dir_ext= 
```

如果参数没有在命令行上给定值，它们将通过加载 .properties 文件。我有以下代码将检查属性 isset 是否为空。

```
<if>
    <bool>
        <and>
            <isset property="username_ext"/>
            <not>
                <equals arg1="${username_ext}" arg2="" />
            </not>
        </and>
    </bool>
    <then>
        <property name="username" value="${username_ext}" />
    </then>
</if>
<property file="${BUILD_ENVIRONMENT}.properties" /> 
```

由于有多个属性，我似乎应该编写一个目标，该目标将对每个属性执行相同的操作，而不是每次都重复该代码。

```
<antcall target="checkexists">
    <property name="propname" value="username"/>
    <property name="paramname" value="username_ext"/>
</antcall>
<antcall target="checkexists">
    <property name="propname" value="conf.dir"/>
    <property name="paramname" value="conf.dir_ext"/>
</antcall> 
```

但是 AFAIK an antcall 不会设置全局属性。那么我如何编写一个目标来接受它需要检查的参数名称已设置且不为空，然后将其复制到其他目标可以使用的参数中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T20:21:34.563

除了使用目标之外，您还可以使用宏根据另一个属性是否设置为非空值来有条件地设置属性。

```
<macrodef name="set-property">
  <attribute name="name" />
  <attribute name="if-property-isset" />
  <attribute name="value" default="${@{if-property-isset}}" />

  <sequential>
    <condition property="@{name}" value="@{value}">
      <and>
        <isset property="@{if-property-isset}" />
        <not>
          <equals arg1="${@{if-property-isset}}" arg2="" />
        </not>
      </and>
    </condition>
  </sequential>
</macrodef>

<target name="test-macro">
  <set-property name="username" if-property-isset="username_ext" />

  <set-property name="conf.dir" if-property-isset="conf.dir_ext" />

  <property name="conf.dir" value="default conf directory" />

  <echo message="username = ${username}" />
  <echo message="conf.dir = ${conf.dir}" />
</target> 
```

# 输出

```
$ ant test-macro -Dusername_ext=jsmith -Dconf.dir_ext=
Buildfile: /your/project/build.xml

test-macro:
     [echo] username = jsmith
     [echo] conf.dir = default conf directory

BUILD SUCCESSFUL
Total time: 1 second 
```

# 备用属性值

此宏还允许您将属性设置为与命令行上提供的值不同的值。

```
<target name="test-macro">
  <set-property name="username" if-property-isset="username_ext"
      value="It worked!" />

  <set-property name="conf.dir" if-property-isset="conf.dir_ext" />

  <property name="conf.dir" value="default conf directory" />

  <echo message="username = ${username}" />
  <echo message="conf.dir = ${conf.dir}" />
</target> 
```

# 输出

```
$ ant test-macro -Dusername_ext=jsmith -Dconf.dir_ext=
Buildfile: /your/project/build.xml

test-macro:
     [echo] username = It worked!
     [echo] conf.dir = default conf directory

BUILD SUCCESSFUL
Total time: 1 second 
```

# java - 用于 jexcel 中的公式解析的 EmptyStackException

> ID：12030624
> 
> 赞同：2
> 
> 时间：2012-08-19T22:55:45.270
> 
> 标签：java, jexcelapi

我是 jexcel api 的新手，还没有成功添加公式。

每当我尝试编译公式时，都会出现编译错误：

```
Exception in thread "main" java.util.EmptyStackException
　　　　　at java.util.Stack.peek(Stack.java:102)
　　　　　at java.util.Stack.pop(Stack.java:84)
　　　　　at jxl.biff.formula.BinaryOperator.getOperands(BinaryOperator.java:61)
　　　　　at jxl.biff.formula.StringFormulaParser.parseCurrent(StringFormulaParser.java:240)
　　　　　at jxl.biff.formula.StringFormulaParser.parse(StringFormulaParser.java:113)
　　　　　at jxl.biff.formula.FormulaParser.parse(FormulaParser.java:161)
　　　　　at jxl.write.biff.FormulaRecord.initialize(FormulaRecord.java:160)
　　　　　at jxl.write.biff.FormulaRecord.setCellDetails(FormulaRecord.java:243)
　　　　　at jxl.write.biff.WritableSheetImpl.addCell(WritableSheetImpl.java:1199) 
```

从调用 addCell

```
Formula formula;
formula = new Formula(column, row, string, arial);
sheet.addCell(formula); 
```

如果我犯了一些明显的错误，请告诉我，我可以采取哪些步骤来正确地将公式添加到我的电子表格中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T08:05:52.403

我遇到了同样的问题，我的问题是我在表达式之前放了“=”，只是删除了它并且它没有错误地工作

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-19T22:59:27.290

```
/**
 * Looks at the object at the top of this stack without removing it
 * from the stack.
 *
 * @return     the object at the top of this stack (the last item
 *             of the <tt>Vector</tt> object).
 * @exception  EmptyStackException  if this stack is empty.
 */
public synchronized E peek() {
int len = size();

if (len == 0)
    throw new EmptyStackException();
return elementAt(len - 1);
} 
```

所以你得到的错误类似于 NullPointerException，不同的是你的堆栈是空的，所以你不能从中窥视任何东西。

这可能表明您有问题`string`

这是一个教程[http://www.java-tips.org/other-api-tips/jexcel/how-to-create-an-excel-file.html](http://www.java-tips.org/other-api-tips/jexcel/how-to-create-an-excel-file.html)也谈论创建公式。

这是另一个：[http ://r4r.co.in/java/apis/jexcel/basic/example/jexcel_basic_examples.php?id=774&option=Jexcel%20Example](http://r4r.co.in/java/apis/jexcel/basic/example/jexcel_basic_examples.php?id=774&option=Jexcel%20Example)

# c - C、不使用malloc初始化struct

> ID：12030625
> 
> 赞同：2
> 
> 时间：2012-08-19T22:55:46.903
> 
> 标签：c, oop, constructor, struct

我会避免使用 malloc 来初始化结构，并且我正在寻找使用 oo 样式（如果可能）设计 C 软件的最佳实践。

**只有 C99，不是 C++**

第一个问题，当使用像对象这样的结构时，什么是可取的？typedef 它的指针与否？

这些是我的测试（所有工作都使用 gcc 编译器）：

**情况1**

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct sItem{
    int n;
    char* text;
} oItem, *Item;

int main(int argc, char** argv) {
    Item i1=(&(oItem){.n=1, .text="A"});
    Item i2=(&(oItem){.n=100, .text="ABC"});
    printf("%d, %s, %d\n", i1->n, i1->text, sizeof(*i1)); // 1, "A", 8
    printf("%d, %s, %d\n", i2->n, i2->text, sizeof(*i2)); // 1, "ABC", 8
    return (EXIT_SUCCESS);
} 
```

这有效，但我认为它不应该因为文本未初始化为包含字符串。这是一段无效的代码吗？

**案例2**

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct sItem{
    int n;
    char text[5];
} oItem, *Item;

int main(int argc, char** argv) {
    Item i1=(&(oItem){.n=1, .text="A"});
    Item i2=(&(oItem){.n=100, .text="ABC"});
    printf("%d, %s, %d\n", i1->n, i1->text, sizeof(*i1)); // 1, "A", 12
    printf("%d, %s, %d\n", i2->n, i2->text, sizeof(*i2)); // 1, "ABC", 12
    return (EXIT_SUCCESS);
} 
```

这行得通，我认为它是正确的，是吗？

**案例3**

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define Item_new(i, n, s) (&(oItem){0});Item_ctor(i, n, s);
#define Item_neww(i, x, s) (&(oItem){\
        .n=x,\
        .text=s\
})

typedef struct sItem{
    int n;
    char text[5];
} oItem, *Item;

void Item_ctor(Item i, int n, char* text){
    i->n=n;
    strcpy(i->text, text);
}

int main(int argc, char** argv) {
    Item i1=Item_new(i1, 10, "ABC");
    Item i2=Item_neww(i2, 10, "ABC");
    printf("%d, %s, %d\n", i1->n, i1->text, sizeof(*i1)); // 10, "ABC", 12
    printf("%d, %s, %d\n", i2->n, i2->text, sizeof(*i2)); // 10, "ABC", 12
    return (EXIT_SUCCESS);
} 
```

我认为这很好，但是隐藏了代码，并且可能有害，您怎么看？I case 3，最好的选择是什么：宏还是构造函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:54:26.560

不要做 3，包含 unprotected 的宏`;`让我非常紧张。

相反，我会用以下内容替换您的“新”和“ctor”

```
#define Item_new(i, n, s) Item_ctor(&(oItem){0}, n, s)

Item Item_ctor(Item i, int n, char* text){
    if (i) {
      i->n=n;
      strncpy(i->text, text, 4);
    }
    return i;
} 
```

这并没有打破用户的期望`Item_new`：一个真正的函数，比如返回一个值的宏。

并且 ctor 应该进行必要的检查并且永远不会覆盖内存，`i->text[4]`将永远是`0`. （更好的办法是使用一个符号常量，而不是`5`将它也用于`strncpy`调用。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:03:47.133

案例 3 是我最常看到的，并且会推荐。将代码包装在构造函数中非常好——为什么隐藏代码会成为问题？事实上，这是一个特性——从实现中隐藏接口。此外，不要为此使用宏 - 这对于宏来说是一项过于复杂的任务，然而，宏通常是邪恶的。

方法 1 和 2 非常丑陋（事实证明，它们也是 UB）并且在我看来不可读。此外，案例 1 不是 const 正确的，要么使用案例 2（好吧，也不要使用它，因为它会调用未定义的行为）或将“文本”声明为`const char *`.

# php - 从受约束的宽度值图像中获取图像高度？

> ID：12030627
> 
> 赞同：-1
> 
> 时间：2012-08-19T22:56:18.790
> 
> 标签：php, image, height

我想知道是否可以执行某种函数来获取受限宽度图像的高度？我可以使用以下方法获得原始高度：

```
list($width, $height, $type, $attr) = getimagesize($path."/images/".$image->image); 
```

但是我在页面上的图像被限制为 580px 宽：

```
<img src="/images/<?php echo $image->image; ?>" width="580" height="????" border="0" /> 
```

我想知道是否有可能获得约束宽度图像的新高度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T22:59:53.300

都是关于比率的。您已经有了原件的宽度/高度比。现在你只需要根据你的 580px 宽度来获取它。宽度/高度为 580/X

```
function getHeight($width,$height){ //originals 
    return (580*$height)/$width;
} 
```

# terminal - 确定独立于终端类型的转义序列

> ID：12030628
> 
> 赞同：0
> 
> 时间：2012-08-19T22:56:24.767
> 
> 标签：terminal, ansi-escape

我的应用程序以原始模式从终端读取转义序列。当它在 xterm 上运行时，我得到了 F2，例如“\eOQ”。但是当它在 linux tty 终端中运行时（通过 Ctrl-Alt-F1 切换）我得到了“\e[[[B”。
确定我的 F2 独立于运行的终端类型应用程序的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T10:40:10.813

如果您想阅读终端按键，您可能想查看类似[libtermkey](http://www.leonerd.org.uk/code/libtermkey/)的内容，它可以为您抽象出一般问题。在内部，它使用`terminfo`查找的组合，或者对修改过的按键进行扩展的类模型的硬编码知识`xterm`，因此它可以理解诸如 之类的东西`Ctrl-Up`，而这是常规的诅咒/等等......不能。

```
while((ret = termkey_waitkey(tk, &key)) != TERMKEY_RES_EOF) {
  termkey_strfkey(tk, buffer, sizeof buffer, &key, TERMKEY_FORMAT_VIM);
  printf("You pressed key %s\n", buffer);

  if(key.type == TERMKEY_TYPE_FUNCTION &&
     !key.modifiers &&
     key.code.number = 2)
    printf("Got F2\n");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T22:56:24.767

好的，因为我得到了使用 [n]curses 库的最佳方法。它是读取 terminfo (termcap) 数据库并确定您获得的平均转义序列取决于终端类型。没有必要使用它的终端图形功能。要使用 curses 获得正确的转义序列，您可以执行以下操作： 此外，可能通过读取应用程序中的 terminfo 数据库手动完成。 `newterm(NULL, stdout, stdin);
raw();
noecho();
keypad();
ch = getch();
if (ch == KEY_F(2)) printf("Got F2");
endwin();`

# android - 在 ShareActionProvider 共享意图中使用字符串

> ID：12030631
> 
> 赞同：1
> 
> 时间：2012-08-19T22:56:31.290
> 
> 标签：android, android-intent, action, share, provider

我正在尝试让 ShareActionProvider 工作，但遇到了以下问题：

此代码有效：

```
 Intent shareIntent = new Intent(Intent.ACTION_SEND);
    shareIntent.setType("text/plain");
    shareIntent.putExtra(Intent.EXTRA_TEXT, "Text I want to share");

    MenuItem shareItem = menu.findItem(R.id.share);
    mShareActionProvider = (ShareActionProvider) shareItem.getActionProvider();
    mShareActionProvider.setShareIntent(shareIntent); 
```

但这不会：

```
 Intent shareIntent = new Intent(Intent.ACTION_SEND);
    shareIntent.setType("text/plain");
    shareIntent.putExtra(Intent.EXTRA_TEXT, webView.getUrl());

    MenuItem shareItem = menu.findItem(R.id.share);
    mShareActionProvider = (ShareActionProvider) shareItem.getActionProvider();
    mShareActionProvider.setShareIntent(shareIntent); 
```

这是为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-05T22:47:05.127

我不确定，但试试

```
shareIntent.putExtra(Intent.EXTRA_TEXT, webView.getUrl().toString()); 
```

代替

```
shareIntent.putExtra(Intent.EXTRA_TEXT, webView.getUrl()); 
```

# php - PHP包含路径和路径分隔符混淆

> ID：12030636
> 
> 赞同：0
> 
> 时间：2012-08-19T22:57:05.843
> 
> 标签：php, zend-framework

我正在尝试运行一个开源 Web 应用程序。它来自这里 - [https://sourceforge.net/projects/labshare-sahara/](https://sourceforge.net/projects/labshare-sahara/) 它使用 Zend PHP 框架。

我的问题在于以下代码。它无法找到文件，因此返回 false，并且消息：

> “2012-08-20T00:01:08+02:00 DEBUG (7): Unable to find auth class SAHARANS_Auth_Type_Database in include path”

输出到日志文件。

* * *

```
 private function _loadClass($name)
       {
            /* Find the class to load. */
            $file = implode('/', explode('_', $name)) . '.php';
            foreach (explode(PATH_SEPARATOR, get_include_path()) as $path)
            {
                $this->_logger->debug("does $path/$file exist?"); //I added this
                if (file_exists($path . PATH_SEPARATOR . $file))
                {
                    return new $name();
                }
            }

            $this->_logger->debug("Unable to find auth class $name in include path.");
            return false;
        } 
```

为了提供更多上下文，我让它在日志中打印更多信息 - 所以它每次在 for 循环中写入日志。这是输出：

```
2012-08-20T00:47:07+02:00 DEBUG (7): does C:\xampp\htdocs\Sahara-WI\WI\application/../library/SAHARANS/Auth/Type/Database.php exist?

2012-08-20T00:47:07+02:00 DEBUG (7): does C:\xampp\htdocs\Sahara-WI\WI\library/SAHARANS/Auth/Type/Database.php exist?

2012-08-20T00:47:07+02:00 DEBUG (7): does C:\xampp\htdocs\Sahara-WI\WI\application\models/SAHARANS/Auth/Type/Database.php exist?

2012-08-20T00:47:07+02:00 DEBUG (7): does C:\xampp\htdocs\Sahara-WI\WI\institution/SAHARANS/Auth/Type/Database.php exist?

2012-08-20T00:47:07+02:00 DEBUG (7): does ./SAHARANS/Auth/Type/Database.php exist?

2012-08-20T00:47:07+02:00 DEBUG (7): does C:\xampp\php\PEAR/SAHARANS/Auth/Type/Database.php exist?

2012-08-20T00:47:07+02:00 DEBUG (7): Unable to find auth class SAHARANS_Auth_Type_Database in include path

2012-08-20T00:47:07+02:00 DEBUG (7): does C:\xampp\htdocs\Sahara-WI\WI\application/../library/Sahara/Auth/Type/Database.php exist?

2012-08-20T00:47:07+02:00 DEBUG (7): does C:\xampp\htdocs\Sahara-WI\WI\library/Sahara/Auth/Type/Database.php exist

2012-08-20T00:47:07+02:00 DEBUG (7): does C:\xampp\htdocs\Sahara-WI\WI\application\models/Sahara/Auth/Type/Database.php exist? 
```

注意：Database.php 确实存在于 models\Sahara\Auth\Type 目录中！

立即看起来很奇怪的是路径中的“/”和“\”之间的互换，但试图强制反弹（我使用的是 Windows 机器）似乎没有任何影响。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:15:16.093

PATH_SEPARATOR 是；在 Windows 上，并且 : 在其他操作系统上。它用于拆分多个路径，而不是（子）目录和文件名。

改变：

```
if (file_exists($path . PATH_SEPARATOR . $file)); 
```

至：

```
if (file_exists($path . '/' . $file)); 
```

这将在任何地方工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:18:36.097

那么2件事：

1.  用[`DIRECTORY_SEPARATOR`而不用`PATH_SEPARATOR`](http://php.net/manual/en/dir.constants.php "PHP - 目录常量")。
2.  用于[`realpath()`](http://il.php.net/realpath)修复任何路径异常。

如果有人感兴趣，我的自动加载器看起来像这样（虽然不是 ZF）：

```
<?php

namespace Application\Common;
/**
 * Autoloader class
 * This class will be responsible for autoloading of classes.
 */
class Autoloader {

    /** @var string $namespace  Namespace prefix for this instance */
    private $namespace;
    /** @var string $path       Path prefix for this instance */
    private $path;

    /**
     * @param string $namespace
     * @param string $path
     */
    public function __construct($namespace, $path) {
        $this->namespace = ltrim($namespace, "\\");
        $this->path      = rtrim($path, "/\\");
    }

    /**
     * Attempts to load a class.
     *
     * @param string $class The class name, including namespace.
     *
     * @return bool Success or fail based on class existence.
     */
    public function load($class) {
        $class = ltrim($class, "\\");
        //Check to see if class is from correct namespace defined by Autoloader instance.
        if (strpos($class, $this->namespace) === 0) {
            //Explode by namespace parts
            $namespace_parts = explode("\\", $class);
            //Class would be the last element, take it out and return it
            $class             = array_pop($namespace_parts);
            $namespace_parts[] = '';
            /* Build the directory path:
                The base path as defined in Autoloader
                The namespace parts, each a folder
                Parts of the class, separated by an underscore, become folders as well
            */
            $path = $this->path . DIRECTORY_SEPARATOR . implode(DIRECTORY_SEPARATOR, $namespace_parts);
            $path .= str_replace("_", DIRECTORY_SEPARATOR, $class) . ".php";
            $path = realpath($path);
            if (file_exists($path)) {
                require $path;
                return true;
            }
        }
        return false;
    }

    /**
     * Register the function.
     */
    public function register() {
        spl_autoload_register(array($this, "load"));
    }

    /**
     * Unregisters the function.
     */
    public function unregister() {
        spl_autoload_unregister(array($this), "load");
    }
} 
```

利用：

```
//Application being the common namespace prefix.
//__DIR__."Application" being the base directory.
$autoloader = new Application\Common\Autoloader("Application", __DIR__ . "Application");
$autoloader->register(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T08:06:38.970

你的自动加载器需要在类中实际需要，所以你可能想要：

```
if (file_exists($path . PATH_SEPARATOR . $file))
{
    require $path . PATH_SEPARATOR . $file;
    return new $name();
} 
```

# java - 如何确保始终调用 finalize()（Java 练习中的思考）

> ID：12030641
> 
> 赞同：15
> 
> 时间：2012-08-19T22:58:41.877
> 
> 标签：java, garbage-collection, finalize

我正在慢慢研究 Bruce Eckel 的*Thinking in Java 4th edition*，以下问题让我很困惑：

> 创建一个带有 finalize( ) 方法的类，该方法打印一条消息。在 main( ) 中，创建你的类的一个对象。修改前面的练习，以便始终调用您的 finalize()。

这是我编码的：

```
public class Horse {
    boolean inStable;
    Horse(boolean in){
        inStable = in;
    }   
    public void finalize(){
        if (!inStable) System.out.print("Error: A horse is out of its stable!");
    }
}
public class MainWindow {
    public static void main(String[] args) {
        Horse h = new Horse(false);
        h = new Horse(true);
        System.gc();
    }
} 
```

它创建一个`Horse`布尔值`inStable`设置为的新对象`false`。现在，在该`finalize()`方法中，它检查是否`inStable`为`false`。如果是，它会打印一条消息。

不幸的是，没有打印任何消息。由于条件评估为`true`，我的猜测是它`finalize()`一开始就没有被调用。我已经多次运行该程序，并且只看到错误消息打印了几次。我的印象是，当`System.gc()`被调用时，垃圾收集器将收集任何未引用的对象。

谷歌搜索一个正确的答案给了我[这个链接](http://greggordon.org/java/tij4/initialization/BankTest.java)，它提供了更详细、更复杂的代码。它使用我以前从未见过的方法，例如`System.runFinalization()`、`Runtime.getRuntime()`和`System.runFinalizersOnExit()`。

有没有人能让我更好地理解它是如何`finalize()`工作的以及如何强制它运行，或者让我了解解决方案代码中正在做什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-19T23:03:56.243

当垃圾收集器发现一个符合收集条件但有 a 的对象时，`finalizer`它不会立即释放它。垃圾收集器尝试尽快完成，因此它只是将对象添加到具有未决终结器的对象列表中。终结器稍后在单独的线程上调用。

[`System.runFinalization`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#runFinalization())您可以通过在垃圾回收后调用该方法来告诉系统尝试立即运行挂起的终结器。

但是如果你想*强制*终结器运行，你必须自己调用它。垃圾收集器不*保证*将收集任何对象或调用终结器。它只会“尽力而为”。但是，您很少需要强制终结器在实际代码中运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-13T16:16:27.233

在玩具场景之外，通常不可能确保`finalize`总是在不存在“有意义”引用的对象上调用 a，因为垃圾收集器无法知道哪些引用是“有意义的”。例如，一个`ArrayList`-like 对象可能有一个“clear”方法，该方法将其计数设置为零，并使支持数组中的所有元素都有资格被未来的`Add`调用覆盖，但实际上并没有清除该支持数组中的元素。如果对象有一个大小为 50 的数组，并且它`Count`是 23，那么可能没有执行路径可以让代码检查存储在数组的最后 27 个插槽中的引用，但是垃圾没有办法-收藏家知道这一点。最后，`finalize`在这些插槽中的对象上，除非或直到容器覆盖了这些数组插槽，容器放弃了数组（可能有利于更小的数组），或者对容器本身的所有根引用都被破坏或以其他方式不复存在。

有多种方式鼓励系统调用`finalize`在碰巧不存在强根引用的任何对象上（这似乎是问题的重点，并且其他答案已经涵盖），但我认为重要的是要注意强根对象集之间的区别引用存在，并且代码可能感兴趣的对象集。这两个集合在很大程度上重叠，但每个集合都可以包含另一个集合中不存在的对象。当 GC 确定对象将不再存在但终结器存在时，对象的终结器就会运行；这可能与他们不再对任何人感兴趣的时间码一致，也可能不一致。虽然如果可以使终结器在所有不再感兴趣的对象上运行会很有帮助，但这通常是不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:33:00.957

对垃圾**收集**器`System.gc()`（那时和那里的行动，它可能会或可能不会做同样的事情）。当控制从方法调用返回时，Java 虚拟机已尽最大努力从所有丢弃的对象中回收空间。当垃圾收集器确定不再有对该对象的引用时，垃圾收集器对对象调用 finalize()

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-11T03:19:23.413

这对我有用（部分，但它确实说明了这个想法）：

```
class OLoad {

    public void finalize() {
        System.out.println("I'm melting!");
    }
}

public class TempClass {

    public static void main(String[] args) {
        new OLoad();
        System.gc();
    }
} 
```

行**new OLoad();** 成功了，因为它创建了一个没有附加引用的对象。这有助于**System.gc()**在检测到没有引用的对象时运行 finalize() 方法。说像**OLoad o1 = new OLoad();** 将不起作用，因为它将创建一个直到 main() 结束的引用。不幸的是，这在*大多数情况下都*有效。正如其他人指出的那样，除了自己调用它之外，没有办法确保始终调用**finalize() 。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-25T10:06:47.473

运行 new constructor() 和 System.gc() 两次以上。

```
public class Horse {
    boolean inStable;
    Horse(boolean in){
        inStable = in;
    }   
    public void finalize(){
        if (!inStable) System.out.print("Error: A horse is out of its stable!");
    }
}
public class MainWindow {
    public static void main(String[] args) {
        for (int i=0;i<100;i++){
            Horse h = new Horse(false);
            h = new Horse(true);
            System.gc();
        }
    }
} 
```**

# javascript - 单击显示加载程序上的 javascript 按钮

> ID：12030642
> 
> 赞同：1
> 
> 时间：2012-08-19T22:58:50.723
> 
> 标签：javascript, button, loader

我正在使用 javascript 来完成一个有时需要很长时间才能完成的命令，但是当我单击按钮时，按钮保持按下状态并且在 javascript 执行完成之前不会更新屏幕。我需要知道如何在执行 javascript 时继续更新屏幕，因为我想在执行 javascript 时显示一个加载器。

代码：[jsFiddle 代码](http://jsfiddle.net/TSUcs/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:05:05.073

使用 jQuery。jQuery.click 将获得一个点击操作，然后使用 jQuery 的切换和一个在 click 函数中包含加载 gif 的 div。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:10:22.717

图像不显示，因为浏览器仅在当前 Javascript 堆栈结束后才会进行重绘/重绘。

您可以做的是显示加载程序并[`setTimeout`](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)在重绘发生后使用 a 调用您的重处理函数。

请注意，如果您的函数执行同步操作，例如小提琴中的`for`循环`100000000`时间，您的浏览器将忙于处理它以动画加载图像（然后您将拥有一个静态图像）。

```
onclick="show_loader(); setTimeout(fn, 100);" 
```

[**小提琴**](http://jsfiddle.net/ult_combo/TSUcs/4/)

# ruby-on-rails - 如何根据用户当前时区制作今天的日期方法？

> ID：12030643
> 
> 赞同：1
> 
> 时间：2012-08-19T22:58:57.747
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我的课堂上有一个方法可以定义今天是什么。

```
class Practice
  attr_accessible :date
  def self.today
    where(:date => Date.today)
  end
end 
```

我让我的 Time.zone 与用户在我的应用程序控制器上使用之前的过滤器相同。

```
before_filter :set_user_time_zone

private

def set_user_time_zone
  if signed_in?
    Time.zone = current_user.time_zone
  end
end 
```

但是当谈到 Date.today 时，即使将用户的时区放在东京，它也会将其视为美国东部。所以它在美国是 8 月 19 日，超过了 8 月 20 日。我怎样才能将它改为 8 月 20 日或时区的日期？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-19T23:24:37.767

而不是改变`Time.zone`，你可以使用[`in_time_zone`](http://api.rubyonrails.org/classes/Time.html#method-i-in_time_zone)：

```
Time.current.in_time_zone(current_user.time_zone).to_date 
```

您可能必须将时区作为方法参数传递，因为`current_user`通常在模型中不可用。

# jquery - 检查锚点是否被点击

> ID：12030647
> 
> 赞同：-1
> 
> 时间：2012-08-19T22:59:43.643
> 
> 标签：jquery, html, anchor

```
<a href='#' id='aId1'>1</a>
<a href='#' id='aId2'>2</a>
<a href='#' id='aId3'>3</a>
<a href='#' id='aId4'>4</a>
<a href='#' id='aId5'>5</a> 
```

是否可以通过 JQuery 检查是否单击了锚点？它应该获取被点击的锚点的 id，如果没有点击锚点，它也应该有一个事件要执行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-19T23:04:59.180

这**只会**`id`在单击锚点并将元素存储为变量时触发。

```
$("a").on("click", function (e) {

    // Id of the element that was clicked
    var elementId = $(this).attr("id");

}); 
```

如果您想在单击锚点时阻止默认操作，请将其添加到函数的末尾：

```
e.preventDefault(); return false; 
```

如果要将锚点标记为已单击以供将来参考，请尝试以下操作：

```
$("a").on("click", function (e) {

    // Id of the element that was clicked
    var elementId = $(this).attr("id");

    $(this).data("clicked", true);

}); 
```

的，使用jquery，检查它是否已被点击使用

```
$(element).data("clicked") // returns True or False 
```

如果您想监听所有被点击的内容并想查看它是否是锚点，请尝试：

```
$("*").not("body").on("click", function (e) {

    if ($(this).is("a")) {
        // Id of the element that was clicked
        var elementId = $(this).attr("id");
    } else {
        // An anchor was not clicked, do something else
    }

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:03:37.090

一种方法是在单击它们时添加一个单击的类。

```
$("a").click(function(){
    $(this).addClass("clicked");
}); 
```

然后你可以用 $(".clicked") 选择器来做一些事情。

# jquery - jQuery - HOVER 一次应用于一个类

> ID：12030648
> 
> 赞同：0
> 
> 时间：2012-08-19T22:59:50.653
> 
> 标签：jquery, html

我在我的应用程序中添加了以下 HTML 到各种 DIV 中。这是一个叠加层，我只想在悬停的 DIV 上显示。但是，如果我将鼠标悬停在具有下面 HTML 代码块的任何元素上，因为覆盖将显示在所有 DIV 上。但我只希望覆盖显示在我悬停的 DIV 上，而不是全部显示。我试图找到 .parent()，但它不起作用。我究竟做错了什么？

```
<div id="appBillboard">
    <!-- edit window overlay -->
    <div class="editOverlay">
        <div class="editBTN">
            <div class="editIcon bL5"></div>
            <div class="editTxt bR5 bRLight">EDIT</div>
        </div>
    </div>
</div> 
```

JS：

```
//HOVER HIDE & SHOW EDIT OVERLAY AND BUTTON

var editBTN = $('.editBTN');
var overlay = $('.editOverlay');

$(editBTN).fadeTo(0, 0.90);

$(overlay).hover(function () {

    //find parent div
    var location = $(this).parent();

    $(overlay, location).fadeTo(0, 1);
    $(editBTN, location).fadeTo(0, 1);
    $(overlay, location).addClass('overlayBKGND');

}, function () {
    $(overlay).removeClass('overlayBKGND');
    $(editBTN).fadeTo(0, 0.90);

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:05:24.450

您需要使用范围仅限于您所在的层次结构的选择器。因此，您不能使用缓存的 jQuery 对象，因为它们包含所有对象。

此外，您必须重新计算传递给 .hover() 的两个函数中的每一个中的位置变量，因为它们是单独的函数并且不共享局部变量。

我也不知道你为什么在动画期间使用`fadeTo()`a `0`。最好只使用`.css("opacity", value)`而不是遍历整个动画代码。

将您的代码更改为：

```
$(overlay).hover(function () {
    //find parent div
    var location = $(this).parent().parent();
    $('.editOverlay', location).fadeTo(0, 1).addClass('overlayBKGND');
    $('.editBTN', location).fadeTo(0, 1);

}, function () {
    var location = $(this).parent().parent();
    $('.editOverlay', location).removeClass('overlayBKGND');
    $('.editBTN', location).fadeTo(0, 0.90);

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:07:31.103

这行代码匹配 'overlay' div 的父级：

```
var location = $(this).parent().parent(); 
```

根据您粘贴的 html 代码，我认为您只想获取父 div，因此：

```
var location = $(this).parent(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:08:42.280

而不是使用`parent()`方法和`$(selector, context)`用于选择当前悬停的元素，为什么不使用`this`？尝试以下操作：

```
$('.editBTN').fadeTo(0, 0.90);

$('.editOverlay').hover(function () {
    $(this).fadeTo(0, 1).addClass('overlayBKGND');
    $('.editBTN', this).fadeTo(0, 1);
}, function () {
    $(this).removeClass('overlayBKGND');
    $('.editBTN', this).fadeTo(0, 0.90);
}); 
```

# c++11 - std::weak_ptr 什么时候有用？

> ID：12030650
> 
> 赞同：315
> 
> 时间：2012-08-19T23:00:05.107
> 
> 标签：c++11, shared-ptr, weak-ptr, c++-faq

我开始研究 C++11 的智能指针，但我没有看到`std::weak_ptr`. 有人可以告诉我什么时候`std::weak_ptr`有用/必要吗？

* * *

## 回答 #1

> 赞同：337
> 
> 时间：2014-02-19T10:03:01.263

`std::weak_ptr`[是解决悬空指针](https://en.wikipedia.org/wiki/Dangling_pointer)问题的一个很好的方法。通过仅使用原始指针，不可能知道引用的数据是否已被释放。相反，通过让 a`std::shared_ptr`管理数据并将数据提供给用户，用户可以通过调用或`std::weak_ptr`来检查数据的有效性。`expired()``lock()`

您不能`std::shared_ptr`单独执行此操作，因为所有`std::shared_ptr`实例都共享在删除所有实例之前未删除的数据的所有权`std::shared_ptr`。以下是如何使用以下方法检查悬空指针的示例`lock()`：

```
#include <iostream>
#include <memory>

int main()
{
    // OLD, problem with dangling pointer
    // PROBLEM: ref will point to undefined data!

    int* ptr = new int(10);
    int* ref = ptr;
    delete ptr;

    // NEW
    // SOLUTION: check expired() or lock() to determine if pointer is valid

    // empty definition
    std::shared_ptr<int> sptr;

    // takes ownership of pointer
    sptr.reset(new int);
    *sptr = 10;

    // get pointer to data without taking ownership
    std::weak_ptr<int> weak1 = sptr;

    // deletes managed object, acquires new pointer
    sptr.reset(new int);
    *sptr = 5;

    // get pointer to new data without taking ownership
    std::weak_ptr<int> weak2 = sptr;

    // weak1 is expired!
    if(auto tmp = weak1.lock())
        std::cout << *tmp << '\n';
    else
        std::cout << "weak1 is expired\n";

    // weak2 points to new data (5)
    if(auto tmp = weak2.lock())
        std::cout << *tmp << '\n';
    else
        std::cout << "weak2 is expired\n";
} 
```

输出

```
weak1 is expired
5 
```

* * *

## 回答 #2

> 赞同：265
> 
> 时间：2012-08-19T23:06:28.020

一个很好的例子是缓存。

对于最近访问的对象，您希望将它们保存在内存中，因此您持有指向它们的强指针。您会定期扫描缓存并确定哪些对象最近未被访问。您不需要将它们保存在内存中，因此您摆脱了强指针。

但是，如果该对象正在使用中并且其他一些代码拥有指向它的强指针怎么办？如果缓存摆脱了它唯一指向对象的指针，它就再也找不到它了。因此，缓存会保留一个指向对象的弱指针，如果它们碰巧留在内存中，则需要查找这些对象。

这正是弱指针所做的——它允许您在对象仍然存在时定位它，但如果没有其他需要它，则不会保留它。

* * *

## 回答 #3

> 赞同：163
> 
> 时间：2013-07-03T10:46:56.117

另一个答案，希望更简单。（对于谷歌同事）

假设你有`Team`和`Member`对象。

显然这是一种关系：`Team`对象将具有指向其`Members`. 并且成员可能还会有一个指向其`Team`对象的反向指针。

然后你有一个依赖循环。如果你使用`shared_ptr`，当你放弃对它们的引用时，对象将不再被自动释放，因为它们以循环的方式相互引用。这是内存泄漏。

您可以使用`weak_ptr`. “所有者”通常使用`shared_ptr`和“拥有”使用 a`weak_ptr`到其父级，并在需要访问其父级时将其*临时*转换为。`shared_ptr`

存储一个弱 ptr ：

```
weak_ptr<Parent> parentWeakPtr_ = parentSharedPtr; // automatic conversion to weak from shared 
```

然后在需要时使用它

```
shared_ptr<Parent> tempParentSharedPtr = parentWeakPtr_.lock(); // on the stack, from the weak ptr
if( !tempParentSharedPtr ) {
  // yes, it may fail if the parent was freed since we stored weak_ptr
} else {
  // do stuff
}
// tempParentSharedPtr is released when it goes out of scope 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-08-19T23:07:41.513

这是@jleahy 给我的一个例子：假设你有一组任务，异步执行，并由`std::shared_ptr<Task>`. 您可能希望定期对这些任务执行某些操作，因此计时器事件可能会遍历 a`std::vector<std::weak_ptr<Task>>`并给任务一些可做的事情。然而，同时一个任务可能同时决定不再需要它并终止。因此，计时器可以通过从弱指针创建共享指针并使用该共享指针来检查任务是否仍然存在，前提是它不为空。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2015-12-16T02:12:22.370

当您不能保证在调用异步处理程序时目标对象仍然存在时，它们对 Boost.Asio 很有用。诀窍是使用或 lambda 捕获将 a 绑定`weak_ptr`到异步处理程序对象中。`std::bind`

```
void MyClass::startTimer()
{
    std::weak_ptr<MyClass> weak = shared_from_this();
    timer_.async_wait( [weak](const boost::system::error_code& ec)
    {
        auto self = weak.lock();
        if (self)
        {
            self->handleTimeout();
        }
        else
        {
            std::cout << "Target object no longer exists!\n";
        }
    } );
} 
```

这是`self = shared_from_this()`Boost.Asio 示例中常见的惯用语的变体，其中挂起的异步处理程序**不会**延长目标对象的生命周期，但如果目标对象被删除，仍然是安全的。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2016-10-21T14:02:14.770

**shared_ptr**：保存真实对象。

**weak_ptr** ：用于`lock`连接到真正的所有者，否则返回 NULL `shared_ptr`。

[![弱点](../Images/ae455e2d3192d7f1561ab8ef69f1b968.png)](https://i.stack.imgur.com/iKXVO.png)

粗略地说，`weak_ptr`角色类似于*房屋中介*的角色。如果没有代理，要租到房子，我们可能不得不检查城市中的随机房屋。代理商确保我们只访问那些*仍然可以访问且可供*出租的房屋。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2014-06-05T12:55:53.660

`weak_ptr`检查对象的正确删除也很好——尤其是在单元测试中。典型的用例可能如下所示：

```
std::weak_ptr<X> weak_x{ shared_x };
shared_x.reset();
BOOST_CHECK(weak_x.lock());
... //do something that should remove all other copies of shared_x and hence destroy x
BOOST_CHECK(!weak_x.lock()); 
```

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2017-12-08T03:52:16.003

使用指针时，重要的是要了解可用的不同类型的指针以及何时使用每种指针有意义。指针有四种类型，分为以下两类：

*   原始指针：
    *   原始指针 [ ie `SomeClass* ptrToSomeClass = new SomeClass();`]
*   智能指针：
    *   唯一指针 [ ie
        `std::unique_ptr<SomeClass> uniquePtrToSomeClass ( new SomeClass() );`
        ]
    *   共享指针 [ ie
        `std::shared_ptr<SomeClass> sharedPtrToSomeClass ( new SomeClass() );`
        ]
    *   弱指针 [ ie
        `std::weak_ptr<SomeClass> weakPtrToSomeWeakOrSharedPtr ( weakOrSharedPtr );`
        ]

原始指针（有时称为“遗留指针”或“C 指针”）提供“基本”指针行为，并且是错误和内存泄漏的常见来源。原始指针无法提供跟踪资源所有权的方法，开发人员必须手动调用“删除”以确保他们不会造成内存泄漏。如果资源是共享的，这会变得很困难，因为很难知道是否有任何对象仍然指向该资源。由于这些原因，通常应避免使用原始指针，并且只在代码的性能关键部分使用有限的范围。

唯一指针是一个基本的智能指针，它“拥有”指向资源的底层原始指针，并负责在“拥有”唯一指针的对象超出范围时调用删除并释放分配的内存。“唯一”这个名称是指在给定时间点只有一个对象可以“拥有”唯一指针这一事实。所有权可以通过 move 命令转移到另一个对象，但永远不能复制或共享唯一指针。由于这些原因，在给定时间只有一个对象需要指针的情况下，唯一指针是原始指针的一个很好的替代方案，这使开发人员无需在拥有对象的生命周期结束时释放内存。

共享指针是另一种类型的智能指针，类似于唯一指针，但允许许多对象拥有共享指针的所有权。与唯一指针一样，共享指针负责在所有对象都指向资源后释放分配的内存。它通过一种称为引用计数的技术来实现这一点。每次新对象获得共享指针的所有权时，引用计数都会增加 1。同样，当对象超出范围或停止指向资源时，引用计数减一。当引用计数达到零时，分配的内存被释放。由于这些原因，共享指针是一种非常强大的智能指针，应该在多个对象需要指向同一个资源的任何时候使用。

最后，弱指针是另一种类型的智能指针，它不是直接指向资源，而是指向另一个指针（弱指针或共享指针）。弱指针不能直接访问对象，但可以判断对象是否仍然存在或是否已过期。弱指针可以临时转换为共享指针来访问指向的对象（前提是它仍然存在）。为了说明，请考虑以下示例：

*   您很忙并且有重叠的会议：会议 A 和会议 B
*   您决定参加会议 A，而您的同事参加会议 B
*   您告诉您的同事，如果会议 A 结束后会议 B 仍在进行，您将加入
*   可能会出现以下两种情况：
    *   会议 A 结束，会议 B 仍在进行，所以你加入
    *   会议 A 结束，会议 B 也结束，因此您无法加入

在示例中，您有一个指向会议 B 的弱指针。您不是会议 B 中的“所有者”，因此它可以在没有您的情况下结束，并且除非您检查，否则您不知道它是否结束。如果还没有结束，你可以加入并参与，否则，你不能。这与拥有指向会议 B 的共享指针不同，因为您将成为会议 A 和会议 B 的“所有者”（同时参与两者）。

该示例说明了弱指针是如何工作的，并且在对象需要成为外部*观察者*但不希望承担共享所有权的责任时很有用。这在两个对象需要相互指向（也称为循环引用）的情况下特别有用。使用共享指针，两个对象都不能被释放，因为它们仍然被另一个对象“强烈”指向。当其中一个指针是弱指针时，持有弱指针的对象仍然可以在需要时访问另一个对象，只要它仍然存在。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2018-10-27T21:23:14.403

除了其他已经提到的有效用例之外，`std::weak_ptr`在多线程环境中是一个很棒的工具，因为

*   它不拥有该对象，因此不能阻止在不同线程中删除
*   `std::shared_ptr`与 结合`std::weak_ptr`对悬空指针是安全的 -`std::unique_ptr`与与原始指针结合相反
*   `std::weak_ptr::lock()`是一个原子操作（另请参见[关于 weak_ptr 的线程安全](https://stackoverflow.com/q/20705304/2328447)）

考虑一项将目录的所有图像（~10.000）同时加载到内存中的任务（例如，作为缩略图缓存）。显然，最好的方法是处理和管理图像的控制线程和加载图像的多个工作线程。现在这是一项简单的任务。这是一个非常简化的实现（`join()`省略了 etc，在实际实现中必须以不同方式处理线程等）

```
// a simplified class to hold the thumbnail and data
struct ImageData {
  std::string path;
  std::unique_ptr<YourFavoriteImageLibData> image;
};

// a simplified reader fn
void read( std::vector<std::shared_ptr<ImageData>> imagesToLoad ) {
   for( auto& imageData : imagesToLoad )
     imageData->image = YourFavoriteImageLib::load( imageData->path );
}

// a simplified manager
class Manager {
   std::vector<std::shared_ptr<ImageData>> m_imageDatas;
   std::vector<std::unique_ptr<std::thread>> m_threads;
public:
   void load( const std::string& folderPath ) {
      std::vector<std::string> imagePaths = readFolder( folderPath );
      m_imageDatas = createImageDatas( imagePaths );
      const unsigned numThreads = std::thread::hardware_concurrency();
      std::vector<std::vector<std::shared_ptr<ImageData>>> splitDatas = 
        splitImageDatas( m_imageDatas, numThreads );
      for( auto& dataRangeToLoad : splitDatas )
        m_threads.push_back( std::make_unique<std::thread>(read, dataRangeToLoad) );
   }
}; 
```

但是，如果您想中断图像的加载，例如因为用户选择了不同的目录，它会变得更加复杂。或者即使你想摧毁经理。

`m_imageDatas`在更改字段之前，您需要线程通信并且必须停止所有加载程序线程。否则，加载器将继续加载，直到所有图像都完成 - 即使它们已经过时。在简化的示例中，这不会太难，但在真实环境中，事情可能要复杂得多。

这些线程可能是多个管理器使用的线程池的一部分，其中一些正在停止，有些则没有等。简单的参数`imagesToLoad`将是一个锁定队列，这些管理器将来自不同控制线程的图像请求推送到其中读者以任意顺序在另一端弹出请求。因此，沟通变得困难、缓慢且容易出错。在这种情况下避免任何额外通信的一种非常优雅的方法是`std::shared_ptr`与`std::weak_ptr`.

```
// a simplified reader fn
void read( std::vector<std::weak_ptr<ImageData>> imagesToLoad ) {
   for( auto& imageDataWeak : imagesToLoad ) {
     std::shared_ptr<ImageData> imageData = imageDataWeak.lock();
     if( !imageData )
        continue;
     imageData->image = YourFavoriteImageLib::load( imageData->path );
   }
}

// a simplified manager
class Manager {
   std::vector<std::shared_ptr<ImageData>> m_imageDatas;
   std::vector<std::unique_ptr<std::thread>> m_threads;
public:
   void load( const std::string& folderPath ) {
      std::vector<std::string> imagePaths = readFolder( folderPath );
      m_imageDatas = createImageDatas( imagePaths );
      const unsigned numThreads = std::thread::hardware_concurrency();
      std::vector<std::vector<std::weak_ptr<ImageData>>> splitDatas = 
        splitImageDatasToWeak( m_imageDatas, numThreads );
      for( auto& dataRangeToLoad : splitDatas )
        m_threads.push_back( std::make_unique<std::thread>(read, dataRangeToLoad) );
   }
}; 
```

这个实现几乎和第一个一样简单，不需要任何额外的线程通信，并且可以成为实际实现中线程池/队列的一部分。由于过期的图像被跳过，而未过期的图像被处理，线程在正常操作期间永远不必停止。您始终可以安全地更改路径或销毁您的管理器，因为阅读器 fn 会检查是否拥有指针未过期。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-10-28T00:04:27.213

我将`std::weak_ptr<T>`其视为 a 的句柄*：*`std::shared_ptr<T>`它允许我获取`std::shared_ptr<T>`它是否仍然存在，但它不会延长它的生命周期。当这种观点有用时，有几种情况：

```
// Some sort of image; very expensive to create.
std::shared_ptr< Texture > texture;

// A Widget should be able to quickly get a handle to a Texture. On the
// other hand, I don't want to keep Textures around just because a widget
// may need it.

struct Widget {
    std::weak_ptr< Texture > texture_handle;
    void render() {
        if (auto texture = texture_handle.get(); texture) {
            // do stuff with texture. Warning: `texture`
            // is now extending the lifetime because it
            // is a std::shared_ptr< Texture >.
        } else {
            // gracefully degrade; there's no texture.
        }
    }
}; 
```

另一个重要的场景是打破数据结构中的循环。

```
// Asking for trouble because a node owns the next node, and the next node owns
// the previous node: memory leak; no destructors automatically called.
struct Node {
    std::shared_ptr< Node > next;
    std::shared_ptr< Node > prev;
};

// Asking for trouble because a parent owns its children and children own their
// parents: memory leak; no destructors automatically called.
struct Node {
    std::shared_ptr< Node > parent;
    std::shared_ptr< Node > left_child;
    std::shared_ptr< Node > right_child;
};

// Better: break dependencies using a std::weak_ptr (but not best way to do it;
// see Herb Sutter's talk).
struct Node {
    std::shared_ptr< Node > next;
    std::weak_ptr< Node > prev;
};

// Better: break dependencies using a std::weak_ptr (but not best way to do it;
// see Herb Sutter's talk).
struct Node {
    std::weak_ptr< Node > parent;
    std::shared_ptr< Node > left_child;
    std::shared_ptr< Node > right_child;
}; 
```

[Herb Sutter 有一个精彩的演讲](https://www.youtube.com/watch?v=JfmTagWcqoE)，解释了语言功能的最佳使用（在这种情况下是智能指针），以确保*默认情况下的泄漏自由* （意思是：一切都通过构造点击到位；你几乎不能搞砸）。这是必须观看的。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-05-12T11:57:47.453

[http://en.cppreference.com/w/cpp/memory/weak_ptr](http://en.cppreference.com/w/cpp/memory/weak_ptr) std::weak_ptr 是一个智能指针，它持有对 std::shared_ptr 管理的对象的非拥有（“弱”）引用。必须将其转换为 std::shared_ptr 才能访问引用的对象。

std::weak_ptr 对临时所有权建模：当一个对象只有存在时才需要访问，并且它可能随时被其他人删除，std::weak_ptr 用于跟踪该对象，并将其转换为std： :shared_ptr 承担临时所有权。如果此时原始 std::shared_ptr 被销毁，则对象的生命周期会延长，直到临时 std::shared_ptr 也被销毁。

此外，std::weak_ptr 用于中断 std::shared_ptr 的循环引用。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-10-06T18:48:38.457

我看到很多有趣的答案来解释引用计数等，但我错过了一个简单的示例来演示如何使用`weak_ptr`. 在第一个示例中，我`shared_ptr`在循环引用的类中使用。当类超出范围时，它们不会被销毁。

```
#include<iostream>
#include<memory>
using namespace std;

class B;

class A
{
public:
    shared_ptr<B>bptr;
    A() {
        cout << "A created" << endl;
    }
    ~A() {
        cout << "A destroyed" << endl;
    }
};

class B
{
public:
    shared_ptr<A>aptr;
    B() {
        cout << "B created" << endl;
    }
    ~B() {
        cout << "B destroyed" << endl;
    }
};

int main()
{
    {
        shared_ptr<A> a = make_shared<A>();
        shared_ptr<B> b = make_shared<B>();
        a->bptr = b;
        b->aptr = a;
    }
  // put breakpoint here
} 
```

如果您运行代码片段，您将看到类已创建，但未销毁：

```
A created
B created 
```

现在我们`shared_ptr's`改为`weak_ptr`：

```
class B;
class A
{
public:
    weak_ptr<B>bptr;

    A() {
        cout << "A created" << endl;
    }
    ~A() {
        cout << "A destroyed" << endl;
    }
};

class B
{
public:
    weak_ptr<A>aptr;

    B() {
        cout << "B created" << endl;
    }
    ~B() {
        cout << "B destroyed" << endl;
    }
};

    int main()
    {
        {
            shared_ptr<A> a = make_shared<A>();
            shared_ptr<B> b = make_shared<B>();
            a->bptr = b;
            b->aptr = a;
        }
      // put breakpoint here
    } 
```

这一次，在使用时`weak_ptr`我们看到了正确的类销毁：

```
A created
B created
B destroyed
A destroyed 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-05-19T14:16:00.963

共享指针有个缺点：shared_pointer 不能处理父子循环依赖。表示如果父类使用共享指针使用子类的对象，如果子类使用父类的对象，则在同一个文件中。共享指针将无法销毁所有对象，即使共享指针在循环依赖场景中根本没有调用析构函数。基本上共享指针不支持引用计数机制。

我们可以使用weak_pointer 克服这个缺点。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-08-12T07:43:57.000

**当我们不想拥有该对象时：**

前任：

```
class A
{
    shared_ptr<int> sPtr1;
    weak_ptr<int> wPtr1;
} 
```

在上述类中，wPtr1 不拥有 wPtr1 指向的资源。如果资源被删除，则 wPtr1 已过期。

**为了避免循环依赖：**

```
shard_ptr<A> <----| shared_ptr<B> <------
    ^             |          ^          |
    |             |          |          |
    |             |          |          |
    |             |          |          |
    |             |          |          |
class A           |     class B         |
    |             |          |          |
    |             ------------          |
    |                                   |
    ------------------------------------- 
```

现在，如果我们创建类 B 和 A 的 shared_ptr，则两个指针的 use_count 为 2。

当 shared_ptr 超出 od 范围时，计数仍保持为 1，因此 A 和 B 对象不会被删除。

```
class B;

class A
{
    shared_ptr<B> sP1; // use weak_ptr instead to avoid CD

public:
    A() {  cout << "A()" << endl; }
    ~A() { cout << "~A()" << endl; }

    void setShared(shared_ptr<B>& p)
    {
        sP1 = p;
    }
};

class B
{
    shared_ptr<A> sP1;

public:
    B() {  cout << "B()" << endl; }
    ~B() { cout << "~B()" << endl; }

    void setShared(shared_ptr<A>& p)
    {
        sP1 = p;
    }
};

int main()
{
    shared_ptr<A> aPtr(new A);
    shared_ptr<B> bPtr(new B);

    aPtr->setShared(bPtr);
    bPtr->setShared(aPtr);

    return 0;  
} 
```

输出：

```
A()
B() 
```

正如我们从输出中看到的那样，A 和 B 指针永远不会被删除，因此内存泄漏。

为避免此类问题，只需在 A 类中使用 weak_ptr 而不是 shared_ptr 更有意义。

# java - Java Amazon S3 Post 表单

> ID：12030653
> 
> 赞同：1
> 
> 时间：2012-08-19T23:00:30.650
> 
> 标签：java, html, post, amazon-s3

我的 s3 邮寄表格有问题。我虽然读了[http://aws.amazon.com/articles/1434/](http://aws.amazon.com/articles/1434/)

我遵循了整个教程：

```
import sun.misc.BASE64Encoder;
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class Storage {
    public static String awsAccessKey = "xxxxxxxxxxxxxxx";
    public static String awsSecretKey = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";

    static String policy_document = "{\"expiration\": \"2013-01-01T00:00:00Z\","
            + "\"conditions\": ["
            + "{\"bucket\": \"kanta-assets\"},"
            + "[\"starts-with\", \"$key\", \"\"],"
            + "{\"acl\": \"public\"},"
            + "{\"success_action_redirect\": \"http://localhost/\"},"
            + "[\"starts-with\", \"$Content-Type\", \"\"],"
            + "[\"content-length-range\", 0, 1048576]" + "]" + "}";

    public static String getPolicy() throws UnsupportedEncodingException {
        return (new BASE64Encoder()).encode(policy_document.getBytes("UTF-8"))
                .replaceAll("\n", "").replaceAll("\r", "");
    }

    public static String getSignature() throws InvalidKeyException,
            IllegalStateException, NoSuchAlgorithmException,
            UnsupportedEncodingException {
        Mac hmac = Mac.getInstance("HmacSHA1");
        hmac.init(new SecretKeySpec(awsSecretKey.getBytes("UTF-8"), "HmacSHA1"));
        return (new BASE64Encoder()).encode(
                hmac.doFinal(getPolicy().getBytes("UTF-8"))).replaceAll("\n",
                "");

    }

} 
```

我的帖子表格看起来像这样

```
<form action="https://kanta-assets.s3.amazonaws.com/" method="post" enctype="multipart/form-data">
      <input type="hidden" name="key" value="uploads/${filename}">
      <input type="hidden" name="AWSAccessKeyId" value="@appconfig.Storage.awsAccessKey"> 
      <input type="hidden" name="acl" value="public"> 
      <input type="hidden" name="success_action_redirect" value="http://localhost/">
      <input type="hidden" name="policy" value="@appconfig.Storage.getPolicy()">
      <input type="hidden" name="signature" value="@appconfig.Storage.getSignature()">
      <input type="hidden" name="Content-Type" value="image/jpeg">
      <!-- Include any additional input fields here -->

      File to upload to S3: 
      <input name="file" type="file"> 
      <br> 
      <input type="submit" value="Upload File to S3"> 
    </form> 
```

如果我尝试上传 jpeg 图像，则会收到以下错误：

```
This XML file does not appear to have any style information associated with it. The document tree is shown below.
<Error>
<Code>InvalidArgument</Code>
<Message/>
<ArgumentValue>public</ArgumentValue>
<ArgumentName>x-amz-acl</ArgumentName>
<RequestId>6679060CE7C84FA5</RequestId>
<HostId>
wSIzNZvFDFT7WNnUtBq9UY5WSN1ltN9dHErNk6L3v4ciZCSzwUgzTf1PgaFAJTWD
</HostId>
</Error> 
```

我很确定我的错误是政策中的关键价值，`"[\"starts-with\", \"$key\", \"\"],"`我不确定这实际上意味着什么。

> 对象键名的规则使用前缀字符串“upload/”，这意味着键值必须始终以upload/ 子目录路径开头。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:10:49.860

尝试将密钥作为文件名。（删除上传/）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-04T08:32:49.010

POST / HTTP/1.1 主机：destinationBucket.s3.amazonaws.com 用户代理：browser_data 接受：file_types 接受语言：区域接受编码：编码接受字符集：字符集保持活动：300 连接：保持活动内容类型：多部分/表单数据；边界=9431149156168 内容长度：长度

--9431149156168 内容处置：表单数据；名称=“键”

acl --9431149156168 内容处置：表单数据；名称="success_action_redirect"

success_redirect --9431149156168 内容处置：表单数据；名称="内容类型"

content_type --9431149156168 内容处置：表单数据；名称="x-amz-meta-uuid"

uuid --9431149156168 内容处置：表单数据；名称="x-amz-元标签"

元数据 --9431149156168 内容处置：表单数据；名称="AWSAccessKeyId"

access-key-id --9431149156168 内容配置：表单数据；名称="政策"

编码策略 --9431149156168 内容处置：表单数据；名称="签名"

签名= --9431149156168 内容处置：表单数据；名称=“文件”；filename="MyFilename.jpg" 内容类型：image/jpeg

file_content --9431149156168 内容处置：表单数据；名称="提交"

上传到 Amazon S3 --9431149156168--

如何在java中创建发布请求？

# css - css：绝对位置不利于右值和底部值？

> ID：12030654
> 
> 赞同：0
> 
> 时间：2012-08-19T23:00:37.747
> 
> 标签：css, position, positioning, css-position, absolutelayout

我想绝对定位一个 iframe 并定义它的左、上、右、下偏移：

```
#x {
    position: fixed;
    left: 10px;
    top: 10px;
    right: 10px;
    bottom: 10px;
    width: auto;
    height: auto;
    border: 2px solid #aaa;
    z-index: 100002;
    background: #abc;
    display:none
}​ 
```

我发现左侧和顶部值受到尊重，而右侧和底部值被忽略。当我没有设置左侧和顶部值时，正确处理右侧和底部值。检查这个小提琴：http: [//jsfiddle.net/7fTEF/](http://jsfiddle.net/7fTEF/)

任何想法？

**注意**我不想设置元素的宽度和高度，因为我希望它相对于视口，我也不想将宽度和高度设置为百分比，我只想保持边框偏移为固定值，在这里说“10px”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:21:31.293

不知道为什么，但是，在玩了一会儿之后，IFrame 似乎出于某种原因不喜欢这种定位方式。

我可以提出的一种解决方案是将它包含在一个 div 中，并将 div 设置为您想要的大小/位置。

[http://jsfiddle.net/7fTEF/1/](http://jsfiddle.net/7fTEF/1/)

此外，尽管为 500x500px，主体背景颜色将继续填满页面中的所有空间，但 div 的大小仍然正确。（调整身体大小以检查它......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:20:28.623

您可以通过 javascript 找到容器大小，然后设置 iframe 大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T23:22:50.443

~~您不能同时设置 left 和 right 或 top 和 bottom 属性。~~ **编辑**：事实证明，您实际上可以定位绝对，正如我刚刚从这篇文章中了解到的那样：[http](http://www.alistapart.com/articles/conflictingabsolutepositions) ://www.alistapart.com/articles/conflictingabsolutepositions （所有提示都归功于@thirdender！）。不过，iframe 的行为似乎有所不同。

你可以像这样实现你所追求的：http: [//jsfiddle.net/7fTEF/2/](http://jsfiddle.net/7fTEF/2/)

请注意，不需要绝对定位。我还使用了 css3 属性 box-sizing。您将必须添加浏览器特定的前缀，如此处所述[http://www.w3schools.com/cssref/css3_pr_box-sizing.asp](http://www.w3schools.com/cssref/css3_pr_box-sizing.asp)

请注意，此解决方案不适用于旧浏览器，您最终会看到滚动条。如果你想让它完全兼容浏览器，我认为你将不得不求助于一些 js，但是你会遇到禁用此功能的人的问题。你也可以尝试两者的结合。这完全取决于您的观众以及您如何找到它......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-19T23:50:54.033

我在这里找到了这个页面[http://www.alistapart.com/articles/conflictingabsolutepositions/](http://www.alistapart.com/articles/conflictingabsolutepositions/)解释了一些解决方案，这些解决方案也与仅使用 CSS 的旧 IE 浏览器兼容。否则可能需要一些 JavaScript 计算。

# android - 像月球着陆器或忍者跳跃游戏一样滚动背景 - Android

> ID：12030655
> 
> 赞同：0
> 
> 时间：2012-08-19T23:00:55.580
> 
> 标签：android, game-physics, 2d-games

我正在使用 Canvas/Sur​​faceview 开发 2d 游戏，但在滚动背景图像时遇到问题。

查看游戏 - [http://youtu.be/4Gi5rRqzZ3M](http://youtu.be/4Gi5rRqzZ3M)

在 NinJump 游戏中，角色 Ninja 只是在 X 坐标中跳跃，背景图像以非常高的速度滚动，使 Ninja 看起来像是在运行。

我已经创建了基本设置，创建了忍者，添加了跳转功能，添加了背景。**现在我想一遍又一遍地重复相同的背景。我怎样才能做到这一点？**

以下是我的源文件 - 主要活动类

```
 package com.abc.apps;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.Window;
import android.view.WindowManager;

public class LadderActivity extends Activity {

    private static final String TAG = LadderActivity.class.getSimpleName();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // requesting to turn the title OFF
        requestWindowFeature(Window.FEATURE_NO_TITLE);

        // making it full screen
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);

        // set our MainGamePanel as the View
        setContentView(new MainGameBoard(this));
        Log.d(TAG, "View added"); 
    }

 @Override
 protected void onDestroy() {
     Log.d(TAG, "Destroying...");
     super.onDestroy();
 }

 @Override
 protected void onStop() {
     Log.d(TAG, "Stopping...");
     super.onStop();
 }
} 
```

**游戏板扩展 SurfaceView**

```
 package com.abc.apps;

import android.app.Activity;
import android.content.Context;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.util.Log;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class MainGameBoard extends SurfaceView implements SurfaceHolder.Callback{

    private MainGameLoop thread;
    private Monkey monkey;
    private static final String TAG = MainGameLoop.class.getSimpleName();

    int currentX, currentY;

    public MainGameBoard(Context context) {
        super(context);
        // TODO Auto-generated constructor stub

        // adding the callback (this) to the surface holder to intercept events
        //This line sets the current class (MainGamePanel) as the handler for the events happening on the actual surface
        getHolder().addCallback(this);

        // create monkey and load bitmap INITIALIZE AT LEFT
        monkey = new Monkey(BitmapFactory.decodeResource(getResources(), R.drawable.actor),60, 340); 

        // create the game loop thread
        thread = new MainGameLoop(getHolder(), this);

        // make the GamePanel focusable so it can handle events.
        setFocusable(true);
    }

    public void surfaceChanged(SurfaceHolder holder, int format, int width,
            int height) {
        // TODO Auto-generated method stub

    }

    public void surfaceCreated(SurfaceHolder holder) {
        // TODO Auto-generated method stub

        thread.setRunning(true);
        thread.start();

    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub
        // tell the thread to shut down and wait for it to finish
        // this is a clean shutdown
        boolean retry = true;
        while (retry) {
            try {
                thread.join();
                retry = false;
               } 
            catch (InterruptedException e) {
                // try again shutting down the thread
               }
              }

    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
         if (event.getAction() == MotionEvent.ACTION_DOWN) {
             //For jumping Left
             if (event.getX() < (getWidth()/2 - 32)) {
                // Log.d(TAG, "Coords: x=" + event.getX() + ",y=" + event.getY());
                 //Log.d(TAG, "Jump Left");
                // Sleep so that the main thread doesn't get flooded with UI events.
                 try {
                     Thread.sleep(32);
                     monkey.setX((getWidth()/2 - 60));
                     monkey.setY(monkey.getY()-70);

                 } catch (InterruptedException e) {
                     // No big deal if this sleep is interrupted.
                 }

             }

             //For Jumping Right
             if (event.getX() > (getWidth()/2 + 32)) {
                 //Log.d(TAG, "Coords: x=" + event.getX() + ",y=" + event.getY());
                 //Log.d(TAG, "Jump Right");
                // Sleep so that the main thread doesn't get flooded with UI events.
                 try {
                     Thread.sleep(32);

                     monkey.setX((getWidth()/2 + 60));
                     monkey.setY(monkey.getY()-70); 

                 } catch (InterruptedException e) {
                     // No big deal if this sleep is interrupted.
                 }

             }

/*           //Middle Portion
             if (event.getX() > (getWidth()/2 - 32) && event.getX() < (getWidth()/2 +32)) {
                 //thread.setRunning(false);
                 //((Activity)getContext()).finish();
             }*/

         }
         return true;
        }

    public void render(Canvas canvas) {
        canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.monkey_sc), 0, 0,null);
        monkey.draw(canvas);
    }

/*  @Override
    protected void onDraw(Canvas canvas){
        canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.monkey_scene), 0, 0,null);
        monkey.draw(canvas);
    }*/

} 
```

**主游戏循环**

```
package com.abc.apps;

import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.util.Log;
import android.view.SurfaceHolder;

public class MainGameLoop extends Thread {

    private SurfaceHolder surfaceHolder;
    private MainGameBoard gameBoard;
    private Monkey monkey;

    private static final String TAG = MainGameLoop.class.getSimpleName();

    // flag to hold game state
    private boolean running = true;

    public void setRunning(boolean running) {
        this.running = running;
        }

    @Override
    public void run() {
        Canvas canvas;
         Log.d(TAG, "Starting game loop");
          while (running) {

              canvas = null;    
              // try locking the canvas for exclusive pixel editing on the surface
              try {
                  canvas = surfaceHolder.lockCanvas();
                  synchronized (surfaceHolder) {
                        // update game state 
                        // render state to the screen
                        // draws the canvas on the panel
                        gameBoard.render(canvas);   
                    }
              } 
              finally {
                  // in case of an exception the surface is not left in
                  // an inconsistent state
                  if (canvas != null) {
                      surfaceHolder.unlockCanvasAndPost(canvas);
                    }
                } // end finally
            }
        } 

    public MainGameLoop(SurfaceHolder surfaceHolder, MainGameBoard gameBoard) {
     super();
     this.surfaceHolder = surfaceHolder;
     this.gameBoard = gameBoard;
    }

}//MainThread 
```

**猴子班**

```
package com.abc.apps;

import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.view.MotionEvent;

public class Monkey {

 private Bitmap bitmap; // the actual bitmap
 private int x;   // the X coordinate
 private int y;   // the Y coordinate
 private boolean touched; // if monkey is touched

 public Monkey(Bitmap bitmap, int x, int y) {
  this.bitmap = bitmap;
  this.x = x;
  this.y = y;

 }

 public Bitmap getBitmap() {
  return bitmap;
 } 
 public void setBitmap(Bitmap bitmap) {
  this.bitmap = bitmap;
 }
 public int getX() {
  return x;
 }
 public void setX(int x) {
  this.x = x;
 }
 public int getY() {
  return y;
 }
 public void setY(int y) {
  this.y = y;
 }

 public boolean isTouched() {
  return touched;
 }

 public void setTouched(boolean touched) {
  this.touched = touched;
 }

 public void draw(Canvas canvas) {
     Paint paint = new Paint();
     paint.setAntiAlias(true);
     paint.setFilterBitmap(true);
     paint.setDither(true);

  canvas.drawBitmap(bitmap, x - (bitmap.getWidth() / 2), y, paint);
 }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:26:27.570

看起来您正在渲染方法中的 MainGameBoard 类中绘制背景。

```
public void render(Canvas canvas) {

canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.monkey_sc), 0, 0,null);

monkey.draw(canvas);
} 
```

您应该只需要 2 个 drawBitmap 调用而不是 1 个。

```
canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.monkey_sc), 0, y_offset1,null);
canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.monkey_sc), 0, y_offset2,null); 
```

我假设每个背景图像的高度相同或大于屏幕高度；如果它小于屏幕高度，则需要 2 个以上的实例。

然后在 y_offset1 = 0 处开始 1 个图像，在 y_offset2 = -image_height 处开始另一个图像。

每次抽奖您都会将 y_offset1 和 y_offset2 增加相同的数量。然后，您需要检查两个偏移量，看看是否有一个大于屏幕高度的量。如果是这样，那么现在“屏幕下方”的 y_offset 应该重置为另一个 y_offset 减去 image_height。这将创建一个无限循环的滚动图像。

使用这种技术时，考虑图像边缘很重要；图像的设计应使其无缝平铺，否则在循环点沿边缘会出现明显的视觉伪影。

# c - 获取被调用函数C的行号

> ID：12030658
> 
> 赞同：0
> 
> 时间：2012-08-19T23:01:37.437
> 
> 标签：c, line-numbers

有没有一种方法可以在不执行以下任何操作的情况下获取在 C 中调用函数的行号？一段时间后，定义可能会变得乏味，不得不像往常一样使用 DP 而不是 { ，并且难以阅读；但是将**LINE**作为第一个参数添加到每个函数只是我不愿意做的事情。

```
 #include <stdio.h>
    #include <stdlib.h>
    #include <stdarg.h>
    #define println(x,...) printf(x,##__VA_ARGS__);printf("\n");
    /*
     *I would like to be able to replace __LINE__ with the line
     *each function was called on, or replace my DP define completely...
    */
    #ifdef _DEBUG_
        #define DP { println("%s:%d\t%s()",__FILE__,__LINE__,__FUNCTION__);
    #else
        #define DP {
    #endif
    void calledFunc()
    DP
        println("something something something");
    }
    void cFunc(int line)
    {
        println("%s:%d\t%s()",__FILE__,line,__FUNCTION__);
    }
    int main()
    DP
        calledFunc();
        /* ...and I don't want to have to do this all the time either*/
        cFunc(__LINE__);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:54:33.753

打印行文件名/编号有一个很好的替代品。它称为“LocationID”或 LID。

LID 是从项目范围的计数器中生成的数字。计数器的最新值应存储在源文件中，并像任何其他源文件一样签入/签出源代码控制系统。计数器的值可以加扰。这迫使其正确使用。你像这样使用它：

```
 #ifdef _DEBUG_
        #define DP(x, msg) println("%d: %s", x, msg);
   #endif 
```

并在您的来源中：

```
DP (3517, "Here we are.") 
```

LID 的优点是：

1.  它们对源文件的修改是稳定的，包括文件/函数的重命名。
2.  它们很容易在来源中找到。
3.  日志文件比文件名和函数名更简洁明了。

我用了几次，结果证明很好。在开发人员之间生成和分发 LID 值是一项开销，但结果是这项工作所付出的代价的 10 倍。

# java - Java int[] 数组到 HashSet

> ID：12030661
> 
> 赞同：48
> 
> 时间：2012-08-19T23:03:02.240
> 
> 标签：java, generics, collections

我有一个int数组：

```
int[] a = {1, 2, 3}; 
```

我需要一个类型的集合：

```
Set<Integer> s; 
```

如果我执行以下操作：

```
s = new HashSet(Arrays.asList(a)); 
```

它当然认为我的意思是：

```
List<int[]> 
```

而我的意思是：

```
List<Integer> 
```

这是因为 int 是一个原语。如果我使用过 String，一切都会奏效：

```
Set<String> s = new HashSet<String>(
    Arrays.asList(new String[] { "1", "2", "3" })); 
```

## 如何轻松、正确、简洁地从：

```
A) int[] a... 
```

至

```
B) Integer[] a ... 
```

谢谢！

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2020-04-25T17:30:41.653

使用流：

```
// int[] nums = {1,2,3,4,5}
Set<Integer> set = Arrays.stream(nums).boxed().collect(Collectors.toSet()) 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-03-20T03:15:18.793

该问题提出了两个单独的问题：从. 转换`int[]`为`Integer[]`和创建 a 。两者都可以通过 Java 8 流轻松实现：`HashSet<Integer>``int[]`

```
int[] array = ...
Integer[] boxedArray = IntStream.of(array).boxed().toArray(Integer[]::new);
Set<Integer> set = IntStream.of(array).boxed().collect(Collectors.toSet());
//or if you need a HashSet specifically
HashSet<Integer> hashset = IntStream.of(array).boxed()
    .collect(Collectors.toCollection(HashSet::new)); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-08-20T03:28:42.770

Some further explanation. The asList method has this signature

```
public static <T> List<T> asList(T... a) 
```

So if you do this:

```
List<Integer> list = Arrays.asList(1, 2, 3, 4) 
```

or this:

```
List<Integer> list = Arrays.asList(new Integer[] { 1, 2, 3, 4 }) 
```

In these cases, I believe java is able to infer that you want a List back, so it fills in the type parameter, which means it expects Integer parameters to the method call. Since it's able to autobox the values from int to Integer, it's fine.

However, this will not work

```
List<Integer> list = Arrays.asList(new int[] { 1, 2, 3, 4} ) 
```

because primitive to wrapper coercion (ie. int[] to Integer[]) is not built into the language (not sure why they didn't do this, but they didn't).

As a result, each primitive type would have to be handled as it's own overloaded method, which is what the commons package does. ie.

```
public static List<Integer> asList(int i...); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-19T23:34:48.053

或者您可以轻松使用[Guava](http://guava-libraries.googlecode.com)转换`int[]`为`List<Integer>`：

[`Ints.asList(int...)`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/primitives/Ints.html#asList%28int...%29)

> ## **作为列表**
> 
> `public static List<Integer> asList(int... backingArray)`
> 
> 返回由指定数组支持的固定大小列表，类似于`Arrays.asList(Object[])`. 该列表支持`List.set(int, Object)`，但任何设置值的尝试`null`都会导致`NullPointerException`.
> 
> `Integer`返回的列表维护写入或读取的对象的值，但不维护标识。例如，`list.get(0) == list.get(0)`未指定返回列表是否为真。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-19T23:11:48.060

[您可以在Apache Commons](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/ArrayUtils.html)中使用 ArrayUtils ：

```
int[] intArray  = { 1, 2, 3 };
Integer[] integerArray = ArrayUtils.toObject(intArray); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-28T07:37:26.597

另一种选择是使用来自[Eclipse Collections](http://www.eclipse.org/collections/)的原始集。您可以轻松地将 a 转换`int[]`为`MutableIntSet`a`Set<Integer>`或`Integer[]`如下所示，或者您可以按`MutableIntSet`原样使用它，这将提高内存效率和性能。

```
int[] a = {1, 2, 3};
MutableIntSet intSet = IntSets.mutable.with(a);
Set<Integer> integerSet = intSet.collect(i -> i);  // auto-boxing
Integer[] integerArray = integerSet.toArray(new Integer[]{}); 
```

如果您想直接从 int 数组转到 Integer 数组并保留顺序，那么这将起作用。

```
Integer[] integers = 
        IntLists.mutable.with(a).collect(i -> i).toArray(new Integer[]{}); 
```

注意：我是 Eclipse Collections 的提交者

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-17T13:33:11.010

只需使用以下代码段将数组中的元素添加到 Set

```
public class RemoveDuplicateElements {

    public static void main(String args[]){
        int array[] =  {0,1,2,3,4,5,6,7,8,9,1,2,3,4,5};
        Set <Integer> abc = new HashSet <Integer>();
        for (Integer t:array){  
            abc.add(t); 
        }       
        System.out.println("sampleSet"+abc);  
    }

} 
```

# assembly - 为什么我们可以在 16 位模式下使用 eRx，而在 32 位模式下不能使用 rRx？

> ID：12030668
> 
> 赞同：2
> 
> 时间：2012-08-19T23:04:08.163
> 
> 标签：assembly, x86, x86-64, cpu-registers

在 x86 汇编中，为什么我们可以`eRx`在 16 位“实模式”下使用，但不能`rRx`在 32 位模式下使用？例如：

```
BITS 16
mov bx, 1
mov eax, 2 
```

将正确组装和拆卸。它可以工作，因为我之前已经反汇编了 Win2k 引导加载程序并找到了对`eax`.

但是，为什么没有办法，即使在 64 位处理器上，在 32 位“保护模式”下，您也无法访问`rRx`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T09:23:39.533

原因是 64 位模式在一个特定位置*更改*指令解码 - 即启用用于指示 64 位操作数大小/将寄存器宽度扩展到 64 位/将寄存器使用扩展到“新” `R8`..`R15`寄存器的前缀字节。这些不同于“备用大小前缀” `0x66`（ 32位模式。

所谓的`REX`前缀被编码为`0x40`.. `0x4f`，并且*只有*在CPU运行在64位模式下作为前缀才有效。为什么呢 ？好吧 - 如前所述，更改了指令解码，这些操作码实际上映射到经典 x86中`inc <reg>`/的单字节版本。 这是可能的，因为 16/32 位指令集中存在歧义 -可以*是**或*。在 64 位模式下，指令解码器只接受这个。另一方面，如前所述，成为前缀之一。`dec <reg>`
`inc EAX` *`0x40` *`0xff 0xc0``0xff 0xc0``0x40``REX`**

 **因此 - 这些 64 位操作数大小前缀在 16 位/32 位模式下*不存在*（它们是`inc`/`dec`操作然后......），因此 16 位/32 位 x86 代码无法声明“我想做一个 64 位操作” .

例如，以下是一些具有不同操作数大小的指令的汇编/操作码：

```
      64bit 32bit option 1 32bit option 2 指令
==================================================== ===========
      fe c8 fe c8 -- dec al
   66 ff c8 66 ff c8 66 48 十进制斧头
      ff c8 ff c8 48 dec eax
   48 ff c8 -- -- 德莱克斯
```

如您所见，64 位不知道 . 的单字节版本`dec eax`，但它知道`0x48`（几个）指令前缀之一，表示“使其成为 64 位操作”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T07:59:47.310

通过设计，CPU 设计，您无法在非 64 位模式下访问 64 位寄存器。

您也可以通过设计以 16 位模式访问 32 位寄存器。为此，您可以使用称为*操作数大小前缀*( `0x66`) 和*地址大小前缀*( `0x67`) 的特殊指令前缀。

在非 64 位模式下，没有特殊的指令前缀可以到达 64 位寄存器。

在 32 位模式下没有足够的操作码/前缀编码空间来添加它，不像 386 扩展 286 时有一些未使用的字节作为前缀。

`0x4?`在 64 位模式下指定 64 位操作数大小所需的REX 前缀是32 位和 16 位模式下的`inc`/指令。`dec`AMD64 不得不改变一些字节的含义来为他们想要的前缀腾出空间。对 32 位模式的相同更改将与现有二进制文件不兼容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T01:18:21.963

好吧，如果您使用的是 80286，那么它将无法正常工作！您使用的计算机是 32 位 CPU，它同时具有 16 位和 32 位寄存器，但没有 64 位寄存器。它也适用于 64 位 cpu。**

# node.js - 尝试使用 Mocha 测试 Node.js 服务器进程

> ID：12030670
> 
> 赞同：13
> 
> 时间：2012-08-19T23:04:42.327
> 
> 标签：node.js, automated-tests, mocha.js

Node.js 相当新

制作了一个运行服务器进程并提供文件的应用程序（不使用 express 或任何框架），现在我正在尝试对其进行单元测试。

我正在尝试为此使用 mocha 测试...我打算启动我的服务器进程，然后针对它运行请求以测试预期结果（统计代码、正文内容等）

但是它不能正常工作，所有请求都无法连接到服务器......我很确定问题是因为节点正在运行一个进程循环，当查询运行时服务器没有“在后台”运行或者可能在发出请求时服务器尚未运行（启动 ASYNC）？

无论如何，我想知道测试这个的正确方法是什么，我假设我需要让服务器在后台运行（如分叉进程）和/或我可能需要找到一种方法来等待服务器进程先“起来”，但不确定如何。

或者至少建议测试此类服务器进程（使用 Mocha 或其他）。

谢谢。

这是示例测试代码（自原始问题以来已更新）

```
var server = new Server302('./fixture/');

var instance;

describe('Tests', function() {

before(function(done) {
     instance = http.createServer(function(request, response) {
        console.log(request.url);
        server.serve(request, response);
    }).listen(8000);
    instance.on("listening", function() {
        console.log("started");
        done();
    });
});

after(function(done){
  instance.close();
  console.log("stopped");
  done();
});

it("Should fetch test.html", function(done) {
    console.log("test1");
    http.get("http://localhost:8000/", function(res) {
        res.on('data', function(body) {
            console.log(body)
            expect(body).toEqual("test");
            done();
        });
    })
}); 
```

它似乎按顺序执行，但仍然因连接错误而失败，而在使用浏览器手动测试时它可以工作：

```
started
test1
․․․stopped

  ✖ 1 of 1 tests failed:

  1) Tests Should fetch test.html:
  Error: connect ECONNREFUSED
  at errnoException (net.js:670:11)
  at Object.afterConnect [as oncomplete] (net.js:661:19) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T01:15:17.523

在您收到服务器触发的“侦听”事件之前，`before`不要打电话。`done`

```
before(function(done) {
    instance = http.createServer(function(request, response) {
        console.log(request.url);
        server.serve(request, response);
    }).listen(8000);
    instance.on("listening", function() {
        console.log("started");
        done();
    });
}); 
```

这应该确保您的测试连接在服务器准备好之前不会启动。

另请参阅[server.listen 的文档](http://nodejs.org/api/net.html#net_server_listen_port_host_backlog_listeninglistener)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T04:48:04.073

还必须处理成块出现的身体，这是最后的工作，以防对其他人有帮助：

```
var Server302 = require('../lib/server302.js'),
http = require('http'),
assert = require("assert");

var server = new Server302('./fixture/');

var instance;

describe('Tests', function() {

before(function(done) {
    instance = http.createServer(function(request, response) {
        server.serve(request, response);
    }).listen(8100);
    instance.on("listening", function() {
        done();
    });
});

after(function(done) {
    instance.close();
    done();
});

it("Should fetch test.html", function(done) {
    console.log("test1");
    var body = "";
    http.get({host: "localhost", port:8100, path: "/"}, function(res) {
        res.on('data', function(chunk) {
            // Note: it might be chunked, so need to read the whole thing.
            body += chunk;
        });
        res.on('end', function() {
            assert.ok(body.toString().indexOf("<a href='/dummy.txt'>") !== -1);
            assert.equal(res.statusCode, 200);
            done();
        });
    })
});

it("Should fetch dummy.txt", function(done) {
    http.get({host: "localhost", port:8100, path: "/dummy.txt"}, function(res) {
        res.on('data', function(body) {
            assert.equal(res.statusCode, 200);
            assert.ok(body.toString().indexOf("test") === 0);
            done();
        });
    });
});

it("Should get 404", function(done) {
    http.get({host: "localhost", port:8100, path: "/qwerty"}, function(res) {
        assert.equal(res.statusCode, 404);
        done();
    });
});

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-30T13:11:40.397

## 使用超测

这是一个使用[SuperTest](https://www.npmjs.com/package/supertest)和[Mocha的](http://mochajs.org/)**完整而直接的示例**：

```
var server = new Server302('./fixture/');
var request = require('supertest');

describe('Tests', function() {
  it('Should fetch test.html', function(done) {
    request(server)
      .get('/')
      .expect('test', done);
  });
}); 
```

SuperTest 允许您：

*   [使用SuperAgent](https://www.npmjs.com/package/superagent)请求您的服务器（比低级[http 代理](https://nodejs.org/api/http.html#http_class_http_agent)更容易使用）。
*   将您的服务器绑定到一个临时端口，因此无需跟踪端口（如果需要，您仍然可以手动进行）。
*   使用适用于[Mocha](http://mochajs.org/)（或任何其他测试框架）[的含糖期望方法。](https://github.com/visionmedia/supertest#api)

# javascript - 如何将文本从 DIV 数组添加到 DIV

> ID：12030675
> 
> 赞同：0
> 
> 时间：2012-08-19T23:05:11.723
> 
> 标签：javascript, jquery, arrays

`Var divs = $(".txt");`这将返回一个`divs`带有`class`txt 的列表。例如，我想向选定的 div 添加文本： `divs[4].html("Hello World");`返回错误的 this`divs[4].html`不是函数。为什么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T23:08:22.560

当您通过其 DOM 数组索引访问 jQuery 对象时，您将获得 HTML 元素，而不是 jQuery 对象，它没有该`html()`功能。改用[`eq(n)`选择器](http://api.jquery.com/eq-selector/)：

```
$(".txt:eq(4)").html("Hello World"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T23:14:03.100

这`divs[0]`是给你一个 DOM 引用，*而不是*一个 jQuery 对象。因此，将其传递给 jQuery 函数（`$()`是 的简写`jQuery()`）：

```
$(document).ready(function(){
    var divs = $('.txt');

    $(divs[4]).html('this one');
}); 
```

[http://jsfiddle.net/userdude/unu8g/](http://jsfiddle.net/userdude/unu8g/)

还要注意使用`$(document).ready()`，它将等到 DOM 可访问。`$(window).load()`这也足够了，尽管它可能会在`onDOMReady`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:16:01.110

非jQuery方式：

```
document.getElementsByClassName("txt")[4].innerHTML = "banananana!"; 
```

*附带说明：我建议在迁移到库之前学习基本的浏览器 JavaScript。它将使您了解此类库的工作原理，并使您不会被“锁定”到特定的少数*

# c++ - 用于相机的 C++ OpenGL 四元数将其颠倒过来

> ID：12030680
> 
> 赞同：4
> 
> 时间：2012-08-19T23:05:56.373
> 
> 标签：c++, opengl, camera, orientation, quaternions

当我向右移动到目标并向上看时，它确实会看目标，直到它与 -zaxis 成 180 度并决定走另一条路。

```
Matrix4x4 camera::GetViewMat()
{
    Matrix4x4 oRotate, oView;
    oView.SetIdentity();

    Vector3 lookAtDir = m_targetPosition - m_camPosition;
    Vector3 lookAtHorizontal = Vector3(lookAtDir.GetX(), 0.0f, lookAtDir.GetZ());
    lookAtHorizontal.Normalize();

    float angle = acosf(Vector3(0.0f, 0.0f, -1.0f).Dot(lookAtHorizontal));
    Quaternions horizontalOrient(angle, Vector3(0.0f, 1.0f, 0.0f));

    ori = horizontalOrient;
    ori.Conjugate();
    oRotate = ori.ToMatrix();

    Vector3 inverseTranslate = Vector3(-m_camPosition.GetX(), -m_camPosition.GetY(), -m_camPosition.GetZ());
    oRotate.Transform(inverseTranslate);

    oRotate.Set(0, 3, inverseTranslate.GetX());
    oRotate.Set(1, 3, inverseTranslate.GetY());
    oRotate.Set(2, 3, inverseTranslate.GetZ());
    oView = oRotate;

    return oView;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T23:56:08.323

正如所承诺的，一段代码展示了我如何让相机始终注视空间中的特定点。

首先，我们需要一种从角度和轴构造四元数的方法，我碰巧在 pastebin 上有这个方法，角度输入以弧度为单位：

[http://pastebin.com/vLcx4Qqh](http://pastebin.com/vLcx4Qqh)

确保您没有输入轴 (0,0,0)，这没有任何意义。

现在是实际的更新方法，我们需要让四元数将相机从默认方向旋转到指向目标点。请注意我刚刚写了这个，它可能需要一点调试，可能需要一点优化，但这至少应该给你一个正确的方向。

```
void camera::update()
{
    // First get the direction from the camera's position to the target point
    vec3 lookAtDir = m_targetPoint - m_position;

    // I'm going to divide the vector into two 'components', the Y axis rotation
    // and the Up/Down rotation, like a regular camera would work.

    // First to calculate the rotation around the Y axis, so we zero out the y
    // component:
    vec3 lookAtHorizontal = vec3(lookAtDir.x, 0.0f, lookAtDir.z).normalize();

    // Get the quaternion from 'default' direction to the horizontal direction
    // In this case, 'default' direction is along the -z axis, like most OpenGL
    // programs. Make sure the projection matrix works according to this.
    float angle = acos(vec3(0.0f, 0.0f, -1.0f).dot(lookAtHorizontal));
    quaternion horizontalOrient(angle, vec3(0.0f, 1.0f, 0.0f));

    // Since we already stripped the Y component, we can simply get the up/down
    // rotation from it as well.
    angle = acos(lookAtDir.normalize().dot(lookAtHorizontal));
    if(angle) horizontalOrient *= quaternion(angle, lookAtDir.cross(lookAtHorizontal));

    // ...
    m_orientation = horizontalOrient;
} 
```

现在实际拍摄`m_orientation`并`m_position`获得世界 -> 相机矩阵

```
// First inverse each element (-position and inverse the quaternion),
// the position is rotated since the position within a matrix is 'added' last
// to the output vector, so it needs to account for rotation of the space.
mat3 rotationMatrix = m_orientation.inverse().toMatrix();
vec3 inverseTranslate = rotationMatrix * -m_position; // Note the minus

mat4 matrix = mat3; // just means the matrix is expanded, the last entry (bottom right of the matrix) is a 1.0f like an identity matrix would be.

// This bit is row-major in my case, you just need to set the translation of the matrix.
matrix[3] = inverseTranslate.x;
matrix[7] = inverseTranslate.y;
matrix[11] = inverseTranslate.z; 
```

**编辑** *我认为这应该很明显，但只是为了完整性，.dot() 采用向量的点积，.cross() 采用叉积，执行该方法的对象是向量 A，方法的参数是向量B.*

# java - 前台服务：如何处理用户启用/禁用

> ID：12030682
> 
> 赞同：0
> 
> 时间：2012-08-19T23:06:00.790
> 
> 标签：java, android

我的 Android 应用程序是一个前台服务，我希望用户能够随时禁用该服务，而无需卸载整个应用程序。

我在清单中使用 enabled = true 标签并启动完成以在前台启动服务。我担心的是，如果我有一个非常基本的全局布尔值（在服务的 onCreate 内） userEnabled = false 以防止服务启动（stopSelf），Android 将继续尝试启动我的服务，这将导致循环和因此使用不必要的资源？

请有人与我分享他们的知识，让我知道我不必担心这一点，或者这样做的正确程序/方法？我找不到任何提供指导的文档或帖子。

我提前谢谢你。

回答：请参阅下面的 CommonsWare 的回答，这里是一些[有用代码](https://stackoverflow.com/a/5625179/1256219)的链接，也是由 CommonsWare 提供的

进一步阅读后，在 Manifest 中启用服务集不会导致任何循环。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:08:22.377

> 我担心的是，如果我有一个非常基本的全局布尔值（在服务的 onCreate 内） userEnabled = false 以防止服务启动（stopSelf），Android 将继续尝试启动我的服务，这将导致循环和因此使用不必要的资源？

那句话对我来说并没有完全解析——我看不到你担心的循环。

话虽如此，如果您希望用户控制您的服务是否在启动时启动，请在用户禁用您的服务时使用并禁用`PackageManager`您的服务。这样，在重新启动时，您将无法控制，因此不会启动服务。如果用户重新启用您的服务，请再次使用以重新启用.`setComponentEnabledSetting()``BOOT_COMPLETED` `BroadcastReceiver``setComponentEnabledSetting()``BOOT_COMPLETED` `BroadcastReceiver`

# c++ - 在 C++ 中实现归并排序

> ID：12030683
> 
> 赞同：17
> 
> 时间：2012-08-19T23:06:01.757
> 
> 标签：c++, sorting, merge

我研究了归并排序的理论，但不知道如何在 C++ 中实现它。我的问题是，合并排序以递归方式创建数组。但是在实现的时候，我们如何在运行时创建数组呢？或者对此的一般方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-19T23:39:06.087

要回答这个问题：在运行时创建动态大小的数组是使用`std::vector<T>`. 理想情况下，您会使用其中一种来获得您的输入。如果没有，很容易转换它们。例如，您可以像这样创建两个数组：

```
template <typename T>
void merge_sort(std::vector<T>& array) {
    if (1 < array.size()) {
        std::vector<T> array1(array.begin(), array.begin() + array.size() / 2);
        merge_sort(array1);
        std::vector<T> array2(array.begin() + array.size() / 2, array.end());
        merge_sort(array2);
        merge(array, array1, array2);
    }
} 
```

但是，分配动态数组相对较慢，通常应尽可能避免。对于合并排序，您只需对原始数组的子序列进行排序并就地合并它们。看来，`std::inplace_merge()`要求双向迭代器。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-19T23:12:20.123

基于这里的代码：http: [//cplusplus.happycodings.com/algorithms/code17.html](http://cplusplus.happycodings.com/algorithms/code17.html)

```
// Merge Sort

#include <iostream>
using namespace std;

int a[50];
void merge(int,int,int);
void merge_sort(int low,int high)
{
 int mid;
 if(low<high)
 {
  mid = low + (high-low)/2; //This avoids overflow when low, high are too large
  merge_sort(low,mid);
  merge_sort(mid+1,high);
  merge(low,mid,high);
 }
}
void merge(int low,int mid,int high)
{
 int h,i,j,b[50],k;
 h=low;
 i=low;
 j=mid+1;

 while((h<=mid)&&(j<=high))
 {
  if(a[h]<=a[j])
  {
   b[i]=a[h];
   h++;
  }
  else
  {
   b[i]=a[j];
   j++;
  }
  i++;
 }
 if(h>mid)
 {
  for(k=j;k<=high;k++)
  {
   b[i]=a[k];
   i++;
  }
 }
 else
 {
  for(k=h;k<=mid;k++)
  {
   b[i]=a[k];
   i++;
  }
 }
 for(k=low;k<=high;k++) a[k]=b[k];
}
int main()
{
 int num,i;

cout<<"*******************************************************************
*************"<<endl;
 cout<<"                             MERGE SORT PROGRAM
"<<endl;

cout<<"*******************************************************************
*************"<<endl;
 cout<<endl<<endl;
 cout<<"Please Enter THE NUMBER OF ELEMENTS you want to sort [THEN 
PRESS
ENTER]:"<<endl;
 cin>>num;
 cout<<endl;
 cout<<"Now, Please Enter the ( "<< num <<" ) numbers (ELEMENTS) [THEN
PRESS ENTER]:"<<endl;
 for(i=1;i<=num;i++)
 {
  cin>>a[i] ;
 }
 merge_sort(1,num);
 cout<<endl;
 cout<<"So, the sorted list (using MERGE SORT) will be :"<<endl;
 cout<<endl<<endl;

 for(i=1;i<=num;i++)
 cout<<a[i]<<"  ";

 cout<<endl<<endl<<endl<<endl;
return 1;

} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-09-17T06:17:25.633

我已经完成了@DietmarKühl 的合并排序方式。希望对大家有帮助。

```
template <typename T>
void merge(vector<T>& array, vector<T>& array1, vector<T>& array2) {
    array.clear();

    int i, j, k;
    for( i = 0, j = 0, k = 0; i < array1.size() && j < array2.size(); k++){
        if(array1.at(i) <= array2.at(j)){
            array.push_back(array1.at(i));
            i++;
        }else if(array1.at(i) > array2.at(j)){
            array.push_back(array2.at(j));
            j++;
        }
        k++;
    }

    while(i < array1.size()){
        array.push_back(array1.at(i));
        i++;
    }

    while(j < array2.size()){
        array.push_back(array2.at(j));
        j++;
    }
}

template <typename T>
void merge_sort(std::vector<T>& array) {
    if (1 < array.size()) {
        std::vector<T> array1(array.begin(), array.begin() + array.size() / 2);
        merge_sort(array1);
        std::vector<T> array2(array.begin() + array.size() / 2, array.end());
        merge_sort(array2);
        merge(array, array1, array2);
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-03-12T14:58:24.147

我重新排列了选定的答案，用于数组的指针和用于数字计数的用户输入不是预定义的。

```
#include <iostream>

using namespace std;

void merge(int*, int*, int, int, int);

void mergesort(int *a, int*b, int start, int end) {
  int halfpoint;
  if (start < end) {
    halfpoint = (start + end) / 2;
    mergesort(a, b, start, halfpoint);
    mergesort(a, b, halfpoint + 1, end);
    merge(a, b, start, halfpoint, end);
  }
}

void merge(int *a, int *b, int start, int halfpoint, int end) {
  int h, i, j, k;
  h = start;
  i = start;
  j = halfpoint + 1;

  while ((h <= halfpoint) && (j <= end)) {
    if (a[h] <= a[j]) {
      b[i] = a[h];
      h++;
    } else {
      b[i] = a[j];
      j++;
    }
    i++;
  }
  if (h > halfpoint) {
    for (k = j; k <= end; k++) {
      b[i] = a[k];
      i++;
    }
  } else {
    for (k = h; k <= halfpoint; k++) {
      b[i] = a[k];
      i++;
    }
  }

  // Write the final sorted array to our original one
  for (k = start; k <= end; k++) {
    a[k] = b[k];
  }
}

int main(int argc, char** argv) {
  int num;
  cout << "How many numbers do you want to sort: ";
  cin >> num;
  int a[num];
  int b[num];
  for (int i = 0; i < num; i++) {
    cout << (i + 1) << ": ";
    cin >> a[i];
  }

  // Start merge sort
  mergesort(a, b, 0, num - 1);

  // Print the sorted array
  cout << endl;
  for (int i = 0; i < num; i++) {
    cout << a[i] << " ";
  }
  cout << endl;

  return 0;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-10-29T22:27:22.767

```
#include <iostream>
using namespace std;

template <class T>
void merge_sort(T array[],int beg, int end){
    if (beg==end){
        return;
    }
    int mid = (beg+end)/2;
    merge_sort(array,beg,mid);
    merge_sort(array,mid+1,end);
    int i=beg,j=mid+1;
    int l=end-beg+1;
    T *temp = new T [l];
    for (int k=0;k<l;k++){
        if (j>end || (i<=mid && array[i]<array[j])){
            temp[k]=array[i];
            i++;
        }
        else{
            temp[k]=array[j];
            j++;
        }
    }
    for (int k=0,i=beg;k<l;k++,i++){
        array[i]=temp[k];
    }
    delete temp;
}

int main() {
    float array[] = {1000.5,1.2,3.4,2,9,4,3,2.3,0,-5};
    int l = sizeof(array)/sizeof(array[0]);
    merge_sort(array,0,l-1);
    cout << "Result:\n";
    for (int k=0;k<l;k++){
        cout << array[k] << endl;
    }
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-03-17T06:38:52.053

合并排序的问题在于合并，如果您实际上不需要实现合并，那么它非常简单（对于整数向量）：

```
#include <algorithm>
#include <vector>
using namespace std;

typedef vector<int>::iterator iter;

void mergesort(iter b, iter e) {
    if (e -b > 1) {
        iter m = b + (e -b) / 2;
        mergesort(b, m);
        mergesort(m, e);
        inplace_merge(b, m, e);
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-16T16:43:35.023

我知道这个问题已经得到解答，但我决定加两分钱。这是合并排序的代码，它只在合并操作中使用额外的空间（并且额外的空间是临时空间，在弹出堆栈时将被销毁）。事实上，您会在这段代码中看到没有使用堆操作（没有在`new`任何地方声明）。

希望这可以帮助。

```
 void merge(int *arr, int size1, int size2) {
        int temp[size1+size2];
        int ptr1=0, ptr2=0;
        int *arr1 = arr, *arr2 = arr+size1;

        while (ptr1+ptr2 < size1+size2) {
            if (ptr1 < size1 && arr1[ptr1] <= arr2[ptr2] || ptr1 < size1 && ptr2 >= size2)
                temp[ptr1+ptr2] = arr1[ptr1++];

            if (ptr2 < size2 && arr2[ptr2] < arr1[ptr1] || ptr2 < size2 && ptr1 >= size1)
                temp[ptr1+ptr2] = arr2[ptr2++];
        }   

        for (int i=0; i < size1+size2; i++)
            arr[i] = temp[i];
    }   

    void mergeSort(int *arr, int size) {
        if (size == 1)
            return;

        int size1 = size/2, size2 = size-size1;
        mergeSort(arr, size1);
        mergeSort(arr+size1, size2);
        merge(arr, size1, size2);
    } 

    int main(int argc, char** argv) {
         int num;
         cout << "How many numbers do you want to sort: ";
         cin >> num;
         int a[num];
         for (int i = 0; i < num; i++) {
           cout << (i + 1) << ": ";
           cin >> a[i];
         }   

         // Start merge sort
         mergeSort(a, num);

         // Print the sorted array
         cout << endl;
         for (int i = 0; i < num; i++) {
           cout << a[i] << " ";
         }   
         cout << endl;

         return 0;
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-05-02T22:42:35.650

这是一种实现它的方法，只使用数组。

```
#include <iostream>
using namespace std;

//The merge function
void merge(int a[], int startIndex, int endIndex)
{

int size = (endIndex - startIndex) + 1;
int *b = new int [size]();

int i = startIndex;
int mid = (startIndex + endIndex)/2;
int k = 0;
int j = mid + 1;

while (k < size)
{   
    if((i<=mid) && (a[i] < a[j]))
    {
        b[k++] = a[i++];
    }
    else
    {
        b[k++] = a[j++];
    }

}

for(k=0; k < size; k++)
{
    a[startIndex+k] = b[k];
}

delete []b;

}

//The recursive merge sort function
void merge_sort(int iArray[], int startIndex, int endIndex)
{
int midIndex;

//Check for base case
if (startIndex >= endIndex)
{
    return;
}   

//First, divide in half
midIndex = (startIndex + endIndex)/2;

//First recursive call 
merge_sort(iArray, startIndex, midIndex);

//Second recursive call 
merge_sort(iArray, midIndex+1, endIndex);

merge(iArray, startIndex, endIndex);

}

//The main function
int main(int argc, char *argv[])
{
int iArray[10] = {2,5,6,4,7,2,8,3,9,10};

merge_sort(iArray, 0, 9);

//Print the sorted array
for(int i=0; i < 10; i++)
{
    cout << iArray[i] << endl;
}

return 0;    
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-09T21:55:54.603

这很容易理解：

```
#include <iostream>

using namespace std;

void Merge(int *a, int *L, int *R, int p, int q)
{
    int i, j=0, k=0;
    for(i=0; i<p+q; i++)
    {
        if(j==p)                       //When array L is empty
        {
            *(a+i) = *(R+k);
            k++;
        }
        else if(k==q)                  //When array R is empty
        {
            *(a+i) = *(L+j);
            j++;
        }
        else if(*(L+j) < *(R+k))  //When element in L is smaller than element in R
        {
            *(a+i) = *(L+j);
            j++;
        }
        else   //When element in R is smaller or equal to element in L
        {
            *(a+i) = *(R+k);
            k++;
        }
    }
}

void MergeSort(int *a, int len)
{
    int i, j;
    if(len > 1)
    {
        int p = len/2 + len%2;      //length of first array
        int q = len/2;              //length of second array
        int L[p];                   //first array
        int R[q];                   //second array
        for(i=0; i<p; i++)
        {
            L[i] = *(a+i);      //inserting elements in first array
        }
        for(i=0; i<q; i++)
        {
            R[i] = *(a+p+i);    //inserting elements in second array
        }
        MergeSort(&L[0], p);
        MergeSort(&R[0], q);
        Merge(a, &L[0], &R[0], p, q);   //Merge arrays L and R into A
    }
    else
    {
        return;        //if array only have one element just return
    }
}

int main()
{
    int i, n;
    int a[100000];
    cout<<"Enter numbers to sort. When you are done, enter -1\n";
    i=0;
    while(true)
    {
        cin>>n;
        if(n==-1)
        {
            break;
        }
        else
        {
            a[i] = n;
            i++;
        }
    }
    int len = i;
    MergeSort(&a[0], len);
    for(i=0; i<len; i++)
    {
        cout<<a[i]<<" ";
    }

    return 0;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-11T16:33:08.500

这是我的版本（简单易行）：
使用的内存仅为原始数组大小的 **两倍。**
[ a 是左数组 ] [ b 是右数组 ] [ c 用于合并 a 和 b ] [ p 是 c 的计数器]

```
void MergeSort(int list[], int size)
{
    int blockSize = 1, p;
    int *a, *b;
    int *c = new int[size];
    do
    {
        for (int k = 0; k < size; k += (blockSize * 2))
        {
            a = &list[k];
            b = &list[k + blockSize];
            p = 0;
            for (int i = 0, j = 0; i < blockSize || j < blockSize;)
            {
                if ((j < blockSize) && ((k + j + blockSize) >= size))
                {
                    ++j;
                }
                else if ((i < blockSize) && ((k + i) >= size))
                {
                    ++i;
                }
                else if (i >= blockSize)
                {
                    c[p++] = b[j++];
                }
                else if (j >= blockSize)
                {
                    c[p++] = a[i++];
                }
                else if (a[i] >= b[j])
                {
                    c[p++] = b[j++];
                }
                else if (a[i] < b[j])
                {
                    c[p++] = a[i++];
                }
            }
            for (int i = 0; i < p; i++)
            {
                a[i] = c[i];
            }
        }
        blockSize *= 2;
    } while (blockSize < size);
} 
```

# javascript - 选择同一文件时未触发 HTML 输入文件选择事件

> ID：12030686
> 
> 赞同：267
> 
> 时间：2012-08-19T23:06:26.163
> 
> 标签：javascript, html, forms, dom-events

是否有机会检测用户为 HTML`input`类型`file`元素所做的每个文件选择？

这在以前被问过很多次，但是`onchange`如果用户再次选择相同的文件，通常建议的事件不会触发。

* * *

## 回答 #1

> 赞同：357
> 
> 时间：2012-08-24T04:04:39.267

在每个事件上设置`input`to的值。即使选择了相同的路径，这也会重置' 的值并触发事件。`null``onclick``input``onchange`

```
var input = document.getElementsByTagName('input')[0];

input.onclick = function () {
  this.value = null;
};

input.onchange = function () {
  console.log(this.value);
};
```

```
<input type="file" value="C:\fakepath">
```

注意：如果您的文件带有'C:\fakepath'前缀，这是正常的。这是一项安全功能，可防止 JavaScript 知道文件的绝对路径。浏览器仍然在内部知道它。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2019-02-11T14:45:32.857

每次用户单击字段时，使用 onClick 事件清除目标输入的值。这确保了 onChange 事件也会为同一个文件触发。为我工作:)

```
onInputClick = (event) => {
    event.target.value = ''
}

<input type="file" onChange={onFileChanged} onClick={onInputClick} /> 
```

使用打字稿

```
onInputClick = ( event: React.MouseEvent<HTMLInputElement, MouseEvent>) => {
    const element = event.target as HTMLInputElement
    element.value = ''
} 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2014-09-20T12:52:48.233

```
<form enctype='multipart/form-data'>
    <input onchange="alert(this.value); this.value=null; return false;" type='file'>
    <br>
    <input type='submit' value='Upload'>
</form> 
```

`this.value=null;`仅对 Chrome 是必需的，Firefox 可以正常工作`return false;`

这是一个[小提琴](https://jsfiddle.net/elshnkhll/2xenqca0/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-08-24T03:04:20.200

在本文中，在标题“使用表单输入进行选择”下

[http://www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

```
<input type="file" id="files" name="files[]" multiple />

<script>
function handleFileSelect(evt) {

    var files = evt.target.files; // FileList object

    // files is a FileList of File objects. List some properties.
    var output = [];
    for (var i = 0, f; f = files[i]; i++) {
     // Code to execute for every file selected
    }
    // Code to execute after that

}

document.getElementById('files').addEventListener('change', 
                                                  handleFileSelect, 
                                                  false);
</script> 
```

它为“更改”添加了一个事件侦听器，但我对其进行了测试，即使您选择相同的文件而不是取消，它也会触发。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2020-03-27T13:23:34.110

```
handleChange({target}) {
    const files = target.files
    target.value = ''
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-06-19T09:21:05.580

**清除输入的第 0 个索引的值对我有用**。请尝试下面的代码，希望这会起作用（AngularJs）。

```
 scope.onClick = function() {
            input[0].value = "";
                input.click();
            }; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-07-22T06:42:44.247

```
<input #myInput type="file" id="imgFile" (click)="$event.target.value=null"
       (change)="detectUploadedImage($event)" accept="image/*" /> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-07T13:04:33.937

在文件加载成功后做任何你想做的事情。在文件处理完成后将文件控制的值设置为空白字符串。所以即使文件名发生变化，也会始终调用 .change()。例如，您可以做这件事并像魅力一样为我工作

```
 $('#myFile').change(function () {
       LoadFile("myFile");//function to do processing of file.
       $('#myFile').val('');// set the value to empty of myfile control.
    }); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-26T09:14:51.777

如果您使用 Angular，则使用两种方式绑定对我有用。

这是我的 HMTL

```
<input type="file" #upload name="upload" [(ngModel)]="inputValue"(change)='fileEvent($event)'/> 
```

和TS..

```
 @ViewChild('upload') uploadBtn: HTMLElement;

  fileEvent(e: any){

   //file upload part... 

    this.inputValue = "";
  } 
```

# javascript - 使用变量的先前/旧值的 setinterval 函数

> ID：12030694
> 
> 赞同：0
> 
> 时间：2012-08-19T23:07:48.927
> 
> 标签：javascript, setinterval

我想播放部分视频（html5）并在 2 个文本区域的“onclick”上循环播放这些部分。我将 starttime (st) 和 endtime (et) 传递给 javascript 函数。

textarea1 : st=6 et=12

textarea2 : st=15 et=20

我正在使用 setinterval 检查结束时间并再次调用方法进行循环。

场景：单击 textarea1。st=6 等=12。在播放时单击 textarea2。条件 video.currentTime > et 为 true 为 15 > 12，这是错误的结果。et 值在“onclick”上没有改变。请帮忙。

这是我的代码：

```
function playVideo(st,et) {
   var video = document.getElementById('player');
   video.currentTime = st;
   video.play();
   int = setInterval(function() {
      if (video.currentTime > et) { // here the et still has the previous value 
          playVideo(st,et); // loop             
      }
   }, 10);
}

<video width="320" height="240" controls="controls" id="player">
   <source src="abc.mp4" type="video/mp4" />
</video>
<textarea onclick="playVideo(6,12)" >Part1 </textarea>
<textarea onclick="playVideo(15,20)">Part2</textarea> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:39:17.197

不是那个`et`有以前的价值，而是你永远不会摆脱旧的间隔。

与其`playVideo`再次调用，不如直接调用`video.currentTime = st;`. 但是，请记住，您将需要停止间隔的*东西*。就个人而言，我会做这样的事情：

```
function playVideo(st,et) {
    var video = document.getElementById('player');
    clearInterval(arguments.callee.interval);
    video.currentTime = st;
    video.play();
    arguments.callee.interval = setInterval(function() {
        if( video.currentTime > et) video.currentTime = st;
    },10);
} 
```

我将区间保存为函数的一个属性，它本质上相当于 JS 的静态变量。这样，当用户单击其他文本区域时，它将清除现有间隔以确保它不再干扰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:39:03.577

使用 clearInterval[摆脱旧的间隔！](http://www.w3schools.com/jsref/met_win_clearinterval.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:39:51.770

您的问题可能是您没有清除间隔回调。尝试检查以前的（但仍处于活动状态的）间隔，并在分配新间隔之前将其清除。

```
var videoEndInterval = null;
function playVideo(st, et) {
    ...

    if (videoEndInterval !== null) {
        clearInterval(videoEndInterval);
    }
    videoEndInterval = setInterval(function() {
        ...
    }, 10);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T16:55:08.917

您的“循环”当前为每个间隔创建一个新间隔，并且您会得到一团糟的间隔。setInterval 确实每 x ms 执行一次，而 setTimeout 确实在 x ms 后执行一次。当您停止视频时，您需要清除间隔。

尝试这个：

```
// var declared outside, to clear an old interval,
// but also to not have a global variable.
var stopInterval; 

var playVideo = function (st, et) {
   var video = document.getElementById('player');
   video.currentTime = st;
   video.play();

   if (stopInterval) {
     // clear an old interval, if playVideo is called twice
     window.clearInterval(stopInterval);
     stopInterval = 0;
   }

   stopInterval = window.setInterval(function() {
      if (video.currentTime > et) {
          // here your video is after et, so clear the interval and stop.
          window.clearInterval(stopInterval);
          stopInterval = 0;
          video.pause();
      }
   }, 10);
}; 
```

您还应该提示您的视频是否未缓冲、不可播放且已暂停（以清除您的间隔）。

另请参阅 Mozilla 开发人员网络上的[HTMLVideoElement 接口](https://developer.mozilla.org/en-US/docs/DOM/HTMLVideoElement)、[HTMLMediaElement 接口](https://developer.mozilla.org/en-US/docs/DOM/HTMLMediaElement)、 [视频 HTML5 元素](https://developer.mozilla.org/en-US/docs/HTML/Element/video)和 [使用 HTML5 音频和视频](https://developer.mozilla.org/en-US/docs/Using_HTML5_audio_and_video)。

# c# - WinRT 中的 CommandManager 由什么替代？

> ID：12030697
> 
> 赞同：20
> 
> 时间：2012-08-19T23:08:20.247
> 
> 标签：c#, windows-8, windows-runtime, icommand

我开始使用 Metro 风格的应用程序（我知道我们不应该将其称为 Metro，但我永远不记得它应该被称为什么......），并且我正在实现一个`DelegateCommand`用于 MVVM 的类。在 WPF 中，`ICommand.CanExecuteChanged`事件通常是这样实现的：

```
 public event EventHandler CanExecuteChanged
    {
        add { CommandManager.RequerySuggested += value; }
        remove { CommandManager.RequerySuggested -= value; }
    } 
```

但是`CommandManager`该类在 WinRT 中不存在……还有别的东西吗？还是我们应该自己明确触发这个事件？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-25T15:51:53.643

在 WinRT 中，您必须手动更新/提升 CanExecuteChanged。没有 CommandManager 可以全局执行此操作。你可以把这看作是一种痛苦，或者因为 CanExecute 没有被经常调用，所以性能得到了严重的提升。这确实意味着您必须考虑在您不必考虑级联属性更改之前。但事实就是这样。手动的。

```
public void RaiseCanExecuteChanged()
{
    if (CanExecuteChanged != null)
        CanExecuteChanged(this, EventArgs.Empty);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T11:25:33.857

使用 WPF，您必须`ICommand.CanExecuteChanged`按照您的描述实现。但是，对于 Silverlight，情况并非如此。请参阅此相关问题：

[WPF CommandParameter 绑定未更新](https://stackoverflow.com/questions/3092339/wpf-commandparameter-binding-not-updating)

我的猜测是，在 WinRT 中，就像在 Silverlight 中一样，`CommandManager`没有必要。

请参阅此处的相关讨论：

[http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/477cdd19-ee88-4746-97fe-59b8dbd44e0a/](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/477cdd19-ee88-4746-97fe-59b8dbd44e0a/)

# java - 在 Java 中解压缩内存中的 ZIP 文件

> ID：12030703
> 
> 赞同：29
> 
> 时间：2012-08-19T23:08:27.470
> 
> 标签：java, zip

我正在下载包含 XML 的压缩文件，并且由于延迟要求，我想避免在操作它们之前将压缩文件写入磁盘。然而，`java.util.zip`对我来说还不够。没有办法说“这是一个 zip 文件的字节数组，使用它”而不将其转换为流，并且`ZipInputStream`不可靠，因为它会扫描条目标头（有关不可靠的原因，请参见编辑下面的讨论）。

我还没有访问我将要处理的 zip 文件的权限，所以我不知道我是否能够通过 处理它们`ZipInputStream`，我需要找到一个适用于任何有效 ZIP 文件的解决方案，因为一旦我投入生产，失败的惩罚会很高。

假设 ZipInputStream 不起作用，在没有条目标头的情况下我能做些什么来解决这个问题？我使用[Wikipedia 的定义](http://en.wikipedia.org/wiki/Zip_%28file_format%29#Structure)作为标准，其中包括关于如何正确解压缩 zip 文件（引用如下）的评论。

**编辑**

Apache Commons Zip 库对使用 Stream（他们的解决方案和 Java 的）的一些问题有[很好的描述。](http://commons.apache.org/compress/zip.html)我将根据维基百科和个人经验进一步补充，条目标题上的 size 和 crc 字段可能未填写（我在这些字段中有 -1 的文件）。感谢[centic](https://stackoverflow.com/users/411846/centic)提供此链接。

另外，让我引用有关该主题的维基百科：

> 正确读取 zip 存档的工具必须扫描各个字段的签名，即 zip 中央目录。他们不能扫描条目，因为只有目录指定文件块的开始位置。扫描可能会导致误报，因为该格式不禁止其他数据位于块之间，或包含此类签名的未压缩流。

请注意，`ZipInputStream`扫描条目，而不是中央目录，这是它的问题。

**最终编辑**

如果有人有兴趣，可以使用[此脚本](https://gist.github.com/3800777)生成无法`ZipInputStream`从现有 ZIP 文件读取的有效 ZIP 文件。因此，作为对这个封闭问题的最后编辑，我需要一个可以读取文件的库，例如由该脚本生成的文件。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-06T06:01:32.697

编辑：另一个建议...

从`ZipFile`Apache Commons 实现来看，为您的项目有效地分叉似乎并不*难*。在您的字节数组周围创建一个包装器，`RandomAccessFile`其中包含所需的所有 API 片段（我不认为有很多）。您已经表明您更喜欢界面`ZipFile`，那么为什么不这样做呢？

我们对您的项目知之甚少，无法知道这是否会引发任何法律问题——即使您提供了详细信息，我怀疑这里的任何人都能够提供良好的法律建议——但我怀疑这不会超过一两个小时让这个解决方案启动并运行，我怀疑你会对它有合理的信心。

* * *

编辑：这可能是一个更有成效的答案......

如果您担心条目不连续，但又不想自己处理所有压缩方面，您可以考虑有效地*重写*数据的选项。创建一个新的`ByteArrayOutputStream`，并在最后读取中央目录。`ZipInputStream`对于中央目录中的每个条目，以您认为会满意的格式将条目（标题 + 数据）写入输出流。然后编写一个新的中央目录 - 如果您希望替换有效，您可能需要从头开始执行此操作，但如果您使用的代码您*知道*实际上不会读取中央目录，您可以只提供原始目录，忽略它可能无效的事实。只要它以正确的签名开始，那可能就足够了:)

完成后，将 the`ByteArrayOutputStream`转换为*new* `byte[]`，将其包装在 a 中`ByteArrayInputStream`，然后将其传递给`ZipInputStream`or `ZipArchiveInputStream`。

根据您的目的，您甚至可能不需要做那么多 - 您可以通过创建一个“迷你” zip 文件来提取每个文件，一次只从目录中读取一个条目.

这*确实*涉及理解 zip 文件格式，但并不完全 - 只是框架，有效。这不像完全使用现有 API 那样快速简单的解决方法，但不会花费*很*长时间。它不能保证它能够读取所有无效文件（怎么可能？），但它会保护您免受您似乎特别关心的“条目之间的数据”问题。希望这至少是一个有用的想法......

* * *

> 没有办法说“这是一个 zip 文件的字节数组，使用它”

就在这里：

```
byte[] data = ...;
ByteArrayInputStream byteStream = new ByteArrayInputStream(data);
ZipInputStream zipStream = new ZipInputStream(byteStream); 
```

这就留下了是否`ZipInputStream`可以处理您将提供的所有 zip 文件的问题——但我不会这么快就把它写下来。

当然，还有其他可用的 API。例如，您可能想查看[Apache Commons Compress](http://commons.apache.org/compress/)。即使`ZipFile`需要一个文件，[`ZipArchiveInputStream`](http://commons.apache.org/compress/apidocs/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.html)也不需要 - 所以再次，您可以使用`ByteArrayInputStream`. 编辑：看起来`ZipArchiveStream` *也没有*从中央目录中读取。我希望它会`markSupported`用来事先检查，但它似乎没有......

编辑：在对问题的评论中，我问你在哪里读到 zip 文件不必包含条目数据。你引用了维基百科：

> “正确读取 zip 存档的工具必须扫描各个字段的签名，即 zip 中央目录。它们不能扫描条目，因为只有目录指定文件块的开始位置。扫描可能导致误报，因为格式不'不禁止其他数据位于块之间，或包含此类签名的未压缩流。”

这与条目数据是可选的不同。这是说在尴尬的地方可能有*额外的*数据，而不是条目可能完全丢失。基本上是说不应假定条目是*连续的*。我可以很高兴地承认，这`ZipInputStream`可能不是在读取文件末尾的中央目录，但是查找执行此操作的代码与查找处理不存在的条目数据的代码不同。

然后你写：

> 我可能会进一步补充说，zip 是否有效不是我关心的问题。使用它是。

...这表明您需要处理无效 zip 文件的代码。结合这个：

> 我还没有访问我将要处理的 zip 文件，所以我不知道我是否能够通过流处理它们

这意味着您要求的代码应该以您甚至无法预测的方式处理无效的 zip 文件。你能拒绝它有多无效？如果我给你 1000 个随机字节，根本不尝试将它们变成一个 zip 文件，你到底会用它做什么？

基本上，您需要更严格地确定问题，然后才能说出特定库是否是有效的解决方案。从各个地方收集一组 zip 文件是合理的，这些文件可能以众所周知的方式无效，并说“我必须能够支持所有这些”。稍后，如果事实证明这还不够好，您*可能需要做一些工作。*但是能够支持任何东西，无论多么损坏，都不是一个有效的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T06:32:25.543

[TrueZIP](http://truezip.java.net)库提供了替代成熟的 zip 实现。

它还具有[文件系统抽象功能，即使对于 HTTP](http://truezip.java.net/truezip-path/index.html)也是如此。

例如：

```
Path path = new TPath(new URI("http://acme.com/download/everything.zip/entry.xml"));
try (InputStream in = Files.newInputStream(path)) {
    // Read archive entry contents here.
    ...
} 
```

因此，如果您只对特定条目感兴趣，它只会下载它们，从而节省带宽和时间。而且您不必编写下载代码。

另见[http://truezip.java.net/faq.html#http](http://truezip.java.net/faq.html#http)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T10:11:49.653

我会使用 Apache 库 commons-compress，见[http://commons.apache.org/compress/](http://commons.apache.org/compress/)

[它支持通过流读取 Zip 文件，在http://commons.apache.org/compress/zip.html](http://commons.apache.org/compress/zip.html)有深入的文档以获取详细文档。它还说明了 Zip 格式固有的一些限制。

示例代码如下所示：

```
ZipArchiveInputStream zip =
    new ZipArchiveInputStream(inputStream);
try {
    ZipArchiveEntry entry = zip.getNextZipEntry();
    while(entry != null) {
        assertEquals("README", entry.getName());
        ...
        entry = zip.getNextZipEntry();
    }
} finally {
    zip.close();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T07:50:23.160

这个问题听起来类似于[如何在内存中创建目录？伪文件系统/虚拟目录](https://stackoverflow.com/questions/5508601/how-to-create-a-directory-in-memory-pseudo-file-system-virtual-directory)。基本上，我的建议是使用更通用的解决方案——内存中的虚拟文件系统（我不是指操作系统级别，如 Linux 的 ramfs/tmpfs）。

一个例子是使用 Java 7 NIO API，它现在提供了一个 SPI，用于通过[FileSystemProvider](http://download.oracle.com/javase/7/docs/api/java/nio/file/spi/FileSystemProvider.html)实现文件系统。[ShrinkWrap](http://exitcondition.alrubinger.com/2012/08/17/shrinkwrap-nio2/)文件系统似乎实现了这个 SPI。

一个更易于访问的选项是使用 Apache Commons VFS 的[ram 文件系统](http://commons.apache.org/vfs/filesystems.html#ram)：它只需要 Java 5。如果您需要与 Java 5 和 6 兼容，这可能是您最好的选择。

[我首先记得从这篇文章](http://java.dzone.com/news/in-memory-virtual-filesystems)中阅读了有关 Java 内存文件系统的内容，除了指出 Commons VFS 和[JBoss Microcontainer](http://www.jboss.org/jbossmc/)等解决方案之外，它还为 NetBeans IDE 提供了一个很好的示例用例。

虽然内存中的虚拟文件系统是避免操作系统级文件系统（具有相关的性能优势）的一个很好的通用解决方案，但它可能存在其他缺点，更专业的解决方案可以解决这些缺点。例如，我不确定从多个线程同时使用此文件系统时会如何表现。只要您不访问相同的文件，它就可以正常工作，或者您可能需要创建单独的文件系统（这在资源使用方面可能会令人望而却步）。

# python - 为什么 PyMongo 将 uuid.uuid1() 编码为 BSON::Binary？

> ID：12030709
> 
> 赞同：2
> 
> 时间：2012-08-19T23:09:52.340
> 
> 标签：python, mongodb, uuid, pymongo, bson

我正在为 Mongo 中的所有文档添加一个值为 uuid.uuid1()（来自 python uuid 模块）的“GUID”键。我注意到它们不是作为字符串存储的，而是作为**BSON::Binary**类型存储的。我已经做了一些谷歌搜索，但我仍然不明白这个序列化的目的/优势是什么。有人可以解释吗？我应该在存储之前将 uuid.uuid1() 转换为字符串吗？如何通过 db.myCol.find({ 'GUID' : aString }) 之类的 GUID 值使用字符串来查找（）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T02:09:58.630

Python 的默认序列化在[BSON 规范](http://bsonspec.org/#/specification)`uuid`中使用`UUID`二进制表示，因为这确保了范围查询的一​​致排序，并且还使用更少的数据/索引存储。

例如，这三个字符串在十六进制中是等价的：

```
5d78ad35ea5f11e1a183705681b29c47
5D78AD35EA5F11E1A183705681B29C47
5d78ad35ea5f11e1A183705681B29C47 
```

..但有不同的排序顺序作为字符串：

```
> db.uuidsort.find().sort({_id:1})
{ "_id" : "5D78AD35EA5F11E1A183705681B29C47" }
{ "_id" : "5d78ad35ea5f11e1A183705681B29C47" }
{ "_id" : "5d78ad35ea5f11e1a183705681b29c47" } 
```

比较 bson 大小：

```
> db.uuidtest.find()
{ "_id" : BinData(3,"XXitNepfEeGhg3BWgbKcRw==") }
{ "_id" : "5d78ad35ea5f11e1a183705681b29c47" }

> Object.bsonsize(db.uuidtest.findOne({_id: BinData(3,"XXitNepfEeGhg3BWgbKcRw==")}))
31

> Object.bsonsize(db.uuidtest.findOne({_id: "5d78ad35ea5f11e1a183705681b29c47"}))
47 
```

如果您确实想作为字符串插入，您可以使用[UUID.hex](http://docs.python.org/library/uuid.html#uuid.UUID.hex)来获得等效的 32 个字符的字符串：

```
>>> db.uuidtest.insert({'_id': uuid.hex})
'5d78ad35ea5f11e1a183705681b29c47' 
```

如果要从 Python 中按字符串查找 UUID，可以使用[uuid.UUID](http://docs.python.org/library/uuid.html#uuid.UUID)方法：

```
>>> db.uuidtest.find_one({'_id':uuid.UUID('5d78ad35ea5f11e1a183705681b29c47')})
{u'_id': UUID('5d78ad35-ea5f-11e1-a183-705681b29c47')} 
```

如果你想从`mongo`shell 中通过字符串查找 UUID，有一个`UUID()`助手：

```
> db.uuidtest.find({_id:UUID('5d78ad35ea5f11e1a183705681b29c47')})
{ "_id" : BinData(3,"XXitNepfEeGhg3BWgbKcRw==") } 
```

注意：还有一些其他 UUID 子类型可用于与其他驱动程序版本的互操作性，如[bson.binary 的 API 文档中所述](http://api.mongodb.org/python/current/api/bson/binary.html)。

# java - 未找到更改日志 changelog.groovy

> ID：12030710
> 
> 赞同：6
> 
> 时间：2012-08-19T23:09:53.540
> 
> 标签：java, grails, intellij-idea, migration, changelog

我`Grails`在 IntellijIDEA 11.1.3 中创建了新项目并尝试运行它。

当我打开`http://localhost:8080/application/dbdoc`（访问控制器的默认操作`grails.plugin.databasemigration.DbdocController`）时，我不断收到消息：

```
Changelog changelog.groovy not found 
```

虽然，文件`changelog.groovy`存在于我的项目的文件系统中的文件夹中`./grails-app/migrations`。我已经生成了它，使用命令：

```
grails dbm-create-changelog changelog.groovy 
```

现在它具有以下内容：

```
databaseChangeLog = {
    changeSet(author: "Edward (generated)", id: "changelog") {
        // TODO add changes and preconditions here
    }
} 
```

我需要做什么才能让它工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T19:18:08.660

我也在运行 IntelliJ 11.1.3。我正在使用 Grails 2.1 和`database-migration:1.1`.

database-migration 插件用于创建更改日志 Groovy 脚本，可用于在 X 点及时迁移数据库，以与您对 Grails 应用程序所做的新代码更改兼容。

例如，如果您的 Grails 应用程序今天正在生产中，带有您的域类、表等，并且您运行`grails dbm-create-changelog changelog.groovy`，这将为您提供基线 changelog.groovy 脚本。然后你应该运行`grails dbm-changelog-sync`以表明你是最新的。

假设您添加了新的域类并在现有的域类上修改了字段。如果您一直在维护您的变更集并运行`grails dbm-update`，则数据库迁移插件将根据这些变更集更新您的数据库模式。

这是我正在阅读/关注的优秀教程（不是我的），以了解有关数据库迁移插件的更多信息：[Grails DB-Migration Plugin Tutorial](http://wpgreenway.wordpress.com/2012/03/25/grails-db-migration-tutorial)

# opengl - GLSL，不同大小的纹理数组

> ID：12030711
> 
> 赞同：13
> 
> 时间：2012-08-19T23:10:03.137
> 
> 标签：opengl, glsl

在 GLSL 中进行多重纹理处理时，是否有一个可索引的采样器数组，其中每个纹理的大小不同？此语法无效：

```
uniform sampler2D texArray[5]; 
```

现在似乎唯一的选择是单独创建采样器：

```
uniform sampler2D tex1;
uniform sampler2D tex2;
uniform sampler2D tex3;
uniform sampler2D tex4;
uniform sampler2D tex5; 
```

但是我无法遍历它们，这真是让人头疼。有解决办法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-20T03:00:12.380

> 此语法无效：

谁说的？采样器数组肯定是有效的（取决于版本）。你如何*使用*它们是另一回事。

GLSL 1.20 及更低版本不允许采样器数组。

在 GLSL 1.30 到 3.30 中，您可以拥有采样器数组，但对索引有严格的限制。索引*必须*是一个整数常量表达式。因此，虽然您可以*声明*一个采样器数组，但您不能*循环*遍历它。

GLSL 4.00 及更高版本允许索引是“[动态统一积分表达式](https://www.opengl.org/wiki/Dynamically_Uniform_Expression)”。该术语基本上意味着着色器的所有实例化（在同一个绘制调用中）必须获得相同的值。

因此，您可以在 GLSL 4.00+ 中循环遍历一个恒定范围，并使用循环计数器索引一个采样器数组。您甚至可以从统一变量中获取索引。您*不能*做的是让索引依赖于着色器阶段的输入（除非该值在渲染命令引起的所有实例中都相同），或者来自从纹理访问派生的值（除非该值是由渲染命令引起的所有实例都相同），或其他东西。

对放置在采样器数组中的纹理的唯一要求是它们与采样器类型匹配。所以你必须在数组`GL_TEXTURE_2D`的所有元素上使用 a 。`sampler2D`除此之外，纹理可以有任意数量的差异，包括大小。数组的存在是为了使编码更容易；它不会改变那里的语义。

请记住：采样器数组中的每个单独元素都需要绑定到自己的纹理图像单元。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T00:16:50.780

> 无论如何都有一个可索引的采样器数组，其中每个纹理的大小不同？

还没有。也许这会被添加到以后的 OpenGL 版本中，但我对此表示怀疑。

> 但是我无法遍历它们，这真是让人头疼。有解决办法吗？

作为一种解决方法，您可以使用[阵列纹理](http://www.opengl.org/wiki/Array_Texture)并仅使用每一层的子区域。使用一个 vec4 数组来存储每一层上每张图片的边界。

# ios - 如何根据相机的位置变换图像

> ID：12030715
> 
> 赞同：4
> 
> 时间：2012-08-19T23:10:18.870
> 
> 标签：ios, image, camera, transformation, perspective

我正在尝试根据外观方向创建图像的透视投影。我在这个领域没有经验，但是我自己无法做到这一点。请你帮帮我好吗？

有一个图像和一个观察者（相机）。如果相机可以被认为是一个不可见球体上的物体，而图像是一个穿过球体中间的平面，那么相机位置可以表示为：

> x = d cos(θ) cos(φ)
> 
> y = d sin(θ)
> 
> z = d sin(φ) cos(θ)

其中 θ 是纬度，φ 是经度，d 是距图像中心所在球体中心的距离（半径）。

我在某个地方找到了这些公式，但我不确定坐标（我不知道，但在我看来 x 应该是 z，但我想它取决于坐标系）。

现在，我需要做的是对我的图像进行适当的转换，使其看起来好像是从相机（以正确的视角）观看的。你能告诉我几句话，这是怎么做到的吗？我应该采取哪些步骤？

我正在开发一个 iOS 应用程序，我想我可以使用 QuartzCore 中的以下方法。但我不知道我应该将什么角度传递给这个方法，以及如何从相机位置推导出新的 x、y、z 坐标。

```
CATransform3D CATransform3DRotate (CATransform3D t, CGFloat angle,
    CGFloat x, CGFloat y, CGFloat z) 
```

到目前为止，我已经通过以下方式成功创建了一个简单的查看透视图：

> 1.  使用 .m34 设置为 1/-1000 的单位矩阵（作为 CATransform3D 参数），
> 2.  使用 (0, 1, 0) 向量将我的图像旋转 φ 的角度，
> 3.  将结果与旋转 θ 和 (1, 0, 0) 向量连接起来，
> 4.  基于 d 的缩放被忽略（我根据其他一些标准缩放图像）。

但是我得到的结果不是我想要的（这很明显）：-/。只要这两个角度中的一个接近 0，透视图看起来就很逼真。因此我认为有一种方法可以以某种方式计算出适当的角度以及 x、y 和 z 坐标以实现适当的变换（这可能是错误的，因为这只是我的猜测）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T22:42:49.910

我想我设法找到了解决方案，但不幸的是基于我自己的计算、想法和实验，所以我不知道它是否正确。似乎还可以，但你知道...

所以如果坐标系是这样的： ![在此处输入图像描述](../Images/b36c1b41a5d886a79360cdcba5a98cc1.png)

待变换图像的平面经过X轴和Y轴，其中心在系统原点，则坐标如下：

> x = d sin(φ) cos(θ)
> 
> y = d sin(θ)
> 
> z = d cos(θ) cos(φ)

定义一个向量，该向量从坐标系的原点开始，指向正在观察图像的相机的位置。*d*可以设置为 1，因此我们无需进一步归一化即可立即获得单位向量。Theta 是 ZY 平面中的角度，phi 是 ZX 平面中的角度。Theta 从 Z+ 到 Y+ 轴从 0° 上升到 90°，而 phi 从 Z+ 到 X+ 轴从 0° 上升到 90°（并且在两种情况下都在相反的方向上上升到 -90°）。

因此变换向量为：

> x1 = -y / z
> 
> y1 = -x / z
> 
> z1 = 0。

**我不确定 z1 = 0**，但是围绕 Z 轴的旋转对我来说似乎是错误的。

最后要计算的是图像必须转换的角度。在我看来，这应该是指向相机的向量 (x, y, z) 和垂直于图像的向量之间的角度，即 Z 轴 (0, 0, 1)。

两个向量的点积给出了它们之间夹角的余弦，所以夹角为：

> α = arccos(x * 0 + y * 0 + z * 1) = arccos(z)。

因此，alpha 角度和 x1、y1、z1 坐标是我在问题中提到的 CATransform3DRotate 方法的参数。

如果有人能告诉我这种方法是否正确，我将不胜感激。非常感谢！

# code-organization - 组织科学数据和代码 - 实验、模型、模拟、实施

> ID：12030732
> 
> 赞同：3
> 
> 时间：2012-08-19T23:14:57.127
> 
> 标签：code-organization, scientific-computing, project-organization, suite, scientific-software

我正在从事一个机器人研究项目，并且想知道：在组织科学数据和代码时，是否有人对最佳实践有建议？有谁知道现有的科学图书馆有我可以检查的来源？

以下是我们“套件”的元素：

*   实验 - 两种类型：
    1.  从现有的“自然”系统中收集数据。
    2.  来自机器人系统运行行为的数据。
*   楷模
    *   动态系统描述 - 动力学、运动学等
    *   所述系统的参数，其中一些来自类型 1 实验
*   模拟——试图模拟自然行为，模拟机器人上的行为
*   实现 - 用于控制机器人的代码。当然，这是一项艰巨的任务，并且拥有自己的大型基础设施。

我们的“套房”的一些设计方面：

*   如果仿真环境允许“快速原型设计”（脚本/交互式提示，用于简单的黑客攻击、快速数据检查等——绝对是难以整合的东西）——目前通过脚本语言（Python、MATLAB）满足
*   多种编程语言
*   分布式、协作设置 - 将使用 Git
*   单元测试尚未合并，但希望稍后会合并
*   跨平台（不幸的是）——我习惯于 Linux，但我的团队成员使用 Windows，我们的一些工具与该平台结合

看了[这篇](https://stackoverflow.com/questions/3769372/best-practices-when-implementing-a-scientific-simulation-methodology-from-scratc)文章，书看起来很有趣，我订购了“编写科学软件”，但我觉得它将主要关注模拟代码的实现，而不是整体组织。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-06T10:17:52.370

你描述的情况与我们表面动力学实验室的情况非常相似。一些工作涉及保存实时分析的测量数据，或保存以供后期分析。另一方面，其他一些工作涉及运行模拟并分析其结果。

实验室负责人在剑桥学习期间采用的数据管理方案以一个主服务器为中心，该服务器保存所有实验室成员的个人文件。每个成员通过使用 NFS 安装适当的服务器文件夹从他的工作站访问文件。这有它的优点和缺点。备份所有内容更容易，但在通过网络处理大量数据时会出现问题。出于这个原因，我在实验室中是个例外，因为我使用的模拟会生成大量数据。这个数据保存在我的工作站上，只有用于生成它的代码（模拟和配置文件的源代码）保存在服务器上。

我还将我的代码保存在在线 SVN 服务中，因为我无法从家里登录到实验室服务器。这是一种强制性做法，它源于需要能够根据需求重现较旧的结果，并在出现一些晦涩的错误时跟踪对代码的更改。因此需要维护旧版本和配置文件。

我们还采用低技术方法，例如实验室笔记本来记录结果、修改等。这些内容有时可能更抽象（没有必要描述代码中的每一行更改 - 您对此有差异。只是更改的目的，也许一些关于实现及其日期的注释）。

工作主要是用 Matlab 完成的。同样，我是一个例外，因为我更喜欢 Python。我还使用 C 进行数据生成模拟。测试主要是收敛，因为我的项目现在关注与计算模型的比较。我只是用不同的配置生成结果，保存在他们自己尊重的文件夹中（我在我的实验室日志中跟踪）。这样做的好处是能够完全按照我的意愿控制和连接数据，而不是遵循别人的想法和格式。

# jquery - 如何在未来元素上触发 jQuery 函数

> ID：12030735
> 
> 赞同：1
> 
> 时间：2012-08-19T23:15:23.507
> 
> 标签：jquery

我有一个页面，其中一些推文是从 Twitter 动态获取的。这就像一个新闻行情。整个页面在这里[http://jsfiddle.net/R6D4R/](http://jsfiddle.net/R6D4R/)。

该页面在 jsfiddle 中工作，因为内容已经在那里，而实时站点上的内容是动态放置到 div 中的。ticker() 函数仍然有效，但 if 语句没有生效。谁能帮我解决这个问题？

编辑：

对不起，伙计们，我没有澄清为什么要使用 if 语句。该功能独立工作，但我不希望该功能在只有一条推文时运行。这就是为什么我有`if (tickerli.length != 1)`. 我可能应该使用 > 1 而不是 != 1，但你明白了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T23:18:45.927

[http://api.jquery.com/delegate/](http://api.jquery.com/delegate/)

就是这张票！！代表不止一次救了我的命。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:44:53.650

好的，完全重做我的答案，因为我对您的要求感到困惑：

要处理函数中动态添加的元素`ticker()`，您必须在每次调用函数时重新评估选择器，如下所示：

```
$(function(){
    function ticker() {
        var tickerLi = $('.tweet_list li');
        if (tickerLi.length > 1) {
            tickerLi.first().fadeOut(function() {
               $(this).appendTo($('.tweet_list')).fadeIn();
            });
        }
    }

    setInterval(ticker, 2000);
} 
```

* * *

当我认为您需要有关动态添加元素的事件处理方面的帮助时，这是上一个答案。

要安装将在将来动态添加的元素上工作的事件处理程序，您需要使用委托事件处理。为此，您可以使用：

```
$(static parent selector).on(event, selector of dynamic element, fn); 
```

注意：有两种形式`.on()`，一种是静态的，一种是动态的（使用委托事件处理）。要使用动态事件处理，请将`.on()`处理程序绑定到非动态的父元素，然后传递（作为`.on()`与动态元素匹配的选择器的第二个参数）。

在您的 jsFiddle 中，对于推文文本的点击处理程序，它的工作方式如下：

```
$('twitter-container-34').on('click', '.tweet_text', function() {
    // your event handling code here
}); 
```

注意：jQuery`.on()`是在 jQuery v1.7 中添加的。对于早期版本的 jQuery，请使用`.delegate()`.

# php - 首先按反向数字对数组进行排序，然后按字母顺序？

> ID：12030738
> 
> 赞同：1
> 
> 时间：2012-08-19T23:15:41.807
> 
> 标签：php, arrays

我有一个数组，它有一个编号键，后跟一个名称，语法如下：

```
[50-Aname] => arraydata
[45-Anothername] => arraydata
[45-Bname] => arraydata
[30-Cname] => arraydata 
```

通过使用 krsort()，我可以将数组排序为高分表（倒数）。但这意味着，如果它们具有相同的编号，则 Bname 将出现在 Anothername 之前，因为它也按字母顺序倒序排列。

那么，有没有办法将数字从大到小排序，但也可以按字母顺序排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:22:54.260

您可以使用`uksort()`和定义一个函数作为键的比较器，基于该比较器进行排序。

简而言之，该函数应该用“-”拆分键，然后使用 2 个组件创建一个总订单。

的文档`uksort`：[http ://www.php.net/manual/en/function.uksort.php](http://www.php.net/manual/en/function.uksort.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T00:16:44.383

对于这种类型的问题，我会将这些数据放入数据库并对其进行排序。

```
 mysql_query("SELECT * FROM table_name ORDER BY score DESC, name ASC"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:33:53.810

在该数组结构上使用`ksort()`会产生您想要的。我正在运行 PHP v5.3.13。

```
$to_be_sorted = array(
    "50-Aname" => 123,
    "45-Bname" => 123,
    "45-Cname" => 123,
    "45-Anothername" => 123,
    "30-Cname" => 123
);

ksort($to_be_sorted);
var_dump($to_be_sorted); 
```

结果：

```
array(5) {
  ["30-Cname"]=>
  int(123)
  ["45-Anothername"]=>
  int(123)
  ["45-Bname"]=>
  int(123)
  ["45-Cname"]=>
  int(123)
  ["50-Aname"]=>
  int(123)
} 
```

# python - 如何更改构建配置以使 cmd 指向 python 解释器的实际位置？

> ID：12030746
> 
> 赞同：4
> 
> 时间：2012-08-19T23:18:01.697
> 
> 标签：python, path, interpreter, sublimetext2

当我尝试通过 Sublime Text 2 运行 python 或任何语言时，它所说的只是

```
[Error 2] The system cannot find the file specified
[cmd:  [u'python', u'-u', u'C:\\Users\\Owner\\Desktop\\RandomStuff\\python\\java\\bob.java']]
[dir:  C:\Users\Owner\Desktop\RandomStuff\python\java]
[path: C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\QuickTime\QTSystem\;C:\Program Files\Java\jdk1.7.0_03\bin]
[Finished] 
```

我被告知要更改我的构建配置，以便命令提示符转到 python 解释器，但是更改路径环境变量除了添加之外绝对没有任何作用

```
;C:\Python27\python 
```

到列表中。这真的很令人沮丧，因为我正在尝试用 Python 制作游戏，但我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T23:20:54.307

路径是目录列表，而不是文件。您应该添加`c:\Python27`到您的路径，而不是`c:\Python27\python`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T12:02:26.090

从以下链接[http://www.python.org/download/releases/](http://www.python.org/download/releases/)安装 python 后，您必须更新您的环境变量：

1.  点击开始
2.  右键单击计算机
3.  点击高级系统设置
4.  点击环境
5.  在系统变量上定位路径
6.  点击编辑
7.  将 ;C:\Python32\ 附加到值的末尾或安装程序安装 Python 的任何位置

确保在执行此操作后重新启动 sublime，否则仍然会出现错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:25:32.983

该问题与在可执行路径中找不到 python 命令有关。您可以将 sublime 显式指向 python 可执行文件，或者您可以只修复 env 路径。第二个更重要的是正确设置您的通用 python。

```
C:\Python27\;C:\Python27\Scripts\ 
```

第一个位置包含 python.exe，第二个位置包含指向该 exe 的“python”脚本。这将允许使用“python”的命令工作。

# php - 为没有索引文件的所有目录加载自定义 php 文件

> ID：12030753
> 
> 赞同：0
> 
> 时间：2012-08-19T23:19:33.147
> 
> 标签：php, apache

目前，我使用 PHP 脚本列出没有索引文件的目录的内容，但我不想将其复制到没有索引的每个目录。

Apache可以自动完成吗？

编辑：在搜索更多之后，我找到了一种方法，即放置 Option -Indexes，然后将该 php 文件用作自定义 403 页面。来源：[https ://stackoverflow.com/a/10988954/649239](https://stackoverflow.com/a/10988954/649239)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:22:35.243

您确实需要一个强有力的理由来执行此操作，但假设您有一个......
只需有一个接受目录作为参数并使用它来打印出来的 php 文件。
你也可以让它递归地显示所有子目录:) 现在你让我兴奋了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T01:19:19.260

在搜索更多之后，我找到了一种方法，即放置 Option -Indexes，然后将该 php 文件用作自定义 403 页面。

# mysql - 我可以在没有数据库连接的情况下使用 DBD::mysql quote() 函数吗？

> ID：12030754
> 
> 赞同：8
> 
> 时间：2012-08-19T23:19:48.447
> 
> 标签：mysql, sql, perl

我正在使用 Perl 编写一个 .sql 文件，而不是直接写入 mysql 数据库。我需要引用该文件中的字符串。看起来 $dbh-quote() 方法可以满足我的要求。除了我不知道如何在没有数据库连接的情况下使用它。我会建立一个虚拟连接，但如果没有数据库运行，我似乎无法做到这一点，而且要运行这个 cron 作业的机器也没有。

这个问题类似：[Perl DBI without access the database](https://stackoverflow.com/questions/6670102/perl-dbi-without-accessing-the-database) and the accepted answer指出“您可能会尝试加载您需要的驱动程序并直接调用该函数”，这是我想做的，但我不知道怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T00:45:30.887

可靠的引用要求驱动程序理解连接的字符集/排序规则，因为转义会根据该信息而变化。

这就是为什么在 PHP 中 mysql_escape_string() 被替换为 mysql_real_escape_string()，它使用数据库连接属性来正确地转义输入字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-19T23:28:34.890

听起来您将不得不弄清楚做什么`quote`并自己实施。无法访问真正的数据库连接可能会成为阻碍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T13:48:18.277

听起来答案是响亮的“你做不到”。无论如何，这里是我根据 mysql 文档[http://dev.mysql.com/doc/refman/5.0/en/string-literals.html](http://dev.mysql.com/doc/refman/5.0/en/string-literals.html)关于需要引用的内容的引用函数。

我的输入是 UTF-8，perl 在内部以 UTF-8 存储字符串，我的输出是 UTF-8，我的数据库是 UTF-8。鉴于字符集是一致的，我不需要为转义目的而担心太多。

```
sub quote(){
    my ($s) = @_;
    $s =~ s/\\\\/\\/g;
    $s =~ s/\'/\\'/g;
    $s =~ s/\"/\\"/g;
    $s =~ s/\x08/\\b/g;
    $s =~ s/\n/\\n/g;
    $s =~ s/\r/\\r/g;
    $s =~ s/\t/\\t/g;
    $s =~ s/\x1A/\\Z/g;
    return $s;
} 
```

我测试了这个功能，它似乎做了我想要的。太糟糕了，这样的东西不能从已经编写好的库中访问。

# ruby-on-rails - 带有 Youtube API 请求的 Fancybox

> ID：12030760
> 
> 赞同：0
> 
> 时间：2012-08-19T23:20:56.690
> 
> 标签：ruby-on-rails, youtube, fancybox

我希望从 youtube API 中提取的视频列表在花式框中打开。但是现在，当您单击图像时，它只会重定向到 youtube 站点。

这是相关的代码。html.erb

```
<% @youtube_news.each do |item| %>
        <li>
          <% you_tube_presenter_for(item) do |presenter| %>
              <span class="center videos">
               <%= link_to image_tag(presenter.thumbnail_url), presenter.video_url, :class=> "fancyboxv"  %>
              </span>
              <%= presenter.title %>
              <span class="timestamp">
               Posted <%= time_ago_in_words(presenter.published_date) %> ago
              </span>                                     
          <% end %>
        </li>
    <% end %> 
```

和同一页面上的 JS-

```
<script>
$(document).ready(function(){
 $("a.fancyboxv").fancybox({
    'transitionIn'   : 'none',
    'transitionOut'  : 'elastic',
    'width'          : '640',
    'height'         : '480',
    'href'           : this.href.replace(new RegExp("watch\\?v=", "i"), 'v/'),
      'type'         : 'swf'
      'swf'          :{
             'wmode'          :'transparent',
             'allowfullscreen':'true'
      }
    });

 return false;
});
</script> 
```

我在这里想念什么？提前感谢您对此的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T08:08:09.313

尝试

```
$(document).ready(function(){
 $("a.fancyboxv").click(function() {
  $.fancybox({
   'transitionIn'   : 'none',
   'transitionOut'  : 'elastic',
   'width'          : '640',
   'height'         : '480',
   'href'           : this.href.replace(new RegExp("watch\\?v=", "i"), 'v/'),
   'type'           : 'swf',
   'swf'            : {
     'wmode'           : 'transparent',
     'allowfullscreen' : 'true'
    }
  }); // fancybox
  return false;
 }); // click
}); //  ready 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T16:54:11.333

这就是为我解决的问题：[https ://stackoverflow.com/a/10882262/470749](https://stackoverflow.com/a/10882262/470749)

```
$(".youtube").click(function() {
            var destination = $(this).attr('href').replace(new RegExp('youtu.be', 'i'), 'www.youtube.com/embed').replace(new RegExp('watch\\?v=([a-z0-9\_\-]+)(&|\\?)?(.*)', 'i'), 'embed/$1?version=3&$3');
            $.fancybox({
                'padding'       : 0,
                'autoScale'     : false,
                'transitionIn'  : 'elastic',
                'transitionOut' : 'none',
                'title'         : $(this).attr('title'),
                'width'         : 680,
                'height'        : 495,
                'href'          : destination,
                'type'          : 'iframe'
            });
            return false;
        }); 
```

HTML： `<a class="youtube" href="//www.youtube.com/watch?v=XXXXXX&html5=1&autoplay=1#t=3s" target="_blank">link label</a>`

我的目标是让链接的 Youtube 视频弹出一个 Fancybox，即使没有安装 Flash，它也会自动开始播放视频并在 IE/Chrome/Firefox/Safari 中工作。我刚刚在禁用 Flash 的 IE9 中对其进行了测试，它可以正常工作。

# apache - 简单的 htaccess 重定向

> ID：12030761
> 
> 赞同：1
> 
> 时间：2012-08-19T23:21:29.743
> 
> 标签：apache, .htaccess, redirect

我有一个标准的 Drupal 站点，出于 SEO 原因需要添加重定向规则

我需要将 /salon/whatever 重定向到 /salon-locator/whatever

这就是我目前所拥有的，但我似乎得到了多个重定向

```
 RewriteEngine on

  Redirect permanent /salon/ /salon-locator/

  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_URI} !=/favicon.ico]
  RewriteRule ^(.*)$ index.php?q=$1 [L,QSA] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:07:25.730

您需要在这里坚持使用 mod_rewrite，因为在 mod_alias 处理`Redirect`指令后，URI 继续通过路径处理管道，并且 mod_rewrite 获取并破坏它。如果您只使用 mod_rewrite，您可以在使用`L`标志重定向后告诉重写引擎停止。所以你想替换：

```
Redirect permanent /salon/ /salon-locator/ 
```

有了这个：

```
RewriteRule ^salon/(.*)$    /salon-locator/$1 [L,R=301] 
```

# c# - 在运行时更改 jQuery-Mobile 属性

> ID：12030764
> 
> 赞同：0
> 
> 时间：2012-08-19T23:21:41.500
> 
> 标签：c#, asp.net, jquery-mobile

我试图找出一种在运行时更改 jQuery-Mobile 属性的方法，特别是数据图标值。这是我的 HTML：

```
 <asp:HyperLink ID="HyperLink2" 
                    runat="server" 
                    data-role="button" 
                    data-transition="fade" 
                    data-theme="b" 
                    class="ui-btn-right" 
                    data-icon="delete" 
                    data-iconpos="right" 
                    href="#page1">HyperLink2</asp:HyperLink> 
```

这是我在代码后面尝试的内容，但我无法访问该特定值：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        this.HyperLinkExit.Text = "Refresh";
        HtmlGenericControl HyperLinkItem = Master.FindControl("HyperLinkExit") as HtmlGenericControl;
        HyperLinkItem.data-icon = "refresh";
    } 
```

我确信有一些方法可以让我改变这个值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:34:46.490

`data-icon`不是 的属性`HtmlGenericControl`。请改用该`Attributes`属性：

```
HyperLinkItem.Attributes["data-icon"] = "refresh"; 
```

# php - 解析错误：语法错误，意外的 T_STRING in .... 第 192 行

> ID：12030766
> 
> 赞同：1
> 
> 时间：2012-08-19T23:22:05.423
> 
> 标签：php, string, syntax-error, goto

我有这个错误：

> 解析错误：语法错误，第 192 行 /home/u1/public_html/scripts/easypanel.php 中的意外 T_STRING

当我在本地运行它时它可以工作，但在真实服务器上它不是：

**第 192 行是**：

```
if(isset($_POST['send_pass']))
{
    if($_POST['post_password'] == $password)
    {
        goto content;# = line 192   
    }
    else 
    {
        echo '<div class="box error">password incorrect</div><br>';
    }
}

...

content: 
    echo $content; 
```

有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:55:09.430

goto 运算符从 PHP 5.3 开始可用。

请在本地检查您的php版本。

您可以`php -v`在终端中输入以查看版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T12:14:04.053

你说你的服务器版本是5.2。这就是造成问题的原因。“goto”是在 5.3 中引入的。因此，您可以要求升级服务器版本或完全停止使用 goto，因为 5.2 不支持它。它在本地运行良好，因为在本地您使用的是 PHP 5.3 版

# scripting - 为什么要将lua嵌入到游戏引擎中？

> ID：12030767
> 
> 赞同：4
> 
> 时间：2012-08-19T23:22:19.283
> 
> 标签：scripting, lua, embed

我一直在研究从头开始构建一个基本的游戏引擎，在列出了其他引擎共有的功能列表之后，更重要的事情之一是它们具有嵌入式脚本语言，如 lua 或 python。

我的问题是嵌入式脚本语言如何优于仅制作用户可以包含在 c++ 文件中的头文件（或类似的东西），从而使他们能够访问许多功能和状态。我敢肯定那里有一个很好的答案，只是我还没有偶然发现。

除了为什么需要它之外，像 lua 这样的语言用于游戏引擎之类的东西是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T01:51:23.060

Lua 是一种比 C++ 简单得多的语言，编辑它所需要的只是一个文本编辑器。这将脚本事件和/或高级游戏逻辑的能力交到您的设计师和最终用户手中。动态类型和垃圾收集允许他们编写非常简洁的代码，专注于游戏逻辑，而不是像 C++ 这样的语言中获得的所有系统级的家务琐事。沙盒也容易得多。

Lua 是一种流行的选择，因为它是小型、可移植、可破解的 ANSI C 代码库；易于嵌入、扩展，而且——对于游戏开发者来说最重要的是——它具有最小的运行时占用空间（最快的解释语言之一）。它也是易于学习/读/写语法的完美组合，但具有强大的功能，例如在游戏中非常有用的协程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T00:16:47.993

包含脚本语言的原因是允许用户自定义行为而无需重新编译代码。

我不确定您在问题的第二部分中要问什么。您是在问使用了哪些其他语言，还是在问像 Lua 这样的语言使用了哪些方式？

如果您询问其他哪些语言对此有好处，那么其中一种语言就是 Tcl。Tcl 从一开始就被设计为一种嵌入式脚本语言，非常成熟和健壮，非技术人员很容易学习。

至于哪些脚本语言适合……配置文件是一种方法。通过使用编程语言而不是具有名称/值对的文本文件，它允许用户将逻辑添加到他们的启动文件中。例如，也许您允许用户为键盘上的按键分配不同的功能；使用编程语言，他们可以为不同的计算机添加不同的功能。或者，如果您正在创建类似 RPG 的游戏，也许您可​​以为不同的角色类别分配不同的键。如果玩法师，F12​​可能会施法，但如果玩战士，f12可能会做最后一击。

有许多方法可以使用脚本语言，并且有许多不同的语言可供选择。这一切都归结为允许您的用户自定义游戏的行为，而无需重新编译代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T07:17:54.173

您可能会发现游戏开发人员撰写的这篇文章有助于理解为什么使用嵌入式语言。

[http://www.grimrock.net/2012/07/25/making-of-grimrock-rapid-programming/](http://www.grimrock.net/2012/07/25/making-of-grimrock-rapid-programming/)

另一个很好的理由是，除非您与游戏用户共享源代码并且他们都是 C 程序员，否则 lua 等语言使用户可以扩展游戏，例如看魔兽世界。

# java - 使用 RandomAccessFile 通过 Internet 下载文件

> ID：12030768
> 
> 赞同：0
> 
> 时间：2012-08-19T23:22:24.853
> 
> 标签：java, download, random-access

我在 Internet 上浏览随机 Java 代码，并找到了[下载管理器](http://www.java-tips.org/java-se-tips/javax.swing/how-to-create-a-download-manager-in-java.html)的源代码。它用于`RandomAccessFile`下载文件。我无法弄清楚的一件事是它会下载到哪里。这是下载文件的方法：

```
public void startDownload() {
    System.out.println("Starting...");
    RandomAccessFile file = null;
    InputStream stream = null;

    try {
        URL downloadLink = new URL("http://www.website.com/file.txt");

        // Open the connection to the URL
        HttpURLConnection connection = (HttpURLConnection) downloadLink.openConnection();

        // Specify what portion of file to download
        connection.setRequestProperty("Range", "bytes=" + downloaded + "-");

        // Connect to the server
        connection.connect();

        // Make sure the code is in the 200 range
        if (connection.getResponseCode() / 100 != 2) {
            error();
        }

        // Check for valid content length
        int contentLength = connection.getContentLength();
        if (contentLength < 1) {
            error();
        }

        // Set the size for the download if it hasn't been already set
        if (size == -1) {
            size = contentLength;
            stateChanged();
        }

        // Open file and seek to the end of it
        file = new RandomAccessFile(getFileName(downloadLink), "rw");  
              // getFileName returns the name of the file mentioned in the URL

        file.seek(downloaded);

        stream = connection.getInputStream();

        while (status == DOWNLOADING) {
            System.out.println("Progress: " + getProgress() + "%");

            // Size the buffer according to how much of the file is left to download
            byte buffer[];
            if (size - downloaded > MAX_BUFFER_SIZE) {
                buffer = new byte[MAX_BUFFER_SIZE];
            } else {
                buffer = new byte[size - downloaded];
            }

            // Read from the server into the buffer
            int read = stream.read(buffer);
            if (read == -1) {
                break;
            }

            // Write buffer to file
            file.write(buffer, 0, read);
            downloaded += read;
            stateChanged();
        }

        if (status == DOWNLOADING) {
            status = COMPLETE;
            stateChanged();
        }

    } catch (Exception e) {
        error();
    } finally {
        // Close the stream and RAF
    }
    System.out.println("Done!");
} 
```

如果这很明显，我很抱歉。我是`RandomAccessFile`班上的新手，因为我今天才知道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T23:26:38.757

它将下载到当前工作目录（即运行 java 命令的位置），文件名将由`getFileName(downloadLink)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T22:17:17.510

我对此也很陌生。getFileName 似乎是同一类中的一个方法，并且缺少该代码。

# c++ - 构造具有 const 成员的对象时调用另一个构造函数

> ID：12030769
> 
> 赞同：5
> 
> 时间：2012-08-19T23:22:33.443
> 
> 标签：c++, constructor, constants

我有一个带有`const`成员的类，一个构造函数调用另一个填充了额外值的构造函数。通常我可以为此使用冒号初始化程序，但该函数很复杂（`printf`/ `sprintf`-like）并且需要我在堆栈上使用一个变量，所以我必须在构造函数的主体中执行此操作并使用分配`*this`给新对象。但这当然是无效的，因为我的成员变量是`const`.

```
class A
{
public:
    A(int b) : b(b), c(0), d(0) // required because const
    {
        int newC = 0;
        int newD = 0;
        myfunc(b, &newC, &newD);
        *this = A(b, newC, newD); // invalid because members are const

        // "cannot define the implicit default assignment operator for 'A', because non-static const member 'b' can't use default assignment operator"
        // or, sometimes,
        // "error: overload resolution selected implicitly-deleted copy assignment operator"
    };
    A(int b, int c, int d) : b(b), c(c), d(d) { };

    const int b;
    const int c;
    const int d;
};

A a(0); 
```

（我没有明确删除赋值运算符。）我声明成员 const 是因为我希望它们是公共的，但不是可变的。

是否有一些规范的方法可以解决这个问题，而不使用可怕的演员表和强制压倒成员的能力`const`？这里最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:27:00.907

制作一个辅助函数怎么样：

```
class A
{
    static int initializor(int b) { int n; myfunc(b, &n); return n; }
public:
    explicit A(int b_) : b(b_), c(initializor(b_)) { }
    A(int b_, int c_)  : b(b_), c(c_)              { }

    // ... as before ...
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T00:46:33.383

您可以添加参数类并使用 C++11 构造函数委托或基类：

```
struct parameters {
    int b; int c; int d;
    parameters(int b): b(b), c(), d() {
        myfunc(b, &c, &d);
    }
};

// constructor delegation
class A {
public:
    A(int b): A(parameters(b)) { }
    A(parameters p): b(p.b), c(p.c), d(p.d) { }
};

// base/wrapper
class ABase {
    ABase(parameters p): b(p.b), c(p.c), d(p.d) { }
};

class A: public ABase {
public:
    A(int b): ABase(parameters(b)) { }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T00:47:03.767

我更喜欢[Kerrek SB's answer](https://stackoverflow.com/a/12030792/396551)，但在你的情况下，你不能轻易地为每个成员创建单独的初始化函数。

在这种情况下，另一种解决方案是将成员移动到基类并使用具有非 const 成员的辅助类初始化该基类。您的初始化代码已移至帮助程序类的构造函数，并且可以毫无问题地分配。

```
class A_init
{
  public:
    A_init(int b)
    {
      // do whatever you like with c and d:
      c = ...;
      d = ...;
    }

    int c; // Note: non-const
    int d; // Note: non-const
};

class A_base
{
   public:
     A_base(int b, A_init init) : b(b), c(init.c), d(init.d) {}
     A_base(int b, int c, int d) : b(b), c(c), d(d) {}

     const int b;
     const int c;
     const int d;
};

class A : public A_base
{
  public:
    A(int b) : A_base(b, A_init(b)) {}
    A(int b, int c, int d) : A_base(b, c, d) {}
}; 
```

如果想限制访问`A_init`，可以切换到私有并声明`A`朋友。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-19T23:46:10.267

将结果放在哪里，`myfunc`以便可以从不同的 mem-initializers 设置和使用它？在默认参数中怎么样？

```
class A
{
private:
    struct InitData;
public:
    A(int b, InitData data=InitData());
    A(int b, int c, int d) : b(b), c(c), d(d) { };

    const int b;
    const int c;
    const int d;
};

struct A::InitData
{
    int setup(int b);
    int c;
    int d;
};

inline int A::InitData::setup(int b)
{
    myfunc(b, &c, &d);
    return b;
}

inline A::A(int b_, InitData data)
    : b(data.setup(b_)),
      c(data.c),
      d(data.d)  {}

A a(0); 
```

由于组成的类型是私有的并且没有转换，因此意外使用或滥用它的风险很小。

# c++ - 将控制器引用/指针添加到 C++ 单例类

> ID：12030774
> 
> 赞同：0
> 
> 时间：2012-08-19T23:23:02.030
> 
> 标签：c++, ios, pointers, reference, member

我有一个名为playbackhelper 的单例类，我想向其中添加一个成员，该成员是对viewcontroller 的引用。但我不认为我可以让成员成为参考，因为我希望能够更改我链接到的控制器，而且我认为参考是不可能的。

这是我的控制器：

```
@interface InstrumentGridViewController : UIViewController {

}
-(void) someMethod;
@end 
```

这是我的单例类，我想要一个成员，它是指向控制器的某种指针。

```
class PlaybackHelper{

private:

    // Singleton methods
    PlaybackHelper();
    PlaybackHelper(PlaybackHelper const&);
    void operator=(PlaybackHelper const&);

public:

    static PlaybackHelper &getInstance();

    // ((((some InstrumentGridViewController member here))))
    InstrumentGridViewController controllerMember;
} 
```

所以我的问题是：如何将它们相互链接/如何创建指向控制器的成员以及如何初始化它？

**编辑：**基本上我希望能够从单例类调用控制器方法，如下所示：

```
[PlaybackHelper::getInstance().controllerMember someMethod]; 
```

但我不知道如何设置我的单例以使这成为可能。现在在示例中设置的方式将是`controllerMember`控制器对象的副本，这不是我想要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:54:37.217

撇开关于单例使用的争论不谈，如果你使用 ARC，你可以很容易地在 C++ 类中使用 ObjC 对象，并且内存管理得到了照顾。

如果你想让它成为一个访问器......

```
class PlaybackHelper{
private:
    // ... other stuff...
    InstrumentGridViewController *_instrumentGridViewController;

public:
    InstrumentGridViewController *controllerMember() {
        return _instrumentGridViewController;
    }
};

[PlaybackHelper::getInstance().controllerMember() someMethod]; 
```

如果你只是想让它成为一个公共成员......

```
class PlaybackHelper{
public:
    InstrumentGridViewController *controllerMember;
};

[PlaybackHelper::getInstance().controllerMember someMethod]; 
```

ObjC 对象被认为具有重要的 ctor/dtor，编译器将自动处理 ARC 的东西。

LLVM + ARC + C++ 可以轻松地将 ObjC 对象与 C++ 混合。事实上，你可以做到这一点而不必担心......

```
std::vector<UIView*> listOfViews; 
```

所有的内存管理都是由编译器神奇地安排的。

# gwt - 使用 GWT 加载和绘制的没有任何格式（非标准，只是数据数组）的原始图像数据

> ID：12030775
> 
> 赞同：0
> 
> 时间：2012-08-19T23:23:15.113
> 
> 标签：gwt, image-processing, image-rendering

有人有使用 GWT 进行图像渲染或处理的经验吗？

我被困在 GWT 客户端图像渲染上。由于我需要显示的图像是非标准格式（想象为数据数组），因此我无法在客户端创建 Image 对象来呈现它。我所做的是使用带有 GWT（ImageData 类）的 HTML5 元素设置每个像素的 RGBA 值，这非常慢。我想知道是否有办法提高渲染速度，甚至有更好的方法来渲染原始图像数据？因为，在客户端绘制图像之后，我的下一步是进行一些像素级操作，这也是实时工作所必需的。

# r - R：如何从派对包中旋转 ctreeobj 中的 x 轴标签

> ID：12030781
> 
> 赞同：1
> 
> 时间：2012-08-19T23:25:30.557
> 
> 标签：r, plot, decision-tree, axis-labels

我正在使用`party`包`R`来创建一个包含一些数据的决策树。我的因变量有一些长字符串，因此 x 轴标签的水平表示意味着我的因变量的所有级别都没有显示。

使用包中的`survey`数据`MASS`作为一个简单的示例，`party`加载包：

```
 data(survey)
 #remove missing value
 survey2 <- subset(survey, !is.na(Clap))
 TreeResults <- ctree(Clap ~ Sex + Exer + Smoke, data=survey2)
 plot(TreeResults) 
```

我希望旋转的标签是 for `Clap`，我希望这些标签以 45 度角为每个节点打印。我的真实数据有两个终端节点，就像这个例子一样。

我已经看过了`node_barplot`，但在其中看不到修改 x 轴标签方向的选项。

有人可以建议如何进行标签重定向吗？

提前致谢。

更新：根据建议在侧面打印标签产生了这个图： ![在此处输入图像描述](../Images/01e95cc11f3360f6f3f3edea579ea5cf.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:01:21.763

你想要类似的东西吗？

```
plot(TreeResults,tp_args = list(beside=F)) 
```

UPDATE OP 表明这是不合适的。

不幸的是，我看不到一个简单的解决方法。您可以`node_barplot()`按如下方式重新定义该函数：

```
altbp<-function (ctreeobj, col = "black", fill = NULL, beside = NULL, 
    ymax = NULL, ylines = NULL, widths = 1, gap = NULL, reverse = NULL, 
    id = TRUE,rot=45) 
{
    getMaxPred <- function(x) {
        mp <- max(x$prediction)
        mpl <- ifelse(x$terminal, 0, getMaxPred(x$left))
        mpr <- ifelse(x$terminal, 0, getMaxPred(x$right))
        return(max(c(mp, mpl, mpr)))
    }
    y <- response(ctreeobj)[[1]]
    if (is.factor(y) || class(y) == "was_ordered") {
        ylevels <- levels(y)
        if (is.null(beside)) 
            beside <- if (length(ylevels) < 3) 
                FALSE
            else TRUE
        if (is.null(ymax)) 
            ymax <- if (beside) 
                1.1
            else 1
        if (is.null(gap)) 
            gap <- if (beside) 
                0.1
            else 0
    }
    else {
        if (is.null(beside)) 
            beside <- FALSE
        if (is.null(ymax)) 
            ymax <- getMaxPred(ctreeobj@tree) * 1.1
        ylevels <- seq(along = ctreeobj@tree$prediction)
        if (length(ylevels) < 2) 
            ylevels <- ""
        if (is.null(gap)) 
            gap <- 1
    }
    if (is.null(reverse)) 
        reverse <- !beside
    if (is.null(fill)) 
        fill <- gray.colors(length(ylevels))
    if (is.null(ylines)) 
        ylines <- if (beside) 
            c(3, 2)
        else c(1.5, 2.5)
    rval <- function(node) {
        pred <- node$prediction
        if (reverse) {
            pred <- rev(pred)
            ylevels <- rev(ylevels)
        }
        np <- length(pred)
        nc <- if (beside) 
            np
        else 1
        fill <- rep(fill, length.out = np)
        widths <- rep(widths, length.out = nc)
        col <- rep(col, length.out = nc)
        ylines <- rep(ylines, length.out = 2)
        gap <- gap * sum(widths)
        yscale <- c(0, ymax)
        xscale <- c(0, sum(widths) + (nc + 1) * gap)
        top_vp <- viewport(layout = grid.layout(nrow = 2, ncol = 3, 
            widths = unit(c(ylines[1], 1, ylines[2]), c("lines", 
                "null", "lines")), heights = unit(c(1, 1), c("lines", 
                "null"))), width = unit(1, "npc"), height = unit(1, 
            "npc") - unit(2, "lines"), name = paste("node_barplot", 
            node$nodeID, sep = ""))
        pushViewport(top_vp)
        grid.rect(gp = gpar(fill = "white", col = 0))
        top <- viewport(layout.pos.col = 2, layout.pos.row = 1)
        pushViewport(top)
        mainlab <- paste(ifelse(id, paste("Node", node$nodeID, 
            "(n = "), "n = "), sum(node$weights), ifelse(id, 
            ")", ""), sep = "")
        grid.text(mainlab)
        popViewport()
        plot <- viewport(layout.pos.col = 2, layout.pos.row = 2, 
            xscale = xscale, yscale = yscale, name = paste("node_barplot", 
                node$nodeID, "plot", sep = ""))
        pushViewport(plot)
        if (beside) {
            xcenter <- cumsum(widths + gap) - widths/2
            for (i in 1:np) {
                grid.rect(x = xcenter[i], y = 0, height = pred[i], 
                  width = widths[i], just = c("center", "bottom"), 
                  default.units = "native", gp = gpar(col = col[i], 
                    fill = fill[i]))
            }
            if (length(xcenter) > 1) 
                grid.xaxis(at = xcenter, label = FALSE)
            grid.text(ylevels, x = xcenter, y = unit(-1, "lines"), 
                just = c("center", "top"), default.units = "native", 
                check.overlap = TRUE,rot=rot)
            grid.yaxis()
        }
        else {
            ycenter <- cumsum(pred) - pred
            for (i in 1:np) {
                grid.rect(x = xscale[2]/2, y = ycenter[i], height = min(pred[i], 
                  ymax - ycenter[i]), width = widths[1], just = c("center", 
                  "bottom"), default.units = "native", gp = gpar(col = col[i], 
                  fill = fill[i]))
            }
            if (np > 1) {
                grid.text(ylevels[1], x = unit(-1, "lines"), 
                  y = 0, just = c("left", "center"), rot = 90, 
                  default.units = "native", check.overlap = TRUE)
                grid.text(ylevels[np], x = unit(-1, "lines"), 
                  y = ymax, just = c("right", "center"), rot = 90, 
                  default.units = "native", check.overlap = TRUE)
            }
            if (np > 2) {
                grid.text(ylevels[-c(1, np)], x = unit(-1, "lines"), 
                  y = ycenter[-c(1, np)], just = "center", rot = 90, 
                  default.units = "native", check.overlap = TRUE)
            }
            grid.yaxis(main = FALSE)
        }
        grid.rect(gp = gpar(fill = "transparent"))
        upViewport(2)
    }
    return(rval)
} 
```

所有这一切都是在调用以下内容时添加`rot=`到 调用中：`grid.text``beside=T`

```
plot(TreeResults,terminal_panel=altbp(TreeResults,ylines=1.2, gap=0.05,rot=45)) 
```

![在此处输入图像描述](../Images/6035dcfcac3fd8eecd0eeae8aa84ee9a.png)

概括：

您可以以一种轻松的方式破解该`node_barplot`功能，如下所示：

```
altbp<-node_barplot
body(altbp)[[8]][[3]][[3]][[23]][[3]][[5]]<-substitute(
grid.text(ylevels, x = xcenter, y = unit(-1, "lines"), just = c("center", 
    "top"), default.units = "native", check.overlap = TRUE,rot=45)
)
plot(TreeResults,terminal_panel=altbp(TreeResults)) 
```

并使用`altbp`which 将文本旋转 45 度。

# iphone - Core-Plot：如何更改饼图

> ID：12030783
> 
> 赞同：-1
> 
> 时间：2012-08-19T23:25:40.607
> 
> 标签：iphone, objective-c, core-plot

我正在试验核心情节。我正在尝试弄清楚如何使饼图成为实体并删除 AA 和 BB 之间的空间。有没有好心人可以给我提示？

![好的](../Images/b4b4912cfbfee543ac6b3c877eeec3db.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:29:49.760

要么不在`-radialOffsetForPieChart:recordIndex:`数据源中实现该方法，要么让它为每个索引返回 0.0。

# javascript - How do I make children of conditional form disappear and clear when a different parent is chosen?

> ID：12030787
> 
> 赞同：2
> 
> 时间：2012-08-19T23:25:57.303
> 
> 标签：javascript, jquery, html, forms

感谢您的帮助 - 如果我的标题有点令人困惑，我提前道歉，我很难解释这个问题，甚至找不到解决方案。

我试图为我目前正在构建的模块创建一个条件表单，但由于我缺乏真正的 javascript 知识而陷入瘫痪。

*我目前正在使用的代码可以在以下位置找到：

```
http://jsfiddle.net/jgliesman/MQjf8/3/* 
```

*我想要的表格可以在以下位置找到：

```
http://form.jotform.us/form/22290232014135* 
```

我试图让“迷你代码”做的是（比如 Jotform）......

**如果您更改父级，请清除下拉/输入选择。现在，当您切换到另一个父母时，“迷你代码”并没有隐藏主要父母的“孙子女”。直子消失了，但“孙子”仍然存在**

**如果它隐藏，我还希望它重置下拉/输入选择，因为如果你将它拉回来，所选选项仍然很明显，它只是隐藏了。**

如果您想让我澄清任何事情，请告诉我，我非常感谢您的帮助。

再次感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:31:52.300

试试这个：

```
$(document).ready(function(){
        $("#select1").change(function(){
            if ($(this).val() == "1") {
                $("#hide1").slideDown("fast");     
            } else {   
                $("#hide1").slideUp("fast");    
                $("#hide2").slideUp("fast");
                $("#select2 option:first").prop('selected', true);
                $("#select3 option:first").prop('selected', true);                                
            }
        });    
        $("#select2").change(function(){    
            if ($(this).val() == "1") {    
                $("#hide2").slideDown("fast");   
            } else {    
                $("#hide2").slideUp("fast");       
            }
        });
}); 
```

[小提琴](http://jsfiddle.net/MQjf8/15/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:42:44.083

我更新了你的小提琴：http: [//jsfiddle.net/MQjf8/4/](http://jsfiddle.net/MQjf8/4/)

它与@undifned 建议的相同，但它也考虑了重置。

```
$(document).ready(function(){
        $("#select1").change(function(){

            if ($(this).val() == "1" ) {
                $('#hide1 select').val('(choose one)'); // select default
                $("#hide1").slideDown("fast"); //Slide Down Effect

            } else {

                $("#hide1").slideUp("fast");    //Slide Up Effect
                $("#hide2").slideUp("fast");    //Slide Up Effect
            }
        });

        $("#select2").change(function(){

            if ($(this).val() == "1" ) {
                $('#hide2 select').val('(choose one)'); // select default
                $("#hide2").val('(choose one)').slideDown("fast"); //Slide Down Effect

            } else {

                $("#hide2").slideUp("fast");    //Slide Up Effect

            }
        });
    }); 
```

# php - 如何编写递归ucwords方法

> ID：12030788
> 
> 赞同：4
> 
> 时间：2012-08-19T23:26:24.233
> 
> 标签：php, string

我需要所有单词的大小写正确，首字母大写，其他小写。

我试过了：

```
array_walk_recursive($my_array,'ucwords'); 
```

但我猜这个函数需要是用户定义的。

所以我写道：

```
function ucrecursive($value,$key) {
    return ucwords($value);
}

array_walk_recursive(&$my_array,'ucrecursive'); 
```

还是不行。有任何想法吗？

编辑：样本数据：

```
Array
(
    [0] => Array
        (
            [count] => 768
            [value] => SATIN NICKEL
        )

    [1] => Array
        (
            [count] => 525
            [value] => POLISHED CHROME
        )

    [2] => Array
        (
            [count] => 180
            [value] => AGED BRONZE
        ) 
```

ETC...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T23:36:22.480

```
array_walk_recursive($my_array,function(&$value) {
    $value = ucwords($value);
}); 
```

尝试这个

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T23:31:27.477

自己构建应该很容易：

```
function ucWordsRecursive( array &$array ) {
    foreach( $array as &$value ) {
        if( is_array( $value ) ) {
             ucWordsRecursive( $value );
        }
        else if( is_string( $value ) ){
            $value = ucwords( strtolower( $value ) );
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-27T16:47:32.700

那将是：

```
array_walk_recursive($my_array,function(&$value) {
    $value = ucwords(strtolower($value));
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-16T20:13:41.673

如果有人想在没有任何内置函数的情况下使用递归构建它

```
function capitalizeWords ($array) {
 if (count($array) === 1) {
     return [ucwords($array[0])];
 }
 $res = capitalizeWords(array_slice($array,0,-1));
 array_push($res,ucwords(array_slice($array,count($array)-1)[0]));
 return $res;

}

capitalizeWords(['php','javascript','golang']);` 
```

# java - 获取对象数组的唯一列表

> ID：12030794
> 
> 赞同：1
> 
> 时间：2012-08-19T23:27:42.237
> 
> 标签：java

如何在下面的代码中获取对象数组的唯一列表：

```
 import java.util.*;

    class t1 {
        public static void main(String[] args) {

            Object[] o1 = new Object[] { null, "abc@aaa.com", "ENG", "775778435", 1};
            Object[] o2 = new Object[] { null, "abc@aaa.com", "ENG", "775778435", 1};

            List<Object[]> result = new ArrayList<Object[]>(); 
            result.add(o1); 
            result.add(o2); 

            // The above result list is coming from some DB & I cannot change the structure of above script. 
            // Now, I need to remove the duplicates from this result list meaning I need to find duplicates from the objects within the list.
            // I tried below code but it still prints duplicates. Any help???

            Set<User> setResult = new HashSet<User>();
            User userInfo = null;

            for (Object[] userData : result) {
                userInfo = new User((String)userData[0], (String)userData[1], (String)userData[2], (String)userData[3], (Integer) userData[4]);
                setResult.add(userInfo);
            }

            Iterator it = setResult.iterator();
            while (it.hasNext()) {
                Object o = it.next();

                User u = (User) o;
                System.out.println("non-duplicate = " + u.getEmail());
            }

            // Expected result: non-duplicate = abc@aaa.com
            // Actual   result: non-duplicate = abc@aaa.com getting printed twice i.e. duplicate not getting removed!
        }
    }

    class User {
        public String firstName;
        public String email;
        public String language;
        public String productCode;
        public int status;

        public User() {         
        }

        public User(String fName, String userId, String lang, String productCode, int status) {
            this.firstName = fName;
            this.email = userId;
            this.language = lang;
            this.productCode = productCode;
            this.status = status;
        }   

        public String getFirstName() {
            return firstName;
        }

        public void setFirstName(String firstName) {
            this.firstName = firstName;
        }

        public String getEmail() {
            return email;
        }

        public void setEmail(String email) {
            this.email = email;
        }

        public String getLanguage() {
            return language;
        }

        public void setLanguage(String language) {
            this.language = language;
        }

        public String getProductCode() {
            return productCode;
        }

        public void setProductCode(String productCode) {
            this.productCode = productCode;
        }

        public int getStatus() {
            return status;
        }

        public void setStatus(int status) {
            this.status = status;
        }

        @Override
        public int hashCode() {
            int fNameHash = 0;
            int lNameHash = 0;
            int emailHash = 0;
            int langHash = 0;
            int productCodeHash = 0;

            if (this.firstName != null) {
                fNameHash = this.firstName.hashCode();
            }

            if (this.email != null) {
                emailHash = this.email.hashCode();
            }

            if (this.language != null) {
                langHash = this.language.hashCode();
            }

            if (this.productCode != null) {
                productCodeHash = this.productCode.hashCode();
            }

            return (fNameHash + lNameHash + emailHash + langHash + productCodeHash + this.status);
        }

        @Override
        public boolean equals(Object obj) {
            if(obj != null && obj instanceof User) {
                User temp = (User) obj;

                if (this.firstName != null && temp.firstName != null && this.firstName.equalsIgnoreCase(temp.firstName) 
                   && this.email != null && temp.email != null && this.email.equalsIgnoreCase(temp.email) 
                   && this.language != null && temp.language != null && this.language.equalsIgnoreCase(temp.language)
                   && this.productCode != null && temp.productCode != null && this.productCode.equalsIgnoreCase(temp.productCode)
                   && this.status == temp.status) {             
                    return true;
                }
            }
            return false;
        }   
    } 
```

我的预期结果是只打印一次 abc@aaa.com 但它被打印了两次！！

谁能告诉我如何更正此代码？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:34:20.640

问题是您`User.equals`将可以预见地返回`false`，因为两个实例都有`null` `firstName`s：

> ```
> if (this.firstName != null && temp.firstName != null && this.firstName.equalsIgnoreCase(temp.firstName) 
> ```

结果，即使它们具有相同`hashCode`的 ，它也仅被视为碰撞而不是匹配，因为`equals`已损坏。

尝试更正:-) 用类似的东西替换逻辑......

```
firstName == temp.firstName || firstName != null && firstName.equalsIgnoreCase(temp.firstName) 
```

... 应该管用 ;-）

[你可以在这里](http://ideone.com/hXq3t)看到一个完整的版本。

* * *

顺便说一句，您忘记分配`lNameHash`in `User.hashCode`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:35:21.283

你的`equals`方法和你的`hashcode`方法都执行不正确。

*   当两个对象都有成员时，您的`equals`方法将返回。`false``null`
*   您的实现`hashCode`可以为一些比较相等的对象返回不同的哈希码。

您必须提供正确的实现`equals`并`hashCode`能够在`HashSet`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:33:24.250

问题在于两个对象的 firstName 值都为空。因此，equals() 方法返回 false，并且您的两个对象都被`Set`.

尝试使用以下内容更改您的等号和哈希码：

```
@Override
public boolean equals(Object o) {
    if (this == o) return true;
    if (!(o instanceof User)) return false;

    User user = (User) o;

    if (status != user.status) return false;
    if (email != null ? !email.equals(user.email) : user.email != null) return false;
    if (firstName != null ? !firstName.equals(user.firstName) : user.firstName != null) return false;
    if (language != null ? !language.equals(user.language) : user.language != null) return false;
    if (productCode != null ? !productCode.equals(user.productCode) : user.productCode != null) return false;

    return true;
}

@Override
public int hashCode() {
    int result = firstName != null ? firstName.hashCode() : 0;
    result = 31 * result + (email != null ? email.hashCode() : 0);
    result = 31 * result + (language != null ? language.hashCode() : 0);
    result = 31 * result + (productCode != null ? productCode.hashCode() : 0);
    result = 31 * result + status;
    return result;
} 
```

最好的方法是按照另一个答案中的建议从您的 IDE 生成 equals 和 hashcode。

# objective-c - 如何停止监听 NSEvents？

> ID：12030797
> 
> 赞同：7
> 
> 时间：2012-08-19T23:28:04.903
> 
> 标签：objective-c, cocoa, nsevent

我在监听事件时遇到问题，我可以监听完美运行的事件，但是我不能让它停止监听事件。我研究了一段时间，想出了一个方法，+ (void)removeMonitor:(id)eventMonitor，它说当我完成监听器时应该使用

但是当我尝试使用该方法时，就像这样

```
[NSEvent addGlobalMonitorForEventsMatchingMask:(NSLeftMouseDownMask|NSKeyDownMask) handler:^(NSEvent *event) {
    [NSEvent removeMonitor:event];
}]; 
```

我不断收到“-[NSEvent invalidate]：无法识别的选择器发送到实例”的错误，我也对此进行了研究，我相信这意味着我正在覆盖正在使用的内存。但是我不知道如何解决这个问题。非常感谢任何建议或帮助！

更新感谢 JWWalker、Samir 和 Abizern，它现在可以工作了

```
//I made a global variable called eventHAndler 
```

.h 文件

```
id eventHAndler 
```

.m 文件

```
eventHAndler = [NSEvent addGlobalMonitorForEventsMatchingMask:(NSLeftMouseDownMask|NSKeyDownMask) handler:^(NSEvent *event){
///code 
}];

/// created another method called stop. When called it stops the eventHAndler
- (IBAction)Stop:(id)sender 
{
    stop = 1;
    NSLog(@"inside stop method");
    [NSEvent removeMonitor:eventHAndler];
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-28T02:02:30.850

你把错误的东西传递给`removeMonitor:`. 调用`+[NSEvent addGlobalMonitorForEventsMatchingMask: handler:]`返回一个称为事件处理程序对象的值。这就是可以传递给`removeMonitor:`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T00:25:16.307

According to: [http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/EventOverview/MonitoringEvents/MonitoringEvents.html](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/EventOverview/MonitoringEvents/MonitoringEvents.html)

They say:

> A global event monitor looks for user-input events dispatched to applications other than the one in which it is installed. The monitor ***cannot modify an event or prevent its normal delivery***. And it may only monitor key events if accessibility is enabled or if the application is trusted for accessibility.

So it is not possible says the man himself :P

# php - 过渡链接在 jsfiddle 中有效，但在我的浏览器中无效

> ID：12030798
> 
> 赞同：0
> 
> 时间：2012-08-19T23:28:31.990
> 
> 标签：php, javascript, jquery

我的代码的橙色链接在这里完美过渡--> [http://jsfiddle.net/v8X9H/134/](http://jsfiddle.net/v8X9H/134/) 然而，在我的浏览器上什么也没有。认为这与我切换的负载有关

```
$(function() { 
```

**到**

```
$(window).load(function() { 
```

依然没有。我没看到什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T23:51:54.350

对于 jsfiddle 之外的代码转换，您是否将 JS 代码放入了就绪/加载函数中？

IE

```
$(document).ready(function(){
    // JS Code goes here
}); 
```

# php - cakephp 自定义类或助手？

> ID：12030805
> 
> 赞同：1
> 
> 时间：2012-08-19T23:30:33.033
> 
> 标签：php, cakephp

我目前有一个正在工作的作家 MVC。我有一个名字和姓氏属性。在索引上我想显示全名。我知道这可以通过多种方式完成。

我可以在视图中编写逻辑

```
echo $writer['Writer']['firstname'] . " " . $writer['Writer']['lastname']; 
```

我可以编写一个辅助函数来执行此操作并保持视图干净。这就是我目前的做法。

```
echo fullName($writer['Writer']['firstname'], $writer['Writer']['lastname']); 
```

但是，我想知道创建一个具有全名方法的编写器类是否会更好。然后我可以进一步简化我的观点。

```
echo $writer->fullname 
```

所以，我知道如何编写帮助程序并且这很有效，假设构建一个类是要走的路，什么时候是正确的时间，在查询实例化每个对象之后？我假设在控制器中。此外，我的班级将住在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T14:56:49.980

另一种方法是在 Writer 模型中创建一个虚拟字段：

```
public $virtualFields = array(
    'full_name'=>"CONCAT(Writer.first_name, ' ', Writer.last_name)"
); 
```

并输出：

```
echo h($writer['Writer']['full_name']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:37:49.397

在您的`View/Helper/`. 然后是一个方法fullName：

```
 public function fullName($writer) {
    return $writer['first_name'] . ' ' . $writer['last_name'];
 }

// in your view
echo h($this->Custom->fullName($writer['Writer'])); 
```

您还可以在 find() 上进行格式化行为。这取决于您将在哪里使用它。如果仅与视图相关，则助手就足够了。如果您在控制器/模型级别需要它，您可能希望使用模型层进行连接。

# python - Flask 和 uWSGI - 无法加载应用程序 0 (mountpoint='') (callable not found or import error)

> ID：12030809
> 
> 赞同：73
> 
> 时间：2012-08-19T23:30:49.600
> 
> 标签：python, flask, uwsgi

当我尝试使用 uWSGI 启动 Flask 时出现以下错误。我是这样开始的：

```
>  # cd ..
>     root@localhost:# uwsgi --socket 127.0.0.1:6000 --file /path/to/folder/run.py --callable app -  -processes 2 
```

这是我的目录结构：

```
-/path/to/folder/run.py
      -|app
          -|__init__.py
          -|views.py
          -|templates
          -|static 
```

的内容`/path/to/folder/run.py`

```
if __name__ == '__main__':
   from app import app
   #app.run(debug = True)
   app.run() 
```

的内容`/path/to/folder/app/__init__.py`

```
import os
from flask import Flask
from flask.ext.sqlalchemy import SQLAlchemy
from flask.ext.login import LoginManager
#from flaskext.babel import Babel
from config import basedir
app = Flask(__name__)
app.config.from_object('config')
#app.config.from_pyfile('babel.cfg')

db = SQLAlchemy(app)
login_manager = LoginManager()
login_manager.setup_app(app)
login_manager.login_view = 'login'
login_manager.login_message = u"Please log in to access this page."

from app import views

*** Operational MODE: preforking ***
unable to find "application" callable in file /path/to/folder/run.py
unable to load app 0 (mountpoint='') (callable not found or import error)
*** no app loaded. going in full dynamic mode ***
*** uWSGI is running in multiple interpreter mode ***
spawned uWSGI worker 1 (pid: 26972, cores: 1)
spawned uWSGI worker 2 (pid: 26973, cores: 1) 
```

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2015-08-17T22:23:07.703

我对接受的解决方案有疑问，因为我的烧瓶应用程序位于一个名为`app`. 你可以通过把这个放在你的wsgi中来解决这个问题：

```
from module_with_your_flask_app import app as application 
```

所以问题只是 uwsgi 需要一个名为`application`.

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-08-19T23:46:04.850

uWSGI 不会将您的应用程序加载为`__main__`，因此它永远不会找到`app`（因为只有在应用程序以 name 运行时才会加载`__main__`）。因此，您需要将其导入`if __name__ == "__main__":`块之外。

非常简单的改变：

```
from app import app as application  # for example, should be app

if __name__ == "__main__":
    application.run() 
```

现在，您可以直接使用`python run.py`或通过 uWSGI 运行应用程序，就像您拥有它一样。

注意：如果您设置`--callable myapp`，您需要将其从 更改`as application`为`myapp`（默认情况下`uwsgi`期望`application`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-19T11:13:27.500

`unable to load app 0 (mountpoint='') (callable not found or import error)`如果我遗漏了以下**Flask 应用程序**最小工作示例的最后两行，则会发生uWSGI 错误

 **```
from flask import Flask
app = Flask(__name__)

@app.route("/")
def hello():
    return "Hello world!"

if __name__ == "__main__":
    app.run()
else:
    application = app 
```

我知道这已经在对另一个答案的评论中含蓄地说，但我仍然需要一段时间才能弄清楚，所以我希望节省其他人的时间。

对于纯**Python Dash 应用程序**，我可以提供以下最小可行代码片段：

```
import dash
import dash_core_components as dcc
import dash_html_components as html
app = dash.Dash()
app.layout = html.Div( html.H1(children="Hello World") )

application = app.server

if __name__ == "__main__":
    app.run_server(debug=True) 
```

同样，`application = app.server`这里是必不可少的部分。**

# php - php日期验证

> ID：12030810
> 
> 赞同：52
> 
> 时间：2012-08-19T23:30:54.757
> 
> 标签：php, validation, date

我试图设置一个 php 日期验证（MM/DD/YYYY），但我遇到了问题。这是我得到的示例：

```
$date_regex = '%\A(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20)\d\d\z%'; 

$test_date = '03/22/2010'; 
if (preg_match($date_regex, $test_date,$_POST['birthday']) ==true) {
    $errors[] = 'user name most have no spaces';` 
```

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-08-19T23:35:56.353

你可以使用[checkdate](http://php.net/manual/en/function.checkdate.php)。例如，像这样：

```
$test_date = '03/22/2010';
$test_arr  = explode('/', $test_date);
if (checkdate($test_arr[0], $test_arr[1], $test_arr[2])) {
    // valid date ...
} 
```

一种更偏执的方法，不会盲目相信输入：

```
$test_date = '03/22/2010';
$test_arr  = explode('/', $test_date);
if (count($test_arr) == 3) {
    if (checkdate($test_arr[0], $test_arr[1], $test_arr[2])) {
        // valid date ...
    } else {
        // problem with dates ...
    }
} else {
    // problem with input ...
} 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2012-08-19T23:59:22.433

您可以使用[`DateTime`](http://php.net/class.datetime)该类的一些方法，这可能很方便；即，[`DateTime::createFromFormat()`](http://php.net/datetime.createfromformat)与 结合[`DateTime::getLastErrors()`](http://php.net/datetime.getlasterrors)。

```
$test_date = '03/22/2010';

$date = DateTime::createFromFormat('m/d/Y', $test_date);
$date_errors = DateTime::getLastErrors();
if ($date_errors['warning_count'] + $date_errors['error_count'] > 0) {
    $errors[] = 'Some useful error message goes here.';
} 
```

这甚至可以让我们查看实际导致日期解析警告/错误的原因（查看 中的`warnings`和`errors`数组`$date_errors`）。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2014-04-08T16:20:09.497

虽然`checkdate`很好，但这似乎是非常简洁的验证功能，您也可以提供格式。[[来源](http://php.net/manual/en/function.checkdate.php#113205)]

```
function validateDate($date, $format = 'Y-m-d H:i:s') {
    $d = DateTime::createFromFormat($format, $date);
    return $d && $d->format($format) == $date;
} 
```

^(*[函数是从这个答案](https://stackoverflow.com/a/12323025/67332)或[php.net](http://www.php.net/manual/en/function.checkdate.php#113205)复制的*)

对于日期无效但仍设法创建 DateTime 对象`->format()`的情况，需要 额外的内容。`createFromFormat`例如：

```
// Gives "2016-11-10 ..." because Thursday falls on Nov 10
DateTime::createFromFormat('D M j Y', 'Thu Nov 9 2016');

// false, Nov 9 is a Wednesday
validateDate('Thu Nov 9 2016', 'D M j Y'); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-08-10T16:28:37.750

而不是笨重的[DateTime](http://php.net/manual/en/class.datetime.php)对象 .. 只需使用核心[date()](http://php.net/manual/en/function.date.php)函数

```
function isValidDate($date, $format= 'Y-m-d'){
    return $date == date($format, strtotime($date));
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-31T09:02:07.220

Use it:

```
function validate_Date($mydate,$format = 'DD-MM-YYYY') {

    if ($format == 'YYYY-MM-DD') list($year, $month, $day) = explode('-', $mydate);
    if ($format == 'YYYY/MM/DD') list($year, $month, $day) = explode('/', $mydate);
    if ($format == 'YYYY.MM.DD') list($year, $month, $day) = explode('.', $mydate);

    if ($format == 'DD-MM-YYYY') list($day, $month, $year) = explode('-', $mydate);
    if ($format == 'DD/MM/YYYY') list($day, $month, $year) = explode('/', $mydate);
    if ($format == 'DD.MM.YYYY') list($day, $month, $year) = explode('.', $mydate);

    if ($format == 'MM-DD-YYYY') list($month, $day, $year) = explode('-', $mydate);
    if ($format == 'MM/DD/YYYY') list($month, $day, $year) = explode('/', $mydate);
    if ($format == 'MM.DD.YYYY') list($month, $day, $year) = explode('.', $mydate);       

    if (is_numeric($year) && is_numeric($month) && is_numeric($day))
        return checkdate($month,$day,$year);
    return false;           
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-19T23:40:00.377

尼古拉斯解决方案是最好的。如果你想使用正则表达式，

尝试这个，

这将验证 01/01/1900 到 12/31/2099 匹配无效日期，例如 2 月 31 日 接受破折号、空格、正斜杠和点作为日期分隔符

```
(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20)[0-9]{2} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-08-19T23:46:05.787

REGEX 应该是最后的手段。PHP 有一些函数可以为您验证。在您的情况下， checkdate 是最好的选择。[http://php.net/manual/en/function.checkdate.php](http://php.net/manual/en/function.checkdate.php)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-08-20T02:27:31.447

这个功能运行良好，

```
function validateDate($date, $format = 'm/d/Y'){
    $d = DateTime::createFromFormat($format, $date);
    return $d && $d->format($format) === $date;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-12-17T18:03:25.097

我知道这是一篇较旧的帖子，但我开发了以下用于验证日期的函数：

```
function IsDateTime($aDateTime) {
    try {
        $fTime = new DateTime($aDateTime);
        $fTime->format('m/d/Y H:i:s');
        return true;
    }
    catch (Exception $e) {
        return false;
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-06-29T08:25:37.213

尝试这个

```
/^(19[0-9]{2}|2[0-9]{3})\-(0[1-9]|1[0-2])\-(0[1-9]|1[0-9]|2[0-9]|3[0-1])((T|\s)(0[0-9]{1}|1[0-9]{1}|2[0-3]{1})\:(0[0-9]{1}|1[0-9]{1}|2[0-9]{1}|3[0-9]{1}|4[0-9]{1}|5[0-9]{1})\:(0[0-9]{1}|1[0-9]{1}|2[0-9]{1}|3[0-9]{1}|4[0-9]{1}|5[0-9]{1})((\+|\.)[\d+]{4,8})?)?$/ 
```

此正则表达式适用于：

*   2017-01-01T00:00:00+0000
*   2017-01-01 00:00:00+00:00
*   2017-01-01T00:00:00+00:00
*   2017-01-01 00:00:00+0000
*   2017-01-01

请记住，这将涵盖所有带有 ( **-** ) 字符的日期和日期时间

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-05-06T19:36:45.853

不确定这是否回答了问题或会有所帮助....

```
$dt = '6/26/1970' ; // or // '6.26.1970' ;

$dt = preg_replace("([.]+)", "/", $dt);

$test_arr  = explode('/', $dt);

if (checkdate($test_arr[0], $test_arr[1], $test_arr[2]) && preg_match("/[0-9]{1,2}\/[0-9]{1,2}\/[0-9]{4}/", $dt))

     { echo(date('Y-m-d', strtotime("$dt")) . "<br>"); }

   else

     { echo "no good...format must be in mm/dd/yyyy"; } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-03-11T19:47:39.257

我们可以使用简单的“日期”输入类型，如下所示：

```
Birth date: <input type="date" name="userBirthDate" /><br /> 
```

然后我们可以将 DateTime 接口与内置函数 'explode' 联系起来：

```
public function validateDate()
    {
        $validateFlag = true;
        $convertBirthDate = DateTime::createFromFormat('Y-m-d', $this->birthDate);
        $birthDateErrors = DateTime::getLastErrors();

        if ($birthDateErrors['warning_count'] + $birthDateErrors['error_count'] > 0)
        {
            $_SESSION['wrongDateFormat'] = "The date format is wrong.";
        }

        else
        {
            $testBirthDate = explode('-', $this->birthDate);
            if ($testBirthDate[0] < 1900)
            {
                $validateFlag = false;
                $_SESSION['wrongDateYear'] = "We suspect that you did not born before XX century.";
            }
        }

        return $validateFlag;
    } 
```

我在 Google Chrome 和 IE 上测试过，一切正常。此外，Chrome 显示简单的附加界面。如果您没有在输入中写入任何内容或以错误的格式写入（正确如下：'1919-12-23'），您将得到第一个语句。如果您以良好的格式编写所有内容，但您输入了错误的日期（我假设没有人可以在 XX 世纪之前出生），您的控制器将发送第二条语句。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-11T18:02:11.117

**我认为它会帮助某人**。

```
function isValidDate($thedate) {
    $data = [
        'separators' => array("/", "-", "."),
        'date_array' => '',
        'day_index' => '',
        'year' => '',
        'month' => '',
        'day' => '',
        'status' => false
    ];

    // loop through to break down the date
    foreach ($data['separators'] as $separator) {
        $data['date_array'] = explode($separator, $thedate);
        if (count($data['date_array']) == 3) {
            $data['status'] = true;
            break;
        }
    }

    // err, if more than 4 character or not int
    if ($data['status']) {
        foreach ($data['date_array'] as $value) {
            if (strlen($value) > 4 || !is_numeric($value)) {
                $data['status'] = false;
                break;
            }
        }
    }

    // get the year
    if ($data['status']) {
        if (strlen($data['date_array'][0]) == 4) {
            $data['year'] = $data['date_array'][0];
            $data['day_index'] = 2;
        }elseif (strlen($data['date_array'][2]) == 4) {
            $data['year'] = $data['date_array'][2];
            $data['day_index'] = 0;
        }else {
            $data['status'] = false;
        }
    }

    // get the month
    if ($data['status']) {
        if (strlen($data['date_array'][1]) == 2) {
            $data['month'] = $data['date_array'][1];
        }else {
            $data['status'] = false;
        }
    }

    // get the day
    if ($data['status']) {
        if (strlen($data['date_array'][$data['day_index']]) == 2) {
            $data['day'] = $data['date_array'][$data['day_index']];
        }else {
            $data['status'] = false;
        }
    }

    // finally validate date
    if ($data['status']) {
        return checkdate($data['month'] , $data['day'], $data['year']);
    }

    return false;
} 
```

# javascript - 在另一个脚本之后插入 Jquery

> ID：12030812
> 
> 赞同：0
> 
> 时间：2012-08-19T23:31:04.933
> 
> 标签：javascript, jquery, html, head

我想在我的 HTML 中插入 Jquery 库，但我不能将它放在文件的标题上。我需要在运行一些脚本后将其包含在内。你知道有什么方法可以做到这一点而不会出错吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T16:41:47.070

如果您正在构建自己的站点/页面，那么您可以通过确保在其他文件之前包含 jQuery 来充分控制这一点。但是，如果您使用的是 WordPress 或其他动态 CMS 平台，您可能无法在 jQuery 存在之前阻止它引用它。

查看[jqShim 的这个 github 项目，](https://github.com/withjam/jqshim-head)这可能会有所帮助。您可以在头部包含非常基本的 dom 就绪功能，同时将更大/更大/更慢/完整的 jQuery 下载移动到 BODY 的底部（但在任何插件之前）。只要调用 jQuery 的代码执行以下操作：

```
jQuery(function($) { ... doing something when ready ... }); 
```

在使用 jqShim 之后，这些调用仍然可以在主体中进行，并且将按预期运行。让我知道它是否有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:40:38.457

您只需在使用它的脚本之前加载 jQuery。如果您愿意，其他不使用 jQuery 的脚本可以在它之前使用。

例如，如果您想在正文末尾的脚本标记中包含 jQuery，然后在此之后包含一些使用 jQuery 的脚本，您可以这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:37:17.553

您可能试图在加载 jQuery 库文件之前在脚本中调用 jQuery。

# orm - Kohana ORM order_by 查询

> ID：12030814
> 
> 赞同：0
> 
> 时间：2012-08-19T23:31:43.623
> 
> 标签：orm, kohana, kohana-orm

我正在寻找根据另一个表的“查看次数最多”计数来排序结果集的最佳方法？

我有一个产品表和一个历史表。历史表存储产品的查看次数，并由 product_id 链接。

通过历史记录表中的“view_count”列订购产品列表的最佳方式是什么？

感谢您对此的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:35:46.147

`products`假设查询和`history`查询之间存在一对一的关系，如下所示：

```
SELECT products.* FROM products
INNER JOIN history on products.id = history.products_id
ORDER BY history.view_count DESC 
```

如果每个都有多个`history`记录而`product`不是它的不同场景。这可能无法扩展，您可以考虑添加`view_count`to`products`并在每个视图上增加它。

# php - 使用 jQuery .html() 处理 PHP

> ID：12030816
> 
> 赞同：0
> 
> 时间：2012-08-19T23:31:51.923
> 
> 标签：php, jquery, html, codeigniter

我正在尝试让 jQuery 更改元素的 html 并包含 PHP。除了 PHP，一切都很好。这是我所拥有的：

```
$('.gridheader').each(function(index){
    $(this).toggle(function (){
        $('.gridimage:eq('+index+'), .gridinfo:eq('+index+')').slideToggle();
        $('.gridheadinfo:eq('+index+')').html('Click to close <img src="<?php echo base_url() ?>/assets/images/closetab.png" width="10" height="10" />');
    }, function(){
        $('.gridimage:eq('+index+'), .gridinfo:eq('+index+')').slideToggle();
        $('.gridheadinfo:eq('+index+')').html('Click for info <img src="<?php echo base_url() ?>/assets/images/scrollup.png" width="11" height="10" />');
    });
}); 
```

我有最初的图像（HTML）：

```
<div class="float-left">Kredible</div><div class="float-right gridheadinfo">Click for info <img src="<?php echo base_url() ?>assets/images/scrollup.png" width="11" height="10" /></div></div> 
```

HTML 工作正常，但是当我使用 jQuery 更改它时，图像不显示。更改后我在检查器中查看了它，PHP 显示为 PHP 而不是转换为 HTML？

我比较疑惑。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:40:23.247

保存您的服务器端变量，然后使用它：

```
 var url="<?php echo base_url() ?>"; 
    //this will be parsed by the php interpreter at page load so url will be "localhost/subdomain/" probably. 

        $('.gridheader').each(function(index){
            $(this).toggle(function (){
                $('.gridimage:eq('+index+'), .gridinfo:eq('+index+')').slideToggle();
                $('.gridheadinfo:eq('+index+')').html('Click to close <img src="'+url+'/assets/images/closetab.png" width="10" height="10" />');
    //use it here
            }, function(){
                $('.gridimage:eq('+index+'), .gridinfo:eq('+index+')').slideToggle();
                $('.gridheadinfo:eq('+index+')').html('Click for info <img src="'+url+'/assets/images/scrollup.png" width="11" height="10" />');
            });
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:39:28.500

包含一个 php 文件只会影响服务器上的 html。

因此，更改的代码不会有任何影响，因为没有执行 php 脚本。

您可以加载 html 文件的内容，然后将其放入您的页面中。当然，SQL 不可能在其中实现。

# twitter-bootstrap - 覆盖引导变量似乎不起作用

> ID：12030818
> 
> 赞同：2
> 
> 时间：2012-08-19T23:32:26.103
> 
> 标签：twitter-bootstrap, less

我试图在引导程序中覆盖他的列宽。正如 bootstrap_and_overrides.less 中所建议的，这是我应该覆盖它们的地方：

```
// Since bootstrap was imported above you have access to its mixins which
// you may use and inherit here
//
// If you'd like to override bootstrap's own variables, you can do so here as well
// See http://twitter.github.com/bootstrap/less.html for their names and documentation
// Example:
// @linkColor: #ff0000;
 @gridColumnWidth : 55px;
 @gridGutterWidth: 43px; 
```

当我重新启动服务器并重新加载页面时，生成的 css 没有改变，跨度宽度保持不变。

我是否需要重新编译 less 文件才能使更改生效？我怎么做？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:35:37.757

是的，您需要使用[LESS](http://lesscss.org)重新编译才能看到您的更改。要么使用来自 LESS 站点的 JavaScript，要么使用[Twitter Bootstrap 页面上关于 LESS](http://twitter.github.com/bootstrap/less.html#compiling)的方法之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T18:58:43.990

[您还可以在http://twitter.github.com/bootstrap/customize.html](http://twitter.github.com/bootstrap/customize.html)自定义您的引导程序下载。

`@gridColumnWidth`并且`@gridGutterWidth`可以定制。

# objective-c - iOS：NSMutableArray 为空

> ID：12030822
> 
> 赞同：0
> 
> 时间：2012-08-19T23:33:06.760
> 
> 标签：objective-c, ios, memory-management, nsmutablearray

```
for (XMLProductView *pV in entries) {
        NSString *test = pV.appName;
        [allTableData addObject:test];

        NSLog(@"Entries: %@", allTableData);
    } 
```

在我的`NSString *test`我得到所有结果。为什么会出现`NSMutableArray`“allTableData” `Null`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-19T23:35:46.493

很难说，因为您只添加了一些信息，但可能您没有正确分配它。

尝试在你的 for 之前添加它：

```
allTableData = [[NSMutableArray alloc] init];
for (XMLProductView *pV in entries) {
    NSString *test = pV.appName;
    [allTableData addObject:test];
}
NSLog(@"Entries: %@", allTableData); 
```

--

**编辑**

我编辑了代码以使其清晰。

# jpa-2.0 - spring-data-jpa 计数与规格不同

> ID：12030826
> 
> 赞同：1
> 
> 时间：2012-08-19T23:33:24.917
> 
> 标签：jpa-2.0, spring-data-jpa

在 spring-date-jpa 中，当我的规范包含 query.distinct(true) 时，我看到 count(Specification) 方法，计数查询不正确。生成的 SQL 如下所示：

选择 distinctcount(*) ...

代替

选择计数（不同（*））...

在那篇文章中：[spring-source-forum](http://forum.springsource.org/showthread.php?124497-is-there-any-way-to-do-a-count%28distinct%28%2a%29%29-using-Specifications) 解决方法是修改 spring-data-jpa 的源代码。

还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:35:40.850

我找到了另一种解决方法：

```
Subquery<Class1> sq = query.subquery(Class1.class);
Root<Class1> spouseEmp = sq.from(Class1.class);
sq.select(spouseEmp);
sq.where(builder.equal(spouseEmp.get("class2"),class2.get("class2")));
predicate.getExpressions().add(builder.exists(sq)); 
```

# android - 为什么在 CustomView 中创建 EditText 的引用会给出 NullPointer 异常

> ID：12030833
> 
> 赞同：1
> 
> 时间：2012-08-19T23:35:20.003
> 
> 标签：android, nullpointerexception, android-edittext, android-custom-view

我正在尝试在我的 CustomView 中获取 EditText 的值，但是对此的引用给出了 NullPointer 异常...请帮助！！！

这是我的 ImageActivity 的 xml 文件。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:orientation="vertical" >

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <Button
        android:id="@+id/buttonDraw"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="Draw Rect" >
    </Button>

    <Button
        android:id="@+id/buttonText"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="Make Text" >
    </Button>

    <Button
        android:id="@+id/buttonExit"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="Exit" >
    </Button>
</LinearLayout>

<FrameLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/main_view"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#FFffff" >

    <ImageView
        android:id="@+id/imgView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1" >
    </ImageView>
</FrameLayout>

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linear_view"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <EditText
        android:id="@+id/editText"             <!--This is my EditText which gives Exception-->
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Enter Value Here!!!" >
    </EditText>

    <Button
        android:id="@+id/buttonSave"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="Save" >
    </Button>
</LinearLayout> 
```

这是我的 ImageActivity ...

```
public class ImageActivity extends Activity {

DrawPanel dview;
DrawText dtext;
EditText et;
FrameLayout fm;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_image);

    Bundle bundle = getIntent().getExtras();
    final String value = bundle.getString("key");
    Bitmap bmp = BitmapFactory.decodeFile(value);
    ImageView imageView = (ImageView) findViewById(R.id.imgView);
    imageView.setImageBitmap(bmp);

    Button bd = (Button) findViewById(R.id.buttonDraw);
    Button bt = (Button) findViewById(R.id.buttonText);
    Button be = (Button) findViewById(R.id.buttonExit);

    fm = (FrameLayout) findViewById(R.id.main_view);
    dview = new DrawPanel(this);
    dtext = new DrawText(this);
    et = (EditText) findViewById(R.id.editText);
    String text = et.getText().toString();
    System.out.println(text);
    bd.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            fm.addView(dview);

        }
    });

    bt.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            et.requestFocus();
            fm.addView(dtext);

        }
    });

    et.addTextChangedListener(new TextWatcher() {

        @Override
        public void onTextChanged(CharSequence s, int start, int before,
                int count) {
            // dtext.invalidate();

        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count,
                int after) {
            // TODO Auto-generated method stub

        }

        @Override
        public void afterTextChanged(Editable s) {

        }
    });

    be.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            finish();

        }
    });
} 
```

}

这是 CustomView DrawText 类，其中 EditText 的引用给出了 NullPointer 异常..

```
public class DrawText extends View implements OnTouchListener{

static int xp = 0, yp = 0;
static int margrecth = 30;
static int margrectw = 40;
static int xn = 100, yn = 100;
static int flag = 0;
static int scrolrect = 0;
static int scrolleftrect = 0;
static int scrolrightrect = 0;
static int scroltoprect = 0;
static int scrolbottomrect = 0;
int rectr = xn + margrectw, rectl = xn - margrectw, rectb = yn + margrecth,
        rectt = yn - margrecth;
Paint paint; // using this ,we can draw on canvas

Rectangle Drect;
ResizeBall lball;
ResizeBall tball;
ResizeBall rball;
ResizeBall bball;
EditText et;
final LinearLayout ll;
String dstext = null;

public DrawText(Context context) {
    super(context);
    paint = new Paint();
    paint.setAntiAlias(true); // setting the paint color

    Drect = new Rectangle(rectl, rectt, rectr, rectb);
    lball = new ResizeBall(rectl, yn, 5);
    tball = new ResizeBall(xn, rectt, 5);
    rball = new ResizeBall(rectr, yn, 5);
    bball = new ResizeBall(xn, rectb, 5);
    ll = (LinearLayout) findViewById(R.id.linear_view);
    // to make it focusable so that it will receive touch events properly
    setFocusable(true);
    // adding touch listener to this view
    this.setOnTouchListener(this);
}

// overriding the View's onDraw(..) method
public void onDraw(Canvas canvas) {
    et = (EditText) ll.findViewById(R.id.editText);
    String text = et.getText().toString();
    System.out.println(text);
    if (flag == 0) {
        DrawAll(canvas);
    } else if (flag == 1) {

        if (scrolrect == 1) {
            DrawAll(canvas);
        } else if (scrolrightrect == 1) {
            DrawAll(canvas);
        } else if (scrolleftrect == 1) {
            DrawAll(canvas);
        } else if (scroltoprect == 1) {
            DrawAll(canvas);
        } else if (scrolbottomrect == 1) {
            DrawAll(canvas);
        }
    }

}

private void DrawAll(Canvas canvas) {
    //et = (EditText) findViewById(R.id.editText);

    paint.setStrokeWidth(4);
    paint.setColor(Color.BLACK);
    canvas.drawRect(Drect.getLeft(), Drect.getTop(), Drect.getRight(),Drect.getBottom(),          paint); // mainRect
    paint.setStrokeWidth(0);
    paint.setColor(Color.WHITE);
    canvas.drawRect(Drect.getLeft()+4, Drect.getTop()+4, Drect.getRight()-4,Drect.getBottom()-4, paint);
    paint.setColor(Color.BLACK);
    canvas.drawText("et.getText().toString()", Drect.getLeft()+10, Drect.getTop()+15, paint);
    paint.setColor(Color.BLACK);
    paint.setStrokeWidth(5);
    canvas.drawCircle(lball.getCenterx(), lball.getCentery(), 5, paint); // resizeRect
                                                                            // left
    canvas.drawCircle(tball.getCenterx(), tball.getCentery(), 5, paint); // resizeRect
                                                                            // right
    canvas.drawCircle(rball.getCenterx(), rball.getCentery(), 5, paint); // resizeRect
                                                                            // top
    canvas.drawCircle(bball.getCenterx(), bball.getCentery(), 5, paint); // resizeRect
                                                                            // bottom

}

// this is the interface method of "OnTouchListener"
public boolean onTouch(View view, MotionEvent event) {
          //code not included as it is irrelevant 
          //to current problem as far as my understanding

    return true;
} 
```

}

下面是我的 LogCat ....

```
08-20 04:57:11.550: E/AndroidRuntime(10960): FATAL EXCEPTION: main
08-20 04:57:11.550: E/AndroidRuntime(10960): java.lang.NullPointerException
08-20 04:57:11.550: E/AndroidRuntime(10960):    at com.nexapp.imgedit.DrawText.onDraw(DrawText.java:57)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.View.draw(View.java:6880)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.View.draw(View.java:6883)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.widget.FrameLayout.draw(FrameLayout.java:357)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.View.draw(View.java:6883)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.widget.FrameLayout.draw(FrameLayout.java:357)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.View.draw(View.java:6883)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.widget.FrameLayout.draw(FrameLayout.java:357)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:1862)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewRoot.draw(ViewRoot.java:1522)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewRoot.performTraversals(ViewRoot.java:1258)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.view.ViewRoot.handleMessage(ViewRoot.java:1859)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.os.Handler.dispatchMessage(Handler.java:99)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.os.Looper.loop(Looper.java:123)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at android.app.ActivityThread.main(ActivityThread.java:3683)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at java.lang.reflect.Method.invokeNative(Native Method)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at java.lang.reflect.Method.invoke(Method.java:507)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
08-20 04:57:11.550: E/AndroidRuntime(10960):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:01:21.473

当您定义 DrawText 类的构造函数时，传递活动：

```
public DrawText(Activity activity) {
    super(activity);
    // your existing initialization code
    ll = (LinearLayout)activity.findViewById(R.id.linear_view);
} 
```

现在您应该可以从 ll 中获取 TextEdit。

# css - 具有切出边缘、边框和透明背景的 Div

> ID：12030835
> 
> 赞同：9
> 
> 时间：2012-08-19T23:35:25.647
> 
> 标签：css, css-shapes

我一直在试图弄清楚如何在 CSS 中制作一个在视觉上看起来像这样的自定义形状：

![带有切边和边框的形状](../Images/e5dd4433562b1df0d70708e921ab1510.png)

`background:rgba(44, 44, 48, 0.9)`具有和的属性`border:6px solid rgba(29, 30, 35, 0.9);`

我的问题是我找不到一种方法让右上角和左下角的边框看起来像我提供的图像。在 CSS-Tricks 上尝试了有关 CSS 自定义形状的提示，但它似乎没有解决问题，因为它没有背景。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-07-16T18:18:29.577

如果你在 3d 中思考，你可以使用`perspective`和`rotateX()`属性来改变元素的一个或两个角度。

这将允许您为容器的伪元素设置样式以赋予它们所需的形状并切掉右上角和左下角。

您还可以为形状提供所需的边框，（参见以下演示）：

**[演示](http://codepen.io/web-tiki/pen/Dvgqn)**

输出 ：

![带有切出边缘和边框的 CSS 形状](../Images/8462042d047703f1644d3af4f0dac485.png)

```
div {
  position: relative;
  width: 50%;
  height: 300px;
  margin: 10% auto;
  background: rgba(0, 0, 0, 0.7);
  border-top: 6px solid rgba(0, 0, 0, 0.8);
  border-bottom: 6px solid rgba(0, 0, 0, 0.8);
}
div:before,
div:after {
  content: '';
  position: absolute;
  top: -6px;
  width: 20%;
  height: 100%;
}
div:before {
  right: 100%;
  background: inherit;
  border-top: 6px solid rgba(0, 0, 0, 0.8);
  border-left: 6px solid rgba(0, 0, 0, 0.8);
  border-bottom: 6px solid rgba(0, 0, 0, 0.8);
  -webkit-transform-origin: 100% 0;
  transform-origin: 100% 0;
  -webkit-transform: perspective(1px) rotateY(-0.15deg);
  transform: perspective(1px) rotateY(-0.15deg);
}
div:after {
  left: 100%;
  border-top: 6px solid rgba(0, 0, 0, 0.8);
  border-right: 6px solid rgba(0, 0, 0, 0.8);
  border-bottom: 6px solid rgba(0, 0, 0, 0.8);
  border-left: none;
  background: inherit;
  -webkit-transform-origin: 0 100%;
  transform-origin: 0 100%;
  -webkit-transform: perspective(1px) rotateY(0.15deg);
  transform: perspective(1px) rotateY(0.15deg);
}
```

```
<div></div>
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-26T11:48:43.640

您可以仅使用一个元素创建该形状，具有简单`transforms`和`overflow: hidden;`属性

您可以在另一个元素中添加内容：

```
body {
    background: url(http://i.imgur.com/RT7XR3C.jpg);
    background-size: cover;
}
div {
    height: 200px;
    width: 300px;
    margin: 40px auto;
    overflow: hidden;
    position: relative;
}
div:before {
    content: '';
    position: absolute;
    left: -58px; /*-half buffer -left border*/
    height: 188px;
    width: 400px;
    background: rgba(30, 30, 30, 0.8);
    -webkit-transform: skewX(45deg);
    -moz-transform: skewX(45deg);
    transform: skewX(45deg);
    border-left: 8px solid #222;
    border-right: 8px solid #222;
    border-top: 6px solid #222;
    border-bottom: 6px solid #222;
}
div:after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    height: 157px;
    width: 6px;
    background: #222;
    box-shadow:0 0 0 0 #222, 294px 43px 0 0 #222;
}
```

```
<div></div>
```

**[小提琴](http://jsfiddle.net/y0zm6bvc/)**

**输出：**

![在此处输入图像描述](../Images/60b88e8b0780a50b33c07a925174f130.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T03:52:41.720

不幸的是，您不能将伪元素添加到伪元素（即`:after:after{}` 不起作用） - 像您这样复杂的形状，您可能不得不[作弊](http://jsfiddle.net/ovfiddle/8h92u/1/)并依赖其子元素的伪元素。

```
<div class="fancy-box">
    <h2>Title</h2>
    <p>Content</p>
</div>

.fancy-box{/*container, top+bottom borders*/}
.fancy-box:before{/*left-top "square" corner*/}
.fancy-box:after{/*right-bottom "square" corner*/}
.fancy-box>p:before{/*left-bottom "dog ear" border*/}
.fancy-box>p:after{/*right-top "dog ear" border*/}
.fancy-box>h2:before{{/*left-bottom "dog ear" background*/}
.fancy-box>h2:after{/*right-top "dog ear" background*/} 
```

同样，[这个小提琴](http://jsfiddle.net/ovfiddle/8h92u/1/)向您展示了它如何与纯色一起使用（虽然我不喜欢“较细”的角度，但相当不错） - 但是[当您应用 opacity 时这会失败](http://jsfiddle.net/ovfiddle/8h92u/)。你最好的可能是将“狗耳朵”制作成预渲染的半透明 PNG，以获得额外的功劳[，你可以对它们进行 base64 编码](https://stackoverflow.com/a/11978215/1081234)。

不过，上面的“解决方案”是一个完整的语义恐怖——使用带有预渲染图形的多个背景可能会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T00:45:27.350

好吧，我认为您需要使用多个元素..我可以用三个元素和 2 个伪元素来实现那种形状.. 在这里看看[http://codepen.io/zwongso/pen/vgxdB](http://codepen.io/zwongso/pen/vgxdB)

它的形状与您的图像不完全相同，但您应该明白......要获得那个边框会有点棘手......

我想知道是否有人有更好的解决方案..仅出于演示目的而有 2 个空元素有点不符合语义..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-20T00:59:40.183

SVG 背景可能是一个很好的解决方案，尽管您可能会遇到一些支持问题。请参阅[我何时可以在 CSS 背景中使用... SVG](http://caniuse.com/#feat=svg-css)。此外，它们很难正常工作。如果您确实使用 SVG 背景，请务必将其作为数据 URI 嵌入到您的 CSS 中（参见[小提琴](http://jsfiddle.net/estelle/SJjJb/)，同时注意上述小提琴中的警告：-p）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-12T02:25:13.473

借助 CSS3，您可以使用它`border-image`来实现这一点。我在这里使用 inline-svg，但任何图像都可以：

```
body {
  background: url(http://i.imgur.com/RT7XR3C.jpg);
  background-size: cover;
}
.fancy-box {
  border-width: 50px;
  border-image: url('data:image/svg+xml,<svg width="300" height="300" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><polygon stroke="rgba(29, 30, 35, 0.9)" stroke-width="6" fill="rgba(44, 44, 48, 0.9)" points="5,5 255,5 295,45 295,295 45,295 5,255 5,5"/></svg>') 50 50 repeat;
  background: rgba(44, 44, 48, 0.9);
  background-clip: content-box;
  /* other styling */
  color: #D7DBE1;
  text-align: justify;
  font-family: sans-serif;
  width: 400px;
  margin: 0 auto;
}
```

```
<div class="fancy-box">
  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus nec interdum velit. Morbi quis leo ac ipsum volutpat imperdiet. Sed feugiat posuere nisl sit amet luctus.
</div>
```

# java - JTextArea 中的撤消功能

> ID：12030836
> 
> 赞同：6
> 
> 时间：2012-08-19T23:35:30.690
> 
> 标签：java, swing

我正在尝试在`JTextArea`. 谷歌搜索教程并遵循其中一个教程并编写了以下代码。按下 Ctrl+Z 键时触发该事件。它不适合我。我错过了什么吗？

```
private void undoActionPerformed(java.awt.event.ActionEvent evt) {
    Document doc = editorTextArea.getDocument();
    final UndoManager undo = new UndoManager();

    doc.addUndoableEditListener(new UndoableEditListener() {
        @Override
        public void undoableEditHappened(UndoableEditEvent e) {
            undo.addEdit(e.getEdit());
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-20T00:14:07.587

从你的例子来看，很难知道你做了多少，但我能够让它发挥作用......

```
private UndoManager undoManager;

// In the constructor

undoManager = new UndoManager();
Document doc = textArea.getDocument();
doc.addUndoableEditListener(new UndoableEditListener() {
    @Override
    public void undoableEditHappened(UndoableEditEvent e) {

        System.out.println("Add edit");
        undoManager.addEdit(e.getEdit());

    }
});

InputMap im = textArea.getInputMap(JComponent.WHEN_FOCUSED);
ActionMap am = textArea.getActionMap();

im.put(KeyStroke.getKeyStroke(KeyEvent.VK_Z, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()), "Undo");
im.put(KeyStroke.getKeyStroke(KeyEvent.VK_Y, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()), "Redo");

am.put("Undo", new AbstractAction() {
    @Override
    public void actionPerformed(ActionEvent e) {
        try {
            if (undoManager.canUndo()) {
                undoManager.undo();
            }
        } catch (CannotUndoException exp) {
            exp.printStackTrace();
        }
    }
});
am.put("Redo", new AbstractAction() {
    @Override
    public void actionPerformed(ActionEvent e) {
        try {
            if (undoManager.canRedo()) {
                undoManager.redo();
            }
        } catch (CannotUndoException exp) {
            exp.printStackTrace();
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-19T23:45:23.813

我不确定，但也许你不能为你的 gui 添加KeyListener。
例如;

```
class Example implements KeyListener{

  .
  .
  .

  this.addKeyListener(this); // if want to add key listener for main container

  .
  .
  .

} 
```

[这](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)是关于如何使用关键监听器。

# php - 使用 PHP 在服务器上重新加入拆分文件

> ID：12030838
> 
> 赞同：2
> 
> 时间：2012-08-19T23:35:39.397
> 
> 标签：php

我想知道是否可以执行以下操作：

*   将本地计算机上的文件拆分为多个部分，以便我可以将它们上传到 FTP 服务器（避免这种方式文件大小限制）
*   将所有片段上传到我的网络服务器
*   使用 PHP 脚本将它们重新连接到一个文件中

我知道 HJSplit 但它是针对另一种情况（在服务器上拆分然后在本地计算机上重新加入）

有谁知道任何可能的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:51:47.203

[该站点声称有一些用于拆分然后加入的包。](http://www.phpclasses.org/package/2502-PHP-Split-files-in-pieces-that-can-be-gathered-later.html)
但是我不确定它们是否有效。（未尝试）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-02-27T05:20:57.760

这可能会导致拆分部分：

```
 <html>
<body>
  <label >
  <div align="right" >
  </div>
</label>
<form method="POST" action="">
    <table>
        <tr>
            <td>Here you Files to spilited</td>
            <td>Value</td>

        </tr>
        <tr>
            <td> For spilt Zip File to  paste Its Url</td>
            <td><input type="text" name="zipurl" /></td>

        </tr>
        <tr>
            <td>Spilt to Valume Size:  part</td>
            <td><input type="text" name="spitsize" value="50"/></td>

        </tr>
        <tr>
            <td>Mega bite (1 On/ 0 off) </td>
            <td><input type="text" name="megabyte" value="1"/></td>

        </tr>
        <tr>
            <td>Kilo Byte (1 On/ 0 off)</td>
            <td><input type="text" name="kilobyte" value="0"/></td>

        </tr>
    </table>
    <input type="submit" name="ssurlsubmit" value="submit" />
    </form>

</body>
<?php 
$mypath = getcwd();
  $mypath = preg_replace('/\\\\/', '/', $mypath);

$targetfolder = $mypath.'/tmp';
echo 'targetfolder is:   '.$targetfolder.'<br />';
    if (!is_dir("$mypath/tmp")) {
mkdir("$mypath/tmp");
echo 'Dir'.$targetfolder.'created'.'<br />';

} 

$targetfolder = $mypath.'/tmp'.'<br />';

/*
if(!file_exists($targetfolder)) {
    if(mkdir($targetfolder)) {
        echo "Created target folder $targetfolder".br();
    }
    else{
    echo '$targetfolder can not be created'.br();
}
}else
{
echo $targetfolder.'$targetfolder exist '.br();
}
*/
?>
</html>

<?php
/*
 --------------------------------------------------
 filesplit.php HJSplit compatiple PHP file splitter
 --------------------------------------------------

 File name: 
    filesplit.php                
 Author: 
    Umit Tirpan 2007-03-22          
    Umit Tirpan 2008-03-12 [remote file support added]         
 Author's Website: 
    http://forum.iyinet.com/

 Description:
    This PHP script, splits the files into smaller pieces in binary.
    It is compatiple with HJSplit, so you can re-join splitted files using HJSplit's Join utility.
    It can split a file up to 999 pieces.

 What is the use, why will I use this?
    Some webmasters do not have shell access to their websites. This prevents them splitting big files, ie. MySQL backups, into smaller files. Splitting a 200Mb file into 10 x 20Mb file may be easy on webmaster to download in pieces. 

 How to run:
    Make sure your webserver has write permission on the target folder.
    Edit variables. 
    Upload (ftp) this file to your webserver or run on your PC.
    For security reason, filename is hardcoded. You can modify code to accept $_GET['filename']

 Run with your favorite browser.
    http://www.<your-web-site>.com/filesplit.php
 Or run on shell (ie. ssh)
    php filesplit.php

 It is Ok to share and modify this code and use in/with your applications. No restrictions.

 */

// ---------------------------
// Edit variables (3 variables)
// ---------------------------

// File to split, is its not in the same folder with filesplit.php, full path is required.

global $ssurl,$filename;
if (isset($_POST['zipurl'])) {
$url=$_POST['zipurl'];
$filename=$_POST['zipurl'];
echo "URL:".$url.'<br />';
}

//  $filename = "http://www.iyinet.com/my-big-file.zip"; 

// Target folder. Splitted files will be stored here. Original file never gets touched.
// Do not append slash! Make sure webserver has write permission on this folder.
$mypath = getcwd();
  $mypath = preg_replace('/\\\\/', '/', $mypath);

$targetfolder = $mypath.'/tmp';
echo 'targetfolder is:   '.$targetfolder.'<br />';
    if (!is_dir("$mypath/tmp")) {
mkdir("$mypath/tmp");
echo 'Dir'.$targetfolder.'created'.'<br />';

} 

$targetfolder = $mypath.'/tmp';

// File size in Mb per piece/split. 
// For a 200Mb file if piecesize=10 it will create twenty 10Mb files
$piecesize = 50; // splitted file size in MB
if (isset($_POST['spitsize'])) {
$piecesize=$_POST['spitsize'];

}

//$piecesize = 10; // splitted file size in MB

// ---------------------------
// Do NOT edit this section
// ---------------------------

$buffer = 1024;
if (isset($_POST['megabyte'])and $_POST['megabyte']=='1') {
//$piece=$_POST['megabyte'];
$piece = 1048576*$piecesize;

}
if (isset($_POST['kilobyte']) and $_POST['kilobyte']==1) {
//$piece=$_POST['kilobyte'];
$piece = 1024*$piecesize;

}
//$piece = 1048576*$piecesize;
$current = 0;
$splitnum = 1;

if(!file_exists($targetfolder)) {
    if(mkdir($targetfolder)) {
        echo "Created target folder $targetfolder".br();
    }
    echo '$targetfolder folder exist'.br();
}

if(!$handle = fopen($filename, "rb")) {
    die("Unable to open $filename for read! Make sure you edited filesplit.php correctly!".br());
}

$base_filename = basename($filename);
/*
$ss=substr($base_filename,-4);
echo substr($base_filename,-4).'<br />';
if ($ss=='.zip') 
 { 
 $end='.zip';

 $base_filename= removeFromEnd($base_filename, '.zip');
 }
 */
$piece_name = $targetfolder.'/'.$base_filename.'.'.str_pad($splitnum, 3, "0", STR_PAD_LEFT). $end;
if(!$fw = fopen($piece_name,"w")) {
    die("Unable to open $piece_name for write. Make sure target folder is writeable.".br());
}
echo "Splitting $base_filename into $piecesize Mb files ".br()."(last piece may be smaller in size)".br();
echo "Writing $piece_name...".br();
while (!feof($handle) and $splitnum < 999) {
    if($current < $piece) {
        if($content = fread($handle, $buffer)) {
            if(fwrite($fw, $content)) {
                $current += $buffer;
            } else {
                die("filesplit.php is unable to write to target folder. Target folder may not have write permission! Try chmod +w target_folder".br());
            }
        }
    } else {
        fclose($fw);
        $current = 0;
        $splitnum++;
        $piece_name = $targetfolder.'/'.$base_filename.'.'.str_pad($splitnum, 3, "0", STR_PAD_LEFT);
        echo "Writing $piece_name...".br();
        $fw = fopen($piece_name,"w");
    }
}
fclose($fw);
fclose($handle);
echo "Done! ".br();
exit;

function br() {
    return (!empty($_SERVER['SERVER_SOFTWARE']))?'<br>':"\n";
}
function removeFromEnd($string, $stringToRemove) {
     $stringToRemoveLen = strlen($stringToRemove);
     $stringLen = strlen($string);

     $pos = $stringLen - $stringToRemoveLen;    

     $out = substr($string, 0, $pos);

     return $out;
 }
?> 
```

您可以通过以下方式对其进行测试：

[http://restss2.frogcp.com/tmp/filesplit%2520%282%29.php](http://restss2.frogcp.com/tmp/filesplit%2520%282%29.php)

# maven - mvn clean package，我想把创建的jar复制到当前目录

> ID：12030844
> 
> 赞同：6
> 
> 时间：2012-08-19T23:36:56.213
> 
> 标签：maven

我想更新我的 pom.xml 以便当有人使用：mvn clean package 时，将生成的 jar 文件复制到当前目录。我正在查看 maven 插件复制资源，但我不确定如何指定当前目录，是否有与操作系统无关的方法来执行此操作？如果可能的话，希望它也能在 Windows 上工作

```
<plugin>
                    <artifactId>maven-resources-plugin</artifactId>
                    <version>2.4.3</version>
                    <executions>
                        <execution>
                            <id>copy-resources</id>
                            <!-- here the phase you need -->
                            <phase>validate</phase>
                            <goals>
                                <goal>copy-resources</goal>
                            </goals>
                            <configuration>
                                <outputDirectory>${basedir}</outputDirectory>
                                <resources>
                                    <resource>
                                        <directory>target/Test-0.0.1-SNAPSHOT.jar</directory>
                                        <filtering>true</filtering>
                                    </resource>
                                </resources>
                            </configuration>
                        </execution>
                    </executions>
                </plugin> 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T05:31:02.880

如果您的意思是当前目录，`${project.basedir}`那么是的，您可以轻松地做到这一点。只需确保将`${build.finalName}.jar`其用作文件名部分，因为它将正确获取`<packaging>`设置为`jar`（默认值）的项目的主要工件。

```
 <execution>
      <id>copy-resources</id>
         <!-- here the phase you need -->
      <phase>validate</phase>
      <goals>
        <goal>copy-resources</goal>
      </goals>
      <configuration>
      <outputDirectory>${project.basedir}</outputDirectory>
      <resources>
        <resource>
          <!-- Get main artifact -->
          <directory>target/${build.finalName}.jar</directory>
          <!-- Don't filter binary files -->
          <filtering>false</filtering>
        </resource>
      </resources>
      </configuration>
    </execution> 
```

如果您想改为使用当前工作目录，则应该可以使用`${user.dir}`as`outputDirectory`

# c++ - 指向结构的指针 - 无法理解特定的代码片段

> ID：12030852
> 
> 赞同：0
> 
> 时间：2012-08-19T23:38:39.333
> 
> 标签：c++

这是代码：

```
// pointers to structures
#include <iostream>
#include <string>
#include <sstream>
using namespace std;

struct movies_t {
  string title;
  int year;
};

int main ()
{
  string mystr;

  movies_t amovie;
  movies_t * pmovie;
  pmovie = &amovie;

  cout << "Enter title: ";
  getline (cin, pmovie->title);
  cout << "Enter year: ";
  getline (cin, mystr);
  (stringstream) mystr >> pmovie->year;

  cout << "\nYou have entered:\n";
  cout << pmovie->title;
  cout << " (" << pmovie->year << ")\n";

  return 0;
} 
```

取自[http://www.cplusplus.com/doc/tutorial/structures/](http://www.cplusplus.com/doc/tutorial/structures/)。我希望我能澄清一些事情。

1.  它是什么`getline`以及它是如何工作的？我尝试查找文档，但我仍然无法理解。此外，究竟是什么`cin`以及它是如何使用的`getline`？

2.  如果我理解正确，`pmovie->title`基本上是说`pmovie`指向`title`对象的成员`amovie`？如果是这样，并且从对#1的解释中还不清楚，它是如何`getline (cin, pmovie->title)`工作的？

3.  现在这`(stringstream) mystr >> pmovie->year`给我带来了最大的麻烦。什么是 a `stringstream`，例如，我们是否像将 double 转换为 int 一样使用它？

谢谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:45:16.910

> 什么是 getline，它是如何工作的？我尝试查找文档，但我仍然无法理解。另外，cin 到底是什么，它是如何与 getline 一起使用的？

该`getline`函数从 a 中读取一行`istream`。`cin`流是指您的标准输入流，通常是您从中获取输入的流。它被传递给`getline`它以告诉它从哪个输入流中获取一行。

> 如果我理解正确， pmovie->title 本质上是说 pmovie 指向对象 amovie 的成员标题？如果是这样，并且从对#1 的解释中还不清楚，getline (cin, pmovie->title) 是如何工作的？

这些`getline`函数从其中读取一行`cin`并将其存储在`pmovie->title`通过引用传递的行中。

> 现在这个 (stringstream) mystr >> pmovie->year 给我带来了最大的麻烦。什么是字符串流，例如，我们是否像将 double 类型转换为 int 一样使用它？

A`stringstream`是一个使字符串像流一样工作的类。这是一种令人困惑的语法（C 风格的转换），这使得理解它正在发生的事情变得有点困难。基本上，临时`stringstream`创建并使用`mystr`. A `stringstream`，当用字符串初始化时，会为您提供一个流，您可以从中读取这些内容。`>>`运算符从输出流中读取，在本例中为 into ，`pmovie->year`它再次通过引用传递。

顺便说一句，在我看来，您似乎在尝试理解异常复杂和令人困惑的用途，但尚未了解这些对象的更基本用途。这是一个非常难学的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:55:42.897

大多数问题似乎根本与结构无关。因此，我正在解决与标题相关的问题，而不是与流相关的问题：

> 如果我理解正确， pmovie->title 本质上是说 pmovie 指向对象 amovie 的成员标题？如果是这样，并且从对#1 的解释中还不清楚，getline (cin, pmovie->title) 是如何工作的？

你误会了。我猜，这是你困惑的根源：`pmovie`指向一个`movies_t`对象。碰巧的是，在示例代码中，它被初始化为指向`movies_t`名为 的对象`amovie`。

现在，每个`movies_t`对象都有两个成员，即子对象： a`title`和 a `year`。要访问指针指向的`title`组件，请使用. 要访问该组件，您可以使用.`movies_t``pmovie->title``year``pmovie->year`

不过，关于流，我要说的一件事是：在假设读取成功之前，您应该始终检查您的输入是否成功。例如，您将检查读取一行是否成功使用

```
if (std::getline(std::cin, pmovie->title)) {
    // deal with a successfully read title
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:50:13.303

1.  `cin`是由 C++ 定义的特殊流，用于处理标准输出（通常是键盘，但几乎可以是任何东西）。`getline`是一个函数，允许您从流中读取文本到缓冲区，直到遇到平台的行尾（UNIX 上的换行，Windows 和 DOS 的回车换行）。
2.  `pmovie->title`表示这`pmove`是一个指向具有名为 的成员的结构的指针`title`。这是指那个成员。因为`getline`需要一个`string&`（字符串引用），所以它很乐意接受 . 引用的字符串`pmovie->title`。
3.  `stringstream`定义了一个将`string`s 转换为`stringstream`s 的隐式构造函数。运算符从字符串中`>>`获取输入并将其转换为目标类型（ 右侧的操作数的类型`>>`）并将其放在那里。这只是将字符串转换为整数的一种方式。

# c++ - 在 C++ 中检测 youtube 的全屏模式

> ID：12030853
> 
> 赞同：2
> 
> 时间：2012-08-19T23:38:53.280
> 
> 标签：c++, windows, google-chrome, web, youtube

我期待以某种方式在 C++ 中检测用户是否有一些网络应用程序，例如全屏模式下的 Youtube。

这样我可以防止在焦点上显示通知，因此不会打扰用户。

**编辑1**

*   应该支持 Windows XP SP III 及更高版本（或至少支持 Win 7 及更高版本。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T02:28:31.930

以下代码来自[http://www.deanlee.cn/windows/how-to-detect-whether-or-not-user-is-running-a-full-screen-program/](http://www.deanlee.cn/windows/how-to-detect-whether-or-not-user-is-running-a-full-screen-program/)。

```
bool IsFullScreenMode()
{
  int w = GetSystemMetrics(SM_CXSCREEN);
  int h = GetSystemMetrics(SM_CYSCREEN); 

  HWND hWnd = 0;
  while (hWnd = FindWindowEx(NULL, hWnd, NULL, NULL))
  {
    if (GetWindowLong(hWnd, GWL_EXSTYLE) & WS_EX_TOPMOST)
    {
      RECT rcWindow;
      GetWindowRect(hWnd, &rcWindow);
      if ((w == (rcWindow.right - rcWindow.left)) &&
         (h == (rcWindow.bottom - rcWindow.top)))
           return true;
     }
  }
  return false;
} 
```

# ruby-on-rails - Rails：使用“添加新”选项下拉，创建更多表单字段

> ID：12030856
> 
> 赞同：1
> 
> 时间：2012-08-19T23:39:36.587
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我想在表格上有一个下拉菜单。例如，用户正在选择一种设备类型。但是，如果它不在下拉列表中，我希望有一个“添加新”选项，当单击它时，会弹出更多用户必须填写的字段。

所以本质上，当提交表单时，它会创建两个新的模型对象：Equipment 和 EquipmentType。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T06:43:30.910

我不确定您到底需要什么，所以我为您指出两个解决方案：

1.  当您单击“添加新”时，您需要填写多个字段。这是这个 gem 的标准情况：[nested_form](https://github.com/ryanb/nested_form)和[cocoon](https://github.com/nathanvda/cocoon)。

    外观示例：[http ://railscasts.com/episodes/196-nested-model-form-part-1?view=asciicast](http://railscasts.com/episodes/196-nested-model-form-part-1?view=asciicast)

2.  当您单击“添加新”并且只想为 `has_many`关联添加另一个选项时。在这种情况下，您可以将标准多选转换为这种行为。看看这个问题：[https](https://stackoverflow.com/questions/2867795/best-jquery-multiselect-plugin) ://stackoverflow.com/questions/2867795/best-jquery-multiselect-plugin ，有几个插件可以解决这个问题。

    示例： http: [//odyniec.net/projects/selectlist/examples.html](http://odyniec.net/projects/selectlist/examples.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-15T11:15:00.580

据我所知，它仍然没有宝石。我假设您有两个模型，`Equipment`和`EqipmentType`，它们每个都有`:name`并且它们通过`belongs_to/has_many`关联连接。

我的解决方案将添加一个`attr_accessor :new_equipment_type`to `Equipment`，在提交表单后填充。

然后，如果需要，它会创建一个新的设备类型并将其连接到设备：

```
# app/models/equipment.rb
class Equipment < ActiveRecord::Base
  belongs_to :equipment_type
  attr_accessible :name, :equipment_type_id, :new_equipment_type
  attr_accessor :new_equipment_type

  def new_equipment_type=(val)
    if equipment_type_id.blank?
      write_attribute(:equipment_type_id, EquipmentType.create(name: val).id)
    end
  end

end

# app/models/equipment_type.rb
class EquipmentType < ActiveRecord::Base
  has_many :equipments
  attr_accessible :name
end 
```

The form has a dropdown with existing equipment types and when a blank option is selected, new input is shown for a new equipment type name:

```
#app/views/equipments/_form.html.haml
= simple_form_for [@equipment] do |f|
  = f.input :name
  = f.association :equipment_type, include_blank: "Add new"
  = f.input :new_equipment_type, input_html: {value: "New equipment type name"}, wrapper_html: {style: "#{if @equipment.equipment_type_id.present? then 'display:none;' else '' end}"} 
```

最后用 javascript 显示/隐藏新的设备类型字段：

```
#app/assets/javascripts/equipments.js.coffee:
@showOrHideNewEquipmentTypeField = (drop_down) ->
  new_equipment_type = $(drop_down).closest('form').find('div.input[class*=new_equipment_type]')
  if $(drop_down).val()
    $(new_equipment_type).slideUp()
  else
    $(new_equipment_type).slideDown()

$ ->
  $('[name*=equipment_type_id]').change ->
    showOrHideNewCategoryField(@) 
```

# html - 背景图片不显示

> ID：12030860
> 
> 赞同：0
> 
> 时间：2012-08-19T23:40:16.857
> 
> 标签：html, css

我正在使用以下 css 文件生成一个简单的布局作为测试：

```
@font-face {
    font-family: blackboard;
    src: url('../fonts/KGTenThousandReasons.ttf');
}

body {
    font-family: blackboard;
    font-size: 1.3em;
    color: #FFF;
    margin: 0px;
}

html {
    background-image: url('../images/Chalkboard.jpg') no-repeat center center fixed;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
}

.container {
    margin: 0 auto;
    width: 980px;
}

#header {
    text-align: center;
    margin-top: 15px;
}

#header p {
    font-size: 0.5em;
}

#left_column {
    float: left;
}

#right_column {
    float: right;
}

.list {

}

.list li {
    margin: 5px;
}

.list ul {
    list-style-type: none;
    font-size: 0.7em;
}

.list2 {
    position: relative;
    width: 200px;
    list-style-type: none;
    top: 75px;
    right: 100px;
    font-size: 0.6em;
    float: left;
}

.clear_both {
    clear: both;
}

#footer {
    width: 100%;
    height: 50px;
    font-size: 0.5em;
}

.small_container {
    position: relative;
    top: 25%;
    height: 100%;
    text-align: center;
}

a {
    color: white;
    text-decoration: none;
}

a:hover {
    color: gray;
}

.selected {
    color: gray;
    font-weight: bolder;
}

.paginate {
    border: 1px solid whitesmoke;
    padding-left: 10px;
    padding-right: 10px;
    margin: 5px;
}

#pagination {
    padding-top: 10px;
}

h1 {
    font-size: 1.1em;
} 
```

我遇到的问题是当我将 html 标签的背景图片上传到我的托管服务时，它不会显示出来。它在我的本地机器上完美运行。我具体谈论的是这些：

```
html {
        background-image: url('../images/Chalkboard.jpg') no-repeat center center fixed;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
    } 
```

字体很好，其他一切都很好，只是背景图像不会产生结果。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T06:07:32.113

将“背景图像”更改为“背景”。

```
html {
        background: url('../images/Chalkboard.jpg') no-repeat center center fixed;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:47:05.207

您确定图像的路径正确吗？您不会偶然忘记上传它，或者将其上传到本地计算机上的不同文件夹...在 chrome 检查器中检查它，看看浏览器是否可以实际找到图像。或者尝试设置图像的绝对路径而不是相对路径。

# nhibernate - NHibernate 在保存子类时向基类插入两次。违反唯一约束

> ID：12030863
> 
> 赞同：0
> 
> 时间：2012-08-19T23:40:57.793
> 
> 标签：nhibernate, fluent-nhibernate

我正在使用流利的 nhibernate 和遗留的 oracle db，以及 Devart Entity Developer 来生成映射和实体类。

我有一个基表 Product，它有几个子类，包括 Tour。保存 Tour 时，nhibernate 向 Product 表发出 2 个相同的插入，这违反了 PK 唯一约束。

产品映射为：

```
public class ProductMap : ClassMap<Product>
{
    public ProductMap()
    {
        Schema("CT_PRODUCTS");
        Table("PRODUCT");
        OptimisticLock.None();
        LazyLoad();
        CompositeId()
            .KeyProperty(x => x.Season, set =>
            {
                set.Type("CT.DomainKernel.Enums.Season,CT.DomainKernel");
                set.ColumnName("SEASON");
                set.Access.Property();
            })
            .KeyProperty(x => x.ProductCode, set =>
            {
                set.ColumnName("PROD_CODE");
                set.Length(10);
                set.Access.Property();
            });
        Map(x => x.Name)
            .Column("NAME")
            .Access.Property()
            .Generated.Never()
            .CustomSqlType("VARCHAR2")
            .Length(200);
        HasOne(x => x.Tour)
            .Class<Tour>()
            .Access.Property()
            .Cascade.SaveUpdate()
            .LazyLoad();
    }
} 
```

旅游地图是：

```
public class TourMap : SubclassMap<Tour>
{
    public TourMap()
    {
        Schema("CT_PRODUCTS");
        Table("TOUR");
        LazyLoad();
        KeyColumn("SEASON");
        KeyColumn("PROD_CODE");
        Map(x => x.Duration)
            .Column("DURATION")
            .Access.Property()
            .Generated.Never()
            .CustomSqlType("NUMBER")
            .Not.Nullable()
            .Precision(3);
        HasOne(x => x.Product)
            .Class<Product>()
            .Access.Property()
            .Cascade.SaveUpdate()
            .LazyLoad()
            .Constrained();
    }
} 
```

旅游实体类：

```
public partial class Tour2 : Product
{
    public virtual Product Product
    {
        get
        {
            return this._Product;
        }
        set
        {
            this._Product = value;
        }
    }
} 
```

关于出了什么问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:37:55.627

对此的解决方案是从 Tour 到 Product 以及从 Product 到 Tour 移除 Property 引用，这在考虑时无论如何都是没有意义的。

# java - Sublime Text 2 不会运行 Java

> ID：12030865
> 
> 赞同：1
> 
> 时间：2012-08-19T23:42:00.890
> 
> 标签：java, compilation, sublimetext2

我最近得到了 Sublime Text 2，到目前为止我有些头疼，最大的一个来自这个：

```
public class bob{

    public static void main(String[] args){

        System.out.println("Sublime Text 2!");

    }

} 
```

因为它根本不会运行。它只是不会运行。我按 F7 并没有任何反应，除了它输出以下内容：

```
[Finished in *s] 
```

我不知道为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T00:04:29.397

默认的 Java 构建系统在编译后不会运行您的程序。

如果您打开`...\Packages\Java\JavaC.sublime-build`并将构建系统文件的内容替换为：

```
{
  "cmd": ["javac", "$file_name","&&","java", "$file_base_name"],
  "working_dir": "${project_path:${folder}}",
  "selector": "source.java",
  "shell": true
} 
```

**编辑：**在上面，您需要连接多个命令以使 shell 执行，因为构建系统本身不支持列出多个命令。

然后它会在你构建时编译并运行你的程序（`F7`）。

这是一个非常简单的构建系统，显然只适用于简单的程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-07T23:28:15.040

这是在 sublime 2 中运行 java 的另一种解决方案：

使用以下内容制作 bat 文件，并将其保存在 PATH 中的任何位置。我建议 C:\Program Files\Java\jdk*\bin\ 将所有内容放在一起。

```
@ECHO OFF
cd %~dp1
javac %~nx1
java %~n1 
```

然后编辑 C:\Users\your_user_name\AppData\Roaming\Sublime Text 2\Packages\Java\JavaC.sublime-build，内容将是

```
{
   "cmd": ["javac", "$file"],
   "file_regex": "^(...*?):([0-9]*):?([0-9]*)",
   "selector": "source.java"
} 
```

将“javac”替换为 bat 文件的名称（例如 javacexec.bat）并保存。

现在您应该可以使用 ctrl+b 运行它了。

# jquery - 从 Bootstrap Collapse 插件的标题中添加/删除（in）活动类

> ID：12030868
> 
> 赞同：1
> 
> 时间：2012-08-19T23:42:29.963
> 
> 标签：jquery, twitter-bootstrap

我正在与引导程序中的崩溃 JS 搏斗。在我的网站上，我想使用折叠来显示一些内容。我希望，每当用户单击标题以将“活动”类应用于它时。它已经从“非活动”类开始。因此，当您单击它时，它会从非活动状态变为活动状态。另一方面，当您重新单击同一标题时，它应该也变回非活动状态。这不是它现在所做的。

这是 JSfiddle： http: [//jsfiddle.net/Malachute/tZeT8/1/](http://jsfiddle.net/Malachute/tZeT8/1/) 不要介意崩溃不起作用，这对我来说是有效的，并且错误地复制到了 JSfiddle。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:58:47.457

我想你正在寻找这样的东西。对不起，它不漂亮：

```
$(function(){
var sidebar = $('.accordion-heading');  // cache sidebar to a variable for performance

sidebar.delegate('.accordion-toggle','click',function(){ 
  if($(this).hasClass('active')){
    $(this).removeClass('active');
   $(this).addClass('inactive');
 }else{
  sidebar.find('.active').addClass('inactive');          
  sidebar.find('.active').removeClass('active');   
  $(this).removeClass('inactive');
  $(this).addClass('active');
 }
});
}); 
```

更新小提琴：http: [//jsfiddle.net/ckaufman/tZeT8/2/](http://jsfiddle.net/ckaufman/tZeT8/2/)

# php - 将多个 CodeIgniter 的控制器合并到同一个视图中

> ID：12030873
> 
> 赞同：0
> 
> 时间：2012-08-19T23:44:57.820
> 
> 标签：php, codeigniter

所以我有一个控制器来显示站点布局，然后我有另一个控制器来管理电子邮件。我的问题是如何将它们组合到同一个页面（相同的视图）我只是将我的电子邮件控制器的功能添加到我的站点控制器？那么该站点控制器具有 send() 方法，然后将所有内容从我的“新闻通讯”视图移动到我的“主页”视图中？

## 现场控制器

```
<?php

      class Site extends CI_Controller 
   {

    function index()
      {
        $this->load->model('site_model');
        $data['records']= $this->site_model->getAll();
        $this->load->view('home',$data);
      }

   }

 ?> 
```

## 电子邮件控制器

```
class Email extends CI_Controller{

    function index()
    {

        $this->load->view('newsletter');
    }

    function send()
    {
        $this->load->library('form_validation');

        //field name, error message, validaion rules
        $this->form_validation->set_rules('name', 'Name', 'trim|required');
        $this->form_validation->set_rules('name', 'Email Address', 'required');

        if($this->form_validation->run()==FALSE)
        {
            $this->load->view('newsletter');

        }

        else
        {
        $name = $this->input->post('name');
        $email = $this->input->post('email');

        $this->load->library('email');
        $this->email->set_newline("\r\n");

        $this->email->from('', '');
        $this->email->to($email);
        $this->email->subject('This is an email test');
        $this->email->message('Sucess');

        $path = $this->config->item('server_root');
        $file = $path  .'CodeTest/attachments/newsletter1.txt';

        $this->email->attach($file);

        if($this->email->send())
        {
            echo ' Your email has been sent.';
        }

        else {

            show_error($this->email->print_debugger());

             }

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T23:58:02.323

您是否从站点控制器中的方法中删除了此代码块？
此代码自动将您转发到时事通讯页面。您必须将其从站点控制器中删除

```
if($this->form_validation->run()==FALSE){
  $this->load->view('newsletter');
} 
```

# ios - Obj-C 和 VB.Net 之间的加密兼容性

> ID：12030874
> 
> 赞同：2
> 
> 时间：2012-08-19T23:45:14.703
> 
> 标签：ios, vb.net, aes

加密字符串的方法大约有 100,000 种。使用 AES、CBC 和 PKCS7 等标准使事情变得更容易——但 IV 仍然存在问题。盐、编码等（如[www.Crypto.Stackexchange.com](https://crypto.stackexchange.com/questions/3022/what-is-the-difference-between-these-aes-encryption-methods)上所述）

对于我的 iOS 项目 (Obj-C)，我正在使用[FBEncryptor 项目](https://github.com/dev5tec/FBEncryptor)，这是一种简单且有据可查的加密字符串的方法。但是，我需要能够解密由 Windows 平台上的 FBEncryptor 生成的 iOS AES 字符串的代码 - 最好是 VB.NET。

我还没有找到另一个与 FBEncryptor 兼容的 VB.NET 项目。

**有谁知道使用 FBEncryptor 的任何 VB.NET 加密项目？如果没有，那么我需要做什么才能使 Rijndael 托管库（由 Microsoft 提供）与 FBEncryptor 一起使用？**

[我使用Rijndael Managed](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx)的​​ VB.NET 代码：

```
Imports System.Security
Imports System.Security.Cryptography
Imports System.IO
Imports System.Runtime.InteropServices
Imports System.Text.RegularExpressions
Imports System.Text

Module Encrypt2
Public saltBytes As Byte()
Dim hashAlgorithm As String = "SHA1"

Public Sub GenerateSalt()
    ' Define min and max salt sizes.
    Dim minSaltSize As Integer
    Dim maxSaltSize As Integer

    minSaltSize = 8
    maxSaltSize = 8

    ' Generate a random number for the size of the salt.
    Dim random As Random
    random = New Random()

    Dim saltSize As Integer
    saltSize = random.Next(minSaltSize, maxSaltSize)

    ' Allocate a byte array, which will hold the salt.
    saltBytes = New Byte(saltSize - 1) {}

    ' Initialize a random number generator.
    Dim rng As RNGCryptoServiceProvider
    rng = New RNGCryptoServiceProvider()

    ' Fill the salt with cryptographically strong byte values.
    rng.GetNonZeroBytes(saltBytes)
End Sub

Public Function Encrypt(ByVal plainText As String, ByVal keyword As String) As String
    Dim hashAlgorithm As String = "SHA1"
    Dim passwordIterations As Integer = 128
    Dim initVector As String = "@7781157e2629b09"
    Dim keySize As Integer = 256

    Dim initVectorBytes As Byte() = Encoding.ASCII.GetBytes(initVector)

    Dim plainTextBytes As Byte() = Encoding.ASCII.GetBytes(plainText)

    GenerateSalt()

    Dim password As New Rfc2898DeriveBytes(keyword, saltBytes, passwordIterations)

    Dim keyBytes As Byte() = password.GetBytes(keySize \ 8)
    Dim symmetricKey As New RijndaelManaged()

    symmetricKey.Mode = CipherMode.CBC

    Dim encryptor As ICryptoTransform = symmetricKey.CreateEncryptor(keyBytes, initVectorBytes)

    Dim memoryStream As New MemoryStream()
    Dim cryptoStream As New CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write)

    cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length)
    cryptoStream.FlushFinalBlock()
    Dim cipherTextBytes As Byte() = memoryStream.ToArray()
    memoryStream.Close()
    cryptoStream.Clear()

    Dim cipherText As String = Convert.ToBase64String(cipherTextBytes)

    Return (cipherText)

End Function

Public Function Decrypt(ByVal cipherText As String, ByVal keyword As String) As String

    Dim hashAlgorithm As String = "SHA1"

    Dim passwordIterations As Integer = 128
    Dim initVector As String = "@7781157e2629b09"
    Dim keySize As Integer = 256

    ' Convert strings defining encryption key characteristics into Byte
    ' arrays. Let us assume that strings only contain ASCII codes.
    ' If strings include Unicode characters, use Unicode, UTF7, or UTF8
    ' encoding

    Dim initVectorBytes As Byte() = Encoding.ASCII.GetBytes(initVector)

    ' Convert the Ciphertext into a Byte array
    Dim cipherTextBytes As Byte() = Encoding.ASCII.GetBytes(cipherText)

    ' First we must create a password, from which the key will be 
    ' derived. This password will be generated from the specified
    ' passphrase and salt value. The password will be created using 
    ' the specified hash algorithm. Password creation can be done in 
    ' several iterations
    GenerateSalt()
    Dim password As New Rfc2898DeriveBytes(keyword, saltBytes, passwordIterations)

    ' Use the password to generate pseudo-random bytes for the encryption
    ' key. Specify the size of the key in bytes (instead of bits)

    Dim keyBytes As Byte() = password.GetBytes(keySize \ 8)

    ' Create uninitialized Rijndael encryption object

    Dim symmetricKey As New RijndaelManaged()

    ' It is reasonable to set encryption mode to Cipher Block Chaining
    ' (CBC). Use default options for other symmetric key parameters.
    symmetricKey.Mode = CipherMode.CBC

    ' Generate decryptor from the existing key bytes and initialization
    ' vector. Key size will be defined based on the number of the key
    'bytes

    Dim decryptor As ICryptoTransform = symmetricKey.CreateDecryptor(keyBytes, initVectorBytes)

    ' Define memory stream which will be used to hold encrypted data.

    Dim memoryStream As New MemoryStream(cipherTextBytes)

    ' Define cryptographic stream (always user Read mode for encryption).
    Dim cryptoStream As New CryptoStream(memoryStream, decryptor, CryptoStreamMode.Read)

    ' Since at this point we don't know what the size of decrypted data
    ' will be, allocate the buffer long enough to hold ciphertext;
    ' plaintext is never longer than ciphertext
    Dim plainTextBytes As Byte() = New Byte(cipherTextBytes.Length - 1) {}

    ' Start decrypting.
    Dim decryptedByteCount As Integer = cryptoStream.Read(plainTextBytes, 0, plainTextBytes.Length)

    ' Close both streams
    memoryStream.Close()
    cryptoStream.Close()

    ' Convert decrypted data into a string
    ' Let us assume that the original plaintext string was UTF8-Encoded.
    Dim plainText As String = Encoding.UTF8.GetString(plainTextBytes, 0, decryptedByteCount)

    ' Return the decrypted string
    Return (plainText)

End Function

End Module 
```

您会注意到 IV 是静态的，并且密码迭代次数很少。这是因为我不确定如何以与 FBEncryptor 相同的方法生成 IV。您可能还会注意到，在尝试解密时，字节长度存在问题。

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:00:53.470

一注。我查看了 FBEncryptor。它使用了一些不好的做法。因此，如果安全性对您很重要，我建议您多阅读一些内容，然后选择另一个进行加密的代码（或自己编写）。

FBEncryptor 进行以下加密 a) 将字符串转换为字节数组（基于 UTF8 编码） b) 将密钥转换为字节数组（基于 UTF 编码）。c) 只复制密钥的前 16 个字节 d) 创建 16 个 0x00 字节的 IV e) 使用 AES/CBC/PKCS7Padding 加密项目 a) 中的字节数组，并在 d) 中创建 IV f) 生成的加密数据转换为 Base64

并且它执行以下解密 a) 将加密字符串从 Base64 转换为字节数组 b) 将密钥转换为字节数组（基于 UTF 编码）。c) 只复制密钥的前 16 个字节 d) 创建 IV，它是 0x00 的 16 个字节 e) 使用 AES/CBC/PKCS7Padding 从项 a) 解密字节数组，IV 在 d) 中创建 f) 将加密数据从 e) 转换为使用 UTF8 编码的字符串

你应该在 VB.NET 中做同样的事情。我认为您几乎拥有所有部分-您将需要删除所有与 SHA1 和盐相关的东西，并使用相当于步骤 b) 的内容。你需要研究 PKCS7Padding for VB.NET

# java - 类对象的 Java 向量

> ID：12030879
> 
> 赞同：0
> 
> 时间：2012-08-19T23:45:58.227
> 
> 标签：java

我想动态创建自定义类对象的向量。当程序运行时，tableClassName 变量包含从 xml 请求中获取的类名。当我尝试以下方式时，它给了我一个错误。

```
 Class tableClass = Class.forName(tableClassName).asSubclass(comm.Table.class);
 Vector<tableClass> MappingLookupResu = new Vector<tableClass>(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:00:04.227

这就像写作`mappingLookupResult = new Vector< String.class >();`

`mappingLookupResult = new Vector< String >();`是合法的，但是您提供的是（“类”类的）对象，而不是类定义。如果您的对象是“comm.Table”，请尝试：

```
mappingLookupResult = new Vector< comm.Table >(); 
```

或者

```
mappingLookupResult = new Vector< ? extends comm.Table >(); 
```

另外-您是否`Vector`出于特定原因使用？ **`ArrayList`**如果不需要同步，速度会更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:53:25.987

由于泛型主要是仅编译时的构造，因此您不能基于运行时提供的 a来实例化泛型类型参数（在本例`T`中为） 。 `Vector<T>``String`

无论如何，这没有任何意义：与您交互的任何人`Vector`都不会拥有使用具体类型处理向量所需的信息。如果他们这样做了，那么他们可以直接为您`Class<? extends Table>`提供而不是提供类名。

但是，您可以确保向量类型参数的上限为`Table`. 您需要做什么取决于您实际与`Vector`. 例如，如果要将类型的新实例放入其中，则需要键入`tableClass`：

```
 Class<? extends Table> tableClass =      
     Class.forName(tableClassName).asSubclass(Table.class);
 Vector<Table> result  = new Vector<Table>();
 result.add(tableClass.newInstance()); 
```

# gcc - static_cast / float / bitset / const 怪异

> ID：12030885
> 
> 赞同：2
> 
> 时间：2012-08-19T23:46:41.997
> 
> 标签：gcc, g++, bitset, static-cast, gcc-pedantic

就在几个小时前，出现了以下问题：[变量不能出现在常量表达式中](https://stackoverflow.com/questions/12030346/variable-cannot-appear-in-a-constant-expression)

幸运的是，提供的答案确实解决了他的问题，但我无法重现该解决方案。

我试图进一步简化代码，现在我陷入了以下困境：

```
#include <bitset>

int main ()
{
   const size_t length_1 = static_cast<const size_t>(1.0f);
   std::bitset<length_1> bits_1;
   const size_t length_2 = static_cast<const size_t>(1.0f / 1.0f);
   std::bitset<length_2> bits_2;
} 
```

如果使用 编译`-pedantic`，则编译器接受第一个示例，但带有除法（但显然相同的数字）的示例被拒绝，并显示消息“length_2 不能出现在常量表达式中”。

没有`-pedantic`和有`-pedantic -std=c++0x`它被接受，没有任何进一步的警告。

这是完整的输出`g++ -v`（我为德语道歉，但我相信无论如何你都会得到正确的信息）：

```
Es werden eingebaute Spezifikationen verwendet.
COLLECT_GCC=g++
COLLECT_LTO_WRAPPER=/usr/lib/gcc/i686-linux-gnu/4.6/lto-wrapper
Ziel: i686-linux-gnu
Konfiguriert mit: ../src/configure -v --with-pkgversion='Ubuntu/Linaro 4.6.3-1ubuntu5' --with-bugurl=file:///usr/share/doc/gcc-4.6/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.6 --enable-shared --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.6 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --enable-plugin --enable-objc-gc --enable-targets=all --disable-werror --with-arch-32=i686 --with-tune=generic --enable-checking=release --build=i686-linux-gnu --host=i686-linux-gnu --target=i686-linux-gnu
Thread-Modell: posix
gcc-Version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5) 
```

这种行为的原因是什么？我猜它`1.0f`被认为是一些特殊的常数，因此改变了 static_cast 的行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T14:45:52.890

答案在 §5.19 中。

C++03 只允许满足*整数常量表达式要求的**算术常量*表达式：“浮动文字（2.13.3）只有在它们被强制转换为整数或枚举类型时才能出现。”

 *因此，尽管处理它似乎是合理的`1.0f/1.0f`，`1`但它仍然超出了标准。避免“目标机器的浮点运算”对我来说听起来像是一个很好的解释。GCC 4.7 需要 libgmp、libmpfr 和 libmpc 才能完成这项工作。

C++11 没有这样的限制。但是准确性仍然是实现定义的。仅“鼓励”实现为编译时和运行时评估提供一致的结果。*

# java - 将 Scriplet 数组转换为 JSTL 数组

> ID：12030887
> 
> 赞同：0
> 
> 时间：2012-08-19T23:47:54.407
> 
> 标签：java, jsp

您好我正在尝试将这段代码更改为 JSTL。我在这里使用脚本。

```
<div id="slider">
<form action="gamepage" method="post">
<div class="sliderclass" id="slider1">
     <% SiteDatabase database = new SiteDatabase();
    Game game =(Game) database.getGames();%>
    <% String[] newgames = game.getNewGames();
       String[] imgSrc = {"images/spidermancover.jpg","images/blackopscover.jpg", "images/laststorycover.jpg", "images/ncaa13cover.jpg"
               ,"images/uncharted3cover.jpg", "images/mariokart7cover.jpg"};%>
   <%for(int i =0; i < 6; i++) {%>
    <div class="contentwrapper">
    <button type="submit" style="border: 0; background: transparent" name="game" VALUE="<%=i%>"><img src="<%=imgSrc[i]%>" name="what"/></button><div id="slidertext"><%= newgames[i] %></div></div>
    <%}%>
</div>
</form>
</div> 
```

像这样

```
<div class="slider">
<div id="slider1" class="sliderclass">
    <jsp:useBean id="games" class="services.SiteDatabase" scope="request">
        <jsp:SetProperty property="gameTitle" name="games" value="gameTitle"/>
    </jsp:useBean>

    <jsp:useBean id="game" class="services.Game" scope="request">
    </jsp:useBean>

    <c:set var="gameTitle" scope="request" value="game"/>
    <c:set var="gameSrc" scope="request"><jsp:getProperty property="gameSrc" name="game"/></c:set>
    <c:set var="gameId" scope="request"><jsp:getProperty property="gameId" name="game"/></c:set>

    <c:forEach var="i" begin="0" end="6">
        <div id="contentwrapper">
            <a href="game.jsp?"><img src="" name="what" /></a>
            <div id="slidertext"><jsp:getProperty property="gameTitle" name="gameTitle" /></div>
        </div>  
    </c:forEach>
 </div>
</div> 
```

脚本工作正常，我只想满足标准并使用 JSTL

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T03:07:05.543

您可以通过 JSTL 迭代数组/列表`<c:forEach/>`。

```
<c:forEach var="img" items="images/spidermancover.jpg","images/blackopscover.jpg",
                           "images/laststorycover.jpg", "images/ncaa13cover.jpg",
                           "images/uncharted3cover.jpg","images/mariokart7cover.jpg">

 <p>
  ${img}
 </p>
</c:forEach> 
```

或者

```
<c:forEach var="game" items="${games.newGames}">
  <p>
   ${game}
  </p>
</c:forEach> 
```

# ios - 在情节提要中为“平铺”创建更大的反面视图

> ID：12030888
> 
> 赞同：0
> 
> 时间：2012-08-19T23:48:25.907
> 
> 标签：ios, uiviewcontroller, core-animation, core-graphics, storyboard

我目前有一个容器视图控制器，它是一个按钮的所在地。当按下它时，我希望视图翻转和增长，类似于 iPad 上的 iTunes。

**主视图控制器布局：**

![在此处输入图像描述](../Images/39b29a265c132620020f7f771b3767de.png)

**翻转容器：**

当按下翻转按钮时，我打算使用这段代码（在容器视图的视图控制器内）来翻转容器：

```
FrontVC *cb = [[FrontVC alloc]initWithFrame:CGRectMake(0, 0, 92, 65)];
FlipVC *cf = [[FlipVC alloc]initWithFrame:CGRectMake(0, 0, 92, 65)];

 [UIView transitionWithView:self.view
                  duration:1
                   options:UIViewAnimationOptionTransitionFlipFromLeft
                animations:^{

                    // Remove last view
                    for (UIView *subview in self.view.subviews) {
                        [subview removeFromSuperview];
                    }
                    [self.view addSubview:(displayingPrimary ? cb: cf)];

                }
                completion:^(BOOL finished) {
                    if (finished) {
                        displayingPrimary = !displayingPrimary;
                    }
                }]; 
```

如果两个视图大小相同，这很有效，我可以使用代码布置视图。FrontVC 和 FlipVC 是 UIView 的子类。

我正在考虑做这样的事情来将视图移动到屏幕的中心，但我从那里被困住了。嘿，我什至不知道这是否可行！**有一个更好的方法吗？**

```
if (!displayingPrimary) {
                        self.view.center = CGPointMake(320.0f, 480.0f);
                        cb.center = CGPointMake(320.0f, 480.0f);
                    }
                    else
                    {
                        self.view.center = CGPointMake(59, 324);
                    } 
```

**我的目标是：**

理想情况下，我希望能够在情节提要中设计翻转视图，并让“磁贴”增长，类似于 iTunes：

![iTunes 翻转](../Images/13adc75220233f57be192a2a9584ecc9.png)

而在我的示例中，我希望它看起来像这样：

![我想要的结果](../Images/a0377b2aebd0975234663cfd995217e4.png)

**我怎么能在故事板中设计这个？**如果我尝试制作视图控制器，我无法将其调整为我希望翻转大小视图控制器的大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:32:32.923

[FlipView](http://dl.dropbox.com/u/60414145/FlipView.zip)项目非常精美，看起来与 iTunes 翻页完全一样。我在演示项目中使用了两个 imageView。实际翻转代码如下：

```
- (IBAction)flip
{
    UIView *fromView, *toView;
    CGPoint pt;
    CGSize size;
    CGFloat sense;

    if(showingView == a) {
        fromView = a;
        toView = b;
        pt = BORIGIN;
        size = BRECT.size;
        sense = -1;
    } else {
        fromView = b;
        toView = a;
        pt = AORIGIN;
        size = ARECT.size;
        sense = 1;
    }

 [UIView animateWithDuration:TIME/2 animations:^
    {
        CATransform3D t = CATransform3DIdentity;
        t.m34 = M34;
        t = CATransform3DRotate(t, M_PI_2*sense, 0, 1, 0);

        containerView.layer.transform = t;
        containerView.frame = CRECT; // midpoint
        NSLog(@"Container MID Frame %@", NSStringFromCGRect(containerView.frame));
    }
    completion:^(BOOL isFinished)
    {
        toView.layer.transform = CATransform3DMakeRotation(M_PI*sense, 0, 1, 0);
        [UIView animateWithDuration:TIME/2 animations:^
            {
                [fromView removeFromSuperview];
                [containerView addSubview:toView];

                CATransform3D t = CATransform3DIdentity;
                t.m34 = M34;
                t = CATransform3DRotate(t, M_PI*sense, 0, 1, 0);

                containerView.layer.transform = t; //finish the flip
                containerView.frame = (CGRect){ pt, size};
            } completion:^(BOOL isFinished)
            {
                    NSLog(@"Container Frame %@", NSStringFromCGRect(containerView.frame));
                    NSLog(@"A Frame %@", NSStringFromCGRect(b.frame));
                    NSLog(@"B Frame %@", NSStringFromCGRect(b.frame));

                    toView.layer.transform = CATransform3DIdentity;
                    containerView.layer.transform = CATransform3DIdentity;
                    showingView = showingView == a ? b : a;
            }];
    }];

} 
```

[http://dl.dropbox.com/u/60414145/FlipView.zip](http://dl.dropbox.com/u/60414145/FlipView.zip)

编辑：解决使用实际控件调整真实视图大小的一种方法是拍摄该视图的快照，在缩放/翻转时使用快照，并在最终完成块中切换出真实视图的图像. 那是：

*   当用户点击图像时，创建当前小视图的 UIImage
*   创建最终视图的 UIImage，以其自然大小呈现到上下文中
*   使用容器视图中的两个图像，用于动画
*   在最后的完成块中，从视图中删除您的 imageView 并将第二个视图现在放在 self.view 子视图中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T16:31:30.263

我对此做了一个粗略的代码（一点也不完美）（希望这是你要找的）。看看它。我创建了一个baseView和两个翻转视图，第一次翻转后，我增加了baseView的帧大小并在其上添加了第二个翻转视图。我不是Story Board的专家，所以我没有在这里使用它。

[翻转测试](http://www.sendspace.com/file/kl6lew)

-anoop

# python - 类之间的 Python 全局变量

> ID：12030889
> 
> 赞同：0
> 
> 时间：2012-08-19T23:49:05.600
> 
> 标签：python, class, global-variables, global

我对 global 做的不多，我想知道如何使类中的函数和变量成为全局的。我试图使用字体和函数在类之间测试全局。如果有人能指出我哪里出错了，那将非常有帮助。

全局.py

```
#Fonts
#Common Functions
import tkFont

class Global():
    def __init__(self):
        global f,f1,f2,enter,leave
        f = tkFont.Font(name='f',size=14, weight='bold')
        f1 = tkFont.Font(name='f1',size=12, weight='bold')
        f2 = tkFont.Font(name='f2', underline=True,size=12, weight='bold')

    def enter(self,event):
            event.widget.config(font='f2')
    def leave(self,event):
            event.widget.config(font='f1') 
```

登录框架.py

```
from Tkinter import *
from Global import *

class LoginFrame(Frame):
    def __init__(self,master):
        self.master=master
        Global()

    def createWidgets(self):
        self.frame = Frame(self.master,bg='black',width=800,height=500,bd=5,relief=GROOVE)
        self.user_lbl = Label(self.frame, text='User', bg='black', fg='white',font='f1')
        self.user_lbl.bind('<Enter>',enter), self.user_lbl.bind('<Leave>',leave)

        self.pw_lbl = Label(self.frame, text='Password', bg='black', fg='white',font='f2')
        self.pw_lbl.bind('<Enter>',enter), self.pw_lbl.bind('<Leave>',leave)

    def packWidgets(self):
        self.frame.grid_propagate(0), self.frame.grid(row=1)
        self.user_lbl.grid(row=2,column=1,sticky=W)
        self.pw_lbl.grid(row=4,column=1,sticky=W)

root=Tk()
loginFrame=LoginFrame(root)
loginFrame.createWidgets()
loginFrame.packWidgets()
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:54:32.007

> 我对 global 做的不多，我想知道如何使类中的函数和变量成为全局的。

你不能。在方法内部，您可以将变量声明为全局变量，对它的赋值将是全局变量。

没有任何其他级别的全球性。

当然，您不会想这样做，因为类的目的是避免全局状态，并保持共享状态封装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:54:51.383

在这段代码中

```
def __init__(self,master):
    self.master=master
    Global() 
```

Global() 刚刚创建并没有分配。全球`__init__`电话

```
global f,f1,f2,enter,leave 
```

但这定义了范围，而不是“全局变量”。

一种选择是执行以下操作

```
class Globals():
    f = tkFont.Font(name='f',size=14, weight='bold')
    f1 = tkFont.Font(name='f1',size=12, weight='bold')
    f2 = tkFont.Font(name='f2', underline=True,size=12, weight='bold') 
```

或者干脆自己定义

```
 f = tkFont.Font(name='f',size=14, weight='bold')
 f1 = tkFont.Font(name='f1',size=12, weight='bold')
 f2 = tkFont.Font(name='f2', underline=True,size=12, weight='bold') 
```

然后在你的函数中使用全局变量。`global`除非您进行分配，否则您不需要关键字

```
self.pw_lbl = Label(...,f) 
```

# c++ - 结果总是返回 0 并访问 classees

> ID：12030890
> 
> 赞同：0
> 
> 时间：2012-08-19T23:49:30.107
> 
> 标签：c++

我的代码有几个问题。

首先，使用这样的代码，无论我输入什么信息，它总是返回 0，关于在哪里解决这个问题以及如何解决的任何建议？我相信这与我的班级员工有关。我将如何解决这个问题？

二、如何访问 int total() 中的信息？我需要访问它以获取最后一点代码。

另外，如果您注意到我可以做些什么来优化我的程序，我欢迎您的建议。我正在学习 C++，并且将永远是一名学生。

```
// Datamax.cpp
// Created by Kennith Adkins

#include <iostream>
#include <string>

using namespace std;

class Employee
{
public:
string eName;
float eHours;
float eWage;
float ePay;
float eOvertimeHours;
float eOvertimePay;
float eTotalPay;
float eTotalBaseHours;
float eTotalSalary;
float eTotalOvertimeHours;

int Overtime ()
{
    if (eHours > 40)
    {
        eOvertimeHours = (eHours - 40);
        eOvertimePay = (eOvertimeHours * (eWage * 1.5));
        ePay = ((eHours - eOvertimeHours) * eWage);
        eTotalPay = ePay + eOvertimePay;
    }
    else
    {
        ePay = (eHours * eWage);
    }
}
int total()
{
    eTotalBaseHours = (employee1.eHours - employee1.eOvertimeHours) +   (employee2.eHours - employee2.eOvertimeHours) + (employee3.eHours -   employee3.eOvertimeHours);
    eTotalSalary = (employee1.eTotalPay + employee2.eTotalPay + employee3.eTotalPay);
    eTotalOvertimeHours = (employee1.eOvertimeHours + employee2.eOvertimeHours        + employee3.eOvertimeHours);
}
} employee1, employee2, employee3;

// Start the main program here
int main()
{
// Gretting
cout << "Welcome to the Employee Pay Center\n";

// Employee1 information
cout << "Enter the employee name: ";
cin >> employee1.eName;
cout << "Enter the hours worked: ";
cin >> employee1.eHours;
cout << "Enter his or her hourly wage: ";
cin >> employee1.eWage;
cout << endl; // Adding a blank line to space the information out

// Employee2 information
cout << "Enter the employee name: ";
cin >> employee2.eName;
cout << "Enter the hours worked: ";
cin >> employee2.eHours;
cout << "Enter his or her hourly wage: ";
cin >> employee2.eWage;
cout << endl; // Adding a blank line to space the information out

// Employee3 information
cout << "Enter the employee name: ";
cin >> employee3.eName;
cout << "Enter the hours worked: ";
cin >> employee3.eHours;
cout << "Enter his or her hourly wage: ";
cin >> employee3.eWage;
cout << endl; // Adding a blank line to space the information out

// Returning the information to the Employeer
cout << "Employe Name ............ = " << employee1.eName << "\n";
cout << "Base Pay................. = " << employee1.ePay << "\n";
cout << "Hours in Overtime........ = " << employee1.eOvertimeHours << "\n";
cout << "Overtime Pay Amount...... = " << employee1.eOvertimePay << "\n";
cout << "Total Pay................ = " << employee1.eTotalPay << "\n\n";

cout << "Employe Name ............ = " << employee2.eName << "\n";
cout << "Base Pay................. = " << employee2.ePay << "\n";
cout << "Hours in Overtime........ = " << employee2.eOvertimeHours << "\n";
cout << "Overtime Pay Amount...... = " << employee2.eOvertimePay << "\n";
cout << "Total Pay................ = " << employee2.eTotalPay << "\n\n";

cout << "Employe Name ............ = " << employee3.eName << "\n";
cout << "Base Pay................. = " << employee3.ePay << "\n";
cout << "Hours in Overtime........ = " << employee3.eOvertimeHours << "\n";
cout << "Overtime Pay Amount...... = " << employee3.eOvertimePay << "\n";
cout << "Total Pay................ = " << employee3.eTotalPay << "\n\n";

cout << "*******************************************************\n";
cout << "*****************EMPLOYEE SUMMARY DATA*****************\n";
cout << "*******************************************************\n";
cout << "** Total Employee Salaries............ " <<   "**\n";
cout << "** Total Employee Hours............... " <<   "**\n";
cout << "** Total Overtime Hours............... " <<   "**\n";
cout << "*******************************************************\n";
    cout << "*******************************************************\n";

return 0;
} 
```

嘿伙计们，感谢您的帮助。我现在已经完成了大部分。它正在显示所有信息。我现在正在努力让它显示员工摘要数据。我修改了我的代码以使其更清晰，因为我正在尝试给我的每一个建议，因为我亲手学习是最好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T23:52:09.890

这就是使用非初始化变量所得到的。您没有为您的班级成员设置任何价值，您不能指望编译器猜测您的员工姓名或总工资是多少。

您需要使用以下表格：

`object name.member name = value`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T23:57:54.877

当然，您应该在输出这些函数应该产生的结果之前调用这些函数：

```
employee1.Overtime();
employee2.Overtime();
employee3.Overtime(); 
```

# php - 'Zend_Cache_Exception' 带有消息'必须加载 memcache 扩展才能使用此后端！' 通过 shell_exec()

> ID：12030893
> 
> 赞同：0
> 
> 时间：2012-08-19T23:50:14.943
> 
> 标签：php, zend-framework, memcached, shell-exec

当我通过**shell_exec()**消息调用 PHP 脚本 ( **process.php** ) 时发现一个奇怪的错误 ：

 **```
Fatal error: Uncaught exception 'Zend_Cache_Exception' with message 'The memcache extension must be loaded for using this backend !' in /Applications/XAMPP/xamppfiles/htdocs/shared_lib/ZendFramework/1.5.2-patched/Zend/Cache.php:208 
```

**但是，如果我在终端中调用它**，我可以毫无错误地调用 process.php 。

伪代码：

**控制.php**

```
// some business logic ....
shell_exec("php process.php");
// some business logic .... 
```

**process.php**

```
// some business logic ....
call Zend_Cache to retrieve data from memecache
// some business logic .... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:22:44.420

您可以在（vhosts.conf 的）http.conf 中指定不同的 php.ini 文件。默认情况下，PHP 将使用路径中的那个（当您运行 hte 注释行时会发生这种情况），但在 apache 中，您可以告诉它加载不同的路径。

检查类似的行

```
PHPINIDir /etc/local/php 
```

（PHPINIDir 是重要的一点！）在 httpd.conf/vhosts.conf 中，这将是您通过具有 memcached 的 apache 使用的文件。然后检查命令行使用的 php.ini 文件（$ php -i | grep 'Configuration File'），看看是否不同。就是这样，使用“php -c XXX/php.ini”来告诉命令行使用与 apache 相同的 ini 文件。**

# java - Using Arquillian Persistence with Drone/Graphene

> ID：12030894
> 
> 赞同：2
> 
> 时间：2012-08-19T23:50:20.497
> 
> 标签：java, jboss-arquillian

Has anyone been able to use Arquillian Persistence extension with Arquillian Graphene/Selenium in the same test? I have a project that is using the Persistence & Drone/Graphene extensions and separately they both work fine. I can configure the database for integration tests with Persistence, and I can do UI Acceptance tests with Drone.

The problem is when I try to use the Persistence extension in a Drone test. For some reason the Persistence extension does not appear to execute as the database is never populated. Is there something special that needs to be done to enable the Persistence Extension to run in client mode with Arquillian?

**Test Class**

```
@RunWith(Arquillian.class)
@DataSource("java:jboss/datasources/ExampleDS")
@UsingDataSet("OneUserAccount-Admin.yml")
public class LoginIT {

    @Deployment(testable = false)
    public static WebArchive createDeployment() {
        return DeploymentFactory.getTemplateDeployment();
    }
    ...
    @Test
    public void testLogin() {
        this.openPage("login.xhtml");

        final IdLocator userNameField = id("loginform:email");
        final IdLocator passwordField = id("loginform:password");
        final IdLocator loginButton = id("loginform:loginButton");

        this.browser.type(userNameField, userName);
        this.browser.type(passwordField, password);
        waitForHttp(this.browser).click(loginButton);

        //Test Fails Here b/c Validation fails due to the user not being loaded to the database
    }
    ...
} 
```

**更新** 我尝试删除 deployment=false 并使用 @RunAsClient ，但没有成功。我还尝试将 @UsingDataSet 和 @ApplyScriptBefore 注释放在测试本身上，但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T12:34:40.003

在 Arquillian 论坛上问了同样的问题后，我被告知尚不支持此功能。我将提交 JIRA 请求以尽快添加它。

[https://community.jboss.org/message/754432](https://community.jboss.org/message/754432)

# comments - 阻止 Facebook Commnet 关闭评论框

> ID：12030895
> 
> 赞同：0
> 
> 时间：2012-08-19T23:50:22.333
> 
> 标签：comments, facebook-comments

我有一个网站，我使用 Facebook 评论框。我遇到的问题是 facebook 在 6 或 7 条评论后关闭评论空间（例如[http://www.fotokio.com/SDoV](http://www.fotokio.com/SDoV)）。评论对我的网站非常重要，我希望在不关闭评论空间的情况下拥有尽可能多的评论。这是一个示例，其中尽管有很多评论，但评论空间（框）仍然打开：http: [//developers.facebook.com/blog/post/472/](http://developers.facebook.com/blog/post/472/)

谢谢，胡安

# php - 调用成员函数 fetch_assoc()

> ID：12030897
> 
> 赞同：0
> 
> 时间：2012-08-19T23:51:10.293
> 
> 标签：php, mysql, fatal-error

> **可能重复：**
> [致命错误：调用非对象上的成员函数 fetch_assoc()](https://stackoverflow.com/questions/5121027/fatal-error-call-to-a-member-function-fetch-assoc-on-a-non-object)

我有以下代码：

```
$this->open_connection();
$result = $this->connection->query($this->query);           
while($this->rows[] = $result->fetch_assoc()){}                     
$result->close();
$this->close_connection();
array_pop($this->rows); 
```

在 localhost 上运行这段代码，没有给我任何问题，我返回了查询的值。但是从服务器运行时向我发送以下错误：

```
Fatal error: Call to a member function fetch_assoc() on a non-object in /home/code..on    line 36 
```

我已经阅读了几篇出版物，但我还没有设法解决这个小问题。感谢您的贡献。

# ruby-on-rails - 在字符串末尾使用 Rails 3 中的 link_to

> ID：12030902
> 
> 赞同：0
> 
> 时间：2012-08-19T23:51:58.187
> 
> 标签：ruby-on-rails, ruby, string, variables, link-to

对此可能有一个非常简单的答案，但是，由于我是 Rails 新手，我很难确定合适的语法。

基本上，我想在末尾显示一个带有链接的字符串，其中“Jimmy”在这里代表单个记录和指向该记录的链接：

```
"This video was posted by Jimmy" 
```

我想创建一个局部变量来存储字符串，所以我最初的想法是创建如下变量：

```
my_string = "This video was posted by " + (link_to user.name, user) 
```

但是，这似乎不起作用。相反，它只是在浏览器中显示生成的 HTML，即：

```
This video was posted by <a href="/users/6">Jimmy</a> 
```

这不是我想要的 - 我显然希望它显示：

```
This video was posted by Jimmy 
```

其中吉米是链接。

有任何想法吗？我尝试将 .html_safe 添加到字符串的末尾，但这不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T10:06:42.867

一个更简单的方法是：

```
<td>Video created by <%= link_to user.name, user %></td> 
```

无需使用字符串连接或使用`<%= "Video created by" %>`，无需通过 Ruby 解析器运行，只需使用纯文本版本 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T00:03:45.630

看看[原始的](http://api.rubyonrails.org/classes/ActionView/Helpers/OutputSafetyHelper.html#method-i-raw)

```
<%= raw my_string %> 
```

不过，假设这是您的观点，我不知道您为什么要将其存储到某个`my_string`变量中。

```
<span>This video was posted by <%= link_to user.name, user %></span> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T10:03:50.170

谢谢你的帮助！我设法在不需要声明变量的情况下解决了这个问题（我试图太聪明了）。

如果有人感兴趣，最终（省略）代码如下（在表格单元格中）：

```
<td><%= "Video created by " %><%= link_to user.name, user %></td> 
```

与往常一样，一旦您知道如何应用，代码就会更容易应用:-)

再次感谢！

# java - 覆盖 AbstractButton.getIcon 的问题

> ID：12030904
> 
> 赞同：1
> 
> 时间：2012-08-19T23:52:16.657
> 
> 标签：java, swing, button, custom-component

我正在制作一个由其他两个按钮组成的自定义按钮。它具有与普通按钮不同的行为（因此它是自定义的）并且看起来像这样

[我的按钮工作 http://i1078.photobucket.com/albums/w491/evesforeva/Screenshot2012-07-28at21932AM.png](http://i1078.photobucket.com/albums/w491/evesforeva/Screenshot2012-07-28at21932AM.png)

我想更改按钮中图标的设置方式，以便它们应用于右侧的按钮（带有正方形的按钮）。目前，我正在覆盖 AbstractButton.getIcon 和 AbstractButton.setIcon 以便它们应用于正确的按钮，而不是整个按钮。所以我的代码看起来像这样

```
/* (non-Javadoc)
 * @see javax.swing.AbstractButton#getIcon()
 */
@Override
public Icon getIcon() {
    return popupButton.getIcon();  // popupButton = the right button
}

/* (non-Javadoc)
 * @see javax.swing.AbstractButton#setIcon(javax.swing.Icon)
 */
@Override
public void setIcon(Icon icon) {
    Icon oldValue = getIcon();
    firePropertyChange(ICON_CHANGED_PROPERTY, oldValue, icon);
    popupButton.setIcon(icon);
} 
```

当我尝试设置按钮图标时，按钮最终看起来像这样

[我的按钮坏了 http://i1078.photobucket.com/albums/w491/evesforeva/Screenshot2012-08-19at42508PM.png](http://i1078.photobucket.com/albums/w491/evesforeva/Screenshot2012-08-19at42508PM.png)

图标在整个按钮的中间重复。我尝试删除 firePropertyChange，但没有奏效。

这也是我用来生成两个屏幕截图的代码

```
public class MyButtonDemo implements Runnable {

public static class DemoPanel extends JPanel {

    private static final long serialVersionUID = 1L;

    public DemoPanel() {
        MyButton myButton = new MyButton("My Button");
        Icon icon = new ImageIcon(new BufferedImage(5, 5, BufferedImage.TYPE_INT_RGB));
        myButton.setIcon(icon);

        add(myButton);
        add(new JButton("Normal Button"));
    }

}

/* (non-Javadoc)
 * @see java.lang.Runnable#run()
 */
public void run() {
    LookAndFeelInfo[] lafs = UIManager.getInstalledLookAndFeels();
    try {
        UIManager.setLookAndFeel(lafs[2].getClassName());
    } catch (Exception e) { }

    JFrame frame = new JFrame();
    frame.setContentPane(new DemoPanel());
    frame.pack();
    frame.setLocationRelativeTo(null);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);
}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new MyButtonDemo());
}

} 
```

是什么让我的按钮显示整个按钮的图标而不是右按钮？我该如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T08:19:45.820

至于原因：您正在覆盖包含按钮的方法，使得包含按钮认为它有一个图标 - 因此，它的 uielegate 在它认为合适的地方绘制它:-)

至于如何防止这种情况：取决于您要投入多少工作。

*   干净的是实现一个自定义 ui-delegate 并为您想要支持的所有 LAF 实现它。您可能想看看[SwingX](http://swingx.java.net)，它的 plaf 模块减轻了一些痛苦，如[最近的一个线程所示](https://stackoverflow.com/a/12017563/203657)。
*   更简单的是不重用包含按钮的 api：实现 setIcon 什么都不做，并添加新的方法来设置弹出图标。

# python - Image.open 无法处理随机选择的图像变量 Python

> ID：12030905
> 
> 赞同：0
> 
> 时间：2012-08-19T23:52:44.693
> 
> 标签：python, variables, random, tkinter, python-imaging-library

这是我的第一个 Python 脚本/程序，所以我用谷歌搜索了所有内容并开始掌握一点。

我正在尝试制作一个随机选择目录中的图片并将其显示为标签的程序。

一切都很顺利，除了一件事。我已将随机图片作为变量，并尝试告诉 Image.open 使用变量中的路径。问题是 Image.open 不将变量识别为文件名/路径，而是将其识别为

```
"PIL.PngImagePlugin.PngImageFile image mode=P size=980x93 at 0xF185A8". 
```

我整晚都在谷歌上搜索，但找不到答案或解决方案。如果我同时打印两者`img1-variable`并且`path1-variable`结果正确。

任何人都知道如何解决这个问题？我将非常感谢任何答案！我有 Python 2.7.3

这是我的脚本（未完成）。

```
#! /usr/bin/env python
from Tkinter import *
import Tkinter
import random
from PIL import Image, ImageTk
import os

root = Tkinter.Tk()
w, h = root.winfo_screenwidth(), root.winfo_screenheight()
root.geometry("%dx%d+0+0" %(w, h))
root.configure(background="darkgreen")
dir = 'decks/'
img1 = random.choice(os.listdir(dir))
path1 = dir+img1
card1 = Image.open(path1)
card1 = card1.resize((140, 190), Image.ANTIALIAS)
magicback = Image.open("datapics/magicback.jpg")
magicback = magicback.resize((140, 190), Image.ANTIALIAS)
magicbutton = ImageTk.PhotoImage(magicback)
label = Label(root, image=magicbutton)
label.image = magicbutton
label.place(x=1, y=20)
label1 = Label(root, image=card1)
label1.image = card1
label1.place(x=1, y=230)
label2 = Label(root, image=magicbutton)
label2.image = magicbutton
label2.place(x=151, y =230)
label3 = Label(root, image=magicbutton)
label3.image = magicbutton
label3.place(x=301, y=230)
label4 = Label(root, image=magicbutton)
label4.image = magicbutton
label4.place(x=451, y=230)
label5 = Label(root, image=magicbutton)
label5.image = magicbutton
label5.place(x=601, y=230)
label6 = Label(root, image=magicbutton)
label6.image = magicbutton
label6.place(x=751, y=230)
label7 = Label(root, image=magicbutton)
label7.image = magicbutton
label7.place(x=901, y=230)
root.mainloop(0) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T00:04:06.810

如果我正确理解了这个问题，那么您的问题是`image.open()`，我相信问题是当您将目录和文件名连接在一起时，您将它们视为字符串：

```
path1 = dir + img1 
```

相反，您应该尝试使用该`os.path`模块将两者结合起来：

```
path1 = os.path.join(dir, img1) 
```

# css - 我的蓝色悬停状态 div 上只有 1px 的奇怪 chrome 间隙

> ID：12030906
> 
> 赞同：1
> 
> 时间：2012-08-19T23:52:54.457
> 
> 标签：css

当您将鼠标悬停在我的网站[http://seanbooks.tumblr.com/](http://seanbooks.tumblr.com/)上的一本书上时，蓝色 div 似乎没有完全覆盖右侧的照片，留下 1px 的间隙。这似乎只发生在 Chrome 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:07:36.837

不知道为什么，但是，在我的屏幕上，图像拉伸到`351px`与容器相比`350px`，拉伸容器。如果你`position: absolute`在图像上设置，它似乎播放得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T00:04:39.617

我认为这是因为您在 .row .threecol 上的宽度是 22.05%，也许 chrome 不喜欢尝试将屏幕分割得那么远。我将其更改为 250px，看起来还可以。

```
.row .threecol {
width: 250px;
} 
```

# javascript - 通过 Jquery 输出 JSON 编码的数组

> ID：12030913
> 
> 赞同：0
> 
> 时间：2012-08-19T23:53:49.477
> 
> 标签：javascript, jquery, arrays, json

我在 ajax 调用中设置了一个 json 编码数组：

```
 $var = json_encode($_SESSION['pictures']); 
```

我把这个 json 编码的数组放在一个名为“array”的 var 中。当我提醒 var 数组时，我收到以下回调：

```
 ["http://linktoimage1", "http://linktoimage2"] 
```

现在我想通过 jquery 调用输出第一个值：

```
 $('#imgswap').attr('src', array[0]); 
```

当我进行这个 jquery 调用时，我收到了值“[”。如果我将其更改为数组 [2]，我会收到“h”。所以他给了我字符而不是数组的完整值。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T23:57:25.183

您需要解析 json 以使其成为一个数组，否则它只是一个字符串

```
array = $.parseJSON(array);
$('#imgswap').attr('src', array[0]); 
```

`dataType`如果您将其设置为，您也可以让 jQuery.ajax 为您解析它`json`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T23:56:38.153

您将数据作为字符串而不是实际 JSON 接收。你`dataType: text`在你的 AJAX 调用中使用吗？如果是这样，请忽略该行或将其替换为`dataType: json`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:57:14.747

将最后一行更改为：

```
$('#imgswap').attr('src', JSON.parse(array[0])); 
```

您需要解析 JSON。如果你不这样做，你有一个字符串，而不是一个数组。

# javascript - 为单击的链接赋予不同的颜色并在单击其他链接时恢复其颜色

> ID：12030919
> 
> 赞同：-1
> 
> 时间：2012-08-19T23:55:14.493
> 
> 标签：javascript, jquery, css, hyperlink

我有一个顶部导航链接，可以驱动左侧导航中的链接。顶部导航包含一堆主题。单击时，每个主题链接都会在左侧导航中填充有关该主题的相关链接。因此，当单击顶部导航上的主题时，我希望它的颜色更改为红色，而其余的为蓝色，但是一旦单击另一个标题，我希望先前单击的链接将其颜色恢复为蓝色，并且新点击一个获得红色。我们如何在 jquery 中做到这一点？添加类和删除类以及使用 css 不起作用..请帮助..

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
        "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>MY C# Notes</title>     
    <style type="text/css">
    body,
    html {margin:0; padding:0;color:#000;background:#a7a09a;}
    #wrap {width:1050px;margin:0 auto;background:#99c;}
    #header {padding:5px 10px;background:#ddd;}
    h1 {margin:0;}
    #nav {padding:5px 10px;background:#c99;}
    #nav ul {margin:0;padding:0;list-style:none;}
    #nav li {display:inline;margin:0;padding-right:15px;}
    #main { float:right;width:780px;padding:10px;background:#9c9;min-height:600px;}
    h2 {margin:0 0 1em;}
    #sidebar {float:left;width:230px;padding:10px;background:#99c;min-height:600px;}
    #footer {clear:both;padding:5px 10px;background:#cc9;}
    #footer p { margin:0;  }
    * html #footer {height:1px;}
    .high{color:red}
    a.loader { color: blue; }    
    </style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
</head>
<body>
<script type="text/javascript"> 
$(document).ready(function() {   
$('a.loader').on('click', function(e) {
e.preventDefault();
    $('#sidebar').load($(this).attr('href'));
            $("a.loader").removeClass("high");
            $(this).addClass("high");});
});

</script>
<div id="wrap">
    <div id="header"><h1>My C# Notes and Exercises</h1></div>
    <div id="nav">
        <ul>
            <li><a class="loader" href="topic1.html">Topic1</a></li>
            <li><a class="loader" href="topic2.html">Topic2</a></li>
            <li><a class="loader" href="topic3.html">Topic3</a></li>
            <li><a class="loader" href="topic4.html">Topic4</a></li>
            <li><a href="/">LocalBrowser</a></li>
        </ul>
    </div>
    <div id="main">
    </div>
    <div id="sidebar"></div>
    <div id="footer">
        <p>C# Online Tutorials</p>
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:09:03.623

加载器类的蓝色覆盖了红色，所以使用这个：

```
.high{color:red !important} 
```

[http://jsfiddle.net/AZqUx/](http://jsfiddle.net/AZqUx/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T00:14:28.737

您的 css 课程`.loader`优先于`.high`; 您可以通过以下方式解决此问题：

-`!important`添加到声明中`.high`：`.high {color: red !important;}`

- 交换你的 CSS 中声明的顺序：`a.loader { color: blue;} a.high { color: red; }`

`.loader`- 或在添加时删除`.high`：

```
$(document).ready(function() { 
    $('a.loader').on('click', function(e) {
        e.preventDefault();
        $('#sidebar').load($(this).attr('href'));
        $("a.high").not(this).removeClass("high").addClass('loader');
        $(this).removeClass('loader').addClass("high");
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T00:15:26.750

目前，您在这里有两个相关的 CSS 规则：

```
a.loader { color: blue; }    
.high { color: red; } 
```

CSS 最重要的原则之一是更具体的规则将覆盖不太具体的规则。在上述两条规则中，第一条适用于所有`<a>`带有 class 的元素`loader`，第二条适用于所有带有 class 的元素`high`。由于第一个更具体（包括标签和类描述），它被赋予优先级并覆盖`color: red;`来自其他规则的。解决此问题的最简单方法是使您的第二条规则更具体：

```
a.loader { color: blue; }    
a.high { color: red; } 
```

由于规则为`a.high`稍后声明，它将被优先考虑。但是，您可以通过实际使第二条规则比第一条更具体来更好地证明这一点。假设您只需要在元素的子元素中使用它`<div id="nav">`，您可以这样做：

```
a.loader { color: blue; }    
#nav a.high { color: red; } 
```

这样您就可以自由移动这两个声明，而不会发生任何意外的行为变化。如果您对它的工作原理有任何疑问，您会发现[CSS 特定性规则很有帮助。](http://www.htmldog.com/guides/cssadvanced/specificity/):D

# php - 简单的 HTML DOM 解析器和 Web 浏览器返回不同的 HTML

> ID：12030920
> 
> 赞同：0
> 
> 时间：2012-08-19T23:55:18.697
> 
> 标签：php, mysql, screen-scraping, web-scraping, simple-html-dom

我正在使用[PHP Simple HTML DOM](http://simplehtmldom.sourceforge.net/)来解析网页。

**问题：**但是，废弃的 HTML 内容似乎与我使用 Web 浏览器时得到的不同。可能导致差异的原因是什么？如何使用 Simple HTML Dom 获得与 Web 浏览器显示的内容相同的内容？

**PHP**

```
public function action_asos() {

    include_once('/home/mysite/public_html/application/libraries/simple_html_dom.php');

    $category_url = 'http://www.asos.com/Men/T-Shirts-Vests/Cat/pgecategory.aspx?cid=7616#parentID=-1&pge=0&pgeSize=100&sort=1';

    $html = file_get_html($category_url);

    foreach($html->find('html') as $content) {
        echo $content;
    }

} 
```

**实际页面：**

`http://www.asos.com/Men/T-Shirts-Vests/Cat/pgecategory.aspx?cid=7616#parentID=-1&pge=0&pgeSize=100&sort=1`

**使用简单 HTML DOM 检索**

![在此处输入图像描述](../Images/af531774c0c8a5c2bde80b550e4508d6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:05:52.470

您需要提供用户代理。无论出于何种原因，缺少用户代理都会导致服务器阻塞。

# iphone - 在 UItableview 上方添加东西

> ID：12030928
> 
> 赞同：0
> 
> 时间：2012-08-19T23:57:59.953
> 
> 标签：iphone, objective-c, ios, xcode, xcode4

您好我想知道是否有人可以概述我将如何在我的表格视图上方添加一个 UIButton。这些按钮将与表格交互。我是否必须完全编辑情节提要，还是以编程方式完成？如何？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:59:40.883

我做过类似的事情的时候，我实际上在我的表格中添加了一个只有一行的部分，并将按钮添加为单元格的子视图。这似乎是执行此操作的“标准”方式。Apple 在音乐应用程序中执行此操作。

# r - 滚动连接R中的data.table

> ID：12030932
> 
> 赞同：45
> 
> 时间：2012-08-19T23:59:21.007
> 
> 标签：r, join, time-series, data.table

我试图更多地了解滚动连接的工作方式并且有些困惑，我希望有人可以为我澄清这一点。举一个具体的例子：

```
dt1 <- data.table(id=rep(1:5, 10), t=1:50, val1=1:50, key="id,t")
dt2 <- data.table(id=rep(1:5, 2), t=1:10, val2=1:10, key="id,t") 
```

我希望这会产生一个很长`data.table`的值`dt2`滚动：

```
dt1[dt2,roll=TRUE] 
```

相反，正确的方法似乎是：

```
dt2[dt1,roll=TRUE] 
```

有人可以向我解释更多关于加入是如何`data.table`工作的，因为我显然没有正确理解它。我认为这`dt1[dt2,roll=TRUE]`对应于 sql 等价物`select * from dt1 right join dt2 on (dt1.id = dt2.id and dt1.t = dt2.t)`，除了添加的功能 locf。

此外，文档说：

```
X[Y] is a join, looking up X's rows using Y (or Y's key if it has one) 
as an index. 
```

这使得似乎只有 X 中的东西应该返回，并且正在完成的连接是内部连接，而不是外部连接。如果`roll=T`那个特殊`id`情况不存在，那该`dt1`怎么办？玩得更多，我无法理解该列中放置了什么值。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-20T14:36:23.697

文档中的引用似乎来自 FAQ 1.12 *X[Y] 和 merge(X,Y) 有什么区别*。您是否在其中找到以下内容`?data.table`并有帮助？

> `roll`适用于最后一个连接列，通常是日期，但可以是任何有序变量，不规则且包括间隙。如果 roll=TRUE 并且 i 的行匹配除最后一个 x 连接列之外的所有列，并且它在最后一个 i 连接列中的值落在一个间隙中（包括该组在 x 中的最后一次观察之后），则 x 中的主要值是向前滚动。使用修改后的二进制搜索，此操作特别快。该操作也称为最后一次观察结转 (LOCF)。通常，x 的键中不应有重复项，最后一个键列是日期（或时间，或日期时间），并且 x 的键的所有列都连接到。一个常见的习惯用法是在一组标识符 (ids) 中选择同时期的常规时间序列 (dts)： DT[CJ(ids,dts),roll=TRUE] 其中 DT 有一个 2 列键 (id,

> `rolltolast`与 roll 类似，但数据不会前滚到连接列定义的每个组中的最后一个观察值之后。对于由除最后一个连接列之外的所有列定义的那个组，i 的值必须落在 x 中的一个间隙中，但不能在数据结束之后。roll 和 rolltolast 可能不会都为 TRUE。

就 SQL 连接的左/右类比而言，我更愿意在 FAQ 2.14 的上下文中考虑这一点，*你能进一步解释为什么 data.table 受到 base 中的 A[B] 语法的启发*。答案很长，这里就不贴了。

# sql - SQL + IN + 参数

> ID：12030938
> 
> 赞同：2
> 
> 时间：2012-08-19T23:59:40.663
> 
> 标签：sql, parameters

我有一个字符串作为参数传递给我的存储过程。

```
dim AgentString as String = " 'test1', 'test2', 'test3' " 
```

我想在`IN`语句中使用该参数。

```
AND M.SalesRep IN (@AgentString) 
```

但是，这似乎不起作用。在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:23:41.057

或者，您可以进行字符串比较。

```
dim AgentString as String = "test1,test2,test3" 
```

然后有：

```
where ','+AgentString+',' like '%,'+M.SalesRep+',%' 
```

我在所有内容之前和之后都放了逗号，所以“ed”与“edith”不匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T00:05:32.300

那是因为您`agentString`被解释为*单个*字符串，而不是值列表。如果参数数量是固定的，可以使用：

```
AND M.SalesRep IN (@agent0,@agent1,@agent2) 
```

然后分别绑定每个参数。

如果没有，您需要动态构建查询以获取上述表单，然后在循环中绑定每个参数。

# python - 不能在对话框类中创建 wx.filedialog？

> ID：12030942
> 
> 赞同：1
> 
> 时间：2012-08-20T00:00:15.973
> 
> 标签：python, wxpython, filedialog

我在下面创建了一个这样的类。但是当我用“保存文件”按钮绑定一个事件时，wx.filelog 不会设置。这真的很奇怪。所以我把SuperClass改成wx.Frame，然后就成功了。谁能告诉我为什么？谢谢。

```
class TestDialog(wx.Dialog):
    def __init__(
        self, parent, ID, title, size=wx.DefaultSize, pos=wx.DefaultPosition,
        style=wx.DEFAULT_DIALOG_STYLE,
        useMetal=False,):
        self.pre = wx.PreDialog()
        self.pre.SetExtraStyle(wx.DIALOG_EX_CONTEXTHELP)
        self.pre.Create(parent, ID, title, pos, size, style)
        self.PostCreate(self.pre)
        self.fileButton = wx.Button(self , -1, "save file!")
        self.Bind(wx.EVT_BUTTON, self.OnCompressToFileButton, self.fileButton)
    def OnCompressToFileButton(self, event):
        wildcard = "compress file(*.cof)|*.cof|Lempel-Zivsliding window compressfile(*.lz)|*.lz"
        dlg = wx.FileDialog(self, message="Save file as ...", defaultDir=os.getcwd(),         defaultFile="", wildcard=wildcard, style=wx.SAVE) 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T13:33:09.403

使用这个 cod 它必须与 wx.Dialog 一起使用

```
def OnCompressToFileButton(self, event):
    dlg = wx.FileDialog(self, "Choose a file",os.getcwd(), "", "*.*", wx.SAVE | wx.OVERWRITE_PROMPT)
    if dlg.ShowModal() == wx.ID_OK:
        self.filename=dlg.GetFilename()
        self.dirname=dlg.GetDirectory() 
```

# webdriver - 如何使用 Capabilities 接口使用 Arquillian 配置 WebDriver

> ID：12030946
> 
> 赞同：1
> 
> 时间：2012-08-20T00:01:20.420
> 
> 标签：webdriver, jboss-arquillian

我想使用 Arquillian 的 Drone 扩展来为一些功能测试配置 WebDriver，使用[这里](http://planet.jboss.org/post/arquillian_drone_extension_1_1_0_cr1_released)描述的 Capabilities 接口。我在我的 pom.xml 文件中添加了 arquillian-bom（版本 1.0.2.Final）、arquillian-drone-bom（版本 1.1.0.CR2）、arquillian-drone-webdriver-depchain 和 arquillian-drone-webdriver 作为依赖项。 xml，如下所示，并声明了如图所示的功能，但是当我运行测试时，抛出以下异常：

```
java.lang.NullPointerException
at org.openqa.selenium.remote.DesiredCapabilities.<init>(DesiredCapabilities.java:51)
at org.jboss.arquillian.drone.webdriver.configuration.TypedWebDriverConfiguration$5.invoke(TypedWebDriverConfiguration.java:268)
at org.jboss.arquillian.drone.webdriver.configuration.TypedWebDriverConfiguration$5.invoke(TypedWebDriverConfiguration.java:259)
at org.jboss.arquillian.drone.webdriver.configuration.TypedWebDriverConfiguration$CallInterceptor.intercept(TypedWebDriverConfiguration.java:65)
at org.jboss.arquillian.drone.webdriver.configuration.TypedWebDriverConfiguration.getCapabilities(TypedWebDriverConfiguration.java:274)
at org.jboss.arquillian.drone.webdriver.factory.FirefoxDriverFactory.createInstance(FirefoxDriverFactory.java:79)
at org.jboss.arquillian.drone.webdriver.factory.FirefoxDriverFactory.createInstance(FirefoxDriverFactory.java:42)
at org.jboss.arquillian.drone.webdriver.factory.WebDriverFactory.createInstance(WebDriverFactory.java:129)
at org.jboss.arquillian.drone.webdriver.factory.WebDriverFactory.createInstance(WebDriverFactory.java:43)
at org.jboss.arquillian.drone.impl.DroneCreator.createWebTestBrowser(DroneCreator.java:71)
etc. 
```

查看代码，我可以看到这个 NPE 是由未初始化的 TypedWebDriverConfiguration 中的类变量 CapabilityMap 引起的。

我需要在配置中修复什么才能使其正常工作？

pom.xml 提取：

```
<project>
    <dependencies>
        <dependency>
            <groupId>org.jboss.arquillian</groupId>
            <artifactId>arquillian-bom</artifactId>
            <version>${arquillian.version}</version>
            <type>pom</type>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.arquillian.extension</groupId>
            <artifactId>arquillian-drone-bom</artifactId>
            <version>${drone.version}</version>
            <type>pom</type>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.arquillian.extension</groupId>
            <artifactId>arquillian-drone-webdriver</artifactId>
            <version>${drone.version}</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.arquillian.extension</groupId>
            <artifactId>arquillian-drone-webdriver-depchain</artifactId>
            <version>${drone.version}</version>
            <type>pom</type>
            <scope>test</scope>
        </dependency>
    </dependencies>
</project> 
```

arquillian.xml：

```
<arquillian xmlns="http://jboss.org/schema/arquillian"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://jboss.org/schema/arquillian
        http://jboss.org/schema/arquillian/arquillian_1_0.xsd">
    <extension qualifier="webdriver">
        <property name="browserCapabilities">firefox</property>
        <property name="capabilityWebdriverFirefoxBin">/usr/bin/firefox</property>
    </extension>
</arquillian> 
```

代码中的 WebDriver 声明：

```
@RunWith(Arquillian.class)
public class WebDriverTest {

    @Deployment
    public static WebArchive createDeployment() {
        ...
    }

    @Drone
    WebDriver driver;   

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T08:02:16.700

这是由 Maven pom.xml 中的依赖声明引起的版本控制问题。Arquillian BOM 工件需要在dependencyManagement 下声明，具有导入范围。pom.xml 依赖声明应如下所示：

```
<project>
    <dependencies>
        <dependency>
            <groupId>org.jboss.arquillian.extension</groupId>
            <artifactId>arquillian-drone-webdriver-depchain</artifactId>
            <version>${drone.version}</version>
            <type>pom</type>
            <scope>test</scope>
        </dependency>
    </dependencies>
    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>org.jboss.arquillian</groupId>
                <artifactId>arquillian-bom</artifactId>
                <version>${arquillian.version}</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>
            <dependency>
                <groupId>org.jboss.arquillian.extension</groupId>
                <artifactId>arquillian-drone-bom</artifactId>
                <version>${drone.version}</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>    
        </dependencies>
    </dependencyManagement>
</project> 
```

请注意，不再需要 arquillian-drone-webdriver 依赖项。

# java - 请帮我完成我的 DrJava 代码。我对如何完成它感到困惑

> ID：12030948
> 
> 赞同：-1
> 
> 时间：2012-08-20T00:01:23.570
> 
> 标签：java, drjava

设计并实现一个应用程序，它从用户那里读取一个字符串，然后确定并打印字符串中出现的元音和辅音的数量。在循环内使用 switch 语句。

典型的程序输出可能是：

```
Enter a sentence
> My dog has fleas!
Sentence is : My dog has fleas!
VowelVount is : 4
ConsonantCount is : 9 
```

我的代码是：

```
import java.util.Scanner;

public class VnC{

  public static void main(String [] args){
    String text;
    Scanner scan = new Scanner(System.in);
    System.out.println("Enter a sentence");
    text = scan.nextLine();
    System.out.println("Sentence is : " + text);
    text = text.toLowerCase();
    switch(text) {
      case 'a':
      case 'e':
      case 'i':
      case 'o':
      case 'u':
        vowelCount++;
        System.out.println("VowelCount : " + vowelCount);
        break;
      default:
        consonanyCount++;
        System.out.println("ConsonantCount is : " + consonantCount);
        break;
    }
  }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:04:43.377

你在正确的道路上，而且几乎在那里。您需要遍历输入字符串 ( `text`) 中的所有字符。为此使用`for`循环，并打开每个字符而不是整个字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T01:32:33.657

看看这个。可能有帮助：

```
import java.util.Scanner;

public class XX{

  public static void main(String [] args){
    String text;
    Scanner scan = new Scanner(System.in);
    System.out.println("Enter a sentence");
    text = scan.nextLine();
    System.out.println("Sentence is : " + text);
    text = text.toLowerCase();
    int vowelCount = 0 ;
    int consonantCount = 0 ;
    text = text.replaceAll("[-+.^:, !]",""); // remove chars that you don't want to count

    for(int i = 0; i < text.length() ;i++ ){
        if(text.charAt(i)== 'a' ||text.charAt(i)== 'e' ||text.charAt(i)== 'i' ||text.charAt(i)== 'o' || text.charAt(i)== 'u')
            vowelCount++;
            else
            consonantCount++;
    }

    System.out.println("VowelCount : " + vowelCount);
    System.out.println("ConsonantCount is : " + consonantCount);
    }

    } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-20T00:06:53.330

```
for (char ch : text.toCharArray()) { 
  switch(ch) {
    case 'a':
    case 'e':
    case 'i':
    case 'o':
    case 'u':
      vowelCount++;
      break;
    default:
      consonanyCount++;
      break;
  }
} 
System.out.println("VowelCount : " + vowelCount);
System.out.println("ConsonantCount is : " + consonantCount); 
```

# jquery - 在 jQuery 动画中使用“this”

> ID：12030950
> 
> 赞同：1
> 
> 时间：2012-08-20T00:02:20.860
> 
> 标签：jquery, jquery-animate

我正在使用下面的代码构建一个插件。如果我将 $(opts.section, this).animate 更改为 $(opts.section).animate 它也可以按我的意愿工作，但是它会为 section 元素的所有实例设置动画，并且我希望它只影响当前的. 一旦我将“这个”添加到它，它就会停止一起工作。

```
 $('.next', this).on({
    click: function() {
      if(count+2 <= totalElems) {
        count += 1;
        currentAnimationSpot += singleElem + opts.offset;
        $(opts.section, this).animate({
          left: -currentAnimationSpot
        });
      }
    }
  });

  $('.prev', this).on({
    click: function(){
      if(count != 1) {
        count-=1;
        currentAnimationSpot -= singleElem + opts.offset;
        $(opts.section, this).animate({
          left: -currentAnimationSpot
        });
      }
    }
  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:15:29.737

函数内部`this`与函数外部不同`this`。编辑：正如@FabricioMatte 的回答所说——“`this`在你的 $(".next", this) 处理程序的范围内引用了触发处理程序的元素”。

因此，您需要将外部存储`this`在一个单独的变量中，以便您可以在函数内部访问它。例如

```
var self=this;

$('.prev', this).on({
    click: function(){
      if(count != 1) {
        count-=1;
        currentAnimationSpot -= singleElem + opts.offset;
        // now use self here
        $(opts.section, self).animate({
          left: -currentAnimationSpot
        });
      }
    }
  }); 
```

尽管这起初看起来很奇怪，但实际上与您在函数的本地范围内分配新值时看到的行为相同，只是`this`分配被隐藏了。

闭包/作用域的快速示例：假设您有一个变量`scoped`，您可以复制如下行为：

```
var scoped = "Outer scope!";
var saved = scoped;

myfn() {
    var scoped = "Inner scope!";
    console.log("Inner `scoped` is " + scoped); // Inner `scoped` is Inner scope!
    console.log("Inner `saved` is " + saved);  // Inner `saved`` is Outer scope!
};

console.log("Outer scoped is: " + scoped); // Outer scope!
console.log("Outer saved is: " + saved); // Outer scope!
myfn(); 
```

想象一下你用“this”替换了“scoped”，你应该明白了（就好像有人设置`var this = triggerElement`在函数的范围内。

# c# - 标签以编程方式添加图像 -vs- 使用 VS2008 设计器添加图像

> ID：12030960
> 
> 赞同：0
> 
> 时间：2012-08-20T00:04:44.907
> 
> 标签：c#, design-view

我有一个完全手动创建的 C# 表单（即不使用 Visual Studio 设计视图）。在这种形式中，我创建了一个*标签*（简单），如下所示：

```
private Label myLabel = new Label(); 
```

稍后在代码中，在回调期间，我想为此标签设置图像。我找到了一种方法，这里是代码：

```
myLabel.Image = Image.FromFile("Images\\mark.png"); 
```

这可行，但问题是，当我*分发*我的应用程序时，我总是必须提供一个包含*mark.png的文件夹（* *Images* ） 。

 *我想这是可以接受的，但这真的不是我想要的......

有趣的是，我查看了我创建的其他一些代码，其中我使用 Visual Studio 设计视图将图像添加到标签，而设计器则完全不同。它以某种方式解析图像，计算出二进制文件，并将该二进制文件的 base64 表示形式保存为*.resx*文件中的字符串：

```
<data name="fileDisconnect.Image" type="System.Drawing.Bitmap, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
    <value>
        iVBORw0KGgoAAAANSUhEUgAAABkAAAAXCAYAAAD+4+QTAAAABGdBTUEAAK/INwWK6QAAAAlwSFlzAAAO
        vAAADrwBlbxySQAAAA10RVh0U291cmNlAE51dm9sYaxPNfEAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5F
        ...
        ...
        ns2di2Jn545YY+PJHw3ZbmREJBgZLDwzgehomExoMpmUG1spVLuhAG/80RSKwyEGo7ZBJNKcsrf/Pd7Q
        MOijAUML48mPeAPCJ5FKhMcSBOt9Ach5ThKVujqeQvEa8v8FrglBl5d/7zYAAAAASUVORK5CYII=
</value> 
```

查看 Designer 文件源代码，您可以看到它设置图像标签如下：

```
this.fileConnect.Image = ((System.Drawing.Image)(resources.GetObject("fileConnect.Image"))); 
```

因此，如您所见，这样做更加优雅。无需将图像实际保存到硬盘并在交付应用程序时提供图像。图像信息存储在*.resx*文件中，并设置图像以编程方式从*.resx*获取二进制内容。

我的问题是......如果我手动创建我的控件，我怎样才能获得同样的行为？我可以创建一个*.resx*文件，使用 HEX 编辑器打开图像并将二进制字符串复制到*.resx*文件中吗？然后，当将图像添加到标签时，我可以像上面那样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:31:29.753

如果您将图像保存在资源中，您可以这样做：

```
 Label myLabel = new Label();
        myLabel.Text = "whatever";
        myLabel.Image = Properties.Resources.MyLabelImage;
        this.Controls.Add(myLabel); 
```*

# javascript - JavaScript 通过字符串比较检查类型的方式会影响性能吗？

> ID：12030963
> 
> 赞同：0
> 
> 时间：2012-08-20T00:05:55.247
> 
> 标签：javascript, performance, typechecking

大多数 JavaScript 的类型检查都是通过字符串比较来完成的。例如，

```
if (typeof(x)=='undefined') 
```

是检查变量是否从未定义的唯一方法。这对性能有影响吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T01:27:10.390

这是检查未定义的唯一正确方法。检查的性能影响很小。这是一个简单的测试，您可以运行并查看实际数字。

```
function performanceTest(fn, count){
    var start = new Date();
    for(var i = 0; i < count; i++){
        fn.call(fn); 
    }
    var end = new Date();
    console.log(end - start);   
}    

performanceTest(function(){
    typeof fff == 'undefined'
}, 100000); 
```

在 chrome 上运行检查 100,000 次需要 87 毫秒。

# vim - 根据特定文件类型更改 F5 的映射

> ID：12030965
> 
> 赞同：5
> 
> 时间：2012-08-20T00:07:03.657
> 
> 标签：vim, keymapping

`F5`我的密钥的当前映射是：

```
imap <F5> <esc>:w\|!python %<CR> 
```

现在我想要，如果我正在编辑任何 python 文件*（如果它也能识别标准`.py`格式以外的文件会更好`.pyd`）*那么这个映射就可以正常工作。但是，如果我编辑一个 Java 文件，它会映射到以下内容：

```
imap <F5> <esc>:w\|!javac %<CR> 
```

当我编辑任何`.c`或`.cpp`文件时，`F5`它会映射到这个：

```
imap <F5> <esc>:w\|!make %<CR> 
```

我不知道如何进行。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-20T04:49:42.817

给出的答案和原始映射都存在问题。首先，对于缓冲区本地映射，有`*map <buffer>`. 其次，`<buffer>`您不需要使用`BufEnter`事件，而是可以使用`Filetype`仅启动一次的事件。第三，您有一个错误 (2.)、一个潜在问题 (1.) 和一个可以在原始映射中优化的地方：

1.  你不应该使用`imap`它，它很容易在添加新映射时意外破坏旧映射
2.  `!python %`一旦文件包含特殊符号（空格、分号、引号、美元……），将中断
3.  在某些情况下使用`:update`而不是避免无用的写入`:write`

我的变种：

```
autocmd Filetype c,cpp  inoremap <buffer> <F5> <C-o>:update<Bar>execute '!make '.shellescape(expand('%:r'), 1)<CR>
autocmd Filetype python inoremap <buffer> <F5> <C-o>:update<Bar>execute '!python '.shellescape(@%, 1)<CR>
autocmd Filetype java   inoremap <buffer> <F5> <C-o>:update<Bar>execute '!javac '.shellescape(@%, 1)<CR> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T00:12:53.933

试试这个：

```
au BufEnter *.py map <F5> <esc>:w\|!python %<CR>
au BufEnter *.java imap <F5> <esc>:w\|!javac %<CR>
au BufEnter *.c, *.cpp imap <F5> <esc>:w\|!make %<CR> 
```

我不是 100% 确定逗号分隔的文件类型，试图验证......

vim 文档通常很难弄清楚如何使用命令，但是这些应该可以帮助您入门：

```
:h BufEnter
:h :autocmd 
```

注意：您可能需要重新启动 vim 才能使这些更改覆盖当前的自动命令组。

# c# - 更改元素后刷新列表框项

> ID：12030969
> 
> 赞同：1
> 
> 时间：2012-08-20T00:07:32.877
> 
> 标签：c#, listbox, listboxitem

我有一个 ParameterItem 类，用于将一些项目添加到列表框中：

```
class ParameterItem
{
    public string Name { get; set; }
    public string Value { get; set; }

    public ParameterItem(string name, string value)
    {
        Name = name;
        Value = value;
    }

    public override string ToString()
    {
        return Name + " = " + Value;
    }

    public override bool Equals(object obj)
    {
        if (obj is ParameterItem)
            return (Name == ((ParameterItem)obj).Name);

        return false;   
    }

    public override int GetHashCode()
    {
        return Name.ToLowerInvariant().GetHashCode();
    }
} 
```

您可以使用两个文本框（名称和值）将项目添加到列表框中。当您单击列表框中的某个项目时，文本框将填充 ParameterItem 的名称和值。我有以下代码来更改列表框中所选 ParameterItem 的内容：

```
 private void btnSaveParameter_Click(object sender, EventArgs e)
    {
        ParameterItem currentParameter = new ParameterItem(textParameterName.Text,
                                                           textParameterValue.Text);
        // If we already have the parameter set then edit it.
        if (lstbxSetParameters.Items.Contains(currentParameter))
        {
            ((ParameterItem)lstbxSetParameters.SelectedItem).Value = currentParameter.Value;
            lstbxSetParameters.;
        }
        // If it's not set yet then add it to the listbox.
        else
        {
            lstbxSetParameters.Items.Add(currentParameter);
            textParameterName.Text = String.Empty;
            textParameterValue.Text = String.Empty;
        }
    } 
```

问题是，即使我可以更改所选 ParameterItem 的内容，在列表框中，它仍然看起来没有更改。

例如我在列表框中有一个参数：

测试参数 = 10

我将 ParameterItem 更改为

测试参数 = 5

但在列表框中它仍然看起来像

测试参数 = 10

即使它已经改变了。

我怎么解决这个问题？我认为列表框项目应该`ToString()`再次调用 ParameterItem 的方法并刷新自身，但如何？

或者有没有更好的方法在列表框中添加键值对？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T01:52:44.963

您可以通过删除并重新插入来更改所选项目。

```
// If we already have the parameter set then edit it.
if (lstbxSetParameters.Items.Contains(currentParameter))
{
    var newItem = new ParameterItem((lstbxSetParameters.SelectedItem as ParameterItem).Name, currentParameter.Value);
    var index = lstbxSetParameters.SelectedIndex;
    lstbxSetParameters.Items.RemoveAt(index);
    lstbxSetParameters.Items.Insert(index, newItem);
    lstbxSetParameters.SelectedIndex = index;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-31T17:16:58.913

我的解决方案：

```
string[] nList = new string[lb.Items.Count];
nList = lb.Items.OfType<string>().ToArray();
nList[lb.SelectedIndex] = newValue;
lb.Items.Clear();
lb.Items.AddRange(nList); 
```

通过这种方式，我没有更改所选项目（有很多问题），而是重新加载了列表框，并在数组中更改了项目。

# c++ - C++：IF 未在此范围内声明

> ID：12030971
> 
> 赞同：0
> 
> 时间：2012-08-20T00:07:38.383
> 
> 标签：c++

我正在尝试`if else`发表声明，但每次输入代码时都会出现错误。其中一个说`IF was not declared in this scope`，我不知道如何声明它和这一切。它还说`}`在我的 else 声明之前没有，但显然有；请帮忙。

这是代码：

```
#include <iostream>
#include <string>

using namespace std;

int main() {
    string UserInput;

    cin >> UserInput;

    int x;
    x = 1;

    If (UserInput = x);
    {
        cout << "Type A Word and Press enter";
    }
    else
    {
        Cout << "NOT A USESBLE NUMBER";
    }

    cin.clear();
    cin.ignore(255, '\n');
    cin.get();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-20T00:57:24.197

```
If (UserInput = x); 
```

关键字，就像 C++ 中的变量一样，是区分大小写的，这意味着它们要拼写并且每次编写时都具有相同的大小写。在您的代码中，您`IF`将出现未声明/未定义，因为编译器认为您将其用作尚未定义的变量或函数。if 语句要小写。所以结果应该是这样的：

```
if (UserInput = x); 
```

但我们还没有完成。我们这里还有一些问题。if 语句中的单个等号被解释为赋值（它不会抛出错误，因为从技术上讲它是正确的语法，但是很多人通过使用单个等号而不是双等号来犯这个错误）。如果您打算比较而不是分配，则正确的语法是双等号。

```
if (UserInput == x); 
```

注意：此代码仍然不正确，因为您将字符串与数字进行比较。当您这样做`cin >> UserInput`时，用户的文本将被转换为变量的字符串，`UserInput`因此它永远不会`x`是分配给数字 1 的整数。换句话说，`if`每次都会因为字符串不是整数而失败。相反，我们应该`if (UserInput == "1")`将其与作为字符串文字的 1 进行比较。

```
if (UserInput == "1"); 
```

最后的分号不应该在那里。这不是语句的结尾，只是行的结尾。if 语句仍然需要其后的一行代码（可选，如果省略括号），或者包含多行代码的两个花括号。

```
if (UserInput == "1")
{
    /* ... */

    Cout >> "NOT A USESBLE NUMBER";
} 
```

`Cout`应该完全小写，因为它是用小写定义的。

在查看了您的代码后，我认为这就是您想要的：

```
#include <iostream>
#include <string>

using namespace std;

int main() {
    string UserInput;

    cin >> UserInput;

    if (UserInput == "1") {
        cout << "Type A Word and Press enter";
    }
    else {
        cout << "NOT A USESBLE NUMBER";
    }

    cin.clear();
    cin.ignore(255, '\n');
    cin.get();

    // "return 0" is implicit.
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-20T00:10:29.987

您的代码不正确，首先您使用的是大写 I，其次您在行尾有一个分号，第三个相等有 2 个等号

```
int x;
x=1;
If (UserInput = x); 
```

应该

```
std::string x("1");
if (UserInput == x) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-20T00:09:42.220

**如果**在 C 中需要小写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T00:13:24.463

```
std::string x='1';
if (UserInput==x)
{
  cout << "Type A Word and Press enter";
} else
{
    cout << "NOT A USESBLE NUMBER";//Cout should be cout
} 
```

# r - chartSeries3d0 quantmod

> ID：12030973
> 
> 赞同：1
> 
> 时间：2012-08-20T00:08:09.473
> 
> 标签：r, quantmod

我想用chartSeries3d0在R中绘制一个3d系列。这个想法几乎是查看两个时间序列之间的 n 滚动月回报关系。

```
require(quantmod)
source("http://www.quantmod.com/examples/chartSeries3d/chartSeries3d.alpha.R")
initDate <- "2003-01-03"
endDate <- "2012-08-10"
symbols <- c("SPY","IEF")
getSymbols(symbols, from=initDate, to=endDate, index.class=c("POSIXt","POSIXct"))
data<-merge(SPY$SPY.Adjusted,IEF$IEF.Adjusted)
data<-ROC(data,n=120)
data[is.na(data)]<-0
chartSeries3d0(data) 
```

上面的代码给了我一个非常窄的 3d 图表，我怎样才能调整轴使它们更宽？

# ruby - EventMachine 和循环

> ID：12030976
> 
> 赞同：5
> 
> 时间：2012-08-20T00:09:46.947
> 
> 标签：ruby, eventmachine

这是我的代码：

```
EventMachine.run {

    conn = EM::Protocols::HttpClient2.connect request.host, 80

    req = conn.get(request.query)
    req.callback { |response|
      p(response.status)
      p(response.headers)
      p(response.content)
    }
} 
```

回调触发，也就是说，我得到状态等的字符串输出。

但我想要它做的是触发回调，然后重复。我计划实现更多逻辑，例如每次调整 URL，但现在，我只希望它：

1.  检索网址
2.  触发回调
3.  重复...

我对这种模式的理解是，该循环中的所有内容都会触发，然后返回，然后一直持续下去，直到我执行`EM.stop`.

现在，它检索 URL 数据，但似乎挂起。

我需要做某种返回才能继续在这里吗？为什么它会挂起，而不是一遍又一遍地循环？

如果我用循环围绕整个上述代码块 do ... end 它按预期工作..这是实现这个的正确方法吗？我想我很困惑，因为我认为其中的所有内容在`EM.run`完成时都会重复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T02:28:00.510

你给的`run`块只运行一次。事件循环不会直接暴露给您，而是旨在不可见的东西。不要将`run`块与`while`循环混淆。它只运行一次，但*在*事件循环执行时运行。

如果你想重复一个操作，你需要创建某种堆栈并完成它，每个回调检查堆栈是否还有更多工作要做，然后发出另一个调用。EventMachine 应用程序是使用这种回调链接方法构建的。

您将需要实现以下内容：

```
def do_stuff(queue, request = nil)
  request ||= queue.pop
  return unless (request)

  conn = EM::Protocols::HttpClient2.connect request.host, 80

  req = conn.get(request.query)
  req.callback { |response|
    p(response.status)
    p(response.headers)
    p(response.content)

    EventMachine.next_tick do
      # This schedules an operation to be performed the next time through
      # the event-loop. Usually this is almost immediate.
      do_stuff(queue)
    end
  }
end 
```

在你的事件循环中，你踢了这条链：

```
EventMachine.run do
  queue = [ ... ] # List of things to do
  do_stuff(queue)
end 
```

一旦您更好地了解 EventMachine 的工作原理，您可能会找到一种更优雅的方式来实现这一点。

# haskell - 使用 `handle` 引起的模棱两可的类型变量

> ID：12030977
> 
> 赞同：5
> 
> 时间：2012-08-20T00:09:53.593
> 
> 标签：haskell, exception-handling

在这段代码中：

```
import System.Posix.Files
import Control.Exception

safeStat :: FilePath -> IO (Maybe FileStatus)
safeStat path =
  handle (\_ -> return Nothing) (getFileStatus path >>= (return . Just)) 
```

我收到此错误（在 ghci 中）：

```
Ambiguous type variable `e0' in the constraint:
  (Exception e0) arising from a use of `handle'
... 
```

我可以通过执行以下操作来消除错误：

```
nothing :: IOException -> Maybe a
nothing _ = Nothing

safeStat :: FilePath -> IO (Maybe FileStatus)
safeStat path =
  handle (return . nothing) (getFileStatus path >>= (return . Just)) 
```

这是怎么回事？？？我希望处理程序处理*任何*异常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T02:23:23.347

`Ambiguous type variable`意味着编译器无法推断类型。因为它可以是许多具有[异常](http://www.haskell.org/ghc/docs/7.4-latest/html/libraries/base-4.5.1.0/Control-Exception.html#t%3aException)类型类实例的数据类型。您可以使用[SomeException](http://www.haskell.org/ghc/docs/7.4-latest/html/libraries/base-4.5.1.0/Control-Exception.html#t%3aSomeException)来处理任何异常。例如：

```
safeStat :: FilePath -> IO (Maybe FileStatus)
safeStat path = handle errorHandler $ fmap Just $ getFileStatus path
  where
    errorHandler :: SomeException -> IO (Maybe FileStatus)
    errorHandler _ = return Nothing 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T09:54:24.430

您可以`SomeException`在 lambda 函数的模式匹配中使用值：

```
import System.Posix.Files
import Control.Exception

safeStat :: FilePath -> IO (Maybe FileStatus)
safeStat path =
  handle (\(SomeException _) -> return Nothing) (getFileStatus path >>= (return . Just)) 
```

# actionscript-3 - 使用 Away3d 制作实体线框材料的最佳方法是什么？

> ID：12030979
> 
> 赞同：0
> 
> 时间：2012-08-20T00:10:07.833
> 
> 标签：actionscript-3, away3d, stage3d

在 Away3d 中找不到任何实心线框材料的好例子。也许我使用了错误的工具？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T15:51:22.747

有一组线框图元，如 WireframeSphere 和 WireframeCube。只需定义它们并添加到场景中：

```
var primitive = new WireframeCube(400,800,400,0xFFFFFF,1);
primitive.x = 1000;
scene.addChild(primitive); 
```

但我相信您想将线框应用于非原始对象。在那种情况下 - 我也在寻找答案......

**编辑：**

我找到了一些名为 WireframeMapGenerator 的解决方法。它不是真正的线框材料，但至少它有效： [http ://away3d.com/forum/viewthread/779/#2597](http://away3d.com/forum/viewthread/779/#2597)

# visual-studio-2010 - 从资源设置应用程序图标时应用程序大小增加

> ID：12030981
> 
> 赞同：5
> 
> 时间：2012-08-20T00:10:22.377
> 
> 标签：visual-studio-2010, visual-studio, resources

我有一个大小为 16kb 的应用程序。

通过 Project Properties 菜单添加图标资源后，应用程序如预期的那样增加到 299kb 的大小。

现在，在属性/应用程序下，当我将图标文件设置为“Resource\IconName.ico”时，文件大小再次增加到 581kb。

这是正常行为吗？我知道当我将图标添加为资源时它会增加，但当我将图标从资源设置为应用程序图标时不会增加。

谁能解释为什么会这样？

编辑：

也许更好的问题是如何使用“属性/资源”部分中的图标设置应用程序图标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T01:11:05.850

是的，这是正常行为。您的图标没有被存储为资源两次（如一些评论中所建议的那样），它只是在编译期间被链接到 exe 中，同时也被存储为资源。由于图标是面向公众的（即 explorer.exe 在呈现图标时直接访问它），因此您最终会得到 2 个不同格式的图标副本：

*   以 Windows 标准格式直接编译到 exe 中的图标副本
*   一份作为 .NET 资源的副本

如果您真的想节省这些额外的空间，请删除嵌入的资源，将您的应用程序图标引用更改为直接指向磁盘上的图标，然后，当您需要将图标的副本分配给您的表单时，直接从部件：

```
var executablePath = Assembly.GetExecutingAssembly().Location;
var icon = Icon.ExtractAssociatedIcon(executablePath); 
```

# process - 使用 ssh 在远程机器上运行进程

> ID：12030984
> 
> 赞同：0
> 
> 时间：2012-08-20T00:11:50.190
> 
> 标签：process, ssh

我正在运行一个需要很长时间才能在远程服务器上完成的进程。当我与远程机器的 ssh 连接断开时，该进程被终止。即使在我的 ssh 连接断开后，有没有办法可以继续运行该进程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T00:21:53.070

还有另一个类似的[问题](https://stackoverflow.com/questions/2190100/how-to-start-process-over-ssh-that-doesnt-terminate-when-session-ends)。

提供的答案是使用 POSIX 命令*nohup*忽略 ssh 终止并允许进程继续运行。

# jsf - 访问 xhtml 文件中的方法 - Netbeans 中的 JSF

> ID：12030985
> 
> 赞同：1
> 
> 时间：2012-08-20T00:12:13.420
> 
> 标签：jsf, netbeans

在像 IntelliJ IDEA 这样的 IDE 中，您可以使用 CTRL + B 或 CTRL + 单击来访问 bean 方法，在这种情况下，我的方法是例如......

```
<p:commandButton ....  actionListener="#{helloPageJSFBean.findAction}" /> 
```

但是在netbeans中我只能以这种方式访问​​它

```
<p:commandButton ....  actionListener="#{helloPageJSFBean.findAction(actionEvent)}" /> 
```

它的问题是当我按下按钮时 jsf 页面不起作用，但它以第一种方式起作用

我如何配置 Netbeans 以在特定方法行进行访问？谢谢。

附加信息：我使用 JSF 2.1，我的方法是

```
@Transactional
public void findAction(ActionEvent actionEvent) {

    FacesContext context = FacesContext.getCurrentInstance();
    UIViewRoot root = context.getViewRoot();

    resetDataTable(root);

    setCursorTableNull();
    onFind(actionEvent);

    //return SAME_PAGE;
} 
```

# cygwin - cygwin/bin/ld: 找不到 -lXss

> ID：12030986
> 
> 赞同：1
> 
> 时间：2012-08-20T00:12:14.153
> 
> 标签：cygwin, ld, wordnet

我正在尝试使用 cygwin 安装 WordNet。但是在制作过程中出现以下错误

```
make[2]: Entering directory `/cygdrive/d/VaiVocabulary/vaiLinuxFinal/wordNet/WordNet-3.0/src'
gcc  -g -O2   -o wishwn.exe  wishwn-tkAppInit.o wishwn-stubs.o -L../lib -lWN -L/usr/lib -ltk8.5 -L/usr/lib -ltcl8.5 -lX11 -lXss -lXext -lXft -lXrender -lfontconfig -lexpat -liconv -lfreetype -lz -lbz2 -lX11 -lxcb -lXau -lXdmcp    -ldl
/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../i686-pc-cygwin/bin/ld: cannot find -lXss
/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../i686-pc-cygwin/bin/ld: cannot find -lXext
/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../i686-pc-cygwin/bin/ld: cannot find -lXft
/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../i686-pc-cygwin/bin/ld: cannot find -lXrender
/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../i686-pc-cygwin/bin/ld: cannot find -lfontconfig
/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../i686-pc-cygwin/bin/ld: cannot find -lexpat
/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../i686-pc-cygwin/bin/ld: cannot find -lfreetype
/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../i686-pc-cygwin/bin/ld: cannot find -lbz2
collect2: ld returned 1 exit status
Makefile:223: recipe for target `wishwn.exe' failed 
```

似乎链接错误。我该怎么做才能解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:20:33.413

看起来您肯定缺少那些库。重新运行 Cygwin 的 Setup.exe，当您进入包选择屏幕时，在“搜索”框中输入您缺少的依赖项。例如，在 Libs中的 X11 文件夹中搜索`Xss`并`Xext`找到这两个库（及其开发包） 。`bz2`

# php - php变量的有效性

> ID：12030988
> 
> 赞同：-2
> 
> 时间：2012-08-20T00:12:51.047
> 
> 标签：php, variables

听起来可能很傻，但我的 php 已经过时/缺乏经验，并且从 Java 编程回到 php，所以我混淆了这些概念。

如果在 php 网页中我声明一个变量

```
$debug=TRUE; 
```

并尝试从下面的函数中访问它

```
a(){
    if ($debug){
    echo "I'm here";
    }
} 
```

变量不存在或未启动？整个文件很简单：

```
<?php
$debug=TRUE;
a(){
    if ($debug){
        echo "I'm here";
    }
}
?> 
```

我需要制作一个会话变量或其他东西吗？我很无知，同样的概念让我在使用其他变量时感到困惑。同样为了进一步使用变量，我试图被迫将我需要的所有变量传递给我使用它们的函数，而 Java 中的类概念可能会更干净，但对于这种简单性来说有点太多了. 或者我是否需要将函数（它是一个表单处理器）声明为一个类？

我知道这很愚蠢，但我浏览了谷歌和论坛，问题似乎如此明显和简单，以至于很难找到针对此的网页或条目（或者我可能问错了问题）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T00:21:22.157

[http://php.net/manual/en/language.variables.scope.php](http://php.net/manual/en/language.variables.scope.php)

```
<?php
$debug = TRUE;

function a() {
    global $debug;
    if($debug === TRUE) {
         echo "I'm here....\n"
    }
} 
```

更好的是，您可以将其作为参数传入，而不是使用全局变量：

```
<?php
$debug = TRUE;

function a($debug = TRUE) {
  if($debug === TRUE) ....
} 
```

您还可以使用 $_GLOBALS 数组：

```
<?php
$debug = TRUE;

function a() {
   if($_GLOBALS['debug'] === TRUE) ...
} 
```

您可以使用始终在范围内的常量：

```
<?php
define('DEBUG', TRUE);

function a() {
  if(DEBUG === TRUE) ...
} 
```

您还可以使用单例：

```
function a() {
    if(SingletonClass::get_instance()->debug === TRUE) {
        ...
    }
} 
```

您必须创建一个扩展 StdClass() 的单例类以获取隐式 ->get 和 ->set 方法。

[http://www.talkphp.com/advanced-php-programming/1304-how-use-singleton-design-pattern.html](http://www.talkphp.com/advanced-php-programming/1304-how-use-singleton-design-pattern.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T00:16:54.807

你想要这样的东西吗：

```
<?php
$debug=TRUE;
function a($debug){
  if ($debug){
    echo "I'm here";
  }
}

a($debug);//outputs "I'm here"
?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T00:24:42.447

这里的一些东西 a(){} 没有被定义为一个函数

```
function a(){

} 
```

接下来，除非你绝对想要它们，否则你不应该尝试使用全局变量。但是，你可以

```
$debug = TRUE;
function a(){
global $debug;
if($debug)
{
echo "it is";
}
} 
```

然后在您想检查时调用 a() 。

我必须说，我认为这不是您尝试调试的好习惯。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T00:47:03.430

将变量传递给函数，如下所示：

```
$debug = true;
function a($debug) {
    var_dump($debug);
}
a($debug);
// Outputs bool(true) 
```

# php - Codeigniter htaccess 删除 index.php 和 www

> ID：12030990
> 
> 赞同：3
> 
> 时间：2012-08-20T00:12:57.960
> 
> 标签：php, apache, .htaccess, codeigniter, mod-rewrite

我试图让我的 htaccess 重写规则`index.php`从 url中删除，并将`www.`请求重定向到非 www 版本。

这是我的 htaccess，可以很好地删除 index.php：

```
RewriteEngine on
RewriteCond $1 !^(index\.php|resources|robots\.txt)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

我遇到了另一个关于如何删除该`www`部分的问题：

```
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

但我似乎无法让他们一起玩得很好！非常感谢任何建议/建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T00:18:53.747

```
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

RewriteCond $1 !^(index\.php|resources|robots\.txt)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

`RewriteEngine On`“开始”重写。`RewriteCond`并`RewriteRule`成对工作。在这里，我们首先将用户发送到非 www 版本，并清理 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T00:23:12.353

您首先需要确保“非 www”重写规则首先出现，然后是将所有请求重定向到 CodeIgniter 引导文件的规则。请注意，以下代码仅支持 HTTP 重写。如果您还需要 HTTPS，则需要进行一些修改。

```
RewriteEngine on
# Sending all www requests to the non-www version.
RewriteCond %{HTTP_HOST} ^www.domain.com [NC]
RewriteRule ^(.*)$ http://domain.com/$1 [L,R=301]

# Now the CodeIgniter part
RewriteCond $1 !^(index\.php|resources|robots\.txt)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

# html - CSS +加载时显示动画 GIF

> ID：12030992
> 
> 赞同：1
> 
> 时间：2012-08-20T00:13:56.383
> 
> 标签：html, css

我想在加载图像时显示一个动画 GIF，我想使用 CSS 来做到这一点。（例如：如果可能，没有 JS）。

```
 <img src="images/users/girl1.png" class="thumbnailPreLoader memberImage"/>

 .thumbnailPreLoader {
     background: url('/images/image-preloader.gif') no-repeat scroll center center #F9F9F9;
     height: 101px;
     width: 101px;
     position: relative;
 }

 div#preferredMembers img.memberImage {
     border: 1px solid #808080;
     padding: 3px;
 } 
```

以上是我目前正在使用的内容，您可以在 www.datingjapan.co 上看到它（一组 5 个缩略图）。

我目前发现我只是看不到 GIF。

如果我进入 chrome 开发人员模式并更改 img 的路径，我可以看到 GIF，那么我知道路径等是正确的。

这可能吗？有没有我错过的技巧？任何帮助将不胜感激。

注意：我知道如何使用 jquery .load() 来执行此操作，但仅附加一个 CSS 类会更适合我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:17:48.273

尝试删除`scroll`in`background: url('/images/image-preloader.gif') no-repeat scroll center center #F9F9F9;`这里不需要。它解决了我的 chrome 检查器中的问题...

# javascript - Javascript中原型的使用

> ID：12030994
> 
> 赞同：0
> 
> 时间：2012-08-20T00:14:11.357
> 
> 标签：javascript, prototype

我很困惑我应该在哪里使用原型来声明一个方法？我读到的是，如果我创建一个由原型声明的方法，所有实例都使用相同的引用，那么它是静态的还是不同的？因为我可以在原型方法中访问实例属性？但是在c#中，你不能在静态方法中访问类变量（不是静态的）吗？

一个例子：

```
function Calculator()
{
     if(this === window){
          return new Calculator();
     }

     this.Bar = "Instance Variable";
}

Calculator.prototype.SaySomething = function(thing){
     return thing + " " + Bar;
}

Calculator().SaySomething("Test"); // Test Instance Variable 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T00:21:31.950

`prototype`的工作与`new`关键字一起使用。举个例子：

```
function Calculator(bar) {
     this.Bar = bar;
}

Calculator.prototype.SaySomething = function(thing){
     return thing + " " + this.Bar;
}

var calInstance = new Calendar("Instance Variable");
calInstance.SaySomething("Test"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T00:22:29.737

您正确地声明了原型方法，但错误地调用了它。`Calculator`不是静态对象，只是一个类，因此您只能在创建对象的实例时调用它的方法。

```
var calc = new Calculator();
calc.SaySomething('thing');
//this would return "thing Instance Variable" 
```

简而言之，Javascript 不使用类和实例方法，只使用实例方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T00:22:30.443

我建议您阅读Douglas Crockford[的 JS The Good Parts](https://rads.stackoverflow.com/amzn/click/com/0596517742)。它将让您更好地理解 JS 的原型对象模型。