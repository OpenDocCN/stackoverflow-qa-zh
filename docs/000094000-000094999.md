# StackOverflow 问答 000094000-000094999

# javascript - Adobe ExtendScript 开发 - 与常规 JavaScript 有何不同？

> ID：94007
> 
> 赞同：13
> 
> 时间：2008-09-18T16:10:55.083
> 
> 标签：javascript, adobe, extendscript

## 问题

我想知道 ExtendScript 与 JavaScript 有何不同？从理论上讲，我是否可以聘请一位精通 JavaScript 的 Web 开发人员来开发它，而不要求他们进行过多的学习？

## 概述

我正在研究一个媒体数据库（或所谓的“多媒体库”）项目，它基于 XMP（可扩展元数据平台）。管理元数据和关键字的逻辑工具似乎是 Adob​​e Bridge，但是我需要外包几个脚本的开发以向 Bridge 添加一些关键功能，主要用于连接服务器存储的受控关键字词汇表。

高层管理人员以其无限的智慧决定让软件 alpha/beta 测试人员和 Adob​​e 重任人员 [我] 负责开发项目发现是解决此问题的最佳方式。虽然我知道我需要做什么，但我不确定谁能真正做到。

遗憾的是，我的编程知识仅限于 C++、XML、Apple Script 和 Web 语言（不幸的是，不包括 JavaScript），所以当涉及到关于 JavaScript 的问题时，我就束手无策了。

[桥梁开发中心](http://www.adobe.com/devnet/bridge/)

Adobe 在这个主题上有一个方便的 SDK，但我无法真正理解整体情况。Adobe 用户对用户论坛的大部分内容都是旧的或不相关的。

## **项目介绍**

我需要在菜单栏中添加一个包含三个选项的菜单。这三个选项都将使用 Bridge 的“关键字”面板中可能的“清除和导入”功能，使用 FTP 或 HTTP 对象从数据库服务器导入 3 个不同的制表符分隔的文本文件中的 1 个。

我在 Bridge SDK 和 JavaScript 指南中所做的阅读表明，可以添加菜单项，如下图所示，为清楚起见。此外，我设法获得了一个非常粗略的“清除和导入”方法版本，可以用作启动脚本，但是我希望能够通过单击相应的菜单条目来即时调用它们。

![菜单图](https://farm4.static.flickr.com/3138/2868284584_ee00bb9563.jpg)

要查看图像的更大视图，请单击[此处](http://farm4.static.flickr.com/3138/2868284584_8fb0577be2_o.jpg)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T04:17:22.110

ExtendScript 非常接近于常规的 JavaScript。他们做了一些扩展（例如，运算符重载），但总的来说两者非常相似。Adobe 产品包括一个名为“ExtendScript Toolkit”(ESTK) 的 IDE，它为使用交互式调试器编写脚本提供了一个很好的环境。

您可以通过创建 MenuElement 的实例在 Bridge 中创建新的菜单项。将您创建的 MenuElement 对象的 onSelect 属性设置为您希望菜单项在您选择它时执行的功能。Bridge CS4 JavaScript 参考指南包含所有详细信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T18:54:04.117

如果它类似于用于旧 Flash IDE 的脚本，那么我认为它只是直接的 javascript/ECMAScript。唯一真正的区别是您可用的 API。我希望任何精通 javascript 的人都能很快掌握它。

# java - java - 如何在java中以快速干净的方式中止线程？

> ID：94011
> 
> 赞同：28
> 
> 时间：2008-09-18T16:11:07.067
> 
> 标签：java, multithreading

这是我的问题：我有一个对话框，其中包含一些用户可以更改的参数（例如通过微调器）。每次更改其中一个参数时，我都会启动一个线程以根据新参数值更新 3D 视图。如果用户在第一个线程工作时更改另一个值（或通过多次单击微调箭头再次更改相同值），我想中止第一个线程（以及 3D 视图的更新）并启动一个新线程使用最新的参数值。

我怎么能做这样的事情？

PS：我的线程的方法中没有循环`run()`，所以检查标志不是一个选项：更新3D视图的线程基本上只调用一个执行时间很长的方法。我无法在此方法中添加任何要求中止的标志，因为我无权访问其代码。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T18:52:10.470

尝试一些人所说的 interrupt() ，看看它是否对您的线程有任何影响。如果没有，请尝试销毁或关闭将使线程停止的资源。这有可能比尝试抛出 Thread.stop() 好一点。

如果性能是可以容忍的，您可以将每个 3D 更新视为一个离散的不可中断事件，然后让它运行到结论，然后检查是否有新的最新更新要执行。这可能会使 GUI 对用户来说有点不稳定，因为他们可以进行五次更改，然后查看五次更改前的图形结果，然后查看最新更改的结果。但是根据这个过程的时间长短，它可能是可以容忍的，并且可以避免不得不杀死线程。设计可能如下所示：

```
boolean stopFlag = false;
Object[] latestArgs = null;

public void run() {
  while (!stopFlag) {
    if (latestArgs != null) {
      Object[] args = latestArgs;
      latestArgs = null;
      perform3dUpdate(args);
    } else {
      Thread.sleep(500);
    }
  }
}

public void endThread() {
  stopFlag = true;
}

public void updateSettings(Object[] args) {
  latestArgs = args;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T16:13:06.843

更新 3D 视图的线程应该定期检查一些标志（使用 a `volatile boolean`）来查看它是否应该终止。当你想中止线程时，只需设置标志。当线程下一次检查标志时，它应该简单地跳出它用来更新视图并从其`run`方法返回的任何循环。

如果您确实无法访问线程正在运行的代码以使其检查标志，那么就没有安全的方法来停止线程。在您的应用程序完成之前，此线程是否正常终止？如果是这样，是什么导致它停止？

如果它运行了很长一段时间，而你必须结束它，你可以考虑使用不推荐使用的`Thread.stop()`方法。但是，它被弃用是有充分理由的。如果该线程在某些操作中间停止，导致某些内容处于不一致状态或某些资源未正确清理，那么您可能会遇到麻烦。[这是文档](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#stop())中的注释：

> 这种方法本质上是不安全的。使用 Thread.stop 停止线程会导致它解锁所有已锁定的监视器（这是未经检查的 ThreadDeath 异常沿堆栈传播的自然结果）。如果以前受这些监视器保护的任何对象处于不一致状态，则损坏的对象将对其他线程可见，从而可能导致任意行为。停止的许多用法应该由简单地修改一些变量以指示目标线程应该停止运行的代码替换。目标线程应该定期检查这个变量，如果变量指示它要停止运行，则以有序的方式从它的 run 方法中返回。如果目标线程等待很长时间（例如，在条件变量上），应该使用中断方法来中断等待。有关详细信息，请参阅[为什么不推荐使用 Thread.stop、Thread.suspend 和 Thread.resume？](http://java.sun.com/javase/6/docs/technotes/guides/concurrency/threadPrimitiveDeprecation.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T16:31:05.347

与其滚动你自己的布尔标志，为什么不直接使用 Java 线程中已经存在的线程中断机制呢？根据您无法更改的代码中的内部实现方式，您也可以中止部分执行。

外螺纹：

```
if(oldThread.isRunning())
{
    oldThread.interrupt();
    // Be careful if you're doing this in response to a user
    // action on the Event Thread
    // Blocking the Event Dispatch Thread in Java is BAD BAD BAD
    oldThread.join();
}

oldThread = new Thread(someRunnable);
oldThread.start(); 
```

内部可运行/线程：

```
public void run()
{
    // If this is all you're doing, interrupts and boolean flags may not work
    callExternalMethod(args);
}

public void run()
{
    while(!Thread.currentThread().isInterrupted)
    {
        // If you have multiple steps in here, check interrupted peridically and
        // abort the while loop cleanly
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T16:58:22.443

这不是有点像问“当除了 Thread.stop() 之外没有其他方法可用时，我如何中止线程？”

显然，唯一有效的答案是 Thread.stop()。它丑陋，在某些情况下可能会破坏东西，可能导致内存/资源泄漏，并且被 TLEJD（非凡的 Java 开发者联盟）不赞成，但是在像这样的一些情况下它仍然很有用。如果第三方代码没有可用的 close 方法，则真的没有任何其他方法。

OTOH，有时会有后门关闭方法。即，关闭它使用的底层流，或者它需要完成它的工作的一些其他资源。然而，这很少比调用 Thread.stop() 并让它遇到 ThreadDeathException 更好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T17:28:00.710

此问题的公认答案允许您将批处理工作提交到后台线程。这可能是一个更好的模式：

```
public abstract class dispatcher<T> extends Thread {

  protected abstract void processItem(T work);

  private List<T> workItems = new ArrayList<T>();
  private boolean stopping = false;
  public void submit(T work) {
    synchronized(workItems) {
      workItems.add(work);
      workItems.notify();
    }
  }
  public void exit() {
    stopping = true;
    synchronized(workItems) {
      workItems.notifyAll();
    }
    this.join();
  }
  public void run() {
    while(!stopping) {
      T work;
      synchronized(workItems) {
        if (workItems.empty()) {
            workItems.wait();
            continue;
        }
        work = workItems.remove(0);
      }
      this.processItem(work);
    }
  }
} 
```

要使用此类，请对其进行扩展，提供 T 的类型和 processItem() 的实现。然后只需构造一个并调用 start() 就可以了。

您可以考虑添加一个 abortPending 方法：

```
public void abortPending() {
  synchronized(workItems) {
    workItems.clear();
  }
} 
```

对于那些用户已经跳过渲染引擎并且你想扔掉到目前为止已经安排好的工作的情况。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T16:16:56.647

我过去实现类似的`shutdown()`方法是在我的`Runnable`子类中实现一个方法，该方法将一个实例变量设置`should_shutdown`为 true。该`run()`方法通常在循环中执行某些操作，并且会定期检查`should_shutdown`，当它为真时，返回或调用`do_shutdown()`然后返回。

您应该方便地保留对当前工作线程的引用，并且当用户更改值时，调用`shutdown()`当前线程并等待它关闭。然后你可以启动一个新线程。

我不建议使用`Thread.stop`它，因为我上次检查时已弃用它。

**编辑：**

阅读有关您的工作线程如何调用另一个需要一段时间才能运行的方法的评论，因此上述内容不适用。在这种情况下，您唯一真正的选择是尝试调用`interrupt()`并查看是否有任何效果。如果没有，请考虑以某种方式手动导致您的工作线程调用的函数中断。例如，它听起来像是在做一些复杂的渲染，所以可能会破坏画布并导致它抛出异常。这不是一个好的解决方案，但据我所知，这是在这种情况下停止线程的唯一方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T16:19:32.910

一旦`run()`方法完成，线程将退出，因此您需要进行一些检查以使其完成该方法。

您可以中断线程，然后进行一些检查，该检查会定期检查`isInterrupted()`并返回该`run()`方法。

您还可以使用在线程中定期检查的布尔值，如果是，则使其返回，或者如果线程正在执行一些重复任务，则将线程置于循环中，然后在您设置布尔值时退出 run() 方法。例如，

```
static boolean shouldExit = false;
Thread t = new Thread(new Runnable() {
    public void run() {
        while (!shouldExit) {
            // do stuff
        }
    }
}).start(); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T16:23:13.777

不幸的是，杀死一个线程本质上是不安全的，因为有可能使用可以通过锁同步的资源，如果你杀死的线程当前有锁，可能会导致程序陷入死锁（不断尝试获取无法获得的资源） . 您必须手动检查它是否需要从您要停止的线程中终止。Volatile 将确保检查变量的真实值，而不是之前可能已存储的值。附带说明 Thread.join 在退出线程上，以确保您等到垂死的线程实际消失后再执行任何操作，而不是一直检查。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T18:31:25.293

您似乎无法控制渲染屏幕的线程，但您似乎可以控制微调器组件。我会在线程渲染屏幕时禁用微调器。这样，用户至少有一些与他们的行为有关的反馈。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T18:52:46.660

我建议您通过使用 wait 和 notify 来防止多个线程，这样如果用户多次更改值，它只会运行一次线程。如果用户更改该值 10 次，它将在第一次更改时触发 Thread，然后在 Thread 完成之前所做的任何更改都将“汇总”到一个通知中。这不会停止线程，但根据您的描述没有好的方法可以做到这一点。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-19T22:01:14.850

旨在使用布尔字段的解决方案是正确的方向。但该领域必须是易变的。Java 语言规范[说](http://java.sun.com/docs/books/jls/third_edition/html/memory.html#17.9)：

> “例如，在以下（损坏的）代码片段中，假设 this.done 是一个非易失性布尔字段：
> 
> ```
> 而（！this.done）
>   线程.sleep(1000);
> 
> ```
> 
> 编译器可以自由地读取 this.done 字段一次，并在每次执行循环时重用缓存的值。这意味着循环永远不会终止，即使另一个线程更改了 this.done 的值。”

据我记得[“实践中的 Java 并发”的](http://jcip.net/)目的是使用 java.lang.Thread 的[interrupt()](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Thread.html#interrupt())和[interrupted()](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Thread.html#interrupted())方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T16:16:54.460

也许这可以帮助你：[我们如何在 Java 中杀死一个正在运行的线程？](http://www.jguru.com/forums/view.jsp?EID=1268343)

> 您可以通过设置外部类变量来终止特定线程。

```
 Class Outer
 {    
    public static flag=true;
    Outer()
    {
        new Test().start();
    } 
    class Test extends Thread
    {               
       public void run()
       {
         while(Outer.flag)
         {
          //do your work here
         }  
       }
    }
  } 
```

> 如果要停止上述线程，请将 flag 变量设置为`false`. 杀死线程的另一种方法是在 ThreadGroup 中注册它，然后调用`destroy()`. 这种方式也可用于通过将它们创建为组或向组注册来杀死类似的线程。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T16:42:39.593

由于您正在处理您无权访问的代码，因此您可能不走运。标准程序（如其他答案中所述）是有一个由正在运行的线程定期检查的标志。如果设置了标志，请进行清理并退出。

由于您无法使用该选项，因此唯一的其他选择是强制退出正在运行的进程。这曾经可以通过调用[Thread.stop()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#stop())来实现，但由于以下原因，该方法已被永久弃用（从 javadocs 复制）：

> 这种方法本质上是不安全的。使用 Thread.stop 停止线程会导致它解锁所有已锁定的监视器（这是未经检查的 ThreadDeath 异常沿堆栈传播的自然结果）。如果以前受这些监视器保护的任何对象处于不一致状态，则损坏的对象将对其他线程可见，从而可能导致任意行为。

可以在[此处](http://java.sun.com/j2se/1.5.0/docs/guide/misc/threadPrimitiveDeprecation.html)找到有关此主题的更多信息。

您可以完成您的请求的一种绝对可靠的方法（尽管这不是一种非常有效的方法）是通过[Runtime.exec()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Runtime.html#exec(java.lang.String))启动一个新的 java 进程，然后根据需要通过[Process.destroy()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Process.html#destroy())停止该进程。然而，像这样在进程之间共享状态并不是一件容易的事。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T16:44:25.783

您是否考虑过让线程观察您通过界面更改的属性，而不是玩线程启动和停止？在某些时候，您仍然需要线程的停止条件，但这也可以做到。如果你是 MVC 的粉丝，这很适合这种设计

抱歉，在重新阅读您的问题后，这个或任何其他“检查变量”建议都不能解决您的问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-30T17:16:21.870

正确的答案是不使用线程。

您应该使用 Executors，请参阅包：java.util.concurrent

# ruby-on-rails - 在控制器中指定模型？

> ID：94023
> 
> 赞同：1
> 
> 时间：2008-09-18T16:12:03.333
> 
> 标签：ruby-on-rails, ruby

我在一组较旧的代码（Rails 1.2.3）中遇到了一个控制器，该控制器在控制器中有以下内容：

```
class GenericController > ApplicationController
    # filters and such
    model :some_model 
```

虽然模型的名称与模型的名称不匹配，但有什么理由指定这个吗？或者这是从更高版本的 Rails 中消失的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T16:14:02.707

这与依赖注入有关。我不记得细节了。

到目前为止，它只是一个美化的`require`，您不需要它，因为 rails 自动需要文件来丢失常量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T16:13:56.763

是的，这在以后的 Rails 版本中已经消失了。没有必要指定它。

# inheritance - 继承基类

> ID：94024
> 
> 赞同：0
> 
> 时间：2008-09-18T16:12:05.330
> 
> 标签：inheritance, active-directory, forms-authentication

我正在尝试对 Active Directory 使用表单身份验证，但我需要来自 AD 的角色 (memberOf)。我正在尝试覆盖 RoleProvider 的成员以使其成为可能（除非有人知道更好的方法）。我在继承自 RoleProvider 的新类中遇到错误。

错误是：ADAuth.ActiveDirectoryRoleProvider' 没有实现继承的抽象成员 'System.Web.Security.RoleProvider.ApplicationName.get'

如何设置我没有覆盖的所有其他成员？我是否必须在我的继承类中创建它们，或者有没有办法告诉它只使用基类中的那些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T16:14:50.223

您必须覆盖基类的任何抽象元素。如果它们被标记为抽象，则意味着基类没有提供默认实现，因此您无法调用它。

# javascript - 在 JavaScript 中将字符转换为 ASCII 码

> ID：94037
> 
> 赞同：1117
> 
> 时间：2008-09-18T16:13:48.010
> 
> 标签：javascript

如何使用 JavaScript 将字符转换为其 ASCII 码？

例如：

> 从 "\n" 中得到 10。

* * *

## 回答 #1

> 赞同：1684
> 
> 时间：2008-09-18T16:15:24.823

```
"\n".charCodeAt(0); 
```

* * *

## 回答 #2

> 赞同：449
> 
> 时间：2012-03-02T19:42:56.353

[`String.prototype.charCodeAt()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/charCodeAt)可以将字符串字符转换为 ASCII 数字。例如：

```
"ABC".charCodeAt(0) // returns 65 
```

用于将数字转换为相等的 ASCII 字符的相反用途[`String.fromCharCode(10)`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/fromCharCode)。此函数可以接受多个数字并将所有字符连接起来然后返回字符串。例子：

```
String.fromCharCode(65,66,67); // returns 'ABC' 
```

这是一个快速的 ASCII 字符参考：

```
{
"31": "",      "32": " ",     "33": "!",     "34": "\"",    "35": "#",    
"36": "$",     "37": "%",     "38": "&",     "39": "'",     "40": "(",    
"41": ")",     "42": "*",     "43": "+",     "44": ",",     "45": "-",    
"46": ".",     "47": "/",     "48": "0",     "49": "1",     "50": "2",    
"51": "3",     "52": "4",     "53": "5",     "54": "6",     "55": "7",    
"56": "8",     "57": "9",     "58": ":",     "59": ";",     "60": "<",    
"61": "=",     "62": ">",     "63": "?",     "64": "@",     "65": "A",    
"66": "B",     "67": "C",     "68": "D",     "69": "E",     "70": "F",    
"71": "G",     "72": "H",     "73": "I",     "74": "J",     "75": "K",    
"76": "L",     "77": "M",     "78": "N",     "79": "O",     "80": "P",    
"81": "Q",     "82": "R",     "83": "S",     "84": "T",     "85": "U",    
"86": "V",     "87": "W",     "88": "X",     "89": "Y",     "90": "Z",    
"91": "[",     "92": "\\",    "93": "]",     "94": "^",     "95": "_",    
"96": "`",     "97": "a",     "98": "b",     "99": "c",     "100": "d",    
"101": "e",    "102": "f",    "103": "g",    "104": "h",    "105": "i",    
"106": "j",    "107": "k",    "108": "l",    "109": "m",    "110": "n",    
"111": "o",    "112": "p",    "113": "q",    "114": "r",    "115": "s",    
"116": "t",    "117": "u",    "118": "v",    "119": "w",    "120": "x",    
"121": "y",    "122": "z",    "123": "{",    "124": "|",    "125": "}",    
"126": "~",    "127": ""
} 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2014-02-18T17:57:28.127

如果您只有一个字符而不是字符串，则可以使用：

```
'\n'.charCodeAt();
'\n'.codePointAt(); 
```

省略 0...

它曾经比 慢得多`'n'.charCodeAt(0)`，但是我现在已经对其进行了测试，并且不再看到任何区别（在有和没有 0 的情况下执行了 100 亿次）。仅在 Chrome 和 Firefox 中进行性能测试。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2014-03-04T13:22:06.747

虽然其他答案是正确的，但我更喜欢这种方式：

```
function ascii (a) { return a.charCodeAt(0); } 
```

然后，要使用它，只需：

```
var lineBreak = ascii("\n"); 
```

我将其用于小型快捷方式系统：

```
$(window).keypress(function(event) {
  if (event.ctrlKey && event.which == ascii("s")) {
    savecontent();
    }
  // ...
  }); 
```

你甚至可以在 map() 或其他方法中使用它：

```
var ints = 'ergtrer'.split('').map(ascii); 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2015-06-17T09:36:28.060

对于那些想要获取字符串的所有 ASCII 代码总和的人：

```
'Foobar'
  .split('')
  .map(x=>x.charCodeAt(0))
  .reduce((a,b)=>a+b); 
```

或者，ES6：

```
[...'Foobar']
  .map(char => char.charCodeAt(0))
  .reduce((current, previous) => previous + current) 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-11-20T04:13:43.187

JavaScript 将字符串存储为`UTF-16`（双字节），因此如果您想忽略第二个字节，只需使用位运算符（即 255）将其`&`删除`0000000011111111`：

```
'a'.charCodeAt(0) & 255 === 97; // because 'a' = 97 0 
'b'.charCodeAt(0) & 255 === 98; // because 'b' = 98 0 
'✓'.charCodeAt(0) & 255 === 19; // because '✓' = 19 39 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2019-10-26T04:45:06.397

为确保完整的 Unicode 支持和可逆性，请考虑使用：

```
'\n'.codePointAt(0); 
```

这将确保在测试超过 UTF-16 限制的字符时，您将获得它们的真实代码点值。

例如

```
''.codePointAt(0); // 68181
String.fromCodePoint(68181); // ''

''.charCodeAt(0);  // 55298
String.fromCharCode(55298);  // '�' 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2021-08-09T12:05:58.613

将字符串转换为 UTF-8 的数组（流）：

```
const str_to_arr_of_UTF8 = new TextEncoder().encode("Adfgdfs");
// [65, 100, 102, 103, 100, 102, 115] 
```

**注意**：ASCII 是 UTF-8 的子集，所以这是一个通用的解决方案

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-02-19T16:51:54.033

要将字符串转换为累积数字：

```
const stringToSum = str => [...str||"A"].reduce((a, x) => a += x.codePointAt(0), 0);

console.log(stringToSum("A"));              // 65
console.log(stringToSum("Roko"));           // 411
console.log(stringToSum("Stack Overflow")); // 1386
```

## 用例：

假设您想根据用户名生成不同的背景颜色：

```
const stringToSum = str => [...str||"A"].reduce((a, x) => a += x.codePointAt(0), 0);

const UI_userIcon = user => {
  const hue = (stringToSum(user.name) - 65) % 360; // "A" = hue: 0
  console.log(`Hue: ${hue}`);
  return `<div class="UserIcon" style="background:hsl(${hue}, 80%, 60%)" title="${user.name}">
    <span class="UserIcon-letter">${user.name[0].toUpperCase()}</span>
  </div>`;
};

[
  {name:"A"},
  {name:"Amanda"},
  {name:"amanda"},
  {name:"Anna"},
].forEach(user => {
  document.body.insertAdjacentHTML("beforeend", UI_userIcon(user));
});
```

```
.UserIcon {
  width: 4em;
  height: 4em;
  border-radius: 4em;
  display: inline-flex;
  justify-content: center;
  align-items: center;
}

.UserIcon-letter {
  font: 700 2em/0 sans-serif;
  color: #fff;
}
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-01-15T22:56:42.067

为了支持ES6 中的所有 UTF-16（也[包括非 BMP/补充字符），可以使用](http://en.wikipedia.org/wiki/Plane_(Unicode)#Basic_Multilingual_Plane)[string.codePointAt()](https://tc39.github.io/ecma262/#sec-string.prototype.charcodeat)方法；

^(此方法是 charCodeAt 的改进版本，它仅支持 <65536（2 16) - 单个 16 位）的unicode 代码点。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-06-08T09:24:01.413

您可以输入一个字符并使用此代码获取 Ascii 代码

例如输入一个像 A 这样的字符，你会得到 Ascii 代码 65

```
function myFunction(){
    var str=document.getElementById("id1");
    if (str.value=="") {
       str.focus();
       return;
    }
    var a="ASCII Code is == >  ";
document.getElementById("demo").innerHTML =a+str.value.charCodeAt(0);
}
```

```
<p>Check ASCII code</p>

<p>
  Enter any character:  
  <input type="text" id="id1" name="text1" maxLength="1">	</br>
</p>

<button onclick="myFunction()">Get ASCII code</button>

<p id="demo" style="color:red;"></p>
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-06-10T09:44:47.643

```
str.charCodeAt(index) 
```

使用`charCodeAt()` 以下示例返回 65，即 Unicode 值`A`。

`'ABC'.charCodeAt(0)` ***// 返回 65***

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-10-15T10:42:16.577

扩展[Álvaro González](https://stackoverflow.com/users/13508/%C3%81lvaro-gonz%C3%A1lez)和其他人的评论，如果您仅使用 128 个原始 ASCII 字符（代码 0 到 127） ，则[charCodeAt](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charCodeAt)或[codePointAt非常好。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt)在此范围之外，**代码取决于字符集**，如果您希望结果有意义，则需要在计算之前进行字符集转换。

让我们以欧元符号为例：`'€'.codePointAt(0)`returns `8364`，它远远超出 0-127 范围，并且与 UTF-16（或[UTF-8](https://www.charset.org/utf-8/9)）字符集相关。

我正在移植一个 Visual Basic 程序，并注意到它利用`Asc`函数来获取字符代码。显然，从它的角度来看，它将返回[Windows-1252](https://www.charset.org/charsets/windows-1252)字符集中的字符代码。为了确保获得相同的数字，我需要转换字符串字符集，然后计算代码。

非常简单，例如在 Python 中：`ord('€'.encode('Windows-1252'))`.
然而，为了在 Javascript 中实现同样的效果，我不得不求助于缓冲区和[转换库](https://github.com/ashtuchkin/iconv-lite)：

```
iconv = require('iconv-lite');
buf = iconv.encode("€&quot;, 'win1252');
buf.forEach(console.log); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-10-22T05:07:52.847

```
charCodeAt(0);
```

上面的代码在大多数情况下都有效，但是在处理单词以根据上面的代码查找排名时有一个问题。例如，aa 的排名为 97+97 = 194（实际为 1+1 = 2），而 w 的排名为 119（实际为 23），这使得 aa > w。为了解决这个从上面的结果减去 96，从 1 开始定位。

```
charCodeAt(0) - 96;
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-09-30T03:11:37.277

对于那些想要获得具有平均值的字符串的所有 ASCII 代码总和的人：

```
const ASCIIAverage = (str) =>Math.floor(str.split('').map(item => item.charCodeAt(0)).reduce((prev,next) => prev+next)/str.length)

console.log(ASCIIAverage('Hello World!'))
```

# asp.net - 什么会导致 ASP.NET 工作进程被回收？

> ID：94042
> 
> 赞同：4
> 
> 时间：2008-09-18T16:14:17.947
> 
> 标签：asp.net, ajax, session

**这是我目前的问题：**

我猜我的问题（如下所述）是由 ASP.NET 工作进程被回收引起的，根据下面的答案 - 我正在使用 InProc 会话存储，并且由于限制，我看不到太多移动的机会对于其他类型的存储，所有会话对象都是可序列化的。但是，我无法弄清楚是什么让工作进程像我看到的那样经常被回收——据我所知，app 目录中的文件没有任何变化，而且 IIS 中的选项似乎意味着该进程只会每 1,740 分钟回收一次——这比实际会话丢失的频率要低得多。所以，我现在的问题是，有哪些不同的情况会导致 ASP.NET 工作进程被回收？

**这是我原来的问题：**

我的 ASP.NET Web 应用程序中出现了一个难以重现的问题。该应用程序有一个主 .aspx 页面，该页面已加载并初始化了许多会话变量。此页面使用 ASP.NET Ajax`Sys.Net.WebRequest`类重复访问另一个 .aspx 页面，该页面使用会话变量进行数据库查询和更新主页（从不重新请求主页）。

有时，在使用页面一段时间后，导致成功的 HTTP 请求，其中在主页面中创建的会话正确传递到子页面，其中一个请求似乎导致创建新的 ASP.NET 会话——所有会话变量丢失（导致我的代码中抛出异常），并且在动态请求的页面中报告了新的会话ID。这意味着突然间，主页与服务器断开连接——就服务器而言，用户不再登录。

我几乎可以肯定这不是会话超时 - 超时时间设置为荒谬，发生这种情况所需的时间是可变的，但永远不会长到足以导致会话超时，*并且*常量`Sys.Net.WebRequests` *应该*刷新会话计时器。

那么，还有什么可能导致 HTTP 请求与 ASP.NET 会话失去联系呢？不幸的是，当这种情况发生在我身上时，我并没有嗅探网络流量，否则我会检查 ASP.NET 会话 cookie 是否存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T16:15:41.033

一种解决方案是使用 StateServer，而不是 InProc 会话管理。

很多事情都可能导致会话状态丢失：

1.  编辑 Web.Config
2.  IIS 重置
3.  等等

如果会话状态对您的应用程序很重要，则使用 SQL 状态管理或 ASP 附带的状态服务器。网。

干杯，

RB。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-21T21:53:51.153

当我们将 AnkerEx 应用程序迁移到新服务器时，我们遇到了 Session 问题。新服务器具有 Microsoft Windows Server 2008 作为操作系统和 Microsoft Internet Information Services 7。服务器中还安装了 .NET Framework 版本 1.0.3705、1.1.4322、2.0.50727、3.0 和 3.5。为了解决这个问题，我已经在 ASP.NET 2.0 中为应用程序的生命周期相关事件启用了健康监控。我已添加到 web.config：

```
...
...
<system.web>
...
...
    <healthMonitoring>
      <rules>
        <add name="Application Events"
            eventName="Application Lifetime Events"
            provider="EventLogProvider"
            profile="Default"
            minInterval="00:01:00" />
      </rules>
    </healthMonitoring>
...
... 
```

检查 AppDomain 循环对我们很有帮助。我们可以在事件查看器中看到它。更多详细信息的链接是[http://blogs.msdn.com/rahulso/archive/2006/04/13/575715.aspx](http://blogs.msdn.com/rahulso/archive/2006/04/13/575715.aspx)

添加到 web.config 后，事件查看器显示我的应用程序每次单击应用程序中的几乎任何链接时都会重新启动。从[http://blogs.msdn.com/toddca/archive/2005/12/01/499144.aspx](http://blogs.msdn.com/toddca/archive/2005/12/01/499144.aspx)的文章中，我发现 ASP.NET 具有新行为 - 如果我们要删除，例如子应用程序根目录的目录，然后 ASP.NET 2.0 将重新启动 AppDomain。

问题在于我在 web.config 中的指令：

```
...
<compilation debug="true" tempDirectory="c:\AnkerEx\Temporary ASP.NET files">
... 
```

即 ASP.NET 在我的应用程序根文件夹中编译了 aspx 页面。我认为他创建了文件夹，可能并且确实也删除了其中一些。我删除了 tempDirectory 指令，应用程序开始稳定工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:15:25.790

工作进程可能正在循环。 [http://www.lattimore.id.au/2006/06/03/iis-dropping-sessions/](http://www.lattimore.id.au/2006/06/03/iis-dropping-sessions/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:21:38.100

它可能是由后台线程中未处理的异常引起的。它可能会导致您的 ASP.NET 工作进程终止。一个新进程会很快启动，因此您实际上不会注意到它，但您的所有会话都会丢失。

这是一篇比我能解释得更好的文章：[ASP.NET 2.0 Unhandled Exception Issues](http://www.eggheadcafe.com/articles/20060305.asp)

引用：

> 正在运行的 ASP.NET 2.0 应用程序中未处理的异常通常会终止 W3WP.exe 进程，并留下一个非常神秘的 EventLog 条目，如下所示：
> 
> “事件类型 clr20r3、P1 w3wp.exe、P2 6.0.3790.1830、P3 42435be1、P4 app_web_ncsnb2-n、P5 0.0.0.0、P6 440a4082、P7 5、P8 1、P9 system.nullreferenceexception、P10 NIL。”

这是解释同一问题的 Microsoft 知识库文章：[KB911816 Unhandled exceptions cause ASP.NET-based applications to unexpectedly quit in the .NET Framework 2.0](http://support.microsoft.com/?id=911816)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T15:29:01.190

我的猜测是内存消耗——但是，设置[IIS 来记录回收](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/87892589-4eda-4003-b4ac-3879eac4bf48.mspx?mfr=true)，你肯定会知道。

# xml - .NET 3.5 XPath 类和方法是否与 XSLT 2.0 兼容？

> ID：94047
> 
> 赞同：3
> 
> 时间：2008-09-18T16:14:57.337
> 
> 标签：xml, xslt, .net-3.5, xpath

我想在使用 match 函数选择元素时使用正则表达式。我宁愿不使用外部库（例如 saxon）来执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-11-04T10:43:59.097

我相信这个讨论中的答案具有误导性。我认为 .NET 3.5 不支持大多数 XSL/T 2.0 功能（如果有的话）。

**一个例子**：

在 .NET 3.5 下调用 2.0 函数会出现以下错误消息：

**'current-dateTime()' 是一个未知的 XSLT 函数。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T16:45:24.783

XSLT 2.0 中的某些内容在内置库中不受支持（在单声道邮件列表中对此进行了讨论，但我再也找不到信息了）。但是大多数人从不遇到不受支持的极端情况。

另一种选择是查看开源[http://saxon.sourceforge.net/](http://saxon.sourceforge.net/)，它对 2.0 有很好的支持。

***编辑（AB）：上述接受的答案可能令人困惑。对于 .NET 中的任何 XPath 2.0 或 XSLT 2.0 功能，根本没有任何支持，也[没有朝这个方向发展的计划。](https://stackoverflow.com/questions/1525299/xpath-and-xslt-2-0-for-net)***

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T18:51:44.767

我认为上面的答案是错误的。我找不到任何证据表明 Microsoft 支持 XSLT 2.0。XSLT != XPath。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T15:00:34.790

为了将来参考，这里有一个关于在 .net 中扩展 xpath/xquery 的好页面：

[http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=64](http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=64)

我不相信这会持续下去，所以我在这里复制它：

* * *

XSLT 是一种 XML 转换语言。它允许服务器系统将源 XML 树转换为更适合客户端的形式。XSLT 使用节点模式来匹配模板以执行其转换。尽管它使复杂的转换相对简单，但在某些情况下我们可能不得不使用一些自定义类。

我们可能需要扩展 XSLT 的一些情况是：

1) 调用自定义业务逻辑
2) 根据权限执行不同的操作
3) 对日期、字符串等执行复杂的格式化
4) 甚至调用 Web 服务！

扩展 XSLT 的步骤

1) 在 XSLT 中创建要使用的自定义对象（在 C# 中）

```
CustomDate custDate = new CustomDate() ; 
```

2) 在 XSLTs 命名空间声明中为自定义类提供自定义命名空间声明（在 XSLT 文件中）

```
<xsl:transform
        version="1.0"
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        xmlns:myCustDate="urn:custDate"> 
```

3) 将自定义对象的实例传递给 XSLT，其命名空间与上一步相同（在 C# 中）

```
xslArgs.AddExtensionObject("urn:custDate", custDate) ; 
```

4) 使用 XSLT 中的对象（在 XSLT 文件中）

```
<xsl:value-of select="myCustDate:GetDateDiff(./joiningdate)"/> 
```

示例代码

对于我们的示例，假设我们有一个需要在其中操作日期的 XSLT 表。我们需要显示员工在公司工作的天数。由于 XSLT 没有本机日期操作函数，让我们为我们的任务使用一个扩展对象。

```
using System ;
using System.IO ;
using System.Xml ;
using System.Xml.Xsl ;
using System.Xml.XPath ;

public class XsltExtension{

    public static void Main(string[] args){

        if (args.Length == 2){

            Transform(args[0], args[1]) ;

        }else{

            PrintUsage() ;

        }
    }

    public static void Transform(string sXmlPath, string sXslPath){

        try{

            //load the Xml doc
            XPathDocument myXPathDoc = new XPathDocument(sXmlPath) ;

            XslTransform myXslTrans = new XslTransform() ;

            //load the Xsl 
            myXslTrans.Load(sXslPath) ;

            XsltArgumentList xslArgs = new XsltArgumentList() ;

            //create custom object
            CustomDate custDate = new CustomDate() ;

            //pass an instance of the custom object
            xslArgs.AddExtensionObject("urn:custDate", custDate) ;

            //create the output stream
            XmlTextWriter myWriter = new XmlTextWriter("extendXSLT.html", null) ;

            //pass the args,do the actual transform of Xml
            myXslTrans.Transform(myXPathDoc,xslArgs, myWriter) ;        

            myWriter.Close() ;

        }catch(Exception e){

            Console.WriteLine("Exception: {0}", e.ToString());
        }

    }

    public static void PrintUsage(){
        Console.WriteLine("Usage: XsltExtension.exe <xml path> >xsl path<") ;
    }

}

//our custom class
public class CustomDate{

    //function that gets called from XSLT
    public string GetDateDiff(string xslDate){

        DateTime dtDOB = DateTime.Parse(xslDate) ;

        DateTime dtNow = DateTime.Today ;

        TimeSpan tsAge = dtNow.Subtract(dtDOB) ;

        return tsAge.Days.ToString() ;
    }

} 
```

编译此代码并使用提供的 members.xml 和 memberdisplay.xsl 运行此控制台应用程序。您应该在同一文件夹中看到一个 extendXSLT.html 文件。打开这个文件，注意到我们的类 CustomDate 已经被调用来计算员工在公司的天数。

简介：
XSLT 是一种强大的 XML 转换语言，但是在 .NET 和 C# 中使用扩展对象应该确保我们可以轻松地完成单独使用 XSLT 不可能或难以完成的事情。

成员.xml：

```
 <root>
    <member>
        <name>Employee1</name>
        <joiningdate>01/01/1970</joiningdate>
        <role>CTO</role>
    </member>
    <member>
        <name>Employee2</name>
        <joiningdate>24/07/1978</joiningdate>
        <role>Web Developer</role>
    </member>
    <member>
        <name>Employee3</name>
        <joiningdate>15/12/1980</joiningdate>
        <role>Tester</role>
    </member>
</root> 
```

成员显示.xsl：

```
<xsl:transform
        version="1.0"
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        xmlns:myCustDate="urn:custDate">

<xsl:output method="html" omit-xml-declaration="yes" />     

    <xsl:template match="/">
        <html>
            <head>
                <style>
                    TABLE.tblMaster
                    {
                        border-style: solid; 
                        border-width: 1px 1px 1px 1px; 
                        border-style: solid; 
                        border-color:  #99CCCC; 
                        padding: 4px 6px; 
                        text-align: left; 
                        font-family:Tahoma,Arial;
                        font-size:9pt;

                    }
                    TD.tdHeader
                    {
                        FONT-WEIGHT: bolder;
                        FONT-FAMILY: Arial;
                        BACKGROUND-COLOR: lightgrey;
                        TEXT-ALIGN: center
                    }
                </style>
            </head>
            <body>
                <table width="50%" class="tblMaster">
                    <tr >
                        <td class="tdHeader">Employee</td>
                        <td class="tdHeader">Join date</td>
                        <td class="tdHeader">Days in company</td>
                        <td class="tdHeader">Role</td>
                    </tr>
                    <xsl:for-each select="/root/member">

                        <tr >
                            <td> <xsl:value-of select="./name"/> </td>

                            <td> <xsl:value-of select="./joiningdate"/> </td>

                            <td> <xsl:value-of select="myCustDate:GetDateDiff(./joiningdate)"/> </td>

                            <td> <xsl:value-of select="./role"/> </td>
                        </tr>   

                    </xsl:for-each>

                </table>
            </body>
        </html>
    </xsl:template>

</xsl:transform> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-12-10T15:35:44.507

在讨论 .NET 对 XSLT 2.0、XPath 2.0 和 XQuery 1.0 的支持时，区分语言本身和数据模型 (XDM) 很重要。.NET 3.5 框架支持数据模型，但不支持语言。正如微软的 Pawel Kadluczka 最近通过电子邮件向我解释的那样：

> “XQuery 1.0 和 XPath 2.0 数据模型的实例”这句话可能令人困惑，但我相信它指的是 W3C XQuery 1.0 和 XPath 2.0 数据模型 (XDM) 规范 ( [http://www.w3.org/TR/xpath-数据模型](http://www.w3.org/TR/xpath-datamodel)），内容为：
> 
> [定义：数据模型的每个实例都是一个序列。]。
> 
> [定义：序列是零个或多个项目的有序集合。] 序列不能是序列的成员。单独出现的单个项目被建模为包含一个项目的序列。序列在 2.5 序列中定义。
> 
> [定义：一个项目要么是一个节点，要么是一个原子值]，
> 
> 在 XPath API 的情况下 - XPathNodeIterator 是序列，而 XPathItem (XPathNavigator) 表示项目。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-09-18T16:17:41.557

是的，XPathNavigator 3.5 支持 XSLT 2.0。

[http://msdn.microsoft.com/en-us/library/system.xml.xpath.xpathnavigator.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xpath.xpathnavigator.aspx)

“System.Xml.XPath 命名空间中的 XPathNavigator 类是一个抽象类，它定义了一个用于导航和编辑 XML 信息项的游标模型，作为 XQuery 1.0 和 XPath 2.0 数据模型的实例。”

# .net - 你是如何使用 Machine.config 的，还是你？

> ID：94053
> 
> 赞同：13
> 
> 时间：2008-09-18T16:15:32.483
> 
> 标签：.net, asp.net, deployment, configuration

对于 ASP.Net 应用程序部署，您将什么类型的信息（如果有）存储在 machine.config 中？

如果您不使用它，您将如何管理可能因每个环境而更改的特定于环境的配置设置？

我正在寻找一些“最佳做法”以及每种做法的好处/缺陷。我们将在两个月内将一个全新的应用程序部署到生产环境中，而我在这些类型的决策中拥有一定的自由度。我想确保我以尽可能最好的方式处理事情，并试图避免以后在自己的脚下开枪。

仅供参考，我们目前仅将它（machine.config）用于数据库连接信息，并将所有其他可能更改的变量存储在数据库的配置表中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T16:29:04.527

我们正在考虑使用 machine.config 为环境添加一个密钥，然后在 web.config 中有一个部分，对于所有环境都完全相同。这样我们就可以进行“真正的”XCopy 部署。

例如，在每台计算机（本地开发工作站、阶段服务器、构建服务器、生产服务器）的 machine.config 中，我们将添加以下内容：

```
<appSettings>
    <add key="Environment" value="Staging"/>
</appSettings> 
```

然后，任何特定于环境的配置元素都会附加环境，如下所示：

```
<connectionStrings>
    <add name="Customers.Staging" provider="..." connectionString="..."/>
</connectionStrings>
<appSettings>
    <add key="NTDomain.Staging" value="test.mydomain.com"/>
</appSettings> 
```

我们没有解决方案的一个问题是如何在 web.config 中为调试环境而不是实时环境启用跟踪。

另一个问题是实时连接字符串包括。用户名和密码现在在您的源代码管理系统中。然而，这对我们来说不是问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T19:11:54.307

如果您对服务器进行负载平衡，则绝对必须确保所有服务器上的机器密钥都相同。Viewstate 应该与服务器无关，但事实并非如此，因此如果服务器之间的机器密钥不同，您将收到 viewstate 损坏错误。

```
<machineKey validationKey='A130E240DF1C49E2764EF8A86CEDCBB11274E5298A130CA08B90EED016C0
14CEAE1D86344C29E67E99DF83347E43820050A2B9C9FC89E0574BF3394B6D0401A9'
decryptionKey='2CC37FFA8D14925B9CBCC0E3B1506F35066FEF33FEB4ADC8' validation='SHA1'/> 
```

来自：[http ://www.c-sharpcorner.com/UploadFile/gopenath/Page107182007032219AM/Page1.aspx](http://www.c-sharpcorner.com/UploadFile/gopenath/Page107182007032219AM/Page1.aspx)

PS确定您可以启用ViewStateMAC =“false”，但不要。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-18T16:56:02.090

我们在生产服务器上使用 machine.config 来设置/删除对生产很重要的特定配置，我们永远不想忘记设置它们。

这些是最重要的两个：

```
<system.web>
    <deployment retail="true" />
    <healthMonitoring enabled="true" />
</system.web> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T16:27:25.777

我不仅将 machine.config 用于 ASP.NET，还用于整体配置。我在 C# 中实现了一个哈希算法（Tiger），并希望它可以通过机器请求获得。因此，在 GAC 中注册了我的程序集并将以下内容添加到 machine.config：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <mscorlib>
        <cryptographySettings>
            <cryptoNameMapping>
                <cryptoClasses>
                    <cryptoClass Tiger192="Jcs.Tiger.Tiger192, Jcs.Tiger, Culture=neutral, PublicKeyToken=66c61a8173417e64, Version=1.0.0.4"/>
                    <cryptoClass Tiger160="Jcs.Tiger.Tiger160, Jcs.Tiger, Culture=neutral, PublicKeyToken=66c61a8173417e64, Version=1.0.0.4"/>
                    <cryptoClass Tiger128="Jcs.Tiger.Tiger128, Jcs.Tiger, Culture=neutral, PublicKeyToken=66c61a8173417e64, Version=1.0.0.4"/>
                </cryptoClasses>
                <nameEntry name="Tiger" class="Tiger192"/>
                <nameEntry name="TigerFull" class="Tiger192"/>
                <nameEntry name="Tiger192" class="Tiger192"/>
                <nameEntry name="Tiger160" class="Tiger160"/>
                <nameEntry name="Tiger128" class="Tiger128"/>
                <nameEntry name="System.Security.Cryptography.HashAlgorithm" class="Tiger192"/>
            </cryptoNameMapping>
            <oidMap>
                <oidEntry OID="1.3.6.1.4.1.11591.12.2" name="Jcs.Tiger.Tiger192"/>
            </oidMap>
        </cryptographySettings>
    </mscorlib>
</configuration> 
```

这使我的代码看起来像这样：

```
using (var h1 = HashAlgorithm.Create("Tiger192"))
{
   ...
} 
```

并且在我的代码中完全不依赖于 Jcs.Tiger.dll 程序集，无论是硬的还是软的。

# unit-testing - 通过 Gallio 使用 Resharper 单元测试运行器进行 MSTest

> ID：94057
> 
> 赞同：4
> 
> 时间：2008-09-18T16:15:57.380
> 
> 标签：unit-testing, resharper, mstest, gallio

我试图让[Resharper](http://www.jetbrains.com/resharper/)测试运行器通过[Gallio](http://www.gallio.org/)识别我的 MSTest 单元测试。

我安装了以下内容：VSTS 2005 8.0.50727.762 Resharper 4.1 Gallio 3.0.0.285

我也在运行 Windows XP x64。

单元测试选项仅显示 NUnit 可用。我在想我一定有一些版本错误。有人可以指出我正确的方向吗？我是在吠叫错误的树，这仅在 VS2k8 中有效吗？

**更新：**好吧，我将 Gallio 更新为 GallioBundle-3.0.4.385-Setup，它现在显示在 R# 的单元测试选项中。但是在 R# 或 Icarus 中运行测试时出现以下错误：

> 失败 无法运行测试，因为找不到 MSTest 可执行文件

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T17:39:01.317

我不确定这是否适用于您的问题，但 Gallio 网站上的最新消息指出：

> **Gallio 和 ReSharper 4.0**
> 一些人询问 Gallio 何时会支持 ReSharper 4.0 的最终版本。不幸的是，ReSharper 4.0 Beta 和最终版本之间发生了一些最后的重大更改。因此，Gallio Alpha 3 Update 2 中的 ReSharper 插件将不再工作。无论如何...我们计划在本周晚些时候发布 Gallio 的另一个更新。

**更新：**刚刚看到这适用于比您使用的更早的版本，所以忽略它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T18:50:12.363

看起来这是一个 Gallio 问题。它似乎只支持 VS2k8 附带的 MSTest 版本。vsmdi 的 XML 格式在版本之间发生了变化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T23:22:13.720

ReSharper 4.5 支持开箱即用的 MSTest。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T23:31:18.440

还有一个最近发布的 MSTest ReSharper 插件： [http ://www.sneal.net/blog/2009/01/24/MSTestReSharper4Plugin.aspx](http://www.sneal.net/blog/2009/01/24/MSTestReSharper4Plugin.aspx)

我已经能够在 Visual Studio 2005 上通过 ReSharper 4.1 成功使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T07:24:10.933

您不需要 resharper 来支持独立的 mstest 安装。我在这里的帖子中解释了如何在没有 VS 的情况下进行独立的 mstest 安装 - [http://www.shunra.com/shunrablog/index.php/2009/04/running-mstest-without-visual-studio](http://www.shunra.com/shunrablog/index.php/2009/04/running-mstest-without-visual-studio)

# svn - 从 VSS 迁移到 SVN

> ID：94058
> 
> 赞同：8
> 
> 时间：2008-09-18T16:16:03.903
> 
> 标签：svn, version-control, visual-sourcesafe

我需要编写一个脚本来使源代码安全的项目准备好转移到颠覆，到目前为止我需要做什么我能想到的：

*   删除 .scc 文件
*   删除 .vspcc 文件

我是否也需要删除所有文件的“只读”属性，还是没关系？

你会用什么语言编写这个脚本，我打算用 python 来做（os.walk 很棒），但也许 powershell 更适合在 windows 上更改文件属性（如果我需要的话）？

在我将项目迁移到 SVN 之前，您还有什么可以想到的需要完成的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T16:45:59.633

对于手动迁移（或了解会发生什么）：

*   删除所有文件的“只读”属性
*   删除 *.scc
*   删除 *.vssscc
*   删除 *.vspscc
*   删除 *.suo
*   从您的 solution.sln 文件中删除“SourceCodeControl ...”部分
*   从您的 projects.csproj 文件中删除“SccProjectName...”部分

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T23:59:47.907

I also have a hard drive with a bunch of VSS projects that I want to move to SVN projects.

Couldn't you just use [Vss2Svn](http://www.pumacode.org/projects/vss2svn)? It sounds like this will convert VSS projects to SVN, but I have not tried it and have not heard anything about it. Has anyone tried this to move from VSS to SVN? Or is it better to do it manually?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T16:17:19.953

[http://www.poweradmin.com/sourcecode/vssmigrate.aspx](http://www.poweradmin.com/sourcecode/vssmigrate.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T16:17:58.080

您可以做的最好的事情是干净导出存储库中的所有文件。吹走任何是 VSS 的东西。

完成后，只需进行颠覆导入，您就可以开始了。如果你编写一个脚本，你只会多一个维护和故障点。因此，我更喜欢只进行干净的导入。

# wget - 连接到 https 页面时 wget 速度慢

> ID：94074
> 
> 赞同：2
> 
> 时间：2008-09-18T16:17:33.757
> 
> 标签：wget

我正在使用 wget 连接到这样的安全站点：

`wget -nc -i inputFile`

其中 inputeFile 由如下 URL 组成：

`[https://clientWebsite.com/TheirPageName.asp?orderValue=1.00&merchantID=36&programmeID=92&ref=foo&Ofaz=0](https://clientWebsite.com/TheirPageName.asp?orderValue=1.00&merchantID=36&programmeID=92&ref=foo&Ofaz=0)`

此页面返回一个小 gif 文件。出于某种原因，这大约需要 2.5 分钟。当我将相同的 URL 粘贴到浏览器中时，我会在几秒钟内得到响应。

有谁知道是什么原因造成的？

顺便说一下，wget的版本是“GNU Wget 1.9+cvs-stable（Red Hat修改）”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-11-04T19:22:30.280

我知道这是一岁了，但这个确切的问题困扰了我们好几天。原来它是我们的 DNS 服务器，但我通过在我的盒子上[禁用 IP6来解决它。](https://wiki.debian.org/DebianIPv6#How_to_turn_off_IPv6)

您可以通过在命令末尾添加“--inet4-only”（不带引号）在进行系统更改之前对其进行测试。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T16:20:45.233

1.  尝试伪造你的 UserAgent

    ```
    -U "Mozilla/5.0 (X11; U; Linux i686 (x86_64); en-GB; rv:1.9.0.1) Gecko/2008070206 Firefox/3.0.1" 
    ```

2.  禁用证书检查（慢）

    ```
    --no-check-certificate 
    ```

3.  通过启用详细程度来调试发生的事情

    ```
    -v 
    ```

4.  消除对 DNS 查找的需要：

    在您的 HOSTS 文件中硬编码他们的 IP 地址

    ```
    /etc/hosts 
    123.122.121.120  foo.bar.com 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:30:57.050

您是否尝试过使用 strace/dtrace/truss 分析请求（取决于您的平台）？

有各种各样的问题可能会导致这种情况。wget 正在使用什么版本的 openssl - 那里可能存在问题。这是在什么操作系统上运行的（完整的信息在那里很有用）。

由于站点上实施的 wget 传递代理 ID 以减少蜘蛛的影响，因此可能会强制执行某种形式的下载减速。

wget 是否执行完整的证书验证？您是否尝试过使用--no-check-certificate？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:22:16.493

客户站点上的证书是否有效？如果它是自签名证书，您可能需要指定 --no-certificate-check。

[wget 的 HTTPS (SSL/TLS) 选项](http://www.gnu.org/software/wget/manual/wget.html#HTTPS-_0028SSL_002fTLS_0029-Options)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-02T06:11:35.463

一种有效的解决方案是删除`https:\\`. 这将我的下载速度提高了大约 100 倍。

例如，您想通过以下方式下载：

```
wget https://data.keithito.com/data/speech/LJSpeech-1.1.tar.bz2 
```

您可以交替使用以下命令来加快速度。

```
wget data.keithito.com/data/speech/LJSpeech-1.1.tar.bz2 
```

# visual-studio - Visual Studio 解决方案中的类数

> ID：94084
> 
> 赞同：13
> 
> 时间：2008-09-18T16:18:46.780
> 
> 标签：visual-studio

有没有一种简单的方法来查找 Visual Studio 解决方案中包含的类的数量？除了编写一个时髦的查找脚本之外，我找不到在 VS 的代码度量部分中执行此操作的方法。

我正在运行 Visual Studio 2008，这是一个贯穿始终的 VB.Net 项目。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T17:34:07.927

您可以使用像[SourceMonitor](http://www.campwoodsw.com/sourcemonitor.html)这样的免费工具，它有一组合理的指标，包括类的数量。你也可以使用像[NDepend](http://ndepend.com/)这样的工具，它功能更强大，但也需要花钱。如果您使用的是 MSBuild 或 NAnt，两者都可以集成到您的构建环境中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T16:28:49.533

不知道直接的方法，但也许这会对您有所帮助：

*   打开 MainMenu/View/Other Windows/Code Metric 结果
*   计算代码度量结果
*   将结果导出到 Excel
*   使用 Excel 获取列表中唯一类型的计数。

不知道代码指标东西是否在 VS 的所有版本中都可用。我正在使用团队套件版。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-18T11:52:31.937

打开解决方案并在所有文件中搜索“类”（单词类前后有空格）。这将找到所有行，如：
public class A : B
结果应该是这样的
**Matching lines: 2887** Matching files: 2271 Total files searched: 2486
第一个数字是您要搜索的数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:27:17.243

我以前没有使用过这些工具，但它们可能有一些可以帮助你的工具。基本上任何代码度量包都可以提供帮助。VS 2008 应该有一个内置的代码度量工具，但我认为它因某种原因被否决了。

*   [反射器的 CodeMetrics 插件](http://www.codeplex.com/reflectoraddins/Wiki/View.aspx?title=CodeMetrics)
*   [NDepend](http://www.ndepend.com/Default.aspx) - 我认为是商业的，虽然有试用下载

--编辑-- JRoppert
是正确的。我实际上记得读过该指标工具仅在 Team 版本中可用，在 Pro 或 Express 中不可用

# typing - 如何打字更快

> ID：94101
> 
> 赞同：25
> 
> 时间：2008-09-18T16:20:46.463
> 
> 标签：typing, touch-typing, performance, wpm

在过去的几年里，我输入了大约 75wpm，但我一直想知道人们是如何输入 +100wpm 的。

我已经搜索过，但我主要是找到教你打字的打字导师……而不是教你打字更快。到目前为止，我遇到的唯一提示是学习 dvorak。

有没有练习或技巧来帮助突破 75wpm 的墙？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-18T16:28:56.837

我假设[史蒂夫耶格最近的帖子](http://steve-yegge.blogspot.com/2008/09/programmings-dirtiest-little-secret.html)提示了这个？评论包含许多在线和离线测量和改进的工具和游戏。我将在这里列出它们：

*   [Gnu 打字员](http://www.gnu.org/software/gtypist/)
*   [A型](http://typera.tk/)
*   [TypeRacer](http://play.typeracer.com/)（几个人命名了这个网站）
*   [打字速度](http://typespeed.sourceforge.net/)
*   [typeonline.co.uk](http://www.typeonline.co.uk/typingspeed.php)

**更新：**我刚刚按照 Mark Biek 的建议尝试了 GNU Typist，我不得不说它似乎是迄今为止提到的最好的。看起来有可用的 Windows 版本，尽管我确信那里有更漂亮（也更昂贵）的应用程序。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-18T16:24:19.577

对我有帮助的一件事是我从钢琴家那里学到的东西……在做一个触摸打字程序时，故意放慢速度并加快你的打字速度，从慢得令人作呕的慢到非常快。这有助于训练自己弄清楚如何让手指更快地协同工作并加强关键位置。

另一个也许是速读课程可能会有所帮助？通常，您的手指是打字速度减慢的最后一行。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-18T16:25:27.000

让自己处于符合人体工程学的打字姿势是一个好的开始。看看[这里](http://www.yale.edu/ergo/neutral.htm)的图表——注意手臂在一条直线上，脚在地板上，等等。

以我的经验，大多数人在遇到不寻常的键（数字、符号、标点符号等）时往往会放慢速度，所以也许对这些键组合进行一些集中练习？练习输入一长串数字和符号，也许可以尝试使用一些 Perl 代码作为你的复制页面 :)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-18T16:28:44.417

如果您想在玩得开心的同时练习，请查看[http://typeracer.com](http://typeracer.com)

它让您与其他人竞争并相信我，没有什么比健康的竞争更能让您打字比平常更快的了。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-18T16:25:55.173

## 实践！

* * *

[GNU Typist](http://www.gnu.org/software/gtypist/)是一个很棒的、免费的、多平台的练习程序。他们有不同的练习来练习触摸打字以及一般的速度练习。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-18T16:29:09.067

就像以前的海报所说的那样，练习，练习，练习。但是，如果你是一名开发人员（因为你在这个网站上，我假设你是），那么编写代码可能不是你需要提高你的打字技能超过当前最大值的练习类型。我什至认为 75wpm 对于任何代码编写任务来说都绰绰有余。但如果你真的想练习更多，那么我建议你[买一本 Typing of the Dead](http://en.wikipedia.org/wiki/The_Typing_of_the_Dead)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-18T17:23:37.437

考虑切换到专为快速打字而设计的键盘布局，而不是仅仅因为历史原因而布局，例如[Dvorak 或 Colemak](http://en.wikipedia.org/wiki/Keyboard_layout#Non-QWERTY_keyboards_for_Roman_scripts)。

对我来说，使用大写锁定键作为退格键也很有帮助，例如在 Windows 上使用[SharpKeys](http://www.randyrants.com/sharpkeys/)。

如果您真的是铁杆，请创建自己的键盘布局。在 Windows 上，您可以使用[Microsoft Keyboard Layout Creator](http://www.microsoft.com/Globaldev/tools/msklc.mspx)来做到这一点。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-18T16:26:19.430

聊天。很多。

我从未接受过任何触摸打字培训。事实上，当我刚开始的时候，我不得不在键盘上搜索钥匙……现在经过 7 年的 IMing，它的所有肌肉记忆。我从来没有尝试过加快我的打字速度，但很多时候它只是在我什至没有意识到我正在按我的想法打字的情况下流动。我也注意到我可以输入我的用户名和短语，我经常使用比其他东西快很多。

这可能是也可能不是一个有用的答案。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-18T16:35:17.227

请注意，提高打字速度会增加患腕管综合症的风险：

“然而，在某些情况下，打字速度可能会影响风险。例如，速度为每分钟 60 个单词的打字员的手指每天会施加高达 25 吨的压力。” [[来源]](http://www.umm.edu/patiented/articles/who_gets_carpal_tunnel_syndrome_000034_4.htm)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-18T17:55:27.237

一致性和实践性。四件事极大地改善了我的打字：

1.  找到一个非常适合您的手的舒适键盘。这不是关于人体工程学或分体式键盘，而是更多关于找到一个手指触手可及的完美键盘。这意味着使用键盘几个星期，看看它是否合适。选择键盘后，100% 使用它。在家和工作中使用相同的键盘。

2.  确保您的工作站适合您。基本上，请遵循任何体面的人体工程学指南（到处都是 90 度是错误的！！！）。所有这些“人机工程学”的东西都有利于你身体其他部位的压力，这会分散你的注意力或导致肌肉疲劳（即打字速度变慢）。同样，在任何地方都使用相同的工作站配置——如果这意味着要在家中购买同样昂贵的椅子，那就去做吧。

3.  发送电子邮件、聊天和发帖时，请使用完整的单词和句子。缩写、俚语和其他“捷径”教会了我很多不好的打字习惯，让我变得懒惰。他们还有很多在其他地方没有出现的尴尬字母组合，包括正常的组合和编码。

4.  一致性。始终使用具有相同设置和快捷方式的相同工具。您花在担心软件如何工作和伸手去拿鼠标上的时间越少，您的打字速度就越快。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-29T06:24:43.060

你需要自己拿起一份[《死亡打字》的](http://en.wikipedia.org/wiki/The_Typing_of_the_Dead)副本，然后开始杀死僵尸。您将同时磨练您的打字技巧并为著名的僵尸启示录做准备！ [抓住演示](http://downloads.gamezone.com/demos/d2037.htm "死亡演示的打字")来看看吧！

说真的，我玩这个游戏已经很多年了，它确实帮助我提高了打字技巧，而且它比任何其他打字程序都更有趣。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-06-13T22:20:41.470

键入歌曲的节拍。从缓慢的节拍开始，然后逐步向上。不要着急。突然输入通常会适得其反。节奏导致准确性。键盘就像一种乐器，这就是音乐家获得准确性的方式。您还需要定期练习，即使每天只需 5 分钟，以训练您的肌肉。

我忘记了细节，但我记得有人问过一些著名的小提琴家：

“你怎么学得这么快？”

他的回答是：“真的，真的很慢”。

:)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-18T16:30:28.953

用双手（和所有十个手指）。

为了最大限度地提高打字速度，您需要使用相反的小指来换档/Ctrl 等，并且您希望最大限度地减少“重新获得”原始位置的时间。编码时我最大的打字增加是真正了解我的 IDE 的键盘快捷键，因为这消除了使用鼠标相对较慢的过程。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-29T05:16:40.857

禁用鼠标。（这比 WPM 更适合整体计算机生产力。）

而且我知道你不能自己做，所以请人强制执行。

它会迫使您学习键盘快捷键并考虑对键盘友好的选项。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-18T16:22:58.237

一个漂亮的触觉键盘会有所帮助。特别是如果它是空白的。你很快就会加速前进。

[http://store.daskeyboard.net/prdaskeulorb.html](http://store.daskeyboard.net/prdaskeulorb.html)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-18T16:58:31.007

如果您在使用特定组合键时遇到问题或错误键入特定单词，或者只是想练习某些内容，请将其输入您的密码。这样你就可以把它固定在你的肌肉记忆中，因为你甚至看不到你在打字什么。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-18T16:23:42.510

实践，实践和实践

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-18T16:29:24.383

让你看不到键盘，这将迫使你记住按键的位置。我在开始使用 Colemak 键盘布局时使用了它，它工作得非常好。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T16:30:36.737

我提高速度的最大方法是从不低头看键盘。我还有一个非常符合人体工程学的键盘，它把键盘分成两半，所以我习惯右手使用右侧，左手使用左侧。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T16:32:27.200

我的手不是我的瓶颈，所以触摸打字不会让我更快。我已经没有足够的比特率来最大化我的狩猎和啄食。有些人（我）可能永远无法有效地 TT。

虽然同意肌肉记忆。像 usr/pass 这样的常见问题总是不假思索地很快就被淘汰了，但是对于代码，我的手不是瓶颈

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-18T16:37:20.090

获取 Kinesis Essential 键盘。按键布局更好，可以更快地打字。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-18T17:00:59.863

IRC 对我帮助很大；尤其是玩那些琐事之类的游戏，最快的人得到积分。您也可以在 Linux 上尝试“typespeed”。如果你真的需要更快的速度并且你认为你已经掌握了这项技术，你也可以考虑使用[Dvorak 键盘布局](http://en.wikipedia.org/wiki/Dvorak_Simplified_Keyboard)；它会帮助你快速打字，但你真的需要适应它。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-20T05:32:10.773

我改用德沃夏克，打字速度提高了，8年后我也学会了如何触摸打字。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-29T06:15:47.880

我会加倍建议切换到符合人体工程学的打字位置。此外，我注意到我无法在笔记本电脑上更快地打字。我有一个外部抗 RSI QWERTY 键盘（具有反向 V 型键布局），我可以在笔记本电脑上打字更快，更准确。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-12-14T22:17:41.413

如果您使用带轮廓的键盘，例如[Kinesis Advantage 键盘](https://kinesis-ergo.com/keyboards/advantage2-keyboard/)，盲人打字会更容易，因为如果键盘不平，则更容易感觉到您的手在键盘上的位置。几天后，我的打字速度比普通键盘快得多。还有一个可以切换到 Dvorak 布局的版本，尽管我从来没有尝试过。

关于盲打：根据我的经验，知道您的手在哪里是盲打中重要且困难的事情 - 经过多年的键盘使用，您非常清楚常用键在哪里。因此，只要每隔一段时间集中注意力，让您的手处于盲打的正确位置，并用右手手指敲击键，您将在几个月内进入盲打状态，而无需任何额外的锻炼。

[![Kinesis Advantage 键盘的图像](https://i.stack.imgur.com/qg0qL.jpg)](https://i.stack.imgur.com/qg0qL.jpg)
[（来源：[kinesis-ergo.com](http://www.kinesis-ergo.com/images/500-blk-200x131.jpg)）]

# sql - SQL Server 触发器 - 执行顺序

> ID：94103
> 
> 赞同：33
> 
> 时间：2008-09-18T16:21:21.737
> 
> 标签：sql, sql-server, sql-server-2005, tsql

有谁知道 SQL Server 如何确定执行顺序触发器（相同类型，即在触发器之前）。有什么方法可以改变它，以便我可以指定我想要的顺序。如果没有，为什么不呢。

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-18T16:56:56.050

使用 SetTriggerOrder 很好，但如果您的代码依赖于特定的执行顺序，为什么不将所有触发器包装到存储过程中，让第一个调用第二个，第二个调用第三个，等等。

然后，您只需在触发器中执行第一个。

将来有人会感激他们不必在系统表中挖掘来确定自定义执行顺序。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-18T18:04:05.703

您可以使用[sp_settriggerorder](http://msdn.microsoft.com/en-us/library/ms186762.aspx)定义表上每个触发器的顺序。

但是，我认为最好使用一个触发器来执行多项操作。如果顺序很重要，则*尤其*如此，因为如果您有多个触发器，则该重要性不会很明显。想象一下有人试图在数月/数年内支持数据库。当然，在某些情况下，您可能需要多个触发器，或者它确实是更好的设计，但我会开始假设您应该拥有一个并从那里开始工作。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-18T16:49:10.390

如果您正在担心触发订单，那么您真的应该退后一步，考虑您正在尝试做什么以及是否有更好的方法来做到这一点。这不是一件容易改变的事情，这一事​​实应该告诉你一些事情。

触发器总是看起来像一个非常巧妙的解决方案，并且在正确的地方它们非常有价值，**但**价格很高，而且很容易用它们制造调试噩梦。过去，我在尝试调试一些晦涩的数据库行为时浪费了很多时间，却发现原因被一个被忽视的触发器隐藏了。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-18T16:33:44.903

sp_settriggerorder 仅适用于 AFTER 触发器。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T16:28:29.690

使用`sp_Settriggerorder`存储过程，可以定义触发器的执行顺序。

```
sp_settriggerorder [ @triggername = ] ‘[ triggerschema. ] triggername’
, [ @order = ] ‘value’
, [ @stmttype = ] ’statement_type’
[ , [ @namespace = ] { ‘DATABASE’ | ‘SERVER’ | NULL } ] 
```

第二个参数“order”可以取三个值，这意味着它最多可以考虑三个触发器。

1.  First – 触发器首先被触发
2.  Last - 触发器最后触发
3.  无 - 触发器以随机顺序触发。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-18T16:34:52.327

您可以使用 sp_settriggerorder 保证哪个触发器最先触发、哪个触发器最后触发以及哪些触发器在中间触发。如果您需要同步三个以上，则在 SQL Server 2005 中似乎是不可能的。

这是从[此处](http://decipherinfosys.wordpress.com/2008/02/28/setting-the-execution-order-of-triggers-in-sql-server/)获取的示例（链接的文章有更多信息）。

```
sp_settriggerorder [ @triggername = ] ‘[ triggerschema. ] triggername’
, [ @order = ] ‘value’
, [ @stmttype = ] ’statement_type’
[ , [ @namespace = ] { ‘DATABASE’ | ‘SERVER’ | NULL } ] 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T16:28:20.580

顺序由 sql server 设置，您唯一能做的就是使用系统 sp (sp_settriggerorder) 来设置哪个触发器首先触发，哪个触发器最后触发。

除了将第一个和最后一个触发器设置为触发之外，您无法修改或告诉 sql server 将使用哪个顺序。因此，您将希望构建您的触发器，以便它们不依赖于它们被触发的顺序。即使您确定了他们今天开火的顺序，明天也可能会改变。

此信息基于 Sql Server 2000，但我不认为 2005/2008 在这方面表现不同。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-09-06T12:50:14.087

用这个 ：

例如 ：

```
USE AdventureWorks;
GO
EXEC sys.sp_settriggerorder @triggername = N'', -- nvarchar(517)
    @order = '', -- varchar(10)
    @stmttype = '', -- varchar(50)
    @namespace = '' -- varchar(10) 
```

第一个和最后一个触发器必须是两个不同的触发器。

First ：首先触发触发器。

Last ：触发器最后触发。

无：触发器以未定义的顺序触发。

并查看此链接的价值`@stmttype`：[DDL 事件](http://msdn.microsoft.com/en-us/library/bb522542.aspx)

对于@namespace = { 'DATABASE' | '服务器' | NULL }，更多信息请参见：[DDL 触发器](http://msdn.microsoft.com/en-us/library/ms175941.aspx)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-06T23:31:21.177

在这种情况下一百万美元的声明-

> sp_settriggerorder：指定最先或最后触发的 AFTER 触发器。在第一个和最后一个触发器之间触发的 AFTER 触发器以未定义的顺序执行。

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/ms186762.aspx)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T16:28:44.027

使用此系统存储过程：

```
sp_settriggerorder[@triggername = ] 'triggername', [@order = ] 'value', [@stmttype = ] 'statement_type' 
```

# java - 在 Java 中存根复杂接口的最简单方法是什么？

> ID：94112
> 
> 赞同：4
> 
> 时间：2008-09-18T16:22:12.687
> 
> 标签：java, testing

我的代码将接口作为输入，但只执行几个接口的方法（通常，只是 getter）。

在测试代​​码时，我很想定义一个返回测试数据的匿名内部类。但是对于接口需要的所有其他方法，我该怎么办？

我可以使用我的 IDE 为接口自动生成存根，但这似乎相当繁重。

存根我关心的两种方法和我不关心的方法的最简单方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T16:23:22.387

如果您使用 JUnit 进行测试，请使用 Mocks 而不是存根。

阅读 Martin Fowler 的开创性文章“ [Mocks Aren't Stubs](http://martinfowler.com/articles/mocksArentStubs.html) ”

我推荐[EasyMock](http://www.easymock.org/)框架，它就像一个魅力，使用反射自动模拟你的界面。它比 Fowler 文章中的代码示例高级一点，尤其是当您使用[unitils](http://www.unitils.org/summary.html)库包装 EasyMock 时，因此语法会比文章中的简单得多。另外，如果你没有接口，但你想模拟一个具体的类，EasyMock 有一个类扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T16:25:04.380

看看 JMock。

[http://www.jmock.org/](http://www.jmock.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T16:28:34.807

编写一个“适配器类”并仅覆盖您关心的方法。

```
class MyAdapter extends MyClass {
  public void A() {
  }
  ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:30:18.610

我相信经典的方法是用空方法创建一个抽象类。至少，Sun 是这样为 MouseListener 做的，创建[MouseAdapter](http://java.sun.com/javase/6/docs/api/ "鼠标适配器")来简化这些事件的使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:32:08.247

EasyMock 或 JMock 绝对是赢家。我没有使用过 JMock，但我知道使用 EasyMock 您可以根据测试脚本设置 Mock 对象，它会在测试期间的某些情况或点中返回某些值。它很容易学习和运行，通常不到一个小时。

# css - 什么可能导致 CSS 在所有浏览器上偶尔加载失败？

> ID：94123
> 
> 赞同：7
> 
> 时间：2008-09-18T16:23:47.910
> 
> 标签：css, tomcat

我正在开发一个 web 应用程序，我们经常会遇到在不应用 CSS 的情况下加载页面的情况。此问题已在 IE6、IE7、Safari 3 和 FF3 中出现。

页面刷新将始终解决问题。

加载了 3 个 CSS 文件，都使用 @import 在同一个样式块中：

```
<STYLE type="text/css">
  @import url([base css file]);
  @import url([skin css file]);
  @import url([generated css path]);
</STYLE> 
```

在任何情况下，当我们花时间检查 html 源代码时，没有什么不寻常的。访问日志看起来也很正常——每当请求静态 CSS 文件时，我们都会收到 HTTP 304 响应，而我们生成的 CSS 会收到 HTTP 200 响应。

对于 css 文件和生成的 css，mimetype 是 text/css。我们正在使用 iPlanet 服务器，它将请求转发到 Tomcat 服务器。

davebug 问：

> 总是没有加载相同的css文件，还是所有问题都均匀？

没有任何 CSS 文件加载。HTML 中定义的任何样式都可以正常工作，但发生这种情况时，任何 CSS 文件中的任何样式都不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T23:58:26.117

我发生了类似的事情，我可以通过首先使用“link rel”方法而不是“@import”来包含基本样式表来修复。即将您的 [base css 文件] 包含移动到：

```
<link rel="stylesheet" href="[base css file]" type="text/css" media="screen" /> 
```

并将其放在其他人之前。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T16:40:00.257

如果它经常发生以至于您能够在浏览器中看到它，请尝试安装 Live http headers Firefox 扩展或 Tamper Data 扩展，并观察浏览器看到的响应标头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-08T23:20:48.870

我不知道为什么，但在我的情况下，如果页面是从路径类似的操作加载的`/ActionName`，我会看到这个问题。

但是，如果我将它（例如）更改为`/reservedArea/ActionName`或者`/aPath/ActionName`它可以工作：/

这很疯狂...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T17:39:25.463

检查标头是个好主意，但我想您将从它们中学到的只是服务器不会每隔一段时间就响应请求。

我经常在网上看到这种情况。在您刷新之前，图像不会加载，css 被搞砸了，等等。所有的情况都可以通过刷新来解决。

我想你可以“解决”这个问题的一种方法，也许是通过在你的cs文件中为某些元素的图像指定一个url。然后，在 javascript 中加载页面时，获取该元素并查看该图像是否已加载。如果没有，则让页面自行重新加载。

看起来很异国情调，但这是我唯一的想法......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-18T16:29:01.517

使用 ab 或 httperf 或 curl 或其他东西从网络服务器重复加载 CSS 文件。也许它并没有始终如一地为页面提供服务。

# javascript - JavaScript 的 document.write 内联脚本执行顺序

> ID：94141
> 
> 赞同：36
> 
> 时间：2008-09-18T16:25:52.507
> 
> 标签：javascript, cross-browser, browser

我有以下脚本，其中第一个和第三个`document.writeline`是静态**的，第二个是生成的**：

```
<script language="javascript" type="text/javascript">
document.write("<script language='javascript' type='text/javascript' src='before.js'><\/sc" + "ript>");
document.write("<script language='javascript' type='text/javascript'>alert('during');<\/sc" + "ript>");
document.write("<script language='javascript' type='text/javascript' src='after.js'><\/sc" + "ript>");
</script> 
```

Firefox 和 Chrome 会*在之前*、*期间*和*之后*显示，而 Internet Explorer 先*在期间*显示，然后*才在之前*和*之后*显示。

我看到[一篇文章说](http://www.elctech.com/blog/nesting-document-write)我不是第一个遇到这种情况的人，但这几乎没有让我感觉好转。

**有谁知道我如何将顺序设置为在所有浏览器中具有确定性，或者破解 IE 使其像所有其他理智的浏览器一样工作？**

**警告**：代码片段是一个非常简单的重现。它是在服务器上生成的，第二个脚本是唯一改变的东西。这是一个很长的脚本，并且在它之前和之后有两个脚本的原因是浏览器将缓存它们并且代码的动态部分将尽可能小。它也可能以不同的生成代码出现在同一页面中多次。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-18T17:35:19.390

不，这是 Internet Explorer 的行为。

如果您动态附加脚本，IE、Firefox 和 Chrome 都会以异步方式下载脚本。

Firefox 和 Chrome 将等待所有异步请求返回，然后将按照它们在 DOM 中的附加顺序执行脚本，但 IE 按照它们通过网络返回的顺序执行脚本。

由于与外部 javascript 文件相比，警报“检索”所需的时间更少，这可能解释了您所看到的行为。

来自 Kristoffer Henriksson[关于异步脚本加载主题的帖子](http://blogs.msdn.com/kristoffer/archive/2006/12/22/loading-javascript-files-in-parallel.aspx)：

> 在这种情况下，IE 和 Firefox 将下载这两个脚本，但 Internet Explorer 也会按照它们完成下载的顺序执行它们，而 Firefox 会异步下载它们，但仍然按照它们在 DOM 中的附加顺序执行它们。
> 
> 在 Internet Explorer 中，这意味着您的脚本不能相互依赖，因为执行顺序会因网络流量、缓存等而异。

考虑使用 Javascript 加载器。它可以让您指定脚本依赖项和执行顺序，同时还可以异步加载脚本以提高速度并消除一些浏览器差异。

这是对其中一些的很好的概述：[Essential JavaScript：前五个脚本加载](http://www.netmagazine.com/features/essential-javascript-top-five-script-loaders)器。

我使用过 RequireJS 和 LabJS。在我看来，LabJS 不那么固执己见。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T10:04:13.433

我找到了一个更喜欢我的答案：

```
<script language="javascript" type="text/javascript">
document.write("<script language='javascript' type='text/javascript' src='before.js'><\/sc" + "ript>");
document.write("<script defer language='javascript' type='text/javascript'>alert('during');<\/sc" + "ript>");
document.write("<script defer language='javascript' type='text/javascript' src='after.js'><\/sc" + "ript>");
</script> 
```

这将延迟加载*期间*和*之后*的加载，直到页面完成加载。

我认为这是我能得到的最好的。希望有人能够给出更好的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:44:35.767

[本演示文稿](http://sites.google.com/site/io/even-faster-web-sites)的幻灯片 25/26讨论了插入脚本的不同方法的特征。它表明 IE 是唯一会按顺序执行这些脚本的浏览器。所有其他浏览器将按照它们完成加载的顺序执行它们。如果一个或多个有内联 js 而不是 src，即使 IE 也不会按顺序执行它们。

建议的方法之一是插入一个新的 DOM 元素：

```
var se1 = document.createElement('script');
se1.src = 'a.js';

var se2 = document.createElement('script');
se2.src = 'b.js';

var se3 = document.createElement('script');
se3.src = 'c.js';

var head = document.getElementsByTagName('head')[0]
head.appendChild(se1);
head.appendChild(se2);
head.appendChild(se3); 
```

要生成第二个脚本部分，您可以使用脚本来生成该内容并传递参数：

```
se2.src = 'generateScript.php?params=' + someParam; 
```

编辑：尽管我找到的文章说了什么，但我的测试表明大多数浏览器都会按顺序执行你的 document.write 脚本，如果它们每个都有一个 src，所以虽然我认为上面的方法是首选，你也可以这样做：

```
<script language="javascript" type="text/javascript">
document.write("<script type='text/javascript' src='before.js'><\/sc" + "ript>");
document.write("<script type='text/javascript' src='during.php?params=" + params + "'><\/sc" + "ript>");
document.write("<script type='text/javascript' src='after.js'><\/sc" + "ript>");
</script> 
```

再次编辑（回复对我自己和其他人的评论）：您已经在页面上生成脚本。无论您在做什么，都可以移动到另一个生成相同代码块的服务器端脚本。如果您需要页面上的参数，则将它们传递给查询字符串中的脚本。

此外，如果您按照您的建议多次生成内联脚本，则可以使用相同的方法：

```
<script language="javascript" type="text/javascript">
document.write("<script type='text/javascript' src='before.js'><\/sc" + "ript>");
document.write("<script type='text/javascript' src='during.php?params=" + params1 + "'><\/sc" + "ript>");
document.write("<script type='text/javascript' src='during.php?params=" + params2 + "'><\/sc" + "ript>");
document.write("<script type='text/javascript' src='during.php?params=" + params3 + "'><\/sc" + "ript>");
document.write("<script type='text/javascript' src='after.js'><\/sc" + "ript>");
</script> 
```

但是，这开始看起来好像您以错误的方式接近它。如果您多次生成一大块代码，那么您可能应该用单个 js 函数替换它并用不同的参数调用它......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T17:05:08.527

好吧……期间……

```
// During.js
during[fish](); 
```

后...

```
// After.js
alert("After");
fish++ 
```

HTML

```
<!-- some html -->
<script language="javascript" type="text/javascript">
document.write("<script language='javascript' type='text/javascript' src='before.js'></sc" + "ript>");
document.write("<script language='javascript' type='text/javascript'>during[" + fish + "] = function(){alert('During!' + fish);}</sc" + "ript>");
document.write("<script language='javascript' type='text/javascript' src='during.js'></sc" + "ript>");
document.write("<script language='javascript' type='text/javascript' src='after.js'></sc" + "ript>");
</script>
<!-- some other html -->
<script language="javascript" type="text/javascript">
document.write("<script language='javascript' type='text/javascript' src='before.js'></sc" + "ript>");
document.write("<script language='javascript' type='text/javascript'>during[" + fish + "] = function(){alert('During!' + fish);}</sc" + "ript>");
document.write("<script language='javascript' type='text/javascript' src='during.js'></sc" + "ript>");
document.write("<script language='javascript' type='text/javascript' src='after.js'></sc" + "ript>");
</script> 
```

不过，我倾向于同意这种气味开始的方式。特别是，您为什么不能将“期间”代码生成到动态创建的 js 文件中，然后插入呢？

请注意，动态生成的脚本位于**第二个**document.write的函数**内部。** 在FF2、IE7中测试

 *** * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T11:03:49.713

您可以通过在脚本上定义“onload”（或类似）事件并在事件函数中注入下一个事件来强制执行。这不是微不足道的，但是那里有很多例子，这里有一个。

[http://www.phpied.com/javascript-include-ready-onload/](http://www.phpied.com/javascript-include-ready-onload/)

我认为像 jQuery 或原型这样的流行库可以帮助解决这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T09:06:14.147

提供的代码：

```
<script language="javascript" type="text/javascript">
document.write("<script language='javascript' type='text/javascript'>function callGeneratedContent() { alert('during'); }<\x2Fscript>");
document.write("<script language='javascript' type='text/javascript' src='before.js'><\x2Fscript>");
document.write("<script language='javascript' type='text/javascript' src='after.js'><\x2Fscript>");
</script> 
```

在 before.js 中：

```
alert("Before");
callGeneratedContent(); 
```

在 after.js 中：

```
alert("After"); 
```

你必须把生成的行放在前面，否则FF会报错，因为它在看到函数定义之前执行了before.js。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T20:23:38.943

那个怎么样：

```
<script>
document.write("<script src='before.js'><\/script>");
</script>

<script >
document.write("<script>alert('during');<\/script>");
</script>

<script>
document.write("<script src='after.js'><\/script>");
</script> 
```

# agile - How do I break down barriers between development and QA on an agile project?

> ID：94145
> 
> 赞同：6
> 
> 时间：2008-09-18T16:26:37.013
> 
> 标签：agile, qa, user-stories

I've been applying [agile](https://rads.stackoverflow.com/amzn/click/com/0321205685) for a few months now on my project. However we are seeing a steady problem with our iteration burndowns. We aren't hitting zero each iteration.

The tasks remaining are QA tasks. Things like writing tests, testing, etc.

Now, there is some organizational resistance to the "cross-functional team" idea of agile. Dev's develop for single projects but Testers are shared for multiple projects. Which is quite contrary to the agile idea of Dev's and QA working together.

The fact that my tester's time is split across so many other projects is the cause of our slowdowns. The developers are testing to pick up as much slack as they can, but some tasks are still not getting done.

From what I see, I can do two things:

1.  Persuade the organization to move towards "each project having a dedicated QA person"
2.  Change my definition of "Done" to not include QA/Testing work. Things would still be unit tested though.

I'd much rather avoid doing #2, since I value the testing collaboration we're doing.

What advice do you have for my predicament?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T16:31:44.830

I don't think you can call what you're doing agile unless everybody is in on it. Get the tester to sit physically close to the devs (at least for the time the tester is working on tasks for their project such as creating the test plans), this may up the communication and get the QAs to buy into it.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T16:32:57.030

It's a tough situation and unfortunately quite a lot of companies who try to follow Agile do not recognise it. You do not have to have a dedicated QA person - even with Agile resources could be split between different tasks. You DO need to include your QA in your progress tracking.

Yes, your progress will be slower. There is a good reason for that (you don't have enough QA resources) and you should explain it to your organisation management with figures in hand. It will help you to persuade them that some change has to happen.

Also you could move towards more automated testing and use your developers to help the testers with the test automation. This will distribute the load more evenly and will improve the quality of QA on your project

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T16:40:45.777

For this to work you must get the QAs to dedicate adequate time to the project. You may need to work with their management in order to get certain swaths of time set aside for them to work on your project. This way you would be able to schedule their time and know exactly how much work your developers can do that the QA team will have time to test. This may require you scaling back on development in order to compensate for the reduced support from QA.

You don't mention how much of your testing is automated. You may be able to increase the testing automation in order to reduce the time the QA team needs to certify the project. You could use part of your development time to prepare the QA tests for the QA team to run. Not optimal, but it could help.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T15:57:10.873

I think QA has lot more to offer in Agile environment than just the testing work. If QA is knowledgeable enough about the workflow and different branches of it, one can be in drivers seat to drive the rest of the scrum process. QA can be envolved with developers to design the logical workflows which will ultimately drive the test cases. This way one can eliminate lot of design and workflow related errors during the development process before they get into QA environment.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:34:00.223

You could consider QA as the customers for the Devs. So when Devs release at the end of an iteration to QA, the iteration is done.

Feedback from the customer (bugs that need fixing) can go into the work to be done for the next iteration.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-19T01:43:20.653

In the short term, stop using the QA resources that can't fit into your process and take on these tasks with those that can be dedicated as needed. I realize that this isn't ideal, but there's a sub-optimal situation where you have an organizational structure that doesn't match your processes. You may just find that it will work out fine (and learn about testing in the process).

In the long term, your options are

*   find a way for this to work with the given organizational structure/process
*   change the organizational structure be suitable to the process
*   chagne the development process to be suitable to the organization

# java - 事件日志解析器的适当设计模式？

> ID：94148
> 
> 赞同：7
> 
> 时间：2008-09-18T16:26:51.940
> 
> 标签：java, logging

处理一个解析事件日志的项目，然后根据这些事件的属性更新模型。我对“完成它”非常懒惰，更关心前期优化、精简代码和正确的设计模式。主要是自学实验。我感兴趣的是更有经验的设计师认为哪些模式是相关的，或者哪种类型的伪代码对象架构是最好的、最容易维护的等等。

单个日志中可以有 500,000 个事件，大约有 60 种类型的事件，所有这些都共享大约 7 个基本属性，然后根据事件类型有 0 到 15 个附加属性。事件类型是日志文件中每一行的第二个属性。

因此，我尝试了一个非常丑陋的命令式解析器，它逐行遍历日志，然后逐行处理事件。然后我尝试了一个使用“nextEvent”模式的词法规范，该模式在循环中被调用并被处理。然后我尝试了一个简单的旧“解析”方法，它永远不会返回，只是将事件触发到注册的侦听器回调。无论事件类型如何，我都尝试了单个回调，以及特定于每种事件类型的回调方法。

我尝试了一个包含所有可能属性的基本“事件”类。我试图避免“新事件”调用（因为可能有大量事件并且事件对象通常是短暂的）并且每个类型都有带有原始属性参数的回调方法。我已经尝试为 60 种事件类型中的每一种创建一个子类，并使用一个具有 7 个公共基本属性的抽象事件父类。

我最近尝试更进一步，并使用命令模式为每种事件类型放置事件处理代码。我不确定我是否喜欢这种方法，它与每种类型的回调方法非常相似，只是代码位于类型子类中的执行函数内，而不是每种类型的回调方法。

问题是很多模型更新逻辑是共享的，其中很多是特定于子类的，我刚刚开始对整个事情感到困惑。我希望有人至少可以指出我考虑的方向！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T16:34:19.070

嗯......对于一件事，而不是具有所有属性的联合的单个事件类，或 61 个事件类（1 个基数，60 个子类），在有这么多变化的场景中，我很想拥有一个使用属性包（字典、哈希表、w/e 漂浮您的船）来存储事件信息的事件类。事件的类型只是放入包中的另一个属性值。我倾向于这种方式的主要原因只是因为我不愿意维护任何东西的 60 个派生类。

最大的问题是......在处理事件时，您与事件有什么*关系*。您是否将它们格式化成报告，将它们组织成数据库表，如果发生某些事件时唤醒人们......什么？

这是一个事后分析器，还是一个实时事件处理程序？我的意思是，您是在事件进入时监控日志，还是只在第二天解析日志文件？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T16:34:13.203

考虑一个策略对象的享元工厂，每个“类”事件一个。

对于每一行事件数据，从享元工厂中查找合适的解析策略，然后将事件数据传递给策略进行解析。60 个策略对象中的每一个都可以属于同一类，但配置有不同的字段解析对象组合。如果没有更多细节，要更具体有点困难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:34:10.100

可能是[散列适配器对象](http://www.mindspring.com/~mgrand/pattern_synopses2.htm#Hashed%20Adapter%20Objects)（如果你能在网上找到一个很好的解释——它们似乎缺乏。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T21:29:41.090

就在顶部：

我喜欢接受的答案中关于只有一个具有属性映射的类的建议。我也认为行为也可以这样组装：

```
class Event
{
    // maps property name to property value
    private Map<String, String> properties;

    // maps property name to model updater
    private Map<String, ModelUpdater> updaters; 

    public void update(Model modelToUpdate)
    {
        foreach(String key in this.properties.keys)
        {
            ModelUpdater updater = this.updaters[key];
            String propertyValue = this.properties[key];

            updaters.updateModelUsingValue(model, propertyValue);
        }
    }

} 
```

未显示 ModelUpdater 类。它根据属性更新您的模型。我组成了循环；这可能是也可能不是您的算法实际上是什么。我可能会让 ModelUpdater 更像一个界面。每个实施者将是每个属性，并会更新模型。

那么我的“主循环”将是：

```
Model someModel;

foreach(line in logFile)
{
    Event e = EventFactory.createFrom(line);
    e.update(someModel);
} 
```

EventFactory 从文件构造事件。它根据事件的属性填充两个地图。这意味着有某种方法可以将属性与其关联的模型更新程序相匹配。

我没有任何花哨的模式名称给你。如果您有一些复杂的规则，例如事件是否具有属性 A、B 和 C，则忽略 B 的模型更新程序，那么必须以某种方式扩展此方法。最有可能的是，您可能需要使用规则对象模式以某种方式将一些规则注入 EventFactory。给你，有一个模式名称给你！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T19:56:37.147

我不确定我是否正确理解了这个问题。我假设有一个复杂的“模型更新逻辑”。不要将其分配到 60 个类中，将其保存在一个地方，将其从事件类中移出（类似于中介者模式）。

您的 Mediator 将使用事件类（我不知道您如何在这里使用享元），事件可以自己解析。

如果更新规则非常复杂，您无法使用通用编程语言真正解决问题。考虑使用基于规则的引擎或类似的东西。

# python - 如何使用 Python 将临时文件持久保存到磁盘？

> ID：94153
> 
> 赞同：27
> 
> 时间：2008-09-18T16:27:26.900
> 
> 标签：python, temporary-files

我正在尝试使用“tempfile”模块来操作和创建文本文件。文件准备好后，我想将其保存到磁盘。我认为这就像使用'shutil.copy'一样简单。但是，我得到一个“权限被拒绝”的 IOError：

```
>>> import tempfile, shutil
>>> f = tempfile.TemporaryFile(mode ='w+t')
>>> f.write('foo')
>>> shutil.copy(f.name, 'bar.txt')

Traceback (most recent call last):
  File "<pyshell#5>", line 1, in <module>
    shutil.copy(f.name, 'bar.txt')
  File "C:\Python25\lib\shutil.py", line 80, in copy
    copyfile(src, dst)
  File "C:\Python25\lib\shutil.py", line 46, in copyfile
    fsrc = open(src, 'rb')
IOError: [Errno 13] Permission denied: 'c:\\docume~1\\me\\locals~1\\temp\\tmpvqq3go'
>>> 
```

这不是在使用“tempfile”库时打算的吗？有一个更好的方法吗？（也许我忽略了一些非常琐碎的事情）

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-02-06T04:19:42.517

hop 是对的，并且 dF。错误发生的原因不正确。

由于您尚未调用`f.close()`，因此该文件**不会**被删除。

的[文档](http://docs.python.org/library/tempfile.html#tempfile.NamedTemporaryFile)`NamedTemporaryFile`说：

> 在命名的临时文件仍处于打开状态时，是否可以使用该名称再次打开文件，因平台而异（在 Unix 上可以这样使用；在 Windows NT 或更高版本上不能）。

对于`TemporaryFile`：

> 在 Unix 下，文件的目录条目在文件创建后立即被删除。其他平台不支持；您的代码不应依赖于使用此函数创建的临时文件，该文件在文件系统中具有或不具有可见名称。

因此，要保留一个临时文件（在 Windows 上），您可以执行以下操作：

```
import tempfile, shutil
f = tempfile.NamedTemporaryFile(mode='w+t', delete=False)
f.write('foo')
file_name = f.name
f.close()
shutil.copy(file_name, 'bar.txt')
os.remove(file_name) 
```

Hans Sjunnesson 提供的解决方案也是关闭的，因为`copyfileobj`仅从类文件对象复制到类文件对象，而不是文件名：

> shutil.copyfileobj(fsrc, fdst[, 长度])
> 
> > 将类文件对象 fsrc 的内容复制到类文件对象 fdst。整数长度（如果给定）是缓冲区大小。特别是，负长度值意味着复制数据而不以块的形式循环源数据；默认情况下，数据以块的形式读取，以避免不受控制的内存消耗。注意，如果 fsrc 对象的当前文件位置不为 0，则只会复制从当前文件位置到文件末尾的内容。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-18T16:45:37.793

您创建的文件`TemporaryFile`或`NamedTemporaryFile`在关闭时自动删除，这就是您收到错误的原因。如果您不想要这个，您可以`mkstemp`改用（请参阅[tempfile](https://docs.python.org/3/library/tempfile.html#tempfile.mkstemp)的文档）。

```
>>> import tempfile, shutil, os
>>> fd, path = tempfile.mkstemp()
>>> os.write(fd, 'foo')
>>> os.close(fd)
>>> shutil.copy(path, 'bar.txt')
>>> os.remove(path) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-20T22:15:33.667

从 python 2.6 开始，您还可以使用设置为 False`NamedTemporaryFile`的选项。`delete=`这样，即使您关闭临时文件，也可以访问它。

请注意，在 Windows（NT 和更高版本）上，当文件仍处于打开状态时，您无法再次访问该文件。您必须先关闭它，然后才能复制它。这在 Unix 系统上是不正确的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-18T16:33:46.620

在您的示例中，您始终可以使用*shutil.copyfileobj*：

```
new_file = open('bar.txt', 'rw')
shutil.copyfileobj(f, new_file) 
```

# sharepoint - MOSS 2007 中快速启动菜单的显示行为不一致

> ID：94154
> 
> 赞同：1
> 
> 时间：2008-09-18T16:27:30.380
> 
> 标签：sharepoint, moss

我正在尝试将快速启动菜单配置为仅显示当前选择节点的祖先和后代节点。菜单还需要显示根节点的所有子节点。更简单地说：

给定一个站点地图：

**根站点**

--- **SubSite1** = 导航设置在“显示当前站点、当前站点下方的导航项以及当前站点的同级”

----- **Heading1** = 导航设置为“显示与父站点相同的导航项”

------- **Page1** = 导航设置为“显示与父站点相同的导航项”

------- **Page2** = 导航设置为“显示与父站点相同的导航项”

----- **Heading2** = 导航设置在“显示与父站点相同的导航项”

--- **SubSite2** = 导航设置在“显示当前站点、当前站点下方的导航项以及当前站点的同级”

----- **Heading1** = 导航设置为“显示与父站点相同的导航项”

SiteMapProvider 配置：

```
<PublishingNavigation:PortalSiteMapDataSource ID="SiteMapDS" Runat="server"
SiteMapProvider="CurrentNavSiteMapProvider" EnableViewState="true"
StartFromCurrentNode="true" ShowStartingNode="false"/> 
```

SubSite1 上显示的快速启动菜单的预期和实际行为是：

---子站点1

-----标题1

--------第1页

- - - -第2页

-----标题2

---子站点2

导航到 SubSite2 的 Heading1 后菜单的预期行为：

---子站点1

---子站点2

-----标题1

导航到 SubSite2 的 Heading1 后我实际看到的内容：

---子站点1

-----标题1

--------第1页

- - - -第2页

-----标题2

---子站点2

-----标题1

如果我将 Heading1 导航设置为“显示与父站点相同的导航项”并且 SubSite2 设置为“显示当前站点、当前站点下方的导航项以及当前站点的兄弟姐妹”。我希望 Heading1 继承 SubSite2 的导航项，其中 SubSite1 项从视图中折叠。我也玩过各种 Trim... 属性但没有成功。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T19:47:08.093

我按照@Nat 的指导进入了阴暗的世界 Sharepoint webparts，以实现我上面描述的行为。我的方法是推出我自己的[MossMenu webpart](http://blogs.msdn.com/ecm/archive/2006/12/02/customizing-the-wss-3-0-moss-2007-menu-control-mossmenu-source-code-released.aspx "MossMenu Web 部件")版本，微软通过 ECM 团队博客发布了该版本。此代码基于本机 AspMenu 控件。我使用此控件“拦截”通过标记中的 DataSourceId 属性注入的本机 SiteMapDataSource，并创建一个新的 XML 数据源以展示所需的行为。我在这个冗长的答案的末尾包含了最终的源代码。以下是母版页标记中的位：

```
<%@ Register TagPrefix="myCustom" Namespace="YourCompany.CustomWebParts"
   Assembly="YourCompany.CustomWebParts, Version=1.0.0.0, Culture=neutral,
   PublicKeyToken=9f4da00116c38ec5" %>

...

<myCustom:MossMenu ID="CurrentNav" runat="server" datasourceID="SiteMapDS"
    orientation="Vertical" UseCompactMenus="true" StaticDisplayLevels="6"
    MaximumDynamicDisplayLevels="0" StaticSubMenuIndent="5" ItemWrap="false"
    AccessKey="3" CssClass="leftNav"
    SkipLinkText="<%$Resources:cms,masterpages_skiplinktext%>">
    <LevelMenuItemStyles>
        <asp:MenuItemStyle CssClass="Nav" />
        <asp:MenuItemStyle CssClass="SecNav" />
    </LevelMenuItemStyles>
    <StaticHoverStyle CssClass="leftNavHover"/>
    <StaticSelectedStyle CssClass="leftNavSelected"/>
    <DynamicMenuStyle CssClass="leftNavFlyOuts" />
    <DynamicMenuItemStyle CssClass="leftNavFlyOutsItem"/>
    <DynamicHoverStyle CssClass="leftNavFlyOutsHover"/>
</myCustom:MossMenu>

<PublishingNavigation:PortalSiteMapDataSource ID="SiteMapDS" Runat="server"
     SiteMapProvider="CurrentNavSiteMapProvider" EnableViewState="true"
     StartFromCurrentNode="true" ShowStartingNode="false"/>

... 
```

我按照出色的分步说明在[MossMenu](http://blogs.msdn.com/ecm/archive/2006/12/02/customizing-the-wss-3-0-moss-2007-menu-control-mossmenu-source-code-released.aspx "MossMenu Web 部件") Web 部件的评论部分创建了我的自定义 Web 部件，位于“2007 年 9 月 19 日，星期三，Roel 上午 7:20”。在我的谷歌搜索中，我还发现了一些可以配置 Sharepoint 站点以显示异常的方法，就像 ASP.NET 通过在[此处](http://blog.thekid.me.uk/archive/2007/02/15/a-solution-to-quot-an-unexpected-error-has-occurred-quot-in-wss-v3.aspx)更改 web.config 所做的那样。

我决定将我的自定义行为称为“紧凑菜单”，因此我在控件上创建了一个 UseCompactMenus 属性。如果您没有在标记中将此属性设置为 true，则该控件的行为将与 AspMenu 控件相同。

我的应用程序让用户始终从站点地图根目录的主页开始。当显示根页面时，我可以让自定义控件存储初始（完整）站点地图。这存储在一个静态字符串中，用于自定义行为。如果您的应用程序不遵循此假设，则控件将无法按预期工作。

在初始应用程序页面上，菜单中仅显示到根页面的直接子页面。单击这些菜单节点将打开其下的所有子节点，但保持兄弟节点“关闭”。如果单击其他同级节点之一，它将折叠当前节点并打开新选择的节点。就是这样，享受！！

```
using System;
using System.Text;
using System.ComponentModel;
using System.Collections.Generic;
using System.Security.Permissions;
using System.Xml;
using System.Xml.Serialization;

using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.Design.WebControls;

using Microsoft.SharePoint;
using Microsoft.SharePoint.Utilities;
using Microsoft.SharePoint.Security;

namespace YourCompany.CustomWebParts
{
    [AspNetHostingPermission(SecurityAction.LinkDemand, Level = AspNetHostingPermissionLevel.Minimal)]
    [AspNetHostingPermission(SecurityAction.InheritanceDemand, Level = AspNetHostingPermissionLevel.Minimal)]
    [SharePointPermission(SecurityAction.LinkDemand, ObjectModel = true)]
    [SharePointPermission(SecurityAction.InheritanceDemand, ObjectModel = true)]
    [Designer(typeof(MossMenuDesigner))]
    [ToolboxData("<{0}:MossMenu runat=\"server\" />")]
    public class MossMenu : System.Web.UI.WebControls.Menu
    {
        private string idPrefix;

        // a url->menuItem dictionary
        private Dictionary<string, System.Web.UI.WebControls.MenuItem> menuItemDictionary =
            new Dictionary<string, System.Web.UI.WebControls.MenuItem>(StringComparer.OrdinalIgnoreCase);

        private bool customSelectionEnabled = true;
        private bool selectStaticItemsOnly = true;

        private bool performTargetBinding = true;

        //** Variables used for compact menu behavior **//
        private bool useCompactMenus = false;
        private static bool showStartingNode;
        private static string originalSiteMap;

        /// <summary>
        /// Controls whether or not the control performs compacting of the site map to display only ancestor and child nodes of the selected and first level root childern.
        /// </summary>
        [Category("Behavior")]
        public bool UseCompactMenus
        {
            get
            {
                return this.useCompactMenus;
            }
            set
            {
                this.useCompactMenus = value;
            }
        }

        /// <summary>
        /// Controls whether or not the control performs custom selection/highlighting.
        /// </summary>
        [Category("Behavior")]
        public bool CustomSelectionEnabled
        {
            get
            {
                return this.customSelectionEnabled;
            }
            set
            {
                this.customSelectionEnabled = value;
            }
        }

        /// <summary>
        /// Controls whether only static items may be selected or if
        /// dynamic (fly-out) items may be selected too.
        /// </summary>
        [Category("Behavior")]
        public bool SelectStaticItemsOnly
        {
            get
            {
                return this.selectStaticItemsOnly;
            }
            set
            {
                this.selectStaticItemsOnly = value;
            }
        }

        /// <summary>
        /// Controls whether or not to bind the Target property of any menu
        /// items to the Target property in the SiteMapNode's Attributes
        /// collection.
        /// </summary>
        [Category("Behavior")]
        public bool PerformTargetBinding
        {
            get
            {
                return this.performTargetBinding;
            }
            set
            {
                this.performTargetBinding = value;
            }
        }

        /// <summary>
        /// Gets the ClientID of this control. 
        /// </summary>
        public override string ClientID
        {
            [SharePointPermission(SecurityAction.Demand, ObjectModel = true)]
            get
            {
                if (this.idPrefix == null)
                {
                    this.idPrefix = SPUtility.GetNewIdPrefix(this.Context);
                }

                return SPUtility.GetShortId(this.idPrefix, this);
            }
        }

        [SharePointPermission(SecurityAction.Demand, ObjectModel = true)]
        protected override void OnMenuItemDataBound(MenuEventArgs e)
        {
            base.OnMenuItemDataBound(e);

            if (this.customSelectionEnabled)
            {
                // store in the url->item dictionary
                this.menuItemDictionary[e.Item.NavigateUrl] = e.Item;
            }

            if (this.performTargetBinding)
            {
                // try to bind to the Target property if the data item is a SiteMapNode
                SiteMapNode smn = e.Item.DataItem as SiteMapNode;
                if (smn != null)
                {
                    string target = smn["Target"];
                    if (!string.IsNullOrEmpty(target))
                    {
                        e.Item.Target = target;
                    }
                }
            }
        }

        /// <id guid="08e034e7-5872-4a31-a771-84cac1dcd53d" />
        /// <owner alias="MarkWal">
        /// </owner>
        [SharePointPermission(SecurityAction.Demand, ObjectModel = true)]
        protected override void OnPreRender(System.EventArgs e)
        {

            SiteMapDataSource dataSource = this.GetDataSource() as SiteMapDataSource;
            SiteMapProvider provider = (dataSource != null) ? dataSource.Provider : null;

            if (useCompactMenus && dataSource != null && provider != null)
            {
                showStartingNode = dataSource.ShowStartingNode;

                SiteMapNodeCollection rootChildNodes = provider.RootNode.ChildNodes;

                if (provider.CurrentNode.Equals(provider.RootNode))
                {
                    //** Store original site map for future use in compacting menus **//
                    if (originalSiteMap == null)
                    {
                        //Store original SiteMapXML for future adjustments:
                        XmlDocument newSiteMapDoc = new XmlDocument();
                        newSiteMapDoc.LoadXml("<?xml version='1.0' ?>"
                            + "<siteMapNode title='" + provider.RootNode.Title
                            + "' url='" + provider.RootNode.Url
                            + "' />");

                        foreach (SiteMapNode node in rootChildNodes)
                        {
                            XmlNode newNode = GetXmlSiteMapNode(newSiteMapDoc.DocumentElement, node);

                            newSiteMapDoc.DocumentElement.AppendChild(newNode);

                            //Create XML for all the child nodes for selected menu item:
                            NavigateSiteMap(newNode, node);
                        }

                        originalSiteMap = newSiteMapDoc.OuterXml;
                    }

                    //This is set to only display the child nodes of the root node on first view:
                    this.StaticDisplayLevels = 1;
                }
                else
                {
                    //
                    //Adjust site map for this page
                    //
                    XmlDocument newSiteMapDoc = InitializeNewSiteMapXml(provider, rootChildNodes);

                    //Clear the current default site map:
                    this.DataSourceID = null;

                    //Create the new site map data source
                    XmlDataSource newSiteMap = new XmlDataSource();
                    newSiteMap.ID = "XmlDataSource1";
                    newSiteMap.EnableCaching = false; //Required to prevent redisplay of the previous menu

                    //Add bindings for dynamic site map:
                    MenuItemBindingCollection bindings = this.DataBindings;
                    bindings.Clear();

                    MenuItemBinding binding = new MenuItemBinding();
                    binding.DataMember = "siteMapNode";
                    binding.TextField = "title";
                    binding.Text = "title";
                    binding.NavigateUrlField = "url";
                    binding.NavigateUrl = "url";
                    binding.ValueField = "url";
                    binding.Value = "url";

                    bindings.Add(binding);

                    //Bind menu to new site map:
                    this.DataSource = newSiteMap;

                    //Assign the newly created dynamic site map:
                    ((XmlDataSource)this.DataSource).Data = newSiteMapDoc.OuterXml;

                    /** this expression removes the root if initialized: **/
                    if (!showStartingNode)
                        ((XmlDataSource)this.DataSource).XPath = "/siteMapNode/siteMapNode";

                    /** Re-initialize menu data source with new site map: **/
                    this.DataBind();

                    /** Find depth of current node: **/
                    int depth = 0;
                    SiteMapNode currNode = provider.CurrentNode;
                    do
                    {
                        depth++;
                        currNode = currNode.ParentNode;
                    }
                    while (currNode != null);

                    //Set the StaticDisplayLevels to match the current depth:
                    if (depth >= this.StaticDisplayLevels)
                        this.StaticDisplayLevels = depth;
                }
            }

            base.OnPreRender(e);

            // output some script to override the default menu flyout behaviour; this helps to avoid
            // intermittent "Operation Aborted" errors
            Page.ClientScript.RegisterStartupScript(
                typeof(MossMenu),
                "overrideMenu_HoverStatic",
                "if (typeof(overrideMenu_HoverStatic) == 'function' && typeof(Menu_HoverStatic) == 'function')\n" +
                "{\n" +
                    "_spBodyOnLoadFunctionNames.push('enableFlyoutsAfterDelay');\n" +
                    "Menu_HoverStatic = overrideMenu_HoverStatic;\n" +
                "}\n",
                true);

            // output some script to avoid a known issue with SSL Termination and the ASP.NET
            // Menu implementation. http://support.microsoft.com/?id=910444
            Page.ClientScript.RegisterStartupScript(
                typeof(MossMenu),
                "MenuHttpsWorkaround_" + this.ClientID,
                this.ClientID + "_Data.iframeUrl='/_layouts/images/blank.gif';",
                true);

            // adjust the fly-out indicator arrow direction for locale if not already set
            if (this.Orientation == System.Web.UI.WebControls.Orientation.Vertical &&
                ((string.IsNullOrEmpty(this.StaticPopOutImageUrl) && this.StaticEnableDefaultPopOutImage) ||
                    (string.IsNullOrEmpty(this.DynamicPopOutImageUrl) && this.DynamicEnableDefaultPopOutImage)))
            {
                SPWeb currentWeb = SPContext.Current.Web;
                if (currentWeb != null)
                {
                    uint localeId = currentWeb.Language;

                    bool isBidiWeb = SPUtility.IsRightToLeft(currentWeb, currentWeb.Language);

                    string arrowUrl = "/_layouts/images/" + (isBidiWeb ? "largearrowleft.gif" : "largearrowright.gif");

                    if (string.IsNullOrEmpty(this.StaticPopOutImageUrl) && this.StaticEnableDefaultPopOutImage)
                    {
                        this.StaticPopOutImageUrl = arrowUrl;
                    }
                    if (string.IsNullOrEmpty(this.DynamicPopOutImageUrl) && this.DynamicEnableDefaultPopOutImage)
                    {
                        this.DynamicPopOutImageUrl = arrowUrl;
                    }
                }
            }

            if (provider == null)
            {
                // if we're not attached to a SiteMapDataSource we'll just leave everything alone
                return;
            }
            else if (this.customSelectionEnabled)
            {
                MenuItem selectedMenuItem = this.SelectedItem;
                SiteMapNode currentNode = provider.CurrentNode;

                // if no menu item is presently selected, we need to work our way up from the current 
                // node until we can find a node in the menu item dictionary
                while (selectedMenuItem == null && currentNode != null)
                {
                    this.menuItemDictionary.TryGetValue(currentNode.Url, out selectedMenuItem);

                    currentNode = currentNode.ParentNode;
                }

                if (this.selectStaticItemsOnly)
                {
                    // only static items may be selected, keep moving up until we find an item
                    // that falls within the static range
                    while (selectedMenuItem != null && selectedMenuItem.Depth >= this.StaticDisplayLevels)
                    {
                        selectedMenuItem = selectedMenuItem.Parent;
                    }

                    // if we found an item to select, go ahead and select (highlight) it
                    if (selectedMenuItem != null && selectedMenuItem.Selectable)
                    {
                        selectedMenuItem.Selected = true;
                    }
                }
            }
        }

        private XmlDocument InitializeNewSiteMapXml(SiteMapProvider provider, SiteMapNodeCollection rootChildNodes)
        {
            /** Find the level 1 ancestor node of the current node: **/
            SiteMapNode levelOneAncestorOfSelectedNode = null;
            SiteMapNode currNode = provider.CurrentNode;
            do
            {
                levelOneAncestorOfSelectedNode = (currNode.ParentNode == null ? levelOneAncestorOfSelectedNode : currNode);
                currNode = currNode.ParentNode;
            }
            while (currNode != null);

            /** Initialize base SiteMapXML **/
            XmlDocument newSiteMapDoc = new XmlDocument();
            newSiteMapDoc.LoadXml(originalSiteMap);

            /** Prune out the childern nodes that shouldn't display: **/
            currNode = provider.CurrentNode;
            do
            {
                if (currNode.ParentNode != null)
                {
                    SiteMapNodeCollection currNodeSiblings = currNode.ParentNode.ChildNodes;
                    foreach (SiteMapNode siblingNode in currNodeSiblings)
                    {
                        if (siblingNode.HasChildNodes)
                        {
                            if (provider.CurrentNode.Equals(siblingNode))
                            {
                                //Remove all the childerns child nodes from display:
                                SiteMapNodeCollection currNodesChildren = siblingNode.ChildNodes;
                                foreach (SiteMapNode childNode in currNodesChildren)
                                {
                                    XmlNode currentXmNode = GetCurrentXmlNode(newSiteMapDoc, childNode);

                                    DeleteChildNodes(currentXmNode);
                                }
                            }
                            else if (!provider.CurrentNode.IsDescendantOf(siblingNode)
                                && !levelOneAncestorOfSelectedNode.Equals(siblingNode))
                            {
                                XmlNode currentXmNode = GetCurrentXmlNode(newSiteMapDoc, siblingNode);

                                DeleteChildNodes(currentXmNode);
                            }
                        }
                    }
                }

                currNode = currNode.ParentNode;
            }
            while (currNode != null);

            return newSiteMapDoc;
        }

        private XmlNode GetCurrentXmlNode(XmlDocument newSiteMapDoc, SiteMapNode node)
        {
            //Find this node in the original site map:
            XmlNode currentXmNode = newSiteMapDoc.DocumentElement.SelectSingleNode(
                "//siteMapNode[@url='"
                + node.Url
                + "']");
            return currentXmNode;
        }

        private void DeleteChildNodes(XmlNode currentXmNode)
        {
            if (currentXmNode != null && currentXmNode.HasChildNodes)
            {
                //Remove child nodes:
                XmlNodeList xmlNodes = currentXmNode.ChildNodes;
                int lastNodeIndex = xmlNodes.Count - 1;
                for (int i = lastNodeIndex; i >= 0; i--)
                {
                    currentXmNode.RemoveChild(xmlNodes[i]);
                }
            }
        }
        private XmlNode GetXmlSiteMapNode(XmlNode currentDocumentNode, SiteMapNode currentNode)
        {
            XmlElement newNode = currentDocumentNode.OwnerDocument.CreateElement("siteMapNode");

            XmlAttribute newAttr = currentDocumentNode.OwnerDocument.CreateAttribute("title");
            newAttr.InnerText = currentNode.Title;
            newNode.Attributes.Append(newAttr);

            newAttr = currentDocumentNode.OwnerDocument.CreateAttribute("url");
            newAttr.InnerText = currentNode.Url;
            newNode.Attributes.Append(newAttr);

            return newNode;
        }

        private void NavigateSiteMap(XmlNode currentDocumentNode, SiteMapNode currentNode)
        {
            foreach (SiteMapNode node in currentNode.ChildNodes)
            {
                //Add this node to structure:
                XmlNode newNode = GetXmlSiteMapNode(currentDocumentNode, node);
                currentDocumentNode.AppendChild(newNode);

                if (node.HasChildNodes)
                {
                    //Make a recursive call to add any child nodes:
                    NavigateSiteMap(newNode, node);
                }
            }
        }
    }

    [PermissionSet(SecurityAction.LinkDemand, Name = "FullTrust")]
    [System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Security", "CA2117:AptcaTypesShouldOnlyExtendAptcaBaseTypes")]
    public sealed class MossMenuDesigner : MenuDesigner
    {
        [PermissionSet(SecurityAction.Demand, Name = "FullTrust")]
        protected override void DataBind(BaseDataBoundControl dataBoundControl)
        {
            try
            {
                dataBoundControl.DataBind();
            }
            catch
            {
                base.DataBind(dataBoundControl);
            }
        }

        [PermissionSet(SecurityAction.Demand, Name = "FullTrust")]
        public override string GetDesignTimeHtml()
        {
            System.Web.UI.WebControls.Menu menu = (System.Web.UI.WebControls.Menu)ViewControl;
            int oldDisplayLevels = menu.MaximumDynamicDisplayLevels;
            string designTimeHtml = string.Empty;

            try
            {
                menu.MaximumDynamicDisplayLevels = 0;

                // ASP.NET MenuDesigner has some dynamic/static item trick in design time
                // to show dynamic item in design time. We only want to show preview without
                // dynamic menu items.
                designTimeHtml = base.GetDesignTimeHtml();
            }
            catch (Exception e)
            {
                designTimeHtml = GetErrorDesignTimeHtml(e);
            }
            finally
            {
                menu.MaximumDynamicDisplayLevels = oldDisplayLevels;
            }

            return designTimeHtml;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T00:46:51.023

我个人不喜欢默认菜单提供的 html（基于表格的布局）。幸运的是，SharePoint 团队已经发布了该[控件](http://blogs.msdn.com/ecm/archive/2006/12/02/customizing-the-wss-3-0-moss-2007-menu-control-mossmenu-source-code-released.aspx)的代码。

我们所做的就是将该代码包含在一个项目中，并重写了 render 方法来做我们想做的任何事情。这使您可以灵活地定义需要显示的父级之间的确切关系以及在您创建的任何 div 上设置样式。

不利的一面是，您现在正在编码，而不是配置，并且需要对您用于使用控件的母版页进行更改。

在我看来值得。现在，这是我们为任何网站所做的标准更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T22:16:04.083

我们用来完成您正在寻找的效果的方法是使用[CSS Friendly Control Adapters](http://www.codeplex.com/cssfriendly)。适配器会更改呈现的 HTML，而不会更改您在页面上使用的控件。您可能需要稍微调整菜单适配器以获得所需的布局。我们只需要几行代码。一旦你开始工作，你就可以使用 CSS 来获得你描述的行为。

# autoconf - 将 GNU autoconf/automake 的辅助脚本放在哪里？

> ID：94161
> 
> 赞同：2
> 
> 时间：2008-09-18T16:28:40.253
> 
> 标签：autoconf, automake

我正在开发一个将与 GNU autoconf/automake 一起分发的项目，并且我有一组调用 awk 脚本的 bash 脚本。我希望 bash 脚本以 $PATH 结尾，而不是 awk 脚本。我应该如何将这些插入到项目中？是否应该将它们与其他二进制文件一起放入？

另外，有没有办法确定安装后文件的最终位置？我认为 /usr/local/bin 并不*总是*可执行文件的最终位置......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-01-24T22:22:47.153

您可以只列出要在 Makefile.am 中安装的脚本：

```
bin_SCRIPTS = 富吧

```

这将导致在 make install 期间安装 foo 和 bar。要获取它们最终位置的路径，您可以在 foo.in 中使用 @bindir@ 并让我们为您配置构建 foo。例如，在 configure.ac 中：

```
AC_CONFIG_FILES([foo bar])

```

然后在 foo.in 中：

```
#!/bin/sh

前缀=@前缀@
exec_prefix=@exec_prefix@
绑定=@绑定@
回声绑定 = $bindir

```

请记住，运行configure 的人可以指定--prefix、--exec_prefix 或--bindir 中的任何一个，并且可以使用DESTDIR 重定向安装。使用此处描述的技术，将不考虑 DESTDIR，并且脚本将安装在它将回显的路径以外的位置。这是设计使然，并且是正确的行为，因为通常使用 DESTDIR 安装来创建一个 tarball，该 tarball 最终将被解压到文件系统中，从而使脚本中的 bindir 变得有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T16:38:40.587

将这样的内容添加到 Makefile.am

```
scriptsdir = $(prefix)/bin
scripts_DATA = awkscript1 awkscript2 
```

在这种情况下，它将在 $(prefix)/bin 中安装 awkscript（您也可以使用 $(bindir)）。

注意：不要忘记第一个应该命名为 name + dir (scripts -> scriptsdir)，第二个应该命名为 name + _DATA (scripts -> scripts_DATA)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T07:57:23.910

乔纳森，回答你的额外问题：如果你想在构建时替换前缀的值，你需要：

1.  将您的脚本“myscript”重命名为“myscript.in”
2.  向 configure.ac 添加规则以在底部生成它
3.  使用我制作的名为[AS_AC_EXPAND的宏](http://autostars.cvs.sourceforge.net/viewvc/*checkout*/autostars/autostars/ac-expand/as-ac-expand.m4)
4.  像这样使用它：

    AS_AC_EXPAND(BINDIR, $bindir)

5.  在您的“myscript.in”中，您现在可以使用@BINDIR@，它将扩展到最终安装脚本的完整路径。

请注意，您不应该直接使用 PREFIX，任何安装目录都可能被更改，因此您真的想使用传递给 bindir 配置的值并扩展它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:40:02.300

如果 awk 脚本不会进入主 bin 目录（前缀/bin），那么您需要将它们放在适当的子目录中 - 可能是 lib，但可能是 libexec 或 share（因为 awk 脚本可能是平台中立的） .

正确：软件不一定会在 /usr/local/bin 中结束；在我的机器上，/usr/local/bin 由 MIS 管理，因此我安装的所有软件都在 /usr/gnu/ 下。我使用： ./configure --prefix=/usr/gnu 将软件安装在我想要的位置。

您可以在 bash 脚本中嵌入 PREFIX 的值——实际上，您将“编译”脚本以包含安装位置。请注意构建测试期间的问题 - 您可能需要先定位相对于当前目录的脚本，然后再定位相对于 PREFIX 的脚本。

# c# - 在 WPF 控件上显示“加载”指示器的最佳方法是什么

> ID：94171
> 
> 赞同：11
> 
> 时间：2008-09-18T16:29:26.040
> 
> 标签：c#, .net, wpf, user-controls

在 C#.Net WPF 中 UserControl.Load ->

在用户控件完成收集数据并呈现其内容之前，在用户控件上显示旋转圆圈/“正在加载”指示器的最佳方式是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T18:12:33.483

我通常会创建这样的布局：

```
<Grid>
    <Grid x:Name="MainContent" IsEnabled="False">
    ...
    </Grid>

    <Grid x:Name="LoadingIndicatorPanel">
    ...
    </Grid>
</Grid> 
```

然后我在工作线程上加载数据，完成后我更新“MainContent”网格下的 UI 并启用网格，然后将 LoadingIndicatorPanel 的 Visibility 设置为 Collapsed。

我不确定这是否是您要问的，或者您是否想知道如何在加载标签中显示动画。如果它是您所追求的动画，请更新您的问题以更具体。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-25T12:22:03.710

这是我最近为了创建加载动画而正在做的事情。此 xaml 将生成一个动画圈。

我最初的想法是创建一个装饰器并将这个动画用作它的内容，然后在装饰器层中显示加载动画并将下面的内容变灰。

还没有机会完成它，所以我想我会发布动画供您参考。

```
<Window 
    x:Class="WpfApplication2.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1"
    Height="300"
    Width="300"
    >
    <Window.Resources>
        <Color x:Key="FilledColor" A="255" B="155" R="155" G="155"/>
        <Color x:Key="UnfilledColor" A="0" B="155" R="155" G="155"/>

        <Storyboard x:Key="Animation0" FillBehavior="Stop" BeginTime="00:00:00.0" RepeatBehavior="Forever">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="_00" Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00.0" Value="{StaticResource FilledColor}"/>
                <SplineColorKeyFrame KeyTime="00:00:01.6" Value="{StaticResource UnfilledColor}"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="Animation1" BeginTime="00:00:00.2" RepeatBehavior="Forever">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="_01" Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00.0" Value="{StaticResource FilledColor}"/>
                <SplineColorKeyFrame KeyTime="00:00:01.6" Value="{StaticResource UnfilledColor}"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="Animation2" BeginTime="00:00:00.4" RepeatBehavior="Forever">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="_02" Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00.0" Value="{StaticResource FilledColor}"/>
                <SplineColorKeyFrame KeyTime="00:00:01.6" Value="{StaticResource UnfilledColor}"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="Animation3" BeginTime="00:00:00.6" RepeatBehavior="Forever">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="_03" Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00.0" Value="{StaticResource FilledColor}"/>
                <SplineColorKeyFrame KeyTime="00:00:01.6" Value="{StaticResource UnfilledColor}"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="Animation4" BeginTime="00:00:00.8" RepeatBehavior="Forever">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="_04" Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00.0" Value="{StaticResource FilledColor}"/>
                <SplineColorKeyFrame KeyTime="00:00:01.6" Value="{StaticResource UnfilledColor}"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="Animation5" BeginTime="00:00:01.0" RepeatBehavior="Forever">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="_05" Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00.0" Value="{StaticResource FilledColor}"/>
                <SplineColorKeyFrame KeyTime="00:00:01.6" Value="{StaticResource UnfilledColor}"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="Animation6" BeginTime="00:00:01.2" RepeatBehavior="Forever">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="_06" Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00.0" Value="{StaticResource FilledColor}"/>
                <SplineColorKeyFrame KeyTime="00:00:01.6" Value="{StaticResource UnfilledColor}"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="Animation7" BeginTime="00:00:01.4" RepeatBehavior="Forever">
            <ColorAnimationUsingKeyFrames Storyboard.TargetName="_07" Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00.0" Value="{StaticResource FilledColor}"/>
                <SplineColorKeyFrame KeyTime="00:00:01.6" Value="{StaticResource UnfilledColor}"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>
    </Window.Resources>

    <Window.Triggers>
        <EventTrigger RoutedEvent="FrameworkElement.Loaded">
            <BeginStoryboard Storyboard="{StaticResource Animation0}"/>
            <BeginStoryboard Storyboard="{StaticResource Animation1}"/>
            <BeginStoryboard Storyboard="{StaticResource Animation2}"/>
            <BeginStoryboard Storyboard="{StaticResource Animation3}"/>
            <BeginStoryboard Storyboard="{StaticResource Animation4}"/>
            <BeginStoryboard Storyboard="{StaticResource Animation5}"/>
            <BeginStoryboard Storyboard="{StaticResource Animation6}"/>
            <BeginStoryboard Storyboard="{StaticResource Animation7}"/>
        </EventTrigger>
    </Window.Triggers>

    <Canvas>
        <Canvas Canvas.Left="21.75" Canvas.Top="14" Height="81.302" Width="80.197">
            <Canvas.Resources>
                <Style TargetType="Ellipse">
                    <Setter Property="Width" Value="15"/>
                    <Setter Property="Height" Value="15" />
                    <Setter Property="Fill" Value="#FFFFFFFF" />
                </Style>
            </Canvas.Resources>

            <Ellipse x:Name="_00" Canvas.Left="24.75" Canvas.Top="50"/>
            <Ellipse x:Name="_01" Canvas.Top="36" Canvas.Left="29.5"/>
            <Ellipse x:Name="_02" Canvas.Left="43.5" Canvas.Top="29.75"/>
            <Ellipse x:Name="_03" Canvas.Left="57.75" Canvas.Top="35.75"/>
            <Ellipse x:Name="_04" Canvas.Left="63.5" Canvas.Top="49.75" />
            <Ellipse x:Name="_05" Canvas.Left="57.75" Canvas.Top="63.5"/>
            <Ellipse x:Name="_06" Canvas.Left="43.75" Canvas.Top="68.75"/>
            <Ellipse x:Name="_07" Canvas.Top="63.25" Canvas.Left="30" />
            <Ellipse Stroke="{x:Null}" Width="39.5" Height="39.5" Canvas.Left="31.75" Canvas.Top="37" Fill="{x:Null}"/>
        </Canvas>
    </Canvas>
</Window> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-04T18:21:26.833

我改进了 Ian Oakes Design 并构建了他的加载指示器的可扩展版本：

```
<UserControl x:Class="Mesap.Framework.UI.Controls.BusyIndicator"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" Name="Root" Foreground="#9b9b9b"
             d:DesignHeight="100" d:DesignWidth="100">
    <Grid>
        <Grid.Resources>
            <Storyboard x:Key="Animation0" FillBehavior="Stop" BeginTime="00:00:00.0" RepeatBehavior="Forever">
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="E00" Storyboard.TargetProperty="Opacity">
                    <LinearDoubleKeyFrame KeyTime="00:00:00.0" Value="1"/>
                    <LinearDoubleKeyFrame KeyTime="00:00:01.6" Value="0"/>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>

            <Storyboard x:Key="Animation1" BeginTime="00:00:00.2" RepeatBehavior="Forever">
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="E01" Storyboard.TargetProperty="Opacity">
                    <LinearDoubleKeyFrame KeyTime="00:00:00.0" Value="1"/>
                    <LinearDoubleKeyFrame KeyTime="00:00:01.6" Value="0"/>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>

            <Storyboard x:Key="Animation2" BeginTime="00:00:00.4" RepeatBehavior="Forever">
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="E02" Storyboard.TargetProperty="Opacity">
                    <LinearDoubleKeyFrame KeyTime="00:00:00.0" Value="1"/>
                    <LinearDoubleKeyFrame KeyTime="00:00:01.6" Value="0"/>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>

            <Storyboard x:Key="Animation3" BeginTime="00:00:00.6" RepeatBehavior="Forever">
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="E03" Storyboard.TargetProperty="Opacity">
                    <LinearDoubleKeyFrame KeyTime="00:00:00.0" Value="1"/>
                    <LinearDoubleKeyFrame KeyTime="00:00:01.6" Value="0"/>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>

            <Storyboard x:Key="Animation4" BeginTime="00:00:00.8" RepeatBehavior="Forever">
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="E04" Storyboard.TargetProperty="Opacity">
                    <LinearDoubleKeyFrame KeyTime="00:00:00.0" Value="1"/>
                    <LinearDoubleKeyFrame KeyTime="00:00:01.6" Value="0"/>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>

            <Storyboard x:Key="Animation5" BeginTime="00:00:01.0" RepeatBehavior="Forever">
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="E05" Storyboard.TargetProperty="Opacity">
                    <LinearDoubleKeyFrame KeyTime="00:00:00.0" Value="1"/>
                    <LinearDoubleKeyFrame KeyTime="00:00:01.6" Value="0"/>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>

            <Storyboard x:Key="Animation6" BeginTime="00:00:01.2" RepeatBehavior="Forever">
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="E06" Storyboard.TargetProperty="Opacity">
                    <LinearDoubleKeyFrame KeyTime="00:00:00.0" Value="1"/>
                    <LinearDoubleKeyFrame KeyTime="00:00:01.6" Value="0"/>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>

            <Storyboard x:Key="Animation7" BeginTime="00:00:01.4" RepeatBehavior="Forever">
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="E07" Storyboard.TargetProperty="Opacity">
                    <LinearDoubleKeyFrame KeyTime="00:00:00.0" Value="1"/>
                    <LinearDoubleKeyFrame KeyTime="00:00:01.6" Value="0"/>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>

            <Style TargetType="Ellipse">
                <Setter Property="Fill" Value="{Binding ElementName=Root, Path=Foreground}"/>

            </Style>
        </Grid.Resources>
        <Grid.Triggers>
            <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                <BeginStoryboard Storyboard="{StaticResource Animation0}"/>
                <BeginStoryboard Storyboard="{StaticResource Animation1}"/>
                <BeginStoryboard Storyboard="{StaticResource Animation2}"/>
                <BeginStoryboard Storyboard="{StaticResource Animation3}"/>
                <BeginStoryboard Storyboard="{StaticResource Animation4}"/>
                <BeginStoryboard Storyboard="{StaticResource Animation5}"/>
                <BeginStoryboard Storyboard="{StaticResource Animation6}"/>
                <BeginStoryboard Storyboard="{StaticResource Animation7}"/>
            </EventTrigger>
        </Grid.Triggers>

        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <Ellipse x:Name="E00" Grid.Row="4" Grid.Column="0" Grid.RowSpan="3" Grid.ColumnSpan="3" Width="Auto" Height="Auto" Opacity="0"/>
        <Ellipse x:Name="E01" Grid.Row="1" Grid.Column="1" Grid.RowSpan="3" Grid.ColumnSpan="3" Width="Auto" Height="Auto" Opacity="0" />
        <Ellipse x:Name="E02" Grid.Row="0" Grid.Column="4" Grid.RowSpan="3" Grid.ColumnSpan="3" Width="Auto" Height="Auto" Opacity="0" />
        <Ellipse x:Name="E03" Grid.Row="1" Grid.Column="7" Grid.RowSpan="3" Grid.ColumnSpan="3" Width="Auto" Height="Auto" Opacity="0" />
        <Ellipse x:Name="E04" Grid.Row="4" Grid.Column="8" Grid.RowSpan="3" Grid.ColumnSpan="3" Width="Auto" Height="Auto" Opacity="0" />
        <Ellipse x:Name="E05" Grid.Row="7" Grid.Column="7" Grid.RowSpan="3" Grid.ColumnSpan="3" Width="Auto" Height="Auto" Opacity="0" />
        <Ellipse x:Name="E06" Grid.Row="8" Grid.Column="4" Grid.RowSpan="3" Grid.ColumnSpan="3" Width="Auto" Height="Auto" Opacity="0" />
        <Ellipse x:Name="E07" Grid.Row="7" Grid.Column="1" Grid.RowSpan="3" Grid.ColumnSpan="3" Width="Auto" Height="Auto" Opacity="0" />
    </Grid>
</UserControl> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T15:09:45.290

如果你在 Vista 上运行它，你也可以只使用默认的等待光标。

this.Cursor = Cursors.Wait;

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-26T03:48:42.007

使用忙碌指示器。这是一个银光的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-07T13:30:14.023

您可以将动画 gif 显示为加载元素

**XAML**

```
<WindowsFormsHost>
    <winForms:PictureBox x:Name="pictureBoxLoading" />
</WindowsFormsHost> 
```

**代码背后**

```
pictureBoxLoading.Image = System.Drawing.Image.FromFile("images/ajax-loader.gif"); 
```

# .net - NAnt 最佳实践

> ID：94173
> 
> 赞同：8
> 
> 时间：2008-09-18T16:29:34.040
> 
> 标签：.net, coding-style, nant

我这里有 300 行长的 NAnt 文件，非常混乱。我想知道是否有编写 NAnt 脚本的任何样式指南，以及这样做的最佳实践是什么。

有小费吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T18:28:49.090

我不知道任何已发布的风格指南，但我当然可以分享我的经验。您可以使用在其他编程环境中使用的许多相同技术，例如使代码模块化并将其拆分到多个文件中。在我设置的环境中，每个项目的布局如下：“[ProjectName]\Common”包含一个通用构建文件，该文件链接到我的几乎所有项目。我还有一组常见的颠覆目标存储在一个文件中。“Common”子目录实际上是一个 svn:external，因此它会自动在多个项目之间保持同步。在 Common.build 文件中，有很多环境属性，加上一些可重用的文件集、一些可重用的目标，以及每个项目“StartUp”目标使用的“StartUp”目标。

“[ProjectName]\Project.build”包含所有项目特定的属性和文件集，其中一些会覆盖 Common.build 中的设置。该文件还包含一个“启动”目标，它设置一些运行时设置，如程序集版本信息和任何相关路径。它还从 Common.build 执行“启动”目标。此文件包括 Common.build 文件。

“[ProjectName][AssemblyName].build”包含特定于单个程序集的所有设置和目标。该文件包括 Project.build，而后者又包括 Common.build。

这种层次结构在我们的情况下运行良好，我们需要在持续集成服务器上构建产品的主干版本和多个分支版本。就目前而言，用于构建主干版本的脚本与任何一个分支之间的唯一区别只是几行代码。

# wpf - WPF Datatrigger 未按预期触发

> ID：94177
> 
> 赞同：30
> 
> 时间：2008-09-18T16:29:45.680
> 
> 标签：wpf, datatrigger

我有以下 XAML：

```
<TextBlock Text="{Binding ElementName=EditListBox, Path=SelectedItems.Count}" Margin="0,0,5,0"/>
<TextBlock Text="items selected">
    <TextBlock.Style>
        <Style TargetType="{x:Type TextBlock}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=EditListBox, Path=SelectedItems.Count}" Value="1">
                    <Setter Property="TextBlock.Text" Value="item selected"></Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBlock.Style>
</TextBlock> 
```

第一个文本块随着 SelectedItems.Count 的变化而变化，显示为 0、1、2 等。第二个块上的数据触发器似乎永远不会触发来更改文本。

有什么想法吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-19T21:00:49.580

或者，您可以将 XAML 替换为：

```
<TextBlock Margin="0,0,5,0" Text="{Binding ElementName=EditListBox, Path=SelectedItems.Count}"/>
<TextBlock>
    <TextBlock.Style>
        <Style TargetType="{x:Type TextBlock}">
            <Setter Property="Text" Value="items selected"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=EditListBox, Path=SelectedItems.Count}" Value="1">
                    <Setter Property="Text" Value="item selected"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBlock.Style>
</TextBlock> 
```

转换器可以解决很多绑定问题，但是拥有很多专门的转换器会变得非常混乱。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-18T17:29:00.810

DataTrigger 正在触发，但您的第二个 TextBlock 的 Text 字段被硬编码为“选定的项目”，因此无法更改。要看到它触发，您可以删除 Text="items selected"。

您的问题很适合使用**ValueConverter**而不是**DataTrigger**。以下是如何创建和使用 ValueConverter 将 Text 设置为您想要的内容。

**创建这个 ValueConverter：**

```
public class CountToSelectedTextConverter : IValueConverter
{
    #region IValueConverter Members

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if ((int)value == 1)
            return "item selected";
        else
            return "items selected";
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }

    #endregion
} 
```

**将命名空间引用添加到转换器所在的程序集：**

```
xmlns:local="clr-namespace:ValueConverterExample" 
```

**将转换器添加到您的资源中：**

```
<Window.Resources>
    <local:CountToSelectedTextConverter x:Key="CountToSelectedTextConverter"/>
</Window.Resources> 
```

**将您的第二个文本块更改为：**

```
 <TextBlock Text="{Binding ElementName=EditListBox, Path=SelectedItems.Count, Converter={StaticResource CountToSelectedTextConverter}}"/> 
```

# svn - 为什么 StatSVN 失败，声称该目录不是工作副本？

> ID：94178
> 
> 赞同：1
> 
> 时间：2008-09-18T16:30:03.977
> 
> 标签：svn, statsvn

我有我的项目的工作副本，使用 Subversion 1.5.1 签出。当我尝试对它运行[StatSVN](http://www.statsvn.org/)时，我收到以下错误：

> 2008 年 9 月 18 日下午 12:25:22 net.sf.statsvn.util.JavaUtilTask​​Logger 信息信息：StatSVN - SVN 统计信息生成
> 
> 2008 年 9 月 18 日下午 12:25:22 net.sf.statsvn.util.JavaUtilTask​​Logger 信息信息：svn：'。不是工作副本 2008 年 9 月 18 日下午 12:25:22 net.sf.statsvn.util.JavaUtilTask​​Logger 错误严重：存储库根不可用 - 验证项目是否已使用 svn 版本 1.3.0 或更高版本签出。

有没有人经历过这个？`en_US`我已经看到建议，它可能与使用除*.*`en_US`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T16:33:51.690

只是在这里猜测，但您确定 statSVN 与使用 1.5 版客户端创建的工作副本兼容吗？格式随着 svn 1.5 改变...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T17:00:52.127

@agnul

你是对的。这是来自他们的 bugzilla的[相关功能请求。](http://sourceforge.net/tracker/index.php?func=detail&aid=2016015&group_id=164845&atid=833327)

# asp.net - 在 Asp.net 页面中测试 UI？

> ID：94191
> 
> 赞同：3
> 
> 时间：2008-09-18T16:31:12.197
> 
> 标签：asp.net, unit-testing

在 Asp.net 页面中自动测试 UI 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T16:34:30.970

[Watir](http://wtr.rubyforge.org/)或[Watin](http://sourceforge.net/projects/watin/)是一个很好的起点。

更多信息[在这里](http://www.hanselman.com/blog/WATIRForNETWatiNApproaches08ReleaseAndAutomatingIEFromPowerShell.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T16:35:10.253

定义很松散的问题，因此几乎不可能给出一个好的答案。敢于建议使用[Selenium](http://selenium.openqa.org/)可能有助于自动化任务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T17:14:51.640

如果您是项目中唯一的编码员，我建议您手动对其进行测试。也就是说，您可能会患上编码肌病。由于您编写了代码并且知道它应该做什么，因此您可能会下意识地避免会破坏它的操作。

我使用过不同的自动化方法，它们往往相当繁重。换句话说，你会发现自己比你想要的更频繁地更新你的测试。在我看来，只有当您在一个项目中有多个开发人员并且他们不了解全部范围时，才需要进行自动化测试。

在理想的环境中，开发人员将有一个专门的测试人员来编写和维护测试，并验证代码在功能上是否正确并满足业务需求。

在现实世界中，许多开发人员基本上都是资源和时间有限的独狼，拥有可靠、无错误代码的最佳方法是了解业务需求，然后确保在编写代码时不会出错。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:35:25.820

不确定“最佳”方式，这可能是一个很重要的问题......

一种方法是使用 Visual Studio 测试版中的 Web 测试，请参阅[MSDN 文档。](http://msdn.microsoft.com/en-us/library/ms182536(VS.80).aspx) 这里还有一个[简单的教程。](http://blogs.vertigosoftware.com/teamsystem/archive/2006/03/09/Simple_Web_Testing_with_Team_Test_Edition.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:37:26.253

你具体测试什么？跨浏览器合规性？表现？可用性？这是一个相当广泛的问题——你能再定义一下吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T16:38:12.990

在用户接受度方面？捕虫？负载测试？

对于第一个，让其他人使用它并对其发表评论。

对于第二个，您应该使用预先编写的测试计划和测试用例来测试 UI，包括数据验证（服务器端和 javascript）、范围检查和所有这些内容。我相信您也可以使用一些模拟点击的工具。

第三，尝试 JMeter。

至于测试网站背后的引擎，你可以绕过web界面，编写直接调用引擎的测试类（如果不是直接编码到ASP中的话）来测试它的功能。但是，我将此称为测试 UI 的不同任务。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T16:38:20.277

可以在 SourceForge.net 上找到的 AspUnit。然而，该项目不再积极开发，但它将在 .Net 1.1 和 2.0 上运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T16:48:16.743

*   设置一个包含多个终端的房间，运行您的应用程序
*   准备要完成的任务清单
*   召集志愿者完成任务
*   通过录音或单向镜子监控志愿者的行为

冲洗并重复！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-09T11:46:40.593

我投票支持 Visual Studio 2010 中的测试管理器，然后为它生成[“编码的 UI 测试”](http://blogs.msdn.com/mathew_aniyan/archive/2009/01/21/tutorial-how-to-create-a-coded-ui-test.aspx)！

*   很容易创建断言
*   非常好的代码（可读！）
*   易于维护，因为代码易于阅读，并且您可以更改在页面上找到控件的方式

我做了一个快速[比较或 WatiN、Selenium 和测试管理器 VS2010](http://peitor.blogspot.com/2010/02/smack-down-watin-vs-selenium-vs-vs2010.html)

# multithreading - 在.Net 中的各个线程之间同步对象集合的最佳方法是什么？

> ID：94204
> 
> 赞同：1
> 
> 时间：2008-09-18T16:33:41.753
> 
> 标签：multithreading

在.Net 中的各个线程之间同步对象集合的最佳方法是什么？

我需要在线程安全模式下从不同线程访问列表或字典。带有添加、删除、Foreach 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T20:06:19.633

基本上这取决于您需要使用的模式。如果您有多个线程写入和读取同一个地方，您可以使用与单个线程（hastable、数组等）一起使用的相同数据结构，并带有锁/监视器或 ReaderWriterLock 以防止竞争条件。如果您需要在线程之间传递数据，您将需要某种队列（同步或无锁），组 A 的线程将插入该队列，而组 B 的线程将从队列中取出。您可能希望使用 WaitEvent（AutoReset 或 Manual），以便在队列为空时不会丢失 CPU。这实际上取决于您想要实现什么样的工作流程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T16:35:42.887

你可以实现一个无锁队列：

[http://www.boyet.com/Articles/LockfreeQueue.html](http://www.boyet.com/Articles/LockfreeQueue.html)

或者使用锁自己处理同步：

[http://www.albahari.com/threading/part2.html#_Locking](http://www.albahari.com/threading/part2.html#_Locking)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T16:36:00.390

Hashtable.Synchronized 方法返回 Hashtable 的同步（线程安全）包装器。

[http://msdn.microsoft.com/en-us/library/system.collections.hashtable.synchronized(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.synchronized(VS.80).aspx)

这也存在于其他集合中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:40:08.540

.Net 中的许多集合类都内置了对同步和多线程访问安全的支持。例如（在 C++/CLR 中）：

```
 Collections::Queue ^unsafe_queue = gcnew Collections::Queue();
    Collections::Queue ^safe_queue = Collections::Queue::Synchronized(unsafe_queue); 
```

您可以丢弃对 unsafe_queue 的引用，并保留对 safe_queue 的引用。它可以在线程之间共享，并且可以保证线程安全访问。其他集合类，如 ArrayList 和 Hashtable，也以类似的方式支持这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:40:22.737

在不知道细节的情况下，我倾向于使用代表和事件来通知更改。

[http://msdn.microsoft.com/en-us/library/17sde2xt(VS.71).aspx](http://msdn.microsoft.com/en-us/library/17sde2xt(VS.71).aspx)

并实现观察者或发布订阅模式

[http://en.wikipedia.org/wiki/Observer_pattern](http://en.wikipedia.org/wiki/Observer_pattern) [http://msdn.microsoft.com/en-us/library/ms978603.aspx](http://msdn.microsoft.com/en-us/library/ms978603.aspx)

# windows - 如何停止出现“发现新硬件向导”？

> ID：94221
> 
> 赞同：-2
> 
> 时间：2008-09-18T16:34:48.757
> 
> 标签：windows, hardware, drivers

作为我们产品的一部分，我们使用第 3 方硬件和驱动程序。不幸的是，这些驱动程序没有注册，因此在安装或升级我们的产品时会弹出“找到新硬件向导”。我们的产品是基于网络的，允许用户远程访问他们需要的一切，除了这个案例。

是否存在会阻止向导出现的注册表黑客或其他操作系统设置？

我们可以自己签司机吗？

我们能否编写一个程序，在向导上单击“下一步，下一步，下一步”，该程序将适用于 Windows 的所有语言变体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T20:40:24.767

有两种方法可以进行静默安装：
1）[签署驱动程序](http://www.microsoft.com/whdc/winlogo/default.mspx)，如果您没有驱动程序源代码，这可能很难/不可能。2）您可以使用[此](http://msdn.microsoft.com/en-us/library/ms791137.aspx)api
编写一个[共同安装程序 dll 。](http://www.osronline.com/ddkx/install/coinst_5p0n.htm)这是不可靠的问题，根据我们的经验，有很多针对不同 Windows 风格的解决方法。

唯一 100% 可靠的选项将是选项一。

# svn - 如何在不删除其后续修订版的情况下切换回文件的先前版本？

> ID：94226
> 
> 赞同：11
> 
> 时间：2008-09-18T16:35:11.127
> 
> 标签：svn

我的 subversion 存储库中有 4 个版本的文件 A.txt，例如：A.txt.r1、A.txt.r2、A.txt.r3 和 A.txt.r4。我的文件工作副本是 r4，我想切换回 r2。我不想使用“ *svn update -r 2 A.txt* ”，因为这将删除 r2 之后的所有修订，即 r3 和 r4。

那么有什么方法可以将我的工作副本更新到 r2 并且仍然可以选择稍后切换到 r3 和 r4？换句话说，我希望在更新后仍然能够使用“ *svn log A.txt* ”查看所有 4 个修订。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-18T16:51:14.067

要对 A.txt 进行等于修订版 2 的新修订版：

```
svn up -r HEAD
svn merge -r HEAD:2 A.txt
svn commit 
```

另请参阅[撤消更改](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.basicmerging.html#svn.branchmerge.basicmerging.undo)中的说明。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T16:47:25.027

该命令`svn up -r 4`仅将您的*本地*副本更新到修订版 4。

服务器仍然具有所有版本 1 到任何版本。

你想要做的是创建一个*新*的修订，修订号 5，它与修订号 2 相同。

```
cd /repo 
svn up -r 2 
cp /repo/file /tmp/file_2 
svn up -r 4 
cp /tmp/file_2 /repo/file 
svn commit -m "Making 5 from 2" 
```

如果您改变主意并想要返回 4，您可以通过从修订版 4 创建修订版 6 来实现。

```
cd /repo 
svn up -r 4
cp /repo/file /tmp/file_4
svn up -r 5 
cp /tmp/file_4 /repo/file 
svn commit -m "Making 6 from 4" 
```

快乐的黑客。

（当然有一种方法可以在我相信的 2 个命令中完成上述操作，但我已经有一段时间没有这样做了，这可能有点令人困惑）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T16:45:33.130

我对 Subversion 没有很多经验，所以如果这种方法在这种环境下不起作用，请见谅。

在这种情况下，我遵循以下步骤：

1.  签出有问题的文件准备编辑为 r4
2.  用您需要的版本覆盖文件的本地副本，在本例中为 r2
3.  签入/提交文件的这个“新”版本作为 r5 并带有适当的注释

这样，当您浏览文件历史记录时，您将看到如下内容：

*   r1
*   r2
*   r3
*   r4
*   r5（评论：“恢复为 r2 内容”）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T16:56:26.473

```
svn update -r 2 A.txt 
```

此命令**不会**删除存储库中的任何版本。它会将您的 A.txt 工作副本设置为修订版 2。您可以这样做

```
> svn status -u A.txt
  *     2   A.txt 
```

此命令的输出表明您正在查看版本 2，并且有更新（即 *）。

完成此更新后，您**仍然**可以执行“ *svn log* ”并查看所有修订。

执行“ *svn update A.txt* ”将使您返回到最新版本（在您的情况下为r4）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T16:38:36.687

更新到旧版本不会删除您的新版本。

`svn up -r2 file`那么你可以这样做`svn up -r4 file`。

此外，您将无法以这种方式提交 r2 文件，因为您必须在提交之前进行更新，并且您最终会再次使用 r4。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T16:40:59.287

> “我不想使用“svn update -r 2 A.txt”，因为这将删除 r2 之后的所有修订，即 r3 和 r4。”

呃……实际上不会。试试看：在 -r 2 之后执行一次常规的 svn 更新，你会看到工作副本更新回 r4。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T16:41:23.233

更新不会删除服务器上的任何修订。它所做的唯一更改是对您的本地工作副本：

[SVN 更新命令](http://svnbook.red-bean.com/en/1.2/svn.ref.svn.c.update.html)

“将存储库中的更改带入您的工作副本”

“将工作副本与 --revision 开关给出的修订版同步”

# c++ - 智能指针：谁拥有对象？

> ID：94227
> 
> 赞同：121
> 
> 时间：2008-09-18T16:35:17.117
> 
> 标签：c++, memory-management, smart-pointers, ownership-semantics

C++ 是关于内存所有权的——也就是**所有权语义**。

一块动态分配的内存的所有者有责任释放该内存。所以问题真的变成了谁拥有记忆。

在 C++ 中，所有权由包装在内部的*原始*指针的类型记录，因此在一个好的（IMO）C++ 程序中，很少（*很少*，不是*从不*）看到传递的原始指针（因为原始指针没有推断的所有权，因此我们可以不知道谁拥有内存，因此如果不仔细阅读文档，您就无法知道谁负责所有权）。

相反，很少看到原始指针存储在一个类中，每个原始指针都存储在其自己的智能指针包装器中。（**注意：**如果您不拥有一个对象，则不应存储它，因为您不知道它何时会超出范围并被销毁。）

所以问题：

*   人们遇到了什么类型的所有权语义？
*   使用哪些标准类来实现这些语义？
*   你觉得它们在什么情况下有用？

让我们为每个答案保留一种语义所有权，以便可以单独对它们进行上下投票。

## 概括：

从概念上讲，智能指针很简单，简单的实现也很容易。我见过许多尝试的实现，但它们总是以某种方式被破坏，这对于随意使用和示例来说并不明显。因此，我建议始终使用库中经过良好测试的智能指针，而不是自己滚动。`std::auto_ptr`或者 Boost 智能指针之一似乎可以满足我的所有需求。

### `std::auto_ptr<T>`：

单身人士拥有该物品。允许转让所有权。

用法：这允许您定义显示所有权显式转移的接口。

### `boost::scoped_ptr<T>`

单身人士拥有该物品。不允许转让所有权。

用法：用于显示明确的所有权。对象将被析构函数或显式重置时销毁。

### `boost::shared_ptr<T>`( `std::tr1::shared_ptr<T>`)

多重所有权。这是一个简单的引用计数指针。当引用计数达到零时，对象被销毁。

用法：当一个对象可以有多个生命周期无法在编译时确定时。

### `boost::weak_ptr<T>`：

`shared_ptr<T>`在可能发生指针循环的情况下使用 with 。

用法：用于在只有循环维护共享引用计数时停止循环保留对象。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-18T19:39:20.933

## 简单的 C++ 模型

在我看到的大多数模块中，默认情况下，假设接收指针**没有**接收所有权。事实上，放弃指针所有权的函数/方法非常罕见，并且在其文档中明确表达了这一事实。

**该模型假设用户只是他/她明确分配的内容的所有者**。其他所有内容都会自动处理（在范围退出或通过 RAII）。这是一个类似 C 的模型，扩展了大多数指针归对象所有的事实，这些对象将自动或在需要时（主要是在所述对象销毁时）释放它们，并且对象的生命周期是可预测的（RAII 是你的朋友，再次）。

在这个模型中，原始指针是自由循环的，而且大多数情况下并不危险（但如果开发人员足够聪明，他/她将尽可能使用引用来代替）。

*   原始指针
*   标准::auto_ptr
*   boost::scoped_ptr

## 智能指针 C++ 模型

在充满智能指针的代码中，用户可以希望忽略对象的生命周期。所有者永远不是用户代码：它是智能指针本身（RAII，再次）。**问题是循环引用与引用计数的智能指针混合可能是致命**的，因此您必须同时处理共享指针和弱指针。所以你仍然需要考虑所有权（弱指针很可能没有指向任何东西，即使它相对于原始指针的优势是它可以告诉你）。

*   boost::shared_ptr
*   boost::weak_ptr

## 结论

无论我描述的模型是什么，**除非异常，接收指针并*没有*接收到它的所有权**，**知道谁拥有谁仍然非常重要**。即使对于大量使用引用和/或智能指针的 C++ 代码也是如此。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-18T17:07:05.887

对我来说，这 3 种满足了我的大部分需求：

`shared_ptr`- 引用计数，当计数器达到零时释放

`weak_ptr`- 与上面相同，但它是 a 的“奴隶” `shared_ptr`，无法解除分配

`auto_ptr`- 当创建和释放发生在同一个函数内，或者当对象必须被认为是一个所有者时。当您将一个指针分配给另一个时，第二个从第一个“窃取”对象。

我对这些有自己的实现，但它们也可以在`Boost`.

我仍然通过引用传递对象（`const`只要可能），在这种情况下，被调用的方法必须假定对象仅在调用期间是活动的。

还有另一种我使用的指针，我称之为***hub_ptr***。当您拥有一个必须可以从嵌套在其中的对象（通常作为虚拟基类）访问的对象时。这可以通过将 a 传递`weak_ptr`给他们来解决，但它本身没有 a `shared_ptr`。因为它知道这些对象不会比他活得更久，所以它将一个 hub_ptr 传递给它们（它只是一个普通指针的模板包装器）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-18T17:27:44.370

没有共享所有权。如果您这样做，请确保它仅使用您无法控制的代码。

这解决了 100% 的问题，因为它迫使你了解一切是如何相互作用的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T16:37:35.707

*   共享所有权
*   boost::shared_ptr

当一个资源在多个对象之间共享时。boost shared_ptr 使用引用计数来确保资源在每个人都完成后被释放。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T16:38:51.227

`std::tr1::shared_ptr<Blah>`通常是您最好的选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-21T12:13:33.663

从 boost 开始，还有[指针容器](http://www.boost.org/doc/libs/1_37_0/libs/ptr_container/doc/ptr_container.html)库。如果您只在其容器的上下文中使用对象，则它们比智能指针的标准容器更有效且更易于使用。

在 Windows 上，有 COM 指针（IUnknown、IDispatch 和朋友），以及用于处理它们的各种智能指针（例如 ATL 的[CComPtr](http://msdn.microsoft.com/en-us/library/ezzw7k98(vs.80).aspx)和由 Visual Studio 中基于[_com_ptr](http://msdn.microsoft.com/en-us/library/417w8b3b(VS.80).aspx)类的“import”语句自动生成的智能指针）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T17:04:08.763

*   一位业主
*   boost::scoped_ptr

当您需要动态分配内存但希望确保它在块的每个退出点被释放时。

我发现这很有用，因为它可以很容易地重新安装和释放，而不必担心泄漏

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T17:13:47.570

我认为我从来没有能够在我的设计中共享所有权。事实上，我能想到的唯一有效案例是享元模式。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-21T05:18:48.960

yasper::ptr 是一个轻量级的、类似 boost::shared_ptr 的替代方案。它在我的（目前）小项目中运行良好。

[在http://yasper.sourceforge.net/](http://yasper.sourceforge.net/)的网页中描述如下：

> 为什么要编写另一个 C++ 智能指针？已经存在几个用于 C++ 的高质量智能指针实现，最突出的是 Boost 指针 pantheon 和 Loki 的 SmartPtr。为了更好地比较智能指针实现以及何时使用它们，请阅读 Herb Sutter 的 The New C++: Smart(er) Pointers。与其他库的扩展功能相比，Yasper 是一个狭义的引用计数指针。它与 Boost 的 shared_ptr 和 Loki 的 RefCounted/AllowConversion 策略密切对应。Yasper 允许 C++ 程序员忘记内存管理，而无需引入 Boost 的大量依赖项或不必了解 Loki 的复杂策略模板。哲学
> 
> ```
> * small (contained in single header)
> * simple (nothing fancy in the code, easy to understand)
> * maximum compatibility (drop in replacement for dumb pointers) 
> ```
> 
> 最后一点可能很危险，因为 yasper 允许其他实现不允许的危险（但有用）操作（例如分配给原始指针和手动释放）。请注意，只有在您知道自己在做什么的情况下才使用这些功能！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-21T12:29:49.417

还有另一种经常使用的单一可转让所有者形式，它更可取，`auto_ptr`因为它避免了由于`auto_ptr`赋值语义的疯狂破坏而导致的问题。

我说的莫过于`swap`。任何具有合适`swap`功能的类型都可以被认为是对某些内容的*智能引用*，它拥有这些内容，直到所有权通过交换它们转移到相同类型的另一个实例时。每个实例都保留其身份，但会绑定到新内容。这就像一个安全的可重新绑定的参考。

（它是智能引用而不是智能指针，因为您不必显式取消引用它来获取内容。）

This means that auto_ptr becomes less necessary - it's only needed to fill the gaps where types don't have a good `swap` function. But all std containers do.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T16:35:24.293

*   一位所有者：也就是复制时删除
*   标准::auto_ptr

当对象的创建者想要明确地将所有权交给其他人时。这也是在我提供给您的代码中记录的一种方式，并且我不再跟踪它，因此请确保在完成后将其删除。

# css - CSS 'font-size: medium' 是否将字体设置为 .Body 字体大小或 *browser* 的基本字体大小？

> ID：94241
> 
> 赞同：3
> 
> 时间：2008-09-18T16:36:54.443
> 
> 标签：css

在“CSS：缺失的手册”中，作者说 font-size: medium （或其他大小关键字）设置字体相对于*浏览器的*基本字体大小。

但我在 FF2 和 IE6 中看到的是，它将字体大小设置为我在 .CSS HTML 或 BODY 样式中指定的大小（这是首选）。

如果它以后一种方式工作，那么如果您有嵌套样式并且您知道您希望某些文本成为正文字体大小（即“正常大小的文本”），这将非常方便。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T16:40:50.020

来自[CSS 2.1 规范](http://www.w3.org/TR/CSS21/fonts.html#font-size-props)：

> 'medium' 值是用户的首选字体大小，用作参考中间值。

如果浏览器不这样做，那么浏览器就是错误的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T16:44:48.327

它将基于父元素，以尊重级联。如果有帮助，我总是这样设置字体大小：

```
body {
   font: normal 100% "Arial","Helvetica",sans-serif;
}
p, li, td {
   font-size: .85em;
}
li p, td p {
   font-size: 1em;
} 
```

100% 用在身体上，然后用 em 做其他事情。我从不使用“较小”或“中等”或类似的东西。这种方式我有更多的控制权。

**编辑：**

请参阅 Jim 关于“中等”是绝对字体大小的评论。很好注意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T18:37:42.220

字体大小关键字（xx-small、x-small、small、medium 等）基于用户默认的中等字体大小。它也可以用于更改子元素相对于父元素的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-17T12:34:19.310

如前所述，`medium`由 UA（浏览器）设置，但您仍然可以通过使用`rem`. `rem`是相对于根元素（特别是`<html>`元素，而不是`<body>`），因此受根元素样式的影响。

请参阅[this fiddle](https://jsfiddle.net/Aides/ap5awqbp/)进行演示。

```
html
{
  font-size: 60px;
}

#mediumBlock
{
  font-size: medium;
}

#remBlock
{
  font-size: 1rem;
}

#halfRemBlock
{
  font-size: 0.5rem;
}
```

```
<div id="inheritedBlock">
  Foobar inherited
</div>
<div id="mediumBlock">
  Foobar medium
</div>
<div id="remBlock">
  Foobar rem
</div>
<div id="halfRemBlock">
  Foobar 0.5rem
</div>
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-18T16:38:45.157

我认为，如果您为容器或主体等元素设置默认大小，那么子元素中的任何相对字体大小都基于父元素。只有当您没有在任何地方指定字体大小时，它才会默认为浏览器（它们都有不同的大小）。

# apache-flex - 如何让 Flex 项目在运行时加载插件？

> ID：94245
> 
> 赞同：2
> 
> 时间：2008-09-18T16:37:08.237
> 
> 标签：apache-flex, plugins, ria

我希望在我正在处理的 Flex 项目中有几个插件。我知道我可以使用 SWFLoader 加载 SWF，但我认为在 Flex3 中您现在可以拥有运行时共享库​​或其他东西。有没有人有关于在运行时加载插件的好文档？理想情况下，我希望能够从 URL 加载插件，然后从插件中执行一些代码（例如，向页面添加控件）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T16:42:06.600

您可以使用模块或 RSL。

RSL 的优势是通过闪存而不是浏览器进行缓存，因此它们可以保留更长时间。

模块更容易创建和使用。我使用过模块并且遇到模块无法加载的问题（代码需要处理这种情况）。我还没有尝试过 RSL。

以下是有关创建 RSL 的一些文档[http://labs.adobe.com/wiki/index.php/Flex_3:Feature_Introductions:Flex_3_RSLs](http://labs.adobe.com/wiki/index.php/Flex_3:Feature_Introductions:Flex_3_RSLs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T09:11:14.150

请注意，目前，加载的 RSL 必须针对相同版本的 Flex 框架进行编译。如果您计划使用“二进制”插件系统，您可能希望等待[Marshall 计划](http://opensource.adobe.com/wiki/display/flexsdk/Marshall+Plan)功能在下一个 Flex 中实现版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-02T07:56:02.243

如果您想尝试一种新的替代方法，这是一个仿照 java OSGi 的应用程序核心框架：[http](http://www.potomacframework.org/) ://www.potomacframework.org/ 我自己没有尝试过，但它看起来真的很酷！

# .net - 构造 ArgumentException 时如何以编程方式确定参数名称？

> ID：94263
> 
> 赞同：3
> 
> 时间：2008-09-18T16:39:04.923
> 
> 标签：.net, reflection, refactoring, duplication

在构造 ArgumentException 时，一些重载采用一个字符串，该字符串是无效参数的参数名称。我认为每当我更改方法的参数名称时不必记住更新此 ctor 参数会很好。有没有一种使用反射的简单方法来做到这一点？

**更新：**感谢到目前为止的 2 位受访者。你们都很好地回答了这个问题，但解决方案仍然让我很头疼。（好吧，**有点**头疼，但仍然......）解释一下，如果我稍后*重新排序*参数 - 或删除更早的参数 - 我必须记住再次更改我的异常构造代码。有没有办法我可以使用类似的东西

```
Object.ReferenceEquals(myParam, <insert code here>) 
```

确定我正在处理相关参数？这样，编译器会介入以防止我错误地构造异常。

也就是说，我开始怀疑原始问题的“简单”部分并不是那么即将到来。也许我应该忍受使用字符串文字。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T18:27:09.423

反射不适用于此。

你必须忍受记住才能把它做好。

幸运的是，FxCop（或团队系统代码分析）将通过指出任何不匹配来帮助您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-22T10:11:40.023

您可以为此使用表达式树，这将以一些奇怪的语法为代价得到您想要的。例如

```
public void Resize(int newSize)
{
  if (newSize < 1)
  {
    throw new ArgumentException("Blah", NameOfVariable(() => newSize));
  }
  // ... whatever ...
} 
```

其中 NameOfVariable 定义为：

```
public static string NameOfVariable(Expression<Func<object>> expressionTree)
{
   var expression = (UnaryExpression)expressionTree.Body;
   var memberExpression = (MemberExpression)expression.Operand;
   return memberExpression.Member.Name;
} 
```

如果您将 UnaryExpression 以外的任何内容传递给 NameOfVariable，这也有可能在运行时崩溃。

如果这段代码也会导致 FxCop 抱怨，我不会感到惊讶，正如[Joe](https://stackoverflow.com/questions/94263/how-to-programmatically-determine-param-name-when-constructing-an-argumentexcep#95317)提到的那样，使用 FxCop 可能是最好的方法。

# c# - 当用户尝试打开新实例时返回到已打开的应用程序

> ID：94274
> 
> 赞同：21
> 
> 时间：2008-09-18T16:40:05.233
> 
> 标签：c#, .net, windows, vb.net

这是一个我有一段时间无法弄清楚的问题。防止第二个实例是微不足道的，并且有很多方法，但是，恢复已经运行的进程不是。我想：

*   最小化：撤消最小化并将正在运行的实例置于最前面。
*   在其他窗口后面：将应用程序放在前面。

我使用的语言是 VB.NET 和 C#。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T16:46:35.543

我发现这段代码很有用。它对现有应用程序进行检测和可选激活：

[http://www.codeproject.com/KB/cs/cssingprocess.aspx](http://www.codeproject.com/KB/cs/cssingprocess.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T16:46:58.773

如果您使用的是 .NET，则使用内置 .NET 功能似乎更容易、更直接：

[每周源代码 31- 单实例 WinForms 和 Microsoft.VisualBasic.dll](http://www.hanselman.com/blog/TheWeeklySourceCode31SingleInstanceWinFormsAndMicrosoftVisualBasicdll.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T16:42:54.273

这些链接可能会有所帮助：

[http://www.ai.uga.edu/mc/SingleInstance.html](http://www.ai.uga.edu/mc/SingleInstance.html)

它有代码来检测另一个正在运行的实例，但不确定一旦你得到了实例你能用它做什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-10-20T13:00:38.583

在 Form_Load 中，此代码有效。

```
 If App.PrevInstance = True Then
     MsgBox "Already running...."
     Unload Me
     Exit Sub
 End If 
```

# c# - 什么更快，打开字符串或 elseif 类型？

> ID：94305
> 
> 赞同：79
> 
> 时间：2008-09-18T16:42:40.030
> 
> 标签：c#, performance

假设我可以选择根据字符串比较或判断类型来识别要采用的代码路径：

哪个更快，为什么？

```
switch(childNode.Name)
{
    case "Bob":
      break;
    case "Jill":
      break;
    case "Marko":
      break;
}

if(childNode is Bob)
{
}
elseif(childNode is Jill)
{
}
else if(childNode is Marko)
{
} 
```

**更新：**我问这个的主要原因是因为 switch 语句对于什么算作案例很陌生。例如，它不允许您使用变量，只能使用移动到主程序集中的常量。我认为它有这个限制是因为它正在做一些时髦的事情。如果它只是翻译成 elseifs（正如一位发帖人评论的那样），那么为什么我们不允许在 case 语句中使用变量？

**警告：**我正在优化后。此方法在应用程序的慢速部分被多次*调用。*

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2008-09-24T11:03:59.770

Greg 的配置文件结果非常适合他所涵盖的确切场景，但有趣的是，在考虑许多不同因素时，不同方法的相对成本会发生巨大变化，包括被比较的类型数量、相对频率和基础数据中的任何模式.

简单的答案是，没有人能告诉您在您的特定场景中性能差异是什么，您需要在自己的系统中以不同的方式测量性能以获得准确的答案。

If/Else 链是用于少量类型比较的有效方法，或者如果您可以可靠地预测哪些类型将构成您看到的大多数类型。该方法的潜在问题是，随着类型数量的增加，必须执行的比较次数也会增加。

如果我执行以下操作：

```
int value = 25124;
if(value == 0) ...
else if (value == 1) ...
else if (value == 2) ...
...
else if (value == 25124) ... 
```

在输入正确的块之前，必须评估前面的每个 if 条件。另一方面

```
switch(value) {
 case 0:...break;
 case 1:...break;
 case 2:...break;
 ...
 case 25124:...break;
} 
```

将执行一个简单的跳转到正确的代码位。

在您的示例中变得更复杂的地方是您的其他方法使用字符串而不是整数的开关，这变得有点复杂。在低级别上，字符串不能像整数值那样被打开，所以 C# 编译器做了一些魔术来为你工作。

如果 switch 语句“足够小”（编译器会自动执行它认为最好的操作），则打开字符串会生成与 if/else 链相同的代码。

```
switch(someString) {
    case "Foo": DoFoo(); break;
    case "Bar": DoBar(); break;
    default: DoOther; break;
} 
```

是相同的：

```
if(someString == "Foo") {
    DoFoo();
} else if(someString == "Bar") {
    DoBar();
} else {
    DoOther();
} 
```

一旦字典中的项目列表变得“足够大”，编译器将自动创建一个内部字典，该字典从开关中的字符串映射到整数索引，然后基于该索引进行开关。

它看起来像这样（想象一下比我要费心输入的条目更多）

静态字段在“隐藏”位置定义，该位置与包含类型 switch 语句的类相关联，`Dictionary<string, int>`并给定一个错位名称

```
//Make sure the dictionary is loaded
if(theDictionary == null) { 
    //This is simplified for clarity, the actual implementation is more complex 
    // in order to ensure thread safety
    theDictionary = new Dictionary<string,int>();
    theDictionary["Foo"] = 0;
    theDictionary["Bar"] = 1;
}

int switchIndex;
if(theDictionary.TryGetValue(someString, out switchIndex)) {
    switch(switchIndex) {
    case 0: DoFoo(); break;
    case 1: DoBar(); break;
    }
} else {
    DoOther();
} 
```

在我刚刚运行的一些快速测试中，If/Else 方法的速度大约是 3 种不同类型（其中类型随机分布）的 switch 的 3 倍。在 25 种类型中，切换速度稍快（16%），在 50 种类型中，切换速度是原来的两倍多。

如果您要打开大量类型，我建议使用第三种方法：

```
private delegate void NodeHandler(ChildNode node);

static Dictionary<RuntimeTypeHandle, NodeHandler> TypeHandleSwitcher = CreateSwitcher();

private static Dictionary<RuntimeTypeHandle, NodeHandler> CreateSwitcher()
{
    var ret = new Dictionary<RuntimeTypeHandle, NodeHandler>();

    ret[typeof(Bob).TypeHandle] = HandleBob;
    ret[typeof(Jill).TypeHandle] = HandleJill;
    ret[typeof(Marko).TypeHandle] = HandleMarko;

    return ret;
}

void HandleChildNode(ChildNode node)
{
    NodeHandler handler;
    if (TaskHandleSwitcher.TryGetValue(Type.GetRuntimeType(node), out handler))
    {
        handler(node);
    }
    else
    {
        //Unexpected type...
    }
} 
```

这与 Ted Elliot 建议的类似，但使用运行时类型句柄而不是完整类型对象避免了通过反射加载类型对象的开销。

以下是我机器上的一些快速计时：

```
使用 5,000,000 个数据元素（模式=随机）和 5 种类型测试 3 次迭代
最佳方法时间百分比
如果/否则 179.67 100.00
类型句柄字典 321.33 178.85
类型字典 377.67 210.20
开关 492.67 274.21

使用 5,000,000 个数据元素（模式=随机）和 10 种类型测试 3 次迭代
最佳方法时间百分比
如果/否则 271.33 100.00
类型句柄字典 312.00 114.99
类型字典 374.33 137.96
开关 490.33 180.71

使用 5,000,000 个数据元素（模式=随机）和 15 种类型测试 3 次迭代
最佳方法时间百分比
类型句柄字典 312.00 100.00
如果/否则 369.00 118.27
类型字典 371.67 119.12
开关 491.67 157.59

使用 5,000,000 个数据元素（模式=随机）和 20 种类型测试 3 次迭代
最佳方法时间百分比
类型句柄字典 335.33 100.00
类型字典 373.00 111.23
如果/否则 462.67 137.97
开关 490.33 146.22

使用 5,000,000 个数据元素（模式=随机）和 25 种类型测试 3 次迭代
最佳方法时间百分比
类型句柄字典 319.33 100.00
类型字典 371.00 116.18
开关 483.00 151.25
如果/否则 562.00 175.99

使用 5,000,000 个数据元素（模式=随机）和 50 种类型测试 3 次迭代
最佳方法时间百分比
类型句柄字典 319.67 100.00
类型字典 376.67 117.83
开关 453.33 141.81
如果/否则 1,032.67 323.04

```

至少在我的机器上，当用作方法输入的类型的分布是随机的时，类型句柄字典方法在超过 15 种不同类型的任何情况下都胜过所有其他方法。

另一方面，如果输入完全由在 if/else 链中首先检查的类型组成，则该方法*要*快得多：

```
使用 5,000,000 个数据元素（模式=UniformFirst）和 50 种类型测试 3 次迭代
最佳方法时间百分比
如果/否则 39.00 100.00
类型句柄字典 317.33 813.68
类型字典 396.00 1,015.38
开关 403.00 1,033.33

```

相反，如果输入始终是 if/else 链中的最后一件事，则会产生相反的效果：

```
使用 5,000,000 个数据元素（mode=UniformLast）和 50 种类型测试 3 次迭代
最佳方法时间百分比
类型句柄字典 317.67 100.00
开关 354.33 111.54
类型字典 377.67 118.89
如果/否则 1,907.67 600.52

```

如果您可以对您的输入做出一些假设，您可能会从混合方法中获得最佳性能，在该方法中您对最常见的少数类型执行 if/else 检查，如果这些方法失败，则回退到字典驱动的方法。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-18T18:10:36.997

首先，您在比较苹果和橙子。您首先需要比较 switch on type 与 switch on string，然后比较 if on type 与 if on string，然后比较获胜者。

其次，这就是面向对象的设计目的。在支持 OO 的语言中，打开类型（任何类型）是一种代码味道，表明设计不佳。解决方案是从具有抽象或虚拟方法（或类似构造，取决于您的语言）的公共基础派生

例如。

```
class Node
{
    public virtual void Action()
    {
        // Perform default action
    }
}

class Bob : Node
{
    public override void Action()
    {
        // Perform action for Bill
    }
}

class Jill : Node
{
    public override void Action()
    {
        // Perform action for Jill
    }
} 
```

然后，您只需调用 childNode.Action() 而不是执行 switch 语句

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-18T17:59:55.993

我刚刚实现了一个快速测试应用程序并使用 ANTS 4 对其进行了分析。
规格：32 位 Windows XP 中的 .Net 3.5 sp1，在发布模式下构建的代码。

300 万次测试：

*   开关：1.842 秒
*   如果：0.344 秒。

此外，switch 语句结果显示（不出所料）更长的名称需要更长的时间。

100 万次测试

*   鲍勃：0.612 秒。
*   吉尔：0.835 秒。
*   马可：1.093 秒。

我看起来“If Else”更快，至少是我创建的场景。

```
class Program
{
    static void Main( string[] args )
    {
        Bob bob = new Bob();
        Jill jill = new Jill();
        Marko marko = new Marko();

        for( int i = 0; i < 1000000; i++ )
        {
            Test( bob );
            Test( jill );
            Test( marko );
        }
    }

    public static void Test( ChildNode childNode )
    {   
        TestSwitch( childNode );
        TestIfElse( childNode );
    }

    private static void TestIfElse( ChildNode childNode )
    {
        if( childNode is Bob ){}
        else if( childNode is Jill ){}
        else if( childNode is Marko ){}
    }

    private static void TestSwitch( ChildNode childNode )
    {
        switch( childNode.Name )
        {
            case "Bob":
                break;
            case "Jill":
                break;
            case "Marko":
                break;
        }
    }
}

class ChildNode { public string Name { get; set; } }

class Bob : ChildNode { public Bob(){ this.Name = "Bob"; }}

class Jill : ChildNode{public Jill(){this.Name = "Jill";}}

class Marko : ChildNode{public Marko(){this.Name = "Marko";}} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-18T16:55:55.147

Switch 语句的执行速度比 if-else-if 梯形图快。这是由于编译器能够优化 switch 语句。在 if-else-if 梯形图的情况下，代码必须按照程序员确定的顺序处理每个 if 语句。但是，因为 switch 语句中的每个 case 都不依赖于较早的 case，所以编译器能够以提供最快执行速度的方式重新排序测试。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-18T16:58:49.307

如果你已经制作了类，我建议使用策略设计模式而不是 switch 或 elseif。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-18T18:01:46.190

尝试对每个对象使用枚举，您可以快速轻松地打开枚举。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-18T16:45:16.483

除非你已经写了这个并且发现你有性能问题，否则我不会担心哪个更快。选择更具可读性的那个。请记住，“过早的优化是万恶之源。” ——唐纳德·克努斯

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-18T17:25:24.017

SWITCH 构造最初是为整数数据设计的；它的目的是将参数直接用作“调度表”（指针表）的索引。因此，将有一个测试，然后直接启动到相关代码，而不是一系列测试。

这里的困难在于它的使用已被推广到“字符串”类型，这显然不能用作索引，并且 SWITCH 构造的所有优点都丢失了。

如果速度是您的预期目标，那么问题不在于您的代码，而在于您的数据结构。如果“名称”空间像您展示的那样简单，最好将其编码为整数值（例如，在创建数据时），并在“应用程序的慢速部分多次”中使用此整数。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-18T17:31:16.903

如果您打开的类型是原始 .NET 类型，您可以使用 Type.GetTypeCode(Type)，但如果它们是自定义类型，它们都将以 TypeCode.Object 的形式返回。

带有委托或处理程序类的字典也可以工作。

```
Dictionary<Type, HandlerDelegate> handlers = new Dictionary<Type, HandlerDelegate>();
handlers[typeof(Bob)] = this.HandleBob;
handlers[typeof(Jill)] = this.HandleJill;
handlers[typeof(Marko)] = this.HandleMarko;

handlers[childNode.GetType()](childNode);
/// ...

private void HandleBob(Node childNode) {
    // code to handle Bob
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-18T16:43:58.717

switch() 将编译为等效于一组 else if 的代码。字符串比较将比类型比较慢得多。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-18T17:04:07.843

我记得在几本参考书中读到 if/else 分支比 switch 语句更快。但是，对 Blackwasp 的一些研究表明 switch 语句实际上更快： http: [//www.blackwasp.co.uk/SpeedTestIfElseSwitch.aspx](http://www.blackwasp.co.uk/SpeedTestIfElseSwitch.aspx)

实际上，如果您将典型的 3 到 10 个（左右）语句进行比较，我严重怀疑使用其中一个或另一个会带来任何真正的性能提升。

正如 Chris 已经说过的，追求可读性： [什么更快，打开字符串或 elseif 类型？](https://stackoverflow.com/questions/94305/what-is-quicker-switch-on-string-or-elseif-on-type#94336)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-18T17:20:50.190

我认为这里的主要性能问题是，在 switch 块中，你比较字符串，而在 if-else 块中，你检查类型......这两个不一样，因此，我会说你'正在“将土豆与香蕉进行比较”。

我先比较一下：

```
switch(childNode.Name)
{
    case "Bob":
        break;
    case "Jill":
        break;
    case "Marko":
      break;
}

if(childNode.Name == "Bob")
{}
else if(childNode.Name == "Jill")
{}
else if(childNode.Name == "Marko")
{} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-01-03T02:06:43.927

我不确定正确的设计在多态性方面的速度有多快。

```
interface INode
{
    void Action;
}

class Bob : INode
{
    public void Action
    {

    }
}

class Jill : INode
{
    public void Action
    {

    }
}

class Marko : INode
{
    public void Action
    {

    }
}

//Your function:
void Do(INode childNode)
{
    childNode.Action();
} 
```

看看你的 switch 语句做了什么会更好。如果您的函数实际上与类型上的操作无关，那么您可能可以在每种类型上定义一个枚举。

```
enum NodeType { Bob, Jill, Marko, Default }

interface INode
{
    NodeType Node { get; };
}

class Bob : INode
{
    public NodeType Node { get { return NodeType.Bob; } }
}

class Jill : INode
{
    public NodeType Node { get { return NodeType.Jill; } }
}

class Marko : INode
{
    public NodeType Node { get { return NodeType.Marko; } }
}

//Your function:
void Do(INode childNode)
{
    switch(childNode.Node)
    {
        case Bob:
          break;
        case Jill:
          break;
        case Marko:
          break;
        Default:
          throw new ArgumentException();
    }
} 
```

我认为这必须比这两种方法都快。[如果纳秒对您很重要，](http://www.dotnetperls.com/interface-virtual-performance)您可能想尝试抽象类路由。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-01-27T11:11:55.343

我创建了一个小控制台来展示我的解决方案，只是为了突出速度差异。我使用了不同的字符串哈希算法，因为证书版本在运行时对我来说会变慢，并且不太可能出现重复，如果是这样，我的 switch 语句将失败（直到现在从未发生过）。我独特的哈希扩展方法包含在下面的代码中。

[![带有输出的 Core 2 控制台应用程序](https://i.stack.imgur.com/88P5E.png)](https://i.stack.imgur.com/88P5E.png)

任何时候我都会在 695 滴答声中取 29 个滴答声，特别是在使用关键代码时。

使用来自给定数据库的一组字符串，您可以创建一个小型应用程序来在给定文件中创建常量以供您在代码中使用，如果添加了值，您只需重新运行批处理并生成常量并由解决方案。

```
 public static class StringExtention
    {
        public static long ToUniqueHash(this string text)
        {
            long value = 0;
            var array = text.ToCharArray();
            unchecked
            {
                for (int i = 0; i < array.Length; i++)
                {
                    value = (value * 397) ^ array[i].GetHashCode();
                    value = (value * 397) ^ i;
                }
                return value;
            }
        }
    }

    public class AccountTypes
    {

        static void Main()
        {
            var sb = new StringBuilder();

            sb.AppendLine($"const long ACCOUNT_TYPE = {"AccountType".ToUniqueHash()};");
            sb.AppendLine($"const long NET_LIQUIDATION = {"NetLiquidation".ToUniqueHash()};");
            sb.AppendLine($"const long TOTAL_CASH_VALUE = {"TotalCashValue".ToUniqueHash()};");
            sb.AppendLine($"const long SETTLED_CASH = {"SettledCash".ToUniqueHash()};");
            sb.AppendLine($"const long ACCRUED_CASH = {"AccruedCash".ToUniqueHash()};");
            sb.AppendLine($"const long BUYING_POWER = {"BuyingPower".ToUniqueHash()};");
            sb.AppendLine($"const long EQUITY_WITH_LOAN_VALUE = {"EquityWithLoanValue".ToUniqueHash()};");
            sb.AppendLine($"const long PREVIOUS_EQUITY_WITH_LOAN_VALUE = {"PreviousEquityWithLoanValue".ToUniqueHash()};");
            sb.AppendLine($"const long GROSS_POSITION_VALUE ={ "GrossPositionValue".ToUniqueHash()};");
            sb.AppendLine($"const long REQT_EQUITY = {"ReqTEquity".ToUniqueHash()};");
            sb.AppendLine($"const long REQT_MARGIN = {"ReqTMargin".ToUniqueHash()};");
            sb.AppendLine($"const long SPECIAL_MEMORANDUM_ACCOUNT = {"SMA".ToUniqueHash()};");
            sb.AppendLine($"const long INIT_MARGIN_REQ = { "InitMarginReq".ToUniqueHash()};");
            sb.AppendLine($"const long MAINT_MARGIN_REQ = {"MaintMarginReq".ToUniqueHash()};");
            sb.AppendLine($"const long AVAILABLE_FUNDS = {"AvailableFunds".ToUniqueHash()};");
            sb.AppendLine($"const long EXCESS_LIQUIDITY = {"ExcessLiquidity".ToUniqueHash()};");
            sb.AppendLine($"const long CUSHION = {"Cushion".ToUniqueHash()};");
            sb.AppendLine($"const long FULL_INIT_MARGIN_REQ = {"FullInitMarginReq".ToUniqueHash()};");
            sb.AppendLine($"const long FULL_MAINTMARGIN_REQ ={ "FullMaintMarginReq".ToUniqueHash()};");
            sb.AppendLine($"const long FULL_AVAILABLE_FUNDS = {"FullAvailableFunds".ToUniqueHash()};");
            sb.AppendLine($"const long FULL_EXCESS_LIQUIDITY ={ "FullExcessLiquidity".ToUniqueHash()};");
            sb.AppendLine($"const long LOOK_AHEAD_INIT_MARGIN_REQ = {"LookAheadInitMarginReq".ToUniqueHash()};");
            sb.AppendLine($"const long LOOK_AHEAD_MAINT_MARGIN_REQ = {"LookAheadMaintMarginReq".ToUniqueHash()};");
            sb.AppendLine($"const long LOOK_AHEAD_AVAILABLE_FUNDS = {"LookAheadAvailableFunds".ToUniqueHash()};");
            sb.AppendLine($"const long LOOK_AHEAD_EXCESS_LIQUIDITY = {"LookAheadExcessLiquidity".ToUniqueHash()};");
            sb.AppendLine($"const long HIGHEST_SEVERITY = {"HighestSeverity".ToUniqueHash()};");
            sb.AppendLine($"const long DAY_TRADES_REMAINING = {"DayTradesRemaining".ToUniqueHash()};");
            sb.AppendLine($"const long LEVERAGE = {"Leverage".ToUniqueHash()};");
            Console.WriteLine(sb.ToString());

            Test();    
        }    

        public static void Test()
        {
            //generated constant values
            const long ACCOUNT_TYPE = -3012481629590703298;
            const long NET_LIQUIDATION = 5886477638280951639;
            const long TOTAL_CASH_VALUE = 2715174589598334721;
            const long SETTLED_CASH = 9013818865418133625;
            const long ACCRUED_CASH = -1095823472425902515;
            const long BUYING_POWER = -4447052054809609098;
            const long EQUITY_WITH_LOAN_VALUE = -4088154623329785565;
            const long PREVIOUS_EQUITY_WITH_LOAN_VALUE = 6224054330592996694;
            const long GROSS_POSITION_VALUE = -7316842993788269735;
            const long REQT_EQUITY = -7457439202928979430;
            const long REQT_MARGIN = -7525806483981945115;
            const long SPECIAL_MEMORANDUM_ACCOUNT = -1696406879233404584;
            const long INIT_MARGIN_REQ = 4495254338330797326;
            const long MAINT_MARGIN_REQ = 3923858659879350034;
            const long AVAILABLE_FUNDS = 2736927433442081110;
            const long EXCESS_LIQUIDITY = 5975045739561521360;
            const long CUSHION = 5079153439662500166;
            const long FULL_INIT_MARGIN_REQ = -6446443340724968443;
            const long FULL_MAINTMARGIN_REQ = -8084126626285123011;
            const long FULL_AVAILABLE_FUNDS = 1594040062751632873;
            const long FULL_EXCESS_LIQUIDITY = -2360941491690082189;
            const long LOOK_AHEAD_INIT_MARGIN_REQ = 5230305572167766821;
            const long LOOK_AHEAD_MAINT_MARGIN_REQ = 4895875570930256738;
            const long LOOK_AHEAD_AVAILABLE_FUNDS = -7687608210548571554;
            const long LOOK_AHEAD_EXCESS_LIQUIDITY = -4299898188451362207;
            const long HIGHEST_SEVERITY = 5831097798646393988;
            const long DAY_TRADES_REMAINING = 3899479916235857560;
            const long LEVERAGE = 1018053116254258495;

            bool found = false;
            var sValues = new string[] {
              "AccountType"
              ,"NetLiquidation"
              ,"TotalCashValue"
              ,"SettledCash"
              ,"AccruedCash"
              ,"BuyingPower"
              ,"EquityWithLoanValue"
              ,"PreviousEquityWithLoanValue"
              ,"GrossPositionValue"
              ,"ReqTEquity"
              ,"ReqTMargin"
              ,"SMA"
              ,"InitMarginReq"
              ,"MaintMarginReq"
              ,"AvailableFunds"
              ,"ExcessLiquidity"
              ,"Cushion"
              ,"FullInitMarginReq"
              ,"FullMaintMarginReq"
              ,"FullAvailableFunds"
              ,"FullExcessLiquidity"
              ,"LookAheadInitMarginReq"
              ,"LookAheadMaintMarginReq"
              ,"LookAheadAvailableFunds"
              ,"LookAheadExcessLiquidity"
              ,"HighestSeverity"
              ,"DayTradesRemaining"
              ,"Leverage"
            };

            long t1, t2;
            var sw = System.Diagnostics.Stopwatch.StartNew();
            foreach (var name in sValues)
            {
                switch (name)
                {
                    case "AccountType": found = true; break;
                    case "NetLiquidation": found = true; break;
                    case "TotalCashValue": found = true; break;
                    case "SettledCash": found = true; break;
                    case "AccruedCash": found = true; break;
                    case "BuyingPower": found = true; break;
                    case "EquityWithLoanValue": found = true; break;
                    case "PreviousEquityWithLoanValue": found = true; break;
                    case "GrossPositionValue": found = true; break;
                    case "ReqTEquity": found = true; break;
                    case "ReqTMargin": found = true; break;
                    case "SMA": found = true; break;
                    case "InitMarginReq": found = true; break;
                    case "MaintMarginReq": found = true; break;
                    case "AvailableFunds": found = true; break;
                    case "ExcessLiquidity": found = true; break;
                    case "Cushion": found = true; break;
                    case "FullInitMarginReq": found = true; break;
                    case "FullMaintMarginReq": found = true; break;
                    case "FullAvailableFunds": found = true; break;
                    case "FullExcessLiquidity": found = true; break;
                    case "LookAheadInitMarginReq": found = true; break;
                    case "LookAheadMaintMarginReq": found = true; break;
                    case "LookAheadAvailableFunds": found = true; break;
                    case "LookAheadExcessLiquidity": found = true; break;
                    case "HighestSeverity": found = true; break;
                    case "DayTradesRemaining": found = true; break;
                    case "Leverage": found = true; break;
                    default: found = false; break;
                }

                if (!found)
                    throw new NotImplementedException();
            }
            t1 = sw.ElapsedTicks;
            sw.Restart();
            foreach (var name in sValues)
            {
                switch (name.ToUniqueHash())
                {
                    case ACCOUNT_TYPE:
                        found = true;
                        break;
                    case NET_LIQUIDATION:
                        found = true;
                        break;
                    case TOTAL_CASH_VALUE:
                        found = true;
                        break;
                    case SETTLED_CASH:
                        found = true;
                        break;
                    case ACCRUED_CASH:
                        found = true;
                        break;
                    case BUYING_POWER:
                        found = true;
                        break;
                    case EQUITY_WITH_LOAN_VALUE:
                        found = true;
                        break;
                    case PREVIOUS_EQUITY_WITH_LOAN_VALUE:
                        found = true;
                        break;
                    case GROSS_POSITION_VALUE:
                        found = true;
                        break;
                    case REQT_EQUITY:
                        found = true;
                        break;
                    case REQT_MARGIN:
                        found = true;
                        break;
                    case SPECIAL_MEMORANDUM_ACCOUNT:
                        found = true;
                        break;
                    case INIT_MARGIN_REQ:
                        found = true;
                        break;
                    case MAINT_MARGIN_REQ:
                        found = true;
                        break;
                    case AVAILABLE_FUNDS:
                        found = true;
                        break;
                    case EXCESS_LIQUIDITY:
                        found = true;
                        break;
                    case CUSHION:
                        found = true;
                        break;
                    case FULL_INIT_MARGIN_REQ:
                        found = true;
                        break;
                    case FULL_MAINTMARGIN_REQ:
                        found = true;
                        break;
                    case FULL_AVAILABLE_FUNDS:
                        found = true;
                        break;
                    case FULL_EXCESS_LIQUIDITY:
                        found = true;
                        break;
                    case LOOK_AHEAD_INIT_MARGIN_REQ:
                        found = true;
                        break;
                    case LOOK_AHEAD_MAINT_MARGIN_REQ:
                        found = true;
                        break;
                    case LOOK_AHEAD_AVAILABLE_FUNDS:
                        found = true;
                        break;
                    case LOOK_AHEAD_EXCESS_LIQUIDITY:
                        found = true;
                        break;
                    case HIGHEST_SEVERITY:
                        found = true;
                        break;
                    case DAY_TRADES_REMAINING:
                        found = true;
                        break;
                    case LEVERAGE:
                        found = true;
                        break;
                    default:
                        found = false;
                        break;
                }

                if (!found)
                    throw new NotImplementedException();
            }
            t2 = sw.ElapsedTicks;
            sw.Stop();
            Console.WriteLine($"String switch:{t1:N0} long switch:{t2:N0}");
            var faster = (t1 > t2) ? "Slower" : "faster";
            Console.WriteLine($"String switch: is {faster} than long switch: by {Math.Abs(t1-t2)} Ticks");
            Console.ReadLine();

        } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T16:46:20.257

字符串比较将始终完全依赖于运行时环境（除非字符串是静态分配的，尽管需要将它们相互比较是有争议的）。然而，类型比较可以通过动态或静态绑定来完成，无论哪种方式，对于运行时环境来说，它都比比较字符串中的单个字符更有效。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T16:47:53.640

当然，String 上的开关会编译为字符串比较（每种情况一个），它比类型比较慢（并且比用于 switch/case 的典型整数比较慢得多）？

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-18T17:21:32.217

开关的问题之一是使用字符串，例如“Bob”，这将导致编译代码中出现更多的循环和行。生成的 IL 必须声明一个字符串，将其设置为“Bob”，然后在比较中使用它。因此，考虑到这一点，您的 IF 语句将运行得更快。

PS。Aeon 的示例不起作用，因为您无法打开类型。（不，我不知道究竟是为什么，但我们已经尝试过了，但它不起作用。它与变量类型有关）

如果您想对此进行测试，只需构建一个单独的应用程序并构建两个简单的方法来执行上面所写的操作，并使用 Ildasm.exe 之类的东西来查看 IL。您会注意到 IF 语句 Method 的 IL 中的行数要少得多。

Ildasm 带有 VisualStudio...

ILDASM 页面 - [http://msdn.microsoft.com/en-us/library/f7dy01k1(VS.80).aspx](http://msdn.microsoft.com/en-us/library/f7dy01k1(VS.80).aspx)

ILDASM 教程 - [http://msdn.microsoft.com/en-us/library/aa309387(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa309387(VS.71).aspx)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-18T17:50:21.833

三个想法：

1）如果您要根据对象的类型做一些不同的事情，那么将这种行为移到这些类中可能是有意义的。然后，您只需调用 childNode.DoSomething()，而不是 switch 或 if-else。

2）比较类型将比字符串比较快得多。

3) 在 if-else 设计中，您可以利用重新排序测试的优势。如果“吉尔”对象占通过那里的对象的 90%，请先对其进行测试。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T18:07:37.177

请记住，分析器是您的朋友。大多数时候，任何猜测都是浪费时间。[顺便说一句，我对 JetBrains 的dotTrace](http://www.jetbrains.com/profiler/)分析器有很好的体验。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T18:08:05.600

Switch on string 基本上被编译成一个 if-else-if 梯形图。尝试反编译一个简单的。在任何情况下，测试 string equalty 应该更便宜，因为它们是被实习的，所需要的只是参考检查。在可维护性方面做有意义的事情；如果您正在压缩字符串，请进行字符串切换。如果您根据类型进行选择，则类型阶梯更为合适。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-01-25T09:51:58.640

我有点不同，你打开的字符串将是常量，所以你可以在编译时预测值。

在您的情况下，我将使用哈希值，这是一个 int 开关，您有 2 个选项，使用编译时常量或在运行时计算。

```
//somewhere in your code
static long _bob = "Bob".GetUniqueHashCode();
static long _jill = "Jill".GetUniqueHashCode();
static long _marko = "Marko".GeUniquetHashCode();

void MyMethod()
{
   ...
   if(childNode.Tag==0)
      childNode.Tag= childNode.Name.GetUniquetHashCode()

   switch(childNode.Tag)
   {
       case _bob :
        break;
       case _jill :
         break;
       case _marko :
        break;
   }
} 
```

GetUniquetHashCode 的扩展方法可以是这样的：

```
public static class StringExtentions
    {
        /// <summary>
        /// Return unique Int64 value for input string
        /// </summary>
        /// <param name="strText"></param>
        /// <returns></returns>
        public static Int64 GetUniquetHashCode(this string strText)
        {
            Int64 hashCode = 0;
            if (!string.IsNullOrEmpty(strText))
            {
                //Unicode Encode Covering all character-set
                byte[] byteContents = Encoding.Unicode.GetBytes(strText);
                System.Security.Cryptography.SHA256 hash =  new System.Security.Cryptography.SHA256CryptoServiceProvider();
                byte[] hashText = hash.ComputeHash(byteContents);
                //32Byte hashText separate
                //hashCodeStart = 0~7  8Byte
                //hashCodeMedium = 8~23  8Byte
                //hashCodeEnd = 24~31  8Byte
                //and Fold
                Int64 hashCodeStart = BitConverter.ToInt64(hashText, 0);
                Int64 hashCodeMedium = BitConverter.ToInt64(hashText, 8);
                Int64 hashCodeEnd = BitConverter.ToInt64(hashText, 24);
                hashCode = hashCodeStart ^ hashCodeMedium ^ hashCodeEnd;
            }
            return (hashCode);
        }

    } 
```

此代码的源代码发布[在这里](https://www.codeproject.com/Articles/34309/Convert-String-to-bit-Integer) 请注意，使用 Cryptography 很慢，您通常会在应用程序启动时预热支持的字符串，我这样做是为了将它们保存在静态字段中，因为它们不会改变并且与实例无关。请注意，我设置了节点对象的标记值，我可以使用任何属性或添加一个，只要确保这些与实际文本同步即可。

我在低延迟系统上工作，我所有的代码都是一串命令：值，命令：值......

现在该命令都被称为 64 位整数值，因此像这样切换可以节省一些 CPU 时间。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-02-09T02:26:58.753

我只是在这里阅读答案列表，并想分享[这个基准测试](http://cc.davelozinski.com/c-sharp/what-is-the-fastest-conditional-statement "http://cc.davelozinski.com/c-sharp/what-is-the-fastest-conditional-statement")，它将`switch`构造与`if-else`三元`?`运算符进行比较。

我喜欢那篇[文章的](http://cc.davelozinski.com/c-sharp/what-is-the-fastest-conditional-statement "http://cc.davelozinski.com/c-sharp/what-is-the-fastest-conditional-statement")地方在于它不仅比较了单左结构（例如，`if-else`），而且比较了双层和三层结构（例如，`if-else-if-else`）。

根据结果​​，该`if-else`构造在 8/9 测试用例中是最快的；该`switch`构造在 5/9 测试用例中并列最快。

因此，如果您正在寻找速度`if-else`似乎是最快的方法。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2008-09-18T16:52:55.467

我可能遗漏了一些东西，但你不能对类型而不是字符串做一个 switch 语句吗？那是，

```
switch(childNode.Type)
{
case Bob:
  break;
case Jill:
  break;
case Marko:
  break;
} 
```

# asp.net - 如何更改 FileUpload 控件 (System.Web.UI.WebControls) 中浏览按钮的文本

> ID：94316
> 
> 赞同：21
> 
> 时间：2008-09-18T16:43:49.547
> 
> 标签：asp.net, file-upload

我想更改 FileUpload 控件 (System.Web.UI.WebControls) 中浏览按钮的文本，而不是我想使用的 [Browse...] 文本 [...]

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T19:43:54.533

这是旧的，但想提供另一种解决方案。您可以在标准 HTML 超链接上使用 jQuery，并`asp:FileUpload`在单击 HREF 时触发。只需在设计时隐藏 asp:FileUpload 并以您喜欢的任何方式修改 href。

**关联**

```
<a href="#" id="lnkAttachSOW">Attach File</a> 
```

**asp:文件上传**

```
<asp:FileUpload ID="fuSOW" runat="server" style="visibility:hidden;"/> 
```

**然后是 jQuery：**

```
$("#lnkAttachSOW").click(function () {
    $("#fuSOW").click();
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-18T16:48:37.600

出于安全目的，这在技术上是不可能的，因此不会误导用户。

然而，有一些变通方法，尽管这些需要使用原始 HTML 而不是 .NET 服务器控件 - 请查看[http://www.quirksmode.org/dom/inputfile.html](http://www.quirksmode.org/dom/inputfile.html)示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-15T01:52:57.127

这就是我在 .NET 中使用 AsynchFileUpload 和 JavaScript 的方式...

```
<asp:Button ID="bUploadPicture" runat="server" Text="Upload Picture"
    OnClientClick="document.getElementById('<%=tFileUpload1.ClientID%>')
        .click();return (false);" />

<div style="display:none;visibility:hidden;">
     <asp:AsyncFileUpload ID="tFileUpload1" runat="server" 
        OnUploadedComplete="tFileUpload1_UploadedComplete" />
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-30T15:35:15.187

一些第三方工具提供此选项。例如，我们使用 Telerik Upload 控件：

[更改浏览/选择按钮的文本](http://demos.telerik.com/aspnet-ajax/upload/examples/localization/defaultcs.aspx)

[Rad Upload 控件示例](http://www.telerik.com/community/forums/aspnet-ajax/upload/remove-text-select-from-the-radupload-browse-button-not-working-well-with-a-custom-skin.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-24T14:17:01.060

您可以使用另一个按钮和 java 脚本来触发上传浏览按钮，检查这个可爱而简单的解决方案 [How to change Text in FileUpload control](http://forums.asp.net/t/1121953.aspx)

希望这有帮助。

# java - 如何减少 Eclipse Ganymede 的内存使用？

> ID：94331
> 
> 赞同：34
> 
> 时间：2008-09-18T16:44:53.037
> 
> 标签：java, eclipse, memory, ide

我使用最近发布的 Eclipse 的 Ganymede，特别是 Java EE 和 Web 开发人员的发行版。我安装了一些额外的插件（例如 Subclipse、Spring、FindBugs）并删除了所有 Mylyn 插件。

我没有在 Eclipse 中做任何特别繁重的事情，例如启动应用服务器或连接到数据库，但由于某种原因，在使用几个小时后，我发现 Eclipse 正在使用接近 500MB 的内存。

有谁知道为什么 Eclipse 使用这么多内存（泄漏？），更重要的是，如果我能做些什么来改进它？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-19T13:55:15.563

我不特别了解 Eclipse，我使用 IntelliJ，它也会受到内存增长的影响（无论您是否正在积极使用它！）。无论如何，在 IntelliJ 中，我无法消除这个问题，但我确实通过使用运行时 VM 选项减缓了内存增长。您可以尝试在 Eclipse 中重置这些，看看它们是否有所作为。

您可以在 eclipse 文件夹中的 eclipse.ini 文件中编辑 VM 选项。

我发现（在 IntelliJ 中）垃圾收集器设置对内存增长的速度影响最大。

我的设置是：

```
-Xms128m
-Xmx512m
-XX:MaxPermSize=120m
-XX:MaxGCPauseMillis=10
-XX:MaxHeapFreeRatio=70
-XX:+UseConcMarkSweepGC
-XX:+CMSIncrementalMode
-XX:+CMSIncrementalPacing 
```

（有关各个设置的说明，请参见[http://piotrga.wordpress.com/2006/12/12/intellij-and-garbage-collection/ ）。](http://piotrga.wordpress.com/2006/12/12/intellij-and-garbage-collection/)正如你所看到的，我更关心的是在编辑过程中避免长时间的停顿，而不是实际的内存使用，但你可以以此作为开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T17:41:45.817

我认为 JVM 不会做很多垃圾收集，除非它必须这样做（即它达到了它的极限）。因此，它会获取它可以获得的所有内存，可能达到 eclipse.ini 中设置的限制（-Xmx 参数，此处设置为 512MiB）。

您可以通过检查“首选项”->“常规”->“显示堆状态”来获得当前堆状态的直观表示。它将在状态栏中创建一个小仪表，该仪表还有一个“垃圾桶”按钮，您可以使用它来触发手动垃圾收集。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T16:58:49.010

Ganymede Java EE 插件在内存中运行时绝对是巨大的。此外，我在长时间的编码过程中对 FindBugs 及其可靠性有过不好的体验。

如果你不能没有这些插件，那么你唯一的办法就是开始关闭项目。如果您限制工作区中*打开*的项目的数量，编译器（和 FindBugs）将不必担心，并且您的内存使用量将大幅下降。

我通常按​​客户划分我的工作区，然后只在每个工作区中打开最低限度的项目。请注意，如果您有一个特别大的项目（尤其是那些有很多由 WST 检查的文件的项目），那不仅会消耗您的内存，还会在编译时导致明显的响应暂停。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T11:28:45.520

仅供参考，

*   你可以加

    -Dcom.sun.management.jmxremote

到您的 eclise.ini 文件，启动 eclipse，然后通过 jdk 安装中的“jconsole.exe”监控其内存使用情况。

```
C:\[jdk1.6.0_0x path]\bin\jconsole.exe 
```

选择'Connection/New connection/'eclipse'来监控eclipse使用的内存

*   总是使用最新的 jvm 来启动你的 eclipse（这并不妨碍你使用任何其他 jfk 在 eclipse 中编译你的项目）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T17:13:54.183

我称它为臃肿，但不漏水。（如果它是泄漏的，它会不断爬升，直到发生碰撞。）正如其他人所说，内存很***便宜！*** 对我来说，这似乎是一个简单的决定：在更多内存上花费一点点而不是因为您没有运行 Eclipse @ 500MB 的内存预算而降低生产力。

*总结反问：*什么更有价值：

1.  使用您熟悉的 IDE 和您想要的插件获得的生产力，或
2.  在一些内存上花费 50-200 美元？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T16:59:58.540

Eclipse 是一个相当臃肿的 IDE。您可以通过在 Project -> Build Automatically 下打开自动项目构建来最小化它。关闭您当前未在处理的任何打开的项目也可以帮助它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T16:49:48.250

Eclipse 本身就相当臃肿，您添加的插件越多只会使情况恶化。它仍然是我最喜欢的 IDE，因为它确实不缺功能，但是如果您正在寻找一个轻量级的 IDE，那么我建议您放弃 Eclipse；如果你让它运行一段时间，运行半个内存是很正常的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-21T11:51:33.293

我遇到了基于 java 的程序内存消耗的问题。我发现它可能与选择的 jvm 有关（在我的情况下是这样）。尝试使用 -client 开关运行 eclipse。

在某些操作系统（我相信大多数 linux 发行版）中，默认选项是服务器 vm，当使用 gui 运行应用程序时，它会消耗更多的内存。

在我的例子中，初始内存占用从 300MB 下降到 80MB。

对不起我蹩脚的英语。我希望我有所帮助。

所有的问候 Arkadiusz Jamrocha

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-20T15:45:55.307

与其抱怨 Eclipse 占用了多少内存，不如继续分析问题出在哪里。我可能只是一个插件。

在此处查看博客： [“分析 eclipse 的内存消耗”](http://kohlerm.blogspot.com/2008/05/analyzing-memory-consumption-of-eclipse.html)

问候， 马库斯

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T16:55:41.390

RAM 相对便宜（并不是说这是内存管理不善的借口）。未使用的内存本质上是 WASTED 内存。如果您遇到限制并且 IDE 是问题，请考虑减少多任务处理、调整内存需求或购买更多。如果那是您的基本 IDE，我不会削弱 Eclipse。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T20:03:26.867

我通常为 Eclipse 提供 512 MB 的 RAM（使用 JVM 的 -Xmx 选项），而且我对 Ganymede 没有任何内存问题。几个月前我升级到了 2 GB 的 RAM，我真的可以推荐它。它制造了巨大的差异。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T16:52:01.210

好吧，您没有指定发生在哪个平台上。如果您使用的是 Windows XP、Vista、Linux、OS X，内存管理可能会有所不同...

通常，在我的计算机（带有 1Gb 内存的 WinXP）上，Eclipse 占用的空间很少超过 200Mb，这取决于打开的项目的大小、加载的插件和正在进行的操作。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2010-03-29T13:08:28.017

Eclipse 通常会在内存中保留大量元数据，以支持各种 IDE 操作。

我发现 Eclipse 的默认配置适用于大多数用途，并且包括对可以消耗多少内存的限制（由 JVM 显式或隐式给出），并且 Eclipse 将保持在该范围内。

您是否有任何特殊原因担心内存使用？

# python - 分布式python

> ID：94334
> 
> 赞同：6
> 
> 时间：2008-09-18T16:45:07.233
> 
> 标签：python, distributed

什么是创建分布式应用程序的最佳 Python 框架？例如构建一个 P2P 应用程序。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T17:18:53.063

我想你的意思是“网络应用程序”？分布式意味着可以通过网络在多个工作客户端之间分配其工作负载的应用程序。

你可能想要。 [扭曲的](http://twistedmatrix.com/trac/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-21T16:03:08.533

你可能想要[Twisted](http://twistedmatrix.com/trac/)。[Twisted 有一个名为“ Vertex](http://divmod.org/trac/wiki/DivmodVertex) ”的 P2P 框架。虽然没有积极维护，但它确实允许您通过 NAT 隧道并以非常抽象的方式直接在用户之间建立连接；如果对这类事情有更多的兴趣，我相信它会得到更积极的维护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T17:07:00.003

您可以签[出 pyprocessing](http://pyprocessing.berlios.de/)，它将包含在 2.6 的标准库中。它允许您使用类似于线程的 API 在多个进程上运行任务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:50:48.453

您可以为初学者下载 BitTorrent 的源代码，看看他们是如何做到的。

[http://download.bittorrent.com/dl/](http://download.bittorrent.com/dl/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T16:55:34.900

如果您需要大量线程并需要更好的并发性能，请查看[Stackless Python](http://www.stackless.com/)。否则，您可以只使用[SOAP](http://en.wikipedia.org/wiki/SOAP)或[XML-RPC](http://www.xmlrpc.com/)协议。针对 Ben 的帖子，如果您不想查看 BitTorrent 源代码，您可以查看有关[BitTorrent 协议](http://en.wikipedia.org/wiki/BitTorrent_(protocol))的文章。

# c# - C# 字符串操作搜索和替换

> ID：94342
> 
> 赞同：5
> 
> 时间：2008-09-18T16:46:14.657
> 
> 标签：c#, regex, string

我有一个字符串，其中包含表单中的标签`< tag >`。有没有一种简单的方法可以用特殊的 ascii 字符以编程方式替换这些标签的实例？例如用`"< tab >"`ascii 等价替换标签`'/t'`？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T16:48:43.417

```
string s = "...<tab>...";
s = s.Replace("<tab>", "\t"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T16:48:50.920

```
using System.Text.RegularExpressions;

Regex.Replace(s, "TAB", "\t");//s is your string and TAB is a tab. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T16:50:56.347

```
public static Regex regex = new Regex("< tab >", RegexOptions.CultureInvariant | RegexOptions.Compiled);
public static string regexReplace = "\t";
string result = regex.Replace(InputText,regexReplace); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:47:20.253

正则表达式模式应该可以解决问题。

# java - 你什么时候使用 Java 的 @Override 注解，为什么？

> ID：94361
> 
> 赞同：498
> 
> 时间：2008-09-18T16:48:26.740
> 
> 标签：java, annotations

`@Override`使用 Java注释 的最佳实践是什么？为什么？

`@Override`用注释标记每个被覆盖的方法似乎有点过头了。是否有某些编程情况需要使用，`@Override`而其他情况不应该使用`@Override`？

* * *

## 回答 #1

> 赞同：515
> 
> 时间：2008-09-18T16:53:19.833

每次重写方法时使用它有两个好处。这样做是为了您可以利用编译器检查来确保您实际上正在覆盖您认为的方法。这样，如果您犯了拼写错误的方法名称或未正确匹配参数的常见错误，您将被警告您的方法实际上并没有像您认为的那样覆盖。其次，它使您的代码更容易理解，因为当方法被覆盖时它会更加明显。

此外，在 Java 1.6 中，您可以使用它来标记方法何时实现接口以获得相同的好处。我认为最好有一个单独的注释（如`@Implements`），但总比没有好。

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2008-09-18T16:56:51.887

我认为它作为编译时提醒最有用的是该方法的目的是覆盖父方法。举个例子：

```
protected boolean displaySensitiveInformation() {
  return false;
} 
```

您经常会看到类似上述方法的内容，它覆盖了基类中的方法。这是该类的一个重要实现细节——我们不希望显示敏感信息。

假设这个方法在父类中改为

```
protected boolean displaySensitiveInformation(Context context) {
  return true;
} 
```

此更改不会导致任何编译时错误或警告 - 但它完全改变了子类的预期行为。

要回答您的问题：如果在超类中缺少具有相同签名的方法表明存在错误，则应使用 @Override 注释。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2008-09-18T18:40:02.200

这里有很多很好的答案，所以让我提供另一种方式来看待它......

编码时没有矫枉过正。键入@override 不会花费您任何费用，但是如果您拼错了方法名称或签名稍有错误，则可以节省大量资金。

可以这样想：在你导航到这里并输入这篇文章的时间里，你所用的时间几乎比你在余生中输入@override 所花费的时间还要多；但它防止的一个错误可以为您节省数小时。

Java 尽其所能确保您在编辑/编译时没有犯任何错误，这是一种几乎免费的方法来解决除了全面测试之外的任何其他方式都无法预防的整类错误。

您能否在 Java 中提出一种更好的机制来确保当用户打算覆盖一个方法时，他确实做到了？

另一个巧妙的效果是，如果您不提供注释，它会在编译时警告您不小心覆盖了父方法——如果您不打算这样做，这可能很重要。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-09-18T16:50:48.873

我总是使用标签。这是一个简单的编译时标志，可以捕捉我可能犯的小错误。

它会捕获类似的东西，`tostring()`而不是`toString()`

小事情有助于大型项目。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-09-18T16:54:08.087

使用`@Override`注解可以在编译时防止常见的编程错误。如果您在实际上没有覆盖超类方法的方法上有注释，它将引发编译错误。

这很有用的最常见情况是当您更改基类中的方法以具有不同的参数列表时。由于更改了方法签名，用于覆盖超类方法的子类中的方法将不再这样做。这有时会导致奇怪和意外的行为，尤其是在处理复杂的继承结构时。`@Override`注释可以防止这种情况。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-09-16T13:47:31.183

要利用编译器检查，您应该始终使用 Override 注释。但不要忘记，Java Compiler 1.5 在覆盖接口方法时不允许使用此注解。您可以使用它来覆盖类方法（抽象或非抽象）。

一些 IDE，如 Eclipse，即使配置了 Java 1.6 运行时或更高版本，它们仍保持与 Java 1.5 的合规性，并且不允许如上所述使用 @override。要避免这种行为，您必须转到：项目属性 -> Java 编译器 -> 选中“启用项目特定设置” -> 选择“编译器合规级别”= 6.0 或更高。

如果基础是接口或类，我每次独立覆盖方法时都喜欢使用此注释。

这可以帮助您避免一些典型的错误，例如当您认为您正在覆盖事件处理程序时，您会发现什么也没有发生。想象一下，你想给某个 UI 组件添加一个事件监听器：

```
someUIComponent.addMouseListener(new MouseAdapter(){
  public void mouseEntered() {
     ...do something...
  }
}); 
```

上面的代码编译并运行，但是如果你在 someUIComponent 中移动鼠标，“做某事”的代码将会运行，因为实际上你并没有覆盖基方法`mouseEntered(MouseEvent ev)`。您只需创建一个新的无参数方法`mouseEntered()`。如果您使用了`@Override`注释而不是该代码，那么您会看到一个编译错误，并且您没有浪费时间思考为什么您的事件处理程序没有运行。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-18T18:00:51.140

最好将它用于每个打算作为覆盖的方法，以及 Java 6+，每个方法都打算作为接口的实现。

首先，它会在编译时捕获像“ `hashcode()`”而不是“ ”这样的拼写错误。`hashCode()`当真正的原因是您的代码从未被调用时，调试为什么您的方法的结果似乎与您的代码不匹配可能会令人费解。

此外，如果超类更改方法签名，则旧签名的覆盖可能是“孤立的”，留下令人困惑的死代码。注释将`@Override`帮助您识别这些孤儿，以便可以修改它们以匹配新签名。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-09-02T14:44:36.663

*接口实现*上的@Override不一致，因为在 java 中没有“覆盖接口”之类的东西。

*接口实现*上的@Override是无用的，因为实际上它不会捕获编译无论如何都不会捕获的错误。只有一种牵强附会的场景，实现者的覆盖实际上做了一些事情：如果您实现了一个接口，并且接口 REMOVES 方法，您将在编译时收到通知，您应该删除未使用的实现。请注意，如果新版本的接口具有 NEW 或 CHANGED 方法，那么您显然会得到一个编译错误，因为您没有实现新的东西。

在 1.6 中，接口实现者上的 @Override 绝不应该被允许，而且 Eclipse 遗憾地选择自动插入注释作为默认行为，我们得到了很多杂乱的源文件。阅读 1.6 代码时，您无法从 @Override 注解中看到一个方法实际上是覆盖了超类中的方法还是只是实现了一个接口。

在实际覆盖超类中的方法时使用 @Override 很好。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-09-18T16:54:25.400

如果您发现自己经常覆盖（非抽象）方法，您可能想看看您的设计。当编译器不会捕获错误时，它非常有用。例如尝试覆盖 ThreadLocal 中的 initValue()，我已经这样做了。

在实现接口方法（1.6+ 功能）时使用 @Override 对我来说似乎有点矫枉过正。如果你有很多方法，其中一些覆盖而另一些没有覆盖，那可能又是糟糕的设计（如果你不知道，你的编辑器可能会显示哪个是哪个）。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-09-18T17:37:33.783

接口上的@Override 实际上很有帮助，因为如果您更改接口，您会收到警告。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-09-18T18:41:25.580

它所做的另一件事是，它在阅读代码时更明显地表明它正在改变父类的行为。比可以帮助调试。

此外，在 Joshua Block 的《Effective Java》（第 2 版）一书中，第 36 项提供了有关注释好处的更多详细信息。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-09-18T16:50:56.970

每当一个方法覆盖另一个方法，或者一个方法在接口中实现签名时。

注释向`@Override`您保证您确实覆盖了某些东西。如果没有注释，您可能会出现拼写错误或参数类型和编号的差异。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2010-01-27T01:53:26.073

在实现接口方法时使用@Override 绝对没有意义。在这种情况下使用它没有任何好处——编译器已经发现了你的错误，所以它只是不必要的混乱。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2008-09-18T16:49:48.017

我每次都用它。当我在一年内重新访问代码时，我可以使用更多信息来快速弄清楚发生了什么，而我已经忘记了我第一次在想什么。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2008-09-18T16:54:45.820

最好的做法是始终使用它（或让 IDE 为您填充它们）

@Override 的用处是检测父类中尚未报告到层次结构中的更改。没有它，您可以更改方法签名而忘记更改其覆盖，使用@Override，编译器会为您捕获它。

拥有这种安全网总是很好的。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2008-09-18T17:49:37.873

我到处都用它。关于标记方法的工作，我让 Eclipse 为我做，所以没有额外的工作。

我热衷于持续重构……所以，我会用每一件小事让它更顺利地进行。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2009-10-02T16:45:54.960

*   仅用于方法声明。
*   指示带注释的方法声明覆盖超类型中的声明。

*如果始终使用它，它可以保护您免受一大类恶意错误的侵害。*

使用@Override 注解来避免这些错误：（在以下代码中找出错误：）

```
public class Bigram {
    private final char first;
    private final char second;
    public Bigram(char first, char second) {
        this.first  = first;
        this.second = second;
    }
    public boolean equals(Bigram b) {
        return b.first == first && b.second == second;
    }
    public int hashCode() {
        return 31 * first + second;
    }

    public static void main(String[] args) {
        Set<Bigram> s = new HashSet<Bigram>();
        for (int i = 0; i < 10; i++)
            for (char ch = 'a'; ch <= 'z'; ch++)
                s.add(new Bigram(ch, ch));
        System.out.println(s.size());
    }
} 
```

来源：[有效的Java](http://my.safaribooksonline.com/9780137150021/ch06lev1sec7)

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2010-05-10T16:30:42.700

使用Override的时候要小心，因为以后不能在starUML中做逆向工程；首先制作uml。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-11-07T00:35:47.160

看来这里的智慧正在发生变化。今天我安装了[IntelliJ IDEA](http://www.jetbrains.com/idea/) 9 并注意到它的“[缺少 @Override 检查](http://www.jetbrains.com/idea/documentation/inspections.jsp)”现在不仅捕获了已实现的抽象方法，还捕获了已实现的接口方法。在我雇主的代码库和我自己的项目中，我很早就习惯于只对前者使用 @Override —— 实现了抽象方法。然而，重新思考这个习惯，在这两种情况下使用注释的优点变得清晰起来。尽管更加冗长，但它确实可以防止接口方法名称发生变化的*脆弱基类*问题（不像 C++ 相关示例那么严重），从而在派生类中孤立可能实现的方法。

当然，这种情况大多是夸张的；派生类将不再编译，现在缺少重命名接口方法的实现，今天可能会使用*重命名方法*重构操作来处理整个代码库。

鉴于 IDEA 的检查不可配置为忽略已实现的接口方法，今天我将改变我的习惯和团队的代码审查标准。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-11-25T08:31:28.493

注解@Override 用于帮助检查开发人员是否在父类或接口中重写了正确的方法。当 super 的方法名称发生变化时，编译器会通知这种情况，这只是为了保持与 super 和子类的一致性。

顺便说一句，如果我们没有在子类中声明注解@Override，但我们确实覆盖了super 的某些方法，那么该函数可以与@Override 一样工作。但是当super的方法改变时，这个方法不能通知开发者。因为它不知道开发者的目的——重写super的方法还是定义一个新的方法？

所以当我们想要重写该方法以利用多态性时，我们最好在方法上方添加@Override。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-03-29T15:34:51.660

我尽可能多地使用它来识别方法何时被覆盖。如果您查看 Scala 编程语言，它们也有一个 override 关键字。我觉得它很有用。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-18T16:51:12.087

它确实允许您（好吧，编译器）在您对要覆盖的方法名称使用错误拼写时进行捕捉。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-12-03T21:43:35.157

很简单——当你想要覆盖超类中的方法时，使用`@Override`注解来进行正确的覆盖。如果您没有正确覆盖它，编译器会警告您。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2010-05-18T06:06:28.673

覆盖注解用于利用编译器，检查您是否真的覆盖了父类中的方法。它用于通知您是否犯了任何错误，例如拼写错误的方法名，错误匹配参数的错误

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2010-12-03T05:55:05.410

我认为最好在允许的情况下对@override 进行编码。它有助于编码。但是，需要注意的是，对于 ecipse Helios，无论是 sdk 5 还是 6，都允许实现接口方法的 @override 注释。至于 Galileo，无论是 5 还是 6，都不允许使用 @override 注解。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2011-11-22T06:40:52.653

注释确实为编译器提供了有关代码的元数据，并且当我们覆盖基类的任何方法时，注释@Override 用于继承的情况。它只是告诉编译器您正在覆盖方法。它可以避免我们可以做的一些常见错误，例如不遵循方法的正确签名或方法名称拼写错误等。因此使用@Override注解是一个好习惯。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2012-01-16T03:16:54.773

对我来说，@Override 确保我拥有正确的方法签名。如果我输入注释并且方法拼写不正确，那么编译器会抱怨让我知道有问题。

# time - 计算flash中经过的时间

> ID：94372
> 
> 赞同：3
> 
> 时间：2008-09-18T16:49:14.883
> 
> 标签：time, elapsed

我正在做一个测验，我需要计算做这个测验的总时间。我需要显示在 HH::MM::SS 中花费的时间..任何指针？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T16:54:53.857

new Date().time 以毫秒为单位返回时间。

```
var nStart:Number = new Date().time;

// Some time passes

var nMillisElapsed:Number = new Date().time - nStart;

var strTime:String = Math.floor(nMillisElapsed / (1000 * 60 * 60)) + "::" + 
   (Math.floor(nMillisElapsed / (1000 * 60)) % 60) + "::" + 
   (Math.floor(nMillisElapsed / (1000)) % 60); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-09T08:10:50.867

我复活这个问题说Brian和mica都错了。创建一个新的 Date() 根据计算机的时钟为您提供时间。所有人所要做的就是将时钟拨回几分钟，这将导致测验计时器也拨回几分钟。或者更糟的是，他们可以将时钟调回开始测验之前的时间，而您的应用程序会认为他们在参加测验上花费的时间是负数。oO

解决方案是使用 flash.utils.getTimer()。它返回自 swf 开始播放以来的毫秒数，无论计算机时钟显示什么。

这是一个例子：

```
var startTime:Number = getTimer();

// then after some time passes:

var elapsedMilliseconds:Number = getTimer() - startTime; 
```

然后你可以使用 Brian 的代码来格式化显示时间：

```
var strTime:String = Math.floor(elapsedMilliseconds / (1000 * 60 * 60)) + "::" + 
(Math.floor(elapsedMilliseconds / (1000 * 60)) % 60) + "::" + 
(Math.floor(elapsedMilliseconds / (1000)) % 60); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-16T09:01:28.693

当数字小于 10 时填充零（感谢 brian）

```
var now:Date; //
var startDate:Date;
var startTime:Number; 
// initialize timer and start it
function initTimer():void{
    startDate = new Date();
    startTime = startDate.getTime();
    //
    var timer:Timer = new Timer(1000,0); // set a new break
        timer.addEventListener(TimerEvent.TIMER, onTimer); // add timer listener
    //
    function onTimer():void{
        now=new Date();
        var nowTime:Number = now.getTime();
        var diff:Number = nowTime-startTime;
        var strTime:String = Math.floor(diff / (1000 * 60 * 60)) + ":" + 
                            zeroFill(Math.floor(diff / (1000 * 60)) % 60) + ":" + 
                            zeroFill(Math.floor(diff / (1000)) % 60);
        // display where you want
        trace('time elapsed : ' + strTime);
    }
    // fill with zero when number is less than 10
    function zeroFill(myNumber:Number):String{
        var zeroFilledNumber:String=myNumber.toString();
        if(myNumber<10){
            zeroFilledNumber = '0'+zeroFilledNumber;
        }
        return zeroFilledNumber;
    }

    // start TIMER
    timer.start();

}
initTimer(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-17T17:22:56.657

```
var countdown:Timer = new Timer(1000);
countdown.addEventListener(TimerEvent.TIMER, timerHandler);
countdown.start();

function timerHandler(e:TimerEvent):void
{           
    var minute = Math.floor(countdown.currentCount /  60);
    if(minute < 10)
        minute = '0'+minute;

    var second = countdown.currentCount % 60;
    if(second < 10)
        second = '0'+second;

    var timeElapsed = minute +':'+second;
    trace(timeElapsed);
} 
```

# c++ - XP/Vista 的音量（平衡）控制

> ID：94380
> 
> 赞同：3
> 
> 时间：2008-09-18T16:50:09.500
> 
> 标签：c++, windows, windows-vista, audio

有没有一种方法可以在 XP 和 Vista 上控制 Wave 输出的平衡？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T20:41:52.140

Vista 为与混音器和音频相关的所有内容提供了一个新 api，每个进程的旧 api 应该仍然有效，但是要更改全局音量，您必须查看添加到 Vista 中的新 COM 接口

[这](http://www.codeproject.com/KB/vista/CoreAudio.aspx)应该让你开始

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T19:43:22.483

你看过这个吗？

> waveOutSetVolume
> 
> waveOutSetVolume 函数设置指定波形音频输出设备的音量。

它使用 Winmm.lib。 [http://msdn.microsoft.com/en-us/library/ms713762.aspx](http://msdn.microsoft.com/en-us/library/ms713762.aspx)

# vim - 带有 Powershell 的 Vim

> ID：94382
> 
> 赞同：56
> 
> 时间：2008-09-18T16:50:26.190
> 
> 标签：vim, powershell

我在 Windows 上使用 gvim。

在我的 _vimrc 中，我添加了：

```
set shell=powershell.exe
set shellcmdflag=-c
set shellpipe=>
set shellredir=>

function! Test()
  echo system("dir -name")
endfunction

command! -nargs=0 Test :call Test() 
```

如果我执行此函数 (:Test)，我会看到无意义的字符（非数字/字母 ASCII 字符）。

如果我使用 cmd 作为 shell，它可以工作（没有 -name），所以问题似乎是从 powershell 获取输出到 vim。

有趣的是，这很好用：

```
:!dir -name 
```

就像这样：

```
:r !dir -name 
```

**更新：** 确认[大卫提到的行为](https://stackoverflow.com/questions/94382/vim-with-powershell#101743)

如果在 _vimrc 中执行上面提到的 set 命令，:Test 会输出废话。但是，如果您直接在 vim 中而不是在 _vimrc 中执行它们， :Test 将按预期工作。

另外，我尝试使用 iconv 以防它是编码问题：

```
:echo iconv( system("dir -name"), "unicode", &enc ) 
```

但这没有任何区别。不过，我可能使用了错误的编码类型。

任何人都知道如何使这项工作？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-08-05T21:38:59.793

这有点 hack，但以下在 Vim 7.2 中有效。请注意，我在 CMD 会话中运行 Powershell。

```
if has("win32")
    set shell=cmd.exe
    set shellcmdflag=/c\ powershell.exe\ -NoLogo\ -NoProfile\ -NonInteractive\ -ExecutionPolicy\ RemoteSigned
    set shellpipe=|
    set shellredir=>
endif

function! Test()
  echo system("dir -name")
endfunction 
```

通过以下测试...

*   `:!dir -name`
*   `:call Test()`

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-10-20T03:16:18.917

我在这里遇到了许多人描述的类似问题。

具体来说，调用

```
:set shell=powershell 
```

从 vim 中手动操作会导致 powershell 正常工作，但只要我添加：

```
set shell=powershell 
```

在我的 vimrc 文件中，我会收到错误“无法打开临时文件....”

问题是，默认情况下，当修改 shell 时，vim 会自动将 shellxquote 设置为 "，这意味着 shell 命令将如下所示：

```
 powershell -c "cmd > tmpfile" 
```

这个命令需要看起来像这样，以便 vim 读取临时文件：

```
 powershell -c "cmd" > tmpfile 
```

在我的 vimrc 文件中将 shellquote 设置为 " 并取消设置 shellxquote (即将其设置为空白) 似乎可以解决我的所有问题：

```
set shell=powershell
set shellcmdflag=-c
set shellquote=\"
set shellxquote= 
```

我也尝试过更进一步，并使用 system() 调用编写 vim 脚本： [system() with powershell in vim](https://stackoverflow.com/questions/7605917/system-with-powershell-in-vim)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-01-04T13:20:57.547

我怀疑问题在于 Powershell 使用 .NET 的本机字符串编码，即 UTF-16 加上字节顺序标记。

当它在命令之间传递对象时，这不是问题。不过，对于外部程序来说，这是一个完整的 PITA。

您可以通过输出文件通过管道输出输出，该输出文件支持更改编码，但仍会为默认情况下所在的终端格式化输出（啊！），因此“Get-Process”之类的内容将用省略号等截断。您可以指定 Out-File 使用的虚拟终端的宽度。

不确定这些信息有多大用处，但它确实更能说明问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T17:29:43.803

尝试更换

```
"dir \*vim\*" 
```

和

```
 " -command { dir \*vim\* }" 
```

**编辑：**尝试使用 cmd.exe 作为 shell 并将“powershell.exe”放在“-command”之前

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T13:19:10.830

有趣的问题 - 这里还有一些东西会增加混乱。如果我在 gvim 中运行以下命令，则无需对我的 .vimrc 文件进行任何更改：

```
:set shell=powershell.exe
:set shellcmdflag=-noprofile
:echo system("dir -name") 
```

它的行为符合预期！

如果我对我的 .vimrc 文件进行相同的更改（shell 和 shellcmdflag 选项），运行 :echo system("dir -name") 会返回无意义的字符！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-29T17:31:22.777

当我把它放在 vimrc 中时，最初的示例代码对我来说很好。

所以现在我想弄清楚我的 vimrc 是什么使它起作用。可能：

```
set encoding=utf8 
```

**编辑**：是的，这似乎做到了。无论如何，这些天你可能希望 VIM 默认为 unicode ......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-11-16T22:08:16.077

[在我从https://github.com/dougireton/mirror_pond/blob/master/vimrc](https://github.com/dougireton/mirror_pond/blob/master/vimrc)找到这个提示之前，此页面上的所有答案都没有为我工作- set shellxquote= [space character] 是缺失的部分。

```
if has("win32") || has("gui_win32") 
     if executable("PowerShell") 
        " Set PowerShell as the shell for running external ! commands 
        " http://stackoverflow.com/questions/7605917/system-with-powershell-in-vim      
        set shell=PowerShell 
        set shellcmdflag=-ExecutionPolicy\ RemoteSigned\ -Command 
        set shellquote=\" 
        " shellxquote must be a literal space character. 
        set shellxquote=  
   endif 
endif 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-01-23T01:05:51.977

结合这个和相关线程中的答案，将以下内容添加到您从巧克力`$profile`安装的假设中：`diffutils`

```
Remove-Item Alias:diff -force 
```

并将以下内容添加到您的`~/.vimrc`：

```
if (has('win32') || has('gui_win32')) && executable('pwsh')
    set shell=pwsh
    set shellcmdflag=\ -ExecutionPolicy\ RemoteSigned\ -NoProfile\ -Nologo\ -NonInteractive\ -Command
endif 
```

**确保`shellcmdflag`完全如图所示**

这些解决方案的所有功劳归功于各自的贡献者，这只是一个汇总帖子。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-03T21:14:12.707

我提出了一个骇人听闻的解决方案。它并没有真正解决问题，但它以某种方式完成了工作。

这个[Vim 插件](http://www.vim.org/scripts/script.php?script_id=2837)自动创建临时脚本文件，通过 cmd.exe 调用 powershell 并粘贴结果。它不如 vim 正确处理 powershell 好，但它可以工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-16T07:58:42.090

试试吧 `set shellcmdflag=\ -c`

* * *

解释：

Vim 使用 tempname() 生成一个由 system() 读取的临时文件路径。

如果 &shell 包含 'sh' 并且 &shellcmdflag 以 '-' 开头，则 tempname() 生成带有正斜杠的临时文件路径。

因此，如果这样， `set shell=powershell set shellcmdflag=-c` Vim 将尝试读取一个带有无法找到的正斜杠的临时文件。

一个补救措施是改为设置 `set shellcmdflag=\ -c` ，即在 &shellcmdflag 中添加一个空格，以便第一个字符不再是“-”，并且 tempname() 会生成一个带有反斜杠的临时文件路径，该路径可以由 system() 找到。

* * *

我在 vim_dev 邮件列表 ( [https://groups.google.com/forum/#!topic/vim_dev/vTR05EZyfE0](https://groups.google.com/forum/#!topic/vim_dev/vTR05EZyfE0) ) 上评论说，这值得更好的文档。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-02-01T12:40:23.907

[actf](https://stackoverflow.com/users/205836/actf) answer 对我有用，但由于 Powershell 内置 DIFF（与 Linux 不同），您必须将此行添加到您的 Powershell 配置文件中，以使 diff 在 VIM 中再次工作：

```
Remove-Item Alias:diff -force 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-02-18T13:32:23.473

我正在运行 GVim v8.2 (Windows)。

使用可执行文件的完整路径对我有用：

```
set shell=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-09-18T18:02:24.787

我不使用 VIM，但 Powershell 的默认输出是 Unicode。记事本可以读取 unicode，您可以使用它来查看是否获得了预期的输出。

# .net - Windsor 拦截器 AOP 和缓存

> ID：94410
> 
> 赞同：7
> 
> 时间：2008-09-18T16:53:14.170
> 
> 标签：.net, castle-windsor, aop

我正在考虑使用 Castle Windsor 的拦截器来缓存数据以帮助扩展 asp.net 站点。

有没有人对此有任何想法/经验？

小说明：我的意图是使用 Windsor 来拦截“昂贵”的调用，并将缓存本身委托给 MemCacheD 或 Velocity（或另一个分布式缓存）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T13:23:33.523

嘿，我们使用了温莎城堡拦截器，基于这篇文章：[http](http://www.davidhayden.com/blog/dave/archive/2007/03/14/CastleWindsorAOPPolicyInjectionApplicationBlock.aspx) ://www.davidhayden.com/blog/dave/archive/2007/03/14/CastleWindsorAOPPolicyInjectionApplicationBlock.aspx以及上面提到的那个。

我发现整个事情很简单，这是一种非常优雅的 AOP 方式。然而....

不过要小心性能。使用拦截会创建一个动态代理，这肯定会减慢速度。根据我们使用 500 节点计算场的基准测试，我们发现在 Windsor 中使用拦截会降低大约 30% 的性能，这超出了我们在拦截内部所做的工作（本质上是记录方法调用和传递给我们的方法的参数） . 并且简单地删除拦截加速了整个应用程序。

小心你不要让你的昂贵电话*真的*很贵。:) 如果我是你，我会寻找不同级别的缓存，可能是通过实现 IRepository 类型模式，然后在适当的情况下使用各种缓存策略来支持它。

祝你好运，

——
马特。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T04:59:54.170

我一直在 Windsor 中使用缓存装饰器（不是拦截器），它们工作得很好。

拦截器对此也有好处，例如看到[这个。](http://ayende.com/Blog/archive/2007/03/11/AOP-With-Windsor-Adding-Caching-to-IRepositoryT-based-on-Ts.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T17:29:52.430

您是如何实现数据访问的？如果你使用 NHibernate，我建议在这里缓存。NHibernate 带有用于 .NET 内置缓存、memcached（通过 NMemcachD）和 Velocity 的缓存策略。我已经将 memcached 广泛用于企业级应用程序，并且没有遇到任何问题。

基于拦截器的缓存机制是一个有趣的想法，我以前没有想到过。透明地应用将非常容易。我认为我喜欢使用 Castle 的 AOP 功能的一个原因是因为它是基于代理的，你不必用属性污染你的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T17:15:06.350

我会看看[Microsoft Velocity](http://msdn.microsoft.com/en-us/data/cc655792.aspx)。如果您计划创建企业应用程序，这可能是一个很好的解决方案

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-29T00:27:41.590

**我在名为cachew.castlewindsor**的开源项目上创建了一个带有缓存拦截器的项目。它是一种通用的缓存解决方案。

下面是一个简单的用法示例：

`var container = new WindsorContainer(); container.Register(Component.For<CacheInterceptor>() .Instance(new CacheInterceptor(new Cache(TimeoutStyle.RenewTimoutOnQuery, TimeSpan.FromSeconds(3))))); container.Register(Component.For<IServer>().ImplementedBy<Server>().Interceptors<CacheInterceptor>());`

默认行为是缓存所有以 Get 开头的方法并返回数据，但您也可以更改要缓存的前缀。

该项目在 nuget 上可用： [http ://www.nuget.org/packages/Cachew.CastleWindsor/](http://www.nuget.org/packages/Cachew.CastleWindsor/)

源代码在这里： [https ://github.com/kobbikobb/Cachew](https://github.com/kobbikobb/Cachew)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-18T17:02:01.700

Windsor 很棒，但是当您有多种内置方法来缓存数据时，为什么还要使用它来缓存。温莎在其他领域有其基础，不一定是缓存。从缓存对象到会话再到 cookie。有很多方法可以缓存。更重要的是，在大型应用程序中，您最终需要分布式缓存。MS 正在为此开发一种产品，并且有几个很好的供应商在市场上有产品。

# sharepoint - Infopath 2007 - 通过电子邮件发送的表单无法正确呈现

> ID：94420
> 
> 赞同：5
> 
> 时间：2008-09-18T16:54:09.020
> 
> 标签：sharepoint, email, forms, rendering, infopath

所以我有一个通过共享点使用信息路径服务的表单，并且在多次尝试修复渲染问题（表格看起来太宽而无法阅读）之后，我想我发现了问题：日期控制。

Infopath 2007 中的日期控件似乎以某种方式渲染。为了测试，我制作了一个非常简单的表单的 2 个变体——一个带有日期控件，一个带有文本控件——并将它们放在一个表格中。

通过电子邮件发送时，带有日期控件的那个显示不正确。

我的问题是 - 以前有没有人经历过这种情况？如果你有时间，测试一下。我认为这是一个错误或什么，但不完全确定。

我正在使用 Infopath 2007、Sharepoint 2007 和 Outlook 2007。

* * *

## **2008 年 9 月 19 日更新**

是的，已检查 Web 表单功能。网络兼容的日期控制？我想是的 - 在浏览器中一切看起来都很完美......只有电子邮件搞砸了。是的，你是对的。我的错误是 Sharepoint 2007。我在上面修复了它。

如果有人有时间，请尝试一下 - 不得不使用文本框来显示日期是非常令人沮丧的。尤其是我们这里的“人才”。哈哈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T21:25:17.157

Could be the same issue I had(or maybe not)...InfoPath cache's the form on the client(seems to check for the form’s unique URN in the cache) which means that if you attempt to click on the email “Edit this task…” the new form is not downloaded, instead the InfoPath form from the cache is displayed.

Run the following on your cmd window to verify this...and post your findings here

"C:\Program Files\Microsoft Office\Office12\INFOPATH.EXE" /cache clearall

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T00:53:14.017

您是否在所有必要的地方检查了 Web 表单的兼容性？您是否使用网络兼容的日期控件？您确定您使用的是 SharePoint 2003，我认为 Form Services 是 2007 年的更新。

# openssl - 使用 OpenSSL “无法写入‘随机状态’”是什么意思？

> ID：94445
> 
> 赞同：422
> 
> 时间：2008-09-18T16:56:43.447
> 
> 标签：openssl

我正在生成一个自签名 SSL 证书来保护我的服务器的管理部分，并且我不断从 OpenSSL 收到此消息：

> 无法写入“随机状态”

这是什么意思？

这是在 Ubuntu 服务器上。我已升级 libssl 以修复[最近的安全漏洞](http://www.ubuntu.com/usn/usn-612-1)。

* * *

## 回答 #1

> 赞同：569
> 
> 时间：2008-09-18T16:58:48.840

实际上，发生这种情况的最常见原因似乎是您的主目录中的 .rnd 文件归 root 而非您的帐户所有。快速修复：

```
sudo rm ~/.rnd 
```

有关更多信息，请参阅[OpenSSL 常见问题解答](http://www.openssl.org/support/faq.html#USER2)中的条目：

> 有时，openssl 命令行实用程序不会中止并显示“PRNG 未播种”错误消息，而是抱怨它“无法写入'随机状态'”。此消息指的是默认种子文件（请参阅上一个答案）。一个可能的原因是不知道默认文件名，因为 RANDFILE 和 HOME 都没有设置。（在这种情况下，最高 0.9.6 的版本在当前目录中使用了文件“.rnd”，但在 0.9.6a 中已更改。）

所以我会检查 RANDFILE、HOME 和写入文件系统中这些位置的权限。

如果一切似乎都井然有序，您可以尝试使用[strace](http://en.wikipedia.org/wiki/Strace)运行，看看到底发生了什么。

* * *

## 回答 #2

> 赞同：283
> 
> 时间：2011-11-21T18:25:23.183

我知道这个问题是在 Linux 上，但在 Windows 上我也有同样的问题。事实证明，您必须在“以管理员身份运行”模式下启动命令提示符才能使其工作。否则你会得到同样的结果：无法写入“随机状态”错误。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2012-04-25T13:23:07.273

Windows 平台上的另一个问题，请确保您以管理用户身份运行命令提示符！

这不知道咬了我多少次...

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-09-18T17:09:51.370

显然，我需要以 root 身份运行 OpenSSL 才能获得种子文件的权限。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-06-26T14:34:30.843

我在 Windows 服务器上有同样的事情。然后我通过改变`vars.bat`这是：

```
set HOME=C:\Program Files (x86)\OpenVPN\easy-rsa 
```

然后从头开始重做，一切都应该没问题。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-01-16T21:19:03.857

您应该设置 $RANDFILE 环境变量和/或创建 $HOME/.rnd 文件。（[OpenSSL 常见问题解答](https://www.openssl.org/docs/faq.html#LEGAL2)）。*（当然，您应该拥有该文件的权利。这里的其他答案是关于此的。但首先您应该拥有该文件和对它的引用。）*

直到 0.9.6 版本，OpenSSL 将种子文件写入当前目录的文件“.rnd”中。在 0.9.6a 版本中，您没有默认的种子文件。OpenSSL 0.9.6b 及更高版本的行为与 0.9.6a 类似，但如果尚未设置环境变量，则会在 Windows 系统上为 HOME 使用默认值“C:\”。

如果默认种子文件不存在或太短，则可能会出现“PRNG 未种子”错误消息。

$RANDFILE 环境变量和 $HOME/.rnd 仅由 OpenSSL 命令行工具使用。使用 OpenSSL 库的应用程序提供了自己的配置选项来指定熵源，请查看应用程序随附的文档。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2020-01-13T11:07:27.213

我今天在 AWS Lambda 上遇到了这个问题。我创建了一个环境变量 RANDFILE = /tmp/.random

那成功了。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-04-04T10:26:42.150

对我来说，问题是我的主目录中有 .rnd，但它归根用户所有。删除它并重新发出 openssl 命令修复了这个问题。

# c# - 从 System.Drawing.Bitmap 加载 WPF BitmapImage

> ID：94456
> 
> 赞同：236
> 
> 时间：2008-09-18T16:58:32.490
> 
> 标签：c#, wpf, bitmap

我有一个 a 的实例，`System.Drawing.Bitmap`并希望以`System.Windows.Media.Imaging.BitmapImage`.

最好的方法是什么？

* * *

## 回答 #1

> 赞同：272
> 
> 时间：2009-07-01T14:39:47.517

从 MemoryStream 加载它怎么样？

```
using(MemoryStream memory = new MemoryStream())
{
    bitmap.Save(memory, ImageFormat.Png);
    memory.Position = 0;
    BitmapImage bitmapImage = new BitmapImage();
    bitmapImage.BeginInit();
    bitmapImage.StreamSource = memory;
    bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
    bitmapImage.EndInit();
} 
```

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2008-09-18T20:19:53.270

感谢 Hallgrim，这是我最终得到的代码：

```
ScreenCapture = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(
   bmp.GetHbitmap(), 
   IntPtr.Zero, 
   System.Windows.Int32Rect.Empty, 
   BitmapSizeOptions.FromWidthAndHeight(width, height)); 
```

我也最终绑定到 BitmapSource 而不是 BitmapImage ，就像我原来的问题一样

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2009-09-24T07:11:37.383

我知道这已经得到解答，但这里有几个扩展方法（用于 .NET 3.0+）进行转换。:)

```
 /// <summary>
    /// Converts a <see cref="System.Drawing.Image"/> into a WPF <see cref="BitmapSource"/>.
    /// </summary>
    /// <param name="source">The source image.</param>
    /// <returns>A BitmapSource</returns>
    public static BitmapSource ToBitmapSource(this System.Drawing.Image source)
    {
        System.Drawing.Bitmap bitmap = new System.Drawing.Bitmap(source);

        var bitSrc = bitmap.ToBitmapSource();

        bitmap.Dispose();
        bitmap = null;

        return bitSrc;
    }

    /// <summary>
    /// Converts a <see cref="System.Drawing.Bitmap"/> into a WPF <see cref="BitmapSource"/>.
    /// </summary>
    /// <remarks>Uses GDI to do the conversion. Hence the call to the marshalled DeleteObject.
    /// </remarks>
    /// <param name="source">The source bitmap.</param>
    /// <returns>A BitmapSource</returns>
    public static BitmapSource ToBitmapSource(this System.Drawing.Bitmap source)
    {
        BitmapSource bitSrc = null;

        var hBitmap = source.GetHbitmap();

        try
        {
            bitSrc = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(
                hBitmap,
                IntPtr.Zero,
                Int32Rect.Empty,
                BitmapSizeOptions.FromEmptyOptions());
        }
        catch (Win32Exception)
        {
            bitSrc = null;
        }
        finally
        {
            NativeMethods.DeleteObject(hBitmap);
        }

        return bitSrc;
    } 
```

和 NativeMethods 类（安抚 FxCop）

```
 /// <summary>
/// FxCop requires all Marshalled functions to be in a class called NativeMethods.
/// </summary>
internal static class NativeMethods
{
    [DllImport("gdi32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    internal static extern bool DeleteObject(IntPtr hObject);
} 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2011-07-21T11:12:36.047

我花了一些时间让转换双向工作，所以这是我想出的两种扩展方法：

```
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Windows.Media.Imaging;

public static class BitmapConversion {

    public static Bitmap ToWinFormsBitmap(this BitmapSource bitmapsource) {
        using (MemoryStream stream = new MemoryStream()) {
            BitmapEncoder enc = new BmpBitmapEncoder();
            enc.Frames.Add(BitmapFrame.Create(bitmapsource));
            enc.Save(stream);

            using (var tempBitmap = new Bitmap(stream)) {
                // According to MSDN, one "must keep the stream open for the lifetime of the Bitmap."
                // So we return a copy of the new bitmap, allowing us to dispose both the bitmap and the stream.
                return new Bitmap(tempBitmap);
            }
        }
    }

    public static BitmapSource ToWpfBitmap(this Bitmap bitmap) {
        using (MemoryStream stream = new MemoryStream()) {
            bitmap.Save(stream, ImageFormat.Bmp);

            stream.Position = 0;
            BitmapImage result = new BitmapImage();
            result.BeginInit();
            // According to MSDN, "The default OnDemand cache option retains access to the stream until the image is needed."
            // Force the bitmap to load right now so we can dispose the stream.
            result.CacheOption = BitmapCacheOption.OnLoad;
            result.StreamSource = stream;
            result.EndInit();
            result.Freeze();
            return result;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-18T17:01:06.837

最简单的事情是如果您可以直接从文件制作 WPF 位图。

否则，您将不得不使用 System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2011-09-12T15:35:17.617

```
// at class level;
[System.Runtime.InteropServices.DllImport("gdi32.dll")]
public static extern bool DeleteObject(IntPtr hObject);    // https://stackoverflow.com/a/1546121/194717

/// <summary> 
/// Converts a <see cref="System.Drawing.Bitmap"/> into a WPF <see cref="BitmapSource"/>. 
/// </summary> 
/// <remarks>Uses GDI to do the conversion. Hence the call to the marshalled DeleteObject. 
/// </remarks> 
/// <param name="source">The source bitmap.</param> 
/// <returns>A BitmapSource</returns> 
public static System.Windows.Media.Imaging.BitmapSource ToBitmapSource(this System.Drawing.Bitmap source)
{
    var hBitmap = source.GetHbitmap();
    var result = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(hBitmap, IntPtr.Zero, System.Windows.Int32Rect.Empty, System.Windows.Media.Imaging.BitmapSizeOptions.FromEmptyOptions());

    DeleteObject(hBitmap);

    return result;
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-09-29T10:42:03.773

您可以通过编写自定义位图源在两个命名空间（媒体和绘图）之间共享像素数据。转换将立即发生，不会分配额外的内存。如果您不想显式创建位图的副本，这就是您想要的方法。

```
class SharedBitmapSource : BitmapSource, IDisposable
{
    #region Public Properties

    /// <summary>
    /// I made it public so u can reuse it and get the best our of both namespaces
    /// </summary>
    public Bitmap Bitmap { get; private set; }

    public override double DpiX { get { return Bitmap.HorizontalResolution; } }

    public override double DpiY { get { return Bitmap.VerticalResolution; } }

    public override int PixelHeight { get { return Bitmap.Height; } }

    public override int PixelWidth { get { return Bitmap.Width; } }

    public override System.Windows.Media.PixelFormat Format { get { return ConvertPixelFormat(Bitmap.PixelFormat); } }

    public override BitmapPalette Palette { get { return null; } }

    #endregion

    #region Constructor/Destructor

    public SharedBitmapSource(int width, int height,System.Drawing.Imaging.PixelFormat sourceFormat)
        :this(new Bitmap(width,height, sourceFormat) ) { }

    public SharedBitmapSource(Bitmap bitmap)
    {
        Bitmap = bitmap;
    }

    // Use C# destructor syntax for finalization code.
    ~SharedBitmapSource()
    {
        // Simply call Dispose(false).
        Dispose(false);
    }

    #endregion

    #region Overrides

    public override void CopyPixels(Int32Rect sourceRect, Array pixels, int stride, int offset)
    {
        BitmapData sourceData = Bitmap.LockBits(
        new Rectangle(sourceRect.X, sourceRect.Y, sourceRect.Width, sourceRect.Height),
        ImageLockMode.ReadOnly,
        Bitmap.PixelFormat);

        var length = sourceData.Stride * sourceData.Height;

        if (pixels is byte[])
        {
            var bytes = pixels as byte[];
            Marshal.Copy(sourceData.Scan0, bytes, 0, length);
        }

        Bitmap.UnlockBits(sourceData);
    }

    protected override Freezable CreateInstanceCore()
    {
        return (Freezable)Activator.CreateInstance(GetType());
    }

    #endregion

    #region Public Methods

    public BitmapSource Resize(int newWidth, int newHeight)
    {
        Image newImage = new Bitmap(newWidth, newHeight);
        using (Graphics graphicsHandle = Graphics.FromImage(newImage))
        {
            graphicsHandle.InterpolationMode = InterpolationMode.HighQualityBicubic;
            graphicsHandle.DrawImage(Bitmap, 0, 0, newWidth, newHeight);
        }
        return new SharedBitmapSource(newImage as Bitmap);
    }

    public new BitmapSource Clone()
    {
        return new SharedBitmapSource(new Bitmap(Bitmap));
    }

    //Implement IDisposable.
    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    #endregion

    #region Protected/Private Methods

    private static System.Windows.Media.PixelFormat ConvertPixelFormat(System.Drawing.Imaging.PixelFormat sourceFormat)
    {
        switch (sourceFormat)
        {
            case System.Drawing.Imaging.PixelFormat.Format24bppRgb:
                return PixelFormats.Bgr24;

            case System.Drawing.Imaging.PixelFormat.Format32bppArgb:
                return PixelFormats.Pbgra32;

            case System.Drawing.Imaging.PixelFormat.Format32bppRgb:
                return PixelFormats.Bgr32;

        }
        return new System.Windows.Media.PixelFormat();
    }

    private bool _disposed = false;

    protected virtual void Dispose(bool disposing)
    {
        if (!_disposed)
        {
            if (disposing)
            {
                // Free other state (managed objects).
            }
            // Free your own state (unmanaged objects).
            // Set large fields to null.
            _disposed = true;
        }
    }

    #endregion
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-18T17:04:01.680

我在一家图像供应商工作，并为我们的图像格式编写了一个 WPF 适配器，类似于 System.Drawing.Bitmap。

我写了这个知识库来向我们的客户解释：

[http://www.atalasoft.com/kb/article.aspx?id=10156](http://www.atalasoft.com/kb/article.aspx?id=10156)

那里有代码可以做到这一点。您需要将 AtalaImage 替换为 Bitmap 并执行我们正在执行的等效操作 - 它应该非常简单。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-04-28T11:17:21.580

我对此的看法建立在许多资源之上。[https://stackoverflow.com/a/7035036](https://stackoverflow.com/a/7035036) [https://stackoverflow.com/a/1470182/360211](https://stackoverflow.com/a/1470182/360211)

```
using System;
using System.Drawing;
using System.Runtime.ConstrainedExecution;
using System.Runtime.InteropServices;
using System.Security;
using System.Windows;
using System.Windows.Interop;
using System.Windows.Media.Imaging;
using Microsoft.Win32.SafeHandles;

namespace WpfHelpers
{
    public static class BitmapToBitmapSource
    {
        public static BitmapSource ToBitmapSource(this Bitmap source)
        {
            using (var handle = new SafeHBitmapHandle(source))
            {
                return Imaging.CreateBitmapSourceFromHBitmap(handle.DangerousGetHandle(),
                    IntPtr.Zero, Int32Rect.Empty,
                    BitmapSizeOptions.FromEmptyOptions());
            }
        }

        [DllImport("gdi32")]
        private static extern int DeleteObject(IntPtr o);

        private sealed class SafeHBitmapHandle : SafeHandleZeroOrMinusOneIsInvalid
        {
            [SecurityCritical]
            public SafeHBitmapHandle(Bitmap bitmap)
                : base(true)
            {
                SetHandle(bitmap.GetHbitmap());
            }

            [ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
            protected override bool ReleaseHandle()
            {
                return DeleteObject(handle) > 0;
            }
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-09-11T00:33:40.367

我来到这个问题是因为我试图做同样的事情，但在我的情况下，位图来自资源/文件。我发现最好的解决方案如以下链接中所述：

[http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.aspx)

```
// Create the image element.
Image simpleImage = new Image();    
simpleImage.Width = 200;
simpleImage.Margin = new Thickness(5);

// Create source.
BitmapImage bi = new BitmapImage();
// BitmapImage.UriSource must be in a BeginInit/EndInit block.
bi.BeginInit();
bi.UriSource = new Uri(@"/sampleImages/cherries_larger.jpg",UriKind.RelativeOrAbsolute);
bi.EndInit();
// Set the image source.
simpleImage.Source = bi; 
```

# project-management - 团队领导和成员可以使用哪些工具来管理任务（敏捷编程）

> ID：94481
> 
> 赞同：12
> 
> 时间：2008-09-18T17:02:28.377
> 
> 标签：project-management, agile, task

我在一个 4 人的小型开发团队中工作。我们正在尝试开发“敏捷风格”——故事点、小任务等......不幸的是，我们目前正在（共享）Excel 表中管理我们的任务。

我们查看了一些可用的工具（Mingle、TFS、Scrum for Team System），但所有这些看起来都会带来太多的开销，并且会让工作失去乐趣。

您的敏捷爱好者使用什么来长期跟踪您的任务？

**更新** 当前的最佳答案并不是我打算问的真正答案 - 从长远来看，我需要一些工具来帮助我找出我正确估计的功能和任务，以及我在哪里犯了可怕的错误。我看到白板/所有便利贴如何帮助管理当前或以前的迭代，但我没有看到自己在寻找 2 个月前的便利贴。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-18T17:07:36.900

![替代文字](https://lh3.ggpht.com/thomas.carr/SNKKrk6eOUI/AAAAAAAAA2Y/nrhxuYzrBOQ/s512/ATT637484.jpg)

* * *

**更新响应：**跟踪被低估的内容和为什么被低估的原因似乎并不重要。这是迭代回顾中解决的问题。如果存在障碍，应及早解决并解决。如果您希望解决更具体的问题，而不仅仅是看到过去被低估的任务，您应该询问这个问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T17:03:22.540

白板、索引卡和记号笔。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T17:05:28.323

只需使用[Trac](http://trac.edgewall.org)。它拥有小型项目所需的一切。您可以使用票务系统来分配任务（在敏捷中，您应该考虑故事而不是单个任务），但如果这还不够，您可以获得额外的时间管理插件等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T17:16:18.047

我们现在正在使用[Xplanner](http://xplanner.org)，效果非常好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T17:03:50.980

将它们写在标签上并将它们贴在板上 - 它可以工作:) 而且 Scrum 确实不会给你带来开销 - 它工作得很好，并且对所有团队成员来说都非常满意 imho :)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T17:05:30.133

在这里，我们对一个项目使用[Trac](http://trac.edgewall.org/)，对另一个项目使用[@Task](http://www.attask.com/)。

在另一家公司，我们使用 Excel 表格来处理每个人的任务，打印出来并固定在墙上。

一般来说，大多数形式的实际计划、记录和跟踪任务都会让工作失去乐趣……但保持清醒是完全必要的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T17:32:29.630

我真的很喜欢[JIRA](http://www.atlassian.com/software/jira/)，[GreenHopper](http://confluence.atlassian.com/display/JIRAEXT/GreenHopper)插件看起来添加了一些不错的功能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-24T23:04:16.577

> “我们查看了一些可用的工具（Mingle、TFS、Scrum for Team System），但所有这些看起来都会造成过多的开销，并且会让工作失去乐趣。”

我只能建议你给Mingle一个真正的试用，它很棒。我的开发人员喜欢它，我也喜欢它。

学习曲线很小，但**非常**灵活，我建议查看 Hybrid 示例项目和内置报告，以克服您可能有的任何保留。

如果不是Mingle，我们的项目将一事无成，我有残疾，但如果需要，仍然可以在一天内修改300多张卡片。此外，5 位或更少用户可免费使用一年！

便利贴不可能促进该软件开箱即用的沟通和团队合作，如果您不喜欢它的工作方式，您可以不断调整它，直到它适合您的团队。

硬件 - 我建议使用四核和 8GB 以获得不错的性能。

披露：除了喜欢他们的软件之外，我与 Thoughtworks 没有任何关系。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T17:05:33.270

索引卡效果很好，但如果您需要在线使用，我会尝试[Unfuddle](http://unfuddle.com/)。您可以免费将它用于小型团体，而且它足够轻巧，您可以很容易地根据团体的需要进行调整。

我在工作中使用它，我们将所有故事保存在它的“笔记本”（阅读：wiki）中，并将任务保存在它的任务系统中。它内置了里程碑和版本，它的 Subversion 和 Git 集成非常棒：我们可以记录评论并使用版本控制消息解决任务。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T17:06:08.133

我们为大约 30 人使用 ScrumWorks。他们有免费版。

[http://danube.com/scrumworks](http://danube.com/scrumworks)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-19T10:21:12.217

我喜欢[dotProject](http://www.dotproject.net/)用于实际任务跟踪。如果需要，您可以轻松地攻击数据库以获取您的统计数据。

对于计划过程，我使用[Microsoft Project](http://office.microsoft.com/en-us/project/FX100487771033.aspx)主要是因为我已经习惯了。我还使用了开源工具[OpenProj](http://www.openproj.org/openproj)。

在 dotProject 中更改任务很痛苦，所以我通常只提前 4 到 6 周左右输入它们。

[FogBuz](http://www.fogcreek.com/FogBugz/)似乎是一个很棒的工具，我只是没有时间尝试它，而且我真的是此类工具的后期采用者。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-18T17:29:23.087

我喜欢[Pivotal Tracker](http://www.pivotaltracker.com/signup)。这是一个基于故事的项目规划工具，允许团队实时协作

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-18T17:34:30.173

[Rally](http://www.rallydev.com/)是一个非常好的工具，专注于敏捷开发。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T21:56:45.987

我们也使用[Trac](http://trac.edgewall.org)，但它的扩展性不是很好。处理用例和测试用例也可能很麻烦。这实际上取决于项目的范围和开发团队的规模。我认为对于少于 10 人的团队来说，Trac 做得很好，但在那之后你就遇到了玻璃天花板。

当我们开始超越 Trac 时，我们开始仔细研究 Confluence/Jira（可能是 Greenhopper）。

哦，张贴它，如果每个人都在现场，索引卡和白板工作得很好；-)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T17:16:50.153

这个问题主要是[https://stackoverflow.com/questions/12328/what-bug-tracking-software-do-you-use](https://stackoverflow.com/questions/12328/what-bug-tracking-software-do-you-use)的副本，它有*很多*答案 - 任务不一定是错误，但好的工具可以让你指定除“错误”以外的其他任务类型。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T23:13:59.403

就我而言，对于一个位于同一地点的团队来说，没有什么比一堵大墙和一大堆索引卡更好的了。也许用一两个白板来制作燃尽图。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-21T04:22:43.597

我们是一个分布在多个地点的团队。我发现有用的工具是基于[Twiki](http://www.twiki.org/)构建的 wiki 。

好处：

1.  类似于 Wiki 的环境，因此协作很容易。
2.  可用于添加“应用程序”的插件，例如会议记录、公告板、
3.  讨论论坛。
4.  安全的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-01-30T03:59:13.827

查看[间隔](http://www.myintervals.com)。我们将其构建为与您的问题非常相似的网页设计机构。我们有 4 或 5 个人都在 xcel 文档中跟踪时间和任务，而且很难完成任何事情。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T17:35:10.733

我们目前正在使用[Eventum](http://eventum.mysql.org/wiki/index.php/Main_Page)来处理我们的任务。它可能不是最好的，但值得一看。在我们的案例中，每个“问题”通常都分解为分配给某人实施的功能或用例。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T22:21:14.180

RallyDev.com。免费的 5 用户社区版，它实际上相当不错！

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-08-29T09:39:41.353

我们一直在使用 Accunote (accunote.com)。一个供应商设置了它，所以我不知道它的成本，或者即使我们唱得很好。

为什么有效：

1.  相当容易编辑/更新。

2.  易于修改冲刺中的任务，复制到/从积压选项卡等。

3.  每个人都会查看燃尽图，尤其是“按用户”的图表，这让团队保持合作并产生成就感。

可能还有其他工具可以做同样的事情，或者做得更好（Accunote Javascript 可能有点尴尬）。

关键是它应该真的很容易使用，并且有某种“团队空间”，你们都可以互相关注，看看你们每个人的进展如何。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-08-23T14:52:27.587

我和我一起工作的敏捷团队，我们不会长时间管理任务。相反，我们管理要添加到产品中的功能“积压”。我们有时也将这些称为“用户故事”。此积压工作是对要交付的增量功能列表中产品的一种切片。我们在 Excel 中管理此积压工作，只有很少的列，例如描述、复杂性评估和完成/未完成、迭代，仅此而已。

在迭代期间，任务在一个答案中显示的 postit 墙上进行管理。如果一项任务持续不止一次迭代，我们会设法对其进行分段，确保在每次迭代中交付功能/用户故事。

excel积压中的用户故事示例，它会具有与之相关的复杂性：

*   “用户可以使用带有 id 和密码的表单登录系统”

相关任务的一些示例，将在迭代期间完成。这些将通过 postit 进行管理，而不是复杂性。

*   “使用 GWT 对日志记录表单进行编码”
*   “实施安全算法以检查密码有效性”
*   “在数据库中创建用户/密码表”
*   “在集成系统上测试记录表单”

# linux - Does the Gentoo install CD contain everything for C++ development?

> ID：94486
> 
> 赞同：2
> 
> 时间：2008-09-18T17:03:07.207
> 
> 标签：linux, installation, gentoo

I'd like to install Gentoo. I need it to develop GUI C++ applications using wxWidgets, so I need:

*   build tools: make, automake, autoconf, etc.
*   C++ compiler (GCC)
*   X Window System for testing (Fluxbox or something minimal would be enough)

Now, I have two options:

*   download the small network installer (57MB) do a network install
*   download the 600MB CD

I'd like to download as less as possible and still have all the tools above.

I also don't understand whether the network installer will first prompt me for the packages I want, or it will fetch 600 MB of data anyway?

I might want to install it on other computers later, so I'd go with 'full' install from CD if the network install does not save me anything.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T17:15:53.947

Gentoo is ultraminimalist by default.

The install CD gets you a basic working system, a basic compile environment ( Some version of the GCC suite ), and package management.

Its up to you then to install what you want to use.

Its not like many other distributions where theres a big set of "default" packages to have installed.

You have to know what you want, and install what you want.

The "Live" Cd will make things a bit quicker by having a few precompiled binaries available, but besides that, you still have to choose what you want to install.

> I also don't understand whether the network installer will first prompt me for the packages I want, or it will fetch 600 MB of data anyway?

it will only install what you want to. If you use NetInstall and install nothing except GCC, it will only download enough to have GCC.

Welcome to gentoo.

It can be a little daunting for first timers, but once you've gotten past the steep learning curve you'll love it :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T03:58:21.483

You're not missing anything. Furthermore, if you actually want any useful applications, you're going to have to do a lot more downloading than that even. The point is, the small network install CD lets you download whichever version of those components that you want, and the latest version of portage, etc, instead of providing you with (likely) outdated copies on the full CD.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T20:02:31.923

Gentoo is fundamentally a network based distro. The minimal CD is really minimal, it contains just enough to have a functional system booting as livecd so one can install the distribution basically from the network. The livecd (there are also livedvd's around, just not as regularly released (they eat diskspace and bandwith). contains a full graphical environment (and being a compile-yourself distro) obviously gcc as C++ compiler, and can be used to install a binary version of the packages to disk (actually from the livecd environment using some clever hackery).

However, gentoo is a continuously updated distribution. If you want to update your system you need to get the packages from the network (there are ways to find what to download etc, but that is not for beginners) and update. In general, if you don't update every couple of months, your updates can become painful or really painful.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-09T20:36:16.070

After you have installed Gentoo — emerge vim wxGTK and [read](http://wiki.wxwidgets.org/Installing_and_configuring_under_Gentoo)

and you are ready to go!

Happy coding.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T17:18:18.167

Use network install. It does save you something and even if you do multiple installations you'll probably want the newest packages anyway. And no the network installer will not download the 600MB without asking you that would make no sense.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T17:27:20.610

Gentoo doesn't exactly "prompt" for packages. The network CD will get you a small base system, then it's up to you to set everything else you need up yourself. This is one of the positive and negative things about Gentoo.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T00:49:17.430

Update: looks like network install is not that minimal. There's 57MB .iso image, but you also need to download stage3 which is about 120MB and portage with is 29MB. And later on, you need the Linux kernel, which is about 46MB. This totals about 250MB. Or am I missing something?

**Update:** I have installed the Kernel, X Window system, mc, Lilo, etc. and have a working system :) Summing all up, it downloaded about 580 MB. Well, it is still less than install CD!

# .net - 使自定义 .NET 异常可序列化的正确方法是什么？

> ID：94488
> 
> 赞同：268
> 
> 时间：2008-09-18T17:03:32.697
> 
> 标签：.net, exception, serialization

更具体地说，当异常包含自定义对象时，这些对象本身可能是可序列化的，也可能不是。

举个例子：

```
public class MyException : Exception
{
    private readonly string resourceName;
    private readonly IList<string> validationErrors;

    public MyException(string resourceName, IList<string> validationErrors)
    {
        this.resourceName = resourceName;
        this.validationErrors = validationErrors;
    }

    public string ResourceName
    {
        get { return this.resourceName; }
    }

    public IList<string> ValidationErrors
    {
        get { return this.validationErrors; }
    }
} 
```

如果此 Exception 被序列化和反序列化，则不会保留两个自定义属性 (`ResourceName`和)。`ValidationErrors`属性将返回`null`。

**是否有用于实现自定义异常序列化的通用代码模式？**

* * *

## 回答 #1

> 赞同：488
> 
> 时间：2008-09-19T08:00:25.490

## 基本实现，没有自定义属性

***SerializableExceptionWithoutCustomProperties.cs：***

```
namespace SerializableExceptions
{
    using System;
    using System.Runtime.Serialization;

    [Serializable]
    // Important: This attribute is NOT inherited from Exception, and MUST be specified 
    // otherwise serialization will fail with a SerializationException stating that
    // "Type X in Assembly Y is not marked as serializable."
    public class SerializableExceptionWithoutCustomProperties : Exception
    {
        public SerializableExceptionWithoutCustomProperties()
        {
        }

        public SerializableExceptionWithoutCustomProperties(string message) 
            : base(message)
        {
        }

        public SerializableExceptionWithoutCustomProperties(string message, Exception innerException) 
            : base(message, innerException)
        {
        }

        // Without this constructor, deserialization will fail
        protected SerializableExceptionWithoutCustomProperties(SerializationInfo info, StreamingContext context) 
            : base(info, context)
        {
        }
    }
} 
```

## 完全实现，带有自定义属性

自定义可序列化异常 ( `MySerializableException`) 和派生`sealed`异常 ( `MyDerivedSerializableException`) 的完整实现。

此处总结了有关此实现的要点：

1.  您必须使用**属性****装饰每个派生类`[Serializable]`**— 此属性不是从基类继承的，如果未指定，则序列化将失败`SerializationException`并显示*“程序集 Y 中的类型 X 未标记为可序列化”。*
2.  您**必须实现自定义序列化**。`[Serializable]`仅有属性是不够的——实现`Exception`这`ISerializable`意味着您的派生类还必须实现自定义序列化。这包括两个步骤：
    1.  **提供一个序列化构造函数**。`private`如果您的类是，则此构造函数应该是`sealed`，否则应该是`protected`允许访问派生类。
    2.  **覆盖 GetObjectData()**并确保`base.GetObjectData(info, context)`在最后调用 to，以便让基类保存自己的状态。

***SerializableExceptionWithCustomProperties.cs：***

```
namespace SerializableExceptions
{
    using System;
    using System.Collections.Generic;
    using System.Runtime.Serialization;
    using System.Security.Permissions;

    [Serializable]
    // Important: This attribute is NOT inherited from Exception, and MUST be specified 
    // otherwise serialization will fail with a SerializationException stating that
    // "Type X in Assembly Y is not marked as serializable."
    public class SerializableExceptionWithCustomProperties : Exception
    {
        private readonly string resourceName;
        private readonly IList<string> validationErrors;

        public SerializableExceptionWithCustomProperties()
        {
        }

        public SerializableExceptionWithCustomProperties(string message) 
            : base(message)
        {
        }

        public SerializableExceptionWithCustomProperties(string message, Exception innerException)
            : base(message, innerException)
        {
        }

        public SerializableExceptionWithCustomProperties(string message, string resourceName, IList<string> validationErrors)
            : base(message)
        {
            this.resourceName = resourceName;
            this.validationErrors = validationErrors;
        }

        public SerializableExceptionWithCustomProperties(string message, string resourceName, IList<string> validationErrors, Exception innerException)
            : base(message, innerException)
        {
            this.resourceName = resourceName;
            this.validationErrors = validationErrors;
        }

        [SecurityPermissionAttribute(SecurityAction.Demand, SerializationFormatter = true)]
        // Constructor should be protected for unsealed classes, private for sealed classes.
        // (The Serializer invokes this constructor through reflection, so it can be private)
        protected SerializableExceptionWithCustomProperties(SerializationInfo info, StreamingContext context)
            : base(info, context)
        {
            this.resourceName = info.GetString("ResourceName");
            this.validationErrors = (IList<string>)info.GetValue("ValidationErrors", typeof(IList<string>));
        }

        public string ResourceName
        {
            get { return this.resourceName; }
        }

        public IList<string> ValidationErrors
        {
            get { return this.validationErrors; }
        }

        [SecurityPermissionAttribute(SecurityAction.Demand, SerializationFormatter = true)]
        public override void GetObjectData(SerializationInfo info, StreamingContext context)
        {
            if (info == null)
            {
                throw new ArgumentNullException("info");
            }

            info.AddValue("ResourceName", this.ResourceName);

            // Note: if "List<T>" isn't serializable you may need to work out another
            //       method of adding your list, this is just for show...
            info.AddValue("ValidationErrors", this.ValidationErrors, typeof(IList<string>));

            // MUST call through to the base class to let it save its own state
            base.GetObjectData(info, context);
        }
    }
} 
```

***DerivedSerializableExceptionWithAdditionalCustomProperties.cs：***

```
namespace SerializableExceptions
{
    using System;
    using System.Collections.Generic;
    using System.Runtime.Serialization;
    using System.Security.Permissions;

    [Serializable]
    public sealed class DerivedSerializableExceptionWithAdditionalCustomProperty : SerializableExceptionWithCustomProperties
    {
        private readonly string username;

        public DerivedSerializableExceptionWithAdditionalCustomProperty()
        {
        }

        public DerivedSerializableExceptionWithAdditionalCustomProperty(string message)
            : base(message)
        {
        }

        public DerivedSerializableExceptionWithAdditionalCustomProperty(string message, Exception innerException) 
            : base(message, innerException)
        {
        }

        public DerivedSerializableExceptionWithAdditionalCustomProperty(string message, string username, string resourceName, IList<string> validationErrors) 
            : base(message, resourceName, validationErrors)
        {
            this.username = username;
        }

        public DerivedSerializableExceptionWithAdditionalCustomProperty(string message, string username, string resourceName, IList<string> validationErrors, Exception innerException) 
            : base(message, resourceName, validationErrors, innerException)
        {
            this.username = username;
        }

        [SecurityPermissionAttribute(SecurityAction.Demand, SerializationFormatter = true)]
        // Serialization constructor is private, as this class is sealed
        private DerivedSerializableExceptionWithAdditionalCustomProperty(SerializationInfo info, StreamingContext context)
            : base(info, context)
        {
            this.username = info.GetString("Username");
        }

        public string Username
        {
            get { return this.username; }
        }

        public override void GetObjectData(SerializationInfo info, StreamingContext context)
        {
            if (info == null)
            {
                throw new ArgumentNullException("info");
            }
            info.AddValue("Username", this.username);
            base.GetObjectData(info, context);
        }
    }
} 
```

* * *

## 单元测试

MSTest 对上面定义的三种异常类型进行单元测试。

***单元测试.cs：***

```
namespace SerializableExceptions
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Runtime.Serialization.Formatters.Binary;
    using Microsoft.VisualStudio.TestTools.UnitTesting;

    [TestClass]
    public class UnitTests
    {
        private const string Message = "The widget has unavoidably blooped out.";
        private const string ResourceName = "Resource-A";
        private const string ValidationError1 = "You forgot to set the whizz bang flag.";
        private const string ValidationError2 = "Wally cannot operate in zero gravity.";
        private readonly List<string> validationErrors = new List<string>();
        private const string Username = "Barry";

        public UnitTests()
        {
            validationErrors.Add(ValidationError1);
            validationErrors.Add(ValidationError2);
        }

        [TestMethod]
        public void TestSerializableExceptionWithoutCustomProperties()
        {
            Exception ex =
                new SerializableExceptionWithoutCustomProperties(
                    "Message", new Exception("Inner exception."));

            // Save the full ToString() value, including the exception message and stack trace.
            string exceptionToString = ex.ToString();

            // Round-trip the exception: Serialize and de-serialize with a BinaryFormatter
            BinaryFormatter bf = new BinaryFormatter();
            using (MemoryStream ms = new MemoryStream())
            {
                // "Save" object state
                bf.Serialize(ms, ex);

                // Re-use the same stream for de-serialization
                ms.Seek(0, 0);

                // Replace the original exception with de-serialized one
                ex = (SerializableExceptionWithoutCustomProperties)bf.Deserialize(ms);
            }

            // Double-check that the exception message and stack trace (owned by the base Exception) are preserved
            Assert.AreEqual(exceptionToString, ex.ToString(), "ex.ToString()");
        }

        [TestMethod]
        public void TestSerializableExceptionWithCustomProperties()
        {
            SerializableExceptionWithCustomProperties ex = 
                new SerializableExceptionWithCustomProperties(Message, ResourceName, validationErrors);

            // Sanity check: Make sure custom properties are set before serialization
            Assert.AreEqual(Message, ex.Message, "Message");
            Assert.AreEqual(ResourceName, ex.ResourceName, "ex.ResourceName");
            Assert.AreEqual(2, ex.ValidationErrors.Count, "ex.ValidationErrors.Count");
            Assert.AreEqual(ValidationError1, ex.ValidationErrors[0], "ex.ValidationErrors[0]");
            Assert.AreEqual(ValidationError2, ex.ValidationErrors[1], "ex.ValidationErrors[1]");

            // Save the full ToString() value, including the exception message and stack trace.
            string exceptionToString = ex.ToString();

            // Round-trip the exception: Serialize and de-serialize with a BinaryFormatter
            BinaryFormatter bf = new BinaryFormatter();
            using (MemoryStream ms = new MemoryStream())
            {
                // "Save" object state
                bf.Serialize(ms, ex);

                // Re-use the same stream for de-serialization
                ms.Seek(0, 0);

                // Replace the original exception with de-serialized one
                ex = (SerializableExceptionWithCustomProperties)bf.Deserialize(ms);
            }

            // Make sure custom properties are preserved after serialization
            Assert.AreEqual(Message, ex.Message, "Message");
            Assert.AreEqual(ResourceName, ex.ResourceName, "ex.ResourceName");
            Assert.AreEqual(2, ex.ValidationErrors.Count, "ex.ValidationErrors.Count");
            Assert.AreEqual(ValidationError1, ex.ValidationErrors[0], "ex.ValidationErrors[0]");
            Assert.AreEqual(ValidationError2, ex.ValidationErrors[1], "ex.ValidationErrors[1]");

            // Double-check that the exception message and stack trace (owned by the base Exception) are preserved
            Assert.AreEqual(exceptionToString, ex.ToString(), "ex.ToString()");
        }

        [TestMethod]
        public void TestDerivedSerializableExceptionWithAdditionalCustomProperty()
        {
            DerivedSerializableExceptionWithAdditionalCustomProperty ex = 
                new DerivedSerializableExceptionWithAdditionalCustomProperty(Message, Username, ResourceName, validationErrors);

            // Sanity check: Make sure custom properties are set before serialization
            Assert.AreEqual(Message, ex.Message, "Message");
            Assert.AreEqual(ResourceName, ex.ResourceName, "ex.ResourceName");
            Assert.AreEqual(2, ex.ValidationErrors.Count, "ex.ValidationErrors.Count");
            Assert.AreEqual(ValidationError1, ex.ValidationErrors[0], "ex.ValidationErrors[0]");
            Assert.AreEqual(ValidationError2, ex.ValidationErrors[1], "ex.ValidationErrors[1]");
            Assert.AreEqual(Username, ex.Username);

            // Save the full ToString() value, including the exception message and stack trace.
            string exceptionToString = ex.ToString();

            // Round-trip the exception: Serialize and de-serialize with a BinaryFormatter
            BinaryFormatter bf = new BinaryFormatter();
            using (MemoryStream ms = new MemoryStream())
            {
                // "Save" object state
                bf.Serialize(ms, ex);

                // Re-use the same stream for de-serialization
                ms.Seek(0, 0);

                // Replace the original exception with de-serialized one
                ex = (DerivedSerializableExceptionWithAdditionalCustomProperty)bf.Deserialize(ms);
            }

            // Make sure custom properties are preserved after serialization
            Assert.AreEqual(Message, ex.Message, "Message");
            Assert.AreEqual(ResourceName, ex.ResourceName, "ex.ResourceName");
            Assert.AreEqual(2, ex.ValidationErrors.Count, "ex.ValidationErrors.Count");
            Assert.AreEqual(ValidationError1, ex.ValidationErrors[0], "ex.ValidationErrors[0]");
            Assert.AreEqual(ValidationError2, ex.ValidationErrors[1], "ex.ValidationErrors[1]");
            Assert.AreEqual(Username, ex.Username);

            // Double-check that the exception message and stack trace (owned by the base Exception) are preserved
            Assert.AreEqual(exceptionToString, ex.ToString(), "ex.ToString()");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-09-18T17:21:40.030

异常已经是可序列化的，但是您需要重写该`GetObjectData`方法来存储变量并提供一个构造函数，该构造函数可以在重新水合对象时调用。

所以你的例子变成：

```
[Serializable]
public class MyException : Exception
{
    private readonly string resourceName;
    private readonly IList<string> validationErrors;

    public MyException(string resourceName, IList<string> validationErrors)
    {
        this.resourceName = resourceName;
        this.validationErrors = validationErrors;
    }

    public string ResourceName
    {
        get { return this.resourceName; }
    }

    public IList<string> ValidationErrors
    {
        get { return this.validationErrors; }
    }

    [SecurityPermissionAttribute(SecurityAction.Demand, SerializationFormatter=true)]
    protected MyException(SerializationInfo info, StreamingContext context) : base (info, context)
    {
        this.resourceName = info.GetString("MyException.ResourceName");
        this.validationErrors = info.GetValue("MyException.ValidationErrors", typeof(IList<string>));
    }

    [SecurityPermissionAttribute(SecurityAction.Demand, SerializationFormatter=true)]
    public override void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        base.GetObjectData(info, context);

        info.AddValue("MyException.ResourceName", this.ResourceName);

        // Note: if "List<T>" isn't serializable you may need to work out another
        //       method of adding your list, this is just for show...
        info.AddValue("MyException.ValidationErrors", this.ValidationErrors, typeof(IList<string>));
    }

} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-11-12T19:47:32.233

[`Data`要添加到上面的正确答案，我发现如果我将自定义属性存储在类的集合](http://msdn.microsoft.com/en-us/library/system.exception.data)中，我可以避免做这种自定义序列化的东西`Exception`。

例如：

```
[Serializable]
public class JsonReadException : Exception
{
    // ...

    public string JsonFilePath
    {
        get { return Data[@"_jsonFilePath"] as string; }
        private set { Data[@"_jsonFilePath"] = value; }
    }

    public string Json
    {
        get { return Data[@"_json"] as string; }
        private set { Data[@"_json"] = value; }
    }

    // ...
} 
```

就性能而言，这可能比[Daniel 提供的解决方案](https://stackoverflow.com/a/100369/107625)效率低，并且可能仅适用于字符串和整数等“整数”类型。

对我来说，这仍然很容易，也很容易理解。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-18T17:08:33.183

实现 ISerializable，并按照[正常模式](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable%28VS.71%29.aspx)执行此操作。

您需要使用 [Serializable] 属性标记类，并添加对该接口的支持，并添加隐含的构造函数（在该页面上描述，搜索*暗示构造函数*）。您可以在文本下方的代码中看到其实现示例。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T18:48:17.000

MSDN 上曾经有 Eric Gunnerson 的一篇优秀文章《The well-tempered exception》，但是好像被撤了。网址是：

[http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dncscol/html/csharp08162001.asp](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dncscol/html/csharp08162001.asp)

Aydsman 的回答是正确的，更多信息在这里：

[http://msdn.microsoft.com/en-us/library/ms229064.aspx](http://msdn.microsoft.com/en-us/library/ms229064.aspx)

我想不出具有不可序列化成员的异常的任何用例，但是如果您避免尝试在 GetObjectData 和反序列化构造函数中序列化/反序列化它们，您应该没问题。还要用 [NonSerialized] 属性标记它们，更多的是作为文档而不是其他任何东西，因为您自己实现了序列化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-19T17:50:54.887

在 .NET Core 中，.Net 5.0 及更高版本不使用 Serializable，因为 Microsoft 遵循[BinaryFormatter](https://aka.ms/binaryformatter)中的安全威胁实践。

使用存储在 Data Collection 中的示例

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T17:07:04.607

用 [Serializable] 标记该类，尽管我不确定序列化程序将如何处理 IList 成员。

**编辑**

下面的帖子是正确的，因为您的自定义异常具有带参数的构造函数，您必须实现 ISerializable。

如果您使用默认构造函数并使用 getter/setter 属性公开两个自定义成员，则只需设置属性即可。

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2008-09-18T17:11:42.410

我必须认为想要序列化异常是一个强烈的迹象，表明你对某事采取了错误的方法。这里的最终目标是什么？如果您在两个进程之间传递异常，或者在同一进程的不同运行之间传递异常，那么异常的大多数属性在另一个进程中都不会有效。

在 catch() 语句中提取所需的状态信息并将其归档可能更有意义。

# python - 如何使用 Python 通过 HTTP 从远程 Zip 存档中读取选定的文件？

> ID：94490
> 
> 赞同：10
> 
> 时间：2008-09-18T17:03:36.283
> 
> 标签：python, http, zip

我需要使用 Python 从远程 zip 存档中读取与文件名匹配的选定文件。我不想将完整的 zip 保存到临时文件中（它不是那么大，所以我可以处理内存中的所有内容）。

我已经编写了代码并且它可以工作，我自己回答这个问题，以便我以后可以搜索它。但既然有证据表明我是 Stackoverflow 上比较笨的参与者之一，我相信还有改进的余地。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T17:03:42.850

我是这样做的（获取所有以“.ranks”结尾的文件）：

```
import urllib2, cStringIO, zipfile

try:
    remotezip = urllib2.urlopen(url)
    zipinmemory = cStringIO.StringIO(remotezip.read())
    zip = zipfile.ZipFile(zipinmemory)
    for fn in zip.namelist():
        if fn.endswith(".ranks"):
            ranks_data = zip.read(fn)
            for line in ranks_data.split("\n"):
                # do something with each line
except urllib2.HTTPError:
    # handle exception 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-04T20:13:44.077

感谢 Marcel 的提问和回答（我在不同的上下文中遇到了同样的问题，并且在类似文件的对象不是真正类似文件的情况下遇到了同样的困难）！作为更新：对于 Python 3.0，您的代码需要稍作修改：

```
import urllib.request, io, zipfile

try:
    remotezip = urllib.request.urlopen(url)
    zipinmemory = io.BytesIO(remotezip.read())
    zip = zipfile.ZipFile(zipinmemory)
    for fn in zip.namelist():
        if fn.endswith(".ranks"):
            ranks_data = zip.read(fn)
            for line in ranks_data.split("\n"):
                # do something with each line
except urllib.request.HTTPError:
    # handle exception 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-22T14:43:27.747

这将在不下载整个 zip 文件的情况下完成这项工作！

[http://pypi.python.org/pypi/pyremotezip](http://pypi.python.org/pypi/pyremotezip)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T17:07:38.850

请记住，仅解压缩 ZIP 文件可能会导致[安全漏洞](http://en.wikipedia.org/wiki/Decompression_bomb)。

# ruby-on-rails - 在 Rails 中，如何将记录作为 csv 文件返回

> ID：94502
> 
> 赞同：55
> 
> 时间：2008-09-18T17:05:01.227
> 
> 标签：ruby-on-rails, csv

我有一个名为“Entries”的简单数据库表：

```
class CreateEntries < ActiveRecord::Migration
  def self.up
    create_table :entries do |t|
      t.string :firstName
      t.string :lastName
      #etc.
      t.timestamps
    end
  end

  def self.down
    drop_table :entries
  end
end 
```

如何编写一个将 Entries 表的内容作为 CSV 文件返回的处理程序（理想情况下，它会自动在 Excel 中打开）？

```
class EntriesController < ApplicationController

  def getcsv
    @entries = Entry.find( :all )

    # ??? NOW WHAT ????

  end

end 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-09-18T17:21:41.153

[FasterCSV](http://fastercsv.rubyforge.org/classes/FasterCSV.html)绝对是要走的路，但如果您想直接从 Rails 应用程序提供它，您也需要设置一些响应标头。

我保留了一种方法来设置文件名和必要的标题：

```
def render_csv(filename = nil)
  filename ||= params[:action]
  filename += '.csv'

  if request.env['HTTP_USER_AGENT'] =~ /msie/i
    headers['Pragma'] = 'public'
    headers["Content-type"] = "text/plain" 
    headers['Cache-Control'] = 'no-cache, must-revalidate, post-check=0, pre-check=0'
    headers['Content-Disposition'] = "attachment; filename=\"#{filename}\"" 
    headers['Expires'] = "0" 
  else
    headers["Content-Type"] ||= 'text/csv'
    headers["Content-Disposition"] = "attachment; filename=\"#{filename}\"" 
  end

  render :layout => false
end 
```

使用它可以很容易地在我的控制器中拥有这样的东西：

```
respond_to do |wants|
  wants.csv do
    render_csv("users-#{Time.now.strftime("%Y%m%d")}")
  end
end 
```

并有一个看起来像这样的视图：（`generate_csv`来自 FasterCSV）

```
UserID,Email,Password,ActivationURL,Messages
<%= generate_csv do |csv|
  @users.each do |user|
    csv << [ user[:id], user[:email], user[:password], user[:url], user[:message] ]
  end
end %> 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-18T17:24:32.193

我接受（并投票！）@Brian 的回答，首先将我指向 FasterCSV。然后当我用谷歌搜索找到 gem 时，我还在[这个 wiki 页面上](http://wiki.rubyonrails.org/rails/pages/HowtoExportDataAsCSV)找到了一个相当完整的示例。将它们放在一起，我确定了以下代码。

顺便说一下，安装gem的命令是：sudo gem install fastercsv（全小写）

```
require 'fastercsv'

class EntriesController < ApplicationController

  def getcsv
      entries = Entry.find(:all)
      csv_string = FasterCSV.generate do |csv| 
            csv << ["first","last"]
            entries.each do |e|
              csv << [e.firstName,e.lastName]
            end
          end
          send_data csv_string, :type => "text/plain", 
           :filename=>"entries.csv",
           :disposition => 'attachment'

  end

end 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-21T17:16:04.517

不使用 FasterCSV 的另一种方法：

在 config/initializers/dependencies.rb 之类的初始化文件中需要 ruby​​ 的 csv 库

```
require "csv" 
```

作为一些背景，以下代码基于[Ryan Bate 的](http://railscasts.com/episodes/111)创建搜索资源的高级搜索表单。在我的例子中，搜索资源的 show 方法将返回之前保存的搜索结果。它还响应 csv，并使用视图模板来格式化所需的输出。

```
 def show
    @advertiser_search = AdvertiserSearch.find(params[:id])
    @advertisers = @advertiser_search.search(params[:page])
    respond_to do |format|
      format.html # show.html.erb
      format.csv  # show.csv.erb
    end
  end 
```

show.csv.erb 文件如下所示：

```
<%- headers = ["Id", "Name", "Account Number", "Publisher", "Product Name", "Status"] -%>
<%= CSV.generate_line headers %>
<%- @advertiser_search.advertisers.each do |advertiser| -%>
<%- advertiser.subscriptions.each do |subscription| -%>
<%- row = [ advertiser.id,
            advertiser.name,
            advertiser.external_id,
            advertiser.publisher.name,
            publisher_product_name(subscription),
            subscription.state ] -%>
<%=   CSV.generate_line row %>
<%- end -%>
<%- end -%> 
```

在报告页面的 html 版本上，我有一个链接可以导出用户正在查看的报告。以下是返回报告的 csv 版本的 link_to：

```
<%= link_to "Export Report", formatted_advertiser_search_path(@advertiser_search, :csv) %> 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-09-18T17:07:43.840

有一个名为 FasterCSV 的插件可以很好地处理这个问题。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-18T17:08:03.310

查看[FasterCSV](http://fastercsv.rubyforge.org/classes/FasterCSV.html) gem。

如果您只需要 excel 支持，您也可以考虑直接生成 xls。（见电子表格::Excel）

```
gem install fastercsv
gem install spreadsheet-excel 
```

我发现这些选项非常适合在 Windows Excel 中打开 csv 文件：

```
FasterCSV.generate(:col_sep => ";", :row_sep => "\r\n") { |csv| ... } 
```

至于 ActiveRecord 部分，这样的事情会做：

```
CSV_FIELDS = %w[ title created_at etc ]
FasterCSV.generate do |csv|
  Entry.all.map { |r| CSV_FIELDS.map { |m| r.send m }  }.each { |row| csv << row }
end 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T17:16:28.547

您需要在响应中设置 Content-Type 标头，然后发送数据。Content_Type: application/vnd.ms-excel 应该可以解决问题。

您可能还想设置 Content-Disposition 标头，使其看起来像 Excel 文档，并且浏览器会选择一个合理的默认文件名；这类似于 Content-Disposition: attachment; 文件名="#{建议名称}.xls"

我建议使用 fastcsv ruby​​ gem 来生成你的 CSV，但也有一个内置的 csv。fastcsv 示例代码（来自 gem 的文档）如下所示：

```
csv_string = FasterCSV.generate do |csv|
  csv << ["row", "of", "CSV", "data"]
  csv << ["another", "row"]
# ...
end 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-22T00:02:32.117

以下方法适用于我的情况，并导致浏览器在下载后打开适用于 CSV 类型的应用程序。

```
def index
  respond_to do |format|
    format.csv { return index_csv }
  end
end

def index_csv
  send_data(
    method_that_returns_csv_data(...),
    :type => 'text/csv',
    :filename => 'export.csv',
    :disposition => 'attachment'
  )
end 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-17T07:00:59.637

尝试一个不错的 gem 从 Rails [https://github.com/crafterm/comma生成 CSV](https://github.com/crafterm/comma)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-25T19:15:21.813

看看 CSV Shaper gem。

[https://github.com/paulspringett/csv_shaper](http://github.com/paulspringett/csv_shaper)

它有一个很好的 DSL，并且与 Rails 模型配合得非常好。它还处理响应标头并允许自定义文件名。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-07-19T01:25:36.017

如果您只是想自己从控制台获取 csv 数据库，您可以在几行中完成

```
tags = [Model.column_names]
rows = tags + Model.all.map(&:attributes).map(&:to_a).map { |m| m.inject([]) { |data, pair| data << pair.last } }
File.open("ss.csv", "w") {|f| f.write(rows.inject([]) { |csv, row|  csv << CSV.generate_line(row) }.join(""))} 
```

# html - html元素属性值中是否允许“>”（U+003E GREATER-THAN SIGN）？

> ID：94528
> 
> 赞同：12
> 
> 时间：2008-09-18T17:08:49.390
> 
> 标签：html, regex, syntax

换句话说，可以使用`/<tag[^>]*>.*?<\/tag>/`正则表达式来匹配`tag`不包含嵌套`tag`元素的 html 元素吗？

例如（lt.html）：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>greater than sign in attribute value</title>
  </head>
  <body>
    <div>1</div>
    <div title=">">2</div>
  </body>
</html> 
```

正则表达式：

```
$ perl -nE"say $1 if m~<div[^>]*>(.*?)</div>~" lt.html 
```

和屏幕刮板：

```
#!/usr/bin/env python
import sys
import BeautifulSoup

soup = BeautifulSoup.BeautifulSoup(sys.stdin)
for div in soup.findAll('div'):
    print div.string

$ python lt.py <lt.html 
```

两者都给出相同的输出：

```
1
">2 
```

预期输出：

```
1
2 
```

[w3c](http://www.w3.org/TR/html5/syntax.html#attributes2 "html属性语法")说：

> 属性值是文本和字符引用的混合，除了文本不能包含不明确的 & 符号的附加限制。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-19T23:10:50.607

是的，它是允许的（W3C Validator 接受它，只发出警告）。

未转义`<`并且`>`也允许在注释中，所以这样简单的正则表达式可以被愚弄。

如果 BeautifulSoup 不处理这个问题，这可能是一个错误，或者可能是一个有意识的设计决定，以使其对缺少属性中的右引号更具弹性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T17:33:43.107

文字`>`在 html 内容中的任何地方都是合法的，无论是在属性值内部还是作为元素内的文本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T17:14:08.270

我相信这是有效的，W3C 验证者也同意，但此信息的权威来源是 ISO 8879:1986 标准，成本约为 150 欧元/210 美元。无论如何，编码它们并没有错，所以如果有疑问，编码。此外，如果您使用基于 XML 的文档类型，则需要在序列中编码大于号`]]>`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T17:12:10.303

阅读以下内容后：

[http://www.w3.org/International/questions/qa-escapes](http://www.w3.org/International/questions/qa-escapes)

对于 < > 和 & 似乎到处都建议使用实体转义（包括在属性中）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T02:13:56.730

如果您坚持使用正则表达式（适用于基本字符串操作），请尝试使用`<tag((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>.*?<\/tag>`. 它应该完美匹配属性，因此允许您访问内部内容（尽管您需要将其放在捕获组中）。

您也可以使用[Html Agility Pack](http://www.codeplex.com/htmlagilitypack "CodePlex 上的 Html Agility Pack 项目页面")来解析 HTML，如果您要进行大量解析，我会推荐它。维护大型正则表达式很容易让人头疼，但与此同时，如果您能够这样做，它们也会更有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T17:10:51.650

```
yeah except /<tag[^>]*>.*?<\/tag>/ 
```

不会匹配单个标签，但会匹配给定标签的第一个开始标签和最后一个结束标签。就像你的第一个非贪婪标签匹配一样，你的中间也应该写成非贪婪的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T17:11:00.510

查看是否使用 > 得到相同的结果 而不是 >

# java - 我可以从较小的配置文件中编写 Spring 配置文件吗？

> ID：94542
> 
> 赞同：15
> 
> 时间：2008-09-18T17:10:38.170
> 
> 标签：java, spring

我有几个项目都使用一个项目作为数据模型。这些项目中的每一个都有自己的 applicationContext.xml 文件，其中包含一堆重复的数据内容。

我想要一个 modelContext.xml 文件和另一个用于我的 ui.xml 等。

我可以这样做吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-18T17:18:16.840

来自[Spring Docs（v 2.5.5 第 3.2.2.1 节）](http://static.springframework.org/spring/docs/2.5.5/reference/beans.html#beans-definition)：

> 将容器定义拆分为多个 XML 文件通常很有用。然后加载从所有这些 XML 片段配置的应用程序上下文的一种方法是使用应用程序上下文构造函数，该构造函数采用多个资源位置。使用 bean 工厂，可以多次使用 bean 定义阅读器依次从每个文件中读取定义。
> 
> 一般来说，Spring 团队更喜欢上述方法，因为它使容器配置文件不知道它们正在与其他文件组合。另一种方法是使用元素的一个或多个实例从另一个文件（或多个文件）加载 bean 定义。让我们看一个示例：
> 
> ```
> <import resource="services.xml"/>
> <import resource="resources/messageSource.xml"/>
> <import resource="/resources/themeSource.xml"/>
> 
> <bean id="bean1" class="..."/>
> <bean id="bean2" class="..."/> 
> ```
> 
> 在这个例子中，外部 bean 定义是从 3 个文件加载的，services.xml、messageSource.xml 和 themeSource.xml。所有位置路径都被认为是相对于执行导入的定义文件，因此在这种情况下 services.xml 必须与执行导入的文件位于同一目录或类路径位置，而 messageSource.xml 和 themeSource.xml 必须位于资源中位置低于导入文件的位置。如您所见，前导斜杠实际上被忽略了，但考虑到这些被认为是相对路径，完全不使用斜杠可能是更好的形式。被导入文件的内容必须是根据 Spring Schema 或 DTD 的有效 XML bean 定义文件，包括顶级元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T17:39:35.497

我们在我们的项目中使用 Spring 中的 classpath* 资源加载器来执行此操作。对于某个应用程序，将加载所有包含应用程序 id 的 appcontext 文件：

```
classpath*:springconfig/spring-appname-*.xml 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T17:18:08.807

是的，您可以通过 import 元素执行此操作。

```
<import resource="services.xml"/> 
```

每个元素的资源属性都是一个有效的路径（例如 classpath:foo.xml）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T18:00:53.027

鉴于 Nicholas 向我指出的内容，我在文档中发现了这一点。它允许我在运行时选择我感兴趣的 bean 上下文。

```
GenericApplicationContext ctx = new GenericApplicationContext();
XmlBeanDefinitionReader xmlReader = new XmlBeanDefinitionReader(ctx);
xmlReader.loadBeanDefinitions(new ClassPathResource("modelContext.xml"));
xmlReader.loadBeanDefinitions(new ClassPathResource("uiContext.xml"));
ctx.refresh(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T19:28:35.453

这是我为我的一个项目所做的。在您的`web.xml`文件中，您可以定义您希望应用程序使用的 Spring bean 文件：

```
 <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
      /WEB-INF/applicationContext.xml
      /WEB-INF/modelContext.xml
      /WEB-INF/ui.xml
    </param-value>
  </context-param> 
```

如果这没有在你的 中定义`web.xml`，它会自动寻找`/WEB-INF/applicationContext.xml`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T20:31:46.703

另一件需要注意的事情是，尽管您可以这样做，但如果您不是 XML 的忠实粉丝，您可以在 Spring 2.5 中使用注释做很多事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T20:47:10.677

是的，您可以使用“主”bean 文件中的标签。但是为什么？为什么不在 bean 工厂的 wab.xml 或 als 位置数组的 contextConfigLocation 上下文参数中列出文件？

我认为多个文件更容易处理。您可以只选择其中一些进行测试，只需添加重命名或删除应用程序的一部分，您可以将不同的应用程序绑定到相同的配置文件（一个 webapp 和一个带有一些重叠 bean 定义的命令行版本）。

# maven-2 - Maven2 Multiproject Cobertura 在 mvn 站点构建期间报告问题

> ID：94556
> 
> 赞同：3
> 
> 时间：2008-09-18T17:13:55.213
> 
> 标签：maven-2, code-coverage, maven-plugin, cobertura

我们有一个多项目，我们正在尝试运行 Cobertura 测试覆盖率报告，作为我们 mvn 站点构建的一部分。我可以让 Cobertura 在子项目上运行，但它错误地报告 0% 的覆盖率，即使报告仍然突出显示单元测试命中的代码行。

我们正在使用 mvn 2.0.8。我试过跑步`mvn clean site`，`mvn clean site:stage`和`mvn clean package site`。我知道测试正在运行，它们出现在万无一失的报告中（txt/xml 和站点报告）。我在配置中遗漏了什么吗？Cobertura 是否不适用于多项目？

这是在父 .pom 中：

```
<build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>cobertura-maven-plugin</artifactId>
                <inherited>true</inherited>
                <executions>
                    <execution>
                        <id>clean</id>
                        <goals>
                            <goal>clean</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </pluginManagement>
</build>
<reporting>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>cobertura-maven-plugin</artifactId>
            <inherited>true</inherited>
        </plugin>
    </plugins>
</reporting> 
```

我尝试在子 .poms 中使用和不使用以下内容运行它：

```
 <reporting>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>cobertura-maven-plugin</artifactId>
        </plugin>
    </plugins>
</reporting> 
```

我在构建的输出中得到了这个：

```
...
[INFO] [cobertura:instrument]
[INFO] Cobertura 1.9 - GNU GPL License (NO WARRANTY) - See COPYRIGHT file
Instrumenting 3 files to C:\workspaces\sandbox\CommonJsf\target\generated-classes\cobertura
Cobertura: Saved information on 3 classes.
Instrument time: 186ms

[INFO] Instrumentation was successful.
...
[INFO] Generating "Cobertura Test Coverage" report.
[INFO] Cobertura 1.9 - GNU GPL License (NO WARRANTY) - See COPYRIGHT file
Cobertura: Loaded information on 3 classes.
Report time: 481ms

[INFO] Cobertura Report generation was successful. 
```

报告如下所示： ![科贝图拉报告](https://i.stack.imgur.com/D7yiM.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T09:38:27.720

我没有成功让 Cobertura 合并来自多个项目的报告。这通常是多项目报告的一个问题。

我们一直在评估[声纳](http://sonar.codehaus.org/)作为我们的指标报告的解决方案。它似乎在提供跨项目的汇总指标方面做得很好，包括多项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-23T14:46:57.057

我怀疑您在编译阶段缺少 cobertura 插件的执行，因此代码仅在运行测试后在站点生命周期中由报告插件检测。所以测试运行没有被选中，因为它们运行在非仪器代码上。更仔细地分析您的构建日志 - 如果我是对的，您会注意到在 cobertura:instrument 之前执行了安全测试。

我的配置与你的类似，但除了在 pluginManagement 中指定干净的执行（像你一样），我在 build plugins 部分明确指定了 cobertura 插件：

```
 <build>
  ...
    <plugins>
    ...
      <plugin>
        <inherited>true</inherited>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>cobertura-maven-plugin</artifactId>
        <version>${cobertura.plugin.version}</version>
      </plugin>
    </plugins>
  </build> 
```

我的配置工作正常，所有 Cobertura 的东西都在全球组织范围的 pom 中，所有项目都将其用作父级。

这样，项目不会在其 pom.xml 中指定任何与 Cobertura 相关的内容，但它们仍会生成覆盖率报告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-12T19:18:07.900

我实施的解决方案有点手动，但有效。它由几个步骤组成，其中一个是合并由 Cobertura 生成的几个 .ser 文件的步骤。这可以通过在 maven 任务中使用 cobertura-merge 命令行工具来完成。

根据您显示的输出是文件实际上没有检测，它告诉只有 3 个文件被检测。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-11T06:56:24.357

@Marco 是对的，仅通过 maven 无法正常实现这一点，因为 maven cobertura 插件缺少合并目标。

您可以通过混合使用 maven 和 ant 目标来实现它：http: [//thomassundberg.wordpress.com/2012/02/18/test-coverage-in-a-multi-module-maven-project/](http://thomassundberg.wordpress.com/2012/02/18/test-coverage-in-a-multi-module-maven-project/)

然而，如果您有一个单独的项目被测试，则无需合并。您可以在测试项目中，从被测项目中复制 .ser 文件和检测类：

```
//in test project
<plugin> 
<groupId>com.github.goldin</groupId>
<artifactId>copy-maven-plugin</artifactId>
<version>0.2.5</version>
<executions>
    <execution>
    <id>copy-cobertura-data-from-project-under-test</id>
    <phase>compile</phase>
    <goals>
        <goal>copy</goal>
    </goals>
    <configuration>
    <resources>
        <resource>
                        <directory>${project.basedir}/../<project-under-test>/target/cobertura</directory>
                            <targetPath>${project.basedir}/target/cobertura</targetPath>
                <includes>                  
                              <include>*.ser</include>
                </includes>
           </resource>
           <resource>
                    <directory>${project.basedir}/../<project-under-test>/target/generated-classes/cobertura/</directory>
                    <targetPath>${project.basedir}/target/generated-classes/cobertura</targetPath>
                    <preservePath>true</preservePath>
           </resource>
        </resources>
            </configuration>
        </execution>
</executions>
</plugin>

//in parent project
<build>
<plugins>
    <plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>cobertura-maven-plugin</artifactId>
    <configuration>
        <format>xml</format>
        <aggregate>true</aggregate>
    </configuration>
    <executions>
        <execution>
                    <goals>
                <goal>clean</goal>
            </goals>
        </execution>
    </executions>
</plugin>
    </plugins>
</build>
<reporting>
<plugins>
    <plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>cobertura-maven-plugin</artifactId>
    <version>${cobertura.version}</version>
        </plugin>
</plugins>
 </reporting> 
```

# c# - 分析 C#/.NET 应用程序

> ID：94581
> 
> 赞同：11
> 
> 时间：2008-09-18T17:16:36.363
> 
> 标签：c#, .net, visual-studio, profiling, profiler

您如何跟踪/分析您的 .NET 应用程序？MSDN 在线帮助提到了 Visual Studio Team（我没有）并且有 Windows Performance Toolkit。但是，您可以推荐其他解决方案吗？最好（当然）一种无需更改代码（手动）即可工作并且可以集成到 Visual Studio 中的解决方案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T17:44:04.800

另请参阅[此问题](https://stackoverflow.com/questions/49912/best-dotnet-memory-and-performance-profiler)。JetBrains dotTrace 是我发现的最好的 .NET 分析器（我几乎尝试了所有的分析器），因为它是唯一一个开销足够低来处理处理器密集型应用程序的分析器。它也简单、准确且设计精良 - 强烈推荐！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T17:17:04.723

生日快乐：

[http://www.jetbrains.com/profiler/](http://www.jetbrains.com/profiler/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-18T17:23:52.290

Ants Profiler 为我工作 [http://www.red-gate.com/products/ANTS_Profiler/](http://www.red-gate.com/products/ANTS_Profiler/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T17:20:23.873

[CLR Profiler](http://www.microsoft.com/downloads/details.aspx?FamilyId=A362781C-3870-43BE-8926-862B40AA0CD0&displaylang=en)相当不错。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-18T13:13:32.947

我认为这是最好的免费：http: [//www.productivity-boost.com/Download.aspx](http://www.productivity-boost.com/Download.aspx)

该网站是德文的，但您可以下载它，该软件是英文的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T17:18:10.210

我喜欢 dotTrace3.1 它对我来说效果很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T17:21:22.403

如果您正在寻找免费的东西，我使用 NProf。尽管它非常有限，并且可能会在某些程序上崩溃或挂起。

[http://nprof.sourceforge.net/Site/Description.html](http://nprof.sourceforge.net/Site/Description.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T17:24:18.153

不是免费的，但我只是在带有流的庞大代码库中遇到了一个棘手的问题。Visual Studio 的分析器让我很接近，但 Antz Profiler 将其锁定。它不是免费的，但它比设置 Visual Studio 轻松得多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T07:05:25.370

[.NET Memory Profiler](http://memprofiler.com/)是一个出色的内存使用分析工具。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-25T15:27:03.630

我们的团队使用[EQATEC Profiler](http://www.eqatec.com/tools/profiler)，我发现它简单易用。它无需更改源代码即可工作，但我认为 Visual Studio 集成是不可能的。

# java - 使用带有外部 src 属性的 javascript 的 javax.script 包

> ID：94582
> 
> 赞同：1
> 
> 时间：2008-09-18T17:16:48.263
> 
> 标签：java, javascript, javax.script

假设我有一些 javascript，如果在浏览器中运行会这样输入......

```
<script type="text/javascript"
    src="http://someplace.net/stuff.ashx"></script>

<script type="text/javascript">
   var stuff = null;
   stuff = new TheStuff('myStuff');
</script> 
```

...并且我想使用 java 1.6 中的 javax.script 包在 jvm 中（而不是在小程序中）运行此代码并获取内容。如何让引擎知道要构造的类的来源在远程 .ashx 文件中？

例如，我知道将 java 代码编写为...

```
ScriptEngineManager mgr = new ScriptEngineManager();
ScriptEngine engine = mgr.getEngineByName("JavaScript");

engine.eval( "stuff = new TheStuff('myStuff');" );
Object    obj = engine.get("stuff"); 
```

...但是“JavaScript”引擎默认情况下对 TheStuff 类一无所知，因为该信息位于远程 .ashx 文件中。我可以让它看看上面的 src 字符串吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T21:00:32.690

好像你在问：

> 如何`ScriptEngine`评估 URL 的内容而不仅仅是字符串？

那准确吗？

`ScriptEngine`不提供下载和评估 URL 内容的工具，但它很容易做到。 `ScriptEngine`允许您传入`Reader`将用于读取脚本的对象。

尝试这样的事情：

```
URL url = new URL( "http://someplace.net/stuff.ashx" );
InputStreamReader reader = new InputStreamReader( url.openStream() );
engine.eval( reader ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T21:01:02.627

您是否尝试从 java 1.6 小程序访问浏览器页面中的 javascript 对象？如果是这样，那你就走错了路。这不是脚本引擎的用途。它用于在 jvm 中运行 javascript，而不是用于小程序从浏览器中访问 javascript。

这是一个[博客条目](http://www.rgagnon.com/javadetails/java-0184.html)，可能会带您到某个地方，但看起来没有太多支持。

# integer - int32 的最大值是多少？

> ID：94591
> 
> 赞同：1379
> 
> 时间：2008-09-18T17:18:23.720
> 
> 标签：integer

我永远记不住号码。我需要一个记忆规则。

* * *

## 回答 #1

> 赞同：5064
> 
> 时间：2008-09-18T17:20:17.460

是 2,147,483,647。最简单的记忆方法是通过纹身。

* * *

## 回答 #2

> 赞同：493
> 
> 时间：2008-09-18T17:23:34.537

我能想到的最正确的答案是`Int32.MaxValue`。

* * *

## 回答 #3

> 赞同：439
> 
> 时间：2010-06-01T17:05:17.017

如果您认为以 10 为基数很难记住该值，请尝试以 2 为基数：1111111111111111111111111111111

* * *

## 回答 #4

> 赞同：316
> 
> 时间：2015-10-26T22:19:25.220

如果您能记住整个 Pi 编号，那么您要查找的数字位于 Pi 十进制数字的 1,867,996,680 到 1,867,996,689 之间

> 数字字符串 2147483647 出现在 Pi 的十进制数字 1,867,996,680 处。3.14......86181221809936452346 **2147483647** 10527835665425671614...

来源：[http ://www.subidiom.com/pi/](http://www.subidiom.com/pi/)

* * *

## 回答 #5

> 赞同：290
> 
> 时间：2008-09-18T17:24:53.177

它是 10 位数字，所以假装它是一个电话号码（假设你在美国）。214-748-3647。我不建议调用它。

* * *

## 回答 #6

> 赞同：172
> 
> 时间：2008-09-18T17:27:42.717

与其将其视为一个大数字，不如尝试将其分解并寻找相关的想法，例如：

*   最多 2 次斯诺克休息（最多 147 次）
*   4年（48个月）
*   3年（36个月）
*   4年（48个月）

以上适用于最大的负数；正是负一。

也许上面的分解对你来说不会再令人难忘了（这几乎不是令人兴奋的！），但希望你能想出一些想法！

* * *

## 回答 #7

> 赞同：144
> 
> 时间：2012-06-15T20:04:05.697

最大负（32 位）值：-2147483648
(1 << 31)

最大正（32 位）值：2147483647
~(1 << 31)

助记词：“喝醉了又名角质”

```
drunk ========= Drinking age is 21
AK ============ AK 47
A ============= 4 (A and 4 look the same)
horny ========= internet rule 34 (if it exists, there's 18+ material of it) 

21 47 4(years) 3(years) 4(years)
21 47 48       36       48 
```

* * *

## 回答 #8

> 赞同：75
> 
> 时间：2010-06-01T16:44:09.660

无论如何，采用这个正则表达式（它确定字符串是否包含一个不大于 Int32.MaxValue 的十进制形式的非负整数）

`[0-9]{1,9}|[0-1][0-9]{1,8}|20[0-9]{1,8}|21[0-3][0-9]{1,7}|214[0-6][0-9]{1,7}|2147[0-3][0-9]{1,6}|21474[0-7][0-9]{1,5}|214748[0-2][0-9]{1,4}|2147483[0-5][0-9]{1,3}|21474836[0-3][0-9]{1,2}|214748364[0-7]`

也许它会帮助你记住。

* * *

## 回答 #9

> 赞同：61
> 
> 时间：2013-07-05T11:11:48.123

这就是我记得的方式`2147483647`：

*   214 - 因为 2.14 大约是 pi-1
*   48 = 6*8
*   64 = 8*8

横写这些：

```
214_48_64_
and insert:
   ^  ^  ^
   7  3  7 - which is Boeing's airliner jet (thanks, sgorozco) 
```

现在你有 2147483647。

希望这至少有一点帮助。

* * *

## 回答 #10

> 赞同：55
> 
> 时间：2008-09-18T17:48:38.343

```
2^(x+y) = 2^x * 2^y

2^10 ~ 1,000
2^20 ~ 1,000,000
2^30 ~ 1,000,000,000
2^40 ~ 1,000,000,000,000
(etc.)

2^1 = 2
2^2 = 4
2^3 = 8
2^4 = 16
2^5 = 32
2^6 = 64
2^7 = 128
2^8 = 256
2^9 = 512 
```

所以，2^31（有符号整数最大值）是 2^30（约 10 亿）乘以 2^1 (2)，或约 20 亿。而 2^32 是 2^30 * 2^2 或大约 40 亿。这种近似方法足够准确，甚至可以达到 2^64 左右（误差增长到大约 15%）。

如果你需要一个准确的答案，那么你应该拿出一个计算器。

方便的字对齐容量近似值：

*   2^16 ~= 64000 // uint16
*   2^32 ~= 40 亿 // uint32, IPv4, unixtime
*   2^64 ~= 16 quintillion（又名 160 亿或 1600 万万亿） // uint64, "bigint"
*   2^128 ~= 256 quintillion quintillion（又名 256 万亿万亿）// IPv6，GUID

* * *

## 回答 #11

> 赞同：46
> 
> 时间：2008-09-18T17:47:13.653

只需使用任何像样的计算器并在十六进制模式下输入“7FFFFFFF”，然后切换到十进制。

2147483647。

* * *

## 回答 #12

> 赞同：36
> 
> 时间：2012-11-27T18:59:40.073

它是关于`2.1 * 10^9`。不需要知道确切的`2^{31} - 1 = 2,147,483,647`。

# C

你可以像这样在 C 中找到它：

```
#include <stdio.h>
#include <limits.h>

main() {
    printf("max int:\t\t%i\n", INT_MAX);
    printf("max unsigned int:\t%u\n", UINT_MAX);
} 
```

给出（好吧，没有`,`）

```
max int:          2,147,483,647
max unsigned int: 4,294,967,295 
```

# C++ 11

```
std::cout << std::numeric_limits<int>::max() << "\n";
std::cout << std::numeric_limits<unsigned int>::max() << "\n"; 
```

# 爪哇

你也可以用 Java 来获得它：

```
System.out.println(Integer.MAX_VALUE); 
```

但请记住，Java 整数始终是有符号的。

# 蟒蛇2

Python 具有任意精度的整数。但在 Python 2 中，它们被映射到 C 整数。所以你可以这样做：

```
import sys
sys.maxint
>>> 2147483647
sys.maxint + 1
>>> 2147483648L 
```

所以 Python 切换到`long`当整数大于`2^31 -1`

* * *

## 回答 #13

> 赞同：35
> 
> 时间：2013-05-08T19:31:23.547

这里有一个记忆2**31的助记词，减一得到最大整数值。

a=1,b=2,c=3,d=4,e=5,f=6,g=7,h=8,i=9

```
Boys And Dogs Go Duck Hunting, Come Friday Ducks Hide
2    1   4    7  4    8        3    6      4     8 
```

我经常使用 2 到 18 的幂来记住它们，但即使我也没有费心记住 2**31。太容易根据需要计算或使用常数，或估计为2G。

* * *

## 回答 #14

> 赞同：31
> 
> 时间：2013-12-04T11:38:25.580

32位，1位符号，31位信息：

```
2^31 - 1 = 2147483647 
```

为什么是-1？
因为第一个为零，所以最大的是**计数减一**。

**编辑[cantfindaname88](https://stackoverflow.com/users/695655/cantfindaname88)**

计数是 2^31，但最大的不能是 2147483648 (2^31)，因为我们从 0 开始计数，而不是从 1。

```
Rank   1 2 3 4 5 6 ... 2147483648
Number 0 1 2 3 4 5 ... 2147483647 
```

另一种只有 3 位的解释：1 表示符号，2 表示信息

```
2^2 - 1 = 3 
```

在所有可能的 3 位值下方：（2^3 = 8 个值）

```
1: 100 ==> -4
2: 101 ==> -3
3: 110 ==> -2
4: 111 ==> -1
5: 000 ==>  0
6: 001 ==>  1
7: 010 ==>  2
8: 011 ==>  3 
```

* * *

## 回答 #15

> 赞同：30
> 
> 时间：2008-09-18T17:19:40.987

好吧，它有 32 位，因此可以存储 2^32 个不同的值。其中一半是负面的。

解是 2,147,483,647

最低的是 -2,147,483,648。

（请注意，还有一个负值。）

* * *

## 回答 #16

> 赞同：28
> 
> 时间：2017-07-15T09:44:00.173

**好吧，除了笑话，如果你真的在寻找有用的记忆规则，我总是用它来记住大数字。**

您需要将您的号码分解为 3-4 位数字，并使用手机键盘上的投影直观地记住它们。在图片上显示更容易：

[![在此处输入图像描述](https://i.stack.imgur.com/rCL8f.png)](https://i.stack.imgur.com/rCL8f.png)

如您所见，从现在开始**您只需要记住 3 个形状，其中 2 个看起来像俄罗斯方块 L，一个看起来像勾号**。这绝对比记住一个 10 位数字要容易得多。

当您需要回忆数字时，只需回忆形状，想象/看一下手机键盘并将形状投影在上面。也许一开始你必须看一下键盘，但经过一些练习后，你会记得数字是从左上角到右下角的，所以你可以在脑海中简单地想象它。

只需确保记住形状的方向和每个形状中的位数（例如，在 2147483647 示例中，我们有一个 4 位数的俄罗斯方块 L 和一个 3 位数的 L）。

您可以使用此技术轻松记住任何重要的数字（例如，我记住了我的 16 位信用卡号等）。

* * *

## 回答 #17

> 赞同：21
> 
> 时间：2012-09-14T15:50:14.200

对整数执行此操作的最简单方法是使用十六进制，前提是没有像 Int.maxInt() 这样的东西。原因是这样的：

最大无符号值

```
8-bit 0xFF
16-bit 0xFFFF
32-bit 0xFFFFFFFF
64-bit 0xFFFFFFFFFFFFFFFF
128-bit 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF 
```

有符号值，使用 7F 作为最大有符号值

```
8-bit 0x7F
16-bit 0x7FFF
32-bit 0x7FFFFFFF
64-bit 0x7FFFFFFFFFFFFFFF 
```

有符号值，使用 80 作为最大有符号值

```
8-bit 0x80
16-bit 0x8000
32-bit 0x80000000
64-bit 0x8000000000000000 
```

这是如何运作的？这与二进制策略非常相似，每个十六进制数字正好是 4 位。此外，许多编译器对十六进制的支持比对二进制的支持要好得多。

```
F hex to binary: 1111
8 hex to binary: 1000
7 hex to binary: 0111
0 hex to binary: 0000 
```

因此 7F 等于 01111111 / 7FFF 等于 0111111111111111。此外，如果您将其用于“异常高的常数”，则 7F... 是安全的十六进制，但尝试 7F 和 80 并打印它们很容易到你的屏幕上看看它是哪一个。

0x7FFF + 0x0001 = 0x8000，所以你的损失只是一个数字，所以使用 0x7F... 通常对于更可靠的代码来说并不是一个糟糕的权衡，尤其是当你开始使用 32 位或更多位时

* * *

## 回答 #18

> 赞同：21
> 
> 时间：2015-03-24T19:09:00.573

首先写出 47 两次，（你喜欢[Agent 47](http://en.wikipedia.org/wiki/Hitman:_Agent_47)，对吗？），如图所示保留空格（每个破折号是一个数字的插槽。前 2 个插槽，然后是 4 个）

```
--47----47 
```

想想你`12`手头有（因为 12 = 一打）。乘以`4`, 代理 47 号码的第一个数字，即`47`，并将结果放在您已经拥有的第一对的右侧

```
12 * 4 = 48
--4748--47 <-- after placing 48 to the right of first 47 
```

然后乘以`12`（`3`为了使代理 47 的号码的第二个数字，即`7`，你需要`7 - 4 = 3`）并将结果放在前 2 对的右侧，最后一个 pair-slot

```
12 * 3 = 36
--47483647 <-- after placing 36 to the right of first two pairs 
```

最后从最右边的数字（在本例中为 2）开始从您的手上一个一个地拖动数字并将它们放置在您获得的第一个空槽中

```
2-47483647 <-- after placing 2
2147483647 <-- after placing 1 
```

你有它！对于负限制，您可以将其视为*绝对值*比正限制多 1。

多练习几次，你就会掌握窍门！

* * *

## 回答 #19

> 赞同：20
> 
> 时间：2008-09-18T17:57:51.630

2GB

（答案是否有最小长度？）

* * *

## 回答 #20

> 赞同：15
> 
> 时间：2008-09-18T17:23:31.040

假设 .NET -

```
Console.WriteLine(Int32.MaxValue); 
```

* * *

## 回答 #21

> 赞同：15
> 
> 时间：2014-09-05T03:15:09.277

如果您碰巧知道您的[ASCII 表](https://en.wikipedia.org/wiki/ASCII#ASCII_printable_code_chart)，而不是`MaxInt`：
`!GH6G = 21 47 48 36 47`

* * *

## 回答 #22

> 赞同：15
> 
> 时间：2015-02-26T13:33:47.373

**记住它的最佳规则是：**
**21**（魔术数字！）
**47**（记住它）
**48**（顺序！）
**36**（21 + 15，两个魔术！）
**47**再一次

此外，记住 5 对比记住 10 个数字更容易。

* * *

## 回答 #23

> 赞同：14
> 
> 时间：2009-03-03T11:42:30.103

最容易记住的方法是看 `std::numeric_limits< int >::max()`

例如（[来自 MSDN](http://msdn.microsoft.com/en-us/library/s086ab1z%28v=vs.80%29.aspx)），

```
// numeric_limits_max.cpp

#include <iostream>
#include <limits>

using namespace std;

int main() {
   cout << "The maximum value for type float is:  "
        << numeric_limits<float>::max( )
        << endl;
   cout << "The maximum value for type double is:  "
        << numeric_limits<double>::max( )
        << endl;
   cout << "The maximum value for type int is:  "
        << numeric_limits<int>::max( )
        << endl;
   cout << "The maximum value for type short int is:  "
        << numeric_limits<short int>::max( )
        << endl;
} 
```

* * *

## 回答 #24

> 赞同：14
> 
> 时间：2010-06-01T16:50:14.433

有趣的是，Int32.MaxValue 的字符数超过了 2,147,486,647。

但话又说回来，我们确实有代码完成，

所以我想我们真正需要记住的是`Int3<period>M<enter>`，在 Visual Studio 中只需输入 6 个字符。

**更新** 由于某种原因，我被否决了。我能想到的唯一原因是他们不理解我的第一句话。

“Int32.MaxValue”最多输入 14 个字符。2,147,486,647 需要输入 10 或 13 个字符，具体取决于您是否输入逗号。

* * *

## 回答 #25

> 赞同：10
> 
> 时间：2008-09-18T17:58:45.607

请记住 2^(10*x) 大约是 10^(3*x) - 你可能已经习惯了千字节/千字节等。那就是：

```
2^10 = 1024                ~= one thousand
2^20 = 1024^2 = 1048576    ~= one million
2^30 = 1024^3 = 1073741824 ~= one billion 
```

由于 int 使用 31 位（+ ~1 位作为符号），只需将 2^30 加倍即可获得大约 20 亿。对于使用 32 位的无符号整数，再次加倍为 40 亿。当然，误差系数越大，你走的越大，但你不需要记住确切的值（如果你需要它，你应该为它使用一个预定义的常量）。近似值足以注意到某物何时可能危险地接近溢出。

* * *

## 回答 #26

> 赞同：9
> 
> 时间：2015-08-05T05:15:07.617

这就是我如何记住 2,147,483,647

## 到遥远的大草原四分之一擎天柱三重奏被诅咒四十

```
2 - To
1 - A
4 - Far
7 - Savannah
4 - Quarter
8 - Optimus
3 - Trio
6 - Hexed
4 - Forty
7 - Septenary 
```

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2009-03-03T11:18:59.647

你什么意思？应该很容易记住它是 2^32。如果你想要一个规则来记住那个数字的值，一个方便的经验法则是在二进制和十进制之间进行转换：

2^10 ~ 1000

这意味着 2^20 ~ 1,000,000

和 2^30 ~ 1,000,000,000

加倍 (2^31) 大约是 20 亿，再加倍 (2^32) 是 40 亿。

这是粗略估计任何二进制数的简单方法。二进制的 10 个零变成十进制的 3 个零。

* * *

## 回答 #28

> 赞同：6
> 
> 时间：2013-12-04T11:51:35.707

**在 Objective-C (iOS & OSX) 中，只需要记住这些宏：**

```
#define INT8_MAX         127
#define INT16_MAX        32767
#define INT32_MAX        2147483647
#define INT64_MAX        9223372036854775807LL

#define UINT8_MAX         255
#define UINT16_MAX        65535
#define UINT32_MAX        4294967295U
#define UINT64_MAX        18446744073709551615ULL 
```

* * *

## 回答 #29

> 赞同：5
> 
> 时间：2009-06-17T09:16:25.397

Int32 表示您有 32 位可用于存储您的号码。最高位是符号位，这表明数字是正数还是负数。所以你有 2^31 位用于正数和负数。

零是一个正数，你得到（前面提到的）的逻辑范围

+2147483647 至 -2147483648

如果您认为它很小，请使用 Int64：

+9223372036854775807 至 -9223372036854775808

为什么你要记住这个数字？在您的代码中使用？您应该始终在代码中使用 Int32.MaxValue 或 Int32.MinValue，因为它们是静态值（在 .net 核心中），因此使用起来比使用代码创建新的 int 更快。

我的声明：如果凭记忆知道这个数字..你只是在炫耀！

* * *

## 回答 #30

> 赞同：5
> 
> 时间：2016-01-27T08:21:07.543

记住这一点：21 IQ 第 47 项

它可以用任何电话板进行解码，或者您可以自己在纸上写下一个。

为了记住“21 IQ ITEM 47”，我会选择“Hitman：Codename 47 有 21 个任务，每个 IQ ITEM 都是自己的”。

或者“我每天21:47刷牙，因为我智商高，不喜欢嘴里的东西”。

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2008-09-18T18:09:49.870

在路径上使用 Groovy：

```
groovy -e " println Integer.MAX_VALUE " 
```

（在 Java 上下文中，Groovy 对于快速参考非常有用。）

* * *

## 回答 #32

> 赞同：4
> 
> 时间：2017-06-20T15:07:24.943

请记住，这是第八个梅森素数。

如果这太难了，它也是仅有的四个已知*双*梅森素数中的第三个。

**根据评论请求编辑：**

Euclid-Euler 定理指出，每个偶数都具有 2^(n - 1) (2^n - 1) 的形式，其中 2^n - 1 是素数。2^n - 1 形式的素数称为梅森素数，并且要求 n 本身是素数。

我们知道 INT32 的长度当然是 32 位。鉴于对 2 的补码的普遍接受的理解，带符号的 INT32 是 32 位 - 1 位。

为了找到具有给定位数的二进制数的大小，我们通常将 2 提高到 n 次幂，负 1，其中 n 等于位数。

因此，幅度计算是 2^(32 - 1) - 1 = 2^31 - 1。31 是素数，如上所述，这种形式的素数是梅森素数。我们可以通过简单地计算它们来证明它是其中的八个。有关更多详细信息，请询问欧拉，或者可能是伯努利（他写信给谁）。

请参阅：[https ://books.google.ie/books?id=x7p4tCPPuXoC&printsec=frontcover&dq=9780883853283&hl=en&sa=X&ved=0ahUKEwilzbORuJLdAhUOiaYKHcsZD-EQ6AEIKTAA#v=onepage&q=9780883853283&f=false](https://books.google.ie/books?id=x7p4tCPPuXoC&printsec=frontcover&dq=9780883853283&hl=en&sa=X&ved=0ahUKEwilzbORuJLdAhUOiaYKHcsZD-EQ6AEIKTAA#v=onepage&q=9780883853283&f=false)

* * *

## 回答 #33

> 赞同：4
> 
> 时间：2018-05-22T14:58:51.423

2147483647

以下是您需要记住的内容：

*   是**20亿**。
*   接下来的三个三元组是这样增加的：**100s、400s、600s**
*   第一个和最后一个三元组需要加**3**，以便四舍五入到**50**（例如 147 + 3 = 150 & 647 + 3 = 650）
*   第二个三元组需要减去**3**以将其四舍五入为**80**（例如 483 - 3 = 480）

因此 2, 147, 483, 647

* * *

## 回答 #34

> 赞同：4
> 
> 时间：2018-11-15T22:32:30.363

我在 C# 中制作了几个天才方法，您可以在生产环境中利用它们：

```
public static int GetIntMaxValueGenius1()
{
    int n = 0;
    while (++n > 0) { }
    return --n;
}

public static int GetIntMaxValueGenius2()
{
    int n = 0;
    try
    {
        while (true)
            n = checked(n + 1);
    }
    catch { }
    return n;
} 
```

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2011-11-30T18:53:10.663

这就是我记得的方式......
在十六进制中，一个数字代表四位，所以 4 * 8 = 32，所以最大有符号的 32 位 int 是：

```
0xFFFFFFFF >> 1 # => 2147483647 
```

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2017-04-22T21:27:11.040

永远不要忘记任何类型的最大值：

如果它有 32 位，则最大可能值将是数字 1 的 32 位：

[![在此处输入图像描述](https://i.stack.imgur.com/A3fj7.png)](https://i.stack.imgur.com/A3fj7.png)

结果将是十进制的 4294967295：

[![在此处输入图像描述](https://i.stack.imgur.com/ZQscf.png)](https://i.stack.imgur.com/ZQscf.png)

但是，由于也有负数的表示，所以将 4294967295 除以 2 得到 2147483647。

因此，一个 32 位整数能够表示 -2147483647 到 2147483647

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2011-07-07T15:19:20.147

这很容易记住。在十六进制中，一位是 4 位。因此，对于 unsigned int 写入`0x`和 8 `f`s ( `0xffffffff`) 到 Python 或 Ruby shell 以获取以 10 为底的值。如果您需要带符号的值，请记住最高位用作符号。所以你必须把它排除在外。您只需要记住低 3 位为 1，第 4 位为 0 的数字等于 7，因此写入`0x7fffffff`Python 或 Ruby shell。你也可以写`0x100000000 - 1`and `0x80000000 - 1`，如果这样你更容易记住的话。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2014-01-18T03:13:13.827

你会发现二进制 Int32 的最大值是 1111111111111111111111111111111 但在十进制中你会发现它是 2147483647 或 2^31-1 或 Int32.MaxValue

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2017-04-10T18:09:00.970

使用 Java 9 的 REPL，[jshell](https://en.wikipedia.org/wiki/JShell)：

```
$ jshell
|  Welcome to JShell -- Version 9-Debian

jshell> System.out.println(Integer.MAX_VALUE)
2147483647 
```

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2018-07-05T02:29:55.573

在 Python 中尝试：

```
>>> int('1' * 31, base=2)
2147483647 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2017-02-06T22:21:20.847

在 C`INT32_MAX`之后使用`#include <stdint.h>`. `INT32_MAX`在C++ 中使用`#include <cstdint>`.

或`INT_MAX`用于特定于平台的大小或`UINT32_MAX`或`UINT_MAX`用于`unsigned int`. 请参阅[http://www.cplusplus.com/reference/cstdint/](http://www.cplusplus.com/reference/cstdint/)和[http://www.cplusplus.com/reference/climits/](http://www.cplusplus.com/reference/climits/)。

或`sizeof(int)`。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2017-07-28T18:54:43.857

一般来说，你可以做一个反映 Int32 本质的简单操作，用 1 填充所有可用位 - 这是你可以轻松记住的东西。它在大多数语言中的工作方式基本相同，但我以 Python 为例：

```
max = 0
bits = [1] * 31 # Generate a "bit array" filled with 1's
for bit in bits:
    max = (max << 1) | bit
# max is now 2147483647 
```

对于无符号 Int32，将其设为 32 而不是 31 1。

但是自从贴了一些更冒险的方法后，我开始想到公式，只是为了好玩……

**公式 1**（如果没有给出运算符，则连接数字）

*   a = 4
*   b = 8
*   BA/A
*   ab-1
*   抗体
*   ab-ab
*   ab-1

*Python 快速检查*

```
a = 4
b = 8
ab = int('%d%d' % (a, b))
ba = int('%d%d' % (b, a))
'%d%d%d%d%d' % (ba/a, ab-1, ab, ab-a-b, ab-1)
# gives '2147483647' 
```

**公式 2**

*   x = 48
*   x/2-3
*   x-1
*   X
*   x*3/4
*   x-1

*Python 快速检查*

```
x = 48
'%d%d%d%d%d' % (x/2-3, x-1, x, x*3/4, x-1) 
# gives '2147483647' 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2019-07-09T18:33:39.913

“如果一个大整数没有被召回，你就召回这个助记符。”

现在计算每个单词中的字母。

* * *

## 回答 #44

> 赞同：-1
> 
> 时间：2016-06-26T22:18:01.353

```
max_signed_32_bit_num = 1 << 31 - 1;  // alternatively ~(1 << 31) 
```

无论如何，编译器都应该优化它。

我更`1 << 31 - 1`喜欢

`0x7fffffff`因为你不需要 count `f`s

`unsigned( pow( 2, 31 ) ) - 1`因为你不需要`<math.h>`

* * *

## 回答 #45

> 赞同：-1
> 
> 时间：2016-10-26T14:53:27.487

它是 2 ^(31) - 1（32 位，1 用于符号）。

如果您想要一个近似值，请使用 2 ^(10) = 1024 ≈ 10 ³，因此 2 ^(31) ≈ 2*10 ⁹。如果您想手动计算一个精确值，请使用平方乘幂得到 2 ^(32) = 2 ^((2 ⁵ ))并除以 2。您只需平方五次即可得到 2 ^(32)：

```
2*2 = 4
4*4 = 16
16*16 = 256
256*256 = 25*25*100 + 2*250*6 + 36 = 62500 + 3000 + 36 = 65536
65536*65536 =65000*65000 + 2*65000*536 + 536*536 =  
4225000000 + 130000*536 + (250000 + 3600 + 36*36) =
4225000000 + 69680000 + 250000 + 3600 + 1296 =
4294967296 
```

将其除以 2 并减去 1 得到 2,147,483,647。如果您不需要所有数字，而只想说前三个有效数字，则每个平方步骤的计算都非常容易。

# statistics - 您如何实时可视化日志文件？

> ID：94592
> 
> 赞同：9
> 
> 时间：2008-09-18T17:18:28.947
> 
> 标签：statistics, visualization, logging

有时它可能很有用，但主要是看起来很酷或令人印象深刻，以可视化日志文件（从 http 请求和带宽使用到每天喝的咖啡）。我知道[Visitorville](http://www.visitorville.com/)，我认为它看起来有点傻，然后是[gltail](http://www.fudgie.org/)。

您如何实时“可视化”您的日志文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T16:18:11.870

还有logstalgia工具。可视化 Apache 日志。有关更多详细信息和 youtube 视频，请参阅[http://code.google.com/p/logstalgia/](http://code.google.com/p/logstalgia/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T17:26:25.997

你可以看看 Apache Chainsaw。这个漂亮的工具允许从几乎每一个地方记录收入，并具有实时过滤和收集功能。如果你有一个已经写好的日志，我不确定它是否可以读取它，我上次使用它已经有一段时间了（对于我们的 JBoss 服务器的原型设计阶段非常有用）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T17:34:38.737

Google 发布了[Visualization API](http://code.google.com/apis/visualization/)，它可能足够灵活，可以帮助您：

> Google 可视化 API 允许您访问可以显示的多个结构化数据源，从大量可视化中进行选择。Google 可视化 API 还提供了一个平台，可用于创建、共享和重用由整个开发人员社区编写的可视化。

它需要一些 Javascript 知识，包括 Google Docs 集成、电子表格集成。查看[图库](http://code.google.com/apis/visualization/documentation/gallery.html)以获取一些示例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-07T13:50:16.820

你可以看看这个。 [http://www.intalisys.com](http://www.intalisys.com)。3D 实时可视应用

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T17:38:23.033

我们使用[Awk](http://www.vectorsite.net/tsawk.html)和 Perl 脚本来解析日志文件并创建摘要报告和“数据库”（从技术上讲，数据库中的每一行对应于一个独特的事件，其中包含许多关于该事件的数据列，但不以传统的数据库格式存储。我们'正朝着那个方向前进）。我喜欢 Awk，因为您可以使用正则表达式快速搜索日志文件中的特定字符串，保留计数器并从日志文件条目中收集数据，并使用该数据进行各种计算。然后使用您最喜欢的绘图软件。我们使用 Excel，主要是因为这就是我开始这份工作之前的内容。我更喜欢 MATLAB，它是基于 gnuplot 构建的开源表亲[Octave 。](http://www.gnu.org/software/octave/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-11T16:17:11.020

我更喜欢[Sawmill](http://www.sawmill.net/features.html)来可视化数据。您基本上可以针对它抛出任何日志文件，它不仅会自动检测其结构*，还会决定如何分析它。即使您有自定义日志文件，您仍然可以定义应分析和可视化的内容和方式。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-11-07T14:07:56.147

我主要使用[R](http://www.r-project.org/)来可视化数据，但我也听说过[Orange](http://orange.biolab.si/)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-26T20:09:11.297

不确定它是否适合这个问题，但我刚刚发布了这个：

*   [numStepCsvLogVis - 分析 CSV 格式的日志文件数据](http://sdaaubckp.sourceforge.net/numStepCsvLogVis/)

![numStepCsvLogVis](https://i.stack.imgur.com/sZift.png)

它使用 Python 的`matplotlib`，其动机是需要在 C 中调试内核循环缓冲区操作（和变量）的上下文中可视化 syslog 数据；它通过使用 CSV 文件格式作为日志文件数据的中介来进行可视化（我无法简单地解释它 - 请查看 README 以获得更多详细信息）。

它有一个在终端中访问的“步进”播放器，并且可以处理“实时”`stdin`输入，但不幸的是，当情节渲染时，我无法获得比 1 FPS 更好的响应，所以我不会真正称其为“实时”*本身*- 但是您可以使用它最终生成情节动画的声音视频。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-06-20T10:27:41.477

一个简单的解决方案是将[Logstalgia](https://code.google.com/p/logstalgia/)与轻量级[local-web-server](https://github.com/75lb/local-web-server)一起使用。

先安装上面的。然后，从您站点的根文件夹中实时可视化您的日志：

```
$ ws --log-format default | logstalgia - 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T17:23:12.023

使用 SciTe、Notepad++ 或其他具有文件处理例程的强大文本编辑器，因此您可以创建一个脚本来为日志的某些部分着色或从中删除一些不重要的行

# unix - AF_UNIX 本地数据报套接字的自动命名？

> ID：94594
> 
> 赞同：7
> 
> 时间：2008-09-18T17:18:31.757
> 
> 标签：unix, sockets, bind, local, datagram

我正在使用 unix 本地套接字（AF_UNIX 地址系列，即**不是 UDP**）上的数据报实现一个简单的服务。服务器绑定到一个公共地址，它接收请求就好了。不幸的是，在回复时，`sendto`除非客户端也被绑定，否则会失败。（常见的错误是`Transport endpoint is not connected`）。

绑定到一些随机名称（基于文件系统或抽象）有效。但我想避免这种情况：我是谁来保证我选择的名字不会发生冲突？

unix 套接字的流模式文档告诉我们，`connect`如果它们还没有抽象名称，那么它们将在时间分配给它们。这样的功能可用于面向数据报的套接字吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-12-15T16:58:38.433

我引用的[unix(7)](http://linux.die.net/man/7/unix)手册页包含有关自动绑定 UNIX 套接字的以下信息：

> 如果 bind(2) 调用将 addrlen 指定为 sizeof(sa_family_t)，或者为未显式绑定到地址的套接字指定了 SO_PASSCRED 套接字选项，则套接字将自动绑定到抽象地址。

这就是 Linux 内核检查地址长度是否等于 sizeof(short) 的原因，因为 sa_family_t 是一个short。Rob 的出色答案引用的另一个 unix(7) 手册页说客户端套接字总是在连接时自动绑定，但是因为 SOCK_DGRAM 套接字是无连接的（尽管在它们上调用了连接），我相信这仅适用于 SOCK_STREAM 套接字。

另请注意，当提供您自己的抽象命名空间套接字名称时，此命名空间中的套接字地址由 sun_path 中的附加字节给出，这些字节由地址结构的指定长度覆盖。

```
struct sockaddr_un me;
const char name[] = "\0myabstractsocket";
me.sun_family = AF_UNIX;
// size-1 because abstract socket names are not null terminated
memcpy(me.sun_path, name, sizeof(name) - 1);
int result = bind(fd, (void*)&me, sizeof(me.sun_family) + sizeof(name) - 1); 
```

sendto() 同样应该限制地址长度，而不是通过 sizeof(sockaddr_un)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-20T06:15:00.623

我假设您正在运行 Linux；我不知道这个建议是否适用于 SunOS 或任何 UNIX。

首先，答案：在socket()之后和connect()或者第一个sendto()之前，尝试添加这段代码：

```
struct sockaddr_un me;
me.sun_family = AF_UNIX;
int result = bind(fd, (void*)&me, sizeof(short)); 
```

现在，解释：[unix(7)](http://www.linuxmanpages.com/man7/unix.7.php)手册页是这样说的：

> 当套接字连接并且它还没有本地地址时，将自动生成抽象命名空间中的唯一地址。

可悲的是，手册页是谎言。

检查[Linux 源代码](http://lxr.linux.no/linux+v2.6.26.5/net/unix/af_unix.c#L925)，我们看到 unix_dgram_connect() 只有在套接字标志中设置了 SOCK_PASSCRED 时才调用 unix_autobind()。由于我不知道 SOCK_PASSCRED 是什么，现在是凌晨 1:00，我需要寻找另一种解决方案。

检查[unix_bind](http://lxr.linux.no/linux+v2.6.26.5/net/unix/af_unix.c#L765)，我注意到如果传入的大小等于“sizeof(short)”，则 unix_bind 调用 unix_autobind。因此，上面的解决方案。

祝你好运，早上好。

抢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-16T12:35:03.267

有点迟到了，但是对于像我一样使用谷歌找到这个的人。Rob Adam 的回答帮助我得到了“真正”的答案：只需使用 set (level `SO_SOCKET`, see `man 7 unix`) 设置`SO_PASSCRED`为 1。不需要愚蠢的绑定。

我在 PHP 中使用了它，但它没有`SO_PASSCRED`定义（愚蠢的 PHP）。但是，如果您自己定义它，它仍然有效。在我的电脑上，它的值是 16，我认为它可以很方便地工作。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-18T18:07:36.473

我不太确定我是否完全理解您的问题，但这是我刚刚编写的回显服务器的数据报实现。您可以看到服务器在发送它的同一 IP/PORT 上响应客户端。

这是代码

一、服务器（监听器）

```
from socket import *
import time
class Listener:
    def __init__(self, port):
        self.port = port
        self.buffer = 102400

    def listen(self):

        sock = socket(AF_INET, SOCK_DGRAM)
        sock.bind(('', self.port))

        while 1:
            data, addr = sock.recvfrom(self.buffer)
            print "Received: " + data
            print "sending to %s" % addr[0]
            print "sending data %s" % data
            time.sleep(0.25)
            #print addr # will tell you what IP address the request came from and port
            sock.sendto(data, (addr[0], addr[1]))
            print "sent"
        sock.close()

if __name__ == "__main__":
    l = Listener(1975)
    l.listen() 
```

现在，从监听器接收响应的客户端（发送者）

```
from socket import *
from time import sleep
class Sender:
    def __init__(self, server):
       self.port = 1975
       self.server = server
       self.buffer = 102400

    def sendPacket(self, packet):
        sock = socket(AF_INET, SOCK_DGRAM)
        sock.settimeout(10.75)

        sock.sendto(packet, (self.server, int(self.port)))

        while 1:
            print "waiting for response"
            data, addr = sock.recvfrom(self.buffer)
            sock.close()
            return data

if __name__ == "__main__":
        s = Sender("127.0.0.1")
        response = s.sendPacket("Hello, world!")
        print response 
```

# wcf - 在 Silverlight 中捕获 WCF 异常的最佳方法是什么？

> ID：94610
> 
> 赞同：14
> 
> 时间：2008-09-18T17:20:31.703
> 
> 标签：wcf, silverlight, exception

我有一个使用 WCF 服务的 Silverlight 2 应用程序。因此，它对服务方法的所有调用使用异步回调。如果在这些调用之一之前或期间服务未运行、崩溃或网络中断等，则会按预期生成异常。问题是，我不知道如何捕捉这个异常。

*   因为它是一个异步调用，所以我不能用 try/catch 块包装我的开始调用，并让它拾取在程序从该点继续运行之后发生的异常。

*   因为服务代理是自动生成的，所以我不能在每个生成的调用 EndInvoke 的函数上放置一个 try/catch 块（异常实际出现的地方）。这些生成的函数也被调用堆栈中的外部代码包围，因此堆栈中也没有其他地方可以放置 try/catch。

*   我不能将 try/catch 放在我的回调函数中，因为异常发生在它们被调用之前。

*   我的 App.xaml.cs 中有一个 Application_UnhandledException 函数，它捕获所有未处理的异常。我可以使用它，但这似乎是一种混乱的方式。我宁愿将此函数保留用于真正意外的错误（也称为错误），而不是在我想以特定方式处理的每种情况下都使用此函数中的代码。

我错过了一个明显的解决方案吗？还是我使用 Application_UnhandledException 卡住了？

[编辑]
如下所述，Error 属性正是我想要的。让我陷入循环的是，异常被抛出并且似乎未被捕获，但执行能够继续。它触发 Application_UnhandledException 事件并导致 VS2008 中断执行，但在调试器中继续允许执行继续。这不是一个真正的问题，只是看起来很奇怪。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T17:49:32.070

我在服务方法完成事件处理程序中检查事件参数的错误属性。我没有遇到未调用事件处理程序的问题。在服务器出现故障的情况下，调用需要几秒钟，然后在 Error 属性中返回 ProtocolException。

假设您已经尝试过这个并且您的回调真的从未被调用，您可能会考虑自定义生成的代理类。见[这篇文章](http://blogs.msdn.com/pedram/archive/2007/08/10/customising-wcf-proxy-generation-in-visual-studio-2008.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T16:28:24.433

我找到[了一个讨论这个的论坛帖子](http://silverlight.net/forums/t/20163.aspx)，它提到最佳实践是使用 Error 属性。在这个线程和我自己的经验之间，我可以得出以下结论：

*   在正常的 .NET 代码中，生成的代理类通过将异常放入 Error 属性而不是抛出它来正确处理异常。

*   在 Silverlight 中，生成的代理类会设置 Error 属性，但不会完全处理异常。异常被调试器拾取，它会弹出异常框，并显示消息“ProtocolException 未被用户代码处理”。尽管有此消息，但该异常似乎并未真正出现在 Application_UnhandledException 函数中。

我希望这是他们将在最终版本中修复的问题之一。

现在，我将使用 Error 属性并只处理调试器中断执行。如果它太烦人了，我可以关闭 ProtocolException 的异常中断。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T21:45:23.410

您可以忘记异步客户端回调中的**Application_UnhandledException**，原因是：

Application_UnhandledException 只有在 UI 线程上触发的异常才能被 Application.UnhandledExceptions 捕获

这意味着......根本没有为 WCF 异步调用调用:-)。

**查看 MSFT 的详细回复**

[http://silverlight.net/forums/t/21828.aspx](http://silverlight.net/forums/t/21828.aspx)

*您好，Application.UnhandledExceptions 只能捕获 UI 线程上触发的异常。它无法捕获来自其他线程的异常。您可以尝试这样做来解决问题：在 Visual Studio 中，从“调试”菜单中，选择“异常”。然后检查“公共语言运行时异常”。这将使调试器在抛出异常时停止。但是请注意，这有时可能会很烦人，因为即使已经捕获了异常。您可以使用 CheckBoxes 过滤要捕获的异常。*

就我而言，好消息是，如果您不进行调试，仅在 clietn 服务回调中处理错误消息就足够了。

谢谢

```
Braulio 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T06:56:45.473

哎呀……

对不起，我这边的错误答案（好吧，MSFT 的人没有在同一个 UI 线程上调用写答案服务回调），事情是

更多信息：

```
- In development even detaching from the debugger, this method is never reached. 
- On the production environment yes. 
```

我的猜测与 Visual Studio 选项和拦截异常有关。

更多信息，在这个线程 [http://silverlight.net/forums/p/48613/186745.aspx#186745](http://silverlight.net/forums/p/48613/186745.aspx#186745)

很有趣的话题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-06T18:37:35.337

我不是水管工，所以我决定创建自己的 WCF 服务类，它覆盖 Visual Studio 自动生成的类文件“reference.cs”的一些功能，然后我将自己的 try/catch 块添加到捕获通信错误。

我创建的类看起来像这样：

```
public class myWCFService : MyWCFServiceClient
{

    protected override MyController.MyService.IMyWCFService CreateChannel()
    {
        return new MyWCFServiceClientChannel(this);
    }

}

private class MyWCFServiceClientChannel : ChannelBase<MyController.MyService.IMyWCFService>, MyController.MyService.IMyWCFService
{
    /// <summary>
    /// Channel Constructor
    /// </summary>
    /// <param name="client"></param>
    public MyWCFServiceClientChannel(System.ServiceModel.ClientBase<MyController.MyService.IMyWCFService> client) :
    base(client)
    {
    }
    /// <summary>
    /// Begin Call To RegisterUser
    /// </summary>
    /// <param name="memberInformation"></param>
    /// <param name="callback"></param>
    /// <param name="asyncState"></param>
    /// <returns></returns>
    public System.IAsyncResult BeginRegisterUser(MyDataEntities.MembershipInformation memberInformation, System.AsyncCallback callback, object asyncState)
    {               
        object[] _args = new object[1];
        _args[0] = memberInformation;
        System.IAsyncResult _result = base.BeginInvoke("RegisterUser", _args, callback, asyncState);
        return _result;               
    }
    /// <summary>
    /// Result from RegisterUser
    /// </summary>
    /// <param name="result"></param>
    /// <returns></returns>
    public MyDataEntities.MembershipInformation EndRegisterUser(System.IAsyncResult result)
    {
        try
        {
            object[] _args = new object[0];
            MyDataEntities.MembershipInformation _result = ((MyDataEntities.MembershipInformation)(base.EndInvoke("RegisterUser", _args, result)));
            return _result;
        }
         catch (Exception ex)
        {
            MyDataEntities.MembershipInformation _result = new MyDataEntities.MembershipInformation();
            _result.ValidationInformation.HasErrors = true;
            _result.ValidationInformation.Message = ex.Message;
            return _result;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-26T12:58:53.903

使用 Silverlight 3，Visual Studio 调试器会捕获这些异常，因此永远不会到达异常处理程序——令人困惑的是。但是，在*没有*调试器的情况下运行时，会按预期调用异常处理程序。我想这没问题，只要有人意识到这一点。我承认我浪费了几个小时试图弄清楚如何深入了解 Silverlight/Wcf/Browser 的内部工作以解决我的异常。不要去那里。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-24T12:17:09.073

使用自定义 WCF 代理生成器是在 Silver-light 中处理异步异常的一个很好的解决方案。单击[此处](http://cid-650e401a4417a383.office.live.com/self.aspx/Shared%20Projects/Custome%20WCF%20Proxy%20Generator.zip)下载源代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-03T07:30:47.590

在 WP7 上使用 XNA，我发现我别无选择，只能手动将 try/catch 添加到各种异步 End*FunctionName*() 方法；当服务器不可用时，我尝试过的任何其他方法都无法防止应用程序失败和关闭。当服务更改时，必须手动更新此代码是一个真正的麻烦。

我很惊讶这不是一个更大的问题，因为似乎没有任何其他方法可以使用 XNA 在 WP7 上捕获这些异常，但我想这只是更多地说明了有多少（==不是很多）人正在尝试做这比什么都重要。如果他们只是让 slsvcutil.exe 生成同步方法，我们可以轻松地在我们自己的工作线程中捕获这些方法，但不幸的是，生成的代码使用线程池线程，无法捕获异常。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-24T05:49:49.037

要处理这种情况，请使用 TargetInvocationException。当网络关闭或您的服务不可用时，这将捕获异常。

# algorithm - 从能够容纳一百万行的表中找到未使用的 ID 的最佳算法是什么

> ID：94612
> 
> 赞同：5
> 
> 时间：2008-09-18T17:20:41.797
> 
> 标签：algorithm, logic

详细说明.. a) 表 (BIGTABLE) 可以容纳一百万行，主键为 ID。（随机且唯一） b) 可以使用什么算法来获得迄今为止尚未使用的 ID。这个数字将用于在表 BIGTABLE 中插入另一行。

用更多细节更新了问题.. C）这个表已经有大约 100 K 行并且主键不是作为标识的集合。d) 目前，生成一个随机数作为主键，并在该表中插入一行，如果插入失败，则生成另一个随机数。问题是有时它会进入一个循环并且生成的随机数非常随机，但不幸的是，它们已经存在于表中。因此，如果我们在一段时间后重新尝试随机数生成数，它就会起作用。e) sybase rand() 函数用于生成随机数。

希望这个问题的补充有助于澄清一些观点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T18:05:32.250

问题当然是：为什么要随机 ID？

我遇到类似要求的一个案例是 webapp 的客户端 ID：客户端用他的客户端 ID（存储在 cookie 中）来标识自己，因此必须很难暴力猜测另一个客户端的 ID（因为这将允许劫持他的数据）。

我采用的解决方案是将顺序 int32 与随机 int32 组合以获得我用作客户端 ID 的 int64。在 PostgreSQL 中：

```
CREATE FUNCTION lift(integer, integer) returns bigint AS $$
SELECT ($1::bigint << 31) + $2
$$ LANGUAGE SQL;

CREATE FUNCTION random_pos_int() RETURNS integer AS $$
select floor((lift(1,0) - 1)*random())::integer
$$ LANGUAGE sql;

ALTER TABLE client ALTER COLUMN id SET DEFAULT
lift((nextval('client_id_seq'::regclass))::integer, random_pos_int()); 
```

生成的 ID 是“一半”随机的，而另一“半”保证您不能两次获得相同的 ID：

```
select lift(1, random_pos_int());  => 3108167398
select lift(2, random_pos_int());  => 4673906795
select lift(3, random_pos_int());  => 7414644984
... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T17:24:34.847

为什么唯一 ID 是随机的？为什么不使用 IDENTITY？如何为现有行选择 ID。

最简单的做法可能是（从 BIGTABLE 中选择 Max(ID)），然后确保您的新“随机”ID 大于...

**编辑**：根据添加的信息，我建议您搞砸了。

如果它是一个选项：复制表，然后重新定义它并使用标识列。

如果像另一个答案推测的那样，您确实需要一个真正随机的标识符：使您的 PK 成为两个字段。一个身份字段，然后是一个随机数。

如果您根本无法更改表结构，则在尝试插入之前检查 id 是否存在可能是您唯一的办法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T21:11:27.250

有点在盒子外面。

为什么不提前预先生成随机数？这样，当您将新行插入 bigtable 时，就已经进行了检查。这将使插入 bigtable 成为一个恒定时间操作。

您最终将不得不执行检查，但这可能会被卸载到第二个进程，该进程不涉及插入 bigtable 的敏感过程。

或者去生成几十亿个随机数，删除重复的，那么你就不用担心很长一段时间了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T17:37:39.807

您最好的选择是使您的密钥空间足够大，以使冲突的概率极低，然后不用担心。如前所述，GUID 将为您执行此操作。或者，您可以使用纯随机数，只要它有足够的位数即可。

[这个页面有计算碰撞概率的公式](http://en.wikipedia.org/wiki/Birthday_attack)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T17:25:29.477

没有一个很好的算法来解决这个问题。您可以使用此基本构造来查找未使用的 id：

```
int id;
do {
  id = generateRandomId();
} while (doesIdAlreadyExist(id));
doSomethingWithNewId(id); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T17:23:23.630

选择一个随机数，检查它是否已经存在，如果存在则继续尝试，直到找到不存在的数字。

编辑：或者更好的是，跳过检查并尝试插入具有不同 ID 的行，直到它起作用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T17:24:12.990

将关键字段设为 UNIQUE 和 IDENTITY，您就不必担心了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T17:25:59.960

如果这是您经常需要做的事情，您可能需要维护一个实时（非数据库）数据结构来帮助您快速回答这个问题。一棵10路树会很好。当应用程序启动时，它通过从数据库中读取键来填充树，然后使其与数据库中的各种插入和删除保持同步。只要您的应用程序是唯一更新数据库的应用程序，就可以在验证下一个大随机密钥尚未使用时非常快速地查询树。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T17:34:25.103

第一个问题：这是一个计划中的数据库还是一个已经运行的数据库。如果里面已经有数据，那么 bmdhacks 的答案是正确的。如果是计划数据库，这里是第二个问题：
你的主键真的**需要**随机吗？如果答案是肯定的，那么使用一个函数从一个已知的种子和一个计数器创建一个随机 id，以了解已经创建了多少个 Id。创建的每个 Id 都会增加计数器。
如果您对种子保密（即，调用种子并将其声明为私有），那么其他人将无法预测下一个 ID。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T18:15:40.213

在这种情况下，最好的算法是生成一个随机数并进行选择以查看它是否存在，或者如果您的数据库正常出错，则尝试添加它。根据您的键的范围，与有多少记录，这可能是一小段时间。它还具有飙升的能力并且根本不一致。

是否可以在 BigTable 上运行一些查询并查看是否有任何范围可以被利用？IE。100,000 到 234,000 之间还没有 ID，所以我们可以在那里添加 ID？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T17:22:52.010

如果 ID 是纯随机的，则没有算法可以在没有暴力破解的情况下以类似的随机方式找到未使用的 ID。但是，只要您的随机唯一 ID 的位深度相当大（例如 64 位），您就可以避免只有一百万行的冲突。如果它在插入时发生冲突，请重试。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-12-08T21:26:03.580

为什么不将您的随机数创建者附加到当前日期（以秒为单位）。这样，拥有相同 ID 的唯一方法是，如果两个用户是在同一秒创建的，并且由您的生成器提供相同的随机数。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T17:34:45.880

是否要求新 ID 也是随机的？如果是这样，最好的答案就是循环（随机化，测试是否存在），直到找到一个不存在的。

如果数据*恰好*是随机的，但这不是一个强约束，您可以使用 SELECT MAX(idcolumn)，以适合数据的方式递增，并将其用作下一条记录的主键。

您需要以原子方式执行此操作，因此要么锁定表，要么使用适合您的数据库配置和模式的其他并发控制。存储过程、表锁、行锁、SELECT...FOR UPDATE 等等。

请注意，在任何一种方法中，您都可能需要处理失败的事务。理论上，您可能会在第一次遇到重复的密钥问题（尽管如果您的密钥空间人口稀少，这不太可能），并且您可能会使用 SELECT...FOR UPDATE 等方法在某些数据库上遇到死锁。因此，请务必检查并在错误时重新启动事务。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T17:38:21.800

首先检查是否没有使用 Max(ID) + 1 并使用它。

如果 Max(ID) + 1 超过最大值，则在顶部选择一个有序块并开始向后循环寻找一个洞。重复这些块，直到你用完数字（在这种情况下会抛出一个大错误）。

如果找到“洞”，则将 ID 保存在另一个表中，您可以将其用作下一个案例的起点以保存循环。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T17:42:17.737

跳过任务本身的推理，唯一的算法

*   会给你一个不在表中的 ID
*   将用于在表中插入新行
*   将导致表仍然具有随机唯一 ID

正在生成一个随机数，然后检查它是否已被使用

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T17:23:30.450

根据您的数据库，您可以选择使用序列器（oracle）或自动增量（mysql、ms sql 等）。或者最后的手段做一个 select max(id) + 1 as new id - 小心并发请求，这样你就不会两次得到相同的 max-id - 用即将到来的插入语句将它包装在一个锁中

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-18T17:26:45.637

我之前已经通过蛮力使用随机数生成器多次看到过这种情况，但这总是一个坏主意。在数据库之外生成一个随机数并尝试查看它是否存在会给您的应用程序和数据库带来很大压力。它可能导致 2 个进程选择相同的 id。

您最好的选择是使用 MySQL 的自动增量功能。其他数据库也有类似的功能。保证您拥有唯一的 ID，并且不会遇到并发问题。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-18T17:28:00.670

每次寻找唯一值时扫描该表中的每个值可能是个坏主意。我认为这样做的方法是在另一个表中有一个值，锁定该表，读取该值，计算下一个 id 的值，写入下一个 id 的值，释放锁。然后，您可以自信地使用您读取的 id，您当前的流程是唯一拥有该独特价值的流程。不确定它的扩展性如何。

或者，为您的 id 使用 GUID，因为每个新生成的 GUID 都应该是唯一的。

# asp.net - 使用 ScriptManager 时出现解析器错误

> ID：94632
> 
> 赞同：3
> 
> 时间：2008-09-18T17:22:13.463
> 
> 标签：asp.net, asp.net-ajax, scriptmanager

我有一个 ASP.NET 页面，上面有一个脚本管理器。

```
<form id="form1" runat="server">
    <div>
        <asp:ScriptManager EnablePageMethods="true" ID="scriptManager2" runat="server">
        </asp:ScriptManager>
    </div>
</form> 
```

该页面覆盖一个抽象属性以返回 ScriptManager 以使基本页面能够使用它：

```
public partial class ReportWebForm : ReportPageBase
{
    protected override ScriptManager ScriptManager
    {
        get { return scriptManager2; }
    }

    ...
} 
```

和基本页面：

```
public abstract class ReportPageBase : Page
{
    protected abstract ScriptManager ScriptManager { get; }

    ...
} 
```

当我运行该项目时，我收到以下解析器错误：

**解析器错误消息：**基类包含字段“scriptManager2”，但其类型 (System.Web.UI.ScriptManager) 与控件类型 (System.Web.UI.ScriptManager) 不兼容。

我该如何解决这个问题？

更新：设计器文件的脚本管理器部分是：

```
protected global::System.Web.UI.ScriptManager scriptManager; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T17:30:34.270

我可以很好地编译您的代码示例，您应该检查您的设计器文件以确保一切正常。

编辑：我能想到的唯一另一件事是这是某种参考问题。您的 System.Web.Extensions 引用是否为您的目标框架使用了正确的版本？（对于 .net 3.5 应该是 3.5.0.0，对于 2.0 应该是 1.0.6xxx）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T17:47:46.130

我发现我引用的 System.Web.Extensions (v3.5.sth) 库与 web.config (v.1.0.6sth) 中的引用没有相同的版本。用旧版本的 System.Web.Extensions 替换 dll (3.5) 解决了这个问题。

# outlook - 如何在 MS Outlook 电子邮件中添加下拉菜单和复选框？

> ID：94634
> 
> 赞同：1
> 
> 时间：2008-09-18T17:22:20.513
> 
> 标签：outlook, drop-down-menu, survey

我想在电子邮件中创建一个小型调查。用户将使用自由格式的文本框、复选框或预定义的下拉列表进行响应。我看到声称能够做到这一点的应用程序。我的需求没有那么复杂。只是需要问的几个问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T17:26:32.000

在 Outlook 2007 中，有[创建投票（投票）](http://office.microsoft.com/en-us/outlook/HP100804251033.aspx)的功能，可以满足您的需求：

> 此功能要求您使用 Microsoft Exchange Server 2000、Exchange Server 2003 或 Exchange Server 2007 帐户。

[这里](http://office.microsoft.com/en-us/outlook/HA102555841033.aspx)提供了一个演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T17:31:01.460

您可以简单地将其作为普通 HTML 表单包含在 mime 部分中。请参阅[http://abiglime.com/webmaster/articles/cgi/010698.htm](http://abiglime.com/webmaster/articles/cgi/010698.htm)了解如何执行此操作。

但是，许多电子邮件客户端不会显示此内容。例如，在 Thunderbird 中，有显示消息的设置：“原始 HTML”、“简单 HTML”、“纯文本”。如果设置为“原始 HTML”，它只会显示一个表单。

此外，当您尝试将电子邮件消息中的实际帖子发送到网站时，您可能会收到来自某些电子邮件客户端的安全警告（我不确定，因为我从未尝试过）。

我可以看到使调查在电子邮件中易于使用的吸引力，但您至少应该为看不到表格的用户提供替代链接，以便在网站上访问调查。请务必使用各种电子邮件客户端进行测试，例如：Thunderbird、Outlook、Outlook Express、Gmail、Yahoo、MSN/Hotmail...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T17:25:48.557

你不能使用 HTML 来使它工作吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T17:28:10.000

您可以在 Outlook 中创建包含所需控件的自定义表单。创建新电子邮件时使用该表单。那可行。

# web-services - Stateful Web Services

> ID：94660
> 
> 赞同：2
> 
> 时间：2008-09-18T17:24:56.483
> 
> 标签：web-services, stateful

I'm building a java/spring application, and i may need to incorporate a stateful web service call. Any opinions if i should totally run away from a stateful services call, or it can be done and is enterprise ready?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T17:26:28.227

Statefulness runs counter to the basic architecture of HTTP (ask Roy Fielding), and reduces scalability.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T17:48:05.740

Stateful web services are a pain to maintain. The mechanism I have seen for them is to have the first call return an id (basically a transaction id) that is used in subsequent calls. A problem with that is that the web service isn't really stateful so it has to load all the information that it needs from some other data store for each call.

# eclipse - 在 Eclipse HibernateTools 插件中使用数组参数

> ID：94667
> 
> 赞同：2
> 
> 时间：2008-09-18T17:25:46.870
> 
> 标签：eclipse, hibernate, ide

如何在 HibernateTools 插件的 HQL 编辑器中绑定数组参数？查询参数类型列表不包括数组或集合。

例如：
`Select * from Foo f where f.a in (:listOfValues)`。
如何将数组绑定到该 listOfValues？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T05:41:15.640

你可能不能。Hibernate 用它自己的对象（代理的种类）替换它从数据库中获取的对象。我强烈认为 Hibernate 不能用数组做到这一点。因此，如果您想绑定数组数据，请将其放入 Hibernate 访问的 List 中。

例如，可以这样做：

```
select * from Foo f where f.a in f.list 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-02T04:58:43.220

这就是将列表传递给 HQL 查询的方式。我不熟悉 HQL 编辑器……我们来自 Nhibernate 世界。

```
select * from Foo f where f.a in (:foolist)

query.SetParameterList("foolist", list) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-26T17:01:51.317

我相信您已经得到了答案，但对于其他查看此内容的人来说。似乎休眠工具的 HQL 编辑器不支持查询集合。在 Hibernate Tools HQL 编辑器中进行测试时，您不必使用该参数并对其进行硬编码

```
Select * from Foo f where f.a in (123,1234) 
```

当您将查询放回代码中时，将查询更改回发布的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-03T11:17:55.697

[![休眠视角](https://i.stack.imgur.com/PAS1h.png)](https://i.stack.imgur.com/PAS1h.png)

在休眠透视图中，您可以在左侧看到输入查询参数的左侧面板，当您在字段中输入 :variable 并运行查询时，您将得到结果

# javascript - jQuery 从 JSON 中创建选择列表选项，没有像宣传的那样发生？

> ID：94674
> 
> 赞同：10
> 
> 时间：2008-09-18T17:26:31.893
> 
> 标签：javascript, jquery, drop-down-menu, html-select

为什么这不起作用（在一个空的选择列表上操作`<select id="requestTypes"></select>`

```
$(function() {

        $.getJSON("/RequestX/GetRequestTypes/", showRequestTypes);

    }
    );

    function showRequestTypes(data, textStatus) {

        $.each(data,
            function() {

                var option = new Option(this.RequestTypeName, this.RequestTypeID);
                // Use Jquery to get select list element
                var dropdownList = $("#requestTypes");

                if ($.browser.msie) {
                    dropdownList.add(option);
                }

                else {

                    dropdownList.add(option, null);

                }
            }
            );

        } 
```

但这确实：

*   代替：

    `var dropdownList = $("#requestTypes");`

*   使用普通的旧javascript：

    `var dropdownList = document.getElementById("requestTypes");`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T17:33:12.890

`$("#requestTypes")`返回一个包含所有选定元素的 jQuery 对象。您试图调用`add()`单个元素的方法，但您调用的`add()`是 jQuery 对象的方法，它的作用非常不同。

为了访问 DOM 元素本身，您需要将 jQuery 对象视为一个数组，并使用`$("#requestTypes")[0]`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-18T17:28:07.397

默认情况下，jQuery 选择器返回 jQuery 对象。添加这个以获取返回的 DOM 元素：

```
 var dropdownList = $("#requestTypes")[0]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T21:48:28.657

对于这样的东西，我使用[texotela 的选择框插件](http://www.texotela.co.uk/code/jquery/select/ "jQuery Select box plugin")及其简单的 ajaxAddOption 函数。

# build-automation - 如何使用 TestComplete 自动化测试运行过程？

> ID：94684
> 
> 赞同：5
> 
> 时间：2008-09-18T17:28:01.077
> 
> 标签：build-automation, automated-tests, finalbuilder, dailybuilds, testcomplete

我们正在尝试使用 TestComplete 将测试集成到我们的日常构建中，到目前为止，我们有一台专用于测试的机器，我们的构建脚本将 TestComplete 测试所需的一切（应用程序、数据库、测试脚本项目和源文件等）复制到这台机器上.

基本上我们可以手动打开 TestComplete 项目并运行测试。

现在我们想要自动化这个过程，那么你是怎么做的呢？或者您认为实现这种自动化的最简单和最好的方法是什么？

简而言之，我们希望在每次构建后自动化打开 TestComplete 的过程，运行所有测试并发送包含测试结果的电子邮件。

任何人都可以分享一些这方面的经验吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T15:52:51.910

回答我自己的问题：

解决方案是编写一个位于系统托盘上并监视文件夹的小 C# 应用程序。

当一个新文件夹（包含测试源代码）添加到受监视文件夹时，使用命令行调用 TestComplete，然后应用程序捕获其 ExitCode 并发送一封电子邮件，其中附有生成的日志文件。

根据我知道测试中发生的情况的 ExitCode，可能的 ExitCode 是：

0 - 上次测试未产生错误或警告。
1 - 最后的测试结果包括警告但没有错误。
2 - 最后的测试结果包含错误。
3 - 由于错误而无法运行测试

有关 ExitCode 的更多信息可以在 TestComplete 的帮助文件中找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T17:50:32.317

好吧，虽然我没有使用过 TestComplete，但我使用了一个名为 QA Wizard Pro 的竞争包。既然您在问这个问题，我假设它不是 TestComplete 本身支持的东西。QA Wizard 也是如此，他们希望手动运行而不是自动运行，尽管有可以运行的测试运行文件。对于 QA Wizard，我创建了一个批处理文件，该文件每晚从任务调度程序运行。运行该软件的帐户必须能够与桌面交互，并且用户必须**使用**显示器登录。[我使用了一个名为AutoHotKey](http://www.autohotkey.com/)的免费软件来自动运行测试，然后使用一些[Cygwin工具来解析结果并通过](http://www.cygwin.com/)[Blat](http://www.blat.net/)触发电子邮件结果。这不是一个完美的解决方案，但它确实有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T22:18:02.423

您还应该考虑使用 TestExecute。这是来自自动 QA 的（便宜得多）程序，它将执行 TestComplete 脚本。

这将使您不必为构建/测试服务器拥有完整的 TestComplete 许可证。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T15:25:41.610

如果你有 TestExecute，试试这个。每次都有效....

```
C:\PROGRA~1\AUTOMA~1\TESTEX~1\Bin\TestExecute.exe "path\Project.pjs" /r /e 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T05:40:10.163

```
Set wshShell = CreateObject("WScript.Shell")
wshShell.Run("""C:\Program Files\Automated QA\TestComplete 6\Bin\TestComplete.exe"" ""C:\Documents and Settings\My Documents\TestComplete 6 Projects\abc\abc.pjs(your script path)"" /r /p:(Project Name) /u:(Unit Name) /rt:(Method to be executed) /e /SilentMode") 
```

在记事本中复制以上行并将其保存为 .vbs 文件。
制作一个 .bat 文件并将其放在您的集成服务器上。
通过您的TestComplete exe的bat文件浏览上述.vbs文件的路径。

对于 bat 文件，您可以在记事本中直接将这些行写为

```
C:\WINDOWS\system32\cmd.exe
WScript.Echo ""
Set wshShell = CreateObject("WScript.Shell")
wshShell.Run("""C:\Program Files\Automated QA\TestComplete 6\Bin\TestComplete.exe"" ""C:\Documents and Settings\My Documents\TestComplete 6 Projects\abc\abc.pjs"" /r /p:prj1 /u:Unit1 /rt:Test1 /e") 
```

使用 .bat 扩展名保存此 txt 文件。然后通过你的 CI 服务器生成一个任务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-09T15:04:31.560

对于仍在寻找这个的人：SmartBear 为 Jenkins 发布了一个 TestComplete 插件。因此，它现在可以在不需要破解的情况下使用。

插件信息：[https ://plugins.jenkins.io/TestComplete](https://plugins.jenkins.io/TestComplete)

新闻稿：[https ://smartbear.com/news/news-releases/smartbear-simplifies-continuous-delivery/](https://smartbear.com/news/news-releases/smartbear-simplifies-continuous-delivery/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-12T16:37:09.987

有不同的方法来做这个活动。最好和最强大的方法是使用 Cruise control.NET 进行测试/开发周期的持续集成。

第二种方法是创建一个批处理文件以使用命令行参数运行测试完成脚本。安排此批处理文件的运行。还包括一个简单的应用程序（它将更新 Excel/测试用例中的测试结果）作为 testApp。并在每个测试用例/场景运行后调用它。在完成 TC 运行后创建一个邮件程序函数以发送此结果。

我已经使用这两种方法，

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-18T10:06:51.613

最简单的解决方案是使用批处理文件从命令行执行 testcomplete，并将其添加到 windows 调度程序中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-11T16:00:35.763

你可以试试詹金斯。在最基本的情况下，您可以使用一个构建步骤（批处理或 bash 脚本）创建一个项目，该构建步骤在预定时间从命令行调用 Test Complete 或 Test Execute。然后，您可以根据需要添加其他构建步骤。例如，当我们的测试运行时，我们会从源代码控制中提取最新版本的测试完成脚本。Jenkins 具有很好的功能，例如构建项目的存档（在测试完成的情况下，这将是您的测试日志）、电子邮件通知和源代码控制存储库的监控。大型插件库涵盖了您可能想要添加到项目中的大多数其他内容。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-03-18T09:32:34.267

您可以使用 Bamboo 的 TestComplete 任务来运行带有 TestComplete 或 TestExecute 的 TestComplete 测试，并在 Bamboo 中解析测试并将它们与 JIRA 集成。 [https://marketplace.atlassian.com/plugins/com.mdb.plugins.testcompletetask/server/overview](https://marketplace.atlassian.com/plugins/com.mdb.plugins.testcompletetask/server/overview)

# licensing - LGPL 许可下“分发”的含义有哪些范围？

> ID：94685
> 
> 赞同：3
> 
> 时间：2008-09-18T17:28:02.077
> 
> 标签：licensing, software-distribution, lgpl

这个问题是对我的其他问题之一的跟进，我[可以合法地将 GPL 和 LGPL 开源软件合并到专有的闭源项目中吗？](https://stackoverflow.com/questions/94346/can-i-legally-incorporating-gpl-lgpl-open-sourced-software-in-a-proprietary-clo)

[LGPL 许可](http://www.gnu.org/licenses/lgpl-3.0.txt)的许多条件都基于分发的概念。我的公司以顾问的身份开展业务。我们签约创建软件，然后交付给我们的客户。这是否构成 LGPL 许可下的分发？

我们还向我们的客户提供了该软件，以便通过受密码保护的文件服务器下载。这是否构成分发？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T17:39:14.217

是的，它确实。GPL 最初出现的原因之一是为了防止有人拥有二进制文件但没有源代码的情况。

IANAL，所以我不能说咨询与客户的关系是否会构成一个漏洞，你可以利用它来避免传递源代码，但这肯定违背了许可证的意图，即按照你的建议去做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T17:29:29.140

是的，这两种情况都构成分布。如果它离开了开发人员的手中，它就会被分发。当然，假设您的公司是许可证持有者，而不是您的客户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T17:30:02.057

我认为您所做的是“分发”。无论如何，在这种情况下，律师的支持很重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T17:33:49.237

您的第一个问题实际上取决于您开发软件的合同。您是否交付完整的产品或按小时工作？谁保留软件的版权？

我想说的是，一般来说，如果您作为承包商工作，那么您的客户必须处理这些问题。

是的，在我看来，通过密码保护下载构成分发，您必须以相同的方式分发源代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T17:37:50.680

任何时候您将某些软件的副本提供给其他人时，您就已经分发了该软件。它不一定要向广大公众公开才有资格作为分发。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T20:49:41.570

首先，我不是律师。您可能应该咨询一位。

当您的客户收到您的程序或库时，您正在分发给该客户。这意味着您必须按照 GPL 向您的客户提供源代码。但是，如果分发的范围不超过此范围，则无需将代码分发给广大公众。

但是，如果客户分发代码，他们将成为 GPL 条款下的分发者，然后被要求将代码提供给他们的客户/客户/其他任何人。

请注意，GPL 不要求在客户端接收二进制文件的同时将源代码提供给客户端。但是，您必须向客户提供书面报价，以便根据他们的要求向他们提供源代码，而无需他们额外付费。

# xml - Asp XML 解析

> ID：94689
> 
> 赞同：5
> 
> 时间：2008-09-18T17:28:33.790
> 
> 标签：xml, parsing, asp-classic

我是asp的新手，在接下来的几天里有一个截止日期。我从 web 服务响应中收到以下 xml。

```
print("<?xml version="1.0" encoding="UTF-8"?>
<user_data>
<execution_status>0</execution_status>
<row_count>1</row_count>
<txn_id>stuetd678</txn_id>
<person_info>
    <attribute name="firstname">john</attribute>
    <attribute name="lastname">doe</attribute>
    <attribute name="emailaddress">john.doe@johnmail.com</attribute>
</person_info>
</user_data>"); 
```

如何将此 xml 解析为 asp 属性？

任何帮助是极大的赞赏

谢谢达米安

进一步分析，由于 aboce 响应来自 Web 服务调用，因此还会返回一些肥皂内容。我还可以使用下面的 lukes 代码吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T17:32:21.520

您需要阅读有关 MSXML 解析器的信息。这是一个很好的多合一示例的链接[http://oreilly.com/pub/h/466](http://oreilly.com/pub/h/466)

一些关于 XPath 的阅读也会有所帮助。您可以在 MSDN 中获得所需的所有信息。

[出于聚合目的，从Luke](https://stackoverflow.com/users/17602/luke)的优秀回复中窃取代码：

```
Dim oXML, oNode, sKey, sValue

Set oXML = Server.CreateObject("MSXML2.DomDocument.6.0") 'creating the parser object
oXML.LoadXML(sXML) 'loading the XML from the string

For Each oNode In oXML.SelectNodes("/user_data/person_info/attribute")
  sKey = oNode.GetAttribute("name")
  sValue = oNode.Text
  Select Case sKey
    Case "execution_status"
    ... 'do something with the tag value
    Case else
    ... 'unknown tag
  End Select
Next

Set oXML = Nothing 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T17:36:33.070

通过 ASP，我假设您的意思是 Classic ASP？尝试：

```
Dim oXML, oNode, sKey, sValue

Set oXML = Server.CreateObject("MSXML2.DomDocument.4.0")
oXML.LoadXML(sXML)

For Each oNode In oXML.SelectNodes("/user_data/person_info/attribute")
  sKey = oNode.GetAttribute("name")
  sValue = oNode.Text
  ' Do something with these values here
Next

Set oXML = Nothing 
```

上面的代码假定您将 XML 放在一个名为 sXML 的变量中。如果您通过 ServerXMLHttp 请求使用它，您应该能够使用对象的 ResponseXML 属性代替上面的 oXML 并完全跳过 LoadXML 步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T17:33:56.897

您可以尝试将 xml 加载到 xmldocument 对象中，然后使用它的方法对其进行解析。

# asp.net - 在 ASP.Net 中，视图状态在哪个页面生命周期事件中被加载？

> ID：94696
> 
> 赞同：25
> 
> 时间：2008-09-18T17:29:32.760
> 
> 标签：asp.net, webforms, viewstate, page-lifecycle

我知道它发生在加载之前的某个时间，但究竟是在什么事件期间？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-18T17:29:58.640

它在初始化和加载之间加载到内存中。有关页面生命周期的完整分解，请参阅[他的文章。](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-04-22T21:57:29.840

我曾经也遇到过这个问题，并从我强烈推荐的[真正理解 Viewstate](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx)文章中得到了答案。

阅读后，我设计了一个图形，帮助我更好地理解每个阶段之间发生的事情以及 ViewState 何时以及如何完成其​​工作。

我想与其他人（比如我自己）分享这张图，以更直观地了解事物是如何工作的。希望能帮助到你！:)

单击图像以全角查看。 [![在此处输入图像描述](https://i.stack.imgur.com/z8sQy.png)](https://i.stack.imgur.com/z8sQy.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-18T17:43:12.600

也就是说，viewstate 是在页面的 OnInit() 和 OnLoad() 事件之间加载的。

我最喜欢的关于处理视图状态的文章，它回答了我每次遇到的每一个问题：[http ://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-02-14T10:30:32.953

您可以从[MSDN上解释的页面生命周期中看到](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

![在此处输入图像描述](https://i.stack.imgur.com/LnGPs.png)

即在页面生命周期的Load阶段加载视图状态，即上面*“页面方法”*的[LoadViewState方法](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.loadviewstate(v=vs.110).aspx)和Control方法的方法。*`LoadViewState`*

 ** * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-07-05T10:25:01.143

Viewstate其实是在页面的OnPreLoad事件中加载的，就在Page_InitComplete之后。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2014-02-14T10:09:54.157

视图状态实际上是在 initComplete 和 Preload 事件之间加载的。有关详细信息，请查看此[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

# sql-server-2005 - 从 access+vb6 或仅 sql 2005 生成 pdf 的方法？

> ID：94707
> 
> 赞同：0
> 
> 时间：2008-09-18T17:31:04.783
> 
> 标签：sql-server-2005, ms-access, pdf, adp

设置：多台计算机使用 adp 文件访问 sql 2005 数据库。大多数没有pdf蒸馏器。创建需要保存为 pdf 的访问表单（普通表单，而不是水晶）。

我能想到的唯一方法是从访问 sql 服务器发送一个请求以获取网页。类似于：“ [http://sqlserver/generatepdf.php?id=123](http://sqlserver/generatepdf.php?id=123) ”

我试图避免网页“中间人”。有没有办法在 T-SQL 中生成 pdf？任何人都有其他想法。我不是在寻找代码，只是在寻找方法论的想法。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T18:12:59.207

将表单保存为报告，然后使用 Access MVP Stephen Lebans 免费的 A2000ReportToPDF 实用程序将其转换为 pdf 文件。

[http://www.lebans.com/reporttopdf.htm](http://www.lebans.com/reporttopdf.htm)

如果他们有 Access 2007，他们可以下载并安装免费的 Microsoft Office 2007 插件，以将文档保存为 PDF 或 XPS。

[http://www.microsoft.com/downloads/details.aspx?FamilyId=4D951911-3E7E-4AE6-B059-A2E79ED87041&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=4D951911-3E7E-4AE6-B059-A2E79ED87041&displaylang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T17:35:40.683

Microsoft 的[ReportViewer](http://msdn.microsoft.com/en-us/library/ms251771(VS.80).aspx)客户端可以本地生成 pdf。

它适用于网页和 Windows 窗体/wpf 应用程序。您也可以以编程方式触发导出。唯一的缺点是您基本上需要将表单重做为报告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T18:16:52.630

我必须承认我没有得到它：您想将 Access 表单及其数据导出到 PDF 文件中吗？您的表单基本上是图形，不是文本，也不是报告。您的意思是您希望此表单作为（例如）PDF 文件中的 .png 文件包含，还是希望它是一个完整的 PDF 文件，从原始表单继承对象并允许文本搜索等内容在？

# testing - J2ME 覆盖工具

> ID：94724
> 
> 赞同：3
> 
> 时间：2008-09-18T17:33:51.360
> 
> 标签：testing, java-me, code-coverage, midp, cldc

我需要估计测试集的代码覆盖率。测试在物理设备上的 J2ME 应用程序上运行。MIDP 2.1、CLDC 1.1 和 JSR-75 FileConnection 可用。由于 J2ME（大致）是 J2SE 的一个子集，因此无法使用使用 java.io.File 的工具（如目前唯一答案中列出的那些..）。

这主要是为了识别测试根本不涉及的代码片段。

之后能够任意组合报告数据也很好，所以我可以看到一个新的测试实际上增加了多少覆盖率。

[Cobertura4j2me](http://www.cobertura4j2me.org/)有什么替代品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-11T21:22:15.683

有很多 Java 代码覆盖工具。由于空间限制，它们中的许多使用嵌入式系统中不可用的 JVM 功能来工作。

仅使用一个额外的布尔数组来保存覆盖数据的一个可以在以下位置找到

[http://www.semanticdesigns.com/Products/TestCoverage/JavaTestCoverage.html](http://www.semanticdesigns.com/Products/TestCoverage/JavaTestCoverage.html)

您必须编写一个额外的例程，将该阵列从嵌入式设备转储到 PC 上的文件中，但这通常是一项非常容易的任务（例如，一次工作几个小时）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T01:15:54.137

这里有很多选择。

[http://java-source.net/open-source/code-coverage](http://java-source.net/open-source/code-coverage)

# asp.net - 需要一个免费的 ASPX 日期选择器

> ID：94729
> 
> 赞同：4
> 
> 时间：2008-09-18T17:34:14.680
> 
> 标签：asp.net, date, datepicker

可以放入 ASPX 应用程序的最好的免费 Datepicker 是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T17:40:59.517

[jQuery UI 日期选择器](http://marcgrabanski.com/pages/code/jquery-ui-datepicker)

[ASP.NET AJAX 也有一个不错的](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/Calendar/Calendar.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T17:37:14.923

有一个优秀的免费包可以让 AJAX 启用日历控件以用作日期选择器。

这是视频教程：[http ://www.asp.net/LEARN/ajax-videos/video-124.aspx](http://www.asp.net/LEARN/ajax-videos/video-124.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T17:52:12.860

我使用[基本日期选择器](http://www.basicdatepicker.com/)并发誓。我们使用付费版本，但有一个免费版本可能包含我们使用的所有功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T17:35:02.557

Visual Studio 内置了一个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T17:39:04.310

我长期使用 Excentric 的 World UI 工具：[http ://www.eworldui.net/](http://www.eworldui.net/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T17:44:21.740

它不是 ASP.NET 解决方案，但在[http://www.frequency-decoder.com/2006/10/02/unobtrusive-date-picker-widgit-update](http://www.frequency-decoder.com/2006/10/02/unobtrusive-date-picker-widgit-update)上有一个很棒的 Javascript 日期选择器。您可以通过在输入字段上设置几个 CSS 类来实现它。用过很多次了，觉得很不错！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T00:59:21.010

[Ra-Ajax Calendar 控件](http://ra-ajax.org/samples/Ajax-Calendar.aspx)的一个很好的使用示例是 Ajax Calendar Starter-Kit，可以[在这里](http://ra-ajax.org/samples/Viewport-Calendar-Starter-Kit.aspx)看到，我认为它很好地展示了它的灵活性......

它是 LGPL 的意思是免费的...

# html - 离线 lorem ipsum 生成器

> ID：94747
> 
> 赞同：12
> 
> 时间：2008-09-18T17:35:56.613
> 
> 标签：html, lorem-ipsum

[在线Lipsum 生成器](http://www.lipsum.com/feed/html)的离线替代方案是什么？当我不在线并且需要一些占位符文本进行测试时，这很令人沮丧。CLI 实用程序将是理想的，这样我就可以调整输出以满足我的需要。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-18T17:40:36.210

在 Office 2007 应用程序中，您可以键入

```
=lorem(n) 
```

`n`等于您想要生成的 lorem ipsum 的段落数。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T22:38:19.100

Django 的lipsum 插件看起来很简单。由于我不想安装 python 只是为了运行这个脚本，我将它移植到 php.ini 中。

这是我的 PHP 版本：

[http://pastebin.com/eA3nsJ83](http://pastebin.com/eA3nsJ83)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-18T17:40:49.860

如果你有 python 可用，谷歌代码有一个 CLI 生成器。

[http://code.google.com/p/lorem/](http://code.google.com/p/lorem/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-18T17:38:29.040

在线生成长节。将其保存为 txt 文件。离线时参考txt文件。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T17:41:39.423

Textmate 有一个内置的片段来打印这个

> Lorem ipsum dolor sit amet，consectetur adipisicing elit，sed do eiusmod tempor incididunt ut labore et dolore magna aliqua。Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat。Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur。Exceptioneur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est labourum。

从

> 洛雷姆

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-11-19T10:43:52.830

我认为您可以使用从原始 Lorem Ipsum 文本馈送的[Markov Text Generator](http://www.beetleinabox.com/markov.html)。这样，您应该能够找到您喜欢的任何语言的实现。

[您可以在此处](http://www.beetleinabox.com/mkv_input.html)在线尝试是否可行。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T17:38:16.920

不确定命令行版本，但有一个执行 Lorem Ipsum 的 firefox 扩展：[https ://addons.mozilla.org/en-US/firefox/addon/2064](https://addons.mozilla.org/en-US/firefox/addon/2064)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T17:44:05.843

刚刚检查并发现它从网站上提取文本，所以它不能在线工作......对不起，这个怎么样：

```
#!/usr/bin/env python

import sys
import random

try:
    n = int(sys.argv[1])
except:
    print 'Usage: %s num-words' % sys.argv[0]

words = open('/usr/share/dict/words').readlines()
for i in range(n):
    print words[random.randrange(0, len(words))][:-1], 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T17:39:19.007

Word 2007 将在您输入 =rand() 时生成一个占位符文本块，这会按回车/回车键。如果您正在寻找简单的占位符文本，我会提前生成一堆并将其粘贴在文本文件中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T17:39:21.160

Django 包含`{% lorem %}`标签作为[contrib 插件](http://docs.djangoproject.com/en/dev/ref/contrib/webdesign/#ref-contrib-webdesign)的一部分。制作命令行版本应该不会太难。 [这是来源](http://code.djangoproject.com/browser/django/trunk/django/contrib/webdesign/lorem_ipsum.py)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T17:40:10.220

在[http://www.lipsum.com](http://www.lipsum.com)上有几个离线 Lorem Ipsum 生成器的链接，大约在首页的中间位置。或者你可以在几分钟内写出你自己的一个。

编辑：这不准确，我错误地认为所有链接的 lorem ipsum 生成器都是离线的，而不仅仅是 LaTeX 的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-18T17:46:23.700

如果你在 linux 上并且有这些工具：

```
pdf2ps | ps2txt < yourarticlecollection/someresearchpaper.pdf 
```

:)

Seiously，大部分时间我只是从我感兴趣的研究论文和文章中复制和粘贴。他们有大量的文字显示[白河](http://en.wikipedia.org/wiki/River_(typography))，有时像“Lorem ipsum”一样难以理解。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-05-04T13:06:33.330

为了完整起见：执行此操作的 Perl 模块称为[Text::Lorem](http://search.cpan.org/perldoc?Text%3A%3ALorem)，还有一个[Text::Lorem::More](http://search.cpan.org/perldoc?Text%3A%3ALorem%3A%3AMore)。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-02-06T22:16:19.350

为了使[Juan 的](https://stackoverflow.com/a/10449426/3281612)答案更完整，模块有很好的包装器[`Text::Lorem`](http://search.cpan.org/perldoc?Text%3A%3ALorem)。如果您使用的是 debian：

`$> sudo apt-get install libtext-lorem-perl`

然后输入

`$> lorem`

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-06-25T16:41:29.893

如果您在 macOS 上，可以从自制软件中获得一个不错的生成器。`brew install lorem`. 我的默认 python 发行版是 python 3，它导致 print 语句的语法错误。修复后，这对我的目的来说非常好。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T17:44:18.870

在 lorem ipsum 生成器的底部，您会找到指向生成器的链接以供其他用途。我的理解是以下可以离线使用：

*   [TeX 包](http://ftp.ktug.or.kr/tex-archive/help/Catalogue/entries/lipsum.html)
*   [Java 类](http://www.softabar.com/home/content/view/47/56/)

但您也可能会发现以下内容很有帮助：

*   WWW::Lipsum CPAN 模块
*   火狐插件
*   Dreamweaver 扩展
*   GTK 利普萨姆
*   动作脚本3

这些中的每一个都需要连接，但减少了lipsum生成器的负载，因为它们不需要加载实际的网站。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-19T02:52:03.577

稍微偏离主题：尽量避免使用 lorem ipsum 进行布局测试！

拉丁语中的字母频率与英语或德语中的字母频率不同。有很多“i”和“l”，即很多窄字母。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-12-09T07:55:19.117

另一种方法是使用 VS Code 在 html 标记中生成虚拟文本。您可以控制要生成多少文本。例如，键入`lorem10`然后`Enter`按键，它将生成 10 个单词的 lorem 文本。

[![在此处输入图像描述](https://i.stack.imgur.com/JycGH.png)](https://i.stack.imgur.com/JycGH.png)

您还可以生成一些包含 lorem 文本的段落。例如，`p*3>lorem5`将创建 3 个段落，每个段落包含 5 个单词的 lorem 文本。

[![在此处输入图像描述](https://i.stack.imgur.com/j4bcd.png)](https://i.stack.imgur.com/j4bcd.png)

# c++ - 双索引的最佳容器

> ID：94755
> 
> 赞同：4
> 
> 时间：2008-09-18T17:37:16.390
> 
> 标签：c++, stl, containers

设置允许双索引的容器的最佳方法是什么（在 C++ 中）？具体来说，我有一个对象列表，每个对象都由一个键索引（每个键可能多个）。这意味着一个多图。然而，这样做的问题在于，它意味着查找对象位置的方法可能比线性查找更糟糕。我宁愿避免重复数据，所以让每个对象保持它自己的坐标并且必须在地图中移动自己会很糟糕（更不用说移动你自己的对象可能会在成员函数中间接调用你的析构函数！）。我宁愿一些容器通过对象指针和坐标维护索引，并且对象本身保证稳定的引用/指针。然后每个对象可以存储一个迭代器到索引（包括坐标），充分抽象，并知道它在哪里。Boost.MultiIndex 似乎是最好的主意，但它非常可怕，我不希望我的实际对象需要是 const。

你会推荐什么？

编辑：Boost Bimap 看起来不错，但它提供稳定的索引吗？也就是说，如果我更改坐标，对其他元素的引用必须保持有效。我想使用指针进行索引的原因是因为对象没有内在的顺序，并且指针可以在对象更改时保持不变（允许它在 Boost MultiIndex 中使用，IIRC 确实提供了稳定的索引）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T17:56:39.060

我根据你的文章做了几个假设：

*   复制和比较密钥很便宜
*   系统中应该只有一个对象的副本
*   同一个键可能引用多个对象，但只有一个对象对应一个给定键（一对多）
*   您希望能够有效地查找哪些对象对应于给定键，以及哪个键对应于给定对象

我建议：

*   使用链表或其他容器来维护系统中所有对象的全局列表。对象在链表上分配。
*   创建一个`std::multimap<Key, Object *>`将键映射到对象指针的对象，指向链接列表中的单个规范位置。
*   执行以下操作之一：
    *   创建一个`std::map<Object *, Key>`允许查找附加到特定对象的键。确保您的代码在更改密钥时更新此映射。`std::multimap`（如果您需要多对多关系，这也可能是一个。）
    *   将成员变量添加到`Object`包含当前`Key`（允许 O(1) 查找）的 。确保您的代码在更改密钥时更新此变量。

由于您的文章提到“坐标”作为键，您可能也有兴趣阅读[Fastest way to find if a 3D coordinate is already used](https://stackoverflow.com/questions/72128/fastest-way-to-find-if-a-3d-coordinate-is-already-used#72178)中的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T17:44:00.523

很难理解你到底在用它做什么，但似乎 boost [bimap](http://www.boost.org/doc/libs/1_36_0/libs/bimap/doc/html/index.html)就是你想要的。除了特定的用例之外，它基本上是提升多索引，并且更易于使用。它允许基于第一个元素或第二个元素进行快速查找。为什么要通过地址在地图中查找对象的位置？使用抽象并让它为您完成所有工作。请注意：对地图中所有元素的迭代是 O(N)，因此可以保证 O(N)（不会更糟）以查找您正在考虑的方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T18:21:22.370

一种选择是使用两个引用 shared_ptrs 的 std::maps。这样的事情可能会让你前进：

```
template<typename T, typename K1, typename K2>
class MyBiMap
{
public:
    typedef boost::shared_ptr<T> ptr_type;

    void insert(const ptr_type& value, const K1& key1, const K2& key2)
    {
        _map1.insert(std::make_pair(key1, value));
        _map2.insert(std::make_pair(key2, value));
    }

    ptr_type find1(const K1& key)
    {
        std::map<K1, ptr_type >::const_iterator itr = _map1.find(key);
        if (itr == _map1.end())
            throw std::exception("Unable to find key");
        return itr->second;
    }

    ptr_type find2(const K2& key)
    {
        std::map<K2, ptr_type >::const_iterator itr = _map2.find(key);
        if (itr == _map2.end())
            throw std::exception("Unable to find key");
        return itr->second;
    }

private:
    std::map<K1, ptr_type > _map1;
    std::map<K2, ptr_type > _map2;
}; 
```

编辑：我刚刚注意到多地图要求，这仍然表达了这个想法，所以我会离开它。

# javascript - 在浏览器中检测离线模式的最佳方法是什么？

> ID：94757
> 
> 赞同：4
> 
> 时间：2008-09-18T17:37:22.647
> 
> 标签：javascript, ajax, offline-mode

我有一个 Web 应用程序，其中有许多 Ajax 组件，它们在页面中经常刷新自己（它是一种仪表板）。

现在，我想向页面添加功能，以便在没有 Internet 连接时，页面的当前内容不会更改，并且页面上会出现一条消息，说明页面处于脱机状态（当前，因为这些各种小工具该页面尝试刷新自己并发现没有连接，他们的旧数据消失了）。

那么，解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T17:41:49.390

```
navigator.onLine 
```

那应该做你所要求的。

您可能想在更新页面的任何代码中检查它。例如：

```
if (navigator.onLine) {
    updatePage();
} else {
    displayOfflineWarning();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T17:43:26.453

好像你已经回答了你自己的问题。如果小工具发送异步请求并且超时，请不要更新它们。如果有足够多的人这样做，则显示“页面处于脱机状态”消息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T17:49:57.983

请参阅[HTML 5 规范草案](http://www.w3.org/TR/html5/offline.html#browser0)。你想要`navigator.onLine`。并非所有浏览器都支持它。Firefox 3 和 Opera 9.5 可以。

听起来好像您试图掩盖问题而不是解决问题。如果失败的请求导致您的小部件清除其数据，那么您应该修复您的代码，以便它不会尝试更新您的小部件，除非它收到响应，而不是尝试提前确定请求是否会成功。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T01:57:28.840

处理此问题的一种方法可能是使用显式超时方法扩展 XmlHTTPRequest 对象，然后使用它来确定您是否在脱机模式下工作（即，对于不支持 navigator.onLine 的浏览器）。下面是我在一个站点（一个使用[Prototype](http://prototypejs.org/)库的站点）上实现 Ajax 超时的方法。10 秒（10,000 毫秒）后，它中止调用并调用 onFailure 方法。

```
/**
 * Monitor AJAX requests for timeouts
 * Based on the script here: http://codejanitor.com/wp/2006/03/23/ajax-timeouts-with-prototype/
 *
 * Usage: If an AJAX call takes more than the designated amount of time to return, we call the onFailure
 *        method (if it exists), passing an error code to the function.
 *
 */

var xhr = {
    errorCode: 'timeout',
    callInProgress: function (xmlhttp) {
        switch (xmlhttp.readyState) {
            case 1: case 2: case 3:
                return true;
            // Case 4 and 0
            default:
                return false;
        }
    }
};

// Register global responders that will occur on all AJAX requests
Ajax.Responders.register({
    onCreate: function (request) {
        request.timeoutId = window.setTimeout(function () {
            // If we have hit the timeout and the AJAX request is active, abort it and let the user know
            if (xhr.callInProgress(request.transport)) {
                var parameters = request.options.parameters;
                request.transport.abort();
                // Run the onFailure method if we set one up when creating the AJAX object
                if (request.options.onFailure) {
                    request.options.onFailure(request.transport, xhr.errorCode, parameters);
                }
            }
        },
        // 10 seconds
        10000);
    },
    onComplete: function (request) {
        // Clear the timeout, the request completed ok
        window.clearTimeout(request.timeoutId);
    }
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T17:55:59.980

嗯实际上，现在我研究了一下，它比这更复杂一些。[在John Resig 的博客](http://ejohn.org/blog/offline-events/)和[Mozilla 网站](http://developer.mozilla.org/En/Online_and_offline_events)上阅读这些链接。上面的海报也可能有一个好点 - 无论如何你都在提出请求，所以当他们失败时你应该能够解决......这可能是一个更可靠的方法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T03:32:23.620

呼叫一个可靠的目的地，或者可能是一系列呼叫，如果用户有一个活动的网络连接，这些呼叫应该通过并返回——甚至像令牌 ping 到 google、yahoo 和 msn 或类似的东西那。如果至少有一个返回绿色，则表明您已连接。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T02:02:42.977

我认为谷歌齿轮有这样的功能，也许你可以检查他们是如何做到的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-04-20T20:27:33.767

使用相关的 HTML5 API：[在线/离线状态/事件](http://www.w3.org/TR/offline-webapps/#related)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-15T14:59:35.280

一种可能的解决方案是，如果页面和缓存页面具有不同的 url，则只需查看并查看您所在的 url。如果您在缓存页面的 url 上，那么您处于离线模式。[这个](http://remysharp.com/2011/04/19/broken-offline-support/)博客很好地说明了为什么 navigator.online 坏了

# json - 使用 JSON/Firefox 调试我的 Web 应用程序 - Firefox 处理 JSON？

> ID：94767
> 
> 赞同：20
> 
> 时间：2008-09-18T17:38:12.143
> 
> 标签：json, firefox

我正在尝试使用 FireFox3 调试我的 Web 应用程序。但是，当 JSON 提要来自我的应用程序时，Firefox 想要在新程序中打开“application/json”。有没有办法将 FireFox3 配置为像常规文本文件一样处理 JSON 并在当前选项卡中打开 JSON？

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-02T20:44:11.843

JSONView Firefox 扩展[**非常**](https://addons.mozilla.org/en-US/firefox/addon/10869)好。

它格式化，突出显示等...

唯一的*缺点*是它需要将 mime 类型设置为`"application/json"`. 但这对您来说并不是真正的缺点，因为根据您的“答案” *（不应该是答案）*，您的问题是 mime 类型是`"application/json"`，因此 Firefox 不知道如何处理它并下载它而不是显示。

![JSON视图](https://addons.cdn.mozilla.net/img/uploads/previews/full/29/29967.png?modified=1331247702)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-19T14:56:18.757

尝试[在浏览器扩展中打开](http://www.spasche.net/openinbrowser/)。

[编辑 30.05.2010 - 更新了链接]

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T17:51:48.493

我会查看首选项 > 应用程序列表。"application/*" 的目标应用程序是什么？

除此之外，您使用 FireBug 吗？绝对必要，因为您可以在网络视图中查看标头和响应内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-23T17:30:33.957

考虑使用 MIME 类型的 text/javascript 而不是 application/json

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-25T01:18:23.893

我只会使用[Firebug](http://getfirebug.com) - 它可以让您自己深入了解 JSON 对象，以及其他数百个有用的功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T17:40:07.507

Json 提要的内容类型是什么。听起来它可能是某种应用程序而不是文本。

将提要的内容类型更改为基于文本的内容，FireFox 将不再尝试在另一个程序中打开它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-09T11:19:53.717

使用 application/json mimetype 发送 JSON 是正确的，而改变它是错误的。

text/javascript 被认为是过时的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-17T03:19:21.357

这是一个老问题，但我发现 Rails 的 respond_to 方法（至少从 3.1 开始）可以通过将查询参数 'format' 添加到相关资源中来说服以特定格式呈现。例如：

在控制器中：

```
def show
  @object = Object.find(params[:id])
  respond_to do |format|
    format.html
    format.json { render json: @object }
  end
end 
```

在浏览器中：

```
/object/1             # => renders as html
/object/1?format=json # => renders as json
/object/1.json        # => also renders as json 
```

无需更改 rails 应用程序即可导致此情况发生。就像魔术一样。

# asp.net - 估算 Web 应用程序峰值带宽需求的最准确方法是什么？

> ID：94779
> 
> 赞同：5
> 
> 时间：2008-09-18T17:39:03.843
> 
> 标签：asp.net, load, bandwidth, testing-strategies

我正在处理一个客户提案，他们需要升级他们的网络基础设施以支持托管 ASP.NET 应用程序。本质上，我需要估计具有已知用户数量（当前为 250）的系统的峰值使用情况。像“你需要一条专用的 T1 线路”这样的简单答案可能就足够了，但我希望有数据来支持它。

[另一个问题](https://stackoverflow.com/questions/54184/best-tool-to-monitor-network-connection-bandwidth#54245)引用了 NetLimiter，它看起来很漂亮，可以了解正在使用的内容。

我的一般想法是，我将启动 Web 应用程序并使用系统，就像我预期的那样在客户处使用它，真正以悠闲的速度，在一定的时间跨度内，然后将带宽使用量乘以用户并按时间划分。

这似乎不太科学。对于提案来说可能已经足够了，但我想看看是否有更好的方法。

我知道有可用于测试 Web 应用程序性能的负载工具，但似乎这些工具不能准确地模拟峰值用户负载以进行带宽测试（一次太多）。

该平台是 Windows/ASP.NET，应用程序托管在 SharePoint (MOSS 2007) 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T15:30:32.150

这里还有几个问题需要问。

是 250 个总用户，还是 250 个并发用户？如果并发，那是 250 个峰值，还是通常是 250 个？如果总共有 250 个用户，他们是否都希望同时使用它（例如，一个 Intranet 站点，人们必须在其中使用它作为他们工作的一部分），或者它更像是一个社区站点，他们可能会或可能不会用它？我假设您的措辞方式是总共有 250 名用户，但这仍然不足以说明该网站以进行估计。

如果它是一个社区或“普通”互联网站点，它还取决于使用情况——例如，人们是否真的会大量使用它，还是某些用户只需登录一次，然后就忘记了？从您的角度来看，这可能是一个棘手的问题，因为您会想假设前者，但是如果您在网络基础设施上花费大量资金并且最终没有人使用它，那么这可能是一件非常糟糕的事情。

网站在做什么？在频谱的低端，有一个“典型”的 Web 应用程序，您可以在其中拥有合理大小（例如 1-2k）的页面和少量图像。更激烈的是一个拥有大量媒体的网站——例如，flickr 风格的图像浏览。上端是一个有大量下载的网站——流媒体电影，或者只是下载大文件或数据集。

这有点超出您的问题的门槛，但要关注的另一件事是该网站的未来：明年或一个月的使用量可能会翻倍吗？在没有某种方式升级的情况下，请小心锁定与 T1 或光纤连接之类的长期合同。

另一个问题是可靠性——您需要连接冗余吗？前期成本可能很高，但有多种方法可以进行多宿主连接，您可以在其中平衡几个链接之间的访问，然后在发生故障时只使用一个（尽管容量减少）。

另一个要考虑的选项，它可以有效地让您完全避免整个问题，就是将应用程序托管在数据中心中。您支付相对较低的月费（与专用高质量连接的成本相比较低），并且您可以获得所需的带宽（例如，大多数托管计划会给您每月 500GB 的传输量，首先- 有些只会给你无限的）。数据中心也将比您可以构建的任何东西（缺少您自己的 6+ 数字数据中心）更可靠，因为它们具有冗余互联网、电源备份、冗余冷却、防火、物理安全......并且他们有管理所有的人这是给你的，所以你永远不必处理它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T16:05:09.633

代替一个好的带宽使用报告工具，您总是可以做一个粗略的猜测。

N = 最繁忙时间的页面浏览次数 P = 平均页面大小

(N * P) /3600) = 每秒平均流量。

服务器本身可能会为数据库服务器/NAS/等提供更多的内部流量。但是面向外应该会给你一个非常粗略的使用概念。显然，您将需要远远超过上述值，因为您永远不想被 100% 使用，并允许其他流量。

我也不建议使用像 250 个用户这样的任意数字。使用最繁重的生产日/小时作为参考。如果您愿意，可以加倍和三倍，但是如果您有良好的日志文件/用户审核，这将为您提供预期的用户行为分布。这将有助于使您的猜测更加准确。

As another commenter pointed out, a data center is a good idea, when redundancy and bandwidth availability become are a concern. Your needs may vary, but do not dismiss the suggestion lightly.

# vim - 使用 Vim 进行 Lisp 开发

> ID：94792
> 
> 赞同：91
> 
> 时间：2008-09-18T17:40:09.783
> 
> 标签：vim, ide, lisp, common-lisp

我一直在使用 Lisp 一段时间，但我开始更加认真地在 Lisp 中做一些“真正的”工作。我是 Vim 的忠实粉丝，我想知道如何使用 Vim 作为我的 Lisp 开发编辑器来提高工作效率。插件、工作流程建议等都是受欢迎的。

请不要说“使用 emacs”，因为我已经开始使用 Vim 并且作为编辑器我真的很喜欢它。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-09-19T11:28:59.527

Limp 旨在成为用于 Vim 的功能齐全的 Common Lisp IDE。它默认为 SBCL，但可以通过在文件 /usr/local/limp/latest/bin/lisp.sh 中为您最喜欢的 lisp 替换“sbcl”来更改以支持大多数其他实现

如今在讨论 Lisp 时，通常假定它是 Common Lisp，这是一种由 ANSI X3J13 标准化的语言（参见[HyperSpec](http://l1sp.org/cl)和[Practical Common Lisp](http://gigamonkeys.com/book)以获得良好的教科书），具有 GNU Clisp、SBCL、CMUCL、AllegroCL 等实现其他。

回到跛行。还有其他更轻量级的解决方案，或者尝试做其他事情，但我相信提供一个环境，为您提供括号匹配、突出显示、文档查找等功能，即尽可能使其成为交钥匙解决方案.

在[Limp 存储库](https://svn.jansson.be/limp)中，您会发现 SlimVim 项目的一些以前的工作，即 ECL（Embeddable Common Lisp）接口，与后来的版本（7.1）合并；Simon 还提供了尚未合并的 7.2 补丁。ECL 接口记录在[if_ecl.txt](https://svn.jansson.be/limp/vim-ecl/vim/runtime/doc/if_ecl.txt)中。

短期的工作是与 7.2 进行合并，然后向 vim_dev 提交补丁以将其合并到官方的 Vim 树中。

这让我们有了长远的计划：直接在 Vim 中使用 Lisp 可以方便地开始在 SWANK 前端工作（在 Lisp 中运行的 SLIME 部分，其中 slime.el 是在编辑器 - 前端）。

介于两者之间的某个地方，很可能所有 Limp 都将使用 ECL 接口在 Common Lisp 中重写，从而使 Limp 更易于维护（VimScript 不是我最喜欢的）并且更易于用户自定义。

官方的[Limp 网站](https://common-lisp.net/project/limp/)不时出现故障，但正如所指出的，[在 Vim.org 上的下载](http://www.vim.org/scripts/script.php?script_id=2219)应该始终有效，并且支持组[limp-devel](http://groups.google.com/group/limp-devel)和[limp-user](http://groups.google.com/group/limp-user)托管在 Google Groups 中。如果您觉得需要回答问题，或者甚至想参与开发，请不要犹豫加入。大多数讨论都在跛行发展清单上进行。如果你喜欢 IRC，我在 irc.freenode.net 上的 #limp 是“tic”。

祝你好运！

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2010-01-12T12:00:31.633

你可以让[slimv](http://www.vim.org/scripts/script.php?script_id=2531)休息一下。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-18T18:40:13.743

[这是Xach](http://xach.com)的一张很酷的图表，总结了当前的情况。

![图表解释了几乎没有 VIM 用户同时也是 Lisp 程序员并且也可以破解它以使其成为一个好的 Lisp IDE...糟糕的替代文本 :)](https://i.stack.imgur.com/3FK7O.png)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-18T17:43:14.287

查看 Limp 插件：

[http://www.vim.org/scripts/script.php?script_id=2219](http://www.vim.org/scripts/script.php?script_id=2219)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-18T18:09:47.233

SLIME for EMACS 是一个很棒的 LISP 编程工具。最好的部分是将编辑器中编写的代码直接发送到实时 LISP 会话。您可以使用此处的提示从 Vim 中获得类似的行为：

[http://technotales.wordpress.com/2007/10/03/like-slime-for-vim/](http://technotales.wordpress.com/2007/10/03/like-slime-for-vim/)

我调整了自己的脚本，以便可以发送到[SBCL](http://www.sbcl.org)或[Clojure](http://www.clojure.org)会话。它使您的工作效率更高，并利用了 REPL。

":set lisp" 启动 Vim 的 lisp 缩进模式。但它不适用于像 Clojure 这样的方言。对于 Clojure，请使用[VimClojure](http://kotka.de/projects/clojure/vimclojure.html)。

有些人也喜欢[LIMP](http://www.vim.org/scripts/script.php?script_id=2219)。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-07-17T02:51:16.233

9 年后，现在我们有了 Vim 8 和 Neovim，它们都提供了与插件进行异步交互的能力。

[vlime](https://github.com/l04m33/vlime)是一个优秀的、功能丰富的插件，它利用新的异步接口为 Common Lisp 提供类似 SLIME 的开发环境。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-17T10:31:48.300

*   Vim 附加组件：彩虹括号、Lisp 语法
*   SBCL 附加组件：rlwrap、sb-aclrepl
*   工作流程：具有多个终端窗口的 Ion3（或其他一些平铺的 WM）。

    *   在 Vim 中编辑 Lisp
    *   切换到 Lisp 窗口（当然使用键盘）
    *   使用 Cr 调用该行以重新加载有问题的 ASDF 系统，以便您的更改生效。
    *   对小片段/更改使用 X Window 复制/粘贴。
    *   大量使用 DESCRIBE、TRACE 和 APROPOS。
    *   重复。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-18T18:00:44.167

：设置口齿不清

Vim 有一个模式可以帮助你按照 Lisp 标准缩进你的代码。

此外，我修改了 lispwords 以更改 vim 缩进我的代码的方式。

:setl lw-=if (在 ~/.vim/ftplugin/lisp.vim 中)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-18T17:45:43.843

你可以试试 Emacs with Vim emulation，不是很完美，但可能有点熟悉。我认为如果你使用像 Slime 或 DrScheme 之类的东西进行迭代开发，Lisp 会大放异彩，所有其他编辑器都会觉得不对劲。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-19T10:23:48.390

似乎有人尝试在 Vim 中实现类似 SLIME 的 Lisp 集成，但没有一个真正达到真正有用的程度。我认为 ECL 的集成已经完成，但尚未提交上游。

[您应该从Cliki 的有关 Vim 的页面中](http://www.cliki.net/vim)找到所有相关链接。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T18:05:11.783

我知道你说过不要告诉你使用 Emacs。

使用 Emacs。

说真的，Emacs的[SLIME](http://common-lisp.net/project/slime/)设置几乎是 Lisp*的*标准开发平台，而且有很好的理由。

# c++ - 函数调用的成本是多少？

> ID：94794
> 
> 赞同：36
> 
> 时间：2008-09-18T17:40:12.203
> 
> 标签：c++, optimization, architecture, memory

相比

*   简单的内存访问
*   磁盘访问
*   另一台计算机上的内存访问（在同一网络上）
*   另一台计算机上的磁盘访问（在同一网络上）

在 Windows 上的 C++ 中。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-18T18:07:01.420

相对时间（不应该超过 100 倍 ;-)

*   缓存中的内存访问 = 1
*   缓存中的函数调用/返回 = 2
*   缓存外的内存访问 = 10 .. 300
*   磁盘访问 = 1000 .. 1e8（摊销取决于传输的字节数）
    *   主要取决于寻道时间
    *   传输本身可以非常快
    *   涉及至少几千个操作，因为用户/系统阈值必须至少超过两次；一个 I/O 请求必须被调度，结果必须被写回；可能分配了缓冲区...
*   网络调用 = 1000 .. 1e9（摊销取决于传输的字节数）
    *   与磁盘 i/o 相同的参数
    *   原始传输速度可能相当高，但另一台计算机上的某些进程必须完成实际工作

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-18T17:43:55.877

函数调用只是将内存中的帧指针转移到堆栈上，并在其上添加一个新帧。函数参数被移入本地寄存器以供使用，堆栈指针前进到堆栈的新顶部以执行函数。

与时间相比

函数调用~简单的内存访问
函数调用<磁盘访问
函数调用<另一台计算机上的内存访问函数调用<另一台计算机
上的磁盘访问

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T17:42:44.397

与简单的内存访问相比 - 稍微多一点，真的可以忽略不计。

与列出的其他所有内容相比 - 数量级少。

这应该适用于任何操作系统上的几乎任何语言。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T17:44:32.893

一般来说，函数调用会比内存访问稍慢，因为它实际上必须进行多次内存访问才能执行调用。例如，在 x86 上使用 __stdcall 的大多数函数调用都需要多次推送和弹出堆栈。但是，如果您的内存访问甚至不在 L2 缓存中的页面，如果目标和堆栈都在 CPU 的内存缓存中，则函数调用会快得多。

对于其他一切，函数调用要快很多（很多）数量级。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T17:47:19.690

很难回答，因为涉及的因素很多。

首先，“简单内存访问”并不简单。由于在现代时钟速度下，CPU 可以将两个数字相加，而不是从芯片的一侧到另一侧获得一个数字（光速——这不仅仅是一个好主意，它是定律）

那么，函数是在 CPU 内存缓存中调用的吗？您是否也在比较它的内存访问？

然后我们有函数调用将清除 CPU 指令流水线，这将以非确定性的方式影响速度。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T17:53:44.777

假设您的意思是调用本身的开销，而不是被调用者可能会做的事情，那么它肯定比“简单”内存访问要快得多。

它可能比内存访问慢，但请注意，由于编译器可以进行内联，因此函数调用开销有时为零。即使不是，至少在某些架构上，对指令缓存中已经存在的代码的某些调用可能比访问主（未缓存）内存更快。这取决于在进行调用之前需要将多少寄存器溢出到堆栈，等等。请查阅您的编译器和调用约定文档，尽管您不太可能比反汇编发出的代码更快地弄清楚它。

另请注意，有时不是“简单”的内存访问 - 如果操作系统必须从磁盘导入页面，那么您将等待很长时间。如果您跳转到当前在磁盘上分页的代码，情况也是如此。

如果根本的问题是“我什么时候应该优化我的代码以最小化函数调用的总数？”，那么答案是“非常接近永远”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-04T20:36:54.267

这个链接在谷歌中出现了很多。为了将来参考，我在 C# 中运行了一个关于函数调用成本的简短程序，答案是：“大约是内联成本的六倍”。以下是详细信息，请参阅底部的//输出。更新：为了更好地比较苹果和苹果，我将 Class1.Method 更改为 return 'void'，如下所示： public void Method1 () { // return 0; 尽管如此，内联速度还是快了 2 倍：内联（平均）
：610 毫秒；函数调用（平均）：1380 毫秒。因此，更新后的答案是“大约两倍”。

使用系统；使用 System.Collections.Generic；使用 System.Linq；使用 System.Text；使用 System.Diagnostics；

命名空间 FunctionCallCost { 类程序 { 静态无效 Main(string[] args) { Debug.WriteLine("stop1"); int iMax = 100000000; //100M 日期时间 funcCall1 = DateTime.Now; 秒表 sw = Stopwatch.StartNew();

```
 for (int i = 0; i < iMax; i++)
        {
            //gives about 5.94 seconds to do a billion loops, 
          // or 0.594 for 100M, about 6 times faster than
            //the method call.
        }

        sw.Stop(); 

        long iE = sw.ElapsedMilliseconds;

        Debug.WriteLine("elapsed time of main function (ms) is: " + iE.ToString());

        Debug.WriteLine("stop2");

        Class1 myClass1 = new Class1();
        Stopwatch sw2 = Stopwatch.StartNew();
        int dummyI;
        for (int ie = 0; ie < iMax; ie++)
        {
          dummyI =  myClass1.Method1();
        }
        sw2.Stop(); 

        long iE2 = sw2.ElapsedMilliseconds;

        Debug.WriteLine("elapsed time of helper class function (ms) is: " + iE2.ToString());

        Debug.WriteLine("Hi3");

    }
} 
```

// 这里使用 System 1 类；使用 System.Collections.Generic；使用 System.Linq；使用 System.Text；

命名空间 FunctionCallCost { 类 Class1 {

```
 public Class1()
    {
    }

    public int Method1 ()
    {
        return 0;
    }
} 
```

}

// 输出：stop1 main 函数的运行时间（ms）是：595 stop2 helper 类函数的运行时间（ms）是：3780

stop1 main 函数的运行时间（ms）是：592 stop2 helper 类函数的运行时间（ms）是：4042

stop1 main 函数的运行时间（ms）是：626 stop2 helper 类函数的运行时间（ms）是：3755

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T17:48:55.723

实际调用函数但没有完全执行它的成本？还是实际执行该功能的成本？简单地设置一个函数调用并不是一项昂贵的操作（更新 PC？）。但显然，一个函数完全执行的成本取决于该函数在做什么。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-19T11:28:43.023

我们不要忘记 C++ 有虚拟调用（明显更贵，大约 x10），在 WIndows 上，您可以期望 VS 内联调用（定义为 0 成本，因为二进制文件中没有剩余调用）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T17:42:35.940

取决于该函数的作用，如果它对内存中的对象执行逻辑，它将在您的列表中排名第二。如果它包括磁盘/网络访问，则在列表的下方。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T17:46:22.873

一个函数调用通常只涉及几个内存副本（通常是到寄存器中，因此它们不应该占用太多时间），然后是一个跳转操作。这将比内存访问慢，但比上面提到的任何其他操作都快，因为它们需要与其他硬件进行通信。在任何操作系统/语言组合上通常都应如此。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T17:46:42.437

如果函数在编译时内联，则函数的成本等于 0。

0 当然是，如果没有函数调用，你会得到什么，即：自己内联它。

当我这样写时，这当然听起来太明显了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T18:10:54.873

函数调用的成本取决于架构。x86 相当慢（几个时钟加上每个函数参数一个时钟左右），而 64 位则要慢得多，因为大多数函数参数是在寄存器中传递的，而不是在堆栈中传递的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T19:07:19.530

函数调用实际上是将参数复制到堆栈上（多次内存访问），寄存器保存，实际代码执行，最后是结果复制和寄存器恢复（寄存器保存/恢复取决于系统）。

所以..相对来说：

*   函数调用 > 简单内存访问。
*   函数调用 << 磁盘访问 - 与内存相比，它可能要贵数百倍。
*   函数调用 << 另一台计算机上的内存访问 - 网络带宽和协议是这里的重要时间杀手。
*   函数调用<<<另一台计算机上的磁盘访问-以上所有以及更多:)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T19:10:23.843

只有内存访问比函数调用快。

但是，如果编译器具有内联优化（对于 GCC 编译器，并且不仅在使用优化级别 3 (-O3) 时激活），则可以避免调用。

# c# - 使用c#使用windows身份验证登录站点

> ID：94809
> 
> 赞同：0
> 
> 时间：2008-09-18T17:41:58.250
> 
> 标签：c#, windows-authentication

我想使用当前登录用户的 Windows 身份验证登录到我的程序内的服务器。我想也许我可以使用

System.Security.Principal.WindowsIdentity.GetCurrent().Name

但是虽然这确实给出了一个名称，但我不知道如何找到用户的密码来输入它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T23:51:51.387

绝对没有办法获取 Windows 用户的密码，因为 Windows 甚至不存储它（它存储的只是一个不可逆的哈希）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T17:43:26.250

您无法获取密码。您需要使用模拟将身份传递给您尝试连接的服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T17:43:49.760

除非用户将密码提供给您的应用程序，否则您将无法使用他们的密码进行基本登录。您必须根据本地登录的用户进行某种模拟或委派权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T17:44:01.693

在 web.config 中：

```
 <system.web>
        <authentication mode="Windows" />
        <identity impersonate="true"/>
  </system> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T17:52:15.963

如果您打算使用 Windows 用户身份验证，您可能应该使用它的某些部分，它比简单的用户名/密码组合更安全。（并且可能无法访问密码，因为这意味着每个 .NET 应用程序都可以访问您的完整帐户信息。）

例如，[WindowsIdentity.User](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.user.aspx)被声明为对于所有 Windows NT 实现中的用户都是唯一的。（我相信这意味着在任何 Windows NT 实现中，这对于给定系统上的每个用户都是唯一的......但我不确定。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-12T22:22:39.630

如果客户端和服务器都在同一个域中，则不必指定用户名和密码。

如果您使用的是 HttpRequest，则应设置[LogonUserIdentity](http://msdn.microsoft.com/en-us/library/system.web.httprequest.logonuseridentity.aspx)。

如果您正在调用 SOAP 服务，您应该设置[Credentials](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.webclientprotocol.credentials.aspx)属性。

# dns - DNS-将子文件夹的DNS路由到不同的服务器？

> ID：94820
> 
> 赞同：10
> 
> 时间：2008-09-18T17:42:54.957
> 
> 标签：dns, reverse-proxy, subdirectory

假设我想要一个名为- [http://www.foo.com/news/](http://www.foo.com/news/)的子​​文件夹，但我实际上希望该新闻文件夹位于不同的服务器上。我意识到它可以通过子域轻松完成，但我真的希望子文件夹的事情。

可能吗？如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T17:50:46.793

**唯一**真正的方法是在您和外部世界之间使用反向代理（*或充当反向代理的网络服务器*），知道每个文件夹所在的 IP 地址。

不可能只做某事，例如 google.com 出现在[http://foobar.com/google/](http://foobar.com/google/)因为浏览器不会路由到 IP 地址（缺少信息）。

您可以使用整页 IFrame 或其他框架集系统来*伪造该效果，但这相当狡猾。*

如果您使用的是 apache，则可以使用 mod_proxy 进行设置。更多详情可在这找到：

*   [Mod_Proxy(1.3) 手册](http://httpd.apache.org/docs/1.3/mod/mod_proxy.html)
*   [Mod_Proxy(2.0) 手册](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html)
*   [Apache Tutor.org 指南](http://www.apachetutor.org/admin/reverseproxies)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T18:24:19.133

对于 Apache，需要 httpd.conf 中的以下条目：

LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so

ProxyPass /news [http://newsserver.domain.com/news](http://newsserver.domain.com/news)
ProxyPassreverse / [http://newsserver.domain.com/](http://newsserver.domain.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T17:50:20.167

它不能用 DNS 完成，因为域名只是地址的 *.example.com。

这可以通过在您的 www 机器上配置代理来将所有对 /news 的请求传递到另一台服务器来完成。使用 apache 很容易做到，但我现在不记得所有的细节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T17:44:28.527

是的，IIS 中有一个设置可让您将子文件夹指向不同的站点。因此，使子文件夹成为您站点上的虚拟目录，然后在虚拟目录的属性中选择“重定向到 URL”的选项...在其中指定您的其他站点。

当然，这是假设您使用的是 IIS。在您使用的任何 Web 服务器中都应该有类似的东西可供使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T17:49:48.107

DNS 解析发生在域级别。DNS 不了解 URL 或文件夹，因此您的名称将始终指向同一服务器。您可以使该服务器实际从另一台服务器检索信息或重定向到另一台服务器，但这并不是很令人满意。

# asp.net-mvc - 将 JQuery 与 ASP.NET MVC 框架一起使用

> ID：94860
> 
> 赞同：1
> 
> 时间：2008-09-18T17:45:40.160
> 
> 标签：asp.net-mvc

我已经搜索了论坛，并在谷歌上搜索了这个主题。大多数文章都在讨论使用 JSON 调用服务器上的控制器/动作并对结果进行 ajax 效果。

我正在尝试使用一些非常基本的 JQuery 功能，例如 JQuery UI/Tabs 和用于对话框窗口的 JQuery UI/Block。我无法让这些简单的示例在我的 MVC 项目中工作。任何想法我应该如何修改这些样本？我现在只需要这些基本功能，我可以从这里开始。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T18:36:54.000

实际上我刚刚开始工作。问题是我需要将路径修改为视图页面的绝对路径，因为相对路径不适用于 MVC 路由 {controller}/{action}/{id}。

谢谢！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T08:17:24.773

有关信息，请参阅相对路径问题 - 我在[这里](https://stackoverflow.com/questions/347528/using-scripts-in-a-master-page-with-asp-net-mvc)讨论了这个（相同的概念适用于任何页面，而不仅仅是母版页）。我使用的方法是这样的：

1：声明添加脚本的扩展方法：

```
 public static string Script(this HtmlHelper html, string path)
    {
        var filePath = VirtualPathUtility.ToAbsolute(path);
        return "<script type=\"text/javascript\" src=\"" + filePath + "\"></script>";
    } 
```

2：需要时（例如在中`<head>...</head>`）使用此方法：

```
 <%=Html.Script("~/Scripts/jquery-1.2.6.js")%> 
```

这样做的好处是，即使 Web 应用程序托管在虚拟目录中，它也可以工作（即，您不能使用“/Scripts”，因为您不一定位于站点根目录） - 但它更清晰（并且不那么凌乱）比带有 munged src 的完整脚本，即

```
 <script ... src="<%=Url.Foo(...)%>"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T17:48:14.633

我刚刚在我的一个 asp.net 项目中实现了 jquery 自动完成文本框。我只需要导入 js 文件并将一些代码放入我的 aspx 页面。您能否更详细地了解您要运行的样本？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T18:02:04.303

这是快速响应！

我正在尝试在此页面上运行此“简单选项卡”：http: [//stilbuero.de/jquery/tabs/](http://stilbuero.de/jquery/tabs/)

我认为这与此相同：[http ://docs.jquery.com/UI/Tabs](http://docs.jquery.com/UI/Tabs)

我只是将整个内容复制并粘贴到我的 MVC 视图页面中，并修正了 jquery.js 和 .css 文件的路径，但选项卡中的内容全部显示在一起（其中两个应该被隐藏）。我的理解是这个简单的 jquery 插件只是显示和隐藏内容。

我对 jquery 厚盒插件有完全相同的问题，标记为“隐藏”的项目（对话框）将始终显示在我的 MVC 视图页面中。

我可以理解一些MVC+Jquery+json的文章，但是我不明白为什么隐藏/显示不起作用。

谢谢！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T07:41:53.890

我刚刚做了一个关于如何做到这一点的演练：

[http://blogs.msdn.com/joecar/archive/2009/01/08/autocomplete-with-asp-net-mvc-and-jquery.aspx](http://blogs.msdn.com/joecar/archive/2009/01/08/autocomplete-with-asp-net-mvc-and-jquery.aspx)

# visual-studio - Visual Studio 的任务列表替换

> ID：94864
> 
> 赞同：7
> 
> 时间：2008-09-18T17:46:05.730
> 
> 标签：visual-studio, task, add-on

我想在 Visual Studio 中使用任务列表，但它确实缺少任务列表应该提供的几乎任何有用的功能。所以我在外部使用[Todo-List](http://www.abstractspoon.com/)来跟踪我需要完成的事情。将这一切都集中在一个地方会很好。

那么有人知道 Visual Studio 中任务列表的一个很酷的替代插件吗？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-29T21:46:34.783

假设：Visual Studio 2008 + ReSharper

ReSharper->Windows->ToDo 资源管理器

电子-

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T11:22:08.447

对于半即时编程任务，我使用代码中的 TODO 注释和 ReSharper for Visual Studio 来查看它们。

对于长期任务，我使用 Team Foundation Server 来记录工作项。

对于非编程任务，我使用 Google 日历。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-14T05:20:08.737

您可以通过单击工具 --> 选项 --> 环境 --> 任务列表来修改 Visual Studio 中的任务列表

在令牌列表中，您可以添加更多特定于您想要调用任务的令牌。

例如..我设置了一个 EDITING 令牌，因此在我正在处理的任何模块、类或方法中，我只需添加 ' EDITING: (Name of any method ect..) 注释，我可以很快看到我离开的地方关闭并通过双击返回它。

![在此处输入图像描述](https://i.stack.imgur.com/E3t3d.png)

以下是我认为有用的其他一些标记... ![在此处输入图像描述](https://i.stack.imgur.com/XGuHu.png)

如果您想要更高级的项目和代码跟踪，您应该查看 Visual Studio Online。它对最多 5 位用户免费。 [http://www.visualstudio.com/en-us/products/visual-studio-online-overview-vs](http://www.visualstudio.com/en-us/products/visual-studio-online-overview-vs)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T17:54:08.783

我不知道附加组件（我在外部使用[“记住牛奶”](http://www.rememberthemilk.com/)），但我认为你在那里是个好主意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-02T23:34:13.193

Visual Studio 2005 和 2008的[**FogBugz 插件**](http://our.fogbugz.com/default.asp?W984)怎么样？

这需要本地或 Fog Creek 托管的[FogBugz帐户。](http://www.fogcreek.com/FogBugz/)提供免费的学生版和启动[版](https://shop.fogcreek.com/FogBugz/default.asp?sCategory=HOSTEDFB&sStep=stepEnterEmailAddress&HFBnForm=1)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T21:54:26.717

我们在工作中使用 Team Foundation Server - 它是一款非常棒的产品，但对于小型团队来说太贵了。

失业我希望使用 CountersSoft Gemini ( [http://countersoft.com/home.aspx](http://countersoft.com/home.aspx) )，它具有良好的 VS 集成，并且在查看具有无限用户的托管版本时具有竞争力。

# sql-server-2005 - 如何将 .mdf 附加到 sql2005？

> ID：94866
> 
> 赞同：0
> 
> 时间：2008-09-18T17:46:18.443
> 
> 标签：sql-server-2005

运行 sp_attach_single_file_db 会出现此错误：

```
The log scan number (10913:125:2) passed to log scan in database 'myDB' is not valid 
```

不应该重新创建日志文件吗？

我还能如何附加/修复该 .mdf 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T17:49:33.583

这取决于您的数据库在分离时处于何种模式，该日志文件中可能存在附加数据库所需的未提交/未写入事务，否则会丢失数据。你知道它分离时你处于什么恢复模式吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T18:59:39.110

它起作用了，当我安装另一个（带有 .ldf 日志文件）然后是有问题的那个，然后再次分离第一个。不要问我为什么。

# python - 图像处理，在 Python 中？

> ID：94875
> 
> 赞同：81
> 
> 时间：2008-09-18T17:47:04.883
> 
> 标签：python, image, image-processing, image-manipulation

我最近遇到了一个至少需要基本图像处理程度的问题，我可以在 Python 中做到这一点，如果可以，用什么？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-09-18T17:54:46.410

最著名的图书馆是[PIL](http://effbot.org/zone/pil-index.htm)。但是，如果您只是简单地进行基本操作，则最好使用[ImageMagick](http://wiki.python.org/moin/ImageMagick)的 Python 绑定，这将比在 Python 中编写转换更有效。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2011-04-22T21:11:58.293

根据“图像处理”的含义，更好的选择可能是基于 numpy 的库：[mahotas](http://luispedro.org/software/mahotas)、[scikits.image](http://scikit-image.org)或[scipy.ndimage](http://www.scipy.org/SciPyPackages/Ndimage)。所有这些工作都基于 numpy 数组，因此您可以混合和匹配来自一个库和另一个库的函数。

我启动了网站[http://pythonvision.org](http://pythonvision.org)，其中包含有关这些的更多信息。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-05-05T09:19:55.670

您还有一种基于“标准”科学模块的图像处理方法：**SciPy**有一个专用于图像处理的完整包：[scipy.ndimage](http://docs.scipy.org/doc/scipy/reference/tutorial/ndimage.html)。Scipy 实际上是标准的通用数值计算包；它基于事实上的标准数组操作模块[NumPy](http://numpy.org/)：图像也可以作为数字数组进行操作。至于图像显示，[Matplotlib](http://matplotlib.sourceforge.net/gallery.html)（也是“科学三部曲”的一部分）使图像显示[变得非常简单](http://matplotlib.sourceforge.net/examples/pylab_examples/image_demo3.html)。

SciPy 仍在积极维护中，因此它是对未来的良好投资。此外，SciPy 目前也可以与 Python 3 一起运行，而 Python Imaging Library (PIL) 则不能。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-09-28T05:43:26.597

完成列表：opencv [http://opencv.willowgarage.com/documentation/python/index.html](http://opencv.willowgarage.com/documentation/python/index.html)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-11-29T08:53:51.187

还有[pycairo](http://www.cairographics.org/pycairo/)，这可能更适合您的需要。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-18T17:47:13.823

实际上有一个很棒的[Python Imaging Library (PIL)](http://effbot.org/zone/pil-index.htm)。它使您能够更改现有图像，包括抗锯齿功能，并使用文本等创建新图像。您还可以在上述网站上提供的 PIL 手册中找到[不错的入门教程。](http://effbot.org/imagingbook/introduction.htm)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-19T05:39:11.380

如果您正在创建自定义图像处理效果，您可能会发现 PythonPixels 很有用。 [http://halfhourhacks.blogspot.com/2008/03/pythonpixels.html](http://halfhourhacks.blogspot.com/2008/03/pythonpixels.html) 它用于编写和试验图像处理。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-10-10T10:56:03.753

VIPS 应该很快并且使用多个 CPU：

[https://github.com/libvips/libvips/wiki/Speed-and-memory-use](https://github.com/libvips/libvips/wiki/Speed-and-memory-use)

# c# - Java 和 .NET 3.5 之间进程间通信的最佳方法是什么？

> ID：94882
> 
> 赞同：3
> 
> 时间：2008-09-18T17:48:03.993
> 
> 标签：c#, java, .net, ipc

第三方应用程序从 XML 文件中读取一些 Java 代码，并在某个事件发生时运行它。在 Java 中，我想告诉在同一台机器上运行的 .NET 3.5 应用程序发生了这个事件。每次传输的总数据可能是几个字符。

使用 Java 告诉 .NET 进程发生了什么事的最佳方式是什么？

Java 似乎不支持 Windows 上的命名管道，.NET 本身不支持内存映射，任何涉及 Web 服务或 RMI 的解决方案都是过大的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T17:49:59.730

如果您不想要 RMI 的全部开销，您可以通过打开端口并相互交谈来在两者之间进行直接套接字通信。您必须有某种方法让两个进程就使用哪些端口、如何握手/等达成一致，但比 RMI 更简单。

ETA：看起来您可以*使用*java 中的命名管道，但您不能*创建*它们？因此，如果 .NET 进程会创建它，您可以使用 java 读取/写入它。Java 只是将其视为一个文件？

# c# - 泛型与数组列表

> ID：94884
> 
> 赞同：15
> 
> 时间：2008-09-18T17:48:11.747
> 
> 标签：c#, performance, generics

我在这里工作的系统是在 .net 2.0 之前编写的，没有泛型的好处。它最终更新到 2.0，但由于时间限制，没有任何代码被重构。在许多地方，代码使用 ArraysLists 等将事物存储为对象。

从性能的角度来看，更改代码对使用泛型有多重要？我知道从性能的角度来看，装箱和拆箱等，它是低效的，但是改变它真的会有多少性能提升呢？泛型是在前进的基础上使用的东西，还是有足够的性能变化需要良心努力来更新旧代码？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-18T17:56:42.803

正如您所说，从技术上讲，泛型的性能更好。但是，除非性能非常重要并且您已经在其他领域进行了优化，否则您可能会通过将时间花在其他方面来获得更好的改进。

我会建议：

*   继续使用泛型。
*   如果你有可靠的单元测试，那么在你接触代码时重构为泛型
*   花其他时间进行重构/测量，这将显着提高性能（数据库调用、更改数据结构等），而不是到处花几毫秒。

当然，除了性能之外，还有其他原因要更改为泛型：

*   不易出错，因为您对类型进行了编译时检查
*   更具可读性，您不需要到处进行强制转换，并且很明显集合中存储了什么类型
*   如果您正在使用泛型，那么在任何地方都使用它们会更干净

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T19:02:20.867

这是我从 100KB 文件中简单解析字符串 100,000 次得到的结果。Generic List(Of char) 花了 612.293 秒来遍历文件 100,000 次。ArrayList 花了 2,880.415 秒来遍历文件 100,000 次。这意味着在这种情况下（因为您的里程*会*有所不同）Generic List(Of char) 快 4.7 倍。

这是我运行了 100,000 次的代码：

```
Public Sub Run(ByVal strToProcess As String) Implements IPerfStub.Run
    Dim genList As New ArrayList

    For Each ch As Char In strToProcess.ToCharArray
        genList.Add(ch)
    Next

    Dim dummy As New System.Text.StringBuilder()
    For i As Integer = 0 To genList.Count - 1
        dummy.Append(genList(i))
    Next

End Sub

 Public Sub Run(ByVal strToProcess As String) Implements IPerfStub.Run
     Dim genList As New List(Of Char)

     For Each ch As Char In strToProcess.ToCharArray
         genList.Add(ch)
     Next

     Dim dummy As New System.Text.StringBuilder()
     For i As Integer = 0 To genList.Count - 1
         dummy.Append(genList(i))
     Next
 End Sub 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T17:51:07.043

唯一确定的方法是使用 dotTrace 之类的工具来分析您的代码。

[http://www.jetbrains.com/profiler/](http://www.jetbrains.com/profiler/)

在您的特定应用程序中，装箱/拆箱可能是微不足道的，不值得重构。展望未来，由于编译时类型安全，您仍应考虑使用泛型。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T17:54:36.083

泛型，无论是 Java 还是 .NET，都应该用于设计和类型安全，而不是用于性能。自动装箱不同于泛型（本质上是隐式对象到基元的转换），正如您所提到的，如果有很多算术或其他操作会导致重复的性能下降，则不应使用它们代替基元隐式对象创建/销毁。

总体而言，我建议继续使用，并且仅在出于类型安全/设计目的而不是性能需要对其进行清理时才更新现有代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T17:53:54.713

这取决于，最好的答案是分析您的代码并查看。我喜欢 AQTime，但为此存在许多软件包。

通常，如果 ArrayList 被大量使用，则可能值得将其切换到通用版本。但实际上，您很可能甚至无法衡量性能差异。装箱和拆箱是额外的步骤，但现代计算机速度如此之快，几乎没有区别。由于 ArrayList 实际上只是一个带有漂亮包装器的普通数组，因此您可能会看到从更好的数据结构选择（ArrayList.Remove 是 O(n)！）中获得比转换为泛型时更多的性能。

编辑：Outlaw Programmer 有一个很好的观点，你仍然会用泛型装箱和拆箱，它只是隐含地发生。不过，所有关于从强制转换和“is/as”关键字检查异常和空值的代码都会有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T17:52:44.997

最大的收获是在维护阶段。泛型更容易处理和更新，而无需处理转换和转换问题。如果这是您不断访问的代码，那么一定要努力。如果这是多年未触及的代码，我真的不会打扰。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T17:54:02.043

自动装箱/拆箱与泛型有什么关系？这只是一个类型安全问题。对于非泛型集合，您需要显式转换回对象的实际类型。使用泛型，您可以跳过此步骤。我不认为以一种或另一种方式存在性能差异。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T17:54:34.977

我的老公司其实也考虑过这个问题。我们采取的方法是：如果重构容易，就去做；如果没有（即它会涉及太多类），请稍后再处理。这实际上取决于您是否有时间去做，或者是否有更重要的项目需要编码（即您应该为客户实现的功能）。

再说一次，如果你不是在为客户做某事，那就继续花时间重构吧。它将为您自己提高代码的可读性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T17:57:57.557

取决于您的代码中有多少。如果您在 UI 中绑定或显示大型列表，您可能会看到性能上的巨大提升。

如果您的 ArrayList 只是到处散布，那么清理它可能没什么大不了的，但也不会对整体性能产生太大影响。

如果您在整个代码中使用了很多 ArrayLists 并且替换它们将是一个很大的麻烦（这可能会影响您的日程安排），那么您可以采用 if-you-touch-it-change-it 方法。

不过，主要的事情是，泛型更容易阅读，并且由于您从它们那里获得的强类型，在整个应用程序中更稳定。您不仅会看到性能的提升，还会看到代码的可维护性和稳定性。如果你能很快做，我会说做。

如果你能从产品负责人那里得到支持，我建议你把它清理干净。之后你会更喜欢你的代码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T17:59:34.027

如果 ArrayLists 中的实体是 Object 类型，您会从不将它们转换为正确的类型中获得一点好处。如果它们是值类型（结构体或 Int32 之类的原语），那么装箱/拆箱过程会增加很多开销，并且泛型集合应该快得多。

[这是有关该主题的 MSDN 文章](http://msdn.microsoft.com/en-us/library/b5bx6xee(VS.80).aspx)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-20T07:30:07.463

泛型具有更好的性能，特别是如果您将使用值类型（int、bool、struct 等），您将获得显着的性能提升。

1.  将 Arraylist 与值类型一起使用会导致装箱/拆箱，如果完成数百次，则比使用泛型列表要慢得多。

2.  将值类型存储为对象时，每个项目最多可存储四次内存。虽然这个数量不会耗尽您的 RAM，但较小的缓存内存可能包含较少的项目，这意味着在迭代长集合时，从主内存到缓存会有很多副本，这会减慢您的应用程序。

[我在这里](http://blogs.microsoft.co.il/blogs/dhelper/archive/2008/10/10/why-does-list-lt-t-gt-is-better-then-arraylist.aspx)写过。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-22T04:37:19.947

使用泛型还意味着如果您想在以后的 c# 版本中利用 linq 之类的东西，您的代码将更简单易用。

# sql-server - 寻找 SQL 2005 Partitioning 的好总结

> ID：94885
> 
> 赞同：3
> 
> 时间：2008-09-18T17:48:12.620
> 
> 标签：sql-server, partitioning

我[将其](http://www.sqlservercentral.com/articles/SQL+Server+2005/61765/)视为 SQL 2005 Enterprise 分区的基本解释。是否有资源可以更深入地探讨这个问题的细节和考虑因素。更多的例子也会很有用。

我的主要方案是基于时间的分区系统。使用最近 X 天访问次数最多的一个分区。这个分区必须以某种方式滑动（至少定期）以保持它的裁判时间相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T03:15:13.187

这是 Kimberly Tripp 撰写的关于“SQL Server 2005 分区表和索引”的出色白皮书。 [http://www.sqlskills.com/resources/Whitepapers/Partitioning%20in%20SQL%20Server%202005%20Beta%20II.htm](http://www.sqlskills.com/resources/Whitepapers/Partitioning%20in%20SQL%20Server%202005%20Beta%20II.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T19:46:59.683

那这个呢：

## [为查询性能对数据进行分区 - 好处在哪里？](http://blogs.mssqltips.com/blogs/chadboyd/archive/2008/03/19/partitioning-data-for-query-performance-where-s-the-benefit.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T11:56:22.727

我不确定这是否会对您有所帮助（您正在使用多少数据），但下面的这份白皮书讲述了如何使用临时表和 switch 子句来更改分区。

[http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/loading_bulk_data_partitioned_table.mspx](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/loading_bulk_data_partitioned_table.mspx)

它更多的是关于将数据批量加载到分区中，但它可能值得一读。最近在澳大利亚悉尼举行的 SQL 峰会上解释的示例场景使用基于日期的分区方案作为示例，这可能与您的场景类似。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T21:28:13.983

我发现[SQL Server 2005 联机丛书](http://technet.microsoft.com/en-us/library/ms130214(SQL.90).aspx)通常包含我要查找的所有信息。

我在 SQL Server 2005 分区的 05 BOL 中找到了一个很好的资源： [http ://technet.microsoft.com/en-us/library/ms188706(SQL.90).aspx](http://technet.microsoft.com/en-us/library/ms188706(SQL.90).aspx)

此链接介绍了分区表和索引的设计： [http ://technet.microsoft.com/en-us/library/ms175533(SQL.90).aspx](http://technet.microsoft.com/en-us/library/ms175533(SQL.90).aspx)

这是一篇解释您发布的滑动窗口案例的博客文章：http: [//blogs.msdn.com/menzos/archive/2008/06/30/table-partitioning-sliding-window-case.aspx](http://blogs.msdn.com/menzos/archive/2008/06/30/table-partitioning-sliding-window-case.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T04:43:54.320

本网站可以帮助您：

[http://highscalability.com/](http://highscalability.com/)

具体标签：

[http://highscalability.com/tags/shard](http://highscalability.com/tags/shard)

[http://highscalability.com/tags/sharding](http://highscalability.com/tags/sharding)

# sql - 如何在 SQL Server 2005 中将随机数作为列返回？

> ID：94906
> 
> 赞同：21
> 
> 时间：2008-09-18T17:50:38.370
> 
> 标签：sql, sql-server, sql-server-2005, random

我在 SQL Server 2005 上运行 SQL 查询，除了从数据库中查询 2 列之外，我还想返回 1 列随机数以及它们。我试过这个：

```
select column1, column2, floor(rand() * 10000) as column3 
from table1 
```

哪种方法可行，但问题是此查询在每一行都返回相同的随机数。每次运行查询时它都是一个不同的数字，但它不会因行而异。我怎样才能做到这一点并为每一行获取一个新的随机数？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-29T12:55:45.243

我意识到这是一篇较旧的帖子......但你不需要视图。

```
select column1, column2, 
  ABS(CAST(CAST(NEWID() AS VARBINARY) AS int)) % 10000 as column3 
from table1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T22:13:15.663

**警告**

[亚当涉及视图的答案](https://stackoverflow.com/questions/94906/how-do-i-return-random-numbers-as-a-column-in-sql-server-2005/94951#94951)非常低效，并且对于非常大的集合可能会占用您的数据库很长一段时间，我强烈建议您不要定期使用它或在您需要在生产中填充大型表的情况下使用它。

相反，您可以使用[这个答案](https://stackoverflow.com/questions/94906/how-do-i-return-random-numbers-as-a-column-in-sql-server-2005/491502#491502)。

证明：

```
CREATE VIEW vRandNumber
AS
SELECT RAND() as RandNumber

go 

CREATE FUNCTION RandNumber()
RETURNS float
AS
  BEGIN
  RETURN (SELECT RandNumber FROM vRandNumber)
  END

go 

create table bigtable(i int)

go 

insert into bigtable 
select top 100000 1 from sysobjects  a
join sysobjects b on 1=1

go 

select cast(dbo.RandNumber() * 10000 as integer) as r into #t from bigtable 
-- CPU (1607) READS (204639) DURATION (1551)

go

select ABS(CAST(CAST(NEWID() AS VARBINARY) AS int)) % 10000 as r  into #t1 
from bigtable
-- Runs 15 times faster - CPU (78) READS (809) DURATION (99) 
```

探查器跟踪：

[替代文字 http://img519.imageshack.us/img519/8425/destroydbxu9.png](http://img519.imageshack.us/img519/8425/destroydbxu9.png)

这证明东西对于 0 到 9999 之间的数字来说是足够随机的

```
-- proof that stuff is random enough 
select avg(r) from #t
-- 5004
select STDEV(r) from #t
-- 2895.1999 

select avg(r) from #t1
-- 4992
select STDEV(r) from #t1
-- 2881.44 

select r,count(r) from #t
group by r 
-- 10000 rows returned 

select r,count(r) from #t1
group by r 
-- 10000 row returned 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T18:23:47.120

亚当的回答非常有效，所以我将其标记为已接受。不过，当我在等待答案时，我还发现这个博客条目还有其他一些（随机性稍低）的方法。Kaboing的方法就是其中之一。

[http://blog.sqlauthority.com/2007/04/29/sql-server-random-number-generator-script-sql-query/](http://blog.sqlauthority.com/2007/04/29/sql-server-random-number-generator-script-sql-query/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-12-07T03:00:56.787

```
select RAND(CHECKSUM(NEWID())) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T17:54:38.627

您需要使用 UDF

第一的：

```
CREATE VIEW vRandNumber
AS
SELECT RAND() as RandNumber 
```

第二：

```
CREATE FUNCTION RandNumber()
RETURNS float
AS
  BEGIN
  RETURN (SELECT RandNumber FROM vRandNumber)
  END 
```

测试：

```
SELECT dbo.RandNumber(), *
FROM <table> 
```

以上借自[Jeff 的 SQL Server 博客](http://weblogs.sqlteam.com/jeffs/archive/2004/11/22/2927.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T17:58:10.943

对于 SQLServer，有几个选项。
1\. 一次使用一个随机数更新空列的 while 循环
2\. 包含返回随机数的函数的 .net 程序集

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T17:58:20.177

**询问**

```
select column1, column2, cast(new_id() as varchar(10)) as column3 
from table1 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T18:42:05.330

您可能想考虑使用 newid 函数生成 UUID 而不是随机数。这些保证每次生成时都是唯一的，而直接随机数很可能会发生一些重复（并且取决于您使用它的目的，可能会在以后给您带来非常难以调试的错误）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T19:44:18.533

newid() 我认为是非常耗费资源的。我记得在有几百万条记录的表上尝试过这种方法，但性能不如 rand()。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-08-03T14:45:09.320

根据我的测试，上面的答案永远不会产生 10000 的值。当您生成 1 到 10000 之间的随机数时，这可能不是什么大问题，但是 1 到 5 之间的相同算法会很明显。将 1 添加到您的 mod。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-11-13T20:03:58.877

这个片段似乎提供了一个合理的替代`rand()`，因为它返回一个介于 0.0 和 1.0 之间的浮点数。它仅使用由提供的最后 3 个字节，因此总随机性可能与从推荐答案转换为然后进行修改`newid()`略有不同。没有机会测试相对性能，但对于我的目的来说似乎足够快（并且足够随机）。`VARBINARY``INT`

```
SELECT CAST(SubString(CONVERT(binary(16), newid()), 14, 3) AS INT) / 16777216.0 AS R 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-04-25T21:41:13.683

我使用 c# 来处理随机数。干净多了。我有一个函数用于返回随机数列表和唯一键，然后我只需在行号上加入唯一键。因为我使用 c#，所以我可以轻松地指定随机数必须落在的范围。

以下是制作函数的步骤： [http ://www.sqlwithcindy.com/2013/04/elegant-random-number-list-in-sql-server.html](http://www.sqlwithcindy.com/2013/04/elegant-random-number-list-in-sql-server.html)

这是我的查询最终的样子：

```
SELECT 
   rowNumber, 
   name, 
   randomNumber
FROM dbo.tvfRandomNumberList(1,10,100) 
INNER JOIN (select ROW_NUMBER() over (order by int_id) as 'rowNumber', name from client        
            )as clients
ON clients.rowNumber = uniqueKey 
```

# .net - 如何从 url 而不是 .NET 中的文件路径加载 xml？

> ID：94912
> 
> 赞同：2
> 
> 时间：2008-09-18T17:51:13.080
> 
> 标签：.net, xml

我们目前有这样的代码：

```
Dim xDoc = XDocument.Load(myXMLFilePath) 
```

我们目前知道如何做到这一点的唯一方法是使用文件路径和模拟（因为此文件位于安全的网络路径上）。

我查看[了 MSDN 上的 XDocument.Load](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.load.aspx)，但什么也没看到。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T17:52:07.150

我建议使用 WebRequest 获取流并将流加载到文档中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T17:58:13.750

该文档说文件参数是“引用文件以加载到新 XDocument 中的 URI 字符串”。此外，我的代码正是这样做的——`XDocument.Load`与 URI 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-07T19:36:13.130

```
//Sample XML
<Product>
    <Name>Product1</Name>
    <Price>0.00</Price>
</Product>

    //Reading XML
    XmlTextReader rdr = new XmlTextReader("http://your-url");
    XDocument loaded = XDocument.Load(rdr);

    //View the loaded contents
    //Response.ClearHeaders();
    //Response.ContentType = "text/xml;charset=UTF-8";
    //Response.Write(loaded);
    //Response.End();

    var data = from c in loaded.Descendants("Product")
            select new
            {
                name = c.Element("Name").Value,
            price = c.Element("Price").Value,
        };

    foreach (var element in data)
    {
        //Do something here
    } 
```

# sql - 从列表中获取每个帐户 ID 的一行

> ID：94930
> 
> 赞同：6
> 
> 时间：2008-09-18T17:52:37.697
> 
> 标签：sql, mysql, database

我有一个包含游戏分数的表格，每个帐户 id 允许多行：`scores (id, score, accountid)`。我想要一份前 10 名得分手 id 及其得分的列表。

能否提供一个sql语句来选择前10个分数，但每个账户id只有一个分数？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T17:57:24.767

```
select username, max(score) from usertable group by username order by max(score) desc limit 10; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T17:55:05.177

试试这个：

```
select top 10 username, 
              max(score) 
from usertable 
group by username 
order by max(score) desc 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T18:00:26.007

首先将选择限制为每个帐户 ID 的最高分。然后取前十名。

```
SELECT TOP 10 AccountId, Score
FROM Scores s1
WHERE AccountId NOT IN 
    (SELECT AccountId s2 FROM Scores 
     WHERE s1.AccountId = s2.AccountId and s1.Score > s2.Score)
ORDER BY Score DESC 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T17:56:52.333

PostgreSQL 有 DISTINCT ON 子句，它是这样工作的：

```
SELECT DISTINCT ON (accountid) id, score, accountid
FROM scoretable
ORDER BY score DESC
LIMIT 10; 
```

我不认为它是标准的 SQL，所以希望其他数据库以不同的方式做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-20T22:46:10.663

```
SELECT accountid, MAX(score) as top_score
FROM Scores
GROUP BY accountid,
ORDER BY top_score DESC
LIMIT 0, 10
```

这在mysql中应该可以正常工作。您可能需要使用 'ORDER BY MAX(score) DESC' 而不是那个 order by - 我手头没有我的 SQL 参考。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-23T04:04:09.813

我相信 PostgreSQL（至少 8.3）将要求`DISTINCT ON`表达式必须匹配初始`ORDER BY`表达式。`DISTINCT ON (accountid)`拥有 .IE 时无法使用 IE `ORDER BY score DESC`。要解决此问题，请将其添加到`ORDER BY`：

```
SELECT DISTINCT ON (accountid) *
FROM scoretable
ORDER BY accountid, score DESC
LIMIT 10; 
```

使用此方法可以选择表中的所有列。即使分数有重复的“最大值”值，它也只会为每个 accountid 返回 1 行。

这对我很有用，因为我没有找到最高分数（使用 max() 函数很容易做到），但最近一次为帐户输入了分数。

# coldfusion - ColdFusion 邮件队列停止处理

> ID：94932
> 
> 赞同：13
> 
> 时间：2008-09-18T17:52:44.480
> 
> 标签：coldfusion, administration

我们的 CF 服务器偶尔会停止处理邮件。这是有问题的，因为我们的许多客户都依赖它。

我们在网上找到了一些建议，其中提到了无法交付的文件夹中的零字节文件，因此我创建了一个任务，每三分钟删除一次。然而，停工再次发生。

我正在寻找诊断和解决此问题的建议。

*   CF 8 标准
*   Win2k3

添加：

*   队列失败时邮件日志中没有错误
*   由于我们发送的邮件量很大，我们没有尝试在不使用队列的情况下运行它

添加2：

*   假脱机文件夹中的任何文件似乎都没有问题。当我们重新启动邮件队列时，它们似乎都可以正确处理。

新增 3：

*   我们没有使用附件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T15:11:24.750

我们最终做了什么：

我写了两个计划任务。第一个检查队列文件夹中是否有任何消息早于*n*分钟（当前设置为 30）。第二个在低使用率期间每晚重置队列。

不幸的是，我们从来没有真正发现为什么队列会脱轨，但它似乎只发生在我们使用 Exchange 时——我们尝试过的其他邮件服务器没有这个问题。

**编辑：** 我被要求发布我的代码，所以这是找到旧邮件时重新启动的代码：

```
<cfdirectory action="list" directory="c:\coldfusion8\mail\spool\" name="spool" sort="datelastmodified">
<cfset restart = 0>
<cfif datediff('n', spool.datelastmodified, now()) gt 30>
    <cfset restart = 1>
</cfif>
<cfif restart>
    <cfset sFactory = CreateObject("java","coldfusion.server.ServiceFactory")>
    <cfset MailSpoolService = sFactory.mailSpoolService>
    <cfset MailSpoolService.stop()>
    <cfset MailSpoolService.start()>
</cfif> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-26T16:48:16.843

> 由于我们发送的邮件量很大，我们没有尝试在不使用队列的情况下运行它

无论如何，您是否*尝试过*关闭假脱机？我已经看到邮件在半秒内以 500-600 条消息的速度发送，而且那是在一个蹩脚的服务器上。使用 60 秒的标准页面超时，您可以在页面超时之前发送约 72,000 封电子邮件。您一次发送超过 72,000 个吗？

我在 CFMail 之前使用的一个替代方法是构建一个自定义的假脱机程序。与其即时发送电子邮件，不如将它们保存到数据库表中。然后设置一个预定的作业来发送几百条消息，并在几分钟后重新安排自己，直到表为空。

我们安排工作每天运行一次；如果表不为空，它可以重新安排自己在几分钟内再次运行。从来没有遇到过问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T18:29:47.700

您是否尝试过完全绕过队列？（在 CF Admin 中，在 Mail Spool 设置下，取消选中“Spool mail messages for delivery”。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-20T20:12:55.960

我有时会遇到同样的问题，这不是由于零字节文件造成的，尽管过去确实出现了这个问题。似乎一两个文件（文件夹中最旧的文件）将使队列无法处理。我所做的是将所有邮件移动到一个保留文件夹，重新启动邮件队列并按时间倒序一次将邮件复制回一个块，等待它们出去并移动更多。等待队列的消息被放在一个单独的文件夹中以供稍后检查。

您可以通过[停止队列](https://stackoverflow.com/questions/94948/restarting-coldfusion-mail-queue)以编程方式执行此操作，将最旧的文件移动到另一个文件夹，然后[启动邮件队列](https://stackoverflow.com/questions/94948/restarting-coldfusion-mail-queue)并通过检查文件夹文件计数和日期来查看发送是否成功开始。如果删除最旧的文件不起作用，请重复前面的过程，直到所有有问题的邮件文件都被移动并继续成功发送。

我希望有所帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-10T21:37:30.920

我们实际上有一个相同的设置，Win2K3 上的 32 位 CF8。

大约一年前，我们采用了 Ben 的解决方案，该解决方案有助于自动重新排队卡住的电子邮件。

然而，最近我们的 7 个 Web 服务器中的一个无特殊原因决定在每次尝试发送电子邮件时都进入这种状态。

> 设置邮件服务器参数时出现异常。此异常的原因是：coldfusion.mail.MailSessionException：设置邮件服务器参数时发生异常..

我们的每个网络服务器都是彼此相同的克隆，所以为什么它只发生在那个服务器上是很奇怪的。

另一个需要注意的是，由于 JRUN 的内存管理问题，我们有一个脚本会在半夜重新启动机器。重新启动的行为似乎引发了问题。随后重新启动 CF 服务将清除它，并且机器会很好，直到它再次重新启动。

我们发现问题与 McAfee 病毒扫描程序有关，更新它以排除 c:\ColdFusion8 目录后，问题就消失了。

希望有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-26T17:38:05.457

Ben Doom 的代码中有一个错误。无论如何谢谢本，代码很棒，我们现在在我们的一台安装了 CF8 的服务器上使用它，但是：如果目录 (\spool) 为空，则代码失败（错误：传递给日期函数 DateDiff 的日期值未指定或无效。）这是因为如果查询对象 spool 为空（spool.recordcount EQ 0），datediff 函数会产生错误。

我们现在用这个：

```
<!--- check if request for this page is local to prevent "webusers" to request this page over and over, only localhost (server) can get it e.g. by cf scheduled tasks--->
<cfsetting requesttimeout="30000">
<cfset who = CGI.SERVER_NAME>
<cfif find("localhost",who) LT 1>
    security restriction, access denied.
    <cfabort>
</cfif> 

<!--- get spool directory info --->
<cfdirectory action="list" directory="C:\JRun4\servers\cfusion\cfusion-ear\cfusion-war\WEB-INF\cfusion\Mail\Spool\" name="spool" sort="datelastmodified">
<cfset restart = 0>
<cfif spool.recordcount GT 0><!--- content there? --->
    <cfif datediff('n', spool.datelastmodified, now()) gt 120>
        <cfset restart = 1>
    </cfif>
</cfif>
<cfif restart><!--- restart --->
    <cfsavecontent variable="liste">
        <cfdump var="#list#">
    </cfsavecontent>    
    <!--- info --->
    <cfmail to="x@y.com" subject="cfmailqueue restarted by daemon" server="xxx" port="25"  from="xxxx" username="xxxx" password="xxx" replyto="xxxx">
    1/2 action: ...try to restart. Send another mail if succeeded!
    #now()#

    Mails:
    #liste#
    </cfmail>

    <cfset sFactory = CreateObject("java","coldfusion.server.ServiceFactory")>
    <cfset MailSpoolService = sFactory.mailSpoolService>
    <cfset MailSpoolService.stop()>
    <cfset MailSpoolService.start()>

    <!--- info --->
    <cfmail to="x@y.com" subject="cfmailqueue restarted by daemon" server="xxx" port="25"  from="xxxx" username="xxxx" password="xxx" replyto="xxxx">
    2/2 action: ...succeeded!
    #now()#
    </cfmail>

</cfif> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T01:12:05.520

CFMX 8 中的邮件后台处理程序和带有附件的消息存在/存在问题，该问题已通过其中一个修补程序修复。至少 8.0.1 版应该已经修复了这个问题。

# javascript - Javascript 提供了哪些调试日志记录工具？

> ID：94934
> 
> 赞同：9
> 
> 时间：2008-09-18T17:52:47.663
> 
> 标签：javascript, debugging, logging, cross-browser

我想创建一个“通用”调试日志记录函数来检查知名日志库的 JS 命名空间。

例如，目前它支持 Firebug 的 console.log：

```
var console = window['console'];
if (console && console.log) {
  console.log(message);
} 
```

显然，这仅在安装/启用 Firebug 的情况下适用于 Firefox（它也适用于其他带有[Firebug Lite](http://getfirebug.com/lite.html)的浏览器）。基本上，我将提供一个 JS 库，我不知道它将被拉入什么环境，并且我希望能够弄清楚是否有办法向用户报告调试输出。

所以，也许 jQuery 提供了一些东西——我会检查 jQuery 是否存在并使用它。或者也许有一些我可以嗅探的知名 IE 插件。但它必须是一个相当完善和使用的机制。我无法检查人们创建的每个晦涩的日志功能。

请，每个答案只有一个图书馆/技术，所以他们可以获得投票排名。此外，使用 alert() 是一个很好的短期解决方案，但如果您想要强大的调试日志记录或者如果阻止执行是一个问题，那么它就会崩溃。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T18:07:42.590

我个人使用 Firebug/Firebug Lite，在 IE 上让 Visual Studio 进行调试。但是，当访问者使用一些疯狂的浏览器时，这些都没有任何好处。您确实需要让您的客户端 javascript 将其错误记录到您的服务器。看看我在下面链接到的 power point 演示文稿。它有一些关于如何让您的 javascript 在您的服务器上记录内容的非常巧妙的想法。

基本上，你用一个函数钩住 window.onerror 和你的 try {} catch(){} 块，该函数用有用的调试信息向你的服务器发出请求。

我刚刚在自己的 Web 应用程序上实现了这样的过程。我有每个 catch(){} 块调用一个函数，该函数将 JSON 编码的消息发送回服务器，而服务器又使用我现有的日志记录基础设施（在我的例子中是 log4perl）。我链接到的演示文稿还建议在您的 javascript 中加载图像，包括将错误作为 GET 请求的一部分。唯一的问题是如果你想包含堆栈跟踪（IE 根本不会为你生成），请求会太大。

[跟踪客户端错误，作者 Eric Pascarello](http://www.pascarello.com/presentation/CMAP_ERRORS/)

PS：我想补充一点，我认为使用任何类型的库（如 jQuery）进行“硬核”日志记录不是一个好主意，因为您记录错误的原因可能*是*jQuery 或 Firebug Lite！也许错误是浏览器（*咳嗽*IE6）做了一些疯狂的加载命令并抛出某种空引用错误，因为它太愚蠢而无法正确加载库。

在我的例子中，我确保我的所有 javascript 日志代码都在 <head> 中，而不是作为 .js 文件拉入。这样，我可以合理地确定，无论浏览器抛出什么样的曲线球，我都能记录下来。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-01T16:00:33.177

你可以试试[log4javascript](http://log4javascript.org)。

披露：我写的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T17:55:45.253

[Firebug lite](http://getfirebug.com/lite.html)是一个跨浏览器，是 Firefbug 的 lite 版本，至少可以在大多数浏览器上为您提供 console.log 功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T18:47:14.850

[MochiKit](http://www.mochikit.com) has the following functions (included here with full namespace resolution):

```
MochiKit.Logging.logDebug() // prefaces value with "DEBUG: "
MochiKit.Logging.log() // prefaces value with "INFO: "
MochiKit.Logging.logError() // prefaces value with "ERROR: "
MochiKit.Logging.logFatal() // prefaces value with "FATAL: "
MochiKit.Logging.logWarning() // prefaces value with "WARNING: " 
```

There is a lot more to the [**MochiKit.Logging**](http://mochikit.com/doc/html/MochiKit/Logging.html) namespace than this, but these are the basics.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T17:58:26.357

如果您已经在使用 jQuery，我可以衷心推荐 jQuery 调试插件（又名 jquery.debug.js）。看[http://trainofthoughts.org/blog/2007/03/16/jquery-plugin-debug/](http://trainofthoughts.org/blog/2007/03/16/jquery-plugin-debug/)。

此插件允许您通过全局开关关闭或打开调试日志。日志记录如下所示：

```
$.log('My value is: ' + val); 
```

输出被发送到 Firefox 下的 console.log 并被写入到插入在其他浏览器页面底部的 div 块中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T17:56:19.480

[Firebug Lite](http://getfirebug.com/lite.html) （对于那些非 Firefox 浏览器）呢？除了在 IE 中调试 Dojo 代码时，我没有使用太多。但它尽最大努力在 IE、Safari 和 Opera 中放置一个 Firebug 控制台。

当然，总是有可靠的“警报（err_msg）；” :D

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T17:56:21.383

有[JQuery Logging](http://ajaxian.com/archives/jquery-logging)，看起来很有希望。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-18T17:54:05.337

我自己，我坚信以下几点：

```
alert('Some message/variables'); 
```

# python - Python 2.X 中的 range 和 xrange 函数有什么区别？

> ID：94935
> 
> 赞同：798
> 
> 时间：2008-09-18T17:52:51.143
> 
> 标签：python, loops, range, python-2.x, xrange

显然 xrange 更快，但我不知道为什么它更快（除了轶事之外没有证据证明它更快）或者除此之外还有什么不同

```
for i in range(0, 20):
for i in xrange(0, 20): 
```

* * *

## 回答 #1

> 赞同：941
> 
> 时间：2008-09-18T17:55:13.913

**在 Python 2.x 中：**

*   `range`创建一个列表，所以如果你这样做`range(1, 10000000)`，它会在内存中创建一个包含`9999999`元素的列表。

*   `xrange`是一个惰性求值的序列对象。

**在 Python 3 中：**

*   `range`相当于 Python 2 的`xrange`. 要获取列表，您必须明确使用`list(range(...))`.
*   `xrange`不复存在。

* * *

## 回答 #2

> 赞同：235
> 
> 时间：2008-09-18T18:08:19.110

> range 创建一个列表，所以如果你这样做`range(1, 10000000)`，它会在内存中创建一个包含`9999999`元素的列表。
> 
> `xrange` ~~是一个生成器，所以它~~是一个序列对象，它是~~一个~~惰性求值的对象。

这是真的，但在 Python 3 中，`range()`将由 Python 2 实现`xrange()`。如果您需要实际生成列表，则需要执行以下操作：

```
list(range(1,100)) 
```

* * *

## 回答 #3

> 赞同：118
> 
> 时间：2008-09-18T22:11:15.530

请记住，使用该`timeit`模块来测试哪个小代码片段更快！

```
$ python -m timeit 'for i in range(1000000):' ' pass'
10 loops, best of 3: 90.5 msec per loop
$ python -m timeit 'for i in xrange(1000000):' ' pass'
10 loops, best of 3: 51.1 msec per loop 
```

就个人而言，我总是使用`range()`，除非我正在处理*非常*大的列表——正如你所看到的，从时间上看，对于一百万个条目的列表，额外的开销只有 0.04 秒。正如 Corey 指出的那样，在 Python 3.0`xrange()`中将消失，并且`range()`无论如何都会给你很好的迭代器行为。

* * *

## 回答 #4

> 赞同：69
> 
> 时间：2008-09-18T18:13:44.180

`xrange`仅存储范围参数并按需生成数字。然而，Python 的 C 实现目前将其 args 限制为 C long：

```
xrange(2**32-1, 2**32+1)  # When long is 32 bits, OverflowError: Python int too large to convert to C long
range(2**32-1, 2**32+1)   # OK --> [4294967295L, 4294967296L] 
```

请注意，在 Python 3.0 中只有`range`它，它的行为类似于 2.x `xrange`，但没有对最小和最大端点的限制。

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2008-09-18T17:55:00.140

xrange 返回一个迭代器，并且一次只在内存中保留一个数字。range 将整个数字列表保存在内存中。

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2008-09-18T17:55:59.137

一定要花一些时间[阅读图书馆参考资料](https://docs.python.org/2/library/stdtypes.html#typesseq-xrange)。您对它越熟悉，就越能更快地找到此类问题的答案。尤其重要的是关于内置对象和类型的前几章。

> xrange 类型的优点是 xrange 对象将始终占用相同数量的内存，无论它表示的范围大小如何。没有一致的性能优势。

另一种快速查找有关 Python 构造信息的方法是文档字符串和帮助函数：

```
print xrange.__doc__ # def doc(x): print x.__doc__ is super useful
help(xrange) 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2014-04-07T06:25:25.353

该[文档](https://docs.python.org/2/library/functions.html#xrange)清楚地写道：

> 此函数与 非常相似`range()`，但返回一个`xrange`对象而不是列表。这是一种不透明的序列类型，它产生与相应列表相同的值，但实际上并没有同时存储它们。`xrange()`over的优势`range()`是最小的（因为`xrange()`仍然必须在被要求时创建值），除非在内存不足的机器上使用非常大的范围或从未使用过所有范围的元素（例如当循环通常以 ) 结尾`break`。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2016-10-22T11:34:02.377

你会在这个简单的例子中发现`xrange`over的优势：`range`

```
import timeit

t1 = timeit.default_timer()
a = 0
for i in xrange(1, 100000000):
    pass
t2 = timeit.default_timer()

print "time taken: ", (t2-t1)  # 4.49153590202 seconds

t1 = timeit.default_timer()
a = 0
for i in range(1, 100000000):
    pass
t2 = timeit.default_timer()

print "time taken: ", (t2-t1)  # 7.04547905922 seconds 
```

上面的例子在`xrange`.

现在看下面的情况`range`，与`xrange`.

```
import timeit

t1 = timeit.default_timer()
a = 0
for i in xrange(1, 100000000):
    if i == 10000:
        break
t2 = timeit.default_timer()

print "time taken: ", (t2-t1)  # 0.000764846801758 seconds

t1 = timeit.default_timer()
a = 0
for i in range(1, 100000000):
    if i == 10000:
        break
t2 = timeit.default_timer() 

print "time taken: ", (t2-t1)  # 2.78506207466 seconds 
```

有了`range`，它已经创建了一个从 0 到 100000000（耗时）的列表，但是`xrange`它是一个生成器，它只根据需要生成数字，也就是说，如果迭代继续。

在 Python-3 中，`range`功能的实​​现与 Python-2 中的相同，而在 Python-3 中`xrange`它们已经取消`xrange`

编码快乐！！

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2008-09-18T18:44:38.647

> range 创建一个列表，因此如果您执行 range(1, 10000000) 它会在内存中创建一个包含 10000000 个元素的列表。xrange 是一个生成器，因此它的评估是惰性的。

这给您带来了两个好处：

1.  您可以迭代更长的列表而无需获取`MemoryError`.
2.  由于它懒惰地解析每个数字，如果您提前停止迭代，您将不会浪费时间创建整个列表。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2008-09-18T17:59:46.040

这是出于优化的原因。

range() 将创建一个从开始到结束的值列表（在您的示例中为 0 .. 20）。这将成为非常大范围的昂贵操作。

另一方面， xrange() 更加优化。它只会在需要时（通过 xrange 序列对象）计算下一个值，并且不会像 range() 那样创建所有值的列表。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2015-06-23T08:16:59.883

**range():** range(1, 10) 返回一个包含 1 到 10 个数字的列表并将整个列表保存在内存中。

**xrange()：**与 range() 类似，但不是返回列表，而是返回一个对象，该对象根据需要生成范围内的数字。对于循环，这比 range() 稍微快一点，并且内存效率更高。xrange() 对象像一个迭代器并按需生成数字。（惰性评估）

```
In [1]: range(1,10)

Out[1]: [1, 2, 3, 4, 5, 6, 7, 8, 9]

In [2]: xrange(10)

Out[2]: xrange(10)

In [3]: print xrange.__doc__

xrange([start,] stop[, step]) -> xrange object 
```

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2016-07-12T00:05:27.750

`range(x,y)`如果使用`for`循环，则返回 x 和 y 之间的每个数字的列表，则`range`速度较慢。事实上，`range`有更大的指数范围。`range(x.y)`将打印出 x 和 y 之间所有数字的列表

`xrange(x,y)`返回`xrange(x,y)`，但如果您使用`for`循环，则`xrange`更快。`xrange`具有较小的索引范围。`xrange`不仅会打印出来`xrange(x,y)`，还会保留其中的所有数字。

```
[In] range(1,10)
[Out] [1, 2, 3, 4, 5, 6, 7, 8, 9]
[In] xrange(1,10)
[Out] xrange(1,10) 
```

如果你使用`for`循环，那么它会工作

```
[In] for i in range(1,10):
        print i
[Out] 1
      2
      3
      4
      5
      6
      7
      8
      9
[In] for i in xrange(1,10):
         print i
[Out] 1
      2
      3
      4
      5
      6
      7
      8
      9 
```

使用循环时没有太大区别，但仅打印时有区别！

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2015-05-06T21:57:10.227

其他一些答案提到 Python 3 消除了 2.x`range`并将 2.x 重命名`xrange`为`range`. 但是，除非您使用的是 3.0 或 3.1（没有人应该使用），否则它实际上是一种不同的类型。

正如[3.1 文档](https://docs.python.org/3.1/library/stdtypes.html#range-type)所说：

> Range 对象的行为很少：它们只支持索引、迭代和`len`函数。

然而，在 3.2+ 中，`range`它是一个完整的序列——它支持扩展切片，以及[`collections.abc.Sequence`](https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes)与 a 具有相同语义的所有方法`list`。^*

而且，至少在 CPython 和 PyPy（目前仅有的两个 3.2+ 实现）中，它还具有`index`and`count`方法和`in`运算符的恒定时间实现（只要您只传递整数）。这意味着`123456 in r`在 3.2+ 中编写是合理的，而在 2.7 或 3.1 中这将是一个可怕的想法。

* * *

[*在 2.6-2.7 和 3.0-3.1中`issubclass(xrange, collections.Sequence)`返回的事实是在 3.2 中修复且未向后移植[的错误。](http://bugs.python.org/issue9213)`True`]

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2016-02-28T09:42:31.563

在 python 2.x 中

**range(x)**返回一个列表，该列表在内存中使用 x 个元素创建。

```
>>> a = range(5)
>>> a
[0, 1, 2, 3, 4] 
```

**xrange(x)**返回一个 xrange 对象，它是一个生成器 obj，它根据需要生成数字。它们是在 for 循环（惰性评估）期间计算的。

对于循环，这比 range() 稍快，并且内存效率更高。

```
>>> b = xrange(5)
>>> b
xrange(5) 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2011-03-18T12:04:59.797

在循环中针对 xrange 测试 range 时（我知道我应该使用[timeit](http://docs.python.org/library/timeit.html)，但这是使用简单的列表理解示例从内存中迅速破解的）我发现以下内容：

```
import time

for x in range(1, 10):

    t = time.time()
    [v*10 for v in range(1, 10000)]
    print "range:  %.4f" % ((time.time()-t)*100)

    t = time.time()
    [v*10 for v in xrange(1, 10000)]
    print "xrange: %.4f" % ((time.time()-t)*100) 
```

这使：

```
$python range_tests.py
range:  0.4273
xrange: 0.3733
range:  0.3881
xrange: 0.3507
range:  0.3712
xrange: 0.3565
range:  0.4031
xrange: 0.3558
range:  0.3714
xrange: 0.3520
range:  0.3834
xrange: 0.3546
range:  0.3717
xrange: 0.3511
range:  0.3745
xrange: 0.3523
range:  0.3858
xrange: 0.3997 <- garbage collection? 
```

或者，在 for 循环中使用 xrange：

```
range:  0.4172
xrange: 0.3701
range:  0.3840
xrange: 0.3547
range:  0.3830
xrange: 0.3862 <- garbage collection?
range:  0.4019
xrange: 0.3532
range:  0.3738
xrange: 0.3726
range:  0.3762
xrange: 0.3533
range:  0.3710
xrange: 0.3509
range:  0.3738
xrange: 0.3512
range:  0.3703
xrange: 0.3509 
```

我的代码片段测试是否正确？对较慢的 xrange 实例有何评论？或者一个更好的例子:-)

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2016-01-19T12:48:45.973

python 中的 xrange() 和 range() 的工作方式与 user 类似，但是当我们讨论使用这两个函数时如何分配内存时，区别就来了。

当我们使用 range() 时，我们为它生成的所有变量分配内存，因此不建议使用较大的 no。要生成的变量。

另一方面，xrange() 一次只生成一个特定的值，并且只能与 for 循环一起使用以打印所需的所有值。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-09-18T17:55:27.330

range 生成整个列表并返回它。xrange 不会——它会按需生成列表中的数字。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-18T17:55:30.933

xrange 使用迭代器（动态生成值）， range 返回一个列表。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2014-11-26T08:18:28.763

什么？
`range`在运行时返回一个静态列表。
`xrange`返回一个`object`（它的作用就像一个生成器，尽管它肯定不是一个），在需要时从中生成值。

什么时候用哪个？

*   如果`xrange`你想为一个巨大的范围生成一个列表，比如 10 亿，尤其是当你有一个像手机这样的“内存敏感系统”时。
*   `range`如果您想多次迭代列表，请使用。

PS：Python 3.x 的`range`函数 == Python 2.x 的`xrange`函数。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2017-07-24T10:37:26.743

每个人都已经解释得很清楚了。但我想让它亲眼看到。我使用python3。因此，我打开了资源监视器（在 Windows 中！），首先，首先执行以下命令：

```
a=0
for i in range(1,100000):
    a=a+i 
```

然后检查“使用中”内存的变化。这是微不足道的。然后，我运行以下代码：

```
for i in list(range(1,100000)):
    a=a+i 
```

它立即占用了大量内存。而且，我被说服了。你可以自己试试。

如果您使用的是 Python 2X，则将第一个代码中的“range()”替换为“xrange()”，将“list(range())”替换为“range()”。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2017-08-19T05:28:15.627

来自帮助文档。

Python 2.7.12

```
>>> print range.__doc__
range(stop) -> list of integers
range(start, stop[, step]) -> list of integers

Return a list containing an arithmetic progression of integers.
range(i, j) returns [i, i+1, i+2, ..., j-1]; start (!) defaults to 0.
When step is given, it specifies the increment (or decrement).
For example, range(4) returns [0, 1, 2, 3].  The end point is omitted!
These are exactly the valid indices for a list of 4 elements.

>>> print xrange.__doc__
xrange(stop) -> xrange object
xrange(start, stop[, step]) -> xrange object

Like range(), but instead of returning a list, returns an object that
generates the numbers in the range on demand.  For looping, this is 
slightly faster than range() and more memory efficient. 
```

Python 3.5.2

```
>>> print(range.__doc__)
range(stop) -> range object
range(start, stop[, step]) -> range object

Return an object that produces a sequence of integers from start (inclusive)
to stop (exclusive) by step.  range(i, j) produces i, i+1, i+2, ..., j-1.
start defaults to 0, and stop is omitted!  range(4) produces 0, 1, 2, 3.
These are exactly the valid indices for a list of 4 elements.
When step is given, it specifies the increment (or decrement).

>>> print(xrange.__doc__)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'xrange' is not defined 
```

差异是显而易见的。在 Python 2.x 中，`range`返回一个列表，`xrange`返回一个可迭代的 xrange 对象。

在 Python 3.x 中，`range`变为`xrange`Python 2.x，并被`xrange`删除。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2020-03-29T17:06:31.653

**[`range()`](https://docs.python.org/2/library/functions.html#range)在 Python 中`2.x`**

这个函数本质上`range()`是 Python 中可用的旧函数，它`2.x`返回一个`list`包含指定范围内元素的对象实例。

但是，在初始化具有一系列数字的列表时，这种实现效率太低了。例如，`for i in range(1000000)`在内存和时间使用方面，执行命令将是一个非常昂贵的命令，因为它需要将此列表存储到内存中。

* * *

**[`range()`](https://docs.python.org/3/library/functions.html#func-range)在 Python`3.x`和[`xrange()`](https://docs.python.org/2/library/functions.html#xrange)Python 中`2.x`**

Python`3.x`引入了一个较新的实现`range()`（而较新的实现已经在 Python 中`2.x`通过该`xrange()`函数可用）。

该`range()`漏洞利用了一种称为**惰性评估的策略。**较新的实现不是在范围内创建大量元素列表，而是引入了 class `range`，一个轻量级对象，表示给定范围内所需的元素，**而不是将它们显式存储在内存中**（这听起来像生成器，但惰性求值的概念是不同的）。

* * *

例如，考虑以下情况：

```
# Python 2.x
>>> a = range(10)
>>> type(a)
<type 'list'>
>>> b = xrange(10)
>>> type(b)
<type 'xrange'> 
```

和

```
# Python 3.x
>>> a = range(10)
>>> type(a)
<class 'range'> 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2014-01-15T12:45:29.323

关于扫描/打印 0-N 个项目的要求，range 和 xrange 的工作方式如下。

range() - 在内存中创建一个新列表并获取整个 0 到 N 项（总共 N+1）并打印它们。xrange() - 创建一个迭代器实例，它扫描项目并仅将当前遇到的项目保留在内存中，因此始终使用相同数量的内存。

如果所需元素位于列表的开头，那么它可以节省大量时间和内存。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2015-01-03T06:31:21.780

**Range**返回一个**列表**，而**xrange**返回一个**xrange**对象，该对象占用相同的内存，而与范围大小无关，因为在这种情况下，每次迭代只会生成一个元素并且可用，而在使用范围的情况下，所有元素都会一次生成并且在内存中可用。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-05-30T11:23:20.070

对于`range(..)`/的较小参数，差异会减小`xrange(..)`：

```
$ python -m timeit "for i in xrange(10111):" " for k in range(100):" "  pass"
10 loops, best of 3: 59.4 msec per loop

$ python -m timeit "for i in xrange(10111):" " for k in xrange(100):" "  pass"
10 loops, best of 3: 46.9 msec per loop 
```

在这种情况下`xrange(100)`，效率仅提高 20% 左右。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2017-01-10T06:00:16.390

range :-range 将一次填充所有内容。这意味着范围的每个数字都将占用内存。

xrange :-xrange 类似于生成器，当您想要数字范围但又不想存储它们时，它会出现，就像您想在 for 循环中使用时一样。所以内存效率高。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2018-10-08T05:46:37.800

此外， if do`list(xrange(...))`将等同于`range(...)`.

`list`慢也是如此。

也`xrange`真的没有完全完成序列

所以这就是为什么它不是一个列表，它是一个`xrange`对象

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2008-09-18T17:54:40.467

请参阅此[帖子](http://avinashv.net/2008/05/pythons-range-and-xrange/)以查找 range 和 xrange 之间的区别：

去引用：

> `range`完全按照您的想法返回：一个连续整数列表，定义长度以 0 开头`xrange`。但是，返回一个*"xrange object"*，它的作用非常类似于迭代器

# coldfusion - 重新启动 ColdFusion 邮件队列

> ID：94948
> 
> 赞同：11
> 
> 时间：2008-09-18T17:54:24.697
> 
> 标签：coldfusion, administration

我们目前遇到间歇性邮件队列停止。我正在[另一个领域寻求诊断帮助](https://stackoverflow.com/questions/94932/coldfusion-mail-queue-stops-processing)。

同时，有没有办法在不重新启动整个服务的情况下重新启动 CF 邮件队列？

CF8 标准 Win2k3

解决方案：我们现在正在检查邮件队列中最旧文件的年龄。当超过设定的时间（当前为 30 分钟）时，邮件队列会重新启动。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-18T18:39:38.860

就在这里。

```
<cfset sFactory = CreateObject("java","coldfusion.server.ServiceFactory")>
<cfset MailSpoolService = sFactory.mailSpoolService>
<cfset MailSpoolService.stop()>
<cfset MailSpoolService.start()> 
```

# python - Parsec 的 Python 实现？

> ID：94952
> 
> 赞同：14
> 
> 时间：2008-09-18T17:54:39.547
> 
> 标签：python, parsing, parsec, combinators

我最近使用 Ply 在 Python 中编写了一个解析器（它是 yacc 的 Python 重新实现）。当我几乎用完解析器时，我发现我需要解析的语法需要我在解析过程中进行一些查找以通知词法分析器。如果不进行查找以通知词法分析器，我将无法正确解析该语言中的字符串。

鉴于我无法从语法规则中控制词法分析器的状态，我想我将使用解析器模块中的查找表来解决我的用例，但维护/测试可能变得太难了。所以我想知道其他一些选择。

在 Haskell 中，我会使用 Parsec，一个解析函数库（称为组合子）。是否有 Parsec 的 Python 实现？或者也许是其他一些具有解析功能的生产质量库，以便我可以在 Python 中构建上下文敏感的解析器？

编辑：我所有的上下文无关解析尝试都失败了。出于这个原因，我不希望 ANTLR 在这里有用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T18:58:12.937

我相信[pyparsing](http://pyparsing.wikispaces.com/ "PyParsing 网站")是基于与 parsec 相同的原理。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T18:34:52.040

[PySec是另一个monadic解析器，我不太了解，但是这里](http://www.valuedlessons.com/2008/02/pysec-monadic-combinatoric-parsing-in.html)值得一看

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-18T18:00:05.213

您可能会考虑的一个选项，如果您可以使用 LL 解析器，则可以尝试[ANTLR](http://www.antlr.org/wiki/display/ANTLR3/Antlr3PythonTarget)，它也可以生成 python（实际上它是 LL(*)，正如他们的名字一样，* 代表它可以应对的前瞻数量和）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T18:58:07.270

没有什么能阻止您使用 PLY 将解析器从“无上下文”路径转移。您可以在解析期间将信息传递给词法分析器，从而实现充分的灵活性。我很确定你可以用这种方式解析任何你想要的东西。

对于动手示例，请[考虑](http://code.google.com/p/pycparser/)- 它是用 Python 和 PLY 编写的 ANSI C 解析器。它通过在解析器中填充符号表来解决经典的 C typedef - 标识符问题（使 C 的语法不区分上下文），该符号表在词法分析器中用于将符号名称解析为类型或非类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T18:02:07.673

有 ANTLR，它是 LL(*)，有 PyParsing，它对对象更友好，有点像 DSL，还有[Parsing](http://www.canonware.com/Parsing/)，它就像 OCaml 的 Menhir。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T18:08:28.470

[ANTLR](http://www.antlr.org/)很棒，并且具有跨多种语言工作的额外好处。

# sql - 您如何确定表的多个触发器的优先级？

> ID：94959
> 
> 赞同：6
> 
> 时间：2008-09-18T17:55:05.753
> 
> 标签：sql, sql-server-2005, tsql, triggers

我在一张桌子上有几个触发器，我想保持***分开***并希望对它们进行优先级排序。

我可以只有一个触发器并在那里执行逻辑，但我想知道是否有一种更简单/合乎逻辑的方法来实现它以预定义的顺序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T17:56:12.053

使用 sp_settriggerorder。您可以根据操作指定要触发的第一个和最后一个触发器。

[MSDN 上的 sp_settriggerorder](http://msdn.microsoft.com/en-us/library/ms186762.aspx)

从上面的链接：
**A. 设置 DML 触发器**
的触发顺序 下面的示例指定触发器 uSalesOrderHeader 是在 Sales.SalesOrderHeader 表上发生 UPDATE 操作后触发的第一个触发器。

```
使用 AdventureWorks；
去
sp_settriggerorder
    @triggername='Sales.uSalesOrderHeader',
    @order='第一',
    @stmttype = '更新';

```

**B. 设置 DDL 触发器**
的触发顺序 以下示例指定触发器 ddlDatabaseTriggerLog 是 AdventureWorks 数据库中发生 ALTER_TABLE 事件后触发的第一个触发器。

```
使用 AdventureWorks；
去
sp_settriggerorder
    @triggername='ddlDatabaseTriggerLog',
    @order='第一',
    @stmttype = 'ALTER_TABLE',
    @namespace = '数据库';

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T17:56:37.577

见[这里](https://stackoverflow.com/questions/94103/sql-server-triggers-order-of-execution#94162)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T18:03:30.307

您可以使用[sp_settriggerorder](http://msdn.microsoft.com/en-us/library/ms186762.aspx)定义表上每个触发器的顺序。

但是，我认为最好使用一个触发器来执行多项操作。如果顺序很重要，则*尤其*如此，因为如果您有多个触发器，则该重要性不会很明显。想象一下有人试图在数月/数年内支持数据库。当然，在某些情况下，您可能需要多个触发器，或者它确实是更好的设计，但我会开始假设您应该拥有一个并从那里开始工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T18:11:09.117

请记住，如果您更改触发顺序，其他人可能稍后会过来重新排列。你会在哪里记录触发顺序应该是什么，以便维护开发人员知道不要弄乱顺序，否则事情会中断？如果两个触发任务肯定必须按特定顺序执行，唯一安全的方法是将它们放在同一个触发器中。

# artificial-intelligence - 您如何使用 A-Star 或 Dijkstra 算法解决 15 个难题？

> ID：94975
> 
> 赞同：16
> 
> 时间：2008-09-18T17:56:20.290
> 
> 标签：artificial-intelligence, graph-theory, dijkstra, a-star

我在我的一本 AI 书籍中读到，在模拟或游戏中用于寻路的流行算法（A-Star、Dijkstra）也用于解决著名的“15 谜题”。

谁能给我一些关于如何将 15 谜题简化为节点和边图的指示，以便我可以应用其中一种算法？

如果我将图中的每个节点都视为游戏状态，那么那棵树不会变得很大吗？或者这只是这样做的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-12T18:20:49.250

对于 A-Star 的 15 谜题，一个很好的启发式方法是位于错误位置的方格数。因为每格错位至少需要 1 步，所以错位的格数保证小于或等于解决难题所需的步数，使其成为 A-Star 的适当启发式.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-22T20:13:58.373

快速的 Google 搜索会找到几篇详细介绍这一点的论文：一篇关于[Parallel Combinatorial Search](http://web.archive.org/web/20170329021919/http://www.cse.psu.edu:80/~pxr3/optslides.pdf)，一篇关于[External-Memory Graph Search](http://icaps08.cecs.anu.edu.au/TUTORIALS/Edelkamp-Hansen-Jabbar-Zhou.pdf)

关于算法问题的一般经验法则：*可能有人在你之前完成了它，并发表了他们的发现*。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-20T19:01:10.967

这是一个关于使用 A* 算法的 8-puzzle 问题的作业，但也相当简单：

[http://www.cs.princeton.edu/courses/archive/spring09/cos226/assignments/8puzzle.html](http://www.cs.princeton.edu/courses/archive/spring09/cos226/assignments/8puzzle.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-03T09:34:47.457

解决这个问题的图论方法是将棋盘的每个配置想象成图的一个顶点，然后根据棋盘的曼哈顿距离之类的东西使用带有修剪的呼吸优先搜索来从起点推导出最短路径配置到解决方案。

这种方法的一个问题是，对于任何游戏空间变得如此之大以至于不清楚如何有效地标记访问过的顶点的`n x n`棋盘。`n > 3`换句话说，没有明显的方法来评估电路板的当前配置是否与之前通过遍历其他路径发现的配置相同。另一个问题是图的大小增长得如此之快`n`（大约`(n^2)!`是 ）以至于它不适合暴力攻击，因为路径的数量在计算上变得无法遍历。

Ian Parberry 的这篇论文[A Real-Time Algorithm for the `(n^2 − 1)`- Puzzle](http://larc.unt.edu/ian/pubs/saml.pdf)描述了一个简单的贪心算法，它通过完成第一行、第一列、第二行来迭代地得出一个解决方案……它几乎立即得出一个解决方案，但解决方案远非最优；从本质上讲，它以人类的方式解决了问题，而无需利用任何计算能力。

这个问题与解决魔方问题密切相关。所有游戏的图表都表明它太大而无法通过暴力解决，但是有一个相当简单的 7 步方法可以让灵巧的人在大约 1 到 2 分钟内解决任何立方体。这条路径当然不是最优的。通过学习识别定义动作序列的模式，速度可以降低到[17 秒](http://ws2.binghamton.edu/fridrich/cube.html)。不过，吉里的这个壮举，却是有些超人！

Parberry 所描述的方法一次只移动一个图块；可以想象，通过利用 Jiri 的灵巧性并一次移动多个图块，可以使算法变得更好。正如 Parberry 证明的那样，这不会减少从 的路径长度`n^3`，但会减少前导项的系数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-10-29T10:05:03.620

请记住，A* 将搜索问题空间，沿着您的启发式定义的最可能的目标路径前进。

只有在最坏的情况下，它才会最终不得不淹没整个问题空间，当您的问题没有实际解决方案时，往往会发生这种情况。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T18:08:26.050

只需使用游戏树。请记住，树是图的一种特殊形式。

在您的情况下，每个节点的叶子将成为您进行当前节点可用的移动之一后的游戏位置。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-20T18:37:31.610

给你[http://www.heyes-jones.com/astar.html](http://www.heyes-jones.com/astar.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-22T20:19:35.567

还。请注意，至少使用 A-Star 算法，您需要找出一个可接受的启发式算法，以确定可能的下一步是否比另一步更接近完成的路线。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-25T05:38:06.267

根据我目前的经验，关于如何解决一个 8 谜题。创建节点是必需的。跟踪所采取的每一步，并从接下来的每一步中获取曼哈顿距离，走/走到距离最短的那一步。更新节点，并继续直到达到目标

# c# - 为什么“catch”或“finally”范围内的“try”中没有声明变量？

> ID：94977
> 
> 赞同：157
> 
> 时间：2008-09-18T17:56:23.880
> 
> 标签：c#, java, exception, scope, language-design

在 C# 和 Java（可能还有其他语言）中，在“try”块中声明的变量不在相应的“catch”或“finally”块的范围内。例如，以下代码无法编译：

```
try {
  String s = "test";
  // (more code...)
}
catch {
  Console.Out.WriteLine(s);  //Java fans: think "System.out.println" here instead
} 
```

在这段代码中，catch 块中对 s 的引用会发生编译时错误，因为 s 仅在 try 块的范围内。（在 Java 中，编译错误是“s cannot be resolved”；在 C# 中，是“The name 's' does not exist in the current context”。）

这个问题的一般解决方案似乎是在 try 块之前声明变量，而不是在 try 块中：

```
String s;
try {
  s = "test";
  // (more code...)
}
catch {
  Console.Out.WriteLine(s);  //Java fans: think "System.out.println" here instead
} 
```

然而，至少对我来说，（1）这感觉像是一个笨拙的解决方案，并且（2）它导致变量的范围比程序员预期的更大（方法的整个其余部分，而不是仅在try-catch-finally）。

我的问题是，这种语言设计决策背后的基本原理是什么（在 Java、C# 和/或任何其他适用的语言中）？

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2008-09-18T18:01:57.237

两件事情：

1.  一般来说，Java 只有 2 个级别的范围：全局和函数。但是，try/catch 是一个例外（没有双关语的意思）。当抛出异常并且异常对象获得分配给它的变量时，该对象变量仅在“catch”部分中可用，并在 catch 完成后立即销毁。

2.  （更重要的是）。您无法知道异常是在 try 块中的哪个位置引发的。它可能是在你的变量被声明之前。因此，不可能说 catch/finally 子句可以使用哪些变量。考虑以下情况，其中范围是您建议的：

    ```
     try
    {
        throw new ArgumentException("some operation that throws an exception");
        string s = "blah";
    }
    catch (e as ArgumentException)
    {  
        Console.Out.WriteLine(s);
    } 
    ```

这显然是一个问题——当您到达异常处理程序时，s 将不会被声明。鉴于 catch 旨在处理异常情况并且 finally*必须*执行，因此在编译时安全并声明这是一个问题比在运行时要好得多。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-09-18T17:58:40.020

你怎么能确定你到达了你的 catch 块中的声明部分？如果实例化抛出异常怎么办？

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-09-18T18:03:22.177

传统上，在 C 风格的语言中，花括号内发生的事情都保留在花括号内。我认为让变量的生命周期跨越这样的范围对于大多数程序员来说是不直观的。您可以通过将 try/catch/finally 块包含在另一层大括号中来实现您想要的。例如

```
... code ...
{
    string s = "test";
    try
    {
        // more code
    }
    catch(...)
    {
        Console.Out.WriteLine(s);
    }
} 
```

编辑：我想每条规则都有例外*。*以下是有效的 C++：

```
int f() { return 0; }

void main() 
{
    int y = 0;

    if (int x = f())
    {
        cout << x;
    }
    else
    {
        cout << x;
    }
} 
```

x 的范围是条件、then 子句和 else 子句。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-18T21:48:08.067

其他人都提出了基础知识——一个块中发生的事情留在一个块中。但在 .NET 的情况下，检查编译器认为正在发生的事情可能会有所帮助。举个例子，下面的 try/catch 代码（注意 StreamReader 是在块外正确声明的）：

```
static void TryCatchFinally()
{
    StreamReader sr = null;
    try
    {
        sr = new StreamReader(path);
        Console.WriteLine(sr.ReadToEnd());
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.ToString());
    }
    finally
    {
        if (sr != null)
        {
            sr.Close();
        }
    }
} 
```

这将编译为类似于 MSIL 中的以下内容：

```
.method private hidebysig static void  TryCatchFinallyDispose() cil managed
{
  // Code size       53 (0x35)    
  .maxstack  2    
  .locals init ([0] class [mscorlib]System.IO.StreamReader sr,    
           [1] class [mscorlib]System.Exception ex)    
  IL_0000:  ldnull    
  IL_0001:  stloc.0    
  .try    
  {    
    .try    
    {    
      IL_0002:  ldsfld     string UsingTest.Class1::path    
      IL_0007:  newobj     instance void [mscorlib]System.IO.StreamReader::.ctor(string)    
      IL_000c:  stloc.0    
      IL_000d:  ldloc.0    
      IL_000e:  callvirt   instance string [mscorlib]System.IO.TextReader::ReadToEnd()
      IL_0013:  call       void [mscorlib]System.Console::WriteLine(string)    
      IL_0018:  leave.s    IL_0028
    }  // end .try
    catch [mscorlib]System.Exception 
    {
      IL_001a:  stloc.1
      IL_001b:  ldloc.1    
      IL_001c:  callvirt   instance string [mscorlib]System.Exception::ToString()    
      IL_0021:  call       void [mscorlib]System.Console::WriteLine(string)    
      IL_0026:  leave.s    IL_0028    
    }  // end handler    
    IL_0028:  leave.s    IL_0034    
  }  // end .try    
  finally    
  {    
    IL_002a:  ldloc.0    
    IL_002b:  brfalse.s  IL_0033    
    IL_002d:  ldloc.0    
    IL_002e:  callvirt   instance void [mscorlib]System.IDisposable::Dispose()    
    IL_0033:  endfinally    
  }  // end handler    
  IL_0034:  ret    
} // end of method Class1::TryCatchFinallyDispose 
```

我们看到了什么？MSIL 尊重这些块——它们本质上是编译 C# 时生成的底层代码的一部分。范围不仅在 C# 规范中是硬性设置的，在 CLR 和 CLS 规范中也是如此。

范围可以保护您，但您有时必须解决它。随着时间的推移，你会习惯它，它开始感觉自然。就像其他人所说的那样，一个区块中发生的事情会留在那个区块中。你想分享一些东西吗？你必须走出街区......

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-18T17:59:19.350

无论如何，在 C++ 中，自动变量的范围受到围绕它的花括号的限制。为什么有人会期望通过在花括号外插入一个 try 关键字来实现这一点？

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-18T18:03:58.853

就像 ravenpoint 指出的那样，每个人都希望变量在定义它们的块中是本地的。`try`引入一个块也是如此`catch`。

如果您想要两个`try`和的本地变量`catch`，请尝试将两者都包含在一个块中：

```
// here is some code
{
    string s;
    try
    {

        throw new Exception(":(")
    }
    catch (Exception e)
    {
        Debug.WriteLine(s);
    }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-18T18:06:59.580

简单的答案是 C 和大多数继承其语法的语言都是块作用域的。这意味着如果一个变量被定义在一个块中，即在 { } 内，那就是它的作用域。

顺便说一句，JavaScript 是个例外，它有类似的语法，但它是函数作用域的。在 JavaScript 中，在 try 块中声明的变量在 catch 块的范围内，在其包含函数的其他任何地方。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-19T07:31:29.193

根据**MCTS Self-Paced Training Kit (Exam 70-536) 第 2 课：Microsoft® .NE​​T Framework 2.0—Application Development Foundation**中标题为“如何抛出和捕获异常”的部分，原因是可能发生了异常在 try 块中的变量声明之前（正如其他人已经指出的那样）。

引自第 25 页：

“请注意，在前面的示例中，StreamReader 声明已移到 Try 块之外。这是必要的，因为 finally 块无法访问在 Try 块中声明的变量。***这是有道理的，因为根据发生异常的位置，变量声明中的尝试块可能尚未执行***。”

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-18T18:12:04.187

@burkhard 有一个关于为什么回答正确的问题，但作为我想添加的注释，虽然您推荐的解决方案示例在 99.9999+% 的时间内都很好，但这不是好的做法，在使用之前检查 null 会更安全在 try 块中实例化某个东西，或者将变量初始化为某个东西，而不是在 try 块之前声明它。例如：

```
string s = String.Empty;
try
{
    //do work
}
catch
{
   //safely access s
   Console.WriteLine(s);
} 
```

或者：

```
string s;
try
{
    //do work
}
catch
{
   if (!String.IsNullOrEmpty(s))
   {
       //safely access s
       Console.WriteLine(s);
   }
} 
```

这应该在解决方法中提供可伸缩性，因此即使您在 try 块中所做的操作比分配字符串更复杂，您也应该能够安全地从 catch 块访问数据。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-18T18:37:26.747

正如每个人都指出的那样，答案几乎是“这就是定义块的方式”。

有一些建议可以使代码更漂亮。见[ARM](http://docs.google.com/View?docid=dffxznxr_1nmsqkz&pli=1)

```
 try (FileReader in = makeReader(), FileWriter out = makeWriter()) {
       // code using in and out
 } catch(IOException e) {
       // ...
 } 
```

[闭包](http://www.javac.info/)也应该解决这个问题。

```
with(FileReader in : makeReader()) with(FileWriter out : makeWriter()) {
    // code using in and out
} 
```

**更新：** ARM 在 Java 7 中实现。[http://download.java.net/jdk7/docs/technotes/guides/language/try-with-resources.html](http://download.java.net/jdk7/docs/technotes/guides/language/try-with-resources.html)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-18T18:00:22.840

您的解决方案正是您应该做的。您甚至无法确定在 try 块中是否达到了您的声明，这将导致 catch 块中的另一个异常。

它必须作为单独的范围工作。

```
try
    dim i as integer = 10 / 0 ''// Throw an exception
    dim s as string = "hi"
catch (e)
    console.writeln(s) ''// Would throw another exception, if this was allowed to compile
end try 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-18T18:02:04.740

这些变量是块级别的，并且仅限于该 Try 或 Catch 块。类似于在 if 语句中定义变量。想想这种情况。

```
try {    
    fileOpen("no real file Name");    
    String s = "GO TROJANS"; 
} catch (Exception) {   
    print(s); 
} 
```

String 永远不会被声明，所以它不能被依赖。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-18T18:05:57.180

因为 try 块和 catch 块是 2 个不同的块。

在下面的代码中，您是否希望块 A 中定义的 s 在块 B 中可见？

```
{ // block A
  string s = "dude";
}

{ // block B
  Console.Out.WriteLine(s); // or printf or whatever
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-18T18:11:52.237

虽然在您的示例中它不起作用很奇怪，但请使用类似的示例：

```
 try
    {
         //Code 1
         String s = "1|2";
         //Code 2
    }
    catch
    {
         Console.WriteLine(s.Split('|')[1]);
    } 
```

如果代码 1 中断，这将导致 catch 抛出空引用异常。现在，虽然 try/catch 的语义已经很好理解了，但这将是一个烦人的极端情况，因为 s 是用初始值定义的，所以理论上它不应该为 null，但在共享语义下，它会是。

同样，这在理论上可以通过只允许单独的定义 ( `String s; s = "1|2";`) 或其他一些条件来解决，但通常说不更容易。

此外，它允许无一例外地在全局范围内定义范围的语义，特别`{}`是在所有情况下，只要在其中定义了局部变量，它们就会持续存在。小点，但是点。

最后，为了做你想做的事，你可以在 try catch 周围添加一组括号。为您提供所需的范围，尽管它确实以牺牲一点可读性为代价，但不会太多。

```
{
     String s;
     try
     {
          s = "test";
          //More code
     }
     catch
     {
          Console.WriteLine(s);
     }
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-19T06:00:20.113

在 Python 中，如果声明它们的行没有抛出，它们在 catch/finally 块中是可见的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-18T18:02:53.520

在您给出的具体示例中，初始化 s 不能引发异常。所以你会认为它的范围可能会扩大。

但一般来说，初始化表达式可以抛出异常。对于初始化器引发异常（或在发生这种情况的另一个变量之后声明的）的变量在 catch/finally 的范围内是没有意义的。

此外，代码可读性也会受到影响。C（以及遵循它的语言，包括 C++、Java 和 C#）中的规则很简单：变量作用域遵循块。

如果您希望变量在 try/catch/finally 的范围内，但没有其他地方，则将整个事物包装在另一组大括号（裸块）中并在 try 之前声明变量。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-18T18:04:06.217

它们不在同一范围内的部分原因是因为在 try 块的任何时候，您都可以抛出异常。如果它们在同一个范围内，等待是一场灾难，因为根据抛出异常的位置，它可能会更加模棱两可。

至少当它在 try 块之外声明时，您至少可以确定在抛出异常时该变量可能是什么；try 块之前的变量值。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-09-18T18:12:41.627

当您声明一个局部变量时，它被放置在堆栈上（对于某些类型，对象的整个值将在堆栈上，对于其他类型，只有一个引用将在堆栈上）。当 try 块内发生异常时，块内的局部变量被释放，这意味着堆栈被“展开”回它在 try 块开始时的状态。这是设计使然。这就是 try / catch 能够退出块内的所有函数调用并将您的系统恢复到功能状态的方式。如果没有这种机制，您将永远无法确定异常发生时的任何状态。

让你的错误处理代码依赖于外部声明的变量，这些变量的值在 try 块内发生了变化，这对我来说似乎是糟糕的设计。您所做的实际上是为了获取信息而故意泄漏资源（在这种特殊情况下，这并没有那么糟糕，因为您只是在泄漏信息，但是想象一下它是否是其他资源？您只是在使自己的生活更加艰难未来）。如果您需要更精细的错误处理，我建议您将 try 块分成更小的块。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-18T18:14:59.060

[C# 规范](http://www.ecma-international.org/publications/standards/Ecma-334.htm)(15.2) 声明“在块中声明的局部变量或常量的范围就是块” 。

（在您的第一个示例中，try 块是声明“s”的块）

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-18T18:19:20.517

当你有一个 try catch 时，你应该最多知道它可能抛出的错误。Theese Exception 类通常会告诉您有关异常的所有信息。如果没有，您应该创建自己的异常类并传递该信息。这样，您将永远不需要从 try 块中获取变量，因为异常是自我解释的。因此，如果您需要做很多事情，请考虑一下您的设计，并尝试考虑是否有其他方式，您可以预测异常的到来，或者使用来自异常的信息，然后重新抛出您自己的有更多信息的例外。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-18T18:22:55.500

正如其他用户所指出的，花括号定义了我所知道的几乎所有 C 风格语言的范围。

如果它是一个简单的变量，那么您为什么要关心它在范围内的时间？这没什么大不了的。

在 C# 中，如果它是一个复杂变量，您将需要实现 IDisposable。然后，您可以使用 try/catch/finally 并在 finally 块中调用 obj.Dispose()。或者你可以使用 using 关键字，它会在代码部分的末尾自动调用 Dispose。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2010-12-29T10:23:14.093

如果在变量声明之上的某些代码中引发异常怎么办。这意味着，在这种情况下，声明本身并没有发生。

```
try {

       //doSomeWork // Exception is thrown in this line. 
       String s;
       //doRestOfTheWork

} catch (Exception) {
        //Use s;//Problem here
} finally {
        //Use s;//Problem here
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-18T17:58:42.657

我的想法是，因为 try 块中的某些东西触发了异常，它的命名空间内容不能被信任——即在 catch 块中引用 String 's' 可能会导致另一个异常的抛出。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-18T17:58:58.490

好吧，如果它没有抛出编译错误，并且您可以为方法的其余部分声明它，那么就没有办法只在 try 范围内声明它。它迫使您明确说明变量应该存在的位置并且不做出假设。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-18T23:56:43.373

如果我们暂时忽略范围块问题，编译器将不得不在没有明确定义的情况下更加努力地工作。虽然这并非不可能，但范围错误也会迫使您（代码的作者）意识到您编写的代码的含义（字符串 s 在 catch 块中可能为 null）。如果您的代码是合法的，那么在 OutOfMemory 异常的情况下，甚至不能保证为 s 分配一个内存槽：

```
// won't compile!
try
{
    VeryLargeArray v = new VeryLargeArray(TOO_BIG_CONSTANT); // throws OutOfMemoryException
    string s = "Help";
}
catch
{
    Console.WriteLine(s); // whoops!
} 
```

CLR（以及因此编译器）还强制您在使用变量之前对其进行初始化。在呈现的 catch 块中，它不能保证这一点。

所以我们最终让编译器不得不做很多工作，这在实践中并没有带来太多好处，并且可能会使人们感到困惑并导致他们问为什么 try/catch 工作方式不同。

除了一致性之外，通过不允许任何花哨的东西并坚持在整个语言中使用的已经建立的范围语义，编译器和 CLR 能够为 catch 块内的变量状态提供更大的保证。它存在并已被初始化。

请注意，语言设计人员在其他构造方面做得很好，例如在问题和范围明确定义的地方*使用*和*锁定，这使您可以编写更清晰的代码。*

例如*IDisposable*对象的*using*关键字：

 *```
using(Writer writer = new Writer())
{
    writer.Write("Hello");
} 
```

相当于：

```
Writer writer = new Writer();
try
{        
    writer.Write("Hello");
}
finally
{
    if( writer != null)
    {
        ((IDisposable)writer).Dispose();
    }
} 
```

如果您的 try/catch/finally 难以理解，请尝试重构或引入另一层间接层，其中包含封装您尝试完成的语义的中间类。没有看到真实的代码，很难更具体。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-07-23T17:40:09.427

可以声明一个公共属性，而不是一个局部变量；这也应该避免未分配变量的另一个潜在错误。公共字符串 S { 获取；放; }

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2008-09-18T18:01:18.907

如果赋值操作失败，您的 catch 语句将对未赋值变量有一个空引用。

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2008-09-18T23:58:27.987

C# 3.0：

```
string html = new Func<string>(() =>
{
    string webpage;

    try
    {
        using(WebClient downloader = new WebClient())
        {
            webpage = downloader.DownloadString(url);
        }
    }
    catch(WebException)
    {
        Console.WriteLine("Download failed.");  
    }

    return webpage;
})(); 
```

# algorithm - 您如何对 IO 操作进行速率限制？

> ID：94997
> 
> 赞同：6
> 
> 时间：2008-09-18T17:58:33.610
> 
> 标签：algorithm, language-agnostic, io

假设您有一个从套接字读取的程序。您如何将下载速率保持在某个给定阈值以下？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-18T18:15:41.447

在应用层（使用 Berkeley 套接字样式 API），您只需查看时钟，并以您想要限制的速率读取或写入数据。

如果您平均只读取 10kbps，但源发送的速度超过了 10kbps，那么最终它和您之间的所有缓冲区都会填满。TCP/IP 允许这样做，并且协议会安排发送方减速（在应用层，您可能只需要知道在另一端，阻塞写入调用会阻塞，非阻塞写入会失败，并且异步在您读取足够的数据以允许写入之前，写入不会完成）。

在应用层，你只能是近似的——你不能保证硬限制，例如“在任何一秒钟内，不超过 10 kb 将通过网络中的给定点”。但是，如果您跟踪收到的内容，从长远来看，您可以获得正确的平均值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T18:03:08.387

假设网络传输，基于 TCP/IP 的传输，数据包被发送以响应 ACK/NACK 数据包以另一种方式发送。

通过限制确认接收传入数据包的数据包速率，您将反过来降低发送新数据包的速率。

它可能有点不精确，因此它可能是监控下游速率并自适应调整响应速率直到它落在舒适阈值内的最佳选择。（这会很快发生，但是，您会每秒发送大量确认）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T18:04:27.807

如果您正在从套接字读取，则无法控制所使用的带宽 - 您正在读取该套接字的操作系统缓冲区，并且您所说的任何内容都不会使写入套接字的人写入更少的数据（除非，当然，您已经为此制定了协议）。

缓慢的阅读只会填满缓冲区，并最终导致网络端停止 - 但您无法控制这种情况发生的方式或时间。

如果你真的想一次只读取这么多数据，你可以这样做：

```
ReadFixedRate() {
  while(Data_Exists()) {
    t = GetTime();
    ReadBlock();
    while(t + delay > GetTime()) {
      Delay()'
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T18:18:16.120

就像将游戏限制在一定数量的 FPS 时一样。

```
extern int FPS;
....    
timePerFrameinMS = 1000/FPS;

while(1) {
time = getMilliseconds();
DrawScene();
time = getMilliseconds()-time;
if (time < timePerFrameinMS) {
   sleep(timePerFrameinMS - time);
}
} 
```

这样可以确保游戏刷新率最高为 FPS。以同样的方式，DrawScene 可以是用于将字节泵入套接字流的函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T18:12:07.600

wget 似乎使用 --limit-rate 选项来管理它。这是手册页的内容：

> 请注意，Wget 通过在网络读取花费的时间少于速率指定的时间后休眠适当的时间来实现限制。最终，此策略会导致 TCP 传输减慢到大约指定的速率。但是，实现这种平衡可能需要一些时间，因此如果限制速率不适用于非常小的文件，请不要感到惊讶。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T18:16:21.320

正如其他人所说，操作系统内核正在管理流量，您只是从内核内存中读取数据的副本。要粗略地限制一个应用程序的速率，您需要延迟读取数据并允许传入数据包在内核中缓冲，这最终会减慢对传入数据包的确认并降低该套接字的速率。

如果您想减慢机器的所有流量，您需要调整传入 TCP 缓冲区的大小。在 Linux 中，您可以通过更改 /proc/sys/net/ipv4/tcp_rmem（读取内存缓冲区大小）和其他 tcp_* 文件中的值来影响此更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T18:19:13.467

要添加到 Branan 的答案：

如果您自愿限制接收端的读取速度，最终队列将在两端填满。然后，发送方要么阻塞其 send() 调用，要么从 send() 调用返回，其 sent_length 小于传递给 send() 调用的预期长度。

如果发件人没有准备好通过休眠并尝试重新发送不适合操作系统缓冲区的内容来处理这种情况，您最终将遇到连接问题（发件人可能会将其检测为错误）或丢失数据（发件人可能在不知不觉中丢弃不适合操作系统缓冲区的数据）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-05T00:09:46.433

设置小的套接字发送和接收缓冲区，比如 1k 或 2k，这样带宽 * 延迟乘积 = 缓冲区大小。您可能无法通过快速链接将其变得足够小。

# unix - 替代“truss -p”指令

> ID：94999
> 
> 赞同：1
> 
> 时间：2008-09-18T17:58:41.860
> 
> 标签：unix, process, solaris, status, truss

我正在寻找 Unix 中返回进程状态的命令（活动、死亡、睡眠、等待另一个进程等）

有没有可用的？
一个shell脚本可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T19:42:18.150

在 linux 中，类似 ps -p somepid --no-headers -o state 的东西应该可以工作，或者您可以使用 grep ^State: /proc/somepid/status 在 proc 中查找信息

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-20T05:49:01.713

尝试*pflags <pid>*，它将为您提供每个线程的状态信息。例子：

```
root@weetbix # pflags $$
3384：重击
        数据模型 = _ILP32 标志 = ORPHAN|MSACCT|MSFORK
 /1: 标志 = ASLEEP waitid(0x7,0x0,0xffbfefc0,0xf)
        sigmask = 0x00020000,0x00000000

```

还可以查看*pflags*的手册页以查看其他有用的工具，例如*pstack*、*pfiles*、*pargs*等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T18:05:19.147

玩 ps 选项并不能满足您的需要？****