# StackOverflow 问答 12360000-12360999

# python - 根据祖父母在数据存储中搜索数据

> ID：12360000
> 
> 赞同：0
> 
> 时间：2012-09-10T21:55:08.447
> 
> 标签：python, google-app-engine, ancestor

下面是 python 代码，我试图从预订模型中获取预订信息。

```
 i=0
    for c in courts:
        court = names[i]
        i=i+1
        c_key=c.key()
        logging.info("c_key: %s " % c_key)
        weekday_key= db.Key.from_path('Courts', 'c_key', 'Days', weekday)
        logging.info("weekday_key: %s " % weekday_key)
        logging.info("weekday: %s " % weekday)
        logging.info("court: %s " % court)
        reservation = db.Query(Reservations)
        nlimit=2*len(times)
        reservations = reservation.fetch(limit=nlimit)
        logging.info("reservations: %s " % len(reservations)) 
```

我的 Courts 数据库中只有两个法院实体，court1 和 court2。在我的 Days 数据库中也只有 14 个工作日实体，7 个用于 court1，7 个用于 court2，名为 Sunday, ... , Saturday。在当前示例中，我试图获取 2 个星期一的密钥，一个用于 court1，一个用于 court2。`weekday_key`我不明白为什么根据下面的日志，对于两个拥有不同钥匙的不同法院，我得到的结果是一样的`c_key`。

在下面的日志中，无论我输入`db.Key.from_path(`命令 'c_key' 还是 'court' 我都会得到完全相同的结果，这表明 2`weekday_key`的值是相同的，而不是我预期的不同。

```
INFO     2012-09-10 21:25:19,189 views.py:226] c_key: ag1kZXZ-c2NoZWR1bGVycicLEglMb2NhdGlvbnMiBlJvZ2VycwwLEgZDb3VydHMiBmNvdXJ0MQw 
INFO     2012-09-10 21:25:19,189 views.py:228] weekday_key: ag1kZXZ-c2NoZWR1bGVyciELEgZDb3VydHMiBWNfa2V5DAsSBERheXMiBk1vbmRheQw 
INFO     2012-09-10 21:25:19,189 views.py:229] weekday: Monday 
INFO     2012-09-10 21:25:19,189 views.py:230] court: court1 
INFO     2012-09-10 21:25:19,192 views.py:235] reservations: 1 
INFO     2012-09-10 21:25:19,192 views.py:226] c_key: ag1kZXZ-c2NoZWR1bGVycicLEglMb2NhdGlvbnMiBlJvZ2VycwwLEgZDb3VydHMiBmNvdXJ0Mgw 
INFO     2012-09-10 21:25:19,192 views.py:228] weekday_key: ag1kZXZ-c2NoZWR1bGVyciELEgZDb3VydHMiBWNfa2V5DAsSBERheXMiBk1vbmRheQw 
INFO     2012-09-10 21:25:19,192 views.py:229] weekday: Monday 
INFO     2012-09-10 21:25:19,192 views.py:230] court: court2 
INFO     2012-09-10 21:25:19,195 views.py:235] reservations: 1 
```

我的模型如下。

```
class Courts(db.Model):    #parent is Locations, courtname is key_name
    location = db.ReferenceProperty(Locations)
    timezone = db.StringProperty()

class Days (db.Model):    #parent is Courts, name is key_name, day of week
    court = db.ReferenceProperty(Courts)
    startTime = db.ListProperty(int)
    endTime = db.ListProperty(int)

class Reservations(db.Model):    #parent is Days, hour, minute HH:MM is key_name
    weekday = db.ReferenceProperty(Days)
    day = db.IntegerProperty()
    nowweekday = db.IntegerProperty()
    name = db.StringProperty()
    hour = db.IntegerProperty()
    minute = db.IntegerProperty() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:17:54.040

您每次都使用*字符串* 计算键，而不是变量的值。`'c_key'``c_key`

但是，即使您解决了这个问题，它仍然无法正常工作，因为您需要的是法庭的 ID，而不是完整的密钥路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:10:16.487

```
 i=0
    for c in courts:
        court_id = names[i]
        i=i+1
        weekday_key = db.Key.from_path('Courts', c.key().name(), 'Days', weekday)
        reservation=Reservations.all()
        reservation.ancestor(weekday_key)
        nlimit=2*len(times)
        reservations = reservation.fetch(limit=nlimit) 
```

我不喜欢这个答案的一点`weekday_key`是，法庭上的所有 c 都是一样的。这似乎不对。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T12:50:30.723

> 如何在 (week)Days 的特定工作日在 Courts in a specific court in a specific court in a specific day in Days 构建所有预订查询？

您知道键的值，因此您可以手动组成一个键（可以这么说），然后将该键作为祖先进行查询。

例如：

```
key = ndb.Key(BlogPost, 12345)
qry = Comment.query(ancestor=key) 
```

但在这里你会使用类似的东西

```
key = ndb.key(Locations, "Place1", Courts, "Name_Of_Court") 
result = Reservations.query(ancestor=key) 
```

依此类推，因此您正在沿着链条向下工作，并使用您拥有的所有信息（即他们想要保留的球场）构建密钥。然后，您的祖先查询的结果将是那些将您传递的键作为其祖先的模型。

[https://developers.google.com/appengine/docs/python/ndb/queries#ancestor](https://developers.google.com/appengine/docs/python/ndb/queries#ancestor)

# android - setRequestedOrientation 不锁定方向

> ID：12360005
> 
> 赞同：0
> 
> 时间：2012-09-10T21:55:22.823
> 
> 标签：android

我正在尝试将活动锁定为横向模式，并让上层活动接收并使用方向更改。顶部活动是部分透明的，因此底部活动锁定并正确显示非常重要。我试图以编程方式设置它 with`setRequestedOrientation()`和 in the `AndroidManifest.xml`with`android:screenOrientation="landscape"`

当我使用清单锁定方向时，顶部活动也会锁定。当我添加`android:configChanges="orientation|screenSize|keyboardHidden"`顶部活动时，会改变方向，但底部活动也会改变。有时，在方向更改后，底部活动会完全空白（透明）。

这是在我的`AndroidManifest.xml`：

```
<application
    android:debuggable="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:theme="@style/AppTheme"
        android:screenOrientation="landscape"
        android:configChanges="orientation|screenSize|keyboardHidden"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <activity
        android:name=".TopActivity"
        android:screenOrientation="sensor"
        android:configChanges="orientation|screenSize|keyboardHidden"
        android:theme="@style/Theme.Transparent">
    </activity>
</application> 
```

`MainActivity`是底部活动。如何正确处理方向更改，以便按照我设置的方式锁定单个活动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T09:21:44.990

只需将 screenOrientation 添加到您不想在清单文件中的方向更改时旋转的活动，如下所示：

```
<activity android:name=".Activity" 
android:screenOrientation="portrait" /> 
```

所有其他活动将在方向更改时自动旋转。无需为其他活动提供 screenOrientation。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:03:22.283

1）禁用方向（即防止Android在用户翻转手机时重新启动您的活动），然后在您的AndroidManifest中指定“configChanges”（显然就像您已经在做的那样），然后根本不响应任何变化：

```
<activity android:name="MainActivity" android:configChanges="keyboardHidden|orientation|screenSize"> 
```

2）或者，假设您想强制您的应用程序进入“横向”模式。您可以指定“screenOrientation”而不是“configChanges”

```
<activity android:screenOrientation="landscape" ... > 
```

3）最后，如果你*想*处理方向变化，你需要 a）保存状态，然后 b）做你需要的任何处理（包括，也许，通知其他活动）：

*   [http://developer.android.com/guide/topics/resources/runtime-changes.html](http://developer.android.com/guide/topics/resources/runtime-changes.html)

# mysql - MySQL：过滤 JOINed 行

> ID：12360009
> 
> 赞同：0
> 
> 时间：2012-09-10T21:55:58.913
> 
> 标签：mysql, join, where-clause

好的，假设我有一个这样的连接查询：

```
SELECT users.*
FROM users
LEFT JOIN votes ON (users.id = votes.userid)
GROUP BY users.id
HAVING count(votes.id) >= 0
ORDER BY count(votes.id) LIMIT 0,30 
```

从 中获取行`users`，按`votes`与它们有关系的表中的行数排序。

我的问题：使用 WHERE 子句的正确方法是什么`WHERE votes.timestamp BETWEEN date_add(NOW(),INTERVAL -24 HOUR) AND NOW()`，`users`仅根据过去 24 小时内创建的与其有关系的行数进行排序？

能够做到这一点是有道理的，我只是不确定该放在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T21:58:33.493

将其添加到 ON 子句：

```
LEFT JOIN votes ON (users.id = votes.userid) AND (votes.timestamp BETWEEN date_add(NOW(),INTERVAL -24 HOUR) AND NOW()) 
```

如果将条件放在 WHERE 子句中，则可能会完全消除用户，从而否定 LEFT JOIN 的目的。ON 子句不会有这个问题。

# matlab - 二维矩阵数据的 MATLAB 加窗 FFT（图像）

> ID：12360010
> 
> 赞同：2
> 
> 时间：2012-09-10T21:56:04.057
> 
> 标签：matlab, image-processing, fft, windowed

数据：假设我有一个 2000 行 x 500 列的矩阵（图片）

我需要什么：通过上述数据的 10 列块计算 64 行的 FFT。换句话说，我想计算在整个数据矩阵中运行的 64X10 窗口的 F​​FT。FFT 结果用于计算标量值（例如峰值幅度频率），用于创建新的“FFT 值”图像。

现在，我需要最终的 FFT 图像与原始数据 (2000 X 500) 大小相同。

在 MATLAB 中完成此任务的最快方法是什么？我目前正在使用相对较慢的 for 循环。我还使用插值将最终图像调整为原始数据大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:13:36.390

正如@EitanT 指出的那样，您可以`blockproc`用于图像的批处理块`J.`但是您应该将函数句柄定义为

```
fun = @(block_struct) fft2(block_struct.data);
B = blockproc(J, [64 10], fun); 
```

对于`[2000 x 500]`矩阵，这将为您提供`[2000 x 500]`复数傅立叶值的输出，在局部支持（FFT 的输入大小）为 的子采样像素位置进行评估`[64 x 10]`。现在，要将这些值替换为单个值，例如峰值对数幅度，您可以进一步指定

```
fun = @(block_struct) max(max(log(abs(fft2(block_struct.data)))));
B = blockproc(J, [64 10], fun); 
```

然后输出是块补丁值的 [2000/64 x 500/10] 输出，您可以通过最近邻插值（或其他更平滑的版本）将其大小调整为所需的 [2000 x 500] 原始大小

```
C = imresize(B, [2000 500], 'nearest'); 
```

如果它会进一步帮助，我可以包含一个真实的图像示例。

**更新：**要获得重叠块，您可以通过设置重叠使用`'Bordersize'`选项，以便最终窗口大小仍为 [64, 10] 大小。例子：`blockproc``[V H]``[M + 2*V, N + 2*H]`

```
fun = @(block_struct) log(abs(fft2(block_struct.data)));
V = 16; H = 3; % overlap values
overlap = [V H]; 
M = 32; N = 4; % non-overlapping values
B1 = blockproc(J, [M N], fun, 'BorderSize', overlap); % final windows are 64 x 10 
```

但是，这将保持完整的傅立叶响应，而不是上面的单值版本`max(max())`。

另请参阅这篇文章，了解如何使用`blockproc:`[处理“真正大”的图像进行过滤：块处理](http://blogs.mathworks.com/steve/2011/08/16/dealing-with-really-big-images-block-processing/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:54:39.623

如果您想在较大矩阵中的各个不同块上应用相同的函数（在您的情况下为二维傅里叶变换），您可以使用该[`blkproc`](http://www.weizmann.ac.il/matlab/toolbox/images/blkproc.html)函数来执行此操作，该函数在较新的 MATLAB 版本中被替换为[`blockproc`](http://www.mathworks.com/help/toolbox/images/ref/blockproc.html).

但是，我推断您希望以`fft2`“滑动窗口”方式应用于重叠块。为此，您可以使用[`colfilt`](http://www.mathworks.com/help/images/ref/colfilt.html)该`'sliding'`选项。请注意，我们在每个块上应用的函数是 fft：

```
block_size = [64, 10];
temp_size = 5 * block_size;
col_func = @(x)cellfun(@(y)max(max(abs(fft2(y)))), num2cell(x, 1), 'Un', 0);
B = colfilt(A, block_size, 10 * block_size, 'sliding', col_func); 
```

这是如何运作的？`colfilt`通过将`A`每个“滑动”块重新排列到新临时矩阵的单独列中来处理矩阵，然后将`col_func`应用于这个新矩阵。`col_func`依次将每列恢复到原始块并`fft2`对其应用，返回每列的最大幅度值。

需要注意的重要事项：

1.  由于这个提到的临时矩阵包括所有可能的“滑动”块，内存可能是一个限制。因此，为了在计算中使用更少的内存，`colfilt`将原始矩阵`A`分解为 的子矩阵`temp_size`，并分别对每个子矩阵进行计算。当然，生成的矩阵 B 仍然是相同的。

2.  结果矩阵中的每个元素`B`都是根据相应的块邻域计算的。图像越大，需要处理的块就越多，因此计算时间将呈几何级数增加。我相信您必须等待一段时间，直到 MATLAB 处理完您的 2000×500 矩阵上的*所有*滑动窗口。

# .net - .NET 使用错误的 2.0 machine.config 而不是 4.0

> ID：12360011
> 
> 赞同：3
> 
> 时间：2012-09-10T21:56:14.123
> 
> 标签：.net, iis-7, machine.config

我在 IIS 7.0 Windows Server 2008 R1 上安装了一个 .NET Web 应用程序。我已经在服务器上安装了 .NET 4.0 并为 4.0 和集成管道配置了一个应用程序池。出于某种原因，我收到以下错误：

```
(500.19) The configuration section 'system.web.extensions' cannot be read because
  it is missing a section declaration. 
```

它似乎使用了`machine.config`来自 V2.0 .NET 的错误文件，而不是`machine.config`定义了`system.web.extensions`配置部分的文件。我通过用 V4.0 框架中的文件替换`machine.config`V2.0 框架中的文件来证明这一点，并且 Web 应用程序不再抛出`500.19`错误。我曾尝试卸载并重新安装 .NET 4.0 以及运行`aspnet_regiis -i`.

关于为什么要尝试使用 2.0 的任何想法`machine.config`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-13T13:03:04.813

不确定，这确实是原因/解决方案，但我尝试的最后一件事是（在 IIS 管理器中）：

1.  导航到右侧面板中的服务器（根节点）
2.  在功能列表中打开“ISAPI 和 CGI​​ 限制”
3.  有 2 项描述为 ASP.NET v4.0.30319，限制设置为拒绝
4.  将限制值设置为允许

这是我在问题消失之前尝试的最后一件事。

# validation - 我应该保护我的数据库免受无效数据的影响吗？

> ID：12360019
> 
> 赞同：1
> 
> 时间：2012-09-10T21:56:51.090
> 
> 标签：validation, database-design

我总是倾向于通过服务层“保护”我的持久层免受侵犯。但是，我开始怀疑它是否真的有必要。花时间使我的数据库健壮，建立关系和数据完整性，但实际上它从未真正发挥作用，这有什么意义呢？

例如，考虑一个`User`在字段上具有唯一约束的表`Email`。我自然会想在我的服务层中编写拦截器代码，以确保在尝试添加任何内容*之前*，正在添加的电子邮件尚未在数据库中。在过去，我从未真正看到它有什么问题，但是，随着我接触到越来越多的最佳实践/设计原则，我觉得这种方法不是很[干](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。

那么，始终确保进入持久层的数据确实“有效”是正确的，还是让无效数据进入数据库并处理错误更自然？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:31:22.807

请不要那样做。

在并发环境中，实现甚至“简单”的约束（例如键）显然不是微不足道的。例如，仅在第一步返回空结果时才在一个步骤中查询数据库并允许在另一个步骤中插入是不够的 - 如果并发事务插入了您尝试插入（并提交）的相同值怎么**办**第一步和第二步？您有可能导致重复数据的*竞争条件。*可能最简单的解决方案是使用全局锁来序列化事务，但随后可伸缩性就消失了……

对于键上的其他 INSERT / UPDATE / DELETE 操作组合以及其他类型的约束（例如外键甚至在某些情况下的 CHECK）也存在类似的考虑。

几十年来， DBMS 设计了*非常*聪明的方法，在此类情况下既正确又高效，同时允许您以**声明性**方式轻松定义约束，最大限度地减少出错的机会。所有访问同一数据库的应用程序都将自动受益于这些集中式约束。

如果您绝对必须选择哪一层代码不应该验证数据，那么数据库应该是您的*最后*选择。

> 那么，始终确保进入持久层的数据确实“有效”（服务层）是正确的，还是让无效数据进入数据库并处理错误更自然？

永远不要假设正确的数据，并且尽可能在数据库级别进行验证。

是否*还要*在上层代码中进行验证取决于具体情况，但在密钥违规的情况下，我会让数据库完成繁重的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:16:21.843

这样做的两个原因。可以从另一个应用程序访问数据库..

您可能在代码中犯了一个小错误，并将数据放入数据库中，因为您的服务层在假设这永远不会发生的情况下运行，如果您幸运的话，它会崩溃，最坏的情况是无声数据损坏。

当我在代码中出错时，我一直将数据库中的规则视为异常罕见的情况的支持。:)

要记住的是，如果您需要，您可以随时放松约束，在用户花费大量精力输入数据后收紧它们会带来更大的问题。

要真正警惕这个词，在 IT 中，它意味着比你希望的要早得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T00:48:09.460

尽管没有确定的答案，但我认为这是一个很好的问题。

首先，我非常支持在数据库中至少包含基本的验证，并让数据库做它擅长的事情。至少，这意味着外键，`NOT NULL`在适当的情况下，尽可能强类型字段（例如，不要将文本字段放在整数所属的位置），唯一约束等。让数据库处理并发也是最重要的（正如@Branko Dimitrijevic 指出的那样out) 并且事务原子性应该归数据库所有。

如果这是适度多余的，那就这样吧。太多的验证总比太少的好。

但是，我认为即使逻辑存在于数据库中，业务层也应该知道它正在执行的验证。

*   区分异常和验证错误可能更容易。在大多数语言中，失败的数据操作可能会表现为某种异常。大多数人（包括我）都认为在常规程序流程中使用异常是不好的，我认为电子邮件验证失败（例如）不是“异常”情况。

    把它带到一个更荒谬的水平，想象一下访问数据库只是为了确定用户是否填写了表单上的所有必填字段。

    换句话说，我宁愿调用一个方法`IsEmailValid()`并接收一个布尔值，也不愿尝试确定抛出的数据库错误是否意味着该电子邮件已被其他人使用。

    这种方法也可以执行得更好，并避免像跳过 ID 这样的烦恼，因为 INSERT 失败（从 SQL Server 的角度来看）。

    如果验证电子邮件的逻辑比简单的唯一约束更复杂，那么它很可能存在于可重用的存储过程中。

    最终，这个简单的唯一约束提供了最终保护，以防业务层出错。

*   某些验证根本不需要进行数据库调用即可成功，即使数据库可以轻松处理它。

*   一些验证比单独使用数据库构造/函数更复杂。

*   即使针对相同（完全有效）的数据，跨应用程序的业务规则也可能不同。

*   某些验证是如此重要或昂贵，以至于它应该在数据访问之前进行。

*   一些简单的约束，如字段类型/长度可以自动化（通过 ORM 运行的任何东西都可能具有一定程度的自动化）。

# rendering - 重心坐标纹理映射

> ID：12360023
> 
> 赞同：1
> 
> 时间：2012-09-10T21:57:06.067
> 
> 标签：rendering, coordinates, textures, rasterizing

我想用正确的视角映射纹理以进行 3D 渲染。我正在使用重心坐标来定位三角形面上的点。简单的仿射变换给了我那个标准的、奇怪的结果。这是我为纠正我的观点所做的，但它似乎只会使失真更大：

三个三角形顶点 v1 v2 v3

顶点坐标为 v_.x v_.y v_.z

纹理坐标是 v_.u v_.v

顶点对应的重心坐标为 b1 b2 b3

我正在尝试获取正确的纹理坐标 U 和 V

z=b1/v1.z + b2/v2.z + b3/v3.z

U=(b1*v1.u/v1.z + b2*v2.u/v2.z + b3*v3.u/v3.z) / z

V=(b1*v1.v/v1.z + b2*v2.v/v2.z + b3*v3.v/v3.z) / z

这应该工作不应该吗？为什么这不起作用？

编辑：此页面上的响应看起来很有用，但我不确定 w 坐标是什么。也许有人可以解释一下，这也可能解决我的问题。[http://www.gamedev.net/topic/593669-perspective-correct-barycentric-coordinates/](http://www.gamedev.net/topic/593669-perspective-correct-barycentric-coordinates/)

注意：我的标签一开始都是错的。现在已经解决了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T01:13:49.503

好的，我确实设法自己解决了这个问题。我除以屏幕空间中的 z 坐标。解决方案是除以齐次 w 坐标。

好吧，这需要一段时间才能弄清楚。

# spotify - 深度链接到 Spotify 应用程序

> ID：12360026
> 
> 赞同：1
> 
> 时间：2012-09-10T21:57:21.263
> 
> 标签：spotify

我无法在 Stack Overflow 和 Spotify 开发者网站上找到有关从外部资源（即网页）深度链接到 Spotify 应用程序的文档。您能否提供一个用于名为“mymusicapp”的应用程序的示例 URI？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T11:55:30.240

您的应用程序的 URI 将是：

`spotify:app:mymusicapp`

要进行深度链接，请继续：

`spotify:app:mymusicapp:artist:Coldplay`

如果你这样做，`ARGUMENTSCHANGED`事件将在`application`对象上触发。

```
var sp = getSpotifyApi();
var models = sp.require('$api/models');

models.application.observe(models.EVENT.ARGUMENTSCHANGED, function() {
    console.log(application.arguments);
}); 
```

有关详细信息，请参阅[应用程序类文档](https://developer.spotify.com/technologies/apps/docs/beta/2edfee4d46.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:29:12.623

Does this answer your question? [http://www.spotify.com/se/blog/archives/2008/01/14/linking-to-spotify/](http://www.spotify.com/se/blog/archives/2008/01/14/linking-to-spotify/)

There is also the Web api which can be useful for finding the links: [https://developer.spotify.com/technologies/web-api/](https://developer.spotify.com/technologies/web-api/)

# spring-mvc - Spring MVC 的 REST 框架可以接受查询字符串而不是 PathVariables 吗？

> ID：12360042
> 
> 赞同：28
> 
> 时间：2012-09-10T21:59:13.600
> 
> 标签：spring-mvc, query-string, spring-3, path-variables

在我读过的关于 Spring 3 对 Spring MVC 的 RESTful 添加的所有教程和文章中，我只见过一种用于通过 a 传递查询数据的方法`@PathVariable`，[如下所示](http://www.mkyong.com/spring-mvc/spring-3-mvc-and-json-example/)：

```
@RequestMapping(value="/shops/{name}", method=RequestMethod.GET)
public @ResponseBody Shop getShopInJSON(@PathVariable String name) {
    ...
} 
```

这会响应类似的东西`http://www.example.com/myservlet/shops/{name}`，可以评估为`http://www.example.com/myservlet/shops/thebestshoparound`.

我的问题是：是否可以设置一个 RESTful 接口来接收基于经典查询字符串的请求，例如`http://www.example.com/myservlet/shops?name=thebestshoparound`，而不是`PathVariables`？

这似乎是一个非常简单的问题，但我在网上的任何地方都找不到。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-10T22:25:44.670

Yes, use the annotation [`@RequestParam`](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-requestparam), here is an example:

```
public @ResponseBody Shop getShopInJSON(@PathVariable String name, @RequestParam(value="query", required=false) String query) {
    // do stuff
} 
```

# spring-mvc - 无法加载弹簧应用程序上下文

> ID：12360044
> 
> 赞同：2
> 
> 时间：2012-09-10T21:59:16.573
> 
> 标签：spring-mvc

我想加载 myapp-servlet.xml 作为我的 Web 应用程序上下文。我既没有定义spring contextLoaderListner也没有定义上下文参数，只定义了调度程序servlet。

```
 <display-name>myapp</display-name>
    <description/>
    <servlet>
        <servlet-name>myapp</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>myapp</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping> 
```

config 文件存在于 /WEB-INF/myapp-servlet.xml 中，我期待它被加载。但我收到以下异常

```
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanDefinitionStoreException: IOException parsing XML document from ServletContext resource [/WEB-INF/applicationContext.xml]; nested exception is java.io.FileNotFoundException: Could not open ServletContext resource [/WEB-INF/applicationContext.xml]
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:341)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302) 
```

我想知道为什么即使未定义 context-param 和 contextLoaderListener 也会查找默认的 applicationContext.xml 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:19:02.470

只需为您的 Spring 配置文件添加适当的上下文参数：

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/myapp-servlet.xml</param-value>
</context-param> 
```

Spring代码中可能有一个默认的配置文件位置......似乎是[UTSL](http://www.jargon.net/jargonfile/u/UTSL.html)的好机会......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-09T12:42:26.453

只需添加

```
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener> 
```

到您的 web.xml

# regex - 忽略 .htaccess (WordPress) 中的 mod_rewrite 指令

> ID：12360045
> 
> 赞同：1
> 
> 时间：2012-09-10T21:59:17.057
> 
> 标签：regex, wordpress, .htaccess, mod-rewrite

我们已经更改了 WordPress 博客的永久链接结构（我知道这是个坏主意）。我试图通过 WordPress 安装的基本文件夹的 .htaccess 中的 mod_rewrite 指令来避免来自外部链接的 404：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^\d\d\d\d\-\d\d\-\d\d_(.+)$ $1 [L]
# other rewrites
</IfModule> 
```

我尝试了一些变体，甚至测试了一页的完整 URL，但该行一直被忽略。但是 mod_rewrite 正在运行 - 其他一些重写，例如

```
RewriteRule ^seiten/abo\.php[5]?$   subscribe.php5 [R=301,L] 
```

完美地工作。我被困住了。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:15:24.867

`R=301`尝试通过在方括号中添加标志来强制执行 301 重定向：

```
RewriteRule ^\d\d\d\d\-\d\d\-\d\d_(.+)$ $1 [L,R=301] 
```

这将使其他重写不会（在第一次重写迭代之后）修改 URI。

# mysql - MYsql FULLTEXT 查询产生意外排名；为什么？

> ID：12360047
> 
> 赞同：3
> 
> 时间：2012-09-10T21:59:24.480
> 
> 标签：mysql, search, full-text-search, match

我正在尝试使用标签进行全文搜索，但它对我来说不能正常工作，请查看附件图片![在此处输入图像描述](../Images/ca9bd7f6cfcade812be51f579557d5e1.png)

查询是：

```
 SELECT *, 
         MATCH(tags) AGAINST ('tag3 tag6 tag4') AS score 
    FROM items
ORDER BY score DESC 
```

为什么分数没有在正确的顺序字段中排序？如果您检查第二行有我搜索过的所有标签，而第一个字段没有 tag3 关键字。

我的意思是 id 字段顺序应该是：5,1,2 .. etc 而不是 1,5,2..etc

我的错误在哪里？

然后我想先在标签字段中搜索然后如果没有结果我想在描述字段中搜索与 FULLTEXT 相同的关键字，因此如果标签不匹配，用户将在标签和描述中搜索，是否可以在同一个查询中或者我需要两个单独的查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:23:46.513

在这个文档[http://dev.mysql.com/doc/refman/5.0/en/fulltext-natural-language.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-natural-language.html)中它说“对于非常小的表格，单词分布不能充分反映它们的语义价值，并且这个模型可能有时会产生奇怪的结果。”

如果你的 items 表很小——例如一个示例表——你可能会遇到这个问题并得到一个“奇怪”的结果。

您可能希望尝试此查询`IN BOOLEAN MODE`以查看您的结果是否与您的预测相符。尝试这个。

```
 SELECT *, 
           MATCH(tags) AGAINST ('tag3 tag6 tag4' IN BOOLEAN MODE) AS score 
      FROM items
  ORDER BY score DESC 
```

布尔模式禁用词分布排名。请注意，您应该了解自然语言模式和布尔模式之间的区别，一旦您拥有一张合适大小的表格，就应该明智地选择使用哪一个。如果您正在搜索博客中包含的那种标签，布尔值可能是您的最佳选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:58:06.433

首先，这是您在我的 Windows7 机器上加载到 MySQL 5.5.12 中的示例数据

```
mysql> DROP DATABASE IF EXISTS lspuk;
Query OK, 1 row affected (0.00 sec)

mysql> CREATE DATABASE lspuk;
Query OK, 1 row affected (0.00 sec)

mysql> USE lspuk
Database changed
mysql> CREATE TABLE items
    -> (
    ->     id int not null auto_increment,
    ->     description VARCHAR(30),
    ->     tags VARCHAR(30),
    ->     primary key (id),
    ->     FULLTEXT tags_ftndx (tags)
    -> ) ENGINE=MyISAM;
Query OK, 0 rows affected (0.04 sec)

mysql> INSERT INTO items (description,tags) VALUES
    -> ('the first' ,'tag1 tag3 tag4'),
    -> ('the second','tag5 tag1 tag2'),
    -> ('the third' ,'tag5 tag1 tag9'),
    -> ('the fourth','tag5 tag6 tag2'),
    -> ('the fifth' ,'tag4 tag3 tag6'),
    -> ('the sixth' ,'tag2 tag3 tag6');
Query OK, 6 rows affected (0.00 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql> 
```

请查看标签填充在 MySQL 中发生的方式：

```
mysql> SELECT 'tag1',COUNT(1) tag_count FROM items WHERE tags LIKE '%tag1%' UNION
    -> SELECT 'tag2',COUNT(1) tag_count FROM items WHERE tags LIKE '%tag2%' UNION
    -> SELECT 'tag3',COUNT(1) tag_count FROM items WHERE tags LIKE '%tag3%' UNION
    -> SELECT 'tag4',COUNT(1) tag_count FROM items WHERE tags LIKE '%tag4%' UNION
    -> SELECT 'tag5',COUNT(1) tag_count FROM items WHERE tags LIKE '%tag5%' UNION
    -> SELECT 'tag6',COUNT(1) tag_count FROM items WHERE tags LIKE '%tag6%' UNION
    -> SELECT 'tag9',COUNT(1) tag_count FROM items WHERE tags LIKE '%tag9%';
+------+-----------+
| tag1 | tag_count |
+------+-----------+
| tag1 |         3 |
| tag2 |         3 |
| tag3 |         3 |
| tag4 |         2 |
| tag5 |         3 |
| tag6 |         3 |
| tag9 |         1 |
+------+-----------+
7 rows in set (0.00 sec)

mysql> 
```

仔细看，请注意以下事实：

1.  每行正好有 3 个标签
2.  请求标签的顺序与每个标签的数量似乎决定了分数

如果删除 tag4 并运行查询，则根本没有得分

```
mysql> SELECT *,MATCH(tags) AGAINST ('tag3 tag6') as score FROM items ORDER BY score DESC;
+----+-------------+----------------+-------+
| id | description | tags           | score |
+----+-------------+----------------+-------+
|  1 | the first   | tag1 tag3 tag4 |     0 |
|  2 | the second  | tag5 tag1 tag2 |     0 |
|  3 | the third   | tag5 tag1 tag9 |     0 |
|  4 | the fourth  | tag5 tag6 tag2 |     0 |
|  5 | the fifth   | tag4 tag3 tag6 |     0 |
|  6 | the sixth   | tag2 tag3 tag6 |     0 |
+----+-------------+----------------+-------+
6 rows in set (0.00 sec) 
```

评估方法似乎基于令牌字段的平均数量，并且特定顺序中特定值的存在和/或不存在会影响评分。如果您应用不同风格的评分和标签规范，请注意各种评分：

```
mysql> SELECT *,MATCH(tags) AGAINST ('tag3 tag6 tag4') as score FROM items ORDER BY score DESC;
+----+-------------+----------------+--------------------+
| id | description | tags           | score              |
+----+-------------+----------------+--------------------+
|  1 | the first   | tag1 tag3 tag4 | 0.6700310707092285 |
|  5 | the fifth   | tag4 tag3 tag6 | 0.6700310707092285 |
|  2 | the second  | tag5 tag1 tag2 |                  0 |
|  3 | the third   | tag5 tag1 tag9 |                  0 |
|  4 | the fourth  | tag5 tag6 tag2 |                  0 |
|  6 | the sixth   | tag2 tag3 tag6 |                  0 |
+----+-------------+----------------+--------------------+
6 rows in set (0.00 sec)

mysql> SELECT *,MATCH(tags) AGAINST ('tag3 tag6 tag4' IN BOOLEAN MODE) as score FROM items ORDER BY score DESC;
+----+-------------+----------------+-------+
| id | description | tags           | score |
+----+-------------+----------------+-------+
|  5 | the fifth   | tag4 tag3 tag6 |     3 |
|  1 | the first   | tag1 tag3 tag4 |     2 |
|  6 | the sixth   | tag2 tag3 tag6 |     2 |
|  4 | the fourth  | tag5 tag6 tag2 |     1 |
|  2 | the second  | tag5 tag1 tag2 |     0 |
|  3 | the third   | tag5 tag1 tag9 |     0 |
+----+-------------+----------------+-------+
6 rows in set (0.00 sec)

mysql> SELECT *,MATCH(tags) AGAINST ('+tag3 +tag6 +tag4' IN BOOLEAN MODE) as score FROM items ORDER BY score DESC;
+----+-------------+----------------+-------+
| id | description | tags           | score |
+----+-------------+----------------+-------+
|  5 | the fifth   | tag4 tag3 tag6 |     1 |
|  1 | the first   | tag1 tag3 tag4 |     0 |
|  2 | the second  | tag5 tag1 tag2 |     0 |
|  3 | the third   | tag5 tag1 tag9 |     0 |
|  4 | the fourth  | tag5 tag6 tag2 |     0 |
|  6 | the sixth   | tag2 tag3 tag6 |     0 |
+----+-------------+----------------+-------+
6 rows in set (0.00 sec)

mysql> 
```

解决方案似乎是评估 BOOLEAN MODE 分数，然后评估非 BOOLEAN MODE 分数，如下所示：

```
SELECT *,
MATCH(tags) AGAINST ('tag3 tag6 tag4') as score1,
MATCH(tags) AGAINST ('+tag3 +tag6 +tag4' IN BOOLEAN MODE) as score2
FROM items ORDER BY score2 DESC, score1 DESC; 
```

这是针对您的示例数据的结果：

```
mysql> SELECT *,
    -> MATCH(tags) AGAINST ('tag3 tag6 tag4') as score1,
    -> MATCH(tags) AGAINST ('+tag3 +tag6 +tag4' IN BOOLEAN MODE) as score2
    -> FROM items ORDER BY score2 DESC, score1 DESC;
+----+-------------+----------------+--------------------+--------+
| id | description | tags           | score1             | score2 |
+----+-------------+----------------+--------------------+--------+
|  5 | the fifth   | tag4 tag3 tag6 | 0.6700310707092285 |      1 |
|  1 | the first   | tag1 tag3 tag4 | 0.6700310707092285 |      0 |
|  2 | the second  | tag5 tag1 tag2 |                  0 |      0 |
|  3 | the third   | tag5 tag1 tag9 |                  0 |      0 |
|  4 | the fourth  | tag5 tag6 tag2 |                  0 |      0 |
|  6 | the sixth   | tag2 tag3 tag6 |                  0 |      0 |
+----+-------------+----------------+--------------------+--------+
6 rows in set (0.00 sec)

mysql> 
```

或者您可以尝试不使用加号

```
mysql> SELECT *,
    -> MATCH(tags) AGAINST ('tag3 tag6 tag4') as score1,
    -> MATCH(tags) AGAINST ('tag3 tag6 tag4' IN BOOLEAN MODE) as score2
    -> FROM items ORDER BY score2 DESC, score1 DESC;
+----+-------------+----------------+--------------------+--------+
| id | description | tags           | score1             | score2 |
+----+-------------+----------------+--------------------+--------+
|  5 | the fifth   | tag4 tag3 tag6 | 0.6700310707092285 |      3 |
|  1 | the first   | tag1 tag3 tag4 | 0.6700310707092285 |      2 |
|  6 | the sixth   | tag2 tag3 tag6 |                  0 |      2 |
|  4 | the fourth  | tag5 tag6 tag2 |                  0 |      1 |
|  2 | the second  | tag5 tag1 tag2 |                  0 |      0 |
|  3 | the third   | tag5 tag1 tag9 |                  0 |      0 |
+----+-------------+----------------+--------------------+--------+
6 rows in set (0.00 sec)

mysql> 
```

无论哪种方式，您都必须同时合并 BOOLEAN MODE 和 non-BOOLEAN 模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T22:09:00.860

**将order**修改为按**score DESC, id DESC 排序**。
假设**分数**值相同，则首先显示**5**的行。

# tomcat6 - 如何使用参数将 URL 重写为隐藏 URL

> ID：12360048
> 
> 赞同：1
> 
> 时间：2012-09-10T21:59:33.300
> 
> 标签：tomcat6, tuckey-urlrewrite-filter

我想使用 urlrewritefilter 在 URL 中包含客户名称和语言，并将它们作为参数传递给隐藏的 url。这样网站才会开定制。语言斜线之后的所有内容都应该传递给隐藏的 url

[http://www.x.com/customer1/en/](http://www.x.com/customer1/en/) 重写为隐藏的 url。客户不应看到应调用的以下 URL。

[http://www.x.com/myapp/](http://www.x.com/myapp/)

并添加以下参数 language=en customerID=3

我正在尝试此规则，但总是收到 404 http 状态错误

```
<rule match-type="regex">
 <from>^/customer1/en/([A-Za-z0-9\._/]+)$</from>
 <set name="customerID">3</set> 
 <set name="language">en</set>
<to type="forward">/myapp/$1</to>

</rule> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T12:05:41.183

我假设你有一个带有 context-root = "/" 的 webapp（没有跨上下文）。

如果没有完成，也许你应该激活日志，看看你的规则是否被调用和**匹配**。

您可以在过滤器配置中激活 urlrewritefilter 的日志（请参阅[http://urlrewritefilter.googlecode.com/svn/trunk/src/doc/manual/4.0/index.html#filterparams](http://urlrewritefilter.googlecode.com/svn/trunk/src/doc/manual/4.0/index.html#filterparams)）。

```
<filter>
  <filter-name>UrlRewriteFilter</filter-name>
  <filter-class>org.tuckey.web.filters.urlrewrite.UrlRewriteFilter</filter-class>
  <!-- sets up log level (will be logged to context log)
       can be: slf4j, TRACE, DEBUG, INFO (default), WARN, ERROR, FATAL,
       sysout:{level} (ie, sysout:DEBUG)
       if you are having trouble using normal levels use sysout:DEBUG
       (default WARN) -->
  <init-param>
    <param-name>logLevel</param-name>
    <param-value>DEBUG</param-value>
  </init-param>

</filter> 
```

您还必须添加日志记录的依赖项，例如 slf4j-api、slf4j-log4j12、log4j-1.2。

# asp.net - 带有表格布局的母版页：怎么做？

> ID：12360053
> 
> 赞同：0
> 
> 时间：2012-09-10T21:59:52.800
> 
> 标签：asp.net

更新：我找到了这个错误的原因，我无法在 masterpage 中创建表格布局，为什么？

> 错误 1 ​​当前上下文中不存在名称“txtUsername”

源代码：

```
<%@ Page Language="C#" AutoEventWireup="true" MasterPageFile="~/MasterPage.master" CodeFile="Login.aspx.cs" Inherits="login" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
    <form id="form1" runat="server">
    <div>
         Username: <asp:TextBox ID="TextBox1" runat="server" /><br>
        Password:<asp:TextBox ID="TextBox2" runat="server" /><br>
        <asp:Button ID="Button2" runat="server" onclick="Button1_Click" Text="Login" /><br>
        <asp:Label ID="Label1" runat="server" Text="Please login" />
    </div>
    </form>
</asp:Content> 
```

更新：补充源代码

这是后面的代码

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.Security;

public partial class login : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Button1_Click(object sender, EventArgs e)
    {
        if (FormsAuthentication.Authenticate(txtUsername.Text, txtPassword.Text))
        {
            lblStatus.Text = ("Welcome " + txtUsername.Text);
            FormsAuthentication.RedirectFromLoginPage(txtUsername.Text, true);
        }
        else
        {
            lblStatus.Text = "Invalid login!";
        }
    }
} 
```

这是母版页：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="MasterPage.master.cs" Inherits="MasterPage" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
 <style>
  body {
   margin:0;
   padding:0;
  }
</style>
    <asp:ContentPlaceHolder id="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>

        <asp:Table ID="Table1" width="100%" runat="server">
            <asp:TableRow ID="TableRow1" runat="server">
                <asp:TableCell ID="TableCell1" runat="server" BackColor="Blue" ColumnSpan="3">Header</asp:TableCell>
            </asp:TableRow>
            <asp:TableRow ID="TableRow2" runat="server">
                <asp:TableCell ID="TableCell2" runat="server" Width="160">
        <asp:ContentPlaceHolder id="ContentPlaceHolder1" runat="server">
        </asp:ContentPlaceHolder>
                </asp:TableCell>
                <asp:TableCell ID="TableCell3" runat="server" Width="800" BackColor="Red" >col2</asp:TableCell>
                <asp:TableCell ID="TableCell4" runat="server" Width="160" ColumnSpan="3">col3</asp:TableCell>
            </asp:TableRow>
            <asp:TableRow ID="TableRow3" runat="server">

                <asp:TableCell ID="TableCell5" runat="server">Footer</asp:TableCell>

            </asp:TableRow>
        </asp:Table>

</body>
</html> 
```

后面的代码

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class MasterPage : System.Web.UI.MasterPage
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

# trac - 从 Trac 下载项目？

> ID：12360058
> 
> 赞同：1
> 
> 时间：2012-09-10T22:00:18.423
> 
> 标签：trac

我想下载这个项目：[http ://trac.sitecore.net/AdvancedDatabaseCrawler/browser/Branches/v2/](http://trac.sitecore.net/AdvancedDatabaseCrawler/browser/Branches/v2/)

我应该如何下载整个项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:02:53.857

如果你[上升了几个级别](http://trac.sitecore.net/AdvancedDatabaseCrawler/)（我只是从 URL 中删除了部分直到它起作用），你会得到这个：

> 项目代码和文档已移至以下位置：
> 
> [​https://github.com/sitecorian/SitecoreSearchContrib](https://github.com/sitecorian/SitecoreSearchContrib)
> 
> 代码库将不再在这里维护。

因此，转到 GitHub 上的新 URL 并获取 git URL (git://github.com/sitecorian/SitecoreSearchContrib.git)，然后使用`git`：

```
git clone git://github.com/sitecorian/SitecoreSearchContrib.git 
```

或者将 URL 粘贴到[git 工具](https://code.google.com/p/tortoisegit/)中。

# ajax - 原型中的 json 值显示为未定义

> ID：12360061
> 
> 赞同：0
> 
> 时间：2012-09-10T22:00:26.250
> 
> 标签：ajax, json, perl, prototypejs

我在后端使用 perl 模块和 cgi 脚本，在前端使用prototypejs。我基本上是在使用 ajax 来调用在服务器上运行的 cgi 脚本，该脚本调用另一个文件将发送的数据放入 oracle db 中。

前端脚本是：

```
new Ajax.Request ('ajax-sr-update.cgi', {
    method: 'post',
    asynchronous: 'false',
    parameters: { 
        incident_id: incident_id,
        serial_number: $F('serial_number'),
        cmd: 'Add Serial'
    },
    onSuccess: function(transport) {
    var json = transport.responseJSON();
    if (json) {
        if (json.error_message) {
            //display error message
            } 
        else if (json.incident_id) {            
            //append the output in an alredy displated table
            var new_row = '<tr id="alt-row-'+json.line_number+'">';
                new_row += '<td id="serial_number-'+json.incident_id+'" style="border-left: solid 1px #eeeeee;">'+json.serial_number+'</td>';
                new_row += '<td id="product_number-'+json.incident_id+'">'+json.product_number+'</td>';
                new_row += '<td id="transaction_type-'+json.incident_id+'">'+json.transaction_type+'</td>';
                new_row += '<td id="failure_analysis_flag-'+json.incident_id+'">'+json.failure_analysis_flag+'</td>';
                new_row += '</tr>';
                Element.replace('add-loading-row', new_row);
            } else {
                //display a general error
            }
        } else {
            //display general message
        }

    },
    onFailure: function(data) {
        //display general error message
    }
}); 
```

我面临的问题是所有 json 返回值在表更新时显示为未定义，但是当我使用 console.log(json.line_number) 时，我可以看到原始值。过去 4 个小时一直在做这件事，我疯了！！

我检查过的事情：

1.  这些值正确地从数据库中取出，我在错误日志中生成了它们

2.  生成的值的数量也等于所需的值

3.  当我收到 json 返回时，这正是所需要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:32:30.967

Try console.log(new_row)? It may show you something you are missing.

# scala - 同一台机器上的 Scala 远程演员

> ID：12360063
> 
> 赞同：0
> 
> 时间：2012-09-10T22:00:35.527
> 
> 标签：scala, actor, remote-actors

我是 scala 的新手，正在尝试使用 Actor 模型。我已经在同一台机器上使用演员。现在，我想使用远程演员更进一步。由于我只有一个盒子可以玩，我计划启动一个 scala 进程，它将充当远程演员

remote.scala 看起来像

```
import scala.actors._
import scala.actors.remote._
import scala.actors.remote.RemoteActor._
import Actor._
import scala.math._
class remoteActor extends Actor{
  def act(){
    alive(9010)
    register('myActor, self)
    while (true)
    {
      println("Started Remote Actor")
        receive {
            case (caller :Actor, index :Int, length :Int) => 
            { // Do some stuff
            }
        }
    }
  }
}

object hello {
   def main(args: Array[String]): Unit = {
   println("Hello")
   val act = new remoteActor
   act.start
   }
} 
```

将使用这个远程actor的主程序

演员.scala

```
import scala.actors._
import scala.actors.remote._
import scala.actors.remote.RemoteActor._
import Actor._
class masterActor extends Actor{
  def act()
  {
    val myRemoteActor = select(Node("localhost", 9010), 'myActor)
    myRemoteActor ! (self,3,2)
  }

}
object hello {
  def main(args: Array[String]): Unit = {
    val sample = new masterActor
    sample.start
  }

} 
```

问题是当我使用 eclipse 运行 remote.scala 时（通过为 eclipse 安装 scala 插件）我得到了

你好

启动远程 Actor

在 Eclipse 控制台中打印的消息。但是当我在安装 scala 后从 Windows 命令行运行相同的程序时。

C:\Program Files (x86)\scala\bin>scala remote.scala

那么消息不会被打印出来。但是，如果我将 remote.scala 文件更改为仅包含 hello world 消息，（即 remote.scala 看起来像）

```
object hello {
   def main(args: Array[String]): Unit = {
   println("Hello")
  }
} 
```

然后 Hello 消息会打印在 Windows 命令提示符上。为什么 Windows 命令提示符在原始 remote.scala 的情况下不打印消息？

我想要的是启动这个 scala 进程，在该进程中注册了远程参与者并且该进程仍然存在。然后我想从另一个命令提示符启动 main.scala 程序，以便它向远程参与者发送消息以执行计算。如何确保远程参与者仍然存在并已注册并且进程正在运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:06:57.650

不要在您的消息中包含演员参考。接收模式应该是：

```
receive {
  case (index :Int, length :Int) => 
    { // Do some stuff
    }
} 
```

并且消息应该发送为`myRemoteActor ! (3,2)`

在接收者中，您可以只写`sender`来指代原始消息发送者。还有其他有用的功能，例如`reply(msg)`- 回复原始发件人`msg`

# cassandra - 使用 Asytanax 对复合列执行查询时出现 InvalidRequestException（为什么：比较器的字节数过多）

> ID：12360067
> 
> 赞同：3
> 
> 时间：2012-09-10T22:00:48.283
> 
> 标签：cassandra, astyanax

我正在尝试使用 Astyanax 1.0.9 从复合列中提取并得到“InvalidRequestException（为什么：比较器的字节太多）”

这是我的CF：

```
CREATE TABLE user_attributes (
user_id bigint,
attr_name ascii,
attr_value text,
last_sync_timestamp bigint,
last_sync_digest text,
PRIMARY KEY (user_id, attr_name)
); 
```

我可以用 CQL 读取数据：

```
select * from user_attributes where user_id = 1 and attr_name = 'mock'; 
```

这是我的复合列 POJO：

```
public static class UserAttributeCassandraTuple implements Comparable {
    public @Component(ordinal = 0) String attrName;
    public @Component(ordinal = 1) String attrValue;
    public @Component(ordinal = 2) long lastSyncTimeStamp;
    public @Component(ordinal = 3) String lastSyncDigest;

    public int compareTo(Object o) { /* impl omitted here */ }
    public int hashCode() { /* impl omitted here */ }
    public boolean equals(Object o) { /* impl omitted here */ }
} 
```

这是我的测试驱动程序：（键空间在 junit @before 中设置，适用于非复合列）

```
@Test
public void test_user_attributes() throws Exception {

    ColumnFamily<BigInteger, UserAttributeCassandraTuple> CF_USER_ATTR = new ColumnFamily<BigInteger, UserAttributeCassandraTuple>(
        "user_attributes", // Column Family Name
        BigIntegerSerializer.get(), // Key Serializer
        userAttributeSerializer); // Column Serializer

    // proto column for "mock"
    UserAttributeCassandraTuple mockColumn = new UserAttributeCassandraTuple();
    mockColumn.attrName = "mock";

    OperationResult<ColumnList<UserAttributeCassandraTuple>> result = keyspace.prepareQuery(CF_USER_ATTR)
    .getKey(BigInteger.valueOf(1))
    .withColumnSlice(mockColumn, mockColumn)
    .execute();
    ColumnList<UserAttributeCassandraTuple> columns = result.getResult();

    for (Column<UserAttributeCassandraTuple> c : columns) {
        System.out.println(c.getName() + "=" + c.getStringValue());
    }
} 
```

它编译得很好，但在执行（）期间失败：

```
com.netflix.astyanax.connectionpool.exceptions.BadRequestException: BadRequestException: [host=127.0.0.1(127.0.0.1):9160, latency=22(44), attempts=1] InvalidRequestException(why:Too many bytes for comparator)
at com.netflix.astyanax.thrift.ThriftConverter.ToConnectionPoolException(ThriftConverter.java:159)
at com.netflix.astyanax.thrift.AbstractOperationImpl.execute(AbstractOperationImpl.java:60)
at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1$2.execute(ThriftColumnFamilyQueryImpl.java:196)
at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1$2.execute(ThriftColumnFamilyQueryImpl.java:188)
at com.netflix.astyanax.thrift.ThriftSyncConnectionFactoryImpl$1.execute(ThriftSyncConnectionFactoryImpl.java:132)
at com.netflix.astyanax.connectionpool.impl.AbstractExecuteWithFailoverImpl.tryOperation(AbstractExecuteWithFailoverImpl.java:52)
at com.netflix.astyanax.connectionpool.impl.AbstractHostPartitionConnectionPool.executeWithFailover(AbstractHostPartitionConnectionPool.java:229)
at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1.execute(ThriftColumnFamilyQueryImpl.java:186)
at com.ebay.raptor.search.test.srp.domain.cassandra.CassandraTest.test_user_attributes(CassandraTest.java:118)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:611)
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:49)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: InvalidRequestException(why:Too many bytes for comparator)
at org.apache.cassandra.thrift.Cassandra$get_slice_result.read(Cassandra.java:7196)
at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:78)
at org.apache.cassandra.thrift.Cassandra$Client.recv_get_slice(Cassandra.java:543)
at org.apache.cassandra.thrift.Cassandra$Client.get_slice(Cassandra.java:527)
at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1$2.internalExecute(ThriftColumnFamilyQueryImpl.java:201)
at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1$2.internalExecute(ThriftColumnFamilyQueryImpl.java:188)
at com.netflix.astyanax.thrift.AbstractOperationImpl.execute(AbstractOperationImpl.java:55)
... 30 more 
```

我尝试用 Long 替换 BigInteger，但得到了同样的错误。

任何建议我做错了什么？

谢谢查克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T02:40:04.317

Astyanax 是一个基于 Thrift 的客户端，所以这是行不通的：（服务器端）Thrift 验证路径不支持 CQL。

我们在 1.2.0中[解决了这个问题，以获得更顺畅的升级路径；](http://issues.apache.org/jira/browse/CASSANDRA-4377)否则，您要么需要使用 CQL 客户端来访问 CQL 表，要么使用 CLI 为基于 Thrift 的客户端定义架构。

# php - 创建第二天上午 10 点的 Unix 时间戳

> ID：12360075
> 
> 赞同：1
> 
> 时间：2012-09-10T22:01:22.283
> 
> 标签：php

嗨，假设我的时间戳为“2005-10-16 13:05:41”。

我将如何创建一个变量，该变量将具有下一次从该初始点变为上午 10 点的 unixtime？

会是这样吗？

```
$timestamp = "2005-10-16 13:05:41";
$tenAMTime = strtotime("next 10am", $timestamp); 
```

我猜我可以用一些字符串来做到这一点？就像 PHP 文档中的“下周四”示例一样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T22:10:19.870

你差点吃...

```
$tomorrowAt10Am = strtotime('+1 day 10:00:00', $timestamp); 
```

编辑：这是基于您问题的标题，时间戳为**第二天**上午 10 点。如果您想在同一天上午 10 点之前的任何时间输出上午 10 点，那么您需要添加一些额外的逻辑，正如 thatidiotguy 建议的那样。

**编辑2：**

出于某种原因，如果将所有逻辑放在同一个 strtotime 方法中，它将无法工作，所以我做了一个简单的函数。您可以轻松地将其放在一行中，但我将其保留为 2 以使其更清晰：

```
$time1 = strtotime('-2 days 09:59:59');
$time2 = strtotime('-2 days 10:00:01');

function next_10am($time)
{
    $temp = strtotime('+1 day -10 hours', $time);
    return strtotime('10:00', $temp);
}

echo next_10am($time1); // Outputs: 2012-09-08 10:00:00
echo next_10am($time2); // Outputs: 2012-09-09 10:00:00 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T22:13:45.887

没有办法`strtotime`知道上午 10 点是否已经过去，所以我会这样做：

```
$timestamp = strtotime("2005-10-16 13:05:41");
// Get current hour and if it is > 10 add a day
if (date('G',$timestamp) >= 10) {
    $tenAMTime = strtotime("+1 day 10am", $timestamp);
}
else {
    $tenAMTime = strtotime("10am", $timestamp);
}
echo date('r',$tenAMTime); // Comment this out if you want 
```

# php - 在 PHP 中读取 XML 文件

> ID：12360076
> 
> 赞同：0
> 
> 时间：2012-09-10T22:01:30.877
> 
> 标签：php, simplexml

我正在导入一个具有金额字段的 XML 文件，`<amount>$10.00</amount>`但是当使用我从您的其他帖子中获得的代码读取它时，该值返回为`.00`.

使用：

```
$xml = simplexml_load_file("testInput.xml");
print_r($xml); 
```

结果：

```
[amount] => .00 
```

我在任何地方都找不到失败的原因......除非它与`$`值字段中的或句点有关，但我找不到任何关于保留字符的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:20:08.530

我试图复制您的结果，但无法...

我创建了一个名为 xml_test.php 的文件：

```
<?php
$xml = simplexml_load_file('test_input.xml');
print_r($xml);
?> 
```

然后构建 XML (test_input.xml)：

```
<?xml version="1.0" encoding="UTF-8"?>
<tests>
  <test>
    <amount>$10.00</amount>
  </test>
</tests> 
```

这是我在浏览器中的结果：

```
SimpleXMLElement Object ( [test] => SimpleXMLElement Object ( [amount] => $10.00 ) ) 
```

还有其他事情发生还是我错过了什么？也许你可以粘贴你的 XML ......

# php - 将数组从 javascript 格式化为 php 的更好方法，反之亦然？

> ID：12360078
> 
> 赞同：0
> 
> 时间：2012-09-10T22:01:31.907
> 
> 标签：php, javascript, codeigniter, xmlhttprequest

我正在创建一个页面，它将读取、写入和修改 mysql 数据库中的数据。我正在使用带有 codeigniter 的 php 来执行查询，但是用户将看到的页面我使用 javascript 供电，根据用户选择动态填充和更改数据。为此，我将大量数据从 php 到 javascript 函数来回传递，反之亦然，但我想知道是否有更好的格式化数据的方法。例如，这是一个使用 XMLHttpRequest 调用 php 函数并获取结果的 javascript 函数：

```
var myarray = new Array(2);
myarray[0] = document.getElementById("my_input").value;
myarray[1] = document.getElementById("my_select").value;
xmlhttp.open("POST", "my_url/my_function/"+myarray.join('|'), false);
xmlhttp.send();
document.getElementById("my_element").innerHTML=xmlhttp.responseText; 
```

我只是对传递给 php 函数的字符串执行explode() 并执行必要的查询。这似乎是 php 和 javascript 之间非常尴尬的交互。有没有更好或至少不同的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T22:11:02.347

**JSON**（JavaScript Object Notation）似乎是您正在寻找的。[您可以使用JSON.stringify](http://php.net/manual/en/function.json-decode.php)将几乎所有类型的 Javascript 变量转换为字符串，然后使用[json_decode](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify)恢复 php 中的原始结构，反之亦然使用[json_encode](http://php.net/manual/en/function.json-encode.php)和[JSON.parse](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse)。

看：

*   [JSON 上的 PHP 文档](http://php.net/manual/en/book.json.php)
*   [关于 JSON 的 MDN Javascript 文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON)

# visual-studio - Team Foundation Server 2012 示例文档和模板

> ID：12360083
> 
> 赞同：0
> 
> 时间：2012-09-10T22:02:40.067
> 
> 标签：visual-studio, tfs

据我了解，当您安装 SharePoint for TFS 时，TFS 的示例文档和模板将在团队网站上可用。是或否？

如果是这样，有没有办法在不安装 SharePoint 站点的情况下从 TFS 中提取这些文档？我需要这些模板，但目前不愿意安装和配置 SharePoint（等待 SharePoint 2013）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:11:36.933

C:\Program Files\Microsoft Team Foundation Server 11.0\Tools\Deploy\ProcessTemplateManagerFiles\1033\MsfAgile\Template.zip\Windows SharePoint Services\Samples and Templates

# iis - 如何更新 approot/bin 中的 DLL

> ID：12360089
> 
> 赞同：1
> 
> 时间：2012-09-10T22:02:55.837
> 
> 标签：iis, iis-7, azure

我目前正在运行一个 Azure 实例。问题是每次发布到登台需要 15 分钟以上。

我希望对我的代码进行小的更改，并通过远程桌面直接自己更新 VM 中的相应 DLL。但是，当我尝试将 DLL 复制粘贴到 approot/bin 文件夹中时，我收到一个错误，指出该文件当前正在使用中。

我已经在 IIS 管理器中停止了 IIS 实例。为了更新文件，我必须停止哪些其他服务/进程？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:46:37.227

要在 RDP 实例后回答您的问题，您可以终止角色主机进程 WaWebHost.exe 或 WaWorkerHost.exe，这将释放 DLL 保留，您可以复制 DLL。

杀死主机进程后，您有一个非常小的窗口可以将 DLL 复制到 bin 文件夹，以便准备好复制。可能是打开一个命令窗口并编写命令以将 DLL 从 Source 复制到 BIN，然后终止主机进程（WaWebHost.exe/WaIISHost.exe/WaWorkerhost.exe），然后启动复制 DLL 的命令。

我还认为您知道 DLL 不会持续存在，因此最终您需要像往常一样使用正确的 dll 更新软件包。

# c# - 如何以随机顺序和随机时间复制文件？

> ID：12360092
> 
> 赞同：0
> 
> 时间：2012-09-10T22:03:05.733
> 
> 标签：c#, .net, file-io

假设我有一个包含一些文件的文件夹，我想以随机顺序在每个随机秒内复制它们（假设在 1 秒到 1 小时之间随机 -> 这可能吗？）。我知道`File.Copy("from", "to");`你可以复制文件。但我需要这些随机的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T22:11:32.977

将文件读入列表并使用此随机播放

[随机化一个列表<T>](https://stackoverflow.com/questions/273313/randomize-a-listt-in-c-sharp)

然后在复制循环中，只需从 1000 到 3600000 随机休眠几毫秒

```
 System.IO.DirectoryInfo di = new System.IO.DirectoryInfo("dirctory path");

    List<System.IO.FileInfo> files = di.GetFiles().ToList();

    di = null;  // at this point I don't think you need to hold on to di

    // the static Directory will return string file names

    // randomize files using the code in the link 
    Random random = new Random();
    foreach (System.IO.FileInfo fi in files)
    {
        Thread.Sleep(random.Next(1000, 3600000));
        // should probaly test the fi is still valid
        fi.CopyTo("desitination");
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:16:59.047

这应该有效：

```
Random random = new Random();

int seconds = random.Next(3600) + 1;
List<FileInfo> files = new DirectoryInfo(Environment.CurrentDirectory).GetFiles().ToList();

Timer timer = new Timer() { Interval = seconds * 1000, AutoReset = true };
timer.Elapsed += (s, e) =>
    {
        files = files.OrderBy(f => random.NextDouble()).ToList();
        foreach(FileInfo file in files)
        {
            try { file.CopyTo("SomeDestination"); }
            catch { Console.WriteLine("Error copying file " + file); }
        }
    };
timer.Start(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T22:19:37.563

试试这个

```
 Timer t = new Timer();
        t.Interval = 1;
        t.Enabled = true;
        t.Tick += (s, o) =>
            {
                // interval between 1000ms(1s) & 1H
                t.Interval =1000*( new Random().Next(3600));
                string[] still_files ;
                do
                {
                    still_files = Directory.GetFiles(@"c:\source").Select(X => Path.GetFileName(X))
                    .Except(Directory.GetFiles(@"c:\destination").Select(X => Path.GetFileName(X)))
                    .ToArray();

                File.Copy(Path.Combine(@"c:\source", still_files[new Random().Next(still_files.Count()) - 1]), @"c:\destination");
                } while (still_files.Count> 0);
            }; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-10T22:30:06.100

有可能的。最天真的实现可能是这样的：

```
 static void Main(string[] args)
    {
        var files = Directory.GetFiles(@"c:\temp");
        var dest = @"c:\temp2";
        var rnd = new Random();
        int maxDelay = 60; // one minute

        var schedule = files.Select(f => new {FilePath = f, Delay = rnd.Next(maxDelay)}).ToList();
        schedule.Sort( (a,b) => a.Delay-b.Delay );

        var startTime = DateTime.Now;

        foreach (var s in schedule)
        {
            int curDelay = (int) (DateTime.Now - startTime).TotalSeconds;

            if (s.Delay <= curDelay) File.Copy(s.FilePath, Path.Combine(dest, Path.GetFileName(s.FilePath)));
            else {
                Thread.Sleep((s.Delay-curDelay)*1000);
                File.Copy(s.FilePath, Path.Combine(dest, Path.GetFileName(s.FilePath)));
            }
        }
    } 
```

所以 - 让我们创建一个文件列表。然后分配随机延迟。然后按延迟值对它们进行排序。然后通过列表复制文件，如果时间到了，或者休眠到下一次复制时间。

循环完成后，所有文件都在大约延迟时间被复制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-10T22:08:25.423

将所有文件名放入一个数组中，从数组中选择一个随机字符串，使用它来获取文件。

使用带有随机整数的计时器。如果您不知道如何使用随机数，那么只需`Random rand = new Random()`使用`rand.Next(10)`，这将返回一个介于 0 和 9 之间的随机整数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-10T22:10:41.703

查`System.Random`课。您可以使用它来生成 1 到 3600 之间的整数，3600 是一小时内的秒数。

要随机化文件名，请将它们放入一个数组中，然后按照`r.Next()`您`r`之前创建的`System.Random`.

# php - MAMP PHP Mac OSX 标头不工作

> ID：12360097
> 
> 赞同：0
> 
> 时间：2012-09-10T22:03:41.857
> 
> 标签：php, session, redirect, http-headers, dreamweaver

我已经在运行 10.6.8 的 mac 桌面上安装了 MAMP。我使用dreamweaver 作为IDE 来开发我的网站。我已经用 php 编写了我的网页，我可以在浏览器中预览它，我可以看到一切，所以服务器和那些东西可以工作。但在我的第一页我有这一行：

```
session_start();
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    if (!empty($_POST["Reg_type"])) {
        $_SESSION["regtype"]=$_POST["Reg_type"];
        header("Location: Page2.php");
        var_dump($_SERVER);
    }
} 
```

因此，一旦用户从表单中选择了一个单选按钮并单击提交，它就会将他们带到第二页。我**知道**它与标题一起进入循环，但由于某种原因它无法重定向到 page2。当我单击一个选项并单击提交时，它会再次转到第 1 页。我认为处理会话的标头重定向的 php.ini 文件可能存在问题，我不知道。我是mac的新手。有谁知道是什么问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T01:37:31.307

If Dreamweaver auto generated your code, check the line were the form tag is declared. If it looks like:

```
<form method="POST" action=""> 
```

then page1.php will reload, because it is calling itself. It would likely be cleaner to just change the form tag to

```
<form method="POST" action="page2.php"> 
```

and drop the whole if statement.

On submit page2.php will be loaded and that script/page will have $_POST['Reg_Type'] available for processing. Then if you need to assign $_POST['Reg_Type'] to a session variable, I would do it on page2.php.

And BTW, non of the above is exclusive to Mac.

# bash - 命令在交互式 shell 中有效，但在 shell 脚本中无效

> ID：12360098
> 
> 赞同：0
> 
> 时间：2012-09-10T22:03:51.193
> 
> 标签：bash, shell, debian, javac

我编写了一个脚本，它会为 javac 生成适当的参数来编译我的项目，以便更加精通 shell 脚本。

奇怪的是..脚本运行良好，但如果脚本使用这些参数运行 javac 它将不起作用，并且如果我在交互式 shell 中运行**完全相同的命令，它会起作用。**一切都以绝对路径输出，所以我在这里几乎不知所措。

示例目录结构：

```
src/File.java
src/File.png
src/dir/File2.java
jars/Library.jar 
```

预期输出：

```
build/File.class
build/File.png
build/dir/File2.class 
```

外壳脚本：

```
#! /bin/sh

cwd=$(pwd)

if [ -d "build" ]; then
    rm -rf $cwd/build/*
else
    mkdir $cwd/build
fi

find $cwd/src \( ! -path '*/.*' \) -type f ! -iname "*.java" | xargs -I{} cp --parents {} $cwd/build

cmd=$(echo javac -sourcepath $cwd/src -classpath $(find $cwd/jars -type f | awk '{ printf("\"%s\";", $0);}'  | awk '{ print substr($0, 0, length($0)); }') -d $cwd/build $(find $cwd/src \( ! -path '*/.*' \) -type f -iname "*.java"))

$cmd
echo $cmd 
```

命令输出：

```
javac -sourcepath /home/test/src -classpath "/home/test/jars/Library.jar" -d /home/test/build /home/test/src/File.java /home/test/src/dir/File2.java 
```

我的实际项目太大而无法在此处发布，但基本上会发生大量错误输出，好像类路径设置不正确（它们是库函数上的错误）。如果我从 echo 语句中复制命令，粘贴它，然后按回车，它可以完美运行。

我不明白。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T23:03:54.070

通常，只要您可以剪切-n-粘贴命令并使其工作，但外壳在运行该命令时不起作用，则在某处存在引用问题。与其试图弄清楚它是什么，不如让 shell 评估字符串。换句话说，而不是：

```
$cmd 
```

您希望 shell 评估 $cmd 就像您直接键入它一样：

```
eval $cmd 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:22:02.160

您在参数周围加上的引号按`-classpath`字面意思处理，因为它们是 的值的一部分`$cmd`。它们在`$cmd`展开后不会被删除，并且结果字符串被解析为命令行。就好像你在命令行输入了一样

```
$ javac -sourcepath /home/test/src -classpath \"/home/test/jars/Library.jar\" -d /home/test/build /home/test/src/File.java /home/test/src/dir/File2.java 
```

# c - 在 c 中将 char 作为参数传递

> ID：12360100
> 
> 赞同：4
> 
> 时间：2012-09-10T22:03:54.180
> 
> 标签：c, function, char, argument-passing

我只是想学习c，但我被卡住了。我正在尝试创建一个程序，该程序可以输入两个数字以及一个运算符并打印出答案。

该符号是反向波兰符号。也就是说，输入 2 1 + 应该给输出 3，输入 2 1 * 应该给输出 2。

稍后，我将扩展它，以便您可以在 rpn 中使用一些基于堆栈的东西输入更长的表达式，但现在让我们专注于只有两个操作数的情况。

这就是我所做的：

```
#include <stdio.h>

main()
{
    int number1;
    int number2;
    char operator;
    scanf("%d %d %c", &number1, &number2, &operator);
    printf("%d", calculate(number1, number2));
}

int calculate(int number1, int number2)
{
    return number1+number2;
} 
```

这在怀疑时有效，它会写出 number1 和 number2 的总和。但是，当我尝试将字符作为参数传递给函数计算时，就像这样

```
#include <stdio.h>

main()
{
    int number1;
    int number2;
    char operator;
    scanf("%d %d %c", &number1, &number2, &operator);
    printf("%d", calculate(number1, number2, operator));
}

int calculate(int number1, int number2, char operator)
{
    return number1+number2;
} 
```

我得到一个编译错误

```
rpn.c:12:5: error: conflicting types for ‘calculate’
rpn.c:13:1: note: an argument type that has a default promotion can’t match an empty parameter name list declaration
rpn.c:9:15: note: previous implicit declaration of ‘calculate’ was here 
```

不能在c中将char作为参数传递吗？我不明白为什么当它与 int 一起使用时它不起作用。我已经对此进行了很多搜索，但这些问题通常只涉及传递一个字符数组作为参数，而不是一个字符。

还是我做错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T22:07:16.177

把函数放在`calculate()`函数上面`main()`。编译器在调用它之前需要知道该函数。

或者，您可以通过在前面包含此行来在上面进行**前向声明**：`main``main()`

```
int calculate(int number1, int number2, char operator); 
```

它还有助于在编译器中打开警告。使用 GCC，您可以使用`-Wall`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T22:08:56.157

由于编译器在调用它之前*看不到*它的定义`calculate()`，它必须创建它的隐式声明并希望声明是正确的。事实证明不是。

要解决这个问题，要么将定义`calculate()`向上移动到`main()`调用它的位置，要么提供一个函数原型`calculate()`来*声明*函数在调用之前的样子， before `main()`：

```
int calculate(int number1, int number2, char operator); 
```

另请注意，如果您`operator`为变量使用标识符并使​​用 C++ 编译器编译您的代码，您将收到错误，因为`operator`它是 C++ 关键字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T22:16:06.447

您必须告诉编译器有关函数计算的**[原型](http://en.wikipedia.org/wiki/Function_prototype)**。

```
#include <stdio.h>

int calculate(int,int, char); // This is your prototype.
main()
{
    int number1;
    int number2;
    char operator;
    scanf("%d %d %c", &number1, &number2, &operator);
    printf("%d", calculate(number1, number2, operator));
}

int calculate(int number1, int number2, char operator)
{
    return number1+number2;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-10T22:09:21.610

当编译器看到您对 的调用时`calculate`，它还没有看到`calculate`.

对于初学者，在定义之前添加这一行`main`：

```
int calculate(int number1, int number2, char operator); 
```

（注意后面的分号`)`。）

如果没有该预先声明，则调用会在调用时`calculate`创建隐式声明；该隐式声明的工作方式不同（由于与参数提升和旧式函数声明有关的晦涩的历史原因；不要担心细节）。这是 1990 年版本的语言。从 1999 年 ISO C 标准开始，这种隐式函数声明甚至不存在。考虑调用您的编译器，使其符合 C99 标准（如果它支持，甚至是 C11）。您似乎在使用 gcc；如果是这样，`gcc -std=c99 -pedantic -Wall -Wextra`通常会给你更彻底的诊断。

其他一些改进：

`main()`应该是`int main(void)`。

格式字符串`"%d"`应该是`"%d\n"`，所以它打印一个完整的行。

（当然，您需要`calculate`注意 的值`operator`，但您所拥有的是一个好的开始。）

# zend-framework - 如何解决 Zend 的 CSRF 令牌无法验证的问题？

> ID：12360107
> 
> 赞同：1
> 
> 时间：2012-09-10T22:05:05.320
> 
> 标签：zend-framework, zend-form, csrf, zend-view

我在使用 Zend_Form 中的 Zend 的 CSRF 令牌时遇到了一些问题......

每次我提交表单时都会收到验证错误（与 CSRF 使用的“相同”）

在我的项目的早期，我对此没有任何问题，但当时我只是`echo $this->form;`在我的视图中使用`form`从控制器传递的位置。如果我回到这个'echo ..$form'，我可以解决这个问题，但我目前需要单独和一个一个地回显每个元素，因为我需要对每个元素及其呈现方式进行大量控制。我还需要最严格的安全措施，尤其是 CSRF 等基础知识。

这就是我使用表单元素呈现“登录”页面的方式，问题显然从这里开始，但在我有表单的任何地方都是相同的（无处不在:)）

.

```
<form id="login" enctype="application/x-www-form-urlencoded" method="<?php echo $form->getMethod() ?>" action="<?php echo $form->getAction() ?>">
<div class="login-section">
    <div class="form-container inputsLogin">
    <?php echo $form->agency->renderLabel() . $form->agency->renderViewHelper() ?>
    <br /><br />
    <?php  

    echo $form->username->renderLabel() . 
        $this->formText('username', '', array(
          'required' => True,
        )); 

    echo $form->password->renderLabel() . 
        $this->formPassword('password', '', array(
        'required' => True,
        ));

    echo $form->returnUrl->renderLabel() . $form->returnUrl->renderViewHelper();
    echo $form->csrf_token->renderLabel() . $form->csrf_token;

    ?>

    <div class="element">
          <?php echo $this->formSubmit('submit', 'Login') ?>
    </div>
      </div>
     </div>
   </form> 
```

我已经扩展 Zend_Form 以添加 CSRF 元素，但在项目的早期，我在每个表单类中都有它。我像 $form 中的任何其他元素一样抓取 CSRF 元素并将其回显到视图上。我怀疑我的 CSRF 生成了两次，但期待第一次，但我不能说。我已经尝试了几件事...回显标签，不回显标签，在我看来完全生成 csrf 元素，设置超时（或不设置）。

另外，为了清楚起见，这是我在表单类中声明我的 CSRF 元素的方式......

```
class Application_Form_Actform extends Zend_Form {

    function __construct() 
    { 
        parent::__construct();

        $this->addElement('hash', 'csrf_token', array(
                    'required' => 'true',
                    'salt' => get_class($this) . 'unique',
                    'ignore' => true,
                    'timeout' => 60000,
                    'errorMessages' => array(
                        'Identical' => 'Form may have timed out, or there is an attempt at forgery (Security issue). Please submit form again.'
                        ), 

                    )); 
    }

} 
```

更新：我想我得到了两个令牌，这是输出`var_dump($_SESSION);`：

```
array(2) { '__ZF' => array(1) { 'Zend_Form_Element_Hash_Application_Form_Loginunique_csrf_token' => array(2) { 'ENNH' => int(1) 'ENT' => int(1347378030) } } 

'Zend_Form_Element_Hash_Application_Form_Loginunique_csrf_token' => array(1) { 'hash' => string(32) "e3df9bf3a76cf53a804b337b8b513191" } } 
```

这是视图源中的标记：

```
<input type="hidden" name="csrf_token" value="a8727d61c656c64861181c7141d766a5" id="csrf_token" /> 
```

# ruby - 将数组转换为哈希键

> ID：12360108
> 
> 赞同：2
> 
> 时间：2012-09-10T22:05:06.037
> 
> 标签：ruby, arrays, hash

如何将 Array 转换为 Hash 值，`0`而无需`each`循环。

例如，给定这个数组：

```
[1, 2, 3, 4] 
```

我想得到这个哈希：

```
{"1"=>0, "2"=>0, "3"=>0, "4"=>0} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-10T22:08:23.733

标准方法是[Hash[...]](http://ruby-doc.org/core-1.9.3/Hash.html)：

```
Hash[xs.map { |x| [x.to_s, 0] }] 
```

或者`Enumerable#mash`，如果您碰巧使用 Facets。我想不出更简洁和声明性的东西：

```
xs.mash { |x| [x.to_s, 0] } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-10T22:06:11.763

```
array.inject({}) { | a, e | a[e.to_s] = 0; a } 
```

或者以更干净的方式（感谢[tokland](https://stackoverflow.com/users/188031/tokland)，请参阅评论中的讨论）

```
array.inject({}) { | a, e | a.update(e.to_s => 0) } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T22:12:21.107

我是一个简单的粉丝，而且我永远记不起究竟是多么疯狂的事情`#inject`或 Hash 构造函数参数是如何工作的。

```
array = [1, 2, 3, 4]
hash = {}

array.each do |obj|
  hash[obj.to_s] = 0
end

puts hash.inspect # {"1"=>0, "2"=>0, "3"=>0, "4"=>0} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T23:32:24.510

好的，实际上，我会使用`each_with_object`，但发布它是因为它更有趣。

```
ary = *1..4

hash = Hash[ary.zip ary.dup.fill 0]

hash # => {1=>0, 2=>0, 3=>0, 4=>0} 
```

# c++ - QTableView 中的 QPushButton

> ID：12360111
> 
> 赞同：2
> 
> 时间：2012-09-10T22:05:24.950
> 
> 标签：c++, qt, user-interface

我正在一个项目中尝试将 QPushButton 添加到 QTableView 中。我还想连接该按钮以打开数据库中的文档。到目前为止，我添加了按钮并为它编写了连接语句，但是当我单击按钮时什么也没发生。

这是我的代码

```
void MainWindow::DocumentTable()
{
tableview = new QTableView;
query = new QSqlQueryModel(this);
signalMapper = new QSignalMapper(this);

foreach(it,treeWidget->selectedItems())
{
    for (int col=0; col< it->columnCount(); ++col)
    {
        qDebug() << col << it->text(col);

QSqlQuery qry;
qry.prepare("select * from document where Folno=:Folno");
qry.bindValue(":Folno", it->text(col));
qry.exec();

query->setQuery(qry);
tableview->setModel(query);
tableview->setEditTriggers(QAbstractItemView::NoEditTriggers);

for (int i = 0; i< 1000; i++)
{
    button= new QPushButton("Open Document");
    tableview->setIndexWidget(tableview->model()->index(i, 0), button);
    signalMapper->setMapping(button, i);
}

connect(signalMapper, SIGNAL(mapped(int)), this, SLOT(imageFROMdatabase()));

tableview->show();

Docwidget= new QDockWidget(this);
Docwidget->setAllowedAreas(Qt::LeftDockWidgetArea | Qt::RightDockWidgetArea);

Docwidget->setWidget(tableview);
addDockWidget(Qt::RightDockWidgetArea,Docwidget);

Docwidget->show();

if(!query->submit())
  {
     QMessageBox::warning(0,"Error",query->lastError().text());

  }

 db.close();

}

         }
          } 
```

这是槽函数

```
 void MainWindow::imageFROMdatabase()
 {

QSqlQuery imageQuery;

imageQuery.prepare("SELECT * from doc_page where doc_no=:doc_no and f_number=:f_number");
imageQuery.bindValue(":doc_no", 1);
imageQuery.bindValue(":f_number",1);
imageQuery.exec();
imageQuery.next();

if( imageQuery.lastError().isValid())
    {
    QMessageBox::warning(0,"Error",imageQuery.lastError().text());

  //  QSqlDatabase::database().rollback();
     }
else
{
   // QByteArray ba1 = imageQuery.value(1).toByteArray();
    QPixmap pic;
    pic.loadFromData( ba);

scrollArea = new QScrollArea;
scrollArea->setBackgroundRole(QPalette::Dark);
scrollArea->setEnabled(true);

QString fileName = QFileDialog::getOpenFileName(this,"Open Image File",QDir::currentPath());
QImage image(fileName);

scene = new QGraphicsScene();
view = new QGraphicsView(scene);
item = new QGraphicsPixmapItem(QPixmap::fromImage(image));
scene->addItem(item);

     xwidget= new QDockWidget(this);
     xwidget->setAllowedAreas(Qt::LeftDockWidgetArea | Qt::RightDockWidgetArea);

     xwidget->setWidget(view);
     addDockWidget(Qt::RightDockWidgetArea,xwidget);
     xwidget->show();

     db.close();
     }
 } 
```

请告诉这些代码是否有任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:12:58.273

槽法与信号法不同。他们应该有完全相等的签名。qDebug() 应该已经为您生成了一些警告。仔细阅读输出。`imageFROMDatabase()`方法也应该接受一个整数作为其输入。信号不是真正的函数。它们用于触发与它们在签名中匹配的另一个功能。

```
connect(signalMapper, SIGNAL(mapped(int)), this, SLOT(imageFROMdatabase())); 
```

像这样改变它：

```
connect(signalMapper, SIGNAL(mapped(int)), this, SLOT(imageFROMdatabase(int))); 
```

还有：

```
void MainWindow::imageFROMdatabase( int x ) { ... } 
```

此外，如果信号和插槽不在线程中，请阅读手动[枚举 Qt::ConnectionType](http://doc.qt.nokia.com/4.7-snapshot/qt.html#ConnectionType-enum)

# database - 从生产数据库的开发副本中删除敏感数据（有这方面的宝石吗？）

> ID：12360114
> 
> 赞同：1
> 
> 时间：2012-09-10T22:05:39.750
> 
> 标签：database, ruby-on-rails-3, rubygems, backup, security

[我使用出色的备份 gem](https://github.com/meskyanichi/backup)对我的数据库进行夜间备份。我们还需要制作生产数据的副本，以便安装在登台、测试和开发数据库上。

但由于生产数据库包含敏感信息（电子邮件、姓名、加密密码等），我们希望在数据库离开生产服务器的安全世界之前对其进行清理。

在某种程度上，在我们的例子中，这可能就像用加密密码替换电子邮件`user+id@example.com`和替换加密密码等一样简单——简单地替换几列数据。此时，我们可以将数据库转储到一个文件中，开发人员可以使用该文件来获得一个真实的、工作的但不是真实的数据库副本。

这似乎是我们都应该做的事情。虽然从技术上讲并不是很难，但我讨厌做别人已经做得更好的事情:-) 有谁知道这样做的宝石？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:16:25.987

看起来这会做你正在寻找的东西：

[http://sunitparekh.github.io/data-anonymization/](http://sunitparekh.github.io/data-anonymization/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-28T10:12:53.293

**Fake** gem 是创建假数据的好选择：https [://github.com/faker-ruby/faker](https://github.com/faker-ruby/faker)

# facebook - “点赞”时，“点赞”按钮会移动并破坏设计

> ID：12360115
> 
> 赞同：0
> 
> 时间：2012-09-10T22:05:50.693
> 
> 标签：facebook, css, facebook-like

我正在开发这个网站的前端：http: [//oq.totaleclips.com](http://oq.totaleclips.com)，并从：[http ://dev-jon.c2mx-hrd.appspot.com 开发它](http://dev-jon.c2mx-hrd.appspot.com)

我已经移动了社交按钮以使 UI 更具吸引力，并减少在号召性用语图形中具有实际社交链接和图形表示的混淆。

但是，当我现在喜欢 facebook 上的页面时，facebook 按钮打破了社交按钮行的形成，并将点赞按钮放在其他按钮的下方。

我一直在尝试限制 Facebook 从 like.php 强制输入的跨度和生成的表单，但无济于事。

如何防止 Facebook Like 按钮移动和更改设计？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:59:47.647

估计插件有问题。width 属性似乎没有被承认或使用。暂时你可以使用这样的东西..

```
parent_element_identifier span {
  width: [original_width]px !important;
} 
```

这不是一个*好的*解决方法，但目前对我有用。

呃..也可以给它一些大数字的缓冲（取决于你从原始宽度开始的地方）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:16:03.330

不是最好的方法，但这应该有效：

```
.fb-like { display:inline-block !important; } 
```

# jqgrid - jqgrid 内联编辑只能运行一次

> ID：12360118
> 
> 赞同：0
> 
> 时间：2012-09-10T22:06:15.977
> 
> 标签：jqgrid

我的 jqgrid 内联编辑最初可以工作，但在第一次编辑后，编辑的行变得不可点击且呈灰色。我怎样才能做到这一点，以便我可以多次编辑同一行？

```
jQuery(document).ready(function(){
var lastsel;
var grid = jQuery("#list").jqGrid({

    url:'uploads/get_data.xml',
    datatype: 'xml',
    mtype: 'GET',
    colNames:['id', 'IRD', 'DLN', 'Start day', 'Start month', 'Start Year', 'End day', 'End month', 'End year', 'Sales', 'Zerorated', 'Debit adjust', 'Purchases', 'Credit adjust'],
    colModel:[
        {name: 'id', index: 'id', hidden: true, editable: false },
        {name: 'irdnum', index: 'irdnum', width: 150, editable: true, editrules:{ number:true },search:true, stype: 'text' },
        {name: 'dln', index: 'dln', width: 150, editable: true },
        {name: 'gstperiodstarting_day', index: 'gstperiodstarting_day', width: 20, editable: true, editrules:{ number:true } },
        {name: 'gstperiodstarting_month', index: 'gstperiodstarting_month', width: 20, editable: true, editrules:{ number:true } },
        {name: 'gstperiodstarting_year', index: 'gstperiodstarting_year', width: 50, editable: true, editrules:{ number:true } },
        {name: 'gstperiodending_day', index: 'gstperiodending_day', width: 20, editable: true, editrules:{ number:true } },
        {name: 'gstperiodending_month', index: 'gstperiodending_month', width: 20, editable: true, editrules:{ number:true } },
        {name: 'gstperiodending_year', index: 'gstperiodending_year', width: 50, editable: true, editrules:{ number:true } },
        {name: 'sales', index: 'sales', width:100, editable: true, editrules:{ number:true } },
        {name: 'zerorated', index: 'zerorated', width: 100, editable: true, editrules:{ number:true } },
        {name: 'debitadjust', index: 'debitadjust', width: 100, editable: true, editrules:{ number:true } },
        {name: 'purchases', index: 'purchases', width:100, editable: true, editrules:{ number:true } },
        {name: 'creditadjust', index: 'creditadjust', width: 100, editable: true, currency: true, editrules:{ currency:true } }
    ],
    pager: '#pager',
    rowNum:50,
    rowList:[50,100,200],
    sortname: 'created_at',
    sortorder: 'asc',
    viewrecords: true,
    height: 500,
    scrollrows: true,
    rownumbers: false,
    caption: 'Uploaded Data',
    editurl: 'uploads/set_data.xml',

    onSelectRow: function(id){
        if(id && id!==lastsel){
            $('#list').restoreRow(lastsel);
            $('#list').editRow(id,true);
            lastsel=id;

        }
    },
});
jQuery('#list').navGrid('#pager',
    {view:true, edit:false, del:true, search:false, refresh:true, add:true},{closeAfterAdd: true},{},{},{closeAfterSearch: true}, {}) 

jQuery('#list').navButtonAdd('#pager', {caption:"", title:"Toggle Search Toolbar", buttonicon :'ui-icon-search', onClickButton:function(){ grid[0].toggleToolbar() } })
grid.filterToolbar();grid[0].toggleToolbar() 
```

我在想也许我需要在编辑后重新加载整个网格？那会起作用吗？我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T09:07:20.543

我认为你应该写：

```
 onSelectRow: function(id){
       if(id && id!==lastSel){ 
          $('#list').restoreRow(lastSel); 
          lastSel=id; 
       }
       $('#list').editRow(id, true); 
   }, 
```

# gdb - gdb 宏确定被调试程序的架构

> ID：12360125
> 
> 赞同：5
> 
> 时间：2012-09-10T22:08:00.670
> 
> 标签：gdb

我需要编写一些需要在 32 位和 64 位架构之间有所不同的 gdb 宏。我正在寻找一种方法来确定在 gdb 中调试的可执行文件是 32 位还是 64 位。

信息目标包括有关文件类型的信息

例如文件类型 elf32-i386

但这嵌入在更长的输出中。

作为 gdb 宏的新手，我不知道如何处理该输出，或者找到另一种方法来获取它。

拜托，暂时没有python gdb。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T01:45:29.667

这是您的解决方案，而不是被python“污染”：

```
define set-program-arch
    set logging file tmp.gdb
    set logging overwrite on
    set logging redirect on
    set logging on
    set pagination off
    info target
    set pagination on
    set logging off
    set logging redirect off
    set logging overwrite off
    shell echo -n 'set $program_arch="' > tmp2.gdb
    shell grep 'file type' tmp.gdb | sed "s/\.$//g" | cut -d ' ' -f 4 | tr -d '\n' >> tmp2.gdb
    shell echo '"' >> tmp2.gdb
    source tmp2.gdb
    shell rm -f tmp2.tmp tmp.gdb
end 
```

这会将变量**program_arch**设置为被调试二进制文件的 ELF 类型（例如**elf64-x86-64**）。享受！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-19T19:07:20.730

**Python API 示例**

```
frame = gdb.selected_frame()
arch = frame.architecture()
print(arch.name()) 
```

示例输出：

*   `i386`对于 32 位 ELF
*   `i386:x86-64`对于 64 位 ELF

文档：[https ://sourceware.org/gdb/onlinedocs/gdb/Architectures-In-Python.html](https://sourceware.org/gdb/onlinedocs/gdb/Architectures-In-Python.html)

在 GDB 7.7.1、Ubuntu 14.04 AMD64 上测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T19:28:09.420

实际上，我发现了一个非常简单的答案

```
if sizeof(unitptr_t) == 4
  set $arch = 32
else 
  set $arch = 64
end 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-11T04:17:06.613

> 拜托，暂时没有python gdb。

我不相信没有python-gdb你可以实现你想要的，用它来实现你想要的也是*微不足道的。*所以考虑放宽你的限制。

# asp.net - SimpleMembership 与 ASP.NET MVC 4 中的自定义数据库架构

> ID：12360126
> 
> 赞同：37
> 
> 时间：2012-09-10T22:08:04.560
> 
> 标签：asp.net, .net, asp.net-membership, asp.net-mvc-4, simplemembership

我想启用 ASP.NET MVC 4 的 SimpleMembership API 以与我自己的数据库架构集成。我的数据库中有一个简单的表，`Users`用这些字段调用：

*   **ID**
*   **姓名**
*   **密码**
*   **电子邮件**
*   **已删除**

我已经配置了 SimpleMembership API 以使用我的数据库：

```
WebSecurity.InitializeDatabaseConnection("MyStuff", "Users", "Id", "Name", autoCreateTables: true); 
```

我也可以插入一个用户：

```
WebSecurity.CreateUserAndAccount(model.UserName, model.Password, 
                                 new 
                                 { 
                                        IsDeleted = false, 
                                        Email = "sampledata@gmail.com"                
                                 }); 
```

但是，密码字段（或它的哈希）没有插入到用户表中（当然），它插入到另一个名为的表中，该表`webpages_Membership`是通过调用创建的`InitializeDatabaseConnection`，包含很多我不需要的不必要信息。

此外，我还有其他自动创建的表，称为 pages_OAuthMembership、webpages_Roles 和 pages_UsersInRoles，我不需要这些表。

我已经尝试将表生成设置为 false：

```
WebSecurity.InitializeDatabaseConnection("MyStuff", "Users", "Id", "Name", autoCreateTables: false); 
```

但在这种情况下，CreateUserAndAccount 调用将引发异常，因为它不会找到 pages_Membership 表。

当我想使用 SimpleMembership API 时，看起来需要这些表。

我的问题是：当我只想要一个简单的`Users`表格时，在这种情况下我应该怎么做？

我是否必须自己编写整个成员资格处理和身份验证逻辑（哈希码生成等）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-11T07:04:36.967

我向产品团队提出了同样的问题。

SIMPLE 成员的设计目标是尽可能简单地开箱即用。

因此，就表格而言，实际上不可能进行定制。推荐的解决方法是，仍然使用 ASP.NET Membership (SqlMembershipProvider)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-16T18:16:42.227

定制是可能的。

您可以从[CodePlex 上的 aspnetwebstack 项目](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/e0115a823029#src/WebMatrix.WebData/SimpleMembershipProvider.cs)获取[SimpleMembershipProvider](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/e0115a823029#src/WebMatrix.WebData/SimpleMembershipProvider.cs)的源代码，因为这是在 DB Schema 和运行时环境之间发生映射的地方，您可以修改此代码以修改/替换架构、语句等以满足您的需要（无需很头疼，IMO。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-25T01:09:43.987

1 - 您需要启用迁移，最好使用 EntityFramework 5.`Enable-Migrations`在 NuGet 包管理器中使用。

2 - 移动你的

```
WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "EmailAddress", autoCreateTables: true); 
```

到 YourMvcApp/Migrations/Configuration.cs 类中的 Seed 方法

```
 protected override void Seed(UsersContext context)
    {
        WebSecurity.InitializeDatabaseConnection(
            "DefaultConnection",
            "UserProfile",
            "UserId",
            "UserName", autoCreateTables: true);

        if (!Roles.RoleExists("Administrator"))
            Roles.CreateRole("Administrator");

        if (!WebSecurity.UserExists("lelong37"))
            WebSecurity.CreateUserAndAccount(
                "lelong37",
                "password",
                new {Mobile = "+19725000000", IsSmsVerified = false});

        if (!Roles.GetRolesForUser("lelong37").Contains("Administrator"))
            Roles.AddUsersToRoles(new[] {"lelong37"}, new[] {"Administrator"});
    } 
```

现在 EF5 将负责创建您的 UserProfile 表，之后您将调用 WebSecurity.InitializeDatabaseConnection 以仅将 SimpleMembershipProvider 注册到已创建的 UserProfile 表中，同时告诉 SimpleMembershipProvider 哪一列是 UserId 和 UserName。我还展示了一个示例，说明如何在 Seed 方法中添加用户、角色并将两者与自定义 UserProfile 属性/字段（例如用户的手机（号码））相关联。

3 - 现在，当您从包管理器控制台运行 update-database 时，EF5 将为您的表提供所有自定义属性

有关其他参考资料，请参阅本文的源代码： **[http ://blog.longle.io/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom -用户属性/](http://blog.longle.io/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/)**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-16T20:27:05.823

您可以将 OAUth 与 ASP.NET 通用提供程序一起使用。通用提供程序是新版本的 sqlmembership 提供程序。这些基于 EF CodeFirst，还可以生成更清晰的数据库架构，请查看我的以下帖子了解更多详细信息 [http://blogs.msdn.com/b/pranav_rastogi/archive/2012/09/12/integrate-openauth- openid-with-your-existing-asp-net-application-using-universal-providers.aspx](http://blogs.msdn.com/b/pranav_rastogi/archive/2012/09/12/integrate-openauth-openid-with-your-existing-asp-net-application-using-universal-providers.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-16T19:08:05.757

这可能不适用于您的用例，但当然您可以非常轻松地将用户属性添加到 Simplemembership UserProfile 表，而不是创建另一个用户表

我建议使用现有的会员表来保留散列密码，而忽略不需要的字段。这样可以保持与 SimpleMembership 的兼容性，而不用大惊小怪。

SQLMembership 非常容易开箱即用。我已经在几个项目中对 SQLMembership 进行了广泛的自定义扩展，这并不难——但回想起来，我希望我没有。维修有点麻烦，

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-07-16T03:15:43.863

您可以通过扩展 MembershipProvider 创建自己的成员资格提供程序。有关详细信息，请参阅[.NET 4.0 中的自定义 MembershipProvider 。](https://stackoverflow.com/questions/5701673/custom-membershipprovider-in-net-4-0)使用这种方法，您只需要实现所需的方法。这应该有助于使事情变得更简单，并且不需要您添加不需要的表。

基本步骤（取自链接的 SO 答案）是：

1.  创建一个新的 Class 文件（如果您不使用多层系统，请在项目的 Models 文件夹中）让我们将其命名为 MyMembershipProvider.cs
2.  从 System.Web.Security.MembershipProvider 继承该类
3.  自动创建所需的方法（继承类中的句点+空格）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-07-18T02:30:16.587

您可以同时使用自定义用户表和 SimpleMembership 表。这种方法在过去对我很有效。

例如，在 AccountController 中的 Register 方法中，您可以通过将用户添加到您自己的 Users 表中来注册新用户。然后使用您添加到 Users 表中的用户 ID 将此用户添加到 SimpleMembership UserProfile 表中。

```
using (var context = new MyDatabaseEntities())
{
    User newUser = new User(){
      Name = model.Name,
      Email = model.Email,
      IsDeleted = false
    }

    // Add the user to your custom Users table
    context.Users.Add(newUser);
    context.SaveChanges();

    // Add this user to the SimpleMembership table using the same Id as the custom Users table
    WebSecurity.CreateUserAndAccount(newUser.Id.ToString(), model.Password);

    // Log the user in
    WebSecurity.Login(newUser.Id.ToString(), model.Password);
} 
```

# winapi - C++ Builder XE2：如何将字符串转换为 wchar_t*

> ID：12360127
> 
> 赞同：0
> 
> 时间：2012-09-10T22:08:10.050
> 
> 标签：winapi, vcl, widestring, c++builder-xe2, widechar

我有 SHBrowseForFolder 弹出并工作正常，但我想设置标题。我知道它必须是 wchar_t* 并且当我使用像 (wchar_t*)L"My Title" 这样的 const 时，标题显示正确。

但是如果我尝试使用字符串值，我只会得到第一个字母“M”，就像宽字符串再次转换为新的宽字符串一样，用 nul 填充每个字符。

```
Winapi::Shlobj::BROWSEINFO bi = {0};
bi.hwndOwner = Handle;
bi.ulFlags = BIF_NEWDIALOGSTYLE | BIF_EDITBOX | BIF_BROWSEFORCOMPUTER;
bi.lpszTitle = String("My Title").w_str(); // This only shows the 'M'
//bi.lpszTitle = (wchar_t*)"My Title";       // This shows the full string 'My Title'
LPITEMIDLIST pidl = SHBrowseForFolder((_browseinfoA*)&bi);

if ( pidl != 0 ) {

  // free memory used
  IMalloc *imalloc = 0;
  if (SUCCEEDED(SHGetMalloc(&imalloc))) {
    imalloc->Free(pidl);
    imalloc->Release();
  }
} 
```

[UnicodeString](http://docwiki.embarcadero.com/Libraries/en/System.UnicodeString.c_str)的所有转换函数的文档`c_str()`，`t_str()`都`w_str()`返回一个`wchar_t*`但声明显示`WideChar*`。

任何想法如何使此代码与字符串一起工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:19:05.170

您在调用时将`bi`变量类型转换为 a 的事实告诉我，您的项目选项中的“_TCHAR 映射到”选项设置为“char”而不是“wchar_t”。这意味着您的代码实际上是在调用而不是. 在 XE2中，无论 _TCHAR 设置如何， 结构总是映射到。是**Unicode**结构，而不是**ANSI**结构。因此，您强制将 Unicode 数据传递给 Ansi 函数。是的，有额外的填充会截断数据，因为您首先传递了错误的数据。`_browseinfoA*``SHBrowseForFolder()``SHBrowseForFolderA()``SHBrowseForFolderW()``Winapi::Shlobj::BROWSEINFO``::BROWSEINFOW``BROWSEINFOW`

 ****您需要停止使用类型转换。它们隐藏了编译器通常会抱怨的代码中的错误。C/C++ 是一种强类型语言。使用类型转换绕过编译器的数据类型验证。

要修复您的代码，您需要：

1) 使用`BROWSEINFO`全局命名空间中的泛型结构而不是`Winapi::Shlobj`命名空间，因此它匹配泛型`SHBrowseForFolder()`函数的编码：

```
::BROWSEINFO bi = {0}; 
bi.hwndOwner = Handle; 
bi.ulFlags = BIF_NEWDIALOGSTYLE | BIF_EDITBOX | BIF_BROWSEFORCOMPUTER; 
bi.lpszTitle = TEXT("My Title");
LPITEMIDLIST pidl = SHBrowseForFolder(&bi); 
if ( pidl != NULL ) { 
    // free memory used 
    CoTaskMemFree(pidl); 
} 
```

2) 继续使用`BROWSEINFO`命名`Winapi::Shlobj`空间，但`SHBrowseForFolderW()`直接调用以匹配 Unicode 编码：

```
Winapi::Shlobj::BROWSEINFO bi = {0};  
bi.hwndOwner = Handle;  
bi.ulFlags = BIF_NEWDIALOGSTYLE | BIF_EDITBOX | BIF_BROWSEFORCOMPUTER;  
bi.lpszTitle = L"My Title";
LPITEMIDLIST pidl = SHBrowseForFolderW(&bi);  
if ( pidl != NULL) {  
    // free memory used  
    CoTaskMemFree(pidl);  
} 
```

另请注意，无论您采用哪种方法，都不能使用临时`String`值作为 Title 值。将在调用`String`之前超出范围`SHBrowseForFolder()`，使`BROWSEINFO::lpszTitle`字段指向无效内存。如果你想使用 a`String`那么你需要为它使用一个局部变量，例如：

```
String sTitle = "My Title";
...
bi.lpszTitle = sTitle.c_str(); 
```****

# php - CURLOPT_RETURNTRANSFER 显示结果和文件下载大小

> ID：12360131
> 
> 赞同：1
> 
> 时间：2012-09-10T22:08:29.877
> 
> 标签：php, curl

我有几个关于 CURL 在我提出请求时如何传递内容的问题。

1.  当我使用 CURLOPT_RETURNTRANSFER => true 请求拉取页面时，我知道我可以通过回显`curl_exec()`结果来查看拉取的页面。我的问题是，当我回显结果时，页面内容是在查看时下载的图像，还是在发出请求后抓取所有内容并将其保存到缓冲区中直到我回显它？

2.  如何从页面中查看下载内容（html + images + css + js）的总大小。我尝试过使用`curl_getinfo()`，但它只显示 HTML 文件的大小。

3.  我认为 #2 可能会回答我对 #1 的问题，因为 curl 只能看到 HTML 文件，直到通过 echo 查看它。如果是这种情况，是否有一个 curl 命令可以抓取所有内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:21:28.027

1.  您将仅获得 HTML 文件
2.  您应该解析 HTML 并下载所有需要的文件，然后计算总大小
3.  见#2

# c++ - 是否可以组织 c++ 头文件和 cpp 文件？

> ID：12360139
> 
> 赞同：14
> 
> 时间：2012-09-10T22:09:36.620
> 
> 标签：c++, visual-studio-2012

我不确定我是否在问一个有效的问题，但这里有。

我有一个结构为的 c++ 解决方案

[文件夹] 头文件 -

... 200 个头文件 ..

[文件夹] 源文件 -

... 200 个原始文件 ..

... 休息

是否可以像在 C# 项目中那样按文件夹组织头文件和源文件？我面临的问题是，随着项目的增长，浏览一大堆文件会变得很烦人，如果它们是按功能组织的（例如 c# 项目中的文件夹和命名空间），导航会容易得多.

是否有某种标准会受到各种编译器的支持，而不仅仅是 Visual Studio？

例子：

[文件夹] 头文件 -

*   [文件夹] X 域
    *   100个头文件
*   [文件夹] Y 域
    *   100个头文件

[文件夹] 源文件 -

*   [文件夹] X 域
    *   100 个 cpp 文件
*   [文件夹] Y 域
    *   100 个 cpp 文件

... 休息

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-09-10T22:16:25.670

头文件/源文件不是 Visual Studio 强加的要求。这只是默认布局，它是虚拟的，而不是物理的。如果您在解决方案资源管理器中单击“显示所有文件”，它将显示硬盘驱动器上的文件夹树 - 您可以根据需要对其进行操作。这是唯一合理的配置，我不知道为什么默认是这样的。另外，自然地，他们为 C# 项目而不是 C++ 修复了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:24:59.163

我不知道标准，但您可以将标头（和源）文件放在您喜欢的任何文件夹结构中。

您需要确保包含文件由相对路径引用或将文件夹添加到项目搜索路径。

# html - 溢出自动和可见的混合行为

> ID：12360141
> 
> 赞同：2
> 
> 时间：2012-09-10T22:10:00.127
> 
> 标签：html, css

我有 HTML 结构

```
<div class="PapaDiv">
  <input type="checkbox"/>
  <label></label>
  <div class="ChildDiv">
    <input type="radio"/><label></label>
    <input type="radio"/><label></label>
    <input type="radio"/><label></label>
  </div>
  <br/>
</div> 
```

该动物正在根据数据在服务器端动态构建。这有点像嵌套菜单。当用户将鼠标悬停在带有标签的复选框上时，ChildDiv 会显示在它旁边。PapaDiv`overflow-y:auto`定义了最大高度。

所以，如果有很多复选框，PapaDiv 会得到一个垂直滚动条。这是想要的行为。现在，如果您将鼠标悬停在底部复选框上，它的 ChildDiv 也会显示在 PapaDiv ( `overflow-y:auto`) 中。企业希望它显示在我必须设置的 PapaDiv 之上`overflow-y:visible`。

这就是这里的困境。我需要两种行为的混合。我需要 ChildDiv 显示在 PapaDiv 之外，同时如果有很多其他孩子在里面显示滚动条。有针对这个的解决方法吗？

编辑：我认为这不会有太大帮助，但这里是 CSS：

```
.ChildDiv{
    background-color: #EDF1F9;
    border: 1px solid #557AB5;
    display: none;
    max-height: 200px;
    overflow-y: auto;
    padding: 10px;
    position: absolute;
}

.PapaDiv{
    background-color: #FFFFFF;
    border: 1px solid #557AB5;
    box-shadow: 3px 3px 7px rgba(0, 0, 0, 0.3);
    left: 0;
    max-height: 300px;
    overflow-y: auto;
    padding: 0.5em;
    position: absolute;
    top: 0;
    width: 98%;
    z-index: 501;
}

PapaDiv's parent div {
    position: relative;
    width: 100%;
} 
```

编辑：没有出现的原因是因为 CSS 中有`display:none`'s 。涉及到 JavaScript。对于这些元素，鼠标悬停在复选框或其标签上时，ChildDiv 会显示 ( `jQuery $('.ChildDiv').show()`)。

从 ChildDiv 或 PapaDiv 鼠标移出时：`$('.ChildDiv').hide()`. 此外，还有一个简单的计算来设置 ChildDiv 的“top”和“left”属性，因此它显示在其复选框旁边。ChildDiv 已经用`position:absolute;`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:36:30.730

在 Dimskiy 之前我也遇到过同样的问题。我试图创建一个放大镜，当鼠标悬停在图像上方时，它会出现在图像上方。我发现父 div 在这种情况下`#PapaDiv`必须相对定位，而子 div 在这种情况下`#ChildDiv`是绝对定位的。

我看到父`#PapaDiv`元素的相对位置，但如果我记得，我必须相对定位子元素的直接父元素。

尝试这个：

```
#PapaDiv {
    position: relative;
}
#ChildDiv {
    position: absolute;
} 
```

当然，您也可以在其中添加所有其他附加 CSS。

下面的链接是我用来帮助我的帖子：
[如何将一个 div 覆盖在另一个 div 上](https://stackoverflow.com/questions/2941189/how-to-overlay-one-div-over-another-div)

# sql - TSQL Count 函数和不同的缺失 NULL 值

> ID：12360143
> 
> 赞同：2
> 
> 时间：2012-09-10T22:10:11.110
> 
> 标签：sql, database, sql-server-2008, tsql, count

根据 MSDN，TSQL COUNT(*) 函数在结果中包含任何 NULL 值，除非还使用 DISTINCT（来源：http: [//msdn.microsoft.com/en-us/library/ms175997.aspx](http://msdn.microsoft.com/en-us/library/ms175997.aspx)）

但是，在我的查询中，NULL 值被忽略了。为了测试这一点，我创建了一个小表并在其中填充了一些数据：

```
CREATE TABLE tbl (colA varchar(1), colB varchar(10))
INSERT tbl VALUES
('Y', 'test1'),
('Y', 'test2'),
(null, 'test3'),
(null, 'test4'),
('N', 'test5') 
```

然后我对其运行了以下 2 个查询：

```
SELECT count(*) FROM tbl
WHERE colA <> 'N' 
```

和

```
SELECT DISTINCT colA FROM tbl
WHERE colA <> 'N' 
```

两个结果都忽略了 NULL 值。我分别得到 2 和 'Y' 作为结果。我不知道为什么会这样。有人可以告诉我吗？

在 SQL Fiddle 中模拟的结果：[http ://sqlfiddle.com/#!3/8f00b/9](http://sqlfiddle.com/#!3/8f00b/9)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T22:14:36.680

空值很奇怪。

`null <> 'N'`评估为`false`。
`null = 'N'`也评估为`false`。

您需要明确处理 null ：

```
SELECT count(*) FROM tbl
WHERE (colA <> 'N') or (colA is null) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T22:15:02.453

除 IS NULL 之外的任何与 Null 的比较都将失败。所以 Null = 'N' 和 Null <> 'N' 都返回 false。

如果你想包含空值，你需要说

```
WHERE colA <> 'N' or colA IS NULL 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T22:15:44.940

因为`NULL`未知，所以服务器不知道它的值是什么。但尝试使用`IS NULL`

```
SELECT count(*) 
FROM tbl
WHERE colA <> 'N' or  
      colA IS NULL 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!3/8f00b/16)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-10T23:23:55.063

```
declare @tbl as Table (colA varchar(1), colB varchar(10)) 
insert @tbl values 
  ('Y', 'test1'), ('Y', 'test2'), (null, 'test3'), (null, 'test4'), ('N', 'test5')
select * from @tbl

select
  count(*) as 'Rows', -- All rows.
  count(colA) as [colA Values], -- Rows where   colA   is not NULL.
  count(colB) as [colB Values],  -- Rows where   colB   is not NULL.
  count(distinct colA) as [Distinct colA], -- Number of distinct values in   colA .
  count(distinct colB) as [Distinct colB], -- Number of distinct values in   colB .
  -- NULL never equals anything, including another NULL.
  case when 42 = NULL then 'Yes' else 'Unknown' end as [Answer Is NULL?],
  case when NULL = NULL then 'Yes' else 'Unknown' end as [NULL = NULL],
  -- Use   is NULL   to explicitly check for   NULL .
  case when NULL is NULL then 'Yes' else 'Unknown' end as [NULL is NULL]
  from @tbl 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-02T13:34:04.723

```
 select count(IsNull(colA,'')) as colA, count(colB) as colB from @tbl 
```

也应该做的伎俩

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-11T11:34:27.757

您还可以使用`ISNULL`功能：

```
SELECT count(*) 
FROM tbl
WHERE isnull(colA,'F') <> 'N' 
```

MSDN： http: [//msdn.microsoft.com/en-us/library/aa933210 (v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa933210(v=sql.80).aspx)

# 3d - 在 Unity 中使用装配好的 3d 模型制作动态动画

> ID：12360147
> 
> 赞同：1
> 
> 时间：2012-09-10T22:10:32.087
> 
> 标签：3d, unity3d, 3dsmax

我有一个要在 Unity 中使用的 3ds 装配模型。我不想在 3ds 中制作任何动画，因为所有动画都是动态的。我只想在 Unity 中访问模型的骨骼/关节，这样我就可以在运行时使用 Unity 中的代码对其进行转换。

我听说我应该使用 fbx 格式导入模型，我这样做了，但我在 Unity 中看不到骨骼或关节。此外，根据研究，我需要在从 3ds 导出之前“烘焙动画”，但我不想在 3ds 中制作动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T09:00:17.850

导入 FBX 模型并将其拖入场景项目后，层次结构视图应如下所示![显示骨架的项目和层次结构视图](../Images/f529ccf84c011b8f9401c72195f41063.png)。

在建模软件中定义的所有骨骼都显示为根骨骼下的 GameObject 层次结构，并且可以通过*Find或*[Transform](http://docs.unity3d.com/Documentation/ScriptReference/Transform.html)中定义的其他方法访问，例如：

```
Transform hipsTransform = rootGameObject.transform.FindChild ("Armature/Hips"); 
```

但总的来说，我建议在建模软件中制作动画。如果您需要非常动态的行为，请尝试将它们分成短条并在运行时组合它们。我目前正在写一篇关于这种技术的博客文章，但它还没有准备好。

# ruby-on-rails - Rails link_to 或 button_to 使用参数发布请求

> ID：12360148
> 
> 赞同：30
> 
> 时间：2012-09-10T22:10:33.223
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个安静的（脚手架生成的）控制器和投票模型，我只是想在视图中添加一个字段，单击该字段将为给定的汽车创建一个新的投票。它需要是一个 POST，我应该在 Rails 中这样做的方式是什么？

```
<% @cars.each do |car| %>
  <tr>
    <td><%= button_to '+', {:controller => "votes", :action => "create"}, :car_id => car.id, :user_id=> session[:user_id] , :method=>:post  %></td>
    <td><%= car.votes.count %></td>
    <td><%= car.name %></td>
    <td><%= car.code %></td>
    <td><%= car.album %></td>
<% end %> 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-10T23:02:42.733

```
<td><%= button_to '+', {:controller => "votes", :action => "create", :car_id => car.id, :user_id=> session[:user_id]} , :method=>:post  %></td> 
```

这将使 params[:car_id] 和 params[:user_id] 在 VotesController 创建操作中可用。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2016-10-10T06:42:26.607

Rails 5 + haml，例如：

```
= button_to "smth", some_path, method: :get, params: { start_point: 3.month.ago } 
```

关键是使用**params**键，然后在控制器中您将能够通过**@some_var = params[:start_point]获得价值**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-03T13:20:57.950

```
<td><%= button_to '+', {:controller => "votes", :action => "create", :car_id => car.id, :user_id=> session[:user_id]} , {:method=>:post}  %></td> 
```

Erez 是对的——在这种情况下，第一个散列是“URL 参数”散列，它控制按钮发送请求的 URL。第二个散列是“HTML 参数”散列，它控制按钮的外观，以及提交方法（通过在生成的 HTML 中添加隐藏字段）。

这里令人困惑的是，URL 参数要求您以控制器为中心的方式指定控制器和操作，但随后要求您传递 URL 的 id，这更加以 URL 为中心。这种组合让我很长一段时间都失望了。顺便说一下，您可以在 URL 参数哈希中添加您喜欢的任何其他参数 - 用作控制器中其他方法的参数，以采取更高级的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-21T11:57:23.067

您也可以像这样将参数作为参数传递给路径助手

```
<%= button_to '+', votes_path(car_id: card.id), method: 'post'  %> 
```

您可以从控制器中获取会话 id，或者如果需要，仍将其传递给路径助手。

# jquery - 锚点和淡入效果

> ID：12360159
> 
> 赞同：0
> 
> 时间：2012-09-10T22:11:38.677
> 
> 标签：jquery

我的课程页面上有一些`<a>`标签`myLink`。当加载 DOM 时，我想`hide`使用`fadeIn`效果。但是，使用下面的代码我没有看到任何动画，这是怎么回事？

```
$(document).ready(function() {

    $('a.myLink').css('display','block')
                 .html('&nbsp;')
                 .hide()
                 .fadeIn('slow',function() { $(this).html('lorem'); });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:19:20.857

像这样：**演示** [http://jsfiddle.net/E9uht/1/](http://jsfiddle.net/E9uht/1/) **或** [http://jsfiddle.net/E9uht/](http://jsfiddle.net/E9uht/)

希望它适合原因`:)`如果我错过了什么，请让我知道！

**代码**

```
$(document).ready(function() {

    $('a.myLink').css('display', 'block')
                 .html('&nbsp;') //<=if you comment me then I will show full link.:)
                 .hide('slow',function() {
                    $(this).fadeIn('slow', function() {
                        $(this).html('lorem');
                    });
    })

});​ 
```

# sql - 使用 CONNECT BY 在分层查询的每个级别获取计数/总数

> ID：12360160
> 
> 赞同：7
> 
> 时间：2012-09-10T22:11:45.200
> 
> 标签：sql, oracle

我玩得很开心。我正在尝试针对具有递归关系（分层）的表编写查询（使用 Oracle），并获取存储在树中每个节点及其下方的另一个表中的记录总数。另一个表只有与叶节点关联的记录。但是，我想获得树中每个节点及其下方的总数。例如，假设我有两张桌子。DIRS 包含目录名称和标识目录结构的递归关系，而 FILES 包含文件信息，其中 DIRS 的外键指示文件所在的目录：

```
DIRS
====
DIR_ID 
PARENT_DIR_ID
DIR_NAME

FILES
=====
FILE_ID
FILE_NAME
DIR_ID
FILE_SIZE 
```

如果 DIRS 包含：

```
DIR_ID   PARENT_DIR_ID   DIR_NAME
======   =============   ========
1                        ROOT
2        1               DIR1_1
3        1               DIR1_2
4        2               DIR2_1
5        2               DIR2_2 
```

和 FILES 包含

```
FILE_ID   FILE_NAME   DIR_ID   FILE_SIZE
=======   =========   ======   =========
1         test1.txt   5        100
2         test2.txt   5        200
3         test5.txt   5         50 
4         test3.txt   3        300
5         test4.txt   3        300
6         test6.txt   4        100 
```

我想要一个查询，它返回路径以及层次结构中每个节点中或之下的文件数。基本上是文件数量的汇总。所以查询结果看起来像：

```
Path                    File_Count
=====                   ===========
/ROOT                   6
/ROOT/DIR1_1            4
/ROOT/DIR1_1/DIR2_1     1
/ROOT/DIR1_1/DIR2_2     3
/ROOT/DIR1_2            2 
```

**更新**SQL 脚本以使用示例数据创建表以匹配上述内容：

```
create table DIRS (dir_id number(38) primary key
    , parent_dir_id number(38) null references DIRS(dir_id)
    , dir_name varchar2(128) not null);

create table FILES (file_id number(38) primary key
    , file_name varchar2(128) not null
    , dir_id number(38) not null references DIRS(dir_id)
    , file_size number not null
    , unique (dir_id, file_name));

insert into DIRS 
select 1, null, 'ROOT' from dual
union all select 2, 1, 'DIR1_1' from dual 
union all select 3, 1, 'DIR1_2' from dual 
union all select 4, 2, 'DIR2_1' from dual 
union all select 5, 2, 'DIR2_2' from dual;

insert into files
select 1, 'test1.txt', 5, 100 from dual
union all select 2, 'test2.txt', 5, 200 from dual
union all select 3, 'test5.txt', 5, 50 from dual
union all select 4, 'test3.txt', 3, 300 from dual
union all select 5, 'test4.txt', 3, 300 from dual
union all select 6, 'test6.txt', 4, 100 from dual;

commit; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T01:39:53.683

这个很简单：

```
09:38:54 HR@vm_xe> l                                      
  1  select sys_connect_by_path(dp.dir_name, '/') path    
  2         ,(select count(file_id)                       
  3             from dirs dc                              
  4                  ,files f                             
  5            where f.dir_id(+) = dc.dir_id              
  6          connect by prior dc.dir_id = dc.parent_dir_id
  7            start with dc.dir_id = dp.dir_id           
  8          ) count                                      
  9    from dirs dp                                       
 10    connect by prior dp.dir_id = dp.parent_dir_id      
 11*   start with dp.parent_dir_id is null                
09:38:55 HR@vm_xe> /                                      

PATH                                COUNT                 
------------------------------ ----------                 
/ROOT                                   6                 
/ROOT/DIR1_1                            4                 
/ROOT/DIR1_1/DIR2_1                     1                 
/ROOT/DIR1_1/DIR2_2                     3                 
/ROOT/DIR1_2                            2                 

5 rows selected.                                          

Elapsed: 00:00:00.02 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:53:20.433

```
select sys_connect_by_path(D.dir_name, '/'), S.count_distinct_file_id
from DIRS D
inner join (select subtree_root_dir_id
            , count(distinct file_id) count_distinct_file_id
        from (select distinct connect_by_root D.DIR_ID subtree_root_dir_id
                    , F.file_id 
                from DIRS D
                left outer join FILES F on F.dir_id = D.dir_id
                start with 1=1 connect by prior D.dir_id = D.parent_dir_id)
        group by subtree_root_dir_id) S
    on D.dir_id = S.subtree_root_dir_id
start with D.dir_id = 1 connect by prior D.dir_id = D.parent_dir_id 
```

给出您要求的结果，但我的直觉说我没有看到任何东西，并且查询可以更简单。（请不要*接受*这个答案，直到过了几天，希望有人提交更好的答案。）

# javascript - couchDB 的 GWT（或 javascript）库

> ID：12360161
> 
> 赞同：1
> 
> 时间：2012-09-10T22:11:57.517
> 
> 标签：javascript, gwt, couchdb, gwt-platform

我正在寻找一个好的设计（最佳实践）来将 couchDB 层与我的 GWT 应用程序集成。

我做了一些研究，发现[gwt-couchdb](http://code.google.com/p/couchdb-gwt)项目似乎提出了一种以更干净的方式集成 GWT 和 couchDB 的方法。但我不确定这个工具是如何工作的，以及它提出的解决方案是否值得使用？

事实上，我们需要一个用于 gwt 的纯客户端 gwt 库。一个不需要 java 后端服务器就可以像[Ektorp](https://github.com/helun/Ektorp)一样运行的库。我发现我找到了[BrowserChouch](http://hg.toolness.com/browser-couch/raw-file/blog-post/index.html)，它似乎是 couchdb 的 javascript 库。但我不清楚这是否是一个可靠的库以及如何在 gwt 中使用它。

你知道这样的 chouchdb 库可以在客户端与 js 或 gwt 一起使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:33:19.090

如果您熟悉 RDBMS，那么切换到文档数据库可能会很麻烦。在深入研究 CouchDB 之前，请确保您完整阅读了[CouchDB 权威指南](http://guide.couchdb.org/)。

因为 CouchDB 是通过简单的 HTTP 请求访问的，所以您选择的数据库驱动程序并不是很重要。[看起来非常好——但是，您可能会在阅读Document API](http://wiki.apache.org/couchdb/HTTP_Document_API)`gwt-couchdb`后的几个小时内编写自己的驱动程序。

您最大的设计问题将是：

1.  将数据建模为适合文档存储的松散耦合“文档”
2.  准确概述您将如何查询这些文档，以便您可以构建您的 CouchDB 视图

请记住，您的数据模型应该决定您对数据库的选择，而不是相反。像 CouchDB 和 MongoDB 这样的文档存储通常是一个不错的选择，但是如果引用完整性是一个硬性要求，您可能需要查看其他地方（例如 PostgreSQL）。

# dll - C#.NET PDF DLL - 无法创建 activex 组件

> ID：12360163
> 
> 赞同：1
> 
> 时间：2012-09-10T22:12:09.437
> 
> 标签：dll, com, activex, components

我最近编写了一个简单的 C#.NET Dll 来处理 PDF 的打开和打印。我的工作使用一个 ERP 系统，它试图通过 COM 调用 Oracle AutoVue (AutoVue.Application)。我的 dll 将代替 AutoVue 进行注册，并提供与 ERP 系统的更好集成。

我们有六个需要部署 DLL 的工作站，其中一个是我的开发机器。使用 Regasm.exe 的尝试被证明是徒劳的（同样的例外），但是当我手动添加注册表项时，它似乎在六个工作站中的三个上运行良好。几个月前，我能够让这个工作站与其他工作站一样工作。当我去更新 DLL 时，我发现工作站出现了异常。

六个工作站工作（或不工作）如下：
一：开发，工作
三：手动添加条目，工作
一：手动添加条目，不工作
一：未触及，待定

ERP 应用程序不会引发异常，通过以下 VB.NET 应用程序调用会引发“无法创建 activex 组件”异常。

```
Dim Obj As Object
Sub Main()
    Obj = CreateObject("AutoVue.Application")

    'PRINT
    'Obj.Execute("WINDOW SHOW")
    'Obj.Execute("CHILD SHOW")
    'Obj.Execute("FILE OPEN ""S:\****\****\****\****.PDF""")
    'Obj.Execute("PAUSE 2000")
    'Obj.Execute("PRINT")
    'Obj.Execute("CHILD CLOSE")

    'OPEN
    Obj.Execute("Child NEW")
    Obj.Execute("FILE OPEN ""S:\****\****\****\****.PDF""")
    Obj.Execute("WINDOW CASCADE")
    Obj.Execute("WINDOW SHOW")
    Obj.Execute("Child SHOW")
    ''MsgBox("work?", MsgBoxStyle.OkOnly)
End Sub 
```

以下是已在其他三个工作站上运行的注册表项。
使用 HKCU 在有问题的工作站上产生了相同的结果。

```
REGEDIT4

[HKEY_CLASSES_ROOT\AutoVue.Application]
@="AutoVue.Application"

[HKEY_CLASSES_ROOT\AutoVue.Application\CLSID]
@="{63A20B20-2357-101D-909B-0000C02E4A4A}"

[HKEY_CLASSES_ROOT\CLSID\{63A20B20-2357-101D-909B-0000C02E4A4A}]
@="AutoVue.Application"

[HKEY_CLASSES_ROOT\CLSID\{63A20B20-2357-101D-909B-0000C02E4A4A}\InprocServer32]
@="mscoree.dll"
"ThreadingModel"="Both"
"Class"="AutoVue.Application"
"Assembly"="JobBOSS Printing, Version=1.0.0.0, Culture=neutral, PublicKeyToken=88cbab76fd6d8db7"
"RuntimeVersion"="v4.0.30319"
"CodeBase"="file:///C:/Install/JobBOSS Printing DLL/JobBOSS Printing.dll"

[HKEY_CLASSES_ROOT\CLSID\{63A20B20-2357-101D-909B-0000C02E4A4A}\InprocServer32\1.0.0.0]
"Class"="AutoVue.Application"
"Assembly"="JobBOSS Printing, Version=1.0.0.0, Culture=neutral, PublicKeyToken=88cbab76fd6d8db7"
"RuntimeVersion"="v4.0.30319"
"CodeBase"="file:///C:/Install/JobBOSS Printing DLL/JobBOSS Printing.dll"

[HKEY_CLASSES_ROOT\CLSID\{63A20B20-2357-101D-909B-0000C02E4A4A}\ProgId]
@="AutoVue.Application"

[HKEY_CLASSES_ROOT\CLSID\{63A20B20-2357-101D-909B-0000C02E4A4A}\Implemented Categories\{62C8FE65-    4EBB-45E7-B440-6E39B2CDBF29}] 
```

# c++ - 为 lcov 生成分支覆盖率数据

> ID：12360167
> 
> 赞同：23
> 
> 时间：2012-09-10T22:12:29.130
> 
> 标签：c++, testing, code-coverage, lcov

我正在尝试将 lcov 用于代码覆盖率指标，但我无法让分支覆盖率起作用。

这是我使用它的方式：

```
g++ -ggdb3 --coverage src/read.c tests/test.cpp -o bin/test 
lcov --zerocounters --directory $PWD 
lcov --capture --initial --directory $PWD --output-file coverage_output  
./bin/test 
lcov --no-checksum --directory $PWD --capture --output-file coverage_output 
genhtml --branch-coverage --highlight --legend --output-directory out coverage_output 
```

但我得到：

> 总体覆盖率：
> 行......：100.0％（60行中的60行）
> 功能......：100.0％（26个功能中的26）
> 分支......：未找到数据

有任何想法吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-25T14:14:50.373

最新版本的 LCOV 默认禁用分支覆盖。

您需要通过以下任一方式重新启用它：

*   编辑您的`~/.lcovrc`文件（从 /etc/lcovrc 复制）以将`lcov_branch_coverage`设置更改为 1
*   添加`--rc lcov_branch_coverage=1`到您的 lcov 命令行

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-07-30T07:08:39.680

.lcovrc 文件是需要放置在 lcov 文件路径中的设置文件。坦率地说，我没有对这个文件的使用进行太多研究。

您需要将附加参数作为“--rc lcov_branch_coverage=1”添加到 lcov **for all calls**。在您的情况下，将此参数添加到所有三个调用中。如果你错过了一个，它将降低分支覆盖率。

genhtml 还需要 --branch-coverage。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-03T19:21:13.157

根据这篇[文章](https://stackoverflow.com/questions/13378640/lcov-can-not-collect-branch-coverage-statistics/17018817#17018817)，差异可能取决于您使用的 gcc 版本。你能分享你正在使用的版本吗？我没有得到分支覆盖：

```
 i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T14:54:21.313

抱歉，与其说是一个“想法”，不如说是确认您所做的一切都是正确的。您的确切命令适用于这个简单的代码：

```
#include <iostream>
using namespace std;

bool foo(int i)
{
    if (i != 0) {
        return 12 / i;
    } else {
        return 0;
    }
}

int main(int argc, char** argv)
{
    cout << foo(argc) << endl;
    return 0;
} 
```

lcov 覆盖表包含行、函数和分支的统计信息。也许仔细检查您实际上正在查看正确的输出 HTML？

# c++ - 如何从该指针获取指针指向的值的地址

> ID：12360169
> 
> 赞同：0
> 
> 时间：2012-09-10T22:12:40.220
> 
> 标签：c++, arrays, pointers, dereference

对不起，这必须在某个地方回答，但我还没有找到。

我有一个代码：

```
const int * tableCards[9];
int hand1card1 = 0;
tableCards[0] = & hand1card1;
int hand1card2 = 1;
tableCards[1] = & hand1card2;
int * flop1 = & tableCard[0];
tableCards[2] = flop1;
cout << * flop1 << endl;
cout << * tableCards[2] << endl;
flop1++;
cout << * flop1 << endl;
cout << * tableCards[2] << endl;

tableCard[48] is an array of pointers to ints 
```

此代码有效，但我想更改该行`tableCards[2] = flop1;`以使`* tableCards[2]`return 指向的元素的实际值`* flop1`。在这段代码中，*flop1 返回我想要的值，但 *tableCards[2] 在增加 flop1 后保持不变。

我认为这`tableCards[2] = & (* flop1);`会将 *flop1 指向的值的地址分配给 int 指针 tableCards[2] 但是在增加 flop1 之后，tableCards[2] 的值保持不变。我不想在指针上使用指针数组而不是指针数组，因为所需的 4/9 值只是整数，而不是整数上的指针。

编辑：请注意，tableCards[9] 与 tableCard[48] 是不同的数组。而且，当我看到评论和答案时，这个问题一定会令人困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:36:05.720

这不应该编译：

```
int * flop1 = & tableCard[0]; 
```

的类型`tableCard[0]`是`int*`，所以当你用它来引用它`&`时`int**`。您将其分配给`int*`. 至少它应该生成编译器警告。

因此，`flop1`指向地址`tableCard[0]`，`*flop1`为您提供存储在 的值（指针）`tableCard[0]`，并`**flop1`为您提供指向的值`tableCard[0]`。但是因为你给出`flop1`了错误的类型（`int*`而不是`int**`），所以你不能这样做。

我基于您发表的评论，即您有另一个数组：

```
int * tableCard[48]; 
```

我认为你的意思是：

```
int * flop1 = tableCard[0];
tableCards[2] = flop1; 
```

现在，当您增加它时，`flop1`它只会更改指针。at 的指针`tableCards[2]`仍将指向与指向相同的值`tableCard[0]`。

但这很顽皮：

```
flop1++;
cout << * flop1 << endl; 
```

`flop1`是存储在的指针`tableCard[0]`。当您增加它然后使用它时，您将它视为一个数组。也许是？但可能不是。你不知道现在的记忆`flop1`指向什么。

*[编辑]*在对这段代码可能试图实现的目标进行了更多思考之后......

因此，确实，如果您希望`flop1`现在指向第二个数组元素，则需要使用双指针 ( `int**`)。这意味着它`flop1`现在是数组中的迭代器`tableCard`，而不是元素......所以当你增加它时，它现在指向存储在的指针`tableCard[1]`while`tableCards[2]`仍然包含 (但不指向) 的值`tableCard[0]`。

```
int ** flop1 = & tableCard[0];
tableCards[2] = *flop1;
cout << **flop1 << endl;
cout << *tableCards[2] << endl;
flop1++;
cout << **flop1 << endl;
cout << *tableCards[2] << endl; 
```

进一步的编辑，再次基于推理......我怀疑你可能希望将`tableCard`数组定义为：

```
int tableCard[48]; 
```

在这种情况下，您的代码应该是正确的，无需进行其他更改。嗯，大概。整个事情似乎有点可疑。

# jquery - 带有 for 循环和 $.get 函数的问题

> ID：12360171
> 
> 赞同：-1
> 
> 时间：2012-09-10T22:12:40.543
> 
> 标签：jquery, asp.net-mvc

现在在这个问题上停留了几个小时......认为这与在循环中使用 $.get 及其异步性有关，但我无法弄清楚。

如果在 $.get 行上通过 firebug 添加断点，则此代码有效，但如果我只是运行它，则它不起作用。

基本上我想在页面加载时循环遍历 20 个隐藏字段并根据该值设置下拉列表值

```
for (i = 1; i <= 21; i++) {
        var sMessageTypeID = $('#MessageOrder' + i).val();
        //This line calls the Controller and populates the corresponding MessageType Drop down
        $.get('@Url.Action("GetMessageTypeByMessageTypeID")', { MessageTypeID: sMessageTypeID }, function (data) {
            $('#MessageTypes' + i).val(data);
        });
    }; 
```

这是控制器代码

```
public JsonResult GetMessageTypeByMessageTypeID(long MessageTypeID)
    {
        tblMessageType tblMessageType = db.tblMessageTypes.Single(t => t.MessageTypeID == MessageTypeID);
        return Json(tblMessageType.MessageType, JsonRequestBehavior.AllowGet);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:37:38.603

除了@alex 提供的关于关闭的解决方案之外，我想指出，像现在这样在循环中使用 AJAX 请求锤击服务器是一个非常糟糕的主意。想象一下有多个用户访问这个页面。我建议您在单个 AJAX 请求中发送 id 并调整控制器操作以返回一个数组：

```
var messageIds = [];
for (i = 1; i <= 21; i++) {
    messageIds.push($('#MessageOrder' + i).val());
}

// send a single AJAX request to the controller action:
$.get('@Url.Action("GetMessageTypeByMessageTypeID")', { messageIds: messageIds }, function (data) {
    for (var i = 0; i < data.length; i++) {
        $('#MessageTypes' + (i + 1)).val(data[i]);
    }
}); 
```

最后更新控制器操作，以便它处理多个 id：

```
public ActionResult GetMessageTypeByMessageTypeID(long[] messageIds)
{
    var messageTypes = 
        from t in db.tblMessageTypes
        where messageIds.Contains(t.MessageTypeID)
        select t.MessageType;
    return Json(messageTypes.ToList(), JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:22:51.927

下面这行有一个匿名函数，它关闭了它的祖先范围。

```
$.get('@Url.Action("GetMessageTypeByMessageTypeID")', { MessageTypeID: sMessageTypeID }, function (data) {
    $('#MessageTypes' + i).val(data);
}); 
```

的值`i`很可能是终止循环的值 ( `21`)。

您需要通过获取按值传递的值来打破封闭......

```
$.get('@Url.Action("GetMessageTypeByMessageTypeID")', { MessageTypeID: sMessageTypeID }, (function (j) {
    return function(data) { $('#MessageTypes' + j).val(data); };
})(i)); 
```

# eclipse - Google 应用引擎 SDK 和 Java SDK 版本冲突

> ID：12360176
> 
> 赞同：-1
> 
> 时间：2012-09-10T22:13:10.997
> 
> 标签：eclipse, google-app-engine, eclipse-plugin, jdk1.6

尝试使用 Eclipse IDE 开始使用 Google App 引擎。将应用引擎支持添加到 Eclipse 会安装 App Engine SDK 1.7.1。简单的应用程序在本地运行良好。但是当您上传到 Google 服务器时，它不会运行，因为它是使用 Java JDK 1.7 编译的，而 Google App Engine 服务器仅与 Java 1.6 (SE 6) 兼容。

好的，然后您删除 JDK 1.7 并安装 1.6。现在它不会构建，因为 App Engine SDK (1.7.1) 与 JDK 1.6 不兼容。花了几个小时试图弄清楚如何安装旧版本的 App Engine SDK 却没有成功。有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T02:52:21.790

在 Eclipse 中配置 JDK 1.7 后，尝试将 JDK Compliance 设置为 1.6（项目的 Java 编译器属性）。

# javascript - Node.js 使用 Series 函数实现流控制的意外结果（模式？）

> ID：12360177
> 
> 赞同：3
> 
> 时间：2012-09-10T22:13:14.573
> 
> 标签：javascript, node.js, asynchronous

我正在尝试为流量控制目的实现一系列函数，但得到了意想不到的结果。我需要检查文件是否存在，结果是 Node 启动的 shell cmd，在 5000 毫秒的过程中。使用 Mixu 的[Node book](http://book.mixu.net/ch7.html)，我正在使用一个系列函数来进行顺序执行（第 7.2.1 节）。根据 Node 书籍，如果您需要将一个结果输入另一个结果，则此模式是合适的，但似乎并非如此，因为`final()`在参数函数的任何回调返回之前执行。

下面应该是重现我所看到的内容所需的所有代码。

**预期输出**：（假设正在检查的文件是在 < 1000 毫秒内创建的）

> 1347312844082
> 真
> 1347312845082
> 真
> 1347312846083
> 真
> 1347312847082
> 真
> 1347312848082
> 真
> <--console.log() 在系列函数的最后一个参数函数中的最后一个真结果。

**实际输出**：

> 1347312844082
> 1347312845082
> 1347312846083
> 1347312847082
> 1347312848082
> false <-- 在系列参数回调之前评估系列函数的最后一个参数函数。
> 真的
> 真的
> 真的
> 真的
> 真的

我*猜*我的睡眠函数的回调（包含`fs.check`调用）

*   `args`由于系列函数的参数都被 slice.call(arguments) 调用而被推回
*   然后转到最后一个函数，
*   最后处理回调。

但这似乎与 Node 书中描述的行为相矛盾。

*注意*：我试图避免回归到同步调用`fs.existsSync`（

```
 var outputFile = 'C:\\Some\\Valid\\Path\\foo.txt';
    var successCheck = false;
    series([
            sleep(1000, function () {
                printTime();
                fs.exists(outputFile, function (exists) {
                    console.log(exists);
                    successCheck = exists;
                });
            }),
            /* middle three deleted for brevity */
            sleep(1000, function () {
                printTime();
                fs.exists(outputFile, function (exists) {
                    console.log(exists);
                    successCheck = exists;
                });
            }),

            sleep(1000, function () {
                printTime();
                fs.exists(outputFile, function (exists) {
                    console.log(exists);
                    successCheck = exists;
                });
            })
            ], function() {
                console.log(successCheck);
        });

    function sleep (msInterval, callback) {
        var now = new Date().getTime();
        while(new Date().getTime() < now + msInterval) {
      // do nothing
        }
        callback();
    }

    function series (callbacks, last)  {
        var results = [];
        function next() {
            var callback = callbacks.shift();
            if(callback) {
                callback(function() {
                    results.push(Array.prototype.slice.call(arguments));
                    next();
                });
            } else {
                last(results);
            }
        }

        next();
    }

    function printTime () { var now = new Date().getTime(); console.log(now); } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:55:50.860

我看到你的代码有几个问题。首先，你对“睡眠”的态度完全被打破了。

JavaScript（以及 Node）是一种单线程、事件驱动的语言。如果你做了任何阻止的事情，你就会阻止整个程序。

您的函数通过旋转直到几毫秒过去`sleep`来阻止整个程序。`msInterval`

# 这正是正在发生的事情：

*   首先设置一些变量。
*   有一个呼叫`series`。为了向它传递参数，我们必须评估这些参数。
*   `sleep`在下一行调用。
*   `sleep`旋转 1000 毫秒。
*   `sleep`调用它的`callback`.
*   回调将内容打印到控制台，发出异步 I/O 请求并返回。
*   `sleep`返回*未定义*。
*   调用下一个`sleep`调用；重复最后 5 个步骤。
*   ... 5 秒后，所有调用`sleep`都已完成。您现在有一个如下所示的数组：

    ```
    [undefined, undefined, undefined, undefined, undefined] 
    ```

    因为`sleep`不返回任何东西。

*   现在`series`可以使用参数调用*未定义*的数组和函数。
*   `results`被实例化。
*   `next`被调用。
*   数组中的第一个*未定义*被移出。
*   由于*undefined*是假的，所以跳转到`else`分支。
*   `last`使用空数组调用。（我们从不放任何东西`results`）
*   `last`回调打印`successCheck`, 即,`false`并返回。
*   至此，同步代码已经完成。
*   JavaScript 开始事件循环的下一次迭代。您之前发出的 I/O 请求此时可能已完成，因此`fs.exists`回调按照它们完成的顺序调用（可能是，但不一定是发出它们的顺序）。
*   回调打印到控制台并设置`successCheck`（实际上永远不会再次读取）。
*   程序结束。

# 如何修复它

永远，永远，永远在`while`循环中旋转。你可以这样重写`sleep`：

```
function sleep(ms, cb) {
    return function(done) {
        setTimeout(function() {
            cb(done);
        }, ms);
    }
} 
```

在这里，我们返回一个稍后将被调用的函数。这样，传递给的数组就被内部函数`series`填充了。`sleep`当你调用它`sleep`时，**实际上还没有发生任何事情**。

当`series`调用第一个数组元素时，它实际上是调用返回的匿名函数，我们已经关闭了最初传递给调用的`ms`and 。该函数将超时设置为毫秒。什么过期，最里面的匿名函数被调用，它调用. 它将函数作为其参数传递，这实际上是来自'的匿名函数，它推入并调用.`cb``sleep``ms``cb``done``series``next``results``next`

因为您的系列的下一步直到上一步指示完成后才开始，您必须`done`从该步骤的函数调用回调：

```
sleep(1000, function (done) {
    printTime();
    fs.exists(outputFile, function (exists) {
        console.log(exists);
        successCheck = exists;
        done();
    });
}); 
```

# 改变你的方法

当然，您真正想要解决问题的方式（“创建此文件后我该怎么做？”）不是通过轮询`fs.exists`。

相反，使用文件系统更改通知！ [`fs.watch`](http://nodejs.org/api/fs.html#fs_fs_watch_filename_options_listener)允许您监听文件或文件夹的更改。

```
var watcher = fs.watch('C:\\Some\\Valid\\Path\\', function(e, filename) {
    if (filename == 'foo.txt') {
        // success!
        watcher.close(); // stop watching for changes
    }
}); 
```

# c++ - C++ 压缩两个 for 循环以提高效率

> ID：12360179
> 
> 赞同：0
> 
> 时间：2012-09-10T22:13:21.687
> 
> 标签：c++, arrays

我有一个结构数组，我需要从中检索数据。该数组包含名称和分数。

对于一个函数，我必须输出最高分和相关名称。如果有多种情况，我必须输出所有名称。

我不能使用向量或列表。（否则我会）我只想在同一步骤中执行这两个操作。

这就是我的处理方式：

```
void highScorer (  player array[], int size )
{ // highScorer

    int highScore = 0; //variable to hold the total score

    // first loop determines highest score
    for ( int i = 0; i < size; i++ ) {

        if ( array[i].pointsScored > highScore ) {
            highScore = array[i].pointsScored;            
        }
    }
    cout << "\nThe highest scoring player(s) were:\n";
    // second loop finds players with scores matching highScore and prints their name(s)
    for ( int i = 0; i < size; i++ ) {
        // when a match is found, the players name is printed out
        if ( array[i].pointsScored == highScore ) {
            cout << array[i].playerName;
            cout << ", scored ";
            // conditional will output correct grammar
            if ( array[i].pointsScored > 1 ) {
                cout << array[i].pointsScored << " points!\n";
            }
            else {
                cout << array[i].pointsScored << " point!\n";
            }
        }
    }
    cout << "\n"; // add new line for readability
    return;

} // highScorer 
```

我想将其浓缩为一个 for 循环。除非有人对更有效的方法提出建议。我认为对数据进行排序是不必要的。另外，如果已排序，如何确定一个步骤中是否有多个“highScore”案例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T22:18:40.747

除了您的`highScore`变量之外，您还创建了第二个变量，例如 a `std::list`（或手动链表甚至是一个小数组，具体取决于您允许使用的内容）。在此列表中，您可以跟踪实际拥有当前高分的人的指数。如果发现新的高分，则清除该列表并添加具有新高分的人。如果发现某人具有高分，您只需将他添加到列表中。

然后在循环之后，您只需要打印具有此列表中索引的球员，而不是再次找出谁拥有最高分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T22:19:50.570

一种解决方案是在您搜索高分时记录玩家的姓名。如果它等于当前的高分，则在您的“名称集合字符串”中附加一个额外的名称，如果它更高，则将名称空白，并记录新的高分和新名称。我会实现名称的打印输出，`ostringstream`以确保您不会超出缓冲区。然后当你完成后，打印出你的名字集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T22:20:32.193

在您完成第一次（唯一）通过时，保留最高分数的索引集。然后，当您完成时，您将拥有对应于该最高分数的一组索引。在我刚刚编写的一种语言的伪代码中：

```
int highestSoFar = 0;
list indexesOfHighScore = new list();

for (int i = 0; i < scores.count; i++) {
    if (scores[i] > highestSoFar) {
        highestSoFar = scores[i];
        indexesOfHighScore.empty();
    }
    if (scores[i] == highestSoFar) {
        indexesOfHighScore.add(i);
    }
}

// Now I know the highest score, and all the indexes of entries that correspond to it. 
```

如果您没有可用的动态列表，则该列表可以是与 score 数组大小相同的静态数组，以确保它始终足够大。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-10T22:21:59.537

现在，您的第一个循环正在跟踪高分。如果它还跟踪所有匹配的名称，则可以在循环完成时输出名称。您仍然需要第二个循环来遍历这些名称，这是无法避免的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-10T22:52:40.390

以较小的存储成本，您可以在同一通道中计算高分和各自的玩家：

```
player ** highScorer (  player array[], int size )
{
    player ** result = new player*[size + 1]; // The +1 handles the case where everyone ties

    int highScore = 0;
    int foundAt = 0;

    for ( int i = 0; i < size; i++ )
    {
        if ( array[i].pointsScored > highScore )
        {
            highScore = array[i].pointsScored;
            foundAt = 0;
        }

        if ( array[i].pointsScored == highScore )
        {
            result[foundAt] = &(array[i]);
            foundAt++;
        }
    }

    result[foundAt] = null; // Stopping condition, hence the +1 earlier

    return result; // Remember to delete[] the resulting array
} 
```

然而。

那不会给你一个输出。如果要输出结果，您仍然需要第二个循环。

```
void outputScores ( player ** result )
{
    cout << "\nThe highest scoring player(s) were:\n";

    for ( int i = 0; result[i] != null; i++ )
    {
        cout << result[i]->playerName;
        cout << ", scored ";
        if ( result[i]->pointsScored == 1 )
            cout << "1 point!\n";
        else
            cout << result[i]->pointsScored << " points!\n";
    }

    cout << "\n";

    delete [] result;
} 
```

要回答您最初的问题，我认为没有任何方法可以在一个循环中找到*并输出所有得分高的玩家。*即使对分数数组进行预排序也会比你已经拥有的更糟糕。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-10T22:30:26.820

我不会保留完整的匹配索引集，而是保留第一个和最后一个。这使您可以跳过搜索整个列表，并在有唯一最高分的情况下完全避免第二遍。

```
void highScorer( player* array, int size )
{
    int highScore = 0;
    int firstHighI = -1, lastHighI = -1;

    for ( int i = 0; i < size; i++ ) {  
        if ( array[i].pointsScored > highScore ) {
            highScore = array[i].pointsScored;
            firstHighI = i;
        }
        if ( array[i].pointsScored == highScore ) {
            lastHighI = i;
        }
    }

    if (firstHighI >= 0) {
        std::cout << "\nThe highest scoring player(s) were:\n";
        for ( int i = firstHighI; i < lastHighI; i++ ) {
            if ( array[i].pointsScored == highScore ) {
                std::cout << array[i].playerName << ", ";
            }
        }

        std::cout << array[lastHighI].playerName << " with a score of " << highScore;
        if ( highScore != 1 ) {
            std::cout << " points!\n";
        }
        else {
            std::cout << " point!\n";
        }
    }
    std::cout << "\n";
} 
```

# zend-framework - Zend 框架控制器插件执行 HTTP 基本身份验证？

> ID：12360182
> 
> 赞同：0
> 
> 时间：2012-09-10T22:13:34.653
> 
> 标签：zend-framework, authentication, basic-authentication

如何编写一个 Zend Framework 控制器插件来针对所有传入请求执行 HTTP 基本身份验证（或摘要）？如果没有提供身份验证详细信息（通过`Authorization`标头），或者身份验证失败，我想返回 401 状态代码（而不是重定向到`/login`或类似的）。（该应用程序是一个 Web 服务；它永远不会返回`text/html`。）

（这个问题的一个可能更简单的重新陈述是：你如何从控制器插件返回用户定义的状态代码，并禁止所有进一步的处理？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T02:56:05.920

我将从[Zend_Auth](http://framework.zend.com/manual/1.12/en/zend.auth.introduction.html)组件开始，然后选择[Http 适配器](http://framework.zend.com/manual/1.12/en/zend.auth.adapter.http.html)或[摘要适配器](http://framework.zend.com/manual/1.12/en/zend.auth.adapter.digest.html)，我认为您可能希望构建插件来评估[routeStartup()](http://framework.zend.com/manual/1.12/en/zend.controller.plugins.html)处的请求。

然后，您可以将错误响应放在您的默认控制器中，或者您可以构建/更改错误控制器以返回您想要的任何风格的 http 响应。

祝你好运

# mysql - mySql 表中可以有很多索引吗？

> ID：12360185
> 
> 赞同：0
> 
> 时间：2012-09-10T22:13:53.197
> 
> 标签：mysql, indexing

我有一些字段有 4 种不同的排序选项。在不同的情况下，字段按这 4 个选项和 2 个日期和用户 ID 进行排序或过滤。让我们假设这些列是：

**列：id、info1、info2、option1、option2、option3、option4、date1、date2、userid**

所以我的问题是：

一个表中是否可以有 7 个不同的索引（option1、option2、option3、option4、date1、date2、userid）？它对大型数据库中的数据库读写性能有影响吗？

如果是，您有什么建议作为解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:16:52.353

插入或更新表时需要更新索引。因此，索引越多，这些操作就会越慢。

MySQL 通常在每个查询中每个表只使用一个索引。如果您有 4 个不同的排序选项，通常有一个涵盖每个排序选项的索引是有意义的。

IIRC，您不需要 (a,b) 和 (a,b,c) 上的索引，因为 (a,b,c) 涵盖两者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:20:21.870

每当您执行`CREATE`,`UPDATE`或`DELETE`索引需要更新。`SELECT`因此，您应该根据语句的集中度来限制您的索引。您还需要对索引的工作原理有一个基本的了解，例如，如果您有一个复合索引`(c1, c2)`并且您运行一个仅选择的查询`c2`，那么它是没有用的。您可能还想研究创建一个`VIEW`而不是索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T22:20:24.943

“指数和使用它们”的概念是一种权衡。它们可以使您的搜索速度更快，但您必须在其他地方支付费用。许多索引使 DML 命令花费更长的时间，因为索引应该在每个 UPDATE、DELETE 和 INSERT 命令时更新。他们想在搜索中为您服务，而您必须付出代价。您拥有的索引越多，您获得的搜索速度就越高，UPDATE 和 INSERT 时间也就越长。应该非常明智地使用和调整它们。

您也可以在标准化中看到这种成本效益。你获得了标准化、更好的分析能力和广泛传播的数据，你应该为收集它们和连接付费。

# redirect - 在 Chrome 中的内联 javascript 重定向之前中断 javascript

> ID：12360187
> 
> 赞同：103
> 
> 时间：2012-09-10T22:14:05.980
> 
> 标签：redirect, google-chrome-devtools

我正在查看具有内联 javascript 重定向 ( `window.location = "/anotherpage"`) 的页面。我想在 Chrome 中加载该页面，但禁用了重定向行，因此我可以使用该页面而不会被重定向。

这是我尝试过的：

*   开发人员工具 -> Cog -> 常规 -> 禁用 JavaScript。加载页面。它不会重定向（耶！）。但我仍然希望页面的其余部分 javascript 运行，但它没有。

*   输入 URL，然后单击开发者工具 -> 源 -> 暂停 (F8) 真快！它还没有重定向（耶！）现在我想在取消暂停之前禁用重定向行，但那部分甚至还没有加载到开发者工具中。所以我将开始单步执行其他文件的 javascript 代码，直到我到达那里？但是，一旦我退出其他文件 javascript，它就会立即重定向（doh！）。

这可以做到吗？我认为禁用一行javascript应该很容易，但我很难过。

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2012-09-14T06:39:35.957

开发人员工具 -> 源 -> 事件侦听器断点（在右侧栏） -> 加载 -> 检查卸载

这将使调试器在导航之前调度的卸载事件上中断。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2016-05-18T04:00:48.180

请执行下列操作

1.  打开*开发者工具*
2.  转到*来源*选项卡
3.  查找*事件侦听器断点*
4.  展开*加载*选项
5.  在这里检查*卸载*选项

[![Chrome 卸载断点](../Images/3d6b3892fa17b4fcc5a881194526859e.png)](https://i.stack.imgur.com/iQckC.png)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-04-14T11:21:39.083

我有一个 3rd 方 JS 库，它有一个错误的条件来重新加载页面。并且页面因此被不断地重新加载。我试图找到错误的代码在哪里。

我尝试使用“事件侦听器断点”方法，但正如评论所说，您在卸载事件中没有堆栈跟踪，所以它非常没用。

对我有用的**解决方案**：我创建了一个带有沙盒属性的 iframe 标记的页面，例如`<iframe sandbox="allow-same-origin allow-scripts allow-popups allow-forms"></iframe>`并将我的网站放入其中。这样 chrome 内部就会发生安全错误，并且控制台会显示 JS 尝试访问位置对象的位置。您可以单击它并查看代码。最好的是Chrome有一个JS解压器（源码窗口左下角的{}按钮），很聪明，打印出来后也能显示线条，所以压缩后的JS也能看到。

有关沙盒属性的更多信息：[https ://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-sandbox](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-sandbox)

# ruby-on-rails - 在 Rails 中执行类似操作的正确方法

> ID：12360188
> 
> 赞同：3
> 
> 时间：2012-09-10T22:14:21.547
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个对应于项目的 rails 模型和控制器。每个项目都有多个状态。假设状态可以是提案、批准、存档。

在我的控制器中，我有一个索引操作。但是，在整个应用程序的视图中，我想链接到提案、批准和存档的项目，并且只显示这些。

我可以创建诸如批准、提议、归档等操作，并让这些操作仅获得匹配的操作。

我正在考虑的另一件事是每个链接都将一个变量传递给参数，然后该参数将指示索引操作的作用。

这两个中的哪一个是正确的方法和/或我在rails中遗漏了一些东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T22:42:13.283

我绝对更喜欢参数中设置的变量选项。这种方式很干燥，添加新状态几乎毫不费力。为了实现它，我将使用以下代码：

```
# routes.rb

match 'projects/:filter' => 'projects#filter', :constraints => { :filter => /^approved$|^archived$|^proposal$/}

# ProjectsController.rb

  def filter
    @projects = Project.where(:status => params[:filter])
  end 
```

这样，如果您添加更多状态，您所要做的就是允许在路由定义中进行过滤。

# javascript - 仅使用 File 对象选择单个文件

> ID：12360190
> 
> 赞同：21
> 
> 时间：2012-09-10T22:14:30.957
> 
> 标签：javascript, html

MSDN[这里](http://msdn.microsoft.com/en-us/library/windows/apps/hh453204.aspx)有一个File 对象的例子，它允许选择多个文件

```
<!DOCTYPE html>
<html>
  <head>
    <title>Acquiring File Information</title>  
    <style type="text/css">
      #alert {
        color: red;
        margin: 1em 0;
      }
    </style>  
    <script type="text/javascript">
      window.addEventListener('load', init, false);

      function init() {
        checkForFileApiSupport();
        document.getElementById('files').addEventListener('change', handleFileSelection, false);
      }

      function checkForFileApiSupport() {
        if (window.File && window.FileReader && window.FileList && window.Blob) {  
        // All the File APIs are supported.
        } 
        else {  
          document.getElementById('alert').innerHTML = "The File APIs are not fully supported in this browser.";
        }
      }

      function handleFileSelection(evt) {    
        var files = evt.target.files; // The files selected by the user (as a FileList object).

        // "files" is a FileList of file objects. List some file object properties.    
        var output = [];    
        for (var i = 0, f; f = files[i]; i++) {    
          output.push('<li><strong>', f.name, '</strong> (', f.type || 'n/a', ') - ',                  
                      f.size, ' bytes, last modified: ',                  
                      f.lastModifiedDate, '</li>');    
        }    
        document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';  
      }  
    </script>
  </head>

  <body>
    <input type="file" id="files" name="files[]" multiple /> <!-- The name attribute value is typically paired with the field's data when submitted via a <form> tag. -->
    <output id="list"></output>
    <div id="alert"></div>
  </body>
</html> 
```

是否可以在“打开”对话框中将选择限制为单个文件，而不是使用`f = files[0]`可能并不总是可靠的？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-09-10T22:24:06.633

如果您不希望用户能够选择多个文件，则应`multiple`从标记中删除该属性。

改变

`<input type="file" id="files" name="files[]" multiple />`

为了

`<input type="file" id="file" name="file" />`

[您可以在此处查看](https://www.w3.org/wiki/Html/Elements/input/file#HTML_Attributes)输入类型文件标记的完整属性列表

# javascript - 用#text添加tr元素的Javascript

> ID：12360194
> 
> 赞同：-1
> 
> 时间：2012-09-10T22:14:43.513
> 
> 标签：javascript, html

我有一个向表中添加新行的功能，但由于每个 td 有很多内部节点（每个节点有很多属性），我只是更改了行的 .innerHTML。

但是，这会导致其他功能出现问题，因为未插入 #text 节点。

我试过添加`<text/>`标签，但没有这样做..所以..有什么建议吗？

我的 JavaScript 代码是：

```
var newTrNode = document.createElement('tr');
newTrNode.setAttribute('id', resultArray[0]);

var putInside = '<td><text/><input readonly="readonly" value="'+assetName+'" type="text"  class="field left"/></td><td><input type="text" value="credentials" class="field left" readonly="readonly" /></td><td>';
var rowNode = but.parentNode.parentNode;                                                                    
putInside += rowNode.childNodes[5].innerHTML;
putInside += '</optgroup></select></td><td><input type="text" value="'+resultArray[1]+'" class="field left" readonly="readonly" /></td><td><input type="password" value="'+resultArray[2]+'" class="field left" readonly="readonly" /></td><td><input onClick="editField('+resultArray[0]+',this)"type="button" value="Edit" class="field left"/><input onClick="deleteAsset('+resultArray[0]+')" type="button" value="Delete" class="field left"/><input onClick="lockUnlock('+resultArray[0]+',this, false)" type="button" value="Unlock" class="field left"/><img src="lock.png"/></td>';
newTrNode.innerHTML = putInside; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:19:43.153

不要使用 innerHTML 来修改表格行（或表格的任何部分）的内容，因为至少在某些版本的 IE 中它被[指定为失败。](http://msdn.microsoft.com/en-us/library/windows/apps/hh780067.aspx)使用 DOM 方法。您可以将 innerHTML 用于整个表格或单元格的内容（TD 元素）。

HTML 中没有文本元素，浏览器会为文档中的文本创建文本节点。您可以使用文档界面的[createTextNode](http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-1975348127)方法创建文本节点：

```
var textNode = document.createTextNode('text'); 
```

您可以使用带有如下功能的 innerHTML 添加行：

```
<script type="text/javascript">

function rowsFromMarkup(table, markup) {
  var div = document.createElement('div');
  div.innerHTML = '<table>' + markup + '<\/table>';
  var rows = div.getElementsByTagName('tr');
  var tbody = table.tBodies[0];

  for (var i=0, iLen=rows.length; i<iLen; i++) {
    tbody.appendChild(rows[i]);
  }
}
</script>

<table id="t0">
 <thead>
  <tr>
    <th>index
    <th>item
 </thead>
 <tbody>
  <tr>
   <td>0
   <td>foo
 </tbody
</table>

<button onclick="
 rowsFromMarkup(document.getElementById('t0'),'<tr><td>1<td>bar');
">Add a row</button> 
```

# ruby-on-rails - 嵌套表单返回未定义的方法“with_indifferent_access”

> ID：12360199
> 
> 赞同：1
> 
> 时间：2012-09-10T22:15:05.200
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个学生模型和一个裁判模型。我希望学生填写一份表格，该表格有一个嵌套区域，要求提供信息以联系裁判。我在 rails 3.2.6 中使用 activeadmin 和 formtastic。

我的问题是当我导航到 new_student_path 时，我得到“未定义的方法 `with_indifferent_access'”

学生控制器.rb：

```
 def new
   @student = Student.new
   @student.referee = Referee.new
  end 
```

学生模型：

```
class Student < ActiveRecord::Base

has_one :referee
accepts_nested_attributes_for :referee
attr_accessible :firstname, :lastname, :statement
attr_accessible :referee, :referee_attributes
alias_method :referee=, :referee_attributes= 
```

学生的 new.html.erb：

```
<%= semantic_form_for @student do |f| %>
<%= f.semantic_errors :state %>

 <%= f.inputs do %>
    <%= f.input :firstname %>
    <%= f.input :lastname %>

    <%= f.semantic_fields_for :referee do |ff| %>
        <% if h.object.new_record? %>
        <%= ff.inputs do %>
            <%= ff.input :firstname, :label => "Reference's First Name" %>
            <%= ff.input :lastname, :label => "Reference's Last Name"%>
            <%= ff.input :email, :label => "Reference's Email"%>
        <% end %>
      <% end %>
    <% end % 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:50:23.690

进行了以下修改，现在它可以工作了。

学生模型：

```
has_one :referee
accepts_nested_attributes_for :referee
attr_accessible :firstname, :lastname, :statement
attr_accessible :referee, :referee_attributes
#alias_method :referee=, :referee_attributes= - removed this line (preventing method from being created) 
```

然后删除了对嵌套表单上未显示的属性的验证，一切正常。

还

```
@student.referee.build 
```

仅适用于 has_many 关联。所以不得不使用

```
@student.referee = Referee.new 
```

或者

```
@student.build_referee 
```

# c# - 两个视图之间的实体框架关系

> ID：12360201
> 
> 赞同：0
> 
> 时间：2012-09-10T22:15:36.263
> 
> 标签：c#, asp.net-mvc-3, linq, entity-framework

我正在尝试编写一个查询，将我的两个视图加入结果中。不知道为什么我不能让它工作：

```
var query = AccountUnitOfWork.Accounts.Find()
    .Join(AccountUnitOfWork.Subscriptions.Find(), x => x.ID, s => s.ID); 
```

这是我需要编写原始 SQL 的东西，因为 Entity 无法了解这种关系吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:32:17.190

Find 返回一个实体，它不返回一个 IQueryable。Join 仅适用于 IQueryable。

此外，您在 Join 中的查询也不起作用，因为它也返回单个实体。

你需要做这样的事情：

```
AccountUnitOfWork.Accounts.Join(AccountUnitOfWork.Subscriptions, x => x.ID, s => s.ID) 
```

您可能还想使用 Wher 子句来限制该集合。

# android - android相对布局背景崩溃

> ID：12360212
> 
> 赞同：2
> 
> 时间：2012-09-10T22:16:26.777
> 
> 标签：android, background, drawable, android-relativelayout, android-inflate

好吧'我有一个RelativeLayout

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:clickable="true"
    android:background="@drawable/my_shape_normal"
    android:onClick="startTestTillError"> 
```

并且 my_shape_normal 定义为

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="rectangle">
<gradient
    android:startColor="#FFFFFF00"
    android:endColor="#80FFFFFF"
    android:angle="120"/>
<padding android:left="7dp"
    android:top="7dp"
    android:right="7dp"
    android:bottom="7dp" />
<corners android:radius="8dp" />
</shape> 
```

加载时引发异常：RelativeLayout 行上的 android.view.InflateException。如果我删除“android:background”，一切都会完美。my_shape_normal 有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T22:34:11.323

当我剪切并粘贴您的 XML 时，我的 LogCat 会显示：

```
Caused by: org.xmlpull.v1.XmlPullParserException: Binary XML file line #6
    <gradient> tag requires 'angle' attribute to be a multiple of 45 
```

因此，我更新了您的形状 XML 以反映此要求：

```
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle"
    android:padding="7dp" >

    <gradient
        android:angle="135"
        android:endColor="#80FFFFFF"
        android:startColor="#FFFFFF00" />

    <corners android:radius="8dp" />

</shape> 
```

请注意，我还将相同的`padding`元素组合成一个属性`shape`。

# wcf - 使用 Castle Dynamic Proxy Generation 注入 WCF 故障合约

> ID：12360218
> 
> 赞同：7
> 
> 时间：2012-09-10T22:16:52.667
> 
> 标签：wcf, castle, faultexception, faultcontract

我目前正在使用 WCF 后端开发 WPF 应用程序。我们已经为异常处理实现了一个客户端日志解决方案和一个服务器日志解决方案，它们工作得很好，但通常很难通过网络将信息联系在一起。如果服务器上发生异常，我想要一种通过网络将异常令牌传回的方法，以便我可以将异常记录到客户端上。这样，当我解决客户端错误时，我可以很容易地将它与服务器异常关联起来。

我想提供更多关于我们的架构的信息，然后我会陈述我的问题。

我们的 WCF 实现比用于设置服务引用的开箱即用方法更健壮一些。我们在客户端实现了动态代理生成。我们通过创建客户端和服务器共享的 Web 服务接口来实现这一点，并使用 Castle.DynamicProxy.ProxyGenerator 类和 CreateInterfaceProxyWithoutTarget 方法来创建代理。此外，当我们调用 CreateInterfaceProxyWithoutTarget 方法时，我们指定了一个 IInterceptor 实现。在服务器上，有三个主要类用于我们的跟踪和故障行为：

FaultOperationInvoker（实现 IOperationInvoker）：尝试使用 IOperationInvoker.Invoke 调用服务方法。如果是错误异常类型，则重新抛出，如果是异常，则尝试确定是否存在具有特定详细信息类型的错误合同，如果是，则包装然后使用详细信息引发新的错误异常。

```
internal class FaultOperationInvoker : IOperationInvoker
    {
        IOperationInvoker innerOperationInvoker;
        FaultDescription[] faults;

        public FaultOperationInvoker(IOperationInvoker invoker, FaultDescription[] faults)
        {
            this.innerOperationInvoker = invoker;
            this.faults = faults;
        }

        #region IOperationInvoker Members

        object[] IOperationInvoker.AllocateInputs()
        {
            return this.innerOperationInvoker.AllocateInputs();
        }

        object IOperationInvoker.Invoke(object instance, object[] inputs, out object[] outputs)
        {
            try
            {
                return this.innerOperationInvoker.Invoke(instance, inputs, out outputs);
            }
            catch (FaultException e)
            {
                ServerLogger.GetLogger(instance.GetType().FullName).LogException(e, "Unhandled exception in service operation.");

                //allow fault exceptions to bubble out
                throw;
            }          
            catch (Exception e)
            {
                Type exceptionType = e.GetType();

                ServerLogger.GetLogger(instance.GetType().FullName).LogException(e, "Unhandled exception in service operation.");

                //if the excpetion is serializable and there operation is tagged to support fault contracts of type WcfSerivceFaultDetail
                if (faults != null && (faults.OfType<WcfServiceFaultDetail>().Any() || faults.Count(x => x.DetailType == typeof(WcfServiceFaultDetail)) > 0))
                {
                    throw new FaultException<WcfServiceFaultDetail>(new WcfServiceFaultDetail(true, e), "Unhandled exception during web service call.", WcfFaultCustomExceptionFactory.GetFaultCodeForExceptionType(exceptionType));
                }
                else
                {
                    throw new FaultException("Unhandled exception during web service call.", WcfFaultCustomExceptionFactory.GetFaultCodeForExceptionType(exceptionType));
                }

            }
        } 
```

FaultOperationBehavior (Implements IOperationBehavior) 将调度操作调用程序指向上述故障操作调用程序。

```
[AttributeUsage(AttributeTargets.Method)]
    public class FaultOperationBehavior : System.Attribute, IOperationBehavior
    {
        #region IOperationBehavior Members

        void IOperationBehavior.AddBindingParameters(OperationDescription operationDescription,
            System.ServiceModel.Channels.BindingParameterCollection bindingParameters) { }

        void IOperationBehavior.ApplyClientBehavior(OperationDescription operationDescription,
            System.ServiceModel.Dispatcher.ClientOperation clientOperation) { }

        void IOperationBehavior.ApplyDispatchBehavior(OperationDescription operationDescription,
            System.ServiceModel.Dispatcher.DispatchOperation dispatchOperation)
        {          
            dispatchOperation.Invoker = new FaultOperationInvoker(dispatchOperation.Invoker, operationDescription.Faults.ToArray());
        }

        void IOperationBehavior.Validate(OperationDescription operationDescription) { }

        #endregion
    } 
```

ExceptionTraceBehavior（继承属性，实现IServiceBehavior）用于处理实现IServiceBehavior的异常。我们还有一个类（FaultOperationBehavior）

```
[AttributeUsage(AttributeTargets.Interface | AttributeTargets.Class, Inherited = true)]
public class ExceptionTraceBehavior : Attribute, IServiceBehavior
{
    public void AddBindingParameters(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase, System.Collections.ObjectModel.Collection<ServiceEndpoint> endpoints, System.ServiceModel.Channels.BindingParameterCollection bindingParameters)
    {
    }

    public void ApplyDispatchBehavior(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
        foreach (var ep in serviceDescription.Endpoints)
        {
            foreach (var operation in ep.Contract.Operations)
            {
                if (operation.Behaviors.Contains(typeof(FaultOperationBehavior)))
                    continue;

                operation.Behaviors.Add(new FaultOperationBehavior());

                //Check to see if this operation description contains a wcf service fault detail operation.  If it doesn't, add one.
                if (operation.Faults != null && (operation.Faults.Count == 0 || operation.Faults.Count > 0 && operation.Faults.Count(x => x.DetailType == typeof(WcfServiceFaultDetail)) == 0))
                {
                    FaultDescription faultDescription = new FaultDescription(operation.Name);
                    //faultDescription.Name = "WcfServiceFaultDetail";
                    //faultDescription.Namespace = "";
                    faultDescription.DetailType = typeof(WcfServiceFaultDetail);
                    operation.Faults.Add(faultDescription);
                }
            }
        }
    }

    public void Validate(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
    }
} 
```

我们的每一个服务接口都有一个具体的实现。我们所有的服务也继承了我们的基础服务类，该类用 ExceptionTrace 属性装饰。

所以，现在有了背景信息，问题就来了。我希望每个服务操作都有一个详细类型为 WCFServiceFaultDetail 的故障合同，但我不想在每个服务操作上都添加一个 FaultContract 属性。正如您在 ExceptionTraceBehavior 中看到的那样，我想出了如何以编程方式添加故障协定，并且它非常适合将故障添加到操作中。当在操作调用程序中捕获到一个常规的旧异常时，它会发现存在正确的故障契约并抛出一个新的 FaultExcption。但是，当异常被客户端捕获回来时，它会落入 catch (FaultExcection fe) 代码，而不是 catch (FaultException fe) 代码。

但是，如果删除以编程方式添加到故障合同中的代码，我会用 [FaultContract(typeof(WcfServiceFaultDetail))] 装饰每个服务操作，客户端会按预期捕获异常。

我唯一能想到的是，由于代理是从接口而不是从 WSDL 或其他元数据动态生成的，并且接口上没有错误契约修饰，所以我的编程错误契约没有得到兑现。

考虑到这一点，我试图弄清楚如何在 IInterceptor 实现中添加故障契约，但没有成功。

所以我希望有人已经这样做了并且可以提供一些细节。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T08:33:38.067

我不是 WCF 专家，但我的手有点脏。

我想你是对的。在创建某种类型的 ChannelFactory 时，从程序集元数据中解析错误协定。由于您的接口未使用适当的 FaultContract 属性进行修饰，因此您的客户端使用没有详细信息的默认故障契约。

在运行时将 FaultContract 属性添加到您的接口方法可能也不起作用。

一种解决方案是在运行时动态生成和使用类型，以生成通道工厂。

我从来没有这样做过，但我认为这可以从 AppDomain 的 DefineDynamicAssembly 开始。

# c# - 如何选择包含特定字符串的所有脚本节点

> ID：12360219
> 
> 赞同：1
> 
> 时间：2012-09-10T22:16:52.603
> 
> 标签：c#, html, xml, xpath

假设我在 HTML 文档中有多个脚本节点，我将如何选择所有包含特定源值的节点：

```
<head>
</head>
<body>
    <script type="text/javascript">
        blah();
    </script>
</body> 
```

**仅选择正文**中包含函数的脚本节点的正确方法是`blah`什么？

## 更新

~~我试过`//script[contains(text(), 'blah')]`了，但没有用。~~

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:37:11.893

//script[contains(., 'blah') 应该在 . 而 text() 是可以有多个文本节点（理论上），并且 text() 匹配所有这些节点的序列。

另一种可能性是您拥有 XHTML，并且您需要将 XHTML 命名空间绑定到前缀，例如“h”，并说，//h:script[contains(., 'blah')]，以及如何做到这一点取决于确切的调用环境，例如 registerNamespace() 什么的。您需要在文档中注册与 xmlns="...." 中相同的 URI，很可能是[http://www.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml)，例如，如果您在 .net 中使用 XmlDocument，则如下所示：

```
System.Xml.XmlNamespaceManager xmlnsManager =
                 new System.Xml.XmlNamespaceManager(xmldoc.NameTable);

xmlnsManager.AddNamespace("h", "http://www.w3.org/1999/xhtml", xmlnsManager);

result = xmldoc.SelectNodes('//h:script[contains(., 'blah')]') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:36:22.123

使用 javascript 搜索功能遍历每个脚本元素怎么样？

[http://www.w3schools.com/jsref/jsref_search.asp](http://www.w3schools.com/jsref/jsref_search.asp)

```
<script type="text/javascript">
    var s = document.getElementsByTagName('script'); 

    for (var i = 0; i < s.length; i++) {
        var src = s[i].innerText;
        var result = src.search("blah()");
        if (result != -1) {     
            console.log(src);
        }
    }

</script> 
```

该脚本应该进入页面加载逻辑以处理在此之后出现的所有脚本元素。

# jdbc - Mule ESB JDBC 入站端点：'abstract-transformer'

> ID：12360223
> 
> 赞同：0
> 
> 时间：2012-09-10T22:17:18.300
> 
> 标签：jdbc, mule

我正在尝试将转换器添加到 jdbc 入站端点，但收到以下错误消息：

`Caused by: org.xml.sax.SAXParseException: cvc-elt.2: The value of {abstract} in the element declaration for 'abstract-transformer' must be false. at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source) at org.apache.xerces.util.ErrorHandlerWrapper.error(Unknown Source) at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)`

这是配置：

```
 <jdbc:inbound-endpoint exchange-pattern="one-way" 
                           queryKey="orderSelect" 
                           responseTimeout="10000" 
                           mimeType="text/plain" 
                           queryTimeout="-1" 
                           pollingFrequency="${oms.new.data.polling.interval}" 
                           connector-ref="jdbcConnector" 
                           transformer-refs="ResourceLocker" 
                           doc:name="Select New Orders" >
                           <abstract-transformer class="com.pb.oms.mule.transformer.ResourceUnlocker" 
                                                 name="ResourceUnlocker"
                                                 abstract="false"
                                                 doc:name="ResourceUnlocker" />
    </jdbc:inbound-endpoint> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T10:20:22.060

您应该定义一个全局自定义转换器，如下所示：

```
<custom-transformer class="com.pb.oms.mule.transformer.ResourceUnlocker" 
                                             name="ResourceUnlocker"
                                             abstract="false"
                                             doc:name="ResourceUnlocker" /> 
```

并使用 a 将其包含在您的入站端点中

```
<transformer ref="ResourceUnlocker" /> 
```

[您可以在此处](http://www.mulesoft.org/documentation/display/MULE3USER/Configuring+Endpoints)找到有关该主题的文档

# android - 检测用户是否在移动

> ID：12360225
> 
> 赞同：1
> 
> 时间：2012-09-10T22:17:45.543
> 
> 标签：android

我想检测用户是否在移动 - 无论是行走还是跳跃

我找到了这个代码示例

```
private final SensorEventListener sensorEventListener = new SensorEventListener() {
        double calibration = SensorManager.STANDARD_GRAVITY;

        public void onAccuracyChanged(Sensor sensor, int accuracy) {
        }

        public void onSensorChanged(SensorEvent event) {
            double x = event.values[0];
            double y = event.values[1];
            double z = event.values[2];

            double a = Math.round(Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2)
                    + Math.pow(z, 2)));
            currentAcceleration = Math.abs((float) (a - calibration)); 
```

它给出的读数在 0.01 到 0.2 G 之间——我可以用这个例子来检测运动吗？也许有点跑题了？- 抱歉，如果是的话！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T05:06:23.417

您需要制作一个 LOG 文件并写入所有更改的数据以制作您的简单算法

1.  您不需要像 0.000000001 这样的超深细节检测，只需要像检测 2 个浮点

    整数估计X = (int)(x*100);

2.  当它在 0.75 到 0.80 的大范围内移动时保持日志（如果你问我们如何知道范围，是的，你需要走过去看看）

3.  继续走

# google-apps-script - 谷歌脚本可以跨多个工作表工作

> ID：12360229
> 
> 赞同：2
> 
> 时间：2012-09-10T22:17:58.140
> 
> 标签：google-apps-script

我是谷歌脚本的新手，如果这个问题已经得到解答，我深表歉意。

我有一个包含多个工作表的电子表格，其中一些工作表在某处有一个状态列。

使用我已经发现的代码，我可以根据状态列中单元格中的值设置整个行的颜色。

我遇到的问题是我只能让代码在一张纸上工作。

以下代码（由 ScampMichael 编写）的工作原理与我希望根据 Status 列中的值更新一整行的方式完全相同，但我无法让它在同一个工作簿中的多个工作表（具有不同名称）上工作。

我已经尝试将代码作为单独的脚本使用编辑过的工作表名称和列号，以便每个都引用一个单独的工作表，但仍然只有一张工作表被更新。

请有人建议我如何编辑此代码或如何复制它以便跨多个工作表工作？

```
function onEdit(e) {

  var statusCol = 2; // replace with the column index of Status column A=1,B=2,etc

  var sheetName = "Services"; // replace with actual name of sheet containing Status

  var cell = e.source.getActiveCell();
  var sheet = cell.getSheet();
  if(cell.getColumnIndex() != statusCol || sheet.getName() != sheetName) return;

  var row = cell.getRowIndex();
  var status = cell.getValue();

  // change colors to meet your needs
  var color;
  switch(status ) {
    case "Down":
      color = "red";
      break;
    case "":
      color = "White";
      break;
    case "Up":
      color = "green";
      break;
  }
  sheet.getRange(row + ":" + row ).setBackgroundColor(color);
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:21:12.810

电子表格只能有一个 onEdit() 函数。因此，对任何工作表所做的编辑都必须在同一个函数中处理。

一种方法不是硬编码 statusCol 的值，而是在运行时获取它。在许多可能的方法中，我将在这里给出两个

更简单的方法

```
var statusCols = { 'Sheet1' : 1,
                   'Sheet2' : 2,
                   'Sheet3' : 7  //etc.
                 };

function onEdit(e){
  var cell = e.source.getActiveCell();
  var sheet = cell.getSheet();

  var sheetName = sheet.getName(); 
  var statusCol = statusCols[sheetName];

  /* Whatever code you already have */
} 
```

第二种方法更通用

```
function onEdit(e){   
  var cell = e.source.getActiveCell();   
  var sheet = cell.getSheet();
  var headers= sheet.getDataRange().getValues()[0]; //Assuming headers on the first row only   
  var statusCol = headers.indexOf('Status') + 1 ; // Replace Status by the actual column header 
  /* Your existing code here */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T08:42:46.957

@Srik - 谢谢。

使用第二种方法，我现在拥有以下跨多个选项卡工作的代码：

```
function onEdit(e){   
  var cell = e.source.getActiveCell();   
  var sheet = cell.getSheet();
  var headers= sheet.getDataRange().getValues()[0]; //Assuming headers on the first row only   
  var statusCol = headers.indexOf('Status') + 1 ; // Replace Status by the actual column header 

  var row = cell.getRowIndex();
  var status = cell.getValue();

  // change colors to meet your needs
  var color;
  switch(status ) {
    case "Down":
      color = "RED";
      break;
    case "Up":
      color = "LIME";
      break;
    case "":
      color = "WHITE";
      break;
  }
  sheet.getRange(row + ":" + row ).setBackgroundColor(color);
} 
```

# character-encoding - 分隔符映射字体？

> ID：12360237
> 
> 赞同：1
> 
> 时间：2012-09-10T22:19:31.640
> 
> 标签：character-encoding, fonts, postscript

我的项目正在创建一种字体（或者我可以使用的有点像字体的东西），它将每个*单词*映射到字体中的单个字形。这样做的主要目的是自动生成任意文本的“替代语言”段落，用于 D&D 或在线游戏等。

如果转换器从未遇到过该单词，我已经完成了为单词生成新字符的算法的创建，但是我对如何存储这些字符描述以供以后使用感到困惑。有人知道我可以使用的任何字符映射算法/等可以用于 PostScript 语言字体吗？

PostScript 语言参考手册在这方面没有任何有用的信息。我已经尽我所能在整个互联网上搜索了这样的东西，但是我搜索的所有信息都完全无关紧要。我不确定这种东西会被称为什么，即使只是一个指向如何开始寻找的指针也会非常感激。

如果不存在这样的事情，我将如何实现自定义编码算法来做到这一点？PostScript 语言参考手册对这种可能性做了一些小的参考，但我在这方面的搜索没有找到任何有用的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T14:18:30.900

我认为后记可以做到这一点。postscript 字体包含两个映射：char-code -> glyph-name，glyph-name -> glyph-drawing-commands。您可以使用`glyphshow`运算符绕过字符映射。您可以使用`definefont`. 所以我在想象这样的事情（草稿，未经测试）：

```
/doglyph {
    {
        cvn glyphshow
    } stopped {
        %<-- Reinstall  font with new word here
        glyphshow
    } if
} def

/myshow { % (string of words)
    ( ) {
        search {
            doglyph
        }{
            doglyph exit
        } ifelse
    } loop
} def 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:29:04.557

首先要注意不同语言中单词之间的关系不是1:1的，顺序也会发生变化。例如，“amo”在拉丁语中的意思是“我爱”，一个词而不是两个词。

PostScript 字体通常有 256 个活动字形的限制并且是静态的 - 您可以定义字体，但是在调用 makefont 之后，您不能轻易更改它们，除非通过制作新字体。CID 字体可以有更多，并且可以即时重新排列，尽管并非所有 PostScript 解释器都支持（例如，我认为 GhostScript 不支持，尽管它确实有一些基本的 CID 支持）。

更常用的方法是更改​​文本本身，例如通过 Unicode 和 OpenType 使用不同的脚本。但是，如果您只是希望文本看起来不同，请将一些常见字符（例如英文中的“e”）映射到某些字体中非常细的字体，而在另一些字体中则映射宽，并将其他字体映射到空格，这样就会出现单词长度改变；然后你可以简单地使用看起来不同的常规字体。

# html - 处理由 node.js 提供支持的网站的 html 部分的最佳方式是什么？

> ID：12360239
> 
> 赞同：2
> 
> 时间：2012-09-10T22:19:41.783
> 
> 标签：html, node.js

我刚开始学习 node.js，目前正在学习 www.nodebeginner.com 上的教程。这很好，但我很困惑。在本教程中，节点服务器提供的所有 HTML 代码都被硬编码到服务器中，并包含在 response.write() 调用中。虽然这确实起到了将 HTML 提供给客户的目的，但我认为许多专业人士不会像这样开发他们的网站。那么，有哪些选项（如果有的话）可以让我将我的服务器代码和我的 HTML 页面分开？感谢您提供有关此的任何信息！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T23:00:21.300

您想查看一个与 node.js 一起使用的 Web 框架。

我推荐[Express](http://expressjs.com)，但还有很多其他的，具体取决于您的需要。观看[此](http://nodetuts.com/tutorials/9-express.html#video)视频教程，了解如何开始使用 Express。

# eclipse - eclipse找到两个函数之间可能的代码路径

> ID：12360252
> 
> 赞同：6
> 
> 时间：2012-09-10T22:20:26.150
> 
> 标签：eclipse

我有一个关于日食的问题。也许这是不可能的，但我仍然想与专家确认:) 在我的上下文中，我使用 C.but 可能适用于 java 和其他语言。

说我有一个非常大的项目。我有一个函数 A 和一个函数 B。有没有办法可以判断是否存在从函数 A 到函数 B 或函数 B 的代码路径。比如 A -> D -> C- > E->F- >B

我知道有呼叫heirachy。但我的项目太大了。函数 A 没有直接调用 B。函数 A 被大约 10 个地方调用，另外 100 个调用者调用了 10 个调用者。那么eclipse中是否有一个功能可以淹没代码路径并找到两个函数之间的连接？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-06T03:38:34.523

我不会称这是一种好方法，但它可能对某些人来说是一种有用的方法。首先，您可以创建一个[AutoHotkey](http://www.autohotkey.com/)脚本，如下所示。 `#v`表示`Win+v`触发它的组合键。

```
#v::Send {Right}{Down}{Right}{Down}{Right}{Down}{Right}{Down} 
```

你可能想再重复几次（或者更多次，我做到了）。在 Eclipse 中打开调用层次结构，选择第一个条目，然后按一下`Win+v`展开。全部搞定后（玩得开心），然后您可以右键单击一个条目并选择`Copy Expanded Hierarchy`. 将其粘贴到某处并搜索您要查找连接的其他功能。

如果我找到“真正的”解决方案，我会告诉你的。如果您的项目（是的，我知道这已经很长时间了）大到我的数量级或更多，那么您可能会厌倦 Eclipse 因巨大的树而减速。或者它现在刚刚停止......

# java - 如何在夏令时选择时区的结束时间？

> ID：12360255
> 
> 赞同：0
> 
> 时间：2012-09-10T22:21:17.963
> 
> 标签：java, timezone, timezone-offset

给定一个日期，比如 2013-03-24，我想将其转换为美国/太平洋时区的那一天结束。有没有办法确定该地区特定日期的时区是 PST 还是 PDT？顺便说一句，我正在使用 Java。

我怀疑没有办法做到这一点（至少在不查询某个知道时区转换何时发生的数据库的情况下），但我想我会检查一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:37:59.853

Java 日历会为您处理，无需尝试自己整理时区。

```
DateFormat format = new SimpleDateFormat("yyyy-MM-dd");
Date dateInServerTZ = format.parse("2013-03-24");
Calendar calInServerTZ = Calendar.getInstance();
calInServerTZ.setTime(dateInServerTZ);
Calendar calInPST = Calendar.getInstance(TimeZone.getTimeZone("America/Los_Angeles"));
calInPST.set(Calendar.YEAR, calInServerTZ.get(Calendar.YEAR));
calInPST.set(Calendar.DAY_OF_YEAR, calInServerTZ.get(Calendar.DAY_OF_YEAR));
calInPST.set(Calendar.HOUR_OF_DAY, 23);
calInPST.set(Calendar.MINUTE, 59);
calInPST.set(Calendar.SECOND, 59);
calInPST.set(Calendar.MILLISECOND, 999);
Date endOfDayPST = calInPST.getTime(); 
```

您可以通过解析为 PST 来消除一个步骤，但我觉得这个示例更清楚地说明了服务器时间和用户时间之间的关系发生了什么。

这显然会更有效：

```
DateFormat format = new SimpleDateFormat("yyyy-MM-dd");
format.setTimeZone(TimeZone.getTimeZone("America/Los_Angeles"));
Date dateInPST = format.parse("2013-03-24");
Calendar calInPST = Calendar.getInstance(TimeZone.getTimeZone("America/Los_Angeles")); 
calInPST.setTime(dateInPST);
calInPST.set(Calendar.HOUR_OF_DAY, 23);
calInPST.set(Calendar.MINUTE, 59);
calInPST.set(Calendar.SECOND, 59);
calInPST.set(Calendar.MILLISECOND, 999); 
```

# objective-c - UIButton里面的UIActivityIndi catorView

> ID：12360259
> 
> 赞同：1
> 
> 时间：2012-09-10T22:21:51.113
> 
> 标签：objective-c, ios, xcode, uibutton, uiactivityindicatorview

我有几个以编程方式生成的 UIButton（自定义，200 x 200，白色背景），我想在其中放置一个 UIActivityIndi​​catorView。我尝试使用以下代码：

```
UIActivityIndicatorView *playlistImageLoader = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite];
playlistImageLoader.center = CGPointMake(100, 100);
playlistImageLoader.hidesWhenStopped = YES;

[playlistImage addSubview:playlistImageLoader];
[mainScrollView addSubview:playlistImage];

[playlistImageLoader startAnimating]; 
```

但它没有出现？有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T22:31:43.300

~~您没有设置指示器框架，设置它，将它作为按钮子视图就可以了。~~

尝试使用`UIActivityIndicatorViewStyleGray`-`UIActivityIndicatorViewStyleWhite`在白色背景上是不可见的。

# javascript - 用于从 JS 中的 HTML 标记中删除 id、样式、类属性的正则表达式

> ID：12360268
> 
> 赞同：4
> 
> 时间：2012-09-10T22:22:54.780
> 
> 标签：javascript, regex

我在 javascript 中得到了一个 html 字符串，并使用正则表达式我想删除 html 标签中的 id、style 和 class 属性，例如我有：

```
New York City.<div style="padding:20px" id="upp" class="upper"><div style="background:#F2F2F2; color:black; font-size:90%; padding:10px 10px; width:500px;">This message is.</div></div> 
```

我希望这个字符串变成：

```
New York City.<div><div>This message is.</div></div> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-10T22:57:29.697

您可以利用所有浏览器都提供的 DOM 功能，而不是使用正则表达式解析 HTML（这是一个[坏主意）。](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)我们首先需要能够遍历 DOM 树：

```
var walk_the_DOM = function walk(node, func) {
    func(node);
    node = node.firstChild;
    while (node) {
        walk(node, func);
        node = node.nextSibling;
    }
}; 
```

现在解析字符串并操作 DOM：

```
var wrapper= document.createElement('div');
wrapper.innerHTML= '<!-- your HTML here -->';
walk_the_DOM(wrapper.firstChild, function(element) {
    if(element.removeAttribute) {
        element.removeAttribute('id');
        element.removeAttribute('style');
        element.removeAttribute('class');
    }
});
result = wrapper.innerHTML; 
```

另请参阅[此 JSFiddle](http://jsfiddle.net/pTDX6/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T03:18:56.130

如果您愿意删除除 div 标签名称之外的所有内容 -

```
string=string.replace(/<(div)[^>]+>/ig,'<$1>'); 
```

`<DIV>`如果 html 是大写，这将返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T07:14:35.130

如果您只想删除属性，那么正则表达式是错误的工具。我建议，而不是：

```
function stripAttributes(elem){
    if (!elem) {
        return false;
    }
    else {
        var attrs = elem.attributes;
        while (attrs.length) {
            elem.removeAttribute(attrs[0].name);
        }
    }
}

var div = document.getElementById('test');

stripAttributes(div); 
```

​<a href="http://jsfiddle.net/davidThomas/3fnzn/" rel="nofollow">JS Fiddle 演示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-15T01:36:34.300

我用这个

```
var html = 'New York City.<div style="padding:20px" id="upp"
class="upper"><div style="background:#F2F2F2; color:black; font-size:90%; padding:10px 10px; width:500px;">This message is.</div></div>';

function clear_attr(str,attrs){
    var reg2 = /\s*(\w+)=\"[^\"]+\"/gm;
    var reg = /<\s*(\w+).*?>/gm;
    str = str.replace(reg,function(match, i) {
        var r_ = match.replace(reg2,function(match_, i) {
            var reg2_ = /\s*(\w+)=\"[^\"]+\"/gm;
            var m = reg2_.exec(match_);
            if(m!=null){
                if(attrs.indexOf(m[1])>=0){
                    return match_;
                }
            }
            return '';
        });        
        return r_;
    });
    return str;
}
clear_attr(html,[]); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-15T15:53:34.733

使用正则表达式。这是快速（在生产时间）和容易（在开发时间）。

```
htmlCode = htmlCode.replace(/<([^ >]+)[^>]*>/ig,'<$1>'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-10T22:28:02.763

Trying to parse HTML with regexes will cause problems. [This answer](https://stackoverflow.com/a/1732454/28324) may be helpful in explaining them. If you are using jQuery, you may be able to do something like this:

```
var transformedHtml = $(html).find("*").removeAttr("id").removeAttr("style").removeAttr("class").outerHTML() 
```

For this to work, you need to be using the [outerHTML plugin described here](https://stackoverflow.com/a/2419877/28324).

If you don't want to use jQuery, it will be trickier. These question may have some helpful answers as to how to convert the string to a collection of DOM elements: [Converting HTML string into DOM elements?](https://stackoverflow.com/questions/3103962/converting-html-string-into-dom-elements), [Creating a new DOM element from an HTML string using built-in DOM methods or prototype](https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro). You may be able to loop through the elements and remove the attributes using the built-in [removeAttr](https://developer.mozilla.org/en-US/docs/DOM/element.removeAttribute) function. I don't have the time or motivation to figure out all the details for you.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-10T22:47:26.507

纯脚本解决方案类似于：

```
function removeProperties(markup) {
  var div = document.createElement('div');
  div.innerHTML = markup;
  var el, els = div.getElementsByTagName('*');

  for (var i=0, iLen=els.length; i<iLen; i++) {
    el = els[i];
    el.id = '';
    el.style = '';
    el.className = '';
  }
  // now add elements to the DOM
  while (div.firstChild) {
   // someElement.appendChild(div.firstChild);
  }
} 
```

更通用的解决方案是将属性名称作为额外的参数，或者说一个空格分隔的字符串，然后遍历名称以删除它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-04-02T07:16:42.133

我不知道 RegEx，但我肯定知道 jQuery。

将给定的 HTML 字符串转换为 DOM 元素，对其进行解析并返回其内容。

```
function cleanStyles(html){
    var temp = $(document.createElement('div'));
        temp.html(html);

        temp.find('*').removeAttr('style');
        return temp.html();
} 
```

# delphi - 添加 Tprogressbar 以使用 IdSSLOHandler、IdMessage 和 Idatachmentfile 跟踪事件到 Tidsmtp 的传输时间

> ID：12360269
> 
> 赞同：0
> 
> 时间：2012-09-10T22:23:18.273
> 
> 标签：delphi, smtp, progress-bar, delphi-xe2, indy10

我查看了[http://www.delphigroups.info/2/93/183240.html](http://www.delphigroups.info/2/93/183240.html)，其中 Lee J Coo 给出了一个使用 TidSmtp 和 idmessage 制作电子邮件发送进度跟踪表单的示例。

当我尝试模拟代码时，它发生在它向我发送任何消息之前，我`connection closed gracefully`看到了另一个帖子，其中`Remy Lebeau`建议类似[的需要 Delphi 6 示例，用于在 TIdSmtp 发送操作期间更新进度条，尤其是对于大型附件](https://stackoverflow.com/questions/10611038/need-delphi-6-example-for-updating-a-progress-bar-during-tidsmtp-send-operation)。

我不知道是不是有什么问题`TIdAttachmentFile.Create(Idmessage1.MessageParts,)`

我正在努力解决这个问题，但是查看了使用 savetofile 而不是 savetostream 之类的建议，这件事`connection closed gracefully`似乎很常见，不能对问题提供太多见解，但也许有人可以从经验中看出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T21:57:55.330

正如我在对[另一个问题](https://stackoverflow.com/questions/10611038/need-delphi-6-example-for-updating-a-progress-bar-during-tidsmtp-send-operation)的回答中所说，Indy 10`TIdEventStream`在单元中有一个类`IdGlobal`，您可以使用它来跟踪`TIdMessage.SaveToStream()`编码的字节数，而无需浪费任何内存或文件系统空间。单位中还有一个私人`TIdCalculateSizeStream`班级`IdMultipartFormDataStream`做同样的事情。您可以将该类复制到您的项目代码中。

如果您在使用任一类时遇到问题，您需要提供具体的详细信息。

话虽如此，您应该在连接到 SMTP 服务器之前对电子邮件进行“编码”以获得其估计大小，而不是在连接之后。如果编码需要一段时间，则 SMTP 服务器可能会超时并在您有机会调用`Send()`以传输电子邮件之前关闭连接（这将再次对其进行重新编码，并且与第一个临时编码）。

# c# - 当我转向依赖注入时使用语句会发生什么

> ID：12360271
> 
> 赞同：25
> 
> 时间：2012-09-10T22:23:23.580
> 
> 标签：c#, dependency-injection, ninject

我目前正在使用以下代码：

```
public class MyProvider
{
    public MyProvider()
    {
    }

    public void Fetch()
    {
        using (PopClient popClient = new PopClient())
        {
            ....
        }
    }
} 
```

因为我希望能够对 Fetch 方法进行单元测试，并且由于我无法模拟 PopClient，所以我创建了一个接口和一个调用 PopClient 的包装类。我更新的代码如下所示：

```
public class MyProvider
{
    private readonly IPopClient popClient;

    public MyProvider(IPopClient popClient)
    {
        this.popClient = popClient;
    }

    public void Fetch()
    {
        using (var pop3 = popClient)
        {
            ....
        }
    }
} 
```

我正在使用 Ninject 进行依赖注入，我不太确定 using 语句在更新的代码中会产生什么样的影响，因为 Ninject 已经创建了 PopClient 的一个实例并将其注入到构造函数中。

using 语句会处理 pop3 对象并单独保留 popClient 对象以便 Ninject 可以处理它，还是 using 语句会干扰 Ninject？

在这种情况下，正确的方法是什么？任何见解都会非常有帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-10T22:31:26.790

该`pop3`变量将被赋予对具有的`IPopClient`对象的相同引用`popClient`，因此当`using`语句结束时，本地变量和实例变量所引用的对象都将是 Dispose()d，可能会将其置于不一致的状态以供进一步使用。

如果你想使用多个实例`IPopClient`，每次`Fetch()`调用一个，你应该做的是注入一个“工厂方法”：

```
public class MyProvider
{
    private readonly Func<IPopClient> createPopClient;

    public MyProvider(Func<IPopClient> popClientFactory)
    {
        this.createPopClient = popClientFactory;
    }

    public void Fetch()
    {
        using (var pop3 = createPopClient())
        {
            ....
        }
    }
} 
```

现在，当您调用 时`Fetch()`，它将执行工厂方法，该方法将返回对 an 的新引用`IPopClient`，可以使用然后将其处理掉，而不会影响对该方法的任何其他调用。

AutoFac 支持为已注册的类型注入工厂方法，无需任何额外设置（我认为这就是它的名字）；我相信在配置 Ninject 容器时，您需要显式注册“getter”作为给定返回类型的工厂方法（可以像 lambda 一样简单，`()=>new PopClient()`也可以使用对容器解析方法的调用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:26:04.407

设置绑定时，声明范围：

[https://github.com/ninject/ninject/wiki/Object-Scopes](https://github.com/ninject/ninject/wiki/Object-Scopes)

Ninject 将对它为您创建的对象调用 dispose，因此请确保在您提供给 Ninject 处理的任何对象中编写您的 dispose 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-30T15:43:19.670

我喜欢@KeithS 的答案，但我想添加一些更新`ConfigureServices`，包括 .NET Core 依赖注入和`MailKit.Net.Smtp`.

[https://docs.microsoft.com/en-us/dotnet/core/extensions/dependency-injection](https://docs.microsoft.com/en-us/dotnet/core/extensions/dependency-injection)

鉴于以下课程：

```
public class MailService
{
    private readonly SmtpSettings _settings;
    private readonly Func<ISmtpClient> _smtpClientFactory;

    public MailService(SmtpSettings settings, Func<ISmtpClient> smtpClientFactory)
    {
        _settings = settings;
        _smtpClientFactory = smtpClientFactory;
    }

    public async Task SendEmailAsync(string to, string subject, MimeEntity body, CancellationToken cancellationToken = default)
    {
        var message = new MimeMessage();
        message.From.Add(MailboxAddress.Parse(_settings.UserName));
        message.To.Add(MailboxAddress.Parse(to));
        message.Subject = subject;
        message.Body = body;

        using (var smtpClient = _smtpClientFactory())
        {
            await smtpClient.ConnectAsync(_settings.Server, _settings.Port, SecureSocketOptions.StartTls, cancellationToken);
            await smtpClient.AuthenticateAsync(_settings.UserName, _settings.Password, cancellationToken);
            await smtpClient.SendAsync(message, cancellationToken);
            await smtpClient.DisconnectAsync(true, cancellationToken);
        }
    }
} 
```

它可以像这样添加到`ConfigureServices(IServiceCollection services)`：

```
services.AddTransient<ISmtpClient, SmtpClient>();
services.AddSingleton(provider =>
                 new Func<ISmtpClient>(() => provider.GetService<ISmtpClient>())); 
```

Azure 函数的完整`Program.cs`示例：

```
public static void Main()
{
    var host = new HostBuilder()
        .ConfigureFunctionsWorkerDefaults()
        .ConfigureAppConfiguration((hostContext, builder) =>
        {
            if (hostContext.HostingEnvironment.IsDevelopment())
            {
                builder.AddJsonFile("local.settings.json");
                //This will override any values added to local.settings.json - We will however follow the recommended approach for keeping secrets in dev 
                //https://docs.microsoft.com/en-us/aspnet/core/security/app-secrets?view=aspnetcore-5.0&tabs=windows#register-the-user-secrets-configuration-source
                //builder.AddJsonFile("secret.settings.json");
                builder.AddUserSecrets<Program>();
            }

        })
        .ConfigureServices((hostContext, services) =>
        {
            var connectionString = hostContext.Configuration.GetConnectionString("DefaultConnection");
            services.AddDbContext<ApplicationDbContext>(options =>
                    options.UseSqlServer(
                    connectionString,
                    sqlServerOptions => sqlServerOptions.CommandTimeout(600)));

            services.AddHttpClient();

            var configuration = hostContext.Configuration;

            var smtpSettings = new SmtpSettings();
            configuration.Bind("Smtp", smtpSettings);
            services.AddSingleton(smtpSettings);

            services.AddTransient<ISmtpClient, SmtpClient>();

            services.AddSingleton(provider =>
                 new Func<ISmtpClient>(() => provider.GetService<ISmtpClient>()));

            services.AddTransient<MailService>();
        })
        .Build();

    host.Run();
} 
```

`Func<T>`注册和解决的来源：

[https://stackoverflow.com/a/43763284/3850405](https://stackoverflow.com/a/43763284/3850405)

# jquery - 使用 Richfaces JQuery 突出显示选择

> ID：12360273
> 
> 赞同：4
> 
> 时间：2012-09-10T22:23:27.523
> 
> 标签：jquery, jakarta-ee, jsf-2, richfaces

我试图突出显示丰富的选择：dataGrid。就像当我点击dataGrid中的链接时，会打开一个modalPanel供用户选择图像，当modalPanel关闭时，新选择的图像将在dataGrid中刷新。为此，我正在从 modalPanel 重新渲染 dataGrid。这工作正常。现在，我想突出显示用户选择。当我使用下面的rich:jquery 时，它会突出显示，但随后会弹出modalPanel 并重新渲染。所以突出显示的行转到它的原始自我。

JSF：

```
<rich:dataGrid value="#{startupBean.choiceKeys}" var="mapEntry" columns="#{startupBean.rowSize}" styleClass="rich-table">

                                 <rich:dataGrid id="choiceSub" styleClass="rich-table" value="#{mapEntry.value}" var="ObjBO" columns="2">
                                       <f:facet name="header">
                                          <h:outputText value="Choice:#{mapEntry.key}"></h:outputText>
                                       </f:facet>
                                 <h:panelGrid columns="2" border="0" styleClass="className">
                                 <rich:panel>
                                     <f:facet name="header">
                                     <a4j:commandLink id="objs"  action="#{startupBean.getCategory}" reRender="materialTree" oncomplete="Richfaces.showModalPanel('selectMaterial',{top:'100px', left:'400px', height:'450px', width:'450px'});" >
                                        <h:outputText value="#{ObjBO.displayName}" binding="#{startupBean.outTxt}"/>
                                            <f:setPropertyActionListener target="#{startupBean.key}" value="#{mapEntry.key}" />
                                        </a4j:commandLink>   
                                     </f:facet>
                                        <h:graphicImage width="50" height="50" id="choice"  alt="jsf-sun" url="#{ObjBO.color_url}" value="#{ObjBO.color_url}"> 
                                        </h:graphicImage>
                                        </rich:panel> 
                                 </h:panelGrid>
                                 </rich:dataGrid>
                                 <rich:jQuery selector="#choiceSub tr" query="click(function(){jQuery(this).addClass('active-row')})"/>
                        </rich:dataGrid> 
```

CSS：

```
.active-row {
    background-color: red;
} 
```

还有其他方法吗？请务必让我知道。

PS：我正在使用 JSF2.0、Richfaces 3.2、Apache Tomcat 7、Java 1.7。

谢谢，简

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T21:29:13.317

当你重新渲染一个元素时，它会被服务器生成的新内容所取代。即，以前动态应用的任何附加格式或更改（如rich:jQuery 中的jQuery 所做的那样）都将丢失。另请参阅丰富的问题​​描述：jQuery 手册[http://docs.jboss.org/richfaces/latest_3_3_X/en/devguide/html/rich_jQuery.html](http://docs.jboss.org/richfaces/latest_3_3_X/en/devguide/html/rich_jQuery.html)。

基本上，您必须在 ajax 返回后再次应用行突出显示。如果您需要更多说明，请发表评论。

# ios - 带有加速度计的 iOS 滑动距离

> ID：12360274
> 
> 赞同：3
> 
> 时间：2012-09-10T22:23:31.567
> 
> 标签：ios, accelerometer, distance, physics-engine

我正在尝试使用加速度计测量设备滑动的距离。这就是我的做法：

```
- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration {
    CGFloat interval = [NSDate timeIntervalSinceReferenceDate] - lastTime;

    CGFloat velocity = ((acceleration.y + lastAcceleration) / 2) * interval * 9.8 + lastVelocity;

    totalDistance += velocity * interval;

    lastAcceleration = acceleration.y;
    lastVelocity = velocity;

    lastTime = [NSDate timeIntervalSinceReferenceDate];
} 
```

结果非常不稳定，范围为实际值的 +/- 30%。我的计算是否正确，如果是，我怎样才能使这段代码更准确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T10:12:37.997

您可以通过对结果应用过滤器来消除硬件的一些不准确之处。

这是一个对值进行快速傅立叶变换的库。

[http://sourceforge.net/projects/kissfft/](http://sourceforge.net/projects/kissfft/)

# python - sqlite3 命令行工具在 Ubuntu 中不起作用

> ID：12360279
> 
> 赞同：1
> 
> 时间：2012-09-10T22:23:51.427
> 
> 标签：python, linux, sqlite, ubuntu

尝试在 python 中设置一些从本地 sqlite 数据库读取和写入的基本数据 I/O 脚本。我想使用命令行来验证我的脚本是否按预期工作，但它们不会处理我正在创建的任何数据库或表。

我的第一个脚本将 dict 中的一些数据写入表中，第二个脚本读取并打印它。

写：

```
# 脚本的第一部分创建一个名为 'totals' 的字典

将 sqlite3 导入为 lite

con = lite.connect('test.db')

与骗局：
    cur = con.cursor()

    cur.execute("如果存在 testtbl 则删除表")    

    cur.execute("CREATE TABLE testtbl(Date TEXT PRIMARY KEY, Count INT, AverageServerTime REAL, TotalServerTime REAL, AverageClientTime REAL, TotalClientTime REAL)")
    cur.execute('INSERT INTO testtbl VALUES("2012-09-08", %s, %s, %s, %s, %s)' % (float(totals['count()']), float(总计['serverTime/count()'])、float(totals['serverTime'])、float(totals['totalLoadTime/count()'])、float(totals['totalLoadTime'])))

```

读：

```
将 sqlite3 导入为 lite

con = lite.connect('test.db')

与骗局：    

    cur = con.cursor()    
    cur.execute("SELECT * FROM testtbl")

    行 = cur.fetchall()

    对于行中的行：
        打印行

```

These scripts are separate and both work fine. However, if I navigate to the directory in the command line and activate sqlite3, nothing further works. I've tried '.databases', '.tables', '.schema' commands and can't get it to respond to this particular db. I can create dbs within the command line and view them, but not the ones created by my script. How do I link these up?

Running stock Ubuntu 12.04, Python 2.7.3, SQLite 3.7.9\. I also installed libsqlite3-dev but that hasn't helped.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:37:04.593

Are you putting the DB file name in the command ?

`$ sqlite3 test.db`

# python - PyUSB - OS X 10.7.4 上的“usb_claim_interface：无法声明接口”错误

> ID：12360282
> 
> 赞同：3
> 
> 时间：2012-09-10T22:24:23.733
> 
> 标签：python, usb, libusb, pyusb

确切的错误是：usb.core.USBError: [Errno None] usb_claim_interface: could't claim interface

我正在使用 pydev 1.0（带有 libusb 1.0.9）与传感器接口。我试过摆弄各种东西，但没有运气（以root身份运行我的代码不会改变任何东西）。我的代码检测到该设备，但在我尝试从中读取时死掉了。我已经看到其他 mac 用户报告了同样的问题，但我还没有找到答案:(

```
device = usb.core.find(idVendor = vendorId, idProduct = productId)
device.set_configuration()
cfg = device.get_active_configuration()
interface_number = cfg[(0,0)].bInterfaceNumber
alternate_setting = usb.control.get_interface(device, interface_number)

# Get Interface Descriptor
intf = usb.util.find_descriptor(
    cfg, 
    bInterfaceNumber = interface_number,
    bAlternateSetting = alternate_setting
)

# Get Endpoint Descriptor
ep = usb.util.find_descriptor(
    intf,
    custom_match = \
    lambda e: \
        usb.util.endpoint_direction(e.bEndpointAddress) == \
        usb.util.ENDPOINT_IN
)

assert ep is not None

# Tried this but didn't help :/
# usb.util.claim_interface(device, intf)

size = 2
print str(device.read(0x82, size)) 
```

# variables - Whats wrong with kohana's view variable scope?

> ID：12360291
> 
> 赞同：0
> 
> 时间：2012-09-10T22:25:30.050
> 
> 标签：variables, view, kohana, scope

To quickly summarize my problem, I simply copied the example of ([http://php.net/manual/en/language.variables.scope.php](http://php.net/manual/en/language.variables.scope.php)) into one of my views and wondered why it was nothing echoed on my screen.

Here the example of php.net:

```
<?php
$a = 1;
$b = 2;

function Sum()
{
    global $a, $b;

    $b = $a + $b;
} 

Sum();
echo $b;
?> 
```

I expected '3' on my screen but $b returned still '2'.. Well I tested this behavior about 3 hours with different examples and it seems that kohana does some tricky things. I thought Kohana only extracts the View::_data into the local scope and everything would be ok but now I have no clue about it.

Could somebody explain me that behaviour?

[How can I wrap PHP legacy code in Kohana?](https://stackoverflow.com/questions/6667112/how-can-i-wrap-php-legacy-code-in-kohana) couldn't help me..

Btw, sorry for my language mistakes!

**UPDATE:**

I know using globals is bad but my clean approach didn't work yesterday.. But now I don't know why everything works again, maybe there was a caching problem.

But besides that I understood the mistake of my given example, thank you. Seems that it has nothing to do with output buffering..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:27:39.747

您可能不在全球范围内。所以所有的变量都应该在前面加上`global`like

```
<?php
global $a = 1;
global $b = 2;

function Sum()
{
    global $a, $b;

    $b = $a + $b;
} 

Sum();
echo $b;
?> 
```

PS：全局变量是万恶之源。没有它们，一切都可以而且应该实现。

# jquery - 如何在一个 DOM 元素上绑定许多不同的点击功能？

> ID：12360296
> 
> 赞同：0
> 
> 时间：2012-09-10T22:26:17.043
> 
> 标签：jquery, events

在我的页面中，我定义了一组具有相同点击事件的 DOM 元素（其中一些是动态加载的）

```
$('div.main-container a.class1, a.class2').live('click',function(){ ... }); 
```

该元素具有自己的功能`a.class1`，在这种情况下，我的组功能不会触发。那么，是否可以将两个不同的函数绑定到一个 DOM 元素？`a.class2``click``click``click`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:30:30.773

将您需要的所有相关处理程序组合到一个函数中，并将所有点击事件绑定到如下内容：

```
function ()
{
    handler1();
    handler2();
    handler3();
} 
```

干杯

# javascript - 如何使用 JSON 字符串中的 jQuery 填充下拉框？

> ID：12360298
> 
> 赞同：0
> 
> 时间：2012-09-10T22:26:23.700
> 
> 标签：javascript, jquery, json

我有一个 json 对象存储为 JavaScript 字符串 var，其中包含用于填充下拉框的名称和值，例如 #dropdown。我的问题是，如何将每个元素作为值/标签对访问并将它们放入下拉列表中？

json 字符串如下所示：

```
[{"name":"Name1","value":"Val1"},{"name":"Name2","value":"Val2"}] 
```

这是否需要以任何方式进一步解析？

我尝试了类似的东西（但没有奏效）......

```
$(json).map(function () {
     return $('<option>').val(this.value).text(this.name);
  }).appendTo('#copy_input'); 
```

我需要以什么方式进一步格式化我的 json 以便能够轻松地迭代和填充下拉列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:32:12.857

你可以试试下面看看这是否有效？

```
$(json).map(function () {
    var elem = $('<option>').val(this.value).text(this.name)
    elem.appendTo('#copy_input');
    return 0; // dummy statement. You should be able to skip this statement too.
}); 
```

# linux - OpenGL Linux 不读取 GL_VERSION

> ID：12360301
> 
> 赞同：2
> 
> 时间：2012-09-10T22:26:58.510
> 
> 标签：linux, opengl, sdl, nvidia, mesa

我有一个在 Linux 上使用 SDL 的简单 OpenGL 程序，它只是尝试加载和打印 OpenGL 版本。

```
cout << "GL_VERSION  : " << glGetString(GL_VERSION) << endl; 
```

当我运行程序时它只是挂起，输出如下......它基本上似乎在“等待”OpenGL库响应：

```
GL_VERSION  : 
```

它与 Nvidia Ubuntu OpenGL 库 (nvidia-current-dev pkg) 链接。我也确实在系统上安装了 Mesa，但正如您从“lsof”中看到的，它似乎正在使用 Nvidia。

```
sdl-hack 29491 x  mem    REG               8,18 34639056 4212198 /usr/lib/nvidia-current/libnvidia-glcore.so.295.40
sdl-hack 29491 x  mem    REG               8,18    11728 4212207 /usr/lib/nvidia-current/tls/libnvidia-tls.so.295.40
sdl-hack 29491 x  mem    REG               8,18  1054832 4212209 /usr/lib/nvidia-current/libGL.so.295.40 
```

请注意，我确实必须安装“libglu1-mesa-dev”来提供 glu.h，因为这不是 Nvidia dev pkg 的一部分。

不太确定如何调试这个，有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:54:05.497

不要在通话`SDL_OPENGL`中与其他标志混合。`SDL_SetVideoMode()`好吧，您可以使用`SDL_FULLSCREEN`，但不需要`SDL_HWSURFACE`.

特别是，`SDL_GL_DOUBLEBUFFER`不以这种方式使用。打算做：

```
SDL_GL_SetAttribute(SDL_GL_DOUBLEBUFFER, 1);
SDL_SetVideoMode(640, 480, 32, SDL_OPENGL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T19:50:21.943

在终端中输入*glxgears*会发生什么？如果没有弹出显示齿轮旋转的窗口，则说明您的安装有问题。

如果您确实看到一个齿轮旋转的窗口，则说明您没有按照 Nicol Bolas 的建议正确初始化 OpenGL 上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T13:41:42.370

我解决了这个问题。我按照以下链接中的代码获取了初始工作版本：

[http://www.sdltutorials.com/sdl-opengl-tutorial-basics](http://www.sdltutorials.com/sdl-opengl-tutorial-basics)

文章记录了一些 set 属性调用：

```
SDL_GL_SetAttribute(SDL_GL_RED_SIZE,        8);
SDL_GL_SetAttribute(SDL_GL_GREEN_SIZE,      8);
SDL_GL_SetAttribute(SDL_GL_BLUE_SIZE,       8);
SDL_GL_SetAttribute(SDL_GL_ALPHA_SIZE,      8);

SDL_GL_SetAttribute(SDL_GL_DEPTH_SIZE,      16);
SDL_GL_SetAttribute(SDL_GL_BUFFER_SIZE,        32);

SDL_GL_SetAttribute(SDL_GL_ACCUM_RED_SIZE,    8);
SDL_GL_SetAttribute(SDL_GL_ACCUM_GREEN_SIZE,    8);
SDL_GL_SetAttribute(SDL_GL_ACCUM_BLUE_SIZE,    8);
SDL_GL_SetAttribute(SDL_GL_ACCUM_ALPHA_SIZE,    8);

SDL_GL_SetAttribute(SDL_GL_MULTISAMPLEBUFFERS,  1);
SDL_GL_SetAttribute(SDL_GL_MULTISAMPLESAMPLES,  2); 
```

这些是在 SDL_Init 之后但在 SDL_SetVideoMode 调用之前。删除它们使程序运行良好！

奇怪的是，这个问题只发生在具有 Mesa 和 Nvidia GL 库的 Linux 上。Mac OSX 很好。

# javascript - Using ryanfait.com custom form elements with .net autopostback

> ID：12360302
> 
> 赞同：1
> 
> 时间：2012-09-10T22:27:01.020
> 
> 标签：javascript, asp.net, .net

I am using ryanfait.com custom form elements to change the appearance of my dropdown lists in my .net web application. Everything works fine except for .net postbacks on dropdown lists. Having looked at the javascript code for custom work elements I have noticed that the onchange event is overwritten:

```
 if(!inputs[a].getAttribute("disabled")) {
    inputs[a].onchange = Custom.choose;
    } else {
    inputs[a].previousSibling.className = inputs[a].previousSibling.className += " disabled";
    } 
```

If I comment out the above code the autopostback works but for other dropdownlists which do not require an autopostback the input value now does not change. Is there a way I can get this working for both scenarios? On ryanfait.com he says:

onChange and other JavaScript events This script utilizes JavaScript's onChange and other events. Because these events can only be used once, if you want to add more functions to an event, you will need to call them from inside my script.

But I can't work out if I can somehow trigger the autopostback event?

Any help would be very much appreciated!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-25T10:31:00.613

最简单的方法是添加带有自动回发功能的标准 asp:dropdownlist，预览页面然后查看源代码，在 HTML 源代码中找到列表并复制 onChange 属性。这是您需要调用客户端才能将页面发回的内容。

例如。

```
onchange="javascript:setTimeout(&#39;__doPostBack(\&#39;ddlHolidayType\&#39;,\&#39;\&#39;)&#39;, 0)" 
```

# php - ORDER BY 在 postgresql 中不工作

> ID：12360303
> 
> 赞同：1
> 
> 时间：2012-09-10T22:27:02.373
> 
> 标签：php, postgresql

这不起作用，并且由于某种原因我从 ORDER BY 参数中收到错误？

```
if($selected_radio == 'city')
{
    $query = "SELECT name FROM City WHERE name LIKE $1 LIMIT $2 OFFSET $3 ORDER BY name ASC";
    $result = pg_prepare($conn, "findCity", $query);
    $result = pg_execute($conn, "findCity", array($text, $limit, $offset));

    while($row = pg_fetch_assoc($result))
    {
        echo "<tr>";
        echo "<td>" . $i . "</td>";
        echo "<td>" . $row['name'] . "</td>";
        echo "</tr>";
        $i += 1;
    }
} 
```

抱歉，我对这个网站还很陌生，不知道如何正确发布代码：/

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T22:31:18.727

您的子句[顺序错误](http://www.postgresql.org/docs/8.2/static/sql-select.html)- ORDER BY 在 LIMIT 和 OFFSET 之前。

从文档：

```
SELECT [ ALL | DISTINCT [ ON ( expression [, ...] ) ] ]
     * | expression [ AS output_name ] [, ...]
     [ FROM from_item [, ...] ]
     [ WHERE condition ]
     [ GROUP BY expression [, ...] ]
     [ HAVING condition [, ...] ]
     [ { UNION | INTERSECT | EXCEPT } [ ALL ] select ]
     [ ORDER BY expression [ ASC | DESC | USING operator ] [, ...] ]
     [ LIMIT { count | ALL } ]
     [ OFFSET start ]
     [ FOR { UPDATE | SHARE } [ OF table_name [, ...] ] [ NOWAIT ] [...] ] 
```

# eclipse - 在 Mac Lion 上运行 eclipse juno 64 位的问题

> ID：12360304
> 
> 赞同：10
> 
> 时间：2012-09-10T22:27:22.063
> 
> 标签：eclipse, macos, osx-lion

对不起我的愚蠢问题，但我只是没有让 eclipse juno 运行......

这里是错误报告：

> 进程：eclipse [10355] 路径：
> /Applications/eclipse/Eclipse.app/Contents/MacOS/eclipse 标识符：
> eclipse 版本：??? (???) 代码类型：X86-64（本机）父进程：bash [10309]
> 
> 日期/时间：2012-09-10 23:11:26.871 +0100 操作系统版本：Mac OS X 10.7.4 (11E53) 报告版本：9
> 
> 崩溃的线程：0 调度队列：com.apple.main-thread
> 
> 异常类型：EXC_BAD_ACCESS (SIGSEGV) 异常代码：KERN_INVALID_ADDRESS at 0x000000000000003c
> 
> 0x3c 附近的 VM 区域：--> __TEXT 0000000100000000-0000000100004000 [16K] rx/rwx SM=COW /Applications/eclipse/Eclipse.app/Contents/MacOS/eclipse
> 
> 应用程序特定信息：objc[10355]：垃圾收集已关闭
> 
> 线程0崩溃::调度队列：com.apple.main-thread 0 com.apple.corefoundation 0x0000007FF8D0F8D0F7AEF CFBUNDLEGETFUNGETFUNCTINFUNCTINPOInterForname
> + 31 1 Eclipse + Eclipse 0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 个
> 
> +线程 1:: 调度队列：com.apple.libdispatch-manager 0
> libsystem_kernel.dylib 0x00007fff8fd6e7e6 kevent + 10 1
> libdispatch.dylib 0x00007fff8f90d78a _dispatch_mgr_invoke + 923 2 libdispatch.dylib 0x00007fff_mgr_thread_c31_p
> 
> 螺纹0坠毁与X86线程状态（64位）：RAX：0xe1bfa23753d57bd3 RBX：0x0000000100200ad0 RCX：0x0000000000000000 RDX：0x0000000000000000 RDI：0x0000000000000000 RSI：0x0000000100200ad0 RBP：0x00007fff5fbff9b0 RSP：0x00007fff5fbff590 R8：0x000000000000000f R9：0x000000000000000a R10：0x0000000000064000 R11：0x00007fff8d0f7ad0
> R12 ：0x00000001000043f8 R13：0x00000001002007f0 R14：0x00007fff5fbffbc8 R15：0x00007fff5fbffbc8 RIP：0x00007fff8d0f7aef RFL：0x0000000000010206 CR2：0x000000000000003c逻辑CPU：1

部分删除...

> 外部修改摘要：其他进​​程针对此进程进行的调用：task_for_pid：1 thread_create：0 thread_set_state：0 此进程进行的调用：task_for_pid：0 thread_create：0 thread_set_state：0 本机上所有进程的调用：task_for_pid：16727 thread_create ：7 线程集状态：10414
> 
> VM 区域摘要： 库的只读部分：总计=140.5M 驻留=68.1M(49%) swapped_out_or_unallocated=72.3M(51%) 可写区域：总计=29.1M 已写入=424K(1%) 驻留=644K(2%) swapped_out=0K(0%) 未分配=28.5M(98%) 区域类型
> 虚拟 =========== ======= MALLOC 20.3M MALLOC 保护页面 32K STACK GUARD 56.0M 堆栈 8712K VM_ALLOCATE 32K __CI_BITMAP 80K __DATA 12.1M __IMAGE 528K __LINKEDIT 47.8M __TEXT 92.7M __UNICODE 544K 共享内存 308K =========== ======= 总计 238.9M

如果有人可以帮助我，那就太好了。

非常感谢您的帮助。

问候

安瑟伦

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-11T10:26:24.343

发现了问题...我使用 Unarchiver 解压缩包...似乎有一个错误...当我使用另一个程序解压缩它时它起作用了:-)

这里的eclipse链接作为参考：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=305758](https://bugs.eclipse.org/bugs/show_bug.cgi?id=305758)

# html - Browser dimming list element when some child elements are selected but not for one of them

> ID：12360308
> 
> 赞同：1
> 
> 时间：2012-09-10T22:28:19.630
> 
> 标签：html, uiwebview, mobile-safari

Given the following html structure:

```
 <ul>
      <li id = "li1" onclick="click('...');">
    <div class="card-container">
      <div class="card">
        <div class="front">
            <img class = "track_image" src="..." />
        <div class = "track_title">title</div>
        <div class = "artist_name">name</div>
        <div class = "release_date">date</div>
        <a  class = "visit_website_anchor" href="..."><img id = "visit_website" data-displayed="yes" src=.../></a>
        </div>
        <div class="back" data-displayed = "no">
          <img class = "track_image" src=... />
          <div class = "audio_controls">
        <audio controls></audio>
          </div>
        </div>
      </div>  
    </div>
      </li>
    </ul> 
```

Then if I click anywhere on the list item apart from the images then it gets displayed in a dimmed state, I'm not adding this so the browser is adding it. However if I click on the track_image class the list item does not get dimmed. Why does it do it for the other items but not for this one?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T09:17:42.497

父`<LI>`元素有一个`onClick`处理程序，当用户在 webkit 浏览器中单击它时，它将改变它的行为，尝试对其应用以下样式：

```
-webkit-tap-highlight-color: rgba(0,0,0,0); 
```

来自[Apple 开发者库](http://developer.apple.com/library/safari/#documentation/appleapplications/reference/safaricssref/articles/standardcssproperties.html)：

> “覆盖当用户在 iPhone 上的 Safari 中点击链接或 JavaScript 可点击元素时显示的突出显示颜色。
> 
> 如果指定，此属性服从 alpha 值。如果您不指定 alpha 值，iPhone 上的 Safari 会为颜色应用默认的 alpha 值。要禁用点击突出显示，请将 alpha 值设置为 0（不可见）。如果将 alpha 值设置为 1.0（不透明），则点击时元素不可见。”

# gamekit - 是否可以从 GKAchievementDescription 加载图像？

> ID：12360312
> 
> 赞同：0
> 
> 时间：2012-09-10T22:28:33.063
> 
> 标签：gamekit, achievements

我正在使用这种方法来加载所有成就描述。

```
[GKAchievementDescription loadAchievementDescriptionsWithCompletionHandler:
 ^(NSArray *descriptions, NSError *error) {
     CCLOG(@"achivements loaded");
     if (error != nil) {
         NSLog(@"Error %@", error);

 } else {
     if (descriptions != nil){
         CCLOG(@"nb %i",descriptions.count);
         for (GKAchievementDescription* a in descriptions) {
             CCLOG(@"image %@ %@ %@", a.title, a.achievedDescription, a.image);
             [achievementsDescDictionary setObject: a forKey: a.identifier];
         }
     } else {
         CCLOG(@"descriptions empty");
     }
     }
 }]; 
```

我总是得到 a.image = null。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T11:12:41.357

实际上，您无法从 Game Center 加载图像。

只需将您的成就图像添加到您的项目中，然后将此方法与 GKAchievementHandler 一起使用

```
- (void)notifyAchievementTitleAndImage:(NSString *)title andMessage:(NSString *)message withImage:(UIImage *)image 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-26T10:31:21.647

如果您无法从游戏中心加载图像，那么如何创建一个用于映射“成就图像”的 plist 文件？我在我的游戏中使用了这种类似于 3-in-row 的技术来定义各种类型的块

# html - 悬停显示多个兄弟姐妹

> ID：12360315
> 
> 赞同：0
> 
> 时间：2012-09-10T22:28:39.860
> 
> 标签：html, css

我正在尝试创建一个简单的下拉菜单，它隐藏子菜单锚点，直到将主菜单锚点悬停在上面。

**html 标记**

```
 <ul>
    <li><a href=".">1</a></li>
    <li><a href=".">2</a></li>
    <li>
       <a href=".">3</a>
       <a href=".">3.1</a>
       <a href=".">3.2</a>
    </li>
 </ul> 
```

**CSS 样式**

```
 <style>
    ul li a:nth-child(n+2){
       display:none;
    }

    ul li a:nth-child(n+2):hover{
       display:block;
    }

    ul li a:hover + a:nth-child(n+2) {
       display: block;
    }
</style> 
```

目前，当我需要它能够显示子菜单 3.2....3.n 的所有其他锚点时，这只显示子菜单的第一个锚点（3.1），我该如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:04:32.610

你应该使用这个：

HTML：

```
<ul id="container">
    <li><a href=".">1</a></li>
    <li><a href=".">2</a></li>
    <li><a href=".">3</a>
        <ul>
            <li><a href=".">3.1</a></li>
            <li><a href=".">3.2</a></li>
        </ul>
    </li>
</ul> 
```

CSS：

```
#container>li>ul{
   display:none;
}

#container>li:hover>ul{
   display:block;
} 
```

**演示**：http: [//jsfiddle.net/Tx4z7/](http://jsfiddle.net/Tx4z7/)

您还可以在子菜单中添加一个填充：

```
#container>li>ul{
    padding-left:20px;
} 
```

**演示**：http: [//jsfiddle.net/Tx4z7/1/](http://jsfiddle.net/Tx4z7/1/)

# python - how to return an excel sheet and a string response using httpresponse Django Python

> ID：12360317
> 
> 赞同：0
> 
> 时间：2012-09-10T22:28:55.413
> 
> 标签：python, django, excel, httpresponse

I am currently returning a response page as a string but I also want to pass it as an excel file. I am having trouble doing both.

This is my views.py file:

```
response = HttpResponse(htmlString)
response = HttpResponse(mimetype='application/vnd.ms-excel')
response['Content-Disposition'] = 'attachment; filename=example1.xls'
book.save(response)    

return response 
```

This only gives me the excel file and not the HtmlString which is because I am reassigning response but I dont know how to include both paramaters.

THanks in advance!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:59:22.617

HTTP 响应（如在 HTTP 协议中，不限于 Django）将被浏览器视为文件或显示在浏览器中（html、纯文本等）。您不能同时返回响应。

# html - 做不需要的 'back-ups' create http rquests? If using let's say  the back up image (here the png) doesn't c 问问题 问问题 2012-09-10T22:28:57.147 25 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. If using let's say  the back up image (here the png) doesn't create a second http request or does it? My doubt comes from using a couple of testing sites, like the www.pingdom.com full page test for speed, each reserve image was listed as causing an extra http request. Is this the case? EDIT I've been looking into this, and I'd like confirmation or even better a way to avoid these possibly useless requests, but it seems that yes back-up objects do require HTTP requests, the browser distinguishes the resources but the HTTP doesn't, it just gets them and tells the browser "Sort this lot out." Hmmm... I can't see a way around this (I have 20+ svgs on some pages, pages that i'd like to be as small as poss for mobile), i'll have to make those with non-svg browsers click twice rather than make everyone else have a slower experience.... HTTP requests are created by each back up or primary, the browser will then handle your html. htmlhttp 4 1 回答 1 This answer is useful 0 HTTP 请求由每个 备份或主创建，然后浏览器将处理您的 html。 于 2012-09-11T10:01:51.357 回答 Related 1 php - 为图像 GD 添加额外空间 1 eclipse - Eclipse插件拖放 1 xml - AS3 XML Looping，抓取属性和子项 2 web-services - 处理发布到 Nodejs 服务器的 JSON 消息数组的最佳方法是什么？ 5 sql - 获得一周内所有不同的总和 2 facebook - Cordova Facebook Connect - 无法获取用户 ID 2 visual-studio-2010 - 发布 SQL Data Tools 2012 项目：强制进入单用户模式 1 vb6 - VB6 中的 Form_Paint 和 AutoRedraw 2 extjs - PDF 在窗口中显示 1 javascript - 如何从 Chrome 扩展程序发送更长的电子邮件？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：12360318
> 
> 赞同：0
> 
> 时间：
> 
> 标签：html, http

If using let's say

```
<object type="image/svg+xml" src...>
    <img type="png" src... />
</object> 
```

the back up image (here the png) doesn't create a second http request or does it?

My doubt comes from using a couple of testing sites, like the www.pingdom.com full page test for speed, each reserve image was listed as causing an extra http request.

Is this the case?

EDIT I've been looking into this, and I'd like confirmation or even better a way to avoid these possibly useless requests, but **it seems that yes back-up objects do require HTTP requests, the browser distinguishes the resources but the HTTP doesn't**, it just gets them and tells the browser "Sort this lot out." Hmmm...

I can't see a way around this (I have 20+ svgs on some pages, pages that i'd like to be as small as poss for mobile), i'll have to make those with non-svg browsers click twice rather than make everyone else have a slower experience....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T10:01:51.357

HTTP 请求由每个 `<object>`备份或主创建，然后浏览器将处理您的 html。

# extjs - Ext-JS 4 与 CakePHP 对比 Ext.direct

> ID：12360319
> 
> 赞同：3
> 
> 时间：2012-09-10T22:29:04.433
> 
> 标签：extjs, extjs4

我在客户端使用 Ext-JS 4，在服务器端使用 CakePHP。他们正在使用 JSON 进行通信。

我看到 Sencha Team 创建了 Ext.direct 用于与服务器端（PHP、Ruby、.NET 等）进行通信。

那么，您能告诉我在 CakePHP 或 Zend 等 PHP 框架上使用 Ext.direct 的优缺点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T12:20:39.670

像往常一样，它通过提供额外的抽象层为您带来更有条理和结构化的代码，而不会或几乎没有性能损失。在您的框架上使用它。或者不使用。由你决定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T23:03:13.733

Ext.Direct 是一种协议，而不是服务器实现！Ext.Direct 与标准 RESTful 或“普通”js 请求相比有很多优势，因为它是专门为 Sencha Touch 和 ExtJS 编写的，因此所有模型和代理都已经正确配置并准备就绪。

如果您使用的是 CakePHP，那么有一个名为 Bancha 的框架将 Ext.Direct 实现到 CakePHP 中。它还处理所有编组和数据转换，为您节省大量时间。

# php - 通过各种类处理mysql assoc结果

> ID：12360321
> 
> 赞同：2
> 
> 时间：2012-09-10T22:29:04.277
> 
> 标签：php, mysql

嗨，我最近开始了另一个项目，我的老板坚持我们使用 MVC 模型，问题是由于许多文章显示了不同的方法来做到这一点，我们还没有就正确的 MVC 模型应该是什么样子达成一致。

所以这是我对这个项目的问题（无论这是否是正确的方法）我正在使用以下基线规则

控制器类管理从模型类获取数据并将数据传递给视图类并检索视图并显示它

模型类管理所有数据库操作并使用返回数据`mysql_fetch_assoc`

视图类使用数据等创建视图。

所以我的问题是处理信息，`mysql_fetch_assoc`通常你会做这样的事情（假设我们已经运行了一个查询）

```
while ($row = mysql_fetch_assoc($result)) {
    echo $row["username"];
} 
```

但是当我在视图类而不是模型中处理结果时，当我已经将 assoc 数组传递给视图时，如何循环遍历所有结果，目前我遇到了一个问题，它一直在循环结果直到它遇到内存大小错误，因此由于某种原因它无法弄清楚它需要循环多少个结果

对于不好的解释，我目前的代码片段如下。

控制器 require_once 'admin_model.php'; 需要一次'admin_view.php'；

```
class admin_controller {
    public $model;
    public $view;

    public function __construct() {
        $this->model = new admin_model;
        $this->view = new admin_view;
    }

    public function get_group_view() {
        $in_model = $this->model->get_group_view();
        $in_view = $this->view->get_group_view ($in_model);

        echo $in_view;
    } 
```

模型类 admin_model {

```
 public function get_group_view() {
        $query = mysql_query("
            SELECT
                group_id,
                group_name
            FROM
                user_groups
        ");

        return mysql_fetch_assoc($query);
    }
} 
```

看法

```
class admin_view {

    public function get_group_view($group_data) {

        while($group_data) {
            $output .= $group_data['group_id'] . '###' . $group_data['group_name'] . '<hr />';
        }

        return $output;
    }

} 
```

当前返回错误：

```
Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 133693393 bytes) 
```

那么有人可以建议我在不从模型类中移动“mysql_fetch_assoc”函数的情况下查看结果的最佳方法吗？

PS 我知道我可能在做 MVC 完全错误，但它对我们有用，我们不想再次研究和更改我们的代码，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:55:53.130

你在这里有错误

```
 while($group_data) {
        $output .= $group_data['group_id'] . '###' . $group_data['group_name'] . '<hr />';
    } 
```

如果`$group_data`不为空 - 您的循环将永远不会结束。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T23:08:25.710

你不应该返回 MySQL Result - 你应该这样做：

```
 $return = array();
 $query = mysql_query("SELECT group_id, group_name FROM user_groups");
 while($row = mysql_fetch_assoc($query)) {
     $return[] = $row;
 }
 mysql_free_result($row);
 return $return; 
```

你应该修复每个 @Roman_S 的 $group_data 错误。正确的用法，连同上面的代码是

```
public function get_group_view($group_data) {
    $output = '';
    foreach($group_data as $group) {
        $output .= $group['group_id'] . '###' . $group['group_name'] . '<hr />';
    }
    return $output;
} 
```

最后，如果可能，您应该迁移到 MySQLi 或 PDO。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T23:09:54.540

就如何处理数据库控制提出建议。

例如使用 PDO 时

```
$pdoInst = new PDO( .. ); 
```

我们在某处有一个方法可以验证 $pdoInst 生成的每个语句

```
abstract class .. {
  public static function validateStmt($stmt) {
    if($stmt !== false) { .. }
      // everything else you like, even error handling, log files, etc.
    }
  }
} 
```

像`get_group_view`方法这样的准备好的语句将如下所示

```
public function get_group_view { 
  $stmt = $pdoInst->prepare(" .. QUERY .. ");
  // the return can be wrapped in a method to handle errors, etc, which can be done
  // here or else where.
  $stmt->execute() // returns true or false
  return $stmt;
} 
```

现在进行迭代

```
public function get_group_view($group_data) {
  $output = "";
  // validate the statement, can be done here or else where as said before
  if($pdoInst::validateStmt($group_data)) {
    // many ways how to iterate, foreach is just one.
    foreach($group_data as $index => $group) {
      $output .= $group['group_id'] . '###' . $group['group_name'] . '<hr />';
    }
  }
  return $output;
} 
```

PDO 最好的一点是您可以使用自定义类扩展类。您可以添加为您的模型增加更多价值的功能。

# objective-c - 如何使用按钮移动图像？

> ID：12360323
> 
> 赞同：0
> 
> 时间：2012-09-10T22:29:19.020
> 
> 标签：objective-c, ios, cocoa-touch, uikit, core-animation

我有一个从 nsarray 字符串传递来制作图片的图像（clubcow.png）。然后 facedowncow 代表图片。我想知道如何制作一个按钮，当点击按钮时，它将把 facedowncow 移动到位置 (100,100)。任何提示将不胜感激。此外，此代码还有更多内容，我只是发布了重要部分以了解正在发生的事情。

```
cardKeys = [[NSArray alloc] initWithObjects:@"clubcow",  nil];
currentName = [NSMutableString stringWithFormat:@"%@.png", [cowsShuffled objectAtIndex:currentcow]];
faceDowncow = (UIImageView *)[self.view viewWithTag:1];
faceDowncow.userInteractionEnabled = YES; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T22:51:37.377

我将首先创建一个`UIButton`并将其添加到您的视图控制器的视图中。

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
button.frame = CGRectMake(0, 0, 100, 20);
[button setTitle:@"Tap Me" forState:UIControlStateNormal];
[button addTarget:self action:@selector(animateImage:)
 forControlEvents:UIControlEventTouchUpInside];
[self.view addSubview:button]; 
```

然后，将此按钮链接到将为您的`faceDowncow`对象设置动画的函数。您可以将您添加`faceDowncow`为视图控制器的属性，以便以下函数可以轻松引用它：

```
- (void)animateImage:(UIButton *)sender {
    [UIView animateWithDuration:0.2
     animations:^{
         // change origin of frame
         faceDowncow.frame = CGRectMake(100, 100, faceDowncow.frame.size.width, faceDowncow.frame.size.height);
     } completion:^(BOOL finished){
         // do something after animation
     }];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:52:17.390

首先，看起来这段代码来自一个视图控制器子类，而牛是一个子视图。在这种情况下，您可能应该拥有它的属性，而不是一直通过它的标签来获取它。如果它在情节提要场景/笔尖中实例化，那么您可以很容易地将插座连接到子类中的属性/ivar。

做你想做的最简单的方法是创建按钮并使用目标操作，以便当它被点击时，它会调用视图控制器中的方法。在方法体中，获取对奶牛的引用并设置它的 frame 属性，如下所示：

```
[faceDowncow setFrame: CGRectMake(100,100,faceDowncow.bounds.size.width,faceDowncow.bounds.size.height)]; 
```

如果您不知道目标操作的工作原理，我建议您阅读[Apple 的相关文档](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CocoaFundamentals/CommunicatingWithObjects/CommunicateWithObjects.html#//apple_ref/doc/uid/TP40002974-CH7-SW14)。就像获取一个按钮一样简单，调用一个方法来告诉它哪些事件应该使某个方法被调用，然后实现该方法。

# jquery - MVC3 C# datepicker (jquery) doesn't work on Ajax.BeginForm

> ID：12360327
> 
> 赞同：3
> 
> 时间：2012-09-10T22:29:41.830
> 
> 标签：jquery, asp.net-mvc-3, datepicker, ajax.beginform

i'm working on a MVC C# proyect that has a datepicker inside a Ajax.BeginForm, but it doesn´t work !!! i've read and tried a lot of tutorials and answers but i can make it work !!! ... for testing i have made another page without the Ajax.BeginForm and it works !!! ... i really need help ... here is my code ...

in the _Layout i have this ...

```
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>

<link href="@Url.Content("~/Content/themes/base/jquery.ui.core.css")" 
    rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/themes/base/jquery.ui.datepicker.css")" 
    rel="stylesheet"  type="text/css" />
<link href="@Url.Content("~/Content/themes/base/jquery.ui.theme.css")" 
    rel="stylesheet" type="text/css" />

<script src="@Url.Content("~/Scripts/jquery.ui.core.min.js")" 
    type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.ui.datepicker.min.js")" 
    type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/DatePickerReady.js")" 
    type="text/javascript"></script> 
```

this is my dateview

```
@model Nullable<DateTime>
@{
DateTime dt = DateTime.Now;
if (Model != null)
{
   dt  = (System.DateTime) Model;

}
@Html.TextBox("", String.Format("{0:d}", dt.ToShortDateString()), new { @class =       "datefield", type = "date"  })
} 
```

this is my actual jscript, like i said i tried a lot, but whith this work on the test page, it´s on the file DatePickerReady.js

```
$(function () {
$(".datefield").datepicker();
}); 
```

this is te code from the ajax.beginform

```
@using (Ajax.BeginForm("Index_AddItem", new AjaxOptions { UpdateTargetId = "TicketList", OnSuccess = "FFecha" }))
{ @Html.ValidationSummary(true) 
```

and finally this is where i use the datepicker, this code works on my test but it doesn't work on the Ajax.BeginForm

```
<div class="editor-label" style="Display:block; width:300px; float:left">
            @Html.LabelFor(model => model.Ticket.Fecha)
<br />
</div>
<div class="editor-field">
            @Html.EditorFor(model => model.Ticket.Fecha)
            @Html.ValidationMessageFor(model => model.Ticket.Fecha)
</div> 
```

i dont'n think that the model has something wrong, but here is the code ...

```
 [Required(ErrorMessage = "Required")]
    [DataType(DataType.Date)]
    public DateTime Fecha { get; set; } 
```

... i really apreciate any help !!!

# mysql - Multiple joins on same table and column using multiple aliases

> ID：12360329
> 
> 赞同：2
> 
> 时间：2012-09-10T22:29:56.777
> 
> 标签：mysql, sql

I have a celebrity photo website. It has 1 table that holds all searchable data for each photo called `photoSearch` and the full set of data is spread over many tables (normalization), named `photos`, `photoPeople` and `people`.

Table `photoPeople` contains photoID's and peopleID's and the `people` table contains peopleID's and the people's names. The `photos` table contains captions, headlines, heights, widths, file sizes, sales codes etc etc.

This is my current script which produces good results.

```
SELECT 
     p.photoID, 
     p.setID, 
     p.headline, 
     p.caption,
     GROUP_CONCAT(pe.people ORDER BY pe.people ASC SEPARATOR ';') AS people
FROM 
     photos p
INNER JOIN
     (
        SELECT photoID 
        FROM photoSearch 
        WHERE MATCH (allKeywords, shortCaption)
        AGAINST ('+red +dress +claridges +hotel' IN BOOLEAN MODE) 
        LIMIT 50
     ) pids ON p.photoID = pids.photoID
***********
LEFT JOIN
     photoPeople pp ON p.photoID = pp.photoID
LEFT JOIN
     people pe ON pp.peopleID = pe.peopleID
***********
GROUP BY p.photoID 
```

The problem is, instead of just selecting celebrity names to display in the results, I now want to search for one or more celebrity names to alter the results.

I'm pretty sure it's not possible to add two or more where clauses on the same column (where pe.people = 'angelina jolie' and pe.people = 'brad pitt'), so I'm pretty sure it needs to be done using JOINS.

This confused me a bit. So I asked a question here on SO to find out how I could achieve this and somebody advised this:

> "Join to the 'photoPeople' and 'people' tables ***n*** times, where ***n*** is the number of people you are searching for."

I tried many different ways of achieving this but so far have failed. I know what he said involves removing the joins in between the two lines of asterisks (code above) and replacing them with ***n*** amount of joins to the people table, but I just can't figure it out.

I tried this but phpMyAdmin has now been thinking for the last 10 minutes!:

```
********
JOIN ( photoPeople AS pp1 JOIN people AS p1 ON pp1.peopleID = p1.peopleID) 
ON p1.people = 'Brad Pitt'
JOIN ( photoPeople AS pp2 JOIN people AS p2 ON pp2.peopleID = p2.peopleID) 
ON p2.people = 'Angelina Jolie'
******** 
```

On top of the above attempt taking FOREVER, I also struggle to see how I can alter the GROUP_CONCAT function to get the results from more than one join/alias (p1, p2, p3 etc)!

Please, I would love some advice to get this working correctly.

* * *

**TEST SCENARIO**

If I run my query as-is, this is what I would see:

```
Photo:    120030
Set:      8803
Headline: Brad and Angelina arrive at film premiere.
People:   Brad Pitt; Angelina Jolie

Photo:    120031
Set:      8803
Headline: Brad and Angelina arrive at film premiere.
People:   Angelina Jolie

Photo:    120032
Set:      8803
Headline: Brad and Angelina arrive at film premiere.
People:   Brad Pitt 
```

I want my new query to search for names, so if I search for Angeline Jolie and Brad Pitt, I will see only this:

```
Photo:    120030
Set:      8803
Headline: Brad and Angelina arrive at film premiere.
People:   Brad Pitt; Angelina Jolie 
```

* * *

**NEW ATTEMPT:**

No errors but returned 0 results, where there should be 1000's of results for 'Brad Pitt' and 'Angelina Jolie' in 'France'.

```
SELECT 
     p.photoID, 
     p.setID, 
     p.headline, 
     p.caption,
     GROUP_CONCAT(pe.people ORDER BY pe.people ASC SEPARATOR ';') AS people
FROM 
     photos p
INNER JOIN
     (
        SELECT photoID 
        FROM photoSearch 
        WHERE MATCH (allKeywords, shortCaption)
        AGAINST ('+France' IN BOOLEAN MODE) 
        LIMIT 50
     ) pids ON p.photoID = pids.photoID
LEFT JOIN
     photoPeople pp ON p.photoID = pp.photoID
JOIN
     people pe ON pp.peopleID = pe.peopleID
     AND (pe.people = 'Angelina Jolie' OR pe.people = 'Brad Pitt')
GROUP BY p.photoID 
```

If I remove the INNER JOIN section and run this, it returns all photos of Brad and Angelina whether they are together or not, which is incorrect - I just need them together. If I also remove the `OR pe.people = 'Brad Pitt'`, it returns photos of Angelina correctly, I just can't get the whole thing linked up!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:37:53.757

要查找显示列表中所有人的照片，请使用

```
SELECT 
     p.photoID, 
     p.setID, 
     p.headline, 
     p.caption,
     GROUP_CONCAT(pe.people ORDER BY pe.people ASC SEPARATOR ';') AS people
FROM 
     photos p
INNER JOIN
     (
        SELECT photoID 
        FROM photoSearch 
        WHERE MATCH (allKeywords, shortCaption)
        AGAINST ('+red +dress +claridges +hotel' IN BOOLEAN MODE) 
        LIMIT 50
     ) pids 
   ON p.photoID = pids.photoID

INNER JOIN
     photoPeople pp ON p.photoID = pp.photoID
INNER JOIN
     people pe ON pp.peopleID = pe.peopleID
-- List of people
WHERE pe.People in ('Angelina Jolie', 'Brad Pit')
GROUP BY p.photoID
-- "2" must match number o people in the list
-- If you add third name, change this to 3
HAVING count(distinct pe.People) = 2 
```

我已将左连接更改为内部连接，因为`where`会这样对待它们（因为 null 不能与任何东西进行比较），而且我觉得如果接受不匹配的照片，这个问题就没有意义。

PS您的尝试没有成功，因为它确实将所有安吉丽娜加入所有照片，并将所有布拉德加入所有照片，从而产生大量记录。您可能在 PhotoID 上连接了两个派生表以产生与上述查询相同的结果，但它需要另一个派生表来添加第三个名称。

```
SELECT photos1.PhotoID
FROM
(
  SELECT pp1.PhotoID
    FROM photoPeople AS pp1 
    JOIN people AS p1 ON pp1.peopleID = p1.peopleID
   WHERE p1.people = 'Brad Pitt'
) photos1
JOIN 
(
  SELECT pp2.PhotoID
    FROM photoPeople AS pp2
    JOIN people AS p2 ON pp2.peopleID = p2.peopleID
   WHERE p2.people = 'Angelina Jolie'
) photos2
  ON photos1.PhotoID = photos2.PhotoID 
```

**更新**：组合条件以避免可能的`limit 50`不匹配：

```
SELECT 
     p.photoID, 
     p.setID, 
     p.headline, 
     p.caption,
     GROUP_CONCAT(pe.people ORDER BY pe.people ASC SEPARATOR ';') AS people
FROM 
     photos p
INNER JOIN
     (
        SELECT distinct ps.photoID 
        FROM photoSearch ps
        INNER JOIN
             photoPeople pp ON ps.photoID = pp.photoID
        INNER JOIN
             people pe ON pp.peopleID = pe.peopleID
     -- List of people
        WHERE pe.People in ('Angelina Jolie', 'Brad Pit')
          AND MATCH (allKeywords, shortCaption)
              AGAINST ('+red +dress +claridges +hotel' IN BOOLEAN MODE) 
        GROUP BY ps.photoID
     -- "2" must match number o people in the list
     -- If you add third name, change this to 3
        HAVING count(distinct pe.People) = 2
        LIMIT 50
     ) pids 
   ON p.photoID = pids.photoID
INNER JOIN
     photoPeople pp ON p.photoID = pp.photoID
INNER JOIN
     people pe ON pp.peopleID = pe.peopleID
GROUP BY p.photoID 
```

**重新编辑：**注意到我忘记在主查询中留下与人相关的加入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:31:32.787

有没有照片人的照片？还是照片没有人的人？如果不是，请使用常规联接而不是左联接。然后，您可以在该查询上放置额外的 where 子句

```
where (people = "Brad Pitt" or people = "Angelina Jolie") 
```

如果需要保持左连接，可以在ON中添加更多条件

```
... ON pp.peopleID = pe.peopleID and (people = "Brad Pitt" or people = "Angelina Jolie") 
```

更新：

我的大脑看到的是自加入版本，而不是 Nikola 的并集：

```
select pp1.photoId
from photoPeople pp1, people p1, photoPeople pp2, people p2
where pp1.peopleID = p1.peopleID
and p1.people = "angelina"
and pp2.peopleID = p2.peopleID
and pp1.photoId = pp2.photoId
and p2.people = "brad" 
```

但这让我想起了我建立的系统，您希望根据匹配的数量进行排名，而使用 UNIONS 更容易。

```
 SELECT photoID, count(*) as rank
 from (
  SELECT pp.PhotoID
    FROM photoPeople AS pp 
    JOIN people AS p ON pp.peopleID = p.peopleID
    WHERE p.people = 'Brad Pitt'
  UNION
  SELECT pp.PhotoID
    FROM photoPeople AS pp 
    JOIN people AS p ON pp.peopleID = p.peopleID
    WHERE p.people = 'Angelina Jolie'
 ) foo
 group by photoID
 order by rank desc 
```

我会投票给尼古拉 :)

# jquery - 按特定类别选择输入；可以单次通话

> ID：12360332
> 
> 赞同：0
> 
> 时间：2012-09-10T22:30:20.703
> 
> 标签：jquery

我想针对一个特定的复选框，例如下面的“is-wine”，但不确定语法，理想情况下是否可以在一行中完成。

关于如何做到这一点的任何想法？基本上只想选择'is-wine'复选框而不是其他复选框。

谢谢

```
$(document).ready(function(){
  $('.click-me').on('click',function(){
 // doesn't work
 //$('.chex input .is-wine').attr('checked',status);  
   $('.chex input').each( function() {
      $(this).attr('checked',status);
    });
  });
});
</script>
</head>
<body>
here i am withing sub
<div id='my-killer-id'>
  <div class='click-me'>clicke me for is-wine</div>
  <div class='chex'>
  <input type='checkbox' class='is-wine' /><br />
  <input type='checkbox' class='is-coffee' /><br />
  <input type='checkbox' class='is-tea' /><br />
  <input type='checkbox' class='is-cocktail' /><br />
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:35:14.800

这应该没有空间..

```
$('.chex input.is-wine').attr('checked',status); 
```

如果您在那里放置一个空格，它将转到输入的孩子（没有孩子）

```
if($('.chex input.is-wine').is(':checked')){
        alert('is wine is Checked !!')
     }      
     else{
       alert('is wine is not Checked !!')
    } 
```

检查这个[小提琴](http://jsfiddle.net/sushanth009/bFbL3/)

你可以为此想出多个选择器..因为这个类是独一无二的

```
$('.chex .is-wine').attr('checked',status); 

OR 

$('.is-wine').attr('checked',status); 

OR

$('.chex input[type=checkbox][class=is-wine]').attr('checked',status); 
```

# c# - 创建自定义 Html 标签 Html TextWriter

> ID：12360333
> 
> 赞同：1
> 
> 时间：2012-09-10T22:30:25.663
> 
> 标签：c#

有没有办法使用 HtmlTextWriter 创建它？我正在尝试创建一种在服务器端动态创建 html 的方法

```
<fieldset class='ui-grid-a' data-theme='c'> 
```

这是代码的开始，我不确定如何创建“数据主题”属性，因为没有为此提供枚举..

```
// Initialize StringWriter instance.
StringWriter stringWriter = new StringWriter();

// Put HtmlTextWriter in using block because it needs to call Dispose.
using (HtmlTextWriter writer = new HtmlTextWriter(stringWriter))
{
    foreach (string employee in myList)
    {
        writer.RenderBeginTag(HtmlTextWriterTag.Fieldset);
        writer.AddAttribute(HtmlTextWriterAttribute.Class, "ui-grid-a");
        writer.AddAttribute(HtmlTextWriterAttribute., "ui-grid-a");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T22:44:39.907

关于评论：**这是代码的开始，我不确定如何创建“数据主题”属性，因为没有为此提供枚举..**

不要使用只接受枚举的重载，而是使用接受两个字符串值的重载：http: [//msdn.microsoft.com/en-us/library/985bhaz6.aspx](http://msdn.microsoft.com/en-us/library/985bhaz6.aspx)

例如

```
writer.AddAttribute("data-theme", "c"); 
```

# c++ - How to set library's path for q custom Qt application

> ID：12360335
> 
> 赞同：0
> 
> 时间：2012-09-10T22:30:27.727
> 
> 标签：c++, visual-studio-2010, module, qt4, mingw

I am running in situation where I have two different versions of Qt installed, the compiled with mingw one, and the other with visual studio. Now, When I compile my program with Qt MinGW version and run it, I got a message have scrambled text, saying that one of essential Qt modules not loaded. My question is, how I can set the path to Qt essential modules for my application with C++. I looked at documentation and found [addLibraryPath](http://doc.qt.nokia.com/4.7-snapshot/qcoreapplication.html#addLibraryPath) method but it seems like for Qt plugins only.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T08:06:17.637

**编辑**

似乎我误解了这个问题，因为 SIFE 评论说他需要加载 Qt 模块（如 QtGui4.dll），而不是插件。插件的答案留在这里，以防它可能对某人有所帮助。

**插件**

Qt 加载默认情况下的插件`SDK/plugins`。问题是，它首先找到了错误的 SDK...

如果我没记错的话，Qt首先在目录中搜索`.`。因此，您可以复制 *.exe 附近的“插件”目录：在 msvc 编译的 exe 附近复制 msvc 的插件，在 gcc 编译的 exe 附近复制 gcc 的插件。

如果您不想复制`plugins`目录，可以使用[setLibraryPaths](http://doc.qt.nokia.com/4.7-snapshot/qcoreapplication.html#setLibraryPaths)（未经测试，但可能有效）

最后但同样重要的是，您还可以使用[qt.conf](http://qt-project.org/doc/qt-4.8/qt-conf.html)方法。

**模块**

模块不是动态加载的，因为它们是应用程序依赖项的一部分，所以它们是在 exe 启动时加载的，而不是通过 LoadLibrary 加载的。因此，解决方案很简单：只需将 dll 复制到与包含 *.exe 的文件夹相同的文件夹中即可

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T22:41:16.790

关于编译器，正确的库/包含设置应该由 QMake 完成。QMake 使用 Qmake 所属的同一版本中的库创建您的 makefile/VS-Project。

尝试使用每个 Qt 版本的完整路径显式调用 QMake，例如

```
c:/myQtMinGwProject>c:/Qt4_mingw/bin/qmake 
c:/myQtVSProject>c:/Qt4_VS2008/bin/qmake -t vcapp 
```

关于运行时，确保相应版本的 dll 在 PATH 中

我希望它有帮助

# php - 优化ajax以减少mysql服务器负载

> ID：12360342
> 
> 赞同：3
> 
> 时间：2012-09-10T22:31:15.323
> 
> 标签：php, mysql

我有一个拍卖网站，有时负载很重，而且大多数情况下 mysql 会消耗大量内存和 cpu。我的情况如下。

对于在线和观看拍卖的每个用户，每秒钟都会有一个 ajax 查询到 mysql，以检查出价计数与先前的值。如果有人出价，则计数不同，因此此 ajax 会调用另一个 ajax 来检索记录并在表格中显示特定于正在观看/登录的用户的出价。我将其限制为前 10 个以减少加载。

但是问题是，如果有 50 个用户在线，其中一个人出价，则 50 个查询进入 mysql，并且他们都检测到出价计数已更改并发出进一步的查询以获取记录以显示与每个用户对应的出价。

更大的问题是，如果有 500 个用户在线，那么 500 个查询进入 mysql 以检测更改，如果出价，另外 500 个查询（每个在线用户特定的查询）进入 mysql 并可能导致服务器崩溃。

注意：目前有一个 mysql 连接对象用作 php 中的单例，负责执行查询、检索记录等。

我本质上是在寻找一个解决方案，如果 500 个用户在线，则 500 个查询不会转到 mysql，但即使其中一个人为特定拍卖出价，他们都应该得到更新。任何想法/建议都非常欢迎。

我怎样才能最好地为这种情况实施一个解决方案来减少 mysql 的负载？

资源方面我们还不错，在 Hostgator 上做一个 VPS4。唯一的问题是 CPU / 内存使用率在许多用户出价时为 95%。

欣赏一些建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T23:24:10.173

在短期内，您也可以只运行详细查询。当没有要更新的内容时它不会返回任何内容（它替换了第一个查询！）。

这可能会为您争取一些时间来缓存或更深入地分析您的查询速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:43:04.480

听起来您会想看看 memcached 或其他一些缓存服务。您可以有一个进程查询 MySQL 并将其更新到 memcached 中，然后 ajax 直接在 memcached 中进行查询以检索行。

Memcached 不保持关系一致性，查询它比每次查询 MySQL 消耗的资源要少得多。

PHP 有一个非常好的接口来使用 memcached：[Memcache](http://php.net/manual/en/book.memcache.php)

[memcached 项目的网站。](http://memcached.org/)

还有一些其他的缓存服务。您可能还想查看 MySQL 中的查询缓存，但这仍然需要几个到 MySQL 的连接，这两种方式都将非常消耗资源。

# python - Windows 上的 Python 错误：找不到 python25.dll

> ID：12360348
> 
> 赞同：0
> 
> 时间：2012-09-10T22:31:43.747
> 
> 标签：python, windows, numpy

我在 Windows 7 上运行 Python 2.7（在运行 Mountain Lion 的 Mac 上并行运行）并收到一个奇怪的错误。使用 Python(x,y) 和 Enthought Python Distribution（付费版本 - 64 位）都发生了这种情况。

从命令行运行 python 最初工作正常（并且在重新启动机器后总是如此）。

但是，当我尝试在命令行运行我的代码时

```
python the_script.py 
```

在第一次尝试时，我得到了这个错误窗口： ![python25.dll 丢失错误](../Images/cab95566c041d2e1215d0e09da3d65f6.png)

之后，我只是`python`在命令行输入时遇到同样的错误。

如果我指定路径，因为`c:\python27\python the_script.py`它工作正常。

以下是我在脚本中加载的所有模块：

```
import numpy as np
import subprocess as sub
import parallel_condor_Jacobian as pcj
import os
import shutil 
```

在`parallel_condor_Jacobian`以下模块中加载：

```
import numpy as np
import os
import subprocess as sub 
```

我觉得没什么特别的！

这些软件包之一是否以某种方式依赖于 python25.dll？

我尝试过的修复包括完全删除 python 2.7、重新安装和从我的 PATH 环境变量中删除所有 python 路径内容并将它们替换为 c:\python27。

我在这里真的很茫然。很高兴提供更多相关信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:16:39.873

删除本地文件夹中的 python.exe ...并告诉您的同事至少升级到 2.6 :P 并告诉他们 python exe 不可移植 :P

# django - Django 用户认证：django_auth_ldap.backend.LDAPBackend

> ID：12360350
> 
> 赞同：5
> 
> 时间：2012-09-10T22:31:53.557
> 
> 标签：django, django-authentication, django-auth-ldap

我不明白如何在 django 中使用 LDAPBackend，我要做的就是针对 LDAP 对用户进行身份验证。我尝试了以下方法：

```
from django_auth_ldap.backend import LDAPBackend
auth = LDAPBackend()
user = auth.authenticate(username='my_uid',password='pwd') 
```

此时用户为 None 并且查看 tcpdump 我看不到任何与 LDAP 服务器的连接尝试。

设置.py

```
AUTH_LDAP_SERVER_URI = 'ldap.example.com'
AUTH_LDAP_USER_DN_TEMPLATE = 'uid=%(user)s,ou=People,dc=example,dc=com'
AUTH_LDAP_BIND_AS_AUTHENTICATING_USER = True
AUTH_LDAP_CACHE_GROUPS = True
AUTH_LDAP_GROUP_CACHE_TIMEOUT = 3600
AUTH_LDAP_USER_ATTR_MAP = {
"first_name": "givenName",
"last_name": "sn",
"email": "mail"
}
AUTHENTICATION_BACKENDS = (
'django.contrib.auth.backends.ModelBackend',
'django_auth_ldap.backend.LDAPBackend',
) 
```

官方 django 文档没有提供有关如何在视图中使用此后端的任何片段。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:16:54.180

django-auth-ldap 的所有文档都[在这里](http://packages.python.org/django-auth-ldap/)。为了调试您的配置，您需要在记录器上安装一个日志处理程序`'django_auth_ldap'`；有关更多信息，请参阅[Django 的日志记录文档](https://docs.djangoproject.com/en/1.4/topics/logging/)。

乍一看，我会说一个问题是`AUTH_LDAP_SERVER_URI`没有设置为 URI；尝试一些形式`ldap://ldap.example.com/`。您还需要查看[AUTH_LDAP_BIND_AS_AUTHENTICATING_USER](http://packages.python.org/django-auth-ldap/#auth-ldap-bind-as-authenticating-user)的文档：这是一个高级且有些微妙的选项，只有在您知道自己需要它时才应该启用它。

# jquery - jQuery .animate() 第一次不起作用

> ID：12360355
> 
> 赞同：0
> 
> 时间：2012-09-10T22:32:28.037
> 
> 标签：jquery, html, jquery-animate, slide

我正在制作一个“车库门”类型的东西来展示项目。有一个`whole`带有背景图像的 div()，然后是另一个`project_info`带有信息的 div() 向下滑动，覆盖 的背景图像`whole`。它完全按照我喜欢的方式工作，只是无论如何，动画第一次都不会工作。所有 3 个元素 (和) 以相同的速度向下滑动，而它们应该以不同的速度滑动`project_info`。但是，每次之后，幻灯片都会起作用。`project_name``project_desc`

HTML：

```
<div class="whole" style="background-image: url('rail.jpg');">
  <div class="project_info">
    <span class="project_name">Rail Direct</span>
    <span class="project_desc">Lorem ipsum dolor sit amet</span>
  </div> 
```

jQuery：

```
 <script type="text/javascript">
$(document).ready(function(){
$(".whole").hover(function() {
  $('.project_info').stop().animate({"top": "0px"}, 300);
  $('.project_name').stop().animate({"top": "0px"}, 1000);
  $('.project_desc').stop().animate({"top": "0px"}, 650);
},
function() {
  $('.project_info').stop().animate({"top": "-155px"}, 800);
  $('.project_name').stop().animate({"top": "-155px"}, 300);
  $('.project_desc').stop().animate({"top": "-155px"}, 650);
}); 
```

});

可能需要注意的是，悬停的鼠标悬停部分将在第一次工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:52:28.957

看看[http://jsfiddle.net/qG5Hh/1/](http://jsfiddle.net/qG5Hh/1/)

如果您使用 position:relative ，那么内部跨度将以与包含 div 相同的速度加上它们自己的速度移动。我试图通过设置 div 的高度而不是顶部值来获得您正在寻找的结果。

# paypal-ipn - PayPal 即时付款通知 (IPN) 的 C# 处理程序

> ID：12360356
> 
> 赞同：0
> 
> 时间：2012-09-10T22:33:00.957
> 
> 标签：paypal-ipn

我正在尝试为 PayPal IPN 编写自己的 ASP.NET C# 处理程序页面。

我跟踪了一些我在网上找到的示例，但没有成功。

我似乎在第一步失败了：捕获从 PayPal 发送到处理程序页面的即时付款通知 (IPN) 数据。

我有一个网页： PayPalIPNHandler.aspx.cs 并且在 Page_Load 我有以下内容：

```
protected void Page_Load(object sender, EventArgs e)
{

    byte[] param = Request.BinaryRead(Request.ContentLength);
    string strRequest = Encoding.ASCII.GetString(param);

} 
```

我使用一些示例数据来测试处理程序页面：

/sitename/PayPalIPNHandler.aspx?mc_gross=0.01&protection_eligibility=Eligible&address_status=confirmed&item_number1=&payer_id=pid&tax=0.00&address_street=23%20The%20Street&payment_date=12:38:53%20Jan%2010,%202012%20PST&zip=windows-status=25&char_zip=windows-status= IP4％204LP＆mc_shipping = 0.00＆mc_handling = 0.00＆FIRST_NAME =约翰＆mc_fee = 0.01 address_country_code = GB＆ADDRESS_NAME =约翰％20Smith＆notify_version = 3.4＆定制= payer_status =未经验证和业务= X @ googlemail.com＆ADDRESS_COUNTRY =联合％20Kingdom＆num_cart_items = 1＆mc_handling1 = 0.00＆ADDRESS_CITY =伊普斯维奇＆verify_sign =验证和PAYER_EMAIL = X @ gmail的.com&mc_shipping1=0.00&txn_id=1&payment_type=instant&last_name=Smith&address_state=Suffolk&item_name1=&receiver_email=x@googlemail.com&payment_fee=&quantity1=1&receiver_id=w&txn_type=cart&mc_gross_1=0.01&mc_currency=GBP&residence_country=GB&transaction_subject=Shopping%20Cart&payment_gross=&ipn_track_id=Bu4

但是， ContentLength 似乎总是 0 而 strRequest 是 ""

我显然犯了一个非常愚蠢的错误，但我只是看不出我做错了什么。

请帮忙。

亲切的问候

沃尔特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:43:41.683

HTTP GET 请求的内容将始终为空 - 只有在 POST（以及 PUT 和可能的 DELETE）请求上发送内容才有效。根据您的评论，我会说您需要查看

```
Request.ServerVariables["QUERY_STRING"] 
```

# sql - 哪些选项可用于在 PostgreSQL 中应用设置级别约束？

> ID：12360357
> 
> 赞同：0
> 
> 时间：2012-09-10T22:33:13.763
> 
> 标签：sql, postgresql, constraints

我有一种情况，我需要确保在任何时候只有一个具有相同 object_id 和 user_id 的活动记录。这是一个有代表性的表格：

```
CREATE TABLE actions (
    id SERIAL PRIMARY KEY,
    object_id integer,
    user_id integer,
    active boolean default true,
    created_at timestamptz default now()
); 
```

一次只有一个活动记录，我的意思是你可以有一系列插入，如下所示：

```
insert into actions (object_id, user_id, active) values (1, 1, true);
insert into actions (object_id, user_id, active) values (1, 1, false); 
```

但做一个后续

```
insert into actions (object_id, user_id, active) values (1, 1, true); 
```

应该会失败，因为此时已经存在 1 个 object_id = 1 且 user_id = 1 的活动元组。

我正在使用 PostgreSQL 8.4。

我看到这篇[文章](https://stackoverflow.com/questions/3150677/using-triggers-for-ensuring-data-consistency)看起来很有趣，但它是特定于 Oracle 的。

我也看到了这篇[文章](https://stackoverflow.com/questions/9663263/sql-using-trigger-for-constraint)，但它需要更多地关注事务隔离级别。我认为它不会在读取提交模式下按原样工作。

我的问题是还有哪些其他选项可用于不确定这种约束？

编辑：删除了第一组中的第三个插入。我认为这使示例感到困惑。我还添加了 created_at 时间戳来帮助处理上下文。重申一下，可以有多个 (object_id, user_id, false) 元组，但只有一个 (object_id, user_id, true) 元组。

更新：我接受了克雷格的回答，但对于其他可能偶然发现类似问题的人来说，这是另一种可能的（虽然不是最佳的）解决方案。

```
CREATE TABLE action_consistency (
    object_id integer,
    user_id integer,
    count integer default 0,
    primary key (object_id, user_id),
    check (count >= 0 AND count <= 1)
);

CREATE OR REPLACE FUNCTION keep_action_consistency()
  RETURNS TRIGGER AS
$BODY$
    BEGIN

    IF NEW.active THEN
        UPDATE action_consistency
        SET count = count + 1
        WHERE object_id = NEW.object_id AND
        user_id   = NEW.user_id;

        INSERT INTO action_consistency (object_id, user_id, count)
        SELECT NEW.object_id, NEW.user_id, 1
        WHERE NOT EXISTS (SELECT 1 
                          FROM action_consistency
                          WHERE object_id = NEW.object_id AND
                                user_id   = NEW.user_id);
    ELSE
        -- assuming insert will be active for simplicity
        UPDATE action_consistency
        SET count = count - 1
        WHERE object_id = NEW.object_id AND
        user_id   = NEW.user_id;
    END IF;

    RETURN NEW;

    END;
$BODY$
LANGUAGE plpgsql;

CREATE TRIGGER ensure_action_consistency AFTER INSERT OR UPDATE ON actions
    FOR EACH ROW EXECUTE PROCEDURE keep_action_consistency(); 
```

它需要使用跟踪表。由于我希望是显而易见的原因，这根本不是可取的。这意味着您在操作中每个不同的（object_id，user_id）都有一个额外的行。

我接受@Craig Ringer 回答的另一个原因是，当给定的操作元组更改状态时，其他表中也存在对 actions.id 的外键引用。这就是为什么历史表在这种情况下不太理想的原因。感谢您的评论和回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:38:33.363

您可以使用[UNIQUE 约束](http://www.postgresql.org/docs/8.1/static/ddl-constraints.html#AEN2016)来确保该列包含唯一值...这里，设置`object_id`和`user_id`已被设置为唯一...。

```
CREATE TABLE actions (
    id SERIAL PRIMARY KEY,
    object_id integer,
    user_id integer,
    active boolean default true,
    UNIQUE (object_id , user_id )

); 
```

签出**[SQLFIDDLE](http://sqlfiddle.com/#!10/42301)**

类似地，如果要设置 和as `object_id`，只需在 列表中添加列名即可。`user_id``active``UNIQUE``UNIQUE`

```
CREATE TABLE actions (
    id SERIAL PRIMARY KEY,
    object_id integer,
    user_id integer,
    active boolean default true,
    UNIQUE (object_id , user_id,active )

); 
```

签出**[SQLFIDDLE](http://sqlfiddle.com/#!10/58e09)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T08:20:00.663

鉴于您希望一次只限制一个条目的规范，请`active`尝试：

```
CREATE TABLE actions (
    id SERIAL PRIMARY KEY,
    object_id integer,
    user_id integer,
    active boolean default true,
    created_at timestamptz default now()
);

CREATE UNIQUE INDEX actions_unique_active_y ON actions(object_id,user_id) WHERE (active = 't'); 
```

这是一个*部分唯一索引*，一个 PostgreSQL 特定的功能 - 请参阅[部分索引](http://www.postgresql.org/docs/current/static/indexes-partial.html)。它限制集合，使得只有一个`(object_id,user_id)`元组可能存在 where `active`is `true`。

正如您在评论中进一步解释的那样，这严格回答了您的问题，但我认为[Wildplasser 的回答](https://stackoverflow.com/a/12360571/398670)描述了更正确的选择和最佳方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T22:57:18.353

原来的：

```
CREATE TABLE actions (
    id SERIAL PRIMARY KEY,
    object_id integer,
    user_id integer,
    active boolean default true
); 
```

我的版本：

```
CREATE TABLE actions (
    object_id integer NOT NULL REFERENCES objects (id),
    user_id integer NOT NULL REFERENCES users(id),
    PRIMARY KEY (user_id, object_id)
); 
```

有什么区别：

*   省略了代理键。它没用，它不强制任何约束，也没有人会引用它
*   添加了一个（复合）主键，它恰好是*逻辑*键
*   将这两个字段更改为 NOT NULL，并将它们设为外键（用户或对象表中*不*存在的行是什么*意思？*
**   删除了布尔标志。不存在的 {user_id,object_id} 元组与确实存在但其“活动”标志设置为 false 的元组之间的语义差异是什么？当你只需要两个状态时，为什么要创建三个状态？*

# c# - 客户端实现更多接口或“子”客户端

> ID：12360361
> 
> 赞同：1
> 
> 时间：2012-09-10T22:33:38.300
> 
> 标签：c#, wcf

我在不同的服务器上获得了两个 wcf 服务。两者都定义了自己的客户群，例如： `public class Channel1 : ClientBase<IService1>, IService1`和 `public class Channel2 : ClientBase<IService2>, IService2`

现在我需要为它们添加一个获取服务统计信息的常用方法，比如说： `public interface IService3{ string GetStats(); }`. 在每台服务器上，都会运行应用程序（或服务）来询问此统计信息

有没有办法，我怎样才能写 Channel1 和 Channel2 来接受 IService3，所以我只是在配置文件中定义端点？还是我必须创建自己的应用程序来与 Channel1 和其他 Channel2 通信？

如果我定义`IService1 : IService3`and`IService2 : IService3`和 a `Channel3 : ClientBase<IService3>, IService3`，Channel3 是否能够根据 EndPoint 连接到两种服务（每台服务器上一次）？（有可能出现 NotImplementedException）

我的目标是只有一个应用程序（服务），它能够在单独的服务上调用一些常用方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T12:05:00.490

让您现有的两个服务合同都继承第三个共享合同的解决方案将如您所描述的那样工作。在您的示例中，您需要确保 IService3 也使用 WCF 属性`ServiceContract`和`OperationContract`.

# file - 在 Tcl 中删除文件的内容

> ID：12360364
> 
> 赞同：0
> 
> 时间：2012-09-10T22:34:07.063
> 
> 标签：file, file-io, permissions, tcl

我在删除文本文件的内容时遇到了一些麻烦。据我所知，由于我们使用的 PLM 软件存在权限问题，我似乎无法重命名或删除此文件并创建一个具有相同名称的新文件。不幸的是，我一个人在这里，因为似乎没有人知道到底出了什么问题。

但是，我可以读取和写入此文件。所以我一直在查看[seek](http://wiki.tcl.tk/1498)命令并做这样的事情：

```
set f [open "C:/John/myFile.txt" "a+"]

seek $f 0   
set fp [tell $f]

seek $f 0 end
set end [tell $f]

# Restore current file pointer
seek $f $fp

while { $fp < $end } {
    puts -nonewline $f " "
    incr fp
}

close $f 
```

这似乎用空格替换了所有行，但我不确定这是处理这个问题的正确方法。有人可以给我一些指示吗？我对 Tcl 还是比较陌生。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T19:45:30.787

如果您至少有 Tcl 8.5，请以`r+`或`w+`模式打开文件（可能需要进行实验），然后使用[`chan truncate`](http://www.tcl.tk/man/tcl8.5/TclCmd/chan.htm#M40)：

```
chan truncate $f 0 
```

如果您使用的是 8.4 或更早版本，则必须这样做（它仅适用于截断为空）：

```
close [open $thefilename "w"] 
```

（`w`如果文件不存在，该模式会创建文件，如果存在，则在打开时将其截断为空。程序的其余部分可能会也可能不会喜欢这样！）

但是请注意，这不会重置文件上打开的其他通道认为它们所在的位置。即使没有锁定，这也可能导致奇怪的效果（例如以大偏移量写入，操作系统用零填充前面的字节）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T14:17:11.007

```
close [open $path w] 
```

瞧，一个空文件。如果此文件尚不存在，则会创建它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T10:56:14.600

一个非常简单的方法是用一个空文件覆盖你的文件。例如创建一个空文件（您可以手动执行此操作或使用以下 TCL 代码）：

```
set blank_file [open "C:/tmp/blank.txt" "w"]
close $blank_file 
```

然后只需用空白文件覆盖原始文件，如下所示：

```
file rename -force "C:/tmp/blank.txt" "C:/John/myFile.txt" 
```

当然，如果其他东西抓取了文件，您可能会遇到权限问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T22:39:19.163

您说该文件是由另一个进程专门打开的，但您可以写入它？！我认为你有权限问题。您使用的是 Linux 还是 Unix？！（貌似是windows系统，但是linux/unix系统通常会出现权限问题，很奇怪吧？！）

如果您能够读取和写入文件，则该文件不会以独占方式打开，并且您可能没有适当的权限来删除该文件。

此外，最好在您知道您拥有所有权限的文件上测试代码。如果代码正常工作，您可以专注于您的目标文件。你也可以谷歌“如何在 Tcl 中归档操作”。阅读这篇[使用 Tcl 操作文件](http://www2.lib.uchicago.edu/keith/tcl-course/topics/tcl-files.html)

# php - 静态网站的 Smarty 模板

> ID：12360366
> 
> 赞同：0
> 
> 时间：2012-09-10T22:34:19.753
> 
> 标签：php, smarty

我一直在查看 Smarty 模板的示例，但找不到我的答案。

目前，我有一个相当简单的 10 页静态 HTML 网站。我正在考虑使用 Smarty 来减少明显的 HTML 重复（页眉、页脚等...）

这可以使用 Smarty 模板吗？还是我最好使用简单的 php 包含？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:38:50.010

你绝对可以使用 Smarty 模板来做到这一点。但是，如果您只是想包含页眉/页脚/菜单模板并且真的不需要 Smarty 必须提供的其他功能，那么最好避开它。你是在问*如何*在 Smarty 中做到这一点，或者哪个更好？如果是后者，在您的情况下使用 include 可能会更好。

```
<?php
$inc = array(
    "title" => "About",
    "active" => "About"
);

include_once("inc/header.php");
?>

<p>Lorem ipsum.</p>

<?php
include_once("inc/footer.php");
?> 
```

在 Smarty 中，你会做这样的事情：

```
<?php
require_once('Smarty.class.php');
$smarty = new Smarty();

$smarty->display("inc/header.tpl");
$smarty->display("inc/about.tpl");
$smarty->display("inc/footer.tpl"); 
```

如果您缺少 Smarty 可能提供的一些功能并且觉得您需要它们，那么最好自己创建一个非常简单的模板系统类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:39:11.593

无需使用 Smarty。只需使用 PHP。

`require_once($_SERVER['DOCUMENT_ROOT'] . '/inc/header.php');`

# java - 将文件从 Tomcat Linux 移动到另一个 Linux 服务器

> ID：12360369
> 
> 赞同：1
> 
> 时间：2012-09-10T22:34:41.983
> 
> 标签：java, linux, file, tomcat

我从事的工作是几年前他们的网站管理员在 linux 服务器上使用 Tomcat 设置 Intranet。用户可以在测试环境中创建一些东西，然后单击“make live”，Linux/Tomcat 将文件移动到 Linux/live PHP Web 设置。

我不知道他们是如何移动文件的。在 Tomcat 和 Java 中执行此操作的常用工具是什么？

我意识到这是模糊的，但任何帮助将不胜感激。让我知道还需要什么其他信息。

两台服务器中还有一个重复的 MySQL 数据库。我猜 Tomcat 设置正在向两个数据库写入重复信息，但我看不到文件是如何移动的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:21:44.580

这听起来像是网站内容完全存储在数据库中并写入其他服务器。

从理论上讲，您还可以拥有一个 rsync shell 脚本并从 php 调用它以实际将文件同步到另一台服务器。

如果单击“Make Live”并立即发生，则它可以直接访问数据库或某些基于脚本的同步。

如果需要一段时间，它可能是一项 cron 作业。也许你应该检查一下这个 crontab -l 是否可以工作。

有几个选项，您实际上打开 *.php，用户可以编辑内容并查看 make live 按钮为您带来的位置，例如“将表单发布到 *.php”，然后检查该脚本正在做什么或向我们展示包（如果您在公司网站上工作，我希望看到但不建议）。

返回此处提供更多信息，以便我为您扩展答案。也许您还应该澄清为什么您一无所知，说明您已经检查过的内容，我需要的信息是上面有 make live 按钮的实际站点，它将导致下一个站点或可能显示什么的脚本该网站正在做。

# c++ - 通过整数和 -Weffc++ 标志覆盖 +/-/*/%

> ID：12360370
> 
> 赞同：3
> 
> 时间：2012-09-10T22:34:48.670
> 
> 标签：c++, warnings

我有一个名为 Coord 的类...它有实例数据 x，y。我想覆盖 * 运算符，以便 * 运算符可用于将 Coord 乘以整数或双倍！这是我提出的解决方案：

```
Coord& Coord::operator*(int n)
{
    this->x = this->x*n;
    this->y = this->y*n;
    return *this;
} 
```

它有效 - 我已经从 main 测试了一些打印输出......唯一的问题是......我从 -Weffc++ 标志收到警告！它说我的函数应该按值返回！我知道这个标志对应于“Effective C++”一书，但我手头没有副本——这本书有什么建议？什么是按值传递？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T23:26:32.120

只是为了详细说明灰熊的评论......这不是就地乘法。因此，您应该将其声明为 const 以明确防止：

```
Coord Coord::operator*(int n) const {
    Coord c(*this);
    c.x *= n;
    c.y *= n;
    return c;
} 
```

或者，如果您有一个有用的构造函数：

```
Coord Coord::operator*(int n) const {
    return Coord(x*n, y*n);
} 
```

就地乘法是不同的（和非常量）：

```
Coord& Coord::operator*=(int n) {
    x *= n;
    y *= n;
    return *this;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T10:13:16.857

一般来说，这类事情分两部分完成，成员`operator*=`和非成员`operator*`使用`*=`：

```
Coord& Coord::operator*=(int n) {
    x *= n;
    y *= n;
    return *this;
}

Coord operator*(const Coord& c, int n) {
    Coord res(c);
    res *= n;
    return res;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T02:45:13.090

您尚未实现`operator*`，而是实现了 self-mutating `operator*=`，将结果分配回原始对象。

考虑以下`int`示例的运营商实施的影响：

```
int x = 5;
int y = 2;
int z = x * y; 
```

现在，通过与您的代码类似地实现整数乘法，您最终会得到两者`y` *和* `z`等于 10。

为了实现普通`operator*`类型运算符，您需要创建一个临时对象并按值返回它。

您可能正在寻找更像这样的实现（假设您的类有两个参数构造函数）：

```
Coord Coord::operator*(int n) const
{
    return Coord(x * n, y * n);
} 
```

但是请注意，通常情况下，运算符的明显含义并不那么清楚，重载只会引起混乱。考虑一个非成员命名函数（使用命名成员缩放函数），沿着这些思路：

```
Coord& Coord::ScaleBy(int n)
{
    this->x = this->x*n;
    this->y = this->y*n;
    return *this;
}

Coord ScaleCoord(Coord c, int n)
{
    return c.ScaleBy(n);
} 
```

# c++ - 在 C++11 中有一个基于逆范围的 for 吗？

> ID：12360372
> 
> 赞同：7
> 
> 时间：2012-09-10T22:34:56.487
> 
> 标签：c++, stl, c++11

> **可能重复：**
> [C++11 反向基于范围的 for 循环](https://stackoverflow.com/questions/8542591/c11-reverse-range-based-for-loop)

是否有基于逆范围`for`的`C++11`？

我想做这样的事情：

```
for(int value : vec)
{
    cout << value << endl;
} 
```

去做这个：

```
for(auto it = vec.rbegin(); it != vec.rend(); ++it)
{
    cout << *it << endl;
} 
```

例如：

```
for(int value : -vec)
{
    cout << value << endl;
} 
```

有可能做类似的事情来做一个逆循环吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-10T22:38:52.780

您可以只使用[Boost.Range 的反向适配器](http://www.boost.org/doc/libs/1_51_0/libs/range/doc/html/range/reference/adaptors/reference/reversed.html)：

```
for(int value : ( vec | boost::adaptors::reversed ))
{...} 
```

但是标准 C++11 没有类似的特性。

# bash - 命令参数被解释为命令文件名

> ID：12360373
> 
> 赞同：0
> 
> 时间：2012-09-10T22:35:04.190
> 
> 标签：bash

我正在尝试创建一个 bash 脚本来构建要执行的命令（包括参数）。命令可执行文件的名称是 ms （位于 ms 目录中），它需要我计算并存储在字符串中的一堆参数。当需要执行命令时，我尝试：

```
GENETREES=$(../ms/${x:1}) 
```

但我收到错误消息：

```
./simulate.sh: line 21: ../ms/ms 6 1 -T -I 6 1 1 1 1 1 1 -ej 0.059851352500000010170566611122922040522098541259765625 1 4 -es 0.059851352500000010170566611122922040522098541259765625 4 0.3457841801761454281205487859551794826984405517578125 -ej 0.059851352500000010170566611122922040522098541259765625 2 3 -es 0.059851352500000010170566611122922040522098541259765625 3 0.54870128110803395582451003065216355025768280029296875 -ej 0.0897770262499999471828004971030168235301971435546875 7 9 -es 0.089777026250000002693951728360843844711780548095703125 3 0.8097582153199012200417428175569511950016021728515625 -ej 0.119702699999999995217336845598765648901462554931640625 3 4 -ej 0.125827642499999947656164067666395567357540130615234375 9 10 -es 0.1258276425000000031673152989242225885391235351562500 4 0.28069295861466903030390085405088029801845550537109375 -ej 0.13195258499999995560614252099185250699520111083984375 8 10 -ej 0.1817980399999999663318561715641408227384090423583984375 6 5 -ej 0.2525933399999999717788767839010688476264476776123046875 10 4 -ej 0.41145434999999996872332985731191001832485198974609375 4 5 : File name too long 
```

我认为 bash 认为我打算将所有这些命令参数作为可执行文件名称的一部分。但这不是我的意图。

我究竟做错了什么？

谢谢。

*更新 - 要求提供有关如何构建 x 的更多信息*

```
MSOUT=$(java -jar ./NetworkSearchGen.jar ms $3 $TRUENETWORK $4)
OIFS=$IFS
IFS='}'
first="true"
for x in $MSOUT 
do
    if [ $first = "true" ]; then
          echo "$x"
    else
        GENETREES=$(../ms/${x:1})
    fi
    first="false"
done 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:05:24.963

设置 IFS 把事情搞砸了。在执行之前使 IFS=" " 使脚本再次工作。

# android - 具有自定义背景资源的 ListView

> ID：12360374
> 
> 赞同：0
> 
> 时间：2012-09-10T22:35:06.680
> 
> 标签：android, json, listview

创建列表视图时，我需要使用自定义文本和自定义 setbackgroundresource 设置列表视图

这是我的代码：

listView 通过 JSON 编码从 URL 接收数据，如下所示：

```
{"results":[
    {"db_id":"6","discount":"active","db_description":"bla bla bla ","db_num":"137","db_num2":"260"},
    {"db_id":"14","db_type":"discount","db_description":"blaaaaaaa","db_num":"39","db_num2":"46"},
    {"db_id":"18","db_type":"discount","db_description":"blaaaaaaa","db_num":"335","db_num2":"456"},
]} 
```

将数据添加到地图

```
 List<NameValuePair> params = new ArrayList<NameValuePair>();
        params.add(new BasicNameValuePair("type",RESULTS_PARAMS));
        JSONObject json = jsonParser.makeHttpRequest(RESULTS_URL, "GET",
                params);
        Log.d("JSON RESULT: ", json.toString());

        try {
            queues = json.getJSONArray(TAG_RESULTS);
            for (int i = 0; i < queues.length(); i++) {
                JSONObject c = queues.getJSONObject(i);

                String id = c.getString(TAG_ID);
                String type = c.getString(TAG_TYPE);
                String description = c.getString(TAG_DESCRIPTION);
                String num = c.getString(TAG_NUM);
                String num2 =  c.getString(TAG_NUM2);
                int imageint = getResources().getIdentifier(c.getString(TAG_TYPE) , "drawable", getPackageName());
                String image = String.valueOf(imageint);

                HashMap<String, String> map = new HashMap<String, String>();
                map.put(TAG_ID, id);
                map.put(TAG_TYPE, type);
                map.put(TAG_DESCRIPTION, description);
                map.put(TAG_NUM, num);
                map.put(TAG_NUM2, num2);
                map.put(TAG_IMAGE, image);

                QueueList.add(map);
            }

        } catch (JSONException e) {
            e.printStackTrace();
        } 
```

将数据设置到列表视图中的代码

```
 ListAdapter adapter = new SimpleAdapter(
                        QueueActivity.this,
                        QueueList,
                        R.layout.queue_row,
                        new String[] { TAG_ID, TAG_DESCRIPTION, TAG_NUM, TAG_NUM2, TAG_IMAGE},
                        new int[] { R.id.queueid, R.id.description, R.id.num, R.id.num2, R.id.list_image });

                setListAdapter(adapter); 
```

现在我想将 setBackgroundResource 设置为 R.drawable.customlistviewback 如果 db_id (TAG_ID) = int info

例如，int info = 6；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:44:52.017

要进行行级视图修改，您可能需要使用自定义适配器。通常，您会覆盖该`getView`函数并在那里进行更改。请参阅[如何自定义列表视图行 android](https://stackoverflow.com/questions/4407865/how-to-customize-listview-row-android)以获得一个不错的示例。

# jsf-2 - javax.el.PropertyNotFoundException：在 primefaces 下载中的 java.io.File 类型上找不到属性

> ID：12360378
> 
> 赞同：2
> 
> 时间：2012-09-10T22:35:16.623
> 
> 标签：jsf-2, primefaces, download, myfaces

我正在使用 Primefaces 3.2 并开发文件下载功能，我正在从本地获取文件名列表，我想在带有可点击选项的 jsf 数据表中显示它们（h：commandlink）。

当我执行我的代码时，我得到了以下异常。

> javax.el.PropertyNotFoundException：/faces/fileDownload.xhtml 在第 33 行和第 115 列 value="#{x.fileName}"：在 java.io.File 类型上找不到属性“fileName”

我的代码看起来像这个 Java 文件

```
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

import org.primefaces.model.DefaultStreamedContent;
import org.primefaces.model.StreamedContent;

@ManagedBean(name="fileDownloadController")
@SessionScoped
public class FileDownloadController {

    private StreamedContent file;
    private List<File>  listfiles=new ArrayList<File>();
    private String fileName;

    public FileDownloadController() {        
        File filestream=new File("C:/temp.pdf");
        InputStream stream=null;
        try {
            stream = new FileInputStream(filestream);
        file = new DefaultStreamedContent(stream, "application/pdf", "temp.pdf");
        stream.close();
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    public List<File> getListfiles() {
        File folder = new File("c:\\");
        File[] listOfFiles = folder.listFiles();
        listfiles=Arrays.asList(listOfFiles);
        int i;
        for(i=0;i<listfiles.size();i++){
       System.out.println("The List of file are"+listfiles.get(i));
       listfiles.get(i);
        }
        return listfiles;
    }

    public void setListfiles(List<File> listfiles) {
        this.listfiles = listfiles;
    }

    public String getFileName() {
        getListfiles();
        return fileName;
    }

    public void setFileName(String fileName) {
        this.fileName = fileName;
    }

    public StreamedContent getFile() {
        return this. file;
    }
} 
```

我的 XHTML 看起来像这样。

```
<h:form id="form">  
 <h:dataTable value="#{fileDownloadController.listfiles}" var="x" 
              bgcolor="#F1F1F1" border="10" cellpadding="5" 
              cellspacing="3" first="0" rows="4" width="50%" 
              summary="This is a JSF code to create dataTable.">
              <h:column>
                <f:facet name="header">
                <h:outputText value="File Names"></h:outputText>
                </f:facet>
                <h:commandLink value="#{x.fileName}" onclick="PrimeFaces.monitorDownload(showStatus, hideStatus)">
                        <p:fileDownload value="#{fileDownloadController.file}" />
                </h:commandLink>
             </h:column>
               </h:dataTable> 
</h:form> 
```

我无法弄清楚我哪里错了。请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T01:24:18.437

你是怎么开始使用的`#{x.fileName}`？仔细查看[类](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)[的 javadoc`java.io.File`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)。对，没有像`getFileName()`. 这*正是*异常试图告诉你的。

> value="#{x.fileName}"：在 java.io.File 类型上找不到属性“fileName”

您很可能打算改用该[`getName()`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#getName%28%29)方法。

```
#{x.name} 
```

* * *

**与具体问题无关**，如果您使用`var="file"`而不是荒谬的`var="x"`.

# c# - 将 C# 属性映射到数据成员的属性

> ID：12360381
> 
> 赞同：1
> 
> 时间：2012-09-10T22:35:27.377
> 
> 标签：c#, properties, syntactic-sugar

假设我有以下结构：

```
public class Inner
{
    public double Foo { get; set; }
}

public class Outer
{
    public double Bar { get; set; }

    private Inner MyInner;
} 
```

我想`Outer`自动转发`Bar`到`MyInner.Foo`. 有没有语法捷径？我宁愿不打字

```
public double Bar
{
    get
    {
        return MyInner.Foo;
    }
    set
    {
        MyInner.Foo = value;
    }
} 
```

每时每刻。我公司的代码风格指南要求所有大括号都换行，我的班级有几个这样的成员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:39:48.863

这几乎就是你的做法，并且没有任何语法糖可以缩短它。至于编码约定，我会反击；诸如“所有代码块大括号必须有换行符”之类的非常广泛的规则只是在等待像这种情况这样非常简单的事情变成空白混乱。但是，如果你不能说服他们做出例外，那真的不值得让自己被解雇。ReSharper 和其他重构助手会让你的属性看起来像这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:41:21.797

不，没有办法用自动属性来做到这一点。但是使用代码片段，您应该能够相当快地编写该代码。如果你像我一样养成了折叠代码（Ctrl + M + O）的习惯，它看起来也不会太糟糕。

# facebook-javascript-sdk - js fb api的likegate问题，对话框被阻止弹出

> ID：12360383
> 
> 赞同：0
> 
> 时间：2012-09-10T22:35:31.780
> 
> 标签：facebook-javascript-sdk, fb.ui

我将以下代码用于likegate，但弹出登录对话框被阻止。我的一个朋友说我可以用 fb subscribe 事件来做。有人这样做过吗？除非有办法欺骗框以显示：页面而不是弹出窗口的形式打开。

任何帮助表示赞赏。

```
FB.getLoginStatus(function(response) {

        var page_id = "XXX";

      if (response && response.authResponse) {
        var user_id = response.authResponse.userID;
        var fql_query = "SELECT uid FROM page_fan WHERE page_id = "+page_id+"and uid="+user_id;
        FB.Data.query(fql_query).wait(function(rows) {
          if (rows.length == 1 && rows[0].uid == user_id) {
            console.log("LIKE");
            $('#container_like').show();
          } else {
            console.log("NO LIKEY");
            $('#container_notlike').show();
          }
        });
      } else {
        FB.login(function(response) {
          if (response && response.authResponse) {
            var user_id = response.authResponse.userID;
            var fql_query = "SELECT uid FROM page_fan WHERE page_id = "+page_id+"and uid="+user_id;
            FB.Data.query(fql_query).wait(function(rows) {
              if (rows.length == 1 && rows[0].uid == user_id) {
                console.log("LIKE");
                $('#container_like').show();
              } else {
                console.log("NO LIKEY");
                $('#container_notlike').show();
              }
            });
          } else {
            console.log("NO LIKEY");
            $('#container_notlike').show();
          }
        }, {scope: 'user_likes'});
      }
    });
  }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:43:38.640

我想出了 PHP 的方式，它更好更容易......这是所有尝试的人的代码:)

```
$facebook = new Facebook(array(
'appId' => 'XXXXXX',
'secret' => 'XXX',
'cookie' => true
));
$sr = $facebook->getSignedRequest();
?>

<?php if ($sr['page']['liked']): ?>
<-- STUFF IF A FAN -->

<?php else: ?>
<-- STUFF IF NOT A FAN -->

<?php endif; ?> 
```

# php - 在 php 中，如何在 const 中设置 define-d 值？

> ID：12360385
> 
> 赞同：1
> 
> 时间：2012-09-10T22:35:32.057
> 
> 标签：php

让我们说在第一个脚本中，它总是首先执行，我定义了一些东西：

```
define ('ROOTDIR', dirname(__FILE__));
define ('ROOTDIR_ASSETS', ROOTDIR.'/assets'); 
```

现在上课：

```
class PictureGallery
{
    const PATH = ROOTDIR.'/imgs'; 
```

php 说：语法错误，意外的 '.' 期待''或';'。如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:41:44.540

[类常量是PHP必须的常量表达式](http://php.net/manual/en/language.oop5.constants.php)。因此，您要么必须`define`使用完整路径创建另一个 d 常量，要么必须将路径注入到类的构造函数中。或者只是在构造函数中设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:41:48.770

您不能使用字符串连接定义类常量。

您需要使用成员变量。如果您不希望更改此设置，我建议将其设为私有并仅创建一个获取器来访问它。

```
class PictureGallery
{
  private $_path;

  public function __construct()
  {
    $this->_path = ROOTDIR.'/imgs';
  }
  public function getPath()
  {
    return $this->_path;
  }
} 
```

或者

您也可以在定义类之前计算值，但是这是一个混乱的解决方案。

```
define('IMGDIR', ROOTDIR.'/imgs');
class PictureGallery 
{
  const PATH = IMGDIR;
  ...
} 
```

# ios - didEnterRegion 在前台工作，但不在后台或其他 VC 中工作

> ID：12360386
> 
> 赞同：9
> 
> 时间：2012-09-10T22:35:48.920
> 
> 标签：ios, cllocationmanager, region-management, clregion

如果应用程序正在运行并且 CLLocationManagerDelegate 类是前台（即可见），那么 didEnterRegions 会触发，我会同时获得 NSLog 和 AlertView。但是，当应用程序在后台时，或者本质上，如果屏幕显示除委托类之外的任何内容，我什么也得不到。

我在 plist 中的“必需的后台模式”下设置了“应用程序注册以进行位置更新”，尽管我不确定这是否有必要。

这是我认为的相关代码，尽管我可能是错的（并且很乐意添加更多）。我应该注意 viewDidLoad 中的所有内容都包含在 if 中，它检查区域监控是否可用并启用。

```
- (void)viewDidLoad
{
    NSLog(@"MapViewController - viewDidLoad");
    self.locationManager.desiredAccuracy = kCLLocationAccuracyNearestTenMeters;
    self.locationManager.distanceFilter = kCLLocationAccuracyNearestTenMeters;    
    self.locationManager.delegate = self;
    [self.locationManager startMonitoringSignificantLocationChanges];
}

- (void)locationManager:(CLLocationManager *)manager didEnterRegion:(CLRegion *)region
{
    NSLog(@"MapViewController - didEnterRegion");
    NSLog(@"MVC - didEnterRegion - region.radius = %f", region.radius);
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"entered region..." message:@"You have Entered the Location." delegate:nil cancelButtonTitle:@"OK"  otherButtonTitles: nil];
    alert.tag = 2;
    [alert show];
} 
```

这是我在 AppDelegate.m 中获得被监控区域列表的地方：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

// other code

NSLog(@"LISTING ALL REGIONS MONITORED");
    NSArray *regions = [self.locationManager.monitoredRegions allObjects];
    if (!regions) {
        NSLog(@"no regions found");
    } else {
        NSLog(@"got %d monitored regions", [regions count]);
        for (int i = 0; i < [regions count]; i++) {
            CLRegion *region = [regions objectAtIndex:i];
            NSLog(@"region %d's identifier = %@", i, region.identifier);
            NSLog(@"region: radius: %@", region.radius);
        }
    }

// other code
} 
```

我调用 startMonitoringForRegion 两次，这里是主要的地方：

```
- (void)doneButtonTapped {
    NSLog(@"doneButtonTapped");

    if (self.locationIdentifier) {
        if ([CLLocationManager regionMonitoringEnabled] && [CLLocationManager regionMonitoringAvailable]) {

            // core data setup
            NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
            NSEntityDescription *entityDescription = [NSEntityDescription entityForName:@"LocationReminder" inManagedObjectContext:self.managedObjectContext];
            fetchRequest.entity = entityDescription;
            NSPredicate *predicate = [NSPredicate predicateWithFormat:@"locationIdentifier == %@", self.locationIdentifier];
            fetchRequest.predicate = predicate;
            NSError *error;
            NSArray *results = [self.managedObjectContext executeFetchRequest:fetchRequest error:&error];
            if (results) {

                // get the LocationReminder
                LocationReminder *retrievedReminder = [results objectAtIndex:0];
                retrievedReminder.audioURI = [[[self.audioPlayers objectAtIndex:self.selectedCell] url] absoluteString];
                retrievedReminder.userRecording = nil;

                // start monitoring it's region
                NSArray *coordinateArray = [retrievedReminder.locationIdentifier componentsSeparatedByString:@", "];
                CLLocationCoordinate2D coordinate = {[[coordinateArray objectAtIndex:0] doubleValue], [[coordinateArray objectAtIndex:1] doubleValue]};
                CLRegion *newRegion = [[CLRegion alloc] initCircularRegionWithCenter:coordinate radius:250.0 identifier:retrievedReminder.locationIdentifier];
                NSLog(@"about to monitor region with radius: %f", newRegion.radius);
                [self.locationManager startMonitoringForRegion:newRegion desiredAccuracy:kCLLocationAccuracyBest];

                // save the LocationReminder
                if (![self.managedObjectContext save:&error]) {
                    NSLog(@"hmm.  no managed object context.  must be something space-time going on");
                } else {
                    NSLog(@"saved locationReminder, locationIdentifier = %@", retrievedReminder.locationIdentifier);
                }
            } else {
                NSLog(@"ERROR: no LocationReminder retreived for predicate: %@", predicate);
            }
        }

        // get the mapview controller off of the navigation stack
        for (UIViewController *viewController in self.navigationController.viewControllers) {
            if ([viewController isKindOfClass:[MapViewController class]]) { 
                MapViewController *mapVC = (MapViewController *)viewController;
                mapVC.audioURI = [[[self.audioPlayers objectAtIndex:self.selectedCell] url] absoluteString];
                [self.navigationController popToViewController:mapVC animated:YES];
            }
        }
} 
```

因为我觉得它可能很重要，所以这里是 locationManager 的 getter：

```
- (CLLocationManager *)locationManager {
    NSLog(@"MapViewController - locationManager");
    if (_locationManager) {
        return _locationManager;
    } else {
        _locationManager = [[CLLocationManager alloc] init];
        return _locationManager;
    }
} 
```

**更新 1：**通过 Apple 论坛（我在其中交叉发布）有人提到 AlertView 只会显示在前台。NSLog 仍然没有触发。我假设这应该有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T13:06:17.383

我的一个朋友写了一篇关于使用地理围栏的很好的教程，这可能有助于解决您遇到的一些问题。

[开始使用地理围栏](http://www.netmagazine.com/tutorials/get-started-geofencing-ios)

网上和这里有很多例子。从小处着手，一路向上。一旦你开始得到你的回调，你就可以开始将事情扩展到你的其他视图控制器。

*更新*

正如评论中解释的那样，创建一个单例类来控制您的位置管理器和委托方法的好处。通过使用单例，您可以防止多次调用您的委托方法。您可以通过仔细编码来防止这种情况，但使用单例可以为您做到这一点。这也是一个很好的类，可以处理委托方法需要完成的所有工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-11T06:40:28.173

你做错的事情：

1.  后台模式 - 应用程序注册位置更新。这不是必需的。当您想要收集有关位置等重大变化的信息时，这是需要的。因此，请转到 Targets > Your app > Capabilites ，然后在背景模式下选择所需的选项。这将自动为您更新 plist。现在，禁用它。
2.  您正在尝试在用户进入区域时创建警报。虽然这在应用程序运行时工作，但当您的应用程序处于后台时，警报是没有用的。**做**- 而是触发本地通知或 api 调用。

例如。通知：

```
 -(void)triggerLocalNotification:(CLRegion *)region{
    UILocalNotification *notification = [[UILocalNotification alloc]init];
    [notification setAlertBody:[NSString stringWithFormat:@"Welcome to %@", [region identifier]]];
    [notification setRepeatInterval:0];
    [notification setFireDate:[NSDate dateWithTimeIntervalSinceNow:2]];
    [notification setTimeZone:[NSTimeZone  defaultTimeZone]];
    [[UIApplication sharedApplication]scheduleLocalNotification:notification];
    NSLog(@"notification triggered with notification %@", notification);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-03T05:40:28.677

我想你需要去你的 app.plist

并添加所需的背景模式：添加 itme 应用程序寄存器以进行位置更新

和 1。如果您的应用程序在后台，您仍然会看到顶部的箭头

2、如果app被杀了，你仍然可以在顶部看到一个空心箭头，ios会为你监控区域，但仅限于20个区域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T04:35:08.550

您可以在 didEnterRegion 时发布本地通知。

即使您在后台，这也会显示类似警报的弹出窗口。

你可以做一个简单的测试：

1）在您的应用程序委托的 applicationDidEnterBackground 中创建一个本地通知对象，其中包含任何随机消息，并告诉本地通知立即触发。

2）按主页按钮，当您最小化应用程序时，您应该会看到一个弹出窗口。

# wpf - 棱镜：多个区域的共享视图

> ID：12360389
> 
> 赞同：1
> 
> 时间：2012-09-10T22:36:21.063
> 
> 标签：wpf, silverlight, prism

我尝试对位于不同视图中的多个区域使用单个视图。

```
View1 -> MyRegion1 uses SharedView
View2 -> MyRegion2 uses SharedView 
```

初始视图是 View1，它成功地显示了 SharedView。当我导航到 View2 时，它还显示 SharedView。现在，当我导航回 View1 时，SharedView 消失了。在导航更改期间，是否需要执行其他步骤才能在不同视图中呈现共享视图？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T08:17:59.403

不是 Prism，而是 WPF 想要拥有不同的视图实例。因此，对您的问题的简短回答是 - 不，这是不可能的。请以任何方式创建 SharedView 的不同实例

# javascript - 使用 HTML5 播放器时使用 Javascript 更改 Youtube 视频

> ID：12360393
> 
> 赞同：1
> 
> 时间：2012-09-10T22:36:32.943
> 
> 标签：javascript, jquery, html

我的网站上有一个 HTML5 YouTube 播放器：

```
<iframe id="video1" 
        width="600" 
        height="283" 
        src="youtubeurl" 
        frameborder="0" 
        allowfullscreen></iframe> 
```

这样就OK了。现在我想根据 JavaScript 函数调用更改正在播放的视频：

```
function doSomething() { ... } 
```

这是我尝试过的。

```
$("#video1").attr('src', 'otherURL' + '?' + "wmode=transparen");
$('#video1').hide();
setTimeout(function () { 
  $('#video1').show(); }, 100); 
```

但是什么也没有发生！我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-06T12:49:59.713

要控制 YouTube 播放器，您最好使用 YouTube API。这很容易。看看这个例子[http://jsfiddle.net/uLygZ/1/](http://jsfiddle.net/uLygZ/1/)我试图摆脱 jQuery 调用，但请注意我的脚本是在`document-ready`处理程序中执行的。

有关更多信息，请参阅[https://developers.google.com/youtube/](https://developers.google.com/youtube/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:09:39.783

您是否尝试过将 YouTube 播放器嵌入到您的页面中？如果你这样做，它会让你更轻松地尝试操作播放器功能。

一些嵌入式播放器功能包括：

```
 loadVideoByUrl()
 playVideo()
 nextVideo() 
```

您可以[在 YouTube JavaScript API 中找到所需的一切](https://developers.google.com/youtube/js_api_reference)

`iframe`您可以使用[此处详述的示例](https://developers.google.com/youtube/iframe_api_reference)将播放器嵌入到一个中。

# php - Codeigniter 库中的短函数

> ID：12360394
> 
> 赞同：2
> 
> 时间：2012-09-10T22:36:37.880
> 
> 标签：php, codeigniter, tankauth

我在我的 Codeigniter 包中安装了一个 Tank Auth 库，问题是我不喜欢如何`is_logged_in`调用函数，因为它很长而且不太友好，因为我需要使用：

`$this->tank_auth->is_logged_in()`

每次我想检查用户是否登录......那么有没有办法让它更短？通过说更短，我的意思是像`$this->logged();`？

如果有人可以帮助我，我将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:39:33.270

进入`tank_auth`库并定义一个新的公共函数：

```
public function logged(){
    return $this->is_logged_in();
} 
```

您现在可以使用`$this->tank_auth->logged();`

如果要缩短 的名称`tank_auth`，则必须重命名类和文件名。

## 更新：

更重要的问题是，你为什么这么多次调用它，以至于它变得很烦人？如果您的代码遵循 Don't Repeat Yourself (DRY) 原则，您应该只需要编写一次。

查看 Phil Sturgeon 题为[Keeping It DRY](http://philsturgeon.co.uk/blog/2010/02/CodeIgniter-base-Classes-Keeping-it-DRY)的博文。他将向您展示如何编写一个基础控制器，您的所有控制器都将从中继承。如果在基本控制器的构造函数中编写登录检查，则不必在每个控制器中都编写它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:40:05.937

我反对这样做，因为`logged()`您实例中的方法缺乏上下文。但是，如果您想这样做，您可以编写一个基本控制器，该控制器具有一个`logged()`最终返回的方法`$this->tank_auth->is_logged_in()`。所有控制器都将从这个基本控制器继承，这不是一个坏主意。

如果您使用库，则可以在其中实现类似的模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T22:43:51.947

`TankAuth`如果您没有创建库，您可能不想编辑库中的任何内容，因为这样做会影响库的可更新性。相反，您可以向控制器添加一个名为的方法，`logged`并让它与 Tank Auth 联系。虽然，正如前面的答案所指出的，我会为您的函数选择一个更好的名称。

创建或编辑您的控制器基类以具有如下内容：

```
function is_logged() {
   return $this->tank_auth->is_logged_in();
} 
```

然后你可以这样称呼它：`$this->is_logged();`

# sql - SQL包含不存在的连接表条目？

> ID：12360395
> 
> 赞同：0
> 
> 时间：2012-09-10T22:37:02.367
> 
> 标签：sql, postgresql, null, sql-order-by, left-join

我有一张`objects`桌子和`votes`桌子。我目前正在对它们进行分组并按最近的投票排序：

```
SELECT objects.id, objects.name, MAX(votes.created_at) AS mv 
       FROM "objects"
       INNER JOIN "votes" ON "votes"."object_id" = "objects"."id" 
       GROUP BY objects.id, objects.name 
       ORDER BY mv DESC 
```

但是，这只返回有投票的对象。我搜索了 SO 并找到了有关如何包含不存在的结果的答案，但我希望同时包含那些存在和不存在的结果。

有没有办法将上述所有没有投票的对象都添加到末尾？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:39:07.863

`INNER JOIN`基本上返回在两个表上都有记录的结果。然后您应该使用`LEFT JOIN`它，因为它从左侧返回所有行，无论它在右表上是否有匹配记录。

```
 SELECT objects.id, objects.name, MAX(votes.created_at) AS mv 
   FROM "objects"
          LEFT JOIN "votes" ON "votes"."object_id" = "objects"."id" 
   GROUP BY objects.id, objects.name 
   ORDER BY mv DESC 
```

**[JOIN 的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)**

希望这可以帮助。![在此处输入图像描述](../Images/2090e8bd384acfdaf9682c1b19685ac7.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:03:58.843

使用 a `LEFT JOIN`，`NULL`在找不到匹配行的地方填充值 - 正如[您自己发现的那样](https://stackoverflow.com/questions/12360395/sql-including-entries-of-join-table-that-dont-exist/12362159#comment16600023_12360421)：

> 超级令人沮丧，因为它完美地工作，除了所有没有投票的条目都在开头！

现在，`NULL`通常*排在最后*。但与之相反，`DESC`它是*第一位*的。在 Postgres 中，您可以使用[`NULLS LAST`](http://www.postgresql.org/docs/current/interactive/sql-select.html#SQL-ORDERBY)显式排序`NULL`到末尾（从 8.3 版开始）：

```
 SELECT o.id, o.name, max(v.created_at) AS lastest_vote
FROM   objects o
LEFT   JOIN votes v ON v.object_id = o.id 
GROUP  BY o.id, o.name
ORDER  BY lastest_vote DESC **NULLS LAST**, o.name; -- name only as tiebreaker
```

如果`objects.id`是主键，您可以简化`GROUP BY`（在 Postgres 9.1 或更高版本中）：

```
GROUP  BY o.id -- primary key covers all columns of this table 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T22:40:36.453

在您的陈述中使用`"LEFT OUTER JOIN"`而不是使用。`"INNER JOIN"`

干杯

# python - 如何在 Python 中进行区分大小写的字符串比较？

> ID：12360396
> 
> 赞同：4
> 
> 时间：2012-09-10T22:37:02.390
> 
> 标签：python, string

我正在尝试编写一个比较两个字符串的代码，如果找到匹配区分大小写的条件（大写除外），则返回该字符串。这就是我编写的函数，我了解到 == 非常适合区分大小写。但是，它仍然会为最后一个测试行打印一月，这不是预期的。那你能帮帮我吗？

```
 months = ['January',
      'February',
      'March',
      'April',
      'May',
      'June',
      'July',
      'August',
      'September',
      'October',
      'November',
      'December']

  def valid_month(month):
     for x in months:
         if x==month.capitalize() :
             print x 
```

测试代码：

```
 valid_month("january")  
  valid_month("January")
  valid_month("foo") 
  valid_month("") 
  valid_month("jaNuary") 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T22:43:17.930

这个怎么样：

```
def valid_month(month):
    for x in months:
        if x[1:] == month[1:] and x[0].capitalize() == month[0].capitalize():
            print x 
```

这将测试区分大小写的相等性 - 除了第一个字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T22:41:20.677

这是因为`"janUAry".capitalize()`等于`"January"`

```
In [4]: "January"=="janUAry".capitalize()
Out[4]: True 
```

您的代码的更好版本可以是：

```
def valid_month(month):
     if month and month[0].capitalize()+month[1:] in months:
         print(month)
     else:
         print(month,"is not found") 
```

**输出：**

```
>>> valid_month("january")
january
>>> valid_month("January")
January
>>> valid_month("foo")
foo is not found
>>> valid_month("")
 is not found
>>> valid_month("jaNuary")
jaNuary is not found 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T22:40:09.197

`capitalize`将您的字符串转换为小写，但第一个字母变为大写。因此，`"jaNuary".capitalize()`成为`"January"`并且您的测试是正确的。

显然，这不是正确的做法。您可以检查除第一个以外的任何字母是否为大写：

```
any(t.isupper() for t in month[1:]) 
```

如果是这样，就会失败。

# c# - StrongName 一个 .NET 程序集，无需访问原始密钥文件

> ID：12360400
> 
> 赞同：4
> 
> 时间：2012-09-10T22:37:12.000
> 
> 标签：c#, .net, strongname, strong-named-key

我对现有 .NET 程序集 dll 中的代码进行了一些更改。我没有用于签署代码的密钥文件。如何强制 .NET 可执行文件加载它，而不注册它以跳过验证（不可移植），而不删除 StrongNames（损坏应用程序）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-10T22:38:09.387

你不能，这就是强名称的全部意义所在。

强名称验证可执行文件未被非作者篡改。（假定拥有原始密钥文件的任何人都是作者。）由于您没有密钥文件，因此您一定不是作者，并且如此强的命名会阻止您进行您想做的更改。

如果要加载 DLL，则必须使用建议的任一解决方案。

**编辑** 自 .NET 3.5 SP1 起，只要满足以下条件之一，就会[**绕过**](http://blogs.msdn.com/b/shawnfa/archive/2008/05/14/strong-name-bypass.aspx)[强名称验证：](http://blogs.msdn.com/b/shawnfa/archive/2008/05/14/strong-name-bypass.aspx)

 ***   该程序集已使用 Authenticode 完全签名；
*   程序集完全受信任（不考虑其强大的名称证据）；
*   程序集被加载到完全受信任的 AppDomain 中（在大多数情况下桌面应用程序都会发生这种情况）；
*   程序集是从 AppDomain 下的位置加载的`ApplicationBase`（即程序集与应用程序一起分发并存在于同一目录中）。

基本上，除了 Silverlight 之外，每个用例都禁用了强名称验证。但是，系统管理员可以默认使用注册表项重新启用名称验证：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework]
"AllowStrongNameBypass"=dword:00000000 
```

微软表示，允许这种更改的原因是[强名称不是一种完整性检查机制](http://blogs.msdn.com/b/shawnfa/archive/2008/05/14/strong-name-bypass.aspx#9709168)，而是一种程序集识别机制。对于实际的完整性检查，Authenticode 是要走的路。

这意味着出于所有实际目的，强名称对于防止篡改没有用处，并且任何人都可以篡改任何程序集并且仍然可以正确加载它，除非系统管理员阻止它。

为了正确回答这个问题，应该提到修改程序集**将**使其强名称无效，因此如果 snk 不可用，则无法在不使强名称无效的情况下编辑 DLL。但是，在大多数情况下，它不会阻止它加载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T23:25:40.747

您可以在 Reflexil（.NET Reflector 插件）中编辑 .NET dll，并在修改后的代码上保留原始签名。谢谢您的回答。

对于那些希望编辑程序集而不退出程序集的人，请使用 Reflexil。仅仅因为人们不赞成这个答案，并不意味着它是错误的。**

# vba - 隐藏对 word doc 保存事件的控制

> ID：12360404
> 
> 赞同：-3
> 
> 时间：2012-09-10T22:37:50.977
> 
> 标签：vba, ms-word

我想隐藏对文档保存的控制，即文件->保存。但是没有运气。任何人都可以帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:39:37.390

尝试将您的代码放在文档关闭事件中。它应该可以工作。

# java - 为什么这个内部类可能是一个不兼容的 MBean？

> ID：12360405
> 
> 赞同：2
> 
> 时间：2012-09-10T22:37:51.703
> 
> 标签：java, jmx

似乎我的班级是内部班级这一事实导致了这个问题，这是我的预感 - 但基本上这是通常的模式：

```
public class UserProvisionerProfiler implements UserProvisionerProfilerMBean {

    @Override
    public int getTotalNumberOfUsers() {
        return activeClients.size();
    }
} 
```

和接口（嵌套在一个更大的类中）：

```
public interface UserProvisionerProfilerMBean {

public int getTotalNumberOfUsers();

} 
```

在代码中注册：

```
 UserProvisionerProfiler userProvisionerProfiler = new UserProvisionerProfiler();

    MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();
    ObjectName name = new ObjectName(userProvisionerProfiler.getClass().getPackage().getName() + ":type=" + userProvisionerProfiler.getClass().getName());

    mbs.registerMBean(userProvisionerProfiler, name); 
```

和错误：

```
 1356 [1;31mERROR[39m [main],            UserProvisioner  ; Unhandled exception caught in     main()
javax.management.NotCompliantMBeanException: MBean class UserProvisioner$UserProvisionerProfiler does not implement DynamicMBean, and neither follows the Standard MBean conventions (javax.management.NotCompliantMBeanException: Class UserProvisioner$UserProvisionerProfiler is not a JMX compliant Standard MBean) nor the MXBean conventions (javax.management.NotCompliantMBeanException: UserProvisioner$UserProvisionerProfiler: Class UserProvisioner$UserProvisionerProfiler is not a JMX compliant MXBean)
at com.sun.jmx.mbeanserver.Introspector.checkCompliance(Introspector.java:171)
at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:317)
at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:512)
UserProvisioner.registerThisAsMBean(UserProvisioner.java:734)
UserProvisioner.start(UserProvisioner.java:797)
UserProvisioner.main(UserProvisioner.java:844) 
```

除了阅读 JMX 规范或代码之外，我在找到更严格的兼容 MBean 定义方面收效甚微，所以我想知道是否可以挽救内部类，或者是否必须将其分离出来，或者是否有什么东西否则我失踪了。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-12T13:19:40.667

根据 JMX 规范，标准 MBean 必须由两部分组成：

1.  名为 MBean 的 MBean 接口
2.  MBean 实现命名并实现了 MBean 接口。

由于这些限制，当且仅当 MBean 接口也是同一包含类的静态内部类时，静态内部类才能成为 MBean 实现。

# javascript - 函数参数的值错误

> ID：12360410
> 
> 赞同：0
> 
> 时间：2012-09-10T22:38:09.603
> 
> 标签：javascript

此 javascript 函数参数在脚本运行时没有正确的值。如果我添加一条警告语句来打印参数值，它看起来正确并且脚本运行正常。这有什么可以解释的？

**＃添加**

```
<form name="add_event_form" id="add_event_form"><input id="event_id" name="event_id" style="visibility: hidden;"/><input id="event_title" name="event_title" style="position: absolute; top: 25px; left: 0px; margin-left: 49px; width: 432px;" onclick="clear_field_color(this);"/><label id="event_title_label" for="event_title" style="position: absolute; top: 30px; left: 0px; margin-left: 10px; ">Title</label><fieldset style="position: absolute; top: 55px; width:276px; padding:3px 5px 10px 5px;"><legend>Event Source</legend><input type="radio" id="select_LiveMass" name="source_select" value="LiveMass" CHECKED onClick="set_selected(\'LiveMass\');" style="margin-right: 5px;"/>LiveMass<br/><span id="channel_span" style="margin-left:20px; margin-right:5px;">Channel</span><select id="channel_list_id" name="channel_list" onfocus="set_radio_button(\'LiveMass\');" onclick="clear_field_color(this);" style="width: 200px;"><option value=""></option></select><br/><input type="radio" id="select_Other" name="source_select" value="Other" onClick="set_selected(\'Other\');" style="margin-right: 5px;"/>Other<br/><span id="event_site_span" style="margin-left:20px; margin-right:19px;">Name</span><input id="event_site" name="event_site" onfocus="set_radio_button(\'Other\');"  onclick="clear_field_color(this);" style="width:196px;"/><br/><span id="event_url_span" style="margin-left:20px; margin-right:37px;">Url</span><input id="event_url" name="event_url" onfocus="set_radio_button(\'Other\');"  onclick="clear_field_color(this);" onchange="validate_url();" style="width:196px;"/></fieldset><fieldset style="position: absolute; top: 55px; margin-left: 299px; width:170px; height: 119px; padding:3px 0px 10px 5px;"><legend>Event Schedule</legend>Start date<input id="start_date" name="start_date" class="date_select" onclick="clear_field_color(this);" style="width:89px; margin-left: 10px; margin-right: 0px;"/><br/>Start time <div style="display:inline;"><input id="start_time" name="start_time" style="width: 40px; margin-left: 6px; padding-left:0px;"/><select id="start_ampm" name="start_time_ampm"><option value="AM">AM</option><option value="PM">PM</option></select></div><br/>End date<input id="end_date" name="end_date" class="date_select" style="width: 89px; margin-left: 15px; margin-right: 0px;"/><br/>End time <div style="display:inline;"><input id="end_time" name="end_time" style="width: 40px; margin-left:11px; padding-left:0px;"/><select id="end_ampm" name="end_time_ampm"><option value="AM">AM</option><option value="PM">PM</option></select></div><div id="sched_buttons"><button href="#" id="event_remind" onclick="show_event_remind(); return false;" style="width: 80px;">Reminders</button>&nbsp;&nbsp;<button href="#" id="recur" onclick="show_event_recur(); return false;" style="width: 80px;">Recurrence</button></div></fieldset><fieldset id="notes" style="position: absolute; top: 192px; width:462px; padding:3px 5px 10px 5px;"><legend>Event Notes</legend><textarea id="event_notes" name="event_notes" style="width: 449px; height:110px; margin-left: 3px;"></textarea></fieldset><div id="event_buttons" style="position: absolute; top: 340px; right: 170px; width:auto;"><button href="#" id="save" onclick="save_event(0); return false;" style="width: 70px;">Save</button>&nbsp;&nbsp;&nbsp;&nbsp;<button href="#" id="cancel" onclick="cancel_event(); return false;" style="width: 70px;">Cancel</button></div></form> 
```

**####**

```
function set_radio_button(selection) {
    /* alert ('radio button selection '); */
    switch (selection) {
        case 'LiveMass':
            document.add_event_form.source_select[0].checked = true;
            break;

        case 'Other':
            document.add_event_form.source_select[1].checked = true;
            break;
    }
    set_selected(selection);
}

function set_selected(selection) {
    switch (selection) {
        case 'LiveMass':
            $('#event_site_span').prop("disabled", true);
            $('#event_site').prop("disabled", true);
            $('#event_url_span').prop("disabled", true);
            $('#event_url').prop("disabled", true);
            $('#channel_span').prop("disabled", false);
            $('#channel_list_id').prop("disabled", false);
            break;

        case 'Other':
            $('#channel_span').prop("disabled", true);
            $('#channel_list_id').prop("disabled", true);
            $('#event_site_span').prop("disabled", false);
            $('#event_site').prop("disabled", false);
            $('#event_url_span').prop("disabled", false);
            $('#event_url').prop("disabled", false);
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T00:10:06.360

在事件中，您的 HTML 中有错误`onClick`：

```
onClick="set_selected(\'Other\');" 
```

您正在使用双引号`"`来包装，`onClick`但是您正在使用***转义***的单引号`'`来分隔字符串`Other`。没有必要在这里逃脱它们；仅当您再次使用双引号时`(\"Other\")`。删除它们，它应该可以工作：

```
onClick="set_selected('Other');" 
```

请注意，对于 和 的其他出现，此错误会重复`(\'LiveMass\')`出现`(\'Other\')`。

**[演示](http://jsfiddle.net/m8xwL/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T17:45:54.950

我发现如果我有这个，它会起作用！

```
<input type="radio" id="select_LiveMass" name="source_select" value="LiveMass" CHECKED onClick="set_selected(\"LiveMass\");" style="margin-right: 5px;"/>LiveMass<br/>
<input type="radio" id="select_Other" name="source_select" value="Other" onClick="set_selected(\"Other\");" style="margin-right: 5px;"/>Other 
```

因此`set_selected(\'LiveMass\');`，我没有使用转义的单引号，而是使用`set_selected(\"LiveMass\");`了转义的双引号，这很有效。我想了解为什么。

# database - postgres 如何存储 django choice_fields - 获取关系的列“类型”不存在错误

> ID：12360420
> 
> 赞同：0
> 
> 时间：2012-09-10T22:39:06.250
> 
> 标签：database, django, postgresql, django-models, choicefield

我有一个带有选择字段的 CharField 类型，如下所示：

```
class Thing(models.Model):
    def __unicode__(self):
        return self.name

    A = 'a'
    B = 'b'
    C = 'c'

    TYPE_CHOICES = (
        (A, 'a'),
        (B, 'b'),
        (C, 'c'),
    )
        ...
    type = models.CharField(max_length = 1, choices=TYPE_CHOICES)
        ... 
```

现在，当我尝试访问页面添加/事物时，我在 /path/to/thing/add/ 关系“place_thing”的列“类型”不存在处收到 DatabaseError

我检查了数据库（postgres），发现类型不是错误中所说的列。

为什么同步或迁移数据库时没有添加类型字段？

如何在我的数据库 (postgres) 中创建列 'TYPE_CHOICES' 和 'type'？

有人可以向我解释一下数据库会为 Thing 类创建什么吗？

谢谢

凯蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T02:03:12.800

我最终使用

ALTER TABLE table_name ADD COLUMN type varchar(30);

这有效

我猜 TYPE_CHOICES 列已经创建

谢谢

# java - Java Criteria API：从一对多关系表中选择单列

> ID：12360427
> 
> 赞同：1
> 
> 时间：2012-09-10T22:39:27.553
> 
> 标签：java, jpa, persistence, jpql, criteria-api

我正在尝试从相关表中选择一列。我有一个包含许多值的表（项目）。我想选择 Value.valueString。

基本上，查询应该传入一堆值并提取包含这些值的任何 ValueFields。SQL 可能看起来像这样：

```
select ItemValues.valueString from ItemEntity
    join StockItem on ItemEntity.stockItemId = StockItem.id
    join ItemValues on ItemEntity.id = ItemValues.itemId
where StockItem.vendor = vendorId 
AND (ItemValues.valueString like '%test%' OR ItemValues.valueString like '%test2%'...); 
```

这是我的代码：

```
 final CriteriaBuilder builder = this.entityManager.getCriteriaBuilder();
        final CriteriaQuery<String> query = builder.createQuery(String.class);

        final Root<ItemEntity> root = query.from(ItemEntity.class);

        query.select(root.join("ItemValues").<String>get("ValueString"));

        final List<Predicate> filters = new LinkedList<Predicate>();

        filters.add(builder.equal(root.join("StockItem").get("id"), vendorNumber));
        final List<Predicate> filterNamesCriteria = new LinkedList<Predicate>();

        if (filenames.length > 0) {

            for (String fileName : filenames) {
                filterNamesCriteria.add(builder.like(root.join("ItemValues").<String>get("ValueString"), fileName));
            }
            filters.add(builder.or(filterNamesCriteria.toArray(new Predicate[0])));
        }

        query.where(filters.toArray(new Predicate[0]));

        final TypedQuery<String> resolvedQuery = this.entityManager.createQuery(query);

        return resolvedQuery.getResultList(); 
```

我希望结果返回一个字符串列表（valueString 列），但它没有返回任何内容。

难道我做错了什么？当我说“builder.createQuery(String.class)”时，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:51:03.210

我发现了问题：

```
filters.add(builder.equal(root.join("StockItem").get("id"), vendorNumber)); 
```

我是根据 StockItem id 而不是 StockItem.itemNumber 加入的

我使用了两个查询来解决加入 Itemvalues 映射的问题（它返回了 32,000+ 个结果）

# php - 在达到 codeigniter/tank auth 会话超时时处理 ajax 调用中的 php 重定向

> ID：12360430
> 
> 赞同：1
> 
> 时间：2012-09-10T22:39:40.470
> 
> 标签：php, javascript, codeigniter, xmlhttprequest, tankauth

嘿，我在 codeigniter 视图中有一个 javascript 函数，它从 codeigniter 控制器函数中检索一些信息，当达到用户会话的超时时，该函数的行为异常。在被调用的 php 函数中，我有一个如下所示的语句：

```
 if (!$this->tank_auth->is_logged_in()) {
  redirect(site_url('login'));} 
```

如果他们没有登录，这会将他们重定向到我的登录页面。但是在 javascript 函数中，我获取响应文本并将 div 的内容设置为等于它。

```
 xmlhttp = new XMLHttpRequest();
  xmlhttp.open("POST", "mycontroller/myfunction/", false);
  xmlhttp.send();
  document.getElementById("mydiv").innerHTML=xmlhttp.responseText; 
```

如果用户在调用此函数时已注销，它将返回登录页面的 responseText 并将其插入到 div 中，而不是重定向到登录页面。这看起来很可怕。如果用户会话在查看此页面时超时，我该如何阻止它执行此操作？我无法更改超时限制，因为其他应用程序依赖它。

真的，这根本不是 codeigniter 或 tank_auth 问题，只是当我最初使用该函数为 responseText 生成字符串时，如何从 ajax 请求中调用的 php 函数重定向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T14:05:43.577

您需要解析响应并确定它是否是您期望的响应类型。如果您期望少于一定数量的字符，您可以检查长度，但这可能不如检查特定的 dom 对象或字符串可靠。

你可以这样做，例如：

```
if(xmlhttp.responseText.length < 200) {
    document.getElementById("mydiv").innerHTML=xmlhttp.responseText;
} else { 
    window.location.href = 'some url';
} 
```

另一种选择是使用 CodeIgniter 的 AJAX 响应检查来执行其他操作，而不是加载视图（或加载不同的视图）：

```
if ($this->input->is_ajax_request())
{
    // do something else 
}
else
{
    // do what you were doing before
} 
```

希望这可以帮助！我会回避使用 PHP/CI 方法，因为听起来你会在代码中到处添加异常，这并不漂亮。不过，这完全取决于你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-01T09:11:48.907

如果你很了解你的登录设计。你可以像这样处理你的回应。

```
success: function (response) {

if(result.substring(0, 15) == '<!DOCTYPE html>') //Your login's HTML initials.
    window.location = site_url_path + 'login'; //session timeout redirection.
//your normal functionality

} 
```

当您在控制器的构造中编写重定向时，这将很有帮助。

# winforms - 单击树视图节点打开一个新的 MDI 表单，将注意力集中在第一个表单上

> ID：12360436
> 
> 赞同：0
> 
> 时间：2012-09-10T22:39:55.370
> 
> 标签：winforms, treeview, mdichild

单击树视图中的节点后，我试图打开一个新表单。

在第一个 MDI 表单中，我有一个树视图，当我单击树视图中的一个节点时，会打开第二个 MDI 表单，但第一个表单保持焦点。我希望新表格具有焦点。

我注意到第一个表单的 _Enter 事件正在触发，好像某些东西正在将焦点设置回第一个表单。

第一个表单上还有一个按钮，它具有相同的功能并且效果很好。我有一种感觉，treeview 设置了一些特殊的属性，以使焦点回到第一种形式。

这是打开表单的代码

```
 private void tvClientsAccounts_NodeMouseClick(object sender, TreeNodeMouseClickEventArgs e)
    {
        OpenClientOrAccount(e.Node);
    }

    private void OpenClientOrAccount(TreeNode Node)
    {
        if (Node.Tag is Client)
        {
            frmClients frmC = new frmClients();
            Client Client = (Client)Node.Tag;
            frmC.Id = Client.Id;
            frmC.HouseholdId = Client.Household.Id;
            frmC.MdiParent = Program.frmMain;
            frmC.Show();
        }
        else if (Node.Tag is Account)
        {
            frmAccounts frmA = new frmAccounts();
            Account Account = (Account)Node.Tag;
            frmA.Id = Account.Id;
            frmA.ClientId = Account.Client.Id;
            frmA.MdiParent = Program.frmMain;
            frmA.Show();
        }
    } 
```

这是定义树视图的设计器代码

```
 // 
        // tvClientsAccounts
        // 
        this.tvClientsAccounts.BackColor = System.Drawing.SystemColors.Control;
        this.tvClientsAccounts.Indent = 15;
        this.tvClientsAccounts.LineColor = System.Drawing.Color.DarkGray;
        this.tvClientsAccounts.Location = new System.Drawing.Point(228, 193);
        this.tvClientsAccounts.Name = "tvClientsAccounts";
        this.tvClientsAccounts.Nodes.AddRange(new System.Windows.Forms.TreeNode[] {
        treeNode9});
        this.tvClientsAccounts.PathSeparator = "";
        this.tvClientsAccounts.ShowNodeToolTips = true;
        this.tvClientsAccounts.Size = new System.Drawing.Size(411, 213);
        this.tvClientsAccounts.TabIndex = 23;
        this.tvClientsAccounts.BeforeExpand += new System.Windows.Forms.TreeViewCancelEventHandler(this.tvClientsAccounts_BeforeExpand);
        this.tvClientsAccounts.AfterExpand += new System.Windows.Forms.TreeViewEventHandler(this.tvClientsAccounts_AfterExpand);
        this.tvClientsAccounts.BeforeSelect += new System.Windows.Forms.TreeViewCancelEventHandler(this.tvClientsAccounts_BeforeSelect);
        this.tvClientsAccounts.AfterSelect += new System.Windows.Forms.TreeViewEventHandler(this.tvClientsAccounts_AfterSelect);
        this.tvClientsAccounts.NodeMouseClick += new System.Windows.Forms.TreeNodeMouseClickEventHandler(this.tvClientsAccounts_NodeMouseClick); 
```

感谢您的帮助拉斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:25:23.287

是的，TreeView 这样有点痛苦，它将焦点恢复到自身。这就是为什么它有 AfterXxx 事件，但没有 AfterNodeMouseClick 事件。解决它的方法是延迟执行该方法，直到*所有*事件副作用完成。这是通过使用 Control.BeginInvoke() 方法优雅地完成的，它的委托目标在 UI 线程再次空闲时运行。像这样：

```
 private void treeView1_NodeMouseClick(object sender, TreeNodeMouseClickEventArgs e) {
      this.BeginInvoke(new Action(() => OpenClientOrAccount(e.Node)));
  } 
```

# performance - Clojure 时间序列分析

> ID：12360437
> 
> 赞同：4
> 
> 时间：2012-09-10T22:39:56.710
> 
> 标签：performance, clojure

我有一个大型股票报价数据集（200GB 未压缩，9GB 在 bz2 -9 中压缩）。

我想对它们进行一些基本的时间序列分析。

我的机器有 16GB 的 RAM。

我宁愿：

*   将所有数据压缩后保存在内存中

*   即时解压缩该数据，并将其流式传输[所以没有任何东西会命中磁盘]

*   在内存中进行所有分析

现在，我认为这与 Clojure 的惰性和未来对象之间存在很好的交互（即，当我尝试访问它们时，我可以定义对象 st，我会即时解压缩它们。）

问题：在 Clojure 中进行高性能时间序列分析时，我应该记住哪些事项？

我对涉及的技巧特别感兴趣：

*   有效地将分时数据存储在内存中

*   高效地进行计算

*   奇怪的卷积来减少数据的传递次数

欢迎书籍/文章/研究论文建议。（我是一名 CS 博士生）。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:18:45.317

一些想法：

*   在存储压缩数据方面，我认为您不会比操作系统自己的文件系统缓存做得更好。只需确保将其配置为使用 11GB 以上的 RAM 进行文件系统缓存，并且它应该在第一次读取时将整个压缩数据集拉入内存。
*   然后，您应该能够定义您的 Clojure 代码以通过[ZipInputStream](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/zip/ZipInputStream.html)懒惰地拉入数据，这将为您执行解压缩。
*   如果您需要对数据执行第二次传递，只需在同一文件上创建一个新的 ZipInputStream。操作系统级别的缓存应确保您不会再次访问磁盘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T02:22:32.503

我听说过类似用 Java 实现的系统。有可能的。您肯定会想了解如何创建自己的惰性序列以完成此操作。如果您需要确保处理的是您想要处理的原始类型，我也会毫不犹豫地使用 Java。例如，Clojure 不会生成代码来对 32 位整数进行数学运算，它只会生成处理 long 的代码，如果您不希望这样做可能会很痛苦。

使您的内存格式与磁盘格式兼容也是值得的。这将为您提供内存映射文件的选项，或者（至少）在您的程序崩溃时使您的启动变得容易。例如，它可以只读取磁盘上的文件以恢复其先前的状态。

# django - Django-1.4.1 中奇怪的新目录结构？

> ID：12360446
> 
> 赞同：2
> 
> 时间：2012-09-10T22:40:46.890
> 
> 标签：django, directory-structure, django-1.4

我刚刚在 Ubuntu 12.04 上安装了最新版本的 Django (1.4.1)。新文档和我能够找到的所有其他内容似乎认为目录结构应如下所示：

```
mysite/
    manage.py
    mysite/
        __init__.py
        settings.py
        urls.py
        wsgi.py 
```

但是，运行`$ django-admin.py startproject mysite`导致以下目录结构：

```
mysite/
    __init.py__
    manage.py
    settings.py
    mysite/
        __init__.py
        settings.py
        urls.py
        wsgi.py
    templates/
    urls.py 
```

`mysite/urls.py`和之间似乎没有什么区别`mysite/mysite/urls.py`，区别在于文件的第 1 行，其中`mysite/urls.py`import 语句开始`from django.conf.urls.defaults`而不是`from django.conf.urls`. `settings.py`这两个文件之间也有类似的差别。

我的问题是：

*   这是错误的结果吗
*   我是否不小心下载了显示（出于某种原因）不正确版本号的主干
*   或者它应该是这样的，如果是这样，为什么，相似文件之间有什么区别，我应该如何使用它们？

**编辑：** Oberon 的回答为我解决了这个问题（谢谢！），但如果有人有任何想法，我仍然有兴趣首先了解问题所在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T22:50:01.310

我遇到了同样的问题，我所做的是删除 django 并重新安装它，它的工作方式就像你展示的第一个一样。

# iphone - iOS 表单身份验证

> ID：12360450
> 
> 赞同：-1
> 
> 时间：2012-09-10T22:41:20.220
> 
> 标签：iphone, objective-c, ios

我需要：

1）针对表单身份验证服务进行身份验证

2) 保存 cookie

3) 使用 cookie 调用 web 服务

我正在努力让它发挥作用。有没有人有这方面的运气？这似乎是一个非常常见的操作。

这是我的代码：

点击 auth URL 并获取 cookie：

```
- (IBAction)buttonGetCookieTap:(id)sender {
    [[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookieAcceptPolicy:NSHTTPCookieAcceptPolicyAlways];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:self.cookieURL];
    [request setHTTPShouldHandleCookies:YES];
    [request setHTTPMethod:@"POST"];
    self.urlConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
}

- ( void )connection: (NSURLConnection *)connection didReceiveResponse: (NSURLResponse *)response
{
    NSHTTPURLResponse *HTTPResponse = (NSHTTPURLResponse *)response;
    NSDictionary *fields = [HTTPResponse allHeaderFields];
    self.cookie = [fields valueForKey:@"Set-Cookie"];
}

- (void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge
{
    NSURLCredential *credential = [NSURLCredential credentialWithUser:@"blah"
                                                             password:@"blah"
                                                          persistence:NSURLCredentialPersistenceForSession];
    [[challenge sender] useCredential:credential forAuthenticationChallenge:challenge];
} 
```

现在使用 cookie 调用 auth 服务：

```
- (IBAction)buttonCallServiceTap:(id)sender {
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:self.dataURL];
    [request addValue:self.cookie forHTTPHeaderField:@"Cookie"];
    self.urlConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
} 
```

编辑：对不起，我遇到的问题是我只用会话 id 得到了一个准系统 cookie，但在服务器端，cookie 看起来很好。谁能验证我的 cookie 抓取代码没有问题？我已经尝试了很多变体并且遇到了同样的问题。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:40:31.283

[我在这里](https://stackoverflow.com/questions/771498/where-are-an-uiwebviews-cookies-stored/771545#771545)写了一个 Stack Overflow 问题的答案，它提供了用于检查应用程序 cookie 的示例代码。该线程中的其他人提供了用于获取应用程序端 cookie 详细信息的附加代码。您可以从那里开始，以帮助解决身份验证问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T18:53:33.303

我想出了如何做到这一点，我必须为 HTTP 正文构建一个肥皂消息。

```
NSString *soapFormat = [NSString stringWithFormat:@"<?xml version='1.0' encoding='UTF-8'?>\n"
                            "<soap:Envelope\n"
                                "xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n"
                                "xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n"
                                "xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n"
                                "<soap:Body>\n"
                                    "<Login xmlns=\"http://asp.net/ApplicationServices/v200\">\n"
                                        "<username>myusername</username>\n"
                                        "<password>mypassword</password>\n"
                                    "</Login>\n"
                                "</soap:Body>\n"
                            "</soap:Envelope>\n"];
    NSMutableURLRequest *request = [[NSMutableURLRequest alloc]initWithURL:self.authURL];
    [request addValue:@"text/xml; charset=utf-8" forHTTPHeaderField:@"Content-Type"];
    [request addValue:@"http://asp.net/ApplicationServices/v200/AuthenticationService/Login" forHTTPHeaderField:@"SOAPAction"];
    [request addValue:[NSString stringWithFormat:@"%d",[soapFormat length]] forHTTPHeaderField:@"Content-Length"];
    [request setHTTPMethod:@"POST"];
    [request setHTTPBody:[soapFormat dataUsingEncoding:NSUTF8StringEncoding]];
    self.authConnection = [[NSURLConnection alloc]initWithRequest:request delegate:self startImmediately:YES]; 
```

我可以从 didReceiveResponse 中获取 cookie

```
- ( void )connection: (NSURLConnection *)connection didReceiveResponse: (NSURLResponse *)response
{
    if (self.currentCookies == nil) {
        NSHTTPURLResponse *HTTPResponse = (NSHTTPURLResponse *)response;
        self.currentCookies = [NSHTTPCookie cookiesWithResponseHeaderFields:[HTTPResponse allHeaderFields] forURL:[NSURL URLWithString:@""]];
        NSLog(@"COOKIE: %@",((NSHTTPCookie*)[self.currentCookies objectAtIndex:1]).value);
    }
} 
```

然后我使用 cookie 从 web 服务获取 JSON 数据。

```
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:self.dataURL];
    [request setHTTPMethod: @"GET"];
    NSString *cook = [NSString stringWithFormat:@".ASPXAUTH=%@",((NSHTTPCookie*)[self.currentCookies objectAtIndex:1]).value];
    [request addValue:cook forHTTPHeaderField:@"Cookie"];
    [request setHTTPShouldHandleCookies:NO];
    self.dataConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

我希望这对拥有类似身份验证系统的人有所帮助。

# javascript - 两次运行函数后附加元素不显示

> ID：12360454
> 
> 赞同：0
> 
> 时间：2012-09-10T22:41:41.677
> 
> 标签：javascript, html, jquery-ui, jquery

我有一个正在处理的功能，基本上，如果我在显示 hiddend 后单击触发器，但是在单击触发器两次后，要显示的元素就消失了。我将不胜感激这方面的任何帮助。我在[http://www.jsfiddle.net/AUhPc/包含一个 jsFiddle](http://www.jsfiddle.net/AUhPc/)

```
$(function() {
/* Creating the overlay content elements needed */
    var overlay = $('<div class="overlay"></div>').appendTo('body');
    var overlay_content = $('<div class="overlay-content"></div>').appendTo(overlay);
    var overlay_content_inner = $('<div class="overlay-content-inner"></div>').appendTo(overlay_content);
    var btn_remove = $('<i class="i-remove">Close</i>').appendTo(overlay_content);
    //$('.user-comment-item').css({"position":"relative"})

    $('.my-list li .button').on("click", function() {
        var button = $(this);
//      overlay_content_inner.empty();
        overlay.fadeIn(300,function(){
            button.find('.user-comment-list').css({"display":"block"}).appendTo(overlay_content_inner);
        });
    });
    btn_remove.click(function(){
        overlay.fadeOut(300,function(){});
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:46:42.773

在您的点击处理程序中：

```
$("my-list li.button").off("click"); 
```

删除点击处理程序。您还可以使用：

```
$("my-list li.button").one("click", callback); 
```

如果您只希望点击回调发生一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:11:39.870

这是因为这条线而发生的

```
overlay_content_inner.empty(); 
```

您正在清除 overlay_content_inner div 中的内容，因此下次单击按钮时不会显示数据。

尝试删除该行，然后尝试..这应该不是问题..

# android - 从 NullPointerException 中的片段返回布局中获取选项卡主机

> ID：12360461
> 
> 赞同：2
> 
> 时间：2012-09-10T22:43:06.870
> 
> 标签：android, layout, nullpointerexception, android-tabhost, fragment

这是片段的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/lytContainer"
    android:layout_width="fill_parent"
    android:layout_height="match_parent"
    android:background="@drawable/bg"
    android:orientation="vertical" >

    <include
        android:id="@+id/include1"
        layout="@layout/header" />

    <RelativeLayout
        android:padding="5dp"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <FrameLayout
            android:id="@+id/lytImage"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:background="@drawable/round" >

            <ImageView
                android:id="@+id/imgRecibeImage"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="10dp"
                android:scaleType="fitXY"
                android:src="@drawable/img5" />

        </FrameLayout>
        <TabHost
            android:id="@+id/tabhost"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_alignParentRight="true"
            android:layout_below="@+id/txtRecibeComment"
            android:layout_marginTop="0dp" >

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:orientation="vertical" >

                <TabWidget
                    android:id="@android:id/tabs"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content" >
                </TabWidget>

                <FrameLayout
                    android:id="@android:id/tabcontent"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent" >

                    <LinearLayout
                        android:id="@+id/tab1"
                        android:layout_width="match_parent"
                        android:layout_height="match_parent" >
                    </LinearLayout>

                    <LinearLayout
                        android:id="@+id/tab2"
                        android:layout_width="match_parent"
                        android:layout_height="match_parent" >
                    </LinearLayout>

                    <LinearLayout
                        android:id="@+id/tab3"
                        android:layout_width="match_parent"
                        android:layout_height="match_parent" >
                    </LinearLayout>
                </FrameLayout>
            </LinearLayout>
        </TabHost>

        <TextView
            android:id="@+id/txtRecibeComment"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_below="@+id/lytImage"
            android:background="#000000"
            android:gravity="right"
            android:padding="5dp"
            android:text="Crispy Chicken and Sandwich Crispy Chicken and Sandwich Crispy Chicken and Sandwich Crispy Chicken and Sandwich "
            android:textColor="#ffffff"
            android:textSize="10sp" />

    </RelativeLayout>

</LinearLayout> 
```

这是片段的类

```
public class Tab1 extends Fragment {
    private TextView txtHeaderTitle;
    private TextView txtRecibeComment;
    private LinearLayout lytContainer;
    private ImageView imgRecibeImage;
    private ImageView imgHeader;
    DBHelper db;
    TabHost tabHost;
    Resources res;

    Intent i;

    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle b) {
        if (container == null) {
            return null;
        }
        LinearLayout rl = (LinearLayout)inflater.inflate(R.layout.recipe, container, false);
        db = new DBHelper(getActivity());
        txtHeaderTitle = (TextView) rl.findViewById(R.id.txtHeaderTitle);
        txtRecibeComment = (TextView) rl.findViewById(R.id.txtRecibeComment);
        lytContainer = (LinearLayout)rl.findViewById(R.id.lytContainer);
        imgRecibeImage = (ImageView) rl.findViewById(R.id.imgRecibeImage);
        imgHeader = (ImageView) rl.findViewById(R.id.imgHeader);
        imgHeader.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View arg0) {
            //  finish();
                Intent i = new Intent(getActivity(),RecipesListActivity.class);
                startActivity(i);

            }
        });

        tabHost = (TabHost) container.findViewById(R.id.tabhost);

        displayRecipe(getRecipe(getArguments().getInt("id")));
        TabHost.TabSpec spec;
        spec = tabHost.newTabSpec("Method");
        spec.setIndicator(setMyIndictors("طريقة التحضير","L"));
        i = new Intent(getActivity(),MethodActivity.class);
        i.putExtra("rId", getArguments().getInt("id"));
        spec.setContent(i);     
        tabHost.addTab(spec);

        spec = tabHost.newTabSpec("Ingredients");
        spec.setIndicator(setMyIndictors("مكونات الوصفة","R"));
        i = new Intent(getActivity(),IngredientsActivity.class);
        i.putExtra("rId", getArguments().getInt("id"));
        spec.setContent(i);
        tabHost.addTab(spec);

        tabHost.setCurrentTab(1);

        setTabColor(tabHost);
        tabHost.setOnTabChangedListener(new OnTabChangeListener() {

            @Override
            public void onTabChanged(String arg0) {
                setTabColor(tabHost);

            }
        });
        return rl;  
    } 
```

Taphost 为 NULL 的位置：错误为：

```
09-10 22:39:15.971: E/AndroidRuntime(1287): java.lang.NullPointerException
09-10 22:39:15.971: E/AndroidRuntime(1287):     at mobile.bh.activities.Tab1.setTabColor(Tab1.java:109)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at mobile.bh.activities.Tab1.onCreateView(Tab1.java:82)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:871)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1083)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:635)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1431)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.support.v4.app.FragmentManagerImpl.executePendingTransactions(FragmentManager.java:431)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.support.v4.app.FragmentPagerAdapter.finishUpdate(FragmentPagerAdapter.java:141)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.support.v4.view.ViewPager.populate(ViewPager.java:895)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.support.v4.view.ViewPager.populate(ViewPager.java:772)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.support.v4.view.ViewPager.onMeasure(ViewPager.java:1234)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.view.View.measure(View.java:8313)
09-10 22:39:15.971: E/AndroidRuntime(1287):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138) 
```

# mysql - 如何查找表中具有满足特定条件的列的最大条目数？

> ID：12360474
> 
> 赞同：1
> 
> 时间：2012-09-10T22:44:44.390
> 
> 标签：mysql, sql, sqlite

我不完全确定如何简单地表达这个问题，所以我会接受建议来重命名我的问题。我提前为这个问题看起来多么愚蠢而道歉，但我正在经历一个让我无法理解它的大脑放屁时刻。我想到的表是由以下人员创建的：

```
CREATE TABLE STRUCTURES (X INT(4),Z INT(4),TYPE CHAR(1),SEED_ID BIGINT); 
```

问题是，如何找到 TYPE='V' 和 SEED_ID 相同的最大条目数？我们称这个数字为 MAX_TYPE_V。

为了澄清，我正在使用查询：

```
SELECT SEED_ID 
FROM STRUCTURES 
WHERE TYPE='V' 
GROUP BY SEED_ID 
HAVING COUNT(SEED_ID)=MAX_TYPE_V; 
```

但我不知道如何找到 MAX_TYPE_V 以插入上述查询，所以我的解决方法是尝试从 1 到 2^31-1 的 MAX_TYPE_V 查询，直到查询对于某个数字 i 失败，这意味着 i-1 是我的最大值，但坦率地说，这是非常耗时且非常愚蠢的。我正在使用 SQLite3，所以任何答案都应该可以解决 MySQL 语法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:51:24.303

```
 SELECT SEED_ID,
         COUNT(*) AS cnt
    FROM STRUCTURES 
   WHERE TYPE='V' 
GROUP BY SEED_ID 
ORDER BY COUNT(*) DESC
   LIMIT 1 
```

# php - 如何确定 PHP CLI 脚本的输出是否正在通过管道传输到另一个命令？

> ID：12360476
> 
> 赞同：4
> 
> 时间：2012-09-10T22:44:53.577
> 
> 标签：php

> **可能重复：**
> [PHP 可以检测它是从 cron 作业还是从命令行运行？](https://stackoverflow.com/questions/190759/can-php-detect-if-its-run-from-a-cron-job-or-from-the-command-line)

我正在尝试确定 PHP 命令行脚本上的 STDOUT 资源是否正在通过管道传输到另一个命令，以便适当地显示表格数据（如果输出直接到终端，那么有表格单元格看起来不错包裹在`+-----+`边框中；但如果尝试使用`awk`或其他命令检查该数据，则不会。）

找到[这个答案](https://stackoverflow.com/questions/5572363/how-to-determine-if-a-stream-is-stdin-in-php)后，我尝试检查 STDOUT 资源`stream_get_meta_data()`以及我可以在 PHP 手册中找到的所有其他函数，这些函数对流进行操作，但在每种情况下，无论是通过管道传输到另一个资源，资源看起来都完全相同过程与否。

有没有办法在 PHP 中找到它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T22:55:17.830

你可以使用[`posix_isatty`](http://us2.php.net/manual/en/function.posix-isatty.php)假设你有 POSIX 扩展（你可能有）：

```
posix_isatty(STDOUT) 
```

如果它是真的，那么你没有输出到管道。 是在程序和其他程序`isatty`中执行此操作的常用方法。`C`

请注意，这不会检查它是否专门输出到管道，而只是检查它是否输出到交互式终端（管道不是一个）。

# git - Git 文档中的括号数字

> ID：12360478
> 
> 赞同：3
> 
> 时间：2012-09-10T22:45:13.120
> 
> 标签：git, unix

[Kernel.org Git 文档](http://www.kernel.org/pub/software/scm/git/docs/)中的括号数字是什么参考？

例如：`git(1) Manual Page` `git-add(1)` `git-am(1)`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-10T22:50:21.870

这些数字指的是 Unix 手册的[部分](http://en.wikipedia.org/wiki/Man_page#Manual_sections)。该符号并非特定于 git，它在 Unix 上的所有[手册页中都很常见。](http://en.wikipedia.org/wiki/Man_page)

# c# - C# Nhibernate - 向多对多关系添加新项目

> ID：12360479
> 
> 赞同：2
> 
> 时间：2012-09-10T22:45:40.887
> 
> 标签：c#, mysql, nhibernate, many-to-many, set

所以我有两个表（产品和供应商）通过多对多关系连接。它们的编码如下：

```
class Product
{
    public virtual uint id { get; set; }
    public virtual string name { get; set; }
    public virtual float stock { get; set; }
    public virtual float value { get; set; }
    public virtual Category category { get; set; }

    public virtual ISet suppliers { get; set; }
    public virtual ISet saleItems { get; set; }
    public virtual ISet stockInlets { get; set; }
} 
```

-

```
class Supplier
{
    public virtual uint id { get; set; }
    public virtual string name { get; set; }
    public virtual string CNPJ { get; set; }
    public virtual string addressLine1 { get; set; }
    public virtual string addressLine2 { get; set; }
    public virtual string telephone1 { get; set; }
    public virtual string telephone2 { get; set; }

    public virtual ISet products { get; set; }
    public virtual ISet stockInlets { get; set; }
} 
```

这就是我映射他们关系的方式：

```
<set name="suppliers" table="product_x_supplier" fetch="join" lazy="false">
  <key column="product_id" />
  <many-to-many class="Supplier" column="supplier_id" />
</set> 
```

-

```
<set name="products" table="product_x_supplier" fetch="join" lazy="false">
  <key column="supplier_id" />
  <many-to-many class="Product" column="product_id" />
</set> 
```

现在，我在插入新产品并尝试将相应的供应商链接到它时遇到问题。我确实设法更新了一个已经存在的，但没有创建一个新的。这是我尝试使用的（简化的）代码：

```
Product p = new Product()
{
    name = "Test product",
    stock = 0,
    value = 2,
    category = (Category)cats[0]
};

for (int i = 0; i < suppliers.Length; i++)
{
    p.suppliers.Add(suppliers[i]);
}

repository.Add(p); 
```

它告诉我`Object reference not set to an instance of an object.`。我试图实例化该对象，做了类似的事情，`p.suppliers = new IList<Supplier>();`但后来它抱怨了`Cannot create an instance of the abstract class or interface 'System.Collections.Generic.IList<TCC.Hibernate.Domain.Classes.Supplier>'`。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T22:48:51.037

采用...

```
p.suppliers = new List<Supplier>(); 
```

您的列表需要在添加项目之前进行初始化。`IList`是接口，不是类，需要使用`List`，默认实现`IList`。

顺便说一句，您似乎对 C# 语言或内置的 .NET 库不太熟悉。我建议在使用 Hibernate 等第三方库之前先熟悉基本的 C# 开发。Hibernate 是一个特别复杂的库，如果您在诊断这些简单的错误时遇到麻烦，这会让您感到头疼。

祝你好运！

**更新：**

抱歉，我没有注意到您的字段类型是`ISet`，不是`IList`。您将不得不使用像`ISet`Sly在他们的回答中展示的那样的实现。`HashSet``SortedSet`

您可以浏览 MSDN 以了解有关这些集合类型的更多信息...

[http://msdn.microsoft.com/en-us/library/0sbxh9x2](http://msdn.microsoft.com/en-us/library/0sbxh9x2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T07:11:16.103

采用

```
 class Supplier
 {
      public Supplier()
      {
          this.suppliers = new HashedSet<Supplier>();
      }

      public virtual ICollection<Product> products { get; private set; }
 } 
```

这样，您将确保始终初始化集合并且没有人可以替换它。

# java - 如何修复由 JTable 事件生成的 StackOverflowError？

> ID：12360483
> 
> 赞同：1
> 
> 时间：2012-09-10T22:45:56.190
> 
> 标签：java, swing, netbeans, jtable

当我尝试用同一行的其他两个单元格相乘来填充一个单元格时，我得到一个 StackOverflowError。这是代码：

```
tableModel.addTableModelListener(new TableModelListener(){
            public void tableChanged(TableModelEvent e)
            {
                DefaultTableModel model = (DefaultTableModel)e.getSource();
                //Object data = model.getValueAt(e.getFirstRow(), e.getColumn());
                if (e.getColumn() == 0)
                {
                    Object data = model.getValueAt(e.getFirstRow(), e.getColumn());
                    String stockSymbol = (String)data;
                    XMLService2 myService = new XMLService2(stockSymbol);
                    String stockName = XMLService2.getStockName();
                    model.setValueAt(stockName, e.getFirstRow(), e.getColumn() + 1);
                }
                if (model.getValueAt(e.getFirstRow(), 2) != null && model.getValueAt(e.getFirstRow(), 3) != null)
                {
                    Double myDouble =(Integer)model.getValueAt(e.getFirstRow(), 2)*(Double)model.getValueAt(e.getFirstRow(), 3);
                    model.setValueAt(myDouble, e.getFirstRow(), 4);
                }
            }
        }); 
```

调用 setValueAt 函数的这段代码的最后一行产生了 StackOverflowError。谢谢你。

PS：该表由 5 列组成。第三列的类型是整数。第 4 列的类型是 Double。得到第 3 个和第 4 个单元格相乘结果的第 5 列的类型是 Double。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T22:57:51.303

程序陷入无限递归循环（至少在堆栈溢出之前），因为最后`model.setValueAt`一行触发了另一个`tableChanged`事件。尝试将第二个条件语句更改为

```
if (e.getColumn() != 4 && model.getValueAt(e.getFirstRow(), 2) != null && model.getValueAt(e.getFirstRow(), 3) != null) 
```

这应该可以防止在更新最后一列时重新触发事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:04:39.487

我认为更好的方法是向网格提供自定义 TableModel，其中 getValueAt 被覆盖，因此您想要的操作在那里执行（col3 * col5）。

[http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/table/TableModel.html](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/table/TableModel.html)

# java - 当需要 Scala 的 List 时，使用 java.util.List 从 Java 调用 Scala 代码

> ID：12360485
> 
> 赞同：7
> 
> 时间：2012-09-10T22:46:26.677
> 
> 标签：java, scala, scala-java-interop

我在 Scala 中编写了一个 API。有几个入口点，我期望 List[SomeTrait] 作为输入并返回 List[OtherTrait]。

我将该 Jar 包含在 Java 项目中以供使用，并在尝试将 java.util.List 传递给期望 Scala 的 List 对象的方法时遇到问题。我意识到它们不一样，Java 不知道如何进行转换。那么，如何在不期望 Java 调用者传入 Scala 列表的情况下完成这项工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-10T22:46:26.677

我很想听听其他建议，但这是我找到的解决方案，我在 Google 上的任何地方都找不到。

如果我的普通 Scala 入口点是这样的方法：

```
def doSomething(things: List[Thing]): List[Result] = { ... } 
```

我添加了另一个这样的方法：

```
//import scala.collection.JavaConversions._
import scala.collection.JavaConverters._

def doSomething(things: java.util.List[Thing]): java.util.List[Result] =
  doSomething(things.asScala.toList).asJava 
```

对原始方法的调用中的显式转换是因为它最终会进入一个无限循环调用自身。

这是我第一次尝试发布和回答我自己的问题......如果我错过了一些标准的方法来做这件事，我深表歉意。似乎值得分享，也值得讨论更好的方法，因为我对 Scala 还很陌生。

**编辑**更新代码以反映@Luigi Plinge 的建议

# mongodb - 手动创建的_id上的MongoDB范围查询

> ID：12360491
> 
> 赞同：0
> 
> 时间：2012-09-10T22:46:46.790
> 
> 标签：mongodb, primary-key, composite-primary-key

我有一个用例，其中存储由以下内容组合而成的 _id 将非常有用：

1.  96 位整数
2.  96 位整数
3.  96 位整数对象 ID

这相当于一个 36 字节的 ASCII 字符串。它将被字节反转成为大端。

我想查询“给我所有 _id 以 {1} 连接 {2} 开头的文档。” 这将返回 _id 与上面的组件 1 和 2 匹配的文档，其中包含任何 3。

是的，这是一种 Cassandra 方法。我剩下的查询只能在 MongoDB 中实际完成。

我怎样才能做到这一点？

作为参考，我使用的是 C#。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T06:08:38.480

将 ID 保存为 36 字节的 ascii 字符串后，您可以使用[正则表达式](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-RegularExpressions)匹配来查找索引中的前缀子字符串。

在 MongoDB 中有效使用带有正则表达式的索引的注意事项是：

*   正则表达式匹配应该是左根的（这将是您的“_id 以”搜索的情况）
*   索引区分大小写

查询类似于：

```
/* Assumption: comp1 and comp2 are ASCII string representations
   that can be combined for a key prefix */

var spec = new Document("_id", new MongoRegex(string.Format("^{0}{1}", comp1, comp2)));
collection.Find(spec) 
```

# windows - 如何在 Microsoft Visual Studio 2010 上配置 Glib？

> ID：12360492
> 
> 赞同：5
> 
> 时间：2012-09-10T22:46:49.137
> 
> 标签：windows, visual-studio-2010, glib

我正在尝试将编写用于在 Linux 上工作的 C 项目移植到 Windows。这是一个依赖 CUDA 和 Glib 库的简单项目。

我相信最好的方法是使用 Microsoft Visual Studio 2010 进行编译，但我不知道如何将 Glib 链接到这个项目。CUDA 代码运行良好，但每次调用 Glib 方法都会生成“未解析的外部符号”错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:31:46.533

i just solved my problem using this guide to configure GTK on Visual Studio 2008: [http://www.etechplanet.com/blog/visual-studio-2008-configuration-for-gtk2b-gui-development.aspx](http://www.etechplanet.com/blog/visual-studio-2008-configuration-for-gtk2b-gui-development.aspx)

The only change i done was about the Tools/Options/VC++ Directories because this was deprecated on VS2010\. I added the paths directly to the project properties.

# networking - IP校验和计算不正确

> ID：12360494
> 
> 赞同：1
> 
> 时间：2012-09-10T22:47:09.330
> 
> 标签：networking, ip, checksum

我在计算我的数据包的正确 ip 校验和时遇到了麻烦。这是代码，我将解释我在做什么以及出了什么问题..

```
u_short checkSum(u_short *data, int byteCount){
int i, sum = 0;

for(i = 0; i < byteCount/2; i++){
    if(i == 5) continue;
    sum += *data++;
}

while(sum >> 16)
sum = (sum & 0xffff) + (sum >> 16);
return (u_short)~sum;
} 
```

首先，我的函数一般用于计算发送数据的 16 位校验和。甚至假设字节数仅用于测试目的。sum 是我保存 32 位和的变量（当 16 位和溢出时，我可以将溢出保持在高 16 位一半）。随着 for i 循环遍历数据的 16 位块并将它们相加，增加数据指针（增加 16 位它是 u_short），有一个 if 测试来跳过标头的校验和部分.. 可以看出在 rfc 791 中，校验和部分是标头中的第 6 个 16 位块（在我的情况下为 5，因为我从 0 开始计数）。数据相加后，我将高 16 位添加到低 16 位，并将 32 位 int 折叠成 16 位短。最后，我反转位（一个补码）并将 32 位缩短为 16 位并将其返回给调用者函数。

这没有提供从 pcap 发送给我的正确校验和（我用它来嗅探数据包）。这就是我调用我的函数来比较结果的方式..

```
if(etherHdr->ether_type == 8){
    ipHdr = (struct ip*) (packet + sizeof(struct ether_header));
    printf("chck: %04x mychck: %04x\n\n", ipHdr->ip_sum, checkSum((u_short*)ipHdr, sizeof(struct ip)));
} 
```

if 仅过滤掉 IP 数据包（以太网标头类型字段中的代码 8）..

这是我运行程序时的输出..

chck：ef66 mychck：06ee

查克：3db8 查克：0264

查克：9615 查克：0000

chck：edef mychck：ff64

查克：59f1 查克：0164

查克：49f1 查克：0264

查克：a3d4 查克：0c77

查克：e36b 查克：0264

chck：aad4 mychck：0c77

查克：46d1 查克：0c77

查克：f40b 查克：0264

查克：a8d4 查克：0c77

我下载了在网上运行的其他代码示例，当 pcap 将数据包转发到我的代码时，这些示例都没有给出每个 IP 标头包含的结果。

可以的话请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T00:26:35.173

正确的方法在[RFC 1071](https://www.rfc-editor.org/rfc/rfc1071)中给出。你已经接近了，但还没有雪茄。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T14:04:51.270

也许试试这个计算校验和的源代码，我正在使用它，它对我的​​软件很有用。

```
 int
checksum
            (unsigned short *   data,
            int         length)
{
    register int                nleft   = length;
    register unsigned short     *   w   = data;
    register int                sum = 0;
    unsigned short              answer  = 0;

    while (nleft > 1)
    {
        sum     += *w++;
        nleft   -= 2;
    }

    if (nleft == 1)
    {
        *(unsigned char *)(&answer) = *(unsigned char *)w;
        sum+=answer;
    }

    sum = (sum>>16) + (sum & 0xffff);
    sum += (sum>>16);
    answer = ~sum;

    return answer;
} 
```

# java - 3D 宇宙中的 Z 是什么？

> ID：12360499
> 
> 赞同：3
> 
> 时间：2012-09-10T22:48:11.553
> 
> 标签：java, 3d, cube

我正在用 Java 创建一个 3D 渲染器，它目前可以使用点和线渲染立方体的线框并旋转立方体，问题是，Z 应该是什么？Z 应该设置什么？我猜立方体的大小应该设置为Z？

谢谢你的时间！任何答案将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T22:50:02.370

如果当前视口位于 xy 平面，Z 通常表示平面外方向。

您的 3D 世界有自己的坐标系。渲染时，您将从 3D 世界坐标转换为视口坐标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T23:28:18.563

我认为您可能在这里遗漏了一些基本的学校数学/几何。然而，实际上并不难理解。

想象一个平面，例如一张纸。

*   第一个坐标轴将从左到右直线移动，我们称之为 X。所以 X = 0 表示您的点在左边界上。X = 10 可能意味着您的点在右边界上（实际上取决于您定义 1 的单位有多大；这可能以厘米、英寸等为单位）。这已经足以描述一维中的某个点（从左到右）。

*   现在，我们需要第二个轴。我们称它为 Y。它从上边界 (Y = 0) 到底部 (Y = 10)。现在您可以描述平面上的任何点，因为您有两个位置。例如， (0, 0) 将是左上角。(10, 10) 将是右下角。(5, 0) 将是上边框的中心点，等等。

*   如果我们再增加一个维度会发生什么？称它为 Z。这基本上是您的点在工作表上方的高度。例如，Z = 0 可能意味着您的点位于画家纸上，而 Z = 10 意味着您的点位于纸上方 10 厘米处。现在你用三个坐标来描述一个点：(5, 5, 0) 是纸的中心。(5,5,5) 是立方体的中心，位于填充纸上，高 10 厘米。

在 3D 中编程时，您可以使用相同的术语。唯一真正的区别是，您使用所谓的投影/视图矩阵来确定如何在屏幕上显示此 3d 位置。最简单的变换可能是以下矩阵：

```
1 0 0
0 1 0 
```

将其与您的 3d 坐标相乘，您将得到以下两项：

2d-x = 3d-x 2d-y = 3d-y

这导致您从正上方查看立方体（或您要显示的任何内容）基本上再次忽略 Z 轴（您不能渲染突出显示的东西，除非使用某种 3d 眼镜或类似技术） .

* * *

总的来说，如何使用坐标并解释它们取决于您。通常 x 和 y 指的是平面（地面上的位置或 2D 世界内的位置），而 z 可能是高度或深度（前或后）。这真的取决于具体情况。但总的来说，它实际上只是另一个维度，如 x 和 y。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T23:10:54.857

3D 意味着 3 个“维度”。一维是“X”，另一个是“Y”，第三个是“Z”。没有一个有特定的方向，尽管按照惯例指定一个方向很方便，例如“前进”、“左”和“上”。

X、Y 和 Z 值都等于 0 的东西位于空间的*原点*或中心。您可以将其写为 (0,0,0)，其中参数的顺序为 (x,y,z)。

位置 (1,0,0) 处的点或顶点在 X 方向上距离原点一个单位。因此，如果您从 (0,0,0) 移动到 (1,0,0)，您将纯粹在 X 方向上移动。

(0,1,0) 在 Y 方向上距离原点一个单位。

(0,0,1) 在 Z 方向上距离原点一个单位。

(1,1,0) 是 X 方向一个单位，Y 方向一个单位。因此，如果 X 表示“前进”，Y 表示“左”，则 (1,1,0) 是原点的左前和左前。

所以一个基本的立方体可以由以下顶点定义：

```
(1,1,-1)
(1,-1,-1)
(-1,1,-1)
(-1,-1,-1)
(1,1,1)
(1,-1,1)
(-1,1,1)
(-1,-1,1) 
```

# xaml - 布局 GridView 内容时遇到问题？

> ID：12360501
> 
> 赞同：0
> 
> 时间：2012-09-10T22:48:34.057
> 
> 标签：xaml, microsoft-metro

我有这个网格视图正确加载动态内容。但是我不太清楚如何让它满足我的需求。我希望内容从左上角开始，然后向下创建实例，直到不再适合（这应该是 4），然后从原始项目右侧的顶部开始。

maxRowsOrCols 属性给了我我想要的行为，但我肯定会超过 4 列。

请教我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:53:16.583

您可以将 ItemsPanel 与 WrapGrid 一起使用。方向属性首先是水平或垂直。这应该允许您根据需要设置布局，具体取决于屏幕大小和 ItemTemplate。

```
<GridView.ItemsPanel>
   <ItemsPanelTemplate>
      <WrapGrid MaximiumRowsOrColumns="4" Orientation="Vertical"/>
   </ItemsPanelTemplate>
</GridView.ItemsPanel> 
```

# inno-setup - 运行时错误（-1:0）：无法使用 InnoSetup 导入 ISSkin.dll

> ID：12360514
> 
> 赞同：2
> 
> 时间：2012-09-10T22:50:17.730
> 
> 标签：inno-setup, failed-installation

我的程序在安装了 ISSkin 的计算机中安装良好。然后我尝试将我的程序安装在未安装 ISSkin 的另一台计算机上，安装时收到此消息：**“运行时错误（在 -1:0）：无法导入 dll:c:\Folder00\ISSkin.dll”。**

我在网上搜索，但目前没有。我的 INNO 中有以下代码：

```
[Files]
Source: "c:\Folder00\ISSkin.dll"; DestDir: {tmp}; Flags: dontcopy; Attribs: hidden system

[Code] 
procedure LoadSkin(lpszPath: String; lpszIniFileName: String); external 'LoadSkin@c:\Folder00\ISSkin.dll cdecl';

procedure UnloadSkin();
external 'UnloadSkin@c:\Folder00\ISSkin.dll cdecl' 
```

我正在为 innosetup 使用 *.cjstyles 皮肤。我从 STDCALL 更改为 CDECL 但无济于事。有没有人遇到过这个问题以及如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:14:46.433

您正在将 dll 提取到临时文件中，但尝试从某些 'c:\folder00\' 中加载它，这很可能在目标计算机中不存在。

按照产品页面上的[示例](http://isskin.codejock.com/gettingstarted.asp)，你会没事的。链接示例中的相关部分：

```
[Files]
Source: ISSkin.dll; DestDir: {app}; Flags: dontcopy
Source: Office2007.cjstyles; DestDir: {tmp}; Flags: dontcopy    

[Code] 
procedure LoadSkin(lpszPath: String; lpszIniFileName: String); external 'LoadSkin@files:isskin.dll stdcall';

function InitializeSetup(): Boolean;
begin
  ExtractTemporaryFile('Office2007.cjstyles');
  LoadSkin(ExpandConstant('{tmp}\Office2007.cjstyles'), '');
  Result := True;
end; 
```

# xcode - Xcode 自动补全

> ID：12360517
> 
> 赞同：9
> 
> 时间：2012-09-10T22:50:54.583
> 
> 标签：xcode, autocomplete

有没有办法只查看实例的直接属性？

它向我展示了实例具有的所有方法和属性，包括它的所有基类。我想知道我是否可以设置 xcode 以首先向我显示直接属性？

例如：一个 EKEvent 实例。我想知道它有什么属性而不​​使用 cmd+click 进入它的 h 文件。它向我展示了一长串难以浏览的继承属性。

有人知道如何使它更容易吗？

![一个 xcode 自动完成示例](../Images/eead0f292fa3b8dbd229ed934f17aeda.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T05:58:11.957

这在当前版本中是不可能的。我希望Apple将来会实施它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T11:54:39.117

如果你向右走（就在滚动条之前），应该会出现一个问号，你可以点击它。如果对象已经写在代码中，您也可以按 Alt+单击。

# html - html和css标识元素

> ID：12360525
> 
> 赞同：0
> 
> 时间：2012-09-10T22:52:09.177
> 
> 标签：html, css, image, identify

怎么用css和html在左右两边放置一个带有div标签的图片？或者，还有更好的方法？例如我有：

HTML：

```
<img src ="..." .... ... />     <!--Picture 1-->
<img src = "..." .... .... />       <!--Picture 2--> 
```

CSS：

```
img
{
align:left
} 
```

这将使两个图像都向左对齐。如何“识别”两个图像元素，然后将一个左对齐，另一个右对齐。两个图像都相对于居中的 Java 小程序对齐。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:56:37.020

您还可以使用 :first-child 伪选择器来减少 HTML 代码。

例如：

```
<div id="pictures">
    <img src="..." />     <!--Picture 1-->
    <img src="..." />     <!--Picture 2-->
</div>

#pictures img:first-child{
  float: left;
}

#pictures img {
  float: right;
} 
```

这将使目标 div 中的第一个图像向左浮动，而其他所有图像都向右浮动。如果您只有一两张图片，那就太好了，但如果您有多张图片，则按照其他评论中的建议添加类可能会更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T22:54:35.163

你可以用“类”标签来识别

```
<img src ="..." class="img1" />     <!--Picture 1-->
<img src = "..."class="img2" />       <!--Picture 2-->

.img1
{
...
}

.img2
{
 ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T23:22:03.523

```
<img src="..." id="image_1" />     <!--Picture 1-->
<img src="..." id="image_2" />     <!--Picture 2-->

#image_1 {
  float: left;
}

#image_2 {
  float: right;
} 
```

注意：删除“=”前后的空格，就像“src”一样

# php - 如何为 PHP 安装 OpenCV？

> ID：12360527
> 
> 赞同：0
> 
> 时间：2012-09-10T22:52:20.577
> 
> 标签：php, linux, opencv

我正在尝试为 PHP 安装 OpenCV，但它不起作用。
[https://github.com/mgdm/OpenCV-for-PHP](https://github.com/mgdm/OpenCV-for-PHP)
我做了以下

安装 OpenCV

> $ sudo aptitude 安装 libcv2.1

试图为php安装opencv

> $ sudo phpize && ./configure && make && make install

尝试使用它，但出现错误

> $ php 示例/test_convert.php

`php: symbol lookup error: /usr/lib/php5/20090626/opencv.so: undefined symbol: cvSetErrMode`

我认为 PHP 的 OpenCV 需要 OpenCV 库地址，

> $ ldd /usr/lib/php5/20090626/opencv.so
> linux-vdso.so.1 => (0x00007fff45de2000)
> libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fd2d74c3000)
> /lib64/ld-linux-x86-64.so.2 (0x00007fd2d7a8a000)

所以我尝试了这个

> $ phpize
> $ ./configure
> 编辑 Makefile
> < OPENCV_SHARED_LIBADD =
> > OPENCV_SHARED_LIBADD = /usr/lib/libcv.so.2.1
> $ make
> $ sudo make install

它仍然不起作用。
我正在使用 Ubuntu11.04。
你有什么主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:29:10.633

[http://www.xarg.org/project/php-facedetect/](http://www.xarg.org/project/php-facedetect/)是一个非常好的在 linux 机器上安装 OpenCV 的教程，如果你对 PHP & Apache Web Server 有一点了解，这个教程会对你有很大帮助

研究生

乌迈尔·伊克巴尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-17T08:48:11.560

*   你可以试试这个[https://github.com/hihozhou/php-opencv](https://github.com/hihozhou/php-opencv)
*   支持最新的php7+和opencv3.3+
*   文档： http: [//phpopencv.org/docs](http://phpopencv.org/docs)
*   除了基本的图像处理，还实现了人脸检测和人脸识别

例如：

```
use CV\Face\LBPHFaceRecognizer;
//use ...;

$src = imread('facePic.jpg');
$gray = cvtColor($src, COLOR_BGR2GRAY);
equalizeHist($gray, $gray);
$faceRecognizer =                 LBPHFaceRecognizer::create();
/* ... */ //get $images and $labels for train
$faceRecognizer->train($images, $labels);//How to get $image and $labels, see the document
/* ... */ //Face detection using CascadeClassifier
$faceLabel = $faceRecognizer->predict($gray);
/* ... */ //draw face and name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-02T10:01:12.173

如果有人需要，我对库进行了一些改进： [https ://github.com/ProGM/OpenCV-for-PHP](https://github.com/ProGM/OpenCV-for-PHP)

我修复了 php5.4 的编译并为您的问题添加了解决方案。按照安装指南： [https ://github.com/ProGM/OpenCV-for-PHP/wiki/Installation-guide](https://github.com/ProGM/OpenCV-for-PHP/wiki/Installation-guide)

问候。

# jquery - 将 id 传递给 jQuery

> ID：12360528
> 
> 赞同：2
> 
> 时间：2012-09-10T22:52:26.780
> 
> 标签：jquery

我还在学习 jQuery，但遇到了问题。我有一张有 50 多行的表。每个都标有一个 id。

```
<tr id="51"> 
```

这个 id 是数据库 id，我需要将它传递给 jQuery 并与 AJAX 请求一起提交。

```
 $($location).click(function () {
            var $currentSelection = $(this);

            // if there is already an input-field in this TD, return...
            if($currentSelection.find('select').length > 0)
                return;

            $currentSelection.html('');

            $('<select id="selectLocation" onChange="locationSubmit()"/>')
                .attr('name', 'location')
                .append('<option>Location 1</option>', '<option>Location 2</option>', '<option>Location 3</option>')
                .appendTo(this);
        }); 
```

`locationSubmit()`

```
function locationSubmit(){
            var $selectLocation = $('#selectLocation').val();
            var $selectId = $(this).val('tr#id'); //stuck here
            alert($selectId);
            $.ajax({ 
                url: '/ajax/training-update.php',
                data: {
                        action: $selectLocation,
                        courseid: $selectId
                    },
                type: 'POST',
                success: function(output) {
                    alert(output);
                    }
            });
        } 
```

中的警报`locationSubmit()`正在返回 [object Object]。如何传递`tr#id`to的值`locationSubmit()`并通过 AJAX 发送？

编辑 - HTML

```
<tr id="51">
    <td><a href="/link/goes/here.php?course_id=5&id=51">course name</a></td>
    <td>
        <span class="rowStartDate" id="rowStartDate151">09/10/12</span> - 
        <span class="rowEndDate" id="rowEndDate151">09/14/12</span>
    </td>
    <td class="location">Location 2</td>
    <td class="status">open</td>
</tr> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T22:53:45.410

那么，有什么好的答案吗？

测试这个：

```
$($location).click(function () {
        var $currentSelection = $(this);

        // if there is already an input-field in this TD, return...
        if($currentSelection.find('select').length > 0)
            return;

        $currentSelection.html('');

        $('<select id="selectLocation"/>')
            .attr('name', 'location')
            .append('<option>Location 1</option>', '<option>Location 2</option>', '<option>Location 3</option>')
            .appendTo(this);
    }); 
```

并用这个替换你的函数：

```
$('body').delegate('#selectLocation', 'change', function(){

        var $selectLocation = $(this).val(); //Edited here also
        var $selectId = $(this).closest('tr').attr('id'); //edited here
        alert($selectId);
//The AJAX here        
}); 
```

如您所见，您的功能消失了，取而代之的是委托，这似乎工作得很好！.delegate [()](http://api.jquery.com/delegate)是一个非常好的函数，它一直在工作，即使元素是在 DOM 准备好之后创建的。它一直在听

**编辑** 检查第二个代码部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T22:55:11.793

```
 var $selectId = $('#selectLocation').parent("tr").attr("id") 
```

但仅以数字形式拥有 ID 并不是一种好的做法。

**和 ！！**

您正在创建多个`ids`. 每个文档只能定义一个。

采用：

```
$($location).on("click" ... 
```

使用动态对象

改变：

```
$('<select class="selectLocation" 
```

然后

```
$(".selectLocation").change(function()
{
   var $selectLocation = $(this).val();
   var $selectId = $(this).parent("tr").attr('id'); 
   alert($selectId);

        $.ajax({ 
            url: '/ajax/training-update.php',
            data: {
                    action: $selectLocation,
                    courseid: $selectId
                },
            type: 'POST',
            success: function(output) {
                alert(output);
                }
        });

} 
```

# python - Python SFTP 下载早于 x 的文件并删除网络存储

> ID：12360530
> 
> 赞同：3
> 
> 时间：2012-09-10T22:52:33.740
> 
> 标签：python, sftp, paramiko

我想通过 sftp 下载一些超过 2 小时的文件。然后我想从网站上删除它们。我可以将以下代码用于 sftp，但在远程机器上处理对象给我带来了问题。下面的代码在“timestamp = os.stat”行失败我相信这是一个操作系统模块问题？

```
import paramiko, sys, os,time

host = 'ftp address'
port = 22
transport = paramiko.Transport((host, port))
password = "pass"                   #hard-coded
username = "user"                   #hard-coded
transport.connect(username = username, password = password)

sftp = paramiko.SFTPClient.from_transport(transport)
print 'SFTP Client initiated'

remotepath = "/remote folder/"
localpath = '/local folder/' 

for file in sftp.listdir('.'):
    fullpath   = os.path.join('.',file) 
    timestamp  = os.stat(fullpath).st_ctime # get timestamp of file
    createtime = datetime.datetime.fromtimestamp(timestamp)
    now = datetime.datetime.now()
    delta = now -createtime
    if delta.hours > 2:
        sftp.get(file,localpath) 
        sftp.remove(file)

sftp.close()
transport.close() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-05-24T08:36:02.600

虽然 OP 的自我接受的答案几乎可以工作，但它的效率非常低，因为它涉及每个文件到服务器的往返。虽然实际上代码已经拥有所有需要的数据，但它只是通过使用[`pysftp.Connection.listdir`](https://pysftp.readthedocs.io/en/latest/pysftp.html#pysftp.Connection.listdir)包装器将其丢弃，而不是[`pysftp.Connection.listdir_attr`](https://pysftp.readthedocs.io/en/latest/pysftp.html#pysftp.Connection.listdir_attr)直接使用。

```
for entry in sftp.listdir_attr(remotepath):
    timestamp = entry.st_mtime
    createtime = datetime.datetime.fromtimestamp(timestamp)
    now = datetime.datetime.now()
    delta = now - createtime
    if delta.hours > 2:
        filepath = remotepath + '/' + entry.filename
        sftp.get(filepath, os.path.join(localpath, entry.filename)) 
        sftp.remove(filepath) 
```

`Connection.listdir`在内部检索与 相同的数据`Connection.listdir_attr`。他们最终都打电话给 Paramiko [`SFTPClient.listdir_attr`](https://docs.paramiko.org/en/stable/api/sftp.html#paramiko.sftp_client.SFTPClient.listdir_attr)。但`Connection.listdir`只返回文件名，丢弃所有其他文件属性。另请参阅[如何通过 Paramiko 获取目录中所有 SFTP 文件的大小](https://stackoverflow.com/q/51298467/850848)。

虽然请注意 pysftp 似乎已经死了。考虑直接使用 Paramiko。它具有几乎相同的 API，因此上面的代码将按原样工作。另请参阅[pysftp 与 Paramiko](https://stackoverflow.com/q/48434941/850848)。

* * *

此外，不应`os.path.join`在 SFTP 路径上使用。SFTP 始终使用正斜杠，而`os.path.join`使用本地路径语法，因此[在 Windows 上，它将使用反斜杠并且代码将失败](https://stackoverflow.com/q/50118919/850848)。

并且目标路径也`pysftp.Connection.get`需要一个文件名，而不仅仅是一个路径（这里`os.path.join`应该使用）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T12:07:19.647

获取远程计算机上文件的时间戳然后将其与现在进行比较所需的位如下。由非程序员（我）一起破解，但它有效。

```
timestamp  = sftp.stat(fullpath).st_atime  # get timestamp of file in epoch seconds
createtime = datetime.datetime.now()
now        = time.mktime(createtime.timetuple())
datetime.timedelta = now - timestamp

if datetime.timedelta> x:
    do something 
```

# jax-ws - 没有 Java EE 容器的 JAX-WS Web 服务

> ID：12360532
> 
> 赞同：3
> 
> 时间：2012-09-10T22:52:43.523
> 
> 标签：jax-ws

我想构建一个将在 Java SE 6.0 中运行的 JAX-WS Web 服务（没有容器，只有标准版 java）。

我从这里描述的旧教程开始[http://today.java.net/pub/a/today/2007/07/03/jax-ws-web-services-without-ee-containers.html](http://today.java.net/pub/a/today/2007/07/03/jax-ws-web-services-without-ee-containers.html)

但是我遇到了一些问题。

当我对我的 WebService 类 (acximImpl) 运行 wsgen 时，它将生成操作方法的类文件和从操作返回的类，但它不会生成作为参数传递给操作方法的类的代码。

因此，当我使用客户端调用 queryParts1() 方法时，我得到了一个肥皂错误，说“找不到 {http://com/activant/web/services/partorder}queryParts1Request 的调度方法”

我正在使用 NetBeans IDE 7.0.1

由 NetBeans 运行的 build.xml 如下所示：（它在 netbeans 编译我的类文件后运行）

```
<project name="acximserver" default="default" basedir=".">
<description>Builds, tests, and runs the project acximserver.</description>
<import file="nbproject/build-impl.xml"/>
<target name="-post-compile" >
  <echo message="Generating artifacts..."/>
  <exec executable="C:/acxim/BuildTools/JAX-WS/2.2.3/bin/wsgen.bat">
      <env key="JAVA_HOME" value="C:\BuildTools\jdk\1.6.0.24"/>
      <arg value="-verbose"/>
      <arg value="-keep"/>
      <arg value="-cp"/>
      <arg value="C:/Connectivity/APFCLSDK/Components/acximserver/build/classes"/>
      <arg value="-d"/>
      <arg value="${annotation.processing.source.output}"/>
      <arg value="com.epicor.acximsdk.acximserver.acximImpl"/>
  </exec>
  <javac debug="true"
         srcdir="${annotation.processing.source.output}"
         destdir="C:/Connectivity/APFCLSDK/Components/acximserver/build/classes"
         classpath="${acxclasspath}"/>

</target> 
```

我的主类文件如下所示：

```
package com.epicor.acximsdk.acximserver;

import javax.jws.WebMethod;
import javax.jws.WebResult;
import javax.jws.WebParam;
import javax.jws.WebService;
import javax.xml.ws.Endpoint;
import javax.xml.bind.annotation.XmlElement;
import org.apache.log4j.Logger;

public class Acximserver {
private Endpoint endpoint = null;
private static final Logger logger = Logger.getLogger("com.epicor.acximsdk.acximserver");

public Acximserver() {
    System.out.println("Acximserver constructor called.");
    endpoint = Endpoint.create(new acximImpl());
    logger.info("Inside Acximserver constructor");
}
private void publish() {
    endpoint.publish("http://localhost:1970/acximservice/PartOrderMgr");
}

/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
    // TODO code application logic here
    System.out.println("Acximserver main() function called");
    Acximserver acxim = new Acximserver();
    acxim.publish();
    System.out.println("Acximserver Open for business at:");
    System.out.println("  http://localhost:1970/acximservice/PartOrderMgr");
} 
```

}

我的 WebService 类如下所示：

```
package com.epicor.acximsdk.acximserver;
import javax.jws.WebMethod;
import javax.jws.WebResult;
import javax.jws.WebParam;
import javax.jws.WebService;
import javax.xml.ws.Endpoint;
import javax.xml.bind.annotation.XmlElement;
import javax.jws.HandlerChain;

@WebService(
    name = "acximservice",
    serviceName = "PartOrderMgr",
    targetNamespace = "http://com/activant/web/services/partorder"
    )
@HandlerChain(file="soaphandler.xml")      // Setup some custom classes to intercept messages for logging.
public class acximImpl {
public acximImpl() {
    System.out.println("acximImpl constructor called.");
}

@WebMethod(operationName = "queryParts1")
@WebResult(name = "queryParts1Response")
public QueryParts1Response queryParts1(
       @WebParam(name = "Credentials", header = true)                      Credentials credentials,
       @WebParam(name = "queryParts1Request") @XmlElement(required = true) QueryParts1Request request
       //Credentials credentials,
       //QueryParts1Request request
       )
{
    String tracknum = "";
    QueryParts1Response response = new QueryParts1Response();

    if(credentials != null) {
        System.out.println("Token = " + (credentials.getToken()==null ? "null" : credentials.getToken()));
        System.out.println("TokenSignature = " + (credentials.getTokenSignature()==null ? "null" : credentials.getTokenSignature()));
    } else
        System.out.println("credentials is null");

    if(request != null) {
        if(request.metadata != null) {
            System.out.println("timeout = " + request.metadata.gettimeout());
            System.out.println("ACXTrackNum = " + (request.metadata.getACXTrackNum()==null ? "null" : request.metadata.getACXTrackNum()));
            if(request.metadata.getACXTrackNum() != null)
                tracknum = request.metadata.getACXTrackNum();
        }
        else {
            System.out.println("metadata is null");
        }

        if(request.requestString != null)
            System.out.println("reqeust = " + request);
        else
            System.out.println("requestString is null");
    }
    else
        System.out.println("request is null");

    response._return = createACXNotification("buyid", "sellid", tracknum, "INFO", "0", "Service is working");
    return response;
}

public String makeRequestHeader(String acxRequestName) {
    return "<?xml version=\"1.0\" ?>" +
           "<!DOCTYPE " + acxRequestName + " SYSTEM '" +
           "http://www.aconnex.com/DTD" + "/" + acxRequestName +
           "_v1_0" + ".dtd'>";
}
protected String  createACXNotification(String Buy, String Sell, String Track, String Sev, String Code, String Msg) {
    String       version = "1.0"; // somehow make this configurable.
    StringBuffer buf     = new StringBuffer();
    buf.append(makeRequestHeader("ACXNotificationResponse"));
    buf.append("<ACXNotificationResponse><Envelope><BuyPartnerID>");
    buf.append(Buy);
    buf.append("</BuyPartnerID><DocVersNum>");
    buf.append(version);
    buf.append("</DocVersNum><DocGenBy>Epicor javaSDK</DocGenBy></Envelope>");
    buf.append("<NotificationResponse><ACXTrackNum>");
    buf.append(Track);
    buf.append("</ACXTrackNum><SellPartnerID>");
    buf.append(Sell);
    buf.append("</SellPartnerID><Severity>");
    buf.append(Sev);
    buf.append("</Severity><Code>");
    buf.append(Code);
    buf.append("</Code><Msg>");
    buf.append(Msg);
    buf.append("</Msg></NotificationResponse></ACXNotificationResponse>");
    return buf.toString();
} 
```

}

生成的 queryParts1() 方法返回的类 QueryParts1Response 如下所示：

```
package com.epicor.acximsdk.acximserver;

import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

//@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "queryParts1Response", propOrder = {
"_return"
})
@XmlRootElement(name = "queryParts1Response")
public class QueryParts1Response {

@XmlElement(name = "return", required = true)
protected String _return;

/**
 * Gets the value of the return property.
 * 
 * @return
 *     possible object is
 *     {@link String }
 *     
 */
public String getReturn() {
    return _return;
}

/**
 * Sets the value of the return property.
 * 
 * @param value
 *     allowed object is
 *     {@link String }
 *     
 */
public void setReturn(String value) {
    this._return = value;
} 
```

}

作为 queryParts1() 方法的参数并且不会生成的 QueryParts1Request 类如下所示：

```
package com.epicor.acximsdk.acximserver;

import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

//@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(namespace = "http://com/activant/web/services/partorder", propOrder = {
"requestString",
"metadata"
})
@XmlRootElement(name = "queryParts1Request")
public class QueryParts1Request {

@XmlElement(name = "requestString", required = true)
protected String requestString;
@XmlElement(name = "metadata", required = true)
protected Metadata1TYPE metadata;

/**
 * Gets the value of the requestString property.
 * 
 * @return
 *     possible object is
 *     {@link String }
 *     
 */
public String getRequestString() {
    return requestString;
}

/**
 * Sets the value of the requestString property.
 * 
 * @param value
 *     allowed object is
 *     {@link String }
 *     
 */
public void setRequestString(String value) {
    this.requestString = value;
}

/**
 * Gets the value of the metadata property.
 * 
 * @return
 *     possible object is
 *     {@link Metadata1TYPE }
 *     
 */
public Metadata1TYPE getMetadata() {
    return metadata;
}

/**
 * Sets the value of the metadata property.
 * 
 * @param value
 *     allowed object is
 *     {@link Metadata1TYPE }
 *     
 */
public void setMetadata(Metadata1TYPE value) {
    this.metadata = value;
} 
```

}

如何让 wsgen 为方法参数列表中的对象生成类文件？请注意，主类使用 EndPoint 类发布 Web 服务正在侦听的 url。

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-14T17:41:59.020

我也在尝试这样做（构建一个将在 Java SE 6.0 中运行的 JAX-WS Web 服务（没有容器，只是标准版 java）），我找到了一种最简单的方法。请查看这两个教程[http://www.ibm.com/developerworks/webservices/tutorials/ws-eclipse-javase1/index.html](http://www.ibm.com/developerworks/webservices/tutorials/ws-eclipse-javase1/index.html)和[http://technology.amis.nl/2009/06/05/publish-a -webservice-from-a-poja-plain-old-java-application-that-is-out-of-the-container-using-endpoint-class/](http://technology.amis.nl/2009/06/05/publish-a-webservice-from-a-poja-plain-old-java-application-that-is-out-of-the-container-using-endpoint-class/)

# jquery - Flexslider 中的延迟加载

> ID：12360533
> 
> 赞同：16
> 
> 时间：2012-09-10T22:52:52.573
> 
> 标签：jquery, jquery-plugins, lazy-loading, flexslider

我正在尝试通过使用延迟加载 jquery 插件并按照本网站上的说明为[Flexslider进行延迟加载：http:](http://www.woothemes.com/flexslider/) [//www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)

我正在加载插件脚本，但在控制台上看不到任何错误。我试过没有在lazyload函数中传递容器或选项，但仍然没有。我花了几个小时在这上面。

```
$("img.lazy").lazyload({
  effect: "fadeIn",
  container: $(".slides > li")
}); 
```

Does anyone know how to get lazy loading working in Flexslider?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-02-05T21:11:49.030

**我在滚动期间实现了延迟加载。与此处提出的其他解决方案相比，此解决方案更适用于大型馆藏。** 在初始化期间，它只加载前 5 张图像，然后为每个动画加载 3 张图像。

```
<li>
  <img class="lazy" src="loading-image.jpg" data-src="actual-image.jpg" />
</li> 
```

和javascript代码：

```
 $('.flexslider').flexslider({
        animation: "slide",
        animationLoop: false,
        controlNav: false,
        init: function (slider) {
            // lazy load
            $("img.lazy").slice(0,5).each(function () {
                var src = $(this).attr("data-src");
                $(this).attr("src", src).removeAttr("data-src").removeClass("lazy");
            });
        },
        before: function (slider) {
            // lazy load
            $("img.lazy").slice(0,3).each(function () {
                var src = $(this).attr("data-src");
                $(this).attr("src", src).removeAttr("data-src").removeClass("lazy");
            });
        }
    }); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-28T17:35:47.223

该方法对我来说效果很好，但是加载图像确实需要与其余图像的大小相同。我实际上使用[http://imageresizing.net/](http://imageresizing.net/)和 mode=pad

在您用于 flexslider 的主容器中，将实际图像放在“data-src”属性中

```
<li>
  <img class="lazy" src="loading-image.jpg" data-src="actual-image.jpg" />
</li> 
```

在初始化函数中，使用“start”回调将加载图像替换为实际图像，并删除属性

```
$('#slider').flexslider({
    start: function (slider) {
       // lazy load
       $(slider).find("img.lazy").each(function () {
          var src = $(this).attr("data-src");
          $(this).attr("src", src).removeAttr("data-src");
       });
     }
}); 
```

我希望这可以帮助别人。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T20:56:40.830

我正在尝试使用[Flexslider 2](http://www.woothemes.com/flexslider/, "弹性滑块 2")和[Lazy Load Plugin for jQuery](http://www.appelsiini.net/projects/lazyload, "用于 jQuery 的延迟加载插件")做同样的事情。

似乎该`container`属性仅在元素样式为`overflow:scroll;`

我能够使用以下代码使延迟加载工作：

```
$("#flexcontainer img.lazy").lazyload({
    failure_limit : 10,
    effect: "fadeIn",
    skip_invisible : false
}); 
```

但是，这只是一次延迟加载所有内容，而不是像 flexslider 动画一样。

我还能够使用以下代码让它在鼠标悬停时工作：

```
 $("#flexcontainer img.lazy").lazyload({
     failure_limit : 10,
     effect: "fadeIn",
     event : "mouseover"
 }); 
```

但是，这不适用于触摸设备。

我认为关键是创建您自己的自定义事件并在诸如回调之类的 flexslider 回调之后触发它`after`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-27T19:20:50.217

为了提供替代解决方案 - 另一种选择是使用已经内置延迟加载的响应式滑块，例如皇家滑块，这是链接 - > [http://dimsemenov.com/plugins/royal-slider /](http://dimsemenov.com/plugins/royal-slider/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-05T16:54:18.003

您不妨使用自定义触发事件初始化延迟加载...

```
$jQ("img[data-original]").lazyload({
            effect: "fadeIn",
            skip_invisible: false,
            event: "forceLazyLoad"
        }); 
```

...然后调用此事件以将所有图像预加载到 flexslider 中，调用如下：

```
$jQ('.flex-viewport').find('img[data-original]').trigger('forceLazyLoad'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-19T00:58:10.683

因此，我将真实图像页面添加到图像标签上的 data-attr 属性中，并且在`after`事件触发时，我会找到带有`active`类的图像并将 img src 属性设置为等于 data-attr 值。

# .net - 如何在依赖于可移植类库的库上成功运行 secannotate.exe？

> ID：12360534
> 
> 赞同：5
> 
> 时间：2012-09-10T22:52:54.107
> 
> 标签：.net, code-access-security, portable-class-library

我正在从事[Autofac 项目](https://code.google.com/p/autofac/)，试图将我们所有的通用逻辑转换为[可移植类库](http://msdn.microsoft.com/en-us/library/gg597391.aspx)，并为特定功能添加特定于平台的库。

我的开发机器是 Windows 8 Enterprise（64 位），我安装了 VS 2012 Ultimate 和所有的装饰。我没有安装任何以前的 .NET 框架、任何其他工具或任何额外的 PCL 特定工具。**这是一个干净的新虚拟机，只有基本的东西。**在此配置中，所有构建和测试都运行良好。

当我尝试在依赖于可移植类库之一的 .NET 4.5（完整配置文件）库上运行[secannotate.exe时，](http://msdn.microsoft.com/en-us/library/dd997356.aspx)**我收到一条错误消息，指示我需要 mscorlib 2.0.5.0**。

这是一个示例错误。PCL 是 Autofac.dll；.NET 4.5 完整的配置文件库是 Autofac.Configuration.dll。

```
Error running annotator: Could not find referenced assembly 'Assembly(Name=mscorlib, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e)'. Ensure that the reference paths and assemblies are setup correctly.
Microsoft (R) .NET Framework Security Transparency Annotator 4.0.30319.17929
Copyright (C) Microsoft Corporation.  All rights reserved.

Loaded assembly 'Autofac.Configuration' from 'C:\dev\opensource\autofac\trunk\build_output\bin\net40\Autofac.Configuration.dll'.
Resolving assembly 'Assembly(Name=mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089)'.
Loaded assembly 'mscorlib' from 'C:\Windows\Microsoft.Net\assembly\GAC_64\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll'.
Loaded referenced assembly from 'C:\Windows\Microsoft.Net\assembly\GAC_64\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll'.
Using core assembly: 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' from 'C:\Windows\Microsoft.Net\assembly\GAC_64\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll'.
Assembly 'Autofac.Configuration' is using transparency model 'Level 2'.
Assembly 'mscorlib' is using transparency model 'Level 2'.
Loaded assembly 'Autofac' from 'C:\dev\opensource\autofac\trunk\build_output\bin\net40\Autofac.dll'.
Resolving assembly 'Assembly(Name=mscorlib, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e)'.
   at Microsoft.Security.Tools.CciHostEnvironment.ResolvingAssemblyReference(IUnit referringUnit, AssemblyIdentity referencedAssembly)
   at Microsoft.Security.Tools.CciHostEnvironment.LoadCoreAssembly()
   at Microsoft.Security.Tools.CciHostEnvironment..ctor(ISecAnnotateHost host, String rootAssemblyPath)
   at Microsoft.Security.Tools.SecAnnotate.LoadInputAssemblies()
   at Microsoft.Security.Tools.SecAnnotate.AnnotateAssemblies()
   at Microsoft.Security.Tools.SecAnnotate.Main(String[] args) 
```

Autofac 可移植类库的目标是：

*   .NET 4.0
*   银光 5
*   适用于 Windows 应用商店应用的 .NET

您可以通过创建针对这些事物的新/空 PCL 并构建它来复制问题。您会看到它引用了 mscorlib 2.0.5.0。

一些搜索让我相信这是对旧 Silverlight 程序集版本的引用，但 PCL 项目没有特定的版本引用，所以我只能想象这是由 VS 2012 PCL 工具提供的。其他人似乎通过安装在 VS 2012 之前发布的 .NET 框架更新解决了类似的问题。**我实际上在我的机器上的任何地方都找不到 mscorlib 2.0.5.0。**

在 dotPeek 中查看我构建的 Autofac.dll 程序集，我看到它引用：

*   mscorlib 2.0.5.0
*   系统 2.0.5.0
*   System.ComponentModel.Composition 2.0.5.0
*   System.Core 2.0.5.0

而且，它只是一个 PCL 项目，没有直接引用任何东西。从字面上看 - .csproj 文件中**没有一条参考线**。

**如何解决这个 secannotate 问题？**我需要安装什么额外的东西吗？是否有我应该添加到 secannotate 命令行的参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:26:50.490

您需要传递 /d 开关，指向可移植库引用程序集，例如：

```
secannotate /v "Autofac.Configuration.dll" /d:"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETPortable\v4.0" 
```

请注意，您将收到有关混合桌面和 CoreCLR mscorlib 的警告，这可以忽略不计，因为虽然“便携式”看起来像 CoreCLR (Silverlight) 进行标注，但它不是在 .NET Framework 的上下文中运行时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T01:48:49.113

在 VS2012 之前的 PCL 的早期版本中引用了 Mscorlib 版本 2.0.5.0。

有一种明确的方法可以让你最终依赖它。如果您从 Autofac-2.6.3.862-Portable.zip 下载开始，那么您将获得一个确实具有 2.0.5.0 mscorlib 依赖项的 Autofac.dll 版本。使用 ildasm.exe 可以看到的东西，双击清单：

```
// Metadata version: v4.0.30319
.assembly extern retargetable mscorlib
{
  .publickeytoken = (7C EC 85 D7 BE A7 79 8E )                         // |.....y.
  .ver 2:0:5:0
}
.assembly extern retargetable System.Core
{
  .publickeytoken = (7C EC 85 D7 BE A7 79 8E )                         // |.....y.
  .ver 2:0:5:0
}
// etc.. 
```

因此，*不知何故*，您的 Autofac.Configuration.dll 是从一个引用该版本 Autofac.dll 而不是您构建的项目构建的。从项目中删除该引用。使用 Project + Add Reference 并使用 Project 选项卡，勾选您的 Autofac 项目。

# c++ - C ++增加指向数组的指针

> ID：12360535
> 
> 赞同：1
> 
> 时间：2012-09-10T22:52:57.953
> 
> 标签：c++

```
int arr[10] = {1,2,3,4,5,6,7,8,9,10};
int (*parr)[10] = &arr;

//prints address of arr and the value 1
cout << parr << " " << *parr[0];

//what is this doing?
parr++;

//prints (what looks like the address of arr[1]) and some long number -8589329222
cout << parr << " " << *parr[0]; 
```

我认为 parr++ 会增加 parr 指向的地址，因此 *parr[0] 现在是 *parr[1] 的地址。我哪里错了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-10T22:54:07.313

您假设`parr++`增量为一个单词。它没有。它以 的大小递增`*parr`，在这种情况下是一个`int[10]`，所以它以 10 个整数的大小（可能是 40 个字节）递增。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T22:57:16.777

您只需要一个指向数组*开头的指针。*

```
int* parr = arr; // points to the 0 element
parr++; // poInts to the first element, 1. 
```

# ruby-on-rails - Rails before_filter 没有命中数据库

> ID：12360536
> 
> 赞同：0
> 
> 时间：2012-09-10T22:52:57.987
> 
> 标签：ruby-on-rails

在我的应用程序中，我只想允许具有管理员权限的用户访问此模型。所以我设置了 before_filter 来检查用户是否是管理员。这种方法的问题在于，在管理员用户通过过滤器后，他/她将无法重定向到该操作。相反，只有视图被渲染，这导致`undefined method each' for nil:NilClass error`. 我在这里做错了什么？

```
class TidbitsController < ApplicationController
     before_filter :is_admin?
     layout "tidbits"
      # GET /tidbits
      # GET /tidbits.json
      protected    
      def is_admin?
        unless current_user.admin?
         flash[:error] = "You are not authorized!"
         redirect_to "/" and return
        end
      end

      def index
        @tidbits = Tidbit.all

        respond_to do |format|
          format.html # index.html.erb
          format.json { render json: @tidbits }
        end
      end

      # GET /tidbits/1
      # GET /tidbits/1.json
      def show
        @tidbit = Tidbit.find(params[:id])

        respond_to do |format|
          format.html # show.html.erb
          format.json { render json: @tidbit }
        end
      end

      # GET /tidbits/new
      # GET /tidbits/new.json
      def new
        @tidbit = Tidbit.new

        respond_to do |format|
          format.html # new.html.erb
          format.json { render json: @tidbit }
        end
      end

      # GET /tidbits/1/edit
      def edit
        @tidbit = Tidbit.find(params[:id])
      end

      # POST /tidbits
      # POST /tidbits.json
      def create
        @tidbit = Tidbit.new(params[:tidbit])

        respond_to do |format|
          if @tidbit.save
            format.html { redirect_to @tidbit, notice: 'Tidbit was successfully created.' }
            format.json { render json: @tidbit, status: :created, location: @tidbit }
          else
            format.html { render action: "new" }
            format.json { render json: @tidbit.errors, status: :unprocessable_entity }
          end
        end
      end

      # PUT /tidbits/1
      # PUT /tidbits/1.json
      def update
        @tidbit = Tidbit.find(params[:id])

        respond_to do |format|
          if @tidbit.update_attributes(params[:tidbit])
            format.html { redirect_to @tidbit, notice: 'Tidbit was successfully updated.' }
            format.json { head :no_content }
          else
            format.html { render action: "edit" }
            format.json { render json: @tidbit.errors, status: :unprocessable_entity }
          end
        end
      end

      # DELETE /tidbits/1
      # DELETE /tidbits/1.json
      def destroy
        @tidbit = Tidbit.find(params[:id])
        @tidbit.destroy

        respond_to do |format|
          format.html { redirect_to tidbits_url }
          format.json { head :no_content }
        end
      end

    end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T22:58:10.500

在您的示例中，您所有的操作方法都是`protected`如此，也许这就是问题所在？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:08:28.080

我认为您忘记添加设计所需的回调过滤器

```
before_filter :authenticate_user!
before_filter :is_admin? 
```

# git - 通过 Internet 托管 Git 代码

> ID：12360542
> 
> 赞同：0
> 
> 时间：2012-09-10T22:54:19.657
> 
> 标签：git

我在我的服务器（美国位置）上创建了 Git 存储库。现在我需要某个位于英国的人可以访问我的存储库并将其克隆到他的 PC 中。可能吗？

我不能有我的静态 IP 地址，也不知道 SSH 设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T02:01:23.063

这当然是可能的，并且有多种不同的方法可以做到这一点。在这个答案中，我试图尽可能描述您的选择，并根据我对您情况的（有限）了解提供我自己的建议。

# 第 1 步：为您的 Git 存储库提供服务

你的服务器上有你的 Git 存储库——太好了。但是，您在英国的联系人还不能克隆您的服务器：当他或她尝试这样做时，他或她的连接将被拒绝，因为您的服务器不知道如何处理它。您需要明确告诉您的服务器如何为您的 Git 存储库提供服务。

你如何做到这一点在某种程度上取决于你以后想做什么。如果您希望您的英国朋友能够将更改推送到服务器上的存储库，我建议您将服务器设置为 SSH 服务器并为您的朋友提供一个帐户。（有其他方法可以启用读写访问，例如使用 WebDAV；如果您在 Web 上四处搜索，您应该不会很难找到它们。）[Ubuntu 服务器指南](https://help.ubuntu.com/12.04/serverguide/)有很好的说明，将您的服务器设置为SSH 服务器，以及如何添加新用户。

另一方面，如果您的英国联系人只需要对 Git 存储库的读取权限，您可以使用任何 Web 服务器来为您的 Git 存储库提供服务。 [*Pro Git*](http://git-scm.com/book/)有一个很好的部分介绍了如何设置 Git 以与 Apache 一起工作，您可以在 Web 上的其他地方找到有关其他 Web 服务器的说明，例如 lighttpd 或 nginx。请注意，您需要将存储库放在您的 Web 服务器实际为其提供服务的地方——对于 Apache，它位于 DocumentRoot 中，对于其他服务器，位于类似的地方。

或者，您可以设置 Git 自己的服务器以使用 Git 协议为存储库提供服务。 *Pro Git*也通过这里。

# 第 2 步：打开防火墙

无论您使用的是 SSH、Web 服务器还是 Git 服务器，您都需要在防火墙中打开一个端口以允许连接。如果没有人可以连接到您的服务器，则没有人可以读取您的存储库。如果您使用 SSH，则需要打开 TCP 端口 22；如果是 Web 服务器，端口 80；如果是 Git 服务器本身，端口 9148。

如果您使用的是 iptables，则可以运行

> `iptables -A INPUT -p tcp -j ACCEPT --dport` *端口号*

其中*port_number*是您需要打开的端口号。请注意，您需要是 root -`sudo -i`如有必要，请先运行。此外，当您重新启动服务器时，此规则可能会自行重置；在网上四处寻找您的 GNU/Linux 发行版如何处理持久性 iptables 规则。

如果您不使用 iptables，则需要在 Web 上四处搜索，找到一些防火墙文档，并弄清楚如何打开相关端口。

# 第 3 步：在 Internet 上找到您的服务器

您提到您没有静态 IP 地址，这很好。但是，如果您希望 Git 正常工作，您需要能够为您在英国的朋友提供某种静态标识符。您可能应该使用免费的动态 DNS 名称，它有很多选项。我自己从来没有使用过任何一个，所以我不能特别推荐任何一个；也许其他 StackOverflow 用户有一些建议。

# 第 4 步：将克隆 URL 提供给您的朋友

所以你已经在你的服务器上拥有了你的存储库，你已经准备好为它提供服务，你已经打开了你的防火墙，你已经为你的服务器设置了某种域名。现在，您需要克隆 URL，您的英国联系人将传递给 git-clone 以克隆您的存储库的 URL。这取决于您在第 1 步中所做的选择——如果您设置了 SSH，您的克隆 URL 是

> ssh:// *friend's_username* @ *your_server_domain_name* : *path_to_repository*

其中*friend's_username*是您为朋友设置的用户帐户名称，*your_server_domain_name*是您在步骤3 中为您的服务器获取的域名，*path_to_repository*是共享存储库的实际Unix 文件系统路径。

另一方面，如果您使用的是 Web 服务器，则您的克隆 URL 是 HTTP URL：

> http:// *your_server_domain_name* /*存储库*

其中*repository*是存储库的路径，从Web 服务器的DocumentRoot 开始。

如果您使用的是 Git 服务器，您的克隆 URL 以 git:// 开头：

> git:// *your_server_domain_name* / *repository_name*

其中*repository_name*是存储库的路径，从 Git 服务器的目录开始——通常是 /opt/git。

至此，您就完成了。您的朋友应该能够使用 git-clone 克隆您的存储库，并且，如果您正确设置了 SSH 访问，他或她应该能够将更改推送回它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T02:14:47.450

几个选项：

1.  使用一些在线驱动器，如谷歌驱动器或保管箱来存储存储库。

2.  使用一些免费的 ddns 提供商来获取您的域名并设置 ssh 服务器或 http git 服务，如 Benjamin 所述。

# c++ - 用于检索 C++ 代码库中的函数和方法列表的工具

> ID：12360547
> 
> 赞同：6
> 
> 时间：2012-09-10T22:54:43.650
> 
> 标签：c++, list, methods

考虑到基于 C++ 的源代码，我正在寻找一种可以输出带有/不带有接口的纯文本方法列表的工具，这意味着 2 个选项，只有方法的名称或完整的接口签名。

我也想将其应用于 C 中的源代码。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T07:17:12.537

使用 Doxygen 的 XML 格式和一个小 Python 脚本来解析它，可以轻松构建一个合理的解决方案。Doxygens XML 输出没有很好的文档记录，但看起来相当完整。

这是我的python脚本：

```
import lxml.etree
import glob

prefix = "/Code/stack_overflow_examples/list_functions_by_doxygen/"

for filename in glob.glob("xml/*.xml"):
    f = open( filename, "r" )
    xml = lxml.etree.parse(f)
    for x in xml.xpath('//memberdef[@kind="function"]'):
        srcfile = x.xpath('.//location/@file')[0].replace(prefix,'') 
        srcline = x.xpath('.//location/@line')[0]
        definition = x.xpath('.//definition/text()')[0] 
        args = x.xpath('.//argsstring/text()')[0]
        print( "%s:%s: %s%s" % ( srcfile, srcline, definition, args) ) 
```

在此文件上运行时：

```
/**
 * This is a test function.
 */
int a_function( Baz & b )
{
  return 7;
}

void another_function( Boo & b )
{
}

class Foo
{
  private:
    int a_private_member_function();
  public:
    int a_public_member_function();
}; 
```

它生成以下输出：

```
test.cpp:16: int Foo::a_private_member_function()
test.cpp:18: int Foo::a_public_member_function()
test.cpp:5: int a_function(Baz &b)
test.cpp:10: void another_function(Boo &b) 
```

您只需要对用于生成“文档”的 Doxyfile 进行一些更改。这是我使用的更改：

```
EXTRACT_ALL = YES
EXTRACT_PRIVATE = YES
EXTRACT_STATIC = YES
EXTRACT_LOCAL_METHODS = YES
EXTRACT_ANON_NSPACES = YES
CASE_SENSE_NAMES = YES

GENERATE_HTML = NO
GENERATE_LATEX = NO
GENERATE_XML = YES 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-10-03T08:33:14.840

根据 Jonathan Wakely 的评论，您可以像这样使用[ctags](http://ctags.sourceforge.net/ctags.html)：

```
ctags -x --c-types=f --format=1 file.c 
```

它将列出您的功能：

```
celsjusz2Fahrenheit   17 file.c double celsjusz2Fahrenheit(double celsjuszDegree)
celsjusz2Kelwin    21 file.c double celsjusz2Kelwin(double celsjuszDegree)
main               44 file.c int main() 
```

如果要列出按类名处理的方法，可以使用：

```
ctags -x --c++-types=f --extra=q --format=1 file.cc 
```

它将打印例如：

```
S::f                9 file.cc void f()
S::f1              11 file.cc void f1()
S::f2              13 file.cc void f2()
celsjusz2Fahrenheit   17 file.cc double celsjusz2Fahrenheit(double celsjuszDegree)
celsjusz2Kelwin    21 file.cc double celsjusz2Kelwin(double celsjuszDegree) 
```

编辑（由于评论）： Args 意味着（复制自`ctags --help`）：

*   `-x`- 将表格交叉引用文件打印到标准输出。
*   `--extra=q`- 添加额外的标志，其中`q`的意思是“为每个标签包括一个额外的类限定标签条目”
*   `--format=1`- 强制输出指定的标签文件格式

# jquery - jQuery - 所有输入都获得焦点后的removeClass？

> ID：12360549
> 
> 赞同：1
> 
> 时间：2012-09-10T22:54:48.127
> 
> 标签：jquery, forms, input

我有一个包含三个输入子组（各种）的表格。子组由类名（.group_1、.group_2、.group_3）表示。

我想做的是：

一旦特定类（例如 .group_1）的所有输入都已获得焦点（或已更改，两者都可以），则删除单独跨度的类（假设使用 removeClass）。如果特定类中的 5 个输入中只有 4 个已获得焦点（或已更改），则该类将保持在跨度上，直到第 5 个被关注或更改。

希望这是有道理的，在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:01:57.557

像这样简单的事情怎么样：

[http://jsfiddle.net/zerkms/7EUas/](http://jsfiddle.net/zerkms/7EUas/)

```
var selectedMarkerClass = 'was-selected';

$('.group_1').on('focus', function() {
    $(this).addClass(selectedMarkerClass);

    if ($('.' + selectedMarkerClass).length == $('.group_1').length) {
        $('div').text('each input was selected at least once');
    }
});​ 
```

?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:11:08.123

您可以使用一些伪类将输入标记为关注`focus`事件并检查它们是否都被关注。如果是，则从您的跨度中删除课程。

**HTML：**

```
<span class="group1 red">Test span</span>

<div id="group1-container">
    <input class="group1" type="text" />
    <input class="group1" type="text" />
    <input class="group1" type="text" />
    <input class="group1" type="text" />
    <input class="group1" type="text" />
</div>​ 
```

**JavaScript：**

```
group1Container$ = $('#group1-container');
group1$ = $('input.group1', group1Container$);
group1$.on('focus', function() {
    var input$ = $(this);
    input$.addClass('focused');
    if(!$('input.group1:not(.focused)', group1Container$).length) {
        $('span.group1').removeClass('red');
        group1$.off('focus');
    }
}); 
```

**[​演示](http://jsfiddle.net/f0t0n/GFwvX/)**

# image - 如何绘制地理参考图像，使其“适合” Matplotlib 中的绘图坐标系

> ID：12360554
> 
> 赞同：1
> 
> 时间：2012-09-10T22:55:28.713
> 
> 标签：image, plot, matplotlib, cartography

一个非常相似的问题，以同样的方式解决：[how to use 'extent' in matplotlib.pyplot.imshow](https://stackoverflow.com/q/6999621/401828)

* * *

我有一个描述地理轨迹的地理坐标列表（“跟踪日志”）。此外，我可以获取跨越跟踪日志覆盖范围的图像，我知道图像角落的“地理坐标”。

我的情节目前看起来像这样（注意刻度 - x=longitudes, y=latitudes, in UTM, WGS84）：

![在此处输入图像描述](../Images/dfefc6d406524a3c1590df366c7ec872.png)

然后假设我知道下图的角坐标（或没有蓝色轨迹的版本），并且想绘制它以使其适合绘图的坐标系。

![在此处输入图像描述](../Images/7db0f0e972924c8aa42c12b8b3ce6e05.png)

我该怎么做？

（作为旁注，如果重要的话，我打算使用瓷砖）

* * *

根据 Joe Kington 的评论（等待他的实际答案以便我接受），以下代码按预期工作，提供了一个可平移和可缩放的固定方面“地理参考”磁贴，我可以在该磁贴上绘制跟踪日志：

```
import matplotlib.pyplot as plt
import Image
import numpy

imarray = numpy.asarray(Image.open('map.jpg'))

plt.plot([0,1], [0,1], 'o', c='red', ms=20)  ## some reference circles for debugging
plt.imshow(imarray, extent=[0,1,0,1])   ## some random map whose corners have known coordinates
plt.axis('equal')
plt.show() 
```

![在此处输入图像描述](../Images/17a4b4b944adee03cadbfc6d011cb652.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:01:09.300

这里真的没有太多答案，但是如果您使用的是 matplotlib，并且您是 geos-tuff，请查看[matplotlib.basemap](http://matplotlib.github.com/basemap/)。
默认情况下，所有操作都在 UTM 地图上完成，但您可以选择自己的投影。[例如，还可以查看](http://www.geophysique.be/2010/05/05/matplotlib-basemap-tutorial-part-03-masked-arrays-zoom/)[http://www.geophysique.be](http://www.geophysique.be)中的优秀教程列表。

# java - PowerMock 的 expectNew() 没有按预期模拟构造函数

> ID：12360555
> 
> 赞同：14
> 
> 时间：2012-09-10T22:55:38.200
> 
> 标签：java, constructor, easymock, powermock

我正在尝试了解各种模拟库的来龙去脉，[PowerMock](http://code.google.com/p/powermock/)（特别是 EasyMock 扩展）是列表中的下一个。我试图模拟一个构造函数，当我尝试复制它们时，提供的示例没有相同的响应。据我所知，它从不模拟构造函数，只是像正常一样继续进行。

这是测试类：

```
@RunWith(PowerMockRunner.class)
@PrepareForTest({Writer.class})
public class FaultInjectionSituationTest {

    @Test
    public void testActionFail() throws Exception {
        FaultInjectionSituation fis = new FaultInjectionSituation();
        PowerMock.expectNew(Writer.class, "test")
           .andThrow(new IOException("thrown from mock"));
        PowerMock.replay(Writer.class);
        System.out.println(fis.action());
        PowerMock.verify(Writer.class);
    }

} 
```

我尝试用 EasyMock.isA(String.class) 替换“测试”，但它产生了相同的结果。

这是 FaultInjectionSituation：

```
public class FaultInjectionSituation {

    public String action(){
        Writer w;
        try {
            w = new Writer("test");
        } catch (IOException e) {
            System.out.println("thrown: " + e.getMessage());
            return e.getLocalizedMessage();
        }
        return "returned without throw";
    }
} 
```

“作家”只不过是一个类的外壳：

```
public class Writer {
    public Writer(String s) throws IOException {
    }

    public Writer() throws IOException{
    }
} 
```

运行测试时，它会打印出“returned without throw”，表示从未抛出异常。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-11T21:46:34.270

您还需要准备调用构造函数的类，以便 PowerMock 知道期待模拟构造函数调用。尝试使用以下内容更新您的代码：

```
@RunWith(PowerMockRunner.class)
@PrepareForTest({Writer.class, FaultInjectionSituation.class})
public class FaultInjectionSituationTest { 
 // as before
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T23:15:38.690

您需要首先创建一个模拟对象：

```
Writer mockWriter = PowerMock.createMock(Writer.class)
PowerMock.expectNew(Writer.class, "test").andReturn(mockWriter) 
```

# c# - 将 DataTemplate 中的按钮绑定到表单的 ViewModel 中的命令

> ID：12360560
> 
> 赞同：29
> 
> 时间：2012-09-10T22:55:56.940
> 
> 标签：c#, wpf, xaml, data-binding, mvvm

我的问题类似于这个问题中描述的问题：
[WPF MVVM Button Control Binding in DataTemplate](https://stackoverflow.com/questions/3772797/wpf-mvvm-button-control-binding-in-datatemplate)

这是我的 XAML：

```
<Window x:Class="MissileSharp.Launcher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MissileSharp Launcher" Height="350" Width="525">
    <Grid>
        <!-- when I put the button here (outside the list), the binding works -->
        <!--<Button Content="test" Command="{Binding Path=FireCommand}" />-->
        <ListBox ItemsSource="{Binding CommandSets}">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <!-- I need the button here (inside the list), and here the binding does NOT work -->
                    <Button Content="{Binding}" Command="{Binding Path=FireCommand}" />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</Window> 
```

它只是一个`ListBox`, 绑定到一个`ObservableCollection<string>`命名的`CommandSets`（在 ViewModel 中）。
此绑定有效（它为集合中的每个项目显示一个按钮）。

现在我想将按钮绑定到命令 ( `FireCommand`)，该命令也在 ViewModel 中。
这是 ViewModel 的相关部分：

```
public class MainWindowViewModel : INotifyPropertyChanged
{
    public ICommand FireCommand { get; set; }
    public ObservableCollection<string> CommandSets { get; set; }

    public MainWindowViewModel()
    {
        this.FireCommand = new RelayCommand(new Action<object>(this.FireMissile));
    }

    private void FireMissile(Object obj)
    {
        System.Windows.MessageBox.Show("fire");
    }
} 
```

此按钮的绑定不起作用。
根据我从上面链接的[问题](https://stackoverflow.com/questions/3772797/wpf-mvvm-button-control-binding-in-datatemplate)中了解到的情况，绑定不起作用，因为：（
*如果我错了，请纠正我）*

*   按钮在 内部`ListBox`，所以它只“知道” `ListBox`（`ObservableCollection`在这种情况下是 ）的绑定，而不是主窗口的绑定
*   我正在尝试绑定到主窗口的主 ViewModel 中的命令（按钮不“知道”）

命令本身绝对正确，因为当我将按钮放在**外部**时`ListBox`（请参阅上面的 XAML 示例），绑定有效并且命令被执行。

**显然，我“只是”需要告诉按钮绑定到表单的主 ViewModel。
但我无法找出正确的 XAML 语法。**

我尝试了几种在谷歌搜索后发现的方法，但没有一个对我有用：

```
<Button Content="{Binding}" Command="{Binding RelativeSource={RelativeSource Window}, Path=DataContext.FireCommand}" />

<Button Content="{Binding}" Command="{Binding Path=FireCommand, Source={StaticResource MainWindow}}" />

<Button Content="{Binding}" Command="{Binding Path=FireCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" /> 
```

**有人可以请：**

1.  给我正确的 XAML 来将里面的按钮绑定`ListBox`到表单中的命令`MainViewModel`？
2.  指向一个链接，其中以 WPF/MVVM 初学者可以理解的方式解释这种高级绑定内容？
    *我觉得我只是在复制和粘贴神秘的 XAML 咒语，到目前为止我没有任何线索（也找不到任何好的文档）我将如何自己弄清楚在哪些情况下我需要`RelativeSource`或`StaticResource`或其他任何东西，而不是“正常”绑定。*

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-09-10T23:00:42.253

它的：

```
{Binding DataContext.FireCommand,
         RelativeSource={RelativeSource AncestorType=ListBox}} 
```

`DataContext`除非您实际更改路径，否则无需走到根目录，但由于`ListBox`似乎绑定到主 VM 上的属性，这应该足够了。

我唯一推荐阅读的是[Data Binding Overview](https://msdn.microsoft.com/en-us/library/ms752347(v=vs.100).aspx)和[`Binding`类](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.aspx)文档（包括它的属性）。

* * *

这里还有一个关于如何构造绑定的简短说明：绑定由一个*源*和一个*`Path`*相对于该*源*的源组成，默认情况下*源*是当前的`DataContext`。可以显式设置的来源是：`Source`, `ElementName`& `RelativeSource`。设置其中任何一个都将覆盖`DataContext`as *source*。

因此，如果您使用类似的*源*`RelativeSource`并想要访问`DataContext`该级别中的某些内容，则`DataContext`需要出现在*`Path`*.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-09-18T23:23:29.443

大多数人可能认为这不相关，但此搜索只是搜索数据模板内控件的数据绑定命令的 3 个结果中的 1 个 - 因为它与 Xamarin Forms 相关。所以，也许它现在会帮助某人。

像我一样，您可能想知道如何在 BindableLayout 中绑定命令。感谢 jesulink2514 在 Xamarin 论坛上回答这个问题，由于所有的评论，它可能被许多人忽略了。这是他的解决方案，但我包括以下链接：

```
<ContenPage x:Name="MainPage">
<ListView Grid.Row="1"
              ItemsSource="{Binding Customers}"
              VerticalOptions="Fill"
              x:Name="ListviewCustomer">
      <ListView.ItemTemplate>
        <DataTemplate>
      <Label Text="{Binding Property}"/>
          <Button Command="{Binding BindingContext.ItemCommand, Source={x:Reference MainPage}}" 
                         CommandParameter="{Binding .}">Click me</Button>
        </DataTemplate>
      </ListView.ItemTemplate>
    </ListView>
</ContentPage> 
```

[https://forums.xamarin.com/discussion/comment/217355/#Comment_217355](https://forums.xamarin.com/discussion/comment/217355/#Comment_217355)

# javascript - 克隆表行后如何使用jQuery动态更新ID？

> ID：12360563
> 
> 赞同：0
> 
> 时间：2012-09-10T22:56:31.210
> 
> 标签：javascript, jquery

触发时，表的第三（底部）行被克隆。在 CSS 中，这一行 (#tr3) 设置为：display:none; 这是我正在克隆的表行：

```
<tr name="tr3" id="tr3">
    <td><input type="text" name="dt1" id="dt1"></td>
    <td><input type="text" name="fn1" id="fn1"></td>
    <td><a href="#" name="change1" id="change1">change</a></td>
    <td><a href="#" name="del1" id="del1">delete</a></td>
</tr> 
```

这是克隆行的 JQuery 代码。可悲的是，不是我的，所以我不明白这一切。

```
$("table tr:nth-child(4)").clone().find("input").each(function() {
    $(this).val('').attr('id', function(_, id) {
    return id + count;
}); 
```

具体来说，第 2 行中的函数是如何工作的——下划线是什么？

不过，这就是我来的目的。我怎样才能：

1.  将样式更改为 display:block 用于克隆行，以及
2.  更新克隆行中锚标记的 ID。输入字段的 ID 会更新（例如 fn1 => fn11、fn12、fn13、fn14 等）。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:11:58.267

只是为了清楚起见：

```
var $clone = $("table tr:nth-child(4)").clone(); 
```

1.  如何将样式更改`display:block`为克隆行？

    ```
    $clone.show(); 
    ```

2.  如何更新克隆行中锚标记的 ID。

    ```
    $clone.find("a, input").each(function() {
      $(this).val('').attr('id', function(_, id) {
        return id + count;
      });
    }); 
    ```

3.  在上面的 jQuery 代码中，第 2 行中的函数是如何工作的——下划线是什么？

    下划线 ( `_`) 是有效[的 ECMAScript 标识符名称](http://es5.github.com/#x7.6)，它仅用作占位符，以便能够获取第二个参数 ( `id`.)

和所有的东西（未经测试。）

```
$("table tr:nth-child(4)")
  .clone()
  .show()
  .find("a, input").each(function() {
    $(this).val('').attr('id', function(_, id) {
      return id + count;
    });
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:06:03.933

1.  您永远不会真正自己访问克隆的行。您必须将其分配给某些东西，例如

    ```
    $clonedRow = $("table ...").clone(); 
    ```

    *然后*您可以运行所有其他方法并最终附加`$clonedRow`到 DOM，可能使用

    ```
    $clonedRow.insertAfter("table ...") 
    ```

2.  您需要以某种方式剥离最后一个数字，可能使用正则表达式：

    ```
    return id.replace(/\d+$/, '') + count; 
    ```

3.  这`_`只是一个占位符。它没有被使用，所以代码的作者选择了一个不起眼的变量名，因为在声明中需要一些东西来获取`id`参数。

# javascript - 表单的onSubmit方法的问题

> ID：12360569
> 
> 赞同：0
> 
> 时间：2012-09-10T22:56:56.483
> 
> 标签：javascript, onclick

所以我试图用 Javascript 制作一个简单的斐波那契生成器，但它似乎不起作用！我在我的浏览器（Chrome）和 JSFiddle 中都尝试过，但仍然无法正常工作。任何人都知道这里发生了什么？似乎它甚至没有进入该功能，因为没有弹出警报。

```
<html>
    <head>
        <script type='text/javascript'>

function fib()
{
    alert('In fib function');
    var c = parseInt(document.getElementById('f').value, 10);
    var o = document.getElementById('o');

    var x = 0;
    var y = 1;
    var z = 0;

    for (i = 0; i < 0; i++)
    {
        o.innerHTML += '\n' + x;
        z = x + y;
        x = y;
        y = z;
    }
    return false;
}​

        </script>

    </head>
    <body>
        <form onsubmit='return fib()'>
            <input id='f' type='text'></input>
            <input type='button' value='Submit' onClick='return fib()'
        <pre id='o'></pre>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:59:30.703

1.  输入元素不应有结束标记。该元素是“独立的”，本质上应该写为`<input.../>`or `<input...>`。
2.  第二个输入元素没有关闭。`>`应该加到最后。

3.  `for (i = 0; i < 0; i++) {`

此循环不会执行，因为`i`如果您最初将其设置为 0 并从那里递增，则它永远不会小于 0。

**这是一个修订版[——http://jsfiddle.net/wrg8Z/](http://jsfiddle.net/wrg8Z/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:02:57.897

您的代码有两个问题。首先，正如大卫指出的那样，您实际上不会打印出任何数字，因为循环永远不会执行。其次，你忘记关闭你的第一个`<input>`标签，它消耗了`<pre>`标签，这是你试图传递输出的地方。看到这个更新的小提琴有一个工作输出：

[http://jsfiddle.net/6neQU/](http://jsfiddle.net/6neQU/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T23:04:45.293

正如大卫所说，由于增量条件无效，因此您拥有的 for 循环将无法工作。当我 = 0; 你说的是“增加 i 直到它小于 0”这不会发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T23:11:29.123

在您的代码中：

```
> function fib() {
>     alert('In fib function');
>     var c = parseInt(document.getElementById('f').value, 10); 
```

`c`未使用。

```
>     var o = document.getElementById('o');
> 
>     var x = 0;
>     var y = 1;
>     var z = 0;
> 
>     for (i = 0; i < 0; i++) 
```

`i`未声明，因此在到达此行时变为全局。您正在从 0 迭代到 0，因此循环永远不会执行。

# html - 播放 HTML5 视频时平板电脑浏览器和手机浏览器的全屏模式

> ID：12360575
> 
> 赞同：0
> 
> 时间：2012-09-10T22:57:30.650
> 
> 标签：html, video, mobile-safari

在手机上，例如 iPhone，视频播放总是全屏模式，但在 iPad 上则不然。这是否意味着两个浏览器不同，或者它们相同但浏览器的内核可以检测到设备的某些变量，例如屏幕大小以强制它全屏？大多数情况下，Android 手机和平板电脑也是如此。但是我在 4.3 英寸的 HTC Android 手机上试过，播放视频时有时视频不会占满整个屏幕。为什么会这样？

另一个问题是，是否有可能某些视频文件可以在 iPad 上使用 HTML5 视频标签播放，但不能在 iPhone（和 Android 设备）上播放？还是反过来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:03:10.687

我不知道它如何与全屏检测一起工作，但我知道 HTML5 视频标签确实适用于 iPad 和 iPhone，只有 iPhone 会自动全屏播放，但 iPad 不会自动全屏播放。

# c# - 如何在水晶报表中管理页面大小和边距？

> ID：12360581
> 
> 赞同：6
> 
> 时间：2012-09-10T22:58:04.790
> 
> 标签：c#, .net, winforms, crystal-reports

我是水晶报表的新手，并且在.Net（WinForm / Visual Studio 2010）中使用水晶报表。

我在想在报告中设置页面大小和顶部、底部、左侧和右侧边距的方法是什么。我试图寻找选项，但无法得到它。请指导我。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-11T07:44:40.837

如果您使用**Crystal Reports**来设计您的报表，页面大小和边距可以通过页面设置进行编辑。**右键单击**您的报告选择**页面设置**。你会得到一个如下图所示的窗口。

![Crystal Report 中的页面设置](../Images/8369a82b4ff49a5f24204de1ab8e99e6.png)
在这里您可以编辑页面大小和边距...

如果您使用**VS2010**设计您的报告，请按照以下步骤操作

![打印机设置](../Images/c41ddefa956864801ec115dc5c7ba894.png)
![在此处输入图像描述](../Images/b2e0189d699f0cf46857dc9c9df1254f.png)

对于页边距打开页面设置

![在此处输入图像描述](../Images/a781ca2261e12b2da249a87370e6bc9a.png)

希望这可以帮助 ！！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-12-14T08:36:09.233

并以编程方式更改它们：

```
 yourReportObject.PrintOptions.PaperSize = CrystalDecisions.Shared.PaperSize.PaperA4;
        yourReportObject.PrintOptions.ApplyPageMargins(new CrystalDecisions.Shared.PageMargins(0, 0, 0, 0)); 
```

# php - 为不同尺寸的图像创建固定的缩略图尺寸

> ID：12360586
> 
> 赞同：1
> 
> 时间：2012-09-10T22:58:41.833
> 
> 标签：php, image

我只是想知道是否有可能获得不同的图像尺寸，并为这些图片创建固定的缩略图尺寸测量，而不会丢失其准确的纵横比。

到目前为止，我已经做了这些：

*   调整不同图像的大小
*   保持它们的纵横比
*   **不**提供相同的尺寸（例如：100px- 高度和 100px- 宽度）

这是我正在使用的代码：

```
<?php
require("dbinfo.php");

$allPhotosQuery = mysql_query (" SELECT * FROM `placesImages` ");

while ($allPhotosArray = mysql_fetch_assoc ($allPhotosQuery))
{
    $filename= $allPhotosArray['fileName'];
    $placeId = $allPhotosArray['placeId'];

    $imagePath = "placesImages/" . $placeId . "/" . $filename;
    $imageSize = getimagesize($imagePath);

    $imageWidth = $imageSize[0];
    $imageHeight = $imageSize[1];

    $newSize = ($imageWidth + $imageHeight)/($imageWidth*($imageHeight/45));
    $newHeight = $imageHeight * $newSize;
    $newWidth = $imageWidth * $newSize;

    echo "<img src='".$imagePath."' width='".$newWidth."' height='".$newHeight."' />";
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T23:33:04.863

将此函数输入您的原始图像宽度和高度，然后是缩略图限制的最大约束，它将吐出一个数组，其中包含您应该设置缩略图以保持纵横比的 x/y 数组。（任何小于缩略图的都会被放大）

```
function imageResizeDimensions($source_width,$source_height,$thumb_width,$thumb_height)
{
  $source_ratio = $source_width / $source_height;
  $thumb_ratio = $thumb_width / $thumb_height;
  if($thumb_ratio > $source_ratio)
  {
    return array('x'=>$thumb_height * $source_ratio,'y'=>$thumb_height);
  }
  elseif($thumb_ratio < $source_ratio)
  {
    return array('x'=>$thumb_width,'y'=>$thumb_width/$source_ratio);
  }
  else
  {
    return array('x'=>$thumb_width,'y'=>$thumb_width);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T00:46:15.767

让我们从两个常量`thumb_width`和开始`thumb_height`，它们是缩略图所需的宽度和高度。它们可以相等，但不必相等。

如果您的图像宽于高（横向），我们可以将宽度设置为所需的缩略图宽度`thumb_width`，然后调整高度以保持纵横比。

```
new_width = thumb_width
new_height = thumb_height * old_height / old_width 
```

请参阅[imagecreatetruecolor](http://php.net/manual/en/function.imagecreatetruecolor.php)。

然后，您可以移动图像以使其在缩略图范围内垂直居中，从而产生[信箱](http://en.wikipedia.org/wiki/Letterboxing_%28filming%29)效果。请参阅[imagecopyresampled](http://php.net/manual/en/function.imagecopyresampled.php)。

```
new_y = (thumb_height - new_height) / 2 
```

对于比它们宽（纵向）高的图像，过程是相同的，但数学有点不同。

```
new_height = thumb_height
new_width = thumb_width * old_width / old_height 
```

然后您可以在缩略图的范围内将其水平居中。

```
new_x = (thumb_width - new_width) / 2 
```

有关创建缩略图的基础知识的更多信息，请参阅[Resizing images in PHP with GD and Imagick](http://www.fliquidstudios.com/2009/05/07/resizing-images-in-php-with-gd-and-imagick/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T23:10:18.127

除了裁剪之外，在制作缩略图时保持纵横比的最简单方法是执行与您所拥有的类似的操作，但将其设置为固定：

例如，如果你希望所有的 tumbs 都是 100px 宽：

```
$imageWidth = $imageSize[0];
$imageHeight = $imageSize[1];
$ratio=ImageWidth/$imageHeight;
$newHeight=(int)$ratio*100;
$newWidth=100; 
```

需要注意的是，如果图像有一个有趣的比例，你最终可能会得到一些有趣的尺寸——因为它会很高兴地继续做下去。对代码中的比率进行某种检查可能是个好主意 - 如果它太低或太高，请执行其他操作，否则使用此标准过程。

# iphone - FMOD 和简单的 If 语句

> ID：12360588
> 
> 赞同：0
> 
> 时间：2012-09-10T22:58:43.527
> 
> 标签：iphone, objective-c, ios, if-statement, fmod

我有一组简单的 FMOD 动作，每个动作分别播放各种声音。问题在于我有一个停止所有声音的按钮。如果我们尝试停止未播放的声音，FMOD 会使我的程序崩溃。说得通。但是我已经决定必须有一种方法可以调用一个简单的 if 语句来找出“如果”并且只有“如果”某些东西正在播放，然后停止它。

```
- (IBAction)myButton:(id)sender {

    if "FMOD CHANNEL IS PLAYING" {

        result = fmodChannel->stop();

    }

} 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T02:48:33.107

`stop`如果您调用未播放的频道，我不会说 FMOD 崩溃是“有道理的” 。它记录在失败时返回错误代码。你确定`fmodChannel`在你调用时仍然是一个有效的指针`stop`吗？

无论如何，您可以尝试以下`isPlaying`方法：

```
bool isPlaying;
if (fmodChannel->isPlaying(&isPlaying) == FMOD_OK && isPlaying) {
    fmodChannel->stop();
} 
```

# objective-c - 手动滚动 UIView contentOffset

> ID：12360589
> 
> 赞同：0
> 
> 时间：2012-09-10T22:58:55.010
> 
> 标签：objective-c, ios, uiview, uiscrollview

我正在尝试使用 contentOffset 滚动**UIView**的内容，到目前为止，我实现了处理**touchesBegan**：和**touchesMoves**：视图的方法，但是当我手动更改 UIView 的边界时，我得到了一个跳跃的效果（例如: 当前位置+/-手指最后位置和新位置的变化)

有没有什么简单的方法可以在不手动更改 UIView 边界的情况下实现这一点？

**重要说明：**我没有使用**UIScrollView**，因为提到的**UIView**有很多 **可拖动的子视图**，所以如果我使用**UIScrollView**我不能拖动，因为**UIViewScroll**滚动事件在子视图事件上执行。

为上述 UIView 的图层设置动画会导致内容失控，就像参考点发生了某种变化一样。

但是，我总是乐于接受建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:04:15.183

我宁愿制作一个 UIView 容器剪辑子视图，添加我们将作为子视图拖动的内容视图并更改它的框架。我认为它不应该有跳跃的效果，因为它必须与动画视图框架更改相同。

# asp.net - 自定义网页字体在 IE9 中不起作用

> ID：12360592
> 
> 赞同：3
> 
> 时间：2012-09-10T22:59:23.220
> 
> 标签：asp.net, css, asp.net-mvc-3, internet-explorer-9, webfonts

我下载了自定义字体 ( `Gotham-Light.eot`)，但它在 Internet Explorer 9 上不起作用。

```
@font-face {
    font-family: Gotham-Light;
    src: url('Gotham-Light.eot');
} 
```

这行不通。我正在使用 ASP MVC3 重建，使用自定义工具，仍然没有。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-11T02:16:39.463

一、货物：

```
@font-face {
    font-family: 'ludger_duvernayregular';
    src: url('http://jfcoder.com/css/fonts/ludgerduvernay-fontsquirrel/ludgerduvernay.eot');
    src: url('http://jfcoder.com/css/fonts/ludgerduvernay-fontsquirrel/ludgerduvernay.eot?#iefix') format('embedded-opentype'),
         url('http://jfcoder.com/css/fonts/ludgerduvernay-fontsquirrel/ludgerduvernay.woff') format('woff'),
         url('http://jfcoder.com/css/fonts/ludgerduvernay-fontsquirrel/ludgerduvernay.ttf') format('truetype'),
         url('http://jfcoder.com/css/fonts/ludgerduvernay-fontsquirrel/ludgerduvernay.svg#ludger_duvernayregular') format('svg');
    font-weight: normal;
    font-style: normal;
}

p.test {
    font-family: 'ludger_duvernayregular', Arial, serif;
    font-weight: 400;
    color: blue;
} 
```

请注意，我使用了一种易于被视为有效的字体。（*而且我无法使用网络字体访问 Gotham，所以......我什至不确定 Gotham 是否被许可以网络字体形式使用。如果您没有许可证或许可证不允许它，请尊重这一点。*）因此，您将不得不考虑一下字体文件的路径。

我所做的是查阅[链接到的博客文章 AlienWebGuy](http://www.fontspring.com/blog/fixing-ie9-font-face-problems)，这很好。时间不长，我就读了。它归结为：

1.  可能是字体文件的 MIME 类型配置错误。有关更多信息，请参见下文。还有一个注释说 Apache 可能有这个问题，它似乎更像是一个 IIS 问题（根据文章）。
2.  您可以欺骗 (?) IE9 使用 EOT 文件而不是 WOFF，这显然可以解决问题（根据文章）。

此外，顺便说一句，IE9 在使用[jsFiddle 演示](http://jsfiddle.net/7NSWc/) *使用相同的 CSS*显示字体时遇到问题。很奇怪。IE7 和 8 运行良好，所以我知道它在某些方面工作。我不知道那是什么，但我将相同的标记和 CSS 保存到我网站上的一个文件中，它工作正常。

## *分解...*

让我解释一下上面的 CSS 中发生了什么。我会遍历每一行。但是，请记住，我有以下文件格式的网络字体：

*   eot
*   woff
*   ttf
*   svg

您真的可能只需要`eot`，`ttf`并且`woff`如果您不关心支持旧版 iOS。不过，SVG 翻译很难获得。

现在，首先**命名您的字体**，以便您可以引用它：

```
font-family: 'ludger_duvernayregular'; 
```

**IE9 兼容模式：**

```
src: url('http://jfcoder.com/css/fonts/ludgerduvernay-fontsquirrel/ludgerduvernay.eot'); 
```

请记住*验证您在此处使用的 URL 是否确实指向一个真实文件*。把它放在地址栏中，看看会发生什么（它会下载吗？404？）。

但是，在下文中，我将删除完整的 URL，以便您可以看到整个语句，包括结尾。

**IE6、7 和 8：**

```
src: url('http://../ludgerduvernay.eot?#iefix') format('embedded-opentype'), 
```

注意这部分：

```
.eot?#iefix <<< See below for an explanation. 
```

> ***进一步的 IE CSS 修复***
> 
> 在极少数情况下，IE 会失败，因为*@font-face 声明有太多字符*。在大多数情况下，这可以通过在 *“？”之后添加一个“#”哈希标记来解决。问号*。这会给你带来一点额外的空间。

[*- 来自 Font Spring 文章*]

我不知道为什么会这样，所以我相信他们的话。

**现代浏览器：**

```
url('http://../ludgerduvernay.woff') format('woff'), 
```

**Safari、安卓、iOS：**

```
url('http://../ludgerduvernay.ttf') format('truetype'), 
```

**旧版 iOS：**

```
url('http://../ludgerduvernay.svg#ludger_duvernayregular') format('svg'); 
```

**然后使用它：**

```
p {
    font-family: 'ludger_duvernayregular', Arial, serif;
} 
```

我真的很惊讶这可以追溯到 IE6。无论如何，请注意我使用文件的完整路径，而不是相对路径。这通常是一个很好的起点。***检查以确保链接下载***。我对此很重视，因为它很基础而且很容易搞砸。

因此，如果文件正在使用 url 下载，并且您已使其在其他浏览器中运行，并且在 IE6、7 和/或 8 中，您可以查看另一种可能性：

**在服务器端 (IIS) 修复 IE9**

> Microsoft 的 IIS 服务器将拒绝发送它没有 MIME 类型的资源。我们开发的语法强制 IE9 将 WOFF 置于 EOT 之上，但如果它在 IIS 上提供，它将失败。这是因为 IE9 请求 WOFF 文件，但由于 WOFF 不是 IIS 中定义的 MIME 类型，因此返回 404 Not Found 错误。要解决此问题，您必须将 MIME 类型为“application/x-font-woff”的“.woff”添加到您的 IIS 安装中。

[*- 来自 Font Spring 文章*]

因此，您可能必须检查您的服务器是否正在运行。您还可以使用 Chrome 控制台或 Firebug NET 选项卡查看随文件发送的标头。

现在我在这里得到了一点帮助，我认为您应该考虑以下选项：

1.  [**谷歌网络字体**](http://www.google.com/webfonts)。不要成为英雄。他们托管字体，为您提供包含样式表标记，然后，您就开始做生意了。他们也有一些很酷的字体。还有[其他网络字体服务](http://www.smashingmagazine.com/2010/10/20/review-of-popular-web-font-embedding-services/)，例如 Typekit、Webtype、Fontdeck 和 Fonts Live。
2.  [**Font Squirrel**有一个*@Font-Face Generator*](http://www.fontsquirrel.com/fontface/generator)，它可以为您提供您需要的所有文件（**警告：只提交您*知道要获得网络使用许可的*字体。**）。使用专家模式，它会给你一个包含很多很棒的东西的 ZIP 文件，包括一个演示。我收到的你可以在这里下载。有趣的是，生成的 CSS 与 Font Spring 相同，只是去掉了注释。这可能不是巧合。
3.  [**我在这个 Opera Dev 页面**](http://dev.opera.com/articles/view/introducing-woff-web-open-font-format/)上发现了这个很棒的工具。这也值得一读。
4.  当然，该[博客文章 AlienWebGuy 链接到](http://www.fontspring.com/blog/fixing-ie9-font-face-problems)Font **Spring**。

这东西并不难，但你需要知道如何排除故障。始终检查文件是否正在下载；您可以使用 Chrome 控制台资源选项卡或 Firefox 的 Firebug 插件并观察 NET 选项卡以查看它是否下载。如果它真的不起作用，请将页面或代码发布到我们可以访问的地方，我们可以对其进行审查。

*快乐编码。`:)`*

* * *

演示中使用的超酷字体是**Ludger Duvernay Regular**。有关详细信息，请参阅[Steve Cloutier/Cloutierfontes](http://www.cloutierfontes.ca)网站。感谢您将其免费供个人使用。`:)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T00:53:06.803

如果您按照此处列出的说明进行操作——http: [//www.fontspring.com/blog/fixing-ie9-font-face-problems——](http://www.fontspring.com/blog/fixing-ie9-font-face-problems)那么这很可能是您调用字体的方式。

确保您从样式表中指向正确的位置 - 上面的代码仅在字体文件与样式表位于同一目录中时才有效。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T05:14:35.550

Gotham 是一个商业产品，如果你刚刚从某个地方下载了它，它可能是非法复制品或假冒产品，而且很可能在技术上也被破坏了。

考虑使用类似设计的免费字体，例如[Cicle](http://www.dafont.com/cicle.font)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-10T09:53:34.220

对于 googlers：我遇到了长字体名称或与已安装字体冲突的问题。无论如何，IE是唯一有问题的浏览器。

我变了

`font-family: 'HelveticaLTUltraCompressedRegular';`

到

`font-family: 'HelveticaLTUCR';`

这解决了我的问题。

# java - 如何在 j2me 中以编程方式结束通话？

> ID：12360596
> 
> 赞同：4
> 
> 时间：2012-09-10T23:00:06.020
> 
> 标签：java, java-me

我正在开发一个需要用户电话号码的应用程序，因此我从用户的 j2me 应用程序调用服务器，并`platformRequest("tel:" + number);`为此目的在我的程序中使用。

但问题是我不知道如何中止呼叫，因为一分钟的响铃足以让服务器检索用户号码。

我想知道是否有任何取消呼叫的 API 或指令或一些技巧？例如，在 j2me 中是否可以通过编程方式按下 RED 按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T06:57:09.077

没有办法做到这一点，最好让您的服务器以某种方式终止呼叫。

# go - 无需换行即可将 stdin 击键发送到通道

> ID：12360597
> 
> 赞同：8
> 
> 时间：2012-09-10T23:00:07.873
> 
> 标签：go, channel

我想在每次对标准输入进行单独击键后将用户的击键直接发送到通道。

我尝试了下面的代码，但这并没有给出预期的结果，因为该`reader.ReadByte()`方法会阻塞，直到输入换行符。

```
func chars() <-chan byte {
    ch := make(chan byte)
    reader := bufio.NewReader(os.Stdin)
    go func() {
        for {           
            char, err := reader.ReadByte()
            if err != nil {
                log.Fatal(err)
            }
            ch <- char
        }
    }()
    return ch
} 
```

感谢您就如何让每个用户输入字符立即进入频道而不需要换行符提供任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-11T00:49:52.347

默认情况下，标准输入是行缓冲的。这意味着它不会向您产生任何输入，直到遇到换行符。这不是 Go 特定的东西。

让它以非缓冲方式运行是高度特定于平台的。正如 Rami 所建议的，ncurses 是一种方法。另一种选择是轻得多的[go-termbox](https://github.com/nsf/termbox-go)包。

如果您想手动完成所有操作（至少在 Linux 上），您可以查看为[termios](http://linux.die.net/man/3/termios)编写 C 绑定或直接在 Go 中执行系统调用。

我不知道像 Windows 这样的平台如何处理这个问题。您可以深入研究 ncurses 或 termbox 的源代码，看看他们是如何做到的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T00:35:29.410

如果你在**Linux**上，你可能想看看 Goncurses 包

[http://code.google.com/p/goncurses/](http://code.google.com/p/goncurses/)

它具有以下功能：GetChar()，这是您想要的。

# c# - ADFS url 区分大小写

> ID：12360598
> 
> 赞同：0
> 
> 时间：2012-09-10T23:00:14.593
> 
> 标签：c#, adfs2.0, adfs

有谁知道如何使使用 adfs 的 Web 应用程序的 url 不区分大小写？现在，如果我尝试使用与我在 web.config 中的 returnurl 下提供的不同的情况浏览我的应用程序，它会给我系统错误。有什么帮助吗？

```
 <websso>
      <authenticationrequired/>
      <eventloglevel>55</eventloglevel>
      <auditsuccess>2</auditsuccess>
      <urls>
        <returnurl>https://host/AppCaseSensitveName/</returnurl>
      </urls> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T05:26:10.143

看看[字符串处理属性存储示例](http://msdn.microsoft.com/en-us/library/hh599320.aspx)，它显示：

```
ToUpper(); 
```

和

```
ToLower(); 
```

# c++ - 生成 IDE 项目文件

> ID：12360602
> 
> 赞同：1
> 
> 时间：2012-09-10T23:00:34.470
> 
> 标签：c++, c, build, ide, cmake

这里的场景：

一个人用 C/++ 创建了一个漂亮的软件库/模块。

现在想要让新用户更容易使用这个库/模块。

所以想要提供所有包含设置、编译器标志和链接器设置都正确设置的 IDE 项目文件。

想为不同平台下的许多不同 IDE 提供项目文件，例如：Linux（32 位和 64 位）、Windows（32 位和 64 位）、Mac（32 位和 64 位）、CodeBlocks、Eclipse CDT、KDevelop3、 CodeLite、Microsoft Visual Studio 等

（假设包含文件和库文件的所有路径以及所有编译器标志都是已知的。例如，通过可下载 SDK 的静态路径）

所以想要使用这个库的用户只需要：

*   安装库/模块
*   选择正确的项目文件（取决于用户的操作系统和 IDE）
*   开始编码
*   （所有包含设置、编译器标志和链接器设置都已在项目文件中正确设置）
*   （无需用户手动设置包括设置、编译器标志和链接器设置）

如何从已知的包含设置、编译器标志和链接器设置中轻松生成这样的项目文件。

我已经看过 CMake（它非常接近最终目标），但它为 IDE 项目文件创建了一个额外的 CMake 文件夹，并且也不会将可能的示例源复制到构建目录中。（也许有可能让 CMake 在没有 CMake 文件夹的情况下生成项目文件并将源文件复制到构建文件夹中？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:15:23.810

> （所有包含设置、编译器标志和链接器设置都已在项目文件中正确设置）
> 
> （无需用户手动设置包括设置、编译器标志和链接器设置）

仅当您的项目没有依赖项时才有可能。否则，您无法知道 deps 的库和标头在用户计算机上的位置。

CMake 正是为此而创建的——查找依赖项并生成项目文件。

> 但它会为 IDE 项目文件创建一个额外的 CMake 文件夹

如果您正在谈论二进制目录，那么它可以位于任何地方，而不是项目目录中的必要位置。

> 并且也不会将可能的示例源复制到构建目录中。

可以通过`configure_file`函数或运行`${CMAKE_PROGRAM} -E copy`.

# performance - 使用 Qt 调试器对性能进行故障排除

> ID：12360605
> 
> 赞同：0
> 
> 时间：2012-09-10T23:01:01.637
> 
> 标签：performance, qt, debugging, qtablewidget

嗨，我是一名学生程序员，使用 Qt 构建一些工作编辑应用程序，我在调试实践中遇到了一个问题，我不确定如何解决。当引入 100 多行时，我有 QTableWidget 至少需要 10 秒才能填充。

我想知道 Qt 的调试器是否有任何工具来帮助查明操作在哪里花费最多时间。我已经检查了几次操作，一切看起来都正确且高效，所以我很迷茫。我查看了调试器的[调试和分析](http://doc.qt.nokia.com/qtcreator-2.5/creator-testing.html)部分，没有看到任何看起来有用的东西，因为我很确定我的症状不是内存泄漏。感谢您阅读我的帖子，并提前感谢您在此问题上的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T05:14:54.777

如果您遇到性能问题并想查看应用程序时间花在什么地方，您需要进行一些[Profiling](http://en.wikipedia.org/wiki/Profiling_%28computer_programming%29)。根据您的平台和选择的 IDE，工具会有所不同，您应该查看最常用的工具。

对于 Linux，可供选择的工具很少。我发现非常有用的是[Valgrind](http://valgrind.org/)工具 Callgrind，它有一个相当不错的可视化工具，称为[KCachegrind](http://kcachegrind.sourceforge.net/html/Home.html)，应该可以在您的发行版存储库中使用。

由于您使用的是 Qt，因此您很有可能也使用 Qt Creator，然后我发现了一些关于[Valgrind 在 Qt Creator 中](http://doc.qt.nokia.com/qtcreator-2.3/creator-cache-profiler.html)的集成。

# mysql - mysql curdate 减一

> ID：12360609
> 
> 赞同：0
> 
> 时间：2012-09-10T23:01:17.963
> 
> 标签：mysql

我不知道为什么当我用 CURDATE() 更新我的数据库时，它总是将它设置为明天的日期。

服务器时间为：Mon Sep 10 16:53:47 MDT 2012

更新看起来像： UPDATE map SET size=500007292,kb="476.84 MB",lastupdate=CURDATE(),version="1621" WHERE id = "5d903cd6863015dff2c2a1b65346d107"

我最后一次更新，今天早些时候，它设置日期为 2012 年 9 月 11 日

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:19:28.180

MSD 似乎是[莫斯科时间](http://www.timeanddate.com/library/abbreviations/timezones/eu/msd.html)。已经是明天了。

# java - javafx 可调整大小的窗格和里面的矩形

> ID：12360611
> 
> 赞同：1
> 
> 时间：2012-09-10T23:01:50.193
> 
> 标签：java, javafx, pane

我有一个 javafx 窗格和一个矩形。我想让矩形填充窗格的所有空间而不手动设置宽度或高度，因为窗格可以调整大小。

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:31:04.120

将 Rectangle 的 height 和 width 属性绑定到 Pane 的 height 和 width 属性。

或者您可能只想使用 css 设置窗格的背景并完全摆脱 Rectangle。

# objective-c - UIScrollView 回到原来的地方

> ID：12360613
> 
> 赞同：0
> 
> 时间：2012-09-10T23:01:58.117
> 
> 标签：objective-c, xcode, uiscrollview

我有以下代码：

```
float yOffset = activeTextView.frame.origin.y - keyboardSize.height + 55;
        CGPoint scrollPoint = CGPointMake(0.0, yOffset);
        [scrollView setContentOffset:scrollPoint animated:YES]; 
```

这将动画滚动视图`- (void)keyboardWasShown:(NSNotification *)notification`

我试图在隐藏键盘后将scrollView返回到它的原始位置，如下所示：

```
- (void) keyboardWillHide:(NSNotification *)notification {

    UIEdgeInsets contentInsets = UIEdgeInsetsZero;
    scrollView.contentInset = contentInsets;
    scrollView.scrollIndicatorInsets = contentInsets;

} 
```

但它不起作用！

如何将 UIScrollView 和整个屏幕返回到其原始位置，以便用户在滚动视图动画之前看到他看到的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:23:00.673

在您的`keyboardWasShown:`方法中，您正在设置`contentOffset`属性（`[scrollView setContentOffset:]`相当于`scrollView.contentOffset`）。但是，在 中`keyboardWillHide:`，您正在设置`contentInset`，这是完全不同的东西（本质上，它是滚动视图内容的内部填充量）。尝试

```
scrollView.contentOffset = CGPointZero; // non-animated by default 
```

或者

```
[scrollView setContentOffset:CGPointZero animated:YES]; // animated 
```

此外，正如 NSResponder 所提到的，请确保`keyboardWillHide:`正在调用您的方法。

# jsf - 多次调用 fileUpload 事件

> ID：12360614
> 
> 赞同：0
> 
> 时间：2012-09-10T23:02:04.243
> 
> 标签：jsf, file-upload, primefaces

使用 PrimeFaces fileUpload 控件上传文件时出现问题。

问题是上传文件时，上传事件被调用了 4 次。

我找不到明确的原因。

这是我的 xhtml 页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
    </h:head>
    <h:body>

        <ui:composition template="home.xhtml">

            <ui:define name="content">

                <script type="text/javascript">
                    function callChangeImage(){
                        alert('completed');
                        var hiddenLink = document.getElementById('mainForm:hiddenLink');
                        hiddenLink.click();                
                    }
                    function callDeleteImageFromTemp(){
                        alert('started');
                        updated = false;
                        var hiddenLink2 = document.getElementById('mainForm:hiddenLink2');
                        hiddenLink2.click(); 
                    }
                </script>

                <p>
                    <p:commandButton value="Agregar Noticia" update="newsTable, display" icon="ui-icon-circle-plus" actionListener="#{newsBean.addNew}" oncomplete="newDialog.show()"/>                                  
                    <p:commandButton value="Editar Noticia" oncomplete="editNewDialog.show()" icon="ui-icon-pencil"/>
                    <p:commandButton value ="Eliminar Noticia" icon="ui-icon-trash" onclick="dlgDelete.show()" />                            
                </p>

                <p:scrollPanel>
                    <p:dataTable var="unew" value="#{newsBean.news}" rowKey="#{unew.id}" 
                                 selection="#{newsBean.selectedNew}" selectionMode="single" id="newsTable">  

                       <p:ajax event="rowSelect" update=":mainForm:display" />

                       <f:facet name="header">  
                            Lista de noticias  
                        </f:facet>  

                        <p:column headerText="Numero" sortBy="#{unew.id}" filterBy="#{unew.id}" id="id">  
                            #{unew.id}  
                        </p:column>

                        <p:column headerText="Titulo" sortBy="#{unew.title}" filterBy="#{unew.title}" id="title">  
                            #{unew.title}  
                        </p:column>

                        <p:column headerText="Descripcion" sortBy="#{unew.description}" filterBy="#{unew.description}" id="description">  
                            #{unew.description}  
                        </p:column>

                        <p:column headerText="Enlace" sortBy="#{unew.link}" filterBy="#{unew.link}" id="link">  
                            #{unew.link}  
                        </p:column>

                        <p:column headerText="Imagen" sortBy="#{unew.img}" filterBy="#{unew.img}" id="img">  
                            #{unew.img}  
                        </p:column>

                    </p:dataTable> 
                 </p:scrollPanel> 

                 <p:dialog widgetVar="dlgDelete" header="Desea eliminar la noticia #{newsBean.selectedNew.id}?">
                     <p:panel style="text-align: center">
                        <p:commandButton value="Si" update="newsTable" action="#{newsBean.removeNew}"  oncomplete="dlgDelete.hide()" />
                        <p:commandButton value="No" onclick="dlgDelete.hide()" type="button" />
                    </p:panel>
                 </p:dialog>

                 <p:dialog header="Editar Noticia" widgetVar="editNewDialog" resizable="false"  
                           showEffect="explode" hideEffect="explode" onHide="">  

                    <p:ajax event="close" listener="#{fileUploadBean.deleteFileFromTemp}" update="messages"/>  
                    <p:ajax event="close" listener="#{newsBean.deleteImageFromTemp}" update="messages"/>  

                    <h:panelGrid id="display" columns="2" cellpadding="4">  

                        <f:facet name="header">                                                                             
                            <p>Noticia #{newsBean.selectedNew.id}</p>                       
                            <p>
                                <p:commandLink id="editImage">
                                    <p:graphicImage id="imageNew" value="/temp/#{newsBean.selectedNew.img}" />
                                </p:commandLink>
                                <p:overlayPanel id="editImagePanel" for="editImage" hideEffect="fade">                               
                                    <table cellpadding="5px">
                                        <tr>
                                            <td>
                                            <p:commandButton title="Eliminar Imagen" update="imageNew" actionListener="#{newsBean.removeImage}" icon="ui-icon-trash"/>                                   
                                            </td>
                                            <td>
                                            <p:fileUpload 
                                                    fileUploadListener="#{fileUploadBean.handleFileUpload}"  
                                                    mode="advanced"                                                     
                                                    sizeLimit="1000000"   
                                                    allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                                    cancelLabel="Eliminar"
                                                    uploadLabel="Subir"                                                  
                                                    label="Buscar..."
                                                    dragDropSupport="false"
                                                    oncomplete="callChangeImage();"
                                                    onstart="callDeleteImageFromTemp();"
                                                    auto="true">                                              
                                            </p:fileUpload>
                                            <p:commandLink id="hiddenLink" action="#{newsBean.changeImage(fileUploadBean.uploadedFile.fileName)}" style="display:none" update="imageNew"/>
                                            <p:commandLink id="hiddenLink2" action="#{newsBean.deleteImageFromTemp}" style="display:none"/>
                                            </td>
                                        </tr>
                                    </table>
                                </p:overlayPanel>
                            </p>              
                        </f:facet>

                        <h:panelGrid id="display2" columns="2" cellpadding="4">  
                            <h:outputText value="Titulo:" />  
                            <p:inputTextarea rows="1" cols="60" value="#{newsBean.selectedNew.title}" id="title"/>  

                            <h:outputText value="Descripcion:" />  
                            <p:inputTextarea rows="6" cols="60" value="#{newsBean.selectedNew.description}" id="description"/>  

                            <h:outputText value="Enlace:" />  
                            <p:inputTextarea rows="1" cols="60" value="#{newsBean.selectedNew.link}" id="link"/> 
                        </h:panelGrid>

                         <f:facet name="footer">  
                             <p:commandButton value="Guardar" update="newsTable" actionListener="#{newsBean.saveNewEdit}" oncomplete="newDialog.hide()">
                                 <p:ajax listener="#{fileUploadBean.writeUploadedFile('/images/news/', newsBean.selectedNew.id)}" update="messages"/>  
                             </p:commandButton>
                        </f:facet> 

                    </h:panelGrid>  
                </p:dialog> 

            </ui:define>

        </ui:composition>

    </h:body>
</html> 
```

还有我的后端 bean：

```
package Beans;

import helpers.Global;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.faces.context.FacesContext;
import org.apache.commons.io.FilenameUtils;
import org.primefaces.event.FileUploadEvent;
import org.primefaces.model.UploadedFile;

@ManagedBean
@SessionScoped
public class FileUploadBean {

    private UploadedFile uploadedFile;

    public FileUploadBean() {
    }

    public UploadedFile getUploadedFile() {
        return uploadedFile;
    }

    public void setUploadedFile(UploadedFile uploadedFile) {
        this.uploadedFile = uploadedFile;
    }

    public void writeUploadedFile(String path, String fileName){

            try
            {

                if (this.uploadedFile != null)
                {
                    String fileExtension = FilenameUtils.getExtension(this.uploadedFile.getFileName());
                    path += fileName + "." + fileExtension;
                    File file = new File(path);
                    if (file.exists()){
                        file.delete();
                    }
                    file.createNewFile();
                    InputStream is = uploadedFile.getInputstream();
                    OutputStream out = new FileOutputStream(file);
                    byte buf[] = new byte[1024];
                    int len;
                    while ((len = is.read(buf)) > 0){
                        out.write(buf, 0, len);
                    }
                    is.close();
                    out.close();
                }else{

                }

            }catch (Exception ex){
                Global.sendErrorsResponseMessage(ex.getMessage());
            }
    }

    public void deleteUploadedFile(String path) {
         if (this.uploadedFile != null)
         {                    
            path += uploadedFile.getFileName();
            File file = new File(path);
            if (file.exists()){
                file.delete();
            }        
        }
    }

    public void handleFileUpload(FileUploadEvent event) {  

        deleteFileFromTemp();
        this.uploadedFile = event.getFile();    
        if (this.uploadedFile == null){
            Global.sendErrorsResponseMessage("No se puedo cargar el archivo");
            return;
        }
        try {
            saveFileToTemp();
            FacesMessage msg = new FacesMessage("Archivo cargado con exito", event.getFile().getFileName());  
            FacesContext.getCurrentInstance().addMessage(null, msg);  
        } catch (Exception ex) {
            Global.sendErrorsResponseMessage(ex.getMessage());
        }
    }

    public void saveFileToTemp(){
         String path = FacesContext.getCurrentInstance().getExternalContext().getRealPath("/");        
         path = path + "temp" + Global.fileSeparator;
         String fileName = FilenameUtils.removeExtension(this.uploadedFile.getFileName());
         writeUploadedFile(path, fileName);
    }

    public void deleteFileFromTemp(){
        if (this.uploadedFile != null){
            String path = FacesContext.getCurrentInstance().getExternalContext().getRealPath("/");
            String imageFileName = this.uploadedFile.getFileName();           
            path = path + "temp" + Global.fileSeparator + uploadedFile.getFileName();
            File f = new File(path);
            f.delete();
        }
    }
} 
```

如果执行此页面并且您尝试上传文件，则“beforeUpload”和“afterUpload”函数中的javascript“警报”会显示4次。

这导致我在使用文件上传更新的图像中闪烁。

我会得到任何帮助，因为我有点坚持这一点。

谢谢你的帮助！

## 一点背景：

此页面的目的是添加新闻（用于个性化新闻阅读器）。在此页面中，有一个包含新闻的表格，每次选择新行时，都会出现一个对话框来编辑新行。

在该对话框中，您可以看到 New 和其他内容的图像。

目的是当在编辑器中单击图像时，会出现一个覆盖面板，其中包含上传新图像或删除当前图像的选项。

标题为“Elimnar Imagen”的 commandButton 删除了 New 的图像。fileUpload 为 New 上传新图像。所以他们俩都应该在前端编辑器对话框中更新 New 的图像。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2015-01-14T12:53:35.927

在 JSF 生命周期中，动作侦听器在以下阶段中被多次调用：

```
Apply request values phase; **process events**

Process validations phase; **process events**

Update model values phase; **process events**

Invoke application phase; **process events** 
```

# c# - 3n+1猜想的算法指导

> ID：12360625
> 
> 赞同：2
> 
> 时间：2012-09-10T23:04:03.170
> 
> 标签：c#, algorithm, math, collatz

好的，我知道这听起来像是家庭作业；但无论如何。我正在尝试使用 C#解决这个[问题。](http://uva.onlinejudge.org/external/1/100.html)问题描述的摘录如下所示：

> 给定输入 n，可以确定打印的数字数量（包括 1）。对于给定的 n，这称为 n 的周期长度。在上面的例子中，22 的循环长度是 16。对于任何两个数字 i 和 j，您要确定 i 和 j 之间所有数字的最大循环长度。

# 问题

我什么都懂，除了一件事，周期长度。我只是不完全理解。我发现文本对它的定义模棱两可。我**假设**，循环长度是序列中有多少个数字，所以可以说输入为 10，循环长度为 8。但我只是不确定。您不需要任何代码，但我只要求指导。

另外，我已经知道如何从标准输入和输出中读取。由于问题在于编程竞赛格式。

# 我显示以 n 作为输入的数字序列的实现

```
static void collatz(ref int n)
{    
     if (n % 2 == 0)
     {
          n /= 2;
     }
     else
     {
          n = (3 * n) + 1;
     }
     Console.WriteLine(n);
}

static int GetCycleLength(int n)
{
     if (n > 0)
     {
          int count = 1;
          while (n != 1)
          {
               collatz(ref n);
               count++;
          }
          return count;
     }
     else
     {
          return -1;
     }
} 
```

# 笔记

虽然不是作业，但我想把它当作作业，所以我把它作为标签之一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:18:36.503

您应该使用动态编程。也就是说，如果您为数字 j 工作，并且在为 j 工作时遇到 k。那么你不应该再次为 k 重复整个工作。

所以从j开始，一直到i。假设您正在寻找数字 n 的循环长度。在计算 n 的循环长度时，假设您遇到以下数字：n、n8、n7、n6、...、n1。然后，n 的循环长度为 9，n8 的循环长度为 8，n7 的循环长度为 7。将所有此类数字的循环长度存储在数组或映射中。当您遇到相同的数字以查找任何不同数字的周期长度时，并在任何可能的地方重复使用它们。这将为您提供此问题的最佳解决方案。

[请参阅http://en.wikipedia.org/wiki/Dynamic_programming#Fibonacci_sequence](http://en.wikipedia.org/wiki/Dynamic_programming#Fibonacci_sequence)中的动态编程示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T23:23:52.550

循环长度是算法必须应用于原始自然数/整数才能最终达到 1 的次数。

例如，如果您从 7 开始：

1.  7 是奇数，所以我们使用算法 3(7) + 1 = 22
2.  22 是偶数所以我们使用 22/2 = 11
3.  11 是奇数，所以我们使用算法 3(11) + 1 = 34
4.  34 是偶数所以我们使用算法 34/2 = 17
5.  17 是奇数，所以我们使用算法 3(17) + 1 = 52
6.  52 是偶数所以我们使用算法 52/2 = 26
7.  26 是偶数所以我们使用算法 26/2 = 13
8.  13 是奇数，所以我们使用算法 13(3) + 1 = 40
9.  40 是偶数所以我们使用算法 40/2 = 20
10.  20 是偶数所以我们使用算法 20/2 = 10
11.  10 是偶数所以我们使用算法 10/2 = 5
12.  5 是奇数，所以我们使用算法 5(3) + 1 = 16
13.  16 是偶数所以我们使用算法 16/2 = 8
14.  8 是偶数所以我们使用算法 8/2 = 4
15.  4 是偶数所以我们使用算法 4/2 = 2
16.  2 是偶数所以我们使用算法 2/2 = 1

我们对数字 7 应用了**16**次算法，得到了 1。所以，16 是循环长度。

**代码性能提示**`collatz(ref int n)`-您可以使用按位运算来代替乘法和除法。这将大大提高性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T23:11:17.003

对于特定的起始值 ( `n`)，*循环长度*只是达到 1 所需的数字（包括末尾的 1）。对于`10`：

> 10 5 16 8 4 2 1

所以循环长度为7。

因此，对于这个问题，您必须从 to 循环`i`，`j`确定您迭代的每个整数的循环长度，并返回您遇到的最大循环长度。您可能想要检查另一个答案提到的[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)（即存储先前计算的周期长度，然后在将来的计算中使用这些存储的值）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T00:25:22.757

所提到的文本对周期长度的定义没有歧义；它说：“给定一个输入 n，可以确定打印数字的数量……对于给定的 n，这称为 n 的循环长度”。例如，给定输入 20，参考过程打印出`20 10 5 16 8 4 2 1`，因此“20 的周期长度”为 8。您的程序在某种意义上模拟了*n*值范围的参考过程，找到并打印最大值遇到的周期长度。

请注意，使用动态编程的建议可能会有点误导。您实际可以使用的是*[memoization](http://en.wikipedia.org/wiki/Memoization)*，即记录先前处理的输入的全部或部分结果。记录结果很麻烦，所以如果你的程序足够快而没有记忆，那就不要费心了。问题是假设“没有操作溢出 32 位整数”。如果您不做进一步的假设并记录所有中间结果，您需要一个能够处理数十亿个不同值的字典数据结构。如果您对最大周期长度做出假设，您的程序可能会失败。无论如何，一种方法是选择一些大数 K 并分配一个整数数组 M；将数组初始化为全零，除了`M[1] = 1`. 在您的 Collat​​z 例程中，每次执行第 4 步（*即*n ← 3n+1) 将 1 压入位堆栈。（堆栈中的位数应不小于最大循环长度。）每次执行第 5 步（*即*n ← n/2）时，将 0 推入堆栈。

如果您`M[n] > 0`在任何一步找到，那么您就知道您已经计算出 n 的循环长度为`c = L = M[n]`。此时，您可以展开位堆栈并返回 L。在展开时，在每次弹出后，计算`n`（就像`n = 2*n`弹出 0 或`n = (n-1)/3`弹出 1）、do`++c`和 if `n<K`set `M[n] = c`。

# elasticsearch - 如何减少弹性搜索索引中的段数

> ID：12360634
> 
> 赞同：3
> 
> 时间：2012-09-10T23:05:04.777
> 
> 标签：elasticsearch

我有一个两节点弹性搜索集群，它配置为有 5 个分片和 2 个副本。在我用~2M 记录索引一个 db 表后，在相应的缓存下生成了 124 个段。这个数字太大了，加了更多的索引，恐怕很容易达到 nofiles 的硬性限制。

有没有办法减少每个索引的段数？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T23:29:13.943

您可以控制弹性搜索中的[合并策略](http://www.elasticsearch.org/guide/reference/index-modules/merge.html)。可以使用[Update Index Settings API](http://www.elasticsearch.org/guide/reference/api/admin-indices-update-settings.html)动态更新合并设置。例如，您可以减少`index.merge.policy.segments_per_tier`到 10 以下的某个值，这将减少每层上的段数，从而减少段的总数。

您还可以使用[Optimize API](http://www.elasticsearch.org/guide/reference/api/admin-indices-optimize.html)手动强制合并。例如：

```
$ curl -XPOST 'http://localhost:9200/your-index/_optimize?max_num_segments=1' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-20T12:30:46.107

您可以使用以下命令减少最大段数

```
$ curl -XPOST 'http://localhost:9200/_forcemerge?max_num_segments=5' 
```

在 Windows 的情况下，您需要删除引号。

# javascript - 选择输入时尝试隐藏某些内容

> ID：12360636
> 
> 赞同：0
> 
> 时间：2012-09-10T23:05:18.567
> 
> 标签：javascript, jquery, html

这是我的[小提琴](http://jsfiddle.net/mitchbregs/M2Z88/2/)

一切都写在小提琴中。

问题是什么：当我选择开始在输入中输入内容时，我希望文本消失。

1.  如果我专注于输入，我想要

    消失，只有在我没有输入任何内容时才会重新出现，

2.  如果我在文本输入中输入了某些内容，我希望隐藏保持这种状态。

老实说，我不知道该怎么做，我尝试了一下以表明我的意思

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:11:43.507

用于[`.blur()`](http://api.jquery.com/blur/)检测输入何时失去焦点，然后测试其长度是否为 `0`using [`.val()`](http://api.jquery.com/val/)。如果是，`show`则`p`再次：

```
$(document).ready(function () { 
    $(".type").focus(function() {
        $("p").hide();
    }).blur(function () {
        if ($(this).val().length == 0) {
            $("p").show();
        }
    });
}); 
```

**[演示](http://jsfiddle.net/M2Z88/4/)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:28:00.497

看起来您尝试运行的小提琴中有一些错误..我创建了一个新的小提琴，并且由于某种原因似乎工作正常..

```
​$('.type').on('focus', function(){
    $("p").hide();         
});

$('.type').on('keyup blur', function(){
    if($('.type').val() == ''){
        $("p").show();       
    }
}); 
```

​检查这个[FIDDLE](http://jsfiddle.net/sushanth009/FcDVE/)

使用 keyup 和 blur 事件来获得您想要的功能..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T23:15:24.513

答案就在这个小提琴中：http: [//jsfiddle.net/yLK5c/3/](http://jsfiddle.net/yLK5c/3/)

```
 $(".type").on('focus keyUp',function(){ 
        if ($(this).val() == "") {
        $(this).attr('placeholder',"");
        }            
});
      $(".type").blur(function(){ 
          if ($(this).val() == "") {
             $('p').hide();           
          } else {
          $('p').show(); 
          }             
        $(this).attr('placeholder',"type something");    
        }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T23:15:50.777

我更新了你的小提琴，使用'on'，并使用模糊。

```
$(document).ready(function(){
    $(".type").on('focus', function(){ 
        $("p.explanatory").hide();            
    }).on('blur', function() { 
        if($('.type').val() == '')
        {
            $("p.explanatory").show();      
        }
    });

}); 
```

这是我的工作！ [http://jsfiddle.net/M2Z88/5/](http://jsfiddle.net/M2Z88/5/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-10T23:16:55.483

正如 João 指出的那样，您应该使用该`blur`事件来检测您何时失去焦点。但是，如果文本框中有任何文本，您还希望文本消失。这样做的方法是侦听`keyup`事件，然后检查编辑框中的值。（如果使用`keydown`，则字母不会添加到文本框中，因此您将成为后面的字符。）

我想你想要的是这样的：

```
$(".type").focus(function(){ 
    if( $(this).val() == '' ) $("p").hide();
});
$(".type").blur(function(){
    $("p").show();
});
$(".type").keyup(function(){
    if( $(this).val() == '' ) $("p").hide();
    else $("p").show();
}); 
```

JsFiddle：http: [//jsfiddle.net/Mz95q/](http://jsfiddle.net/Mz95q/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-10T23:27:37.920

这是我的食谱

```
$(document).ready(function(){
    $(".type")
    .focus(function(){
        $("p").hide()
    ;})
    .blur(function () {
      if (!$(this).val()) {
        $("p").show()
      ;}
    });
}); 
```

# debugging - 在 clojure 中调试包装函数

> ID：12360638
> 
> 赞同：2
> 
> 时间：2012-09-10T23:05:37.693
> 
> 标签：debugging, clojure

我有这个烦人的问题：

包装器是接受一个函数的函数，并返回另一个接受参数的函数，对参数执行某些操作并将其粘贴回函数中。

```
（定义包装 [func]
  (fn [参数]
    (func (do-something-to params))))

```

我想做的是跟踪从包装器到包装器的参数更改

例如，我可以定义两个包装器：

```
(defn wrap-inc [func]
  (comp func inc))

(defn wrap-double [func]
  (comp func #(* % 2)))

```

然后，

```
(def h (-> #(* % 3)
       包装公司
       包裹双））

```

相当于：

```
(def h (fn [x] (* (inc (* 2 x)) 3)))
(h 1) => 9

```

现在，我想定义`dbg->`这样

```
(def h-dbg (dbg-> #(* % 3)
                  包装公司
                  包裹双））

```

仍然给我相同的功能等价物，但也要跟踪旧值和新值：

`(h-dbg 1) => 9`

但也会在控制台中显示调试信息：

```
“双包装：（输入：1，输出：2）”
“包装公司：（输入：2，输出 3）”

```

这种模式对于调试像这样的环包装器以弄清楚每个环在做什么非常有用，例如，这个典型的例子：

```
（定义开始 []
  （码头/运行码头
   (-> #'路由处理程序
       ;;(包装重新加载修改 ["clj-src"])
       （包装文件“资源/公共”）
       包装文件信息
       换行十进制大小写参数
       换行关键字参数
       包装嵌套参数
       包装参数
       wrap-ignore-trailing-slash) {:port 8890 :join? 错误的}））

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T13:18:06.967

我相信您正在寻找一种叫做[writer monad](http://richhickey.github.com/clojure-contrib/monads-api.html)的东西。

[这是](http://learnyouahaskell.com/for-a-few-monads-more#writer)对 Writer monad 的一个很好的解释以及它的一些实际操作示例（抱歉，它在 Haskell 中）。

基本上，这个 monad 可以帮助您编写函数，这些函数除了“正常”输出之外还返回一个日志记录值。例如，如果您有以下类型的函数：

```
f :: a -> (b, l)
g :: b -> (c, l) 
```

您可以使用 writer monad 组合它们以获得具有类型的新函数：

```
h :: a -> (c, l) 
```

**警告**：Clojure 宏在组合一元函数`->`时`->>`不能以完全相同的方式使用，因为您需要`bind`用于组合。

作为替代解决方案，您可以使用具有副作用的包装器：

```
(defn wrapper
  [f]
  (fn [& params]
      (print params) ;; or some other logging operation
      (apply f params))) 
```

这是因为函数体中最后一个表达式的值是它的返回值——之前的表达式被求值并且它们的结果被丢弃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T00:05:01.477

一种快速而肮脏的方法是将其填充到宏中……此实现仅执行具有单值参数的函数。

```
（定义换行打印 [f]
  (fn [& 参数]
    (print " ->" (second (re-find #"\$(.*)@" (str f))) args)
    （应用 f args）））

(-> 3 ((wrap-print inc)) ((wrap-print dec)))
;; => "-> inc (3) -> dec (4)"

(defmacro dbg-> [n & funcs]
  (println"")
  （打印 n）
  (让 [wfncs (map #(list (list wrap-print %)) funcs)]
     `(-> ~n ~@wfncs )))

(dbg-> 3 inc dec)
;; =>“3 -> inc (3) -> dec (4)”

```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-11T00:32:50.020

也许[add-watch](http://clojuredocs.org/clojure_core/clojure.core/add-watch)可以帮助你做到这一点。

限制是您只能观看引用（atom/ref/var/agent）。

# ssas - 如何为报告刷新 ssas 多维数据集数据库/表

> ID：12360644
> 
> 赞同：1
> 
> 时间：2012-09-10T23:06:30.360
> 
> 标签：ssas, reporting-services

问题：基于我的 Cube 的 SSRS 报告没有从与 Cube 关联的表中获取最新数据。我如何 a) 告诉报表使用最新的表数据，或 b) 删除任何可能阻止表数据刷新的报表缓存文件？

使用 SQLserver、SSRS、SSAS v2008 R2。我已经使用 sql management studio 中的查询更新了表结构及其数据。在使用我处理和部署的这个数据库/表的多维数据集中（多维数据集 + .dsv），一切看起来都不错。从报告中，我尝试刷新数据源字段，这有效，但数据本身没有刷新，我找不到任何选项来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:38:09.360

您需要处理多维数据集以将刷新的数据放入多维数据集（和您的报告）。这是有关如何执行此操作的[截屏视频。](http://www.youtube.com/watch?v=_RUkhEvTyss)

此外，您可能需要查看[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms175634%28v=sql.105%29)，特别注意可用的不同类型的 OLAP 多维数据集处理，即完整、增量等......因为您可能只想添加新记录，而不是擦除和完全重新填充每个进程的多维数据集数据。

# html - HTML 属性编码/转义与常规 HTML 编码有何不同？

> ID：12360646
> 
> 赞同：2
> 
> 时间：2012-09-10T23:06:37.693
> 
> 标签：html, security, escaping

我注意到 OWASP 建议使用[不同的编码方法](http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/Encoder.html#encodeForHTMLAttribute%28java.lang.String%29)专门用于编码 HTML 属性，并且在 ASP.NET MVC 中有[一个专门用于编码属性的辅助方法](http://msdn.microsoft.com/en-us/library/system.web.mvc.htmlhelper.attributeencode%28v=vs.108%29.aspx)。

但是，我还没有想到 HTML 编码的字符串在 HTML 属性的上下文中不起作用的任何情况。是否存在使用标准 HTML 编码不足或不正确的情况？如果没有，为什么在某些框架中提供了这些额外的方法？

（请注意，[并非所有字符串转义框架都](http://commons.apache.org/lang/api/org/apache/commons/lang3/StringEscapeUtils.html)提供此类方法。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T07:17:50.923

当您深入了解[参考实现](http://owasp-esapi-java.googlecode.com/svn/trunk/src/main/java/org/owasp/esapi/reference/)时，该方法会使用一组不需要编码的免疫字符`encodeForHTMLAttribute`调用[*HTMLEntityCodec*](http://owasp-esapi-java.googlecode.com/svn/trunk/src/main/java/org/owasp/esapi/codecs/HTMLEntityCodec.java)[类](http://owasp-esapi-java.googlecode.com/svn/trunk/src/main/java/org/owasp/esapi/codecs/HTMLEntityCodec.java)`encode`的方法。在从[*Codec*](http://owasp-esapi-java.googlecode.com/svn/trunk/src/main/java/org/owasp/esapi/codecs/Codec.java)[类](http://owasp-esapi-java.googlecode.com/svn/trunk/src/main/java/org/owasp/esapi/codecs/Codec.java)继承的方法内部，您可以看到任何不在*免疫*集中的非字母数字字符都将由字符引用编码。[](http://owasp-esapi-java.googlecode.com/svn/trunk/src/main/java/org/owasp/esapi/codecs/HTMLEntityCodec.java)*`encode`[](http://owasp-esapi-java.googlecode.com/svn/trunk/src/main/java/org/owasp/esapi/codecs/Codec.java)*

 ***现在您已经注意到 HTML 和 HTML 属性的*免疫*集是不同的，特别是在 HTML 属性中，空间不被认为是免疫的：

```
private final static char[]     IMMUNE_HTML = { ',', '.', '-', '_', ' ' };
private final static char[] IMMUNE_HTMLATTR = { ',', '.', '-', '_' }; 
```

其原因可能是因为 HTML 属性不一定需要被引用。当[引号丢失](http://www.w3.org/TR/html5/syntax.html#unquoted)时，文字[空格字符](http://www.w3.org/TR/html5/common-microsyntaxes.html#space-character)将结束属性值。在这种情况下，空格字符需要由字符引用编码，才能被解释为值的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:22:17.860

我想到的一个例子是，如果你在一个属性中引用了文本，你显然必须转义引号，而这对于常规的 html 编码不是必需的（尽管大多数框架都这样做只是为了更加安全）。

一般来说，试图逃避 html 和 css 是非常复杂的。更糟糕的是，浏览器并不完全遵循标准，即使有标准也是如此。通常它们会更加宽松，允许在脚本标签中使用空字符而不是空格等内容，这允许攻击者绕过幼稚的转义方法。当然，每个浏览器的确切行为都不同。**The Tangled Web**一书详细介绍了该领域中一些更有趣的陷阱。***

# solr - Solr ScriptTranformer 向多值字段添加附加值的语法是什么？

> ID：12360648
> 
> 赞同：2
> 
> 时间：2012-09-10T23:07:14.820
> 
> 标签：solr, dataimporthandler

我处于需要编写 Solr DataImportHandler ScriptTransformer 的位置，它将向多值字段添加初始值或附加值。

目前我正在尝试使用该`row.put('fieldname', value)`方法，但似乎最后添加的值是覆盖现有值而不是附加新值。

通过 ScriptTransformer 向多值字段添加新值需要什么方法或语法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:13:45.953

我忽略了 Solr DataImportHandler [ScriptTransformer](http://wiki.apache.org/solr/DataImportHandler#ScriptTransformer)部分的示例。

看起来您需要将多值字段的值视为`java.util.ArrayList`类型的实例。

这是 hte 示例的相关部分，我已经对其进行了测试并且效果很好！

```
var arr = new java.util.ArrayList();
for (var i=0; i<pieces.length; i++) {
  arr.add(pieces[i]);
}
row.put('categorypieces', arr); 
```

# oauth - Twitter API 目前需要或使用哪种身份验证？

> ID：12360653
> 
> 赞同：0
> 
> 时间：2012-09-10T23:07:51.123
> 
> 标签：oauth, twitter

我很难弄清楚 Twitter API 身份验证是如何工作的。我想制作一个在 Mac 上运行的简单 Twitter 实用程序，并且从各种来源听说 Twitter 多次更改了它的身份验证模型。

它仍然是 OAuth 还是 Twitter 再次改变了这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:12:33.797

仍然[是 OAuth 1.0a](https://www.rfc-editor.org/rfc/rfc5849)。要查看更多信息，请查看[https://dev.twitter.com/docs](https://dev.twitter.com/docs)，位于最底部的“身份验证”下。

# python - 在 Django 中启动项目后，我应该将项目文件移动到父目录吗？

> ID：12360654
> 
> 赞同：4
> 
> 时间：2012-09-10T23:08:06.100
> 
> 标签：python, django, django-settings

运行后，`django-admin.py startproject foobar`它会在其中创建一个父`foobar`目录和另一个`foobar`（同名）文件夹以及`manage.py`文件。问题是 - 我应该将所有文件从`/foobar/foobar`移入`/foobar`，然后删除多余的目录吗？这种结构首先存在的原因是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T23:16:41.397

新的[项目布局](http://wayback.archive.org/web/20160124184903/https://docs.djangoproject.com/en/1.4/releases/1.4/#updated-default-project-layout-and-manage-py)用于删除 manage.py 脚本中的 sys.path 黑客行为，并通过导入消除导致执行某些代码（如信号处理程序）多次而不是一次的讨厌错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T23:17:27.573

从[文档](https://docs.djangoproject.com/en/1.4/intro/tutorial01/#creating-a-project)：

```
mysite/
    manage.py
    mysite/
        __init__.py
        settings.py
        urls.py
        wsgi.py 
```

*   外部`mysite/`目录只是您项目的容器。它的名字对 Django 无关紧要。您可以将其重命名为您喜欢的任何名称。
*   `manage.py`：一个命令行实用程序，可让您以各种方式与此 Django 项目进行交互。您可以阅读有关y 和`manage.py`.`django-admin.p``manage.py`
*   内部`mysite/`目录是您项目的实际 Python 包。它的名称是 Python 包名称，您需要使用它来导入其中的任何内容（例如`import mysite.settings`）。

# android - 在 TableLayout 中是否有 EditText 的答案？

> ID：12360665
> 
> 赞同：1
> 
> 时间：2012-09-10T23:09:56.820
> 
> 标签：android

[TableLayout 中的Android EditText 运行了](https://stackoverflow.com/questions/9198726/android-edittext-within-tablelayout-runs-off)注意我发布这个是因为接受的答案在评论中并且涉及切换到LinearLayout。被列为已回答，但我遇到了类似的问题，切断了右边，但没有跑掉。将 TableLayout 宽度设置为 fill_parent 并不能解决此问题。EditText 的右侧在 table_layout 内看起来是截断的。

更新：请注意 EditText 不会跑出边缘。它有 10dip 的保证金，但被砍掉了。我的意思是右边缘在选择时没有突出显示颜色。右上角没有形状。

```
 <?xml version="1.0" encoding="UTF-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
 android:orientation="vertical"
 android:layout_width="fill_parent"
 android:layout_height="fill_parent"
 android:background="@drawable/bluebg"
 android:id="@+id/loading_page_lin_layout"
 >
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:background="@drawable/roundtable"
    android:layout_gravity="center"
    android:gravity="center"
    android:layout_margin="10dip"
    android:padding="10dip"
    android:stretchColumns="*">
    <TableRow>
         <TextView
        android:id="@+id/description"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"

        android:paddingRight="15dip"
        android:text="Name:" />
        <EditText  
        android:id="@+id/txtUserName"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textColor="#85AFBE"                              
        android:hint="Email"
        android:text=""

        android:paddingRight="15dip"
        android:layout_marginRight="10dip"
        android:gravity="left"

        />
     </TableRow>
    <TableRow>
        <EditText  
            android:id="@+id/txtPassword"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:textColor="#85AFBE"                              
            android:text=""
            android:hint="Password"
            android:password="true"
            android:gravity="left"  
            android:layout_gravity="center"                     
            />
    </TableRow>
    <TableRow>
        <!--  <Button
        android:id="@+id/btnSignIn"
        android:text="Sign In" 
        android:layout_width="fill_parent"
        android:paddingTop="10dip"
        android:gravity="center"
        />-->
        <ImageButton 
         android:id="@+id/btnSignIn"
         android:src="@drawable/signbig"    
         android:scaleType="fitCenter"   
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"                
         android:adjustViewBounds="true"
         android:layout_marginLeft="3dip"
         android:background="@null"
         android:layout_marginRight="3dip"
         android:layout_gravity="center"
         />
    </TableRow>
    <TableRow>
        <Button
        android:id="@+id/btnSignUp"
        android:background="@null"
        android:text="Sign Up" 
        android:textStyle=""
        android:layout_width="wrap_content"
        android:paddingTop="10dip"
        android:textSize="20dip"
        android:gravity="center"
        android:onClick="SendToSignUp"
        />                          
    </TableRow> 
    <TableRow>
        <Button
           android:id="@+id/btnFillData"
           android:text="Fill Fake Data" 
           android:background="@null"
           android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           android:paddingTop="10dip"
           android:gravity="center"
           android:onClick="FillFakeData"
           />
       </TableRow> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T13:41:12.843

我有一个类似的问题，发现解决方案只是从 EditText 字段中删除 android:layout_width 属性。请参阅以下提炼布局：

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:stretchColumns="1">
<TableRow>
    <TextView android:text="Username"
        style="@style/DkTextStyle" />
    <EditText android:id="@+id/userText"
        android:layout_width="wrap_content"
        android:inputType="text" />
</TableRow>
</TableLayout> 
```

使用上述布局，如果您在 EditText 字段中输入大量文本，则会导致框超出屏幕右侧出现截断。如果您从 EditText 中完全删除 android:layout_width 属性，它会正常运行——这意味着框将滚动文本并且右边缘仍然可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T19:47:09.193

TableLayouts consist of TableRows, but the columns in a tablerow have the same width of every other tablerow in in the tableLayout. Columns are populated in order, so the first thing you put in a tablerow is in the first column. If you are having trouble with the width of a view in a tablelayout, check the width of other views in other rows in that column.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T00:04:38.437

我会尝试使用`TableLayout`.

```
android:layout_margin="10dip"
android:padding="10dip"
android:stretchColumns="*" 
```

与 HTML 表格不同，TableLayouts 有点挑剔。我怀疑它是在应用填充和边距之前测量孩子。尝试将它们设置为零或 100，看看会发生什么。

此外，如果您设置`match_parent`为`TableLayout` `width`，那么您不需要拉伸列，因为您使用的是单列。我会设置一个或另一个。

希望有帮助

# c++ - 文件名的全局变量

> ID：12360666
> 
> 赞同：0
> 
> 时间：2012-09-10T23:10:16.833
> 
> 标签：c++, global-variables

比如说我在我的程序文件 main.cpp 的 4 个部分中有这行代码

`ifstream fin; fin.open("filename.txt")`

但我不想去更改所有这四个位置的所有这些文件名。

我怎么能为此创建一个全局变量名？它与 filenames.txt 的工作方式不同吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:21:09.227

也许您尝试过这样的全局变量：

```
const std::string filename = "filename.txt"; 
```

然后尝试用以下方式初始化`ifstream`：

```
ifstream fin; fin.open(filename); 
```

它对你不起作用。这可能是因为您没有支持 2011 标准的 C++ 编译器或库。如果你确实有这样的编译器，它会工作得很好。但是，如果不这样做，则需要将 C 样式字符串传递给`ifstream`构造函数。

```
ifstream fin; fin.open(filename.c_str()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:18:54.100

这就是我将如何去做。

传递指定应用程序配置文件路径的命令行参数。当您的应用程序加载时，它会解析此配置文件并保存文件名等项目的所有值。有一个类或全局结构，可以根据请求存储和传递这些值。例如：

```
fin.open(AppConfig.get("filename")); // if the AppConfig is a class.
fin.open(AppConfig["filename"]); // if AppConfig was a map like structure. 
```

这种数据驱动的开发是很好的做法。如果您只使用一个文件，您可能只想在文件开头定义一个常量名称：

```
const char* FILENAME = "my file.txt"; // or
#define FILENAME "my file.txt" 
```

并且每次都使用常量：

```
fin.open(FILENAME); // use this repeatedly 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T23:17:27.603

您可以定义一个全局 const 变量

```
const char* fileName = "filename.txt"; 
```

或者

```
const std::string fileName = "filename.txt"; 
```

全局变量如果不能变异也不错。然后用法：

```
ifstream fin(fileName); 
```

# javascript - 标记不会显示在谷歌地图上

> ID：12360668
> 
> 赞同：0
> 
> 时间：2012-09-10T23:10:21.607
> 
> 标签：javascript, maps

我能够在地图上放置标记，但由于我使用的是 GMap2，我无法再在地图上放置标记。我想使用 GMap2，这样我就可以从地址中提取 lat lng。

```
<script src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=AIzaSyDrwris-0kRdY16oIQoGc_1qsdOgHbJrXo"
  type="text/javascript"></script>

<script type="text/javascript">
    var map = new GMap2(document.getElementById("chart"));
    map.setUIToDefault();

   navigator.geolocation.getCurrentPosition(function(position) {
   var pos = new google.maps.LatLng(position.coords.latitude,
                                         position.coords.longitude);
   map.setCenter(pos, 14);

   //until now it works fine, but when I add a marker it does nothing

 var marker = new GMarker({
    position: new GLatLng(52.15664,5.40567),
    map: map,
    title: 'NAME'
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T13:36:54.897

这里有几个问题。

首先，您包含两个版本的映射 API，其中一个版本由于某种原因已转义参数。这可能是因为它是从其他地方复制的。如果您需要 V2 API，则只需包含该 API。请注意，该 API 将于明年由 Google 停用。

此外，您的标记实例化代码不正确。您应该将 latlng 位置作为第一个参数传递，然后将选项作为对象文字格式的第二个参数传递，例如：

```
var marker = new GMarker(new GLatLng(<coord>, <coord>), { title:"My Title" }); 
```

最后，您不会将标记本身添加到地图中。你使用这个`addOverlay`方法。

这是一个有效的解决方案。按“添加标记”按钮在地图的随机位置添加标记：

```
<html>
<head><title>Map Test</title>
<script src="http://maps.google.com/maps?file=api&v=2&sensor=true" type="text/javascript"></script>

<script type="text/javascript"> 
var map;
function initmap() {
    map = new GMap2(document.getElementById("chart")); 
    map.setUIToDefault(); 

    navigator.geolocation.getCurrentPosition(function(position) { 
        var pos = new google.maps.LatLng(position.coords.latitude, 
                                         position.coords.longitude); 
        map.setCenter(pos, 14); 
    });
}

function AddMarker() {
    var bounds = map.getBounds();
    var southWest = bounds.getSouthWest();
    var northEast = bounds.getNorthEast();
    var lngSpan = northEast.lng() - southWest.lng();
    var latSpan = northEast.lat() - southWest.lat();
    var point = new GLatLng(southWest.lat() + latSpan * Math.random(), 
                            southWest.lng() + lngSpan * Math.random());
    map.addOverlay(new GMarker(point, { title:"My Marker" }));
}

</script>
</head>
<body onload="initmap()">
    <div style="width:300px;height:300px" id="chart"></div>
    <input type="button" onclick="AddMarker();" value="Add Marker"></input>
</body>
</html> 
```

请注意，以上假设地理位置有效。在现实世界的应用程序中，您应该测试错误，如此处的 API 文档所示：

[https://developers.google.com/maps/articles/geolocation](https://developers.google.com/maps/articles/geolocation)

# tfs - linqpad 查询tfs2008…… Codesearching tfs2008 via linqpad 这可能吗？

> ID：12360677
> 
> 赞同：2
> 
> 时间：2012-09-10T23:11:17.227
> 
> 标签：tfs, linqpad

我前段时间安装了 linqpad，最近我看到了一些关于如何使用它来查询 tfs 的文章。基本查询，如签入和结帐以及类似性质的事情。我在运行这些查询方面取得了很大的成功。然后我看到这个网站显示可以使用 linqpad 查询 tfs，基本上让您能够使用 linqpad 进行代码搜索。所以我花了很多时间试图让它发挥作用。

[http://pascallaurin42.blogspot.com/2012/05/tfs-queries-searching-in-all-files-of.html](http://pascallaurin42.blogspot.com/2012/05/tfs-queries-searching-in-all-files-of.html)

我必须说这家伙在利用 linqpad 查询 tfs 方面确实掌握得很好。我遇到的是，当我运行它时，我收到错误消息，指出我的 tfs 版本不允许团队分支......我真的在黑暗中射击，因为我不是 tfs 专家，但是这个如果我能让它为 tfs2008 工作，那就太棒了。无论如何，对此的任何帮助或想法都非常感谢....谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:06:02.247

TFS 2008 服务器不支持 versionControl.QueryRootBranchObjects() 方法，因为 TFS 2008 不理解 TFS 2010 中引入的“一流”分支的概念。但是，您仍然可以通过提供您的自己的分支列表。

例如，如果您将上面示例中的第 11-25 行替换为以下代码，它应该可以工作：

```
var teamBranches = new String[] { "$/project/Main", "$/project/Dev" };

filePatterns.Dump("File patterns");  
textPatterns.Dump("Text patterns");    

foreach (var teamBranch in teamBranches)   
    foreach (var filePattern in filePatterns)    
        foreach (var item in versionControl.GetItems(teamBranch + "/"     + filePattern, RecursionType.Full).Items)     

SearchInFile(item); 
```

显然，您需要将 $/project/main 和 $/project/dev 替换为您想要搜索的分支。

如果您有任何问题，请告诉我。

*编辑*

因为您使用的是 TFS 2008，所以还需要调整其他几行。而不是包括

```
Microsoft.TeamFoundation.Framework.Client 
```

只包括

```
Microsoft.TeamFoundation.Client 
```

而不是这一行：

```
var tfs = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(new Uri("http://localhost:8088/tfs")); 
```

试试这个

```
// Note, 2008 servers don't use "/tfs" and I can't remember if they take a Uri
// or a string.
var tfs = new TeamFoundationServer("http://localhost:8080"); 
```

# c++ - 这些清晰的函数在 C++ 中做同样的事情吗

> ID：12360678
> 
> 赞同：1
> 
> 时间：2012-09-10T23:11:24.643
> 
> 标签：c++, pointers

那么这两个函数在 C++ 中完成同样的事情吗？

```
void MYCLASS::clear() {
classSize = 0;
class_ptr = NULL;
}

void MYCLASS::clear() {
classSize = 0;
*class_ptr = NULL;
} 
```

在`int *class_ptr`我的头文件中声明的位置。当我将鼠标悬停在 Visual Studio 上时，class_ptr 显示为相同类型。

我相信他们都将 class_ptr 指向 NULL。但是，我想确保他们确实都在这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:15:08.657

> 我相信他们都将 class_ptr 指向 NULL。

没有...

```
class_ptr = NULL; 
```

将指针的值设置为`NULL`，即`class_ptr == NULL`。

```
*class_ptr = NULL; 
```

将*引用（指向）的对象设置为**，`class_ptr``NULL`*即`0`。 `class_ptr`本身保有其价值。

指针的值是地址。驻留在该地址的是（应该是）指针本身类型的表示，即

```
int *p = new int(10);
/* ... */
 p  <-- an address, let's say, 0x0000F8BE
*p  <-- an int, 10 
```

请注意，如果不存在从`int`(`NULL`的值为`0`) 到所指的任何类型的隐式转换`class_ptr`，则代码甚至不会编译（这让我相信这个特定的指针命名不当）。

* * *

编辑：我非常喜欢@Mooing Duck 的类比，以至于我偷了它（他没有发布答案，所以我认为他不会介意）。

> 这就像破坏房子的方向和破坏房子之间的区别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T23:14:49.633

不，他们没有做同样的事情。这：

```
class_ptr = NULL; 
```

有效地将指针设置为`NULL`。

另一方面：

```
*class_ptr = NULL; 
```

将指向的地址的内容设置`class_ptr`为`NULL`。在这种情况下，由于`class_ptr`是 类型`int*`，并且`NULL`被定义为整数值`0`，因此您将指针的内容设置为`0`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T23:13:56.020

不，它们是不同的。第一个将指针设置为 NULL。第二个将它指向的内容设置为空

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-10T23:16:13.320

不，这些行不一样。

`class_ptr = NULL;`将指针设置为 0。不修改实际整数（指针指向的位置）。你只是失去了指针。

`*class_ptr = 0;`将取消引用指针并将实际整数的值设置为 0。您将保留指针，并且在此之后它仍然有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-10T23:19:21.307

鉴于这两段代码明显不同，它们做了两件不同的事情。对于明确的功能，第一个似乎最有可能是正确的。鉴于第二个是设置指针指向的值，将其设置为 NULL 是不明确的。虽然它编译（NULL = 0），但它看起来是错误的，所以可能是。

我的猜测是第一个是你想要的。

# java - Java Scanner - 除非存在引号，否则用空格分隔？

> ID：12360694
> 
> 赞同：3
> 
> 时间：2012-09-10T23:13:56.613
> 
> 标签：java, regex, java.util.scanner

我正在尝试使用 Java 中的 Scanner 类从配置文件中获取数据。文件的元素由空格分隔。但是，如果应将短语或元素解释为字符串文字（包括空格），则在元素周围放置双引号或单引号。这给出了如下所示的文件：

```
> R 120 Something AWord

> P 160 SomethingElse "A string literal" 
```

使用 Java Scanner 类时，默认情况下它仅由空格分隔。Scanner 类具有 useDelimiter() 函数，该函数采用正则表达式为文本指定不同的分隔符。但是，我不擅长正则表达式，所以我不确定该怎么做。

除非周围有引号，否则我如何用空格分隔？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T23:20:30.990

您可以使用该[`scanner.findInLine(pattern)`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html#findInLine%28java.lang.String%29)方法来指定要防止字符串文字被拆分。您只需要一个正则表达式来匹配无引号或引号中的令牌。这个可能有效：

```
"[^\"\\s]+|\"(\\\\.|[^\\\\\"])*\"" 
```

（该正则表达式非常复杂，因为它处理字符串文字内的转义。）

例子：

```
String rx = "[^\"\\s]+|\"(\\\\.|[^\\\\\"])*\"";
Scanner scanner = new Scanner("P 160 SomethingElse \"A string literal\" end");
System.out.println(scanner.findInLine(rx)); // => P
System.out.println(scanner.findInLine(rx)); // => 160
System.out.println(scanner.findInLine(rx)); // => SomethingElse
System.out.println(scanner.findInLine(rx)); // => "A string literal"
System.out.println(scanner.findInLine(rx)); // => end 
```

`findInLine`顾名思义，该方法仅适用于当前行。如果要搜索整个输入，则可以[`findWithinHorizon`](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html#findWithinHorizon%28java.lang.String,%20int%29)改用。你可以作为地平线传入`0`，告诉它使用无限的地平线：

```
scanner.findWithinHorizon(rx, 0); 
```

# sublimetext2 - Sublime Text 2：尝试解析设置时出错

> ID：12360696
> 
> 赞同：16
> 
> 时间：2012-09-10T23:14:33.020
> 
> 标签：sublimetext2, sublimetext

如何修复此错误？

> 尝试解析设置时出错：~/Library/Application Support/Sublime Text 2/Packages/User/JavaScript.sublime-settings:1:1 中没有数据

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-10T23:22:23.740

很可能您或其他人在您的用户配置目录中创建了一个空文件。

配置文件必须是有效的 JSON。问题中的文件是空的，不是 JSON。

尝试删除文件或从某处获取固定版本（不确定文件的用途）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-01T17:41:23.990

默认安装 c:/Program Files/Sublime Text 2

更改方式：c:/Program Files/Sublime Text

我不知道为什么，但它有效.. :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-26T08:17:47.237

**崇高文本 3（构建 3059）：**

我的**JSON.sublime-settings**包含一些 XML 结构，没有 JSON。

这是我文件的先前内容：

```
<dict>
    <key>name</key>
    <string>JSON String</string>
    <key>scope</key>
    <string>meta.structure.dictionary.json string.quoted.double.json</string>
    <key>settings</key>
    <dict>
        <key>foreground</key>
        <string>#E6DB74</string>
    </dict>
</dict> 
```

我用[SublimePrettyJson](https://github.com/dzhibas/SublimePrettyJson)的默认内容替换了它：

```
{
    "use_entire_file_if_no_selection" : true,
    "indent" : 2,
    "sort_keys" : false,
    "ensure_ascii" : false
} 
```

这为我解决了这个问题。不再有烦人的错误信息。操作系统：Windows 7。

在我的 Ubuntu 机器上，我从来没有遇到过这个错误，在我的 Mac 上也没有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-07T09:49:48.080

请转到 ../Library/Application Support/Sublime Text 2/Packages/User/ 位置并删除您创建的 JavaScript.sublime-settings:1:1 文件或任何进程必须创建的文件。这肯定会工作.

# facebook-opengraph - 注册 Facebook 成就 - 应用访问令牌问题

> ID：12360702
> 
> 赞同：1
> 
> 时间：2012-09-10T23:15:01.023
> 
> 标签：facebook-opengraph, access-token, facebook-access-token, achievements

我在注册成就时遇到问题：我正在使用图形资源管理器发布此代码：

[APPID]/achievements?access_token=[app access_token]&achievement=[成就链接]&display_order=1

..我不断回复：“消息”：“（＃15）必须使用应用程序访问令牌调用此方法。”

*   我使用的是应用访问令牌，而不是用户 access_token。（通过此链接获得：[https](https://developers.facebook.com/tools/access_token/) ://developers.facebook.com/tools/access_token/ - 但我也使用了 access_token 文档中描述的技术 - 即插入：[https ://graph.facebook.com/oauth/ access_token?client_id=YOUR_APP_ID&client_secret=YOUR_APP_SECRET&grant_type=client_credentials](https://graph.facebook.com/oauth/access_token?client_id=YOUR_APP_ID&client_secret=YOUR_APP_SECRET&grant_type=client_credentials)进入您的浏览器）
*   我已在高级设置中将应用类型设置为“网络”
*   当插入调试器时，我为成就创建的链接作为成就很好。

似乎大多数人在使用错误的 access_token 注册成就时都陷入困境，但我认为这不是我的问题。有人对还有什么可能出错有任何想法吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T14:29:35.523

只需将您生成的应用程序访问令牌粘贴到 Graph API Explorer 顶部的“访问令牌文本字段”中，它就对我有用。希望能帮助到你 ：）

# email - CakePhp 中的 Email->from 不能正常工作。

> ID：12360705
> 
> 赞同：0
> 
> 时间：2012-09-10T23:15:34.170
> 
> 标签：email, cakephp

我用

```
$email->from('contact@domain.com'); 
```

但是我收件箱中的电子邮件是“username@host411.hostmonster.com”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T23:22:24.940

CakePHP 实际上是使用 PHP 的邮件功能。所以你需要在 php.ini 中检查你的邮件设置。

此外，由于有许多反垃圾邮件系统，使用 from() 非常不稳定。我建议您改用 replyTo() 。

有关 CakePHP 邮件功能的更多信息：http: [//book.cakephp.org/1.3/en/view/1284/Class-Attributes-and-Variables](http://book.cakephp.org/1.3/en/view/1284/Class-Attributes-and-Variables)

# jquery - 选择符合条件的“孩子”

> ID：12360710
> 
> 赞同：0
> 
> 时间：2012-09-10T23:16:19.757
> 
> 标签：jquery

我想选择我单击的所有子复选框。例如，在下面的代码段中，我希望它选择第一个“is-wine”而不是第二个。目前，它也没有选择。

关于如何使它工作的任何想法？

谢谢

```
<script>
    $(document).ready(function() {

        $('.click-me').on('click',function(){

            console.log('about to set');
            console.log('here is val: ' + $('.chex input.is-wine').attr('checked'));

            if ( $('.chex input.is-wine').children().is(':checked') ) {
                $('.chex input.is-wine').children().attr('checked',false);
            } else {
                $('.chex input.is-wine').children().attr('checked',status);
            }

            console.log('after setting');
        });

    });
</script>

<body>
    here i am withing sub
    <div id='my-killer-id'>
        <div class='click-me'>click me to start</div>
        <div class='chex'>
            <input type='checkbox' class='is-wine' /><br />
            <input type='checkbox' class='is-coffee' /><br />
        </div>
    </div>
    <div id='other-vals'>
        <div class='chex'>
            <input type='checkbox' class='is-wine' /><br />
            <input type='checkbox' class='is-coffee' /><br />
        </div>
    </div>
</body> 
```

**编辑#1**

所以这是我要选择的更现实的标记

```
<div id='my-killer-id'>
  <div class='click-me'>clicke me to start</div>
  <div class='chex'>
    <!-- would select this -->
    <input type='checkbox' class='is-wine' /><br />
    <input type='checkbox' class='is-coffee' /><br />
    <div class='other-things'>
      <!-- would select this -->
      <input type='checkbox' class='is-wine' />
      <input type='checkbox' class='is-coffee' />
      <div class='even-more-things'>
        <!-- would select this -->
        <input type='checkbox' class='is-wine' />
        <input type='checkbox' class='is-coffee' />
      </div>
    </div>
</div>
</div>
<div id='other-vals'>
  <div class='chex'>
  <!-- would not select this -->
  <input type='checkbox' class='is-wine' /><br />
  <input type='checkbox' class='is-coffee' /><br />
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:21:16.587

尝试以下操作：

```
$('.click-me').on('click',function(){
  var $checkboxes = $(this).parent().find(".chex input.is-wine");
  $checkboxes.prop("checked", !$checkbox.prop("checked"));
});​ 
```

**[演示](http://jsfiddle.net/hzWMQ/)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:30:32.587

您选择项目的方式很奇怪。

```
if ( $('.chex input.is-wine').children().is(':checked') ) {
    $('.chex input.is-wine').children().attr('checked',false);
} else {
    $('.chex input.is-wine').children().attr('checked',status);
} 
```

这..检查所有孩子`input.is-wine`（其中没有），看看他们是否被检查过。`input.is-wine`然后不管这个设置所有 s 的属性。

你想检查每个人`input.is-wine`，然后检查是否是`:checked`。

像这样：

```
$('.chex input.is-wine').each(function() {
    if ($(this).is(":checked")) {
        $(this).removeAttr('checked');
    } else {
        $(this).attr('checked','checked'); // I didn't see a `var status` so I just used 'checked'
    }
}); 
```

[这是一个概念验证 jsFiddle](http://jsfiddle.net/BVb5k/)。（为了便于阅读，我还将您的更改`click-me`为 a`a`而不是 a `div`。此更改不会影响任何功能。）

注意：此外，@JoãoSilva 的回答向您展示了一种在没有 if 语句的情况下执行此操作的好方法：

```
$('.chex input.is-wine').each(function() {
    $(this).prop("checked", !$(this).prop("checked"));
}); 
```

*（如果你用这个，给他一个upvote！）*

*更新*：编辑后，我注意到您想要选择同一节点内的所有内容。为此，您可以使用...

```
$(this).parent().find('.chex input.is-wine').each(function() { 
```

... 或者...

```
$(this).siblings('.chex').find('input.is-wine').each(function() { 
```

这些都将在类的节点中找到与您的对象在同一个 DOM 节点中的所有`input.is-wine`s 。`chex``click-me`

# iframe - JAWS 没有宣布加载的 iFrame 内容？

> ID：12360722
> 
> 赞同：4
> 
> 时间：2012-09-10T23:17:46.473
> 
> 标签：iframe, accessibility, wai-aria, jaws-screen-reader, assistive-technology

我正在开发一个使用 iFrame 的 Web 应用程序（请不要让我使用其他东西，而不是我的决定）。有两个框架，一个导航框架和一个内容框架（自上而下）。

导航框架始终保持不变。当用户单击链接导致内容框架中的内容发生更改时，JAWS 什么也不做。我想让 JAWS 做的是宣布新页面的内容（至少是标题）。

我查看了 WAI-ARIA 标记，并尝试了各种 JavaScript 技巧来命令将焦点集中在元素上。 **唯一有效的**方法是执行以下操作

`<iframe id="contF" aria-atomic="true" aria-live="assertive" frameborder="0" name="content" title="${ca.title}" src="${ca.src}"></iframe>`

这将导致 JAWS 在首次加载框架时宣布框架的内容（因此之前从未单击过该链接）。如果是“访问过的链接”，则根本不会公布框架的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-08-09T11:36:27.137

我知道这是一个非常古老的帖子，但我会为有同样问题的人发布我的解决方案。在将在 iframe 上加载的所有页面中放置一个描述 div：

```
<div id="ac_title" style="display:inline-block;position:absolute;top:0;right:0;height:1px;width:1px">Page ZZZ loaded.</div> 
```

index.html 中的以下代码：

```
window.frames["content"].onload = function() {
    var a = this.contentDocument.getElementById("ac_title");
    if (a) {
        a.setAttribute("role", "alert");
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T14:01:08.370

我知道你要求不要要求改变任何东西，但你为什么要带两个`iframes`呢？我已经很多年没有处理过这个问题了，所以我很模糊。我想说的是，您可以将普通框架链接在一起，但不能将 iframe 链接在一起。

如果您添加`target="content"`到导航框架内的各种链接，它可能会起作用。

由于该属性和 iframe 的性质，原子属性不起作用。atomic 属性监视 DOM 更改并在更改时触发。所以对你的

```
<iframe id="contF" aria-atomic="true" aria-live="assertive" frameborder="0" 
name="content" title="${ca.title}" src="${ca.src}"></iframe> 
```

什么都不做，因为这个 iframe 所在页面的 DOM 没有改变。

# git - 推送到 github 后重命名提交消息

> ID：12360728
> 
> 赞同：4
> 
> 时间：2012-09-10T23:19:01.677
> 
> 标签：git, github

我有两个提交，我刚刚推送到 github

第一个提交消息之后的第二个提交消息实际上有点混乱。

有没有办法在将第二个提交消息推送到 github 后更改它？

我知道 amend 只有在没有被推送到 github 时才会起作用。没有人没有分支出我当前的开发分支，因此可以肯定地假设如果我这样做不会影响任何人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T01:25:17.083

尝试使用 Git 的交互式变基功能。来自 git-rebase(1)：

> -i, --interactive
> 列出即将被重新设置的提交。让用户在变基之前编辑该列表。

如果您运行`git rebase --interactive HEAD~2`，您将能够指示 Git 改写第二个最近的提交消息。Scott Chacon 的*Pro Git*中的第 6.4 章有[很多关于交互式变基的好信息](http://git-scm.com/book/en/Git-Tools-Rewriting-History#Changing-Multiple-Commit-Messages)。

正如霍布​​斯在上面已经评论的那样，您仍然需要强制推动。

# c# - new EventHandler 上的非静态字段、方法或属性错误需要对象引用

> ID：12360730
> 
> 赞同：0
> 
> 时间：2012-09-10T23:19:13.267
> 
> 标签：c#, wpf, events, object-reference

我知道这个主题在 SO 上随处可见，但我找不到任何具体的内容。我有一个类用于存储我为我的应用程序创建的所有窗口。我想要做的是创建一个新窗口，如果不存在，并附加一些事件。问题是事件正在引发错误。

下面的代码片段在类中，当事件发生时，应该创建一个新窗口。下面是两个事件处理程序定义。这些都在同一个班级。

```
Window window = FindWindow(windowId);
if (window == null)
{
    window = new Window();
    window.Closing += new System.ComponentModel.CancelEventHandler(window_Closing);
    window.Closed += new EventHandler(window_Closed);
    _winDict.Add(windowId, window);
}
window.Owner = Application.Current.MainWindow;
window.Title = title;
window.Content = guc;
window.SizeToContent = SizeToContent.WidthAndHeight;
window.ResizeMode = ResizeMode.NoResize;
window.ShowInTaskbar = false; 
```

两个事件处理程序的代码

```
void window_Closing(object sender, System.ComponentModel.CancelEventArgs e)
{
    throw new NotImplementedException();
}

void window_Closed(object sender, EventArgs e)
{
    throw new NotImplementedException();
} 
```

希望这是足够的信息来帮助我调试问题。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:30:37.407

您设置事件处理程序的方法是静态方法吗？如果是这样，它将无法访问实例方法“window_Closing”和“window_Closed”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T02:42:07.007

如果此代码片段出现在静态方法中，则没有“this”指针，您无法访问 window_Closing 和 window_Closed 方法。

尝试将 window_Closed 和 window_Closing 设为静态，以查看它是否可以编译 - 但请注意它们也不会有“this”指针。

可能是“真正的”修复当然是使方法非静态，并在当前静态方法中创建类的实例然后调用该非静态方法。

（注意：未编译并尝试过此代码段）

```
class SomeClass
{
    static void CurrentFunc()
    {
        var someClass = new SomeClass();
        someClass.NewFunc();
    }

    private void NewFunc()
    {
        Window window = FindWindow(windowId);
        if (window == null)
        {
            window = new Window();
            window.Closing += new System.ComponentModel.CancelEventHandler(window_Closing);
            window.Closed += new EventHandler(window_Closed);
            _winDict.Add(windowId, window);
        }
        window.Owner = Application.Current.MainWindow;
        window.Title = title;
        window.Content = guc;
        window.SizeToContent = SizeToContent.WidthAndHeight;
        window.ResizeMode = ResizeMode.NoResize;
        window.ShowInTaskbar = false;
    }

    private void window_Closing(object sender, System.ComponentModel.CancelEventArgs e)
    {
        throw new NotImplementedException();
    }

    private void window_Closed(object sender, EventArgs e)
    {
        throw new NotImplementedException();
    }
} 
```

# python - Python raw_input 如何一次接受多个值

> ID：12360732
> 
> 赞同：0
> 
> 时间：2012-09-10T23:19:21.940
> 
> 标签：python, string, input

我想使用 raw_input 函数来接收多个值。

```
inp = raw_input("--->")

--> 10, Trees, 40, Desks 
```

`inp`现在等于`'10,Trees,40,Desks'`

相反，我想`inp`成为

```
'10','Trees','40', 'Desks' 
```

知道怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T23:20:41.057

使用拆分...

```
 print inp.split(",") 
```

甚至更好

```
>>> inp = raw_input("->")
->10 trees,40 desks
>>> p1 = inp.split(",")
>>> p2 = dict([s.split() for s in p1])
>>> p2
{'10': 'trees', '40': 'desks'}
>>> p2 = dict([reversed(s.split()) for s in p1])
>>> p2
{'trees': '10', 'desks': '40'} 
```

使您可以做的值整数

```
>>> for key in p2:
...     p2[key] = int(p2[key])
...
>>> p2
{'trees': 10, 'desks': 40} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:20:50.177

```
inp = raw_input("--->").split(',') 
```

# cuda - CUDA 素数生成器的性能低下

> ID：12360734
> 
> 赞同：4
> 
> 时间：2012-09-10T23:19:28.977
> 
> 标签：cuda

我正在用 CUDA 编写我的第一个程序。它是一个素数生成器。它可以工作，但只比等效的单线程 C++ 代码快 50%。CPU 版本使用 100% 的一个核心。GPU版本只使用了20%的GPU。CPU是i5（2310）。GPU是GF104。

如何提高该算法的性能？

我的完整程序如下。

```
int* d_C;

using namespace std;

__global__ void primo(int* C, int N, int multi)
{
  int i = blockIdx.x*blockDim.x + threadIdx.x;
  if (i < N) 
  {
    if(i%2==0||i%3==0||i%5==0||i%7==0)
    {
      C[i]=0;           
    }
    else
    {
      C[i]=i+N*multi;
    }
  }
}

int main()
{
  cout<<"Prime numbers \n";
  int N=1000;
  int h_C[1000];
  size_t size=N* sizeof(int);
  cudaMalloc((void**)&d_C, size);

  int threadsPerBlock = 1024;
  int blocksPerGrid = (N + threadsPerBlock - 1) / threadsPerBlock;
  vector<int> lista(100000000);
  int c_z=0;

  for(int i=0;i<100000;i++)
  {
    primo<<<blocksPerGrid, threadsPerBlock>>>(d_C, N,i);    
    cudaMemcpy(h_C, d_C, size, cudaMemcpyDeviceToHost);         
    for(int c=0;c<N;c++)
    {   
      if(h_C[c]!=0)
      {
        lista[c+N*i-c_z]=h_C[c];
      }
      else
      {
        c_z++;
      }
    }   
  }
  lista.resize(lista.size()-c_z+1);
  return(0);
} 
```

我尝试`for`在内核中使用二维数组和循环，但无法获得正确的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:12:52.727

欢迎来到堆栈溢出。

以下是一些潜在的问题：

*   N = 1000 太低。由于您有 1024 `threadsPerBlock`，因此您的内核将只运行一个块，这不足以利用 GPU。尝试 N = 1000000，这样您的内核启动将用于近 1000 个块。

*   您在 GPU 上做的工作很少（每个测试数字 4 次模运算）。因此，在 CPU 上执行这些操作可能比从 GPU 复制它们（通过 PCIe 总线）更快。

为了让使用 GPU 找到素数值得，我认为您需要在 GPU 上实现整个算法，而不仅仅是模数运算。

# xml - 用带有 xslt 的字符串替换字符串

> ID：12360735
> 
> 赞同：3
> 
> 时间：2012-09-10T23:19:42.313
> 
> 标签：xml, xslt, xpath

我想用另一个字符串替换一个字符串。我找到了一个例子，但似乎没有用。这是一个样本数据

```
<Addy>
  <Row>
  <LD>Dwelling, 1</D>
  <LN> East</LN>
  <L>1</L>
  <Tf>Abesinia Passage</Tf>
  </Row>

  <Row>
  <LD>Logde</LD>
  <LN>North </LN>
  <L>1</L>
  <Tf>Abesinia Passage</Tf>
  </Row>
</Addy> 
```

我想以这种方式替换以下字符串。

```
 Dwelling = FLAT
 Lodge    =  SHOP 
```

以下是我使用的代码。它只删除了 LD 元素中的所有值。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
xmlns:lookup="lookup">

<xsl:output omit-xml-declaration="yes" indent="yes"/>
<xsl:strip-space elements="*"/>

<lookup:data>
    <LD code="Dwelling">FLAT</LD>
     <LD code="Lodge">SHOP</LD>

</lookup:data>

<xsl:variable name="lookup" select="document('')/*/lookup:data"/>

<xsl:template match="LD/text()">
    <xsl:value-of select="$lookup/LD[@code = current()]" />
</xsl:template>

<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>
</xsl:stylesheet> 
```

如果应用于上面的输入数据，它会产生：

```
 <Addy>
  <Row>
  <LD></LD>
  <LN> East</LN>
  <L>1</L>
  <Tf>Abesinia Passage</Tf>
  </Row>

  <Row>
  <LD></LD>
  <LN>North </LN>
  <L>1</L>
  <Tf>Abesinia Passage</Tf>
  </Row>
  </Addy> 
```

应产生具有适当代码的预期结果

```
 <Addy>
  <Row>
  <LD>FLAT,1</D>
  <LN> East</LN>
  <L>1</L>
  <Tf>Abesinia Passage</Tf>
  </Row>

  <Row>
  <LD>SHOP</LD>
  <LN>North </LN>
  <L>1</L>
  <Tf>Abesinia Passage</Tf>
  </Row>
  </Addy> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T05:12:04.383

**这是一个 XSLT 转换，用于对字符串执行多次替换——不需要扩展函数**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:my="my:my">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <my:reps>
  <rep>
   <old>Dwelling</old>
   <new>FLAT</new>
  </rep>
  <rep>
   <old>Lodge</old>
   <new>SHOP</new>
  </rep>
 </my:reps>

 <xsl:variable name="vReps" select="document('')/*/my:reps/*"/>

 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="LD/text()" name="replace">
  <xsl:param name="pText" select="."/>

  <xsl:choose>
   <xsl:when test="not($vReps/old[contains($pText, .)])">
    <xsl:value-of select="$pText"/>
   </xsl:when>
   <xsl:otherwise>
       <xsl:call-template name="multiReplace">
        <xsl:with-param name="pText" select="$pText"/>
        <xsl:with-param name="pReps"
         select="$vReps[contains($pText, old)]"/>
       </xsl:call-template>
   </xsl:otherwise>
  </xsl:choose>
 </xsl:template>

 <xsl:template name="multiReplace">
  <xsl:param name="pText"/>
  <xsl:param name="pReps"/>

  <xsl:choose>
      <xsl:when test="$pReps">
       <xsl:variable name="vRepResult">
         <xsl:call-template name="singleReplace">
           <xsl:with-param name="pText" select="$pText"/>
           <xsl:with-param name="pOld" select="$pReps[1]/old"/>
           <xsl:with-param name="pNew" select="$pReps[1]/new"/>
         </xsl:call-template>
       </xsl:variable>

       <xsl:call-template name="multiReplace">
        <xsl:with-param name="pText" select="$vRepResult"/>
        <xsl:with-param name="pReps" select="$pReps[position() >1]"/>
       </xsl:call-template>
      </xsl:when>
      <xsl:otherwise>
       <xsl:value-of select="$pText"/>
      </xsl:otherwise>
  </xsl:choose>
 </xsl:template>

 <xsl:template name="singleReplace">
  <xsl:param name="pText"/>
  <xsl:param name="pOld"/>
  <xsl:param name="pNew"/>

  <xsl:if test="$pText">
   <xsl:choose>
    <xsl:when test="not(contains($pText, $pOld))">
     <xsl:value-of select="$pText"/>
    </xsl:when>
    <xsl:otherwise>
     <xsl:value-of select="substring-before($pText, $pOld)"/>
     <xsl:value-of select="$pNew"/>
     <xsl:call-template name="singleReplace">
       <xsl:with-param name="pText" select="substring-after($pText, $pOld)"/>
       <xsl:with-param name="pOld" select="$pOld"/>
       <xsl:with-param name="pNew" select="$pNew"/>
     </xsl:call-template>
    </xsl:otherwise>
   </xsl:choose>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<Addy>
    <Row>
        <LD>Dwelling, 1</LD>
        <LN> East</LN>
        <L>1</L>
        <Tf>Abesinia Passage</Tf>
    </Row>
    <Row>
        <LD>Lodge</LD>
        <LN>North </LN>
        <L>1</L>
        <Tf>Abesinia Passage</Tf>
    </Row>
</Addy> 
```

**产生了想要的正确结果：**

```
<Addy>
   <Row>
      <LD>FLAT, 1</LD>
      <LN> East</LN>
      <L>1</L>
      <Tf>Abesinia Passage</Tf>
   </Row>
   <Row>
      <LD>SHOP</LD>
      <LN>North </LN>
      <L>1</L>
      <Tf>Abesinia Passage</Tf>
   </Row>
</Addy> 
```

**重要**：

该解决方案是完整且正确的。肖恩的比较肤浅。

**当应用于以下 XML 文档时，比较两种解决方案的结果**：

```
<Addy>
    <Row>
        <LD>Dwelling, Lodge, 1</LD>
        <LN> East</LN>
        <L>1</L>
        <Tf>Abesinia Passage</Tf>
    </Row>
    <Row>
        <LD>Lodge, Dwelling</LD>
        <LN>North </LN>
        <L>1</L>
        <Tf>Abesinia Passage</Tf>
    </Row>
</Addy> 
```

**肖恩的解决方案产生了不正确的替换**：

```
<Addy>
   <Row>
      <LD>FLAT, Lodge, 1</LD>
      <LN> East</LN>
      <L>1</L>
      <Tf>Abesinia Passage</Tf>
   </Row>
   <Row>
      <LD>Lodge, FLAT</LD>
      <LN>North </LN>
      <L>1</L>
      <Tf>Abesinia Passage</Tf>
   </Row>
</Addy> 
```

***此*答案的当前正确解决方案会产生正确的替换：**

```
<Addy>
   <Row>
      <LD>FLAT, SHOP, 1</LD>
      <LN> East</LN>
      <L>1</L>
      <Tf>Abesinia Passage</Tf>
   </Row>
   <Row>
      <LD>SHOP, FLAT</LD>
      <LN>North </LN>
      <L>1</L>
      <Tf>Abesinia Passage</Tf>
   </Row>
</Addy> 
```

**说明**：

1.  **身份规则**“按原样”复制每个被选择执行的匹配节点。

2.  它被一个匹配任何元素的任何文本节点子节点的单个模板覆盖`LD`——必须在其中进行替换的节点。

3.  此模板检查匹配的文本节点是否包含全局内联元素`old`中指定的任何（字符串值） 。`my:reps`为方便起见，所有`my:reps/rep`元素都已在名为的全局变量中选择，`$vReps`并从该变量中引用。如果当前节点中不包含这些字符串，则将其复制到输出。

4.  如果当前匹配的文本节点中至少有一个`$vReps/old`元素的字符串值包含，那么我们必须进行替换。我们调用一个带有名称的模板`"multiReplace"`来执行当前文本节点中的所有替换。我们将当前文本节点和所有`$vReps/rep`元素的节点集作为参数传递给该模板，其子节点的字符串值`old`包含在当前文本节点中——这些都是要进行的替换。

5.  `multiReplace`模板调用名为的模板进行`singleReplace`第一次替换，并将结果捕获到名为 的变量中`$vRepResult`。这包含用 的字符串值替换`$pText` *所有*出现的（的字符串值）`$pReps[1]/old`的结果`$pReps[1]/new`。然后，`multiReplace`模板递归调用自身，并将到目前为止的替换结果作为`$pText`参数传递，以及排除第一个替换的要进行的替换的节点集——作为`$pReps`参数。此递归的“停止条件”是当`$pReps`参数变为空节点集时。

6.  模板按照`singleReplace`它的名称执行 - 它用参数中包含的字符串替换其参数中包含的字符串中与`$pText`参数相等的任何子字符串。替换的数量可能大于一个，但它们都是针对单个替换规范 ==> 因此名称。替换再次以递归方式完成，当非空且仍包含时，停止条件。`$pOld``pNew``singleReplace``$pText``$pOld`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:58:53.847

现有代码的问题在于这一行

```
<xsl:value-of select="$lookup/LD[@code = current()]" /> 
```

仅当存在文本等于上下文节点的*整个文本的 LD 元素时才会发出任何内容。*所以谓词需要使用`contains()`而不是`=`.

使用 XSLT 2.0，您可以按如下方式更改此模板：

```
<xsl:template match="LD/text()">
    <xsl:variable name="LD" select="$lookup/LD[contains(current(), @code)]" />
    <xsl:value-of select="replace(., $LD/@code, $LD/text())" />
</xsl:template> 
```

如果不能使用 XSLT 2.0，可以使用 EXSLT [str:replace()](http://www.exslt.org/str/functions/replace/index.html)代替 XSLT 2.0 的版本。

这假定`code`属性值不包含任何特殊字符，如`.`,`$`等，这些字符将在正则表达式中专门解释。

它还假设在任何 LD/text() 节点中不会出现超过一个代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T02:00:33.267

LarsH 的解决方案是一个很好的解决方案。如果支持，请尝试使用 EXSLT。如果不支持并且您的 XSLT 引擎是 Microsoft，那么这个 XSLT 1.0 样式表...

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
  xmlns:l="http://stackoverflow.com/questions/12360735"
  xmlns:msxsl="urn:schemas-microsoft-com:xslt"
  exclude-result-prefixes="xsl l msxsl" >
<xsl:output omit-xml-declaration="yes" indent="yes"/>
<xsl:strip-space elements="*"/>

<xsl:variable name="lookup">
  <l:map pattern="Dwelling" replacement="FLAT" />
  <l:map pattern="Lodge"    replacement="SHOP" />
</xsl:variable>  

<xsl:template match="LD/text()">
  <xsl:choose>
    <xsl:when test="contains(.,msxsl:node-set($lookup)/l:map/@pattern)">
      <xsl:variable name="hay-stack" select="." />
      <xsl:for-each select="(msxsl:node-set($lookup)/l:map[contains($hay-stack,@pattern)])[1]">
        <xsl:value-of select="concat(
          substring-before($hay-stack,@pattern),
          @replacement,
          substring-after($hay-stack,@pattern))" />
      </xsl:for-each>  
    </xsl:when>
    <xsl:otherwise>
      <xsl:value-of select="." />
    </xsl:otherwise>  
  </xsl:choose>  
</xsl:template>

<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>
</xsl:stylesheet> 
```

...当应用于此输入时...

```
<Addy>
  <Row>
  <LD>Dwelling, 1</LD>
  <LN> East</LN>
  <L>1</L>
  <Tf>Abesinia Passage</Tf>
  </Row>

  <Row>
  <LD>Lodge</LD>
  <LN>North </LN>
  <L>1</L>
  <Tf>Abesinia Passage</Tf>
  </Row>
</Addy> 
```

...产量...

```
<Addy>
  <Row>
    <LD>FLAT, 1</LD>
    <LN> East</LN>
    <L>1</L>
    <Tf>Abesinia Passage</Tf>
  </Row>
  <Row>
    <LD>Lodge</LD>
    <LN>North </LN>
    <L>1</L>
    <Tf>Abesinia Passage</Tf>
  </Row>
</Addy> 
```

* * *

如果不是 Microsoft，并且您不能使用 EXSLT，请使用此样式表...

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
  xmlns:l="http://stackoverflow.com/questions/12360735"
  exclude-result-prefixes="xsl l" >
<xsl:output omit-xml-declaration="yes" indent="yes"/>
<xsl:strip-space elements="*"/>

<xsl:variable name="lookup">
  <l:map pattern="Dwelling" replacement="FLAT" />
  <l:map pattern="Lodge"    replacement="SHOP" />
</xsl:variable>  

<xsl:template match="LD/text()">
  <xsl:choose>
    <xsl:when test="contains(.,document('')/*/xsl:variable[@name="lookup"]/l:map/@pattern)">
      <xsl:variable name="hay-stack" select="." />
      <xsl:for-each select="(document('')/*/xsl:variable[@name="lookup"]/l:map[contains($hay-stack,@pattern)])[1]">
        <xsl:value-of select="concat(
          substring-before($hay-stack,@pattern),
          @replacement,
          substring-after($hay-stack,@pattern))" />
      </xsl:for-each>  
    </xsl:when>
    <xsl:otherwise>
      <xsl:value-of select="." />
    </xsl:otherwise>  
  </xsl:choose>  
</xsl:template>

<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>
</xsl:stylesheet> 
```

# sql - 在 PL/SQL 中使用数组更新多个表

> ID：12360736
> 
> 赞同：1
> 
> 时间：2012-09-10T23:19:49.003
> 
> 标签：sql, arrays, oracle, plsql

如果员工是管道工，我想更新我的员工数据库以将 batch_id 设置为“P-1000”。

我不想创建 5 个单独的（且缓慢的）查询，而是：

1.  设置数组的每个索引都是一个表名
2.  遍历数组
3.  使用字符串索引处的字符串值更新表

我什至找不到任何与我在这里提出的概念类似的东西，这让我认为我完全找错了树。

尽管如此，这是我正在尝试做的伪代码。

```
declare
  type array_type is table of varchar2(100) index by binary_integer;
  dmt_tables array_type; 
begin
--fill dm_employeeTables array
    dm_employeeTables(0) := 'dm_address';
    dm_employeeTables(1) := 'dm_communications';
    dm_employeeTables(2) := 'dm_identifier';
    dm_employeeTables(3) := 'dm_name';
    dm_employeeTables(4) := 'dm_qualifications';

-- loop through tables
for i in dm_employeeTables.FIRST .. dmt_tables.LAST
   loop
    update dm_employeeTables(i) a 
    set employee_batch_id = 'P-1000'
    where a.employee_type = 'PLUMBER';
    i=i+1;
  end loop;

end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:27:16.967

您将需要使用动态 SQL。就像是

```
FOR i IN dm_employeeTables.FIRST .. dmt_tables.LAST
LOOP
  EXECUTE IMMEDIATE 'UPDATE ' || dm_employeeTables(i) ||
                    '   SET employee_batch_id = :1 ' ||
                    ' WHERE employee_type = :2'
    USING 'P-1000', 'PLUMBER';
END LOOP; 
```

现在，从良好的编码角度来看，您可能想要声明一个新的局部变量（即`l_sql_stmt`），用您要执行的 SQL 语句填充该变量，然后传递给`EXECUTE IMMEDIATE`. 这允许您在执行 SQL 语句之前执行诸如记录 SQL 语句（或打印出来）之类的操作。这通常使调试更容易。

# asp.net-mvc-3 - 如何根据当前页面和/或主页向 Orchard CMS 中的布局包装器添加类

> ID：12360739
> 
> 赞同：8
> 
> 时间：2012-09-10T23:20:17.697
> 
> 标签：asp.net-mvc-3, razor, orchardcms

背景：我想避免为我的主页创建备用布局，我想保持“主题机器”区域和布局保持不变，实际上“主题”大部分使用纯 CSS。所以我需要有选择地将 CSS 定位到特定的“页面”，包括，最重要的是，主页。最简单的方法是向包装整个布局的布局包装器“div”添加一个类。我可以通过覆盖 Document.cshtml 文件向“body”元素添加一个类，但我真的认为只在 Layout.chstml 文件中工作并利用 Model.Classes 将所需的 CSS 类添加到“打开”标签。

我目前正在做这样的事情：

```
string area = Model.DesignatedAreaField;
Model.Classes.Add(string.IsNullOrWhiteSpace(area) ? "home" : area);

Model.Id = "layout-wrapper";
var tag = Tag(Model, "div"); // using Tag so the layout div gets the classes, id and other attributes added to the Model 
```

我知道Area不会剪切，因为主页和其他页面都在同一个区域中，而Model.DesignatedAreaField实际上为主页或其他页面返回了一个空字符串。因此，最后，上面的代码将始终生成以下标记（我在主页上显示了 3 个三元组）：

```
<div class="home tripel-123" id="layout-wrapper"> 
```

我希望能够仅在显示主页时添加“主页”CSS 类。一些伪代码如下：

```
string wrapperCss = IsHomepage ? 'home' : Model.GetUrlPathOrSomethingUniqueForThePath();
Model.Classes.Add(wrapperCss); 
```

例如，这将允许我使主要内容缩小并向右浮动，并将三元组放在左侧（主页设计应该是这样的，但我不想编写完全不同的布局如果我可以用简单的、有针对性的 CSS 做同样的事情，那么对于家庭来说）。

**更新：连接伯特兰的答案**

Bertrand 的回答允许我根据 URL 向包装 DIV 添加一个类。他没有提到它（因为 Orchard 是他的第二天性 :-) 但您必须在 Layout.cshtml 文件中添加一个包含并相应地更改“我的”代码：

```
@using Orchard.Utility.Extensions;
{
/* omitted for brevity, everything in between is the same as in the Theme's Machine layout file */

string area = WorkContext.HttpContext.Request.Path.HtmlClassify();
area = string.IsNullOrWhiteSpace(area) ? "home" : area;
Model.Classes.Add("url-" + area); 
```

它导致以下类被添加到封闭的 div 中：

1）当主页显示时：

```
<div class="url-orchard-local- tripel-123" id="layout-wrapper"> 
```

2) 当显示名为 Products 的页面时：

```
<div class="url-orchard-local-products" id="layout-wrapper"> 
```

我的 URL 在我的开发机器上是这样的，在 Visual Studio 的网络服务器中运行：

```
http://localhost:30320/OrchardLocal/ or 
http://localhost:30320/OrchardLocal/Products 
```

我不赌我的生命，但我坚信一旦“OrchardLocal”部分发布到 Azure 服务器，它就会在生产中发生变化……所以我先发制人地将代码更改为：

```
string area = WorkContext.HttpContext.Request.Path.HtmlClassify();
if (area.LastOrDefault() == '-') {
    area = "home";
}
Model.Classes.Add("url-" + area); 
```

当显示“主页”时，这会导致此类：

```
<div class="url-home tripel-123" id="layout-wrapper"> 
```

（实际上，我已经在单行代码之上编写了一些三元与 lambda 运算符混合的代码 :-)

我推断 HtmlClassify 将返回一个以“-”结尾的“类”的唯一时间是它是主页......或者网站的“根”......我很可能是错的！:-)

（无论如何，我对 Orchard 的喜爱超过了我在过去几年中使用的除 nHibernate 之外的任何东西，但是，嘿，Orchard 也使用它！完美！）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T00:06:11.830

这样的事情应该可以解决问题：

```
Model.Classes.Add("url-" + WorkContext.HttpContext.Request.Path.HtmlClassify()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-05T02:00:40.870

这是使用扩展方法执行此操作的一种方法：

```
public static string GetPageCssClass(this WorkContext workContext)
{
    string pageUrl = workContext.HttpContext.Request.Url.ToString();
    string baseUrl = workContext.CurrentSite.BaseUrl; //use BaseUrl to later get app relative page path

    string pageClass = workContext.IsHomePage()
        ? "home"
        : pageUrl.Substring(baseUrl.Length).HtmlClassify();

    return string.Format("{0}-page", pageClass);
}

public static bool IsHomePage(this WorkContext workContext)
{
    string pageUrl = workContext.HttpContext.Request.Url.ToString().TrimEnd('/');
    string baseUrl = workContext.CurrentSite.BaseUrl.TrimEnd('/');

    return pageUrl == baseUrl;
} 
```

请注意，这基于与您在站点设置中设置的 BaseUrl 相关的类名称，因此如果您的 BaseUrl 是为您当前的环境设置的，则应该在本地或生产中工作。

然后，您只需要为扩展方法类的命名空间添加一个 using 语句到您的视图中，然后：

```
Model.Classes.Add(WorkContext.GetPageCssClass()); 
```

此处的另一个选项是为当前处于活动状态的每个图层添加一个 css 类，以下扩展方法将向您的页面添加 {xxx}-layer css 类的列表。这是另一个相关问题：[Orchard CMS: Conditional CSS Class based on Layer](https://stackoverflow.com/questions/20571844/orchard-cms-conditional-css-class-based-on-layer)

# jakarta-ee - EJB 并行处理的工作管理器

> ID：12360740
> 
> 赞同：3
> 
> 时间：2012-09-10T23:20:18.657
> 
> 标签：jakarta-ee, parallel-processing, ejb, weblogic, workmanagers

我需要并行化几个不同 EJB 的异步调用，在每个 EJB 中我都需要调用一个事务方法。我使用 WebLogic 的集群安装作为我的部署环境，理想情况下，我希望在集群的不同节点中的不同线程之间分配工作负载。

在找到有关该主题的[先前](https://stackoverflow.com/questions/2005934/how-can-an-ejb-parallelize-a-long-cpu-intensive-process) [帖子](https://stackoverflow.com/questions/533783/why-spawning-threads-in-java-ee-container-is-discouraged?lq=1)后，我想使用 Work Managers 可能是我的环境的可行替代方案，但在阅读[文档](http://docs.oracle.com/cd/E15523_01/web.1111/e13733/toc.htm#i1058123)后，我留下了几个问题，如果有人有更多使用 Work 的经验，我将非常感激经理们可以对这些有所了解：

1.  是否可以`Work`在 EJB 中实现接口，这样当`run()`方法被调用时，它可以调用该 EJB 的事务方法之一？我对异步和并发调用多个 EJB 感兴趣，每个 EJB 代表一个不同的工作单元，但我不知道工作管理器是否会将所需的执行上下文传播到我的 EJB。
2.  如果我配置一个全局工作管理器，当我使用它时，它是否会自动在集群中的所有节点之间分配工作负载？还是发送给它的所有作品都将在同一个集群节点中执行，尽管在不同的线程中？- 如果是这种情况，我如何并行化我的工作负载，以使集群中的所有节点都能分担工作？

此外，如果有人可以提出不同的替代方案（而不是使用工作管理器），那就太好了，只要满足本问题第一段中的要求。

# vim - vim 启动 tpl

> ID：12360750
> 
> 赞同：0
> 
> 时间：2012-09-10T23:21:21.847
> 
> 标签：vim, sparkup

我将 Vim 与 Sparkup 一起使用，我有两个问题：

1.  Sparkup 仅适用于以 HTML 扩展名结尾的文件，但是，我想将它与 TPL、XML 或基本上任何基于超文本标记的文件一起使用。那可能吗？
2.  与它所基于的 zen-coding 插件不同，我似乎无法获得 zen-coding CSS 输出。我以为我在启动文件中看到了它的缺失。有谁知道如何激活它或轻松添加它？

（我使用的是 Ubuntu 12.04、7.3。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:54:13.060

`sparkup`是一个文件类型插件。这取决于当前文件的文件类型。
编辑 xml 文件时，`:set ft=html`手动更改文件类型。
然后就可以使用`sparkup`插件了。

* * *

如果您希望 vim 自动执行此操作，请将此命令放入您的`.vimrc`：

```
au BufNewFile,BufRead *.xml,*.tpl set ft=html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T05:39:25.747

Sparkup 只处理 HTML。添加 CSS 意味着重写它。如果你想要 Zencoding 为什么不使用 Zencoding？

我也不记得 Zencoding 做“css 输出”，不管那是什么意思。你能举个例子吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-26T11:26:43.547

为了您的记录，更好的方法是进入 sparkup 扩展的 ftplugin 目录，创建一个指向名为“xml”的文件夹 html 的软链接。这确保您仍然可以选择以不同方式自定义 xml 和 html。

# drools - Drools 规划器：将 SimpleScore 更改为 HardAndSoftScore

> ID：12360751
> 
> 赞同：1
> 
> 时间：2012-09-10T23:21:44.453
> 
> 标签：drools, n-queens, drools-planner, optaplanner

我正在玩弄流口水计划器，因为最终我需要制定一个排班解决方案。我从[Drools Planner 用户指南](http://docs.jboss.org/drools/release/5.4.0.Final/drools-planner-docs/html_single/index.html)开始，我成功地在 Eclipse 中运行了示例。

为了理解 simple 和 HardAndSoft 分数类型之间的区别，我尝试修改 NQueens 示例，将分数从 Simple 更改为 HardAndSoft。

我做了如下：

1.  在我设置的 nqueensSolverConfig.xml 中`<scoreDefinitionType>HARD_AND_SOFT</scoreDefinitionType>`。

2.  在 NQueens.java 中：

    *   我设置`public class NQueens extends AbstractPersistable implements Solution<HardAndSoftScore> {...}`

    *   我将 SimpleScore 相关的属性和方法更改为对应的 HardAndSoftScore 成员：

    私有 HardAndSoftScore hsScore；

    public HardAndSoftScore getScore() { return hsScore; }

    public void setScore(HardAndSoftScore score) { this.hsScore = score; }

但是当我运行解决方案时，我收到以下消息：

```
"The scoreString (0) doesn't follow the 999hard/999soft pattern." 
```

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T07:21:14.860

你的求解器配置中仍然会有这个：

```
<termination>
  <scoreAttained>0</scoreAttained>
</termination> 
```

在求解器配置中写入的任何分数都必须采用分数定义的格式，因此如下所示：

```
<termination>
  <scoreAttained>0hard/0soft</scoreAttained>
</termination> 
```

注意：您可能会通过查看“真实”示例之一（例如课程安排或护士排班）而不是 N Queens。

# javascript - django 模板在 AJAX 发布后没有重新加载

> ID：12360753
> 
> 赞同：1
> 
> 时间：2012-09-10T23:21:45.373
> 
> 标签：javascript, python, ajax, django

我正在制作我的第一个 Django 应用程序并且遇到了一些 AJAX 问题。在我的网站上，用户可以看到照片库。要访问此页面，他们只需要转到 /photos。照片视图计算要显示的照片并将它们传递给模板进行渲染。

他们可以通过单击按钮请求查看更多照片。单击此按钮会向服务器发送 AJAX 请求。服务器计算要显示的一组新照片，然后再次将照片传递给相同的模板进行显示。唯一的问题是屏幕上的照片永远不会改变。

我验证了服务器正在计算新照片。不幸的是，很多应该发生的事情实际上并没有发生。首先，使用 Chrome 开发人员工具，我可以看到照片文件从未从服务器发送到浏览器。此外，DOM 永远不会更新 src 属性来引用新照片。我需要做什么才能让这些事情发生？

谢谢你。

编辑：

一些代码：

```
#The python view summarized
def photos:
    photoList = GetListOfPhotos() #Returns photo objects.  These objects have a file field which is access from the template.
        return render(request,
              'photos.html', 
             {'photoList': photoList}, 
              context_instance=RequestContext(request)
             )

#AJAX request
$(document).ready(function(){
    $("#right-arrow").click(function(event) {
        $.post("/photos/", {"arrow" : "right"
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T00:04:53.537

对我来说最可疑的是你说

> 再次将照片传递到相同的模板进行显示。

`/photo`这是您的网址对应的完全相同的模板吗？如果是这样，您可能应该使用它的一小部分来渲染列表或表格中的照片（或者无论您如何显示它们）除此之外，还有一些事情可以帮助解决这个问题。

1.  在 chrome 开发人员工具中，确保您的 javascript 正在发送正确的数据。这可以通过在 net 选项卡中验证您的参数以及自由使用控制台日志来完成；

2.  验证您的视图是否确实在做它应该做的事情。我喜欢pdb。这是完美的。您可以编写测试，或制作打印语句或 w/e。

3.  验证您的前端是否正在接收数据。Chrome 工具可以帮助您做到这一点。网络选项卡将让您看到响应。

我想更具体，但你没有提供具体细节。

为了提供更好的答案，发布所有相关代码很重要。

# iphone - 在哪里可以找到 iOS 平台功能的列表？

> ID：12360757
> 
> 赞同：-2
> 
> 时间：2012-09-10T23:22:12.697
> 
> 标签：iphone, ios, ipad, platform, capability

我正在制作一个应用程序，告诉用户他们正在使用什么样的 iOS 设备，然后告诉他们设备的功能。下面是一些示例代码：

```
case UIDevice1GiPhone: return UIDeviceBuiltInSpeaker | UIDeviceBuiltInCamera | UIDeviceBuiltInMicrophone | UIDeviceSupportsExternalMicrophone | UIDeviceSupportsTelephony | UIDeviceSupportsVibration;
case UIDevice3GiPhone: return UIDeviceSupportsGPS | UIDeviceBuiltInSpeaker | UIDeviceBuiltInCamera | UIDeviceBuiltInMicrophone | UIDeviceSupportsExternalMicrophone | UIDeviceSupportsTelephony | UIDeviceSupportsVibration;
case UIDeviceUnknowniPhone: return UIDeviceBuiltInSpeaker | UIDeviceBuiltInCamera | UIDeviceBuiltInMicrophone | UIDeviceSupportsExternalMicrophone | UIDeviceSupportsTelephony | UIDeviceSupportsVibration;           
case UIDevice1GiPod: return 0;
case UIDevice2GiPod: return UIDeviceBuiltInSpeaker | UIDeviceBuiltInMicrophone | UIDeviceSupportsExternalMicrophone;
case UIDeviceUnknowniPod: return 0;
case UIDevice3GSiPhone: return UIDeviceSupportsGPS | UIDeviceBuiltInSpeaker | UIDeviceBuiltInCamera | UIDeviceBuiltInMicrophone | UIDeviceSupportsExternalMicrophone | UIDeviceSupportsTelephony | UIDeviceSupportsVibration; 
```

这正是我正在寻找的东西。第一行表示第一代 iPhone 有一个内置扬声器、一个内置摄像头、它支持外接麦克风等。有人知道我在哪里可以获得所有设备的完整列表吗？我的清单不见了：iPhone 4、iPhone 4s、第 3 代 iPod、第 4 代 iPod 和所有代的 iPad。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T00:49:51.253

如果您正在寻找功能列表，您可能需要查看 Wikipedia 以了解[iPhone 型号比较](http://en.wikipedia.org/wiki/Iphone#Model_comparison)、[iPod touch 型号](http://en.wikipedia.org/wiki/Ipod_touch#Models)和[iPad 技术规格](http://en.wikipedia.org/wiki/Ipad#Technical_specifications)。

您还可以在 Google 上搜索您要查找的特定设备以及“规格”一词（例如“iPod touch 第 3 代规格”），您通常会获得大量点击，通常包括 Apple 自己网站上的页面（例如，请参阅[3g 触摸规格在这里](http://support.apple.com/kb/SP570)）。

# asp.net - 从 asp.net 代码后面的方法设置 mailto 的正文

> ID：12360767
> 
> 赞同：0
> 
> 时间：2012-09-10T23:23:45.773
> 
> 标签：asp.net, mailto

我有一个 ASP.NET 按钮。如果用户单击此按钮，则会调用`mailto`，这将打开 Outlook 邮件窗口。我通过在 ASP.net 按钮控件标记中添加以下行来完成此操作。

`window.open('mailto: abc def<abc.def@ex.com>?subject= exSub &body= exBody');`

现在我想在我的代码隐藏方法中动态设置正文文本（在上面的示例中为 exBody）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T23:29:56.733

`Click`您可以通过以下方式在代码隐藏事件中注册脚本：

```
 string mailBody = getMailBody(); //// Get the content for email body
 ClientScript.RegisterStartupScript(this.GetType(), "mailto",
        "window.open('mailto: abc def<abc.def@ex.com>?subject= exSub &body= "+ mailBody +"');", true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:28:48.077

将其绑定到页面属性，并使用该属性构造*mailto*属性（[URL-encoded](https://www.rfc-editor.org/rfc/rfc2368)）：

```
<asp:Button RunAt = "Server"
    onclick = <%# 
        "window.open('mailto: abc def<abc.def@ex.com>?subject= exSub &body="
        + Server.UrlEncode(MailToBody ?? "") + "');"
    %>
/> 
```

然后`MailToBody`根据需要从您的代码隐藏中设置属性。

# inno-setup - 如何在 Inno Setup 上使用 botva2.dll？

> ID：12360773
> 
> 赞同：0
> 
> 时间：2012-09-10T23:25:20.883
> 
> 标签：inno-setup

如何通过 glass image.png 更改 Inno Setup 上的 InnerNotebook？我知道我必须使用 dll botva2，但我不知道代码。

这是我的安装程序： [![](../Images/01240cc85bb2e2bba5af71f0dab74139.png)](https://i.stack.imgur.com/90g1d.jpg)

但我想把这个效果放在所有页面上： [![](../Images/e5e4c878a00ca2428657cf3a87852e06.png)](https://i.stack.imgur.com/U5bKB.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T05:03:36.703

您需要添加2张图片：

1.  背景

2.  背景上方的透明图片 (.png)。

所有组件必须是透明的（标签或 TNewStatictexts 支持这一点）

如何使用 botva2.dll 并调用它的功能如下所示。

a) 声明插件导出：

> ```
> procedure GdiPlusShutdown; external 'gdipShutdown@{tmp}\botva2.dll stdcall delayload'; 
> ```

b) 将 botva2.dll 添加到您的安装程序中：

> ```
> [Files]
> Source: botva2.dll;       Flags: dontcopy; 
> ```

c) 将 .dll 提取到 Temp 目录中（最好是在一些初始化函数中执行此操作，如 InitializeWizard()；

> ExtractTemporaryFile('botva2.dll');

d) 调用你的函数：

> ```
> procedure MyFunc();
> begin
> // Unload ComCtrls functions
>   GdiPlusShutdown; // Function from botva2.dll
> end; 
> ```

如果您需要这样的完整解决方案：![图形安装程序](../Images/d48d97f765d517b0a6eb6feb0c018997.png)

我可以向您推荐我的 Inno Setup 扩展，名为 Graphical Installer: [Graphical Installer website](http://graphical-installer.com/)。

# git - 克隆了一个 github 仓库，创建了一个新分支 -> 我可以推送吗？

> ID：12360774
> 
> 赞同：1
> 
> 时间：2012-09-10T23:25:24.743
> 
> 标签：git, github

所以我在本地克隆了一个github上的repo。我还没有对该回购的任何权利。然后我在本地创建了一个新分支。

我想将我的新分支推送到 github，我现在也应该被列为合作者。

我可以这样做吗？我该怎么做？我习惯于命令行 git，这个项目在 eclipse（android 项目）中运行。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:34:17.360

不是好主意，真的。

通常的工作流程如下所示

1.  您应该`fork`在 github 网络界面中回购您的帐户。
2.  `clone`你叉到本地机器。
3.  创造新`branch`的（通过您想要实现的功能或您想要做的修复来调用它）。
4.  更改代码，`commit`它和`push`新分支到您的 fork。
5.  创建`pull request`到原始仓库。

像这样的东西。

编辑：@zerkms 在第一条评论中的链接非常有用。我认为阅读它们会比我的答案提供更多信息。

# c# - 水晶报表如何对齐logo？

> ID：12360778
> 
> 赞同：0
> 
> 时间：2012-09-10T23:25:59.820
> 
> 标签：c#, .net, winforms, crystal-reports

我想在水晶报表中居中对齐徽标。但不知道该怎么做。我尝试使用 Visual Studio 的对齐选项，但如果选择了任何两个对象，它们就会对齐，并且它们会在它们之间设置对齐。

请指导我如何在水晶报告中对齐徽标。我在 Visual Studio 2010 中使用带有 C# 和 Winform 的 Crystal 报表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T10:52:26.967

在设计视图中，您可以在报表顶部看到标尺。计算尺子的长度，将其除以 2，然后将该点与徽标的中点匹配。

或

单击标尺并创建搜索栏箭头。通过将图像移动到箭头来匹配徽标的中点。现在将箭头拖动到标尺的中点，您可以看到您的徽标沿着箭头移动。见下图。

![图像或徽标对齐](../Images/4379236177d29e01a48588eba85bff10.png)

# objective-c - 什么是（null）的充分测试？

> ID：12360786
> 
> 赞同：3
> 
> 时间：2012-09-10T23:27:57.313
> 
> 标签：objective-c, cocoa-touch, uipickerview

在我的代码中，我使用这个测试来检查用户是否在pickerView中选择了一些东西：

```
if ( !selection || [selection isEqualToString:@"Select..."] ) {} 
```

但是，Stack Overflow 上的许多帖子都建议使用`NSNull`以下示例或类似以下示例的测试：

```
if ( selection.length == 0 || [selection isEqualToString:@"(null)"] ) {} 
```

上面的代码行还有许多变体，所有测试我只是使用的 null ：`!selection`

我的测试是否不完整并且容易出现错误？`!selection`和这些其他测试有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:20:26.223

```
selection.length == 0 
```

如果您想将零长度字符串和 nil 视为同一事物，这是很好的，这通常是这种情况。因为向 nil 对象发送消息是安全的，并且结果将为 nil、0 或 0.0，所以您可以安全地执行此操作。

您只需要使用 isEqualToString: 就可以将其他可能的字符串视为与 nil 等效的字符串，例如 @"(null)"，我看到在某种对象图中转换文本数据时会发生这种情况，我有时在 JSON 中看到这一点，其中生成 JSON 的代码无法正确处理 null。

NSNull 是一个对象，如果你可以得到一个 NSNull 的实例来代替 nil，你可能也必须对此进行测试，很多 JSON 解析器都会发生这种情况。它也是一种将 nil 存储在集合对象（NSArray 和 NSDictionarys）中的方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:47:30.747

我能预见的唯一错误是本地化错误。如果您在某处使用 设置选择器数据，却忘记根据当前本地化`NSLocalizedString()`正确检查，该怎么办？`@"Select..."`那会很烦人，尤其是如果您的测试人员没有彻底测试所有本地化...

但是，`!selection`两者`selection.length == 0`都应该没问题，即使选择是`nil`，并且`nil.length`没有意义......所以，我会说：

```
if ( !selection || [selection isEqualToString:@"(null)"] ) {} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T23:48:01.873

首先你需要了解 nil、NSNull 和 NULL 的区别。

`nil`- (id)0，表示`id`未初始化的对象，但由于逻辑原因，它不能在某些模式中使用，例如不能向数组添加 nil 值。

`NSNull`- 用于初始化`nil`表示的单例类 - 您可以将其添加到数组中。

`NULL`- (void*)0, 表示任何未初始化的对象，它必须存在以提供向后`C`支持

对于初始化检查，我通常使用宏`(obj != nil) && (obj != (id)[NSNull null])`

对于空字符串检查，您可以使用

```
((obj != nil) && (obj != (id)[NSNull null]) && obj.length > 0 && [obj containsOnlyWhitespaceOrNewline] == NO) 
```

# django - 使用 nginx proxy_pass 和重写的多个 django 应用程序

> ID：12360791
> 
> 赞同：5
> 
> 时间：2012-09-10T23:28:09.077
> 
> 标签：django, url-rewriting, nginx, django-admin

我有一个名为 django-admin 的应用程序`myapp`，我想在不同的物理盒子上部署多个实例，每个客户一个。但是，我希望它们都可以从类似的域访问，`mydomain.com/customer1/myapp`.

我已经摆弄了特定的代理设置，并尝试了 SO 上建议的多种方法，但没有一种完全适合我的用例……而且由于我对两者知之甚少`nginx`，`django`我不知所措！

我当前的 nginx.conf 是：

```
server {
    listen 80;
    server_name myserver.com

    location ^~ /static {
        alias /path/to/static/files/;
    }
#    location / {
#        proxy_pass http://127.0.0.1:8001;
#    }
    location ^~ /customer1/myapp/static {
        alias /path/to/static/files/;
    }
    location /customer1/myapp {
        rewrite ^/customer1/myapp/(/?)(.*) /$2 break;
        proxy_pass http://127.0.0.1:8001;
    }
} 
```

我可以通过`myserver.com/customer1/myapp/admin`. 但是，当我尝试登录时，nginx 会将我的 url 重写`myserver.com/admin`为不是有效的 url。如何防止 nginx 实际重写 url 而只更改传递给的 url `127.0.0.1:8001`？

FWIW，我正在使用 gunicorn 服务`gunicorn -b 127.0.0.1:8001 -n myapp`。如果我取消注释该`/`位置并删除最后两个位置块，则该应用程序运行良好。

如果有替代方案，我远未确定这种方法。目标是避免为每个部署修改 django 代码，而只需将最少的代码添加到 nginx.conf 以进行新部署。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-11T10:42:28.463

基本上，您将 url 指定为 proxy_pass 指令的一部分，以下 location 指令应该这样做：

```
location ~ ^/customer1/myapp(/?)(.*) {
    proxy_pass http://127.0.0.1:8001/$2;
} 
```

有关 nginx 如何传递 uri 的详细说明，请参见[http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass](http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-21T18:46:41.540

您应该使用以下内容：

```
location /customer1/myapp {
    return 302 $uri/;
}
location /customer1/myapp/ {
    proxy_pass http://127.0.0.1:8001/
} 
```

Note that this is superior to using variables within `proxy_pass`, because if you do use variables, then [`proxy_redirect`](http://nginx.org/r/proxy_redirect) can no longer be of the default value `default`, and will be `off` instead, and then internal `302` redirects within your app will not be mapped to `/customer1/myapp/` after being fetched by nginx, which will likely cause you troubles and more 404s.

And, yes, using individual domains for individual customers is a better idea, because it's more secure (as far as cookie handling is concerned, for example).

# php - javascript中的表达式引擎字段

> ID：12360793
> 
> 赞同：1
> 
> 时间：2012-09-10T23:28:34.397
> 
> 标签：php, javascript, expressionengine

我正在尝试在 javascript 变量 (foo) 中获取自定义通道字段 (chan_body) 的内容。我已经在我的 config.php 文件中设置了
**$config['protect_javascript'] = "n";** 我有我的 chan_body **'Type' => 'TextArea'**和**'Default Text Formatting => 'None'**问题是这个通道字段实际上是几行长，实际上是另一种语言的代码（这并不意味着要执行)，但它并没有被转义，只是被扔在那里搞砸了 javascript。我怎样才能解决这个问题？我尝试了没有帮助的 escape()

```
{exp:channel:entries channel="mychannel" category="2"} 
    <script type="text/javascript">
        var foo = "{chan_body}";
        alert(foo);
    </script>    
{/exp:channel:entries} 
```

翻译成

```
<script type="text/javascript">
    var foo = "my $testing = "myfile.txt";
    Uncaught SyntaxError: Unexpected identifier
    open(FILE,"$myfile ") or die;
    # this is a comment
    alert(foo);
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T12:55:02.110

分配给 foo 时，您可以使用 base64 编码对 chain_body 中的值进行编码，并且您可以在需要使用它的地方对其进行解码。

例如

```
var foo = BASE64_ENCODE("{chan_body}"); 
```

你可以在这里看到 base64 的东西在 javascript 中是如何工作的。 [如何在 JavaScript 中将字符串编码为 Base64？](https://stackoverflow.com/questions/246801/how-can-you-encode-to-base64-using-javascript)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:53:26.150

JavaScript 不太适合多行字符串。请参阅[如何创建多行字符串](https://stackoverflow.com/questions/805107/how-to-create-multiline-strings)。要将其直接注入到所写的变量中，您需要`\`在新行的末尾使用反斜杠，并且还要转义任何双引号。

但谁愿意这样做？

一种迂回的方法可能是将字段的内容放在`div`with中`display:none`并以这种方式访问​​它。

```
{exp:channel:entries channel="mychannel" category="2"} 
  <div id="entry-{entry_id}" style="display:none;">{chan_body}</div>

  <script>
    var foo = document.getElementById('entry-{entry_id}').innerHTML;
    alert(foo);
  </script>    
{/exp:channel:entries} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T23:33:33.477

$testing 后缺少报价

```
var foo = "my $testing" = "myfile.txt"; 
```

# jquery - 帮助 jquery .children

> ID：12360806
> 
> 赞同：0
> 
> 时间：2012-09-10T23:30:26.657
> 
> 标签：jquery

我创建了一些按钮翻转和“优雅降级”的缘故，并且为了不为每个图像翻转等编写代码，我**试图**编写更好更有效的代码。也就是说，我想要做的是，通过几行代码，我的翻转变得更加智能，它们在屏幕上显示的内容。

我试图实现的一件事是，在翻转时，出现在图像 div 中心的文本（通过 css 绝对位置）与图像的**alt**属性/元素中的文本相同。

这是带有缩略图的 reg div：

```
 <div class="imgW"><img src="img src here"/></div> 
```

现在对于翻转，我通过 jquery 添加它：

```
$('.imgW').prepend('<div class="portSecRollOver">lopan</div>'); 
```

所以在页面渲染上，它**应该**是这样输出的：

```
<div class="imgW">
  <div class="portSecRollOver">lopan</div>
  <img src="img src here"/>
</div> 
```

在页面加载时，portSecRollOver 通过 css 隐藏。`(display:none);`

在翻转时，portSecRollOver 通过 jquery 显示：

```
$('.imgW').mouseover(function(){

        $(this).children('.portSecRollOver').css("display","block");
    }); 
```

ETC...

现在在上面的同一个翻转功能块上，我想做的是在翻转时，出现在 portSecRollOver div 内的文本是该 div 图像 alt 标记的值。

我怎样才能做到这一点？

我尝试了很多方法，但最终都一无所获。当我对它进行 console.log 测试时，我总是得到一个“未定义”，这导致我假设我没有针对正确的 dom 对象。

有任何想法吗？我尝试了很多方法，但是，这是为了让您了解我尝试过的内容......类似

```
$(this).children('.portSecRollOver').html($(this).children('a img').attr('alt')); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:34:07.730

你应该使用`.children('img')`而不是`.children('a img')`因为你只有一个`img`孩子，而不是一个锚`a`后跟一个`img`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:36:18.327

试试这个：新： http: [//jsfiddle.net/vSFTU/1/](http://jsfiddle.net/vSFTU/1/)旧：http: [//jsfiddle.net/sKQpd/](http://jsfiddle.net/sKQpd/)

我意识到你希望`alt`src 出现在`portSecRollOver`下面应该这样做：http: [//jsfiddle.net/vSFTU/1/](http://jsfiddle.net/vSFTU/1/)

希望能满足你的需要`:)`

**代码**

```
$('.imgW').on('mouseover', function() {
    $(this).children('.portSecRollOver').html($(this).find('img').prop('alt'));
    $(this).children('.portSecRollOver').show();

});

$('.imgW').on('mouseout', function() {

    $(this).children('.portSecRollOver').hide();

});
​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T23:48:10.603

`<a>`看起来您走在正确的轨道上，但正如 João 指出的那样，您的代码中没有标签。这是您需要的：

```
$('.imgW').mouseover(function() {
    var portSecRollOver = $(this).children('.portSecRollOver');
    var img = $(this).children('img');
    portSecRollOver.html( img.attr('alt') );
    portSecRollOver.show();
}); 
```

JsFiddle：http: [//jsfiddle.net/bM25f/1/](http://jsfiddle.net/bM25f/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-10T23:56:24.930

你可以很容易地通过[这种方式](http://jsfiddle.net/izaiasdotcom/fP6eK/)编码来实现它，或者如果你想要更有趣的东西，你可以像[这样](http://jsfiddle.net/izaiasdotcom/MPNJ4/2/)制作它。

# android - Android - 等待触摸事件

> ID：12360810
> 
> 赞同：3
> 
> 时间：2012-09-10T23:30:38.917
> 
> 标签：android, touch-event

在我的 Android 应用程序中，我想在屏幕上依次显示多张图像，等待触摸事件（单击）转到下一个。我在[这里](https://stackoverflow.com/questions/5791307/wait-for-3-seconds-or-user-click)看到这样做的一种方法应该是：

```
public class LoadImage extends Activity {
    private Thread thread; //defined inside the activity

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_load_image);

        [get an image and create a bitmap from it]

        ImageView imageView = (ImageView) findViewById(R.id.imageView);
        imageView.setImageBitmap(bitmap);

        thread = new Thread() {
            @Override
            public void run() {
                try {
                    synchronized(this) {
                        wait(100000000); //large number
                    }
                }
                catch(InterruptedException ex) {                    
                }         
            }
        };
        thread.start();    
   }

    @Override
    public boolean onTouchEvent(MotionEvent evt) {
        if (evt.getAction() == MotionEvent.ACTION_DOWN) {
            synchronized (thread) {
                thread.notifyAll();
            }
        }
        return true;
    }
} 
```

但是，此代码似乎只是跳过等待并立即跳转到最后一张图像。它有什么问题，和/或有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T00:41:06.273

默认情况下，Android 中的事件侦听器用于等待 - 您不必提供任何延迟。

只需`onTouchEvent(...)`在 ImageView 上设置侦听器并显示第一个位图。触摸 ImageView 时，显示下一个位图，依此类推。您所要做的就是计算有多少次触摸，以便知道要显示哪个图像（图像 1、2、3、4 等）。

例子...

```
public class LoadImage extends Activity {

    int imageNumber = 1;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_load_image);

        //get an image and create a bitmap from it

        ImageView imageView = (ImageView) findViewById(R.id.imageView);
        imageView.setImageBitmap(bitmap);

   }

    @Override
    public boolean onTouchEvent(MotionEvent evt) {
        if (evt.getAction() == MotionEvent.ACTION_DOWN) {
            imageNumber++;
            switch (imageNumber) {
                case 2:
                    // show image 2
                    break;
                case 3:
                    // show image 3
                    break;
                ...
            }
            return true;
        }
        return false;
    }
} 
```

# regex - 正则表达式 选择除 A 之外的 HTML 标记

> ID：12360818
> 
> 赞同：-1
> 
> 时间：2012-09-10T23:31:31.350
> 
> 标签：regex

我正在寻找一种正则表达式模式来选择除锚标记之外的所有 html 标记。

我一直在尝试修改我在[这里](http://haacked.com/archive/2004/10/25/usingregularexpressionstomatchhtml.aspx)找到的以下正则表达式，但它是让我眼睛流血的那些模式之一。这种模式看起来非常彻底，所以我希望将它一周以避免锚标签。

```
</?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)/?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T00:21:31.003

你想搜索，而不是验证标签，所以使用简单的正则表达式模式`</?(?![aA]\b)\w+\b[^>]*>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T18:17:35.283

我最终在我的第一篇文章中使用了原始模式来选择所有 html 标签，然后遍历每个标签，只留下锚标签。该模式比另一个建议的模式更可靠。感谢您的帮助。

# ios - 如何防止 UITextField 的自动更正气泡与 inputAccessoryView 重叠？

> ID：12360820
> 
> 赞同：6
> 
> 时间：2012-09-10T23:31:34.897
> 
> 标签：ios, ios5, ios4, uikit

首先，提前感谢您的时间。我正在与一个恼人的故障作斗争。我已经建立了一个快速示例项目，只是为了确保我没有搞砸这个。

如您所见，“自动更正气泡”与我的 UITextField 的 inputAccesoryView 重叠。

有谁知道是否有办法指定应在字段上方显示气泡...？

在我看来，这是一个 UIKit 故障，在计算气泡位置的例程中。它显然没有考虑 inputAccesoryView。

事实上，如果我删除 UIToolbar，并将 UITextField 放在键盘正上方，气泡将向上显示。

任何想法都将受到欢迎。

谢谢！

![在此处输入图像描述](../Images/89217b5308f5bca152105bc336d20c8b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-04T16:01:47.073

我不知道你是否想出这个问题的答案。也许它会帮助你和其他人。在文本视图或 textfeild 属性（在右侧视图中）有一个名为“更正”的属性。将其设置为“无”。它将删除自动更正。

# java - Play - 与第 3 方 API 的异步通信

> ID：12360821
> 
> 赞同：2
> 
> 时间：2012-09-10T23:31:38.430
> 
> 标签：java, api, asynchronous, playframework

我被困在如何进行。我正在尝试将 play 1.2.5 框架与第 3 方 API（Interactive Brokers）一起使用。

我知道有人为 Grails Java 回答了类似的问题[：如何使用 3rd party API 实现套接字编程功能](https://stackoverflow.com/questions/9310576/java-how-to-achieve-socket-programming-functionality-with-3rd-party-api)

基本上，IB API 对请求和回复使用异步通信。即当我调用getData() 时，API 知道在准备好发送它们时使用回调函数dataResults()。为了使 dataResults() 可以调用，我创建的代理对象仍然需要在附近才能接收回复。在控制器函数内部，如果我创建一个代理对象并调用 getData()，当请求完成时，代理对象显然也会消失。所以我永远无法收到回复。

关于如何在 Play 中做到这一点的任何理想？任何帮助将非常感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:51:58.843

您是否考虑过使用 play 对异步工作的内置支持？ [http://www.playframework.org/documentation/1.2.5/asynchronous](http://www.playframework.org/documentation/1.2.5/asynchronous)

或者，如果您正在考虑框架的第 2 版，您可能会在以下位置看到差异： http: [//playframework.org/documentation/2.0.3/JavaAsync](http://playframework.org/documentation/2.0.3/JavaAsync)

这可能有助于解决您的问题，但如果您需要将对象保留更长的时间，当然总是有静态路由。

# c# - 带有脚本的 HtmlHelper 扩展

> ID：12360823
> 
> 赞同：3
> 
> 时间：2012-09-10T23:31:55.633
> 
> 标签：c#, asp.net-mvc

我正在尝试创建一个 HTML 帮助程序扩展，除了 HTML 标记之外，它还会生成一些 javascript：

```
<select id="foo" name="foo"></select>

<script type="text/javascript">
    // script to populate select with data via $.getJSON
</script> 
```

在默认的 MVC 4 模板中，它们捆绑了 jquery 脚本并将它们放在 HTML 文档的末尾并有一个脚本部分：

```
@Scripts.Render("~/bundles/jquery")
@RenderSection("scripts", required: false) 
```

HTML 帮助程序扩展中有什么方法可以告诉脚本添加到文档的末尾，还是我只需要修改布局以使 jQuery 位于文档的顶部？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T01:13:04.313

假设您使用 ViewModel 作为您的视图，实现您所追求的一种方法是将这两件事分开。

所以在你的**View**中，你会有这样的东西：

```
@Html.DropDownListFor(model => model.Foo, Model.FooList)
@section scripts { @Helpers.MyLittleJsCode(Model.Foo) } 
```

该块`@section scripts {}`将呈现您在布局中放置该部分的任何位置（默认情况下它位于 jquery 包之后）。

创建一个名为“App_Code”的文件夹，并在其中创建一个名为“ **Helpers** ”的剃须刀文件。在里面粘贴以下内容：

```
@using System.Web.Mvc;
@helper MyLittleJsCode(string jsString) {
<script type="text/javascript">
    alert("@jsString");
</script>
} 
```

这将创建一个您需要的下拉列表，并在最后创建一个脚本块并将 Model.Foo 传递给它。我希望这就是你所追求的。

# c# - 如何处理多个资源文件进行本地化？

> ID：12360826
> 
> 赞同：3
> 
> 时间：2012-09-10T23:32:13.463
> 
> 标签：c#, localization, resource-files, satellite-assembly

我有一个使用大量资源字符串的项目。因此，我根据模块将它们组织为文件夹结构。

就像如果模块 A 是一个文件夹，那么在模块 A 下我有以下文件。

```
Module A

       ResourceFileA1.resx 
       ResourceFileA2.resx
       ResourceFileA1.de-DE.resx
       ResourceFileA2.de-DE.resx 
```

类似的是模块 B 的结构。

但我只想拥有一个类文件或如果不可能的话单个包装类（对于与每个资源文件有关的多个类）来获取资源字符串。我正在尝试类似 GetString(moduleA.ResourceFileA1.String)

[我已经尝试过这里](http://ondotnet.com/pub/a/dotnet/2002/10/21/localpt3.htm?page=1)解释的东西但无法正确处理。有人可以帮忙吗？

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:50:32.017

您没有提及您受限于哪个版本的 .NET 框架，但假设您至少使用 .NET 2.0，您真的不必担心手动管理资源文件。通过 Visual Studio 添加一个新的资源文件，你应该会看到一个自动生成的

```
ResourceFileA1.resx 
```

和

```
ResourceFileA1.Designer.cs 
```

设计器文件应自动为您创建对您放入文件中的任何资源项的编译时引用，例如：

```
moduleA.ResourceFileA1.YourStringKey 
```

当您添加新的语言环境（.de-DE.resx 等）时，moduleA.ResourceFileA1.YourStringKey 应该自动引用基于 Thread.CurrentCulture 的正确资源文件，但是如果您愿意，可以通过调用 GetString 显式传递它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T11:08:01.437

您显示的文件都是本地资源，旨在仅由您的应用程序的某些部分访问。但您也可以创建可供所有应用程序代码使用的全局资源。假设您的应用程序是 ASP.NET 应用程序，这些资源位于`App_GlobalResources`. 请参阅[此 MSDN](http://msdn.microsoft.com/en-us/library/ms227427%28v=vs.100%29.aspx)页面，尤其是“全局资源文件”和“本地资源文件”小节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-08T06:01:05.943

这是下面的代码。

```
 [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
    public static global::System.Resources.ResourceManager ResourceManager
    {

        get
        {
            resourceMan = new global::System.Resources.ResourceManager("Ral." + Ral.ResourceFolderPath.GetClientKey + ".Asset.Resource", typeof(Resource).Assembly);
            return resourceMan;
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-27T10:49:23.443

MSDN 链接对我有用，因为我没有遵循 resx 文件的命名约定。 [http://msdn.microsoft.com/en-us/library/ms227427%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/ms227427%28v=vs.100%29.aspx)

它说“当你创建资源文件时，你首先创建一个基本的 .resx 文件。对于你想要支持的每种语言，创建一个具有相同文件名的新文件。但在名称中，包括语言或语言和文化（文化名称）。有关文化名称的列表，请参阅 CultureInfo 类。例如，您可以创建以下文件：

WebResources.resx
基本资源文件。这是默认（备用）资源文件
。WebResources.es .resx
西班牙语的资源文件
。WebResources.es-mx.resx
西班牙语（墨西哥）的资源文件
。WebResources.de.resx
德语的资源文件。”

# python - 姜戈。获取一个对象中所有字段的值

> ID：12360830
> 
> 赞同：11
> 
> 时间：2012-09-10T23:32:46.313
> 
> 标签：python, django, django-models

我正在尝试制作一个如下所示的 JSON：

```
[
    {
        "num_of_followers": 2,
        "name": "Math 140",
        "created_by": "aaa"
    }
] 
```

问题是我真的不明白如何获取一个特定数据库对象的值列表（换句话说，我如何获取整行）

```
@csrf_exempt
def create_subject(request, subject):
    subject, created= Subjects.objects.get_or_create( 
        name=subject,
        user=request.user,
        created_by=request.user)
    list = []
    columns = [Subjects._meta.get_all_field_names()]
    row = ????????
    for value in row:
        record = dict(zip(columns,value))
        list.append(record)
    result = simplejson.dumps(list, indent=4)
    return HttpResponse(result) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2020-12-11T14:59:26.877

如果您询问如何为 ONE 对象执行此操作，那么您应该使用：

```
from django.forms.models import model_to_dict

values = model_to_dict(the_object) 
```

@Marat 的答案很好，它可以工作，但它适用于一个`QuerySet`，而不是一个对象。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-11T00:20:35.007

使用 .values() 查询集方法：

```
@csrf_exempt
def create_subject(request, subject):
    subject, created= Subjects.objects.get_or_create( 
        name=subject,
        user=request.user,
        created_by=request.user)

    return HttpResponse(
        simplejson.dumps(
            list(models.Subject.objects.filter(id=subject.id).values()), 
            indent=4
        )
    ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-16T16:01:27.673

我为使文件字段正常工作而苦苦挣扎。最后，这对我有用。

```
def queryset_object_values(object):
    fields = [field.name for field in list(type(object)._meta.fields)]
    field_values = [(field, getattr(object, field)) for field in fields]
    out = {}
    for field in field_values:
        if isinstance(field[1], FieldFile):
            out[field[0]] = field[1].url
        else:
            out[field[0]] = field[1]
    return out 
```

# performance - IE8 在未知文档和浏览器模式下呈现

> ID：12360831
> 
> 赞同：5
> 
> 时间：2012-09-10T23:32:57.797
> 
> 标签：performance, internet-explorer, internet-explorer-8, ie-developer-tools

我有一个严格的文档类型和一个 X-UA 兼容的元标记，然而，每当我加载我正在开发的这个页面时，它都会以“未知”文档和浏览器模式呈现。任何解决方案和/或想法？

PS：我在本地运行。![在此处输入图像描述](../Images/8b04465a912d380c316e59f3cbab208d.png) 这是在页面完全呈现之后。

![在此处输入图像描述](../Images/14e4336998ce5e8e8ae71901f75ef386.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T23:13:53.887

嗯，我觉得自己像个白痴。原来是 ChromeFrame 插件。没有意识到它与微软网站上的 IE 捆绑在一起。不幸的是，您必须将其从系统中完全删除，而不仅仅是禁用它。

# c# - 序列化 RichTextBox，包括大小、背景色、位置

> ID：12360838
> 
> 赞同：2
> 
> 时间：2012-09-10T23:33:47.727
> 
> 标签：c#, wpf, xaml, xml-serialization

目前我正在使用类似的方法

```
 var content = new TextRange(myRichtextBox.NoteBody.Document.ContentStart, myRichtextBox.NoteBody.Document.ContentEnd);
    using (FileStream fs = File.Create(SavePath))
    {
        content.Save(fs, DataFormats.XamlPackage);
    } 
```

这对于保存我的 RichTextBox的*内容非常有用。*我遇到的麻烦是找到一种方法来保存整个控件。

我尝试使用`XmlSerializer`which 序列化这样的对象时遇到问题，因为存在不可变和接口继承。我得到错误`There was an error reflecting type <my window type>`。我试过使用 XmlWriter 但运气不佳。

我正在考虑创建第二个 XML 文件，该文件保存一些对我很重要的 RTB 关键属性以及对我的 RTB 内容的 XAML 序列化的引用。但在我从头开始创建一个避免不可序列化元素的 XML 文档之前，我想知道：还有更多选择吗？如何保存我的 RichTextBox 的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:10:03.187

根据this [MSDN Forum Posting](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/1d643002-6d03-40f3-8248-90201e3aa0d3)，您可以使用命名空间的[XamlWriter.Save](http://msdn.microsoft.com/en-us/library/ms613438)方法`System.Windows.Markup`。我修改了 RichtextBox 的给定示例并进行了测试。

*来自 MSDN 链接的 XamlWriter 类的定义：*

> 提供单个静态 Save 方法（多个重载），可用于将提供的运行时对象有限 XAML 序列化为 XAML 标记。

**Xaml**

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <Grid>
        <RichTextBox Height="100" HorizontalAlignment="Left" Margin="10,10,0,0" Name="richTextBox1" VerticalAlignment="Top" Width="200" Background="#FF00F7F7">
            <FlowDocument>
                <Paragraph>
                    <Run Text="Hello World"/>
                </Paragraph>
            </FlowDocument>
        </RichTextBox>
        <Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="92,164,0,0" Name="button1" VerticalAlignment="Top" Width="75" Click="button1_Click" />
        <Label Content="Label" Height="221" HorizontalAlignment="Left" Margin="216,12,0,0" Name="label1" VerticalAlignment="Top" Width="250" />
    </Grid>
</Window> 
```

**Xaml.cs**

```
using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Markup;
using System.IO;
using System.Xml;

namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, RoutedEventArgs e)
        {
            string savedRichTextBox = XamlWriter.Save(richTextBox1);
            File.WriteAllText(@"C:\Temp\Test.xaml", savedRichTextBox);

            StringReader stringReader = new StringReader(savedRichTextBox);
            XmlReader xmlReader = XmlReader.Create(stringReader);

            RichTextBox rtbLoad = (RichTextBox)XamlReader.Load(xmlReader);

            label1.Content = rtbLoad;
        }
    }
} 
```

**测试.xaml**

```
<RichTextBox Background="#FF00F7F7" Name="richTextBox1" Width="200" Height="100" Margin="228,173,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><FlowDocument PagePadding="5,0,5,0" AllowDrop="True"><Paragraph>Hello World</Paragraph></FlowDocument></RichTextBox> 
```

# c++ - 为什么_beginthread返回错误ENOMEM

> ID：12360845
> 
> 赞同：1
> 
> 时间：2012-09-10T23:35:59.693
> 
> 标签：c++, stress-testing

我有一台用 C++ 实现的服务器，运行在具有 25GB RAM 的 Windows 2003 企业上。

在压力测试期间，我看到当它试图通过调用 _beginthread 创建一个新线程时，我得到了 ENOMEM，这意味着“内存不足”。

但是不明白为什么是内存不足，perfmon数据显示当时进程已经使用了1.2GB VM和类似的物理内存，只有250个线程。

谁能帮我分析或解释为什么我仍然得到这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T10:08:28.083

一个线程通常需要 1 MB 的**未分段**地址空间。如果您的压力测试将内存碎片化到没有可用的 1 MB 延伸的程度，您将无法创建任何新线程。在最坏的情况下，这可以通过少至 2000 个每个字节的分配来实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:56:55.273

一个典型的 32 位应用程序在创建少于 2048 个线程后会耗尽（虚拟）内存。默认情况下，每个线程保留 1MB 的连续虚拟地址空间，因此 2048 个线程将需要 2GB 的虚拟内存。这是 32 位进程在用户模式下可能消耗的最大值。

PS 有一个选项（至少在 Windows 上）可以将操作系统配置为在用户模式下保留多达 3GB 的虚拟地址空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T17:44:44.480

它最终是因为我们的应用程序中的内存泄漏。

# java - 行选择在 JTable 中不起作用

> ID：12360850
> 
> 赞同：1
> 
> 时间：2012-09-10T23:37:33.707
> 
> 标签：java, netbeans, jtable

我创建了一个 JTable，但由于某种原因行选择不起作用（我使用的是 mac 和 Nimbus L&F）。

这是代码：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package nysemarketpick;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Vector;
import javax.swing.event.TableModelEvent;
import javax.swing.event.TableModelListener;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableModel;
import javax.swing.table.TableRowSorter;

/**
 *
 * @author Administrator
 */
public class PortfolioForm extends javax.swing.JFrame {

    /**
     * Creates new form PortfolioForm
     */
    public PortfolioForm() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jbtAddRow = new javax.swing.JButton();
        jbtDeleteRow = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder("Row functions"));

        jbtAddRow.setText("Add New Row");

        jbtDeleteRow.setText("Delete Selected Row");

        org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(jPanel1Layout.createSequentialGroup()
                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(jPanel1Layout.createSequentialGroup()
                        .add(34, 34, 34)
                        .add(jbtAddRow))
                    .add(jPanel1Layout.createSequentialGroup()
                        .add(16, 16, 16)
                        .add(jbtDeleteRow)))
                .addContainerGap(40, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .add(jbtAddRow)
                .add(18, 18, 18)
                .add(jbtDeleteRow)
                .addContainerGap(26, Short.MAX_VALUE))
        );

        jTable1.setAutoCreateRowSorter(true);
        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null}
            },
            new String [] {
                "Stock Symbol", "Stock Name", "Shares", "Value (in Dollars)", "Total Value"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.Integer.class, java.lang.Double.class, java.lang.Double.class
            };
            boolean[] canEdit = new boolean [] {
                true, false, true, true, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tableModel = (DefaultTableModel)jTable1.getModel();
        jTable1.setColumnSelectionAllowed(true);
        jTable1.setRowSelectionAllowed(true);
        jTable1.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jScrollPane1.setViewportView(jTable1);
        jTable1.getColumnModel().getSelectionModel().setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        //add action listeners
        jbtAddRow.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent e)
            {
                if (jTable1.getSelectedRow() >= 0)
                tableModel.insertRow(jTable1.getSelectedRow(), new Vector());
                else
                tableModel.addRow(new Vector());
            }
        });
        jbtDeleteRow.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent e)
            {
                if (jTable1.getSelectedRow() >= 0)
                tableModel.removeRow(jTable1.getSelectedRow());
            }
        });
        //add other listeners
        tableModel.addTableModelListener(new TableModelListener(){
            public void tableChanged(TableModelEvent e)
            {
                DefaultTableModel model = (DefaultTableModel)e.getSource();
                //Object data = model.getValueAt(e.getFirstRow(), e.getColumn());
                if (e.getColumn() == 0)
                {
                    Object data = model.getValueAt(e.getFirstRow(), e.getColumn());
                    String stockSymbol = (String)data;
                    XMLService2 myService = new XMLService2(stockSymbol);
                    String stockName = XMLService2.getStockName();
                    model.setValueAt(stockName, e.getFirstRow(), e.getColumn() + 1);
                }
                if (e.getColumn() != 4 && model.getValueAt(e.getFirstRow(), 2) != null && model.getValueAt(e.getFirstRow(), 3) != null)
                {
                    Double myDouble =(Integer)model.getValueAt(e.getFirstRow(), 2)*(Double)model.getValueAt(e.getFirstRow(), 3);
                    model.setValueAt(myDouble, e.getFirstRow(), 4);
                }
            }
        });

        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(layout.createSequentialGroup()
                        .add(21, 21, 21)
                        .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 645, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                    .add(layout.createSequentialGroup()
                        .add(31, 31, 31)
                        .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(50, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .addContainerGap()
                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 399, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .add(27, 27, 27)
                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(PortfolioForm.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(PortfolioForm.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(PortfolioForm.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(PortfolioForm.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new PortfolioForm().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    private DefaultTableModel tableModel;
    private javax.swing.JButton jbtAddRow;
    private javax.swing.JButton jbtDeleteRow;
    // End of variables declaration
} 
```

任何关于这个的想法都非常受欢迎。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T00:28:11.990

这里的问题是你已经设置

```
jTable1.setColumnSelectionAllowed(true); 
```

这有效地将选择范围限制为一个单元格。设置为默认 false 将允许您选择整行。

# javascript - 在循环中从一到x获取数字？

> ID：12360856
> 
> 赞同：-5
> 
> 时间：2012-09-10T23:38:50.317
> 
> 标签：javascript, jquery

如何从`0`-`x`如果 x 是这样的变量中获取所有数字：

```
var x = 5 
```

然后循环，以便将它们全部单独记录`console.log()`？

我在想我可以使用，但使用类似或 while`.each()`的东西可能更有意义。`for`我会发布代码，但老实说，我想不出一个好的/可能的方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:42:02.217

```
var x = 5;

for (var i = 0; i <= x; i++)
    console.log(i); 
```

jQuery 的`$.each()`方法是遍历一个对象或数组，所以它对这个问题没有意义，尽管你可以做一些像这样愚蠢的事情：

```
$.each(new Array(x+1), function(i) {
    console.log(i);
}); 
```

即，创建一个包含`x+1`元素的新数组，然后专门对其进行迭代以使用索引值。*我不推荐这个，*但既然你问过 jQuery ......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T23:42:15.367

像这样？[http://jsfiddle.net/howderek/KKgPT/](http://jsfiddle.net/howderek/KKgPT/)

```
x = 5;
for (i = 0;i <= x;i++) {
    console.log(i);
    document.getElementById("result").innerHTML += i + ' ';
}​ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T23:41:31.297

这真的很基本：

```
 for (var i = 0; i < x; ++i) console.log(i); 
```

（`<=`如果您想`x`在输出中包含 的值，请使用。）

# dns - 为 Azure 预留实例配置 A 记录

> ID：12360857
> 
> 赞同：0
> 
> 时间：2012-09-10T23:39:03.733
> 
> 标签：dns, azure-web-app-service

我在 Windows Azure 上创建了一个 WordPress 站点并进行了部署。它是一个保留实例，根据[这篇](https://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns/ "这")文章，我应该能够从门户获取 IP 地址以配置 A 记录：

> 使用 A 记录，您可以将域（例如 contoso.com 或 www.contoso.com）或通配符域（例如 *.contoso.com）映射到 Windows Azure 托管服务中部署的单个公共 IP 地址. 因此，此 IP 地址的生命周期就是在您的托管服务中部署的生命周期。IP 地址在您首次部署到托管服务中的空槽（生产或暂存）时创建，并由槽保留，直到您从该槽中删除部署。您可以从 Windows Azure 管理门户中发现此 IP 地址。

我在 Windows Azure 门户中的任何地方都看不到 IP 地址。谁能指出我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:50:57.663

**[更新]**自 9.17.2012 起，可以将 A 记录添加到[azure-web-sites](/questions/tagged/azure-web-sites "显示标记为“天蓝色网站”的问题")实例，请按照WindowsAzure.com 上[的为 Windows Azure 网站配置自定义域名](https://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns-web-site/)说明进行操作

* * *

这篇文章提到了 Windows Azure 托管服务，看看您正在使用的术语（例如保留）我相信您正在使用 Windows Azure 网站。

Windows Azure 网站是一项由 Microsoft 管理的服务，因为该服务使用云服务基础架构，所以无法保证您的网站实例的 IP 地址是什么，您需要使用 CNames。

我的同事 Brady Gaster 整理了[一篇](http://www.bradygaster.com/redirection-with-windows-azure-web-sites)关于如何将 CNames 设置到 Windows Azure 网站的博文。

您还可以阅读 WindowsAzure.com 上的文章，该文章描述[了如何将 CNames 与 Windows Azure 网站一起使用](http://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns-web-site/)。

# unix - 一次执行多个 unix 命令

> ID：12360858
> 
> 赞同：1
> 
> 时间：2012-09-10T23:39:10.970
> 
> 标签：unix

这是我的任务命令。

```
find -name myname.tar
tar -xvf myname.tar
rm -r myname/* 
```

这些多行命令工作正常，但我需要一个单行命令。然后我使用了这个命令，

```
find -name myname.tar | tar -xvf myname.tar | rm -r myname/* 
```

我收到此错误：

```
"rm -r myname/*
rm: cannot remove `myname/*': No such file or directory " 
```

有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-10T23:48:19.887

如果上一个命令运行没有错误，您很可能正在寻找一种执行下一个命令的方法。

*   在 UNIX 中，来自命令行工具的错误通常会改变程序的退出状态
*   在大多数 UNIX shell 中，`&&`操作员检查退出状态并继续前进，如果是`0`（表示 OK）

所以你似乎想要的是

```
find -name myname.tar && tar -xvf myname.tar && rm -r myname/* 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T23:47:10.560

有两种常见的方法可以做到这一点：

用分号将命令连接在一起，分号`;`将一个接一个地运行命令。

```
echo "Hello"; false; echo "There";
>> Hello
>> There 
```

另一种是加入命令`&&`

如果前一个命令的`&&`退出代码为零，则只会执行下一个命令。

```
echo "Hello" && false && echo "There";
>> Hello 
```

'|' 符号完全不同。它运行这两个命令，将标准从`stdout`一个输入到`stdin`另一个输入。（`wc -w`计算 中的单词数`stdin`。）

```
echo "Two Words" | wc -w
>> 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T23:43:08.223

您使用的 (|) 称为对等点，它将数据从一个命令传递到另一个命令。例如：

```
$ cat test.php | grep '<'
<?php 
```

要一个接一个地运行多个命令，您可以使用';'：

```
echo 123; echo 456 
```

或者如果你希望你的命令依赖于彼此的成功，你可以'&&'：

```
$ eho 123; echo 456
eho: command not found
456

$ eho 123 && echo 456
eho: command not found 
```

# python - NameError at / name 'editareapage' 未定义

> ID：12360860
> 
> 赞同：0
> 
> 时间：2012-09-10T23:39:28.990
> 
> 标签：python, django, web, django-urls, django-manage.py

好的，所以我是一个菜鸟，用 python 在 django 中构建一个基本站点。我正在尝试在我的站点中实现一个名为编辑区域的新页面。每当我访问该页面时，我得到的就是这个......

```
NameError at /
name 'editareapage' is not defined
Request Method: GET
Request URL:    http://127.0.0.1:8000/
Django Version: 1.4.1
Exception Type: NameError
Exception Value:    
name 'editareapage' is not defined 
```

我的观点.py

```
from django.http import HttpResponse
from django.shortcuts import render_to_response
import datetime
def hello(request):
    return HttpResponse("Hello, World!")

def mainpage(request):

    return render_to_response('mainpage.html')

def current_datetime(request):
    now = datetime.datetime.now()
    return render_to_response('current_datetime.html', {'current_time':now})

def hours_ahead(request,offset):
    try:
        offset= int(offset)
    except ValueError:
        raise Http404()

    dt = datetime.datetime.now() + datetime.timedelta(hours=offset)
    html = "<html><body>In %s hour(s), it will be %s.</body></html>" % (offset,dt)
    return HttpResponse(html)

def editareapage(request):
    return render_to_response('editareapage.html') 
```

另外值得注意的是editareapage是我试图访问的那个。

这是我的 urls.py

```
 from django.conf.urls import patterns, include, url
from MyProj.views import hello,mainpage, current_datetime, hours_ahead
# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
      (r'^hello/$', hello),
      (r'^$', mainpage),
      (r'^time/$',current_datetime),
      (r'^time/plus/(\d{1,2})/$', hours_ahead),
      (r'^editareapage/$', editareapage),
    # Examples:
    # url(r'^$', 'MyProj.views.home', name='home'),
    # url(r'^MyProj/', include('MyProj.foo.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
     (r'^admin/', include(admin.site.urls)),
) 
```

希望这足以让某人帮助我，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T00:30:15.003

您应该将editareapage导入`urls.py`

```
from MyProj.views import hello, mainpage, current_datetime, hours_ahead, editareapage 
```

# memory - 达到理论 GPU 全局内存带宽

> ID：12360861
> 
> 赞同：6
> 
> 时间：2012-09-10T23:40:09.247
> 
> 标签：memory, global, gpu, bandwidth, max

前言：假设我在 CUDA 中使用 NVIDIA GTX480 卡。此卡的理论峰值全局内存带宽为 177.4 GB/s：384*2*1848/8 *1E9 = 177.4 GB/s

384 来自内存接口宽度，2 形成内存的 DDR 特性，1848 是内存时钟频率（以 MHz 为单位），8 来自我想以字节为单位得到答案的事实。

可以为共享内存计算类似的东西：每组 4 字节 * 32 组 * 每周期 0.5 组 * 1400MHz * 15 SM = 1,344 GB/s

上面的数字会影响 SM 的数量，即 15。因此，要达到这个最大共享内存带宽，我需要让*所有*15 个 SM 读取共享内存。

我的问题：为了达到最大全局内存带宽，只从全局内存中读取*一个*SM 就足够了，还是应该所有 SM 都尝试同时从全局内存中读取？更具体地说，假设我启动了一个带有 32 个线程的块的内核。那么，如果我在 SM-0 上有唯一的一个 warp，并且我在内核中所做的一切都是以合并的方式从全局内存中不间断地读取，我会达到 177.4 GB/s 吗？或者我应该启动至少 15 个块，每个块有 32 个线程，以便 SM-0 到 SM-14 上的 15 个扭曲尝试同时读取？

立即要做的事情可能是运行基准测试来解决这个问题。我想了解为什么会发生什么，会发生什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T06:47:03.410

据我所知，GPU 的片上网络是 TPC 和内存控制器的交叉开关。因此，理论上一个 SM 可以在不同的内存控制器之间交错内存访问，以实现全全局带宽。但请注意，每个交叉开关接口都有一个缓冲区，如果这个缓冲区不够大，活动 SM 中的内存指令可能会停止。此外，每个 SM 都具有有限的容量来保持出色的内存访问。这些问题可能会限制每个 SM 可以使用的内存带宽。所以，我认为你的问题的答案需要一些[微基准测试](http://www.stuffedcow.net/files/gpuarch-ispass2010.pdf)，我猜一个 SM 不能利用整个全局内存带宽。

# ios - 跟踪每个用户的设备数量

> ID：12360863
> 
> 赞同：1
> 
> 时间：2012-09-10T23:40:50.080
> 
> 标签：ios, iphone

由于 iPhone 上的 App Store 允许您在只需支付一次费用的情况下跨多个设备下载应用程序，因此我需要一种方法来跟踪设备数量以及购买该应用程序的人数。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:53:53.287

如果您只需要一个通用编号，您可以安装任何分析系统，例如 Flurry，它将跟踪所有独特的设备安装，您可以简单地将其与 iTunes 中的下载编号相匹配，这将是您的实际购买。您的唯一设备安装数应该更高，但是更多的是有多少用户拥有多个设备的一般数量。我说这是一个通用数字，因为它不会考虑越狱安装以及如果人们获得新设备来替换现有的和其他会使您的数字不太准确的条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:54:36.963

不是没有越狱，可能。Apple 不允许访问购买应用程序的 Apple ID，甚至是设备的 UDID。您可以查询用户名和密码来执行您自己的服务器端身份验证，使用 MAC 地址或该地址的某种变体将帐户绑定到设备。

但是您需要运行自己的服务器，并且这不会与 Apple ID 绑定，除非您特别要求提供这些凭据，而且我认为 Apple 不允许这样做的应用程序通过他们的商店分发，除非用于应用内购买。用于应用内购买的 API 也不允许您访问凭据。

# asp.net - 解决“用户 '' 登录失败。该用户未与受信任的 SQL Server 连接关联。” 在 Windows XP 中的 IIS 中

> ID：12360865
> 
> 赞同：2
> 
> 时间：2012-09-10T23:40:58.937
> 
> 标签：asp.net, sql-server, iis, permissions, windows-xp

在 Windows XP 中运行时，我在 IIS 中的 ASP.NET Web 应用程序中遇到以下错误。我在 Web 应用程序中使用 Windows 身份验证。我通常会使用 SQL Server 身份验证（混合模式），但我无权访问此数据库服务器，但读取权限除外。它们只允许可信连接（或集成安全=SSPI；），这意味着使用我们的 Windows 网络身份验证用户。

**错误：**

```
Login failed for user ''. The user is not associated with a trusted SQL Server connection. 
```

**.NET 代码：**

```
SqlConnection conn = new SqlConnection(
    "server=server_name;" +
    "Integrated Security=SSPI;" +
    "database=db_name;" +
    "connection timeout=30;");
SqlDataReader rdr = null;
List<Ticket> list = new List<Ticket>();

try
{
    conn.Open();
    SqlCommand cmd = new SqlCommand("SELECT TOP 10 [HEATSeq],[AssignedBy] FROM [dbo].[Asgnmnt]", conn);
    rdr = cmd.ExecuteReader();
    while (rdr.Read())
    {
        Ticket record = new Ticket();

        record.ticket_id = rdr[0].ToString();
        record.assigned_by = rdr[1].ToString();
    }
}
catch (Exception e)
{
    string x = "";
}
finally
{
    if (rdr != null)
    {
        rdr.Close();
    }
    if (conn != null)
    {
        conn.Close();
    }
} 
```

这与我在 Jon Skeet 的第一个问题中回答的问题类型相同。在 Windows 7 中，您通常会将应用程序池设置为使用 LOCAL MACHINE 或 NETWORK SERVICE（如果您选择不使用 SQL Server 身份验证）运行。除了我不知道在哪里更改 IIS 6 中应用程序池的用户。

[从 ASP.NET 访问“用户实例”数据库时出现用户权限错误](https://stackoverflow.com/questions/1134151/user-permission-error-when-accessing-user-instance-database-from-asp-net)

我阅读了这篇文章，但这适用于 Windows 7 中的 IIS，而不是 Windows XP。如何在 Windows XP 中解决此问题。请注意，当我在控制台应用程序中运行此代码时，它连接良好。

[http://blogs.msdn.com/b/sql_protocols/archive/2008/05/03/understanding-the-error-message-login-failed-for-user-the-user-is-not-associated-with- a-trusted-sql-server-connection.aspx](http://blogs.msdn.com/b/sql_protocols/archive/2008/05/03/understanding-the-error-message-login-failed-for-user-the-user-is-not-associated-with-a-trusted-sql-server-connection.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T20:29:11.837

在 MSDN 中找到了答案。

[http://msdn.microsoft.com/en-us/library/ab4e6cky(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ab4e6cky(v=vs.80).aspx)

如果 URL 将来发生变化，我将从上面的文档中粘贴下面的文本。如果处理 Windows 7，Fickle 的答案是正确的。根据我的阅读，您必须在运行 SQL Server 的远程计算机上授予计算机计算机（在 Windows XP 中运行 IIS）的权限。我发现只要求 SQL Server 的 DBA 创建一个帐户让我通过 SQL Server 身份验证登录会更容易。

======================

***此错误可能有多种形式，包括：***

用户“（null）”登录失败

用户域\用户名登录失败

用户计算机\ASPNET 登录失败

***可能的原因是您正在使用 Web 应用程序并试图访问运行 Microsoft SQL Server 的计算机。引发的特定错误或异常取决于 Web 服务器是否也在运行 SQL Server。出现此问题的原因是 Web 应用程序未将有效凭据传递给 SQL Server。通常，您可以通过执行以下操作之一来解决此问题：***

*   如果 Web 服务器也运行 SQL Server，则授予本地 ASPNET 用户登录权限（Windows 2000 和 Windows XP）或授予服务器上的 NT AUTHORITY\NETWORK SERVICE 登录权限（Windows Server 2003）。

*   如果 SQL Server 正在远程计算机上运行并且 Web 服务器正在运行 IIS 6.0，请授予 Web 服务器的计算机帐户在远程计算机上的登录权限。机器帐户引用为 DOMAIN\MACHINENAME$。

*   将 ASP.NET 设置为作为在运行 SQL Server 的计算机上具有登录权限的 Windows 域用户运行。

*   使用连接字符串来使用 SQL Server 标准安全性。为此，您必须使用明确的用户 ID 和密码配置连接字符串。

***有关详细信息，请参阅从 Web 应用程序访问 SQL Server。***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:41:21.870

在 ApplicationPools 下，右键单击您的站点使用的池。选择属性，然后转到“身份”选项卡。单击可配置的单选按钮并输入凭据。如果您没有要使用的用户，请转到我提供的链接，它将为您提供创建用户的步骤。

[自定义身份](http://blogs.msdn.com/b/friis/archive/2010/10/08/steps-for-setting-up-a-custom-identity-of-an-iis-6-application-pool.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-17T06:58:12.483

我在运行我的 MVC 应用程序时遇到了同样的问题。当我通过我的窗口凭据登录时，从 MVC 应用程序连接远程计算机上的实体数据库时出现错误。

使用下面的批处理脚本后，我通过远程机器凭据登录，以便问题解决并且应用程序成功连接到数据库。

runas /user:corp\username /netonly "C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\devenv.exe"

请将用户名替换为您的公司用户名。它将提示您命令提示符，输入您的密码（密码将不可见）。这样新实例将为 .net 应用程序打开，该应用程序将通过 corp 凭据连接您

# asp.net-mvc - MVC 4 DbContext Enable-Migrations 在 Configuration.cs 中重写种子代码

> ID：12360868
> 
> 赞同：1
> 
> 时间：2012-09-10T23:41:47.227
> 
> 标签：asp.net-mvc, entity-framework, asp.net-mvc-4

我正在尝试首先在一个新的 MVC 4 项目中编写代码，并拥有一个运行良好的“日志”mvc，并且它在 /Migrations/Configuration.cs 中的 Seed 函数也运行良好。但是，当我在 AccountModels.cs 中处理 UserProfile 模型，然后为其使用 Enable-Migrations 时，我丢失了日志模型的所有种子代码，它被替换为 UserProfile 的外壳。:(

当首先使用代码并拥有多个模型时，不可避免地都有自己的 DbContext（除非它们都应该共享一个？）如何保留每个 DbContext 和模型的种子代码？

我很震惊以前没有人遇到过这个问题。我只是不希望每次在执行 Enable-Migrations 命令时在代码优先 mvc 项目中使用包管理器控制台时都重新编写 Configuration.cs，或者至少为什么每个 dbcontext 都不能有自己的 configuration.cs，或者某物！看来我可能很快就要提供赏金了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T18:17:50.207

好的，我想通了。诀窍是在创建后重命名 Configuration.cs 类。然后，稍后当您添加新迁移并进行更新时，您指定配置，如下所示。

Enable-Migrations -ContextTypeName LDN.Models.Cohort

add-migration -ConfigurationTypeName LDN.Migrations.ConfigurationCohort CohortInitial

更新数据库-详细-配置 LDN.Migrations.ConfigurationCohort

# lotus-notes - 使用 Lotus Notes Java API 从 Lotus Notes 中提取内联图像

> ID：12360869
> 
> 赞同：1
> 
> 时间：2012-09-10T23:41:50.440
> 
> 标签：lotus-notes, lotus-domino

如果电子邮件是从外部电子邮件（例如 gmail）发送到 Lotus 便笺中，我在提取粘贴在电子邮件正文中的内联图像时遇到问题。

从 Lotus Notes 发送的电子邮件本身没有问题，我可以使用该方法检索内联图像并通过标记流`document.generateXML()`进行解析。`<picture>`

我真正关心的是如何从外部电子邮件（如 gmail）中提取信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T08:15:20.990

这是一个已知问题，因为 MIME 内联附件与 Notes 附件不同。当邮件进来时，如果 File 组件超过一定大小，它将创建一个您可以与之交互的 $FILE。

但是，在某些情况下，或文件大小较小，此附件仍保留在 MIME 数据中。Java API 无法实现的。

您可以使用以下 notes.ini 设置告诉服务器强制将附件存储为 $FILE。

```
MIMEForceAttachments=1 
```

这只会更改传入的新邮件。此外，它会将每个非文本和内联对象视为附件。所以图像也可以被转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-11T06:01:15.860

You can copy the image into another program (e.g. Paint, Ifranview) if you edit the Email. Steps:

```
1) Highlight the Email in the main Inbox view  
2) Action -> Edit  
3) Select image and copy  
4) Open Ifranview and paste the image, Save it 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-19T14:35:16.853

如果您在新窗口中打开消息，复制和粘贴似乎适用于图像

右键单击该消息并选择“在新窗口中打开”。现在右键单击图像并选择复制。现在您可以将图像粘贴到油漆、Word 等中。我有 lotus notes 8.5，这对我有用

# asp.net - IIS7 + ASP.NET 大型媒体文件下载

> ID：12360871
> 
> 赞同：2
> 
> 时间：2012-09-10T23:42:12.213
> 
> 标签：asp.net, .net, iis, download

我正在尝试创建一个允许大文件下载的网站（下载是指浏览器不会尝试播放视频或显示文本文件。我想强制用户选择保存文件的位置) 在 ASP.NET v4 和 IIS7 中，但是我面临一些问题，坦率地说，这让我很恼火。

现在，我找到了一个网站，它提供了一种通过 [http://www.cnblogs.com/bestcomy/archive/2004/08/10/31950.aspx流式传输甚至非常大的文件的方法](http://www.cnblogs.com/bestcomy/archive/2004/08/10/31950.aspx)

但是，此来源的问题是，在下载此文件时，我无法向 http 发送任何其他请求。因此，如果用户尝试一次下载多个文件，它将一直坐在那里，直到第一个请求完成。

有没有办法执行非常大的基于媒体的文件下载，允许用户一次下载多个，并要求用户选择保存位置，而不是右键单击并另存为？

编辑：只是为了扩展这一点，下载位于会话页面（用户登录）之后，因此我可以防止未经授权的用户下载文件（通过匿名的安全性不是安全性：P）。无论如何，我可以打开一个新的浏览器会话，然后登录并下载另一个文件（甚至是同一个文件），但是，任何进一步的请求都会坐在那里并“加载”直到下载完成。

另一个编辑：我正在使用 Razor MVC 框架，如果它改变了任何东西

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:48:27.390

我相信您可以做的是从 IIS 中删除文件处理程序，这将导致文件被下载而不是被打开。虽然我自己没有尝试过，但我认为这应该可行。 [http://technet.microsoft.com/en-us/library/cc771240(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc771240(v=ws.10).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T00:19:43.487

现在有了更多的上下文，我认为这可以简化很多：

要允许并发下载，您需要确保 Session 是只读的。在 MVC3 中，您可以使用 , 来装饰您的控制器`[SessionState(SessionStateBehavior.ReadOnly)]`，以进行自定义安全检查。现在，我不知道您的实现，但考虑到安全性通常是通过使用`Authorize`属性或类似来处理的。

现在，要强制提示保存文件而不是默认打开它，请检查 Darin 在以下帖子中的回答：[https ://stackoverflow.com/a/5830215/1373170](https://stackoverflow.com/a/5830215/1373170)

`FileResult`如果标准适合您的需要，您可以避免使用自定义代码下载文件。

# qt - 获取受 drawLine() 或 QLineF 影响的点列表

> ID：12360873
> 
> 赞同：2
> 
> 时间：2012-09-10T23:42:29.097
> 
> 标签：qt, qt4, qpainter

如何获取 drawLine() 函数影响的点/坐标列表？例如，如果我有

```
QLineF line(10.0, 80.0, 90.0, 20.0);
QPainter(this);
painter.drawLine(line); 
```

我想获取 drawLine() 将绘制的 QPoint 坐标列表。我知道[Bresenham 的 line algorithm](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)，但是我需要它在更一般的情况下工作，我可以设置不同的 QPen 和 QBrush：

```
painter.setPen(QPen(myColor, myWidth, Qt::SolidLine, Qt::RoundCap)); 
```

我还需要它与可能绘制具有相同端点和参数但没有 Qt 的线的其他程序保持一致，因此我希望最终得到相同的结果，并且没有完全不同的差异。

注意：这与[这个问题](https://stackoverflow.com/questions/9680294/how-to-trace-the-missing-pixels-when-using-drawline)不同，因为我需要所有将受绘图功能影响的像素，而不仅仅是多边形/路径的顶点。

**更新**：我认为可以将 QImage 或 QPainterDevice 和 QPaintEngine 子类化以捕获所有“setPixel()”操作。任何人都可以证明或确认，甚至可能编写一个短代码来做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:46:47.643

不确定您的性能要求，但您可以在屏幕外渲染线条，然后查看图像以查看绘制了哪些像素。这是一个示例，它打印在 400x400 图像上从 190,190 到 210,210 的 3 像素线之间绘制的像素。

使用 QImage 时，出于性能原因，请务必使用 scanLine() 函数。

```
#include <QCoreApplication>
#include <QImage>
#include <QPainter>
#include <QDebug>

int main(int argc, char *argv[])
{
    QImage image(400,400,QImage::Format_ARGB32);
    QPainter painter;
    painter.begin(&image);
    painter.fillRect(0,0,400,400,QBrush(Qt::white));
    QBrush brush(Qt::black);
    QPen pen(brush, 3.0);
    painter.setPen(pen);
    painter.drawLine(190,190,210,210);
    painter.end();

    for (int i=0;i<image.height();i++) {
        const uchar *scanLine = image.scanLine(i);
        for (int j=0;j<image.width()*4;j+=4) {
            if ( scanLine[j] == 0 ) {
                qDebug() << "pixel" << i << j/4 << scanLine[j];
            }
        }
    }

    return (0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T15:33:11.393

所覆盖的确切像素甚至不一定在 Qt 程序中保持一致。如果在 上打开抗锯齿`QPainter`会有所不同，如果绘制到 a`QGLWidget`会有所不同，并且可能会根据程序运行的平台而有所不同，因为 Qt 具有不同的`QPaintEngine`实现，不一定会完全生成相同的输出。

简而言之，您所要求的只是不可能的。您只能找到特定绘制操作所覆盖的像素，并且只能通过采用 mzelina 建议的方法来做到这一点。

# android - Android：直接从 Google Play 测试应用程序

> ID：12360874
> 
> 赞同：-1
> 
> 时间：2012-09-10T23:42:57.287
> 
> 标签：android

我想发布一个适用于 Android 的应用程序，但也想在此之前对其进行测试。不安装开发环境可以直接在硬件设备上测试吗？对于懒惰的测试人员。

提前致谢。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:51:19.387

如果您不想使用 adb，只需在设备设置中启用未知来源并旁加载应用程序（您可以将其连接到您的计算机，启用 USB 调试并在您的设备上安装 apk）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T01:46:57.820

如果您有一个安装程序应用程序（我使用[Rhythm Software 的 Installer](https://play.google.com/store/apps/details?id=com.rhythm.hexise.inst)），那么您可以将 APK 文件分发到任何设备（邮寄、保管箱、ftp 等），然后安装它而无需连接到开发环境。

# java - 只能导入一个类型

> ID：12360875
> 
> 赞同：3
> 
> 时间：2012-09-10T23:43:07.567
> 
> 标签：java, class, jsp

关于这个有很多线程，但是我一直没有成功并成功完成这项工作。我正在尝试从 jsp 页面调用一个类。

```
package org.confucius;  

public class HelloWorld {  
    public static String getGreeting ()  
    {  
      return "Hello World!";  
    }  
} 
```

HelloWorld.jsp

```
<html>  
  <head>  
       <%@ page import="org.confucius.HelloWorld" %>  
  </head>  
  <body>  
       <p><%= HelloWorld.getGreeting() %></p>  
  </body>  
</html> 
```

返回以下错误。有人可以告诉我完成这项工作所需的所有配置吗？编译的类驻留在 CLASSPATH 中。

```
org.apache.jasper.JasperException: Unable to compile class for JSP: 

An error occurred at line: 6 in the generated java file
Only a type can be imported. org.confucius.HelloWorld resolves to a package

An error occurred at line: 6 in the jsp file: /HelloWorld.jsp
HelloWorld cannot be resolved

Stacktrace:

org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)
org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)
org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:439)
org.apache.jasper.compiler.Compiler.compile(Compiler.java:356)
org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)
org.apache.jasper.compiler.Compiler.compile(Compiler.java:321)
org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:592)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:328)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T01:56:30.480

尝试在`<html>`块之前导入。我认为应该首先在文档中进行导入。如果这不起作用，请检查您的项目目录。确保它们位于正确的文件夹中。例如，您的**HelloWorld**类应位于：

```
C:/Tomcat/webapps/yourApp/WEB-INF/classes/org/confucius 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-11T01:09:19.767

我又看了一遍，你的代码是对的。

也许你应该清理 servlet 服务器`Tomcat`，删除工作路径（在`Tomcat`is 中`tomcat/work`），重新部署你的项目并再次重新启动服务器。

# spring - spring 中的多个持久化文件

> ID：12360879
> 
> 赞同：0
> 
> 时间：2012-09-10T23:43:20.420
> 
> 标签：spring, hibernate, jakarta-ee, spring-mvc, spring-roo

我正在尝试使用多个持久性 xml 文件创建多个模块。想法是将实体类保留在它所属的同一模块中。

使用 JPA 和 persistence.xml 配置的模块“A”工作正常。模块“B”依赖于模块“A”并且有自己的 persistence.xml。

当我尝试使用时，我得到

```
 IllegalStateException:Conflicting persistence unit definitions for name in 
```

我正在用 spring roo 构建这个测试应用程序。请对此有所了解。干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T19:15:44.193

查看每个 persistence.xml 中的持久性单元名称

类似于模块 A 的 persistanceUnit（工作正常）和模块 B 的 persistanceUnitB 之类的东西。

此外，您必须为每个实体分配适当的持久性单元。可以在 Roo 注解中使用对应的属性

# javascript - 以编程方式填充组合框 dojo (1.8) 的最佳方法是什么？

> ID：12360885
> 
> 赞同：2
> 
> 时间：2012-09-10T23:44:37.857
> 
> 标签：javascript, json, dojo, javascript-framework

您好，我已经寻求用我的数据库中的数据填充组合框的最佳方法。我尝试过这种方式，但我认为在 JavaScript 中有更好的方法。

谢谢你们

```
var albumStore = new JsonRest({target:"/album", idAttribute:"id"});
var store = new Memory();

albumStore.query('').then(function(data) {

    json = new Array();
    for(i in data){
        item = {
            name: data[i].nome,
            id: data[i].id
        }
        json[i] = item;
    }
    store .setData(json);
})

props =  {
    required : true,
    missingMessage: 'campo obrigatório',
    store: store
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T10:12:19.330

您可以使用[Array slice 方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/slice)来[克隆数组](http://davidwalsh.name/javascript-clone-array)：

```
var restStore = new JsonRest({ target: "/album/", idProperty: "Key" });
var memoryStore = new Memory({ idProperty: "Key" });

restStore.query().then(function(response) {
    memoryStore.setData(response.slice(0));
}); 
```

请注意，如果您的 REST 服务器支持，您也可以`JsonRest`直接将 store 与 一起使用。在这个 jsFiddle 上`ComboBox`查看它如何与[sinon.js](http://sinonjs.org/docs/#fakeServer)的[fakeServer一起工作：http:](http://sinonjs.org/) [//jsfiddle.net/phusick/N8DqG/](http://jsfiddle.net/phusick/N8DqG/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T02:14:16.800

假设您的商店是 ItemFileWriteStore，请替换以下代码：

```
json = new Array();
                for(i in data){
                    item = {
                        name: data[i].nome,
                        id: data[i].id
                    }
                    json[i] = item;
                }
                store .setData(json); 
```

使用 store 的 newItem API 如下所示

```
 for(i in data){
                item = {
                    store.newItem({id: data[i].id, name: data[i].name});
                }
            } 
```

同样，还有用于从商店中删除商品的 API。

```
store.deleteItem(item); 
```

# .net - 带有嵌入式图表和使用 .net C# 的数据网格的电子邮件

> ID：12360887
> 
> 赞同：0
> 
> 时间：2012-09-10T23:44:55.757
> 
> 标签：.net, email, datagrid, charts

要求：查询数据库并构建数据网格和图表并通过电子邮件发送此报告/信息的自动化过程。

问题：我可以使用嵌入式图像（图表）或数据网格构建报告，而不是一起构建。如何在电子邮件中同时获取图表和数据网格？

代码：

```
 MailMessage m = new MailMessage();
            SmtpClient smtp = new SmtpClient("smtpservername", 25);
            m.From = new System.Net.Mail.MailAddress("vananthraman@abcd.com");
            m.To.Add("vananthraman@abcd.com");
            m.Subject = "This is a test";

            AlternateView plainView = AlternateView.CreateAlternateViewFromString("This is my plain text content, viewable by those clients that don't support html", null, "text/plain");

            AlternateView htmlView = AlternateView.CreateAlternateViewFromString("<img src=cid:companylogo>", null, "text/html");

            System.Net.Mail.LinkedResource logo = new System.Net.Mail.LinkedResource(path);
            logo.ContentId = "companylogo";

            htmlView.LinkedResources.Add(logo);

            m.AlternateViews.Add(plainView);
            m.AlternateViews.Add(htmlView);

            //some_query is defined here
                    using (SqlCommand cmd = new SqlCommand(some_query, connection))
                    {

                        GridView gvwBmonitor = new GridView();
                        SqlDataReader reader = cmd.ExecuteReader();
                        gvwBmonitor.DataSource = reader;
                        gvwBmonitor.DataBind();

                        m.IsBodyHtml = true;
                        StringBuilder sb = new StringBuilder();
                        HtmlTextWriter hw = new HtmlTextWriter(new StringWriter(sb));
                        gvwBookingmonitor.RenderControl(hw);

                        m.Body = m.Body + sb.ToString();
                        AlternateView htmlView2 = AlternateView.CreateAlternateViewFromString(sb.ToString(), null, "text/html");
                        m.AlternateViews.Add(htmlView2);
                        smtp.Send(m);

                    } 
```

我只看到图表而不是网格。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T06:46:06.743

您正在用图表覆盖网格。创建linkedResources的列表以及其中的每一个到alternativeView.LinkedResources

# javascript - mouseOver 上隐藏图像的问题

> ID：12360889
> 
> 赞同：0
> 
> 时间：2012-09-10T23:45:14.790
> 
> 标签：javascript, jquery, html, css, css-transitions

我知道这个话题已经被提出了好几个，但是我对在鼠标悬停上显示图像有点困惑。我目前有一个`div`带有彩色背景的容器，当您将其悬停时会显示该容器。[单击此处](http://iamnatesmithen.com/bodyworks/products.php)-*向下滚动底部的图像*

`.product-shot-bg`我遇到的问题是我有一个隐藏按钮，我只想在用户悬停时显示该按钮到目前为止已经完成...

```
<script>
function show(#viewProductBtn){
    document.getElementById(#viewProductBtn) = "visible";
}

function hide(#viewProductBtn){
    document.getElementById(#viewProductBtn) = "Hidden";
}
 </script>

 <style>
 .product-shot-bg{
    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    -o-transition: all 0.5s ease;
    width: 208px;
    height: 453px;
}

.product-shot-bg:hover{
    background-color: #f3f3f3;
}

    #viewProductBtn{
    background: url(css/images/viewProductBtn.png) no-repeat;
    width: 197px;
    height: 40px;
    float: left;
    visibility: hidden;
}
     </style>

   <!-- Html -->

   <div class="product-shot-bg" onMouseOver="show('#viewProductBtn')"      onMouseOut="hide('#viewProductBtn')"> <a href="#" id="viewProductBtn "></a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:50:37.857

您的代码有几个问题：

*   您`document.getElementById`对 jQuery 的[ID 选择器](http://api.jquery.com/id-selector/)感到困惑。前者采用`id`元素的 ，而后者使用语法`#id`。因此，如果您打算使用`document.getElementById`，则应将其传递给`id` ***不***带`#`;
*   JavaScript 标识符/名称不能以开头，`#`所以你应该从你的`show`and`hide`函数中删除它们；
*   您想将`style.visibility`属性修改为任一函数`hidden`或函数；`visible``show/hide`
*   中有一个额外的空格`id` `"viewProductBtn "`。

这是它的固定版本：

```
<script type="text/javascript">
function show(viewProductBtn){
    document.getElementById(viewProductBtn).style.visibility = "visible";
}

function hide(viewProductBtn) {
    document.getElementById(viewProductBtn).style.visibility = "hidden";
}
</script>

<div class="product-shot-bg" onMouseOver="show('viewProductBtn')"      onMouseOut="hide('viewProductBtn')"><a href="#" id="viewProductBtn"></a>​ 
```

还有一个**[DEMO](http://jsfiddle.net/ZsSbh/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:58:55.073

你可以用 jquery 做这样的事情：

```
function show() {
  $("#viewProductBtn").show();
}

function hide() {
  $("#viewProductBtn").hide();
} 
```

希望这可以帮助！

# javascript - 在 Rails 3 中使用 AJAX 删除记录

> ID：12360890
> 
> 赞同：1
> 
> 时间：2012-09-10T23:45:16.703
> 
> 标签：javascript, jquery, ruby-on-rails, ruby, highcharts

我在我的 Rails 3 应用程序中使用 Highcharts 来允许用户创建和保存图表注释（我使用带有标签的专用散点图系列保存）。我已经能够弄清楚如何将记录保存到数据库中，如下所示：

```
$.ajax({
    type: "POST",
    url: "<%= service_annotations_path.to_s %>.json",
    data: {
      annotation: {
        name: name,
        time: new Date(x),
        value: y,
      }
    },
    success: function(msg){
      alert(msg);
    }
}); 
```

但我正在努力弄清楚如何使用 AJAX 实现删除。问题似乎有两个方面：

1.  我需要使用通过 JS 从图表中检索到的所选点的 x/y 坐标来查找注释记录，但我不确定如何将其传递回控制器/助手。我想是这样的：

    ```
    var annId = "<%= find_annotation(this.x, this.y) %>"; 
    ```

    ... 可能会工作，返回一个注释 id，我可以用它来删除对象，但我不确定如何从 JavaScript 访问 Ruby 中的那些 JS 坐标变量 [this.x 和 this.y] ......我是什么'正在阅读表明它通常不会完成。（以及我发现的用于规避似乎已被弃用的示例。）

2.  然后，我需要弄清楚实际的删除 AJAX ......

    ```
    $.ajax({
        type: "DELETE",
        url: '<%= service_annotations_path.to_s %>' +  '/' + this.id + '.json',
        data: {
          annotation: {
            time: new Date(this.x),
            value: this.y,
          }
        },
        success: function(msg){
          alert(msg);
        }
    }); 
    ```

    由于它嵌套在服务资源下，这本身就很复杂。

我认为如果我能完成第一部分，将 x 和 y 参数从 JS 传递给 Ruby 应该是可行的。非常感谢任何指针。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T07:52:20.670

Highchart 为系列的点提供各种事件。

[http://api.highcharts.com/highcharts#plotOptions.series.point.events](http://api.highcharts.com/highcharts#plotOptions.series.point.events)

您可以使用获取点的 x 和 y

```
plotOptions: {
            series: {
                cursor: 'pointer',
                point: {
                    events: {
                        click: function() {
                            console.log(this);
                            alert ('X: '+ this.x +', Y: '+ this.y);
                        }
                    }
                }
            }
        } 
```

# android - 哪些 Android 软件包可用于向量、标量、矩阵和 FP 数学？

> ID：12360892
> 
> 赞同：2
> 
> 时间：2012-09-10T23:45:29.217
> 
> 标签：android, math

建议使用哪些软件包在 Android 平台上执行复杂的数学运算，如向量乘法、向量转换（int 到 FP）等。看起来 java.lang.math 不够粗壮。有人建议我研究 NDK 和一个好的 c/c++ lib 或 siglib。还有其他建议吗？谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T00:13:29.160

去年，我正在阅读[一本](http://www.gameenginebook.com/)包含 SIMD 数学主题的书。您可能知道，SIMD 数学用于加速向量乘法和向量转换过程，我查看了 Sony 的 VectorMath 库。

它既方便又易于使用，尽管我无意构建处理器昂贵的应用程序。我认为问题在于它实际上是为索尼 PS3 处理器架构设计的，我不确定它是否适用于 ARM 芯片组。

以下是链接： Bullet SIMDMath 库：[http ://bullet.svn.sourceforge.net/viewvc/bullet/trunk/Extras/simdmathlibrary/](http://bullet.svn.sourceforge.net/viewvc/bullet/trunk/Extras/simdmathlibrary/)

Bullet VectorMath 库：[http ://bullet.svn.sourceforge.net/viewvc/bullet/trunk/Extras/vectormathlibrary/](http://bullet.svn.sourceforge.net/viewvc/bullet/trunk/Extras/vectormathlibrary/)

**编辑**

直接引用维基百科 ARM 架构页面：

> 高级 SIMD (NEON) 高级 SIMD 扩展（又名 NEON 或“MPE”媒体处理引擎）是一个组合的 64 位和 128 位单指令多数据 (SIMD) 指令集，可为媒体和信号处理应用程序提供标准化加速。NEON 包含在所有 Cortex-A8 设备中，但在 Cortex-A9 设备中是可选的。 [33] NEON 可以在运行频率为 10 MHz 的 CPU 上执行 MP3 音频解码，并且可以运行不超过 13 MHz 的 GSM 自适应多速率 (AMR) 语音编解码器。它具有全面的指令集、独立的寄存器文件和独立的执行硬件。 [34] NEON 支持 8 位、16 位、32 位和 64 位整数和单精度（32 位）浮点数据，并在 SIMD 操作中运行，以处理音频和视频处理以及图形和游戏处理。在霓虹灯中，SIMD 最多同时支持 16 个操作。NEON 硬件共享与 VFP 中使用的相同的浮点寄存器。ARM Cortex-A8 和 Cortex-A9 等设备支持 128 位向量，但一次只能执行 64 位，[32] 而较新的 Cortex-A15 设备可以一次执行 128 位。

这意味着即使 SIMD 指令没有保修，它们也可能有。

和 Tegra 家族：

> 与 Tegra 2 相比，Tegra 3 中的 ARM Cortex-A9s 现在支持 ARM 的 SIMD 扩展 - NEON。

# c++ - 无限制联合上的放置删除

> ID：12360893
> 
> 赞同：3
> 
> 时间：2012-09-10T23:45:29.983
> 
> 标签：c++, c++11, unions

我正在阅读 c++11 的 wiki 条目，我发现了一个不受限制的联合部分，您在其中为非平凡的成员[链接](http://en.wikipedia.org/wiki/C%2B%2B11#Unrestricted_unions)调用放置新，但这里的示例与删除不匹配。

所以我的问题是：您是否需要**无限制联合**的展示位置删除？如果是，如何？如果不是，为什么？调用析构函数就足够了吗？

例子：

```
class U_t
{
  public:
    union U
    {
        string s;
        U () { new (s) string(); }
    }
    U _data;
    ~U_t () { 
       _data.s.~string();
       //and now what?
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:02:32.953

§ 9.5/2 如果联合的任何非静态数据成员具有非平凡的默认构造函数、复制构造函数、移动构造函数、复制赋值运算符、移动赋值运算符或析构函数，则联合的相应成员函数必须是用户-提供，否则它将为联合隐式删除。

§ 9.5/3 由于 std::string 声明了所有特殊成员函数的重要版本，[联合] 将具有隐式删除的默认构造函数、复制/移动构造函数、复制/移动赋值运算符和析构函数。要使用 [联合]，这些成员函数中的部分或全部必须由用户提供。

§ 9.5/4 通常，必须使用显式析构函数调用和放置新运算符来更改联合的活动成员。

所以是的，它需要一个析构函数调用，类似于你所拥有的。

但是，要安全地使用这样的东西会复杂得多，因为您必须不断跟踪活动的类型。安全地使用非 POD 类型的联合是*非常*困难的。如果我是你，只使用 POD，或者使用`boost::variant`

# ruby-on-rails - 在heroku上激活resque worker

> ID：12360894
> 
> 赞同：3
> 
> 时间：2012-09-10T23:46:09.610
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, resque, foreman

我的 heroku 应用程序上的队列“send_comments”显示 12 个项目，但显示“0 个工人工作中的 0 个”。我知道，如果我想在 localhost 上处理作业，我使用以下行：

```
QUEUE=send_comments rake resque:work 
```

我如何用heroku做到这一点？

谢谢你。

**更新**

我不确定这个错误是什么意思，但我在运行“工头启动”时得到它

```
$ foreman start --trace
21:15:38 worker.1  | started with pid 803
21:15:44 worker.1  | rake aborted!
21:15:44 worker.1  | can't convert Float into String
21:15:44 worker.1  | 
21:15:44 worker.1  | Tasks: TOP => resque:work => resque:preload => resque:setup
21:15:44 worker.1  | (See full trace by running task with --trace) 
```

这是什么意思，这可能是工人不处理的原因吗？

这是我的 Procfile：

```
worker: env RESQUE_TERM_TIMEOUT=1 TERM_CHILD=1 VVERBOSE=1 QUEUE=* bundle exec rake resque:work 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-03T22:56:04.120

Procfile 就是告诉 Heroku 当你启动一个给定类型的测功机（在本例中是工人）时该做什么。为了实际创建一个工作器，您必须手动扩展测功机，如下所示：

```
$ heroku ps:scale worker=1 
```

这将启动一个测功机，然后运行您在 Procfile after 中指定的内容`worker:`，这具有在新测功机上运行此 rake 任务的效果。这将创建一个工人，您可以根据需要指定任意数量。这种缩放也独立于停止/重新启动您的应用程序。

# ios - 在应用程序之间命名为 UIPasteboard？

> ID：12360895
> 
> 赞同：6
> 
> 时间：2012-09-10T23:46:15.100
> 
> 标签：ios, uipasteboard

是否可以使用命名的 UIPasteboard（即，不是全局的）在两个应用程序之间传输数据？

*   这些应用程序彼此完全独立，因此具有来自不同供应商的不同捆绑 ID
*   我想使用一个命名的粘贴板，所以全局粘贴板中用户自己的内容不会被覆盖

苹果的文档说：

> 粘贴板可以是公共的或私有的。公共粘贴板称为系统粘贴板；私有粘贴板由应用程序创建，因此称为应用程序粘贴板。

这意味着粘贴板可以是“全局和公共的”或“命名和私有的”。

我创建了两个具有不同捆绑 ID 的应用程序，并且似乎能够使用私有命名粘贴板将内容从一个应用程序传递到另一个应用程序。但这只是 iOS 模拟器的一个功能，还是真正支持但没有很好记录的功能？

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-10T23:48:41.827

您可以为您的粘贴板值设置自定义字符串并在您的应用程序中使用该字符串，以便您的应用程序必须使用您的唯一字符串访问该值：

```
UIPasteboard *pasteboard = [UIPasteboard pasteboardWithName:@"youruniquestring" create:YES];

[pasteboard setPersistent:YES];

//save the unique identifier string that we created earlier
[pasteboard setString:@"your message"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:50:03.850

支持。但是请记住，如果设置它的两个应用程序都被删除，命名的粘贴板将会消失，因此不要使用它来存储您没有备份的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-30T12:40:43.773

如果您使用命名粘贴板，则可以将数据从您的应用程序传输到具有相同团队 ID 的其他应用程序。我还没有测试过，但我不认为你可以对不同供应商的应用程序做同样的事情！

苹果文档说：

> 您可以使用类方法 init(name:create:) 和 withUniqueName() 创建命名粘贴板，以便在您的应用程序内以及从您的应用程序到具有相同团队 ID 的其他应用程序共享数据。

# python - 来自数据库的异步 csv.writer

> ID：12360897
> 
> 赞同：0
> 
> 时间：2012-09-10T23:46:43.540
> 
> 标签：python, database, asynchronous, pyodbc

我有一个 Python 脚本，可以将数据库中的数据提取到 CSV 文件中。我正在使用[pyodbc](http://code.google.com/p/pyodbc/)访问数据库并执行查询。我还使用 csv.writer 将查询输出到文件中：

```
with open(source_filename, 'w', newline='') as source_file:
    csv.writer(source_file, quoting=csv.QUOTE_NONNUMERIC).writerows(db_cursor) 
```

因为脚本输出数据库中的所有表，所以我想通过使用后台处理而不是一个接一个来加快提取速度。有没有办法在 Python 中做到这一点？

我尝试使用 Multiprocessing 但无法克服一些酸洗错误。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:23:21.523

[多线程](http://docs.python.org/tutorial/stdlib2.html#multi-threading)是实现并行性的一种更轻量级的方法，但正如文档所述，*“线程是一种用于解耦不依赖于顺序的任务的技术。”* 您需要知道您的依赖项在哪里才能决定并行执行的操作。将多个查询并行提交到由单个磁盘存储支持的数据库会比按顺序提交更快地返回结果，这一点并不明显。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T20:20:07.190

     您必须创建多线程进程；原始进程启动一个新线程，该线程执行数据库访问和文件写入，而原始进程继续其业务。
      此外，与其创建多个访问数据库的进程来检索相同的数据，不如为此使用单个后台进程。它将更安全、更快、更容易调试。

# html - HTML5 视频标签无法在 Firefox 中播放

> ID：12360898
> 
> 赞同：2
> 
> 时间：2012-09-10T23:46:46.607
> 
> 标签：html, html5-video

我有一个 MVC/.NET 项目，并在我的 webconfig 中设置了 mimetype：

```
<staticContent>
      <mimeMap fileExtension=".mp4" mimeType="video/mp4" />
      <mimeMap fileExtension=".m4v" mimeType="video/m4v" />
</staticContent> 
```

然后我将此视频标签添加到我的网页

```
<video width="640" height="385" controls="controls">
      <source src="/videos/sample_mpeg4.mp4" type="video/mp4" />
      <object data="/videos/sample_mpeg4.mp4" width="640" height="385">
        <embed src="movie.swf" width="640" height="385" />
      </object>
    </video> 
```

我在 Firefox 中打开此网页，但收到消息“找不到支持格式和 MIME 类型的视频”。如果我打开`http://localhost/videos/sample_mpeg4.mp4`Firefox 会打开下载窗口，那么这意味着视频路径是正确的。

我在 Stackoverflow 和 google 中进行了搜索，这使我达到了目前的状态，但现在我被卡住了。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:52:36.887

Firefox 不支持其视频标签中的 MP4 格式。主要原因是mp4格式附带的版税。

直接从 Mozilla 团队查看[Media_formats_supported_by_the_audio_and_video_elements](https://developer.mozilla.org/En/Media_formats_supported_by_the_audio_and_video_elements)或以下博客文章了解更多信息：

[http://pauljacobson.org/blog/2010/1/22/firefox-and-its-limited-html-5-video-support.html](http://pauljacobson.org/blog/2010/1/22/firefox-and-its-limited-html-5-video-support.html)

# c# - 如何从 C# 中的字符串中检索特定文本？

> ID：12360900
> 
> 赞同：0
> 
> 时间：2012-09-10T23:47:04.110
> 
> 标签：c#, string, browser, web

我正在开发一个使用网络浏览器制作网络机器人的 Windows 应用程序 (C#)。我成功发送了数据，但是当我检索时，我使用了这行代码：

```
string Data = webBotB.Document.GetElementById("page").InnerText; 
```

数据包含太多无用的文本。

现在，我的问题是如何收集（提取）特定数据（一些文本）之间的数据知道所需文本之前和之后的单词，以使其出现在 Win App 的标签上？

我认为我的问题几乎与 String 方法有关，但如果有一种解决方案可以比上面从 Web 浏览器编写的方法更具体、更容易地检索数据，我很感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T00:07:54.793

这是一种方法来做你需要的。

```
string Between(string data, string start, string end)
{
    int startIndex = data.IndexOf(start) + start.Length;
    int endIndex = data.IndexOf(end, startIndex);
    return data.Substring(startIndex, endIndex - startIndex);
} 
```

像这样称呼它：

```
Between("JohnDoeHelloFoobarGoodbyeStackOverflow", "Hello", "Goodbye")
// "Foobar" 
```

注意：此方法不处理未找到任何一个字符串的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T23:54:13.027

我想你正在寻找[`String.IndexOf`](http://msdn.microsoft.com/en-us/library/system.string.indexof.aspx)和[`String.Substring`](http://msdn.microsoft.com/en-us/library/system.string.substring.aspx)

# java - 我可以使用 Maven 原型插件将自定义对象添加到 Velocity 上下文吗？

> ID：12360904
> 
> 赞同：8
> 
> 时间：2012-09-10T23:47:49.573
> 
> 标签：java, maven, velocity, archetypes

我们有许多使用[Velocity](http://velocity.apache.org/)生成项目的代码生成器。生成可能非常复杂：

*   在调用速度之前使用反射（内省我们必须与之交互的第 3 方代理） - 将结果属性（复杂对象图）添加到速度上下文

*   项目结构和文件可能因所选选项而异

*   模板不仅仅是变量替换（它们使用添加到速度上下文的自定义对象，其中包含许多派生属性，包括在模板中迭代的其他对象的集合）

我很想用[maven 原型](http://maven.apache.org/archetype/maven-archetype-plugin/)替换这些，因为它们也使用 Velocity，但看起来它们似乎只能进行简单的变量替换和静态文件/文件夹结构。

1.  有没有办法在从原型创建项目之前进行处理，将对象添加到速度上下文，并使原型模板能够访问它们？

2.  如果是这样，要创建的文件夹和文件可以是动态的吗？（或者您是否需要为每个变体提供单独的原型？）

3.  还是编写自定义 Mojo 更好？（本质上是用 Maven 插件包装现有的生成器）

# javascript - 将标记（字符串、数字等）从 HTML（支持文件）传递到 LogiXML

> ID：12360908
> 
> 赞同：0
> 
> 时间：2012-09-10T23:48:01.480
> 
> 标签：javascript, asp.net, .net, html

我正在尝试从我创建的外部 HTML 文件中传递某个参数（在本例中为字符串），并且我正在尝试将选择参数传递到 logixml。任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T14:55:25.557

从 HTML 变量传递的任何外部参数都可以作为 Logi 定义中的标准 @Request 令牌从 POST 或 GET 访问。

因此，例如，在查询字符串中传递一个参数，如下所示：

```
http://your_server/report_app/rdPage.aspx?myParameter=string 
```

可以在 Logi 定义中作为 @Request.myParameter~ 访问，其中值等于“字符串”。

如果您使用 FORM 发布参数，您将以相同的方式访问它，@Request.your_form_variable~

# javascript - 以编程方式选择文本 Mobile Safari

> ID：12360910
> 
> 赞同：3
> 
> 时间：2012-09-10T23:48:06.067
> 
> 标签：javascript, iphone, mobile, safari, mobile-safari

我无法在我的网站上选择文本。我有一个 div 块，并希望在 iPhone/Android 上触摸 div 块时选择里面的所有文本。到目前为止，我已经尝试过以下方法：[在 iPhone 上的移动 Safari 中选择文本](https://stackoverflow.com/questions/1899421/selecting-text-in-mobile-safari-on-iphone)

像这样：

```
<div ontouchstart="this.selectionStart=0; this.selectionEnd=this.value.length;"> 
```

我还尝试根据来自不同来源的建议在我的 JS 文件中创建一个函数来执行此操作：

HTML

```
<div ontouchstart="touchStart(event, this);> 
```

JS

```
function touchStart(event, obj) {
  var range = window.getSelection();
  var sel = window.getSelection()

  range.setStart(obj, 0);
  range.setEnd(obj, obj.innerHTML.length);
  sel.removeAllRanges();
  sel.addRange(range);
  //range.execCommand("BackColor", false, colour);
} 
```

到目前为止，这两种方法似乎都不起作用。在 iPhone 上的 Safari 上进行测试时，我似乎使用第二种方法遇到的一个错误是：

```
JavaScript: Error undefined TypeError: 'undefined' is not an object 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T00:09:14.033

`selectionStart`并且`selectionEnd`只是 textareas 和文本输入的属性，所以它们已经出局了。移动 Safari 与所有其他主流浏览器具有相同的选择 API，但您只能影响已显示的可见选择。

HTML：

```
<div ontouchstart="selectElementContents(this);"> 
```

JS：

```
function selectElementContents(el) {
    var sel = window.getSelection();
    var range = document.createRange();
    range.selectNodeContents(el);
    sel.removeAllRanges();
    sel.addRange(range);
} 
```

# php - 如何获取应用程序的 publish_stream 权限以在 Facebook 页面的墙上发布

> ID：12360917
> 
> 赞同：0
> 
> 时间：2012-09-10T23:49:00.723
> 
> 标签：php, facebook-graph-api, facebook-apps

我创建了一个从服务器端连接到 Facebook 的应用程序。我打开了一个页面（社区页面），以便应用程序使用 GRAPH API 在此页面的墙上发布帖子。当我尝试通过 PAGEID/feed 在页面中发帖时，我收到了以下回复：

```
{"error":{"message":"(#200) The user hasn't authorized the application to perform this action","type":"OAuthException","code":200}} 
```

我在 Facebook 应用程序的页面上看到它，例如照片、事件或便笺显示“扩展权限”，但是当我将应用程序添加为选项卡时，不会出现该选项。

我很沮丧！

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T00:35:35.967

您需要页面管理员授予您的应用访问其页面的[权限。](https://developers.facebook.com/docs/authentication/permissions/)

[Authentication](https://developers.facebook.com/docs/authentication/)文档中有一个完整的部分专门用于此： [Authenticating as a Page](https://developers.facebook.com/docs/authentication/pages/)

一旦您获得`manage_pages`了用户的权限，调用`/me/accounts`将返回用户管理的页面列表以及`access_token`您可以用来代表页面进行 API 调用的列表。

# php - 在 WAMP 中发送邮件

> ID：12360919
> 
> 赞同：0
> 
> 时间：2012-07-26T22:38:19.373
> 
> 标签：php, email, wamp

我正在尝试完成我的联系表，但我无法发送邮件。我正在使用 WAMP 服务器。

我配置了 php.ini：

```
[mail function]
; For Win32 only.
; http://php.net/smtp
SMTP = smtp.gmail.com
; http://php.net/smtp-port
Port = 465
; For Win32 only.
; http://php.net/sendmail-from
sendmail_from = {myEmail} 
```

我的 PHP 文件（仅用于测试）看起来不错：

```
<?php
$headers = 'MIME-Version: 1.0' . '\r\n';
$headers .= 'Content-type: text/html; charset=iso-8859-1' . '\r\n';
$headers .= 'From: {myEmail}' . '\r\n';
mail("{myEmail}","test subject","test body",$headers);
?> 
```

我尝试通过转到 send.php 文件来发送它，但我收到此错误：

`SCREAM: Error suppression ignored for`
`Warning: mail(): SMTP server response: 530 5.7.0 Must issue a STARTTLS command first. x3sm881745yhd.9 in C:\wamp\www\send.php on line 5`

我不知道这意味着什么。我不是真正的 PHP 开发人员。我主要使用 JavaScript。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T03:15:08.397

您需要使用 SSL 通过 gmail 发送邮件，而您不能使用 php 执行此操作，您需要不同的 smtp 服务器

# c# - 无法将 Office Interop Refs（特别是 Powerpoint）添加到 C# 项目

> ID：12360922
> 
> 赞同：2
> 
> 时间：2012-09-10T23:49:53.443
> 
> 标签：c#, visual-studio, reference, ms-office, powerpoint

**问题：**

无法将 Microsoft.Office.Interop.* 引用添加到 ac# 项目（.NET 4 客户端配置文件）。我曾经能够使用 Microsoft.Office.Interop.Powerpoint 在不同的机器上进行编译。

**我试过的：**

安装了[Office 2010 PIA](http://www.microsoft.com/en-us/download/details.aspx?id=3508)。我能够从 PIA 安装中很好地加载 Microsoft.Office.Core。事实上，PIA 自述文件说它包括所有办公产品的互操作，包括 Powerpoint。但是当我查看程序/Microsoft Office/Office14/ 时，我看不到任何看起来像其他互操作的 DLL（尽管我不熟悉这里应该有什么）。

还尝试使用 .NET 3.5 项目来查看互操作是否仅适用于该构建目标。

**环境：** Win 7，VS C# Express 2010，.NET 4，部署服务器已安装Office产品

这是我在 refs 对话框中看到的内容： ![在此处输入图像描述](../Images/48dd80dbd26276816f27579ebb8c3077.png)

您可以看到 Core 加载正常：

![在此处输入图像描述](../Images/dc819f3677702201f5bb7c912117c2f5.png)

# php - PHP过期了？

> ID：12360924
> 
> 赞同：0
> 
> 时间：2012-09-10T23:49:54.603
> 
> 标签：php

好的，我有一个格式如下的“截止日期”：08/31/2012 (M/D/Y)。我想使用 PHP 将返回的字符串与当前日期进行比较。如果上面的字符串早于当前日期...执行一些代码。

我知道这看起来很简单，但它让我陷入了困境。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T23:55:08.070

您的意思是如果字符串日期较旧，则执行此操作，否则执行此操作？

```
<?php

$string = '08/31/2012';
if(strtotime($string) < time()){
    echo 'Old';
}else{
    echo 'Not happened yet';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:54:33.617

更改为格式`YYYY-MM-DD`并简单地作为字符串进行比较。

# php - PHP 和 Google Analytics 核心报告 api v3 - 获取配置文件 ID 列表 - 不是帐户 ID

> ID：12360926
> 
> 赞同：1
> 
> 时间：2012-09-10T23:50:05.190
> 
> 标签：php, google-analytics-api

这个问题更多地与 PHP 的机制与 Google 的核心报告 API 的复杂性有关

我的目标是修改下面的代码（取自谷歌的 HelloAnalyticsApi.php），以便它循环并“打印”我**所有**各自谷歌分析帐户的**配置文件 ID列表。**

 **目前，下面的代码通过并获取它看到的第一个帐户的第一个配置文件 ID。它首先获取帐户 ID，然后是该帐户 ID 的网络资源，最后是帐户的配置文件 ID。这是在*getFirstprofileId(&$analytics)*函数中完成的。照原样，代码工作正常。

就我而言，我必须跳过第一个（数组中的位置 0），因为虽然它是一个被列出的帐户，但它没有任何网络属性。因此，我必须从 1 而不是 0 开始计数。

（我将跳过凭据/登录并获取工作逻辑）

```
if (!$client->getAccessToken()) {
  $authUrl = $client->createAuthUrl();
  print "<a class='login' href='$authUrl'>Connect Me!</a>";

} else {
    $analytics = new apiAnalyticsService($client);
    runMainDemo($analytics); 

}

function runMainDemo(&$analytics) {
  try {

    // Step 2\. Get the user's first profile ID.
    $profileId = getFirstProfileId($analytics);

    if (isset($profileId)) {

      // Step 3\. Query the Core Reporting API.
      $results = getResults($analytics, $profileId);

      // Step 4\. Output the results.
      printResults($results);
    }

  } catch (apiServiceException $e) {
    // Error from the API.
    print 'There was an API error : ' . $e->getCode() . ' : ' . $e->getMessage();

  } catch (Exception $e) {
    print 'There wan a general error : ' . $e->getMessage();
  }
}

function getFirstprofileId(&$analytics) {

  $accounts = $analytics->management_accounts->listManagementAccounts();

  if (count($accounts->getItems()) > 0) {

    $items = $accounts->getItems();
    $firstAccountId = $items[1]->getId(); 
    //item 0 is an account that gets listed but doesn't have any webproperties.  
    //This account doesn't show in our analytics

    $webproperties = $analytics->management_webproperties->listManagementWebproperties($firstAccountId);

    if (count($webproperties->getItems()) > 0) {

      $items = $webproperties->getItems();
      $firstWebpropertyId = $items[0]->getId();

      $profiles = $analytics->management_profiles->listManagementProfiles($firstAccountId, $firstWebpropertyId);

      if (count($profiles->getItems()) > 0) {

        $items = $profiles->getItems();
        return $items[0]->getId();

      } else {
        throw new Exception('No profiles found for this user.');
      }
    } else {
      throw new Exception('No webproperties found for this user.');
    }
  } else {
    throw new Exception('No accounts found for this user.');
  }
}

function getResults(&$analytics, $profileId) {

   return $analytics->data_ga->get(
       'ga:' . $profileId,
       '2010-03-03',
      '2011-03-03',
       'ga:visits');
}

function printResults(&$results) {

  if (count($results->getRows()) > 0) {

    $profileName = $results->getProfileInfo()->getProfileName();
    $profileId = $results->getProfileInfo()->getProfileId();

    $rows = $results->getRows();
    $visits = $rows[0][0];

    print "<p>First profile found: $profileName</p>";
    print "<p>First profileId found (not account id): $profileId</p>";
    print "<p>Total visits: $visits</p>";

  } else {
    print '<p>No results found.</p>';
  }
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T01:22:59.023

简单...修改功能 - 添加 for 循环。按帐户中的项目数循环：

```
function getProfileId(&$analytics) {

    //function getFirstprofileId(&$analytics) {

      $accounts = $analytics->management_accounts->listManagementAccounts();

        $num = count($accounts->getItems());

        for ($i=1; $i < $num; $i++) { 

          if (count($accounts->getItems()) > 0) {

            $items = $accounts->getItems();
            $firstAccountId = $items[$i]->getId(); 
            //item 0 is an account that gets listed but doesn't have any webproperties.  
            //This account doesn't show in our analytics

            $webproperties = $analytics->management_webproperties->listManagementWebproperties($firstAccountId);

            if (count($webproperties->getItems()) > 0) {

              $items = $webproperties->getItems();
              $firstWebpropertyId = $items[0]->getId();

              $profiles = $analytics->management_profiles->listManagementProfiles($firstAccountId, $firstWebpropertyId);

              if (count($profiles->getItems()) > 0) {

                $items = $profiles->getItems();

                $profileId = $items[0]->getId();

                print "<p>Profile ID (not account id): ".  $profileId."</p>";

              } else {
                throw new Exception('No profiles found for this user.');
              }
            } else {
              throw new Exception('No webproperties found for this user.');
            }
          } else {
            throw new Exception('No accounts found for this user.');
          }

      }

    } 
```**

# php - 在 Vim 中阅读 PHP 手册页

> ID：12360929
> 
> 赞同：6
> 
> 时间：2012-09-10T23:50:24.333
> 
> 标签：php, vim, manpage

我已经设置了通过 pman 阅读 PHP 手册的能力，如下所述：http: [//bjori.blogspot.com/2010/01/unix-manual-pages-for-php-functions.html](http://bjori.blogspot.com/2010/01/unix-manual-pages-for-php-functions.html)

在我的`.vimrc`文件中，我添加了以下内容，因此我可以按`K`在新的拆分窗口中阅读手册页。

```
source $VIMRUNTIME/ftplugin/man.vim
nnoremap K :Man <cword><cr> 
```

有时，这很有效。某些函数会按照您的预期显示手册页。其他人，例如，我收到错误“找不到'method_exists'。”。首先，我想知道手册页是否已过时，但看起来并非如此。

如果我`pman method_exists`从终端运行，我会看到预期的手册页。

有谁知道为什么只有一些手册页在 Vim 中正确显示？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T16:03:01.993

我发现按下时`K`只会显示某些关键字的手册页，因为这些关键字也有相关的手册页。我没有仔细检查手册页，没有注意到它不是针对 PHP 关键字的。

我必须指定 man 路径才能正常工作。我已将我的行更新为`~/.vimrc`以下内容：

```
source $VIMRUNTIME/ftplugin/man.vim
nnoremap K :Man --manpath=/usr/share/doc/php5-common/PEAR/pman/ <cword><cr> 
```

感谢您的帮助和建议！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:53:50.357

这可能是单词和单词之间的区别。参见`:help <cword>`与`<cWORD>`. 但是，您可能并不总是想要一个 WORD，因此您可能需要先在视觉上选择选择关键字，然后按`K`。

# node.js - Heroku 上的 NodeJS Zip 支持

> ID：12360936
> 
> 赞同：0
> 
> 时间：2012-09-10T23:51:31.987
> 
> 标签：node.js, express

我希望能够在 heroku 上压缩文件并将其发送回客户端。在本地，在开发过程中我使用[了这种方法](https://stackoverflow.com/a/6837589/5210)。效果很好。但是，如果你在 heroku 上这样做，你会得到一个错误：

```
zip stderr: execvp(): No such file or directory 
```

Heroku 的实例似乎不支持 zip。因此，我尝试使用[node-native-zip](https://github.com/janjongboom/node-native-zip)，这在本地工作，但是当我下载时文件已损坏，我无法通过 OSX 实用程序将其打开。但是，它通过 CLI 使用 unzip 打开（[已知问题](https://github.com/janjongboom/node-native-zip/issues/9)）。

所以问题是，如果我想在 heroku 上压缩一个文件夹并将其发送给用户，我应该使用什么 npm 模块？或者有没有我没有想到的更好或更简单的东西？我所追求的最终结果是能够通过浏览器轻松地将文件夹传递给最终用户。Zip 似乎是最好的方法。但是那里的图书馆似乎没有削减它。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T04:12:58.463

我最终使用[node-native-zip](https://github.com/donnfelker/node-native-zip)来解决我在 Heroku 上的压缩问题，并放弃了上面的方法，它运行良好。

# ios - 坐标的两位小数

> ID：12360939
> 
> 赞同：0
> 
> 时间：2012-09-10T23:52:04.290
> 
> 标签：ios, double, coordinate, double-precision

我正在尝试将字符串转换为双精度值以将其用作注释中的坐标。

我需要双精度值在地图上放置 5 个小数位。

假设字符串是`hello`，我需要的双精度是`whatsup`。

字符串的格式正是我想要的格式，我想让它成为双精度，所以我使用了字符串的 doublevalue 属性。

```
NSString *hello = @"12.61655";
double whatsup = hello.doubleValue;
NSLog(@"%f",whatsup); //this gives 12.616550 WITH A ZERO in the end
NSLog(@"%.5f",whatsup); //This gives me the correct value of 12.61655 with only 5 decimal places 
```

所以现在如果我想写：

```
coordinate.latitude = whatsup 
```

它给出了带有额外零的双倍。

我该怎么写

```
coordinate.latitude = SOMETHING HERE 
```

哪个是只有 5 个小数位的双精度数？
我可以在这里以某种方式实现“%.5f”吗？

已经尝试过 numberformatter，但它给了我一个 NSnumber。我需要一个双：

我在 for 循环中使用此代码来绘制注释（引脚）。

当我对双打使用相同的 forloop 时，我对其进行硬编码时效果很好。但是当我使用此代码从 csv 文件中获取值时，我没有得到任何引脚：

```
double latitudeFromCSV = [[components objectAtIndex:0] doubleValue];
double longitudeFromCSV = [[components objectAtIndex:1] doubleValue];
CLLocationCoordinate2D annotationCoord;
annotationCoord.latitude = latitudeFromCSV;
annotationCoord.longitude = longitudeFromCSV; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T00:10:12.520

查看 NSString 方法[-stringWithFormat：](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithFormat%3a)

但是为了让它变得更好，你需要删除前导零，因为你不知道不会有像@“12.50000”这样的值。

* * *

```
NSNumberFormatter * nf = [[NSNumberFormatter new] autorelease];
nf.maximumFractionDigits = 5;
NSLog(@"%@", [nf stringFromNumber:[NSNumber numberWithFloat:@"12.61655f".doubleValue]]); 
```

应该给你`12.61655`作为输出字符串。

# awk - 如何使用 grep/awk/sed 打印所有字符直到某个模式（不包括模式本身）？

> ID：12360942
> 
> 赞同：12
> 
> 时间：2012-09-10T23:52:44.227
> 
> 标签：awk, sed, grep

例如

```
echo "abc-1234a :" | grep <do-something> 
```

只打印`abc-1234a`

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-11T00:16:18.540

我认为这些更接近您的目标，但是在不知道您真正想要实现的目标的情况下，很难说。

```
echo "abc-1234a :" | egrep -o '^[^:]+' 
```

...虽然这也将匹配没有冒号的行。如果您只想要带有冒号的行，并且您*必须*只使用 grep，这可能会起作用：

```
echo "abc-1234a :" | grep : | egrep -o '^[^:]+' 
```

当然，这仅在您`echo "abc-1234a :"`是一个可能被多行输入替换的示例时才有意义。

您可以使用的最小工具可能是`cut`：

```
echo "abc-1234a :" | cut -d: -f1 
```

并且`sed`随时可用...

```
echo "abc-1234a :" | sed 's/ *:.*//' 
```

对于最后一个，如果您只想打印包含冒号的行，请将其更改为：

```
echo "abc-1234a :" | sed -ne 's/ *:.*//p' 
```

哎呀，你甚至可以在纯 bash 中做到这一点：

```
while read line; do
  field="${line%%:*}"
  # do stuff with $field
done <<<"abc-1234a :" 
```

有关该`%%`位的信息，您可以`man bash`搜索“*参数扩展*”。

**更新**：

你说：

> **它是冒号之前输入的第一行中的字符。输入可以有多行。**

那么，解决方案`grep`可能不是您的最佳选择，因为它们还会打印后续行中可能包含冒号的数据。当然，也有很多方法可以解决这个要求。我们将从示例输入开始：

```
$ function sample { printf "abc-1234a:foo\nbar baz:\nNarf\n"; }
$ sample
abc-1234a:foo
bar baz:
Narf 
```

您可以使用多个管道，例如：

```
$ sample | head -1 | grep -Eo '^[^:]*'
abc-1234a
$ sample | head -1 | cut -d: -f1      
abc-1234a 
```

或者您可以使用 sed 仅处理第一行：

```
$ sample | sed -ne '1s/:.*//p'
abc-1234a 
```

或者在打印第一行后告诉 sed 退出（这比读取整个文件要快）：

```
$ sample | sed 's/:.*//;q'
abc-1234a 
```

或者做同样的事情，但只在找到冒号时才显示输出（为了安全）：

```
$ sample | sed -ne 's/:.*//p;q'
abc-1234a 
```

或者让 awk 做同样的事情（分别作为最后 3 个示例）：

```
$ sample | awk '{sub(/:.*/,"")} NR==1'
abc-1234a
$ sample | awk 'NR>1{nextfile} {sub(/:.*/,"")} 1'
abc-1234a
$ sample | awk 'NR>1{nextfile} sub(/:.*/,"")'
abc-1234a 
```

或者在 bash 中，根本没有管道：

```
$ read line < <(sample)
$ printf '%s\n' "${line%%:*}"
abc-1234a 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-13T02:44:44.903

只用 sed 就可以做你想做的事。

这是一个例子：

```
#!/bin/sh
filename=$1
pattern=yourpattern

# flag -n disables print everyline (default behavior)
sed -n "
  1,/$pattern/ {
    /$pattern/n # skip line containing pattern
    p           # print lines ranging from line 1 untill pattern
  }
" $filename

exit 0 
```

这至少适用于 GNU 的 sed。它也应该适用于其他 sed，除了评论（sed 的一些实现不支持评论）。

来源：[https ://www.grymoire.com/Unix/Sed.html](https://www.grymoire.com/Unix/Sed.html)

# jquery - Ajax & Jquery - 表格的标题变成下拉列表

> ID：12360943
> 
> 赞同：0
> 
> 时间：2012-09-10T23:52:45.443
> 
> 标签：jquery, ajax, html-table

我有一个带有标题的 HTML 表格。

有谁知道一个 JQuery 脚本/插件，当您单击表格的标题时，标题会变成一个下拉列表，您可以从下拉列表中选择一个值（通过 AJAX 填充）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T00:10:41.407

您可能想尝试一下[数据表](http://www.datatables.net/examples/api/multi_filter_select.html)

# javascript - 交叉过滤器示例不起作用

> ID：12360945
> 
> 赞同：2
> 
> 时间：2012-09-10T23:53:13.667
> 
> 标签：javascript, d3.js, crossfilter

我从以下链接下载了 CrossFilter 示例：

[https://github.com/square/crossfilter/tree/gh-pages](https://github.com/square/crossfilter/tree/gh-pages)

它似乎不起作用。页面加载，但图表和表格没有加载。我必须先安装一些库还是其他什么？我已阅读 wiki 和自述文件，但没有找到有关如何使用该库或至少使示例工作的说明。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T22:49:08.953

大多数浏览器对通过 AJAX 从本地文件系统读取文件执行严格的权限。因此，您需要通过本地 Web 服务器加载示例，例如 Python 的内置服务器：

```
python -m SimpleHTTPServer 8888 & 
```

运行后，转到`http://localhost:8888/`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-30T14:32:13.957

只是添加更多说明...

确保您已添加`python`到路径环境变量。一旦你下载了一个 Crossfilter 示例（这个[航空公司示例](http://square.github.io/crossfilter/)可以在[这里](https://github.com/square/crossfilter/tree/gh-pages)下载/分叉），运行一个命令行或终端和 CD 到那个目录。

而且，如果您正在运行`python 3`，请使用以下命令：

`python -m http.server 8888 &`

# javascript - 使用 UglifyJS + GruntJS 进行条件编译

> ID：12360949
> 
> 赞同：3
> 
> 时间：2012-09-10T23:53:35.533
> 
> 标签：javascript, conditional-compilation, gruntjs, uglifyjs

我正在将[grunt-bbb](https://github.com/backbone-boilerplate/grunt-bbb)用于我正在处理的 JavaScript 项目。我很想使用 grunt 对 UglifyJS 的支持来使用条件编译，但我似乎无法让它工作。我正在尝试传递一个`defines`uglify 任务的选项，但它似乎不起作用。

我的 grunt.js 文件如下所示：

```
module.exports = function (grunt) {
    grunt.initConfig({

        // ... config options ...

        uglify: {
            "mangle": {
                "defines": {"DEBUG": false}
            }
        },

        // ... more configs ...

    });

    // ... custom tasks ...

    grunt.registerTask("release", "default min mincss");
}; 
```

我也尝试向对象添加一个`except`属性`mangle`，但这似乎也不起作用（它仍然会破坏文件......） UglifyJS 显然正在运行，但它似乎没有得到选项通过了。我也挖掘了代码，当`console.log(grunt.config('uglify'));`我得到

```
{ mangle: { defines: { DEBUG: false } } } 
```

这对我来说看起来是正确的......

有什么想法吗？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-04T18:07:39.063

这是目前对我有用的：

```
uglify: {
  options: {
    compress: {
      global_defs: {
        APP_DEBUG: false
      }
    }
  }
} 
```

把它放在 compress 选项中是可行的，在这种情况下，它会设置`APP_DEBUG=false` 我从这里得到这个修复：[https ://github.com/gruntjs/grunt-contrib-uglify/issues/12](https://github.com/gruntjs/grunt-contrib-uglify/issues/12)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T08:23:22.243

我向 Grunt 提交了一个[问题](https://github.com/cowboy/grunt/issues/426)，显然问题出在 Uglify 内部（`defines`实际处理参数的方式与文档相矛盾）。

以下代码有效：

```
uglify: {
  mangle: {
    defines: {
      DEBUG: ['name', 'true']
    }
  }
} 
```

[将此传递给 Uglify](https://github.com/mishoo/UglifyJS/issues/460)。

# ios - iOS AVFoundation 不同的静态图像和预览预设

> ID：12360950
> 
> 赞同：7
> 
> 时间：2012-09-10T23:53:45.170
> 
> 标签：ios, avfoundation, avcapturesession

有没有办法以中/低预设显示预览（例如从修改的帧），并以高/照片预设捕捉静止图像？更改预设不起作用，因为它要么失败，要么相机未能及时打开..

我在这里看到了一个类似的问题，似乎已经解决了，但我看不出这将如何显示低质量预览并捕获高质量的静止图像：

[拍摄照片时切换 AVCaptureSession 预设](https://stackoverflow.com/questions/12055350/switching-avcapturesession-preset-when-capturing-a-photo)

# javascript - 无法从 jQuery AJAX 请求中获得响应

> ID：12360951
> 
> 赞同：1
> 
> 时间：2012-09-10T23:53:46.793
> 
> 标签：javascript, jquery, ajax, firefox, google-chrome

当我希望客户端停止长轮询时，我会发回 AJAX 响应

```
"HUPWAIT" 
```

这就是萤火虫中的响应。

![FF 中的响应。](../Images/07d39f07aec481695119a11bdf50760b.png)

但是当我尝试在我的 js 中获取 AJAX 响应时，以下两个在 Firefox 和 IE9 中都返回 false：

```
$.ajax({
  url: "/wait",
  success: function(data) {
      console.log(data == "\"HUPWAIT\""); //returns false
      console.log(data == "HUPWAIT"); //also returns false
}); 
```

有趣的是，相同的代码在 Chrome 中返回 true：

```
$.ajax({
  url: "/wait",
  success: function(data) {
      console.log(data == "\"HUPWAIT\""); //returns true in Chrome
}); 
```

当我尝试使用以下代码在 Firefox（使用 firebug）中进行调试时，我得到了一个奇怪的响应：

```
$.ajax({
  url: "/wait",
  success: function(data) {
      console.log(data); //returns Document
      console.log(''+data); //returns [object XMLDocument]
}); 
```

标题看起来很正常：

```
HTTP/1.1 200 OK
Proxy-Connection: Keep-Alive
Connection: Keep-Alive
Transfer-Encoding: chunked
Via: XXXXXXXXXX
Date: Mon, 10 Sep 2012 23:40:34 GMT
Server: nginx/1.2.3 
```

但是在firebug的XML选项卡中有一些奇怪的东西：

```
XML Parsing Error: syntax error Location: moz-nullprincipal:{16915058-4ead-41ef-a63e-1265ee278d74} Line Number 1, Column 1:
"HUPWAIT"
 ^ 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T23:59:46.540

Firefox/IE 将尝试将 AJAX (X=XML) 响应解析为 XML 文档，从而产生您在调试器中看到的错误。向响应 ( `text/plain`) 添加“Content-Type”标头将强制浏览器正确处理文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T00:00:55.727

您是否尝试过`dataType`在 AJAX 调用中指定？

```
$.ajax({
    url: "/wait",
    dataType: "text",
    success: function(data) {
        console.log(data == "\"HUPWAIT\""); //returns false
        console.log(data == "HUPWAIT"); //also returns false
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T00:20:19.907

您还可以检查原始 responseText：

```
$.ajax({
    url: "/wait",
    success: function(data, status, jqXHR) {
    console.log(jqXHR.responseText == "\"HUPWAIT\"");
    console.log(jqXHR.responseText == "HUPWAIT");
    console.log(jqXHR.responseText);
}); 
```

# java - 我正在寻找全部大写且有空格的单词

> ID：12360953
> 
> 赞同：1
> 
> 时间：2012-09-10T23:54:02.590
> 
> 标签：java, regex

如果连续的大写单词在文档“I AM ALL UPPERCASE”中，我返回的是四个单独的大写单词。我需要的是返回整个大写“I AM ALL UPPERCASE”。我该怎么做呢？

```
String ucParensRegEx = "\([A-Z]+\)";
if (we.getParagraphText() != null) {
    String[] dataArray = we.getParagraphText();

    for (int i = 0; i < dataArray.length; i++) {
        String data = dataArray[i].toString();
        Pattern p = Pattern.compile(regex);
        Matcher m = p.matcher(data);
        while (m.find()) {
            if (!sequences.contains(data.substring(m.start(), m.end())) && !data.equals("ARABIC") && !data.equals("ALATEC") && !data.equals("HYPERLINK")) {
                sequences.add(data.substring(m.start(), m.end()));
                System.out.println(data.substring(m.start(), m.end()));
                Acronym acc = new Acronym(data.substring(m.start(), m.end()), data, false);
                accronymList.add(acc);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:12:56.543

你在寻找这样的东西吗？

```
String data="Some SENTENCE WITHOUT MEANING AnD OTHER PART OF that SenTENCE.";
String regex = "(\\b[A-Z]+\\b\\s*)+";
Pattern p = Pattern.compile(regex);
Matcher m = p.matcher(data);
while (m.find()) 
    System.out.println(m.group()); 
```

输出：

```
SENTENCE WITHOUT MEANING 
OTHER PART OF 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T01:16:35.440

试试这个正则表达式：

```
((?:\b[A-Z']+\b\s*)+) 
```

请注意，您可能需要正则表达式字符类中的撇号，因为它可能出现在大写单词中，就像在`ISN'T`.

Java代码：

```
 String sourcestring = "Hello there I AM ALL UPPERCASE and NONE of me is LOWERCASE. True? ISN'T IT Not!";
  Pattern re = Pattern.compile("((?:\\b[A-Z']+\\b\\s*)+)");
  Matcher m = re.matcher(sourcestring);
  int mIdx = 0;
    while (m.find()){
      for( int groupIdx = 0; groupIdx < m.groupCount()+1; groupIdx++ ){
        System.out.println( "[" + mIdx + "][" + groupIdx + "] = " + m.group(groupIdx));
      }
      mIdx++;
    } 
```

这匹配：

```
I AM ALL UPPERCASE 
NONE 
LOWERCASE
ISN'T IT 
```

[你可以在RegexPowertoy](http://regex.powertoy.org/?pat=%28%28%3F%3A%5Cb%5BA-Z%27%5D+%5Cb%5Cs%2a%29+%29&syn=javaSyntax&anim=0&rep=&in=Hello%20there%20I%20AM%20ALL%20UPPERCASE%20and%20NONE%20of%20me%20is%20LOWERCASE.%20True%3F%20ISN%27T%20IT%20Not%21%0ADoes%20JOHN%27S%20TEXT%20ALSO%20appear%20AS%20LOWERCASE%20or%20is%20it%20MORE%20mixed.%0AThis%20is%20WORTH%20DESCRIBING%21%20Isn%27t%20IT%3F%0A)玩这个

* * *

**更新：**

要匹配带有句点的首`U.S.`字母缩写词并避免使用单字母首字母缩写词`P.`，您可以将正则表达式修改为：

```
((?:[A-Z]\.){2,}|(?:\b[A-Z][A-Z']*\b[?!]?\s*)+) 
```

[在这里](http://regex.powertoy.org/?pat=%28%28%3F%3A%5Cb%5BA-Z%27.%5D+%5Cb%5C.%3F%5Cs%2a%29+%29&syn=javaSyntax&anim=0&rep=&in=Hello%20there%20I%20AM%20ALL%20UPPERCASE%20and%20NONE%20of%20me%20is%20LOWERCASE.%20True%3F%20ISN%27T%20IT%20Not%21%0ADoes%20JOHN%27S%20TEXT%20ALSO%20appear%20AS%20LOWERCASE%20or%20is%20it%20MORE%20mixed.%0AThis%20is%20WORTH%20DESCRIBING%21%20Isn%27t%20IT%3F%20How%20about%20U.S.%20currency%3F%0A)玩， 代码可以在[这里检查](http://www.myregextester.com/?r=4dbb517e)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T01:39:32.787

尝试`"\\b([A-Z][A-Z ]+[A-Z])\\b"`代替您的表达方式。

这应该匹配任何 AZ 序列或空格，只要它们在大写字母和两侧的单词边界之间 - 这应该有望覆盖大写单词的完整序列，除非您有一些关于允许的要求里面的数字。

# mysql - mysql插入逗号分隔的字符串不保存超过948个变量

> ID：12360954
> 
> 赞同：0
> 
> 时间：2012-09-10T23:54:06.513
> 
> 标签：mysql

我正在使用 PHP 在转换为逗号分隔字符串的数组中插入复选框 id，以便插入 MYSQL。工作，除了超过 948 个复选框。（每个州的金额不同）

为什么它不会插入超过 948 个逗号分隔值？

这是我的PHP代码：

```
 $teamsar2 = $_POST['teamarray2'];

         if ($teamsar2){$henry2 = implode(",",$teamsar2);}else{echo '';}

          $query = "UPDATE #__bl_teamcord SET teams='".$henry2."' WHERE s_id=".$sid."  AND u_id=(".intval($_POST['playerid']).")";
                $db->setQuery($query);
                $db->query(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T00:11:40.587

如果它在一定限度内正常工作，我会检查你的 max_allowed_pa​​cket 大小。你可能已经达到了极限。 [http://dev.mysql.com/doc/refman/5.5/en/packet-too-large.html](http://dev.mysql.com/doc/refman/5.5/en/packet-too-large.html)

# php - 如何从mysql数据库中获取一条记录中的每个元素

> ID：12360960
> 
> 赞同：0
> 
> 时间：2012-09-10T23:54:44.790
> 
> 标签：php, mysql

我试图在数据库'crop'的一个记录'Pests'中获取每个元素。实际上我的目的是在'Pests'字段中获取所有不同的害虫。

但是数据库中的“害虫”中不仅有一个元素。例如：

```
Name                                Pests 
```

* * *

```
Name1                              Grasshopper    
                                   Thrips    
                                   Potato Leafhoppe    
                                   Stink Bugs    
                                     ... ...

Name2                              Green Cloverworm
                                   Mexican Bean Bettle
                                   ... ... 
```

我的代码如下所示。但结果不是我想要的。这将显示每列中的所有害虫。但我想要所有列中所有不同的害虫，并在表格中显示每种害虫，比如

```
Pest | Grasshopper|Thrips|Potato Leafhoppe|Stink Bugs|Green Cloverworm|Mexican Bean Bettle|... ... 
```

如果有人能给我一些关于如何实现这一目标的提示，我将不胜感激。非常感谢！

```
$search = "SELECT distinct Pests from crop ORDER BY Pests ASC";
$result = mysql_query($search);

echo '<table>';
echo '<tr>';
while ($rs = mysql_fetch_row($result)){
       echo '<td>'.$rs[0].'</td>';
}
echo '</tr>';
echo '</table>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T01:13:10.017

简单的答案是您不应该在一个行单元格中存储多个值。SQL 操作不能处理这样的数据。

您需要像这样存储数据。

```
Name     Pest

Name1    Grasshopper    
Name1    Thrips    
Name1    Potato Leafhoppe    
Name1    Stink Bugs    
Name2    Green Cloverworm
Name2    Mexican Bean Bettle 
```

# ruby-on-rails - 将整个 ruby 应用程序降级到 1.8.7

> ID：12360961
> 
> 赞同：1
> 
> 时间：2012-09-10T23:54:51.363
> 
> 标签：ruby-on-rails, ruby, dreamhost, ruby-1.9.3, ruby-1.8.7

我已经使用 Ruby 1.9.3 在本地主机上构建了一个 rails 应用程序，它运行良好，并且可以在本地完成所有应该做的事情。但是，我使用dreamhost 作为这个应用程序的廉价主机，结果他们安装的乘客只支持1.8.7。

这有点问题，因为有很多文件使用 1.9 提供的“key:value”语法，而不是旧 Rails 版本的经典“:key=>value”语法。所以我的问题是，有什么方法可以快速更改所有这些语法问题，还是我被困在手动浏览文件以进行任何必要的更改？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T23:57:45.197

您可以使用命令行和各种 IDE 进行全局搜索和替换，但我建议您不要这样做。

原因是：

*   如今，大多数宝石都使用 1.9+，因此您可能会遇到问题。

*   大多数指南和教程现在假定为 1.9+

*   ruby 和 rails 都快速移动。随着 Ruby 2.0 的到来，Rails 4 即将推出。习惯于快速更改版本是我的建议。我来自一个更加稳定的背景，这对我来说是一个很大的变化。

*   当你决定需要升级到 1.9 时，你会在 2 或 3 个月内感到愚蠢

有很多支持 ruby​​ 1.9 的主机，heroku 是最好和最知名的。Heroku 的计划是从免费开始的，所以你无法在价格上打败它！对于付费计划 - 如果您花费 8 小时并节省了 80 美元，那么您每小时支付 10 美元，即接近最低工资。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T00:10:29.487

你可以选择 Heroku，它是免费的，直到你开始添加更多的测功机和工人。根据您的需要，另一种选择可能是 Webfaction。它们最高支持 1.9.3，并且能够自定义您自己的盒子。

# php - PHP总和特定键按其他2个排序

> ID：12360962
> 
> 赞同：0
> 
> 时间：2012-09-10T23:55:07.077
> 
> 标签：php, arrays

我只想总结 1 个键，但按其他 2 个键排序：

```
<?php
Array
(
    [0] => Array
        (
            [week] => 1
            [info] => a
            [hours] => 4
        )

    [1] => Array
        (
            [week] => 2
            [info] => a
            [hours] => 4
        )

    [2] => Array
        (
            [week] => 2
            [info] => a
            [hours] => 4
        )
    [3] => Array
        (
            [week] => 2
            [info] => b
            [hours] => 4
        )
    [4] => Array
        (
            [week] => 2
            [info] => c
            [hours] => 4
        )
    [5] => Array
        (
            [week] => 3
            [info] => b
            [hours] => 4
        )
    [6] => Array
        (
            [week] => 3
            [info] => b
            [hours] => 4
        )
)
?> 
```

我想总结按周排序的时间。每周都有信息。所以首先我想总结每个信息的小时数，然后按周对它们进行排序。

例子：

```
week:1  info:a   hours:4
week:2  info:a   hours:8
week:2  info:b   hours:4
week:2  info:c   hours:4
week:3  info:b   hours:8 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T23:59:18.787

您只需要重新排列数组：

```
$todisplay = array();
foreach ($weeks as $week) {
   //Does not properly check for set keys; you should do isset checks
   $todisplay[$week['week']][$week['info']] += $week['hours'];
}
ksort($todisplay); 
```

然后你可以迭代`todisplay`来构建表。

# iphone - 调用 CGImage 时的 EXEC_BAD_ACCESS

> ID：12360964
> 
> 赞同：0
> 
> 时间：2012-09-10T23:55:21.233
> 
> 标签：iphone, ios

我有以下代码：

```
UIImage *img = [UIImage imageNamed:@"BRBlueCircleMask"];
CGImageRef activeCirleMaskImage = img.CGImage;
activeCirleMaskLayer = [CALayer layer];
activeCirleMaskLayer.frame = CGRectMake(0, 0, 50, 50);
activeCirleMaskLayer.contents = CFBridgingRelease(activeCirleMaskImage); 
```

EXEC_BAD_ACCESS 70% 的时间发生在第二行（即有时它工作正常）。怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:03:21.730

从这个代码片段中问题并不明显，它应该可以正常工作，即使图像无法加载（图像引用最终会为 NULL）。

您可能在其他地方遇到了内存管理问题，并且/或者调试器对崩溃的位置感到困惑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T11:29:09.000

如下更改您的代码（另外，我假设您使用的是 ARC）。首先，我将在现有代码中添加注释，然后向您展示如何解决您的问题

```
// While this is a strong reference, ARC can release it after 'img.CGImage' (I have an accepted bug on this)
UIImage *img = [UIImage imageNamed:@"BRBlueCircleMask"];
// ARC should cause 
CGImageRef activeCirleMaskImage = img.CGImage;
 // you do not own the image, and a current ARC bug causes this object SOMETIMES to get released immediately after the assignment!!!
activeCirleMaskLayer = [CALayer layer];
activeCirleMaskLayer.frame = CGRectMake(0, 0, 50, 50);
activeCirleMaskLayer.contents = CFBridgingRelease(activeCirleMaskImage); // You are releasing an object here you don't own, which is the root cause of your problem 
```

更改您的代码如下

```
UIImage *img = [UIImage imageNamed:@"BRBlueCircleMask"];
// want to get the CGImage copied ASAP
CGImageRef activeCirleMaskImage = CGImageCreateCopy(img.CGImage); // now you own a copy
activeCirleMaskLayer = [CALayer layer];
activeCirleMaskLayer.frame = CGRectMake(0, 0, 50, 50);
activeCirleMaskLayer.contents = CFBridgingRelease(activeCirleMaskImage); // OK now, its your copy 
```

PS：如果有人不相信 CGImage 的激进发布是不真实的，我很乐意发布我的错误报告（以及显示问题的演示项目）

编辑：苹果已经解决了这个问题，我相信它在 iOS6 中。他们现在跟踪内部指针的使用并推迟释放内存，直到该指针超出范围。修复是在 SDK 和头文件中定义的，所以你需要链接到 iOS6 或 7 - 可能需要一个部署目标也不确定。

# android - 在 Android 中使用什么文档格式来呈现内容？

> ID：12360967
> 
> 赞同：3
> 
> 时间：2012-09-10T23:55:44.770
> 
> 标签：android, document, renderer

我正在寻找开发一个 Android 应用程序，用户可以在其中付费并下载出版物（主要是教材，可能是书籍、小册子等）到他们的手机上。我试图弄清楚要使用哪种文档格式，但不确定那里有什么以及什么适合我的需要。我看到的需求：

1.  在移动环境中呈现良好（PDF 和 HTML 可能已淘汰）
2.  至少允许文本、图像、层次结构（目录、部分、章节等）。2b。最好选择最终嵌入视频和声音（尽管这些不是交易破坏者）
3.  有一个免费/开源的渲染引擎/库（我的预算不允许很多）
4.  支持下载到设备以供离线查看（因此没有 Google Docs 或类似文件）
5.  通过 API 或内置到派生的 View 类轻松支持搜索功能
6.  是一种出版商已经可以使用的格式，无需我创建文档编辑工具。
7.  可以嵌入到应用程序中（不触发 Intents 或类似的）

我设想一个可以带入课堂环境的应用程序，无论是在手机还是平板电脑上，如果设备有 HDMI 输出或类似功能，它可以用来让老师的笔记、下载的材料等作为参考或可能输出到显示器。

有什么可以做到这一点，如果有的话？如果某些东西不完全符合要求，是否有任何接近的东西可能一些胶合逻辑或类似的东西可以将它变成可用的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T01:41:35.827

我不明白为什么 HTML 出来了。它满足您的大部分（如果不是全部）要求。而且，使用 WebView，它的渲染效果非常好。我将它用于我的所有帮助文件，它就像一个冠军。

如果您想将整个文档捆绑到单个文件中进行分发，那么 epub 是一个不错的选择。幸运的是，有一个适用于 Android 的 epub 库（尽管我还没有尝试过）。见[http://www.siegmann.nl/epublib/android](http://www.siegmann.nl/epublib/android)。[在这里](https://stackoverflow.com/questions/3645795/epub-library-for-java-or-android)讨论。可能还有其他人。使用 epub 很好，因为有许多免费工具可用于创建和编辑这些文档。

标记

# r - 对数据框进行长期到更广泛的重塑

> ID：12360969
> 
> 赞同：1
> 
> 时间：2012-09-10T23:55:51.723
> 
> 标签：r, reshape2

我有以下格式的半长数据框：

```
| Id | Alt | Choice | Var1 | Var2 |
|----+-----+--------+------+------|
|  1 | a   | TRUE   | 58.2 |    4 |
|  1 | b   | FALSE  | 71.6 |    5 |
|  2 | a   | FALSE  | 14.8 |    2 |
|  2 | b   | TRUE   | 82.1 |    5 | 
```

...我想重塑为以下格式：

```
| Id | Choice.a | Choice.b | Var1.a | Var1.b | Var2.a | Var2.b |
|----+----------+----------+--------+--------+--------+--------|
| 1  | TRUE     | FALSE    | 58.2   | 71.6   | 4      | 5      |
| 2  | FALSE    | TRUE     | 14.8   | 82.1   | 2      | 5      | 
```

我一直在想，我应该能够做类似的事情：

```
library(reshape2)
dcast(df, ... ~ Alt) 
```

但这并不完全正确。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T00:11:05.403

这不是使用“plyr”，而是使用基本功能`reshape`：

```
 dat <- read.table(text=" Id | Alt | Choice | Var1 | Var2 
  1 |a| TRUE   | 58.2 |    4 
  1 |b| FALSE  | 71.6 |    5 
  2 |a| FALSE  | 14.8 |    2
  2 |b| TRUE   | 82.1 |    5
 ", sep="|", header=TRUE)
 reshape(dat, direction="wide", idvar="Id", timevar="Alt")
#-----------------
  Id Choice.a Var1.a Var2.a Choice.b Var1.b Var2.b
1  1  TRUE      58.2      4  FALSE     71.6      5
3  2  FALSE     14.8      2  TRUE      82.1      5 
```

如果您需要显示的精确顺序，使用“[”就足够了。想象一下，我们将 reshape() 的结果分配给“wdat”：

```
wdat[c(1,2,5,3,6,4,7)]
#===============
  Id Choice.a Choice.b Var1.a Var1.b Var2.a Var2.b
1  1  TRUE     FALSE     58.2   71.6      4      5
3  2  FALSE    TRUE      14.8   82.1      2      5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T00:13:13.937

您要做的是更改`value`每次使用的列。您将无法在一次调用中执行此操作`dcast`

这是一个使用`lapply`and`Reduce`合并结果的示例

```
library(plyr) #for . and rename
df <- data.frame(Id = rep(1:2,each=2), Alt = c('a','b'),Choice = c(T,F,F,T), Var1= c(58.2,71.6,14.8,82.1),Var2 =c(4,5,2,5))  

by_cols <- c('Choice','Var1','Var2')
df_list <- lapply(by_cols, function(value, data, formula = Id~Alt) {
     new <- dcast(data, formula, value.var = value )
     # rename not just a a
     unique_alt <- unique(data[[as.character(formula)[3]]])
     rename(new, setNames(paste(value, unique_alt, sep='.'), unique_alt))},
       data = df)

Reduce(function(x,y){merge(x,y,by='Id',all=T)}, df_list)

##   Id Choice.a Choice.b Var1.a Var1.b Var2.a Var2.b
## 1  1     TRUE    FALSE   58.2   71.6      4      5
## 2  2    FALSE     TRUE   14.8   82.1      2      5 
```

# 矢量化 dcast

您可以使用`Vectorize`创建矢量化版本`dcast`

```
dcast.vector <- Vectorize(dcast, vectorize.args = 'value.var', SIMPLIFY = F)

df_list <- dcast.vector(df, Id ~ Alt, value.var = by_cols) 
```

您仍然需要`wide`从 just 重命名列`a`，`b`

```
 old_names <- c('a','b')
 new_names <- setNames(lapply(by_cols, paste, old_names, sep = '.'), by_cols)
 df_list <- mapply(rename, df_list, replace = new_names, SIMPLIFY = F) 
```

你还需要`Reduce`一步

```
 Reduce(function(x,y){merge(x,y,by='Id',all=T)}, df_list) 
```

基础 R 重塑是一个更直接的解决方案。

# c# - asp.net MVC 4 外部登录提供程序 - '未找到 OpenID 端点'（谷歌）

> ID：12360971
> 
> 赞同：3
> 
> 时间：2012-09-10T23:56:07.797
> 
> 标签：c#, asp.net-mvc, oauth, openid, asp.net-4.5

我正在学习 MVC 4 (Visual Studio Express 2012) 并尝试使用在 openId/OAuth 外部登录支持中烘焙的新模板。我一直在关注[这个教程](http://blogs.msdn.com/b/webdev/archive/2012/08/15/oauth-openid-support-for-webforms-mvc-and-webpages.aspx)

到目前为止，我所做的只是创建一个带有表单身份验证的新 MVC 4 互联网应用程序，并取消注释文件`OAuthWebSecurity.RegisterGoogleClient();`中的行`AuthConfig.cs`。

从股票模板更改一行代码似乎应该很容易，但是当我运行项目时，当我单击 google 按钮时，我得到一个“未找到 OpenID 端点”异常。

请记住，我之前没有尝试使用 OAuth/OpenID 做任何事情的经验。

这可能与我在我的开发机器上从本地主机上运行它的事实有关吗？或者其他一些环境变量，比如我们的公司代理服务器/防火墙？

我从[本教程](http://www.asp.net/web-pages/tutorials/security/enabling-login-from-external-sites-in-an-aspnet-web-pages-site)中得到的印象是，您可以从 localhost 进行测试（至少对于 Google 而言）。

还是该错误有其他原因？

在回答之前，请注意我不想编写自定义代码来使其正常工作。我想使用股票模板。

* * *

# 更新

我在家里试过了，在本地主机上没有问题。一定和我工作场所的网络环境有关。可能是防火墙或代理。如果有人有任何建议，我仍然希望让这个工作正常工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T10:36:19.920

据我所知，您正确地遵循了本教程，但使用 Google 似乎有点粗略。这有更多细节：http: [//blogs.msdn.com/b/webdev/archive/2012/09/12/integrate-openauth-openid-with-your-existing-asp-net-application-using-universal-providers .aspx](http://blogs.msdn.com/b/webdev/archive/2012/09/12/integrate-openauth-openid-with-your-existing-asp-net-application-using-universal-providers.aspx)并且可能会提供更好的分步操作。

特别要注意本教程开头的 NuGet 包。除了获得工作所需的 .dll 程序集外，NuGet 包还经常更改`Web.Config`文件，我希望在该文件中找到您的 Oauth 提供程序的端点信息。如果您没有安装所有这些软件包，您可能会丢失一些配置设置。

我没有你所说的具体项目模板，所以我无法检查：你能发布你的 web.config 吗？那里可能有一些需要调整的地方。

哦，还有一个关于编写自己的 Google 提供程序的教程，看起来很简单：http: [//blogs.msdn.com/b/webdev/archive/2012/08/23/plugging-custom-oauth-openid-providers .aspx](http://blogs.msdn.com/b/webdev/archive/2012/08/23/plugging-custom-oauth-openid-providers.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T09:22:19.587

我在 localhost 上与 OAuth 提供程序有类似的问题，不确定这是否真的是您的问题的原因，但如果我正在做任何 OAuth 的事情，我总是确保我在端口 80 上运行并添加一行：

```
127.0.0.1     www.local.com 
```

到`C:\Windows\System32\drivers\etc`（您需要以管理员身份在记事本中打开），然后不要`http://localhost:1234`只是去`http://www.local.com`尝试一下。它可能无法解决问题，但排除了一件事，希望对您有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-03T14:49:34.340

如果您仅在办公室遇到此问题，则代理可能是问题所在。将代理自动检测配置添加到项目`Web.config`文件中应该可以解决问题：

```
<configuration>
  ...
  <system.net>
   <defaultProxy useDefaultCredentials="True">
    <proxy autoDetect="True" usesystemdefault="True" />
   </defaultProxy>
  </system.net>
</configuration> 
```

# html - 需要将图像固定到页面上的特定位置

> ID：12360973
> 
> 赞同：4
> 
> 时间：2012-09-10T23:56:30.723
> 
> 标签：html, image, scroll, css-position

我需要将 .gif 图像修复到主页上的特定位置。我已将图像放在我的 HTML 中，但“位置：固定”并没有做我想要的 - 页面的其余内容在图像下方滚动。我希望图像始终保持在同一个位置。

免责声明：我对 HTML 和 CSS 几乎一无所知，所以如果这是一个非常简单的问题，我深表歉意。我已经进行了研究，但我尝试过的任何方法似乎都不起作用。

在相关说明中，我的图像会根据我正在查看我的网站的浏览器来改变大小。我在这里阅读了另一个问题的答案，您可以通过使用百分比而不是像素来格式化您的对象来解决这个问题，但我试过了并且问题依然存在。

其他注意事项：我使用 Chrome 作为浏览器，并且正在使用 Weebly 构建我的网站。我的网站地址是[http://www.designartistree.com/](http://www.designartistree.com/)和有问题的图像在页面中间的大“Design Artistree”标志下方的丝带。

任何对初学者友好的建议将不胜感激！谢谢！

这是我为图像提供的 html 代码：

```
<img src="/files/theme/ribbon.gif" alt="ribbon" style="position:fixed; margin-left:27.6%; margin-top:61%; width:63.7%; height:10%; z-index:50; visibility:show"> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T00:13:53.013

如果使用`position:fixed`，则元素相对于窗口定位，因此即使滚动，元素也不会移动。

如果您希望它在滚动时移动，请使用`position:absolute`.

但是由于您的布局，您有两个选择：

*   把图片放在里面`#box`
*   删除以下代码：

```
html{
    overflow:hidden;
    height: 100%;
    max-height: 100%;
}
body {
    height: 100%;
    max-height: 100%;
    width: 100%;
}
#box {
    height: 100%;
    max-height: 100%;
    overflow: auto;
    width: 100%;
} 
```

# scala - 任务的 SBT 之前/之后挂钩

> ID：12360974
> 
> 赞同：3
> 
> 时间：2012-09-10T23:56:32.703
> 
> 标签：scala, sbt

[（从这里](https://groups.google.com/forum/?fromgroups=#!topic/simple-build-tool/XVr_bwOCKkI)转贴）

我正在尝试测量/记录任务的运行时间。

我已经研究过通过在之前添加一个任务和之后添加一个任务来“包装”一个任务，但这不会每次都有效，因为 sbt 只能保证部分顺序。

更好的包装应该是这样的：

```
wrappedTask := {
  startMeasuringTime()
  somehowInvoke(myTaskKey in SomeContext)
  endMeasuringTime()
} 
```

这个“somehowInvoke”应该是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:45:03.473

Measuring the time taken by a task needs support from the task executor. As you imply, you cannot do this only by using task primitives. I've pushed some [sample code](https://github.com/harrah/xsbt/tree/feature/task_progress) that I wrote a while back that shows the idea.

A complication that the sample code doesn't handle is that what the user conceptually thinks of as one task (compile, for example) may actually be implemented as several tasks and those timings would need to be combined. Also, a task like `internalDependencyClasspath` "calls" other tasks (flatMap) and so its execution time includes the execution time of the "called" tasks.

EDIT: This was implemented for 0.13.0 as an experimental feature in [602c1759a1885](https://github.com/sbt/sbt/commit/602c1759a18852612488fbed784ddda0e9d3dda3) and [1cc2f57e158389759](https://github.com/sbt/sbt/commit/1cc2f57e158389759c77c62bacade638d83ec12c). The ExecuteProgress interface provides sufficient information that the previously described issues are not a problem.

# php - Foreach WHERE 子句？

> ID：12360981
> 
> 赞同：-3
> 
> 时间：2012-09-10T23:57:29.457
> 
> 标签：php, mysql, xml, lang

我想弄清楚如何使用 xml 和 php 处理多语言？我希望能够默认使用英语，但是如果用户选择了一种语言，比如说德语，我想将语言更改为该语言。这部分我可以弄清楚，但如果某个语言字符串尚未翻译成德语，我希望能够选择该字符串的英文版本。我已经用常规的 php 和 mysql 做到了这一点，如下所示：

```
$language = "de";
$sql = "SELECT * FROM ".$prefix."_countries WHERE con_id=$language"; 
$result = mysql_query($sql) ;
$row = mysql_fetch_assoc($result);

$userlang = $row['lang'];

$languagestring = array();
$res1 = mysql_query("SELECT * FROM ".$prefix."_language WHERE lang = 'en'");
while($row1 = mysql_fetch_assoc($res1)){

    $langid = $row1['id'];

    $res = mysql_query("SELECT * FROM ".$prefix."_language WHERE fk_id = $langid AND lang = '$userlang'");
    $row = mysql_fetch_assoc($res);

    if(!$row){
        $languagestring[] = $row1['text'];
    } else {
        $str = $row['text'];
        $languagestring[] = $str;
    }

} 
```

现在我已经以与数据库相同的方式构建了我的 xml，如下所示：

```
<data>
  <record id="1">
    <fk_id>0</fk_id>
    <lang>en</lang>
    <text>Network Error</text>
  </record>
  <record id="2">
    <fk_id>0</fk_id>
    <lang>en</lang>
    <text>There is a problem with the network!</text>
  </record>
  <record id="3">
    <fk_id>0</fk_id>
    <lang>en</lang>
    <text>OK</text>
  </record>
  <record id="4">
    <fk_id>1</fk_id>
    <lang>de</lang>
    <text>Das netvaerk sind corrupt!</text>
  </record> 
```

' 我怎样才能用 xml 完成我对 mysql 所做的事情？

任何帮助表示赞赏:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T00:05:40.210

有标准可以做这些事情，不需要 XML！对于翻译，最常见的方法是使用 gettext，这在开源世界中非常流行。

此外，gettext 中使用的 MO 文件是编译文件，这意味着它们比解析 XML 快得多。

看看[http://php.net/manual/en/function.gettext.php](http://php.net/manual/en/function.gettext.php)

要创建 PO 和 MO 文件，我建议使用[PoEdit](http://www.poedit.net/)或[Virtaal](http://translate.sourceforge.net/wiki/virtaal/index)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T02:15:20.650

在 XQuery 中，您会这样说（未经测试）：

```
declare variable $userlang as xs:language external;

for $msg in /data/record[lang='en']
return (/data/record[lang=$userlang 
    and fk_id=$msg/@id], $msg)[1] 
```

英语：变量`$userlang`在外部设置为语言代码。对于每个`record`包含`<lang>en</lang>`，如果存在，则返回用户语言的对应记录，否则返回英文记录。（更具体地说：对于每个这样的记录，制作一个由用户语言的相应记录组成的序列，然后是英语记录，然后取该序列中的第一项。）

在 XSLT 2.0 中，您可以做一些非常相似的事情（我在示例中使用 XQuery 部分是因为它更简洁，部分是因为它的逻辑感觉更像您当前代码的结构）。

在您可以访问 XPath 的其他语言中，您可能能够做大致类似的事情，尽管`return`如果您只有 XPath 1.0，您可能不得不用一些应用程序逻辑替换表达式。

# c# - C#GetMethod 不返回父方法

> ID：12360985
> 
> 赞同：12
> 
> 时间：2012-09-10T23:58:02.800
> 
> 标签：c#, inheritance, methods, static, getmethod

我有以下类树：

```
public class A
{
    public static object GetMe(SomeOtherClass something)
    {
        return something.Foo();
    }
}

public class B:A
{
    public static new object GetMe(SomeOtherClass something)
    {
        return something.Bar();
    }
}

public class C:B
{

}

public class SomeOtherClass
{

} 
```

给定`SomeOtherClass parameter = new SomeOtherClass()`）这有效：

```
typeof(B).GetMethod("GetMe", new Type[] { typeof(SomeOtherClass) })).Invoke(null, parameter)); 
```

但是这个：

```
typeof(C).GetMethod("GetMe", new Type[] { typeof(SomeOtherClass) })).Invoke(null, parameter)); 
```

抛出一个`NullReferenceException`，而我希望它会调用与上面完全相同的方法。

我尝试了几个绑定标志无济于事。有什么帮助吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-11T00:02:42.517

您应该使用带参数的[重载](http://msdn.microsoft.com/en-us/library/zt2ztzdc)`BindingFlags`之一，并包含`FlattenHierarchy`.

> 指定应返回层次结构上的公共和受保护静态成员。不返回继承类中的私有静态成员。静态成员包括字段、方法、事件和属性。不返回嵌套类型。

（编辑删除了关于私有静态方法的观点，现在问题已更改为将它们公开。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-11T00:02:52.703

您需要将`BindingFlags.FlattenHierarchy`标志传递给以`GetMethod`向上搜索层次结构：

```
typeof(C).GetMethod("GetMe", BindingFlags.FlattenHierarchy, null, new Type[] { typeof(SomeOtherClass) }, null)).Invoke(null, parameter)); 
```

# matlab - 在 MATLAB 中修剪自相关结果

> ID：12360988
> 
> 赞同：0
> 
> 时间：2012-09-10T23:58:38.363
> 
> 标签：matlab, correlation

我正在使用 xcorr2(A,A) 来计算自相关。但是，输出大于 A。我应该如何修剪输出以找到正确的自相关矩阵？例如，我的 A 矩阵为 51x51，输出为 101x101。很明显，中心点与自身具有最大的相关性，在这种情况下位于 (26,26)，但在新的自相关图中，它位于 (51,51)。我需要一种通用方法来修剪最终输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T00:23:56.860

一般来说，假设 A 是 M×N 矩阵，您必须在第一维中从 M/2 到 3M/2 取 M 个点，在第二维^中^从N/2 到 3N/2 取 N 个点：

```
[M, N] = size(A);
cor = xcorr2(A);  %# Shorter form of xcorr(A, A)
C = cor(ceil(M / 2):floor(3 * M / 2), ceil(N / 2):floor(3 * N / 2)) 
```

这`C`将是修剪后的输出。

**编辑：**
对于任何两个矩阵`A`和`B`，结果`xcorr2(A, B)`将是 (M [A] +M [B] -1)×(N [A] +N [B] -1) 矩阵。但是，在这里，如果矩阵的维度不同，您必须自己决定要提取哪个部分。如果要提取重要的中心部分，可以这样做：

```
[MA, NA] = size(A);
[MB, NB] = size(B);
v = [MA + MB, NA + NB] / 4; %# Just a temporary vector
cor = xcorr2(A, B);
C = cor(ceil(v(1)):floor(3 * v(1)), ceil(v(2)):floor(3 * v(2)) 
```

# css - 有没有类似自动线高的东西？

> ID：12360992
> 
> 赞同：31
> 
> 时间：2012-09-10T23:58:56.187
> 
> 标签：css

我有一个固定尺寸的 CSS 框，足以容纳我的任何文本。我不希望文本末尾和底部框边框之间有空白。我怎样才能把它们装进盒子里？像扩展行高以适应。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-22T19:52:26.847

```
line-height: normal; 
```

是正确的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T00:00:26.793

试试`vertical-align:bottom`。

如果这不起作用，您可以尝试`line-height: 1em`

如果那仍然不能满足您的要求，则必须进一步阐明您要实现的目标。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-09-11T00:22:43.227

抱歉，只有 JavaScript 才有可能。

# c++ - cUrl 命令 C++ 代码替换

> ID：12360994
> 
> 赞同：0
> 
> 时间：2012-09-10T23:59:22.170
> 
> 标签：c++, c, qt, curl, libcurl

我有这个 cUrl 命令，我需要在 Linux 下的 C++ 程序中执行，我正在使用 Qt 如何并包含 libcUrl，我需要知道与此 cUrl 命令等效的确切方法调用：

```
curl -d 'grant_type=client_credentials&client_id=mdme2323&client_secret=asdaeqwedsa24124ewesiou&scope=http://api.microsofttranslator.com' https://datamarket.accesscontrol.windows.net/v2/OAuth2-13 | python -m json.tool 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T01:42:18.047

在新进程中执行命令怎么样？

```
QString cmd("curl -d 'grant_type=client_credentials&client_id=mdme2323&client_secret=asdaeqwedsa24124ewesiou&scope=http://api.microsofttranslator.com' https://datamarket.accesscontrol.windows.net/v2/OAuth2-13 | python -m json.tool");
QProcess::execute(cmd); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T02:55:18.650

这是我修复它的方法：

```
QProcess* proc = new QProcess();
QString cmd( "/bin/sh" );
QStringList args;
args << "-c" << "curl -d 'grant_type=client_credentials&client_id=islam123&client_secret=23ewsed323we2ewesiou&scope=http://api.microsofttranslator.com' https://datamarket.accesscontrol.windows.net/v2/OAuth2-13";
proc->execute(cmd, args);
data = proc->readAll(); 
```

# ruby-on-rails - 带有 wicked_pdf 的页面特定页眉/边距？

> ID：12360995
> 
> 赞同：1
> 
> 时间：2012-09-10T23:59:22.280
> 
> 标签：ruby-on-rails, wicked-pdf

我有一个使用 wicked_pdf 生成 PDF 文件（报告）的 rails 3.2 应用程序。

我的 PDF 有一个边到边的图像，它构成了第一页的页眉，但在其余页面上没有页眉。

我正在寻找一种方法，要么只在第一页上有一个标题，要么在第 2 页及以后有不同的边距设置。我会考虑的另一个选择是，如果我可以只有两个不同的标题，一个用于第一页，一个用于第 2 页及以后。有任何想法吗？

相关宝石版本：

导轨 (3.2.2)

wicked_pdf (0.7.9)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T02:21:46.237

您可以将其作为 2 个单独的 PDF 执行，然后将它们与 pdftk 合并在一起。

# python - 使用 pyPDF 从文档中检索页码

> ID：12360999
> 
> 赞同：27
> 
> 时间：2012-09-10T23:59:52.157
> 
> 标签：python, pypdf

目前，我正在考虑将一些 PDF 与 pyPdf 合并，但有时输入的顺序不正确，因此我正在考虑抓取每个页面的页码以确定它应该进入的顺序（例如，如果有人将一本书分成 20 个 10 页的 PDF，我想将它们重新组合在一起）。

我有两个问题 - 1.) 我知道有时页码存储在文档数据中的某处，因为我看到在 Adob​​e 上呈现的 PDF 类似于 [1243]（150 中的 10），但我读过此类文档转换为 pyPDF，但我找不到任何指示页码的信息 - 它存储在哪里？

2.) 如果第 1 大道不可用，我想我可以遍历给定页面上的对象以尝试找到页码 - 可能它是它自己的对象，其中有一个数字。但是，我似乎找不到任何明确的方法来确定对象的内容。如果我运行：

```
pdf.getPage(0).getContents() 
```

这通常会返回：

```
{'/Filter': '/FlateDecode'} 
```

或者它返回 IndirectObject(num, num) 个对象的列表。我真的不知道如何处理其中任何一个，据我所知，也没有关于它的真正文档。有没有人熟悉这种可以为我指明正确方向的事情？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-07-29T18:14:23.913

以下对我有用：

```
from PyPDF2 import PdfFileReader
pdf = PdfFileReader(open('path/to/file.pdf','rb'))
pdf.getNumPages() 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-11-07T23:55:02.767

其他答案使用 PyPDF/PyPDF2 似乎可以读取整个文件。对于大文件，这需要很长时间。

与此同时，我写了一些快速而肮脏的东西，运行时间几乎没有。它会进行 shell 调用，但我不知道有任何其他方法可以做到这一点。它可以非常快速地获取大约 5000 页的 pdf 的页数。

它只需调用“pdfinfo”shell 命令即可工作，因此它可能仅适用于 linux。到目前为止，我只在 ubuntu 上测试过它。

我见过的一个奇怪的行为是，在 try/except 块中围绕它不会捕获错误，你必须排除 subprocess.CalledProcessError。

```
from subprocess import check_output
def get_num_pages(pdf_path):
    output = check_output(["pdfinfo", pdf_path]).decode()
    pages_line = [line for line in output.splitlines() if "Pages:" in line][0]
    num_pages = int(pages_line.split(":")[1])
    return num_pages 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-11T15:36:37.783

有关完整文档，请参阅 Adob​​e 的 978 页[PDF 参考](http://partners.adobe.com/public/developer/en/pdf/PDFReference.pdf)。:-)

更具体地说，PDF 文件包含指示 PDF 的物理页面如何映射到逻辑页码以及页码应该如何格式化的元数据。这是您获取规范结果的地方。[本页的](http://www.w3.org/WAI/GL/WCAG20-TECHS/PDF17.html)示例 2显示了它在 PDF 标记中的外观。你必须把它找出来，解析它，然后自己执行映射。

在 PyPDF 中，要获取此信息，请尝试作为起点：

```
pdf.trailer["/Root"]["/PageLabels"]["/Nums"] 
```

顺便说一句，当你看到一个`IndirectObject`实例时，你可以调用它的`getObject()`方法来检索实际指向的对象。

正如您所说，您的替代方法是检查文本对象并尝试找出哪个是页码。您可以`extractText()`为此使用页面对象，但您会得到一个字符串，并且必须尝试从中找出页码。（当然，页码可能是罗马字母或字母而不是数字，有些页面可能没有编号。）相反，看看`extractText()`它的实际工作是如何的——毕竟 PyPDF 是用 Python 编写的——并将其用作一个例程的基础，它分别检查页面上的每个文本对象以查看它是否像页码。警惕上面有很多页码的目录/索引页面！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-03-01T17:04:03.770

kindall的回答非常好。但是，由于后来（由梦想家）请求了一个工作代码示例，并且由于我今天遇到了同样的问题，所以我想添加一些注释。

1.  pdf结构不统一；您可以依赖的东西很少，因此任何工作代码示例都不太可能适用于所有人。[在这个答案](https://stackoverflow.com/a/12925195)中可以找到一个很好的解释。

2.  正如 kindall 所解释的，您很可能需要探索您正在处理的 pdf。

像这样：

```
import sys
import PyPDF2 as pyPdf

"""Open your pdf"""
pdf = pyPdf.PdfFileReader(open(sys.argv[1], "rb"))

"""Explore the /PageLabels (if it exists)"""

try:
    page_label_type = pdf.trailer["/Root"]["/PageLabels"]
    print(page_label_type)
except:
    print("No /PageLabel object")

"""Select the item that is most likely to contain the information you desire; e.g.
       {'/Nums': [0, IndirectObject(42, 0)]}
   here, we only have "/Num". """

try:
    page_label_type = pdf.trailer["/Root"]["/PageLabels"]["/Nums"]
    print(page_label_type)
except:
    print("No /PageLabel object")

"""If you see a list, like
       [0, IndirectObject(42, 0)]
   get the correct item from it"""

try:
    page_label_type = pdf.trailer["/Root"]["/PageLabels"]["/Nums"][1]
    print(page_label_type)
except:
    print("No /PageLabel object")

"""If you then have an indirect object, like
       IndirectObject(42, 0)
   use getObject()"""

try:
    page_label_type = pdf.trailer["/Root"]["/PageLabels"]["/Nums"][1].getObject()
    print(page_label_type)
except:
    print("No /PageLabel object")

"""Now we have e.g.
       {'/S': '/r', '/St': 21}
   meaning roman numerals, starting with page 21, i.e. xxi. We can now also obtain the two variables directly."""

try:
    page_label_type = pdf.trailer["/Root"]["/PageLabels"]["/Nums"][1].getObject()["/S"]
    print(page_label_type)
    start_page = pdf.trailer["/Root"]["/PageLabels"]["/Nums"][1].getObject()["/St"]
    print(start_page)
except:
    print("No /PageLabel object") 
```

3.  正如您从 ISO pdf 1.7 规范（[此处](https://stackoverflow.com/a/12925195)的相关部分）中看到的那样，如何标记页面有很多可能性。作为一个简单的工作示例，请考虑这个脚本，它至少可以处理十进制（阿拉伯）和罗马数字：

脚本：

```
import sys
import PyPDF2 as pyPdf

def arabic_to_roman(arabic):
    roman = ''
    while arabic >= 1000:
      roman += 'm'
      arabic -= 1000
    diffs = [900, 500, 400, 300, 200, 100, 90, 50, 40, 30, 20, 10, 9, 5, 4, 3, 2, 1]
    digits = ['cm', 'd', 'cd', 'ccc', 'cc', 'c', 'xc', 'l', 'xl', 'xxx', 'xx', 'x', 'ix', 'v', 'iv', 'iii', 'ii', 'i']
    for i in range(len(diffs)):
      if arabic >= diffs[i]:
        roman += digits[i]
        arabic -= diffs[i]
    return(roman)

def get_page_labels(pdf):
    try:
        page_label_type = pdf.trailer["/Root"]["/PageLabels"]["/Nums"][1].getObject()["/S"]
    except:
        page_label_type = "/D"
    try:
        page_start = pdf.trailer["/Root"]["/PageLabels"]["/Nums"][1].getObject()["/St"]
    except:
        page_start = 1
    page_count = pdf.getNumPages()
    ##or, if you feel fancy, do:
    #page_count = pdf.trailer["/Root"]["/Pages"]["/Count"]
    page_stop = page_start + page_count 

    if page_label_type == "/D":
        page_numbers = list(range(page_start, page_stop))
        for i in range(len(page_numbers)):
            page_numbers[i] = str(page_numbers[i])
    elif page_label_type == '/r':
        page_numbers_arabic = range(page_start, page_stop)
        page_numbers = []
        for i in range(len(page_numbers_arabic)):
            page_numbers.append(arabic_to_roman(page_numbers_arabic[i]))

    print(page_label_type)
    print(page_start)
    print(page_count)
    print(page_numbers)

pdf = pyPdf.PdfFileReader(open(sys.argv[1], "rb"))
get_page_labels(pdf) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-09-08T23:15:48.100

另一个选项是 pymupdf： [https ://pymupdf.readthedocs.io/en/latest/tutorial.html](https://pymupdf.readthedocs.io/en/latest/tutorial.html)

```
import fitz

doc = fitz.open('Path To File')
doc.pageCount 
```

`pip install pymupdf`

对于大型文档，我在使用 pypdf2 时遇到递归错误，所以这是另一种快速简单的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-11-24T08:38:56.613

# 使用 Python 从 doc 获取页码

**PyMuPDF**

```
import fitz
doc = fitz.open('source_path')
print(doc.pageCount)
# prints total page count of input PDF 
```

**PyPDF2**

```
import PyPDF2
pdfFileObj = open('source.pdf', 'rb')
pdfReader = PyPDF2.PdfFileReader(pdfFileObj)
print(pdfReader.numPages)
#get totalnumber of pages and page numbering in PyPDF2 starts with 0
pageObj = pdfReader.getPage(0)
pageObj.extractText()
pdfFileObj.close() 
```

**PDFinfo** pdfinfo : 提取 PDF 文件中 Info 字典的内容。Xpdf 项目的另一部分。

```
pdfinfo filename.pdf
**Output**
Title:          HILs.pdf
Subject:
Keywords:
Author:        
Creator:        Acrobat PDFMaker 10.0 for Word
Producer:       Acrobat Distiller 9.3.0 (Windows)
CreationDate:   Mon Jun  2 11:16:53 2014
ModDate:        Mon Jun  2 11:16:53 2014
Tagged:         no
Pages:          3
Encrypted:      no
Page size:      612 x 792 pts (letter)
File size:      39177 bytes
Optimized:      yes
PDF version:    1.5 
```

**PDFminer**

```
from pdfminer.pdfpage import PDFPage
infile = file(fname, 'rb')
print(PDFPage.pagenums(infile)) 
```