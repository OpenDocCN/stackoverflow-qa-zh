# StackOverflow 问答 000717000-000717999

# php - XML 作为 PHP 应用程序的数据层

> ID：717003
> 
> 赞同：4
> 
> 时间：2009-04-04T12:39:44.330
> 
> 标签：php, xml

我想知道我应该如何为一个相当简单的 php 网站编写 XML 数据层。原因如下：

1.  数据库服务器不可用。
2.  可以用 xml 表示的简单数据模式。
3.  我喜欢拥有一个独立的应用程序，没有服务器依赖项的想法。
4.  我可能想将它抽象为一个小框架，以便在其他项目中重用。

该模式类似于一个简单的图书目录，其中包含一些查找表和 i18n。所以，表达起来很简单。

主 xml 文件的大小在 100kb 到 15mb 的范围内。但它可能会在某个时候增长到~100mb。

我实际上正在考虑扩展我的模型类来处理 xml 数据。目前我使用 XMLReader 和 SimpleXml 的组合来获取数据，如下所示：

```
public function find($xpath){            

    while($this->xml_reader->read()){

        if($this->xml_reader->nodeType===XMLREADER::ELEMENT && 
           $this->xml_reader->localName == 'book' ){

            $node = $this->xml_reader->expand();
            $dom = new DOMDocument();
            $n = $dom->importNode($node, true);
            $dom->appendChild($n);
            $sx = simplexml_import_dom($n); 

            // xpath returns an array

            $res = $sx->xpath($xpath);

            if(isset($res[0]) && $res[0]){

                $this->results[] = $res;                        
            }
    }

    return $this->results;
} 
```

因此，我没有将整个 xml 文件加载到内存中，而是为每个部分创建一个 SimpleXml 对象并对该对象运行 xpath 查询。该函数返回一个 SimpleXml 对象数组。对于保守搜索，我可能会打破第一个找到的项目。

我要问的问题是：

1.  您是否认为这是一个可行的解决方案，即使对于大中型数据存储也是如此？
2.  在 PHP 中处理 XML 时，是否有任何注意事项/模式需要牢记？
3.  上述代码是否适用于大文件（100mb）？
4.  能否以低开销的方式处理大型 xml 文件中的插入和更新？
5.  您会建议另一种数据格式作为更好的选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T13:10:59.323

> 如果您有锯子并且需要敲钉子，请不要使用锯子。拿个锤子。（民间说法）

换句话说，如果您想要数据存储，请使用数据库，而不是标记语言。

[PHP 通过PDO](http://www.php.net/manual/en/intro.pdo.php)对各种数据库系统有很好的支持；对于小型数据集，您可以使用不需要服务器的 SQLite（它存储在普通文件中）。以后，如果您需要切换到功能齐全的数据库，这很简单。

要回答您的问题：

1.  可行的解决方案 - 不，绝对不是。XML 有其用途，但模拟数据库不是一个目的，即使是小型数据集也不行。
2.  With XML, you're shuffling strings around, all the time. That might be just bearable on read, but is a real nightmare on write (slow to parse,large memory footprint, etc.). While you could subvert XML to work as a data store, it is simply the wrong tool for the job.
3.  No (everything will take forever, if you don't run out of memory before that).
4.  No, for many reasons (locking, re-writing the whole XML-string/file, not to mention memory again).

5a. [SQLite](http://www.sqlite.org/) was designed with very small and simple databases in mind - simple, no server dependencies (the db is contained in one file). As @Robert Gould points out [in a comment](https://stackoverflow.com/questions/717003/xml-as-a-data-layer-for-a-php-application/717015#717015), it doesn't scale for larger applications, but then

5b. for a medium to large data store, consider a relational database (and it is usually easier to switch databases than to switch from XML to a database).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T12:50:48.390

不，它不会扩展。这是不可行的。

你最好使用例如[SQLite](http://www.php.net/manual/en/book.sqlite.php)。您不需要服务器，默认情况下它与 PHP 捆绑在一起，并将数据存储在常规文件中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T12:50:42.150

我会改用[SQLite](http://www.sqlite.org)，它非常适合小型网站和 x-copy 风格的部署。

基于 XML 的数据存储不能很好地扩展。

*" **SQLite**是一个符合 ACID 的嵌入式关系数据库管理系统，包含在一个相对较小 (~225 kB) 的 C 编程库中。SQLite 的源代码在公共领域。*

*与客户端-服务器数据库管理系统不同，SQLite 引擎不是程序与之通信的独立进程。相反，SQLite 库被链接，因此成为程序的一个组成部分。也可以动态调用。该程序通过简单的函数调用使用 SQLite 的功能，这减少了数据库访问的延迟，因为单个进程内的函数调用比进程间通信更有效。整个数据库（定义、表、索引和数据本身）作为单个跨平台文件存储在主机上。这种简单的设计是通过在事务开始时锁定整个数据库文件来实现的。”*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T13:27:16.960

Everyone loves to throw dirt on XML files, but in reality it works, I've seen large applications use them, and I know of an MMO that uses simple flatfiles for storage and it works fine( by the way the MMO is among the top 5 worldwide, so it's not just a toy). However my job right now is creating a better and more savy persistence layer based on SQL, and if your site will be big SQL is the best solution but XML is capable of Massive (MMO) scalability if done well.

But a caveat is migration from XML to SQL is rough if the mapping isn't easy.

# c++ - 异常处理感知执行流程

> ID：717004
> 
> 赞同：2
> 
> 时间：2009-04-04T12:39:46.403
> 
> 标签：c++, exception-handling

## 编辑：

对于有兴趣以更清洁的方式实施该方法的人，请查看该[答案](https://stackoverflow.com/questions/847279/code-reuse-in-exception-handling/847316#847316)。

* * *

在我的工作中，我经常需要使用第三方 API 来访问远程系统。例如创建一个请求并将其发送到远程系统：

```
 #include "external_lib.h"
   void SendRequest(UserRequest user_request)
   {
       try
       {
           external_lib::Request my_request;
           my_request.SetPrice(user_request.price);
           my_request.SetVolume(user_request.quantity);
           my_request.SetVisibleVolume(user_request.quantity);
           my_request.SetReference(user_request.instrument);
           my_request.SetUserID(user_request.user_name);
           my_request.SetUserPassword(user_request.user_name);
           // Meny other member affectations ...
       }
       catch(external_lib::out_of_range_error& e)
       {
           // Price , volume ????
       }
       catch(external_lib::error_t& e)
       {
           // Here I need to tell the user what was going wrong
       }
   } 
```

每个库的设置器都会检查最终用户提供的值，并且当用户不符合远程系统需求时可能会抛出异常。例如，可能不允许特定用户发送太大的音量。这是一个例子，实际上很多次用户尝试不遵守：没有长期有效的工具，价格超出限制等等。 *因此，我们的最终用户**需要**一个明确的错误消息来告诉他在其请求中修改什么获得第二次机会来撰写有效的请求。我必须向他提供这样的提示*

不管怎样，外部库的异常（大部分）从不指定哪个字段是中止请求的来源。

根据您的说法，处理这些异常的最佳方法是什么？

我第一次尝试处理这些异常是用我的“包装”Request 类。然后将每个 setter 包装在一个只做一件事的方法中：一个 try/catch 块。然后 catch 块会抛出我的一个新异常：my_out_of_range_volume 或 my_out_of_range_price，具体取决于设置器。例如 SetVolume() 将以这种方式包装：

```
My_Request::SetVolume(const int volume) 
{
    try
    {
        m_Request.SetVolume(volume);
    }
    catch(external_lib::out_range_error& e)
    {
        throw my_out_of_range_volume(volume, e);
    }
} 
```

你怎么看呢？您如何看待它所暗示的异常处理开销？...：/

那么问题是开放的，我需要新的想法来摆脱那个 lib 限制！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T13:11:09.777

如果确实需要调用很多方法，则可以使用[反射库](http://www.codeproject.com/KB/library/libreflection.aspx)减少代码，只需创建一个方法来进行调用和异常处理，并传入要调用的方法/属性的名称/设置为参数。您仍然会有相同数量的 try/catch 调用，但代码会更简单，并且您已经知道失败的方法的名称。

或者，根据它们返回的异常对象的类型，它可能包含堆栈信息，或者您可以使用另一个库来遍历堆栈跟踪以获取它失败的最后一个方法的名称。这取决于您使用的平台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T13:21:14.680

每当我使用第三方库时，我总是更喜欢包装器。它允许我定义自己的异常处理机制，避免我的类的用户了解外部库。此外，如果稍后第三方将异常处理更改为返回代码，那么我的用户不会受到影响。

但我不会将异常抛回给我的用户，而是实现错误代码。像这样的东西：

```
class MyRequest
{
    enum RequestErrorCode
    {
        PRICE_OUT_OF_LIMIT,
        VOLUME_OUT_OF_LIMIT,
        ...
        ...
        ...
    };

    bool SetPrice(const int price , RequestErrorCode& ErrorCode_out);

    ...

private:

    external_lib::Request mRequest;

};

bool MyRequest::SetPrice(const int price , RequestErrorCode& ErrorCode_out)
{
    bool bReturn = true;
    try
    {

        bReturn = mRequest.SetPrice(price);
    }
    catch(external_lib::out_of_range_error& e)
    {

        ErrorCode_out = PRICE_OUT_OF_LIMIT;
        bReturn = false;
    }
    return bReturn;
}

      bool SendRequest(UserRequest user_request)
{
    MyRequest my_request;
    MyRequest::RequestErrorCode anErrorCode;
    bool bReturn = my_request.SetPrice(user_request.price, anErrorCode);
    if( false == bReturn)
    {
        //Get the error code and process
        //ex:PRICE_OUT_OF_LIMIT
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T13:11:01.743

`SetXXX`在您的第一个版本中，如果函数返回某个值，您可以报告成功的操作数。您还可以保留一个计数器（`SetXXX`在该块中的每次调用后都会增加`try`）以记录所有调用成功的原因，并根据该计数器值返回适当的错误消息。

验证每一步的主要问题是，在实时系统中——您可能会引入过多的延迟。

否则，您的第二个选项看起来是唯一的方法。现在，如果您必须为每个库函数编写一个包装器，并且如果可以的话，为什么不添加验证逻辑，而不是对所述库进行实际调用？这个IMO，效率更高。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T13:20:22.717

我想在这种情况下我可能敢于使用宏。类似的东西（未经测试，省略反斜杠）：

```
#define SET( ins, setfun, value, msg )                           
  try {
    ins.setfun( value );
  }
  catch( external::error & )  {
    throw my_explanation( msg, value );
  } 
```

并在使用中：

```
Instrument i;
SET( i, SetExpiry, "01-01-2010", "Invalid expiry date" );
SET( i, SetPeriod, 6, "Period out of range" ); 
```

你明白了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T14:07:44.460

尽管这并不是您真正要寻找的答案，但我认为您的外部库或您对它的使用会以某种方式滥用异常。不应使用异常来改变一般流程。如果是一般情况，即输入与规范不匹配，则由您的应用程序在将参数传递给外部库之前验证参数。仅当发生“异常”情况时才应抛出异常，我认为每当涉及到用户输入时，您通常必须处理所有事情，而不是依赖于“用户必须提供正确的数据，否则我们会处理它有例外'。

尽管如此，如果您想避免使用宏，则可以使用 boost::lambda 来替代 Neil 的建议。

# programming-languages - 元循环评估器的条件

> ID：717010
> 
> 赞同：2
> 
> 时间：2009-04-04T12:49:06.007
> 
> 标签：programming-languages, metaprogramming

一种语言是否必须满足任何条件才能为该语言编写元循环评估器？我可以为 BASIC 或 Python 写一个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T13:06:42.720

引用[Reg Braithwaite 的](http://weblog.raganwald.com/2006/11/significance-of-meta-circular_22.html)话：

> 自我解释器和元循环解释器之间的区别在于后者根据特性本身重述语言特性，而不是实际实现它们。（换句话说，循环定义；因此得名）。它们依赖于它们的宿主环境来赋予特征意义。

鉴于此，允许为其编写元循环解释器的语言的关键特征之一是[同音性](http://en.wikipedia.org/wiki/Homoiconicity)，即程序的主要表示是语言本身的原始数据结构。Lisp 展示了这一点，因为程序本身被表示为列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T13:02:24.243

您*可以*为任何图灵完备的语言编写它，但是，您的里程可能会有所不同。

对于 Python，它已经完成（PyPy）。[可以在Wikipedia 文章](http://en.wikipedia.org/wiki/Metacircular_evaluation)中找到已完成的语言列表。

# language-agnostic - 开发人员如何学习网页设计？

> ID：717012
> 
> 赞同：41
> 
> 时间：2009-04-04T12:50:04.773
> 
> 标签：language-agnostic

大多数时候，我在后端担任应用程序开发人员。我从事企业网络项目，但从未涉及用户界面、设计问题。好看的网站和用户界面总是给我留下深刻印象。

现在我正在尝试开发公共网站，我知道 CSS、HTML，但遇到了网页设计/用户界面问题。我不想使用模板或窃取某人的网页设计。

开发人员/程序员如何学习设计好的网站/用户界面，我应该使用和学习哪些工具？还是设计好的网络用户界面是上帝的礼物？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-04-04T14:26:04.417

看起来你遇到了一个热门话题。作为一名网页/平面设计师，我认为提高这方面能力的最好方法是看很多好的设计；意思是，积极地寻找他们。

正如pixeline所说，没有很多客观知识需要学习（尽管有*一些*）。它更多地是关于改善你的审美眼光。如果你一直在看高质量的设计，那么你的品味会变得更加精致，你的网页设计自然会符合你的审美。

例如，我在一家独立金属厂牌工作，所以有时我会被要求在乐队网站、专辑设计、杂志广告、贴纸/服装/商品设计等方面工作。所以我一直在翻阅金属杂志和看其他人设计的广告，或者欣赏其他乐队的商品设计，或者查看其他标签的网站。

这不仅可以在我遇到困难时作为灵感来源，帮助我衡量自己的能力并找到需要改进的地方，还可以帮助我跟踪我特定设计领域中不断变化的趋势和时尚。众所周知，时尚是善变的，人们的品味总是在变化的。优秀的设计师知道如何始终保持领先。这意味着您的设计不会太大偏离公认的美学（否则您的设计将被观众拒绝），但您也不想使用过度使用和播放的设计元素。

如果你能驾驭刀锋并创新到足以脱颖而出，但又不至于让观众无法接受，那么你就已经掌握了网页设计的艺术。一个好的设计师可以识别新兴趋势并利用它们，同时通过添加自己的扭曲使其成为自己的。

如果您刚刚开始涉足网页/图形设计，请不要害怕模仿他人并窃取好主意。不要抄袭，并在应得的地方给予赞扬，但正如复制著名的绘画/绘画是人物绘画的基本培训技术一样，模仿质量设计也是学习平面设计的有效工具。

[Best Web Gallery](http://bestwebgallery.com/)和[Screenalicious](http://www.screenalicious.com/)等网站是让自己沉浸在优质设计和布局中的绝佳场所。我强烈建议您在空闲时间浏览这些网站，让您的脑海中充斥着良好美学的例子。

编辑：我还想强调，人才并不像大多数人想象的那样重要。更多时候，**兴趣**是人们混淆为“才能”的东西。如果你真的对某事感兴趣，你就会有动力沉浸其中并实践它。这反过来会导致更好的能力，如果从小开始建立信心，就会导致能力差距，从而导致更多的信心和兴趣，进而导致更多的练习......

我认为自己是一个不错的平面设计师（你可以通过我的个人资料链接查看我的作品集）和一个不错的艺术家。人们经常评论我有多么有才华，但他们没有意识到我确实花了数千个小时来磨练我的手艺。当其他孩子和他们的朋友出去玩的时候，我在我的房间里画画。这是我擅长绘画的唯一原因。当我第一次开始建立网站时，它们看起来就像大多数青少年的 Myspace 页面一样丑陋。所以当你看到“天才”设计师的作品时，不要气馁。他们也都是从卑微的起点开始的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T13:03:21.107

请阅读[不要让我思考](http://www.amazon.co.uk/Dont-Make-Me-Think-Usability/dp/0321344758/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T13:02:46.613

作为“客观”内容，没有太多要学习的内容，除了：使用网格！

[http://dev.opera.com/articles/view/grid-design-basics-grids-for-web-page-l/](http://dev.opera.com/articles/view/grid-design-basics-grids-for-web-page-l/)

看到人眼将平衡、对称、对比度、色调等视为“美”的事物。研究这些基础知识，然后……练习、实验、迭代。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T12:58:46.887

Seth Godin 最近为想要提高设计技能的人发布[了一个资源页面。](http://sethgodin.typepad.com/seths_blog/2009/03/why-arent-you-really-good-at-graphic-design.html)

[Smashing Magazine 网站](http://www.smashingmagazine.com/)也有很多相关文章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-04T13:03:33.693

最好的学习方式是开始做并征求反馈。关键是确保您的网站简单、直观且易于使用，同时提供非常丰富的内容和功能集。

这篇文章非常有力地展示了良好的 UI 设计意味着什么。[http://stuffthathappens.com/blog/2008/03/05/simplicity/](http://stuffthathappens.com/blog/2008/03/05/simplicity/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T14:47:01.667

[A List Apart](http://www.alistapart.com/)是一本关于网页内容设计和开发的优秀网络杂志。每月出版两次，通常是两篇新文章，是杂志类型的格式；这是对这里其他人提到的一些书籍的很好补充。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T13:03:20.747

你可以学习好的网页设计的原则，你可以知道所有的工具，但实际上它就像图形设计一样，你需要一些天赋。除非你拥有它，否则你最终会得到非常正确但沉闷的设计。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-04T13:06:23.890

这些网站提供了很好的内容：

[http://css-tricks.com/](http://css-tricks.com/) [http://net.tutsplus.com/](http://net.tutsplus.com/) [http://blog.themeforest.net/](http://blog.themeforest.net/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-04T14:17:22.707

请参阅[为什么优秀的 UI 设计对某些开发人员来说如此困难？](https://stackoverflow.com/questions/514083/why-is-good-ui-design-so-hard-for-some-developers/519067#519067)
它有大量关于此的重要信息

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-05T15:30:49.993

不久前我发现了这个网站并将其添加为书签，希望有一天我的妻子可能会对网页设计感兴趣......

**66 个学习网页设计基础知识的链接** [http://www.divitodesign.com/2008/08/66-links-to-learn-the-webdesign-basics/](http://www.divitodesign.com/2008/08/66-links-to-learn-the-webdesign-basics/)

它分为以下几类：

```
 General
   Programs
   HTML
   CSS
   Design
   Site Structure
   Tutorial Sites
   Colors
   Resources
   Stock Images
   Search Engines
   Inspiration
   Fonts / Typography
   Usability and Accessibility
   Blogging 
```

# php - 如何使用 api 在谷歌地图中仅显示一个国家或特定区域？

> ID：717019
> 
> 赞同：12
> 
> 时间：2009-04-04T12:56:26.130
> 
> 标签：php, javascript, api, google-maps

我在一个项目中使用谷歌地图，我想在我的地图窗口中只显示一张国家地图，即我只想在我的地图上显示美国而不是 Canda 和墨西哥等等，为我的应用程序删除多余的信息建造。

我发现了一些东西，你可以限制一些 javascript 覆盖的区域，但这仍然给了我很多额外的地图区域，因为地理区域通常不符合正方形。

此外，我受到时间、$、php 和 javascript 的限制，所以我不能真正做一些涉及大量工作的花哨的自定义解决方案，即通常的设置。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-04T13:21:16.320

查看[Mike Williams](http://econym.org.uk/gmap/range.htm)的精彩 GMaps 教程之一：在那里，他展示了如何限制地图中的缩放和平移。

如果你想让某些区域不可见，[试试这个：](http://econym.org.uk/gmap/einsertg.htm)我认为这最接近你想要的（这个[例子](http://econym.org.uk/gmap/example_egroundoverlay.htm)实际上做了你想要的同样的事情，但它似乎是面向加拿大人的；））。

# drawing - Photoshop撤消系统

> ID：717020
> 
> 赞同：7
> 
> 时间：2009-04-04T12:58:00.197
> 
> 标签：drawing, photoshop, undo

这个问题可能适用于一般的绘图系统。我想知道如何在 PS 中实现撤消功能。程序是否在每次操作之前拍摄画布的快照？如果是这样，这不会导致巨大的内存需求吗？我已经研究了命令模式，但我不太明白这将如何应用于绘图。

问候，门诺

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-04T13:04:11.120

它被称为[命令模式](http://en.wikipedia.org/wiki/Command_pattern)。它很容易实现，对任何类型的编辑器都很有用。

Photoshop 在原始图像上应用堆叠变换。一操作一命令。当您撤消时，它只是取消应用转换。所以它只保留原始版本和最新版本，但我想它可能会缓存最后几个版本只是为了提高性能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T13:04:29.183

由于某些操作将是不可逆的，并且正如您所说，每次都对整个图像进行快照是不可能的，那么我能看到的唯一其他选择就是一堆增量。delta 是一组掩码，包含在操作之前修改的像素。当然，许多操作可能是可逆的，因此可以优化它们的增量。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-04T15:57:45.867

我不确定 Adob​​e Photoshop 是如何实现的，但[Apple Shake](https://en.wikipedia.org/wiki/Shake_(software))`undo`合成应用程序中的 Paint 节点很容易解释：

*   每个笔触都存储为一系列点，以及一些信息，如笔触颜色、画笔大小等。
*   绘制描边时，会在当前图像上进行更改。
*   每`x`笔画（我认为是 10 笔）当前图像都会缓存到内存中。
*   当您撤消时，它会重新绘制上一个缓存图像的最后约 9 次。

这有两个问题：

*   当您撤消超过 10 次时，它必须重新计算整个图像。对于数千个笔划，这可能会导致几秒钟的暂停。
*   使用 Shake，您可以保存包含笔画信息的设置文件，而不是实际的像素值。然后意味着每当您重新打开 Paint 节点或渲染图像时，您都必须重新计算整个图像（但问题几乎没有撤消操作那么大）。

好吧，还有第三个问题，Shake 是一个可怕的错误，并且在许多领域实现得很差，Paint 节点就是其中之一 - 所以我不确定这是一个多么好的实现，但我无法想象 Photoshop 是太不相似（尽管优化*得*更好）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-05T14:32:40.690

我发现解决这个问题的最简单方法是使用持久数据结构，尽管我不知道 Adob​​e 是如何解决的，如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/MNlRW.jpg)](https://i.stack.imgur.com/MNlRW.jpg)

您将图像视为图像块的集合，例如每个 64x64 像素，它们会被垃圾收集或引用计数（例如：`shared_ptr`在 C++ 中使用）。

现在，当用户对图像拼贴进行更改时，您可以在浅层复制未修改的拼贴时创建一个新版本：

[![在此处输入图像描述](https://i.stack.imgur.com/syaYe.jpg)](https://i.stack.imgur.com/syaYe.jpg)

在这样的变化下，除了那些黑色瓷砖之外的所有东西都被浅浅地复制了。当你这样做时，你的整个撤消系统归结为：

```
before user operation:
    store current image in undo stack
on undo/redo:
    swap image at top of undo stack with current image 
```

而且它变得超级简单，不需要在每个撤消条目中一遍又一遍地存储整个图像。作为用户复制和粘贴图层的奖励，除非/直到他们对粘贴的图层进行更改，否则几乎不会占用更多内存。它基本上为您提供了一个图像实例化系统。另一个好处是，当用户创建一个透明层，比如说，2000x2000 像素，但他们只绘制了一小部分图像，比如只有 100x100 像素，这也几乎不会占用任何内存，因为空/透明图块不会必须存储任何像素，只有几个空指针。它还加快了与此类大部分透明图层的合成速度，因为您不必对空图像图块进行 alpha 混合，而可以跳过它们。

至于PS动作，那是一种不同的方法。在那里，您可能会使用一些脚本来指示要执行的操作，但您可以将其与上述结合起来，以有效地仅缓存图像的修改部分。这种方法的重点是避免不得不一遍又一遍地深度复制整个图像，并炸毁内存使用以缓存图像的先前状态以进行撤消，而不必为各种类型的文件编写单独的撤消/重做逻辑。可能发生的不同操作。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-04T13:20:52.263

Photoshop 使用**历史记录**来跟踪他们的操作。这些也用作撤消，因为您可以随时回到历史。您可以在首选项中设置历史记录的大小。

我还建议您将**Adob​​e Version Cue 作为一种用于追溯撤消或版本的工具**，它内置在套件中仅用于此目的。[http://en.wikipedia.org/wiki/Adobe_Version_Cue](http://en.wikipedia.org/wiki/Adobe_Version_Cue)

# c++ - 从“xxxx”转换为“yyyy”，可能丢失数据，抑制？

> ID：717022
> 
> 赞同：1
> 
> 时间：2009-04-04T12:59:43.173
> 
> 标签：c++, types, suppress-warnings

有时我会收到从较长类型转换为较小类型的警告，例如：

```
void f( unsigned short i ) // f - accept any numeric type
                           // smaller than std::vector<>::size_type
{}

std::vector < some_type > v;
..
f ( v.size() ); 
```

通常我使用下一个解决方案之一：

```
assert( v.size() <= std::numeric_limits< unsigned short >::max() );
f( static_cast< unsigned short >( v.size() ) ); 
```

或者

```
f( boost::numeric_cast<  unsigned short >( v.size() ) ); 
```

但是在我目前的工作中没有使用提升，并且从上个月开始断言是不允许的。

您还知道哪些其他安全方法可以抑制此警告？
任何已知方式的陷阱？

**PS：** 并非总是可以更改 f 的签名，有时也确实应该接受小的数字类型。

**编辑：** 我想让转换尽可能安全。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T13:05:44.297

为什么要先投？向量的大小通常是无符号整数。如果可能的话，我会说更新函数签名。*警告并不是要被压制，而是要解决。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T13:27:01.127

处理此问题的唯一安全方法是确保您在运行时不会丢失转换。断言代码仅在调试构建期间有效，并允许零售构建中的转换损失。转换损失很糟糕，因为它会传递一个完全不正确的向量大小。

您真正需要的是一种机制来防止您造成数据丢失。我建议使用像 SafeInt 这样的类。这将通过引发异常来防止上溢或下溢的转换。

```
SafeInt<size_t> size = v.size();
f((unsigned short)size);  // Throws if size can't fit in an unsigned short 
```

SafeInt： http: [//www.codeplex.com/SafeInt](http://www.codeplex.com/SafeInt)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T13:13:33.717

我现在再次重复我的口头禅**：**如果您的代码包含演员表，则代码或设计可能有问题，您应该检查两者以消除演员表。

顺便说一句，我上次发布时，您对此表示赞同！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T13:14:53.527

由于 size() 通常返回一个无符号整数，因此将其类型转换为有符号整数应该是非常安全的。

```
f(static_cast<expected-type>(v.size())); 
```

否则，如果可能，请更改函数签名。

# yui - 如何使用不同的浏览器测试我的网页？

> ID：717026
> 
> 赞同：5
> 
> 时间：2009-04-04T13:01:28.583
> 
> 标签：yui, cross-browser, css-reset

我刚刚发现了 Yahoo UI [Reset CSS](http://developer.yahoo.com/yui/reset/)工具/文件，我正在我的网站上使用它。在我的机器上，我有 Internet Explorer 7 和 Firefox 3.01，我的网页在这两个浏览器上看起来是一样的。一个朋友正在使用 Internet Explorer 6，页面完全是一团糟。我有两个问题：

1.  我在编写 CSS 方面有那么差/愚蠢吗？
2.  如何在我的机器上使用不同的浏览器测试我的网页？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-10-17T19:37:37.703

Just because your website looks terrible in Internet Explorer 6 *does not* mean you are terrible at CSS. There are [several documented bugs in Internet Explorer's rendering engine](http://www.positioniseverything.net/explorer.html) in regards to CSS. Web designers and developers have been struggling with these bugs for years. Several well known websites like [Digg](http://blog.digg.com/?p=878) and [YouTube](http://www.techcrunch.com/2009/07/14/youtube-will-be-next-to-kiss-ie6-support-goodbye/) are no longer going to support IE6.

You have several options to test your website in multiple browsers. The easiest way is to install all the browsers you want to test against on a local machine. There are 5 major browsers, and they all require different methods to install multiple versions.

## Microsoft Internet Explorer

If you are using Windows XP, you can use [Multiple IEs](http://tredosoft.com/Multiple_IE) to install Internet Explorer versions 3, 4.01, 5, 5.5 and 6.

If you are using Windows Vista or Windows 7 (or Windows XP for that matter) you can download [virtual machine images from Microsoft](http://www.microsoft.com/Downloads/details.aspx?FamilyID=21eabb90-958f-4b64-b5f1-73d0a413c8ef&displaylang=en) that contain a fully licensed Windows operating system with Internet Explorer. These virtual machine images expire every 90 to 120 days. They offer the following images:

*   Windows XP SP3 with IE6
*   Windows XP SP3 with IE7
*   Windows XP SP3 with IE8
*   Windows Vista with IE7
*   Windows Vista with IE8

These images can all be used with the free [Virtual PC 2007](http://www.microsoft.com/windows/virtual-pc/support/virtual-pc-2007.aspx).

## Mozilla Firefox

You can install multiple versions of Firefox on the same operating system, but it is highly advised that you create a new profile for each version you are going to install. You can use the steps outlined on [Rob Cherny's blog](http://cherny.com/webdev/32/new-firefox-2-and-multiple-firefox-version-installations) to set this up (the article is referring to Firefox 2, but it works for Firefox 3 and 3.5 too). Alternatively, you can use [MultiFirefox](http://www.webmonkey.com/blog/Test_Multiple_Firefox_Versions_with_MultiFirefox).

## Google Chrome

There really isn't an easy way to run multiple versions of Google Chrome on the same machine. Chrome installations are user account-specific, and standalone versions of Chrome have been made available (see [question 3785991](https://stackoverflow.com/questions/3785991/can-i-run-multiple-versions-of-google-chrome-on-the-same-machine-mac-or-windows)), so you can create a new Windows/Mac user account for each old version of Chrome you want to test.

However, the fact that updates are applied automatically and silently means that you really shouldn't worry to much about designing your website for older versions of Chrome. If this is unacceptable, you will need to use multiple user accounts, or virtual images as advised for Internet Explorer previously.

## Apple Safari

Safari is similar to Google Chrome in that there isn't an easy way to run multiple versions on the same machine. Michel Fortin has an article that details [how to get multiple versions running on Mac OS X](http://michelf.com/weblog/2005/multi-safari/). You can refer to [this Stack Overflow question](https://stackoverflow.com/questions/1199234/multiple-versions-of-safari-on-windows-xp) for the lowdown on Windows. Virtual images, again, seem to be the only way to go.

## Opera

You can install older versions of Opera without issue, so long as they are installed to different directories.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-04T13:42:02.557

If you are not particular about testing in *your* machine, you could try [https://browsershots.org](https://browsershots.org) or [https://blisk.io](https://blisk.io). These are free and provide screenshots of your site in various browsers on Linux/Windows/Mac OS/BSD.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-04T13:32:30.020

一个重置的 CSS——YUI 只是其中一个例子——旨在消除浏览器在 HTML 元素的默认 CSS 属性中的差异，例如某些浏览器将在**html**元素上具有默认的 8 像素填充（我很惊讶地发现当我第一次发现时，甚至对 html 元素进行了样式设置）。

您的 IE6 问题与此完全不同。如果没有网站本身的示例，就不可能说出为什么会这样，但很明显的猜测是您依赖于相当高级的 CSS 功能（例如 a > b 选择器，:hover 在非锚点上，某些定位方案等） .

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-04T13:30:28.513

对于 IE，您可以使用此工具[(Multiple IE)](http://tredosoft.com/Multiple_IE)以旧版本测试您的网站。

对于重置 CSS，我将您重定向[到这个问题。](https://stackoverflow.com/questions/167531/is-it-ok-to-use-a-css-reset-stylesheet)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-22T09:06:13.823

For testing various IE versions I use [ietester](http://www.my-debugbar.com/wiki/IETester/HomePage)

It allows different ie versions in each browser tab and it's free.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T13:07:35.120

它的目的是 HTML（编辑：浏览器为 elements.ty Zack 预定义的属性）为其元素提供了一些预定义的属性，例如段落元素的内置填充/边距。使用重置备忘单的要点是从所有元素都相等的默认值开始：大小、边距、填充等。我在我的项目中使用重置文件，但不是原始形式。您应该决定要使用工作表中的哪些元素，并且您始终可以为那里的标签分配其他默认值。

* * *

编辑：您可以通过安装大多数可用的浏览器来测试您的网页。[这](http://www.w3schools.com/browsers/browsers_stats.asp)是代表浏览器使用情况的最新统计数据。我的建议是使用 Mozilla 作为测试浏览器的第一选择，并且时不时地在其他浏览器上测试页面：IE6、IE7、IE8、Opera、Chrome 和 Safari（至少）。这是对关于一台 PC 上的多个 IE 的讨论的[参考。](https://stackoverflow.com/questions/693112/multiple-ie-instances-on-one-machine)祝你好运！

# c# - 匿名实例化语法 - 好还是坏？

> ID：717027
> 
> 赞同：3
> 
> 时间：2009-04-04T13:02:06.803
> 
> 标签：c#, performance, syntax

对于我只使用一次实例化对象的快速任务，我知道我可以执行以下操作：

```
int FooBarResult = (new Foo()).Bar(); 
```

我说这对于非一次性对象是完全可以接受的，并且比替代方法更具可读性：

```
Foo MyOnceUsedFoo = new Foo();
int FooBarResult = MyOnceUsedFoo.Bar(); 
```

你用哪个，为什么？
你会在生产应用程序中使用这种类型的匿名实例化吗？
偏好：带括号“(new Foo()).Bar();” 还是没有“new Foo().Bar();”？

（编辑为从 Random 类中抽象出问题）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T13:05:32.300

**关于随机数的旁注：**实际上，不，您的具体示例 ( `new Random().Next(0,100)`) 是完全不可接受的。生成的随机数将远非统一。

* * *

除此之外，总的来说，两者之间没有太大区别。在这两种情况下，编译器很可能会生成完全相同的代码。您应该使用最易读的情况（长语句可能会损害可读性；更多代码也会这样做，因此您必须在特定情况下进行权衡）。

顺便说一句，如果您选择使用单行大小写，请省略不必要的括号（`new MyObject().Method()`可以）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-04T13:31:23.377

您可能需要考虑在调试器中使用代码的含义。第二种情况将允许您检查您创建的对象，而第一种情况不会。当然，当您尝试调试代码时，您总是可以退回到第二种情况。

我已经做到了两种方式，并没有真正的偏好。我更喜欢任何看起来更易读的东西，这高度依赖于被调用的类和方法的复杂性。

顺便说一句——你可能想选择一个不同的例子。我担心您的观点可能会在讨论生成随机数的最佳方式时丢失。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T13:05:58.353

如果您只使用该对象一次，则第一种方法总是更好。

它更短更清晰，因为它明确表明您以后不会使用该对象。

无论如何，它可能会编译为相同的 CIL，因此第二种形式没有优势。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T13:09:17.940

第一种说法。它更具可读性，代码更少，并且不会留下临时文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-04T14:48:59.323

第二个是调试友好的，而第一个不是。第二个赢只是因为这个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T13:51:28.523

事实上，第一种方式，创建一个临时的，因为两个原因*更具可读性：*

1）更简洁

需要阅读的代码更少，没有引入不必要的局部变量，也没有与另一个局部变量的潜在名称冲突，或者在封闭范围内隐藏任何具有相同名称的变量

2）它传达了第二种形式没有传达的东西，即该对象正在被临时使用。

阅读它，我知道该实例永远不会再被使用，所以在我用来理解我正在阅读的代码的“心理编译器”中，我不需要保留对它的引用，而不是代码保留对它的引用。

然而，正如 Mehrdad 所指出的，使用 Random 类来做这件事并不是一个好主意。

正如他还指出的那样，多余的括号使其不那么简洁。除非您处于语言的尘土飞扬的角落，否则请假设有能力的程序员知道该语言的运算符优先级。在这种情况下，即使我不知道运算符优先级，替代解析（在函数返回时调用 new）也是无意义的，因此“明显”的读数是正确的读数。

```
int RandomIndex = (new Random()).Next(0,100);
int RandomIndex = new Random().Next(0,100); 
```

# php - 通过 jQuery 使用 AJAX 发布 MySQL 结果

> ID：717052
> 
> 赞同：1
> 
> 时间：2009-04-04T13:12:09.260
> 
> 标签：php, javascript, jquery, mysql, ajax

作为 javascript、AJAX 和 jQuery 的新手，我想向数据库发布 3 个值，其中 2 个是 mysql 查询的结果。查看源代码，`var userid`具有正确的用户 ID 值。第二个 ( `var obid`) 和第三个 ( `var authoruserid`) 值。当我检查源代码时，查询返回的行是空的，而 firebug 中的值只是 var 的名称。数据也不会发布到数据库中。

任何帮助总是受到赞赏。

如果有人能告诉我我在做正确的 AJAX 部分，并且 AJAX 可以使用 SQL 行作为数据，我真的会很高兴，然后我可以开始寻找其他原因导致这不起作用。

服务器端：

```
if( isset( $_POST['user_id'] ) && isset($_POST['ob_id'] ) && isset( $_POST['author_user_id']) ) {

    $result = mysql_query("INSERT INTO ilike (ilike_user_id, ilike_object_id, ilike_author_user_id) VALUES (" . mysql_real_escape_string( $_POST['user_id'] ) . ", " . mysql_real_escape_string( $_POST['ob_id'] ) . ", " . mysql_real_escape_string( $_POST['author_user_id'] ). ")" );
    echo $result ? 'Vote Succeeded' : 'Vote Failed: ' . mysql_error();
    exit;
    }
$status = $rows['status_id']; // done via a separate query
$aid = $rows['user_id']; // as above
$user_id = uid(); // User cookie check function 
```

HTML：

```
<a href="javascript:;" onclick="updateScore(this)" class="blue">Vote</a> 
```

Javascript：

```
<script type="text/javascript">
function updateScore( answer )
{
var userid = '<?php echo $user_id; ?>';
var obid = '<?php echo $status_id; ?>';
var authoruserid = '<?php echo $aid; ?>';
    if ( confirm( "Are you sure?" ) )
    {
        $.post('index.php', {user_id: "userid", ob_id: "obid", author_user_id: "authoruserid"}, function(d)
        {
            alert('Vote Accepted: ' + d);
            $(answer).after("<span>You Voted!</span>").remove();
        });
    }
}

</script> 
```

源代码：

```
<script type="text/javascript">
function updateScore( answer )
{
var userid = '5';
var obid = '';
var authoruserid = '';
    if ( confirm( "Are you sure?" ) )
    {        
$.post('index.php', {user_id: "userid", ob_id: "obid", author_user_id: "authoruserid"}, function(d)
        {
            alert('Vote Accepted: ' + d);
            $(answer).after("<span>You Voted!</span>").remove();
        });
    }
}

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T13:51:43.313

将值从数据库分配到的代码部分在哪里`$user_id, $status_id`？

我只能看到 $aid 的分配。这可能是您的问题，在页面显示之前没有分配任何`$user_id`内容`$status_id`？

在您的服务器端代码上，您有`$status = $rows['user_status'];`，而在页面上您将其称为 $status_id

将服务器代码的最后一部分替换为：

```
$status_id = $rows['user_status']; //changed $status to $status_id
$aid = $rows['user_id']; // this works

//You need an assignment to $user_id
$user_id = $rows['something'];//I'm guessing this assignment is missing 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T04:27:24.090

我需要去看眼科医生。我在我的 php 代码中查看了一个完美的括号。很抱歉打扰大家。我也摆脱了变量，只是在属性列表中呼应了它们。

干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T13:54:27.300

我对 jQuery 也很陌生，而且我还没有真正使用过它的 AJAX 功能，所以请原谅我的无知。但是，您确定在*$.post*函数中作为数据参数发送的 key:value 对中需要在*userid*、*obid*和*authoruserid周围加上引号吗？*因为在我拥有的 jQuery 参考手册中，我没有看到在变量名周围使用引号，也没有在其他在线代码示例中看到引号。在我看来，你只会在文字值周围使用引号，就像你试图实际发布类似的内容：

 *```
{user_id: "32", username: "Bob", message: "hello world!"} 
```

也许这样的事情可能会更好：

```
$.post('index.php', {user_id: userid, ob_id: obid, ...}, ... 
```

但我可能完全错了......

# windows - 流畅的录屏软件

> ID：717060
> 
> 赞同：2
> 
> 时间：2009-04-04T13:16:01.043
> 
> 标签：windows

我正在准备我的毕业论文演讲。如果没有可用的互联网连接，我想备份自己。因此，我想录制一段视频来展示我的软件的功能。我已经尝试过 Camtasia，但我创建的所有流畅流畅的动画看起来都没有那么吸引人。有没有替代方案。可以以 1 对 1 或接近的方式捕获我的屏幕的东西。Camtasia 很棒，但它没有达到目的。

任何帮助将不胜感激。

最好的问候，基里尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T13:19:10.943

[录屏](http://en.wikipedia.org/wiki/List_of_screencasting_software)软件列表

另外，这个[ScreenToaster](http://www.screentoaster.com/) [演示](http://www.lifehacker.com.au/2009/01/screentoaster_records_screencasts_and_audio_no_software_required-2/)看起来很流畅，今年才问世。另一个[演示](http://www.screentoaster.com/watch/demo/screentoaster)。那很光滑。您可以稍后将视频下载为 .mov 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T14:34:24.520

我正在使用[webex](http://www.webex.com/)进行此类屏幕录制工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T20:58:22.483

我很惊讶没有人提到微软的 Expression Encoder 屏幕捕捉软件。它可能是我从屏幕录制软件中看到的最好的质量，并且超级易于使用。您还可以捕获网络摄像头和/或音频输出/输入。看看 - [http://www.microsoft.com/expression/products/Encoder4_Overview.aspx](http://www.microsoft.com/expression/products/Encoder4_Overview.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T14:41:38.450

据我所知，屏幕录制软件在您的操作系统上充当“寄生虫”，它们不一定会在每次帧缓冲区更改或视频卡中的某些内容发生更改时“切换”。

因此，我不确定您是否可以找到记录 1:1 的内容。您可能可以通过提高进程优先级、无压缩等来改进事情，但我仍然怀疑您是否会捕获每一帧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T13:51:59.583

您可能还需要考虑使用 VMWare Workstation 中的“捕捉电影”功能。能够将您的环境重置回特定点以进行重拍可能会更容易录制完美的镜头。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-02T07:37:41.097

我正在使用一个漂亮的屏幕录制工具——PCHand Screen Recorder。它可以在屏幕上记录任何内容。我认为它是为你制作教学视频的完美助手。更重要的是，它可以录制任何音频并与视频保持同步。希望它可以帮助你。

[http://www.screen-capture-record.com/screen-recorder.html](http://www.screen-capture-record.com/screen-recorder.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-13T14:11:07.253

我喜欢 Blueberry Software 产品。我用过它，并没有注意到任何闪烁。

他们可以在这里找到：[http ://www.bbsoftware.co.uk/](http://www.bbsoftware.co.uk/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T06:22:26.263

对于制作软件演示，[**DemoCreator**](http://www.sameshow.com/demo-creator.html#107)将是一个不错的工具。如果您不打算调整 Flash 影片的尺寸，它将以 1 比 1 的方式捕获您的屏幕。它具有强大的编辑功能，您可以添加标注，使圆顶更易于理解。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-27T00:26:41.240

我可以推荐[WM Capture](http://wmrecorder.com/products/wm-capture/)。他们有一个免费下载，可让您录制长达 10 分钟。生成的文件质量非常好，而且您可以调整音频/视频比特率和每秒帧数。

为了将生成的文件压缩成更易于管理的文件，我使用 VLC 媒体播放器，它具有一些出色的（但鲜为人知的）内置转换功能（通过媒体 -> 转换/保存菜单选项）。这导致来自 WM 捕获的 30mb mpg 文件成为 3mb mpg 文件，而没有任何明显的质量下降。

# video - 文件上传问题

> ID：717063
> 
> 赞同：2
> 
> 时间：2009-04-04T13:18:15.640
> 
> 标签：video, upload, youtube, encode, multimedia

我正在为我的网站实现类似 Youtube 的场景——上传视频，以便所有人都能观看。我的问题是，我认为我们需要在上传后对视频进行编码，然后其他人才能远程播放，但编码过程非常慢（我尝试使用 Microsoft Expression Encoder 和 mplayer，编码一个 20 分钟的视频大约需要 10 分钟）。令我惊讶的是，即使我们将一个非常大的视频上传到 Youtube，其他人似乎可以立即选择并播放，看起来编码过程几乎花费了零时间。

请问有人有什么想法吗？Youtube 是如何神奇地进行如此快速的编码过程的？或者 Youtube 完全跳过了编码过程——但是如果跳过编码过程，Youtube 怎么能确保所有上传的视频都是可播放的（即视频遵循一些参数，比如比特率、图片大小等等）？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T13:20:18.897

不要忘记 YouTube 归 Google 所有，因此拥有[450,000](http://en.wikipedia.org/wiki/Google_platform)台服务器*可能会*有所帮助！

（我承认，这是一个有点滑稽的回答。显然，YouTube 无法访问所有这些内容。但重点仍然是他们将有大量资源来解决这个问题）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T14:09:51.460

此外，youtube 可能使用了硬件编码器。

而且，只有在编码比播放快的情况下才可以在编码时播放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T13:30:33.833

在做任何其他事情之前，先获得一个更好的编码器。有很多可用的编码器。有些是开源的，有些是专有的。Apple 有一些非常非常好的编码器，速度快但价格昂贵。

查看[http://www.ffmpegx.com/](http://www.ffmpegx.com/)了解最新的开源编码器技术。它们集成了多种技术。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T15:14:11.680

> Youtube 是如何神奇地进行如此快速的编码过程的？

在没有任何特定内部知识的情况下，我希望（1）将输入视频切成更短的片段以发送到多个编码器，以及（2）在您上传的同时对流进行编码，而不是等到您上传整个文件开始。

> 或者 Youtube 完全跳过编码过程

不可以，所有内容都必须转换为 FLV 才能播放。

# c# - 如何在 C# 中从另一个 cs 文件访问表单对象

> ID：717074
> 
> 赞同：7
> 
> 时间：2009-04-04T13:23:49.293
> 
> 标签：c#, forms, object

在 form.cs 文件中，我有两个按钮，一个备忘录和一个计时器。我的问题是：如何从另一个 cs 文件访问计时器或备忘录？

我试图将这些对象公开，但没有成功，请给我一个来源或一个项目，这样我就可以看到我错在哪里了。

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-04T13:25:50.270

在设计器中选择您的按钮，转到它的属性并将“修改器”属性从私有更改为公共。

然后您可以从另一个类访问它，如下所示：

```
public static class Test
{
    public static void DisalbeMyButton()
    {
        var form = Form.ActiveForm as Form1;

        if (form != null)
        {
            form.MyButton.Enabled = false;
        }
    }
} 
```

注意：这只是一个例子，绝对不是好的设计模式:-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-04T13:31:36.420

每当我听到有人谈论“另一个 .cs 文件”或“另一个 .vb 文件”时，我都会担心。它通常（尽管并非总是）表明缺乏对编程的理解，至少是对 OO 编程的理解。*文件里*有什么？一节课？二？

您不是试图从另一个*文件*访问这些东西，而是试图从类的方法或可能是 VB 中的模块的方法访问它们。

您的问题的答案将取决于您尝试访问这些内容的类和方法的性质，以及您想要访问它们的原因。

一旦您编辑您的问题以包含此信息，您收到的答案可能会告诉您，您不应该在表单类本身之外的其他类中访问这些表单的私有部分。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-14T10:38:19.333

Program.cs 中已经实例化了 Form 对象，但它没有引用。通过简单的编辑，您可以转动

```
Application.Run(new Form1()); 
```

到

```
Application.Run(formInstance = new Form1()); 
```

像这样声明

```
public static Form1 formInstance; 
```

并使用

```
Program.formInstance.MyFunction(params); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T13:37:48.603

尽管我同意 John Saunders 的观​​点，但假设您可以通过公共修饰符访问所有内容，那么您可能做错的一件事是您没有该表单的实例。

例如，您将这样做：

```
Form1 myForm = new Form1;
string theButtonTextIAmLookingFor = myForm.MyButton.Text; 
```

我假设您可能正在尝试像静态一样访问它，如下所示：

```
string theButtonTextIAmLookingFor = Form1.MyButton.Text; 
```

只是你可能想要检查的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-15T06:17:46.643

直观的选择只是将控制字段公开这是解决此问题的一个非常好的解决方案。

[http://searchwindevelopment.techtarget.com/answer/In-C-how-can-I-change-the-properties-of-controls-on-another-form](http://searchwindevelopment.techtarget.com/answer/In-C-how-can-I-change-the-properties-of-controls-on-another-form)

# java - 高效的java对象图序列化

> ID：717090
> 
> 赞同：7
> 
> 时间：2009-04-04T13:35:06.630
> 
> 标签：java, serialization

序列化 java 对象图的最佳方法是什么？

我对序列化库的要求是 1) 反序列化的速度 2) 大小 - 尽可能小（小于 java 默认序列化） 3) 灵活性 - 必须序列化的基于注释的定义会很好。

底层文件格式并不重要。

我查看了 Protocol Buffers 和 XStream，但前者由于需要映射文件而不够灵活，而后者会产生大文件。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T14:46:20.420

对于小对象，Java 序列化形式很可能以序列化类的描述为主。

您可能能够为常用类写出序列化数据，然后将其用作一系列序列化流的公共前缀。请注意，这是非常脆弱的，您可能需要重新计算并检查每个类加载器实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T14:38:54.573

对于序列化，Hessian 是最有效的方法之一。

这比 Java 序列化小 2-3 倍，速度快，即使使用 Externalizable 类也是如此。

无论您使用哪种序列化，您都可以相当轻松地使用压缩来使数据更加紧凑。

除此之外，您可以编写自己的序列化。我写了一个序列化程序，它写入/写入 ByteBuffer 的速度大约是 Hessian 的两倍，大小是 Hessian 的一半（大约比 Java 序列化快 5 倍/小）如果现有的序列化可以满足您的需要，这可能会付出太多努力而收效甚微。但是，它可以随心所欲地定制；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T00:57:26.850

我支持关于压缩有用性的注释——所有格式压缩到大致相同，即更大的输出压缩更多。

除了这些和其他建议之外，[Jackson](http://jackson.codehaus.org/Tutorial)的 JSON效果很好：比 XML 快得多（与 PB、Hessian 竞争）并且更紧凑；比 PB 灵活得多，易于与客户端 JS 集成（如果重要的话）并且易于排除故障。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T13:49:01.730

我认为默认的 Java 序列化会非常小。您不能通过`transient`关键字有效地限制要序列化的内容吗？这将解决您的第三个问题（灵活性和注释）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-09T21:37:25.553

您可以使用[Databoard](http://dev.simantics.org/index.php/Org.simantics.databoard)进行递归序列化。

它看起来像这样..

```
@Referable class Node {
    public int id;
    public Node[] reference;
    public Node(int id, Node...reference) {
        this.id = id;
        this.reference = reference;
    }

}

public static void main(String[] args) throws Exception {

    Node a = new Node(0);
    Node b = new Node(1);
    Node c = new Node(2);
    a.reference = new Node[] {b, c};
    b.reference = new Node[] {a};
    c.reference = new Node[] {c};

    Binding binding = Bindings.getBinding( Node.class );
    Serializer s = binding.serializer();
    byte[] data = s.serialize(a);

    Node d = (Node) s.deserialize( data );
    System.out.println( binding.toString(d) );
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-05T19:25:02.457

[http://jserial.sourceforge.net/](http://jserial.sourceforge.net/)会满足您的需要吗？

# c# - 反射 - 获取 lambda 表达式中的方法调用列表

> ID：717091
> 
> 赞同：5
> 
> 时间：2009-04-04T13:35:09.983
> 
> 标签：c#, .net, reflection

我正在尝试找到一种方法来获取 C# 3.5 中的 lambda 表达式中的方法调用列表。例如，在下面的代码中，我想使用 LookAtThis(Action a) 方法来分析 lambda 表达式的内容。换句话说，我希望 LookAtThis 向我返回 Create 的 MethodInfo 对象。

```
LookAtThis(() => Create(null, 0)); 
```

是否可以？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T16:21:22.953

只要您使用`Expression<Action>`而不是`Action`. 有关完整代码，包括如何获取隐含的实际值，[请参见此处](http://code.google.com/p/protobuf-net/source/browse/trunk/protobuf-net.Extensions/ServiceModel/Client/ProtoClientExtensions.cs)- 特别是`ResolveMethod`（以及如何使用它`Invoke`）。这是我在 protobuf-net 中使用的代码，用于基于 lambda 进行 RPC。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T16:48:56.593

```
using System;
using System.Linq;
using System.Diagnostics;
using System.Reflection;
using System.Linq.Expressions;

class Program
{
    static void Create(object o, int n) { Debug.Print("Create!"); }

    static void LookAtThis(Expression expression)
    {
        //inspect:
        MethodInfo method = ((MethodCallExpression)expression.Body).Method;
        Debug.Print("Method = '{0}'", method.Name);

        //execute:
        Action action = expression.Compile();
        action();
    }

    static void Main(string[] args)
    {
        LookAtThis((Expression)(() => Create(null, 0)));
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T13:39:34.043

```
static MethodInfo GetMethodInfo<T>(Expression<Func<T>> expression)
{
    return ((MethodCallExpression)expression.Body).Method;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T13:42:01.793

我认为您需要改用[表达式树](http://msdn.microsoft.com/en-us/library/bb397951.aspx)。请参阅[表达式树可视化工具示例](http://msdn.microsoft.com/en-us/library/bb397975.aspx)和[如何：实现表达式树访问器](http://msdn.microsoft.com/en-us/library/Bb882521.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T13:39:59.847

实际上，不，这在反射中是不可能的。反射的主要目的是在运行时提供元数据检查信息。您要的是实际的代码检查信息。

我相信可以在运行时获取表示方法的 IL 的实际字节。然而，它只是一个字节数组。您必须手动将其解释为 IL 操作码，并使用它来确定调用了哪些方法。不过，这几乎肯定不是您想要的。

虽然可以使用表达式树 lambda 并分析它以进行方法调用。然而，这不能在任何任意 lambda 表达式上完成。它必须是一个表达式树 lambda 表达式。

[http://msdn.microsoft.com/en-us/library/bb397951.aspx](http://msdn.microsoft.com/en-us/library/bb397951.aspx)

# macos - 有没有一种快速简便的方法来转储 MacOS X 钥匙串的内容？

> ID：717095
> 
> 赞同：36
> 
> 时间：2009-04-04T13:37:48.743
> 
> 标签：macos, applescript, keychain

我正在寻找一种将 OS X 钥匙串的内容转储（导出）到我可以在其他地方轻松处理的文件的方法，例如制表符分隔的纯文本或类似的东西。

Keychain Access 应用程序不提供任何此类功能，并且获取密钥数据涉及依次打开每个密钥，并且每次都必须输入密钥链的密码才能查看与密钥一起存储的密码。

经过一番挖掘，我找到了使用 AppleScript 和 Keychain Scripting 应用程序访问钥匙串的解决方案（无法链接到单个帖子；向下滚动大约三分之二到页面末尾）：

[http://discussions.apple.com/thread.jspa?threadID=1398759](http://discussions.apple.com/thread.jspa?threadID=1398759)

使用钥匙串脚本，您可以访问所有钥匙的所有数据字段——包括明文密码！– 将这些数据转储到文本文件等中相当容易。我已经对其进行了测试，并且效果很好。

但是，此解决方案仍然需要通过单击对话框上的确定来确认对每个键的访问。这比每次都必须输入钥匙串的密码要好得多，但它仍然很烦人。此外，您必须为每个密钥确认两次访问；一次用于脚本编辑器（或脚本本身，如果它作为应用程序运行），一次用于钥匙串脚本。因此，如果您正在处理具有 100 个键的钥匙串，则必须在 200 个对话框上手动单击“确定”。

我现在正在寻找解决这个问题的解决方案。我意识到，由于钥匙串的目的是保护敏感数据并准确防止我正在尝试做的事情，因此任何此类解决方案都可能涉及某种黑客攻击。

我会对你的想法很感兴趣！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-04T15:27:08.763

好吧，我傻了。有一个名为的命令行工具`security`可以做到这一点（以及钥匙串上的许多其他操作）。

一个示例用法：

```
security dump-keychain -d login.keychain 
```

这会将 login.keychain（用户的默认钥匙串）中的所有数据转储为明文，包括密码。您**仍然**需要确认访问，但每个键只需要一次，而且它比使用 AppleScript 快得多（并且在尝试访问某些字段时不会抛出奇怪的错误）。这不是黑客。

如果没有该`-d`选项，它将转储除密码之外的所有字段。

密钥的转储数据如下所示（对于 Internet 密钥；程序密钥和证书具有其他字段，但格式相同）：

```
keychain: "/Users/<username>/Library/Keychains/login.keychain"
class: "inet"
attributes:
    0x00000007 <blob>="tech.slashdot.org (<username for this web login>)"
    0x00000008 <blob>=<NULL>
    "acct"<blob>="<username for this web login>"
    "atyp"<blob>="form"
    "cdat"<timedate>=0x32303038303432333038323730355A00  "20080423082705Z\000"
    "crtr"<uint32>=<NULL>
    "cusi"<sint32>=<NULL>
    "desc"<blob>="Kennwort des Web-Formulars"
    "icmt"<blob>="default"
    "invi"<sint32>=<NULL>
    "mdat"<timedate>=0x32303038303432333038323730355A00  "20080423082705Z\000"
    "nega"<sint32>=<NULL>
    "path"<blob>=<NULL>
    "port"<uint32>=0x00000000 
    "prot"<blob>=<NULL>
    "ptcl"<uint32>="http"
    "scrp"<sint32>=<NULL>
    "sdmn"<blob>=<NULL>
    "srvr"<blob>="tech.slashdot.org"
    "type"<uint32>=<NULL>
data:
"<the plaintext password for this key>" 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-01-06T13:56:17.650

**请阅读：** [https ://gist.github.com/rmondello/b933231b1fcc83a7db0b](https://gist.github.com/rmondello/b933231b1fcc83a7db0b)

忽视： - - -

我在每个键中找到了“始终允许”对话框的解决方案！

只需使用 sudo 运行上一个命令。

```
sudo security dump-keychain -d login.keychain 
```

这样，您只需输入两次密码。一个在终端上用于 sudo，另一个用于解锁钥匙串！;)

祝你今天过得愉快！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-02T17:57:00.940

实际上我只是在寻找相同的东西： 有人发布的来自 github 的修改后的 applescript。要在 ScriptEditor 中运行，并且必须在 Preferences & Security 中允许。

```
set keychainPassword to "yourpasswordgoeshere"

tell application "System Events"
    repeat while exists (processes where name is "SecurityAgent")
        tell process "SecurityAgent"
            delay 0.1
            try
                set value of text field 1 of window 1 to keychainPassword
                click button "Allow" of window 1
            end try
        end tell
    end repeat
end tell 
```

您必须分别单击每个窗口才能激活它们。为此，我使用了多年前从 runescape 知道的工具“murgaa auto clicker”（[http://www.murgaa.com/auto-clicker-mac/](http://www.murgaa.com/auto-clicker-mac/)似乎仍然有效）。您只需设置自动单击的快捷方式（例如，Command+R）并将计时器设置为 10 毫秒，它就像魅力一样工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-01T21:40:37.170

更新，现在有一个工具可以很好地做到这一点：

> Keychaindump 是一个概念验证工具，用于以 root 身份读取 OS X 钥匙串密码。它在安全进程的内存空间中寻找未锁定的钥匙串主密钥，并使用它们来解密钥匙串文件。

来源：[https ://github.com/juuso/keychaindump](https://github.com/juuso/keychaindump)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2015-02-18T20:00:18.907

我找到了不多次单击“允许”的解决方案

```
sudo su
security dump-keychain -d /Users/YourUsername/Library/Keychains/login.keychain 
```

# sqlite - mac上有没有好的免费的SQLlite图形管理工具？

> ID：717097
> 
> 赞同：0
> 
> 时间：2009-04-04T13:38:11.927
> 
> 标签：sqlite, database-administration

我知道 Firefox 有一个 SQLite 管理器扩展，但实际上，我不喜欢在 Web 浏览器中这样做。这完全不酷。我不想为此安装 Firefox。;)

我希望还有其他好的工具，尽管那个 firefox 选项看起来还不错。但是让我们看看那里是否有更好的东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T14:19:19.690

有一个 Firefox 扩展，我发现它非常有用：

[SQLite 管理器](https://addons.mozilla.org/en-US/firefox/addon/5817)

这也应该在 OSX 上工作......

# html - 从html中提取标题标签

> ID：717100
> 
> 赞同：2
> 
> 时间：2009-04-04T13:39:48.177
> 
> 标签：html, tags, extract, title

我想从 html 字符串中提取标题标签的内容。我已经进行了一些搜索，但到目前为止我无法在 VB/C# 或 PHP 中找到这样的代码。这也应该适用于大写和小写标签，例如应该适用于`<title></title>`和 < `TITLE></TITLE>`。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T13:52:04.107

您可以为此使用正则表达式，但它并非完全防错。如果你只是想要一些简单的东西（在 PHP 中），它会做：

```
function get_title($html) {
  return preg_match('!<title>(.*?)</title>!i', $html, $matches) ? $matches[1] : '';
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T13:51:20.553

听起来像是正则表达式的工作。这将取决于 HTML 的格式是否正确，即仅在 head 元素中找到 title 元素。

```
 Regex regex = new Regex( ".*<head>.*<title>(.*)</title>.*</head>.*",
                          RegexOptions.IgnoreCase );
 Match match = regex.Match( html );
 string title = match.Groups[0].Value; 
```

我面前没有正则表达式备忘单，因此可能需要稍作调整。请注意，在不存在 title 元素的情况下也不会进行错误检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-06T09:08:47.810

如果标题标签中有任何属性（这不太可能但可能发生），您需要按如下方式更新表达式：

```
$title = preg_match('!<title.*>(.*?)</title>!i', $url_content, $matches) ? $matches[1] : ''; 
```

# c# - 社交网络应用程序设计

> ID：717103
> 
> 赞同：0
> 
> 时间：2009-04-04T13:40:16.103
> 
> 标签：c#, oop

我正在尝试确定将访问多个不同社交网络 API 的应用程序的最佳设计。这是一个我还没有确定的界面，因为它感觉不太对劲。我想知道解决这个问题的更好的设计方法......

```
public interface ISocialNetworkAPI<TApiEntity> where TApiEntity : SocialNetworkEntity
{
    List<TApiEntity> GetAllFollowersFor(string networkUserName);
    List<TApiEntity> GetAllFriendsFor(string networkUserName);
    List<long> GetFollowerIdsFor(long networkUserId);
    List<long> GetFollowerIdsFor(string networkUserName);
    List<long> GetFriendIdsFor(string networkUser);
    TApiEntity GetUser(string networkUserName);
} 
```

我还计划使用 DI 容器根据调用的上下文注入适当的社交网络具体对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T13:47:43.853

你看过[OpenSocial](http://code.google.com/apis/opensocial/)吗？这是 Google 对标准社交网络 API 的尝试。如果不直接使用它，也许您应该对其进行建模。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T00:16:40.330

您可能会查看适配器设计模式......每个适配器都将遵循您上面的接口。MySpaceAPIAdapter、FacebookAPIAdapter...

# azure - 构建多租户应用程序的最佳实践是什么？

> ID：717105
> 
> 赞同：11
> 
> 时间：2009-04-04T13:42:02.540
> 
> 标签：azure, cloud, relational, saas

构建支持多租户（例如软件即服务）的应用程序的最佳实践是什么？

非常感谢扩展此主题的白皮书链接。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-04T13:55:34.270

对于数据库：

**A. 将所有内容放在同一个数据库中，在您的表上放置一个tenant_id 列**

优点：容易做

缺点：非常容易出现错误：很容易将数据从一个租户泄漏到另一个租户。

**B. 将所有内容放在同一个数据库中，但将每个租户放在自己的命名空间中**（postgresql 称它们为模式）

优点：提供比选项 A 更好的数据泄漏保护

缺点：并非所有数据库都支持。AFAIK PostgreSQL 和 Oracle 支持它。

**C. 每个租户设置一个数据库**

优点：绝对不会有数据从一个租户泄漏到另一个租户的机会

缺点：设置新租户更加复杂。数据库连接很昂贵。

我只是从 Guy Naor 那里学到了上述想法。这是他的演示文稿的链接：http: [//aac2009.confreaks.com/06-feb-2009-14-30-writing-multi-tenant-applications-in-rails-guy-naor.html](http://aac2009.confreaks.com/06-feb-2009-14-30-writing-multi-tenant-applications-in-rails-guy-naor.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-04T13:55:52.057

您可能会在 Oren Eini 的一系列博客文章中找到一些有价值的建议。

这是该系列的最后一篇文章，带有以前文章的链接：http: [//ayende.com/Blog/archive/2008/08/16/Multi-Tenancy--Approaches-and-Applicability.aspx](http://ayende.com/Blog/archive/2008/08/16/Multi-Tenancy--Approaches-and-Applicability.aspx)

# iphone - 您会将 SQLite 数据库文件放在 iPhone 应用程序的什么位置？

> ID：717108
> 
> 赞同：34
> 
> 时间：2009-04-04T13:42:51.230
> 
> 标签：iphone, sqlite

当我最初为我的应用程序创建一个带有预插入数据集的 SQLite 数据库文件时，我必须将此文件放在我的 Xcode 项目中的某个位置，以便它转到我的 iPhone 应用程序。我想“资源”是正确的地方。

在 iPhone 应用程序中部署 SQLite 数据库文件的基本“步骤”是什么？

*   手动创建数据库
*   将数据库文件添加到项目中（在哪里？）

我目前正在阅读整个 SQLite 文档，尽管这与 iPhone 无关。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-04-04T13:48:35.833

您需要先将 SQLite 文件添加到您的 Xcode 项目中 - 最合适的位置是在资源文件夹中。

然后在您的应用程序委托代码文件中，在 appDidFinishLaunching 方法中，您需要首先检查 SQLite 文件的可写副本是否已创建 - 即：SQLite 文件的副本已在用户文件夹中创建iPhone 的文件系统。如果是，你什么也不做（否则你会用默认的 Xcode SQLite 副本覆盖它）

如果不是，则将 SQLite 文件复制到那里 - 使其可写。

请参阅下面的代码示例来执行此操作：这取自 Apple 的 SQLite 书籍代码示例，其中从应用程序委托 appDidFinishLaunching 方法调用此方法。

```
// Creates a writable copy of the bundled default database in the application Documents directory.
- (void)createEditableCopyOfDatabaseIfNeeded {
    // First, test for existence.
    BOOL success;
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSError *error;
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *writableDBPath = [documentsDirectory stringByAppendingPathComponent:@"bookdb.sql"];
    success = [fileManager fileExistsAtPath:writableDBPath];
    if (success)
        return;
    // The writable database does not exist, so copy the default to the appropriate location.
    NSString *defaultDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"bookdb.sql"];
    success = [fileManager copyItemAtPath:defaultDBPath toPath:writableDBPath error:&error];
    if (!success) {
        NSAssert1(0, @"Failed to create writable database file with message '%@'.", [error localizedDescription]);
    }
} 
```

=============

这是 Swift 2.0+ 中的上述代码

```
// Creates a writable copy of the bundled default database in the application Documents directory.
private func createEditableCopyOfDatabaseIfNeeded() -> Void
{
    // First, test for existence.
    let fileManager: NSFileManager = NSFileManager.defaultManager();
    let paths:NSArray = NSSearchPathForDirectoriesInDomains(.DocumentDirectory, .UserDomainMask, true)
    let documentsDirectory:NSString = paths.objectAtIndex(0) as! NSString;
    let writableDBPath:String = documentsDirectory.stringByAppendingPathComponent("bookdb.sql");

    if (fileManager.fileExistsAtPath(writableDBPath) == true)
    {
        return
    }
    else // The writable database does not exist, so copy the default to the appropriate location.
    {
        let defaultDBPath = NSBundle.mainBundle().pathForResource("bookdb", ofType: "sql")!

        do
        {
            try fileManager.copyItemAtPath(defaultDBPath, toPath: writableDBPath)
        }
        catch let unknownError
        {
            print("Failed to create writable database file with unknown error: \(unknownError)")
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-05T03:37:28.773

如果您只是要查询数据，您应该能够将其保留在主包中。

然而，这可能不是一个好的做法。如果您将来要扩展您的应用程序以允许写入数据库，则您必须重新解决所有问题......

# flex3 - 多个文本区域上的 flex 编辑菜单操作

> ID：717116
> 
> 赞同：1
> 
> 时间：2009-04-04T13:48:12.230
> 
> 标签：flex3, air

我有一个网格，其中一列将 itemrenderer 作为 textarea。我的应用程序是菜单控制的。现在我想使用菜单项对文本区域执行编辑操作。

就像我从网格中的文本区域中选择一些文本一样，然后我选择一个菜单项“剪切”，然后它应该从文本区域中剪切选定的文本。以这种方式，我会撒谎来执行所有操作。

我不知道如何获得该操作将在哪个文本区域上执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T21:35:02.217

在您的菜单项单击处理程序中，尝试：

```
var fcs:IFocusManagerComponent = focusManager.getFocus();
if(fcs is TextArea)
{
    var txt:String = TextArea(fcs).text;
    System.setClipboard(txt);
} 
```

# python - Python 的 subprocess.Popen 返回相同的标准输出，即使它不应该

> ID：717120
> 
> 赞同：1
> 
> 时间：2009-04-04T13:49:46.627
> 
> 标签：python, subprocess, stdout, popen

我对 Python 的 subprocess.Popen 有一个非常奇怪的问题。我正在使用它多次调用外部 exe 并将输出保存在列表中。

每次调用这个外部 exe 时，它​​都会返回**一个不同的字符串**。但是，如果我使用 Popen 多次调用它，它总是会**返回 SAME string**。=:-O

看起来 Popen 总是从标准输出返回相同的值，而无需调用 exe。也许在不实际再次调用 exe 的情况下进行某种缓存。

这是我的代码：

```
def get_key():

    from subprocess import Popen, PIPE

    args = [C_KEY_MAKER, '/26', USER_NAME, ENCRYPTION_TEMPLATE, '0', ]
    process = Popen(args, stdout=PIPE)
    output = process.communicate()[0].strip()
    return output

if __name__ == '__main__':
    print get_key() # Returns a certain string
    print get_key() # Should return another string, but returns the same! 
```

我到底做错了什么？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-14T11:08:41.660

有可能（如果`C_KEY_MAKER`的随机行为基于以秒为单位的当前时间，或类似的）当您在命令行上运行两次时，两次运行之间的时间发生了变化，因此您得到不同的输出，但是当 python运行它，它连续运行两次，时间没有改变，所以它连续两次返回相同的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T13:59:45.243

没有。在我自己的测试中，这很好用（除了底部的缩进错误）。问题出在您的 exe 中。或其他地方。

为了澄清，我创建了一个 python 程序 tfile.py

```
cat > tfile.py
#!/usr/bin/env python
import random
print random.random() 
```

然后修改程序以摆脱底部的缩进问题，并调用 tfile.py 。它确实给出了两种不同的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T23:38:53.090

我不知道您的示例出了什么问题，我无法复制这种行为，但是请尝试一种更循规蹈矩的方法：

```
def get_key():

    from subprocess import Popen, PIPE

    args = [C_KEY_MAKER, '/26', USER_NAME, ENCRYPTION_TEMPLATE, '0', ]
    output = Popen(args, stdout=PIPE).stdout
    data = output.read().strip()
    output.close()
    return data 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T14:10:51.550

您的代码不能按原样执行，因此很难为您提供太多帮助。考虑修复缩进和语法并使其独立，以便我们尝试一下。

在 Linux 上，根据 Devin Jeanpierre 的说法，它似乎工作正常。

# nhibernate - 为 NHibernate 配置 Log4Net

> ID：717130
> 
> 赞同：0
> 
> 时间：2009-04-04T13:53:56.333
> 
> 标签：nhibernate, log4net

这一定是一个更糟糕的问题：

在我的测试项目中，我正在尝试配置 log4net。以下方法调用给出了错误。

BasicConfigurator.Configure();

“预期类型名称，但找到方法”

我在看什么？

谢谢，尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T14:25:34.027

这是编译时错误还是运行时错误？`using log4net.Config`你的类文件中有声明吗？如果您将其更改为引用完整的类名，它仍然会发生吗？

```
log4net.Config.BasicConfigurator.Configure(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T16:01:02.020

我不确定链接到博客条目是否被禁止...

如果你想记录 NHibernate 的东西，我会这样做：

[如何在 NUnit 中显示 Log4Net 信息（来自 NHibernate）](http://elegantcode.com/2008/07/29/how-to-show-log4net-info-in-nunit-from-nhibernate/)

我这里还有一个更基本的入门指南：

[Log4Net 入门](http://elegantcode.com/2007/12/07/getting-started-with-log4net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T17:05:57.300

哎呀..我试图在错误的上下文中执行此操作。我将方法调用添加到我的测试项目的构造函数中，我们很好。

# html - 在 HTML 中做旁注的可靠方法是什么？

> ID：717131
> 
> 赞同：7
> 
> 时间：2009-04-04T13:53:57.503
> 
> 标签：html, css

我在网上发布了很多文本，甚至还为我编写了一个格式化 HTML的[系统。](http://code.google.com/p/typografix)现在，我有一个问题：我想像书籍一样在 HTML 页面中制作旁注。只是为了解释一下，旁注是紧挨着主体文本的页边空白处的那些注释。

有谁知道一种好的、可靠的方法——最好使用纯 CSS 而不是 JavaScript。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T14:03:16.750

好的，让浏览器**更加**友好（FF3、IE7/8、Chrome）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html>
<head>
  <title>Layout</title>
  <style type="text/css">
    html, body, #wrapper { height: 100%; margin: 0; padding: 0; }
    body { background-color: #666; width: 100%; text-align: center; font-family: Arial, sans-serif; }
    #wrapper { width: 960px; margin: 0 auto; background: white; padding: 20px 0; }
    #page { width: 660px; margin: 0 auto; text-align: justify; }
    div.sidenote-left { float: left; margin-left: -150px; }
    div.sidenote-right { float: right; margin-right: -150px; }
    div.sidenote-left, div.sidenote-right { width: 150px; text-align: left; }
    div.sidenote-left div, div.sidenote-right div { margin: 0 10px; border: 1px solid #666; padding: 4px; }
  </style>
</head>
<body>
<div id="wrapper">
<div id="page">
<p>In the 90s we saw the rise of GUIs (yes I know Macs were around in the 80s but GUIs became the standard for everyone once Windows took hold). This transition had many casualties like Lotus 1-2-3 (which was basically killed by Excel on Windows) and Wordperfect (MS Word killed it). Now you can argue that MS had the inside track since they also produced Windows and you'd be right but beyond that I think MS adjusted to the change quicker than anyone else.</p>
<p>Borland was still an agile little company back then. It adjusted and took its highly successful Turbo Pascal and created Delphi.</p>
<div class="sidenote-left"><div>See Chapter 7 for further explanation</div></div>
<p>Now truly compiled languages ruled the roost in the 1990s with the exception of one little upstart: Java, which was something basically new. It was sorta compiled, sorta interpreted (being compiled into machine-independent bytecode that ran on a virtual machine). I personally think that the rise of both Java and Netscape scared the absolute bejesus out of Microsoft in the late 90s.</p>
<div class="sidenote-right"><div>See Chapter 9 for further explanation</div></div>
<p>Borland adjusted reasonably well producing what was really the first really successful Java IDE in JBuilder.</p>
<p>They were fending off a resurgent Microsoft who also produced successive versions of Visual Studio that (imho) were years ahead of their time in the late 90s. I can remember coding Visual C++ with MTS (microsoft Transaction Server) DCOM objects over 10 years ago and that was a precursor to the modern application server platform we have today. Remote debugging and the like were things that were (or at least seemed) light years ahead on Visual Studio.</p>
</div>
</div>
</body>
</html> 
```

**注意：**针对文本选择问题，我尝试了绝对定位，您可以通过更改此 CSS 来做到这一点：

```
div.sidenote-left { position: absolute; margin-left: -150px; }
div.sidenote-right { position: absolute; margin-left: 660px; } 
```

但它仍然选择文本。

我看到的唯一方法是将您的页面更改为 2/3 列格式，其中旁注位于其他列中。唯一的问题是您失去了相对于文本移动注释的能力。或者至少我想不出解决办法。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-04-04T21:46:37.027

如果您很懒惰，请使用 CSS 框架！您可以使用的最简单的框架之一是[960.gs](http://960.gs)。这将帮助您在几分钟内完成您想要做的事情。

# windows-live-id - Windows Live ID 在不同应用程序上为同一用户返回不同的用户令牌？

> ID：717138
> 
> 赞同：1
> 
> 时间：2009-04-04T13:56:16.453
> 
> 标签：windows-live-id, windows-live

**Windows Live ID 似乎正在为不同应用程序上的同一用户返回不同的用户令牌。**

这是独家新闻。

Windows Live ID 应该（我认为）给我唯一的用户令牌。我想用它来识别用户。我的应用程序是 2 部分... 1 = ASP.NET webapp...2 是 WPF。（相同的数据库/用户表）

**问题：**

当用户登录到 ASP.Net - 我得到 UserToken = 00202009399。

当用户登录到 WPF - 我得到 UserToken = 00829909233。

**问题：**

*   这是一个故障吗？如果是这样 - 什么是解决方法？

（如果这是计划中的行为 - 我只能认为 MS 想要为每个应用程序或域分离用户令牌）

*   是否有设置告诉 LiveID 这两个不同的应用程序（WPf 和 A​​SP.Net）来自同一个 Orginization/Owner/Azure 帐户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-06T19:49:00.377

我知道这个答案在游戏中已经很晚了。Windows Live ID 为登录到您的站点的每个 Windows Live 用户提供了一个唯一的、特定于站点的标识符。它的设计方式是允许用户从一个站点到另一个站点的机密性和安全性。

> 是否有设置告诉 LiveID 这两个不同的应用程序（WPf 和 A​​SP.Net）来自同一个 Orginization/Owner/Azure 帐户？

如果您希望具有相同的标识符，则必须使用相同的 App Id。如果您想维护您正在登录的应用程序的一部分，您可以使用[上下文参数](http://msdn.microsoft.com/en-us/library/bb676638.aspx)来设置要返回的路径，唯一的要求是它们必须在您注册应用程序时设置的同一个域中。

# c# - 有什么方法可以在 C# 中使这个工作双核？

> ID：717139
> 
> 赞同：0
> 
> 时间：2009-04-04T13:56:29.043
> 
> 标签：c#, loops, multicore

我有一段代码循环遍历数组并在其中查找相似和相同的字符串 - 标记它是否唯一。

```
loop X array for I 
 ( loop X array for Y
   (
     If X is prefix of Y do. else if x is same length as Y and it's prefix do something.
   )
Here is the code to finilize everything for I and corresponding (found/not found) matches in Y.
 ) 
```

我想让这个双核多线程。据我所知，这是不可能的，但您很可能会有一些想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T14:11:33.173

我了解您想知道的问题，如何并行化此代码：

我认为你会从使用更好的算法中获得更多的加速：例如对数组进行排序（你可以使用并行合并排序）并且只比较相邻的条目。然后，您还可以通过单独的线程处理数组的每一半，轻松地并行进行比较。

如果您需要更多详细信息，请告诉我们...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T14:27:29.030

并行算法可能如下所示：

*   使用并行排序算法按字母顺序对术语列表进行排序
*   将排序后的术语列表分成块，这样所有有趣的术语都在同一个块中。如果我没记错的话，只要每个块都以相同的字符开头，你就永远不会在两个块之间有有趣的匹配（匹配和前缀总是有相同的第一个字符，对吗？）
*   对于每个块，找到前缀和/或匹配项，并采取适当的措施。这应该很容易，因为匹配的术语将彼此相邻（因为大列表已排序，每个块也将是）。

一些注意事项：

这需要并行排序算法。显然这些存在，但我对它们知之甚少，因为我从来没有直接使用过它们。你的旅费可能会改变。

第二步（将工作负载分成块）本身似乎不是可并行化的。您可以通过修改后的二进制搜索来实现它，以查找第一个字符发生变化的位置，因此希望这部分很便宜，但可能不会，而且您可能在测量之前无法确定。

如果你最终得到很多块，其中一个是迄今为止最大的，你的表现就会很糟糕。

您是否考虑过保持算法单线程，但更改它以便第一步对列表进行排序？

目前，问题中描述的算法是**O(n^2)**，因为它在列表中的每个元素循环一次。如果列表已排序，则可以在一次遍历列表中找到重复项（重复项将彼此相邻）——包括排序，这是**O(n log n)**的总成本。对于大型数据集，这将快得多、快得多。希望它足够快，您可以避免多个线程，这将是很多工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T14:00:56.880

如果数组大小相当大，您可以从并行化中获得一些好处，也许将数组一分为二并并行处理每一半。您应该查看[并行框架](http://en.wikipedia.org/wiki/Parallel_FX_Library)来执行多线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T14:03:24.440

我不确定 .net 的并行扩展是否是您的答案。您可以从[下载页面](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en)和[项目的博客中查看](http://blogs.msdn.com/pfxteam/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T14:14:32.323

一般来说，这个想法是让一个线程处理一半的数据，另一个线程处理另一半——即，线程一执行奇数索引，线程二执行偶数。不幸的是，没有足够的关于您的问题的信息来给出任何合理的答案，因为我们不知道各种操作之间是否存在任何依赖关系。例如，假设我确实找到了前缀匹配，这意味着我想修改数组中的下一个元素以删除其中的任何前缀。显然，这种依赖会破坏幼稚的并行实现。但是，如果您对数据的操作是独立的，那么通过简单地划分工作，这应该很容易并行化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T14:42:55.703

如果中间检查是一个长时间运行的过程，您可以将其作为单独的线程运行，然后最后加入所有线程（因为您有这么多线程使用线程池，限制为 2 个线程 - 您不应该启动所有线程运行，等待完成一个启动一个新的等-)。

最后，只需 join() 所有线程，就是这样。

# python - Queue.Queue 与 collections.deque

> ID：717148
> 
> 赞同：226
> 
> 时间：2009-04-04T14:03:09.900
> 
> 标签：python, queue, thread-safety, python-multithreading, deque

我需要一个队列，多个线程可以将内容放入其中，并且多个线程可以从中读取。

Python 至少有两个队列类，`Queue.Queue`和`collections.deque`，前者似乎在内部使用后者。两者都声称在文档中是线程安全的。

但是，队列文档还指出：

> collections.deque 是无界队列的替代实现，具有**不需要锁定的快速原子 append() 和 popleft() 操作。**

我想我不太明白：这是否意味着双端队列毕竟不是完全线程安全的？

如果是这样，我可能无法完全理解这两个类之间的区别。我可以看到 Queue 添加了阻塞功能。另一方面，它失去了一些双端队列特性，比如对 in-operator 的支持。

直接访问内部双端队列对象是

> x in Queue().deque

线程安全？

另外，**当双端队列已经是线程安全的时，为什么队列要为其操作使用互斥锁？**

* * *

## 回答 #1

> 赞同：347
> 
> 时间：2009-04-04T15:26:29.343

`Queue.Queue`并`collections.deque`服务于不同的目的。Queue.Queue 旨在允许不同的线程使用排队的消息/数据进行通信，而仅用作数据`collections.deque`结构。这就是为什么`Queue.Queue`有像`put_nowait()`,`get_nowait()`和`join()`, 而`collections.deque`没有的方法。`Queue.Queue`不打算用作集合，这就是为什么它缺少`in`运算符之类的原因。

归结为：如果您有多个线程并且您希望它们能够在不需要锁的情况下进行通信，那么您正在寻找`Queue.Queue`; 如果您只想将队列或双端队列作为数据结构，请使用`collections.deque`.

最后，访问和操作 a 的内部双端队列`Queue.Queue`是在玩火——你真的不想这样做。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2013-12-02T14:20:14.690

如果您正在寻找的只是**一种在线程之间传输对象的线程安全方式**，那么两者都可以工作（对于 FIFO 和 LIFO）。对于先进先出：

*   [`Queue.put()`并且`Queue.get()`是线程安全的](http://docs.python.org/2/library/queue.html#)
*   [`deque.append()`并且`deque.popleft()`是线程安全的](http://docs.python.org/2/library/collections.html#deque-objects)

笔记：

*   其他操作`deque`可能不是线程安全的，我不确定。
*   `deque`不会阻塞，`pop()`或者`popleft()`您不能将您的消费者线程流基于阻塞，直到新项目到达。

但是，deque 似乎**具有显着的效率优势**。以下是使用 CPython 2.7.3 插入和删除 100k 项的一些基准测试结果

```
deque 0.0747888759791
Queue 1.60079066852 
```

这是基准代码：

```
import time
import Queue
import collections

q = collections.deque()
t0 = time.clock()
for i in xrange(100000):
    q.append(1)
for i in xrange(100000):
    q.popleft()
print 'deque', time.clock() - t0

q = Queue.Queue(200000)
t0 = time.clock()
for i in xrange(100000):
    q.put(1)
for i in xrange(100000):
    q.get()
print 'Queue', time.clock() - t0 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-12-12T11:41:50.660

有关信息，请参阅双端队列线程安全 ( [https://bugs.python.org/issue15329](https://bugs.python.org/issue15329) ) 的 Python 票证。标题“阐明哪些双端队列方法是线程安全的”

这里的底线：[https ://bugs.python.org/issue15329#msg199368](https://bugs.python.org/issue15329#msg199368)

> 双端队列的 append()、appendleft()、pop()、popleft() 和 len(d) 操作在 CPython 中是线程安全的。append 方法的末尾有一个 DECREF（对于设置了 maxlen 的情况），但这发生在所有结构更新完成并且不变量已恢复之后，因此可以将这些操作视为原子操作。

无论如何，如果您不是 100% 确定并且您更喜欢可靠性而不是性能，那么只需放一个 Lock ;)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-04-19T16:08:31.030

所有单元素方法`deque`都是原子的和线程安全的。所有其他方法也是线程安全的。之类的东西会`len(dq)`产生`dq[4]`暂时的正确值。但是请考虑一下`dq.extend(mylist)`：当其他线程也在同一侧附加元素时，您不能保证所有元素`mylist`都连续归档 - 但这通常不是线程间通信和被质疑任务的要求。

所以 a`deque`比`Queue`（在引擎盖下使用 a `deque`）快约 20 倍，除非您不需要“舒适”同步 API（阻塞/超时）、严格`maxsize`遵守或*“覆盖这些方法（_put、_get、.. ) 来实现其他队列组织*的子类化行为，或者当你自己处理这些事情时，那么`deque`对于高速线程间通信来说，裸机是一个很好且有效的处理。

事实上，大量使用额外的互斥锁和额外的方法`._get()`等方法调用`Queue.py`是由于向后兼容性限制、过去的过度设计以及缺乏为线程间通信中的这一重要速度瓶颈问题提供有效解决方案的考虑。在较旧的 Python 版本中使用了一个列表 - 但即使 list.append()/.pop(0) 也是 & 是原子和线程安全的......

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-12-25T18:07:35.950

添加`notify_all()`到每个`deque` `append`和`popleft`导致`deque`比默认[行为](https://stackoverflow.com/a/20330499/3427777)[实现的 20 倍改进`deque`](https://stackoverflow.com/a/20330499/3427777)更糟糕的结果：

```
deque + notify_all: 0.469802
Queue:              0.667279 
```

@Jonathan 稍微修改了他的代码，我使用 cPython 3.6.2 获得了基准，并在 deque 循环中添加了条件来模拟 Queue 的行为。

```
import time
from queue import Queue
import threading
import collections

mutex = threading.Lock()
condition = threading.Condition(mutex)
q = collections.deque()
t0 = time.clock()
for i in range(100000):
    with condition:
        q.append(1)
        condition.notify_all()
for _ in range(100000):
    with condition:
        q.popleft()
        condition.notify_all()
print('deque', time.clock() - t0)

q = Queue(200000)
t0 = time.clock()
for _ in range(100000):
    q.put(1)
for _ in range(100000):
    q.get()
print('Queue', time.clock() - t0) 
```

并且似乎此功能限制了性能`condition.notify_all()`

> collections.deque 是无界队列的替代实现，具有不需要锁定的快速原子 append() 和 popleft() 操作。 [文档队列](https://docs.python.org/3/library/queue.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-04T14:42:23.863

`deque`是线程安全的。“不需要锁定的操作”意味着您不必自己进行锁定，它`deque`会照顾它。

查看`Queue`源代码，内部双端队列被调用`self.queue`并使用互斥锁进行访问器和突变，因此*使用起来不是*`Queue().queue`线程安全的。

 *如果您正在寻找“in”运算符，那么双端队列或队列可能不是最适合您的问题的数据结构。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-28T09:31:09.400

（似乎我没有评论的声誉......）您需要注意从不同线程使用的双端队列方法。

deque.get() 似乎是线程安全的，但我发现这样做

```
for item in a_deque:
   process(item) 
```

如果另一个线程同时添加项目，则可能会失败。我得到了一个 RuntimeException，它抱怨“在迭代过程中双端队列发生了突变”。

检查[collectionsmodule.c](https://hg.python.org/cpython/file/3.5/Modules/_collectionsmodule.c)以查看哪些操作受此影响

# c# - 具有触摸屏功能的 Windows 应用 (C++/C#) 屏幕键盘

> ID：717155
> 
> 赞同：2
> 
> 时间：2009-04-04T14:09:16.797
> 
> 标签：c#, windows, touchscreen, on-screen-keyboard

将在没有物理键盘的设备上制作应用程序
寻找触摸屏应用程序的最佳实践。
您在 Windows 设备上使用哪些商业/免费屏幕键盘或屏幕数字键盘？
或者我们应该使用库来实现我们自己的输入设备？
目前使用的是标准的windows osk.exe，但我认为它太小了，无法获得良好的触摸屏体验。

更新：我们决定制作自己的键盘，num 小键盘控件（虽然 windows7 小键盘看起来更好）

![替代文字](https://i.stack.imgur.com/tOEkX.jpg)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T14:58:35.260

没有真正的答案，只是一点建议。我一直在 Windows mobile 中设计 PDA 应用程序，我发现最好的解决方案是尽可能地消除键盘。花一些额外的时间在设计上，使用选择控件而不是文本框来实现有效的 GUI。无论使用哪种虚拟键盘，如果需要输入太多文本，您的用户可能会抱怨，因为它不直观。我已经做到了让用户通过 Intranet 接口自定义对字段的响应并将其保存在数据库中。然后，用户可以从 ddls 中选择“预设”响应并根据需要进行修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T06:10:01.760

我正在使用[Click-N-Type](http://www.lakefolks.org/cnt/)。有关更多详细信息和其他答案，请参阅[此问题](https://stackoverflow.com/questions/330348/which-on-screen-keyboard-for-touch-screen-application/330407)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-23T23:30:55.463

如果您是 .NET 开发人员，请查看可通过内置编辑器完全自定义的WPF 组件（ [http://fpscomponents.com/Product.aspx?id=8 ）。](http://fpscomponents.com/Product.aspx?id=8)所以程序员可以用自己的语言填充它并定义布局！

# oracle - 奇怪的 Oracle 问题

> ID：717161
> 
> 赞同：0
> 
> 时间：2009-04-04T14:11:03.813
> 
> 标签：oracle, select

我试着用一句话来表达，但最好举个例子：

```
SELECT * FROM someTable WHERE id = someID;

returns no rows
...
some time passes (no inserts are done to the table and no ID updates)
...

SELECT * FROM someTable WHERE id = someID;
returns one row! 
```

某些数据库机制是否有可能阻止第一个 SELECT 返回行？

Oracle 日志没有错误。

执行两个选择时不会回滚任何事务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T14:22:11.773

您无法在另一个会话中看到未提交的数据。提交是什么时候发生的？

EDIT1：你是唯一一个使用这个数据库的人吗？或者你有/有过多次会议吗？

我认为在另一个会话中，您或其他人插入了这一行，您进行了选择，但您看不到这一行。之后在另一个会话中发生提交（可能是隐式的，因为会话已关闭），然后当您再次选择时会看到此行。

我可以想到其他的解释，但我首先想知道你是不是只有一个人在使用这个数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T15:22:43.390

使用 Oracle 提供的读取一致性，您应该不会看到这样的行。如果您在具有自动提交的某种模式下运行，因此每个语句都是一个独立的事务，那么不会违反读取一致性。您使用哪个程序来访问数据库？我同意其他意见；如果您的会话未插入该行并且没有其他会话同时处于活动状态，则该行不应出现。我不知道沉迷于自发数据生成的 DBMS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T15:35:54.797

您没有在那个 Oracle中[安排作业吗？](http://www.oradev.com/dbms_scheduler.jsp)

# php - '通过' php 上传到亚马逊的 s3？

> ID：717166
> 
> 赞同：1
> 
> 时间：2009-04-04T14:16:37.137
> 
> 标签：php, upload, file-upload, amazon-s3

我已经看到了将文件直接上传到 S3 的方法，并且我已经看到了将文件上传到服务器上的方法。在将文件发送到 S3 之前，我需要修改文件的名称，但我不想将其存储在本地然后上传，如果我能提供帮助的话。有没有办法把它放在缓冲区或什么的？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T14:25:19.130

上传完成时，文件将始终首先出现在临时目录中，即使在您能够使用上传的文件之前也是如此。您之前获得了所有文件的块，然后默认情况下在 /tmp 目录中重建它。所以不，没有“通过”。但我想您可以在之后直接从临时目录重新上传，而不是将其移动到另一个工作目录。

# batch-file - 使用批处理文件递归重命名文件名+文件夹名

> ID：717171
> 
> 赞同：2
> 
> 时间：2009-04-04T14:20:23.993
> 
> 标签：batch-file, rename, batch-rename

我喜欢创建一个批处理文件（winxp cmd），它递归地遍历选择的文件夹和子文件夹，并使用以下规则重命名文件+文件夹：

从所有文件+文件夹名称中，所有大写+小写“V”和“W”字母都需要替换为字母“Y”和“Z”。

例如 11V0W 必须变成 11Y0Z。

我相信它可能与 FOR /R 但如何？我认为除了使用 FOR / R 进行基本递归之外，还需要调用一个子例程来逐个检查每个字母。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T15:39:58.950

以下批次至少对文件名执行此操作。目录有点棘手（至少到目前为止我想不出一个非无限的解决方案）：

```
@echo off
setlocal enableextensions
for /r %%f in (*) do call :process "%%f"
endlocal
goto :eof

:process
pushd "%~dp1"
set fn=%~nx1
set fn=%fn:V=Y%
set fn=%fn:W=Z%
ren "%~nx1" "%fn%"
popd
goto :eof 
```

但从理论上讲，将 dir 重命名到此应该不会太难。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-08-26T19:20:38.980

汤姆，摆弄我之前发布的一个脚本，这是一个处理所有文件和子目录的脚本：

**reurename.cmd** *目录*

```
@echo off
setlocal ENABLEDELAYEDEXPANSION
set Replaces="V=Y" "W=Z" "m=A"
set StartDir=%~dp1
call :RenameDirs "%StartDir:~0,-1%"
exit /b 0
:RenameDirs
    call :RenameFiles "%~1"
    for /f "delims=" %%d in ('dir /ad /b "%~1"2^>nul') do call :RenameDirs "%~1\%%~d"
    if "%~1"=="%StartDir:~0,-1%" exit /b 0
    set _pos=0
    set _dir=%~f1
    set _dir_orig=!_dir!
    :finddirName
        set /a _pos-=1
        call set _dir_pos=!!!_dir:~%_pos%,1!!!
        if not "%_dir_pos%"=="\" goto finddirName
        call set _origines=!!!_dir:~0,%_pos%!!!
        set /a _pos+=1
        call set _dir=!!!_dir:~%_pos%!!!
    for %%r in (%Replaces%) do call set _dir=!!!_dir:%%~r!!!
    if /i not "!_dir!"=="!_dir_orig!" echo move "%~1" "%_origines%\!_dir!"
    exit /b 0
:RenameFiles
    for /f "delims=" %%f in ('dir /a-d /b "%~1"2^>nul') do (
        set _file=%%~nf
        set _file_orig=!_file!
        for %%r in (%Replaces%) do call set _file=!!!_file:%%~r!!!
        if /i not "!_file!"=="!_file_orig!" echo ren "%~1\%%f" "%~1\!_file!%%~xf"
    )
    exit /b 0 
```

**___Notes____**
这是一个非破坏性脚本，从正确的命令中删除**回显以重命名任何文件/目录。**（**回声移动**和**回声仁**）

**Set Replaces=：**将此变量设置为您需要更改的任何对。

**设置 Startdir=：**我想以某种方式保护论点并仅从中获取路径。如果将文件作为参数给出，则将处理整个容器目录和子目录。

**if "%~1"=="%StartDir:~0,-1%" exit /b 0:**放置此行是为了停止处理参数目录本身。如果您愿意，请删除此行。**如果使用c:\temp\**
调用脚本，则删除此行最终会将名称更改为**c:\teAp\**。

 ***** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-04T08:05:26.910

使用此目录树：

```
.
├── 00v0w
│   ├── 12V0W
│   ├── 12d0w
│   └── 12v0d
├── 11V0W
├── 11d0w
└── 11v0d 
```

这些[重命名器](https://github.com/75lb/renamer)命令：

```
$ renamer --regex --find '[vV]' --replace 'Y' '**'
$ renamer --regex --find '[wW]' --replace 'Z' '**' 
```

会产生这个输出：

```
.
├── 00Y0Z
│   ├── 12Y0Z
│   ├── 12Y0d
│   └── 12d0Z
├── 11Y0Z
├── 11Y0d
└── 11d0Z 
```

# c# - 如何在控件之间添加动态间距？（附图片）

> ID：717174
> 
> 赞同：1
> 
> 时间：2009-04-04T14:22:10.837
> 
> 标签：c#, wpf, xaml, layout

我的问题很简单。实现您在 WPF 中看到的图片的最佳方法是什么？

目前这是一个水平 StackPanel，复选框的右填充设置为 90。这可以正常工作，但是如果您调整窗口大小，它就不再好，除非您重新调整窗口的调整大小事件中的填充，但是使用布局管理器时看起来很笨重。

我来自 Qt 背景，在 Qt 中，我会在按钮和复选框之间使用“拉伸”元素来动态地将它们分开。WPF中有类似的概念吗？如果没有，我该如何实现这一点，以便它支持动态调整大小？

![替代文字](https://i209.photobucket.com/albums/bb277/bresson29/details_two.png)

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T14:34:07.970

使用正确的[`Panel`](http://msdn.microsoft.com/en-us/library/system.windows.controls.panel.aspx)实现，在这种情况下 a[`Grid`](http://msdn.microsoft.com/en-us/library/system.windows.controls.grid.aspx)效果最好：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="Auto"/>
    </Grid.ColumnDefinitions>

    <CheckBox>Details</CheckBox>
    <Button Grid.Column="1">Exit</Button>
    <Button Grid.Column="2">Reset</Button>
</Grid> 
```

# php - 提取之间的所有内容

> ID：717176
> 
> 赞同：2
> 
> 时间：2009-04-04T14:22:14.223
> 
> 标签：php, regex

我正在使用 CURL 下载页面。现在我想从页面中提取它：

```
<object classid="clsid:67DABFBF-D0AB-41fa-9C46-CC0F21721616" width="640"
        height="303.33333333333"
        codebase="http://go.divx.com/plugin/DivXBrowserPlugin.cab"
        id="object701207571">
    <param name="autoPlay" value="false" />
    <param name="custommode" value="Stage6" />
    <param name="src" value="" />
    <param name="movieTitle" value="Titanic" />
    <param name="bannerEnabled" value="false" />
    <param name="previewImage" 
           value="http://stagevu.com/img/thumbnail/oripmqeqzrccbig.jpg" />
    <embed type="video/divx" src="" width="640" height="303.33333333333"
           autoPlay="false" custommode="Stage6" movieTitle="Titanic"
           bannerEnabled="false"
           previewImage="http://stagevu.com/img/thumbnail/oripmqeqzrccbig.jpg"
           pluginspage="http://go.divx.com/plugin/download/"
           id="embed701207571">
    </embed>
</object> 
```

请帮忙！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T14:44:38.960

这部分是对 Owens 的回应*（因为我不能很好地将代码放在评论中）*。该正则表达式可能不适用于对象标签，主要是因为开始`<object>`标签中包含属性。试试这个：

```
/(<object[^>]*>)(.*?)(<\/object>)/si 
```

它不区分大小写，并分为三个组以便于参考。它不是 100% 完美，但应该有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T14:33:43.667

请参阅[您能否提供一些示例，说明为什么使用正则表达式难以解析 XML 和 HTML？](https://stackoverflow.com/questions/701166/can-you-provide-some-examples-of-why-it-is-hard-to-parse-xml-and-html-with-a-rege)为什么这可能是错误的做法。

也就是说，您可能能够摆脱类似`/(<object>.*?<\/object>)/s`. 这匹配字符串`"<object>"`后跟任意数量的字符，直到字符串`"</object>"`。最后`s`的 告诉`.`匹配换行符（通常不匹配）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T17:30:01.777

使用 SimpleXML：

```
$sxe = new SimpleXMLElement($xml);
$objects = $sxe->xpath('//object[@id="object701207571"]');
$object = $objects[0];

$params = $object->xpath('param');

foreach($params as $param)
{
    $attrs = $param->attributes();
    echo $attrs['name'] . ' = ' . $attrs['value'] . "\n";
}

// Get plain XML:
echo $object->asXML(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T17:45:03.190

```
$doc = DOMDocument::loadHTML($html);
foreach($node->getElementsByTagName('object') as $object)
{
   echo $doc->saveXML($object);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T17:08:22.483

此正则表达式将匹配开始和结束标签之间的所有换行符，并将整个内容捕获在一组中

```
/(<object[^>]*?>(?:[\s\S]*?)<\/object>)/gi 
```

# emacs - 如何应用新的 Emacs C 样式来重新格式化所有源文件？

> ID：717177
> 
> 赞同：7
> 
> 时间：2009-04-04T14:22:19.510
> 
> 标签：emacs, lisp, elisp, code-formatting

我想使用适用于 emacs 的 Google 格式化功能重新格式化所有源文件：[google-c-style.el](http://google-styleguide.googlecode.com/svn/trunk/google-c-style.el)（请参见[此处](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Formatting)）。

如何一次将此功能应用于我的所有源文件，以便它们都根据 Google 样式正确格式化和缩进？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-04T14:46:27.457

这有几个部分：

*   你需要想出 EMACS 函数来做所有你想要的重新格式化。 `indent-region`是一个开始，但您可能还想取消制表符或其他一些事情。
*   您需要在每个文件上调用它们，并且由于缩进函数适用于范围，因此您需要一个设置标记以覆盖整个文件的函数：`mark-whole-buffer`.
*   您需要在每个文件上调用 EMACS：这意味着使用 --batch 文件调用 emacs。

[这里](http://blog.modp.com/2008/11/handy-emacs-functions-for-code-cleanup.html)和[这里](http://blog.modp.com/2008/11/using-emacs-reformat-source-files-in.html)有几篇关于这样做的不错的博客文章。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T18:24:27.587

我之前通过使用键盘定义的宏来完成此操作。我会将所有文件加载到 emacs（类似`find . -name "*.cpp" | xargs emacs`）中，然后键入以下键。我已经用它的作用注释了每个组合键。

```
C-x-(                  'Begin recording macro
M-<                    'Go to start of file
C-space                'Mark current location (now start of file)
M->                    'Go to end of file
M-x indent-region      'Indent entire file according to coding style
C-x C-s                'Save the current buffer
C-x C-k                'Close the current buffer
C-x-)                  'End recording macro 
```

现在您可以通过键入在缓冲区上运行它`C-x e`。如果你已经加载了几个文件，你可以运行类似`C-u 100 C-x e`在 100 个文件上运行的东西。如果这超过了文件的数量，那没关系，一旦所有处理完成，您只会收到一些“铃声”或其他可以忽略的错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T14:36:25.017

我相信这个脚本不会重新格式化。相反，它是如何构建自定义“样式”的示例，如下所述：[CC 模式手册 - 样式](http://www.gnu.org/software/emacs/manual/html_node/ccmode/Styles.html#Styles)

CC模式手册还说：

> 如果您想重新格式化旧代码，您可能最好使用其他工具，例如 GNU indent，它具有比 CC 模式更强大的重新格式化功能。

[CC 模式手册 - 限制和已知错误](http://cc-mode.sourceforge.net/html-manual/Limitations-and-Known-Bugs.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T17:48:11.193

如果您想在 dired 缓冲区中标记源文件，然后运行一个函数来格式化每个文件，您可以执行以下操作：

```
(defun clean-file(filename)
  (your-function-goes-here))

(defun clean-each-dired-marked-file() 
  (interactive)
  (for-each-dired-marked-file 'clean-file))

(defun for-each-dired-marked-file(fn)
 "Do stuff for each marked file, only works in dired window"
 (interactive)
 (if (eq major-mode 'dired-mode)
     (let ((filenames (dired-get-marked-files)))
       (mapcar fn filenames))
   (error (format "Not a Dired buffer \(%s\)" major-mode)))) 
```

# c# - 我想从 webuser'sdata 发送到 webuser'sdata

> ID：717187
> 
> 赞同：0
> 
> 时间：2009-04-04T14:31:42.610
> 
> 标签：c#, .net, asp.net

我创建了 Web 用户控件，它包括一个列表框，还提供带有列表字典的属性来填充列表框。
如果你在下面看：

```
 public ListDictionary Items
        {
            get
            {
                if (items == null)
                    items = new ListDictionary();
                return items;
            }
            set { items = value; }
        }
```

这有助于我将项目添加到列表框中。

http://img219.imageshack.us/img219/8664/dsfdsfsf.png

我从 mycontrol1 向 webusercontrol2 发送消息：

## 测试.aspx

```
protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                Controltest1.Items.Add("Adana Kebap", "1");
                Controltest1.Items.Add("Urfa Kebap", "2");
                Controltest1.Items.Add("Beyti", "3");
                Controltest1.Items.Add("İskender", "4");
            }
        }

        protected void btnAdd_Click(object sender, EventArgs e)
        {
            ListBox listbox=  Controltest1.FindControl("ListBox1") as ListBox;
            if(listbox.Items.Count>0)
            {
            foreach (ListItem li in listbox.Items )
                if (li.Selected)
                {
                    Controltest2.Items.Add(li.Text, li.Value);
                }
            }
        }
```

但;

## Controltest2.Items.Add(li.Text, li.Value);

这个方法行不通，我猜...

### 帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T16:40:32.800

我假设在某些时候您将 ListDictionary 项目添加到 ListBox1 控件项目中......

我建议在我们的用户控件中创建一个方法，如下所示：

```
public void Add(string text, string value)  
{
    this.ListBox1.Items.Add(text, value);
} 
```

否则，您必须知道用户控件内的 ListBox 控件的名称...

您的其他属性可以更改为如下所示：

```
public ListItemCollection Items
{
    get
    {
        return this.ListBox1.Items;
    }
} 
```

然后最后...

```
protected void btnAdd_Click(object sender, EventArgs e)
{
    if(Controltest1.Items.Count > 0)
    {
        foreach (ListItem li in listbox.Items )
        {
                if (li.Selected)
                {
                    Controltest2.Add(li.Text, li.Value);
                }
        }
    }
} 
```

# sql-server - 使用 LINQ 组合 SQL 结果

> ID：717192
> 
> 赞同：0
> 
> 时间：2009-04-04T14:36:23.673
> 
> 标签：sql-server

我有一个公司注册人数据库（用于搜索/目录功能）。我们添加了一个新表格来保存为此功能付费的注册人的“增强”信息（例如广告/附加图像/徽标等）。现在，新表只包含注册人的唯一标识符和一些附加字段（图像的路径等）。用户可以搜索具有特定条件的用户，增强的列表应显示在列表顶部。结果不应显示任何注册人两次（因此，如果用户有增强列表，他们应该只出现在顶部的“增强列表”区域中）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T14:43:38.977

从旧表到新表的左外连接。

在查询的“order by”之前添加“new_table.id 为 null 然后 1 else 0 end 的情况”

所以如果你有这个：

```
select foo, bar from old_table 
order by bar, foo; 
```

你会有这个：

```
select a.foo, a.bar from old_table a 
 left join new table b on (a.customer_id = b.customer_id) 
order by 
 case when new_table.customer_id is null then 1 else 0 end, 
 bar, foo; 
```

编辑：我在代码的外部连接中省略了“左”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T15:34:30.167

如果您使用 LINQtoSQL 和设计器生成的实体，您应该有一个关于您的注册实体的相关信息的实体集——假设您已经设置了正确的外键关系。如果您稍后添加它，您可能需要手动添加它（请参见此处）或删除/重新添加您的实体到设计器以获取新关系。那么您的查询将类似于：

```
var registrants = db.Registrants.Where( ... selection criteria here ... );

registrants = registrants.OrderByDescending( r => r.EnhancedData.Count() )
                         .ThenBy( r => r.Name );  // or normal sort order 
```

大概 count 将是 0 或 1，因此这应该将具有增强数据的那些放在结果的顶部。

# .net - 接收远程主机作为广播消息发送的数据报

> ID：717198
> 
> 赞同：1
> 
> 时间：2009-04-04T14:41:47.170
> 
> 标签：.net, broadcasting

我需要接收连接在同一局域网上的远程主机作为广播消息发送的数据报。

我正在使用 UDPClient 但不知道要使用哪种方法。有一个方法 UDPClient.Receive 但它需要一个特定的 IPEndPoint 作为参数，这显然是不想要的，因为它是我需要接收的广播消息，因此发送者不是重要的。如果可能，请向我提供接收广播消息的代码。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T15:16:39.817

设置 IPEndPoint 以使用 ANY 地址：

```
int port = ...your port goes here...
var endPoint = new IPEndPoint( IPAddress.Any, port ); 
```

然后像往常一样使用 UDPClient.Receive。

# http - 比较用于传输文件的 HTTP 和 FTP

> ID：717200
> 
> 赞同：136
> 
> 时间：2009-04-04T14:42:23.877
> 
> 标签：http, ftp, network-programming, file-transfer

在 Internet 上传输文件时，一个比另一个有什么优势（或限制）？

（我知道这两种协议的安全形式。我想听听个人经验在性能、可靠性、文件大小限制等方面的比较。）

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-04-04T14:54:38.217

这是两者的[性能比较](http://www.isi.edu/lsam/publications/http-perf/)。HTTP 对小文件的请求响应更敏感，但如果调整得当，FTP 对大文件可能会更好。过去通常认为 FTP 速度更快。除了 TCP 状态之外，FTP 还需要一个控制通道和状态，但 HTTP 不需要。在数据开始在 FTP 中传输之前有 6 次数据包传输，但在 HTTP 中只有 4 次。

我认为经过适当调整的 TCP 层对速度的影响比应用层协议之间的差异更大。Sun Blueprint [Understanding Tuning TCP](http://www.security-science.com/mastering-internet-security/internet-security-ebooks-and-documents/item/understanding-tuning-tcp)有详细信息。

这是对每个协议的各个特性的另一个[很好的比较](http://daniel.haxx.se/docs/ftp-vs-http.html)。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2015-07-21T05:29:53.317

我刚刚对通过 FTP 和 HTTP 的文件传输进行了基准测试：

*   通过两个非常好的服务器连接
*   使用相同的 1GB .zip 文件
*   相同网络条件下（一个接一个测试）

结果：

*   使用 FTP：6 分钟
*   使用 HTTP：4 分钟
*   使用并发 http 下载软件 ( [`fdm`](http://www.freedownloadmanager.org/index.htm))：1 分钟

所以，基本上在“现实生活”的情况下：

1) 下载一个大文件时，HTTP 比 FTP 快。

2) HTTP 可以使用并行块下载，这使得它比 FTP 快 6 倍，具体取决于网络条件。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-04-04T15:10:24.217

许多防火墙会丢弃不在端口 80 或 443（http 和 https）的出站连接；有些甚至断开与那些不是 HTTP(S) 的端口的连接。FTP 可能允许也可能不允许，更不用说主动/PASV 模式了。

此外，HTTP/1.1 允许更好的部分请求（“仅从字节 123456 发送到文件末尾”）、条件请求和缓存（“仅在内容更改/如果最后修改日期更改时发送”）和内容压缩(gzip)。

HTTP 通过代理更容易使用。

从我的轶事证据来看，HTTP 更容易处理掉线/缓慢/不稳定的连接；例如，在（重新）发起传输之前不需要（重新）建立登录会话。

OTOH，HTTP 是无状态的，因此您必须自己进行身份验证并建立“谁在什么时候做了什么”的踪迹。

我注意到的唯一速度差异是传输大量小文件：带有流水线的 HTTP 更快（减少了往返，尤其是在高延迟网络上明显）。

请注意，[HTTP/2](https://en.wikipedia.org/wiki/HTTP/2)提供了更多优化，而 FTP 协议几十年来没有任何更新（甚至 FTP 的扩展也很少被用户采用）。因此，除非您通过时间机器传输文件，否则 HTTP 似乎胜出。

（切题：有些协议更适合文件传输，例如`rsync`BitTorrent，但它们没有那么多的思想共享，而 HTTP 是 Everywhere™）

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-04T15:00:10.497

一个考虑因素是 FTP 可以使用非标准端口，这会使通过防火墙变得困难（尤其是如果您使用 SSL）。HTTP 通常位于已知端口上，因此这很少会成为问题。

如果您决定使用 FTP，请务必阅读有关[主动和被动 FTP](http://slacksite.com/other/ftp.html)的信息。

就性能而言，归根结底，它们都直接通过 TCP 连接发送文件，所以应该差不多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-14T13:54:58.787

FTP 的一个优点是有一种使用`dir`或列出文件的标准方法`ls`。因此，ftp 可以很好地与[rsync](https://linux.die.net/man/1/rsync)等工具配合使用。当然，`rsync`通常已经完成`ssh`，但选项就在那里。

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2014-09-24T22:53:37.937

两者都使用 TCP 作为传输协议，但 HTTP 使用持久连接，这使得 TCP 的性能更好。

# silverlight - 是否可以在 Mac 上使用 Silverlight 进行开发？

> ID：717204
> 
> 赞同：5
> 
> 时间：2009-04-04T14:43:48.023
> 
> 标签：silverlight, macos

我一直在搜索 Microsoft Silverlight 网站，我猜我的问题的答案是否定的。

但是有没有非官方或官方版本的 Mac OS 的 Silverlight 开发 SDK？

我想避免安装 Windows，但我想在 Silverlight 中开发。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-04T14:49:03.863

答案是肯定的，你当然可以。您将需要使用 Eclipse。这并不容易，但它肯定是可能的。

祝你好运！

链接天堂：

*   [日食 4 银光](http://www.eclipse4sl.org/download/)
*   [Shawn Wildermuth 在 MIX09 会议上展示的视频](http://wildermuth.com/2009/03/21/My_Mini-Session_at_MIX09_(Eclipse_and_Silverlight))

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T05:11:03.137

还有即将支持它的 MonoDevelop，但它并不完全存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T14:47:04.803

假设您得到的答案确实是“否”...

我使用 VM (Parallels) 在我的 Mac Pro 上运行 Windows XP。在此设置中，Visual Studio 2008 的性能实际上很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-28T06:48:51.277

我正在使用 Mac OS X 使用 Silverlight 3 进行开发，使用 IronRuby 和 IronPython 以及 TextMate。使用起来非常愉快！

[您可以在此处](http://silverlight.net/getstarted/silverlight3/default.aspx)获取适用于 Mac 的 Silverlight 3 Beta Runtime并将其与[AgDlr](http://github.com/jschementi/agdlr/tree/master)一起使用。[在此处](http://sdlsdk.codeplex.com/)获取 AgDlr 的二进制文件。

如果您想查看以这种方式工作的代码示例，请查看[AgDlr 演示](http://github.com/jschementi/agdlr/tree/e562c2cb73407a057e852db51b3713296aef7068/samples)。

希望这可以帮助！

# ruby - Test::Unit 在 Rails 中是否仍然相关？

> ID：717212
> 
> 赞同：17
> 
> 时间：2009-04-04T14:48:31.680
> 
> 标签：ruby, rspec, cucumber, shoulda, testunit

我正在以古老的方式学习 Rails。通过阅读使用 Rails 进行敏捷 Web 开发（第 3 版）作为起点。我目前在教授测试的章节中。我也知道其他 BDD 测试框架，例如 RSPec。所以我想知道 RSpec、Cucumber、Should 等框架是否取代了了解/使用 Test::Unit 的需求？它们本身是否相关并用于不同目的？

更新：由于我是测试新手，因此我也很想获得有关哪些资源对我熟悉不同框架有用的反馈。

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-04T15:03:19.630

**世界变了！检查并支持@prusswan**

我认为 Test::Unit 仍然是相关的，尽管围绕 BDD 和其他测试工具有很多炒作。

话虽这么说，如果您愿意，您可以绕过学习 Test::Unit 并立即从 RSpec 和 Shoulda 之类的东西开始，但是关于通过敏捷 Web 开发手册中的示例来查看的内容有一些话要说BDD 的想法来自哪里。

我发现自己仍然在某些项目中使用 Test::Unit，因为它是 Rails 附带的，并且仍然是一个非常棒的测试框架。

长话短说，我不认为它已经过时，但它不再是最前沿的了。BDD 是一种测试范式转变，尤其是当您开始使用 Cucumber 和 Webrat 时，但一旦您开始使用它就非常棒。Shoulda 是最容易过渡到的，所以我会从 Test::Unit 开始，然后转到 Shoulda，然后尝试 RSpec 和 Cucumber。

您正在测试或至少对测试感兴趣！这是最好的部分。最后，只要你对它感到满意，你使用什么并不重要。

祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-04-02T06:20:58.380

DHH 本人是 Test::Unit 的狂热用户之一，并且由于 RSpec / Cucumber 的相对复杂性而避免使用它们。

[我尊重它背后的人，我完全赞成实验，但 rSpec 和 Cucumber 的扩散让我感到难过。](http://twitter.com/#!/dhh/status/52806992150007808)

[RSpec 在美学上冒犯了我，因为它在测试/单元上增加的复杂性没有明显的好处。](http://twitter.com/#!/dhh/status/52807321499340800)

[除非您有客户阅读测试，否则 Cucumber 对我来说毫无意义。为什么要为英语构建一个特定于测试的解析器？](http://twitter.com/#!/dhh/status/52807649145782272)

[重要的当然是我们让人们进行测试，所以工具不应该太重要。但是增加的复杂性仍然让我感到不安。](http://twitter.com/#!/dhh/status/52808555895595008)

[“something.should be_true”很好地总结了我的审美论点。那个电话伤害了我的眼睛，而不是“断言某事”。](http://twitter.com/#!/dhh/status/52814621198917632)

如果您有兴趣，请继续阅读这些推特的推特。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-25T11:42:08.757

只是以为我会发布 2012 年的更新：

在关于 RoR的[三本](http://ruby.railstutorial.org/book?version=3.2) [主要](http://www.manning.com/katz/)和[当前](http://pragprog.com/book/rails4/agile-web-development-with-rails)（可与 Rails 3.2 一起使用，只需进行一些小的修改）介绍性书籍中，其中两本正在使用 Rspec（最多简短提及 Test::Unit），其中一本正在计划在[下一版](http://www.manning.com/bigg2/)甚至*moar Rspec*上，所以现在很清楚谁将成为这场“战斗”的赢家

并允许我选择性地引用 dhh：

> 重要的当然是我们让人们进行测试，所以工具不应该太重要。

2014年重温：

Minitest 现在已经取代了 Test::Unit 作为当前 Rails 版本的默认设置。就个人而言，我认为与它的前身相比，它值得仔细研究，原因有很多——

1.  其默认状态
2.  对 capybara 和 selenium 的更好支持，很大一部分归功于这样的[gem](https://github.com/blowmage/minitest-rails-capybara)
3.  相对轻巧
4.  大部分向后兼容 Test::Unit

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-02T04:57:28.007

Rspec 是一个完全独立的测试框架。Shoulda 是对 Rails 内置框架 Test::Unit 的增强。如果您使用的是 Shoulda，那么您使用的是 Test::Unit，但具有更多功能和更简单、更易读的语法。

我试过 Rspec 和 Shoulda，对我来说，Shouda 胜出。我更喜欢它。但这可能是一个品味问题。

请注意，[您可以将 Cucumber 与 Shoulda 一起使用](http://giantrobots.thoughtbot.com/2009/2/20/mixing-cucumber-with-test-unit)。

其他资源？我推荐 ZenTest 和 RedGreen gems。ZenTest 提供自动测试，让您在每次更改文件时自动运行测试。这是一个很大的帮助。

关于夹具与工厂，如果您需要设置一堆相互关联的对象来测试双方或父子关系和/或测试多对多关系，那么夹具工作得更好。实际上，我什至不确定您是否可以在工厂中做到这一点。所以不要忽视固定装置——它们有它们的用途。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T16:00:55.607

仍然有很多人喜欢 Test::Unit，在某种程度上，这是个人喜好。但是，总的来说，您会发现 RSpec 方面的活动要多得多。真正酷的东西都是用 RSpec 和 Cucumber 完成的，所以如果你自己没有个人偏好，我可能会跳过 Test::Unit。但是，您应该足够熟悉它以阅读其他人用它编写的测试，但我不会预见到这会成为问题。

# asp.net-mvc - 从部分视图 (.ascx) 注册一些 javascript 文件

> ID：717215
> 
> 赞同：1
> 
> 时间：2009-04-04T14:50:50.987
> 
> 标签：asp.net-mvc

我有一个由动态呈现的多个部分 asp.net mvc 视图组成的页面。
如何根据每个部分视图所需的内容在页面标题中注册一些 javascript 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T15:02:53.970

我在视图的母版页标题中设置了一个 ContentPlaceHolder。在视图中，我同时包含标题和正文内容占位符，并将我的 javascript 包含在与标题对应的占位符中。我通常不会将 javascript 包含添加到部分视图本身，因为我（也）希望它出现在 html 头元素中。我只是确保在包含它们的视图中包含我的所有部分都需要的所有 javascript 文件。我通常会在局部视图本身中包含内联脚本，但如果可以多次嵌入局部视图，您需要小心这一点。

查看代码：

```
 <asp:ContentPlaceHolder ID="headerContent"
                         ContentPlaceHolderID="Header"
                         runat="server">
     ... javascript includes go here...
 </asp:ContentPlaceHolder>

 <asp:ContentPlaceHolder ID="bodyContent"
                         ContentPlaceHolderID="Body"
                         runat="server">
    ... body content goes here...

    <%  Html.RenderPartial( "PartialView1", Model, ViewData ); %>
    <%  Html.RenderPartial( "PartialView2", Model, ViewData ); %>
 </asp:ContentPlaceHolder> 
```

# java - 为什么不总是在 Java 中使用 ArrayLists 而不是普通的 ol' 数组？

> ID：717218
> 
> 赞同：9
> 
> 时间：2009-04-04T14:54:04.957
> 
> 标签：java

这里有一个快速的问题：为什么不总是在 Java 中使用 ArrayLists？除了额外有用的功能外，它们显然具有与数组相同的访问速度。我理解它不能容纳原语的限制，但是通过使用包装器很容易缓解这种情况。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-04T15:05:35.587

很多项目只是使用`ArrayList`or`HashMap`来处理他们所有的收集需求。但是，让我对此提出一个警告。每当您创建类并在整个代码中使用它们时，如果可能，请参考它们实现的接口，而不是您用来实现它们的具体类。

例如，而不是这样：

```
ArrayList insuranceClaims = new ArrayList(); 
```

做这个：

```
List insuranceClaims = new ArrayList(); 
```

甚至：

```
Collection insuranceClaims = new ArrayList(); 
```

如果您的其余代码仅通过它实现的接口（`List`或`Collection`）知道它，那么如果您发现需要不同的实现，那么将其换成另一个实现会变得容易得多。就在一个月前，我看到这种情况发生，当时我需要将常规替换`HashMap`为一个实现，该实现将以相同的顺序将项目返回给我，当我需要迭代所有项目时。幸运的是，Jakarta Commons Collections 中提供了这样的东西，我只是将 A 替换为 B，只更改了一行代码，因为两者都实现了 Map。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-04T16:55:56.413

如果您需要一组原语，那么数组很可能是完成这项工作的最佳工具。拳击是一项相对昂贵的操作。对于将用作基元的基元集合（不包括映射），我几乎总是使用数组来避免重复装箱和拆箱。

但是，我很少担心数组和 之间的性能差异`ArrayList`。如果 a`List`将提供更好、更清洁、更易于维护的代码，那么我将始终使用 a `List`（或`Collection`或`Set`等，视情况而定，但您的问题是关于`ArrayList`），除非有一些令人信服的理由不这样做。性能**很少**是令人信服的原因。

使用`Collection`s 几乎总是会产生更好的代码，部分原因是数组不能很好地与泛型配合使用，正如 Johannes Weiß 在评论中已经指出的那样，但也有很多其他原因：

*   集合有非常丰富的 API 和各种各样的实现（在大多数情况下）可以很容易地相互交换进出
*   *如果偶尔*使用数组版本很有用，则可以轻松地将 Collection 转换为数组
*   许多集合的增长比数组的增长更优雅，这可能是一个性能问题
*   集合与泛型一起工作得很好，数组相当糟糕
*   正如 TofuBeer 指出的那样，数组协方差很奇怪，并且可以以任何对象都不会起作用的未执行方式起作用。集合以预期的方式处理协方差。
*   数组需要根据任务手动调整大小，如果数组未满，您需要自己跟踪。如果需要调整数组的大小，则必须自己进行。

所有这些加在一起，我很少使用数组，只是更频繁地使用`ArrayList`. 但是，我确实`List`经常使用 s （或者只是`Collection`or `Set`）。我最常用的数组是当被存储的项目是一个基元并且将被插入和访问并用作一个基元时。如果装箱和拆箱变得如此之快以至于它成为一个微不足道的考虑，我可能会重新考虑这个决定，但使用某些东西，以始终引用它的形式存储它会更方便。（即，'int' 而不是 'Integer'。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-04T15:26:37.173

这是过早未优化的情况:-)。你永远不应该做某事，因为你认为它会更好/更快/让你更快乐。

ArrayList 有额外的开销，如果你不需要 ArrayList 的额外功能，那么使用 ArrayList 是一种浪费。

此外，对于您可以使用 List 做的一些事情，还有 Arrays 类，这意味着 ArrayList 提供的功能比 Arrays 更多，但事实并非如此。现在使用这些可能比使用 ArrayList 慢，但必须对其进行分析才能确定。

您永远不应该在不确定开始时速度很慢的情况下尝试使某些东西变得更快......这意味着您应该继续使用 ArrayList 直到您发现它们是一个问题并减慢程序速度。但是也应该涉及常识 - ArrayList 有开销，开销会很小但会累积。在分析器中不容易发现，因为这里有一点开销，那里有一点开销。所以常识会说，除非你需要 ArrayList 的特性，否则你不应该使用它，除非你想被千刀万剐（性能方面）。

对于内部代码，如果您发现确实需要从数组更改为 ArrayList，那么在大多数情况下，机会非常简单（[i] 变为 get(i)，这将是 99% 的更改）。

如果您使用的是 for-each 外观 (for(value : items) { })，那么也没有代码可以更改。

另外，按照你所说的：

1) 相同的访问速度，取决于您的环境。例如，Android VM 没有内联方法（据我所知，它只是一个直接的解释器），因此对其的访问会慢得多。ArrayList 上的其他操作可能会导致速度变慢，这取决于您在做什么，而与 VM 无关（使用直接数组可能会更快，同样您必须分析或检查源以确定）。

2) 包装器增加了正在使用的内存量。

在分析某些内容之前，您不应该担心速度/内存，另一方面，除非您有充分的理由，否则您不应该选择您知道的较慢的选项。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-04T15:53:08.060

性能不应该是您最关心的问题。

尽可能使用`List`接口，根据实际需求选择具体实现（`ArrayList`用于随机访问，`LinkedList`用于结构修改，...）。

你应该关心性能。

使用数组、`System.arraycopy`和`java.util.Arrays`其他低级的东西来挤出最后一滴性能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T15:06:40.623

好吧，不要总是盲目地使用不适合工作的东西。总是从使用 Lists 开始，选择 ArrayList 作为你的实现。这是一种更面向对象的方法。如果您不知道您特别需要一个数组，您会发现从长远来看，不将自己绑定到 List 的特定实现对您来说会好得多。先让它工作，然后再优化。

# c# - 如何使用 Infragistics 设置 Office 2007 风格？

> ID：717219
> 
> 赞同：0
> 
> 时间：2009-04-04T14:54:36.110
> 
> 标签：c#, infragistics, styling

我一直在寻找使用基础设施设置 Office 2007 表单样式，但找不到我需要的代码行（我怀疑很少！）

有人有我需要的代码或教程的链接吗？在基础设施网站上查看样本似乎很少（或者我只是找不到它们）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T16:15:17.883

终于解决了：

1.  添加一个 UltraToolbarsManager
2.  将功能区子对象可见属性设置为 TRUE

您的应用程序将整个表单样式切换到 Office 2007。

# delphi - Delphi 的拼写检查组件

> ID：717222
> 
> 赞同：7
> 
> 时间：2009-04-04T14:56:15.343
> 
> 标签：delphi, spell-checking

我们为社区开发的 twitter 客户端的要求之一是拼写检查组件。您在应用程序中使用了哪些拼写检查组件/系统，您的使用体验如何？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-04T16:03:10.067

[Addict Component Suite](http://www.addictivesoftware.com/)是 Delphi 最完整的一个，但它不是免费的。

但是我认为您正在为您的 twitter 实用程序寻找免费软件，我已将[LS Speller](http://www.luziusschneider.com/SpellerHome.htm)用于免费项目并且与我合作得很好，它基于 ISpell，因此您可以使用更新的字典对其进行更新。

但目前还没有 D2009 更新，而且似乎还没有积极开发。

使用[MS Word 内置字典](http://delphi.about.com/od/kbcontrolole/ss/word_automation.htm)的另一个选项。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-05-02T21:16:49.770

Windows 附带拼写检查 API (Windows 8)。

```
TWindow8SpellChecker = class(TCustomSpellChecker)
private
    FSpellChecker: ISpellChecker;
public
    constructor Create(LanguageTag: UnicodeString='en-US');

    procedure Check(const text: UnicodeString; const Errors: TList); override; //gives a list of TSpellingError objects
    function Suggest(const word: UnicodeString; const Suggestions: TStrings): Boolean; override;
end; 
```

通过实施：

```
constructor TWindow8SpellChecker.Create(LanguageTag: UnicodeString='en-US');
var
    factory: ISpellCheckerFactory;
begin
    inherited Create;

    factory := CoSpellCheckerFactory.Create;
    OleCheck(factory.CreateSpellChecker(LanguageTag, {out}FSpellChecker));
end;

procedure TWindow8SpellChecker.Check(const text: UnicodeString; const Errors: TList);
var
    enumErrors: IEnumSpellingError;
    error: ISpellingError;
    spellingError: TSpellingError;
begin
    if text = '' then
        Exit;

    OleCheck(FSpellChecker.Check(text, {out}enumErrors));

    while (enumErrors.Next({out}error) = S_OK) do
    begin
        spellingError := TSpellingError.Create(
                error.StartIndex,
                error.Length,
                error.CorrectiveAction,
                error.Replacement);
        Errors.Add(spellingError);
    end;
end;

function TWindow8SpellChecker.Suggest(const word: UnicodeString; const Suggestions: TStrings): Boolean;
var
    hr: HRESULT;
    enumSuggestions: IEnumString;
    ws: PWideChar;
    fetched: LongInt;
begin
    if (word = '') then
    begin
        Result := False;
        Exit;
    end;

    hr := FSpellChecker.Suggest(word, {out}enumSuggestions);
    OleCheck(hr);

    Result := (hr = S_OK); //returns S_FALSE if the word is spelled correctly

    ws := '';
    while enumSuggestions.Next(1, {out}ws, {out}@fetched) = S_OK do
    begin
        if fetched < 1 then
            Continue;

        Suggestions.Add(ws);

        CoTaskMemFree(ws);
    end;
end; 
```

**TSpellingError**对象是对四个值的简单包装：

```
TSpellingError = class(TObject)
protected
    FStartIndex: ULONG;
    FLength: ULONG;
    FCorrectiveAction: CORRECTIVE_ACTION;
    FReplacement: UnicodeString;
public
    constructor Create(StartIndex, Length: ULONG; CorrectiveAction: CORRECTIVE_ACTION; Replacement: UnicodeString);
    property StartIndex: ULONG read FStartIndex;
    property Length: ULONG read FLength;
    property CorrectiveAction: CORRECTIVE_ACTION read FCorrectiveAction;
    property Replacement: UnicodeString read FReplacement;
end; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T17:27:04.060

在博客评论中，Ken 刚刚建议使用 ISpell 词典的[LS Spell 。](http://www.luziusschneider.com/SpellerHome.htm)它适用于 Delphi 5、6 和 7，所以只要它不明确使用其他字符串类型就可以正常工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T23:45:21.403

我一直在使用[Addict](http://www.addictive-software.com/index.htm)，并且对它非常满意。我主要将它与[WPTools](http://wptools.de/)一起用于邮件合并和电子邮件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-06T10:41:59.633

您可以使用[Aspell](http://aspell.net/)（Win32 版本：[http](http://aspell.net/win32/) ://aspell.net/win32/ ）。

在您的 Delphi 项目中，您可以使用命令行管道接口`aspell pipe`：

```
C:\Programme\Aspell\bin>aspell 管道
@(#) International Ispell 版本 3.1.20（但实际上是 Aspell 0.50.3）

你好
*

世界
*

你好
& hello 18 0：你好，Helli，hell lo，hell-lo，地狱，Heall，你好，他会，你好，Heller，Heller，你好，Jello，Jello，Halli，Holli，hallow，hollow

世界
& wourld 12 0: 世界，会，会，会，轮动，挥舞，焊接，狂野，羊毛，旋转，世界，会，词

```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T21:43:43.707

我在我的 Delphi 应用程序中使用 TRichView 组件作为我的“文本编辑器”。

它支持许多与 Delphi 一起工作的拼写检查器。您可能想比较它支持的那些：

[http://www.trichview.com/features/spellcheck.html](http://www.trichview.com/features/spellcheck.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-03T01:24:14.923

DevExpress VCL 也有一个拼写检查器，虽然我只玩过一点。我还拥有在软件项目中使用的 Addict。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-05T09:12:16.207

如果您可以保证您的客户端始终安装 MS Word，我建议 MS Word 的内置拼写检查器也带有 OLE 自动化。

# javascript - 如何在textarea中获取选定的文本？

> ID：717224
> 
> 赞同：41
> 
> 时间：2009-04-04T14:57:08.850
> 
> 标签：javascript, jquery

我正在尝试制作自己的**所见即所得**编辑器。有什么办法，如何获取用户在 textarea 中选择的文本？

例如，如果用户选择了某个单词然后单击按钮，我如何找出选择了哪个文本？

我正在使用**jQuery**。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-12-10T06:46:33.790

[`window.getSelection().toString()`](https://developer.mozilla.org/en-US/docs/Web/API/Window/getSelection)对我有用 Chrome 但[不是 Firefox](https://bugzilla.mozilla.org/show_bug.cgi?id=85686)。

`<textarea>`使用 Firefox获取所选内容：

```
function getSel() // javascript
{
    // obtain the object reference for the <textarea>
    var txtarea = document.getElementById("mytextarea");
    // obtain the index of the first selected character
    var start = txtarea.selectionStart;
    // obtain the index of the last selected character
    var finish = txtarea.selectionEnd;
    // obtain the selected text
    var sel = txtarea.value.substring(start, finish);
    // do something with the selected content
} 
```

您也可以使用[activeElement](https://developer.mozilla.org/en-US/docs/Web/API/DocumentOrShadowRoot/activeElement)而不是[getElementById](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById)。

参考：

*   [文本区域](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/textarea)
*   [文档](https://developer.mozilla.org/en-US/docs/Web/API/document?redirectlocale=en-US&redirectslug=DOM%2Fdocument#Introduction)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-04T15:58:59.170

不同浏览器的处理选择不同：

```
var userSelection;
if (window.getSelection) {
    userSelection = window.getSelection();
}
else if (document.selection) { // Opera
    userSelection = document.selection.createRange();
} 
```

这给了你一个范围对象。每个范围代表一个选择（使用控制/命令键可以进行多个活动选择）。

您现在拥有的范围对象类型取决于浏览器。对于 IE，它是一个 Text Range 对象；对于其他人，它是一个选择对象。要将 Selection 对象转换为文本范围，可以调用 getRangeAt；对于 Safari，您需要构建：

```
var range;
if (userSelection.getRangeAt)
    range = userSelection.getRangeAt(0);
else { // Safari
    range = document.createRange();
    range.setStart(userSelection .anchorNode, userSelection.anchorOffset);
    range.setEnd(userSelection.focusNode, userSelection.focusOffset);
} 
```

range 对象为您提供选择的开始和结束 dom 元素以及文本偏移量。

有关范围对象的更多信息，请参见[此处的 quirksmode.org](http://www.quirksmode.org/dom/range_intro.html)

如果您使用的是 jQuery，您可能需要查看 Batiste Bieler 的[轻量级 jQuery RTE 插件](http://batiste.dosimple.ch/blog/posts/2007-09-11-1/rich-text-editor-jquery.html)。它可能足以满足您的需求，或者至少可以为您提供一些开始。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-04T14:59:45.333

试试 jquery-fieldselection 插件。

你可以从[这里](http://github.com/localhost/jquery-fieldselection/tree/master)下载。也有一个例子。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-04T15:02:13.800

获取选择（）

这因浏览器而有所不同，请参阅此处以了解据称在大多数情况下都可以使用的功能：http: [//snipplr.com/view/775/getselection/](http://snipplr.com/view/775/getselection/)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-27T15:07:31.857

一个小函数，它将获取文本区域或输入元素的选定字符串/文本：

```
function getInputSelection(elem){
 if(typeof elem != "undefined"){
  s=elem[0].selectionStart;
  e=elem[0].selectionEnd;
  return elem.val().substring(s, e);
 }else{
  return '';
 }
} 
```

请注意，上面的代码需要**jQuery**才能工作。获取 id 为**abc123的输入元素的选定字符串的示例**

```
getInputSelection($("#abc123")); 
```

上述函数将返回选定的字符串。如果用户没有选择字符串，它将返回`null`.

## 更多示例

```
getInputSelection($("body").find("input[name=user]")); 
```

在使用类名选择的元素上，返回元素数组的第一个元素的选定字符串，而不是所有元素的选定字符串。毕竟，页面中的选择将始终为**1**。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-10-20T09:23:55.910

```
function getSel() {
var input = $("#text");
return input.html().toString().substring(getSelection().baseOffset,getSelection().extendOffset);
} 
```

# c++ - io_service，为什么以及如何使用它？

> ID：717239
> 
> 赞同：42
> 
> 时间：2009-04-04T15:13:40.183
> 
> 标签：c++, boost, boost-asio

尝试学习 asio，我正在关注网站上的示例。

为什么需要 io_service 以及它究竟做了什么？为什么我需要在执行异步操作时将它发送到几乎所有其他函数，为什么它不能在第一次“绑定”之后“创建”自己。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-04-04T15:22:08.870

Asio's`io_service`是异步函数操作的促进者。一旦异步操作准备就绪，它就会使用`io_service`'s 正在运行的线程之一来回叫您。如果不存在这样的线程，它会使用自己的内部线程来调用您。

将其视为包含操作的队列。它保证这些操作在运行时只会在调用其`run()`或`run_once()`方法的线程上执行，或者在处理套接字和异步 IO 时，即其内部线程。

您必须将其传递给每个人的原因基本上是有人必须等待异步操作准备好，并且正如其自己的文档`io_service`中所述，ASIO 与操作系统的 I/O 服务的链接，因此它抽象出平台自己的异步通知器，例如`kqueue`, `/dev/pool/`, `epoll`, 以及对它们进行操作的方法, 例如`select()`.

主要是我最终使用 io_service 来解复用来自系统多个部分的回调，并确保它们在同一个线程上运行，从而消除了显式锁定的需要，因为这些操作是序列化的。对于异步应用程序来说，这是一个非常强大的习惯用法。

您可以查看[核心文档](http://www.boost.org/doc/libs/1_65_1/doc/html/boost_asio/overview/core/basics.html)，以更好地了解为什么`io_service`需要它以及它的作用。

# apache-flex - 在 Emacs 中使用 gdb-mode 调试 flash

> ID：717240
> 
> 赞同：2
> 
> 时间：2009-04-04T15:14:10.150
> 
> 标签：apache-flex, flash, emacs

我正在尝试在 Linux 上使用 fdb（flex SDK 附带的闪存调试器）调试 swf。从终端进行调试是可行的，但是如果我在 Emacs 中这样做

```
M-x gdb
fdb -f myswf.swf RET 
```

一旦我发出任何命令（例如“help”或“c”），fdb 似乎就会挂起。我在 fdb 缓冲区中没有得到任何输出，并且 flash 播放器挂起等待调试器。

[这个页面](http://www.emacswiki.org/emacs/EmacsFlexDebugger)似乎表明使用 fdb 和 gd-mode 应该是可能的，其他人有运气吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-02T11:25:17.287

我意识到这个有点晚了，但我把它留在这里留给后代：使用的命令是`gud-gdb`. 然后，您应该使用`fdb -f`. 进入 fdb 后，将调试器指向 swf，使用`run <path_to_swf>`.

# php - PHP 中的集中式错误报告

> ID：717242
> 
> 赞同：4
> 
> 时间：2009-04-04T15:14:19.607
> 
> 标签：php, error-reporting

有没有办法在 PHP 中集中处理错误报告？我希望通过电子邮件收到我的应用程序引发的所有错误的通知。

为整个应用程序实现这一目标的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T15:20:13.100

您可以使用[set_error_handler](http://us2.php.net/manual/en/function.set-error-handler.php)以任何您喜欢的方式在运行时处理错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-04T15:32:54.163

正如 Kalium 所提到的，您会想要使用[`set_error_handler`](http://ie.php.net/manual/en/function.set-error-handler.php)，但这只会让您获得一部分。您还想捕获未捕获的异常。为此，使用[`set_exception_handler`](http://ie.php.net/manual/en/function.set-exception-handler.php).

我自己做的是让我的代码捕获错误，并将这些错误转换为我可以在其他地方捕获的适当异常。对于任何未捕获的内容，我使用默认异常处理程序来记录和报告它们，并在必要时显示适当的错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-04T15:39:02.307

有 3 种类型的错误：

1.  系统错误，例如 PHP 引发的警告或致命错误。404 错误也属于这一类。

2.  由格式错误或失败的查询或数据库连接引起的数据库错误。

3.  逻辑错误，例如与服务器或数据库无关的应用程序内部工作出现问题。例如，如果您希望某个文件位于给定文件夹中，但事实并非如此。

创建`ErrorHandler`处理所有三种类型错误的类的最佳方法。对于系统错误，您可以使用`set_error_handler`或阅读其中一个在线教程，例如[这个](http://www.w3schools.com/PHP/php_ref_error.asp)。

对于数据库，我建议使用处理所有查询的集中式数据库类。使用这样的东西：

```
$result=mysql_query($sql);
if (! $result)
{
   $ErrorHandler->dbError(mysql_error(), $sql);
} 
```

对于逻辑错误，例如找不到预期文件或数据库记录的错误，您将调用相同的 ErrorHandler 类并执行以下操作：

```
if ($logicalError)
{
   $ErrorHandler->appError('Something bad happened',__LINE__, __FILE__);
   $ErrorHandler->showAppErrorPage();
} 
```

这里的`__FILE__`和`__LINE__`常量将准确给出发生此错误的位置。[在php.net](http://php.net)网站上阅读它们。

您的`ErrorHandler`班级可以将所有错误记录到日志文件中，向您发送电子邮件，甚至在您的手机上发送短信/短信。它还可以用于将用户重定向到错误页面。

# windows - 如何将 Eclipse 工作区和项目从 Windows 转移到 Linux 和 Mac

> ID：717247
> 
> 赞同：15
> 
> 时间：2009-04-04T15:20:48.777
> 
> 标签：windows, linux, eclipse, workspace

我们多年来一直在 Windows 上开发产品。该产品由一个 Eclipse 工作区和大约 20 个项目组成。在 Windows 上，我们要求每个开发人员将项目签出到 d:\dev\product 文件夹中，并将统一的 Workspace 复制到 d:\dev\prod_workspace。这样，无论何时设置新机器，我们只需将文件复制到同一个文件夹，就可以立即开始工作。

现在我们需要将我们的开发环境迁移到 Linux 和 Mac。但是 Unix 上没有 D:\。Linux 的主文件夹主要类似于 Mac 的 /home/username 和 /Users/username。我们发现 Eclipse 在引用项目时会在工作区中保留绝对路径，因此简单地复制工作区不再起作用。即使我们在 Linux 机器上手动创建/配置工作区，它仍然无法复制到另一个用户，因为绝对路径已更改。

我想我们的目标是允许轻松设置开发环境。您对移动 eclipse 工作区有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T07:50:05.073

我已将我的 Eclipse 项目从 windows xp 移植到 RHEL（从未尝试过 Mac）

您的任务可以通过以下步骤完成：-

1.  在项目代码中使用工作区变量而不是绝对路径。
2.  将您的工作区作为 /Workspace 移动到 linux 中的某个位置，或者如果您想保持用户特定，请将工作区文件夹设置为 /home/user_name/Workspace。
3.  在linux中有一个选项可以将windows的所有\更改为/。该选项可以在 eclipse 的文件菜单下找到。
4.  更改查找类路径目录的设置，只需右键单击项目查看器面板中的项目菜单即可找到选项。
5.  有一个选项可以从头开始构建项目。您只需单击该选项，eclipse 就会重新编译该项目。

一旦完成所有这些，并且所有数据库连接都已成功移植到 linux，那么您也将有一个在 linux 中运行的工作项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T15:25:41.137

我为 Mac 和 WINdows 开发了一个基于 Eclipse 的产品（没有尝试过 Linux）。

我发现效果最好的解决方案是直接从源代码管理中手动检查每台机器上工作区中的项目。虽然项目结构确实在平台之间转换，但任何附件，例如版本控制的东西都不会。我不知道为什么，但我想每件事都有它的扭结。您可以通过为一个平台创建一个项目工作集（或其他任何名称，我认为它是一个 PSF 文件），然后在所有平台上重用它来加快速度。

另一个问题是 Eclipse 版本不是 100% 兼容的。我遇到的问题之一是插件的清单文件，它们在每个平台上具有不同的语义（例如，如何处理实际不存在的导出包），这会导致头痛。

最后，远离 Mac 和 PC 上的 Java 并不完全相同。事实上，Eclipse 有两个 Mac 版本。我通常最终在 Mac 上的 Java 5 上运行和编译，这确实与 Java 6 有一些不兼容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T17:02:58.797

我可以想到两种方法来做到这一点：

1.  如果需要，使用 Eclipse 中的工作区变量来指向工作区所在的确切位置。然后开发人员可以将所有内容放在 Windows、Unix 上的工作区中，然后定义变量就完成了，或者
2.  如果编译总是在 Eclipse 中完成，这意味着您在任何地方都不需要任何绝对路径，那么将项目更改为全部使用相对路径并将 Eclipse 类路径等检查到源代码控制中。因此，当开发人员检查 Eclipse 中的所有内容时，类路径和`.project`文件将位于项目的根级别，并且所有路径都将预先定义。

对于选项 #2，您可能需要多个`.project`或`.classpath`文件，并让开发人员将适当的文件复制到相应位置。也就是说，复制`.classpath.win`到`.classpath`Eclipse 中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-29T17:47:19.993

我将分享我自己的解决方案：

压缩工作区。只需压缩整个文件，然后将其传输过来。然后，您需要做的就是删除默认驱动器引用：`D:\`...或最终出现在文件名开头的任何内容。然后，您需要做的就是将它拖到新下载的 Eclipse 上的新空工作区。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-21T12:49:31.137

如果您从源存储库中签出项目，请考虑使用 Team -> ProjectSets 来处理这些项目。

首选项可以保存在文件中并加载。

我们尝试了类路径变量并讨厌它们。现在我们只在源存储库中的单个项目中拥有所有内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-07T14:54:51.297

使用[Workspace Preference Transferrer 插件](http://marketplace.eclipse.org/content/workspace-preferences-transferrer)

这允许您通过“切换工作区”对话框中的新选项将工作区设置从给定工作区转移到另一个工作区。

# php - 从 PHP 请求中卸载繁重处理（如图像大小调整）的最佳方法

> ID：717250
> 
> 赞同：8
> 
> 时间：2009-04-04T15:21:29.870
> 
> 标签：php, architecture, scalability

我正在开发一个将接收大量流量的 PHP Web 界面。一些插入/更新请求将包含图像，这些图像必须调整为一些常见的大小，以加快它们的进一步检索。

一种方法可能是在服务器上设置一些异步队列。例如。在数据库中设置一个带有任务队列的表，该队列将由 PHP 请求填充，并让服务器上的其他一些进程监视该表并处理任何等待的任务。你会怎么做？对于那个长期运行的过程来说，合适的环境是什么？Java，或者更轻的东西会做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-04T15:23:25.137

如果您正在做的事情真的很大，那么您正在寻找的是[beantalkd 之](http://xph.us/software/beanstalkd/)类的东西。它是一个分布式工作队列处理器。您只需将工作放在队列中，然后忘记它。

当然，您需要在另一端读取队列并处理工作。有多种方法可以做到这一点。

最简单的可能是有一个足够频繁地运行以读取工作队列并处理请求的 cron 作业。或者，您可以使用某种由工作可用唤醒的持久守护进程。

这种方法的优点是您可以根据需要完成多少工作来调整工作人员的数量，并且 beanstalkd 处理分布式处理（从某种意义上说，侦听器可以在不同的机器上）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T15:25:45.320

您可以设置一个 cron 任务来检查队列表。处理队列中等待的动作的脚本可以用 php 编写，因此您不必更改实现语言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T23:10:58.773

您可能希望创建一个“休眠”一段时间的守护程序，然后检查数据库中要处理的项目。一旦找到要处理的项目，它就会处理它们，然后在完成后立即再次检查，如果没有，则休眠。您可以使用任何语言创建守护程序，包括 PHP。

或者，您可以让 PHP 执行一个脚本并继续。为了使 PHP 在继续之前不会等待脚本完成，请在后台执行它。

```
exec("nohup /usr/bin/php -f /path/to/script/script.php > /dev/null 2>&1 &"); 
```

尽管您必须小心这一点，因为您最终可能会在后台运行太多进程，因为没有排队。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-07T01:22:37.537

我将 Perl 与 beanstalkd 结合用于长时间运行的进程。好消息是 Perl 的 Beanstalkd 客户端有一个阻塞的保留方法。这样，当无事可做时，它几乎不使用 CPU 时间。但是当它必须完成它的工作时，它会自动开始处理。非常有效率。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T21:36:13.817

您可以使用[IronWorker 之](http://www.iron.io/products/worker)类的服务在后台进行图像处理并减轻服务器的负载。由于它是一项服务，因此您无需管理任何内容或设置任何其他内容，它会随着您的成长而扩展，因此如果您可以使用它制作一张图像，您可以零努力地扩展到数百万张图像。

这是一篇关于如何进行一堆图像处理转换的文章：

[http://dev.iron.io/solutions/image-processing/](http://dev.iron.io/solutions/image-processing/)

这些示例在 Ruby 中，但您可以很容易地用 PHP 做同样的事情。

# c# - 当我键入“new {”时，如何阻止 Visual Studio 插入“对象”

> ID：717252
> 
> 赞同：14
> 
> 时间：2009-04-04T15:22:24.890
> 
> 标签：c#, visual-studio, visual-studio-2008, intellisense

编辑 C# 源文件时，我键入

```
new { 
```

Visual Studio 自动将其更正为

```
new object{ 
```

有没有办法阻止这种行为？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-04T16:10:43.573

您可以配置正在输入的字符提交当前的智能感知选择。在工具 | 选项 | 文本编辑器 | C# | 智能感知。

删除“{”并确保不检查空格键提交的内容。

注意。自 Visual Studio 2015 起，此选项不再存在。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-02T15:34:31.200

我遇到了这个问题，上面的答案对我不起作用。在我的情况下，它是由 Resharper 引起的，我通过导航到**Resharper -> Options -> Environment -> Intellisense -> Completing Characters**并将开始的大括号字符“{”添加到“Do not complete on”列表中来解决它对于 C#。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T16:06:54.220

你在前面输入`new {`什么？

我刚刚尝试过，它会自动完成对象类型，所以如果我输入：

```
Button test = new { 
```

它成为了：

```
Button test = new Button{ 
```

但如果我输入：

```
var test = new { 
```

它不管它。

我没有以任何方式配置我的 VS2008 安装。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T15:36:23.670

您是否检查了 ReSharper 的自动完成选项？我刚刚在具有默认 ReSharper 设置的新（空）类中尝试了此操作，但无法复制它。您使用的是什么版本的工作室/ReSharper？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T15:37:58.893

尝试先输入左大括号，然后返回并输入 new。VS2008 为我做了这个（没有 ReSharper），如果我记得的话，这就是我所做的。它比删除插入的“对象”少打字。

# c# - 从另一个类访问表单成员

> ID：717264
> 
> 赞同：0
> 
> 时间：2009-04-04T15:29:02.363
> 
> 标签：c#, winforms, memo

关键是在 TCP 客户端中接收/发送数据包时使用备忘录通知用户。旧代码非常愚蠢，我使用了一个用于在备忘录中添加文本的计时器，因为计时器可以访问表单成员，哈哈。

旧代码：

```
//Memo.Text += txt + "\n"; 
```

我今天玩了它，这就是我所做的

在 Form1 的课堂上

```
public string TextValue
{
    get
    {
        return Memo.Text;
    }

    set
    {
        this.Memo.Text += value + "\n";
    }
} 
```

我这样称呼代码：

```
Form1 myForm = new Form1();
myForm.TextValue = "test asdasd"; 
```

备忘录修饰符是**私有**的，但这不是问题。

问题是当我调用代码时，备忘录上没有显示任何文本。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T15:47:18.840

通过输入：

```
Form1 myForm = new Form1(); 
```

您创建表单的新实例（Form1），但我想您应该使用最有可能已经初始化的现有实例。

一种方法：

```
var form = Form.ActiveForm as Form1;

if (form != null)
{
     form.TextValue = "test asdasd";
} 
```

虽然这不是很好的设计。尝试改用自定义[`**events**`](http://msdn.microsoft.com/en-us/library/aa645739.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T15:54:40.803

也许你应该考虑在你的 tcpclient 中发布一个事件。然后您的表单将能够监听此事件并显示正确的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T15:48:09.367

假设 Memo 继承自 Control 并假设您使用适当的修饰符设置它，您可能遇到的问题是您可能试图从工作线程（用于运行 TCP 客户端的线程）设置文本。如果是这种情况，那么您需要检查控件的 InvokeRequired 字段，如果为 true，则调用将为您设置文本的委托。下面是一个简短的 C# 代码片段。

```
private void SetTextOnMemo(string txt){
    if(Memo.InvokeRequired){
        Memo.Invoke(SetTextOnMemo, txt);
    }
    else{
        Memo.Text = txt;
    }
} 
```

# ruby-on-rails - 如何从 lib/tasks 中的任务访问我的 rails 数据库？

> ID：717265
> 
> 赞同：6
> 
> 时间：2009-04-04T15:30:39.130
> 
> 标签：ruby-on-rails, xml, ruby, database, scripting

我正在开发一个需要发送短信的应用程序，因此我将运营商信息存储在数据库中。我还需要 XML 文件中的信息以供客户端代码读取。为了实现这一点，我正在编写一个脚本，该脚本从数据库中读取运营商信息并在 config 目录中创建一个 XML 文件。我觉得这个脚本最适合 lib/tasks。

我需要从此脚本访问数据库，但我想使用一些对象来访问它。如果我使用

```
db = Mysql.new("domain", "username", "password", "database") 
```

我将不得不为不同的环境保留多个版本，因为我并不总是使用 MySQL。那将是非常草率的。我确信有办法做到这一点。我试图只访问该对象......这是我到目前为止所拥有的：

```
RAILS_HOME = File.expand_path(File.join(File.dirname(__FILE__),"../.."))
RAILS_CONFIG = "#{RAILS_HOME}/config"

f = File.new("#{RAILS_CONFIG}/mls_widget_config.xml", "w")
carriers = Carrier.find_all
f.write carriers
f.close 
```

但是 Carrier 没有定义，这是有道理的。如何让这个脚本访问数据库中的 Carrier 对象？

另外，如果有人知道如何轻松地将我从数据库中读取的内容转换为适当的 XML，那就太好了。我打算快速写一些自定义的东西。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T17:36:46.017

您可以通过像这样定义您的任务来启用 Rake 任务来访问您的模型：

```
task :my_task => :environment do
  # Task code
end 
```

请注意`=> :environment`，它授予此访问权限。然后，您可以通过这种方式指示您的 Rake 任务使用不同的环境：

```
rake RAILS_ENV=development my_task
rake RAILS_ENV=production my_task 
```

至于 XML 序列化，可以使用内置的`to_xml`方法，例如：

```
Carrier.all.to_xml 
```

请注意，该方法`.all`是最近添加到 Rails 的，并且是`.find(:all)`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T16:01:20.973

你实际上就快到了；我只是建议将您的 Rails 环境作为脚本的一部分，如下所示：

```
RAILS_HOME = File.expand_path(File.join(File.dirname(__FILE__),"../.."))
RAILS_CONFIG = "#{RAILS_HOME}/config"
require "#{RAILS_CONFIG}/environment" 
```

现在您应该可以访问所有域结构。`to_xml`Rails 还包括通过使用方法调用的默认 XML 序列化；试试`Carrier.find(:all).to_xml`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T16:27:46.760

按照惯例，lib/tasks 通常是为 rake 任务保留的——您可能希望将库代码放在它自己的目录中。库/消息，也许？

你在运行旧版本的 Rails 吗？find_all 在最近的版本中不起作用：'find(:all)' 或只是 'all' 是现在的方法。

```
File.new("#{RAILS_ROOT}/mls_widget_config.xml", "w") do |f|
  Carrier.all.each { |carrier| f.puts carrier.to_xml }
end 
```

# php - 框架更新要等多久？

> ID：717266
> 
> 赞同：1
> 
> 时间：2009-04-04T15:32:05.037
> 
> 标签：php, javascript, zend-framework, frameworks

在开发团队中，您认为应该等待多久才能实现最新的稳定版 Framework？

我在询问我们使用 Zend Framework、HTMLPurifier、jQuery 和 jQuery UI 的不同框架。

发布后，您要等待多长时间来更新您的框架？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-04T15:36:13.687

如果是修订版（xyz -> xyz+1），您应该尽快部署它，因为它通常与错误修复有关。例如ZF[的修复列表](http://framework.zend.com/issues/secure/ReleaseNote.jspa?projectId=10000&styleName=Html&version=10300)`1.7.7`→ `1.7.8`。

标准版本控制方案是*«major».«minor».«revision»*。修订号的更改通常意味着错误修复。次要版本号的更改，表示较小的更改，通常向后兼容。主要版本的更改是重大更改，可能无法向后兼容。另请参阅：[软件版本控制 (wiki)](http://en.wikipedia.org/wiki/Software_versioning)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T15:35:19.913

这在一定程度上取决于框架中的任何更改是否需要重新编写代码。如果不是，那么推迟升级的理由就更少了，应该或多或少地立即完成。如果是的话，如果没有更令人信服的论据，升级可能*永远不会发生。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T15:36:15.730

我通常甚至在它成为最终版本之前就开始更新框架。但是当框架成为最终版本时，我立即用最终版本替换 pre-RTM 版本，在我的应用程序中进行最终更改并立即发布（将其投入生产）。

如果您仅在 RTM 发布之后才开始进行新的框架集成，那么您可能会冒着完成它的风险，并且稍后会听到发布了新的 RIM，这并不好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T15:38:04.883

我总是使用最新最好的东西。每当我遇到麻烦（我很少遇到）时，很容易找到发生了什么变化。

# c# - 如何将文件保存在用户选择的路径中

> ID：717281
> 
> 赞同：0
> 
> 时间：2009-04-04T15:38:59.937
> 
> 标签：c#

我正在导入源文件并对其进行处理，然后我必须将其保存在新位置。我已经创建了导入文件的语法，告诉我将其保存到新位置的语法。一种是当我调用构造函数给出导入文件的路径时，我也可以给出输出位置的路径。但不知道如何实现。请告诉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T16:14:29.477

您可以像这样使用 SaveFileDialog：

```
 using ( var dlg = new SaveFileDialog() )
{
    if ( dlg.ShowDialog() == DialogResult.OK )
    {
        //SAVE THE OUTPUT
        //DEPENDING ON THE FORMAT, YOU MAY WANT TO USE
        //File.WriteAllBytes(dlg.FileName, yourBytes);
        //File.WriteAllText(dlg.FileName, yourText);
        //File.WriteAllLines(dlg.FileName, yourStringArr);
        //OR ANY OTHER CODE YOU WANT TO USE TO PERSIST YOUR DATA
    }
        //else the user clicked Cancel
} 
```

此外，您可以设置默认扩展名、默认路径等。在 MSDN 上查找[SaveFileDialog 的信息](http://msdn.microsoft.com/en-us/library/w6sh4y16.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T15:58:28.173

在导入文件时，您可以使用 StreamWriter 基类将其写入最终用户在文本框或文件上传框中指定的文件。

# wpf - WPF：将宽度（和高度）设置为百分比值

> ID：717299
> 
> 赞同：162
> 
> 时间：2009-04-04T15:55:13.517
> 
> 标签：wpf, xaml, resize

假设我希望 a`TextBlock`等于`Width`它的 Parent 容器`Width`（即，从一侧延伸到另一侧）或它的 Parent Container 的百分比，`Width`我如何在`XAML`不指定绝对值的情况下完成此操作？

我想这样做，以便如果父容器容器稍后扩展（它的'`Width`增加），它的'子元素也将自动扩展。（基本上，就像在 HTML 和 CSS 中一样）

* * *

## 回答 #1

> 赞同：244
> 
> 时间：2009-04-04T16:04:34.460

您可以将文本框放在网格内以在网格的行或列上执行百分比值，并让文本框自动填充到其父单元格（默认情况下）。例子：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="2*" />
        <ColumnDefinition Width="3*" />
    </Grid.ColumnDefinitions>

    <TextBox Grid.Column="0" />
    <TextBox Grid.Column="1" />
</Grid> 
```

这将使#1 2/5 的宽度和#2 3/5。

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2009-04-04T16:24:10.640

将其拉伸到与父容器相同大小的方法是使用属性：

```
 <Textbox HorizontalAlignment="Stretch" ... 
```

这将使 Textbox 元素水平拉伸并水平填充所有父空间（实际上它取决于您使用的父面板，但应该适用于大多数情况）。

百分比只能与网格单元格值一起使用，因此另一种选择是创建一个网格并将您的文本框放在具有适当百分比的单元格中。

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2009-04-04T16:35:35.277

通常，您会使用适合您的场景的内置布局控件（例如，如果您想要相对于父级缩放，则使用网格作为父级）。如果您想使用任意父元素执行此操作，您可以创建一个 ValueConverter 执行此操作，但它可能不会像您想要的那样干净。但是，如果您绝对需要它，您可以执行以下操作：

```
public class PercentageConverter : IValueConverter
{
    public object Convert(object value, 
        Type targetType, 
        object parameter, 
        System.Globalization.CultureInfo culture)
    {
        return System.Convert.ToDouble(value) * 
               System.Convert.ToDouble(parameter);
    }

    public object ConvertBack(object value, 
        Type targetType, 
        object parameter, 
        System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

可以像这样使用它，以获取其父画布宽度的 10% 的子文本框：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication1"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <local:PercentageConverter x:Key="PercentageConverter"/>
    </Window.Resources>
    <Canvas x:Name="canvas">
        <TextBlock Text="Hello"
                   Background="Red" 
                   Width="{Binding 
                       Converter={StaticResource PercentageConverter}, 
                       ElementName=canvas, 
                       Path=ActualWidth, 
                       ConverterParameter=0.1}"/>
    </Canvas>
</Window> 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2012-09-17T16:48:13.243

对于任何遇到以下错误的人：**'2*' 字符串不能转换为长度。**

```
<Grid >
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="2*" /><!--This will make any control in this column of grid take 2/5 of total width-->
        <ColumnDefinition Width="3*" /><!--This will make any control in this column of grid take 3/5 of total width-->
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition MinHeight="30" />
    </Grid.RowDefinitions>

    <TextBlock Grid.Column="0" Grid.Row="0">Your text block a:</TextBlock>
    <TextBlock Grid.Column="1" Grid.Row="0">Your text block b:</TextBlock>
</Grid> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-08-31T02:52:23.913

可以使用 IValueConverter 实现。从 IValueConverter 继承的转换器类接受一些参数，如`value`（百分比）和`parameter`（父宽度）并返回所需的宽度值。在 XAML 文件中，组件的宽度设置为所需的值：

```
public class SizePercentageConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (parameter == null)
            return 0.7 * value.ToDouble();

        string[] split = parameter.ToString().Split('.');
        double parameterDouble = split[0].ToDouble() + split[1].ToDouble() / (Math.Pow(10, split[1].Length));
        return value.ToDouble() * parameterDouble;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        // Don't need to implement this
        return null;
    }
} 
```

XAML：

```
<UserControl.Resources>
    <m:SizePercentageConverter x:Key="PercentageConverter" />
</UserControl.Resources>

<ScrollViewer VerticalScrollBarVisibility="Auto"
          HorizontalScrollBarVisibility="Disabled"
          Width="{Binding Converter={StaticResource PercentageConverter}, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type Border}},Path=ActualWidth}"
          Height="{Binding Converter={StaticResource PercentageConverter}, ConverterParameter=0.6, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type Border}},Path=ActualHeight}">
....
</ScrollViewer> 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-05T12:20:00.063

我知道这不是 XAML，但我对文本框的 SizeChanged 事件做了同样的事情：

```
private void TextBlock_SizeChanged(object sender, SizeChangedEventArgs e)
{
   TextBlock textBlock = sender as TextBlock;
   FrameworkElement element = textBlock.Parent as FrameworkElement;
   textBlock.Margin = new Thickness(0, 0, (element.ActualWidth / 100) * 20, 0);
} 
```

文本框的大小似乎是其父级的 80%（右侧边距为 20%），并在需要时拉伸。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-07-30T10:39:11.260

我使用两种方法来确定相对大小。我有一个`Relative`带有三个附加属性的类`To`，如果我希望一个元素成为可视树中任何位置的元素的相对大小并且感觉不如转换器方法那么难懂 - 尽管使用对你有用的东西，你'很高兴。`WidthPercent``HeightPercent`

另一种方法则更为狡猾。在里面添加一个`ViewBox`你想要相对大小的地方，然后在里面，`Grid`在宽度 100 处添加一个。然后如果你在`TextBlock`里面添加一个宽度为 10 的，它显然是 100 的 10%。

将根据给定的任何空间进行`ViewBox`缩放`Grid`，因此如果它是页面上唯一的东西，那么`Grid`将被缩放到整个宽度并且有效地`TextBlock`缩放到页面的 10%。

如果你没有设置高度，`Grid`那么它会缩小以适应它的内容，所以它都是相对大小的。您必须确保内容不会太高，即开始改变空间的纵横比，`ViewBox`否则它也会开始缩放高度。您可能可以使用`Stretch`of解决此问题`UniformToFill`。

# latex - 如何使“附录”出现在 Latex 的目录中？

> ID：717316
> 
> 赞同：20
> 
> 时间：2009-04-04T16:06:02.273
> 
> 标签：latex, tableofcontents

如何使“附录”一词出现在目录中？现在 toc 看起来像这样：

```
1 ......  
2 ......  
.  
.  
A .....  
B ..... 
```

我希望它是：

```
1 ......  
2 ......  
.  
.  
Appendix A .....  
Appendix B ..... 
```

我的乳胶源文件结构是这样的：

```
\begin{document}  
\tableofcontents  
\include{...}  
\include{...}  
\appendix  
\include{...}  
\include{...}  
\end{document} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-05T00:11:07.723

有几种方法可以解决这个问题；不幸的是，在这个阶段我只为你准备了一个技巧。一个问题是，如果我们重新定义节号“A”以包含“附录”一词，它会打乱目录的格式。因此，我刚刚定义了一个新的切片命令，它打印没有数字的部分并手动插入“附录 X”。

有点难看，但至少它无需更改任何标记即可工作`:)`

```
\documentclass{文章}

\makeatletter
\newcommand\appendix@section[1]{%
  \refstepcounter{节}%
  \orig@section*{附录 \@Alph\c@section: #1}%
  \addcontentsline{toc}{section}{附录 \@Alph\c@section: #1}%
}
\let\orig@section\section
\g@addto@macro\appendix{\let\section\appendix@section}
\makeatother

\开始{文档}

\目录

\section{咕}
\标签{一个}
这是秒~\ref{a}

\section{har}
\标签{b}
这是秒~\ref{b}

\附录
\section{ji}
\标签{c}
这是应用程序~\ref{c}
\小节{我}
这看起来对吗？

\结束{文档}

```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-04T17:02:29.830

这可能最容易通过使用[appendix 包](https://www.ctan.org/pkg/appendix?lang=en)或[memoir 类](http://ctan.org/pkg/memoir)来实现。

如果您不想使用预打包的解决方案，则必须破解切片命令。当我需要为我的论文做这件事时，我克隆了`report`课程，并进行了编辑，直到我让边缘女士高兴为止。您正在寻找的是`\addcontentsline`宏的定义。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-11-04T09:27:11.933

对于我的论文，我做了以下工作：

```
\appendix
\addcontentsline{toc}{section}{Appendix~\ref{app:scripts}: Training Scripts}
\section*{Sample Training Scripts}
\label{app:scripts}
Blah blah appendix content blah blah blah. 
```

说明：我手动在 TOC 中添加了一行，因此我的 TOC 中会显示“附录 X：...”。然后我使用星号从 TOC 中排除了实际的部分命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-04T09:55:42.517

附录包是非常好的和简单的解决方案。我的回答可能对想要更改章节编号样式的人有所帮助，例如，使用西里尔字母或罗马数字。附录编号样式在 \@resets@pp 命令中进行了硬编码（我在此处查看了源代码[http://hal.in2p3.fr/docs/00/31/90/21/TEX/appendix.sty](http://hal.in2p3.fr/docs/00/31/90/21/TEX/appendix.sty)）。我通过简单地将这个命令重新定义为我自己的来解决它。只需将此代码添加到您的序言中：

```
\makeatletter

    \renewcommand{\@resets@pp}{\par
        \@ppsavesec
        \stepcounter{@pps}
        \setcounter{section}{0}

        \if@chapter@pp
            \setcounter{chapter}{0}
            \renewcommand\@chapapp{\appendixname}
            \gdef\thechapter{\Asbuk{chapter}} % changed
        \else
            \setcounter{subsection}{0}
            \gdef\thechapter{\Asbuk{section}} % changed
        \fi

        \if@pphyper
            \if@chapter@pp
                \renewcommand{\theHchapter}{\theH@pps.\Asbuk{chapter}} % changed
            \else
                \renewcommand{\theHsection}{\theH@pps.\Asbuk{section}} % changed
            \fi

            \def\Hy@chapapp{\appendixname}%
        \fi
    \restoreapp
}

\makeatother 
```

因此，

```
Appendix A
Appendix B
Appendix C
... 
```

将更改为

```
Appendix A
Appendix Б
Appendix В
... etc 
```

我不是乳胶专家，我不能保证这段代码不会破坏其他东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-17T22:30:38.563

根据@Will Robertson 的回答，下面的代码定义了相同的内容，但对于章节，并且还修复了使用包`chapter*`时不添加到标题的事实。`fancyhdr`

有了这个，所有的问题都解决了。

```
\makeatletter
\newcommand\appendix@chapter[1]{%
    \refstepcounter{chapter}%
    \def\app@ct{Appendix \@Alph\c@chapter: #1}
    \orig@chapter*{\app@ct}%
    \markboth{\MakeUppercase{\app@ct}}{\MakeUppercase{\app@ct}}
    \addcontentsline{toc}{chapter}{\app@ct}%
}
\let\orig@chapter\chapter
\g@addto@macro\appendix{\let\chapter\appendix@chapter}
\makeatother 
```

# http - 实现一个支持恢复的下载管理器

> ID：717319
> 
> 赞同：11
> 
> 时间：2009-04-04T16:08:16.510
> 
> 标签：http, file-io, download

我打算用 C++ 编写一个支持恢复（以及每次下载多个连接）的小型下载管理器。

从我目前收集的信息来看，在发送 http 请求时，我需要添加一个标头字段，其键为“Range”，值为“bytes=startoff-endoff”。然后服务器返回一个 http 响应，其中包含这些偏移量之间的数据。

因此，我大致想到的是将文件拆分为每个文件允许的连接数，并使用适当的“范围”为每个拆分部分发送一个 http 请求。因此，如果我有一个 4mb 的文件和 4 个允许的连接，我会将文件拆分为 4 个并有 4 个 http 请求进行，每个请求都有适当的“范围”字段。实现恢复功能将涉及记住哪些偏移量已经下载并且根本不请求那些。

*   这是正确的方法吗？
*   如果 Web 服务器不支持恢复怎么办？（我的猜测是它会忽略“范围”并发送整个文件）
*   发送 http 请求时，我应该在范围内指定整个拆分后的大小吗？或者可能要求较小的部分，例如每个请求 1024k？
*   读取数据时，我应该立即将其写入文件还是进行某种缓冲？我想写小块可能很浪费。
*   我应该使用内存映射文件吗？如果我没记错的话，建议频繁读取而不是写入（我可能是错的）。它是明智的记忆吗？如果我同时有多个下载怎么办？
*   如果我没有使用内存映射文件，我应该按允许的连接打开文件吗？或者当需要写入文件时只需寻找？（如果我确实使用了内存映射文件，这将非常容易，因为我可以简单地拥有几个指针）。

注意：我可能会使用 Qt，但这是一个普遍的问题，所以我没有写代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T16:43:09.487

关于请求/响应：

对于 Range-d 请求，您可以获得三种不同的响应：

`206 Partial Content`- 恢复支持和可能；检查响应的大小/范围的 Content-Range 标头
`200 OK`- 不支持字节范围（“恢复”），跟随整个资源（“文件”）
`416 Requested Range Not Satisfiable`- 不正确的范围（过去的 EOF 等）

内容范围usu。看起来像这样：`Content-Range: bytes 21010-47000/47022`，即字节开始-结束/总计。

检查[HTTP 规范](http://www.ietf.org/rfc/rfc2616.txt)以获取详细信息，尤其是。第 14.5、14.16 和 14.35 节

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T16:27:20.007

我不是 C++ 专家，但是，我曾经做过一个需要类似功能的 .net 应用程序（下载计划、恢复支持、优先下载）

我使用了 microsoft bits（后台智能传输服务）组件——它是用 c 开发的。Windows 更新也使用 BITS。我选择了这个解决方案，因为我认为我不是一个足够优秀的程序员来自己编写这种级别的东西;-)

虽然我不确定您是否可以获得 BITS 的代码 - 我确实认为您应该看看它的文档，这可能有助于您了解它们如何实现它、架构、接口等。

这是 - [http://msdn.microsoft.com/en-us/library/aa362708(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa362708(VS.85).aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T16:41:33.797

我不能回答你所有的问题，但这是我对其中两个的看法。

## 块大小

关于块大小，您应该考虑两件事：

1.  它们越小，发送 HTTP 请求的开销就越大。
2.  对于较大的块，如果一次下载失败，您将面临重新下载相同数据两次的风险。

我建议您使用较小的数据块。不过，您必须进行一些测试，看看哪种尺寸最适合您的目的。

## 在内存与文件中

您应该将数据块写入内存缓冲区，然后当它已满时将其写入磁盘。如果您要下载大文件，如果他们的 RAM 用完，对您的用户来说可能会很麻烦。如果我没记错的话，IIS 将小于 256kb 的请求存储在内存中，任何更大的请求都会写入磁盘，您可能需要考虑一种类似的方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-04T16:34:05.733

除了跟踪标记段开始的偏移量和每个段长度（除非您想在恢复时计算它，这将涉及对偏移列表进行排序并计算它们之间的距离），您还需要检查服务器发送的 HTTP 响应的 Accept-Ranges 标头，以确保它支持 Range 标头的使用。指定范围的最佳方式是“范围：字节=START_BYTE-END_BYTE”，您请求的范围包括 START_BYTE 和字节 END_BYTE，因此由 (END_BYTE-START_BYTE)+1 个字节组成。

我建议不要请求微块，因为您可能会被防火墙规则列入黑名单以阻止 HTTP 泛洪。一般来说，我建议你不要制作小于 1MB 的块，也不要制作超过 10 个块。根据您计划对下载进行的控制，如果您有套接字级别的控制，您可以考虑至少每 32K 写入一次，或者异步写入数据。

我无法评论 MMF 的想法，但如果下载的文件很大，那将不是一个好主意，因为你会消耗大量的 RAM，最终甚至导致系统交换，这效率*不*高。

关于处理块，您可以只创建几个文件 - 每个段一个，可选地预先分配磁盘空间，用与块大小一样多的 \x00 填充文件（预分配可能会在您在下载期间写入时节省您的时间，但是将使开始下载变慢），然后最后将所有块顺序写入最终文件。

您应该注意的一件事是多台服务器的最大值。并发连接限制，并且您不会提前知道它，因此您应该准备好处理 http 错误/超时并更改块的大小或创建块的队列以防您创建的块多于最大限度。连接。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-29T05:50:22.513

不是对原始问题的真正答案，但值得一提的另一件事是，可恢复下载器还应在尝试获取可能已更改的下一部分内容之前检查资源的最后修改日期。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T16:27:38.853

在我看来，您希望限制每个下载块的大小。如果连接在接近数据部分末尾时中止，大块可能会迫使您重复下载数据。特别是连接速度较慢的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-14T12:11:24.947

对于暂停恢复支持看这个简单的例子 [简单的下载管理器在Qt与暂停/恢复支持](http://kunalmaemo.blogspot.com/2010/05/simple-download-manager-in-qt-with.html)

# ruby - 如何诊断/跟踪“sendsig：useracc 失败。” HP-UX 中的问题

> ID：717327
> 
> 赞同：0
> 
> 时间：2009-04-04T16:17:30.110
> 
> 标签：ruby, hp-ux, yarv

我正在尝试在 HP-UX 上编译 Ruby 1.9.1-p0。在对 ext/pty.c 进行小改动后，它编译成功，尽管有*很多*警告消息（大约 5K）。当我使用“make test”运行自测时，它会崩溃并且核心转储并出现以下错误：

> 发送信号：useracc 失败。0x9fffffffbf7dae00 0x00000000005000
> 
> 由于写入信号上下文失败 - 可能的堆栈溢出，Pid 3044 被杀死。
> 
> 非法指令

通过谷歌搜索这个问题，非法指令只是系统用来终止进程的信号，与问题无关。调用信号处理程序时重新建立上下文似乎存在问题。在 gdb 中启动核心并没有显示出特别深的堆栈，所以我认为“可能的堆栈溢出”也不正确。

gdb 堆栈回溯输出如下所示：

```
#0  0xc00000000033a990:0 in __ksleep+0x30 () from /usr/lib/hpux64/libc.so.1
#1  0xc0000000001280a0:0 in __mxn_sleep+0xae0 ()
    from /usr/lib/hpux64/libpthread.so.1
#2  0xc0000000000c0f90:0 in <unknown_procedure> + 0xc50 ()
    from /usr/lib/hpux64/libpthread.so.1
#3  0xc0000000000c1e30:0 in pthread_cond_timedwait+0x1d0 ()
    from /usr/lib/hpux64/libpthread.so.1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T13:22:35.237

回答我自己的问题：

问题是分配的堆栈太小。所以这确实是堆栈溢出。sendig() 函数正在准备要从内核空间复制到用户空间的上下文结构。useracc() 函数检查指定的地址是否有足够的空间来执行此操作。

Ruby 1.9.1-p0 代码使用 PTHREAD_STACK_MIN 为创建的任何线程分配堆栈。根据 HP-UX 文档，在 Itanium 上这是 256KB，但是当我检查头文件时，它只有 4KB。来自 useracc() 的错误消息表明它正在尝试复制 20KB。

因此，如果一个线程接收到一个信号，它将没有足够的空间来接收其堆栈上的信号上下文。

# php - 如何仅在最后出现的分隔符上爆炸？

> ID：717328
> 
> 赞同：19
> 
> 时间：2009-04-04T16:18:32.680
> 
> 标签：php, arrays, string, explode, last-occurrence

```
$split_point = ' - ';
$string = 'this is my - string - and more'; 
```

如何使用第二个实例`$split_point`而不是第一个实例进行拆分。我可以以某种方式指定从右到左的搜索吗？

基本上我如何从右到左爆炸。我只想选择“ - ”的最后一个实例。

结果我需要：

```
$item[0]='this is my - string';
$item[1]='and more'; 
```

并不是：

```
$item[0]='this is my';
$item[1]='string - and more'; 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-04T16:25:36.063

您可以使用[strrev](http://us.php.net/strrev)来反转字符串，然后将结果反转回来：

```
$split_point = ' - ';
$string = 'this is my - string - and more';

$result = array_map('strrev', explode($split_point, strrev($string))); 
```

不确定这是否是最好的解决方案。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-04T16:49:50.157

这个怎么样：

```
$parts = explode($split_point, $string);
$last = array_pop($parts);
$item = array(implode($split_point, $parts), $last); 
```

我认为不会赢得任何高尔夫奖项，但它显示了意图并且效果很好。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-20T09:12:54.530

这是另一种方法：

```
$split_point = ' - ';
$string = 'this is my - string - and more';

$stringpos = strrpos($string, $split_point, -1);
$finalstr = substr($string,0,$stringpos); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-04T16:25:34.880

如果我理解正确，您希望示例案例给您（'这是我的 - 字符串'，'等等'）？

内置 split/explode 似乎只能向前 - 您可能必须自己使用 strrpos 来实现它。（左右搜索）

```
$idx = strrpos($string, $split_point);
$parts = array(substr($string, 0, $idx), substr($string, $idx+strlen($split_point))) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T16:33:32.207

为什么不在' - '上拆分，然后将您重新组合在一起的前两个数组条目连接起来？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-15T10:28:46.980

我偶然发现了同样的问题，并像这样修复它：

```
$split_point = ' - ';
$string = 'this is my - string - and more';

$reverse_explode = array_reverse(explode($split_point, $string)); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-09T08:04:50.440

我喜欢 Moff 的回答，但我通过将元素数量限制为 2 并重新反转数组来改进它：

```
$split_point = ' - ';
$string = 'this is my - string - and more';

$result = array_reverse(array_map('strrev', explode($split_point, strrev($string),2))); 
```

然后 $result 将是：

```
Array ( [0] => this is my - string [1] => and more ) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-28T07:40:31.717

**这是我的 - 字符串 - 还有更多**

1.  使用常用的explode函数获取所有字符串
2.  获取 sizeof 数组并获取最后一项
3.  *使用array_pop*函数弹出最后一项。
4.  用相同的分隔符内爆剩余的字符串（如果你想要其他分隔符可以使用）。

**代码**

```
$arrSpits=explode("", "this is my - string - and more");
$arrSize=count($arrSpits);

echo "Last string".$arrSpits[arrSize-1];//Output: and more

array_pop(arrSpits); //now pop the last element from array

$firstString=implode("-", arrSpits);
echo "First String".firstString; //Output: this is my - string 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-05T20:28:11.760

假设您只想忽略 $split_point 的第一次出现，这应该适合您：

```
# retrieve first $split_point position
$first = strpos($string, $split_point);
# retrieve second $split_point positon
$second = strpos($string, $split_point, $first+strlen($split_point));
# extract from the second $split_point onwards (with $split_point)
$substr = substr($string, $second);

# explode $substr, first element should be empty
$array = explode($split_point, $substr);

# set first element as beginning of string to the second $split_point
$array[0] = substr_replace($string, '', strpos($string, $substr)); 
```

这将允许您在第二次出现 $split_point 之后（包括）每次出现 $split_point 时进行拆分。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-19T06:14:53.927

只是一个想法：

```
function explode_reversed($delim,$s){
  $result = array();
  $w = "";
  $l = 0;
  for ($i = strlen($s)-1; $i>=0; $i-- ):
    if ( $s[$i] == "$delim" ):
      $l++;
      $w = "";
    else:
      $w = $s[$i].$w;
    endif;
    $result[$l] = $w;
  endfor;
return $result;
}
$arr = explode_reversed(" ","Hello! My name is John.");
print_r($arr); 
```

结果：

```
Array
(
    [0] => John.
    [1] => is
    [2] => name
    [3] => My
    [4] => Hello!
) 
```

但这比爆炸要慢得多。做了一个测试：

```
$start_time = microtime(true);
for ($i=0; $i<1000;$i++)   
  $arr = explode_reversed(" ","Hello! My name is John.");
$time_elapsed_secs = microtime(true) - $start_time;
echo "time: $time_elapsed_secs s<br>"; 
```

耗时 0.0625 - 0.078125s

但

```
for ($i=0; $i<1000;$i++)   
  $arr = explode(" ","Hello! My name is John."); 
```

仅需 0.015625 秒

**最快的解决方案似乎是：**

```
array_reverse(explode($your_delimiter, $your_string)); 
```

在 1000 次循环中，这是我能得到 0.03125 秒的最佳时间。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-22T05:04:18.180

不知道为什么没有人发布`$limit`支持的工作功能，尽管这里是为那些知道他们会经常使用它的人准备的：

```
<?php
function explode_right($boundary, $string, $limit)
{
 return array_reverse(array_map('strrev', explode(strrev($boundary), strrev($string), $limit)));
}

$string = 'apple1orange1banana1cupuacu1cherimoya1mangosteen1durian';
echo $string.'<br /><pre>'.print_r(explode_right(1, $string, 3),1).'</pre>';
?> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-03-10T14:05:53.250

我对所有过度设计的答案感到不知所措，这些答案正在调用许多函数和/或多次迭代数据。所有这些字符串和数组反转功能使该技术非常难以理解。

在这种情况下，正则表达式非常优雅。这正是我在专业应用程序中的做法：

代码：（[演示](https://3v4l.org/SKEG9)）

```
$string = 'this is my - string - and more';
var_export(preg_split('~.*\K - ~', $string)); 
```

输出：

```
array (
  0 => 'this is my - string',
  1 => 'and more',
) 
```

By greedily matching characters (`.*`), then restarting the fullstring match (`\K`), then matching the last occurring delimiting substring (" - "), you are assured to only separate the final substring from the string.

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2014-11-21T09:10:40.800

```
$split_point = ' - ';
$string = 'this is my - string - and more';
$result = end(explode($split_point, $string)); 
```

这工作正常

# flash - 服务器端动作脚本 3.0

> ID：717329
> 
> 赞同：6
> 
> 时间：2009-04-04T16:18:52.117
> 
> 标签：flash, actionscript-3

是否有任何版本的 Action Script 3.0 供服务器端使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-16T18:51:56.290

签出 Tamarin 和 redtamarin 以运行 actionscript 3 服务器端。[http://code.google.com/p/redtamarin/](http://code.google.com/p/redtamarin/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T09:19:10.263

据我所知，没有可用于服务器端脚本的 ActionScript 3 版本。但是，您可能想看看[Haxe](http://www.haxe.org)。这种语言与 ActionScript 3 类似，面向多个平台，如 JavaScript、Flash Player、PHP 和 Neko。通过以 Neko 为目标，您可以使用 Haxe 创建非常强大的服务器端应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T23:19:50.703

Flash Media Server 可以运行动作脚本。据我所知，虽然只有 ActionScript 1。

你可以阅读更多她：

[http://help.adobe.com/en_US/FlashMediaServer/3.5_SS_ASD/WSC604F694-2799-4472-8C55-684EF6D5224A.html](http://help.adobe.com/en_US/FlashMediaServer/3.5_SS_ASD/WSC604F694-2799-4472-8C55-684EF6D5224A.html)

不过我不会真正推荐它，ASP.NET 几乎在任何情况下都应该更好。您可以做的一件事是打开流连接并双向调用代码。要在 ASP.NET 中做到这一点，您必须使用套接字，这可行但不那么容易/快速。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-06T04:31:49.247

我有同样的问题，因为我需要在服务器端脚本中使用 RSA。

将 as3crypto 移植到服务器端 actionscript 并不容易

但我找到了解决这个问题的方法。通过编写 Flash Media Auth 插件，我可以在插件中做任何我想做的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-14T10:43:13.320

这是来自 adobe 的调查[http://www.surveymonkey.com/s/55FTCKJ](http://www.surveymonkey.com/s/55FTCKJ)
他们计划将 ActionScript 3 引入服务器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T16:46:58.820

由于 ActionScript 3 是 ECMAScript，有一些资源可能值得一看，这表明服务器端 javascript 正在获得一些动力，您可能能够接近您需要的东西

[http://server-side-javascript.org](http://server-side-javascript.org/)

和

[http://www.mozilla.org/rhino](http://www.mozilla.org/rhino/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-10T23:58:18.800

只要在服务器上设置了某种类型的环境来解释和运行它，任何服务器都可以运行任何代码。

所以这个问题应该重新表述为“他们有任何解释 Actionscript 3.0 的服务器环境吗？”

虽然我确信有人在某个时候制作了一个，但答案是否定的，因为即使它存在，它也并不普遍，而且不在许多（如果有的话）服务器上。我不知道有任何服务器安装了运行 AS3 代码的环境。而且我也认为它不会很快发生，因为许多其他语言都很好地填补了这一领域。

作为替代方案，请查看 Java。许多服务器将运行 JSP（Java 服务器页面）并且 Java 与 AS3 非常相似 :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-27T13:59:39.323

在遥远的将来，ColdFusion 可能会由 actionscript 提供支持。早在 2008 年就有 Adob​​e 的演示，关于在 Coldfusion 上运行 as3 作为服务器端语言。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-04T16:25:24.053

不，Flash 是客户端。使用 Flex，您可以与服务器（BlazeDS、ColdFusion、LiveCycle 或其他任何东西）进行通信。

理论上，您可以运行独立的 Flash（在服务器上的浏览器中运行......）或 AIR 应用程序来完成服务器端的工作......但会有更好的方法来做到这一点。

# sql - 如何从一组查询中自动确定表架构？

> ID：717336
> 
> 赞同：1
> 
> 时间：2009-04-04T16:24:03.040
> 
> 标签：sql, database-design, schema

是否有任何工具可以接受一组 CRUD 查询，并为该组生成一个“足够好”的表模式：

例如，我可以提供这样的输入：

> ```
>  insert username, password  
>   insert username, realname
>   select password where username=?
>   update password where username=?
>   update realname where username=? 
> ```
> 
> 有了这个输入，工具应该能够创建 1 个或 2 个或 3 个表，处理 _id 和索引。

换句话说，我正在寻找一种工具，通过它，我可以设计一组查询，*假设*一个无限的列表和工具进程，并实际生成许多数据库/表/列和高级语言模块对每个查询进行函数调用。

哦，是的，我正试图解雇我的数据库设计师（-：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T16:56:57.800

您是否考虑过使用像 Hibernate 这样的**ORM 解决方案？**这需要应用程序类模型（例如 User 类）和数据库模式表示（例如：USER 表）之间的初始映射集。

ORM 解决方案可能支持高级映射方案，其中一个对象映射到模式中的多个表。此外，较新版本的 Hibernate 支持从映射**生成数据库模式**（搜索 hbm2ddl 工具）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T17:35:04.323

你要求的是不可能的。

*   该工具如何知道`username`应该有一个索引，更不用说唯一索引了？
*   它如何知道列的数据类型？
*   它如何知道任何域约束——例如，假设的性别列必须是`male`or `female`， not `crimson`？
*   它不会很容易出现拼写错误，留下一个`username`和一个`user_name`列吗？

数据库需要设计的原因有很多。例如，规范化问题对于无法理解您的问题域的工具来说将是非常难以回答的。

也就是说，这不是自动的，但您要求的是——正如 Aleris 所回答的——一个 ORM。您没有指定您使用的是哪种语言，但肯定有一种（或多种）适合您的。

# database-design - “属于”数据库关系最佳实践？

> ID：717347
> 
> 赞同：0
> 
> 时间：2009-04-04T16:29:31.157
> 
> 标签：database-design

我在一个摄影网站上工作。网站上的照片将始终只属于一个事件。我最初的设计是：

```
Table: Events
ID, Title, etc

Table: Photos
ID, ThumbnailURL, etc

Table: EventPhotos
EventID, PhotoID, SortOrder 
```

这对我来说似乎很自然，但我意识到它所描述的关系实际上允许一张照片属于许多事件。我考虑过像这样重构它，这只允许一张照片属于一个事件：

```
Table: Events
ID, Title, etc

Table: Photos
ID, EventID, SortOrder, ThumbnailURL, etc 
```

事件关系数据在照片表中对我来说似乎有点脏/乱 - 原始设计将照片、事件和关系分开 - 但它确实避免了连接，并且它强制关系到“有”一个/属于'而不是'有很多' - 你怎么看？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T16:36:29.783

对于一对多的关系，你的第二个选择是标准的、正常的、正确的做法。

但是，您是否*完全*确定您在第一次拍摄中勾勒的多对多关系不适用？我不会那么肯定，但你比我更了解你的领域。

编辑：

OP添加了评论；

> 谢谢。我真的不认为照片应该属于一个以上的事件 - 事件是照片拍摄，每张照片都是根据特定拍摄的定义，按事件查看是浏览网站的唯一方式。我非常有信心一对多是正确的。

该评论中有几个教训，所以我想编辑它以强调这些教训。

观察 1\. 最重要的是，您无法在不知道两件事的情况下对模式进行建模：正在建模的真正问题域，*以及*我们的解决方案对模型的要求。

我最初的猜测是，OP 的事件和图片是在对事件中的照片*显示*进行建模，例如在艺术画廊（或网站上的图片库）中。在这种情况下，例如，Ansel Adams 在线画廊很可能有显示 Ansel Adams 照片的事件，标题为“Adams 的成熟作品”、“Adams 的结构照片”或“Adams 的沙漠照片”。这三个事件可能包括亚当的[“莫哈维沙漠中的传输线”，1941 年](http://www.archives.gov/research/ansel-adams/images/aab03.jpg)。由于可以在许多事件中显示许多照片，因此我们需要一个多对多结构。

但是 OP 的“事件”是*拍摄照片*，显然，正如 OP 所指出的，任何一张照片都是在一张照片中拍摄的，而且只有一张照片拍摄。

这里的教训是，在我们知道问题域之前，我们不能建模（或只能临时建模）。

我还建议更改表名“events”，以使这个矿石明确。将其称为“拍摄”或“photo_shoot”可以更清楚地了解我们正在建模的内容。

观察 2\. OP 的评论为他的反对意见提供了答案，即在照片中包含事件 FK 是“混乱的”。OP 非常敏锐地意识到，这“确实避免了连接，并且它强制关系到‘有一个/属于’而不是‘有很多’”。（避免连接是一个实现问题，正确的关系更为基础，因为它是一个建模问题。）

他还应该意识到，在我们的解决方案中，在问题域中，询问一张照片是有意义的，“这张照片是在什么照片会话/事件中拍摄的”。这就是为什么它不混乱的原因：“在哪个会话中拍摄”是关于照片或照片属性的合法问题，而 FK 提供了该问题的答案。这也意味着在这种情况下，从照片到事件的 FK 应该' t 可以为空：一张照片*必须*有一个照片会话，否则可能没有照片。

（这里还有一些额外的课程，关于建立一对多关系或多对多关系意味着什么，以及使 FK 可以为空或不为空意味着什么；我将把这些留给下一次。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T16:35:46.087

我不能说我曾经倾向于使用你的第一个选项来做类似的事情。我会选择第二个。将使用更少的查询。只需按 SortOrder 对查询进行排序也可以正常工作。

补充：我会使用第一个的唯一原因是，如果您（至少在某个时候）愿意这样做，以便可以将照片添加到多个相册中，但似乎并非如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T16:42:53.590

那么你拥有的第二个设计是最干净的。在第一个设计中，您*可以*在 Photos 和 EventPhotos 表之间使用“具有一个”关系，但这样将它们分开确实没有任何意义。如果在未来，你认为你需要多对多关系，那么只有在那个阶段将设计改回原来的。

干杯，格拉。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T18:08:36.427

我同意其他人的观点，即您的第二个选择是实现一对多关系（一个事件，许多照片）的公认方法。面向对象的背景会让您觉得在照片表中有一个事件外键列是两个独立实体的一种不舒服的耦合。但从关系数据库的角度来看，它就是这样做的。

保留您的首选，同时防止照片被用于多个事件的唯一方法是在 EventPhotos 的 PhotoID 列上放置一个唯一约束。EventPhotos 和 Photos 之间的关系将变成一对一的关系，这有点毫无意义，但您确实获得了照片和事件的解耦。

您的选择，但多年成功的关系数据库设计仍会支持第二种选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T16:38:15.347

我投票支持第二次。无需单独的 eventphotos 表。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-04-04T16:44:39.373

任何两种设计都将导致您在第二个中获得的一对多关系的唯一优势是避免再加入一个。但是遵循良好的数据库设计，我会更喜欢第一个。如果这次只有照片表需要与其他一些表的关系，你可以这样想，这个表中的 eventID 没有任何作用。

```
 For samll level db design i would prefer 2 but for large or medium scale i would prefer the first. 
```

# iphone - 自定义 UITableViewCell 变空的问题？

> ID：717349
> 
> 赞同：0
> 
> 时间：2009-04-04T16:31:01.823
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我有一个使用两个不同自定义表格单元格的分组表格视图。

当我滚动表格以使一个（或多个）单元格在可见的上方或下方时，这些单元格变为空白。当我向上（或向下）滚动以查看这些单元格时，它们仍然是空白的。为什么是这样？单元格在首次加载时显示适当的内容。

这是在指定 indexPath 加载单元格的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    if(indexPath.section==0)
    {
        FMLFullTextCell = (FullTextCell *) [tableView dequeueReusableCellWithIdentifier:FullTextCell_ID];
        if(FMLFullTextCell==nil)
        {
            [[NSBundle mainBundle]loadNibNamed:@"FullTextCell" owner:self options:nil];
            [FMLFullTextCell initWithFMLText:@"Here is some demo fml text"];
        }
        return FMLFullTextCell;
    }
    else
    {
        FMLAuthorCell=(Author *)[tableView dequeueReusableCellWithIdentifier:AuthorCell_ID];
        if(FMLAuthorCell==nil)
        {
            [[NSBundle mainBundle]loadNibNamed:@"Author" owner:self options:nil];
            [FMLAuthorCell initWithTitle:@"Author" initWithAuthor:@"JohnnyAuthor"];
        }
        return FMLAuthorCell;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T22:41:43.040

您没有提供足够的信息来回答这个问题。

通常 UITableViewCells 在通过创建`initWithFrame:reuseIdentifier:`和访问时被缓存`dequeueReusableCellWithIdentifier:`。我的猜测是，您没有为两个不同的自定义表格单元格指定不同的重用标识符，因此它们会以某种方式混入您的代码中。这可能会导致所描述的行为。

无论如何，没有看到一些代码，这很难回答。您至少应该向我们展示`tableView:cellForRowAtIndexPath`您的数据源的方法。

# javascript - 将 javascript 日期发送到 vb.net 日期变量

> ID：717364
> 
> 赞同：3
> 
> 时间：2009-04-04T16:37:47.890
> 
> 标签：javascript, vb.net, asp.net-2.0

我需要将 javascript 日期值传递给 vb.net 函数。

方法 iam 现在使用：将 javascript 日期转换为字符串，将其存储在隐藏字段中 从服务器代码中的隐藏字段中检索字符串并使用 date.parse 对其进行解析

问题在于 Javascript 日期格式

toString() - 2009 年 4 月 4 日星期六 22:19:00 UTC+0530

toDateString() - 2009 年 4 月 4 日星期六

toLocaleString() - 2009 年 4 月 4 日星期六晚上 10:19:00

与 vb 日期格式不匹配。我收到无法解析的错误。

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T17:17:13.787

使用 ToLocaleString 的问题是您会丢失时区信息及其明显的区域设置，这意味着您需要使用正确的文化对其进行解析。

我刚在想：-

~~DateTime d = DateTime.ParseExact(sInput, "ddd MMM d HH:mm:ss UTCzzzz yyyy" , CultureInfo.InvariantCulture);~~

但这不是跨浏览器兼容的（ECMA 规范没有定义 toString 实际上应该做什么）。

但是，我们确实知道 Javascript Date 对象的值是从 1970 年 1 月 1 日午夜开始的毫秒数。因此，您可以将日期对象的 .valueOf 存储在隐藏字段中。首先在字符串上使用 Int32.Parse，从该值创建一个 TimeSpan 并将其添加到 1970 年 1 月 1 日 00:00:00 UTC+0000 的 DateTime。

```
int milliseconds = Int32.Parse(inputString);
TimeSpan t = TimeSpan.FromMilliseconds(milliseconds);
DateTime base = new DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc);
DateTime result = base + t; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T16:40:55.497

为什么不将 Javascript 日期作为字符串传递，然后在 VB.net 中将其转换为日期类型。

```
Public Function ConvertJavaScriptDate(ByVal d as String) As Date
  Return Date.Parse(d)
End Function 
```

另一种选择是使用 CType(d,Date)。CType 是一个词法转换，它会尝试多种方法将字符串值转换为日期。

我对 JavaScript 日期和 VB.Net 日期在格式方面的区别并不十分熟悉，但是如果您发布一个示例，我相信我们可以进行基本的转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T16:59:15.517

由于我不必担心文化差异，我将使用`toLocaleString()`.

`toLocaleString()`解析为与 Date.Parse() 兼容的字符串。

无论如何，感谢您发布您的回复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T16:47:39.490

这只是一个日期时间格式问题，您可以查看这篇文章了解更多详细信息。 [我们如何解决将 Access DB 从生产服务器转移到实时服务器的日期时间问题](https://stackoverflow.com/questions/714825/how-we-can-resolve-the-datetime-problem-shifting-the-access-db-from-production-se)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T17:13:33.327

您还可以使用`DateTime.ParseExact()`VB 代码准确地告诉 VB 代码传入的字符串应该是什么样子。

# multithreading - 何时在 asio 中使用异步操作

> ID：717370
> 
> 赞同：4
> 
> 时间：2009-04-04T16:40:14.813
> 
> 标签：multithreading, boost, asynchronous, boost-asio

我什么时候应该在 boost::asio 中使用异步操作而不是在单独的线程中使用同步操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T16:45:48.357

[基本原理](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio/overview/rationale.html)部分有帮助吗？

> 大多数程序都以某种方式与外界交互，无论是通过文件、网络、串行电缆还是控制台。有时，就像网络的情况一样，单个 I/O 操作可能需要很长时间才能完成。这对应用程序开发提出了特殊的挑战。
> 
> Boost.Asio 提供了管理这些长时间运行操作的工具，而不需要程序使用基于线程和显式锁定的并发模型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T16:51:56.250

我强烈建议您尽可能使用异步方法。异步调用不一定会创建线程，因此通过坚持异步操作，您可以减少与线程相关的开销。此外，线程通常更难开发和维护。

希望能帮助到你。

# iphone - 为什么 NSString 属性更改为无效值？

> ID：717385
> 
> 赞同：5
> 
> 时间：2009-04-04T16:49:01.467
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

当我在 viewDidLoad 和 viewWillAppear 之间移动时，我有一个属性变为无效。我不知道为什么会这样。

我有一个帮助类，可以获取我的数据库的路径。我在应用程序委托中分配这个类。RootViewController 获取对 appDelegate 的引用，如下所示：

```
//inside .h file
@interface RootViewController : UITableViewController
<UITableViewDelegate, UITableViewDataSource>{
NSArray *controllers;
myAppDelegate *appDelegate;
}

//inside .m file
@implementation RootViewController
@synthesize controllers;

- (void)viewDidLoad {
appDelegate = [[UIApplication sharedApplication] delegate]; 

self.controllers = appDelegate.topicControllers;
[super viewDidLoad];
} 
```

我将鼠标悬停在 appDelegate 上以查找数据库帮助程序类和包含数据库路径的属性：

```
NSPathStore2 * appDelegate.databaseHeper.databasePath  "/Users/userA/Library/Application Support/iPhone Simulator/User/Applications..." 
```

databasePath 被声明为 NSString。为什么它变成了 NSPathStore2？

当我在调试器中继续时，发生了一些其他奇怪的事情。进入 viewWillAppear 后，属性值变为“无效”并且类型返回 NSString。虽然我什至在那里看到了 UIButton。

为什么会变成无效？我不能再使用该变量。

```
- (void)viewWillAppear:(BOOL)animated {
[super viewWillAppear:animated]; //changes before this line executes
} 
```

我在 viewDidLoad 和 viewWillAppear 之间不做任何事情。以下是在 databaseHelper 类中分配 databasePath 的方式，这在前面的 applicationDidFinishLaunching 中发生：

```
- (NSString *) getDBPath {
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory , NSUserDomainMask, YES);
NSString *documentsDir = [paths objectAtIndex:0];
return [documentsDir stringByAppendingPathComponent:self.databaseName];
} 
```

stringByAppendingPathComponent 返回一个 NSString。为什么我在分配后的某个时候会得到一个 NSStorePath2 ？

我现在一切正常，但只需调用 [databaseHelper getDBpath]。我的目标是节省一些 CPU 周期并存储该值。因此databasePath。为什么 databasePath 更改为无效的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T21:01:31.673

因为你没有保留价值。查看[内存管理编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/)中的规则以了解何时需要保留某些内容。

当然，正如 cdespinosa 所指出的，您可能一开始就不需要缓存此路径名。它可能不是一个很大的性能杀手。先分析，*再*优化热点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T16:59:06.420

我相信您的意思是 NSPathStore2，而不是 NSStorePath。

NSPathStore2 位于 NSString 的内部私有子类中，该子类在已知字符串是文件系统路径的子系统中使用。在您关心的所有方面，它在功能上等同于 NSString。

从您的帖子中不清楚您是否有任何问题，除了想知道该类是什么，以及通过缓存它是否可以获得任何优化。答案可能不是：在访问数据库时使用 CPU 周期的所有事物中，对其文件系统路径的访问可能排在最后。

# c - 在 C 中以编程方式使用 CMD

> ID：717391
> 
> 赞同：0
> 
> 时间：2009-04-04T16:53:04.283
> 
> 标签：c, windows

如何在程序中模拟这些调用？就像说我想找到所有活动的连接。所以我想使用 netstat -a 我怎样才能使用它而不必真正打开一个窗口？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T16:57:17.690

使用 CreateProcess，重定向输出。

如果调用应用程序不是 Windows 应用程序，则控制台窗口没有问题（因为默认情况下，控制台编程将继承其父控制台）。

如果调用应用程序是 Windows 应用程序，请将传递给 CreateProcess 的正确选项设置为默认将创建的控制台窗口隐藏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T17:00:15.777

您可以使用库函数 - 我猜 Windows 也有`system()`它，因为它是 C89 以来的标准 C 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T17:25:11.570

您必须使用“start”命令的“/B”选项。

cmd /C 开始“标题” /B netstat -i

我假设弹出控制台是您的主要问题，而您是收集数据的策略。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T18:15:39.293

永远不要使用 system() （不专业，蹩脚）
使用 Win32 net apis 。
请参阅 netstat 的源代码。

# ruby-on-rails - Rails - 通过范围查找最佳实践？

> ID：717392
> 
> 赞同：1
> 
> 时间：2009-04-04T16:53:06.247
> 
> 标签：ruby-on-rails

在 Rails 中，我知道最好通过范围查找

例如在 questions_controller

```
def index
  @event = Event.find(params[event_id])
  @question = @event.questions
end 
```

但是在表演动作中做同样的事情也是一种好习惯吗

```
def show
  @event = Event.find(params[:event_id])
  @question = @event.questions.find(params[:id])
end 
```

还是更好地直接在问题模型上进行查找而不通过事件对其进行范围界定？

我对此感到好奇，并且在创建新记录而不同时创建问题记录时，也对 @question.comments.build 与 Comment.new 做类似的事情。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T19:13:50.357

如果您只是让事件得到一个问题，那么做 Event.find 是不必要的，并且会导致额外的工作。

您编写的两个操作都执行两个查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T01:51:45.190

关于您的第一个问题，请记住以下几点：

*   如果您突然需要 @event 在您的视图中怎么办？
*   如果您想用一些自定义逻辑（即访问控制）扩展 Event.find 怎么办？
*   有没有理由*不去*事件接口？

就我个人而言，如果仅仅是为了避免过早的优化，我会使用 Event 的接口来获取问题。

至于你的第二个问题，@question.comments.build 会自动在你的新结构中设置正确的引用，所以只要@question 可用，我就会去做。（哎呀，我什至会考虑为 Question 类创建一个 @question.add_comment(..) 方法）。

换句话说，过早的优化是万恶之源。松耦合对你有好处。

# c - 没有C语言库的输入和输出

> ID：717410
> 
> 赞同：4
> 
> 时间：2009-04-04T17:01:29.830
> 
> 标签：c, input

我正在用 C 为我的程序编写一个小内核。

这不是（目前）操作系统内核，它只是我在不依赖外部源（即stdio.h）的情况下跟踪程序中的输入和输出的一种方式。你可能会问我为什么要这样做；只是为了让我知道它是如何工作的，这样我才能对程序流进行更多、更多（最终目标是完全）控制。

我想知道是否有人知道一些关于 C 输入和输出的教程（使用内联 asm？）而不依赖任何其他代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T22:04:36.700

裸机和 stdio 之间有很大的空间。您已经说过您不是在编写操作系统内核，而是说您是否在操作系统下运行。

在没有操作系统的情况下直接在硬件上运行，您仍然希望将所有 I/O 操作封装在一个模块中，即使您没有正式定义所有 I/O 模块要遵循的设备驱动程序接口和框架。这在很大程度上依赖于架构，并使您有责任了解与您可能使用的每个 I/O 设备交互的所有细节。对于某些设备，这可能很快成为一项巨大的开发工作。这对嵌入式系统来说不是问题，但是以这种方式在商业硬件上运行既不容易也不推荐。

在操作系统中运行时，您可能无法（也不应该想要）访问实际的硬件寄存器和中断。如果您正在开发自定义 I/O 设备，最佳实践是使其符合现有标准，以便您需要尽可能少的低级自定义软件。这就是为什么您会看到许多通过 USB 连接并将自己标识为 HID（人机接口设备）的自定义用户界面小工具。作为 HID，现有的 USB 驱动程序负责物理层，操作系统提供的 HID 驱动程序负责逻辑接口，为应用程序提供非常简单的高级访问 API。

操作系统的关键角色之一是为所有设备提供一致的 I/O API。通常，它采用`open()`, `close()`, `read()`, `write()`, 和`ioctl()`函数的形式（名称各不相同，但至少前四个的某种形式总是存在的）。然而，操作系统层非常原始。通常，操作系统调用无需太多处理就被转发到设备驱动程序，然后设备驱动程序将数据转发到设备上。通常，操作系统低级调用会阻塞调用者，直到它们完成，并且它们通常对有意义的缓冲区大小有限制。例如，对磁盘设备的原始访问通常需要一次访问整数个磁盘块。

并且不要忘记诸如文件系统和网络协议之类的东西……通过封装在操作系统中，所有这些都变得更加可靠和兼容。

即使调用单个字符是可以接受的`read()`，`write()`这通常也不是最好的性能。操作系统调用相对昂贵，如果您可以在一次调用中读取多个字符，那么您的性能会大大提高。

这就是 C 语言的 stdio 库以及其他环境中的各种其他缓冲库的起源。stdio 库提供了一个缓冲层，将 C 代码与底层硬件的块大小隔离开来。即使在完全自主开发的操作系统上，您可以完全控制所有设备，像 C stdio 这样的东西仍然很有价值。

编写自己的 stdio 替换是一项非常有价值的练习，即使您不在生产代码中使用它，我也会向任何想要了解终端或文件`printf()`之间真正发生的事情的人推荐它。`scanf()`

一个有价值的资源是PJ Plauger所著**[的 The Standard C Library一书。](https://rads.stackoverflow.com/amzn/click/com/0131315099)**在其中，作者介绍了 ANSI 标准中指定的完整 C 运行时库的实现。他对他所做的具体实现选择的讨论很有价值，并且适合这个问题的上下文，关于为什么指定一些标准库特性的讨论也很有趣。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T17:10:16.800

这种事情是非常特定于架构的。简而言之，您的 I/O 设备将向 CPU 提出硬件中断。CPU 将调用与中断相关的代码，该代码将适当地处理它；对于输入设备，它将从设备中获取可用的数据，对于输出设备，中断通常意味着设备已准备好发送下一个数据。

旧的 8088/8086 CPU 架构是一个很好的简单起点，可以让您开始了解这一点。通常，BIOS 将是处理硬件中断的地方，但您始终可以编写自己的中断。;)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T17:05:35.593

您必须使用 BIOS 调用，Int 10h 是用于写入视频内存的调用。

[http://hdebruijn.soo.dto.tudelft.nl/newpage/interupt/out-0100.htm](http://hdebruijn.soo.dto.tudelft.nl/newpage/interupt/out-0100.htm)

[http://en.wikipedia.org/wiki/BIOS_call](http://en.wikipedia.org/wiki/BIOS_call)

# entity-framework - ADO 实体框架图问题

> ID：717415
> 
> 赞同：1
> 
> 时间：2009-04-04T17:03:42.323
> 
> 标签：entity-framework

## 环境：

*   Windows Vista x64
*   Visual Studio 2008 专业版 9.0.30729.1 SP
*   Microsoft .NET 框架版本 3.5 SP1

## 问题：

1.  可以打开空白实体框架图，但不能从数据连接或...

2.  可以使用“从数据库生成”选项填充实体框架图，但随后图将不会打开。

生成的选项在 XML 编辑器中打开，并填充了相关数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T17:21:41.797

我遇到了同样的问题...我发现的唯一解决方法是首先使用 Xml 编辑器打开（当我无法在 EDM 设计器中打开它时）然后关闭它并转身重新打开它在 EDM 设计器中。

# asp.net - 将 DLL 附加到 ASP.NET 站点

> ID：717416
> 
> 赞同：6
> 
> 时间：2009-04-04T17:04:50.447
> 
> 标签：asp.net, iis, dll, iis-7

如何将 DLL 附加到 asp.net 站点？我希望能够调试和编辑 DLL，而不必不断替换我的 asp.net 站点中的引用。我检查了附加到进程，但没有看到工作进程。我正在使用 asp.net，IIS 7。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-04T17:05:54.423

只需将其放入 Web 应用程序的 /bin 文件夹即可。

### 或者

通过右键单击`References > Add Reference > Browse >`选择您的 .dll 文件并单击确定来添加对此 .dll 的引用。

然后将其“复制本地”属性设置为“真”。这样每次构建应用程序时 .dll 都会被复制到 /Bin 文件夹中。

[替代文字 http://xmages.net/out.php/i170817_1.png](http://xmages.net/out.php/i170817_1.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T17:20:50.613

使用 Visual Studio，您应该创建一个解决方案，将您的网站作为一个项目，并将 DLL（代码）作为另一个项目。在网站项目中对 DLL 项目进行引用，它应该会自动更新。

如果您不使用 Web 应用程序模型而仅使用网站模型，则可以将 DLL 项目直接输出到您网站的 /bin 目录。每当您构建 DLL 项目时，这将更新 website/bin 文件夹中的 DLL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T17:23:53.490

如果要编辑 dll，请在 Visual Studio 的第二个实例中打开该项目，并像对待任何其他项目一样对待它。

将 /bin 文件夹中的引用设置为第二个 Visual Studio 创建的调试 dll。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T17:24:49.790

我假设你有 Visual Studio ......

如果您只是想添加一个 dll，您可以通过右键单击您的网站节点并选择“添加引用...”来添加对它的引用。如果您有它的 pdb 以及它（从加载符号），您将能够调试 dll。您将无法编辑 dll。

如果 dll 实际上是您拥有源代码的另一个项目，只需将该项目添加到您的解决方案中，然后从您的网站项目中添加来自“项目”选项卡的引用。VS 应该添加一个引用和依赖项，以便在您更改 dll 项目中的代码时保持 dll 更新。

# .net - 如何在 linq 中处理数据集的数据关系？

> ID：717421
> 
> 赞同：1
> 
> 时间：2009-04-04T17:07:42.953
> 
> 标签：.net, asp.net, vb.net, linq, ado.net

有人可以提供一个 linq 查询数据集中各种嵌套表的示例吗？我在网上找不到类似的东西。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T17:19:48.367

你不会只是导航吗？

```
from cust in ds.Customers
from order in cust.GetChildRows("CustomersOrders").Cast<Order>() 
```

ETC？

# asp.net-mvc - 将 url 字符串作为参数传递给 mvc 控制器

> ID：717427
> 
> 赞同：6
> 
> 时间：2009-04-04T17:09:46.690
> 
> 标签：asp.net-mvc

我需要将完整的网站 url 传递给我的控制器操作，如下所示：

```
http://myweb/controller/action/http://blabla.com/dir2 
```

如何创建一条新路由来将此参数传递给操作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T17:12:39.023

```
routes.MapRoute("Name", "{controller}/{action}/{*url}"); 
```

附加信息：

*   [深入了解 ASP.NET MVC：ASP.NET MVC 请求的生命周期](http://stephenwalther.com/blog/archive/2008/03/18/asp-net-mvc-in-depth-the-life-of-an-asp-net-mvc-request.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-04T17:33:20.287

将其作为参数传递。

```
<%= Html.ActionLink( "Link", 
                     "MyAction",
                     "MyController",
                     new { url = "http://blah.com/blah" },
                     null ) %> 
```

应该产生一个如下所示的链接：

```
<a href='/MyController/MyAction?url=http://blah.com/blah'>Link</a> 
```

您的操作如下所示：

```
public ActionResult MyAction( string url )
{
   ...
} 
```

# javascript - Flex 到 JavaScript 库/API

> ID：717434
> 
> 赞同：1
> 
> 时间：2009-04-04T17:14:45.680
> 
> 标签：javascript, apache-flex

**Flex 到 JavaScript 库/API**

我正在寻找一个用于在 Flex/AS3 中公开 JavaScript 对象的“小型”库。我看过 Adob​​e 的 FABridge，但在我看来，这更像是 JavaScript 到 Flex。有没有使用带有 FABridge 的 JavaScript 对象的 Flex 的好例子？...或其他一些更符合其他人知道/使用过的方向的 Flex-JavaScript 库？

我看过的唯一另一个是 JSInterface ...但它是用俄语记录的:-( ...

gsb

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T20:34:05.437

我不确定您到底想要做什么，但如果它只是 Flex 和 Javascript 之间的简单通信，您可以使用 ExternalInterface 类来执行此操作。它允许 Flex 应用程序调用 HTML 包装器中定义的 Javascript 方法，还允许 Javascript 调用您通过 ExternalInterface 公开的 Flex 应用程序中的方法。

[http://livedocs.adobe.com/flex/3/langref/flash/external/ExternalInterface.html](http://livedocs.adobe.com/flex/3/langref/flash/external/ExternalInterface.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T00:44:53.787

我完成了[文档](http://code.google.com/p/jsinterface/wiki/help_english)、[演示文稿](http://actualwave.com/lab/pack/JSInterface_presentation_en.swf)和[ASDoc](http://jsinterface.googlecode.com/files/ASDoc_english.zip)到英文的翻译。：） 不客气

# java - 从 Java 创建 MySQL 数据库

> ID：717436
> 
> 赞同：27
> 
> 时间：2009-04-04T17:17:24.583
> 
> 标签：java, mysql, database

是否可以从 Java 创建 MySQL 数据库？

我只见过这样的连接 URL 示例，其中在 URL 中指定了数据库名称：

```
String url="jdbc:mysql://localhost:3306/test";

Connection con = DriverManager.getConnection( url, "cb0", "xxx" ); 
```

当我只有登录名和密码时，如何创建 MySQL 数据库？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-04-04T17:27:39.253

jdbc 连接中不需要数据库，因此您可以执行类似[http://forums.mysql.com/read.php?39,99321,102211#msg-102211](http://forums.mysql.com/read.php?39,99321,102211#msg-102211)和[http://marc.info推荐的操作/?l=mysql-java&m=104508605511590&w=2](http://marc.info/?l=mysql-java&m=104508605511590&w=2)：

```
Conn = DriverManager.getConnection
("jdbc:mysql://localhost/?user=root&password=rootpassword"); 
s=Conn.createStatement();
int Result=s.executeUpdate("CREATE DATABASE databasename"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-30T15:19:09.093

要通过 Java 代码创建数据库，您必须使用`executeUpdate(sql)`代替并以root 身份`executeQuery(sql);`连接到数据库：`mysql`

```
connection =  DriverManager.getConnection(
    "jdbc:mysql://localhost:3306/mysql?zeroDateTimeBehavior=convertToNull",
    "root", "root"
);
Statement st = connection.createStatement();
st.executeUpdate(sql);
st.close(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T12:24:48.447

解决此类问题的一种优雅方法是使用Apache 的[DDL Utils](http://db.apache.org/ddlutils/)。它不仅可以实现允许执行（外部可配置的）DDL 的基本目的，还可以使您的应用程序数据库独立。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T19:56:40.057

为了让事情变得更简单，您可以使用 NetBeans 6.5，它使设置 SQL 数据库变得如此简单。我现在正在使用它们，它是 GUI 布局和数据库连接的救星。下面是一些关于如何从 NetBeans 连接到 mysql 数据库的代码：

```
 //these are variables i declare in the beginning of my code
    public static final String DRIVER = "com.mysql.jdbc.Driver";
    public static final String DATABASE_URL = "jdbc:mysql://localhost:3306/jtschema";
    private Connection connection = null;
    public static Statement statement = null;

    public void initSQLServer() {
        try {
            Class.forName(DRIVER).newInstance();
            try {
                connection = DriverManager.getConnection(DATABASE_URL, "root", "Dropatrain!248");
                statement = connection.createStatement();
            } catch (SQLException e) {
                System.out.println("SQLException: " + e.getMessage());
                System.out.println("SQLState: " + e.getSQLState());
                System.out.println("VendorError: " + e.getErrorCode());
            }
        } catch (Exception ex) {
            System.out.println(ex);
        }
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-21T06:13:43.793

您可以使用以下行：

```
 try {
        String databaseName = "dbName";
        String userName = "root";
        String password = "yourPassword";

        String url = "jdbc:mysql://localhost:3306/mysql?zeroDateTimeBehavior=convertToNull";
        Connection connection = DriverManager.getConnection(url,username, password);

        String sql = "CREATE DATABASE " + databaseName;

        Statement statement = connection.createStatement();
        statement.executeUpdate(sql);
        statement.close();
        JOptionPane.showMessageDialog(null, databaseName + " Database has been created successfully", "System Message", JOptionPane.INFORMATION_MESSAGE);

    } catch (Exception e) {
        e.printStackTrace();
} 
```

# objective-c - 如何在没有 Interface Builder 的情况下创建 Cocoa 接口？

> ID：717442
> 
> 赞同：39
> 
> 时间：2009-04-04T17:22:52.730
> 
> 标签：objective-c, cocoa

我更愿意以编程方式创建我的界面。似乎 Apple Developer 上的所有文档都假设您使用的是 Interface Builder。是否可以以编程方式创建这些接口，如果可以，我从哪里开始学习如何做到这一点

我认为如果可能的话，相关文档会在本节中：http: [//developer.apple.com/referencelibrary/Cocoa/idxUserExperience-date.html](http://developer.apple.com/referencelibrary/Cocoa/idxUserExperience-date.html)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-09-11T15:15:09.867

我喜欢这个问题，而且我也想知道减少 IB 的资源。有用性（“为什么”）仅受想象力的限制。在我的脑海中，以下是显式编程 UI 的一些可能原因：

*   实现更好的界面生成器。
*   编程动态 UI，即其结构静态不可知的 UI（在编译/xcode 时）。
*   为 UI 实现跨平台库或语言的 Cocoa 后端。

有一系列关于[无笔尖工作](http://lapcatsoftware.com/blog/2007/05/16/working-without-a-nib-part-1/)的博客文章以及[Michael Mucha 最近在 cocoa-dev 上的描述](http://lists.apple.com/archives/Cocoa-dev/2009/Aug/msg01259.html)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-04T18:00:44.463

> 我更愿意以编程方式创建我的界面。

为什么？Interface Builder 更简单、更快捷。你不能通过拖放来写错字，当你手动输入矩形时，你也不会得到那些非常方便的 Aqua 指南。

不要与之抗争。界面生成器是您的朋友。让它帮助你。

如果你*坚持*用代码编写 UI 来浪费自己的时间和精力：

不基于文档（通常基于库，如 Mail、iTunes、iPhoto）：创建 NSObject 的子类，实例化它，并使其成为应用程序的委托，并在委托的`applicationDidFinishLaunching:`方法中，创建一个窗口，用视图填充它，然后把它放在前面。

基于文档（如 TextEdit、Preview、QuickTime Player）：在`makeWindowControllers`NSDocument 子类的方法中，创建窗口（并用视图填充它们）并为它们创建窗口控制器，确保`addWindowController:`为每个窗口控制器发送您自己。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-09-14T14:55:47.023

作为一个完全盲目的开发人员，我可以说 IB 与 VoiceOver（OS X 上的内置屏幕阅读器）不兼容。

这意味着，如果没有获得关于在没有 IB 的情况下使用 Cocoa 的强大文档，我将无法在 Cocoa 中为 OS X / iPhone 开发应用程序，这意味着我（具有讽刺意味的是）无法在 OS X / 上轻松开发盲人（和所有其他人）可以访问的应用程序IOS。

我目前不想使用的解决方案是 Java + SWT，当然这适用于 OS X，而不适用于 iOS。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-06-18T21:49:16.850

事实上，当你开始编写自己的 UI 类时，IB 就变得完全没用了。假设您创建了自己的按钮，该按钮使用基于 plist 的皮肤系统。或者您创建一个动态工具栏，根据用户选择加载和卸载项目。

IB不接受自定义UI元素，所以更复杂的UI不能用他。是的，你会想做 UIKit 给你的更复杂的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-10-19T06:22:57.037

虽然这有点老了......我尝试了很多次只用编程方式做所有事情。这很难，但可能。

**更新**：我针对这个特定问题发布了另一个问题：[View-based NSOutlineView without NIB?](https://stackoverflow.com/questions/19464136/view-based-nsoutlineview-without-nib) ，现在我相信一切都可以以编程方式完成，但是由于缺乏信息或示例，如果没有苹果工程师的咨询，这将是非常困难的。

* * *

下面的论点可能是题外话，但我想指出为什么我强烈喜欢以编程方式。

我也更喜欢程序化的方式。因为

*   静态布局工具无法处理任何动态。
*   跨多个 NIB 重现相同的 UI 状态是困难的。一切都是隐含的或隐藏的。您需要访问所有面板以**查找**参数。这种工作很容易出错——容易出错。
*   管理一致的状态很困难。因为复制相同的外观很难。
*   自动化不可能。您不能制作自动生成的输入表单。
*   参数间接 - 例如用户选择的可变元素大小 - 是不可能的。
*   瞄准小点比在固定位置敲击手指大小的键要困难得多 - 有趣的是，这对开发人员来说是一个严重的可用性问题！
*   IB有时会拧螺丝。这意味着它是可编译的，并且仍在工作，但是当我打开源代码时，它看起来已经损坏并且无法进行额外的编辑。（你可能还没有经历过，但如果 XIB 文件变得复杂，这一定会发生）
*   它是基于图像的序列化。这个概念很好。但问题只是基于图像*的*。IB 不会通过重放源代码来保留源代码以进行干净启动。干净启动对于保证特定的运行状态非常重要。此外，我们无法修复源代码中的错误。Bug 只会被无限堆叠。这是我们无法在 IB 中重现**相同**（外观不相似）的 UI 状态的核心原因。

当然这些东西可以通过后期处理NIB UI来解决，但是如果我们必须重新配置所有东西*，*一开始没有理由使用IB。

使用文本代码，很容易复制相同的状态 - 只需复制代码。也很容易检查和修复错误的部分 - 因为我们有完全的控制权。但在 IB 中，我们无法控制核心细节。

IB不可能是最终的解决方案。它就像 Photoshop，但即使 Photoshop 也提供基于文本的脚本工具。GUI 是一个移动程序，而不是静态图像或图形。即使对于 GUI 的可视化编辑，IB 方法也是完全错误的。如果您是阅读本文的 Apple 人之一，我请求您尽快完全消除对 IB 的依赖。

# database - 保护平面文件（sqlite db）免受 HTTP 访问的最受支持的方法？

> ID：717444
> 
> 赞同：2
> 
> 时间：2009-04-04T17:23:25.397
> 
> 标签：database, http, sqlite, flat-file

我正在开发一个使用 SQLite 作为数据库管理系统的 PHP 应用程序，MySQL 和 PostgreSQL 等不是替代品（尽管我真的很想使用 pgsql），因为我希望设置对初学者非常友好且零头痛. 现在很多人使用共享主机，其中很多人只提供对 htdocs 目录的直接 FTP 访问，但不高于此。这意味着客户必须将 SQLite-Database-File 放在他们的 htdocs 中，这意味着全世界都可以访问它并且任何人都可以下载它。

为客户提供某种保护的最佳方式是什么，既简单又在所有 HTTP 服务器上都支持？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T17:33:45.293

您可以使用 .htaccess 文件并锁定数据库名称，使其无法从外部访问。许多服务器已经对所有以“.”开头的文件名执行此操作。这当然适用于 Apache，但您仍然需要对其他 Web 服务器进行修复。

您最好的选择是真正设置它，以便它可以托管在 htdocs 之上。也许您可以使用安装脚本来检查文档根目录并将 sqlite 文件移动到更高的目录（如果可能）。

不幸的是，由于 sqlite 是由与 Web 服务器相同的用户读取和写入的，因此没有简单的方法可以将其锁定以防止外部访问。隐藏和移动它是我能想到的唯一真正的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T17:55:52.477

默认情况下（对于我遇到的 Linux 安装），Apache 实际上会阻止任何以`.ht`直接服务开头的内容：

```
<Files ~ "^\.ht">
    Order allow,deny
    Deny from all
</Files> 
```

如果您希望使用类似`sqlite.db`数据库文件的文件名，则可以使用以下规则阻止它：

```
<Files ~ "\.db$">
    Order allow,deny
    Deny from all
</Files> 
```

当然，要在大多数托管服务提供商上实施此规则，您必须分发`.htaccess`包含该规则的文件。有时可能会错过这些内容，因为默认情况下它们不会出现在 *NIIX 目录列表（或 FTP 客户端）中。

我不知道有任何类似类型的规则可用于共享托管环境中的 Microsoft IIS 服务器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T18:18:40.833

没有任何保护措施适用于所有正在使用的 HTTP 服务器软件。您可以做的最好的事情是将它移到文档根目录之外，因为无论正在使用哪个 Web 服务器，都不应该提供它。

实际上，要保护文件免于在文档根目录中提供服务，需要有关服务器软件和更改其配置的知识。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T17:41:51.340

如果它是 Apache Web 服务器，则使用 .htaccess 文件。我不确定如何在 IIS 上执行此操作。

我想首先你应该放空 index.html 文件或等效文件以防止在浏览器中列出目录。如果名称和路径已知，这不会阻止访问该文件，但如果您不确定它将在哪个 Web 服务器上，总比没有好。

# .net - 我如何（美国人）测试我的 ASP.NET/SQL Server 应用程序是否正确处理德国的小数

> ID：717447
> 
> 赞同：6
> 
> 时间：2009-04-04T17:24:40.697
> 
> 标签：.net, asp.net, internationalization, cultureinfo

在美国，您使用“。” 作为分隔符，但在德国您使用“，”。我正在尝试测试我的逻辑是否足够聪明，可以处理其中任何一个，但我似乎无法将我的 Windows 2000 机器置于德语模式。

我去了控制面板，区域选项，并将“您的语言环境”更改为“德国”。然后我重新启动了 IIS 和 SQL Server。但是我的更改似乎没有生效。

这些行仍然显示“。” 成为分隔符。

System.Globalization.CultureInfo ci = new System.Globalization.CultureInfo(System.Threading.Thread.CurrentThread.CurrentCulture.Name);

Response.Write(ci.NumberFormat.NumberDecimalSeparator);

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T17:46:23.950

最好的测试方法是在 web.config 中添加一个全球化元素，例如：

```
<system.web>
   <globalization culture="de-DE" uiCulture="en-US" />
</system.web> 
```

将文化更改为 de-DE 将影响日期和数字格式：您也可以根据需要更改 uiCulture，将 uiCulture 保留为 en-US 意味着您将收到美国英语的异常消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T17:31:08.513

当您设置区域设置时，您是否确保“将所有设置应用于当前用户帐户和默认用户配置文件”（高级选项卡）？

在大多数情况下应该这样做。我还假设您的文化未`globalization`在`Web.config`.

您似乎不想通过在代码中手动设置文化设置来做到这一点，而是希望它们由系统设置继承。IMO 是一种很好的检查方式，因为您的更改也应该传播到 SQL 服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T17:47:15.463

让网站处理格式问题（如小数分隔符）依赖于 Web 服务器的语言环境通常是错误的。这增加了一个服务器配置问题，这可能使您的应用程序更难部署，而实际上并不一定要为最终用户提供他们想要的东西。例如，您可能希望将同一应用程序的法语和英语部署安装到单个（加拿大！）服务器。

由于遗留问题（例如，仅在日语中运行的应用程序，或在世界各地运行 en-US 作为“Windows 的规范版本”的生产服务器），将系统区域设置设置为不合适的内容也很常见。

通常最好在应用程序层处理这个问题，每个站点代码部署一个区域设置选项，或者（如果需要）站点的每个用户一个区域设置选项。然后任何人都可以登录到应用程序并获得适当的数字格式。

最后，如果您的应用程序界面完全是英文，那么坚持使用英文数字格式可能更合适。德国人会习惯这一点的；将英语和德语 UI 约定混合在一起实际上可能会*更令人困惑。*IMO：彻底本地化，或者根本不本地化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T17:29:25.100

我认为您所追求的是“格式”选项卡（那里的第一个）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T17:30:37.280

您可以将当前的文化设置为德语。

我认为这比切换区域设置更容易

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T17:33:32.517

如果你真的想打这个......虚拟机是你的朋友。但是您确实需要订阅 msdn 才能获得德语版的操作系统。

将操作系统（WinXP 或 Vista）加载到虚拟机中，然后浏览到网站。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T17:34:09.050

我不认为 IIS 使用区域设置。您需要在代码中明确设置 CultureInfo。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-04T17:41:27.223

如果您只是测试一次，则可以将行更改为：

```
System.Globalization.CultureInfo ci = new System.Globalization.CultureInfo("de-DE"); 
```

然后再改回来。如果你想做一堆单元测试，你可以使用这样的字符串。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-04T17:58:56.387

我可以澄清一下吗，您想让您的机器进入德语模式以测试您的 Web 应用程序，而该应用程序恰好与浏览器在同一台机器上运行？

当它真正运行时，我们可以假设服务器可以托管在德国以外的地方（或者可能在德国，但在设置为美国语言环境的机器上 - 这种情况经常发生）。如果是这样，在服务器上设置文化并不是您真正想要的，而且您在部署时可能无法做到这一点。

您还有另一个问题，没有万无一失的方法可以检测您的用户想要使用哪种文化。您可以从 HTTP 标头中检测各种信息，对 IP 地址进行域查找，但是如果说德语的人想从美国使用您的网站，或者美国人在德国并且想查看“.”，该怎么办？而不是“，”作为小数分隔符？

换句话说，我的意思是你的客户的电脑使用什么文化并不重要——这无关紧要，因为一旦你浏览了网络，所有的赌注都没有了——即使你的应用程序确实正确地检测到了你的文化，它也可能不会成为您的用户想要的！

因此，我这样做的方式是询问用户他们想要什么语言，然后在运行时在应用程序中明确设置语言环境。这确实意味着要求用户选择一种语言，但这是确保为用户使用正确语言环境的唯一方法。如果您的所有用户都是德国人，那么您不必问，您只需硬编码即可。如果他的方法听起来可行，那么这里有一些很好的示例代码：http: [//msdn.microsoft.com/en-us/library/bz9tc508.aspx](http://msdn.microsoft.com/en-us/library/bz9tc508.aspx)。

祝你好运，或者更确切地说是 Viel Glück！

# iphone - Xcode 中的多个目标：“无法启动模拟应用程序：未知错误。”

> ID：717453
> 
> 赞同：1
> 
> 时间：2009-04-04T17:28:09.410
> 
> 标签：iphone, objective-c, xcode, ios-simulator

我正在尝试在 Xcode 中为多个目标构建，以简化创建我的应用程序的“精简版”和“专业版”版本的过程。从理论上讲，这很棒，我可以将定义传递给`GCC_PREPROCESSOR_DEFINITIONS`我的代码中使用。但是，由于尝试在模拟器中启动第二个目标时出错，我实际上无法使其正常工作：`Failed to launch simulated application: Unknown error.`

这是我用来创建附加目标的简单过程：

1.  将#ifdef MYAPP_PRO 添加到源文件以根据应用程序的 pro/lite 版本修改行为（并验证应用程序是否按预期工作）
2.  从菜单中选择`Project`> `New Target...`，然后选择“Cocoa Touch Application”（名为 MyAppPro）
3.  编辑新的目标设置；添加`GCC_PREPROCESSOR_DEFINITIONS`用户定义的设置并将值设置为“MYAPP_PRO”（无引号）
4.  将活动目标设置为“MyAppPro”；构建并运行。
5.  `Failed to launch simulated application: Unknown error.`
6.  将 Info.plist 中的所有设置复制到 MyAppPro-Info.plist 并重试
7.  `Failed to launch simulated application: Unknown error.`

构建完成得很好，但我无法在模拟器中运行。

编辑 .xcodeproj 目录中的 project.pbxproj，我注意到两个目标定义的构建设置之间存在一些关键差异。我尝试手动编辑该文件，但一定是做错了什么，因为之后我无法将它加载到 Xcode 中。

原始目标的“调试”构建设置：

```
 buildSettings = {
            ALWAYS_SEARCH_USER_PATHS = YES;
            ARCHS = "$(ARCHS_STANDARD_32_BIT)";
            "CODE_SIGN_IDENTITY[sdk=iphoneos*]" = "iPhone Developer";
            GCC_C_LANGUAGE_STANDARD = c99;
            GCC_WARN_ABOUT_RETURN_TYPE = YES;
            GCC_WARN_UNUSED_VARIABLE = YES;
            ONLY_ACTIVE_ARCH = YES;
            PREBINDING = NO;
            SDKROOT = iphoneos2.2.1;
        }; 
```

Thew 新的 MyAppPro 目标的“调试”构建设置：

```
 buildSettings = {
            ALWAYS_SEARCH_USER_PATHS = NO;
            CODE_SIGN_IDENTITY = "iPhone Developer";
            COPY_PHASE_STRIP = NO;
            GCC_DYNAMIC_NO_PIC = NO;
            GCC_OPTIMIZATION_LEVEL = 0;
            GCC_PRECOMPILE_PREFIX_HEADER = YES;
            GCC_PREFIX_HEADER = "$(SYSTEM_LIBRARY_DIR)/Frameworks/UIKit.framework/Headers/UIKit.h";
            INFOPLIST_FILE = "MyAppPro-Info.plist";
            INSTALL_PATH = "$(HOME)/Applications";
            OTHER_LDFLAGS = (
                "-framework",
                Foundation,
                "-framework",
                UIKit,
            );
            PREBINDING = NO;
            PRODUCT_NAME = MyAppPro;
            SDKROOT = iphoneos2.2.1;
        }; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T01:07:46.043

你没有说你是否真的向目标添加了源文件。新目标（与新项目不同）没有源文件模板；你必须自己添加它们。所以模拟器可能会告诉你“你构建成功了，但是没有什么可以运行”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-21T12:51:53.583

复制目标。我刚刚犯了同样的错误，并意识到我做了什么：“新目标”创建的是一张白纸（尽管这不是很明显），即使你尝试包含一些你可能会错过的东西。

# c# - 使用 Invoke 从 C# 中的不同线程访问类成员

> ID：717454
> 
> 赞同：2
> 
> 时间：2009-04-04T17:28:41.857
> 
> 标签：c#, winforms, multithreading, invoke

**注意**：系列的一部分：[C#：从另一个类访问表单成员](https://stackoverflow.com/questions/717264/c-accessing-form-members-from-another-class)以及[如何在 C# 中从另一个 cs 文件访问表单对象](https://stackoverflow.com/questions/717074/how-to-access-form-objects-from-another-cs-file-in-c)。

* * *

你好，

这个想法是在 TCP 客户端接收/发送数据包时使用备忘录通知用户。

经过几次修复，最合适的解决方案似乎是这个

```
 public string TextValue
    {
        set
        {
            this.Memo.Text += value + "\n";
        }
    } 
```

就是这样称呼的

```
 var form = Form.ActiveForm as Form1;
    if(form != null)
        form.TextValue = "Test asdasd"; 
```

但是，由于不安全的线程调用，调用代码会引发异常。我在[msdn](http://msdn.microsoft.com/en-us/library/ms171728.aspx)找到了解决方案，但我似乎无法获得他们在那里使用的方法。

这是我的翻拍，没用。

```
 private void SetTextMemo(string txt)
    {
        if(this.Memo.InvokeRequired)
        {
            this.Invoke(SetTextMemo,txt); //error here
        }
        else
        {
            this.Memo.Text += txt + "\n";
        }
    } 
```

错误：

参数“1”：无法从“方法组”转换为“System.Delegate”

参数“2”：无法从“字符串”转换为“对象 []”

基本上，我正在尝试使用 Invoke 从另一个线程访问备忘录（或者更有可能是在备忘录中添加文本）。我以前从未使用过它，也许这就是我误解我的错误的原因。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-04T17:30:43.553

简单的方法是：

```
this.Invoke((MethodInvoker)delegate {
    this.Memo.Text += txt + "\n";
}); 
```

它使用匿名方法在线完成工作。由于您*希望*在另一个线程上，您不妨只调用 Invoke - 即使从 UI 线程也是安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T17:32:10.927

如果您使用的是 C# 3.0 和 3.5 框架，请尝试以下操作

```
if ( this.Memo.InvokeRequired ) {
  this.Invoke((Action)(() => SetTextMemo(txt)));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T17:41:50.873

您的实现假定该方法不会无限递归，因为 InvokeRequired 属性的行为会阻止它。这个假设可能被证明是正确的，但是对函数进行编码以完全避免这种可能性是没有问题的。这是我的建议：

```
 private void SetMemo(string txt)
    {
        Memo.Text = txt;
    }

    private delegate void MemoSetter(string txt);

    public void ThreadSafeSet(string txt)
    {
        Invoke(new MemoSetter(SetMemo), txt);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T17:32:57.477

我曾经处理所有这些跨线程业务，但最近我使用 AOP，您只需装饰一个在 UI 线程上执行的方法。这是一个示例（来自 PostSharp）：

```
public class FormsThreadAttribute : OnMethodInvocationAspect
{
  public override void OnInvocation(MethodInvocationEventArgs eventArgs)
  {
    Form f = (Form)eventArgs.Delegate.Target;
    if (f.InvokeRequired)
      f.Invoke(eventArgs.Delegate, eventArgs.GetArgumentArray());
    else
      eventArgs.Proceed();
  }
} 
```

# iphone - Apple 如何知道您正在 MacOS 上开发 iPhone 应用程序？

> ID：717466
> 
> 赞同：0
> 
> 时间：2009-04-04T17:33:27.523
> 
> 标签：iphone

我知道他们的 EULA 中有要求，但我听说有人将他们在 Windows 上开发的应用程序放到应用程序商店中。

苹果怎么能发现，或者他们甚至知道？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T16:51:15.933

他们没有，因此，如果您在 Windows 上安装并运行本机编译器和工具集，您将获得更多功能。

但要意识到：

1.  您将无法使用编译为字节码的语言（即 Java、C# 和 .Net 语言、Perl/Python/Ruby 等）。Apple 很可能不允许通过 App Store 提供任何类型的解释器。

2.  您的工具可能不包含等效的 Interface Builder 或等效的 iPhone Simulator。您将编写大量代码并花费更多时间进行测试。

3.  您将没有本地文档。您要么必须使用 Apple 的网站，要么依赖第三方文档，这些文档可能会混合 App Store 允许和禁止的方法，但没有说明哪些是哪些。

4.  你不会有 Xcode 的编辑器，它对 Objective-C 来说是高度专业化的。您将不得不输入更多内容。

5.  由于您使用的工具与其他人不同，因此您将无法轻松获得帮助。

6.  您永远不会知道错误何时出现在您的代码、工具或平台中。使用官方 SDK 的人可以像平台一样轻松地在工具上提交错误报告。

7.  您的技术支持事件毫无价值，因为您违反了合同。

8.  如果 Apple*真的*发现了，你很可能会被踢出 App Store，你的所有工作都将一无所获。除非你是个白痴，否则这个想法会让你担心。

如果您是业余爱好者，这些可能是可以接受的，以避免为二手 Mac mini 支付 400 美元，但如果您不是业余爱好者......这不是经营企业的方式。拿起一台二手 Mac，想想你在设置期间*没有*花在工厂、商店、办公室、库存或员工身上的所有钱。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T17:40:01.877

没有适用于 Windows 的 sdk。XCode 仅适用于 Mac OS X，如果不在 Mac OS X 上，将如何编译、测试和运行该应用程序？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T03:34:28.517

我不认为他们知道。PPC 架构没有官方的 SDK，但是一些简单的安装程序破解为我的 Powerbook 生成了一个工作二进制文件。同样，如果您让您的代码在 Windows 上运行，您将获得更多的权力......

# gridview - SqlDataSource 标记由于某种原因没有选择我的选择参数

> ID：717471
> 
> 赞同：1
> 
> 时间：2009-04-04T17:35:12.963
> 
> 标签：gridview, sqldatasource

这是我在 .aspx 页面中的标记，sqldatasource 正在为我的 gridview 提供数据：

```
 <asp:SqlDataSource ID="sds" runat="server" ConnectionString="server=blah;database=MyPortal;Integrated Security=FALSE;user=sa;pwd=123;"
        SelectCommand="GetUsers" >
        <SelectParameters>
            <asp:QueryStringParameter Name="PageIndex" QueryStringField="PageIndex" DefaultValue="0" />
            <asp:Parameter Name="numberOfRows" DefaultValue="10" Type="Int32" />
        </SelectParameters>
    </asp:SqlDataSource> 
```

过程或函数“GetUsers”需要未提供的参数“@pageIndex”。

为什么它不选择 PageIndex 的 Parameter 标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T17:43:31.430

您没有为 pageIndex 参数提供类型。此外，虽然 sql server 通常不关心参数名称中的大小写，但我还建议如果您在存储过程中使用 @pageIndex，则应将 pageIndex 用于数据源参数，而不是 PageIndex。

# php - symfony 沙箱使用问题

> ID：717480
> 
> 赞同：1
> 
> 时间：2009-04-04T17:40:21.050
> 
> 标签：php, symfony1

我是 symfony 的新手，我试图在命令行上运行一个简单的命令，但我收到一条错误消息。

当我尝试执行命令时：

```
d:\new_xam\xampp\htdocs\sf_sandbox_1_2\sf_sandbox>symfony propel:build-model " 
```

我得到错误：

> 'php.exe' 不是内部或外部命令、可运行程序或批处理文件。

有谁能够帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T02:46:10.907

您应该能够在所有内容前加上“php”。

所以代替`symfony propel:build-model`你可以做`php symfony propel:build-model`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-26T02:31:28.980

Can you try to use the real path for PHP?

i.e.,

```
"C:\Program Files\PHP\PHP.exe" symfony propel:build-model 
```

At your Symfony directory.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T17:57:54.500

对于刚接触 Symfony 和/或 PHP 的人来说，这是 Windows 系统上相当普遍的问题。这似乎是PHP路径的问题。见这里： http: [//forum.symfony-project.org/index.php/m/44895/?srch=php.exe+command#msg_44895](http://forum.symfony-project.org/index.php/m/44895/?srch=php.exe+command#msg_4489)

# c - 使用 TinyCC 编译时使用 Intel ASM 语法

> ID：717487
> 
> 赞同：2
> 
> 时间：2009-04-04T17:42:22.480
> 
> 标签：c, assembly, tcc

使用 Tiny C Compiler 编译项目时，是否可以在内联汇编块中使用 Intel 汇编语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T18:27:32.213

不，这不对。

TCC 仅支持 AT&T 语法

# c# - 重新抛出无参数捕获和不做任何事情之间的区别？

> ID：717489
> 
> 赞同：15
> 
> 时间：2009-04-04T17:42:47.143
> 
> 标签：c#, exception, try-catch

假设我在两个不同的程序集中有以下两个类：

```
//in assembly A
public class TypeA {
   // Constructor omitted
   public void MethodA
   {
     try {
       //do something
     }
     catch {
        throw;
     }
   }
}
//in assembly B
public class TypeB {
   public void MethodB
   {
     try {
       TypeA a = new TypeA();
       a.MethodA();
     }
     catch (Exception e)
       //Handle exception
     }
   }
} 
```

在这种情况下，MethodA 中的 try-catch 只是提升了异常，但并没有真正处理它。在 MethodA 中使用 try-catch 有什么好处吗？换句话说，这种 try-catch 块和根本不使用它有区别吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T18:14:40.157

在您的示例中，这没有任何优势。但是在某些情况下，只需要冒泡一个特定的例外。

```
 public void Foo()
    {
        try
        {
            // Some service adapter code

            // A call to the service
        }
        catch (ServiceBoundaryException)
        {
            throw;
        }
        catch (Exception ex)
        {
            throw new AdapterBoundaryException("some message", ex);
        }
    } 
```

这使您可以轻松识别发生异常的边界。在这种情况下，您需要确保仅针对特定于边界的代码引发边界异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T17:46:00.847

使用您为 MethodA 编写的代码，没有区别。它所要做的就是消耗处理器周期。但是，如果有必须释放的资源，以这种方式编写代码可能会有优势。例如

```
Resource r = GetSomeResource();
try {
  // Do Something
} catch { 
  FreeSomeResource();
  throw;
}
FreeSomeResource(); 
```

然而，这样做并没有真正的意义。最好只使用 finally 块 **。**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T17:51:53.813

是，有一点不同。当您捕获异常时，.NET 假定您将以某种方式处理它，堆栈将展开到执行捕获的函数。

如果您没有捕捉到它，它将最终成为一个未处理的异常，这将调用某种诊断（如调试器或异常记录器），完整的堆栈及其在实际故障点的状态将可供检查。

因此，如果您捕获然后重新抛出未在其他地方处理的异常，您就会抢夺诊断工具关于实际发生的事情的真正有用信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T17:48:55.850

只是重新抛出是没有意义的——就像你什么都没做一样。

然而，当你实际做某事时它会变得很有用——最常见的事情是记录异常。您还可以更改班级的状态，无论如何。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T18:15:00.387

照原样考虑，第一个选项似乎是个坏主意（或者那应该是“无用的”？）。但是，很少这样做。通常在两种情况下从 Catch 块中重新抛出异常：

一种。您想检查为数据生成的异常并有条件地将其冒泡到堆栈中。

```
try 
{
  //do something
}
catch (Exception ex)
{
  //Check ex for certain conditions.
  if (ex.Message = "Something bad")
    throw ex;
  else
    //Handle the exception here itself.
} 
```

湾。组件内发生了不可接受的情况，需要将此信息传达给调用代码（通常通过附加一些其他有用的信息或将其完全包装在另一种异常类型中）。

```
try 
{
  //do something
}
catch (StackOverflowException ex)
{
    //Bubble up the exception to calling code 
    //by wrapping it up in a custom exception.
    throw new MyEuphemisticException(ex, "Something not-so-good just happened!");
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T17:55:51.090

永远不要做选项 A。正如 Anton 所说，它会占用堆栈跟踪。JaredPar 的示例也占用了堆栈跟踪。更好的解决方案是：

```
SomeType* pValue = GetValue();
try {
  // Do Something
} finally {
  delete pValue;
} 
```

如果您在 C# 中有需要发布的内容，例如 FileStream，您有以下两个选择：

```
FileStream stream;
try
{
  stream = new FileStream("C:\\afile.txt");
  // do something with the stream
}
finally
{
  // Will always close the stream, even if there are an exception
  stream.Close(); 
} 
```

或者更干净：

```
using (FileStream stream = new FileStream("c:\\afile.txt"))
{
  // do something with the stream
} 
```

Using 语句将在完成或关闭异常时处理（并关闭）流。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-04T17:58:36.090

当你接球和扔球时，它允许你`throw`在线上设置一个断点。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-04T17:58:56.793

重新抛出异常可用于将其封装为通用异常，例如...考虑以下示例。

```
public class XmlException: Exception{
   ....
} 

public class XmlParser{
   public void Parse()
   {
      try{
          ....
      }
      catch(IOException ex)
      {
         throw new XmlException("IO Error while Parsing", ex );
      }
   }
} 
```

这比对异常进行分类更有好处。这就是 aspx 文件处理程序和许多其他系统代码执行异常封装的方式，这决定了它们进入堆栈的方式及其逻辑流。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-04T19:47:16.283

程序集 A - try catch - 块对我来说没有任何意义。我相信，如果您不打算处理异常，那么为什么要捕获这些异常..无论如何它都会被抛到一个新的水平。

但是，如果您正在创建中间层 API 或类似的东西并在该层中处理异常（并因此吃掉异常）没有意义，那么您可以抛出自己的层 ApplicationException。但肯定重新抛出相同的异常是没有意义的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-04T21:58:19.570

由于这些类位于 2 个不同的程序集中，您可能希望简单地捕获异常以记录它，然后将其扔回给调用者，以便它可以以它认为合适的方式处理它。throw 而不是 throw ex 将保留有关异常起源的上下文信息。当您的程序集是一个 API / 框架时，这可能很有用，在其中您不应该吞下异常，除非这样做有意义，但如果它被记录到 EventLog 中，则仍然有助于故障排除。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-02-05T09:10:45.270

仅当您可以捕获可以在 MethodA() 中处理的特定异常（例如： logging ）时，您才能在方法 A 中使用 try{} catch(ex){} 块。

另一种选择是使用 InnerException 属性链接异常并将其传递给调用者。这个想法不会杀死堆栈跟踪。

# ruby - 如果 Ruby 的所有实现都被编译成字节码，那么它真的是一种解释型语言吗？

> ID：717490
> 
> 赞同：16
> 
> 时间：2009-04-04T17:43:18.577
> 
> 标签：ruby, interpreter, interpreted-language, compiled-language

在为[这个关于 Blue Ruby](https://stackoverflow.com/questions/716543/what-is-the-significance-for-ruby-programmers-of-saps-new-implementation-of-ruby)的问题选择的答案中，Chuck 说：

> 当前所有的 Ruby 实现都被编译为字节码。与 SAP 的说法相反，从 Ruby 1.9 开始，MRI 本身包括一个字节码编译器，尽管在合并 YARV 虚拟机的过程中，将编译后的字节码保存到磁盘的能力消失了。JRuby 被编译成 Java .class 文件。我没有太多关于 MagLev 的细节，但可以肯定地说它也会走这条路。

我对这个关于 Ruby 的编译/解释问题感到困惑。

我了解到 Ruby 是一种解释型语言，这就是为什么当我将更改保存到我的 Ruby 文件时，我不需要重新构建项目。

但是，如果现在所有的 Ruby 实现都被编译了，那么说 Ruby 是一种解释型语言还公平吗？还是我误解了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-04T17:54:21.453

如果您将字节码视为已编译，那么如今几乎每种语言都已“编译”。甚至 Emacs Lisp 也是编译好的。Ruby 是一个特例，因为直到最近，它还*没有被*编译成字节码。

我认为您对将语言表征为“编译”与“解释”的效用提出质疑是正确的。不过，一个有用的区别是该语言是否直接从用户代码创建机器代码（例如 x86 汇编程序）。C、C++、许多 Lisps 和启用 JIT 的 Java 可以，但 Ruby、Python 和 Perl 不可以。

不太了解的人会将任何具有单独手动编译步骤的语言称为“已编译”，而没有“解释”的语言。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-04T17:51:34.593

是的，Ruby 仍然是一种解释性语言，或者更准确地说，人们在谈论 Ruby 时通常会谈论的 Matz 的 Ruby Interpreter (MRI) 仍然是一种解释器。编译步骤只是为了将代码减少到比一次又一次地解释和重新解释相同的代码执行得更快的东西。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-06-02T05:58:45.997

确实是一个微妙的问题......曾经是“解释”语言被解析并转换为执行速度更快的中间形式，但执行它们的“机器”是一个非常特定于语言的程序。“编译”语言被翻译成运行它的计算机支持的机器代码指令。早期的区别是非常基本的——静态与动态范围。在静态类型语言中，变量引用几乎可以在几条机器指令中解析为内存地址——您确切地知道变量在调用帧中引用的位置。在动态类型语言中，您必须搜索（在 A 列表或调用框架上）以获取参考。随着面向对象编程的出现，

实际上，可以追溯到 70 年代后期，编译语言和解释*语言*之间的区别并不大，而是它们是在编译环境中运行还是在解释环境中运行。例如，Pascal（我学习的第一个高级语言）在加州大学伯克利分校首先在 Bill Joy 的**pxp**解释器上运行，后来在他编写的编译器**pcc**上运行。相同的语言，在编译和解释环境中都可用。

有些语言比其他语言更具动态性，某物的含义——类型、方法、变量——取决于运行时环境。这意味着编译或不编译存在与执行程序相关的大量运行时机制。第四，Smalltalk、News、Lisp，都是这样的例子。最初，这些语言需要如此多的机制来执行（相对于 C 或 Fortran），它们是一种自然的解释。

甚至在 Java 之前，就有人尝试通过技巧、成为线程编译的技术、即时编译等来加速复杂、动态语言的执行。

不过，我认为是 Java，它是第一个真正混淆了编译器/解释器差距的广泛传播的语言，具有讽刺意味的是，它并不是为了让它运行得更快（尽管如此），而是让它可以在任何地方运行。通过定义自己的机器语言和“机器”java字节码和VM，Java试图成为一种编译成接近任何基本机器的语言，但实际上不是任何真正的机器。

现代语言结合了所有这些创新。有些具有传统“解释语言（ruby、lisp、smalltalk、python、perl(!)）的动态、开放式、你不知道你得到什么直到运行时的性质，有些则试图具有严格的规范，允许对传统编译语言（java，scala）进行基于深度类型的静态错误检测。所有编译为实际的机器独立表示（JVM）以获得一次写入任何地方的语义。

那么，编译与解释？最好的，我会说。所有代码都在源代码中（带有文档），更改任何内容并且效果立竿见影，简单操作的运行速度几乎与硬件一样快，复杂的操作得到支持且速度足够快，硬件和内存模型在平台之间保持一致。

今天语言中更大的争论可能是它们是静态类型还是动态类型，也就是说不是它们运行的​​速度有多快，而是编译器会事先发现错误（代价是程序员必须指定相当复杂的类型信息）或错误会出现在测试和生产中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-04T17:51:01.570

您可以使用交互式 Ruby Shell [irb](http://en.wikipedia.org/wiki/Interactive_Ruby_Shell)交互式地运行 Ruby程序。虽然它可能会生成中间字节码，但它肯定不是传统意义上的“编译器”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-04T17:52:57.977

编译语言通常被编译成机器码，而不仅仅是字节码。不过，一些字节码生成器实际上可以进一步将字节码编译成机器码。

字节码本身只是用户编写的文字代码和虚拟机之间的中间步骤，但它仍然需要由虚拟机解释（就像它在 JVM 中使用 Java 和带有操作码缓存的 PHP 一样）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T19:32:39.080

这可能有点跑题了，但是...

[Iron Ruby](http://www.ironruby.net/)是基于 .net 的 ruby​​ 实现，因此通常编译为字节码，然后在运行时 JIT 编译为机器语言（即不解释）。此外（至少对于其他 .net 语言，所以我假设使用 ruby​​）[ngen](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx)可用于提前生成已编译的本机二进制文件，因此这实际上是 ruby​​ 代码的机器代码编译版本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-27T02:09:23.227

至于我从上海 RubyConf 2011 得到的信息，Matz 正在开发一个“MRuby”（代表 Matz's Ruby），以在嵌入式设备上运行。Matz 表示，MRuby 将提供将 ruby​​ 代码编译为机器代码的能力，以提高速度并减少嵌入式设备上（有限）资源的使用。所以，有各种各样的 Ruby 实现，绝对不是所有的都只是在运行时解释。

# c# - 在 C# 中命名私有和静态私有方法的最佳实践是什么？

> ID：717504
> 
> 赞同：10
> 
> 时间：2009-04-04T17:53:47.320
> 
> 标签：c#, naming-conventions, private-methods

我试图弄清楚在 C# 中命名私有方法和私有静态方法的最聪明的方法是什么。

背景：我知道私人成员的最佳实践是下划线前缀+驼峰式。你可以和我争论，但相信我，我已经看到了足够多的遵循这个约定的核心专业人士的代码，这是熟练的行业标准。

我也知道帕斯卡案例是公共方法的行业标准。但是我已经看到了测试风格命名（即 method_must_return_false_occasionalally ）与 pascal case、camelcase 和下划线前缀 + camelcase 的组合，用于私有和私有静态方法。

但是 C# 中私有和私有静态方法命名的最佳实践风格是什么？

如果某些样式是从某些私有方法而不是其他方法中使用的，我可以理解，只需解释一下。

谢谢阅读。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-04T17:57:07.653

查看 Microsoft 的[命名指南](http://msdn.microsoft.com/en-us/library/xzf533w0%28VS.71%29.aspx)和 Brad Abram 的[风格指南](http://blogs.msdn.com/brada/articles/361363.aspx)

他们说所有方法都应该是 PascalCase

```
public void DoWork() {}
private void StillDoWork() {}
private static void ContinueToDoWork() {} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-04T18:00:22.373

.NET 类库开发的[命名准则不区分公共和私有用法，并建议静态方法使用](http://msdn.microsoft.com/en-us/library/xzf533w0(VS.71).aspx)[Pascal](http://msdn.microsoft.com/en-us/library/x2dbyw72(VS.71).aspx)大小写。

**编辑**：我个人的做法是对方法和属性使用 Pascal 大小写，对字段、参数和局部变量使用骆驼大小写。当从类中引用实例成员时，我`this.`在必要时用来区分类成员和参数。我不知道我是否有资格成为“铁杆专业人士”，但我确实得到了报酬。:-)

**编辑2**：自从最初写这篇文章以来，我已经换了工作。我们遵循的编码标准与我个人的感受不同，我们确实在私有字段前加上下划线。我也开始使用 ReSharper，我们的标准（通常）遵循默认规则。我发现我可以轻松地使用下划线。我只`this`在绝对需要时使用，因为它不符合我们的代码标准。一致性胜过个人偏好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T17:59:10.737

我不了解行业标准，但即使是私有方法也使用 Pascal 大小写，我对静态方法没有区别。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T18:44:16.417

The `weird_underscore_naming` convention is *typically* restricted to tests because it makes them more readable, and is something that is heavily encouraged by BDD. Remember that, whereas a method describes in a short way what it does (`DepositMoney`), tests need to describe what it is they are doing, i.e., `Negative_deposits_must_be_caught`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-04T18:19:33.810

一种选择是使用强制您保持一致的工具，例如[style cop](http://code.msdn.microsoft.com/sourceanalysis)（如果您使用[reSharper ，](http://www.jetbrains.com/resharper/index.html) [codeplex](http://www.codeplex.com/StyleCopForReSharper)上有一个 style cop 插件）。大多数工具似乎都强制执行（？建议）Microsoft 指南，因为这些工具可以让您通过一些测试来获得 MS 平台对您的代码的批准。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T18:30:20.087

我工作过的每个地方的做法总是不同的。

我发现作为一名专业开发人员，专业的一部分是为了适应新团队，这些团队可能有不同的编码约定。

能够改变你的风格并应对在最初几周内造成的认知失调，是职业的一部分。

我将开始研究各种开源和类似项目，您会看到各种各样的方案。

我还看到过下划线的 camelCase 和 Pascal 案例辩论分裂了社区，有时甚至是团队——我猜这是编码方案的重点。

所以除非项目是你作为唯一的开发者，在这种情况下你是自由的——试着找出团队的其他成员喜欢使用什么，以及什么让团队更容易理解。

我要考虑的另一件事是 OO 术语中代码的复杂性，如果这是一个简单的项目或具有多种模式的复杂 OO 设计，或者您正在使用一些 IOC 然后开始在不同类型的编码标准上运行“峰值”并且然后看看当你使用它时代码的物理外观 - 对你和团队来说看起来不错，还是看起来很丑。

# python - 如果 Ruby 和 Python 都允许猴子补丁，为什么在 Ruby 中更有争议？

> ID：717506
> 
> 赞同：15
> 
> 时间：2009-04-04T17:54:50.360
> 
> 标签：python, ruby, language-features, monkeypatching

在我听到的许多关于 Ruby 的讨论中，人们表达了他们对该语言的保留意见，猴子修补问题成为他们主要关注的问题之一。

然而，我很少听到在 Python 上下文中提出的相同论点，尽管 Python 语言也允许这样做。

为什么会有这种区别？

Python 是否包含不同类型的保护措施以最大程度地降低此功能的风险？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-04T18:22:54.143

这是一种在 Python 中较少实践的技术，部分原因是 Python 中的“核心”类（那些用 C 实现的）并不是真正可修改的。另一方面，在 Ruby 中，由于它在内部实现的方式（不是更好，只是不同），几乎任何东西都可以动态修改。

从哲学上讲，它在 Python 社区中往往不受欢迎，而在 Ruby 世界中则明显不那么重要。我不知道您为什么断言它更具争议性（您可以链接到权威参考吗？）-我的经验是猴子修补是一种公认​​的技术，如果用户应该意识到可能的后果的话。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-04T18:03:18.777

语言可能允许这样做，但两个社区都不会容忍这种做法。Monkeypatching 在这两种语言中都不会被宽恕，但是你在 Ruby 中更经常听到它，因为它使用的开放类的形式使得对一个类进行猴子补丁非常非常容易，正因为如此，[它在 Ruby 社区中更容易接受，但是还是皱着眉头](http://avdi.org/devblog/2008/02/23/why-monkeypatching-is-destroying-ruby/)。Monkeypatching 在 Python 中并不那么普遍或容易，这就是为什么您不会在该社区中听到相同的反对意见的原因。Python 没有做任何 Ruby 没有做的事情来阻止这种做法。

您在 Ruby 中更频繁地听到/阅读它的原因是在 Ruby 中：

```
class MyClass
  def foo
    puts "foo"
  end
end 
```

```
class MyClass
  def bar
    puts "bar"
  end
end 
```

将为您提供一个包含两个方法的类`foo`和`bar`，而这在 Python 中：

```
class MyClass:
    def foo(self):
        print "foo" 
```

```
class MyClass:
    def bar(self):
        print "bar" 
```

会给你留下一个只包含方法`bar`的类，因为类的重新定义完全破坏了之前的定义。要在 Python 中进行monkeypatch，你实际上必须这样写：

```
class MyClass:
    def foo(self):
        print "foo" 
```

```
def bar(self):
    print "bar"
MyClass.bar = bar 
```

这比 Ruby 版本更难。仅这一点就使得 Ruby 代码比 Python 代码更容易进行猴子补丁。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-04T23:48:08.933

作为一个尝过 Ruby（并且喜欢它）的 Python 程序员，我认为这与 Python 开始流行的时候有点讽刺。

C 和 Java 程序员会“抨击”Python，声称它不是一种真正的语言，其类型的动态特性会很危险，并允许人们创建“坏”代码。随着 Python 变得越来越流行，其快速开发时间的优势变得明显，更不用说不那么冗长的语法了：

```
// Java
Person p = new Person(); 
```

```
# Python
p = Person() 
```

我们开始看到一些更动态的特性出现在更高版本的 Java 中。自动装箱和拆箱使处理原语变得不那么麻烦，而泛型允许我们编写一次代码并将其应用于多种类型。

我很高兴地看到 Ruby 的关键灵活特性之一——猴子补丁，被 Python 人群吹捧为危险。今年开始向学生教授 Ruby，我认为能够“修复”现有课程的实现，即使是系统的一部分，也是非常强大的。

当然，你可能搞砸了，你的程序可能会崩溃。我也可以很容易地在 C 中进行段错误。Java 应用程序可能会死于火焰般的死亡。

事实上，我认为 Monkey Patching 是动态和元编程的下一步。有趣，因为它自 Smalltalk 以来一直存在。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-04T18:17:20.057

“Python 是否包含不同类型的保护措施以最大限度地降低此功能的风险？”

是的。社区拒绝这样做。保障完全是社会性的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-04T22:27:42.700

实际上在 Python 中修改基本类型有点困难。

例如想象一下，您重新定义整数。

红宝石：

```
class Fixnum 
   def *(n)
      5 
   end 
end 
```

现在 2*2 产生 5。

Python：

```
>>> class int(int):
    def __mul__(self, x):
        return 5

>>> 2*2
4
>>> int(2)*int(2)
5 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-05T02:57:28.057

在 Python 中，任何文字（`""`、`{}`、`1.0`等）都会创建标准类的实例，即使您尝试对其进行猴子补丁并在命名空间中重新定义相应的类。

它只是不会按您的意图工作：

```
class str():
    # define your custom string type
    ...

a = "foo"      # still a real Python string
a = str("foo") # only this uses your custom class 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-06T11:18:34.757

我认为猴子补丁应该只作为最后的解决方案。

通常，Python 程序员知道类或方法的行为方式。他们知道 xxx 班正在以某种方式做事。

当你对一个类或一个方法进行修补时，你正在改变它的行为。如果该类的行为不同，其他使用该类的 Python 程序员可能会感到非常惊讶。

正常的做事方式是子类化。这样，其他程序员就知道他们正在使用不同的对象。他们可以选择使用原始类或子类。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-07T16:08:35.613

如果你想在 Python 中做一些猴子补丁，这相对容易，只要你不修改内置类型（int、float、str）。

```
class SomeClass:
    def foo(self):
        print "foo"

def tempfunc(self):
    print "bar"
SomeClass.bar = tempfunc
del tempfunc 
```

这会将 bar 方法添加到 SomeClass ，甚至该类的现有实例也可以使用该注入方法。

# c++ - 可以用 std::for_each 改变对象吗？

> ID：717509
> 
> 赞同：9
> 
> 时间：2009-04-04T17:56:27.360
> 
> 标签：c++, stl

for_each 接受 InputIterators ：

```
//from c++ standard
template <class InputIterator, class Function>
   Function for_each (InputIterator first, InputIterator last, Function f); 
```

是否可以更改函数 f 中的对象，如下所示：

```
struct AddOne
{
    void operator()(int & x){x = x + 1;}
};

std::vector<int> vec(10);
std::for_each(vec.begin(),vec.end(),AddOne()); 
```

此代码适用于 VC++2008 和 GCC，但它也是可移植（合法）代码吗？
（InputIterators 只保证可用作右值，在这种情况下，它们在 AddOne 的 operator() 中用作左值）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T18:03:14.487

阅读这篇[文章](http://www.ddj.com/cpp/184403769)。

To be pedantic:`for_each`是一个非修改序列操作。目的不是修改序列。但是，使用*时*可以修改输入序列`for_each`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T18:12:45.167

你误解了一些东西。说输入迭代器只保证可用作右值并不意味着您不能以某种方式从迭代器中获取左值。所以这并不意味着 的结果`*iterator`是一个右值。你/for_each 传递给`AddOne`的是`operator*`-*而不是*迭代器本身的结果。

关于`for_each`和修改功能对象 - 阅读[这个问题](https://stackoverflow.com/questions/662845/why-is-stdforeach-a-non-modifying-sequence-operation/662922)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-06T02:33:41.493

如果有疑问，请使用 std::transform ，因为它甚至会向您的代码的临时读者传达您打算修改某些内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T18:10:10.837

这是合法的 - 输入迭代器用于指定范围，而不是进行处理。

有趣的是，Josuttis 在他的《C++ 标准库》一书中将其`for_each`列为修改，而不是非修改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-08T17:44:32.220

我的建议是，如何将项目传递给函数，即通过引用或指针并更改它或作为副本并更改它，这一切都很重要。

但正如其他人所说，如果你想更改值，最好使用 transform 因为它关心返回值。

```
 class MultiplyBy {
    private:
        int factor;

    public:
        MultiplyBy(int x) : factor(x) {
        }

        int operator () (int other) const {
            other = factor + other;
            return other; 
          } 

    //  int operator () (int & other) const { 
    //         other = factor + other;
    //         return other;        
    //     }      
    };

        vector<int> x1= {1, 2, 3, 4, 5};
        vector<int> x2;   
        std::transform(x1.begin(), x1.end(), back_inserter(x2), MultiplyBy(3));
        std::for_each(x1.begin(), x1.end(), MultiplyBy(3)); 
```

# iphone - 有什么好的 iPhone 声音管理器框架吗？

> ID：717513
> 
> 赞同：5
> 
> 时间：2009-04-04T17:57:22.210
> 
> 标签：iphone

我正在开发一款 iPhone 游戏，目前正在使用 AVAudioPlayer 播放背景音乐和声音。从我一直在阅读的内容来看，我不确定这是否是最好的方法，但其他选择似乎过于复杂。

有什么好的开源框架可以在 iPhone 上运行并且我可以集成吗？我只需要根据不同的游戏事件来控制音量和触发声音。

**澄清：** AVAudioPlayer 满足我播放一种声音的需求，但我想要一个包装类，我可以在其中设置多种声音并让它们根据某个键播放。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T03:36:18.067

从您的消息中不清楚 AVAudioPlayer 是否满足您的需求。一方面你没有提到你遇到的任何缺点，但另一方面你要求替代方案表明存在一些。

如果 AVAudioPlayer 确实满足您的需求，为什么要过日子？

如果 AVAudioPlayer 不能满足您的需求，您需要先解释您还需要什么，然后其他人才能做任何事情，但只能猜测您在寻找什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T14:34:21.493

Apple 在其月球着陆器示例代码应用程序中包含的声音引擎允许一次播放多个声音以及所有内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-08T22:10:39.543

您可以使用 AVAudioPlayer。您的每个声音都将是该类的不同实例。保留字典或数组中的所有声音（播放器）。然后，您可以通过索引数组或使用字典中的键轻松播放每个。每个声音都可以有自己的音量，或者您可以迭代数组或 dict 以将所有音量设置为您喜欢的任何级别。

需要记住的几点： 1\. 如果您必须及时播放声音，请在从文件加载后立即使用 -prepareToPlay 方法。2\. 如果你停止一个声音，那么 -prepareToPlay 将被撤销。如果暂停声音，则在再次播放之前，请确保将 currentTime 属性设置为 0，以便声音从头开始。

# database - 基于表设计的类建模

> ID：717515
> 
> 赞同：2
> 
> 时间：2009-04-04T17:58:31.490
> 
> 标签：database, class, modeling

这就是通常设计课程的方式吗？一个类 = 1 个表。包含另一个表的外键的表怎么样？

假设我有以下内容：

```
PersonTable
---------------
person_id
name

PersonMapTable
---------------
map_id
type_id (fk)
person_id

PersonTypeTable
-------------------
type_id
description
parent_type_id

AddressTable
-------------------
address_id
address1
address2
city
state
zip

AddressMapTable
-----------
address_map_id
address_id
person_id 
```

好的做法是否包括为每个表创建一个类？如果是这样，在没有 orm 的情况下将此类类加载/保存回数据库的最佳实践是什么？一个简单的代码示例将非常有帮助

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-04T18:09:07.813

我建议阅读 Martin Fowler 的[企业应用程序架构模式](http://martinfowler.com/books.html#eaa)，其中有几种类和表之间的映射模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T18:05:46.370

我不认为每个表一个对象一定是一个好的设计。很难给出一刀切的规则，但对象可以更丰富、更细粒度。由于不适用于对象的原因，可以对数据库进行非规范化。在这种情况下，您将拥有比表格更多的对象。

您的案例将包括 1:1 和 1:m 关系：

```
public class Person
{
    // 1:m
    private List<your.namespace.Map> maps; 
}

public class Map
{
    // 1:1
    private your.namespace.Type;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-15T16:22:23.670

在大多数情况下，我倾向于将表映射到实体，但这不是硬性规则。有时，在某些情况下，特定实体的存储库最好处理围绕特定实体的一般问题，这意味着它会因此交叉处理其他表，而这些表不需要作为实体存在。

我**从**不做的事情（除非在非常具体的计划情况下，总是需要使用实体检索依赖数据），将实体或实体集合设置为另一个实体的属性。相反，该实体将可以通过其 ID 发现，该 ID 可以是父实体的属性，也可以通过与父实体相关的关联存储库发现。

在我需要将另一个实体的子实体或多个实体捆绑在一起的情况下，我将使用“信息”帮助器类将所有必需的数据汇集在一起​​。例如，如果我有一个实体类`Widget`并且它有一个子`Part`对象的集合，那么我将创建一个`WidgetInfo`类，该类将包含作为属性的`Widget`实例和`Part`作为另一个属性的对象集合。

这样，所有实体类都尽可能保持轻量级，并且永远不会假设需要加载依赖数据。此外，它还可以保持存储库模型的清洁，而不会强迫您进入混乱的 ORM 领域，如果您在实体类上创建子对象集合，通常会出现这种情况。如果你在*没有*ORM 的情况下这样做，那么你最终会遇到一个混乱的问题，即何时加载子节点，以及何时假设子节点已加载或尚未加载。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T18:07:13.557

我不会说我总是每张桌子都有课，尤其是当你有多对多的关系时。根据您上面的表格，我将有 2 个课程...我不确定为什么您同时拥有 id 和 person_type_id，对我来说它们是相同的，但这里是课程。

```
Person
{
   public int Id { get; set; }

   public string Name { get; set; }

   public List<PersonType> { get; set; }
}

PersonType
{
   // I would discourage from using Type as property name as it is a keyword...
   public string [Type] { get; set; }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-15T01:19:42.590

除非您的用户是数据输入员，否则通常认为从用例/用户故事设计类会更好。即使数据库已经存在。

原因？用户很容易最终假设他们的工作是使用软件，而不是期望软件帮助他们完成工作。

显然，它们需要在某个点相交。我同意福勒的书是一个很好的起点。但我认为他会加强这一观点。

如果您想要一个可以帮助您正确获取类和数据库的建模视角，请考虑对象角色建模。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-17T13:27:24.490

如果您计划使用对象关系映射 (ORM)，这可能会影响您的表设计。 [例如， Hibernate](http://www.hibernate.org)不喜欢在同一棵树中混合继承映射策略。

由于您明确指出您不会使用 ORM，因此您可以遵循传统的数据库设计原则。这通常意味着从每个类一个表开始，规范化为第三范式（[在此处阅读有关数据库规范化的信息](http://en.wikipedia.org/wiki/Database_normalization)），然后进行非规范化以满足性能限制（[在此处阅读有关非规范化的信息](http://en.wikipedia.org/wiki/Denormalization)）。

关于如何在不使用 ORM 的情况下加载和保存对象的问题，一种常见的策略是使用数据访问对象（[DAO](http://en.wikipedia.org/wiki/Data_Access_Object)）。这是一个简单的例子：

```
public interface ICustomerDao
{
  public void insert(Customer customer) throws CustomerDaoException;
  public void update(long id, Customer customer) throws CustomerDaoException;
  public void delete(long id) throws CustomerDaoException;
  public Customer[] findAll() throws CustomerDaoException;
  public Customer findByPrimaryKey(long id) throws CustomerDaoException;
  public Customer[] findByCompany(int companyId) throws CustomerDaoException;
} 
```

您没有指定您使用的是哪种语言，但无论如何您可能会发现[这个使用 Java 泛型](http://www.bejug.org/confluenceBeJUG/display/BeJUG/Generic+DAO+example)实现 DAO 的示例很有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-17T14:10:27.497

> 好的做法是否包括为每个表创建一个类？如果是这样，在没有 orm 的情况下将此类类加载/保存回数据库的最佳实践是什么？

您正在使用 ORM。您正在将对象映射到关系表。您是否使用预先构建的库来这样做是您的决定。如果你不这样做，你实际上将自己实现一个，尽管可能没有现有 ORM 的所有花里胡哨。

两种最常见的方法是 ActiveRecord 模式和 Data Mapper 模式。每个都有其优点和缺点。

使用 ActiveRecord 模式，您可以定义其属性为您定义表列的类。此类的每个实例对应于数据库中的一行，通过创建（并保存）一个新实例，您可以在数据库中创建一个新行。更多信息可在此处获得： [http ://en.wikipedia.org/wiki/Active_record_pattern](http://en.wikipedia.org/wiki/Active_record_pattern)

在 Data Mapper 模式中，您为每个表定义表对象，并编写将表的列分配给现有类的映射器函数。SQLAlchemy 默认使用这种模式（尽管有 ActiveRecord 类型扩展模块，它使 SQLAlchemy 的功能适应不同的接口。关于这种模式的简要介绍可以在 SQLAlchemy 的文档中找到：[http ://www.sqlalchemy.org/docs/ 05/ormtutorial.html](http://www.sqlalchemy.org/docs/05/ormtutorial.html)（从头开始阅读，但不包括标题为“以声明方式同时创建表、类和映射器”的部分；该部分解释了使用 SQLAlchemy 的 ActiveRecord）。

ActiveRecord 模式更易于设置和使用，并为您提供明确代表数据库的类，这在可读性方面具有优势。作为附带的好处，ActiveRecord 类的声明性质有效地充当数据库模式的清晰和直接的文档。

Data Mapper 模式在数据如何映射到类方面为您提供了更大的灵活性，因此您不必拘泥于表和类之间或多或少的一对一关系。它还将您的持久层与您的业务代码分开，这意味着您可以在以后根据需要更换其他持久性机制。这也意味着您可以更轻松地测试您的类，而无需设置数据库来支持它们。

有关 SQLAlchemy 映射器配置的更深入讨论，请查看[http://www.sqlalchemy.org/docs/05/mappers.html](http://www.sqlalchemy.org/docs/05/mappers.html)。即使您不打算使用像 SQLAlchemy 这样的库，文档也应该可以帮助您了解在将类映射到数据库表时可能需要考虑的一些选项。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-21T14:12:22.070

这种从 DataBase 到 Class 的方法很可能会引导您快速编写大量代码。然而，这段代码的很大一部分可能没有任何用处或需要一些严重的突变。换句话说，您可能会构建与您的显示和工作流程不匹配的特定类。

首先，考虑您的应用程序、用户的需求、一般工作流程.. 等等实际上想出一些看起来可行的东西（即模拟您的显示器）。

专注于您需要使用显示器的类，并根据这些需求为您的存储建模（数据库设计）。很有可能您将只有少数几个直桌课程，因为您的大多数课程自然会倾向于为您的显示器提供解决方案。

祝你好运。

# c# - 使用 C# 为 FTP 实现 MODE Z 压缩

> ID：717519
> 
> 赞同：1
> 
> 时间：2009-04-04T17:58:58.697
> 
> 标签：c#, ftp, zlib

我正在尝试使用 C# 为我编写的 FTP 客户端实现 FTP 的 MODE Z 压缩。我的理解是 MODE Z 使用与 zlib 相同的压缩。我无法从 componentace 获取 zlib.net 来工作。在上传到 FileZilla FTP 服务器后，它会破解文件的最后一部分。MODE Z 的规格在哪里？还有其他人对 zlib.net 有问题吗？.NET Framework 中的 deflate 也不兼容 MODE Z。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T18:32:58.177

我认为 FTP 压缩模式尚未成为 RFC。2005 年 9 月有一个（过期的） [互联网草案](http://www.ietf.org/proceedings/05aug/IDs/draft-preston-ftpext-deflate-03.txt)。

如果您真的卡住了，您可以尝试通过电子邮件向其中一位作者发送当前状态（请参阅第 7 节，*作者地址*）。

RFC [1950](http://www.ietf.org/rfc/rfc1950.txt)和[1951](http://www.ietf.org/rfc/rfc1951.txt)（分别是 zlib 和 deflate）对于低级调试也可能有用。我不完全理解这两个 RFC 的关系，但是上述 Internet Draft 的第 3.3.1 节指出：

> 所有支持 deflate 传输模式的 FTP 进程必须支持 RFC 1950 [5] 中指定的 ZLIB 压缩数据格式。

所以听起来你肯定在使用正确的 C# 组件。

最好确认截断发生的位置：您确定它在压缩库中吗？您可以在上传之前转储压缩数据吗？你能看到字节通过网络传输吗？您可以跟踪服务器端以查看它是否接收到整个文件（但随后将其截断）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T02:16:53.230

如果您想要一个支持 MODE Z 的廉价 FTP 库，请尝试[edtFTPnet/Express](http://www.enterprisedt.com/products/edtftpnetexpress/overview.html)。如果您想了解我们如何使用 zlib.net 实现压缩，您甚至可以购买源代码。

# facebook - Facebook API - Feed.registerTemplateBundle 问题

> ID：717529
> 
> 赞同：0
> 
> 时间：2009-04-04T18:04:39.273
> 
> 标签：facebook, feed

我正在尝试在我的框架包装器中构建一个自动注册模板包的功能。我已经到了似乎可以使用 Feed.registerTemplateBundle API 方法成功地做到这一点的地步——我没有收到错误，而且我确实得到了一个模板 ID。但是，模板没有显示在“注册模板控制台”中，如果我尝试使用该 ID 发布故事，它会给我一个“无效的模板包 ID”错误。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T18:51:36.790

我在 Facebook 的官方示例应用程序 (TheRunAround) 中遇到了这个问题

它正在注册模板，但是当它尝试获取 id 时，它正在使用 sprintf（例如：sprintf('%d', )）

当前模板 ID 超出 32 位范围，因此返回错误的 ID。

可能是原因吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T20:50:14.400

结果发现有两个问题：

*   我错误地对短篇小说模板进行了双 json 编码
*   Facebook 接受了格式错误的调用并返回了一个 id，从而导致创建了没有出现在他们的控制台中的“幻像”模板包。

我已经修复了我的代码，并且已经[报告](http://bugs.developers.facebook.com/show_bug.cgi?id=4891)了这个错误（我相信自从修复之后）。

# windows - 在 Dos 批处理文件中运行顽固的可执行文件

> ID：717530
> 
> 赞同：2
> 
> 时间：2009-04-04T18:05:02.080
> 
> 标签：windows, batch-file, input, dos, return

我有一个非常顽固的可执行文件，我想从 Dos 批处理文件中按顺序执行多次。（由于 IT 限制，目前只能使用 Dos 批处理文件。）

我可以使用 START 启动可执行文件，但是，似乎可执行文件希望用户在“真正”运行/执行之前点击返回。

在 DOS 批处理脚本中，是否有一个期望用户在运行之前点击返回的可执行文件？我希望“返回”出现在脚本中，而不必实际单击窗口并手动点击返回。

感谢您提供的任何反馈。

PS 在 START 中找出 /wait 选项，以便在第一个执行完成后立即开始下一次执行，依此类推，但无法弄清楚如何输入“return”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T18:08:44.133

您可以通过管道传输来自其他文件的输入，例如，

用一个回车写一个文本文件，然后像..

开始 "YourExe.exe < text.txt",

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T18:14:26.800

您可以使用

```
echo.|DoStuff.exe 
```

前提是您的可执行文件是控制台程序。

# iphone - 以编程方式更改 iPhone 背景

> ID：717535
> 
> 赞同：3
> 
> 时间：2009-04-04T18:07:50.140
> 
> 标签：iphone

是否可以从代码更改 iPhone 背景？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T18:13:15.620

不可以，您只能保存一张图片供用户设置为背景。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-05T01:55:24.447

如果您将新的 png 写入`/User/Library/LockBackground.png`然后调用`notify_post(" com.apple.language.changed");`，则设备将重新启动，并且您的新背景将出现。

从技术上讲，这不是一个私有 API，但确实超出了 Apple 在商店中允许的范围。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T20:44:50.403

梅尔是正确的，没有办法跳过保存过程。

原因总是如此：

Apple 不希望应用程序能够在打开时立即设置背景。从理论上讲，他们可以有一个权限框（如位置对话框），但我怀疑这会很快发生。

# c# - C#.net 中的动态中继器

> ID：717539
> 
> 赞同：0
> 
> 时间：2009-04-04T18:10:08.963
> 
> 标签：c#, .net, asp.net

我正在尝试使用 ITemplate 动态创建嵌套中继器。这个中继器就像我正在传递的那样`List<Control>`，它会生成中继器。问题是当我对外部中继器进行数据绑定时。只有最后一个嵌套的中继器显示。以下是屏幕截图。 [![截屏](https://i.stack.imgur.com/PaT4Y.png)](https://i.stack.imgur.com/PaT4Y.png)

**标记**

* * *

```
 <%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="Restricted_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
    <table style="border:solid 1px black;">
        <tr>
            <td>
                <asp:PlaceHolder ID="phControls" runat="server" />
            </td>
        </tr>
    </table>
    </div>
    </form>
</body>
</html> 
```

* * *

**代码背后**

* * *

```
 using System;
using System.Collections.Generic;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data;

public partial class Restricted_Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        CreateNestedRepeater();
    }

    private void CreateNestedRepeater()
    {
        Repeater childRpt = new Repeater();
        List repeatingRuleControls = new List();
        repeatingRuleControls.Add(new TextBox());
        repeatingRuleControls.Add(new TextBox());
        repeatingRuleControls.Add(new TextBox());
        RepeatingRuleTemplate repeatingRuleTemplate = new RepeatingRuleTemplate(ListItemType.Item, repeatingRuleControls);
        childRpt.HeaderTemplate = new RepeatingRuleTemplate(ListItemType.Header, repeatingRuleControls);
        childRpt.ItemTemplate = repeatingRuleTemplate;
        childRpt.FooterTemplate = new RepeatingRuleTemplate(ListItemType.Footer, null);
        childRpt.DataSource = new DataRow[4];

        Repeater parentRpt = new Repeater();
        repeatingRuleControls = new List();
        repeatingRuleControls.Add(new TextBox());
        repeatingRuleControls.Add(new TextBox());
        repeatingRuleControls.Add(new TextBox());
        repeatingRuleControls.Add(childRpt);
        RepeatingRuleTemplate parentrepeatingRuleTemplate = new RepeatingRuleTemplate(ListItemType.Item, repeatingRuleControls);
        parentRpt.HeaderTemplate = new RepeatingRuleTemplate(ListItemType.Header, repeatingRuleControls);
        parentRpt.ItemTemplate = parentrepeatingRuleTemplate;
        parentRpt.FooterTemplate = new RepeatingRuleTemplate(ListItemType.Footer, null);
        parentRpt.DataSource = new DataRow[4];
        parentRpt.DataBind();
        phControls.Controls.Add(parentRpt);
    }

    public class RepeatingRuleTemplate : ITemplate
    {
        ListItemType templateType;
        List innerControls;

        public RepeatingRuleTemplate(ListItemType type, List controls)
        {
            templateType = type;
            innerControls = controls;
        }

        public void InstantiateIn(Control container)
        {
            PlaceHolder ph = new PlaceHolder();

            switch (templateType)
            {
                case ListItemType.Header:
                    ph.Controls.Add(new LiteralControl(""));
                    ph.Controls.Add(new LiteralControl(""));
                    foreach (Control control in innerControls)
                    {
                        Label label = new Label();
                        label.Text = control.ID;
                        ph.Controls.Add(new LiteralControl(""));
                        ph.Controls.Add(label);
                        ph.Controls.Add(new LiteralControl(""));
                    }
                    ph.Controls.Add(new LiteralControl(""));
                    break;
                case ListItemType.Item:
                    ph.Controls.Add(new LiteralControl(""));

                    foreach (Control control in innerControls)
                    {
                        if (control.GetType() != typeof(Repeater))
                        {
                            ph.Controls.Add(new LiteralControl(""));
                            TextBox textBox = new TextBox();
                            textBox.ID = control.ID;
                            ph.Controls.Add(textBox);
                            ph.Controls.Add(new LiteralControl(""));
                        }
                        else
                        {
                            ph.Controls.Add(new LiteralControl(""));
                            ph.Controls.Add(control as Repeater);
                            //(control as Repeater).DataSource = new DataRow[4];
                            //   (control as Repeater).DataBind();
                            ph.Controls.Add(new LiteralControl(""));
                        }
                    }
                    ph.Controls.Add(new LiteralControl(""));
                    //ph.DataBinding += new EventHandler(Item_DataBinding);
                    break;
                case ListItemType.Footer:
                    ph.Controls.Add(new LiteralControl(""));
                    break;
            }
            container.Controls.Add(ph);
        }

        public List Controls
        {
            get
            {
                return innerControls;
            }
        }

    }
} 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T19:26:51.837

您需要为 parentRpt.ItemDataBound 事件编写处理程序并设置 childRpt 的 DataSource 属性，然后从那里调用 child.Rpt.DataBind() 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T19:31:03.933

为什么不只是制作自定义控件并用您的代码填充它？

```
override CreateChildControls(){  

    foreach(var r in rows)
    {
    ...
    }
} 
```

模板、转发器等只是为了让设计体验更好，在您手动构建所有内容的情况下，我看不出为什么使用所有占位符、模板等过于复杂......

只需构建 CompositeControl 并用您的代码填充它。你会减少你的代码两次，什么是最好的，你将拥有可读的代码。没有令人讨厌的事件来连接子转发器 DataSource 属性。

对不起，硬顶...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T22:19:37.820

好吧，伙计们，我想通了....不过还是感谢大家。我做错了。模板类是错误的。我修复了它，现在它像 Charm Follwoing 一样工作

```
 public class RepeatingRuleTemplate : ITemplate
    {
        ListItemType templateType;
        List innerControls; ``public RepeatingRuleTemplate(ListItemType type, List<Control> controls)
    {
        templateType = type;
        innerControls = controls;
    }

    public void InstantiateIn(Control container)
    {
        PlaceHolder ph = new PlaceHolder();

        switch (templateType)
        {
            case ListItemType.Header:
                ph.Controls.Add(new LiteralControl("<table border=\"0\">"));
                ph.Controls.Add(new LiteralControl("<tr>"));
                foreach (Control control in innerControls)
                {
                    Label label = new Label();
                    label.Text = control.ID;
                    ph.Controls.Add(new LiteralControl("<td>"));
                    ph.Controls.Add(label);
                    ph.Controls.Add(new LiteralControl("</td>"));
                }
                ph.Controls.Add(new LiteralControl("</tr>"));
                break;
            case ListItemType.Item:
                ph.Controls.Add(new LiteralControl("<tr>"));

                foreach (Control control in innerControls)
                {
                        //ph.Controls.Add(new LiteralControl("<td>"));
                        //ph.Controls.Add(control as TextBox);
                        //ph.Controls.Add(new LiteralControl("</td>"));
                    if (control.GetType() != typeof(Repeater))
                    {
                        ph.Controls.Add(new LiteralControl("<td>"));
                        TextBox textBox = new TextBox();
                        textBox.ID = control.ID;
                        ph.Controls.Add(textBox);
                        ph.Controls.Add(new LiteralControl("</td>"));
                    }
                    else
                    {
                        ph.Controls.Add(new LiteralControl("<td>"));
                        Repeater rpt = new Repeater();
                        rpt.DataSource = (control as Repeater).DataSource;
                        rpt.ItemTemplate = (control as Repeater).ItemTemplate;
                        rpt.HeaderTemplate = (control as Repeater).HeaderTemplate;
                        rpt.FooterTemplate = (control as Repeater).FooterTemplate;
                        rpt.DataBind();
                        ph.Controls.Add(rpt);
                        //(control as Repeater).DataSource = new DataRow[4];
                        //   (control as Repeater).DataBind();
                        ph.Controls.Add(new LiteralControl("</td>"));
                    }
                }
                ph.Controls.Add(new LiteralControl("</tr>"));
                //ph.DataBinding += new EventHandler(Item_DataBinding);
                break;
            case ListItemType.Footer:
                ph.Controls.Add(new LiteralControl("</table>"));
                break;
        }
        container.Controls.Add(ph);
    }

    public List<Control> Controls
    {
        get
        {
            return innerControls;
        }
    }

}``  # python - 在 Python 中解析 HTML

> ID：717541
> 
>         
> 
> 赞同：27
> 
>         
> 
> 时间：2009-04-04T18:11:13.737
> 
>         
> 
> 标签：python, html-parsing

如果我不能使用 BeautifulSoup 或 lxml，那么解析 HTML 的最佳选择是什么？我有一些使用 SGMLlib 的代码，但它有点低级，现在已弃用。

我更喜欢它可以忍受一些格式错误的 HTML，尽管我很确定大部分输入都会很干净。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-04-04T20:00:52.927

Python 有一个[原生的 HTML 解析器](https://docs.python.org/3/library/html.parser.html)，但是 Nick 建议的 Tidy 包装器可能也是一个不错的选择。Tidy 是一个很常见的库，（是用 C 写的吗？）

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T18:14:20.560

也许[µTidylib](http://utidylib.berlios.de/)会满足您的需求？

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2012-06-27T17:37:16.193

[您可以使用 Pallet（ MacPorts 官方 GUI](https://trac.macports.org/wiki/MacPortsGUI)）在 Mac（OS X）上轻松无缝地安装 lxml 和许多其他 python 模块

模块名称为 py27-lxml。像 1,2,3 一样简单。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T18:29:55.640

[http://www.xmlhack.com/read.php?item=1392](http://www.xmlhack.com/read.php?item=1392) 
[http://sourceforge.net/projects/pirxx/](http://sourceforge.net/projects/pirxx/)

[http://pyxml.sourceforge.net/topics/](http://pyxml.sourceforge.net/topics/)

我对 python 没有太多经验，但我过去使用过 Xerces（来自 Apache 基金会），发现它非常有用。学习曲线也不错，尽管我不是从 python 的角度来的。不过我建议你考虑一下。（我包含的前两个链接讨论了 Xerces 的 python 接口，最后一个是谷歌第一次点击“python xml”）。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2010-06-04T11:51:24.057

html5lib 很好：

[http ://code.google.com/p/html5lib/](http://code.google.com/p/html5lib/)

**更新：**上面的链接坏了。上面的第三方镜像，可以从[https://github.com/html5lib/gcode-import访问](https://github.com/html5lib/gcode-import)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2011-03-23T14:25:04.993

htql 擅长处理格式错误的 html：

[http://htql.net/](http://htql.net/)

# java - java.lang.OutOfMemoryError：带有 NetBeans 的 Java 堆空间

> ID：717550
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-04-04T18:15:48.233
> 
>         
> 
> 标签：java, tomcat, netbeans, out-of-memory, heap-memory

这是我在由 NetBeans 启动的 Tomcat servlet 容器实例中运行 Web 应用程序时遇到的错误。为了解决这个问题，我什至更改了 netbeans.conf 中的堆大小，但仍然显示相同的错误。我怎样才能防止这种情况发生？

```
HTTP 状态 500 -

-------------------------------------------------- ------------------------------

类型异常报告

信息

描述 服务器遇到一个内部错误 () 阻止它完成这个请求。

例外

javax.servlet.ServletException：Servlet 执行引发异常
    org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:362)

根本原因

java.lang.OutOfMemoryError：Java 堆空间

note Apache Tomcat/5.5.9 日志中提供了根本原因的完整堆栈跟踪。

```

* * *

## 回答 #1

> 赞同：30
> 
>             
> 
> 时间：2009-04-04T18:20:35.070

更改 netbeans.conf 中的堆大小只会更改 NetBeans 本身的堆，而不更改通过 NetBeans 运行的应用程序。

正确的做法是在项目上右击，选择“属性”，然后“运行”；在那里您可以适当地设置 VM 选项（`-Xmx256m`例如）。它应该看起来像这样：

![设置堆大小](https://i.stack.imgur.com/AcUj8.png)

（感谢[VonC](https://stackoverflow.com/users/6309/vonc)找到这张照片。）

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2012-04-04T10:15:43.607

停止 Tomcat 服务器，设置环境变量 CATALINA_OPTS，然后重启 Tomcat。查看文件`tomcat-install/bin/catalina.sh`或`catalina.bat`了解如何使用此变量。例如，

```
set CATALINA_OPTS="-Xms512m -Xmx512m" (Windows)export CATALINA_OPTS="-Xms512m -Xmx512m" (ksh/bash)setenv CATALINA_OPTS "-Xms512m -Xmx512m" (tcsh/csh) 
```

在`catalina.bat`或`catallina.sh`中，您可能已经注意到 CATALINA_OPTS、JAVA_OPTS 或两者都可用于指定 Tomcat JVM 选项。

CATALINA_OPTS 和 JAVA_OPTS 有什么区别？

名称 CATALINA_OPTS 特定于 Tomcat servlet 容器，而 JAVA_OPTS 可能被其他 java 应用程序（例如，JBoss）使用。由于环境变量由所有应用程序共享，我们不希望 Tomcat 无意中选择用于其他应用程序的 JVM 选项。我更喜欢使用 CATALINA_OPTS。

如何在 JBoss 中设置 Java 堆大小？

停止 JBoss 服务器，编辑 $JBOSS_HOME/bin/run.conf，然后重新启动 JBoss 服务器。您可以使用 JAVA_OPTS 将行更改为：

```
JAVA_OPTS="-server -Xms128m -Xmx128m" 
```

如何在 Eclipse 中设置 Java 堆大小？您有 2 个选项：

1.  将 eclipse-home/eclipse.ini 编辑为如下所示并重新启动 Eclipse。

    -vmargs-Xms64m-Xmx256m

2.  或者，您可以在最后运行带有附加选项的 eclipse 命令。-vmargs 之后的任何内容都将被视为 JVM 选项并直接传递给 JVM。以这种方式在命令行中指定的 JVM 选项将始终覆盖 eclipse.ini 中的选项。例如，

    eclipse -vmargs -Xms64m -Xmx256m

如何在 NetBeans 中设置 Java 堆大小？

退出 NetBeans，编辑文件 netbeans-install/etc/netbeans.conf。例如，

```
netbeans_default_options="-J-Xms512m -J-Xmx512m -J-XX:PermSize=32m -J-XX:MaxPermSize=128m -J-Xverify:none 
```

如何在 Apache Ant 中设置 java 堆大小？

设置环境变量 ANT_OPTS。查看文件`$ANT_HOME/bin/ant`或`%ANT_HOME%\bin\ant.bat`，了解 Ant 运行时如何使用此变量。

```
set ANT_OPTS="-Xms512m -Xmx512m" (Windows)export ANT_OPTS="-Xms512m -Xmx512m" (ksh/bash)setenv ANT_OPTS "-Xms512m -Xmx512m" (tcsh/csh) 
```

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-04-06T12:49:46.737

如果您增加 Tomcat 服务器的虚拟内存，那么就可以了。

### 脚步：

1.  在 NB 中通过 windows 菜单并添加服务

2.  您将在服务中找到 Tomcat。右键单击Tomcat服务器并选择属性

3.  转到属性中的平台并`-Xms512m`在VM选项字段中写入

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T18:52:01.250

我猜增加内存不会解决问题。MonitorFilter 在做什么？是什么吞噬了所有的记忆？

你最好的办法是弄清楚这一点。如果这是一个网络应用程序，请查看是否可以关闭该过滤器并在没有它的情况下运行。如果你成功了，你就知道 MonitorFilter 导致你失败​​。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-04-05T05:48:37.477

This has nothing to do with NetBeans (well, perhaps), rather it has to do with Tomcat. Tomcat is the process that is running out of heap, not NetBeans. Track down the startup process for your Tomcat. If it's bundled with NB, then Tomcat is buried within the NB installation, check for an "enterpriseN" directory, N being a number, Tomcat is probably in there and it's a rather generic distribution of it.

As to why the monitor is run OOM, that's hard to say, it's a pretty simple process when  you think about it. You can also try disabling HTTP monitoring to see if it's a problem with the Monitoring itself or something with your application.

# session - 设计经典 ASP 应用程序以动态检测会话过期

> ID：717569
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-04T18:36:49.743
> 
>         
> 
> 标签：session, asp-classic

我有一个依赖会话的经典 ASP 应用程序；如果用户让屏幕空闲然后运行表单发布或其他操作，我想知道会话是否已过期。

目前我正在检查每个页面中的会话以查看它是否超时，但是是否有更好的、动态的、JavaScripty 方法可以完成银行所做的事情并通过通知超时会话并重定向到登录？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T19:24:22.453

在您的页面`onload`事件期间，启动一个计时器，然后在 N 秒后重定向页面。

*   对于计时器，请使用该`window.setTimeout`功能。

*   对于重定向，设置 的值`window.location`。

可重用示例：

```
<head>
<script type="text/javascript">
<!--
 function redirect(url) {
   window.location = url;
 }
 function beginSessionTimer() {
   // 30000ms = 30s
   window.setTimeout(redirect, 30000, 
                     "http://www.yoursite.com/login.asp?session=clear");
 }
//-->
</script>
</head>
<body onload='beginSessionTimer();'>
</body> 
```

带有内联函数的 Quick-n-dirty 示例：

```
<body onload='window.setTimeout(function(){
window.location="http://www.yoursite.com/login.asp?session=clear";}, 
30000);'> 
```

请注意，如果您的页面执行任何 AJAX 调用，这会使会话保持活动状态，因此您需要使用 clearTimeout 方法重置计时器（结合对 setTimeout 的新调用）。有关 clearTimeout 的详细信息，[请单击此处](https://developer.mozilla.org/en/DOM/window.clearTimeout)以获取来自 Mozilla 的优秀文档。）

# c# - request.getresponse() 给出错误的用户名和密码错误

> ID：717570
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T18:37:05.373
> 
>         
> 
> 标签：c#, database

我正在尝试使用`request.getstream()`服务器 A 访问文件。我还提供了网络凭据。这些凭据在该服务器上具有管理员权限。

但是在使用`request.getresponse()`时显示以下错误：

> 登录失败：用户名和密码错误。

有人可以建议可能是什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T18:42:27.483

您可能还必须在用户名中提供域，例如“DOMAIN\USERNAME”

# c - 你如何在 C 中的 Linux 上进行非阻塞控制台 I/O？

> ID：717572
> 
>         
> 
> 赞同：42
> 
>         
> 
> 时间：2009-04-04T18:37:28.587
> 
>         
> 
> 标签：c, linux, macos, io, nonblocking

你如何在 C 中的 Linux/OS X 上进行非阻塞控制台 IO？

* * *

## 回答 #1

> 赞同：27
> 
>             
> 
> 时间：2015-05-30T16:42:11.100

我想添加一个例子：

```
#include <unistd.h>
#include <fcntl.h>
#include <stdio.h>

int main(int argc, char const *argv[])

{
    char buf[20];
    fcntl(0, F_SETFL, fcntl(0, F_GETFL) | O_NONBLOCK);
    sleep(4);
    int numRead = read(0, buf, 4);
    if (numRead > 0) {
        printf("You said: %s", buf);
    }
} 
```

当你运行这个程序时，你有 4 秒的时间向标准输入提供输入。如果没有找到输入，它不会阻塞，只会返回。

2个示例执行：

```
Korays-MacBook-Pro:~ koraytugay$ ./a.out
fda 
You said: fda
Korays-MacBook-Pro:~ koraytugay$ ./a.out
Korays-MacBook-Pro:~ koraytugay$ 
```

* * *

## 回答 #2

> 赞同：23
> 
>             
> 
> 时间：2009-08-14T23:26:43.197

像[Pete Kirkham](https://stackoverflow.com/users/1527/pete-kirkham)一样，我找到[了 cc.byexamples.com](https://web.archive.org/web/20170407122137/http://cc.byexamples.com/2007/04/08/non-blocking-user-input-in-loop-without-ncurses/)，它对我有用。去那里很好地解释问题，以及 ncurses 版本。

我的代码需要从标准输入或文件中获取初始命令，然后在处理初始命令时注意取消命令。我的代码是 C++，但你应该可以使用`scanf()`，其余的地方我使用 C++ 输入函数`getline()`。

肉是一个检查是否有任何可用输入的函数：

```
#include <unistd.h>
#include <stdio.h>
#include <sys/select.h>

// cc.byexamples.com calls this int kbhit(), to mirror the Windows console
//  function of the same name.  Otherwise, the code is the same.
bool inputAvailable()  
{
  struct timeval tv;
  fd_set fds;
  tv.tv_sec = 0;
  tv.tv_usec = 0;
  FD_ZERO(&fds);
  FD_SET(STDIN_FILENO, &fds);
  select(STDIN_FILENO+1, &fds, NULL, NULL, &tv);
  return (FD_ISSET(0, &fds));
} 
```

这必须在任何标准输入函数之前调用当我`std::cin`在使用这个函数之前使用它时，它再也没有返回 true。例如，`main()`有一个如下所示的循环：

```
int main(int argc, char* argv[])
{ 
   std::string initialCommand;
   if (argc > 1) {
      // Code to get the initial command from a file
   } else {
     while (!inputAvailable()) {
       std::cout << "Waiting for input (Ctrl-C to cancel)..." << std::endl;
       sleep(1);
     }
     std::getline(std::cin, initialCommand);
   }

   // Start a thread class instance 'jobThread' to run the command
   // Start a thread class instance 'inputThread' to look for further commands
   return 0;
} 
```

在输入线程中，新命令被添加到队列中，由`jobThread`. `inputThread`看起来有点像这样：

```
THREAD_RETURN inputThread()
{
  while( !cancelled() ) {
    if (inputAvailable()) {
      std::string nextCommand;
      getline(std::cin, nextCommand);
      commandQueue.lock();
      commandQueue.add(nextCommand);
      commandQueue.unlock();
    } else {
        sleep(1);
    }
  }
  return 0;
} 
```

这个函数可能是 in `main()`，但我正在使用现有的代码库，而不是反对它。

对于我的系统，在发送换行符之前没有可用的输入，这正是我想要的。如果您想在键入时读取每个字符，则需要关闭标准输入上的“规范模式”。  [cc.byexamples.com](https://web.archive.org/web/20170407122137/http://cc.byexamples.com/2007/04/08/non-blocking-user-input-in-loop-without-ncurses/)有一些我没有尝试过的建议，但其余的都有效，所以它应该有效。

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T18:47:41.933

你没有，真的。TTY（控制台）是一个非常有限的设备，你几乎不做非阻塞 I/O。当你看到一些看起来像非阻塞 I/O 的东西时，比如在 curses/ncurses 应用程序中，你所做的称为*原始 I/O*。在原始 I/O 中，没有字符解释，没有擦除处理等。相反，您需要编写自己的代码来检查数据，同时做其他事情。

在现代 C 程序中，您可以通过将控制台 I/O 放入*线程*或轻量级进程来简化这一点。然后 I/O 可以以通常的阻塞方式继续，但数据可以插入到队列中以在另一个线程上处理。

### 更新

这是一个更详细的[curses教程](http://heather.cs.ucdavis.edu/~matloff/UnixAndC/CLanguage/Curses.pdf)。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T18:59:55.990

本月早些时候，当我认为我可能需要非阻塞、非缓冲的控制台输入时，我将“[无 ncurses 的循环中的非阻塞用户输入](https://web.archive.org/web/20170407122137/http://cc.byexamples.com/2007/04/08/non-blocking-user-input-in-loop-without-ncurses/)”添加为书签，但我没有，因此无法保证它是否有效。对于我的使用，我并不关心它在用户按下回车之前没有得到输入，所以只是使用[aio](http://www.ibm.com/developerworks/linux/library/l-async/index.html)来读取标准输入。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T18:40:38.157

这是一个使用 C++ 的相关问题——[跨平台 (linux/Win32) nonblocking C++ IO on stdin/stdout/stderr](https://stackoverflow.com/questions/315111/cross-platform-linux-win32-nonblocking-c-io-on-stdin-stdout-stderr)

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2009-08-14T23:37:17.700

使用 ncurses 或线程的另一个替代方法是使用[GNU Readline](http://tiswww.case.edu/php/chet/readline/rltop.html)，特别是它允许您[注册回调函数](http://www.delorie.com/gnu/docs/readline/rlman_41.html)的部分。那么模式是：

1.  在 STDIN 上使用 select()（在任何其他描述符中）

2.  当 select() 告诉您 STDIN 已准备好读取时，调用 readline 的 rl_callback_read_char()

3.  如果用户输入了完整的行，rl_callback_read_char 将调用您的回调。否则它将立即返回，您的其他代码可以继续。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T18:45:12.110

不完全确定您所说的“控制台 IO”是什么意思——您是从 STDIN 读取的，还是从其他来源读取的控制台应用程序？

如果您正在从 STDIN 读取，则需要跳过 fread() 并使用 read() 和 write()，以及 poll() 或 select() 以防止调用阻塞。您可以使用 setbuf() 禁用输入缓冲，这会导致 fread 返回 EOF，但我从未尝试过。

# internet-explorer - FoxyProxy 替代 Internet Explorer

> ID：717573
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T18:38:09.537
> 
>         
> 
> 标签：internet-explorer, debugging, foxyproxy

我无法直接通过网络访问正在调试 PHP/Javascript 代码的 linux 主机。我通过 SSH 连接到跳转框，然后使用 FoxyProxy 使用 SOCKS 转发通过我的 SSH 会话传输我的 firefox 请求。

我希望能够在 IE 中调试 javascript 代码，但不幸的是我的 FoxyProxy 设置只能通过 FireFox 扩展工作。是否有一个快速而肮脏的解决方案可以让我通过代理来隧道我的网络流量（对于某些主机！）？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T18:49:57.230

对于 SOCKS 转发和 IE，请使用[FreeCap](http://www.freecap.ru/eng/?p=download)。几乎可以让任何应用程序使用 SOCKS 代理，免费（如啤酒）且可靠（甚至允许代理链接）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2019-11-19T12:17:45.300

我认为这可以使用 Fiddler 解决，下面提到了步骤 从 telerik.com/download/fiddler 下载并安装 Fiddler。打开 Fiddler，转到 AutoResponder 选项卡选中“启用规则”和“不匹配的请求直通”复选框。单击“添加规则”按钮并添加您的规则

# c# - 如何远程启动不同系统上的应用程序？

> ID：717577
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-04T18:41:21.933
> 
>         
> 
> 标签：c#, .net, windows, networking

我有一种情况，我有一个系统运行一个主应用程序，该应用程序与其他系统上的从属小程序通信，问题是，我不能保证从属小程序将运行，也不能保证操作员可以物理地利用系统来启动小程序（我还假设他们不知道如何使用远程桌面，这些是最低工资测试操作员）

**有没有一种简单的方法可以在另一个系统上远程启动可执行文件？**

安全性在这里不是问题，因为这是一个封闭的网络。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T18:46:08.940

如果您在同一个网络上并且拥有远程计算机的访问凭据（用户名+密码），那么 Mark Russinovich 的[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)正是您需要的工具。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T19:03:47.573

WMI 是您的朋友。请参阅以下文章，其中介绍了使用 WMI 在本地和远程启动进程：

[如何：（几乎）通过 C# 在 WMI 中的所有内容第 2 部分：进程（CodeProject）](http://www.codeproject.com/KB/cs/EverythingInWmi02.aspx)

凯夫

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T18:53:13.587

您可以使用[Windows AT 命令](http://support.microsoft.com/kb/313565)在远程计算机上安排任务。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T18:57:13.533

有没有机会将远程小程序转换为 Windows 服务？它们可以配置为在系统启动时启动；如果失败则重试；并在有问题时通知某人。使用 Visual Studio 创建它们非常简单。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T18:50:56.650

这是一个两步解决方案

1.  编写一个批处理文件以在上下文中启动应用程序/服务

2.  将批处理文件放在可以从要启动应用程序/服务的机器访问的共享网络路径上。

老实说，我会建议 Piskvor 的 PsExec 解决方案。但是你也可以试试这个；）

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2015-01-28T15:58:32.783

如果您不在同一个网络上（例如访问您的家庭计算机以运行 teamviewer），另一个简单的解决方案是在 Outlook 中创建一个规则（如果您有），而如果您收到一封来自您自己的电子邮件，您可以拥有它如果消息正文或主题行中有某些文本，则启动应用程序，例如：

创建邮箱规则：第 1 步 - 条件：发件人 & 正文中包含特定单词（来自您的邮件地址和邮件正文：启动 Teamviewer 第 2 步 - 启动应用程序（浏览到您要启动的 .exe 的位置）第 3 步 - 启用那个坏男孩！

显然，您必须打开 Outlook 并接受传入的邮件才能使其正常工作。

you can tailor this to your requirements, ie: if Start Teamviewer is too easy, you can put codes or passwords in there too, so when the email arrives, it'll read the message, recognise the info based on the rule, and launch the application. :) 

# static - 许多具有全局和局部状态的对象

> ID：717587
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T18:48:30.603
> 
>         
> 
> 标签：static, state, global

我正在为以下情况寻找最佳设计。

我们有许多对象形成一个类，例如相框。现在每个相框可以显示3种图片。1) 一张脸 2) 截图 3) 空的

这很容易：

```
public enum PictureMode 
{
    Face,
    Screen,
    None
}

public class PictureFrame {
    private PictureMode mode;
    public PictureMode Mode 
    {
        get { retrun mode; }
        set { /* set currentPicture to the correct one */ }
    }

    private Image currentPicture;
    private Image face;
    private Image screen;
    private Image empty;

    public PictureFrame(Image face, Image screen) {
        this.face = face;
        this.screen = screen;

        mode = PictureMode.None; // Maybe this is our default.
    }
} 
```

我们现在可以创建一些具有不同图片的 PictureFrames，并轻松更改每张图片的模式。

现在我想为所有 PictureFrames 添加一个全局设置器。然后每个新的 PictureFrame 都应该将全局设置作为默认设置。稍后可以将其设置为不同的通过。

这是我的解决方案，但我想讨论是否有更好的解决方案。

我在所有 PictureFrames 都可以访问的 PictureFrame 类中添加了一个静态字段 PictureFrame.Instances。现在我可以遍历所有 PictureFrames 以将新的全局模式应用于所有帧。

此外，我还有第二个静态字段 PictureFrame.GlobalImageMode，如果我在所有帧上更改它并在 PictureFrame 的构造函数中读取它，我将在其中设置全局模式。GlobalImageMode 的设置器在 PictureFrame 类中也可以是静态的。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:10:30.647

在这里只是狂野的镜头......：为什么你不总是在当前帧模式中使用getter，其中包含一个条件：

```
class PictureFrame {
  private PictureMode instanceMode;
  private static PictureMode? globalMode;

  private PictureMode CurrentMode {
    get {
       return globalMode ?? instanceMode;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T19:07:48.763

如果我正确理解了问题陈述，我认为这与您需要的类似：

```
public class Face extends Image { }
public class Screen extends Image { }

public class PictureFrame {
  private Image picture = null;

  public PictureFrame(Image newPicture) {
    this.setPicture(newPicture);
  }

  public setPicture(Image newPicture) {
    this.picture = newPicture;
  }
}

public class PictureFactory {
  private static Image defaultPicture = null;

  public static void setDefaultPicture(Image newPicture) {
    PictureFactory.defaultPicture = newPicture;
  }

  public static Image getDefaultPicture() {
    return PictureFactory.defaultPicture;
  }

  public static PictureFrame getNewPictureFrame() {
    return new PictureFrame(PictureFactory.defaultPicture);
  }
}

public class PictureFrameManager {
  private static PictureManager INSTANCE = new PictureManager();
  private Vector<PictureFrame> frames = new Vector<PictureFrame>();

  public static PictureFrameManager getInstance() {
    return PictureManager.INSTANCE;
  }

  private PictureFrameManager() {}

  private void addPictureFrame(PictureFrame frame) {
    this.frames.add(frame);
  }

  private void setFramesToDefault() {
    Image defaultPicture = PictureFactory.getDefaultPicture();
    Enumeration<PictureFrame> iFrames = frames.elements();
    while(iFrames.hasMoreElements()) {
      iFrames.nextElement().setPicture(defaultPicture);
    }
  }
} 
```

您可以通过以下方式使用它：

```
Face face = new Face();
//...do something to load the face object here

PictureFactory.setDefaultPicture(face);
PictureFrame frame = PictureFactory.getNewPictureFrame();

PictureFrameManager manager = PictureFrameManager.getInstance();
manager.addPictureFrame(frame);

Screen screen = new Screen();
//...do something to load the screen object here

PictureFactory.setDefaultPicture(screen);
manager.setFramesToDefault(); 
```

或者，如果你不想扩展 Image 或者你想拥有多种模式，你可以创建一个装饰器对象来包装图像并说明它是什么模式。

# java - 编写更简洁、更模块化的命令解析器

> ID：717588
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-04-04T18:49:13.223
> 
>         
> 
> 标签：java, design-patterns, java.util.scanner

我正在使用 Java 为我们在学校项目中编写的 Z80 模拟器编写调试器。调试器从用户那里读取一个命令，执行它，读取另一个命令，等等。

命令可以是更少参数，具有可选参数，或者采用无限数量的参数。参数大多是整数，但有时它们是字符串。

目前，我们使用 Scanner 类来读取和解析输入。[read-method 看起来有点像这样（我是在脑海中写下这个，没有注意语法和正确性）。](http://pastebin.com/m2a062299)

这是在项目开始时编写的一个杂物，随着我们向调试器添加越来越多的命令，它很快就失控了。

我对这段代码的主要问题是大量的重复、高级别的 if/else 嵌套以及周围的丑陋。

我想就如何使这段代码更漂亮和模块化，以及什么样的模式适合这种程序提出建议。

我还想对代码风格提出更一般的建议。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T19:17:36.807

是的，有一种更简单/更好的方法，尤其是在 Java 或其他 OO 语言中。  

首先，基本见解是您的命令解析器是一个有限状态机：START 状态是一个空行（或行首的索引）。

让我们想想`echo`：

```
$ echo foo bat "bletch quux" 
```

1.  将行标记为碎片：

    “回声”“富”“酒吧”“bletch quux”

2.  在外壳中，语法通常是*动词名词名词......*所以这样解释。您可以使用一系列 if-else if 来实现，但哈希更好。您使用字符串作为索引加载哈希，并索引其他内容。它可能只是一个数字，它会进入一个开关：

（这是伪代码）：

```
 Hashtable cmds = new Hashtable();
  enum cmdindx { ECHO=1, LS=2, ...}
  cmds.add("echo", ECHO); // ...

  // get the token into tok
  switch (cmds.get(tok)) {
     case ECHO: // process it
       // get each successor token and copy it to stdout
       break;
     ...
     default:
        // didn't recognize the token
        // process errors
   } 
```

更好的是，您可以应用命令和对象工厂模式。现在你有一个类命令

```
 public interface Command {
     public void doThis(String[] nouns) ;
     public Command factory();
  }

  public class Echo implements Command {
     public void doThis(String[] nouns){
         // the code is foreach noun in nouns, echo it
     }
     public Command factory(){
         // this clones the object and returns it
     }
  } 
```

现在，您的代码变为

```
 // Load the hash
  Hashtable cmds = new Hashtable();
  cmds.add("echo", new Echo());  // one for each command

  // token is in tok
  // the "nouns" or "arguments are in a String[] nouns
  ((cmds.get(tok)).factory()).doThis(nouns); 
```

看看这是如何工作的？您在哈希中查找对象。您调用该`factory`方法来获取新副本。`doThis`然后，您使用该方法调用该命令的处理。

### 更新

这可能有点*太*笼统了，因为它使用了工厂模式。为什么要有工厂方法？主要是，您将使用它，以便每次执行命令时，“动词”对象（如 的实例`Echo`）都可以拥有自己的内部状态。如果您不需要状态持续很长时间，您可以将其简化为

```
 (cmds.get(tok)).doThis(nouns); 
```

现在它只是获取并使用`Echo`您在实例化它时创建的对象`cmds.add("echo", new Echo());`。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:12:11.000

您是否看过使用地图进行调度？一个[hashmap](http://java.sun.com/javase/6/docs/api/java/util/HashMap.html)很容易放在那里。只需将键设置为命令并创建一个接口或抽象类，它是这样的命令：

```
interface Commmand {
   void execute(String args);
} 
```

或者更好的是，您可以提前切碎论点：

```
interface Commmand {
   void execute(String[] args);
} 
```

然后你会使用 HashMap<String,Command>。

# c# - c#：如何将图像字段转换为 int[]？

> ID：717595
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T18:56:04.487
> 
>         
> 
> 标签：c#

c#：如何将图像字段的数据转换为 int 数组？您如何将 int 数组写入图像字段？

必须在代码中完成，而不是在程序中完成，我不知道将使用哪种数据库类型。

编辑：我正在使用 blob 字段来存储仪器读数的一维数组。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:03:05.030

假设您的意思是 SQL Server 映像，通常您会将其作为字节数组或可能作为流来获取。（您可以将字节数组包装在`MemoryStream`.）

您可以使用`BinaryReader`流或`BitConverter`字节数组来一次转换整数，或者使用`Buffer.BlockCopy`将数据从 a 复制`byte[]`到`int[]`.

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:54:13.813

我不完全确定你在问什么，但如果你想访问图像的内部位数据，这就是你的做法。

请注意以下事项：

我明确设置`PixelFormat`而不是使用`bmp.ImageFormat`. 如果我选择的格式与位图不兼容，这将引发异常，但至少我知道我得到了多少 bpp。

我将这些位锁定在`ImageLockMode.ReadOnly`模式中，因此我无法将这些位复制回图像中。如果我想*修改*图像中的位，我只需使用`ReadWrite`模式，然后在完成对位的操作后，将它们复制回`BitmapData`对象中，然后解锁`Bitmap`.

最后，我将数据复制了*两次*——第一次是作为 byte[] 数组，第二次是作为 Int32[] 数组。通常你只做一次，通常你使用一个字节数组。但是由于您特别提到了 int[]，所以我将两个示例都包括在内。

```
Bitmap bmp = new Bitmap("myimage.jpg");
BitmapData data = bmp.LockBits(new Rectangle(0, 0, bmp.Width, bmp.Height),
    ImageLockMode.ReadOnly,
    PixelFormat.Format32bppRgb);

// copy as bytes
int byteCount = data.Stride * data.Height;
byte[] bytes = new byte[byteCount];
System.Runtime.InteropServices.Marshal.Copy(data.Scan0, bytes, 0, byteCount);

// -- OR -- copy as ints
int wordCount = byteCount / 4;
Int32[] words = new Int32[wordCount];
System.Runtime.InteropServices.Marshal.Copy(data.Scan0, words, 0, wordCount);

bmp.UnlockBits(data); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T20:03:38.537

这似乎有效。我想知道它的便携性如何？

```
[TestMethod]
public void TestMethod1()
{
    int[] intArray = { 4, 8, 15, 16, 23, 42, 108, 342, 815, 1087, 6717 };

    byte[] inputBytes = new byte[intArray.GetLength(0) * 4];

    Buffer.BlockCopy(intArray, 0, inputBytes, 0, intArray.GetLength(0) * 4);

    int[] outputInts = new int[intArray.GetLength(0)];

    Buffer.BlockCopy(inputBytes, 0, outputInts, 0, intArray.GetLength(0) * 4);

    Assert.IsTrue(Enumerable.SequenceEqual(intArray, outputInts));

} 
```

# php - 如何从 audioscrobbler api 获取当前正在播放的歌曲？

> ID：717602
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:03:25.577
> 
>         
> 
> 标签：php, zend-framework, rest, last.fm

我正在使用 zend 框架从 audioscrobbler api 获取信息。响应格式如下：

```
 <recenttracks user="RJ">
  <track nowplaying="true">
    <artist mbid="2f9ecbed-27be-40e6-abca-6de49d50299e">Aretha Franklin</artist>
    <name>Sisters Are Doing It For Themselves</name>
    <mbid/>
    <album mbid=""/>
    <url>www.last.fm/music/Aretha+Franklin/_/Sisters+Are+Doing+It+For+Themselves</url>
    <date uts="1213031819">9 Jun 2008, 17:16</date>
    <streamable>1</streamable>
  </track>
  ...
</recenttracks> 
```

我正在访问这样的元素：

```
$track->name 
```

如何获得 nowplaying 价值？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:12:50.343

你可以试试这些：

```
$track['nowplaying'] 
```

或者：

```
$track->getAttrib('nowplaying') 
```

或者：

```
$attributes = $track->attributes();
echo $attributes['nowplaying'] 
```

我没有在任何地方的文档中看到它。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-06T00:35:55.487

根据[Zend Framework API 文档](http://framework.zend.com/apidoc/core/Zend_Service/Audioscrobbler/Zend_Service_Audioscrobbler.html#artistGetTopTracks)，您将获得一个 SimpleXML 对象。`SimpleXMLElement`您可以使用它的[attributes()](http://ch.php.net/manual/en/function.simplexml-element-attributes.php)方法读取 a的属性：

```
$track->attributes()->nowplaying
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-06T00:28:10.450

对这个主题不太了解（Audioscrobbler 协议除外），谷歌搜索似乎表明`$track->getAttribute("nowplaying")`应该可以解决问题。HTH。

# udpclient - 使用 Udp 连接接收数据报

> ID：717605
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:04:16.837
> 
>         
> 
> 标签：udpclient

为了通过 UDP 连接接收数据报，我创建了一个 UDPClient 类型的对象。

```
 receivedNotificationSock = new UdpClient(); 
```

但是一旦完成并使用接收方法：

```
 receivedHostNameBuffer=receivedNotificationSock.Receive(ref receivedNotificationIP); 
```

我收到一个异常，说我必须调用 bind 方法。但是 UDPClient 类中没有 bind 方法。如果可能的话，你们能否向我提供代码，说明应该采取哪些措施来克服这个异常。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2012-09-03T07:33:03.197

将端口号传递给 UDP 客户端的构造函数。

```
 receivedNotificationSock = new UdpClient(21000); 
```

您可能需要更改防火墙设置以允许绑定，尽管当您第一次在开发机器上运行它时通常会打开一个弹出窗口。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:12:51.840

你需要我想知道更多关于套接字的知识。

所有套接字都有一个端口号。首先，您创建一个套接字——它本身几乎没有用。它只是漂浮在那里。但是然后你绑定它——你给它分配一个端口号。  *现在*它很有用 - 现在您可以在其上发送和接收数据。

请记住，所有 UDP 通信都是由源的 IP 和端口以及目标的 IP 和端口的四元数据集定义的。新创建的套接字没有 IP 地址或端口；绑定给它一个IP地址和端口。

不幸的是，我不是 C# 程序员，所以我无法正确回答您的问题。但至少你知道*为什么*它很重要。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2012-05-25T01:08:57.130

对于 Socket proramming，您需要知道您需要在客户端和服务器端执行的系统调用序列。

如果您正在编写**客户端**：

1.  您打开一个带有`socket`呼叫的套接字。

2.  `connect`然后你通过调用连接到服务器端口

3.  一旦连接成功

4.  然后您使用 a `send`or`sendto`  或 a将请求发送到服务器`write`

5.  这会导致接收到您可以使用`receive`或读取的数据`read` 

**在服务器端**

1.  你创建一个`socket`

2.  `bind`它到一个`port` 

3.  使用`listen`. 有一种非阻塞的方式来监听连接以及`select`系统调用。

4.  建立连接后，您基本上可以读取请求并开始处理它。

这是 C# 中的一个示例，可能对您有用。

[http://www.developerfusion.com/article/3918/socket-programming-in-c-part-1/](http://www.developerfusion.com/article/3918/socket-programming-in-c-part-1/)

# visual-studio - 使 VisualStudio C# 在项目目录之外有文件/文件夹

> ID：717613
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-04-04T19:09:12.647
> 
>         
> 
> 标签：visual-studio

我正在尝试提出一个设置，我可以在其中生成一个 Visual Studio 解决方案 + 项目文件，它引用存储 .sln 和 .csproj 的文件夹“外部”的文件和文件夹。

*和*（catch :)），我需要用你右键单击文件夹创建的新文件，并说“新代码文件”要在右键单击的文件夹中生成，该文件夹位于 .sln 文件夹之外。

真的不能做吗？

PS旁注：想要这样做的原因是.cs文件实际上是由不同的程序使用的，还有很多其他文件，我不想要.sln、.csproj、.ReSharper、.suo etc 文件使我的目录混乱。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T19:12:05.913

添加为链接

[http://msdn.microsoft.com/en-us/library/9f4t9t92(VS.80).aspx](http://msdn.microsoft.com/en-us/library/9f4t9t92(VS.80).aspx)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2013-01-14T07:43:07.273

对于任何感兴趣的人，可以在解决方案资源管理器中拥有一个“链接”文件夹，而不仅仅是链接文件出现在解决方案的根目录上。在 csproj/vbproj 文件中包含以下内容。

```
 <ItemGroup>
    <None Include="..\MyFolder\*.*">
      <Link>MyFolder\A\</Link>
    </None>
  </ItemGroup> 
```

这将包括项目上一级“MyFolder”目录中的所有文件。“A”可以被称为任何东西，但必须存在才能使文件夹出现在解决方案资源管理器中。不幸的是，使用此技术您无法从 IDE 添加新文件，因为它们将被添加到项目目录中的同名文件夹而不是链接目录中。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-06-03T08:46:05.650

你可以阅读我的帖子，这可能会有所帮助：
 http: [//ko-sw.blogspot.com/2009/06/reusing-source-files-in-multiple-visual.html](http://ko-sw.blogspot.com/2009/06/reusing-source-files-in-multiple-visual.html)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T04:23:41.783

也许[fsutil 硬链接创建](http://technet.microsoft.com/en-us/library/cc788097.aspx)？

拥有一个能在 VS 项目目录中搜索并为在“其他”目录中找到的每个 .cs 文件创建硬链接的 powershell 脚本并不难。您可以将其设置为每小时、每晚、按需运行，等等。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-20T10:53:30.567

fsutil 硬链接创建 == [http://dotnet-snippets.de/dns/hardlink-erstellen-SID355.aspx](http://dotnet-snippets.de/dns/hardlink-erstellen-SID355.aspx) 

```
[DllImport("kernel32.dll", EntryPoint="CreateHardLinkA", CharSet=CharSet.Ansi, SetLastError=true, ExactSpelling=true)]
private static extern long CreateHardLink(string lpFileName, string lpExistingFileName, IntPtr lpSecurityAttributes);

public void CreateHardLink(String sourcePath, string destPath) {
    CreateHardLink(destPath, sourcePath, IntPtr.Zero);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2015-05-08T18:55:49.530

我找到的解决方案是安装 Visual Assist 扩展，它允许添加相对于目录或当前打开的文件的文件。

请参阅我[之前的帖子](https://stackoverflow.com/a/30130779/1937742)以获取更多说明。

* * *

## 回答 #7

> 赞同：-2
> 
>             
> 
> 时间：2009-04-17T07:41:39.603

感谢大家的意见。看起来我想要的东西在这个时候是不可能的。真可惜。

# c - 通过多个函数通过引用传递

> ID：717614
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-04T19:09:56.823
> 
>         
> 
> 标签：c, pointers

大家好。我正在为学校做一个项目，我需要通过多个函数通过引用传递一些参数。我了解如何通过引用从声明变量的位置传递给另一个函数，如下所示：

```
main() {
  int x = 0;
  int y = 0;
  int z = 0;

  foo_function(&x, &y, &z);
}

int foo_function(int* x, int* y, int* z) {
  *x = *y * *z;
  return 0;
} 
```

但是，我如何将 x、y 和 z 从 foo 函数传递到另一个函数？这样的事情给了我各种编译器警告。

```
int foo_function(int* x,  int* y, int* z) {
  *x = *y * *z;
  bar(&x, &y, &z);
  return 0;
}

int bar(int* x, int* y, int* z) {
  //some stuff
} 
```

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-04-04T19:12:42.077

只需使用：

```
bar(x, y, z); 
```

X、Y 和 Z 已经是指针 - 直接传递它们即可。

记住——指针是内存中的一个位置。位置不变。当您取消引用指针时（使用 *x = ...），您将在该位置设置值。但是当你将它传递给一个函数时，你只是传递了内存中的位置。您可以将相同的位置传递给另一个函数，它工作正常。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T19:12:52.387

你不需要做任何事情，它们已经是参考。

```
int foo_function(int* x,  int* y, int* z) {
  bar(x, y, z);
  return 0;
}

int bar(int* x, int* y, int* z) {
  //some stuff
} 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T19:13:17.907

在 foo_function 中 xy 和 z 已经是指针 (int*)，所以你可以做 bar(x, y, z)。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T19:14:27.937

```
int foo_function(int* x,  int* y, int* z) {
   *x = *y * *z;
   /* x, y and z are pointers to int
      &x, &y and &z are pointers to pointer to int
      bar expects pointers to int, so call bar as:
   */
   bar(x, y, z);
   return 0;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T19:15:26.360

C 没有通过引用传递的概念。参数总是按值传递。然而，当使用指针时，这个*值*实际上是一个指向你的实际值的指针。

但是你在做什么

```
foo_function(&x, &y, &z); 
```

实际上是在尝试获取指针的地址，这本质上是没有意义的（您将传递 an`int**`而不是 an `int*`）。

所以，

```
foo_function(x, y, z); 
```

将是正确的调用， as `x`，`y`并且`z`已经是指针，您不再需要制作指向链:)

# iis - IIS 7 Url 重写和两个域

> ID：717615
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-04T19:10:04.640
> 
>         
> 
> 标签：iis, iis-7, url-rewriting, url-rewrite-module

我正在写这个问题，在这个过程中，它迫使我更加努力地思考，我自己回答了这个问题，尽管我仍然不完全明白为什么它解决了它。

我在共享主机上有一个帐户，注册了 2 个域。我正在使用 Asp.Net 堆栈来运行一些东西，例如博客和我计划最终启动的另一个网站。我的两个域都指向根；第一个是我用来注册的原始文件，第二个是我添加的根域指针。这是我希望它的行为方式：

目录结构：

```
根 (www.domain1.com)
根 --\ 博客 (www.domain1.com/blog)
Root --\ Site2（如果 www.domain2.com 则应指向此处）
根 --\ Site2 --\ 垃圾 (www.domain2.com/junk)

```

现在，如果您输入 www.domain1.com 或 www.domain1.com/blog，它的行为符合预期，我对此很好。对于 www.domain2.com，我的重写规则配置如下（来自 web.config）：

```
<rule name="Domain2">
    <match url="(.*)(/)?" ignoreCase="false" />
    <conditions logicalGrouping="MatchAll">
        <add input="{HTTP_HOST}" pattern="(www\.)?domain2\.com" ignoreCase="false" />
    </conditions>
    <action type="Rewrite" url="/site2/{R:1}" />
</rule> 
```

如果主机是 domain2.com，则该规则应该匹配任何路径，选择请求资源的路径并正确格式化。因此，当有人在 IIS 中键入 www.domain2.com/junk/default.aspx 时，它会在用户不知道的情况下解析为 www.domain2.com/site2/junk/default.aspx。除非用户未在子文件夹中键入尾部斜杠，否则这*主要是按广告宣传的那样工作。*IE：

www.domain2.com (works) 

www.domain2.com/ (works) 

www.domain2.com/junk/ (works) 

www.domain2.com/junk (不工作！) IIS 7 在这里失去理智并格式化它就像 www.domain2.com/site2/junk 一样，因为会自动为尾部斜杠发出第二个请求并发生 404。  

因此，我将操作更新为：  

```
<action type="Rewrite" url="/site2/{R:1}/" /> 
```

这似乎已经解决了它，但是为什么 IIS 7 现在不吐出 www.domain2.com/junk2/default.aspx/ ？它怎么知道不向文档扩展名附加斜杠？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-25T19:19:08.427

www.domain2.com/junk 不起作用，因为您在匹配中添加了斜杠，但要匹配的实际 url 不包含它。它只包含“垃圾”。

您还需要添加：

`<rule name="Domain2" stopProcessing="true">` 

因此，如果找到匹配项，它不会评估其他规则。我怀疑您可能会发现让您感到困惑的是您设置的其他规则。

# c++ - 简单的服务器/客户端增强示例不起作用

> ID：717618
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T19:11:53.607
> 
>         
> 
> 标签：c++, boost, tcp, boost-iostreams

学习boost，并编译了他们的日间服务器客户端[示例](http://www.boost.org/doc/libs/1_35_0/doc/html/boost_asio/examples.html)。由于我不能使用示例中的端口 13，我只更改了服务器和客户端示例中的端口号。服务器运行正常，但客户端似乎没有连接，并且没有给出错误。

客户端的输入数据是“127.0.0.1”。

服务器：

```
#include <ctime>
#include <iostream>
#include <string>
#include <boost/asio.hpp>

using boost::asio::ip::tcp;

std::string make_daytime_string()
{
  using namespace std; // For time_t, time and ctime;
  time_t now = time(0);
  return ctime(&now);
}

int main()
{
  try
  {
    boost::asio::io_service io_service;

    tcp::endpoint endpoint(tcp::v4(), 8087);
    tcp::acceptor acceptor(io_service, endpoint);

    for (;;)
    {
      tcp::iostream stream;
      acceptor.accept(*stream.rdbuf());
      stream << "test" << make_daytime_string();
    }
  }
  catch (std::exception& e)
  {
    std::cerr << e.what() << std::endl;
  }

  return 0;
} 
```

和客户：

```
#include <iostream>
#include <string>
#include <boost/asio.hpp>

using boost::asio::ip::tcp;

int main(int argc, char* argv[])
{
  try
  {
    if (argc != 2)
    {
      std::cerr << "Usage: daytime_client <host>" << std::endl;
      return 1;
    }

    tcp::iostream s(argv[1], 8087);
    std::string line;
    std::getline(s, line);
    std::cout << line << std::endl;
  }
  catch (std::exception& e)
  {
    std::cout << "Exception: " << e.what() << std::endl;
  }

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2011-06-17T23:24:58.850

对我有用的是改变我创建端点的方式

```
tcp::endpoint( tcp::v4(), port ); 
```

到

```
tcp::endpoint( boost::asio::ip::address::from_string("127.0.0.1"), port ); 
```

第一种方法创建 0.0.0.0 的端点，它在 Mac OS X 上运行良好，但在 Windows（XP，使用 MSVC 2008 构建）上给出“无效”消息。

我不介意知道为什么有区别，但至少它有效。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:04:04.730

嗯，所有的作品都适用于 1_36 boost 版本和 msvc 2005 编译器。

检查您的防火墙设置。  

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:28:46.993

一些事情将有助于为您调试：

1.  你在运行什么平台

2.  您使用的是什么编译器，包括版本

3.  你用的是什么版本的boost

另外，要检查的一件事是服务器是否绑定到 127.0.0.1 或外部接口。尝试使用外部接口的 IP 地址而不是 127.0.0.1。在 windows 中使用 ipconfig 和在 linux 中使用 ifconfig 检查。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2010-10-01T14:43:15.037

port 选项接受一个字符串，可能是服务的名称，为“daytime”，然后会查找对应的端口，或者显式的端口，但必须是字符串：

tcp::iostream s(argv[1], "8087");

# c++ - 静态库多定义链接错误

> ID：717622
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:12:47.240
> 
>         
> 
> 标签：c++, linker-errors

所以我正在尝试构建一个小型 3D 引擎作为 VC++ 8.0 的练习。我有一个 MathLib 静态库和一个由我的 TestBed exe 链接的 Render 静态库。现在 Render 有两个类：Color 和 DXManager3D。颜色包括我来自 MathLib 的 Vector.h 很好，没有问题。

第二次我尝试在 DXManager3D 中包含 Vector.h，它让我大吃一惊，说符号被定义了两次，第二个定义被忽略（来自 lib 的警告）。我认为可能包括它两次会导致此问题，因此作为测试，我从 Color.h 中删除了 Vector.h 并将其留在 DXManager3D.h 中 - 同样的问题。我进行了三次检查，以确保我将所有东西都包裹在 ifndef 中以防止这种情况发生，所以我只能摸不着头脑。

> DXManager3D.obj : 警告 LNK4006: "public: __thiscall Math::Vector::Vector(void)" (??0Vector@Math@@QAE@XZ) 已在 Render.obj 中定义；第二个定义被忽略

真正让我困惑的是，当我将 Render.lib 与 TestBed 分开构建时，它不应该链接任何东西，因为它是一个静态库，对吧？我仍然收到多个符号定义警告。如果我在 main 中实例化 DXManager3D，我的警告就会变成错误。

> Render.lib(DXManager3D.obj) : error LNK2005: "public: __thiscall Math::Vector::Vector(void)" (??0Vector@Math@@QAE@XZ) 已经在 WinMain.obj 中定义

是的，我有 F1 的 LNK4006 和 LNK2005，而 MSDN 中的解决方案对我不起作用。抱歉，如果之前有人问过这个问题，我找不到任何可靠的东西来帮助我使用搜索功能。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T19:19:39.827

您的`Vector`ctor 是否在类定义之外的标题中定义？使其内联，然后改变

```
class Vector {
  public:
    Vector();
  // ...
}; 

Vector::Vector() {
   // ...
} 
```

到

```
class Vector {
  public:
  Vector() {}
  // ...
}; 
```

或使用明确的`inline`限定：

```
class Vector {
   public:
  Vector();
  // ...
}; 

inline Vector::Vector() {
   // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:17:27.820

看起来您的矢量类存在链接问题。根据您的信息，该类似乎被链接到任何包含头文件的库中。这是内部链接，您确实需要外部链接。

你能发布 Vector.h 的内容，或者至少是 Vector() 构造函数吗？这应该给我们一个线索来了解实际发生的事情。

链接： http: [//publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp ?topic=/com.ibm.xlcpp8a.doc/language/ref/cplr020.htm](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=/com.ibm.xlcpp8a.doc/language/ref/cplr020.htm)

**编辑**

根据您的评论，您似乎已经在类库之外的头文件中声明了所有函数。您应该将它们放入非头文件（例如 Vector.cpp 文件）。  

这将为您的程序提供适当的链接，并且您将能够在两个程序中包含 Vector.h。

# asp.net-mvc - ASP.NET MVC 404 错误处理

> ID：717628
> 
>         
> 
> 赞同：136
> 
>         
> 
> 时间：2009-04-04T19:13:25.053
> 
>         
> 
> 标签：asp.net-mvc, error-handling

> **可能重复：**
> 
>   [如何正确处理 ASP.NET MVC 中的 404？](https://stackoverflow.com/questions/619895/how-can-i-properly-handle-404-in-asp-net-mvc)

我已经[在 Asp.Net MVC (RC 5) 中的 404 Http 错误处理程序中](https://stackoverflow.com/questions/108813/404-http-error-handler-in-aspnet-mvc-rc-5)进行了概述的更改，但我仍然得到标准的 404 错误页面。我需要更改 IIS 中的某些内容吗？

* * *

## 回答 #1

> 赞同：376
> 
>             
> 
> 时间：2012-01-26T23:16:37.070

我已经研究**了很多**关于如何在 MVC *（特别是 MVC3）*中正确管理 404 的问题，恕我直言，这是我想出的最佳解决方案：

在 global.asax 中：

```
public class MvcApplication : HttpApplication
{
    protected void Application_EndRequest()
    {
        if (Context.Response.StatusCode == 404)
        {
            Response.Clear();

            var rd = new RouteData();
            rd.DataTokens["area"] = "AreaName"; // In case controller is in another area
            rd.Values["controller"] = "Errors";
            rd.Values["action"] = "NotFound";

            IController c = new ErrorsController();
            c.Execute(new RequestContext(new HttpContextWrapper(Context), rd));
        }
    }
} 
```

错误控制器：

```
public sealed class ErrorsController : Controller
{
    public ActionResult NotFound()
    {
        ActionResult result;

        object model = Request.Url.PathAndQuery;

        if (!Request.IsAjaxRequest())
            result = View(model);
        else
            result = PartialView("_NotFound", model);

        return result;
    }
} 
```

**编辑：**

如果您使用 IoC（例如 AutoFac），您应该使用以下方法创建控制器：

```
var rc = new RequestContext(new HttpContextWrapper(Context), rd);
var c = ControllerBuilder.Current.GetControllerFactory().CreateController(rc, "Errors");
c.Execute(rc); 
```

代替

```
IController c = new ErrorsController();
c.Execute(new RequestContext(new HttpContextWrapper(Context), rd)); 
```

*（选修的）*

**解释：**

我可以想到 6 种情况，其中 ASP.NET MVC3 应用程序可以生成 404。

由 ASP.NET 生成：

*   **场景一：** URL 与路由表中的路由不匹配。

由 ASP.NET MVC 生成：

*   **场景 2：** URL 匹配一个路由，但指定了一个不存在的控制器。

*   **场景 3：** URL 匹配一个路由，但指定了一个不存在的操作。

手动生成：

*   **场景 4：**一个动作通过使用 HttpNotFound() 方法返回一个 HttpNotFoundResult。

*   **场景 5：**一个动作抛出一个状态码为 404 的 HttpException。

*   **场景 6：**操作手动将 Response.StatusCode 属性修改为 404。

**目标**

*   **(A)**向用户显示自定义 404 错误页面。

*   **(B)**维护客户端响应上的 404 状态代码（对 SEO 特别重要）。

*   **(C)**直接发送响应，不涉及 302 重定向。

**解决方案尝试：自定义错误**

```
<system.web>
    <customErrors mode="On">
        <error statusCode="404" redirect="~/Errors/NotFound"/>
    </customErrors>
</system.web> 
```

此解决方案的问题：

*   不符合情景 (1)、(4)、(6) 中的目标 (A)。

*   不自动符合目标 (B)。它必须手动编程。

*   不符合目标 (C)。

**解决方案尝试：HTTP 错误**

```
<system.webServer>
    <httpErrors errorMode="Custom">
        <remove statusCode="404"/>
        <error statusCode="404" path="App/Errors/NotFound" responseMode="ExecuteURL"/>
    </httpErrors>
</system.webServer> 
```

此解决方案的问题：

*   仅适用于 IIS 7+。

*   不符合情景 (2)、(3)、(5) 中的目标 (A)。

*   不自动符合目标 (B)。它必须手动编程。

**解决方案尝试：带有替换的 HTTP 错误**

```
<system.webServer>
    <httpErrors errorMode="Custom" existingResponse="Replace">
        <remove statusCode="404"/>
        <error statusCode="404" path="App/Errors/NotFound" responseMode="ExecuteURL"/>
    </httpErrors>
</system.webServer> 
```

此解决方案的问题：

*   仅适用于 IIS 7+。

*   不自动符合目标 (B)。它必须手动编程。

*   它掩盖了应用程序级别的 http 异常。例如，不能使用 customErrors 部分、System.Web.Mvc.HandleErrorAttribute 等。它不能只显示通用错误页面。

**解决方案尝试 customErrors 和 HTTP 错误**

```
<system.web>
    <customErrors mode="On">
        <error statusCode="404" redirect="~/Errors/NotFound"/>
    </customError>
</system.web> 
```

和

```
<system.webServer>
    <httpErrors errorMode="Custom">
        <remove statusCode="404"/>
        <error statusCode="404" path="App/Errors/NotFound" responseMode="ExecuteURL"/>
    </httpErrors>
</system.webServer> 
```

此解决方案的问题：

*   仅适用于 IIS 7+。

*   不自动符合目标 (B)。它必须手动编程。

*   不符合情景 (2)、(3)、(5) 中的目标 (C)。

之前对此感到困扰的人甚至尝试创建自己的库（参见[http://aboutcode.net/2011/02/26/handling-not-found-with-asp-net-mvc3.html](http://aboutcode.net/2011/02/26/handling-not-found-with-asp-net-mvc3.html)）。但是之前的解决方案似乎涵盖了所有场景，而没有使用外部库的复杂性。

* * *

## 回答 #2

> 赞同：145
> 
>             
> 
> 时间：2009-04-04T20:04:56.553

又一个解决方案。

添加带有 404 错误信息的 ErrorControllers 或静态页面。

修改您的 web.config（如果是控制器）。

```
<system.web>
    <customErrors mode="On" >
       <error statusCode="404" redirect="~/Errors/Error404" />
    </customErrors>
</system.web> 
```

或者在静态页面的情况下

```
<system.web>
    <customErrors mode="On" >
        <error statusCode="404" redirect="~/Static404.html" />
    </customErrors>
</system.web> 
```

这将处理错过的路线和错过的动作。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2012-04-11T13:03:02.377

Marco 的回应是最好的解决方案。我需要控制我的错误处理，我的意思是真正控制它。当然，我稍微扩展了解决方案并创建了一个完整的错误管理系统来管理所有内容。我也在其他博客中读到过这个解决方案，大多数高级开发人员似乎都可以接受。

这是我正在使用的最终代码：

```
protected void Application_EndRequest()
    {
        if (Context.Response.StatusCode == 404)
        {
            var exception = Server.GetLastError();
            var httpException = exception as HttpException;
            Response.Clear();
            Server.ClearError();
            var routeData = new RouteData();
            routeData.Values["controller"] = "ErrorManager";
            routeData.Values["action"] = "Fire404Error";
            routeData.Values["exception"] = exception;
            Response.StatusCode = 500;

            if (httpException != null)
            {
                Response.StatusCode = httpException.GetHttpCode();
                switch (Response.StatusCode)
                {
                    case 404:
                        routeData.Values["action"] = "Fire404Error";
                        break;
                }
            }
            // Avoid IIS7 getting in the middle
            Response.TrySkipIisCustomErrors = true;
            IController errormanagerController = new ErrorManagerController();
            HttpContextWrapper wrapper = new HttpContextWrapper(Context);
            var rc = new RequestContext(wrapper, routeData);
            errormanagerController.Execute(rc);
        }
    } 
```

在我的 ErrorManagerController 里面：

```
 public void Fire404Error(HttpException exception)
    {
        //you can place any other error handling code here
        throw new PageNotFoundException("page or resource");
    } 
```

现在，在我的操作中，我抛出了我创建的自定义异常。我的控制器继承自我创建的基于控制器的自定义类。创建自定义基本控制器是为了覆盖错误处理。这是我的自定义基本控制器类：

```
public class MyBasePageController : Controller
{
    protected override void OnException(ExceptionContext filterContext)
    {
        filterContext.GetType();
        filterContext.ExceptionHandled = true;
        this.View("ErrorManager", filterContext).ExecuteResult(this.ControllerContext);
        base.OnException(filterContext);
    }
} 
```

上面代码中的“ErrorManager”只是一个使用基于 ExceptionContext 的模型的视图

我的解决方案完美运行，我能够处理我网站上的任何错误并根据任何异常类型显示不同的消息。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T20:02:03.393

看起来这是捕捉一切的最佳方式。

[如何正确处理 ASP.NET MVC 中的 404？](https://stackoverflow.com/questions/619895/how-can-i-properly-handle-404s-in-asp-net-mvc)

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:33:16.737

在 IIS 中，您可以根据错误代码指定重定向到“特定”页面。在您的示例中，您可以配置 404 -> 您自定义的 404 错误页面。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:43:47.740

我可以推荐的是查看FilterAttribute。例如 MVC 已经有 HandleErrorAttribute。您可以将其自定义为仅处理 404。如果您感兴趣，请回复我会看示例。

顺便提一句

您在上一个问题中接受的解决方案（最后一条路线）在大多数情况下都不起作用。**使用HandleUnknownAction**的第二种解决方案将起作用，但需要在每个控制器中进行此更改或具有单个基本控制器。

我的选择是使用 HandleUnknownAction 的解决方案。

# c++ - 是否有独立于操作系统的方式来轮询 TOTAL 和/或 USED 视频内存？

> ID：717636
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T19:17:41.627
> 
>         
> 
> 标签：c++, os-agnostic

我正在寻找一种方法来轮询显卡/集成芯片组上的总视频内存。

我知道 Windows 下的 WMI 辅助轮询，据我所知，WMI 在每次启动时都会构建信息。但是，作为一个乐观主义者，我正在寻找一种可能的独立于操作系统的方式来轮询总视频内存和可用或已用视频内存。

如果不可能，那么在 Windows、Linux 和 OSX 下最优雅的轮询方式是什么？

仅供参考，我不在 Windows 下使用 DirectX，只使用 OpenGL。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:23:58.660

没有简单的跨平台方法可以做到这一点。您必须为每个平台编写自己的代码，或者使用第三方库（如[SDL](http://www.libsdl.org/)）为您完成。例如，使用 SDL，您可以使用`video_mem`返回值 from 的成员[`SDL_GetVideoInfo()`](http://www.libsdl.org/cgi/docwiki.cgi/SDL_GetVideoInfo)来获取可用的总视频内存。

# c# - 使用 sql server 以 aspx 形式动态获取表名

> ID：717637
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:19:12.043
> 
>         
> 
> 标签：c#, sql, sql-server, sql-server-2005, tsql

我试图根据满足的条件动态接受表名，列名也是动态选择的，比较值也是如此，但是在运行它时出现错误。我正在用 C# 编写这段代码，我的后端是 SQL server 2005。请帮助我。

这是代码：

```
 if( table=="studenttab")

                   table = "personal_detail";

               thisconnection1.Open();

               string p = field[0].ToString().ToLower();

               string q = code[0].ToString();

           SqlCommand thiscommand3 = thisconnection1.CreateCommand();

           thiscommand3.CommandText = " Select * from '" + table + "' where '" + p + "' = '" + q + "' ";

           // here it gives error "Incorrect syntax near 'personal_detail'." Dont understand!

           SqlDataReader thisreader3 = thiscommand3.ExecuteReader(); 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T19:44:19.817

要回答您的具体问题，我猜该错误是由于您使用单引号将表名和列名括起来。您的对象名称不应被任何类型的引号包围。

作为旁注，请查看与 SQL 注入攻击相关的问题。您在此处执行的那种 SQL 连接被广泛认为存在巨大的安全风险。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T19:41:45.623

您的代码缺少几个右大括号、一个右引号，而且它似乎有误导性的缩进。

# .net - 请建议.Net Job/Task Queue

> ID：717638
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-04T19:19:37.550
> 
>         
> 
> 标签：.net, queue, scheduled-tasks

我需要建立一个处理数据的服务网络。每个服务都需要自己的任务队列。初步我将需要 QueueTask、CancelTask​​、StopTask、GetTaskStatus 和 GetTaskProgress 等操作。

我正在寻找任务队列的框架或完全构建的实现。

此时我知道一些选择：

**MSMQ** - 可以满足我的需求，但需要太多编码才能获得支持。

**Castle.Shediling** - 调度解决方案。它提供了可插入的触发器，我可以实现它来满足我的需求。但是仍然有太多的编码。

**ServiceBUS** - 例如**MassTransit**。但是，我不确定它们如何支持长队列并且仍然需要管道代码。

一个理想的解决方案将是提供任务队列托管的框架。那将能够重新启动而不会丢失任务。这将可以从网络访问，例如作为 SOAP 端点。

问题实际上是你用什么，为什么？你建议使用什么？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-12T12:56:09.033

嗯，听起来好像您将不得不编写一些管道，尤其是通过 SOAP 将任务队列公开给外部世界。

我建议看：

*   [Udi Dahan's - NServiceBus](http://www.nservicebus.com)

*   [Oren Eini's - Rhino 服务巴士](https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/esb/)

两者都是 .NET 框架和 MSMQ 上的开源服务总线实现。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-09T15:25:03.067

还有来自 Apache 组织的[ActiveMQ 。](http://activemq.apache.org/)它有很多很好的跨平台/语言支持，而且是免费的！

在商业领域，还有具有良好 Java/C# 绑定的[Tibco EMS](http://www.tibco.com/software/messaging/enterprise_messaging_service/default.jsp)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-12T13:04:15.907

也许您正在寻找 CONTROL-M 之类的东西？

[http://en.wikipedia.org/wiki/CONTROL-M](http://en.wikipedia.org/wiki/CONTROL-M)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-10-30T03:02:18.187

好吧，我也许正在经历类似的过程。抱歉，这不是一个答案，但可能从上下文的角度来看。

我有一种情况，Web 应用程序将允许用户为设计上传图像。问题是我显然需要处理初始上传，然后将图像的实际过程排队。例如，我需要：

1.  创建主要图像的缩放缩略图，以及一些水印等

2.  将实际图像发送到 Amazon S3 存储单元。

3.  更新一些日志/通知等。

再一次，我立刻想到了以前在金融领域工作的 MSMQ 和 IBM-MQseries，而且因为我使用的是 SQL 2008 R2，我注意到它也有（可能有一段时间！）排队机制。

所以我有点在同一条船上试图找到正确的选择！  

感谢到目前为止的回复..将检查一些解决方案，但同样，任何其他想法将不胜感激

# kernel - 将内核映像从 ELF 转换为 PE

> ID：717641
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T19:21:15.940
> 
>         
> 
> 标签：kernel, elf, msys, portable-executable, multiboot

我正在使用 Msys 构建我在 Linux 下编写的 home brew 内核。Linux 使用 ELF 作为其二进制格式，而 Msys 使用 PE。我有源设置以允许 Grub 使用 Multiboot 规范启动它。在构建结束时，我得到一些未定义的符号：

```
init.o:init.S:(.text+0x14): undefined reference to `edata'

main.o:main.c:(.text+0x121): undefined reference to `_alloca'

main.o:main.c:(.text+0x126): undefined reference to `__main'

../../lib\libkern.a(mem.o):mem.c:(.text+0x242): undefined reference to `_end'

../../lib\libkern.a(mem.o):mem.c:(.text+0x323): undefined reference to `_end' 
```

这些似乎是面向 ELF 的符号。如果有人可以建议我如何在 PE 世界中处理这些问题，例如，如果有等价物，那将对我有很大帮助！

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T22:07:57.340

有一些工具可以转换不同的目标文件格式，但它们可能无法满足您的需求。

我假设您需要将编译器 (gcc) 配置为交叉编译器，以便为您的 Msys 环境生成正确的格式。

# algorithm - 最长简单路径

> ID：717642
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-04-04T19:21:47.247
> 
>         
> 
> 标签：algorithm, language-agnostic, computer-science, graph-theory, theory

所以，我理解在图中找到最长简单路径的问题是 NP-hard，因为您可以通过将边权重设置为 1 并查看最长简单路径的长度是否等于边缘。

我的问题是：如果你画一个图，找到最大边权重，`m`用 替换每个边权重`w`，`m - w`然后运行标准最短路径算法，你会得到什么样的路径？这显然不是最长的简单路径，因为如果是，那么 NP = P，我认为类似的证明会更复杂一些 =P。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T20:15:22.347

如果你可以用负权重解决最短路径问题，你会发现一条最长路径，两者是等价的，这可以通过将权重 -w 而不是 w 来完成

负权重的标准算法是[Bellman-Ford](http://en.wikipedia.org/wiki/Bellman-Ford_algorithm)算法。但是，如果图中存在一个循环使得边的总和为负，则该算法将不起作用。在您创建的图表中，所有此类循环的总和权重均为负，因此该算法将不起作用。当然，除非你没有循环，在这种情况下你有一棵树（或一片森林）并且问题可以通过动态编程来解决。

如果我们用 mw 代替 w 的权重，保证所有的权重都是正的，那么可以通过标准算法找到最短路径。如果该图中的最短路径 P 有 k 条边，则长度为 k*mw(P)，其中 w(P) 是具有原始权重的路径的长度。这条路径不一定是最长的一条，然而，在所有有 k 条边的路径中，P 是最长的一条。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-23T20:11:38.697

[替代文字 http://dl.getdropbox.com/u/317805/path2.jpg](http://dl.getdropbox.com/u/317805/path2.jpg)

使用您的算法将上图转换为下图。

最长路径是上图中的红线。根据打破关系的方式和您使用的算法，转换图中的最短路径可能是蓝线或红线。因此，使用您提到的常数转换图边权重不会产生显着的结果。这就是为什么无论你多么聪明，使用最短路径算法都无法找到最长路径的原因。一个更简单的转换可能是否定所有边缘权重并运行算法。我不知道我是否回答了您的问题，但就路径属性而言，转换后的图没有任何有关距离的有用信息。

但是，这种特殊的转换在其他领域很有用。例如，如果您有多个约束，则可以通过添加一个巨大的常数来强制算法在二重匹配中选择特定的边权重。

*   编辑：我被告知要添加以下声明：上图不仅仅是关于物理距离。他们不需要持有三角不等式。谢谢。

# c# - .net 应用程序多线程

> ID：717643
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-04T19:21:52.130
> 
>         
> 
> 标签：c#, multithreading

我有一个多核 cpu，但我编写的 .net 应用程序只使用其中一个内核。当该选项可用时，我如何使其使用多个核心。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T19:23:35.527

这不是免费发生的。使用多个内核需要使用多个线程。您必须为程序显式添加线程支持才能同时使用多个内核。

[这是一篇很棒的文章，探讨了如何使用任务并行库（也称为并行扩展框架](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en)）来利用托管代码的多核。

[http://msdn.microsoft.com/en-us/magazine/cc163340.aspx](http://msdn.microsoft.com/en-us/magazine/cc163340.aspx)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T19:41:42.863

您可以尝试 JaredPar 提到的[Microsoft Parallel Extensions to .NET Framework 3.5](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en#filelist)，或者自己创建程序的多线程版本。

我想在这里添加一个更具体的示例，说明将现有程序中的“for-loop”转换为使用并行扩展中的 System.Threading.Parallel 是多么容易。对于检查 0 到 之间的每个素数的 for 循环`maxnum`：

```
System.Threading.Parallel.For(0, maxNum + 1, x => IsPrime(x)); 
```

容易，不是吗？

我还对从 System.Parallel 获得的性能改进进行了简单的基准测试。[如果我在此处](http://m3rlinez.blogspot.com/2009/03/net-parallel-computation-made-easy.html)发布指向我的博客的链接，我希望 SO 同行不介意。

![替代文字](https://1.bp.blogspot.com/_5XDoB4MglkY/Sb_XJ0xA6qI/AAAAAAAAFPc/ZoSkny8tmCE/s400/Benchmark.png)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-06T15:16:28.240

@JaredPar 给出了一个[很好的答案](https://stackoverflow.com/questions/717643/-net-application-multi-threading/717645#717645)。但是，在某些情况下，我们可能不值得将代码重写为多线程。多线程代码更复杂，并添加了一大堆额外类型的错误来解决。

然而，在桌面应用程序的简单情况下，有时值得让双核机器的第二个核心空闲，以便操作系统可以使用它来执行诸如为其他应用程序重绘屏幕、运行病毒扫描程序、等等

不是您特别想听到的答案，但在某些情况下是务实的。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2012-10-11T07:50:31.613

将您的时间密集型作业分派给多个线程。

multitrheading 的建议方法是使用 ThreadPool。

来自 MSDN 的 ThreadPool 示例：

```
using System;
using System.Threading;
public class Example {
    public static void Main() {

        // Queue the task.
        ThreadPool.QueueUserWorkItem(new WaitCallback(ThreadProc));

        Thread.Sleep(1000);

        Console.WriteLine("Main thread exits.");
    }

    // This thread procedure performs the task. 
    static void ThreadProc(Object stateInfo) {

        // No state object was passed to QueueUserWorkItem, so  
        // stateInfo is null.
        Console.WriteLine("Hello from the thread pool.");
    }
} 
```

# regex - 不包含特定字符串的正则表达式

> ID：717644
> 
>         
> 
> 赞同：83
> 
>         
> 
> 时间：2009-04-04T19:22:39.273
> 
>         
> 
> 标签：regex, regex-negation

我有这样的东西

> 阿巴布卡布达

为了选择由**a**包裹的最小组，我有这个`/a([^a]*)a/`，它工作得很好

**但是我对由aa**包裹的组有问题，我需要类似 
`/aa([^aa]*)aa/`的东西不起作用，而且我不能使用第一个 like `/aa([^a]*)aa/`，因为它会在第一次出现时结束**a**，我不想要.

一般来说，有什么办法可以说不***包含字符串***，就像我可以说不***包含字符***一样`[^a]`？

简单地说，我需要***aa****后跟除序列**aa**之外的任何字符，然后以**aa结尾***

* * *

## 回答 #1

> 赞同：217
> 
>             
> 
> 时间：2010-03-05T13:39:50.977

借助Google 的力量，我找到[了 2007 年的一篇博](http://bloggernitin.blogspot.com/2007/12/regex-for-doesnt-contain.html)文，其中给出了以下匹配**不**包含特定子字符串的字符串的正则表达式：

```
^((?!my string).)*$ 
```

它的工作原理如下：它查找零个或多个 (*) 字符 (.)，这些字符 (.) 不以您的字符串开头 (?! - 负前瞻)，并规定整个字符串必须由这些字符组成 (通过使用 ^和 $ 锚）。或者换一种说法：

整个字符串必须由不以给定字符串开头的字符组成，这意味着该字符串不包含给定的子字符串。

* * *

## 回答 #2

> 赞同：19
> 
>             
> 
> 时间：2009-04-04T19:30:55.197

一般来说，编写一个**不**包含特定字符串的正则表达式是很痛苦的。我们必须为计算模型执行此操作 - 您采用 NFA，它很容易定义，然后将其简化为正则表达式。不包含“猫”的事物的表达式大约有 80 个字符长。

编辑：我刚刚完成，是的，它是：

```
aa([^a] | a[^a])aa 
```

[这](http://www.seas.upenn.edu/~cit596/notes/dave/regexp-nfa4.html)是一个非常简短的教程。我以前发现了一些很棒的，但我再也看不到它们了。

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2009-04-05T07:32:50.500

您只需要一个不情愿的量词：

```
regex: /aa.*?aa/

aabbabcaabda   => aabbabcaa

aaaaaabda      => aaaa

aabbabcaabda   => aabbabcaa

aababaaaabdaa  => aababaa, aabdaa 
```

您也可以使用负前瞻，但在这种情况下，它只是完成同一件事的一种更冗长的方式。此外，它比 gpojd 看起来要复杂一些。在允许点使用下一个字符之前，必须在每个位置应用前瞻。

```
/aa(?:(?!aa).)*aa/ 
```

至于 Claudiu 和 finnw 建议的方法，当哨兵字符串只有两个字符长时它可以正常工作，但是（正如 Claudiu 承认的）对于较长的字符串来说太笨拙了。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T19:24:20.363

```
/aa([^a]|a[^a])*aa/ 
```

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2014-11-21T11:27:02.157

我不确定它是一个标准构造，但我认为你应该看看“负前瞻”（写：“？！”，不带引号）。它比该线程中的所有答案（包括已接受的答案）要容易得多。

示例：正则表达式：“^(?!123)[0-9]*\w” 捕获任何以数字开头的字符串，后跟字母，除非“这些数字”是 123。

[http://msdn.microsoft.com/en-us/library/az24scfc%28v=vs.110%29.aspx#grouping_constructs](http://msdn.microsoft.com/en-us/library/az24scfc%28v=vs.110%29.aspx#grouping_constructs) 
（微软页面，但非常全面）用于前瞻/后视

PS：它对我很有效（.Net）。但是，如果我在某些方面有误，请告诉我们。我发现这个结构非常简单有效，所以我对接受的答案感到惊讶。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2012-11-22T12:18:51.067

我必须替换以下代码，将 GET 参数添加到对 JS 文件的所有引用，除了一个。

```
<link rel="stylesheet" type="text/css" href="/login/css/ABC.css" />
<script type="text/javascript" language="javascript" src="/localization/DEF.js"></script>
<script type="text/javascript" language="javascript" src="/login/jslib/GHI.js"></script>
<script type="text/javascript" language="javascript" src="/login/jslib/md5.js"></script>
sendRequest('/application/srvc/EXCEPTION.js', handleChallengeResponse, null);
sendRequest('/application/srvc/EXCEPTION.js",handleChallengeResponse, null); 
```

这是使用的匹配器：

```
(?<!EXCEPTION)(\.js) 
```

这样做是查找所有出现的“.js”，如果它们前面有“EXCEPTION”字符串，则从结果数组中丢弃该结果。这就是所谓的消极回顾。因为我花了一天的时间来找出如何做到这一点，所以我想我应该分享一下。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2011-12-01T19:17:13.187

```
".*[^(\\.inc)]\\.ftl$" 
```

在 Java 中，这将找到所有以“.ftl”结尾但不以“.inc.ftl”结尾的文件，这正是我想要的。

# eclipse - 在 Emacs 中使用 JDE，我想要类似 Eclipse 的运行配置

> ID：717646
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T19:23:49.380
> 
>         
> 
> 标签：eclipse, emacs, jde

我正在使用 JDE 编写一个更大的项目。来自 Eclipse，我想念运行配置。基本上，我想在项目中启动几个不同的类。其中一些是小程序，一些是具有主要方法的常规类。我还希望能够为它们指定不同的运行时参数。

基本上，是这样的：

```
run_config_1
  小程序：假
  主类：package1.subpackage1.ClassX
  参数：arg1 arg2

运行配置_2
  小程序：真
  主类：package1.subpackage1.AppletClassX
  论据：

ETC ...

```

然后我可以即时切换配置，测试项目的不同部分。那么对于 JDE 来说有这样的东西吗？还是我必须自己写？如果是这样的话，我想要一些关于我应该采取的总体方向的指示。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T00:35:06.107

您是否查看过 JDE 中已有的内容？[例如http://jdee.sunsite.dk/jdedoc/html/jde-ug/jde-ug.html](http://jdee.sunsite.dk/jdedoc/html/jde-ug/jde-ug.html)上的“运行 Java 应用程序” ？

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-07-30T00:01:27.023

您确实可以切换配置：为此使用“项目文件”。在项目文件中可以记录您当前的 JDE 设置。您可以根据自己的喜好设置 java compile 和 run 的参数。开始`jde-create-new-project`。您需要为每个配置（=项目文件）设置新目录。

这里是一个生成的示例项目文件

```
(jde-project-file-version "1.0")
(jde-set-variables
 '(jde-project-name "mysample")
 '(jde-run-option-application-args (quote ("-v" "mydir")))
 '(jde-run-read-app-args t)) 
```

# c# - 是否可以从 Web 服务运行可执行文件？

> ID：717657
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T19:30:22.687
> 
>         
> 
> 标签：c#, web-services, exe

我有一个 Web 服务，我想从其中调用一个 .exe 文件。  

这可能吗？如果是这样，它是如何完成的？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T20:03:21.580

我已经用 WCF 完成了 c# 3.5。您可以从 Web 服务运行 exe。该 exe 将在服务所在的机器上运行，并且用户已配置了服务。您只需要编写一个普通的[Process.Start(...)](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)代码。

所以答案是肯定的，当然，exe 将在 Web 服务主机而不是客户端上运行。如果您需要更多详细信息，请在您的问题中更具体。

# graphics - GMA 950 硬件的寄存器级编程

> ID：717662
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:31:34.853
> 
>         
> 
> 标签：graphics, driver, intel, cpu-registers

我正在尝试为 GMA 950 硬件编写基本驱动程序。我一直在寻找数据表或一些编程指南，但找不到任何东西。我还查看了 Linux 和 FreeBSD 源代码，但它们非常大，需要时间才能理解。GMA 950 与 Intel 945 Express 芯片组相关联。有谁知道我可以为 950 和/或 945 编写硬件寄存器级代码的好文档？

谢谢，调频

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:43:47.803

我不确定这是否正是您要寻找的，因为它看起来仅适用于 i965，但[英特尔 Linux 图形文档](http://intellinuxgraphics.org/documentation.html)可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2018-10-08T21:27:57.090

[英特尔® 945G/945GZ/945GC/945P/945PL Express 芯片组系列](https://www.intel.com/Assets/PDF/datasheet/307502.pdf)数据表应该是您需要的一切（至少，即使根据芯片组开发套件手册）

GMA 寄存器在第 173 页。

# amazon-s3 - 使用 amazon s3，使用他们的服务器上传文件，但 URL 应该来自我的

> ID：717663
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T19:31:47.677
> 
>         
> 
> 标签：amazon-s3

是否可以使用他们的服务器将文件上传到亚马逊 S3（即我的服务器不应该在上传过程中使用）？

我还希望 URL 似乎正在上传到我的服务器，这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T19:40:18.983

[在此处](http://docs.amazonwebservices.com/AmazonS3/latest/dev/VirtualHosting.html#VirtualHostingCustomURLs)查看有关如何设置 CNAME 记录的说明，以便您的子域之一可以成为 Amazon S3 存储桶的别名。

*根据您的需要，您可能不希望“s3.amazonaws.com”出现在您的网站或服务上。例如，如果您在 Amazon S3 上托管您网站的图像，您可能更喜欢[http://images.johnsmith.net/](http://images.johnsmith.net/)而不是[http://johnsmith-images.s3.amazonaws.com/](http://johnsmith-images.s3.amazonaws.com/)*

# forums - 哪些是程序员最好的专用邮件列表/论坛？

> ID：717666
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:37:30.517
> 
>         
> 
> 标签：forums, user-forums

除了（和之前）Stack Overflow 之外，还有很多面向程序员的专用邮件列表和论坛。

在我的例子中，有 Tomcat 邮件列表（即 users@tomcat.apache.org）、mysql 邮件列表（即 mysql@lists.mysql.com）和 java.sun.com 上的许多论坛。然后是那些用于更多特定于硬件的任务（如用于 NSLU2 的任务等）。

这些列表的好处是问题特定于平台（即 Tomcat、MySql、NSLU2 等），并且往往有大量专家和开发人员。

除了 Stack Overflow，您订阅和/或使用最频繁的还有哪些？

-理查德

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-10-09T05:03:12.560

这里有一系列列表：http: [//www.codify.com/lists](http://www.codify.com/lists)，很多澳大利亚 .net（和相关）程序员都在上面。多年来一直在那里; 这很有趣:)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T20:27:50.770

我使用[Daniweb.com](http://www.daniweb.com/)，它拥有相当丰富的用户群。回答问题的效率不如这里，但它是编程和一般 IT 帮助的好资源。

# php - 如何调整已经使用 Magickwand(PHP)/ImageMagick 上传的图像的大小？

> ID：717668
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:37:40.160
> 
>         
> 
> 标签：php, imagemagick

我正在构建用户上传所有图像的画廊。我最初尝试使用 GD，但发现它在处理来自数码相机的图像时使用了太多内存。所以我一直在研究 ImageMagick 并遇到了这个问题。  

我的最终目标是调整图像大小然后上传。我不确定 ImageMagick 是否可行。我已经让它在上传后调整图像大小，但它不保存调整大小的图像，只是原始大小。

这是我目前使用的代码：（$image 是我服务器上文件的路径）

```
$resource = NewMagickWand(); 
MagickReadImage($resource,$image); 
MagickSetImageCompressionQuality( $resource, 100);
$resource = MagickTransformImage($resource,'0x0','660x500'); 
```

任何输入将不胜感激，

列维

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:39:23.833

您的代码会将修改后的图像发送到客户端（Web 浏览器），但不会将其保存到服务器（例如，替换原始图像）

要保存图像，请使用：

```
MagickWriteImage( $resource, 'new_image.jpg' ); 
```

# language-design - 可变或不可变闭包

> ID：717669
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T19:38:20.063
> 
>         
> 
> 标签：language-design, closures, immutability, mutable

在命令式、面向对象的语言中，具有可变或不可变闭包是否更有意义？

例如：

```
int i=5;
function() f={print(i);};
f();
i=6;
f(); 
```

如果闭包是可变的，这将打印：

```
5
6 
```

如果它是不可变的，它将打印：

```
5
5 
```

我意识到即使使用不可变的闭包，您仍然可以这样做：

```
class I {int i;}
I i=new I();
i.i=5;
function() f={
    I j=i;
    print(j.i);
};
f();
i.i=6;
f(); 
```

那么，拥有可变闭包或不可变闭包会更好，还是两者都有选择？不可变闭包似乎更容易实现，所以在这一点上，我想我会继续这样做，除非有充分的理由不这样做。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T19:42:27.400

命令式语言通常是围绕状态的概念构建的。因此，语言特性更有意义地反映这一点，包括闭包。是的，这种行为有时会令人困惑，但它是问题的一部分，也是在应用程序中拥有状态的优势。  

我认为这个论点的最好证明是看看一些最近支持闭包的语言。C# 和 VB.Net，命令式 OO 语言，都选择了可变闭包。而 F#，一种函数式语言，具有不可变的闭包（主要源于 F# 默认情况下不可变的想法）。  

另外，在命令式语言中具有不可变闭包实际上意味着什么？大多数人认为这是使变量等效于 C# 的只读。当然值类型会被保护不被修改，但是可变引用类型呢。您将无法更改变量指向的位置，但您可以调用变异函数并获得类似的效果。例如。

```
class Student {
  public string Name { get; set; }
}

void Example() {
  var student = new Student() { Name = "foo" };
  Action() del = () => 
    { student.Name = "bar"; };
  del();
} 
```

这可以通过不可变闭包来实现，因为我实际上并没有修改变量指向的位置。但是，我显然仍在进行变异操作。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T19:47:09.683

语言是否应该具有按值捕获或按引用捕获的 lambda？自己决定，但请参阅“[关于 lambdas、捕获和可变性](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!689.entry)”以获得更多评论。

# ruby - 如何通过 ruby 脚本从 Web 服务器请求压缩页面？

> ID：717672
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T19:40:19.280
> 
>         
> 
> 标签：ruby, http, compression, gzip

我有一个 ruby​​ 脚本，它可以保存来自各个站点的网页，我如何确保它检查服务器是否可以发送 gzip 压缩文件并在可用时保存它们......任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-13T18:57:30.013

可以将自定义标头作为哈希发送...

```
custom_request = Net::HTTP::Get.new(url.path, {"Accept-Encoding" => "gzip"}) 
```

然后，您可以通过将响应对象定义为来检查响应：

```
response = Net::HTTP.new(url.host, url.port).start do |http| 
http.request(custom_request) 
end 

p [response['Content-Encoding'] 
```

感谢那些回答的人...

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T19:47:46.500

您需要在请求中发送以下标头：

```
Accept-Encoding: gzip,deflate 
```

但是，我仍在阅读如何编写 ruby​​ 代码并且不知道如何在 net/http 库中执行标头语法（我假设您正在使用它来发出请求）

编辑：实际上，根据[ruby​​ 文档](http://ruby-doc.org/core-1.9/classes/Net/HTTP.src/M003948.html)，如果您不指定其他“接受编码”标头，则此标头是发送的默认标头的一部分。

再说一次，就像我在原来的答案中所说的那样，我仍然只是在阅读这个主题，所以我可能是错的。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T04:23:06.743

对于抓取网页并使用它们进行处理，[ScrubyIt](http://scrubyt.org/ "ScrubyIt")非常棒。

# css - Webkit 浏览器不显示背景图像/填充？

> ID：717675
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:41:26.030
> 
>         
> 
> 标签：css, image, webkit, background

我们的网站 www.tonerize.com 在页面顶部中心的蓝色菜单方面存在问题。在 IE / Firefox / 大多数浏览器中，菜单正确显示并具有背景图像。

但是，在基于 Webkit 的浏览器（Chrome、Safari 等）中，菜单没有背景，并且似乎没有使用填充。这有什么原因吗？

* * *

## 回答 #1

> 赞同：-1
> 
>             
> 
> 时间：2009-04-04T20:07:37.217

我们想通了。Webkit 不喜欢 CSS 中的标签，其他浏览器显然忽略了这些标签。

# c# - 从列表框中删除项目时，对于每个循环不起作用

> ID：717681
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-04T19:43:37.837
> 
>         
> 
> 标签：c#, .net, asp.net

为什么我不能使用 foreach 循环从列表框中删除项目：

```
 protected void btnRemove_Click(object sender, EventArgs e)
        {
            ListBox listbox = Controltest2.FindControl("ListBox1") as ListBox;
            if (Controltest2.Items.Count > 0)
            {
                foreach (ListItem li in listbox.Items)
                {
                    if (li.Selected)
                    {
                        Controltest2.Remove(li.Value);
                    }
                }
            }
        }
```

此代码给了我从列表框中删除项目的错误。另一方面;

```
 ListBox listbox = Controltest2.FindControl("ListBox1") as ListBox;
            if (Controltest2.Items.Count > 0)
            {
                int count = Controltest2.Items.Count;
                for (int i = count - 1; i > -1; i--)
                {
                    if (listbox.Items[i].Selected)
                    {
                        Controltest2.Remove(listbox.Items[i].Value);
                    }
                }
            }
```

为什么我不能使用“Foreach 循环”而不是“for 循环”...

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-04-04T19:46:27.470

> foreach 语句为数组或对象集合中的每个元素重复一组嵌入语句。foreach 语句用于遍历集合以获取所需的信息，**但不应用于更改集合的内容以避免不可预知的副作用**

资料来源：MSDN[`foreach`](http://msdn.microsoft.com/en-us/library/ttw7t8t6(VS.80).aspx)

注意：强调我的

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-04-04T19:48:54.577

当您使用 foreach 循环时，您正在修改底层集合，从而可以说中断枚举器。如果要使用 foreach 循环，请尝试以下操作：

```
foreach (ListItem li in listbox.Items.ToArray())
{
    if (li.Selected)
    {
        Controltest2.Remove(li.Value);
    }
} 
```

注意：`ToArray()`此示例中的调用假定 LINQ 对象，并且根据情况，您可能还需要`Cast<T>()`在调用它之前调用它。我在这里试图表达的要点是，通过创建一个数组，foreach 现在迭代数组的枚举器而不是 ListBox 的枚举器，允许您随意修改 ListBox 的集合。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T19:48:31.723

简短的回答：当您使用 foreach 遍历循环时，您无法添加或删除被循环的项目

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-16T13:01:53.237

在第一个示例中，您从集合的**开头**删除项目，这会影响定义迭代条件的集合，而在第二种情况下，您每次都从集合的**末尾删除项目，并且由于 int** *count*的固定值，循环初始条件不受影响。

# com - 你能阻止 SndVol 显示空的音频会话吗？

> ID：717684
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:44:17.537
> 
>         
> 
> 标签：com, windows-7, audio

我一直在玩Vista 的CoreAudio 东西，特别是IAudionSessionEvents，目的是监控默认音频会话，以了解加载代码引起的音量变化。

但是，一旦您安装了 IAudioSessionEvents 侦听器，SndVol 就会列出该程序以及所有相关的音量控制。大部分时间都没有加载实际播放任何内容的代码，这不太理想。

基本上，有什么方法可以监控默认音频会话而不导致 SndVol 列出它？

首选 Vista 的解决方案，但依赖于 Windows 7 中提供的新 api 的东西总比没有好。

* * *

Larry Osterman 指出了在 Windows 7 中添加的 ISessionManager2 和 IAudioSessionNotification 接口。但是，我从未收到新会话的通知。有人知道 Windows 7 build 7000 下这个 API 的问题或问题吗？

注册 IAudioSessionNotifications 的代码，省略了很多错误检查代码*：

```
BOOL success = false;
HRESULT hr;
IMMDeviceEnumerator *pEnumerator = NULL;
IMMDevice *pDevice = NULL;
IAudioSessionManager2* pManager = NULL;
IClassFactory* pFactory = NULL;

hr = CoInitialize(NULL);

hr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL, CLSCTX_ALL, __uuidof(IMMDeviceEnumerator), (void**)&pEnumerator);

hr = pEnumerator->GetDefaultAudioEndpoint(eRender, eConsole, &pDevice);

pDevice->Activate(__uuidof(IAudioSessionManager2), CLSCTX_ALL, NULL, (void**)&pManager);

listener = NULL;

hr = CoGetClassObject(CLSID_CustomFactory, CLSCTX_ALL, NULL, __uuidof(IClassFactory), (void**)&pFactory);

hr = pFactory->CreateInstance(NULL, __uuidof(IAudioSessionNotification), (void**)&listener);

hr = pManager->RegisterSessionNotification(listener); 
```

*虽然不是这个问题的目的，但欢迎对我的 COM 代码提出建设性的批评。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:24:44.290

如果你想监控音频会话的东西，你应该使用 IAudioSessionManager 接口来检索你的 IAudioSessionControl 对象。会话仅在从非活动状态转换为活动状态时才会在 SndVol 中显示 - 当有人调用 IAudioClient::Start() 时会发生这种情况 - 只要您不调用 IAudioClient::Start 您不应该获得会话滑块。

在 Windows 7 中，有一组新的 API ( [IAudioSessionManager2](http://msdn.microsoft.com/en-us/library/dd370950(VS.85).aspx) ) 允许您侦听会话的创建和销毁。

同样对于 Windows 7，还有 AUDCLNT_SESSIONFLAGS_HIDE 标志（此文档尚未更新，但在标题中）

# php - 使用 PHP GD 图像库着色和交换颜色？

> ID：717686
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-04T19:45:32.870
> 
>         
> 
> 标签：php, image, gd, imagefilter

您好，我正在尝试使用带有 PHP 的 GD 图像库对图像进行着色和交换颜色。

我正在使用位于此处的原始图像：http:
 [//korlon.com/youknowbetter/test.jpg](http://korlon.com/youknowbetter/test.jpg)

并希望让它变成橙色的脸，黑色的衣服和头发，就像你在这里看到的那样：http:   [//youknowdifferent.org/](http://youknowdifferent.org/)

到目前为止，我使用了以下代码：

```
<?php
header('Content-type: image/jpeg');
$im = imagecreatefromjpeg('test.jpg');

imagefilter($im, IMG_FILTER_GRAYSCALE);
imagefilter($im, IMG_FILTER_CONTRAST, 255);
imagefilter($im, IMG_FILTER_NEGATE);
imagefilter($im, IMG_FILTER_COLORIZE, 252, 137, 36);

imagejpeg($im);
?> 
```

为了让它接近，但我仍然缺少将所有白色阴影变成黑色阴影的能力。
[http://korlon.com/youknowbetter/filter.php](http://korlon.com/youknowbetter/filter.php)

我已尝试按照此处问题中的说明将白色换成黑色：
[我可以使用 PHP 中的 GD 库交换图像中的颜色吗？](https://stackoverflow.com/questions/456044/can-i-swap-colors-in-image-using-gd-library-in-php)

但是，这似乎不起作用。它实际上并没有换掉颜色。那是因为我使用的是jpg而不是gif吗？我需要对调色板做些什么吗？

谢谢，任何帮助将不胜感激！

斯托布

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T20:15:51.237

使用蓝色 (#0276DB) 代替橙色，然后反转图像（使用`IMAGE_FILTER_NEGATE`）得到橙色和黑色。

因此，您的代码将是：

```
<?php
header('Content-type: image/jpeg');
$im = imagecreatefromjpeg('test.jpg');

imagefilter($im, IMG_FILTER_GRAYSCALE);
imagefilter($im, IMG_FILTER_CONTRAST, 255);
imagefilter($im, IMG_FILTER_NEGATE);
imagefilter($im, IMG_FILTER_COLORIZE, 2, 118, 219);
imagefilter($im, IMG_FILTER_NEGATE);

imagejpeg($im);
?> 
```

# python - Python 和套接字 +upnp

> ID：717687
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:46:03.367
> 
>         
> 
> 标签：python

我有一个关于 python 和套接字的问题。据我了解，如果您有路由器，则必须先打开一个端口，然后才能在程序中使用它。但是如果用户不能这样做……我听说了一些关于 UPnP 的事情。我不知道这对我的问题有帮助，所以我问过你。最好的祝福。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-05T11:18:12.037

对于 UPnP 支持，您可以使用[MiniUPnP](http://miniupnp.free.fr)库，它支持 python。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2014-12-01T11:24:28.410

在通常的设置中，如果你有一个家庭路由器，你的机器没有公共 IP 地址，只有路由器有并为其他机器进行 NAT 以访问 Internet。

为了打开一个“监听”套接字以便互联网机器可以访问您的私人机器，您必须将公共端口重定向到您的本地机器。例如，公共 1.2.3.4 端口 2222 将被重定向到私有 192.168.1.42 端口 22，因此您可以从任何地方 ssh 您的机器

此类重定向可以在路由器上手动配置，也可以通过 UPnP IGD、NAT-PMP 和 PCP 等协议进行配置

UPNP IGD 是最普遍的一种。有关路由器的 UPNP 功能，请参阅 Miniupnp [http://miniupnp.free.fr/ 。](http://miniupnp.free.fr/)它有python绑定。

# asp.net-mvc - ASP.NET MVC - 将数组对象作为 Html.ActionLink(...) 中的路由值传递

> ID：717690
> 
>         
> 
> 赞同：41
> 
>         
> 
> 时间：2009-04-04T19:46:35.520
> 
>         
> 
> 标签：asp.net-mvc, arrays, actionlink, routes

我有一个返回数组 (string[]) 的方法，我正在尝试将这个字符串数组传递给 Action Link，以便它创建一个类似于以下内容的查询字符串：

```
/Controller/Action?str=val1&str=val2&str=val3...etc 
```

但是当我通过 new { str = GetStringArray() } 我得到以下网址：

```
/Controller/Action?str=System.String%5B%5D 
```

所以基本上它正在使用我的 string[] 并在其上运行 .ToString() 来获取值。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-04-04T20:14:08.200

尝试创建一个 RouteValueDictionary 保存您的值。您必须为每个条目提供不同的密钥。

```
<%  var rv = new RouteValueDictionary();
    var strings = GetStringArray();
    for (int i = 0; i < strings.Length; ++i)
    {
        rv["str[" + i + "]"] = strings[i];
    }
 %>

<%= Html.ActionLink( "Link", "Action", "Controller", rv, null ) %> 
```

会给你一个链接，比如

```
<a href='/Controller/Action?str=val0&str=val1&...'>Link</a> 
```

**编辑**：MVC2 更改了 ValueProvider 接口，使我原来的答案过时了。您应该使用具有字符串数组作为属性的模型。

```
public class Model
{
    public string Str[] { get; set; }
} 
```

然后模型绑定器将使用您在 URL 中传递的值填充您的模型。

```
public ActionResult Action( Model model )
{
    var str0 = model.Str[0];
} 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2014-02-14T17:21:53.137

这真的让我很恼火，所以[在 Scott Hanselman 的启发下，](http://www.hanselman.com/blog/ASPNETWireFormatForModelBindingToArraysListsCollectionsDictionaries.aspx)我编写了以下（流利的）扩展方法：

```
public static RedirectToRouteResult WithRouteValue(
    this RedirectToRouteResult result, 
    string key, 
    object value)
{
    if (value == null)
        throw new ArgumentException("value cannot be null");

    result.RouteValues.Add(key, value);

    return result;
}

public static RedirectToRouteResult WithRouteValue<T>(
    this RedirectToRouteResult result, 
    string key, 
    IEnumerable<T> values)
{
    if (result.RouteValues.Keys.Any(k => k.StartsWith(key + "[")))
        throw new ArgumentException("Key already exists in collection");

    if (values == null)
        throw new ArgumentNullException("values cannot be null");

    var valuesList = values.ToList();

    for (int i = 0; i < valuesList.Count; i++)
    {
        result.RouteValues.Add(String.Format("{0}[{1}]", key, i), valuesList[i]);
    }

    return result;
} 
```

像这样调用：

```
return this.RedirectToAction("Index", "Home")
           .WithRouteValue("id", 1)
           .WithRouteValue("list", new[] { 1, 2, 3 }); 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2014-05-23T09:05:28.137

我刚刚想到的另一个解决方案：

```
string url = "/Controller/Action?iVal=5&str=" + string.Join("&str=", strArray); 
```

这很脏，您应该在使用它之前对其进行测试，但它仍然可以工作。希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2014-05-23T08:56:12.440

有一个名为[Unbinder](http://unbinder.codeplex.com/)的库，您可以使用它来将复杂的对象插入到路由/url 中。

它是这样工作的：

```
using Unbound;

Unbinder u = new Unbinder();
string url = Url.RouteUrl("routeName", new RouteValueDictionary(u.Unbind(YourComplexObject))); 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2017-09-19T12:44:48.373

这是一个 HelperExtension 解决数组和 IEnumerable 属性的麻烦：

```
public static class AjaxHelperExtensions
{
    public static MvcHtmlString ActionLinkWithCollectionModel(this AjaxHelper ajaxHelper, string linkText, string actionName, object model, AjaxOptions ajaxOptions, IDictionary<string, object> htmlAttributes)
    {
        var rv = new RouteValueDictionary();

        foreach (var property in model.GetType().GetProperties())
        {
            if (typeof(ICollection).IsAssignableFrom(property.PropertyType))
            {
                var s = ((IEnumerable<object>)property.GetValue(model));
                if (s != null && s.Any())
                {
                    var values = s.Select(p => p.ToString()).Where(p => !string.IsNullOrEmpty(p)).ToList();
                    for (var i = 0; i < values.Count(); i++)
                        rv.Add(string.Concat(property.Name, "[", i, "]"), values[i]);
                }
            }
            else
            {
                var value = property.GetGetMethod().Invoke(model, null) == null ? "" : property.GetGetMethod().Invoke(model, null).ToString();
                if (!string.IsNullOrEmpty(value))
                    rv.Add(property.Name, value);
            }
        }
        return System.Web.Mvc.Ajax.AjaxExtensions.ActionLink(ajaxHelper, linkText, actionName, rv, ajaxOptions, htmlAttributes);
    }
} 
```

* * *

## 回答 #6

> 赞同：-7
> 
>             
> 
> 时间：2009-04-04T20:07:37.840

我会使用 POST 作为数组。除了丑陋和滥用 GET 之外，您还可能会耗尽 URL 空间（信不信由你）。

假设[2000 字节限制](http://www.boutell.com/newfaq/misc/urllength.html)。查询字符串开销 (&str=) 将您减少到大约 300 字节的实际数据（假设 url 的其余部分为 0 字节）。

# python - Python 库 httplib2 是否使用 GET 字符串缓存 URI？

> ID：717700
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T19:50:11.157
> 
>         
> 
> 标签：python, caching, httplib2

在以下示例中，正确缓存了什么？是否有一个 Vary-Header 我必须为 GET 字符串设置服务器端？

```
import httplib2
h = httplib2.Http(".cache")
resp, content = h.request("http://test.com/list/")
resp, content = h.request("http://test.com/list?limit=10")
resp, content = h.request("http://test.com/list?limit=50") 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T21:14:14.997

httplib2 使用完整的 URI 作为缓存键，因此在这种情况下，您在示例中拥有的每个 URL 都将由客户端单独缓存。

对于 httplib2 文件中的章节`__init__.py`，如果您想证明，请查看第 1000 行左右对缓存的调用：

```
cachekey = defrag_uri
cached_value = self.cache.get(cachekey) 
```

defrag_uri 由函数定义`urlnorm`（第 170 行），包括方案、权限、路径和查询。

当然，如您所知，服务器可能对“资源”的定义完全不同，因此仍可能返回缓存的内容。由于在这种情况下听起来您正在控制服务器，因此您可以完全控制服务器，所以没有问题。无论哪种方式，在客户端，第一次调用示例中的 3 个 URL 中的每一个都不会使用客户端缓存的值。

# jquery - 在 JQuery 中发布表单并填充 DIV - 在 IE 中损坏

> ID：717703
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:54:36.843
> 
>         
> 
> 标签：jquery, ajax, forms

我正在尝试创建一个通过 jQuery 发布数据并将返回填充到同一个 DIV 中的表单。这样，页面不会在发布操作时刷新。

```
<div id="add_value_form">

<form method="POST" action="#" onsubmit='return false'>
  <!-- input fields -->
  <input type="submit" value="Add" onclick='post_form("/add_value");'>
</form>

</div> 
```

JS函数：

```
function post_form(url) {
  $.post(url, {'test':'test'}, function(data) {
    $("#add_value_form").empty().append(data); 
  }, "text");
} 
```

这在 FF3 中完美运行，但它只能在 IE6/7 中随机运行。

服务器确认发布请求来自 IE，但它只会偶尔获取发布数据。

好奇，我决定提醒数据变量：

```
$.post(url, {'test':'test'}, function(data) {alert(data);}, "text"); 
```

果然，FF3 每次都会打印出返回的 HTML，而 IE6/7 大部分会打印空白，偶尔会返回 HTML。我在这个问题上找不到任何东西，所以我做错了什么？

**已解决：**我将此跟踪到我在请求处理代码中的 HTTP 重定向。所以处理 POST 请求的函数会抛出一个重定向，而 IE 不喜欢它。当时我的精神完全便秘，我真的不需要重定向。

当然，奇怪的部分是这在 FF 中有效，而 IE 有时也可以在重定向到位的情况下工作。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T19:59:31.213

我想说在这种情况下您根本不必使用表单标签。

```
<div id="add_value_form">
  <!-- input fields -->
  <input type="button" value="Add" onclick='post_form("/add_value");' />
</div> 
```

**编辑**
正如 Paolo Bergantino 所说，我也会避免使用内联 javascript。所以改为使用：

```
<div id="add_value_form">
  <!-- input fields -->
  <input type="button" value="Add" class="formSubmitButton" />
</div> 
```

**Javascript**

```
$(document).ready(function() {
  $('.formSubmitButton').click(function() {
      $.post('/add_value', {'test':'test'}, function(data) {
          $("#add_value_form").empty().append($(data));
      }, "text");
  });
}); 
```

**更新**  由于这仍然导致问题，我将使用该`$.ajax`方法进行一些测试。另外，我不相信 POST 调用会被缓存，但以防万一尝试将缓存设置为 false。另一个测试，以确保您没有序列化问题，是将您的数据以已编码的形式传递。如果您仍然遇到问题，您可以尝试将 dataType 设置为 text

```
$.ajax({
  url: '/add_value',
  type: 'POST',
  cache: false,
  data: 'test=testValue',
  dataType: 'text',
  complete: function(xhr, textStatus) {
    alert('completed');
  },
  success: function(data) {
    alert(data);
  },
  error: function(xhr, textStatus, errorThrown) {
    alert('woops');
  }
}); 
```

# design-patterns - 状态码设计模式

> ID：717705
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-04T19:55:07.760
> 
>         
> 
> 标签：design-patterns

假设您在典型的博客场景中有一个“帖子”对象。博客文章可以具有不同的状态，例如“草稿”、“已发布”、“已批准”等。处理此问题的最佳方法是什么，特别是关于以有意义的方式以及在代码中以有意义的方式将此数据存储在数据库中。

通常，我已经看到这些存储为与数据库中的一行相关联的 int （在此示例中为“posts”表）。有时在数据库中有一个查找表来解释这些状态（即状态表，id=>1 name=>draft 等）。通常，我会将这些转换为数据访问层中的枚举，以获得更有意义的代码表示并避免出现“幻数”。

但是，此解决方案需要开发人员更新两个不同的位置（数据库和代码）以添加或更改状态类型。

有什么更好的方法来做到这一点？这似乎是我经常遇到的一种问题，但我从未见过处理它的好方法。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T20:10:25.760

我喜欢`status_id`按照您的建议设置一个并创建一个查找表，其中包含其中的状态和相应的枚举。

如果我的状态本质上是不可变的（例如，博客文章的状态、订单的状态等），我将创建一个单元测试来确定我使用的枚举数是否与查找表中的数据匹配——所以如果有人是将来要向数据库添加状态，它将无法通过测试，告诉开发人员添加到枚举中。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:30:23.697

IMO，它们应该只在一个地方，如果您将草稿映射到代码中的枚举 DRAFT，这可能意味着您正在向代码中的草稿添加行为，例如草稿是否可编辑并基于此做出决策。我在这里的方法是将行为移动到数据库并为该行为添加一列到 db （如布尔列表示其是否可编辑）并将其映射到状态类而不是枚举。因此，如果引入了新状态，则可以将其添加到具有相应行为的 db 中。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T20:36:09.143

我同意 John Rasch 的回答，但您可能对[Codeproject](http://www.codeproject.com/KB/database/EnumGenerator.aspx)上讨论动态生成枚举的帖子感兴趣

# asp.net - 在什么情况下视图状态可能不会持久化？

> ID：717707
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T19:56:17.353
> 
>         
> 
> 标签：asp.net

我有一个页面和一个用户控件。

我为控件中的视图状态分配一个值并执行

```
Server.Transfer(Request.Url.AbsolutePath); 
```

但是当我检查控件的 Page_Load() 事件的值时，分配的值不存在（视图状态为空，没有键）。

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-05T00:05:24.850

ViewState 是按页面存储的。一旦您执行 Server.Transfer，您将从您正在传输的页面中丢失 ViewState，这似乎是您的控件所在的位置？ViewState 仅在回发期间保持不变。

第二，您可能明确关闭了页面或单个控件的 ViewState 而没有意识到这一点。

# .net - WCF 客户端/服务器模型

> ID：717708
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T19:57:46.663
> 
>         
> 
> 标签：.net, wcf

我正在寻找使用客户端/服务器模型创建功能丰富的应用程序，使用 WCF 作为可能的通信框架。

我将在 Windows 服务中托管服务（因此对于 WCF，我将使用 netTcpBinding）。

现在，我想我可以将每个服务操作定义为一个服务契约，但可能会有很多操作，我宁愿将它们分成几个有凝聚力的服务契约。

将我的操作拆分为一组服务合同是否意味着我必须将每个服务托管在单独的端口上？（这并不理想，因为我更喜欢在一个端口上运行它。）

关于这种情况的任何设计提示？谢谢 ：）

**更新**

对任何混淆感到抱歉 - 我无意将每个服务操作都托管*在*不同的合同中，只是为了对它们进行明智的分组。我的问题源于我认为不可能在一个端口上托管多个 ServiceHost。

<拍拍额头>

Joe 说，可以简单地在一个端口上托管多个服务主机。我想我在最初尝试这个时一定误解了一条异常消息。如果我能让这个工作，那么我认为这将是我最喜欢的解决方案。

我认为@Koystya 和 co 在单个具体对象上实现每个接口并将其托管在单个 ServiceHost 中的方法也是我的问题的一个很好的实用解决方案。特别是如果您将单个具体对象视为一种外观。我能想到的一个缺点是，根据合同，您将无法拥有不同的 ServiceBehavior。

此外，我确实同意 Joe 关于何时适合在一个具体类上实现多个服务合同的逻辑。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T20:18:04.743

一个服务可以公开多个服务契约。

我将创建实现为一个类的 WCF 服务，该类本身实现多个具有 [ServiceContract] 属性的接口。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T22:18:13.830

> 我想我可以将每个服务操作定义为一个服务合同，但是可能会有很多操作，我宁愿将它们分成几个有凝聚力的服务合同。

将操作分组为有凝聚力的服务合同是有意义的。粒度（例如每个服务合同的操作数量）将取决于您的应用程序，但每个操作一个服务合同似乎是极端的。

> 将我的操作拆分为一组服务合同是否意味着我必须将每个服务托管在一个单独的端口上

一点也不，您可以在同一个端口上拥有多个服务合同。

您可以有一个具体的类来实现[Koistya Navin .NET 建议的](https://stackoverflow.com/questions/717708/wcf-client-server-model/717738#717738)多个服务合同。但：

*   这是一个内部实现细节。

*   如果操作合同的实现是如此密切相关以至于在单个类中实现它们是有意义的，我只会考虑这样做。

*   在这种情况下，使它们成为同一服务合同的一部分可能是有意义的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-06T15:22:04.483

您为什么考虑将每个操作都放入自己的服务合同中？你打算从中获得什么？

基本上，服务合同可以有尽可能多的标记为 [OperationContract] 的操作。那可能会更有意义。

如果您有不同的功能，您总是可以定义多个 ServiceContract（作为一个接口），并让您的服务类实现它们并在一个地址（包括端口）上托管一个服务类（具有所有 ServiceContract 接口）。

```
[ServiceContract]
public interface IMyService1
{
  [OperationContract]
  void SomeOperation1;

  [OperationContract]
  void SomeOperation2;
}

[ServiceContract]
public interface IMyService2
{
  [OperationContract]
  void SomeOperation21;

  [OperationContract]
  void SomeOperation22;
}

public class MyServiceClass : IMyService1, IMyService2
{
  void SomeOperation1;
  void SomeOperation2;
  void SomeOperation21;
  void SomeOperation22;
} 
```

马克

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T20:21:30.710

正如@Koistya 所写，这是可能的。这是一个完整的例子：[example](http://www.meineck.net/2008/04/wcf-hosting-multiple-wcf-services-as.html)。

# mysql - 我不能编辑 MySQL 触发器，我必须删除它并创建一个新触发器，这是真的吗？

> ID：717711
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-04T20:00:02.163
> 
>         
> 
> 标签：mysql, triggers

我不能编辑 MySQL 触发器，我必须删除它并创建一个新触发器，这是真的吗？

此外，作为触发器的新手，感觉它们似乎容易导致“错误”数据。例如，我可能希望在一种特定类型的更新查询之后触发触发器（将数据插入另一个表），而不是其他类型的更新查询。

这里的任何提示都非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-04T20:12:25.817

**编辑：**是的，MySQL 5 和 6 的 5.n 和 6.n 版本确实实现了`CREATE TRIGGER`，仅此`DROP TRIGGER`而已。根据[这篇 Postgres 文档](http://www.postgresql.org/files/documentation/books/aw_pgsql/node223.html)，甚至`CREATE TRIGGER`在 SQL 92 中都没有，所以认为自己很幸运能够拥有 TRIGGER :-)

[Visual Studio MySQL 插件文档](http://dev.mysql.com/doc/refman/5.0/en/connector-vstudio-using-triggers.html)有：

> 要修改现有触发器，请双击要修改的触发器节点，或右键单击该节点并从上下文菜单中选择“更改触发器”命令。任何一个命令都会打开 SQL 编辑器。

...这似乎做你想做的事。我的猜测是这是 GUI 糖，在幕后你会得到一个`DROP CREATE`.

至于某些`UPDATE`s 而不是其他的触发器，SQL`UPDATE`每个表只有一个触发器。`IF`在触发器的开头放置一个子句，`UPDATE`以便您的逻辑 - 无论您在某些`UPDATE`s 中做什么 - 只有在您认为合适时才会执行。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-06T01:17:48.290

MySQL 有 REPLACE TRIGGER，对吧？

作为旁注..这是一个问题吗？如果您担心查询是在 DROP 和 CREATE 之间执行的，您总是可以事先锁定表。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2021-06-23T00:28:44.817

如果您使用的是**MySql Workbench**，它将允许您更改触发器。只需右键单击您的表名，然后从那里单击更改表选项，您可以选择触发器选项并更改它。虽然，您不能从查询模式执行它。
`Table Name --> Right Click --> Alter Table --> Triggers`.

# mysql - Getting the last record inserted into a select query

> ID：717720
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T20:04:50.420
> 
>         
> 
> 标签：mysql

I am creating a small message board and I am stuck

I can select the subject, the original author, the number of replies but what I can't do is get the username, topic or date of the last post.

There are 3 tables, boards, topics and messages.

I want to get the author, date and topic of the last message in the message table.  The author and date field are already fields on the messages table but i would need to join the messages and topics table on the topicid field.

this is my query that selects the subject, author, and number of replies

```
SELECT t.topicname, t.author, count( message ) AS message
  FROM topics t
  INNER JOIN messages m
    ON m.topicid = t.topicid
  INNER JOIN boards b
    ON b.boardid = t.boardid
  WHERE b.boardid = 1
  GROUP BY t.topicname 
```

Can anyone please help me get this finished?

This is what my tables look like

```
CREATE TABLE `boards` (
  `boardid` int(2) NOT NULL auto_increment,
  `boardname` varchar(255) NOT NULL default '',
  PRIMARY KEY  (`boardid`)
);

CREATE TABLE `messages` (
  `messageid` int(6) NOT NULL auto_increment,
  `topicid` int(4) NOT NULL default '0',
  `message` text NOT NULL,
  `author` varchar(255) NOT NULL default '',
  `date` timestamp(14) NOT NULL,
  PRIMARY KEY  (`messageid`)
);

CREATE TABLE `topics` (
  `topicid` int(4) NOT NULL auto_increment,
  `boardid` int(2) NOT NULL default '0',
  `topicname` varchar(255) NOT NULL default '',
  `author` varchar(255) NOT NULL default '',
  PRIMARY KEY  (`topicid`)
); 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T21:21:42.233

if your SQL supports the LIMIT clause, 

```
SELECT m.author, m.date, t.topicname FROM messages m 
JOIN topics t ON m.topicid = t.topicid 
ORDER BY date desc LIMIT 1 
```

otherwise:

```
SELECT m.author, m.date, t.topicname FROM messages m 
JOIN topics t ON m.topicid = t.topicid 
WHERE m.date = (SELECT max(m2.date) from messages m2) 
```

EDIT: if you want to combine this with the original query, it has to be rewritten using subqueries to extract the message count and the date of last message:

```
SELECT t.topicname, t.author, 
      (select count(message) from messages m where m.topicid = t.topicid) AS messagecount, 
       lm.author, lm.date
  FROM topics t
  INNER JOIN messages lm
    ON lm.topicid = t.topicid AND lm.date = (SELECT max(m2.date) from messages m2)
  INNER JOIN boards b
    ON b.boardid = t.boardid
  WHERE b.boardid = 1
  GROUP BY t.topicname 
```

also notice that if you don't pick any field from table boards, you don't need the last join:

```
SELECT t.topicname, t.author, 
      (select count(message) from messages m where m.topicid = t.topicid) AS messagecount, 
       lm.author, lm.date
  FROM topics t
  INNER JOIN messages lm
    ON lm.topicid = t.topicid AND lm.date = (SELECT max(m2.date) from messages m2)
  WHERE t.boardid = 1
  GROUP BY t.topicname 
```

EDIT: if mysql doesn't support subqueries in the field list, you can try this:

```
SELECT t.topicname, t.author, mc.messagecount, lm.author, lm.date
  FROM topics t
  JOIN (select m.topicid, count(*) as messagecount from messages m group by m.topicid) as mc 
    ON mc.topicid = t.topicid
  JOIN messages lm
    ON lm.topicid = t.topicid AND lm.date = (SELECT max(m2.date) from messages m2)
  WHERE t.boardid = 1
  GROUP BY t.topicname 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:43:24.417

You can use a subselect. Eg.:

```
select * from messages where id = (select max(id) from messages) 
```

edit: And if you identify the newest record by a timestamp, you'd use:

```
select * from messages where id = (
  select id
  from messages
  order by post_time desc
  limit 1) 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:50:11.000

If you want to get the latest entry in a table, you should have a `DateTime` field that shows when the entry was created (or updated). You can then sort on this column and select the latest one.

But if your `id` field is a number, you could find the highest. But I would recommend against this because it makes many assumptions and you would be fixed to numerical ids in the future.

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T21:27:10.690

With MySQL this should work:

```
SELECT author, date, topicname as topic FROM messages LEFT JOIN topics ON messages.topicid = topics.topicid ORDER BY date DESC, LIMIT 0, 1; 
```

# algorithm - 理解递归

> ID：717725
> 
>         
> 
> 赞同：229
> 
>         
> 
> 时间：2009-04-04T20:10:02.327
> 
>         
> 
> 标签：algorithm, recursion, tail-recursion

我在学校里很难理解*递归。*每当教授谈论它时，我似乎都明白了，但是当我自己尝试时，它完全让我大吃一惊。

我整晚都在试图解决*河内塔问题，完全让我大吃一惊。*我的教科书只有大约 30 页的递归，所以它不是太有用。有谁知道可以帮助澄清这个话题的书籍或资源？

* * *

## 回答 #1

> 赞同：633
> 
>             
> 
> 时间：2009-04-04T21:19:46.340

你如何清空一个装有五朵花的花瓶？

答：如果花瓶不是空的，你就拿出一朵花，然后你倒空一个装有四朵花的花瓶。

你如何清空一个装有四朵花的花瓶？

答：如果花瓶不是空的，你取出一朵花，然后倒空一个装有三朵花的花瓶。

你如何清空一个装有三朵花的花瓶？

答：如果花瓶不是空的，你就取出一朵花，然后你倒空一个装有两朵花的花瓶。

你如何清空一个装有两朵花的花瓶？

答：如果花瓶不是空的，则取出一朵花，然后将一个装有一朵花的花瓶倒空。

你如何清空一个装有一朵花的花瓶？

答：如果花瓶不是空的，你取出一朵花，然后你把一个没有花的花瓶倒空。

你如何清空一个没有鲜花的花瓶？

答：如果花瓶不是空的，你拿出一朵花，但花瓶是空的，你就完成了。

那是重复的。让我们概括一下：

你如何清空一个装有*N*朵花的花瓶？

答：如果花瓶不是空的，则取出一朵花，然后将一个装有*N-1*朵花的花瓶倒空。

嗯，我们可以在代码中看到吗？

```
void emptyVase( int flowersInVase ) {
  if( flowersInVase > 0 ) {
   // take one flower and
    emptyVase( flowersInVase - 1 ) ;

  } else {
   // the vase is empty, nothing to do
  }
} 
```

嗯，我们不能在 for 循环中完成吗？

为什么，是的，递归可以用迭代代替，但递归通常更优雅。

让我们谈谈树木。在计算机科学中，*树*是由*节点*组成的结构，其中每个节点都有一定数量的子节点，这些子节点也是节点，或者为空。*二叉树*是由恰好有*两个*孩子的节点组成的树，通常称为“左”和“右”；再次，孩子可以是节点，也可以是空的。*根*是不是任何其他节点的子节点的节点。

想象一个节点，除了它的孩子之外，还有一个值，一个数字，并想象我们希望对某棵树中的所有值求和。

要对任何一个节点的值求和，我们会将节点本身的值添加到其左孩子的值（如果有）和其右孩子的值（如果有）。现在回想一下，孩子们，如果他们不为空，也是节点。

因此，要对左子节点求和，我们会将子节点本身的值与其左子节点的值（如果有）和右子节点的值（如果有）相加。

因此，要对左孩子的左孩子的值求和，我们会将子节点本身的值加上它的左孩子的值（如果有的话）和它的右孩子的值（如果有的话）。

或许你已经预料到我会用这个去哪里，并且想看一些代码？好的：

```
struct node {
  node* left;
  node* right;
  int value;
} ;

int sumNode( node* root ) {
  // if there is no tree, its sum is zero
  if( root == null ) {
    return 0 ;

  } else { // there is a tree
    return root->value + sumNode( root->left ) + sumNode( root->right ) ;
  }
} 
```

请注意，我们不是显式测试子节点以查看它们是 null 还是节点，而是让递归函数为 null 节点返回零。

假设我们有一棵看起来像这样的树（数字是值，斜杠指向子节点，@ 表示指针指向 null）：

```
 5
    / \
   4   3
  /\   /\
 2  1 @  @
/\  /\
@@  @@ 
```

如果我们在根（值为 5 的节点）上调用 sumNode，我们将返回：

```
return root->value + sumNode( root->left ) + sumNode( root->right ) ;
return 5 + sumNode( node-with-value-4 ) + sumNode( node-with-value-3 ) ; 
```

让我们就地展开它。在我们看到 sumNode 的任何地方，我们都将其替换为 return 语句的扩展：

```
sumNode( node-with-value-5);
return root->value + sumNode( root->left ) + sumNode( root->right ) ;
return 5 + sumNode( node-with-value-4 ) + sumNode( node-with-value-3 ) ;

return 5 + 4 + sumNode( node-with-value-2 ) + sumNode( node-with-value-1 ) 
 + sumNode( node-with-value-3 ) ;  

return 5 + 4 
 + 2 + sumNode(null ) + sumNode( null )
 + sumNode( node-with-value-1 ) 
 + sumNode( node-with-value-3 ) ;  

return 5 + 4 
 + 2 + 0 + 0
 + sumNode( node-with-value-1 ) 
 + sumNode( node-with-value-3 ) ; 

return 5 + 4 
 + 2 + 0 + 0
 + 1 + sumNode(null ) + sumNode( null )
 + sumNode( node-with-value-3 ) ; 

return 5 + 4 
 + 2 + 0 + 0
 + 1 + 0 + 0
 + sumNode( node-with-value-3 ) ; 

return 5 + 4 
 + 2 + 0 + 0
 + 1 + 0 + 0
 + 3 + sumNode(null ) + sumNode( null ) ; 

return 5 + 4 
 + 2 + 0 + 0
 + 1 + 0 + 0
 + 3 + 0 + 0 ;

return 5 + 4 
 + 2 + 0 + 0
 + 1 + 0 + 0
 + 3 ;

return 5 + 4 
 + 2 + 0 + 0
 + 1 
 + 3  ;

return 5 + 4 
 + 2 
 + 1 
 + 3  ;

return 5 + 4 
 + 3
 + 3  ;

return 5 + 7
 + 3  ;

return 5 + 10 ;

return 15 ; 
```

现在看看我们如何通过将其视为复合模板的重复应用来征服任意深度和“分支”的结构？每次通过我们的 sumNode 函数，我们只处理一个节点，使用一个 if/then 分支，以及两个几乎直接从我们的规范中编写出来的简单 return 语句？

```
How to sum a node:
 If a node is null 
   its sum is zero
 otherwise 
   its sum is its value 
   plus the sum of its left child node
   plus the sum of its right child node 
```

*这就是*递归的力量。

* * *

上面的花瓶示例是*尾递归*的示例。*尾递归*意味着在递归函数中，如果我们递归（也就是说，如果我们再次调用该函数），那是我们做的最后一件事。

树的例子不是尾递归的，因为即使我们做的最后一件事是递归右孩子，在我们这样做之前我们递归了左孩子。

事实上，我们调用子节点的顺序以及添加当前节点的值根本不重要，因为加法是可交换的。

现在让我们看一下顺序确实很重要的操作。我们将使用节点的二叉树，但这次保存的值将是一个字符，而不是一个数字。

我们的树将有一个特殊的属性，即对于任何节点，它的字符在其左孩子所持有的字符*之后（按字母顺序）和在其右孩子所持有的字符**之前*（按字母顺序）。

我们要做的是按字母顺序打印树。考虑到树的特殊属性，这很容易做到。我们只打印左孩子，然后是节点的字符，然后是右孩子。

我们不只是想随意打印，所以我们将传递给我们的函数一些东西来打印。这将是一个带有 print(char) 函数的对象；我们不需要担心它是如何工作的，只要调用 print 时，它会在某个地方打印一些东西。

让我们在代码中看看：

```
struct node {
  node* left;
  node* right;
  char value;
} ;

// don't worry about this code
class Printer {
  private ostream& out;
  Printer( ostream& o ) :out(o) {}
  void print( char c ) { out << c; }
}

// worry about this code
int printNode( node* root, Printer& printer ) {
  // if there is no tree, do nothing
  if( root == null ) {
    return ;

  } else { // there is a tree
    printNode( root->left, printer );
    printer.print( value );
    printNode( root->right, printer );
}

Printer printer( std::cout ) ;
node* root = makeTree() ; // this function returns a tree, somehow
printNode( root, printer ); 
```

除了现在很重要的操作顺序之外，这个例子还说明我们可以将事物传递给递归函数。我们唯一要做的就是确保在每次递归调用中，我们继续传递它。我们将节点指针和打印机传递给函数，并且在每次递归调用时，我们将它们“向下”传递。

现在，如果我们的树看起来像这样：

```
 k
        / \
       h   n
      /\   /\
     a  j @  @
    /\ /\
    @@ i@
       /\
       @@ 
```

我们将打印什么？

```
From k, we go left to
  h, where we go left to
    a, where we go left to 
      null, where we do nothing and so
    we return to a, where we print 'a' and then go right to
      null, where we do nothing and so
    we return to a and are done, so
  we return to h, where we print 'h' and then go right to
    j, where we go left to
      i, where we go left to 
        null, where we do nothing and so
      we return to i, where we print 'i' and then go right to
        null, where we do nothing and so
      we return to i and are done, so
    we return to j, where we print 'j' and then go right to
      null, where we do nothing and so
    we return to j and are done, so
  we return to h and are done, so
we return to k, where we print 'k' and then go right to
  n where we go left to 
    null, where we do nothing and so
  we return to n, where we print 'n' and then go right to
    null, where we do nothing and so
  we return to n and are done, so 
we return to k and are done, so we return to the caller 
```

因此，如果我们只看我们打印的行：

```
 we return to a, where we print 'a' and then go right to
  we return to h, where we print 'h' and then go right to
      we return to i, where we print 'i' and then go right to
    we return to j, where we print 'j' and then go right to
we return to k, where we print 'k' and then go right to
  we return to n, where we print 'n' and then go right to 
```

我们看到我们打印了“ahijkn”，它确实是按字母顺序排列的。

我们只需知道如何按字母顺序打印单个节点，就可以按字母顺序打印整个树。这只是（因为我们的树具有将值按字母顺序排列在后面的值的左侧的特殊属性）知道在打印节点的值之前打印左孩子，并在打印节点的值之后打印右孩子。

这*就是*递归的力量：能够通过只知道如何做整体的一部分（以及知道何时停止递归）来完成所有的事情。

回想一下，在大多数语言中，运算符 || ("or") 在其第一个操作数为真时短路，一般递归函数为：

```
void recurse() { doWeStop() || recurse(); } 
```

卢克 M 评论：

> 所以应该为这种答案创建一个徽章。恭喜！

谢谢，卢克！但是，实际上，因为我对这个答案进行了四次以上的编辑（添加最后一个示例，但主要是为了更正拼写错误并润色它——在一个小的上网本键盘上打字很难），我不能再得到任何分数了. 这在某种程度上阻止了我在未来的答案中投入尽可能多的精力。

在这里查看我的评论：[https ://stackoverflow.com/questions/128434/what-are-community-wiki-posts-in-stackoverflow/718699#718699](https://stackoverflow.com/questions/128434/what-are-community-wiki-posts-in-stackoverflow/718699#718699)

* * *

## 回答 #2

> 赞同：37
> 
>             
> 
> 时间：2009-04-04T21:05:36.173

你的大脑爆炸了，因为它进入了无限递归。这是一个常见的初学者错误。

信不信由你，你已经理解了递归，你只是被一个常见但错误的函数隐喻拖累：一个装着进出东西的小盒子。

思考而不是任务或过程，例如“在网上了解有关递归的更多信息”。这是递归的，你没有问题。要完成此任务，您可以：

```
a) 阅读 Google 的“递归”结果页面
b) 阅读后，点击第一个链接，然后...
a.1）阅读关于递归的新页面
b.1）一旦您阅读了它，请点击它的第一个链接并...
a.2）阅读关于递归的新页面
b.2）一旦您阅读了它，请点击上面的第一个链接并...

```

如您所见，您长期以来一直在做递归的事情，没有任何问题。

你会继续做这个任务多久？永远直到你的大脑爆炸？当然不是，只要你相信你已经完成了任务，你就会停在一个给定的点上。

当要求您“了解有关网络递归的更多信息”时，无需指定这一点，因为您是人类，您可以自己推断。

计算机无法推断出杰克，所以你必须包含一个明确的结尾：“在网上找到更多关于递归的信息，**直到你理解它或者你最多阅读了 10 页**”。

您还推断您应该从 Google 的“递归”结果页面开始，这也是计算机无法做到的。我们递归任务的完整描述还必须包括一个明确的起点：

“在网上了解有关递归的更多信息，**直到您理解它或您已阅读最多 10 页**并**从 www.google.com/search?q=recursion 开始**”

为了了解整个事情，我建议您尝试以下任何书籍：

*   Common Lisp：符号计算的简单介绍。这是递归最可爱的非数学解释。

*   小谋士。

* * *

## 回答 #3

> 赞同：26
> 
>             
> 
> 时间：2009-04-04T21:18:31.413

要了解递归，您所要做的就是查看洗发水瓶的标签：

```
function repeat()
{
   rinse();
   lather();
   repeat();
} 
```

这样做的问题是没有终止条件，递归将无限重复，或者直到你用完洗发水或热水（外部终止条件，类似于吹你的堆栈）。

* * *

## 回答 #4

> 赞同：12
> 
>             
> 
> 时间：2009-04-04T20:45:23.320

如果你想要一本能很好地用简单的术语解释递归的书，可以看看道格拉斯·霍夫施塔特的*Gödel, Escher, Bach: An Eternal Golden Braid*，特别是第 5 章。除了递归之外，它还很好地解释了递归以易于理解的方式解释计算机科学和数学中的许多复杂概念，一种解释建立在另一种之上。如果你以前没有接触过这些概念，那它可能是一本非常令人兴奋的书。

* * *

## 回答 #5

> 赞同：9
> 
>             
> 
> 时间：2009-04-04T20:19:53.583

这更像是一个抱怨而不是一个问题。您对递归有更具体的问题吗？就像乘法一样，它不是人们经常写的东西。

说到乘法，想想这个。

问题：

a*b 是什么？

回答：

如果 b 为 1，则为 a。否则，它是 a+a*(b-1)。

什么是 a*(b-1)？有关解决问题的方法，请参见上述问题。

* * *

## 回答 #6

> 赞同：9
> 
>             
> 
> 时间：2009-04-04T21:04:21.387

我认为这个非常简单的方法应该可以帮助您理解递归。该方法将调用自身，直到某个条件为真，然后返回：

```
function writeNumbers( aNumber ){
 write(aNumber);
 if( aNumber > 0 ){
  writeNumbers( aNumber - 1 );
 }
 else{
  return;
 }
} 
```

此功能将打印出从您输入的第一个数字到 0 的所有数字。因此：

```
writeNumbers( 10 );
//This wil write: 10 9 8 7 6 5 4 3 2 1 0
//and then stop because aNumber is no longer larger then 0 
```

基本上发生的事情是 writeNumbers(10) 将写入 10 然后调用 writeNumbers(9) 将写入 9 然后调用 writeNumber(8) 等。直到 writeNumbers(1) 写入 1 然后调用 writeNumbers(0) 将写入 0 butt 不会调用 writeNumbers(-1);

此代码与以下代码基本相同：

```
for(i=10; i>0; i--){
 write(i);
} 
```

那么为什么要使用递归，你可能会问，如果 for 循环本质上是相同的。好吧，当您必须嵌套 for 循环但不知道它们嵌套多深时，您通常会使用递归。例如，当从嵌套数组中打印出项目时：

```
var nestedArray = Array('Im a string', 
                        Array('Im a string nested in an array', 'me too!'),
                        'Im a string again',
                        Array('More nesting!',
                              Array('nested even more!')
                              ),
                        'Im the last string');
function printArrayItems( stringOrArray ){
 if(typeof stringOrArray === 'Array'){
   for(i=0; i<stringOrArray.length; i++){ 
     printArrayItems( stringOrArray[i] );
   }
 }
 else{
   write( stringOrArray );
 }
}

printArrayItems( stringOrArray );
//this will write:
//'Im a string' 'Im a string nested in an array' 'me too' 'Im a string again'
//'More nesting' 'Nested even more' 'Im the last string' 
```

这个函数可以接受一个可以嵌套到 100 层的数组，而你编写一个 for 循环则需要你嵌套它 100 次：

```
for(i=0; i<nestedArray.length; i++){
 if(typeof nestedArray[i] == 'Array'){
  for(a=0; i<nestedArray[i].length; a++){
   if(typeof nestedArray[i][a] == 'Array'){
    for(b=0; b<nestedArray[i][a].length; b++){
     //This would be enough for the nestedAaray we have now, but you would have
     //to nest the for loops even more if you would nest the array another level
     write( nestedArray[i][a][b] );
    }//end for b
   }//endif typeod nestedArray[i][a] == 'Array'
   else{ write( nestedArray[i][a] ); }
  }//end for a
 }//endif typeod nestedArray[i] == 'Array'
 else{ write( nestedArray[i] ); }
}//end for i 
```

如您所见，递归方法要好得多。

* * *

## 回答 #7

> 赞同：9
> 
>             
> 
> 时间：2009-04-04T21:04:37.110

实际上，您使用递归来降低手头问题的复杂性。您应用递归，直到达到可以轻松解决的简单基本情况。有了这个，您可以解决最后一个递归步骤。并通过所有其他递归步骤解决您的原始问题。

* * *

## 回答 #8

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T20:46:23.800

我将尝试用一个例子来解释它。

你知道什么！方法？如果没有：[http ://en.wikipedia.org/wiki/Factorial](http://en.wikipedia.org/wiki/Factorial)

3！= 1 * 2 * 3 = 6

这里有一些伪代码

```
function factorial(n) {
  if (n==0) return 1
  else return (n * factorial(n-1))
} 
```

所以让我们尝试一下：

```
factorial(3) 
```

n 是 0 吗？

不！

所以我们用我们的递归深入挖掘：

```
3 * factorial(3-1) 
```

3-1 = 2

是 2 == 0？

不！

所以我们更深入！3 * 2 * 阶乘(2-1) 2-1 = 1

是 1 == 0？

不！

所以我们更深入！3 * 2 * 1 * 阶乘(1-1) 1-1 = 0

是 0 == 0？

是的！

我们有一个小案例

所以我们有 3 * 2 * 1 * 1 = 6

我希望对你有帮助

* * *

## 回答 #9

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T20:22:59.270

递归

方法 A，调用方法 A 调用方法 A。最终，这些方法 A 中的一个不会调用并退出，但它是递归，因为某些东西会调用自己。

我想打印出硬盘上的每个文件夹名称的递归示例：（在 C# 中）

```
public void PrintFolderNames(DirectoryInfo directory)
{
    Console.WriteLine(directory.Name);

    DirectoryInfo[] children = directory.GetDirectories();

    foreach(var child in children)
    {
        PrintFolderNames(child); // See we call ourself here...
    }
} 
```

* * *

## 回答 #10

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T20:50:01.030

递归函数只是一个函数，它可以根据需要多次调用自身。如果您需要多次处理某事，这很有用，但您不确定实际需要多少次。在某种程度上，您可以将递归函数视为一种循环。但是，就像循环一样，您需要指定要中断进程的条件，否则它将变为无限。

* * *

## 回答 #11

> 赞同：4
> 
>             
> 
> 时间：2009-04-05T11:49:26.330

构建递归函数的真正数学方法如下：

1：假设你有一个函数对 f(n-1) 是正确的，构建 f 使得 f(n) 是正确的。2：构建 f，使得 f(1) 是正确的。

这就是你如何证明这个函数在数学上是正确的，它被称为[Induction](http://en.wikipedia.org/wiki/Mathematical_induction)。相当于有不同的基本情况，或者对多个变量有更复杂的函数）。也等价于想象 f(x) 对所有 x 都是正确的

现在举一个“简单”的例子。构建一个函数，它可以确定是否有可能有 5 美分和 7 美分的硬币组合来赚取 x 美分。例如，2x5 + 1x7 可能有 17 美分，但不可能有 16 美分。

现在假设你有一个函数告诉你是否可以创建 x 美分，只要 x < n。调用此函数 can_create_coins_small。想象如何为 n 制作函数应该相当简单。现在构建你的函数：

```
bool can_create_coins(int n)
{
    if (n >= 7 && can_create_coins_small(n-7))
        return true;
    else if (n >= 5 && can_create_coins_small(n-5))
        return true;
    else
        return false;
} 
```

这里的诀窍是要意识到 can_create_coins 适用于 n 的事实，意味着您可以用 can_create_coins 代替 can_create_coins_small，给出：

```
bool can_create_coins(int n)
{
    if (n >= 7 && can_create_coins(n-7))
        return true;
    else if (n >= 5 && can_create_coins(n-5))
        return true;
    else
        return false;
} 
```

最后要做的一件事是有一个基本案例来停止无限递归。请注意，如果您尝试创建 0 美分，则可以通过没有硬币来实现。添加此条件给出：

```
bool can_create_coins(int n)
{
    if (n == 0)
        return true;
    else if (n >= 7 && can_create_coins(n-7))
        return true;
    else if (n >= 5 && can_create_coins(n-5))
        return true;
    else
        return false;
} 
```

可以证明此函数将始终返回，使用一种称为[无限下降](http://en.wikipedia.org/wiki/Infinite_descent)的方法，但这不是必需的。你可以想象 f(n) 只调用较低的 n 值，并且最终总是会达到 0。

要使用此信息来解决您的河内塔问题，我认为诀窍是假设您具有将 n-1 个平板电脑从 a 移动到 b 的功能（对于任何 a/b），尝试将 n 个表从 a 移动到 b .

* * *

## 回答 #12

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T20:14:05.267

你用的是哪本书？

真正优秀的算法标准教科书是 Cormen & Rivest。我的经验是它很好地教授递归。

递归是编程中较难掌握的部分之一，虽然它确实需要直觉，但它是可以学习的。但它确实需要一个好的描述、好的例子和好的插图。

此外，一般来说 30 页很多，单一编程语言的 30 页令人困惑。在您从一般书籍中了解递归之前，不要尝试学习 C 或 Java 中的递归。

* * *

## 回答 #13

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T20:54:21.050

[http://javabat.com](http://javabat.com)是一个有趣且令人兴奋的递归练习场所。他们的示例从相当简单的开始，并且经过广泛的工作（如果您想走那么远）。注意：他们的方法是通过练习来学习。这是我编写的一个递归函数，用于简单地替换 for 循环。  

for 循环：

```
public printBar(length)
{
  String holder = "";
  for (int index = 0; i < length; i++)
  {
    holder += "*"
  }
  return holder;
} 
```

这是做同样事情的递归。（注意我们重载了第一个方法以确保它像上面一样使用）。我们还有另一种方法来维护我们的索引（类似于上面 for 语句为您所做的方式）。递归函数必须维护自己的索引。

```
public String printBar(int Length) // Method, to call the recursive function
{
  printBar(length, 0);
}

public String printBar(int length, int index) //Overloaded recursive method
{
  // To get a better idea of how this works without a for loop
  // you can also replace this if/else with the for loop and
  // operationally, it should do the same thing.
  if (index >= length)
    return "";
  else
    return "*" + printBar(length, index + 1); // Make recursive call
} 
```

长话短说，递归是编写更少代码的好方法。在后面的 printBar 中，请注意我们有一个 if 语句。如果我们的条件已经达到，我们将退出递归并返回上一个方法，然后返回上一个方法，等等。如果我发送一个 printBar(8)，我得到 ********。我希望通过一个与 for 循环执行相同操作的简单函数的示例，这可能会有所帮助。不过，您可以在 Java Bat 上进行更多练习。

* * *

## 回答 #14

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T21:43:31.353

**Common Lisp**中的简单递归示例：

**MYMAP 将函数应用于列表中的每个元素。**

**1）**空列表没有元素，所以我们返回空列表 - () 和 NIL 都是空列表。

**2)**将该函数应用于第一个列表，为列表的其余部分调用 MYMAP（递归调用）并将两个结果合并到一个新列表中。

```
(DEFUN MYMAP (FUNCTION LIST)
  (IF (NULL LIST)
      ()
      (CONS (FUNCALL FUNCTION (FIRST LIST))
            (MYMAP FUNCTION (REST LIST))))) 
```

让我们看看跟踪的执行。在输入函数时，会打印参数。退出函数时，将打印结果。对于每个递归调用，输出将按级别缩进。

此示例对列表 (1 2 3 4) 中的每个数字调用 SIN 函数。

```
Command: (mymap 'sin '(1 2 3 4))

1 Enter MYMAP SIN (1 2 3 4)
| 2 Enter MYMAP SIN (2 3 4)
|   3 Enter MYMAP SIN (3 4)
|   | 4 Enter MYMAP SIN (4)
|   |   5 Enter MYMAP SIN NIL
|   |   5 Exit MYMAP NIL
|   | 4 Exit MYMAP (-0.75680256)
|   3 Exit MYMAP (0.14112002 -0.75680256)
| 2 Exit MYMAP (0.9092975 0.14112002 -0.75680256)
1 Exit MYMAP (0.841471 0.9092975 0.14112002 -0.75680256) 
```

这是我们的**结果**：

```
(0.841471 0.9092975 0.14112002 -0.75680256) 
```

* * *

## 回答 #15

> 赞同：3
> 
>             
> 
> 时间：2012-08-30T23:26:04.577

孩子隐含地使用递归，例如：

## 前往迪斯尼世界的公路旅行

> 我们到了吗？（没有）
> 
>   
>   
> 
> 我们到了吗？（很快）
> 
>   
>   
> 
> 我们到了吗？（几乎……）
> 
>   
>   
> 
> 我们到了吗？(SHHHH)
> 
>   
>   
> 
> 我们到了吗？（！！！！！）

这时候孩子睡着了...

这个倒计时功能是一个简单的例子：

```
function countdown()
      {
      return (arguments[0] > 0 ?
        (
        console.log(arguments[0]),countdown(arguments[0] - 1)) : 
        "done"
        );
      }
countdown(10);
```

[适用于软件项目的霍夫施塔特定律](http://psychology.wikia.com/wiki/Hofstadter's_Law)也是相关的。

> 根据乔姆斯基的说法，人类语言的本质是有限大脑产生他认为是无限语法的能力。他的意思不仅是我们可以说的内容没有上限，而且我们的语言的句子数量没有上限，任何特定句子的大小都没有上限。乔姆斯基声称，构成人类语言所有这些创造力的基本工具是递归：一个短语在同一类型的另一个短语中重复出现的能力。如果我说“John's Brother's house”，我有一个名词“house”，它出现在一个名词短语“brother's house”中，而该名词短语出现在另一个名词短语“John's Brother's house”中。这很有意义，而且它

**参考**

*   [递归与人类思想](http://edge.org/conversation/recursion-and-human-thought)

* * *

## 回答 #16

> 赞同：3
> 
>             
> 
> 时间：2011-09-17T05:10:51.513

要向 6 岁的孩子解释递归，先向 5 岁的孩子解释，然后再等一年。  

实际上，这是一个有用的反例，因为您的递归调用应该更简单，而不是更难。向 5 岁的孩子解释递归会更加困难，虽然你可以在 0 处停止递归，但你没有简单的解决方案来向 0 岁的孩子解释递归。

要使用递归解决问题，首先将其细分为一个或多个可以以相同方式解决的更**简单**问题，然后当问题简单到无需进一步递归即可解决时，您可以返回到更高级别。

事实上，这是一个关于如何用递归解决问题的递归定义。

* * *

## 回答 #17

> 赞同：2
> 
>             
> 
> 时间：2009-04-05T00:09:24.467

哎哟。去年我试图弄清楚河内塔。TOH 的棘手之处在于它不是一个简单的递归示例——你有嵌套的递归，它也会在每次调用中改变塔的角色。我能让它变得有意义的唯一方法是在我的脑海中想象出环的运动，并用语言表达递归调用将是什么。我会从一个戒指开始，然后是两个，然后是三个。我实际上在互联网上订购了游戏。我大概花了两三天的时间才得到它。  

* * *

## 回答 #18

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T20:43:59.563

在使用递归解决方案时，我总是尝试：

*   首先建立基本情况，即在阶乘解中 n = 1 时

*   尝试为所有其他情况提出一般规则

还有不同类型的递归解决方案，分和征服方法对分形和许多其他方法很有用。

如果您可以先解决更简单的问题以掌握其中的窍门，那也会有所帮助。一些示例是求解阶乘并生成第 n 个斐波那契数。

作为参考，我强烈推荐 Robert Sedgewick 的 Algorithms。

希望有帮助。祝你好运。

* * *

## 回答 #19

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:55:06.120

递归函数就像一个弹簧，每次调用都会压缩一点。在每个步骤中，您将一些信息（当前上下文）放在堆栈上。当到达最后一步时，弹簧被释放，立即收集所有值（上下文）！

不确定这个比喻是否有效...... :-)

无论如何，除了有点人为的经典例子（阶乘是最糟糕的例子，因为它效率低下且容易变平，斐波那契，河内......）有点人为（我很少，如果有的话，在实际编程案例中使用它们），它是有趣的是看看它在哪里真正使用。

一个非常常见的情况是走一棵树（或一个图，但一般来说，树更常见）。

例如，文件夹层次结构：要列出文件，您需要对它们进行迭代。如果您找到子目录，则列出文件的函数会以新文件夹作为参数调用自身。当从列出这个新文件夹（及其子文件夹！）返回时，它会恢复其上下文，到下一个文件（或文件夹）。

另一个具体案例是绘制 GUI 组件的层次结构时：通常有容器（如窗格）来保存组件，这些组件也可以是窗格，或复合组件等。绘制例程递归调用每个组件的绘制函数，它调用它所拥有的所有组件的绘制函数，等等。

不确定我是否很清楚，但我喜欢展示教学材料在现实世界中的使用，因为这是我过去偶然发现的东西。

* * *

## 回答 #20

> 赞同：1
> 
>             
> 
> 时间：2011-09-07T09:12:35.873

想想工蜂。它试图制造蜂蜜。它完成了它的工作，并期望其他工蜂生产剩下的蜂蜜。当蜂窝充满时，它就会停止。

把它想象成魔法。您有一个与您尝试实现的功能同名的功能，当您给它子问题时，它会为您解决它，您唯一需要做的就是将您的部分的解决方案与它的解决方案集成给你。

例如，我们要计算一个列表的长度。让我们调用我们的函数magic_length 和我们的魔法助手魔法长度我们知道，如果我们给出没有第一个元素的子列表，它将通过魔法给我们子列表的长度。那么我们唯一需要考虑的就是如何将这些信息与我们的工作结合起来。第一个元素的长度是 1，magic_counter 给了我们子列表 n-1 的长度，因此总长度是 (n-1) + 1 -> n

```
int magical_length( list )
  sublist = rest_of_the_list( list )
  sublist_length = magical_length( sublist ) // you can think this function as magical and given to you
  return 1 + sublist_length 
```

然而，这个答案是不完整的，因为我们没有考虑如果我们给出一个空列表会发生什么。我们认为我们拥有的列表总是至少有一个元素。因此，如果我们得到一个空列表并且答案显然是 0，我们需要考虑答案应该是什么。所以将此信息添加到我们的函数中，这称为基础/边缘条件。

```
int magical_length( list )
  if ( list is empty) then
    return 0
  else
    sublist_length = magical_length( sublist ) // you can think this function as magical and given to you
    return 1 + sublist_length 
```

# c++ - extern "C" 在 C 中是否有任何影响？

> ID：717729
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-04-04T20:12:32.180
> 
>         
> 
> 标签：c++, c, extern-c

我刚刚得到一些使用 extern "C" 来声明外部函数的 C 代码，如下所示：

```
extern "C" void func(); 
```

这是有效的C吗？我在这一行遇到错误，但我不确定是因为这个还是其他原因。

* * *

## 回答 #1

> 赞同：31
> 
>             
> 
> 时间：2009-04-04T20:19:09.107

不，它不是有效的 C。它只能在 C++ 代码中用于引用 C 代码中定义的函数。`extern "C"`应该被包围在/`ifdef __cplusplus`块`#endif`中：

```
// For one function
#ifdef __cplusplus
extern "C"
#endif
void func();

// For more than one function
#ifdef __cplusplus
extern "C"
{
#endif

void func1();
void func2();

#ifdef __cplusplus
}
#endif 
```

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2009-04-04T20:19:29.433

这是一种 C++ 表示法，用于告诉编译器/链接器使用 C 调用标准。

通常该行包含在预处理器语句中。

```
#ifdef __cplusplus
extern "C" {
#endif

// stuff

#ifdef __cplusplus
}
#endif 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T20:19:30.307

在 C 中无效。如果在预处理后出现，这将导致按照标准进行诊断。

对于 C++，这变成了名称修饰。有关为什么需要它的更多详细信息，请参阅[此内容。](http://www.research.att.com/~bs/bs_faq2.html#callC)你能发布更多细节吗？

# c# - 如果找不到指定的图像文件，显示默认图像的最佳方法是什么？

> ID：717734
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-04-04T20:15:26.340
> 
>         
> 
> 标签：c#, asp.net, language-agnostic

我有你的普通电子商务应用程序，我将 ITEM_IMAGE_NAME 存储在数据库中，有时经理会拼写错误的图像名称。

为了避免“丢失图像”（IE 中的红色 X），每次显示产品列表时，我都会检查服务器中与产品相关的图像，如果该文件不存在 - 我将其替换为默认图像。

据我所知，这不会影响性能，但我想知道**是否有任何替代方法可以解决“丢失图像”问题。**

我正在使用 ASP.NET + C# (.NET 3.5)

一些代码：

```
foreach (Item item in Items)
{
  string path = Path.Combine("~/images/", item.categoryImage);
  item.categoryImage = File.Exists(Server.MapPath(path)) ? item.categoryImage : GetImageDependingOnItemType();
} 
```

* * *

## 回答 #1

> 赞同：43
> 
>             
> 
> 时间：2009-04-04T20:23:56.023

您可能会考虑使用 javascript

```
<img src="image.jpg" onerror="this.onerror=null;this.src='default.jpg'"> 
```

编辑：或者如果请求了不存在的图像，则编程 404.aspx 返回默认图像。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-06T14:54:14.737

```
<style>
  .fallback { background-image: url("fallback.png"); }
</style>

<img class="fallback" src="missing.png" width="400" height="300"> 
```

如果`missing.png`加载，它将覆盖为其分配的空间，就好像未指定后备一样。（假设它不透明。）

如果`missing.png`加载失败，空间将改为填充`fallback.png`。你仍然会得到一个小“损坏的图像”图标，但我更喜欢这样......一个小提示说“修复我”。

如果您的图像大小不同，您会注意到默认情况下背景平铺。`background-repeat: no-repeat;`如果你不喜欢，你可以使用它。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2017-04-14T22:47:23.857

我喜欢 Erik 的解决方案，但在第一次执行后不删除事件，因为如果您在 MVC 局部视图中使用该代码，这将仅在第一次加载时起作用。所以我会选择：

```
<img src="image.jpg" onerror="this.src='default.jpg';" /> 
```

如果您在相同的情况下有许多图像，例如网格，您可以这样做：

```
$("img").on("error", function () {
    $(this).attr('src', 'default.jpg');
}); 
```

*当然，您可能想要使用更具体的 jQuery 选择器。*

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:27:19.667

您可以在服务器上指定对不存在的图像文件的所有请求应返回的图像。这样用户就可以获得“2 AWESUM 2 SHO”笑脸猫而不是红色的 x。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T20:30:56.753

我觉得你的方法还可以。我会在函数中执行或在 .categoryImage 访问器中执行。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T21:30:53.273

我想我会想办法让数据保持一致，而不是让用户输入不一致的数据。也许您的管理应用程序可以允许经理选择现有图像或上传新图像，然后根据此输入设置图像名称，这样您就可以确保图像存在。仅在从数据库中删除对图像的所有引用时才删除图像。将与数据的交互限制在您的应用程序中，这样人们就不会犯此类错误。

处理这个问题的另一种方法是使用一个处理程序（或 ASP.NET MVC 中的控制器），它根据 id 进行图像查找并返回图像数据。再加上缓存，这可能非常有效，并且还允许您进行图像替换。

# asp.net - 我可以从 EntityDataSource 调用存储过程吗？

> ID：717740
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T20:18:55.347
> 
>         
> 
> 标签：asp.net, entity-framework, stored-procedures

（ASP.net 3.5、C#、SQL Express 2008）

我想要一个 Web 表单，我可以在其中使用用户输入的关键字搜索“解决方案”（我的表格），然后在结果返回并填充 GridView 之后。

我已经通过连接到我的实体数据模型的存储过程进行了部分搜索。在此页面上，我有一个 EntityDataSource。**如何让这个 EntityDataSource 从我的存储过程中获取数据？**

我意识到我可以通过实体上下文（有效）获取结果，并将其绑定到网格，但是如果我不将它连接到 EntityDataSource，我将无法获得自动分页和排序（这是另一个我过去的斗争）

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T20:36:37.707

尝试使用`Function Import`.

1.  右键单击实体集名称（标题部分）

2.  选择添加->函数导入

这是一篇很好的博客文章供您查看。[ADO.NET 实体框架工具：存储过程，Guy Burstein](http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/12/17/ado-net-entity-framework-tools-stored-procedures.aspx)

**更新：**  对不起，我错过了关于的部分，`EntityDataSource`所以我不知道有任何属性暴露于从 EDS 访问函数导入，但您可以尝试使用 CommandText 属性。

```
<asp:EntityDataSource ID="SolutionsDataSource" runat="server" 
    CommandText="DataModel.SearchFunction(@Keywords)"
    ConnectionString="name=AdventureWorksEntities">
    <CommandParameters>
        <asp:ControlParameter Name="Keywords" 
            ControlID="SearchTextbox" Type="String"/>
    </CommandParameters>
</asp:EntityDataSource> 
```

**更新：**  嗯，看来我有一些坏消息。在使用[Reflector](http://www.red-gate.com/products/reflector/)深入研究`EntityDataSource`. `EntityDataSourceView`是使用 构造的`QueryBuilderUtils.ConstructQuery`，然后又调用`context.CreateQuery<T>`. 执行函数导入需要调用`context.ExecuteFunction<T>`. 在这个版本中似乎没有任何对 ExecuteFunction 的支持，我正在阅读的博客确实提到它是计划好的，但它没有进入这个版本，无论它是否会在未来的版本中我可以不说。

话虽如此，我建议使用`ObjectDataSource`，您可以以仍然支持分页、排序等的方式构建它。如果您打开有关此主题的 ObjectDataSource 问题，请在此处给我发评论，我会看看。

# perl - 如何阻止 pod2html 将“=head2 open() foo”视为函数定义？

> ID：717745
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T20:20:50.493
> 
>         
> 
> 标签：perl, perl-pod

我有一些看起来像的 POD

```
=head2 C<close() on unopened filehandle %s>

=over

=item C<Yer tryna close() %s what ain't been opened yet>

=back 
```

该`pod2html`命令将其变为

```
<h2><a name="close____on_unopened_filehandle__s"><a href="#item_close"><code>close () on unopened filehandle %s</code></a></a></h2>
<dl>
<dt><strong><a name="item_close"><code>Yer tryna close() %s what ain't been opened yet</code></a></strong>

</dl> 
```

问题是`<a href="#item_close"></a>`。我假设这样做是有帮助的（在通常情况下`=item func()`是函数定义的开始），但在我的情况下它是不合适的（这是一条警告消息）。

我已经尝试（没有成功）以下使 pod2html 不`=item open()`被视为函数定义：

```
=head2 C<closeZ<>() on unopened filehandle %s>

=head2 C<closeE<40>) on unopened filehandle %s>

=head2 C<closeE<0x28>) on unopened filehandle %s> 
```

最后两个不打印“（”。我是否错误地使用了 E<>？这是 pod2html 中的错误（我在 OS X 上使用 Perl 5.8.8）吗？

基于一个思想布赖恩的回答引发我尝试了另一个实验：

```
=head2 C<closeE<60>) on unopened filehandle %s> 
```

这应该导致`<code>close<) on unopened filehandle %s</code>`，但它却产生`<code>close) on unopened filehandle %s</code>`了。所以它看起来`pod2html`不喜欢数字实体。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T20:44:06.007

您使用的是哪个版本的 pod2html 和 Pod::Html（或任何您的 pod2html 加载）？我在我的 Mac 上使用的是 Pod::Html 1.0504，并且将始终尝试在它在 =item 中看到的文本的第一个实例上创建链接。请记住，您始终可以查看源代码以了解它为什么这样做:)

而且，我会避免在标题中使用 C<>。让处理器弄清楚如何显示这些。

如果你想要嵌套的内部序列，你可以添加更多的尖括号以使其更容易识别：

```
C<< closeE<40> >> 
```

尽管如此，我还是建议您使用 perldiag 格式，它对项目中的 open paren 没有任何特殊作用。如果您不喜欢现有的 pod2html，请自己编写；使用 Pod::Simple 真的很容易。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T21:43:40.277

看起来 Pod::Html 不喜欢里面的数字实体，`C<>`即使`perldoc`它们没有问题。如果我`C<>`脱掉

```
=head2 closeE<40>) on unopened filehandle %s 
```

它工作得很好（并防止`pod2html`创建虚假链接）。所以答案似乎是不要`C<>`在这里使用。

# r - 如何在 R 树状图中正确着色边缘或绘制矩形？

> ID：717747
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-04-04T20:21:37.387
> 
>         
> 
> 标签：r, edge-detection, dendrogram, hclust

我使用 R和函数生成了[这个树状图。](http://farm4.static.flickr.com/3622/3411762935_b9429d9d68_o.png)`hclust()``as.dendrogram()``plot.dendrogram()`

我使用这个`dendrapply()`函数和一个局部函数来给树叶上色，效果很好。

我有一个统计测试的结果，表明一组节点（*例如*树右下角的“ `_+v\_stat5a\_01_`”和“ ”簇）是否重要或重要。`_+v\_stat5b\_01_`

我还有一个可以使用的本地函数，它可以`dendrapply()`在我的树状图中找到包含重要叶子的确切节点。

我想（按照示例）：

1.  为连接“ `_+v\_stat5a\_01_`”和“ `_+v\_stat5b\_01_`”的边缘着色；或者，

2.  在“ ”和“ ”`rect()`周围画一个`_+v\_stat5a\_01_``_+v\_stat5b\_01_`

我有以下本地函数（“nodes-in-leafList-match-nodes-in-clusterList”条件的细节并不重要，但它突出了重要的节点）：

```
markSignificantClusters <<- function (n) {
  if (!is.leaf(n)) {
     a <- attributes(n)
     leafList <- unlist(dendrapply(n, listLabels))
     for (clusterIndex in 1:length(significantClustersList[[1]])) {
       clusterList <- unlist(significantClustersList[[1]][clusterIndex])
       if (nodes-in-leafList-match-nodes-in-clusterList) {
          # I now have a node "n" that contains significant leaves, and
          # I'd like to use a dendrapply() call to another local function
          # which colors the edges that run down to the leaves; or, draw
          # a rect() around the leaves
       }
     }
  }
} 
```

在此`if`块中，我尝试调用`dendrapply(n, markEdges)`，但这不起作用：

```
markEdges <<- function (n) {
  a <- attributes(n)
  attr(n, "edgePar") <- c(a$edgePar, list(lty=3, col="red"))
} 
```

`_+v\_stat5a\_01_`在我的理想示例中，连接“ ”和“ ”的边缘`_+v\_stat5b\_01_`将是红色的虚线。

我也试过`rect.hclust()`在这个`if`块中使用：

```
ma <- match(leafList, orderedLabels)  
rect.hclust(scoreClusterObj, h = a$height, x = c(min(ma), max(ma)), border = 2) 
```

但结果不适用于水平树状图（*即*带有水平标签的树状图）。[这是一个示例](http://farm4.static.flickr.com/3331/3410126060_f8f06c4498_o.png)（请注意右下角的红色条纹）。生成的东西的尺寸不正确`rect.hclust()`，我不知道它是如何工作的，以便能够编写我自己的版本。

我很感激任何关于获得`edgePar`或`rect.hclust()`正常工作的建议，或者能够编写我自己的`rect.hclust()`等价物。

**更新**

自从问了这个问题后，我`getAnywhere(rect.hclust())`就得到了计算参数和绘制`rect`对象的功能代码。我编写了这个函数的自定义版本来处理水平和垂直叶子，并用`dendrapply()`.

但是，有某种剪裁效果会删除部分`rect`. 对于水平叶子（绘制在树右侧的叶子），最右边的边缘`rect`要么消失，要么比 . 的其他三个边的边框宽度更薄`rect`。对于垂直叶子（在树底部绘制的叶子），最底部的边缘会`rect`遇到相同的显示问题。

作为标记重要簇的一种方法，我所做的是减小宽度，`rect`以便在簇边缘的尖端和（水平）叶子标签之间呈现垂直的红色条纹。

这消除了裁剪问题，但引入了另一个问题，即簇边缘尖端和叶子标签之间的空间只有六个左右像素宽，我对此没有太多控制权。这限制了垂直条纹的宽度。

更糟糕的问题是，`x`标记垂直条纹在两个元素之间的位置的坐标将根据较大树的宽度（`par["usr"]`）而变化，而这又取决于树层次结构的最终结构。

我写了一个“更正”，或者更确切地说，一个 hack 来调整这个`x`值和`rect`水平树的宽度。它并不总是始终如一地工作，但对于我正在制作的树木，它似乎不会太靠近（或重叠）边缘和标签。

最终，一个更好的解决办法是找出如何绘制，`rect`这样就没有剪裁了。或者一种一致的方法来计算`x`任何给定树的树边缘和标签之间的特定位置，以便正确地居中和调整条带的大小。

我也会对用颜色或线条样式注释边缘的方法非常感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-09T02:14:22.667

所以你实际上问了五个问题（5 +/- 3）。至于编写自己的类似 rect.hclust 的函数，`library/stats/R/identify.hclust.R`如果您想查看它，源代码就在其中。  

我自己快速浏览了一下，不确定它是否符合我阅读您的描述时的想法——它似乎正在绘制*多个*矩形，此外，`x`选择器似乎被硬编码以水平分隔标签（这是'不是你想要的，没有`y`）。

我会回来的，但与此同时，您可能（除了查看源代码之外）尝试使用不同`border=`颜色和不同`h=`值执行多个 rect.hclust 以查看是否出现故障模式。

**更新**

我在这方面也没有太多运气。  

一种可能的剪辑方法是用尾随空格填充标签，然后稍微将矩形的边缘带入（想法是仅将矩形带入将使其脱离剪辑区域但覆盖标签的末端）。

另一个想法是用半透明（低 alpha）颜色填充矩形，制作阴影区域而不是边界框。

# sharepoint - 如何修改共享点站点上的表单？

> ID：717757
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-04T20:28:15.933
> 
>         
> 
> 标签：sharepoint, moss, sharepoint-2007

我有一项任务需要为朋友执行，以修改 MOSS/Sharepoint 网站上的某些表单，以便为每个表单添加一些 javascript 以用于某些 SEO 跟踪目的。

我对 Sharepoint 有一点了解，但主要是通过使用 Sharepoint Designer 2007 工具。

我能够导航到该站点，并且可以在 Sharepoint Designer 中查看内容。但是，我看不到表格，我有点卡住了。

这是我需要修改的表单示例：
 [http ://www.MY_SITE_GOES_HERE.com/forms/covg_order.aspx](http://www.MY_SITE_GOES_HERE.com/forms/covg_order.aspx)

我在网上读了一点，但我被卡住了。我不知道这些是信息路径形式还是什么。我只需要修改表格。

这个问题有简单的答案吗？或者是一个很好的资源来快速完成这项任务？

我不是共享点专家，所以提前感谢您回答一个简单的问题。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T22:41:16.317

虽然这不是最简单的方法，但由于这是一个开发人员站点，我建议创建一个 DelegateControl 以添加到您的站点。使用 DelegateControls 有几个好处，例如：

*   通过功能有选择地激活和停用控件的能力

*   无需修改任何会破坏可支持性的开箱即用文件

*   逐页输出不同内容的能力

如果您需要基于默认站点定义之一部署到现有站点，您可以选择使用默认母版页的 DelegateControl 之一。AdditionalPageHead 是开发人员的最爱，因为它允许同时激活多个覆盖。

如果您想创建自己的母版页，您可以根据需要添加 DelegateControls。

如果您想了解有关 DelegateControls 的更多信息，可以查看[了解 SharePoint 日记](http://www.understandingsharepoint.com/journal/volume-1/issue-1)的第一期（免责声明：我编写了该问题）。此外，请查看有关[如何自定义委托控制](http://msdn.microsoft.com/en-us/library/ms470880.aspx)的 MSDN 文章。

.b

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-03-16T09:01:57.633

您还可以查看 PowerForms，这是一个完全自定义共享点表单的 silverlight webpart。您可以使用自定义程序集和许多其他高级任务在表单中添加业务逻辑。试试看，我想它会解决很多问题。
[http://www.bpc.gr/powerforms](http://www.bpc.gr/powerforms)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T22:08:46.193

你有几个选择：

1.  如果您需要添加唯一代码，例如 Google 分析，您可能应该将代码部署到[母版页](http://www.sharepointusecases.com/index.php/2009/03/deploy-custom-jquery-scripts-to-the-sharepoint-site-collection/)。

2.  如果您需要为列表自定义表单，则必须使用 SharePoint 设计器来完成。在这种情况下，您会发现带有 SharePoint Designer 页面或任何其他自定义页面的 EditItem.aspx 和 NewItem.aspx。打开 SPD，找到您的列表，展开它，查找 Forms 子文件夹，您将在那里找到所有表单。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T03:11:24.343

[自 2009 年 4 月 1 日起， Microsoft Office SharePoint Designer](http://office.microsoft.com/en-us/sharepointdesigner/FX100487631033.aspx)现已免费。这是一个很好的工具，不仅可以修改单个页面，还可以修改整个站点。

# c++ - 编译 vshadow 时出现链接器错误，卷影复制服务 SDK 的一部分

> ID：717759
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T20:29:06.760
> 
>         
> 
> 标签：c++, linker-errors, volume-shadow-service

尝试为 VSS SDK 编译 c++ 项目时出现此链接器错误

```
Error   1   error LNK2019: unresolved external symbol "long __stdcall ShouldBlockRevert(wchar_t const *,bool *)" (?ShouldBlockRevert@@YGJPB_WPA_N@Z) referenced in function "public: void __thiscall VssClient::RevertToSnapshot(struct _GUID)" (?RevertToSnapshot@VssClient@@QAEXU_GUID@@@Z)   revert.obj  vshadow 
```

ShouldBlockRevert 使用两次，一次在顶部声明时，一次在实际使用时。

在这里声明：

```
HRESULT APIENTRY ShouldBlockRevert(IN LPCWSTR wszVolumeName, OUT bool* pbBlock); 
```

并在这里使用：

```
CHECK_COM(::ShouldBlockRevert(Snap.m_pwszOriginalVolumeName, &bBlock));
    if (bBlock)
    {
        ft.WriteLine(L"Revert is disabled on the volume %s because of writers",
                Snap.m_pwszOriginalVolumeName);
        return;
    } 
```

抱歉，我对 C++ 不太擅长。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T20:32:12.837

根据[这篇](http://apocryph.org/2007/09/04/incredibly_annoying_gotcha_building_vshadow_sample_visual_studio_2005/)博文：

> 碰巧，我在 vssapi.lib 上运行了 dumpbin /exports，发现它确实导出了 ShouldBlockRevert，但是由于 C++ 名称修改，修改后的名称不同。为什么不一样？因为在 vssapi.lib 中，ShouldBlockRevert 的第一个参数不是 wchar_t，它是 unsigned short。“那又怎样”，你在想，“它们是等价的”。我并不反对，但编译器出于名称管理的目的将它们视为不同的类型。解决方法是什么？好吧，在项目属性的 C/C++ 语言属性页中禁用固有 wchar_t 类型（如果您是地球上使用 makefile 构建 Visual C++ 项目的两个人之一，则相当于 /Zc:wchar_t- 开关）。
> 
> 完成后，LPCWSTR 宏被定义为无符号短，名称修改匹配，行星对齐，您可以链接。QED。

# curve-fitting - 给定三个点如何计算抛物线的顶点

> ID：717762
> 
>         
> 
> 赞同：18
> 
>         
> 
> 时间：2009-04-04T20:30:45.553
> 
>         
> 
> 标签：curve-fitting

我有三个形成抛物线的 X/Y 点。我只需要计算通过这三个点的抛物线顶点是多少。最好是一种快速的方法，因为我必须做很多这些计算！

“Ask A Scientist”网站提供了[这个答案](http://www.newton.dep.anl.gov/askasci/math99/math99028.htm)：

> 抛物线的一般形式由以下等式给出： A * x^2 + B * x + C = y 其中 A、B 和 C 是任意实数常数。您有三对点，它们是 (x,y) 有序对。将每个点的 x 和 y 值代入抛物线方程。你会得到三个未知数的三个线性方程，三个常数。然后，您可以轻松地求解 A、B 和 C 值的三个方程组，并且您将获得与 3 个点相交的抛物线方程。顶点是一阶导数为 0 的地方，一点代数给出： ( -B/2A , C - B^2/4A ) 为顶点。

很高兴看到在 C# 或 C++ 中执行此计算的实际代码。有人吗？

* * *

## 回答 #1

> 赞同：33
> 
>             
> 
> 时间：2009-04-04T21:16:09.110

谢谢大卫，我将您的伪代码转换为以下 C# 代码：

```
public static void CalcParabolaVertex(int x1, int y1, int x2, int y2, int x3, int y3, out double xv, out double yv)
{
    double denom = (x1 - x2) * (x1 - x3) * (x2 - x3);
    double A     = (x3 * (y2 - y1) + x2 * (y1 - y3) + x1 * (y3 - y2)) / denom;
    double B     = (x3*x3 * (y1 - y2) + x2*x2 * (y3 - y1) + x1*x1 * (y2 - y3)) / denom;
    double C     = (x2 * x3 * (x2 - x3) * y1 + x3 * x1 * (x3 - x1) * y2 + x1 * x2 * (x1 - x2) * y3) / denom;

    xv = -B / (2*A);
    yv = C - B*B / (4*A);
} 
```

这就是我想要的。抛物线顶点的简单计算。稍后我将处理整数溢出。

* * *

## 回答 #2

> 赞同：25
> 
>             
> 
> 时间：2009-04-04T20:45:54.427

这实际上只是一个简单的线性代数问题，因此您可以象征性地进行计算。当您代入三个点的 x 和 y 值时，您将得到三个未知数的三个线性方程。

```
A x1^2 + B x1 + C = y1
A x2^2 + B x2 + C = y2
A x3^2 + B x3 + C = y3 
```

解决这个问题的直接方法是反转矩阵

```
x1^2  x1  1
x2^2  x2  1
x3^2  x3  1 
```

并乘以向量

```
y1
y2
y3 
```

这样做的结果是......好吧，并不是那么简单;-)我在 Mathematica 中做过，这里是伪代码中的公式：

```
denom = (x1 - x2)(x1 - x3)(x2 - x3)
A = (x3 * (y2 - y1) + x2 * (y1 - y3) + x1 * (y3 - y2)) / denom
B = (x3^2 * (y1 - y2) + x2^2 * (y3 - y1) + x1^2 * (y2 - y3)) / denom
C = (x2 * x3 * (x2 - x3) * y1 + x3 * x1 * (x3 - x1) * y2 + x1 * x2 * (x1 - x2) * y3) / denom 
```

或者，如果您想以数字方式进行矩阵数学运算，您通常会转向线性代数系统（例如[ATLAS](http://math-atlas.sourceforge.net/)，尽管我不确定它是否具有 C#/C++ 绑定）。

在任何情况下，一旦通过这些公式计算得到、 和的值`A`，您只需将它们代入问题中给出的表达式和，即可计算顶点的坐标。¹`B``C``-B / 2A``C - B^2/4A`

请注意，如果原始三个点的坐标会`denom`产生非常大或非常小的数字，则直接进行计算可能会产生重大的数值误差。在这种情况下，最好对其进行一些修改，以避免被分母除以它们无论如何都会抵消：

```
denom = (x1 - x2)(x1 - x3)(x2 - x3)
a = (x3 * (y2 - y1) + x2 * (y1 - y3) + x1 * (y3 - y2))
b = (x3^2 * (y1 - y2) + x2^2 * (y3 - y1) + x1^2 * (y2 - y3))
c = (x2 * x3 * (x2 - x3) * y1 + x3 * x1 * (x3 - x1) * y2 + x1 * x2 * (x1 - x2) * y3) 
```

然后顶点的坐标是`-b / 2a`和`(c - b^2 / 4a) / denom`。还有许多其他情况可能会从这样的“技巧”中受益，例如 if`A`非常大或非常小，或者 if`C`几乎等于，`B^2 / 4A`因此它们的差异非常小，但我认为这些情况变化很大，可以进行完整的讨论最好留给个案跟进问题。

将所有这些转换为您选择的语言的代码留给读者作为练习。（在任何使用标准中缀运算符语法的语言中，它应该是非常简单的，例如[C# 中显示的 AZDean](https://stackoverflow.com/a/717833/56541)。）

* * *

¹在答案的初始版本中，我认为这很明显，但似乎有很多人喜欢明确提及它。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T20:42:10.597

直接代入得到以下三个方程：

```
A*x1^2+B*x1+C=y1
A*x2^2+B*x2+C=y2
A*x3^2+B*x3+C=y3 
```

您可以通过注意这等效于矩阵乘积来解决此问题：

```
[x1^2 x1 1] [A]   [y1]
|x2^2 x2 1|*|B| = |y2|
[x3^2 x3 1] [C]   [y3] 
```

因此，您可以通过反转矩阵并将逆矩阵与右侧的向量相乘来获得 A、B 和 C。

我看到虽然我一直在发布此 John Rasch 已链接到教程，该教程更深入地实际求解矩阵方程，因此您可以按照这些说明获得答案。反转 3x3 矩阵非常容易，所以这应该不会太难。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2014-05-02T22:28:13.623

这是实现@david-z 和@AZDean 解决方案的Fortran 代码：

```
subroutine parabola_vertex(x1, y1, x2, y2, x3, y3, xv, yv)
real(dp), intent(in) :: x1, y1, x2, y2, x3, y3
real(dp), intent(out) :: xv, yv
real(dp) :: denom, A, B, C
denom = (x1 - x2) * (x1 - x3) * (x2 - x3)
A     = (x3 * (y2 - y1) + x2 * (y1 - y3) + x1 * (y3 - y2)) / denom
B     = (x3**2 * (y1 - y2) + x2**2 * (y3 - y1) + x1**2 * (y2 - y3)) / denom
C     = (x2 * x3 * (x2 - x3) * y1 + x3 * x1 * (x3 - x1) * y2 + &
            x1 * x2 * (x1 - x2) * y3) / denom
xv = -B / (2*A)
yv = C - B**2 / (4*A)
end subroutine 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2018-02-09T11:38:56.370

我做了一些类似于@piSHOCK 的回答，同样基于@AZDean 的代码。如果您需要大量运行它（或者像我一样在 Matlab 中使用它），这可能是最快的。

我的假设是`x1 == -1, x2 == 0, x3 == 1`。

```
a = y2 - ( y1 + y3) / 2   % opposite signal compared to the original definition of A
b = (y3 - y1) / 4         % half of the originally defined B

xExtr = b / a
yExtr = y2 + b * xExtr    % which is equal to y2 + b*b / a 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2017-04-13T13:45:26.217

```
def vertex(x1,x2,x3,y1,y2,y3):
    '''Given three pairs of (x,y) points return the vertex of the
         parabola passing through the points. Vectorized and common expression reduced.'''
    #Define a sequence of sub expressions to reduce redundant flops
    x0 = 1/x2
    x4 = x1 - x2
    x5 = 1/x4
    x6 = x1**2
    x7 = 1/x6
    x8 = x2**2
    x9 = -x7*x8 + 1
    x10 = x0*x1*x5*x9
    x11 = 1/x1
    x12 = x3**2
    x13 = x11*x12
    x14 = 1/(x0*x13 - x0*x3 - x11*x3 + 1)
    x15 = x14*y3
    x16 = x10*x15
    x17 = x0*x5
    x18 = -x13 + x3
    x19 = y2*(x1*x17 + x14*x18*x6*x9/(x4**2*x8))
    x20 = x2*x5
    x21 = x11*x20
    x22 = x14*(-x12*x7 + x18*x21)
    x23 = y1*(-x10*x22 - x21)
    x24 = x16/2 - x19/2 - x23/2
    x25 = -x17*x9 + x7
    x26 = x0*x1*x14*x18*x5
    x27 = 1/(-x15*x25 + y1*(x20*x7 - x22*x25 + x7) + y2*(-x17 + x25*x26))
    x28 = x24*x27
    return x28,x15 + x22*y1 + x24**2*x27 - x26*y2 + x28*(-x16 + x19 + x23) 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T20:39:58.450

这闻起来像家庭作业。“问一个科学家”是正确的。假设您的 3 个点是 (x1, y1)、(x2, y2) 和 (x3, y3)。然后，你得到三个线性方程：

```
| 中号11中号12中号13 | | 一个 | | Z 1 |
| 中号21中号22中号23 | * | 乙| = | Z 2 |
| 中号31中号32中号33 | | C | | Z 3 |

```

其中 M [11] = x [1] ² , M [12] = x [1] , M [13] = 1, Z [1] = y [1]，对于其他两行，使用 (x2, y2) 和 (x3, y3) 代替 (x1, y1)。

求解这个由 3 个方程组成的系统将为您提供 A、B 和 C 的解。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2018-07-18T14:20:24.830

在[https://ideone.com/y0SxKU运行](https://ideone.com/y0SxKU)

```
#include <iostream>
using namespace std;
// calculate the vertex of a parabola given three points
// https://stackoverflow.com/q/717762/16582

// @AZDean implementation with given x values

void CalcParabolaVertex(int x1, int y1, int x2, int y2, int x3, int y3, double& xv,  double& yv)
{
    double denom = (x1 - x2) * (x1 - x3) * (x2 - x3);
    double A     = (x3 * (y2 - y1) + x2 * (y1 - y3) + x1 * (y3 - y2)) / denom;
    double B     = (x3*x3 * (y1 - y2) + x2*x2 * (y3 - y1) + x1*x1 * (y2 - y3)) / denom;
    double C     = (x2 * x3 * (x2 - x3) * y1 + x3 * x1 * (x3 - x1) * y2 + x1 * x2 * (x1 - x2) * y3) / denom;

    xv = -B / (2*A);
    yv = C - B*B / (4*A);
}

// @piSHOCK immplementation assuming regular x values ( wrong!!! )

void CalcParabolaVertex2( int y1, int y2, int y3, double& xv,  double& yv)
{
double d1 = y1 - y2;
double d2 = y1 - y3;

double a =    -d1 + 0.5 * d2;
double b = 2 * d1 - 0.5 * d2;
double c = -y1;

xv =    -0.5      * b / a;
yv = c - 0.25 * b * b / a;  
}

// corrected immplementation assuming regular x values

void CalcParabolaVertex3( int y1, int y2, int y3, double& xv,  double& yv)
{
double d1 = y1 - y2;
double d2 = y1 - y3;

double a = d1 - 0.5 * d2;
double b = -2 * d1 + 0.5 * d2;
double c = y1;

xv =    -0.5      * b / a;
yv = c - 0.25 * b * b / a;  
}

int main() {
    double xv, yv;
    CalcParabolaVertex( 0, 100, 1, 500, 2, 200, xv, yv );
    cout << xv <<" "<< yv << "\n";
    CalcParabolaVertex2( 100, 500, 200, xv, yv );
    cout << xv <<" "<< yv << "\n";
    CalcParabolaVertex3( 100, 500, 200, xv, yv );
    cout << xv <<" "<< yv << "\n";
    return 0;
} 
```

我为负峰值添加了几个单元测试：在[https://ideone.com/WGK90S实时运行](https://ideone.com/WGK90S)

# ruby-on-rails - 来自多个页面的部分表单验证（fe login-partial）

> ID：717766
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T20:33:25.750
> 
>         
> 
> 标签：ruby-on-rails

我的 application.html.erb-layout 中有我的登录部分。

现在我想验证它，如果用户按下提交按钮并显示错误消息，例如密码字段为空。

但是我该怎么做呢？为了获取错误消息，我必须使用

```
render :action => 'create' 
```

但我必须知道，我来自哪个行动。除了不同的页面，还需要不同的单独实例变量（不能用 render :action 复制）。

第二次尝试

```
redirect_to :back 
```

丢失错误数组...！

我怎么解决这个问题？网上一无所获=(

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T23:46:21.247

所以不是你问题的直接答案，但我会跳过你自己的登录和结帐，比如[restful 身份验证插件](http://github.com/technoweenie/restful-authentication/tree/master)

```
script/plugin install git://github.com/technoweenie/restful-authentication.git
script/generate authenticated user sessions 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T15:46:48.550

我正在使用restful_authentication！

我将登录部分包含在我的 appliation.html.erb 布局中......？！

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-06T06:50:28.597

让我看看我是否正确地理解了你：

*   您的应用程序布局中有一个登录框。

*   当您按下提交按钮时，您将发布到会话控制器的创建操作

如果是这种情况，您可以只渲染会话控制器的新操作并渲染该页面。

因此，您可以从每个页面登录，但如果出现任何问题，您最终会进入会话控制器的新操作。

那会是一个选择吗？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-09T21:44:10.443

解决了 - 使用了 Ajax-Forms！

# iphone - UITableView 应用程序在向下滚动时崩溃

> ID：717775
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T20:38:35.863
> 
>         
> 
> 标签：iphone, objective-c, cocoa-touch

当我向下滚动表格时，应用程序崩溃了。而且我找不到代码中的错误在哪里。

这是我的代码：

```
NSMutableDictionary *tableDataDictionary;
NSInteger *rows_in_section;

-(void) initView
{
    if (!tableDataDictionary)
    {
        tableDataDictionary = [ [NSMutableDictionary alloc] init];
    }
    [self reloadTableData];
}

-(void)viewDidDisappear:(BOOL)animated {
    [super viewDidDisappear:animated];
    [mainTableView deselectRowAtIndexPath: [mainTableView indexPathForSelectedRow] animated:NO];

    [tableDataDictionary release];
    tableDataDictionary = nil;
    free(rows_in_section);
}

-(void) reloadTableData {
    [tableDataDictionary removeAllObjects];

    //Sections
    if (rows_in_section)
    {
        free(rows_in_section);
    }

    rows_in_section = (NSInteger*)calloc(25, sizeof(NSInteger));
    for (int i = 0; i <= 25; i++)
    {
        rows_in_section[i] = 0;
    }

    NSMutableArray *words_in_section = [ [NSMutableArray alloc] init];

    int cur_section = -1;

    while ( TRUE )
    {
        WordObject *tempWordObj = [ [WordsDatabase sharedWordsDatabase] getNextWordABC];
        if (!tempWordObj)
        {
            [tableDataDictionary setObject:words_in_section forKey:[NSNumber numberWithInt: cur_section] ];
            [tempWordObj release];

            [tableDataDictionary setObject:[words_in_section copy] forKey:[NSNumber numberWithInt: cur_section] ];
            [words_in_section removeAllObjects];

            break;
        }

        //First loop
        if (cur_section == -1) cur_section = toupper([ [tempWordObj word] characterAtIndex:0 ] ) - 'A';

        //If a has letter changed, assign the previous array to a dictionary
        if ( (toupper([ [tempWordObj word] characterAtIndex:0 ] ) - 'A') != cur_section )
        {
            [tableDataDictionary setObject:[words_in_section copy] forKey:[NSNumber numberWithInt: cur_section] ];
            [words_in_section removeAllObjects];
        }

        cur_section = toupper([ [tempWordObj word] characterAtIndex:0 ] ) - 'A';

        [words_in_section addObject:tempWordObj];

        [tempWordObj release];
        tempWordObj = nil;

        rows_in_section[cur_section]++;

    }

    [words_in_section release];

    [ [WordsDatabase sharedWordsDatabase] endGettingWordsABC];

    [mainTableView reloadData];
    [mainTableView scrollToRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0] atScrollPosition:UITableViewScrollPositionBottom animated:NO];

}

//
// Table handling
//

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 26;
}

// Customize the number of rows in the table view.
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return rows_in_section[section];
}

// Adding a section index here 
- (NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView 
{ 
    return ALPHA_ARRAY; 
} 

- (NSInteger)tableView:(UITableView *)tableView sectionForSectionIndexTitle:(NSString *)title atIndex:(NSInteger)index {
    return index;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    DebugLog(@"cellForRowAtIndexPath");
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:CellIdentifier] autorelease];
    }

    WordObject *tempWordObj = [ [tableDataDictionary objectForKey: [NSNumber numberWithInt:[indexPath section] ] ] objectAtIndex: [indexPath row] ];

    if (!tempWordObj)
    {
        DebugLog(@"!tempWordObj");
        return cell;
    }

    cell.text = [tempWordObj word];

    [tempWordObj release];

    return cell;
} 
```

如何通过向下滚动来解决这个问题以及为什么会发生？如果您在我的代码中发现任何其他缺点，请告诉我。

提前谢谢你，伊利亚。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T21:34:11.157

你不需要这条线；

```
[tempWordObj release]; 
```

[NSDictionary objectForKey] 返回一个自动释放的对象，即该对象将在您的函数返回后的某个时间自动释放。

# python - pylons + authkit 可以忽略具有 401 状态的特定响应吗？

> ID：717776
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T20:38:46.690
> 
>         
> 
> 标签：python, http, pylons, authkit

我正在编写一个 pylons 应用程序，并且我正在使用 authkit 进行身份验证/授权。如果用户未登录并点击需要授权的页面，authkit 会吞下 401（未经过身份验证）响应并重定向到登录页面。这对于 Web 界面非常有用，但对于我们的 Web 服务来说不是很好。当未经身份验证的用户使用受保护的 Web 服务时，我们希望将响应的状态设置为 401。

有没有办法在 pylons 中通过 authkit 传递一些 401 响应，但不是全部？

谢谢，马特

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-05T17:34:31.350

看起来[authkit.setup.intercept](http://wiki.pylonshq.com/display/authkitcookbook/Configuration)选项正是为了做到这一点而设计的。

# internet-explorer - 我的徽标在 Firefox 中有效，但在 IE 中无效

> ID：717785
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T20:43:45.227
> 
>         
> 
> 标签：internet-explorer, firefox, css

我在外部 css 样式表中引用的徽标在 Firefox 中运行良好，但在 Internet Explorer 中似乎无法运行：

下面是我正在使用的代码：

```
#header
    {
    width: 760px; 
    float: left;
    background-color:  #fff;
}

#header h1
    {
    float: left;
    font-size: 1em;
    text-indent:-9999px;
}

#header h1 a
{

background:#fff url(images/logo.jpg) no-repeat;

width:290px; 

height: 75px;

float:left;

text-decoration:none;

} 
```

任何人都可以提出一种方法，让我可以让这个徽标在 ie 中正确显示吗？

谢谢

马特

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T20:47:27.947

尝试添加`overflow: hidden`到任何浮动元素。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-12-04T18:20:54.553

如果您的徽标（图像）是 CMYK，则不会显示。请确保您的 logo 为 RGB 格式，否则其他浏览器不支持 \

科索沃定制发展

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-12-04T18:24:56.820

IE 可能会将链接视为文本，因此缩进锚点而不是锚点内的文本内容。

尝试将您的`text-indent`财产转移到锚的规则中。

```
#header h1 {
  float: left;
  font-size: 1em;
}

#header h1 a
{
  background:#fff url(images/logo.jpg) no-repeat;
  width:290px; 
  height: 75px;
  float:left;
  text-decoration:none;
  text-indent:-9999px;
} 
```

这有什么区别吗？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T20:49:17.770

尝试添加`display:block`到您的#header h1 a 类，如果仍然不起作用，请尝试将您的#header h1 a 更改`background`为类似粉红色的内容并验证其尺寸。

**更新：**  如果您的徽标已折叠，请尝试从中删除 float:left。您已经在标题和标题 h1 上有 float:left。您可能还想使用`clear`标签，或者更好的是，实现[clearfix](http://www.webtoolkit.info/css-clearfix.html)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T21:35:30.093

我肯定会为 IE 寻找类似 Firebug 的东西（肯定有一些东西......），然后点击一下。这不是一种太科学的方法，基本上只是反复试验，但我敢肯定，如果问题是这样的小问题，你可以通过这种方式很快找到问题的根源:) 祝你好运

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T21:43:12.260

实际上，尝试使用 display: none; 摆脱与“背景：”定义组合的标题元素中的文本。

# actionscript-3 - 让垂直标签靠得很近

> ID：717788
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T20:44:15.957
> 
>         
> 
> 标签：actionscript-3, layout, flex3

我不太明白为什么两个垂直标签组件不会出现在彼此的正下方。它们之间似乎有很多空间，无论如何要删除这个空间，因为设置填充根本没有区别。

例如，采用以下布局代码：

```
<mx:VBox>
<mx:Label text="Title" paddingBottom="0" paddingLeft="0" paddingRight="0" paddingTop="0" />
<mx:Label text="Second bit of text I want to appear right under the first" paddingBottom="0" paddingLeft="0" paddingRight="0" paddingTop="0" />
</mx:VBox> 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T20:49:26.447

您需要将`VBox`'s设置`verticalGap`为 0 或合适的值。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T20:48:50.143

保证金 = 0？

# web-services - 在 Web 服务模型中，是否仍然像客户端-服务器模型那样基本上有 3 层？

> ID：717799
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T20:51:38.267
> 
>         
> 
> 标签：web-services, model-view-controller, client-server

基本的客户端-服务器模型（即使使用有问题的接口实现）有一个表示层、一个业务层和一个数据层。使用 web 服务模型的目录和发现方法是否被认为是一个全新的层？我认为发现层实际上只是扩展了数据层的作用，以包含有关可以在何处找到服务的信息。我正在努力理解 web 服务和 MVC 框架之间的相互作用，并且我试图从更大的角度理解目录和发现组件适合该框架的位置。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T21:12:43.520

我想说还有一个附加层——服务层——它位于业务层和表示层或业务层和数据层之间，具体取决于您是在做瘦“客户端”还是“厚”“客户端”执行。该层将封装服务发现和交付，包括编组/解组数据以进行传输。请参阅 Fowler 的企业应用程序架构[服务层](http://martinfowler.com/eaaCatalog/serviceLayer.html)原则描述。在他的概念中，服务层位于业务层（领域模型）和表示层（UI）之间。这个概念将适用于瘦客户端或基于 Web 的客户端实现。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T05:02:24.653

我想说在 Web 服务模型中基本上没有 3 层。  

Web 服务本质上是 SOA（面向服务的体系结构），它可以暗示多层（n-tier）模型。它指的是分布式计算，可以扩展到具有数百个“层”的庞大系统。

我同意您的观点，从概念上讲，与数据库相比，从服务获取数据可能类似于从其他数据源（如数据库等）获取数据，并且可以将其视为数据的附加功能接入层。  

当然，这也取决于语义。“层”通常是指整个系统的离散部分（即前端、中间层、后端数据源、其他层，例如与 Web 服务的集成等）；而“层”通常是指代码中的垂直层，例如表示层、控制器层、业务逻辑层、数据访问层等。  

# c# - C# (.NET) 中的 string.Length 是即时变量吗？

> ID：717801
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-04-04T20:54:17.527
> 
>         
> 
> 标签：c#, .net, string

我想知道`string.Length`在 C# 中是否是一个即时变量。我的意思是即时变量，当我创建字符串时：

```
string A = "";

A = "Som Boh"; 
```

现在正在计算长度吗？

或者

是否仅在我尝试获取 A.Length 后才计算？

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-04-04T21:02:10.283

首先，请注意 .NET 中的字符串与存储在非托管语言（例如 C++）中的字符串非常不同......

1.  在 CLR 中，字符串的长度（以字符和字节为单位）实际上存储在内存中，以便 CLR 知道包含字符串的内存块（字符数组）有多大。`System.String`这是在创建字符串时完成的，并且由于类型是不可变的，因此不会更改。

2.  在 C++ 中，这是相当不同的，因为字符串的长度是通过读取直到第一个空字符来发现的。

由于 CLR 中内存使用的工作方式，您基本上可以认为获取`Length`字符串的属性就像检索`int`变量一样。如果您正在考虑的话，这里的性能成本绝对是最低的。

如果您想阅读更多关于 .NET 中的字符串的信息，请尝试[Jon Skeet 的](http://www.yoda.arachsys.com/csharp/strings.html)关于该主题的文章 - 它似乎包含了您可能想要了解的有关 .NET 中的字符串的所有详细信息。

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2009-04-04T21:03:17.660

不计算字符串的长度，它在构造时是已知的。由于 String 是不可变的，以后就不需要计算了。

.NET 字符串存储为包含字符计数和相应的一系列 unicode 字符的字段。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T21:04:40.357

.NET 字符串以预先计算的长度存储并存储在内部结构的开头，因此 .Length 属性只是获取该值，使其成为 O(1) 函数。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T21:01:10.597

看起来它是字符串的一个属性，这可能是在构造函数中设置的。由于它不是一个函数，我怀疑它是在你调用它时计算出来的。他们只是获取 Length 属性的值。

# api - 帮我找到“最丑”的消息队列 API

> ID：717806
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-04-04T20:57:42.150
> 
>         
> 
> 标签：api, message-queue

我意识到这是一个奇怪的问题，但我正在写一个演示文稿，我想讨论直观 API 和非直观 API 之间的区别。直观性与函数名称、复杂签名等有关。

我使用 JMS 作为我的直观示例（特别是因为它是面向对象的并且示例代码非常明显）。

我正在寻找一个令人信服的丑陋示例，最好不是面向对象的，最好是我可以复制一些 hello-world 代码。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T21:04:43.740

它可能是 SAS 脚本，但 MQ 一直是硬编码值和神秘参数的老鼠窝：[这种废话](http://support.sas.com/rnd/itech/doc/messageq/ibmmq/mqsamp.html#mac)会让任何**体面的**程序员都想吐。

# c - 有人使用 BetterAuthorizationSample 吗？

> ID：717808
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T21:00:21.677
> 
>         
> 
> 标签：c, macos, launchd, setuid

在 OS X 上，特权操作是通过 AuthorizationExecuteWithPrivileges() 完成的，Apple 发布了两个建议：

旧的 MoreAuth 使用 setuid 辅助工具。

当前的 BetterAuthorizationSample 用 launchd 文件在系统中乱扔垃圾。

我不知道使用后者的任何应用程序...

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-09-16T21:36:46.100

我现在正在尝试使用它。我唯一的反对意见是，当有人删除我的应用程序时，帮助工具会留在原处。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-08-20T21:11:05.667

我已经使用它了，实施起来很痛苦。FWIW，我知道 BBEdit 和 PGP Desktop 使用它。

# php - 使用 PHP 获取本地时间的观众？

> ID：717813
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T21:02:30.703
> 
>         
> 
> 标签：php, time, timezone

我需要允许用户每天在我的网站上执行一次特定操作，我希望它在用户本地时区的午夜重置。用 PHP 完成此任务的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T21:09:19.830

100% 的可靠性可能绝对是一个困难，但你可以接近。

Maxmind 有一个免费的 GeoIP 数据库：
 http: [//www.maxmind.com/app/ip-location](http://www.maxmind.com/app/ip-location)

使用 ip 数据库，您可以合理准确地确定他们可能在哪个时区。

更好的是使用浏览器时钟。它可以为您提供时区，但在实践中，似乎有大量用户的时区错误。如果您抓住系统时钟，将其四舍五入并猜测它们所在的时区偏移量将是最好的结果。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T21:04:49.777

也许您可以使用 javascript 在浏览器上获取时间并将其 AJAX 到您的 PHP 脚本。除了询问用户 AFAIK 之外，没有 100% 可靠的方法可以做到这一点。

# c# - 在 C# (.NET) 中是否有任何函数可以相应地比较字符串的长度？

> ID：717822
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T21:07:21.863
> 
>         
> 
> 标签：c#, string, compare

**对不起，不知道长度是在施工时计算的！！**

我有 200 个字符长的字符串 A，5 个字符的长字符串 B 如果我这样做

```
 int Al = A.length;
 int Bl = B.length; 
```

并比较一下——一切似乎都很好，但是如果我做这几百万次来计算一些东西，这对于我需要的东西来说太贵了。

更简单和更整洁的方法是一些可以比较两个字符串并告诉我另一个字符串何时至少与另一个字符串相同的函数。类似 (compare_string_lengths(stringA,stringB) -> 其中字符串 B 必须至少与字符串 A 一样长（字符）才能为函数返回 TRUE。

是的，我知道该函数不知道哪个字符串更短，但是如果两个字符串的长度将并行计算，那么当一个字符串超过另一个字符串时，函数就知道要“回答”什么。

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-04-04T21:12:13.630

如果您只需要知道字符串的长度是否不同（或者如果您希望在比较之前检查长度是否相等），我认为您不能比比较 Length 属性更快。从字符串中检索长度是一个 O(1) 操作。

要实际比较字符串，您需要查看每个字符，这使其成为 O(n) 操作。

*编辑：*

如果事情运行得太慢，您应该尝试查看分析器，最慢的部分是什么？也许是你的琴弦的构造需要时间？

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T21:15:16.320

没有什么比比较两个字符串的长度更便宜的了。

如果要在字符串列表中查找字符串，请使用 Hashtable，例如：

```
 var x = new System.Collections.Generic.Dictionary<string, bool>();
    x.Add("string", true);
    if (x.ContainsKey("string"))
        Console.WriteLine("Found string."); 
```

这是惊人的快。

# javascript - 变量范围的问题 (JavaScript)

> ID：717823
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T21:07:32.487
> 
>         
> 
> 标签：javascript, jquery, scope

我有以下 JavaScript（我正在使用 jQuery）：

```
function language(language)
{
    var text = new Object();

    $.ajax({
        type: "GET",
        url: "includes/xml/languages/" + language + ".xml",
        dataType: "xml",
        success: function(xml){
            $(xml).find('text').each(function(){
                text[$(this).attr('id')] = $(this).text();
            });
        }
    });

    return true;
} 
```

我有一个 XML 文件，然后该类正在读取该文件。XML 文件具有如下声明：

```
 <text id="must_be_string">Must be a string.</text>
    <text id="must_be_number">Must be a number.</text>
    <text id="must_be_integer">Must be an integer.</text> 
```

XML 文件被正确读取，但我遇到的问题是`text`变量似乎无法正常工作。

从放置一些警报停止点尝试调试，我发现这是正在发生的事情：

在内部，可以正确访问`success: function(xml){`var 。`text`但是，该函数内部为文本分配新短语的分配并没有正确添加它。在 中`success:`，我可以`alert(text['must_be_string'])`得到“必须是字符串”，但是当我离开 Ajax 调用时，它总是显示“未定义”。

如果我不清楚：

```
var text = new Object();

$.ajax({
    type: "GET",
    url: "includes/xml/languages/" + language + ".xml",
    dataType: "xml",
    success: function(xml){
        alert(text); // Shows [object Object]
        $(xml).find('text').each(function(){
            text[$(this).attr('id')] = $(this).text();
        });
        alert(text['must_be_string']); // Shows "Must be a string."
    }
});
alert(text['must_be_string']); // Shows undefined -- this is my problem 
```

我真的非常感谢任何帮助。请解释一下，因为我真的很想了解发生了什么。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T21:14:18.087

ajax调用的成功方法是异步调用。当您调用`$.ajax`该方法时，该方法将立即返回并尝试执行`alert(text['must_be_string']);`，直到 ajax 调用成功后才会设置，在将来的某个时间点。  

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T21:13:50.600

变量“文本”位于“语言”函数的范围内。我不确定 jQuery 如何管理范围，但我认为成功函数是一个不在“语言”范围内的新函数。

'language' 在到达返回时结束并发送 ajax 查询。但是，响应随后出现（异步）。

尝试将“文本”对象声明为全局的，在“语言”之外

# python - 自修复 Python 线程

> ID：717831
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-04T21:14:32.313
> 
>         
> 
> 标签：python, multithreading

我创建了一个访问美国和欧盟服务器的网络蜘蛛。美欧服务器是同一个数据结构，但是里面的数据不一样，我想整理一下。为了对服务器友好，每个请求之间都有一个等待时间。由于程序完全相同，为了加快处理速度，我对程序进行了线程化，使其可以同时访问欧盟和美国服务器。

这种爬行将花费数周而不是数天的时间。会有例外，虽然我试图处理程序中的所有内容，但很可能会出现一些奇怪的事情。为了真正对此进行防御，我想捕获一个失败的线程，记录错误并重新启动它。在最坏的情况下，我会丢失数千页中的一小部分，这比让线程失败并失去 50% 的速度要好。但是，根据我的阅读，Python 线程默默地死去。有没有人有任何想法？

```
class AccessServer(threading.Thread):
    def __init__(self, site):
        threading.Thread.__init__(self)
        self.site = site
        self.qm = QueueManager.QueueManager(site)

    def run(self):
        # Do stuff here

def main():
    us_thread = AccessServer(u"us")
    us_thread.start()

    eu_thread = AccessServer(u"eu")
    eu_thread.start() 
```

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-04-04T21:25:52.723

只需`try: ... except: ...`在方法中使用一个块`run`。如果发生一些奇怪的事情导致线程失败，那么很可能会在代码中的某个地方抛出错误（而不是在线程子系统本身中）；这样您就可以捕获它，记录它并重新启动线程。无论您是想真正关闭线程并启动一个新线程，还是只是将`try/except`块封闭在一个`while`循环中，以便同一个线程继续运行，这都是您的决定。

另一种解决方案是，如果您怀疑可能会发生一些您无法通过 Python 的错误处理机制检测到的非常奇怪的事情，则可以启动一个监视线程，该线程会定期检查其他线程是否正常运行。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T21:25:17.107

例如，您可以将主线程功能用作监控线程吗？例如，要求工作线程定期更新一些特定于线程的时间戳值，如果一个线程在合适的时间内没有更新它的时间戳，监控线程是否会杀死它并重新启动？

或者，看到[这个答案](https://stackoverflow.com/questions/394895/python-threads-stacksize-and-segfaults)

# api - uPNP/IGD 相对于 SOCKS 的优势？

> ID：717834
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T21:16:25.117
> 
>         
> 
> 标签：api, networking, upnp, socks

我很好奇为什么它更普遍。它有更好的 API 吗？

我记得很久以前当我第一次了解 NAT（我用它来共享拨号 14.4kbps 调制解调器）时，我认为有一天每个家庭都会有一个包含 NAT 的路由器，但它“显然”还需要一个 SOCKS 进程能够打开监听端口。当宽带开始出现时，很高兴看到 NAT 成为一个共同的功能，我认为 SOCKS 会是一个额外的，并且慢慢变得越来越普遍......但什么都没有！我不得不手动转发端口。然后出现了 uPNP，但很少有“严肃”的应用程序支持它，主要是 P2P 共享、游戏和一些 IM。

我还没有看到任何家庭路由器包含 SOCKS（当然，除了基于 Linux 的固件升级）。有人知道为什么吗？？

编辑：

正如 Vartec 所指出的，UPnP 是一种零配置和服务发现，而不是代理服务。现在我知道我指的是 IGD 协议，即家庭路由器中存在的 NAT 穿越服务，并通过 UPnP 发现。所以，我的问题应该是“为什么是 IGD/UPnP 而不是 SOCKS？”

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2010-03-07T10:25:55.723

与 UPnP 相比，SOCKS 具有局限性。通常 SOCKS 需要在每个客户端上进行配置，并且对应用程序不透明（Windows 上默认未安装/启用系统范围的套接字 SOCKSification），而即使没有 UPnP 的 NAT 也大多透明地工作，并且无需任何额外的客户端配置即可传出 TCP 套接字和传出的UDP。

带有 UPnP 的 NAT 也比 SOCKS 更好地支持服务器 TCP 套接字：SOCKS 只能接受带有其 BIND 请求的单个连接，这对于在 FTP 之类的协议中接收单个 TCP 连接是可以的，但对于运行需要接受许多的服务器无用来自许多客户端的连接。SOCKS 4 在 BIND 请求上也有 2 分钟的超时，但服务器通常不知道下一个客户端何时尝试连接。

低级 TCP 设置（例如 TCP Nagle、流量类）也不能通过 SOCKS 代理工作，但它们通过 NAT 工作。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T21:25:48.260

据我所知，UPnP 是本地网络中设备的 zeroconf 发现类型协议，而 SOCKS 是隧道代理服务器。它们完全不同，实际上我看不出它们有什么共同点。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T22:52:44.683

这是两个不同的东西，socks 是一种协议，它允许您通过代理服务器路由 tcp 和 udp（socks v5），它用于传出连接，路由器与此无关（除了它们也充当代理）

upnp 的 IGD 是一个“api”，它允许您告诉路由器您要打开一个端口并将其转发到计算机，这是用于传入连接..我的 linksys 默认启用了 upnp，并且我知道一个应用程序使用这个是 msn messenger (也许只用于文件传输)

# iphone - self.tabBarItem.title 不工作？

> ID：717844
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-04-04T21:24:45.143
> 
>         
> 
> 标签：iphone, uiviewcontroller, uinavigationcontroller, uitabbarcontroller, tabbar

在我的 iPhone 应用程序中，我有一个标签栏。此选项卡栏包含一个 UINavigationController。我有：

*   在 Interface Builder 中，将选项卡项标题设置为“新建”

*   在 UINavigation 控制器中，我拥有`self.tabBarItem.title = 'Create New';`和`self.title = 'Create New';`

*   在 UIViewController 推到控制器上： self.tabBarItem.title = 'Create New'; 但是`self.title = 'Blah';`。

但是，总是会显示推到导航控制器上的第一个视图控制器的 self.title (Blah)。您将如何设置标签栏项目的标题？谢谢，艾萨克·沃勒

* * *

## 回答 #1

> 赞同：25
> 
>             
> 
> 时间：2009-04-06T19:47:18.997

我发现如果我使用`self.navigationItem.title = 'Blah';`而不是`self.title`，它会起作用。  

* * *

## 回答 #2

> 赞同：18
> 
>             
> 
> 时间：2011-02-04T00:45:21.850

我刚刚解决了同样的问题。我`self.tabBarItem.item`用于我的第一个选项卡`tabBarController`，这是第一个也是唯一一个加载它的`navigationController`. 因此，对于标签栏中的第一个标签，您必须以不同的方式设置标题。我将尝试说明：

**带有 3 个选项卡的选项卡栏**（`UINavigationController`每个选项卡提供内容）

1.  标签 1

    *   加载 tab1NavController.m（设置`self.tabBarItem.item`为 '1st'）

    *   加载 tab1ViewController.m（设置`self.title`为 'tab1 View'

2.  标签 2

    *   加载 tab2NavController.m（设置`self.tabBarItem.item`为 '2nd'）

    *   加载 tab2ViewController.m（设置`self.title`为“选项卡视图”

3.  标签 3

    *   加载 tab3NavController.m（设置`self.tabBarItem.item`为 '3rd'）

    *   加载 tab3ViewController.m（设置`self.title`为 'tab3 View'

当标签栏`viewControllers`为 3 个标签中的每一个加载所有标签时，标签栏中的标签按钮具有以下标签：

1.  'tab1 视图'

2.  '第二'

3.  '第三'

这是因为在用户选择这些选项卡之前，不会加载第二个和第三个导航控制器。第一个选项卡在加载时`UITabBarController`加载，并且由于事件的顺序，它用`tabBarItem.title`navController 的 rootViewController替换了`self.title`。

## 解决方案

要解决此问题，您只需使用`self.navigationItem.title`而不是`self.title`. 您只需为第一个选项卡的 navController 的 rootViewController 执行此操作。

我希望这是有道理的。您确实解决了自己的问题，但我希望您和其他任何人都知道为什么它会这样工作。

# parsing - 使用 yyparse() 制作两遍汇编程序？

> ID：717848
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-04T21:25:59.853
> 
>         
> 
> 标签：parsing, assembly, bison, flex-lexer

我正在为正在开发的自定义微控制器编写汇编程序。我已经让汇编器达到了将指令汇编成二进制的程度。

但是，我现在在让标签工作时遇到问题。目前，当我的汇编程序遇到一个新标签时，它会存储标签的名称和它所引用的内存位置。当一条指令引用一个标号时，汇编器查找该标号并用适当的值替换该标号。

这很好，很漂亮，但是如果标签是在引用它的指令之后定义的呢？因此，我需要让我的解析器对代码运行两次。

这是我目前的主要功能：

```
303 int main(int argc, char* argv[])
304 {
305 
306     if(argc < 1 || strcmp(argv[1],"-h")==0 || 0==strcmp(argv[1],"--help"))
307     {
308         //printf("%s\n", usage);
309         return 1;
310     }
311     // redirect stdin to the file pointer
312     int stdin = dup(0);
313     close(0);
314 
315     // pass 1 on the file
316     int fp = open(argv[1], O_RDONLY, "r");
317     dup2(fp, 0);
318 
319     yyparse();
320 
321     lseek(fp, SEEK_SET, 0);
322 
323     // pass 2 on the file
324     if(secondPassNeeded)
325     {
326         fp = open(argv[1], O_RDONLY, "r");
327         dup2(fp, 0);
328         yyparse();
329     }
330     close(fp);
331 
332     // restore stdin
333     dup2(0, stdin);
334 
335     for(int i = 0; i < labels.size(); i++)
336     {
337         printf("Label: %s, Loc: %d\n", labels[i].name.c_str(), labels[i].memoryLoc);
338     }
339     return 0;
340 } 
```

我在 flex/bison 配置中使用它。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-04-05T15:04:36.000

如果这就是您所需要的，则不需要完整的两遍汇编程序。如果在引用时未定义标签，则只需输出一个替代地址（例如 0x0000）并具有一个数据结构，该结构列出了所有具有前向引用的位置以及它们所引用的符号。在文件末尾（如果有本地符号，则为块），您只需浏览该列表并修补地址。

# intellij-idea - 在 IntelliJ IDEA 上禁用拼写检查

> ID：717849
> 
>         
> 
> 赞同：254
> 
>         
> 
> 时间：2009-04-04T21:26:07.543
> 
>         
> 
> 标签：intellij-idea, spell-checking

我正在尝试在 MacOS 的 IntelliJ IDEA 8.1 版中禁用拼写检查。

我怎样才能禁用它？

* * *

## 回答 #1

> 赞同：408
> 
>             
> 
> 时间：2010-02-19T18:41:58.733

跟随 ：

```
File >> Settings >> Editor >> Inspections >> Proofreading >> Typo 
```

`->` **取消选中要禁用的选项。**

*更多详细信息的来源*  -[*使用 intelliJ进行拼写检查*](https://www.jetbrains.com/help/idea/2016.2/spellchecking.html)

* * *

## 回答 #2

> 赞同：24
> 
>             
> 
> 时间：2013-10-13T03:03:50.330

对于 OSX 上的 12.1.6：

`Preferences->Inspections->Spelling`

* * *

## 回答 #3

> 赞同：20
> 
>             
> 
> 时间：2016-05-28T13:16:02.387

我在这里整理了一个“视觉解决方案”（受此论坛中@user277236 上面/下面的先前解决方案的启发！）。

在 Webstorm 中，您可以：

1.  **完全**禁用拼写检查，或

2.  **有选择地**禁用拼写检查（例如仅代码），但启用其他一些（例如注释）。

我在 MacOS Webstorm（版本 2016.1.2）上。首先，像这样转到“检查”窗格......

```
Webstorm -> Preferences -> search for "Inspections" 
```

或者...

```
Webstorm -> Preferences -> Editor -> Inspections 
```

在检查搜索框中，搜索“拼写”。

# 选项 1 - 完全禁用拼写检查

[![在此处输入图像描述](https://i.stack.imgur.com/NWDPQ.png)](https://i.stack.imgur.com/NWDPQ.png)

# 选项 2 - 有选择地禁用拼写检查

[![在此处输入图像描述](https://i.stack.imgur.com/9Nu4b.png)](https://i.stack.imgur.com/9Nu4b.png)

我自己已经选择了选项2。到目前为止，这似乎对我有用。

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2016-09-22T14:25:33.207

在 Windows 和 Android 2.3 ...

文件 -> 设置 -> 检查 -> 拼写...

![](https://i.stack.imgur.com/fCIGS.jpg)

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2016-12-19T11:16:31.013

为类/方法/字段使用注解

```
@SuppressWarnings("SpellCheckingInspection") 
```

* * *

## 回答 #6

> 赞同：5
> 
>             
> 
> 时间：2016-09-07T15:15:54.680

他们需要像格式化程序一样引入**@spellcheck:off 。**

* * *

## 回答 #7

> 赞同：5
> 
>             
> 
> 时间：2020-06-01T18:51:26.160

2020年更新

```
File >> Settings >> Editor >> Inspections >> Proofreading (uncheck all) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/95JLF.png)](https://i.stack.imgur.com/95JLF.png)

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2015-03-10T17:12:16.927

对于 Android Studio，我直接在“项目设置”下找到“检查”，而不是在“IDE 设置/编辑器”下。

* * *

## 回答 #9

> 赞同：2
> 
>             
> 
> 时间：2017-11-16T10:12:57.560

如果你想在一个文件中抑制，你可以在文件中使用注释，就像`<!--suppress SpellCheckingInspection -->`在 html 中一样。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2015-02-15T16:12:20.727

在 Mac 上的 Android Studio 版本 1.1 上，从文件菜单设置拼写不起作用。

从 Android Studio > Preferences > Inspections 设置拼写。  

取消选中 Typo 并取消选中位于第一组选项“项目设置”中的 Spelling。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2015-12-23T01:54:27.890

在 MS 中，您可以使用`Alt+Enter`来禁用检查。

# rest - 有人可以简单地解释“超文本作为应用程序状态的引擎”吗

> ID：717851
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-04T21:27:35.387
> 
>         
> 
> 标签：rest

这似乎是我最难理解的 REST 主体。我知道在设计休息 api 时，大部分精力应该用于为应用程序设计/描述超文本。任何指向此主体的实际应用程序的指针？atom 协议如何应用此原则？有人可以简单地解释一下如何将其应用于假设的购物车休息 api。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-04-05T01:50:14.303

在尝试解释超媒体时，我喜欢使用通过路标而不是地图在汽车中导航的示例。我意识到它不能直接回答你的问题，但它可能会有所帮助。

驾驶汽车并到达特定十字路口时，会为您提供路标，以指示您可以从该点前往何处。同样，超媒体为您提供了一组基于您当前状态的选项。

传统的基于 RPC 的 API 更像是一张地图。使用地图，您倾向于根据一组静态道路数据来规划您的路线。地图的一个问题是它们可能会过时，并且它们不提供有关交通或其他动态因素的信息。

路标的优点是可以在运行中更改它们以绕行由于施工或控制交通流量。     

我并不是说路标总是比地图更好的选择。显然有利有弊，但了解这两种选择很有价值。超媒体也是如此。它是传统 RPC 接口的一个有价值的替代方案。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T21:51:08.310

考虑自己浏览一个常规网站。当您访问时，您会阅读页面的内容，并根据您阅读的内容和您想做的事情，点击页面上的各种链接。这确实是“作为应用程序状态引擎的超文本”归结为的核心。在此示例中，应用程序状态是您头脑中的状态和您所在的页面。基于此，您将遍历更多链接，这会改变您脑海中的应用程序状态。

请注意，它还有另一个元素：另一方面是您不需要猜测那些 URI：页面中应该有足够的上下文来推断 URI（例如应用程序将拥有的内容信息）类型，以及诸如 URI 模板之类的东西），或者应该存在要遵循的 URI。除此之外，RESTful HTTP 应用程序不应该关心 URI 的结构。

**更新：**为了扩展内容，HTML 表单也展示了 HATEOAS。使用 GET 的表单类似于使用 URI 模板。并且 HATEOS 不仅限于使用 HTTP GET 遍历链接：使用 POST（或其他方法，如果浏览器恰好支持它）的表单可以被视为描述要发送到服务器的表示。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T23:44:37.117

看待这个概念的另一种方式是状态由当前页面和嵌入其中的链接表示。遍历链接会更改由下一页表示的应用程序的状态。有点难以解释......在任何时间点可用的链接根据已经发生的操作定义了可用的操作。这是“当前状态”的一种定义。

诀窍是表示可用操作是对资源“起作用”的 URI。检索与 URI 关联的表示会隐式执行操作并检索产生的表示。URI 嵌入在表示中，用户理解与特定 URI 关联的操作。各种 HTTP 方法有助于定义发生的“动作”并指定何时不允许任何动作。这通常是人们在描述整个 RESTful 范式时所理解的。

# php - 如何获取当前范围/符号表中定义的所有变量？

> ID：717852
> 
>         
> 
> 赞同：56
> 
>         
> 
> 时间：2009-04-04T21:30:28.110
> 
>         
> 
> 标签：php, debugging, scope

PHP 中是否有函数和/或对象和/或扩展可以让您查看当前范围内定义的所有变量？就像是：

```
var_export($GLOBALS) 
```

但只显示当前符号表中的变量。

* * *

## 回答 #1

> 赞同：64
> 
>             
> 
> 时间：2009-04-04T21:39:43.750

[`get_defined_vars`](http://www.php.net/manual/en/function.get-defined-vars.php)

> 此函数返回一个多维数组，其中包含所有已定义变量的列表，无论是环境变量、服务器变量还是用户定义的变量，都在**`get_defined_vars()`**调用的范围内。

* * *

## 回答 #2

> 赞同：23
> 
>             
> 
> 时间：2009-04-04T21:39:53.517

[get_defined_vars()](http://php.net/get_defined_vars)完全符合您的要求。

> 此函数返回一个多维数组，其中包含所有已定义变量的列表，无论是环境变量、服务器变量还是用户定义变量，都在调用**get_defined_vars()**的范围内。

```
>>> function test($foo) { print_r(get_defined_vars()); }
>>> test('bar');
Array
(
    [foo] => bar
) 
```

# php - 来自 PHP 内部的 SFTP

> ID：717854
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-04-04T21:31:45.407
> 
>         
> 
> 标签：php, ftp, curl, sftp

我正在构建一个 Web 应用程序，除其他外，它还需要连接到 FTP 服务器以下载或上传文件。该应用程序是用 PHP 编写的，它托管在 Linux 服务器上。

我想知道是否也可以提供对 SFTP 服务器的支持，但是在 Google 上进行了一些快速搜索之后，似乎这并不是那么简单。

所以，问题是：在 PHP 中使用 SFTP 的最佳方式是什么？是否有一个类也可以为 FTP 和 SFTP 提供支持，以便两者都可以使用相同的功能？

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-04-04T21:36:01.340

是的，你可以用[cURL](http://www.php.net/manual/en/book.curl.php)做到这一点。要从 FTP 切换到 SFTP，您只需将协议选项形式更改`CURLPROTO_FTP`为`CURLPROTO_SFTP`.

cURL 支持以下协议：HTTP、HTTPS、FTP、FTPS、SCP、SFTP、TELNET、LDAP、LDAPS、DICT、FILE、TFTP。

顺便提一句。不要将 SFTP 与 FTPS 混淆。SFTP 是 SSH 文件传输协议，而 FTPS 是 FTP over SSL。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-07-01T17:13:13.880

如果您没有安装 cURL（我的主机没有），您可以使用 phpseclib：

[http://phpseclib.sourceforge.net/documentation/net.html#net_sftp](http://phpseclib.sourceforge.net/documentation/net.html#net_sftp)

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2011-01-04T10:36:27.847

以防有人最终出现在此页面上。

您也可以将[PHP Bindings for LIBSSH2](http://php.net/manual/en/book.ssh2.php)与 PHP 一起使用。它应该适当地安装在系统上。

在 Ubuntu 10.04 和 Debian Lenny 中，当然还有所有依赖项

```
apt-get install libssh2-php 
```

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2011-01-09T00:34:22.913

Igor 建议的问题在于，除其他外，它使得可移植代码少得多（libssh2 没有安装在很多主机上），它具有更直观的基于 OOP 的 API 并且 RSA 身份验证实际上是有意义的（libssh2 需要您将公钥和私钥分别存储在文件系统上；必须单独提供它们的事实是愚蠢的，因为大多数私钥格式都*包含*公钥）。

phpseclib 也更快：

[http://kevin.vanzonneveld.net/techblog/article/make_ssh_connections_with_php/#comment_3759](http://kevin.vanzonneveld.net/techblog/article/make_ssh_connections_with_php/#comment_3759)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2019-02-04T07:41:13.283

```
$dataFile      = 'PASTE_FILE_NAME_HERE';
$sftpServer    = 'PASTE_SFTP_SERVER_NAME_HERE';
$sftpUsername  = 'PASTE_USERNAME_HERE';
$sftpPassword  = 'PASTE_PASSWORD_HERE';
$sftpPort      = 'PASTE_PORT_HERE';
$sftpRemoteDir = '/';

$ch = curl_init('sftp://' . $sftpServer . ':' . $sftpPort . $sftpRemoteDir . '/' . basename($dataFile));

$fh = fopen($dataFile, 'r');

if ($fh) {
    curl_setopt($ch, CURLOPT_USERPWD, $sftpUsername . ':' . $sftpPassword);
    curl_setopt($ch, CURLOPT_UPLOAD, true);
    curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_SFTP);
    curl_setopt($ch, CURLOPT_INFILE, $fh);
    curl_setopt($ch, CURLOPT_INFILESIZE, filesize($dataFile));
    curl_setopt($ch, CURLOPT_VERBOSE, true);

    $verbose = fopen('php://temp', 'w+');
    curl_setopt($ch, CURLOPT_STDERR, $verbose);

    $response = curl_exec($ch);
    $error = curl_error($ch);
    curl_close($ch);

    if ($response) {
        echo "Success";
    } else {
        echo "Failure";
        rewind($verbose);
        $verboseLog = stream_get_contents($verbose);
        echo "Verbose information:\n" . $verboseLog . "\n";
    }
} 
```

# .net - 为什么函数是前缀比 C# 中的 Startswith 快？

> ID：717855
> 
>         
> 
> 赞同：19
> 
>         
> 
> 时间：2009-04-04T21:34:08.070
> 
>         
> 
> 标签：.net, performance, string, startswith

有谁知道为什么 C# (.NET) 的[StartsWith](http://msdn.microsoft.com/en-us/library/system.string.startswith.aspx)函数比[IsPrefix](http://msdn.microsoft.com/en-us/library/system.globalization.compareinfo.isprefix.aspx)慢很多？

* * *

## 回答 #1

> 赞同：35
> 
>             
> 
> 时间：2009-04-04T21:49:42.773

我认为它主要是获取线程的当前文化。

如果您更改 Marc 的测试以使用以下形式`String.StartsWith`：

```
 Stopwatch watch = Stopwatch.StartNew();
    CultureInfo cc = CultureInfo.CurrentCulture;
    for (int i = 0; i < LOOP; i++)
    {
        if (s1.StartsWith(s2, false, cc)) chk++;
    }
    watch.Stop();
    Console.WriteLine(watch.ElapsedMilliseconds + "ms; chk: " + chk); 
```

它更接近了。

如果你使用`s1.StartsWith(s2, StringComparison.Ordinal)`它比使用快得多`CompareInfo.IsPrefix`（当然取决于`CompareInfo`）。在我的盒子上，结果是（不科学的）：

*   s1.StartsWith(s2): 6914ms

*   s1.StartsWith(s2, false,culture): 5568ms

*   比较.IsPrefix(s1, s2): 5200ms

*   s1.StartsWith(s2, StringComparison.Ordinal): 1393ms

显然这是因为它实际上只是在每个点比较 16 位整数，这非常便宜。如果您*不*想要对文化敏感的检查，*并且*性能对您来说特别重要，那么这就是我要使用的重载。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T21:43:40.607

好问题; 进行测试，我得到：

```
9156ms; chk: 50000000
6887ms; chk: 50000000 
```

试验台：

```
using System;
using System.Diagnostics;
using System.Globalization;    

class Program
{
    static void Main()
    {
        string s1 = "abcdefghijklmnopqrstuvwxyz", s2 = "abcdefg";

        const int LOOP = 50000000;
        int chk = 0;
        Stopwatch watch = Stopwatch.StartNew();
        for (int i = 0; i < LOOP; i++)
        {
            if (s1.StartsWith(s2)) chk++;
        }
        watch.Stop();
        Console.WriteLine(watch.ElapsedMilliseconds + "ms; chk: " + chk);

        chk = 0;
        watch = Stopwatch.StartNew();

        CompareInfo ci = CultureInfo.CurrentCulture.CompareInfo;
        for (int i = 0; i < LOOP; i++)
        {
            if (ci.IsPrefix(s1, s2)) chk++;
        }
        watch.Stop();
        Console.WriteLine(watch.ElapsedMilliseconds + "ms; chk: " + chk);
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-04-04T21:39:02.223

StartsWith 在内部调用 IsPrefix。它在调用 IsPrefix 之前分配文化信息。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2013-06-22T08:32:04.900

查看 IsPrefix 的来源。问题是 - 在某些情况下，它会比`StartsWith`仅仅因为它实际上使用 StartsWith 并且只执行很少的操作而变慢。

```
 [System.Security.SecuritySafeCritical]  // auto-generated
    public unsafe virtual bool IsPrefix(String source, String prefix, CompareOptions options)
    { 
        if (source == null || prefix == null) {
            throw new ArgumentNullException((source == null ? "source" : "prefix"), 
                Environment.GetResourceString("ArgumentNull_String")); 
        }
        Contract.EndContractBlock(); 
        int prefixLen = prefix.Length;

        if (prefixLen == 0)
        { 
            return (true);
        } 

        if (options == CompareOptions.OrdinalIgnoreCase)
        { 
            return source.StartsWith(prefix, StringComparison.OrdinalIgnoreCase);
        }

        if (options == CompareOptions.Ordinal) 
        {
            return source.StartsWith(prefix, StringComparison.Ordinal); 
        } 

        if ((options & ValidIndexMaskOffFlags) != 0) { 
            throw new ArgumentException(Environment.GetResourceString("Argument_InvalidFlag"), "options");
        }

        // to let the sorting DLL do the call optimization in case of Ascii strings, we check if the strings are in Ascii and then send the flag RESERVED_FIND_ASCII_STRING  to
        // the sorting DLL API SortFindString so sorting DLL don't have to check if the string is Ascii with every call to SortFindString. 

        return (InternalFindNLSStringEx(
                    m_dataHandle, m_handleOrigin, m_sortName, 
                    GetNativeCompareFlags(options) | Win32Native.FIND_STARTSWITH | ((source.IsAscii() && prefix.IsAscii()) ? RESERVED_FIND_ASCII_STRING : 0),
                    source, source.Length, 0, prefix, prefix.Length) > -1);
    } 
```

# javascript - 如何将参数传递给鼠标滚轮事件？

> ID：717860
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T21:36:43.913
> 
>         
> 
> 标签：javascript, jquery

```
for (var n = 0; n < 10; n++) {
  $('#content-scroll' + n).mousewheel(function(event, delta) {
    if (delta > 0) sliderUp(n - 1);
    else if (delta < 0) sliderDown(n - 1);
    return false; // prevent default
  });
  n++;
} 
```

我对这段代码有疑问，变量“n”没有传递给鼠标滚轮函数，它只会将鼠标滚轮添加到数字 9（最后一个数字）而不是所有 10 个元素。谁能解释如何将变量传递给该函数以使其保持不变？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T21:50:15.457

我对此使用完全 jQuery 解决方案的看法。

```
$("[id^='content-scroll']").mousewheel( function(event,delta) {
     var n = this.id.replace(/content-scroll/,'');
     if (delta > 0)
        sliderUp(n);
     else if (delta < 0)
        sliderDown(n);
     event.preventDefault();
}); 
```

**编辑**：实际上，我什至可能会尝试找出一种将实际匹配控件传递给滑块 * 函数的方法，但不知道它们实际上做了什么，我不知道它如何或是否会起作用。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T21:40:24.887

我相信这是 javascript 中的闭包问题， n 实际上是对外部 n 变量的引用。我相信以下应该起作用：

```
for(var n=0;n<10;n++)
{
  var localN = n;
  $('#content-scroll'+n).mousewheel(function(event, delta) {
    if (delta > 0) sliderUp(localN-1);
    else if (delta < 0) sliderDown(localN-1);
    return false; // prevent default
  });

  //is this really needed??
  //n++;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-05T02:49:19.637

这在 SO 上被问了很多（[例如](https://stackoverflow.com/questions/643542/doesnt-javascript-support-closures-with-local-variables)）。您需要一个闭包来“捕获”`n`每次迭代中的值：

```
for(var n=0;n<10;n++)
{
    (function(n){
        $('#content-scroll'+n).mousewheel(function(event, delta) {
            if (delta > 0) sliderUp(n-1);
            else if (delta < 0) sliderDown(n-1);
            return false; // prevent default
        });
    })(n);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T21:40:34.247

你的`n`价值观应该是 0-9 还是 1-10？

如果是 0-9，则将所有`n-1`表达式更改为 just `n`。

如果是 1-10，则将`for`循环更改为`var n=1,n<=10;n++`，并将所有`n-1`引用更改为`n`。

另外，删除`n++`底部的 ，因为您的`for`循环已经增加了 的值`n`。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-05T02:02:42.027

代码不起作用的原因是因为在循环期间未评估 n 变量。

您在传递给函数的循环中创建了一个匿名函数`mousewheel`，因此在鼠标滚轮发生之前不会执行匿名函数中的代码。到那时，n 变量的值是 10，或者如果您在代码中的其他任何地方使用该变量，则可能是完全不同的值。

如果您改为使用该`Function`函数从字符串创建函数，则可以将 n 变量的当前值注入代码中：

```
for(var n=0; n<10; n++) {

   $('#content-scroll' + n).mousewheel(
      Function('event', 'delta',
         'if (delta > 0) sliderUp(' + (n-1) + ');' +
         'else if (delta < 0) sliderDown(' + (n-1) + ');' +
         'return false; // prevent default'
      )
   );

} 
```

但是，它应该是（n-1）吗？`content-scroll0`是否应该调用元素的鼠标滚轮事件`sliderup(-1)`？

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-11T13:02:15.597

JQuery 特别允许传递事件数据，在这种情况下，这可能对您有用，也可能不会：

```
for(var n=0;n<10;n++)
{
  $('#content-scroll'+n).bind('mousewheel', {index:n}, function(event, delta) {
    var innerN = event.data.index;
    if (delta > 0) sliderUp(innerN-1);
    else if (delta < 0) sliderDown(innerN-1);
    return false; // prevent default
  });
} 
```

# gcc - 更改 $ sudo gcc 的搜索目录

> ID：717873
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T21:44:10.837
> 
>         
> 
> 标签：gcc, haskell, sudo

在 OS X 上，我正在尝试为 haskell 的 Cabal 安装 zlib 先决条件。我收到此错误：

```
$ sudo ./Setup build
Preprocessing library zlib-0.5.0.0…
ld: library not found for -lgmp
collect2: ld returned 1 exit status
linking dist/build/Codec/Compression/Zlib/Stream_hsc_make.o failed
command was: /usr/bin/gcc -lz -L/sw/lib/ghc-6.8.3/lib/bytestring-0.9.0.1.1 -L/sw/lib/ghc-6.8.3/lib/array-0.1.0.0 -L/sw/lib/ghc-6.8.3/lib/base-3.0.2.0 -L/sw/lib/ghc-6.8.3 -lm -lgmp -ldl dist/build/Codec/Compression/Zlib/Stream_hsc_make.o -o dist/build/Codec/Compression/Zlib/Stream_hsc_make 
```

库 -lgmp 位于 /sw/lib 中，因此如果我手动添加 -L/sw/lib，我可以成功运行该命令（“/usr/bin/gcc ...”）。问题是 sudo 不知道 /sw/lib。看哪：

```
$ gcc -print-search-dirs | grep sw
libraries: =/lib/i686-apple-darwin9/4.0.1/:/lib/:/usr/lib/i686-apple-darwin9/4.0.1/:/usr/lib/:./i686-apple-darwin9/4.0.1/:./:/sw/lib/i686-apple-darwin9/4.0.1/:/sw/lib/:/usr/lib/gcc/i686-apple-darwin9/4.0.1/:/usr/lib/gcc/i686-apple-darwin9/4.0.1/:/usr/lib/gcc/i686-apple-darwin9/4.0.1/../../../../i686-apple-darwin9/lib/i686-apple-darwin9/4.0.1/:/usr/lib/gcc/i686-apple-darwin9/4.0.1/../../../../i686-apple-darwin9/lib/:/usr/lib/gcc/i686-apple-darwin9/4.0.1/../../../i686-apple-darwin9/4.0.1/:/usr/lib/gcc/i686-apple-darwin9/4.0.1/../../../
$ sudo gcc -print-search-dirs | grep sw
$ 
```

如何告诉 sudo 版本的 gcc 在 /sw/lib 中查找库？我是否在 root 的 .bash_profile 上添加环境变量？如果有，是哪一个？

**更新：**
可能有更合适的方法来做到这一点，但这就是有效的。我在其中创建了一个 bash 脚本：

```
#!/bin/sh
export LIBRARY_PATH=/sw/lib:$LIBRARY_PATH
./Setup build 
```

然后我跑了

```
$ sudo ./script.sh 
```

那编译zlib没有抱怨 - 万岁！不幸的是 cabal-install 仍然给我错误：

```
$ ./Setup configure
Configuring cabal-install-0.6.2…
Setup: At least the following dependencies are missing:
zlib >=0.4 && <0.6 
```

所以我回到了 cabal-install 目录（这是我首先要做的），然后运行......

```
$  ./bootstrap.sh 
```

...并且按预期安装了所有内容。    

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-05T19:00:40.770

你为什么`sudo`一直用？您不应该以超级用户身份编译。以普通用户身份编译并以超级用户身份安装。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T16:20:45.227

GHC 现在带有一个 OS X 安装程序（Leopard，不确定 Tiger）。唯一的问题是，如果您使用 macports 或 fink，它们可能不会看到您已安装 GHC，并尝试安装它们自己的版本。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T21:55:38.517

尝试设置`LDFLAGS=-L/sw/lib`。

# php - $_SERVER["SCRIPT_URI"] 不工作？选择？

> ID：717874
> 
>         
> 
> 赞同：16
> 
>         
> 
> 时间：2009-04-04T21:44:33.333
> 
>         
> 
> 标签：php

这很奇怪，但由于某种原因，`$_SERVER["SCRIPT_URI"]`当我在子页面/子页面中时，它不会返回域名，而只会在主页上工作。不确定它是由于脚本（WordPress）还是主机造成的，但是请您建议任何可靠的解决方案来使用 PHP 检索域名？

* * *

## 回答 #1

> 赞同：28
> 
>             
> 
> 时间：2009-04-04T21:49:37.097

如果您需要域名，请使用：

```
$_SERVER['HTTP_HOST'] 
```

* * *

## 回答 #2

> 赞同：21
> 
>             
> 
> 时间：2009-04-04T22:23:41.507

有疑问时

```
var_dump($_SERVER); 
```

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T21:53:18.147

根据您的需要，我将使用以下方法之一：

1.  $_SERVER['PHP_SELF'] 用于脚本文件位置

2.  $_SERVER['SERVER_NAME'] 用于主机名

[从 php 文档](http://uk.php.net/manual/en/reserved.variables.server.php)

编辑：也许 PHP_SELF 不是最好的。看评论。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T21:48:09.160

这可能是由于 URL 重写，如果您想要在 url 中调用的路径，您可以尝试 $_SERVER['REQUEST_URI'] 。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2018-02-27T21:21:06.943

我在我的网站 
[http://www.a2zidx.com](http://www.a2zidx.com)
和一些子目录（如
[http://howto.a2zidx.com ）上使用了 $_SERVER[SCRIPT_URI]](http://howto.a2zidx.com)

多年来我一直对此没有任何问题，今天在许多未分配 $_SERVER[SCRIPT_URI] 的站点上出现错误。在联系我的 isp 后，他们声称他们没有进行任何更改，但 $_SERVER[SCRIPT_URI] 不再有效。getenv('SCRIPT_URI') 不会失败，但会返回一个空字符串。为什么会在这么多年后突然发生，我不知道。我最终调用了一个函数来通过各种选项来提取我想要的文件名。希望这涵盖了一切。我在包含该函数时遇到了问题，但检查了“SCRIPT_NAME”“PHP_SELF”“SCRIPT_FILENAME”SCRIPT_URI”

希望他的帮助。

如果有人知道为什么 SCRIPT_URI 会突然停止工作，我很想知道。服务器当前正在运行 Apache 2.4。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T22:28:22.900

`var_dump($_SERVER)`看看什么适合您的需求。

*PS 使用 unsanitized`$_SERVER["PHP_SELF"]`可能存在[安全风险](http://google.com/search?q=$_SERVER['PHP_SELF']%20security%20risk)。*

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2014-07-11T10:27:55.153

此外，SCRIPT_URI 不存在，正确的语法是 REQUEST_URI：

`echo $_SERVER["REQUEST_URI"];`它返回没有主机和域的整个路径。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2018-03-15T02:35:21.310

迟到迟到的回复。我使用这段脚本将信息存储在我的数据库中。希望这可能对某人有所帮助。如何获取您的完整网址和客户端访问的 IP 地址。

```
if (!empty($_SERVER['HTTP_CLIENT_IP'])){
  $ip=$_SERVER['HTTP_CLIENT_IP'];
//Is it a proxy address
}elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])){
  $ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
}else{
  $ip=$_SERVER['REMOTE_ADDR'];
}

$url = $_SERVER['SERVER_NAME'].$_SERVER['SCRIPT_NAME'];

echo $ip;
echo "<br>";
echo $url; 
```

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2018-11-03T14:21:41.687

在 Apache 上，SCRIPT_URI 仅在启用 mod_rewrite 时存在。

阿帕奇要求：

> rewrite_module（注意：使用平台特定的加载语法）

和

> 重写引擎开启

Apache 配置文件中相应位置的语句。

然后重新启动 Apache，它应该可以正常工作。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2020-10-10T10:02:17.040

`SCRIPT_URI`不喜欢，因为当您的站点使用根域运行时，它没有任何价值。它仅在您使用子目录时出现。

`HTTP_HOST`当我们使用以下代码获取子目录时，这不是一个好主意`SCRIPT_URI`：

```
$SCRIPT_URI = $_SERVER['REQUEST_SCHEME']."://".$_SERVER['HTTP_HOST'].'/'.ltrim(dirname($_SERVER['SCRIPT_URL']),'/'); 
```

* * *

## 回答 #11

> 赞同：-3
> 
>             
> 
> 时间：2011-10-06T19:00:27.630

如果您的浏览器很好地格式化`JSON`文档并且没有发生输出，则插入以下内容将导致比以下内容更具可读性`var_dump`：

```
header('Content-Type: application/json');die(json_encode($_SERVER)); 
```

`phpinfo()`还将提供所有`$_SERVER`值的列表等等！

# php - PHP脚本完成后不会结束

> ID：717875
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T21:44:55.110
> 
>         
> 
> 标签：php, ini-set

我正在处理图像上传脚本并遇到了这个问题。使用 ImageMagick 我会用完调整大小和上传图像的时间，所以我插入了这两行：

```
set_time_limit(120);
ini_set('max_input_time', 120); 
```

然而，现在脚本永远不会结束。即使它可以正常上传、调整大小和插入数据库，它也会持续运行页面。这些是否以某种方式相互冲突？它甚至超过了我设置的时间限制 120 秒。

编辑：这是脚本的完整图像编辑部分，它适用于 1 或 2 张图像，但当我放入更多（从而使其花费更长的时间）时，它不会。

```
set_time_limit(120);
ini_set('max_input_time', 120);
$resource = NewMagickWand(); 
MagickReadImage($resource,$image); 
MagickSetImageCompressionQuality( $resource, 100);
$resource = MagickTransformImage($resource,'0x0','660x500'); 
MagickWriteImage($resource, $image);
DestroyMagickWand($resource); 
```

这是我用来读取所有要上传的图像的代码：（reSizePic 是调用上述代码的函数）

```
$numberImages = count($_FILES['galFile']['name'])-1;

    for($i=1;$i<=$numberImages;$i++)
    {
    $imageName = $_FILES['galFile']['name'][$i];
                $imageType = $_FILES['galFile']['type'][$i];
                $imageSize = $_FILES['galFile']['size'][$i];
                $imageTemp = $_FILES['galFile']['tmp_name'][$i];
                $imageError = $_FILES['galFile']['error'][$i];

                //Make sure it is an image
                if(in_array(end(explode(".", $imageName)), $allowed))
                {
                     //Where to upload image to
                     $uploadFile = $uploadDir . $imageName;
                     if (file_exists($uploadFile))
            {
                //What to do if file already exists
                //Append random number to the end
                $front = explode(".", $imageName);
                $randomNum = rand(1,100);
                $front[0] = $front[0].$randomNum;
                $imageName = $front[0].".".$front[1];
                $uploadFile = $uploadDir . $imageName;
            }
                      if(move_uploaded_file($imageTemp,$uploadFile))
                      {
                      //Add $imageName to DB
                       $query = "INSERT INTO galleryImages VALUES(\"0\",\"$lastInsert\",\"$imageName\",\"$i\")";
                   mysql_query($query);
                   reSizePic($uploadFile);
                      }
                } 
```

列维

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-05T02:03:45.503

您应该确保只调用一次 set_time_limit()，因为每次调用它时，计时器都会被重置。

例如，如果您在脚本中调用 set_time_limit(30) 10 seconds，那么您的脚本总共将运行 40 秒。所以在每个 resizePic() 调用上设置它是一个坏主意。

# flash - 动作脚本的哪一部分在场景中，哪一部分在剪辑中？

> ID：717877
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T21:45:33.470
> 
>         
> 
> 标签：flash, actionscript-2, flash-cs3

我刚刚在 Flash 中完成了学校的一项小任务，我想知道将一些动作脚本放在场景中而将其他动作放在电影剪辑中的原因。

信息：我正在使用 Flash CS3 和 ActionScript 2。

我在这里上传了文件，任何想看看的人：[http ://www.mediafire.com/download.php?2z2mivtmokg](http://www.mediafire.com/download.php?2z2mivtmokg)

现在，我完成了影片剪辑中的所有动作脚本，我想知道，为什么当我尝试从场景中执行它时它不起作用？假设我从剪辑中的 Actions 层获取所有代码，复制它，删除该层，转到场景，在那里制作和 Actions 层并通过代码，为什么它不起作用？

我尝试将 circle_mc（我的剪辑的名称）添加到代码中，但无济于事......

有人可以在这里帮助我吗？试图让它没有代码出现在影片剪辑中，因为我认为这是我最初的任务。

进一步挖掘：我应该如何决定哪些代码进入场景，哪些进入电影剪辑？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T22:22:38.827

如果你在一个movieclip中并且你可以使用“this.something”，它指的是你正在使用的movieclip......即：“circle_mc”，但如果你去根时间线并创建一个动作层你可以'不再使用“this”，您必须引用影片剪辑名称。因此，如果您在根时间轴上创建了一个名为操作的新层，您可以粘贴此代码，它仍然可以工作（删除您的旧代码，也在 mc 中）：

```
var stoppedOn = 2;

circle_mc.onPress = function()
{
    circle_mc.startDrag();
}

circle_mc.onRelease = function()
{
    circle_mc.stopDrag();
}

circle_mc.onRollOver = function()
{
    circle_mc.gotoAndPlay(stoppedOn);
}

circle_mc.onRollOut = function()
{
    circle_mc.stop();
    stoppedOn = circle_mc._currentframe;
} 
```

我个人认为，如果您将所有代码都放在根时间轴上，您的代码将更易于维护。它还将让您为以后使用类做好准备。我还建议您在业余时间学习 AS3，因为这确实是一条好路。

# c# - 将文件上传到服务器后无法从客户端删除文件

> ID：717878
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T21:46:36.293
> 
>         
> 
> 标签：c#, asp.net, .net-3.5, file-upload

我正在使用 asp:FileUpload 控件将文件上传到服务器。没什么好看的，只是

```
FileUploadId.Save(); 
```

文件成功上传，一切都很好，直到我尝试在客户端上删除该文件。我收到一条古老的“文件正在被其他人或程序使用”消息。

如何确保文件上传后不会在客户端上被访问？

### 编辑

删除文件与应用程序无关。我只是想手动删除文件，因为我不再需要它了。

### 编辑2

关闭浏览器解决了问题......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T22:10:17.920

由于 IE 和 FF 都出现问题：是不是文件被某些杀毒软件锁定了？

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-03-10T15:25:44.720

问题可能是文件即使在上传后也可能被 aspnet 进程锁定。关闭 IE 后，aspnet 进程会释放文件

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T22:00:22.390

您如何尝试在客户端删除文件？除非您在 中托管`WebBrowser`或使用 ActiveX 控件之类的东西，否则您的客户端只有 javascript - 并且不提供随机文件访问。

那么：这里的完整设置是什么？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T22:10:11.960

一个想法。可能不是文件上传导致问题。由于没有发布周围的代码，因此很难分辨，但是，例如，您是否有某种您没有处理的 Zip 管理器对象？

# language-agnostic - 遗传算法的每一代应该有多少个单元？

> ID：717885
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-04T21:49:47.393
> 
>         
> 
> 标签：language-agnostic, genetic-algorithm

我正在制作一个 roguelike 并且正在使用 GA 来生成关卡。我的问题是，我的 GA 的每一代应该有多少个级别？而且，它应该有多少代？每一代都有几个级别，多代，还是相反？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-04T22:25:08.010

这种类型的事情确实没有硬性规定——大多数实验都喜欢在最少的人群中使用至少 200 名成员，扩大到数百万或更多。代数通常在 100 到 10,000 之间。一般来说，要回答您的最后一个问题，最好在种群中有很多成员，以便“晚熟”基因在种群中停留足够长的时间以成熟，然后使用较少的世代。

但实际上，这些都不是最重要的。**任何 GA 最关键的部分是适应度函数**。如果你没有一个像样的适应度函数来准确评估你认为是“好”或“坏”的水平，那么无论你使用多少代，你都不会得到有趣的结果，或者你的人口有多大:)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T22:43:02.087

正如迈克所说，您需要尝试不同的数字。如果人口众多，则需要确保具有良好的选择功能。在人口众多的情况下，很容易导致 GA 在早期收敛到“不太好”的答案。

# asp.net-mvc - 如何从命令行发布 ASP.NET MVC 项目？

> ID：717888
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-04-04T21:51:10.540
> 
>         
> 
> 标签：asp.net-mvc, model-view-controller, aspnet-compiler

我有一个现有的网站，它监视 SVN 存储库的更改，当签入时，新网站是使用 aspnet_compiler 构建的，然后生产站点上的内容的差异是 sftp 到生产网络服务器。整个持续集成过程是使用 Cruisecontrol.net 构建的。

我已经重构了整个站点以使用 ASP.NET MVC，现在我正在尝试将其集成到我的构建过程中。这似乎已经改变了，我没有得到与以前的 MVC 站点相同的行为。不幸的是，我没有取得太大进展，因为似乎还没有人这样做。有没有人有这样的东西可以以任何形式工作？

像“常规项目”一样使用“devenv”自动化命令行也不起作用。有 /Build 命令行开关，但它们只是就地构建。此命令行不公开 UI 中内置的“发布”机制。项目目录中甚至还有一个 {Project Name}.Publish.xml 文件，它看起来像是需要发布的清单。只是没有办法自动化。

我只是想从命令行模拟 VS 2008 MVC 项目中构建菜单下的“发布 {项目名称}”。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2010-03-05T15:56:29.973

如果您使用 CruiseControl.net，那么您已经完成了 85% 的工作。你可以使用 NAnt 吗？那肯定是要走的路。

如果没有，那么我会考虑从命令行使用[msbuild而不是 devenv，因为它不是为了做你想做的事而设计的。](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)

[NAnt](http://nant.sourceforge.net/)绝对是一个不错的选择。虽然，尽管他们对 msbuild 进行了所有更改，但它无疑是一个很好的竞争者。Nant 最近才重新焕发了活力，因此它应该仍然是一个很好的选择。

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2009-04-04T23:05:47.710

当您创建 MVC 项目时，这是一个标准的 .net 项目，而不是“Web 项目”，它们不是一回事。我认为 aspnet_compiler 仅适用于 Web 项目，所以也许这就是导致您出现问题的原因。我不知道您使用的是哪个构建工具，但请尝试像构建任何其他 .net 项目一样构建它。

# asp.net - 需要生成一个json数组，然后遍历values

> ID：717901
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T22:02:53.070
> 
>         
> 
> 标签：asp.net, javascript, json

我需要为页面上的一堆元素创建某种状态。统计数据可以是 1 或 -1。

现在在服务器端，我将生成一个 JSON 数组并将其放在我的 .aspx 页面中，如下所示：

```
var someArray = { 100:-1, 1001:1, 102:1, 103:-1 } 
```

我现在如何在javascript中遍历每个值？

顺便说一句，我的 JSON 数组格式正确吗？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-04T22:05:55.840

请注意，这`someArray`是用词不当，因为它实际上是一个对象。但是，要遍历它：

```
for(key in someArray) {
    alert(someArray[key]);
} 
```

至于它是否有效，以上对我有用，但我相信技术上的键应该是字符串：

```
{
    "100": -1,
    "1001": 1,
    "102": 1,
    "103": -1 
} 
```

[查看这个方便的 JSON 验证器](http://www.jsonlint.com/)。

# .net - 来自单个查询的 DataRelation

> ID：717904
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-04T22:04:42.770
> 
>         
> 
> 标签：.net, sql, vb.net, dataset, datarelation

我有以下一段 VB.NET 代码：

```
 Dim conn As New MySql.Data.MySqlClient.MySqlConnection(ConnectionString)
    conn.Open()

    Dim sql = "SELECT * FROM users"
    Dim com = New MySql.Data.MySqlClient.MySqlCommand(sql, conn)

    Dim ds As New DataSet("dsUsers")

    Dim da As New MySql.Data.MySqlClient.MySqlDataAdapter()
    da.SelectCommand = com
    da.TableMappings.Add("Table", "Users")
    da.Fill(ds)

    sql = "SELECT * FROM messages"
    com = New MySql.Data.MySqlClient.MySqlCommand(sql, conn)

    Dim da2 As New MySql.Data.MySqlClient.MySqlDataAdapter()
    da2.SelectCommand = com
    da2.TableMappings.Add("Table", "Messages")
    da2.Fill(ds)

    Dim dr As DataRelation
    Dim col1 As DataColumn
    Dim col2 As DataColumn

    col1 = ds.Tables("Users").Columns("id")
    col2 = ds.Tables("Messages").Columns("users_id")
    dr = New DataRelation("UsersMessages", col1, col2)

    ds.Relations.Add(dr) 
```

基本上，我执行两个查询：第一个获取所有用户，第二个获取所有消息。我在 DataSet 中定义了两个表，并通过 DataRelation 将它们链接起来，因此 Users 表是 Messages 表的父表。

如果我想从两个表中选择所有行，这很有效，但是如果我有一个包含 4 个嵌套表和条件查询的更复杂的结构怎么办？

```
SELECT t1.*, t2*, t3.*, t4.*
FROM table1 t1, table2 t2, table3 t3, table4 t4
WHERE t1.id = 3
      AND t2.t1_id = t1.id
      AND t3.t2_id = t2.id
      AND t4.t3_id = t3.id 
```

如何通过这个单一查询创建一个包含四个表和三个 DataRelation 的 DataSet？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-05T01:40:50.067

这样做的唯一方法是编写执行此操作的代码，即在数据集中创建表，设置表之间的关系并使用结果中的某些字段填充表。

没有自动执行此操作的方法，因为结果中没有关于每个字段来自哪个表的信息，甚至没有查询哪些表来获取结果。

# c# - 多个项目之间的重复功能

> ID：717906
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-04T22:04:53.330
> 
>         
> 
> 标签：c#, asp.net, code-duplication, multiple-projects

我目前在两个社交网站上工作，它们有很多共同点，但又截然不同。我发现自己为两者（包括 UI）编写了很多相同的代码，并且想知道是否存在限制重复代码的最佳实践。

主要问题之一是这些项目彼此非常独立，并且很快就会有更多的差异而不是相似之处。此外，一旦最初的工作完成，它们可能会被移交给其他程序员，因此共享代码库最终可能会成为一个大问题。

可能不得不处理类似情况的人有什么建议吗？

PS：我是这两个项目的唯一开发者，而且看起来这种情况会持续一段时间。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T22:18:22.910

将共享功能抽象回具有已定义接口和默认实现的框架或库是处理此问题的常用方法。例如，您的插件架构，如果您选择支持一个，可能是可以在您的所有项目之间共享的东西。大多数时候，您想要共享的内容是非常基本的功能或可以轻松定制的相对抽象的功能。前者更容易识别和分解到常见的库中。后者有时可能比简单地重新实现具有微小更改的代码（共享模式而不是代码）需要更多的工作。

您需要注意的一件事是让实际重用驱动公共库的设计，而不是提前提出共享架构。陷入框架设计并将其抽象出来以供共享使用是非常诱人的。不幸的是，您经常发现共享使用从未发展或朝着与您预期不同的方向发展，并且您最终会重写或丢弃大部分框架 - 或者更糟糕的是，保留和维护未使用的代码。让 YAGNI（你不会需要它）成为你的向导，并延迟重构到公共库，直到你真正需要它。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T23:36:04.640

这里有几种（至少）不同的方法，你当然可以同时使用这两种方法。首先，您可以将一些通用代码删除到一个单独的项目中，然后静态调用该代码。这很容易做到，我有时会使用简单的辅助函数来使用这种方法，这些辅助函数可能不属于我的主项目中的一个类 - 一个很好的例子是数学库或类似的东西。另一种方法是将通用功能提取到一个类或接口中，然后继承和扩展。根据您希望重用的代码，您可能会使用这些方法中的一种（或两种）。

我怀疑你会发现它比你想象的要容易。用一些简单的代码尝试一下，在同一个解决方案中设置一个新项目，从现有代码中引用你的库，看看它是如何进行的。也没有理由不在多个解决方案中引用您的共享项目。

如果开发被移交，拥有共享代码库就不会成为问题。现在，您可以让您的 2 个站点引用您维护的同一个库（或多个库），但是如果并且当您将项目拆分给其他团队时，您可以将共享代码的副本提供给每个团队。

# python - 带有 Django 的 Paypal NVP API

> ID：717911
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-04T22:06:58.630
> 
>         
> 
> 标签：python, django, paypal

我正在考虑使用 paypal NVP API 来允许用户在我的网站上为定期订阅付费。

我有几个关于要求的问题。我的网站是否必须满足“PCI 合规性”要求。我想我必须获得 SSL 证书，还有什么需要或我需要知道的吗？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T22:44:59.803

没有什么会迫使您满足 PCI 合规性并使用 SSL，但无论如何您都应该限制您的责任并激发一点客户信任。

[我想我在Satchmo](http://satchmoproject.com)开发人员的 Google 小组上读到了一些关于一个人实施 PayPal NVP 并拥有补丁的内容。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-08-17T20:12:32.417

我知道这个问题有点过时了，但我想补充一点，我最近发布了一个[开源 Python API 到 PayPal NVP 接口](http://www.chickenwingsw.com/scratches/python/paypal-on-python)。

# javascript - JavaScript 版本高于 1.5 - 为什么？

> ID：717923
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-04T22:14:25.867
> 
>         
> 
> 标签：javascript, internet-explorer, firefox

[Mozilla 基金会](https://developer.mozilla.org/en/JavaScript)继续为 JavaScript 添加新的语言特性。他们现在升级到 1.8 版本，其中 1.5 或多或少是[ECMA 基线](http://en.wikipedia.org/wiki/ECMAScript#Version_correspondence)。

但是，Firefox 是[唯一](http://en.wikipedia.org/wiki/JavaScript#Versions)支持最新版本的浏览器，而 IE 则牢牢地停留在 1.5 等效的 JScript 上。

仅限 Firefox 的扩展有什么用途？还是他们只是处于休眠状态，直到（如果）其他浏览器赶上来？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-04T23:12:36.117

Firefox、Thunderbird 和其他 XUL 应用程序本身也有很大一部分是用 JavaScript 编写的。功能更丰富的 JavaScript 意味着为 Firefox 和其他 Mozilla 应用程序提供更好的开发环境。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T23:05:29.020

扩展语言是一个好主意，即使只有一个浏览器在这样做——最终它将证明自己并成为标准，届时其他浏览器将不得不赶上。

否则，如何才能取得进展——微软一直在这样做：如果 Internet Explorer 没有首先实现 XMLHttpRequest，它会成为标准吗？

从 Mozilla 的角度来看，这些更改的目的，除了添加更多功能供 Web 开发人员使用外，是为了引入 JavaScript 2.0，该版本正在开发为 ECMA 262（修订版 4）[TC39 工作组](http://www.ecma-international.org/memento/TC39-TG1.htm)的下一个修订版。

未来的浏览器将支持 JavaScript 2.0。同时，邀请开发人员利用这些额外的功能——在 Firefox 中原生并使用向后兼容 Internet Explorer 的 JavaScript 库。我觉得这非常有用。

此外，值得注意的是，Webkit（由 KDE 开发并被 Safari、Chrome 和一些免费软件浏览器使用的引擎）支持 JavaScript 1.7。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T23:39:55.443

目前改进 JavaScript 的最大原因是扩展编写者，他们不必担心跨浏览器的兼容性。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T13:22:41.533

JavaScript 是 Sun 的商标，已授权给 Netscape，现在由 Mozilla 基金会持有。Microsoft 有自己的语言 JScript 实现，但也有其他语言（例如 DMDScript）。

ECMAScript 是事后才为各种实现添加通用基线。因此，语言开发在标准委员会之外继续进行是很自然的，它可以自由地在标准的未来修订版中添加由实施者开创的更改（例如，在 JS1.6 中引入的数组 extras 将在 ES3.1 中）。

# wpf - MyContainer 从 FrameworkElement 派生并支持绑定

> ID：717924
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T22:14:54.367
> 
>         
> 
> 标签：wpf, binding

为了了解绑定的工作原理，我实现了从 FrameworkElement 派生的 MyContainer。此容器允许设置子项并将它们添加到逻辑树中。但是 ElementName 的绑定不起作用。我可以用 MyContainer 做什么来使其工作，将父级保留为 FrameworkElement？

C＃：

```
public class MyContainer : FrameworkElement
{
    public MyContainer()
    {
        Children = new List<FrameworkElement>();
    }

    public List<FrameworkElement> Children { get; set; }
    protected override IEnumerator LogicalChildren
    {
        get { return Children.GetEnumerator(); }
    }
} 
```

XAML：

```
<Window x:Class="WpfLogicalTree.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfLogicalTree"
    Title="Window1" Height="300" Width="300">
    <StackPanel>

        <local:MyContainer>
            <local:MyContainer.Children>
                <TextBlock Text="Foo" x:Name="_source" />
                <TextBlock Text="{Binding Path=Text, ElementName=_source}" x:Name="_target"/>
            </local:MyContainer.Children>   
        </local:MyContainer>

        <Button Click="Button_Click">Test</Button>

    </StackPanel>
</Window> 
```

窗口1.cs

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    MessageBox.Show(_target.Text);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-05T12:18:58.037

我不得不调用 AddLogicalChild，而不是使用 LogicalChildren。所以这有效：

```
public class MyContainer : FrameworkElement
{
    public MyContainer()
    {
        Children = new List<FrameworkElement>();
        this.Loaded += new RoutedEventHandler(OnLoaded);
    }

    void  OnLoaded(object sender, RoutedEventArgs e)
    {
        foreach (FrameworkElement fe in Children)
            this.AddLogicalChild(fe);
    }        

    public List<FrameworkElement> Children { get; set; }
} 
```

AddLogicalChild 设置元素的逻辑父级，这是查找注册“_source”名称的 NameScope 所必需的。在我们的例子中，名称范围是 Window1。

笔记。AddLogicalChild 不会导致 LogicalChildren 自动返回我们的孩子，它只会设置 Parent。所以 LogicalTreeHelper.GetChildren 将是空集合。但我们这里不需要它。

# javascript - 如果数组存在，则继续

> ID：717928
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T22:16:50.370
> 
>         
> 
> 标签：javascript, arrays

我的 .aspx 页面中可能存在一个数组，如果是，我想触发一个 javascript 函数。

我试过：

```
if(someArray)
       blah(someArray); 
```

但是当我没有定义 someArray 时出现错误。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-04-04T22:18:05.267

```
if(typeof someArray !== 'undefined') {
    blah(someArray);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T22:21:38.737

您可能应该将数组预定义为 null 并检查它是否解析，而不是*有时*可用。

```
Array someArray = null;

// this is where you'll populate or replace someArray
// if you don't, someArray simply remains empty

if (someArray)
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T22:45:05.293

```
var a = [];
var b = new Array();
alert(typeof a === "object" && a instanceof Array);
alert(typeof b === "object" && b instanceof Array);
alert(typeof c === "object" && c instanceof Array); 
```

# overflow - SWAP 期间的堆栈溢出

> ID：717935
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T22:21:34.320
> 
>         
> 
> 标签：overflow, swap

我们如何在不使用第三个变量的情况下处理两个变量交换期间发生的溢出问题。我相信 XOR 解决方案只能用于整数。其他变量类型呢？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T22:26:47.600

这不是答案，但不适合评论。  

在什么情况下，您会在可用堆栈存储的边缘附近运行，以至于额外使用临时变量进行交换会给您带来困难？

我可以看到一些嵌入式场景，但我很难想象这样一个场景，你会在堆栈空间上如此紧张以至于这很重要（你不是用汇编语言编写代码）。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T22:25:54.263

XOR 适用于您可以让 XOR 运算符处理的任何内容；它是二进制数据的属性，而不是用于表示整数的二进制数据的属性。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T22:53:22.887

根本不做。XOR 交换算法很酷。它[不应该](http://en.wikipedia.org/wiki/XOR_swap_algorithm#Reasons_for_avoidance_in_practice)在生产代码中使用。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T22:27:58.330

XOR 解决方案适用于任何可以按位复制的类型，而不仅仅是整数。但是，不要将变量与自身进行异或：即

```
int x = 10;
int *p1 = &x;
int *p2 = p1;

*p1 = *p1 ^ *p2;
*p2 = *p1 ^ *p2;
*p1 = *p1 ^ *p2;

/* now x == 0 :( */ 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-07-02T07:31:49.520

[XCHG](http://www.intel.com/software/products/documentation/vlin/mergedprojects/analyzer_ec/mergedprojects/reference_olh/mergedProjects/instructions/instruct64_hh/6400380.htm)有什么问题？不需要堆栈，没有溢出（携带标志）？设置任一:)。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-07-02T07:38:51.863

```
a = a + b;
b = a - b;
a = a - b; 
```

这适用于整数和浮点数。

# php - 在 PHP 中包含不同类型的文件

> ID：717952
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-04T22:31:09.913
> 
>         
> 
> 标签：php, include, apache2

我接手了一个 PHP 项目，并试图让它在我的开发盒上运行。我是开发人员而不是系统管理员，所以我无法让它正常工作。

以前的开发人员使用 .h 文件来包含 PHP。我当前的配置是采用该 .h 文件并包含它而不执行它。我需要在我的 apache 配置（或者是我的 php.ini）中寻找什么？

编辑：

当我阅读下面的评论之一时，有些东西点击了。该代码使用 ASP 样式标签“ `<?`”。我已经在 php.ini 中打开了该选项，根据 phpinfo()，它已启用，但 apache 仍然只是将代码包含为文本。

我刚刚检查了它并使用完整的开始 PHP 标记“ `<?php`”运行代码解决了这个问题。话虽如此，我仍然希望它以另一种方式工作。

我正在使用最新版本的 Macbook 上运行代码。PHP 5.2.6、postgresql 8.3 和 apache 2。

该代码在登台服务器上工作，但我无法弄清楚它有什么区别。

编辑

Durrr...我没有在 php.ini 中启用 short_open_tags。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-04T23:08:02.383

问题可能是您包含的 .h 文件只是在没有打开“ `<?php`”标记的情况下开始进入 php 代码吗？

从[包含](http://www.php.net/manual/en/function.include.php)文档：

> 当包含一个文件时，解析会在目标文件的开头退出 PHP 模式并进入 HTML 模式，并在结尾处再次恢复。因此，目标文件中应作为 PHP 代码执行的任何代码都必须包含在[有效的 PHP 开始和结束标记](http://www.php.net/manual/en/language.basic-syntax.phpmode.php)中。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T22:40:41.543

PHP 是一种解释性语言，因此您不能在不执行文件的情况下“包含”文件。请记住，'.h' 只是一个文件扩展名，因此尽管之前的编码人员可能将 PHP 放在了一个 '.h' 文件中，但它仍然只是 PHP。

有关您遇到的问题的更多详细信息会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T22:41:59.670

您可以使用 .htaccess 文件并添加：

php_value auto_prepend_file /path/to/include-file.h

* * *

编辑

我刚刚读到 .htaccess 仅适用于 php 的模块版本。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T22:46:18.800

您应该将它们全部更改为 .php 扩展名。但是，如果要将它们保留为 .h，则需要更改 Apache 中的映射。通过适当的解释器运行文件的是 Apache，而不是 PHP。PHP 引擎将处理传递给它的任何内容。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T23:01:27.313

[include](http://www.php.net/manual/en/function.include.php)和[require](http://www.php.net/manual/en/function.require.php)将执行包含的文件。如果您使用的是[readfile](http://us2.php.net/manual/en/function.readfile.php)，它只是回显文件而不将其视为 PHP 代码。

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2009-04-05T18:01:29.990

如果 .h 文件“缺少”`<?php`指令，那么您可能必须从包含切换到类似的内容：

```
eval( file_get_contents("file.h") ); 
```

就我个人而言，我尽量避免 eval ，但有时别无选择。

# binding - Clojure 关键字参数

> ID：717963
> 
>         
> 
> 赞同：53
> 
>         
> 
> 时间：2009-04-04T22:39:30.610
> 
>         
> 
> 标签：binding, clojure, lisp, common-lisp, params-keyword

在 Common Lisp 中，您可以这样做：

```
(defun foo (bar &key baz quux)
  (list bar baz quux))

(foo 1 :quux 3 :baz 2) ; => (1 2 3) 
```

Clojure 没有关键字参数。一种替代方法是：

```
(defn foo [bar {:keys [baz quux]}] 
  (list bar baz quux))

(foo 1 {:quux 3 :baz 2}) ; => (1 2 3) 
```

嵌套的括号太多，不得不一直打字和阅读。它还需要一个显式的哈希映射作为参数而不是平面列表传入。  

什么是最惯用的 Clojure 等效关键字参数，看起来不像有人引爆了标点符号？

* * *

## 回答 #1

> 赞同：101
> 
>             
> 
> 时间：2010-10-19T14:55:34.573

为了更新 Clojure 1.2 的这个答案，现在有完整的关键字 arg 支持，其默认值由[解构绑定](http://clojure.org/special_forms#binding-forms)的映射形式提供：

```
user> (defn foo [bar &{ :keys [baz quux] 
                        :or {baz "baz_default" quux "quux_default"}}]
         (list bar baz quux))
#'user/foo

user> (foo 1 :quux 3)
(1 "baz_default" 3) 
```

* * *

## 回答 #2

> 赞同：39
> 
>             
> 
> 时间：2009-04-04T23:19:19.207

在 clojure 中模拟关键字 args 的一种简单方法是在 rest 参数上使用 hash-map，如下所示：

```
> (defn kwtest [x & e] (:foo (apply hash-map e)))
#'user/kwtest
> (kwtest 12 :bar "ignored" :foo "returned")
"returned" 
```

Rich Hickey 在[来自 clojure google 组的这条消息](http://groups.google.com/group/clojure/msg/51bb53ca077154f8)中提供了一个宏，它为您提供关键字参数。相应的[线程](http://groups.google.com/group/clojure/browse_thread/thread/0aa57ab265f7474a/51bb53ca077154f8?#51bb53ca077154f8)包含有关为什么 clojure 不支持关键字参数的信息。基本上是为了避免运行时开销。Rich 解释了我在[此消息中显示的方法](http://groups.google.com/group/clojure/msg/16487ce0cdab4c26)

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2009-06-16T12:37:24.140

最近添加的`clojure.contrib.def`是`defnk`宏，它可以使用关键字参数定义函数（参见[此处](http://code.google.com/p/clojure-contrib/source/browse/trunk/src/clojure/contrib/def.clj?spec=svn946&r=890#119)）。

# algorithm - 有人可以解释广度优先搜索吗？

> ID：717973
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-04T22:44:42.097
> 
>         
> 
> 标签：algorithm, graph-theory, breadth-first-search

有人可以解释广度优先搜索来解决以下问题吗
![替代文字](https://farm4.static.flickr.com/3120/3409325514_68840abcb8.jpg)

我需要找到 4 到 7 之间的所有路径

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-04T22:47:20.780

您查看与起始节点相邻的所有节点。然后您查看与这些节点相邻的所有节点（不返回您已经查看过的节点）。重复直到找到满意的节点或没有更多的节点。

对于您指出的那种问题，您使用上述过程构建一组路径，终止到达所需目标节点的任何路径，并且当您的图表用尽时，这样终止的路径集就是您的解决方案集。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T22:49:41.663

广度优先搜索 (BFS) 意味着您在进入更深层次之前处理所有起始节点的直接子节点。BFS 是通过一个队列实现的，该队列存储需要处理的节点列表。

通过将起始节点添加到队列中来启动算法。然后你继续运行你的算法，直到队列中没有任何东西需要处理。

当您从队列中取出一个元素时，它将成为您的活动节点。在处理活动节点时，将其所有子节点添加到队列的后面。当您有一个空队列时，您终止算法。

由于您处理的是图形而不是树，因此您需要存储已处理节点的列表，这样您就不会进入循环。

到达节点 7 后，您就有了匹配的路径，您可以停止对该递归路径执行 BFS。这意味着您根本不将其子项添加到队列中。为了避免循环并知道您访问过的确切路径，在您进行递归 BFS 调用时，请传递已经访问过的节点。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-05T07:34:17.720

将其视为带有指向其他网站的链接的网站。让 A 成为我们的根节点或我们的起始网站。

```
A 是起始页（第 1 层）
A 链接到 AA、AB、AC（第 2 层）
AA 链接到 AAA、AAB、AAC（第 3 层）
AB 链接到 ABA、ABB、ABC（第 3 层）
AC 链接到 ACA、ACB、ACC（第 3 层）

```

这只有三层深。您一次搜索一层。因此，在这种情况下，您将从 A 层开始。如果不匹配，则转到下一层，AA、AB 和 AC。如果这些网站都不是您要搜索的网站，那么您可以点击链接并转到下一层。换句话说，你一次只看一层。

您将从 A 到 AA 到 AAA 进行深度优先搜索（其补充）。换句话说，你会在去宽之前先去深。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T22:47:38.220

您测试连接到根节点的每个节点。然后您测试连接到先前节点的每个节点。以此类推，直到找到答案。

基本上，每次迭代都会测试与根节点距离相同的节点。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T22:55:14.473

开始

4；

4,2;

4,2,1; 4,2,3; 4,2,5;

4,2,1;（失败）4,2,3,6; 4,2,5,6; 4,2,5,11;

4、2、3、6、7；（通过）4、2、3、6、8；4,2,5,6,7；（通过）4,2,5,6,8；4,2,5,11,12;

4,2,3,6,8,9; 4,2,3,6,8,10; 4,2,5,6,8,9; 4,2,5,6,8,10; 4、2、5、11、12；（失败）

4,2,3,6,8,9;(失败) 4,2,3,6,8,10;(失败) 4,2,5,6,8,9;(失败) 4,2,5 ,6,8,10;（失败）

结尾

# php - AJAX 表更新脚本

> ID：717986
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T22:55:03.147
> 
>         
> 
> 标签：php, ajax, refresh

我正在制作一个基于瓷砖的在线游戏，我刚刚完成了一段代码的脚本，该代码获取你站立位置的坐标并在你周围构建环境（瓷砖）（游戏是使用一个有许多单元格的桌子制作的瓷砖）。

我需要一些帮助来创建一些可以不时刷新我的表格的 AJAX（为了这个问题，让我们每 2 秒坐一次）。我没有使用 AJAX 的经验，学习它没有任何意义（即使我也喜欢），因为我只会将它用于我游戏的一小部分，而且我没有时间。

我的游戏是这样设置的：

*php*
一些获取字符信息的 php。*
 *php*

*html*
一些以图形形式显示数据的 html。
*html*

所以我需要的是一些 AJAX，它每 2 秒刷新一次 php 然后刷新 html。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-05T00:45:20.933

您可能应该使用[jQuery](http://jquery.com/)或[Prototype JS](http://www.prototypejs.org)。这些库都可以做“一些 ajax”。如果您是开发新手，并且这是一个一次性项目，我建议您使用 Prototype。

在 Prototype 中，您可以有一个执行 ajax 工作的函数，以及一个调用 Prototype 的 periodicalExecuter 的函数，并将工作函数名称作为它的回调参数，如下例所示。您需要向 php 脚本发送一些参数，并将响应放入页面上的某些元素中，每 x 秒一次。这应该让你开始：

```
 <script src="/js/Prototype.js">
    //calls renderResponse on completion of the AJAX post to the specified URL
    function sendRequest(parameters,URLEndpoint){
        var myAjax = new Ajax.Request
                     (
                         URLEndpoint,
                         {
                             method: 'post', 
                             postBody: parameters, 
                             onSuccess: renderResponse
                         }
                     );
    }

    //replace contents of 'character' div or whatever with output from PHP script
    function renderResponse(response){
       var el = $(characterTable); 
       elementId.innerHTML = resp.responseText;
    }

    //execute sendRequest every 2 seconds
    function periodicalUpdate() {
        new PeriodicalExecuter(sendRequest('monkeys=2&carrots=7','http://mywebsite.com/game.php'), 2);
    } 
```

有一个与 PeriodicUpdate 做同样工作的 jQuery 插件函数。我没有尝试过，但它看起来很有说服力：

[http://groups.google.com/group/jquery-en/browse_thread/thread/e99f3bc0cfa12696?pli=1](http://groups.google.com/group/jquery-en/browse_thread/thread/e99f3bc0cfa12696?pli=1)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-05T01:17:49.250

如果您想节省学习 AJAX 的所有复杂性的时间，使用 JavaScript 框架是一个很好的捷径（它们通常可以节省大量时间）。[使用YUI](http://developer.yahoo.com/yui/)之类的东西，您只需几行代码就可以将 AJAX 功能构建到您的应用程序中。

具体来说，您需要使用[YUI Connection Manager Component](http://developer.yahoo.com/yui/connection/)。YUI 有很好的文档，所以自己弄清楚应该不难。如果没有，这里有一个针对初学者[的简短教程。](http://www.evotech.net/blog/2007/05/beginning-ajax-using-the-yui-library/)

在你的 HTML 前端，你应该有这样的东西：

```
<!-- YUI source files --> 
<script src="http://yui.yahooapis.com/2.7.0/build/yahoo/yahoo-min.js"></script> 
<script src="http://yui.yahooapis.com/2.7.0/build/event/event-min.js"></script> 
<script src="http://yui.yahooapis.com/2.7.0/build/connection/connection-min.js"></script>
<script>
var tiles = new Array();
function refreshTable() {
    var sUrl = "ajax/table.php";
    var responseSuccess = function(o) {
        var root = o.responseXML.documentElement;
        var rows = root.getElementsByTagName('row');
        for (i=0; i<rows.length; i++) {
            tiles[i] = new Array();
            for (j=0; j<rows[i].childNodes.length; j++) {
                tiles[i][j] = rows[i].childNodes[j].firstChild.nodeValue;
            }
        }

        /*
         Update your table using the tiles[][] 2D array.
        /*
    }
    var responseFailure = function(o) {
        // Failure handler
        alert(o.statusText);
    }
    var callback = {
        success:responseSuccess,
        failure:responseFailure,
        timeout:3000
    }
    var transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, callback, null);
}
setInterval(refreshTable(),2000);
</script> 
```

在您的 PHP 后端中，您只需要生成以下格式的 XML 数据：

```
<table>
    <row>
        <tile>dirt</tile>
        <tile>water</tile>
        <tile>water</tile>
        <tile>dirt</tile>
        <tile>dirt</tile>
    </row>
    <row>
        <tile>dirt</tile>
        <tile>dirt</tile>
        <tile>water</tile>
        <tile>water</tile>
        <tile>dirt</tile>
    </row>
    <row>
        <tile>dirt</tile>
        <tile>dirt</tile>
        <tile>water</tile>
        <tile>water</tile>
        <tile>dirt</tile>
    </row>
    <row>
        <tile>dirt</tile>
        <tile>dirt</tile>
        <tile>dirt</tile>
        <tile>water</tile>
        <tile>water</tile>
    </row>
    <row>
        <tile>dirt</tile>
        <tile>dirt</tile>
        <tile>dirt</tile>
        <tile>dirt</tile>
        <tile>water</tile>
    </row>
</table> 
```

这就是它的要点。如果您需要将参数传递给服务器端 PHP 脚本，您只需使用**encodeURI()将它们附加到 URL 并使用***$_GET[]*超全局访问它们。

# jquery - 用于选择产品尺寸和颜色的类似亚马逊的界面（即单击小红框选择红色产品等）

> ID：717988
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-04T22:56:11.867
> 
>         
> 
> 标签：jquery, jquery-ui, select, user-interface, e-commerce

在我的在线商店中，我想实现一个类似于[亚马逊的](https://rads.stackoverflow.com/amzn/click/com/B000YVES0I)界面来选择产品尺寸和颜色。即，用户应该看到一堆小框，而不是用于不同尺寸/颜色的单选按钮，每个小框包含颜色样本或尺寸名称。当用户单击一个框时，边框应更改以指示它已被选中。

我已经在使用 jQuery，所以我认为[jQuery 可选小部件](http://jqueryui.com/demos/selectable/)将是实现这一点的自然方式。不幸的是，它似乎无法让您控制用户可以选择的最大项目数，因此我无法限制用户在 UI 中在线选择一种颜色/尺寸。

**以 jQuery 友好的方式（如果可能）实现此功能的最佳方式是什么？** 

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-04-13T15:07:05.823

以下是如何使用[渐进式增强](http://en.wikipedia.org/wiki/Progressive_enhancement)正确执行此操作。这个想法很简单，将一个标记得体的 HTML 表单变成更好的颜色和大小的样本按钮，供拥有 JavaScript 的用户使用。

这种方法的好处很多，您可以轻松切换或删除组件（JS/CSS）并且让表单仍然有效。它适用于不使用 javascript 的用户，如果我们小心的话，它可以通过键盘和屏幕阅读器访问。它在提交时也不需要额外的代码，并且与表单验证器一起使用会更容易。

大部分工作都是用 CSS 完成的，只用最少的 JavaScript 来添加最后的润色。

完整的工作示例可以[在 jsbin 上找到](http://jsbin.com/uwuje)。它包括颜色和尺寸选择。我在这里只包含了颜色，因为它们之间的 CSS 只有细微的差别。

**的HTML**

首先，标记表单组件。这是基础知识，您可能显然想要添加一些东西，例如围绕整个小部件的包装器，或使用其他类名。

```
<label>Color</label>
<ul class="radio color">
  <li class="red">
    <input type="radio" name="color" id="color_red" value="red" />
    <label for="color_red">Red</label>
  </li>
  <li class="green">
    <input type="radio" name="color" id="color_green" value="green" />
    <label for="color_green">Green</label>
  </li>
  <!-- ...and so on... -->
</ul> 
```

对于“基础知识”来说，这似乎很多，但这里发生了几件事。整个容器被标记为“无线电”，因此可以使用 CSS ( )`UL`适当地定位其中的所有内容。`"ul.radio label"`

此外，我添加了一个与输入名称对应的类，并在每个类上添加一个`LI`回显该值的类，以允许 CSS 添加适当的样式 ( `"ul.color li.red"`)。其余的几乎是您的标准表单标记。

**JavaScript**

JavaScript 非常简单。我们所做的只是检测当前选择了哪个无线电输入，并`LI`使用“已选择”类标记容器，从而允许 CSS 适当地突出显示它。

```
jQuery(function($){
  // notify CSS that JS is present
  $( 'body' ).addClass( 'js-active' );
  // for every radio control...
  $( 'ul.radio' )
    // redo every change
    .bind('click', function () {
      // refresh "current classes"
      $( 'li', this ).removeClass( 'selected' )
        .filter( ':has(:checked)' ).addClass( 'selected' );
    })
    // trigger initial run
    .trigger( 'click' );  
}); 
```

请注意：如果您有更高的点击处理程序（通常），这种触发点击以强制执行初始运行的“技巧”可能不安全`document.body`，为了简洁起见，我使用这种方法。

**CSS**

这是真正的魔法发生的地方。这个想法是我们可以将输入控件隐藏起来，并将标签设置为颜色按钮。只要`for`标签上的属性正确指向`id`输入上的 '，然后单击标签就足以正确选择控件。

我们只需要在内部定位事物，`".js-active"`以便没有 JavaScript 但仍然有 CSS 的用户可以看到单选输入元素。或者可以在包装器上添加某种“.radio-js”类`UL`来完成同样的事情。

首先，浮动按钮并赋予它们更像按钮的外观：

```
/* attributes are lined up horizontally */
ul.color li,
ul.size li {
  border : 1px solid #aaa;
  margin : 0 4px 0 0;
  padding : 2px;
  float : left;
  overflow : hidden;
  position : relative;
} 
```

我们在每个 LI 上放置`position:relative`和`overflow:hidden`，以便我们可以将输入元素移出视图。这将使其可访问，但我们不再需要查看它：

```
/* if JS: remove inputs from sight */
.js-active ul.color input,
.js-active ul.size input {
  position : absolute;
  left : -999em;
} 
```

接下来是将标签变成按钮：

```
/* if JS: turn color labels into buttons */
.js-active ul.color label {
  cursor : pointer;
  display : block;
  height : 18px;
  width : 18px;
  text-indent : -999em; /* hide text */
}
/* color buttons in color -- allowed even if no JS */
ul.color li.red label   { background : red;   }
ul.color li.green label { background : green; }
ul.color li.blue label  { background : blue;  } 
```

最后，为我们突出显示/选定的项目设置一些样式。

```
/* if JS: current selected highlight */
.js-active ul.color .selected,
.js-active ul.size .selected {
  border : 2px solid #000;
  padding : 1px;
} 
```

为了完整性：如果您想添加更多效果，[获取选择值在 SO 的其他地方进行了演示。](https://stackoverflow.com/questions/743052/how-to-get-the-selected-value-of-the-radio-button-list-in-jquery)

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-04-11T19:34:47.820

可以让 jQuery 可选择阻止选择，但不幸的是它不是很直观：

```
$('#selectable').selectable({
   selected: function(event, ui) {
       var total = $(ui.selected).siblings('li.ui-selected').length + 1;
       if(total > 1) {
           $(ui.selected).removeClass('ui-selected');
       }
   }
}); 
```

这将停止在可选小部件上进行超过 1 次选择。

其余的只是根据您的特定需求对其进行定制。

**编辑**：我有点无聊，所以我实施了更多，所以你可以得到一个想法。

[**查看一个工作演示**](http://www.rootspot.com/stackoverflow/amazon/)。对尺寸和颜色所做的事情有很多重复，您可能可以摆脱它们，但我想将它们分开，因为我想事情可能会在两者之间发生变化。无论如何，这应该给你一个很好的开始。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-11T20:53:55.757

如果您的目标是只允许选择一项，则可以这样做：

```
$(function() {
    $("#selectable").selectable({
        // this will prevent selecting a second item (for dragging\clicking)
        selecting: function(event,ui) {
            if ($(ui.selecting).siblings("li.ui-selecting").length > 0)
                $(ui.selecting).removeClass("ui-selecting");
        },
        // this will prevent selecting a second item (for CTRL+Click)
        selected: function(event,ui) {
            if ($(ui.selected).siblings("li.ui-selected").length > 0)
                $(ui.selected).removeClass("ui-selected");
        },
        // this will prevent un-selecting items (one item must be selected)
        unselected: function(event,ui) {
            if ($(ui.unselected).siblings("li.ui-selecting").length == 0)
                $(ui.unselected).addClass("ui-selected");
        }
    })
}); 
```

此代码将允许选择单个项目，并且将阻止通过鼠标拖动或使用 CTRL+单击来选择另一个项目。它还将防止取消选择项目。它的行为与亚马逊的行为非常相似。

您可以在`stop`选择项目后使用该事件在页面上执行更改（类似于 JQuery UI 附带的示例）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-12T02:23:25.277

伙计，亚马逊的界面很丑。我很想尝试更多类似的东西：

*   [简单的颜色选择器](http://www.web2media.net/laktek/2008/10/27/really-simple-color-picker-in-jquery/)（当然，您不会在选择器中使用颜色的十六进制表示）

*   [颜色选择器](http://www.eyecon.ro/colorpicker)（尽管这可能比他们需要的颜色控制要多一点）

*   [平面颜色选择器](http://wanderinghorse.net/computing/javascript/jquery/colorpicker/demo-colorpicker.html)（几乎和亚马逊的一样丑）

尺寸应该足够简单。不过，我可能会拍一些不同尺寸的衬衫的小照片，有点像这里：

*   [扎兹勒](http://www.zazzle.com/guitar_pick_shirt-235748420311513858)

（这是我能找到的挑选衬衫尺码的最好例子，大多数地方都很糟糕）

# django - Django中基于时间戳的最佳查询

> ID：717991
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-04T22:57:42.080
> 
>         
> 
> 标签：django, datetime, date, timestamp

获取某一天的所有记录的最佳查询是什么？在我的 Weather 模型中，'timestamp' 是一个标准的 DateTimeField。

我目前正在使用

```
start = datetime.datetime(2009, 1, 31)
end = start + datetime.timedelta(hours=23, minutes=59, seconds=59)
Weather.objects.filter(timestamp__range=(start, end)) 
```

但想知道是否有更有效的方法。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-05T05:44:44.770

它在 django.views.generic.date_based 中完成的方式是：

```
{'date_field__range': (datetime.datetime.combine(date, datetime.time.min),
                       datetime.datetime.combine(date, datetime.time.max))} 
```

应该很快就会有一个[补丁合并到 Django](http://code.djangoproject.com/ticket/9596)中，它将为这种类型的查询提供 __date 查找（[http://code.djangoproject.com/ticket/9596](http://code.djangoproject.com/ticket/9596)）。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-05T01:33:51.597

1.  不要过早优化

2.  您的查询经常基于的索引列

3.  优化昂贵的列，例如添加自动更新的年、月和日值（可能只是作为一个字符串），当且仅当测试表明它提供了显着的加速并且只有在使用现在已经工作的东西并确定它不可行之后。

# java - 如何处理接近1的数字的乘法

> ID：717994
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-04T23:00:08.270
> 
>         
> 
> 标签：java, math, floating-point, bigdecimal, rounding-error

我有一堆浮点数（Java 双精度数），其中大部分非常接近 1，我需要将它们相乘作为更大计算的一部分。我需要做*很多*。

问题是，虽然 Java 的双打对像这样的数字没有问题：

```
0.0000000000000000000000000000000001 (1.0E-34) 
```

他们不能代表类似的东西：

```
1.0000000000000000000000000000000001 
```

因此，我迅速失去了精度（Java 的双打的限制似乎在 1.000000000000001 左右）。

我考虑过只存储减去 1 的数字，因此例如 1.0001 将存储为 0.0001 - 但问题是再次将它们相乘我必须加 1，此时我失去了精度。

为了解决这个问题，我可以使用 BigDecimals 来执行计算（转换为 BigDecimal，加 1.0，然后相乘），然后再转换回双精度数，但我非常担心这会对性能产生影响。

任何人都可以看到避免使用 BigDecimal 的方法吗？

**为清楚起见进行编辑**：这是针对采用梯度下降优化算法的大规模协同过滤器。准确性是一个问题，因为协同过滤器通常处理非常小的数字（例如，一个人点击产品广告的概率，可能是千分之一，或万分之一）。

速度是一个问题，因为协同过滤器必须在数千万个数据点上进行训练，如果不是更多的话。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-04-04T23:03:55.450

是的：因为

```
(1 + x) * (1 + y) = 1 + x + y + x*y 
```

在您的情况下，`x`并且`y`非常小，因此`x*y`会小得多 -*太小*而无法影响您的计算结果。所以就你而言，

```
(1 + x) * (1 + y) = 1 + x + y 
```

这意味着您可以存储减去 1 的数字，而不是相乘，只需将它们相加即可。只要结果总是远小于 1，它们就会足够接近数学上精确的结果，您不会关心差异。

*编辑*：刚刚注意到：你说它们中的*大多数*都非常接近 1。显然，这种技术不适用于不接近 1 的数字——也就是说，如果`x`和`y`很大。但是，如果一个大一个小，它可能仍然有效；你只关心产品的大小`x*y`。（如果两个数字都不接近 1，您可以使用常规 Java`double`乘法...）

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-04-04T23:11:03.437

也许你可以使用对数？

对数方便地减少乘法到加法。

此外，为了处理初始精度损失，还有函数 log1p（至少，它存在于 C/C++ 中），它返回 log(1+x) 而没有任何精度损失。（例如 log1p(1e-30) 为我返回 1e-30）

然后你可以使用 expm1 得到实际结果的小数部分。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T23:04:17.900

这种情况不正是 BigDecimal 的用途吗？

*编辑添加：*

“根据倒数第二段，出于性能原因，如果可能，我宁愿避免使用 BigDecimals。” – 理智

“过早的优化是万恶之源”——Knuth

有一个简单的解决方案实际上是为您的问题定制的。您担心它可能不够快，因此您想做一些您*认为*会更快的复杂操作。Knuth 的名言有时会被过度使用，但这正是他所警告的情况。用简单的方法写出来。测试一下。剖析它。看看是不是太慢了。如果是，*那么*开始考虑如何让它更快。在您知道有必要之前，不要添加所有这些额外的复杂、容易出错的代码。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-04T23:54:06.767

根据数字的来源和使用方式，您可能希望使用有理数而不是浮点数。不是所有情况的正确答案，但当它*是*正确答案时，真的没有其他答案了。

如果有理数不合适，我会支持对数答案。

编辑以响应您的编辑：

如果您正在处理代表低响应率的数字，请按照科学家的做法：

*   将它们表示为过剩/赤字（标准化 1.0 部分）

*   缩放它们。以“百万分之几”或任何适当的方式思考。

这将使您处理合理的计算数字。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-05T08:24:28.723

值得注意的是，您正在测试硬件而不是 Java 的限制。Java 在您的 CPU 中使用 64 位浮点。

我建议您先测试 BigDecimal 的性能，然后再假设它对您来说不够快。您仍然可以使用 BigDecimal 每秒进行数万次计算。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-07T15:32:49.940

正如大卫指出的那样，您可以将偏移量相加。

(1+x) * (1+y) = 1 + x + y + x*y

然而，选择退出最后一个学期似乎是有风险的。不。例如，试试这个：

x = 1e-8 y = 2e-6 z = 3e-7 w = 4e-5

什么是 (1+x) *(1+y)* (1+z)*(1+w)？在双精度下，我得到：

(1+x) *(1+y)* (1+z)*(1+w)

答案=

```
 1.00004231009302 
```

但是，看看如果我们只做简单的加法近似会发生什么。

1 + (x+y+z+w)

答案=

```
 1.00004231 
```

我们丢失了可能很重要的低阶位。仅当产品中与 1 的某些差异至少为 sqrt(eps) 时，这才是一个问题，其中 eps 是您正在使用的精度。

试试这个：

f = @(u,v) u + v + u*v；

结果 = f(x,y);

结果 = f（结果，z）；

结果 = f（结果，w）；

1+结果

答案=

```
 1.00004231009302 
```

如您所见，这使我们回到了双精度结果。事实上，它更准确一些，因为 result 的内部值为 4.23100930230249e-05。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-04T23:11:53.123

如果你真的需要精度，你将不得不使用 BigDecimal 之类的东西，即使它比 Double 慢。

如果您真的不需要精确度，您也许可以选择大卫的答案。但即使你经常使用乘法，也可能是一些过早的优化，所以无论如何 BIgDecimal 可能是要走的路

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T00:02:36.543

当您说“其中大多数非常接近 1”时，到底有多少？

也许您可以在所有数字中隐含 1 的偏移量，并且只使用分数。

# java - 您（几乎）总是在类中实现哪些方法和接口？

> ID：717997
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-04T23:04:04.750
> 
>         
> 
> 标签：java

你总是在你的类中实现哪些方法和接口？

你总是覆盖equals()吗？如果你这样做，你也做 hashcode() 吗？字符串（）？您是否养成了实现 Comparable 接口的习惯？

我刚刚编写了一些代码，我需要实现 compareTo() 并覆盖 equals() 以使我的程序以理智的方式工作；我现在开始看到在任何地方使用这些的方法......

大家觉得呢？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-04-04T23:07:33.290

除非我需要，否则我通常不会提前实施。

如果我的类包含数据成员并且我打算将它存储在某个地方，我通常会实现 equals、hashCode 和可比较。

但是，我发现我的大多数课程都没有这个问题，所以没有必要这样做。例如，如果您的课程围绕其他对象的功能而不是数据进行，那何必呢？如果您有一个实例或按层次组织（例如，GUI 小部件或窗口），为什么还要麻烦呢？

不要实现你不需要的东西，但始终确保检查它们是否需要，因为 Java 通常不会警告你。

此外，请确保使用您的 IDE 或 Apache commons 之类的工具来生成这些函数。很少需要手动编码它们。

至于 toString，我很少实现它，直到我发现自己在调试并需要在 Eclipse 调试器中更好地呈现（例如，而不是对象 ID）。我害怕隐式转换，并且在生成输出时从不使用 toString。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-04-04T23:25:54.853

（几乎）总是`toString()`。

它通常有助于调试目的。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T23:41:15.847

如果你覆盖`equals`，你（几乎总是）必须覆盖`hashCode`。`hashCode`的约定是两个相等的对象必须具有相同的哈希码。如果您覆盖 equals 以使相等性基于系统标识哈希码之外的其他内容，则两个对象可能彼此相等但具有不同的哈希码。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-04-04T23:47:42.117

我认为你永远不应该实现你不需要的东西，或者不确定你是否需要它们。如果它没有为您的代码增加价值，请不要将其放入。如果您希望使您的（单元）测试与您的代码保持同步，并使用它们来展示您的代码的用例，那么您不应该有这些测试未涵盖的任何内容。这包括 equals()、hashCode()、compareTo() 等。

除了可能浪费时间之外，我看到的问题是它会使阅读代码的人感到困惑。“为什么这个类实现了equals？它是一些数据值吗？它可以是集合的一部分吗？比较这个类的实例是否有意义？”

所以我会说只有在你真正需要它们时才实施它们。因此我不能说我*总是*执行这个那个方法。也许 toString() 是我写得最多的方法，因为它的用处在调试中出现了很多。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-04T23:56:55.607

几乎总是 toString()，调试和阅读有关对象 Class@123456 的内容很痛苦

equals() 和 hashCode() 需要时，但总是两者都或都不是。

Iterable 接口在类集合类上很有用，通常只返回类似 innerCollection.iterator() 的东西。Comparable 也很有用。

此外，我们公司创建了一些我经常使用的接口，例如 Displayable（例如 toString，但提供更多或其他类型的信息，例如用于日志记录）和 ParseLocatable（用于来自我们解析的文件的内容，我们希望在例如，在哪个文件和哪一行定义了特定规则（有点像堆栈跟踪）

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-04-05T06:08:02.250

[Effective Java](http://java.sun.com/docs/books/effective/)有一章介绍如何以及何时实现 toString、equals、hashCode、Comparable 等。强烈推荐阅读。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T01:29:34.713

`toString()`当您懒得编写单元测试时，有时对测试目的非常有帮助，在调试时也可以派上**用场**。

但我不建议`Comparable`在每个对象中实现，有时这很好，但要明智地使用它，否则你最终会得到大量实际上并不需要的代码。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T01:44:35.830

同上 for`toString()`及其在不同语言和运行时中的变体，但我还想向您指出 Ned Batchelder 关于[stringification](http://nedbatchelder.com/text/stringification.html)的文章，这是一本很好的读物，并且与我这样做的理由很接近。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T02:39:25.357

对于业务 CRUD 应用程序，我总是覆盖 ToString。这有助于将 List(Of T) 绑定到 WinForm 控件。例如，在将 List(Of Customer) 绑定到 ListBox 控件时，重写 Customer 对象中的 ToString 以返回 _name 将自动显示客户名称值。派上用场。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T02:49:23.647

我通常实现`compareTo`方法以及`toString`方法。知道类的一个实例如何与另一个实例进行比较以进行排序和搜索通常很好。此外，重写的 toString 方法非常适合调试。您可以查看以对您编写的类有意义的方式呈现的类的内容（不仅仅是内存位置）。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T05:40:36.403

在主要用于保存数据的对象（“rocks”）上，我发现 toString 和 equals/hashcode 合约是无价的。这是因为岩石通常会一直传入和提取出集合，最明显的是 Hash(Set/Map) 集合，它需要 equals 和 hashcode 合约，如果使用 toString，很容易在调试器中看到这些对象被实施。在实现 toString 时，我总是使用 Apache Common 的 ToStringBuilder 类来显示我的所有属性——这样很容易读取输出。我从不关心“隐式转换” - toString 不打算用作人类可读的字符串，toString 可以在 Number 子类上用于相互转换实际上只是一个怪癖等等。*人类可读*的字符串表示，因此如果需要非人类但计算机代码可用的字符串表示，则应定义不同的方法。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-04-05T08:47:39.590

对于数据值类，我有一个 AbstractPojo 类，它使用反射来实现 equals、hashCode、toString 和 asMap()

我为我的所有数据值对象扩展了这个类，所以我不会每次都实现它。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-04-06T09:55:27.577

我不会覆盖 ToString，但有时我会应用 DebuggerDisplay 属性，该属性对调试目的相同，并且不会在发布版本上增加开销。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2009-07-03T15:40:40.690

我还发现自己经常重写 ToString() 方法。尤其是在开发过程中。尽管代码生成器有帮助，但每次重命名类成员时都必须更改它会变得很烦人。其实我很生气，我试图找到补救措施，这就是我想出的：

创建此格式的字符串：MemberType MemberName=MemberValue

用法：

```
string testMember = "testing";

Console.WriteLine(Member.State(() => testMember)); 
```

将 'string testMember="testing" ' 写入控制台。这里是：

```
public static class Member
{
    public static string State<T>(Func<T> expr)
    {
        var member = ExtractMemberFromLambdaExpression(expr);

        Type memberType = GetTypeOfMember(member);

        string contents = ExtractContentsFromLambdaExpression(expr);

        return string.Format("{0} {1}={2}",memberType.Name,  member.Name, contents);
    }

    static string ExtractContentsFromLambdaExpression<T>(Func<T> expr)
    {
        if (expr() == null) {
            return "NULL";
        }

        string contents = string.Empty;
        if (expr().GetType().IsArray) {
            foreach (var item in (expr() as Array)) {
                contents += item.ToStringNullSafe() + ", ";
            }
            contents = contents.Trim().TrimEnd(',');
        } else {
            contents = expr().ToString();
        }

        return contents;
    }

    static MemberInfo ExtractMemberFromLambdaExpression<T>(Func<T> expr)
    {
        // get IL code behind the delegate
        var il = expr.Method.GetMethodBody().GetILAsByteArray();
        // bytes 2-6 represent the member handle
        var memberHandle = BitConverter.ToInt32(il, 2);
        // resolve the handle
        return expr.Target.GetType().Module.ResolveMember(memberHandle);
    }

    static Type GetTypeOfMember(MemberInfo member)
    {
        Type memberType;
        if (member.MemberType == MemberTypes.Field) {
            memberType = GetFieldType(member as FieldInfo);
        }
        else if (member.MemberType == MemberTypes.Property) {
            memberType = GetPropertyType(member as PropertyInfo);
        }
        else {
            memberType = typeof(object);
        }
        return memberType;
    }

    static Type GetFieldType(FieldInfo fieldInfo)
    {
        return fieldInfo.FieldType;
    }

    static Type GetPropertyType(PropertyInfo propertyInfo)
    {
        return propertyInfo.PropertyType;
    }
} 
```

可以在我的博客上找到更详尽的解释以及如何使用它：
[通用 ToString() 方法](http://thorstenlorenz.blogspot.com/2009/06/after-reading-this-great-blog-by-rinat.html) 
```******