# StackOverflow 问答 10286000-10286999

# sql - 想要使用更新触发器更新多条记录

> ID：10286001
> 
> 赞同：2
> 
> 时间：2012-04-23T18:17:34.523
> 
> 标签：sql, sql-server-2008, sql-update

让我解释一下我的情况。假设我的“活动”表中有 10 条记录，其中包含“EstimatedDate”列。每条记录都是唯一的，并且具有不同的“EstimatedDate”。这 10 条记录都属于一个项目，具有相同的“ProjectId”。如果我更改一行的“EstimatedDate”，它应该自动更改表中具有相同“ProjectId”的以下行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:24:03.757

```
CREATE TRIGGER dbo.Activities_Update
ON dbo.Activities
AFTER UPDATE
AS
BEGIN
  SET NOCOUNT ON;
  UPDATE a
    SET EstimatedDate = i.EstimatedDate
    FROM dbo.Activities AS a
    INNER JOIN inserted AS i
    ON a.ProjectId = i.ProjectId
    WHERE a.EstimatedDate <> i.EstimatedDate;
END
GO 
```

虽然您的`UPDATE`陈述不太可能是这样的：

```
UPDATE Activities SET EstimatedDate = CASE
  WHEN ActivityID = 1 THEN GETDATE()
  WHEN ActivityID = 2 THEN DATEADD(DAY, 1, GETDATE()) END
WHERE ProjectID = 1; 
```

如果你想使用 的`MAX`日期`inserted`，你可以说：

```
CREATE TRIGGER dbo.Activities_Update
ON dbo.Activities
AFTER UPDATE
AS
BEGIN
  SET NOCOUNT ON;

  ;WITH i AS (SELECT ProjectId, d = MAX(EstimatedDate)
    FROM inserted GROUP BY ProjectId)
  UPDATE a
    SET EstimatedDate = i.d
    FROM dbo.Activities AS a
    INNER JOIN i
    ON a.ProjectId = i.ProjectId
    WHERE a.EstimatedDate <> i.d;
END
GO 
```

后者未经测试。

# knockout.js - KnockoutJS 总是通知订阅，即使映射数据相同

> ID：10286013
> 
> 赞同：0
> 
> 时间：2012-04-23T18:17:49.680
> 
> 标签：knockout.js, knockout-mapping-plugin

似乎 Knockout 在 foreach 绑定上方便的“afterRender”方法仅在添加数据时触发，而不是删除。

您可以在此处进行测试 - [http://jsfiddle.net/farina/4BaXs/1/](http://jsfiddle.net/farina/4BaXs/1/)单击加载初始值，查看四个警报，然后单击加载删除并注意没有任何反应。

所以，为了解决这个问题，我决定尝试手动订阅我的 ko.mapping.fromJS 数组，但这只会导致每次我从 AJAX 更新数据时调用，即使数据没有改变。

我觉得映射插件在某种程度上失败了，并且认为数据总是新的，即使它不是。

是否有某种事件仅在数组更改时发生？我对单个项目的订阅按预期工作，但显然您不能订阅整个项目列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:15:15.993

我写了一个函数`ko.utils.compareArrays`来找出发生了什么变化。`compareArrays`也被`foreach`绑定使用。我还拿了[您的示例并对其进行了更新](http://jsfiddle.net/mbest/Jq3ru/)以使用此功能。这里是：

```
ko.subscribable.fn.subscribeArrayChanged = function(addCallback, deleteCallback) {
    var previousValue = undefined;
    this.subscribe(function(_previousValue) {
        previousValue = _previousValue;
    }, undefined, 'beforeChange');
    this.subscribe(function(latestValue) {
        var editScript = ko.utils.compareArrays(previousValue, latestValue);
        for (var i = 0, j = editScript.length; i < j; i++) {
            switch (editScript[i].status) {
                case "retained":
                    break;
                case "deleted":
                    if (deleteCallback)
                        deleteCallback(editScript[i].value);
                    break;
                case "added":
                    if (addCallback)
                        addCallback(editScript[i].value);
                    break;
            }
        }
        previousValue = undefined;
    });
}; 
```

# java - 解析 HTTP 请求

> ID：10286014
> 
> 赞同：0
> 
> 时间：2012-04-23T18:17:50.530
> 
> 标签：java, httprequest

在处理类型的请求时

```
GET /someFile.txt HTTP/1.1 
```

是否有一个库可以帮助您轻松找到 /someFile.txt，或者手动拆分和解析内容是否常见？没什么大不了的，只是想知道。

```
message.split("\\s+")[1] // works but just looks silly 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:01:46.843

如果您在服务器（servlet 容器）端，`HttpServletRequest.getPathInfo`应该完成这项工作。

[http://goo.gl/gRW7H](http://goo.gl/gRW7H)

# symfony - 使用特定排序规则在 symfony2 中创建数据库

> ID：10286016
> 
> 赞同：0
> 
> 时间：2012-04-23T18:17:53.983
> 
> 标签：symfony, doctrine, collation

我想用`utf8_general_ci`排序规则创建数据库。我已将 MySQL 连接排序规则定义为 utf8_general_ci（在 phpmyadmin 中），并且已`charset: UTF8`在 config.yml 中定义，但是当我使用`php app/console doctrine:schema:update --force` 它时，会创建一个带有`latin1_swedish_ci`排序规则的表。有没有办法解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:20:20.033

我认为最好的办法是直接更改 MySQL 设置。将此添加到您的`my.ini`文件（MYSQL 配置文件）中：

```
[mysqld]
character-set-server=utf8
default-collation=utf8_general_ci 
```

我曾经看到一个直接从 Symfony 中执行此操作的技巧，但它需要更改 Doctrine 的一些内部代码，而且它甚至不适用于我的情况。

我最终将这些设置添加到`my.ini`文件中。

**编辑**：关于如何在 MySQL 上更改字符集和排序规则的一些链接

1.  [在 my.cnf 中将 mysql 默认字符集更改为 UTF8？](https://stackoverflow.com/q/3513773/697930)
2.  [MySQL 5.0 参考指南](http://dev.mysql.com/doc/refman/5.0/en/charset-applications.html)

问候， 马特

# android - EditText 扩展 fscreen

> ID：10286020
> 
> 赞同：0
> 
> 时间：2012-04-23T18:18:15.140
> 
> 标签：android, android-layout

我将数据直接从远程数据库加载到编辑框中，问题是当有很多数据时，它会将文本发送到屏幕外而不是开始新行。我在edittext中放了marginRight = size等，但仍然继续？任何帮助谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:20:17.607

在xml文件中选择属性`android:singleLine="false"`，也`android:maxLines="10"`，10不是强制性的，可以根据你的变化。

# html - 图像不在 IE7 中居中？

> ID：10286021
> 
> 赞同：2
> 
> 时间：2012-04-23T18:18:20.490
> 
> 标签：html, css, xhtml

```
<div class="logo">
    <h1><a href="/"><img src="image.png" alt="Red Rectangle" /></a></h1>
</div>

.logo h1 img{
    position: relative;
    width: 256px;
    left: 50%;
    margin-left: -128px;
    border: none;
} 
```

使用上面的代码，我将图像居中居中。但这仅适用于 FireFox、Chrome，因为在 Internet Explorer 7 中，图像看起来没有居中，而是距离中心右侧 30 个像素。

IE7中未完全居中的图像（红色）的屏幕截图 ![截屏](../Images/a2774b2234cc8b65c6cf65973a2bdc37.png)

有谁知道我怎样才能在 IE7 中正常工作？

编辑：我不想使用`margin: 0 auto;`，因为这使得图像周围的区域（当它居中时）也可以作为链接点击。我**只**希望图像可以作为链接点击。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:22:13.140

也许`margin: 0 auto;`对你更有效？这取决于您是在页面上定位它还是只是希望它居中。如果您知道元素的宽度，则可以使用它：

```
.logo h1 img {
    width: 256px;
    margin: 0 auto;
    border: none;
} 
```

这将使其居中，因为左右边距是自动的并且宽度已设置。

jsFiddle：http: [//jsfiddle.net/thFpF/](http://jsfiddle.net/thFpF/)

* * *

## 编辑

您应该改为将父元素居中，`margin: 0 auto;`然后将图像和锚点（`<a>`链接）放在其中。这样整个区域将无法点击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:20:23.207

如果您知道图像的宽度，最好使用：

```
.logo h1 img {
   width:128px;
   margin-left:auto;
   margin-right:auto;
} 
```

# reporting-services - Reporting Services 2008 即使被告知不要发送 SQL 身份验证凭据

> ID：10286023
> 
> 赞同：1
> 
> 时间：2012-04-23T18:18:31.740
> 
> 标签：reporting-services, ssrs-2008, windows-authentication

我有一个 SQL Reporting Services 实例，它有几个报表，其中一个数据源配置为使用存储的凭据。我检查了“连接到数据源时用作 Windows 凭据”选项，但用户仍然没有登录。我在事件查看器中发现一个错误，告诉我使用的凭据是 SQL 身份验证，因此登录失败，因为数据库引擎实例仅接受 Windows 身份验证。

任何线索我可能会丢失，或者这是一个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:26:39.377

解决方案是通过 Services MMC 插件重新启动 Reporting Services 服务。在我这样做之前没有收到数据源更改。

# sql-server - 取消透视多个列和值

> ID：10286024
> 
> 赞同：1
> 
> 时间：2012-04-23T18:18:32.543
> 
> 标签：sql-server

我有一个带有句点和三列的查询，它们是不同的数据类型。

```
abc: int
def: decimal
hij: int 
```

这三列提供的数据来自不同的查询。

*这是当前结果*：

```
Period    abc   def   hij
------    ----  ----  ---
2012-01    10   0.00    4
2012-02     5   0.00    5
2012-03     0   2.40    8 
```

*我想得到以下输出*：

```
abc 2012-01 10 0.00
abc 2012-02  5 0.00
abc 2012-03  0 0.00
def 2012-01  0 0.00
def 2012-02  0 0.00
def 2012-03  0 2.40
hij 2012-01  4 0.00
hij 2012-02  5 0.00
hij 2012-03  8 0.00 
```

我想使用 unpivot，但它给了我一个冲突类型的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T19:51:05.350

您得到的错误是因为您在 UNPIVOT 中将小数与 int 混合在一起。

看起来您想要 UNPIVOT 但随后`def`又从其他列中分离出来。

我能够实现看起来像这样的预期结果：

```
declare @t table(Period varchar(10), abc int, def decimal(5,2), hij int)
insert into @t values ('2012-01',10,0.00,4)
, ('2012-02',5,0.00,5)
, ('2012-03',0,2.40,8);

with a as (
    select cols, Period, val
    from (select Period, abc=CAST(abc as decimal(5,2)), def, hij=CAST(hij as decimal(5,2)) from @t) p
    UNPIVOT (
        val for cols in (abc, def, hij) 
    ) as unpvt
)
select a.cols
, Period
, abc_hij=case when cols in ('abc','hij') then CAST(val as int) else 0 end
, def=case when cols = ('def') then val else 0.00 end
from a
order by cols, Period
go 
```

结果：

![在此处输入图像描述](../Images/60a3fbef65efaf0ef30ed545fcefd23f.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-02T09:19:00.960

```
与 c 作为 (
SELECT '2012-01' AS Period, 10 AS abc, 0.00 AS def, 4 AS hij
联合所有
SELECT '2012-02' AS Period, 5 AS abc, 0.00 AS def , 5 AS hij
联合所有
SELECT '2012-03' AS Period, 0 AS abc, 2.40 AS def, 8 AS hij
)
选择 * 从 (
从 c 中选择 cc.title、c.Period、cc.val
交叉申请
(
  值（'abc'，abc），（'def'，def），（'hij'，hij）
）抄送（标题，验证）
) 吨
ORDER BY t.title

```

# sencha-touch-2 - 如何在列表的每一行添加一个按钮？

> ID：10286026
> 
> 赞同：7
> 
> 时间：2012-04-23T18:18:37.060
> 
> 标签：sencha-touch-2

如何将 Sencha 按钮添加到列表的每一行？我在图像中添加了文本占位符来说明按钮的位置。

![在此处输入图像描述](../Images/2b0e907776d0361ea0752395fcf3059e.png)

```
分机应用程序（{
    启动：函数（）{
        var view = Ext.Viewport.add({
            xtype: '导航视图',

            项目： [
                {
                    xtype：'列表'，
                    标题：'列表'，
                    itemTpl: '{name} [BUTTON]',

                    店铺： {
                        字段：['名称']，
                        数据： [
                            {名称：'一个'}，
                            {名称：'两个'}，
                            {名称：'三个'}
                        ]
                    },

                    听众：{
                        itemtap：函数（列表、索引、目标、记录）{
                            视图.push({
                                xtype：'面板'，
                                标题：record.get('name'),
                                html: '这是我推送的视图！'
                            })
                        }
                    }
                }
            ]
        });
    }
});

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T18:32:27.030

这不能用 来完成`Ext.List`，您必须`ComponentView`改用。

它有一些关键概念：`Ext.dataview.Component.DataItem`，自定义配置和转换`Ext.factory()`，更多细节请看这个：

[http://docs.sencha.com/touch/2-0/#!/guide/dataview](http://docs.sencha.com/touch/2-0/#!/guide/dataview)

希望能帮助到你。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-07T13:22:46.827

代替 Button 我们可以在列表的每一行中使用 Image 并在侦听器中获取单击事件（在我的情况下，我在控制器类中做了）。我希望以下内容对您有所帮助：

包含查看页面的列表：

```
items: [
   {
        xtype: 'list',
        ui: 'normal',
        itemTpl: [

            '<div class="x-list-item speaker">',
                    '<div class="avatar" style="background-image: url(resources/images/contactImages/{item6});"></div>',
                    '<div class="rightarrow" style="background-image: url(resources/images/homeScreenIphone/list_arrow.png);"></div>',
                    '<div class="image_popup_email" style="background-image: url(resources/images/commonImages/mail.png);"></div>',
                    '<div class="image_popup_workphone_icon" style="background-image: url(resources/images/commonImages/workphone_icon.png);"></div>',
                    '<div class="image_popup_phone" style="background-image: url(resources/images/commonImages/phone.png);"></div>',
                    '<h3>{item1}</h3>',
                    '<h4>{item2}</h4>',
            '</div>'
     ],
     store: 'ContactItemListStore'
   }
   ] 
```

在控制器类中：

```
onContactSelect: function(list, index, element, record, evt){

    // if click on any icon(Cell/Work Phone/Email) in any row of list
    if(evt.getTarget('.image_popup_phone')) {

        var contactNoCell = record.getData().item4;
        window.location.href = "tel:"+contactNoCell;

    }else if(evt.getTarget('.image_popup_workphone_icon')) {

        var contactNoOffice = record.getData().item7;
        window.location.href = "tel:"+contactNoOffice;

    }else if(evt.getTarget('.image_popup_email')) {

        var emailId = record.getData().item5;
        window.location.href = "mailto:"+emailId;

    }else{

    // if click on list row only(not any icon)   
        if (!this.showContactDetail) {
            this.showContactDetail = Ext.create('MyApp.view.phone.MyContactDetail');
        }

        // Bind the record onto the show contact view
        this.showContactDetail.setRecord(record);

        // Push the show contact view into the navigation view
        this.getMain().push(this.showContactDetail);
    }
        //disable selection while select row in list
        list.setDisableSelection(true);
} 
```

# html - IE9 滚动错误（边框线在屏幕上重复）

> ID：10286030
> 
> 赞同：0
> 
> 时间：2012-04-23T18:18:53.283
> 
> 标签：html, css, internet-explorer-9, dhtml

我正在做一个 DHTML 弹出窗口，其中有一个带有左浮动 LI 的 UL，它显示了一个刺绣设计列表。在 ie9（不影响 <=IE8）中，当您在 UL 中向下滚动时，所有这些不应该存在的行都会开始显示。似乎 UL 的底部边框正在撕裂并停留在屏幕上。更奇怪的是，当你向上滚动时，线条消失了......

这是问题的屏幕截图：http: [//www.flyingtigerssurplus.com/bug-sample.jpg](http://www.flyingtigerssurplus.com/bug-sample.jpg)

您可以通过以下方式在 IE9 (win7) 中复制该问题：http: [//www.flyingtigerssurplus.com/embroidery.php](http://www.flyingtigerssurplus.com/embroidery.php) 然后单击表格中间的“查看库存刺绣设计”链接。这将弹出问题区域。滚动到复制。

如果有人对如何纠正此问题有任何见解，将不胜感激！不幸的是，IE 是该站点用户群的主要浏览器，因此保留它的方式是因为 IE 很糟糕，不幸的是，在这种情况下并不是最好的解决方案:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T21:36:19.933

感谢 Matt K 帮助我意识到问题可能是什么......显然这是一个 GPU / 驱动程序问题，因为当我在高级互联网选项下禁用硬件渲染时，重新启动浏览器问题就消失了。

Aiken 到 FF 硬件加速，我笔记本电脑上糟糕的英特尔 gpu 芯片组会在打开硬件加速时导致设备崩溃......我现在必须在家里测试这个，我的塔有更好的 gpu .

# c# - javascript 在 IIS 中不起作用

> ID：10286033
> 
> 赞同：0
> 
> 时间：2012-04-23T18:19:12.753
> 
> 标签：c#, javascript, iis

我的页面卸载 javascript 工作正常，但在 IIS 中没有，我需要为此在 IIS 中授予任何权限吗？这是我的 javascript 不工作

```
window.onbeforeunload = InitializeService;
function InitializeService() {
    InitializeService1();
    if (checkdisposition.disposition == "") {
        var agree =   confirm("You Did Not Save Disposition, Are You Sure You Want To Navigate?");
        if (agree) {
            return true;
        }
        else {
            return "You Did Not Save Disposition ";
        }
    }
}

function InitializeService1() {
    if (window.XMLHttpRequest) {
        var url = "http://localhost:54329/WebServices/PageUnloadCall.asmx?op=Page_Unload";
        myReq.onreadystatechange = checkStatus1;
        myReq.open("GET", url, false); // true indicates asynchronous request
        myReq.send();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:23:46.413

大多数浏览器不允许在处理程序`XMLHttpRequest`期间发送`onbeforeunload`

此外，在处理`onbeforeunload`. 如果有未保存的数据，您应该只返回一个字符串

根据 Alexei 的回答，我猜真正的问题是您通过在`localhost`URL 栏中输入来运行您的页面。但是在部署时，您输入的是已部署服务器的名称。就像 Alexei 建议的那样，您不应该`localhost`在代码中硬编码。由于看起来您想在客户端执行此操作，因此您应该使用[https://developer.mozilla.org/en/DOM/window.location](https://developer.mozilla.org/en/DOM/window.location)

```
var url = location.host + "/WebServices/PageUnloadCall.asmx?op=Page_Unload"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:33:27.690

您网站的“非 IIS 案例”和“IIS 案例”的网址是什么？在 IIS 情况下打开对“http://localhost:54329”的 Web 请求时，您可能会遇到跨域限制（因为站点会不同（通常是[http://localhost:80](http://localhost:80)）。

请注意，正如@Juan Mendes 指出的那样，当时 XMLHttpRequest 可能根本不起作用，并且在页面关闭**之前肯定不会返回异步结果。**

# jquery - 肯定有一种简单的方法可以将附加的列表项“绑定”到现有的 UL 中吗？

> ID：10286037
> 
> 赞同：0
> 
> 时间：2012-04-23T18:19:38.647
> 
> 标签：jquery, append, html-lists, bind

我不敢相信我在问这个，但找不到明确的答案。我的 UL 从其中的两个项目开始，并通过 AJAX 调用进一步填充。我只是想将返回的项目附加到该 UL，并让它们像已经存在的两个一样“可点击”。

我已经看到了十几个不同的复杂、令人费解的答案，涉及 BIND、LIVE、DELEGATE、MAP - 所有这些都讨论了为什么不应该使用其他答案。尽管这些讨论都具有价值（我敢肯定），但似乎没有一个对像这样（看似）简单的事情给出明确的答案。当然，有一种直接的方法可以附加 LI，并让它使用为列表定义的 .click() 事件。

```
$.each(api, function(i,item) {
    var listItem = "<li meeting_id='" + item.meeting_id + "'>" + item.meeting_name + "</li>";
    $("#MeetingList").append(listItem);
    /*Do Something here to bind the newly appended LI to the existing click event */
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:21:30.597

您需要使用[`delegate`](http://api.jquery.com/delegate/)（在 jQuery 1.7+ 中已弃用）为在偶数处理程序绑定*后*[`on`](http://api.jquery.com/on/)添加到 dom 的元素设置单击处理程序功能。您发布的添加元素的代码很好。需要更改的代码是绑定单击处理程序的任何位置。

 *代替

```
$('ul li').click(function () { ... }); 
```

你需要使用

```
$('ul').delegate('li', 'click', function () { ... }); 
```

或者，在 jQuery 1.7+ 中，

```
$('ul').on('click', 'li', function () { ... }); 
```*

# c++ - 使用 Boost Asio 接受 IPv6 链接范围地址

> ID：10286042
> 
> 赞同：6
> 
> 时间：2012-04-23T18:19:44.547
> 
> 标签：c++, boost, boost-asio, ipv6

我有一个使用 Boost ASIO 的 TCP 服务器。我注意到在 Linux 上使用链接范围的 IPv6 地址时，我无法在`boost::asio::ip::tcp::acceptor`不引发异常的情况下创建一个。使用全局 IPv6 地址或 IPv4 地址可以正常工作。

我很确定问题在于没有正确设置范围 ID，但我不知道如何解决这个问题。

我正在使用 ubuntu 提供的 boost 1.40.0 库在 Ubuntu 11.04 LTS 上进行开发。这是我拥有的服务器代码的一个非常愚蠢的版本，它显示了问题：

```
#include <boost/asio.hpp>
#include <boost/shared_ptr.hpp>
#include <boost/bind.hpp>
#include <iostream>
#include <string>

/* To Compile:
g++ -Wall -o ./asio-ipv6 ./asio-ipv6.cpp -lboost_system 
*/

typedef boost::shared_ptr<boost::asio::ip::tcp::socket>   TcpSocketPtr;
typedef boost::shared_ptr<boost::asio::ip::tcp::acceptor> TcpAcceptorPtr;
typedef boost::shared_ptr<boost::asio::ip::tcp::endpoint> TcpEndpointPtr;

class AsioServer{
public:
  AsioServer(boost::asio::io_service& io): io_(io){};

  //throws
  void accept(const std::string& ipString,unsigned short port){
    boost::asio::ip::address addr = boost::asio::ip::address::from_string(ipString);
    std::cout << "Valid IP address " << ipString << std::endl;

    this->endpoint_.reset(new boost::asio::ip::tcp::endpoint(addr,port));
    std::cout << "Created endpoint" << std::endl;

    //Will throw if a link local IPv6 address is used
    acceptor_.reset(new boost::asio::ip::tcp::acceptor(this->io_,*(this->endpoint_)));

    std::cout << "About to accept on " << *(this->endpoint_) << std::endl;
    this->socket_.reset(new boost::asio::ip::tcp::socket(this->io_));
    this->acceptor_->async_accept(*socket_ ,boost::bind(&AsioServer::handle_accept,this,boost::asio::placeholders::error)); 
  }

private:
  boost::asio::io_service& io_;
  TcpSocketPtr socket_;
  TcpAcceptorPtr acceptor_;
  TcpEndpointPtr endpoint_;

  void handle_accept(const boost::system::error_code &ec){
    if(!ec){
      std::cout << "Accepted connection!" << std::endl;
    }
    else{
      std::cout << "Error accepting connection" << std::endl;
    }
  };

};

int main(int argc, char* argv[]){

  boost::asio::io_service io;

  std::string ipString("0.0.0.0");
  if(argc > 1){
    ipString.assign(argv[1]);   
  }
  std::cout << "IP Set to " << ipString << std::endl;

  AsioServer server(io);

  try{
    server.accept(ipString,4444);
  }
  catch(const std::exception& e){
    std::cout << "Error caught:  " << e.what() << std::endl;
  }

  io.run();

  std::cout << "Done!" << std::endl;

  return 0;
} 
```

在这台机器上，我为 eth0 配置了以下内容：

```
$ ifconfig eth0
eth0      Link encap:Ethernet  HWaddr 00:0c:29:10:cf:0e  
          inet addr:192.168.97.162  Bcast:192.168.97.255  Mask:255.255.255.0
          inet6 addr: 2620:1c:8000:190:20c:29ff:fe10:cf0e/64 Scope:Global
          inet6 addr: fe80::20c:29ff:fe10:cf0e/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:112470185 errors:2 dropped:1 overruns:0 frame:0
          TX packets:5900249 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:2187237130 (2.1 GB)  TX bytes:1640094885 (1.6 GB)
          Interrupt:19 Base address:0x2000 
```

使用**192.168.97.162**、**0.0.0.0**、**127.0.0.1**、**::1**或**2620:1c:8000:190:20c:29ff:fe10:cf0e**运行程序工作正常，但使用**fe80::20c:29ff:fe10:cf0e**失败创建一个带有“无效参数”异常的接受器。

```
$ ./asio-ipv6 fe80::20c:29ff:fe10:cf0e
IP Set to fe80::20c:29ff:fe10:cf0e
Valid IP address fe80::20c:29ff:fe10:cf0e
Created endpoint
Error caught:  Invalid argument
Done! 
```

这让我想起了使用 ping6 并看到相同的“无效参数”错误。修复方法是传递附加到 IPv6 地址的接口。

```
$ ping6 fe80::219:b9ff:fe2b:3a53  #Won't work
connect: Invalid argument
$ ping6 fe80::219:b9ff:fe2b:3a53%eth0 #Pass the interface to use to ping6 
PING fe80::219:b9ff:fe2b:3a53%eth0(fe80::219:b9ff:fe2b:3a53) 56 data bytes 
```

当我尝试从字符串创建 IP 地址时，这似乎不适用于 Boost Asio。

```
$ ./asio-ipv6 fe80::20c:29ff:fe10:cf0e%eth0
IP Set to fe80::20c:29ff:fe10:cf0e%eth0
Error caught:  Invalid argument
Done! 
```

我的问题是如何使用 Boost ASIO 监听链接范围的 IPv6 地址？该类`boost::asio::ip::address_v6`有一个[scope_id() 成员函数](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/reference/ip__address_v6/scope_id.html)，但我不确定从哪里获取范围 id 作为 unsigned long 或者这是否是问题所在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T18:21:38.217

这可以使用一个来完成`boost::asio::ip::tcp::resolver`

```
--- ipv6.cc.orig        2012-04-24 12:03:02.349911481 -0500
+++ ipv6.cc     2012-04-24 12:02:07.053037095 -0500
@@ -10,42 +10,67 @@

 typedef boost::shared_ptr<boost::asio::ip::tcp::socket>   TcpSocketPtr;
 typedef boost::shared_ptr<boost::asio::ip::tcp::acceptor> TcpAcceptorPtr;
+typedef boost::shared_ptr<boost::asio::ip::tcp::resolver> TcpResolverPtr;
 typedef boost::shared_ptr<boost::asio::ip::tcp::endpoint> TcpEndpointPtr;

 class AsioServer{
 public:
   AsioServer(boost::asio::io_service& io): io_(io){};

-  //throws
-  void accept(const std::string& ipString,unsigned short port){
-    boost::asio::ip::address addr = boost::asio::ip::address::from_string(ipString);
-    std::cout << "Valid IP address " << ipString << std::endl;
-
-    this->endpoint_.reset(new boost::asio::ip::tcp::endpoint(addr,port));
-    std::cout << "Created endpoint" << std::endl;
-
-    //Will throw if a link local IPv6 address is used
-    acceptor_.reset(new boost::asio::ip::tcp::acceptor(this->io_,*(this->endpoint_)));
-
-    std::cout << "About to accept on " << *(this->endpoint_) << std::endl;
-    this->socket_.reset(new boost::asio::ip::tcp::socket(this->io_));
-    this->acceptor_->async_accept(*socket_ ,boost::bind(&AsioServer::handle_accept,this,boost::asio::placeholders::error)); 
+  void resolve(const std::string& ipString, const std::string& service){
+    this->resolver_.reset(new boost::asio::ip::tcp::resolver(io_));
+    boost::asio::ip::tcp::resolver::query query( ipString, service );
+    this->resolver_->async_resolve( query, boost::bind( &AsioServer::handle_resolve, this, boost::asio::placeholders::error, boost::asio::placeholders::iterator ) );
   }
-
 private:
   boost::asio::io_service& io_;
   TcpSocketPtr socket_;
   TcpAcceptorPtr acceptor_;
   TcpEndpointPtr endpoint_;
+  TcpResolverPtr resolver_;
+
+  void accept(const boost::asio::ip::tcp::resolver::iterator iterator) {
+    endpoint_.reset(new boost::asio::ip::tcp::endpoint(iterator->endpoint()));
+    //Will throw if a link local IPv6 address is used
+    acceptor_.reset(new boost::asio::ip::tcp::acceptor(this->io_));
+    acceptor_->open(this->endpoint_->protocol());
+    acceptor_->bind(*(this->endpoint_));
+    acceptor_->listen();
+
+
+    std::cout << "About to accept on " << *(this->endpoint_) << std::endl;
+    socket_.reset(new boost::asio::ip::tcp::socket(this->io_));
+    acceptor_->async_accept(*socket_ ,boost::bind(&AsioServer::handle_accept,this,boost::asio::placeholders::error)); 
+  }
+

   void handle_accept(const boost::system::error_code &ec){
     if(!ec){
       std::cout << "Accepted connection!" << std::endl;
     }
     else{
-      std::cout << "Error accepting connection" << std::endl;
+      std::cout << "Error accepting connection: " << boost::system::system_error(ec).what() << std::endl;
+    }
+  }
+  
+  void handle_resolve(
+        const boost::system::error_code& ec,
+        boost::asio::ip::tcp::resolver::iterator iterator
+       )
+  {
+    if(ec) {
+      std::cerr << "could not resolve: " << boost::system::system_error(ec).what() << std::endl;
+      return;
     }
-  };
+
+    if ( iterator == boost::asio::ip::tcp::resolver::iterator() ) {
+      std::cerr << "no endpoints resolved" << std::endl;
+      return;
+    }
+
+    this->accept(iterator);
+
+  }

 };

@@ -62,7 +87,7 @@
   AsioServer server(io);

   try{
-    server.accept(ipString,4444);
+    server.resolve(ipString,"4444");
   }
   catch(const std::exception& e){
     std::cout << "Error caught:  " << e.what() << std::endl; 
```

示例会话

```
[samm@t410 Desktop]$ ifconfig | grep fe80
          inet6 addr: fe80::5a94:6bff:fe7c:e760/64 Scope:Link
[samm@t410 Desktop]$ g++ -g ipv6.cc -lboost_system -lboost_thread-mt
[samm@t410 Desktop]$ ./a.out fe80::5a94:6bff:fe7c:e760%wlan0
IP Set to fe80::5a94:6bff:fe7c:e760%wlan0
About to accept on [fe80::5a94:6bff:fe7c:e760%wlan0]:4444
^C
[samm@t410 Desktop]$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T17:30:12.693

`ip link ls`从命令行或代码中使用`if_nametoindex()`来获取给定设备的接口索引。例如在我的笔记本电脑上：

```
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue state UNKNOWN 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc pfifo_fast state DOWN qlen 1000
    link/ether f0:de:f1:5c:39:37 brd ff:ff:ff:ff:ff:ff 
```

在我的例子中，接口索引为`eth0`2。如果 Boost 只接受一个数值，则使用它作为范围 id。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-20T16:50:11.723

这是使用 spawn 函数的更简单的解决方案。

```
#include <boost/asio.hpp>
#include <boost/asio/spawn.hpp>
#include <boost/shared_ptr.hpp>
#include <boost/bind.hpp>
#include <iostream>
#include <string>

class AsioServer{
public:
    AsioServer(boost::asio::io_service& io): m_io(io) {}

    void accept(const std::string& ip_address, const std::string& service) {
        boost::asio::spawn(m_io, [this, ip_address, service](boost::asio::yield_context yield) {
            try {
                using tcp = boost::asio::ip::tcp;
                boost::system::error_code ec;
                tcp::resolver resolver(m_io);
                tcp::resolver::iterator iterator =
                        resolver.async_resolve(tcp::resolver::query(ip_address, service), yield);
                if (iterator == tcp::resolver::iterator()) {
                    std::cerr << "No endpoints resolved for "<< ip_address  << std::endl;
                    return;
                }
                tcp::endpoint endpoint(iterator->endpoint());
                std::cout << "Endpoint: " << endpoint << std::endl;
                tcp::acceptor acceptor(m_io);
                acceptor.open(endpoint.protocol());
                acceptor.bind(endpoint);
                acceptor.listen();
                std::cout << "About to accept on " << endpoint << std::endl;
                for (;;)
                {
                  tcp::socket socket(m_io);
                  acceptor.async_accept(socket, yield[ec]);
                  if (ec) {
                      std::cerr << "Error accepting connection: " << boost::system::system_error(ec).what() << std::endl;
                  } else {
                      std::cout << "Accepted connection from " << socket.remote_endpoint() << std::endl;
                      //std::make_shared<session>(std::move(socket))->go();
                  }
                }
            }
            catch( std::exception &e) {
                std::cerr << "Error setting up accepting port: " << e.what() << std::endl;
            }
          });
    }

private:
    boost::asio::io_service& m_io;
};

int main(int argc, char* argv[])
{
    boost::asio::io_service io;
    std::string ipString("0.0.0.0");

    if(argc > 1){
      ipString.assign(argv[1]);
    }
    std::cout << "IP Set to " << ipString << std::endl;

    AsioServer server(io);

    try{
      server.accept(ipString,"4444");
    }
    catch(const std::exception& e){
      std::cout << "Error caught:  " << e.what() << std::endl;
    }

    io.run();
    std::cout << "Done!" << std::endl;
    return 0;
} 
```

执行结果

```
AsioServer$ ifconfig | grep fe80
          adr inet6: fe80::be5f:f4ff:fef7:8a46/64 Scope:Lien
AsioServer$ ./a_out fe80::be5f:f4ff:fef7:8a46%eth0
IP Set to fe80::be5f:f4ff:fef7:8a46%eth0
Endpoint: [fe80::be5f:f4ff:fef7:8a46%eth0]:4444
About to accept on [fe80::be5f:f4ff:fef7:8a46%eth0]:4444 
```

# spring - 在jsp中选择父收音机后如何使用嵌套的div和复选框

> ID：10286043
> 
> 赞同：1
> 
> 时间：2012-04-23T18:19:49.070
> 
> 标签：spring, checkbox, radio-button, jstl, jsp-tags

我有 2 个单选按钮，分别代表美国和加拿大。如果我选择 USA 单选按钮，我想要一个 div 标签来显示 Address1、Address2、Country、State、Email 和 2 个复选框，其中一个将提供选择电子邮件新闻信函的选项，另一个是选择 Twitter 更新的选项。

如果我选择 CANADA 单选按钮，我想要一个带有地址 1、州和电子邮件的 div 标签以及一个用于电子邮件新闻信函的复选框。注意：这里我不想要地址 2、县文本框和 Twitter 复选框。

用户填写所需信息后；我想使用 spring:bind 将所有这些值包括选定的国家无线电值捕获到 myRegistrationForm.address 中（地址是一个复杂的对象，具有地址 1、地址 2、县、州、电子邮件和国家字符串属性以及 emailNewsLetter、twitterUpdates 布尔属性）。

这是我想要实现的示例片段。提前感谢您帮助我。

```
<td>
<spring:bind path="registerForm.address">
<input type="radio" name="country" value="USA" <c:if test='${status.value == "USA"}'>checked</c:if>> USA
<!-- If above radio is selected I need  dynamic div table with some textboxes and 2 check boxes and needs to be captured -->
<c:if test='${status.value == "USA"}'>
    <div id="address-usa">
        Address 1: <input type="text" name="addressOne"/>
        Address 2: <input type="text" name="addressTwo"/>
        County: <input type="text" name="county"/>
        State: <input type="text" name="state"/>
        Email: <input type="email" name="email"/>
        <input type="checkbox" value="NEWSLETTER">E-Mail News Letter
        <input type="checkbox" value="twitter">Twitter Updates
    </div>
</c:if> 

<input type="radio" name="country" value="CANADA" <c:if test='${status.value == "CANADA"}'>checked</c:if>> CANADA
<c:if test='${status.value == "CANADA"}'>
    <div id="address-canada">
        Address 1: <input type="text" name="addressOne"/>
        <!-- Note I dont need address 2 and county for canada -->
        State: <input type="text" name="state"/>
        Email: <input type="email" name="email"/>
        <input type="checkbox" value="NEWSLETTER">E-Mail News Letter
        <!-- No twitter updates for canada customers -->
    </div>
</c:if> 
</spring:bind>
</td> 
```

更准确地说：我想用 html/jsp 代码包装`<spring:nestedPath/> <spring:bind> <c:foreach> <c:if>`

[您可以使用http://jsfiddle.net/eKFrW/298/](http://jsfiddle.net/eKFrW/298/)运行以下代码

```
<label><input id="rdb1" type="radio" name="toggler" value="1" />USA</label>
<label><input id="rdb2" type="radio" name="toggler" value="2" />CANADA</label>

<div id="blk-1" class="toHide" style="display:none">
    Address 1: <input type="text" name="addressOne"><br/>
    Address 2: <input type="text" name="addressTwo"><br/>
    County : <input type="text" name="county"><br/>
    Email : <input type="email" name="email"><br/>
    E-mail News Letter: <input type="checkbox" name="emailLetter">
    Twitter Updates : <input type="checkbox" name="twitterUpdates">
</div>
<div id="blk-2" class="toHide" style="display:none">
    Address 1: <input type="text" name="addressOne"><br/>
    Email : <input type="email" name="email"><br/>
    E-mail News Letter: <input type="checkbox" name="emailLetter">
</div>​ 
```

以及相关的 Java 脚本：

```
$(function() {
    $("[name=toggler]").click(function(){
            $('.toHide').hide();
            $("#blk-"+$(this).val()).show('slow');
    });
 });​ 
```

# php - 我需要添加什么代码才能在新窗口中打开？

> ID：10286046
> 
> 赞同：0
> 
> 时间：2012-04-23T18:20:00.453
> 
> 标签：php, html

我有一个价格表插件，可以在同一窗口中打开按钮链接。我想在一个新的空白窗口中打开主题。我需要在这个文件中添加什么代码？

另请注意，链接是由 wordpress 插件生成的，因此我无法在代码中手动添加 target="_blank"。

谢谢您的帮助

```
<div class="price-columns">
    <div id="column-skeleton" style="display:none">

        <span class="ui-icon ui-icon-carat-2-e-w column-handle"></span>
        <a href="#" class="ui-icon ui-icon-trash submitdelete deletion"></a>

        <div class="type">
            <input type="radio" value="recommend" name="price_recommend" />
            <label><?php _e('Recommend', 'pricetable') ?></label>
        </div>

        <input type="text" class="column-title" name="" placeholder="<?php _e('Title', 'pricetable') ?>" />
        <input type="text" class="column-price" name="" placeholder="<?php _e('Price', 'pricetable') ?>" />
        <input type="text" class="column-detail" name="" placeholder="<?php _e('Detail', 'pricetable') ?>" />
        <input type="text" class="column-url" name="" placeholder="<?php _e('Button URL', 'pricetable') ?>" />
        <input type="text" class="column-button" name="" placeholder="<?php _e('Button Text', 'pricetable') ?>" />

        <h4><a href="#" class="addfeature"><?php _e('Add', 'pricetable') ?></a><?php _e('Features', 'pricetable') ?></h4>
        <div class="feautres">
            <div class="feature">
                <span class="ui-icon ui-icon-carat-2-n-s feature-handle"></span>
                <a href="#" class="ui-icon ui-icon-trash submitdelete deletion"></a>

                <div><input type="text" class="feature-title" placeholder="<?php _e('Title', 'pricetable') ?>"/></div>
                <div><input type="text" class="feature-sub" placeholder="<?php _e('Sub title', 'pricetable') ?>" /></div>
            </div>
        </div>
    </div>

    <?php // Existing columns of the price table ?>
    <?php foreach($table as $i => $column) : ?>
        <div class="column">
            <span class="ui-icon ui-icon-carat-2-e-w column-handle"></span>
            <a href="#" class="ui-icon ui-icon-trash submitdelete deletion"></a>

            <div class="type">
                <input type="radio" name="price_recommend" id="price_recommend_<?php print $i ?>" value="<?php print $i ?>" <?php if(isset($column['featured']) && $column['featured'] === 'true') print 'checked="true"'; ?> />
                <label for="price_recommend_<?php print $i ?>"><?php _e('Recommend', 'pricetable') ?></label>
            </div>

            <input type="text" class="column-title" name="price_<?php print $i ?>_title" value="<?php @esc_attr_e($column['title']) ?>" placeholder="<?php _e('Title', 'pricetable') ?>" />
            <input type="text" class="column-price" name="price_<?php print $i ?>_price" value="<?php @esc_attr_e($column['price']) ?>" placeholder="<?php _e('Price', 'pricetable') ?>" />
            <input type="text" class="column-detail" name="price_<?php print $i ?>_detail" value="<?php @esc_attr_e($column['detail']) ?>" placeholder="<?php _e('Detail', 'pricetable') ?>" />
            <input type="text" class="column-url" name="price_<?php print $i ?>_url" value="<?php @esc_attr_e($column['url']) ?>" placeholder="<?php _e('Button URL', 'pricetable') ?>" />
            <input type="text" class="column-button" name="price_<?php print $i ?>_button" value="<?php @esc_attr_e($column['button']) ?>" placeholder="<?php _e('Button Text', 'pricetable') ?>" />

            <h4><a href="#" class="addfeature"><?php _e('Add', 'pricetable') ?></a><?php _e('Features', 'pricetable') ?></h4>
            <div class="feautres">
                <?php if(isset($column['features'])) : foreach($column['features'] as $j => $feature) : ?>
                    <div class="feature">
                        <span class="ui-icon ui-icon-carat-2-n-s feature-handle"></span>
                        <a href="#" class="ui-icon ui-icon-trash submitdelete deletion"></a>

                        <div><input type="text" class="feature-title" name="price_<?php print $i ?>_feature_<?php print $j ?>_title" value="<?php esc_attr_e($feature['title']) ?>" placeholder="<?php _e('Title', 'pricetable') ?>"/></div>
                        <div><input type="text" class="feature-sub" name="price_<?php print $i ?>_feature_<?php print $j ?>_sub" value="<?php esc_attr_e($feature['sub']) ?>" placeholder="<?php _e('Sub title', 'pricetable') ?>" /></div>
                    </div>
                <?php endforeach; endif; ?>
            </div>
        </div>
    <?php endforeach ?>

    <div class="column addnew"><?php _e('Add Column', 'pricetable') ?></div>
    <div class="clear"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:22:31.433

您可以`target="_blank"`在`<a>`标签中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T18:35:59.500

好的，如果您的链接是由 wordpress 生成的，您可以考虑在页面加载后动态添加目标属性。`Use the following script after page load or document ready`：

```
<head>
<script type="text/javascript">

function add_target()
{
   // Find all the anchors you want to modify
   var anchors = document..getElementsByTagName('a'),
   i = anchors.length;

   // Add the target to each one
   while(i--) anchors[i].target = "_blank";
}

</script>
</head>

<body onload="add_target()">
/* your body */
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T18:23:10.477

添加到每个 Target="_blank" 就是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T18:26:02.547

`<a href="your_url" target="_blank">link</a>`在您的代码中使用。

# java - JSP解析错误

> ID：10286048
> 
> 赞同：1
> 
> 时间：2012-04-23T18:20:08.247
> 
> 标签：java, jsp

这是我第一次尝试使用 JSP，但在最后一行的链接中出现解析错误。我已经有一个“;”。

```
<%@page contentType="application/atom+xml; charset=utf-8" %><%
String
baseURL = request.getScheme() + "://" + request.getServerName() +
request.getServerPort()+ ":" + request.getContextPath();
Integer id=0;
String link="";
%>

<feed xsi:schemaLocation="http://www.w3.org/2005/Atom ../XMLschemas/atom/atom.xsd"
    xmlns="http://www.w3.org/2005/Atom" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <title type="text">1</title>
    <id><%=baseURL%></id>
    <updated>2012-04-23T15:49:17Z</updated>
    <link rel="self"
        href="https://example.com" />
    <entry>
        <id><%link = baseURL + "/" + Integer.toString(++id); %><%=link%></id> 
```

在 Weblogic 中：

```
feed.jsp:69:16: Syntax error, insert ";" to complete Statement
                <id><%link = "good_subjectdoc_relativeurl.xml"%></id> 
```

饲料的其余部分：

```
 <title type="text">good_subjectdoc_absoluteurl_samebase_singledocname.xml
        </title>
        <updated>2012-04-23T15:49:17Z</updated>
        <author>
            <name>TEST</name>
        </author>
        <contributor>
            <name>TEST</name>
        </contributor>
        <link rel="alternate" type="application/xml" title="Subject Document"
            href="<%=link%>" />
            <category term="TEST" />
                <content>
                                    Content             
                              </content>
    </entry> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:04:15.027

> feed.jsp:69:16：语法错误，插入“;” 完成声明

正如错误所说，您需要`;`在以下行中插入以完成语句：

```
<id><%link = "good_subjectdoc_relativeurl.xml"%></id> 
```

因此，所以：

```
<id><%link = "good_subjectdoc_relativeurl.xml";%></id> 
```

# android - How to get killer graphics on an android game?

> ID：10286052
> 
> 赞同：-2
> 
> 时间：2012-04-23T18:20:27.200
> 
> 标签：android, graphics

In games like Angry Birds, they have really crisp graphics. I want my game to have graphics like that. Could someone give me a couple of pointers regarding this?

My basically consists of a spaceship and asteroids. I've drawn large vector images for these components (800 px X 800 px) with transparent backgrounds. I've saved the file as a .png but I'm not quite sure where to go from here.

Are vector images the right way to go for getting crisp game elements like in Angry Birds?

Would the following steps be correct: 1\. Scale the image down to match the size of the object in the game. 2\. Save the image in the res/Drawables folder?

I think this must be a really basic question so pardon my ignorance and thanks for your help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T18:25:00.097

Use high resolution, large images and scale them in your game. You will be dealing with a variety of devices and will thus have to take into account the varying screen resolutions/sizes. You need to have the game programmatically decide what image sets to use, otherwise you could have great looking graphics on one device but nasty images on a different device.

This question should have everything you need: [Delveloping for Android high res screens, but supporting low res screens](https://stackoverflow.com/questions/3979981/delveloping-for-android-high-res-screens-but-supporting-low-res-screens)

# c# - 在 C# 中退出控制台应用程序的命令是什么？

> ID：10286056
> 
> 赞同：302
> 
> 时间：2012-04-23T18:20:47.653
> 
> 标签：c#, console-application, exit

C# 中用于退出控制台应用程序的命令是什么？

* * *

## 回答 #1

> 赞同：415
> 
> 时间：2012-04-23T18:23:10.210

您可以使用`Environment.Exit(0);`和`Application.Exit`

`Environment.Exit(0)` [更干净](https://web.archive.org/web/20201029173358/http://geekswithblogs.net/mtreadwell/archive/2004/06/06/6123.aspx)。

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2012-04-23T18:23:45.967

几个选项，按最合适的顺序排列：

1.  从 Program.Main 方法返回一个 int
2.  抛出异常并且不在任何地方处理它（用于意外错误情况）
3.  在其他地方强制终止，`System.Environment.Exit`（**不可移植！见下文**）

*编辑于 9/2013 以提高可读性*

**使用特定的退出代码返回：**正如 Servy 在注释中指出的那样，您可以使用`int`返回类型声明 Main 并以这种方式返回错误代码。所以真的没有必要使用 Environment.Exit*除非*您需要使用退出代码终止并且不可能在 Main 方法中执行此操作。很可能你可以通过抛出异常来避免这种情况，如果有任何未处理的异常在那里传播，则在 Main 中返回错误代码。如果应用程序是多线程的，您可能需要更多样板来正确终止退出代码，因此您最好只调用 Environment.Exit。

反对使用的另一点`Evironment.Exit`——即使是在编写多线程应用程序时——是**可重用性**。如果您想在一个`Environment.Exit`无关紧要的环境中重用您的代码（例如可能在 Web 服务器中使用的库），那么代码将不可移植。在我看来，最好的解决方案仍然是始终使用表示方法达到某种错误/完成状态的异常和/或返回值。这样，您始终可以在任何 .NET 环境和任何类型的应用程序中使用相同的代码。如果您正在编写一个需要返回退出代码或以类似方式终止的应用程序，`Environment.Exit`那么您可以继续在最高级别包装线程并根据需要处理错误/异常。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-04-23T18:25:10.347

当 main 函数完成运行时，控制台应用程序将退出。“回报”将实现这一目标。

```
 static void Main(string[] args)
    {
        while (true)
        {
            Console.WriteLine("I'm running!");
            return; //This will exit the console application's running thread
        }
    } 
```

如果你返回一个错误代码，你可以这样做，它可以从初始线程之外的函数访问：

```
 System.Environment.Exit(-1); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-04-23T19:31:24.400

您可以使用`Environment.Exit(0)`和`Application.Exit`。

`Environment.Exit()`: 终止此进程并为底层操作系统提供指定的退出代码。

# nlp - 什么时候 n-gram (n>3) 比 bigrams 或 trigrams 更重要？

> ID：10286058
> 
> 赞同：9
> 
> 时间：2012-04-23T18:20:55.263
> 
> 标签：nlp, data-mining, nltk, n-gram

考虑到计算它们的计算开销，我只是想知道 n-gram (n>3) （及其出现频率）的用途是什么。是否有任何应用程序中二元组或三元组根本不够用？

如果是这样，n-gram 提取的最新技术是什么？有什么建议么？我知道以下几点：

*   [一种用于大量n的n-gram统计新方法以及从日语大文本数据中自动提取单词和短语](http://acl.ldc.upenn.edu/C/C94/C94-1101.pdf)
*   [使用后缀数组计算语料库中所有子串的词频和文档频率](http://acl.ldc.upenn.edu/J/J01/J01-1001.pdf)
*   [词关联规范、互信息和词典编纂](http://acl.ldc.upenn.edu/J/J90/J90-1003.pdf)
*   [从文本中检索搭配：Xtract](http://acl.ldc.upenn.edu/J/J93/J93-1007.pdf)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:43:40.690

我不熟悉这里列出的大量标签，但是 n-gram（抽象概念）通常与统计模型相关。因此，这里有一些不仅限于二元组和三元组的应用程序：

*   压缩算法（尤其是 PPM 变种），其中克的长度取决于可用于提供特定上下文的数据量。
*   近似字符串匹配（例如 BLAST 用于基因序列匹配）
*   预测模型（例如名称生成器）
*   语音识别（音素图用于帮助评估当前音素被识别的可能性的可能性）

[这些是我想不到的，但维基百科上](http://en.wikipedia.org/wiki/N-gram)列出的还有更多。

至于“最先进的”n-gram 提取，不知道。N-gram“提取”是一种临时尝试，旨在加速某些过程，同时仍保持 n-gram 样式建模的好处。简而言之，“最先进的”取决于您要做什么。如果您正在查看模糊匹配或模糊分组，这取决于您匹配/分组的数据类型。（例如街道地址将与模糊匹配与名字非常不同。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T19:02:54.653

一种考虑高阶 n-gram 的（非常规）方法可以通过连接到非归一[化自相关函数](http://en.wikipedia.org/wiki/Autocorrelation)来完成，即信号与其自身的相关性。2-gram 语料库将测量单词与单个单词的“时间”滞后的相关性，而 3-gram 可以为我们提供两步“时间”滞后的信息。高阶 n-gram 给出了特定语料库（无论是*Moby Dick*还是人类 DNA）的概率分布的度量。这样，如果一个 n-gram 与空期望值不同，那么对于 n 的值就有有用的统计信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T10:33:54.603

我认为您的问题提出的不太正确：Ngrams 是一种工具，而不是要解决的问题，因此 ngrams 中没有“最先进的技术”。正如@Hooked 指出的那样，ngram 是一种自相关函数（或“自回归函数”）。所以你真正想知道的是，如果有任何问题，最先进的解决方案涉及长 ngram。

对于拟合金融或天气模型或语音识别等数值应用，您肯定会使用维度*> 3*的向量。例如，自回归隐马尔可夫模型拟合最后*n*次测量的分段函数，如果过去的状态与预测未来相关，则*n*可以适度大。

但是您所有的示例都涉及单词 ngram，我想不出任何发现*n > 3*在该领域有用的工作。我不认为这是计算成本或找到足够训练数据的问题：语言中的表面自相关似乎在 3 个单词左右后逐渐消失。随机示例：[本文](http://web.mit.edu/piantado/www/papers/PNAS-2011-Piantadosi-1012551108.pdf)试图从基于 ngram 的信息内容方面重新解释 Zipf 定律。他们认为*n*最多为 4，但三元组计数的总体相关性最高。

我并不是说*n > 3*没有*用*；但是你观察到它似乎没有出现太多是有根据的。

但请注意，在文本中计算 ngram 的复杂性不是问题：如果您有一个长度为 L 的标记化语料库，您可以像这样收集语料库的所有 ngram：

```
 for i in range(0, L-n):
        tuple = corpus[i:i+n]
        ngrams[tuple] += 1 
```

如您所见，这只需要*O(L)*步，即它与语料库的大小呈线性关系，并且不会随*n*增长。因此，收集任何维度的 ngram 都不是问题。但是可能的 ngram 数量迅速增加。举例来说，如果你区分 32 个字母标记（字母和一些标点符号类），则有 1024 个字母二元组，但有 1048576 个四元组。要找到足够多的文本来填充频率表，您需要成倍增加的文本。

对于单词 ngram，稀疏性问题更加严重，因为您不仅有*超过*32 个不同的单词标记，而且词汇量随着语料库的大小（缓慢）增加：著名的“长尾”属性。因此，无论您收集多大的语料库，您的数据都将是稀疏的（即使是小的*n也是如此）。*然后，您需要拟合复杂的统计模型，其计算成本取决于不同 ngram 的数量。

因此，稀疏性始终是 word ngram 应用程序中的一个问题（因此“平滑”通常是必要的）。如果你用谷歌搜索“ngram sparsity”，你会发现大量的参考资料。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-23T20:34:45.490

除了Kaganar的回答：

任何类型的[文体分析](http://en.wikipedia.org/wiki/Stylometry)（例如，基于写作风格的作者分析，或者试图检测文本的时代）都需要更长的 n-gram 来进行浅层句法分析。通常这些方法由基于[PCFG](http://en.wikipedia.org/wiki/Stochastic_context-free_grammar)、[TAG](http://en.wikipedia.org/wiki/Tree-adjoining_grammar)等的深度句法解析来补充。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-30T10:41:37.270

如果您的数据集非常大，您也可以使用 n>3 语言模型。

# php - bbcode_parser 不允许换行

> ID：10286060
> 
> 赞同：1
> 
> 时间：2012-04-23T18:21:01.237
> 
> 标签：php, bbcode

```
function bb_parse($string, $tags = 'b|i|u|quote|url|img|youtube|user') {
    $replacement = 0;
    while (preg_match_all('`\[('.$tags.')=?(.*?)\](.+?)\[/\1\]`', $string, $matches)) foreach ($matches[0] as $key => $match) {
        list($tag, $param, $innertext) = array($matches[1][$key], $matches[2][$key], $matches[3][$key]);
        switch ($tag) {
            case 'b': $replacement = '<strong>'.$innertext.'</strong>'; break;
            case 'i': $replacement = '<em>'.$innertext.'</em>'; break;
            case 'u': $replacement = '<span style="text-decoration: underline;">'.$innertext.'</span>'; break;
            case 'quote': $replacement = '<div class="quote"><div class="quote-author">'.($param ? 'Quote by: '.$param : 'Quote').'</div>'.$innertext.'</div>'; break;
            case 'url': $replacement = '<a href="'.($param ? $param : $innertext).'">'.$innertext.'</a>'; break;
            case 'user': $replacement = '<a href="'.url('user/'.($param ? $param : $innertext)).'">'.$innertext.'</a>'; break;
            case 'img': $replacement = '<img src="'.$innertext.'" style="max-width: 640px;"/>'; break;
            case 'youtube':
            $videourl = parse_url($innertext);
            parse_str($videourl['query'], $videoquery);
            if (strpos($videourl['host'], 'youtube.com') !== FALSE) $replacement = '<div><iframe width="755" height="425" src="http://www.youtube.com/embed/'.$videoquery['v'].'" frameborder="0" allowfullscreen></iframe></div>';
            break;
        }
        $string = str_replace($match, $replacement, $string);
    }
    return $string;
} 
```

例如，如果我将 [quote] 与换行符一起使用，它将输出：

```
[quote]This is {LINEBREAK}
a test[/quote] 
```

而不是这应该的

```
<div class="quote"><div class="quote-author">Quote</div>This is {LINEBREAK}
a test</div> 
```

有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T18:29:12.303

您可以使用`s`RegEx 上的修饰符来表示“单行模式”。默认情况下，点 ( `.`) 不匹配换行符。使用`s`修饰符，它确实如此。

```
preg_match_all('`\[('.$tags.')=?(.*?)\](.+?)\[/\1\]`s', $string, $matches) 
```

# ruby-on-rails-3 - Hartl Rails 第 8.3 节 rspec 错误

> ID：10286061
> 
> 赞同：3
> 
> 时间：2012-04-23T18:21:01.457
> 
> 标签：ruby-on-rails-3, railstutorial.org

我正在学习 hartl rails 教程

我在第 8.3 节的末尾，应用程序运行正常，但出现 rspec 错误

```
1) User pages signup with valid information after saving the user 
 Failure/Error: it { should have_link('Sign out') }
   expected link "Sign out" to return something
 # ./spec/requests/user_pages_spec.rb:48:in `block (5 levels) in <top (required)>' 
```

user_pages_spec.rb 中涉及的部分是

```
it "should create a user" do
    expect { click_button submit }.to change(User, :count).by(1)
  end  
  describe "after saving the user" do
    it { should have_link('Sign out') }
  end 
```

我对如何解决这个问题有点茫然。还有其他与此类似的帖子，但唉，我无法让他们的解决方案适用于我的情况。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T13:32:44.490

看起来您需要在检查链接之前创建帐户。测试的内容比您发布的要多。这是我在阅读教程时使用的代码片段。

```
describe "after saving the user" do
  before { click_button "Create my account" }
  it { should have_link('Sign out') }
end 
```

# java - 平铺 Java 和视差

> ID：10286067
> 
> 赞同：0
> 
> 时间：2012-04-23T18:21:38.150
> 
> 标签：java, scroll, parallax, slick2d

有谁知道[GitHub Java 版 Tiled](https://github.com/bjorn/tiled-java)中对视差层的临时支持如何正常工作？

它编译，并且执行良好。但是，如果我将图层设置为`viewplane distance`0.00（最小值）和`eye-viewplace distance`0.00，我希望代表游戏视口的黄色矩形与编辑器视图以 1:1 的比例滚动。它没有，并且一直滚动到编辑器视图的左侧会导致黄色的“视口”矩形离开屏幕的一半。

我误解了该工具，还是它不在工作状态？如果我能理解，那么扩展 Slick2D 的 TiledMap 类以渲染具有视差深度的图层应该是微不足道的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T07:54:33.763

仔细检查代码后，作者似乎打算将视差的原点作为地图的中心。这是有问题的，因为它会导致上述问题，所以我重写了它，使视口始终绑定到视`0.00`平面。

如果有人对代码感兴趣，请回复此答案，我会提供。

# javascript - Play 2.0 - JavaScript 资产中的闭包编译器内部错误

> ID：10286069
> 
> 赞同：2
> 
> 时间：2012-04-23T18:21:45.547
> 
> 标签：javascript, google-closure-compiler, playframework-2.0

在我的 Play 2.0 项目中，我将`processing-1.3.6.js`文件（处理语言的 javascript 版本）放入`app/assets/scripts`文件夹中，然后什么也不做。现在，当我尝试访问该网站时，Play 尝试重新编译所有新内容并偶然发现了该脚本。浏览器中的错误页面是这样说的：

```
Compilation error
Internal Closure Compiler error (see logs)

In D:\programming\play-2.0\play-2.0\starlight\app\assets\scripts\processing-1.3.6.js at line 0.

0/*** 
1
2    P R O C E S S I N G . J S - 1.3.6
3    a port of the Processing visualization language
4 
```

该`0`行是错误的原因。这真的很奇怪，因为它是一个评论。该怎么办？也许我错误地将资产包含在我的项目中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T09:29:17.810

Play 的闭包编译器集成在 Windows 上已损坏，请参阅[https://groups.google.com/forum/#!msg/play-framework/oCBbaeo4_4Y/UToOYcthnZQJ](https://groups.google.com/forum/#!msg/play-framework/oCBbaeo4_4Y/UToOYcthnZQJ) ...

# python - 通过 Python 只能部分访问 COM 类型库

> ID：10286071
> 
> 赞同：2
> 
> 时间：2012-04-23T18:21:49.257
> 
> 标签：python, com

我正在尝试编写一些脚本来使用应用程序附带的 COM 类型库来从外部控制它。

但是，我一直在使用用于 COM 的 Python 库（pythoncom 和 win32com）：

使用 COM 浏览器，我可以导航以找到我有兴趣使用的类型库的 GUID。

使用 pythoncom，我可以轻松地浏览此类型库以查看可用的对象。

```
>>> import win32com.client
>>> import pythoncom
>>> type_lib_iid = '{12345678-ABCD-EFGH-1234-12341234}'
>>> lib = pythoncom.LoadTypeLib(type_lib_iid, 1, 0)
>>> for index in range(0, lib.GetTypeInfoCount()):
        print lib.GetDocumentation(index)[0]
        print lib.GetTypeInfo(index).GetTypeAttr().iid 
```

这将返回所有可用 COM 对象的 GUID（对不起，如果我正在扼杀这个词汇表）。

奇怪的是，当我浏览类型库时，此调用返回的所有对象都出现在 COM 浏览器中，而在可用的 81 个对象中，只有 4 个可以调用 Dispatch。其余返回：

```
'Class not registered.' 
```

我的问题分为两部分：

1）如何通过 COM 浏览器和上述调用找到对象，而不能使用 win32com.client.Dispatch 调用对象？[注意：有问题的应用程序正在运行。]

2）我是否使用了错误的功能？派送不正确吗？我坦率地承认，我发现 Python COM 模块的文档令人困惑，但我没有找到任何未调度现有 COM 对象的示例，所以我不知道从哪里开始。此外，可以分派的 4 个对象似乎完全按照文档中的说明工作。

[最后一点：如果我尝试 pythoncom.CoCreateInstance(TypeLibCLSID, None, 1, GUIDofInterfaceObject) 我得到“不支持接口。”我需要使用的关键接口是我在这里尝试的 GUID。]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:17:37.307

只有 CoClass 接口可以直接使用 Dispatch 创建。其他接口通常是通过深入了解顶级对象的属性和方法来创建的。如果你在你的 typelib 上运行 makepy，生成的包装文件将用注释标记 CoClass。

# javascript - 从href链接过滤哈希并选择它的问题

> ID：10286076
> 
> 赞同：1
> 
> 时间：2012-04-23T18:22:06.280
> 
> 标签：javascript, jquery, html

**示例：http:** [//jsfiddle.net/dfcyb/](http://jsfiddle.net/dfcyb/)

我有这两个变量

```
var inview = '#' + $("#container > .section > h1:in-viewport:first").parent().attr('id');
var $link = $('#menu a').filter('a[hash=' + inview + ']'); 
```

**inview**检查特定部分是否在视口中，然后使用**$link** var 添加一个类。我不确定我在这里做错了什么。Inview 工作正常，但是：

```
$link.parent().addClass('selected'); 
```

什么也没做。我不确定我在这里有什么问题或如何进行调试，因为 console.log($link) 没有帮助。我不确定这里是否正在使用过滤器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:27:39.563

`a[hash=`应该`a[href$=`

手段以哪里`$=`结束。

代替：

```
... $('#menu a').filter('a[hash=' + inview + ']'); 
```

和：

```
... $('#menu a[href$="' + inview + '"]'); 
```

来源：[http ://api.jquery.com/attribute-ends-with-selector/](http://api.jquery.com/attribute-ends-with-selector/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:34:00.337

您的 jsFiddle 存在许多问题。

首先没有`:in-viewport`选择器。你需要使用一个插件（比如[这个](http://www.appelsiini.net/projects/viewport)）来做到这一点。

第二，`$("#container > .section > h1")`。在您的示例中，没有`<h1>`标签。

第三，`<a>`标签没有`hash`属性，应该是`a[href='']`.

第四，`$link`是`<a>`标签，但在你的 CSS 中，`selected`类应该在`<li>`.

这是一个更新的示例：http: [//jsfiddle.net/dfcyb/1/](http://jsfiddle.net/dfcyb/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T18:40:37.570

我想你想要：

```
$("#container > .section > h1.in-viewport:first") 
```

代替：

```
$("#container > .section > h1:in-viewport:first") 
```

这就是#undefined 的来源，并且您在jsfiddle 上的示例代码中没有任何H1 标签。

# erlang - 哪个集群 NoSQL DB 用于消息存储？

> ID：10286080
> 
> 赞同：7
> 
> 时间：2012-04-23T18:22:28.883
> 
> 标签：erlang, nosql, cassandra, hbase, riak

还有一个关于选择哪种 NoSQL 的问题。但是，我还没有找到有人要求这种类型的目的，消息存储......

我有一个 Erlang 聊天服务器，我已经在使用 MySQL 来存储朋友列表和“需要加入”信息。

我想存储消息（该用户没有收到，因为他离线......）并检索它们。

我已经预先选择了 NoSQL，由于它是面向 RAM 的范例，我不能使用像 MongoDB 这样的东西，并且无法像其他人一样进行集群。我想我的清单有 3 个选择：

*   Hbase
*   里亚克
*   卡桑德拉

我知道他们的模型完全不同，一个使用键/值，另一个使用 SuperColumns 和 co。

直到现在我还是偏爱 Riak，因为它是 Erlang 的稳定客户端库。

我知道我可以将 Cassandra 与 Thrift 一起使用，但 Erlang 似乎不太稳定（我没有得到很好的回报）

我现在对 HBase 一无所知，只知道它存在并且基于像 Cassandra 和 Riak 这样的 Dynamo。

所以这就是我需要做的：

*   每个注册用户存储 1 到 X 条消息。
*   获取每个用户存储的消息数。
*   一次检索来自用户的所有消息。
*   一次删除用户的所有消息。
*   删除所有超过 X 个月的邮件

现在，我对那些 NoSQL DB 真的很陌生，我一直是 MySQL 爱好者，这就是为什么我问你这个问题，作为一个新手，有没有比我有更多经验的人可以帮助我选择哪个更好，并且会让我做我想做的一切而没有太多麻烦......

谢谢 ！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-21T19:43:13.607

我不能代表 Cassandra 或 Hbase，但让我谈谈 Riak 部分。

是的，Riak 适合您的场景（我已经看到几家公司和社交网络将它用于类似目的）。

要实现这一点，您需要简单的 Riak Key/Value 操作，以及某种索引引擎。您的选择是（按偏好的粗略顺序）：

1.  **CRDT 集**。如果您的 1-N 集合大小合理（假设每个用户的消息少于 50 条或其他），您可以将子集合的键存储在[CRDT Set Data Type](http://docs.basho.com/riak/latest/dev/using/data-types/)中。

2.  **里亚克搜索**。如果您的集合很大，特别是如果您需要在任意字段上搜索您的对象，您可以使用[Riak Search](http://docs.basho.com/riak/latest/dev/using/search/)。它在后台启动 Apache Solr，并根据您定义的模式索引您的对象。它具有非常棒的搜索、聚合和统计、地理空间功能等。

3.  **二级索引**。[您可以在eLevelDB 存储后端](http://docs.basho.com/riak/latest/ops/advanced/backends/leveldb/ "LevelDB 存储后端")之上运行 Riak ，并启用[二级索引](http://docs.basho.com/riak/latest/tutorials/querying/Secondary-Indexes/ "二级索引")(2i) 功能。

运行一些性能测试，以选择最快的方法。

至于架构，我建议使用两个存储桶（对于您描述的设置）：一个用户存储桶和一个消息存储桶。

索引消息桶。（通过将搜索索引与其关联，或通过 2i 存储 user_key）。这使您可以执行所有必需的操作（并且消息日志不必放入内存中）：

*   **每个注册用户存储 1 到 X 条消息**- 一旦你创建了一个用户对象并获得一个用户密钥，每个用户存储任意数量的消息很容易，它们将直接写入消息存储桶，每条消息都存储适当的 user_key作为二级索引。
*   **获取每个用户存储的消息数量**- 没问题。获取属于用户的消息键列表（通过搜索查询，通过检索您保存键的 Set 对象，或通过对 user_key 的 2i 查询）。这使您可以在客户端获得计数。
*   **一次检索来自用户的所有消息**- 请参阅上一项。获取属于用户的所有消息的键列表（通过 Search、Sets 或 2i），然后通过多次获取每个键的值来获取这些键的实际消息（所有官方 Riak 客户端都有`multiFetch`能力，客户端-边）。
*   **一次删除用户的所有消息**- 非常相似。获取用户的消息键列表，在客户端向它们发出删除。
*   **删除所有早于 X 个月的消息**- 您可以在日期上添加索引。然后，检索所有早于 X 个月的消息密钥（通过搜索或 2i），并为它们发出客户端删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:38:02.193

我根本无法与 Riak 交谈，但我会质疑你放弃 Mongo 的选择。只要您关闭日记功能并且不要完全饿死它以获取 RAM，那就很好了。

我对 HBase 了解很多，听起来它可以轻松满足您的需求。根据您拥有的用户数量，可能会过度杀伤力。它微不足道地支持诸如为每个用户存储许多消息之类的事情，并具有写入自动到期的功能。根据您构建架构的方式，它可能是原子的，也可能不是原子的，但这对您的用例来说并不重要。

缺点是正确设置它有很多开销。在建立 HBase 之前，您需要了解 Hadoop、让 HDFS 运行、确保您的名称节点是可靠的等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T12:08:22.983

我建议使用 Riak 或 Couchbase 之类的分布式键/值存储，并将每个用户的整个消息日志序列化（转换为二进制 erlang 术语或 JSON/BSON）作为一个值。

因此，对于您的用例，它将如下所示：

*   *每个注册用户存储 1 到 X 条消息*- 当用户上线时，生成一个有状态的**gen_server**，它从存储中获取并在启动时反序列化整个消息日志，接收新消息，将它们附加到它的日志副本，在会话结束时终止，序列化更改的日志并将其发送到存储。
*   *获取每个用户存储的消息数量*——注销、反序列化、计数；或者可能将计数存储在单独的 k/v 对中。
*   *一次检索来自用户的所有消息*- 只需将其从存储中提取。
*   *一次删除用户的所有消息*- 只需从存储中删除值。
*   *删除所有超过 X 个月的邮件*- 获取、过滤、放回。

明显的限制 - 消息日志必须适合内存。

如果您决定单独存储每条消息，如果您希望它们按时间顺序排列，则需要在分布式数据库中对它们进行排序，因此处理大于内存的数据集几乎没有帮助。如果需要的话-无论如何，您最终都会遇到一些更棘手的方案。

# python - Python / C-Api：向模块添加类

> ID：10286083
> 
> 赞同：2
> 
> 时间：2012-04-23T18:22:35.107
> 
> 标签：python, class, python-module, python-c-api, python-embedding

我目前正在尝试将 python 解释器嵌入到我的应用程序中。因为我的应用程序使用 Poco API 进行日志记录，所以我也希望通过 python 中的日志模块访问它。对我来说，最简单的方法是提供一组静态函数作为扩展模块来记录消息，然后编写一个调用这些函数的 Handler 子类。

因为我不希望用户安装任何额外的 python 模块，并且我不需要在嵌入式 python 解释器之外重用我的代码，所以如果可以通过提供静态函数`Py_InitModule()`然后添加一个硬编码的处理程序，那就太好了创建模块的子类（硬编码意味着：在运行时添加，但实际上是一个始终在初始化时解释的 const 字符串）。

我的问题是我不知道如何解释普通的 python 类定义，例如：

```
class Test:
    someVar=1 
```

以便将其添加到给定的模块中，然后可以访问，例如`mymodule.Test`

解决方案可以是纯 python 的，也可以使用 python c-api。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T13:14:52.820

我自己终于找到了答案：实际上有2种方法可以在模块的上下文中执行代码

**方式一**

```
PyObject* module = Py_InitModule("poco",LoggingPocoMethods);
PyObject* code = Py_CompileString("class Test:\n\tdef __repr__(self):\n\t\treturn 'Hello world'","",Py_file_input);
PyImport_ExecCodeModule("poco",code); 
```

这种方法的缺点是模块将被重新加载，这在这个阶段是不需要的。

**方式二**

```
PyObject* module = Py_InitModule("poco",LoggingPocoMethods);
PyObject* mainModule = PyImport_AddModule("__main__");

PyObject* dict = PyModule_GetDict(module);
PyObject* mainDict = PyModule_GetDict(mainModule);

PyRun_String("def test():\n\tprint 'test'\n",Py_file_input,mainDict,dict); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T02:35:47.637

要将某些东西放入模块中，只需分配它。假设类 Test 定义如上，将其附加到该名称下的模块 mymodule ，只需编写

```
mymodule.Test = Test 
```

就是这样。

# php - 正确过滤掉 LFI

> ID：10286085
> 
> 赞同：0
> 
> 时间：2012-04-23T18:22:46.130
> 
> 标签：php

如何正确过滤掉 PHP 中的本地文件包含？我一直在寻找，但找不到一个简单的功能来做到这一点。据我了解，删除斜线是不够的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T18:31:45.733

永远不要在用户输入上使用`include()`（或其亲属，like `require()`or ）。`readfile()`曾经。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:41:12.360

避免这种情况的最简单方法是不要编写`include()`来自用户输入的代码——通常不需要这样做。而不是让您的 URL`foo.php?page=bar`仅用`bar.php`作 URL。

如果您绝对必须，您可以通过几种方式进行过滤。白名单很简单：

```
$ok = array('foo.php', 'bar.php', 'baz.php');
$include = in_array($_GET['page'], $ok) ? $_GET['page'] : 'default.php';
include($include); 
```

这仅允许包含文件的预设列表。

或者，您可以使用正则表达式进行过滤（但这更容易出错）：

```
if (preg_match('!^[a-z]+\.php$!', $_GET['page'])){
    include($_GET['page']);
}else{
    include('default.php');
} 
```

# .net - SendKeys.SendWait 在 Windows 7 中不发送“{ENTER}”

> ID：10286086
> 
> 赞同：5
> 
> 时间：2012-04-23T18:22:49.757
> 
> 标签：.net, visual-studio-2008, sendkeys

我已经在带有 XP 和 Windows 7 的 Visual Studio 2008 中尝试过这个：

`SendKeys.SendWait("sometext{ENTER}{ENTER}")`

这用于在打开文件对话框中打开文件。它适用于带有 VS2008 的 XP，但是当我在 Windows 7 上尝试时，似乎 {ENTER} 键没有通过。

这是否存在已知问题，或者我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T18:30:45.477

这应该可行，您也可以尝试使用 \n ：

```
System.Windows.Forms.SendKeys.SendWait("Hello World{ENTER}Testing\n"); 
```

这确实适用于我的 Windows 7 机器。您遇到的问题很可能是您尝试将密钥发送到的应用程序在不同的特权帐户下运行（例如：作为管理员）。这将阻止用户级应用程序发送密钥，除非您也以管理员身份运行应用程序。尝试以管理员身份运行 Visual Studio 并再次测试您的代码。

```
Right click Visual Studio -> Run As Administrator 
```

# c++ - 我如何告诉当前或即将在 poll() 中阻塞的线程做某事？

> ID：10286096
> 
> 赞同：2
> 
> 时间：2012-04-23T18:23:26.070
> 
> 标签：c++, linux, pthreads, pipe

`poll()`我有一个循环调用的线程 A。该线程负责传入和传出连接的 IO。但是，当线程 B 打开一个传出连接时，它必须以某种方式将其交给 A。您认为在打开套接字后 B 写入的线程 A（读取端）和 B（写入端）之间有一个管道是个好主意吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T18:32:04.987

这听起来很合理。`poll`应该很高兴看到您的插座旁边的管道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T21:29:27.413

[您可以考虑使用套接字对](http://www.kernel.org/doc/man-pages/online/pages/man2/socketpair.2.html)，而不是实际的管道。您可以创建一个[unix-domain](http://www.kernel.org/doc/man-pages/online/pages/man7/unix.7.html)套接字对并使用`send()`or将消息发送到被阻止的线程`sendmsg()`。这种方法可能对您更方便。Unix 域套接字还支持在进程之间传递文件描述符，尽管这对您的应用程序来说太过分了。

另一种方法是`poll()`用信号中断调用。看到[这个问题](https://stackoverflow.com/questions/5282265/pthreads-signal-a-specific-thread)。

# asp.net - 对 Telerik Rad 网格控制使用分页

> ID：10286097
> 
> 赞同：0
> 
> 时间：2012-04-23T18:23:37.590
> 
> 标签：asp.net, telerik, telerik-grid, radgrid, rad-controls

我在我的网站上使用 RadGrid 控件，并为 radgrid 启用分页，并在 sql profiler 上监视它的活动，我知道 radgrid 为每个分页获取数据，然后显示当前页面的数据。

```
 DataSet obj_Dataset = new DataSet(); //  is global 
```

这是我写的代码`Page_Load`：

```
protected void Page_Load(object sender, EventArgs e)
    {
        SqlConnection obj_SqlConnection = new SqlConnection(ConfigurationManager.ConnectionStrings["NorthwindConection"].ToString());
        SqlCommand obj_sqlCommand = new SqlCommand();
        obj_sqlCommand.CommandText = "select ProductID,ProductName,CategoryID from products";
        obj_sqlCommand.CommandType = CommandType.Text;
        obj_sqlCommand.Connection = obj_SqlConnection;

        SqlDataAdapter obj_DataAdapter = new SqlDataAdapter(obj_sqlCommand);
        obj_SqlConnection.Open();
        obj_DataAdapter.Fill(obj_Dataset, "Products");
        obj_DataAdapter.Dispose();
        obj_sqlCommand.Dispose();
        obj_SqlConnection.Close();
    } 
```

这是我的代码`RadGrid1_NeedDataSource`：

```
 protected void RadGrid1_NeedDataSource(object sender, Telerik.Web.UI.GridNeedDataSourceEventArgs e)
    {

        RadGrid1.DataSource = obj_Dataset.Tables["Products"];

    } 
```

我正在使用 ASP.net 2010 和 Sqlserver 2008。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:56:13.527

当您在 RadGrid 上实现分页时，每次更改页面时，它将只检索*当前页面*所需的记录。这实际上是分页的好处之一。如果您希望它仅在第一次加载页面时获取数据，则必须在此后的每次回发中保留*整个数据集。*

我理解您希望最小化数据库连接的愿望，但如果您有足够的记录需要分页，您最好允许分页按设计工作，而不是尝试将整个数据集保存在服务器或 ViewState 中。可能还值得考虑您为什么要避免使用数据库。是不是太慢了？您可能想要优化数据库索引、评估结构或研究缓存。

但是，如果这是您真正想做的事情，并且您了解风险，则可以考虑使用 Cache 对象，如此[处](http://www.codeproject.com/Articles/8631/ASP-NET-s-Data-Storage-Objects)所述。

例如：

```
protected void RadGrid1_NeedDataSource(object sender, Telerik.Web.UI.GridNeedDataSourceEventArgs e)
{
    var products = Cache["products"] as DataTable;
    if(products == null)
    {
       products = obj_Dataset.Tables["Products"];
       Cache.Insert("products", products , null, DateTime.Now.AddHours(6), TimeSpan.Zero);
    }

    RadGrid1.DataSource = products;
} 
```

关于这种方法，您需要了解一些事情。首先，`Cache`对于应用程序来说是全局的，所以存储的数据`Cache`对于每个用户来说必须是相同的。其次，`Cache`不会自动更新自己，所以如果你更新你的数据，你必须明确地更新你`Cache`的代码。如果您有经常更改的数据，`Cache`则不是一个好地方。第三，`Cache`占用内存空间，所以如果你在其中存储大量数据集，你的应用程序就会受到影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:30:30.173

我使用这个存储过程来解决问题：参数由 radgrid 属性填充：

```
 Create PROCEDURE  [dbo].[CastumPaging]
                    (
                       @SqlTableName nvarchar(100),
                       @OrderColumn nvarchar (30),
                       @Direction nvarchar(5),
                       @PageIndex int,
                       @PageSize int
                    )
                    AS
                    BEGIN
                    declare @SQLText nvarchar(500)

                     set @SQLText = 'SELECT * FROM (SELECT top 100 PERCENT * , ROW_NUMBER() 
                          OVER(ORDER BY '+@OrderColumn+' '+ @Direction + ' ) as RowNum 
                          FROM '+@SqlTableName+'  order by '+@OrderColumn+' '+@Direction +' )
                          as DerivedTableName WHERE RowNum BETWEEN '+
                          str(@PageIndex * @PageSize) +' AND'+ 
                          str((@PageIndex* @PageSize) +@PageSize -1) 

                    exec(@SQLText)
                    END 
```

# c++ - 无法使用 cimg 库将图像正确保存到文件

> ID：10286111
> 
> 赞同：8
> 
> 时间：2012-04-23T18:24:34.267
> 
> 标签：c++, cimg

这是我的全部代码：

```
#include "CImg.h"
#include <iostream>

using namespace cimg_library;
int main() {

CImg<float> image(100,100,1,3,0);
const float color[] = {1.0,1.0,0.0};
image.draw_point(50,50,color);
image.save("file.bmp");
CImgDisplay local(image, "Hah");
while (true) {
    local.wait();
    }   

} 
```

这成功地显示了我在窗口中的期望，即一个完全黑色的正方形，在 50,50 处有一个白色像素。但是，file.bmp 只是一个黑色正方形，没有该像素（并且保存一个已通过重复调用 draw_point 在一个更大的程序中进行修改的 cimg 图像也失败了）。这里发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:43:20.513

问题是您创建`CImgDisplay`时启用了规范化。因此，您的像素`{1,1,0}`被归一化`{255,255,0}`并在您的屏幕上可见。

`CImg.save`不执行归一化，因此像素作为非常暗的像素保存到磁盘。

您可以通过更改白色像素颜色来解决问题：

```
const float color[] = {255.,255.,255.}; 
```

并且，可选地，通过禁用规范化：

```
CImgDisplay local(image, "Hah", 0); 
```

或者，您可以在保存或显示原始图像之前对其进行标准化：

```
image.draw_point(50,50,color);
image.normalize(0, 255);
image.save("file.bmp"); 
```

参考：

*   [`CImgDisplay::CImgDisplay`](http://cimg.sourceforge.net/reference/structcimg__library_1_1CImgDisplay.html#a17a3e5d3c1452bea980a3fc27b94a62c)
*   [`CImgDisplay::normalization`](http://cimg.sourceforge.net/reference/structcimg__library_1_1CImgDisplay.html#a67719cb05110ca9e5725bc59f8350b68)
*   [`CImg::normalize`](http://cimg.sourceforge.net/reference/structcimg__library_1_1CImg.html#ab7943be99d0d4cfc6550d70039ecbf24)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:42:38.827

我不熟悉这个库，但这种行为暗示`CImgDisplay`在渲染时对图像的解释不同。

我希望将白色定义为`const unsigned char color[] = {255,255,255};`表示位图的 RGB 值。

我会检查文档`CImg`作为第一步。

# java - 在可运行的 jar 中读取不在主包中的文本文件

> ID：10286116
> 
> 赞同：2
> 
> 时间：2012-04-23T18:24:51.880
> 
> 标签：java, eclipse, swing, jar, runnable

我有一个 Swing Java 程序，它读取名为“res”的资源文件夹中的 *.txt 文件，其中包含不同类型 JSON 的子文件夹。当我直接从 Eclipse 运行时，一切都很好。如果我创建一个可执行的 jar 它不起作用。我设法使它与一个可怕的解决方案一起工作，将我所有的文本文件放在它们被调用的包中。

要阅读它们，我使用这行代码：

```
InputStream is = this.getClass().getResourceAsStream(file + ".txt"); 
```

其中文件是一个字符串。我认为这会在 jar 中搜索指定的文件，但显然不是。我试图放置文件的路径 res/subfolder/name_of_file.txt 和 subfolder/name_of_file.txt 但无济于事。这是我的项目的结构

```
Project
   src
      com.package
   res
      JSON_type1
      JSON_type2
         file.txt 
```

在 com.package 中，我有一个必须从 JSON_type2/file.txt 读取的类。除了将我的文本文件组织在子文件夹中的明显原因之外，我的 GUI 将使用这些子文件夹的内容填充一个下拉列表。

从我从这里的其他问题中收集到的信息来看，如果我想将我的文本文件保存在调用它们的包中，那么 getResourceAsStream() 将是我的解决方案。除此之外，我发现了一些关于子类化[ClassLoader](http://docs.oracle.com/javase/6/docs/api/java/lang/ClassLoader.html#getResourceAsStream%28java.lang.String%29)和覆盖[findResource()](http://docs.oracle.com/javase/6/docs/api/java/lang/ClassLoader.html#findResource%28java.lang.String%29)的信息。如果可能的话，我想避免这种解决方案，因为我远不熟悉该类及其功能。

如果您需要更多信息，请告诉我。

谢谢

PS：这个问题来自我之前的问题[here](https://stackoverflow.com/questions/10231544/runnable-jar-not-working-with-referenced-libraries)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T18:29:11.777

您可以通过用斜杠分隔包中的文件来寻址，例如对于 file.txt，您应该`getResourceAsStream("/res/JSON_type2/file.txt")`

斜杠不用于文件夹结构，也不依赖于平台，它们只是类加载器寻址文件的方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-23T18:29:24.853

```
// added leading / to indicate search from root of class-path
String file = "/res/JSON_type2/file.txt";
InputStream is = this.getClass().getResourceAsStream(file); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T09:03:37.203

通过这样做，我基本上能够获得您在 Eclipse 中寻找的功能：

```
src (folder)
   main (package)
      ...Classes...
other (folder)
   res  (package)
      ...txt files... 
```

Eclipse 似乎完全忽略了文件夹，只关心包。只要我将文本文件放在**一个**包中，我就可以使用 getResourceAsStream("/res/somefile.txt") 获取 InputStream。

# php - PHP Simple HTML DOM Parser 从第 2 项而不是第 1 项开始

> ID：10286118
> 
> 赞同：0
> 
> 时间：2012-04-23T18:24:56.587
> 
> 标签：php, dom, find, html-parsing, steam-web-api

我正在使用简单的 HTML DOM 解析器来接收我需要的某些信息，但解析器似乎输出了第一个。它找到的项目。我正在使用这段代码：

`$html = file_get_html("http://steamcommunity.com/id/" . $username . "/wishlist/");
foreach($html->find('.wishlistRow') as $e)
{
$item = $e->outertext;
}
echo $item;` 

这会输出愿望清单上的第二个项目，但不是第一个。这也适用于我正在从事的其他项目，如果能得到任何帮助，我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:29:30.197

`echo`不在`foreach`，所以只会输出最后一项。把它移到里面`foreach`。

# c++ - 如何实现弗洛伊德算法在具有矩形障碍物的 11x11 网格上找到最短路径？

> ID：10286121
> 
> 赞同：1
> 
> 时间：2012-04-23T18:25:02.780
> 
> 标签：c++, algorithm, floyd-warshall

几天来，我一直试图弄清楚如何实现弗洛伊德算法，以找到网格结构中的最短路径，如下所述。谁能指出我将如何实现这样的事情的正确方向？谢谢。

输入：

*   开始/结束坐标
*   用户输入必须介于 0 到 10（含）之间
*   障碍物数量
*   左上角和右下角的障碍物坐标

输出：

*   显示通过的所有坐标的路径
*   距离作为整数

限制：

*   障碍物不能重叠
*   不能在矩形障碍物内设置开始和结束
*   路径可以包括沿着矩形的边缘行进，但从不穿过它们
*   路径只能水平和垂直，而不是对角线
*   两个相邻顶点之间的距离为1

我需要帮助生成 121x121 数组的条件。

这就是我到目前为止所拥有的。

```
for(i=1;i<=n;i++) { 
   for(j=1;j<=n;j++) { 
         if( edge exists from i to j ) W[i][j] = 1; 
               // distance=1 if nodes are adjacent 
         else if ( edge does not exist from i to j ) W[i][j] = inf; 
              // distance=inf. if nodes do not meet 
         else if ( i = j ) W[i][j] = 0; // distance=0 if i=j 
   } 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T00:18:32.093

[http://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm](http://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm) 只需使用这个伪代码来实现算法（它不应该与实际的 C++ 代码有太大区别（这是一个相当简单的算法）。 Wiki 链接还提供了一种最短路径重建算法。您是否考虑实施简单的呼吸优先搜索，因为您正在处理网格。哈哈，这是我在这个论坛上的第一篇文章 :)

# microcontroller - 是否可以使用 AVR 编程器对 MSP430 MCU 进行编程？

> ID：10286123
> 
> 赞同：1
> 
> 时间：2012-04-23T18:25:04.327
> 
> 标签：microcontroller, msp430, jtag, code-composer

是否可以使用 AVR 编程器设备（支持 JTAG 并通过 USB 连接到 PC）使用其 JTAG 接口对 MSP430 MCU 进行编程？
如果没有，为什么没有？！？& 如果是，如何将它与 Code Composer Studio 5 集成？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T21:14:02.363

大概...

JTAG 是一个标准，但每个芯片的使用方式（用于处理器调试/加载）是不同的。因此，如果您拥有的程序员足够通用，那么您可以放置​​一个适配器或断开信号以与 msp430 配对。许多爱好级别的 jtag 适配器本质上是 USB 到并行端口，例如 openocd，如果你只是简单地挖掘并行接口，那么很容易重新调整/重新分配信号。

我认为这是两件事之一，一是你想省钱，二是你对这个级别的事情如何运作感兴趣。对于两个人来说，只需谷歌 msp430 jtag 并找到像 slau265j 这样的文件，它会引导你到 slau320d，它包含你需要的信息的真正内容。

如果您想省钱，不要，只需花 4.30 美元购买 msp430 启动板（我认为没有运费）。如果您需要它来对您的部件进行编程，请拔下跳线并使用两个信号以及接地和电源。如果它是在启动板中的一个倾角（如果它适合/配合），您可以放置​​您的部件并以这种方式对其进行编程或断开跳线并使用跳线引脚上的信号或订购 mill-max 850-10-006-20 -001000 连接器并将它们焊接上（使其像 ez430 一样工作）。（或以 20 美元购买 ez430 套件）我使用带有 mill max 连接器的启动板前端，使用 mspdebug 以 10 美元 ez430 板对 3 块板进行编程。

将这一切都集成到 Code Composer Studio 5 中？我不知道如何帮助你。

# apache - 主域和子域混杂

> ID：10286128
> 
> 赞同：1
> 
> 时间：2012-04-23T18:25:21.833
> 
> 标签：apache, subdomain, lamp, linode

我的主域名为 www.mysite.com 的网站以前运行良好。（我使用 mysite 在这里隐藏我的实际域名）。它是 linode 中的 LAMP 服务器，使用指南[http://library.linode.com/lamp-guides/ubuntu-10.04-lucid](http://library.linode.com/lamp-guides/ubuntu-10.04-lucid)进行设置。我想为我的主机上的另一个虚拟主机添加 sub.mysite.com。我关注[http://davidpodley.com/2010/02/11/setting-up-subdomains-in-linode-and-apache/](http://davidpodley.com/2010/02/11/setting-up-subdomains-in-linode-and-apache/)之后

```
a2ensite sub.mysite.com
/etc/init.d/apache2 restart 
```

www.mysite.com 的一些用户将访问 sub.mysite.com 而不是 www.mysite.com。我可以在 /srv/www/sub.mysite.com/logs/access.log 中找到它们，它们会告诉我问题所在。他们应该只访问 www.mysite.com。但是，它在我的电脑上运行良好。

## 为什么 www.mysite.com 的用户会转到 sub.mysite.com？谁能帮我？

一些信息：

我在 24 小时前在 A 记录中添加了 sub： **我的 A 记录是：**

```
Hostname IP Address TTL Options
         96.126.98.96    Default    Edit | Remove
sub      96.126.98.96    Default    Edit | Remove
mail     96.126.98.96    Default    Edit | Remove
www      96.126.98.96    Default    Edit | Remove 
```

**我的服务器的主机名是 mysite，我的服务器的 /etc/hosts 是**

```
127.0.0.1 localhost.localdomain localhost
96.126.98.96 mysite.mysite.com mysite 
```

**apache2ctl -S：**

```
VirtualHost configuration:
wildcard NameVirtualHosts and _default_ servers:
*:443                  is a NameVirtualHost
         default server mysite.com (/etc/apache2/sites-enabled/mysite.com:10)
         port 443 namevhost mysite.com (/etc/apache2/sites-enabled/mysite.com:10)
*:80                   is a NameVirtualHost
         default server sub.mysite.com (/etc/apache2/sites-enabled/sub.mysite.com:1)
         port 80 namevhost sub.mysite.com (/etc/apache2/sites-enabled/sub.mysite.com:1)
         port 80 namevhost mysite.com (/etc/apache2/sites-enabled/mysite.com:1) 
```

/etc/apache2/sites-enabled/mysite.com：

```
<VirtualHost *:80>
     ServerAdmin mysite@gmail.com
     ServerName mysite.com
     ServerAlias www.mysite.com
     DocumentRoot /srv/www/mysite.com/public_html/
     ErrorLog /srv/www/mysite.com/logs/error.log
     CustomLog /srv/www/mysite.com/logs/access.log combined
</VirtualHost>

<VirtualHost *:443>
     SSLEngine On
     SSLCertificateFile /etc/apache2/ssl/apache.pem
     SSLCertificateKeyFile /etc/apache2/ssl/apache.key

     ServerAdmin mysite@gmail.com
     ServerName mysite.com
     ServerAlias www.mysite.com
     DocumentRoot /srv/www/mysite.com/public_html/
     ErrorLog /srv/www/mysite.com/logs/error.log
     CustomLog /srv/www/mysite.com/logs/access.log combined
</VirtualHost> 
```

/etc/apache2/sites-enabled/sub.mysite.com：

```
<VirtualHost *:80>
     ServerAdmin mysite@gmail.com
     ServerName sub.mysite.com
     ServerAlias www.sub.mysite.com
     DocumentRoot /srv/www/sub.mysite.com/public_html/
 #    DocumentRoot /srv/www/mysite.com/public_html/sub
     ErrorLog /srv/www/sub.mysite.com/logs/error.log
     CustomLog /srv/www/sub.mysite.com/logs/access.log combined
</VirtualHost> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T06:54:47.317

解决了。一些用户直接使用 IP 访问我的主域站点。在 apache2ctl -S 结果中，我们可以看到

```
default server sub.mysite.com 
```

根据apache的解释，配置文件中的第一个优先级最高，可以看作是默认或主服务器。在我的服务器 /etc/apache2/sites-enabled 中，将 mysite.com 重命名为 000mysite.com 将使其在 sub.mysite.com 之前加载（在我的站点中，“sub”是“f*”）

# ruby-on-rails - Ruby on Rails - 数组、搜索和返回

> ID：10286131
> 
> 赞同：0
> 
> 时间：2012-04-23T18:25:47.477
> 
> 标签：ruby-on-rails, arrays, where-clause, where, increment

我是 RoR 的初学者，正在使用 rails 3.2.3 和 ruby​​ 1.8.7

这个论坛帮助我进步，但我对一件事感到困惑。

我的应用程序应该允许根据选中的复选框搜索结果。就我而言，当用户检查确定的设施并单击“搜索”时，应返回仅具有这些设施的相应酒店。

我可以按名称/位置和评级搜索，但无法搜索设施。

简而言之，我的控制器看起来像：

```
def index
    @hotels= Hotel.search(params)
(...)
end 
```

我的看法是：

```
<b>Facilities:</b><br />
<% for facility in Facility.find(:all) %>
  <div class="field">
  <%= check_box_tag "fc[]", facility.id%>
  <%= facility.description %>
  </div>
  <% end %>
<%= submit_tag "Search", :name => nil%>
(...)
<% @hotels.each do |hotel|%>
    <h2> <%= link_to hotel.name, hotel  %> </h2> 
```

我的酒店和设施与一切正常运转有着密切的关系。facility_hotels 表是使用 facility_id 和 hotel_id 列创建的，设施表中的列有 facility_id 和描述（例如游泳池、24hroom 服务等）

问题出在我的模型中：

```
def self.search(params)

     if params
           arel = where('#searches for names/location/rating')

        if params[:fc].present?
          arel=arel.joins('INNER JOIN facilities_hotels ON hotels.id=facilities_hotels.hotel_id ')

          for i in params[:fc].size
            arel=arel.where('facilities_hotels.facility_id = ?', params([:fc][i])) 
                #how do I increment on the previous line? Obviously params([:fc][i]) does not work
          end
          arel
        else
           arel
        end

     else
       all
     end 
```

我不想用 to_sql 做这个......

此外，当我运行它时，如果我选中设施复选框，查询总是返回空结果，但这可能是我模型中那行代码的问题，但如果你预见到问题，我会很感激与此问题相关的未来代码冲突

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:53:18.987

这是您的问题，链接 where 将 where 条件与“ AND ”合并。检查你的 development.log 文件，或者 test.log 如果你正在做 TDD（你应该这样做）。这将生成 SQL ActiveRecord。（我敢打赌，当您只选中一个框时，它会起作用。）

首先，检查您的假设 params[:fc] 是选中框的数组。我会经常抛出异常并查看返回给浏览器的页面。

```
def self.search(params)
  raise params[:fc].inspect 
```

如果这是您认为的数组，那么您的 where 方法应该是：

```
where('facilities_hotels.facility_id in (:fc_list)', :fc_list => params[:fc]) 
```

作为编码提示，请考虑您是否认为以下代码更清晰。

```
def self.search(params)
  if params && params[:fc].present?
    joins('INNER JOIN facilities_hotels ON hotels.id=facilities_hotels.hotel_id ').
      where('facilities_hotels.facility_id in (:fc_list)', :fc_list => params[:fc])
  else
    Hotel
  end
end 
```

# c++ - 通过http二进制

> ID：10286132
> 
> 赞同：2
> 
> 时间：2012-04-23T18:25:53.840
> 
> 标签：c++, http, binary, http-post

我正在使用 C++ 发送带有二进制信息的后请求。代码如下所示：

```
int binary[4] = { 1, 2, 3, 4 };

std::stringstream out;
out << "POST /address HTTP/1.1\r\n";
out << "Host: localhost\r\n";
out << "Connection: Keep-Alive\r\n";
out << "Content-Type: application/octet-stream\r\n";
out << "Content-Transfer-Encoding: binary\r\n";
out << "Content-Length: " << 4*sizeof(int) << "\r\n\r\n";    // 4 elements of integer type 
```

并将数据发送到套接字中打开的连接中：

```
std::string headers = out.str();

socket.send(headers.c_str(), headers.size());  // Send headers first
socket.send(reinterpret_cast<char*>(&binary[0]), bufferLength*sizeof(int));  // And array of numbers 
```

但有人告诉我，通过 http-protocol 发送纯字节是错误的。是对的吗？例如，我不能发送 0 ( `zero`)，它是由协议使用的。

如果那是正确的（因为我无法处理该后请求并获取我发送的数据）我可以使用什么来代替？也许，将数组转换为十六进制或 base64url？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:30:27.467

通过 HTTP 发送二进制文件并没有错。

**图像**和**文件上传**时常发生这种情况

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T18:35:10.453

> 但有人告诉我，通过 http-protocol 发送纯字节是错误的。是对的吗？

*不，在 body*中很好，当然取决于 Content-Type 。“八位流”在这方面应该没问题，是的，它可以包含零字节。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T19:09:59.560

人们说它是错误的正在解决的问题是关于字节序的。你当然可以用http传输二进制数据，但是当另一端收到它们时，它必须能够正确解释它们。假设你的机器是一个小端机器；您的整数将在内存中存储为（32 位 int）

```
 01 00 00 00 
 02 00 00 00
 03 00 00 00
 04 00 00 00 
```

并且您按“原样”发送这 16 个字节。现在，假设接收机器天真地获取数据，不考虑发送者和发送方式，并假设该机器是大端机器；在这样的机器中，1、2、3、4 整数的内存布局将是

```
 00 00 00 01
 00 00 00 02
 00 00 00 03
 00 00 00 04 
```

这意味着对于接收机器，第一个整数是 0x01000000，而不是发送者想要的 0x00000001。

如果您决定必须始终将整数作为大端整数发送，那么如果发送方是小端机器，则需要在发送前正确“重新排列”整数。有像`hton*`（主机到网络）这样的功能，可以将主机 32/16 位整数“转换”为大端的“网络字节顺序”（反之亦然，`ntoh*`网络到主机）

请注意，数据不会被加扰，它们是按“原样”发送的，可以这么说。改变的是你将它们存储在内存中的方式，以及你在阅读时解释它们的方式。通常这不是问题，因为数据是根据一种格式发送的，如果需要，该格式指定非单字节数据的字节顺序（例如，参见[PNG 格式规范](http://www.w3.org/TR/REC-png.pdf)，第 2.1 节，整数字节顺序：PNG 使用净字节顺序，即大字节序）**

# core-data - 核心数据和 iOS 数据存储指南

> ID：10286138
> 
> 赞同：0
> 
> 时间：2012-04-23T18:26:30.410
> 
> 标签：core-data, ios5, icloud

我们有一个带有 Core Data 的应用程序，后备存储是一个 SQLite 数据库。

它包含关键数据（即它需要始终离线可用）。

它当前存储在 Documents 目录中，因此由于 iOS 数据存储指南而被拒绝。

解决方案似乎是使用“不备份”标签对其进行标记。

但是，我还没有看到任何关于这方面的指导方针。即我应该手动将此文件标记为“不备份”还是应该启用一些核心数据选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:52:54.127

你必须自己手动完成，这里是指南

[https://developer.apple.com/library/ios/ipad/#qa/qa1719/_index.html](https://developer.apple.com/library/ios/ipad/#qa/qa1719/_index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:58:40.267

在 iOS 5.1 或更高版本中，最好使用 new`NSURLIsExcludedFromBackupKey`或`kCFURLIsExcludedFromBackupKey`file 属性，而不是[`setxattr`(iOS 5.0.1 compatible)](https://developer.apple.com/library/ios/qa/qa1719/)。

```
- (BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)URL
{
    assert([[NSFileManager defaultManager] fileExistsAtPath: [URL path]]);

    NSError *error = nil;
    BOOL 成功 = [URL setResourceValue:[NSNumber numberWithBool:YES]
                                  forKey:NSURLIsExcludedFromBackupKey
                                   错误：&错误];
    如果（！成功）{
        NSLog(@"从备份 %@ 中排除 %@ 的错误", [URL lastPathComponent], error);
    }
    返回成功；
}

```

有关详细信息，请参阅[iOS 应用程序编程指南的“应用程序备份最佳实践”部分](https://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/PerformanceTuning/PerformanceTuning.html#//apple_ref/doc/uid/TP40007072-CH8-SW9)。

# asp.net - PreviousPage.Property 什么都不是

> ID：10286144
> 
> 赞同：0
> 
> 时间：2012-04-23T18:26:46.690
> 
> 标签：asp.net, vb.net

我有一个 Default.aspx 页面，其中有一些公共只读属性，这些属性从页面上的 HiddenFields 获取它们的值。该页面最终被重定向到 Users/Main.aspx。在 Main.aspx 上，我有一个 @PreviousPageType 引用，其中 VirtualPath 参数设置为“~/Default.aspx”。在 Main.aspx 的代码隐藏中，我有

```
lb_Username.Text = PreviousPage.Username 
```

当我在调试中运行时，系统抱怨 PreviousPage = Nothing

我做错了什么？如有必要，可以提供更多代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:05:52.960

汤姆，你是对的......我在代码中有另一个分支，它也使用了 Response.Redirect。一旦我将它们全部更改为使用 Server.Transfer PreviousPage。*对象*给了我价值。非常感谢

# dll - tbb_debug.dll 缺失 - MSER 示例 OpenCV 2.3.1

> ID：10286145
> 
> 赞同：0
> 
> 时间：2012-04-23T18:27:03.623
> 
> 标签：dll, opencv, tbb

我正在尝试使用在OpenCV 2.3.1的**示例目录中找到的 MSER 示例。**目前DLL丢失错误不断弹出。这是我第一次测试 MSER 代码并且怀疑是否存在对 TBB（线程构建块例程）的依赖。

我可以禁用这个依赖吗？有没有人遇到过这个问题？我今天下载了OpenCV2.3.1超级包。我被困在我正在测试的第一个样本上。

感谢您的指导。 ![在此处输入图像描述](../Images/76ac125eb073d4859de3a031c30e840d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:04:55.063

它是 OpenCV 2.3.1 Windows 包的已知“功能”。dll 确实丢失了，您需要在某个地方找到它。最近的 2.4.0 beta 有这个 dll。

# wpf - 如何获取默认主题词典

> ID：10286146
> 
> 赞同：1
> 
> 时间：2012-04-23T18:27:17.127
> 
> 标签：wpf, windows-runtime, windows-store-apps, winrt-xaml

Metro 应用程序使用一组默认主题资源字典。

有没有办法查看这些词典？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:41:40.133

您可以在 generic.xaml 和 themeresources.xaml 中获得默认资源，您可以在以下位置找到：

c:\Program Files (x86)\Windows Kits\8.0\Include\winrt\xaml\design

然后，当您创建一个新项目时 - 您会在 YourApplication\Common 中获得 StandardStyles.xaml。

[WinRT XAML Toolkit](http://bit.ly/WinRTXamlToolkit)还包括一个样式浏览器应用程序，允许浏览在运行的应用程序中可视化的许多标准样式。

# jquery - 隐藏/显示后，jQuery 无法从表单中读取值，转换问题？

> ID：10286151
> 
> 赞同：0
> 
> 时间：2012-04-23T18:27:45.743
> 
> 标签：jquery, forms, submit

所以，我调用将 document.Songwriting 放入一个变量 (currentForm) 中，如果我打印它，结果如下：

```
<form id="songwritingWorkshopForm" method="post" action="/form.php" name="Songwriting"> 
```

然后我做 currentForm.adress.value 从表单中获取地址值，这工作正常。

但是，由于某种原因，当我隐藏一些表格然后返回另一个表格时，document.Songwriting 变成了这样：

```
[form#songwritingWorkshopForm /formulier.php, form#songwritingWorkshopForm /form.php] 
```

这打破了我的 currentForm.adress.value ，我得到一个错误，它是未定义的。

任何人都知道为什么会发生这种转换？

我正在回收表单验证代码，以适用于不同的表单，具体取决于单击哪个提交按钮，以及我在哪个页面上，最后提交：currentForm.sumbit(); 效果很好，当我重新加载页面时，但是在切换表单/页面隐藏/显示元素之后，jQuery 似乎转换了我用来存储 document.Songwriting 的变量 currentForm。

我可以以某种方式保持 var 的第一个正确输出吗？或者我可以把它转换回来吗？

# java - 可能错误责任的静态分析

> ID：10286152
> 
> 赞同：0
> 
> 时间：2012-04-23T18:27:47.287
> 
> 标签：java, ant, build, static, checkstyle

我开始看到很多小的私有方法，它们接受一些对象并单独与之交互，这些方法实际上应该添加到错误的位置，实际上应该至少是该类中的静态方法。

我实际上正在寻找一些报告此类问题的静态分析工具，以便我可以将它们拉出到它所作用的适当类中。是否有 checkstyle 规则或其他静态分析工具可以帮助我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:36:33.257

尝试 findbugs [http://findbugs.sourceforge.net/](http://findbugs.sourceforge.net/)

# html - 对齐容器中的多个图像

> ID：10286153
> 
> 赞同：0
> 
> 时间：2012-04-23T18:27:49.440
> 
> 标签：html, css

我有未知数量的图像（最多三个），我以编程方式添加到 html 输出。我想将图像放在一个容器中，以便它们以容器本身不超过固定宽度的方式自动调整大小。我尝试了各种解决方案，例如此处提到的答案的修改版本（[Center image in container element with fixed size (CSS, HTML)](https://stackoverflow.com/questions/9912129/center-image-in-container-element-with-fixed-size-css-html)），但是如果图像宽度超过其固定宽度，我下面的解决方案会继续流过边界容器。

```
### HTML ###

<div id="container">
    <div class="image-container">
        <img src="#" alt="Image One" />
        <img src="#" alt="Image Two" />
        <img src="#" alt="Image Three" />
    </div>
</div>​

### CSS ###

#container {
    width: 400px;
    height: 100px;
    display: table;
    background-color: #ccc;         
}

#container .image-container {
    text-align: center;
    vertical-align: middle;
    display: table-cell;
}

#container .image-container img {
    max-width: 100px;
    max-height: 60px;        
} 
```

**编辑：** 我不是 javascript wizz，但以下内容对我有用。在示例中看到的固定图像宽度和高度是由将这个 HTML 输出放在一起的程序设置的。

```
 <script type="text/javascript">
      <!--
      function resize_image( img ) {
          var newSize = scaleSize(120,100,img.width,img.height);
          // alert(newSize);
          img.width=newSize[0]; img.height=newSize[1];
      }
      function scaleSize(maxW, maxH, currW, currH) {
          var ratioW=currW/maxW;
          var ratioH=currH/maxH;

          var ratio=1;
          if (ratioW>ratioH) ratio=ratioW; else ratio=ratioH;

          if (ratio>1) {
              currH=currH/ratio;
              currW=currW/ratio;
          }
          return [currW,currH];
      }
      -->
      </script> 
```

然后加载图像

```
<div class="s1">
  <img id="img0" src="1.png" class="img_class" onload="resize_image(document.getElementById('img0')); return true;"/>
  <img id="img1" src="2.png" class="img_class" onload="resize_image(document.getElementById('img1')); return true;"/>
</div>

<style type="text/css">
 .s1 { width:320px; height:100px; text-align: center; vertical-align: middle; }
 .img_class { display: inline-block;     vertical-align:middle; }
</style> 
```

# android - Android 通过字符串数组搜索并将结果放入 ListView

> ID：10286154
> 
> 赞同：0
> 
> 时间：2012-04-23T18:27:49.807
> 
> 标签：android, arrays, string, listview, search

我想搜索一个字符串数组并将结果放入 ListView。

所以，如果我有

```
<string-array name="Colors">
    <item>Red</item>
    <item>Yellow</item>
    <item>Blue</item>
    <item>DarkRed</item>
</string> 
```

我搜索“红色”，我应该进入 ListView 两个项目。对于每个项目，我想知道字符串数组中的 ID 和字符串值，它们将显示在 ListView 中。

在搜索结果时，我想显示一个 ProgressBar（不确定状态），当一切完成时它会消失。

第一步是将字符串数组放入 List 或 String[]，然后创建一个新线程来比较数组中的每个项目，并将匹配搜索文本的项目放在 ListView 上。

我不知道这是最好的方法。我的代码是这样的：

```
public class SearchActivity extends Activity {
    private ProgressBar mProgress;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.search);

        mProgress = (ProgressBar) findViewById(R.id.Progress);

        new Thread(new Runnable() {
            public void run() {
            int item_pos = 0;
            int item_count = 0;

            String[] Colors = getResources().getStringArray(R.array.Colors); 
                item_count = Colors.length();

                mProgress.setVisibility(View.VISIBLE);

                while (item_pos < item_count) {
                    // Compare with the search text
                    // Add it to the ListView (I don't know how)
                    item_pos +=1;
                }
                mProgress.setVisibility(View.GONE);
            }
        }).start();
    }
} 
```

所以，我的问题：

1.  如何获取项目 ID 和字符串，然后将每个文本值与搜索文本进行比较？
2.  如何将项目添加到 ListView？
3.  为什么 ProgressBar 不可见？ProgressBar XML 代码是这样的：

    ```
    <ProgressBar
        android:id="@+id/Progress"
        style="@android:style/Widget.ProgressBar.Small"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:indeterminate="true"
        android:visibility="visible" /> 
    ```

感谢您的所有建议和帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:22:18.607

这是我解决这个问题的方法。

首先，我会`string-array`这样：

```
 Resources res = getResources();
    String[] colors = res.getStringArray(R.array.Colors);
    // transform into ArrayList for ease of use
    ArrayList<String> colorsList = Arrays.asList(colors); 
```

在列表中搜索所需的序列并删除任何不需要的元素：

```
for (String s : colorsList) {  
   if (!s.contains("red")) { // hardcoded, only to illustrate my logic
      colorsList.remove(s);
   }
} 
```

现在您有了一个没有不需要元素的列表，只需将其绑定到您`ListView`的[`ArrayAdapter`](http://developer.android.com/reference/android/widget/ArrayAdapter.html). 该文档包含一篇关于[基本 ListView 用法](http://developer.android.com/resources/tutorials/views/hello-listview.html)的精彩文章。

如果你`Activity`只包含一个 ListView 作为它的唯一元素，你可以扩展你的 Activity[`ListActivity`](http://developer.android.com/reference/android/app/ListActivity.html)而不是`Activity`. 它将为您提供一些新的好处，例如简单地调用[`getListView()`](http://developer.android.com/reference/android/app/ListActivity.html#getListView%28%29)以轻松获取您的 ListView。

就您的 ProgressBar 而言，我建议您查看[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)该类，它将提供一种更优雅的方式来处理您的应用程序中的线程。Android 开发团队确实建议您使用 AsyncTask 而不是`Runnable`您现在使用的经典方法。

最后，如果你正在寻找更多关于 ListViews 的代码片段，你真的应该看看[这里](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/view/index.html)，它充满了来自 Android 团队的示例。当我开始使用 Android 并且无法理解 ListViews 时，这对我很有帮助。

希望这有帮助！

# java - Java读取没有行分隔符的文本行

> ID：10286157
> 
> 赞同：1
> 
> 时间：2012-04-23T18:28:01.623
> 
> 标签：java, file

为了处理搜索日志文件，我正在编写一个 Java 类，它应该逐行读取和处理文件内容。

日志文件中的文本如下所示

```
[Integer User ID] [Queury] [Date: YYYY-MM-DD HH:MM:SS] [optional url] 
```

我尝试使用扫描仪并使用 nextLine() 读取行，但这会将整个文件读取为一行。知道如何确保一次只能获得一条线路吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:31:08.543

尝试使用`BufferedReader`而不是`Scanner`. `BufferedReader`可以容忍各种不同类型的行终止符 - 可能`Scanner`总是需要您的平台默认行终止符。

或者，使用[Guava](http://guava-libraries.googlecode.com)，它可以让您非常轻松地做到这一点，例如使用[`CharStreams.readLines`](http://docs.guava-libraries.googlecode.com/git-history/v11.0.2/javadoc/com/google/common/io/CharStreams.html#readLines%28java.lang.Readable%29)，可能指定 a `LineProcessor`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T18:31:44.980

您可以直接抓取整个文件，然后拆分数据：

```
for ( String line : "the entire file".split( System.getProperty("line.separator") )
{
     System.out.println( line );
} 
```

作为旁注：`System.getProperty("line.separator")`是通用的换行符。

另一种方法：

```
BufferedReader bufferedReader = new BufferedReader( new FileReader( "absolute file path" ) );

String line;

while ( ( line = bufferedReader.readLine() ) != null)
{
     System.out.println( line );
} 
```

# jquery - IE8中的pageYOffset滚动和动画

> ID：10286162
> 
> 赞同：9
> 
> 时间：2012-04-23T18:28:31.167
> 
> 标签：jquery, internet-explorer-8

我正在设计一个滚动页面，我有以下 Javascript 来隐藏和显示一个对话框：

```
 if(window.pageYOffset >= 300){

            $('#m1').fadeIn('slow');

    }

    if(document.documentElement.scrollTop >=300){

        $('#m1').fadeIn('slow');

    } 
```

这在 Chrome、FF、IE9+ 中效果很好

但是，在 IE8,7 中它只能工作。它正确地显示和隐藏元素，但是它评估滚动位置和隐藏元素之间的延迟是可怕的。此外，没有褪色，它只是发生。

我想知道这是否只是我需要处理的 IE8 问题，或者是否有办法让我使用 IE8 实现反应性、干净的淡入淡出。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-23T18:32:52.943

`pageYOffset`IE8及`pageXOffset`之前不支持，试试这个功能：

```
// Return the current scrollbar offsets as the x and y properties of an object
function getScrollOffsets() {

    // This works for all browsers except IE versions 8 and before
    if ( window.pageXOffset != null ) 
       return {
           x: window.pageXOffset, 
           y: window.pageYOffset
       };

    // For browsers in Standards mode
    var doc = window.document;
    if ( document.compatMode === "CSS1Compat" ) {
        return {
            x: doc.documentElement.scrollLeft, 
            y: doc.documentElement.scrollTop
        };
    }

    // For browsers in Quirks mode
    return { 
        x: doc.body.scrollLeft, 
        y: doc.body.scrollTop 
    }; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-13T14:22:57.027

您也可以使用以下方法修复它：

```
document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset; 
```

所以你有它

```
if((document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset) >= 300){
        $('#m1').fadeIn('slow');
} 
```

通过这种方式，您可以避免重复代码。

# powershell - PowerShell 中的函数返回值

> ID：10286164
> 
> 赞同：225
> 
> 时间：2012-04-23T18:28:39.173
> 
> 标签：powershell

我开发了一个 PowerShell 函数，它执行许多涉及预配[SharePoint](http://en.wikipedia.org/wiki/Microsoft_SharePoint)团队网站的操作。最终，我希望该函数将配置站点的 URL 作为字符串返回，因此在我的函数结束时，我有以下代码：

```
$rs = $url.ToString();
return $rs; 
```

调用此函数的代码如下所示：

```
$returnURL = MyFunction -param 1 ... 
```

所以我期待一个字符串，但事实并非如此。相反，它是 System.Management.Automation.PSMethod 类型的对象。为什么它返回该类型而不是 String 类型？

* * *

## 回答 #1

> 赞同：307
> 
> 时间：2012-04-23T21:01:56.683

PowerShell 具有非常古怪的返回语义——至少从更传统的编程角度来看是这样。有两个主要想法可以帮助您：

*   所有输出都被捕获并返回
*   return 关键字实际上只是表示一个逻辑退出点

因此，以下两个脚本块将有效地完成完全相同的事情：

```
$a = "Hello, World"
return $a 
```

```
$a = "Hello, World"
$a
return 
```

第二个示例中的 $a 变量作为输出保留在管道上，并且如前所述，返回所有输出。实际上，在第二个示例中，您可以完全省略 return，并且您将获得相同的行为（当函数自然完成并退出时，将隐含返回）。

如果没有更多的函数定义，我不能说为什么你会得到一个 PSMethod 对象。我的猜测是，您可能有几行没有被捕获并被放置在输出管道上的东西。

还值得注意的是，您*可能*不需要这些分号 - 除非您将多个表达式嵌套在一行中。

[您可以在 TechNet 上的about_Return](http://technet.microsoft.com/en-us/library/hh847760.aspx)页面上阅读有关返回语义的更多信息，或者`help return`从 PowerShell 本身调用命令。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2013-01-30T14:23:57.200

PowerShell 的这一部分可能是最愚蠢的方面。函数期间生成的任何无关输出都会污染结果。有时没有任何输出，然后在某些情况下，除了您的计划返回值之外，还有一些其他计划外输出。

因此，我从原始函数调用中删除了分配，因此输出最终出现在屏幕上，然后逐步执行，直到调试器窗口中弹出我没有计划的内容（使用[PowerShell ISE](https://en.wikipedia.org/wiki/PowerShell#PowerShell_2.0)）。

即使是在外部范围内保留变量之类的事情也会导致输出，比如`[boolean]$isEnabled`除非你成功，否则它会烦人地吐出一个 False `[boolean]$isEnabled = $false`。

另一个好方法是`$someCollection.Add("thing")`吐出新的集合计数。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2017-03-12T02:46:34.563

使用 PowerShell 5，我们现在可以创建类。将您的函数更改为一个类，并且 return*只会*返回它之前的对象。这是一个真正简单的例子。

```
class test_class {
    [int]return_what() {
        Write-Output "Hello, World!"
        return 808979
    }
}
$tc = New-Object -TypeName test_class
$tc.return_what() 
```

如果这是一个函数，预期的输出将是

```
Hello World
808979 
```

但作为一个类，唯一返回的是整数 808979。一个类有点像保证它只会返回声明的类型或 void。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2014-07-08T11:38:03.627

作为一种解决方法，我一直在返回从函数返回的数组中的最后一个对象......这不是一个很好的解决方案，但总比没有好：

```
someFunction {
   $a = "hello"
   "Function is running"
   return $a
}

$b = someFunction
$b = $b[($b.count - 1)]  # Or
$b = $b[-1]              # Simpler 
```

总而言之，写同一件事的一种更单一的方式可能是：

```
$b = (someFunction $someParameter $andAnotherOne)[-1] 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-08-23T23:27:31.957

我传递了一个带有单个结果成员的简单 Hashtable 对象，以避免返回疯狂，因为我还想输出到控制台。它通过引用传递。

```
function sample-loop($returnObj) {
  for($i = 0; $i -lt 10; $i++) {
    Write-Host "loop counter: $i"
    $returnObj.result++
  }
}

function main-sample() {
  $countObj = @{ result = 0 }
  sample-loop -returnObj $countObj
  Write-Host "_____________"
  Write-Host "Total = " ($countObj.result)
}

main-sample 
```

[您可以在我的GitHub 项目*unpackTunes*](https://github.com/WhatIfWeDigDeeper/unpackTunes)中查看真实的示例用法。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-02-09T21:41:37.777

现有答案是正确的，但有时您实际上并没有使用 a`Write-Output`或 a明确返回某些内容`return`，但函数结果中存在一些神秘值。这可能是内置函数的输出，例如`New-Item`

```
PS C:\temp> function ContrivedFolderMakerFunction {
>>    $folderName = [DateTime]::Now.ToFileTime()
>>    $folderPath = Join-Path -Path . -ChildPath $folderName
>>    New-Item -Path $folderPath -ItemType Directory
>>    return $true
>> }
PS C:\temp> $result = ContrivedFolderMakerFunction
PS C:\temp> $result

    Directory: C:\temp

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----         2/9/2020   4:32 PM                132257575335253136
True 
```

目录创建的所有额外噪音都被收集并在输出中发出。缓解这种情况的简单方法是添加`| Out-Null`到`New-Item`语句的末尾，或者您可以将结果分配给变量而不使用该变量。它看起来像这样......

```
PS C:\temp> function ContrivedFolderMakerFunction {
>>    $folderName = [DateTime]::Now.ToFileTime()
>>    $folderPath = Join-Path -Path . -ChildPath $folderName
>>    New-Item -Path $folderPath -ItemType Directory | Out-Null
>>    # -or-
>>    $throwaway = New-Item -Path $folderPath -ItemType Directory 
>>    return $true
>> }
PS C:\temp> $result = ContrivedFolderMakerFunction
PS C:\temp> $result
True 
```

`New-Item`可能是其中比较有名的，但其他的包括所有的`StringBuilder.Append*()`方法，以及`SqlDataAdapter.Fill()`方法。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-04-23T21:02:33.723

不看代码很难说。确保您的函数返回的对象不超过一个，并确保您捕获来自其他调用的任何结果。你得到什么：

```
@($returnURL).count 
```

无论如何，有两个建议：

将对象转换为字符串：

```
...
return [string]$rs 
```

或者只是用双引号将其括起来，与上面相同，但键入更短：

```
...
return "$rs" 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-08-16T19:37:39.943

[卢克对](https://stackoverflow.com/questions/10286164/function-return-value-in-powershell/14606292#14606292)这些场景中的函数结果的描述似乎是正确的。我只想了解根本原因，PowerShell 产品团队会对这种行为采取一些措施。这似乎很常见，并且花费了我太多的调试时间。

为了解决这个问题，我一直在使用全局变量，而不是返回并使用函数调用中的值。

这是关于使用全局变量的另一个问题： *[Setting a global PowerShell variable from a function where the global variable name is a variable passing to the function](https://stackoverflow.com/questions/12535419/setting-a-global-powershell-variable-from-a-function-where-the-global-variable-n)*

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-07-17T06:49:34.193

下面简单地返回 4 作为答案。当您替换字符串的添加表达式时，它会返回第一个字符串。

```
Function StartingMain {
  $a = 1 + 3
  $b = 2 + 5
  $c = 3 + 7
  Return $a
}

Function StartingEnd($b) {
  Write-Host $b
}

StartingEnd(StartingMain) 
```

这也可以对数组进行。下面的示例将返回“文本 2”

```
Function StartingMain {
  $a = ,@("Text 1","Text 2","Text 3")
  Return $a
}

Function StartingEnd($b) {
  Write-Host $b[1]
}

StartingEnd(StartingMain) 
```

请注意，您必须在函数本身下方调用该函数。否则，它第一次运行时会返回一个错误，它不知道“StartingMain”是什么。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-08-26T16:58:21.933

您需要在返回之前清除输出。尝试使用[Out-Null](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/out-null?view=powershell-7.1)。这就是powershell的`return`工作原理。它返回的不是您想要的变量，而是整个函数的输出。所以你的例子是：

```
function Return-Url
{
   param([string] $url)

   . {
       $rs = $url.ToString();
       return
   } | Out-Null

   return $rs
}

$result = Return-Url -url "https://stackoverflow.com/questions/10286164/function-return-value-in-powershell"

Write-Host $result
Write-Host $result.GetType() 
```

结果是：

```
https://stackoverflow.com/questions/10286164/function-return-value-in-powershell
System.String 
```

归功于[https://riptutorial.com/powershell/example/27037/how-to-work-with-functions-returns](https://riptutorial.com/powershell/example/27037/how-to-work-with-functions-returns)

# java - 为什么在 Web 服务中使用 complexType？

> ID：10286165
> 
> 赞同：3
> 
> 时间：2012-04-23T18:28:41.867
> 
> 标签：java, php, web-services, wsdl, .net

我刚刚读了一本关于网络服务的书，上面说有“RPC 风格的网络服务”和“文档风格的网络服务”。第二个是在 WSDL 序列和 complexType 中使用。我什么时候应该使用这种风格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:55:48.133

当您想将联系人、消息或某些编程对象等数据对象原样传输到相应技术中的客户端应用程序时，您应该使用复杂数据类型。

例如，如果您使用的是在 .NET 或 Java 中构建的复杂类型 Web 服务，并且您从 PHP 或 Ruby 调用该 Web 服务，您将从 .NET 或 Java 导出的对象按原样导出（在 98% 的情况下，特定于非常小的语言属性更改）在 PHP 或 Ruby 中。

因此，如果您是不喜欢简单字符串、int、bool 或数组数据类型的人之一，您可以在 WSDL 中使用复杂类型。这不是很容易开始，但一旦你开始它就会很有趣。

如果您使用 PHP 来开发 Web 服务，那么 Zend Framework 的 WSDL 自动发现功能可以让您从 PHP 自动生成 WSDL，但如果您的复杂性与您自己手动编写 WSDL 相比没有什么不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T18:35:12.023

webservice 中的 complexType 将用于表示用户定义的数据类型，例如您要传输的对象（不是 java 默认类型），例如，如果您有 UserVO，其中包含姓名、地址、电话等，您需要将其定义为 ComplexType要发送的 WSDL。Java 集合/数组也被视为复杂类型。[这是关于Webserices 类型](http://www.ibm.com/developerworks/webservices/library/ws-whichwsdl/)和[示例复杂类型](https://stackoverflow.com/questions/1377102/soap-wsdl-complextype-being-posted-as-wrong-argument-type)的好教程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-23T18:36:04.330

基本上，几乎所有仍在使用 SOAP Web 服务（即尚未迁移到 REST）的人都在使用“文档样式”。

除非您手动编写 WSDL，否则这种区别几乎没有意义。那是谁做的；）？

如果您使用 Visual Studio 或 Axis 等工具来生成 WSDL，并使用工具来生成存根，那么唯一真正重要的是一个工具生成的代码是否能够理解另一个工具生成的代码。这又回到了“就 SOAP 而言，它几乎是一个文档风格的世界”。或者，更具体地说，是“文档样式/文字包装”的世界。

这里有几个很好的链接：

*   [http://mangstacular.blogspot.com/2011/05/wsdl-soap-bindings-confusion-rpc-vs.html](http://mangstacular.blogspot.com/2011/05/wsdl-soap-bindings-confusion-rpc-vs.html)

*   [http://www.ibm.com/developerworks/webservices/library/ws-whichwsdl/](http://www.ibm.com/developerworks/webservices/library/ws-whichwsdl/)

*   [基于文档或 RPC 的 Web 服务](https://stackoverflow.com/questions/5598/document-or-rpc-based-web-services)

# matlab - 在 Matlab 中将字符串值（字符数组）转换为矩阵

> ID：10286166
> 
> 赞同：0
> 
> 时间：2012-04-23T18:29:08.953
> 
> 标签：matlab

所以基本上这就是我想要做的：

我有十进制值 3 这样：

```
x=3 
```

现在我得到这样的二进制格式：

```
s = dec2bin(x,3)
s = 011 
```

s 的格式是一个字符串（正确吗？）。

现在我想将此值转换为矩阵，以便对其进行矩阵运算。像这样：

```
A = [0 1 1] 
```

但我似乎无法做到这一点。我已经尝试过 str2mat 和 cell2mat 但没有结果。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:00:12.980

如果您 100% 确定您只会得到 0 和 1，请使用：

```
a = '001';
b = double(a)-48; 
```

（ASCII 中的 0 是 48）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:51:37.970

你也可以这样做：

```
x=3;
binNumber = dec2bin(x,3);
A=sprintf('%s',binNumber) - '0'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T18:59:08.993

这是一种方法：

```
>> cellfun(@str2num, cellstr(s'))'

ans =

     0     1     1 
```

正如您所注意到的，MATLAB 在字符串操作方面并不是那么好。:)

# asp.net - 如果我来自 mvc 中的 Create，是否有一个变量可以通知编辑操作？

> ID：10286176
> 
> 赞同：0
> 
> 时间：2012-04-23T18:29:51.667
> 
> 标签：asp.net, asp.net-mvc-3, razor

使用 mvc3，是否有一些变量可以告知我是否来自 Create to Edit 操作？

如果在 GET 中也使用路由，我想要某种行为，否则如果 CreateAction 已被触发，我想打开不同的上下文编辑。

第一个解决方案失败：创建额外的操作编辑，触发：`The current request for action 'Edit' on controller type 'XController' is ambiguous between the two action methods`。

更重要的是，是否存在对 MVC 的误解？这个解决方案对任何人来说听起来很奇怪吗？我对 mvc 有很大的疑问。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:33:25.227

您可以向您的编辑操作添加一个可选参数，以标记您是否来自添加操作，或者您可以创建一个全新的操作（使用来自编辑的唯一名称）。

前者看起来像：

```
public ActionResult Edit(int id, bool? fromCreate = false)
{
    if(fromCreate)
    {
        // do your special processing
    }
} 
```

显然，后者将是：

```
public ActionResult Edit(int id)
{
}

public ActionResult EditNewlyCreated(int id)
{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:05:11.420

In your create view or create controller action (no razor markup if its in the action):

```
@{ TempData["FromCreate"] = true; } 
```

And then in your edit get action:

```
public ActionResult Edit()
{
 if( TempData.ContainsKey("FromCreate") )
 {
  var fromCreate = (bool)TempData["FromCreate"];
  TempData.Remove("FromCreate");
  if( fromCreate )
  {
   //insert logic
  }
 }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T19:52:41.070

If you have something linke this in MyView view:

```
 @model ModelClass

          @Html.BeginForm()
          {
               if(Model.Id > 0)
               {
                   @Html.HiddenFor(m => m.Id);
               }

               ...
          } 
```

And in controller:

```
 public ActionResult Edit(int id)
     {
           var model = modelRepository.GetById(id);
           Return View("MyView", model);
     }

     [HttpPost]
     public ActionResult Edit(int id, FormCollection collection)
     {
           var model = modelRepository.GetById(id);
           TryUpdateModel(model)
           {
                modelRepository.Save(model);
           }
     }

     public ActionResult Create()
     {
           var model = new ModelClass();
           Return View("MyView", model);
     }

     [HttpPost]
     public ActionResult Create(ModelClass model)
     {
           ...
     } 
```

In view, if Model.Id > 0 it means that we entered view using Edit action and when form posts, if there will be Id field in post parameters (hidden for id) then Edit(with HttpPost) will be called, else if there will not be Id parameter then Create action will be called

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-23T18:36:05.393

If you have 2 Edit methods, they must have different method inputs to differentiate them.

```
public ActionResult Edit(int id)
{
    return View(db.GetWidget(id));
}

public ActionResult Edit(int id, string username)
{
    ViewBag.Username = username;
    return View(db.GetWidget(id));
} 
```

Or, just make the method into one with an optional parameter

```
public ActionResult Edit(int id, string username = "")
{
    ViewBag.Username = username;
    return View(db.GetWidget(id));
} 
```

I would also recommend painting a method attribute such as [HttpGet], [HttpPost], etc.

# javascript - 抑制 JSHint / JSLint 或替代服务中的“混合空格和制表符”警告？

> ID：10286178
> 
> 赞同：43
> 
> 时间：2012-04-23T18:30:15.693
> 
> 标签：javascript, jslint, jshint

JSHint 和 JSLint 是很棒的工具。

但是，“混合空格和制表符”警告在报告中占主导地位。有没有办法抑制这些警告，或者是否有类似的服务可以抑制空白警告？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-05-13T17:48:45.600

无法使用标志关闭此警告，并且[JSHint 维护者不想为此添加标志](https://github.com/jshint/jshint/pull/669#issuecomment-9407095)。

但是，可以根据[其编号](https://github.com/jshint/jshint/blob/e3df309b2a84ca627d5fe85e60c296b6735d4b66/src/shared/messages.js)关闭警告。在这种情况下，你会写：

```
/* jshint -W099 */ 
```

如果您使用的是 JSHint 配置文件，您也可以在此处指定：

```
{
    "-W099": true, // allowed mixed tabs and spaces
} 
```

或者，有一个[自定义报告器可](https://gist.github.com/valueof/3885619)用于关闭此警告。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-04-23T18:33:22.023

```
/*jshint smarttabs:true */ 
```

请参阅`smarttabs`“放松选项”下的 。[http://www.jshint.com/docs/options/](http://www.jshint.com/docs/options/)

> 当后者仅用于对齐时，此选项会抑制有关混合制表符和空格的警告。该技术称为[SmartTabs](http://www.emacswiki.org/emacs/SmartTabs)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-11-24T14:59:56.603

**2014 年的答案：升级 jshint**正如@RobW 前面提到的，jshint[不再抱怨混合空格和制表符](https://github.com/jshint/jshint/commit/4035fef1af4ef426e9dc99918ca3aac0ce44b784)。我已经通过升级到 jshint@2.5.10 并重新整理我的文档对此进行了测试，该文档不再抱怨（我一直使用制表符缩进，但在 SublimeText 中注释掉行会触发此警告）。

```
sudo npm update -g jshint 
```

# arrays - VBA - UDF 以不同方式处理数组

> ID：10286182
> 
> 赞同：5
> 
> 时间：2012-04-23T18:30:31.587
> 
> 标签：arrays, excel, excel-formula, excel-2003, vba

这段代码是我正在处理的一小部分。我已将问题缩小到以下部分。我有这个 UDF SampleFunction，我需要将一个数组 {3;4} 作为唯一参数传递给它。

```
Function SampleFunction(InputVar As Variant) As Integer
    SampleFunction = InputVar(LBound(InputVar))
End Function 
```

我用两种不同的方式称这个 UDF。一、通过VBA

## 情况1：

```
Sub testSF()
    MsgBox SampleFunction(Array(3, 4))
End Sub 
```

其次，通过我的 excel 工作表作为

## 案例二：

`={SampleFunction(ROW(3:4))}`-> 即作为数组函数。

## 问题：

UDF 适用于案例 1，即通过 VBA 调用`#VALUE`，当我通过 excel 工作表调用它时，它会为案例 2 提供错误。

对于案例 2，我使用 F8 逐步执行该函数。`Lbound(InputVar)`计算结果为 1（这与案例 1 中从 sub 调用不同，它的计算结果为 0），但`InputVar(Lbound(InputVar))`在案例 2 中显示“下标超出范围”错误。

我想知道的是**如何从工作表中调用 SampleFunction 函数**，即案例 2，使其具有与上面显示的案例 1 相同的行为。`Lbound(InputVar)`作为奖励，如果有人能解释为什么在上述情况下评估不同，那就太好了。

**其他一些细节：**

我正在构建一个 UDF 来执行一些正则表达式操作。上面的参数`InputVar`将是一个数组 {x;y;z;...} 指定第 x、y、z ... 次出现。的数据类型`InputVar`保留为 Variant，因为我希望能够将数字（作为单长度数组）、数组或范围（接收并转换为数组）传递给函数。

提前致谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:38:05.120

我相信你有两个问题。`SampleFunction`首先，如果您在非数组公式中使用，我认为您的代码不会评估，即，如果 InputVar 是一个范围。您需要结合一些方法来处理可以传递到变体中的不同类型的输入。其次，您的代码假定 InputVar 是一维数组。这将导致任何多维数组出错。这是`'Subscript out of range.'`错误的根源，因为数组函数将所有数组参数作为二维数组传递，即使它们可以表示为一维。

我建议在您的函数中声明一个新的动态数组，然后将其设置为等于 InputVar。在过去，我已经为数组和非数组公式做了这项工作，如下所示。另外，请注意如何从数组中检索第一项的更改。

```
Option Explicit
Function SampleFunc(InputVar As Variant) As Integer

Dim tmpArray() As Variant

On Error GoTo ErrHandler
tmpArray = InputVar

'Added extra argument to LBound since dynamic arrays have two dimensions by default.
SampleFunc = tmpArray(LBound(tmpArray, 1), LBound(tmpArray, 2))
Exit Function

ErrHandler:
'Handles the case where InputVar is a Range.
tmpArray = InputVar.Value
Resume Next

End Function 
```

这又快又脏，尤其是。错误处理，但希望基本思想是有帮助的。

# security - 多网络应用安全揭秘

> ID：10286184
> 
> 赞同：2
> 
> 时间：2012-04-23T18:30:43.350
> 
> 标签：security, spring-security, birt, jboss7.x

我在一个 jboss as7 实例上部署了两个 Web 应用程序。一个应用程序是基于 spring/maven 的，并使用 spring 安全性进行身份验证。另一个应用程序是不需要直接登录身份验证的 birt Web 应用程序。这两个应用程序由一个菜单链接连接，该链接仅在登录用户拥有管理角色时显示。所以 spring 应用程序是主应用程序，如果用户是经理，它会提供一个 birt Web 应用程序的链接。我的问题是 spring 应用程序是安全的（没有直接的 url 访问，用户需要登录等），但是如果有人知道应用程序的 url，则可以在不登录的情况下访问 birt 应用程序。我不想有两个单独的登录页面。我希望 spring 应用程序身份验证也确定对 birt 应用程序的访问，但我不清楚如何执行此操作。我在我的 birt 应用程序的 web.xml 文件和 jboss-web.xml 文件中添加了一个安全约束来为应用程序建立安全域。安全约束是否存在并没有区别，但安全域确实限制了通过 url 访问 birt 应用程序。那么从这里开始下一步是什么？如何从 spring 应用程序（jsessionid？）获取身份验证并使用它来允许用户访问包含 birt 应用程序的安全域？那么从这里开始下一步是什么？如何从 spring 应用程序（jsessionid？）获取身份验证并使用它来允许用户访问包含 birt 应用程序的安全域？那么从这里开始下一步是什么？如何从 spring 应用程序（jsessionid？）获取身份验证并使用它来允许用户访问包含 birt 应用程序的安全域？

如果有人想知道，这两个应用程序都在同一个域上……例如“域/springApp 或域/birtApp”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T11:06:11.763

这里也有同样的问题，因为 birt.war 完全是一个单独的 webapp .. 它有自己的会话，所以任何人都可以通过 url 知道你的 birt.war 名称和报告名称，他们不仅可以在没有身份验证的情况下运行报告，还可以下载你的报告这又是一个安全问题（这里下载报告是指.rptdesign 文件，他们可以在其中看到您的查询）。

可能的解决方案是： -

1> 在您的 webapp 中集成 BIRT 报告引擎 3.7，并使用 servlet 生成报告 html 页面，然后在您的应用程序中显示。在这方面，缺点是它会为您运行的每个报告创建 html 文件，并且不会获得 Web 查看器的 ajax 功能和导出功能，如 excel、pdf 等。

2> 这对我不起作用，但你可以试一试。在你的 webapp 中集成 BIRT 3.7 web 查看器。我做了这个并且能够在我的 webapp 中显示 web 查看器，但这个链接也可以工作：report=report1.rptdesign">http://localhost:7110/myapp/frameset?_report=report1.rptdesign

我认为它会将此链接重定向到我的 webapp 登录页面，就像它对我的 webapp 中的任何其他页面所做的那样，但我得到了一个很大的否定。原因是单独的会话。

结论是从 birt 中提取 web 查看器并修改它以连接我的 webapp，这就像再次创建 birt。

哦！！这是 birt 3.7 集成的链接：[http ://wiki.eclipse.org/Birt_3.7_Migration_Guide](http://wiki.eclipse.org/Birt_3.7_Migration_Guide)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:39:31.207

一种选择是通过 spring 安全性保护 birt Web 应用程序（因此 birt 应用程序中需要另一个 spring 安全性配置）。birt 应用程序中的 spring 安全过滤器将检查传入会话中的 UserDetails 对象，以确定用户是否有权访问 birt Web 应用程序。

Spring Security -> app1 -> spring security -> birt app

这是一个关于堆栈溢出答案的相当大的讨论:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T22:13:51.443

看看[选择你的 jboss sso](http://java.dzone.com/articles/choosing-sso-your-jboss)和 tomcat 阀门的使用。

这可能会有所帮助。

问候

# php - 基于来自另一个数组的键组合数组

> ID：10286186
> 
> 赞同：0
> 
> 时间：2012-04-23T18:30:51.917
> 
> 标签：php, arrays, key

我想像这样组合两个数组：

第一个数组：

 `````
 array( "ATTENDED"        => 1,
          "TENTATIVE"       => 2,  //
          "REJECTED"        => 3,
          "OUTSTANDING"     => 4,  
          "ACCEPTED"        => 6
        ); 
```` 

`第二个数组：`

 ``````
 array ( 1 => 29, 
          4 => 30, 
          6 => 47 
        ); 
````  `我想得到这样的结果：

 `````
 array ( 'ATTENDED' => 29, 
          'OUTSTANDING' => 30, 
          'ACCEPTED' => 47
        ); 
````  `第二个阵列是灵活的。我可以翻转键和值。

或者更好：

 `````
 array( "ATTENDED"    => 29,
      "TENTATIVE"       => 0,  //
      "REJECTED"        => 0,
      "OUTSTANDING"     => 30,  
      "ACCEPTED"        => 47
     ); 
```` 

`我知道必须有一个简单的解决方案。有任何想法吗？`

 `* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:37:48.773

```
foreach ($arr1 as $k1 => $v1) {
    $arr1[$k1] = isset($arr2[$v1]) ? $arr2[$v1] : 0;
} 
```

编辑-这没有明确的循环，虽然我不认为这真的更好，但也许更酷。

```
$mapped = array_map(function($valFromArr1) use ($arr2) {
    return isset($arr2[$valFromArr1]) ? $arr2[$valFromArr1] : 0;
}, $arr1); 
```

我想不出一种只使用纯 php 函数的理智方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:36:39.977

```
 $labels = array( 
          "ATTENDED"        => 1,
          "TENTATIVE"       => 2, 
          "REJECTED"        => 3,
          "OUTSTANDING"     => 4,  
          "ACCEPTED"        => 6
        );

    $values = array(
          1 => 29, 
          4 => 30, 
          6 => 47 
        );

   $results = array();

   foreach ($labels as $label => $id) {
       $results[$label] = array_key_exists($id, $values) ? $values[$id] : 0;
   } 
```````````

# java - 带有 java ArrayList 的 Hibernet

> ID：10286192
> 
> 赞同：0
> 
> 时间：2012-04-23T18:31:24.970
> 
> 标签：java, hibernate, serialization

我正在尝试使用 ArrayList 持久化对象（PERSON），但我得到了这个执行：

```
ERROR:2012-04-23 20:58:54,336 org.hibernate.property.BasicPropertyAccessor  - IllegalArgumentException in class: Entities.Person, setter method of property: msgList
ERROR:2012-04-23 20:58:54,336 org.hibernate.property.BasicPropertyAccessor  - expected type: java.util.ArrayList, actual value: org.hibernate.collection.PersistentList 
```

人物类：

```
public class Person implements Serializable {

    static final long serialVersionUID = 1L;

    private long id;
    private String _email;
    private ArrayList<AnsMsg> msgList=new ArrayList<AnsMsg>();

     long getId() {
        return id;
    }
  public void setId(long id) {
    this.id = id;
}
  public String getEmail() {
    return _email;
}

public void set_email(String _email) {
    this._email = _email;
}

public ArrayList<AnsMsg> getMsgList() {

   return msgList;
}

public void setMsgList(ArrayList<AnsMsg> msgList) {
    this.msgList = msgList;
}
} 
```

人 Hbm:

```
 <hibernate-mapping>
    <class name="Entities.Person" table="PERSON">
        <id name="id" type="long">
            <column name="ID" />
            <generator class="increment" />
        </id>
        <property name="_email" type="java.lang.String" access="field">
            <column name="_EMAIL" />
        </property>

     <list name="msgList" cascade="all"  >
           <key column="parent_id"/>
             <index column="idx" />
            <one-to-many class="msg.AnsMsg" />
        </list>

    </class>
</hibernate-mapping> 
```

现在我不想`List`改用`ArrayList`

```
(private List<AnsMsg> msgList=new ArrayList<AnsMsg>();) 
```

因为当我从 DB Hibernate 返回时`org.hibernate.collection.PersistentList`，我需要序列化和反序列化这个对象（Java 服务器和 android 应用程序）并且“org.hibernate.collection.PersistentList”没有实现 Serializable（或者我错了，因为我得到 null当我尝试在 android 端反序列化时的对象）。

这是我的反序列化/序列化方法：

```
 public static byte[] serializeObject(Object o) { 
            ByteArrayOutputStream bos = new ByteArrayOutputStream(); 

            try { 
              ObjectOutput out = new ObjectOutputStream(bos); 
              out.writeObject(o); 
              out.close(); 

              byte[] buf = bos.toByteArray(); 

              return buf; 
            } 
            catch(IOException ioe)
            { 

              return null; 
            }
              catch(Exception e)
                {

                return null;
                }

          } 

 public static Object deserializeObject(byte[] b) {

Object object=null;
          try { 

ObjectInputStream in = new ObjectInputStream(new       ByteArrayInputStream(b)); 
               object = in.readObject(); 
              in.close(); 

              return object; 
        } catch(ClassNotFoundException cnfe) { 

          return null; 
        } catch(IOException ioe) { 

          return null; 
        } 
        catch(Exception e)
        {

        String ex=e.toString();
        return object; 
        }
      } 
```

**更新：**

当我尝试使用 List 而不是 ArrayList

当我尝试在 android 端反序列化这个对象（使用“deserializeObject”方法）时

```
object = in.readObject(); 
```

线是扔

```
java.lang.ClassNotFoundException: org.hibernate.collection.PersistentList. 
```

这样我尝试使用 ArrayList。

我如何映射这个数组列表？或者在这种情况下有一种与 Hibernate 一起工作的连击方式？

提前致谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:48:55.453

您正在使用 `ArrayList`List 接口的实现，而休眠返回[PersistentList](http://www.dil.univ-mrs.fr/~massat/docs/hibernate-3.1/api/org/hibernate/collection/PersistentList.html)这也是 List 接口的实现。因此，您不应特定于 ArrayList 将您的 ArrayList 更改为 java.util.List ，以便它可以接受 java.util.List 的任何实现。它也将解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:20:44.897

恕我直言，您走错路了。这些是您拥有的选项：

*   将实体复制到 POJO 并将它们发送到 android 设备。（无效）
*   将 hibernate 作为库添加到您的 android 应用程序。这对安卓来说太多了。（膨胀你的安卓应用程序）
*   使用不同的序列化方式（JSON、XML）

我会使用不同的序列化方式——JSON。有一些库可以让这个过程变得非常轻松。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T18:34:01.677

您的 POJO 方法签名中的类型仍然是 ArrayList，您需要将其更改为 List 到处

# javascript - 什么是“正确”的 JSON 日期格式？

> ID：10286204
> 
> 赞同：1375
> 
> 时间：2012-04-23T18:32:32.077
> 
> 标签：javascript, json

我见过很多不同的 JSON 日期格式标准：

```
"\"\\/Date(1335205592410)\\/\""         .NET JavaScriptSerializer
"\"\\/Date(1335205592410-0500)\\/\""    .NET DataContractJsonSerializer
"2012-04-23T18:25:43.511Z"              JavaScript built-in JSON object
"2012-04-21T18:25:43-05:00"             ISO 8601 
```

哪一个是正确的？还是最好的？这有什么标准吗？

* * *

## 回答 #1

> 赞同：2215
> 
> 时间：2013-04-11T15:20:43.507

[JSON](http://json.org/ "JSON 定义")本身**并没有**指定日期应该如何表示，但 JavaScript 会。

您*应该*使用[`Date`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date "JavaScript 日期的 MDN 文档")'s[`toJSON`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toJSON "toJSON() 的 MDN 文档")方法发出的格式：

`2012-04-23T18:25:43.511Z`

原因如下：

1.  它是人类可读的，但也很简洁

2.  它正确排序

3.  它包括小数秒，可以帮助重新建立年表

4.  符合[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601 "维基百科上的 ISO8601")

5.  ISO 8601 已在国际上建立了十多年

6.  ISO 8601 得到[W3C](http://www.w3.org/TR/NOTE-datetime "W3C 日期时间")、[RFC3339](https://www.rfc-editor.org/rfc/rfc3339 "IETF 上的 RFC3339")和[XKCD的认可](http://xkcd.com/1179/ "关于ISO8601的XKCD漫画")

**话虽如此**，曾经编写的每个日期库都可以理解“自 1970 年以来的毫秒数”。所以为了便于携带，[ThiefMaster](https://stackoverflow.com/a/10286228/1850609)是对的。

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2012-04-23T18:34:02.300

JSON 对日期一无所知。.NET 所做的是非标准的 hack/扩展。

我会使用一种可以轻松转换为`Date`JavaScript 对象的格式，即可以传递给[`new Date(...)`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date). 最简单且可能最便携的格式是自 1970 年以来包含毫秒的时间戳。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2012-04-23T18:35:40.133

**没有正确的格式**；**[JSON 规范](http://www.json.org/)**没有指定交换日期的格式，这就是为什么有这么多不同的方法可以做到这一点。

**最好的格式可以说是以[ISO 8601 格式](http://www.w3.org/TR/NOTE-datetime)**表示的日期（[参见 Wikipedia](https://en.m.wikipedia.org/wiki/ISO_8601)）；它是一种众所周知且广泛使用的格式，可以跨多种不同的语言进行处理，因此非常适合互操作性。如果您对生成的 json 有控制权，例如您以 json 格式向其他系统提供数据，则选择 8601 作为日期交换格式是一个不错的选择。

如果您无法控制生成的 json，例如，您是来自多个不同现有系统的 json 消费者，则处理此问题的最佳方法是使用日期解析实用程序函数来处理预期的不同格式。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2015-03-27T18:48:00.117

来自[RFC 7493（I-JSON 消息格式）](https://www.rfc-editor.org/rfc/rfc7493)：

I-JSON 代表 Internet JSON 或 Interoperable JSON，具体取决于您询问的对象。

> 协议通常包含旨在包含时间戳或持续时间的数据项。建议将所有此类数据项表示为 ISO 8601 格式的字符串值，如[RFC 3339](https://www.ietf.org/rfc/rfc3339.txt)中所指定，附加限制是使用大写而不是小写字母，不默认包含时区，以及可选的尾随秒数即使它们的值为“00”，也包括在内。还建议所有包含持续时间的数据项都符合 RFC 3339 附录 A 中的“持续时间”产生式，并具有相同的附加限制。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2019-07-04T13:35:21.890

如有疑问，只需按`F12`（在 Firefox 中为`Ctrl`+ `Shift`+ `K`）进入现代浏览器的 javascript Web 控制台并编写以下内容：

```
new Date().toISOString() 
```

将输出：

> “2019-07-04T13:33:03.969Z”

达达！！

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2017-02-27T07:33:07.853

仅供参考，我已经看到使用这种格式：

```
Date.UTC(2017,2,22) 
```

它适用于该函数支持的**JSONP**`$.getJSON()`。不确定我是否会推荐这种方法......只是把它作为一种可能性扔出去，因为人们正在这样做。

**FWIW：**永远不要在通信协议中使用自纪元以来的秒数，也不要使用自纪元以来的毫秒数，因为由于闰秒的随机实现（您不知道发送方和接收方是否都正确实现了 UTC 闰秒），这些都充满了危险。

有点讨厌，但很多人认为 UTC 只是 GMT 的新名称——错了！如果您的系统没有实现闰秒，那么您使用的是 GMT（尽管不正确，但通常称为 UTC）。如果您确实完全实现了闰秒，那么您确实在使用 UTC。未来的闰秒无法得知；它们会在必要时由 IERS 发布，并且需要不断更新。如果您正在运行的系统尝试实现闰秒但包含过期的参考表（比您想象的更常见），那么您既没有 GMT，也没有 UTC，那么您的系统就会伪装成 UTC。

这些日期计数器仅在以分解格式（y、m、d 等）表示时才兼容。它们从不兼容 epoch 格式。记住这一点。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2020-02-15T19:59:29.033

**“2014-01-01T23:28:56.782Z”**

日期以标准且可排序的格式表示，该格式表示 UTC 时间（由 Z 表示）。ISO 8601 还通过将 Z 替换为时区偏移的 + 或 – 值来支持时区：

**“2014-02-01T09:28:56.321-10:00”**

ISO 8601 规范中的时区编码还有其他变体，但 –10:00 格式是当前 JSON 解析器支持的唯一 TZ 格式。一般来说，最好使用基于 UTC 的格式 (Z)，除非您特别需要确定生成日期的时区（仅在服务器端生成中可能）。

**注意：**

```
 var date = new Date();
    console.log(date); // Wed Jan 01 2014 13:28:56 GMT- 
    1000 (Hawaiian Standard Time) 

    var json = JSON.stringify(date);
    console.log(json);  // "2014-01-01T23:28:56.782Z" 
```

告诉你这是首选方式，即使 JavaScript 没有标准格式

```
// JSON encoded date
var json = "\"2014-01-01T23:28:56.782Z\"";

var dateStr = JSON.parse(json);  
console.log(dateStr); // 2014-01-01T23:28:56.782Z 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2019-05-08T13:04:19.213

JSON 本身没有日期格式，它不关心任何人如何存储日期。但是，由于这个问题是用 javascript 标记的，我假设您想知道如何在 JSON 中存储 javascript 日期。您可以将日期传递给该`JSON.stringify`方法，`Date.prototype.toJSON`默认情况下将使用它，然后使用`Date.prototype.toISOString`（[MDN on Date.toJSON](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toJSON#Description)）：

```
const json = JSON.stringify(new Date());
const parsed = JSON.parse(json); //2015-10-26T07:46:36.611Z
const date = new Date(parsed); // Back to date object 
```

我还发现，每当我读取 JSON 字符串时，使用（[JSON.parse 上](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse#Syntax)`reviver`的 MDN）的参数自动将 ISO 字符串转换回 javascript 日期很有用。`JSON.parse`

```
const isoDatePattern = new RegExp(/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/);

const obj = {
 a: 'foo',
 b: new Date(1500000000000) // Fri Jul 14 2017, etc...
}
const json = JSON.stringify(obj);

// Convert back, use reviver function:
const parsed = JSON.parse(json, (key, value) => {
    if (typeof value === 'string' &&  value.match(isoDatePattern)){
        return new Date(value); // isostring, so cast to js date
    }
    return value; // leave any other value as-is
});
console.log(parsed.b); // // Fri Jul 14 2017, etc... 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-01-31T11:33:13.483

首选方法是使用`2018-04-23T18:25:43.511Z`...

下图显示了为什么这是首选方式：

![JSON 日期](../Images/5ab58653b75b4e28852f8c4e32f80de2.png)

因此，如您所见， Date 有一个本机 Method `toJSON`，它`return`采用这种格式并且可以很容易地`Date`再次转换为......

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-02-08T09:01:50.673

我相信*通用互操作性*的最佳格式不是 ISO-8601 字符串，而是 EJSON 使用的格式：

`{ "myDateField": { "$date" : <ms-since-epoch> } }`

如此处所述：[https ://docs.meteor.com/api/ejson.html](https://docs.meteor.com/api/ejson.html)

**好处**

1.  **解析性能：**如果您将日期存储为 ISO-8601 字符串，那么如果您希望在该特定字段下有一个日期值，那就太好了，但是如果您有一个必须在没有上下文的情况下确定值类型的系统，那么您将解析每个字符串日期格式。
2.  **无需日期验证：**您无需担心日期的验证和验证。即使字符串匹配 ISO-8601 格式，它也可能不是真实的日期；EJSON 日期永远不会发生这种情况。
3.  **明确类型声明：**就通用数据系统而言，如果您想在一种情况下将 ISO 字符串存储**为字符串**，而在另一种情况下存储*实际系统日期*，则采用 ISO-8601 字符串格式的通用系统机械地不允许这样做（没有逃脱技巧或类似的可怕解决方案）。

**结论**

我了解人类可读的格式（ISO-8601 字符串）对于 80% 的用例来说是有帮助和更*方便*的，而且确实不应该告诉任何人*不要*将他们的日期存储为 ISO-8601 字符串，如果这是他们的应用程序的话理解，**但是**对于应该保证某些值*肯定*是日期的普遍接受的传输格式，我们怎么能允许模棱两可并需要如此多的验证？

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-09-16T11:09:02.150

在 Sharepoint 2013 中，以 JSON 格式获取数据没有将日期转换为仅日期格式的格式，因为该日期应为 ISO 格式

```
yourDate.substring(0,10) 
```

这可能对你有帮助

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2017-08-24T06:45:58.043

解析服务器对我有用

```
{
    "ContractID": "203-17-DC0101-00003-10011",
    "Supplier":"Sample Co., Ltd",
    "Value":12345.80,
    "Curency":"USD",
    "StartDate": {
                "__type": "Date",
                "iso": "2017-08-22T06:11:00.000Z"
            }
} 
```

* * *

## 回答 #13

> 赞同：-7
> 
> 时间：2015-12-16T23:56:41.030

对此只有一个正确答案，而且大多数系统都会出错。自纪元以来的毫秒数，即 64 位整数。时区是一个 UI 问题，在 app 层或 db 层没有业务。为什么你的数据库关心什么是什么时区，当你知道它将把它存储为一个 64 位整数时，然后进行转换计算。

去掉无关的位，将日期视为 UI 上的数字。您可以使用简单的算术运算符来执行查询和逻辑。

* * *

## 回答 #14

> 赞同：-8
> 
> 时间：2018-04-10T06:11:00.153

以下代码对我有用。此代码将以**DD-MM-YYYY**格式打印日期。

```
DateValue=DateValue.substring(6,8)+"-"+DateValue.substring(4,6)+"-"+DateValue.substring(0,4); 
```

否则，您还可以使用：

```
DateValue=DateValue.substring(0,4)+"-"+DateValue.substring(4,6)+"-"+DateValue.substring(6,8); 
```

* * *

## 回答 #15

> 赞同：-18
> 
> 时间：2016-01-01T15:30:19.970

我认为这真的取决于用例。在许多情况下，使用适当的对象模型（而不是将日期呈现为字符串）可能更有益，如下所示：

```
{
"person" :
      {
 "name" : {
   "first": "Tom",
   "middle": "M",
  ...
}
 "dob" :  {
         "year": 2012,
         "month": 4,
         "day": 23,
         "hour": 18,
         "minute": 25,
         "second": 43,
         "timeZone": "America/New_York"
    }   
   }
} 
```

诚然，这比 RFC 3339 更冗长，但是：

*   它也是人类可读的
*   它实现了一个适当的对象模型（如在 OOP 中，只要 JSON 允许）
*   它支持时区（不仅仅是给定日期和时间的 UTC 偏移量）
*   它可以支持更小的单位，如毫秒、纳秒……或简单的小数秒
*   它不需要单独的解析步骤（解析日期时间字符串），JSON 解析器将为您做所有事情
*   使用任何日期时间框架或任何语言的实现轻松创建
*   可以轻松扩展以支持其他日历刻度（希伯来语、汉语、伊斯兰...）和时代（AD、BC、...）
*   10000 年是安全的；-)（RFC 3339 不是）
*   支持全天日期和浮动时间（Javascript`Date.toJSON()`不支持）

我不认为正确的排序（如 funroll 对 RFC 3339 所述）是在将日期序列化为 JSON 时真正需要的功能。这也仅适用于具有相同时区偏移的日期时间。

# ios - 当 UIImageView 接近 UIScrollView 的边缘时淡化它

> ID：10286205
> 
> 赞同：0
> 
> 时间：2012-04-23T18:32:32.837
> 
> 标签：ios, xcode, ios5, uiscrollview

我的应用程序底部的图像上有一个 UIScrollView，它充当带有可以水平滚动的图标的底座。而不是 UIScrollView 的粗糙边缘，我希望图标淡出以获得更美观的外观。作为 iOS 开发的新手，我不知道这些选项是否有效：

1.  创建一个褪色的图像以用作滚动视图上的叠加层，以便图标仅通过可见部分出现。
2.  实际上根据图像与中心（或每个边缘）的距离来更改图像的 alpha。

我怀疑第一个想法将是最简单的，但我想把它扔在那里以获取任何其他想法。

注意：我确实看过[本](http://www.cocoanetics.com/2011/08/adding-fading-gradients-to-uitableview/)教程，但是该技术假定背景是纯色。如果我以编程方式执行此操作，我可能需要淡化单个图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T12:25:26.377

你绝对可以按照#2 的方式实现一些东西。这将类似于教程描述的内容。然而，alpha 过渡不会像使用教程中提到的渐变层或使用图像那样平滑，因为整个图标将具有相同的 alpha。差异的可辨别程度取决于图标的大小。较小的图标，很少有人能分辨出来。较大的图标差异会很明显。

你必须实施

*   (void)scrollViewDidScroll:(UIScrollView *)scrollView

滚动视图的委托类中的方法。每次滚动视图更改其内容的位置时，都会调用此方法。在此方法中，您可以调用其子视图并根据需要调整其 alpha。为了优化它而不是调用所有元素的 alpha 调整，您可以只更新仍然部分/完全可见的子视图。

编辑：要弄清楚要调整哪些视图，您将使用在上述方法中作为参数传递的 scrollView 的 contentOffset 属性。

# ocaml - Ocaml 错误：未绑定的记录字段标签长度

> ID：10286207
> 
> 赞同：0
> 
> 时间：2012-04-23T18:32:51.727
> 
> 标签：ocaml

这是我得到的错误，我不知道为什么：“错误：未绑定的记录字段标签长度”有人知道吗？

```
let rastavi str =
    let sublist = ref [] in
    let list = ref [] in
    for i = ((str.length str)1) [down]to 0 do
   if str.[i] =' '    then (str.[i] :: !sublist)
  else (list := (!sublist:: !list))   sublist = [] 
  done ;; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T18:50:38.127

您正在使用 OO 表示法来获取字符串的长度。OCaml 使用函数式表示法。所以它看起来像这样：

```
String.length str 
```

不像这样：

```
str.length (* OO notation, not in OCaml *) 
```

**编辑：**

旁注：这个解决方案在很大程度上是解决这个问题的必要条件。如果你想学习 FP 思维方式，你应该尝试递归和不变地思考。由于这看起来像家庭作业，因此很可能是您想要的功能解决方案。

但是您的原始代码中还有一些其他问题：

1.  您有两个彼此相邻的表达式，中间没有任何内容。如果你想“做”两件事，你需要用分号分隔它们`;`（但是，这是命令式的）

2.  您正在使用`=`which 比较两个值是否相等。如果要为引用分配值，则需要使用`:=`. （命令式，再次。）

# java - 无法使用 java SoapMessage 更改信封中的肥皂 URI

> ID：10286209
> 
> 赞同：6
> 
> 时间：2012-04-23T18:32:57.583
> 
> 标签：java, uri

我正在尝试创建一个简单的 SOAP 消息以从客户端发送，但我（似乎）无法更改信封中“soap”命名空间的 URI。

这是肥皂标题应该是这样的：

```
<soap:Envelope xmlns:soap="http://www.w3.org/2001/12/soap-envelope/"  soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding/"> ... </soap:Envelope> 
```

所以我有以下代码：

```
 final SOAPMessage sm = MessageFactory.newInstance().createMessage();

    final SOAPPart sp = sm.getSOAPPart();
    final SOAPEnvelope se = sp.getEnvelope();
    final SOAPHeader sh = se.getHeader();
    final SOAPBody sb = se.getBody();

    se.removeNamespaceDeclaration(se.getPrefix());
    se.addNamespaceDeclaration("soap", "http://www.w3.org/2001/12/soap-envelope");
    se.setPrefix("soap");
    sb.setPrefix("soap");
    sh.setPrefix("soap");
    se.setEncodingStyle("http://www.w3.org/2001/12/soap-encoding/"); 
```

但是，当我在发送前打印邮件时，以下是我的信封：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding/"> 
```

请注意“应该”部分中 xmlns:soap 的 URI 与实际的差异。

如果我将`addNamespaceDeclaration`调用的第一个参数更改为“soapy”而不是“soap”，这就是我得到的以下信封：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapy="http://www.w3.org/2001/12/soap-envelope" soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding/"> 
```

我猜这可能与调用是`addNamespaceDeclaration`而不是类似的事实有关`changeNamespaceDeclaration`，并且考虑到名称空间已经存在，它被忽略了，但我找不到有效的东西（我已经尝试过`setAttributeNS`）。

编辑：我刚刚意识到这`setAttributeNS`很愚蠢，因为那是在改变命名空间，而不是 URI。再次编辑：我有点困惑，当我继续搜索时，我有时会看到命名是`soap:"Namespace"`这样的，所以从这个意义上说，我确实想更改命名空间......但我认为命名空间是“肥皂”部分。任何澄清？

这是我的第一篇文章，所以如果我问一些已经解决的问题，我深表歉意，但我已经四处搜索，我发现的大部分内容都与更改命名空间有关（比如来自 SOAP-ENV，这是默认命名空间，到soap）而不是URI本身。提前致谢。

-M

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-23T19:11:57.297

通常，您不需要手动修改 SOAP 名称空间。您可能想要实现的是创建一个 SOAP 1.2 消息（其名称空间与 SOAP 1.1 不同）。尝试从代码中删除所有命名空间更改行并将第一行更改为

```
final SOAPMessage sm = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL).createMessage(); 
```

如果你真的需要指定应该使用哪个前缀，这段代码似乎可以工作：

```
SOAPMessage sm = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL).createMessage();
sm.getSOAPPart().getEnvelope().setPrefix("soap");
sm.getSOAPPart().getEnvelope().removeNamespaceDeclaration("env");
sm.getSOAPHeader().setPrefix("soap");
sm.getSOAPBody().setPrefix("soap"); 
```

# php - 从 Safari 到 PHP 的 .toDataURL() 正在呈现全白图像（未绘制区域）

> ID：10286210
> 
> 赞同：3
> 
> 时间：2012-04-23T18:32:58.217
> 
> 标签：php, html, canvas, cross-browser, image-generation

摘要：假设我在浏览器中使用画布元素绘制了一个白色笑脸。当我在 Safari 中通过 js/ajax（使用 toDataUrl('image/png') ）从这个画布生成一个图像字符串以 POST 到 PHP 服务器时，使用 PHP 函数 imagecreatefromstring() 和 imagepng() 在服务器上创建的图像是正确的高度和宽度，但它都是白色的，而不是浏览器中画布上的笑脸。

我正在从 base64_decoding 之前的字符串中剥离“data:image/png;base64”并保存到图像文件中。

此方法在 FF 和 Chrome 中完美运行。

toDataUrl 在 js 中生成的 base64 编码字符串经过验证与服务器正在接收的字符串相同，因此在传输中不会被切断。

当我将图像字符串从 toDataUrl() 加载到任何浏览器时，它会按预期显示绘制的图像。但是，在服务器上生成的 newimage.png 完全是白色的。

Safari 将图像编码为需要在服务器上考虑的 base64 字符串有什么不同吗？如果是这样，它不能太激烈，因为任何浏览器都能够从图像字符串中呈现正确的笑脸。

如果您需要更多信息，请随时告诉我。

先感谢您！

编辑：这可能与 Safari 如何存储透明度有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:25:41.983

您是否尝试过导出不透明的图像？在调用 toDataURL 之前，您可以考虑用纯色填充背景。

```
var ctx = document.getElementById('my_canvas').getContext('2d');
var w = $("#my_canvas").width();
var h = $("#my_canvas").height();
ctx.globalCompositeOperation = 'lighter';
ctx.fillStyle = "#000";
ctx.fillRect( 0, 0, w, h ); 
```

这样的事情应该会产生更一致的结果。

# jquery - jQuery-UI 效果 - 双触发事件

> ID：10286211
> 
> 赞同：0
> 
> 时间：2012-04-23T18:33:03.847
> 
> 标签：jquery, jquery-ui

试图解决这个问题很久，jsfiddle不会重新生成这段代码来显示问题。

'click' 事件在元素上被触发两次，之前使用 hide() 和 show('slide') 处理。

`show()`使用or时不会发生`fadeIn(1000)`；在内部移动事件处理程序时不会发生`$(document).ready(){}`。

**`<script></script>`我必须在元素内部使用这个精确的结构。我没有办法改变它。**

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>
<link href='/styles/jquery-ui-1.8.18.custom.css' rel='stylesheet' type='text/css'>
<script src='/js/jquery.js' type='text/javascript'></script>
<script src='/js/jquery-ui-1.8.18.custom.js' type='text/javascript'></script>
<script type='text/javascript'>
  $(document).ready(function() {
    $('#container').hide().delay(750).show('slide');
  });
</script>
</head>
<body>

<div id='container'>
  <div class='download'>Download</div>
  <script type='text/javascript' id='js4container'>
    $('.download').click(function() {
      alert('Trigger');
    });
  </script>
</div>

</body>
</html> 
```

我知道确实会再次`show()`启动内部，绑定相同的事件。`<script></script>`

有解决方法吗？=)

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:37:43.880

您始终可以使用`.one()`，它仅在第一个事件时触发。`.one()`但是，如果您在每次调用之间不单击，您可能仍然会遇到多个触发器`.one()`：

```
$('.download').one('click', function() {
     alert('Trigger');
}); 
```

或者，每次使用以下命令删除处理程序`.off()`：

```
$('.download').off('click').on('click', function() {
     alert('Trigger');
}); 
```

这也可以写成`delegate`附加到`#container`or的语法`body`：

```
$('body').off('click', '.download').on('click', '.download', function() {
     alert('Trigger');
}); 
```

演示：http: [//jsfiddle.net/QnfMZ/1/](http://jsfiddle.net/QnfMZ/1/)

**发生这种情况的原因**是 jQuery UI 使用辅助元素来创建过渡。它们在动画发生时保持正确的布局等。这些帮助元素是使用`clone()`复制元素的 html 创建的，在您的情况下，这意味着它也复制脚本。然后脚本运行，添加第二个处理程序。转换完成后，助手克隆被删除，但您仍然留下一个额外的处理程序。

# java - 为什么“<= 1”没有按预期工作？

> ID：10286213
> 
> 赞同：0
> 
> 时间：2012-04-23T18:33:12.600
> 
> 标签：java, bukkit

我有以下代码

```
@EventHandler
public void onPlayerQuit(PlayerQuitEvent event){
    Player player = event.getPlayer();
    final Player[] playerlist = getServer().getOnlinePlayers();
    if (playerlist.length <=1) { // if no players are online
        getServer().getScheduler().scheduleSyncDelayedTask(this, new Runnable(){
            // this is a scheduler.
            public void run(){
                 if(playerlist.length <=1){
                     getServer().shutdown();
                 }
            }
        }, 6000L); // runs every 6000 ticks, which is every 300 seconds, which is every 5 minutes.
 }
} 
```

当玩家离开时，它会检查他是否是最后一个，如果是，那么在 5 分钟后，它会再次检查，如果仍然没有人在它应该停止服务器。

在此行中：

```
if (playerlist.length <=1) { // if no players are online 
```

我必须将它设置为 <=1 否则它根本不起作用，但如果我离开它也会停止服务器，然后重新加入，我是唯一的一个。当我在 =0 并且只有 <1 时它没有工作。

有任何想法吗？

这是我的更新代码（仍然不起作用）：

```
 @EventHandler
public void onPlayerQuit(PlayerQuitEvent event){
    Player player = event.getPlayer();
    final Player[] playerlist = getServer().getOnlinePlayers();
    if (playerlist.length <=1) { // if no players are online
        getServer().getScheduler().scheduleSyncDelayedTask(this, new Runnable(){
            // this is a scheduler.
            public void run(){
                final Player[] playerlist = getServer().getOnlinePlayers(); 
                if(playerlist.length <=1){
                     getServer().shutdown();
                 }
            }
        }, 500L); // runs every 6000 ticks, which is every 300 seconds, which is every 5 minutes.
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:47:25.640

您所写的内容不起作用的原因是您使用`<=`. 如果有人注销并且没有人离开，则计划任务。如果有人在 5 分钟或更短的时间内重新登录并保持在线，当计划任务检查服务器是否应该关闭时，`1 <= 1`服务器`true`就会关闭。

您提到仅使用`=`不起作用，这是因为在布尔语句中，`==`必须使用来检查是否相等。

尝试使用这个：

```
if (playerlist.length == 0) { // if no players are online
    // Do stuff
} 
```

更新（在评论中讨论）：我不太了解 Bukkit API，但这是我假设发生的情况：在线播放器列表在`onPlayerQuit()`执行后更新。试试这个：在你的`onPlayerQuit()`方法内部，尝试检查`playerlist.length == 1`，在你的任务内部，检查`playerlist.length == 0`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T04:14:30.027

我不知道你是否已经解决了这个问题，但我认为问题的一部分是你试图重新初始化一个已经初始化的最终变量......再次，就像回复中的其他一些人一样，我没有知道 Bukkit API，因为我正在尝试学习它，但是您无法重新初始化最终变量...所以我建议删除最后一部分，或者如果它必须保留，我会为运行创建一个新数组（ ) 方法...当您第二次检查是否有人在线时...如果您更改数组也没关系，因为您可能正在更改在线玩家的数量...因为它是最终的，它当您重新运行播放器列表的最终数组的长度时，将始终为 1...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-07T09:22:59.533

当延迟任务运行时，您的代码不会刷新`playerlist`变量，从不检测任务实际运行时是否有人加入。

更好的代码实现是：

```
@EventHandler
public void onPlayerQuit(PlayerQuitEvent event) {
    Player player = event.getPlayer();
    boolean playersOnServer = false;
    for(Player p : getServer().getOnlinePlayers()) {
        if(p==player) continue;
        playersOnServer = true;
        break;
    }
    if (!playersOnServer) {
        getServer().getScheduler().scheduleSyncDelayedTask(this, new Runnable(){
            public void run(){
                //Redo players check
                boolean playersOnServer = false;
                for(Player p : getServer().getOnlinePlayers()) {
                    playersOnServer = true;
                    break;
                }
                if(!playersOnServer){
                    getServer().shutdown();
                }
            }
        }, 6000L);
    }
} 
```

在上面的代码中，我使用了 for 循环而不是简单的检查是否有在线玩家，以使其与旧 bukkit 中的旧玩家数组和新 bukkit 中的新集合方法一起使用。

这种检测还是有BUG的，比如最后一个人退出，直接加入，等4分59秒再离开，离开后直接关闭服务器。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-23T18:40:36.097

当有人重新登录时，您永远不会取消任务。由于您从不取消任务，即使有人在 5m 时间范围内重新登录，它也会执行。

# c++ - c++11：std::forward 的微妙之处：身份真的有必要吗？

> ID：10286214
> 
> 赞同：13
> 
> 时间：2012-04-23T18:33:12.577
> 
> 标签：c++, visual-studio-2010, visual-c++, c++11

我设置了一个测试用例来了解完美转发。

```
std::string inner(const std::string& str ) {
return "const std::string&";
}
std::string inner(std::string& str ) {
    return "std::string&";
}
std::string inner(const std::string&& str ) {
    return "const std::string&&";
}
std::string inner(std::string&& str ) {
    return "std::string&&";
}

template <typename T> void outer(T&& t) {
  std::cout << "t: " << t << std::endl;
  std::cout << "perfect forward: " << inner(std::forward<T>(t)) << std::endl;
  std::cout << std::endl;
}

void PerfectForwarding()
{
     outer("literal");
     outer(lvalue);
     outer(constlvalue);
     outer(rvalue());
     outer(constrvalue());
} 
```

`std::forward`按预期工作。当我在没有身份的情况下实现自己的转发函数时，会出现有趣的行为：

```
template <typename T> T&& MyForward(T& t)
{
   return ((T&&)t);
} 
```

`std::forward`用in outer替换`MyForward`会得到完全相同的结果！这种行为引出了一个问题，为什么要使用身份？

编译器VS2010

更新 1：关于防止类型推断

AFAIK，特殊类型扣除规则仅在 T&& 上激活。注意 forward 的定义，`forward(typename identity<T>::type& t)`。参数类型只有一个 &。事实上，在我将 MyForward 更改为使用身份并省略 (T&&) 强制转换后，该示例无法编译。从表面上看，从左值到右值的转换似乎使正向工作。

更新 2：在 ideone.com 上使用 GCC 4.5 进行了测试，行为相同。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-23T19:08:51.303

`remove_reference<T>`(`identity`在旧版本的草案中，但已更改为`remove_reference`) 用于防止类型推断：`std::forward` *仅*适用于显式类型参数。否则将编译以下内容：

```
std::forward(t) 
```

...但它不会做正确的事情。

关于左值/右值的问题，请注意有[*两个重载*：`std::forward`](http://en.cppreference.com/w/cpp/utility/forward)一个用于左值，另一个用于右值。

实际上，`MyForward`给出的实现更像是[`std::move`](http://en.cppreference.com/w/cpp/utility/move)：它将左值转换为右值（不同之处在于 move 也接受右值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T03:44:15.967

我检查了 VS 2010 中`forward`和的定义。你和他们`identity`的唯一区别是你使用参数，而他们使用参数。而这只是.`MyForward``forward``T&``typename identity<T>::type&``identity<T>::type``T`

这种差异最重要的（也许也是唯一的）影响是，要使用它们`forward`的模板参数必须明确指定，而你`MyForward`的模板参数可以从调用中推导出来。

# deployment - WAS 相关文件被打包到 ear

> ID：10286222
> 
> 赞同：0
> 
> 时间：2012-04-23T18:33:44.180
> 
> 标签：deployment, ant, ear, websphere-6.1

我有一个要在 WAS 上部署的 ear 文件。在 ear 文件中，我看到了 war 文件、jar 文件和其他静态文件。但我也看到了 variales.xml、security.xml 和 deployment.xml 之类的文件，尽管 ant 构建脚本没有生成这些文件。

这些额外的文件是从哪里来的？他们的目的是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:00:17.273

这些文件是称为增强型 EAR 的功能的一部分。有关更多信息，请参阅[WebSphere Application Server V7：为部署打包应用程序](http://www.redbooks.ibm.com/abstracts/redp4582.html)红皮书。简而言之，应用程序特定的配置可以包含在应用程序中，以最小化管理员在安装应用程序时必须执行的每服务器配置。

# javascript - JavaScript 时间戳到 Python 日期时间的转换

> ID：10286224
> 
> 赞同：64
> 
> 时间：2012-04-23T18:33:48.123
> 
> 标签：javascript, python, timestamp

要在 JavaScript 中获取时间戳，我们使用

```
var ts = new Date().getTime() 
```

`datetime`到目前为止，将其转换为 Python 的正确方法是什么？我使用以下代码

```
>>> jsts = 1335205804950
>>> dt = datetime.datetime.fromtimestamp(jsts/1000)
>>> dt
datetime.datetime(2012, 4, 24, 0, 30, 4) 
```

我将时间戳除以 1000，因为我得到了类似的错误

```
ValueError                                Traceback (most recent call last)
1 d = datetime.datetime.fromtimestamp(a)
ValueError: year is out of range 
```

苏丹。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-04-23T18:36:49.653

您当前的方法是正确的，除以 1000 是必要的，因为您的 JavaScript 以毫秒为单位返回时间戳，并`datetime.datetime.fromtimestamp()`期望以秒为单位的时间戳。

为了保持毫秒精度，您可以除以`1000.0`，因此您使用浮点除法而不是整数除法：

```
>>> dt = datetime.datetime.fromtimestamp(jsts/1000.0)
>>> dt
datetime.datetime(2012, 4, 23, 11, 30, 4, 950000) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-02-09T05:53:47.830

我遇到了同样的问题，感谢@andrew-clark 的回答，我建立了一个小例子来处理这两种情况：

```
 try:
        # when timestamp is in seconds
        date = datetime.fromtimestamp(timestamp)
    except (ValueError):
        # when timestamp is in miliseconds
        date = datetime.fromtimestamp(timestamp / 1000) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T18:38:01.337

您这样做的方式是正确的方式，因为 js 在日期/时间中包含毫秒。据我所知，Python（和 PHP）没有。为了更精确，您可以使用`/1000.0`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-11T11:38:29.050

对于其他人仍然遇到错误：我遇到了类似的问题，但 unix 时间戳以微秒为单位，即我必须将时间戳除以 1000000 才能获得正确的结果。

```
dt = datetime.datetime.fromtimestamp(1502360499615921) 
```

# php - JQuery 验证远程和检查数据库 PHP MySQL 错误

> ID：10286229
> 
> 赞同：0
> 
> 时间：2012-04-23T18:34:07.147
> 
> 标签：php, jquery, mysql, mysql-num-rows

我正在使用 JQuery 验证插件。我得到了使用默认 php 文件的远程功能。

我修改了 php 文件以使用我自己的版本，但 mysql 正在返回

```
Warning: mysql_num_rows(): supplied argument is not a valid MySQL result resource in    /home/fastbluf/syatch/module/1.func.php on line 15 
```

我的 PHP 代码如下。我所有的语法看起来都是正确的。

```
<?php
// Last Edited: 4/23/12
$conn = mysql_connect('localhost','hidden','hidden') or die('Iam dying');
$rs = @mysql_select_db( "hidden", $conn) or die( "Err:Db" );

$do = $_REQUEST['do'];
$email= $_REQUEST['email'];
$user= $_REQUEST['user'];

function checkInfo($do,$email,$user){
    switch ($do) {
        case 1:
            $sql = "select * from User_Base where Email_Address = $email";
            $results = mysql_query($sql). mysql_error();
            $nResults = mysql_num_rows($results);
            if ($nResults > 0) {
                $valid="false";
            } else {
                $valid="true";
            }
        break;

        case 2:
        //not yet 
        break;      
    }
    return $valid;
}
echo checkInfo($do,$email,$user);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:36:29.577

将您的查询修复为

```
$sql = "select * from User_Base where Email_Address = '".$email."'"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T18:36:41.653

问题是您要附加到结果中，导致它不再是有效结果。

```
$results = mysql_query($sql). mysql_error(); 
```

尝试将其更改为如下所示：

```
$results = mysql_query($sql) or die(mysql_error()); 
```

您的查询也应该更改为引用电子邮件地址，并且应该对地址进行转义以防止攻击（SQL 注入）：

```
$email = mysql_real_escape_string($_REQUEST['email']);
$sql = "select * from User_Base where Email_Address = '$email'"; 
```

# matlab - MATLAB：创建连续排序的数值段

> ID：10286230
> 
> 赞同：1
> 
> 时间：2012-04-23T18:34:12.043
> 
> 标签：matlab, sorting, vector

一个简单的 MATLAB 问题：

```
coordinates=[1 6 ;9 20];

coordinates =

     1     6
     9    20 
```

我现在想要的是：

```
 idxList=[1 2 3 4 5 6 9 10 11 12 13 14 15 16 17 18 19 20];

idxList =

     1     2     3     4     5     6     9    10    11    12    13    14    15    16    17    18    19    20 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:09:08.443

这是一种方法：

```
>> cell2mat(cellfun(@(x) x(1):x(2), num2cell(coordinates, 2), 'UniformOutput', 0)')

ans =

     1     2     3     4     5     6     9    10    11    12    13    14    15    16    17    18    19    20 
```

# java - 使用 javax.xml 在 Java 中出现错误的文件描述符 IOException

> ID：10286233
> 
> 赞同：5
> 
> 时间：2012-04-23T18:34:31.977
> 
> 标签：java, xml, linux, file, xml-parsing

我正在使用标准的 javax.xml 包来解析 Linux 机器上的一些 XML 文件。我的代码如下：

```
try 
{
    // Prepare parser
    DocumentBuilder documentBuilder = documentBuilderFactory
        .newDocumentBuilder();
    Document document = documentBuilder.parse(file.getAbsolutePath()); // This is line 397
    XPath xPath = xPathFactory.newXPath();
    ...
}
catch(IOException e) { ... } 
```

单个 DocumentBuilderFactory 由多个线程访问，单个 XPathFactory 也是如此，我相信这是可以接受的用法。使用上述代码解析 XML 文件时，我偶尔会看到以下错误。

```
java.io.IOException: Bad file descriptor
        at java.io.FileInputStream.readBytes(Native Method)
        at java.io.FileInputStream.read(FileInputStream.java:229)
        at java.io.BufferedInputStream.fill(BufferedInputStream.java:229)
        at java.io.BufferedInputStream.read(BufferedInputStream.java:246)
        at org.apache.xerces.impl.XMLEntityManager$RewindableInputStream.read(Unknown Source)
        at org.apache.xerces.impl.XMLEntityManager.setupCurrentEntity(Unknown Source)
        at org.apache.xerces.impl.XMLVersionDetector.determineDocVersion(Unknown Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
        at org.apache.xerces.parsers.DOMParser.parse(Unknown Source)
        at org.apache.xerces.jaxp.DocumentBuilderImpl.parse(Unknown Source)
        at javax.xml.parsers.DocumentBuilder.parse(Unknown Source)
        at mypackage.MyXmlParser.parseFile(MyXmlParser.java:397)
        at mypackage.MyXmlParser.access$500(MyXmlParser.java:51)
        at mypackage.MyXmlParser$1.call(MyXmlParser.java:337)
        at mypackage.MyXmlParser$1.call(MyXmlParser.java:328)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:284)
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:665)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:690)
        at java.lang.Thread.run(Thread.java:799) 
```

我偶尔（约 10% 的时间）会看到以下附加文本：

```
Caused by:
java.io.IOException: Bad file descriptor
        at org.apache.xml.serializer.ToStream.flushWriter(ToStream.java:260)
        at org.apache.xml.serializer.ToXMLStream.endDocument(ToXMLStream.java:191)
        at org.apache.xalan.transformer.TransformerIdentityImpl.endDocument(TransformerIdentityImpl.java:983)
        at org.apache.xml.serializer.TreeWalker.traverse(TreeWalker.java:174)
        at org.apache.xalan.transformer.TransformerIdentityImpl.transform(TransformerIdentityImpl.java:410)
        ... 9 more 
```

当我手动检查文件时，我看不出失败的文件和通过的文件之间没有区别。我可以确认通过的文件是有效的 XML，并且没有特殊字符或过早结束。

有谁知道为什么会发生这种情况，以及如何避免它？

```
> java -version
java version "1.5.0"
Java(TM) 2 Runtime Environment, Standard Edition (build pxa64dev-20061002a (SR3) )
IBM J9 VM (build 2.3, J2RE 1.5.0 IBM J9 2.3 Linux amd64-64 j9vmxa6423-20061001 (JIT enabled)
J9VM - 20060915_08260_LHdSMr
JIT  - 20060908_1811_r8
GC   - 20060906_AA)
JCL  - 20061002 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:08:46.287

它看起来像并发线程的问题。

该错误可能位于您向我们展示的小码之外的某个地方。但是对于 DocumentBuilderFactory 和 XPathFactory 我也不确定它们是否是线程安全的；文档中没有提到它。

对于第一次测试，我建议您将解析 XML 文件的整个代码放入一个`synchronized {}`子句中。如果这解决了您的问题，那么它肯定是一个多线程问题。在这种情况下，您必须找出必须同步的最小代码部分。

# web-services - 通过 Coldfusion 问题使用 Salesforce WSDL

> ID：10286234
> 
> 赞同：0
> 
> 时间：2012-04-23T18:34:35.550
> 
> 标签：web-services, soap, coldfusion, wsdl, salesforce

我从另一组 SFDC 开发人员那里获得了一个类文件，他们在单独的实例中工作，生成基于 SOAP 的 WSDL。我已经导入了那个类文件并在我们的实例中生成了 WSDL。Web 服务非常基础，它只返回一组值（当然是在 XML 中）并且不需要任何参数来检索这些值。

只是为了测试 WSDL 是否正常工作，我已将 WSDL 从我们的实例下载到我的本地 PC 并将其放入 SOAPUI 并成功返回了一组值。

现在进入问题 - 通过 URL 消费

我使用 Coldfusion 的 CFHTTP，所以我有两个 CFHTTP 调用，第一个是我们实例的登录，它返回一个有效的会话 ID。此会话 ID 用于我的第二次通话，如下所示：

```
<!--- token from from first cfhttp --->
<cfset variables.access_token_node = xmlSearch(XMLContent, "//*[name()='sessionId']") />
<cfset variables.access_token = variables.access_token_node[1].xmlText>

<cfset variables.wsdl_url2 = "https://cs12.salesforce.com/services/wsdl/class/WS_FAKE_WSDL">

<cfset packet = CreateObject("java", "java.lang.StringBuffer") />
<cfset packet.append('<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ws="http://soap.sforce.com/schemas/class/WS_FAKE_WSDL">') />
<cfset packet.append('<soapenv:Header>') />
<cfset packet.append('<ws:SessionHeader>') />
<cfset packet.append('<ws:sessionId>#variables.access_token#</ws:sessionId>') />
<cfset packet.append('</ws:SessionHeader>') />
<cfset packet.append('</soapenv:Header>') />
<cfset packet.append('<soapenv:Body>') />
<cfset packet.append('<ws:DescribesObjectFields/>') />
<cfset packet.append('</soapenv:Body>') />
<cfset packet.append('</soapenv:Envelope>') />

<cfhttp method="post" url="#variables.wsdl_url2#" result="findResponse2">
 <cfhttpparam type="HEADER" name="Accept" value="application/soap+xml, application/xml, multipart/related, text/*">
 <cfhttpparam type="HEADER" name="ACCEPT-ENCODING" value="application/soap+xml">
 <cfhttpparam type="HEADER" name="CONNECTION" value="Keep-Alive">
 <cfhttpparam type="HEADER" name="SOAPAction" value="dummy">
 <cfhttpparam type="HEADER" name="Content-Type" value="text/xml; charset=utf-8">
 <cfhttpparam type="HEADER" name="Must-Understand" value="1">
 <cfhttpparam type="Header" name="Content-Length" value="#len(trim(packet.ToString()))#">
 <cfhttpparam type="body" value="#packet.ToString()#" encoded="yes">
</cfhttp> 
```

以下是我从 WSDL 收到的内容。该代码只是将我带回登录屏幕。使用会话 ID，我会假设我不需要重新登录，对吗？

![在此处输入图像描述](../Images/fb74841b127d714ed4768e11191a9187.png)

感谢所有建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:45:30.047

您似乎将 APi 调用发送到 WSDL 文件的 URL，这不是正确的 URL，您应该将其发送到 WSDL 文件中详细说明的服务地址，请参阅底部`soap:address`元素中的元素`service`WSDL。

# c# - 将 Ninject 与 Windows 服务一起使用

> ID：10286235
> 
> 赞同：19
> 
> 时间：2012-04-23T18:34:35.810
> 
> 标签：c#, windows-services, ninject

任何将 Ninject 与 Windows 服务一起使用的好例子？我不确定是否需要任何扩展。另外，不确定组合根应该是什么？有使用 Ninject 和 Windows 服务的好例子吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-23T21:05:46.200

在依赖注入方面，Windows 服务与常规命令行应用程序没有太大区别。直接的组合根是您的`Main`方法。

我通常这样做的方式是在其中创建`StandardKernel`一个模块，在其中解决我的依赖关系。然后用于`kernel.Get`解决顶级依赖项 - 其他一切都将从那里开始：

```
static void Main(string[] args)
{
    var kernel = new StandardKernel(new FooModule());
    var barDependency = kernel.Get<Bar>();

    System.ServiceProcess.ServiceBase[] ServicesToRun;
    ServicesToRun = new ServiceBase[] { new FooService(barDependency) };
    System.ServiceProcess.ServiceBase.Run(ServicesToRun);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T19:42:24.587

使用带有 TopShelf 的 Ninject .. run vs install(start) 我遇到了一个奇怪的问题，`> MyService.exe run` 代码可以正常工作 `Kernel.Bind(handlers => { var bindings = handlers.From("abc.dll") ... }`

但是当我使用安装后启动服务时`> MyService.exe install`

它无法解析 Ninject 程序集扫描中提到的绑定。

经过几个小时打破我的头......

更改`.From(...)`为`.FromAssembliesMatching(...)`我可以成功启动服务。

希望它可以帮助某人。

# jquery - django jquery-form .load() 如果表单错误

> ID：10286242
> 
> 赞同：0
> 
> 时间：2012-04-23T18:35:38.323
> 
> 标签：jquery, django, jquery-forms-plugin, jquery-load

我正在使用 jquery.load() 函数将表单加载到弹出 div 中，到目前为止它运行良好。我想补充的是，当表单提交错误时，它会将错误标记表单加载回弹出 div，而不是重定向到当前正在执行的实际表单页面。

有人建议我使用我认为可以完美工作[的 jquery-form 。](http://jquery.malsup.com/form/#api)我只是不知道如何实现它。

这是 .load() 函数：

```
$(document).ready(function(){
        $(".create").on("click", function(){
            $("#popupContact").load("/cookbook/createrecipe #createform");
        });
}); 
```

这是加载表单的页面：

```
<div id="popupContact" class="popup">
        <a id="popupContactClose" style="cursor:pointer;float:right;">x</a>
        <p id="contactArea">
        </p>
</div>
<div id="backgroundPopup">
</div>  
<div id="col2-footer">
{% paginate %}
</div> 
```

这是我的表单模板：

```
<div id="createform">
<h1>Create New Recipe</h1>
    <form id="createrecipe" action="{% url createrecipe %}" method="POST">
        <table>
            {% csrf_token %}
            {{ form.as_table }}
        </table>
        <p><input type="submit" value="Submit"></p>
    </form>
</div> 
```

这是我使用 jquery-form 的尝试：

```
<script> 
    // wait for the DOM to be loaded 
    $(document).ready(function() { 
        var options ={
            target: '.popup',
    };
    $('#createrecipe').submit(function() {
        $(this).ajaxSubmit(options); 
        return false;
    }); 
});
</script> 
```

创建配方视图：

```
def createrecipe(request):
    if not request.user.is_authenticated():
        return HttpResponseRedirect('/index/')
    else:
        if request.method == 'POST':
            print 1
            form = RecipeForm(request.POST)
            if form.is_valid():
                print 2
                recipe = form.save(commit=False)
                recipe.original_cookbook = request.user.cookbooks.all()[0]
                recipe.pub_date = datetime.datetime.now()
                recipe.save()
                user = request.user
                cookbooks = user.cookbooks
                cookbook = cookbooks.all()[0]
                cookbook.recipes.add(recipe)
                return HttpResponseRedirect('/account')
        else:
            form = RecipeForm()

        return render_to_response('cookbook/createrecipe.html',
                                    {'form':form},
                              context_instance=RequestContext(request)) 
```

谢谢小吃鱼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:47:06.973

因为无论如何您都使用 jquery，所以您应该通过 ajax 提交表单，否则您将被重定向：

```
 $('#createform form').submit(function(e) {
 e.preventDefault();
 $.post("/your views url/", { 
            data: $('#createform form').serialize(),
            },function(data){ //this is the successfunction 
                              //data is what your view returns}
 }); 
```

您的视图应该以 json 格式返回错误，以便您可以在 javascript 中处理它们：

```
from django.utils import simplejson

def ajax_recipe(request):
    if request.method == 'POST':
        form = YourForm(request.POST)
        if form.is_valid():
            form.save()
            return HttpResponse("ok")
        else:
            errors = form.errors
            return HttpResponse(simplejson.dumps(errors))
    else:
        data = "error"
        return HttpResponse(data) 
```

使用该标记，您可以使用 jquery post success 功能将表单错误放置在您想要的任何位置。

```
if(data == "ok"){do something}
// else error handling
var errors = jQuery.parseJSON(data)
if(errors.somefield){//place errors.somefield anywhere} 
```

请注意，代码未经测试。但这就是我要走的路。

# 编辑

请注意，要完成这项工作，您必须将自定义 X-CSRFToken 标头设置为每个 XMLHttpRequest 上的 CSRF 令牌的值。换句话说，从模板中的 django 文档复制并粘贴脚本：[https ://docs.djangoproject.com/en/dev/ref/contrib/csrf/#ajax](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#ajax)

这就是你如何在你的 Form.py 中提出错误

```
def clean_somefield(self):
        somefield = self.cleaned_data.get('some field')
        if not somefield:
            raise forms.ValidationError(u'This field is required.') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:44:56.077

我的 javascript 语法有错误，一切正常

# javascript - 无法在 WordPress 主题中居中水平导航

> ID：10286246
> 
> 赞同：0
> 
> 时间：2012-04-23T18:35:50.390
> 
> 标签：javascript, html, css, xhtml, wordpress-theming

我正在[http://pizzli.com/toothworks](http://pizzli.com/toothworks)上工作。我试图将我的垂直导航居中，以便它在所有浏览器的头部图像中居中，但是当我缩小时，它似乎在移动。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T18:51:05.663

尝试这个

```
ul.topnav {
list-style: none;
padding: 0 20px;
margin: 0 auto;
width: 900px;
float: left;
text-align: center;
font-size: 1.2em;
margin-top: -10px;
margin-left: 230px;
}

#header {
background: url(images/header.png) no-repeat center center;
width: 1260px;
height: 55px;
margin: 0 auto;
} 
```

# c# - 在c#中使用正则表达式格式化字符串

> ID：10286252
> 
> 赞同：15
> 
> 时间：2012-04-23T18:36:04.643
> 
> 标签：c#, regex

我想格式化一个看起来像这样的字符串

```
BPT4SH9R0XJ6 
```

变成这样的东西

```
BPT4-SH9R-0XJ6 
```

该字符串将始终是 12 个字母和数字的组合

任何建议将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-23T18:41:09.760

尝试`Regex.Replace(input, @"(\w{4})(\w{4})(\w{4})", @"$1-$2-$3");`

正则表达式经常被嘲笑，但它是一种非常简洁的方式来做你需要的事情。可以扩展到使用字符串方法难以满足的更复杂的要求。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-23T18:38:56.520

您可以`"(.{4})(.{4})(.{4})"`用作您的表达方式和`"$1-$2-$3"`替代品。然而，这对于 regexp 来说并不是一个很好的用途：你可以使用[`Substring`](http://msdn.microsoft.com/en-us/library/aka44szs.aspx).

```
var res = s.Substring(0,4)+"-"+s.Substring(4,4)+"-"+s.Substring(8); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-23T18:40:50.270

如果规则总是分成四个字符的三个块，则不需要 reg exp：

```
str.Substring(0,4) + "-" + str.Substring(4,4) + "-" + str.Substring(8,4) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-23T18:39:12.523

看起来应该结合`String.Concat`并`string.Substring`处理您需要的一切。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-23T18:42:01.610

```
 var str = "BPT4SH9R0XJ6";
  var newStr = str.Substring(0, 4) + "-" + str.Substring(4, 4) + "-" + str.Substring(8, 4); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-23T18:42:46.410

你有什么理由想做一个正则表达式？你可以只插入连字符：

```
string s = "BPT4SH9R0XJ6";
for(int i = 4; i < s.length; i = i+5)
    s = s.Insert(i, "-"); 
```

这将继续每 4 个字符添加连字符，如果字符串太短/太长/等，也不会出错。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-23T18:42:59.840

```
return original_string.SubString(0,4)+"-"+original_string.SubString(4,4)+"-"+original_string.SubString(8,4); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-23T18:45:05.340

```
string str = @"BPT4SH9R0XJ6";
string formattedString = string.Format("{0}-{1}-{2}", str.Substring(0, 4), str.Substring(4,4), str.Substring(8,4)); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-28T12:49:11.803

这适用于任何长度的字符串：

```
 for (int i = 0; i < (int)Math.Floor((myString.Length - 1) / 4d); i++)
            {
                myString = myString.Insert((i + 1) * 4 + i, "-");
            } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-23T18:44:27.597

结束了使用这个

```
var original = "BPT4SH9R0XJ6".ToCharArray();

var first = new string(original, 0, 4);
var second = new string(original, 4, 4);
var third = new string(original, 8, 4);
var mystring = string.Concat(first, "-", second, "-", third); 
```

谢谢

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-23T18:58:05.213

如果您保证您正在操作的文本是 12 个字符的代码，那么您为什么不直接使用子字符串呢？为什么需要正则表达式？

```
String theString = "AB12CD34EF56";
String theNewString = theString.Substring(0, 4) + "-" + theString.Substring(4, 4) + "-" + theString.Substring(8, 4);' 
```

# java - Mac 上的硬件 UUID 是否适合用于许可

> ID：10286260
> 
> 赞同：4
> 
> 时间：2012-04-23T18:36:45.763
> 
> 标签：java, macos, licensing, uuid

好的，我知道没有任何许可方案是不可破解的；我不是要一个。我已经有了一种 Java 方法，它将在 Windows 和 Mac OSx 上结合主机 MAC 地址、CPU 类型和硬盘驱动器序列来计算“硬件指纹”。但是，我最近购买了一台 MacBook Pro，偶然发现`Hardware UUID`了 System Profiler，我只是想知道是否值得在 Mac 上使用此代码而不是我的方法生成的代码，或者它是否不可取，因为我'不确定它是否一直可用等？

如果您确实建议我使用它，如果您还可以告诉我如何使用 Java 访问它，我将不胜感激。此外，Windows 是否有类似的 UUID 可供我使用？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:44:54.673

我猜这不是一个好主意。Apple 已弃用 iOS 5 中的开发人员对 UUID 的访问权限，看到这也延续到 OSX 也不足为奇。

请参阅此线程进行讨论： [UIDevice uniqueIdentifier 已弃用 - 现在该怎么办？](https://stackoverflow.com/questions/6993325/uidevice-uniqueidentifier-deprecated-what-to-do-now)

# atk4 - 计算字段总是返回 1 - atk 4.2

> ID：10286262
> 
> 赞同：1
> 
> 时间：2012-04-23T18:36:53.240
> 
> 标签：atk4

我有一个具有计算字段的模型。返回的值始终为 1。打开调试后，查询中硬编码为 1：

```
<?php class Model_Income extends Model_base_Income {
    function init(){
        parent::init();
        $this->debug();
        $this->addField('year')->calculated(true);
    }
    function calculate_year(){
        return '22';
    }
} 
```

调试返回的查询

```
 select `name`
,(select `name` from `client` where `income`.`client_id` = `client`.`id` )
`client`,`amount`,`date`,`comment`,1 `year`,`id` 
    from `income` 
```

我正在使用 atk 4.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:05:16.070

在 4.2 中这样做：

在模型中。

```
$this->add("Field_Expression", "year")->set("22"); 
```

或任何 sql 查询而不是 22。

# java - 如何重构我的日期/时间以允许根据他们的区域为我的用户设置日期？

> ID：10286264
> 
> 赞同：0
> 
> 时间：2012-04-23T18:37:00.337
> 
> 标签：java, spring, datetime, spring-mvc, timezone

我的代码目前使用 java 日期。

Mysql 有列日期时间。

我想允许用户设置他们的时区，然后在我的应用程序中我将转换日期以反映他们的时区。

我正在使用 Spring mvc。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:34:23.877

MySQL 中的`Datetime`类型没有与之关联的时区。相反，默认情况下，Connector/J（MySQL JDBC 驱动程序）使用**服务器 timezone**获取日期。有一个设置可以改变它，但我不知道它是否被记录，我必须查看源代码以了解它是如何工作的。

我可以将用户的时区保存为不同的列`VARCHAR`，并在创建日期对象时使用它。如果您不想更改所有数据，可以`time_zone`使用服务器默认时区填充该列，然后逐步更改用户的时区。使用以下代码，您可以获得 UTC 时间戳。Calendar/Date 对象非常混乱，最好使用[Joda Time](http://joda-time.sourceforge.net/)。

```
ResultSet rs = null;

Date date = rs.getDate("date");

TimeZone userTimeZone = TimeZone.getTimeZone(rs.getString("time_zone"));

Calendar c = Calendar.getInstance(userTimeZone);
c.set(1900 + date.getYear(), date.getMonth(),
    date.getDate(), date.getHours(), 
    date.getMinutes(), date.getSeconds());

//what you are actually interested in
long utcTimestamp = c.getTimeInMillis(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:25:55.007

常见的策略是使用 UTC (+0) 将日期和时间信息存储在数据库中，然后在 GUI 层中与用户的时区偏好进行转换。

# c# - 如何在 AutoScroll 设置为 false 的情况下使用 ScrollableControl

> ID：10286265
> 
> 赞同：7
> 
> 时间：2012-04-23T18:37:12.867
> 
> 标签：c#, winforms, controls, scrollable

我有一个自定义控件，可以放大自定义绘制的文档画布。

我尝试使用 AutoScroll，但效果不理想。当我将 AutoScrollPosition 和 AutoScrollMinSize 设置为背靠背（以任何顺序）时，它会在每次缩放更改时强制绘制并导致抖动。我认为这是因为当我修改这两个属性时它正在调用更新而不是无效。

我现在手动设置 Horizo​​ntalScroll 和 VerticalScroll 属性，**AutoScroll 设置为 false**，就像每次缩放级别或客户端大小更改时一样：

```
int canvasWidth = (int)Math.Ceiling(Image.Width * Zoom) + PageMargins.Horizontal;
int canvasHeight = (int)Math.Ceiling(Image.Height * Zoom) + PageMargins.Vertical;

HorizontalScroll.Maximum = canvasWidth;
HorizontalScroll.LargeChange = ClientSize.Width;

VerticalScroll.Maximum = canvasHeight;
VerticalScroll.LargeChange = ClientSize.Height;

if (canvasWidth > ClientSize.Width)
{
    HorizontalScroll.Visible = true;
}
else
{
    HorizontalScroll.Visible = false;
    HorizontalScroll.Value = 0;
}

if (canvasHeight > ClientSize.Height)
{
    VerticalScroll.Visible = true;
}
else
{
    VerticalScroll.Visible = false;
    VerticalScroll.Value = 0;
}

int focusX = (int)Math.Floor((FocusPoint.X * Zoom) + PageMargins.Left);
int focusY = (int)Math.Floor((FocusPoint.Y * Zoom) + PageMargins.Top);

focusX = focusX - ClientSize.Width / 2;
focusY = focusY - ClientSize.Height / 2;

if (focusX < 0)
    focusX = 0;
if (focusX > canvasWidth - ClientSize.Width)
    focusX = canvasWidth - ClientSize.Width;

if (focusY < 0)
    focusY = 0;
if (focusY > canvasHeight - ClientSize.Height)
    focusY = canvasHeight - ClientSize.Height;

if (HorizontalScroll.Visible)
    HorizontalScroll.Value = focusX;

if (VerticalScroll.Visible)
    VerticalScroll.Value = focusY; 
```

在这种情况下，**FocusPoint**是一个 PointF 结构，它保存用户关注的位图中的坐标（例如，当他们使用鼠标滚轮进行放大时，他们关注的是当时的当前鼠标位置）。此功能在大多数情况下都有效。

不起作用的是滚动条。如果用户尝试通过单击任一滚动条来手动滚动，它们都会继续返回 0。我没有在代码中的其他任何地方设置它们。我尝试在 OnScroll() 方法中编写以下内容：

```
if (se.ScrollOrientation == ScrollOrientation.VerticalScroll)
{
    VerticalScroll.Value = se.NewValue;
}
else
{
    HorizontalScroll.Value = se.NewValue;
}

Invalidate(); 
```

但这会导致一些非常不稳定的行为，包括轻弹和滚动出界。

**我应该如何为 OnScroll 编写代码？** 我已经尝试过 base.OnScroll 但在 AutoScroll 设置为 false 时它没有做任何事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:51:58.923

我最终通过创建 3 个子控件实现了我自己的自定义滚动：一个 HScrollBar、一个 VScrollBar 和一个 Panel。

我像这样隐藏 ClientSize 和 ClientRectangle ：

```
public new Rectangle ClientRectangle
{
    get
    {
        return new Rectangle(new Point(0, 0), ClientSize);
    }
}

public new Size ClientSize
{
    get
    {
        return new Size(
            base.ClientSize.Width - VScrollBar.Width,
            base.ClientSize.Height - HScrollBar.Height
        );
    }
} 
```

布局在 OnClientSizeChanged 中完成：

```
protected override void OnClientSizeChanged(EventArgs e)
{
    base.OnClientSizeChanged(e);

    HScrollBar.Location = new Point(0, base.ClientSize.Height - HScrollBar.Height);
    HScrollBar.Width = base.ClientSize.Width - VScrollBar.Width;

    VScrollBar.Location = new Point(base.ClientSize.Width - VScrollBar.Width, 0);
    VScrollBar.Height = base.ClientSize.Height - HScrollBar.Height;

    cornerPanel.Size = new Size(VScrollBar.Width, HScrollBar.Height);
    cornerPanel.Location = new Point(base.ClientSize.Width - cornerPanel.Width, base.ClientSize.Height - cornerPanel.Height);
} 
```

每个 ScrollBar 的**Scroll**事件都订阅了以下内容：

```
private void ScrollBar_Scroll(object sender, ScrollEventArgs e)
{
    OnScroll(e);
} 
```

最后，我们可以允许 MouseWheel 事件通过以下方式滚动：

```
protected override void OnMouseWheel(MouseEventArgs e)
{
    int xOldValue = VScrollBar.Value;

    if (e.Delta > 0)
    {
        VScrollBar.Value = (int)Math.Max(VScrollBar.Value - (VScrollBar.SmallChange * e.Delta), 0);
        OnScroll(new ScrollEventArgs(ScrollEventType.ThumbPosition, xOldValue, VScrollBar.Value, ScrollOrientation.VerticalScroll));
    }
    else
    {
        VScrollBar.Value = (int)Math.Min(VScrollBar.Value - (VScrollBar.SmallChange * e.Delta), VScrollBar.Maximum - (VScrollBar.LargeChange - 1));
        OnScroll(new ScrollEventArgs(ScrollEventType.ThumbPosition, xOldValue, VScrollBar.Value, ScrollOrientation.VerticalScroll));
    }
} 
```

对于自定义绘画，您将使用以下语句：

```
e.Graphics.TranslateTransform(-HScrollBar.Value, -VScrollBar.Value); 
```

这在使用 AutoScroll 时完美运行，没有出现故障。

# flash - Flash Media Live Encoder 硬件/软件兼容性/性能

> ID：10286266
> 
> 赞同：1
> 
> 时间：2012-04-23T18:37:16.747
> 
> 标签：flash, fmle

我正在尝试提高 FMLE 的性能，并且正在寻找合适的硬件。我到处搜索，但找不到一些简单的答案：

1.  FMLE 是否能够适当地使用 2 处理器系统？（我正在考虑购买 2 个 Intel Xeon E5-2620 2.00GHz 处理器）
2.  有人提到 FMLE 可以在 Windows Server 2003（Web 版）上运行。标准版呢？
3.  获得显卡以提高性能是否有任何价值？到目前为止，我的搜索表明 Flash 不能使用 GPU，这让我认为我可以完全跳过购买显卡。

有任何想法吗？

谢谢！

# mysql - MySQL 程序在给定国家的战斗中查找船只。内部关系

> ID：10286267
> 
> 赞同：0
> 
> 时间：2012-04-23T18:37:21.243
> 
> 标签：mysql

我正在尝试创建一个程序，在该程序中，给定一个战斗名称，生成在那场战斗中的两个国家。（如果不完全是两个国家，则为两个国家生成 NULL）

该程序的第一部分对我来说并不重要（我认为）

```
SELECT ship FROM outcomes WHERE battle = inBattle AS t1;
SELECT DISTINCT class FROM ships WHERE name IN t1 AS t2;
SELECT DISTINCT country FROM classes WHERE class IN t2; 
```

我认为这会给我一个表格，其中列出了特定战斗中的不同国家。当我尝试做第二部分时，我的问题就出现了，如果不是完全找到两个国家，那么这两个国家都会产生 NULL。

```
CREATE PROCEDURE findCountriesInBattle( in inBattle VARCHAR(50) )
BEGIN
    SELECT ship FROM outcomes WHERE battle = inBattle AS t1;
    SELECT DISTINCT class FROM ships WHERE name IN t1 AS t2;
    SELECT DISTINCT country FROM classes WHERE class IN t2 AS t3;
IF(SELECT COUNT(*) FROM t3 < 2 OR SELECT COUNT(*) FROM t3 > 2)
    [show NULL, NULL]; << Line 1
ELSE
    SELECT * FROM t3; << Line 2
END IF;
END;
// 
```

我如何正确编写第 1 行和第 2 行？其他线路对吗？

关系：

```
classes(class, type, country, numGuns, bore, displacement)
ships( name, class, launched)
battles(name, date)
outcomes(ship, battle, result) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:40:07.937

您应该使用表连接来简化基本查询。您可以通过一个 SELECT 查询将 3 个表连接在一起，获得给定战斗的不同国家/地区列表。

由于您正在编写存储过程，因此一种直接的方法是首先将计数选择到局部变量中，然后使用条件来显示国家名称或适当的空值。

这是基于您的源代码的示例：

```
CREATE PROCEDURE findCountriesInBattle( in inBattle VARCHAR(50) )
BEGIN
   DECLARE v_country_count INT;

  -- count the countries involved in the battle
  SELECT COUNT(DISTINCT classes.country)
  INTO V_COUNTRY_COUNT
  FROM outcomes
  INNER JOIN ships ON ships.name = outcomes.ship
  INNER JOIN classes ON classes.class = ships.class
  WHERE outcomes.battle = inBattle;

  IF (v_country_count = 2)
  THEN
    -- if it was exactly 2, output the names
    SELECT DISTINCT classes.country
    FROM outcomes
    INNER JOIN ships ON ships.name = outcomes.ship
    INNER JOIN classes ON classes.class = ships.class
    WHERE outcomes.battle = inBattle; 
  ELSE
    -- otherwise, output NULL,NULL
    SELECT null
    UNION ALL
    SELECT null;  
  END IF;
END;
// 
```

# c - 我可以使用哪些免费工具来分析 Windows 上的 C 代码？

> ID：10286269
> 
> 赞同：1
> 
> 时间：2012-04-23T18:37:26.490
> 
> 标签：c

我是一名高中生，正在做一些 C 方面的事情，我想分析我的代码以查看实际的性能瓶颈在哪里。我没有多少钱，所以我更喜欢免费工具。

我喜欢使用 MinGW/GCC 编译器工具链。这不是我坚持的事情，但我更喜欢能够处理这个问题的工具。

我需要的功能：

*   查看在某个函数中花费了多少总时间。

我想要的功能：

*   看看一行代码需要多少时间。
*   跨平台（能够在 Linux 和 Mac 上使用相同的软件）
*   查看函数被调用的频率（以及每次调用平均需要多长时间）。
*   查看导致花费时间的原因（缓存未命中、分支错误预测等）。

我试过使用`gprof`，但我无法让它工作（它只显示`main`在配置文件中），而且我听说过关于它的坏事，那么我有什么选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:29:47.787

如果您想要一个免费的 Windows 和 Linux TBP（它还可以进行基于事件和其他一些基于度量的分析形式），那么 AMD 的代码分析师应该可以很好地完成这项工作（即使在 Intel cpus 上，尽管我不确定质量/可靠性Intel cpus 上的分支和缓存分析），它还内置了一个很好的 Qt 用户界面，可以对源代码 + 装配线时间进行分解。它还有一个 API 来嵌入事件，以便分析器捕获更有针对性的分析。

# ruby-on-rails - Ruby on Rails - 获取表单输入并将其插入数据库的正确方法

> ID：10286272
> 
> 赞同：0
> 
> 时间：2012-04-23T18:37:46.097
> 
> 标签：ruby-on-rails, ruby, haml

我有这个表格：

```
= form_for([:mobile,@disclosure], :html => {:id => "disclosure-form", :remote => true}) do |f|
      %p
        =f.label :display_as, (t :select_disclosure_type)
        =f.select :display_as, options_from_collection_for_select(Disclosure.basics, :display_as,
          :name, f.object.display_as)
      %p
        =f.label :notes, (t :notes)
        =f.text_area :notes, :class => "#{validation_rules(:free_disclosure_notes)}", :rows => 5 , :id => "disclosure_notes_entry"
        = buttonset({:submit_label => (t "buttons.influencers.disclosures.create"),:submit_css_class => "call-to-action",
          :cancel_url => "#",:direction => :left_to_right}) 
```

到目前为止我有这个控制器：

```
 def create
    Rails.logger.debug "-"*100
    Rails.logger.debug session.inspect
    Rails.logger.debug "-"*100

    provider = nil

    @disclosure = params[:disclosure-form].blank?
    resource = build_resource({})

    begin
      if disclosure.nil?
        print "hello 1"
      else
          print "hello 2"
      end

    rescue Exception => ex
      Rails.logger.debug ex

    end

    respond_to do |format|
      format.html{}

    end
  end 
```

但我不确定如何填充 @disclosures 对象以便将其插入数据库？

如何从表单中获取正确的数据并将其添加到数据库中？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:17:53.773

您的表单数据应该是`params[:disclosure]`散列。因此，在您的`create`操作中，您将执行以下操作：

```
def create
  @disclosure = Disclosure.new(params[:disclosure])

  if @disclosure.save
    # redirect to show or something else
  else
    # render 'new' for with validation errors
  end
end 
```

这应该将您的对象保存在数据库中。如果没有验证错误。

我不确定这条线是做什么的：`@disclosure = params[:disclosure-form].blank?`

# jquery - Fancybox - 更改父内容

> ID：10286277
> 
> 赞同：0
> 
> 时间：2012-04-23T18:38:10.060
> 
> 标签：jquery, fancybox

将产品添加到购物车时，我使用 Fancybox 作为弹出窗口。

我希望弹出窗口有两个按钮 - “去结账”或“继续购物”，继续购物只是关闭了花式框。那个没问题。

我似乎无法弄清楚的是关闭fancybox并在主/父窗口中加载结帐页面。我真的会为此提供一些帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:41:17.343

您应该在 javascript 中为 Goto Checkout 按钮上的单击功能执行此操作。

```
function gotoCheckout()
{
    $.fancybox.close();
    window.location = "http://www.blah.com/cart/checkout"; //Change this to be the checkout URL
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:43:45.717

有一个选项（http://fancybox.net/api）'onClosed'，一旦窗口关闭，您应该能够调用一个函数。您的功能可能只包含以下内容：

```
location.href = 'yoururl' 
```

# c# - PdfSharp：重用图像资源

> ID：10286280
> 
> 赞同：1
> 
> 时间：2012-04-23T18:38:35.530
> 
> 标签：c#, pdfsharp

我正在循环浏览一堆 PDF，并将它们合并到一个 PdfDocument 中。我使用 XPdfForm.FromStream(stm) 加载一个 PDF，然后使用 AddPage 添加一个新页面，并将 XPdfForm 绘制到该页面。这似乎是执行此操作的典型方法。

其中一些传入的 PDF 包含重复的图像。我想消除这些，因为它们会创建一个比所需大得多的文件。

给定一个输入 XPdfForm，并希望使用 XGraphics 将其绘制到 PdfPage 上......我如何设计不会添加重复图像而是引用可重用图像的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T08:38:04.267

在理想情况下，PDFsharp 会在保存时删除所有重复的对象（图像、字体）。

它在我们的愿望清单上。似乎已经有针对此问题的实现。 [http://forum.pdfsharp.net/viewtopic.php?f=4&t=648](http://forum.pdfsharp.net/viewtopic.php?f=4&t=648)

我不知道为什么它被删除了，但是 SourceForge 上仍然可以找到旧的源代码。

# language-agnostic - 控件和小部件之间有什么区别吗？

> ID：10286281
> 
> 赞同：7
> 
> 时间：2012-04-23T18:38:37.103
> 
> 标签：language-agnostic

我问这个是因为我必须为产品准备技术文档。控件和小部件之间有什么区别吗？例如，给定[这个](http://www.codeproject.com/Articles/369047/SVG-Based-Star-Rating-Control)控件，你宁愿称它为小部件吗？根据[维基百科](http://en.wikipedia.org/wiki/GUI_widget)，这两个术语似乎可以互换使用。那是对的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-05-30T02:53:08.777

尽管某人的字典中可能有一个正式的定义，可以在两个术语之间进行一些细微的区分，但出于所有实际目的，我想说它们是可以互换的。

我遇到了许多 UI 设计师、开发人员等，他们只是左右互换这些术语。*“列表控件”*、*“列表小部件”*，甚至偶尔会出现*“列表小工具”*。

我什至见过 GUI 工具包基本上将“小部件”定义为“UI 控件”，将“UI 控件”定义为“小部件”，为我们提供了一个很好的递归定义。

如果你看一下 Qt 之类的东西，*“每个 UI 控件都继承自 QWidget”*（从按钮到最复杂的控件的所有内容）。

考虑到有多少人可以互换使用这些术语，我会说这样做是完全可以接受的，即使在技术文档中也是如此。这并不是说现状定义了正确性，但我不知道有任何权威机构在现状之外定义了这一点。也许只要坚持使用这两个术语之一，您就可以比大多数人做得更好。

# powershell - Powershell：是否有一些 hacky 子程序实现？

> ID：10286289
> 
> 赞同：1
> 
> 时间：2012-04-23T18:39:12.923
> 
> 标签：powershell, subroutine

我想知道是否有某种方法可以调用（或加载）位于脚本执行路径下方的函数。

我编写了一个脚本来运行部署，作为最后的步骤之一，该脚本解析 web.config，根据配置文件进行大量更改。一个功能请求进来了，要求切换以在没有实际部署的情况下生成 web.config。

我能想到的唯一方法是将所有解析逻辑变成一个巨大的函数，并在脚本的开头加载它。但是，这种方法会使脚本非常难看。我也不想将所有逻辑分解到另一个脚本中并点源它。

有什么建议么？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T18:46:34.090

使其成为 2 个功能，一个用于部署一个用于 webconfig 使用单独的功能来检查开关并根据这些变量调用功能。

直流

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:20:38.493

我最终又阅读了 30 篇左右的文章，并决定简单地将功能括起来并在脚本中向上移动，然后从脚本内部点源函数。

谢谢。

# java - 配置适用于 Java 的 AWS 开发工具包

> ID：10286291
> 
> 赞同：2
> 
> 时间：2012-04-23T18:39:21.380
> 
> 标签：java, amazon-web-services, aws-sdk, amazon-ses

配置**AWS SDK for Java** (v1.3.8) 后，我想通过运行他们的**AWSJavaMailSample**来测试所有内容。

在仔细检查以下内容是否正确后：

1.  报名参加 SES；
2.  验证发件人地址并从 AWS 控制台发送测试消息；
3.  拥有生产权限；
4.  [从https://aws-portal.amazon.com/gp/aws/securityCredentials](https://aws-portal.amazon.com/gp/aws/securityCredentials)`accessKey`将和添加`secretKey`到**AwsCredentials.properties**文件

我得到一个[**InvalidClientTokenId**](http://docs.amazonwebservices.com/STS/latest/APIReference/CommonErrors.html)：*AWS 记录中不存在所提供的 AWS 访问密钥 ID*。

```
[AmazonSimpleEmailService]$ java AWSJavaMailSample
Exception in thread "main" Status Code: 403, AWS Service: AmazonSimpleEmailService, AWS Request ID: 6db92cf8-8d69-11e1-b872-d1f99982ef22, AWS Error Code: InvalidClientTokenId, AWS Error Message: The security token included in the request is invalid
    at com.amazonaws.http.AmazonHttpClient.handleErrorResponse(AmazonHttpClient.java:552)
    at com.amazonaws.http.AmazonHttpClient.executeHelper(AmazonHttpClient.java:289)
    at com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:170)
    at com.amazonaws.services.simpleemail.AmazonSimpleEmailServiceClient.invoke(AmazonSimpleEmailServiceClient.java:479)
    at com.amazonaws.services.simpleemail.AmazonSimpleEmailServiceClient.listVerifiedEmailAddresses(AmazonSimpleEmailServiceClient.java:214)
    at com.amazonaws.services.simpleemail.AmazonSimpleEmailServiceClient.listVerifiedEmailAddresses(AmazonSimpleEmailServiceClient.java:410)
    at AWSJavaMailSample.verifyEmailAddress(AWSJavaMailSample.java:155)
    at AWSJavaMailSample.main(AWSJavaMailSample.java:75) 
```

哪里`AWSJavaMailSample.java:75`来的`verifyEmailAddress(ses, FROM);`电话。

* * *

## 更新 #1，遵循[shashankaholic 的评论](https://stackoverflow.com/a/10295845/341929)

我创建了两个新用户：

1.  *ses-test*，附加**AmazonSESFullAccess**用户策略
    `{"Statement":[{"Effect":"Allow","Action":["ses:*"],"Resource":"*" }]}`
2.  *ses-smtp-user*，默认**为 AmazonSesSendingAccess**
    `{"Statement":[{"Effect":"Allow","Action":"ses:SendRawEmail","Resource":"*"}]}`

我得到了同样的回应。

即使在将**AdministratorAccess**附加到*ses-smtp-user*
`{"Statement":[{"Effect":"Allow","Action":"*","Resource":"*"}]}`
后 仍然有相同的响应：

```
Exception in thread "main" Status Code: 403, 
AWS Service: AmazonSimpleEmailService, 
AWS Request ID: [...], 
AWS Error Code: InvalidClientTokenId, 
AWS Error Message: The security token included in the request is invalid 
```

* * *

在这种情况下应该使用什么凭据？

或者应如何配置适用于 Java 的 AWS 开发工具包以使 AWSJavaMailSample 正常工作？

* * *

## 更新#2：

问题是我如何在**.properties**文件中声明凭据

```
accessKey="ACCESSKEY"; # Java-string-like 
```

相反，我应该有

```
accessKey=ACCESSKEY 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-28T01:25:19.323

问题是我如何在**.properties**文件中声明凭据

```
accessKey="ACCESSKEY"; # Java-string-like 
```

相反，我应该有

```
accessKey=ACCESSKEY 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T10:09:32.300

[您可以从 IAM 控制台https://console.aws.amazon.com/iam/home](https://console.aws.amazon.com/iam/home)验证您的用户凭证和权限。

转到用户选项卡，单击用户检查权限。您还可以从[https://console.aws.amazon.com/ses/home#smtp-settings](https://console.aws.amazon.com/ses/home#smtp-settings)生成新的 SMTP 凭证：以防万一。

# php - php 文件中的执行权限会导致任何破坏或问题吗？

> ID：10286293
> 
> 赞同：-1
> 
> 时间：2012-04-23T18:39:38.857
> 
> 标签：php, permissions

我有一个托管三个不同站点的数据库。一个上的大多数文件具有 644 权限，其他两个上的大多数具有 755，据我所知，这包括执行权限。我想知道这是否会导致任何问题（不是因为我想避免更改它，只是因为其中一个具有执行权限的站点存在一些问题，我不知道这是否会导致它）。我知道执行权限严格来说对于 php 文件不是必需的，但我不知道为什么，所以我不知道他们是否做任何事情......任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:43:00.513

这取决于您如何执行 php 脚本。如果您的脚本是 shellscript 或通过 cgi 执行，您的 php 脚本需要执行位。如果您通过网络服务器和 mod_php 运行，那么这不是必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:49:04.773

要添加到 tonymarschall 的答案，文件要么是可执行的，要么不是。当以特权用户身份执行脚本时，就会出现破坏范围。通常，除非设置了某些 suid 位，否则脚本会以与服务器相同的用户身份执行（Linux 现在仅在二进制文件上识别 suid 位，而不是 ASCII 文本脚本）。如果脚本碰巧以 root 身份运行并被利用，则损害远大于以普通用户身份被利用的情况。

# java - 查找 Galaxy Tab 10.1 的 IP 地址以进行应用

> ID：10286294
> 
> 赞同：0
> 
> 时间：2012-04-23T18:39:52.890
> 
> 标签：java, android, galaxy-tab

我为 HTC 的愿望编写了一个应用程序，它获取设备 IP 地址并将其打印到屏幕上。当我将此应用程序安装到我的选项卡 10.1 时，IP 地址以奇怪的格式以字母和数字出现？

```
private String getIpAddress()
    {
        try
        {
            for (Enumeration<NetworkInterface> en = NetworkInterface.getNetworkInterfaces(); en.hasMoreElements();)
            {
                NetworkInterface intf = en.nextElement();
                for (Enumeration<InetAddress> enumIpAddr = intf.getInetAddresses(); enumIpAddr.hasMoreElements();)
                {
                    InetAddress inetAddress = enumIpAddr.nextElement();
                    if (!inetAddress.isLoopbackAddress()) { return inetAddress.getHostAddress().toString(); }
                }
            }
        }
        catch(SocketException ex)
        {
            Log.e(TAG , ex.toString());
        }
        return null;
    } 
```

选项卡 10.1 有什么不同？

（返回 IP - fe80::be47:60ff:feff:21e2）

需要是 IP 地址，因为这是我传递给 PC 上的终端以连接到我的应用程序的地址。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:23:29.733

在这种情况下，您的 Galaxy Tab 10.1 会收到一个 IPv6 地址`fe80::be47:60ff:feff:21e2`。这可能是由于您的 HTC Desire 和 Galaxy Tab 关于 IPv6 的不同偏好或功能造成的。

这并没有错，当 IPv4 地址空间用完时，越来越多的设备将（必须）使用 IPv6 地址。

正如[Nesim](https://stackoverflow.com/users/912851/nesim-razon)在他对该问题的评论中指出的那样，IPv6 地址以链路本地地址开头`fe80:`，[即](http://en.wikipedia.org/wiki/Link-local_address)如果设备没有连接到任何分发地址的网络（例如通过 DHCP），则设备自行分配的地址范围。

因此，您的 Galaxy Tab 似乎未连接到任何 wifi 网络或未通过 DHCP 接收任何地址。

问题中的代码片段返回它找到的第一个地址，并且不过滤掉链接本地地址（这对于从外部连接没有用处）。以下代码为您提供了所有既不是环回也不是链接本地的地址。您如何在其中许多之间进行选择取决于您-老实说，我不知道：

```
private static List<InetAddress> getIpAddress() {
  try {
    List<InetAddress> result = new ArrayList<InetAddress>();

    Enumeration<NetworkInterface> interfaces = NetworkInterface.getNetworkInterfaces();
    while (interfaces.hasMoreElements()) {
      NetworkInterface intf = interfaces.nextElement();
      Enumeration<InetAddress> addresses = intf.getInetAddresses();
      while (addresses.hasMoreElements()) {
        InetAddress address = addresses.nextElement();
        if (!address.isLoopbackAddress() && !address.isLinkLocalAddress()) {
          result.add(address);
        }
      }
    }
    return result;
  } catch (SocketException ex) {
    Log.e(TAG, "Failed to list network interfaces.", ex);
    return null;
  }
} 
```

作为比较，我的 Windows 系统列出了 23 个网络接口（其中大部分是虚拟的），总共有 10 个地址，其中 2 个是环回地址（localhost），4 个链接本地地址——剩下 4 个地址，上面的代码将返回——选择第一个似乎过于乐观。

# facebook - 一键注册 - 我在这里错过了什么吗？

> ID：10286298
> 
> 赞同：0
> 
> 时间：2012-04-23T18:40:11.767
> 
> 标签：facebook, facebook-php-sdk, user-registration

我正在尝试在我的网站上实施“一键式”Facebook 注册流程。我非常兴奋，因为在我想要的其他网站上，他们只有一个“使用 FB 注册”按钮，他们单击该按钮，他们会立即获得一个帐户。

但是，如果我去 FB 文档进行注册，它会讨论在 iframe 中显示整个表单，并预先填充值（其他网站似乎都不需要？）。

我有一个 FB 登录按钮，它给了我一个弹出对话框，询问身份验证权限，然后我添加了一个注册 URL，如果他们没有帐户，则将它们发送到我的注册页面（不确定 FB 是如何知道这一点的？我猜这意味着未经授权？）。那么如何在注册页面一键授权应用呢？

我要做的就是在我的服务器上发起一个请求，使用 FB 用户的电子邮件和 user_id 进行注册。我可以将这些存储在 MySQL 中。

单击注册 > 授权应用程序。每当您想登录系统时，只需单击登录（无需输入电子邮件和密码以进行注册和登录）。

我错过了什么吗？我似乎在任何地方都看不到这个？

我无法理解我在这里缺少什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:56:01.393

对话框后使用 php sdk 访问用户信息。如下所示，但可能想检查数据库是否存在。

```
$email=$user_profile[email];
$uid=$user_profile[id];
$sql = 'INSERT INTO mydatabase (`id`, `email`) VALUES (\''.$uid.'\', \''.$email.'\');';
$insert=mysql_query($sql) or die ('Error! in Insert '.$uid.' SQL'); 
```

# java - Java - Base64.decodeBase64(text) 在 Windows 和 Linux 上的不同结果

> ID：10286299
> 
> 赞同：0
> 
> 时间：2012-04-23T18:40:13.913
> 
> 标签：java, base64

我有：

```
String text = // same String (text)
byte[] byteArray = org.apache.commons.codec.binary.Base64.decodeBase64(text);
System.out.println("Length: " + byteArray.length); 
```

在 Windows 上的结果是 31，在 Linux 上是 32。我尝试使用 sun.misc.BASE64Decoder 并且几乎遇到了同样的问题......

为什么不同操作系统上的结果长度不同，我该如何修复它以使其适用于两者？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:44:54.757

可能是因为 Windows 上默认使用的字符编码与 Linux 上的不同。

您可以尝试使用简单的字节数组，而不是字符串作为输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:44:06.533

我猜这可能是由默认为`("\r\n")`和的行分隔符引起的`("\n")`。你为什么不尝试没有这些（好吧，如果那是问题的话）。

只是我的两分钱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T01:31:41.987

在这种特定情况下，问题是字符串文本不同。从命令行加载时，在 Linux 中，您必须在命令行中的文本之前和之后添加单引号，否则它会在字符串中附加一些 Windows 没有的内容。

# eclipse - Yesod 和 EclipseFP 应用程序的重叠实例错误

> ID：10286301
> 
> 赞同：1
> 
> 时间：2012-04-23T18:40:15.667
> 
> 标签：eclipse, haskell, yesod, eclipse-fp

我使用 EclipseFP 创建了一个应用程序，即 yesod 应用程序。使用开箱即用的设置，当我尝试运行“main.hs”文件时出现错误。看起来它可以编译，但是当我尝试运行时出现错误。我试图通过“右键单击”然后“运行”来运行。控制台打开：

```
What might be the issue?

    Here is the error:
    <command line>:
        Could not find module `OverlappingInstances':
          Use -v to see a list of the files searched for.
Failed, modules loaded: none.
Prelude> main 
```

版本：Indigo Service Release 2
Eclipse FP Haskell 插件 - 2.2.4
GHC 版本 7.0.3

可能的解决方案：

我试图在所有haskell文件的顶部添加'{-# LANGUAGE OverlappingInstances #-}'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:33:38.280

这是一个错误，我已经在 EclipseFP/BuildWrapper 的 github 版本中修复了它。将成为 EclipseFP 2.3.0 版本的一部分。我们从 cabal 文件中得到了错误的选项，并在没有 -X 的情况下将 OverlappingInstances 传递给 GHCi。对不起！

# php - 使用 Giix 的 Yii 控制器中的致命错误

> ID：10286303
> 
> 赞同：0
> 
> 时间：2012-04-23T18:40:28.267
> 
> 标签：php, yii

所以我继承了一个 Yii 应用程序，我正在尝试让这个应用程序工作，它为科学资料表的管理做一个基本的 CRUD。我们在 Giix 上使用 Yii

这是错误：“PHP 致命错误：第 58 行 /var/www/idtools.org/www/yii/framework/db/ar/CActiveRecord.php 中允许的内存大小为 134217728 字节已用尽（试图分配 16 字节） "

更新操作给我们带来了问题。更新在控制器中如下所示：

```
public function actionUpdate($id) {
    $model = $this->loadModel($id, 'Factsheet');

    if (isset($_POST['Factsheet'])) {
        $model->setAttributes($_POST['Factsheet']);

        if ($model->save()) {
            $this->redirect(array('view', 'id' => $model->factsheetid));
        }
    }

    $this->render('update', array(
            'model' => $model,
            ));
} 
```

视图如下所示：

```
$this->breadcrumbs = array(
    $model->label(2) => array('index'),
    GxHtml::valueEx($model) => array('view', 'id' => GxActiveRecord::extractPkValue($model, true)),
    Yii::t('app', 'Update'),
);

$this->menu = array(
    array('label' => Yii::t('app', 'List') . ' ' . $model->label(2), 'url'=>array('index')),
    array('label' => Yii::t('app', 'Create') . ' ' . $model->label(), 'url'=>array('create')),
    array('label' => Yii::t('app', 'View') . ' ' . $model->label(), 'url'=>array('view', 'id' => GxActiveRecord::extractPkValue($model, true))),
    array('label' => Yii::t('app', 'Manage') . ' ' . $model->label(2), 'url'=>array('admin')),
);
?>

<h1><?php echo Yii::t('app', 'Update') . ' ' . GxHtml::encode($model->label()) . ' ' . GxHtml::encode(GxHtml::valueEx($model)); ?></h1>

<?php
$this->renderPartial('_form', array(
        'model' => $model));
?> 
```

模型（由 Giix 生成）看起来像： Yii::import('application.models._base.BaseFactsheet');

```
class Factsheet extends BaseFactsheet
{
    public static function model($className=__CLASS__) {
        return parent::model($className);
    }
} 
```

模型扩展了基础：抽象类 BaseFactsheet 扩展 GxActiveRecord {

```
 public static function model($className=__CLASS__) {
        return parent::model($className);
    }

    public function tableName() {
        return 'factsheet';
    }

    public static function label($n = 1) {
        return Yii::t('app', 'Factsheet|Factsheets', $n);
    }

    public static function representingColumn() {
        return 'name';
    }

    public function rules() {
        return array(
            array('name, toolid', 'required'),
            array('weight', 'numerical', 'integerOnly'=>true),
            array('name, toolid', 'length', 'max'=>255),
            array('inputdate', 'safe'),
            array('weight, inputdate', 'default', 'setOnEmpty' => true, 'value' => null),
            array('factsheetid, name, toolid, weight, inputdate', 'safe', 'on'=>'search'),
        );
    }

    public function relations() {
        return array(
            'tool' => array(self::BELONGS_TO, 'Tool', 'toolid'),
            'factsheetcontents' => array(self::HAS_MANY, 'Factsheetcontent', 'factsheetid'),
            'factsheetimages' => array(self::HAS_MANY, 'Factsheetimages', 'factsheetid'),
        );
    }

    public function pivotModels() {
        return array(
        );
    }

    public function attributeLabels() {
        return array(
            'factsheetid' => Yii::t('app', 'Factsheetid'),
            'name' => Yii::t('app', 'Name'),
            'toolid' => null,
            'weight' => Yii::t('app', 'Weight'),
            'inputdate' => Yii::t('app', 'Inputdate'),
            'tool' => null,
            'factsheetcontents' => null,
            'factsheetimages' => null,
        );
    }

    public function search() {
        $criteria = new CDbCriteria;

        $criteria->compare('factsheetid', $this->factsheetid);
        $criteria->compare('name', $this->name, true);
        $criteria->compare('toolid', $this->toolid);
        $criteria->compare('weight', $this->weight);
        $criteria->compare('inputdate', $this->inputdate, true);

        return new CActiveDataProvider($this, array(
            'criteria' => $criteria,
        ));
    }
} 
```

知道如何解决我的问题吗？我已经为 PHP 提供了我所有的系统内存 (memory_init(-1)) 并且刚刚收到堆转储错误。我需要帮助，请告诉我在哪里寻找，因为我对 Yii 完全陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:30:24.420

您通常会将该错误作为 _form 部分文件的一部分。当 GxHtml 生成下拉菜单时，我经常遇到它。

GiiX 在正确地将所有模型从数据库中拉出并为您的下拉菜单获取适当的键/名称方面效率不高。因此，最好手动指定要检索的字段。

如果您发布您的 _form 代码（或至少相关部分），我们可以指出这一行。

# parsing - 解析包含任何字符的字符串

> ID：10286305
> 
> 赞同：2
> 
> 时间：2012-04-23T18:40:34.693
> 
> 标签：parsing, scala, parser-combinators

我正在努力让追随者工作。所以我有括号内的字符串。字符串可以包含任何字符，因此我要解析的字符串也可以包含括号。我认为正则表达式当前也匹配应该由 <~ ")" 匹配的最后一个括号，因此解析失败。我在这里想念什么？

```
private def parser: Parser[Any] = a ~ b ~ c ^^ {
    <do stuff here>
}

private def a: Parser[String] = "\"[^\"]*\"".r | "[^(),>]*".r

private def b: Parser[String] = opt("(" ~> ".*".r <~ ")") ^^ {
    case Some(y) => y.trim
    case None       => ""
}

private def c: Parser[String] = rep(".@" ~> "[^>.]*".r) ^^ (new String(_).trim) 
```

这应该解析以下类型的字符串：

```
test0
test1.@attr
"test2"
"test3".@attr
test4..
test5..@attr
"test6..".@attr
"test7.@attr".@attr
test8(icl>uw)
test9(icl>uw).@attr
"test10..().@"(icl>uw).@attr
test11(icl>uw(agt>uw2,obj>uw3),icl>uw4(agt>uw5))
test12(icl>uw1(agt>uw2,obj>uw3),icl>uw4).@attr1.@attr2
test13(agt>thing,obj>role>effect) 
```

因此，“a”解析器解析字符串，直到打开括号或 .@attr 部分。“b”解析器解析可选括号内的字符。"c" 解析可选的 .@attrs。

目前我在所有包含括号部分的测试字符串上都收到类似的错误：

```
11:07:44.662 [main] DEBUG - Parsed: test8()
11:07:44.667 [main] ERROR - FAILURE parsing: test8(icl>uw) -- `)' expected but `i' found 
```

所以我假设解析器正确解析了第一部分，但是当它看到括号部分时失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T16:59:24.453

解析嵌套结构的正确解决方案是使用递归，例如以下列方式：

```
val parser= "regex".r
@tailrec
def extract(string:String,foundTokens:List[String]=List.empty):List[String]={
  parser.findFirstMatchIn(string) match {
  case Some(parser(matchedValue)) => extract(matchedValue,matchedValue::foundedTokens)
  case None=>foundTokens
} 
```

基本上在每次调用函数时，将找到的标记附加到结果列表中，然后在匹配结果上启动函数。当您不再找到时，您返回找到的令牌。

如果每个子标记内可能有多个匹配项，那么您应该寻找这样的过程：

```
def extract(string:String):Iterator[String]={
   parser.findAllIn(string).flatMap{
      item => extract(item)  
   } 
} 
```

# ruby-on-rails - 骨干和导轨

> ID：10286308
> 
> 赞同：0
> 
> 时间：2012-04-23T18:40:38.303
> 
> 标签：ruby-on-rails, backbone.js, coffeescript

我在向我的 Backbone/Rails 项目添加第二个集合时遇到问题

这是我的收藏公司的课程文件

```
class Raffler.Collections.Companies extends Backbone.Collection
  url: '/api/companies'
  model: Raffler.Models.Company 
```

这是模型的类文件

```
class Raffler.Models.Company extends Backbone.Model 
```

这是路由器

```
class Raffler.Routers.Companies extends Backbone.Router
  routes:
    'companies': 'index'
    'companies/:id' : 'show'

  initialize: ->
    @companies = new Raffler.Collections.Companies()
    @companies.fetch()
    alert @companies

  index: ->
    view = new Raffler.Views.CompaniesIndex(collection: @companies)
    $('#container').html(view.render().el) 
```

这是视图

```
class Raffler.Views.CompaniesIndex extends Backbone.View

  template: JST['companies/index']

  initialize: ->
    @companies.on('reset', @render, this)

  render: ->
    $(@el).html(@template(companies: @companies))
    this 
```

当我到达时它会倒下`@companies.on`- 错误是无法在未定义上调用方法'on'。

我不明白这个错误 - 我已将`@companies`路由器中的集合设置为集合并将其传递到路由器类中创建的视图中。

我在应用程序的另一个集合上实现了完全相同的代码，所以我想知道是不是因为我正在尝试添加第二个集合？

当我执行以下操作时，这一切都在浏览器的 javascript 控制台中完美运行

```
companies = new Raffler.Collection.Companies()
companies.fetch()
companies.length 
```

我可以看到它正在调用服务器并返回正确数量的记录 - 那么为什么代码在应用程序中不起作用？有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:19:36.110

在你的路由器中，你这样说：

```
view = new Raffler.Views.CompaniesIndex(collection: @companies) 
```

这会将新 CompaniesIndex的[`@collection`属性](http://documentcloud.github.com/backbone/#View-constructor)`@companies`设置为：

> 有几个特殊选项，如果通过，将直接附加到视图：[...] `collection`[...]。

所以在你看来，你应该参考`@collection`，而不是`@companies`：

```
class Raffler.Views.CompaniesIndex extends Backbone.View
  #...
  initialize: ->
    @collection.on('reset', @render, @) 
```

`@companies``@collection`仅在路由器内部定义，除非您在视图内部显式分配某些内容，否则视图只会知道`@companies`。

# javascript - 单击链接时跳过更改位置

> ID：10286311
> 
> 赞同：2
> 
> 时间：2012-04-23T18:41:09.397
> 
> 标签：javascript, html, dom, html5-video, href

我只是想知道在单击带有内联代码的链接元素（A）时跳过浏览器更改位置的行为的首选方法是什么。

```
<a href="javascript:void(0)">void(0)</a> // I have always used this one 
```

或者

```
<a href="javascript:;">:;</a> // This one is simple and now a days my favourite 
```

或者

```
<a href="#">#</a> // Scroll to the top 
```

或者你是怎么做的，为什么？什么是最佳实践？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T18:47:43.820

这取决于您为什么要跳过默认行为。使用上面显示的方法，链接不是很有用，因为它们的 href 属性不包含任何信息。它们只是占位符...您也可以引用一个不存在的 ID, `<a href="#phlogiston">dummy link</a>`，单击时它不会执行任何操作。

如果您希望链接具有正常的 href 属性但在单击时执行其他操作，则不会内联。相反，`event.preventDefault()`只要链接触发点击事件，您就可以使用页面加载的脚本调用该方法。另请参阅此答案：[event.preventDefault() vs. return false](https://stackoverflow.com/questions/1357118/event-preventdefault-vs-return-false)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:49:02.407

我更喜欢使用 onclick 而不是 href javascript 标记。但是，如果必须，请返回 false。它将停止浏览器的默认操作（更改 URL）。我首先知道这两个也没有不利的一面。避免使用第三个，它会导致页面在很长的页面上滚动并污染导航器的历史记录。

```
<a href="javascript:dostuff(); return false;">Do nothing</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T19:06:24.097

就个人而言，我更喜欢向链接“注入”操作，而不是混合 js 和 html。您不必以这种方式扫描 HTML 中的 javascript 行为。

使用 jQuery 的快速示例：http: [//jsfiddle.net/5nbXT/](http://jsfiddle.net/5nbXT/)

# c# - 如何在电子邮件中插入图像资源文件（而不是文件系统）中的图像？

> ID：10286314
> 
> 赞同：0
> 
> 时间：2012-04-23T18:41:14.970
> 
> 标签：c#, visual-studio-2010, email, embedded-resource

我正在尝试将签名图像插入从我的应用程序发送的电子邮件中。`LinkedResource`我知道如何使用and插入图像`AlternateView`，但那些使用文件系统中的文件。我正在尝试使用资源文件（例如`Properties.Resources.myLogo`）。如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:53:21.123

您需要从资源流中加载图像。[这个](https://stackoverflow.com/questions/1192054/load-image-from-resources-in-c-sharp)stackoverflow帖子应该解释如何做到这一点。

# c++ - 什么是精度？

> ID：10286316
> 
> 赞同：0
> 
> 时间：2012-04-23T18:41:18.600
> 
> 标签：c++, precision, mpfr

对于这个非常简单的问题，我无法在 Wikipedia（或 SO）或文档中找到答案。

整数表示的浮点数的精度如何？

我在. `MPFRC++`_ 可以选择*设置默认精度*，它需要一个整数作为参数。`MPFR``C++`

 *这样的整数是什么意思？

例如： `set_default_prec(128)`。

另外，我检查了`sizeof`各种默认精度，但它们似乎总是一样的？为什么？

例如：

set_default_prec(128); sizeof(mpfr::mpreal); // 16

set_default_prec(4096); sizeof(mpfr::mpreal); // 还是 16...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T18:47:52.813

`set_default_prec`无疑会改变分配用于存储数据的存储量（位数）。存储一个十进制数字大约需要 3.5 位，所以从那里你只需使用简单的数学来计算给定位数需要多少字节。

就`sizeof`保持不变而言，毫无疑问，您有一个结构（或类），它只包含一个指向实际数据的指针，按照这个一般顺序：

```
namespace mpfr {
    struct real { 
        char *data;
        size_t size_allocated;
        size_t size_inuse;
        size_t num_digits;
    };
} 
```

当您更改精度时，它会修改存储在 num_digits 中的值，以及可能`data`指向的块的大小，但结构的大小保持不变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:46:48.470

谷歌搜索“浮点”和“精度”可以找到您想要的一切。例如：

> [http://en.wikipedia.org/wiki/Floating_point](http://en.wikipedia.org/wiki/Floating_point)
> 
> 浮点表示在概念上类似于科学记数法。从逻辑上讲，浮点数包括：
> 
> 给定基数（或基数）中给定长度的有符号数字字符串。这个数字串被称为有效数、系数，或者较少见的尾数（见下文）。有效数字的长度决定了数字可以表示的精度。假设小数点位置总是在有效数字内的某个位置——通常就在最高有效数字之后或之前，或者在最右边（最低有效数字）的右侧。本文通常会遵循小数点位于最高有效（最左边）数字之后的约定。

换句话说：

1.  浮点数是“近似值”，不一定是*精确*值

2.  浮点数的“精度”决定了近似值的准确性。更多位意味着更高的精度（您的数字“更准确”）。更少的位意味着更少的精度（数字“更四舍五入”）。

3.  “精度”的数量可以并且表示为整数。

从 MPFR 网站：

> [http://www.mpfr.org/mpfr-current/mpfr.html#MPFR-Basics](http://www.mpfr.org/mpfr-current/mpfr.html#MPFR-Basics)
> 
> 浮点数，或简称浮点数，是具有有限精度指数的任意精度有效数（也称为尾数）。...
> 
> 精度是用来表示浮点数的有效位的位数；对应的 C 数据类型是 mpfr_prec_t。精度可以是 MPFR_PREC_MIN 和 MPFR_PREC_MAX 之间的任何整数。在当前实现中，MPFR_PREC_MIN 等于 2。 ...

当然，“set_default_prec()”是改变精度的机制（从“2”开始）。*

# maven - 使用 Maven 控制版本

> ID：10286318
> 
> 赞同：0
> 
> 时间：2012-04-23T18:41:21.893
> 
> 标签：maven

我的项目中有 3`poms`个，1 个用于父级，2 个用于每个`modules`正在使用的项目。

当前每个 pom 都包含`<version>2.1.9.0-SNAPSHOT</version>`标签

**每个模块是否可以自动从父模块中提取此信息？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:02:50.450

使用这里描述的[versions-maven插件：](http://mojo.codehaus.org/versions-maven-plugin/) [https ://stackoverflow.com/a/5726599/320180](https://stackoverflow.com/a/5726599/320180)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T05:15:07.527

在多模块构建中，只有父级应该定义工件的版本，除了父级。

```
 +-- root (pom.xml)
        +-- mod-1 (pom.xml)
        +-- mod-2 (pom.xml) 
```

所以根 pom.xml 看起来像（摘录）：

```
 <project...>
    <groupId>project.com.root</groupId>
    <artifactId>project-parent</artifactId>
    <version>1.0-SNAPSHOT</version>
    ... 
```

每个模块（mod-1）pom.xml 看起来像（摘录）：

```
 <project...>
     <parent>
       <groupId>project.com.root</groupId>
       <artifactId>project-parent</artifactId>
       <version>1.0-SNAPSHOT</version>
     </parent>

     <artifactId>mod-1</artifactId> 
```

特别是不应该在孩子中提及该版本。版本号的更改完全应该在发布周期内通过[maven-release-plugin完成。](http://maven.apache.org/plugins/maven-release-plugin/)有时，您可能会在具有大量模块的大型项目中更改子项中的 groupId。

# android - 是否有任何内置（即 R.android.*）选项卡图标可用于快速测试

> ID：10286321
> 
> 赞同：0
> 
> 时间：2012-04-23T18:41:47.993
> 
> 标签：android, android-layout, android-intent, android-activity, android-tabhost

1) Android 是否附带任何内置选项卡图标以在开发时用作占位符？我在这些东西中看到的所有条目`R.android.`都不像赢家，但也许我错过了一些东西...... 2）如果不是，以下是否有效？

```
spec = mTabHost.newTabSpec("ptSummary").setIndicator("Patient", null).setContent(getIntent()); 
```

并且 3) 使用 setContent，通过提供`getIntent()`，在该意图中必须具备什么才能使该代码有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:38:23.790

Android 团队也在他们的教程中提供了[这个图标](http://developer.android.com/resources/tutorials/views/images/ic_tab_artists_grey.png)。您可以随时保存并在每个选项卡上使用它。

或者，该`android:drawable`目录充满了小图标和诸如此类的东西，我相信您可以使用这些进行测试。您可以像这样在 xml 文件中轻松引用这些：

```
android:icon="@android:drawable/ic_menu_preferences"
android:icon="@android:drawable/ic_menu_help"
android:icon="@android:drawable/ic_menu_edit" 
```

# php - 如何获取喜欢 Facebook 页面的每个人的列表

> ID：10286323
> 
> 赞同：4
> 
> 时间：2012-04-23T18:41:53.513
> 
> 标签：php, facebook, facebook-graph-api, facebook-like

我会尽量简洁。

目标：获取喜欢我的 Facebook 页面的每个人的姓名列表。这将在该页面上安装的应用程序中完成。然后，该应用程序将用于创建彩票并选择获胜者。

到目前为止，我拥有的是：appId、appSecret 和一个访问令牌，我是该页面的管理员。我还在网上发现像这样的查询实际上可以满足我的需要：

> *SELECT user_id from like where object_id = \'PAGE_ID\';'*

**我的问题是：如何运行查询以使其正常工作？**

到目前为止，我已经尝试过，但我得到的只是一个空数组......

```
$result2 = $facebook->api(array(
        'method' => 'fql.query',
        'access_token' => 'TOKEN',
        'query' => 'SELECT user_id from like where object_id = \'APP_ID\';'
        ));
        ; 
```

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T18:47:56.410

这是不可能的 - 您只能检查特定用户是否喜欢该页面，或检索用户喜欢的页面列表（具有适当的权限），您无法检索喜欢特定页面的用户的完整列表

{edit}正如“查询大师”在现已删除的答案中所说，如果您的应用安装在页面选项卡上，您可以（通过`signed_request`发送到应用 -[此处的详细信息](https://developers.facebook.com/docs/authentication/signed_request/)）了解当前用户是否喜欢该页面，但是除非他们授权您的应用，否则您仍然无法获取他们的用户 ID{/edit}

# android - Android：将外部文件和文件夹存储为资产？资源？还有什么？

> ID：10286330
> 
> 赞同：1
> 
> 时间：2012-04-23T18:42:41.297
> 
> 标签：android, resources, assets

在我的 Android 应用程序中，我加载了一个文件和一个包含一堆文件的文件夹。我正在尝试确定这些是否应该作为资产、资源或其他东西完全添加。

该文件是一个 XML 文件，其路径被传递给一个类构造函数，该构造函数从文件中包含的内容创建一个对象。如果需要，我可以访问构造函数代码。

该文件夹包含一堆特殊格式的非人类可读文件。文件夹的路径被传递给另一个知道文件夹结构的构造函数并创建一个对象。我无权访问它的代码。

哦，这两者没有任何关系，除了它们是同一个应用程序需要的事实。

那么我应该如何存储这些呢？我首先考虑将它们添加为资产，但显然我只能获得不起作用的资产的输入流。如果我将文件夹添加为资源，它是否必须进入 res/ 下的特定子文件夹？哪一个？te XML 文件是否必须放在 res/xml 下？无论是资产还是资源，是否有我应该用来访问文件和文件夹的默认根路径？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:53:16.927

`res/xml/`出于性能原因，我会将 XML 文件放在 下。`res/xml/`支持任意 XML，所有 XML 编码的资源解析速度比解析普通文件快 10 倍左右。您的“从文件中包含的内容创建对象的类构造函数”将使用`XmlResourceParser`您从该`Resources`XML 的对象中获得的。

就文件夹而言，请使用`assets/`，因为您不能在资源中拥有文件夹结构（原始或其他）。

> 我首先考虑将它们添加为资产，但显然我只能获得不起作用的资产的输入流。

如果您希望将文件与您的应用程序打包并直接使用它们，您实际上别无选择。资源和资产都不能直接作为文件使用。将它们的内容作为文件获取的唯一方法是您自己使用流将它们复制到本地文件，这会增加它们占用的存储量，并且在 XML 的情况下会降低解析性能。

# c# - C# 变量连接

> ID：10286331
> 
> 赞同：1
> 
> 时间：2012-04-23T18:42:42.117
> 
> 标签：c#, variables, reference

做这样的事情

```
public Multime<T> Difference(Multime<T> list)
{
    Multime<T> diff = new Multime<T>();
    for (int i = 0; i < list.Multisets.Count() - 1; i++)
    {
        foreach (T el in list.multiSets[i].Multimea)
        {
            if (!(list.multiSets[i + 1].Multimea.Exists(element => EqualityComparer<T>.Default.Equals(element, el))))
                diff.Multimea.Add(el);

        }
        list.multiSets[i + 1] = diff;
        if (i < list.multiSets.Count() - 1)
            diff.Multimea.RemoveAll(item => EqualityComparer<T>.Default.Equals(item, item));
    }
... 
```

在也`diff.Multimea.RemoveAll(item => EqualityComparer<T>.Default.Equals(item, item));` 被`list.multiSets[i + 1]`清除之后。我该如何解决这个问题，这样他们就不会以这种方式连接，我不想`list.multiSets[i + 1]`被清除。

```
public Multime<T> this[int index]
{
    get { return this.multiSets[index]; }
    set { this.multiSets[index] = value; }
} 
```

如果有帮助，这是索引器:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:45:51.647

> 我也不想`list.multiSets[i+1]`被清零。

您必须填写一份副本：

```
//list.multiSets[i + 1] = diff;
  list.multiSets[i + 1] = diff.ToList(); 
```

您的`diff`和`list.multiSets[x]`值是*引用类型*。这意味着您的原始作业仅复制对列表的引用，而不是列表本身。`ToList()`是一种克隆列表的紧凑方法。

# regex - MVC DataAnnotations，1-2个数字的正则表达式匹配字符串

> ID：10286333
> 
> 赞同：0
> 
> 时间：2012-04-23T18:42:53.943
> 
> 标签：regex, asp.net-mvc-3, data-annotations

我需要将日期字符串匹配为 1 个或 2 个数字。

```
 [StringLength(2)]
 [RegularExpression(@"\d{1,2}", ErrorMessage = "Date must be 1- 2 numbers")]
 public string Date { get; set; } 
```

我需要对 Year 进行类似操作以匹配 4 位字符串。请问我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T18:54:51.320

有一个类似的问题，在这个问题上接受了答案[，](https://stackoverflow.com/questions/4374185/regular-expression-match-to-test-for-a-valid-year)它检查有效的年份。如果您需要，它会在答案中提供更多验证。

正则表达式不依赖于语言，因此如果您需要，您可以在网上检查任何语言的正确表达式。如果您想学习如何编写它们，您可以查看[网站](http://www.regular-expressions.info/)，有一个应用程序可以测试您的正则表达式。

对于日期，请查看[date regex](http://www.regular-expressions.info/dates.html)，或者如果您只想要答案：

```
(0[1-9]|[12][0-9]|3[01])$ 
```

它检查从 01 到 31 的日期

一年

```
(19|20)\d\d 
```

比赛 1900-2099 :D

# c# - 显示字符串文本而不是项目 ID

> ID：10286335
> 
> 赞同：0
> 
> 时间：2012-04-23T18:42:54.913
> 
> 标签：c#, asp.net-mvc, drop-down-menu

我想从下拉列表中显示以前选择的项目。到目前为止，我只获得了之前从下拉列表中选择的项目的 id 显示。我想获取项目的文本/描述名称而不是其 ID 号。

这就是我对 viewModel 的看法：

```
[LocalizedDisplayName("BillingRate", NameResourceType = typeof(User))]
    public short BillingRateId { get; set; }

    [UIHint("DropDownList")]
    [DropDownList(DropDownListTargetProperty = "BillingRateId")]
    public IEnumerable<SelectListItem> BillingRates { get; set; } 
```

这就是我的 .ascx 表单页面：

```
<%:Html.LabelFor(m => m.BillingRateId)%>
<%:Html.EditorFor(m => m.BillingRateId, Model.BillingRates)%>
<%:Html.ValidationMessageFor(m => m.BillingRateId)%> 
```

当我运行并查看页面时，我会进入描述框：4 什么时候应该是：实习

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:51:27.223

您可以创建一个仅返回该字符串的简单服务，然后使用 jQuery AJAX 填充它。

```
public ContentResult GetBillingRate(int id)
{
    //get your billing rate
    return this.Content(billing_rate_string, "text/plain");
} 
```

然后在你的javascript中：

```
$('#BillingRateId').change(function() {
    $.get('@Url.Action("GetBillinRate", "YourController")/' + $(this).val(),
        function(data) { $('#element_you_want_it_to_show_in').html(data); }
    );
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:46:25.183

另一种方法是制作您自己的 IEnumerable 并将其推送到您的 DropDownList 中。

在您的控制器中：

```
// this is assuming you can get objects with both name/id for your billing rates 
ViewBag.BillingRates = Db.GetBillingRatesAndNames()
    .Select(x => new SelectListItem() { Text = x.Name, Value = x.Id.ToString() }); 
```

在视图中：

```
<%:Html.EditorFor(m => m.BillingRateId, 
    (IEnumerable<SelectListItem>)ViewBag.BillingItems)%> 
```

# blackberry - 浏览器必须在后台加载和运行

> ID：10286336
> 
> 赞同：1
> 
> 时间：2012-04-23T18:42:59.723
> 
> 标签：blackberry, browser, java-me

下面的代码打开应用程序，浏览器加载并显示指定的 url。现在我想要的是浏览器在应用程序打开后在后台加载和运行。

```
public class start extends MainScreen {

    public start() {
        super();  // Call to super
        String url = ("http://www.google.com/");
        //A BrowserSession is created
        BrowserSession BS = Browser.getDefaultSession(); 
        BS.displayPage(url);
    }

    public boolean onClose() {
        System.exit(0);
        return true; // Close the system
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T09:02:53.447

在您调用`UiApplication.getUiApplication().requestForeground()`在浏览器中打开 url 后调用。

我不建议`System.exit()`在 UI 内调用。实际上，一旦关闭最后一个屏幕，UI 应用程序就会关闭。

# iphone - XCode4：更改 BundleID

> ID：10286340
> 
> 赞同：0
> 
> 时间：2012-04-23T18:43:14.850
> 
> 标签：iphone

我在 XCode 中创建了一个名为 say Foo 的应用程序。

当我决定发布这个应用程序时，我想将应用程序命名为 FooApp 而不是 Foo。所以，这就是创建的 bundleID。

现在的问题是 XCode 与 iTunesConnect 中的捆绑 ID 不匹配。

我试图编辑 info.plist 但它似乎把我的项目搞砸了，它根本不再运行。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:19:35.187

BundleID 不应更改，它是向 App Store 标识您的应用的字符串。

无需编辑“Bundle identifier”，您需要在 Build Settings 中修改“PRODUCT_NAME”项目，然后在 info.plist 中的“Bundle Name”和“Bundle Display Name”选项中输入 ${PRODUCT_NAME}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:52:27.970

我认为这是一个反常现象。我能够将门户上的捆绑 ID 与我的 plist.info 匹配。在我的例子中，我需要在我的项目中更改捆绑 ID，因为我在门户网站上创建了一个具有不同名称的捆绑 ID。

# iphone - 从 iPhone 到 Mac 的 Xcode QR 生成器

> ID：10286341
> 
> 赞同：-2
> 
> 时间：2012-04-23T18:43:15.090
> 
> 标签：iphone, xcode, macos, code-generation, qr-code

我试图 `https://github.com/kuapay/iOS-QR-Code-Generator/zipball/master`从 iPhone 应用程序转换为 Mac 应用程序。

当我设置代码时有很多失败。

如何将应用程序从 iPhone 转换为 mac？

[http://i44.tinypic.com/2s6kfhk.png](http://i44.tinypic.com/2s6kfhk.png)

[http://www.askapps.eu/download/QRGenerator.zip](http://www.askapps.eu/download/QRGenerator.zip)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:37:18.580

简单地看一下有问题的项目，很明显这是“你好，世界！” 二维码应用程序：它所做的只是将固定字符串转换为二维码并在视图中显示。有了 Cocoa 编程的基本知识，将应用程序转换为在 MacOS X 上运行并不难。但是，我认为更直接的策略是创建一个新的 MacOS X 应用程序，如下所示：

*   从 Xcode 中的模板创建一个新的 Cocoa 应用程序。添加一个视图控制器子类来管理您将添加到窗口中的图像。确保提供连接图像视图的插座。

*   将 QRDraw 和 libpng 文件夹添加到您的新项目中。

*   打开主 .xib 文件，其中将有一个空窗口。添加视图控制器的实例。将图像视图拖到窗口中，并将其连接到视图控制器的插座。

*   按照 iOS 项目中的示例，将一些代码添加到您的视图控制器类以创建新的 QR 码。将生成的图像加载到图像视图中。

这就是我想分解的。正如我所说，如果您了解 Cocoa 编程的基础知识，那么您应该能够轻松做到这一点。如果您之前没有编写过任何 Cocoa 程序，这将是一个很棒的入门项目。

此外，请确保在您的项目中启用了 Objective-C++。Inerdial 上面的评论基本上是正确的——链接图像中的错误似乎是由于编译器不期望 C++ 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-13T03:43:50.247

您可以尝试转换以下使用 Core Graphics 生成实际 QR 码图像 (UIImage) 的演示 iPhone 应用程序。我没有在 Mac 上尝试过，但它可以在很少或根本没有修改的情况下工作。

[http://www.oscarsanderson.com/2013/08/12/implementing-a-qr-code-generator-on-the-iphone/](http://www.oscarsanderson.com/2013/08/12/implementing-a-qr-code-generator-on-the-iphone/)

# java - 行号和文本文件 Java

> ID：10286342
> 
> 赞同：3
> 
> 时间：2012-04-23T18:43:31.697
> 
> 标签：java

我正在为我的期末考试而学习，我想知道是否有一种特殊的方式可以打印出文本文件中一行的数据。例如，如果我在文本文件中有以下内容：

```
11 
1c20 
203 
G2 
```

我想知道是否有一种方法可以输入例如 2 ,4 我会得到输出 1c20 203 G2。通过使用两个整数开始和结束。我对这种方法进行了研究，但找不到任何东西。我知道有一个 getLineNumber() 但我想使用这两个整数。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:46:15.253

这是一个选项（带指针）：

1.  [读取输入](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html)并将它们存储在两个变量`start`中`end`
2.  使用 读取每一行[`BufferedReader#readLine`](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedReader.html#readLine%28%29)，增加每行的计数器
3.  如果行号在范围内，则打印该行。
4.  当计数器到达`end`时，从循环中中断。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T18:50:19.783

您可能想看看 java.io.LineNumberReader：[http ://docs.oracle.com/javase/6/docs/api/java/io/LineNumberReader.html](http://docs.oracle.com/javase/6/docs/api/java/io/LineNumberReader.html)

请注意，行号从 0 开始

试试这个：

```
import java.io.*;

/*
 * Usage: java LinePrinter <start> <end>
 * Example: java LinePrinter 2 4
 */
public class LinePrinter
{
    public static void main(String[] args)
    {
        int start = Integer.parseInt(args[0]);
        int end = Integer.parseInt(args[1]);

        LineNumberReader reader = null;
        String line = null;
        boolean flag = false;

        try
        {
            reader = new LineNumberReader(new FileReader("data.txt"));

            while ((line = reader.readLine()) != null)
            {
                if (reader.getLineNumber() == start)
                {
                    flag = true;
                }

                if (flag)
                {
                    System.out.println(line);
                }

                if (reader.getLineNumber() == end)
                {
                    flag = false;
                    break;
                }
            }
        }
        catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T19:08:00.397

假设您的文件名为 data.txt，您可以使用 sed 显示第 3 到 5 行，如下所示：

$> sed -n '3,5p' data.txt

# c - 全局结构指针初始化

> ID：10286347
> 
> 赞同：2
> 
> 时间：2012-04-23T18:43:47.457
> 
> 标签：c, struct, initialization, global

## 结构定义

```
struct list
{
  struct list **next, **prev;
} 
```

## 核心.c

```
//Global struct
struct list *threads = {&threads, &threads};  //Warnings here:

// warning: initialization from incompatible pointer type
// warning: excess elements in scalar initializer
// warning: (near initialization for 'threads') 
```

PS：我在这个文件中没有`main`函数。这必须是全球性的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:52:02.667

您需要使用指向 a 的指针初始化*指向结构列表*`threads`的指针变量`struct list`。`{&threads, &threads}`不是指向 a 的指针`struct list`，但它可能是 a `struct list`。

为了定义一个实际的结构实例并获得指向它的指针，您可以使用*复合文字*并获取其地址：

```
struct list *threads = &((struct list){&threads, &threads}); 
```

（注意：复合文字是 C99 的一个特性；一些没有赶上 13 年前标准的编译器可能会拒绝它。）`((*type*){*initializer*})`

# c# - 需要帮助来解决和理解此错误：异常详细信息：System.InvalidOperationException：2

> ID：10286353
> 
> 赞同：1
> 
> 时间：2012-04-23T18:44:07.683
> 
> 标签：c#, database, razor, webmatrix

我收到了这个错误：

> 异常详细信息：System.InvalidOperationException：2：字符串截断：max=0，len=1，value='3'。

从这组代码中：

```
var reqcategory=Request["category"];
foreach (var cat in reqcategory)
{
    var sql5 = "SELECT Type.PreReq1, Type.PreReq2, 
                       (CASE WHEN (Type.PreReq1 IS NOT NULL)
                             AND (PermitApp1.RPClass IS NULL) 
                             AND (PermitApp1.RPCategory IS NULL) 
                        THEN 1 ELSE 0 END) AS missing1, 
                       (CASE WHEN (Type.PreReq2 IS NOT NULL) 
                             AND (PermitApp2.RPClass IS NULL)
                             AND (PermitApp2.RPCategory IS NULL) 
                        THEN 1 ELSE 0 END) AS missing2 
                FROM Type LEFT JOIN PermitApp AS PermitApp1 
                     ON (Type.PreReq1=PermitApp1.RPClass) 
                       OR (Type.PreReq1=PermitApp1.RPCategory) 
                           AND ( PermitApp1.CDSID = @0 ) 
                           AND (PermitApp1.MDecision='1') 
                          LEFT JOIN PermitApp AS PermitApp2 
                     ON (Type.PreReq2=PermitApp2.RPClass) 
                       OR (Type.PreReq2=PermitApp2.RPCategory) 
                           AND ( PermitApp2.CDSID = @1 ) 
                           AND (PermitApp2.MDecision='1') 
                WHERE Type.PType = @2";

    var result = db.QuerySingle(sql5, myCDSID, username, cat);
    var miss1 = result.missing1;
    var miss2 = result.missing2;

    if(miss1 == '1' || miss2 == '1'){
        ModelState.AddError("missing", 
                  "You have not met the Pre-Requisites for "+ cat +" yet.");
    } else if (miss1 == '0' && miss2 == '0'){
        Session["license"] = Request["licence"];
        Session["from"] = Request["from"];
        Session["to"] = Request["to"];
        Session["group"] = Request["group"];
        Session["class1"] = Request["class1"];
        Session["category1"] = Request["category1"];
        Session["class"] = Request["class"];
        Session["category"] = Request["category"];
        Response.Redirect("~/Questionnaire");
    }
} 
```

突出显示的行是：

```
var result = db.QuerySingle(sql5, myCDSID, username, cat); 
```

我不明白错误页面上提到的内容，也找不到与我的情况相同的人。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T14:15:04.830

好吧，我不能代表您的 SQL 查询，因为我认为我从未见过这样的查询，但根据我的经验，当进行查询并返回错误时，只要它是一个有效的 sql 查询，这意味着必须“截断”一个字符串，因为数据库字段设置为存储的字符少于您尝试传递到该字段的字符。

也就是说，作为一个例子，一个字符串，比如 60 个字符长，被传递到一个设置为 nvarchar(50) 的字段中。尝试调整允许存储在字符串字段中的字节数。

不完全确定这是否是您的问题，因为我自己对很多事情还是陌生的，但只是认为这可能是一种可能性，因为我以前见过几次发生这种情况。

希望我有所帮助！

# c# - 从其他表单访问函数

> ID：10286357
> 
> 赞同：0
> 
> 时间：2012-04-23T18:44:47.233
> 
> 标签：c#, winforms

我正在用 c# 编写程序，它使用列表框作为其主要形式的选择方法。它具有可以编辑列表框中项目的功能。

我想从一个单独的专用表单中编辑项目，所以我创建了一个新的表单实例，但是每当我尝试访问原始表单的功能（我已公开）时，我都会收到此错误：错误 2 需要对象引用对于非静态字段、方法或属性

我在互联网上看了很多次，但我看到的只是人们在谈论在我的函数上使用静态属性。但是，当我这样做时，我会在函数中的变量等上弹出更多上述错误

这是 Form1 中的函数（我试图引用）

```
public void ReadConfig(string configFile)
    {
        fileList.Clear();
        listBoxName.Items.Clear();
        FileStream file = null;

        if (!File.Exists(file))
        {
            MessageBox.Show(file + " was not found: Creating blank file");
            using (file = File.Create(file)) ;
        }
        else
        {
            string line;
            int lineNumber = 1;

            // I cut out some long code here where the program reads from a file and saves it to an object
        }
    } 
```

这是发生错误的代码片段（我剪切了一些代码，将其保存到文本文件中，但主要关注的部分是 Form1.ReadFile(Form1.file)

```
 private void buttonSave_Click(object sender, EventArgs e)
    {
        string[] temp = File.ReadAllLines(Form1.file);
        string[] newFile;

        if (itemNew == true)
        {
            newFile = new string[temp.Length + 1];
        }
        else
        {
            newFile = new string[temp.Length];
        }

        for (int i = 0; i < temp.Length; i++)
        {
            newFile[i] = temp[i];
        }
        File.WriteAllLines(Form1.file, newFile);
        ConfigForm.ReadFile(Form1.file);

        this.Close();
    } 
```

我希望有足够的代码可以关闭。我的程序很长，所以我尽量保持简短和直接。谢谢你对我的耐心=]

我在编程方面很新，所以如果有任何善良的灵魂碰巧帮助你，你能让它尽可能简单吗？

非常感谢=]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:18:06.927

这可能是因为您尝试使用存在于第二个窗口中的第一个窗口中的函数，就好像它们是静态的一样，但它们不是。

您可以尝试通过以下方式解决此问题：

*   在**第二种**形式中，使用第一种形式的类创建一个属性，例如：

    ```
    class Form1 : Form
    {
        //this property will store reference to the first form
        public Form1 AssociatedFirstForm { get; set; }
        //...
    } 
    ```

*   然后**在您创建第二个表单的代码中**，将第一个表单分配给该属性，如下所示（如果您从第一个表单创建第二个表单）：

    ```
    ...
    Form2 secondForm = new Form2();
    secondForm.AssociatedFirstForm = this;
    ... 
    ```

或像这样（如果您从代码的另一部分创建这两种形式）：

```
 ...
    Form1 firstForm = new Form1();
    Form2 secondForm = new Form2();
    secondForm.AssociatedFirstForm = firstForm;
    ... 
```

*   然后，在您的**第二种**形式中，您应该能够从第一种形式调用一个方法，如下所示：

    ```
    ...
    var myResultFromAnotherWindow = this.AssociatedFirstForm.SampleMethodToCall();
    ... 
    ```

我想您还应该阅读有关使用[静态类和类成员](http://msdn.microsoft.com/en-us/library/79b3xss3%28v=vs.80%29.aspx)以及[创建对象实例的](http://msdn.microsoft.com/en-us/library/k6sa6h87%28v=vs.80%29.aspx)更多信息。它应该让您清楚如何以及何时使用它们。

**更新**

我写得不够清楚，但是如果不是真的需要，您应该避免将公开方法或属性设置为公共。

如果您想在应用程序中创建良好的代码结构并了解应该如何完成，请查找有关面向对象编程的文章。

一些示例链接：

*   [http://www.c-sharpcorner.com/UploadFile/tusharkantagarwal/objectorientatedcsharp11162005070743AM/objectorientatedcsharp.aspx](http://www.c-sharpcorner.com/UploadFile/tusharkantagarwal/objectorientedcsharp11162005070743AM/objectorientedcsharp.aspx)
*   [http://msdn.microsoft.com/en-us/library/dd460654.aspx](http://msdn.microsoft.com/en-us/library/dd460654.aspx)

了解***事件机制***也很有用：http: [//msdn.microsoft.com/en-us/library/awbftdfh.aspx](http://msdn.microsoft.com/en-us/library/awbftdfh.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:09:35.213

您正在调用类型而不是类型实例的方法。当方法未声明为静态时，您需要首先实例化包含这些方法的对象（使用 new）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T20:17:58.383

这是您要实现的目标的基本概念。一种更高级的方法是使用委托/事件处理程序，但现在想保持简单。

表格 1

```
 public Form1()
    {
        InitializeComponent();
    }

    List<string> _items = new List<string>();

    public void LoadListBoxWithItems()
    {
        for (int i = 0; i < 5; i++)
        {
            _items.Add(string.Format("My New Item {0}", i));
        }
        lbItems.DataSource = _items;
        lbItems.Refresh();
    }

    private void btnUpdate_Click(object sender, EventArgs e)
    {
            Form2 form2 = new Form2();
            form2.LoadValues(lbItems.SelectedItem.ToString(), this);
            form2.ShowDialog();
    }

    public string GetCurrentItem()
    {
        return lbItems.SelectedItem.ToString();
    }

    public void UpdateItem(string item, string newitem)
    {
        int index = _items.IndexOf(item);
        _items[index] = newitem;
        lbItems.Refresh();
    } 
```

表格 2

```
 public Form2()
    {
        InitializeComponent();
    }

    private string _originalvalue = null;
    private Form1 _form1;

    public void LoadValues(string item, Form1 form)
    {
        _originalvalue = item;
        _form1 = form;
    }

    private void btnSave_Click(object sender, EventArgs e)
    {
        // Do work to change value
        string newvalue = _originalvalue;
        _form1.UpdateItem(newvalue, _originalvalue);
    } 
```

# javascript - 使用了 POST 请求，但 responseText 仍然不完整。为什么？

> ID：10286358
> 
> 赞同：1
> 
> 时间：2012-04-23T18:44:50.010
> 
> 标签：javascript, post, xhtml, xmlhttprequest

我只是想在[http://www.w3.org/](http://www.w3.org/)中遍历 XHTML 中的所有 div 元素。我将 HTML 复制到 w3c.html 并运行以下代码。但是由于我的代码失败，responseText 并不完整。

我最初使用 GET 请求，我认为这是问题（认为是问题），但它仍然没有解决问题。

```
function traverseHtml()
{
var xmlhttprequest=new XMLHttpRequest();
xmlhttprequest.open('POST','w3c.html',false);
xmlhttprequest.send(null);
var respText=xmlhttprequest.responseText;
alert('The ResponseText is '+respText);
/*var xml=(new DOMParser()).parseFromString(respText,'text/xml');
var result=xml.evaluate('//div',xml,null,XPathResult.ANY_TYPE,null);
var node=result.iterateNext();
alert(node);
while(node)
{
alert(node.childNodes[0].nodeName);
node=result.iterateNext()
}
*/
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T18:56:16.747

您不能在发送请求后立即使用 responseText 属性。您需要创建一个在完成后将被调用的函数，如下所示：

```
var xmlhttprequest;

xmlhttprequest = new XMLHttpRequest();
xmlhttprequest.open('GET', 'w3c.html', true);
xmlhttprequest.send();
xmlhttprequest.onreadystatechange = function () {
    // Check if request done and it didn't fail
    if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
        alert('The ResponseText is '+xmlhttp.responseText);
    }
} 
```

# c++ - 还有哪些其他语言可以通过指针操作创建数组？

> ID：10286360
> 
> 赞同：0
> 
> 时间：2012-04-23T18:44:55.167
> 
> 标签：c++, arrays, recursion, traversal

我们在我的 C++ 类中编写了以下递归函数。

```
bool contains(int arr[], int n, int val){
  if(n == 0) return false;          // Escape clause
  if(arr[0] == val) return true;  // Second escape clause
  return contains(arr+1, n-1, val);
} 
```

我的教授说 C/C++/Assembler 是唯一支持这种数组遍历的主流语言。还有哪些其他语言允许通过更改指针地址进行这种搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:47:15.813

所有支持数组数字索引的语言都适用于这种通用算法。它与指针操作无关。

指针操作通常用于 C 中基于字符串的算法。例如，可以`strlen`按如下方式实现。

```
size_t strlen(char* pValue) {
  char* pStart = pValue;
  while (*pValue != '\0') {
    pValue++;
  }
  return pValue - pStart;
} 
```

`char[]`此代码在 a或`char*`输入上同样适用。这种类型的指针操作确实仅限于以这种方式公开指针和公开数组的语言。

不过，这不仅限于 C/C++/Assembler。也可以用 C# 来完成

# eclipse - Eclipse 的 CoffeeScript 编辑器插件？

> ID：10286364
> 
> 赞同：21
> 
> 时间：2012-04-23T18:45:09.107
> 
> 标签：eclipse, eclipse-plugin, coffeescript

这是交易，我使用 Wro4j 处理 .coffee 文件到 .js 文件的转换/“构建”。

现在我想要一个支持 CoffeeScript 的好编辑器插件，我不想安装 Aptana（我只需要 CoffeeScript，而不是 Python、Ruby 和它包含的所有其他东西，并且不允许我选择不安装。 ..)。

非常感谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-23T18:51:10.780

你试过 coffeescript-eclipse 插件吗？

[https://github.com/adamschmideg/coffeescript-eclipse](https://github.com/adamschmideg/coffeescript-eclipse)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T15:14:42.397

除了 CoffeScript-Eclipse：[https](https://github.com/adamschmideg/coffeescript-eclipse) ://github.com/adamschmideg/coffeescript-eclipse （BluesRockAddict 提到），我知道的其他选择是：

LiClipse：[http ://brainwy.github.io/liclipse/](http://brainwy.github.io/liclipse/)

Aptana Studio 3： http: [//www.aptana.com/products/studio3](http://www.aptana.com/products/studio3)

# ruby-on-rails - 在 Rails 表单中验证非模型字段

> ID：10286365
> 
> 赞同：0
> 
> 时间：2012-04-23T18:45:10.020
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

在我的 Rails 3.2 应用程序中，我有一个包含“条款和条件”复选框的注册表单。表单看起来像这样：

```
<%= form_for @user do |f| %>
  <!-- Error message stuff -->
  <%= f.text_field :email %>
  <!-- More fields... -->
  <%= text_field_tag :terms_and_conditions, false, "true" %>
<% end %> 
```

为了确保用户选中该复选框，我的控制器中有以下代码：

```
unless params[:terms_and_conditions] == "true"
  @user.errors[:base] << "You must check the 'Terms and Conditions' checkbox"
end 
```

但是当我调用`@user.save`（或`@user.valid?`）时，它似乎清除了这个错误信息。我知道我可以使用`@user.errors.empty? && @user.save`，但我觉得奇怪的是该`save`方法不关心我刚刚添加的错误消息。有没有更好更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:51:14.423

Rails 提供了一个验收验证器。它非常适合您的情况。有关更多信息，请参阅[文档](http://guides.rubyonrails.org/active_record_validations_callbacks.html#acceptance)。

# php - 如何根据会话变量值限制对文件夹及其内容的访问

> ID：10286366
> 
> 赞同：1
> 
> 时间：2012-04-23T18:45:21.653
> 
> 标签：php

我正在建立一个网络目录网站，我将所有与管理员相关的页面放在一个名为“管理员”的文件夹中。如何限制对该文件夹及其文件 (.php .html..) 的访问，以便只有管理员可以访问它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:45:21.043

好的。我找到了解决方案。它不完全是我问的（它不使用会话变量），但它完成了工作

[http://davidwalsh.name/password-protect-directory-using-htaccess](http://davidwalsh.name/password-protect-directory-using-htaccess)

# css - Wordpress 中 IE 的条件 CSS 不起作用

> ID：10286370
> 
> 赞同：0
> 
> 时间：2012-04-23T18:45:44.760
> 
> 标签：css, wordpress, internet-explorer, conditional, stylesheet

`enter code here`我知道这已经被提出了很多次，但我真的很难找到答案。

我目前正在使用以下代码：

```
<!--[if IE 9]>
    <style type="text/css">@import "<?php bloginfo('stylesheet_directory'); ?>/ie.css";</style>
<![endif]-->
<!--[if IE 8]>
    <style type="text/css">@import "<?php bloginfo('stylesheet_directory'); ?>/ie8.css";</style>
<![endif]--> 
```

但是，第一个样式表根本不支持，而 IE8 的样式表只在 IE9 中支持。我真的不知道我在这里做错了什么。

使用严格的 XHTML。任何帮助将不胜感激。

哦，也是的，我的主要重置和其他样式表在这些之上。我也在使用 Wordpress——这应该没什么区别。

**编辑：**

这里有更多细节

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-    strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title><?php bloginfo('name'); ?> <?php wp_title(); ?></title>
        <link rel="stylesheet" href="<?php bloginfo('stylesheet_directory'); ?>/reset.css" type="text/css" />
        <link rel="stylesheet" href="<?php bloginfo('stylesheet_url'); ?>" type="text/css" />
        <!--[if IE 9]>
        <link href="<?php bloginfo('stylesheet_directory'); ?>/ie.css" type="text/css" rel="stylesheet" />
        <![endif]-->
        <!--[if IE 8]>
        <link href="<?php bloginfo('stylesheet_directory'); ?>/ie8.css" type="text/css" rel="stylesheet" />
        <![endif]-->
        <link href='http://fonts.googleapis.com/css?family=Averia+Serif+Libre:400,700' rel='stylesheet' type='text/css' />
        <link href='http://fonts.googleapis.com/css?family=Droid+Sans:400,700' rel='stylesheet' type='text/css' /> 
```

然后我在头脑中编写一些 JavaScript 并调用 Jquery。没有什么不寻常的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:15:31.410

假设这些位于文档`head`中，请尝试将它们替换为：

```
<!--[if IE 9]>
    <link href="<?php bloginfo('stylesheet_directory'); ?>/ie.css" type="text/css" rel="stylesheet" />
<![endif]-->
<!--[if IE 8]>
    <link href="<?php bloginfo('stylesheet_directory'); ?>/ie8.css" type="text/css" rel="stylesheet" />
<![endif]--> 
```

# javascript - 动态 JavaScript 驱动页面的 SEO

> ID：10286375
> 
> 赞同：-1
> 
> 时间：2012-04-23T18:45:59.560
> 
> 标签：javascript, dynamic, seo

我正在为我的最新项目开发一个网页。有点晚了，我不得不为搜索引擎优化它。

我想我能猜到答案，但我不喜欢猜...

当用户单击链接时，我使用 jQuery 获取新内容并将其动态添加到页面中。谷歌是否以某种方式抓取 .js 部分？或者它只是我在查看它使用的源代码时可以看到的链接？

机器人文件可以找到我使用 .js 获取的那些文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:47:56.610

不，网络爬虫不适用于 JavaScript 驱动的网页。对于没有 JavaScript 和爬虫的用户，您需要一个纯 HTML 后备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:50:33.127

谷歌的搜索引擎索引机器人不解析 javascript，因此如果没有启用 javascript 的页面上不存在这些链接（或单击它们时加载的内容），则它们不会被编入索引。

阅读“Deep Web”（特别是[“Deep Resources”](http://en.wikipedia.org/wiki/Invisible_Web#Deep_Resources)）

这是 ajax 的一个相当大的问题，解决方案并不复杂，但基本上会使您的编程（和设计工作量可能）加倍：

您需要确保当 javascript 关闭时链接确实链接到内容页面，但如果启用 .js，那么您可以编写函数来停止 DOM 事件在树上传播并导致页面导航（在 jquery这是[event.preventDefault()](http://api.jquery.com/event.preventDefault/) ) 而是做你的 ajax 加载

# delphi - CryptoAPI CryptImportKey 失败并显示 ERROR_INVALID_PARAMETER 但导入密钥

> ID：10286380
> 
> 赞同：1
> 
> 时间：2012-04-23T18:46:31.827
> 
> 标签：delphi, winapi, cryptography, cryptoapi, pkcs#12

我正在尝试从 PKCS#12 文件中导入 RSA 私钥。我正在使用 OpenSSL 解析 P12，然后尝试使用 CryptImportKey 将密钥导入 CSP（“标准”增强型 RSA 提供程序）。

Ï 创建 blob 的方式与我使用 CryptExportKey 从 CSP 导出密钥时获得的方式完全相同。

最后，我不想使用任何会话加密，因为我只是解析加密文件并将其存储到 CSP 中。如果我使用

```
publickeystruc.aiKeyAlg := CALG_RSA_KEYX; 
```

和

```
if not CryptImportKey(tmpprovider,addr(privkey),dwBlobLen,0,flags,hPubKey) then 
  errorCode := GetLastError; 
```

（所以关键参数为 0）然后函数失败，我得到 ERROR_INVALID_PARAMETER 错误。但是密钥被导入并且可以正常工作（我试图用它签名，如果它被标记为可导出，我就可以导出它）。

变量声明如下：

```
 hpubkey:PHCRYPTKEY;
 privkey:privkeyblob; 
```

在哪里

```
 HCRYPTKEY   = ULONG;
  PHCRYPTKEY  = ^HCRYPTKEY; 
```

其余的是整数和基数...

问题解决了，这是一个非常愚蠢的错误。当我在函数开始时将它归零时，我忘记取消引用最后一个参数，所以而不是

```
hPubKey^:=0; 
```

我有

```
hPubKey := 0; 
```

感谢 TLama 为我指明了正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:36:38.817

您写道，您尝试从 PKCS#12 文件中导入私有 RSA 密钥。在我看来，您应该使用[PFXImportCertStore](http://msdn.microsoft.com/en-us/library/windows/desktop/aa387314%28v=vs.85%29.aspx)来执行此操作。您可以在[此处](https://stackoverflow.com/a/5741893/315935)找到导入模式。如果您只需要获取私钥并将其保存在其他地方，您可以使用`CertAddCertificateContextToStore`to替换该步骤`CertGetCertificateContextProperty`。*自动*`PFXImportCertStore`创建密钥容器的调用。使用with将为您提供 CRYPT_KEY_PROV_INFO 的密钥[容器](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381420%28v=vs.85%29.aspx)。*`CertGetCertificateContextProperty``CERT_KEY_PROV_INFO_PROP_ID``pwszContainerName`*

# asp.net-mvc-3 - 如何使用 POST 重定向 ASP.NET MVC？

> ID：10286382
> 
> 赞同：2
> 
> 时间：2012-04-23T18:46:34.523
> 
> 标签：asp.net-mvc-3

我正在为一个网站设置一个支付页面，首先完成一个简单的购物车，然后当用户点击“提交”时，我需要将交易数据发布到外部信用卡处理网站，并将用户重定向到那个网站。一旦他们在那里输入了他们的信用卡详细信息，该网站就会重定向回我，无论是批准还是拒绝。

麻烦的是，我在 MVC 界面中看不到任何允许我使用 POST 操作重定向的内容。该`Redirect()`方法使用 GET（在 3rd 方站点上无论如何都不起作用）。我尝试使用 做一个程序化的帖子`WebClient.UploadValues()`，然后我从那个字符串中返回，我可以通过返回来呈现给用户`Content()`- 但是该表单内的链接应该与 CC 处理站点相关，而是被解释为相对于我的网站，这对我来说没什么用。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:03:41.247

您不能使用帖子重定向。

但是，您可以这样做：

*   接收帖子并在上面做事
*   向用户返回一个视图，其中包含一个填充了包含已处理数据的隐藏字段的表单
*   使用 javascript 自动提交表单（在您的 CC 提供商上设置发布操作）
*   用户前往抄送提供商
*   用户返回您的网站

编辑 - 使用 jQuery，表单 ID 为 ccform 的表单发布，操作设置为 cc 提供者的 URL 和隐藏字段：

```
$.ready(function() { $('#ccform').submit(); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:51:20.333

根据您的信用卡处理提供商，机制可能会有所不同。通常，您可以使用带有 URL 参数的 GET，然后他们将使用这些参数来填充会话并重定向到收集信用卡信息的表单，或者更有可能使用他们的 URL 作为结帐页面上的操作这样它就可以直接发布到他们的网站上。检查您的提供商的文档和示例，因为该机制将取决于他们支持的内容。

# android - 以编程方式测量 9-patch 的各个部分

> ID：10286384
> 
> 赞同：0
> 
> 时间：2012-04-23T18:46:50.077
> 
> 标签：android, nine-patch

是否有 Android API 或其他方法可以用来找出 9-patch 的内容区域有多高？我的应用程序上有动态样式的内容，需要确保字体大小对于按钮来说永远不会太大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:02:08.320

也许我不明白你.. 但 9-patch 的目的之一是动态地扩展内容。因此，如果您使用 android sdk 文件夹中的工具创建格式良好的 9 补丁，则字体大小无关紧要，按钮将扩展到它。如果需要，您还可以设置按钮的最大高度。

# javascript - 为什么 JSON.stringify() 接受 Date 对象？

> ID：10286385
> 
> 赞同：12
> 
> 时间：2012-04-23T18:46:50.127
> 
> 标签：javascript, json, date

至少在 Firefox 中，您可以对 Date 对象进行字符串化：

```
>>> JSON.stringify({'now': new Date()})
'{"now":"2012-04-23T18:44:05.600Z"}' 
```

这是有效的，因为（在 Firefox 中）`Date`包含`toJSON`其 JSON 序列化程序使用的方法。但是，这不是 JSON 标准的一部分，所以我想知道为什么存在这种方法，或者更确切地说，为什么内置 JSON 序列化程序会检查这种方法。由于它不是标准化的，如果不首先测试内置序列化程序是否理解它，则无论如何都不能安全地使用它，否则使用自定义序列化程序（例如[json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-23T19:08:02.050

这是有效的，因为它是在规范中以不太明确的方式指定的。首先，您需要深入了解抽象操作**Str的描述中的第****[15.12.3](http://es5.github.io/#x15.12.3)**节，该操作用于将值转换为字符串表示形式。本质上，如果输入是一个对象，规范要求检查是否存在名为 的可调用值。将其视为 Java 或 C# 中的接口。**`toJSON`**

 **```
interface IAmJSON 
{
    string toJSON(string key);
} 
```

这是规范中的确切文本。

```
2\. 如果 Type(value) 是 Object，那么
    一种。让 toJSON 成为使用参数“toJSON”调用 [[Get]] 内部值方法的结果。
    湾。如果 IsCallable(toJSON) 为真
        一世。令 value 为调用 toJSON 的 [[Call]] 内部方法的结果，将 value 作为 this 值传递，并带有一个由 key 组成的参数列表。

```

最后，日期对象已`toJSON`在第**[15.9.5.44](http://es5.github.io/#x15.9.5.44)**节中定义。**

# javascript - 如何在javascript中将字符串方程转换为数字？

> ID：10286386
> 
> 赞同：2
> 
> 时间：2012-04-23T18:46:59.510
> 
> 标签：javascript, jquery, html

如何在javascript中将字符串方程转换为数字？

假设我有“100*100”或“100x100”我如何评估它并转换为数字？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T18:48:59.893

如果您确定字符串总是类似于“100*100”，您可以`eval()`这样做，尽管大多数人会告诉您这不是一个好主意，因为人们可能会将恶意代码传递给 eval 'd。

```
eval("100*100");
>> 10000 
```

否则，您将不得不查找或编写自定义方程解析器。在这种情况下，您可能想看看[Shutting-yard algorithm](http://en.wikipedia.org/wiki/Shunting-yard_algorithm)，并阅读[parsing](http://en.wikipedia.org/wiki/Parsing)。

* * *

使用`split()`：

```
var myEquation = "100*100";
var num = myEquation.split("*")[0] * myEquation.split("*")[1];
>> 10000 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-23T18:53:25.047

这将为您提供字符串是否正在使用的产品`*`或`x`：

```
var str = "100x100";

var tmp_arr = str.split(/[*x]/);
var product = tmp_arr[0]*tmp_arr[1];   // 10000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T18:57:49.467

使用 parseInt() ，parseInt() 函数解析一个字符串并返回一个整数。

```
 parseInt("100")*parseInt("100") //10000 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-03T13:19:37.323

我对这里的用户答案有不同的看法，它使用 split 给出输出，但也重新创建了原始方程。我看到的其他答案使用 split 但并没有真正给出可以参数化原始方程的相关性，以开始为字符串格式。

使用`split()`and`for`不是一个好的解决方案，但我在这里使用它来说明不需要知道数组中数字的数量（这将减少）的更好的解决方案。这样做的原因是它实际上就像 reduce 一样，但它需要您根据数组的大小来编辑 for 循环乘数：

```
let someEnvironmentVariable = '3*3*3'
let equationString = someEnvironmentVariable;
// regex to match anything in the set i.e. * and + << not sure if need the ending +
let re = /[\*\+]+/;
let equationToNumberArray = equationString.split(re).map(Number);
let equationResolver = 0;
for (const numericItem of equationToNumberArray) {
  // recreate the equation above
  equationResolver += numericItem*numericItem;
}

console.log(equationResolver); 
```

一个更优雅的解决方案是使用 `split()`:`map()`和`reduce()`

```
let someEnvironmentVariable = '3*3*4*3'
let equationString = someEnvironmentVariable;
// regex to match anything in the set i.e. * and + << not sure if need the ending +
let re = /[\*\+]+/;
let equationToNumberArray = equationString.split(re).map(Number);

let arrayMultiplier = equationToNumberArray.reduce((a, b) => a * b);

console.log(arrayMultiplier); 
```

使用 reduce 允许您遍历数组并对每个项目执行计算，同时保持对前一个项目的先前计算。

注意：我不喜欢这两种解决方案的一点是，即使是 reduce 也只需要一个数组集的数学运算。更好的解决方案是编写检测运算符并将其包含在整体解决方案中的代码。这使您可以不使用可怕的`eval()`但也保持原始方程不变以供以后处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-03T14:30:56.507

一个班轮：

```
str.split(/[x*]/).reduce((a,b) => a*b) 
```

# javascript - 用于布尔返回的 Javascript 函数

> ID：10286393
> 
> 赞同：3
> 
> 时间：2012-04-23T18:47:19.890
> 
> 标签：javascript, boolean, equality

我在 Codecademy 的 Javascript 教程的第 4.1 节中获得正确的布尔返回时遇到了一些问题。这是代码：

```
// Define quarter here.
var quarter = function(n) {
    if (n / 4 ){
        return true;
    } else {
        return false;
    }
};

if (quarter(4) === 1) {
  console.log("The statement is true.");
} else {
  console.log("The statement is false.");
} 
```

从我所见，我将新定义的四分之一变量传递给一个参数为“n”的函数，然后将其除以 4，看看它是否返回 1 表示真，或 0（否则）表示假。然后，我在 if 循环中使用“四分之一”函数来检查作为“n”传递的数字“4”的 1 是否相等。

我假设这是一些我不习惯使用的基本逻辑（作为一个希望进入 JavaScript 编程的前端开发人员），但我肯定会感谢一些想法和指导。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-23T18:50:56.917

**在 JavaScript 中，**常量`true`和`false`不是数字；他们是一个单独的类型。

 **此外，您正在比较`===`并且将在比较期间显式阻止类型转换。

请注意，除了 0 之外的所有“n”值`n / 4`都将是`true`（非零）（*编辑*您可能打算使用`%`）。通常，任何形式的构造：

```
if (expression) {
  return true;
}
else {
  return false;
} 
```

可以替换为：

```
return !!(expression); 
```

或者，或者，

```
return Boolean(expression); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T18:51:18.010

将您的 if 语句更改为一致，因为 1 != true。三等号不允许这样做。

```
if (quarter(4) == true) { 
```

你的函数也不正确，我想你想要更像这样的东西，如果它可以被 4 整除，则返回：

```
var quarter = function(n) {
  if (n % 4 == 0){
    return true;
  } else {
    return false;
  }
}; 
```

这可以缩短为：

```
var quarter = function(n) {
   return n % 4 == 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T18:51:29.313

使用`===`意味着你要求一个“严格的平等”——不是真实的或虚假的。这意味着您不能检查数字，因为数字不是严格的`true`。有关更多详细信息，请参阅[此 SO 问题](https://stackoverflow.com/questions/359494/javascript-vs-does-it-matter-which-equal-operator-i-use)。

调用代码应该检查`=== true`，或者只是跳过显式值比较，而只是`if (quarter(4)) { ...`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-10T21:20:48.213

在这里找不到有效的答案，所以我想我只是错过了它。我还发现谷歌搜索解决方案让我的情况变得更糟。

我倾向于发现我过度考虑了 Javascript 中的解决方案，这显然导致无法解决解决方案。

您也不一定需要 `return true`，但我还是添加了它。

请记住，逻辑有序的简单性是关键。

```
    var 季度 = 函数（数字）{
        变数 = n / 4;
        变量 n = 48;
    如果（季度（数字）% 3 === 0）{
        console.log("陈述属实");
        返回真；
    } 别的 {
        console.log("陈述不实");
        }
    }

```

我希望这对你有用。

我将利用我缺乏的 JavaScript 技能和知识向像我这样的初学者和你解释这一点。任何对 JavaScript 有深入了解的人都可能不同意，但这也是为什么大多数编程雇主每天都会选择通信专业而不是程序员的原因：

1.  定义一个名为 Quarter 的函数，这意味着您正在定义一个函数—— Quarter——但你必须首先定义一个**Quarter ——** **var**。

    ```
    var quarter = function(number) 
    ```

2.  该函数返回一个等于

    ```
    n / 4
    ```

    该功能被定义为

    ```
    quarter(number)
    ```

    值为**number**。
    然后你引入一个新的 var 来定义值

    ```
    number = n / 4
    ```

3.  要返回 true 并开始您的 if 语句，

    ```
    function(number or n)
    ```

    现在是**Quarter**，你定义的函数。
4.  提供正确方程的基础依赖于它以以下形式返回真

    ```
    console.log("The statement is true!")
    ```

    您可以通过使用将被除以*4的数字定义**n*来执行此操作，然后该数字能够除以 3 而没有余*数*。因为数字已被定义为 **```
    n / 4
    ```

    ,在本例中**n**被定义为**48**，两者：

    ```
    季度（数）
    ```

    和

    ```
    季度（n）
    ```

    将适用于**if / else**语句。
    要在除以 3 后得到余数 0，请使用

    ```
    % 3 === 0
    ```

    .

    5.  所以

        ```
        如果（季度（数字）% === 3 {
        ```

        现在是定义的函数**季度。**

        ```
        数字
        ```

        是一个参数，你用变量分配参数的值，

        ```
        变量编号 = n / 4
        ```

        和

        ```
        变量 n = 48
        ```

        .** 

 **在那张纸条上，当我输入这个时，理论上这也可以工作并且更短：

```
    var 季度 = 函数（数字）{
              如果（季度（48）％3 === 0）{
                 console.log("此说法属实！");
                 返回数字 = 数字 / 4；
              } 别的 {
                  console.log("这句话是假的。");
            };
         };

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-25T22:17:25.223

好吧，这个愚蠢的东西非常挑剔。我马上揭开它的神秘面纱。您的代码应如下所示：

```
var quarter = function (number) {
return number/4;
}
if (quarter(48) % 3 === 0 ) {
console.log("The statement is hella true");
} else {
console.log("The statement is hella false brah");
} 
```

您不通过模块的原因是因为四分之一（n）括号中的愚蠢数字必须返回一个真实的陈述。选择一个数字，任何数字，然后乘以（3），然后乘以（4）；这反过来会给你一个值，使模 % 为零并使你的 if/else 语句为真。

我对世界的贡献，-Aaron****

# iphone - iOS5 CLGeocoder

> ID：10286398
> 
> 赞同：3
> 
> 时间：2012-04-23T18:47:42.730
> 
> 标签：iphone, ios, ios5, objective-c-blocks, clgeocoder

我正在为 IOS5 开发 iPhone 应用程序。我目前正在使用位于 CoreLocation 框架内的 CLGeocoder 类。我无法确定完成处理程序块是否在最后、地理编码发生后或同时被调用。

我只知道完成处理程序块是在主线程上运行的。有谁知道完成处理程序块是在地理编码完成时运行还是在地理编码器在另一个线程上执行时完成手头任务的代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T19:31:29.350

完成处理程序在地理编码器完成地理编码后运行。换句话说，它在地理编码任务完成后运行。它不是为了在地理编码器运行时完成其他任务。

完成处理程序包含地标和错误。如果地理编码成功，您将获得一个地标数组。如果没有，你会得到一个错误。

来自文档的注释：

> 该方法将指定的位置数据异步提交给地理编码服务器并返回。您的完成处理程序块将在主线程上执行。发起正向地理编码请求后，不要尝试发起另一个正向或反向地理编码请求。
> 
> 每个应用程序的地理编码请求都有速率限制，因此在短时间内发出过多请求可能会导致某些请求失败。当超过最大速率时，地理编码器会将值为 kCLErrorNetwork 的错误对象传递给您的完成处理程序。

```
@interface MyGeocoderViewController ()

@property (nonatomic, strong) CLGeocoder *geocoder;

@end

@implementation MyGeocoderViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    // Create a geocoder and save it for later.
    self.geocoder = [[CLGeocoder alloc] init];
}
- (void)geocodeAddress:(NSString *)addressString
{
    // perform geocode
    [geocoder geocodeAddressString:addressString
        completionHandler:^(NSArray *placemarks, NSError *error) {

        if ((placemarks != nil) && (placemarks.count > 0)) {
            NSLog(@"Placemark: %@", [placemarks objectAtIndex:0]);
        }
        // Should also check for an error and display it
        else {
            UIAlertView *alert = [[UIAlertView alloc] init];
            alert.title = @"No places were found.";
            [alert addButtonWithTitle:@"OK"];
            [alert show];
        }
    }];
}

@end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T22:38:22.803

苹果文档中说：该方法将指定的位置数据异步提交给地理编码服务器并返回。您的完成处理程序块将在主线程上执行。发起正向地理编码请求后，不要尝试发起另一个正向或反向地理编码请求。

无需使用 GCD 在 IBOulet 上发送更新。

[http://developer.apple.com/library/ios/#DOCUMENTATION/CoreLocation/Reference/CLGeocoder_class/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/CoreLocation/Reference/CLGeocoder_class/Reference/Reference.html)

# qt - 如何使用 QT 和 C++ 将字符串参数传递给函数

> ID：10286401
> 
> 赞同：3
> 
> 时间：2012-04-23T18:47:50.890
> 
> 标签：qt

当我在下面的代码中调用 getCount 函数时，QT 4.7.3 编译器给出了错误。构建错误

将 'cont Person' 作为 'int Person::getCount(const QString&) 的 'this' 参数传递会丢弃限定符

```
 bool Person::IsEligible(const QString& name)
 {
      int count = 0;
      count = getCount(name);
 }

 int Person::getCount(const QString& name)
 {
  int k =0
  return k;
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:53:07.680

错误不是传递字符串参数的问题，而是你有一个`const`人，例如：

```
const Person p1;
Person p2;
p1.IsEligible("whatever"); //Error   
p2.IsEligible("whatever"); //Fine because p2 isn't const 
```

如果`IsEligible`意味着可以在 s 上调用，`const Person`那么您可以说：

```
bool Person::IsEligible(const QString& name) const
 {
      int count = 0;
      count = getCount(name);
 } 
```

（并更改您没有显示得太明显的相应声明），但我不能 100% 确定您打算这样做。

# javascript - 权限更改后，我的 ASP.NET 应用程序似乎没有使用应用程序的样式表

> ID：10286415
> 
> 赞同：1
> 
> 时间：2012-04-23T18:49:00.517
> 
> 标签：javascript, asp.net, css, permissions, windows-server

我有一个 ASP.NET 应用程序停止由服务器作为服务器。我让系统管理员授予 IIS_WPG 对应用程序根目录的读取、写入和执行权限。似乎权限过滤到所有子文件和目录，并且服务器为应用程序提供服务。

但是，现在它显示没有正常的母版页格式。我正在使用 VS 提供的具有默认 css 和目录结构的默认母版页。

此外，我的应用程序没有执行从另一个文件导入的 javascript 函数。这在权限更改之前有效，现在无效。

有没有人知道可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:23:20.493

如果您直接在浏览器中键入完全限定的路径，请尝试是否可以下载 css 文件。

你做了，它说无权查看该页面

那么这是一个权限问题......真的是iis6吗？因为那是很久以前的事了。可能 IIS_USR、ASPNET 或 IUSR_MachineName 或类似的东西需要读取并可能执行访问

# mysql - MySQL - 按 count() 和 GROUP BY 排名

> ID：10286418
> 
> 赞同：4
> 
> 时间：2012-04-23T18:49:06.000
> 
> 标签：mysql, count, group-by, rank

我有我的 mysql 表`posts`，其中存储了我论坛的所有帖子。就像这样：

```
id      uid      thread      post      title      text      time
(int)   (int)    (varchar)   (int)     (varchar)  (text)    (int) 
```

现在我想在用户个人资料上显示排名（帖子数量的排名）。我试过这样的事情：

```
set @rownum := 0;
SELECT @rownum := @rownum + 1 AS rank, uid, count(id)
FROM `posts` GROUP BY uid ORDER BY count(id) 
```

但它返回的不是正确的数据。uid 和 count(id) 匹配，但排名错误。我的条目是这样的：

```
rank     uid     count(id)
  1        1        214 
```

我是用户 1，我有 214 个帖子，但这不是排名 1。还有其他条目，例如：

```
rank     uid     count(id)
  8       22        674 
```

* * *

我怎样才能让查询给出正确的排名？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T19:03:18.580

您需要先将整个结果集按用户 ID 分组并排序...然后应用排名

```
select
      @rownum := @rownum +1 as rank,
      prequery.uid,
      prequery.PostCount
   from
      ( select @rownum := 0 ) sqlvars,
      ( SELECT uid, count(id) postCount
           from posts
           group by uid
           order by count(id) desc ) prequery 
```

为了获得特定的人，并且尝试“HAVING”子句时遇到问题，我会将其包装起来，然后应用 where ...

```
select WrappedQuery.* 
   from ( entire query from above ) WrappedQuery
   where WrappedQuery.uid = SinglePerson 
```

# asp.net-mvc-3 - 如何从下拉列表中填充表单值？

> ID：10286422
> 
> 赞同：1
> 
> 时间：2012-04-23T18:49:56.613
> 
> 标签：asp.net-mvc-3, razor

[这个问题](https://stackoverflow.com/q/10244195/7850)的后续：如果我想根据用户从下拉列表中的选择计算一个值，并将该值放入表单变量/模型属性中，我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:05:36.300

真的，如果我有一个建议可以给任何 ASP.NET MVC 开发人员，那就是：*使用视图模型并忘记 ViewBag/ViewData*。在 99% 的情况下，这是他的问题/问题的解决方案。

因此，这是允许您正确表示下拉列表的最小视图模型：

```
public class MyViewModel
{
    // a scalar property on the view model to hold the selected value
    [DisplayName("item")]
    [Required]
    public string ItemId { get; set; }

    // a collection to represent the list of available options
    // in the drop down
    public IEnumerable<SelectListItem> Items { get; set; }

    ... and some other properties that your view might require
} 
```

然后有一个控制器操作，它将填充此视图模型并将其传递给视图：

```
public ActionResult Index()
{
    var model = new MyViewModel
    {
        // TODO: those values probably come from your database or something
        Items = new[]
        {
            new SelectListItem { Value = "1", Text = "item 1" },
            new SelectListItem { Value = "2", Text = "item 2" },
            new SelectListItem { Value = "3", Text = "item 3" },
        }
    };
    return View(model);
} 
```

那么你可以有一个对应于这个视图模型的强类型视图，它可以包含一个表单和下拉列表：

```
@model MyViewModel
@using (Html.BeginForm())
{
    @Html.LabelFor(x => x.ItemId)
    @Html.DropDownListFor(x => x.ItemId, Model.Items, "--Select One--")
    <button type="submit">OK</button>
} 
```

最后，您可以在控制器上执行相应的操作，该表单将被提交到该操作，并且您可以在其中从下拉列表中检索选定的值：

```
[HttpPost]
public ActionResult Index(MyViewModel model)
{
    // model.ItemId will contain the selected value from the dropdown list
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:52:25.277

我猜（来自上一个问题的信息）您想根据下拉列表中的选定项目使用 ajax 获取项目价格数据，并将其作为正常表单帖子的一部分发送到您的操作方法。

**Step1)**为产品创建 ViewModel。

```
public class ProductViewModel
{
    public string SelectedItemId { get; set; }
    public IEnumerable<SelectListItem> Items { get; set; }
    public decimal ItemPrice { set; get; }
} 
```

**Step2）**像这样创建一个产品控制器

```
public class ProductController : Controller
{
    public ActionResult Index()
    {
        var objProduct = new ProductViewModel();
        objProduct.Items = new[]
        {
            new SelectListItem { Value = "1", Text = "Perfume" },
            new SelectListItem { Value = "3", Text = "Shoe" },
            new SelectListItem { Value = "3", Text = "Shirt" }
        };
        return View(objProduct);
    }
    [HttpPost]
    public ActionResult Index(ProductViewModel objProduct)
    {
        //Validate and Save to DB and do whatever            
        return View(objProduct);
    }
    public string GetPrice(int itemId)
    {
        decimal itemPrice = 0.0M;
        //using the Id, get the price of the product from your data layer and set that to itemPrice variable.
        itemPrice = 23.57M;
        return itemPrice.ToString();
    }
} 
```

**步骤 3)**添加强类型视图

```
@model MvcApplication1.Models.ProductViewModel
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

@using (Html.BeginForm())
{    
    @Html.DropDownListFor(x => x.SelectedItemId, Model.Items, "Select..")
    <div id="divItemPrice"> </div>
     @Html.HiddenFor(x=>x.ItemPrice)       
    <button type="submit">Save</button>
}
<script type="text/javascript">
$(function(){
  $("#SelectedItemId").change(function(){
    var val=$(this).val();  
    console.debug(val);    
    $.get("@Url.Action("GetPrice","Product")",  { itemId : val },function(data){
      $("#ItemPrice").val(data);
      $("#divItemPrice").html(data);
    });     
  });
});
</script> 
```

当您更改下拉列表中的选定项目时，使用 jQuery ajax，它将调用 GetPrice Action 方法并获取数据。在 div 中显示并设置为 ItemPrice 的 HiddenField 的值。

![在此处输入图像描述](../Images/0550c67f050305da6fab829fb60b9d7f.png) 当您发布表单时，您将在发布的 ViewModel 中显示它。 ![在此处输入图像描述](../Images/8fb9d67e3c554aa4c200739c38ae324d.png)

希望这可以帮助。

# android - 按下按钮后延迟更新 TextView

> ID：10286423
> 
> 赞同：1
> 
> 时间：2012-04-23T18:49:56.943
> 
> 标签：android, textview, delay, runnable

我试图在按下按钮后以五秒的时间间隔更新 TextView，但是当应用程序运行时，TextView 将只显示它正在运行的循环的最后一个值。

这是我正在尝试的：

```
private Runnable textUpdate = new Runnable() {
    public void run() {
        textOutput = (TextView)findViewById(R.id.textOutput);

        textOutput.setText("Reading Number " + (rIndex+1) + "\n");
        textOutput.append(sensorTime[rIndex] + "\n");
        textOutput.append("Value: " + rPoint.getValue() + "\n");
    }
}; 
```

...

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    mHandler = new Handler();

    TextView textOutput = (TextView) findViewById(R.id.textOutput);
    textOutput.setText("Simulation output:\n");

    Button button03 = (Button) findViewById(R.id.button03);
    button03.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            for(int i = 0; i < index; i++) {
                rIndex = i;
                rPoint = dp[i];

                mHandler.postDelayed(textUpdate, 5000);
            }
        }
    });

} 
```

无法理解为什么只有我试图输出的信息的最后一个值显示在 TextView 中。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:52:38.573

我看到的问题是您的最后一行代码：

```
mHandler.postDelayed(textUpdate, 5000); 
```

您以 5000 毫秒的时间发布所有更新，每个更新都以毫秒为间隔（与手机循环的速度一样快）。

试试这个：

```
mHandler.postDelayed(textUpdate, i * 5000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:53:11.547

您可以再次制作可运行的帖子。

```
private Runnable textUpdate = new Runnable() {
    public void run() {
        textOutput = (TextView)findViewById(R.id.textOutput);

        textOutput.setText("Reading Number " + (rIndex+1) + "\n");
        textOutput.append(sensorTime[rIndex] + "\n");
        textOutput.append("Value: " + rPoint.getValue() + "\n");

        mHandler.postDelayed(this, 5000);
    }
}; 
```

然后删除 onPause 中的所有消息

# ruby-on-rails - 为什么 action mailer 找不到任何方法？

> ID：10286424
> 
> 赞同：0
> 
> 时间：2012-04-23T18:50:10.790
> 
> 标签：ruby-on-rails, actionmailer

据此：在 Rails 2.3.14 中创建邮件非常简单：[http ://railsapi.com/doc/v2.3.2/](http://railsapi.com/doc/v2.3.2/)

但是..它对我不起作用

我做了

```
bundle exec script/generate development_mailer 
```

并添加了一个方法：

```
 def send_data(data)
    Time.zone = 'Eastern Time (US & Canada)'

    subject     "An error has occurred"
    recipients  "bugs@myapp.com"
    from        AppConfig['from_email']
    sent_on     sent_at

    body["email"] = data
  end 
```

但是当它尝试运行时，我收到此错误：

```
NoMethodError (undefined method `send_data' for DevelopmentMailer): 
```

那是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:48:00.620

在 Rails 2.3 中，action mailer 方法都以 为前缀`deliver_`，因此为了发送该邮件，您需要调用 DevelopmentMailer.deliver_send_data(data)

它在您链接的 2.3 文档中，在“发送邮件”下。

您还在整个类上调用了一个实例方法，这就是 the`NoMethodError`的来源。如果你真的想打电话`send_data`，你会跑`DevelopmentMailer.new.send_data(data)`，但实际上不会发送任何东西。

# mysql - 如何在单个 SQL 查询中更新和插入数据。

> ID：10286426
> 
> 赞同：-7
> 
> 时间：2012-04-23T18:50:22.263
> 
> 标签：mysql, sql, oracle10g

> **可能重复：**
> [Oracle：如何 UPSERT（更新或插入表？）](https://stackoverflow.com/questions/237327/oracle-how-to-upsert-update-or-insert-into-a-table)
> [如何执行 UPSERT，以便我可以在更新部分使用新值和旧值](https://stackoverflow.com/questions/6107752/how-to-perform-an-upsert-so-that-i-can-use-both-new-and-old-values-in-update-par)

我想知道单个查询如何更新和删除数据库中的数据。

请在这件事上给予我帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:01:57.273

有一个[MERGE](http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_9016.htm)命令。
它可以让你做 upserts。从 10g 开始，它还包含一个`DELETE`子句

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:52:54.137

```
INSERT INTO table_name (column1, column2, column3,...)
VALUES (value1, value2, value3,...); DELETE FROM table_name
WHERE some_column=some_value 
```

我认为

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T18:53:04.153

```
delete from table where id = 1
update table set name = 'john' where id = 1 
```

# wpf - Windows 应用商店应用程序中的动态资源？

> ID：10286430
> 
> 赞同：2
> 
> 时间：2012-04-23T18:50:56.693
> 
> 标签：wpf, windows-runtime, windows-store-apps

WPF 对 DynamicResource 的支持非常棒，因为这允许用户更改正在运行的应用程序的外观和外观。

不过 WinRT 不支持 DynamicResource。

编写允许用户动态更改 UI 主题的应用程序的推荐方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T04:41:34.353

我目前也在尝试为此提出一个好的设计。在我发现缺少 DynamicResources 之前，我有一些相当“准备就绪”的东西。哎呀。

我想出的最佳方法是拥有一个 ThemedViewModel 基础，它侦听设置 VM 的更改并公开 UI 元素可以绑定到的资源：

```
public class ThemedViewModel : ViewModelBase
{
    public Brush Foreground { get { return ViewModelSelector.Settings.Theme.Foreground; } }

    public ThemedViewModel()
    {
        ViewModelSelector.Settings.PropertyChanged += (sender,arg) =>
        {
            if(arg.PropertyName == "Theme")
            {
                RaisePropertyChanged("Foreground");
            }
        }
    }
} 
```

然后，您可以从中派生任何基于主题的 VM，并且任何主题 UI 元素都将绑定到公开的资源。它相当干燥，但在我看来确实打破了虚拟机的意义。VM 中不应包含 UI 资源。拥有它在 VM 中的外观并不适合我。但是，将主题限制在我的代码的 View 部分的每种方法似乎在绑定时都会遇到问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-07T05:06:02.513

您并不总是需要动态资源。像这样更改“静态”资源的值：

```
Resources.Remove("foo");
Resources.Add("foo", "A new hope"); 
```

这并不总是适用于声明性的东西。在这些情况下，您可以做的是提供一个包装器对象；您无法替换包装器，但*可以*更新其属性。唉，在某些情况下这是不可行的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:35:16.673

如果您使用 MVVM 模式，那么基于切换的主题重新创建视图应该相当容易，而无需重新创建底层数据 - 取决于您结合视图和视图模型的方式。

只需拥有多个主题资源字典并切换您将其中的哪些与应用程序资源字典合并，然后重新创建视图。

# python - 如何使用 Google App Engine Python 将变量从 app.yaml 传递到 main.py

> ID：10286436
> 
> 赞同：5
> 
> 时间：2012-04-23T18:51:16.657
> 
> 标签：python, google-app-engine

我正在尝试将一些配置变量从 app.yaml 传递给我的 main.py。我无法从代码中找到访问 app.yaml 的语法。

例如，您希望用户将其客户编号放入 app.yaml 并从 main.py 访问它以传递到 main.html。虽然在 main.py 中创建一个变量来传递它很容易，但似乎最好将它放入 app.yaml 中。

例子：

应用程序.yaml

```
 application: xyz
    version: 1
    runtime: python27
    ...
    clientID: (ID here) 
```

主文件

```
 myID = appYAML.clientID
    ...
    values = {'xyz': blah.blah, 'myID': myID } 
```

main.html

```
 ...
    <script>
      ...
      {% ifequal myID %}
        my_client = {{myID}}
      ...
    </script> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-23T20:02:21.517

在 1.6.5 版本中，App Engine 支持以下内容[1]：

```
- In your app.yaml file, you can include an env_variables stanza that will set
  the given environment variables in your application's runtime. 
```

有关如何使用它的信息，请访问：[https](https://cloud.google.com/appengine/docs/python/config/appconfig#Python_app_yaml_Defining_environment_variables) ://cloud.google.com/appengine/docs/python/config/appconfig#Python_app_yaml_Defining_environment_variables 。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-23T18:59:17.947

这不受支持，您应该将特定于应用程序的设置放入您自己的 YAML 文件中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-05T13:24:03.593

**您可以在app.yaml**中定义变量以使它们可用于程序的**os.environ**字典：

```
env_variables:
  variable_name: '<YOUR VALUE>' 
```

当你需要在 main.py 中使用这个变量时，你可以这样调用它：

```
import os
CUSTOM_SETTINGS = os.environ['variable_name'] 
```

文档：[https ://developers.google.com/appengine/docs/python/config/appconfig#Python_app_yaml_Defining_environment_variables](https://developers.google.com/appengine/docs/python/config/appconfig#Python_app_yaml_Defining_environment_variables)

# iphone - iOS SDK mms 视频流

> ID：10286441
> 
> 赞同：1
> 
> 时间：2012-04-23T18:51:22.943
> 
> 标签：iphone, ios, video, stream, mss

基本上，我想使用 iOS SDK 流式传输和播放 MMS 视频。`MPMovieplayer`我可以使用MMS 或 RSTP流式传输一些视频，但不能流式传输。我对此进行了研究，但找不到明确的解决方案。有谁能够帮我？

我试过 VLC 移动：[http:](http://wiki.videolan.org/MobileVLC) //wiki.videolan.org/MobileVLC Dropcam：[https ://github.com/dropcam/dropcam_for_iphone](https://github.com/dropcam/dropcam_for_iphone)

但我无法使用这些选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:38:30.140

您应该使用 ffmpeg 库，因为该库可以连接任何流媒体服务器（支持 rtsp、mms、tcp、udp 、rtmp ...），然后将图片绘制到屏幕上..（对于绘图，您可以使用 opengles 或 uiimage 也可以）

首先，使用 avformat_open_input 连接到您的 IP 地址，然后使用 avcodec_find_decoder 和 avcodec_open2 查找编解码器并打开它们（您应该为音频和视频调用它们）

然后，在while循环中使用av_read_frame方法从服务器读取数据包当你获取帧时，如果是音频则将其发送到AudioUnit或AudioQueue，如果是视频，则使用sws_scale方法将其从yuv转换为rgb格式并绘制图片到屏幕上。

就这样。

也看看这个包装器（[http://www.videostreamsdk.com](http://www.videostreamsdk.com)），它写在 ffmpeg 库上并支持 iOS

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:00:14.670

你可以看看[Apple Http Live Streaming](https://developer.apple.com/streaming/)。[这里](https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StreamingMediaGuide/FrequentlyAskedQuestions/FrequentlyAskedQuestions.html#//apple_ref/doc/uid/TP40008332-CH103-SW1)有一些文档。

# javascript - 使用 javascript 在循环中提取单独字母的正则表达式

> ID：10286444
> 
> 赞同：2
> 
> 时间：2012-04-23T18:51:35.367
> 
> 标签：javascript, regex

我正在编写一个脚本来创建用于在线作者识别的指标。我在文献中遇到的一件事是计算每个字母的频率（多少个 a、多少个 b 等），与大小写无关。因为我不想为每个字母创建一个单独的语句，所以我试图循环这个东西，但我无法弄清楚。我能想到的最好的方法是将 ASCII 字母代码转换为十六进制，然后……希望奇迹发生。

到目前为止，我有

```
element = id.toLowerCase();
var hex = 0;
for (k=97; k<122; k++){
    hex = k.toString(16); //gets me to hex
    letter = element.replace(/[^\hex]/g, "")//remove everything but the current letter I'm looking for
    return letter.length // the length of the resulting string is how many times the ltter came up
} 
```

但当然，当我这样做时，它将十六进制解释为字母十六进制，而不是我想要的字母的十六进制代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T18:58:52.743

不知道为什么要转换为十六进制，但您可以遍历字符串的字符并跟踪每个字符与用作哈希的对象一起出现的次数：

```
var element = id.toLowerCase();
var keys = {};

for(var i = 0, len = element.length; i<len; i++) {
    if(keys[element.charAt(i)]) keys[element.charAt(i)]++;
    else keys[element.charAt(i)] = 1;
} 
```

您可以使用数组来做同样的事情，但哈希更快。

# c++ - 强制隐式调用非标准删除运算符函数

> ID：10286446
> 
> 赞同：0
> 
> 时间：2012-04-23T18:51:50.677
> 
> 标签：c++, delete-operator

C++ 中的 AFAIK（或至少在我的编译器中：gcc 和 clang）允许使用以下代码：

```
struct BLA { void *operator new( std::size_t size, int i1, int i2 ); };

int main( void )
{
    struct BLA *bla = new (3,5) BLA;
    return 0;
} 
```

IMAO 这很酷，因为它允许分配存储的非常简洁的语法。
使用这种技术，我可以传递变量，这些变量以一种非常干净的方式分配对象的方式，而不必滥用构造函数。
不幸的是，C++ 标准说（AFAIK）类似的方式不适用于“删除”运算符。IE：

```
struct BLA
{
    void *operator new( std::size_t size, int i1, int i2 );
    void operator delete( void *p, int i1, int i2 );
};

int main( void )
{
    struct BLA *bla = new (3,5) BLA;
    delete (3,5) bla;
    return 0;
} 
```

在“删除”行上给出一个硬错误。
有没有办法（可能是编译器开关）允许对
BLA::operator delete(bla, 3, 5) 进行这种非标准隐式调用？

使用上面的行真的会破坏好的语法:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:06:46.803

无法将参数传递给删除运算符。[在这里](http://www2.research.att.com/~bs/bs_faq2.html#placement-delete)看到 Bjarne 的推理。重载删除（例如您正在实现的删除）仅在显式调用或相应的 new 抛出时使用。

如果您需要确保调用了正确的删除，那么您可以使用一个技巧。如果你只有两个 32 位 int 传递给构造函数，只需要多保留 64 位，并将这两个参数放在对象前面（你只需要在返回指针之前返回偏移的位置）。删除对象时，不要传递任何参数，而是从对象前面获取它们并使用它们来正确释放。这样您就可以使用不带参数的 delete，并且可以确保每个对象都被正确释放。

不确定以下是否会被视为您系统中的错误：

```
struct BLA *bla = new (3,5) BLA;
delete (4,6) bla; 
```

即，如果可以以不同于分配的方式解除分配，则此方法将不起作用。如果以不同的方式解除分配很危险，那么显式保存参数的这种方式实际上要安全得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T19:14:56.783

Stroustrup 提到[了一些可能有助于](http://www2.research.att.com/~bs/bs_faq2.html#placement-delete)讨论 C++ 中缺少“放置删除”的东西。

您可以编写自己的销毁函数，而不是自定义删除。

```
struct BLA {
  void *operator new( std::size_t size, int i1, int i2 );
  void destroy( int i1, int i2 );
private:
  ~BLA(); // private so you can't call regular delete
};

void BLA::destroy( int i1, int i2 ) {
  this->~BLA(); // explicit destructor call
  // your custom deallocation code
} 
```

FWIW - 必须传递参数来删除与你传递给 new 的匹配项似乎是一件非常危险的事情。我建议分配一点额外的空间，以便您可以存储`i1`和存放`i2`在其中。那么你的`destroy`函数根本不需要任何参数。

# c++ - 如何正确检测 GCC 版本中可用的 C++11 功能？

> ID：10286447
> 
> 赞同：4
> 
> 时间：2012-04-23T18:51:59.890
> 
> 标签：c++, gcc, c++11, noexcept

> **可能重复：**
> [C++11 功能检查](https://stackoverflow.com/questions/10225451/c11-feature-checking)

我对`noexcept`随着 GCC 4.7 的引入似乎在 C++11 标准库中乱扔垃圾的规范案例特别感兴趣。在这种情况下，检测编译器版本就足够了；这是生成可移植代码的最佳机制吗？

```
#include <system_error>

class server_error_category : public std::error_category
{
  public:
    virtual const char* name () const {  ...  }
    //
    // fails beginning with gcc4.7, 
    // looser throw specifier ...
    // overriding 'virtual const char* std::error_category::name() const noexcept (true)

    ...
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:07:41.870

如果您只想`noexcept`在编译时（而不是预处理时）检查是否应用于特定方法，您可以简单地使用`noexcept`运算符。

```
noexcept(std::declval<std::error_category>().name())
// return 'true' if the expression is 'noexcept' 
```

然后您可以使用语法有条件地使该方法为 noexcept

```
virtual const char* name () const
     noexcept(noexcept(std::declval<std::error_category>().name()))
{ ... } 
```

您无法检查库是否支持 noexcept 是预处理时间。版本检查是唯一的方法。

但`noexcept`无论如何你都可以扔进去。`noexcept`即使基类不是，子类的覆盖也是有效的。

```
virtual const char* name () const noexcept { ... }
// valid even in 4.6. 
```

（请注意，Boost.Config 并没有真正的帮助，因为`noexcept`从 4.6 开始就支持该语言，但库的使用出现在 4.7 中。）

# objective-c - NSTableVIew 自定义单元格

> ID：10286448
> 
> 赞同：0
> 
> 时间：2012-04-23T18:52:03.473
> 
> 标签：objective-c

我试图为 Mac OS X 10.6 和 10.7 的 NSTableView 创建自定义单元格

在 10.6 中我正在做

```
- (NSCell *)tableView:(NSTableView *)tableView dataCellForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {
    CustomCell *tableCell = [[[CusomCell alloc] init]autorelease];
    return tableCell;
} 
```

但我如何在 10.7 中做到这一点？

```
- (NSView *)tableView:(NSTableView *)tableView viewForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {
} 
```

Mac OS X 10.7 中的方法返回`NSView`，而 CustomCell 返回`NSCell`

我不能使用 NSTableCellView，因为这会使程序无法在 Mac OS X 10.6 上运行

我认为我可以做这样的事情，但我只有 Mac OS X 10.6，所以我无法测试这个

```
- (NSView *)tableView:(NSTableView *)tableView viewForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {
    NSView *view = [[NSView alloc] initWithFrame:NSMakeRect(0, 0, 299, 75)];
    [view addSubview:tableCell.controlView];
    return view;
} 
```

有人可以检查我所做的是否正确吗？或者也许有人知道。在这种情况下做得如何

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:12:55.237

您可以在 Mac OS X 10.7 中继续使用基于单元的 NSTableView。如果您忽略 10.7 中添加的新功能，它们的工作方式与 10.6 中的相同。使您的表格视图基于完全是可选的。因此，如果您的表格视图在 10.6 中运行良好，那么它在 10.7 中也应该可以正常运行。`-tableView:viewForTableColumn:`根本不对，也不会工作。把它拿出来，因为它是不必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:13:57.957

为什么不在`- (NSCell *)tableView:(NSTableView *)tableView dataCellForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row`10.7 中使用？它仍然有效，不是吗？

# objective-c - 为什么当我在 for 循环外打印一个变量时，它会加 1？

> ID：10286449
> 
> 赞同：0
> 
> 时间：2012-04-23T18:52:03.520
> 
> 标签：objective-c, for-loop

```
int main (int argc, const char * argv[]){

    @autoreleasepool {
        int x = 1;
        for (x = 1; x <= 10; x++)  {
            NSLog(@"%i",x); //the answer here is 10.
        }

        NSLog(@"Number %i",x); //the answer here is 11.
    }

    return 0;
} 
```

所以我的问题是，为什么当我在 for 循环之外打印 'x' 时，它会将 1 添加到最初的 10 中？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T18:54:17.543

一旦 x 大于 10，循环就会结束。因此，它会循环 10 次，加一，即 11，然后跳出循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T18:55:00.723

不是，循环声明添加了它。

```
for (x = 1; x <= 10; x++) {
    // some code
} 
```

就好像

```
x = 1;
while(x <= 10) {
    // some code
x++;
} 
```

当 x = 11 时，循环停止。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-23T18:55:48.873

你的循环等于

```
x = 1;
while(x <= 10)
{
    // log x
    x++;
} 
```

如您所见，在最后一次迭代 (x = 10) 中，x 递增，然后循环中断。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T18:55:07.590

因为“for”循环首先将变量x的值递增，然后与条件进行比较！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T18:57:38.520

这是因为 step 子句`x++`在最后一次成功的循环迭代之后运行。这就是它知道停止的方式。

1.  `x = 1`，然后我们循环 10 次，每次递增。
2.  你到达`x = 10`并且你的循环体最后一次运行。
3.  step 子句然后运行`x++`，现在`x = 11`
4.  检查循环条件`x <= 10`，它现在为假并且循环退出。

如果`x`从未达到 11，您将永远不知道何时退出此循环。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-23T18:57:57.740

循环从 1 到 10 迭代 10 次，当循环结束时 x 的值变为 11。

# javascript - 如果链接在点击事件期间被禁用，IE9 将不会执行链接的默认操作

> ID：10286452
> 
> 赞同：1
> 
> 时间：2012-04-23T18:52:11.490
> 
> 标签：javascript, jquery, asp.net, internet-explorer-9

为了防止用户提交表单两次，我在单击后禁用了提交按钮：

```
$('a').on('click', function(){
    $(this).button('option', 'disabled', true);
}); 
```

​</p>

在 Chrome 上，执行默认操作（跟随链接/执行`href`属性中的 JS）。然而，在 IE9 上，没有任何反应，并且按钮保持禁用状态。我尝试在各自的 JS 调试器中探索它，似乎这两个事件都是在同一阶段处理的。

您可以在 jsFiddle 上看到它的实际效果：http: [//jsfiddle.net/inerdial/yXWBn/2/](http://jsfiddle.net/inerdial/yXWBn/2/)

这种行为是否有任何原因，和/或比手动触发按钮的默认操作更简单的解决方法？

如果有任何相关性，提交按钮是一个 ASP.NET LinkBut​​ton，使用 jQuery UI 进行样式设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:55:44.723

您必须`UseSubmitBehavior="false"`在提交按钮上进行设置，一切都会按预期工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T19:16:18.397

您可以尝试将该逻辑放入`setTimeout`通话中

# linux - 多包管理器

> ID：10286459
> 
> 赞同：12
> 
> 时间：2012-04-23T18:53:02.590
> 
> 标签：linux, yum, package-managers, aptitude, distro

使用多个包管理器是否存在陷阱？我可以同时使用 Redhat 的 yum 和 Debian 的 aptitude 吗？

我看到了[这篇文章](http://tuxradar.com/content/best-distro-2011)和这张信息图—— ![2011 Linux Distro 比较结果](../Images/51e833791f53db3ebd5f66c4117afc5d.png)

我倾向于选择 Debian，但快速的 VM 安装表明内核尚未在稳定的 repo 中升级到 3.2。所以我打算迁移到 Archlinux，但信息图表认为它的软件包可用性很低，我想知道我是否可以从 Fedora 或 Ubuntu 存储库安装 .deb 或 .rpm 文件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-23T19:50:55.403

简短的回答是，是的，你*可以*，但你真的*不应该*。

以下是交叉分发安装时要考虑的事项列表（无特定顺序）：

*   依赖地狱

yum/apt/yast 之类的东西首先存在的主要原因是为了避免所谓的[依赖地狱](http://en.wikipedia.org/wiki/Dependency_hell)。通过使用来自其他系统的软件包，您将放弃已在软件包中进行的干净安装工作。

辅助包管理器将希望满足其自身的依赖关系，并安装一堆已经安装的东西。这意味着您必须一次安装一个包，这样您就不会从主包管理器中覆盖已安装的包，并遇到各种问题。

*   他们使用相同的包管理器吗？

如果他们这样做，您甚至可以直接安装它，但您可能会遇到依赖问题或包冲突。如果他们不这样做，您可以使用各种工具提取软件包，然后将二进制文件放到文件系统上（看看外星人，或者[这篇关于提取 .rpm 和 .deb 文件的帖子](http://www.g-loaded.eu/2008/01/28/how-to-extract-rpm-or-deb-packages/)）。

这将为您提供系统上的文件，但不能保证它会开箱即用。可能（并且通常）需要一些额外的手动搜索。

*   glibc 等基础包的版本是否相同或非常接近？

如果是这样，出现问题的可能性就较小。两个发行版的基础包之间的差异越大，您就越有可能缺少正在运行的发行版中不可用的共享库，因为版本不同并且文件名与二进制文件不匹配寻找。

从技术上讲，您还可以从其他发行版中提取基本依赖项并将它们也放在文件系统上，但是如果您需要从源代码编译东西，那肯定会给您带来痛苦。想象一下 gcc 会有多混乱。

*   您正在安装的软件包是否需要特定的内核模块？

我能清楚地表达这一点的最佳方式是我最近从网络主机购买虚拟机时看到的一个常见问题；您获得了他们自己品牌的 xen 或 virtuozzo 内核，而 iptables 无法完全正常工作，因为 netfilter 在内核中并且 ABI 已更改。让它再次工作可能非常令人头疼，而且这个问题不仅限于 iptables。我最好的建议是选择在其自己的基础存储库中具有所需内核的发行版。

*   从源代码编译

毫无疑问，如果您非常想从其他系统获取软件包，您将不得不这样做。由于各种发行版设置它们的构建环境不同，您将花费一半的时间来解决路径和其他配置问题。

# android - 强制非 Flash Vimeo 在 WebView 中嵌入或禁用 Flash？

> ID：10286468
> 
> 赞同：5
> 
> 时间：2012-04-23T18:53:21.467
> 
> 标签：android, flash, video, webview, vimeo

**首先一些细节来帮助解释：**

如果您加载 Vimeo 链接，如下所示：

[http://player.vimeo.com/video/40234826](http://player.vimeo.com/video/40234826)，或使用他们的 iframe 嵌入代码，

进入 WebView，会发生两件事之一。

1.  如果设备安装了 Adob​​e Flash Player 应用程序/插件，它将显示 Vimeo 的嵌入式播放器。点击播放，将内嵌视频作为嵌入播放。
2.  如果设备没有 Flash 插件，它将显示带有播放按钮的图像。点击播放，在系统 VideoView 中打开视频。（因为按钮链接到 mp4 文件。）

由于 Vimeo 的嵌入式播放在各种可用设备上可能会出现一些问题，因此我发现选项 2，在 Android 媒体播放器中播放 Vimeo 视频是一种更好的体验。

**现在的问题是，我怎样才能说服 WebView 不使用 Flash？**

我已经尝试过`webview.getSettings().setPluginsEnabled(false);`，但它仍然会加载 Flash embed 版本。如何让 Vimeo 的播放器认为设备没有安装闪存？

谢谢

**更新** 经过进一步调查，似乎`setPluginState(PluginState.OFF)`可以在蜂窝之前工作，但这在蜂窝和 ICS 上不起作用。

# batch-file - BATCH：将 dir /b 的输出转换为小写

> ID：10286470
> 
> 赞同：1
> 
> 时间：2012-04-23T18:53:25.070
> 
> 标签：batch-file

与 /b 选项（裸格式）一起使用时，'dir' 命令似乎无法识别 /l（小写）选项。我正在尝试获取目录中文件的扩展名，但我无法剥离大小写，从而使以下代码对于扩展名中包含大写字符的所有文件都无用。

```
for /f "delims=" %%a in ('dir /l /b/a-d /s') do (
if "%%~xa"==".iso" echo %%~xa
if "%%~xa"==".bin" echo %%~xa
) 
```

有解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:07:06.960

`dir /l`当然对我有用，即使是你在那里给的开关组合。但即使没有，也有两件简单的事情：

1.  不要`for /f`用于迭代`dir`输出。除非您正确设置控制台选项，否则它很容易出错并且会破坏 Unicode 字符。采用

    ```
    for /r %%a in (*) do ... 
    ```

    相反，它也会递归地遍历文件。

2.  用作`/I`以下选项`if`：

    ```
    if /i "%%~xa" EQU ".iso" ... 
    ```

最后，为什么不走简单的路线：

```
for /r %%a in (*.iso *.bin) do ... 
```

无论情况如何，这都有效：

```
H:.
│   x
│
├───a
│       xyz.bin
│       xyz.ISO
│
└───b
        abc.BIN
        abc.iso

H:\Stuff>for /r %x in (*.iso *.bin) do @echo %x
H:\Stuff\a\xyz.ISO
H:\Stuff\a\xyz.bin
H:\Stuff\b\abc.iso
H:\Stuff\b\abc.BIN 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:56:08.400

您可以创建一个 toUpper 函数并在 %%~xa 上调用它，然后与 .ISO 或 .BIN 进行比较。[这是](http://www.dostips.com/?t=Function.toUpper)一个参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T19:04:09.707

现代 Windows 具有 powershell。PS 中的单行代码是: `ls * -recurse -include *.iso,*.bin`，它将忽略文件名的大小写。（`ls`是 的别名`dir`）[见 Joey 的评论]

# cordova - phonegap / Cordova iOS 中的 Admob

> ID：10286472
> 
> 赞同：0
> 
> 时间：2012-04-23T18:53:39.947
> 
> 标签：cordova, admob

有人可以帮助在 iOS 的 phonegap / Cordova 1.6.1 中实施 AdMob 吗？

请注意，AdMob 现在不允许选择“智能手机网络”，因此它不仅仅是在 index.html 中实现 JavaScript 代码。本教程也不起作用，可能是因为它是为 phonegap 1 编写的：http: [//iphone.keyvisuals.com/iphonedev/implementing-admob-ads-in-a-phonegap-project-for-ios-no-plugins-必需的/](http://iphone.keyvisuals.com/iphonedev/implementing-admob-ads-in-a-phonegap-project-for-ios-no-plugins-required/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T13:08:09.323

我又试[了](https://github.com/smithimage/phonegap-plugins/blob/master/iPhone/AdMob/)一次，它确实有效。（使用 phonegap 1.3 xCode 4.2）

[我像这样](https://developers.google.com/mobile-ads-sdk/docs/ios/fundamentals?)添加了最新的 SDK 。

我将 NSLogs 添加到所有 AdMob 控制器功能以查看发生了什么。

我调用了 js 函数 createBanner({"siteId":"your-id"})

加载横幅（）

并且（那是非常愚蠢的部分）

moveBanner({"positionX":0,'positionY':0})

在适当的回调中。

啊，如果你得到一些错误的话。关于链接，只需按照 xcode 错误日志中的说明进行操作即可。

PS：不要忘记PhoneGap.plist中的'*'

就是这样

# r - 在R中为条形图旋转x轴标签

> ID：10286473
> 
> 赞同：115
> 
> 时间：2012-04-23T18:53:43.383
> 
> 标签：r, graph, plot, bar-chart, axis-labels

我试图让 x 轴标签在条形图上旋转 45 度，但没有运气。这是我下面的代码：

```
barplot(((data1[,1] - average)/average) * 100,
        srt       = 45,
        adj       = 1,
        xpd       = TRUE,
        names.arg = data1[,2],
        col       = c("#3CA0D0"),
        main      = "Best Lift Time to Vertical Drop Ratios of North American Resorts",
        ylab      = "Normalized Difference",
        yaxt      = 'n',
        cex.names = 0.65,
        cex.lab   = 0.65) 
```

* * *

## 回答 #1

> 赞同：306
> 
> 时间：2015-01-11T13:39:23.830

使用可选参数 las=2 。

```
barplot(mytable,main="Car makes",ylab="Freqency",xlab="make",las=2) 
```

![在此处输入图像描述](../Images/f5446114e03af71e892898390252c4cc.png)

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2012-04-23T19:08:21.947

根据大卫的回应编辑答案：

这是一种骇人听闻的方式。我猜有一个更简单的方法。`barplot`但是您可以通过保存条形位置并向上和向下进行一些调整来抑制条形标签和标签的绘图文本。这是 mtcars 数据集的示例：

```
x <- barplot(table(mtcars$cyl), xaxt="n")
labs <- paste(names(table(mtcars$cyl)), "cylinders")
text(cex=1, x=x-.25, y=-1.25, labs, xpd=TRUE, srt=45) 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2014-02-24T03:54:08.677

使用基本图形以等于或小于 90 度的角度旋转 x 轴标签。改编自[R FAQ](http://cran.r-project.org/doc/FAQ/R-FAQ.html#How-can-I-create-rotated-axis-labels_003f)的代码：

```
par(mar = c(7, 4, 2, 2) + 0.2) #add room for the rotated labels

#use mtcars dataset to produce a barplot with qsec colum information
mtcars = mtcars[with(mtcars, order(-qsec)), ] #order mtcars data set by column "qsec"

end_point = 0.5 + nrow(mtcars) + nrow(mtcars) - 1 #this is the line which does the trick (together with barplot "space = 1" parameter)

barplot(mtcars$qsec, col = "grey50", 
        main = "",
        ylab = "mtcars - qsec", ylim = c(0,5 + max(mtcars$qsec)),
        xlab = "",
        space = 1)
#rotate 60 degrees (srt = 60)
text(seq(1.5, end_point, by = 2), par("usr")[3]-0.25, 
     srt = 60, adj = 1, xpd = TRUE,
     labels = paste(rownames(mtcars)), cex = 0.65) 
```

![在此处输入图像描述](../Images/ef6b34d9cb06d178848c4c659ce5940e.png)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-02-16T04:39:51.403

您可以简单地将数据框传递给以下**函数**：

```
rotate_x <- function(data, column_to_plot, labels_vec, rot_angle) {
    plt <- barplot(data[[column_to_plot]], col='steelblue', xaxt="n")
    text(plt, par("usr")[3], labels = labels_vec, srt = rot_angle, adj = c(1.1,1.1), xpd = TRUE, cex=0.6) 
} 
```

**用法：**

```
rotate_x(mtcars, 'mpg', row.names(mtcars), 45) 
```

[![在此处输入图像描述](../Images/1454f5919b9cbb68aaf00da748f55be8.png)](https://i.stack.imgur.com/XFPYR.png)

您可以根据需要更改标签的**旋转角度**。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-08-19T12:03:17.720

您可以使用

```
par(las=2) # make label text perpendicular to axis 
```

它写在这里： http: [//www.statmethods.net/graphs/bar.html](http://www.statmethods.net/graphs/bar.html)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-07-03T05:31:26.050

您可以使用 ggplot2 旋转 x 轴标签添加一个附加层

```
theme(axis.text.x = element_text(angle = 90, hjust = 1)) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-12-18T22:14:25.460

在 Bar Plots 的文档中，我们可以阅读到`...`可以传递给函数调用的附加参数 ( )：

```
...    arguments to be passed to/from other methods. For the default method these can 
       include further arguments (such as axes, asp and main) and graphical 
       parameters (see par) which are passed to plot.window(), title() and axis. 
```

在图形参数的文档（documentation of `par`）中我们可以看到：

```
las
    numeric in {0,1,2,3}; the style of axis labels.

    0:
      always parallel to the axis [default],

    1:
      always horizontal,

    2:
      always perpendicular to the axis,

    3:
      always vertical.

    Also supported by mtext. Note that string/character rotation via argument srt to par does not affect the axis labels. 
```

这就是为什么通过`las=2`使标签**垂直，尽管不是 45°**。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-03T22:14:04.760

安德烈席尔瓦的回答对我很有用，在“条形图”行中有一个警告：

```
barplot(mtcars$qsec, col="grey50", 
    main="",
    ylab="mtcars - qsec", ylim=c(0,5+max(mtcars$qsec)),
    xlab = "",
    xaxt = "n", 
    space=1) 
```

注意“xaxt”参数。没有它，标签会被绘制两次，第一次没有 60 度旋转。

# java - 从集合中分离 2 列的值？

> ID：10286476
> 
> 赞同：0
> 
> 时间：2012-04-23T18:54:04.080
> 
> 标签：java, database, jsp, resultset

以下是从数据库表中获取*电子邮件*和*密码的**java代码片段。*

 **```
 hashedPassword = encrypter.hashPassword(UserPassword);
        Context context = new InitialContext();
        DataSource ds = (DataSource)context.lookup("java:comp/env/jdbc/photog");
        Connection connection = ds.getConnection();
        String sqlStatement = "SELECT email,firstname FROM registrationinformation WHERE password='" + hashedPassword + "'";
        PreparedStatement statement = connection.prepareStatement(sqlStatement);
        ResultSet set = statement.executeQuery(); 
```

上述语句成功执行，但是如何将电子邮件与密码中的密码分开`set`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:55:54.153

```
String email= rs.getString("email"); 
```

使用 regExpression 溢出“电子邮件”。可能是“.com”、“.org”等，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T06:02:21.697

```
while(set.next()) {
   email = rs.getString("email");
} 
```

还要检查[这个 SO 帖子](https://stackoverflow.com/questions/10298794/resultse-getstring1-throws-java-sql-sqlexception-invalid-operation-at-current/10298853)**

# php - 在模块 CP 的视图文件中访问表达式引擎 fetch_action_id 函数

> ID：10286477
> 
> 赞同：0
> 
> 时间：2012-04-23T18:54:08.823
> 
> 标签：php, javascript, jquery, ajax, expressionengine

我正在使用 JQuery 中的 AJAX 编写一个脚本，该脚本将来自 exp_actions 的 action_id 作为我需要在我的 mcp 文件中执行的方法的目标 URL。引用是静态的。可以通过在视图中以类似于以下方式进行 PHP 调用来找到 ACT 值：

`$aid =$this->EE->cp->fetch_action_id('Class_name', 'method_name');`?

我的页面目前看起来是这样的：

```
<script type= "text/javascript">
$(document).ready(function() {
    $('form').change(function(e){
        var data = $(this).serializeArray();
        console.log(data);
        $.post(
            <? echo'http://ourwebsite.com/ee/admin.php?ACT=44&id=4 ,';?>
            data,
            function() {
                console.log(this);
            } 
        )
    });
}); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:08:56.827

所以我在表达式引擎论坛上找到了我的问题的答案。对于那些好奇的人，链接如下。谢谢您的帮助 ：）

[http://expressionengine.com/forums/viewthread/171401/#986831](http://expressionengine.com/forums/viewthread/171401/#986831)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:43:59.390

如果要在 CP 中发起 ajax 请求，只需要请求 cp url：

```
/system/index.php?S=0&D=cp&C=addons_modules&M=show_module_cp&module=my_module&method=my_method 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T19:39:47.077

假设您在模板或片段中使用该脚本，您可以改为调用您的插件，返回所需的 URL：

```
<script type= "text/javascript">
$(document).ready(function() {
    $('form').change(function(e){
        var data = $(this).serializeArray();
        console.log(data);
        $.post(
            '{exp:your_addon:method_for_getting_action_id_url}',
            data,
            function() {
                console.log(this);
            } 
        )
    });
}); 
```

# java - 如何隐藏javabean中的方法不出现在wsdl中

> ID：10286480
> 
> 赞同：0
> 
> 时间：2012-04-23T18:54:20.780
> 
> 标签：java, jakarta-ee, wsdl

我有一个 java bean 类说

```
class LineInfoBean{
  //Methods 

   method a() //Appears in the wsdl definition

   ....
   ....

   method b()//Appears in the wsdl definition -> I want to hide it from appearing in the wsdl

} 
```

有没有办法隐藏方法 b 出现在 wsdl 定义中。我尝试`@WebMethod(exclude=true)`在方法上使用注释，但它不起作用。有什么方法可以隐藏这个方法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-23T21:28:47.220

不要把@WebMethod注解放在这个方法上，而是把它放在应该出现在WSDL中的其他方法上

# c# - 时间：2019-06-01 标签：c#streamwriterappend text under each other

> ID：10286482
> 
> 赞同：0
> 
> 时间：2012-04-23T18:54:36.403
> 
> 标签：c#

我想将行附加到我的文件中。我正在使用代码：

```
StreamWriter sw = new StreamWriter("gamedata.txt", true);
sw.Write(the_final);
sw.Dispose(); 
```

目前它正在连续输出所有内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T18:56:18.303

使用`sw.WriteLine(the_final);` 或`sw.Write(the_final + "\n");`

但更清洁：

```
System.IO.File.AppendAllText("gamedata.txt", the_final + Environment.NewLine); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:56:18.253

您应该使用 writeline 在新行中写入`sw.WriteLine(the_final)`

它将行终止符写入文本流

[http://msdn.microsoft.com/en-us/library/ebb1kw70.aspx](http://msdn.microsoft.com/en-us/library/ebb1kw70.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T18:56:30.963

您可以使用该`WriteLine()`方法代替`Write()`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T18:59:28.367

我认为问题在于您将输出构建到变量中时：the_final

您需要插入新行。您可以通过以下方式做到这一点：

```
the_final = "My First Line" + "\r\n";
the_final += "My Second Line!" + "\r\n";
thirdline = "My Third Line!";
the_final += thirdline + "\r\n"; 
```

"\r\n" 将产生您正在寻找的回车。

每个人都在提出的其他建议只会在输出的末尾附加 1 行新行，其余的仍然保留在一行上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T18:57:07.423

`sw.Writeline();`在末尾写一个新行。 `sw.Write();`不会在末尾追加新行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-23T18:57:32.920

用完`sw.WriteLine()`_`Write()`

MSDN：将行终止符写入文本流。

[http://msdn.microsoft.com/en-us/library/system.io.streamwriter.writeline.aspx](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.writeline.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-23T18:58:38.040

手动添加换行符

```
StreamWriter sw = new StreamWriter("gamedata.txt", true);
sw.Write(the_final + "\n");
sw.Dispose(); 
```

或使用[writeline](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.writeline.aspx)方法

这个问题很容易通过一个简短的谷歌搜索来回答。在发布之前做一些研究是很好的形式

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-23T19:34:47.403

虽然其他人都已经回答了你最初的问题，但我是否也可以建议这种改进？

```
using(StreamWriter sw = new StreamWriter("gamedata.txt", true))
{
    sw.WriteLine(the_final);
} 
```

当您有一个继承自 的对象时`IDisposable`，最好使用`using`它而不是手动处理它。一方面，`using`即使遇到异常也会处理您的对象。

[使用文档](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)

# php - 取checkBox中的值并将其插入mysql数据库

> ID：10286483
> 
> 赞同：1
> 
> 时间：2012-04-23T18:54:41.207
> 
> 标签：php, mysql, arrays, checkbox

我正在尝试创建一个 php 函数，用户可以在其中检查人员列表以向他们发送消息，但是获取数组中的值并将它们一一插入数据库似乎有问题。这是代码：

```
$message=$_POST['body'];
  $x = $_POST['authors'];
  if( isset($x  ) && is_array($x)) {
      $fulexp = implode(",", $x);
foreach ($x as $item) 
   {
    $fulexp = implode(",", $x);
    $var = intval($item);    
    mysql_select_db('mydb');
    $re =  mysql_query("INSERT INTO member_message_member (member_id1, member_id2,conference_id, message)
                    VALUES (6, $var, 1,  $message)");

     if (!$re) {echo "ya a7maaaad";}
   }   
}
else {echo "enta mush msyttar";}
mysql_close($con);
} 
```

当我提交消息时，没有任何内容插入数据库。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:03:24.343

请尝试

```
mysql_select_db('mydb', $link); 
```

其中，$link 应定义如下：

```
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password'); 
```

另外，线

```
$fulexp = implode(",", $x); 
```

在for循环中可能是多余的。

# html - HTML Diff 工具 API

> ID：10286485
> 
> 赞同：3
> 
> 时间：2012-04-23T18:54:57.527
> 
> 标签：html, api, diff, compare, double-byte

我正在寻找一个可以直观地显示结构、字符/单词和样式的 html 差异的 api。该工具还必须支持双字节字符并且足够灵活，以便我将其添加到我现有的网站以轻松显示比较结果。我目前正在使用不支持双字节字符的组件软件 COM 实现，并且大约六年没有更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T15:28:20.970

我发现可以做类似事情的唯一两个工具是[http://changedetection.com](http://changedetection.com)和[http://imnosy.com](http://imnosy.com)。两者都让您指定一个 url 并观察它们的变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T15:07:42.880

这是我使用的：

[http://code.google.com/p/google-diff-match-patch/][1]

我必须编写自己的方法来进行比较，但经过一些工作它看起来不错。此实现比较传入的测试，因此如果您只是比较 2 个文本字符串，它可以正常工作。我的 diff_prettyHtml 调用更改为：

```
public string diff_prettyHtml(List<Diff> diffs)
    {
        StringBuilder html = new StringBuilder();
        foreach (Diff aDiff in diffs)
        {
            string text = aDiff.text.Replace("&", "&amp;").Replace("<", "&lt;")
              .Replace(">", "&gt;").Replace("\n", "<br>");
            switch (aDiff.operation)
            {
                case Operation.INSERT:
                    html.Append("<ins class='diff'>").Append(text)
                        .Append("</ins>");
                    break;
                case Operation.DELETE:
                    html.Append("<del class='diff'>").Append(text)
                        .Append("</del>");
                    break;
                case Operation.EQUAL:
                    html.Append("<span>").Append(text).Append("</span>");
                    break;
            }
        }
        return html.ToString();
    } 
```

现在，如果您想对 2 个 html 字符串进行比较预览，这有点不同。这就是我所做的：

```
DiffMatchPatch.diff_match_patch diff = new DiffMatchPatch.diff_match_patch();
                List<DiffMatchPatch.Diff> differences = diff.diff_main(oldHtml,
                    newHtml);
                return diff.diff_previewHtml(differences);

public string diff_previewHtml(List<Diff> diffs) {
      StringBuilder html = new StringBuilder();
      foreach (Diff aDiff in diffs) {
        string text = aDiff.text;
        switch (aDiff.operation) {
          case Operation.INSERT:
                html.Append("<ins class='diff'>").Append(text)
                .Append("</ins>");
            break;
          case Operation.DELETE:
            html.Append("<del class='diff'>").Append(text)
                .Append("</del>");
            break;
          case Operation.EQUAL:
            html.Append(text);
            break;
        }
      }
      return html.ToString();
    } 
```

unicode类如下：

```
using System.Collections;
using System.Collections.Generic;
using System.Text;
using System.Text.RegularExpressions;
using System.Linq;

namespace HtmlCompare
{
    class Unicoder
    {

        private Hashtable _htmlHash = new Hashtable();
        private const string _htmlPattern = @"<(S*?)[^>]*>.*?|<.*?\/>";
        private List<string> _blockElements = "img,br".Split(',').ToList<string>();
        private int _currentHash = 44032;

        public string pushHash(string tag)
        {
            if (_htmlHash[tag] == null)
            {
                //_htmlHash[tag] = char.Parse("\\u" + Convert.ToString(_currentHash,16));
                _htmlHash[tag] = char.ConvertFromUtf32(_currentHash);
                _currentHash++;
            }
            return _htmlHash[tag].ToString();
        }

        private string tagMatch(Match tag)
        {
            return pushHash(tag.Value);
        }

        public string html2plain(string html)
        {
            MatchEvaluator tagEvaluator = new MatchEvaluator(tagMatch);
            return Regex.Replace(html, _htmlPattern, tagEvaluator, RegexOptions.IgnoreCase | RegexOptions.Multiline);
        }

        private string ProcessDiffTag(string tagStart, string tagEnd, string contents)
        {
            ArrayList diffTagParts = new ArrayList();
            MatchCollection matches = Regex.Matches(contents,
                    _htmlPattern,
                    RegexOptions.IgnoreCase | RegexOptions.Multiline);

            if (matches.Count > 0)
            {
                int contentsStringIndex = 0;
                int contentsStringEndIndex = 0;
                int lastContentStringIndex = 0;

                bool lastTag = false;
                TagDefinition definition;
                foreach (Match currentMatch in matches)
                {
                    contentsStringIndex = currentMatch.Index;
                    contentsStringEndIndex = contentsStringIndex + currentMatch.Length;

                    lastTag = (currentMatch == matches[matches.Count - 1]);

                    // did we miss text that isn't a tag?
                    if (contentsStringIndex > lastContentStringIndex)
                    {
                        definition = new TagDefinition();
                        definition.Tag = false;
                        definition.Text = contents.Substring(lastContentStringIndex, contentsStringIndex - lastContentStringIndex);
                        AddTagDefinition(diffTagParts, definition);
                    }
                    else if (lastTag && contents.Length > contentsStringEndIndex) // something after the last tag?
                    {
                        definition = new TagDefinition();
                        definition.Tag = false;
                        definition.Text = contents.Substring(contentsStringEndIndex, contents.Length - contentsStringEndIndex);
                        AddTagDefinition(diffTagParts, definition);
                    }

                    // work on current tag
                    definition = new TagDefinition();
                    definition.Tag = true;
                    definition.OpeningTag = !IsClosingTag(currentMatch.Value);
                    definition.TagType = GetTagType(currentMatch.Value);
                    definition.Text = currentMatch.Value;
                    AddTagDefinition(diffTagParts, definition);

                    lastContentStringIndex = contentsStringEndIndex;
                }

                return GoThroughDiffParts(diffTagParts,
                        tagStart,
                        tagEnd);
            }
            else
                return string.Concat(tagStart, contents, tagEnd);
        }

        private string GetTagType(string tag)
        {
            int startIndex = 1; // skip <
            if (tag.StartsWith("</"))
                startIndex = 2; // skip </
            int endIndex = tag.IndexOf(" ");
            if (endIndex == -1)
                endIndex = tag.IndexOf(">");

            return tag.Substring(startIndex, endIndex - startIndex);

        }

        private string GoThroughDiffParts(ArrayList parts, string startTag, string endTag)
        {
            IEnumerator enumerator = parts.GetEnumerator();
            StringBuilder before = new StringBuilder(string.Empty);
            StringBuilder middle = new StringBuilder(string.Empty);
            StringBuilder after = new StringBuilder(string.Empty);

            TagDefinition definition;
            while (enumerator.MoveNext())
            {
                definition = (TagDefinition)enumerator.Current;
                if (!definition.Used) // have we already used this part?
                {
                    definition.Used = true;
                    if (_blockElements.Contains(definition.TagType))
                        middle.Append(definition.Text);
                    else if (definition.MatchingIndex == -1) // no matching tag
                    {
                        if (definition.Tag) // html tag?
                        {
                            if (definition.OpeningTag)
                                before.Append(definition.Text);
                            else
                                after.Append(definition.Text);
                        }
                        else
                            middle.Append(definition.Text);
                    }
                    else
                    {
                        if (!definition.Tag) // text and has a matching tag
                        {
                            TagDefinition matchingTag = (TagDefinition)parts[definition.MatchingIndex];
                            if (matchingTag.OpeningTag)
                                matchingTag.Text += definition.Text;
                            else
                                matchingTag.Text = string.Concat(definition.Text, matchingTag.Text);
                            definition.Used = true;
                        }
                        else
                            middle.Append(definition.Text);
                    }
                }
            }

            bool includeDiffTag = true;
            if (string.IsNullOrEmpty(middle.ToString()))
                includeDiffTag = false; // we don't want the ins/del tag around nothing
            else if (string.IsNullOrWhiteSpace(middle.ToString())) // spacing should be kept
                middle = new StringBuilder("&nbsp;" + middle.Replace("\n", "<br />"));

            if(includeDiffTag)
                middle.Insert(0, startTag); // <ins>[middle]
            middle.Insert(0, before); // [before]<ins>[middle]
            if (includeDiffTag)
                middle.Append(endTag); // [before]<ins>[middle]</ins>
            middle.Append(after); // [before]<ins>[middle]</ins>[end]

            return middle.ToString();
        }

        private string DiffTagMatch(Match tag)
        {
            string tagStart = tag.Groups[1].Value;
            string tagEnd = tag.Groups[5].Value;
            string contents = tag.Groups[4].Value;
            if (string.IsNullOrEmpty(contents))
                return string.Empty; // we don't want the ins/del tag around nothing
            else if (string.IsNullOrWhiteSpace(contents)) // spacing should be kept
                return string.Concat(tagStart, "&nbsp;", contents.Replace("\n", "<br />"), tagEnd);
            else
                return ProcessDiffTag(tagStart,
                    tagEnd,
                    contents);

        }

        private bool IsClosingTag(string tag)
        {
            return tag.Contains("</") && !tag.ToLower().Contains("<img") && !tag.ToLower().Contains("<br");
        }

        public string CleanUpMisplacedDiffTags(string html)
        {
            return Regex.Replace(html, @"(\<((ins|del).*?)\>)(.*?)(\<\/((ins|del).*?)\>)", DiffTagMatch, RegexOptions.IgnoreCase | RegexOptions.Multiline);
        }

        public string plain2html(string plain)
        {
            IDictionaryEnumerator enumerator = _htmlHash.GetEnumerator();
            while (enumerator.MoveNext())
            {
                plain = Regex.Replace(plain, 
                    _htmlHash[enumerator.Key].ToString(), 
                    enumerator.Key.ToString(), 
                    RegexOptions.IgnoreCase | RegexOptions.Multiline);
            }
            return CleanUpMisplacedDiffTags(plain);
        }

        private void AddTagDefinition(ArrayList list, TagDefinition tag)
        {
            IEnumerator enumerator = list.GetEnumerator();
            TagDefinition currentDefinition;
            int index = 0;
            int insertingIndex = list.Count;
            while (enumerator.MoveNext())
            {

                currentDefinition = (TagDefinition)enumerator.Current;
                //if (!tag.OpeningTag && currentDefinition.MatchingIndex == -1)
                //    currentDefinition.MatchingIndex = insertingIndex;

                if (tag.MatchingIndex == -1 && // matching tag not found yet
                        (currentDefinition.OpeningTag && !tag.OpeningTag) && // opening & closing
                        currentDefinition.TagType == currentDefinition.TagType) // same tag type
                {
                    tag.MatchingIndex = index;
                    currentDefinition.MatchingIndex = insertingIndex;
                }
            }

            list.Add(tag);
        }

        private class TagDefinition
        {
            public bool Tag { get; set; }
            public string TagType { get; set; }
            public string Text { get; set; }
            public int MatchingIndex { get; set; }
            public bool OpeningTag { get; set; }
            public bool Used { get; set; }

            public TagDefinition()
            {
                this.Tag = false;
                this.Text = string.Empty;
                this.TagType = string.Empty;
                this.MatchingIndex = -1;
                this.OpeningTag = false;
                this.Used = false;
            }
        }
    }
} 
```

# android - 是否有任何 Android 设备具有方形屏幕？

> ID：10286488
> 
> 赞同：3
> 
> 时间：2012-04-23T18:55:04.907
> 
> 标签：android, screen, screen-resolution

我正在为 Android 编写游戏，并自己布置播放屏幕，同时处理垂直和水平方向，如果宽度和高度相同，则没有做任何事情。

有人知道至少有一款具有完美方形屏幕分辨率的 Android 设备吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:00:55.230

MotoACTV是 220x176（不是正方形，而是接近），[WIMM](https://motoactv.com/) [One](http://www.wimm.com/)是 160x160（正方形）。

MotoACTV 已植根，但默认设备运行的是定制的 Android。不过，这是一个非常酷的设备。WIMM 很流畅，运行更标准的 Android。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T18:57:48.790

没有我知道的。我熟悉的每台设备都有独特的“纵向”与“横向”模式。

确保您的代码始终能够优雅地处理纵向与横向可能是明智的 - 即使您碰巧在方形设备上运行。

相反，如果你*想要*一个正方形 - 只需适当地“裁剪”图像。如果您遇到这个假设的“方形屏幕”，裁剪当然会变成“零”。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-25T15:55:54.650

这是对这个问题的一个较晚的答案，但从那以后情况发生了一些变化，虽然仍然没有主流的方形屏幕 Android 设备，但有 3 款方形 BlackBerry 设备（Q10、Q5 和 Passport）可以运行 Android 应用程序，因此属于该标准。有趣的是，当应用程序在方形 BlackBerry Passport 上运行时，设备旋转到一边，应用程序也会旋转，但是没有调用`onPause()`、`onStop()`或`onDestroy()`事件，因此不会销毁和重新创建活动，但是当前的活动布局被重新使用。因此，在这方面，什么都没有发生，您不必担心保存/加载资源等。

这种行为实际上是内置在 Android 中的——如果屏幕尺寸发生变化，它只会破坏并重新创建一个活动。API 文档没有讨论这种极端情况，因为没有方形 Android 设备，但您可以看到在方向更改期间销毁和重新创建活动的原因是加载特定于新方向的替代资源。由于旋转方形设备不会改变屏幕尺寸，因此无需加载替代资源，因此无需销毁和重新创建活动。我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T01:39:31.347

我相信[WIMM ONE](http://www.wimm.com/platform-technology.html)是目前唯一一款方形屏幕的 Android 设备。它具有 160x160 的电容式触摸显示屏。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-04-23T18:58:17.500

是的，[摩托罗拉 Flipout](http://www.motorola.com/Support/GB-EN/Consumer-Support/Mobile-Phones/MOTOROLA_FLIPOUT_with_MOTOBLUR)就是其中之一。

# regex - 使用正则表达式在文本文件中查找和替换

> ID：10286490
> 
> 赞同：0
> 
> 时间：2012-04-23T18:55:14.500
> 
> 标签：regex, macos, ms-word, replace, docx

我有几百个 .docx 文档要转换为降价。我正在使用 textutil 将 .docx 转换为 html 并使用 Pandoc 将 html 转换为 Markdown。

我遇到的问题是原始 .docx 文件包含 dropcaps。在文本文件中，我现在将第一个字母（即首字母大写）与其段落分开，并用换行符分隔。它看起来像这样：

```
T

he following five basic pre-conditions are essential... 
```

我正在使用 mac (10.6.8) 和 textmate。Textmate 允许使用正则表达式进行查找和替换。

如何删除换行符并将分隔的字母与其段落的其余部分重新连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:12:59.243

对于搜索，试试这个：

```
^([A-Z])[\r\n]+(\w+)\b 
```

对于替换：

```
$1$2 
```

# css - 在绝对定位的 div 下方滑动 div

> ID：10286493
> 
> 赞同：1
> 
> 时间：2012-04-23T18:55:34.517
> 
> 标签：css, positioning

[http://jsfiddle.net/FUqhb/](http://jsfiddle.net/FUqhb/)

我需要移动播放器，使其始终保持在 CD 封面下方。我无法更改 html（我可以添加内容，但无法更改顺序或删除里面的内容），也无法为播放器设置固定的边距顶部。除此之外，还有什么想法吗？

我试过 display:block 但它不起作用，可能是因为它是一个绝对定位的 div。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:00:42.047

jsfiddle：http: [//jsfiddle.net/FUqhb/11/](http://jsfiddle.net/FUqhb/11/)

您可以添加一个 div`height:200px`来将栏向下推。

```
<div class="audio_player">
     <div style="height:200px"></div>
     <embed type="application/x-shockwave-flash" src="http://assets.tumblr.com/swf/audio_player_black.swf?audio_file=somefile.mp3" height="27" width="207"/>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T18:59:18.570

关闭套筒的绝对定位：

```
.turntable {
    width: 100%;
    height: 200px; /* cd height */
    position: relative;
}

.artwork,
.gloss,
.sleeve {

    width: 100%;
    height: 100%;
    background-size: cover;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
}

.gloss {
    background: url('http://i.imgur.com/JrVdR.png');
    position:absolute;
    top:0;left:0
}

.sleeve {
    background: url('http://i.imgur.com/VjVh1.jpg') no-repeat;
    width: 200px; /* cd width */
} 
```

# java - 如何在将请求主体传递给控制器 之前在 Spring 中对其进行预处理？

> ID：10286497
> 
> 赞同：4
> 
> 时间：2012-04-23T18:55:51.343
> 
> 标签：java, spring, servlets, servlet-filters

我正在实现一个 RESTful 服务，我想在拦截器中针对 XSD 验证 XML，然后再将其传递到 a `CastorUnmarshaller`. 虽然，在`WebRequestInterceptor`我必须阅读只能读取一次的请求正文，因此解组器无法读取它。有没有办法做到这一点？

我知道我可以在 Controller 中手动进行验证和解组，但我想使用这种`@RequestBody <DomainObject>`方式来解组它。

或者，作为另一种解决方案，有没有办法告诉`CastorUnmarshaller`它针对 xsd 进行验证？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-07-30T22:42:16.647

很长一段时间过去了，但其他人可能会从中受益：

您可以定义一个@Around 方面并拦截传入的请求及其各自的主体，如下所示：

```
@Aspect
@Component
public class RequestResponseLoggingAdvice {

    private static final Logger logger = LoggerFactory.getLogger(RequestResponseLoggingAdvice.class);

    @Pointcut("within(@org.springframework.web.bind.annotation.RestController*)") 
    public void restcontroller() {}

    @Pointcut("@annotation(org.springframework.web.bind.annotation.PostMapping)") 
    public void postmapping() {}

    @Around("restcontroller() && postmapping() && args(.., @RequestBody body, request)") 
    public Object logPostMethods(ProceedingJoinPoint joinPoint, Object body, HttpServletRequest request) throws Throwable {
        logger.debug(request.toString()); // You may log request parameters here.
        logger.debug(body.toString()); // You may do some reflection here

        Object result;
        try {
            result = joinPoint.proceed();
            logger.debug(result.toString());
        } catch(Throwable t) {}
    }
} 
```

请注意，您的 REST 控制器方法必须具有适合上述方面的签名才能挂钩。示例如下：

```
@PostMapping
public SampleDTO saveSample(@RequestBody Sample sample, HttpServletRequest request) { 
    //.....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:19:51.070

您可能可以附加一个`@Before`方面（spring AOP）。在那里，您可以获得与传递给控制器​​方法相同的请求正文参数。

另一种选择是将请求包装成一个支持多次读取正文的请求（通过第一次缓存它）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T12:43:03.263

过滤器也可用于验证通过的 XML。 **org.springframework.oxm.castor.CastorMarshaller**有一个**验证**属性来启用对传入和传出文档的验证。但是必须解决在 Spring-MVC 的默认编组器中启用它的问题。

# java - 为什么编译时出现重复的修饰符错误？

> ID：10286499
> 
> 赞同：3
> 
> 时间：2012-04-23T18:55:58.197
> 
> 标签：java, access-modifiers

```
import java.util.*;
import java.io.*;
public final class FileListing2 
{
    public static void main(String... aArgs) throws FileNotFoundException 
    {
         File startingDirectory= new File(aArgs[0]);
         List<File> files = FileListing.getFileListing(startingDirectory);
         //print out all file names, in the the order of File.compareTo()
         for(File file : files )
         {
              System.out.println(file);
         }
    }
    static public List<File> getFileListing(File aStartingDir) throws FileNotFoundException 
    {
        validateDirectory(aStartingDir);
        List<File> result = getFileListingNoSort(aStartingDir);
        Collections.sort(result);
        return result;
    }
    static private List<File> getFileListingNoSort(File aStartingDir) throws FileNotFoundException 
    {
          List<File> result = new ArrayList<File>();
          File[] filesAndDirs = aStartingDir.listFiles();
          List<File> filesDirs = Arrays.asList(filesAndDirs);
          for(File file : filesDirs) 
          {
            result.add(file); //always add, even if directory
            if ( ! file.isFile() ) 
            {
                   //must be a directory
                   //recursive call!
                   List<File> deeperList = getFileListingNoSort(file);
                   result.addAll(deeperList);
            }
            return result;
          }

       }
       static private void validateDirectory (File aDirectory) throws FileNotFoundException 
       {
          if (aDirectory == null) 
          {
                 throw new IllegalArgumentException("Directory should not be null.");
          }
          if (!aDirectory.exists()) 
          {
                 throw new FileNotFoundException("Directory does not exist: " + aDirectory);
          }
          if (!aDirectory.isDirectory()) 
          {
                 throw new IllegalArgumentException("Is not a directory: " + aDirectory);
          }
          if (!aDirectory.canRead()) 
          {
                 throw new IllegalArgumentException("Directory cannot be read: " + aDirectory);
           }
        }
      } 
```

[我从这个站点](http://www.javapractices.com/topic/TopicAction.do?Id=68)复制了这段代码，并试图使其适应我们的环境。不幸的是，我无法编译 $%!@#*($ 东西。我在 main 方法中不断收到错误：错误：重复修饰符。

`public static void main(String... aArgs) throws FileNotFoundException`是标记为错误的行。

我在这里看不到任何重复的修饰符，我所有的花括号和括号似乎都在正确的位置，我完全被难住了。

这是我第一次使用可变参数...我不确定这是否给我带来了问题？我扫描了 Java 文档，但没有发现任何危险信号。此外，当我更改`String...`为`String[]`. 我觉得我可能会得到一些空值，所以我宁愿留`String...`在方法中。

有人看到我遗漏的任何东西吗？我觉得我在春季脑筋急转弯中看着那个巴黎......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T19:02:05.350

在方法`getFileListingNoSort()`中，行在`return result;`方法之外，将其向上移动一行以将其放入它所属的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:05:04.747

我无法重现您重复的修饰符错误（使用 JDK 1.7.0），但方法的返回语句`getFileListingNoSort`不在方法体中。

请格式化您的代码，使其有意义，您将看到此类问题。以下编译良好：

```
import java.util.*;
import java.io.*;

public final class FileListing2 {
    public static void main( String... aArgs ) throws FileNotFoundException {
        File startingDirectory = new File( aArgs[0] );
        List<File> files = FileListing2.getFileListing( startingDirectory );
        for(File file : files) {
            System.out.println( file );
        }
    }

    static public List<File> getFileListing( File aStartingDir ) throws FileNotFoundException {
        validateDirectory( aStartingDir );
        List<File> result = getFileListingNoSort( aStartingDir );
        Collections.sort( result );
        return result;
    }

    static private List<File> getFileListingNoSort( File aStartingDir ) throws FileNotFoundException {
        List<File> result = new ArrayList<File>();
        File[] filesAndDirs = aStartingDir.listFiles();
        List<File> filesDirs = Arrays.asList( filesAndDirs );
        for(File file : filesDirs) {
            result.add( file ); // always add, even if
                                        // directory
            if(!file.isFile()) {
                List<File> deeperList = getFileListingNoSort( file );
                result.addAll( deeperList );
            }
        }
        return result;
    }

    static private void validateDirectory( File aDirectory ) throws FileNotFoundException {
        if(aDirectory == null) {
            throw new IllegalArgumentException( "Directory should not be null." );
        }
        if(!aDirectory.exists()) {
            throw new FileNotFoundException( "Directory does not exist: " + aDirectory );
        }
        if(!aDirectory.isDirectory()) {
            throw new IllegalArgumentException( "Is not a directory: " + aDirectory );
        }
        if(!aDirectory.canRead()) {
            throw new IllegalArgumentException( "Directory cannot be read: " + aDirectory );
        }
    }
} 
```

# mysql - 如何编写此查询以正确过滤结果？

> ID：10286503
> 
> 赞同：1
> 
> 时间：2012-04-23T18:56:11.667
> 
> 标签：mysql, database, left-join

我有 3 个要加入的表：

### 设备

*   设备否
*   资产编号
*   子类别No
*   不做
*   用户号
*   位置否
*   等号
*   紧急情况
*   阿里诺
*   制造号
*   型号
*   串行
*   套件编号
*   购买日期
*   购买价格
*   评论
*   过剩

    ### 雇员

*   用户号

*   名称
*   名字
*   不做
*   紧急情况

    ### 子类别

*   子类别No

*   子类别
*   类别否
*   更换周期

我需要获取一组数据，其中包括由“userNo”链接的员工按“doNo”和“lname”排序的所有设备信息，并且设备“subCategoryNo”只需要来自“categoryNo”的子类别等于 2。

在迷路和困惑之前，我已经走了这么远。

```
SELECT equipment.*, employees.lname, employees.fname 
FROM equipment 
LEFT JOIN employees 
  USING (userNo) 
ORDER BY equipment.doNo, employees.lname; 
```

我不知道如何将其限制为仅 'categoryNo' 2；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:32:02.757

```
SELECT equipment.*, employees.lname, employees.fname 
FROM equipment 
LEFT JOIN employees USING (userNo) 
JOIN subcategories USING(subCategoryNo)
WHERE subcategories.categoryNo=2
ORDER BY equipment.doNo, employees.lname; 
```

# facebook - Janrain 错误：无效的 redirect_uri：应用程序配置不允许给定 URL

> ID：10286508
> 
> 赞同：2
> 
> 时间：2012-04-23T18:56:19.380
> 
> 标签：facebook, drupal-7, janrain

我正在尝试使用我的 drupal 网站设置 Janrain Engage。

*   我创建了一个 Janrain 帐户

*   我已经设置了提供商（包括 Facebook）

*   我已经安装并配置了模块（Drupal 7）

*   正如预期的那样，我已经在登录页面上显示了所有内容

*   我创建了一个 Facebook 应用程序

一切似乎都很好，但是...

当我尝试使用 facebook 登录时，我收到以下错误消息：

```
{
   "error": {
      "message": "Invalid redirect_uri: Given URL is not allowed by the Application configuration.",
      "type": "OAuthException",
      "code": 191
   }
} 
```

谁能告诉我我在这里做错了什么:(

谢谢 C

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:35:03.900

我在这里找到了解决方案：

[https://support.janrain.com/entries/470621-how-to-resolve-a-facebook-settings-error](https://support.janrain.com/entries/470621-how-to-resolve-a-facebook-settings-error)

# c# - 2D 绘图性能（GDI+ 与 SlimDX）

> ID：10286509
> 
> 赞同：10
> 
> 时间：2012-04-23T18:56:20.523
> 
> 标签：c#, wpf, gdi+, slimdx

我是一个团队的一员，该团队创建了一个工具来查看 C#/WPF 中非常大且高度互连的图形并与之交互。查看图表并与之交互是通过一个自定义控件完成的，该控件接受一组绘图视觉对象并将它们显示在画布上。图中的节点可能具有使用我们的编辑器创建的自定义形状。当前的控件运行良好，并且与我们的程序相当耦合，但是在考虑更大的图（20,000 多个节点和大量连接）时，存在对性能的合理担忧。

在做了一些研究之后，这两种方法似乎是：

*   将图形绘制到 WriteableBitmap 或 InteropBitmap 的 GDI+ 路径。
*   SlimDX 或 DirectX 变体（托管在 D3DImage 中）

鉴于这两种截然不同的方法，最好考虑哪种路线：

*   即使在查看整个图表时，与图表的交互也必须快速。
*   更新视觉效果应该很快（颜色或大小变化）
*   命中测试必须快速（点和矩形）。
*   开发必须及时完成。

你会使用哪种方法，为什么？

编辑：
看起来有人问了[类似的问题](https://stackoverflow.com/questions/9529087/displaying-2d-schematics-in-wpf-with-drawing-visuals)，但没有回答。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T07:02:17.637

我将 GDI 用于我的[制图应用程序](http://maperitive.net/)。虽然 GDI+ 比 DirectX 慢，但我发现有很多东西和技巧可以用来加快速度。大量 CPU 用于在绘制数据之前准备数据，因此 GDI 不应该是那里唯一的瓶颈。

需要注意的事项（这些也足以适用于其他图形引擎）：

1.  首先：**测量**。使用分析器查看代码中真正的瓶颈是什么。
2.  **重用 GDI 原语**。这是至关重要的。如果您必须绘制 100,000 个看起来相同或相似的图形对象，请使用相同`Pen`等`Brush`。创建这些图元的成本很高。
3.  **缓存渲染数据**- 例如：如果不需要，不要重新计算 gfx 元素位置。
4.  **平移/缩放时，以较低的 GDI+ 质量**绘制场景（并且没有昂贵的 GDI 操作）。有许多`Graphics`对象设置可以降低质量。用户停止平移后，绘制高质量的场景。
5.  很多很多可以提高性能的小东西。我已经开发这个应用程序 2-3 年（或者它已经 4 年了？）现在我仍然找到改进的方法:)。这就是分析很重要的原因 - 代码更改，这会影响性能，因此您需要分析新代码。

另一件事：我没有使用过 SlimDX，但我确实尝试过 Direct2D（我指的是`Microsoft.WindowsAPICodePack.DirectX.Direct2D1`）。在我的情况下，性能比 GDI+ 快得多，但我在渲染位图时遇到了一些问题，而且从来没有时间找到合适的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T19:16:50.117

我最近将一些绘图代码移植到 DirectX 并且对结果非常满意。我们主要使用 bit-bashing 渲染位图，并且看到可以以分钟为单位测量的渲染时间减少到大约 1-2 秒。

这不能直接与您的使用情况进行比较，因为我们已经使用 SlimDX 从 C++ 中的 bit-bashing 到 C# 中的 Direct3D，但我想您会看到性能优势，即使它们不是我们的数量级。重看。

我建议你看看使用 Direct2D 和 SlimDX。您将需要使用 DirectX 10.1，因为 Direct2D 出于某种原因与 DirectX 11 不兼容。如果您在 WPF 中使用过绘图 API，那么您已经熟悉 Direct2D，因为据我所知，它的 API 基于 WPF 绘图 API。Direct2D 的主要问题是缺乏文档，而且它只适用于 Vista 以后的版本。

我没有尝试过 DirectX 10/WPF 互操作，但我相信这是可能的 (http://stackoverflow.com/questions/1252780/d3dimage-using-dx10)

编辑：我想我会从我们绘制简单多边形的代码中给你一个比较。首先是WPF版本：

```
 StreamGeometry geometry = new StreamGeometry();

        using (StreamGeometryContext ctx = geometry.Open())
        {
            foreach (Polygon polygon in mask.Polygons)
            {
                bool first = true;

                foreach (Vector2 p in polygon.Points)
                {
                    Point point = new Point(p.X, p.Y);

                    if (first)
                    {
                        ctx.BeginFigure(point, true, true);
                        first = false;
                    }
                    else
                    {
                        ctx.LineTo(point, false, false);
                    }
                }
            }
        } 
```

现在是 Direct2D 版本：

```
 Texture2D maskTexture = helper.CreateRenderTexture(width, height);

        RenderTargetProperties props = new RenderTargetProperties
        {
            HorizontalDpi = 96,
            PixelFormat = new PixelFormat(SlimDX.DXGI.Format.Unknown, AlphaMode.Premultiplied),
            Type = RenderTargetType.Default,
            Usage = RenderTargetUsage.None,
            VerticalDpi = 96,
        };

        using (SlimDX.Direct2D.Factory factory = new SlimDX.Direct2D.Factory())
        using (SlimDX.DXGI.Surface surface = maskTexture.AsSurface())
        using (RenderTarget target = RenderTarget.FromDXGI(factory, surface, props))
        using (SlimDX.Direct2D.Brush brush = new SolidColorBrush(target, new SlimDX.Color4(System.Drawing.Color.Red)))
        using (PathGeometry geometry = new PathGeometry(factory))
        using (SimplifiedGeometrySink sink = geometry.Open())
        {
            foreach (Polygon polygon in mask.Polygons)
            {
                PointF[] points = new PointF[polygon.Points.Count()];
                int i = 0;

                foreach (Vector2 p in polygon.Points)
                {
                    points[i++] = new PointF(p.X * width, p.Y * height);
                }

                sink.BeginFigure(points[0], FigureBegin.Filled);
                sink.AddLines(points);
                sink.EndFigure(FigureEnd.Closed);
            }

            sink.Close();
            target.BeginDraw();
            target.FillGeometry(geometry, brush);
            target.EndDraw();
        } 
```

如您所见，Direct2D 版本的工作量稍大一些（并且依赖于我编写的一些辅助函数），但实际上非常相似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T20:32:16.393

让我尝试列出每种方法的优缺点——这可能会让您对使用哪种方法有所了解。

GDI 专业人士

*   易于绘制矢量形状
*   无需包含额外的库

GDI 缺点

*   比 DX 慢
*   需要限制“花式”绘图（渐变等），否则可能会减慢速度
*   如果图表需要交互 - 可能不是一个很好的选择

SlimDX 优点

*   可以做一些花哨的绘图，同时比 GDI 更快
*   如果绘图是交互式的 - 这种方法会更好
*   由于您绘制了基元，因此您可以控制每个缩放级别的质量

SlimDX 缺点

*   绘制简单的形状并不容易——您需要编写自己的抽象或使用帮助您绘制形状的库
*   使用 GDI 并不那么简单，尤其是如果您以前没有使用过它

也许我忘了在这里放更多，但也许这些对初学者有用？

-一个。

# c++ - 为什么 GoogleMock 会泄露我的 shared_ptr？

> ID：10286514
> 
> 赞同：34
> 
> 时间：2012-04-23T18:56:53.913
> 
> 标签：c++, boost, shared-ptr, googletest, googlemock

我使用 GoogleMock/GoogleTest 进行测试，当匹配器将 shared_ptr 作为模拟参数并在同一个 shared_ptr 上调用 EXPECT 时，我看到了一些奇怪的行为。有问题的代码：

```
#include <gmock/gmock.h>
#include <gtest/gtest.h>

#include <boost/shared_ptr.hpp>
#include <boost/make_shared.hpp>
using namespace boost;
using namespace testing;

struct MyParameter
{
    virtual ~MyParameter() {}
    virtual void myMethod() = 0;
};

struct MyParameterMock : public MyParameter
{
    MOCK_METHOD0(myMethod, void());
};

struct MyClass
{
    virtual ~MyClass() {}
    virtual void myMethod(shared_ptr<MyParameter> p) {}
};

struct MyClassMock : public MyClass
{
    MOCK_METHOD1(myMethod, void(shared_ptr<MyParameter>));
};

TEST(LeakTest, GoogleMockLeaksMatchedPointer)
{
    shared_ptr<MyClassMock> c = make_shared<MyClassMock>();
    shared_ptr<MyParameterMock> p = make_shared<MyParameterMock>();
    {
        InSequence dummy;
        EXPECT_CALL(*c, myMethod(Eq(p)));
        EXPECT_CALL(*p, myMethod());
    }
    c->myMethod(p);
    p->myMethod();
} 
```

运行此测试时，我得到

```
leak_ptr_mock.cpp:37: ERROR: this mock object (used in test LeakTest.GoogleMockLeaksMatchedPointer) should be deleted but never is. Its address is @0x9309544.
ERROR: 1 leaked mock object found at program exit. 
```

知道为什么会这样吗？我宁愿不用`Mock::AllowLeak`。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-04-23T22:29:18.703

这是持有`p`a `shared_ptr`、 using`InSequence`和您声明期望的顺序的结果。

你打电话时

```
 EXPECT_CALL(*c, myMethod(Eq(p))); 
```

你增加`use_count`的`p`。为了使泄漏检测通过，`p`必须在结束时（或之前）销毁`TEST`。

这里的问题是，在内部，gmock 通过持有指向先前期望的指针来维护所需的模拟调用序列的记录。因此，当您调用 时`EXPECT_CALL(*p, myMethod());`，它会获得指向先前期望的指针的副本。

然后，这会在结束时阻止对`p`' 的析构函数的调用`TEST`。

为了解决这个问题，我认为你最好的选择是跟注

```
 EXPECT_TRUE(Mock::VerifyAndClearExpectations(p.get())); 
```

就在你退出之前`TEST`。这清除了对 的期望`p`，包括关键的先决条件期望，这反过来又允许`p`正确调用析构函数。

或者，如果模拟调用的顺序不重要，简单地删除`InSequence dummy;`也将允许`p`' 的析构函数执行。

顺便说一句，您的代码有几个问题；

*   你的基础结构应该有虚拟析构函数
*   `MyClass::myMethod`应该是虚拟的，以允许 gmock 的功能覆盖它
*   `p->myMethod(p);`应该`p->myMethod();`

# ios - 通过 Django 和 ASIHttpRequest 使用用户身份验证/会话

> ID：10286516
> 
> 赞同：1
> 
> 时间：2012-04-23T18:56:55.067
> 
> 标签：ios, django, authentication, asihttprequest, session-cookies

我正在尝试在 iOS 中创建一个基本的身份验证系统，该系统将 POST 发送到 Django，并在 Django 端对用户进行身份验证并启动会话。现在我可以通过在 URL 中将值作为数据传递并对其进行身份验证来发送用户信息，但是如何从 Django 响应中检索会话数据或 cookie？当我尝试存储或打印出 cookie 时，它​​告诉我数组为空。我已经尝试过 request.requestCookies 和 request.responseCookies。

```
NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:@"test_user", @"username", @"pass", @"password", nil];

NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"http://127.0.0.1:8000/login/"]];

NSError *error;
NSData *data = [NSJSONSerialization dataWithJSONObject:dict options:0 error:&error];

if ( error ) {
    NSLog( @"ERROR - %@", error.localizedDescription );
} else {
    __block ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
    [request addRequestHeader: @"Content-Type" value:@"application/json; charset=utf-8"]; 
    [request appendPostData:data];
    [request setRequestMethod:@"POST"];

    [request setCompletionBlock:^{

        UIAlertView *alerView = [[UIAlertView alloc] initWithTitle:@"Login"
                                                           message:@"Login was sent"
                                                          delegate:nil
                                                 cancelButtonTitle:nil
                                                 otherButtonTitles:@"Ok", nil];
        [alerView performSelectorOnMainThread:@selector(show) withObject:nil waitUntilDone:NO];

        NSLog(@"RESPONSE: %@", [[NSString alloc] initWithData:request.responseData encoding:NSUTF8StringEncoding]);//, [request.requestCookies objectAtIndex:0]);
        NSLog(@"COOKIE: %@", [request.requestCookies objectAtIndex:0]);
        [ASIHTTPRequest addSessionCookie:[request.requestCookies objectAtIndex:0]];

    }]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T17:13:55.390

好的，所以我解决了这个问题，结果发现在服务器端我输入了数据，但没有使用 Django 正式登录（没有返回正确的 cookie），这意味着我的应用程序没有收到正确的标头。

# firefox - Chrome和Firefox之间的CSS3背景渐变问题

> ID：10286517
> 
> 赞同：0
> 
> 时间：2012-04-23T18:56:55.467
> 
> 标签：firefox, google-chrome, css, safari

```
background: -moz-linear-gradient(45deg,  rgba(92,92,92,0.95) 0%,rgba(92,92,92,0.65) 45%,rgba(0,0,0,0.25) 45%,rgba(0,0,0,0.25) 47%,rgba(0,0,0,0) 47%);
background: -webkit-linear-gradient(45deg,  rgba(92,92,92,0.95) 0%,rgba(92,92,92,0.65) 45%,rgba(0,0,0,0.25) 45%,rgba(0,0,0,0.25) 47%,rgba(0,0,0,0) 47%); 
```

这两条线相同，但产生不同的结果。您可以在此处查看正在制作的内容 ( [http://www.eprize.com/what-we-do/#mobile](http://www.eprize.com/what-we-do/#mobile) )。在 Chrome 中，一个显示两个 45 度灰色垂直条纹，而在 Firefox 中，一个在整个图像上流血，而不是第二个垂直条纹。

我花了一些时间在谷歌上搜索，但只找到了 CSS3 生成器的结果，这不是我想要的。让 Firefox 看起来像 Safari 和 Chrome 中的样子有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T12:31:33.237

问题在于 Firefox 坚持所有色标的起点和终点。最后和第 5 个颜色停止应该使渐变的其余部分透明，但没有。这是修复。

```
background: -moz-linear-gradient(45deg, rgba(92, 92, 92, 0.95) 0%, rgba(92, 92, 92, 0.65) 45%, rgba(0, 0, 0, 0.25) 45%, rgba(0, 0, 0, 0.25) 47%, rgba(0, 0, 0, 0) 47%), rgba(0, 0, 0, 0) 100%); 
```

# performance - 如何修复按文本过滤性能不佳的问题

> ID：10286520
> 
> 赞同：0
> 
> 时间：2012-04-23T18:56:58.037
> 
> 标签：performance, jquery

不久前，我发现了一些代码，允许您通过键入文本元素来过滤 SELECT 的内容。它运行良好，但是随着时间的推移，性能会严重下降。我不确定它是过滤器代码还是我激活它的方式。

SELECT 显示在模式对话框（引导程序）中，所以我有以下代码：

```
$('#myModal').on('shown', function () {
  $(".focusable").val("").focus();
  var select = $('#myModal').find(".modal-body").find("select");
  var text = $('#myModal').find(".modal-body").find("input[type='text']");
  select.filterByText(text, true);
}); 
```

这是过滤器代码：

```
jQuery.fn.filterByText = function (textbox, selectSingleMatch) {
  return this.each(function () {
    var select = this;
    var options = [];
    $(select).find('option').each(function () {
      options.push({value:$(this).val(), text:$(this).text(), data:$(this).data("short-name")});
    });
    $(select).data('options', options);
    $(textbox).bind('change keyup', function () {
      var options = $(select).empty().data('options');
      var search = $.trim($(this).val());
      var regex = new RegExp(search, 'gi');

      $.each(options, function (i) {
        var option = options[i];
        if (option.text.match(regex) !== null) {
          var copyOption = $('<option>').text(option.text).val(option.value);
          copyOption.data("short-name", option.data);
          $(select).append(copyOption);
        }
      });
      if (selectSingleMatch === true &&
          $(select).children().length === 1) {
        $(select).children().get(0).selected = true;
      }
    });
  });
}; 
```

谁能阐明我的性能问题可能在哪里以及如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:14:45.767

通读评论，我建议添加以下内容：

```
$(textbox).bind('change keyup', function(event) {
  console.log(event);
  // your code
}); 
```

显示对话框一段时间后，是否在单个按键上多次触发事件？

```
$('#myModal').on('hidden', function () {
  $('#myModal').find(".modal-body").find("input[type='text']").off("change keyup");
}); 
```

# linux - 来自 shell 的 GROUP BY/SUM

> ID：10286522
> 
> 赞同：38
> 
> 时间：2012-04-23T18:57:03.273
> 
> 标签：linux, shell, unix, command-line, awk

我有一个包含如下数据的大文件：

```
a 23
b 8
a 22
b 1 
```

我希望能够得到这个：

```
a 45
b 9 
```

我可以先对这个文件进行排序，然后在 Python 中扫描文件一次。什么是这样做的好直接命令行方式？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-04-23T19:01:25.930

编辑：现代（GNU/Linux）解决方案，如多年前评论中所述；-)。

```
awk '{
    arr[$1]+=$2
   }
   END {
     for (key in arr) printf("%s\t%s\n", key, arr[key])
   }' file \
   | sort -k1,1 
```

最初发布的解决方案，基于旧的 Unix`sort`选项：

```
awk '{
    arr[$1]+=$2
   }
   END {
     for (key in arr) printf("%s\t%s\n", key, arr[key])
   }' file \
   | sort +0n -1 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-23T19:04:48.330

这里不需要 awk，甚至不需要排序——如果你有 Bash 4.0，你可以使用关联数组：

```
#!/bin/bash
declare -A values
while read key value; do
  values["$key"]=$(( $value + ${values[$key]:-0} ))
done
for key in "${!values[@]}"; do
  printf "%s %s\n" "$key" "${values[$key]}"
done 
```

...或者，如果您首先对文件进行排序（这将更节省内存；GNU sort 能够对大于内存的文件进行排序，这是一个天真的脚本——无论是在 awk、python 还是 shell 中——通常不会），您可以以适用于旧版本的方式执行此操作（我希望以下内容适用于 bash 2.0）：

```
#!/bin/bash
read cur_key cur_value
while read key value; do
  if [[ $key = "$cur_key" ]] ; then
    cur_value=$(( cur_value + value ))
  else
    printf "%s %s\n" "$cur_key" "$cur_value"
    cur_key="$key"
    cur_value="$value"
  fi
done
printf "%s %s\n" "$cur_key" "$cur_value" 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-23T22:58:16.493

这个 Perl 单线似乎可以完成这项工作：

```
perl -nle '($k, $v) = split; $s{$k} += $v; END {$, = " "; foreach $k (sort keys %s) {print $k, $s{$k}}}' inputfile 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-04T21:59:30.093

这可以通过以下单线轻松实现：

```
cat /path/to/file | termsql "SELECT col0, SUM(col1) FROM tbl GROUP BY col0" 
```

或者。

```
termsql -i /path/to/file "SELECT col0, SUM(col1) FROM tbl GROUP BY col0" 
```

这里使用了 Python 包[termsql](https://github.com/tobimensch/termsql)，它是 SQLite 的包装器。请注意，目前它没有上传到[PyPI](https://pypi.python.org/pypi)，也只能在系统范围内安装（`setup.py`有点坏），比如：

```
pip install --user https://github.com/tobimensch/termsql/archive/master.zip 
```

## 更新

2020 年 1.0 版本终于上传到[PyPI](https://pypi.org/project/termsql/)，所以`pip install --user termsql`可以使用了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-23T19:44:10.463

一种使用方式`perl`：

```
perl -ane '
    next unless @F == 2; 
    $h{ $F[0] } += $F[1]; 
    END { 
        printf qq[%s %d\n], $_, $h{ $_ } for sort keys %h;
    }
' infile 
```

内容`infile`：

```
a 23
b 8
a 22
b 1 
```

输出：

```
a 45
b 9 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-23T20:05:01.480

使用*GNU awk*（版本小于 4）：

```
WHINY_USERS= awk 'END {
  for (E in a)
    print E, a[E]
    }
{ a[$1] += $2 }' infile 
```

使用*GNU awk* >= 4：

```
awk 'END {
  PROCINFO["sorted_in"] = "@ind_str_asc"
  for (E in a)
    print E, a[E]
    }
{ a[$1] += $2 }' infile 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-24T13:19:09.830

使用`sort`+`awk`组合可以尝试跟随，而不创建数组。

```
sort -k1 Input_file | 
awk '
  prev!=$1 && prev{
    print prev,(prevSum?prevSum:"N/A")
    prev=prevSum=""
  }
  {
    prev=$1
    prevSum+=$2
  }
  END{
    if(prev){
       print prev,(prevSum?prevSum:"N/A")
    }
}' 
```

***说明：***为上述添加详细说明。

```
sort -k1 file1 |                          ##Using sort command to sort Input_file by 1st field and sending output to awk as an input.
awk '                                     ##Starting awk program from here.
  prev!=$1 && prev{                       ##Checking condition prev is NOT equal to first field and prev is NOT NULL.
    print prev,(prevSum?prevSum:"N/A")    ##Printing prev and prevSum(if its NULL then print N/A).
    prev=prevSum=""                       ##Nullify prev and prevSum here.
  }
  {
    prev=$1                               ##Assigning 1st field to prev here.
    prevSum+=$2                           ##Adding 2nd field to prevSum.
  }
  END{                                    ##Starting END block of this awk program from here.
    if(prev){                             ##Checking condition if prev is NOT NULL then do following.
       print prev,(prevSum?prevSum:"N/A") ##Printing prev and prevSum(if its NULL then print N/A).
    }
}' 
```

# duplicates - 将行复制并粘贴到 SAS 数据集中

> ID：10286523
> 
> 赞同：1
> 
> 时间：2012-04-23T18:57:06.950
> 
> 标签：duplicates, sas

是否有任何快速而肮脏的方法可以在数据集中创建观察的副本？我知道我可以将其子集化，然后使用 proc append，但这对于看似如此简单的任务来说似乎是一个不雅的解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-23T19:32:07.587

我认为编码是最简单的方法。

```
data work.have;
 a=1;b=2;c=3;
run;

data work.want;
 set work.have;
 output;

 if a=1 then output; /* Again */
run; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T06:58:43.843

尝试这个

```
data check2(drop=  i );
 set check1;
 output;
  do i = 1 to datediff;
   output;
  end;
 run; 
```

在有两个日期的地方，我试图插入重复行数，其中行数不同，并且等于两个日期之间的月差。

# c# - Control.Invoke() 给出一个 XML 异常

> ID：10286525
> 
> 赞同：1
> 
> 时间：2012-04-23T18:57:11.483
> 
> 标签：c#, winforms, multithreading

我正在用 C# 编写一个使用表单的应用程序。这是我第一个用 C# 编写的应用程序，所以我是个初学者。

这是有问题的代码

```
if (tabControl1.InvokeRequired)
{
    stringDelegateC sdc = new stringDelegateC(manageCode);
    this.Invoke(sdc, new object[] { text });
}
else
... 
```

该变量`text`始终是格式为“PM”的字符串，后跟一个数字。它在大多数情况下都可以正常工作，但是什么时候`text`是“PM11020”，我收到`System.Xml.XmlException`消息“解析实体名称时发生错误。第 5 行，位置 25。”。异常被抛出`this.Invoke(sdc, new object[] { text });`

如果`text`是“PM11120”，它工作正常。

我对此感到非常困惑，我不知道 XML 与任何事情有什么关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:11:26.437

该 XML 异常可能是由该`manageCode`方法引发的，与`Control.Invoke`.

# ms-access - 捕获主键值

> ID：10286534
> 
> 赞同：4
> 
> 时间：2012-04-23T18:57:52.367
> 
> 标签：ms-access, vba

我正在使用以下代码向表中添加一条记录：

```
Dim rs1 As DAO.Recordset
Set rs1 = CurrentDb.OpenRecordset("QUOTE-Run", dbOpenDynaset)

rs1.AddNew
rs1.Fields("[QuoteNumber]").value = [txtQuoteNumber].value
rs1.Fields("[LeadTime]").value = [txtLeadTime].value
rs1.Fields("[Qty]").value = [txtQty].value
rs1.Fields("[Title]").value = [txtTitle].value
rs1.Fields("[Date]").value = VBA.DateTime.Date
rs1.Fields("[Time]").value = VBA.DateTime.Time
rs1.Fields("[InitiatedBy]").value = Application.CurrentUser
rs1.Fields("[IncompleteProblemNotes]").value = [txtIncompleteProblemNotes].value
rs1.Fields("[CustomerNotes]").value = [txtCustomerNotes].value
rs1.Fields("[Memo]").value = [txtMemo].value
rs1.Fields("[Memo1]").value = [txtMemo1].value
rs1.Fields("[PrefferedQuoteRunSelect]").value = [txtPrefferedQuoteRunSelect].value
rs1.Fields("[CombinedRun]").value = [chkCombinedRun].value
rs1.Update 
```

创建记录时，有一个名为 RunID 的自动编号主键字段会获取一个值。我需要知道该值是什么，以便稍后在代码中使用它。获取该价值的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:03:50.790

我能想到的获取 RunID 值的最简单方法是在更新记录之前声明一个变量并将该变量设置为等于该字段。像这样的东西：

```
 Dim rs1 As DAO.Recordset
   Set rs1 = CurrentDb.OpenRecordset("QUOTE-Run", dbOpenDynaset)
   Dim TempRunID As Long

   rs1.AddNew
   rs1.Fields("[QuoteNumber]").value = [txtQuoteNumber].value
   rs1.Fields("[LeadTime]").value = [txtLeadTime].value
   rs1.Fields("[Qty]").value = [txtQty].value
   rs1.Fields("[Title]").value = [txtTitle].value
   rs1.Fields("[Date]").value = VBA.DateTime.Date
   rs1.Fields("[Time]").value = VBA.DateTime.Time
   rs1.Fields("[InitiatedBy]").value = Application.CurrentUser
   rs1.Fields("[IncompleteProblemNotes]").value = [txtIncompleteProblemNotes].value
   rs1.Fields("[CustomerNotes]").value = [txtCustomerNotes].value
   rs1.Fields("[Memo]").value = [txtMemo].value
   rs1.Fields("[Memo1]").value = [txtMemo1].value
   rs1.Fields("[PrefferedQuoteRunSelect]").value = [txtPrefferedQuoteRunSelect].value
   rs1.Fields("[CombinedRun]").value = [chkCombinedRun].value

   TempRunID = rs1.Fields("[RunID]").value
   rs1.Update 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:22:37.443

您可以运行使用该函数的第二个查询

```
SELECT LAST_INSERT_ID(); 
```

# sharepoint - 页面布局中的 SharePoint 2010“通过电子邮件发送链接”

> ID：10286536
> 
> 赞同：0
> 
> 时间：2012-04-23T18:57:56.563
> 
> 标签：sharepoint, email, sharepoint-2010, controls, page-layout

我有一个关于 OOB SharePoint 2010 功能“通过电子邮件发送链接”的问题，该功能显示在列表/库中并包含项目。

我正在为客户开发一种“文章页面布局”。在文章的底部，他们希望能够对文章进行评分、评论文章以及向包含文章链接的人发送电子邮件。

对于评论，我使用了用户配置文件中包含的 SharePoint 评论社交功能。对于评级，我使用了 SharePoint 列表/库项目评级功能。我只是在页面布局上对这两个控件进行了控制，效果很好。

现在，我需要一个“通过电子邮件发送链接”选项。我立即想到了 3 个解决方案 1\. 使用 SharePoint OOB 功能“通过电子邮件发送链接”并将其放置在页面布局上。2\. 使用自定义工作流程。3\. 使用 jQuery。

显然，我想尽可能利用 SharePoint OOB 功能。我相信必须可以将“通过电子邮件发送链接”按钮从功能区“移动”到页面布局。该页面仍然是一个库项目，所以它应该能够工作。

**谁能指导我如何将“通过电子邮件发送链接”按钮从功能区移动到页面布局？**

谢谢！

-乔什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T15:53:16.737

我在这里回答了这个问题：http: [//social.msdn.microsoft.com/Forums/ar/sharepoint2010general/thread/a934c1ae-b8ec-40bf-ad31-fb7fccdbdacd](http://social.msdn.microsoft.com/Forums/ar/sharepoint2010general/thread/a934c1ae-b8ec-40bf-ad31-fb7fccdbdacd)

# java - Android应用程序开发：java vs. jquery mobile

> ID：10286538
> 
> 赞同：5
> 
> 时间：2012-04-23T18:58:00.113
> 
> 标签：java, javascript, android, jquery-mobile

我想为一个学校项目构建一个 android 应用程序，但我有点困惑，我看到我可以使用 Java 或使用 Jquery mobile 构建一个应用程序。

他们有同样的能力吗？

如果我使用 Jquery 构建应用程序，我可以打包它并像 java 应用程序（作为 apk）一样安装它还是仅用于构建网站？

如果是这样，我用什么工具来打包它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-23T19:00:32.047

jQuery Mobile 需要一个在 JavaScript 和 Java 之间进行通信的中介框架。[PhoneGap](http://www.phonegap.com)是这些框架中流行的一种。

PhoneGap 也得到积极维护，他们几乎每个月都会推出新版本。

使用 PhoneGap/jQuery Mobile 的主要原因是，如果您已经了解 HTML/JS/CSS，它会使开发变得容易。使用 PhoneGap 的另一个重要原因是，您可以将现有网站用作本地应用程序的基础，是的，复数，不仅是 Android，还有 iOS、Blackberry 等。它还为您提供了带有一些小部件的预构建 UI，因此您不必自己动手。

jQuery Mobile 文档讨论了[使用 PhoneGap 和 jQuery Mobile 创建本机应用程序的一些注意事项](http://jquerymobile.com/demos/1.1.0/docs/pages/phonegap.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T10:49:00.463

Jquery Mobile Framework 提供了 Web 应用程序在不同手持设备上的外观方式，但这不能使用本机设备功能，例如从通讯录/应用程序中获取联系人。而本机应用程序具有处理所有系统生成的事件或广播的能力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T20:16:05.837

我不知道您已经尝试过什么或您的技能是什么（根据您的 stackoverflow 历史，您可能比我更了解 java），但您最好只使用[Android SDK](http://developer.android.com/index.html)。我能够设计和完成一个自定义业务项目，并在此过程中学习 Java。我无法对 jQuery 发表太多评论，因为我从未使用过它。由于 Jasper 列出的原因，jQuery 看起来可能不错，但如果您不需要在其他平台上运行您的应用程序，它可能会增加您不需要处理的复杂层。

# visual-studio-2010 - 方法应该向单元测试抛出异常吗？

> ID：10286541
> 
> 赞同：0
> 
> 时间：2012-04-23T18:58:29.690
> 
> 标签：visual-studio-2010, unit-testing, c#-4.0

我有一个发送电子邮件的简单方法：

```
public void notifyEmail(string messageSubject, string messageBody)
{
   MailMessage message = new MailMessage(from, to);

   message.Subject = messageSubject;
   message.Body = messageBody;

   SmtpClient client = new SmtpClient(smtp_client);
   client.Send(message);

   message.Dispose();//release everything related
} 
```

还有一个单元测试（我正在学习）：

```
[TestMethod()]
    public void notifyEmailTest()
    {
        eMail target = new eMail("TEST Subject","TEST Body"); // TODO: Initialize to an appropriate value

        bool testSent = true;
        try
        {
            target.notifyEmail();
        }
        catch (Exception)
        {
            testSent = false;
        }

        Assert.IsTrue(testSent);            
    } 
```

我故意将 smtp_client 变量值设置为无效的值。

在我的项目中运行代码会导致错误。

运行测试方法会导致通过。我的测试或方法是否应该采用不同的结构以使错误无法通过测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:04:12.157

如果您希望这`target.notifyEmail()`应该引发异常，那么这就是您应该测试的内容。如果您使用的是 NUnit，您可以使用`Assert.Throws<T>`，例如

```
[Test]
public void notifyEmailTestFails()
{
    // TODO: Initialize to an appropriate value
    eMail target = new eMail("TEST Subject","TEST Body"); 
    Assert.Throws<InvalidOperationException>(target.notifyEmail());
} 
```

但是，现在我看到您正在使用 VSUnit，您应该按照`[ExpectedException(typeof(...))]` 其他答案中的说明使用。

一般来说，您应该对成功、失败和异常条件进行单独的测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T19:07:08.303

我总是尽我所能避免将 try-catch 子句放在我的单元测试中。而是尝试使用 ExpectedException 属性（NUnit 和 MSTest 的属性相同）并将类型设置为您期望的异常，即

```
[TestMethod]
[ExpectedException(typeof(NetworkException))]
public void ShouldThrowNetworkExceptionIfSmtpServerIsInvalid)
{
     //... test code here.
} 
```

我使用的另一种方法是使用 AssertExpectedException 方法创建一个静态类，因为有时一个方法可能会由于不同的原因引发相同类型的异常，并且确定是否返回准确消息的唯一方法是使用自定义代码，因为该属性不断言抛出的异常返回的消息。

希望这可以帮助。

问候。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T19:04:45.243

我通常这样做的方式是用`ExpectedException`（ [http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.expectedexceptionattribute(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.expectedexceptionattribute(v=vs.80).aspx)）装饰测试

. 但是你想捕捉比“异常”更不通用的东西。

如果您不想使用预期的异常，那么代替：

```
 bool testSent = true;

        try
        {
            target.notifyEmail();
        }
        catch (Exception)
        {
            testSent = false;
        }

        Assert.IsTrue(testSent); 
```

你可以不那么冗长：

```
try{
 target.notifyEmail();
 Assert.Fail("Expected an exception here");
}
catch (SmtpException){

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T20:33:48.970

我强烈建议您尝试 FluenAssertions：

[http://fluentassertions.codeplex.com/](http://fluentassertions.codeplex.com/)

**它们简单而优雅**

他们让你检查异常消息（你不能用`ExpectedException`属性做到这一点）

例子：

```
using FluentAssertions;

[TestMethod]
public void notifyEmailTest()
{
    eMail target = new eMail("TEST Subject","TEST Body"); // TODO: Initialize to an appropriate value

target.Invoking(x => x.notifyEmail())
    .ShouldThrow<YourExcpectedException>()
            .WithMessage("Your expected message", FluentAssertions.Assertions.ComparisonMode.Substring);
} 
```

# php - HTML 默认浏览值

> ID：10286547
> 
> 赞同：1
> 
> 时间：2012-04-23T18:58:53.060
> 
> 标签：php, html

是否可以在 HTML/PHP 的“文件浏览”选项中设置默认值？例如：

```
<b>Enter Image:</b></font><input type="file" name="ima" accept="image/gif"> 
```

我可以在其中设置默认文件名吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:02:53.623

否 - 因为这将是一个安全问题。考虑将默认设置为`/etc/passwd`和按下提交的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:04:16.803

由于您的文件名将与运行代码的计算机相关，因此我不确定这样做是否有益。据我所知，你不能因为这个原因。

# php - 是否可以仅使用 PHP（无 JS）构建可折叠的树视图列表

> ID：10286548
> 
> 赞同：4
> 
> 时间：2012-04-23T18:58:57.380
> 
> 标签：php, recursion, nested-lists, collapsable

我有两个函数可以在我的网站上共同构建一个树视图列表。它基于递归，并允许构建具有无限数量节点的树视图。

但我不能让它折叠起来。例如：脚本应确定是否`$_GET['node'] == $node_id`显示（展开）块元素及其所有父元素，如果是，则显示（展开）块元素。所以，我需要将顶部的“显示”参数传递给根。

事情在`$display`和`$display2`vars中。

*   我有一个包含三列（id、parent_id、name）的经典数据库表。根节点没有填充 parent_id 字段。
*   hrefs 链接到只是一个 GET 参数。GET 参数表示节点号。

我只需要根据我选择的节点来使用这种折叠技术。

更新：好的，有一个完整且经过纯化的信息。我创建了一个 php 文件，使用一个只包含一个表的数据库。只是为了理解这个问题：

1 我使用 sqlite3 数据库格式。这是数据库转储：

```
        # sqlite3 目录.sqlite .dump
    PRAGMA foreign_keys=OFF；
    开始交易；
    创建表组（id INTEGER PRIMARY KEY NOT NULL，名称 TEXT，parent_id INTEGER）；
    插入“组”值（1，'root1'，''）；
    插入“组”值（2，'root2'，''）；
    插入“组”值（3，'root3'，''）；
    插入“组”值（4，'root4'，''）；
    插入“组”值（5，'sub1'，1）；
    插入“组”值（6，'sub3'，3）；
    插入“组”值（7，'subsub1'，5）；
    插入“组”值（8，'subsubsub1'，7）；
    插入“组”值（9，'subb1'，1）；
    犯罪;

```

2 这是一个PHP文件，处理数据库。

```
<?php

$db = new SQLite3('catalog.sqlite');

function build_catalog($db){ //build roots and diggs for childnodes for every root in a loop
    //$content_root="<ul id='collapsedlist'>";
    $content_root = '';
    $roots = $db->query('SELECT * from groups WHERE parent_id="" OR parent_id is null');
    while($root = $roots->fetchArray()){
        list ($content,$display)=get_children_of_node($db,$root['id']); 
        $content_root .= "<li id='".$root['id']."' ><a href='/?node=".$root['id']."'>".$root['name']."</a>";
        $content_root .= $content;
        $content_root .= "</li>\n";
    }
    $content_root = "<ul id='collapsedlist'>".$content_root."</ul>\n";

    return $content_root;
}

function get_children_of_node($db,$node_id){
    if(!isset($content)) $content = '';
    $display = (isset($_GET['node']) && $_GET['node'] == $node_id)? "style='display:block'" : "style='display:none'";
    $query = $db->querySingle('SELECT count(*) from groups WHERE parent_id='.$node_id);
    if ($query > 0){
        //$content .= "<ul class='subcategories'>\n";
        $children = $db->query('SELECT * from groups WHERE parent_id =\''.$node_id.'\'');
        while ($child = $children->fetchArray()){
            list($content2,$display)=get_children_of_node($db,$child['id']);
            $content .= "<li id='".$child['id']."' ".$display.">";
            $content .= "<a href='/?node=".$child['id']."'>".$child['name']."</a>";
            $content .= $content2;
            $content .= "</li>\n";
        }
        $content = "<ul class='subcategories' ".$display.">".$content."</ul>\n";
    }
    return array($content,$display);
}

?> 
```

这里的 php 文件以上面的纯 HTML 结尾。我在这里把它一个一个分开，因此编辑器不能一次解析 HTML+PHP 语法。但它是同一个 index.php 文件。HTML部分：

```
 <html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Collapsible Nested List</title>
    </head>
    <body>
        <div id="sidebar">
            <?=build_catalog($db);?>
        </div>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T15:17:08.070

这是您的问题的快速解决方案，保持相同的 HTML 只需用以下代码替换您的 PHP。

```
function get_children($db, $parent_id) {
    $res = $db->query("SELECT * FROM groups WHERE parent_id='$parent_id'");
    if (!$res) return array();

    $out = array();
    while ($row = $res->fetchArray(SQLITE3_ASSOC)) $out[$row['id']] = $row;
    return $out;
}

function get_parent_id($db, $node_id) {
    return $db->querySingle("SELECT parent_id FROM groups WHERE id='$node_id'");
}

function get_menu($db, $node_id) {
    $menu = get_children($db, $node_id);
    while (($parent_id = get_parent_id($db, $node_id)) !== null) {
        $temp = get_children($db, $parent_id);
        $temp[$node_id]['children'] = $menu;
        $menu = $temp;
        $node_id = $parent_id;
    }
    return $menu;
}

function build_html(array $menu) {
    $str = '';
    foreach ($menu as $id => $item) {
        $str .= sprintf('<li><a href="?node=%s">%s</a></li>', $id, $item['name']);
        if (isset($item['children']))
            $str .= build_html($item['children']);
    }
    return "<ul>$str</ul>";
}

function build_catalog($db) {
    $menu = get_menu($db, isset($_GET['node']) ? intval($_GET['node']) : '');
    return build_html($menu);
} 
```

如果您的“组”表非常小，则可以真正优化此代码。一个想法是获取 $groups 数组中的所有记录并构建 parent_id 索引。这样，目录的构建就会容易得多。

# javascript - 在 jQuery AJAX 选项卡中使用 preventDefault() 和 on()

> ID：10286550
> 
> 赞同：0
> 
> 时间：2012-04-23T18:59:17.570
> 
> 标签：javascript, ajax, jquery-ui, tabs, preventdefault

我有一组 jQuery UI AJAX 选项卡，它们在单击时加载单个 .php 页面。我的所有样式等都传达了，因为包含选项卡小部件的页面提供了已经链接的 CSS 和脚本。然而，当谈到单击选项卡时加载的实际页面时，我看不到在这些新创建的 DOM 元素上让 preventDefault() 与 .on() 一起使用。

我在标签中使用 jQuery BBQ，所以我不能将“#”附加到 URL。这是在单击选项卡面板中的链接时引起的。我已经能够在最初加载的 DOM 元素上成功使用 preventDefault() ，但不能通过 AJAX 将其提取到选项卡小部件中。

我的内容切换器功能是......

```
$(function(){
$(".showMoreOrLess").on('click', (function() {
if (this.className.indexOf('clicked') != -1 ) {
    $(this).removeClass('clicked');
    $(this).prev().slideUp(500);
    $(this).html("Read More" + "<span class='moreUiIcon'></span>");
    }
    else {
    $(this).addClass('clicked');
    $(this).prev().slideDown(500);
    $(this).html("See Less" + "<span class='lessUiIcon'></span>");
    }       
}));
}); 
```

我想将此函数中的 preventDefault() 组合到其中。

```
// prevents default link behavior on BBQ history stated tab panels with "showMoreOrLess" links
$(".showMoreOrLess").click(function (event) 
{ 
 event.preventDefault(); 
 //here you can also do all sort of things 
});
 // /prevents default behavior on "showMoreOrLess" links 
```

我尝试了几种使用 .on("click", function(work)) 等的方法。我在一个单独的函数中使用了 .on() 并且还尝试将它组合到上面的第一个函数中。有谁知道我做错了什么？该代码适用于静态的选项卡内容，而不是通过 AJAX 加载的内容。任何帮助将不胜感激。似乎无法弄清楚这一点。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:22:25.587

该部分`$(".showMoreOrLess").click`仅适用于您页面上已经可访问的链接

尝试使用事件委托（这里每次都会在现有元素上捕获点击，并且您只需传递它正在监视的选择器......作为一个很好的副作用，您可以保存侦听器

```
$(document).on("click", ".showMoreOrLess", function(event) {
  event.preventDefault(); 
  //here you can also do all sort of things 
}); 
```

而不是文档使用您页面中的某个 id `$("#myContainerId")`（编辑：当然，您单击的元素需要在具有 id 的元素内）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:30:03.503

```
$("body").on('click', ".showMoreOrLess", function(event) {
  event.preventDefault();
  var self = $(this);
  if (self.hasClass('clicked')) {
    self.html("Read More" + "<span class='moreUiIcon'></span>").removeClass('clicked').prev().slideUp(500);
  }else {
    self.html("See Less" + "<span class='lessUiIcon'></span>").addClass('clicked').prev().slideDown(500);
  }
}); 
```

# php - 如何使用 PHP 从包含 XML 的 C++ 字符串中读取 XML

> ID：10286554
> 
> 赞同：0
> 
> 时间：2012-04-23T18:59:21.827
> 
> 标签：php, xml

我有包含由 C++ 程序生成的 XML 的字符串。PHP 执行我的 C++ 代码并且应该将此 XML 传递给 javascript。但我不知道该怎么做。我在 PHP 中使用了 exec,system 方法来获取这个 XML 字符串。请让我知道如何将确切的 XML 传递给 javascript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T11:18:00.593

你的问题很不具体，所以我只能猜测：

```
passthru($command) 
```

见[`passthru`](http://php.net/passthru)。

# math - 有一组点形成一个圆圈如何随机化一个坐标？

> ID：10286555
> 
> 赞同：0
> 
> 时间：2012-04-23T18:59:23.530
> 
> 标签：math, 3d, geometry, pseudocode

我们有一个数组或点（双精度的 X、Y、Z）它们形成一个圆，从默认的旋转角度 Xa、Ya、Za 开始。我们想在某个随机变量上将圆中的每个点扩展一个轴（比如 Z）。如何在伪代码中做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:12:33.783

你的意思是这样的（伪代码）：

```
void randomize(Point[] points, Axis axis, double scale) {
    RandomNumberGenerator rng = new RandomNumberGenerator();
    for (Point point : points) {
        point[axis] += scale * rng.nextRandom();
    }
} 
```

如果您需要沿某个不是轴的方向移动点，您可以修改上面的内容以计算位移矢量分量并将每个分量添加到相应的点坐标。

# ajax - 找不到与绑定 WebHttpBinding 的终结点的方案 http 匹配的基地址。注册的基地址方案是 [https]

> ID：10286556
> 
> 赞同：0
> 
> 时间：2012-04-23T18:59:28.633
> 
> 标签：ajax, wcf, https

我已经尝试过谷歌以及其他关于 SO 的帖子，到目前为止我所尝试的都没有解决我的问题。

我以为[这](http://weblogs.asp.net/srkirkland/archive/2008/02/20/wcf-bindings-needed-for-https.aspx)就是答案。没有骰子。我还阅读了 SO 上的大多数帖子，其中提到了我收到的相同错误消息，例如[this](https://stackoverflow.com/questions/9817718/could-not-find-a-base-address-that-matches-scheme-https-for-the-endpoint-with-bi)。

我的网站是安全的，https。我有 3 个 WCF 服务来处理我在此站点上运行的异步 ajax 内容。当我尝试访问任何这些服务时，我收到此错误：

> 找不到与绑定 WebHttpBinding 的终结点的方案 http 匹配的基地址。注册的基地址方案是 [https]。

我的配置：

```
<behaviors>
    <endpointBehaviors>
        <behavior name="ajaxBehavior">
            <enableWebScript />
        </behavior>
    </endpointBehaviors>
    <serviceBehaviors>
        <behavior name="ajaxAsynchBehavior">
            <serviceMetadata httpsGetEnabled="true" />
            <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
     </serviceBehaviors>
</behaviors>  
<bindings>
    <webHttpBinding>
        <binding name="webBinding">
            <security mode="Transport" />
        </binding>
    </webHttpBinding>
</bindings>
<services>
    <service name="MyApp.Web.Services.CascadingList">
        <endpoint address="" behaviorConfiguration="ajaxAsynchBehavior"
                    binding="webHttpBinding" bindingConfiguration="webBinding" contract="MyApp.Web.Services.CascadingList" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
        <host>
            <baseAddresses>
                <add baseAddress="https://[domain]/MyApp/Services/CascadingList.svc" />
            </baseAddresses>
        </host>
    </service>
    <service name="MyApp.Web.Services.AutoComplete">
        <endpoint address="" behaviorConfiguration="ajaxAsynchBehavior"
                    binding="webHttpBinding" bindingConfiguration="webBinding" contract="MyApp.Web.Services.AutoComplete" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
        <host>
            <baseAddresses>
                <add baseAddress="https://[domain]/MyApp/Services/AutoComplete.svc" />
            </baseAddresses>
        </host>
    </service>
    <service name="MyApp.Web.Services.Validation">
        <endpoint address="" behaviorConfiguration="ajaxAsynchBehavior"
                    binding="webHttpBinding" bindingConfiguration="webBinding" contract="MyApp.Web.Services.Validation" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
        <host>
            <baseAddresses>
                <add baseAddress="https://[domain]/MyApp/Services/Validation.svc" />
            </baseAddresses>
        </host>
    </service>
</services> 
```

我应该可以访问“ [https://[domain]/MyApp/SubmitNew.aspx](https://[domain]/MyApp/SubmitNew.aspx) ”并且级联列表应该可以工作。

目前，“父”列表显示“[方法 500]”，子列表保持禁用状态。

当我点击“SubmitNew”页面时，我的服务器的事件日志显示“*发件人信息：System.ServiceModel.Activation.HostedHttpRequestAsyncResult/51442863 异常：System.ServiceModel.ServiceActivationException：无法激活服务'/MyApp/Services/CascadingList.svc'由于编译期间出现异常。异常消息是：找不到与绑定 WebHttpBinding 的端点的方案 http 匹配的基地址。注册的基地址方案是 [https]。* "

如果我直接导​​航到“ [https://[domain]/MyApp/Services/CascadingList.svc](https://[domain]/MyApp/Services/CascadingList.svc) ”，我也会收到上述错误。

* * *

## 更新

这发生在我们的生产服务器上。在我加入公司之前很久就建立了带有 SSL 证书的安全站点。我刚刚在安全站点下为我的新 Web 应用程序添加了一个新的虚拟目录。

在 IIS 中：

```
Secure Web Applications (has SSL cert)
    MyApp
    WebApp1
    WebApp2 
```

我修复了我的配置（上图）以使用正确的行为配置。

**-- 2012.04.24 13:15 CDT --**

当我将配置更改为此（如下）时，我收到此错误：“ *System.ServiceModel.ServiceActivationException：由于编译期间出现异常，无法激活服务'/MyApp/Services/CascadingList.svc'。异常消息是：有没有名为 'ajaxAsynchBehavior' 的**端点行为***"

```
<serviceBehaviors>
    <behavior name="ajaxAsynchBehavior">
        <serviceMetadata httpsGetEnabled="true" />
        <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
</serviceBehaviors>

<services>
    <service name="MyApp.Web.Services.CascadingList">
        <endpoint address="" behaviorConfiguration="ajaxAsynchBehavior"
                    binding="basicHttpBinding" bindingConfiguration="ajaxBinding" contract="MyApp.Web.Services.CascadingList" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
        <host>
            <baseAddresses>
                <add baseAddress="https://[domain]/MyApp/Services/CascadingList.svc" />
            </baseAddresses>
        </host>
    </service>
    .
    .
    .
</services> 
```

所以我把它改回：

```
<behaviors>
    <endpointBehaviors>
        <behavior name="ajaxBehavior">
            <enableWebScript />
        </behavior>
        <behavior name="clientBehavior" />
    </endpointBehaviors>
    <serviceBehaviors>
        <behavior name="ajaxAsynchBehavior">
            <serviceMetadata httpsGetEnabled="true" />
            <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
    </serviceBehaviors>
</behaviors>

<services>
    <service name="MyApp.Web.Services.CascadingList">
        <endpoint address="" behaviorConfiguration="ajaxBehavior"
                    binding="basicHttpBinding" bindingConfiguration="ajaxBinding" contract="MyApp.Web.Services.CascadingList" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
        <host>
            <baseAddresses>
                <add baseAddress="https://[domain]/MyApp/Services/CascadingList.svc" />
            </baseAddresses>
        </host>
    </service>
    .
    .
    .
</services> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T12:14:38.917

我将把答案归功于 dmusial（包括所有评论），但我想发布我的最终配置更改，以防万一这对其他人有利。

[这篇](https://stackoverflow.com/questions/877669/binding-not-working-in-dual-mode-webhttpbinding-and-basichttpbinding)文章还帮助我找到了解决方案。

```
<system.serviceModel>
    <behaviors>
        <endpointBehaviors>
            <behavior name="webScriptEnablingBehavior">
                <enableWebScript />
            </behavior>
            <behavior name="clientBehavior" />
        </endpointBehaviors>
        <serviceBehaviors>
            <behavior name="webScriptEnablingBehavior">
                <serviceMetadata httpsGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="false" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <bindings>
        <webHttpBinding>
            <binding name="webBinding">
                <security mode="Transport" />
            </binding>
        </webHttpBinding>
        <wsHttpBinding>
            <binding name="customBinding" closeTimeout="00:01:00"
                openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferPoolSize="1048576" maxReceivedMessageSize="1048576"
                messageEncoding="Text" textEncoding="utf-8" useDefaultWebProxy="true">
                <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                <reliableSession ordered="true" inactivityTimeout="00:10:00" enabled="true" />
                <security mode="None">
                    <transport clientCredentialType="None" />
                    <message clientCredentialType="None" negotiateServiceCredential="false" establishSecurityContext="false" />
                </security>
            </binding>
        </wsHttpBinding>
    </bindings>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
    <services>
        <service name="MyApp.Web.Services.CascadingList" behaviorConfiguration="webScriptEnablingBehavior">
            <endpoint address="" behaviorConfiguration="webScriptEnablingBehavior"
            binding="webHttpBinding" bindingConfiguration="webBinding" contract="MyApp.Web.Services.CascadingList" />
            <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
        </service>
        <service name="MyApp.Web.Services.AutoComplete" behaviorConfiguration="webScriptEnablingBehavior">
            <endpoint address="" behaviorConfiguration="webScriptEnablingBehavior"
            binding="webHttpBinding" bindingConfiguration="webBinding" contract="MyApp.Web.Services.AutoComplete" />
            <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
        </service>
        <service name="MyApp.Web.Services.Validation" behaviorConfiguration="webScriptEnablingBehavior">
            <endpoint address="" behaviorConfiguration="webScriptEnablingBehavior" binding="webHttpBinding" bindingConfiguration="webBinding" contract="MyApp.Web.Services.Validation" />
            <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
        </service>
    </services>
</system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:06:35.130

您的配置看起来不错，除了不会附加的服务行为，因为您没有在标签中添加`behaviorConfiguration`正确的名称。`<service>`但这不会导致您的错误。

您是否有机会使用 Visual Studio 内置 Web 服务器 (Cassini)？因为它看起来像你这样做，请记住它**不**支持 HTTPS。这可能就是您收到错误的原因。尝试将您的站点部署到本地 IIS 服务器并检查它是否可以正常工作。[您可以在此处](http://weblogs.asp.net/scottgu/archive/2007/04/06/tip-trick-enabling-ssl-on-iis7-using-self-signed-certificates.aspx)查看如何在 IIS 7 上设置 https 开发网站。还有一件事，一旦您将站点部署到 IIS，请记住`baseAddress`标记将被忽略，但您的服务将可以通过其原始名称访问，即 CascadingList.svc（除非配置不同）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-15T16:41:17.097

我用这个配置解决了我的问题：

```
<system.serviceModel>
    <bindings>
        <webHttpBinding>
            <binding name="webBinding">
                <security mode="Transport">
                </security>
            </binding>
        </webHttpBinding>
    </bindings>
    <protocolMapping>
      <add binding="webHttpBinding" bindingConfiguration="webBinding" scheme="https" />
    </protocolMapping>
</system.serviceModel> 
```

# c - Doxygen 创建表

> ID：10286558
> 
> 赞同：2
> 
> 时间：2012-04-23T18:59:29.177
> 
> 标签：c, doxygen, doxywizard

我有一个多人编写和编辑的程序。程序的某些部分将软件值链接到用户指定的特定引脚。正在使用的引脚分布在多个文件之间，我想创建一个中心参考。我想使用 doxygen 创建一个列出引脚号的参考，然后是指定的用途。所有引脚分配都在头文件中定义，如下所示：

```
//spi1.h
// Pin assignments (GPIO row A)
#define SPI_SS_1            (0)
#define SPI_CLK_1           (1)
#define SPI_MOSI_1          (2)
#define SPI_MISO_1          (3)

//spi2.h
// Pin assignments (GPIO row A)
#define SPI_CLK_2           (7)
#define SPI_DOUT_2          (8)
#define SPI_DIN_2           (9)
#define SPI_CS_2_0          (10)
#define SPI_CS_2_1          (11)
#define SPI_CS_2_2          (12)
#define SPI_CS_2_3          (13) 
```

我将如何使用 doxygen 为这些值创建参考图表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:16:42.930

您可以`#define`使用 doxygen 的[分组机制将](http://www.doxygen.nl/manual/grouping.html)这些 s 组合在一起。从这个页面：

> 要定义一个组，您应该将`\defgroup`命令放在一个特殊的注释块中。该命令的第一个参数是应该唯一标识组的标签。第二个参数是应该出现在文档中的组的名称或标题。
> 
> `\ingroup`您可以通过在其文档块中放置命令来使实体成为特定组的成员。
> 
> 为避免将`\ingroup`命令放入每个成员的文档中，您还可以通过组`@{`之前的打开标记和组之后的结束标记将成员组合在一起`@}`。标记可以放在组定义的文档中，也可以放在单独的文档块中。

在实践中，您可以在每个头文件中放入如下内容：

```
/** \addtogroup pin-assignments
 *  @{
 */
#define SPI_SS_1            (0)
#define SPI_CLK_1           (1)
#define SPI_MOSI_1          (2)
#define SPI_MISO_1          (3)
/** @}*/ 
```

将上述每个`#define`s 添加到`pin-assignments`组中。然后，您可以使用以下命令更详细地记录该组[`defgroup`](http://www.doxygen.nl/manual/commands.html#cmddefgroup)，例如：

```
/** \defgroup pin-assignments Pin assignments (GPIO row A) 

More detailed description goes here.
*/ 
```

（注：以上未经测试）

# sql - SQL，在日期/时间之间进行选择

> ID：10286561
> 
> 赞同：1
> 
> 时间：2012-04-23T18:59:47.577
> 
> 标签：sql, sql-server-2008, date, time, between

这适用于（MS SQL Server 2008）它允许用户安排其他用户的开始和结束日期/时间，而不会重叠。

我正在解决在日程安排期间不能重叠个人的业务规则。EG，如果用户 1 计划从 2012 年 1 月 1 日到 2012 年 1 月 4 日，则用户 2 应该无法提交 2012 年 1 月 2 日到 2012 年 1 月 4 日的请求。这部分已经处理好了，这是我的SQL。

```
SELECT * FROM fooTable
WHERE
    Prim = 1
AND 
    Group = 10
AND
    (('2012-06-01 08:01' between startdate and enddate
   OR '2012-06-03 08:01' between startdate and enddate)
OR
   ('2012-06-01 08:01' < startdate) AND ('2012-06-03 8:01' > enddate)) 
```

我现在有一个要求，允许时间表重叠，因为新班次可以在最后一个班次结束时开始。例如，我的结束日期是 2012 年 1 月 1 日晚上 8:00 - 我应该可以安排某人在 2012 年 1 月 1 日和晚上 8:00 开始。

需要一些帮助来思考这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:29:50.920

首先，不要`Group`用作列名。它是每个 SQL 标准中的保留字。`grp`为了我的回答，我将其重命名为。

试图安排一个新的转变，`'2012-06-01 08:00'`从`'2012-06-03 08:00'`...

```
INSERT INTO tbl (prim, grp, startdate, enddate)
SELECT 1, 10, '2012-06-01 08:00', '2012-06-03 08:00'
WHERE  NOT EXISTS (
    SELECT *
    FROM   tbl
    WHERE  prim = 1
    AND    grp = 10
    AND   '2012-06-03 08:00' > startdate -- not >= to allow sharing a border
    AND   '2012-06-01 08:00' < enddate   -- and not BETWEEN ... AND either
    ) 
```

请注意，我比较：

```
新结束   > 旧开始
新开始<旧结束

```

如果您使用`BETWEEN .. AND ..`，则在测试中包含转变的边界。这与使用`>=`and相同`<=`。您需要使用`>`and`<`允许边界重叠。

好吧，试试我大大简化的语法。不知道你最初在那里有什么。
这是[sqlfiddle.com 上的一个工作演示](http://sqlfiddle.com/#!3/56fb5/1)。

# asp.net-mvc-3 - JQuery Mobile：关闭对话框重新加载调用页面

> ID：10286562
> 
> 赞同：0
> 
> 时间：2012-04-23T18:59:57.177
> 
> 标签：asp.net-mvc-3, jquery-mobile

我有一个 Jquery Mobile 应用程序，其中的一个页面需要显示 MessageBox 对话框的等效项以向用户显示消息。我让对话框正常显示，但是当对话框关闭调用它的页面时，它会重新加载。我只想让对话框消失，不对调用它的主页做任何事情。这是一个问题，因为此主页可能已经有用户选择的选项，并且此刷新会清除选项。

这是我显示对话框的测试代码：

```
<a href="/Dialogs/ListError.htm" data-role="button" data-inline="true" data-rel="dialog" data-transition="pop">Open dialog</a> 
```

对话框的 html 位于单独的页面中：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<html> 
    <head> 
       <title>Page Title</title> 
    </head> 
    <body> 
        <div data-role="page"> 
                <div data-role="header"> 
                    <h1>Search</h1> 
                </div> 
                <div data-role="content"> 
                    <p>You must select a Location.</p> 
                    <p><a id="close" onclick="$('.ui-dialog').dialog('close');" data-rel="dialog" data-role="button">OK</a></p> 
                </div> 
        </div> 
    </body> 
</html> 
```

如果这很重要，我正在使用 VS2010 MVC Razor 3 移动模板，该模板使用 _layout.cshtml 文件并且`$.mobile.ajaxEnabled = false;`默认包含在其中。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-23T19:17:47.027

尝试添加`return false;`到您的 onclick

```
<a id="close" onclick="$('.ui-dialog').dialog('close'); return false;" data-rel="dialog" data-role="button">OK</a> 
```

否则将不会阻止默认链接操作

# macos - 为您的 Mac/Cocoa 应用程序下载安装和重新启动更新

> ID：10286568
> 
> 赞同：4
> 
> 时间：2012-04-23T19:00:19.220
> 
> 标签：macos, cocoa, relaunch

当您从 Internet 下载更新的应用程序时，我想知道是否有人对如何安装和重新启动更新的应用程序有任何建议！

有很多应用程序可以获取新版本并自行安装和重新启动，但我不知道，但要使用第二个更新程序应用程序来执行此操作。

有什么建议么？
也欢迎 Cocoa 或特定版本或特定应用商店的建议！

基本上有 3 个步骤：
1- 检测并下载更新（很简单） 2- 用新
应用替换旧应用 3- 启动新应用 `/Applications`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T19:11:15.063

使用 Sparkle - [https://github.com/andymatuschak/Sparkle](https://github.com/andymatuschak/Sparkle)

# php - 资源 ID#5 PHP MySQL 错误

> ID：10286570
> 
> 赞同：0
> 
> 时间：2012-04-23T19:00:30.033
> 
> 标签：php, mysql, sum

我有这个代码：

```
<?php

$con = mysql_connect(DB_HOST, DB_USER, DB_PASS);
     if (!$con)
   {
   die('Could not connect: ' . mysql_error());
   }

     mysql_select_db(DB_NAME, $con);

 $result = mysql_query("SELECT SUM(colname) FROM profits");

 $total = reset (mysql_fetch_assoc($result));

 mysql_close($con);

 echo $total;

 ?> 
```

并且它输出资源 id #5。有什么帮助吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:04:33.783

不要那样使用`reset()`- 如果您需要单个值，只需使用`list()`：

```
$result = mysql_query("SELECT SUM(colname) FROM profits");
list($total) = mysql_fetch_array($result); 
```

`reset()`在关联数组上无法正常工作：[https ://bugs.php.net/bug.php?id=38478](https://bugs.php.net/bug.php?id=38478)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:03:33.443

您正在尝试使用`echo $total;`. 相反，只需回显第一个（并且可能仅基于您的查询）项目。

```
$row = mysql_fetch_assoc($result);
echo $row[0]; 
```

# java - 以编程方式下载通过 PHP 页面推送的文件

> ID：10286574
> 
> 赞同：0
> 
> 时间：2012-04-23T19:00:33.840
> 
> 标签：java, download, redirect

一些 PHP 站点使用页面作为处理文件下载的中间人。

使用浏览器可以透明地工作。php 页面处理请求时似乎有一个轻微的停顿。

但是，尝试使用`URL`或通过 Java 进行下载`HttpURLConnection`会返回纯 html 页面。我怎样才能让文件下载以相同的方式工作？

编辑：这是一个示例链接：

[http://depot.eice.be/index.php?annee_g=jour&cours=poo](http://depot.eice.be/index.php?annee_g=jour&cours=poo)

编辑：这是我一直在测试的一些代码：

```
// This returns an HTML page

private void downloadURL(String theURL) {
    URL url;
    InputStream is = null;
    DataInputStream dis;
    String s;
    StringBuffer sb = new StringBuffer();

    try {
        url = new URL(theURL);

        HttpURLConnection conn = (HttpURLConnection) url.openConnection();

        conn.setRequestMethod("GET");
        conn.connect();

        if (conn.getResponseCode()!=HttpURLConnection.HTTP_OK)
            return;

        InputStream in = conn.getInputStream();

        ByteArrayOutputStream bos = new ByteArrayOutputStream();

        int i;
        while ((i = in.read()) != -1) {
            bos.write(i);
        }

        byte[] b = bos.toByteArray();

        FileOutputStream fos = new FileOutputStream( getNameFromUrl( theURL ) );
        fos.write(b);
        fos.close();
        conn.disconnect();
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

* * *

```
// This will throw Exceptions if the URL isn't in the expected format

public String getNameFromUrl(String url) {

    int slashIndex = url.lastIndexOf('/');
    int dotIndex = url.lastIndexOf('.');

    System.out.println("url:" + url + "," + slashIndex + "," + dotIndex);

    if (dotIndex == -1) {
        return url.substring(slashIndex + 1);
    } else {
        try {
            return url.substring(slashIndex + 1, url.length());
        } catch (StringIndexOutOfBoundsException e) {
            return "";

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:08:38.213

考虑到没有其他约束，您可以从 HTTP 标头读取重定向的 URL，并直接从 JAVA 连接到该 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T19:16:14.907

有一个 API 设置可以自动跟踪重定向——但默认情况下应该是 true。您如何访问 URL？

请参阅[Java API 文档](http://docs.oracle.com/javase/6/docs/api/java/net/HttpURLConnection.html#setFollowRedirects%28boolean%29)...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T12:31:50.873

我想我已经找到了使用 HttpUnit 的解决方案。如果您希望了解如何处理，可以使用该框架的源代码。

```
public void downloadURL(String url) throws IOException {

    WebConversation wc = new WebConversation();
    WebResponse indexResp = wc.getResource(new GetMethodWebRequest(url));
    WebLink[] links = new WebLink[1];
    try {
        links = indexResp.getLinks();
    } catch (SAXException ex) {
        // Log
    }

    for (WebLink link : links) {
        try {
            link.click();
        } catch (SAXException ex) {
            // Log
        }
        WebResponse resp = wc.getCurrentPage();
        String fileName = resp.getURL().getFile();
        fileName = fileName.substring(fileName.lastIndexOf("/") + 1);
        System.out.println("filename:" + fileName);
        File file = new File(fileName);
        BufferedInputStream bis = new BufferedInputStream(
                resp.getInputStream());
        BufferedOutputStream bos = new BufferedOutputStream(
                new FileOutputStream(file.getName()));
        int i;
        while ((i = bis.read()) != -1) {
            bos.write(i);
        }
        bis.close();
        bos.close();
    }
    System.out.println("Done downloading.");
} 
```

# html - 使用 SVG 剪辑（或遮盖）DIV

> ID：10286576
> 
> 赞同：1
> 
> 时间：2012-04-23T19:00:36.250
> 
> 标签：html, css, svg, mask, clip

我用谷歌搜索了很多，我刚刚放弃了，所以我会求助于那里的专家，看看是否有人可以帮助我完成我的任务。

我已经通过 illustrator 将徽标转换为 .SVG。

我的目标是使用该徽标来剪辑（如果您愿意，也可以遮盖）整个 div，以便只显示其中的一小部分并且您可以看到背景。

我决定采用 .SVG 方式，因为我想将这个网站创建为完全可扩展的体验，因此 .png 无法从全高清分辨率到 1024x768 准确地工作。

所以首先我想知道如何剪辑一个 Div，同时如何“反向剪辑”，这样它就不会只显示 div 的那一部分，而是会显示除它之外的所有内容。

我会急切地等待你的答案，因为我真的需要他们......

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T12:45:24.463

如果我理解正确（我不确定），你想显示“背景中所有符合你的标志形状的东西”，对吗？但是，如果“反转”您的徽标，使其自身透明并赋予背景中性色，例如黑色或白色或其他颜色，那又如何呢？然后你可以把两个 div 放在一起，顶部是你的 Logo。

我创建了一个小提琴来向您展示我的意思：http: [//jsfiddle.net/ds82/R4rBH/2/](http://jsfiddle.net/ds82/R4rBH/2/)

Der circle 是标志，它在蓝线内外都是透明的，它是一个 svg。希望那是你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:57:38.207

我不认为你将能够做到这一点。[我曾经看到过这样](http://www.csstextwrap.com/)的插件和生成器，尽管我认为这可能不是你最好的选择。

我会在 svg 中合并您想要剪辑的任何文本，我确信这比找到一种让您的 html 与 svg 正确交互的方法更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T15:44:03.040

好吧，因为我无法通过 .svg 完成，所以我最终只使用了一个 .png，其中所有内容都是黑色的，我的徽标是透明的。有点遗憾，虽然我找不到答案...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T15:55:06.237

基本上你想做的事情目前只[在 Firefox](https://developer.mozilla.org/en/CSS/mask)中有效。方法是在 SVG 中定义正确的`<mask>`元素，然后通过 CSS 应用它：

```
#content {
  mask: url(remote.svg#logo-mask);
} 
```

（或者，如果您嵌入了 SVG：）

```
#content {
  mask: url(#logo-mask);
} 
```

# mysql - 我应该进一步规范多个表中使用的外键集吗？

> ID：10286584
> 
> 赞同：0
> 
> 时间：2012-04-23T19:00:55.230
> 
> 标签：mysql, sql, postgresql

如果数据库有包含相同 FK 的表，是否应该对它们进行规范化？

这些是有问题的数据库表：

```
user (
    user_id int PK, 
    ...
    ...
)

user_cat (
    user_cat_id int PK,
    user_id int FK,
    effective_date date,
    location_id FK,          <-- dup
    qualification_id FK,     <-- dup
    business_id FK           <-- dup
)

user_admin_cat (
    admin_cat_id int PK,
    user_id int FK,
    effective_date date,
    company_id FK,
    location_id FK,          <-- dup
    qualification_id FK,     <-- dup
    business_id FK           <-- dup
) 
```

这是我考虑采取的措施以尽量减少重复：

```
user (
    user_id int PK, 
    ...
    ...
)

user_cat (
    user_cat_id int PK,
    user_id int FK,
    effective_date date,
    shared_id, FK            <-- dup
)

user_admin_cat (
    admin_cat_id int PK,
    user_id int FK,
    effective_date date,
    company_id FK,
    shared_id, FK            <-- dup
)

shared_user_cat_fks (
    shared_id int PK,
    location_id FK,
    qualification_id FK,
    business_id FK
) 
```

我想了解的是以下一个或多个问题的答案：

(1) 如果您要使用标准化解决方案，为什么会更好？
(2) 如果你不使用归一化解决方案，你会怎么做？为什么这个解决方案更好？
(3) 如果你因为只有两个表有重复而不使用规范化解决方案，那么在你做某事之前应该有多少个重复的表？你会实施什么解决方案？为什么这是一个好的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:19:38.600

根据您的描述，我认为没有理由将其“正常化”。我什至会说这与标准化无关。

我个人对规范化的简单规则是：在更改单个事实时，我是否必须做更多的插入/更新/删除操作。

或者是否有我无法代表的事实组合。

或者有没有我可以用两种不同的方式来表示的事实？

我在这里看不到。

所以我对2的回答是：没什么，因为没有问题。

不过，可能存在一些隐藏的非规范化。但不是你描述的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:10:55.123

1）规范化方案设计更简洁，更易于维护。

2）有时非规范化布局在有效性方面更好。比如说，如果对小表有很多查询，而对大表`user_cat`几乎没有查询，`user_admin_cat`并且没有人需要 UNION - 它可能是有效的。

# gwt - GWT DockLayoutPanel 无法在 Firefox 中正确显示

> ID：10286587
> 
> 赞同：0
> 
> 时间：2012-04-23T19:01:05.123
> 
> 标签：gwt, css, docklayoutpanel

我有一个简单的 GWT 应用程序，它在 TextArea 中获取源代码，将其发送到远程编译器，并在其他一些 TextArea 中显示汇编语言输出和编译器错误。下面的代码在 Safari 和 Chrome 中运行良好，但 TextAreas 和 Buttons 没有调整大小以填充 Firefox 中的面板。我可以手动将小部件的大小设置为 100%，这几乎可以接受，但我肯定错过了一些重要的 CSS 知识。我将文档类型设置为严格的 HTML4 DTD（“http://www.w3.org/TR/html4/strict.dtd”）。该应用程序在[http://ferret.granberrys.us:8080/Compiler.html](http://ferret.granberrys.us:8080/Compiler.html)运行。

```
RootLayoutPanel rootPanel = RootLayoutPanel.get();
DockLayoutPanel panel = new DockLayoutPanel(Unit.EM);
codeArea = new TextArea();
codeArea.setText("int main() {return 0};");

DockLayoutPanel outputPanel = new DockLayoutPanel(Unit.EM);
ListBox compiler = new ListBox();
compiler.addItem("Clang/LLVM");
outputPanel.addNorth(compiler, 2);
assemblyArea = new TextArea();
assemblyArea.setText("Asm");

Button compileButton = new Button();
compileButton.setText("Compile");
outputPanel.addSouth(compileButton, 2);
outputPanel.add(assemblyArea);
panel.addEast(outputPanel, 20);

compilerOutput = new TextArea();
compilerOutput.setReadOnly(true);
compilerOutput.setText("Compiler");
//panel.addWest(codeArea, 800);
panel.addSouth(compilerOutput, 10);
panel.add(codeArea);
rootPanel.add(panel); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:03:14.127

根据您应该使用的[文档](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiPanels#Standards)`<!DOCTYPE html>`，但我不确定这是否是这里的问题。它也可能是 TextArea 是一个 span 元素，或者至少不是一个 css 块元素。您可以通过添加`display:block`到特定的小部件来做到这一点。

# java - 程序的 Java_opts 设置

> ID：10286588
> 
> 赞同：1
> 
> 时间：2012-04-23T19:01:13.323
> 
> 标签：java, maven, java-opts

我只需要为一个 Java 应用程序设置 Java_opts 内存。我的程序是一个 Maven 项目。有什么方法可以将它设置为我的程序，而不是整个环境？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:06:54.357

如果您在 Maven 生命构建期间执行程序，则可以设置 MAVEN_OPTS。

# javascript - 如何将事件侦听器附加到打开的颜色框？

> ID：10286591
> 
> 赞同：1
> 
> 时间：2012-04-23T19:01:19.173
> 
> 标签：javascript, jquery, events, colorbox

我正在使用 jQuery 颜色框。我希望在打开颜色框**后将**事件处理程序附加到关闭事件。
我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:12:30.100

Colorbox 具有您可以使用的事件挂钩。因此，您可以将一个函数绑定到 cbox_open 事件，并在该函数中为关闭事件绑定一个函数。

```
$(document).bind('cbox_open', function(){
    $(document).bind('cbox_closed', function(){
       alert('x');
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T19:12:10.243

将[`onClosed`](http://www.jacklmoore.com/colorbox#setting-onclosed)回调设置为函数引用，然后在收到用户输入后更改该函数。

[示例 jsfiddle](http://jsfiddle.net/hdM27/1/)

就像是：

```
// initialize your callback function
var closeEvent = function() {
    console.log('not handled');
};

$(".group1").colorbox({
    rel:'group1',
    onComplete: function() {
        // set the callback function after the colorbox has been opened 
        // (can substitute your own custom button event in leiu of this onComplete event)
        closeEvent = function() {
            console.log('handled');
        }
    },
    onClosed: function() { closeEvent() }
});

​ 
```

# php - 由于 javascript 导致的错误

> ID：10286594
> 
> 赞同：-2
> 
> 时间：2012-04-23T19:01:30.940
> 
> 标签：php, javascript

我在我的网页上收到以下警告消息：

> 此页面上的脚本可能正忙，或者它可能已停止响应。您现在可以停止脚本，也可以继续查看脚本是否会完成。

脚本：[https ://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js)

我该如何解决？

我正在使用以下脚本：

```
<script src="https://www.markettrendsignal.com/beta/js/script.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="https://www.markettrendsignal.com/beta/js/thickbox.js" type="text/javascript"></script>      
<script src="https://www.markettrendsignal.com/beta/js/jquery.treeview.min.js" type="text/javascript"></script>
<script src="https://www.markettrendsignal.com/beta/js/jquery.tipTip.minified.js" type="text/javascript"></script>
<script type='text/javascript' src='https://www.markettrendsignal.com/beta/js/jquery.colorbox-min.js'></script> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-23T19:03:56.510

可能需要查看更多页面。你可能有某种利用 jQuery 的递归 javascript，所以根本原因不是 jQuery，而是其他使用它的 javascript...

# c++ - 从 std::string 获取第一个字符

> ID：10286597
> 
> 赞同：1
> 
> 时间：2012-04-23T19:01:46.180
> 
> 标签：c++, string, char

我需要`std::string`用最少的代码获取 an 的第一个字符。

如果可以从 STL 获取一行代码中的第一个字符，那就太好了`std::map<std::string, std::string> map_of_strings`。以下代码是否正确：

```
map_of_strings["type"][0] 
```

**编辑** 目前，我正在尝试使用这段代码。这段代码正确吗？

```
if ( !map_of_strings["type"].empty() )
    ptr->set_type_nomutex( map_of_strings["type"][0] ); 
```

该`set_type`函数的原型是：

```
void set_type_nomutex(const char type); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:13:19.013

如果您将非空字符串放入`map_of_strings["type"]`. 否则，你会得到一个空字符串，访问它的内容可能会导致崩溃。

如果不能确定字符串是否存在，可以测试：

```
std::string const & type = map["type"];
if (!type.empty()) {
    // do something with type[0]
} 
```

或者，如果您想避免向地图添加空字符串：

```
std::map<std::string,std::string>::const_iterator found = map.find("type");
if (found != map.end()) {
    std::string const & type = found->second;
    if (!type.empty()) {
        // do something with type[0]
    }
} 
```

或者，您可以使用`at`进行范围检查并在字符串为空时抛出异常：

```
char type = map["type"].at(0); 
```

或者在 C++11 中，地图也有类似的`at`东西，您可以使用它来避免插入空字符串：

```
char type = map.at("type").at(0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-11-01T08:55:17.347

c_str() 方法将返回一个指向内部数据的指针。如果字符串为空，则返回指向 NULL 终止符的指针，因此简单的单行代码既安全又容易：

```
std::string s = "Hello";
char c = *s.c_str(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-23T19:19:05.567

从您的问题中并不能完全清楚您的问题是什么，但可能出现问题的`map_settings["type"][0]`是返回的字符串可能为空，从而导致您在执行时出现未定义的行为`[0]`。如果没有第一个字符，您必须决定要做什么。这是一种在一行中起作用的可能性。

```
ptr->set_type_nomutex( map_settings["type"].empty() ? '\0' : map_settings["type"][0]); 
```

它获取第一个字符或默认字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T19:05:46.940

```
string s("type");
char c = s.at(0); 
```

# hash - Sinatra 中的意外错误

> ID：10286599
> 
> 赞同：0
> 
> 时间：2012-04-23T19:01:54.197
> 
> 标签：hash, sinatra, ruby-1.9.2

在 sinatra 中，我正在执行这段代码，其中包含 Hash 对象中的值：

```
@posts[0]["attachment"]["media"][0]["href"] # where @posts belongs to Koala::Facebook::API::GraphCollection class 
```

在 sinatra 应用程序中工作正常，但是，使用循环：

```
@posts.each do |post|
      post["attachment"]["media"][0]["href"]
end 
```

引发以下错误：

```
undefined method `[]' for nil:NilClass 
```

在命令行上执行时显示的错误是：

```
> NoMethodError: undefined method `[]' for nil:NilClass     from
> (irb):12:in `block in irb_binding'    from (irb):11:in `each'     from
> (irb):11 
```

我错过了什么？

# matlab - 当条目很复杂且舍入错误导致问题时，删除向量中的重复条目

> ID：10286601
> 
> 赞同：3
> 
> 时间：2012-04-23T19:02:04.113
> 
> 标签：matlab

我想从 Matlab 上的向量中删除重复的条目。我遇到的问题是舍入错误正在阻止内置的 Matlab 函数“唯一”正常工作。理想情况下，我想要一种在“独特”功能上设置某种容差的方法，或者是一个可以删除重复项的小程序。如果两个条目的实部和虚部相差小于 0.0001，那么我很乐意认为它们相等。我怎样才能做到这一点？

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T19:37:13.523

一个简单的近似是对数字进行四舍五入并使用唯一返回的索引：

```
X = ... (input vector)
[b, i] = unique(round(X / (tolerance * (1 + i))));
output = X(i); 
```

（您可以根据您的 Matlab 版本替换为）`b`。`~`

它不会完全具有您想要的行为，因为两个数字可能非常接近，但会以不同的方式四舍五入。我认为您可以通过以下方式减轻这种情况：

```
X = ... (input vector)
[b, ind] = unique(round(X / (tolerance * (1 + i))));
X = X(ind);
[b, ind] = unique(round(X / (tolerance * (1 + i)) + 0.5 * (1 + i)));
X = X(ind); 
```

这会将它们四舍五入两次，因此恰好在舍入边界上的任何数字都将被第二个捕获`unique`。这仍然有些混乱——一些数字会受到影响，就好像容差翻了一番。但这可能足以满足您的需求。

替代方案可能是一个`for`循环：

```
X = sort(X);
last = X(1);
indices = ones(numel(X), 1);
for j=2:numel(X)
  if X(j) > last + tolerance * (1 + i)
    last = X(j) + tolerance * (1 + i) / 2;
  else
    indices(j) = 0;
  end
end
X = X(logical(indices)); 
```

我认为这具有您可以期望的最佳行为（因为您希望用尽可能少的唯一值来表示向量 - 当有很多数字的差异小于容差水平时，可能有多种拆分它们的方法。这个算法贪婪地做，从最小的开始）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-30T04:48:22.110

以下内容可能符合您的目的。给定一个复数双精度数组 X，它对它们进行排序，然后检查元素之间的绝对值差是否在复数容差 real_tol 和 imag_tol 内。它会删除满足此容差的元素。

```
function X_unique = unique_complex_with_tolerance(X,real_tol,imag_tol)
     X_sorted = sort(X); %Sorts by magnitude first, then imaginary part.

     dX_sorted = diff(X_sorted);
     dX_sorted_real = real(dX_sorted);
     dX_sorted_imag = imag(dX_sorted);

     remove_idx = (abs(dX_sorted_real)<real_tol) & (abs(dX_sorted_imag)<imag_tol);

     X_unique = X_sorted;
     X_unique(remove_idx) = [];
return 
```

请注意，此代码将删除*所有*满足此差异容差的元素。例如，如果 X = [1+i,2+2i,3+3i,4+4i]，real_tol = 1.1，imag_tol = 1.1，那么这个函数将只返回一个元素，X_unique = [4+4i]，甚至尽管您可能会认为，例如 X_unique = [1+i,4+4i] 也是一个有效答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:11:35.627

我几乎可以肯定下面的错误总是假设任何接近 1e-8 的值都是相等的。只需将 1e-8 替换为您想要的任何值。

```
% unique function that assumes 1e-8 is equal
function [out, I] = unique(input, first_last)

threshold = 1e-8;
if nargin < 2
    first_last = 'last';
end
[out, I] = sort(input);
db = diff(out);
k = find(abs(db) < threshold);
if strcmpi(first_last, 'last')
    k2 = min(I(k), I(k+1));
elseif strcmpi(first_last, 'first')
    k2 = max(I(k), I(k+1));
else
    error('unknown flag option for unique, must be first or last');
end
k3 = true(1, length(input));
k3(k2) = false;
out = out(k3(I));
I = I(k3(I));
end 
```

# iphone - 如何用 CCSpriteBatchNode 替换 CCSpriteSheet

> ID：10286607
> 
> 赞同：1
> 
> 时间：2012-04-23T19:02:20.657
> 
> 标签：iphone, ios, cocos2d-iphone, sprite

所以我创建了一个`CCSpriteSheet`：

```
_spriteSheet = [[CCSpriteSheet spriteSheetWithFile:@"deuximages2.png" capacity:2] retain];
[[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"deuximages2.plist"]; 
```

在另一种方法中：

```
 mangeur = [CCSprite spriteWithSpriteFrameName:@"mangeurcentremieu_03.png"]; 
```

但我有警告：`CCSpriteSheet is deprecated.`我认为我必须替换它，`CCSpriteBatchNode`但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T07:00:40.457

[`CCSpriteBatchNode`](http://www.cocos2d-iphone.org/api-ref/latest-stable/interface_c_c_sprite_batch_node.html)的接口与[`CCSpriteSheet`](http://www.cocos2d-iphone.org/api-ref/0.99.0/interface_c_c_sprite_sheet.html). 我记得`CCSpriteBatchNode`是在 0.99.5 中引入来替换`CCSpriteSheet`.

```
_batchNode = [[CCSpriteBatchNode batchNodeWithFile:@"deuximages2.png" capacity:2] retain]; 
```

# mobile - Sencha Touch 2 对比 电话间隙

> ID：10286608
> 
> 赞同：3
> 
> 时间：2012-04-23T19:02:37.990
> 
> 标签：mobile

我们正在分析混合移动应用程序的最佳平台。要求将是可在 Android/iPhone/BB 设备上使用的应用程序。在所有其他设备上，可以从内置浏览器访问移动网站。

我了解 Sencha Touch 确实涵盖 Android、iPhone 和 Blackberry 设备 - 这意味着移动网站将无法从其他设备中的浏览器（非 webkit 浏览器，如 Windows、Palm ......）

而 Phonegap 具有跨不同浏览器的兼容性。考虑到所有其他功能，我想看看使用 Sencha 与 Phonegap 相比有什么优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T13:50:53.420

主要区别在于 PhoneGap 是一个不包含内置 UI 框架的框架。相反，它只是作为原生 API 的跨平台包装器，向您展示基于 Javascript 的 API 以访问原生功能。使用PhoneGap，您可以选择使用纯HTML5，或者使用诸如Sencha Touch 2 本身、jQueryMobile、jQTouch、Kendo UI 等UI 框架。另一方面，Sencha Touch 是一个UI 框架，但它没有为原生功能公开跨平台 JavaScript API 的开箱即用功能。

根据您的以下陈述，我想您不打算在您的应用程序中访问任何本机 API，您将编写的是一个纯移动 Web 应用程序。

> 要求将是可在 Android/iPhone/BB 设备上使用的应用程序。在所有其他设备上，可以从内置浏览器访问移动网站。

如果是这种情况，我认为没有任何理由将 PhoneGap 用于您的应用程序。您可以完全使用 Sencha Touch 2 编写它，并使用它的构建和打包工具为目标平台打包它。

但是，如果您打算使用本机 API，那么 Sencha Touch 2 单独将无法为您提供该功能，在这种情况下，您应该将 Sencha Touch 2 包装在 PhoneGap 应用程序中。看看这个来自 Sencha Docs 的视频，关于这个[http://docs.sencha.com/touch/2.2.0/#!/video/native-apis-from-touch](http://docs.sencha.com/touch/2.2.0/#!/video/native-apis-from-touch)

# ruby-on-rails - 跨标签渲染

> ID：10286612
> 
> 赞同：0
> 
> 时间：2012-04-23T19:02:54.277
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap

我在我的 Rails 应用程序中使用 Bootstrap，特别是，我想在以下意义上扩展 Bootstrap 的可选项卡功能：

我网站的每个用户都可以有多个配置文件，即模型用户 has_many 配置文件，我想显示这些配置文件跨用户/显示页面中的选项卡。每个配置文件都有一个我想在选项卡本身上显示的名称属性。

我之前使用典型约定呈现这些配置文件：
在用户/显示页面上：

```
<%= render 'shared/prof %> 
```

共享/_prof：

```
<% if @prof_items.any? %>
  <ol class="profiles">
    <%= render partial: 'shared/prof_item', collection: @prof_items %>
  </ol>
  <%= will_paginate @prof_items %>
<% end %> 
```

共享/_prof_items

```
<li id="<%= prof_item.id %>">
...content...
</li> 
```

用户控制器：

```
...
def show
  @user = User.find(params[:id])
  @profiles = @user.profiles.paginate(page: params[:page])
  @profile = @user.profiles.build
  @prof_items = @user.prof.paginate(page: params[:page])
  ...
end
... 
```

所以基本上我希望输出的html是这样的：

```
<div class="tabbable" style="margin-bottom: 5px;">
 <ul class="nav nav-tabs" id="tabHeaders">
  <li class="active">
   <a href="#tab_<%=prof_item.id%>" data-toggle="tab">Name of first profile</a>
  </li>
  <li>
   <a href="#tab_<%=prof_item.id%>" data-toggle="tab">Name of second profile</a>
  </li>
  #and so on for each prof_item
 </ul>
<div class="tab-content" id="tabContent">
 <div class="tab-pane active id="<%=prof_item.id%>">
  #render first profile item
 </div>
 <div class="tab-pane" id="<%=prof_item.id%>">
  #render second profile item
 </div>
</div> 
```

但是我不确定在 user/show.html.erb 中需要什么代码，在 shared/_prof_item.html.erb 中需要什么代码，在 shared/_prof.html.erb 中需要什么代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T04:06:50.127

您可以通过使用 rails 工具来呈现集合来简化代码：

```
<%= render partial: 'shared/prof_item', collection: @prof_items) %>
<%= render partial: 'shared/profile', collection: @profiles) %> 
```

shared/_profile.html.erb: # 使用局部变量配置文件

```
 <div class="tab-pane active" id="<%=profile.id%>">
     #render first profile
     </div> 
```

shared/_prof_item.html.erb # 使用局部变量 prof_item

```
 <li>
    <a href="#tab_<%=prof_item.id%>" data-toggle="tab">Name of second profile item</a>
    </li> 
```

# php - 一个查询插入多行多列

> ID：10286620
> 
> 赞同：2
> 
> 时间：2012-04-23T19:03:31.360
> 
> 标签：php, mysql, insert, multiple-columns

假设我想插入这些数据：

```
Row 1: People = '40', Places = '15'
Row 2: People = '5', Places = '10' 
```

我知道这是您执行上述操作的方式：

```
mysql_query("INSERT INTO mytable(`People`, `Places`) 
VALUES ('40', '15'),('5', '10')"); 
```

但是如果我想用一个查询插入两个以上的列怎么办？如果要插入的数据是这样的：

```
Row 1: People = '40', Places = '15'
Row 2: People = '5', Places = '10'
Row 3: Things = '140', Ideas = '20'
Row 4: People = '10', Things = '5', Ideas = '13' 
```

我似乎在其他任何地方都找不到这样的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T19:07:00.277

留下您不想填写的列`null`

```
INSERT INTO mytable(`People`, `Places`, Things, Ideas) 
VALUES ('40', '15', null, null),(null, null, 100, 20) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-23T19:07:25.060

```
mysql_query("INSERT INTO mytable(`People`, `Places`, `Ideas`, `things`)
 VALUES ('40', '15',  null, null),
        (null, '5',   '10', null),
        ('10',  null, '11', '12')"); 
```

或者如果您想使用 0 而不是 null，它可能对您的应用程序更友好（不会抛出 null 错误）

```
mysql_query("INSERT INTO mytable(`People`, `Places`, `Ideas`, `things`)
 VALUES ('40', '15', '0',  '0'),
        ('0',  '5',  '10', '0'),
        ('10', '0',  '11', '12')"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T19:08:58.137

```
INSERT INTO mytable(`People`, `Places`,`Things`,`Ideas`) 
VALUES ('40', '15', null, null),
       ('5', '10',null, null),
       (null, null, '140','20'),
       ('10',null,'5','13')"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T19:10:44.083

您可以在一行中编写单独的查询语句，如下所示：

```
insert into table_x (collumn_x,collumn_y) values (... ; 
insert into table_x (collumn_y, collumn_z) values (... 
```

等等

以动态方式安装语句的结构可能构建起来很复杂，但至少是我目前能为你找到的唯一解决方案

希望这对你有帮助

# javascript - javascript 的 onmousemove/event.clientX 正在工作但会抛出错误

> ID：10286622
> 
> 赞同：1
> 
> 时间：2012-04-23T19:03:35.627
> 
> 标签：javascript, html, google-chrome, mousemove

当我意识到这个小鼠标跟踪示例时，我只是将这个小鼠标跟踪示例放在一起，它会在 chrome 控制台中引发数千个错误。

```
Uncaught TypeError: Cannot read property 'clientX' of undefined 
```

AFAIK 这意味着，chrome 找不到该属性所属的对象。但是如果我打开这个例子，它会很好地显示正确的坐标。请帮助我摆脱这些无用的错误。

```
<html>
<head>
    <style type="text/css">
        #tracking {
            width: 300px;
            height: 300px;
            background-size: 300px 300px;
            background-color: #00F;
            left: 100px;
            top: 100px;
            position: absolute;
        }
    </style>
    <script type="text/javascript">
        var mX, mY;
        var track;
        document.onmousemove = update;

        function trackload()
        {
            track = document.getElementById("tracking");
            setTimeout("update()",10);
        }

        function update(e)
        {
            mX = e.clientX;
            mY = e.clientY;
            if (track) {
                track.innerHTML = "X: " + mX + " Y: " + mY + " deg: " + (Math.atan(mY / mX) * (180/Math.PI));
                track.style.cssText = "-webkit-transform: rotate(" + (Math.atan(mY / mX) * (180/Math.PI)) + "deg);";}
            setTimeout("update()",10);
        }
    </script>
</head>
<body>
    <div id="tracking" onclick="trackload()"></div>
</body> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:09:20.660

删除调用以`setTimeout`防止错误。发生这种情况是因为该`update`函数需要一个事件对象，当您通过`setTimeout`. 因此`e`是未定义的，你得到你的错误。

这是一个[工作示例](http://jsfiddle.net/4hPhG/2/)。

如果打电话有充分的理由`setTimeout`，你需要解释一下，因为我不知道为什么乍一看需要它们。作为旁注，将字符串传递给`setTimeout`通常被认为是不好的做法（它是 的别名`eval`）。您可以只传递对该函数的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:38:24.287

实际上，如果您只是从`update`in 中删除括号`setTimeout`，它就可以工作并且不会在控制台中引发任何错误。

它应该`setTimeout("update",10)`代替`setTimeout("update()",10)`.

您需要将一个函数传递给`setTimeout`，而不是一个函数的结果。如果不是字符串就更好了。

# mercurial - 如何禁止推送到共享磁盘方法发布的 Mercurial 存储库？

> ID：10286630
> 
> 赞同：0
> 
> 时间：2012-04-23T19:04:07.000
> 
> 标签：mercurial, active-directory, lan

我们在我公司的内网中使用的是mercurial，由于防火墙限制，暂时不能通过其他方式发布，只能通过共享磁盘。**我知道这不是理想的或推荐的方法**，但是，它现在可以（如果我最终获得服务器，我将设置 RhodeCode）。

我们发现我们可以很容易地共享我们的更改，只需使用我们的 Active Directory 帐户通过 Windows[共享我们的 repo 文件夹](http://mercurial.selenic.com/wiki/PublishingRepositories)（右键单击文件夹，与特定的人共享），但是我想完全阻止有人这样做的可能性推送到存储库。

我 99% 确定没有使用 HTTP，因此传统方法不应该起作用。**我什至正在寻找一种解决方法，因为我认为无论如何都不能直接从 Mercurial config 限制它**。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T20:21:31.553

只要您确定人们正在使用`push`并`pull`从共享目录中获取更改（**这是唯一安全的方法！**），您仍然可以在这些存储库中使用挂钩来阻止推送。存储库`.hg/hgrc`文件中的类似内容将阻止推送：

```
[hooks]
pretxnchangegroup.denyall = /bin/false 
```

Windows 上的任何可执行文件在哪里`/bin/false`总是返回假/非零。

另外，考虑通过在共享存储库中进行操作来使共享存储库成为*裸*`hg update null`存储库。这会从工作目录中删除所有文件，因此没有人想在那里进行编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:32:09.273

每个人都可以分享他们的 repo（只读）并要求其他人——包括官方 repo 的维护者——从中提取。

# python - 如何根据列表与给定数字的接近程度对列表进行排序？

> ID：10286638
> 
> 赞同：1
> 
> 时间：2012-04-23T19:04:36.900
> 
> 标签：python

我想根据列表中的数字与给定数字的接近程度对列表进行排序。例如：

```
target_list = [1,2,8,20]
number = 4 
```

那么可能排序列表是`[2,1,8,20]`因为：

```
 4-2 = 2
   4-1 = 3
 |4-8| = 4
|4-20| = 16 
```

万一发生碰撞，我真的不在乎哪个先出现，但是我试图根据这个距离度量对列表进行排序。最好的（和pythonic）方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-23T19:06:37.843

可以使用函数的`key`参数`sorted`

```
>>> target_list = [1,2,8,20]
>>> sorted(target_list, key=lambda x: abs(4-x))
[2, 1, 8, 20] 
```

或者，如果您想对其进行排序，即使 list`sort`方法也接受`key`.

```
>>> target_list.sort(key=lambda x: abs(4-x))
>>> target_list
[2, 1, 8, 20] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-23T19:07:07.890

```
sorted(target_list, key=lambda k: abs(k - 4)) 
```

或者对列表进行适当的排序：

```
target_list.sort(key=lambda k: abs(k - 4)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T19:09:19.620

```
>>> target_list.sort(key=lambda x: abs(number-x))
>>> target_list
[2, 1, 8, 20] 
```

# matlab - Matlab 和网站

> ID：10286639
> 
> 赞同：2
> 
> 时间：2012-04-23T19:04:41.033
> 
> 标签：matlab, web-applications, image-processing, web, neural-network

我有一个项目，我将利用图像处理和神经网络。我为此使用的工具是matlab。该系统是一个基于 Web 的系统，我看到和使用的示例目前是基于桌面的。有谁知道我将如何在图像处理和神经网络部分之上创建一个网站层？

最简单的结构是这样的

网站 -> 提供输入 -> 通过图像处理和神经网络进行处理 -> 在网站中提供输出

虽然这可行，但如果可能的话，我还希望网站与该过程更具交互性，例如当我不想控制图像处理的某些阈值的强度时

另外，如果可能的话，我还需要写入数据库，mysql

如果我可以将 Java EE 与 matlab 结合起来，那将是一个额外的好处，因为我已经有了可以从 java 中使用的代码。然而强制性要求是我创建一个可以完成工作的网站

问候， 米琳达

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:39:36.343

完成这项工作的最佳工具是使用[Matlab Java Builder](http://www.mathworks.com/products/javabuilder/)，它可以将 Matlab 脚本编译成 Java 类。

这样，您可以直接在Java服务器层使用Matlab编写的处理部分。您也不必担心 Matlab 中的数据库访问，这可能（并且通常是）非常混乱。您只需在 Matlab 中进行所有数字运算，以及数据处理、Web 界面和 Java。

缺点是 Matlab Java Builder 是一个独立于核心 Matlab 包的组件，必须单独购买。

# c - C中的库存程序。需要有关如何从库存中删除项目的帮助

> ID：10286643
> 
> 赞同：-1
> 
> 时间：2012-04-23T19:04:47.597
> 
> 标签：c, visual-c++, inventory

这是一个保存库存的程序。该程序显示一个选项菜单。除了删除条目功能外，其他一切都很完美。我不知道如何使它删除一个功能。我放了一个变量来查找位置，但我真的不知道如何。我输入要删除的项目名称，然后输入显示条目，它陷入了无限混乱。有人帮助我如何让它选择一个项目并将其从库存中删除。它用于 Visual Studios 2010，这里是代码

```
#include <stdio.h>
#include <string.h>
#include <ctype.h>
#define SIZE 25
#define MAX 100

  typedef struct {
    char item[SIZE]; //item for the company
    char company[SIZE]; //company that sells the item
    int intStock; //how many of the item are instock
    char lastShipDate[SIZE]; //last ship date of that item
    double cost; //cost to make the item
    double price; //price of the item 
    } gaming;

//prompts the user to get a selection
int Menu(void);

//display the options to the user
void DisplayOptions(void);

//display some entries for inventory
void HardCodeEntries(gaming entry[],int *size);

//function to add a new entry to the inventory
void AddNewEntry(gaming entry[], int *size);

//function to delete a selected entry from inventory
void Delete(gaming entry[], int *size, int location);

//display the current inventory to screen
void Display(gaming entry[], int size);

//save the current inventory to file
void SaveInventory(gaming br[], int *size);

//clears out the entire inventory
void Clear(int *size);

//load the inventory from the file that is being saved
void LoadSalesRecords(gaming br[], int *size);

//find location of entry that is going to be edited or deleted
int FindLocation(gaming entry[], int size);

//display the options for editing an entry
int EditMenuOptions(void);

//function to edit selected entry
void Edit(gaming entry[], int location);

int main()
{
    int selection;
    gaming entry [150];
    int size=0;
    char trash;
    int choice;
    int location;

    //display size of inventory before and after
    printf("\nSIZE before: %d", size);
    HardCodeEntries(entry, &size);
    printf("\nSIZE after: %d\n\n", size);

    DisplayOptions();

    selection= Menu();

    while(selection != 8)
    {
          if (selection==1)
          { 
              printf("ADD ENTRIES\n\n");
              //display size of inventory before adding entries
              printf("\nSIZE BEFORE ADDING: %d\n", size);

              AddNewEntry(entry, &size);

              //display size of inventory after adding entries
              printf("\nSIZE AFTER ADDING: %d\n", size);
          }
          else if(selection==2)
          {
              printf("DELETE\n\n");
              //get location of entry to be deleted

              location = FindLocation(entry,size);
              printf("\nLOCATION: %d\n", location);

              Delete(entry, &size, location);
          }
          else if(selection==3)
          {
              printf("EDIT\n\n");

              //get the location of entry to be edited
              location = FindLocation(entry, size);

              printf("\nLOCATION: %d\n", location);
              Edit(entry, location);
          }
          else if(selection==4)
          {
              printf("DISPLAY OF INVENTORY\n\n");
              Display(entry, size);
          }
          else if(selection==5)
          {
              printf("SAVING CURRENT INVENTORY TO FILE\n\n");
              SaveInventory(entry, &size);
              //saves to file
          }
          else if(selection==6)
          {
              printf("CLEARING ENTIRE DATA\n\n");
              Clear(&size);
          }
          else if(selection==7)
          {
              printf("LOADING SALES RECORDS FROM FILE\n\n");
              LoadSalesRecords(entry, &size);
          }
          else
          {
              printf("COMMAND NOT RECOGNIZED\n\n");
          }

          printf("\n\n");
          DisplayOptions();

          //clears buffer
          scanf("%c", &trash);

          selection = Menu();
    }

    if (selection==8)
    {
        printf("\nHAVE A NICE DAY!!!\n\n");
    }
    return 0;
}

//display the options to the user
void DisplayOptions(void)
{
    printf("HELLO, WELCOME TO THE INVENTORY PROGRAM.\n");
    printf("THIS PROGRAM HOLDS INVENORY FOR ELECTRONICS COMPANIES ALONG WITH THEIR ITEMS, COST TO PRODUCE, PRICE,\n");
    printf("LAST SHIP DATE AND NUMBER IN STOCK\n");
    printf("THERE ARE COMPANIES IN THE INVENTORY ALREADY\n");
    printf("*********************************************\n\n");
    printf("HERE ARE YOUR OPTIONS\n");
    printf("1--ADD A NEW ENTRY\n");
    printf("2--DELETE AN ENTRY\n");
    printf("3--EDIT AN ENTRY\n");
    printf("4--DISPLAY THE INVENTORY\n");
    printf("5--SAVE CURRENT INVENTORY TO FILE\n");
    printf("6--CLEAR THE ENTIRE INVENTORY\n");
    printf("7--LOAD SALES RECORD FROM FILE\n");
    printf("8--QUIT\n");
}

//prompts the user to get a selection
int Menu(void)
{
    int selection;
    printf("\nENTER SELECTION: ");
    scanf("%d", &selection);

    return selection;
}

//display some entries for inventory
void HardCodeEntries(gaming entry[], int *size)
{
    strcpy(entry[0].item,"Xbox360");
    strcpy(entry[0].lastShipDate,"04/10/12");
    entry[0].cost=200.00;
    strcpy(entry[0].company,"Microsoft");
    entry[0].price=300.0;
    entry[0].intStock=150;

    *size = *size + 1;

    strcpy(entry[1].item,"PlayStation3");
    strcpy(entry[1].lastShipDate,"04/10/12");
    entry[1].cost=200.00;
    strcpy(entry[1].company,"Sony");
    entry[1].price=450.00;
    entry[1].intStock=100;

    *size = *size + 1;

    strcpy(entry[2].item,"XboxController");
    strcpy(entry[2].lastShipDate,"04/10/12");
    entry[2].cost=25.00;
    strcpy(entry[2].company,"Microsoft");
    entry[2].price=50.00;
    entry[2].intStock=50;

    *size = *size + 1;

    strcpy(entry[3].item,"PS3Controller");
    strcpy(entry[3].lastShipDate,"04/10/12");
    entry[3].cost=30.00;
    strcpy(entry[3].company,"Sony");
    entry[3].price=45.00;
    entry[3].intStock=50;

    *size = *size + 1;

    strcpy(entry[4].item,"Wii");
    strcpy(entry[4].lastShipDate,"04/10/12");
    entry[4].cost=100.00;
    strcpy(entry[4].company,"Nintendo");
    entry[4].price=200.00;
    entry[4].intStock=150;

    *size = *size + 1;

}

//function to add a new enty to the inventory
void AddNewEntry(gaming entry[], int *size)
{
    printf("\nENTER ITEM:\t\t");
    scanf("%s", entry[*size].item);

    printf("ENTER SHIP DATE:\t");
    scanf("%s", entry[*size].lastShipDate);

    printf("ENTER COST TO MAKE:\t\t");
    scanf("%lf", &entry[*size].cost);

    printf("ENTER COMPANY:\t\t");
    scanf("%s", entry[*size].company);

    printf("ENTER PRICE:\t\t");
    scanf("%lf", &entry[*size].price);

    printf("ENTER NUMBER IN STOCK:\t");
    scanf("%d", &entry[*size].intStock);

    *size = *size + 1;
}

//function to delete a selected entry from inventory
void Delete(gaming entry[], int *size, int location)
{
    entry[location] = entry[*size - 1];
    *size = *size - 1;
}

//display the current inventory onto the screen
void Display(gaming entry[], int size)
{
    int i;
    for(i=0; i<size; i++)
    {
        printf("\n");
        printf("ITEM:\t\t %s\n", entry[i].item);
        printf("LAST SHIP DATE:\t %s\n", entry[i].lastShipDate);
        printf("COST:\t\t %4.2f\n",entry[i].cost);
        printf("COMPANY:\t %s\n", entry[i].company);
        printf("PRICE:\t\t %4.2f\n", entry[i].price);
        printf("IN STOCK:\t %d\n", entry[i].intStock);
    }
}

//save the current inventory to a file
void SaveInventory(gaming br[], int *size)
{
    FILE *outp;

    if((outp = fopen("output.txt","w"))==0)
    {
        printf("\nCANNOT OPEN FILE\n");
        return;
    }

    //connect to the file
    outp= fopen("output.txt","w");

    fprintf(outp,"%d", *size);
    fwrite(br, sizeof(gaming),*size,outp);

    //close file pointer
    fclose(outp);
}

//clears out the entire inventory
void Clear(int *size)
{
    *size = 0;
}

//load the inventory from the file that is being saved
void LoadSalesRecords(gaming br[], int *size)
{
    FILE * inp;

    if((inp = fopen("output.txt","r"))==0)
    {
        printf("CANNOT OPEN FILE\n");
        return;
    }
    //connect to file
    inp = fopen("output.txt","r");

    fscanf(inp,"%d",size);
    fread(br, sizeof(gaming),*size,inp);

    //close file pointer
    fclose(inp);
}

//find location of entry that is going to be edited or deleted
int FindLocation(gaming entry[], int size)
{
    int i;
    int j;
    int length;
    char userItem[SIZE];

    //enter the item to delete
    printf("ENTER ITEM TO EDIT OR DELETE: ");
    scanf("%s", userItem);
    length = strlen(userItem);

    for(i=0; i<length; i++)
    {
        userItem[i] = toupper(userItem[i]);
    }
    printf("\nYOUR BRAND IN UPPER CASE IS:  %s\n", userItem);

    for(j=0; j<size; j++)
    {
        if(strcmp(entry[j].item,userItem)==0)
        {
            return j;
        }
    }
    return -1;
}

//function to edit a selected entry
void Edit(gaming entry[], int location)
{
    int choice;

    choice = EditMenuOptions();

    if(choice==1)
    {
        printf("\nENTER NEW ITEM: ");
        scanf("%s", &entry[location].item);
    }
    else if(choice==2)
    {
        printf("\nENTER SHIP DATE: ");
        scanf("%s", &entry[location].lastShipDate);
    }
    else if(choice==3)
    {
        printf("\nENTER COST TO MAKE: ");
        scanf("%lf", &entry[location].cost);
    }
    else if(choice==4)
    {
        printf("\nENTER COMPANY: ");
        scanf("%s", &entry[location].company);
    }
    else if (choice==5)
    {
        printf("\nENTER PRICE: ");
        scanf("%lf", &entry[location].price);
    }
    else if (choice==6)
    {
        printf("\nENTER HOW MANY IN STOCK: ");
        scanf("%d", &entry[location].intStock);
    }
    else if (choice==7)
    {

        printf("\nENTER NEW ITEM: ");
        scanf("%s", &entry[location].item);
        printf("\nENTER SHIP DATE: ");
        scanf("%s", &entry[location].lastShipDate);
        printf("\nENTER COST TO MAKE: ");
        scanf("%lf", &entry[location].cost);
        printf("\nENTER COMPANY: ");
        scanf("%s", &entry[location].company);
        printf("\nENTER PRICE: ");
        scanf("%lf", &entry[location].price);
        printf("\nENTER HOW MANY IN STOCK: ");
        scanf("%d", &entry[location].intStock);
    }
    else
    {
        printf("Invalid Entry");
    }
}

//display the options for edditing an entry
int EditMenuOptions(void)
{
    int choice;

    printf("\nENTER 1 TO EDIT ITEM\n");
    printf("ENTER 2 TO EDIT DATE\n");
    printf("ENTER 3 TO EDIT COST\n");
    printf("ENTER 4 TO EDIT COMPANY\n");
    printf("ENTER 5 TO EDIT PRICE\n");
    printf("ENTER 6 TO EDIT NUMBERS IN STOCK\n");
    printf("ENTER 7 TO EDIT ALL DATA\n");
    printf("\nENTER SELECTION: ");
    scanf("%d", &choice);
    return choice;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:08:28.543

遵循您的编码风格，虽然它应该改进：

```
void remove_item(gaming entry[], int *size, int item) {
    memcpy(&entry[item], &entry[*size], sizeof(entry[0]));
    *size = *size - 1;
} 
```

此代码将覆盖所需的条目（在 index 处`item`）并将最后一个索引 ( `size`) 减一。

# javascript - 延迟 onChange javascript 函数足够长的时间以使另一个 javascript 完成

> ID：10286651
> 
> 赞同：0
> 
> 时间：2012-04-23T19:05:20.180
> 
> 标签：javascript, jquery, delay, onchange

我有 3 个带有 onChange 函数的选择框来调用脚本来添加所有 3 个值并将它们放在隐藏字段中。问题是有另一个脚本根据其他的值更改框。脚本 2 在脚本 1 完成更改选择选项的值之前保存值。

脚本 1 根据年份和月份值更新日期值

```
<script type='text/javascript'>
    $().ready(function () { 
        $().dateSelectBoxes($('#release_month'),$('#release_day'),$('#release_year'),true);
    });
</script> 
```

脚本 2 抓取所有 3 个日期并制作 1 个完整日期。问题是，这是在脚本 1 更新当天之前完成的。

```
<script>
     function datepopulate(){
    var day = document.getElementById('release_day').value.substr(-2);
    var month = document.getElementById('release_month').value;
    var year = document.getElementById('release_year').value;
   var completedate = year+'-'+month+'-'+day;
   document.getElementById('releasedate_value').value = completedate;
      alert(document.getElementById('releasedate_value').value);
   return true;
}

</script> 
```

脚本 2 是这样调用的。而脚本 1 是自动的

```
<select onChange="datepopulate();"> </select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:12:18.983

您可以将带有 datepopulate() 函数的 jquery .change() 事件作为回调附加到选择框并在 .ready(...) 部分中链接逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:14:41.600

听起来您只需要在单击事件代码触发后从您的 jQuery 插件公开一个回调来执行额外的逻辑。所以你会有这样的事情：

```
<script type='text/javascript'>
    $().ready(function () { 
        $().dateSelectBoxes($('#release_month'),$('#release_day'),$('#release_year'),true, function()
            {
                // Do Stuff after this plugin does its stuff
            });
    });
</script> 
```

听起来您已经将两个事件连接到更改事件，并且由于不确定首先触发的事件是什么，因此您遇到了同步问题。如果您可以通过回调机制对事件进行排序来强制执行此操作，那么应该可以解决问题。

编辑：要将您的代码转换为 jQuery，实际上非常简单。这将是 jQuery 版本：

```
var date = $('#release_year').val() + "-" + $('#release_month').val() + "-" + $('#release_day').val();

$('#releasedate_value').val(date); 
```

该`val()`函数将返回查询的元素值。由于您是按 Id 选择的，这意味着您将有效地取回`value`元素。然后，您使用相同的方法将字符串连接并分配给您的隐藏值，但将值作为参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T20:16:43.637

我认为重要的是要指出有时这将无法正常工作（从 jQuery 1.7 开始）：

```
$('#element').html(some_really_large_value);
console.log($('#element').html()); 
```

有时 DOM 更新不会阻止函数执行，控制台中出现的将是之前的 #element 内容。

如果在上面的示例中是这种情况，那么即使向 $.dateSelectBoxes 添加回调也可能无法解决问题。如果这仍然没有返回正确的值：

```
$.dateSelectBoxes( ... $('#release_month') ... , function(){
   console.log($('#release_month').val());
}); 
```

然后我知道的唯一解决方案是添加一个竞争条件：

```
$.dateSelectBoxes( ... $('#release_month') ... , function(){
   setTimeout(function(){ console.log($('#release_month').val()) }, 100);
}); 
```

[更新]

我最近发现这里的问题不是 .html() 方法没有阻止函数执行，而是浏览器正在按函数范围对 DOM 更新进行分组（或类似的东西，细节有点模糊）。

这意味着使用 .html() 和 .val() 更新 jQuery DOM 会阻塞，但它们只会阻塞在浏览器中调度 DOM 更新。因此，即使将读取的 DOM 包装在 setTimeout(fn, 1) 中也可以解决问题。

顺便说一句，这正是[Frame.js](https://github.com/bishopZ/Frame.js)旨在解决的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T19:12:58.607

向 dateSelectBoxes 添加一个函数参数，因此它将调用 datepopulate 本身而不是 onchange。

```
 $().ready(function () { 
    $().dateSelectBoxes($('#release_month'),$('#release_day'),$('#release_year'),true, datepopulate);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T19:46:15.917

不要使用超时在 JavaScript 中等待事件完成。确保某事完成的唯一方法是使用回调，不要怀疑，否则你会遇到更多麻烦

试试这个：

```
<script type='text/javascript'>
$(document).ready(function () { 
    $.dateSelectBoxes($('#release_month'),$('#release_day'),$('#release_year'),true);
    $("select").on("change", function(){
            var day = document.getElementById('release_day').value.substr(-2),
        month = document.getElementById('release_month').value,
        year = document.getElementById('release_year').value,
        completedate = year+'-'+month+'-'+day;
        if(day > 0 && month > 0 && year > 0){
            document.getElementById('releasedate_value').value = completedate;
            alert(document.getElementById('releasedate_value').value);
        }
    });
});
</script> 
```

但是，“正确”的做法是有一个按钮，`<input type=button style="display:none">`然后在更改时检查每个选择框的值！= 0。然后，如果所有选择都被选中，`$("button").css("display", "block");`那么

```
$("button").on('click', function(){
    var day = document.getElementById('release_day').value.substr(-2),
    month = document.getElementById('release_month').value,
    year = document.getElementById('release_year').value;
    document.getElementById('releasedate_value').value = year+'-'+month+'-'+day;
    alert(document.getElementById('releasedate_value').value);
}); 
```

# hibernate - 通过 gradle 构建 Hibernate 4.1.2.final 的问题

> ID：10286657
> 
> 赞同：0
> 
> 时间：2012-04-23T19:05:47.420
> 
> 标签：hibernate, gradle, hibernate-envers

[由于HHH-6960](https://hibernate.onjira.com/browse/HHH-6960)，我正在尝试修补休眠。但是，执行时会出现以下问题`gradle clean build`。

```
FAILURE: Build failed with an exception.

* Where:
Build file 'C:\Work\Samples\hibernate-release-4.1.2.Final\project\documentation\documentation.gradle' line: 13

* What went wrong:
A problem occurred evaluating project ':documentation'.
> Could not find property 'buildDirName' on project ':documentation'.

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.

BUILD FAILED

Total time: 11.502 secs
PS C:\Work\Samples\hibernate-release-4.1.2.Final\project\hibernate-envers> 
```

这个直接开箱即用，没有任何修改......我只是下载了hibernate和gradle并运行它。我是 gradle 新手，所以我做错了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:07:05.167

你说你下载了hibernate和gradle？您无需手动下载 gradle 即可运行 hibernate 构建。与其使用本地安装的 gradle，不如使用 gradlewrapper（休眠源根目录中的 gradlew / gradlew.bat 脚本）来构建 gradle。这能解决你的问题吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T05:06:06.580

Gradle 的问题是脚本是使用与您安装的版本不兼容的版本编写的。Gradle 就是这样一个经常失去向后兼容性的产品，因为它正在积极开发中。

您可以使用 gradlew 脚本作为最快的解决方案，因为它们不需要您安装任何东西，或者只是看看那些 gradlew 内部，它们包含这些脚本所需的 Gradle 版本。

# php - 一页上的多个simplemodal - 动态

> ID：10286663
> 
> 赞同：3
> 
> 时间：2012-04-23T19:06:22.427
> 
> 标签：php, javascript, jquery, smarty, simplemodal

我正在内部处理一个项目，并希望在列出所有客户的表中单击时使用 simplemodal 来显示客户信息。

然而，这给我带来了一些麻烦，因此我现在问你们。

到目前为止，这是我的代码：

```
<table border="0" cellpadding="0" cellspacing="0" id="customertable" class="sortable">
<thead>
    <tr class="odd">
        <th>Navn</th>
        <th>Telefon</th>
        <th>Postnummer</th>
        <th>By</th>
    </tr>
</thead>
<tbody>
{foreach $results as $customer}
{strip}
   <tr class="{cycle values='even,odd'}">
      <td class="name" id='mousetracking' title={$customer.name}><a href="#" id="osx{$customer.customerid}">{$customer.name}</a></td>
      <td class="data">{$customer.phone}</td>
      <td class="data">{$customer.postcode}</td>
      <td class="data">{$customer.city}</td>
   </tr>
{/strip}
        <!-- modal content -->
        <div class="modalhidden">
            <div id="osx-modal-content{$customer.customerid}">
                <div id="osx-modal-title">Customer no #{$customer.customerid}</div>
                <div class="close"><a href="#" class="simplemodal-close">x</a></div>
                <div id="osx-modal-data">
                    <h2>Hello! I'm Customer no. #{$customer.customerid}</h2>
                </div>
            </div>
        </div>
{/foreach}
</tbody>
</table>
Displaying {$total} records<br />

<script type="text/javascript">
function addModal(x)
{
    $("osx" + x).addEvent("click", function(){
          var SM = new SimpleModal();
              SM.show({
                "title":"Title",
                "contents": $("#osx-modal-content" + x).html()
              });
        });

}
</script> 
```

您可能已经注意到，我使用 smarty 作为模板，效果很好。

此外，单个 simplemodal 工作正常 - 但我想要其中多个具有不同内容。

问题是，如果这是一个好主意，还是应该放在单独的页面上？

请告诉我是否在这里遗漏了一些信息-这是我的第一篇文章:-)

问候，弗雷德里克

**编辑**

我现在有这个代码：

```
<table border="0" cellpadding="0" cellspacing="0" id="customertable" class="sortable">
<thead>
    <tr class="odd">
        <th>Navn</th>
        <th>Telefon</th>
        <th>Postnummer</th>
        <th>By</th>
    </tr>
</thead>
<tbody>
{foreach $results as $customer}
{strip}
   <tr class="{cycle values='even,odd'}">
      <td class="name" id='mousetracking' title={$customer.name}><a href="#" id="{$customer.customerid}">{$customer.name}</a></td>
      <td class="data">{$customer.phone}</td>
      <td class="data">{$customer.postcode}</td>
      <td class="data">{$customer.city}</td>
   </tr>
{/strip}
        <!-- modal content -->
        <!--<div class="modalhidden">-->
            <div id="modal_{$customer.customerid}">
                <div id="osx-modal-title_{$customer.customerid}">Customer no #{$customer.customerid}</div>
                <div class="close"><a href="#" class="simplemodal-close">x</a></div>
                <div id="osx-modal-data_{$customer.customerid}">
                    <h2>Hello! I'm Customer no. #{$customer.customerid}</h2>
                </div>
            </div>
        <!--</div>-->
{/foreach}
</tbody>
</table>
Displaying {$total} records<br /> 
```

连同这段 JS 代码：

```
jQuery(function ($) {
    var OSX = {
        container: null,
        init: function () {
            $("a").click(function (e) {
                e.preventDefault(); 

                $('#modal_' + this.id).modal({
                    overlayId: 'osx-overlay',
                    containerId: 'osx-container',
                    closeHTML: null,
                    minHeight: 80,
                    opacity: 65, 
                    position: ['0',],
                    overlayClose: true,
                    onOpen: OSX.open,
                    onClose: OSX.close
                });
            });
        },
        open: function (d) {
            var self = this;
            self.container = d.container[0];
            d.overlay.fadeIn('slow', function () {
                $('#modal_' + this.id, self.container).show();
                var title = $('#osx-modal-title_' + this.id, self.container);
                title.show();
                d.container.slideDown('slow', function () {
                    setTimeout(function () {
                        var h = $('#osx-modal-data_' + this.id, self.container).height()
                            + title.height()
                            + 20; // padding
                        d.container.animate(
                            {height: h}, 
                            200,
                            function () {
                                $("div.close", self.container).show();
                                $('#osx-modal-data_' + this.id, self.container).show();
                            }
                        );
                    }, 300);
                });
            })
        },
        close: function (d) {
            var self = this; // this = SimpleModal object
            d.container.animate(
                {top:"-" + (d.container.height() + 20)},
                500,
                function () {
                    self.close(); // or $.modal.close();
                }
            );
        }
    };

    OSX.init();

}); 
```

和原来的 jquery.simplemodal.js

我现在唯一的问题是，它用正确的 div 加载了模态，但是那个 div 是隐藏的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:44:36.907

好的。我设法自己修复了它。

结束了这段代码：

```
<table border="0" cellpadding="0" cellspacing="0" id="customertable" class="sortable">
<thead>
    <tr class="odd">
        <th>Navn</th>
        <th>Telefon</th>
        <th>Postnummer</th>
        <th>By</th>
    </tr>
</thead>
<tbody>
{foreach $results as $customer}
{strip}
   <tr class="{cycle values='even,odd'}">
      <td class="name" id='mousetracking' title={$customer.name}><div id="basic-modal"><a href="#" id="{$customer.customerid}">{$customer.name}</a></div></td>
      <td class="data">{$customer.phone}</td>
      <td class="data">{$customer.postcode}</td>
      <td class="data">{$customer.city}</td>
   </tr>
{/strip}
{/foreach}
</tbody>
</table>
{foreach $results as $customer}
{strip}
        <!-- modal content -->
        <div id="basic-modal-content_{$customer.customerid}" style="display:none;" width="600px">
            <h3>{$customer.name}</h3>
            <table border="0" cellpadding="0" cellspacing="0">
                <tr>
                    <td width="150px;">Adresse</td>
                    <td>{$customer.address1}<br />{$customer.postcode}&nbsp;{$customer.city}</td>
                </tr>
                <tr>
                    <td width="150px;">Telefon</td>
                    <td>{$customer.phone}</td>
                </tr>
                <tr>
                    <td width="150px;">Fax</td>
                    <td>{$customer.fax}</td>
                </tr>
                <tr>
                    <td width="150px;">Email</td>
                    <td>{$customer.email}</td>
                </tr>
                <tr>
                    <td width="150px;">Website</td>
                    <td>{$customer.web}</td>
                </tr>
            </table>
            <br /><br />
            <h4>Server Setup</h4>
            <code>{$customer.Server_setup}</code>
        </div>
{/strip}
{/foreach}
Displaying {$total} records<br /> 
```

连同这个javascript：

```
jQuery(function ($) {
    // Load dialog on page load
    //$('#basic-modal-content').modal();

    // Load dialog on click
    $('#basic-modal a').click(function (e) {
        $('#basic-modal-content_' + this.id).modal({
            overlayClose:true
        });
        return false;
    });

}); 
```

它就像一个魅力。

感谢所有的投入。

# javascript - 如何使用 raphael.js 获取 paper.path NUMBER

> ID：10286664
> 
> 赞同：0
> 
> 时间：2012-04-23T19:06:22.917
> 
> 标签：javascript, raphael

我正在使用这段代码：

```
var current = null;
for ( var state in aus) {
    aus[state].color = Raphael.getColor();
    (function(st, state) {
        st[0].style.cursor = "pointer";
        st[0].onmouseover = function() {
            current && aus[current].animate({
                fill : "#333",
                stroke : "#666"
            }, 500) && (document.getElementById(current).style.display = "");
            st.animate({
                fill : st.color,
                stroke : "#ccc"
            }, 500);
            st.toFront();
            R.safari();
            document.getElementById(state).style.display = "block";
            current = state;
        };
        st[0].onmouseout = function() {
            st.animate({
                fill : "#333",
                stroke : "#666"
            }, 500);
            st.toFront();
            R.safari();
        };
        if (state == "nsw") {
            st[0].onmouseover();
        }
    })(aus[state], state);
} 
```

从这个页面：[http ://raphaeljs.com/australia.htm](http://raphaeljs.com/australia.htm)

我已经添加了这个：

```
st[0].onmousedown = function() {
    paper.print();
    var url = "index.php?cmd=2&sub=0";
    window.open(url, "popup");
}; 
```

进入 for 循环以打开由 php 脚本生成的弹出窗口。

'sub' 请求参数将是与与状态关联的文件夹对应的数值，但我不知道如何将数字与其关联。

假设每个状态都是从 0 到状态数的数字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:33:55.580

为什么不为每个州创建 id：

```
var ids = {}, i = 0;
for (var state in aus) {
  ids[state] = i;
  i++;
} 
```

接着：

```
var url = "index.php?cmd=2&sub=" + ids[state]; 
```

# c# - MVC 网址缩短器

> ID：10286666
> 
> 赞同：1
> 
> 时间：2012-04-23T19:06:24.350
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing, url-shortener

我想使用 MVC 路由编写一个 URL 缩短器。问题是我想使用以下 URL：{host}/?{word}

为此，我使用 MapRoute 方法让默认值转到正确的控制器。确实如此，但是当它将 null 传递给参数而不是 {word} 的内容时。

如果我指定参数名称，同样的事情会正常工作，即 {host}/?{param-name}={word}

有谁知道如何告诉 MVC，如果我不指定参数名称，那么它应该转到第一个参数或默认参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:15:44.843

您可以尝试编写放在您的操作方法上的操作过滤器。动作过滤器应该通过 url 查询参数，如果它找到具有空值的参数，它可以绑定到参数。

```
public override void OnActionExecuting(ActionExecutingContext filterContext) {
if (filterContext.HttpContext.Request.Url != null) {
    NameValueCollection urlQuery = System.Web.HttpUtility.ParseQueryString(filterContext.HttpContext.Request.Url.Query);

    for (int i = 0; i < urlQuery.Keys.Count; i++ )
    {
        if (urlQuery.Get(urlQuery[i]) == null)
        {
            filterContext.ActionParameters["word"] = urlQuery[i];
        }
    }
}
base.OnActionExecuting(filterContext); 
```

}

你必须写一些非空条件，这样它就不会失败:)

**编辑：** 如果你想放弃？只需使用默认的 mvc url 路由，就像这样。

```
routes.MapRoute(
    "UrlShortener", // Route name
    "{word}", // URL with parameters
    new { controller = "UrlShortener", action = "Fetch",  word="Default", } 
```

);

您的控制器将接受

```
public ActionResult UrlShortener(string word) {
if (word == "Default") return Content("No word specified");

//some BLL
return View(); 
```

}

这样你的 url 将是[http://hostname/word](http://hostname/word)，如果没有指定 word 它将传递“默认”。

如果那是你想要的

# asp.net - “SharePoint Foundation 2010”对客户端免费吗

> ID：10286668
> 
> 赞同：0
> 
> 时间：2012-04-23T19:06:25.833
> 
> 标签：asp.net, sharepoint, sharepoint-2010, sharepointfoundation2010

SharePoint Foundation 2010 是否可以免费出售给任何客户。我已经有两台带有以下工具的物理服务器：

*   Windows Server 2008（网络服务器）
*   Sql Server 2008（数据库服务器）

我已经在这台服务器上发布了几个 ASP.NET 网站。

现在我的问题是；如果我已准备好注册 Windows Server 2008 和 Sql Server 2008，是否可以免费配置 SharePoint Foundation 2010？还是我需要购买一些许可证？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:59:11.187

Mohsin
您可以配置 SharePoint Foundation 2010，无需任何额外费用。但是，如果您计划在 Internet 上启用您的 SharePoint 站点，那么您将不得不查看 Windows Server 的“外部连接器”许可证。以下帖子提供了有关外部连接器许可的详细信息

[http://social.technet.microsoft.com/Forums/is/sharepoint2010setup/thread/39ac1283-a093-4101-8eb5-194670db3f19](http://social.technet.microsoft.com/Forums/is/sharepoint2010setup/thread/39ac1283-a093-4101-8eb5-194670db3f19)

# jquery - 参数中的这个常数有什么作用？

> ID：10286670
> 
> 赞同：-1
> 
> 时间：2012-04-23T19:06:33.423
> 
> 标签：jquery

这是一个交叉淡入淡出幻灯片放映。我不明白这在下面的代码中做了什么：`rotatePics(1);`

HTML

```
<div id="photos">
  <img alt="Glendatronix" src="../../images/glenda_200.jpg" />
  <img alt="Darth Fader" src="../../images/fader_200.jpg" />
  <img alt="Beau Dandy" src="../../images/beau_200.jpg" />
  <img alt="Johnny Stardust" src="../../images/johnny_200.jpg" />
  <img alt="Mo' Fat" src="../../images/mofat_200.jpg" />
</div> 
```

JS

```
$(document).ready(function() {
  rotatePics(1);
}

function rotatePics(currentPhoto) {
  var numberOfPhotos = $('#photos img').length;
  currentPhoto = currentPhoto % numberOfPhotos;
  $('#photos img').eq(currentPhoto).fadeOut(function() {
     // re-order the z-index
     $('#photos img').each(function(i) {
        $(this).css(
          'zIndex', ((numberOfPhotos - i) + currentPhoto) % numberOfPhotos
        );
     });
     $(this).show();
    setTimeout(function() {rotatePics(++currentPhoto);}, 4000);
  });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:10:48.760

“1”只是起始位置。

`rotatePics(++currentPhoto)`; <-- 这会增加位置并调用自身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:09:13.033

`rotatePics(1);`-> 只是一个开始。它只是说它应该从图像 1 开始。

旋转逻辑是`setTimeout(function() {rotatePics(++currentPhoto);}, 4000);`每 4 秒旋转一次。

```
 setTimeout(function() {          //-> set Timer
      rotatePics(++currentPhoto); //-> recursion call
 }, 4000);                        //-> 4 seconds wait time 
```

# database - 数据库登录失败。在水晶报告中回发后

> ID：10286672
> 
> 赞同：0
> 
> 时间：2012-04-23T19:06:40.410
> 
> 标签：database, crystal-reports, connection, report

我通过以下任一代码在运行时将数据库连接到水晶报表，但它在回发中丢失了数据库连接（当我单击树视图或尝试导航到下一页时）这是我得到的错误：
System.Runtime.InteropServices。 COMException: 数据库登录失败。

```
 ReportDocument cryRpt = new ReportDocument();
            cryRpt.Load(path); 
```

(((1)))

```
 for (int i = 0; i < cryRpt.DataSourceConnections.Count; i++)
                cryRpt.DataSourceConnections[i].SetConnection(ServerName, DatabaseName, UserID, Password);
            for (int i = 0; i < cryRpt.Subreports.Count; i++)
                for (int j = 0; j < cryRpt.Subreports[i].DataSourceConnections.Count; j++)
                    cryRpt.OpenSubreport(cryRpt.Subreports[i].Name).DataSourceConnections[j].SetConnection(ServerName, DatabaseName, UserID, Password);

                    cryRpt.OpenSubreport(cryRpt.Subreports[i].Name).DataSourceConnections[j].SetConnection(ServerName, DatabaseName, UserID, Password); 
```

(((2)))

```
 crConnectionInfo.ServerName = ServerName;
            crConnectionInfo.DatabaseName = DatabaseName;
            crConnectionInfo.UserID = UserID;
            crConnectionInfo.Password = Password;
            crDatabase = cryRpt.Database;
            crTables = crDatabase.Tables;

            for (int i = 0; i < crTables.Count; i++)
            {
                crTable = crTables[i];
                crTableLogOnInfo = crTable.LogOnInfo;
                crTableLogOnInfo.ConnectionInfo = crConnectionInfo;
                crTable.ApplyLogOnInfo(crTableLogOnInfo);
                //crTable.Location = crConnectionInfo.DatabaseName + ".dbo." + crTable.Location.Substring(crTable.Location.LastIndexOf(".") + 1) 
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T03:57:15.543

当您回发时，CrystalReportViewer 正在丢失具有有效连接的报表。

将我在会话中存储 cryRpt 的行添加到您现有的报告加载代码中。根据下文，将此组合代码放入仅在初始页面加载时运行的例程中：

```
if (!IsPostBack)
{
    // do all your normal code loading you did in your OP
    // add this line to store the ReportDocument
    Session["myReport"] = cryRpt;
    crReportViewer.ReportSource = cryRpt;
    crReportViewer.Show();
} 
```

然后将此代码放在 else 中（当我们正在回发时）以从会话中获取我们的 ReportDocument 并将其重新分配给 CrystalReportViewer 控件。

```
else
{
    // this is when you postback
    // (i.e. paging, drilling into tree view, exporting, printing)        
    crReportViewer.ReportSource = (ReportDocument)Session["myReport"];
    crReportViewer.Show();
} 
```

# java - 如何检查整数中的重复序列

> ID：10286677
> 
> 赞同：25
> 
> 时间：2012-04-23T19:06:56.893
> 
> 标签：java, regex, algorithm

我有一个字母数字字符串，我想检查其中的模式重复是否只是整数。它们应该是连续的。

**例子**

1.  *12341234q我们*应该告诉我*1234*重复了。
2.  *1234qwe1234***不**应该告诉我*1234*是重复的，因为它不连续。
3.  *12121212*应该被视为*12*被重复，因为这是第一个被发现被重复的集合。但是，如果有一种算法可以找到*1212作为**12*之前的重复集，那么我猜它必须在*1212*上再次执行这些步骤。

我的想法是我可以通过迭代存储整数部分并将其与`( <= '0' && >= '9')`不同的`StringBuilder`. 然后我读到了关于对字符串执行 FFT 的文章，它显示了重复的模式。但是我不知道如何在 Java 中执行 FFT 并寻找结果，而且，我希望在不去信号处理的情况下尝试这样做。我阅读了有关 KMP 模式匹配的信息，但这仅适用于给定的输入。有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-04-23T19:26:46.930

我认为你可以借助正则表达式来解决这个问题。考虑这样的代码：

```
String arr[] = {"12341234abc", "1234foo1234", "12121212", "111111111", "1a1212b123123c12341234d1234512345"};
String regex = "(\\d+?)\\1";
Pattern p = Pattern.compile(regex);
for (String elem : arr) {
    boolean noMatchFound = true;
    Matcher matcher = p.matcher(elem);
    while (matcher.find()) {
        noMatchFound = false;
        System.out.println(elem + " got repeated: " + matcher.group(1));
    }
    if (noMatchFound) {
        System.out.println(elem + " has no repeation");
    }
} 
```

**输出：**

```
abc12341234abc got repeated: 1234
1234foo1234 has no repeation
12121212 got repeated: 12
12121212 got repeated: 12
111111111 got repeated: 1
111111111 got repeated: 1
111111111 got repeated: 1
111111111 got repeated: 1
1a1212b123123c12341234d1234512345 got repeated: 12
1a1212b123123c12341234d1234512345 got repeated: 123
1a1212b123123c12341234d1234512345 got repeated: 1234
1a1212b123123c12341234d1234512345 got repeated: 12345 
```

### 解释：

使用的正则表达式在`(\\d+?)\\1`哪里

```
\\d        - means a numerical digit
\\d+       - means 1 or more occurrences of a digit
\\d+?      - means reluctant (non-greedy) match of 1 OR more digits
( and )    - to group the above regex into group # 1
\\1        - means back reference to group # 1
(\\d+?)\\1 - repeat the group # 1 immediately after group # 1 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-23T19:20:21.593

我不确定您是否熟悉正则表达式 (RegEx)，但此代码有效

```
String str = "12341234qwe";
String rep = str.replaceAll(".*(.+)\\1.*","$1");
if (rep.equals(str))
    System.out.println(str+" has no repition");
else
    System.out.println(str+" has repition "+rep);
str = "1234qwe1234";
rep = str.replaceAll(".*(.+)\\1.*","$1");
if (rep.equals(str))
    System.out.println(str+" has no repition");
else
    System.out.println(str+" has repition "+rep); 
```

这是教程：[http ://docs.oracle.com/javase/tutorial/essential/regex/](http://docs.oracle.com/javase/tutorial/essential/regex/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-23T19:44:55.157

我的理论是，您可以使用称为[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)的数据结构来实现您想要的。

遍历初始字符串，收集每个连续的数字序列并构建其后缀树。对于您的示例，它看起来像（对于前 4 个后缀）：

```
 R - root
      |         |          |         |
      |         |          |         |
      |         |          |         | 
  12341234$  2341234$   341234$     41234$ 
```

现在，按顺序排列的下一个后缀是 1234$。但是，在插入时，我们注意到它与第一个后缀的前缀 1234 匹配。每次将后缀添加到树时，计数器都会保持并行并递增。

在每一步，我们都会将计数器与要插入的当前后缀与其匹配的子字符串之间的匹配长度进行比较。如果匹配的长度是计数器的倍数，那么我们就有重复。

在上述情况下，当我们插入 1234$ 时，计数器将是 4（从 0 开始），并且前缀为 12341234$ 的匹配长度也是 4，因此重复 1234。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-23T19:27:13.030

首先，您需要为模式定义一些规则。如果模式可以具有任意长度，那么您应该开始存储 int 值（构建模式）并开始检查第一个重复 int 处的重复。

在这种情况下： 1234123q 您正在构建 1234 模式，然后由于 1 重复，您应该继续存储它并开始将其与下一个值进行比较。

你如何处理模式中的重复？

案例：123124123124

模式 123124 重复两次。它应该注册为重复，还是停在自 123 != 124 以来的前 4 个？

如果您选择将这些案例注册为有效重复，则需要开始创建并行模式以在您不断构建它们的同时进行检查。

第一种情况（在第一个 NOT 重复值处停止）很简单，第二种情况将生成大量并行模式来构建和同时检查。

一旦到达流的末尾，您就可以使用字符串提供的现有方法进行搜索。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2012-04-23T19:29:20.377

[阿帕奇公共朗。](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html)有一个类`org.apache.commons.lang.StringUtils`，它有一个计算特定子字符串出现次数的方法。它已经存在，因此您可以直接使用它，而不是创建自己的解决方案。

```
//First parameter is the string to find and second param is the String to search.
StringUtils.CountMatches("1234","12341234"); 
```

# r - 如何在 r 中使用循环进行子集化和分组？

> ID：10286679
> 
> 赞同：0
> 
> 时间：2012-04-23T19:07:01.723
> 
> 标签：r, loops, batch-file, plyr

我的大部分问题只是如何提取和组织数据，没有事先培训，我为我无法清楚地表达我想要的东西而道歉。我希望我什至知道如何用短语来在教科书或网上查找它们。这是我现在的问题：

我有一个信息数据框，它有一个称为 ID 的唯一组 ID，有 153 个唯一 ID，但我有超过 6,000 行来自这些组的信息。

我想做的是一次从两组中获取所有信息，并写出一个包含所有相关信息的简单 csv 文件。当总体人数为奇数（n = 153）时，这将如何运作。

我想是这样的：

```
IDs = unique(dat$ID)
for (i in length(IDs)){
    IDgp = subset(dat, dat$ID==IDs[i] & dat$ID==IDs[i+1])
    write.csv(IDgp, paste(IDgp[i],".csv")
    i = i+2
    } 
```

这不起作用，我不知道如何让它增加到下一个“2 组”。我知道 for 循环很笨重，我曾认为 ddply 可能会起作用，甚至是 which 命令而不是子集。由于在 RI 中有多种做事方式，因此我什至不知道该怎么称呼我想做的事情。我想我已经把它复杂化了。

我一直在寻找答案，并认为这是一种可能性，但不知道如何让它一次为超过 1 个组编写信息，而且我不清楚 function(x) 命令在做什么：

```
d_ply(dat, "ID", function(x)
     write.csv(x[i], file = paste(x$ID[i], ".csv")
     , row.names = FALSE)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:29:46.193

也许这会有所帮助。但我认为有一种更优雅的方法可以做到这一点。

```
IDs = unique(dat$ID)
for (i in seq(1, length(IDs), 2)){
  write.csv(dat[dat$ID %in% IDs[i+c(0,1)], ], 
    paste(IDs[i], "_", IDs[i+1], ".csv", sep=""))
} 
```

编辑以创建全长 ID 的序列

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:41:52.477

这是一种方法，可以根据您的 ID 构建适当维度的矩阵，然后循环遍历它们：

```
dat <- data.frame(id = 1:10, foo = runif(10))
#This will throw a warning if dimensions don't line up, not sure what you want to do with those
idpairs <- matrix(sort(unique(dat$id)), ncol = 2, byrow = TRUE)
> head(idpairs,2)
     [,1] [,2]
[1,]    1    2
[2,]    3    4
a_ply(idpairs, 1, function(x) print(dat[dat$id  %in% x,])) 
```

你显然会用`print`适合你目的的任何东西替换上面的函数。

# haskell - 如何创建提升类型的类型类实例？

> ID：10286680
> 
> 赞同：6
> 
> 时间：2012-04-23T19:07:03.243
> 
> 标签：haskell, typeclass

我有一个通过 ghc 7.4.1 中的 DataKinds 推广的数据类型和一个我想用来执行类型特定操作的给定类型类。

```
data Type = TInt32 | TInt64 | TInt16
class TypeTraits a where
  ... 
```

然后我尝试创建提升类型的类型类实例，如下所示：

```
instance TypeTraits TInt32 where
  ... 
```

我收到以下类型的错误：

```
Kind mis-match
The first argument of `TypeTraits' should have kind `*',
but `TInt32' has kind `Type'
In the instance declaration for `TypeTraits TInt32' 
```

试图通过指定“a”的类型来解决这个问题：

```
class TypeTraits (a :: Type) where
  ...

Kind mis-match
Expected kind `ArgKind', but `a' has kind `Type'
In the type `a -> String'
In the class declaration for `TypeTraits' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T19:12:06.937

问题出在班级的主体上；具有提升类型的类型没有任何值，因此您不能拥有将一个作为参数的函数。你必须使用`[Proxy](http://hackage.haskell.org/packages/archive/tagged/latest/doc/html/Data-Proxy.html) a -> String`或类似的。

顺便说一句，如果您打开`PolyKinds`扩展程序，那么您应该能够完全省略 kind 注释。（实际上，您可能必须这样做，才能定义自己的`Proxy`类型，因为我认为 Data.Proxy 中的那个可能是`* -> *`，而您需要`Type -> *`。如果您`data Proxy p = Proxy`使用`PolyKinds`on 定义，那么它将被推断为`AnyK -> *`。）

# c# - asp.net c# SqlDataSource 超时问题

> ID：10286685
> 
> 赞同：9
> 
> 时间：2012-04-23T19:07:10.380
> 
> 标签：c#, asp.net

我正在尝试将 SqlDataSource 的超时时间延长超过 30 秒（似乎是默认值）。我正在尝试运行一个必须运行 100,000 条记录的存储过程。在繁忙时段，它会超时。我在 2003 服务器上使用 ASP.NET 4.0 和 IIS 6.0。

**错误消息：** 超时已过期。在操作完成之前超时时间已过或服务器没有响应。

我试图延长超时无济于事：

```
< asp:SqlDataSource ID="dsTest" EnableCaching="true" CacheDuration="604800" runat="server" ConnectionString="<%$ ConnectionStrings:SuperNARIC %>" SelectCommand="selectStatus" SelectCommandType="StoredProcedure" onselecting="dsTest_Selecting" >
    <SelectParameters>
        < asp:ControlParameter ControlID="ddlCar" Name="CountryID" PropertyName="SelectedValue" Type="Int32" />
    < /SelectParameters>
< /asp:SqlDataSource>

protected void dsTest_Selecting(object sender, SqlDataSourceSelectingEventArgs e)
    {
        e.Command.CommandTimeout = 300;
    } 
```

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-02-21T14:59:22.233

就像[这里](https://stackoverflow.com/a/11265901/943095)提到的，这对我有用。

您可以像这样增加 Timeout 属性

```
protected void SqlDataSource1_Selecting(object sender, SqlDataSourceSelectingEventArgs e)
        {
            e.Command.CommandTimeout = 0;
        } 
```

将超时设置为 0 表示没有超时

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-23T19:26:07.367

有两种超时类型：**ConnectionTimeout**和**CommandTimeout**：

**ConnectionTimeout** 确定您的应用程序等待建立与服务器的连接的最长时间。

**CommandTimeout**：允许执行命令的最长时间。

确保两者都设置。在**命令**中：

```
 command.CommandTimeout = 300; 
```

`Selecting`注意：如果您的命令是数据源的一部分，这可以在事件中实现。`e.Command.CommandTimeout = 0;`值`0`表示无限期等待。

和**连接字符串**：

```
SqlConnectionStringBuilder cs = new SqlConnectionStringBuilder(connectionString);
cs.ConnectTimeout = 300; 
```

或者：

```
<add name="MyConnectionString" connectionString="Data Source=.\SQLEXPRESS; Database=MyDB; Integrated Security=True;Pooling=True;connection timeout=30" providerName="System.Data.SqlClient" /> 
```

**注意**：尝试全局设置连接字符串超时，可能在您的配置文件中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T19:09:07.883

超时通常在您的连接字符串中设置。有关完整示例，请参见[http://www.connectionstrings.com/](http://www.connectionstrings.com/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T19:11:52.127

您需要确保您的`CommandTimeout`和您`ConnectionString`的`Connect Timeout`都设置为防止长时间运行的存储过程超时。如果你不设置连接超时，你会在存储过程完成之前超时，即使存储过程命令本身没有超时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T20:21:36.233

最大连接超时值可以是 2147483647。尝试将连接超时值设置到 Web Config 中的连接字符串中，如下所示

`<connectionStrings> <add name="ConnectionString" connectionString="Data Source=144681;Initial Catalog=Customer;Persist Security Info=True;User ID=xxxxx;Password=yyyyy" providerName="System.Data.SqlClient" /> </connectionStrings>`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-23T19:09:20.787

连接超时/连接超时/超时 默认值 - 15 秒 在终止尝试并生成错误之前等待连接到服务器的时间长度（以秒为单位）。有效值大于或等于 0 且小于或等于 2147483647。

```
string myconstr = "Data Source=(local);Initial Catalog=AdventureWorks;"
    + "Integrated Security=SSPI;Connection Timeout=30" 
```

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring%28v=vs.100%29.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-12T10:35:10.903

这对我有用：

```
 <script runat="server">
    protected void SqlDataSource1_Selecting(object sender, SqlDataSourceSelectingEventArgs e)
    {
    e.Command.CommandTimeout = 0;
    }
    </script>

<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
ConnectionString="Your Connection String" 
ProviderName="Teradata.Client.Provider"
SelectCommand="A SELECT COMMAND THAT TAKES A LONG TIME"
DataSourceMode="DataSet"
onselecting="SqlDataSource1_Selecting"> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-04-23T15:19:37.900

There's a timeout for both the SQL and the page response time.

```
Server.ScriptTimeout = 120; 
e.Command.CommandTimeout = 120; 
```

# iphone - SimpleAudioEngine，播放 .caf 文件

> ID：10286686
> 
> 赞同：0
> 
> 时间：2012-04-23T19:07:21.817
> 
> 标签：iphone, objective-c, ios, cocos2d-iphone

> **可能重复：**
> [播放 .caf 文件：在模拟器中可以正常工作，但在 iPhone 中不行](https://stackoverflow.com/questions/1363972/playing-a-caf-file-works-fine-in-simulator-but-not-in-iphone)

我正在尝试使用 SimpleAudioEngine 在我正在开发的 iPhone 应用程序中播放背景音乐。我使用以下代码播放背景音乐：

```
[[SimpleAudioEngine sharedEngine] preloadBackgroundMusic: @"MenuTheme.mp3"];
[[SimpleAudioEngine sharedEngine] playBackgroundMusic: @"MenuTheme.mp3" loop: YES]; 
```

这工作正常。

但是，当我使用带有以下行的终端将 MenuTheme.mp3 转换为 MenuTheme.caf 时：

```
afconvert -f caff -d LEI16 "MenuTheme.mp3" "MenuTheme.caf" 
```

我再次使用 SimpleAudioEngine 播放 .caf 文件，它不起作用。

有关如何解决此问题的任何想法？.caf 文件在我单击时会播放。在终端，当我写：

```
afinfo "MenuTheme.caf" 
```

它告诉我数据格式是 2 ch, 44100 Hz, 'lpcm' (0x0000000C) 16-bit little-endian signed integer no channel layout。

我真的不知道出了什么问题，但我对在 iPhone 上使用音频也很陌生。任何帮助表示赞赏。谢谢。

编辑： afconvert 拼写错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:26:51.380

我认为这`afconvert`不是`fconvert`你的问题中提到的。（我相信这是一个错字，对吗？）我在您的命令行上没有看到明显的问题。我通常使用：

```
afconvert -f caff -d LEI16@22050 sound.wav 
```

将我的波形文件转换为 CAF。

由于您无法通过单击播放 CAF 文件，因此我建议您尝试将其转换为其他格式，例如 wave 或 AIFF：

```
afconvert -f AIFC -d ima4 sound.wav 
```

并尝试在 Finder 中播放它们。如果它也不起作用，请尝试先通过一些第三方工具（例如[Audacity](http://audacity.sourceforge.net/) ）将 MPEG Layer 3 文件转换为 wave ，然后使用`afconvert`.

PS我一般用CAF做音效，用AIFF做背景音乐。请参考：[iOS 上的声音：最佳实践。](http://gamua.com/blog/2010/06/sound-on-ios-best-practices/)

# c# - 无法使用 SQLConnection 登录到 SQL 服务器

> ID：10286697
> 
> 赞同：1
> 
> 时间：2012-04-23T19:08:35.333
> 
> 标签：c#, sql-server, asp.net-mvc-3

这真的很奇怪，因为它以前效果很好。“gdb”是我的数据上下文。大多数时候我使用 LINQ->SQL 来处理我的数据库。但是有些东西，比如地理数据不受 LINQ 支持，因此这些查询是通过旧式手动 SQL 执行的。

```
SqlConnection con = new SqlConnection(gdb.Connection.ConnectionString);
con.Open(); 
```

正如我所说，这以前有效，但由于某种原因不再有效。虽然在测试时，它工作了一次，然后又停止工作。我收到此错误消息：

```
**SQLException was unhandled by code**
Login failed for user 'anton'. 
```

LINQ->SQL 的其余部分工作正常，但由于某种原因我无法打开该连接。SQL-Server 托管在 Azure 中。是的，我的 IP 在防火墙规则中是允许的！

ASP.Net MVC3 c#

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:11:53.200

您的连接字符串具有无效凭据。请检查您使用的服务器名称、用户名和密码是否正确。

```
Server=tcp:[SERVERNAME].database.windows.net;Database=DATABASE;User ID=[USERNAME]@[SERVERNAME];Password=PASSWORD;Trusted_Connection=False;Encrypt=True; 
```

这就是它应该如何格式化，只需替换 SERVERNAME、DATABASE、USERNAME 和 PASSWORD

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:01:33.233

我现在明白了！问题是我试图在关闭前一个连接之前打开一个新连接。这似乎是由 LINQ->SQL 自动处理的，但是当另一个 SQLConnection 打开时，无法执行 LINQ->SQL 语句！

# ruby-on-rails - 如何从 Mechanize::File 对象转换为 Mechanize::Page 对象？

> ID：10286700
> 
> 赞同：2
> 
> 时间：2012-04-23T19:08:44.380
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, mechanize-ruby

我有一个登录表单的页面。登录后有一些重定向。第一个看起来像这样：

```
#<Mechanize::File:0x1f4ff23 @filename="MYL.html", @code="200", @response={"cache-control"=>"no-cache=\"set-cookie\"", "content-length"=>"114", "set-cookie"=>"JSESSIONID=GdJnPVnhtN91KZfQPc3QzM1NLCyWDsnyvpGg8LL0Knnz3RgqxLFs!1803804592!-2134626567; path=/; secure, COOKIE_TEST=Aslyn; secure", "x-powered-by"=>"Servlet/2.4 JSP/2.0"}, @body="\r\n<html>\r\n  <head>\r\n    <meta http-equiv=\"refresh\" content=\"0;URL=MYL?Select=OK&StateName=38\">\r\n  </head>\r\n</html>", @uri=#<URI::HTTPS:0x16e1eff URL:https://www.manageyourloans.com/MYL?StateName=global_CALMLandingPage&GUID=D1704621-1994-E076-460A-10B2B682B960>> 
```

所以当我在这里做一个 page.class 我得到

```
Mechanize::File 
```

我如何将其转换为`Mechanize::Page`？

* * *

@pguardiario

为了更好地解释，我将原始消息中的代码存储在 page.

当我做 page.class 我得到 Mechanize::File

那么我执行上面的代码：

```
agent = Mechanize.new
agent.post_connect_hooks << lambda {|http| http[:response].content_type = 'text/html'} 
```

所以我这样做：agent.get(page.uri.to_s) 或事件尝试使用任何 url agent.get(" [https://www.manageyourloans.com/MYL](https://www.manageyourloans.com/MYL) ") 我收到一个错误：ArgumentError: wrong number of arguments （4对1）

我什至试过这个：

```
agent = Mechanize.new { |a|
  a.post_connect_hooks << lambda { |_,_,response,_|
    if response.content_type.nil? || response.content_type.empty?
      response.content_type = 'text/html'
    end
  }
} 
```

我的问题是，一旦我这样做了，如何将上一页转换为 Mechanize::Page？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:58:44.783

您可以通过获取文件对象中包含的正文并将其作为新页面的正文传递，将 Mechanize::File 转换为 Mechanize::Page：

```
irb(main):001:0> require 'mechanize'
true
irb(main):002:0> file = Mechanize::File.new(URI.parse('http://foo.com'),nil,File.read('foo.html'))
#<Mechanize::File:0x100ef0190
    @full_path = false,
    attr_accessor :body = "<html><body>foo</body></html>\n",
    attr_accessor :code = nil,
    attr_accessor :filename = "index.html",
    attr_accessor :response = {},
    attr_accessor :uri = #<URI::HTTP:0x100ef02d0
        attr_accessor :fragment = nil,
        attr_accessor :host = "foo.com",
        attr_accessor :opaque = nil,
        attr_accessor :password = nil,
        attr_accessor :path = "",
        attr_accessor :port = 80,
        attr_accessor :query = nil,
        attr_accessor :registry = nil,
        attr_accessor :scheme = "http",
        attr_accessor :user = nil,
        attr_reader :parser = nil
    >
> 
```

首先，我创建了一个假的 Mechanize::File 对象，只是为了有一个示例代码可以遵循。您可以在`:body`.

当 Mechanize 无法确定真正的内容类型是什么时，它会创建一个 Mechanize::File 对象。

```
irb(main):003:0> page = Mechanize::Page.new(URI.parse('http://foo.com'),nil,file.body)
#<Mechanize::Page:0x100ed5e30
    @full_path = false,
    @meta_content_type = nil,
    attr_accessor :body = "<html><body>foo</body></html>\n",
    attr_accessor :code = nil,
    attr_accessor :encoding = nil,
    attr_accessor :filename = "index.html",
    attr_accessor :mech = nil,
    attr_accessor :response = {
        "content-type" => "text/html"
    },
    attr_accessor :uri = #<URI::HTTP:0x100ed5ed0
        attr_accessor :fragment = nil,
        attr_accessor :host = "foo.com",
        attr_accessor :opaque = nil,
        attr_accessor :password = nil,
        attr_accessor :path = "",
        attr_accessor :port = 80,
        attr_accessor :query = nil,
        attr_accessor :registry = nil,
        attr_accessor :scheme = "http",
        attr_accessor :user = nil,
        attr_reader :parser = nil
    >,
    attr_reader :bases = nil,
    attr_reader :encodings = [
        [0] nil,
        [1] "US-ASCII"
    ],
    attr_reader :forms = nil,
    attr_reader :frames = nil,
    attr_reader :iframes = nil,
    attr_reader :labels = nil,
    attr_reader :labels_hash = nil,
    attr_reader :links = nil,
    attr_reader :meta_refresh = nil,
    attr_reader :parser = nil,
    attr_reader :title = nil
>
irb(main):004:0> page.class
Mechanize::Page < Mechanize::File 
```

只需传入文件对象的主体，让 Mechanize 转换为您知道的应该是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T04:04:43.977

我喜欢@The Tin Man的回答，但强制响应的内容类型可能更简单：

```
agent.post_connect_hooks << lambda {|http| http[:response].content_type = 'text/html'} 
```

# c#-4.0 - 从 C# 中的活动目录获取登录/注销通知

> ID：10286701
> 
> 赞同：0
> 
> 时间：2012-04-23T19:08:46.643
> 
> 标签：c#-4.0, active-directory

我正在尝试做一个小应用程序来监视 AD 中用户的登录/注销。目前我正在监控安全事件日志。但我正在寻找一种更广告的方式

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:43:23.647

AD 中没有提供这种事件的机制......

# yacc - yacc (bison) ast 简化

> ID：10286719
> 
> 赞同：0
> 
> 时间：2012-04-23T19:10:09.217
> 
> 标签：yacc, abstract-syntax-tree

可以说我的 .y 语法的一部分是这样的：

```
stmt : expr { $$ = $1; }
      | stmt expr { $$ = insert_stmt_list($1, $2); } 
```

我可以有一个给出一个表达式的语句，或者我可以有几个表达式来生成一个语句列表。关于后者，我通过 insert_stmt... 函数存储它，但是第一个我将它发送到堆栈的顶部。

我的问题是：我该如何处理 $$ = $1 ？我的意思是，insert_stmt_list 将所有内容都放在一个结构中，我知道它在那里，我可以打印它们的值等等，但是 $$ = S1 到底去哪里了？怎么读？:-)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:58:32.533

回复：*怎么读？*

你有一个左递归语法，它首先必须识别一个`expr`. 这被归结`stmt`为由 产生的语义值`make_new_stmt_list`变成了`stmt1`by的语义值`$$ = $1;`。

这只是意味着“从右侧（恰好是唯一一个）获取第一个符号的语义值并将其作为左侧的语义值传播”。

然后，如果`expr`看到另一个，解析将继续另一个产生：

```
stmt : ...
     | stmt expr { $$ = insert_stmt_list($1, $2); } 
```

在这里，`$1`来自`stmt`右侧的 是`$$`在产生的先验归约中分配给的语义值`stmt`。

您已经设计了系统，以便`expr`a 用作`stmt`. 此外， an`expr`产生的值适合作为 : 的任一参数`insert_stmt_list`。表达式是列表。

所以：

1.  如果您的输入只有一个表达式 E，那么`stmt`出现的就是那个表达式。

2.  如果您有两个表达式 E1 和 E2，则`stmt`which emeges 是以下结果：

    ```
    insert_stmt_list(E1, E2) 
    ```

3.  如果你有三个表达式，那么整体`stmt`就是这些调用的结果：

    ```
    insert_stmt_list(insert_stmt_list(E1, E2), E3) 
    ```

等等。这是否有意义取决于此“插入”操作的语义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:26:13.233

写这样的东西更惯用：

```
stmt : expr { $$ = make_new_stmt_list($1); }
      | stmt expr { $$ = insert_stmt_list($1, $2); } 
```

一种或另一种方式，您需要将表达式数据结构包装在语句列表数据结构中。

# android - Android tablelayout视图不出现

> ID：10286720
> 
> 赞同：0
> 
> 时间：2012-04-23T19:10:13.727
> 
> 标签：android, view

安卓编程新手。

我有一个布局 XML，我想向其中添加一个列表（包含数据库中的项目），格式为表格。

这是代码：

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.edit_cat);

        DatabaseHandler db = new DatabaseHandler(this);
        List<Category> allCategories = db.getAllCategories();

        //Get the main layout from XML
        LinearLayout mainLayout = (LinearLayout) findViewById(R.id.edit_cat);

        //Create table layout for the categories
        TableLayout catList = new TableLayout(this);

        //Iterate the categories, and organize in tables
        for (Category category : allCategories) {
            TableRow tr = new TableRow(this);

            //Display category name
            TextView name = new TextView(this);
            name.setLayoutParams(new LayoutParams(                      
                    LayoutParams.FILL_PARENT,
                    LayoutParams.WRAP_CONTENT));

            name.setText(category.getName());

            //Display category type
            TextView type = new TextView(this);
            type.setText(category.getType());
            type.setLayoutParams(new LayoutParams(
                    LayoutParams.FILL_PARENT,
                    LayoutParams.WRAP_CONTENT));

            //Display edit button
            Button btnEdit = new Button(this);
            btnEdit.setText(getResources().getString(R.string.edit));

            btnEdit.setLayoutParams(new LayoutParams(
                    LayoutParams.FILL_PARENT,
                    LayoutParams.WRAP_CONTENT));

            //Display delete button
            Button btnDelete = new Button(this);
            btnDelete.setText(getResources().getString(R.string.delete));

            btnDelete.setLayoutParams(new LayoutParams(
                    LayoutParams.FILL_PARENT,
                    LayoutParams.WRAP_CONTENT));

            tr.addView(name);
            tr.addView(type);
            tr.addView(btnEdit);
            tr.addView(btnDelete);

            catList.addView(tr, new TableLayout.LayoutParams(
                    LayoutParams.FILL_PARENT,
                    LayoutParams.WRAP_CONTENT));
        }

        mainLayout.addView(catList);

    } 
```

这不会向布局添加任何内容。任何想法为什么这不起作用？

编辑：在此处添加了 xml 代码：

```
<?xml version="1.0" encoding="utf-8"?>
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/edit_cat"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:layout_weight="1">

<TextView style="@style/pageHeader"
  android:text="@string/catEditor"/>

<Button
    android:id="@+id/btnNewCategory"
    android:text="@string/newCategory"
    android:textSize="11pt"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:onClick="onBtnClicked"/>
<Button
    android:id="@+id/back"
    android:text="@string/back"
    android:textSize="11pt"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:onClick="onBtnClicked"/>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:49:39.947

好的，我想我有一个答案给你。

指定 LayoutParams 时需要更具体。虽然它不会引发编译异常，但如果您没有指定 LayoutParams 的正确父类，则不会显示任何内容。

当您指定布局参数时，您需要使用对象所在容器的类。如果您正在设置进入 LinearLayout 的 textview 的布局参数，`new LinearLayout.LayoutParams(...)`如果您正在创建一个进入 TableRow 的 textview，您将使用类似的方法，您需要使用`TableRow.LayoutParams(...)`

以下是经过少量修改的完整代码，因为我没有数据库设置。

```
 LinearLayout mainLayout = (LinearLayout) findViewById(R.id.edit_cat);

    //Create table layout for the categories        
    TableLayout catList = new TableLayout(this);

    //Set the table layout to Match parent for both width and height
    // Note: We use LinearLayout.LayoutParams because the TableLayout is going inside a LinearLayout

    catList.setLayoutParams(
        new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));

    //Iterate the categories, and organize in tables      
    for(int i = 0; i < 5; i++)
    {
        TableRow tr = new TableRow(this);
        /* Since the table row is going inside a table layout, we specify the parameters using TableLayout.LayoutParams */
        tr.setLayoutParams(new TableLayout.LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.WRAP_CONTENT));

        //Display category name
        TextView name = new TextView(this);

        /* Since the TextView is going inside a TableRow, we use new TableRow.LayoutParams ... */
        name.setLayoutParams(new TableRow.LayoutParams(
                TableRow.LayoutParams.FILL_PARENT,
                TableRow.LayoutParams.WRAP_CONTENT));

        name.setText("Test Row - " + i);
        name.setBackgroundColor(Color.RED);

        //Display category type
        TextView type = new TextView(this);
        type.setText("Type Row - " + i);
        type.setBackgroundColor(Color.GREEN);
        type.setLayoutParams(new TableRow.LayoutParams(
                TableRow.LayoutParams.FILL_PARENT,
                TableRow.LayoutParams.WRAP_CONTENT));

        //Display edit button
        Button btnEdit = new Button(this);
        btnEdit.setText("Edit");

        btnEdit.setLayoutParams(new TableRow.LayoutParams(
                TableRow.LayoutParams.FILL_PARENT,
                TableRow.LayoutParams.WRAP_CONTENT));

        //Display delete button
        Button btnDelete = new Button(this);
        btnDelete.setText("Delete");

        btnDelete.setLayoutParams(new TableRow.LayoutParams(
                 TableRow.LayoutParams.FILL_PARENT,
                 TableRow.LayoutParams.WRAP_CONTENT));

        tr.addView(name);
        tr.addView(type);
        tr.addView(btnEdit);
        tr.addView(btnDelete);

        catList.addView(tr);
    }

    mainLayout.addView(catList); 
```

# haskell - 为什么这不能给出正确的输出？

> ID：10286721
> 
> 赞同：0
> 
> 时间：2012-04-23T19:10:17.033
> 
> 标签：haskell

```
count :: Eq a => a -> [a] -> Int
count _[]                  = 0
count z (x:xs) | z == x    = 1 + (count z xs)
               | otherwise = count z xs

rmdups :: Eq a => [a] -> [a]
rmdups [] = []
rmdups (x:xs) | count x xs > 0 = rmdups xs
              | otherwise     = x: rmdups xs 
```

上面的代码可以编译，但是当我输入`'ababca'`rmdups 的输出时`'bca'`，我希望它是`'abc'`. 为什么a去那里？我一直在更改代码，但不知道为什么会这样。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-23T19:23:26.150

因为您从前面删除了重复项。您可以在继续之前进行修改`rmdups`以过滤掉`xs`，以便从尾部清除重复项：

```
rmdups :: Eq a => [a] -> [a]
rmdups [] = []
rmdups (x:xs)
    | count x xs > 0 = x : (rmdups $ filter (/= x) xs)
    | otherwise      = x : rmdups xs 
```

事实上，你甚至可以在不预先计算的情况下做到这一点：

```
rmdups :: Eq a => [a] -> [a]
rmdups []       = []
rmdups (x : xs) = x : filtered
                where filtered = rmdups $ filter (/= x) xs 
```

当然，在实际代码中，您应该更喜欢已经可用的函数，在这种情况下是[`Data.List.nub`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:nub).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:27:36.140

您的`rmdups`函数会删除每个字符的*最后一次*出现以外的所有字符。

如果要删除每个字符的*第一次*出现以外的所有字符，可以尝试

```
reverse . rmdups . reverse 
```

（即，在使用 rmdups 之前和之后反转），或者您可以重写`rmdups`以跟踪以前出现的所有字符。

# c++ - 使用 boost::random 改组向量时的问题

> ID：10286722
> 
> 赞同：1
> 
> 时间：2012-04-23T19:10:32.663
> 
> 标签：c++, boost, random, probability, boost-random

我正在使用此代码使用 Fisher-Yates 随机化算法的变体生成向量的随机排列（我从第一个元素到最后一个元素，而不是相反）。我在程序启动时`boost::random::mt11213b`播种的程序中全局使用RNG `generator.seed(time(NULL));`，因此这里有一个包装器单例`RandomNumber`。

```
boost::random::uniform_int_distribution<unsigned long> 
    distribution(0, vec.size()-1);

for (unsigned long i=0;i<vec.size();i++)
    std::swap(vec[i], vec[distribution(RandomNumber::getInstance().generator)]); 
```

简而言之，一些实验让我相信这个算法可能存在问题。这就是我所做的

1.  创建了一个长度为 100 的整数向量
2.  前 75 个元素填充`0`，后 25 个元素填充`1`
3.  洗牌一个数组。
4.  从列表中取出前 5 个元素并将它们相加。

我重复这个过程几千次（循环，而不是手动:)）每次都从一个新的向量开始。然后我计算了总和的算术平均值，`0.98`而不是预期的`1.25`。

`1.22`有趣的是，如果我从一个用相同算法而不是有序算法洗牌一次的向量开始，结果会增加结果大约`1.25`是预期值。

我不确定可能出了什么问题。该算法看起来不错，我能想到的唯一可能出错的是播种阶段和

```
boost::random::uniform_int_distribution<unsigned long> 
    distribution(0, vec.size()-1); 
```

在洗牌向量之前每次调用的行（也许它应该只在程序中调用一次，但这没有意义）

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:25:14.427

如果我不得不猜测原因，那么您不会每次都在循环中更改分布大小。计算机编程算法的*艺术就*[在这里](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_modern_algorithm)。

一旦你洗牌到 n 个元素，你就不想再碰第一个 n 了，因为重复应用伪随机数不会让事情变得更随机，它们会让它们变得不那么随机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T19:32:23.153

不，你的算法是错误的。考虑一个包含 4 个数字的向量的简单情况，您的算法会返回以下有偏差的结果

```
result      probability * 256
{1,2,3,4}   10
{1,2,4,3}   10
{1,3,2,4}   10
{1,3,4,2}   14
{1,4,2,3}   11
{1,4,3,2}   9
{2,1,3,4}   10
{2,1,4,3}   15
{2,3,1,4}   14
{2,3,4,1}   14
{2,4,1,3}   11
{2,4,3,1}   11
{3,1,2,4}   11
{3,1,4,2}   11
{3,2,1,4}   9
{3,2,4,1}   11
{3,4,1,2}   11
{3,4,2,1}   10
{4,1,2,3}   8
{4,1,3,2}   9
{4,2,1,3}   9
{4,2,3,1}   8
{4,3,1,2}   10
{4,3,2,1}   10 
```

而标准的[Fisher-Yates 算法](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)将为所有结果提供统一的概率。

If you want to shuffle a vector, use `std::random_shuffle` directly (see [Using boost::random as the RNG for std::random_shuffle](https://stackoverflow.com/questions/147391/using-boostrandom-as-the-rng-for-stdrandom-shuffle) for some example codes).

# java - C++ createFile（紧凑型闪存卡写入器）

> ID：10286723
> 
> 赞同：0
> 
> 时间：2012-04-23T19:10:32.690
> 
> 标签：java, c++, handle, createfile

我对 C++ 很陌生。我正在开发一个 Java 应用程序，该应用程序对 C++ 进行 Jni 调用以将原始文件 (.img) 写入附加的紧凑型闪存卡写入器。下面是我的 c++ 代码，假设找到一个连接的 USB 驱动器，使用 createFile 创建一个句柄并将原始图像 (.img) 写入设备。最终应用程序将使用 Java JNI 调用。

现在遇到的问题是，我能够列出连接的驱动器，但在使用 createFile() 为它们创建句柄时遇到问题。我收到以下错误：

```
Error 1 error C2660: 'getHandleOnVolume' : function does not take 2 arguments   c:\users\omisorem.nov\documents\visual studio 2010\projects\diskrunner\diskrunner.cpp   71  1   DiskRunner
      2 IntelliSense: argument of type "char *" is incompatible with parameter of type "LPCWSTR"    c:\users\omisorem.nov\documents\visual studio 2010\projects\diskrunner\diskrunner.cpp   86  23  DiskRunner 
```

任何帮助表示赞赏。

```
int main() {

// GetLogicalDrives returns 0 on failure, or a bitmask representing
// the drives available on the system (bit 0 = A:, bit 1 = B:, etc)
unsigned long driveMask = GetLogicalDrives();
int i = 0;
ULONG pID;

//cboxDevice->clear();

while (driveMask != 0)
{
    if (driveMask & 1)
    {
        // the "A" in drivename will get incremented by the # of bits
        // we've shifted
        char drivename[] = "\\\\.\\A:\\";
        drivename[4] += i;
        cout << pID << "[%1:\\]" << drivename << endl;
    }
    driveMask >>= 1;
    //      cboxDevice->setCurrentIndex(0);
    ++i;
}
LPCTSTR volumeID = TEXT("D:");

int volumeID1 = int(volumeID);
hVolume = getHandleOnVolume(volumeID1, GENERIC_WRITE);

system("PAUSE");
return 0;
}

HANDLE getHandleOnVolume(int volume1, DWORD access)
{
HANDLE hVolume;

char volumename[] = "\\\\.\\A:";
volumename[4] += volume1;
hVolume = CreateFile("\\\\.\\F", access, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL);
if (hVolume == INVALID_HANDLE_VALUE)
{

    cout <<"Partition does not exist or you don\'t have rights to access it"<<endl; //  tesing 

}
else {
    cout << "Partition exists " << endl;
}

    cout << volume1;
return hVolume;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T18:24:53.920

谢谢你们的投入。我最终想出了如何通过执行以下操作来解决问题：

使用类型 LPCSTR 作为文件名和 hRawDisk

```
 LPCSTR volumename = "\\\\.\\G:";
 LPCSTR filename = "c:\\somedirectory\\someimage.img"; 
```

我创建了单独的函数来创建句柄，它们被调用使用：

```
hVolume = getHandleOnVolume(wszVolume, GENERIC_WRITE);
hFile = getHandleOnFile(filename, GENERIC_READ); 
```

正在为文件和卷使用类似的东西创建句柄。

```
HANDLE getHandleOnFile(LPCTSTR filename, DWORD access){
    HANDLE hFile;
        hFile = CreateFile(filename, access, 0, NULL, (access == GENERIC_READ) ? OPEN_EXISTING:CREATE_ALWAYS, 0, NULL);

        if (hFile == INVALID_HANDLE_VALUE)
        {
            printLastError();
            return 0;

        }
        //delete filelocation;
        //CloseHandle(hFile);
        printf("handle hFile created successfully \n");
        system("PAUSE");
        return hFile;

    } 
```

我对音量重复了同样的操作。之后我调用 DeviceIOControl 来锁定和卸载设备以进行写入。

# jsf - 无法将类 java.util.Date 类型的 4/23/12 上午 12:00 转换为类 java.sql.Date

> ID：10286724
> 
> 赞同：5
> 
> 时间：2012-04-23T19:10:41.800
> 
> 标签：jsf, migration, jsf-1.2, websphere-7, websphere-8

我正在将我的项目从 WebSphere 7 迁移到 WebSphere 8，并且我正在使用 JSF 1.2。

我遇到了 IBM JSF/html_extended 标签和标准转换器的问题，它们主要是 JSF 1.2 核心组件。我还将我的 Java EE 版本从 5 更新到 6（这可能不是原因）。最后，还给出了一个组件树。

下面是我的堆栈跟踪：

```
javax.faces.component.UpdateModelException: org.apache.jasper.el.JspELException: /sc40/NewContract.jsp(130,5) '#{pc_NewContract.overrideAsOfDtSQL}' 无法转换 4/23/12 12:00 AM 类型类 java.util.Date 到类 java.sql.Date
    在 javax.faces.component.UIInput.updateModel(UIInput.java:398)
    在 javax.faces.component.UIInput.processUpdates(UIInput.java:299)
    在 javax.faces.component.UIForm.processUpdates(UIForm.java:187)
    在 javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1258)
    在 javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1258)
    在 javax.faces.component.UIViewRoot._processUpdatesDefault(UIViewRoot.java:1321)
    在 javax.faces.component.UIViewRoot.access$600(UIViewRoot.java:75)
    在 javax.faces.component.UIViewRoot$UpdateModelPhaseProcessor.process(UIViewRoot.java:1423)
    在 javax.faces.component.UIViewRoot._process(UIViewRoot.java:1282)
    在 javax.faces.component.UIViewRoot.processUpdates(UIViewRoot.java:765)
    在 org.apache.myfaces.lifecycle.UpdateModelValuesExecutor.execute（UpdateModelValuesExecutor.java:34）
    在 org.apache.myfaces.lifecycle.LifecycleImpl.executePhase（LifecycleImpl.java:171）
    在 org.apache.myfaces.lifecycle.LifecycleImpl.execute（LifecycleImpl.java:118）
    在 javax.faces.webapp.FacesServlet.service(FacesServlet.java:189)
    在 com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1147)
    在 com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:722)
    在 com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:449)
    在 com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:178)
    在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1020)
    在 com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3639)
    在 com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:304)
    在 com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:950)
    在 com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1659)
    在 com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:195)
    在 com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452)
    在 com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511)
    在 com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305)
    在 com.ibm.ws.http.channel.inbound.impl.HttpICLReadCallback.complete(HttpICLReadCallback.java:83)
    在 com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
    在 com.ibm.io.async.AbstractAsyncFuture.invokeCallback（AbstractAsyncFuture.java:217）
    在 com.ibm.io.async.AsyncChannelFuture.fireCompletionActions（AsyncChannelFuture.java:161）
    在 com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
    在 com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
    在 com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:816)
    在 com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
    在 com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1648)
原因：org.apache.jasper.el.JspELException：/sc40/NewContract.jsp(130,5) '#{pc_NewContract.overrideAsOfDtSQL}' 无法转换 2012 年 4 月 23 日凌晨 12:00 类 java.util。类 java.sql.Date 的日期
    在 org.apache.jasper.el.JspValueExpression.setValue(JspValueExpression.java:98)
    在 javax.faces.component.UIInput.updateModel(UIInput.java:380)
    ... 35 更多

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T16:56:15.387

> '#{pc_NewContract.overrideAsOfDtSQL}' 无法将类 java.util.Date 类型的 4/23/12 上午 12:00 转换为类 java.sql.Date

你显然有一个

```
private java.sql.Date overrideAsOfDtSQL; 
```

这是不正确的。这些`java.sql.*`类型**不**属于模型。将其替换为`java.util.Date`。

```
private java.util.Date overrideAsOfDtSQL; 
```

当您使用`java.sql.Time`.

请注意`java.sql.Date`和`java.sql.Time`是 的子类`java.util.Date`，这就是它在使用 . 从对象转换为字符串时起作用的原因`<f:convertDateTime>`。仅从字符串转换为对象是行不通的，因为`<f:convertDateTime>`总是转换为`java.util.Date`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-01T08:44:22.077

有一种解决方法，无需更改休眠模式。我更喜欢这种方式，因为所有更改都在 jsf 层中。

您可以在复合组件中使用绑定。下一个代码是 Rich:calendar 示例（使用 java.util.Date）

... <cc:interface componentType="CalendarComponent">

... </cc:interface>

```
&lt;cc:implementation&gt; 
```

... <rich:calendar value="#{cc.attrs.value}" binding="#{cc.attrs.calendar}" />

...
</cc：实现>

...

在日历组件中：

```
import java.util.Date;

import javax.faces.component.FacesComponent;
import javax.faces.component.UINamingContainer;
import javax.faces.context.FacesContext;

import org.richfaces.component.UICalendar;

@FacesComponent(value = "CalendarComponent")
public class CalendarComponent extends UINamingContainer {

@Override
public void processUpdates(FacesContext context) {

Object o = calendar.getValue();
   if (o instanceof Date) {
  Date d = (Date) o;
                    //this ensures type changing  
        calendar.setValue(new java.sql.Date(d.getTime()));
}
    super.processUpdates(context);
}

private UICalendar calendar;

public UICalendar getCalendar() {
    return calendar;
}

public void setCalendar(UICalendar calendar) {
    this.calendar = calendar;
}

} 
```

# java - 如何将 Double 参数与 Play 2.0 路由绑定

> ID：10286725
> 
> 赞同：9
> 
> 时间：2012-04-23T19:10:42.833
> 
> 标签：java, parameters, routes, double, playframework-2.0

我正在学习自己的 Play 2.0（使用 Java API）并希望有一个 double/float 参数（用于位置坐标），例如[http://myfooapp.com/events/find?latitude=25.123456&longitude=60.251253](http://myfooapp.com/events/find?latitude=25.123456&longitude=60.251253)。

我可以通过将参数获取为字符串并在控制器等处解析它们来做到这一点，但是我可以在这里使用自动绑定吗？

现在，我首先尝试简单地设置一个 double 值：

```
GET     /events/foo                 controllers.Application.foo(doublevalue: Double) 
```

和

```
public static Result foo(Double doublevalue) {
    return ok(index.render("Foo:" + doublevalue));
} 
```

我得到的是*“没有为 Double 类型找到 QueryString 绑定器。尝试为此类型实现隐式 QueryStringBindable。”*

我是否错过了已经提供的东西，或者我是否必须制作一个解析 Double 的自定义 QueryStringBindable？

[我在http://julien.richard-foy.fr/blog/2012/04/09/how-to-implement-a-custom-pathbindable-with-play](http://julien.richard-foy.fr/blog/2012/04/09/how-to-implement-a-custom-pathbindable-with-play-2/)找到了一些关于使用 Scala 制作自定义字符串查询字符串绑定器的说明[-2/](http://julien.richard-foy.fr/blog/2012/04/09/how-to-implement-a-custom-pathbindable-with-play-2/)

## 我尝试了什么：

我在包活页夹中实现了 DoubleBinder：

```
import java.util.Map;
import play.libs.F.Option;
import play.mvc.QueryStringBindable;

public class DoubleBinder implements QueryStringBindable<Double>{

    @Override
    public Option<Double> bind(String key, Map<String, String[]> data) {
        String[] value = data.get(key);
        if(value == null || value.length == 0) {
            return Option.None();
        } else {
            return Option.Some(Double.parseDouble(value[0]));
        }
    }

    @Override
    public String javascriptUnbind() {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public String unbind(String key) {
        // TODO Auto-generated method stub
        return null;
    }
} 
```

并尝试将其添加到 project/Build.scala 的 main 中：

```
routesImport += "binders._" 
```

但结果相同：“没有为 Double 类型找到 QueryString 活页夹......”

*   我还将路由签名更改为 java.lang.Double 但这也无济于事
*   我还更改了 DoubleBinder 以在路由签名处使用 Double 和 java.lang.Double 来实现 play.api.mvc.QueryStringBindable （而不是 play.mvc.QueryStringBindable），但仍然没有帮助

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T00:42:52.417

目前（在 Play 2.0 中），Java 绑定器仅适用于自递归类型。也就是说，类型如下所示：

```
class Foo extends QueryStringBindable<Foo> {
  …
} 
```

因此，如果要为`java.lang.Double`现有的 Java 类型定义绑定器，则需要将其包装在自递归类型中。例如：

```
package util;

public class DoubleW implements QueryStringBindable<DoubleW> {

    public Double value = null;

    @Override
    public Option<DoubleW> bind(String key, Map<String, String[]> data) {
        String[] vs = data.get(key);
        if (vs != null && vs.length > 0) {
            String v = vs[0];
            value = Double.parseDouble(v);
            return F.Some(this);
        }
        return F.None();
    }

    @Override
    public String unbind(String key) {
        return key + "=" + value;
    }

    @Override
    public String javascriptUnbind() {
         return value.toString();
    }

} 
```

然后您可以在您的应用程序中按如下方式使用它：

```
GET    /foo     controllers.Application.action(d: util.DoubleW) 
```

```
public static Result action(DoubleW d) {
      …
} 
```

# android - Android - 操纵某些可扩展列表的子项的可见性

> ID：10286729
> 
> 赞同：0
> 
> 时间：2012-04-23T19:10:59.683
> 
> 标签：android, listview, visibility, children

在 Android 中，我试图在**getChildView()**函数中操作可扩展列表的一些子行，但下一个代码似乎无法正常工作：

```
@Override
public View getChildView(int groupPosition, int childPosition,
    boolean isLastChild, View convertView, ViewGroup parent) {
        View childRow = inflater.inflate(R.layout.buslinescheduleitem, null);
        if(childPosition%4==0) {
            int k = 0;
            TextView textView;
            while((childPosition+k) < getChildrenCount(groupPosition) && k < 4){
                textView= (TextView) childRow.findViewById(textViewIds[k]);
                textView.setText(getChild(groupPosition, childPosition+k));
                k++;
            }
            childRow.setVisibility(View.VISIBLE);
        }
        else { childRow.setVisibility(View.GONE); }
        return childRow;
} 
```

尽管某些子行已使用 Visibility GONE 进行了修改，并且未显示视图，但 groupView 在不应该显示的地方有其“漏洞”（好像此行将具有具有 INVISIBLE 值的 Visibility）。创建可扩展列表时是否可以隐藏一些子行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:45:41.517

固定的。我只为每四行创建了一行：

```
@Override
public View getChildView(int groupPosition, int childPosition,
    boolean isLastChild, View convertView, ViewGroup parent) {
    View childRow = inflater.inflate(R.layout.buslinescheduleitem, null);
        int k = 0;
        TextView textView;
        while(((childPosition*NUMBER_ROWS)+k) < getChildrenSize(groupPosition) && k < NUMBER_ROWS){
            textView= (TextView) childRow.findViewById(textViewIds[k]);
            textView.setText(getChild(groupPosition, (childPosition*NUMBER_ROWS)+k));
            k++;
        }
        while(k < NUMBER_ROWS){
            textView= (TextView) childRow.findViewById(textViewIds[k]);
            textView.setVisibility(View.GONE);
            k++;
        }
        return childRow;    
}

@Override
public int getChildrenCount(int groupPosition) {
    // TODO Auto-generated method stub
    if(!isInverted) return (int) Math.ceil((float)busLine.getBusScheduleRound().get(groupPosition).getHours().size()/(float)NUMBER_ROWS);
    else return (int) Math.ceil((float)busLine.getBusScheduleReturn().get(groupPosition).getHours().size()/(float)NUMBER_ROWS);
}

public int getChildrenSize(int groupPosition){
    if(!isInverted) return busLine.getBusScheduleRound().get(groupPosition).getHours().size();
    else return busLine.getBusScheduleReturn().get(groupPosition).getHours().size();        
} 
```

尽管如此，我还没有实现修改可见性。

# iphone - 安全 pdf：锁定/不可编辑以防止从 iOS 设备生成后的更改

> ID：10286732
> 
> 赞同：3
> 
> 时间：2012-04-23T19:11:19.067
> 
> 标签：iphone, objective-c, xcode, security, pdf-generation

我正在使用 UIKit 框架在 iOS 设备中生成 pdf。我想知道我们是否可以锁定（提供安全性）生成的 pdf，以便在通过电子邮件发送或下载它之后，不能使用任何 pdf 可编辑工具进行编辑/修改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T22:25:11.960

是的 - 这是可能的。如果您开始使用 UIGraphicsBeginPDFContextToFile 创建 PDF，则可以向其发送带有选项的字典，以指定您想要的加密/锁定类型。这是它的文档：

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIKitFunctionReference/Reference/reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIKitFunctionReference/Reference/reference.html)

这是一个创建它的示例：

```
NSDictionary * pdfInfo = nil;

if (trimmedPassPhrase && [trimmedPassPhrase length] > 0) {
    pdfInfo = [NSDictionary dictionaryWithObjectsAndKeys:trimmedPassPhrase, kCGPDFContextOwnerPassword,
               trimmedPassPhrase, kCGPDFContextUserPassword,
               [NSNumber numberWithInt:128], kCGPDFContextEncryptionKeyLength, nil];
}

BOOL pdfContextSuccess =  UIGraphicsBeginPDFContextToFile(newFilePath, CGRectZero, pdfInfo  ); 
```

# javascript - 恢复模糊后从焦点应用的样式

> ID：10286735
> 
> 赞同：0
> 
> 时间：2012-04-23T19:11:37.290
> 
> 标签：javascript, jquery

当用户关注文本字段时，我希望该文本字段中的文本更改颜色（以及其他几个属性）。当用户离开该字段（模糊）时，我希望文本/样式显示为焦点之前的样子。目前，我正在以似乎重复的方式进行操作。

```
$('#name1').focus(function() {
    $(this).css('color', 'red')
});
$('#name1').blur(function() {
        $(this).css('color', 'black')
}); 
```

我将如何做到这一点：

```
$('#name1').blur(function() {
        $(this).beforeFocus();
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T19:15:34.810

定义一个 css 样式关于它应该如何聚焦并将其移除 onblur。

```
.input_focus {
   color: red;
} 
```

还有剧本，

```
$('#name1').focus(function() {
    $(this).addClass('input_focus')
}).blur(function() {
    $(this).removeClass('input_focus')
}); 
```

这样，您可以在聚焦时添加任意数量的样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:13:44.703

```
$('#name1').focus(function() {
    $(this).addClass('focus');
}).blur(function() {
    $(this).removeClass('focus');
}); 
```

?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T19:18:23.517

理想情况下，我会使用两个不同的 css 类并为这些类定义所有适当的属性。然后它会是这样的：

```
$('#name1').focus(function() {
    $(this).removeClass("blurred").addClass("focused");
}).blur(function() {
    $(this).removeClass("focused").addClass("blurred");
}); 
```

或者，如果您不想这样做，或者不同输入有不同的值，您可以使用`data`.

```
$('#name1').focus(function() {
    var $this = $(this);

    $this.data("oldColor", $this.css("color"))
         .css("color", "blue");

}).blur(function() {
    var $this = $(this);

    $this.css("color", $this.data("oldColor"));
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T19:17:34.090

执行 Vega 的建议，使用`toggleClass()`：

```
$("#name1").focus(function() {
    $(this).toggleClass("inpFocus");
}).blur(function() {
    $(this).toggleClass("inpFocus");
}); 
```

# javascript - 这个论点是如何进入被调用函数的？

> ID：10286736
> 
> 赞同：0
> 
> 时间：2012-04-23T19:11:51.320
> 
> 标签：javascript

代码：

```
function onDeviceReady() {
    window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, gotFS, fail);
}

function gotFS(fileSystem) {
    fileSystem.root.getFile("readme.txt", {create: true, exclusive: false}, gotFileEntry, fail);
} 
```

我不明白的是，当 requestFileSystem 中没有使用 gotFS 传递的参数时，fileSystem 是如何传递的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:15:20.910

对 requestFileSystem 的调用正在接收函数 gotFS 作为参数。gotFS 没有被调用，函数的引用被传入。如果 gotFS 正在被评估，你会在它后面看到括号。（此外，Javascript 中未验证参数，因此您可以使用比预期更少或更多的参数调用函数。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:16:23.500

`gotFS`作为变量（回调）传递。当`requestFileSystem`准备好时，它调用`gotFS`并传递参数。

举个例子：

```
function A(callback){
    callback('hello world');
}

function B(test){
    alert(test);
}

A(B); 
```

`A`已通过`B`。 `A`然后调用`B`，传递`'hello world'`给它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T19:16:41.523

您已将函数指针传递给

```
window.requestFileSystem 
```

在该方法中，他们可以调用并传入他们喜欢的任何对象

即（伪代码）

```
function window.requestFileSystem(localFs, someInt, functionDelegateToCallWithFS, fail)
{
 //blah
 var theFileSystemObject = fromSomwhereElse.get();
 functionDelegateToCallWithFS(theFileSystemObject);
 //blah
} 
```

# ios - 如何在 iOS 上更改设备音量 - 而不是音乐音量

> ID：10286744
> 
> 赞同：15
> 
> 时间：2012-04-23T19:12:18.140
> 
> 标签：ios, iphone, device, volume

我想更改 iOS (iphone) 上的设备音量。

我知道我可以通过以下几行更改音乐库的音量：

```
//implement at first MediaPlayer framework
MPMusicPlayerController *musicPlayer = [MPMusicPlayerController iPodMusicPlayer];
musicPlayer.volume = 1; 
```

但这不是我的目标。
我想改变**设备音量**或让我说**铃声**的音量。

我怎样才能做到这一点？只是改变**设备**音量？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-03-02T16:02:32.793

回答brush51的问题：

> 我怎样才能做到这一点？只是改变设备音量？

正如 0x7fffffff 建议的那样：

> 您不能以编程方式更改设备音量，但是 MPVolumeView（音量滑块）可以更改设备音量，但只能通过用户交互。

所以，苹果推荐使用`MPVolumeView`，所以我想出了这个：

添加`volumeSlider`属性：

```
@property (nonatomic, strong) UISlider *volumeSlider; 
```

初始化`MPVolumeView`并添加到您的视图的某个位置（可以隐藏，没有框架，或者因为`showsRouteButton = NO`and为空`showsVolumeSlider = NO`）：

```
MPVolumeView *volumeView = [MPVolumeView new];
volumeView.showsRouteButton = NO;
volumeView.showsVolumeSlider = NO;
[self.view addSubview:volumeView]; 
```

查找并保存参考`UISlider`：

```
__weak __typeof(self)weakSelf = self;
[[volumeView subviews] enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    if ([obj isKindOfClass:[UISlider class]]) {
        __strong __typeof(weakSelf)strongSelf = weakSelf;
        strongSelf.volumeSlider = obj;
        *stop = YES;
    }
}]; 
```

添加目标操作`UIControlEventValueChanged`：

```
[self.volumeSlider addTarget:self action:@selector(handleVolumeChanged:) forControlEvents:UIControlEventValueChanged]; 
```

然后检测音量变化（即通过硬件音量控制）：

```
- (void)handleVolumeChanged:(id)sender
{
    NSLog(@"%s - %f", __PRETTY_FUNCTION__, self.volumeSlider.value);
} 
```

以及其他方式，您可以通过以下方式设置音量：

```
self.volumeSlider.value = < some value between 0.0f and 1.0f >; 
```

希望这会有所帮助（并且 Apple 不会从 MPVolumeView 中删除 MPVolumeSlider）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-07-27T09:17:32.373

这是我所做的：

```
func setSystemVolume(volume: Float) {
    let volumeView = MPVolumeView()

    for view in volumeView.subviews {
        if (NSStringFromClass(view.classForCoder) == "MPVolumeSlider") {
            let slider = view as! UISlider
            slider.setValue(volume, animated: false)
        }
    }
} 
```

由于属性`volume`in`MPMusicPlayerController`在 iOS 7 中已弃用。这是您可以做到的唯一方法。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-03-04T23:13:12.323

这个（Swift）解决方案对我很有用： [http ://weimenglee.blogspot.com/2015/07/ios-tip-programmatically-adjust-device.html](http://weimenglee.blogspot.com/2015/07/ios-tip-programmatically-adjust-device.html)

```
import MediaPlayer

let volumeView = MPVolumeView()
if let view = volumeView.subviews.first as? UISlider{
    view.value = 0.1 //---0 t0 1.0---

} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-23T12:38:16.883

您必须使用 applicationMusicPlayer 而不是 iPodMusicPlayer 来设置系统音量：

```
#import <MediaPlayer/MediaPlayer.h>
musicPlayer = [MPMusicPlayerController applicationMusicPlayer];
musicPlayer.volume = 1; // max volume
musicPlayer.volume = 0; // min volume (mute)
musicPlayer.volume = 0.0625; // 1 bar on the overlay volume display 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-08-14T21:47:29.467

这是一个小包装类，可以设置系统音量并通知您任何更改（将您自己的更改响应程序传递给 setTarget:action:)。

**编辑**：如果您隐藏 MPVolumeView 控件或不将其添加为子视图，则系统将在您以编程方式更改音量时在屏幕中间显示默认音量方块。如果您不喜欢系统所做的事情，解决方案是在屏幕外设置视图坐标。我在下面编辑了我的代码以反映这一点。

```
@import MediaPlayer;

@interface SysVolumeControl : MPVolumeView
@property (nonatomic) float value; // from 0 to 1.0
- (void)setTarget:(id)target action:(SEL)action;
@end

@implementation SysVolumeControl
{
    UISlider* _slider;
}

- (id)init
{
    if (self = [super initWithFrame:CGRectMake(-300, 0, 200, 50)])
    {
        for (UIView* view in self.subviews)
        {
            if ([view isKindOfClass:UISlider.class])
            {
                _slider = (UISlider*)view;
                break;
            }
        }
    }
    return self;
}

- (float)value
    { return _slider.value; }

- (void)setValue:(float)value
    { _slider.value = value; }

- (void)setTarget:(id)target action:(SEL)action
    { [_slider addTarget:target action:action forControlEvents:UIControlEventValueChanged]; }

@end 
```

然后创建一个实例并使用它：

```
SysVolumeControl* sysVolumeControl = [SysVolumeControl new];
[myView addSubview:sysVolumeControl];
sysVolumeControl.value = 1.0;
[sysVolumeControl setTarget:self action:@selector(mySysVolumeResponder:)]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-05-13T21:40:25.530

该应用程序不应更改设备全局设置，您也不应这样做。用户可以使用标准 iOS 功能做到这一点。相反，如果您播放声音/视频，请使用播放器`volume`：

```
var player: AVPlayer!
...
player.volume = 0.5 // 50% level 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-06-05T17:59:09.700

即时创建 MPVolumeView 以获取滑块并设置音量在 iOS 11.4 中不再起作用。我通过将新的 MPVolumeView 添加到我的 UIViewController 视图解决了这个问题，否则它没有设置音量。当我将它添加到控制器时，我还需要将音量视图位置设置在屏幕之外。

代码在 Swift 4 中：

```
let volumeControl = MPVolumeView(frame: CGRect(x: 0, y: 0, width: 120, height: 120))

override func viewDidLoad() {
   self.view.addSubview(volumeControl);
}

override func viewDidLayoutSubviews() {
   volumeControl.frame = CGRect(x: -120, y: -120, width: 100, height: 100);
}

func setMaxVolume() {
    let lst = volumeControl.subviews.filter{NSStringFromClass($0.classForCoder) == "MPVolumeSlider"}
    let slider = lst.first as? UISlider

    slider?.setValue(1, animated: false)
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-24T14:44:39.580

打电话给`listenVolumeButton`您并用您想做的任何事情`viewDidLoad`替换该行。`//`

```
private func listenVolumeButton() {
    let audioSession = AVAudioSession.sharedInstance()
    try? audioSession.setActive(true)
    audioSession.addObserver(self,
                             forKeyPath: "outputVolume",
                             options: NSKeyValueObservingOptions.new,
                             context: nil)

    hideVolumeView()
}

private func hideVolumeView() {
    let volumeView = MPVolumeView(frame: CGRect.zero)
    for subview in volumeView.subviews {
        if let button = subview as? UIButton {
            button.setImage(nil, for: .normal)
            button.isEnabled = false
            button.sizeToFit()
        }
    }
    UIApplication.shared.windows.first?.addSubview(volumeView)
    UIApplication.shared.windows.first?.sendSubviewToBack(volumeView)
}

override func observeValue(forKeyPath keyPath: String?, of object: Any?, change: [NSKeyValueChangeKey: Any]?, context: UnsafeMutableRawPointer?) {
    switch keyPath {
    case "outputVolume":
        guard let systemSlider = MPVolumeView().subviews.first(where: { NSStringFromClass($0.classForCoder) == "MPVolumeSlider" }) as? UISlider else {
            return
        }

        let avoidLimitsValue = max(min(AVAudioSession.sharedInstance().outputVolume, Float(0.9)), Float(0.1))

        DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 0.01) {
            systemSlider.setValue(avoidLimitsValue, animated: false)
        }

        // DO YOUR STUFF HERE
    default:
        break
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-27T12:01:27.350

**斯威夫特 3** - 我用这个：

```
func setVolumeTo(volume: Float) {
  (MPVolumeView().subviews.filter{NSStringFromClass($0.classForCoder) == "MPVolumeSlider"}.first as? UISlider)?.setValue(volume, animated: false)
} 
```

# objective-c - 窗口、视图和子视图创建 - mac os x

> ID：10286747
> 
> 赞同：0
> 
> 时间：2012-04-23T19:12:25.100
> 
> 标签：objective-c, macos, model-view-controller

我是一个 Objective-C/Cocoa 新手，我想知道你是否可以为我提供一些关于我正在编写的第一个 Mac OS X 桌面应用程序的指导。

模型部分是自组织映射算法 SOM (Kohonen, 1982)。

从界面的角度来看，这个想法是有一个包含 1024x768 父视图和 192 个 64x64 方块（子视图）的主窗口。子视图的颜色会随着 SOM 算法的运行而改变。构建 SOM 后，用户将能够通过单击某个方格来收听映射到某个方格的声音。

SOM 算法已经实现，但我很难创建接口并将其连接到模型部分。

我想通过使用下面的代码来创建窗口：

```
NSRect windowRect = NSMakeRect(0.0f, 0.0f, 1024.0f, 790.0f);

NSWindow *window = [[NSWindow alloc] initWithContentRect:windowRect 
                                               styleMask:( NSResizableWindowMask |         NSClosableWindowMask | NSTitledWindowMask) 
                                                 backing:NSBackingStoreBuffered defer:NO];

[window setBackgroundColor:[NSColor blueColor]];    

[window makeKeyAndOrderFront:nil]; 
```

然后我将创建主视图添加主视图作为我的窗口内容视图的子视图：

```
 NSView *view = [[NSView alloc] init]; 

 [window setContentView: view] 
```

最后，我将创建子视图并将它们添加为父视图的子视图：

```
 for(int i=0;i<12;i++)
 {
    for(int j=0;j<16;j++)
    {
       NSView *child = [[NSView alloc]initWithFrame:CGRectMake(64*i,64*j,64, 64)];
       [view addSubview:child];
    }
 } 
```

我的问题是：

1）我的想法有意义吗？

2）这些代码应该去哪里？我仍然怀疑它们应该是 AppDelegate 还是 ViewController 的一部分？

3）加载界面需要在main方法中添加什么？目前 main 方法只调用涉及音频处理和 SOM 算法的方法。我想这里的一般问题是如何连接模型和视图部分。

对于这些幼稚的问题，我深表歉意，并提前感谢您提出任何有助于我取得进展的想法。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:59:32.733

可可视图有点贵。Apple 不鼓励大量使用它们。192正在推动它。此外，如果视图只是彩色矩形，则为此使用整个视图对象毫无意义。只需定义一个在其中绘制彩色方块并处理点击的自定义视图。

此外，您无需分配标准`NSView`并将其设置为窗口的内容视图。该窗口以标准`NSView`作为内容视图开始。您通常仅在以下情况下设置内容视图：a）它不是标准的`NSView`（某种子类）或b）它已经设置了子视图的层次结构并且您想要将其交换。

关于您的问题 3，我想说您需要遵循 Cocoa 应用程序的标准设计。该`main()`函数应遵循新 Cocoa 应用程序项目提供的模板。它通常应该只调用`NSApplicationMain()`. 然后，添加自定义代码的好地方是`-applicationDidFinishLaunching:`应用程序委托的方法。（我不知道您是否认为您的应用程序是基于文档的。如果是这样，那么设计会有所不同。您将定义您的文档类和文档窗口，框架将负责打开一个新的在启动时。）

# c# - 使用 lambda 函数从旧列表创建新列表

> ID：10286749
> 
> 赞同：3
> 
> 时间：2012-04-23T19:12:31.863
> 
> 标签：c#, list, lambda

我有以下内容：`List<InputRow>`其中包含许多 InputRow 对象。

我想知道是否有一种方法可以让我在原始列表上使用 lambda 函数来为我提供一个新列表，`InputRow.someProperty > 1`用于所有对象。

这会给我留下一个 InputRow 对象的列表，它们的 someProperty 都大于 1。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T19:15:45.260

你当然也可以这样做：

```
var list = new List<string>(){ "a", "b", "c" };

list.RemoveAll(s => s == "b"); 
```

它删除了原处的项目，而不是创建一个新列表。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-23T19:13:36.623

您可以使用 LINQ（[`.Where()`](http://msdn.microsoft.com/en-us/library/bb534803.aspx)和[.ToList()](http://msdn.microsoft.com/en-us/library/bb342261.aspx)扩展方法的结合）：

```
List<InputRow> originalList = ...
List<InputRow> filteredList = originalList
    .Where(x => x.someProperty > 1)
    .ToList(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T19:13:58.680

当然。你可以这样做：

```
var newList = inputRowList.Where(inputRow => inputRow.someProperty > 1).ToList(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-23T19:13:52.057

```
List<InputRow> newlist = oldlist.Where(x => x.someProperty > 1).ToList(); 
```

这将在条件下搜索您的旧列表`someProperty > 1`并将结果转换为 List 使用`.ToList()`

# c++ - 将数组写入 IStream

> ID：10286750
> 
> 赞同：0
> 
> 时间：2012-04-23T19:12:33.333
> 
> 标签：c++, windows, xmllite

我收到一些数据作为 char 数组。我想将此数据传递给接收流的方法（IUnknown *pInput）。

我试图调试这段代码（使用Visual C++）：

* * *

```
#include "xmllite.h"
#include <atlbase.h> 
```

* * *

```
CHAR acTemp [100] = {0};
CComPtr<IStream> pDataStream;
HRESULT hr;

hr = IStream_Write (pDataStream, acTemp, sizeof (acTemp)); 
```

我得到错误：

SSL.exe 中 0x75e49875 处的未处理异常：0xC0000005：访问冲突读取位置 0x00000000。

我知道以下从文件创建 strem 的代码将起作用，但我不想仅仅因为我无法从原始数组转换而创建文件。

```
CComPtr<IStream> pFileStream;
LPCSTR szFileName = "FileName";
HRESULT hr;

hr = SHCreateStreamOnFile(szFileName, STGM_READ, &pFileStream); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:21:38.663

你可以做

```
CComPtr<IStream> stream;
COM_VERIFY(::CreateStreamOnHGlobal(0, TRUE, &stream)); 
```

也可以使用 GlobalAlloc 来指定要使用的“自己的”内存。（如果您的德语很好 - 请参阅[http://msdn.microsoft.com/de-de/magazine/cc163436.aspx#S5](http://msdn.microsoft.com/de-de/magazine/cc163436.aspx#S5)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T11:37:44.400

为了具体回答这个问题，片段是：

```
CHAR *acTemp;
acTemp = (CHAR *) GlobalAlloc (GMEM_FIXED, dwBytes);
memcpy (acTemp, acXml, dwBytes);
hr = ::CreateStreamOnHGlobal(acTemp, TRUE, &pDataStream); 
```

在这种情况下，acXml 是包含要放入流中的数据的 char 数组。

我不知道为什么前一个不起作用，但到目前为止这个工作正常。感谢@Matthias 的帮助！

# java - 使用 Java 中的菜单项在标准计算器和科学计算器之间更改表格

> ID：10286754
> 
> 赞同：2
> 
> 时间：2012-04-23T19:12:54.033
> 
> 标签：java, swing, calculator

我有一个标准计算器和一个用java创建的科学计算器，都有菜单栏和菜单项“标准”和“科学”在两者之间切换，但我不知道如何让计算器在单击选项。

到目前为止的代码：

```
import java.awt.FlowLayout;
import javax.swing.*;

import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

public class regCalc implements ActionListener 
{    
    JFrame frame = new JFrame ("Standard Calculator");

    //JPanels for standard and scientific
    JPanel panelstand = new JPanel (new FlowLayout ()); 
    JPanel panelsci = new JPanel (new FlowLayout());

    JMenuBar menuBar = new JMenuBar();

    JMenu view = new JMenu ("View");
    JMenuItem standard = new JMenuItem("Standard");
    JMenuItem scientific = new JMenuItem("Scientific");

    JTextArea text = new JTextArea (1,20);

    JButton but1 = new JButton ("1");
    JButton but2 = new JButton ("2");
    JButton but3 = new JButton ("3");
    JButton but4 = new JButton ("4");
    JButton but5 = new JButton ("5");
    JButton but6 = new JButton ("6");
    JButton but7 = new JButton ("7");
    JButton but8 = new JButton ("8");
    JButton but9 = new JButton ("9");
    JButton but0 = new JButton ("0");

    JButton butAdd = new JButton ("+");
    JButton butSub = new JButton ("-");
    JButton butMult = new JButton ("*");
    JButton butDiv = new JButton ("/");
    JButton butEq = new JButton ("=");
    JButton butClear = new JButton ("C");

    Double number1, number2, result;
    int addc =0, subc=0, multc=0, divc=0;

    public void ui()
    {
    frame.setVisible(true);

    panelstand.setVisible(true);
    panelsci.setVisible(false);

    frame.setSize(270,230);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    frame.setJMenuBar(menuBar);
    view.add(standard);
    view.add(scientific);
    menuBar.add(view);

    frame.add(panelstand);

    panelstand.add(text);

    panelstand.add(but1);
    panelstand.add(but2);
    panelstand.add(but3);
    panelstand.add(but4);
    panelstand.add(but5);
    panelstand.add(but6);
    panelstand.add(but7);
    panelstand.add(but8);
    panelstand.add(but9);
    panelstand.add(but0);

    panelstand.add(butAdd);
    panelstand.add(butSub);
    panelstand.add(butMult);
    panelstand.add(butDiv);
    panelstand.add(butEq);
    panelstand.add(butClear);

    but1.addActionListener(this);
    but2.addActionListener(this);
    but3.addActionListener(this);
    but4.addActionListener(this);
    but5.addActionListener(this);
    but6.addActionListener(this);
    but7.addActionListener(this);
    but8.addActionListener(this);
    but9.addActionListener(this);
    but0.addActionListener(this);

    butAdd.addActionListener(this);
    butSub.addActionListener(this);
    butMult.addActionListener(this);
    butDiv.addActionListener(this);
    butEq.addActionListener(this);
    butClear.addActionListener(this);   
}

    @Override
    public void actionPerformed(ActionEvent e) {

        Object source = e.getSource();

    if (source == but1)
    {
        text.append("1");
    }

    if (source == but2)
    {
        text.append("2");
    }

    if (source == but3)
    {
        text.append("3");
    }

    if (source == but4)
    {
        text.append("4");
    }

    if (source == but5)
    {
        text.append("5");
    }

    if (source == but6)
    {
        text.append("6");
    }

    if (source == but7)
    {
        text.append("7");
    }

    if (source == but8)
    {
        text.append("8");
    }

    if (source == but9)
    {
        text.append("9");
    }

    if (source == but0)
    {
        text.append("0");
    }

    if (source == butAdd)
    {
        number1=number_Reader();
        text.setText("");
        addc=1;
        subc=0;
        multc=0;
        divc=0;
    }

    if (source == butSub)
    {
        number1=number_Reader();
        text.setText("");
        addc=0;
        subc=1;
        multc=0;
        divc=0;
    }

    if (source == butMult)
    {
        number1=number_Reader();
        text.setText("");
        addc=0;
        subc=0;
        multc=1;
        divc=0;
    }

    if (source == butDiv)
    {
        number1=number_Reader();
        text.setText("");
        addc=0;
        subc=0;
        multc=0;
        divc=1;
    }

    if (source == butEq)
    {
        number2=number_Reader();
        if (addc > 0)
        {
            result = number1+number2;
            text.setText(Double.toString(result));
        }

        if (subc > 0)
        {
            result = number1-number2;
            text.setText(Double.toString(result));
        }

        if (multc > 0)
        {
            result = number1*number2;
            text.setText(Double.toString(result));
        }

        if (divc > 0)
        {
            result = number1/number2;
            text.setText(Double.toString(result));
        }
    }

    if (source == butClear)
    {
        number1=0.0;
        number2=0.0;
        text.setText("");
    }

    if (view == scientific)
    {
        frame.add(scientific);
    }

}

    public double number_Reader()
    {
        double num1;
        String s;
        s=text.getText();
        num1=Double.valueOf(s);
        return num1;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:14:49.753

您可能会追求诸如[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)之类的东西，它使您能够使用布局在两个面板之间切换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T21:37:38.997

实际上，虽然我是 CardLayout 的大力推动者，但我希望您考虑另一种选择。如果您考虑这个问题，您会发现（至少在我看来）您不想在切换计算器类型时完全*更改*视图，而是希望增加或减少视图，因为标准计算器实际上只是科学计算器的一个子集。因此，如果需要科学计算器，您可以简单地显示一个带有科学按钮的附加 JPanel，并在需要标准计算器时隐藏 JPanel。这可以通过将 JPanel 添加到适当的布局来完成，例如 BorderLayout 与标准 JPanel 添加 BorderLayout.CENTER 和科学 JPanel BorderLayout.PAGE_END，然后调用`setVisible(true)`或在科学 JPanel 上为假。确保调用`repaint()`包含科学计算器的 JPanel。

# mysql - 追随者系统的逻辑是什么？

> ID：10286758
> 
> 赞同：6
> 
> 时间：2012-04-23T19:13:06.363
> 
> 标签：mysql, database-design, twitter

我正在做一些项目，我正在考虑像 twitter 这样的追随者和追随系统。我在数据库上有成员表。我怎么能做追随者系统。逻辑是什么？我做了类似的事情：我创建了一个新表名称如下，我有 3 行。这些行是 id、user_id、follower_id。这对我来说足够了吗？我不知道如何做这个系统？你能帮助我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:19:57.753

“跟随”（或“被跟随”）是您的表反映的两个用户实体之间的关系。

这意味着除非您打算将同一用户之间的多个关注和取消关注视为单独的条目，否则您甚至不需要`id`.

使用 a进行`user_id`和`follower_id`引用，使它们成为复合主键并在其上创建索引（以快速获取用户列表）：`user``FOREIGN KEY``follower_id`

```
CREATE TABLE
        follows
        (
        user_id INT NOT NULL REFERENCES user (id),
        follower_id INT NOT NULL REFERENCES user (id),
        PRIMARY KEY
                (user_id, follower_id)
        KEY follower_id (follower_id)
        )
ENGINE=InnoDB -- if you want the foreign keys to work 
```

您也可以添加其他属性。

如果要跟踪同一用户之间的关注和取消关注，则需要将其提升为实体，添加代理主键：

```
CREATE TABLE
        follows
        (
        id INT NOT NULL PRIMARY KEY,
        user_id INT NOT NULL REFERENCES user (id),
        follower_id INT NOT NULL REFERENCES user (id),

        -- These are additional attributes

        follows_from DATETIME NOT NULL,
        follows_till DATETIME,

        --

        KEY follower_id (follower_id),
        KEY user_id (user_id)
        )
ENGINE=InnoDB -- if you want the foreign keys to work 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-23T19:21:35.107

是的，这种设计对于 Twitter 等简单的追随系统来说已经足够了。当然，一些额外的数据（例如@Ina 建议的时间戳）可能很有用，您并不严格需要`id`它。

我会推荐类似的东西：

```
userID INT PRIMARY,
followID INT PRIMARY,
creationTime DATETIME 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-20T00:14:37.450

假设您已经有一个用户登录的站点，您需要在数据库中添加一个包含两列的表，“friend1”和“friend2”（假设友谊是双向关系）或“领导者”和“追随者” （对于订阅的单向关系）。然后，您需要一个简短的 PHP 脚本，它将friend1 和friend2 作为输入（例如，作为POST 或GET 变量）并将该对输入到数据库中。最后，在您的网站上添加一个按钮，该按钮可以对该 PHP 脚本进行 AJAX 调用，或者作为目标是该 PHP 脚本的 HTML 表单的一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T19:18:35.727

假设您有一个 的实体，您需要创建一个从到`People`的多对多关系。在您的关联表中，您将有两列，并且. `People``People``PeopleID``Following`

`Following`要查找用户的关注者，请在列中搜索该用户的 ID 。要列出用户正在关注的人，请在`PeopleID`列中搜索。

# html - Html css 缩放将大小更改几个像素

> ID：10286767
> 
> 赞同：2
> 
> 时间：2012-04-23T19:13:55.717
> 
> 标签：html, css, google-chrome

在这个 HTML 页面 [http://www2.outofscopes.com/biz/index.html](http://www2.outofscopes.com/biz/index.html)

我需要使标题与画廊具有相同的宽度和垂直位置。

但是当放大和缩小（在 chrome 中）时，标题会溢出，或者图像会溢出，甚至会向下一行。发生这种情况是因为有几个像素发生了变化。

我该如何解决？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-23T19:20:52.870

给它一个固定的宽度？例如 960px

# http - 日志页面加载时间

> ID：10286768
> 
> 赞同：0
> 
> 时间：2012-04-23T19:13:56.287
> 
> 标签：http, logging, browser

好的，例如，在 Firefox firebug 插件中，有一个“网络”选项卡，显示页面上请求的所有内容（所有图像、js 文件等）。请求域是什么，以及请求需要多长时间/receive a response（“时间线”）。

我知道其他插件以类似的方式显示此信息（例如：httpfox、篡改数据、chrome 的 js 控制台等。）在其中任何一个中，我可以突出显示和 c/p 或者我可以右键单击 c/p 但我不能似乎找到任何可以让我将所有数据行导出到文本或 csv 文件的东西......有人有任何建议的插件或程序来记录这些东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:22:18.923

Chrome/Firebug 支持将数据导出到 HAR（HTTP 存档文件）。然后您可以自己解析它或使用在线查看器，例如[http://www.softwareishard.com/har/viewer/](http://www.softwareishard.com/har/viewer/)，将它与 Page Speed [SDK](http://code.google.com/p/page-speed/)等一起使用。

您还可以使用 HarLog 将 HAR 数据导出到制表符分隔的文件：[http ://www.imagossoftware.com/harlog/](http://www.imagossoftware.com/harlog/)

# php - 使用 mod_proxy 重定向到 https 子域？

> ID：10286772
> 
> 赞同：0
> 
> 时间：2012-04-23T19:14:11.850
> 
> 标签：php, regex, .htaccess, mod-rewrite, mod-proxy

这是我之前[问过](https://stackoverflow.com/questions/10234930/re-directing-a-website-to-a-specific-folder-and-https)的问题，建议使用 mod_proxy 的解决方案，但不幸的是，即使这样我也无法正常工作:(

我想从常规链接重定向到 https 子域，例如[https://photofileltd.co.uk/index.php?page=services](https://photofileltd.co.uk/index.php?page=services)将显示[https://secure.photofileltd.co.uk /new_site/index.php?page=services](https://secure.photofileltd.co.uk/new_site/index.php?page=services) - 但保留 URL！

这是我的 .htaccess 文件，我添加了“P”来加载代理，但我只收到 500 内部服务器错误：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://secure.photofileltd.co.uk/new_site/$1 [L, P] 
```

任何帮助或建议将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:37:56.437

如果您找不到日志文件，您将不得不联系网络主机，以找出他们将它们保存在哪里。

但是，我会说你不应该需要`mod_proxy`，我认为你想要做的是：

```
# Set options
Options +FollowSymLinks -MultiViews

# Redirect insecure requests to HTTPS
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://secure.photofileltd.co.uk/new_site/$1 [L,QSA,R=301] 
```

# php - Zend gData 检查文件夹是否存在（Google Docs）

> ID：10286774
> 
> 赞同：0
> 
> 时间：2012-04-23T19:14:29.837
> 
> 标签：php, zend-framework, google-docs, gdata

我有这个代码来创建一个文件夹，在创建它之前我想检查这个文件夹是否已经存在！

```
$service = Zend_Gdata_Docs::AUTH_SERVICE_NAME;
$client = Zend_Gdata_AuthSub::getHttpClient($_SESSION['cal_token']);
$docs = new Zend_Gdata_Docs($client);
$docs->createFolder('My Folder'); 
```

我想要类似的东西

```
if($docs->isFolder('My Folder')) {
  //do something
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:16:43.690

Google Docs 中的文件夹由具有 scheme`http://schemas.google.com/g/2005#kind`和 term的类别标识`http://schemas.google.com/docs/2007#folder`：

```
<category scheme="http://schemas.google.com/g/2005#kind"
          term="http://schemas.google.com/docs/2007#folder"/> 
```

`getCategory()`您可以通过调用列出其所有类别并查找与上述类似的类别来检查条目是否为文件夹。

# uitableview - 无法在 UITableView 中增加 UIScrollView contentSize

> ID：10286775
> 
> 赞同：0
> 
> 时间：2012-04-23T19:14:35.547
> 
> 标签：uitableview, uiscrollview, contentsize

我的代码以编程方式创建了一个基本的 UITableView 基类。

```
@interface BaseTableViewController : UIViewController <UITableViewDataSource, UITableViewDelegate> {
UITableView *tableView;
UITableViewStyle tableViewStyle;
} 
```

loadView 方法设置 tableView 的基本属性

```
- (void)loadView
{
[super loadView];
tableView = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, 338) style:tableViewStyle];
tableView.dataSource = self;
tableView.delegate = self;

UINavigationBar *navBar = self.navigationController.navigationBar;
navBar.barStyle = [UIUtils barStyle];
navBar.tintColor = [UIUtils tintColor];

if (tableViewStyle == UITableViewStyleGrouped) tableView.backgroundColor = [UIUtils tableBGColor];

[self.view addSubview:tableView];
} 
```

然后我将这个基类子类化，因为我想将特定内容添加到表中。显示内容，我可以滚动 tableview 以查看视图中的所有内容。之后我决定将 tableView 高度增加 35。在子类中我重写 loadView 方法并添加

```
- (void)loadView
{
[super loadView];
self.tableView.frame = CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height + 35);
} 
```

调整 tableView 框架高度后，我无法再滚动所需的数量以查看所有表格内容。如果我点击表格并拖动它，内容将进入视图，但当我释放它时，内容会从视图中弹回并看不见。我查看了其他几篇帖子，解决方案似乎是增加 tableView 的 contentSize （它的 UIScrollView 基类）。我在 loadView 和 viewDidLoad 方法中都试过了，但没有效果。

```
self.tableView.contentSize = CGSizeMake(self.tableView.contentSize.width, self.tableView.contentSize.height + 35); 
```

我之前遇到过类似的问题，但 tableView 在 Xib 文件中。我最终只是手动增加了 IB 中滚动视图的高度，但现在这不是我的选择。有什么明显的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:50:24.773

我解决了这个问题但是有点茫然为什么下面的代码是修复？我正在增加 tableview 大小但不是视图大小。增加两者，然后能够滚动表格中的所有内容。

```
- (void)loadView
{
[super loadView];

// increase the size of the view and tableview by height of the statusbar frame which was removed...
self.view.frame = CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height + 35);
self.tableView.frame = CGRectMake(0, 0, self.tableView.frame.size.width, self.tableView.frame.size.height + 35); 
```

}

# javascript - 排序不适用于 jqGrid

> ID：10286779
> 
> 赞同：4
> 
> 时间：2012-04-23T19:14:49.770
> 
> 标签：javascript, jquery, jqgrid

我在让 jqGrid 排序时遇到问题。我希望在客户端上进行这种排序，但我也愿意对数据库进行新的调用以获取排序结果。

我可以单击列标题和排序箭头改变方向，但数据根本没有改变。

我已经查看了[这个问题](https://stackoverflow.com/questions/2131280/jqgrid-sorting-on-client-side/2136367)，但是调用 reloadGrid 似乎没有帮助。

我的整个网格如下：

```
var x = $("#grid").jqGrid({
    jsonReader: { root: "rows", repeatitems: false },
    datatype: "json",
    height: 'auto',
    autowidth: true,
    forceFit: true,
    colNames:['ID','Name'],
    colModel:[
        {name:'id', key:true, index:'id', width:60, sorttype:"int", jsonmap:"id"},
        {name:'name', index:'name', width:90,  jsonmap: "name"}
    ],
    caption: "Results",
    loadonce: true,
    sortable: true,
    loadComplete: function() {
        jQuery("#grid").trigger("reloadGrid"); // Call to fix client-side sorting
    }
});

//This data comes from a web service call, hard coding in to test
var jsonData = [
    {id: 1, name: 'Apple'},
    {id: 2, name: 'Banana'},
    {id: 3, name: 'Pear'},
    {id: 4, name: 'Orange'}
];

x[0].addJSONData( { rows: jsonData } ); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T19:56:27.133

如果您从服务器加载未排序的数据，并且**一旦**您不应该放置`jQuery("#grid").trigger("reloadGrid");`在`loadComplete`. *每次*对本地数据进行排序或分页时`loadComplete`都会调用回调。此外，最好调用inside of 。在这种情况下，网格的第一次完整加载将在重新加载之前完成。*`jQuery("#grid").trigger("reloadGrid");``setTimeout`*

 *我没有测试，但我想正确的代码`loadComplete`可能是以下

```
loadComplete: function () {
    var $this = $(this);
    if ($this.jqGrid('getGridParam', 'datatype') === 'json') {
        if ($this.jqGrid('getGridParam', 'sortname') !== '') {
            // we need reload grid only if we use sortname parameter,
            // but the server return unsorted data
            setTimeout(function () {
                $this.triggerHandler('reloadGrid');
            }, 50);
        }
    }
} 
```

在这种情况下，`reloadGrid`将仅在从服务器首次加载网格时调用一次。在下一次看涨期权的价值`datatype`将已经是`'local'`。

**更新：** [免费 jqGrid](https://github.com/free-jqgrid/jqGrid)是 jqGrid 的分支，我从 2014 年底开始开发。它有许多新功能。在 jqGrid 中显示当前页面数据*之前*，可以使用该选项`forceClientSorting: true`在客户端强制对数据进行排序和过滤。因此，可以添加选项并删除旧答案中描述的技巧。*`forceClientSorting: true`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:20:20.640

找到了一个解决方案，但不完全确定为什么会这样。也许有人可以提供更好的答案。

```
var x = $("#grid").jqGrid({
    jsonReader: { root: "rows", repeatitems: false },
    datatype: "json",
    height: 'auto',
    autowidth: true,
    forceFit: true,
    colNames:['ID','Name'],
    colModel:[
        {name:'id', key:true, index:'id', width:60, sorttype:"int", jsonmap:"id"},
        {name:'name', index:'name', width:90,  jsonmap: "name"}
    ],
    caption: "Results",

    //Required for client side sorting
    loadonce: true,
    gridComplete: function(){ 
      $("#grid").setGridParam({datatype: 'local'}); 
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-20T17:49:10.347

`loadonce`仅适用于预定义的加载器。如果您使用数据类型作为函数，您应该`datatype:local`在第一次使用自定义函数加载网格后手动设置。

尝试这样的事情：

```
datatype : function (){
    $.ajax({
    …
    complete :function (…){
                …
                $("#mygrid").setGridParam({datatype:'local'});
        }
    })
}, 
```**

# jquery - 带有 WCF 数据服务 (OData) 的 JQGrid；在编辑模式下未调用 loadBeforeSend；不能做 setRequestHeader

> ID：10286780
> 
> 赞同：4
> 
> 时间：2012-04-23T19:14:54.297
> 
> 标签：jquery, jqgrid, wcf-data-services, odata4j

我对这个出色的 jqgrid 插件以及我尝试将它与 WCF 数据服务（不是真的，但非常相似的 odata4j 服务）一起使用时遇到了一点问题。顺便说一句，如果有人正在考虑将 jqgrid 与 odata 服务一起使用，请给我发邮件，我找到了难题的答案，例如，如何配置网格 xmlreader 以读取 odata xml 结构，从而击败 jquery 命名空间搜索问题（提示：

包括`jquery.xmlns.js`

```
.....
$.xmlns.m = "http://schemas.microsoft.com/ado/2007/08/dataservices/metadata";
$.xmlns.d = "http://schemas.microsoft.com/ado/2007/08/dataservices";
.....
var feedXmlReaderOptions = {
    root: "feed",
    row: "entry",
    repeatitems: false,
    id: "feed>entry>id"
};
....
    colModel: [
    {
        name: "clmNumKey", 
        index: "clmNumKey", 
        width: 150, 
        xmlmap: "d|clmNum",
        editable: true
    }
    ....
) 
```

无论如何，问题在于 odata 服务需要处理编辑操作（DELETE、PUT、MERGE）的方法作为普通 POST 上的自定义请求标头发送，而不是作为 http 方法。原因似乎是大多数防火墙不允许 PUT 和 DELETE http 方法通过，因为这就是您可以例如在服务器上放置新文件以及删除文件的方式，以防您猜到有效路径。长话短说……内联或表单编辑不会触发 loadBeforeSend 事件……我可以看到它是在网格的完整数据请求上触发的，但我只有在`serializeEditData`从编辑表单提交时才会触发该事件。我很担心，因为我进入了 jqgrid 源文件 ( `grid.formedit.js`,`grid.inlineedit.js`）并且我无法使用 beforesend 关键字获得任何点击，只有 serializeeditdata 显示在那里。我错过了什么吗？`xhr`还有另一种方法可以在网格使用的 ajax 对象上设置我需要的标题吗？该`xhr`对象是否被网格暴露？

下面你有我必须处理编辑事件的代码......再次， loadBeforeSend 没有被触发......

提前谢谢你，塞尔班

```
$.extend($.jgrid.edit, {
    closeAfterEdit: true,
    closeAfterAdd: true,
    ajaxEditOptions: {
        contentType: "application/json"
    },
    mtype: 'POST',
    loadBeforeSend: function(xhr)
    {
        xhr.setRequestHeader("X-HTTP-Method", "MERGE");
        return xhr;
    },        
    serializeEditData: function (data) {
        delete data.oper;
        return JSON.stringify(data);
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T20:08:37.940

没有`loadBeforeSend`可以设置的参数`$.jgrid.edit`。的值定义了[editGridRow](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#editgridrow)`$.jgrid.edit`的默认[选项](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#properties)。

要指定`loadBeforeSend`在相应的 Ajax 请求期间应该使用的回调，您应该使用`ajaxEditOptions`并指定`beforeSend`（参见[$.ajax](http://api.jquery.com/jQuery.ajax/)）：

```
$.extend($.jgrid.edit, {
    closeAfterEdit: true,
    closeAfterAdd: true,
    ajaxEditOptions: {
        contentType: "application/json",
        beforeSend: function (jqXHR, settings) {
            jqXHR.setRequestHeader("X-HTTP-Method", "MERGE");
        }
    },
    //mtype: 'POST', - it's already default
    serializeEditData: function (data) {
        delete data.oper;
        return JSON.stringify(data);
    }
}); 
```

# debugging - 使用 WebStorm 和 Node JS 打破异常调试

> ID：10286784
> 
> 赞同：6
> 
> 时间：2012-04-23T19:15:18.927
> 
> 标签：debugging, node.js, webstorm

我正在使用 Webstorm 调试一个节点应用程序，并希望使用“异常中断”选项，这样我就不必连续按“步入”数十次才能找到我正在尝试的错误的确切来源解决。

问题是，当我将“异常中断”设置为“开”时，它会在获取我的代码之前很久就从节点本身捕获各种异常。我能够使用“运行到光标”来跳过启动时发生的节点错误，但这并没有太大帮助，因为在执行过程中似乎有很多错误被抛出并捕获在节点本身内部。

如何仅对我的代码直接引发的异常使用“异常中断”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-04-22T12:50:06.183

这对我来说可以：

> “运行 -> 查看断点... -> JS 任何异常 -> 仅启用和暂停和未捕获”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T06:31:07.570

WebStorm 目前还没有这样的功能。随意在我们的追踪器中[为这个问题投票。](http://youtrack.jetbrains.com/issue/WI-11242)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-02T08:12:21.510

一旦 JQuery 启动并完成了大部分异常抛出，就在开始时设置一个断点。

在异常中断中，您可以告诉它仅在到达该断点时才开始。

最佳点是您可以右键单击您设置的断点并告诉它*不要*在该点暂停。

（但同意 - 如果 JQuery 在其正常业务中不抛出异常会更好......）

# php - lastInsertId 在第一条记录后没有返回值。我该如何检查这个？

> ID：10286787
> 
> 赞同：1
> 
> 时间：2012-04-23T19:15:30.577
> 
> 标签：php, mysql, transactions, pdo

我有以下 PHP 脚本，它运行良好，并正确使用 PDO 事务将所有数据插入 MySQL，但仅在第一次运行时。初次运行后，我尝试再次插入相同的数据。然后第一个`lastInsertId`开始返回 0，因为该`unique key`字段上的属性`email`正在停止`userId`通过创建新值`auto_increment`。

在阅读了类似的答案后，我仍然不知道如何检查这种情况并解决问题。我写了这个`$userCheck`，以便我可以查看 from 的值是否`$fromParsed`与数据库中已经存在的电子邮件地址相匹配。我不知道如何获取此查询的值，然后编辑脚本，以便如果用户已经在那里使用相同的电子邮件地址，那么它会获取`userId`of `$fromParsed`，如果`$fromParsed`还没有，则插入它继续使用`lastInsertId();`以获取`userId`.

我确实尝试过寻找这个问题的答案，但是对于涉及 PDO 交易的类似情况，我找不到任何可以为我提供明确答案的东西。

对不起，如果这个答案是显而易见的。

```
try {

    $con = new PDO('mysql:host=localhost;dbname=db', 'root', 'password');

    $attachmentsQuery = $con->prepare('INSERT INTO attachments SET attachmentName = :attachmentName, content = :content, fileType = :fileType');
    $usersQuery = $con->prepare('INSERT INTO users SET email = :email');
    $emailsQuery = $con->prepare('INSERT INTO emails SET userId = :userId, subject = :subject, body = :body, attachmentId = :attachmentId');
    $userCheck = $con->prepare("SELECT userId FROM users WHERE email = '$fromParsed'");

    try {
        $con->beginTransaction();

        $userCheck->execute();
        //Something here?

        $usersQuery->bindParam(':email', $fromParsed, PDO::PARAM_STR);
        $usersQuery->execute();

        $userId = $con->lastInsertId();

        $attachmentsQuery->bindParam(':attachmentName', $filename, PDO::PARAM_STR);
        $attachmentsQuery->bindParam(':fileType', $fileType, PDO::PARAM_STR);
        $attachmentsQuery->bindParam(':content', $content, PDO::PARAM_LOB);
        $attachmentsQuery->execute();

        $attachmentId = $con->lastInsertId();

        $emailsQuery->bindParam(':userId', $userId, PDO::PARAM_INT);
        $emailsQuery->bindParam(':attachmentId', $attachmentId, PDO::PARAM_INT);
        $emailsQuery->bindParam(':subject', $subject, PDO::PARAM_STR);
        $emailsQuery->bindParam(':body', $text, PDO::PARAM_STR);
        $emailsQuery->execute();

        $con->commit();

        } catch(Exception $e) {
                $dbo->rollback();
                die();
        }
} catch(Exception $e) {
        error_log($e->getMessage());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:56:16.867

试试这个，

```
if($userCheck->execute() && $userCheck->rowCount() > 0){
    // we have a user.
    $data = $userCheck->fetch(PDO::FETCH_ASSOC);
    $userId = $data['userId'];
}
else {

    $usersQuery->bindParam(':email', $fromParsed, PDO::PARAM_STR);
    $usersQuery->execute();

    $userId = $con->lastInsertId();
}
//Something here? 
```

简要说明，如果存在由 rowCount 指示的记录，这会将 $userQuery 的结果放入 $data。如果查询没有返回任何结果，它将继续执行您的 $userQuery 并为新创建的条目返回一个 userId。

# magento - Magento 产品库存数量，但未显示在下拉列表中

> ID：10286788
> 
> 赞同：0
> 
> 时间：2012-04-23T19:15:30.833
> 
> 标签：magento, stock

我有一个可配置的产品，其中包含许多简单的产品（每个产品的尺寸不同）。每个简单的产品都有一个库存值，但由于某种原因，一个特定的尺寸，虽然它的库存值为 9，但不会出现在前端的下拉列表中。

所有其他尺寸都适用于同一产品，我将它们与出现的尺寸进行了比较，看不出有什么区别。我已经清除了缓存、更新了索引等，但什么也没有。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T16:41:09.900

尝试打开 Configurable Product 并检查是否添加了与其关联的所有简单产品。

产品信息 -> 相关产品页面的底部。

没有在前端显示的简单产品很可能从组中丢失。

希望这可以帮助。

# modelica - 连接到连接器阵列的一部分

> ID：10286802
> 
> 赞同：2
> 
> 时间：2012-04-23T19:17:05.410
> 
> 标签：modelica

我有一个连接器阵列，我想将另一个较小的类似连接器阵列连接到该连接器阵列的一部分。连接器数组、连接器`a`数组的示例：`x``b``y``x < y`

```
connect(a[:], b[1:x]); // works fine
connect(a[:], b[2:x+1]); // gives an error 
```

我在第二种情况下得到的错误（在 Dymola 2012 中检查模型时）说：

```
Error: Failed to expand connect(a[:], b[2:x+1]) 
```

这是语言还是工具限制？是否有解决方法（除了使用 for 循环连接每个单独的连接器）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T07:23:25.377

这一定是一个工具限制，因为规范说：

> 连接器引用中的下标应为参数表达式或特殊运算符“:”。

我能想到的唯一解决方法是一个 for 方程或更明显的方法：向 Dymola 团队提交错误报告。我会为 OpenModelica 做同样的事情（它会生成方程，但是是错误的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T08:48:04.297

我认为我们需要更多代码来了解发生了什么。我没有看到 Dymola 有任何明显的限制。例如，以下代码在 Dymola 2012 FD01 中运行良好：

```
model SlicedConnectors 
  parameter Integer n(start=5);
  Modelica.Blocks.Interfaces.RealInput a[n];
  Modelica.Blocks.Interfaces.RealOutput b[2*n];
equation 
  connect(a[:],b[1:n]);
  connect(a[:],b[(n+1):(2*n)]);
end SlicedConnectors; 
```

因此，问题似乎并不是切片本身，而是可能更复杂（有关特定连接器、尺寸可变性等的一些问题）。

# javascript - JSON解析问题

> ID：10286811
> 
> 赞同：9
> 
> 时间：2012-04-23T19:18:09.440
> 
> 标签：javascript, jquery, json

我是一个在 jQuery 中解析 JSON 的完整菜鸟。以为我得到了回应......我的数据是这种形式：

```
Array(
[1]=>abc,
[3]=>mango,
[4]=>apple,
[5]=>fruits
) 
```

通过这种方式，我希望此列表显示为自动完成列表。我在用。

```
 jQuery("#name").autocomplete( '<?php echo HTTP_PATH.'/songs/sss'; ?>', {
    multiple: true,
    mustMatch: true,        
    matchContains: true,
    autoFill: false,
    dataType: "json",
    parse: function(data) {
            return jQuery.map(data, function(item) {
                return { data: item, value: item.label, result: item.label};
            });
        },
        formatItem: function(item) {
            return item.label;
        },
        formatResult: function(item) {
            return item.id;
        },
        formatMatch: function(item) {
            return item.label;
        }

}); 
```

我想要它显示列表时的值，即我的数据中的标签。当我选择一个标签时，它应该显示标签。但是在提交时它应该实际提交密钥。我的意思是我希望它作为 HTML 的选择框工作。

返回的 JSON

```
 [{"id":1,"label":"Mehdi Hassan"},{"id":2,"label":"Jagjit Singh"},{"id":3,"label":"Suresh Vadekar"}] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-23T19:22:46.913

您的 JSON 似乎不是一个数组，只是一个对象（散列图）。查看官方[文档](http://jqueryui.com/demos/autocomplete/)：

> 预期数据格式
> 
> 来自本地数据、url 或回调的数据可以有两种变体：
> 
> *   字符串数组：[ "Choice1", "Choice2" ]
>     
>     
> *   具有标签和值属性的对象数组：[ { label: "Choice1", value: "value1" }, ... ]

在您的情况下，它应该采用以下格式：

```
[
   {"1":"Shad.aab"},
   {"158":"Adadad"},
   {"159":"Asdadad"},
   {"166":"Abbas"},
   {"167":"Sdadad"},
   {"171":"Shadaab Please check it out"},
   {"173":"Check This Please"},
] 
```

（记住左边是标签，右边的值，我想在你的数据中，都应该颠倒......）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T09:42:24.557

如果我对您的理解正确，您想使用自动完成来填充名称文本字段，但想利用与 POST 表单中的名称关联的另一个值。

**[如果您能够使用最新的 jQueryUI 版本的自动完成] - 遵循**[http://jqueryui.com/demos/autocomplete/#custom-data](http://jqueryui.com/demos/autocomplete/#custom-data)上的“自定义数据和显示”自动完成示例，您将在自动完成中看到提示，它们显示选定的标签，但是，它们还将关联的值保存在隐藏的输入中，该输入也回发到服务器。鉴于您当前的 json 格式：

html:

```
<label for="username">Name:</label>
<input id="username" size="50" />             <!-- holds display name -->
<input id="userid" name="userid" size="50" /> <!-- holds userid -->
... 
```

js：

```
<script>
  $("#username").autocomplete({
    source: '<?php echo HTTP_PATH.'/songs/sss'; ?>',

    // Update display name when user mouses over selection
    focus: function( event, ui ) {
      $( "#username" ).val( ui.item.label );
      return false;
    },

    // Set display name and hidden input on user selection
    select: function( event, ui ) {
      $( "#username" ).val( ui.item.label );
      $( "#userid" ).val( ui.item.id );
      return false;
    }
  }); 
</script> 
```

php POST 目标：

```
<?php
  // Use [hidden] input to do your magic
  if(isset($_POST['userid']))
    echo 'Wooo..here is my key: ' . $_POST['userid'];
?> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-28T11:27:09.337

你需要`json_encode($your_array)`在后端做。

它将 PHP 数组转换为您的前端 (jQuery) 可以解析和处理的 JSON 编码字符串。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-23T22:16:07.303

问题看起来在这里：

```
jQuery("#name").autocomplete( '<?php echo HTTP_PATH.'/songs/sss'; ?>', { multiple: true, ... 
```

它应该是这样的：

```
jQuery("#name").autocomplete( { source: '<?php echo HTTP_PATH.'/songs/sss'; ?>', multiple: true, ... 
```

还要确保您在加载/准备好时使用它，而不仅仅是在普通的 <script> 标记内

```
$(function(){ jQuery("#name").autocomplete(); }); 
```

使用 firebug 来验证当您在该字段中键入一个字母时，它会向设置为自动完成的源页面发送请求。

这是我用来重新创建/解决您的问题的代码：

**索引.php**

```
<html>
<head>
<link rel="stylesheet" type="text/css" href="css/ui-lightness/jquery-ui-1.8.20.custom.css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.20.custom.min.js"></script>
<script type="text/javascript">
    $(function(){
        jQuery("#name").autocomplete({
            source: 'index_json.php',
            multiple: true,
            mustMatch: true,
            matchContains: true,
            autoFill: false,
            dataType: "json",
            parse: function(data) {
                return jQuery.map(data, function(item) {
                    return { data: item, value: item.label, result: item.label};
                });
            },
            formatItem: function(item) {
                return item.label;
            },
            formatResult: function(item) {
                return item.id;
            },
            formatMatch: function(item) {
                return item.label;
            }
        });
    });
</script>
</head>
<body>
    <form>
        <label for="name">Name: </label>
        <input id="name" name="name" />
    </form>
</body>
</html> 
```

**index_json.php**

```
<?
header('Cache-Control: no-cache, must-revalidate');
header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');
header('Content-type: application/json');
echo '[{"id":1,"label":"Mehdi Hassan"},{"id":2,"label":"Jagjit Singh"},{"id":3,"label":"Suresh Vadekar"}]';
?> 
```

我对您的请求感到非常困惑，但是已经采用了您的代码并使其按照您的指定方式工作（我认为）。

> 当它从我的数据中显示 list.ie 标签时，我想要价值。当我选择标签时，它也应该显示标签。但在提交时它实际上应该提交密钥。我的意思是我希望它作为 HTML 的选择框工作。

*听起来好像您想要一个仅用于搜索的输入框和一个静态选择列表，该列表从自动完成更改但保留在那里而不是消失...*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-28T06:53:46.113

我不确定我是否很好地理解了你的问题。但在我的经验中，我面临着同样的要求。我从上面的链接中使用了[ajax 自动完成 js 。](http://www.devbridge.com/projects/autocomplete/jquery/)（通过链接了解完整的详细信息）

这里的亮点是，这个 js 为您提供了一个回调`onSelect`，您可以在选择自动完成建议后设置您的值。

json编码的字符串应该像

```
query:'Li',
suggestions:['Mahendi Hassan','Libyan Arab Jamahiriya','Liechtenstein','Lithuania'],
data:['1','2','3','4'] 
```

*   查询 - 原始查询值
*   建议 - 逗号分隔的建议值数组
*   数据（可选）- 数据数组，其中包含选择数据时回调函数的值。

现在在您的 中有一些隐藏`input`字段`form`，并将所选建议的数据设置为该隐藏`input`字段的值，如下所示。

```
jQuery(function () {
    options = {
        minChars: 2,
        serviceUrl: "ur/php file",
        onSelect: function (value, data) {
            $('#hiddenUserProfileIdProps').val(data);  //Setting value to hidden field
        }
    });
    a = $('#enterEmailLink').autocomplete(options);
    a.disable();
}); 
```

然后提交您的表格。而已。

# ajax - Ajax Crawlable 站点 - 使用 WaTin 获取 HTML 快照

> ID：10286815
> 
> 赞同：2
> 
> 时间：2012-04-23T19:18:24.730
> 
> 标签：ajax, watin, asp.net-mvc-4, google-crawlers

我想使用 Watin 来获取 html 快照，以使我的单页 ajax 应用程序可以按照 google 规范进行爬网。

有人可以向我展示如何使用 Watin 将 html 快照返回给 googlebot 的代码示例吗？

这是我到目前为止所拥有的，但老实说，我什至不确定我要去哪里，我真的没有在网上找到一个可以真正清除它的例子：

控制器：

```
 public PartialViewResult Solutions()
    {
        //Googlebot request
        HtmlString htmlSnapshot = (HtmlString)GetHtmlSnapshot(Request.Path);
        //return ?????????

        //Normal user request
        return PartialView("Solutions", null);
    }
    public PartialViewResult MarketData()
    {
        return PartialView("MarketData", null);
    }

    public IHtmlString GetHtmlSnapshot(string uglyUrl)
    {
        if (uglyUrl.Contains("?_escaped_fragment_="))
        {
            string prettyUrl = uglyUrl.Replace("?_escaped_fragment=", "");
            string decodedUrl = HttpUtility.UrlDecode(prettyUrl);

            FireFox firefox = new FireFox();
            firefox.GoTo(decodedUrl);

            //?????????                
        }            
    } 
```

# css - 在 wordpress 网站上将图像放在 div 常量中

> ID：10286819
> 
> 赞同：0
> 
> 时间：2012-04-23T19:18:54.867
> 
> 标签：css, wordpress, html

我有一个 WP 网站，我想拉一点皮条客。

这将是一个查看 iPhone 配件的地方，我希望它具有 iphone 的外观。

我制作了一个我很满意的背景，但我想将背景图片放在整个页面上，这样我所做的与 iphone 相似的东西的“框架”一直可见，并且 WP 的内容在它下面滚动时。

我的 wp 在这里：

[http://www.metalagency.com](http://www.metalagency.com)

我想在上面的图像在这里：

[http://www.metalagency.com/wp-content/themes/twentyeleven/images/testdiv.png](http://www.metalagency.com/wp-content/themes/twentyeleven/images/testdiv.png)

图像的白色部分是透明的，所以我希望 wp 站点在该区域可见。

我在这里有意义吗？

抱歉，如果这是一个愚蠢的问题，但我似乎在这方面的任何地方都找不到任何答案。

我知道我需要做一些 CSS 样式，但我不知道把它放在哪里。

请帮助一个慢吞吞的瑞典人......

谢谢。

//R

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:51:15.503

书签预览：打开你的页面，复制到地址栏，回车：

```
javascript:sa=document.styleSheets;sa[sa.length-1].insertRule('#page { background: transparent; height: 700px; overflow: scroll; }'); 
```

[您应该首先创建一个简单的子主题（如果您不希望修改后的 211 主题被自动更新覆盖）： http](http://codex.wordpress.org/Child_Themes#The_required_style.css_file) ://codex.wordpress.org/Child_Themes#The_required_style.css_file并将所有修改放在那里。

示例 style.css：

```
/*
Theme Name:     myPhoney theme
Template:       twentyeleven
*/

@import url("../twentyeleven/style.css");

#page {
  background: transparent;
  height: 700px;
  overflow: scroll;
} 
```

# c++ - 比较向量 对于几乎相等，STL 算法 - C++

> ID：10286823
> 
> 赞同：-4
> 
> 时间：2012-04-23T19:19:14.277
> 
> 标签：c++, vector, compare, equals

我正在做一个任务自动取款机。我应该在 STL 算法的帮助下比较给定范围内的所有向量元素，在两个不同的向量中，几乎相等。

在这种情况下几乎相等：2。

有人知道这个问题的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T19:24:33.170

如果您想要小于比较，请将[std::lexicographical_compare](http://en.cppreference.com/w/cpp/algorithm/lexicographical_compare)与自定义比较器一起使用，以实现对您来说几乎相等的任何东西。

如果您想要相等比较，请使用[std::equal](http://en.cppreference.com/w/cpp/algorithm/equal)，如评论中所指出的：

```
bool comp(int a, int b) {
  return std::abs(a-b) <= 2;
}

int main() {

  std::vector<int> v0{2,3,4,5,5,5};
  std::vector<int> v1{6,7,8,9,8,7};
  std::cout << std::boolalpha;
  std::cout << std::equal(v0.begin(), v0.end(), v1.begin(), comp);

} 
```

这是一个简化的比较函数，用于展示如何使用该算法，如果向量具有不同的长度，您必须决定该怎么做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T19:49:06.260

基于[g19fanatic 的回答](https://stackoverflow.com/a/10287052/845092)：

```
template<class iterator1, class iterator2>
bool almostEqual(iterator1 begin1, iterator1 end1, 
                 iterator2 begin2, iterator2 end2, int tolerance)
{
    for(;begin1!=end1; ++begin1, ++begin2) {
        if (begin2 == end2)
            return false;
        if (*begin1 - tolerance > *begin2)
            return false;
        if (*begin1 + tolerance < *begin2)
            return false;
    }
    if (begin2 != end2)
        return false;
    return true;
}

template<class container1, class container2>
bool almostEqual(container1 left, container2 right, int tolerance)
{ 
    return almostEqual(left.begin(), left.end(), 
                       right.begin(), right.end(), tolerance);
} 
```

编译/执行证明：http: [//ideone.com/y6jBR](http://ideone.com/y6jBR)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T20:03:33.747

标准库函数[`inner_product`](http://en.cppreference.com/w/cpp/algorithm/inner_product)迭代两个容器，对每一对执行一些操作，并累积结果。所以我们可以用它来比较每一对是否在2以内，并累加所有的比较都是真的。

```
#include <vector>
#include <iostream>
#include <algorithm>

bool all(bool first, bool second)
{
  return first && second;
}

bool within_two(int first, int second)
{
  return abs(first - second) <= 2;
}

int main()
{
  using std::vector;
  using std::inner_product;
  using std::boolalpha;
  using std::cout;
  using std::endl;

  vector<int> first = {1, 2, 3, 4, 5};
  vector<int> second = {3, 4, 5, 6, 7};

  bool almost_equal = inner_product(first.begin(), first.end(),
                                    second.begin(),
                                    true,
                                    all, within_two);

  cout << "almost_equal=" << boolalpha << almost_equal << endl;
} 
```

输出：

```
almost_equal=true 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T19:37:57.583

```
#include "math.h"
#include <vector>

std::vector<int> vec1,vec2;
std::vector<bool> resVec;

void almostEqual(std::vector<int> vec1,std::vector<int> vec2,std::vector<bool>& resVec, int tolerance)
{
    resVec.clear();
    if (vec1.size() != vec2.size()) {return;}

    std::vector<int>::iterator it;

    int i = 0;
    for (it = vec1.begin(); it != vec1.end(); ++it)
    {
        if (abs(*it - vec2[i++]) <= abs(tolerance))
        {
            resVec.push_back(true);
        } else {
            resVec.push_back(false);
        }
    }
} 
```

基于我们所拥有的很少，这就是我要做的......

# mysql - MySQL中的批量替换字符串

> ID：10286824
> 
> 赞同：4
> 
> 时间：2012-04-23T19:19:20.217
> 
> 标签：mysql, sql

考虑下面的推文表

```
id  tweet
------------------------------------------------------
1   alcoa inc stock analysis
2   bullrider has added alcoa inc to portfolio
3   caterpillar annual results
4   more at http://bit.ly/d3423 on caterpillar
5   making apple inc profits 
```

我想用指定的标签替换公司名称，如下：

```
id  tweet
------------------------------------------------------
1   {COMPANY|AA} stock analysis
2   bullrider has added {COMPANY|AA} to portfolio
3   {COMPANY|CAT} annual results
4   more at http://bit.ly/d3423 on {COMPANY|CAT}
5   making {COMPANY|AAPL} profits 
```

我现在有以下查询：

```
UPDATE
  tweets
SET
  tweet = REPLACE(tweet, 'alcoa inc', '{COMPANY|AA}')
WHERE
  tweet LIKE '% alcoa inc %'
OR
  tweet LIKE 'alcoa inc %'
OR
  tweet LIKE '% alcoa inc' 
```

不过，我有两个问题：

1.  难道没有更好的方法来捕获所有可能的“alcoa inc”实例吗？
2.  是否可以在 SQL 中为多个替换编写一种数组（在 SQL 中，而不是在 PHP 中）。这里。我的意思是在 SQL 中定义类似的东西`array("alcoa inc" => "{COMPANY|AA}", "caterpillar" => "{COMPANY|CAT}", "apple inc" => "{COMPANY{AAPL}")`并在 SQL 中循环遍历它以进行大规模替换。

感谢您的帮助:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:37:48.050

您可以尝试将代码和公司列表存储在一个表中，并使用如下查询：

```
select
    case
        when c.ticker is not null then
            replace(t.tweet, c.name,
                    concat('{COMPANY|',c.ticker,'}'))
        else t.tweet
    end as tweet
from
    tweets t
left join
    company c
        on
            t.tweet like concat('% ', c.name, ' %')
        or
            t.tweet like concat(c.name, ' %')
        or
            t.tweet like concat('% ', c.name)
group by
    t.id 
```

唯一的缺点是该解决方案无法处理两家公司的名称出现在同一条推文中的情况。其中只有一个会被替换。

演示：[http ://www.sqlfiddle.com/#!2/8da9d/2](http://www.sqlfiddle.com/#!2/8da9d/2)

* * *

**编辑**：正如所指出的`@Mario`，如果同一字符串中有多个实例，则匹配可能会导致不正确的替换。例如，使用`I have a redapple from apple`带有替换的字符串`apple`将导致字符串`I have a red{COMPANY|AAPL} from {COMPANY|AAPL}`，因为第二个`apple`触发`LIKE`匹配，然后`REPLACE`替换每个匹配。我有一个更新的查询也可以通过从表中读取匹配的字符串来处理这种情况：

```
select
    case
        when p.ticker is not null then
            replace(t.tweet,
                replace(p.replacestr, '{0}', p.name),
                replace(p.replacestr, '{0}', concat('{COMPANY|',p.ticker,'}')))
        else t.tweet
    end as tweet
from
    tweets t
left join
    (select * from pattern,company) p
        on t.tweet like replace(p.pattern, '{0}', p.name);
group by
    t.id 
```

`Pattern`像这样定义的表在哪里：

```
CREATE TABLE Pattern
    (pattern varchar(50), replacestr varchar(50));

INSERT INTO Pattern
    (pattern, replacestr)
VALUES
    ('% {0} %', ' {0} '),
    ('{0} %', '{0} '),
    ('% {0}', ' {0}'); 
```

演示：[http ://www.sqlfiddle.com/#!2/c71d4/3](http://www.sqlfiddle.com/#!2/c71d4/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:40:41.600

> 难道没有更好的方法来捕获所有可能的“alcoa inc”实例吗？

REGEX（正则表达式）搜索。查看官方[mysql REGEX](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)文档以获取更多信息。

> 是否可以在 SQL 中为多个替换编写一种数组（在 SQL 中，而不是在 PHP 中）。这里。我的意思是在 SQL 中定义类似 array("alcoa inc" => "{COMPANY|AA}", "caterpillar" => "{COMPANY|CAT}", "apple inc" => "{COMPANY{AAPL}")并在 SQL 中循环遍历它以进行批量替换。

是的，您可以创建一个特定的表来存储 key->value 字典，然后从中获取值，例如：

```
 table : dictionary
+----------+-----------------------+---------------+
| name     | pattern               | replacement   |
+----------+-----------------------+---------------+
|alcoa inc | [[:space:]]+alcoa inc |{COMPANY|AA}   |
|apple inc | apple inc.*           |{COMPANY{AAPL} | 
```

您可以使用如下查询进行更新，例如：

```
UPDATE tweets SET tweets = REPLACE(tweet, 'alcoa inc', '{COMPANY|AA}') 
WHERE  tweet RLIKE (SELECT pattern FROM dictionary WHERE name = 'alcoa inc'); 
```

*这只是一个示例来说明一种可能的方式，您必须根据您的要求和特定上下文对其进行调整。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T19:44:45.973

一种方法是使用存储过程：

```
CREATE PROCEDURE UpdateTweetsWithCompany
    @CompanyName varchar(255) = 'alcoa inc',
    @ReplaceValue varchar(255) = '{COMPANY|AA}'
AS
BEGIN
    UPDATE
      tweets
    SET
      tweet = REPLACE(tweet, @CompanyName, @ReplaceValue)
    WHERE
      tweet LIKE '% ' + @CompanyName + ' %'
    OR
      tweet LIKE @CompanyName + ' %'
    OR
      tweet LIKE '% ' + @CompanyName
END 
```

然后调用它，有点像这样：

```
EXEC UpdateTweetsWithCompany 'alcoa inc', '{COMPANY|AA}' 
```

# url - Like 按钮 - 使用 mod 重写的友好 URL 和非友好 URL 作为计数值

> ID：10286825
> 
> 赞同：0
> 
> 时间：2012-04-23T19:19:24.933
> 
> 标签：url, mod-rewrite, facebook-like, friendly-url, facebook-social-plugins

我的网站在动态页面上有一个类似 FB 的按钮。网站上还有 mod 重写规则，以允许该动态页面的友好 URL。

即以下页面是“相同的”：

（网址 1）www.getawayearth.com/property.php?id=703

（网址 2）www.getawayearth.com/property-rental/holidayhome703.html

该页面上有一个赞按钮。我的问题是，即使页面是“相同的”，like 按钮也会为每个 url 显示不同的值。例如，如果您要访问 URL 1 并单击点赞按钮，则点赞数不会注册为 URL 2。

我理解为什么会发生这种情况，但是我想知道是否可以设置类似按钮以将两个网址识别为相同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T15:16:19.470

我了解您的问题，并且通过在两个 URL 页面上设置相同的 og::url 元数据，现在 2 个不同的 URL 相同，Open Graph 元标记可能是让 Facebook 的一种方式。

搜索引擎优化也会出现同样的问题，这就是为什么有一个名为“规范”的元数据来指定页面的官方 URL，即使有不同的 URL 可以到达相同的页面内容。

```
<html>
<head>
      <meta name="title" content="your page title" />
      <link rel="canonical" href="http://your-official-page-URL" />

      <meta property="og:title" content="your page title" />
      <meta property="og:url" content="http://your-official-page-URL" />
</head>
… 
```

希望能有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:23:16.177

如果您有多个“点赞”按钮都应该“点赞”同一件事，则需要将点赞按钮的 href 指向该 URL - 即在第 1 页和第 2 页上，两个点赞按钮都将采用以下形式`<fb:like href="http://example.com/page1"/>`

# ruby-on-rails - Rails 应用程序之间的通信

> ID：10286829
> 
> 赞同：7
> 
> 时间：2012-04-23T19:19:37.027
> 
> 标签：ruby-on-rails, ruby, http, web-applications

我已经构建了两个需要相互通信和发送文件的 Rails 应用程序。例如，一个 Rails 应用程序会发送一个请求以查看其他应用程序数据库中的表。然后，另一个应用程序将呈现该表的 json 并将其发回。我还希望一个应用程序将存储在其公共目录中的文本文件发送到另一个应用程序的公共目录。

我从来没有做过这样的事情，所以我什至不知道从哪里开始。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:44:46.483

无论rails如何，几乎所有Web应用程序都需要您的要求，大多数现代Web应用程序都需要相互通信。但是有一点需要坚持下去，

网站不应直接访问彼此的内部数据（例如表格），（即使它们是由同一开发人员使用相同的语言（在本例中为 Rails）构建的），

这就是 Web 服务发挥作用的地方，因此您应该通过 Web 服务公开您的数据，这样不仅 Rails 应用程序可以使用它，而且任何知道如何使用 Web 服务的应用程序都将受益。

回到你关于 Rails 的问题，rails 支持开箱即用的 REST web 服务，所以做一些关于 web 服务的谷歌搜索，使用 rails 的 REST web 服务

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T19:28:51.260

作为起点，请看`ActiveResource`.

[Railscast](http://railscasts.com/episodes/94-activeresource-basics)

[文档](http://api.rubyonrails.org/v3.2.6/classes/ActiveResource/Base.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-19T23:44:49.067

RabbitMQ 等消息队列系统可用于在不同应用程序（如“邮件”应用程序和主“集线器”应用程序）之间进行内部通信。

或者，您可以使用与 redis 之类的共享连接将内容粘贴到一个应用程序中的“队列”上，然后从另一个应用程序中读取它们以进行处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T00:25:36.337

看看[墨菲斯](https://github.com/ryanmoran/morpheus)。它允许您创建 RESTful 服务并在客户端中使用熟悉的 ActiveRecord 语法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T21:33:02.150

在最近的 Rails 版本中，开发仅 API 的应用程序相当容易。在 Rails 核心主控中，甚至短暂地为这些应用程序提供了一种特殊的应用程序类型（直到它再次被拉出）。但它仍然可以作为插件使用，并且可能有一天会再次成为 Rails 核心的一部分。有关详细信息，请参阅[http://blog.wyeworks.com/2012/4/20/rails-for-api-applications-rails-api-released](http://blog.wyeworks.com/2012/4/20/rails-for-api-applications-rails-api-released)。

要实际开发和维护后端服务的 API，并确保后端和前端对资源有相同的理解，您可以使用[ROAR](https://github.com/apotonick/roar)，这是构建出色 API 的好方法。

通常，您应该使用 API 完全定义您的后端应用程序。从长远来看，试图变得聪明并跳过一些设计步骤只会让你头疼……

# java - 绑定在 Playframework 2 中形成 我应该如何在 Playframework 2.0 中处理带有选择元素的表单请求？我有一个带有此选择的表单：@helper.select(deviceForm("deviceType"), options = options(deviceTypeList)) DeviceType is bind to public DeviceType deviceType; 但 deviceTypeList 是字符串列表 您可以为您的类型 DeviceTyp

> ID：10286831
> 
> 赞同：0
> 
> 时间：2012-04-23T19:19:52.497
> 
> 标签：java, model-view-controller, scala, playframework-2.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T20:54:34.713

您可以为您的类型[注册自定义数据绑定](http://www.playframework.org/documentation/2.0/JavaForms)`DeviceType`器：

```
Formatters.register(DeviceType.class, new Formatters.SimpleFormatter<DeviceType>() {

    @Override
    public DeviceType parse(String input, Locale l) throws ParseException {
        return …
    }

    @Override
    public String print(DeviceType deviceType, Locale l) {
        return …
    }
}); 
```

# c++ - 哈希表构造函数中的错误

> ID：10286834
> 
> 赞同：0
> 
> 时间：2012-04-23T19:20:08.333
> 
> 标签：c++, hash

我的哈希表类的构造函数出现错误，该类是“条目”对象的向量（下面的类定义）。

```
HT::HT (  const unsigned& s )
{
    hTable = new Entry[s];
    pTable = new Entry*[s];
    psize = 0;
    hsize = TBL_SZ;
    for (unsigned int i = 0; i != s; i++)
    {
        hTable[i].key = FREE;
    }
} 
```

为什么我会收到此错误？

```
 hTable.cc:12:15: error: expected type-specifier before âhTableâ
hTable.cc:12:15: error: no match for âoperator=â in â((HT*)this)->HT::hTable = (int*)operator new(4u)â
hTable.cc:12:15: note: candidate is:
/usr/include/c++/4.6/bits/vector.tcc:158:5: note: std::vector<_Tp, _Alloc>& std::vector<_Tp, _Alloc>::operator=(const std::vector<_Tp, _Alloc>&) [with _Tp = Entry, _Alloc = std::allocator<Entry>]
/usr/include/c++/4.6/bits/vector.tcc:158:5: note:   no known conversion for argument 1 from âint*â to âconst std::vector<Entry>&â
hTable.cc:12:15: error: expected â;â before âhTableâ
hTable.cc:13:15: error: expected type-specifier before âpTableâ
hTable.cc:13:15: error: no match for âoperator=â in â((HT*)this)->HT::pTable = (int*)operator new(4u)â
hTable.cc:13:15: note: candidate is:
/usr/include/c++/4.6/bits/vector.tcc:158:5: note: std::vector<_Tp, _Alloc>& std::vector<_Tp, _Alloc>::operator=(const std::vector<_Tp, _Alloc>&) [with _Tp = Entry*, _Alloc = std::allocator<Entry*>]
/usr/include/c++/4.6/bits/vector.tcc:158:5: note:   no known conversion for argument 1 from âint*â to âconst std::vector<Entry*>&â 
```

这是头文件：

```
 #ifndef H_HASH_TABLE
#define H_HASH_TABLE

// class for hash table

class HT {
public:
    HT ( const unsigned& = TBL_SZ ); // constructor
    ~HT ( );                         // destructor

    void insert ( const Entry& );    // inserts item in hash table
    void search ( const string& );   // searches for item

    void hTable_print ( ); // prints hash table entries
    void pTable_print ( ); // prints hash table entries in sorted order

private:
    unsigned hsize,             // size of hash table
             psize;             // actual size of ptr table

    vector < Entry >  hTable;   // hash table
    vector < Entry* > pTable;   // ptr table

    int hash ( const string& ); // hash function
};
#endif 
```

这是我的 Entry 对象标头：

```
#ifndef H_ENTRY
#define H_ENTRY

#define ID_SZ    3      // size of key
#define ITEM_SZ 24      // max size for item description 
#define TBL_SZ  31      // default size for hash table
#define FREE   "$$$"    // indicates empty spot in hash table

// entry in hash table

struct Entry {
    string key;   // key
    string desc;  // description
    unsigned num; // no of copies

    //constructor
    Entry ( const string& k = FREE, const string& d = "",
        const unsigned& n = 0 ) : key ( k ), desc ( d ),
        num ( n ) { }
};
#endif 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:58:57.257

成员声明

```
vector < Entry >  hTable;   // hash table
vector < Entry* > pTable;   // ptr table 
```

*根本*不匹配初始化

 *```
hTable = new Entry[s];
pTable = new Entry*[s]; 
```

A`std::vector`不是指针，不应使用`new`. 它们由`vector`构造函数自动初始化。

如果要设置向量的大小，可以在构造函数初始值设定项列表中执行此操作，或者通过调整默认构造向量的大小：

```
HT::HT (  const unsigned& s )
{
    hTable.resize(s);
    pTable.resize(s);
    psize = 0;
    hsize = TBL_SZ;
    for (unsigned int i = 0; i != s; i++)
    {
        hTable[i].key = FREE;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:59:08.207

`new Entry[s];` 创建一个 Entry 对象数组，并且您试图将其分配给一个向量。new Entry*[s] 也是如此。您需要决定 hTable 和 pTables 是否需要成为向量或将其替换为

`Entry *hTable` `Entry **pTable`.*

# php - Magento 帮助：如果当前父 ID = x，则显示此内容

> ID：10286835
> 
> 赞同：0
> 
> 时间：2012-04-23T19:20:09.050
> 
> 标签：php, magento, if-statement

需要一些有关 Magento php 脚本的帮助....

我想写一个 if 语句，基本上说“如果当前类别的父 ID = x，则显示这个 html 块”。

我已经想出了如何为当前类别编写这个 if 语句，但不是当前的 PARENT 类别......这是代码：

```
<?php if (Mage::registry('current_category') && Mage::registry('current _category')->getId() == 11) : ?>
    //html here
<?php endif; ?> 
```

非常感谢您能给我的任何帮助！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:56:52.563

尝试这个

```
 <?php 
        $cat = Mage::registry('current_category'); 
        $parentCat = $cat->getParentCategory();
        if ( $cat && $parentCat && $parentCat->getId() == 11) : ?>

        //html here

    <?php endif; ?> 
```

# android - 是否有一个实时的 PhoneGap 利用 Web 应用程序示例？

> ID：10286836
> 
> 赞同：0
> 
> 时间：2012-04-23T19:20:14.043
> 
> 标签：android, web-applications, cordova

简短版本：是否有人开发了利用网络上可用的 PhoneGap 功能的任何网站？

长版：PhoneGap 允许开发人员将网站打包到本机应用程序中。它还允许开发人员将 PhoneGap webview 作为其应用程序的一部分嵌入。然后，他们可以将这个 PhoneGap 集成的 webview 指向任何 url，并像浏览器一样使用它。我不能自己开发网站，所以我想知道互联网上是否有任何网站使用 PhoneGap 功能。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T22:50:58.300

没有错。为了访问 Phonegap API，Phonegap App 必须安装在设备上。App里面的内容可以指向一个网站，没错。但这并没有改变您需要先下载并安装应用程序的事实。我在 Apple App Store 中有两个 Phonegap 应用程序，所以我知道我在说什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:23:09.153

PhoneGap 在他们的网站上有一个专门介绍使用它构建的移动应用程序的部分：http: [//phonegap.com/apps](http://phonegap.com/apps)

# mysql - MySQL Workbench 保存数据库

> ID：10286840
> 
> 赞同：0
> 
> 时间：2012-04-23T19:20:27.977
> 
> 标签：mysql

我正在做一个小组项目，我的伙伴给我发了一个 .mwb 文件，所以我可以看看他们为 ER 图做了什么，但她不知道如何为数据库本身发送一个 .sql 文件（至少我认为那些是 .sql 文件）。您如何保存数据库并将其发送给某人？我正在尝试通过编写一些查询来测试数据库，但如果我只能看到图表，我不知道该怎么做。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:41:55.747

MySQL 工作台绝对可以为您做到这一点。

这是一个链接，您也有一些屏幕截图：[Back up and restore MySQL databases using MySQL Workbench](https://help.fasthosts.co.uk/app/answers/detail/a_id/1404/~/back-up-and-restore-mysql-databases-using-mysql-workbench)

它显示了如何导出和导入数据库备份。

# c# - MongoDB C# 驱动程序使用 LINQ 引发异常

> ID：10286841
> 
> 赞同：1
> 
> 时间：2012-04-23T19:20:34.273
> 
> 标签：c#, mongodb, fluent-mongo

我正在构建一个使用 Mongo 和官方 C# 驱动程序的应用程序。使用接口和泛型类型约束时我遇到了一个奇怪的问题。考虑以下：

```
interface IMongoObject
{
    BsonObjectId Id { get; set; }
    string Name { get; set; }
}

class MongoObject : IMongoObject
{
    public BsonObjectId Id { get; set; }
    public string Name { get; set; }
}

class Program
{
    MongoServer m_db;
    string m_dbName;

    protected void Save<T>(T entity) where T : IMongoObject
    {
        GetDatabase().GetCollection<T>(typeof(T).Name).Save(entity);
    }

    protected T Get<T>(string name) where T : IMongoObject
    {
        Type t = typeof(T);

        // Throws
        return GetDatabase().GetCollection<T>(typeof(T).Name).AsQueryable().Where(o => o.Name == name).FirstOrDefault();
    }

    protected MongoDatabase GetDatabase()
    {
        if (m_db == null)
        {
            var conString = "mongodb://localhost/MongoTest";
            MongoUrl url = new MongoUrl(conString);
            m_dbName = url.DatabaseName;
            m_db = MongoServer.Create(url);
        }

        return m_db.GetDatabase(m_dbName);
    }

    void Run()
    {
        MongoObject o = new MongoObject();
        o.Name = "Foo";
        Save(o);

        MongoObject b = Get<MongoObject>("Foo");
        Console.ReadKey();
    }

    static void Main(string[] args)
    {
        Program p = new Program();
        p.Run();
    }
} 
```

除了调用 Get(...) 之外，一切正常。使用官方驱动程序，我从SelectQuery.cs `var memberSerializationInfo = containingSerializationInfo.Serializer.GetMemberSerializationInfo(memberName);`中函数的调用中获得空引用异常。`private BsonSerializationInfo GetSerializationInfoMember(IBsonSerializer serializer, MemberExpression memberExpression)`

如果我切换到使用 FluentMongo for LINQ，我会收到一条消息说

“鉴别器只能为类注册，不能为接口 MyLib.Services.IRepoData 注册。”

这和这个人基本一样：

[FluentMongo 突然抛出错误](https://stackoverflow.com/questions/8055603/fluentmongo-throwing-error-all-of-a-sudden)

我知道 Mongo 驱动程序在抱怨，因为它不知道 IMongoObject 是什么。我不明白为什么 where 调用中的表达式将“o”视为 IMongoObject 类型而不是 MongoObject 类型（通过调试器确认这是正在发生的事情），就是这样。

如果我改用抽象基类，一切正常。我不这样做，因为不是所有的“MongoObjects”

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:25:05.790

因此，问题实际上在于 C# 编译器如何将对象的表达式树组合在一起。由于您的类型约束，它在访问 Name 属性时将您的 MongoObject 转换为 IMongoObject。因此，IMongoObject 是表达式的类型，我们在 IMongoObject 上找不到任何成员。我会看看在下一个版本的驱动程序中我们是否可以针对这种情况做些什么，但现在，我会坚持使用抽象类。

另外，最好不要将“域”对象与 DTO 混合。相反，有 2 个，每个职责一个，并在它们之间映射。

--更新--有趣的注释。显然，这是基于 VB.NET 创建表达式树的方式与 c# 不同的不同问题而得到修复的。因此，在不久的将来，这将正常工作。你可以在这里看到证明这一点的测试：[https](https://github.com/craiggwilson/mongo-csharp-driver/commit/153b9862b122521eee681a86e56806d94fed8b21#diff-1) ://github.com/craiggwilson/mongo-csharp-driver/commit/153b9862b122521eee681a86e56806d94fed8b21#diff-1 。

# javascript - 跨站脚本

> ID：10286842
> 
> 赞同：0
> 
> 时间：2012-04-23T19:20:44.360
> 
> 标签：javascript, scripting

我的服务器上有一个 javascript。我想为我的访问者提供 javascript 代码，他们可以像 Google Analytics 那样将其放置在他们的服务器上。例如：

```
<script type="text/javascript" src="http://www.somedomain.com/script/script.js?id=2001102"></script> 
```

我让一切工作到我需要获取 id 的地步。我只是不知道该用什么。

我尝试了 location.href 和 location.search，但这给了我嵌入脚本的文件的 url + 参数，而不是“script.js?id=XSOMEIDX”

在 script.js 我有以下内容：

```
function requestContent() {   
var script = document.createElement("script");
script.src = "http://www.somedomain.com/script/xss_script.php?id="I WANT TO INPUT ID HERE+"&url="+location.href;
document.getElementsByTagName("head")[0].appendChild(script); 
```

}

有什么办法可以将 id=XSOMEIDX 放入 xss_script.php?id= 中？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:45:08.537

您可以使用 URL 重写获取 id=XSOMEIDX 并将其放入 xss_script.php?id=

执行此操作的 mod 重写规则如下所示：

```
RewriteRule ^/scripts/([a-zA-Z0-0]+)/script.js$ /scripts/script.php?id=$1 
```

这样，您可以简单地要求人们包括 yoursite.com/scripts/{id}/scripts.js

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:35:36.733

如何设置具有特定属性的外部脚本标签？

```
<script data-my-script="my_value" type="text/javascript" src="http://www.somedomain.com/script/script.js?id=2001102"></script> 
```

在现代浏览器中，您可以这样做

```
var scripts = document.querySelectorAll("script[src][data-my-script]");
$.each(scripts, function(i, script) { console.log(script.src); }); 
```

并遍历 nodeList ...

注意：querySelectorAll 不能跨浏览器工作注意：querySelectorAll 正在返回一个类似数组的对象

# macos - 每当在集合中添加新项目时，NSCollectionViewItem 中的 CALayer 都会闪烁（并消失）

> ID：10286843
> 
> 赞同：2
> 
> 时间：2012-04-23T19:20:44.453
> 
> 标签：macos, cocoa, calayer, nscollectionview, nscollectionviewitem

我`NSCollectionViewItem`在一个单独的 xib 文件中。它有一个图像视图。以前我是直接在`NSImageView`. 用户界面运行良好。

现在，我添加了一个`CALayer`到`NSImageView`. 我用它来显示图像并从一个图像过渡到另一个图像。

问题是：每次用户添加一个新的`NSCollectionViewItem`. `CALayers`闪烁/闪烁，`NSCollectionViewItem`有时完全消失。这是随机发生的。有时`CALayer`每个项目都会消失。其他时候只有少数项目`CALayer`消失。

然后，如果我添加另一个项目或`NSCollectionView`通过调整容器窗口的大小来调整大小，这`NSCollectionView`将重新调整所有项目。`CALayer`出现回来，但并非总是如此。这也是随机的。一些项目保持 CALayer-less。

我的猜测是动画`NSCollectionView`搞砸了`NSCollectionViewItem`CALayer。

知道发生了什么吗？是否有一些示例代码/开源项目`CALayer`用于`NSCollectionViewItem`？

任何帮助，任何提示，无论多么小，都将受到高度赞赏。

# c# - 在不在模拟器中的电话上不断收到 ArgumentOutOfRangeException

> ID：10286848
> 
> 赞同：2
> 
> 时间：2012-04-23T19:20:59.060
> 
> 标签：c#, silverlight, windows-phone-7, bing-maps

嘿，

我需要一些关于我的应用程序经常遇到的异常的帮助，

这段代码中的异常触发

```
Map mapView = new Map() 
        { 
            CredentialsProvider = new ApplicationIdCredentialsProvider("OurKey"),
            Margin = new Thickness(6.0),
            IsEnabled = false,
            Center = new GeoCoordinate(Convert.ToDouble(newEvent.EventLat), Convert.ToDouble(newEvent.EventLon)),
            ZoomLevel = 15
        }; 
```

我在哪里获得包含以下信息`ArgumentOutOfRangeException`的作品`Center = new GeoCoordinate`

> 该参数的值必须在 -90.0 到 90.0 之间。参数名称：纬度

但是`newEvent.EventLat`“51.4430624”对我来说完全有效不是吗？

现在更奇怪的部分是只有当我在我的诺基亚 Lumia 800 上运行它时才会发生这种情况，当我在模拟器上启动它时它就可以正常工作。

所以我真的需要帮助，我在互联网上找不到任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T19:29:14.277

> 但是 newEvent.EventLat 是“51.4430624”，所以对我完全有效不是吗？

除非您手机上的小数分隔符是`,`
区域设置，否则在模拟器和真实设备之间通常会出错。

考虑

```
//Convert.ToDouble(newEvent.EventLat)
double.Parse(newEvent.EventLat, CultureInfo.InvariantCulture) 
```

# linker - 使用 Clang 和 CMake 时使用 LLVM 链接器

> ID：10286850
> 
> 赞同：20
> 
> 时间：2012-04-23T19:21:02.140
> 
> 标签：linker, cmake, clang

告诉 CMake 使用 LLVM 链接器`llvm-link`而不是 GNU`ld`作为链接器的最佳方法是什么？配置项目时

```
CXX=clang++ cmake <args> 
```

默认链接器似乎未触及，保留`usr/bin/ld`（在 Linux 上）。

这是否可能不[使用单独的工具链文件](http://mhungerford.blogspot.com/2010/10/cmake-and-clangllvm-fun.html)？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-26T02:03:49.563

事实证明这与 CMake 无关：`clang++`默认使用系统链接器。例如，

```
echo "#include <atomic>\n int main() { return 0; }" \
    | clang++ -x c++ -std=c++11 -stdlib=libc++ - 
```

用于`/usr/bin/ld`链接应用程序。要将链接器更改为`llvm-link`，首先需要发出 LLVM 字节码，然后调用链接器，例如：

```
echo "#include <atomic>\n int main() { return 0; }" \
    | clang++ -x c++ -std=c++11 -stdlib=libc++ -S -emit-llvm -o - - \
    | llvm-link -o binary - 
```

这绕过了`/usr/bin/ld`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-03T16:27:37.937

从 3.4 开始，在查找路径之前查找`clang`链接器 ( `ld`) 。您应该能够将链接器放入并在 1 步中调用它。要手动指定此位置，请使用*未记录*的标志。不幸的是，我不相信有一种方法可以更改所搜索的链接器的名称，因此使用 ld.gold 或 lld 将需要在上述位置使用符号链接。`GCCInstallation.getParentLibPath() + "/../" + GCCInstallation.getTriple().str() + "/bin"``ld``/usr/lib/gcc/<arch><sub>-<vendor>-<sys>-<abi>/<version>/ld``clang` *`-B`*

# tridion - 从 GetListItems 发布大结果时出现内存不足错误

> ID：10286854
> 
> 赞同：5
> 
> 时间：2012-04-23T19:21:16.723
> 
> 标签：tridion

我在 64 位服务器上使用 SDL Tridion 2009 SP1 并尝试发布系统中所有多媒体组件的大量 XML (190K+)。我正在使用`folder.GetListItems(filter)`过滤器设置为的方法`Recursive="true"`。

模板运行了几秒钟，然后出现内存不足错误：

```
<?xml version="1.0"?>
<tcm:Error xmlns:tcm="http://www.tridion.com/ContentManager/5.0" ErrorCode="7" Category="7" Source="Kernel" Severity="1"><tcm:Line ErrorCode="7" Cause="true"><![CDATA[Out of memory]]></tcm:Line><tcm:Details><tcm:CallStack><tcm:Location>FolderBLST.GetListData</tcm:Location></tcm:CallStack></tcm:Details></tcm:Error>
   at Tridion.ContentManager.Interop.TDSBL._IBLOrganizationalItemST.GetListData(UserContext userContext, String URI, EnumListKind listKind, ListColumnFilter columnFilter, String rowFilter)
   at Tridion.ContentManager.ContentManagement.OrganizationalItem.GetListItems(Filter filter)
   at myNS.myTbb.Transform(Engine engine, Package package)
   at Tridion.ContentManager.Templating.Assembly.AssemblyMediator.Transform(Engine engine, Template template, Package package)
   at Tridion.ContentManager.Templating.Assembly.CSharpSourceCodeMediator.RunTemplate(Engine engine, Package package, String templateUri, String className)
   at Tridion.Templating.CSharpTemplate.CSharpSourceTemplate.Transform(Engine __engine, Package __package)
   at Tridion.ContentManager.Templating.Assembly.CSharpSourceCodeMediator.Transform(Engine engine, Template template, Package package)
   at Tridion.ContentManager.Templating.Engine.ExecuteTemplate(Template template, Package package)
   at Tridion.ContentManager.Templating.Engine.InvokeTemplate(Package package, TemplateInvocation templateInvocation, Template template)
   at Tridion.ContentManager.Templating.Compound.CompoundTemplateMediator.Transform(Engine engine, Template templateToTransform, Package package)
   at Tridion.ContentManager.Templating.Engine.ExecuteTemplate(Template template, Package package)
   at Tridion.ContentManager.Templating.Engine.InvokeTemplate(Package package, TemplateInvocation templateInvocation, Template template)
   at Tridion.ContentManager.Templating.Engine.TransformPackage(Template template, Package package)
   at Tridion.ContentManager.Templating.Engine.TransformItem(Template template, IdentifiableObject itemToRender)
   at Tridion.ContentManager.Templating.Debugging.DebuggingEngine.Run()
   at Tridion.ContentManager.Templating.Debugging.DebugSession.Run() 
```

从堆栈跟踪来看，错误似乎发生在 CM 服务器的业务层中。有没有我可以为此增加的内存设置，如果有，是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T20:18:11.123

`folder.GetListItems(filter)`递归将在您的场景中消耗大量资源。

如果您有大量多媒体项目，则会给系统增加巨大的过载。即使您尝试扩展服务器，您也会在某些时候面临同样的问题。

通常，当您尝试执行庞大的数据检索操作时，您将面临这个问题。

也许您可以使用不同的技术来实现相同的场景（以下是示例）

**方案 1**

使用事件系统，您可以将二进制文件的信息（何时创建等）添加到公共存储库（例如存储在系统组件字段中的 XML）并偶尔发布该 XML。

例如，如果您只需要一个 id 列表，请使用为存储该信息而创建的组件。如果需要，您还可以定义一系列 id 并创建新的组件，因为只有一个没有太多条目（例如：从 0 到 10000 的 id 将存储在名为 的组件中`References_0_10000`，从 10001 到 20000 的 ID 将存储在名为`References_10001_20000`）。

**方案 2**

`recursive=true`例如，在处理主文件夹中的子文件夹时，将初始加载拆分为子加载（仍使用），然后组合结果。在这种情况下，您可以最小化`folder.GetListItems(filter)`负载。

**方案 3**

仍然`folder.GetListItems(filter)`多次使用，但在代码中实现递归逻辑，而不是在过滤器选项中使用它并组装每次调用返回的结果。

*注意：* 检查 MMC 管理单元的`TimeOut`设置`SDL Tridion Content Manager configuration`并增加设置以防万一。

# sql-server - 事务并发隔离 - 为什么我可以更新另一个事务记录的子集？

> ID：10286856
> 
> 赞同：1
> 
> 时间：2012-04-23T19:21:37.943
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, concurrency, transactions

我试图理解我遇到的一个问题，我认为在处理使用读提交隔离级别的事务时应该不可能。我有一个用作队列的表。在一个线程（连接 1）中，我将多批 20 条记录插入到每个表中。每批 20 条记录在一个事务中执行。在第二个线程（连接 2）中，我执行更新以更改已插入队列的记录的状态，这也发生在事务中。当同时运行时，我的期望是受更新影响的行数（连接 2）应该是 20 的倍数，因为连接 1 在事务中以 20 行的批量插入表中的行。

但我的测试表明情况并非总是如此，有时我能够从连接 1 的批次更新记录子集。这应该是可能的还是我错过了一些关于事务、并发和隔离级别的东西？下面是我创建的一组测试脚本，用于在 T-SQL 中重现此问题。

***此脚本以 20 个事务批次向表中插入 20,000 条记录。***

```
USE ReadTest
GO

SET TRANSACTION ISOLATION LEVEL READ COMMITTED
GO

SET NOCOUNT ON

DECLARE @trans_id INTEGER
DECLARE @cmd_id INTEGER
DECLARE @text_str VARCHAR(4000)

SET @trans_id = 0
SET @text_str = 'Placeholder String Value'                

-- First empty the table
DELETE FROM TABLE_A

WHILE @trans_id < 1000 BEGIN
    SET @trans_id = @trans_id + 1
    SET @cmd_id = 0

    BEGIN TRANSACTION
--  Insert 20 records into the table per transaction
    WHILE @cmd_id < 20 BEGIN
        SET @cmd_id = @cmd_id + 1

        INSERT INTO TABLE_A ( transaction_id, command_id, [type], status, text_field ) 
            VALUES ( @trans_id, @cmd_id, 1, 1,  @text_str )
    END             
    COMMIT

END

PRINT 'DONE' 
```

***此脚本更新表中的记录，将状态从 1 更改为 2，然后检查更新操作中的行数。当行数不是 20 的倍数时，print 语句会指出这一点以及受影响的行数。***

```
USE ReadTest
GO

SET TRANSACTION ISOLATION LEVEL READ COMMITTED
GO

SET NOCOUNT ON
DECLARE @loop_counter INTEGER
DECLARE @trans_id INTEGER
DECLARE @count INTEGER

SET @loop_counter = 0

WHILE @loop_counter < 100000 BEGIN

    SET @loop_counter = @loop_counter + 1
    BEGIN TRANSACTION
        UPDATE TABLE_A SET status = 2 
        WHERE status = 1
            and type = 1
        SET @count = @@ROWCOUNT
    COMMIT

    IF ( @count % 20 <> 0 ) BEGIN
--      Records in concurrent transaction inserting in batches of 20 records before commit.
        PRINT '*** Rowcount not a multiple of 20\. Count = ' + CAST(@count AS VARCHAR) + ' ***'
    END

    IF @count > 0 BEGIN
--      Delete the records where the status was changed.
        DELETE TABLE_A WHERE status = 2
    END
END

PRINT 'DONE' 
```

***此脚本在名为 ReadTest 的新数据库中创建测试队列表。***

```
USE master;
GO

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'ReadTest')
  BEGIN;
  DROP DATABASE ReadTest;
  END;
GO

CREATE DATABASE ReadTest;
GO

ALTER DATABASE ReadTest
SET ALLOW_SNAPSHOT_ISOLATION OFF
GO

ALTER DATABASE ReadTest
SET READ_COMMITTED_SNAPSHOT OFF
GO

USE ReadTest
GO

CREATE TABLE [dbo].[TABLE_A](
    [ROWGUIDE] [uniqueidentifier] NOT NULL,
    [TRANSACTION_ID] [int] NOT NULL,
    [COMMAND_ID] [int] NOT NULL,
    [TYPE] [int] NOT NULL,
    [STATUS] [int] NOT NULL,
    [TEXT_FIELD] [varchar](4000) NULL
 CONSTRAINT [PK_TABLE_A] PRIMARY KEY NONCLUSTERED 
(
    [ROWGUIDE] ASC
) ON [PRIMARY]
) ON [PRIMARY]

ALTER TABLE [dbo].[TABLE_A] ADD  DEFAULT (newsequentialid()) FOR [ROWGUIDE]
GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:50:27.200

你的期望完全错位了。您从未在查询中表达过“出列”正好 20 行的要求。UPDATE 可以返回 0、19、20、21 或 1000 行并且所有结果都是正确的，只要`status`是 1 和`type`1。如果您期望 'dequeue' 按 'enqueue' 的顺序发生（即在您的问题中以某种方式回避，但从未明确说明）那么您的“出队”操作必须包含一个`ORDER BY`子句。如果您添加了这样一个明确声明的要求，那么您期望“出队”总是返回一整批“入队”行（即 20 行的倍数）将更接近一个合理的期望。就目前的情况而言，正如我所说，完全错位了。

有关更长的讨论，请参阅[使用表作为队列](http://rusanu.com/2010/03/26/using-tables-as-queues/)。

> 我不应该担心，当一个事务提交一批 20 条插入的记录时，另一个并发事务只能更新这些记录的子集，而不是全部 20？

基本上问题归结为*如果我在插入时选择，我会看到多少插入行？*. 如果隔离级别被声明为 SERIALIZABLE，您只有权利担心。其他隔离级别都不会预测*在 UPDATE 运行时插入的行*数将是可见的。只有 SERIALIZABLE 声明结果必须与一个接一个地运行两个语句相同（即序列化，因此得名）。虽然技术细节*如何*一旦您考虑物理顺序和缺少 ORDER BY 子句，则 UPDATE '看到' INSERT 批处理的只有一部分很容易理解，解释是无关紧要的。根本问题是期望是没有根据的。即使通过添加正确的 ORDER BY 和正确的聚集索引键（上面链接的文章解释了详细信息）来“修复”“问题”，期望仍然没有保证。UPDATE “看到” 1、19 或 21 行仍然是完全合法的，尽管不太可能发生。

> 我想我一直将 READ COMMITTED 理解为仅读取已提交的数据，并且事务提交是原子操作，使事务中发生的所有更改立即可用。

那是对的。不正确的是期望*并发*SELECT（或更新）看到整个更改，与它在执行中发生的位置无关。打开 SSMS 查询并运行以下命令：

```
use tempdb;
go

create table test (a int not null primary key, b int);
go

insert into test (a, b) values (5,0)
go

begin transaction
insert into test (a, b) values (10,0) 
```

现在打开一个新的 SSMS 查询并运行以下命令：

```
update test 
    set b=1
    output inserted.*
    where b=0 
```

这将阻止未提交的 INSERT。现在回到第一个查询并运行以下命令：

```
insert into test (a, b) values (1,0)
commit 
```

提交后，第二个 SSMS 查询将完成，它将返回两行，而不是三行。QED。这是已提交的。您期望的是 SERIALIZABLE 执行（在这种情况下，上面的示例将死锁）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:27:36.127

它可能会这样发生：

1.  writer/inserter 写入 20 行（不提交）
2.  读取器/更新器读取一行（未提交 - 它丢弃它）
3.  作者/插入者提交
4.  读取器/更新器读取 19 行，这些行现在已提交，因此可见

我相信只有可序列化的隔离级别（或更具并发性的快照隔离）才能解决此问题。

# string - VBA多次拆分相同的字符串

> ID：10286858
> 
> 赞同：1
> 
> 时间：2012-04-23T19:21:40.377
> 
> 标签：string, excel, split, vba

我一直在搜索互联网，我似乎无法弄清楚我的问题。任何帮助将非常感激。我的代码如下：

```
Private Sub removebutton_Click()
Dim iRow As Long
Dim ws As Worksheet
Dim removebox As String
Set ws = Worksheets("Sheet2")
removebox = InputBox("Please Scan the Barcode to be added", "Add Coin", "Scan Barcode Here")
'Find the next blank row'
iRow = ws.Cells.Find(What:="*", SearchOrder:=xlRows, _
SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1

'Promt User To Actually input data if they have not entered anything'
If Trim(Me.removebox.Value) = "" Then
Me.removebox.SetFocus
MsgBox "Please enter barcode"
Exit Sub
End If

'For 20 digit barcodes split into 4 parts and record the data in the next blank row'
If Len(removebox) = 20 Then
Dim s1 As String
s1 = removebox.Substring(1, 6)
Dim s2 As String
s2 = removebox.Substring(7, 8)
Dim s3 As String
s3 = removebox.Substring(9)
Dim s4 As String
s4 = removebox.Substring(10, 20)

ws.Cells(iRow, 1).Value = Me.s1.Value
ws.Cells(iRow, 2).Value = Me.s2.Value
ws.Cells(iRow, 3).Value = Me.s3.Value
ws.Cells(iRow, 4).Value = Me.s4.Value

'For 18 Digit barcodes spilt into 3 parts and record the data in the next blank row'
ElseIf (removebox) = 18 Then
Dim s5 As String
s5 = removebox.Substring(1, 6)
Dim s6 As String
s6 = removebox.Substring(7, 8)
Dim s7 As String
s7 = removebox.Substring(9, 18)

ws.Cells(iRow, 1).Value = Me.s5.Value
ws.Cells(iRow, 2).Value = Me.s6.Value
ws.Cells(iRow, 3).Value = Me.s7.Value

'If not 20 or 18 digit then it is 16, split into 3 parts and record the data in the next blank row'
Else
Dim s8 As String
s8 = removebox.Substring(1, 6)
Dim s9 As String
s9 = removebox.Substring(7, 8)
Dim s10 As String
s10 = removebox.Substring(9, 16)

ws.Cells(iRow, 1).Value = Me.s8.Value
ws.Cells(iRow, 2).Value = Me.s9.Value
ws.Cells(iRow, 3).Value = Me.s10.Value
End If

End Sub 
```

所以我搞砸了，整个代码应该是删除一个项目，而不是添加一个我意识到的项目。我的问题是`s1 = removebox.Substring(1, 6)`突出显示`removebox`变量并告诉我`Compiler Error: Invalid Qualifier`。如果有人能给我一个可能的解决方案，我知道我做错了，但是当您扫描条形码时，它以 20、18 或 16 位整数的形式出现，但我需要单独保存这些部分以便创建一个简单的数据库查询功能。

提前感谢您的任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:02:04.213

餐饮部主管打败了我。但是我会粘贴代码，因为我已经在处理它了。

> > > 以 20、18 或 16 位整数形式出现的条形码

**注意**：基于上述，我没有将它分成 4 个相等的部分。我只是转换了您现有的代码。

```
Option Explicit

Private Sub removebutton_Click()
    Dim iRow As Long
    Dim ws As Worksheet
    Dim removebox As String

    Set ws = Worksheets("Sheet2")

    removebox = InputBox("Please Scan the Barcode to be added", _
    "Add Coin", "Scan Barcode Here")

    '~~> Prompt User To Actually input data if they have not entered anything
    If Len(Trim(removebox)) = 0 Then
        MsgBox "Please enter barcode", vbCritical, "Please Try again"
        Exit Sub
    End If

    '~~> Find the next blank row
    iRow = ws.Cells.Find(What:="*", SearchOrder:=xlRows, _
    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1

    ws.Cells(iRow, 1).Value = Left(removebox, 6)
    ws.Cells(iRow, 2).Value = Mid(removebox, 7, 8)

    Select Case Len(removebox)
        '~~> For 20 digit barcodes split into 4 parts and record
        '~~> the data in the next blank row'
        Case 20
            ws.Cells(iRow, 3).Value = Mid(removebox, 9)
            ws.Cells(iRow, 4).Value = Mid(removebox, 10, 20)
        '~~> For 18 Digit barcodes spilt into 3 parts and record
        '~~> the data in the next blank row'
        Case 18
            ws.Cells(iRow, 3).Value = Mid(removebox, 9, 18)
        '~~> If not 20 or 18 digit then it is 16, split into 3
        '~~> parts and record the data in the next blank row'
        Case Else
            ws.Cells(iRow, 3).Value = Mid(removebox, 9, 18)
    End Select
End Sub 
```

# wpf - WindowsExplorer Drop 从文件夹中获取文件和文件

> ID：10286859
> 
> 赞同：0
> 
> 时间：2012-04-23T19:21:53.693
> 
> 标签：wpf, drag-and-drop, .net

据我所知，无法判断拖放是文件还是文件夹。

if (fi.Extension == "") 是不够的，因为它匹配一个目录和一个没有扩展名的文件。

我发现的唯一方法是 .GetFiles() 并处理异常。

有没有更好的办法？

```
 private void ListView0_DragDrop(object sender, DragEventArgs e)
    {
        // Can only drop files, so check
        if (!e.Data.GetDataPresent(DataFormats.FileDrop))
        {
            return;
        }

        string[] files = (string[])e.Data.GetData(DataFormats.FileDrop);
        FileInfo fileInfo;

        DirectoryInfo dirInfo;
        foreach (string str in files)
        {
            dirInfo = new DirectoryInfo(str);  
            try 
            {
                foreach(FileInfo fi in dirInfo.GetFiles())
                {
                    Debug.WriteLine("File in dir " + fi.Name);
                }
            }
            catch
            {
                fileInfo = new FileInfo(str);
                Debug.WriteLine("File " + str);
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:29:33.073

我会在添加 try catch 之前使用[Directory.Exists](http://msdn.microsoft.com/en-us/library/system.io.directory.exists.aspx)和[File.Exists](http://msdn.microsoft.com/en-us/library/system.io.file.exists.aspx) - 尽管由于文件/目录的安全性，您可能仍然需要尝试（这两种`Exists`方法都可以抛出`FileIOException`.

```
DirectoryInfo dirInfo;
foreach (string str in files)
{
    if (Directory.Exists(str))
    {
        dirInfo = new DirectoryInfo(str);  

        foreach(FileInfo fi in dirInfo.GetFiles())
        {
            Debug.WriteLine("File in dir " + fi.Name);
        }
    }
    else if (File.Exists(str))
    {
        fileInfo = new FileInfo(str);
        Debug.WriteLine("File " + str);
    }
} 
```

# javascript - Internet Explorer 不支持最大宽度或最大高度

> ID：10286860
> 
> 赞同：3
> 
> 时间：2012-04-23T19:22:03.710
> 
> 标签：javascript, html, css, internet-explorer

我正在尝试使用 CSS 将图像缩放到精确值：

HTML：

```
<div id="thumbnail-container">
    <img src="sample-pic.jpg"/>
</div> 
```

CSS：

```
#thumbnail-container img {
    max-height: 230px;
    max-width: 200px;
} 
```

在这个例子中，`sample-pic.jpg`实际上是 320x211。

在 Firefox 11.0 中，此代码运行良好，并且 FF 调整`sample-pic.jpg`为 CSS 规则中规定的最大 230x211 约束。

然而，在 IE 9 中，`max-height`和`max-width`规则被完全忽略，图像呈现为其通常的 320x211 大小。

**如何修改 HTML/CSS 以使 IE 9 和 FF 11.0 都遵守这些最大约束？**提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T19:43:22.243

确保您已经声明了一个 doctype，并且在它之前没有输出或空格。例如，这是 HTML5 的 doctype，它应该位于输出的最顶部：

```
<!doctype html> 
```

此外，如果 IE 处于兼容模式，则可能会导致问题。尝试将以下内容添加到您的`<head>`：

```
<!-- Forces user OUT of IE's compatibility mode and removes "broken page" icon --> 
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /> 
```

**编辑：**我能够测试，似乎没有`doctype` *导致*max-width 不起作用。兼容模式似乎没有影响它（在这个问题上）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-23T19:34:57.723

IE7+ 支持`max-width`和`max-height`.

演示在[http://jsfiddle.net/gaby/qE6w6/](http://jsfiddle.net/gaby/qE6w6/)

检查您的页面是否在标准模式下运行..（*确保有有效的文档类型*）

# php - PHP：另一个我想不通的正则表达式

> ID：10286861
> 
> 赞同：-3
> 
> 时间：2012-04-23T19:22:07.397
> 
> 标签：php, regex

我在 PHP 中遇到了 2 个正则表达式的问题

**1\. 剥离 http(s):// 和 www。**

```
https://www.google.be/search?sclient=psy-ab&q=regex&oq=regex
http://www.google.be/search?sclient=psy-ab&q=regex&oq=regex
https://google.be/search?sclient=psy-ab&q=regex&oq=regex
http://google.be/search?sclient=psy-ab&q=regex&oq=regex

=> google.be/search?sclient=psy-ab&q=regex&oq=regex 
```

**2\. 3-30个字符，可以包含a-zA-Z0-9.-_*但至少需要一个字母或数字**

```
Valid: -_l*96d.*
Invalid: *-_. 
```

找了好久都没有结果，求大神帮忙！

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:27:44.180

第二个正则表达式如下所示：

```
'/^(?=[0-9a-zA-Z])[a-zA-Z0-9\-\*_\.]{3,30)$/' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:35:52.227

```
 preg_replace('/^(http|https):\/\/(www\.)?/i', '', $url) 
```

# qt - Qt：构建 quazip/zlib 库错误

> ID：10286863
> 
> 赞同：0
> 
> 时间：2012-04-23T19:22:15.790
> 
> 标签：qt, build, zlib, quazip

我正在静态构建 quazip 库，如以下帖子中所述：[将 QuaZip 与 Qt 4.8.0 链接到项目中](https://stackoverflow.com/questions/9227977/linking-quazip-with-qt-4-8-0-into-project)

构建项目时出现以下错误：

```
/QtSDK/QtSources/4.8.0/src/3rdparty/zlib/zconf.h:373:6: error: "_LARGEFILE64_SOURCE" is not defined
In file included from ../../../quazip-0.4.4/quazip/zip.h:56,
                 from ../../../quazip-0.4.4/quazip/quazip.h:31,
                 from ../../../quazip-0.4.4/quazip/quazipfile.h:30,
                 from ../../../quazip-0.4.4/quazip/quazipfile.cpp:24:

/QtSDK/QtSources/4.8.0/src/3rdparty/zlib/zlib.h:1583:32: error: "_FILE_OFFSET_BITS" is not defined
cc1plus: warnings being treated as errors 
```

zlib 库中有这些已知错误吗？我在 Qt 4.8.0 中使用 zlib 库

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:40:00.600

那将是您的编译器中的错误。我不知道您使用的是什么版本的 zlib，并且您的编译器没有在错误消息中显示违规行，所以我无法确切知道该行包含什么。但是我怀疑这些行在表达式中具有带有注释符号的#if 指令。根据 C 标准，未定义的符号在 #if 语句的表达式中被赋予空值（没有字符替换它）。相反，您的编译器错误地发出错误。

# css - 定位一个 CSS 按钮

> ID：10286866
> 
> 赞同：0
> 
> 时间：2012-04-23T19:22:20.277
> 
> 标签：css, html

我想做一个按钮出现在下一行。但我尝试使用按钮的属性“位置”和“行高”，但没有任何改变。我希望它位于下一行的中心，在输入文本名称下 ![我想把它移到下一行的按钮](../Images/4f871b57f5dca3be20477483d7a07ec8.png)

这是我的代码：

css 文件：

```
#popup {
font-family: 'Orbitron', serif;
font-size: 28px;
font-weight: 700;     
text-shadow: 0px 1px 2px #fff;

color: #222;

position: absolute;   
width: 100%;
height: 100%;
top: 0;
left: 0;

background: rgba(0,0,0,.5);

display: -webkit-box;
-webkit-box-pack: center;
-webkit-box-align: center;          

-webkit-transition: all .5s ease-in;}

   #popup h1 {
font-weight: 400;
   }

   #popup-box {
width: 400px;
height: 300px;
background: #ccc url(../images/popup_bg.jpg);

border-radius: 10px;

position: relative;

-webkit-box-shadow: 0 5px 5px #333;

display: -webkit-box;
-webkit-box-pack: center;
-webkit-box-align: center;

-webkit-transition: all .5s ease-in;}

    #popup-box small {
font-size: .6em; }

   #popup.hide {
background: rgba(0,0,0,0);
visibility: hidden;     
    }
     #popup.hide #popup-box{
margin-top: -800px;}

  #popup-box a.button {
background: white;
border-radius: 10px;
display: block;
font-size: 30px;
margin: 230px auto 0;
padding: 10px;
width: 50px;
border: 3px solid #006438;
color:#006438;
text-decoration:none;
cursor:pointer;} 
```

.html 文件：

```
<section id="popup">
    <div id="popup-bg">
    </div>
 <div id="popup-box">   
 <p><a id="gamelogin1" class="button"   href="">choose Name</a></p>
 <p><a id="gamelogin2" class="button"   href="">New Name</a></p>
 </div>
</section>

<section id="popupName" class="hide">
   <div id="popup-bg">
    </div>
 <div id="popup-box">   
 <label for="firstName">Your Name :</label>
<input type="text" name="firstName" size="20" maxlength="40"  id="firstName" />

 **<p><a id="validatelogin" class="button"  href="">Validate</a></p> //this is the //button i want to change**
</div>
</section> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:24:07.620

`<br>`在输入字段后添加换行符 ( )：

```
<input type="text" name="firstName" size="20" maxlength="40"  id="firstName" /><br> 
```

有些人会争辩说`<br>`标签应该自动关闭：`<br />`，但这不是必需的。

要使其居中，请使用以下 CSS：

```
#validatelogin {
    width:100px;
    margin: 0 auto;
} 
```

将宽度设置为按钮的适当宽度；它必须修复才能`margin: 0 auto;`正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:15:50.263

你只需要 在你`input[type=text] { display:block; }` 的 `#validatelogin{ display:block; }` CSS 中。那将解决您的问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T19:37:14.587

我不确定我是否理解您的问题，但也许您可以在按钮之前使用它

```
<div class="both"></div> 
```

在 CSS 中

```
.both{
clear: both;
} 
```

# iphone - 带有 UIWebview 的 HTTP 帖子？

> ID：10286871
> 
> 赞同：0
> 
> 时间：2012-04-23T19:23:01.370
> 
> 标签：iphone, xcode, http, uiwebview

我对 Objective-C 编码很陌生，目前在大学学习。无论如何，我如何使用 UIWebview 执行 HTTP 发布，以便我可以在需要时更新视图，以便将不同的传单放在那里等。

我什至可能不需要使用 HTTP post 来执行此操作，但我正在为 Android 编码的合作伙伴坚持认为我可能需要！

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:41:36.800

要建立 HTTP 连接，请从`NSURLConnection`iOS[开发人员库中了解](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)

您首先要开始制作`NSURL`对象，然后`NSURLRequest`使用参数以及请求的 URL 制作您的对象。然后创建一个`NSURLConnection`并以异步（首选）或同步方式启动连接。如果您想要一个同步（阻塞）连接，请像这样初始化它

```
NSError *error;
NSURLResponse *responseHandler;
NSData *response = [myNSURLConnection sendSynchronousRequest:myNSURLRequest, returningResponse:&responseHandler,error:&error]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T20:19:34.453

我不知道你说的传单是什么意思。但是，如果您希望网页出现在 UIWebView 中，则不需要使用 HTTP 发布，只需将页面的 url 传递给 UIWebView，或者如果您已经有 html 内容等，您可以加载该内容直接地。

您可以直接发出 HTTP 请求，但您可能不需要。你想在 UIWebView 中显示什么？

# perforce - 仅分支特定文件夹并保留其目录结构

> ID：10286877
> 
> 赞同：1
> 
> 时间：2012-04-23T19:23:26.473
> 
> 标签：perforce

我正在尝试创建一个分支规范，它只从存储库中提取特定文件夹，但保留目录结构。

例如，在 repo 中，项目如下所示：

> 项目

```
->1.0
    ->Common
    ->ProjectSpecific
        ->Project1
            .Project specific files
        ->Project2
            .Project specific files

->2.0
    .
    .
    .
->_env
    .
    .
    .
->c
    .
    .
    .
->setup
    .
    .
    .
.general project files 
```

我要做的是为每个项目创建一个分支，该分支会拉下所有文件夹，除了在 1.0/Project 子目录中，它应该只拉下特定于该文件夹的项目文件夹。我猜这不可能完全使用分支规范（我已经尝试过并且总是以同一目录中的所有内容或其他问题结束）。我试过用客户端视图创建一个单独的代码行，映射项目下的每个目录，并确保只映射项目特定的文件夹，但它没有用，我真的很想避免创建一个新的每个项目的代码线。

他们是从分支规范中做到这一点的方法吗？或者，有没有办法将文件夹列入黑名单？然后我可以简单地映射整个项目目录并将我不感兴趣的项目列入黑名单。任何帮助将不胜感激。如果我不清楚，请告诉我，我会添加更多细节。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:26:17.150

您可以通过在分支规范中映射的行首添加减号来将文件夹列入黑名单。

有关详细信息，请参阅[有关视图的 Perforce 文档](http://www.perforce.com/perforce/doc.current/manuals/cmdref/o.views.html#1048336)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:11:14.613

是的，您可以使用分支规范来包含/排除您想要的内容。Streams 提供了一种更简单的方法来指定所需的文件。

# facebook - Facebook 使用来自不同域的代码

> ID：10286881
> 
> 赞同：2
> 
> 时间：2012-04-23T19:23:31.210
> 
> 标签：facebook, cross-domain, facebook-apps, facebook-app-requests

我正在用 js 创建一个小部件，它将在许多网站上实现，
Facebook 要求我给他们“我的域”，这样他们就会知道我已经过验证。
问题是该小部件将被许多网站使用，我不会将所有这些域手动列出到 Facebook。
如何让我的应用程序仅使用 js 在那些不同的网站上运行？（对于小部件）

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T20:12:33.483

您的小部件可能需要在托管在您自己的域上的 iFrame 中加载其 FB 代码。然后，您需要使用一些跨域/跨 iframe JS hack 来让您的系统与使用它的页面进行通信。（这是一个很好的资源...... [http://softwareas.com/cross-domain-communication-with-iframes](http://softwareas.com/cross-domain-communication-with-iframes)）这绝对是一种痛苦，但这是我能想到的唯一方法试图做。在这一点上可能有一些好的 JS 库可以使这更容易，但我没有立即意识到。

另一种选择是创建一堆 Facebook 应用程序，每个应用程序都属于不同的域。这也会在维护方面带来一些痛苦，但它会简化您需要编写的 JS 代码。这种方法在健壮性方面有一些好处——如果使用您的小部件的网站之一出现流氓行为并因任何原因被禁止应用程序，您的其他客户端网站将不会受到影响。

Facebook 曾经提供过一个“克隆应用程序”的工具，但现在我找不到了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:10:06.847

我用ajax做类似的事情。我 ajax 到一个 php 页面，并使用 php sdk 处理所有请求。跨域就好了。

示例：应请求在 facebook 上更新的最新专辑，并在 facebook 上显示链接到专辑的封面照片。

```
<div id="pagealbums"></div>
<script>
function showAlbums(){
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttpA=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttpA=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttpA.onreadystatechange=function()
  {
  if (xmlhttpA.readyState==4 && xmlhttpA.status==200)
    {
    document.getElementById("pagealbums").innerHTML=xmlhttpA.responseText;
    }
  };
  xmlhttpA.open("GET","http://anotherfeed.com/feed.albums.php?pageid=facebook&type=list",true);
  xmlhttpA.send(); 
}
showAlbums();
</script> 
```

# objective-c - 有没有办法更改 MFMailCompose 中的字体大小？

> ID：10286882
> 
> 赞同：0
> 
> 时间：2012-04-23T19:23:39.827
> 
> 标签：objective-c, ios

我想使用 MFMailComposeController 在我的电子邮件正文中发送一个文本文件。有没有办法改变字体大小？

```
NSString *file = [[NSString alloc] initWithContentsOfFile:fileName]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:53:01.957

看看`MFMailComposeViewController`'s`-setMessageBody:isHTML:`对于初学者。如果您指定的消息正文*是*HTML，那么您还可以包含在包含`<style>`部分中指定的 CSS 标记，用于您喜欢的任何字体样式等。

# c++ - Qt Designer 不加载我的自定义小部件插件

> ID：10286883
> 
> 赞同：6
> 
> 时间：2012-04-23T19:23:53.410
> 
> 标签：c++, qt, plugins, ubuntu, qt-designer

我正在阅读“使用 Qt4 进行 C++ GUI 编程”一书，并且已经达到了将自定义小部件与 Qt 设计器集成的主题。

我已经构建了那里概述的示例项目（图标编辑器插件），我得到了一个名为“libiconeditorplugin.so”的文件，并将其复制到“/usr/lib/qt4/plugins/designer/”。但是当我启动 Qt Creator 时，我在小部件框中看不到图标编辑器小部件。

与本书唯一不同的是，我从 .pro 文件中删除了 DESTDIR，因为它有 $QTDIR，并且 $QTDIR 没有在我的计算机中定义，我不知道它应该指向哪里。相反，我手动复制了 .so 文件。

我不确定我是否将插件复制到了正确的目录中，并且如果 libiconeditorplugin.so 是我需要复制的唯一文件，那么这本书对它的工作方式有点粗略。

我的操作系统是 Ubuntu，我已经用 apt-get 安装了 Qt Creator。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T18:06:52.303

原来我正在将 libiconeditorplugin.so 复制到错误的目录。我将它复制到“ **/usr/lib/qt4/plugins/designer/** ”，而Qt Designer 正在查看“ **/usr/lib/x86_64-linux-gnu/qt4/plugins/designer/** ”。

# iis - 只有 80 端口适用于网站

> ID：10286887
> 
> 赞同：2
> 
> 时间：2012-04-23T19:24:01.220
> 
> 标签：iis, iis-7, network-programming, network-protocols, windows-server-2008-r2

我托管了一个专用服务器（win2008 Standart）。IIS 已安装。有几个网站绑定到不同的端口（例如 SharepointServicesCentralAdministration 到 17012）。如果绑定到端口 80，每个网站都运行良好，但如果我更改端口，我会超时（通过互联网连接） - 本地运行良好。（硬件和软件防火墙已关闭。）

对于一些额外的测试 ac# TcpClient 实例正在侦听端口 12345。如果我尝试通过互联网连接，我会收到异常：连接尝试失败，因为连接方在一段时间后没有正确响应，或者建立连接失败，因为连接的主机有未能响应 xxx.xxx.xxx.xxx:12345 - 似乎是同样的问题......

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:28:04.183

您很可能已将端口 80 从与 Internet 接壤的路由器/防火墙转发到您的计算机。

您还需要在路由器/防火墙中转发其他端口，以使这些其他端口正常工作。

这也假设您已经打开了上面提到的本地防火墙端口，这也是必需的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T19:32:23.703

本地子网中的其他计算机是否可以连接？可能只允许本地子网。必须安装 ip-restrictions 所需的设置：[http ://www.hrzdata.com/node/46](http://www.hrzdata.com/node/46)

# text - 如何使 text-align:right、display:box 和 box-align:center 一起用于短文本？

> ID：10286891
> 
> 赞同：1
> 
> 时间：2012-04-23T19:24:06.043
> 
> 标签：text, css, centering, text-align

我想知道为什么短文本似乎不受 text-align 属性的影响，一旦应用了以下用于使文本居中的 CSS3 技术（请参阅答案）：

[垂直对齐块元素中的文本](https://stackoverflow.com/questions/5166574/vertical-align-text-in-block-element)

这是该示例的 JSFiddle，添加了 text-align:right 属性：http: [//jsfiddle.net/GqBAL/187/](http://jsfiddle.net/GqBAL/187/) （请注意，此处的文本已正确对齐，因为它很长）

但是一旦文本很短，它就不起作用了：http: [//jsfiddle.net/GqBAL/198/](http://jsfiddle.net/GqBAL/198/) 是否有某种“原因”？我错过了什么？我想使用该技术，但对于任何文本长度，而不仅仅是更长的。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:42:21.243

我不确定原因（很可能与将内容显示为框有关）。但是有一个解决方案：使用[`box-pack`property](http://www.w3schools.com/cssref/css3_pr_box-pack.asp)。添加

```
-webkit-box-pack: end;
-moz-box-pack: end; 
```

以你的例子[成功了](http://jsfiddle.net/GqBAL/202/)。

# java - 以编程方式实例化类具有 Spring 生命周期注释的对象

> ID：10286893
> 
> 赞同：0
> 
> 时间：2012-04-23T19:24:11.203
> 
> 标签：java, spring, unit-testing

我正在测试一组最终将用于在 Spring 上下文中创建 bean 的类。我正在使用 JUnit 进行测试。我想确保当这些类的实例在测试中以**编程**方式实例化时，生命周期方法和 @Required 设置器被正确调用。我知道我可以通过普通的旧 java 代理来做到这一点，但我想知道 Spring（或其他地方）中是否存在对我有帮助的特定工具。

我正在寻找类似的东西

```
X x = ???.newBeanInstance(X.class); 
x.setFoo(foo); 
x.setBar(bar);
x.$postConstruct(); 
... 
x.$preDestroy();
x = null; 
```

另一个不太理想的选项是只创建上下文的 XML 并使用它来初始化实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:49:09.187

如果你调出整个上下文，你可以使用`spring-test`包和它的`@ContextConfiguration`.

如果你想手动处理事情，你自己（几乎）。如果你有字段注入，你可以`ReflectionTestUtils`用来设置依赖。但除此之外，你：

*   实例化对象`new X()`
*   调用设置器
*   调用初始化方法（你应该知道它是哪一个）
*   最后调用销毁方法

# scala - 在 Scala 的抽象泛型类中初始化和使用字段

> ID：10286898
> 
> 赞同：1
> 
> 时间：2012-04-23T19:24:47.490
> 
> 标签：scala, generics, abstract

我在scala中有这样的东西：

```
abstract class Point[Type](n: String){
    val name = n
    var value: Type = _
} 
```

到现在为止还挺好。问题出现在扩展 Point 的类中。

```
case class Input[Type](n:String) extends Point(n){
    def setValue(va: Type) = value = va
} 
```

在线`setValue`我有这个问题：

```
[error]  type mismatch;
[error]  found   : va.type (with underlying type Type)
[error]  required: Nothing
[error]   def setValue(va: Type) = value = va 
```

我尝试过初始化，`null`但`null.asInstanceOf[Type]`结果是一样的。

如何初始化值以便可以在 setValue 中使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T19:33:53.857

您应该使用泛型类型指定`Input`实现，因为现在，由于没有指定，它被认为是（我猜编译器无法从方法中推断出它）。因此，您必须执行以下操作：`Point``Type``Nothing``setValue`

```
case class Input[Type](n:String) extends Point[Type](n){
  def setValue(va: Type) = value = va
} 
```

**更多信息**

我为编译错误回答了这个问题（它确实在 scala 2.9.0.1 上编译）。此外，我将此案例类视为现有类型的实现，例如“Int”。在抽象类中使用 _ 当然是一个坏主意，但是并不禁止，但是 _ 并不总是 null，它是默认值，例如：`var x:Int = _`将值分配`0`给`x`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T20:42:44.947

尝试以下操作：

包输入抽象

```
abstract class Point[T](n:String){
  def value: T
  val name = n
}

case class Input[T](n:String, value:T) extends Point[T](n)

object testTypedCaseClass{
  def test(){
    val foo = Input("foo", "bar")
    println(foo)
  }
} 
```

一个简单的应用程序来检查它是否有效：

```
import inputabstraction._

object TestApp extends Application{
  testTypedCaseClass.test()  
} 
```

**解释**

你犯的第一个错误是`case class Input[Type](n:String) extends Point(n){`。Point 是一个类型化的类，因此当您调用超类构造函数时，`extends Point(n)`您需要指定`Point`. 这样做是这样的： `extends Point[T](n)`，其中 T 是您计划使用的类型。

第二个错误是您在此处定义和声明 value:T: `var value: Type = _`。在这个语句中，`_`是一个值。它的值为`Nothing`。`Point[T]`scala 编译器由此推断出`Point[Nothing]`. 因此，当您尝试将其设置为`setValue`方法主体中的类型时，您必须将其设置为`Nothing`，这可能不是您想要的。如果您尝试将其设置为除 之外的任何内容`Nothing`，您将从上面得到类型不匹配，因为`Nothing`由于您使用了`_`.

第三个错误是使用`var`代替`val`或`def`。 `val`and`def`可以互换覆盖，这意味着子类型可以用`val`or覆盖`def`，scala 编译器会为你解决这个问题。将 val 定义为`def`在抽象类和特征中使用的函数是最佳实践，因为子类型构造函数的初始化顺序很难正确处理（编译器如何决定如何从其超类型构造类有一个[算法](http://jim-mcbeath.blogspot.com/2009/08/scala-class-linearization.html#rules)） . TL#DR === 在超类型中使用 def。案例类参数是自动生成的`val`字段，由于您正在扩展一个点，因此将创建一个 val 值字段，该字段将覆盖`Point[T]`.

你可以摆脱这一切`Type`|| `T`Scala 中的抽象是因为类型推断和抽象的事实`Point`，因此可以通过 val 扩展值。

像这样进行依赖注入的首选方法是[cake pattern](http://jonasboner.com/2008/10/06/real-world-scala-dependency-injection-di/)，但我提供的这个示例适用于您的用例。

# postgresql - 以指定的距离限制和顺序沿线串查找最近的点

> ID：10286899
> 
> 赞同：11
> 
> 时间：2012-04-23T19:24:51.293
> 
> 标签：postgresql, postgis

我有这样的问题，如果有人可以帮助我，我会很好。我有带有 GIST 索引的积分表。这些点不会随时间改变。

我想获取一些给定线串附近的点。示例：假设线串是道路，点是道路沿线的 poi。我想获取距离给定道路 5 公里的 poi。我想以正确的顺序（沿路的驾驶顺序）获取这些 pois。看图片：

![图片](../Images/252b7915ee222d462aa1ba25696f6ec7.png)

对于从点 1 到 5 的给定道路，我想获取距离道路最大 5 公里的 POI，并按照从点 1 到 5 的顺序沿道路获取。所以结果应该是：

```
POI_ID
1
5
6
8
9
10
12
13 
```

这应该告诉我在沿路旅行时可以以最低成本参观哪些 POI。

有人对如何使用 postgres 和 postgis 有一些想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-24T00:31:10.797

假设您的几何列`geom`在表`road`(LINESTRING) 和`poi`(POINT) 中使用了米的投影 SRID，则查找道路 5 公里范围内的所有 POI（其中 id = 123）的查询应该类似于：

```
SELECT poi.*, ST_Distance(road.geom, poi.geom)/1000.0 AS distance_km
FROM road, poi
WHERE road.id = 123 AND ST_DWithin(road.geom, poi.geom, 5000.0)
ORDER BY ST_LineLocatePoint(road.geom, poi.geom),
         ST_Distance(road.geom, poi.geom); 
```

第一`ORDER`部分`ST_LineLocatePoint`使用 0.0 到 1.0 之间的分数，具体取决于点沿 LINESTRING 的位置。如果道路的方向是“错误的方向”，则追加`DESC`以颠倒顺序。第二个 ORDER 部分基于距离，如果该点稍微超过 LINESTRING 的开始/结束（`ST_LineLocatePoint`分别返回 0.0 或 1.0），则可以使用该距离。

如果您使用`geography`具有 Long/Latitude 值的类型，此查询也可能有效，因为它会自动计算米，而不是度数。查看文档了解更多信息：

*   [`ST_Distance`](https://postgis.net/docs/ST_Distance.html)
*   [`ST_DWithin`](https://postgis.net/docs/ST_DWithin.html)
*   [`ST_LineLocatePoint`](https://postgis.net/docs/ST_LineLocatePoint.html)（或`ST_Line_Locate_Point`旧版本的 PostGIS）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T20:56:11.797

听起来您可以从去年夏天的 PostgreSQL 9.1 版本中的 KNN-GIST 功能中受益，并受到 PostGIS 2.0 版的支持。

[http://blog.opengeo.org/2011/09/28/indexed-nearest-neighbour-search-in-postgis/](http://blog.opengeo.org/2011/09/28/indexed-nearest-neighbour-search-in-postgis/)

# php - 贝宝账单协议 ID 不来

> ID：10286900
> 
> 赞同：2
> 
> 时间：2012-04-23T19:24:54.930
> 
> 标签：php, paypal, paypal-subscriptions

我正在使用可变金额的快速结账处理贝宝定期付款。

我几乎已经做了所有事情。我正在遵循本指南：

[https://www.x.com/developers/paypal/documentation-tools/how-authorize-and-run-reference-transaction-express-checkout](https://www.x.com/developers/paypal/documentation-tools/how-authorize-and-run-reference-transaction-express-checkout)

在第三步之后，我得到了这个回复：

```
[TIMESTAMP] => 2012-05-02T20:33:39Z
[CORRELATIONID] => 6361035da7d80
[ACK] => Failure
[VERSION] => 86
[BUILD] => 2840849
[L_ERRORCODE0] => 11455
[L_SHORTMESSAGE0] => Buyer did not accept billing agreement
[L_LONGMESSAGE0] => Buyer did not accept billing agreement
[L_SEVERITYCODE0] => Error 
```

甚至第 4 步也为我返回了成功，但我在这里没有收到 BILLINGAGREEMENTID。
我不知道这里有什么问题。请帮我解决一下这个。

第 4 步的响应是：

```
 Array
(
    [TOKEN] => EC-61326512J28943643
    [SUCCESSPAGEREDIRECTREQUESTED] => false
    [TIMESTAMP] => 2012-04-23T20:15:29Z
    [CORRELATIONID] => 9604631d916a1
    [ACK] => Success
    [VERSION] => 86
    [BUILD] => 2808426
    [INSURANCEOPTIONSELECTED] => false
    [SHIPPINGOPTIONISDEFAULT] => false
    [PAYMENTINFO_0_TRANSACTIONID] => 4N241225R9256962J
    [PAYMENTINFO_0_TRANSACTIONTYPE] => expresscheckout
    [PAYMENTINFO_0_PAYMENTTYPE] => instant
    [PAYMENTINFO_0_ORDERTIME] => 2012-04-23T20:15:27Z
    [PAYMENTINFO_0_AMT] => 11.00
    [PAYMENTINFO_0_FEEAMT] => 0.62
    [PAYMENTINFO_0_TAXAMT] => 0.00
    [PAYMENTINFO_0_CURRENCYCODE] => USD
    [PAYMENTINFO_0_PAYMENTSTATUS] => Pending
    [PAYMENTINFO_0_PENDINGREASON] => paymentreview
    [PAYMENTINFO_0_REASONCODE] => None
    [PAYMENTINFO_0_PROTECTIONELIGIBILITY] => Ineligible
    [PAYMENTINFO_0_PROTECTIONELIGIBILITYTYPE] => None
    [PAYMENTINFO_0_SECUREMERCHANTACCOUNTID] => EUS59DJENWC3E
    [PAYMENTINFO_0_ERRORCODE] => 0
    [PAYMENTINFO_0_ACK] => Success
) 
```

我已经为此工作了至少 4-5 天。

不使用步骤 3 后的响应：

```
 [TOKEN] => EC-6MD78480W9369745J
    [SUCCESSPAGEREDIRECTREQUESTED] => false
    [TIMESTAMP] => 2012-05-02T20:38:13Z
    [CORRELATIONID] => 72306d7db8c1b
    [ACK] => Success
    [VERSION] => 86
    [BUILD] => 2840849
    [INSURANCEOPTIONSELECTED] => false
    [SHIPPINGOPTIONISDEFAULT] => false
    [PAYMENTINFO_0_TRANSACTIONID] => 6EG31415FF2050208
    [PAYMENTINFO_0_TRANSACTIONTYPE] => expresscheckout
    [PAYMENTINFO_0_PAYMENTTYPE] => instant
    [PAYMENTINFO_0_ORDERTIME] => 2012-05-02T20:38:11Z
    [PAYMENTINFO_0_AMT] => 11.00
    [PAYMENTINFO_0_FEEAMT] => 0.62
    [PAYMENTINFO_0_TAXAMT] => 0.00
    [PAYMENTINFO_0_CURRENCYCODE] => USD
    [PAYMENTINFO_0_PAYMENTSTATUS] => Pending
    [PAYMENTINFO_0_PENDINGREASON] => paymentreview
    [PAYMENTINFO_0_REASONCODE] => None
    [PAYMENTINFO_0_PROTECTIONELIGIBILITY] => Ineligible
    [PAYMENTINFO_0_PROTECTIONELIGIBILITYTYPE] => None
    [PAYMENTINFO_0_SECUREMERCHANTACCOUNTID] => EUS59DJENWC3E
    [PAYMENTINFO_0_ERRORCODE] => 0
    [PAYMENTINFO_0_ACK] => Success 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-05T14:46:30.497

如果您使用的是沙盒，则需要为沙盒帐户打开参考交易。我认为与贝宝的计费协议是参考交易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T07:23:44.417

在步骤 3 中，如果您已经在步骤 1 中指定**billingtype = MerchantInitiatedBilling** ，则无需调用方法**CreateBillingAgreement 。**

 **请尝试此操作并更新响应。

希望这可以帮助。**

# python - python Popen：如何阻止 grep 命令的执行，直到 grep 的内容准备好？

> ID：10286903
> 
> 赞同：1
> 
> 时间：2012-04-23T19:25:41.863
> 
> 标签：python, grep, blocking, popen

我已经在python中与Popen战斗了几天，所以我决定把我所有的疑问放在这里，希望所有这些都可以被python专家澄清。

最初，我使用 Popen 执行命令并 grep 结果（作为一个使用管道的命令，例如`xxx | grep yyy`），`shell=False`正如您可以想象的那样，这不太好用。按照[这篇](http://www.velocityreviews.com/forums/t725178-how-do-subprocess-popen-ls-grep-foo-shell-true-withshell-false.html)文章中的指南，我将代码更改为以下内容：

```
checkCmd = ["sudo", "pyrit", "-r", self.capFile, "analyze"]
checkExec = Popen(checkCmd, shell=False, stdout=PIPE, stderr=STDOUT)
grepExec = Popen(["grep", "good"], stdin=checkExec.stdout, stdout=PIPE)
output = grepExec.stdout.readline()
output = grepExec.communicate()[0] 
```

但是我意识到`checkExec`运行速度很慢，并且由于 Popen 是非阻塞的，因此`grepExec`总是在显示任何结果之前执行`checkExec`，因此 grep 输出将始终为空白。我怎样才能推迟执行`grepExec`直到`checkExec`完成？

1.  在我程序的另一个 Popen 中，我试图在后面保持一个服务打开，所以我使用一个单独的线程来执行它。完成所有任务后，我通知该线程退出，并显式调用 Popen.kill() 停止服务。但是，我的系统最终会出现一个没有收割的僵尸进程。不知道有没有什么好办法可以在后台线程完成后清理掉所有的东西？

2.  Popen.communicate()[0] 和 Popen.stdout.readline() 有什么区别？我可以使用循环来继续读取它们的输出吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T19:40:32.587

如果您这样做，您的示例将起作用：

```
checkCmd = ["sudo", "pyrit", "-r", self.capFile, "analyze"]
checkExec = Popen(checkCmd, shell=False, stdout=PIPE, stderr=STDOUT)
grepExec = Popen(["grep", "good"], stdin=checkExec.stdout, stdout=PIPE)

for line in grepExec.stdout:
    # do something with line 
```

当您想向进程提供一些输入并同时读取进程的 stdout、stderr 上的所有输出时，您可以使用通信。这可能不是您想要的。`communicate`更适用于您想要启动应用程序、向其提供所需的所有输入并读取其输出的情况。

正如其他答案指出的那样，您可以`shell=True`在调用子进程时使用创建管道，但我更喜欢的替代方法是利用 python 而不是设置管道：

```
checkCmd = ["sudo", "pyrit", "-r", self.capFile, "analyze"]
checkExec = Popen(checkCmd, shell=False, stdout=PIPE, stderr=STDOUT)
for line in checkExec.stdout:
    if line.find('good') != -1:
        do something with the matched line here 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T19:32:15.933

使用 subprocess 而不是 popen，然后您可以使用完整的命令行大大简化事情。

[http://docs.python.org/library/subprocess.html](http://docs.python.org/library/subprocess.html)

例如。

```
import subprocess as sub
f = open('/dev/null', 'w')
proc = sub.call("cat file | grep string", executable="/bin/bash", shell=True) 
```

# android - Android中没有css标签的文本

> ID：10286908
> 
> 赞同：1
> 
> 时间：2012-04-23T19:26:00.317
> 
> 标签：android, html, css

我有一个电子邮件正文，它有 html、css 标签，我试图只检索 Android 中的正文文本。

我用了;

```
String.valueOf(Html.fromHtml(body); 
```

这给了我带有 css 标签的文本。我应该怎么做才能只检索文本？结果保存在字符串中

通常（当我第一次收到 body 时）；

```
<html>
<head>
<style><!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Tahoma
}
--></style></head>
<body class='hmmessage'><div dir='ltr'>
TEXTONE<div>TEXTTWO</div>                     </div></body>
</html> 
```

String.valueOf(Html.fromHtml(body); 之后

```
<!-- .hmmessage P { margin:0px; padding:0px } body.hmmessage { font-size: 10pt; font-family:Tahoma } -->

TEXTONE
TEXTTWO 
```

我只想接收 TEXTONE 和 TEXTWO

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:26:22.803

`fromHtml()`仅支持常见的 HTML 标签。HTML 注释不被视为标签，并被忽略。`fromHtml()`可以在[此处](http://commonsware.com/blog/Android/2010/05/26/html-tags-supported-by-textview.html)找到支持的标签列表。

以下代码应该可以解决您的问题：

```
s = String.valueOf(Html.fromHtml(body);
s = s.replaceAll("(?s)<!--.*?-->", ""); 
```

# c - 将 HEX 值转换为（字符、字符串、字母和数字）

> ID：10286910
> 
> 赞同：1
> 
> 时间：2012-04-21T08:12:21.150
> 
> 标签：c

我正在用 C 语言编写 AVR 微控制器 Atmega16。

我不懂 C，我把时间花在 PHP 上编程，而我只是不懂 C。

我也不明白如何在这里发布源代码。如果有人知道，请修复我的标签。

我的问题是，我有这个功能：

```
unsigned char
convert_sn_to_string (const unsigned char *SN_a /* IDstring */      )
{
  unsigned char i;

  for (i = 0; i < 6; i++)   //6 byte az SN 
    {

 if(SN_a[i]==0x00)
     {
     Send_A_String("00");
     }

    }

  return 1;
} 
```

在 for 循环中，我可以通过十六进制访问 6 字节值。

在变量 SN_A 里面我可以有

```
SN_A[0]=0x00;
SN_A[1]=0xFF;
SN_A[3]=0xAA;
SN_A[4]=0x11;
(...) 
```

和类似的。它可以是从 00 到 FF。

我需要的是将该代码转换为 12 个字符的字符串。如果我有

```
SN_A[0]=0x00;
SN_A[1]=0xFF;
SN_A[3]=0xAA;
SN_A[4]=0x11;
(...) 
```

我想得到输出

```
new[0]=0;
new[1]=0;
new[2]=A;
new[3]=A;
new[4]=1;
new[5]=1;
(...) 
```

等到 12，因为我想将 6（双）AA 值更改为分开。

那么我可以做一个循环

```
for i=0 i<12 i++
{
  do_something_with_one_letter(new[i]);
} 
```

现在我可以使用这些值，我可以将它们发送到显示，或者我需要的任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T08:32:55.747

十六进制值只是写入整数的另一种方式。0xFF == 255。

所以，如果你想“拆分”它们，你首先需要决定你想如何拆分它们。从本质上讲，这决定了将拆分值填充到新数组中的确切方式。

要拆分一个值，可以使用这样的东西：

```
hexval = 0x1A
low_nybble = hexval & 0xF
high_nybble = (hexval >> 4) & 0xF 
```

您现在有 1 个存储在 high_nybble 中，10 个存储在 low_nybble 中。

# caching - 分布式缓存算法/教程

> ID：10286916
> 
> 赞同：2
> 
> 时间：2012-04-23T19:26:27.610
> 
> 标签：caching

了解`caching frameworks/ caching algorithms`工作原理的最佳机制是什么，是否有任何书详细介绍了以下主题。

*   缓存命中
*   缓存未命中
*   LFU
*   LRU
*   LRU2
*   两个队列
*   弧
*   MRU
*   先进先出
*   第二次机会
*   分布式缓存

# java - 代码中的 ArrayList 问题，有什么建议吗？

> ID：10286927
> 
> 赞同：0
> 
> 时间：2012-04-23T19:27:25.787
> 
> 标签：java

我在将 ISBN 号更改为书名时遇到问题

开始打印 ISBN、作者、书名和图书级别：

```
0201403765 Jan Skansholm    Ada 95 from the Beginning   100
0202535665 M. Ben-Ari           Software Engineering            25
034565976X Michael Feldman  Program Construction            12
080539057X M.A. Weiss           Data Structures             30
0805645782 Ken Arnold           Java for Programmers            10
0905297568 A. Badone            Chaos Theory                    15 
```

打印出内容`transactions.txt`：

```
0201403765     -55
0201403765       2
0202535665      10
0202535665     -28
034565976X      -7
080539057X     -15
0905297568      13
0905297568      -5 
```

所以基本上我需要做的就是将 ISBN 更改为书名（如果匹配），如下所示：

```
Java from the Beginning -55
Java from the Beginning   2
Software Engineering     10
Software Engineering    -28
Program Construction     -7
Data Structures -15
Chaos Theory     13
Chaos Theory     -5 
```

我遇到的问题是在下面的代码中标记为 1，真的不确定如何检查 isbn 是否匹配，如果是，如何检查什么标题与 isbn 匹配并将其写出来，我认为我的问题是数组列表（我应该做一个第三个数组列表）或者只是把所有东西都变成数组，任何建议都可以，干杯！！！！顺便说一句，1 完全是错误的....

```
import java.util.*;  
import java.io.*;
class inventory{ 
    static void intial(){
        try{
            RandomAccessFile in = new RandomAccessFile("books.dat","r");
            ArrayList<String> list1=new ArrayList<String>();
            String author ,title , isbn;
            int level=0;
            while(in.getFilePointer()<in.length()){
                author = in.readUTF();  // author, at most 20 characters
                title = in.readUTF();   // title, at most 40 characters
                isbn = in.readUTF();    // ISBN
                level = in.readInt();   // level, i.e. copies in stock (>=0)
            //System.out.printf("%5d", isbn+author+title+level);
            System.out.println(isbn+" "+author+" "+title+" "+level);
            list1.add(title);
            list1.add(isbn);
            //list1.add(level);
        }
        in.close();
        System.out.println(" ");
        String isbn2;
        int level2=0;
        //try{
            Scanner out = new Scanner(new File ("transactions.txt"));
            ArrayList<String> list2=new ArrayList<String>();
            while(out.hasNextLine()){
                isbn2 = out.next();
                level2 = out.nextInt();
                System.out.println(isbn2 +" "+level2);
                list2.add(isbn2);
                //list2.add(level2);
            }
            out.close();

     1)     for (isbn: list1){
            for(isbn2: list2){
                if(isbn.contains(isbn2)){
                    System.out.println(title+" "+level);
                }
            }   
        }
        }
        catch(IOException f){
            System.out.println("file error");
            f.printStackTrace();
        }
    }

}
class BookShop{
    public static void main(String[]args){
        inventory x = new inventory();
        x.intial(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T19:38:52.487

我会创建一个对象来保存每本书，如下所示：

```
class Book {
    public final String isbn;
    public final String title;
    public final String author;
    public final int level;

    public Book(String isbn, String title, String author, int level) {
        this.isbn = isbn; this.title = title; this.author = author; this.level = level;
    }
} 
```

并用 Book 对象填充 ArrayList。这样一本书的所有内容都在一个地方，而不是需要并行数组。

（我编写此类的方式是不可变的，因为一旦从输入文件中读取对象，您就没有任何理由更新对象。如果这是 Python 或 Haskell，我们将只使用元组而无需仪式，但对于 Java，我们没有这个选项。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T19:41:00.387

首先创建一个 Book 对象来存储您的图书数据。

```
public Book{
    private String ISBN ="";
    private String title="";
    private String author="";
    private int level;
    public Book(String ISBN, String title,String author, int level){
        this.ISBN=ISBN;
        this.title=title;
        this.author=author;
        this.level=level;
    }
    public String getTitle(){
        return title;
    }
    public String getISBN(){
        return ISBN;
    }
    public String getAuthor(){
        return author;
    }
    public int getLevel(){
        return level;
    }
} 
```

将 Book 对象添加到 ArrayList。

```
ArrayList<Book> bkList = new ArrayList<Book>();
bkList.add(new Book('ISBN','Title','Author')); 
```

使用 get() 方法获取图书数据。

```
Book tempBook;
for (int x=0;x<bkList.Size();x++){
    tempBook=bkList.get(x);
    System.out.println(tempBook.getTitle()+" "+tempBook.getLevel());
} 
```

# c++ - freopen 后，WriteFile 到 stdout 失败

> ID：10286928
> 
> 赞同：0
> 
> 时间：2012-04-23T19:27:27.583
> 
> 标签：c++, windows, writefile, freopen

我写了以下代码：

```
int fd = _dup(fileno(stdout));
FILE* tmp = freopen("tmp","w+",stdout);
HANDLE out = GetStdHandle(STD_OUTPUT_HANDLE);
if (out == INVALID_HANDLE_VALUE){
      //error
}
else if (out == NULL) {
      //error
}
else {
   WriteFile(out, "num", sizeof("num"), NULL, NULL);
 } 
```

在最后一行我得到一个断言“ `Unhandled exception...:Access violation writing location 0x000000`”可能是什么问题以及解决方法？

谢谢你。

PS：由于项目限制我不能使用freopen

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T19:45:55.583

WriteFile 的最后两个参数中只有一个可以为 NULL，另一个必须是有效指针。

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa365747.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365747.aspx)

在您的情况下，您可能想要使用 lpNumberOfBytesWritten。

```
DWORD written;
WriteFile(out, "num", sizeof("num"), &written, NULL); 
```

# macos - 无法在 Mac OS X 上为 geodjango 创建空间数据库

> ID：10286929
> 
> 赞同：0
> 
> 时间：2012-04-23T19:27:32.763
> 
> 标签：macos, postgresql, postgis, geodjango

我正在尝试为 MacOS X 安装 PostGIS，直到现在这就是我得到的

```
PostGIS is now configured for x86_64-apple-darwin10.8.0

 -------------- Compiler Info ------------- 
  C compiler:           gcc -g -O2
  C++ compiler:         g++ -g -O2

 -------------- Dependencies -------------- 
  GEOS config:          /usr/local/bin/geos-config
  GEOS version:         3.3.3
  PostgreSQL config:    /usr/local/pgsql/bin/pg_config
  PostgreSQL version:   PostgreSQL 9.1.3
  PROJ4 version:        48
  Libxml2 config:       /usr/bin/xml2-config
  Libxml2 version:      2.7.3
  JSON-C support:       yes
  PostGIS debug level:  0
  Perl:                 /usr/bin/perl

 --------------- Extensions --------------- 
  PostGIS Raster:       disabled
  PostGIS Topology:     enabled

 -------- Documentation Generation -------- 
  xsltproc:             /usr/bin/xsltproc
  xsl style sheets:     
  dblatex:              
  convert:              
  mathml2.dtd:          http://www.w3.org/Math/DTD/mathml2/mathml2.dtd 
```

这是否意味着 PostGIS 现在已安装？为什么禁用 PostGIS 栅格？

另外，当我按照[教程](https://docs.djangoproject.com/en/dev/ref/contrib/gis/install/#creating-a-spatial-database-template-for-postgis)进行操作时，我收到此错误

```
createdb -E UTF8 template_postgis
createdb: could not connect to database postgres: FATAL:  role "root" does not exist 
```

然后我检查了命令

```
sudo su - postgres 
```

它返回 1`echo $?`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:44:02.303

这意味着 PostGIS 已配置，如第一行所述。

通常，您继续使用`make`and `make install`。完成此操作后，您将准备好 PostGIS 库，但您必须在数据库级别创建 PostGIS 支持函数，如下所示：`psql -c spatial_ref_sys.sql`

我建议您也咨询[官方文档](http://postgis.refractions.net/documentation/manual-1.5/ch02.html)。

您的错误消息意味着您正在尝试使用用户 / 连接到那里不存在的数据库。默认情况下，PostgreSQL 工具将尝试与您当前的 unix 用户匹配的用户名/数据库，这似乎是`root`.

请记住，在`root`账户下工作是一种非常糟糕的做法。

# iphone - 如何多次发送相同的 Twitter 消息？

> ID：10286932
> 
> 赞同：0
> 
> 时间：2012-04-23T19:27:37.857
> 
> 标签：iphone, ios, twitter

我正在尝试将 iOS 5 Twitter API 添加到我的应用程序中，而 Twitter 让我对第二次发送相同的直接消息感到厌烦。

> ```
> Twitter response, HTTP response: 403
> Response Data
> {"error":"There was an error sending your message: Whoops! You already said that.","request":"\/1\/direct_messages\/new.json"} 
> ```

有没有办法解决这个问题，所以我可以测试我的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:41:21.197

您为什么不尝试发送随机消息或（字符串化）时间？它在每个场合都是独一无二的，它不需要你破解/解决/以其他方式违反 Twitter 的这个限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-10T00:21:26.583

如果文本从不完全相同，您可以多次推文相同的消息。例如，[1001tweets](http://www.1001tweets.com/)可以帮助您多次发布一些推文。为此，它只保留包含链接的推文，并使用 URL 缩短器对其进行更改。

# objective-c - 子视图中的手势识别器出现问题

> ID：10286938
> 
> 赞同：1
> 
> 时间：2012-04-23T19:28:09.920
> 
> 标签：objective-c, ios, uigesturerecognizer

我有一个相当基本的问题，我环顾四周（这里，谷歌等）并没有找到解决方案：

在我的视图控制器中`viewDidLoad`，我有这个：

```
UILongPressGestureRecognizer *longPress = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(myfunc:)];

//I have a UIScrollView named "containerView"
//here's some code that creates an UIView in a variable named "myView"

//this works fine, I can see "myView" when I run it
[containerView addSubview:myView];

[myView addGestureRecognizer:longPress]; 
```

然后我在同一个类中有这个函数：

```
- (void)myfunc:(UIRotationGestureRecognizer *)recognizer 
{
    NSLog(@"hola!"); //never runs
} 
```

`NSLog`永不运行的电话。我究竟做错了什么？

**编辑**

一些额外的信息：似乎没有触摸事件被发送到子视图。但是，我尝试在 UIScrollView 中添加一个带有按钮的 UIView，并且按钮接收到触摸事件就好了，所以问题仅在于以编程方式添加的子视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T21:01:32.370

奇怪的是，在 UIScrollView 中添加一个“容器”UIView，然后在该容器中添加其他子视图，使其工作。现在触摸事件被发送到子视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T20:46:18.370

[超级视图如何在其任何子视图之前拦截触摸序列？](https://stackoverflow.com/questions/1673903/how-can-a-superview-interecept-a-touch-sequence-before-any-of-its-subviews)

TLDR：

```
[containerView setCanCancelContentTouches:NO]; 
```

就像您将手势识别器添加到滚动视图一样执行此操作。

也调查

```
[containerView setDelaysContentTouches:NO]; 
```

如果上述行为不完全正确。

欲了解更多信息：http: [//developer.apple.com/library/ios/#documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T08:32:27.640

我认为在 myFunc 你必须做这样的事情：

```
switch (reconiger.state)
{
    case UIGestureRecognizerBegin:
      //Do something when start recognizer
      break;
    case UIGestureRecognizerEnd:
      //Do something when end recognizer
      break;
} 
```

# reporting-services - oracle多值参数错误

> ID：10286940
> 
> 赞同：0
> 
> 时间：2012-04-23T19:28:16.247
> 
> 标签：reporting-services, multivalue

我在 SSRS 2008 中使用以下查询，当我单击***Report Wizard中******设计查询***窗口上的“下一步”按钮时出现错误。

 *“保存查询设计方法时出错。ORA-00911：无效字符”

```
 SELECT E.EMPID, E.NAME
    FROM EMP E
   WHERE E.EMPID IN (SELECT COLUMN_VALUE FROM TABLE(CAST(SPLIT(:I_IDS) AS TEMP_TBL))); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T09:48:35.063

您是否尝试过简化 WHERE 子句以使用条件：

```
WHERE E.EMPID IN (:I_IDS); 
```

- 在您的查询中？（根据我的经验，这不适用于普通 SQL 客户端中的多个值，但适用*于*SSRS 数据集。）*

# ruby-on-rails - 耙资产预编译错误

> ID：10286942
> 
> 赞同：0
> 
> 时间：2012-04-23T19:28:34.517
> 
> 标签：ruby-on-rails, rake, asset-pipeline

```
1x-193-157-255-5:HelseBackEnd ola$ rake assets:precompile
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby /usr/bin/rake       assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets
rake aborted!
syntax error on line 11, col 0: `--- '

Tasks: TOP => environment
(See full trace by running task with --trace)
rake aborted!
Command failed with status (1): [/System/Library/Frameworks/Ruby.framework/...]

Tasks: TOP => assets:precompile
(See full trace by running task with --trace)
1x-193-157-255-5:HelseBackEnd ola$ rake assets:precompile --trace
** Invoke assets:precompile (first_time)
** Execute assets:precompile
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby /usr/bin/rake     assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace
** Invoke assets:precompile:all (first_time)
** Execute assets:precompile:all
** Invoke assets:precompile:primary (first_time)
** Invoke assets:environment (first_time)
** Execute assets:environment 
** Invoke environment (first_time)
** Execute environment
rake aborted!
syntax error on line 11, col 0: `--- '
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/yaml.rb:133:in  `load'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/yaml.rb:133:in `load'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/yaml.rb:144:in `load_file'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/yaml.rb:143:in `open'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/yaml.rb:143:in `load_file'
/Library/Ruby/Gems/1.8/gems/actionpack-3.2.3/lib/sprockets/railtie.rb:42
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `instance_exec'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `run'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:55:in `run_initializers'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `each'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `run_initializers'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/application.rb:136:in `initialize!'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `send'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `method_missing'
 /Users/ola/Documents/Coding/HelseBackEnd/config/environment.rb:5
 /Library/Ruby/Gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
 /Library/Ruby/Gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
 /Library/Ruby/Gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'
 /Library/Ruby/Gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
 /Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/application.rb:103:in `require_environment!'
 /Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/application.rb:292:in `initialize_tasks'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `execute'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
  /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `invoke_with_call_chain'
 /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Library/Ruby/Gems/1.8/gems/actionpack-3.2.3/lib/sprockets/assets.rake:93
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `execute'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `invoke_with_call_chain'
 /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:176:in `invoke_prerequisites'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `each'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `invoke_prerequisites'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:157:in `invoke_with_call_chain'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Library/Ruby/Gems/1.8/gems/actionpack-3.2.3/lib/sprockets/assets.rake:60
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `execute'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `invoke_with_call_chain'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `run'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/bin/rake:33
 /usr/bin/rake:19:in `load'
 /usr/bin/rake:19
Tasks: TOP => environment
 rake aborted!
 Command failed with status (1): [/System/Library/Frameworks/Ruby.framework/...]
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/file_utils.rb:53:in    `create_shell_runner'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `call'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `sh'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `sh'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/file_utils.rb:80:in `ruby'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `ruby'
/Library/Ruby/Gems/1.8/gems/actionpack-3.2.3/lib/sprockets/assets.rake:12:in `ruby_rake_task'
/Library/Ruby/Gems/1.8/gems/actionpack-3.2.3/lib/sprockets/assets.rake:21:in `invoke_or_reboot_rake_task'
/Library/Ruby/Gems/1.8/gems/actionpack-3.2.3/lib/sprockets/assets.rake:29
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `execute'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `invoke_with_call_chain'
 /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
 /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `run'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/bin/rake:33
/usr/bin/rake:19:in `load'
/usr/bin/rake:19
Tasks: TOP => assets:precompile
1x-193-157-255-5:HelseBackEnd ola$ 
```

这是我的代码的问题，还是核心更深？我不知道第 11 行的哪个文件运行有问题。

# javascript - 在动态更改之前，我如何告诉 jquery 将 html() 元素恢复为其原始值？

> ID：10286953
> 
> 赞同：2
> 
> 时间：2012-04-23T19:29:36.723
> 
> 标签：javascript, jquery, html

我有一个 div，我曾经`html()`更改过它的内容。我正在做一个“取消”按钮，我想`html()`回到原来的值。

有没有一种有效的方法来做到这一点？我试图避免再次使用 html() 整个代码，因为它看起来不太好并且可能不是最佳实践。

提前非常感谢。问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:31:26.550

```
// store the old content
var myOldContent = $("#cancelbutton").html();

// change content
$("#cancelbutton").html(someNewContent);

// and change it back
$("#cancelbutton").html(myOldContent); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T19:37:21.217

如果可能的话，不要使用`.html`这种方式切换内容——使用两个相邻的、几乎相同的元素，一个使用旧 HTML，一个使用新 HTML，并创建一个`hidden`CSS 类`display: none`并将其分配给第二个元素。`hidden`然后同时在两个元素上切换此类。

HTML：

```
<button class="cancel" id="cancel-original">Cancel</button>
<button class="cancel hidden" id="cancel-second">Cancelling...</button> 
```

CSS：

```
.hidden {
    display: none;
} 
```

查询：

```
$('button.cancel').click(function() {
    $('button.cancel').toggleClass('hidden'); // toggles both at once
}); 
```

[http://jsfiddle.net/e9eLP/](http://jsfiddle.net/e9eLP/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T19:31:37.150

您可以在创建时使用 jQuery 克隆它，当您取消时，删除它并重新克隆旧版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T19:31:38.553

浏览器不跟踪原始值。
但是，您可以在页面加载时自己将原始 HTML 存储到变量中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-23T19:31:47.917

您可以将之前的 HTML 内容保存到一个变量中，然后在取消时从该变量中恢复。

```
var previousHtml = $('#someElement').html(); 
```

然后

```
$('#someElement').html(previousHtml); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-23T19:32:11.437

在更改之前，您需要将其保存在变量中：

```
<script>
var origHTML = $("#divid").html();
function ResetDiv(){
  $("#divid").html(origHTML);
}
</script> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-23T19:36:07.317

通过使用[jQuery 的 data() 函数](http://api.jquery.com/data/)，您可以轻松地在内部保存原始值，然后使用以下内容恢复它：

```
$('#a').click(function(){
    $('div').data('store',$('div').html()).html('foo');
});​​
$('#b').click(function(){
    $('div').html($('div').data('store'));
});
​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/V8L4C/)**。（请注意，此示例仅用于说明如何使用 data() 存储值，而不是用于生产代码。）

# c# - 使用 SendMessage/PostMessage 打开/更改 IE9 选项卡

> ID：10286955
> 
> 赞同：0
> 
> 时间：2012-04-23T19:29:45.807
> 
> 标签：c#, tabs, internet-explorer-9, sendmessage, postmessage

我正在尝试使用 SendKey 到 IE9 来更改标签。我有 3 个选项卡，所以我需要发送键 Ctrl+1、Ctrl+2、Ctrl+3 和 Ctrl+T 来打开一个新选项卡。

我首先添加导入 dll 和常量

```
[DllImport("user32.dll")]
public static extern IntPtr SendMessage(IntPtr hWnd, uint Msg,
 IntPtr wParam, IntPtr lParam);
[DllImport("user32.dll")]
public static extern IntPtr PostMessage(IntPtr hWnd, uint Msg,
 IntPtr wParam, IntPtr lParam);
const int WM_KEYDOWN = 0x100;
const int WM_KEYUP = 0x101; 
```

我通过打开一个新进程获得了 Internet Explorer 的实例。

```
Process p = Process.Start("iexplorer.exe"); 
```

使用 PostMessage 到 IE9 实例的进程句柄

```
IntPtr handle = p.MainWindowHandle; //p.Handle (doesn't work either)
//Change to Tab2 using PostMessage

PostMessage(handle, WM_KEYDOWN, ((IntPtr)Keys.LControlKey), (IntPtr)0);
PostMessage(handle, WM_KEYDOWN, ((IntPtr)Keys.D2), (IntPtr)0);
PostMessage(handle, WM_KEYUP, ((IntPtr)Keys.D2), (IntPtr)0);
PostMessage(handle, WM_KEYUP, ((IntPtr)Keys.LControlKey), (IntPtr)0); 
```

没有反应。我也尝试过使用 SendMessage 也无济于事。

我在做任何明显错误的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:17:57.670

怎么样`SendKeys("^1");`

[如此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)所见

# grails - 更新 grails 插件或重置 heroku 应用程序上的堆栈

> ID：10286960
> 
> 赞同：1
> 
> 时间：2012-04-23T19:30:01.060
> 
> 标签：grails, heroku

我已成功将 grails 应用程序部署到 Heroku 的 cedar 堆栈，目前支持该堆栈。

但是，为了产生它运行的战争

```
grails -plain-output -Divy.default.ivy.user.dir=/app/tmp/repo.git/.cache war 
```

其中不包含该`--non-interactive`选项，因此当需要更新插件时，grails 会提示您回答此问题：

```
You currently already have a version of the plugin installed [resources-1.0.2]. Do you want to update to [resources-1.1.5]? [y,n] 
```

由于 Heroku 在运行远程命令时不接受输入，因此无法回答这个问题并且部署被中止。

添加该`--non-interactive`选项的可能性极小（尽管这将是首选方法），因此我想将雪松堆栈“重置”为其初始状态。Heroku 的开发中心并没有多大帮助，有人知道如何实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:21:25.897

有一个用于启动 grails 缓存的选项。您应该能够通过签入一个空目录并有效地清除缓存来使用它来解决此问题。只需添加一个名为 ivy-cache 的空目录并将其签入项目的根目录即可。

我还在构建包上打开了一个问题以添加 --non-interactive 标志：[https ://github.com/heroku/heroku-buildpack-grails/issues/15](https://github.com/heroku/heroku-buildpack-grails/issues/15)

# android - 我们如何从 Android 上的网页获取信息？

> ID：10286962
> 
> 赞同：0
> 
> 时间：2012-04-23T19:30:05.930
> 
> 标签：android, webpage

我们如何从网页中获取信息（点击它时会下载 Excel 文件的链接）？应该搜索哪些主题才能在 Android 上执行此操作？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:06:03.417

AFAIK，您将无法知道链接的用途。有一种方法可以了解用户单击的 webview 的链接，它是[WebViewClient](http://developer.android.com/reference/android/webkit/WebViewClient.html)。

这是一个代码，您可以使用它知道单击的链接有 XLS 文件或 pdf 文件或其他文件。您还可以使用该代码阻止链接

```
public class TestingActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

      WebView view = new WebView(getApplicationContext());
      view.setWebViewClient(new MwebViewClient());
    }

  class  MwebViewClient extends WebViewClient {
    @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
        if(url.contains(".xls")) {
            Log.d("Blah", "This link contains XLS file");
        }
        return super.shouldOverrideUrlLoading(view, url);
        }   
    }
} 
```

# ravendb - 在 Appharbor 创建 RavenDB 数据库

> ID：10286965
> 
> 赞同：1
> 
> 时间：2012-04-23T19:30:09.500
> 
> 标签：ravendb, appharbor

将RavenDB附加[组件](https://appharbor.com/addons/ravenhq)添加到[AppHarbor](https://appharbor.com/)应用程序。

似乎在 RavenDB 管理员中禁用了创建数据库。

为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T00:49:17.667

您应该已经为您创建了一个，连接字符串被注入到您的配置文件中，名称为`RavenDB`. 详细信息：http: [//support.appharbor.com/kb/add-ons/using-ravenb-and-ravenhq](http://support.appharbor.com/kb/add-ons/using-ravendb-and-ravenhq)

我相信他们使用多租户支持来分隔每个客户，因此在添加插件时为您创建了一个数据库。

# python - 解析（格式不良）属性列表的算法

> ID：10286973
> 
> 赞同：0
> 
> 时间：2012-04-23T19:31:13.317
> 
> 标签：python

我知道我已经看到了一个很好的算法，但是找不到它。

我需要解析的工具（我无法控制其输出样式）的输出（格式不正确）。

它看起来像这样：

```
NameOfItemA
attribute1 = values1
attribute2 = values2
...
attributen = valuesn
NameOfItemB
attribute1 = values1
attribute2 = values2
...
attributen = valuesn 
```

其中 NameOfItemX 和 attributeX 是一组明确定义的已知名称。需要把它变成合理的对象：

```
ObjectForA.attribute1 = values1 
```

等等

我知道我以前做过，只是不记得我是怎么做到的。它看起来像：

```
for line in textinput:
    if line.find("NameOfItem"):
        ... parse until next one ... 
```

希望我所说的有道理，有人可以提供帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T19:47:10.290

这类似于 mgilson 的答案，只是它将数据放在嵌套字典中。

```
from collections import defaultdict
itemname = None
d = defaultdict(dict)
for line in data:
    line = line.rstrip()
    if '=' in line:
        attr, value = line.split('=',1)
        d[itemname][attr] = value
    else:
        itemname = line 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:53:09.907

将它作为嵌套字典怎么样：

```
x = {'NameOfItemA': {'attribute1': 'value1', 'attribute2': 'value2'},...} 
```

然后您可以将这些值引用为：

```
value2 = x['NameOfItemA']['attribute2'] 
```

并且，假设属性，值总是跟随一个标题，例如`NameOfItemN`：

```
items = {}
for line in textinput:
    if line.find("NameOfItem"):
        headline = line
        inner_dict = {}
        items[headline] = inner_dict
    else:
        attr, val = line.split('=',1)
        items[headline][attr] = val 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T20:16:30.477

这是您可能感兴趣的 pyparsing 解决方案。我添加了注释以大致浏览代码。

```
data = """\
NameOfItemA
attribute1 = values1A
attribute2 = values2A
attributen = valuesnA
NameOfItemB
attribute1 = values1B
attribute2 = values2B
attributen = valuesnB
"""

from pyparsing import Suppress, Word, alphas, alphanums, \
              empty, restOfLine, Dict, OneOrMore, Group

# define some basic elements - suppress the '=' sign because, while
# it is important during the parsing process, it is not an interesting part
# of the results
EQ = Suppress('=')
ident = Word(alphas, alphanums)

# an attribute definition is an identifier, and equals, and whatever is left
# on the line; the empty advances over whitespace so lstrip()'ing the
# values is not necessary
attrDef = ident + EQ + empty + restOfLine

# define a section as a lone ident, followed by one or more attribute 
# definitions (using Dict will allow us to access attributes by name after 
# parsing)
section = ident + Dict(OneOrMore(Group(attrDef)))

# overall grammar is defined as a series of sections - again using Dict to
# give us attribute-name access to each section's attributes
sections = Dict(OneOrMore(Group(section)))

# parse the string, which gives back a pyparsing ParseResults
s = sections.parseString(data)

# get data using dotted attribute notation
print s.NameOfItemA.attribute2

# or access data like it was a nested dict
print s.keys()
for k in s.keys():
    print s[k].items() 
```

印刷：

```
values2A
['NameOfItemB', 'NameOfItemA']
[('attribute2', 'values2B'), ('attribute1', 'values1B'), ('attributen', 'valuesnB')]
[('attribute2', 'values2A'), ('attribute1', 'values1A'), ('attributen', 'valuesnA')] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T19:36:37.767

关于什么：

```
class obj(object): pass
items={}
for line in textinput:
    if(line.find("NameOfItem")!=-1):
       current_object=items[line.replace("NameOfItem","")]=obj()
    else:
       attr,val=line.split('=',1)
       setattr(current_object,attr.strip(),val.strip()) 
```

当然，如果您已经有一个要使用的类，则可以省略基本对象...毕竟，您有一个对象字典，其中键=对象名称和值=属性（作为字符串-您如果它不是字符串，则需要转换为它应该是的任何类型）

另请注意，此输入文件格式看起来*很像*`ConfigParser`模块的格式。您可能可以读取文件并将行更改`"NameOfItem"`为`[item]`行并将其作为 StringIO 对象传递给 ConfigParser ...

# hibernate - 休眠对象生命周期

> ID：10286987
> 
> 赞同：0
> 
> 时间：2012-04-23T19:32:07.903
> 
> 标签：hibernate

为什么在带有注释的方法返回后，我无法获取`product.getName()`id 加载的实体对象的值？当我以这种方式获得产品对象时，一切都很好。`session.load(product.class,1)``@Transactional``session.createQuery("from Product as product WHERE product.id = 1)`

**编辑**

道法

```
public Product getProduct(Long id) {
return (Product) currentSession().load(Product.class, id);
} 
```

服务方式

```
 @Transactional
public Product getProduct(Long id) {
    return productDao.getProduct(id);
} 
```

控制器方法 - 它应该发送 JSON，但它会因`product.getName()`错误而中断`org.hibernate.LazyInitializationException: could not initialize proxy - no Session`

```
 @RequestMapping(value = "/product",headers="Accept=application/json")
public @ResponseBody Product getProduct() {
    Product product = productService.getProduct(new Long(1));
    System.out.println(product.getName());
    return product;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:35:42.623

`LazyInitializationException`如果在 Session 范围之外访问未初始化的集合或代理，即当拥有集合或具有对代理的引用的实体处于分离状态时，Hibernate 将抛出A。

有时需要在关闭 Session 之前初始化代理或集合。您可以通过调用`product.getName()`或例如强制初始化。但是，这可能会使代码的读者感到困惑，并且对于通用代码来说也不方便。

*静态*方法`Hibernate.initialize()`和为应用程序提供了一种使用延迟初始化的集合或代理的`Hibernate.isInitialized()`便捷方式。`Hibernate.initialize(product)`将强制初始化代理，`product`只要其 Session 仍然打开。

你也可以声明你的一些字段是[eagely加载的](http://docs.oracle.com/javaee/6/api/javax/persistence/Basic.html)

```
@Entity 
public class Product  {

   @Id 
   @GeneratedValue
   private long id;

   @Basic(fetch=EAGER)
   private String name;

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-23T20:18:00.227

当我们在我们的 中创建实例时`Java code, the instance is considered to be a transient instance`，这意味着没有适当的机制来管理该实例的持久状态。然而，一旦`we pass a transient instance to the save, update, or saveOrUpdate method of the Hibernate Session`，我们认为瞬态实例已转换为持久实例，因为 Hibernate 将开始管理该实例的持久状态。

**任何与 Hibernate Session 关联的实例都被称为持久实例。**

保存或更新 JavaBean 并不是获得持久实例的唯一方法。通过 get 或 load 方法调用，甚至是 HQL 或条件查询，已加载到 Hibernate Session 中的 JavaBean 被认为是持久实例，因此，对这些实例状态的任何更改或更新都将是也由 Hibernate Session 持久化到数据库中。

如果你确实有一个你想从 Hibernate 的控制中释放的实例，你总是可以调用 Hibernate Session 的 evict 方法，传入你想从 Hibernate 的控制中释放的实例的名称。当一个实例不再由 Hibernate Session 管理其状态时，我们称其为分离实例，因为虽然它在数据库中确实有一个表示，但 Hibernate 并没有做任何事情来使实例与底层持久性存储保持同步. 实际上，该实例与其在数据库中的相应表示分离。

当然，当我们使用 Hibernate 时，我们与数据库的所有交互都必须发生在事务范围内。默认情况下，当我们调用 save 或 update 之类的方法时，我们永远无法完全确定数据库中的相应记录何时更新 - 我们可以肯定的是，一旦提交事务，所有对任何持久性的更改与 Hibernate Session 关联的实例将保存到数据库中。当然，将所有数据保存到数据库的行为总是有可能由于某种原因而失败，如果确实发生了这种情况，Hibernate 将抛出运行时异常。

在这一点上，除了回滚当前事务并关闭 Hibernate Session 之外，您真的没有太多可以做的。此时，之前在 Hibernate Session 控制下的所有实例都成为分离的对象，并且很可能不再与数据库同步。在这种情况下，您总是可以启动一个新事务，并尝试通过保存或更新调用将分离的实例与 Hibernate Session 重新关联，从而将它们转回持久实例，但最后，您可能会更好只需向您的客户端应用程序发送一条友好的错误消息，然后从头开始重新开始任何请求-响应循环。当我们谈论瞬态，持久和分离的对象时，我们的意思的简单描述。

# python - python中的类，如何设置属性

> ID：10286994
> 
> 赞同：1
> 
> 时间：2012-04-23T19:33:01.357
> 
> 标签：python

当我在 python 中编写类时，大多数时候，我渴望将我使用的变量设置为对象的属性。关于哪些变量应该用作类/实例属性，哪些不应该使用，是否有任何规则或一般准则？

例如：

```
class simple(object):
    def __init(self):
        a=2
        b=3
        return a*b

class simple(object):
    def __init(self):
        self.a=2
        self.b=3
        return a*b 
```

虽然我完全理解属性应该是对象的属性。当类声明很简单时，这很容易理解，但是随着程序越来越长并且应该在许多地方完成各种模块之间的数据交换，我对应该在哪里使用 a/b 或 self.a 感到困惑/self.b. 有没有这方面的指导方针？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T19:34:26.583

您在哪里使用`self.a`您正在创建一个属性，因此可以从类外部访问它并在该函数之外持续存在。这些应该用于存储有关对象的数据。

你使用`a`它的地方是一个局部变量，并且只在该函数的范围内持续存在，所以应该在你只在函数中使用它的地方使用它（如本例所示）。

请注意，这`__init`是误导性的，因为它看起来像`__init__`- 但不是构造函数。如果您打算将它们作为构造函数，那么返回一个值是没有意义的（因为返回的是新对象）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T23:57:46.793

```
class Person(object):
    def __init__(self, name):
        # Introduce all instance variables on __init__
        self.name = name
        self.another = None

    def get_name(self):
        # get_name has access to the `instance` variable 'name'
        return self.name 
```

因此，如果您希望变量可用于多个方法，请将其设为`instance`变量。

请注意我关于在 上引入所有实例变量的评论`__init__`。尽管下面的示例是有效的 python，但不要这样做。

```
class Person(object):
    def __init__(self):
        self.a = 0
    def foo(self):
        self.b = 1 # Whoa, introduced new instance variable 
```

相反，如果没有其他值适合它们，则初始化所有实例变量`__init__`并将它们设置为。`None`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:49:47.503

我试着想象在实现它之前我希望我的类的 API 是什么样子。我想，如果我不写这个类，我会想阅读关于这个特定变量做什么的文档吗？如果阅读该文档只会浪费我的时间，那么它可能应该是一个局部变量。

有时，您需要保留一些信息，但不一定希望它成为 API 的一部分，即使用附加下划线的约定。例如`self._some_data_that_is_not_part_of_the_api`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T22:40:18.320

self 参数是指对象本身。因此，如果您需要使用类之外的类属性，您可以将其称为类实例的名称和属性名称。我认为何时使用 self 没有任何指导方针，这完全取决于您的需要。当你构建一个类时，你应该尝试考虑你将使用你创建的变量来做什么。如果您确定在导入类的程序中需要该特定属性，请添加 self.

# mysql - 如何在mysql中加权'ORDER BY'？

> ID：10286997
> 
> 赞同：7
> 
> 时间：2012-04-23T19:33:39.610
> 
> 标签：mysql, sql, sql-order-by

我有一个全文查询，结尾为：

```
 ORDER BY RELEVANCE DESC, CLICK_RATE DESC 
```

我可以给 中的列赋予权重`order by`吗？也许`0.3`与相关性和`0.7`到`click_rate`？

就目前的情况来说，即使我把它们换过来，结果也不尽如人意。

作为替代方案，如何将排名靠前的`3`结果按 . 排序，`CLICK RATE`其余按`relevance`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-23T19:36:06.627

这应该工作

`ORDER BY (.3 * RELEVANCE) + (.7 * CLICK_RATE) DESC`

[演示](http://sqlfiddle.com/#!2/84103/1)

**从评论更新**

> 使前 3 个结果按 click_rate 排序，其余按相关性排序

您需要首先使用子查询识别前 3 个并进行排序

```
SELECT test.id, 
       test.relevance, 
       test.click_rate, 
       top_3_click_rate.id         t3_id, 
       top_3_click_rate.click_rate t3_click_rate 
FROM   test 
       LEFT JOIN (SELECT id, 
                         click_rate 
                  FROM   test 
                  ORDER  BY click_rate DESC 
                  LIMIT  3) top_3_click_rate 
         ON test.id = top_3_click_rate.id 
ORDER  BY top_3_click_rate.click_rate DESC, 
          test.relevance DESC 
```

[演示](http://sqlfiddle.com/#!2/84103/11)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-04-23T19:48:17.497

您可以随时使用 WHERE。

试试这个： WHERE RELEVANCE > 0.3 AND RELEVANCE < 0.7 ORDER BY RELEVANCE DESC, CLICK_RATE DESC

# php - 将 php echo year 添加到现有变量

> ID：10286998
> 
> 赞同：-1
> 
> 时间：2012-04-23T19:33:40.557
> 
> 标签：php, echo

如何`date("Y")`向`$creds`变量添加回声？我尝试了很多不同的方法，但都搞砸了，正确的语法是什么？

```
$creds = 'Copyright &copy; &middot; by <a href="http://w#" target="_blank">#</a>';
return $creds; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:34:24.110

PHP 中的 concat 运算符是`.`（句点）。

您可以将两个字符串连接在一起，例如：

```
echo 'Hello' . '-' . 'World'; // Hello-World

$world = 'World';
echo 'Hello' . '-' . $world; // Hello-World

$hello = 'Hello';
$world = 'World';
$hello_world = $hello . $world;
echo $hello_world; // HelloWorld 
```

在您的示例中：

```
$creds = 'Copyright &copy; &middot; by <a href="http://w#" target="_blank">#</a>' . date("Y"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:37:04.697

```
$creds = 'Copyright &copy; &middot; by <a href="http://w#" target="_blank">#</a>';
return $creds . date("Y"); 
```

# algorithm - 数字等于其数字的幂的总和

> ID：10286999
> 
> 赞同：6
> 
> 时间：2012-04-23T19:33:47.580
> 
> 标签：algorithm, discrete-mathematics

我还有另一个有趣的编程/数学问题。

```
For a given natural number q from interval [2; 10000] find the number n
which is equal to sum of q-th powers of its digits modulo 2^64. 
```

例如：`for q=3, n=153`; `for q=5, n=4150`.

我不确定这个问题是否更适合 math.se 或 stackoverflow，但这是我朋友很久以前告诉我的一个编程任务。现在我想起了这一点，并想知道如何才能做到这一点。如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T12:41:58.353

有两个关键点，

*   可能解决方案的范围是有界的，
*   任何数字在排列 con 之前都相同的数字组最多包含一个解决方案。

让我们仔细看看这个案例`q = 2`。如果一个`d`-digit 数字`n`等于其数字的平方和，则

```
n >= 10^(d-1) // because it's a d-digit number
n <= d*9^2    // because each digit is at most 9 
```

并且条件`10^(d-1) <= d*81`很容易转换为`d <= 3`or `n < 1000`。要检查的数字并不多，这些数字的蛮力很快。对于`q = 3`，条件`10^(d-1) <= d*729`产生`d <= 4`，仍然没有多少数字要检查。通过进一步分析，我们可以找到更小的界限，对于`q = 2`，最多三位数字的平方和最多为 243，因此解必须小于 244。在该范围内，最大数字平方和达到 199： 1² + 9² + 9² = 163，继续，很容易发现一个解必须小于100。（唯一的解`q = 2`是1。）对于`q = 3`，四个数字的最大和是4 * 729 = 2916，继续，我们可以看到所有解决方案`q = 3`小于 1000。但是由于模数要求，这种界限的改进仅对小指数有用。当数字的幂之和可以超过模数时，它就会崩溃。因此，我停止寻找最大可能的位数。

现在，在没有模数的情况下，对于`q`数字的 -th 次方的总和，边界将大约为

```
q - (q/20) + 1 
```

所以对于更大`q`的，从中获得的可能解决方案的范围是*巨大的*。

但是这里有两点可以解决，首先是模数，​​它将解空间限制为`2 <= n < 2^64`，最多 20 位数字，其次是（模数）数字功率和的排列不变性。

置换不变性意味着我们只需要构造单调的`d`数字序列，计算`q`-th 次方之和并检查由此获得的数字是否具有正确的数字。

由于单调数字`d`序列的数量相对较少，因此使用它的蛮力变得可行。特别是如果我们忽略对总和没有贡献的数字（0 表示所有指数，8 表示`q >= 22`，4 也表示`q >= 32`，所有偶数表示`q >= 64`）。

`d`使用`s`符号的长度单调序列的数量是

```
binom(s+d-1, d) 
```

`s`对我们来说最多 9, `d <= 20`，从`d = 1`到求和`d = 20`，每个指数最多有 10015004 个序列要考虑。这还不算太多。

尽管如此，对所有`q`考虑的人都这样做需要很长时间，但是如果我们考虑到对于`q >= 64`，对于所有偶数位`x^q % 2^64 == 0`，我们只需要考虑由奇数位组成的序列，并且长度单调序列的总数最多为 20使用 5 个符号是`binom(20+5,20) - 1 = 53129`. 现在，看起来不错。

## 概括

我们考虑一个`f`将数字映射到自然数的函数，并正在寻找方程的解

```
n == (sum [f(d) | d <- digits(n)] `mod` 2^64) 
```

where`digits`映射`n`到它的数字列表。

从`f`，我们构建一个`F`从数字列表到自然数的函数，

```
F(list) = sum [f(d) | d <- list] `mod` 2^64 
```

然后我们正在寻找 的不动点`G = F ∘ digits`。Now`n`是 的一个不动点`G`当且仅当`digits(n)`是 的一个不动点`H = digits ∘ F`。因此，我们可以等效地寻找 的不动点`H`。

但是`F`是排列不变的，所以我们可以将自己限制在排序列表中并考虑`K = sort ∘ digits ∘ F`.

`H`of和 of 的不动点是`K`一一对应的。如果`list`是 的不动点`H`，则`sort(list)`是 的不动点`K`，如果`sortedList`是 的不动点`K`，则`H(sortedList)`是 的置换`sortedList`，因此`H(H(sortedList)) = H(sortedList)`，换句话说，`H(sortedList)`是 的不动点`K`，并且`sort`分别。是和`H`的不动点集之间的双射。`H``K`

如果一些`f(d)`为 0（模 2 ^(64)），则可以进一步改进。让`compress`是一个从数字列表中删除带有`f(d)` mod `2^64 == 0`的数字的函数，并考虑该函数`L = compress ∘ K`。

因为`F ∘ compress = F`，如果`list`是 的不动点`K`，则`compress(list)`是 的不动点`L`。相反，如果`clist`是 的一个不动点`L`，则`K(clist)`是 的一个不动点`K`，并且`compress`分别。`K`分别是固定点集之间的双射`L`。`K`. （并且`H(clist)`是 的不动点`H`，而`compress ∘ sort`分别`H`是 的不动点集之间的双射`L`。`H`）

至多位数的压缩排序列表的空间小到足以对所考虑的函数（即幂函数）`d`进行暴力破解。`f`

所以策略是：

1.  找到`d`要考虑的最大位数（由于模数而以 20 为界，对于 small 则更小`q`）。
2.  生成最多`d`位数的压缩单调序列。
3.  检查序列是否是 的不动点`L`，如果是，`F(sequence)`是 的不动点`G`，即问题的解。

## 代码

幸运的是，您没有指定语言，所以我选择了最简单的代码，即 Haskell：

```
{-# LANGUAGE CPP #-}
module Main (main) where

import Data.List
import Data.Array.Unboxed
import Data.Word
import Text.Printf

#include "MachDeps.h"

#if WORD_SIZE_IN_BITS == 64

type UINT64 = Word

#else

type UINT64 = Word64

#endif

maxDigits :: UINT64 -> Int
maxDigits mx = min 20 $ go d0 (10^(d0-1)) start
  where
    d0 = floor (log (fromIntegral mx) / log 10) + 1
    mxi :: Integer
    mxi = fromIntegral mx
    start = mxi * fromIntegral d0
    go d p10 mmx
        | p10 > mmx = d-1
        | otherwise = go (d+1) (p10*10) (mmx+mxi)

sortedDigits :: UINT64 -> [UINT64]
sortedDigits = sort . digs
  where
    digs 0 = []
    digs n = case n `quotRem` 10 of
               (q,r) -> r : digs q

generateSequences :: Int -> [a] -> [[a]]
generateSequences 0 _ 
    = [[]]
generateSequences d [x] 
    = [replicate d x]
generateSequences d (x:xs)
    = [replicate k x ++ tl | k <- [d,d-1 .. 0], tl <- generateSequences (d-k) xs]
generateSequences _ _ = []

fixedPoints :: (UINT64 -> UINT64) -> [UINT64]
fixedPoints digFun = sort . map listNum . filter okSeq $ 
                        [ds | d <- [1 .. mxdigs], ds <- generateSequences d contDigs]
  where
    funArr :: UArray UINT64 UINT64
    funArr = array (0,9) [(i,digFun i) | i <- [0 .. 9]]
    mxval = maximum (elems funArr)
    contDigs = filter ((/= 0) . (funArr !)) [0 .. 9]
    mxdigs = maxDigits mxval
    listNum = sum . map (funArr !)
    numFun = listNum . sortedDigits
    listFun = inter . sortedDigits . listNum
    inter = go contDigs
      where
        go cds@(c:cs) dds@(d:ds)
            | c < d     = go cs dds
            | c == d    = c : go cds ds
            | otherwise = go cds ds
        go _ _ = []
    okSeq ds = ds == listFun ds

solve :: Int -> IO ()
solve q = do
    printf "%d:\n    " q
    print (fixedPoints (^q))

main :: IO ()
main = mapM_ solve [2 .. 10000] 
```

它没有经过优化，但它`2 <= q <= 10000`在我的盒子上找到了不到 50 分钟的所有解决方案，从

```
2:
    [1]
3:
    [1,153,370,371,407]
4:
    [1,1634,8208,9474]
5:
    [1,4150,4151,54748,92727,93084,194979]
6:
    [1,548834]
7:
    [1,1741725,4210818,9800817,9926315,14459929]
8:
    [1,24678050,24678051,88593477]
9:
    [1,146511208,472335975,534494836,912985153]
10:
    [1,4679307774]
11:
    [1,32164049650,32164049651,40028394225,42678290603,44708635679,49388550606,82693916578,94204591914] 
```

并以

```
9990:
    [1,12937422361297403387,15382453639294074274]
9991:
    [1,16950879977792502812]
9992:
    [1,2034101383512968938]
9993:
    [1]
9994:
    [1,9204092726570951194,10131851145684339988]
9995:
    [1]
9996:
    [1,10606560191089577674,17895866689572679819]
9997:
    [1,8809232686506786849]
9998:
    [1]
9999:
    [1]
10000:
    [1,11792005616768216715] 
```

从大约 10 到 63 的指数花费的时间最长（个别地，不是累积的），由于搜索空间减少，从指数 64 开始有显着的加速。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:20:57.330

这是一个蛮力解决方案，它将解决所有此类 n，包括 1 和任何其他大于您选择的任何范围内的第一个的 n（在这种情况下，我选择 base^q 作为我的范围限制）。您可以修改以忽略 1 的特殊情况并在第一个结果之后返回。它在 C# 中，但在带有 ** 幂运算符的语言中可能看起来更好。你也可以传入你的 q 和 base 作为参数。

```
int q = 5;
int radix = 10;
for (int input = 1; input < (int)Math.Pow(radix, q); input++)
{
    int sum = 0;
    for (int i = 1; i < (int)Math.Pow(radix, q); i *= radix)
    {
        int x = input / i % radix;       //get current digit
        sum += (int)Math.Pow(x, q);      //x**q;
    }
    if (sum == input)
    {
        Console.WriteLine("Hooray: {0}", input);
    }
} 
```

因此，对于 q = 5，结果是：

```
Hooray: 1
Hooray: 4150
Hooray: 4151
Hooray: 54748
Hooray: 92727
Hooray: 93084 
```