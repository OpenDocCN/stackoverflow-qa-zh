# StackOverflow 问答 10112000-10112999

# iphone - 更改 UINavigationController 过渡效果的正确方法是什么

> ID：10112003
> 
> 赞同：3
> 
> 时间：2012-04-11T18:42:26.750
> 
> 标签：iphone, ios, uinavigationcontroller, uikit, core-animation

我看到很多人询问如何`UINavigationController`使用除默认动画之外的其他动画来推送/弹出 s，例如`flip`或`curl`。

问题是问题/答案相对较旧，这意味着有一些东西`[UIView beginAnimations:]`（例如[这里](https://stackoverflow.com/questions/2215672/how-to-change-the-push-and-pop-animations-in-a-navigation-based-app)）或者他们使用两种非常不同的方法。

第一种是`transitionFromView:toView:duration:options:completion:`在推送控制器之前使用 UIView 的选择器（动画标志设置为`NO`），如下所示：

```
UIViewController *ctrl = [[UIViewController alloc] init];
[UIView transitionFromView:self.view 
                toView:ctrl.view 
                duration:1 
                options:UIViewAnimationOptionTransitionFlipFromTop
                completion:nil];

[self.navigationController pushViewController:ctrl animated:NO]; 
```

另一种是`CoreAnimation`显式使用`CATransaction`如下：

```
// remember you will have to have the QuartzCore framework added to your project for this approach and also add <QuartzCore/QuartzCore.h> to the class this code is used
CATransition* transition = [CATransition animation];
transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn];
transition.duration = 1.0f;
transition.type =  @"flip"; 
transition.subtype = @"fromTop"; 
[self.navigationController.view.layer removeAllAnimations];
[self.navigationController.view.layer addAnimation:transition forKey:kCATransition];

UIViewController *ctrl = [[UIViewController alloc] init];
[self.navigationController pushViewController:ctrl animated:NO]; 
```

两种方法各有利弊。

第一种方法为我提供了更简洁的代码，但限制了我使用“suckEffect”、“cube”[等](http://iphonedevwiki.net/index.php/CATransition)动画。

第二种方法光看就感觉不对。它首先使用未记录的转换类型（即[CATransition Class Reference的](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CATransition_Class)[Common transition types 文档](http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CATransition_Class/Introduction/Introduction.html#//apple_ref/doc/constant_group/Common_Transition_Types)中不存在），这可能会使您的应用程序被 App Store 拒绝（我的意思是我可能找不到任何应用程序引用被拒绝，因为它正在使用这笔交易，我也希望对此事做出任何澄清），但它为您的动画提供了更大的灵活性，因为我可以使用其他动画类型，例如“cameraIris”、“rippleEffect”等。

`QuartzCore`关于这一切，我真的需要上诉吗？`CoreAnimation`每当我需要更好的`UINavigationController`过渡时？有没有其他方法可以仅使用来达到相同的效果`UIKit`？

如果不是，使用“flip”和“cube”之类的字符串值而不是预定义的常量（`kCATransitionFade`,`kCATransitionMoveIn`等...）是否会成为我在 App Store 中批准应用程序的问题？

此外，这两种方法是否还有其他优点和缺点可以帮助我决定是否选择其中的每一种？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:18:37.073

关于 AppStore 的批准，根据您使用的动画库，我认为它不会破坏交易。你可以使用任何你觉得方便的，也可以一起使用。从个人的角度来看，当您尝试将动画添加到特定事件时，我会说`CoreAnimation`&`QuartzCore`非常棒。它很棒，因为您可以添加到各个组件的详细程度。

但这些不是你唯一的选择。你应该看看`COCOS2D`动画库。它们真的很棒，而且使用起来非常简单。例如，如果 using`CoreAnimation`需要 30 行代码，您可以使用`COCOS2D`3-5 行代码来设置它。此外，您可以在使用`COCOS2D`框架 ( `chipmunk`) 时将 Physics 与每个组件集成。

# ssis - 针对大型机消耗问题的 SSIS 制表符分隔导出

> ID：10112004
> 
> 赞同：0
> 
> 时间：2012-04-11T18:42:30.693
> 
> 标签：ssis

下午好，希望有人能对我遇到的一个奇怪问题有所了解。我正在运行一个简单的 SSIS 平面文件导出作业，该作业创建一个制表符分隔的平面文件。此文件将由我们的大型机团队使用，但当他们获得文件时，他们会看到每个字段之前和结尾的句点 (.) 字符。我想知道 SSIS 生成或使用的制表符是否未被处理，或者不是大型机所期望的。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T18:49:25.003

您的 SSIS 脚本输出什么编码，大型机期望什么编码？

[此处](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=/com.ibm.xlf101a.doc/xlflr/asciit.htm)的表格表明 ASCII 制表符 (0x09) 是 EBCDIC 中的上标指示符。*IIRC*（这是一个很长的时间），该时期被用作大型机输出中的“不可打印”占位符。

**编辑**：什么字符集/代码页在起作用？ASCII <> EBCDIC 和 CP437 (OEM) <> CP1252 (Windows Latin-1)。

# javascript - 8 位愚人节的 Google MapTypeId 是什么？

> ID：10112005
> 
> 赞同：3
> 
> 时间：2012-04-11T18:42:32.137
> 
> 标签：javascript, google-maps

谷歌地图 8 位愚人节玩笑仍然可以使用[`"t=8"`参数](http://maps.google.com/maps?t=8)访问。

您甚至可以使用`<iframe>`嵌入选项嵌入带有 Quest 的地图。

[谷歌地图 8 位嵌入 http://dl.dropbox.com/u/2066483/google_map-8_bit.png](http://dl.dropbox.com/u/2066483/google_map-8_bit.png)

但是对于那些已经拥有使用正确 Maps V3 API 的地图的人来说[`MapTypedId`](https://developers.google.com/maps/documentation/javascript/reference#MapTypeId)，Quest 模式的正确方法是什么？显然不是：

*   `google.maps.MapTypeId.ROADTYPE`
*   `google.maps.MapTypeId.SATELLITE`
*   `google.maps.MapTypeId.HYBRID`
*   `google.maps.MapTypeId.TERRAIN`

`google.maps.MapTypeId.QUEST`不起作用。我认为 Quest 不会在 API 中可用，但在看到它之后，`<iframe>`我认为它可能会。

如果您浏览 的[混淆源代码`<iframe>`](http://maps.google.com/?t=8&output=embed&ll=37.0625,-95.677068&spn=43.713406,68.466797)，您可以找到 的数组`[14534,"Quest"]`，但除此之外，我对 Google 的混淆 JavaScript 不知所措。我的猜测是找到这个答案并不适合轻松愉快的人，而且它可能在 API 中根本不可用。

任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T08:13:17.280

我怀疑这是一个真正的地图类型，

在这里查看：[https ://groups.google.com/forum/?fromgroups#!topic/google-maps-js-api-v3/-t3YmEBs_Co](https://groups.google.com/forum/?fromgroups#!topic/google-maps-js-api-v3/-t3YmEBs_Co)

# cakephp - CakePHP 2.1 中的国际化和本地化

> ID：10112017
> 
> 赞同：0
> 
> 时间：2012-04-11T18:43:46.073
> 
> 标签：cakephp, localization, internationalization

由于对 Cake 的“内置”本地化功能的好评，我正在使用 CakePHP 2.1.x 构建一个双语言应用程序。但是，我正在努力让这个强大的功能发挥作用。

我知道以前版本的 Cake（[这里](http://www.cakephparticles.com/cakephp-internationalization-and-localization)、[这里](http://nuts-and-bolts-of-cakephp.com/2008/11/28/cakephp-url-based-language-switching-for-i18n-and-l10n-internationalization-and-localization)、 [这里](https://stackoverflow.com/questions/2661275/using-localization-in-cakephp)和[这里](http://bakery.cakephp.org/articles/p0windah/2007/09/12/p28n-the-top-to-bottom-persistent-internationalization-tutorial)）已经解决了这个主题，但是对于 Cake 2.x 还没有解决。我还在食谱中引用了这些文章（是的，我已经阅读了手册）：

*   [http://book.cakephp.org/2.0/en/core-libraries/internationalization-and-localization.html](http://book.cakephp.org/2.0/en/core-libraries/internationalization-and-localization.html)
*   [http://book.cakephp.org/2.0/en/core-libraries/behaviors/translate.html](http://book.cakephp.org/2.0/en/core-libraries/behaviors/translate.html)

几件事——我不想为每种语言做单独的子域。相反，我更喜欢通过单击按钮（在本例中为标志图标）进行基于 URL 的语言切换。该站点将被积极维护，因此内容需要动态更新。要求客户维护两个独立的站点/数据库是不可能的。

我为我的 PostModel 设置了翻译行为，但我不知道它是否有效。我还通过在控制台中运行来初始化 I18n `I18n`，确认数据库表存在，设置了我的 .po 文件，并将我的所有内容包装在`__()`. 但是，当我将浏览器中的默认语言更改为法语时，该站点仍为英语。

我已经尝试过 P28n 组件，但我认为它对于 Cake 2.x 来说已经过时了。我还尝试了基于 URL-based 语言切换，基于这篇[文章 nuts-and-bolts-of-cakephp](http://nuts-and-bolts-of-cakephp.com/2008/11/28/cakephp-url-based-language-switching-for-i18n-and-l10n-internationalization-and-localization)，但显然它与新的 CakePHP API 不兼容。

任何人都可以指出使用 CakePHP 2.x 的教程或说明的方向吗？此处尚未引用的一个？

**更新：**我发现这篇文章：[http](http://www.localizingjapan.com/blog/2011/11/10/localizing-a-cakephp-application/comment-page-1/#comment-7467) ://www.localizingjapan.com/blog/2011/11/10/localizing-a-cakephp-application/comment-page-1/#comment-7467 。有谁知道你把代码放在`CakeSession::write('Config.language', 'fre');`哪里`setlocale("LC_ALL", "fr_FR.utf8");`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:13:47.473

只需将代码放入 AppController::beforeFilter() 并根据您从发布请求或 URL 的一部分检索语言的方式设置值。

# c# - 是否可以获得对 system.drawing.graphics 类的原始图像缓冲区的引用？

> ID：10112018
> 
> 赞同：2
> 
> 时间：2012-04-11T18:43:47.067
> 
> 标签：c#, wpf, image

我正在尝试将图像从非托管控件呈现到 WPF 窗口。到目前为止，我能够获得一个工作图形对象（因为我能够将图像覆盖到非托管控件）。我希望做的是相反的事情，即从图形对象中捕获图像并保存为另一个控件的图像源。

```
var graphics = Graphics.FromHwnd(hwndPtr);//From image unmanaged source
graphics.(??) // save to bitmap or any image format 
```

如果无法直接保存带有图形对象的图像，是否可以获得对图形对象的图像缓冲区的原始引用？（与下面的代码一起使用）

```
var bmp = (InteropBitmap)Imaging.CreateBitmapSourceFromMemorySection(
                                  hwntPtr,120,120,format,stride,0); 
```

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:44:06.757

这是来自 MSDN 论坛文章的稍微修改的代码，但它应该可以从 System.Drawing.Graphics 对象中获取 System.Drawing.Bitmap。

```
[DllImport("coredll.dll", SetLastError = true)]

internal static extern bool BitBlt(IntPtr hDest, int nDstX, int nDstY, int nWidth, int nHeight, IntPtr hSrc, int nSrcX, int nSrcY, uint BitBltOperation);

Bitmap SaveAsBitmap(Graphics gxSrc, int sizeX, int SizeY)
{
    Bitmap bm = new Bitmap(sizeX, sizeY);
    Graphics gxDst = Graphics.FromImage(bm);
    IntPtr hSrc = gxSrc.GetHdc();
    IntPtr hDst = gxDst.GetHdc();
    BitBlt(hDst, 0, 0, sizeX, sizeY, hSrc, 0, 0, 0xcc0020); // SourceCopy operation
    gxDst.ReleaseHdc(hDst);
    gxSrc.ReleaseHdc(hSrc);
    gxDst.Dispose();
    return bm;
} 
```

[来源文章](http://social.msdn.microsoft.com/Forums/en-US/vssmartdevicesvbcs/thread/c320e6a3-cb99-4c3e-bf68-6b23c56d6645)

# java - 将侦听器添加到弹簧批处理决策器

> ID：10112020
> 
> 赞同：2
> 
> 时间：2012-04-11T18:43:54.570
> 
> 标签：java, spring, spring-batch

嘿，我的 spring 批处理应用程序上下文有点麻烦。我需要我的决策者能够查看通过作业启动器传递的作业参数。对于普通的tasklet，我会在一个方法上使用@beforeStep并通过它获取信息，我还将使用一个侦听器，以便tasklet可以像这样到达@beforeStep：

```
 <batch:step id="verifyDatabase" next="full.incremental.decision">
        <batch:tasklet ref="verifyDatabaseTasklet" />
        <batch:listeners>
            <batch:listener ref="verifyDatabaseTasklet" />
            <batch:listener ref="PromotionListener" />
        </batch:listeners>
    </batch:step> 
```

但是，我希望能够对决定做同样的事情。像这样的东西：

```
 <batch:decision id="full.incremental.decision" decider="fullIncrementalDecider">
        <batch:next on="COMPLETED" to="incrementalUpdate" />
        <batch:next on="FAILED" to="fullUpdate" />
        <batch:listeners>
            <batch:listener ref="full.incremental.decision" />
        </batch:listeners>
    </batch:decision> 
```

当我这样做时，我会收到此错误

```
 cvc-complex-type.2.4.a: Invalid content was found starting with 
 element 'batch:listeners'. One of '{"http://
 www.springframework.org/schema/batch":next, "http://
 www.springframework.org/schema/batch":stop, "http://
 www.springframework.org/schema/batch":end, "http://
 www.springframework.org/schema/batch":fail}' is expected. 
```

我知道这可能意味着不允许听众参与决策？那是对的吗？无论如何我可以在我的 JobExecutionDecider 中访问我的 jobParameters 吗？

谢谢一堆

# ssas - SSAS 2008 中允许具有重复值的维度属性，在 2005 年出现错误

> ID：10112021
> 
> 赞同：0
> 
> 时间：2012-04-11T18:43:57.363
> 
> 标签：ssas, olap, bids

我在 SQL Server Analysis Services 2008 中有一个多维数据集，其中包含由年份和季度组成的时间维度。还有一个单独的 YearQuarterID 列。

正如您所料，Quarter 属性（Quarters 类型）由每年的整数值 1 - 4 组成。由于这不是维度的关键属性，因此非唯一性应该不是问题，实际上多维数据集构建得很干净。

在 BIDS 2008 中检查此属性的属性，我发现它确实具有 KeyColumns 属性。（不确定这对非键属性意味着什么。）它说“DimYearQuarter.Quarter（整数）”。

现在，我正在尝试将此多维数据集改进为 SSAS 2005。我有一个类似的维度，它是从具有类似值的类似关系数据库表创建的。据我所知，该属性的属性在 BIDS 2005 中是相同的，但是，当我尝试处理多维数据集时，我得到了错误：

> OLAP 存储引擎中的错误：属性键重复：表：dbo_DimYearQuarter，列：季度，值：1。

我确实注意到 VS2005 中的“属性”窗口不允许展开 KeyColumns 属性。所以我无法深入比较版本之间的属性细节。

如果属性不是维度的键，为什么在 2005 年出现重复问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T22:07:16.023

嗯，这是意料之外的。通常 2005 可以让你做 2008 不能做的事情（重复的关键错误就是其中之一，相信我，我已经走过这条路）

关于key，应该是年-季的组合，因为第1季出现在一年多的时间里。

回答您的`Not sure what this means for a non-key attribute`评论，每个属性都有一个键，即使它不是维度的键。键（在属性上）将指示如何构建 SELECT DISTINCT 查询以获取维度的成员

# sql - 是否在选择语句中多次调用标量函数多次运行该函数，如果是，如何解决

> ID：10112022
> 
> 赞同：7
> 
> 时间：2012-04-11T18:44:01.190
> 
> 标签：sql, sql-server, tsql

如果我有一个带有标量函数的 select 语句，用于各种计算，那么该标量函数会被多次调用吗？如果是这样，有没有办法优化它，所以它每次选择只调用一次函数，因为在我的实际查询中，它将被调用数千次，每次选择 X 6 次。

例如：

```
SELECT 
[dbo].[fn_Days](@Account) + u.[DayRate],
[dbo].[fn_Days](@Account) / u.[WorkDays]
FROM [dbo].[tblUnit] u 
```

fn_days 所做的只是返回一个 int 的工作天数。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-13T00:30:24.857

是的，标量会以您编码的方式多次调用。使其工作的一种方法是将其包装到这样的子查询中：

```
SELECT t.[days] + t.[DayRate],
       t.[days] / t.[WorkDays]
FROM (
     SELECT 
     [dbo].[fn_Days](@Account) as days,
     u.[DayRate],
     u.[WorkDays]
     FROM [dbo].[tblUnit] u) as t 
```

这样 fn_Days 每行只被调用一次，而不是像你提到的那样两次或六次。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T02:21:23.623

函数是确定性的，这意味着它总是为给定的参数返回相同的值。您使用变量作为参数，因此您可以在执行查询之前调用该函数一次，并在查询中使用结果而不是调用该函数。

```
DECLARE @Days int
SET @Days = [dbo].[fn_Days](@Account)

SELECT 
  @Days + u.[DayRate],
  @Days / u.[WorkDays]
FROM [dbo].[tblUnit] u 
```

# asp.net - 传递 URL 参数以重新填充页面

> ID：10112023
> 
> 赞同：1
> 
> 时间：2012-04-11T18:44:05.573
> 
> 标签：asp.net, vb.net, asp.net-mvc-3

我目前有一个使用过滤器填充的页面，它通过 URL 传递过滤器的参数。

我想捕捉这些参数并让用户有机会返回页面，并将相同的过滤器应用于他们的视图。本质上，它是一个后退按钮。又名：将参数传递回 URL，以便重新填充页面。

我希望这是有道理的。任何帮助表示赞赏！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:35:22.410

您可以将过滤器值存储在会话变量或 cookie 中。

**会话变量：**

```
Session("MyCustomFilter") = "FilterValue" 
```

**曲奇饼：**

```
Dim cookie As HttpCookie
cookie = New HttpCookie("MyCustomFilter")
cookie.Values.Add("MyCustomFilter", "FilterValue) 
```

虽然会话变量更易于使用，但如果您关闭浏览器，它将**不会**被保存，而 cookie 将被保存并可以在以后使用。

**注意：**根据我的评论添加了更精确的答案。

# css - 最后一个 元素以我想要的方式工作

> ID：10112029
> 
> 赞同：0
> 
> 时间：2012-04-11T18:44:22.253
> 
> 标签：css, html-lists

我在 CSS 中的页脚需要帮助。

我是一个新的 wordpress 开发人员，我知道如何使用它的要点，但像往常一样我遇到了一个问题，它可能也很简单，因为我不确定如何挑选某些 CSS 片段我需要。我使用 Firebug，但有时我只是不确定我的 CSS 发生了什么。

这是我的测试站点，因此您可以查看我将要谈论的内容。在我的页脚中，我的最后一个 < li > 元素（档案）我希望能在 Follow Us 的下方站起来。我总是可以使用最后一个子 css 规则，但我知道 IE 忽略了这一点。那么我的下一个选择是什么？我知道如果 wordpress 给列表提供了单独的样式，但在这种情况下它没有，我知道该怎么做，所以我不确定该怎么做。

CSS

```
#footer { width: 100%; height: 503px; background: url(img/FOOTER-bg.jpg) repeat-x; background-color: #821d20; position: relative; top: 100px;/*border: 1px solid #0C0;*/}
.footer-widgets { width: 960px; margin: 0px auto; padding: 0px; /*border: 1px solid #fff;*/ }
.footer-widgets li { width:280px; height: auto; list-style-image: none; list-style-position: outside; list-style-type: none; float: left; color: #fff; padding: 13px; margin-right: 10px; /*border: 1px solid #fff;*/ }
.footer-widgets li ul {color: red;}
.footer-widgets li ul li {color: #fff; margin-left: -50px; margin-top: -15px;} 
```

完成这项工作的最佳方法是什么？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T18:47:04.820

如果您需要支持不接受`:last-child`选择器的浏览器，那么您有两种选择。

1.  手动将类添加到最后一个元素并为其设置样式。

2.  使用javascript查找最后一个`<li>`并添加一个类，然后对其进行样式设置。

**[编辑]** 不幸的是，在[W3C 遍历规范](http://www.quirksmode.org/dom/w3c_traversal.html)`lastElementChild`中引入的非常方便的功能在 IE8/7 中也不支持。这又给你留下了两个选择。

1.  使用像 jQuery 这样的库，它有非常简单的`$('.footer-widgets li:last-child')`选择器
2.  使用常规js，通过繁琐的DOM遍历找到元素。

I would say it's silly to use jQuery for this one thing, but if you will be doing other javascript stuffs on your site, might as well use jQuery, right? Otherwise, I would stay away from the DOM traversal as it's just a pain. Just manually put a class on the last `<li>` and be done with it :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T18:49:27.857

There are 2 alternatives I see:

1.  Add a class to your last element and take it with JavaScript to do your own manipulation.
2.  Use jQuery to get the nested elements (unnecessary I think).

    Example:

    `$('.yourElement').css('property', 'value')`

Complement:

Getting any element with JavaScript:

```
 var x = document.getElementById("id"); 
```

I suggest you to take a look at [this W3C documentation](http://www.w3schools.com/jsref/met_doc_getelementbyid.asp) with an example. Right after you get the element with JavaScript comes manipulation anyway you need it.

I think it may help you!

# c - 在 C 中解析命令类似于 shell

> ID：10112038
> 
> 赞同：1
> 
> 时间：2012-04-11T18:44:59.567
> 
> 标签：c, parsing, shell, command, ansi

我想在我的 C（只是 C）程序中解析用户输入命令。示例命令：

```
add node ID

add arc ID from ID to ID

print

exit 
```

等等。然后我想用 ID 做一些验证并将它们转发给指定的函数。函数和验证当然已经准备好了。这都是关于解析和匹配功能......

我已经用很多`if`s 和`strtok`s 做到了，但我确信这不是最好的方法......有什么想法（库）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:27:02.953

我认为你想要的是这样的：

```
while (1) 
{
    char *line = malloc(128); // we need to be able to increase the pointer
    char *origLine = line;
    fgets(line, 128, stdin);

    char command[20];
    sscanf(line, "%20s ", command);

    line = strchr(line, ' ');

    printf("The Command is: %s\n", command);

    unsigned argumentsCount = 0;
    char **arguments = malloc(sizeof(char *));

    while (1)
    {
        char arg[20];
        if (line && (sscanf(++line, "%20s", arg) == 1))
        {
            arguments[argumentsCount] = malloc(sizeof(char) * 20);
            strncpy(arguments[argumentsCount], arg, 20);

            argumentsCount++;

            arguments = realloc(arguments, sizeof(char *) * argumentsCount + 1);
            line = strchr(line, ' ');
        }
        else {
            break;
        }
    }

    for (int i = 0; i < argumentsCount; i++) {
        printf("Argument %i is: %s\n", i, arguments[i]);
    }

    for (int i = 0; i < argumentsCount; i++) {
        free(arguments[i]);
    }

    free(arguments);
    free(origLine);
} 
```

在你释放它之前，你可以用“命令”和“参数”做你想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:15:18.017

这取决于您的命令语言有多复杂。如果您有多个命令，或者每个命令可以采用多种形式，例如您的命令，则*可能*值得费心构建一个简单的[递归下降解析器](http://en.wikipedia.org/wiki/Recursive_descent_parser)`add`。

过去，我为一些项目手工完成了几个 RDP。这是一些工作，但它允许您处理一些相当复杂的命令，否则这些命令将无法直接解析。您还可以使用 lex/yacc 或 flex/bison 之类的解析器生成器，尽管这对于您正在做的事情可能是多余的。

否则，基本上就是您所描述的；`strok`和一堆嵌套`if`语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-05T12:40:03.347

我只是想在 Richard Ross 的回复中添加一些内容：检查 malloc 和 realloc 的返回值。它可能会导致程序中难以发现的崩溃。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T18:47:19.180

您的所有命令行参数都将存储到一个名为`argv`.

您可以使用`argv[0]`, `argv[1]`...访问这些值`argv[n]`。

# prolog - Prolog 计数除数

> ID：10112041
> 
> 赞同：1
> 
> 时间：2012-04-11T18:45:18.390
> 
> 标签：prolog

我正在研究一个谓词，它将计算给定数字的除数数量。它不会计算所有这些，但足以让我知道它有两个以上的因素。这是我所拥有的：

```
countFactors([_,_,_,_X]):-!.
countFactors(Product, Count,Divisor, _X):-
     Divisor =< Product/2,
     Product mod Divisor = 0,
     NewC is Count + 1,
     NextD is Divisor + 1,
     countFactors(Product,NewC, NextD, NewC). 
```

但是，运行 countFactors(16,0,2,X)。简单地返回 false，而我希望它返回 X = 2

编辑：好的，所以现在我意识到为什么它返回错误：如果所讨论的除数是一个因素，它工作正常，并且递归。但是，如果它不是一个因子，那么它给出 false，但不会递增到下一个除数，它只是停止并返回 false。

所以我的问题是，我该如何纠正这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T18:49:34.603

您的代码中有一些错误，我发布了一些更正。也许你需要做一些小的修改。

```
%% count all factors of Product
%
countFactors(Product, Count, Divisor, Tot) :-
     Divisor > Product/2,
     !, Tot is Count.
countFactors(Product, Count, Divisor, Tot):-
     (   Product mod Divisor =:= 0
     ->  NewC is Count + 1
     ;   NewC is Count
     ),
     NextD is Divisor + 1,
     countFactors(Product, NewC, NextD, Tot). 
```

# mysql - 如何在 MySQL 中实现此查询

> ID：10112045
> 
> 赞同：-2
> 
> 时间：2012-04-11T18:45:27.913
> 
> 标签：mysql, join

你好亲爱的SO的朋友们。

我有这个表：

**宝仕奥**

```
+---------+--------+-----------+-------------+------------+
| priceID | itemID | priceCash | pricePoints | priceDate  |
+---------+--------+-----------+-------------+------------+
|       1 |      1 |     30.00 |          90 | 2012-03-05 |
|       2 |      2 |     40.00 |         120 | 2012-03-05 |
|       6 |      2 |     50.00 |          50 | 2012-03-07 |
|       7 |      2 |     55.00 |          50 | 2012-03-07 |
+---------+--------+-----------+-------------+------------+ 
```

**项目**

```
+--------+----------------------+-------------+------------+----------+---------------+---------------+
| itemID | itemName             | itemWarning | itemUrgent | itemType | itemVipPoints | itemExistence |
+--------+----------------------+-------------+------------+----------+---------------+---------------+
|      1 | Lubricante Orgasmix  |          20 |         10 |        2 |             3 |           300 |
|      2 | Anillo Vibrador      |          50 |         50 |        2 |            50 |           120 |
|      3 | Crema Chantilly      |           5 |         20 |        1 |             0 |           500 |
|      4 | Caribe Cooler        |          10 |          4 |        1 |             0 |           100 |
|      5 | Cacahuates Japoneses |          20 |         10 |        1 |             0 |           400 |
|      6 | Cerveza Sol (lata)   |          12 |        112 |        1 |             0 |           200 |
|      7 | Chocolate derretido  |          20 |         10 |        1 |             0 |           200 |
+--------+----------------------+-------------+------------+----------+---------------+---------------+ 
```

我需要一张这样的桌子：

*   itemType 必须为“2”
*   itemID 是必填项
*   项目名称是必需的
*   priceCash 是必需的
*   itemExistence 必须 > 0

但是，主要问题（对我来说）是我需要为每个独特的项目获取最新的 priceCash。

例如，如您所见，itemID = 2 具有三个价格。在这种情况下，我需要表格只显示最后一个（55.00）。

所以，简而言之：我需要得到这个：

```
+--------+---------------------+-----------+
| itemID | itemName            | priceCash |
+--------+---------------------+-----------+
|      1 | Lubricante Orgasmix |     30.00 |
|      2 | Anillo Vibrador     |     55.00 |
+--------+---------------------+-----------+ 
```

但我最好的结果是这样的:(

```
+--------+---------------------+-----------+
| itemID | itemName            | priceCash |
+--------+---------------------+-----------+
|      1 | Lubricante Orgasmix |     30.00 |
|      2 | Anillo Vibrador     |     40.00 |
|      2 | Anillo Vibrador     |     50.00 |
|      2 | Anillo Vibrador     |     55.00 |
+--------+---------------------+-----------+ 
```

我将在**4 月 15 日**通过 Paypal 向可以帮助我的人支付 5 美元小费 :) 承诺。

**解决方案**

由**kaj友情提供**

```
select it.itemID, it.itemName, p.priceCash
from items it
  inner join precios p on p.itemID = it.itemID
  inner join (select itemID, max(priceID) latestPriceID
              from precios
              group by itemID) latestPrice on latestPrice.itemID = p.itemID and latestPrice.latestPriceID = p.priceID
where it.itemType = 2
  and it.itemExistence > 0 
```

*对于那些介意的人来说，这是关于汽车旅馆的数据库，他们在那里出售各种东西以获得性快感。*

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T18:56:44.757

鉴于您有重复`priceDates`for `itemID`= 2 我假设最新价格可以通过使用`priceID`. 所以基本上你需要一个查询来找到每件商品的最新价格点，然后提取当时的相关价格。

像下面这样的东西应该可以工作：

```
select it.itemID, it.itemName, p.priceCash
from items it
  inner join precios p on p.itemID = it.itemID
  inner join (select itemID, max(priceID) latestPriceID
              from precios
              group by itemID) latestPrice on latestPrice.itemID = p.itemID and latestPrice.latestPriceID = p.priceID
where it.itemType = 2
  and it.itemExistence > 0 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-11T18:58:12.290

```
 select x.itemID, x.itemName, y.priceCash from items x, precios y
 WHERE itemType=2 and x.itemID=y.itemID and x.itemExistence > 0 
 and y.priceID = (select max(t.priceID) from precios t where x.itemID=t.itemID)
 group by x.itemID order by y.priceDate; 
```

# php - echo Javascript window.location.href 不工作

> ID：10112047
> 
> 赞同：6
> 
> 时间：2012-04-11T18:46:21.467
> 
> 标签：php, javascript, navigation, echo

我有一个回显 javascript 以导航到不同页面的函数。进行导航时，

```
echo 'window.location.href="'.$url.'";'; 
```

不起作用，只是将其打印在屏幕上。

```
"window.location.href="./index.php"; 
```

我以这种方式使用我的功能：`redirect("./index.php");`

我的php函数如下

```
 function redirect($url)
   {    
    if (!headers_sent())
    {    
      header('Location: '.$url);
      exit;
    }
   else
    {      
      echo '<script type="text/javascript">';
      echo 'window.location.href="'.$url.'";';
      echo '</script>';
      echo '<noscript>';
      echo '<meta http-equiv="refresh" content="0;url='.$url.'" />';
      echo '</noscript>'; exit;
   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T18:52:34.167

您的浏览器将响应视为纯文本。

在您响应之前添加一个`Content-Type: text/html\`n 加号，将您的内容包装在`<html></html>`标签内。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T18:53:34.260

试试这个方法。

```
<?php
$yourURL="http://www.stackoverflow.com";
echo ("<script>location.href='$yourURL'</script>");
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T19:02:45.830

为什么不只使用[输出缓冲](http://us3.php.net/manual/en/ref.outcontrol.php)而根本不必处理 JavaScript 或元重定向？

```
<?php
// Top of your page
ob_start();

// Code goes here

// Redirect
if ($redirect_is_necessary)
{
    header('Location: '.$url);
    exit;
}

// Rest of page goes here

// Bottom of page
ob_end_flush();
?> 
```

# android - 添加图像平移/拖动限制时，画布变得异常且行为不正确

> ID：10112050
> 
> 赞同：1
> 
> 时间：2012-04-11T18:46:38.057
> 
> 标签：android, math, android-custom-view

我制作了可以缩放和平移的自定义 ImageView。问题在于平移/拖动边界我试图通过限制左上边缘来限制边界，如果它低于零或负值。当我这样做时，它会一直工作，直到出现其中一个条件，例如 X 变为 0 或 Y 变为 0，如果两者都变为 0，它会变得急躁，并且即使存在小于零的条件，也会发生一些奇怪的行为，它超出了界限..

代码带有易于理解的注释请帮助

这是代码

```
package com.example.customView;

import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Matrix;
import android.graphics.Rect;
import android.hardware.Camera.PreviewCallback;
import android.util.AttributeSet;
import android.util.Log;
import android.view.MotionEvent;
import android.view.ScaleGestureDetector;
import android.widget.ImageView;

/* @description : Custom View Zoom
 *
 */

public class ZoomView extends ImageView {

    // Maximum and Minimum Zoom
    private static float MIN_ZOOM = 1.0f;
    private static float MAX_ZOOM = 3.0f;

    //Different Operation to be used
    private final int NONE_OPERATION=0;
    private final int DRAG_OPERATION=1;
    private final int ZOOM_OPERATION=2;
    private float mWidth= 1047;
    private float mHeight=800;
    private boolean dragged=true;

    // Mode to select the operation
    private int mode;

    //Track X and Y coordinate of the finger when it first touches the screen
    private float mInitialX = 0f;
    private float mInitialY = 0f;

    //Track the amount to translate(Drag) the canvas along the X and the Y coordinate
    private float mTranslateX = 0f;
    private float mTranslateY = 0f;

    //Track the last translated X and the Y coordinate while panning so that canvas does not get the jerk (Issue was happening when we change the position again and again )
    private float mPreviousTranslateX = 0f;
    private float mPreviousTranslateY = 0f;

    //ScalingFactor i.e. Amount of Zoom
    private float mScaleFactor = 1.0f;
    float gx=0,gy=0;
    private Rect rect ;
    private Matrix matrix;

    private ScaleGestureDetector mDetector;

    // Called if used from code
    public ZoomView(Context context) {
            super(context);
        // Intialize ScaleGestureDetector
        mDetector = new ScaleGestureDetector(context, new ZoomListener());
        rect= new Rect();
        Matrix matrix= new Matrix();
    }

    //Called if used from XML
    public ZoomView(Context context, AttributeSet attrs) {
        super(context, attrs);
        mDetector = new ScaleGestureDetector(context, new ZoomListener());
        rect= new Rect();
        Matrix matrix= new Matrix();
    }

    //handle the touch event of the view with the detector to get the scalingFactor and also keep the track of
    // the touch events like drag and zoom event using booleans
    @Override
    public boolean onTouchEvent(MotionEvent event) {

        // Handles all type of motion-events possible
        switch(event.getAction() & MotionEvent.ACTION_MASK) {

        case MotionEvent.ACTION_DOWN:
            // Event occurs when the first finger is pressed on the Screen

            // setting the mode to Drag Operation
            mode = DRAG_OPERATION;

            // Store the initial X and Y of the first finger when touches on the Screen. Take the difference with the previous translation so as to avoid the jerk in canvas.
            //Initial difference will be X and Y since previousTranslation will be ZERO.
            mInitialX = event.getX() - mPreviousTranslateX;
            mInitialY = event.getY() - mPreviousTranslateY;

            break;
        case MotionEvent.ACTION_MOVE:
            // Event occurs when the finger move across the screen and also when the finger is kept pressed on the screen

            // Update the translate value constantly as the event is occured at every move
            mTranslateX = event.getX() - mInitialX;                // Translate value is calculated by diff from current and initial
            mTranslateY = event.getY() - mInitialY; 

        /*    float [] matrixValues = new float[9];
            matrix.getValues(matrixValues);
            if (mode == DRAG_OPERATION) {

                if(rect.left<0 || matrixValues[Matrix.MTRANS_X]<0)
                    mTranslateX = mPreviousTranslateX;
                else
                mTranslateX = event.getX() - mInitialX;                // Translate value is calculated by diff from current and initial
                if(rect.top<0 || matrixValues[Matrix.MTRANS_Y]<0 )
                    mTranslateY=mPreviousTranslateY;
                else
                mTranslateY = event.getY() - mInitialY;

                        }*/

        //    Log.d("Print", " TranslateX::" + mTranslateX + " Translate Y::" + mTranslateY);

            // If finger is kept pressed it will still consider the move so to avoid that use this value
            //Initial X and Initial Y can not be used directly because they were adjusted  using the previous translation values. So need to add those
            // values to InitialX and InitialY so that the actual coordinates of the finger are retrieved.
            // Using distance Forumla
            double distance = Math.sqrt(Math.pow(event.getX() - (mInitialX + mPreviousTranslateX), 2) + Math.pow(event.getY() - (mInitialY + mPreviousTranslateY), 2));
                if(distance > 0) {
            dragged = true;

            }

            break;
        case MotionEvent.ACTION_POINTER_DOWN:
            //Event occurs when the second finger is pressed down

            // If second finger is pressed on the screen with the first set the Mode to Zoom operation
            mode=ZOOM_OPERATION;

            break;

        case MotionEvent.ACTION_UP:
            //Event occurs when all the finger are taken of the screen

            //If all the fingers are taken up there will be no operation
            mode = NONE_OPERATION;
            dragged= false;
            // All the operations are done.Store the previousTranslate value here. ( Might not need at the time of second finger down ??)
            mPreviousTranslateX = mTranslateX;
            mPreviousTranslateY = mTranslateY;

            break;

        case MotionEvent.ACTION_POINTER_UP:
            // Event occurs when the second finger is taken of the screen while first finger is pressed

            // Second finger is taken up stop zooming and again Drag Operation
            mode=DRAG_OPERATION;
            break;
        }

        // give the event to the mDetector to get the scaling Factor
        mDetector.onTouchEvent(event);

        //We need to invalidate the canvas to redraw itself for the changes.Here we need to invalidate only when zoom is done and drag operation has happened
        //or else for the Zoom which was happening in the onScale function
        if((mode==DRAG_OPERATION && mScaleFactor!=1f && dragged ) || mode==ZOOM_OPERATION)
        {

            invalidate();
        }

        // we are handling the touch event
        return true;
    }

    //Everything that is going to reflect on the screen will happen in on draw
    @Override
    protected void onDraw(Canvas canvas) {

    //Save the canvas to set the scaling factor returned from detector
        canvas.save();
        canvas.scale(mScaleFactor, mScaleFactor,gx,gy);
        Log.d("Print", "mScaleFactor::" + (mScaleFactor));                 //- 1) * mWidth );
        Log.d("Print", " mTranslateX::" + mTranslateX + " mTranslateY::" +  mTranslateY);
        Log.d("Print", " ::" + mTranslateX/mScaleFactor + " mTranslateY::" +  mTranslateY/mScaleFactor);

        float[] matrixValues = new float[9] ;

    //Check the bound that we never pan past the top of left edge of the
/*    if((mTranslateX) < 0) {
        mTranslateX=0;

    }
    ////Check the right bound.
    // eg : Height of display is 1280\. When it is zoom by 2 it is 1280 . when it is zoom by 3 it is  2560
    // Compare translateX times -1 to (scaleFactor - 1) * displayWidth.
    //If translateX is greater than that value, then it has gone over the bound. So we set the value of translateX to (1 - scaleFactor) times the display width.
    // Notice that the terms are interchanged... it's the same as doing -1 * (scaleFactor - 1) * displayWidth
    else if((mTranslateX) > (mScaleFactor - 1) * mWidth){
        mTranslateX=(mScaleFactor - 1 )* mWidth;
        Log.d("Print", " InDraw mTranslateX::" + mTranslateX);
    }

    if((mTranslateY)< 0)
        mTranslateY=0;
    else if((mTranslateY) > (mScaleFactor - 1) * mHeight)
        mTranslateY= (mScaleFactor-1)* mHeight;*/

        if(rect.left<0 || matrixValues[Matrix.MTRANS_X]<0)
            mTranslateX = mPreviousTranslateX;
        else
        mTranslateX = mTranslateX;                // Translate value is calculated by diff from current and initial
        if(rect.top<0 || matrixValues[Matrix.MTRANS_Y]<0 )
            mTranslateY=mPreviousTranslateY;
        else
        mTranslateY = mPreviousTranslateY;

    //divide by the scale factor here,
    //otherwise it will end up with excessive panning based on our zoom level since the translation amount also gets scaled according to how much we've zoomed into the canvas.
      canvas.translate(mTranslateX / mScaleFactor, mTranslateY / mScaleFactor);   

    // Draw anything more if needed here ....

      // Restore the canvas to balance the save Canvas which removes all the last modification before save.

      super.onDraw(canvas);

      canvas.getClipBounds(rect);
       Log.d("Print", " Canvas X::" + rect.left + " CanvasY::" + rect.top );

      matrix = canvas.getMatrix();

      Matrix m = new Matrix();
       m = canvas.getMatrix();
       float[] arr = new float[9] ;
        m.getValues(arr );
       Log.d("Print", " CanvasMatrixX::" + arr[Matrix.MTRANS_X] + " CanvasMatrixY::" + arr[Matrix.MTRANS_Y] );

        canvas.restore();
    }

/* @name : ZoomListener
 * @description : Class which defines the listener for ScaleGestureDetector while extending abstract
 *
 */
    private class ZoomListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {

/*
 * ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
 *
 * @description: Method gives the scaleFactor from the detector
 *
 * ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
 */
        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            // getting the scaleFactor from the detector
            mScaleFactor *= detector.getScaleFactor();                // gives the scaling factor from the previous scaling to the current
            Log.d("Print", "detector scaling Factor" + mScaleFactor);

            gx = detector.getFocusX();
            gy = detector.getFocusY();

            // Limit the scale factor in the MIN and MAX bound
            mScaleFactor= Math.max(Math.min(mScaleFactor, MAX_ZOOM),MIN_ZOOM);
            Log.d("Print", "Bounded scaling Factor" + mScaleFactor);

            /*//Force canvas to redraw itself only if the one event is to happen (say Zooming only ) else do not invalidate here for multi operations
               As what we de for scrolling or panning will not reflect here. So we will add this in onDraw method
            invalidate();*/

            // we have handle the onScale
            return true;
        }

        @Override
            public void onScaleEnd(ScaleGestureDetector detector) {

                super.onScaleEnd(detector);
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T07:10:24.540

我认为问题是因为您不必要地使视图无效（即使在限制之后）。您应该检查边界`onTouch`本身并决定是否重绘您的视图。一旦达到限制，您应该停止重绘。

检查`mTranslateX`in`onTouch` 方法的值并调用 invalidate。

```
...
if (mTranslateX >= 0 || mTranslateY >= 0) {
    invalidate();
}

if (mTranslateX < 0)
    mTranslateX = 0;
if (mTranslateY < 0)
    mTranslateY = 0;
... 
```

# c++ - C++ 编译时宏来检测 Windows 操作系统

> ID：10112051
> 
> 赞同：5
> 
> 时间：2012-04-11T18:46:42.853
> 
> 标签：c++, windows, windows-7, header, preprocessor-directive

是否存在任何 C++ 编译时宏来检测正在编译代码的 Windows 操作系统。我基本上只想在Win7上支持某些功能。所以我有兴趣做这样的事情

```
#if <os_macro> = WIN7
  // This function would do something valid only on Win7 builds.
  bool myfunction {
        // do something here
  }
#else
  // This function would typically return false, since its not supported on OS below win7
  bool myfunction {
       return false;
  }
#endif 
```

有没有其他更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T18:54:31.650

*编译*它的操作系统并不是那么重要。更重要的是*运行*代码的操作系统，您显然无法在编译时检测到。但是，如果您希望您的代码在旧版本的 Windows 上运行，您可以将[`WINVER`和`_WIN32_WINNT`](http://msdn.microsoft.com/en-us/library/aa383745%28v=vs.85%29.aspx#setting_winver_or__win32_winnt)设置为某些值，这将导致新功能不可用等（只需搜索 Windows 头文件以了解这些宏在何处进行测试以了解）。

要在运行时测试功能，请使用[`GetProcAddress`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683212%28v=vs.85%29.aspx)（[`LoadLibrary`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684175%28v=vs.85%29.aspx)如果它在较新的 DLL 中，也可能使用 ）来测试该功能是否可用。如果是，请调用它，如果不是，请不要。

如果要检测编译器版本等，另请参阅 Visual Studio 编译器使用的[预定义宏。](http://msdn.microsoft.com/en-us/library/b0084kay.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T18:52:38.067

有一组标准的[windows 标头宏](http://msdn.microsoft.com/en-us/library/aa383745%28v=vs.85%29.aspx)可以告诉您操作系统的确切版本

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-13T20:57:06.480

有些事情确实需要在编译时知道哪个操作系统版本。

例如`import "winhttp.dll"`会在 Windows 7 下编译，但在 Windows 10 下会导致编译时错误（C1083）。

但是如果你切换到`import "winhttpcom.dll"`. 它可以在 Windows 10 下编译，但在 Windows 7 下失败。

所以这里需要一个 OS 宏来导入适当的 dll。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T18:51:32.117

对于初学者，至少使用 MS VC++、WIN32、_WIN32 和 _WIN32_WINNT。除非您需要在编译时对其进行控制，否则您可能会考虑使用 GetVersionEx 之类的东西在运行时进行检测，以便相同的构建在旧版本上运行，但在新功能可用时利用它们。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-08-31T09:56:30.720

在我的情况下，对于想要在 Visual Studio（2017）下的 CONSOLE 和 WIN32 App 之间以不同方式编译/包含的人，我的两分钱。

您使用向导创建控制台应用程序，您将拥有：

WIN32;_DEBUG;_CONSOLE;%(预处理器定义)

在下面： [![在此处输入图像描述](../Images/0d8b8b19bde7768f4e93e22428442f7c.png)](https://i.stack.imgur.com/92L2n.png)

如果您使用**win32 GUI 应用程序的**向导：

WIN32;_DEBUG;_WINDOWS;%(PreprocessorDefinitions) 所以没有 _CONSOLE。

[![在此处输入图像描述](../Images/a5551423edac2869006579729f1c8953.png)](https://i.stack.imgur.com/Q6P7c.png)

所以你可以写：

```
#ifdef _CONSOLE
// for Console
#else
// for GUI

#endif // _CONSOLE

int main()
{
#ifdef _CONSOLE
    // for Console
#else
    // for GUI

#endif // _CONSOLE

    return 0;
} 
```

# asp.net - 使用 AppSettings 键在母版页上的 ImageButton 中设置 ImageUrl

> ID：10112053
> 
> 赞同：0
> 
> 时间：2012-04-11T18:47:06.953
> 
> 标签：asp.net, master-pages, imagebutton

我正在尝试在我的母版页中使用 AppSettings 显示 asp:ImageButton 的 ImageUrl，如下所示：

```
 View.Master:
 ....
 <asp:ImageButton ID="aspShowHideButton" ImageUrl='<%# System.Configuration.ConfigurationManager.AppSettings("HomeDirectory").ToString()%>images/arrowUpButton.gif' runat="server" /> 
```

不幸的是，当我在浏览器中提取它时，这是正在呈现的代码：

```
 <input type="image" name="ctl00$ctl00$aspContentMain$aspShowHideButton" id="aspContentMain_aspShowHideButton" onmouseover="ShowHideButtonMouseOver()" onmouseout="ShowHideButtonMouseOut()" src="../%3C%25#%20System.Configuration.ConfigurationManager.AppSettings(%22HomeDirectory%22).ToString()%25%3Eimages/arrowUpButton.gif" /> 
```

因此，它从字面上获取了我的 ImageUrl，但我希望它获取键的值，即：

```
 ...
  <appSettings>
        ....
        <add key="HomeDirectory" value="/" />
        .... 
```

我试过了，删除了“ToString()”函数，我试过 System.Configuration.... 语句前面的“#”和“$”。我还尝试尝试让它在 Page_Load 函数中工作，使用：

```
 Protected Sub Page_Load(....)
    If Not IsNothing(Master.FindControl("aspShowHideButton")) Then
       Dim ShowHideButton As ImageButton = Master.FindControl("aspShowHideButton")
       ShowHideButton.ImageUrl = System.Configuration.ConfigurationManager.AppSettings("HomeDirectory") + "images/arrowUpButton.gif"
    End If 
```

但这似乎也不起作用，我假设是因为它找不到我正在寻找的控件（即 aspShowHideButton）。

从根本上说，我希望在我的 web.config 文件中有一个键/值对，它允许我更改图像的位置，并且我希望能够在我的母版页上的 ImageButton:ImageUrl 中使用这个键/值对，这似乎是一件非常受欢迎的事情。任何建议，方向，不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:04:42.413

要在服务器标签中使用 appsettings，请使用以下语法：

```
<%$ AppSettings:HomeDirectory %> 
```

但是您将无法连接 ImageUrl 的后缀。请注意，如果您想在 asp.net 服务器控件中引用主目录， ~ 就可以了。

```
 <asp:ImageButton ID="aspShowHideButton" ImageUrl="~/images/arrowUpButton.gif" runat="server"/> 
```

**简单的解决方案**

在服务器端代码上初始化 ImageUrl 属性，例如 Page_Load 事件。在那里，您将能够使用您想要的任何服务器代码。

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!IsPostBack)
    {
       this.aspShowHideButton.ImageUrl = System.Configuration.ConfigurationManager.AppSettings("HomeDirectory").ToString() + "images/arrowUpButton.gif";
    }
} 
```

现在，**如果您确实需要**直接在 ImageButton 标记中定义这种连接，您将需要使用代码表达式生成器。[在这里阅读](http://weblogs.asp.net/infinitiesloop/archive/2006/08/09/The-CodeExpressionBuilder.aspx)。

使用 Code Expression Builder，您将能够在 ImageButton 标记中使用这种语法：

```
ImageUrl="<%$ Code: System.Configuration.ConfigurationManager.AppSettings("HomeDirectory").ToString() + "images/arrowUpButton.gif" %>" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:08:23.650

你可以试试这个：

```
<asp:ImageButton runat="server" ImageUrl="<%$ AppSettings:FullPath %>images/image001.jpg" ></asp:ImageButton> 
```

（或者）有一个小工作可以解决这个问题：

网络配置：

```
<appSettings> 
<add key="testKey" value="images/up.gif" />
</appSettings> 
```

添加图片按钮：

```
<asp:ImageButton ID="ImageButton1" runat="server" /> 
```

从代码隐藏你可以这样调用：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        this.ImageButton1.ImageUrl = ConfigurationManager.AppSettings["testKey"];
    } 
```

# spring - 如何在 log4j 中为 docx4j 关闭调试日志记录

> ID：10112055
> 
> 赞同：2
> 
> 时间：2012-04-11T18:47:12.977
> 
> 标签：spring, maven, log4j, jboss7.x, docx4j

当我在 jboss as7 上部署我的 maven/spring 应用程序并尝试上传 docx 文件时，我收到以下消息。当我在应用程序的 WYSIWIG 编辑器中查看该消息时，该消息会显示在上传文件的正文中。当我在码头本地运行应用程序时，该消息不显示。我包含了 log4j 和 docx4j 属性文件。我不确定哪个属性可以让我切换错误中提到的 docx4j 类的调试日志记录，到目前为止，我在网络搜索中都是空的。顺便说一句，我的应用程序没有使用 log4j/docx4j xml 文件，从我读到的内容来看，它是一个非此即彼的设置。如果我应该切换到 xml，请让我知道并告知我需要调整哪些属性，以便我可以清除此消息。

泰

**要隐藏这些消息，请关闭 org.docx4j.convert.out.html.HtmlExporterNG2 的 log4j 调试级别日志记录**

log4j.properties

```
log4j.rootLogger=ERROR,stdout
#Console Appender 
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=[%5p] [%t %d{hh:mm:ss}] (%F:%M:%L) %m%n
#Custom assignments
log4j.logger.Controllers=DEBUG,stdout
log4j.logger.Entities=DEBUG,stdout
log4j.logger.Models=DEBUG,stdout
#Disable additivity
log4j.additivity.Controllers=false
log4j.additivity.Entities=false
log4j.additivity.Models=false 
```

docx4j.properties

```
# Page size: use a value from org.docx4j.model.structure.PageSizePaper enum
# eg A4, LETTER
docx4j.PageSize=LETTER
# Page size: use a value from org.docx4j.model.structure.MarginsWellKnown enum
docx4j.PageMargins=NORMAL
docx4j.PageOrientationLandscape=false
# Page size: use a value from org.pptx4j.model.SlideSizesWellKnown enum
# eg A4, LETTER
pptx4j.PageSize=LETTER
pptx4j.PageOrientationLandscape=false
# These will be injected into docProps/app.xml
# if App.Write=true
docx4j.App.write=true
docx4j.Application=docx4j
docx4j.AppVersion=2.7
# of the form XX.YYYY where X and Y represent numerical values
# These will be injected into docProps/core.xml
docx4j.dc.write=true
docx4j.dc.creator.value=docx4j
docx4j.dc.lastModifiedBy.value=docx4j
#
#docx4j.McPreprocessor=true
# If you haven't configured log4j yourself
# docx4j will autoconfigure it. Set this to true to disable that
docx4j.Log4j.Configurator.disabled=true 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-05-28T11:44:00.467

`docx4j`我们在使用Spring Boot时遇到了类似的问题。

由于`spring-boot-starter-logging`自动配置`logback-classic`用作记录器的实现，因此只需为包设置正确的级别。在我们的例子中，我们不需要任何日志记录，`docx4j`因此将以下行添加到 application.properties 禁用了“docx4j”的整个输出：

```
logging.level.org.docx4j=OFF 
```

如果您特别需要禁用文档的控制台打印，则需要在此特定文件上设置关闭日志级别：

```
logging.level.org.docx4j.model.datastorage.migration.VariablePrepare=OFF 
```

**编辑**：我知道这个主题很旧，但是在使用 spring boot 时，针对这个主题的资源非常有限。我希望这对将来的人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T01:36:21.340

我不确定 docx4j 如何配置 log4j，但您可以尝试将其更改`docx4j.Log4j.Configurator.disabled=true`为`false`。

如果这不起作用，您可能想尝试排除服务器 log4j 实现。您可以添加[排除 log4j](https://stackoverflow.com/questions/9584787/using-log4j-with-jboss-7-1/9589133#9589133)`jboss-deployment-structure.xml`的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T16:20:29.297

在 log4j.properties 或 log4j.xml 文件 log4j.rootCategory=OFF, SymbolicNameForAppender 中将 rootCategory Level 从 DEBUG 更改为 OFF

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-16T04:21:37.147

我能够使用以下命令禁用日志输出（使用 docx4j 2.8.1）：

```
Docx4jProperties.getProperties().setProperty(
    "docx4j.Log4j.Configurator.disabled", "true");
Log4jConfigurator.configure(); 
```

请注意，如果没有第二条语句，则不会抑制日志记录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-13T12:22:07.793

使用以下代码：

```
Docx4jProperties.getProperties().setProperty("docx4j.Log4j.Configurator.disabled", "true");
Log4jConfigurator.configure();            
org.docx4j.convert.out.pdf.viaXSLFO.Conversion.log.setLevel(Level.OFF); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-28T12:29:08.320

用这个：

```
LogManager.getLogger("org.docx4j").setLevel(Level.OFF); 
```

# jquery - 如何使用 CakePHP 和 AJAX 从表中的多个记录中删除单个记录

> ID：10112059
> 
> 赞同：0
> 
> 时间：2012-04-11T18:47:35.607
> 
> 标签：jquery, cakephp-2.0

我正在尝试构建一个可以使用 AJAX 将数据提交到数据库的系统。我可以做到这一点，而且效果很好。

但是，在尝试删除记录时，我正在努力做类似的事情。我是使用 Ajax 的新手，尤其是使用 CakePHP，而且我发现整个概念非常令人难以抗拒。我可以只使用纯 HTML 删除记录，将 ID 传递给控制器​​，然后重定向到原始页面。这只是我正在努力解决的 Ajax 问题，显然使用 Ajax 会带来巨大的好处。

这是我认为的代码：

```
 <table>
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Content</th>
            <th>&nbsp;</th>
        </tr>
        <?php foreach ($testing as $test) { ?>
            <tr>
                <td><?php echo $test['Testtable']['id']; ?></td>
                <td><?php echo $test['Testtable']['title']; ?></td>
                <td><?php echo $test['Testtable']['content']; ?></td>
                <td><?php echo $this->Html->link('Delete', array('controller' => 'testing', 'action'=>'delete_ajax_data', $test['Testtable']['id']), null, 'Are you sure?' );?></td>
            </tr>
        <?php } ?>
    </table> 
```

这是我在控制器中的代码：

```
function delete_ajax_data($id) {
    $this->autoRender = false;
    $this->layout = 'ajax';

    $this->loadModel('Testtable');

    $this->Testtable->delete($id);
    $this->redirect('/test-area/');
} 
```

这是迄今为止我的 Ajax 代码：

```
$(document).ready(function(){

    $('a.confirm_delete').click(function(event){
        event.preventDefault();

        $.ajax({
            url:'/testing/delete_ajax_data',
            type:'POST',
            data: $("a").attr("href").serialize()

        });     
    });

}); 
```

为这方面的任何帮助干杯，它开始让我感到压力！

***编辑：***我使用的代码是错误的，现在我已经包含了正确的代码。虽然还是不行！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:50:36.523

我已经想通了。我在代码中有几个问题。

第一部分在视图中。我没有使用 CakePHP 的链接构建器，而是使用了 HTML 链接：

```
<td><a href="id=<?php echo $test['Testtable']['id']; ?>" class="deleteajax">Delete</td> 
```

然后，对于 Ajax，我使用了以下代码：

```
$('a.deleteajax').click(function(event){
event.preventDefault();

var answer = confirm("Delete this record?")
if (answer){
    $.ajax({
        url:'/testing/delete_ajax_data/',
        type:'GET',
        data: $(this).attr("href")

    });
}

return false;  
}); 
```

新的 Ajax 代码使用 GET 而不是 POST，它将我要删除的记录的 ID 作为 ID 变量返回，然后可以在控制器中使用，如下所示：

```
function delete_ajax_data() {
    $this->autoRender = false;
    $this->layout = 'ajax';

    $id = $_GET['id'];

    $this->loadModel('Testtable');

    $this->Testtable->delete($id);
} 
```

可能有比我所做的更好的方法来做到这一点，但是对于我正在做的事情来说，这非常有效。

# c# - How to retrieve SAMAccountName from Active Directory

> ID：10112062
> 
> 赞同：7
> 
> 时间：2012-04-11T18:47:40.550
> 
> 标签：c#, active-directory, directoryservices

I implemented a method that returns a list of Active Directory users, I would like to retrieve SAMAccountName like this `Domain\Administrator`.

This is the method I use:

```
public Collection<software_user> GetUsersFromAD(String adConnectionString)
{
    var users = new Collection<software_user>();

    using (var directoryEntry = new DirectoryEntry(adConnectionString))
    {
        var directorySearcher = new DirectorySearcher(directoryEntry);
        directorySearcher.Filter = "(&(objectClass=user))";
        var propertiesToLoad = new[] 
        { 
           "SAMAccountName", 
           "displayName", 
           "givenName", 
           "sn", 
           "mail", 
           "userAccountControl", 
           "objectSid" 
        };
        directorySearcher.PropertiesToLoad.AddRange(propertiesToLoad);

        foreach (SearchResult searchEntry in directorySearcher.FindAll())
        {
            var userEntry = searchEntry.GetDirectoryEntry();
            var ldapUser = new software_user();
            ldapUser.User_name = NullHandler.GetString(userEntry.Properties["displayName"].Value);

            if (string.IsNullOrEmpty(ldapUser.User_name))
               continue;
            ldapUser.User_name = NullHandler.GetString(userEntry.Properties["SAMAccountName"].Value);
            ldapUser.email = NullHandler.GetString(userEntry.Properties["mail"].Value);
            ldapUser.user_shortname = NullHandler.GetString(userEntry.Properties["givenName"].Value);
            var userAccountControl = (int)userEntry.Properties["userAccountControl"].Value;
            //ldapUser.IsActive = (userAccountControl & UF_ACCOUNTDISABLE) != UF_ACCOUNTDISABLE;
            var sid = new SecurityIdentifier((byte[])userEntry.Properties["objectSid"][0], 0).Value;
            //ldapUser.SId = sid;
            users.Add(ldapUser);
         }
    }
    return users;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-11T18:54:11.733

**首先：** `Domain\Administrator`不是**SAM**帐户名！SAM 帐户名是一个唯一的（在整个域中）最多 20 个字符的名称——通常是您的“Windows 用户名”（例如`Administrator`）——但它不**包括**域名。组成的值`domain\username`不会**存储**在任何地方的 Active Directory 中！

* * *

如果您使用的是 .NET 3.5 及更高版本，则应查看`System.DirectoryServices.AccountManagement`(S.DS.AM) 命名空间。在这里阅读所有相关信息：

*   [在 .NET Framework 3.5 中管理目录安全主体](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)
*   [System.DirectoryServices.AccountManagement 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)

基本上，您可以定义域上下文并在 AD 中轻松找到用户和/或组：

```
// set up domain context
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);

// find a user
UserPrincipal user = UserPrincipal.FindByIdentity(ctx, "SomeUserName");

if(user != null)
{
   // do something here....     
   string samAccountName = user.SamAccountName;
} 
```

新的 S.DS.AM 使得在 AD 中与用户和组一起玩变得非常容易！

如果要搜索整个用户组（或组或计算机），可以使用 a`PrincipalSearcher`和 "query-by-example" 主体进行搜索：

```
// create your domain context
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);

// define a "query-by-example" principal - here, we search for a UserPrincipal 
// and with the last name (Surname) of "Miller"
UserPrincipal qbeUser = new UserPrincipal(ctx);
qbeUser.Surname = "Miller";

// create your principal searcher passing in the QBE principal    
PrincipalSearcher srch = new PrincipalSearcher(qbeUser);

// find all matches
foreach(var found in srch.FindAll())
{
    // do whatever here - "found" is of type "Principal" - it could be user, group, computer.....          
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-29T21:46:17.390

您可以使用对象的 SID 和 System.Security.Principal.SecurityIdentifier.Translate 命令将用户作为可分辨名称转换为 DOMAIN\SAMaccount 表单。

```
public Collection<software_user> GetUsersFromAD(String adConnectionString)
    {
            var users = new Collection<software_user>();

            using (var directoryEntry = new DirectoryEntry(adConnectionString))
            {
                    var directorySearcher = new DirectorySearcher(directoryEntry);
                    directorySearcher.Filter = "(&(objectClass=user))";
                    var propertiesToLoad = new[] 
                    { 
                         "SAMAccountName", 
                         "displayName", 
                         "givenName", 
                         "sn", 
                         "mail", 
                         "userAccountControl", 
                         "objectSid" 
                    };
                    directorySearcher.PropertiesToLoad.AddRange(propertiesToLoad);

                    foreach (SearchResult searchEntry in directorySearcher.FindAll())
                    {
                            var userEntry = searchEntry.GetDirectoryEntry();
                            var ldapUser = new software_user();
                            ldapUser.User_name = NullHandler.GetString(userEntry.Properties["displayName"].Value);

                            if (string.IsNullOrEmpty(ldapUser.User_name))
                                 continue;
                            ldapUser.User_name = NullHandler.GetString(userEntry.Properties["SAMAccountName"].Value);
                            ldapUser.email = NullHandler.GetString(userEntry.Properties["mail"].Value);
                            ldapUser.user_shortname = NullHandler.GetString(userEntry.Properties["givenName"].Value);
                            var userAccountControl = (int)userEntry.Properties["userAccountControl"].Value;

                            //ldapUser.IsActive = (userAccountControl & UF_ACCOUNTDISABLE) != UF_ACCOUNTDISABLE;
                            SecurityIdentifier sid = new SecurityIdentifier((byte[])userEntry.Properties["objectSid"][0], 0).Value;
    -->                     NTAccount account = (NTAccount) sid.Translate(typeof(NTAccount));
    -->                     ldapUser.User_name = account.ToString();

                            //ldapUser.SId = sid;
                            users.Add(ldapUser);
                     }
            }
            return users;
    } 
```

# sql - 如何删除列中所有开头的数字字符？

> ID：10112070
> 
> 赞同：0
> 
> 时间：2012-04-11T18:48:23.047
> 
> 标签：sql, regex, sqlite

> **可能重复：**
> [如何使用 SQL 从字符串末尾删除数字](https://stackoverflow.com/questions/2568501/how-to-remove-digits-from-the-end-of-the-string-using-sql)

如果我有一个`Songs`如下所示的 sqlite 表：

```
id  SongName    
------------------
0   midnight   
1   Another song  
2   01 midnight01  
3   01 01 midnight
4   Another record
5   1 midnight 
```

使用 select 或 update 和 REGEX 表达式，会返回什么？：

```
id  SongName    
------------------
0   midnight   
1   Another song  
2   midnight01  
3   midnight
4   another record
5   midnight 
```

我用过

从 SongName REGEXP '\b^[0-9]\b' 的歌曲中选择 SongName

或者

从 SongName REGEXP '\d' 的歌曲中选择 SongName

但仍然没有得到我想要的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:16:31.790

对不起，我对C接口不熟悉。但是，如果您在仅找到合适的正则表达式时遇到问题，这可能会奏效。

```
(\d+\s)+(.*) 
```

它匹配随机数量的数字-空格组合，如果您使用`$2`or返回第二个捕获组`\2`，您最终会得到歌曲标题。

注意：这需要在您要删除的数字和实际歌曲标题之间留一个空格。它匹配“01 01 some text”和“11 some text”就好了（第二个捕获组返回“some text”）。但是，如果您匹配“01 01some text”，您最终会得到“01some text”（仅删除空格之前的数字）。

更新。这可能会奏效。它只选择歌曲标题。与上述相同的注释适用。

```
[^\d+\s]+.* 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T18:51:40.610

[从文档中引用：](http://www.sqlite.org/lang_expr.html)

> REGEXP 运算符是 regexp() 用户函数的特殊语法。默认情况下没有定义 regexp() 用户函数，因此使用 REGEXP 运算符通常会导致错误消息。如果在运行时添加了名为“regexp”的应用程序定义的 SQL 函数，则将调用该函数以实现 REGEXP 运算符。
> 
> MATCH 运算符是 match() 应用程序定义函数的特殊语法。默认的 match() 函数实现会引发异常，并且对任何事情都没有真正的用处。但是扩展可以用更有用的逻辑覆盖 match() 函数。

因此，换句话说，您将不得不[使用 C 接口来覆盖这些运算符中的一个或两个](http://www.sqlite.org/c3ref/create_function.html)。

老实说，解决此问题的最佳方法是重组数据。歌曲名称的数字部分要么是无用的（在这种情况下，它们一开始就不应该在那里），要么没有（在这种情况下，它们需要在自己的列中）。

# c# - 列出标志枚举中的所有位名称

> ID：10112076
> 
> 赞同：12
> 
> 时间：2012-04-11T18:48:56.653
> 
> 标签：c#, generics, enums, enumeration

我正在尝试创建一个辅助方法来列出枚举值中设置的所有位的名称（用于记录目的）。我想要一个方法来返回在某些变量中设置的所有枚举值的列表。在我的例子中

```
[Flag]
Enum HWResponse
{
   None = 0x0,
   Ready = 0x1,
   Working = 0x2,
   Error = 0x80,
} 
```

我喂它 0x81，它应该为我提供一个`IEnumerable<HWResponse>`包含`{Ready, Error}`.

由于我没有找到更简单的方法，所以我尝试编写下面的代码，但无法编译。

```
public static IEnumerable<T> MaskToList<T>(Enum mask) 
{
  if (typeof(T).IsSubclassOf(typeof(Enum)) == false)
    throw new ArgumentException();

  List<T> toreturn = new List<T>(100);

  foreach(T curValueBit in Enum.GetValues(typeof (T)).Cast<T>())
  {
    Enum bit = ((Enum) curValueBit);  // Here is the error

    if (mask.HasFlag(bit))
      toreturn.Add(curValueBit);
  }

  return toreturn;
} 
```

在这个版本的代码中，编译器抱怨它不能将 T 转换为 Enum。

我做错什么了？有没有更好（更简单）的方法来做到这一点？我怎么能做演员？

另外，我尝试将方法编写为

```
public static IEnumerable<T> MaskToList<T>(Enum mask) where T:Enum 
```

但 Enum 是一种特殊类型，禁止使用“where”语法（使用 C# 4.0）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-11T19:13:11.407

这是使用 LINQ 编写它的简单方法：

```
public static IEnumerable<T> MaskToList<T>(Enum mask)
{
    if (typeof(T).IsSubclassOf(typeof(Enum)) == false)
        throw new ArgumentException();

    return Enum.GetValues(typeof(T))
                         .Cast<Enum>()
                         .Where(m => mask.HasFlag(m))
                         .Cast<T>();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T18:54:16.910

如果您想要的最终结果是名称的字符串列表，只需调用`mask.ToString()`.

如果枚举是这样定义的，你会怎么做：

```
[Flags]
enum State
{
    Ready = 1,
    Waiting = 2,
    ReadyAndWaiting = 3
} 
```

至于解决编译器错误，应该这样做：

```
Enum bit = (Enum)(object)curValueBit; 
```

Jon Skeet 有一个名为[unconstrained melody](http://code.google.com/p/unconstrained-melody/)的项目，它允许您在编译后通过重写 IL 来添加枚举约束。这是因为 CLR 支持这样的约束，即使 C# 不支持。

另一个想法：将 GetValues 的返回值直接转换为`T[]`：

```
foreach(T curValueBit in (T[])Enum.GetValues(typeof (T))) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T07:44:17.137

基于[Gabe 的回答](https://stackoverflow.com/a/10112395/1796)，我想出了这个：

```
public static class EnumHelper<T>
    where T : struct
{
    // ReSharper disable StaticFieldInGenericType
    private static readonly Enum[] Values;
    // ReSharper restore StaticFieldInGenericType
    private static readonly T DefaultValue;

    static EnumHelper()
    {
        var type = typeof(T);
        if (type.IsSubclassOf(typeof(Enum)) == false)
        {
            throw new ArgumentException();
        }
        Values = Enum.GetValues(type).Cast<Enum>().ToArray();
        DefaultValue = default(T);
    }

    public static T[] MaskToList(Enum mask, bool ignoreDefault = true)
    {
        var q = Values.Where(mask.HasFlag);
        if (ignoreDefault)
        {
            q = q.Where(v => !v.Equals(DefaultValue));
        }
        return q.Cast<T>().ToArray();
    }
} 
```

我组织的东西有点不同，即我把类型检查（即：验证 T 真的是一个枚举）和枚举值的获取放在静态构造函数中，所以这只完成一次（这将是一个**性能改进**） .

另一件事，我添加了一个**可选参数，因此您可以忽略**枚举的典型“零”/“无”/“NotApplicable”/“未定义”/等值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T19:04:16.543

如果只是做这样的事情怎么办：

```
public static IEnumerable<T> MaskToList<T>(Enum mask)
{
 if (typeof(T).IsSubclassOf(typeof(Enum)) == false)
    throw new ArgumentException();

  List<T> toreturn = new List<T>(100);

  foreach(T curValueBit in Enum.GetValues(typeof (T)).Cast<T>())
  {
    Enum bit = (curValueBit as Enum);  // The only difference is actually here, 
                                       //  use "as", instead of (Enum) cast

    if (mask.HasFlag(bit))
      toreturn.Add(curValueBit);
  }

  return toreturn;
} 
```

由于`as`没有编译时间检查。这里的编译器只是“相信”你，希望你知道自己在做什么，所以*不会引发编译时错误*。

# iphone - 如果我本地化我的 iPhone 应用程序，（描述语言）但不更改我的应用程序，它会被拒绝吗？

> ID：10112092
> 
> 赞同：2
> 
> 时间：2012-04-11T18:49:39.160
> 
> 标签：iphone, ios, localization

我想为我的应用程序的描述添加本地语言，所以我制作了一个新版本，以便我可以本地化描述。但是，我没有将我的任何应用程序更改为依赖于位置（它只是英文，它是一个相当简单的电阻颜色代码计算器应用程序，没有太多文本，并且基于颜色编码进行操作。）我的应用程序会是本身就因为未能真正“本地化”而被拒绝？这是一个严格的指导方针，还是可以只更改应用商店的描述语言？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:01:46.640

我不知道苹果是否会以此为由拒绝你。但是这样做可能会激怒您的客户，我不会责怪他们。我建议您要么本地化所有内容，包括内容，要么不本地化。误导您的客户并不是取得长期成功的途径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:15:19.873

您的应用不应被拒绝。我已经做到了。我的应用程序主要是通用的数字。我已经将描述翻译成 6 种语言，并且该应用在应用商店中就很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T19:24:58.923

不要误导您的用户。你的用户是你最大的盟友还是敌人，这取决于你的态度。如果你不尊重他们，他们就不会喜欢你。

如果您想进行本地化，请创建对多语言的支持，然后您可以添加语言。此外，在我看来，您的用户应该能够选择他们想要使用您的应用程序的语言。默认情况下，您可以选择该地区的语言。但是，按位置进行本地化而不让用户更改他们的语言是不礼貌的。如果您尊重您的用户，您将有更大的成功机会。

# asp.net-mvc-3 - EntityFramework 类的 AllowHtml 属性

> ID：10112094
> 
> 赞同：5
> 
> 时间：2012-04-11T18:49:47.787
> 
> 标签：asp.net-mvc-3, entity-framework-4

在 EntityFramework 自动生成的类的属性上设置 [AllowHtml] 属性是否有不同的方法？我讨厌更改自动生成的文件，因为每次更改模型时，我的更改都会丢失。

但是除了使用属性之外，没有其他明显的方法可以为特定属性设置 [AllowHtml]。有没有一种非属性的方式来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T19:06:08.403

您可以使用[MetadataTypeAttribute](http://msdn.microsoft.com/en-us/library/cc679243.aspx)为关联（伙伴）类中生成的代码指定属性。所以你把你的属性放在一个单独的类中，它不会受到代码重新生成的影响：

```
[MetadataType(typeof(YourEntityMetadata))]
public partial class YourEntityClass
{            
}   

public class YourEntityMetadata
{
    [AllowHtml]
    public string YourPropertyWithHtml { get; set; }
} 
```

Metadata 类中的属性名称应与您的实体属性名称匹配。

# android - NoClassDefFoundError: AdWhirlLayout

> ID：10112096
> 
> 赞同：1
> 
> 时间：2012-04-11T18:49:53.613
> 
> 标签：android, noclassdeffounderror, adwhirl

我在论坛上检查了类似的问题，但无法运行。最后，我删除了不需要关注错误的所有内容，并留下了那段代码。但它仍然会因 NoClassDefFoundError 而崩溃

```
AdWhirlLayout adWhirlLayout = new AdWhirlLayout(TestActivity.this, key); 
```

线。

我正在使用 AdWhirlSDK_Android_3.1.1，但也尝试了 AdWhirlSDK_Android_3.0.0。我有同样的错误。

Java 代码。

```
import com.adwhirl.AdWhirlLayout;

import android.app.Activity;
import android.os.Bundle;
import android.widget.LinearLayout;
import android.widget.RelativeLayout;
import android.widget.LinearLayout.LayoutParams;

public class TestActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        setupAds();
    }

    private void setupAds() {
        String key = "adwhirl_key";

        int diWidth = 320;
        int diHeight = 52;
        float density = getResources().getDisplayMetrics().density;

        LinearLayout layout = (LinearLayout) findViewById(R.id.adView);
        RelativeLayout.LayoutParams layoutParams = 
                new RelativeLayout.LayoutParams(
                        LayoutParams.FILL_PARENT, 
                        LayoutParams.WRAP_CONTENT);

        AdWhirlLayout adWhirlLayout = new AdWhirlLayout(TestActivity.this, key);
        adWhirlLayout.setMaxWidth((int) (diWidth * density));
        adWhirlLayout.setMaxHeight((int) (diHeight * density));

        layout.addView(adWhirlLayout, layoutParams);
        layout.invalidate();
    }
} 
```

XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello" />

    <LinearLayout
        android:id="@+id/adView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />

</LinearLayout> 
```

日志猫：

```
04-11 17:59:50.451: E/AndroidRuntime(707): FATAL EXCEPTION: main
04-11 17:59:50.451: E/AndroidRuntime(707): java.lang.NoClassDefFoundError: com.adwhirl.AdWhirlLayout
04-11 17:59:50.451: E/AndroidRuntime(707):  at com.testproject.TestActivity.setupAds(TestActivity.java:34)
04-11 17:59:50.451: E/AndroidRuntime(707):  at com.testproject.TestActivity.onCreate(TestActivity.java:18)
04-11 17:59:50.451: E/AndroidRuntime(707):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-11 17:59:50.451: E/AndroidRuntime(707):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
04-11 17:59:50.451: E/AndroidRuntime(707):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
04-11 17:59:50.451: E/AndroidRuntime(707):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
04-11 17:59:50.451: E/AndroidRuntime(707):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
04-11 17:59:50.451: E/AndroidRuntime(707):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-11 17:59:50.451: E/AndroidRuntime(707):  at android.os.Looper.loop(Looper.java:123)
04-11 17:59:50.451: E/AndroidRuntime(707):  at android.app.ActivityThread.main(ActivityThread.java:3683)
04-11 17:59:50.451: E/AndroidRuntime(707):  at java.lang.reflect.Method.invokeNative(Native Method)
04-11 17:59:50.451: E/AndroidRuntime(707):  at java.lang.reflect.Method.invoke(Method.java:507)
04-11 17:59:50.451: E/AndroidRuntime(707):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-11 17:59:50.451: E/AndroidRuntime(707):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-11 17:59:50.451: E/AndroidRuntime(707):  at dalvik.system.NativeStart.main(Native Method) 
```

有没有人有想法，可以告诉我我看不到的东西。请。

最好的祝福

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:21:14.320

您绝对应该检查评论中的链接。基本上，您需要通过将所需的库放在“libs”文件夹中来处理 android 中的所有依赖项。Eclipse 不会自动为您生成它，因此您必须自己制作。把“libs”文件夹放到“res”文件夹下（不是bin/res，就是和src共享同一个目录的res文件夹）。

如果您要启动其他活动，还需要确保您的清单中有所有正确的声明，需要这些功能的特殊权限（使用互联网）等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:33:41.127

转到使用 .jar 文件的项目（即正在测试的项目）。单击右键-> 属性-> Java 构建路径-> 订购和导出-> 检查那里的库。[检查此链接以获取屏幕截图。](https://stackoverflow.com/questions/6253173/testing-android-project-with-jar-dependecies)

# tomcat - 在 ELB 下的 Amazon EC2 实例下的 Tomcat 虚拟主机：哪个主机获得 ELB HTTP 健康检查查询？

> ID：10112104
> 
> 赞同：0
> 
> 时间：2012-04-11T18:51:01.797
> 
> 标签：tomcat, amazon-ec2, load-balancing, virtualhost

我在两个 Ubuntu 实例中使用 Tomcat，它们位于 Amazon Web Services 云中的 ELB（弹性负载均衡器）后面。每个 Tomcat 安装在同一引擎中都有多个虚拟主机。ELB 进行健康检查以查看主机是否处于活动状态。但是在主机内部，哪个 Tomcat 虚拟主机会收到健康检查请求？当我定义健康检查时，我只指定端口和 URL 的最后一部分。所以我不知道执行的健康检查的完整 URL 是什么。现在，在引擎中声明为默认主机的 Tomcat 虚拟主机是接受检查的主机，因为它是默认主机。但实际上该主机不是为应用程序提供服务的主机，因此它不应该是接收检查请求的主机。

换句话说：如果检查使用端口 80，并且 URL 的最后一部分是“/hello.html”，那么完整的检查 URL 会在这里：http:///hello.html

“what come here?”的内容是什么？实例的本地/私有 IP？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T01:02:09.963

它总是会转到定义为 localhost 的虚拟主机。

我建议将您想要进行健康检查的虚拟主机设置为 localhost，然后将该虚拟主机上的[主机名别名](http://tomcat.apache.org/tomcat-6.0-doc/config/host.html#Host%20Name%20Aliases)设置为您想要指向它的域名。

所以你会有：

```
 <Host name="localhost" ...>
    <Alias>mydomain.com</Alias>
  </Host> 
```

# java - 将分页设置为默认 JPA CRUD (List.jsp) 的 10

> ID：10112107
> 
> 赞同：-2
> 
> 时间：2012-04-11T18:51:11.187
> 
> 标签：java, jsf, jpa, netbeans, persistence

如何在 JPA CRUD JSF 中将默认号码分页从 5 更改为 10

请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:19:46.907

[这](http://anydoby.com/jblog/en/java/45)可能会有所帮助。

# java - 在 Java 中读取 .java 文件

> ID：10112113
> 
> 赞同：-2
> 
> 时间：2012-04-11T18:51:35.737
> 
> 标签：java, file

我想做一个测试，在我的 Java 项目中读取 .java 文件并将其转换为`String`. 如何在 JUnit 测试中执行此操作（无命令行参数）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T18:55:44.020

您可以将 .java 文件放在已知位置并使用绝对/相对路径`File`访问该文件

或者使用[基于classpath](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Class.html#getResourceAsStream%28java.lang.String%29)`getClass().getResourceAsStream()`来访问

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T14:22:58.830

检索当前工作目录并从那里导航到 java 文件。

```
String curDir = System.getProperty("user.dir"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-11T18:53:53.380

在 Java Commons IO 中，查看 FileUtils 类。

# android - 更改drawable并将其设置为drawableLeft

> ID：10112118
> 
> 赞同：2
> 
> 时间：2012-04-11T18:51:53.857
> 
> 标签：android, bitmap, drawable

我在 LinearLayout 中有一个按钮，我在 XML 中分配了一个 drawableLeft，如下所示：

```
<Button android:id="@+id/button_news"
    style="@style/main_button"
    android:drawableLeft="@drawable/news"
    android:text="@string/button_news" /> 
```

这工作正常，按钮看起来像预期的那样。

![在此处输入图像描述](../Images/7daeac746878243170a3e6c98d9ec2e4.png)

我想以编程方式更改图像以显示可用新闻的数量。这是我的代码：

```
private void updateNewsButton()
{
    // load the original bitmap and draw the number of news on it to show it
    Paint paint = new Paint();
    paint.setColor( Statics.COLOR_GENERAL_HIGHLIGHT );
    paint.setTextAlign( Paint.Align.CENTER );
    paint.setTextSize( 24 );
    paint.setTypeface( Typeface.defaultFromStyle( Typeface.BOLD ) );
    paint.setAntiAlias( true );

    Bitmap bmp = BitmapFactory.decodeResource( getResources(), R.drawable.news ).copy( Config.ARGB_8888, true );
    Canvas canvas = new Canvas( bmp );
    int count = 5;    // TODO: load from database
    canvas.drawText( Integer.toString( count ), bmp.getWidth() / 2, bmp.getHeight() / 2, paint );
    Drawable d = new BitmapDrawable( bmp );
    _btnNews.setCompoundDrawables( d, null, null, null );
} 
```

运行上述代码后，我的按钮上的图像就消失了。我看不出我做错了什么，因为我以前对 ImageView 使用过类似的技术。除了最后两行之外，所有内容都相同。对于 ImageView 我只是直接分配位图：

```
...
imageView.setImageBitmap( bmp ); 
```

我这里需要用到drawableLeft，因为还有几个其他的botton，所以不能再用ImageView了。

知道我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T04:02:54.807

要以编程方式将图像放在左侧的按钮中，请使用以下代码

```
Button button = (Button) findViewById(R.id.mybutton);   
button.setCompoundDrawablesWithIntrinsicBounds(R.drawable.img, 0, 0, 0); 
```

位置是这样的（左，上，右，下）

# javascript - 使用 JS 或 Flash 更改 URL

> ID：10112121
> 
> 赞同：0
> 
> 时间：2012-04-11T18:52:22.263
> 
> 标签：javascript, flash, url

我在我的画廊中使用 AJAX，我需要更改地址栏中的 URL。有可能吗？怎么做？感谢您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T18:55:12.463

更改 URL 并可能转到新位置（如果 URL 不只是“#foo”哈希）：

```
location.href = 'new url'; 
```

如果您想对用户“撒谎”并更改位置而不实际访问该页面：

```
history.pushState({}, "page 2", "bar.html"); 
```

有关后一个示例的更多信息，请阅读：[操纵浏览器历史记录](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T18:57:31.730

您可以设置 # 值之后的 url 部分，称为 location.hash。（否则你会被导航到新的 url，我想你不想要它）。

您可以使用锚点 (href="#abc") 或以编程方式设置 document.location.hash 来设置散列部分。

# sencha-touch-2 - 如何使按钮网格调整大小以适合屏幕？

> ID：10112124
> 
> 赞同：1
> 
> 时间：2012-04-11T18:52:31.327
> 
> 标签：sencha-touch-2

我从另一个问题中获取了这段代码，现在我试图让四个按钮填满整个窗口。

我所做的一切似乎都没有影响。该`fullscreen: true`选项似乎总是被忽略。知道您需要调整布局以占用所有垂直空间的诀窍是什么？

理想情况下，我希望这个解决方案也适用于`3x3`按钮布局。

![在此处输入图像描述](../Images/0b9a9bc462830b437f50596bef5d84cc.png)

* * *

> 应用程序.js

```
Ext.application({

    launch: function() {
        var view = Ext.create('Ext.Container', {
            // fullscreen: true,
            layout: {
                type: 'vbox',
                flex: 1
            },
            items: [{
                xtype: 'container',
                layout: 'hbox',

                items: [{
                    xtype: 'button',
                    height: '50%',
                    text: 'flat button',
                    ui: 'plain',
                    flex: 1,
                    handler: function() {
                        alert('top left')
                    }
                }, {
                    xtype: 'button',
                    height: '50%',
                    //ui: 'plain',
                    flex: 1,
                    handler: function() {
                        alert('top right')
                    }
                }]
            }, {
                xtype: 'container',
                layout: 'hbox',
                items: [{
                    xtype: 'button',
                    height: '50%',
                    //ui: 'plain',
                    flex: 1,
                    handler: function() {
                        alert('bottom left')
                    }
                }, {
                    xtype: 'button',
                    //ui: 'plain',
                    height: '50%',
                    flex: 1,
                    handler: function() {
                        alert('bottom right')
                    }
                }]
            }]
        });
        Ext.Viewport.add(view);
    }
}); 
```

* * *

> 使用 Sencha Touch CDN 的标准 index.html。

```
<!doctype html>
<html manifest="" lang="en-US">

<head>
    <meta charset="UTF-8">
    <title>Sencha</title>
    <link rel="stylesheet" href="http://extjs.cachefly.net/touch/sencha-touch-2.0.0/resources/css/sencha-touch.css" type="text/css">
    <script type="text/javascript" src="http://extjs.cachefly.net/touch/sencha-touch-2.0.0/sencha-touch-all-debug.js"></script>
    <script type="text/javascript" src="app.js"></script>

    <body>
    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:16:11.357

我已经修改了一些东西以满足您的需求（3x3 按钮布局）。祝你好运！:)

P/S：我删除了处理函数以使源代码更容易捕获。

```
Ext.application({

    launch: function() {
        var view = Ext.create('Ext.Container', {
            layout: {
                type: 'vbox',
            },
            items: [
                {
                    xtype: 'container',
                    layout: 'hbox',
                    flex: 1,
                    items:[
                        {
                            xtype:'button',
                            ui: 'action',
                            flex: 1,
                        },
                        {
                            xtype:'button',
                            ui: 'action',
                            flex: 1,
                        },
                        {
                            xtype:'button',
                            ui: 'action',
                            flex: 1,
                        }
                    ]
                },
                {
                    xtype: 'container',

                    layout: 'hbox',
                    flex: 1,

                    items:[
                        {
                            xtype:'button',
                            ui: 'action',
                            flex: 1,
                        },
                        {
                            xtype:'button',
                            ui: 'action',
                            flex: 1,
                        },
                        {
                            xtype:'button',
                            ui: 'action',
                            flex: 1,
                        }
                    ]
                },
                {
                    xtype: 'container',

                    layout: 'hbox',
                    flex: 1,

                    items:[
                        {
                            xtype:'button',
                            ui: 'action',
                            flex: 1,
                        },
                        {
                            xtype:'button',
                            ui: 'action',
                            flex: 1,
                        },
                        {
                            xtype:'button',
                            ui: 'action',
                            flex: 1,
                        }
                    ]
                }
            ]
        });
        Ext.Viewport.add(view);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:29:14.250

Thiem Nguyen 的答案可能适用于您的需要，但这适用于在屏幕上拉伸按钮。

```
view = Ext.create('Ext.Container', {
        layout:'hbox',
        items:[ {
            xtype: 'container',
            width:'50%',
            layout: 'vbox',
            items:[{
                xtype:'button',
               // ui: 'plain',
                flex: 1,
                handler:function(){
                    alert('top left')
                }
            },{
                xtype:'button',
              // ui: 'plain',
                flex: 1,
                handler:function(){
                    alert('top right')
                }
            }]
        },{

            xtype: 'container',
            width:'50%',
            layout: 'vbox',
            items:[{
                xtype:'button',
               // ui: 'plain',
                flex: 1,
                handler:function(){
                    alert('bottom left')
                }
            },{
                xtype:'button',
              //  ui: 'plain',
                flex: 1,
                handler:function(){
                    alert('bottom right')
                }
            }]
        }]
}); 
```

# xml - 元素的 XML / XSD“扩展”始终具有未定义的 complexType

> ID：10112128
> 
> 赞同：4
> 
> 时间：2012-04-11T18:52:48.327
> 
> 标签：xml, xsd, ref, complextype

我正在尝试编写一个扩展元素中定义的 ComplexType 的 XSD 架构。

我正在尝试使用 Notepad++ XMLTools 插件来解决问题，但我总是得到“无法解析架构文件”。没有错误的描述，所以我一直在使用位于此处的验证器来获取更多详细信息：

[http://www.xmlforasp.net/schemavalidator.aspx](http://www.xmlforasp.net/schemavalidator.aspx)

我从中得到的输出是：

*状态：* **未定义的 complexType 'http://test.org:BaseClass' 用作复杂类型扩展的基础。**

我尝试在 xs:schema 标记中删除 :test 命名空间，我尝试从 ClassHierarchy 中的 ref 中删除 test: 命名空间限定符，并且我尝试将命名空间添加到元素定义中，但我无法获得架构以通过验证。

任何帮助将不胜感激！谢谢

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema
    xmlns:test="http://test.org"
    targetNamespace="http://test.org"
    elementFormDefault="qualified"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">

    <xs:element name="BaseClass">
        <xs:complexType>
            <!-- More referneces in here (Meaning this must be a complex type) but removed out to make a bit simpler -->
            <xs:attribute name="test_name" type="xs:string" use="required"/>
            <xs:attribute name="second_name" type="xs:string"/>
        </xs:complexType>
    </xs:element>

    <xs:element name="SubClass">
        <xs:complexType>
            <xs:complexContent>
                <xs:extension base="test:BaseClass">
                    <xs:attribute name="min_value" type="xs:float" default="0.0"/>
                    <xs:attribute name="max_value" type="xs:float" default="1.0"/>
                </xs:extension>
            </xs:complexContent>
        </xs:complexType>
    </xs:element>

    <xs:element name="ClassHierarchy">
        <xs:complexType>
            <xs:sequence>
                <xs:choice minOccurs="0" maxOccurs="unbounded">
                    <xs:element ref="test:BaseClass" minOccurs="0" maxOccurs="unbounded"/>
                    <xs:element ref="test:SubClass" minOccurs="0" maxOccurs="unbounded"/>
                </xs:choice>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

XML 文件包含：

```
<?xml version="1.0"?>
    <ClassHierarchy
    xmlns="http://test.org"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://test.org Test.xsd">
        <BaseClass test_name="Test1" />
        <SubClass test_name="Test2" min_value="0.0" max_value="1.0" />
    </ClassHierarchy> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:20:25.387

问题是您正在尝试将基本类型值设置为元素。但是“类型”是预期的。你应该让它更像这样：

```
<xs:element name="BaseClass" type="BaseType" />

<xs:complexType name="BaseType">
      ...
</xs:complexType>

<xs:complexType name="SubType">
   <xs:complexContent>
       <xs:extension base="BaseType">
           ....
       </xs:complexContent>
</xs:complexType> 
```

# c++ - 用一个简单的例子理解 C++ 中的 LAPACK 调用

> ID：10112135
> 
> 赞同：19
> 
> 时间：2012-04-11T18:53:33.073
> 
> 标签：c++, fortran, lapack

我是 LAPACK 和 C++/Fortran 接口的初学者。我需要在 Mac OS-X Lion 上使用 LAPACK/BLAS 解决线性方程和特征值问题。OS-X Lion 提供优化的 BLAS 和 LAPACK 库（在 /usr/lib 中），我链接这些库而不是从 netlib 下载它们。

我的程序（转载如下）正在编译和运行良好，但它给了我错误的答案。我在网络和 Stackoverflow 中进行了研究，问题可能必须处理 C++ 和 Fortran 如何以不同格式存储数组（行专业与列专业）。但是，正如您将在我的示例中看到的那样，我示例的简单数组在 C++ 和 fortran 中应该看起来相同。反正就到这里了。

假设我们要解决以下线性系统：

x + y = 2

x - y = 0

解是 (x,y) = (1,1)。现在我尝试使用 Lapack 解决这个问题，如下所示

```
// LAPACK test code

#include<iostream>
#include<vector>

using namespace std;
extern "C" void dgetrs(char *TRANS, int *N, int *NRHS, double *A, 
                      int *LDA, int *IPIV, double *B, int *LDB, int *INFO );

int main()
{
    char trans = 'N';
    int dim = 2;    
    int nrhs = 1;
    int LDA = dim;
    int LDB = dim;
    int info;

    vector<double> a, b;

    a.push_back(1);
    a.push_back(1);
    a.push_back(1);
    a.push_back(-1);

    b.push_back(2);
    b.push_back(0);

    int ipiv[3];

    dgetrs(&trans, &dim, &nrhs, & *a.begin(), &LDA, ipiv, & *b.begin(), &LDB, &info);

    std::cout << "solution is:";    
    std::cout << "[" << b[0] << ", " << b[1] << ", " << "]" << std::endl;
    std::cout << "Info = " << info << std::endl; 

    return(0);
} 
```

这段代码编译如下：

`g++ -Wall -llapack -lblas lapacktest.cpp`

但是，在运行此程序时，我得到的解决方案是 (-2,2)，这显然是错误的。我已经尝试了矩阵的所有行/列重新排列组合`a`。还要观察矩阵表示`a`在行和列格式中应该是相同的。我认为让这个简单的例子工作将使我开始使用 LAPACK，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-11T18:58:15.893

您需要先*分解*矩阵（通过调用`dgetrf`），然后才能使用`dgetrs`. 或者，您可以使用`dgesv`例程，它会为您完成这两个步骤。

顺便说一句，您不需要自己声明接口，它们位于 Accelerate 标头中：

```
// LAPACK test code

#include <iostream>
#include <vector>
#include <Accelerate/Accelerate.h>

using namespace std;

int main()
{
    char trans = 'N';
    int dim = 2;    
    int nrhs = 1;
    int LDA = dim;
    int LDB = dim;
    int info;

    vector<double> a, b;

    a.push_back(1);
    a.push_back(1);
    a.push_back(1);
    a.push_back(-1);

    b.push_back(2);
    b.push_back(0);

    int ipiv[3];

    dgetrf_(&dim, &dim, &*a.begin(), &LDA, ipiv, &info);
    dgetrs_(&trans, &dim, &nrhs, & *a.begin(), &LDA, ipiv, & *b.begin(), &LDB, &info);

    std::cout << "solution is:";    
    std::cout << "[" << b[0] << ", " << b[1] << ", " << "]" << std::endl;
    std::cout << "Info = " << info << std::endl; 

    return(0);
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-09-08T21:22:50.403

对于那些不想使用 Accelerate Framework 的人，我提供了 Stephen Canon 的代码（当然要感谢他），只有纯库链接

```
// LAPACK test code
//compile with: g++ main.cpp -llapack -lblas -o testprog

#include <iostream>
#include <vector>

using namespace std;

extern "C" void dgetrf_(int* dim1, int* dim2, double* a, int* lda, int* ipiv, int* info);
extern "C" void dgetrs_(char *TRANS, int *N, int *NRHS, double *A, int *LDA, int *IPIV, double *B, int *LDB, int *INFO );

int main()
{
    char trans = 'N';
    int dim = 2;
    int nrhs = 1;
    int LDA = dim;
    int LDB = dim;
    int info;

    vector<double> a, b;

    a.push_back(1);
    a.push_back(1);
    a.push_back(1);
    a.push_back(-1);

    b.push_back(2);
    b.push_back(0);

    int ipiv[3];

    dgetrf_(&dim, &dim, &*a.begin(), &LDA, ipiv, &info);
    dgetrs_(&trans, &dim, &nrhs, & *a.begin(), &LDA, ipiv, & *b.begin(), &LDB, &info);

    std::cout << "solution is:";
    std::cout << "[" << b[0] << ", " << b[1] << ", " << "]" << std::endl;
    std::cout << "Info = " << info << std::endl;

    return(0);
} 
```

关于手册，英特尔网站上有完整的 PDF 版本。这是他们的 HTML 文档示例。

[http://software.intel.com/sites/products/documentation/hpc/mkl/mklman/GUID-A02DB70F-9704-42A4-9071-D409D783D911.htm](http://software.intel.com/sites/products/documentation/hpc/mkl/mklman/GUID-A02DB70F-9704-42A4-9071-D409D783D911.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-02T18:01:36.990

如果你想使用 C++ 中的 LAPACK，你可能想看看[FLENS](http://flens.sf.net)。它定义了 LAPACK 的低级和高级接口，但也重新实现了一些 LAPACK 功能。

使用低级 FLENS-LAPACK 接口，您可以使用自己的矩阵/向量类型（如果它们具有符合 LAPACK 的内存布局）。你的电话`dgetrf`看起来像这样：

```
info = lapack::getrf(NoTrans, dim, nrhs, a.begin(), LDA, ipiv); 
```

并且对于`dgetrs`

```
lapack::getrs(NoTrans, dim, nrhs, a.begin(), LDA, ipiv, b.begin(), LDB); 
```

因此，低级 FLENS-LAPACK 函数在元素类型方面是重载的。因此 LAPACK 函数`sgetrs`, `dgetrs`, `cgetrs`,`zgetrs`位于 FLENS-LAPACK 的低级接口中`lapack::getrs`。您还可以通过值/引用而不是作为指针传递参数（例如`LDA`，而不是`&LDA`）。

如果您使用 FLENS 矩阵类型，您可以将其编码为

```
info = lapack::trf(NoTrans, A, ipiv);
if (info==0) {
    lapack::trs(NoTrans, A, ipiv, b);
} 
```

或者你只是使用 LAPACK 驱动函数`dgesv`

```
lapack::sv(NoTrans, A, ipiv, b); 
```

这里是[FLENS-LAPACK](http://apfel.mathematik.uni-ulm.de/~lehn/FLENS/flens/lapack/lapack.html)驱动程序函数的列表。

免责声明：是的，FLENS 是我的宝贝！这意味着我编写了大约 95% 的代码，每一行代码都是值得的。

# sql-server - 根据序数和属性数据选择前 n 条记录

> ID：10112137
> 
> 赞同：1
> 
> 时间：2012-04-11T18:53:38.050
> 
> 标签：sql-server, sql-server-2008, tsql

我有一种情况，我需要根据表中的设置和序数集仅显示顶行。

下面的示例数据集显示了两个客户；每个客户都有不同的产品。由于`NumRowsToShow`是“1”，我只想为每个客户显示一行（基于序数的第一行）。

```
| CustomerID | ProductID | Ordinal | NumRowsToShow |
+------------+-----------+---------+---------------+
| 1          |A          |1        |1              |
| 1          |B          |2        |1              |
| 1          |C          |3        |1              |
| 5          |D          |1        |1              |
| 5          |E          |2        |1              |
| 5          |F          |3        |1              | 
```

查询运行后的结果集应该是

```
| CustomerID | ProductID |
+------------+-----------+
| 1          |A          |
| 5          |D          | 
```

在相同的场景中，如果`NumRowsToShow`customerID 1 为 1，CustomerID 5 为 2，我会看到类似的东西。

```
| CustomerID | ProductID | Ordinal | NumRowsToShow |
+------------+-----------+---------+---------------+
| 1          |A          |1        |1              |
| 1          |B          |2        |1              |
| 1          |C          |3        |1              |
| 5          |D          |1        |2              |
| 5          |E          |2        |2              |
| 5          |F          |3        |2              | 
```

查询运行后的结果集应该是

```
| CustomerID | ProductID |
+------------+-----------+
| 1          |A          |
| 5          |D          |
| 5          |E          | 
```

如何才能做到这一点？

包括一个实际结果集的屏幕截图，其中包含我试图过滤的内容的亮点，这可能会有所帮助。

[![屏幕截图](../Images/530d9fda1ae352366191c4922db09d74.png)](https://i.stack.imgur.com/LjXev.jpg)
[（来源：[harpernet.net](http://www.harpernet.net/se/cap01.jpg)）]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T18:58:18.173

感觉就像“考试作弊”：

```
SELECT CustomerID, ProductID
FROM tableX
WHERE Ordinal <= NumRowsToShow 
```

* * *

如果正如评论所暗示的那样，`Ordinal`可以有`10, 20, 30`值而不仅仅是`1, ..., n`值，那么这将起作用：

```
SELECT t.CustomerID, t.ProductID
FROM tableX AS t
  JOIN tableX AS tt
    ON  tt.CustomerID = t.CustomerID
    AND tt.Ordinal <= t.Ordinal
GROUP BY t.CustomerID
       , t.ProductID
       , t.NumRowsToShow
HAVING COUNT(*) <= t.NumRowsToShow 
```

甚至更好的是：

```
SELECT CustomerID, ProductID
FROM
  ( SELECT CustomerID, ProductID, NumRowsToShow
         , ROW_NUMBER() OVER( PARTITION BY CustomerID 
                              ORDER BY Ordinal
                            ) AS Rn
    FROM tableX
  ) AS tmp
WHERE Rn <= NumRowsToShow ; 
```

测试：[SQL-Fiddle](http://sqlfiddle.com/#!3/f26e0/3)

* * *

您的表格看起来没有标准化。这些`NumRowsToShow`列具有重复的信息，这可能导致更新异常。这：

```
| CustomerID | ProductID | Ordinal | NumRowsToShow |
+------------+-----------+---------+---------------+
| 1          |A          |1        |1              |
| 1          |B          |2        |1              |
| 1          |C          |3        |1              |
| 5          |D          |1        |2              |
| 5          |E          |2        |2              |
| 5          |F          |3        |2              | 
```

可以归一化为2个表：

```
| CustomerID | ProductID | Ordinal |
+------------+-----------+---------+
| 1          |A          |1        |
| 1          |B          |2        |
| 1          |C          |3        |
| 5          |D          |1        |
| 5          |E          |2        |
| 5          |F          |3        | 
```

和：

```
| CustomerID | NumRowsToShow |
+------------+---------------+
| 1          |1              |
| 5          |2              | 
```

# javascript - 如何使用 Twitter 的 bootstrap typeahead 实现电子邮件自动补全？

> ID：10112140
> 
> 赞同：1
> 
> 时间：2012-04-11T18:53:47.090
> 
> 标签：javascript, jquery, email, twitter-bootstrap, typeahead

即如何修改[Twitter 的引导输入](http://twitter.github.com/bootstrap/javascript.html#typeahead)代码以忽略符号 @ 之前的所有内容？因此，当用户输入电子邮件时，一旦输入@，我们应该从预定义的列表（如 gmail.com、yahoo.com、att.net 等）中为他推荐域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:13:53.143

不，如果没有一些额外的魔法，你就无法做到这一点。幸运的是，这个魔法非常简单有趣。我真的很喜欢解决这个难题:)

考虑我创建的这个[**例子。**](http://jsfiddle.net/hyxMh/2/)

```
$.fn.typeahead.Constructor.prototype.select = function() {
    var val = this.$menu.find('.active').attr('data-value'),
        newVal = this.$element.val().replace(/@.*$/, '@' + val);
    this.$element.val(newVal);
    this.$element.change();
    return this.hide();
};

$('#email').typeahead({
    source: ['gmail', 'hotmail', 'yahoo'],
    matcher: function(item) {
        var m = this.query.indexOf('@'),
            search;

        if (!~m) {
            return false;
        }

        search = this.query.substr(m + 1).toLowerCase();
        return search.length && ~item.toLowerCase().indexOf(search);
    }
}); 
```

首先，您需要定义自定义`matcher`函数以定义哪些值被认为是合适的。这很容易。复杂的部分是您需要更改 Typeahead 原型以使插件设置正确的输入字段的新值：例如，不是`gmail`，'yahoo'，而是完整的电子邮件地址`tomas@gmail.com`，等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-07T04:17:45.883

其实我们不需要做一些扩展，像这样使用ajax函数就可以了。

```
$('.typeahead').typeahead({
    source: function (typeahead, query) {

     var con = $('#input1').val();
     var atpos = con.indexOf('@');
     if(atpos==-1){
        return [con+'@gmail.com',con+'@sina.com',con+'@qq.com',con+'@126.com'];
     }else if(atpos>0){
         //get value before @
         var tmp = con.substr(0,atpos);
         return [tmp+'@gmail.com',tmp+'@sina.com',tmp+'@qq.com',tmp+'@126.com'];
     }else{

     }
     //return ['alpha','beta','bravo','delta','epsilon','gamma','zulu'];
    }
}); 
```

# elastic-map-reduce - Ganglia 和 Amazon Elastic Map Reduce - 安装问题

> ID：10112146
> 
> 赞同：1
> 
> 时间：2012-04-11T18:53:59.930
> 
> 标签：elastic-map-reduce, ganglia

按照“在作业流上初始化 Ganglia”的说明，我启动了我的集群，但没有看到任何 Ganglia 进程正在运行（在 8157 上）。

[http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/init_Ganglia.html](http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/init_Ganglia.html)

elastic-mapreduce --create --alive --name "Tom's Daily Hive 8x Flow" --instance-type c1.medium --num-instances 8 --availability-zone us-east-1a --bootstrap-action "s3 ://elasticmapreduce/bootstrap-actions/install-ganglia" --stream

有一个0K文件在：/tmp/ganglia-installed

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T16:43:25.590

好的......所以事实证明亚马逊的说明对细节有点轻描淡写。

试试这里[http://ecs-network.serv.pacific.edu/ecpe-293a/projects/commoncrawl-tutorial](http://ecs-network.serv.pacific.edu/ecpe-293a/projects/commoncrawl-tutorial)和这里[http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/UsingtheHadoopUserInterface.html#AccessingtheHadoopUserInterfacetoMonitorJobStatus2](http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/UsingtheHadoopUserInterface.html#AccessingtheHadoopUserInterfacetoMonitorJobStatus2)

你会做得更好。

我对端口转发经验很了解，他们在 EMR 说明中的内容让我走上了许多错误的道路（猜测）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T04:01:38.350

您的创建集群命令看起来不错。在 Firefox 上设置 FoxyProxy，就像他们在您在问题中提到的同一文档中提到的那样。

设置完成后，转到`localhost:8157/ganglia`，这应该会带你到你的监控图！

# r - zoo包出错，数据太长？

> ID：10112149
> 
> 赞同：1
> 
> 时间：2012-04-11T18:54:25.000
> 
> 标签：r, zoo, na

我想生成一个具有指定 bin 宽度的运行平均值的新列，为此我使用了 zoo 包（rollmean 函数）。我的数据表由 100 万行组成，该函数适用于前 500,000 行，之后是所有的 NA，有什么想法我可能做错了吗？

```
library("zoo")

HB<-bin/2
n<-length(dataraw$S)
data<-dataraw[HB:(n-HB),]
sax<- rollmean (dataraw$S, bin)
data2<-cbind(data,sax) 
```

我会很感激你能给我的任何帮助，我已经坚持了太久了。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T18:56:37.363

你几乎可以肯定那里有一个 NA ，然后通过`rollmean()`. 正如这个小实验所示，一百万个值本身不会造成麻烦：

```
R> library(zoo)
R> X <- zoo(rnorm(1e6), order.by=Sys.time()+seq(1,1e6)*1e-3)
R> Xrm <- rollmean(X, 63)
R> summary(cbind(X, Xrm))
     Index                             X                Xrm         
 Min.   :2012-04-11 13:57:28.9   Min.   :-5.1857   Min.   :-0.5843  
 1st Qu.:2012-04-11 14:01:38.9   1st Qu.:-0.6741   1st Qu.:-0.0866  
 Median :2012-04-11 14:05:48.9   Median :-0.0011   Median :-0.0013  
 Mean   :2012-04-11 14:05:48.9   Mean   :-0.0011   Mean   :-0.0011  
 3rd Qu.:2012-04-11 14:09:58.9   3rd Qu.: 0.6727   3rd Qu.: 0.0838  
 Max.   :2012-04-11 14:14:08.9   Max.   : 4.8914   Max.   : 0.5874  
                                                   NA's   :62       
R> 
```

这里唯一的 NA 是由于在开始时引入了初始滞后。

但是当我在 X 中引入一个单一的 NA 时，一切都崩溃了：

```
R> X[567890] <- NA
R> summary(cbind(X, rollmean(X, 63)))
     Index                             X            rollmean(X, 63) 
 Min.   :2012-04-11 13:57:28.9   Min.   :-5.18574   Min.   :-1      
 1st Qu.:2012-04-11 14:01:38.9   1st Qu.:-0.67413   1st Qu.: 0      
 Median :2012-04-11 14:05:48.9   Median :-0.00110   Median : 0      
 Mean   :2012-04-11 14:05:48.9   Mean   :-0.00109   Mean   : 0      
 3rd Qu.:2012-04-11 14:09:58.9   3rd Qu.: 0.67268   3rd Qu.: 0      
 Max.   :2012-04-11 14:14:08.9   Max.   : 4.89137   Max.   : 1      
                                 NA's   :1          NA's   :432173  
R> 
```

我最终得到了 432k 的尾随 NA。

# c# - 动态加载程序集的多个版本

> ID：10112154
> 
> 赞同：2
> 
> 时间：2012-04-11T18:54:55.847
> 
> 标签：c#, .net, assemblies

我正在编写一个测试应用程序来执行一些回归测试。这个想法是能够在库的多个版本上运行测试。我的目标是将dll加载到字典中，其中键是版本字符串（例如“3.0.0.0”），值是Assembly实例。我能够动态加载一个程序集并在其上调用一个方法，但是当我尝试加载第二个程序集时，出现以下异常：

```
The located assembly's manifest definition does not match the assembly reference. 
```

我正在使用以下行加载程序集：

```
asm = Assembly.LoadFrom(lib, hash, System.Configuration.Assemblies.AssemblyHashAlgorithm.MD5); 
```

'lib' 是 dll 的完整文件名和路径。'hash' 是 dll 的 md5 和。

我看起来即使我告诉 Windows“使用这个 dll”，它也会查看名称并说“我已经拥有那个”并使用先前加载的一个，并且由于哈希不匹配，它会失败。最初，正在加载的 dll 没有设置程序集版本，所以我将它设置为 4 个不同的版本，但它仍然抛出了相同的异常。

解决方法是什么？

乔丹

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T19:36:38.977

您不能将同一程序集的多个版本加载到单个[AppDomain](http://msdn.microsoft.com/en-us/library/system.appdomain.aspx)中。同样，一旦加载，程序集就无法从 AppDomain 中卸载（.NET 4 中动态创建的临时程序集除外），但可以卸载整个 AppDomain（卸载所有加载到其中的程序集）。因此，您必须将程序集的每个版本加载到单独的（新创建的）AppDomain 中。还要非常小心，不要在各个 AppDomain 之间传递对已加载程序集的任何引用（尤其是对您的测试应用程序所在的主 AppDomain），因为否则 .NET 将尝试将程序集加载到每个 AppDomain 中，其中出现对此程序集的引用并且您将再次出现相同的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T18:58:47.033

您需要将程序集放入单独的 AppDomain。

# c# - 从 ConcurrentDictionary 转换为 IDictionary

> ID：10112157
> 
> 赞同：6
> 
> 时间：2012-04-11T18:55:14.283
> 
> 标签：c#, .net, concurrency, thread-safety

由于 IDictionary 没有 GetOrAdd 和 AddOrUpdate 方法，从 ConcurrentDictionary 到 IDictionary 的转换是否会切断线程安全的实现？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T19:04:40.370

结果对象仍然是并发字典。Add 或 Remove 之类的调用使用底层实现 TryAdd 和 TryRemove（它们是线程安全的）。将对象转换为不同的类型不会改变对象本身。

此外，为了澄清起见，您可以使用 ILSpy 之类的工具来查看默认 IDictionary 方法的实现是什么，以及它们是否仍然是线程安全的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-11T19:02:30.753

`IDictionary`只是一个界面。如果你转换为它，结果是 ConcurrentDictionary 的实现，缺少`GetOrAdd`and`AddOrUpdate`方法。

据推测，您仍然可以使用[`Item`](http://msdn.microsoft.com/en-us/library/dd267253.aspx)property 和 [`Add`](http://msdn.microsoft.com/en-us/library/63ywd54z.aspx)and[`ContainsKey`](http://msdn.microsoft.com/en-us/library/htszx2dy.aspx)方法（代替`GetOrAdd`and `AddOrUpdate`）方法，并且您的转换对象仍然是线程安全的（因为底层实现是 a `ConcurrentDictionary`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T19:02:59.023

接口不影响实现。它只是没有暴露一些`ConcurrentDictionary`'s 方法。

您可能会发现[这个](https://stackoverflow.com/questions/761194/interface-vs-abstract-class-general-oo)或[这个](https://stackoverflow.com/questions/122883/interfaces-why-cant-i-seem-to-grasp-them)有助于理解接口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T19:11:30.593

这就像`ConcurrentDictionary`通过形状的钥匙孔看大物体`IDictionary`- 你只能看到`IDictionary`形状，但它仍然是`ConcurrentDictionary`。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-04-11T19:20:39.613

简短的回答没有。

您正在通过接口操作对象，因此仍在使用具体实现。您不会丢失任何功能或其方法。它们只是不可用。

在旁注中，向下转换时需要显式转换，向上转换时不需要显式转换 - 这样做总是安全的。

# eclipse - 如何在 eclipse cdt 中禁用调试优化

> ID：10112160
> 
> 赞同：0
> 
> 时间：2012-04-11T18:55:44.600
> 
> 标签：eclipse

我想在 eclipse cdt 中停止调试优化，并阅读了有关此的文章

[http://husks.wordpress.com/2012/03/29/hardware-debugging-the-arduino-using-eclipse-and-the-avr-dragon/](http://husks.wordpress.com/2012/03/29/hardware-debugging-the-arduino-using-eclipse-and-the-avr-dragon/)

它应该在 eclipse indigo 中看到工具设置，但我没有看到。

问题是什么

看到这个了解更多信息

[https://sourceforge.net/projects/cmusphinx/forums/forum/5471/topic/5170910](https://sourceforge.net/projects/cmusphinx/forums/forum/5471/topic/5170910)

这是我的制作文件

```
TOP=../../..
DIRNAME=src/programs/init_gau
BUILD_DIRS = 
ALL_DIRS= $(BUILD_DIRS)
SRCS = \
  accum.c \
  init_gau.c \
  main.c \
  parse_cmd_ln.c
H = \
  accum.h \
  init_gau.h \
  mk_sseq.h \
  parse_cmd_ln.h

FILES = Makefile $(SRCS) $(H)
TARGET = init_gau

ALL = $(BINDIR)/$(TARGET)

include $(TOP)/config/common_make_rules 
```

我找到了这个配置文件

```
# -*- makefile -*-
#
# This file is automatically generated by configure.
# Do not hand edit.

CC       = gcc
CFLAGS   = -g -O0 -Wall -fPIC -DPIC
CPPFLAGS = -I/media/sda5/sphinx/tutorial/SphinxTrain/../sphinxbase/include -I/media/sda5/sphinx/tutorial/SphinxTrain/../sphinxbase/include 
DEFS     = -DPACKAGE_NAME=\"SphinxTrain\" -DPACKAGE_TARNAME=\"sphinxtrain\" -DPACKAGE_VERSION=\"1.0.99\" -DPACKAGE_STRING=\"SphinxTrain\ 1.0.99\" -DPACKAGE_BUGREPORT=\"\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_LIBM=1
LIBS     = -lm  -lsphinxbase
LDFLAGS  =  -L/media/sda5/sphinx/tutorial/SphinxTrain/../sphinxbase/src/libsphinxad           -L/media/sda5/sphinx/tutorial/SphinxTrain/../sphinxbase/src/libsphinxbase           -L/media/sda5/sphinx/tutorial/SphinxTrain/../sphinxbase/src/libsphinxbase/.libs

AR       = ar
RANLIB   = ranlib

FESTIVAL = /usr/bin/festival
PERL     = /usr/bin/perl 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T05:00:38.477

这些选项位于项目属性下，如第一个教程中所述。如果您尝试使用现有的 makefile 构建项目，则需要编辑 makefile。您通常不需要更改项目属性。默认情况下调试配置构建而不进行优化。你只需要确保你选中它。这是使用图标完成的（日晷？- CDT 构建（锤子）旁边的那个）。

# filenames - SAS - 正确生成变量文件名

> ID：10112161
> 
> 赞同：1
> 
> 时间：2012-04-11T18:55:55.350
> 
> 标签：filenames, sas, sas-macro

我正在尝试生成一个变量文件名。

ods pdf 文件 = "D:\FileDirectory\&&mFileNameVariable&I .pdf" notoc;

这会生成一个可变文件名，但会在扩展名之前添加一个空格（例如 FileName .pdf；我需要 FileName.pdf）。

我读到你可以做这样的事情：

ods pdf 文件 = "D:\FileDirectory\&&mFileNameVariable&I..pdf" notoc;

为扩展添加点；但是，当我尝试该宏不起作用时，我会得到一个所见即所得的值（例如 &&mFileNameVariable&I.pdf）。

我假设它是因为我的字符串以“&I”结尾。

我想到的另一个解决方案，但它不必要/解决方法是分别修剪（FilePathAndName）和/或连接猫（FilePathAndName FileExtension）值。

非常感谢任何见解或反馈，提前感谢您的时间和帮助。

干杯!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T19:16:19.627

由于您正在执行两次宏解析过程，因此您需要在文件名和扩展名之间有一个额外的句点（总共三个，在宏解析期间需要咀嚼 2 个，一个代表分隔符）。

例如

```
%let mFileNameVariable1=myfile;
%let l=1;
ods pdf file="C:\Temp\&&mFileNameVariable&l...pdf" notoc;  /*note 3 periods!!*/ 
```

登录

```
NOTE: Writing ODS PDF output to DISK destination "C:\Temp\myfile.pdf", printer "PDF". 
```

# java - 内部类：Android vs Java

> ID：10112163
> 
> 赞同：7
> 
> 时间：2012-04-11T18:56:01.353
> 
> 标签：java, android

我知道在 Android 中不建议使用内部类，因为它们包含对封闭类的引用。但是，在 Java 中，只有当不再引用内部类时，才会对外部类进行 GC。这意味着，在 Android 中，如果您在外部活动类中对内部类有一个非静态引用，则内部类不能比外部活动类存在的时间更长，因为活动只有在没有引用的情况下才能被销毁不再是内部类（至少这是我所推断的）。那么使用非静态内部类有什么问题（因为如果你从java推断，它们显然不能比外部活动存在更长的时间）？我错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T19:04:23.297

考虑这个简单的例子

```
class Leaker 
{
    public static Object leakedObj;
}

class MyActivity extends Activity
{
     public class MyInnerClass { ... }

     void onCreate(Bundle savedState) 
     {
        Leaker.leakedObj = new MyInnerClass();
        //The activity now won't be GCed until Leaker.leakedObj is cleared.          
     }
} 
```

您可以轻松地在活动上下文之外传递内部非静态类。只要您不将内部类传递给 Activity 生命周期之外的对象，就应该没问题。但肯定有可能通过内部类泄露您的活动。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-11T19:04:43.707

我不会费心解释，因为谷歌可以更好地解释它。

假设：父类是`Foo`，内部类是`Foo$Inner`：

问题是 VM 认为从 Foo$Inner 直接访问 Foo 的私有成员是非法的，因为 Foo 和 Foo$Inner 是不同的类，即使 Java 语言允许内部类访问外部类的私有成员。为了弥补差距，编译器生成了几个合成方法：

```
/*package*/ static int Foo.access$100(Foo foo) {
    return foo.mValue;
}
/*package*/ static void Foo.access$200(Foo foo, int value) {
    foo.doStuff(value);
} 
```

每当需要访问 mValue 字段或调用外部类中的 doStuff 方法时，内部类代码都会调用这些静态方法。这意味着上面的代码实际上归结为您通过访问器方法访问成员字段的情况。之前我们谈到了访问器是如何比直接字段访问慢的，所以这是一个特定的语言习惯用法导致“无形”性能下降的例子。

如果您在性能热点中使用这样的代码，您可以通过将内部类访问的字段和方法声明为具有包访问权限而不是私有访问权限来避免开销。不幸的是，这意味着这些字段可以被同一个包中的其他类直接访问，所以你不应该在公共 API 中使用它。

来源：[https ://developer.android.com/training/articles/perf-tips.html#PackageInner](https://developer.android.com/training/articles/perf-tips.html#PackageInner)

# ios - iOS模拟器应用程序的终端命令行调试？

> ID：10112164
> 
> 赞同：17
> 
> 时间：2012-04-11T18:56:01.293
> 
> 标签：ios, xcode, macos, debugging, lldb

是否可以从 Mac OS X 下的终端命令行使用 GDB 或 LLDB 来调试在 iOS 模拟器上运行的应用程序？（例如，不是来自 Xcode 的 GUI 或控制台，而是使用外部命令行或进程）。如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-11T19:18:10.050

您需要已经在模拟器的 Springboard 中安装了该应用程序；您无法从 Xcode 在模拟器中启动应用程序，然后期望能够将 gdb 的命令行实例附加到它。

所以：

1.  运行 iOS 模拟器，已经将您的应用程序放入其中。
2.  在终端窗口中：

```
    %gdb
    ...
    (gdb) attach --waitfor '您的应用程序的名称'

```

1.  从模拟器 Springboard 启动您的应用程序。
2.  *gdb 应该在执行之前* 附加到进程`main()`。所以你可以设置一些断点，或者其他什么。然后：

```
    (gdb) 继续

```

的过程`lldb`类似：

```
    %lldb
    (lldb) process attach -n 'Name Of Your App' --waitfor
    <在模拟器中启动您的应用程序>
    (lldb) 继续

```

我不确定您为什么想要或需要这样做，但作为一个老命令行 gdb（和 dbx）的人，我可以理解它。:-)

# facebook - 代表用户在公司 Facebook 页面墙上发帖

> ID：10112166
> 
> 赞同：0
> 
> 时间：2012-04-11T18:56:26.297
> 
> 标签：facebook, windows-phone-7, facebook-graph-api, facebook-c#-sdk

我有一个与 facebook 连接的 wp7 应用程序，假设我有用户访问令牌

我想知道是否可以作为用户在某些公司 Facebook 页面的墙上写字。（我没有 Facebook 页面的所有权，也没有以任何方式附属于它）

如果是，您知道我需要获得哪个许可吗？很想得到任何类型的代码片段或我应该遵循的方向。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T21:09:09.740

不可能在墙上写上用户的行为。你总是在 Facebook 应用程序的上下文中获得一个令牌 - 所以它将是应用程序发布在墙上，而不是用户。应用程序可以向用户请求的最大权限是[publish_stream](https://i.stack.imgur.com/NginR.png)，它允许您（实际上是您的应用程序）：

> 使您的应用能够向用户的信息流和用户朋友的信息流发布内容、评论和点赞。

因此，要发布到公司墙上，您需要：

1.  向用户请求 publish_stream 权限
2.  [使用您的消息向https://graph.facebook.com/](https://graph.facebook.com/) <>/feed url发出发布请求

这真的很容易测试。转到[https://developers.facebook.com/tools/explorer](https://developers.facebook.com/tools/explorer)，单击“获取访问令牌”，在“扩展”选项卡中选择“publish_stream”权限，将操作设置为 POST，在 URL 字段中输入“LGUSA/feed”，单击“添加字段”，输入“消息：测试”，然后单击 POST。你会得到你的帖子的ID。见附件截图![截屏](../Images/af7babbfcd7e230d32e9370a179ecca8.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:09:10.637

抱歉，这会有点模糊，但这里是：

*   首先，用户必须通过 facebook 的身份验证。[这里](https://github.com/offbysome/Facebook-WP7-Login-Button)有一个很好的例子。这将为您提供身份验证令牌，以允许您与 API 进行交互。
*   用户将需要 facebook 权限才能写到墙上。Facebook 权限在[此处](http://developers.facebook.com/docs/authentication/permissions/)描述。我不知道您的问题的具体情况，但如果有更多详细信息，我可能会提供更多帮助。
*   那么您应该能够使用 facebook [graph api](http://developers.facebook.com/docs/reference/api)在适当的墙上发布（您可能需要使用开发人员帐户注册到 facebook 才能访问此页面）。

# database - 如何选择测试数据库 cakePHP 测试

> ID：10112167
> 
> 赞同：4
> 
> 时间：2012-04-11T18:56:32.583
> 
> 标签：database, cakephp, testing, cakephp-2.0

我正在使用 cake bake 命令来创建我的夹具和测试模型。我已经用我的一个模型成功地完成了它，但是我在另一个模型上遇到了麻烦。

我不知道为什么，它尝试使用默认数据库，而不是使用我已经定义的测试数据库，这是我测试的第一个模型使用的数据库。

两种测试模型，一个运行良好，第二个不运行，都是用蛋糕烘焙创建的，它们看起来完全一样。

他们两个在他们的夹具类中都有这个：

```
public $import = array('records' => true, 'connection' => 'test'); 
```

测试定义了到我的测试数据库的连接。可能是什么问题？

我做了一些奇怪的实验。在我的测试模型中，如果我使用单数而不是复数，它适用于默认的 DB，**但**如果我将其更改为复数，它适用于测试数据库。（但它不能从模型中调用任何方法，只是定义了诸如 find() 之类的方法）。

例如：

```
public function setUp() {
    parent::setUp();

    //uses the default DB (i dont know why)
    $this->Post = ClassRegistry::init('Post');          
    print_r($this->User->find('all'));

    $this->Post->updatePostsStatus(1); //works well

    //uses the default Test Database (i dont know why either)
    $this->Post = ClassRegistry::init('Posts');         
    print_r($this->User->find('all'));   

    $this->Post->updatePostsStatus(1); //doesn't work. No function found.
    /*SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'updatePostsStatus' at line 1*/

} 
```

谢谢。

我已经更新了它。

# 最后更新和解决方案

问题是 Post Model 构造函数的初始化错误。使用复数是不相关的。就像使用任何不存在的模型一样。它将始终获取测试数据库。构造函数初始化良好的答案在这里： [How to override model's constructor correct in CakePHP](https://stackoverflow.com/questions/10153841/how-to-overriding-a-constructor-correctly-at-cakephp-2-0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T12:44:10.363

这种 MySQL 错误在 CakePHP 中可能会产生***很大的误导。***

基本上，实际问题出在这一行。`$this->Post->updatePostsStatus(1);`具体来说，posts 模型的 `Post`模型或`updatePostsStatus()`方法不存在。

**您基本上在这一行有错字，请检查方法名称。**应该是`updatePostStatus`吗？（帖子上没有复数？）

* * *

出于某种原因，如果您尝试在 CakePHP 中调用模型上的未定义方法，而不是报告未找到该方法，CakePHP 的“自动性”就会发挥作用，奇怪的是它会尝试将未找到的方法名称直接推送到 MySQL。

基本上，因为 CakePHP 找不到该`$this->Post->updatePostsStatus(1);`方法，它实际上是在尝试执行`updatePostsStatus`ie的 MySQL 查询`mysql_query("updatePostsStatus');`，这就是我们看到这个奇怪的数据库错误的原因。您可能只是拼错了方法名称。

* * *

如果方法名称仍然不是问题，则与`Posts`模型未正确实例化有关。尽管只要你把所有的名字都记对了，这似乎是值得怀疑的。这绝对不是数据库问题，只是 Cakes 自动处理未知类方法的蹩脚方式。

# java - 如何在某些按钮上添加图像图标？

> ID：10112170
> 
> 赞同：3
> 
> 时间：2012-04-11T18:56:40.200
> 
> 标签：java, swing, jbutton, imageicon

我正在制作一个棋盘游戏，我需要将玩家 1 和玩家 2 放在按钮网格上。我正在使用图像图标来表示我想将其放在按钮上的部分。问题是我有一个按钮循环，我需要将piece1 放在按钮1、3、5、7、9 上，将piece2 放在按钮2、4、6、8、10 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:07:06.977

```
 for(int i=0;i<30;i++){
        buttons[i] = new JButton("label"+ i);
        buttons[i].setBackground(Color.white);
        if (i < 10) {
           if (i%2 == 0) {
             buttons[i].setIcon(piece2);
           } else {
             buttons[i].setIcon(piece1);
           }
        }
        panel.add(buttons[i]);
    } 
```

# asp.net-mvc - 使用代码而不是视图为 MVC 创建对象模板（例如 EditorFor 等）

> ID：10112173
> 
> 赞同：0
> 
> 时间：2012-04-11T18:56:43.693
> 
> 标签：asp.net-mvc

是否可以仅使用代码而不是 EditorTemplates 中的视图模板为自定义对象创建 EditorFor 模板。

我的理由是我可以用这些模板创建一个类库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T06:05:52.050

> 是否可以仅使用代码而不是 EditorTemplates 中的视图模板为自定义对象创建 EditorFor 模板。

除非您编写自定义 EditorFor 助手，否则不会。标准助手查找模板。

> 我的原因是我可以用这些模板创建一个类库

在这种情况下，您可以将模板作为资源[嵌入到程序集中。](http://www.chrisvandesteeg.nl/2010/11/22/embedding-pre-compiled-razor-views-in-your-dll/)

# r - 如何计算 data.frame 列中的不同条目

> ID：10112177
> 
> 赞同：1
> 
> 时间：2012-04-11T18:57:02.677
> 
> 标签：r, dataframe

我精通 SQL，自然而然地使用 sqldf 包。但是，了解原生 R 方式来实现各种 SQL 命令是很有用的。

在数据框列上，如何实现与上一个命令类似的计数？

```
library(ggplot2)
head(tips,3)
sqldf("select count(distinct day) from tips") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:23:54.717

行。我现在好多了，可以回答我自己的问题。

```
d <- table(tips$day) 
```

然后计算该列表dim（d）有多长

# node.js - socket.io 和 websockets 的区别

> ID：10112178
> 
> 赞同：610
> 
> 时间：2012-04-11T18:57:04.883
> 
> 标签：node.js, google-chrome, firebug, websocket, socket.io

node.js中的socket.io和websockets有什么区别？
它们都是服务器推送技术吗？我感觉到的唯一不同是，

1.  socket.io 允许我通过指定事件名称来发送/发送消息。

2.  在 socket.io 的情况下，来自服务器的消息将到达所有客户端，但对于 websockets 中的相同，我被迫保留所有连接的数组并循环通过它以向所有客户端发送消息。

另外，我想知道为什么网络检查器（如 Chrome/firebug/fiddler）无法从服务器捕获这些消息（来自 socket.io/websocket）？

请澄清这一点。

* * *

## 回答 #1

> 赞同：721
> 
> 时间：2016-07-25T01:28:02.877

# 误解

关于 WebSocket 和 Socket.IO 的常见误解很少：

1.  第一个误解是使用 Socket.IO 比使用 WebSocket 容易得多，但事实并非如此。请参阅下面的示例。

2.  第二个误解是浏览器没有广泛支持 WebSocket。有关更多信息，请参见下文。

3.  第三个误解是 Socket.IO 将连接降级为旧浏览器的后备。它实际上假设浏览器是旧的，并开始与服务器建立 AJAX 连接，稍后在交换一些流量后在支持 WebSocket 的浏览器上升级。详情见下文。

# 我的实验

我写了一个 npm 模块来演示 WebSocket 和 Socket.IO 之间的区别：

*   [https://www.npmjs.com/package/websocket-vs-socket.io](https://www.npmjs.com/package/websocket-vs-socket.io)
*   [https://github.com/rsp/node-websocket-vs-socket.io](https://github.com/rsp/node-websocket-vs-socket.io)

这是一个服务器端和客户端代码的简单示例——客户端使用 WebSocket 或 Socket.IO 连接到服务器，服务器以 1s 的间隔发送三个消息，这些消息由客户端添加到 DOM。

# 服务器端

比较使用 WebSocket 和 Socket.IO 在 Express.js 应用程序中执行相同操作的服务器端示例：

## WebSocket 服务器

使用 Express.js 的 WebSocket 服务器示例：

```
var path = require('path');
var app = require('express')();
var ws = require('express-ws')(app);
app.get('/', (req, res) => {
  console.error('express connection');
  res.sendFile(path.join(__dirname, 'ws.html'));
});
app.ws('/', (s, req) => {
  console.error('websocket connection');
  for (var t = 0; t < 3; t++)
    setTimeout(() => s.send('message from server', ()=>{}), 1000*t);
});
app.listen(3001, () => console.error('listening on http://localhost:3001/'));
console.error('websocket example'); 
```

来源：[https ://github.com/rsp/node-websocket-vs-socket.io/blob/master/ws.js](https://github.com/rsp/node-websocket-vs-socket.io/blob/master/ws.js)

## Socket.IO 服务器

使用 Express.js 的 Socket.IO 服务器示例：

```
var path = require('path');
var app = require('express')();
var http = require('http').Server(app);
var io = require('socket.io')(http);
app.get('/', (req, res) => {
  console.error('express connection');
  res.sendFile(path.join(__dirname, 'si.html'));
});
io.on('connection', s => {
  console.error('socket.io connection');
  for (var t = 0; t < 3; t++)
    setTimeout(() => s.emit('message', 'message from server'), 1000*t);
});
http.listen(3002, () => console.error('listening on http://localhost:3002/'));
console.error('socket.io example'); 
```

来源：[https ://github.com/rsp/node-websocket-vs-socket.io/blob/master/si.js](https://github.com/rsp/node-websocket-vs-socket.io/blob/master/si.js)

# 客户端

比较使用 WebSocket 和 Socket.IO 在浏览器中执行相同操作的客户端示例：

## WebSocket 客户端

使用 vanilla JavaScript 的 WebSocket 客户端示例：

```
var l = document.getElementById('l');
var log = function (m) {
    var i = document.createElement('li');
    i.innerText = new Date().toISOString()+' '+m;
    l.appendChild(i);
}
log('opening websocket connection');
var s = new WebSocket('ws://'+window.location.host+'/');
s.addEventListener('error', function (m) { log("error"); });
s.addEventListener('open', function (m) { log("websocket connection open"); });
s.addEventListener('message', function (m) { log(m.data); }); 
```

来源：[https ://github.com/rsp/node-websocket-vs-socket.io/blob/master/ws.html](https://github.com/rsp/node-websocket-vs-socket.io/blob/master/ws.html)

## Socket.IO 客户端

使用 vanilla JavaScript 的 Socket.IO 客户端示例：

```
var l = document.getElementById('l');
var log = function (m) {
    var i = document.createElement('li');
    i.innerText = new Date().toISOString()+' '+m;
    l.appendChild(i);
}
log('opening socket.io connection');
var s = io();
s.on('connect_error', function (m) { log("error"); });
s.on('connect', function (m) { log("socket.io connection open"); });
s.on('message', function (m) { log(m); }); 
```

来源：[https ://github.com/rsp/node-websocket-vs-socket.io/blob/master/si.html](https://github.com/rsp/node-websocket-vs-socket.io/blob/master/si.html)

# 网络流量

要查看网络流量的差异，您可以[运行我的测试](https://github.com/rsp/node-websocket-vs-socket.io#readme)。这是我得到的结果：

## WebSocket 结果

### 2 个请求，1.50 KB，0.05 秒

从这两个请求中：

1.  HTML 页面本身
2.  连接升级到 WebSocket

（连接升级请求在开发人员工具上可见，并带有 101 Switching Protocols 响应。）

## Socket.IO 结果

### 6 个请求，181.56 KB，0.25 秒

从这 6 个请求中：

1.  HTML 页面本身
2.  Socket.IO 的 JavaScript（180 KB）
3.  第一个长轮询 AJAX 请求
4.  第二个长轮询 AJAX 请求
5.  第三次长轮询 AJAX 请求
6.  连接升级到 WebSocket

## 截图

我在 localhost 上得到的 WebSocket 结果：

[![WebSocket 结果 - websocket-vs-socket.io 模块](../Images/c0cb3d9f3baa3316761722945bfc58f3.png)](https://i.stack.imgur.com/e2yY5.png)

我在 localhost 上得到的 Socket.IO 结果：

[![Socket.IO 结果 - websocket-vs-socket.io 模块](../Images/eb0ae28959a07a835952d4515d098ab0.png)](https://i.stack.imgur.com/RHymm.png)

## 测试自己

快速开始：

```
# Install:
npm i -g websocket-vs-socket.io
# Run the server:
websocket-vs-socket.io 
```

在浏览器中打开[http://localhost:3001/](http://localhost:3001/)，使用 Shift+Ctrl+I 打开开发者工具，打开 Network 选项卡并使用 Ctrl+R 重新加载页面以查看 WebSocket 版本的网络流量。

在浏览器中打开[http://localhost:3002/](http://localhost:3002/)，使用 Shift+Ctrl+I 打开开发者工具，打开 Network 选项卡并使用 Ctrl+R 重新加载页面以查看 Socket.IO 版本的网络流量。

要卸载：

```
# Uninstall:
npm rm -g websocket-vs-socket.io 
```

# 浏览器兼容性

截至 2016 年 6 月，WebSocket 可在除 Opera Mini 之外的所有设备上运行，包括高于 9 的 IE。

这是截至 2016 年 6 月在[Can I Use上 WebSocket 的浏览器兼容性：](http://caniuse.com/#feat=websockets)

[![在此处输入图像描述](../Images/35b37cbfc78dc2ed2a4ccbc65bd65ad7.png)](https://i.stack.imgur.com/igTKM.png)

有关最新信息，请参阅[http://caniuse.com/websockets 。](http://caniuse.com/websockets)

* * *

## 回答 #2

> 赞同：384
> 
> 时间：2012-04-11T19:24:41.000

它的优点是它简化了 WebSockets 的使用，正如您在 #2 中描述的那样，并且可能更重要的是，它提供了在浏览器或服务器上不支持 WebSockets 的情况下对其他协议的故障转移。我会避免直接使用 WebSockets，除非您非常熟悉它们不工作的环境并且您能够解决这些限制。

这是一本关于 WebSockets 和 Socket.IO 的好书。

[http://davidwalsh.name/websocket](http://davidwalsh.name/websocket)

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2020-07-11T10:38:53.173

**tl;博士;**

比较它们就像比较**餐厅食物**（有时可能很贵，也许不是 100% 你想要）和**自制食物**，你必须自己收集和种植每种成分。

也许如果你只是想吃一个苹果，后者更好。但是如果你想要一些复杂的东西并且你一个人，那真的不值得自己做饭和制作所有的食材。

* * *

我已经与这两个工作过。这是我的经验。

**套接字IO**

*   有自动连接

*   有命名空间

*   有房间

*   有订阅服务

*   具有预先设计的通信协议

    *（谈论订阅、取消订阅或向特定房间发送消息的协议，您必须自己在 websockets 中设计它们）*

*   具有良好的日志记录支持

*   已与redis等服务集成

*   在不支持 WS 的情况下具有后备功能（不过，这种情况越来越少见）

*   这是一个图书馆。这意味着，它实际上在各个方面都在帮助您的事业。Websockets 是一个协议，而不是一个库，SocketIO 无论如何都使用它。

*   整个架构由不是您的人支持和设计，因此您不必花时间设计和实现上述任何内容，但您可以直接编写业务规则。

*   有一个社区，因为它是一个库*（你不能有一个用于 HTTP 或 Websockets 的社区：P 它们只是标准/协议）*

**网络套接字**

*   你拥有绝对的控制权，这取决于你是谁，这可能非常好或非常糟糕
*   它很轻（记住，它是一个协议，而不是一个库）
*   您设计自己的架构和协议
*   没有自动连接，如果需要，您可以自己实现
*   没有订阅服务，你自己设计
*   没有日志记录，你实现它
*   没有后备支持
*   没有房间或命名空间。如果你想要这样的概念，你自己实现它们
*   不支持任何东西，你将是实现一切的人
*   您首先必须专注于技术部分并设计进出您的 Websocket 的所有内容
*   你必须先调试你的设计，这将花费你很长时间

**显然，你可以看到我偏向于 SocketIO。我很想这么说，但我真的不是。**

我真的在努力**不使用 SocketIO**。我不想用它。我喜欢设计自己的东西并自己解决自己的问题。

但是如果你想拥有一个业务而不仅仅是一个**1000 行的项目**，并且你将**选择 Websockets**，你将不得不自己**实现每一件事**。你必须调试一切。您必须制作自己的订阅服务。您自己的协议。你自己的一切。你必须确保一切都非常复杂。而且你会在这个过程中犯很多错误。您将花费大量时间设计和调试所有内容。我做到了，现在仍然这样做。**我正在使用 websockets**，我在这里的原因是因为对于一个试图为他的初创公司解决业务规则而不是处理 Websocket 设计术语的人来说，它们是难以忍受的。

如果您是单人军队或试图实现复杂功能的小团队，那么为大型应用程序选择 Websocket 并不是一个简单的选择。我在 Websockets 中编写的代码比过去使用 SocketIO 编写的代码还要多，比使用 SocketIO 编写的代码简单十倍。

我要说的是……**如果您想要成品和设计，请选择 SocketIO。**（除非您想要功能非常简单的东西）

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2015-12-19T19:33:31.967

我将提供一个反对使用 socket.io 的论点。

我认为仅仅因为它具有后备功能而使用 socket.io 并不是一个好主意。让 IE8 RIP。

过去有很多新版本的 NodeJS 破坏了 socket.io 的情况。您可以查看这些列表以获取示例... [https://github.com/socketio/socket.io/issues?q=install+error](https://github.com/socketio/socket.io/issues?q=install+error)

如果你要开发一个 Android 应用程序或需要与现有应用程序一起工作的东西，你可能马上就可以使用 WS，socket.io 可能会给你带来一些麻烦......

此外，Node.JS 的 WS 模块使用起来非常简单。

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2016-12-21T06:32:46.240

使用 Socket.IO 基本上就像使用 jQuery - 你想支持旧浏览器，你需要编写更少的代码，并且库将提供回退。Socket.io 使用 websockets 技术（如果可用），如果不可用，则检查可用的最佳通信类型并使用它。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2020-03-10T21:37:42.103

[https://socket.io/docs/#What-Socket-IO-is-not](https://socket.io/docs/#What-Socket-IO-is-not)（我*强调*）

> **Socket.IO 不是什么**
> 
> Socket.IO**不是**WebSocket 实现。尽管 Socket.IO 确实尽可能使用 WebSocket 作为传输，但它会为每个数据包添加一些元数据：数据包类型、名称空间和需要消息确认时的数据包 ID。这就是为什么*WebSocket 客户端将**无法**成功连接到 Socket.IO 服务器*，而*Socket.IO 客户端也将**无法**连接到 WebSocket 服务器*。请在[此处](https://github.com/socketio/socket.io-protocol)查看协议规范。
> 
> ```
> // WARNING: the client will NOT be able to connect!
> const client = io('ws://echo.websocket.org'); 
> ```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-03-20T15:53:41.397

即使现代浏览器现在支持 WebSockets，我认为没有必要抛弃 SocketIO，它仍然在当今的任何项目中占有一席之地。这很容易理解，而且就个人而言，我通过 SocketIO 了解了 WebSockets 的工作原理。

正如本主题中所说，有大量用于 Angular、React 等的集成库以及用于 TypeScript 和其他编程语言的定义类型。

我要补充的关于 Socket.io 和 WebSockets 之间差异的另一点是，使用 Socket.io 进行集群并不是什么大问题。Socket.io 提供了[适配器](https://socket.io/docs/using-multiple-nodes/#passing-events-between-nodes)，可用于将其与 Redis 链接以增强可扩展性。例如，您有[ioredis](https://github.com/luin/ioredis)和[socket.io-redis](https://github.com/socketio/socket.io-redis)。

是的，我知道，[SocketCluster](https://github.com/SocketCluster/socketcluster)存在，但这是题外话。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-08-17T07:39:56.183

Socket.IO 使用 WebSocket，当 WebSocket 不可用时，使用回退算法进行实时连接。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2021-09-28T09:22:56.763

我想在 2021 年再提供一个答案。socket.io 自 2020 年 9 月以来再次得到积极维护。在 2019 年至 2020 年 8 月（近 2 年）期间，基本上没有任何活动，我原以为该项目可能已经死了。

Socket.io 还发表了一篇名为[2020 年为什么要使用 Socket.IO 的文章？](https://socket.io/blog/socket-io-3-release/#why-socketio-in-2020)，除了回退到 HTTP 长轮询，我认为这两个功能是 socket.io 提供的，而 websocket 缺乏

*   自动重新连接
*   一种向给定客户端（房间/命名空间）广播数据的方法

我发现 socket.io 的另一个方便的功能是用于 ws 服务器开发，尤其是我使用 docker 进行服务器部署。因为我总是启动超过 1 个服务器实例，所以跨 ws 服务器通信是必须的，socket.io 为它提供了[https://socket.io/docs/v4/redis-adapter/](https://socket.io/docs/v4/redis-adapter/)。

使用 redis-adapter，将服务器进程扩展到多个节点很容易，而 ws 服务器的负载平衡很难。在这里查看[https://socket.io/docs/v4/using-multiple-nodes/](https://socket.io/docs/v4/using-multiple-nodes/)了解更多信息。

# ruby - Github Services / Ruby Gem "eventmachine" Mac 安装问题

> ID：10112180
> 
> 赞同：4
> 
> 时间：2012-04-11T18:57:13.863
> 
> 标签：ruby, github, gem, eventmachine, github-services

我认为这并不重要，但我的 Github 服务回购分支是[https://github.com/franklovecchio/github-services](https://github.com/franklovecchio/github-services)

当我尝试运行“sudo ruby​​ github-services.rb”来测试我的钩子时，它会尝试安装 eventmachine，这会给出以下错误（我可以安装其他 gem！）。我也做`gem update`了，但仍然得到同样的错误。`bundler`gem 也已安装。有人看到这个吗？

```
sudo ruby github-services.rb 
Password:
WARN The gem environment is out-of-date or has yet to be bootstrapped.
     Runnning script/bootstrap to remedy this situation...
Using rake (0.8.7) 
Using activesupport (3.0.10) 
Using builder (2.1.2) 
Using i18n (0.5.0) 
Using activemodel (3.0.10) 
Using activeresource (3.0.10) 
Using addressable (2.2.6) 
Installing eventmachine (0.12.10) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

/usr/local/Cellar/ruby/1.9.2-p180/bin/ruby extconf.rb 
checking for rb_trap_immediate in ruby.h,rubysig.h... no
checking for rb_thread_blocking_region()... yes
checking for inotify_init() in sys/inotify.h... no
checking for __NR_inotify_init in sys/syscall.h... no
checking for writev() in sys/uio.h... yes
checking for rb_thread_check_ints()... yes
checking for rb_time_new()... yes
checking for sys/event.h... yes
checking for sys/queue.h... yes
creating Makefile

make
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o binder.o -c binder.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o cmain.o -c cmain.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o cplusplus.o -c cplusplus.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o ed.o -c ed.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o em.o -c em.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o emwin.o -c emwin.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o epoll.o -c epoll.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o files.o -c files.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o kb.o -c kb.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o page.o -c page.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o pipe.o -c pipe.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o rubymain.o -c rubymain.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o sigs.o -c sigs.cpp
/usr/bin/g++-4.2 -I. -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/x86_64-darwin10.7.0 -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1/ruby/backward -I/usr/local/Cellar/ruby/1.9.2-p180/include/ruby-1.9.1 -I. -DBUILD_FOR_RUBY -DHAVE_RB_THREAD_BLOCKING_REGION -DHAVE_TBR -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_THREAD_CHECK_INTS -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_SYS_EVENT_H -DHAVE_SYS_QUEUE_H -DHAVE_KQUEUE -DWITH_SSL -DHAVE_MAKE_PAIR -I/usr/local/Cellar/readline/6.2.1/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common  -w -pipe -O3 -fno-common -I/opt/local/include     -w -pipe -O3 -o ssl.o -c ssl.cpp
/usr/bin/g++-4.2 -dynamic -bundle -o rubyeventmachine.bundle binder.o cmain.o cplusplus.o ed.o em.o emwin.o epoll.o files.o kb.o page.o pipe.o rubymain.o sigs.o ssl.o -L. -L/usr/local/Cellar/ruby/1.9.2-p180/lib -L. -L/usr/local/Cellar/readline/6.2.1/lib -L/opt/local/lib -Wl,-undefined,dynamic_lookup -Wl,-multiply_defined,suppress -Wl,-flat_namespace  -lruby.1.9.1  -lssl -lcrypto -lz   -lpthread -ldl -lobjc 
ld: warning: ignoring file /opt/local/lib/libz.dylib, file was built for unsupported file format which is not the architecture being linked (x86_64)
ld: in /opt/local/lib/libz.1.dylib, file was built for unsupported file format which is not the architecture being linked (x86_64) for architecture x86_64
collect2: ld returned 1 exit status
make: *** [rubyeventmachine.bundle] Error 1

Gem files will remain installed in /Users/franklovecchio/Desktop/development/github_services/vendor/gems/ruby/1.9.1/gems/eventmachine-0.12.10 for inspection.
Results logged to /Users/franklovecchio/Desktop/development/github_services/vendor/gems/ruby/1.9.1/gems/eventmachine-0.12.10/ext/gem_make.out
An error occured while installing eventmachine (0.12.10), and Bundler cannot continue.
Make sure that `gem install eventmachine -v '0.12.10'` succeeds before bundling.
bundle executable not found.  Ensure bundler is installed (`gem install bundler`) and that the gem bin path is in your PATH
WARN The gem environment is STILL out-of-date.
     Please contact your network administrator.
/Users/franklovecchio/Desktop/development/github_services/config/load.rb:26:in `<top (required)>': gem environment not configued (RuntimeError)
    from <internal:lib/rubygems/custom_require>:29:in `require'
    from <internal:lib/rubygems/custom_require>:29:in `require'
    from github-services.rb:1:in `<main>' 
```

看着`gem environment`：

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.3.7
  - RUBY VERSION: 1.9.2 (2011-02-18 patchlevel 180) [x86_64-darwin10.7.0]
  - INSTALLATION DIRECTORY: /usr/local/Cellar/ruby/1.9.2-p180/lib/ruby/gems/1.9.1
  - RUBY EXECUTABLE: /usr/local/Cellar/ruby/1.9.2-p180/bin/ruby
  - EXECUTABLE DIRECTORY: /usr/local/Cellar/ruby/1.9.2-p180/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-darwin-10
  - GEM PATHS:
     - /usr/local/Cellar/ruby/1.9.2-p180/lib/ruby/gems/1.9.1
     - /Users/franklovecchio/.gem/ruby/1.9.1
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
     - :sources => ["http://rubygems.org/", "http://gems.github.com"]
  - REMOTE SOURCES:
     - http://rubygems.org/
     - http://gems.github.com 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T06:45:58.033

```
ld: warning: ignoring file /opt/local/lib/libz.dylib, file was built for unsupported file format which is not the architecture being linked (x86_64) 
```

这是主要错误。检查 Zlib 端口，它是为 x86_64 安装的吗？你可以使用

```
port -v installed zlib 
```

如果没有安装 zlib，请安装它或者如果它已经安装。只是更新它。

此外，如果这没有帮助。看看[Fixing ld: warning: in /usr/local/lib/libz.dylib, file is not required architecture](http://www.refresherate.com/2010/01/08/fixing-ld-warning-in-usrlocalliblibz-dylib-file-is-not-of-required-architecture/)

# c# - 将 .dll 编译成可执行文件

> ID：10112184
> 
> 赞同：1
> 
> 时间：2012-04-11T18:57:46.543
> 
> 标签：c#, winforms

是否有可能引用多个库的应用程序仅编译为 .exe 文件而不是 .exe +所有 .dll 文件？

我知道我可以重命名所有命名空间以匹配应用程序的命名空间，但我不想这样做。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T18:59:45.800

是的，使用 Microsoft 称为[ILMerge](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=17630)的工具。构建项目后，它将允许您将所有 dll 合并到一个 exe 中。

这是一个[CodeProject 教程](http://www.codeproject.com/Articles/9364/Merging-NET-assemblies-using-ILMerge)，向您展示如何使用它

```
ilmerge /target:winexe /out:SelfContainedProgram.exe 
        Program.exe ClassLibrary1.dll ClassLibrary2.dll 
```

更新：正如[Blindy 提到](https://stackoverflow.com/a/10112218/80274)的，如果您的代码使用[`Reflection`命名空间](http://msdn.microsoft.com/en-us/library/136wx94f.aspx)中的任何内容，则在合并文件后可能会遇到问题。如果您在合并后运行程序时开始出现错误，这是一个开始查看的地方。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T19:00:14.670

是的，这正是[ilmerge.exe](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=17630)的目的。

不过要小心后期绑定的库（即`Assembly.LoadFrom`）。

# linux - Fortran 中的共享库，最小示例不起作用

> ID：10112185
> 
> 赞同：9
> 
> 时间：2012-04-11T18:57:51.777
> 
> 标签：linux, shared-libraries, gfortran

我试图了解如何在 Linux 下在 Fortran 中动态创建和链接共享库。

我有两个文件：第一个文件`liblol.f90`，看起来像这样：

```
subroutine func()
    print*, 'lol!'
end subroutine func 
```

我用它编译`gfortran -shared -fPIC -o liblol.so liblol.f90`

第二个文件 ，`main.f90`如下所示：

```
program main
    call func()
end program main 
```

当我现在尝试使用 command 编译它时`gfortran -L. -llol main.f90 -o main`，我收到以下错误：

```
/tmp/ccIUIhcE.o: In function `MAIN__':
main.f90:(.text+0xa): undefined reference to `func_'
collect2: ld returned 1 exit status 
```

我不明白为什么它说“未定义的引用”，因为输出`nm -D liblol.so`给了我这个：

```
 w _Jv_RegisterClasses
0000000000201028 A __bss_start
                 w __cxa_finalize
                 w __gmon_start__
0000000000201028 A _edata
0000000000201038 A _end
0000000000000778 T _fini
                 U _gfortran_st_write
                 U _gfortran_st_write_done
                 U _gfortran_transfer_character_write
0000000000000598 T _init
00000000000006cc T func_ 
```

是否需要任何其他参数？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-12T13:46:06.180

唯一需要改变的是参数的顺序，如

```
gfortran -L. main.f90 -llol -o main 
```

是的，只有 main.f90 和 -llol 是相反的。我希望这可以挽救我刚刚失去的生命中的那一年。在相关的说明中，如果您尝试编译使用 LAPACK 或 BLAS 的程序（这对我不起作用，这就是为什么我首先尝试自己创建一个共享库），同样适用。**先写源文件名**：

```
gfortran mylapack.f90 -llapack -lblas -o mylapack 
```

原因可以在手册页中找到，请参阅[http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)顶部的选项 -l：

> 在命令中编写此选项的位置有所不同；链接器按照指定的顺序搜索和处理库和目标文件。因此，在文件 foo.o 之后但在 bar.o 之前`foo.o -lz bar.o`搜索库。`z`如果 bar.o 引用了 `z' 中的函数，这些函数可能不会被加载。

# php - 添加mysql表功能

> ID：10112187
> 
> 赞同：0
> 
> 时间：2012-04-11T18:58:00.070
> 
> 标签：php, mysql

我是 SQL 的初学者。我在我的数据库中创建了 3 个表：“DOCTORID”、“PATIENTS”、“VISITS”。为简单起见，我在这些表中只有一对多的关系：一位医生有很多患者，一位患者可以有很多次就诊……在我的表“访问”中。

如何获得每位患者的链接并添加或创建新就诊？每次访问都会有一些字段，例如：主诉、生命体征。我需要我的访问自动获得今天的日期和时间。我想添加新的访问并验证或阅读过去的访问。

在我的“患者”表中，患者 ID 是 $id。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:01:44.893

作为概述，访问将包含：

Visit_ID、Patient_ID、Doctor_ID、 Chief_complaint、vital_signs、时间戳

# facebook - 在 Rails 中使用 Facebook api 时无法将路径名转换为字符串

> ID：10112188
> 
> 赞同：4
> 
> 时间：2012-04-11T18:58:02.537
> 
> 标签：facebook, ruby-on-rails-3.1

我们正在尝试使用 ruby​​ on rails 构建一个 facebook 应用程序。

我们设置了一个画布应用程序，并且能够通过画布查看我们的应用程序，但是当我们尝试集成 ruby​​ facebook api 时，每当我们尝试请求用户数据时，都会出现“无法将路径名转换为字符串”错误。

到目前为止，我们已经尝试了 2 种不同的 api（koala 和 rest-graph）并且得到了相同的结果。

我什至从[koala api 示例项目中下载了一个工作项目](http://www.banane.com/2012/01/22/sample-koala-facebook-ruby-on-rails-app/)

并得到同样的错误。我不确定这是否是 rails 错误，或者因为我们正在尝试使用 rails s localhost:3000 运行它

我有一个先前的 ssl 错误，必须在 config/initializers 下添加此代码来修复它

```
require 'open-uri'
require 'net/https'

module Net
  class HTTP
    alias_method :original_use_ssl=, :use_ssl=

    def use_ssl=(flag)
      self.ca_file = Rails.root.join('lib/ca-bundle.crt')
      self.verify_mode = OpenSSL::SSL::VERIFY_PEER
      self.original_use_ssl = flag
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T07:48:26.050

问题是

```
self.ca_file 
```

需要一个字符串，而您正在向它发送一个路径名。代替：

```
Rails.root.join('lib/ca-bundle.crt') 
```

和：

```
Rails.root.join('lib/ca-bundle.crt').to_s 
```

它应该可以工作

# c# - 通过 T4 生成 .net 项目

> ID：10112193
> 
> 赞同：0
> 
> 时间：2012-04-11T18:58:15.190
> 
> 标签：c#, .net, t4

如何通过 T4 生成 .net 项目？我的模型有一个 .edmx 和一个 T4 模板。我需要生成不同的项目架构师（$name_solution.models、$name_solution.data.EF、$name_solution.interface 等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:14:02.043

看看[这个答案](https://stackoverflow.com/questions/6980215/t4-generate-file-with-no-dependentupon-attribute-in-csproj-file/7218105#7218105)中的 SaveOutput 实现。它展示了如何使用 T4 将输出重定向到多个文件。

使用它可以手工制作项目文件并相应地保存它。

# autocomplete - 为什么闪烁自动完成会离开单词的开头

> ID：10112197
> 
> 赞同：1
> 
> 时间：2012-04-11T18:58:26.640
> 
> 标签：autocomplete, notepad++, scintilla

我正在编写一个 Notepad++ 插件来为我和其他人使用的脚本语言创建一个 IDE。

我的问题是我无法弄清楚为什么 Scintilla 的 AutoComplete 功能在进行 AutoComplete 选择后会离开字符串的开头。

我试过删除字符串的开头，但这似乎也不起作用。我想当我收到 AutoComplete 选择通知时，我可以用 AutoCompletion 选择手动替换目标，但 Scintilla 不应该自动执行此操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:55:42.340

如果设置`Scintilla.AutoComplete.AutomaticLengthEntered = true`，则 Scintilla 将尝试猜测单词的长度并在自动完成条目被接受时替换它。

如果您使用 显示自定义自动完成列表`Scintilla.AutoComplete.ShowUserList`，则第一个参数 ( `listType`) 是接受匹配时将替换的字符数。同样，`lengthEntered`in`Scintilla.AutoComplete.Show`是要替换的字符数。

# java - Java 中的 RSA 和 BigInteger

> ID：10112199
> 
> 赞同：3
> 
> 时间：2012-04-11T18:58:41.490
> 
> 标签：java, android, rsa, biginteger

我有以下代码：

```
BigInteger d = new BigInteger(1,NFCUtil.hexStringToByteArray(IssPrivKey));
BigInteger n = new BigInteger(1,NFCUtil.hexStringToByteArray(IssPubKeyMod));
BigInteger X = new BigInteger(1,NFCUtil.hexStringToByteArray(unsignedPhoneCert));

BigInteger iccCertBI = X.modPow(d, n);

final String iccCert = iccCertBI.toString(16);

System.out.println("\nSigned Certificate: (int)" + iccCertBI +
            "\nSigned Certificate (hex): "+iccCert + 
            "\nsigned Cert length: "+iccCert.length()); 
```

我正在做的是使用私有指数和公共模数对字符串进行签名。所有长度均为 288 个字符或 144 个字节。踢球者是当我将它用于以下字符串时：

```
//Length 144
    final String unsignedTerCert="6A04846983677983FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF121" +
            "3AFAFAF01018001BDB011D89730D7958DCAF0D34A4668A65073F2766BAC3C3E7D551211A" +
            "1D7896085F1F4FDAA9A256579B0D4D6B1C7CF6C88D318886C55FB3CA91DB721376797058" +
            "F482A51A363B92A89DA81BB6A7FFBB6F8C8E109E5909EFFFFFFFFFFFFFFFFFFFFFFFFFFF" +
            "FFFFFFFFFFFFFBC"; 
```

正如我所期望的那样，它返回了一个长度为 288 个字符或 144 个字节的字符串。

但是将其用于：

```
//Length 144
    final String unsignedPhoneCert="6A0400112233445566778899011401020301018001AE0A3CCBF6B1A997E4A4AEC7EDA6697F6B73C2EC18F8E3403F83237BD9863B4CD0BE0EBC2A8E3FB140251935F1D4EAEF2D7801FFC2CF36328E234676F96883BAB6547F82FE02455B59B6952231B130EE70980B74456168AD2A511A00448BFEA62593DCF9F3D9FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBC"; 
```

给我一个长度为 287 个字符的字符串。

所以我的问题是，BigInteger toString(16) 方法中是否存在导致这种情况的原因？

注意。我仍然可以使用公钥 expo 从 BigInteger 很好地解密它们，这就是让我认为这与 .toString() 方法有关的原因。

任何帮助/提示将不胜感激，谢谢。

编辑：这是我从不正确的输出中得到的输出：

```
Expo:36652731434641292350412815683229009979770975413220344544898857375896901092978000426765621805499026545042319009684553729382562239973283276192079521889464379604341193094271888918244826201023503324034315850394178807890994288745747556760470026279678747937975742329807945656583328292494373708777822442236249197245972251059241540578219194613740104635899
X:25332900759103924912689760614898214526937827890939506310067994686010108648336498000719255096072122266248508522922053911850606613923138698430079380374971383359222723175609119386369637533489684435824557964231714784677160255389973258884831385632708921103814163273457386881057406862373463121304854072959526597286211022281774584184894225094204257730492
X (hex):6a0400112233445566778899011401020301018001ae0a3ccbf6b1a997e4a4aec7eda6697f6b73c2ec18f8e3403f83237bd9863b4cd0be0ebc2a8e3fb140251935f1d4eaef2d7801ffc2cf36328e234676f96883bab6547f82fe02455b59b6952231b130ee70980b74456168ad2a511a00448bfea62593dcf9f3d9ffffffffffffffffffffffffffffffffffffffffbc

    Phone Signed Certificate: (int)2621041784071301050954845366555843081386290833242762939438653553587304361236513516037765146640763105648748143029523335470875071401132351534501879861341081099809142476414060273707263492268408647346182500147665413648376803840594353667155297685676942776395991299461798048817170064783101287983256626056086159016336001344190438106860395808579588320414
    Phone Signed Certificate (hex): af802ec9b412c2e223e28cd0e540255b18351d570e24690b1b441f6e084afb3a03a6a1a52ec4268d9dacf47385222011a977994c9dc521dc4ca82f20f4345ee8697a1cc269931211640efe7b6d29c728283aa823525887f09dbc6df37f3e1a6ec4718ccbb31778d813e4375d89631503dc785c9c9eb4770e918a3cc37c90b6d75135d8c32c299d8096d4bd88199ec9e
     Phone signed Cert length: 287 
```

从正确的一个：

```
Expo:36652731434641292350412815683229009979770975413220344544898857375896901092978000426765621805499026545042319009684553729382562239973283276192079521889464379604341193094271888918244826201023503324034315850394178807890994288745747556760470026279678747937975742329807945656583328292494373708777822442236249197245972251059241540578219194613740104635899
X:25333383310317922886770001828148668452338535025796085964448660925847832365078972818630528414968514941209307982589233259227108935074767908506952878286644207041412726931112453402165128539381501316868062159358826581046954850027043009445846574678562969939333097216245548333577227051225788418683968135213089604118672442657593365304099582656739524214716
X (hex):6a04846983677983ffffffffffffffffffffffffffffffffffffff1213afafaf01018001bdb011d89730d7958dcaf0d34a4668a65073f2766bac3c3e7d551211a1d7896085f1f4fdaa9a256579b0d4d6b1c7cf6c88d318886c55fb3ca91db721376797058f482a51a363b92a89da81bb6a7ffbb6f8c8e109e5909effffffffffffffffffffffffffffffffffffffffbc

Phone Signed Certificate: (int)21432015836175396598983285831512248305709761145636099501338782160749145447638782142594889169355603470185237110648036474961995187557563452989823081731645192439732733979910407327875747461117018365485531108584396064685039171356192052384601156809092826847482291755881176360680132279291900385137689881779233791387498805975645418591098518000313085841654
Phone Signed Certificate (hex): 59b0d96873fa0895d52d3f63475dd224c0a73bc34439e369a7b5eea88fd65b52464317b88642016421e9054d7e19dfc9cac7ffda07faea496268ea133cd83dc45959de61b1aa4b26a46ab47c6b8f4f2c092e914f0d940e9082b800119eba061bf7a654c022bc9c601a2d02a9775fb2cd23e532146443d7236c2ab301478fc9c59bbd984792d95d1db1a8d2ce80add0f6
 Phone signed Cert length: 288 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T19:25:05.863

`BigInteger.toString(int)`不会用前导零填充其输出。如果您想要固定宽度的输出，请尝试`String.format`：

```
String.format("%0288x", iccCertBI) 
```

**添加**

格式字符串分解如下：

*   `%`标记格式说明符的开头，它告诉格式化程序将相应的参数放在输出中的这个位置。
*   `0`告诉格式化程序使用零填充；没有这个，它使用空格进行填充。
*   `288`告诉格式化程序在输出中*至少*生成 288 个字符（不确定是否可以指定最大值）
*   `x`告诉格式化程序将相应的参数转换为十六进制整数（任何数字基元或类型，例如`int`, `long`. 或`BigInteger`，都可以在这里使用）。

`String.format`是用于将常见数据类型格式化为字符串的强大工具，您绝对应该阅读[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/Formatter.html)。

# search - 何时使用 Hadoop，何时使用 ElasticSearch 进行分组/分面？

> ID：10112206
> 
> 赞同：0
> 
> 时间：2012-04-11T18:59:12.833
> 
> 标签：search, mongodb, hadoop, apache-pig, faceted-search

我已经下载了我的收件箱，并且正在使用 Pig 和 Hadoop 处理我的电子邮件。我使用 Pig 和[Wonderdog](https://github.com/infochimps-labs/wonderdog)在 ElasticSearch 中索引这些电子邮件。

现在，我正在为收件箱中的每个电子邮件地址创建一个网页，以显示这些地址发送的消息。

我可以通过两种方式做到这一点：

1）在 Pig 中按电子邮件地址分组，存储到 MongoDB（或 ElasticSearch）。

[2) 查询 ElasticSearch 以使用facets](http://www.elasticsearch.org/guide/reference/api/search/facets/)从电子邮件索引中为我返回此列表。

哪一个是首选答案，它取决于什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:54:36.247

**选项 1 - 在 Pig 中按电子邮件地址分组，存储到 MongoDB（或 ElasticSearch）：**

您正在预先计算结果并将其存储到 MongoDB 或 ElasticSearch。如果数据很大并且不经常更新，这是一件好事。

**选项 2 - 查询 ElasticSearch 以使用构面从电子邮件索引中为我返回此列表。**

如果数据经常更新，甚至对于小数据集，最好使用此选项，因为查询数据（在正确的字段上编制索引）将提供快速结果，您不必依赖预处理。

# javascript - 动态调整多个DIV的大小

> ID：10112207
> 
> 赞同：0
> 
> 时间：2012-04-11T18:59:14.283
> 
> 标签：javascript, html

我正在使用 javascript 在 html 页面上显示 json 响应。响应可能包含多个结果以及每个结果对应的一个链接。我正在动态显示这个。

代码是：

```
var response=eval('(' + request.responseText + ')');

        for(i=0;i<response.items.length;i++)
        {

            var innerDivElement=document.createElement('div');
            divElement.appendChild(innerDivElement);
            innerDivElement.setAttribute("id", response.items[i].link);
            innerDivElement.setAttribute("title","link_attr");
            innerDivElement.setAttribute("class","links");
            innerDivElement.innerHTML=response.items[i].link;
        } 
```

这里所有的 DIV 都具有相同的高度和宽度。我想根据其 innerHTML 的大小调整 DIV 的大小。如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:45:23.033

首先，你真的应该尝试使用像 jQuery 这样的 JavaScript 框架。例如，eval() 函数就不是很安全。但不管怎么说：

如果您在 CSS 中为包含内部元素的 DIV 设置了一个较低的 min-height 和 min-width 值，它将在需要时自动拉伸。

JS方式：

```
divElement.setAttribute("class", "innerElementHolder"); 
```

或者，如果您要从 HTML 页面中检索此 divElement，只需添加：

```
class="innerElementHolder" 
```

到包含您在 JS 中创建的所有元素的 DIV。

innerElementHolder CSS 应该类似于：

```
.innerElementHolder {
    min-height: 10px;
    min-width: 10px;
} 
```

# git - 如何分叉一个叉子及其起源？

> ID：10112208
> 
> 赞同：1
> 
> 时间：2012-04-11T18:59:25.750
> 
> 标签：git, github, kickstrap

我想分叉[Twitter Bootstrap](https://github.com/twitter/bootstrap)和它的一个分支[Kickstrap](https://github.com/ajkochanowicz/Kickstrap)。但是，github 认为它们是同一个 repo，在我分叉一个之后，Github 显示另一个已经分叉到我的帐户。是否可以将两者分叉到同一个帐户？

（用例是我需要将两者都作为子模块添加到项目中，其中我正在编写项目启动模板变体的生成脚本，有些使用 Bootstrap，有些使用 Kickstrap）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:01:08.017

是的，您应该将它们用作子模块，而不是分叉它们，除非您想与它们一起贡献。

您不能分叉具有相同名称的两个存储库，即分叉和原始存储库的情况，如此处[所述](https://stackoverflow.com/questions/6675994/is-it-possible-to-fork-a-fork-in-github)。

如果您想为这两个项目做出贡献，解决方法是分叉最具体和最新的一个，在本例中为[Kickstrap](https://github.com/ajkochanowicz/Kickstrap)。

这样，[Kickstrap](https://github.com/ajkochanowicz/Kickstrap)将指向原始根，即[Bootstrap](https://github.com/twitter/bootstrap)，您可以将您的拉取请求指向原始根或最终分支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T16:35:33.787

Kickstrap 实际上在 Kickstrap/bootstrap/ 中包含完整的未修改的 Bootstrap 存储库。这是设计使然，因此您可以使 Bootstrap 核心保持最新，而不会影响您在 Kickstrap 中的工作。

您可以将这些内容替换为 bootstrap 的 git 克隆，然后将 Kickstrap/bootstrap 添加到您的 .gitignore 列表中，这样 Xhibit 就不会告诉您他是如何知道您喜欢 .git 文件夹的。

# verilog - 从其他几个模块内部访问一个模块的实例？(verilog)

> ID：10112210
> 
> 赞同：4
> 
> 时间：2012-04-11T18:59:32.463
> 
> 标签：verilog

我正在编写一个简单的系统，其中有一个内存模块（带有读写信号的简单 reg）。现在这个内存必须被其他几个模块访问（不是同时）。所以我创建了这个内存的一个实例并向它提供数据。但我不知道我的其他模块将如何访问内存模块的同一实例。有什么帮助吗？

**编辑**

让我通过一些代码来澄清一下。这是我的记忆模块，简单的信号。

```
module rom(
    input [15:0] addr,
    input [15:0] data_in,
    input rd,
    input wr,
    input cs,
    output reg [15:0] data_out
    );

    reg [15:0] mem[255:0];
    integer k;
    initial begin
        for(k = 0;k<256;k=k+2)
            mem[k] = 16'h0011;
        for(k = 1;k<256;k=k+2)
            mem[k] = 16'h0101;
    end

    always @(cs)begin
        if(wr)
            mem[addr] <= data_in;
        if(rd)
            data_out <= mem[addr];
    end

endmodule 
```

这将在我的顶级模块中实例化，就像这样

```
module Top;

    // Inputs
    reg [15:0] addr;
    reg [15:0] data_in;
    reg rd;
    reg wr;
    reg cs;

    // Outputs
    wire [15:0] data_out;

    // Instantiate the Unit Under Test (UUT)
    rom uut (
        .addr(addr), 
        .data_in(data_in), 
        .rd(rd), 
        .wr(wr), 
        .cs(cs), 
        .data_out(data_out)
    );
 ....
 ....
 ....
endmodule 
```

现在这个顶级模块还将包含一些其他想要连接到内存的模块。我真的不明白我将如何连接它们。假设有一个这样的模块

```
module IF_stage(
    input clk,
    input rst,
    output reg [15:0] pc,
    output [15:0] instruction
    );

    //pc control
    always@(posedge clk or posedge rst)
    begin
        if(rst)
            pc <= 16'hFFFF;
        else
            pc <= pc+1;
    end

 .... 
```

我如何从这里访问内存模块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T14:15:13.700

首先，你的内存名称是“rom”，是只读的。我认为这是一个错字，否则不需要 wr 端口，您可以简单地在客户端中实现单独的 rom，并让合成器优化设计。

对于您的问题，基本上您需要一个仲裁器来处理多个客户端之间的争用。所有客户端都可以假设它们独占内存，但内存由所有客户端共享，不能同时访问。

Tim 对 IF_stage 的看法是正确的。每个客户端都必须有一个单独的内存接口

```
output [15:0] addr;
output [15:0] data_out;
input  [15:0] data_in;
output        wr, rd, cs;
input         rdy;          // only when rdy == 1, the memory operation is finished 
```

您将需要一个内存控制器/仲裁器，它对所有客户端都充当内存，但实际上处理客户端之间的争用。假设有三个客户端并且所有客户端每三个周期访问内存少于一次，您可以简单地拥有以下内容：

```
module mem_ctl( 
                addr_c1, dw_c1, dr_c1, wr_c1, rd_c1, cs_c1,
                addr_c2, dw_c2, dr_c2, wr_c2, rd_c2, cs_c2,
                addr_c3, dw_c3, dr_c3, wr_c3, rd_c3, cs_c3,
                addr_m, dw_m, dr_m, wr_m, rd_m, cs_m, 
                rdy_c1, rdy_c2, rdy_c3,
                rst_n, clk
              );
input        clk, rst_n;
input [15:0] addr_c1, addr_c2, addr_c3, dw_c1, dw_c2, dw_c3;  // addr and data_write from clients
output [15:0] dr_c1, dr_c2, dr_c3;                         // data read from clients
input         wr_c1, wr_c2, wr_c3, rd_c1, rd_c2, rd_c3, cs_c1, cs_c2, cs_c3; // control from clients
output [15:0] addr_m, dw_m;                                // addr and data write to memory
input [15:0]  dr_m;
output        wr_m, rd_m, cs_m;                                   // control the memory
output        rdy_c1, rdy_c2, rdy_c3;

reg [15:0]    dr_c1, dr_c2, dr_c3, dw_m, addr_m;
reg           wr_m, rd_m, cs_m;

reg [1:0]     cnt;

always @(posedge clk or negedge rst_n)
  if (~rst_n)
    cnt <= 0;
  else if(cnt == 2'd2)
    cnt <= 0;
  else
    cnt <= cnt + 1;

always @(*)   // Verilog 2001, if not recognizable, fill in yourself
begin
  case(cnt)
  0: begin
     dw_m = dw_c1;
     wr_m = wr_c1;
     cs_m = cs_c1;
     rd_m = rd_c1;
     dr_c1 = dr_m;
  end
  1: begin
     dw_m = dw_c2;
     wr_m = wr_c2;
     cs_m = cs_c2;
     rd_m = rd_c2;
     dr_c2 = dr_m;
  end
  default: begin
     dw_m = dw_c3;
     wr_m = wr_c3;
     cs_m = cs_c3;
     rd_m = rd_c3;
     dr_c3 = dr_m;
  end
  endcase
end

assign rdy_c1 = (cnt == 0) & cs_c1;
assign rdy_c2 = (cnt == 1) & cs_c2;
assign rdy_c3 = (cnt == 2) & cs_c3;

endmodule 
```

但是，这只有在所有客户端的访问率低于每三个周期一次时才可以。如果访问速率不同且高于该值，则需要在 mem_ctl 模块中使用真正的仲裁器。我认为循环仲裁器会很好。

最后的评论，如果所有客户端的累积访问速率大于每个周期一次，则无法在硬件中处理。在这种情况下，您将需要以其他方式进行操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:36:16.370

回答您的评论时，您不会多次实例化内存。您在层次结构的某个级别创建一个内存实例，然后通过端口/线路将所有消费者连接到它。因此，在顶层，您可能有 3 个要访问内存的模块和 1 个内存模块。三个访问器每个都连接到单个实例，它们不实例化自己的内存。

如果有意义的话，内存应该与其他模块平行，而不是在它们内部。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T19:59:55.757

你需要修改 IF_stage 添加一个可以与内存通信的接口，如下所示：

```
module IF_stage(
    input clk,
    input rst,
    input [15:0] read_data_from_memory,         //new
    input        read_data_from_memory_valid,   //new
    output reg [15:0] pc,
    output [15:0] instruction

    output        do_memory_write               //new
    output        do_memory_read                //new
    output [15:0] memory_write_data             //new
    output [15:0] addr                          //new

); 
```

然后当一个 IF_stage 想要读取或写入内存时，它会将 addr/data 放在它的输出端口上以向内存模块发出命令，然后等待 read_data_from_memory(_valid) 在它的输入端口上被断言。这些输出和输入连接到顶层的内存模块。

您还必须在此处处理总线争用，例如，如果 IF_stage 的两个实例尝试同时读取/写入，您将需要某种仲裁模块来确认这两个请求，然后一次转发它们时间到内存，并将有效数据返回到适当的模块。

# .net - 如何设置嵌套控件的样式？

> ID：10112221
> 
> 赞同：1
> 
> 时间：2012-04-11T19:00:28.657
> 
> 标签：.net, wpf, styles

我的项目中有一个 ScrollBar 样式，它被所有 ScrollBar 实例自动使用，包括其中包含 ScrollBar 的控件。是时候在项目中使用 DataGrid 了，但我不希望它采用 ScrollBar 样式，因为它与 datagrid 的其他默认样式冲突，而且我没有时间弄清楚如何制作与滚动条一致的 DataGrid 样式。

整个早上在谷歌上搜索这个问题后，我尝试了我发现的这个解决方案：我使用我的试用版表达式混合将 ScrollBar 的默认样式作为资源字典保存到单独的 xaml 文件中。我将此 xaml 文件添加到我的项目中，并将其与应用程序级别的其余资源字典合并。在使用 DataGrid 的 Window xaml 文件中，我尝试了以下操作：

```
<Window x:Class="Chart.ChartDataGrid.ChartDataGridWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:Chart.ChartDataGrid"
    Title="ChartDataGridWindow" Height="300" Width="300"
    WindowStartupLocation="CenterOwner"
    >
<Grid>
    <DataGrid ItemsSource="{Binding ValuesView}" AutoGenerateColumns="False"
              x:Name="_dataGrid">
        <DataGrid.Resources>
            <Style TargetType="ScrollBar" BasedOn="{StaticResource {x:Static ScrollBarStyleDefault}}" />
        </DataGrid.Resources>
        <DataGrid.Columns>
            <DataGridTextColumn Header="Date/Time" Binding="{Binding TradeDate}" />
            <DataGridTextColumn Header="Price" Binding="{Binding Price}" />
        </DataGrid.Columns>
    </DataGrid>
</Grid>
</Window> 
```

编译的时候，里面的样式会报错：

错误 MC3029：“ScrollBarStyleDefault”成员无效，因为它没有限定类型名称。

这是我从 Expression Blend 获得的 Scrollbar 样式 xaml 文件：

```
<ResourceDictionary
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero">

<LinearGradientBrush x:Key="VerticalScrollBarBackgroundDefault" EndPoint="1,0" StartPoint="0,0">
    <GradientStop Color="#E1E1E1" Offset="0"/>
    <GradientStop Color="#EDEDED" Offset="0.20"/>
    <GradientStop Color="#EDEDED" Offset="0.80"/>
    <GradientStop Color="#E3E3E3" Offset="1"/>
</LinearGradientBrush>
<!-- Resource dictionary entries should be defined here. -->
<SolidColorBrush x:Key="ScrollBarDisabledBackgroundDefault" Color="#F4F4F4"/>
<Style x:Key="ScrollBarButtonDefault" TargetType="{x:Type RepeatButton}">
    <Setter Property="OverridesDefaultStyle" Value="true"/>
    <Setter Property="Focusable" Value="false"/>
    <Setter Property="IsTabStop" Value="false"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type RepeatButton}">
                <Microsoft_Windows_Themes:ScrollChrome x:Name="Chrome" RenderMouseOver="{TemplateBinding IsMouseOver}" RenderPressed="{TemplateBinding IsPressed}" SnapsToDevicePixels="true" Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="{TemplateBinding Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph}"/>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="VerticalScrollBarPageButtonDefault" TargetType="{x:Type RepeatButton}">
    <Setter Property="OverridesDefaultStyle" Value="true"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Focusable" Value="false"/>
    <Setter Property="IsTabStop" Value="false"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type RepeatButton}">
                <Rectangle Fill="{TemplateBinding Background}" Height="{TemplateBinding Height}" Width="{TemplateBinding Width}"/>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="ScrollBarThumbDefault" TargetType="{x:Type Thumb}">
    <Setter Property="OverridesDefaultStyle" Value="true"/>
    <Setter Property="IsTabStop" Value="false"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Thumb}">
                <Microsoft_Windows_Themes:ScrollChrome x:Name="Chrome" RenderMouseOver="{TemplateBinding IsMouseOver}" RenderPressed="{TemplateBinding IsDragging}" SnapsToDevicePixels="true" Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="{TemplateBinding Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph}"/>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<LinearGradientBrush x:Key="HorizontalScrollBarBackgroundDefault" EndPoint="0,1" StartPoint="0,0">
    <GradientStop Color="#E1E1E1" Offset="0"/>
    <GradientStop Color="#EDEDED" Offset="0.20"/>
    <GradientStop Color="#EDEDED" Offset="0.80"/>
    <GradientStop Color="#E3E3E3" Offset="1"/>
</LinearGradientBrush>
<Style x:Key="HorizontalScrollBarPageButtonDefault" TargetType="{x:Type RepeatButton}">
    <Setter Property="OverridesDefaultStyle" Value="true"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Focusable" Value="false"/>
    <Setter Property="IsTabStop" Value="false"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type RepeatButton}">
                <Rectangle Fill="{TemplateBinding Background}" Height="{TemplateBinding Height}" Width="{TemplateBinding Width}"/>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="ScrollBarDefaultStyle" TargetType="{x:Type ScrollBar}">
    <Setter Property="Background" Value="{StaticResource VerticalScrollBarBackgroundDefault}"/>
    <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="Width" Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"/>
    <Setter Property="MinWidth" Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ScrollBar}">
                <Grid x:Name="Bg" Background="{TemplateBinding Background}" SnapsToDevicePixels="true">
                    <Grid.RowDefinitions>
                        <RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}"/>
                        <RowDefinition Height="0.00001*"/>
                        <RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}"/>
                    </Grid.RowDefinitions>
                    <RepeatButton Command="{x:Static ScrollBar.LineUpCommand}" IsEnabled="{TemplateBinding IsMouseOver}" Style="{StaticResource ScrollBarButtonDefault}" Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="UpArrow"/>
                    <Track x:Name="PART_Track" IsDirectionReversed="true" IsEnabled="{TemplateBinding IsMouseOver}" Grid.Row="1">
                        <Track.DecreaseRepeatButton>
                            <RepeatButton Command="{x:Static ScrollBar.PageUpCommand}" Style="{StaticResource VerticalScrollBarPageButtonDefault}"/>
                        </Track.DecreaseRepeatButton>
                        <Track.IncreaseRepeatButton>
                            <RepeatButton Command="{x:Static ScrollBar.PageDownCommand}" Style="{StaticResource VerticalScrollBarPageButtonDefault}"/>
                        </Track.IncreaseRepeatButton>
                        <Track.Thumb>
                            <Thumb Style="{StaticResource ScrollBarThumbDefault}" Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="VerticalGripper"/>
                        </Track.Thumb>
                    </Track>
                    <RepeatButton Command="{x:Static ScrollBar.LineDownCommand}" IsEnabled="{TemplateBinding IsMouseOver}" Grid.Row="2" Style="{StaticResource ScrollBarButtonDefault}" Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="DownArrow"/>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter Property="Background" TargetName="Bg" Value="{StaticResource ScrollBarDisabledBackgroundDefault}"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
    <Style.Triggers>
        <Trigger Property="Orientation" Value="Horizontal">
            <Setter Property="Width" Value="Auto"/>
            <Setter Property="MinWidth" Value="0"/>
            <Setter Property="Height" Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"/>
            <Setter Property="MinHeight" Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"/>
            <Setter Property="Background" Value="{StaticResource HorizontalScrollBarBackgroundDefault}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="Bg" Background="{TemplateBinding Background}" SnapsToDevicePixels="true">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}"/>
                                <ColumnDefinition Width="0.00001*"/>
                                <ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}"/>
                            </Grid.ColumnDefinitions>
                            <RepeatButton Command="{x:Static ScrollBar.LineLeftCommand}" IsEnabled="{TemplateBinding IsMouseOver}" Style="{StaticResource ScrollBarButtonDefault}" Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="LeftArrow"/>
                            <Track x:Name="PART_Track" Grid.Column="1" IsEnabled="{TemplateBinding IsMouseOver}">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageLeftCommand}" Style="{StaticResource HorizontalScrollBarPageButtonDefault}"/>
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageRightCommand}" Style="{StaticResource HorizontalScrollBarPageButtonDefault}"/>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Style="{StaticResource ScrollBarThumbDefault}" Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="HorizontalGripper"/>
                                </Track.Thumb>
                            </Track>
                            <RepeatButton Grid.Column="2" Command="{x:Static ScrollBar.LineRightCommand}" IsEnabled="{TemplateBinding IsMouseOver}" Style="{StaticResource ScrollBarButtonDefault}" Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="RightArrow"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Background" TargetName="Bg" Value="{StaticResource ScrollBarDisabledBackgroundDefault}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Trigger>
    </Style.Triggers>
</Style> 
```

这是我的 App.xaml 文件：

```
<Application x:Class="StockChart.App"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
StartupUri="MainWindow.xaml">
<Application.Resources>
    <ResourceDictionary>
          <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="Themes/BlackGloss.xaml"    />
            <ResourceDictionary Source="Themes/ScrollBarDefault.xaml" />
          </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources>
</Application> 
```

有谁知道如何做到这一点？

谢谢！

亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:04:26.267

如果不设置`BasedOn`，它将使用默认样式。试试这个适合你的风格：

```
<Style TargetType="ScrollBar" /> 
```

# php - PHP目录结构混乱

> ID：10112222
> 
> 赞同：2
> 
> 时间：2012-04-11T19:00:31.383
> 
> 标签：php, include, directory-structure

我正在尝试创建一个使用 PHP 作为驱动力的网站。该网站背后的想法（通常）要求每个用户都可以选择创建自己的个人资料（目前正在考虑为每个用户创建一个目录）。

我一直在做大量的研究，以便以最好的方式设置这个应用程序。但是在创建目录结构时，我感到极度困惑。我正在考虑下载一个框架助手（CodeIgniter），它可能会帮助我创业，但我宁愿先征求其他人的意见。

目前我的所有文件和内容都在我的 public_html 文件夹中，我知道这不是理想的设置。但我不确定如何创建替代结构。我不知道在哪里存储各种模板（header.php、footer.php 等）以及如何/在哪里调用它们。

我想创建页面来列出“关于”、“联系页面”和其他内容，但不知道这些页面应该放在哪里？我是否将这些页面的内容保存在 public_html 目录中并仅包含来自各个子文件夹的模板？

关于 config.php 文件：我试图在一个文件中包含与 MySQL 连接有关的所有必要信息，以及要包含在站点内每个页面开头的其他必要信息。

想法？我对云还很陌生，非常感谢如此简单和基本的响应！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:06:36.223

你这个想法是错误的。您不需要为每个用户创建一个目录。您可以使用[GET 参数](http://us3.php.net/manual/en/reserved.variables.get.php)让一个脚本（例如 profile.php）根据传递给它的数据为用户提取适当的配置文件。例如，`profile.php?userid=5212`将提取用户的配置文件`5212`（`$_GET['userid']`在这种情况下将包含用户的 id）。不传递任何内容很容易默认为拉取当前登录用户的配置文件。

您也可以使用`mod_rewrite`这样`http://www.yoursitehere.com/profile/5212/`可以做同样的事情（查看大多数 PHP 框架中的路由）

您的目录结构应该适合您。如果该站点足够简单，您可以使用一些简单的东西，例如

```
public_html/
    css/
    includes/
    images/
    js/ 
```

您的数据库配置可以存在`public_html/includes/`，您可以将其包含在任何需要数据库连接的页面上。您的关于和联系页面可以是位于其中的实际文件，`public_html/`以保持简单。同样，这些只是建议。您的目录结构应该是您需要的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:23:06.940

您可能会考虑使用像[Symfony](http://symfony.com/)这样的 PHP Web 框架。它将帮助您了解很多基础知识，以便您可以专注于产品功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:05:19.583

将所有内容存储在对您有意义的结构中。像这样的东西应该工作：

public_html

-包括

-图片

-css

-博客

等等...

关于配置文件，可以存放在`public_html`目录中，也可以存放在`includes`目录中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T19:31:09.273

对于用户配置文件，将所有信息存储在数据库中，并将用户 ID 作为字段。当用户登录时，运行查询以通过查询用户 ID 来选择所有信息。

至于文件结构，您可以使用：

```
    公共 html
    包括
      header.html
      页脚.html
      配置文件
    班级
    pages （在这里存储除 index.php 之外的其他页面、联系方式、关于等）
    css
    JS
    index.php/html

```

在 public_html 文件夹之外，我有我的 mysqli.php 文件。

要将这些头文件包含在您的 index.php 文件中，您只需创建（在您的包含文件夹或您选择的任何位置）一个具有以下内容的 config.php 文件：

```
 require_once($server['document_root']."/classes/filename.php"); // include needed files and mysqli connection here as well 
```

如果需要，您还可以在配置文件中设置自定义错误处理程序。

然后在您的 index.php 文件中，您将调用配置文件（它也会自动包含您在配置文件中指定的任何文件）以及您的页眉和页脚，即

```
include('/includes/header.html');
include('/includes/config.php');
<!--ENTER PAGE CONTENT HERE-->
include('/includes/footer.html'); 
```

# .net - Internet Explorer 8 rss 无法识别 SyndicationFeed 输出

> ID：10112225
> 
> 赞同：0
> 
> 时间：2012-04-11T19:00:38.047
> 
> 标签：.net, internet-explorer-8, rss

我正在使用 .net`SyndicationFeed`将提要写入 xml 文件。这是输出`SaveAsRss20`

```
<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:a10="http://www.w3.org/2005/Atom" version="2.0">
  <channel>
    <title>My Title</title>
    <description>My Feed Description</description>
    <item>
      <author>notAnEmail@notAHost.com</author>
      <category>Good</category>
      <title>The big story</title>
      <description>The big story content</description>
      <pubDate>Wed, 11 Apr 2012 14:49:46 -0400</pubDate>
    </item>
    <item>
      <author>notAnEmail@notAHost.com</author>
      <category>Bad</category>
      <title>Small news</title>
      <description>Small news content</description>
      <pubDate>Wed, 11 Apr 2012 14:49:46 -0400</pubDate>
    </item>
    <item>
      <author>notAnEmail@notAHost.com</author>
      <category>Bad</category>
      <category>Good</category>
      <title>Birthday announcements</title>
      <description>Birthday announcements content</description>
      <pubDate>Wed, 11 Apr 2012 14:49:46 -0400</pubDate>
    </item>
  </channel>
</rss> 
```

提要在 Internet Explorer 8 中作为 xml 文件打开 - 它没有得到其他提要 xml 文件所获得的 xslt 处理。

我也尝试过`SaveAsAtom10`导致不同的 xml，但相同的 IE8 行为。

我的同事说他可以使用另一个 feedreader 订阅 feed，但我选择的 feedreader 是 IE8，所以我想让我的 feed 使用它。

为了让 IE8 识别提要，我缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:04:52.680

确保您的响应类型是：application/rss+xml

我知道我在 IE 和提要方面也遇到过类似的问题，原因通常是响应类型。

# ruby - 何时 gem 可以保留 crontab 文件中的现有行吗？

> ID：10112226
> 
> 赞同：6
> 
> 时间：2012-04-11T19:00:58.407
> 
> 标签：ruby, environment-variables, crontab, whenever

我在用：

*   红宝石 1.9.2
*   每当 0.7.2
*   卡皮斯特拉诺 2.9.0
*   capistrano-ext 1.2.1

我在部署时与 Capistrano 结合使用来管理我的 crontab 文件。

我注意到它每次都会完全重写我的 crontab 文件。

我希望能够在 cron 中设置环境变量来控制 PATH 和 MAILTO 设置，它们是常规的 cron 环境变量。

有没有办法在不覆盖整个 crontab 文件时进行设置，以便我可以将自定义添加到我的 crontab 文件并确保它们会持续存在？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-17T19:38:19.763

是的，你可以这样做。您只需为写入 crontab 的任务分配一个标识符：

```
whenever --update-crontab some_identifier_name 
```

它将在 crontab 中生成一个条目，如下所示：

```
# Begin Whenever generated tasks for: some_identifier_name
0,5,10,15,20,25,30,35,40,45,50,55 * * * * /bin/bash -l -c 'cd /var/www/test/releases/20120416183153 && script/rails runner -e production '\''Model.some_method'\'' >> /tmp/cron_log.log 2>&1'

# End Whenever generated tasks for: some_identifier_name 
```

然后，每当您调用上面的命令时，它只会在找到您指定的标识符的位置更新。

# jasper-reports - 使用 Jasper Reports / iReport 获取从子报表到主报表的总计？

> ID：10112227
> 
> 赞同：0
> 
> 时间：2012-04-11T19:00:58.017
> 
> 标签：jasper-reports

我想计算子报告的一些总数并在主报告中使用它。如何才能做到这一点？

/马可

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:06:26.277

您将要从子报表返回的值存储到子报表中的变量中。然后在子报表属性的主报表中，有一个选项可以从子报表中选择返回变量。

# javascript - jQuery 菜单无法正常工作

> ID：10112228
> 
> 赞同：0
> 
> 时间：2012-04-11T19:00:59.287
> 
> 标签：javascript, jquery, css, drop-down-menu

我试图让一个jQuery菜单工作，它悬停在每一个项目上。这是[小提琴代码！](http://jsfiddle.net/PhilippB/wneTh/). 你可能会在结果中看到什么。当我悬停一项时，所有项目都会受到影响。我的错误在哪里？

**这是javascript代码：**

```
$(document).ready(function(){

    //Remove outline from links
    $("a").click(function(){
        $(this).blur();
    });

    //When mouse rolls over
    $("li").mouseover(function(){
        $(this).stop().animate({height:'200px'},{queue:false, duration:600, easing: 'easeOutBounce'})
    });

    //When mouse is removed
    $("li").mouseout(function(){
        $(this).stop().animate({height:'140px'},{queue:false, duration:600, easing: 'easeOutBounce'})
    });

}); 
```

如果其余的也是必要的，请查看[小提琴代码。](http://jsfiddle.net/PhilippB/wneTh/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:13:36.387

这是关于 CSS 的。更大的 'li' 扩展了你的 'ul'。尝试这个：

```
$(document).ready(function(){

    //Remove outline from links
    $("a").click(function(){
        $(this).blur();
    });

    //When mouse rolls over
    $("li").mouseover(function(){
        $(this).stop().animate({marginTop:'-60px'},{queue:false, duration:600, easing: 'easeOutBounce'})
    });

    //When mouse is removed
    $("li").mouseout(function(){
        $(this).stop().animate({marginTop:'0px'},{queue:false, duration:600, easing: 'easeOutBounce'})
    });

});​ 
```

[http://jsfiddle.net/VpQkE/](http://jsfiddle.net/VpQkE/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:12:25.623

打开它时，您需要设置一个负的上边距。虽然这可能证明 lis 浮动存在问题。

```
 //When mouse rolls over
    $("li").mouseover(function(){
        $(this).stop().animate({'height':'200px','margin-top':'-60px'},{queue:false, duration:600, easing: 'easeOutBounce'})
    });

//When mouse is removed
$("li").mouseout(function(){
    $(this).stop().animate({'height':'140px','margin-top':'0px'},{queue:false, duration:600, easing: 'easeOutBounce'})
}); 
```

# mysql - VARCHAR(255) 之后的下一个最好的事情是什么

> ID：10112229
> 
> 赞同：6
> 
> 时间：2012-04-11T19:00:59.367
> 
> 标签：mysql

我有一张表，里面有大约 200 万条记录。我有一个名为 message 的字段，它设置为 varchar(160) 并且我需要比 varchar(255) 更大的内容，因为我需要能够在其中存储大约 500 个字符，在不增加大小的情况下使用的下一个最佳数据类型是什么分贝急剧？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T19:06:11.633

[从 MySQL 5.0.3 开始](http://dev.mysql.com/doc/refman/5.0/en/string-type-overview.html)，您可以简单地使用`VARCHAR(500)`.

> M 表示以字符为单位的最大列长度。在 MySQL 5.0 中，M 的范围在 MySQL 5.0.3 之前为 0 到 255，在 MySQL 5.0.3 及更高版本中为 0 到 65,535。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T19:06:03.263

如果您使用的是 5.0.3 或更高版本，则 varchar 可以是 65535 个字符。

[11.4.1\. CHAR 和 VARCHAR 类型](http://dev.mysql.com/doc/refman/5.0/en/char.html)

[MySQL：大型 VARCHAR 与 TEXT](https://stackoverflow.com/questions/2023481/mysql-large-varchar-vs-text)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-06T18:19:53.883

您可以使用`TEXT`然后*运行* [​​PROCEDURE ANALYZE](https://dev.mysql.com/doc/refman/5.7/en/procedure-analyse.html)

> 这建议了可能有助于减少表大小的每列的最佳数据类型。

# php - xmlhttprequest 和 php

> ID：10112230
> 
> 赞同：0
> 
> 时间：2012-04-11T19:01:01.350
> 
> 标签：php, xmlhttprequest

这是一个愚蠢的问题，不要笑，我一直在努力解决这个问题但没有运气，我想我太累了。所以有一个应用程序将数据（图像文件作为字符串）发送到 php 脚本，并使用`XMLHttpRequest.send(data)`. 我的问题是如何在 PHP 中访问此字符串以将其保存到文件中？

EDIT `$_POST`，`$_GET`并且`$_FILES`都是空的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:05:30.633

第一：确保您正在发送一个 POST 请求（当您调用该[`open`](http://www.w3.org/TR/XMLHttpRequest/#the-open-method)方法时）

第二：由于看起来您正在发送原始数据，请设置适当的内容类型（使用[`setRequestHeader`](http://www.w3.org/TR/XMLHttpRequest/#the-setrequestheader-method)）

第三：您应该能够使用[`$HTTP_RAW_POST_DATA`](http://php.net/manual/en/reserved.variables.httprawpostdata.php)or检索数据`file_get_contents("php://input");`。

# ajax - 为对 Web API 的 AJAX 调用返回“非 HTML”格式错误

> ID：10112232
> 
> 赞同：2
> 
> 时间：2012-04-11T19:01:06.813
> 
> 标签：ajax, json, asp.net-mvc-4, asp.net-web-api

将 Web API 作为 MVC 4 项目的一部分进行调查，作为提供基于 AJAX 的 API 的替代方法。我为 MVC 控制器扩展了 AuthorizeAttribute，这样，如果检测到 AJAX 请求，就会返回 JSON 格式的错误。Web API 以 HTML 形式返回错误。这是我与 MVC 控制器一起使用的 AuthorizeAttribute：

```
public class AuthorizeAttribute: System.Web.Mvc.AuthorizeAttribute
{
    protected override void HandleUnauthorizedRequest(AuthorizationContext filterContext)
    {
        base.HandleUnauthorizedRequest(filterContext);

        filterContext.Result = new RedirectToRouteResult(
            new RouteValueDictionary 
            {
                { "area", "" },
                { "controller", "Error" },
                { "action", ( filterContext.HttpContext.Request.IsAjaxRequest() ? "JsonHttp" : "Http" ) },
                { "id", "401" },
            });
    }
} 
```

我怎样才能重现它来为 Web API 提供等效的功能？

我意识到我需要扩展 System.Web.Http.AuthorizeAttribute 而不是 System.Web.Mvc.AuthorizeAttribute 但这使用的是 HttpActionContext 而不是 AuthorizationContext 所以我被我对 Web API 的有限知识和看似不完整的知识所困扰MSDN 上的文档。

我认为这将是正确的方法是否正确？

将不胜感激任何指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:21:30.953

要在 Web API 过滤器中获得等效功能，您可以将[`HttpActionContext.Response`](http://msdn.microsoft.com/en-us/library/system.web.http.controllers.httpactioncontext.response%28v=vs.108%29.aspx)属性设置为具有正确重定向状态代码和位置标头的实例`HttpResponseMessage`：

```
protected override void HandleUnauthorizedRequest(HttpActionContext actionContext) {
    var response = new HttpResponseMessage(HttpStatusCode.Redirect);
    response.Headers.Location = new Uri("my new location");
    actionContext.Response = response;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:37:46.843

我非常愿意接受 Marcin 的回答——归根结底，他已经编写了代码！

我要补充的是，正如 Marcin 所说，您最好的选择是拥有一个专用控制器来适当地返回**错误**- 而不是在属性中设置带有 JSON 内容的响应代码 401。

主要原因是 Web API为您进行**内容协商**，如果您想自己做（看看您是否需要提供 JSON 或 HTML），您将失去所有这些功能。

# svn - SVN：从提交后挂钩获取文件属性

> ID：10112234
> 
> 赞同：1
> 
> 时间：2012-04-11T19:01:11.270
> 
> 标签：svn, svn-hooks

是否可以从提交后挂钩获取文件属性？

我想检查所有更改的文件，如果其中一个或多个具有我的特定属性，我想执行一些操作。

```
svn propget my:property file.txt 
```

^ 这仅从本地工作副本中读取属性，但我在执行钩子的环境中没有它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T04:55:51.863

当你使用钩子时，你应该使用`svnlook`命令而不是`svn`命令。

```
TXN=$1
REPOS=$2
SVNLOOK="/usr/bin/svnlook"

"$SVNLOOK" pget -t $TXN $REPOS my:property /path/in/repository 
```

`svnlook changed`您可以通过以下命令获取已更改的文件列表：

```
/usr/bin/svnlook changed -t $TXN 
```

这将为您提供更改类型（U = 已更新，D = 已删除，M = 已修改，R = 已替换）和文件名。您可以使用该文件名和`svnlook pget`命令来查看属性。

也许是这样的：

```
$SVNLOOK changed -t $TXN | while read changeType fileName
do
    $SVNLOOK plist -t $TXN -v $REPOS $fileName
done 
```

shell 的问题之一是你不能很容易地在循环中做循环。例如，如果我可以用 做某事会很好`$SVNLOOK plist`，但我已经将 STDOUT 输送到 STDIN，因此任何输出`svnlook plist`都会影响我的外循环。你可以做各种奇怪的事情来使用其他文件描述符，但使用 Python 或 Perl 更容易。

您也确实无法更改有关提交的任何内容。您不能更改文件或文件属性。您唯一可以更改的是修订属性，例如`svn:log`，即使这样也不推荐。

不知道你在想什么，但要小心。还要了解任何可能花费太长时间的事情都会延迟用户的提交，因为他们等待您的提交后脚本运行。我见过人们尝试在 Subversion 挂钩中编译和运行单元测试。在这种情况下，您最好使用像[Jenkins](http://jenkins-ci.org)这样的持续构建系统来进行提交后处理。

你可以看看我的[svn-watcher-hook](https://github.com/qazwart/SVN-Watcher-Hook)看看它是如何完成的。这是一个 Perl 脚本，但并不是那么复杂，我尝试解释我所做的一切。应该不难理解。

# python - 在 Python 中将纯文本转换为 PDF

> ID：10112244
> 
> 赞同：8
> 
> 时间：2012-04-11T19:02:08.453
> 
> 标签：python, text, reportlab

对于我的项目，我从另一个程序中获得了一个纯文本文件 (report.txt)。它全部采用纯文本格式。如果您在记事本中打开它，它看起来不错（就像纯文本文件一样）。当我在 Word 中打开文件并显示段落时，我看到 ... 表示空格，而向后的 P 表示段落。

我需要将此文件转换为 PDF 并添加一些其他 PDF 页面来制作最终的 PDF。这一切都发生在 Python 中。

我无法将 report.txt 转换为 pdf。我有 ReportLab，并且能够读取文件并进行一些更改（例如将文本更改为 Courier），但间距会丢失。当文件被读取时，它似乎去除了任何额外的空格。

问题：a) 有没有更简单的方法将 report.txt 转换为 pdf？b）如果没有，有没有办法在我阅读文件时保留我的空间？c）或者我的段落样式中是否缺少一个参数来保持原始外观？

这是我的代码：

```
# ------------------------------------
# Styles
# ------------------------------------

styleSheet = getSampleStyleSheet()
mystyle = ParagraphStyle(name='normal',fontName='Courier',
                         fontSize=10, 
                         alignment=TA_JUSTIFY, 
                         leading=1.2*12,
                         parent=styleSheet['Normal'])       

#=====================================================================================       
model_report = 'report.txt'

# Create document for writing to pdf  
doc = SimpleDocTemplate(str(pdfPath),  \
                        rightMargin=40, leftMargin=40, \
                        topMargin=40, bottomMargin=25, \
                        pageSize=A4)
doc.pagesize = portrait(A4)

# Container for 'Flowable' objects
elements = []    

# Open the model report
infile   = file(model_report).read()
report_paragraphs = infile.split("\n")

for para in report_paragraphs:  
    para1 = '<font face="Courier" >%s</font>' % para 
    elements.append(Paragraph(para1, style=mystyle))
doc.build(elements) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-11-17T14:25:19.527

我创建了一个小型辅助函数，通过使用等宽字体将多行文本转换为“报告外观”的 PDF 文件。太长的行在空格处换行，以使其适合页面宽度：

```
import textwrap
from fpdf import FPDF

def text_to_pdf(text, filename):
    a4_width_mm = 210
    pt_to_mm = 0.35
    fontsize_pt = 10
    fontsize_mm = fontsize_pt * pt_to_mm
    margin_bottom_mm = 10
    character_width_mm = 7 * pt_to_mm
    width_text = a4_width_mm / character_width_mm

    pdf = FPDF(orientation='P', unit='mm', format='A4')
    pdf.set_auto_page_break(True, margin=margin_bottom_mm)
    pdf.add_page()
    pdf.set_font(family='Courier', size=fontsize_pt)
    splitted = text.split('\n')

    for line in splitted:
        lines = textwrap.wrap(line, width_text)

        if len(lines) == 0:
            pdf.ln()

        for wrap in lines:
            pdf.cell(0, fontsize_mm, wrap, ln=1)

    pdf.output(filename, 'F') 
```

这是您将如何使用此函数将文本文件转换为 PDF 文件的方法：

```
input_filename = 'test.txt'
output_filename = 'output.pdf'
file = open(input_filename)
text = file.read()
file.close()
text_to_pdf(text, output_filename) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T16:47:03.240

ReportLab 是通常的建议——您可以从本页右侧的“相关”问题中看到。

您是否尝试过使用 just 创建文本`StyleSheet['Normal']`？即，如果您通过以下内容获得外观正确的输出，则问题出在您的风格上。

```
Paragraph(para1, style=StyleSheet['Normal']) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-07-14T14:43:06.340

要将文本或文本文件转换为 pdf，应在*命令行界面中使用***pip install fpdf**安装模块 fpdf 。运行以下代码，您将在文件夹中找到 pdf 文件-

 *```
from fpdf import FPDF 
pdf = FPDF()      
# Add a page 
pdf.add_page()  
# set style and size of font  
# that you want in the pdf 
pdf.set_font("Arial", size = 15)
# open the text file in read mode 
f = open("path where text file is stored\\File_name.txt", "r") 
# insert the texts in pdf 
for x in f: 
    pdf.cell(50,5, txt = x, ln = 1, align = 'C') 
# save the pdf with name .pdf 
pdf.output("path where you want to store pdf file\\File_name.pdf") 
```

参考：[https ://www.geeksforgeeks.org/convert-text-and-text-file-to-pdf-using-python/](https://www.geeksforgeeks.org/convert-text-and-text-file-to-pdf-using-python/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-12T21:22:02.927

您可以使用创建画布`pdf_canvas = canvas.Canvas('output_file.pdf')`并使用`pdf_canvas.save()`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-21T20:33:20.043

我有类似的问题。我用这段代码解决了：

```
from reportlab.lib.pagesizes import letter
from reportlab.pdfgen import canvas
from reportlab.lib.utils import ImageReader
from PIL import Image

# .....
# ..... some exta code unimportant for this issue....
# ....

# here it is
ptr = open("tafAlternos.txt", "r")  # text file I need to convert
lineas = ptr.readlines()
ptr.close()
i = 750
numeroLinea = 0

while numeroLinea < len(lineas):
    if numeroLinea - len(lineas) < 60: # I'm gonna write every 60 lines because I need it like that
        i=750
        for linea in lineas[numeroLinea:numeroLinea+60]:      
            canvas.drawString(15, i, linea.strip())
            numeroLinea += 1
            i -= 12
        canvas.showPage()
    else:
        i = 750
        for linea in lineas[numeroLinea:]:
           canvas.drawString(15, i, linea.strip())
           numeroLinea += 1
           i -= 12
        canvas.showPage() 
```

Pdf 看起来与原始文本文件完全相同*

# ruby-on-rails-3 - Resque 工作人员的 Heroku 日志

> ID：10112245
> 
> 赞同：7
> 
> 时间：2012-04-11T19:02:13.423
> 
> 标签：ruby-on-rails-3, logging, heroku, backgroundworker, resque

我正在使用 Heroku + RedisToGo + Resque。我有一个工人正在运行一个无休止的任务。我想记录它的活动。`heroku logs --tail`不显示有关工人活动的任何信息。我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T23:57:30.250

Heroku 记录任何写入标准输出或标准错误的内容。所以一个简单的`puts`语句应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T22:17:56.070

尝试`Rails.logger.info("I am done doing stuff!")`在 Resque 工作人员的`#perform`方法中添加类似的内容。

# javascript - 我正在尝试 .Find() 一个 Div 内的 TextArea

> ID：10112252
> 
> 赞同：1
> 
> 时间：2012-04-11T19:02:51.370
> 
> 标签：javascript, jquery, html

```
 <div id='bla'>
   <textarea type='text' style='text-align:center; color:black; width:90px; border:1px     
    solid transparent; font-size:11px; margin:2px'>this is a test</textarea>
 </div>​​​​​​​​​​​​

 alert($('bla').find('textarea').css('border')) 
```

但由于某种原因，这会返回“未定义”的任何想法，为什么？我正在该样式内定义边框...：/

jsfiddle：http: [//jsfiddle.net/foreyez/yWgqD/](http://jsfiddle.net/foreyez/yWgqD/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T19:04:07.797

之前错过了 ID 选择器 ( `#`) `bla`...

相反，请使用以下内容：

```
alert($('#bla textarea').css('border')) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:04:55.097

您需要使用`#`ID 选择器：

```
$("#bla").find("textarea").css("border"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T22:33:43.050

选择器不会剪掉它，你也忘记了 dom ready 部分。

```
$(function() {
    alert($('#bla').find('textarea').css('border'));
}); 
```

[http://jsfiddle.net/yWgqD/1/](http://jsfiddle.net/yWgqD/1/)

同样作为选择器，这更清洁

$('#bla textarea')

# python - pygame中的随机“ValueError：list.remove（x）：x不在列表中”错误

> ID：10112253
> 
> 赞同：0
> 
> 时间：2012-04-11T19:02:53.500
> 
> 标签：python, pygame

所以我有一个用python编写的小游戏，如果你看到我之前的问题你就知道它是一个“太空入侵者”的克隆。

所以现在几乎所有的东西都运行得很顺利，除了偶尔会弹出一个随机错误。这是完全随机的，它可能在发射了一些子弹之后发生，也可能根本不发生。

我有这个代码：

```
 for bullet in bullets:
        bullet.attack()
        if bullet.posy<=-20:
            bullet_draw=False
        if bullet_draw==True:
            bullet.draw()
        for enemy in enemies:
            if bullet.sprite.rect.colliderect(enemy.sprite.rect):
                enemy.health-=1
                bullets.remove(bullet)
                bullet_draw=False
            else:
                bullet_draw=True 
```

有时它会给我以下错误。

```
Traceback (most recent call last):
  File "\Programming\space invaders\space.py", line 280, in <module>
    bullets.remove(bullet)
ValueError: list.remove(x): x not in list 
```

请注意，这个错误是完全随机的；即使不是，我也无法追踪它的起源。关于如何消除它的任何帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T19:08:47.817

尝试将其更改为以下内容：

```
 for bullet in bullets[:]:    # this is changed, iterating over a copy
        bullet.attack()
        if bullet.posy<=-20:
            bullet_draw=False
        if bullet_draw==True:
            bullet.draw()
        for enemy in enemies:
            if bullet.sprite.rect.colliderect(enemy.sprite.rect):
                enemy.health-=1
                bullets.remove(bullet)
                bullet_draw=False
                break            # this is added, prevents multiple removes
            else:
                bullet_draw=True 
```

请注意我添加的显示更改的两条评论，这`break`是必要的，因为一颗子弹可能会击中多个敌人，这会导致`bullets.remove(bullet)`被调用两次，这会导致您看到的回溯。

第一个更改是必要的，因为在迭代时从列表中删除元素可能会导致一些意想不到的后果，因为您最终会在迭代期间跳过一些元素。以下代码说明了这一点：

```
>>> data = range(10)
>>> for x in data:
...     data.remove(x)
...
>>> data
[1, 3, 5, 7, 9] 
```

尽管代码看起来应该从列表中删除每个元素，但它只会删除所有其他元素，因为列表索引在迭代期间会发生变化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T19:06:24.270

你的子弹击中了多个敌人。你需要`break`跳出`enemies`循环。

# asp.net - 实体插入似乎成功，但未出现在查询中

> ID：10112257
> 
> 赞同：0
> 
> 时间：2012-04-11T19:03:06.950
> 
> 标签：asp.net, entity-framework

我有一个非常简单的行，我正在使用 Entity 插入，我喜欢这样：

```
var context = GetEntityContext();
SOMEPOCO newobj = new SOMEPOCO
{
    Data = data
};

context.SOMEOBJECTS.Add(newobj);
context.SaveChanges();
return newobj.ID; 
```

并且确实填充了 newobj.ID（自动递增的主键）。不会引发错误或抛出异常。但是当我去 SQL Management Studio 并查询项目或在代码中查找它时，它不会显示出来。但是，如果我在数据库中手动创建一个条目，它会增加主键，就好像之前失败的条目在那里一样。

这可能是什么原因造成的？

谢谢。

# twitter - 了解 Twitter 用户是否启用了位置信息

> ID：10112268
> 
> 赞同：1
> 
> 时间：2012-04-11T19:04:02.740
> 
> 标签：twitter

我正在编写一个将推文发布到 Twitter 的应用程序。我想提供在推文中包含位置的选项，该选项可通过使用 lat 和 long 参数的 POST statuses/update 获得。

[这是我的问题：如果 Twitter 帐户没有通过https://twitter.com/settings/account](https://twitter.com/settings/account) “将位置添加到我的推文”打开位置推文，那么我可以发送带有位置信息的推文，但位置信息不会出现。这对用户的安全来说是一件好事，但对我来说却很烦人，因为：

如果用户没有打开这个功能，我就不应该在我的 UI 中提供它。让用户认为他可以包含位置信息，但由于某些超出我控制范围的设置而无法显示该信息，这是一种糟糕的用户体验。

所以这是我的问题：有没有办法通过 twitter api 知道用户是否在他的 twitter 设置中打开了这个设置？我浏览了 GET users/show，但在那里找不到任何提到我想要找出的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T04:06:18.640

好吧，经过一番挖掘，事实证明有一个“geo_enabled”键包含在来自几个 twitter 端点的响应中。当然，它可以从[GET account/settings](https://dev.twitter.com/docs/api/1/get/account/settings)访问，但它也经常出现在对[GET users/lookup](https://dev.twitter.com/docs/api/1/get/users/lookup)以及可能返回用户数据的其他几个端点的响应中。

如果“geo_enabled”为真，则用户同意让位置数据发布在他的推文中。如果它是假的或没有出现，那么我将假设用户哈希没有打开这个功能。

# function - 覆盖 ALV 中的函数

> ID：10112270
> 
> 赞同：0
> 
> 时间：2012-04-11T19:04:09.420
> 
> 标签：function, events, grid, abap, alv

我想覆盖 ALV 网格中的某些功能。但我无法通过回调用户命令来做到这一点。这仅适用于非标准功能。任何的想法？我应该使用事件退出吗？我用它尝试了一些东西，但也做不到：P

```
FORM event_exits.

  CLEAR wa_eventexit.
  wa_eventexit-ucomm = '&OUP'.
  wa_eventexit-before = 'X'.
  APPEND wa_eventexit TO it_eventexit.
  CLEAR wa_eventexit.
  wa_eventexit-ucomm = '&ODN'.
  wa_eventexit-before = 'X'.
  APPEND wa_eventexit TO it_eventexit.

ENDFORM.                     "event_exits

FORM user_command Using r_ucomm LIKE sy-ucomm
                    rs_selfield TYPE slis_selfield.
 CASE r_ucomm.
    WHEN '&OUP'.
      IF ck_del = 'X'.
        SORT gt_salord BY audat vbeln lfimg ASCENDING.
      ELSE.
        SORT gt_salord BY audat vbeln kwmeng ASCENDING.
      ENDIF.
    WHEN '&ODN'.
      IF ck_del = 'X'.
        SORT gt_salord BY audat vbeln lfimg DESCENDING.
      ELSE.
        SORT gt_salord BY audat vbeln kwmeng DESCENDING.
      ENDIF.
    WHEN 'D01'.
      BREAK-POINT.
  ENDCASE.
   CLEAR sy-ucomm.
ENDFORM.    "user_command 
```

D01 功能仅用于测试，因此当我访问它时，我可以看到它进入了 user_command。但是当我访问函数 &OUP 时，它不再在 CASE 中输入（我通过调试对其进行测试）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:19:53.343

我不知道这是否适合你，但你可能想要 ALV 对象模型——它有[更好的文档](http://help.sap.com/saphelp_nw04/helpdata/en/5e/88d440e14f8431e10000000a1550b0/frameset.htm)——例如参见[本章](http://help.sap.com/saphelp_nw04/helpdata/en/d7/b22041aa7df323e10000000a155106/frameset.htm)关于处理函数和事件的内容。更重要的是，它是官方支持的——如果你使用它并且它不能正常工作，你会得到帮助，而不是习惯性的“你正在使用未发布的内部类/功能模块”的话。看看demo程序（SALV_DEMO_*或者DEMO_SALV_*，记不得了。）

再说一次，如果你想定义一个自定义的排序机制，你可能应该只是隐藏默认按钮并插入你自己的具有不同功能代码的按钮。谁知道，在第 42 版中，有人可能会想出再次启用默认排序的想法，然后您就不必再次调整所有内容了……

# c# - 组合框对象上的 NullReferenceException - C#

> ID：10112271
> 
> 赞同：0
> 
> 时间：2012-04-11T19:04:12.250
> 
> 标签：c#, winforms, nullreferenceexception

我正在尝试将 XML 文件中的一些元素显示到使用选项卡的表单中。

但是，我在以下代码行中收到错误“NullReferenceException”：

```
var assessment1 = from d in document.Descendants("moduleTitle")
                            where d.Value == (comboBoxModuleSelect[i] as ComboBox).SelectedItem.ToString() //error here on this line
                            select d.Parent.Element("assessmentOne").Value; 
```

此代码位于单击按钮内，单击后会生成新的组合框。我这样做的方式如下：

```
private void buttonLevel4Add_Click(object sender, EventArgs e)
        {
            var document = XDocument.Load(workingDir + @"\Level4.xml");
            comboBoxModuleSelect.Add(new ComboBox());
            System.Drawing.Point p = new System.Drawing.Point(7, 57 + i * 25);
            (comboBoxModuleSelect[i] as ComboBox).Location = p;
            (comboBoxModuleSelect[i] as ComboBox).Size = new System.Drawing.Size(183, 20);
            tabPageLevel4.Controls.Add(comboBoxModuleSelect[i] as ComboBox);
        } 
```

整数 i 是一个类变量，每次单击按钮时都会增加它以创建新的组合框。

上面的片段可能会令人困惑，因为它们没有按顺序排列，所以这里是整个类：

```
public partial class Form1 : Form
    {
        String workingDir = Directory.GetCurrentDirectory();
        ArrayList comboBoxModuleSelect = new ArrayList();
        ArrayList labelAssessments = new ArrayList();
        int i = 0; //for combo boxes

        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            tabControl.SelectTab(1);
        }

        private void buttonLevel4Add_Click(object sender, EventArgs e)
        {
            var document = XDocument.Load(workingDir + @"\Level4.xml");
            comboBoxModuleSelect.Add(new ComboBox());
            System.Drawing.Point p = new System.Drawing.Point(7, 57 + i * 25);
            (comboBoxModuleSelect[i] as ComboBox).Location = p;
            (comboBoxModuleSelect[i] as ComboBox).Size = new System.Drawing.Size(183, 20);
            tabPageLevel4.Controls.Add(comboBoxModuleSelect[i] as ComboBox);

            this.labelAssessments.Add(new Label());
            System.Drawing.Point pLabel = new System.Drawing.Point(200 + i * 25, 81);
            (labelAssessments[i] as Label).Location = pLabel;
            (labelAssessments[i] as Label).Size = new System.Drawing.Size(80, 13);
            tabPageLevel4.Controls.Add(labelAssessments[i] as Label);

            var moduleName = from d in document.Descendants("moduleTitle")
                        select d.Value;
            foreach (var item in moduleName)
            {
                //add the module names into the dropdown for students to select
                (comboBoxModuleSelect[i] as ComboBox).Items.Add(item);
            }

            var assessment1 = from d in document.Descendants("moduleTitle")
                            where d.Value == (comboBoxModuleSelect[i] as ComboBox).SelectedItem.ToString()
                            select d.Parent.Element("assessmentOne").Value;
            foreach (var item in assessment1)
            {

                (labelAssessments[i] as Label).Text = item.ToString();

            }

            i++;//for drawing

        } 
```

这是XML：

```
<Course>
  <CourseName>BEng Software Engineering</CourseName>
  <Modules>
    <Module>
      <moduleCode>ECSE401</moduleCode>
      <moduleTitle>Programming Methodology</moduleTitle>
      <credits>15</credits>
      <assessmentOne>Coursework</assessmentOne>
      <assessmentOneWeight>40</assessmentOneWeight>
      <assessmentTwo>Coursework</assessmentTwo>
      <assessmentTwoWeight>40</assessmentTwoWeight>
      <assessmentThree>Test</assessmentThree>
      <assessmentThreeWeight>20</assessmentThreeWeight>
    </Module>
    <Module>
      <moduleCode>ECSC404</moduleCode>
      <moduleTitle>Computer Systems Fundamentals</moduleTitle>
      <credits>15</credits>
      <assessmentOne>Test1</assessmentOne>
      <assessmentOneWeight>30</assessmentOneWeight>
      <assessmentTwo>Test2</assessmentTwo>
      <assessmentTwoWeight>30</assessmentTwoWeight>
      <assessmentThree>Test3</assessmentThree>
      <assessmentThreeWeight>40</assessmentThreeWeight>
    </Module>
    <Module>
      <moduleCode>EBSY401</moduleCode>
      <moduleTitle>Information and Data Modelling</moduleTitle>
      <credits>15</credits>
      <assessmentOne>Test</assessmentOne>
      <assessmentOneWeight>25</assessmentOneWeight>
      <assessmentTwo>Coursework1</assessmentTwo>
      <assessmentTwoWeight>10</assessmentTwoWeight>
      <assessmentThree>Coursework2</assessmentThree>
      <assessmentThreeWeight>35</assessmentThreeWeight>
      <assessmentFour>Coursework3</assessmentFour>
      <assessmentFourWeight>30</assessmentFourWeight> 
    </Module>
    <Module>
      <moduleCode>ECSC405</moduleCode>
      <moduleTitle>Software Development Principles</moduleTitle>
      <credits>15</credits>
      <assessmentOne>Test1</assessmentOne>
      <assessmentOneWeight>30</assessmentOneWeight>
      <assessmentTwo>Coursework</assessmentTwo>
      <assessmentTwoWeight>40</assessmentTwoWeight>
      <assessmentThree>Test2</assessmentThree>
      <assessmentThreeWeight>30</assessmentThreeWeight>
    </Module>
    <Module>
      <moduleCode>ECSC407</moduleCode>
      <moduleTitle>Web Technology</moduleTitle>
      <credits>15</credits>
      <assessmentOne>Tutorials</assessmentOne>
      <assessmentOneWeight>20</assessmentOneWeight>
      <assessmentTwo>Coursework</assessmentTwo>
      <assessmentTwoWeight>20</assessmentTwoWeight>
      <assessmentThree>Exam</assessmentThree>
      <assessmentThreeWeight>60</assessmentThreeWeight>
    </Module>
    <Module>
      <moduleCode>ECSC409</moduleCode>
      <moduleTitle>Software Engineering Principles</moduleTitle>
      <credits>15</credits>
      <assessmentOne>Coursework1</assessmentOne>
      <assessmentOneWeight>40</assessmentOneWeight>
      <assessmentTwo>Coursework2</assessmentTwo>
      <assessmentTwoWeight>30</assessmentTwoWeight>
      <assessmentThree>Coursework3</assessmentThree>
      <assessmentThreeWeight>30</assessmentThreeWeight>
    </Module>
    <Module>
      <moduleCode>ECSC408</moduleCode>
      <moduleTitle>Mathematics for Computing</moduleTitle>
      <credits>15</credits>
      <assessmentOne>Coursework</assessmentOne>
      <assessmentOneWeight>50</assessmentOneWeight>
      <assessmentTwo>Exam</assessmentTwo>
      <assessmentTwoWeight>50</assessmentTwoWeight>
    </Module>
    <Module>
      <moduleCode>EBSY400</moduleCode>
      <moduleTitle>Communication and Learning Skills</moduleTitle>
      <credits>15</credits>
      <assessmentOne>Coursework</assessmentOne>
      <assessmentOneWeight>30</assessmentOneWeight>
      <assessmentTwo>Coursework</assessmentTwo>
      <assessmentTwoWeight>70</assessmentTwoWeight>
    </Module>
  </Modules>
</Course> 
```

我不明白为什么我得到一个空引用异常，请有人帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:08:47.860

`i`可能未选择索引处的组合框（因此`SelectedItem`返回 null），或者`d`可能为 null

看你`document.Descendants`上面用没问题，我觉得是选择给你带来了麻烦

尝试：

```
ComboBox cb = comboBoxModuleSelect[i] as ComboBox;
if (cb.SelectedItem != null ) {
  var assessment1 = from d in document.Descendants("moduleTitle") 
    where (d.Value == cb.SelectedItem.ToString())
    select d.Parent.Element("assessmentOne").Value;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:14:19.000

我猜你已经在组合框中添加了一堆项目，但没有一个被选中。这就是为什么`SelectedItem`返回`null`。

# java - 如何在 java/groovy 中进行此计算？

> ID：10112272
> 
> 赞同：-3
> 
> 时间：2012-04-11T19:04:14.363
> 
> 标签：java, algorithm, math, groovy

我想要一个可以进行以下计算并返回结果的函数。我不确定**e**在这个统计公式中是什么意思。我不知道如何将该公式转换为 java 代码...这就是问题...特别是 e 电源点 ....points 是一个变量，我将作为函数 arg 传入

![在此处输入图像描述](../Images/7989012b799bc87f59e517c49ccc87ae.png)

**这不是家庭作业。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T19:31:06.817

正如 Corbin 所说，你可以在 Java 中找到[你的常量](http://en.wikipedia.org/wiki/E_%28mathematical_constant%29)`java.lang.Math.E`为.

但是您可能想使用该`Math.exp(Double d)`方法。

你的计算是：

```
 ePoints = Math.exp(Points);
 finalScore = 1000 * (ePoints/(1 + ePoints)) - 10; 
```

您可以使用以下方法获得更好的精度，但溢出风险更高：

```
 ePoints = Math.exp(Points);
 finalScore = (1000 * ePoints)/(1 + ePoints) - 10; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:12:22.997

`e`是一个常数。它的值为`2.71828...`。

参见[e 数学常数](http://en.wikipedia.org/wiki/E_%28mathematical_constant%29)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T19:29:35.303

我不知道这是否是一个已知公式（也许一个科学软件包有它），但这似乎有效：

```
import static Math.pow

def finalScore(points) {
    def e = Math.E
    1000 * pow(e, points) / (1 + pow(e, points)) - 10
}

// lim when points -> 0 of finalScore(points) == 490
assert finalScore(0) == 490

// lim when points -> ∞ of finalScore(points) == 990
assert Math.abs(finalScore(50) - 990) < 0.001 
```

# java - 不使用instanceof的向下转换和多态？（爪哇）

> ID：10112275
> 
> 赞同：2
> 
> 时间：2012-04-11T19:04:23.123
> 
> 标签：java, polymorphism

这是我正在尝试做的事情：

```
class Foo {
    private ArrayList<Widget> things; //Contains WidgetA, WidgetB and WidgetAB objects
    //...
    void process(int wIndex) {
       process(things.get(wIndex);
    }

    private void process(WidgetA w) {
       //Do things
    }
    private void process(WidgetB w) {
       //Do other things
    }
    private void process(WidgetAB w) {
       //Do completely different things
    }
}

abstract class Widget {
    //...
}

class WidgetA extends Widget {
    //...
}
class WidgetB extends Widget {
}
class WidgetAB extends WidgetA {
} 
```

基本上，一个单独的类从用户输入中获取一个数组索引，并将其传递给 process(int) 方法，该方法应该启动一个特定于类型的 process() 方法来处理传递索引处的对象。问题是这些对象被视为 Widget 对象，而不是 WidgetA 等。我猜我可以使用 instanceof 遍历类型，但我试图避免使用它。process() 方法中的逻辑需要访问 Foo 类中的私有字段，因此将它们移动到 Widget 子类可能不是最好的主意。

所以问题是，有没有一种方法可以为给定的 Widget 子类型调用正确的 process() 方法，而不使用 instanceof？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:06:12.367

是的，看看访客模式 - 也称为双重调度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:35:50.740

另一个潜在的解决方案是使用 Java 的反射 API。例子：

```
class Foo {
    private ArrayList<Widget> things; //Contains WidgetA, WidgetB and WidgetAB objects
    //...
    void process(int wIndex) {
        Widget theWidget = things.get(wIndex);
        try {
            Class type = theWidget.getClass();
            Class[] arg_types = new Class[]{type};
            this.getMethod("process", arg_types).invoke(this, theWidget);
        } catch (Exception e) {
            //Could be SecurityException or NoSuchMethodException
        }
    }

    private void process(WidgetA w) {
       //Do things
    }
    private void process(WidgetB w) {
       //Do other things
    }
    private void process(WidgetAB w) {
       //Do completely different things
    }
}

abstract class Widget {
    //...
}

class WidgetA extends Widget {
    //...
}
class WidgetB extends Widget {
}
class WidgetAB extends WidgetA {
} 
```

这里的问题是您必须为列表`process()`中的每种类型的对象定义一个方法，`things`否则将在运行时引发异常。如果您缺少实现，编译器不会警告您。

# qt - 安装 Qt Quick Desktop 组件以在 Qt Designer 中使用

> ID：10112280
> 
> 赞同：3
> 
> 时间：2012-04-11T19:04:37.687
> 
> 标签：qt, qt-creator, qt-designer, qt-quick

我正在尝试使桌面 qt-components [http://qt.gitorious.org/qt-components/desktop](http://qt.gitorious.org/qt-components/desktop)在 Qt Designer 中工作。我试图让组件出现在“项目”列表下。

我使用`qmake && mingw32-make install`. 这也将所有组件文件复制到`\QtSDK\Desktop\Qt\4.8.1\mingw\imports\QtDesktop`.

我可以使用`import QtDesktop 0.1`. 以下代码正确编译、运行并显示一个按钮：

```
import QtQuick 1.1
import QtDesktop 0.1

Rectangle {
    width: 100
    height: 100
    Button {
        id: button
        text: "Push me"
        onClicked: button.text = "Pressed"
    }
} 
```

![运行示例](../Images/a5d620012d68c2edcf383df08665d094.png)

但是，当我单击“设计”进入 Qt 设计器时，它会尝试加载一段时间并且 Qt Creator 崩溃。我在 Windows 和 Fedora 上都试过了，结果相同。

我也尝试将组件文件夹移动到，`\QtSDK\Desktop\Qt\4.8.1\mingw\imports\Qt\labs\components`但这不起作用。

**更新：** 我已经尝试使用 qmlplugindump 根据这些指令生成 plugins.qmltypes 文件：http://doc.qt.nokia.com/qtcreator-2.4/creator-qml-modules-with-plugins.html[但](http://doc.qt.nokia.com/qtcreator-2.4/creator-qml-modules-with-plugins.html)仍然不成功. 为此，我必须更改`qt-components-desktop\src\src.pro`文件以在发布模式下构建，`CONFIG += release`否则 qmlplugindump 将引发错误。输出的 plugins.qmltypes 文件看起来不错，并且与 qmldir 文件位于同一文件夹中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T17:55:49.477

此问题已报告给 Qt 的错误数据库，预计将在 Qt Creator 版本 2.5.0 中修复[https://bugreports.qt.io/browse/QTCREATORBUG-7289](https://bugreports.qt.io/browse/QTCREATORBUG-7289)

# javascript - 在绘图应用程序上单击颜色时如何播放声音？

> ID：10112290
> 
> 赞同：0
> 
> 时间：2012-04-11T19:04:58.727
> 
> 标签：javascript, audio, drawing

我目前已经创建了一个简单的绘图应用程序，想知道是否有人可以帮助我编写代码，将特定的声音附加到颜色上，并且每次用户在画布上使用颜色进行绘图时，声音都会在绘图时播放。

谢谢！

这是我迄今为止用于绘图应用程序的 Javascript：

```
var started = false;
var canvas, context;
var stampId = '';
var lastColor = 'red';
var lastStampId = '';

function init() {
    canvas = $('#imageView').get(0);
    context = canvas.getContext('2d');

    // Auto-adjust canvas size to fit window.
    canvas.width  = window.innerWidth - 80 ;
    canvas.height = window.innerHeight - 80 ;

    //$('#container').get(0).addEventListener('mousemove', onMouseMove, false);
    canvas.addEventListener('click', onClick, false);
    canvas.addEventListener('mousedown', ev_canvas, false);
    canvas.addEventListener('mousemove', ev_canvas, false);
    canvas.addEventListener('mouseup',   ev_canvas, false);

    // Add events for toolbar buttons.
    $('#red').get(0).addEventListener('click', function(e) { onColorClick(e.target.id); }, false);
    $('#orange').get(0).addEventListener('click', function(e) { onColorClick(e.target.id); }, false);
    $('#yellow').get(0).addEventListener('click', function(e) { onColorClick(e.target.id); }, false);
    $('#green').get(0).addEventListener('click', function(e) { onColorClick(e.target.id); }, false);
    $('#blue').get(0).addEventListener('click', function(e) { onColorClick(e.target.id); }, false);
    $('#purple').get(0).addEventListener('click', function(e) { onColorClick(e.target.id); }, false);

    // Attach the mousedown, mousemove and mouseup event listeners.

  }

  // The pencil tool instance.
  tool = new tool_pencil();
  // This painting tool works like a drawing pencil which tracks the mouse 
  // movements.
  function tool_pencil () {
    var tool = this;
    this.started = false;

    // This is called when you start holding down the mouse button.
    // This starts the pencil drawing.
    this.mousedown = function (ev) {
        context.beginPath();
        context.moveTo(ev._x, ev._y);
        tool.started = true;
    };

    // This function is called every time you move the mouse. Obviously, it only 
    // draws if the tool.started state is set to true (when you are holding down 
    // the mouse button).
    this.mousemove = function (ev) {
      if (tool.started) {
        context.lineTo(ev._x, ev._y);
        context.stroke();
    context.lineJoin = "round";
    context.lineWidth = 5;
      }
    };

    // This is called when you release the mouse button.
    this.mouseup = function (ev) {
      if (tool.started) {
        tool.mousemove(ev);
        tool.started = false;
      }
    };
  }

  // The general-purpose event handler. This function just determines the mouse 
  // position relative to the canvas element.
  function ev_canvas (ev) {
    if (ev.layerX || ev.layerX ==0) { // Firefox
      ev._x = ev.layerX;
      ev._y = ev.layerY;
    } else if (ev.offsetX || ev.offsetX == 10 ) { // Opera
      ev._x = ev.offsetX;
      ev._y = ev.offsetY;
    }

    // Call the event handler of the tool.
    var func = tool[ev.type];
    if (func) {
      func(ev);
    }
  }

function onClick(e) {
    if (stampId.length > 0) {
        context.drawImage($(stampId).get(0), e.pageX - 90, e.pageY - 60, 80, 80);
    }
}

function onColorClick(color) {
    // Start a new path to begin drawing in a new color.
    context.closePath();
    context.beginPath();

    // Select the new color.
    context.strokeStyle = color;

    // Highlight selected color.
    var borderColor = 'white';
    if (color == 'white' || color == 'yellow') {
        borderColor = 'black';
    }

    $('#' + lastColor).css("border", "0px dashed white");
    $('#' + color).css("border", "1px dashed " + borderColor);

    // Store color so we can un-highlight it next time around.
    lastColor = color;
}

function onFill() {
    // Start a new path to begin drawing in a new color.
    context.closePath();
    context.beginPath();

    context.fillStyle = context.strokeStyle;
    context.fillRect(0, 0, canvas.width, canvas.height);
}

function onStamp(id) {
    // Update the stamp image.
    stampId = '#' + id;

    $(lastStampId).css("border", "0px dashed white");
    $(stampId).css("border", "1px dashed black");

    // Store stamp so we can un-highlight it next time around.
    lastStampId = stampId;  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:37:06.887

```
<audio id="snd_red" src="red.mp3"></audio>
<audio id="snd_blue" src="blue.mp3"></audio>
...

snd = null;
playing = false;

canvas.addEventListener('mousedown', function(){
    if (snd && !playing) {
        playing = true;
        snd.play();
    }
}, false);

canvas.addEventListener('mouseup', function(){
    if (snd && playing) {
        snd.stop();
        snd = null;
        playing = false;
    }
}, false);

function onColorClick(e, color){
    snd = document.getElementById("snd_" + color);
} 
```

您可以在 1 行中为所有颜色执行此操作：

```
$('#red,#blue,#green,...').bind('click', function(e) { onColorClick(e.target.id, $(this).attr("id")); }, false); 
```

但甚至可以：

```
$('.color').bind('click', function(e) { onColorClick(e.target.id, $(this).attr("id")); }, false); 
```

如果您可以为它们中的每一个添加 class="color" （但保持不变）

解决方案：

基本上我的回答有效，但你的代码有一些问题：

[http://neswork.com/javascript/sound-draw/1st/](http://neswork.com/javascript/sound-draw/1st/)（如你所愿：仅在溺水时发出声音）

[http://neswork.com/javascript/sound-draw/2nd/](http://neswork.com/javascript/sound-draw/2nd/)（我喜欢：声音总是）

# playn - Playn中的相机控制

> ID：10112293
> 
> 赞同：1
> 
> 时间：2012-04-11T19:05:09.390
> 
> 标签：playn

我曾在 Opengl 的 3d 图形应用程序中处理相机控件。但是我不得不说在playn中创建一个带有顶视图的相机，旋转和平移在我看来对于图层的概念来说真的很难。如果有人能给我们举个例子，那就太好了！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:23:41.547

我是新手，遇到了同样的问题。我在寻找答案时遇到了这个线程。我假设您正在寻找 3D 答案，我正在使用 2D。3D 解决方案可能类似，但我不知道图层在 3d 中是如何工作的，所以我可能是错的。无论如何，这就是我发现的。

问题是图层上的翻译是一次性完成的。这意味着任何旋转都是围绕原点完成的，因此如果要显示特定位置的旋转视图，则必须计算旋转后该位置的位置，然后将图层的平移设置为旋转位置。

我将此添加到展示项目中的豌豆演示中以进行测试。

```
private void setCameraLocation(Vec2 vec, float rot) {
vec = new Vec2(-vec.x/physUnitPerScreenUnit, -vec.y/physUnitPerScreenUnit);
Transform trany = new Transform();
trany.set(new Vec2((PlayN.graphics().width()/2f),(PlayN.graphics().height()/2f)), -rot);
vec = Transform.mul(trany, vec);
worldLayer.setRotation(-rot);
worldLayer.setTranslation(vec.x,vec.y);
} 
```

就像我说的，可能不是您要寻找的答案，但它可能会帮助其他人，或者至少为您指明一个方向。

# sql - 无法创建 Oracle APEX 应用程序错误 ORA-20001

> ID：10112294
> 
> 赞同：1
> 
> 时间：2012-04-11T19:05:14.420
> 
> 标签：sql, oracle, oracle10g, oracle-apex

我正在尝试使用 oracle 10g 创建一个图书馆系统（学校作业），但我在创建简单的 APEX 报告和表单时陷入困境，错误消息显示：

> ORA-20001: 无法创建模块。ORA-20001: 创建页面错误。ORA-20001: 无法创建表单页面。ORA-20001: Error page=8 item="P8_BRANCHID" id="" ORA-20001: Error page=8 item="P8_BRANCHID" id="" 与现有的应用程序级项目具有相同的名称。ORA-0000: 正常，成功完成
> 
> 无法创建应用程序。

这是我的模式，以防我做错了什么：

```
create table publisher(
PublisherName varchar2(30) not null,
Address varchar2(30) not null,
Phone number(20),
constraint publisher_pk primary key (PublisherName)
);

create table book(
BookId number(4) not null,
Title varchar2(50) not null,
PublisherName varchar2(30) not null,
constraint book_pk primary key (BookId),
constraint book_fk foreign key (PublisherName)
references publisher (PublisherName)
);

create table bookauthors(
BookId number(4) not null,
AuthorName varchar2(30) not null,
constraint bookauthors_pk primary key (BookId,AuthorName),
constraint bookauthors_fk foreign key (BookId) references book (BookId)
);

create table librarybranch(
BranchId number(4) not null,
BranchName varchar2(30) not null,
Address varchar2(30) not null,
constraint librarybranch_pk primary key (BranchId)
);

create table borrower(
CardNo number(4) not null,
BName varchar2(30) not null, 
Address varchar2(30) not null,
Phone number(20) not null,
constraint borrower_pk primary key (CardNo)
);

create table bookcopies(
BookId number(4) not null,
BranchId number(4) not null,
No_Of_Copies number(4) not null,
constraint bookcopies_pk primary key (BookId,BranchId),
constraint bookcopies_fk foreign key (BookId) references book (BookId),
constraint bookcopies2_fk foreign key (BranchId) references librarybranch (BranchId)
);

create table bookloans(
BookId number(4) not null,
BranchId number(4) not null,
CardNo number(4) not null,
DateOut date,
DueDate date,
constraint bookloans_pk primary key (BookId,BranchId,CardNo),
constraint bookloans_fk foreign key (BookId) references book (BookId),
constraint bookloans2_fk foreign key (BranchId) references librarybranch (BranchId),
constraint bookloans3_fk foreign key (CardNo) references borrower (CardNo)
); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:53:26.340

我认为您的架构没有任何问题；此错误 ORA-20001 是由 Apex 应用程序而非数据库引发的自定义应用程序错误。我会从表面上看消息：`...Error page=8 item="P8_BRANCHID" id="" has same name as existing application-level item`。您的第 8 页似乎有一个名为的页面项目`P8_BRANCHID`，但在应用程序项目中也可能定义了类似的项目。转到您的应用程序项目，看看您是否有一个名称相同的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-15T06:17:26.890

这是因为您尝试创建的页码已存在于 APEX 应用程序中。更改页码，它应该可以工作

# solr - Solr 对长度小于 4 的短词的模糊查询

> ID：10112295
> 
> 赞同：2
> 
> 时间：2012-04-11T19:05:18.750
> 
> 标签：solr, fuzzy-search, fuzzy-comparison

我正在尝试使用以下查询对名称字段进行模糊搜索。

当我运行查询时`q=(name:'smiht'~0.25) AND (name:'will'~0.25)` ，返回的记录的名称类似于`Will Smith`, `William D Hamilton DC`, `William I Smith JR`。

现在，当我在下面的查询末尾添加一个像“dc”这样的词时，它不会返回任何结果。我期待看到所有名称为“William D Hamilton DC”的记录。solr 模糊查询不适用于较短的单词吗？有人可以帮忙吗？

`q=(name:'smiht'~0.25) AND (name:'will'~0.25) AND (name:'dc'~0.25)`

字段名称的字段类型如下。

```
 <!-- USING Exact Text with Minimum filters-->  
    <fieldType name="text_exact" class="solr.TextField" omitNorms="false">
      <analyzer type="index">
          <tokenizer class="solr.StandardTokenizerFactory"/>
          <filter class="solr.StandardFilterFactory"/>
          <filter class="solr.LowerCaseFilterFactory"/>
        </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.StandardTokenizerFactory"/>
        <filter class="solr.StandardFilterFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
    </fieldType> 
```

# php - 检查函数是否存在

> ID：10112297
> 
> 赞同：1
> 
> 时间：2012-04-11T19:05:20.690
> 
> 标签：php

我在检查 ia 函数是否存在时遇到问题 - 我知道 function_exists() 和 method_exists() 但无法获得我正在寻找的功能

我通过像 $MM->Player->Play() 这样的套接字连接传递函数。之后我评估它们并通过套接字连接返回结果。

我确实过滤了函数（必须以 $MM 开头，其他任何内容都将被拒绝），但我无法让我的代码检查该函数是否存在。这很重要，因为如果该函数不存在，服务器将崩溃。

有谁知道这个的解决方案？？

提前致谢。

编码：

`$MM = new SDBApplication;`

在 SDBApplication 的构造函数中：

`$this->Player = new SDBPlayer;`

我尝试了以下方法来检查：代码：

`method_exists($MM, "Player::Play");` `function_exist("$MM->Player->Play);`

即使函数存在，两者都返回 false

**解决方案**

```
$parts = explode('->', $string);
$numParts = count($parts)-1;
$object = '$MM';
for($i=0; $i < $numParts; $i++){
    $object .= '->'.$parts[$i];
}
$parts[$numParts+1] = preg_replace('(\\(.*\\))', '', $parts[$numParts]);
eval( '$check = method_exists('.$object.', '.$parts[$numParts+1].');'); 
```

它需要被评估，因为输入是一个字符串。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T09:42:53.387

在您的构造函数中尝试这种方式`SDBApplication`

```
method_exists($this->Player, 'Play'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:10:53.330

[function_exists()](http://php.net/manual/en/function.function-exists.php)和[method_exists()](http://php.net/manual/en/function.method-exists.php)用于此类检查。第一个用于常规函数，第二个用于 OOP 函数。

# asp.net-mvc - 如何使用 WCF 数据服务保存具有相关实体集合的实体

> ID：10112300
> 
> 赞同：0
> 
> 时间：2012-04-11T19:05:31.823
> 
> 标签：asp.net-mvc, wcf-data-services, odata, savechanges

我有一个与新 InputOutputMap 相关的新 ParameterPart 实体。InputOutputMap 有几个我从数据库中提取的 InputStates，我需要与 InputOutputMap 关联。如何使用 MVC 和 WCF 数据服务将此链保存到数据库？我正在使用以下代码（通过 ajax 调用调用，上下文仅在构造函数的第一次调用中设置）但遇到了几个问题：

*   当我使用 AddLink（如下所示）时，我可以在第一次尝试时添加数据（无论我必须关联多少输入状态）。但是，如果再次调用该方法（通过 ajax），我只能在指定一个输入状态时添加数据。如果我有多个输入状态，我会得到上下文已经在跟踪关系。请注意，该方法是使用 ajax 调用来调用的。
*   我曾尝试使用 SetLink、AddRelatedObject 和 attach，但每次在上述情况下都会出错。有时，错误是上下文已经在跟踪实体或关系。在其他时候，上下文不跟踪实体。
*   当我在方法而不是构造函数中设置上下文时，我没有得到任何好处。

    ```
    if (vm != null)
        {
            ParameterPart parameterPart = null;

            // Create a new parameter
            if (vm.PartNumberId == 0)
            {
                // Create an instance of ParameterPart
                parameterPart = new ParameterPart()
                {
                    Description = vm.ParameterDescription                        
                };

                // Save the ParameterPart into the database
                try
                {
                    ctx.AddToParameterParts(parameterPart);
                    ctx.SaveChanges();
                }
                catch (System.Exception ex)
                {
                    throw;
                }
            }
            else
            {
                // Fetch the existing parameter
                parameterPart = new ParameterPart();
                parameterPart = (from pp in ctx.ParameterParts
                                 where pp.PartNumberId == vm.PartNumberId
                                 select pp).Single();

                // Update the ParameterPart from the vm
                parameterPart.Description = vm.ParameterDescription;
            }

            if (parameterPart != null)
            {
                if (vm.StateValues.Count > 0)
                {
                    InputOutputMap inputOutputMap = new InputOutputMap();
                    inputOutputMap.PartNumberId = parameterPart.PartNumberId;

                    ctx.AddToInputOutputMaps(inputOutputMap);

                    // Prepare a new InputOutputMap
                    foreach (var state in vm.StateValues)
                    {
                        if (state.InputStateId != 0)
                        {
                            // Fetch the inputstate
                            var inputState = (from i in ctx.InputStates
                                              where i.InputStateId == state.InputStateId
                                              select i).Single();

                            try
                            {
                                ctx.AddLink(inputOutputMap, "InputStates", inputState);
                                ctx.SaveChanges();
                            }
                            catch (System.Exception ex)
                            {
                                throw;
                            }
                        }                            
                    }
                }
            }
        } 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T20:09:19.387

AddLink 方法按预期工作。由于数据问题，我收到错误消息。

# sql - Sql Server - 在 where 子句中执行 RTRIM/LTRIM 的替代方法

> ID：10112301
> 
> 赞同：5
> 
> 时间：2012-04-11T19:05:40.650
> 
> 标签：sql, sql-server, performance, trim

我有一个列名，它是一个 varchar

我想过滤名称为空字符串的所有结果...

```
 select name 
 from tblNames
 where name <> '' 
```

我想做的是：

```
 select name 
 from tblNames
 where Ltrim(RTrim(name)) <> '' 
```

我想在 where 子句中对名称进行修剪，但我已经阅读了几篇文章，其中提到了 where 子句中函数的性能问题

我想在不影响性能的情况下解决这个问题

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-11T19:40:47.747

SQL-Server 中的标准行为是

```
'      ' = '' 
```

是`TRUE`，因为尾随空格被忽略。来自[MSDN 支持](http://support.microsoft.com/kb/316626)：

> SQL Server 遵循关于如何比较字符串和空格的 ANSI/ISO SQL-92 规范（第 8.2 节，一般规则 #3）。ANSI 标准要求对比较中使用的字符串进行填充，以便它们的长度在比较之前匹配。填充直接影响`WHERE`和`HAVING`子句谓词和其他 Transact-SQL 字符串比较的语义。例如，Transact-SQL 认为字符串**`'abc'`**和对于大多数比较操作**`'abc '`**是**等效的。**
> 
> 此规则的唯一例外是`LIKE`谓词。...

因此，您的条件`WHERE name <> ''`应该可以正常工作，并且不包括任何只有空格的字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T19:14:24.530

您可以做出一个约束，只允许修剪后的数据进入该字段。

你可以在`LTRIM(RTRIM(name))`. SQL 可能足够聪明来使用它。

您可以创建一个计算字段，即`LTRIM(RTRIM(name))`索引该字段，然后在查询中使用该字段。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-08T15:44:29.807

尽管

> `'abc' = 'abc '`

（等式右侧的字符串后有空格）是`TRUE`

> `'abc' = ' abc'`

（等式右侧的字符串前有空格）是`FALSE`.

因此，自动忽略的只是尾随空格（类似`RTRIM`但不类似`LTRIM`）。

# vba - 用于查找亵渎内容并创建出现列表的 Word 宏

> ID：10112302
> 
> 赞同：2
> 
> 时间：2012-04-11T19:06:02.150
> 
> 标签：vba, list, search, ms-word

我的电视剧本中偶尔会有亵渎，必须引起第三方的注意。我构建了一个宏来搜索特定的单词，暂时将它们变形，这样它们就不会再次被重复找到，并列出它们，以及它们在宏中出现的时间......问题：甚至没有运行它，我知道它会只找到单词的第一个实例...有时他们说同一个单词 20 次...我需要列出每个出现的时间和时间码。不替换或突出显示.. 仅列出单词。到目前为止我所拥有的......任何帮助表示赞赏。

```
 Sub Macro7()
'
' Macro7 Macro
'
'
    Selection.Find.ClearFormatting
    With Selection.Find
        .Text = "dog"
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute
    Selection.Copy

    ' places cursor inside the word so I can disfigure it

    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1

    ' xxx1 temporarily disfigures the word so it isn't re-found over and over

    Selection.TypeText Text:="xxx1"

    ' goes to end of document and pastes the word there,
    ' to be joined by the matching timecode to be found next

    Selection.EndKey Unit:=wdStory
    Selection.PasteAndFormat (wdPasteDefault)
    Selection.Find.ClearFormatting
    ' returns to last instance of word and finds time code
    ' immediately preceeding it

    With Selection.Find
        .Text = "xxx1"
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.Find.ClearFormatting
    With Selection.Find

        'this is finding the time code

        .Text = "^?^?:^?^?:^?^?:^?^?"
        .Replacement.Text = ""
        .Forward = False
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute

    ' copies the time code value and goes to bottom of document
    ' to paste it with the word previously found

    Selection.Copy
    Selection.EndKey Unit:=wdStory
    Selection.TypeText Text:=vbTab
    Selection.PasteAndFormat (wdPasteDefault)
    Selection.TypeParagraph
    Selection.Find.ClearFormatting

    ' returns to the word just found

    With Selection.Find
        .Text = "xxx1"
        .Forward = False
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1

    ' begins the process for the next word "cat"

     Selection.Find.ClearFormatting
    With Selection.Find
        .Text = "cat"
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute
    Selection.Copy

    ' places cursor inside the word so I can disfigure it
    ' etc etc etc

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T11:46:21.900

单词必须保留在文档中还是可以复制/粘贴到新的单词文档中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T20:27:12.743

如果将内容放入 Excel 中可能会更容易。例如，假设每个时间代码和相关文本位于 Sheet1 上 A 列的单个 CELL 中，以下宏将在 J 列中生成指定 TARGET 出现的所有时间代码的列表。可以扩展宏以查找其他目标并将这些相关时间码的列表输出到不同的列中。

```
Sub FindTarget()
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "=IF(ISERROR(IF(SEARCH(""TARGET"",RC[-2]),""TRUE"",""FALSE"")),"""",IF(SEARCH(""TARGET"",RC[-2]),""TRUE"",""FALSE""))"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""true"",LEFT(RC[-3],8),"""")"
    Range("C1:D1").Select
    Selection.AutoFill Destination:=Range("C1:D9999"), Type:=xlFillDefault
    Columns("D:D").Select
    Selection.Copy
    Columns("J:J").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
  ActiveWorkbook.Worksheets("Sheet1").Sort.SortFields.Add Key:=Range("J1"), _
        SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("Sheet1").Sort
        .SetRange Range("J1:J9999")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Columns("C:D").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    Range("K1").Select
End Sub 
```

# oop - OCaml 中对象内的对象

> ID：10112304
> 
> 赞同：5
> 
> 时间：2012-04-11T19:06:03.427
> 
> 标签：oop, object, ocaml

我试图弄清楚如何使用其他对象参数化 OCaml 对象。具体来说，我希望能够创建一个`link`包含前向`node`对象和后向对象的`node`对象，并且我希望能够通过说以下内容来创建链接：

```
let link1 = new link node_behind node_ahead;; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T19:40:44.153

对象是 OCaml 中的普通表达式，因此您可以将它们作为函数和类构造函数参数传递。如需更深入的解释，请查看 OCaml 手册中的[相关部分](http://caml.inria.fr/pub/docs/manual-ocaml/manual007.html)。

因此，例如，您可以编写：

```
class node (name : string) = object
  method name = name
end

class link (previous : node) (next : node) = object
  method previous = previous
  method next = next
end

let () =
  let n1 = new node "n1" in
  let n2 = new node "n2" in
  let l = new link n1 n2 in
  Printf.printf "'%s' -> '%s'\n" l#previous#name l#next#name 
```

# asp.net-mvc - 当客户可以修改数据库时，Entity Framework 有用吗？

> ID：10112316
> 
> 赞同：0
> 
> 时间：2012-04-11T19:06:39.343
> 
> 标签：asp.net-mvc, entity-framework, crud

我正在尝试为基于 ASP.Net MVC 的应用程序评估实体框架。我的公司向我们的客户提供了一个 SQL 数据库，我们为客户提供了更改此数据库的工具。他们添加自己的字段，修改现有字段（通常使它们更大），但他们不会删除我们提供的任何字段。他们也可以添加自己的表格。他们修改数据库和描述每个表/字段的元数据表以及每个字段的自定义验证信息。我们已经有了向数据库添加字段和填充元信息表的工具。例如，我们运送了一张名为“Patient”的表格。他们可以将自己的名为“LastVisitDate”的字段添加到此表中，然后他们在我们的 FieldDefinitions 表中使用元信息（例如 Label =“LastVisitDate”，

```
<fields>
    <Patient.LastName>
    <Patient.FirstName>
    <Patient.LastVisitDate> <!-- Added by customer -->
<fields> 
```

基本上，每次我们的应用程序启动时，我都无法确定表结构是什么（有数百个这样的表，但为了清楚起见，我将它们排除在外）。

这样的场景可以使用实体框架吗？我会很感激这方面的任何方向。我不愿意动态构建 sql 查询来实现 CRUD 操作，但我不清楚如何使用 EF 来实现这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:41:47.653

根据您的要求，我认为 EF 不会对您有好处。EF 节省开发人员时间的最大优势是它允许您编写强类型的 LINQ 查询并使用 EF 框架将它们转换为 SQL 查询。

就您而言，我认为没有简单的方法可以做到这一点。因此，在您的情况下使用 EF 没有任何好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:13:45.323

最大的问题是 EF 上下文要么生成类型（模型优先），要么针对您指定的类型（代码优先）工作。*如果您能以某种方式*成功地动态生成 ObjectContext/DbContext，那么这本身可能不是问题。问题是这会破坏你的代码库的其余部分。

在医疗环境或任何实体属性需要由用户自己不断更改的环境中看到[EAV 模型](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)并不少见。不知道你有没有考虑过这样的选择？请注意，这不是一个干净且简单的解决方案，但我认为它比您当前的解决方案更好（或更差），因为至少它不需要持续的模式更改。

如果架构中有不可变的部分（我希望有很多），那么您当然可以开始使用 EF。

# django - Django：如何将自定义字段序列化为夹具并将其加载回来

> ID：10112319
> 
> 赞同：3
> 
> 时间：2012-04-11T19:06:43.617
> 
> 标签：django, serialization, fixtures, custom-fields

我有一个带有 to_python 和 get_db_prep_value 方法的自定义字段，定义如下：

```
 def to_python(self, value):
    if not value:
      return None
    if isinstance(value, oauth2client.client.Credentials):
      return value
    return pickle.loads(base64.b64decode(value))

  def get_db_prep_value(self, value, connection, prepared=False):
    return base64.b64encode(pickle.dumps(value)) 
```

当我使用 dumpdata 转储此字段时，值显示为：

```
"<oauth2client.client.OAuth2Credentials object at XXXXXXXX" 
```

我应该如何处理自定义字段才能将其转储并正确加载？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:17:35.667

定义`value_to_string`字段的方法。[相关的 Django 文档。](https://docs.djangoproject.com/en/dev/howto/custom-model-fields/#converting-field-data-for-serialization)

# objective-c - UITableView滚动后UITextFields重叠

> ID：10112320
> 
> 赞同：2
> 
> 时间：2012-04-11T19:06:44.127
> 
> 标签：objective-c, ios, uitableview, uitextfield

我有一个带有 UITextFields 的 UITableView 来制作表单。它看起来很棒——除非你滚动新的 UITextFields 被放在旧的 UITextFields 之上......我不知道为什么！我知道当单元格被重用时（即dequeueReusableCellWithIdentifier 返回非零），单元格与现有的UITextField 一起返回。我找到了一个解决方案来保持标签的唯一性，最好删除任何以前的 UITextField。但我不想那样做。在提交此表单的最后，我想从文本字段中获取所有值（如果我删除它们就不能这样做）..

这是代码。任何帮助表示赞赏！

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = (UITableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil)
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];

cell.accessoryType = UITableViewCellAccessoryNone;

UITextField *playerTextField = [[UITextField alloc] initWithFrame:CGRectMake(155, 15, 130, 30)];
playerTextField.adjustsFontSizeToFitWidth = YES;
playerTextField.textColor = [UIColor blackColor];

if (indexPath.row == 0) {
    playerTextField.placeholder = @"Unique ID Sample";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyNext;
}

else if (indexPath.row == 1) {
    playerTextField.placeholder = @"Common Name";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if (indexPath.row == 2) {
    playerTextField.placeholder = @"Scientific Name";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 3) {
    playerTextField.placeholder = @"03/25/1992";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 4) {
    playerTextField.placeholder = @"Male";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
} 

else if ([indexPath row] == 5) {
    playerTextField.placeholder = @"03/01/2012";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 6) {
    playerTextField.placeholder = @"Huntington, WV";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 7) {
    playerTextField.placeholder = @"Huntington, WV";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 8) {
    playerTextField.placeholder = @"Marshall University";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
} 
else if ([indexPath row] == 9) {
    playerTextField.placeholder = @"Sub Straight";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 10) {
    playerTextField.placeholder = @"Any Light";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 11) {
    playerTextField.placeholder = @"Temperature";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 12) {
    playerTextField.placeholder = @"A Lot";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
} 

else if ([indexPath row] == 13) {
    playerTextField.placeholder = @"All Types";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 14) {
    playerTextField.placeholder = @"Schedule";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 15) {
    playerTextField.placeholder = @"MM/DD/YYYY";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 16) {
    playerTextField.placeholder = @"Ate Someone";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
} 

else if ([indexPath row] == 17) {
    playerTextField.placeholder = @"MM/DD/YYYY";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 18) {
    playerTextField.placeholder = @"The Morgue";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 19) {
    playerTextField.placeholder = @"MM/DD/YYYY";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}

else if ([indexPath row] == 20) {
    playerTextField.placeholder = @"MM/DD/YYYY";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
} 

else if ([indexPath row] == 21) {
    playerTextField.placeholder = @"To/ From";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyDone;
}    

playerTextField.backgroundColor = [UIColor whiteColor];
playerTextField.autocorrectionType = UITextAutocorrectionTypeNo; // no auto correction support
playerTextField.autocapitalizationType = UITextAutocapitalizationTypeNone; // no auto capitalization support
playerTextField.textAlignment = UITextAlignmentLeft;
playerTextField.tag = 0;

playerTextField.clearButtonMode = UITextFieldViewModeNever; // no clear 'x' button to the right
[playerTextField setEnabled: YES];

    [cell addSubview:playerTextField];

[playerTextField release];

cell.textLabel.text = [self.options objectAtIndex:indexPath.row];

return cell;    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:22:15.860

您将不得不创建一个自定义`UITableViewCell`. 这将允许您创建一个可以直接访问的`ivar`with a 。`UITextField`这样，当单元格出列并重用时，您只需在需要时进行设置。请务必`prepareForReuse:`在您的单元子类中覆盖并重置您添加的组件的所有属性。

另一件事可以帮助您解决上面的代码是使用 a`typedef enum`而不是使用整数来确定它是什么类型的单元格：

```
typedef enum{
    PlayerFieldId = 0,
    PlayerFieldName,
    PlayerFieldGender
} PlayerFields 
```

然后在您的自定义单元格中，您可以通过上面的枚举和 switch 语句设置单元格的类型：

```
switch(type){
case PlayerFieldId:
    playerTextField.placeholder = @"Unique ID Sample";
    playerTextField.keyboardType = UIKeyboardTypeDefault;
    playerTextField.returnKeyType = UIReturnKeyNext;
    break;
    /* other fields here */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-21T07:48:20.857

使用以下语句创建单元实例。

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

```
for (UITextView *txtView in cell.contentView.subviews)
{
    if ([txtView isKindOfClass:[UITextView class]])
    {
        [txtView removeFromSuperview];
    }
}

if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:simpleTableIdentifier];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:16:37.307

您可以继承 UITableViewCell 并让它有一个 UITextField 属性，您只需为每个单元格设置该属性，而不是在您不想删除它们时不断添加一个新属性。

# xml - 使用 Xslt 复制 XML 文档而不对 XML 进行任何更改

> ID：10112321
> 
> 赞同：0
> 
> 时间：2012-04-11T19:06:46.073
> 
> 标签：xml, xslt

我正在尝试将 XML 复制到相同的 XML

我正在使用以下 XSLT：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl"
>
  <xsl:output indent="yes" method="xml"/>

  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

如果输入 XML 是：

```
<CatalogRequest>
    <RequestFileHeader>
      <ClientCode>340000</ClientCode>
      <CreateTime>2012-04-11T14:57:03.357</CreateTime>
    </RequestFileHeader>
</CatalogRequest> 
```

我得到以下结果：

```
<?xml version="1.0" encoding="Windows-1252"?>
<ROOT>
<CatalogRequest>
    <RequestFileHeader>
      <ClientCode>340000</ClientCode>
      <CreateTime>2012-04-11T14:57:03.357</CreateTime>
    </RequestFileHeader>
</CatalogRequest>
</ROOT> 
```

关于如何在不`<ROOT>`添加节点的情况下保持相同 XML 的任何想法。

这被称为如下：

```
Dim Xct As New XslCompiledTransform 
Xct.Load(New XmlTextReader(New StreamReader(xsltFileName))) 
Dim xal As New XsltArgumentList 
Dim helper As New XsltHelper 
xal.AddExtensionObject("urn:XsltHelper", helper) 
Dim memStream As New MemoryStream 
Dim streamWriter As New StreamWriter(memStream, Text.Encoding.GetEncoding(1252))
Xct.Transform(doc, xal, streamWriter) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T01:03:18.017

我最好的猜测是您的调用代码会自动将您提供的 XML 与 ROOT 节点一起包装。

我的意思是你把它添加到你现有的 XSLT

```
<xsl:template match="ROOT">
    <xsl:apply-templates select="@* | node()"/>
</xsl:template> 
```

给你这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" version="1.0" exclude-result-prefixes="msxsl">
   <xsl:output indent="yes" method="xml" />
   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()" />
      </xsl:copy>
   </xsl:template>
   <xsl:template match="ROOT">
      <xsl:apply-templates select="@* | node()" />
   </xsl:template>
</xsl:stylesheet> 
```

我不保证这会奏效 - 这是一个猜测

# sql - 规范化或非规范化以在 RDBMS 中存储修订历史？

> ID：10112322
> 
> 赞同：2
> 
> 时间：2012-04-11T19:06:47.700
> 
> 标签：sql, database-design, schema, rdbms

我有一个基本的 CRUD 网络应用程序，人们可以在其中创建/编辑文章。我现在想添加保留所有编辑的修订历史的功能。目前，我有一个看起来像这样的文章表：

```
Article(id, title, content, author_id, category_id, format) 
```

我考虑了 2 个选项来更改我当前的模式以添加对修订历史的支持。基本思想是将任何文章的每一次编辑都存储为修订表中的记录。所以文章和修订是一对多的关系。

第一个选项（规范化）：一个表用于文章元数据，一个用于修订。没有存储重复数据。

```
Article(id, title, category_id)
Revision(id, content, author_id, format) 
```

第二个选项（非规范化）：两个表与选项 1 类似，但有一些重复的列。

```
Article(id, title, content, author_id, category_id, format)
Revision(id, article_id, content, author_id, format) 
```

我正在考虑使用第二个选项，因为它会使我的编码更容易（不太复杂，代码行更少）。我知道这不是“学术的”和“纯粹的”，但我个人的感觉是，必须进行额外的连接会损害代码维护。此外，性能应该会更好，因为不需要进行那么多的连接。

这是完成这项任务的好方法吗？我可能忽略了任何不可预见的或长期的后果？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T19:54:31.680

如果您关心您的数据，那么在“非规范化”的情况下，您最终不会得到更少的代码——您必须强制执行 in 中的最新行 `Revision`始终与 in 中的副本匹配`Article`。这在并发环境中实际上远非微不足道 - 您必须非常小心地进行锁定！

*（如果您选择`Revision`不`Article`包含相同的副本，那么情况会更糟——您将无法依赖 DBMS 来强制执行`Revision`主键！）*

有了足够强大的 DBMS，您就可以吃到自己的蛋糕——例如，Oracle 物化视图可以为您“预先加入”数据，而无需对实际数据模型进行非规范化处理。

即使您没有这样的 DBMS，也只有在**测量**了实际数据量的性能后才考虑进行非规范化。是的，JOINS 可能很昂贵，但是在您的特定情况下它们是否太贵了*？*只有测量才能告诉我们。

* * *

顺便说一句，考虑使用这样的识别关系/自然键：

![在此处输入图像描述](../Images/885991ab62bf1dfec4b4b6b537b86f53.png)

`revision_no`当您在给定文章下添加修订时，该值会单调增长。

PK下的 B-Tree 结构`Revision`使得查找给定文章的最新（或任何！）修订版变得非常高效。除非您的问题中未显示备用键，否则您还可以对和（在 Oracle 下）进行[聚类](http://use-the-index-luke.com/sql/clustering/index-organized-clustered-index)`Revision`，甚至压缩聚类索引的前沿，因此重复的空间开销`article_id`被取消。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-11T19:14:30.950

性能论点是无稽之谈-您做`JOIN`的 s 少，但 RDBMS 已针对`JOIN`s 进行了优化。

但是，您可能会从服务器中提取**比**必要更多的数据，这是无法优化的。

您还可能存在**一致性**问题。在不同表中复制同一项目的数据会导致出现不一致的情况。如果修订记录和文章记录的`format`or值不同`author`怎么办？你怎么知道哪个是正确的？如果`content`in`Articles`与任何修订不匹配怎么办？

你真的应该把它标准化。我会`CurrentRevision`在您的表格中添加一个字段以`Articles`链接到当前版本，并且您应该`ArticleID`在`Revisions`表格中有一个字段将两者链接在一起。

# opengl - 在 OpenGL 中渲染时，三角形似乎在战斗/跳跃

> ID：10112325
> 
> 赞同：0
> 
> 时间：2012-04-11T19:07:08.217
> 
> 标签：opengl

在 OpenGL 中渲染 3d 模型时遇到问题。我能够渲染它，但是当它渲染时，三角形看起来像是在争先恐后地占据上风。我不确定为什么会发生这种情况。这是我正在谈论的视频：[Jittery Triangles。](http://youtu.be/cgB-hdx0VvA)我在这个视频中使用了即时模式，但它使用 VBO 做同样的事情。

*编辑：谢谢蒂姆！由于某种原因，我将近平面设置为 0.00001 并将其更改为 0.1 解决了问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:22:24.757

这被称为 z-fighting，当 z-buffer 中的精度丢失时会发生这种情况。常见的原因有：

1.  离相机很远的物体
2.  物体非常靠近或在完全相同的位置
3.  一个很远的剪裁平面
4.  矩阵数学不准确

我会说＃3是您问题的最可能原因。您必须始终注意浮点错误！

#4 是另一个可能的问题，但它通常只有在相机转换距离原点很远的情况下才会出现，并且可以通过使用双精度矩阵并将它们转换为浮点数来解决，然后再将它们传递给 gpu。

这是一篇关于[投影矩阵 Z 缓冲区数学](http://www.songho.ca/opengl/gl_projectionmatrix.html)的好文章。

# javascript - jquery：如何将表单元素信息传递给另一个函数？

> ID：10112333
> 
> 赞同：2
> 
> 时间：2012-04-11T19:07:47.953
> 
> 标签：javascript, jquery, forms, function

我正在尝试在表单元素模糊上做一些事情。我遇到的问题是将元素的信息（例如 ID、类等）传递给第二个函数。我已经为这个例子简化了它：

```
function otherfunction() {
    var inputID = $(this).attr("id");
    alert(inputID);
}

$(".formelement").blur(function () { 

// Do some stuff here

otherfunction();

}); 
```

当然，警告框说 inputID 是未定义的。如何将元素的信息传递给 otherfunction？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:09:55.990

将输入作为参数传递：

```
function otherfunction(el) {
    var inputID = $(el).attr("id");
    alert(inputID);
}

$(".formelement").blur(function () {
    // Do some stuff here

    otherfunction(this);
}); 
```

或者，使用`Function.prototype.apply`：

```
function otherfunction() {
    var inputID = $(this).attr("id");
    alert(inputID);
}

$(".formelement").blur(function () {
    // Do some stuff here

    otherfunction.apply(this);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:11:40.173

在以下情况下使用[$.proxy](http://api.jquery.com/jQuery.proxy/)：

```
$(".formelement").blur($.proxy(otherfunction, this)); 
```

否则 javascript 的[调用](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)或[应用](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)：

```
$(".formelement").blur(function () { 

    // Do some stuff here

    otherfunction.call(this); // or otherfunction.apply(this); 
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:15:10.983

我想你可以这样使用：

```
function otherfunction(obj) {
    var inputID = $(obj).attr("id");
    alert(inputID); }

$(".formelement").blur(function () { 

otherfunction($(this));

}); 
```

# android - 使用带有问号 (?) 参数的 sqldb rawQuery

> ID：10112335
> 
> 赞同：2
> 
> 时间：2012-04-11T19:07:59.527
> 
> 标签：android, sqlite

我正在尝试使用 ?s 作为构建查询的参数，但它显然有问题。希望文档至少提供一个示例...

```
SQLDb.rawQuery("SELECT C.?, B.?, B.?, B.? FROM ? C, ? B  WHERE C.? = B.?", new String[] 
               {Tables.CATEGORIES_NAME, Tables.BUDGET_DATE, Tables.BUDGET_VALUE, Tables.KIND, Tables.CATEGORIES, Tables.BUDGET, Tables.CATEGORIES, Tables.TABLE_ID, Tables.TABLE_ID}); 
```

这些 const 都是字符串，只是列的名称。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T19:59:45.063

`?`不能用于 SQL 查询的任意部分。它可用于 、 等中的值`WHERE`，`ORDER BY`但不能用于`WHERE`子句左侧的数据库名称、表名称、列名称等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:07:23.137

`?`不要在查询中使用，而是使用`String.format`with在查询`%s`中填写表名和列名。

# python - 如何检查平衡分隔符的语言

> ID：10112339
> 
> 赞同：-2
> 
> 时间：2012-04-11T19:08:24.217
> 
> 标签：python

我想使用 Python 检测字符串中的分隔符。经过一番搜索，我知道我需要导入/使用 csv 模块，但它适用于逗号分隔的文件或单词。如何更改它以检测任何自定义分隔符？需要一些帮助。我附上了下面的问题。

我的家庭作业的问题是：

> 编写一个函数来确定文本是否具有平衡的分隔符。有效分隔符对是 ()、[]、{} 和 <>。它们可能是嵌套的。此外，确定文本分隔符 ' 和 " 正确匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:57:37.583

`csv`不会帮助你。

这个问题要求您创建一个可以检测平衡定界符的函数 - 即对于每个开始定界符，都有一个相应的结束定界符。

这是一个经典问题，因为它可以用上下文无关文法来指定，它相当于一个状态机，其边对应于下一个输入，节点指定堆栈上的操作。

`list`和类构成了出色的`deque`堆栈。

您的代码应如下所示：

```
def balancedq(input):
    stack = []

    for char in input:
        #implement your logic here.
        if sometest:
           stack.append(char) #push
        elif someothertest:
           val = stack.pop()
           #maybe some test here? 
```

# grails - jboss 似乎加载了我的战争文件，但给出了 404 页面，我该如何解决这个问题？

> ID：10112342
> 
> 赞同：1
> 
> 时间：2012-04-11T19:08:39.537
> 
> 标签：grails, jboss, war

我正在尝试评估是否可以升级到 jboss 7.1.1 我创建了我的 grails 应用程序的 war 文件：

```
grails war 
```

然后我将战争文件放在 jboss 独立部署目录中。由于我在输出中看到，它似乎被服务器拾取：

```
11:43:19,026 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS018559: Deployed "my-application-0.1.war"
11:43:19,483 INFO  [org.jboss.osgi.framework.internal.HostBundleState] (MSC service thread 1-4) Bundle started: my-application:0.1.0 
```

但是，当我尝试访问 127.0.0.1/my-application 时，我收到 404 错误消息。关于发生了什么或如何调试此问题的任何想法？

更新：我刚刚在 jboss 日志中注意到了这个错误：

```
12:33:48,499 ERROR [org.jboss.as] (MSC service thread 1-2) JBAS015875: JBoss AS 7.1.1.Final "Brontes" started (with errors) in 4214ms - Started 151 of 227 services (1 services failed or missing dependencies, 74 services are passive or on-demand) 
```

我发现[另一个关于 grails 应用程序的 stackoverflow 问题没有与 jboss 一起运行，](https://stackoverflow.com/questions/9203092/grails-1-3-7-not-starting-with-jboss-7-1)这与我面临的问题非常相似。我尝试了建议的解决方案并编辑了standalone.xml 文件。现在我面临一条实际的错误消息，在浏览器中我仍然收到 404 消息。这是来自 JBoss 日志的错误：

```
12:59:13,749 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-2)JBAS015876: Starting deployment of "my-application-0.1.war"
12:59:16,530 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-2) MSC00001: Failed to start service jboss.deployment.unit."my-application-0.1.war".PARSE: org.jboss.msc.service.StartException in service jboss.deployment.unit."my-application-0.1.war".PARSE: Failed to process phase PARSE of deployment "my-application-0.1.war"
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:119) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [rt.jar:1.6.0_23]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [rt.jar:1.6.0_23]
    at java.lang.Thread.run(Thread.java:679) [rt.jar:1.6.0_23]
Caused by: org.jboss.as.server.deployment.DeploymentUnitProcessingException: JBAS018014: Failed to parse XML descriptor "/content/my-application-0.1.war/WEB-INF/jboss-web.xml" at [3,2]
    at org.jboss.as.web.deployment.JBossWebParsingDeploymentProcessor.deploy(JBossWebParsingDeploymentProcessor.java:77)
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
    ... 5 more
Caused by: javax.xml.stream.XMLStreamException: ParseError at [row,col]:[3,2]
Message: Unexpected element 'class-loading' encountered
    at org.jboss.metadata.parser.util.MetaDataElementParser.unexpectedElement(MetaDataElementParser.java:108)
    at org.jboss.metadata.parser.jbossweb.JBossWebMetaDataParser.parse(JBossWebMetaDataParser.java:211)
    at org.jboss.as.web.deployment.JBossWebParsingDeploymentProcessor.deploy(JBossWebParsingDeploymentProcessor.java:69)
    ... 6 more 12:59:16,541 INFO  [org.jboss.as] (MSC service thread 1-1) JBAS015951: Admin console listening on http://127.0.0.1:9990 12:59:16,541 ERROR [org.jboss.as] (MSC service thread 1-1) JBAS015875: JBoss AS 7.1.1.Final "Brontes" started (with errors) in 5009ms - Started 135 of 179 services (1 services failed or missing dependencies, 42 services are passive or on-demand) 12:59:16,542 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS015870: Deploy of deployment "my-application-0.1.war" was rolled back with failure message {"JBAS014671: Failed services" => {"jboss.deployment.unit.\"my-application-0.1.war\".PARSE" => "org.jboss.msc.service.StartException in service jboss.deployment.unit.\"my-application-0.1.war\".PARSE: Failed to process phase PARSE of deployment \"my-application-0.1.war\""}} 12:59:16,819 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015877: Stopped deployment my-application-0.1.war in 276ms
12:59:16,820 INFO  [org.jboss.as.controller] (DeploymentScanner-threads - 2) JBAS014774: Service status report JBAS014777:   Services which failed to start:      service jboss.deployment.unit."my-application-0.1.war".PARSE: org.jboss.msc.service.StartException in service jboss.deployment.unit."my-application-0.1.war".PARSE: Failed to process phase PARSE of deployment "my-application-0.1.war"
12:59:16,821 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {"JBAS014653: Composite operation failed and was rolled back. Steps that failed:" => {"Operation step-2" => {"JBAS014671: Failed services" => {"jboss.deployment.unit.\"my-application-0.1.war\".PARSE" => "org.jboss.msc.service.StartException in service jboss.deployment.unit.\"my-application-0.1.war\".PARSE: Failed to process phase PARSE of deployment \"my-application-0.1.war\""}}}} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T23:39:12.880

您在 JBoss AS 7 中使用旧的 jboss-web.xml（具有不同的模式）。旧模式有一个名为“class-loading”的元素，这在 JBoss AS 7 中不可用。请参阅模式的 [1]正确的格式。

```
[1] https://community.jboss.org/wiki/JBossDTDs 
```

# c# - 使用 Microsoft.Office.Tools.Word C# 在 word 中添加表格

> ID：10112346
> 
> 赞同：0
> 
> 时间：2012-04-11T19:08:57.487
> 
> 标签：c#

我在 VS2010 中有这个 Word 2010 Office 项目

有人可以指出正确的方向以了解如何动态添加表格吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:48:29.943

试试[MSDN 上的这篇文章](http://msdn.microsoft.com/en-us/library/w1702h4a.aspx)。

*从文章*

```
object start = 0;
object end = 0;
Word.Range tableLocation = this.Range(ref start, ref end);
this.Tables.Add(tableLocation, 3, 4); 
```

# linear-algebra - 试图在 cplex 中读取二次程序，得到错误

> ID：10112348
> 
> 赞同：1
> 
> 时间：2012-04-11T19:09:05.773
> 
> 标签：linear-algebra, linear-programming, cplex

我正在尝试使用“读取”命令将 CPLEX LP 文件加载到 CPLEX。我相信在这个问题中，我有一组二次约束。但是，据我了解，CPLEX 仍将尝试解决二次规划问题。

但是，当我尝试将其读入时，出现此错误：

```
CPLEX Error  1437: Line 284: Illegal quadratic constraint sense. 
```

在阅读二次规划问题时，我需要做些什么特别的事情吗？

注意：我可以将此 LP 文件加载到 scip 并使用以下方法解决它：scip -f

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:24:46.773

二次约束必须是凸的。您只能从上方约束凸函数或从下方约束凹函数。二次等式约束永远不是凸的。那很可能是你的问题。

# html - div中列表的一部分

> ID：10112349
> 
> 赞同：0
> 
> 时间：2012-04-11T19:09:15.620
> 
> 标签：html, css

假设我有一个清单：

```
<ul>
   <li>
     Animals
     <ul>
       <li>tiger</li>
       <li>lion</li>
       <li>cow</li>
     </ul>
   </li>
   <li>
     Birds
     <ul>
       <li>owl</li>
       <li>parrot</li>
     </ul>
   </li>
   <li>
     Flowers
     <ul>
       <li>rose</li>
       <li>lily</li>
    </ul>
   </li>
</ul> 
```

我需要改变动物和鸟类的背景，让它看起来像实心的一块。我试着像这样把它放到 div 中：

```
<ul>
   <div id='foo'>
   <li>
     Animals
     <ul>
       <li>tiger</li>
       <li>lion</li>
       <li>cow</li>
     </ul>
   </li>
   <li>
     Birds
     <ul>
       <li>owl</li>
       <li>parrot</li>
     </ul>
   </li>
   </div>
   <li>
     Flowers
     <ul>
       <li>rose</li>
       <li>lily</li>
    </ul>
   </li>
</ul> 
```

但它没有用。我想把它做成实心矩形。任何反馈表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:14:04.620

尝试这个

```
<ul>
   <li class="animal>
     Animals
     <ul">
       <li>tiger</li>
       <li>lion</li>
       <li>cow</li>
     </ul>
   </li>
   <li class="animal>
     Birds
     <ul>
       <li>owl</li>
       <li>parrot</li>
     </ul>
   </li>
   <li>
     Flowers
     <ul>
       <li>rose</li>
       <li>lily</li>
    </ul>
   </li>
</ul> 
```

CSS：为它们设置一个宽度，所以它们的宽度都是一样的

```
.animal 
{
   width:200px;
   background-color:green;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:12:24.757

使用 CCS 类样式并将它们应用于您的`<li>`元素。在列表中放置其他类型的元素不是有效的 HTML。

CSS：

```
.mystyle {
    /* Whatever */
} 
```

标记：

```
<li class="mystyle"></li> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T14:08:26.887

我改变了我放在一里下的鸟类和动物列表，我应用了样式。

谢谢大家指点我那里！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T19:13:13.683

您不能`div`在 UL 中使用元素，但可以通过 2 种方式来实现：

1）手动将css类设置为鸟和动物：

```
<ul>
   <li class='someBackground'>
     Animals
     <ul>
       <li>tiger</li>
       <li>lion</li>
       <li>cow</li>
     </ul>
   </li>
   <li class='someBackground'>
     Birds
     <ul>
       <li>owl</li>
       <li>parrot</li>
     </ul>
   </li>
   <li>
     Flowers
     <ul>
       <li>rose</li>
       <li>lily</li>
    </ul>
   </li>
</ul> 
```

2) 使用 CSS3 选择器：

```
ul li:nth-child(1),ul li:nth-child(2) {
    //your css code
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T19:14:11.723

```
<ul>
   <li id="animals">
     Animals
     <ul>
       <li>tiger</li>
       <li>lion</li>
       <li>cow</li>
     </ul>
   </li>
   <li id="birds">
     Birds
     <ul>
       <li>owl</li>
       <li>parrot</li>
     </ul>
   </li>
   <li>
     Flowers
     <ul>
       <li>rose</li>
       <li>lily</li>
    </ul>
   </li>
</ul> 
```

CSS：

```
#animals, #birds {
background:green;
} 
```

# php - 用 PHP 修改 URL

> ID：10112350
> 
> 赞同：2
> 
> 时间：2012-04-11T19:09:19.393
> 
> 标签：php, checkbox

如何使用 PHP 向 URL 添加参数。在javascript中我使用类似的东西

```
document.URL = "?param1=sth". 
```

我有一个文章白复选框列表，其值等于文章 ID（来自数据库），当用户选中 1 个复选框时，我想将他重定向到`http://blablabla.com/edit?article_name=1(article id);`

```
$checkbox = "<input type=\"checkbox\" name=\"article[]\" value=\"{$article["id"]}\"/>"; 
```

`$checkbox`根据数据库中的文章数量自动生成。

```
if(isset($_POST['edit']) AND isset($_POST['article'])){
    $articol = $_POST['article'];
    if (is_array($articol)) { 
            $contor = 0;
                foreach ($articol as $item) {
                    if(isset($item))
                        $contor ++;
                }
                if($contor == 1 ){
                **redirect user to edit.php?article_name=1;**
                }else {
                echo "<script type='text/javascript'>";
                echo "alert(\"You can't edit more than 1 article!\")";
                echo "</script>";   
                }

            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:15:06.680

您可以使用[`header`](http://php.net/manual/en/function.header.php)，但必须确保之前不要发送任何输出，或者使用输出缓冲。此外，调用实际上并不会结束脚本，因此如果您想停在那里`header`，使用 an 是一件好事。`exit`

```
header('Location: edit.php?article_name=1');
exit; 
```

# php - 在数据库中保存数据点坐标

> ID：10112351
> 
> 赞同：0
> 
> 时间：2012-04-11T19:09:28.417
> 
> 标签：php, database

您会将每个点 (x/y) 保存为一个条目，还是将数据点列表转储到 varchar 中？我无法决定什么是最好的，最终我需要将数据取出来绘制它，如果它是每个条目的一个点，我可以在返回数据时执行 group_concat，而如果它在一个大的 varchar 中，我可以爆炸它在服务器上的 php 中。

我敢肯定，只要经验很少，这可能很明显，但是我在这方面没有经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:26:50.567

如果您要处理它们，例如，如果它的地理数据并且您想找到最近的点，那么显然是的，保存为单独的值。如果它的数据库[像 mongo](http://www.mongodb.org/display/DOCS/Geospatial+Indexing)那样支持快速处理，那肯定是。

# c++ - 不同类型的复合模式重用

> ID：10112359
> 
> 赞同：2
> 
> 时间：2012-04-11T19:10:09.947
> 
> 标签：c++, inheritance, design-patterns, composite

扩展一个海军模拟项目，我希望添加复合模式，以便我可以拥有对象组。这是当前层次结构的样子：

```
class Sim_object {
};

class Ship : public Sim_object {
};

class Island : public Sim_object {
}; 
```

到目前为止，我想出了：

```
class Sim_object {
  // holds general sim functions
  get_name()
};

// COMPONENT
class Ship_object : public Sim_object {
  // holds ship functions
  add()
  remove()
  attack()
  move()
};

// COMPOSITE
class Group : public Ship_object {
   // holds list of group ship functions
   add()
   remove()
   attack()
   move()
};

// LEAF
class Ship : public Ship_object {
   // holds ship functions
   attack()
   move()
};

class Island : public Sim_object {
  // holds island functions
}; 
```

我有它的工作，但它只适用于船舶和船舶组。我想重用组代码（添加、删除、显示等），这样一个具体的组类（如 Island_group）就可以从中继承并使用它。我尝试更改 Ship_group 类从名为 Group 的公共基类继承的设计，但我遇到了一个菱形程序。

有什么办法可以根据类型重用我的组控制代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:56:54.823

复合，为了使用不止一种类型`Sim_object`，应该继承和组合`Sim_objects`：

```
class Sim_object { };
class Ship : public Sim_object { };
class Island : public Sim_object { }; 
class Group : public Sim_object { 
  add()
  remove()
}; 
```

要将其定制为特定类型，您可以对其进行模板化，并（可能）从中派生其他组：

```
template <class T>
class Group : public Sim_object {
  add()
  remove()
};

class Ship_Group : public Group<Ship> {
  attack()
  move()
};

class Island_Group : public Group<Island> { } // possibly unnecessary 
```

现在，要拥有您的`Ship_Group`替代品`Ship`，您可以为它创建一个“接口”（纯虚拟类）并从中`Ship`继承。`Ship_Group`您还将使用新界面而不是`Ship`客户端代码中的具体界面：

```
class Ship_Like { // interface
  attack() = 0
  move() = 0
};
class Ship : public Sim_object, public Ship_Like { }; // concrete
class Ship_Group : public Group<Ship>, public Ship_Like { 
  attack()
  move()
} 
```

不用担心那里的钻石问题...

# c# - 当我尝试从我的服务中删除时找不到 404

> ID：10112363
> 
> 赞同：0
> 
> 时间：2012-04-11T19:10:33.790
> 
> 标签：c#, wcf, web-services, rest

当我尝试从我的服务中删除时，我得到一个 404 未找到，在客户端我使用这个：

在我的服务方面，我使用这个：

```
 [OperationContract]
    [WebInvoke(Method = "DELETE", BodyStyle = WebMessageBodyStyle.Bare, RequestFormat = WebMessageFormat.Xml, ResponseFormat = WebMessageFormat.Xml, UriTemplate = "/Student")]
    void removeStudent(Student studentID);

    List<Student> students = new List<Student>();
    public void removeStudent(Student studentID)
    {
        students.Remove(students.Find(f => f.StudentID.Equals(studentID)));
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:27:16.277

默认情况下不启用 DELETE Http Verb。阅读[如何](http://www.iis.net/ConfigReference/system.webServer/security/requestFiltering/verbs/add)解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:33:33.250

根据我在上面看到的内容，您正在将一些文本传递给客户端的 URL，但期待一个看起来不正确的 Student 对象。

我认为约定是 DELETE 应该具有与 GET 相同的 URI 模板。

```
 [WebInvoke(Method = "DELETE", BodyStyle = WebMessageBodyStyle.Bare, RequestFormat = WebMessageFormat.Xml, ResponseFormat = WebMessageFormat.Xml, UriTemplate = "/{studentID}")]
    void removeStudent(string studentID); 
```

或者

```
void removeStudent(int studentID); 
```

# html - 如何让文本始终留在 td 的左上角？

> ID：10112365
> 
> 赞同：3
> 
> 时间：2012-04-11T19:10:49.127
> 
> 标签：html, css, html-table, internet-explorer-8

如果第二个 div/span 中的文本足够长，那么第一个 div/span 会停留在上角。但如果第二个 div/span 中没有任何内容，则第一个 div/span 位于 td 的中间。

我正在使用 IE 8。

日历的 HTML 片段

```
<table id="calendar">
    <thead>
        <tr><th>April</th></tr>
        <tr>
            <th>Sun</th>
            <th>Mon</th>
            <th>Tues</th>
            <th>Wed</th>
            <th>Thur</th>
            <th>Fri</th>
            <th>Sat</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                <div>
                    <span>1</span>
                </div>
                <div>
                    <span></span>
                </div>
            </td>
            <td>
                <div>
                    <span>2</span>
                </div>
                <div>
                    <span></span>
                </div>
            </td>
            <td>
                <div>
                    <span>3</span>
                </div>
                <div>
                    <span></span>
                </div>
            </td>
            <td>
                <div>
                    <span>4</span>
                </div>
                <div>
                    <span></span>
                </div>
            </td>
            <td>
                <div>
                    <span>5</span>
                </div>
                <div>
                    <span></span>
                </div>
            </td>
            <td>
                <div>
                    <span>6</span>
                </div>
                <div>
                    <span></span>
                </div>
            </td>
            <td>
                <div>
                    <span>7</span>
                </div>
                <div>
                    <span></span>
                </div>
            </td>
        </tr>
    </tbody>
</table> 
```

日历的 CSS

```
#calendar {
    border:2px solid black;
    height:100%;
    width:100%;
}

#calendar td {
    border:2px solid black;
}

#calendar td > div:first-child {
    text-align:left; 
    left: 0; 
    top: 0;
}

#calendar td > div:first-child > span{
    text-align:left; 
    left: 0; 
    top: 0;
}

#calendar td > div + div {
    clear:both;
    text-align:center;    
    font-weight:bold;
    white-space:normal;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T19:19:31.003

`vertical-align:top`会成功的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:04:23.690

试试这个

```
div {
    height: 14px;
    margin-top: -4px;
} 
```

# c# - P-Linq 可以在委托执行期间切换线程吗？

> ID：10112371
> 
> 赞同：2
> 
> 时间：2012-04-11T19:11:02.067
> 
> 标签：c#, multithreading, plinq

委托执行期间的上下文切换是否可以切换执行线程？

我在 LinqPad 中尝试了这个片段几次，但它没有上`new Exception()`线，这似乎表明它将在原始线程上继续，但也许我这里的小测试不足以测试这个，我只是不确定。

```
void Main()
{
    var list = Enumerable.Range(1,100000);
    list.AsParallel().ForAll( i=>
    {
        var threadId = System.Threading.Thread.CurrentThread.ManagedThreadId;
        System.Threading.Thread.Sleep(0); // allow a context switch
        work(i,threadId); 
    });
    "Complete".Dump();
}

void work(int num,int threadId)
{
    var currentId = System.Threading.Thread.CurrentThread.ManagedThreadId;
    if(threadId!=currentId)
    {
        throw new Exception();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:14:37.207

当一个任务被调度时，它将永远永远使用分配给它的第一个线程。该线程可能会停止运行并让另一个线程（来自线程池或不来自线程池）做一些工作，并且整个进程可能会停止以让另一个进程做一些工作，但无论如何你总是会回到线程中你开始了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:19:34.723

不——相同的方法不能在一个线程中开始执行并在另一个线程中结束。想想看——每个线程都有自己的堆栈，如果可能的话，每个上下文切换都会复制堆栈。

在您的示例中，上下文切换时间片将提供给另一个线程，但它将执行另一个代码。另一个代码可能在同一个方法中，但调用堆栈会是其他的，`threadiId`也会是其他的。

所以你永远不会看到你的例外。

# unix - 纯 AppleScript 和 Unix，结果不同

> ID：10112373
> 
> 赞同：0
> 
> 时间：2012-04-11T19:11:22.870
> 
> 标签：unix, applescript

提前感谢您的意见。我对以下 AppleScript 有疑问。我两次运行相同的命令并得到两个不同的响应。第一个是 unix 命令（grep），第二个是纯 AppleScript。我正在尝试在 teX 文档中找到一个字符串，即 \begin{document} 。然后我想用 AppleScript 在这个字符串之前添加一个 \usepackage{whatever} 。我有一个 python 脚本可以做我想要的，除了我不能将活动窗口的文件位置从 TeXShop 传递给 python，只有 AppleScript。

问题：为什么unix版本与纯AppleScript版本不同？请记住 \begin{document} 肯定在我正在检查的文档中。纯版本可以正常工作。

```
tell application "TeXShop"
    -- get the front document and save
    set thisDoc to the front document
    -- get the filename and cursor position of the document
    get path of thisDoc
    set filePath to result
    --set insPoint to offset of selection of thisDoc
end tell
set searchResult to do shell script "grep -q \\begin{document}" & filePath & "; echo $?" --echo 0 on match found/success and 1 on not found
if searchResult = "0" then
    display dialog "string found"
else
    display dialog "string not found"
end if
set findThis to "\\begin{document}"
set theFileContent to read filePath
if result contains findThis then
    display dialog "string found"
else
    display dialog "string not found"
end if 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:21:53.543

shell 解释特殊字符，在这种情况下包括反斜杠和大括号；并且`grep`AppleScript 本身也解释反斜杠。

```
set searchResult to do shell script "grep -q '\\\\begin{document}'" & filePath & "; echo $?" 
```

单引号保护大括号，防止shell解析反斜杠；您需要 4 个反斜杠，因为 AppleScript 会吃掉一个（出于同样的原因，您在纯 AppleScript 版本中需要两个反斜杠）并`grep`吃掉另一个（反斜杠的意思是“将下一个字符视为文字”，但在 GNU`grep`中它有时表示“处理下一个字符是特殊的”，但这不会发生在这里）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T13:56:00.970

> 我有一个 python 脚本可以做我想要的，除了我不能将活动窗口的文件位置从 TeXShop 传递给 python，只有 AppleScript。

但是您*可以*使用 AppleScript 获取当前打开`.tex`文件的路径，然后使用`do shell script`将该路径作为参数传递给您的 Python 脚本。像这样的东西（经过测试，如果您的 python 脚本接受文件路径作为命令行参数，则可以顺利运行）：

```
property thePythonScript : "/Users/user/path/to/script.py "
tell application "TeXShop"
    set thisDoc to the front document
    set filePath to (path of thisDoc)
    do shell script ("'" & thePythonScript & "' " & quoted form of filePath)    
end tell 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:16:03.797

如果你正在跑步

```
grep \begin{document} <file> 
```

然后它不起作用，因为反斜杠是外壳中的特殊字符。尝试：

```
grep \\begin{document} <file> 
```

# javascript - 如何使用 Html/Javascript 使用 OData 服务？

> ID：10112376
> 
> 赞同：19
> 
> 时间：2012-04-11T19:11:37.897
> 
> 标签：javascript, jquery, odata, breeze, jaydata

我们的项目目前使用 Silverlight 来使用 Odata 服务。这让生活变得非常简单，因为我们可以只引用 OData 服务，从而为我们提供生成的服务引用/实体。

然而，关于我们是否应该转向 Html (html5) 存在一些讨论。我想知道如果我们做出这个改变会发生什么。我们当然会利用像 jQuery 这样的框架。

*   我主要关心的是如何通过 JavaScript/jQuery 使用相同的 OData 服务。
*   我们应该如何反序列化/序列化从此 OData 服务返回的实体？
*   我们的数据合约是否应该是硬编码的（如果是这样，这对我们来说真的是不可接受的）？

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-11T19:23:31.870

[OData 源可以将数据作为 JSON 返回，](http://www.odata.org/developers/protocols/json-format)因此您的网页可以 XHR 您的数据并将其作为 JSON 接收，然后将其反序列化回 Javascript 对象，供您选择并执行或显示。

以下是一些帮助您入门的附加链接：

*   [新的 Javascript OData 库 [MSDN]](http://blogs.msdn.com/b/astoriateam/archive/2011/02/08/new-javascript-library-for-odata-and-beyond.aspx)
*   [OData 协议示例 [MSDN]](http://msdn.microsoft.com/en-us/library/ff478141.aspx)
*   [通过 JQuery 利用 JSON 格式的 OData 端点](http://codesmartinc.com/2011/01/31/leveraging-odata-end-points-in-json-format-with-jquery/)
*   [使用 JayData 使用 OData 服务](http://jaydata.org/tutorials/how-to-build-a-simple-odata-based-ajax-application)
*   [使用 BreezeJS 使用 OData 服务](http://www.breezejs.com/)

HTH。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-12T00:03:23.737

我们还制作了一个非常酷的小库，名为[Data.js (http://datajs.codeplex.com/)](http://datajs.codeplex.com/)，它将显着加快 JavaScript 对 OData 的消耗。这是 CoffeeScript 中的一个示例：

```
success = (data) -> $("#searchResultsTemplate").tmpl(data).appendTo("#resultsArea")
error = (err) -> $("#resultsArea").text(JSON.stringify(err.message))

do ->
  $("#search").click(->
    OData.defaultHttpClient.enableJsonpCallback = true
    OData.read("http://odata.netflix.com/v2/Catalog/Titles?$top=5", success, error)) 
```

以及它生成的 JavaScript：

```
 success = function(data) {
    return $("#searchResultsTemplate").tmpl(data).appendTo("#resultsArea");
  };

  error = function(err) {
    return $("#resultsArea").text(JSON.stringify(err.message));
  };

  (function() {
    return $("#search").click(function() {
      OData.defaultHttpClient.enableJsonpCallback = true;
      return OData.read("http://odata.netflix.com/v2/Catalog/Titles?$top=5", success, error);
    });
  })(); 
```

到目前为止，我已经成功地将它与 CoffeeScript、jQuery 和 Knockout.js 一起使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-02T13:52:25.620

作为替代方案，您可以[试一试 JayData](http://jaydata.org)，它具有 oData 支持 - 基于 supercool datajs 库。它在多个存储提供程序或协议上提供了一个抽象的数据访问层，其中一个重要的是 OData。

上面提到的查询看起来像这样

```
var  source = new $data.yourOdataContext({serviceUri:"http://odata.netflix.com/v2/Catalog"});

source.Titles
  .take(5)
  .forEach( function(catalog) { render(catalog); }); 
```

您可能不会期望这会被翻译为 .../Titles?$filter=5，因此即使简单的语法可能暗示，操作也不会在客户端上完成。

JayData 将为您提供[JavaScript 语言查询 (JSLQ)](http://wikipedia.org/wiki/JSLQ)，让您使用 ES5 标准过滤器功能查询数据：全部使用 JavaScript，不需要 OData 查询语法知识。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-04T22:47:46.030

如果要在表格中显示数据并使用排序、分页、搜索，可以使用 jQuery dataTables 插件[https://www.datatables.net/](https://www.datatables.net/)和 OData 连接器[http://vpllan.github.io/jQuery.dataTables。 o数据/](http://vpllan.github.io/jQuery.dataTables.oData/)

您不需要任何额外的编程，因为 dataTables 将为您执行那里的操作。

# c++ - 涉及类和结构的构造函数/析构函数

> ID：10112387
> 
> 赞同：0
> 
> 时间：2012-04-11T19:12:30.640
> 
> 标签：c++, constructor, destructor

我正在开发一个程序，需要制作一个对象数组，特别是我有一个 31x1 数组，其中每个位置都是一个对象，（每个对象基本上由 6 个整数构成）。这是我所拥有的，但出了点问题，我可以使用一些帮助谢谢。

31x1 结构头”

```
const int days=31;

struct Arr{

    int days;
    int *M;
};
typedef Arr* Array; 
```

31x1 矩阵构造函数：

```
void constr(){
    int *M;
    M = new Expe[31]; // Expe is the class 
```

类头：

```
class Expe {
private:
    //0-HouseKeeping, 1-Food, 2-Transport, 3-Clothing, 4-TelNet, 5-others
    int *obj;
} 
```

类对象构造函数：

```
Expe::Expe() {
    this->obj=new int[6];
} 
```

请帮助...因为我很迷茫。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:28:00.763

`new`除非必须，否则不应使用。您正在动态分配内存，之后您必须手动删除。

相反，使用静态分配的数组：

```
struct Arr{
    int days;
    Expe M[31];
} 
```

这样你就不需要构造 M，它会自动填充 31 个 Expe 对象。Expe 中的 int 数组也是如此。

（提示：结构和类几乎相同。它们唯一的区别是结构的默认可见性是公共的。除此之外，结构可以像类一样具有成员函数和构造函数。）

如果你必须使用动态分配，你应该遵循这个符号：

```
X* variableName = new X[size];
...
delete[] variableName; //Be sure to get rid of unused memory afterwards. 
```

`int*`如果您想在其中存储一个整数数组，指针应该是类型的。

您还可以将`const int`s 用于数组大小声明。所以这是有效的：

```
const int size = 5;
int X[size]; 
```

您可以使用它来摆脱代码中的“幻数”。

Typedef 之类`typedef Arr* Array;`的通常在 C 中使用，而不是在 C++ 中那么多。几乎没有任何情况需要 typedef 这样的东西。

如果您发布整个代码，我们可能会提供更好的帮助。看来你的代码中不仅有一两个错误，还有一些基本的理解。

# jquery - 从 JQuery 1.4.2 更改为最新的 1.7.2 后，函数不是函数

> ID：10112390
> 
> 赞同：1
> 
> 时间：2012-04-11T19:12:42.747
> 
> 标签：jquery, upgrade

对于我们使用 JQTouch 和 JQT segmentedControl 组件的一个项目，我已将 JQuery 库从 1.4.2 更改为 1.7.2。

在 JQuery 升级应用程序因 Firebug 中的此错误而停止后：

jQT.getSCValue 不是函数

这是库导致问题 [http://www.webwrx.sk/clients/jqt.segmentedControl.js](http://www.webwrx.sk/clients/jqt.segmentedControl.js)

我没有改变 JQTouch 库，也没有改变它的组件。更新的 JQuery 是否可能以某种方式与外部库不同？

还是我需要以某种方式注册这个额外的库？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:43:19.957

下载最新版本的 jQTouch，版本 1，beta 4 RC，于 2012 年 3 月 31 日发布，希望它与 jQuery 1.7.2 完全兼容

[http://www.jqtouch.com/](http://www.jqtouch.com/)

令人惊讶的是，开发人员在其文件的版权标头中没有包含版本号，甚至没有发布日期。但是，我在网上发现这个可能比你已经拥有的更新（或旧）......

[jqt.segmentedControl.js](http://www.kankado.com/dev/test/jqtouch/extensions/jqt.segmentedControl/jqt.segmentedControl.js)

# linq - 尝试字符串。加入 IList

> ID：10112392
> 
> 赞同：4
> 
> 时间：2012-04-11T19:12:53.073
> 
> 标签：linq, c#-4.0, interface

我正在尝试将第一个示例[http://www.dotnetperls.com/convert-list-string](http://www.dotnetperls.com/convert-list-string)实现到我的方法中，但我很难匹配该方法的第二个参数：

```
string printitout = string.Join(",", test.ToArray<Location>); 
```

错误信息：

```
The best overloaded method match for 'string.Join(string,
System.Collections.Generic.IEnumerable<string>)' has some invalid arguments 
```

所有的 IList 接口也是用 IEnurmerable 实现的（除非有人希望我在此列出）。

```
class IList2
{
    static void Main(string[] args)
    {

     string sSite = "test";
     string sSite1 = "test";
     string sSite2 = "test";

     Locations test = new Locations();
     Location loc = new Location();
     test.Add(sSite)
     test.Add(sSite1)
     test.Add(sSite2)
     string printitout = string.Join(",", test.ToArray<Location>); //having issues calling what it needs.

     }
 }
string printitout = string.Join(",", test.ToArray<Location>);

public class Location
{
    public Location()
    {

    }
    private string _site = string.Empty;
    public string Site
    {
        get { return _site; }
        set { _site = value; }
    }
}

public class Locations : IList<Location>
{
    List<Location> _locs = new List<Location>();

    public Locations() { }

    public void Add(string sSite)
    {
        Location loc = new Location();
        loc.Site = sSite;
        _locs.Add(loc);
    }
 } 
```

编辑：确定使用“string.Join(”,, test);” 工作，在我用复选标记关闭它之前，由于某种原因我的输出，输出：

“Ilistprac.Location，Ilistprac.Location，Ilistprac.Location”

出于某种原因，而不是列表中的内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T19:24:26.257

您根本不需要`ToArray()`（因为看起来您正在使用.Net 4.0）所以您可以拨打电话

```
string.Join(",", test); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:24:10.650

如果您的`Locaions`类型实现了`IEnumerable`您将不需要`ToArray`：

```
string printiout = String.Join(",", test); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T19:17:15.813

您需要将括号 - `()`-放在`ToArray<Location>`：

```
string printitout = string.Join(",", test.Select(location => location.Site).ToArray()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T19:16:14.460

尝试：

```
string printitout = string.Join(",", test); 
```

# windows - 虚拟wifi最大连接数/客户端数的注册表设置？

> ID：10112394
> 
> 赞同：2
> 
> 时间：2012-04-11T19:13:08.103
> 
> 标签：windows, wifi, virtual, connection

我正在构建一个应用程序，该应用程序具有利用 Windows 7 / 2008 功能动态创建新虚拟 wifi 的功能。我可以很好地创建它，但我正在寻找如何限制最大连接数。通过运行“netsh wlan show hostsnetwork”命令来查看我的设置 - 它显示（默认为 100），但它必须位于注册表中的某个位置，对吗？- 我在命令行或使用 api 时都看不到任何可用的设置 - 所以我必须假设它存储在 reg 中。我在 HKLM\System\CurrentControlSet\ - Wlansvc\parameters\hostednetworksettings 等中看到 vwifi 和 hostsnetwork 注册表项...但找不到添加“MaxClients”值（或类似值）的任何参考 - 希望将其限制为只有一个连接。有没有人看到任何参考，或者知道如何做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:07:17.180

您可以使用类似于以下代码的内容进行设置。

```
WLAN_HOSTED_NETWORK_CONNECTION_SETTINGS hostedNetworkConnSettings;
hostedNetworkConnSettings.hostedNetworkSSID = ssid;
// set the number of clients that may connect to your hosted network
hostedNetworkConnSettings.dwMaxNumberOfPeers = nPeers;

// set the new connection setttings
WlanHostedNetworkSetProperty(
                  m_WlanHandle,
                  wlan_hosted_network_opcode_connection_settings,
                  sizeof(WLAN_HOSTED_NETWORK_CONNECTION_SETTINGS),
                  (PVOID)&m_HostedNetworkConnSettings,
                  NULL,
                  NULL
              ); 
```

# c# - Base64 字符串的实体框架列类型

> ID：10112397
> 
> 赞同：1
> 
> 时间：2012-04-11T19:13:22.813
> 
> 标签：c#, sql, entity-framework, ef-code-first, base64

我使用的是代码优先实体框架，我的四个列是图像的 base64 表示，并且是字符串类型。最初，我允许 EF 将这些存储为默认的 nvarchar(max)。我今天了解到 nvarchar(max) 是数据实际大小的两倍，在处理图像时，这种差异是巨大的。

我尝试使用 varchar，但它的最大长度似乎是 8000，这对于 base64 图像来说太小了。我也尝试过文本，但这似乎不是有效的类型。

关于什么可能是支持数据长度同时保持合理大小的好类型的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:15:55.757

`text`你可以试试`varchar(max)`

# windows - GetProcessMemoryInfo 会在出错时修改输入/输出结构吗？

> ID：10112404
> 
> 赞同：0
> 
> 时间：2012-04-11T19:13:52.950
> 
> 标签：windows, memory, windows-7

我有一段代码被窃听了。

```
HANDLE lpProcess = GetCurrentProcess();
PROCESS_MEMORY_COUNTERS lMemoryCounters; 
GetProcessMemoryInfo( lpProcess, &lMemoryCounters, sizeof(lMemoryCounters) ); 
```

然后无论 GetLastError() 的值如何，都会使用**lMemoryCounters 。**我的问题是*即使发生错误也会修改 struct lMemoryCounters 还是未初始化？*

我的意思是当然在*发布*配置中......

可能没关系，但我在Win7 SP1 64位下运行它......

* * *

附言

我进行了一项测试：当我使用 MSVC（VS2005）构建时，**带有无效进程句柄的***PagefileUsage*（我感兴趣的那个）的值始终为 0。

 ***但是...我使用Intel C++ 9.1*构建我的代码，并且我总是为同一字段获得大的随机值（假设进程句柄无效）。也许我在回答我自己的问题？？？**

# java - oracle.forms.handler.IHandler的maven依赖或jar？

> ID：10112405
> 
> 赞同：-2
> 
> 时间：2012-04-11T19:13:53.853
> 
> 标签：java, import

我在互联网上到处搜索以找到一个 jar 或 maven 依赖项，`import oracle.forms.handler.IHandler; import oracle.forms.properties.ID; import oracle.forms.ui.CustomEvent; import oracle.forms.ui.VBean;`但直到现在都找不到它。

**有人知道如何在我的代码中修复此导入吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:04:12.550

由于专有许可限制，Maven 存储库无法分发 oracle 库。您需要先从 oracle.com 获取 jars（表单库附带一个名为“Oracle Fusion Middleware”的东西，这可能是一个很好的起点）。一旦可以隔离 jar 文件，就可以使用[mvn install:install-file](http://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html)命令将它们添加到本地 maven 存储库。使用您在所述命令中定义的组/工件 ID，将依赖项添加到您的 pom 文件中。然后，maven 将能够从本地存储库导入 jar，并且应该为您解决 eclipse 构建路径问题。

# jquery - 在 jquery 中分别使用隐藏/显示

> ID：10112406
> 
> 赞同：3
> 
> 时间：2012-04-11T19:13:55.210
> 
> 标签：jquery, delay, show, each, slide

此代码不起作用，我如何解决它？

我把所有东西都隐藏了..在这之后，我在延迟 7 秒内一一显示..

但是一切都显示了，我不明白为什么

```
$(function()    {
    texts = $('.text-block');
    slide = $('#slideshow');

    // hide everything
    texts.each(function()   {
       $(this).hide(); 
    });

    // show it once by once
    jQuery.each(texts, function()   {
       $(this).show(300);
       $(this).delay(7000);
       $(this).hide(300);
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T19:18:06.930

因为它从同一点延迟，如果你把延迟放在正确的地方。

```
$(function()    {
    texts = $('.text-block');
    slide = $('#slideshow');

    // hide everything
    texts.hide(); 

    // show it once by once
    texts.each( function(index)   {
       $(this).delay(7000 * index).show(300);
    });
}); 
```

显示后是否要再次隐藏它？我删除了它，因为它只会显示然后隐藏。

缩短版：

```
$(function() {
    $('.text-block').each(function(index){
        $(this).hide().delay(7000 * index).show(300);
    });
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T19:17:57.207

首先，您不需要使用 .each，

```
texts = $('.text-block');
texts.hide(); // hides all matched elements 
```

就一一展示而言，延迟并不会停止整个 js 线程的执行，这将是阻塞且糟糕的，并使您的应用程序看起来非常无响应。要一一展示它们，您必须编写它不同

也许是一个递归函数，你在延迟之后传递下一个元素，使用承诺知道动画和延迟何时完成？

像这样：

[http://jsfiddle.net/SbYTL/1/](http://jsfiddle.net/SbYTL/1/)

```
function ShowItems(items, delay) {
    $(items[0]).fadeIn(300)
        .delay(delay)
        .fadeOut(300)
        .promise()
        .done(function() {
            items.splice(0, 1);
            if (items.length > 0)
            {
                ShowItems(items, delay);    
            }            
    });       
}

var items = $(".text-block").hide();  
ShowItems(items, 7000); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:40:25.573

改用签出[`.throttle`](http://benalman.com/projects/jquery-throttle-debounce-plugin/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:07:58.013

```
$(function() {
    $('.text-block').hide().each(function(item, index) {
         $(item).delay(7000*index).show(300, function() {
             $(this).delay(7000).hide(300);
         });
    });
}); 
```

# rest - 对其他资源的副作用

> ID：10112407
> 
> 赞同：6
> 
> 时间：2012-04-11T19:13:56.340
> 
> 标签：rest

这是关于 RESTful 和 HATEOAS 设计的理论/最佳实践问题...

鉴于资源：

> /myresources/（我们的资源对象的集合）

和

> /transactions/（系统中发生的历史交易的集合）

对于以下情况是否有效：

> 发布/我的资源/

不仅要在 /myresources/ 创建新资源，还要在 /transactions/ 创建新资源？

换句话说，一个 URL 的 POST（或任何动词）能否影响该 URL 和其他 URL 的资源？还有另一种方法吗？显然我们可以使用两个 POST，但这需要我们信任用户在多资源修改中保持有效状态。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T23:20:22.667

是的，这很好。想象另一种系统公开`/myresources/latest`URI 的情况。当没有资源时，可能会返回 404，但是当您开始 POST 资源时，规范 URI 和`latest`URI 都将返回 200 OK。这种方法有很多很多有用的好处。

但是，在设计此类资源时请牢记缓存。例如，如果您 POST 到`/myresources/`集合，您将在此过程中的任何缓存中使该集合无效。但是，您不会使`/transactions/`集合无效，并且两个索引可能会不同步。无论如何，它们可能在整个系统中不同步，具体取决于多个客户端和源服务器之间的缓存图，但通常，客户端被设计为期望远距离的此操作是同步的，并且缓存可以在这种情况下感到沮丧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:26:15.703

这对我来说似乎完全合理。例如，创建新资源的人无法判断这是通过让另一个客户端轮询新资源然后注入事务资源来实现的，对吗？

因此，在该级别上不存在任何概念问题，更不用说“服务器创建新资源是否合理”级别。

# android - 回到我的应用程序后，标题栏再次出现

> ID：10112410
> 
> 赞同：1
> 
> 时间：2012-04-11T19:14:05.540
> 
> 标签：android

在我的应用程序中，我在清单文件中应用了以下主题：

```
android:theme="@android:style/Theme.NoTitleBar.Fullscreen" 
```

它工作正常。
但是，当我根据应用程序要求从我的应用程序中呼叫某人，并在通话结束后再次回到我的应用程序中时，标题栏再次出现在应用程序中。我不明白这是什么问题。请帮帮我。

我根本不想要我的应用程序中的标题栏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:21:40.653

这看起来像一个已知[问题](https://groups.google.com/forum/?fromgroups#!topic/android-developers/K0gGYD5HuTg)：

听起来像以下将解决它：

```
getWindow().setFlags(WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS, 
WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS); 
```

# asp.net - 如何在 GridView RowDataBound 中获取附加参数

> ID：10112414
> 
> 赞同：0
> 
> 时间：2012-04-11T19:14:14.040
> 
> 标签：asp.net, asp.net-webcontrol

我有一个获取数据源的 GridView。现在在 RowDataBound 上，我需要对行单元格进行一些更改，但我需要外部信息来确定发生了什么更改。

```
static void GridRowDataBoundProbables(object sender, GridViewRowEventArgs e)
{
    if(e.Row.RowType == DataControlRowType.Header)
    {
        foreach (TableCell cell in e.Row.Cells)
        {
            if (!int.TryParse(cell.Text, out postNum)) continue;
            cell.CssClass += " postCell";
            cell.Add(new Panel { CssClass = (**isHarness** ? PostHarness : PostThoroughbred) + postNum });
            cell.Add(new Label { Text = postNum.ToString() });
        }
    }
} 
```

我需要 isHarness bool，它在我创建和绑定网格时可用。此外，由于网格是在静态 WebMethod 调用期间创建的，因此我**无法**在页面上将其设为全局。

如何将 isHarness 的值获取到此函数中？我以为我可以创建自己的继承自 GridViewRowEventArgs 的 EventArgs，但我仍然不知道如何在我的新 args 中实际获取 bool ...

**编辑**

isHarness 是在创建 DataSource 时确定的布尔值，**但不是 DataSource 的一部分**

下面是外部调用的模拟：

```
[WebMethod]
public static AjaxReturnObject GetProbables(string token, string track, string race, string pool)
{
    Tote tote = new Tote(...);
    GridView grid = new GridView();
    grid.RowDataBound += GridRowDataBound;
    grid.DataSource = tote.GetDataSource(); //isHarness is available during creation of DataSource
    //Here tote.isHarness is available from property
    grid.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:37:32.830

一如既往，答案是“视情况而定”。

我们对您的 bool 了解不多`isHarness`。这个变量的作用域是什么？它是页面的成员吗？GridView 的成员？它是 GridView 数据源的一部分吗？

如果它是页面的公共成员，则可以从您的方法`sender`转换为 Web 控件，然后遍历父层次结构，直到找到该页面，并从那里获取它。

如果它是 GridView 的成员，则只需这样做并遍历父结构，直到找到 GridView。

*编辑*

感谢您发布更多来源。它看起来像是对象`isHarness`的成员`tote`。如果是这种情况，您可能无法在 DataBound 事件中获取它。`tote`只是一个局部变量，它超出了范围并且早已不复存在。如果您想在 GridRowDataBound 代码中访问它，您可能需要将该值存储在其他地方。

例如，您可以将 GridView 扩展为具有属性的自定义类，并在您的函数`IsHarness`中设置该值。`GetProbables`然后你可以通过适当的转换在你的 GridRowDataBound 事件中访问它`sender`。

# php - php 如果变量 int 的第一个实例

> ID：10112417
> 
> 赞同：-1
> 
> 时间：2012-04-11T19:14:27.647
> 
> 标签：php, loops, while-loop

如果我有一个返回一些值的 mysql 查询，这些值按“parent_id”分类，大约有 3-5 个值 pr“parent_id”。在我的 while 循环中，我只想回显每个“parent_id”中的第一个值。我该怎么做？

类似“如果这是该变量第一次具有此值，请执行此操作”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:18:23.430

您可以将值保存在数组中，并检查数组中是否有新值。

```
$SeenValues=array();

foreach($AllValues as $Value){ //Or some other loop
    if (!in_array($Value, $SeenValues)){
        //Do something

        //Add new value to array
        array_push($SeenValues, $Value);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:18:53.537

只需将条件添加到您的 while 循环中...

```
$old_id = '';
while($row = $db->fetch_object()){
    if($row->parent_id != $old_id){
        //new parent_id
        $old_id = $row->parent_id;
        //... do stuff ...
    }
} 
```

# meteor - 如何在我的 ubuntu VPS 上运行排行榜示例？

> ID：10112418
> 
> 赞同：1
> 
> 时间：2012-04-11T19:14:29.643
> 
> 标签：meteor

如果我在我的 ubuntu VPS 上运行以下命令：

卷曲安装.meteor.com | 嘘

流星创建--示例排行榜

cd排行榜流星

在 apache2 上为 domain.com 设置我的虚拟主机之后。我是否需要做任何进一步的工作才能使此示例正常工作，还是我只需访问 domain.com:3000？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T21:28:40.753

确保您没有被防火墙阻止。对于 ufw，它应该是 'sudo ufw allow 3000'；

不过，您*不需要*Apache，只需浏览到 domain.com:3000。

它不工作吗？

# jquery - 将类添加到第一级的最后 li

> ID：10112420
> 
> 赞同：0
> 
> 时间：2012-04-11T19:14:34.437
> 
> 标签：jquery, drop-down-menu

我正在设计我网站的主菜单的样式，我想为无序列表中的第一个和最后一个 LI 元素添加一个类，但**只有**顶层的第一个和最后一个项目。

```
<div id="primary-menu-container" class="menu">
    <div id="menu-icon">Menu</div>
    <ul id="primary-menu" class="hover sf-menu">
        <li><a href="#">Fabrics</a></li>
        <li><a href="#">Contemporary</a></li>
        <li><a href="#>Vinyl</a></li>
        <li><a href="#">Gold</a></li>
        <li><a href="#">History</a></li>
        <li><a href="#">Test Tag</a>
            <ul class="sub-menu">
                <li><a href="#">Testing</a></li>
                <li><a href="#">news</a></li>
            </ul>
        </li>
    </ul>
</div>​ 
```

第一个非常简单，因为第一个 li 始终是顶级列表元素。我对最后一个目标感到困惑，因为最后一个顶级列表元素上可能有一个子菜单。

没有选择解决方案，但根据以下一些回复：[如何将类添加到第一级的最后一个 li](https://stackoverflow.com/questions/8515847/how-to-add-class-into-last-li-of-first-level)

我尝试了以下方法，它适用于第一项，但将“last”类添加到“Test Tag”及其所有子项，而我只希望将此类添加到“Test Tag”li。

```
$​("#primary-menu > li:first").addClass("first");
$("#primary-menu > li:last").addClass("last"); 
```

这是我的小提琴。​</p>

[http://jsfiddle.net/tdcf7/1/](http://jsfiddle.net/tdcf7/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:16:15.090

固定：http: [//jsfiddle.net/tdcf7/3/](http://jsfiddle.net/tdcf7/3/)

```
.last > a{ color: red } 
```

它并没有将班级添加到所有后代；您的 CSS 选择器 ( `.last a`) 只是选择了该类的单个项目的所有后代。

通过使用子选择器而不是后代，上面的修复只选择`<a>`直接是`<li>`该类的子代的那个。

或者——如果很难准确地选择你想要的内容——你总是可以将样式应用于所有后代，然后为不正确的后代覆盖它：

```
li           { color:green } /* default style            */
li.last *    { color:red   } /* hit 'em all!             */
li.last ul * { color:green } /* ooh...but not these ones */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:19:28.500

您的 javascript 很好，是您的 CSS 也使子列表变为红色。

```
.last > a{ color: red;} 
```

这`>`将导致它只影响直系后代

# css - 具有自动调整列数的流体网格

> ID：10112427
> 
> 赞同：5
> 
> 时间：2012-04-11T19:14:58.970
> 
> 标签：css, fluid-layout

我想知道 CSS 是否可以实现以下功能：

*   DIV 的网格，在任意数量的列中，假设 N（可能是 5 到 20 或更多）
*   网格应该是流动的，即每个 DIV 都会随着浏览器宽度的变化而收缩和扩展，以便 DIV 占据浏览器宽度的 100%
*   在一定的浏览器宽度下，grid切换到N-1列布局，即丢失一列，DIV再次展开以适应浏览器宽度
*   应该重复该过程，直到布局变为基于单列，同样 DIV 的宽度是流动的

我有点难以形容，但它的行为应该与此[页面](http://www.alistapart.com/d/responsive-web-design/ex/ex-site-FINAL.html)中的图像类似，但它应该一直向下到一列，而不是立即从三列跳到六列布局。

我知道我可以用 Javascript 来做到这一点，就像在上面的链接中所做的那样，使用 @media 查询（有很多手动摆弄列宽），但我想知道有没有办法只在 CSS 中做到这一点，让浏览器为我完成工作？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:22:15.557

你有没有考虑过使用 Twitter Bootstrap Grid 系统？或者至少审查并采用类似的系统？[http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem](http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem)和他们的“响应式”网格 css（或者他们所说的任何东西）。

这是一个实际使用的网格系统示例。[http://jsfiddle.net/rlemon/yS78x/1/](http://jsfiddle.net/rlemon/yS78x/1/)

它利用媒体查询，就像你上面提到的......但它已经为你完成了，IMO 是更容易采用的网格系统之一。

# javascript - 事件处理程序在 Internet Explorer 中不起作用

> ID：10112431
> 
> 赞同：2
> 
> 时间：2012-04-11T19:15:12.603
> 
> 标签：javascript, internet-explorer, javascript-events

我正在使用 JavaScript 创建一个网站。JS 部分的目的是将我自己的键盘处理程序附加到某些文本字段。我设法将问题缩小到像这个小提琴一样简单的代码：http:
[//jsfiddle.net/k9s3n/1/](http://jsfiddle.net/k9s3n/1/)
在 Firefox、Opera 和 Chrome 中，在三个字段中的**任何**一个中键入一个字符都会导致显示一个警告框与关键代码。然而，在 Internet Explorer（在我的情况下，这是我通常支持的最低版本）中，它只能`input3`正常工作 - 也就是说，它是释放键时显示对话框的唯一字段。尝试在其他两个框中输入没有结果，它只是在控制台中记录一个错误：（
`keyCode is null or isn't an object`不确定错误消息是否正确，我是从我的母语翻译过来的）。
无论浏览器如何，似乎只有第三种解决方案有效，但在我的场景中，我必须使用第一个或第二个。

我为进一步调查创建了另一个小提琴：http:
[//jsfiddle.net/bSdaJ/](http://jsfiddle.net/bSdaJ/)
这两个按钮在单击时都会显示一个消息框。在 Firefox、Opera 和 Chrome 中，该框显示“[object MouseEvent]”，而在 IE 中显示“未定义”。
我能做些什么呢？感谢您提前提供任何帮助。

PS 如第一个小提琴所示，如果我使用内联事件处理，一切正常。但是，我在这个项目中的目标是完全分离 HTML 和 JS，所以我不能使用它。我是为朋友做的，我希望 HTML 部分是简单、清晰的标记代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T19:26:59.600

您不应该使用 DOM 0 事件（通过 HTML 属性附加的事件）。您应该使用事件侦听`element.addEventListener`器，在 W3C 浏览器和`element.attachEvent`IE 中附加使用。如果您正在构建一个大型网站，您应该使用 JS 框架，但这是一个您没有问过的不同问题。一个框架（最流行的是 jQuery）会提供抽象方法来做到这一点，但在没有抽象方法的情况下，这里有一个简单的函数来实现跨浏览器。

```
function addEvent(element,evName,fn) {
    if (element.addEventListener) {
        element.addEventListener(evName,fn,false);
    } else if (element.attachEvent) {
        element.attachEvent('on'+evName,function(e) {
            fn(e || window.event);
        });
    }
} 
```

这个简单的函数使用特征检测来规范浏览器之间的不同事件行为。IE 使用不同的监听函数，签名不同，而且 IE 也不遵循 W3C 规范要求处理程序接收事件对象作为参数；相反，它设置了全局 window.event` 属性。

用法示例：http: [//jsfiddle.net/k9s3n/3/](http://jsfiddle.net/k9s3n/3/)

另请注意，IE 和 W3C 浏览器对该`event.keyCode`属性有不同的方法（因为其他浏览器的方法是正确的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:20:09.153

试试这个：

```
function clickHandler(e) {
    if(!e)
        e = window.event;
    alert(e);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T14:45:37.963

试试这个：

```
function funcToCall(e)
{

    //alert('here');
    var keycode;
    if (window.event)
    {
        if (window.event.keyCode == '112') {  // F1 was pressed

        // call your methods in this area

        window.event.returnValue = false;
        return false;
        }

    }   
    else if(e) 
    {
        if (e.which == '112') {  // F1 was pressed, search for other keycodes

        // call your methods in this area

        e.preventDefault();
        return false;

        }

    }   
} 
```

调用您的文本字段：

```
onKeyDown="funcToCall(event)" 
```

# c++ - 编译器找不到命名空间

> ID：10112445
> 
> 赞同：7
> 
> 时间：2012-04-11T19:16:21.783
> 
> 标签：c++, namespaces

我有几个文件，在下面列出，我在其中定义了一些命名空间和类。然后在其中一个文件中，我试图合并其他文件中的类。问题是编译器似乎无法找到我的命名空间。

charon.cpp

chin.cpp

chout.cpp

主文件

我的命名空间是**charon**、**charon_in**和**charon_out**。主要问题出现在特定文件***charon.cpp 上***，所以这里也是该文件和***chin.cpp***。

错误：

```
g++    -c -g -MMD -MP -MF build/Debug/GNU-Linux-x86/sys/charon.o.d -o build/Debug/GNU-Linux-x86/sys/charon.o sys/charon.cpp
sys/charon.cpp:6:17: error: ‘charon_in’ is not a namespace-name
sys/charon.cpp:6:26: error: expected namespace-name before ‘;’ token
sys/charon.cpp:7:17: error: ‘charon_out’ is not a namespace-name
sys/charon.cpp:7:27: error: expected namespace-name before ‘;’ token
sys/charon.cpp:15:5: error: ‘chout_’ does not name a type
sys/charon.cpp:16:5: error: ‘chin_’ does not name a type
sys/charon.cpp:31:39: error: ‘chin_’ has not been declared
sys/charon.cpp:31:55: error: ‘engine_input’ was not declared in this scope
sys/charon.cpp:32:40: error: ‘chout_’ has not been declared
sys/charon.cpp:32:57: error: ‘engine_output’ was not declared in this scope 
```

charon.cpp

```
#include <iostream>
#include <boost/thread.hpp>
#include <boost/date_time.hpp>

using namespace std;
using namespace charon_in;
using namespace charon_out;

namespace charon
{
  class charon_
  {
  private:
    chout_ engine_output;
    chin_ engine_input;
    boost::thread input_thread;
    boost::thread output_thread;
    void start_threads();
    void stop_threads();
  public:
    //Methods
}; 
```

chin.cpp

```
#include <iostream>
#include <borland/conio.h>
#include <ncurses.h>
#include <boost/thread.hpp>

using namespace std;
using namespace charon;
using namespace charon_out;

namespace charon_in
{
  class chin_
  {
  private:
    bool pause;
    charon_* engine;
    inline iostream grab();
  public:
    //Methods
}; 
```

我检查了一切。所以我非常有信心语法是正确的，但显然我错过了一些关键概念，否则编译器不会抱怨。

（我知道将类放在 cpp 文件中并不是一件标准的事情，但我知道这样做是可能的，所以这就是我选择尝试的原因。）

我看不出我犯了什么错误。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-11T19:19:57.540

您需要在以下内容之前包含声明命名空间（或再次声明）的头文件`using directive`：

```
// using namespace test;  // Error test is not known to be a namespace
namespace test {}
using namespace test;     // Fine -- test is known 
```

正如韦恩正确[指出的那样](https://stackoverflow.com/a/10112487/36565)，您可能希望以不同的方式重组代码，包括包含声明并且可以包含在不同翻译单元中的头文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T19:19:48.287

您在 .cpp 文件中有类声明和定义。您需要将类声明移动到 .h 文件中，并将其包含在使用该类的适当文件中。

例如，将以下内容移至 chin.h 并将 chin.h 包含在 charon.cpp 中。

```
namespace charon_in 
{ 

  class chin_ 
  { 
  private: 
    bool pause; 

    iostream key_sequence; 
    deque<char> key_queue; 
    charon_* engine; 

    inline iostream grab(); 

  public: 
    chin_(const charon_& handle); 
    chin_(const chin_& orig); 
    ~chin_(); 

    void refresh(); 
    bool stop_check(); 
  }; 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-14T12:21:01.723

警惕循环依赖，因为它们也可能导致编译器找不到您需要的命名空间。

```
 //In rightWing.h
     include "leftWing.h"
     // code

       //In leftWing.h
     include "rightWing.h"
     // code 
```

# php - 对 URL 进行两次百分比编码

> ID：10112447
> 
> 赞同：1
> 
> 时间：2012-04-11T19:16:30.810
> 
> 标签：php, vb.net, url, web, affiliate

我得到了一些指令来对 URL 进行两次百分比编码。我知道如何对 URL 进行一次百分比编码，但你如何进行两次呢？

Surly 编码一次，再次编码时还是一样。

我错过了什么吗？

指令或算法会很棒！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T19:20:27.180

它将不一样，因为您对`%`用于编码的编码进行了编码。

```
$url = 'http://www.youtube.com/watch?v=35_0IN36rUI'
echo $url;
echo urlencode($url);
echo urlencode(urlencode($url)); 
```

会给：

```
http://www.youtube.com/watch?v=35_0IN36rUI
http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D35_0IN36rUI
http%253A%252F%252Fwww.youtube.com%252Fwatch%253Fv%253D35_0IN36rUI 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T19:18:52.900

要在 php 中对 Url 进行双重编码，请执行以下操作：

```
$encodedUrl = urlencode(urlencode($url)); 
```

编码两次时绝对不一样的输出。第一个添加百分比编码，第二个实际上将编码这些百分比符号......例如：

```
urlencode('guts & glory'); // "guts+%26+glory"
urlencode(urlencode('guts & glory')); // "guts%2B%2526%2Bglory" 
```

# iphone - UIScrollView 滚动滞后

> ID：10112449
> 
> 赞同：0
> 
> 时间：2012-04-11T19:16:47.340
> 
> 标签：iphone, ios, uiscrollview

![在此处输入图像描述](../Images/2e3330e3df86331ec3f2964e25b33121.png)

我有 UIScrollView 和一些（大约 10 个“帖子”）。Post - 自定义视图，UILabe 从笔尖加载并动态更改框架。所以我这样做：

```
[[NSBundle mainBundle] loadNibNamed:@"AWPostShortView" 
                              owner:self 
                            options:nil]; 

// calculate frame etc (doesn't matter)
self.shortPost.frame = frame;

// Add to scrollView
[self.scrollView addSubview:self.shortPost];

self.shortPost = nil; 
```

**问题**是“滚动”动作有滞后。
我的意思是-**滚动视图在光标下跟随延迟**
当帖子出现时我不进行任何操作、计算等。

请告知如何优化它
*（我不能使用 UITableView 和重用单元，因为我有不同的单元高度）*

# php - 如何在 php MYSQL 中获取最后插入的日期

> ID：10112450
> 
> 赞同：0
> 
> 时间：2012-04-11T19:16:51.020
> 
> 标签：php

我有两张桌子，我想得到最后输入的日期。

第一个表是`seeker`：

```
seeker_nic-----username
111-------------ali
222-------------umer
333-------------raza 
```

第二个是`requestblood`：

```
id-------seeker_nic-----requireddate
1-------  111 ----------2012/10/9
2 ------- 222-----------2012/5/8
3 ------  111-----------2012/12/12
4 ------- 111-----------2012/11/12
5---------111-----------2012/09/09
6 ------- 222-----------2012/7/9
7 ------- 333 ----------2012/4/4 
```

现在，我想列出用户最后一次插入的日期，例如..

```
s.no---- username----- requireddate
 1------- ali---------- 2012/09/09
 2------- umer--------- 2012/7/9
 3------- raza--------- 2012/4/4 
```

我正在使用此查询，但它显示最大日期而不是最新日期。

```
SELECT seeker.username, MAX(bloodrequest.requireddate) AS requireddate, COUNT(bloodrequest.requireddate) AS total
FROM seeker
JOIN bloodrequest
  ON seeker.seeker_nic = bloodrequest.seeker_nic
GROUP BY seeker.username 
```

这显示了最大日期，并显示了总日期。例如，111 总共有“4”，但我不知道如何显示最后插入的日期...我是 PHP 新手，请帮助我。:(

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:39:38.983

非常简单，但您将需要使用子选择 - 获取具有最后一个 id 的行（这只有在您有正确的索引时才有效 - 我想你有）。

例子：

```
SELECT seeker_nic, username, 
(SELECT `requiredate` FROM `requestblood` WHERE `seeker_nic`=`seeker`.`seeker_nic` ORDER BY `id` DESC LIMIT 1) as `last_requiredate`
FROM `seeker` 
```

# mysql - 没有 JOIN 的有效 SQL？

> ID：10112451
> 
> 赞同：2
> 
> 时间：2012-04-11T19:16:56.910
> 
> 标签：mysql, sql

我遇到了以下`SQL`声明，我想知道它是否有效：

```
SELECT COUNT(*) 
    FROM 
        registration_waitinglist, 
        registration_registrationprofile 
    WHERE 
        registration_registrationprofile.activation_key = "ALREADY_ACTIVATED" 
```

用逗号隔开的两张表是什么意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T19:22:02.307

当您`SELECT`从多个表中获取数据时，您会`Cartesian Product`从这些表中获取所有元组。可以通过以下方式进行说明：

![笛卡尔积图](../Images/08c09ba966a738834a84ec2fd464c971.png)

这意味着您将第一个表中的每一行与第二个表中的所有行配对。大多数时候，这不是你想要的。如果你真的想要它，那么使用`CROSS JOIN`符号会更清楚：

```
SELECT * FROM A CROSS JOIN B; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:19:35.427

在这种情况下，这意味着您将从registration_waitinglist 的每一行加入registration_registrationprofile 的每一行

它被称为笛卡尔连接

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T19:21:36.633

该查询在“语法上”是正确的，这意味着它将运行。查询将返回registration_waitinglist x registration_registrationprofile 中每一行的整个产品。例如，如果waitlist 中有2 行，profile 中有3 行，则将返回6 行。

从实际情况来看，这几乎总是一个逻辑错误而不是故意的。除了极少数例外，where 子句中应该有连接条件或条件。

# php - 清除记住值的表单

> ID：10112452
> 
> 赞同：0
> 
> 时间：2012-04-11T19:17:06.387
> 
> 标签：php, html

我有一个包含一些用户详细信息的表单，并允许他们上传文件。文件名和信息保存到 csv 文件中。

如果用户没有填写所有字段，表单会要求他们填写并重试。我希望它记住用户输入的值，所以我使用 php 设置表单字段的默认值：

```
value="<?php print $fulltitle;?>" 
```

其中 $fulltitle = $_POST['fulltitle'];

但是，如果用户提交的内容不成功，点击重置不会清除表单，它会返回他们之前的尝试。

如何使重置功能起作用？在我尝试使用的重置按钮中

```
onclick="<?php $fulltitle='' ?>" 
```

但它似乎没有效果，我猜是因为在你点击重置时 PHP 已经被处理了。

有人有什么建议吗？

* * *

编辑：

感谢您的帮助，我按照建议通过简单的重新加载解决了这个问题。对于任何寻找问题答案的人：

我放了一个重置​​按钮，而不是：

```
<FORM METHOD="LINK" ACTION="resetform.php">
<INPUT TYPE="submit" VALUE="Reset">
</FORM> 
```

在文件 resetform.php 我有：

```
<?php
$firstname = '' ;
$lastname = '' ;
$fulltitle = '' ;
$email = '' ;
// etc.

header("Location: submitfile.php");
?> 
```

其中 submitfile.php 是表单

/编辑

* * *

修剪后的代码如下...

标题：

```
<?php
//error_reporting(E_ALL & ~E_NOTICE);
$message = false;

if(isset($_POST['Submit'])){

//user input with commas and < stripped:
    $firstname = str_replace("<","",str_replace(",",";",$_POST['firstname']));

//if values missing, dont process:
    if(empty($firstname)){
        $message =  '<span style="color:red;text-align:center;">Please complete all required(*) fields,<br />and check the file has been selected correctly.</span>';
        $aClass = 'errorClass';
    }

else {
    //return data array cvsData from user input

    $cvsData = $firstname
    fwrite($fp,$cvsData);
    fclose($fp);
    //reset form
    $firstname = '' ;           
    $message = '<span style="color:blue;text-align:center;">Submission successful, thank you.</span>'; 
    }

}
//if page reloaded, clear form:
else {
    $firstname = '' ;
    }

?> 
```

身体：

```
<form enctype="multipart/form-data" id="form1" name="form1" method="post" action="<?php echo $_SERVER['PHP_SELF'] ?>" >
<table>
<?php
if ($message != false)
    {
    print "<tr><td colspan='2'><span align='center'>" . $message . "</span></td></tr>";
    }
?>  

<tr>
    <td width="200"><span class="texto">*First Name(s)</span></td>
    <td><input type="text" name="firstname" id="firstname" value="<?php print $firstname;?>" /></td>
</tr>

<tr>
    <td colspan="2">
        <div align="center">
            <input type="submit" name="Submit" id="Submit" value="Submit"/>
            <input type="reset" name="Reset" id="Reset" value="Reset" />
        </div>
    </td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:19:33.437

点击重置只会将表单重置为其原始值。在您的情况下，这是他们的原始表单提交值，因为这是您在`value`属性中设置的值。如果要向用户显示空白表单，则需要使用 JavaScript 完全删除表单值。

这是一个应该执行此操作的 JavaScript 片段：

```
function clear_form_elements(ele) {

    tags = ele.getElementsByTagName('input');
    for(i = 0; i < tags.length; i++) {
        switch(tags[i].type) {
            case 'password':
            case 'text':
                tags[i].value = '';
                break;
            case 'checkbox':
            case 'radio':
                tags[i].checked = false;
                break;
        }
    }

    tags = ele.getElementsByTagName('select');
    for(i = 0; i < tags.length; i++) {
        if(tags[i].type == 'select-one') {
            tags[i].selectedIndex = 0;
        }
        else {
            for(j = 0; j < tags[i].options.length; j++) {
                tags[i].options[j].selected = false;
            }
        }
    }

    tags = ele.getElementsByTagName('textarea');
    for(i = 0; i < tags.length; i++) {
        tags[i].value = '';
    }

} 
```

然后把它放在你的重置按钮中：

```
onclick="clear_form_elements(this.form[0])" 
```

# linux - 如何在shell中获得一年中的一天？

> ID：10112453
> 
> 赞同：23
> 
> 时间：2012-04-11T19:17:08.893
> 
> 标签：linux, bash, shell, ksh

如何在 shell中获取**一年中的某一天？**

`date '+%V'`会给我一年中的第几周，今天是 15；但我需要找到一年中的哪一天！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-11T19:19:35.257

从[coreutils 日期](http://www.gnu.org/software/coreutils/manual/coreutils#Date-conversion-specifiers)手册：

```
%j     day of year (001..366) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-04-11T19:27:53.630

使用`date`命令和`%j`选项...

```
doy=$(date +%j) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-08T08:30:48.963

POSIX 要求使用格式字符串`%j`来获取一年中的某一天，所以如果你想要它作为今天的日期，你就完成了，并且有了一个可移植的解决方案。

```
date +%j 
```

对于获取任意日期的天数，情况要复杂一些。

在 Linux 上，您通常会有 GNU `date`，它允许您使用选项查询任意日期`-d`。

```
date -d '1970-04-01' +%j 
```

的参数`-d`可以是一个相当自由形式的表达式，包括像“3 周前”这样的相对时间。

```
date -d "3 weeks ago" +%j 
```

在包括 MacOS 在内的类似 BSD 的平台上，指定要格式化的日期的机制是不同的。您可以要求它格式化日期`-j`并将日期指定为参数（不是选项），并可选择指定字符串参数应如何解析`-f`。

```
date -j 04010000 +%j 
```

显示 4 月 1 日 00:00 的天数。指定要检查的日期的字符串参数相当奇怪，需要指定分钟，然后可选地允许您以 ((month,) day, and) hour 为前缀，并可选地允许 year 作为后缀 (sic) .

```
date -j -f "%Y-%m-%d" 1970-04-01 +%j 
```

用于`-f format date`以更标准的格式传入日期，并打印该日期的日期。

还有一个`-v`选项允许您指定相对时间。

```
date -j -v -3w +%j 
```

显示三周前日期的天数。

# google-app-engine - Blobstore - 如何保存来自 servlet 的数据

> ID：10112457
> 
> 赞同：0
> 
> 时间：2012-04-11T19:17:20.410
> 
> 标签：google-app-engine, google-cloud-datastore, blobstore

我正在查看谷歌提供的关于如何在 Blobstore 上保存数据的代码。我需要保存一个大的 jason 文件。谷歌提供的所有代码都显示了如何使用表单进行操作。

我有一个 servlet，一个 android 应用程序将发送 jason，servlet 必须保存它。

DataStoreService 类有一个“put”方法可以做到这一点，但看起来 blobstore 没有“put”方法。

有人可以给我一些示例代码吗？非常感谢提前

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:40:42.733

[您可以通过新的FileService API](https://developers.google.com/appengine/docs/java/blobstore/overview#Writing_Files_to_the_Blobstore)以编程方式将数据保存到 Blobstore 。

# html - 是更喜欢在 html 中使用字符代码来表示特殊字符还是字符本身？

> ID：10112460
> 
> 赞同：3
> 
> 时间：2012-04-11T19:17:51.737
> 
> 标签：html, special-characters

我有一个包含字符的 html 文件`ë`。

html 包含这一行，它指定我使用的是 iso-8859-15 字符集。

`<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-15">`

我可以选择使用 html 文件中的字符代码`&euml;`或字符`ë`本身。两者都工作得很好。

我想知道一个是否比另一个更可取，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:28:36.883

我相信字符代码可确保最大程度的可重用性/灵活性。例如，如果我想将该文本复制并粘贴到我没有定义字符集的地方，它更有可能起作用。此外，如果内容来自数据库，它可以确保最大程度的灵活性。

免责声明：这个问题没有正确的答案 - 这纯粹是意见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:39:17.373

真实人物有：

*   带宽效率更高
*   在编写或编辑页面时更易于阅读

实体：

*   让您不必太在意字符编码

只需使用真实字符，并确保您在整个生产链中使用单一 unicode 编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:31:29.917

> 实体用于实现保留字符或表示无法用键盘轻松输入的字符。

所以我认为最好使用 entity name`&euml`或 entity number `&#235;`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T21:01:18.613

您不应该使用 ISO-8859-15，因为它的支持不如 ISO-8859-1 广泛，并且即使在它工作时也没有提供任何真正的好处。如果您使用实体，请以分号结尾：（`&euml;`而不是`&euml`）。

关于字符与实体引用的使用，也许最好的答案是：如果你不得不问，使用实体。但是使用这样的字符并不是真正的火箭科学，它使源代码更具可读性。

# php - 简单的 php .. 不工作...hmm 看起来很简单

> ID：10112461
> 
> 赞同：0
> 
> 时间：2012-04-11T19:17:56.693
> 
> 标签：php, javascript, html, css, xhtml

请检查以下代码：

```
<?php
   $d=2;
   echo "the sum of the number is"."<sub>($d+1)</sub>";
?> 
```

它作为输出给出：

> `the sum of the number is <sub>(2+1)</sub>`

理想情况下，我需要输出为`"the sum of the number is <sub>3</sub>"`. 当我们不使用 HTML 标签时它工作正常`<sub>`......

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T19:20:20.170

试着把它写成

```
<?php $d=2; echo "the sum of the number is"."<sub>".($d+1)."</sub>"; ?> 
```

引号给它一个字符串表示，因此不允许你执行加法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T19:20:15.727

将表达式移到引号之外：

```
<?php
   $d = 2;
   echo "the sum of the number is <sub>" . ($d+1) . "</sub>";
?> 
```

# iphone - iPhone 警报视图排除视图控制器

> ID：10112464
> 
> 赞同：0
> 
> 时间：2012-04-11T19:18:05.583
> 
> 标签：iphone, uialertview

我有一个带有许多 vie 控制器的项目，在其中一个中我创建并显示视图警报。可以在每个视图中显示警报排除一个吗？

我需要这个，因为如果您在警报视图控制器中，则不需要在警报响起时看到警报

我试试这个，但不起作用！

```
// ALERT NOTIFICATION 
if (!self.timerViewController) {
    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Piccole Ricette" message:@"READY" delegate:self cancelButtonTitle:@"OK" otherButtonTitles: nil];

    [alertView show];
    [alertView release];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:04:00.883

`window`在 iOS 中，您可以通过测试视图的属性来测试 ViewController 的视图是否可见。如果视图不可见，则 window 属性将为`nil`. 所以也许你可以做这样的事情：

```
if (!self.timerViewController.view.window) {
    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Piccole Ricette" message:@"READY" delegate:self cancelButtonTitle:@"OK" otherButtonTitles: nil];
    [alertView show];
    [alertView release];
} 
```

# php - 如何将 DOM 树从 PHP 服务器发送到客户端？

> ID：10112467
> 
> 赞同：0
> 
> 时间：2012-04-11T19:18:16.463
> 
> 标签：php, jquery, json, dom

如何将 DOM 树（包括 HTML、CSS、javascript）从 Php 服务器发送到客户端？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:34:35.013

编辑：当我再次阅读该问题时，我发现您基本上有兴趣隐藏源代码。由于这是一款游戏，您可能会拥有大量的 javascript/jQuery。如果这是你的意思，你应该研究[混淆 javascript](https://stackoverflow.com/questions/194397/how-can-i-obfuscate-javascript)

原始回复：

我理解你的问题是问你是否可以通过运行 php、js、jquery 等的组合在服务器上“创建”一个“整个”页面。如果这是一个正确的解释，那么简短的回答是否定的。如果这一切都在服务器端完成，最好只使用服务器端脚本语言。

在相关说明中，您可以在发送到客户端之前在服务器上动态生成 jQuery 代码。我不确定这是您要问的，因为整个网络由创建然后发送到用户端的页面组成......

# c++ - 如何正确使用 LoadImage 和 DeleteObject？

> ID：10112470
> 
> 赞同：2
> 
> 时间：2012-04-11T19:18:44.260
> 
> 标签：c++, winapi

我正在使用 C++ 开发 Windows 应用程序。我使用 LoadImage 将 bmp 文件加载到 DC，它正确显示。但是，当我调用 DeleteObject 时，内存似乎没有被释放。（我使用 Windows 任务管理器来跟踪内存使用情况）

在 WM_INITDIALOG 部分我这样做：

```
static HBITMAP hBitmap = 0;
char* tempPath = "tabView.bmp";  
hBitmap = (HBITMAP)LoadImage(NULL,
                             tempPath,  // file containing bitmap
                             IMAGE_BITMAP,  // type = bitmap
                             0, 0,      // original size
                             LR_LOADFROMFILE);      // get image from a file
if(hBitmap)
{
    SendMessage(GetDlgItem(hwndDlg, IDC_PICTURE),
                STM_SETIMAGE,         // message to send
                (WPARAM)IMAGE_BITMAP, // bitmap type
                (LPARAM)hBitmap);     // bitmap handle
} 
```

所以图片显示在 DC 中，并且内存增加。在一个按钮中，我这样做：

```
int result = DeleteObject(hBitmap); 
```

当我按下按钮时，我检查了结果，它是一个非零值，这就是成功。但是 IDC_PICTURE 仍然会显示图片，并且内存保持不变。我想知道 SendMessage() 是否会增加 hBitmap 上的引用计数...

所以我的问题是：清理的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:02:12.363

您没有提到您使用的是什么版本的 Windows。[无论如何，如果您阅读STM_SETIMAGE](http://msdn.microsoft.com/en-us/library/windows/desktop/bb760782%28v=vs.85%29.aspx)的“重要”部分，您将看到下一个：

> 对于 Windows XP，如果在 STM_SETIMAGE 消息中传递的位图包含具有非零 alpha 的像素，则静态控件会获取该位图的副本。这个复制的位图由下一个 STM_SETIMAGE 消息返回。客户端代码可以独立跟踪传递给静态控件的位图，但如果它不检查并释放从 STM_SETIMAGE 消息返回的位图，则位图会泄漏。

也许这不仅适用于 Windows XP，也适用于更高版本的 Windows。希望这会帮助你。

# php - 将 facebook 登录详细信息传递到数据库

> ID：10112471
> 
> 赞同：-1
> 
> 时间：2012-04-11T19:18:52.843
> 
> 标签：php, facebook, facebook-graph-api

我有这段代码可以从 facebook 用户那里获取登录信息。它在一定程度上起作用。它以数组格式获取信息并打印出来。我如何将该数组信息传递到我的数据库中？我尝试了一些东西，但似乎没有通过。谢谢。

```
 <?php
require '../src/facebook.php';
$facebook = new Facebook(array(
'appId'  => '*******************',
'secret' => '*******************************',
));

 // Get User ID
  $user = $facebook->getUser();
if ($user) {
 try {
// Proceed knowing you have a logged in user who's authenticated.
$user_profile = $facebook->api('/me');
   } catch (FacebookApiException $e) {
error_log($e);
$user = null;
  }
}

 // Login or logout url will be needed depending on current user state.
if ($user) {
$logoutUrl = $facebook->getLogoutUrl();
} else {
 $loginUrl = $facebook->getLoginUrl();
    }
 ?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
<title>php-sdk</title>
<style>
  body {
    font-family: 'Lucida Grande', Verdana, Arial, sans-serif;
  }
  h1 a {
    text-decoration: none;
    color: #3b5998;
  }
  h1 a:hover {
    text-decoration: underline;
  }
</style> 
```

```
 <a href="<?php echo $logoutUrl; ?>">Logout</a>
      <?php else: ?>
       <div>

       <a href="<?php echo $loginUrl; ?>">Login with Facebook</a>
      </div>
 <?php endif ?>

<h3>PHP Session</h3>
<pre><?php print_r($_SESSION); ?></pre>

<?php if ($user): ?>
  <h3>You</h3>
  <img src="https://graph.facebook.com/<?php echo $user; ?>/picture">

  <h3>Your User Object (/me)</h3>
  <pre><?php print_r($user_profile); ?></pre>
<?php else: ?>
  <strong><em>You are not Connected.</em></strong>
<?php endif ?>

<?
mysql_connect('localhost', '****', '****');  
mysql_select_db('***'); 
    # We have an active session; let's check if we've already registered the user  
$query = mysql_query("SELECT * FROM users WHERE oauth_provider = 'facebook' AND oauth_uid = ". $user['id']);  
$result = mysql_fetch_array($query);  

# If not, let's add it to the database 
if(empty($result)){ 
    $query = mysql_query("INSERT INTO users (oauth_provider, oauth_uid, username) VALUES ('facebook', {$user['id']}, '{$user['name']}')");  
    $query = msyql_query("SELECT * FROM users WHERE id = " . mysql_insert_id());  
    $result = mysql_fetch_array($query);  
}
session_start();
    if(!empty($user)){  
    # ...  

    if(empty($result)){  
        # ...  
    }  

    # let's set session values 
    $_SESSION['id'] = $result['id']; 
    $_SESSION['oauth_uid'] = $result['oauth_uid']; 
    $_SESSION['oauth_provider'] = $result['oauth_provider']; 
    $_SESSION['username'] = $result['username'];  
} 
if(!empty($_SESSION)){  
header("Location: login.php");  
} 

  session_start();  
if(!empty($_SESSION)){  
header("Location: done.php");  
  }
   echo 'Welcome ' . $_SESSION['username'];  
   # or..  
  echo 'Welcome ' . !empty($_SESSION) ? $_SESSION['username'] : 'guest';  
    ?>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:52:35.900

如果您给定的代码没有丢失任何内容，那么在您的代码中`$user`承载`USER_ID`和`$user_profile`变量承载用户数据。

但是在插入过程中，您使用`$user`了变量：这是错误的。在插入期间使用`$user_profile`变量，那么您应该得到预期的结果。

谢谢

# c# - 是否可以为每个视图（包括区域视图）使用一个布局页面？

> ID：10112476
> 
> 赞同：0
> 
> 时间：2012-04-11T19:19:17.617
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, razor, html-helper

我有一个布局页面`~/Views/Shared/_Layout.cshtml`，它适用于所有渲染的普通视图。但是，我创建了一个名为“Demos”的区域，并在`~/Areas/Demos/Views/_ViewStart.cshtml`文件中将其指向了我的原始布局页面。

这工作得很好，除了一些调用`@Html.ActionLink()`现在以区域名称为前缀。因此，在哪里`@Html.ActionLink("Blog", "Index", "Blog")`通常会在区域视图上生成类似“website.com/Blog/Index”的链接，它会生成“website.com/Demos/Blog/Index”。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:36:57.790

要使用区域，请打开 Global.asax 文件并将以下代码插入 Application_Start 方法

```
AreaRegistration.RegisterAllAreas(); 
```

您可以像在任何 MVC 应用程序中一样在区域内链接，但要生成到不同区域的链接，您必须在这些方法的 routeValues 参数中显式传递目标区域名称。

```
@Html.ActionLink("Blog", "Index", "Blog", new { area = "blog" }, null) 
```

`null`参数是必需的，因为具有 routeValues 参数的 ActionLink 方法重载也具有 htmlAttributes 参数，但它不是必需的，以便能够在区域之间进行链接。

**更新**

您可以使用`RouteLink()`代替`ActionLink()`, 来绕过区域注册。

```
@Html.RouteLink("Blog", "MyRoute", new { action = "Index", controller = "Blog" }) 
```

第二个参数**（“MyRoute”）**是注册的路由名称，`Global.asax`用于`RouteLink()`连接不同区域，只需要指定正确的路由名称即可。

# javascript - 单击带有 phantom.js 的链接并检索文档 html

> ID：10112477
> 
> 赞同：4
> 
> 时间：2012-04-11T19:19:27.337
> 
> 标签：javascript, jquery, ajax, phantomjs

我是 phantom.js 的新手，我正在尝试在网站页面上导航，点击带有 phantom.js 的链接（调用 AJAX 函数并更改文档 HTML）。

这是我的代码：

```
window.setTimeout(function(){
    phantom.exit();
}, 120000);

var page = require('webpage').create();

page.open("http://example.com", function(status) {
    if (status !== 'success') {
        console.log('{"error":"Unable to load the address for page"}');
        phantom.exit();
    }

    var action = page.evaluate(function() {
        document.getElementById("anID").click();
        return "clicked";
    });

    var results = page.evaluate(function() {
        return document.documentElement.innerHTML;
    });

    console.log(action);

    window.setInterval(function() {
        console.log(results);
        phantom.exit();
    }, 3000);
}); 
```

我很困惑，因为在我的“动作”函数中，click() 调用会引发该错误重复 3 次：

> TypeError: 'undefined' 不是函数
> phantomjs://webpage.evaluate():3 phantomjs://webpage.evaluate():1
> ph.js:121 null
> 
> TypeError: 'undefined' 不是函数
> phantomjs://webpage.evaluate():3 phantomjs://webpage.evaluate():1
> ph.js:121 null
> 
> TypeError: 'undefined' 不是函数
> phantomjs://webpage.evaluate():3 phantomjs://webpage.evaluate():1
> ph.js:121 null

此外，如果我在发送点击时评论该行，则操作函数不会再引发错误并很好地返回“点击”控制台日志。但是3次...

我究竟做错了什么 ？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T18:02:18.200

我终于设法用这段代码完成了我的任务。我跳过了点击动作，直接进入了 AJAX 调用：

```
 // phantomjs test.js 'http://www.example.com' 'anID'

    var system = require('system');
    var page = require('webpage').create();
    var url = system.args[1];
    var target = system.args[2];

    page.onConsoleMessage = function (msg) { 
        console.log(msg); 
        phantom.exit();
    };

    page.open(url, function (status) {
            function evaluate(page, func) {
                var args = [].slice.call(arguments, 2);
                var fn = "function() { return (" + func.toString() + ").apply(this, " + JSON.stringify(args) + ");}";
                return page.evaluate(fn);
            }
            page.injectJs('jquery-1.7.2.min.js');
            if (status === 'success') {
                    evaluate(page, function(target) {
                        $.ajax({
                          type: 'POST',
                          url: document.URL,
                          data: "__EVENTTARGET=" + target,
                          success: function(msg){
                                console.log(msg);
                            }
                        });
            }, target);
        }
    }); 
```

# java - 让 PrimeFaces JSF 在 Tomcat 上工作

> ID：10112484
> 
> 赞同：0
> 
> 时间：2012-04-11T19:19:37.710
> 
> 标签：java, tomcat, jsf-2, primefaces

我正在尝试让 PrimeFaces[多文件上传器](http://www.primefaces.org/showcase/ui/fileUploadMultiple.jsf)在 JSF 页面上工作，并且我的技术主管已经给出了以下要求（不可协商！）：

*   必须是名为 PrimeFaces/JSF 的页面`imageUpload.jsf`
*   必须部署到 WAR 并部署在 Tomcat ( `v7.0.19`)
*   必须使用以下 PrimeFaces/JSF JAR（它们是“企业架构标准”）：`jsf-api.jar`并且`jsf-impl.jar`来自 JSF 2.0.3，以及`primefaces-2.2.1.jar`

我的第一个任务是复制链接的演示页面所具有的内容 - 只是一个简单的 JSF 页面，其中包含文件上传组件。所以我创建了一个 Eclipse 项目，创建了我*认为*正确的目录结构和配置文件，使用 Ant 对其进行 WAR，然后部署到 Tomcat 的 webapps 目录。**当我转到 时`localhost:8080/imageUpload.jsf`，我收到 404（请求的资源 (/imageUpload.jsf) 不可用。）错误。**

这是我的设置：

eclipse中的项目目录结构：

```
ImageUploader
    src/
        com.company.imgupload.FileUploadController.java
    build/ --> where java compiles to and then copies over to WEB-INF/classes/
    dist/ --> where image-uploader.war gets WARed to
    lib/ --> copied to WEB-INF/lib/
    war/
        META-INF/
            MANIFEST.MF
        WEB-INF/
            classes/
            lib/
            imageUpload.xhtml
            faces-config.xml
            web.xml 
```

这`FileUploadController.java`与 PrimeFaces 人们在上面提供的演示链接上所拥有的相同 - 在我开始根据我们的需要对其进行自定义之前，我只是试图让这个简单的示例正常工作。

`web.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" >
    <welcome-file-list>
    <welcome-file>imageUpload.jsf</welcome-file>
    </welcome-file-list>
    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.jsf</url-pattern>
    </servlet-mapping>
</web-app> 
```

`faces-config.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<faces-config xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd" version="2.0">
    <!-- Not using MangedBean declarations for this simple example -->
</faces-config> 
```

`imageUpload.xhtml`：

```
<html xmlns="http://www.w3c.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.prime.com.tr/ui">
<h:head>
    <link type="text/css" rel="stylesheet" href="themes/bluesky/skin.css" />
</h:head>
<h:body>
    <center>
    <p:panel header="Multiple File Uploader Demo" style="width: 350;">
    <h:form enctype="multipart/form-data">
        <p:fileUpload fileUploadListener="#{fileUploadController.handleFileUpload}"   mode="advanced" update="messages" multiple="true" sizeLimit="100000" allowTypes="/(\.|\/)(gif|jpe?g|png)$/"/>
        <p:growl id="messages" showDetail="true"/>
    </h:form>
    </p:panel>
    <div><h:messages ></h:messages></div>
    </center>
</h:body>
</html> 
```

为了重申，这些被放置在以下 WAR 文件中：

```
image-uploader.war/
    META-INF/
        MANFIEST.MF
    WEB-INF/
        classes/
            com/company/imgupload/FileUploadController.java
        lib/
            jsf-api.jar (v2.0.3)
            jsf-impl.jar (v2.0.3)
            primefaces-2.2.1.jar
        web.xml
        faces-config.xml
        imageUpload.xhtml 
```

这场战争随后被部署到`${CATALINA.HOME}/webapps/`. 当我运行 Tomcat 时，我在日志中没有收到任何错误或警告，但我确实在`catalina.<date>.log`（我在 Windows 7 上）看到了这一点：

> 2012 年 4 月 11 日下午 2:31:33 org.apache.catalina.startup.HostConfig deployWAR
> 
> 信息：部署 Web 应用程序存档 image-uploader.war
> 
> 2012 年 4 月 11 日下午 2:31:34 com.sun.faces.config.ConfigureListener contextInitialized
> 
> 信息：为上下文“/image-uploader”初始化 Mojarra 2.0.3 (FCS b03)
> 
> 2012 年 4 月 11 日下午 2:31:34 com.sun.faces.spi.InjectionProviderFactory createInstance
> 
> 信息：JSF1048：存在 PostConstruct/PreDestroy 注释。标有这些注解的 ManagedBeans 方法将表示已处理的注解。

我在这里缺少任何其他配置文件吗？我是否需要`imageUpload.jsf`在（或代替）之上有一个`imageUpload.xhtml`？

**什么解释了我得到的这个 404 错误？！？**提前致谢。

**注意：**除非*不可能*让 PrimeFaces/JSF 在我指出的 JAR 版本下工作，否则请尊重我对我们的标准没有任何发言权。如果我能证明 JSF 2.0.3 与 PrimeFaces 2.2.1 不兼容，那么我可能可以说服技术人员改变标准。但除非我能证明这一点，否则这些是我坚持使用的版本和技术——所以*请*不要用“*你为什么要选择该技术*”或“*你为什么要使用旧版本*”类型的回答来混淆 SO！

**编辑**：

更改了我`web.xml`以反映@Luigi 的建议，并且（根据@Matt 的建议）将我的浏览器指向`localhost:8080/image-uploader/imageUploader.jsf`并且没有收到 HTTP 500 错误：

```
SEVERE: Servlet.service() for servlet [Faces Servlet] in context with path [/image-uploader] threw exception [javax/servlet/jsp/jstl/core/Config] with root cause
java.lang.ClassNotFoundException: javax.servlet.jsp.jstl.core.Config
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1678)
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)
at com.sun.faces.application.view.JspViewHandlingStrategy.executePageToBuildView(JspViewHandlingStrategy.java:340)
at com.sun.faces.application.view.JspViewHandlingStrategy.buildView(JspViewHandlingStrategy.java:150)
...etc. 
```

这对任何人都意味着什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T06:13:18.840

首先要知道 Primefaces 展示展示了最新的 Primefaces 发布版本。如果可以使用所有给定属性上传文件，您应该查看[Primefaces 文档以了解 2.2.1 版本。](http://www.primefaces.org/documentation.html)

然后（如 Luigi 所述），您必须确保 web.xml 中的 faces servlet 映射与项目中的文件匹配。

最后到您的请求网址。我没有使用 Tomcat，但在 Glassfish 中，您有一个应用程序部署到的上下文根。上下文根需要是您的 url 的一部分，并且通常与您的 war 文件名相同（您可以更改它，但我不知道在哪里为 Tomcat 执行此操作）。

因此，假设上下文根与您的战争文件名相同，您应该尝试：

```
localhost:8080/image-uploader/imageUpload.jsf 
```

# python - 实施替代形式的 LDA

> ID：10112500
> 
> 赞同：7
> 
> 时间：2012-04-11T19:20:25.363
> 
> 标签：python, r, nlp, text-mining, lda

我正在使用潜在狄利克雷分配与来自六个不同来源的新闻数据语料库。我对主题的演变、出现很感兴趣，并想比较这些来源随着时间的推移是如何相似和不同的。我知道有许多修改过的 LDA 算法，例如 Author-Topic 模型、Topics Over Time 等等。

我的问题是这些替代模型规范中很少以任何标准格式实现。一些在 Java 中可用，但大多数仅作为会议论文存在。自己实现其中一些算法的最佳方法是什么？我对 R 和 jags 相当精通，并且只要给予足够长的时间，我就会在 Python 中跌跌撞撞。我愿意编写代码，但我真的不知道从哪里开始，也不知道 C 或 Java。我可以仅使用手稿中的公式在 JAGS 或 Python 中构建模型吗？如果是这样，有人可以指出我这样做的一个例子吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T15:48:40.290

我朋友的回复如下，请原谅语言。

> 首先，我编写了一个折叠的 Gibbs 采样器的 Python 实现，在此处 (http://www.pnas.org/content/101/suppl.1/5228.full.pdf+html) 中看到并在此处充实了 (http:// cxwangyi.files.wordpress.com/2012/01/llt.pdf)。这就像球一样慢。
> 
> 然后我使用了本文的 C 实现的 Python 包装（http://books.nips.cc/papers/files/nips19/NIPS2006_0511.pdf）。这和 f*ck 一样快，但结果不如 NMF 看到的那么好。
> 
> 但是我见过的 NMF 实现，使用 scitkits，甚至使用最近发布的与 scipy sparse 兼容的 NIMFA 库，它们都在任何大型语料库上炸毁了 f*ck。我的新白鲸是一个切片的分布式实现。这将是不平凡的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-16T16:20:54.050

在 Python 中，你知道[PyMC](http://pymcmc.readthedocs.org/en/latest/index.html)吗？它可以灵活地指定模型和拟合算法。

此外，当从 R 和 JAGS 开始时，还有一个[关于“在 R 中使用 JAGS 和 rjags 包”的教程](http://www.r-bloggers.com/using-jags-in-r-with-the-rjags-package/)以及[一系列示例](http://www.r-bloggers.com/using-jags-in-r-with-the-rjags-package/)。

# javascript - 使用 jQuery UI Selectable 仅选择以下元素

> ID：10112502
> 
> 赞同：0
> 
> 时间：2012-04-11T19:20:32.057
> 
> 标签：javascript, jquery, jquery-ui

我有一个包含一些行和单元格的表格。使用 jQuery UI Selectable 我如何自定义选择，因此只能选择彼此跟随的单元格。如果不选择之间的单元格，就不可能跨行垂直选择单元格。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:48:55.193

使用`selected`回调将类添加到所选元素；您将用于 tie 的类`.selectable()`。然后你可以结合使用[下一个兄弟选择器](http://api.jquery.com/next-siblings-selector/)，你应该能够完成你需要的。

首先，您将需要以下内容：

```
<ol>
    <li class="ui-widget-content ui-selectee">Item 1</li>
    <li class="ui-widget-content">Item 2</li>
    <li class="ui-widget-content">Item 3</li>
    <li class="ui-widget-content">Item 4</li>
    <li class="ui-widget-content">Item 5</li>
    <li class="ui-widget-content">Item 6</li>
    <li class="ui-widget-content">Item 7</li>
</ol> 
```

然后，当你选择一个会触发回调的时候，你想让第二个成为可选的。

```
<ol>
    <li class="ui-widget-content ui-selectee ui-selected">Item 1</li>
    <li class="ui-widget-content ui-selectee">Item 2</li>
    <li class="ui-widget-content">Item 3</li>
    <li class="ui-widget-content">Item 4</li>
    <li class="ui-widget-content">Item 5</li>
    <li class="ui-widget-content">Item 6</li>
    <li class="ui-widget-content">Item 7</li>
</ol> 
```

等等。

# javascript - 使用 jQuery 读取文本文件

> ID：10112509
> 
> 赞同：22
> 
> 时间：2012-04-11T19:20:49.440
> 
> 标签：javascript, jquery

> **可能重复：**
> [jquery - 读取文本文件？](https://stackoverflow.com/questions/1981815/jquery-read-a-text-file)

我想使用 jQuery 读取本地文本文件。所以我试试这个：

```
$.get('file_to_read.txt', function(data) {
   do_something_with(data)
}); 
```

但是，jQuery 将“file_to_read.txt”解释为 html 文件，我收到 Javascript 错误，因为它的格式不正确，并且“do_something_with”没有达到预期的效果，因为数据不是字符串。

jQuery 文档说我需要指定数据类型。但是，他们只列出了 html、xml、json 和 script 作为可能的数据文件；我应该如何处理我想直接加载到字符串中的纯 txt 文件？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-11T19:23:43.410

`'text'`在您的`$.get()`请求中使用数据类型。

```
$.get('file_to_read.txt', function(data) {
   do_something_with(data)
}, 'text');
 //  ^------last argument 
```

否则 jQuery 会猜测返回的内容。

* * *

记住，`$.get`只是`$.ajax`. [`$.ajax()`数据类型在文档](http://api.jquery.com/jQuery.ajax/)中列出...

> **数据类型**
> 
> 默认值：智能猜测（xml、json、脚本或 html）
> 
> 您期望从服务器返回的数据类型。如果没有指定，jQuery 将尝试根据响应的 MIME 类型推断它（XML MIME 类型将产生 XML，在 1.4 中 JSON 将产生一个 JavaScript 对象，在 1.4 中脚本将执行脚本，其他任何东西都会作为字符串返回）。可用的类型（以及作为第一个参数传递给成功回调的结果）是：
> 
> “xml”：返回一个可以通过 jQuery 处理的 XML 文档。
> 
> “html”：以纯文本形式返回 HTML；包含的脚本标签在插入 DOM 时进行评估。
> 
> “脚本”：将响应评估为 JavaScript，并将其作为纯文本返回。通过将查询字符串参数“_=[TIMESTAMP]”附加到 URL 来禁用缓存，除非缓存选项设置为 true。注意：这会将 POST 转换为远程域请求的 GET。
> 
> “json”：将响应评估为 JSON 并返回一个 JavaScript 对象。在 jQuery 1.4 中，JSON 数据以严格的方式解析；任何格式错误的 JSON 都会被拒绝并引发解析错误。（有关正确的 JSON 格式的更多信息，请参阅 json.org。）
> 
> “jsonp”：使用 JSONP 加载到 JSON 块中。添加一个额外的“？callback =？” 到 URL 的末尾以指定回调。通过将查询字符串参数“_=[TIMESTAMP]”附加到 URL 来禁用缓存，除非缓存选项设置为 true。
> 
> **“文本”：纯文本字符串。**
> 
> 多个空格分隔的值：从 jQuery 1.5 开始，jQuery 可以将 dataType 从它在 Content-Type 标头中接收到的内容转换为您需要的内容。例如，如果您希望将文本响应视为 XML，请使用“text xml”作为 dataType。您还可以发出 JSONP 请求，将其作为文本接收，并由 jQuery 解释为 XML：“jsonp text xml”。类似地，诸如“jsonp xml”之类的速记字符串将首先尝试从 jsonp 转换为 xml，如果失败，则从 jsonp 转换为文本，然后从文本转换为 xml。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:24:30.440

尝试 dataType "text" (或 "html"，如果你没有 html "script" 标签，它应该可以工作)

# python - python 2.6 vr中的列表理解和lambda表达式。蟒蛇2.7

> ID：10112511
> 
> 赞同：1
> 
> 时间：2012-04-11T19:20:52.390
> 
> 标签：python, python-2.6

我正在尝试将针对 python 2.7 编写的代码反向移植到 python 2.6 中（原因是应该运行代码的服务器只有 python 2.6，并且管理员拒绝安装 python 2.7 或更高版本）。

一般来说，这工作得很好，但我发现了以下问题。在原始代码中的行（或类似的东西）：

```
g = lambda x : ['{:d}'.format(i) for i in x]
g([1,2,3,4]) 
```

工作正常。但是，在 python 2.6 中，它们会产生错误。我在文档中找不到有关此主题的任何信息。

是什么原因？这个问题有没有简单的解决方案，即等效（相同语义）但使用不同语法的 lambda 表达式的定义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T19:29:36.280

在 Python 2.6 中，字段名称是必需的（请参阅[格式化字符串语法](http://docs.python.org/release/2.6.7/library/string.html#formatstrings)）。在 Python 2.7+ 中，[可以省略](http://docs.python.org/library/string.html#formatstrings)：

> *在 2.7 版更改:*位置参数说明符可以省略，因此`'{} {}'`等效于`'{0} {1}'`.

因此，如果您希望您的代码与 Python 2.6 兼容，请按如下方式编写：

```
g = lambda x : ['{0:d}'.format(i) for i in x]
g([1,2,3,4]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:27:09.250

在 2.6 中，`str.format()` *必须*有一个位置说明符。

```
g = lambda x : ['{0:d}'.format(i) for i in x] 
```

# python - 在谷歌应用引擎上运行 mapreduce 作业

> ID：10112515
> 
> 赞同：0
> 
> 时间：2012-04-11T19:20:58.297
> 
> 标签：python, google-app-engine

我正在运行 mapreduce 框架附带的演示。它给了我一个错误：

```
 File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/ext/webapp/_webapp25.py", line 703, in __call__
    handler.post(*groups)
  File "/path/to/mapreduce/base_handler.py", line 68, in post
    self.handle()
  File "/path/to/mapreduce/handlers.py", line 431, in handle
    self.aggregate_state(state, shard_states)
  File "/path/to/mapreduce/handlers.py", line 462, in aggregate_state
    context.COUNTER_MAPPER_CALLS))
  File "/path/to/mapreduce/model.py", line 257, in get
    return self.counters.get(counter_name, 0)
AttributeError: 'list' object has no attribute 'get' 
```

这是我做错了什么，演示不起作用吗？其他地方有更多更新的代码吗？

这是使用来自[http://appengine-mapreduce.googlecode.com/svn/trunk/的代码](http://appengine-mapreduce.googlecode.com/svn/trunk/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:46:27.780

不熟悉该代码，但最新代码是您可以从 SDK 下载的 MapReduce Bundle： [https ://developers.google.com/appengine/downloads](https://developers.google.com/appengine/downloads)

它带有一些演示。我能够遵循这个并让它工作： [http ://code.google.com/p/appengine-mapreduce/wiki/GettingStartedInPython](http://code.google.com/p/appengine-mapreduce/wiki/GettingStartedInPython)

这是我在尝试运行 MapReduce 时的一些附加说明。 [http://eatdev.tumblr.com/post/17983355135/using-mapreduce-with-django-nonrel-on-app-engine](http://eatdev.tumblr.com/post/17983355135/using-mapreduce-with-django-nonrel-on-app-engine)

# c# - CommunicationState 监听器？

> ID：10112518
> 
> 赞同：3
> 
> 时间：2012-04-11T19:21:02.663
> 
> 标签：c#, wcf, events

有谁知道为代理创建侦听器的方法，以便在 CommunicationState 发生更改时我可以调用操作或方法？

例如，我想更新我的 WCF 服务以进行代码更改。由于应用程序处于其早期开发阶段，代码更改非常频繁。然而，与其用电子邮件来烦扰我的员工，不如告诉他们，嘿，他们需要重新启动他们的应用程序。我宁愿避免他们不得不重新启动应用程序并不得不向他们发送电子邮件。我宁愿编写一个监听器来查看服务的通信状态，如果它已更改为错误状态，则尝试重新连接。

**编辑**

也许这里有更多的上下文。

```
InstanceContext context = new InstanceContext(this);
Subscriber = new SubscriptionService.MySubscriptionServiceClient(context);
Subscriber.Subscribe(""); 
```

所以基本上我想知道订阅服务何时停止，以便我可以尝试每 60 秒左右重新连接一次。我尝试在订阅者服务中查找事件，但什么也没看到。我需要在服务端实现一些东西吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:57:32.997

`InnerChannel`您可以使用生成的客户端类的属性上可用的故障事件。客户端类的`State`属性只是 的包装器`InnerChannel.State`，因此它应该可以按您的意愿工作。

`ChannelFactory<TChannel>`（作为参考，如果您在代码中创建通信通道而不是使用生成的代理，也可以使用类似命名的事件。）

# mercurial - 限制用户将更改集推送到默认值 (Mercurial)

> ID：10112521
> 
> 赞同：1
> 
> 时间：2012-04-11T19:21:28.893
> 
> 标签：mercurial, branch

我想限制某些用户将变更集推送到存储库的默认分支。如果有可能，你会怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T09:17:58.487

[ACL 扩展](https://www.mercurial-scm.org/wiki/AclExtension)应该适合您。但是，您需要考虑以下注意事项：

*   必须在服务器存储库中启用扩展。也就是说，`hgrc`每个服务存储库的文件都应该定义 ACL 设置：

    ```
    [extensions]
    acl =

    [hooks]
    pretxnchangegroup.acl = python:hgext.acl.hook

    [acl]
    sources = serve

    [acl.deny.branches]
    default = user1, user2, user3 
    ```

*   这些拒绝推送的用户是*系统*用户。也就是说，在您的情况下，用户名取自 Web 服务器提供的凭据。它与提交元数据中的字段**无关。**`Author:`

*   您只能允许或拒绝完整*的 chagegroups*。如果您的一个被拒绝的用户将一组包含**单个**提交的提交推送到默认分支，则整个推送将被拒绝（即使其他提交被允许）。如果您的用户倾向于经常与默认分支合并，这并不奇怪。

您也可以编写自己的`pretxnchangegroup`钩子，但您不会比 ACL 扩展更有能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-08T15:35:16.180

当前答案将在您推送时检查（并且检查是服务器端，就像我从 acl 代码中组成的那样）。您想要的是检查对本地存储库的提交。为此，您应该制作一个“pretxncommit”-hook（注意有多种钩子作用于不同的事件）。

请执行下列操作：

根据[一个成功的 Git 分支模型](https://nvie.com/posts/a-successful-git-branching-model/)，master 上不应该有直接提交，只有合并。为了强加这一点，我们可以向 mercurial 添加一个回调钩子来检查提交，如果它们直接在 master 上，则禁止它们。为此，在项目的 .hg/hgrc 中添加以下代码行：

```
[hooks]
pretxncommit.nocommittomasterhook = python:%USERPROFILE%\hgnocommittomaster.py:nocommittomaster 
```

在您的 Windows 主目录中创建`hgnocommittomaster.py`包含内容的文件“”（[原始示例](https://www.mercurial-scm.org/wiki/HookExamples)）：

```
from mercurial.node import bin, nullid
from mercurial import util

# Documentation is here: https://www.mercurial-scm.org/wiki/MercurialApi
# Script based on: https://www.mercurial-scm.org/wiki/HookExamples

def nocommittomaster(ui, repo, node, **kwargs):
    n = bin(node)
    start = repo.changelog.rev(n)
    end = len(repo.changelog)
    failed = False
    for rev in xrange(start, end):
        n = repo.changelog.node(rev)
        ctx = repo[n]
        p = ctx.parents()
        if ctx.branch()  == 'master' and len(p) == 1:
            if p[0].branch() != 'master':
                # commit that creates the branch, allowed
                continue
            if len(ctx.files()) == 0 and len(ctx.tags()) == 1:  # will not hit?, '.hgtags' always changed?
                continue    # Only a tag is added; allowed.
            elif len(ctx.files()) == 1 and len(ctx.tags()) == 1:
                if ctx.files()[0] == '.hgtags':
                    continue    # Only a tag is added; allowed.
            ui.warn(' - changeset rev=%d (%s) on stable branch and is not a merge !\n' % (rev,ctx))
            failed = True
    if failed:
        ui.warn('* Please strip the offending changeset(s)\n'
                '* and re-do them, if needed, on another branch!\n')
        return True 
```

这篇文章的灵感来自：[Mercurial pre-commit hook](https://stackoverflow.com/questions/4162384/mercurial-pre-commit-hook)和[Mercurial Pre-Commit Hook: How to hook to python program in current directory？](https://stackoverflow.com/questions/6829112/mercurial-pre-commit-hook-how-to-hook-to-python-program-in-current-directory)

# c# - 我需要一些帮助来为我的 windows phone 7.5 应用程序选择数据库类型吗？

> ID：10112526
> 
> 赞同：0
> 
> 时间：2012-04-11T19:21:42.077
> 
> 标签：c#, xml, database

我正在 windows phone 7.5 上开发应用程序，但我不确定我应该使用什么样的数据库！XML，SQlite Client，或ant其他类型的数据库，我的应用程序有超过16个表，我用c#开发这个应用程序，我在选择数据库时遇到了问题，希望有人能帮我选择合适的数据库类型。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:32:27.877

为了知道哪种数据库类型更适合您，就是了解此类数据库。

XML 不是关系数据库，它只是一个带有 xml 格式数据的文件。所以忘记你的解决方案中是否需要 16 个表。

除了 SQL Lite，您还可以选择使用 SQL Server CE。第一个是跨平台和开源的，第二个不是。但是我已经使用 SQL Server CE 很长时间了，我认为这可以满足您的需求。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:33:53.937

Windows Phone Mango Update（又名 7.5）引入了对[LINQ to SQL](http://msdn.microsoft.com/en-us/library/hh202872%28v=vs.92%29.aspx)的支持作为内置持久性解决方案，包括完整的 LINQ 支持，我建议您使用它，直到您有充分的理由不使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:31:19.263

使用内置的[本地数据库](http://msdn.microsoft.com/en-us/library/hh202860%28v=vs.92%29.aspx)非常容易使用。

# android - 在另一个活动上检查 isPlaying()

> ID：10112527
> 
> 赞同：0
> 
> 时间：2012-04-11T19:21:51.610
> 
> 标签：android, audio, media-player

我在活动 A 中开始了一个声音，并想在活动 B 中停止它。我该怎么做？

这是我用来启动声音的代码：

```
MediaPlayer mp = MediaPlayer.create(con, R.raw.siren1);
mp.start(); 
```

谢谢。

编辑：这是解决方案：

活动一

```
static MediaPlayer mp;
.........
mp = MediaPlayer.create(con, R.raw.siren1);
mp.start(); 
```

活动 B

```
confirmButton.setOnClickListener(new View.OnClickListener() {
public void onClick(View view) {
        if (SmsReceiver.mp.isPlaying() == true) {
    SmsReceiver.mp.stop();
    }
finish();
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:26:23.553

您可以将 MediaPlayer 对象声明为静态，然后从其他活动中引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:27:37.157

您可能应该在静态类（单例设计）中跟踪您的 MediaPlayer 对象。这样，您可以从任何地方访问该对象。看看这个：[单例设计](http://www.javaworld.com/javaworld/jw-04-2003/jw-0425-designpatterns.html)

# php - 我需要将 301 的 url 写入会话变量

> ID：10112530
> 
> 赞同：1
> 
> 时间：2012-04-11T19:22:01.383
> 
> 标签：php, .htaccess, mod-rewrite

设想：

我有一个链接是

```
example/directory/go.php 
```

我正在 301 将该链接重定向到

```
example/go.php 
```

我使用会话变量来跟踪用户的路径。没有在 url 中放置任何变量，有没有办法我仍然可以在用户访问的会话中跟踪

```
example/directory/go.php 
```

或者更确切地说是打算去那里，但显然是301'd

```
example/go.php? 
```

现在当我 var_dump 我的会话变量时，它总是将他们访问的最后一页显示为

```
example/go.php. 
```

我想这是有道理的，因为它是用 mod_rewrite 重定向的，但我只是想看看是否仍然可以在我的会话变量中或通过其他方式看到重定向的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:26:59.730

使用 mod_rewrite，您可以将 cookie 设置为之前的 URL 作为值，然后在最终的 PHP 脚本中获取 cookie 值。

# c# - 使用 Newtonsoft 的 Monotouch 无法正常工作

> ID：10112533
> 
> 赞同：1
> 
> 时间：2012-04-11T19:22:13.530
> 
> 标签：c#, xamarin.ios

我对 Monotouch/iOS 开发非常陌生。我在用着

```
========== 
MonoDevelop 2.8.8.4 
Installation UUID: 0d3db625-7df9-4282-9aa6-177c25a46d07 
Runtime: 
        Mono 2.10.9 (tarball Tue Mar 20 15:31:37 EDT 2012) 
        GTK 2.24.10 
        GTK# (2.12.0.0) 
Mono for Android not installed 
Apple Developer Tools: 
         Xcode 4.2.1 (834) 
         Build 4D502 
Monotouch: 5.2.10 (Evaluation) 
========== 
```

我正在尝试使用 Newtonsoft 3.5 all 将对象序列化为 json 字符串。

非常简单的代码，但不起作用..任何人都可以帮助我...

```
partial void Action_Clicked (MonoTouch.Foundation.NSObject sender) 
{ 
    myDTO test = new myDTO(); 
    string teststring = ObjToJSON(test); 
} 

public string ObjToJSON(myDTO oObject)   //Old function name is ObjToJSON_WithWrapper 
{ 
    string sJSON = ""; 
    sJSON = Newtonsoft.Json.JsonConvert.SerializeObject(oObject); 
    return sJSON; 
} 

public myDTO JSONToObj(String JSONString) //Old function name is JSONToObjNew 
{ 
    myDTO deseri =  JsonConvert.DeserializeObject<myDTO>(JSONString); 
    return deseri; 
} 

public class myDTO 
{ 
    public myDTO() 
    { 
    } 

    public string StringObject {get; set;} 
} 
```

以上是我的简单测试代码，但运行时出现错误 Newtonsoft.Json.JsonConvert.SerializeObject(oObject);

```
***  ERROR*** 

{System.TypeLoadException: A type load exception has occurred.  
    at Newtonsoft.Json.Utilities.ThreadSafeStore`2[System.Type,System.Type].AddValue System.Type key) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Utilities.ThreadSafeStore`2[System.Type,System.Type].Get (System.Type key) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.JsonTypeReflector.GetAssociatedMetadataType (System.Type type) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.JsonTypeReflector.GetAttribute[JsonContainerAttribute] (System.Type type) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.JsonTypeReflector.GetAttribute[JsonContainerAttribute] (ICustomAttributeProvider attributeProvider) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Utilities.ThreadSafeStore`2[System.Reflection.ICustomAttributeProvider,Newtonsoft.Json.JsonContainerAttribute].AddValue (ICustomAttributeProvider key) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Utilities.ThreadSafeStore`2[System.Reflection.ICustomAttributeProvider,Newtonsoft.Json.JsonContainerAttribute].Get (ICustomAttributeProvider key) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.CachedAttributeGetter`1[Newtonsoft.Json.JsonContainerAttribute].GetAttribute (ICustomAttributeProvider type) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.JsonTypeReflector.GetJsonContainerAttribute (System.Type type) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.JsonTypeReflector.GetJsonObjectAttribute (System.Type type) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.DefaultContractResolver.CreateContract (System.Type objectType) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.DefaultContractResolver.ResolveContract (System.Type type) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.GetContractSafe (System.Object value) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.JsonSerializer.SerializeInternal (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.JsonSerializer.Serialize (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.JsonConvert.SerializeObject (System.Object value, Formatting formatting, Newtonsoft.Json.JsonSerializerSettings settings) [0x00000] in <filename unknown>:0  
    at Newtonsoft.Json.JsonConvert.SerializeObject (System.Object value) [0x00000] in <filename unknown>:0  
    at JSONTest1.JSONTest1ViewController.ObjToJSON (JSONTest1.myDTO oObject) [0x00006] in /Users/developer/Projects/JSONTest1/JSONTest1/JSONTest1ViewController.cs:61  
    at JSONTest1.JSONTest1ViewController.Action_Clicked (MonoTouch.Foundation.NSObject sender) [0x00006] in /Users/developer/Projects/JSONTest1/JSONTest1/JSONTest1ViewController.cs:52    at (wrapper managed-to-native) MonoTouch.UIKit.UIApplication:UIApplicationMain (int,string[],intptr,intptr)  
    at MonoTouch.UIKit.UIApplication.Main (System.String[] args, System.String principalClassName, System.String delegateClassName) [0x00042] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIApplication.cs:29  
    at JSONTest1.Application.Main (System.String[] args) [0x00000] in /Users/developer/Projects/JSONTest1/JSONTest1/Main.cs:17 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:18:09.960

MonoTouch 需要此版本的 Newtonsoft：

[https://github.com/ayoung/Newtonsoft.Json](https://github.com/ayoung/Newtonsoft.Json)

# mysql - Rails 查询阻塞包含

> ID：10112537
> 
> 赞同：0
> 
> 时间：2012-04-11T19:22:27.337
> 
> 标签：mysql, ruby-on-rails

这个查询执行得很好：

```
p = PlayersToTeam.select("id").joins(:player).limit(10).order("players.FirstName") 
```

这个查询导致我的整个系统突然停止：

```
p = PlayersToTeam.select("id").includes(:player).limit(10).order("players.FirstName") 
```

以下是模型：

```
class PlayersToTeam < ActiveRecord::Base
  belongs_to :player
  belongs_to :team

  accepts_nested_attributes_for :player
end

class Player < ActiveRecord::Base
  has_many :players_to_teams
  has_many :teams, through: :players_to_teams
end 
```

据我所知，`includes`做 a`LEFT JOIN`和`joins`做 a `INNER JOIN`。`joins`从 Rails输出的查询 (for ) 是：

```
SELECT players_to_teams.id FROM `players_to_teams` INNER JOIN `players` ON `players`.`id` = `players_to_teams`.`player_id` ORDER BY players.FirstName LIMIT 10 
```

在命令行上执行得很好。

```
SELECT players_to_teams.id FROM `players_to_teams` LEFT JOIN `players` ON `players`.`id` = `players_to_teams`.`player_id` ORDER BY players.FirstName LIMIT 10 
```

也执行得很好，只需要两倍的时间。

有没有一种有效的方法可以通过 对`players_to_teams`记录进行排序`players`？我有一个关于`FirstName`for的索引`players`。

**编辑**

原来查询需要大量优化才能正常运行。拆分查询是没有重组数据或自定义查询的最佳解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:50:38.343

需要注意的一件事是，这`include`将添加第二个数据库访问权限来进行预加载。你应该检查那个看起来像什么（它应该包含一个关于from的大`IN`声明）。`player_ids``players_to_teams`

至于如何避免使用`include`，如果你只需要来自的名称`players`，你可以这样做：

```
PlayersToTeam.select("players_to_teams.id, players.FirstName AS player_name").joins(:player).limit(10).order("players.FirstName") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:20:19.557

您也可以考虑将其拆分为 2(3) 个查询。首先 - 通过连接排序来获取 id：

```
players_to_teams = PlayersToTeam.select("id").joins(:player).limit(10).order("players.FirstName") 
```

第二个（里面包含 2 个查询）-`PlayersToTeams`预装玩家。

```
players_to_teams = PlayersToTeam.include(:player).where(:id => players_to_teams.map(&:id)) 
```

因此，在那之后，您将完全初始化`players_to_teams`并加载和初始化播放器。

# php - 从 datebirth sql 字段计算年龄

> ID：10112538
> 
> 赞同：-3
> 
> 时间：2012-04-11T19:22:34.957
> 
> 标签：php, mysql

> **可能重复：**
> [在 MySQL (InnoDb) 中计算年龄](https://stackoverflow.com/questions/5773405/calculate-age-in-mysql-innodb)

我创建了一个表，其中一列是“dob”（出生日期）。它以 0000-00-00 格式在表格中输入出生日期。但我需要用年龄而不是 0000-00-00 格式显示我的用户 ($id)。

我当前的页面以这种格式显示来自我的数据库的信息。它将显示不同用户的年龄。

`<td align="center"><? echo $rows['age']; ?></td>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:34:34.983

这是您可以使用的 SQL 查询。

```
SELECT EXTRACT(YEAR FROM (FROM_DAYS(DATEDIFF(NOW(), '1982-01-01')))) AS age 
```

# css - 为什么我的 CSS 文件没有加载？

> ID：10112542
> 
> 赞同：0
> 
> 时间：2012-04-11T19:23:03.387
> 
> 标签：css, codeigniter-2

我正在使用以下代码在我的 codeigniter 网站中加载我的 css 文件。

```
<link rel="stylesheet" type="text/css" href="<?php $base_url?><?php $css?>style.css" /> 
```

在我的`config.php`我已经使用了这个代码。

```
$config['base_url'] = 'http://localhost/mysite';
$config['css']  = "/assets/css/"; 
```

但是css没有加载。

我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T19:25:42.530

尝试

```
<link rel="stylesheet" type="text/css" href="<?php echo $base_url; ?><?php echo $css; ?>style.css" /> 
```

# twitter - 如果我通过 Twitter API 转发了另一个用户的推文，最好的解决方法是什么？

> ID：10112543
> 
> 赞同：2
> 
> 时间：2012-04-11T19:23:03.820
> 
> 标签：twitter

因此，我目前正在开发一个应用程序，该应用程序允许我搜索记者并查看他们的联系方式，其中包括他们最新的推文。

调用 Twitter API 完全没有问题，我有一个当前 journo 的推文列表显示得很好。但是，我正在尝试确定查看我（登录到我们的应用程序的用户）是否转发了 journo 的任何推文的最佳方法，以便我可以将推文显示为已被转发。

查看 API 文档，我正在研究以下选项：

> 1 - 使用[/statuses/retweeted_by_me](https://dev.twitter.com/docs/api/1/get/statuses/retweeted_by_me)获取我转发的推文列表，指定**max_id**为我正在查看的 journo 推文列表中的最高 id。我在这里不确定的是 max_id 是否会受到我的推文的最大 ID 或转发推文的最大 ID 的限制。
> 
> 2 - 对 journo 的每条推文使用[/statuses/:id/retweeted_by](https://dev.twitter.com/docs/api/1/get/statuses/%3aid/retweeted_by)以获取所有转发该推文的用户的列表，并检查我的用户是否在返回的用户列表中。这样做的缺点是可能有数千个转发者，而我一次最多只能返回 100 个。这可能意味着很多请求只是为了查找我是否转发了一条推文。这也意味着我需要对 journo 的每条推文都执行此操作，而不是获取上面所有我的 rewteets 的列表。
> 
> 3 - 使用[/statuses/retweets/:id](https://dev.twitter.com/docs/api/1/get/statuses/retweets/%3aid)获取 journo 的每条推文的转推列表。此选项具有与#2 相同的限制。

我目前倾向于＃1，但是，我还不确定这是否可行。我需要做更多的调查。同时，我对你的问题是：

**如果我转发了其他用户的推文，最好的解决方法是什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T09:59:47.333

好的，所以我昨天调查这个时一定有一个大脑放屁的时刻。今天早上我突然想到，如果你转发了这条推文，你可以简单地进行一个经过身份验证的调用`/statuses/user_timeline`，将属性设置为 true。`retweeted`

简单的。

# grails - 如何在 Grails 服务上调用初始化函数？

> ID：10112547
> 
> 赞同：23
> 
> 时间：2012-04-11T19:23:30.807
> 
> 标签：grails

我有一个 Grails 服务，它是一个相当复杂的单例对象的包装器。我想做一些初始化以在服务启动时填充单例。如果服务启动时会自动调用某种 init() 函数，那就太好了，但我没有发现这样的事情。

有没有一种干净的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-11T19:39:21.070

您可以`InitializingBean`按照@Saurabh 的描述实现，但它在 Grails 启动过程的早期触发，所以虽然它工作，但有些东西还不可用，例如，您不能在域类中调用 GORM 方法，因为在 bean 初始化之后发生。如果`InitializingBean`还不够，您可以从 调用初始化方法`BootStrap.groovy`，例如

```
class BootStrap {

   def myService

   def init = { servletContext ->
      myService.initialize()
   }
} 
```

`initialize`您可以在服务类中调用该方法或您想要的任何内容。`BootStrap`如果您不想在服务类中使用该代码，也可以直接在其中进行初始化工作。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-10-21T14:39:26.063

我使用标准的 PostConstruct 注释：

```
class MyService {    

    @PostConstruct
    def init() {
      // GORM accesible from here
    }

} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-04-11T19:33:55.457

服务器可以实现 InitializingBean 来做一些初始化

```
public class AbcService implements InitializingBean {

    public void afterPropertiesSet() throws Exception {

    //initialization logic goes here
     }

   }    
} 
```

# c# - ISerializable - 序列化单例

> ID：10112556
> 
> 赞同：4
> 
> 时间：2012-04-11T19:24:08.640
> 
> 标签：c#, serialization, iserializable

ISerializable 接口只提供了一种序列化对象的方法。反序列化过程由构造函数管理。

问题是，构造函数不能返回实例，因为构造函数创建了一个新实例。

在我的实现中，有几个属性对应于在其他地方实例化和维护的单例。

我需要反序列化过程来获取该实例并分配给属性，而不是创建一个新实例。

构造函数方法不适合这种情况。

在 Java 中，您将调用 ReadResolve() 方法，是否有 C# 等效项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:38:42.723

您需要使保存对单例的引用的类实现 IObjectReference。

看看[http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iobjectreference.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iobjectreference.aspx)

# c++ - g++和msvc中使用ifstream读取文件的区别

> ID：10112557
> 
> 赞同：3
> 
> 时间：2012-04-11T19:24:10.143
> 
> 标签：c++, stream, filestream, std, ifstream

当使用 ifstream 类从输入文件中读取单词时，我使用了以下表达式：

```
 #include <iostream>
 #include <fstream>

 int main(int argc, char *argv[])
 {
   std::ifstream inputStream(myFile.txt);
   std::string myString;
   myFile.open()
   while(myFile.good())
   {
      myFile >> myString;
      printf("%s \n", myString);
   }
   return 0;
 } 
```

myFile.txt 的内容是：“这是一个简单的程序。”

使用 g++ 编译器按预期编译和执行。

但是，使用 msvc 2008 编译相同的代码时，在提取运算符 (>>) 处返回错误，要求我将 std::string 替换为已初始化的字符数组或任何受支持的本机类型。
这让我大吃一惊，因为我期望标准库的使用在不同的实现中是相同的。
我了解编译错误并知道通过使用 c_str() 修复它的方法。

但是，如果有人能澄清为什么标准库的使用在不同平台上是不同的，那将对我有很大帮助。
对我来说，它不再是标准了！

编辑：代码更新为完整。myFile.txt 的内容已更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T21:47:46.307

您可能忘记了`#include <string>`。没有它，Microsoft 的版本`<iostream>`（等等）包含足够的声明以`std::string`使某些事情正常工作，但缺少其他部分，因此您会遇到奇怪的、看似莫名其妙的失败。

缺少的一件事是大多数运算符重载 for `std::string`，这正是您似乎缺少的。

顺便说一句，`while (myfile.good()) ...`这几乎是一个有保证的错误——你可能想要：

```
while (myfile>>myString)
    std::cout << myString << " \n"; 
```

或者，您可以使用标准算法完成这项工作：

```
#include <string>
#include <algorithm>
#include <iterator>
#include <fstream>
#include <iostream>

int main() { 
    std::ifstream myfile("input.txt");

    std::copy(std::istream_iterator<std::string>(myfile),
              std::istream_iterator<std::string>(),
              std::ostream_iterator<std::string>(std::cout, " \n"));
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:44:53.153

以下在 MSVC 2010 上对我来说编译得很好：

```
std::ifstream 输入流；
std::string myString;
inputStream.open("myFile.txt", std::ifstream::in);

同时（输入流。好（））
{
    输入流>>我的字符串；
}
```

**注意**：没有使用`std::ifstream::in`我的打开模式，我得到了和你一样的错误。我建议您检查此参数的值。

# javascript - 以毫秒为单位创建倒数计时器

> ID：10112563
> 
> 赞同：1
> 
> 时间：2012-04-11T19:24:44.210
> 
> 标签：javascript, jquery

我正在尝试创建一个以年、月、日、小时、分钟、秒和毫秒为单位倒计时的计时器。我在网上找到了一些指南，但它们有点不容易理解，或者不做毫秒。谁能帮我做这样的事情，比如说，这个星期五 13:30。

所以它可以读取 0y 0m 2d 2h 11m 50ms

并倒计时毫秒。我会展示代码来证明我实际上已经尝试过自己做这件事，但是这一切都失败了，以至于我会感到尴尬。

我还阅读[了这篇文章](http://www.sitepoint.com/creating-accurate-timers-in-javascript/)，这让我有点不信任 javascript 计时器。这是真的吗，他们变得[如此不同步](http://www.sitepoint.com/examples/timeradjust/examples.html)？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T19:49:36.957

取决于你如何实现它。

如果您读取一次时间并依赖于 setInterval 或/和 setTimeout 的准确性，那么是的..它们可能会不同步。

如果您总是在计算中使用当前时间，那么它可能会像系统的其余部分不同步一样不同步......这意味着它遵循计算机的时钟。

[在JavaScript / jQuery Countdown](https://stackoverflow.com/questions/4150113/javascript-jquery-countdown/4150192#4150192)更改我的答案以添加您获得的毫秒数

```
var end = new Date('13 Apr 2012 13:30:00');

var _second = 1000;
var _minute = _second * 60;
var _hour = _minute * 60;
var _day = _hour *24;
var timer;

function showRemaining()
{
    var now = new Date();
    var distance = end - now;
    if (distance < 0 ) {
       // handle expiry here..
       clearInterval( timer ); // stop the timer from continuing ..
       //alert('Expired'); // alert a message that the timer has expired..
    }
    var days = Math.floor(distance / _day);
    var hours = Math.floor( (distance % _day ) / _hour );
    var minutes = Math.floor( (distance % _hour) / _minute );
    var seconds = Math.floor( (distance % _minute) / _second );
    var milliseconds = distance % _second;

    var countdownElement = document.getElementById('timer');
    countdownElement.innerHTML = days  + 'd ' +
                                 hours + 'h ' +
                                 minutes + 'm ' +
                                 seconds + 's ' +
                                 milliseconds + 'ms';
}

timer = setInterval(showRemaining, 10); 
```

但它不处理月份和年份，因为这需要更复杂的计算来分解 28-31 天的月份和闰年。

演示在[http://jsfiddle.net/TaHtz/2/](http://jsfiddle.net/TaHtz/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:56:01.680

试试这个 js 小提琴：http: [//jsfiddle.net/QH6X8/185/](http://jsfiddle.net/QH6X8/185/)

`end`使用 JavaScript 第一行中定义的变量设置结束日期。

如果您不想每 1 毫秒更新一次，那么这里有一个 jsfiddle 每 60 次更新：http: [//jsfiddle.net/QH6X8/187/](http://jsfiddle.net/QH6X8/187/)

# c# - 在 MVC 中填充下拉列表

> ID：10112567
> 
> 赞同：1
> 
> 时间：2012-04-11T19:24:53.940
> 
> 标签：c#, jquery, asp.net, asp.net-mvc

在我的 MVC 应用程序中，我有一个返回以下 XML 的服务调用 (http://dev-service.test.com/api/brands?active=true)

```
<Brands>
  <Brand>
  <BrandId>1</BrandId>
  <BrandNo>20</BrandNo>
  <BrandName>ABC</Domain>
  </Brand>

  <Brand>
  <BrandId>2</BrandId>
  <BrandNo>30</BrandNo>
  <BrandName>XYZ</Domain>
  </Brand>
<Brands> 
```

在我的一个用户控件中，我想用 BrandName 值填充下拉列表。我已经有一个包含一堆属性的 ViewModel。如何使用此 XML 中的值填充下拉列表？

PS：我是 MVC 新手，仍在学习视图模型等基础知识。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T19:29:03.267

你的问题真的有两个部分。XML 解析部分（与 ASP.NET MVC 完全无关）和 ASP.NET MVC 部分。由于您的问题被标记为`asp.net-mvc`让我们先回答这部分。所以你提到了一个视图模型。像这样的东西：

```
public class BrandsViewModel
{
    public string Brand { get; set; }
    public IEnumerable<SelectListItem> Brands { get; set; }
} 
```

然后是控制器动作：

```
public ActionResult Index()
{
    BrandsViewModel model = ...
    return View(model);
} 
```

最后是视图部分：

```
@model BrandsViewModel
@using (Html.BeginForm())
{
    @Html.DropDownListFor(x => x.Brand, Model.Brands)      
    <button type="submit">OK</button>
} 
```

好的，这是 ASP.NET MVC 部分在您的问题中结束的地方。现在是 XML 解析部分。在 C# 中有几种解析 XML 的方法。例如，您可以使用[XDocument](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)类。

当然，在能够解析 XML 之前，您需要有 XML。您在问题中显示的不是 XML。它是一个字符串。您需要先修复它并拥有一个有效的 XML。像这样：

```
<Brands>
  <Brand>
    <BrandId>1</BrandId>
    <BrandNo>20</BrandNo>
    <BrandName>ABC</BrandName>
  </Brand>

  <Brand>
    <BrandId>2</BrandId>
    <BrandNo>30</BrandNo>
    <BrandName>XYZ</BrandName>
  </Brand>
</Brands> 
```

现在您有了有效的 XML，让我们继续使用 XML 解析器。

```
var brands =
    from brand in XDocument.Load("brands.xml").Descendants("Brand")
    select new SelectListItem
    {
        Value = brand.Element("BrandId").Value,
        Text = brand.Element("BrandName").Value
    }; 
```

现在让我们让两者一起工作：

```
public ActionResult Index()
{
    var brandsFile = Server.MapPath("~/app_data/brands.xml");
    var brands =
        from brand in XDocument.Load(brandsFile).Descendants("Brand")
        select new SelectListItem
        {
            Value = brand.Element("BrandId").Value,
            Text = brand.Element("BrandName").Value
        };

    var model = new BrandsViewModel
    {
        Brands = brands
    };
    return View(model);
} 
```

在这里我们可以看到我们已经将控制器操作逻辑与 XML 解析逻辑强耦合，这是很糟糕的。您可以引入一个抽象（接口），该抽象将被注入到控制器的构造函数中，然后由操作使用。然后，您可以提供此抽象的特定实现，它将执行实际的 XML 解析并配置您的依赖注入框架以将其传递给控制器​​。

所以让我们这样做。让我们定义一个代表我们品牌的领域模型：

```
public class Brand
{
    public string Id { get; set; }
    public string Name { get; set; }
} 
```

凉爽的。现在我们想用这些品牌做什么？检索它们的列表。让我们定义我们的合约：

```
public interface IBrandsRepository
{
    Brand[] Get();
} 
```

好的，我们已经指定了我们需要对我们的品牌进行哪些操作。现在我们可以让我们的控制器看起来像这样：

```
public class BrandsController: Controller
{
    private readonly IBrandsRepository _repository;
    public BrandsController(IBrandsRepository repository)
    {
        _repository = repository;
    }

    public ActionResult Index()
    {
        var brands = _repository.Get().Select(b => new SelectListItem
        {
            Value = b.Id,
            Text = b.Name
        });
        var model = new BrandsViewModel
        {
            Brands = brands
        };
        return View(model);
    }
} 
```

这个控制器动作还有改进的空间。请注意，我们正在查询存储库并获取域模型列表 ( `Brand`) 并将此域模型转换为视图模型。这很麻烦并且污染了我们的控制器逻辑。最好将此映射外部化到单独的层中。我个人为此使用[AutoMapper](http://automapper.org/)。它是一个轻量级框架，允许您以流畅的方式定义不同类之间的映射，然后只需将源类型的实例传递给它，它就会向您吐出目标类型的实例：

```
public class BrandsController: Controller
{
    private readonly IBrandsRepository _repository;
    public BrandsController(IBrandsRepository repository)
    {
        _repository = repository;
    }

    public ActionResult Index()
    {
        var brands = _repository.Get();
        var model = new BrandsViewModel
        {
            Brands = Mapper.Map<IEnumerable<Brand>, IEnumerable<SelectListItem>>(brands)
        };
        return View(model);
    }
} 
```

所以我们在这里取得了进展。现在我们可以实现我们的合约：

```
public class BrandsRepositoryXml: IBrandsRepository
{
    private readonly string _brandsFile;
    public BrandsRepositoryXml(string brandsFile)
    {
        _brandsFile = brandsFile;
    }

    public Brand[] Get() 
    {
        return
            (from brand in XDocument.Load(_brandsFile).Descendants("Brand")
             select new Brand
             {
                 Id = brand.Element("BrandId").Value,
                 Name = brand.Element("BrandName").Value
             })
             .ToArray();
    }
} 
```

难题的最后一步是配置一些 DI 框架，以将我们的合约的正确实现注入控制器。.NET 有大量的 DI 框架。随便挑一个。这并不重要。试试 Ninject.MVC3 NuGet。它有点酷且易于设置。或者，如果您不想使用第三方 DI 框架，只需编写自定义[依赖解析器](http://bradwilson.typepad.com/blog/2010/10/service-location-pt5-idependencyresolver.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:40:59.227

要解析 XML，您可以使用这个快速而肮脏的示例：

```
 string xml = @"
        <Brands> 
            <Brand> 
                <BrandId>1</BrandId> 
                <BrandNo>20</BrandNo> 
                <BrandName>ABC</BrandName> 
            </Brand> 
            <Brand> 
                <BrandId>2</BrandId> 
                <BrandNo>30</BrandNo> 
                <BrandName>XYZ</BrandName> 
            </Brand> 
        </Brands> ";

        System.Xml.XmlDocument doc = new System.Xml.XmlDocument();
        doc.LoadXml(xml);

        var brands = (
            from node in doc.SelectNodes("//Brands/Brand").Cast<System.Xml.XmlNode>()
            select new
            {
                BrandId = node.SelectSingleNode("BrandId").InnerText,
                BrandNo = node.SelectSingleNode("BrandNo").InnerText,
                BrandName = node.SelectSingleNode("BrandName").InnerText

            }).ToList(); 
```

如果是我，我会创建一个名为 Brand 的强类型类，并为其提供与您正在解析的内容相匹配的属性，然后它们会解析节点。

# html - 将 json 对象从一个 HTML 页面传递到另一个

> ID：10112573
> 
> 赞同：2
> 
> 时间：2012-04-11T19:25:36.327
> 
> 标签：html, json

我正在使用 window.open() 打开一个页面。有没有办法将 JSON 对象从父页面传递到子页面？当然，从父页面将数据写入 cookie 并从新页面读取相同的 cookie 可能是一种选择。还有更简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:41:02.263

**编辑**

```
var options = {foo:'foo'};
var myURL="http://localhost";
window.open( myURL + "/?options=" + JSON.stringify(options) ); 
```

之前没有测试过那个代码，试试这个，你可以通过GET访问它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T00:54:20.720

我看到有几种方法可以做到这一点：

1.  饼干。将值写入 cookie 并在打开的窗口中读取。
2.  作为 url 哈希的一部分传递： window.open(url + '#' + encodeURIComponent(JSON.stringify(json));
3.  我会尝试

    winRef = window.open(...);

    winRef.postMessage(...);

[https://developer.mozilla.org/en/DOM/window.postMessage](https://developer.mozilla.org/en/DOM/window.postMessage)

我没有尝试第三种选择，但它可能是 1 和 2 的不错选择。

# javascript - 如何评估潜在未声明变量的属性？

> ID：10112581
> 
> 赞同：4
> 
> 时间：2012-04-11T19:26:13.023
> 
> 标签：javascript, undefined, jquery-templates

我有一个在某些情况下没有声明的变量，我想在 jQuery 模板中使用它。这是我想要实现的目标，但它会引发 *payment_method is not defined* 异常：

```
{{if payment_method && (payment_method.id == $value.id)}}
    // this throws an exception when payment_method is undeclared!
{{/if}} 
```

这有效：

```
{{if payment_method }}
    {{if payment_method.id == $value.id}}
        // nested works!
    {{/if}}
{{/if}} 
```

但我不太喜欢嵌套解决方案，因为我经常使用它。我清楚地理解为什么第一种情况会引发错误，我正在寻找的是一种可能的解决方法，而无需求助于第二种解决方案。

这个问题可能归结为 js 中检查未声明/未定义变量的属性的问题。这有效：

```
if("undefined" !== typeof undefinedVariable) {
    // this works just fine also for undeclared variables
} 
```

但这不是：

```
if("undefined" !== typeof undefinedVariable.property) {
    // this throws an exception
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T11:47:52.063

当使用未定义/未声明的变量时，它不会抛出任何异常，但使用它的属性会。这是它变得有点模糊的地方。

*如果您通过typeof*检查此未声明变量的存在，它的计算结果为**false**（至少我认为是这样，当它是唯一条件时会这样做......）并且不会继续检查进一步的条件。如果你只通过它的名字检查它是否存在，它的评估结果为假，但下一个条件仍然被评估......

无论如何，这不会引发任何异常：

```
if(typeof undeclaredVariable !== "undefined" && typeof undeclaredVariable.property !== "undefined") {
    // this works just fine
} 
```

也没有：

```
if(typeof undeclaredVariable !== "undefined" && undeclaredVariable.property) {
    // this also works just fine but is shorter
} 
```

但这确实：

```
if (undeclaredVariable && undeclaredVariable.property) {
    // the conditional clause does not stop at undeclaredVariable but also checks for undeclaredVariable.id where it throws an exception
} 
```

在不了解如何评估条件的真正机制的情况下，我的问题的答案是（成功测试）：

```
{{if typeof payment_method !== "undefined" && payment_method && (payment_method.id == $value.id)}} 
```

**编辑**：使用未定义/未声明的变量会在 js 中引发异常，但在 jQuery tmpl 中不会。

js：

```
if (undeclaredVariable) {
    // throws an exception
} 
```

jQuery tmpl：

```
{{if undeclaredVariable}}
    // evaluates to false, but does not throw an exception
{{/if}} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T14:24:31.363

这是您需要的，以最佳方式工作。

```
 try {
         if (!! someVariable)
         {
           //its declared you can use it
         }
         else
         {
           //its not declared
         }                    

   }
   catch (e) {
         //its not declared
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T22:30:00.150

js 中的问题是你需要先检查属性是否存在，然后才能针对它进行测试，所以它使条件变得有点混乱。

```
{{if payment_method && payment_method.id && (payment_method.id == $value.id)}} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T19:35:48.170

您可以使用 hasOwnProperty 函数来检查对象上是否存在属性。请参阅[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/HasOwnProperty](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/HasOwnProperty)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-09T03:59:39.280

```
var foo;  
var bar = 'defined';
try{
  if(someVariable === 'undefined') {
    console.log('undefined'); //foo
  }else{
    console.log('declare && defined'); //bar
  }
}catch (e){
  console.log('undeclared'); //undeclaredVariable
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-06-12T08:38:36.220

```
{{if this.data.payment_method && this.data.payment_method.id == $value.id}}{{/if}} 
```

# python - 如何防止命令行窗口在错误后关闭

> ID：10112583
> 
> 赞同：2
> 
> 时间：2012-04-11T19:26:21.283
> 
> 标签：python, windows, command-prompt

在 Windows 中，当 Python 脚本退出时，命令提示符窗口会关闭。如果它从错误中退出，它会在您阅读任何内容之前关闭。即使出现错误，我也一直在使用它来保持窗口打开：

```
if __name__ == '__main__':
    try:
        main()
    except BaseException as e:
        print('Error:')
        print(e)
        raise
    finally:
        raw_input('(Press <Enter> to close)') 
```

它适用于`main()`调用`sys.exit()`，但不适用于语法错误。有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T19:29:23.330

您所拥有的将在大多数情况下工作（线程调用`os._exit()`是一个值得注意的例外）。

另一种方法是将 Python 脚本包装在一个批处理文件中，并[`pause`](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/pause.mspx?mfr=true)在调用 Python 解释器后使用该命令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T19:30:47.690

我现在正在使用带有此代码的批处理文件

```
@echo off
env\project_env\Scripts\python.exe -mpdb test.py
pause 
```

`env\project_env`是一个 virtualenv 目录，其中包含由`test.py`

`env\project_env\Scripts\python.exe`是一个 python 解释器，它使 virtualenv 能够使用安装在其中的库。

`-mpdb`如果程序以未捕获的异常终止，将打开一个调试器。

# php - 将数据插入我的数据库不起作用

> ID：10112585
> 
> 赞同：0
> 
> 时间：2012-04-11T19:26:23.150
> 
> 标签：php, mysql, database, relational

我有一个很好的下拉列表，它是从表团队（FK）中填充的。唯一不起作用的是将数据添加到匹配项中。我不断收到以下错误：

```
- team_home not set 
- team_away not set 

- Notice: Undefined index: team_home in vvo/insertmatch.php on line 28

- Notice: Undefined index: team_away in vvo/insertmatch.php on line 28

- Error: You have an error in your SQL syntax; check the manual that corresponds to your    MySQL server version for the right syntax to use near 'matches (team_home, team_away) VALUES ('','')' at line 1 
```

谁能告诉我是什么导致了这些错误？

请参阅下面的代码，我知道它很容易受到 sql 注入的影响，但我只想让它工作。

```
**addmatch.php**

<?php
$con = mysql_connect("db.xx.nl","md190851db210288","xxx");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("md190851db210288", $con);

?>
<form action="insertmatch.php" method="GET">
<select name="team_home">
<?php
$sql = "SELECT team_id, team_name FROM teams ".
"ORDER BY team_name";

$rs = mysql_query($sql);

while($row = mysql_fetch_array($rs))
{
  echo "<option value=\"".$row['team_id']."\">".$row['team_name']."</option>\n  ";
}
?>
</select>
<select name="team_away">
<?php
$sql = "SELECT team_id, team_name FROM teams ".
"ORDER BY team_name";

$rs = mysql_query($sql);

while($row = mysql_fetch_array($rs))
{
  echo "<option value=\"".$row['team_id']."\">".$row['team_name']."</option>\n  ";
}
?>
</select>
<input type="submit" /> 
```

```
**insertmatch.php**

<?php
  error_reporting(E_ALL);
  ini_set("display_errors", 1);

$con = mysql_connect("db.xx.nl","md190851db210288","xxx");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

if (isset($_POST['team_home'])) { 
    echo $_POST['team_home']; 
} else { 
    echo 'team_home not set <br>'; 
}
if (isset($_POST['team_away'])) { 
    echo $_POST['team_away']; 
} else { 
    echo 'team_away not set <br>'; 
}  

mysql_select_db("md190851db210288", $con);

$sql="INSERT INTO matches (team_home, team_away)
VALUES
('$_POST[team_home]','$_POST[team_away]')";

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
echo "1 record added";

echo $team_home;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:32:16.643

试试这个

```
$sql=sprintf("INSERT INTO matches (team_home, team_away)VALUES('%s','%s')",mysql_real_escape_string($_POST['team_home']),mysql_real_escape_string($_POST['team_away'])); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:33:29.243

您的 PHP 无效：

```
$_POST[team_home] 
```

双引号里面是错误的。

在它周围加上 {}，在 team_home 周围加上单引号

{$_POST['team_home']}

and similarly for other fields. And as suggestion be aware from SQL injection, and sanitize data from $_POST before usino it in queries

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:33:25.437

只是想指出你在这里做什么

```
$sql="INSERT INTO matches (team_home, team_away)
VALUES
('$_POST[team_home]','$_POST[team_away]')"; 
```

非常危险。您不应该直接使用任何全局变量。您需要过滤并验证它们，否则您的应用程序将受到 SQL 注入攻击。

# r - 各个条形图上的数字对齐

> ID：10112587
> 
> 赞同：12
> 
> 时间：2012-04-11T19:26:41.727
> 
> 标签：r, ggplot2, bar-chart

我需要在 ggplot 的条形上方放置标签。我曾经使用找到的方法（[HERE](https://stackoverflow.com/questions/9184969/alignment-of-numbers-on-the-individual-bars-with-ggplot2/9185168#9185168)），但这似乎不再起作用，因为我的 ggplot2 更新，因为我现在收到错误消息：

```
Error in continuous_scale(c("y", "ymin", "ymax", "yend", "yintercept",  : 
  unused argument(s) (formatter = "percent") 
```

使用示例时，如何再次在条形上方绘制数值：

```
df <- structure(list(A = structure(c(1L, 1L, 1L, 2L, 2L, 2L, 3L, 3L,
3L), .Label = c("0-50,000", "50,001-250,000", "250,001-Over"), class = "factor"),
    B = structure(c(1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L), .Label = c("0-50,000",
    "50,001-250,000", "250,001-Over"), class = "factor"), Freq = c(0.507713884992987,
    0.258064516129032, 0.23422159887798, 0.168539325842697, 0.525280898876405,
    0.306179775280899, 0.160958904109589, 0.243150684931507,
    0.595890410958904)), .Names = c("A", "B", "Freq"), class = "data.frame", row.names = c(NA,
-9L))

library(ggplot2)

ggplot(data=df, aes(x=A, y=Freq))+
    geom_bar(aes(fill=B), position = position_dodge()) + 
    geom_text(aes(label = paste(sprintf("%.1f", Freq*100), "%", sep=""),
                  y = Freq+0.015, x=A),
              size = 3, position = position_dodge(width=0.9)) +
    scale_y_continuous(formatter = "percent") +
    theme_bw() 
```

在 win 7 机器上运行 R 2.15 ggplot2 0.9

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-11T20:31:31.827

错误来自`scale_y_continuous`通话。标签的格式现在由`labels`参数处理。有关详细信息，请参阅[ggplot2 0.9.0 过渡指南](https://github.com/downloads/hadley/ggplot2/guide-col.pdf)。

标签排列不正确还有另一个问题；我通过为;添加`group=B`美学来解决这个问题 `geom_text`不过，我不太确定为什么这是必要的。`x=A`我也从美学中取出，`geom_text`因为它不需要（它会从`ggplot`call.

```
library("ggplot2")
library("scales")

ggplot(data=df, aes(x=A, y=Freq))+
    geom_bar(aes(fill=B), position = position_dodge()) + 
    geom_text(aes(label = paste(sprintf("%.1f", Freq*100), "%", sep=""),
                  y = Freq+0.015, group=B),
              size = 3, position = position_dodge(width=0.9)) +
    scale_y_continuous(labels = percent) +
    theme_bw() 
```

![在此处输入图像描述](../Images/b708be25be50d907f15a6fa966580071.png)

# regex - R中的正则表达式：在字符向量中查找多次出现的模式

> ID：10112589
> 
> 赞同：1
> 
> 时间：2012-04-11T19:26:51.577
> 
> 标签：regex, r

> **可能重复：**
> [查找多个/重叠匹配子字符串的索引](https://stackoverflow.com/questions/7878992/finding-the-indexes-of-multiple-overlapping-matching-substrings)

我有一个看起来像这样的字符向量

```
s <- c("aab", "aabaa", "aabaaa") 
```

我想搜索所有出现的“aa”，包括重叠出现，这样 s[2] 将出现两次（从位置 1 和 4 开始），而 s[3] 将出现 3 次（从位置 1、4 开始） , 和 5)。这看起来像：

```
functionImLookingFor("aa", s)
> [[1]] 
> [1] 1
>
> [[2]]
> [1] 1
> [2] 4
> 
> [[3]]
> [1] 1
> [2] 4
> [3] 5 
```

我是使用正则表达式的新手，但我发现的所有函数似乎都无法处理模式的重叠出现。我错过了什么？

# javascript - 创建可调整大小的日历 (html/css/jquery)

> ID：10112594
> 
> 赞同：1
> 
> 时间：2012-04-11T19:27:13.700
> 
> 标签：javascript, jquery, html, css, fullcalendar

我会尽量把这件事说清楚！所以来了！

我一直在使用 Adam Shaw 的 jquery 插件[fullCalendar](http://arshaw.com/fullcalendar/)。我对我正在从事的项目进行了细微的调整。

**目的：**设置此“版本”的 fullcalendar 以便它填充窗口中的文档空间，并旨在在调整窗口大小时始终保持可见（同时在*右侧*的窗口和日历本身之间留出 10px 的填充）和*底部*）。此外，它*应该*在日历导航*下方*的文档顶部有 10 像素的填充。左边是正确的。

**问题：**当您加载包含在 zip 中的“localendar.html”时，您可能会立即看到一些问题（这可能取决于您的屏幕分辨率）。目前日历未固定在日历导航下方 10px 处。*此外，当您调整浏览器窗口的大小时，日历会在右侧和底部保持 10 像素的填充，但是日历的顶部在所有三个日历视图选项中都无法正常工作*。日历不得有任何溢出导致出现滚动条。

日历必须在所有边上保持 10px 的填充（除了左侧，日历导航下方的顶部只有 10px）。最小高度和宽度，以便日历不能小于平均上网本分辨率（此时溢出导致滚动条是可以接受的）。

- 这些行**可能**会有所帮助。

localendar.html (70-92, 104-124)
fullcalendar.css (139-142 [查看 fullcalendar.css)
fullcalendar.js (473-492 [查看 fullcalendar.js)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T23:23:22.397

您将所有元素的位置属性设置为“绝对”。当您将某些内容设置为“位置：绝对”时，它会将其绝对定位在设置为“位置：相对”的最近父级内。它还从一般文档流中删除元素。上边距发生的情况是，由于日历不在文档流中，它与上面的控件重叠。您应该从 CSS 中删除位置属性。

这是 html 页面本身的日历样式应该具备的：

```
 div#calendar {
    margin-left: 252px !important;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
} 
```

我在 style 属性中包含了 div 元素，因为它赋予了规则更多的权重。我还将 'margin-left' 属性的值设置为重要，因为在 fullcalendar.css 文件中有另一种样式设置为重要。这两个一起将覆盖在该文件中应用的左边距。

我目前只能在 safari 中对此进行测试，但它应该在大多数浏览器中都能正常工作。请让我知道这可不可以帮你。

# javascript - 使用脚本之前复选框不起作用

> ID：10112597
> 
> 赞同：0
> 
> 时间：2012-04-11T19:27:16.233
> 
> 标签：javascript, html

我被要求将表格行单击上的复选框标记为已选中，下面的脚本正在运行，但现在当我直接单击复选框时，它不起作用，只有当我单击表格行时才有效。

我有这个html：

```
<tr class="linha_tela" id="4">
   <td>Profile</td>
   <td>Clientes</td>
   <td>
     <input type="checkbox" checked="checked" id="controller_4" name="controllers[]" value="4" />
  </td>
</tr> 
```

这是我的脚本：

```
 $('.linha_tela').click(function(){
        var checkbox = $(this).find(':checkbox');
        checkbox.attr('checked', !checkbox.attr('checked'));
    }); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:35:53.203

发生的情况是，当您单击复选框时，该复选框正在切换，然后触发事件处理程序，导致它变为未选中状态。这基本上是瞬间发生的，这就是为什么它似乎根本不起作用。

尝试这个：

```
$('.linha_tela').click(function(event) {
    if (!$(event.target).is(':checkbox')) {
        var checkbox = $(this).find(':checkbox');
        checkbox.attr('checked', !checkbox.attr('checked'));
    }
}); 
```

**编辑**：这是它工作的[jsfiddle 演示](http://jsfiddle.net/ybd6u/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:36:24.443

发生这种情况是因为复选框位于表格行中，因此当您单击它时，它会改变它的状态（因为这就是复选框的作用）。

然后点击冒泡到您的 tr，并运行脚本，将其状态改回。

你需要检查事件目标，如果它不是输入，做你的事情，如果是，那么不要。

这是修改后的脚本：

```
$('.linha_tela').click(function(event) {

    if (event.target.nodeName != 'INPUT') {
        var checkbox = $(this).find(':checkbox');
        checkbox.attr('checked', !checkbox.attr('checked'));
    }
}); 
```

和一个 jsfiddle 的链接来试用它：http: [//jsfiddle.net/yDEyC/](http://jsfiddle.net/yDEyC/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T19:39:01.893

```
$(":checkbox").click(function(event) {
  event.stopPropagation();
}); 
```

这应该有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T19:44:31.427

这是一个演示您的代码场景的 jsfiddle：

[http://jsfiddle.net/sAfTT/](http://jsfiddle.net/sAfTT/)

您遇到的问题是 HTML 中的事件的常见问题。当事件被触发时，它们会在*每个可以应用它们的元素*上触发，从最近到最远的顺序。这称为冒泡（也有捕获反向工作）。 [http://www.quirksmode.org/js/events_order.html](http://www.quirksmode.org/js/events_order.html)

因此，实际上，当您单击复选框时，您也在单击该行，因此处理程序调用看起来像这样。（假设该框未选中开始。反向检查/取消选中适用）

1.  单击的复选框：选中该框
2.  我可以冒泡吗？是的
3.  行点击。有事件处理程序吗？是的
4.  火灾事件处理程序（您的）。这决定了复选框是否被选中。这是。
5.  因为该框已选中，所以取消选中它。
6.  我可以冒泡吗？是的
7.  表单击。有事件处理程序吗？不
8.  单击的文档。有事件处理程序吗？不。

您可以将事件处理程序直接附加到复选框以防止冒泡

```
$(':checkbox').click(function(e){
    e.preventDefault();
    e.stopPropagation();
})​ 
```

编辑：我永远无法让阻止默认值在 jsfiddle 中正常工作，但其他答案提供的概念也可以很好地工作。

# opengl-es - 在 OpenGL ES 2.0 中旋转时仅显示半个三角形

> ID：10112600
> 
> 赞同：0
> 
> 时间：2012-04-11T19:27:22.217
> 
> 标签：opengl-es, opengl-es-2.0

我正在尝试围绕 Y 轴旋转一个三角形。当我围绕 Z 轴旋转它时，一切都很好。但是当我尝试绕 Y 轴旋转时，我得到的只是一个半三角形，绕 Y 轴旋转。我正在使用 PowerVRs OpenGL ES 2.0 SDK。我的 Init 和 Draw 函数如下。

```
int Init(ESContext* esContext)
{
    UserData* userData = (UserData *)esContext->userData;
    const char *vShaderStr =
        "attribute vec4 vPosition;  \n"
        "uniform mat4 MVPMatrix;"
        "void main()                \n"
        "{                          \n"
        "   gl_Position = MVPMatrix * vPosition;\n"
        "}                          \n";

    const char *fShaderStr =
        "precision mediump float;   \n"
        "void main()                \n"
        "{                          \n"
        "   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0); \n"
        "}                          \n";

    GLuint vertexShader;
    GLuint fragmentShader;
    GLuint programObject;
    GLint linked;
    GLfloat ratio = 320.0f/240.0f;

    vertexShader = LoadShader(GL_VERTEX_SHADER, vShaderStr);
    fragmentShader = LoadShader(GL_FRAGMENT_SHADER, fShaderStr);

    programObject = glCreateProgram();

    if (programObject == 0)
        return 0;

    glAttachShader(programObject, vertexShader);
    glAttachShader(programObject, fragmentShader);

    glBindAttribLocation(programObject, 0, "vPosition");
    glLinkProgram(programObject);
    glGetProgramiv(programObject, GL_INFO_LOG_LENGTH, &linked);

    if (!linked)
    {
        GLint infoLen = 0;
        glGetProgramiv(programObject, GL_INFO_LOG_LENGTH, &infoLen);

        if (infoLen > 1)
        {
            char* infoLog = (char *)malloc(sizeof(char) * infoLen);
            glGetProgramInfoLog(programObject, infoLen, NULL, infoLog);

            free(infoLog);
        }

        glDeleteProgram(programObject);
        return FALSE;
    }

    userData->programObject = programObject;

    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);

    glViewport(0, 0, esContext->width, esContext->height);
    glClear(GL_COLOR_BUFFER_BIT);

    glUseProgram(userData->programObject);

    userData->angle = 0.0f;
    userData->start = time(NULL);
    userData->ProjMatrix = PVRTMat4::Perspective(ratio*2.0f, 2.0f, 3.0f, 7.0f, PVRTMat4::eClipspace::OGL, false, false);
    userData->ViewMatrix = PVRTMat4::LookAtLH(PVRTVec3(0.0f, 0.0f, -3.0f), PVRTVec3(0.0f, 0.0f, 0.0f), PVRTVec3(0.0f, 1.0f, 0.0f));
    return TRUE;
}

void Draw(ESContext *esContext)
{
    GLfloat vVertices[] = {0.0f, 0.5f, 0.0f,
                          -0.5f, -0.5f, 0.0f,
                           0.5f, -0.5f, 0.0f};

    GLint MVPHandle;
    double timelapse;

    PVRTMat4 MVPMatrix = PVRTMat4::Identity();
    UserData* userData = (UserData *)esContext->userData;

    timelapse = difftime(time(NULL), userData->start) * 1000;
    if(timelapse > 16.0f) //Maintain approx 60FPS
    {
        if (userData->angle > 360.0f)
        {
            userData->angle = 0.0f;
        }
        else
        {
            userData->angle += 0.1f;
        }
    }

    userData->ModelMatrix = PVRTMat4::RotationY(userData->angle);

    MVPMatrix = userData->ViewMatrix * userData->ModelMatrix;
    MVPMatrix = userData->ProjMatrix * MVPMatrix;

    MVPHandle = glGetUniformLocation(userData->programObject, "MVPMatrix");
    glUniformMatrix4fv(MVPHandle, 1, FALSE, MVPMatrix.ptr());

    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, vVertices);
    glEnableVertexAttribArray(0);

    glClear(GL_COLOR_BUFFER_BIT);
    glDrawArrays(GL_TRIANGLES, 0, 3);
    eglSwapBuffers(esContext->eglDisplay, esContext->eglSurface);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:51:00.387

`PVRTMat4::Perspective(ratio*2.0f, 2.0f, 3.0f, 7.0f, PVRTMat4::eClipspace::OGL, false, false);`将近剪裁平面放置在`3.0f`远离相机的单位处（通过[第三个参数](https://netst.org/pub/linux/ARM/OMAP/TI/Graphics_SDK_4_03_00_02/GFX_Linux_SDK/OVG/SDKPackage/Tools/Documentation/html/structPVRTMat4.html#e14)）。

`PVRTMat4::LookAtLH(PVRTVec3(0.0f, 0.0f, -3.0f), PVRTVec3(0.0f, 0.0f, 0.0f), PVRTVec3(0.0f, 1.0f, 0.0f));`将相机放置在 (0, 0, -3)，回头看 (0, 0, 0)。

您直接使用生成模型矩阵，`PVRTMat4::RotationY(userData->angle);`以便该矩阵不进行平移。您正在绘制的三角形根据其几何形状保持在 (0, 0, 0) 上。

所以发生的事情是三角形中距离相机比 3 个单位更近的部分被近剪裁平面剪裁。近剪裁平面的目的是有效地将相机镜头放置在相对于将感知图像的位置。或者，如果您愿意，也可以指定用户到屏幕的距离。

因此，您希望使近剪裁平面更靠近相机或将相机移离三角形更远。

# python - 如何使脚本在执行结束时自动删除？

> ID：10112601
> 
> 赞同：24
> 
> 时间：2012-04-11T19:27:24.317
> 
> 标签：python, windows, self-destruction

是否可以制作一个 python 脚本，在 Windows 中执行（自删除）结束时删除 .py 文件？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-12-11T23:49:02.577

这种方式使您的程序不依赖于操作系统。

```
from os import remove
from sys import argv

remove(argv[0]) 
```

加分项：解析参数时，您在 sys.argv 中获得的**第一个参数**等于“ **path-to-filename/filename.py** ”

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-04-10T19:49:51.500

Neomind 的回答似乎可以解决问题。但是，如果在内存中删除文件让您感到困扰，并且您正在寻找一个纯 Python 解决方案，那么您可以使用 subprocess 创建一个新进程，其明确目的是删除您的原始脚本文件。像这样的东西应该工作：

```
import sys, subprocess 
subprocess.Popen("python -c \"import os, time; time.sleep(1); os.remove('{}');\"".format(sys.argv[0]))
sys.exit(0) 
```

您可能不需要超时，但我添加它只是为了确保原始脚本中的进程有足够的时间自行关闭。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-11T19:30:29.017

我不确定在内存中删除文件是否是个好主意。尝试从关闭脚本进程的脚本运行批处理文件，然后删除脚本文件。

可能有一种自毁脚本的本机方法，但我不知道。

编辑：这是一个简单的示例，说明如何使用我描述的方法完成此操作：

在脚本中

```
# C:\test.py
import os
os.startfile(r"C:\sampleBatch.bat") 
```

在批次中

```
# C:\sampleBatch.bat
TASKKILL /IM "process name" #For me, this was "ipy64.exe" because I use IronPython.
DEL "C:\test.py" 
```

您甚至可能不需要终止进程来删除文件，但这样做更安全。希望这可以帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-01-19T21:30:37.473

是的，您可以使用以下内容：

```
import os
import sys
import subprocess

# execute and remove after run
(Your python code)
# end of file

dir = os.getcwd()
os.remove(dir+'\%s' % sys.argv[0]) 
```

这个脚本当然可以修改，但除此之外应该可以

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-19T10:49:46.687

有一个比较简单的方法：

```
import os   

os.remove("insert the file's path") 
```

如果您遇到问题，请在起始引号之前放置一个“r”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-04-30T13:39:09.367

您也可以使用该[`atexit`](https://docs.python.org/3/library/atexit.html)模块。

```
import os, atexit

atexit.register(lambda file = __file__: os.remove(file)) 
```

# vba - 使用 Excel VBA 宏基于 A 列对 B 列求和

> ID：10112604
> 
> 赞同：0
> 
> 时间：2012-04-11T19:27:31.040
> 
> 标签：vba, excel, excel-2003

好的，我有一个简单的问题需要 VBA 宏中的帮助。我有一个看起来像这样的excel表......

```
Product #     Count
101              1
102              1
101              2
102              2
107              7
101              4
101              4
189              9 
```

我需要一个宏来根据产品编号列添加“计数”列。我希望它在我完成后看起来像这样......

```
Product #    Count
101              7
102              7
107              7
189              9 
```

我很喜欢 VBA，所以我很想得到任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:42:12.277

假设数据在 A 列和 B 列中，您可以使用公式：

```
=SUMIF(A:A,101,B:B) 
```

或者如果你把 101 放在 C1 中：

```
=SUMIF(A:A,C1,B:B) 
```

**编辑**

但是，如果您仍然需要 VBA，这是我的（快速而肮脏的）建议 - 我使用字典来跟踪每个项目的总和。

```
Sub doIt()

  Dim data As Variant
  Dim i As Long
  Dim countDict As Variant
  Dim category As Variant
  Dim value As Variant

  Set countDict = CreateObject("Scripting.Dictionary")

  data = ActiveSheet.UsedRange 'Assumes data is in columns A/B

  'Populate the dictionary: key = category / Item = count
  For i = LBound(data, 1) To UBound(data, 1)
    category = data(i, 1)
    value = data(i, 2)
    If countDict.exists(category) Then
      countDict(category) = countDict(category) + value 'if we have already seen that category, add to the total
    Else
      countDict(category) = value 'first time we find that category, create it
    End If
  Next i

  'Copy dictionary into an array
  ReDim data(1 To countDict.Count, 1 To 2) As Variant

  Dim d As Variant
  i = 1
  For Each d In countDict
    data(i, 1) = d
    data(i, 2) = countDict(d)
    i = i + 1
  Next d

  'Puts the result back in the sheet in column D/E, including headers
  With ActiveSheet
    .Range("D1").Resize(UBound(data, 1), UBound(data, 2)) = data
  End With

End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:11:00.860

正如 Tim 建议的那样，在这种情况下，最简单的方法是使用数据透视表。

![在此处输入图像描述](../Images/75113847075ffaa23b88ee021b13f913.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T15:10:16.363

```
Sub BestWaytoDoIt()

Dim i As Long                    ' Loop Counter
Dim int_DestRwCntr As Integer    ' Dest. sheet Counter
Dim dic_UniquePrd As Scripting.Dictionary
Set dic_UniquePrd = New Scripting.Dictionary

For i = 2 To Sheet1.Range("A" & Sheet1.Cells.Rows.Count - 1).End(xlUp).Row
    If dic_UniquePrd.exist(Sheet1.Range("A" & i).Value) <> True Then
        dic_UniquePrd.Add Sheet1.Range("A" & i).Value, DestRwCntr
        sheet2.Range("A" & int_DestRwCntr).Value = Sheet1.Range("A" & i).Value
        sheet2.Range("B" & int_DestRwCntr).Value = Sheet1.Range("B" & i).Value
    Else
        sheet2.Range("A" & dic_UniquePrd.Item(Sheet1.Range("A" & i).Value)).Value = sheet2.Range("B" & dic_UniquePrd.Item(Sheet1.Range("A" & i).Value)).Value + Sheet1.Range("B" & i).Value
    End If
Next
End Sub 
```

这将达到目的。唯一要记住的是在引用中激活“Microsoft Scripting Runtimes”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T21:01:00.917

这是一个使用多维数组的 VBA 解决方案。我注意到你说你对 VBA 有点陌生，所以我试图在那里发表一些有意义的评论。可能看起来很奇怪的一件事是当我重新调整数组的尺寸时。这是因为当您拥有多维数组时，您只能在使用 Preserve 关键字时重新调整数组中的最后一个维度。

这是我的数据的样子：

```
Product Count
101     1
102     1
101     2
102     2
107     7
101     4
101     4
189     9 
```

这是代码。它与我上一个答案的输出相同。在新工作簿中对此进行测试，并将测试数据放入带有标题的 Sheet1 中。

```
Option Explicit

Sub testFunction()
    Dim rng As Excel.Range
    Dim arrProducts() As String
    Dim i As Long

    Set rng = Sheet1.Range("A2:A9")

    arrProducts = getSumOfCountArray(rng)

    Sheet2.Range("A1:B1").Value = Array("Product", "Sum of Count")

    ' go through array and output to Sheet2
    For i = 0 To UBound(arrProducts, 2)
        Sheet2.Cells(i + 2, "A").Value = arrProducts(0, i)
        Sheet2.Cells(i + 2, "B").Value = arrProducts(1, i)
    Next

End Sub

' Pass in the range of the products
Function getSumOfCountArray(ByRef rngProduct As Excel.Range) As String()
    Dim arrProducts() As String
    Dim i As Long, j As Long
    Dim index As Long

    ReDim arrProducts(1, 0)

    For j = 1 To rngProduct.Rows.Count
        index = getProductIndex(arrProducts, rngProduct.Cells(j, 1).Value)
        If (index = -1) Then
            ' create value in array
            ReDim Preserve arrProducts(1, i)
            arrProducts(0, i) = rngProduct.Cells(j, 1).Value ' product name
            arrProducts(1, i) = rngProduct.Cells(j, 2).Value ' count value
            i = i + 1
        Else
            ' value found, add to id
            arrProducts(1, index) = arrProducts(1, index) + rngProduct.Cells(j, 2).Value
        End If
    Next

    getSumOfCountArray = arrProducts
End Function

Function getProductIndex(ByRef arrProducts() As String, ByRef strSearch As String) As Long
    ' returns the index of the array if found
    Dim i As Long
    For i = 0 To UBound(arrProducts, 2)
        If (arrProducts(0, i) = strSearch) Then
            getProductIndex = i
            Exit Function
        End If
    Next

    ' not found
    getProductIndex = -1
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-06T11:13:35.770

基于 Sub doIt() 中的代码，是否可以在 for Each 周期中也检索出现次数？

例子：

产品 #101 有 4 次出现

产品 # 102 有 2 次出现 ecc...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-17T09:15:52.120

我知道已经很晚了......但是我已经被[基于列 C 值的汇总列 B](https://stackoverflow.com/questions/36673117/sum-up-column-b-based-on-colum-c-values/36674309#36674309)带到这里，所以我发布了一个解决方案，它使用了我在那里使用的相同“公式”方法，但适应了这个实际需要

```
Option Explicit

Sub main()

    With ActiveSheet
        With .Range("A:B").Resize(.cells(.Rows.Count, 1).End(xlUp).row) '<== here adjust "A:B" to whatever colums range you need
            With .Offset(1).Resize(.Rows.Count - 1)
                .Offset(, .Columns.Count).Resize(, 1).FormulaR1C1 = "=SUMIF(C1,RC1,C2)" ' "helper" column: it's the 1st column right of data columns (since ".Offset(, .Columns.Count)")
                .Columns(2).Value = .Offset(, .Columns.Count).Resize(, 1).Value 'update "count" with sum-up from "helper" column

                With .Offset(, .Columns.Count).Resize(, 1) ' reference to "helper" column
                    .FormulaR1C1 = "=IF(countIF(R1C1:RC1,RC1)=1,1,"""")" ' locate Product# repetition with blank cells
                    .Value = .Value 'fix values
                    .SpecialCells(xlCellTypeBlanks).EntireRow.Delete 'delete rows corresponding to blank cells
                    .ClearContents ' clear "helper" column
                End With
            End With
        End With
    End With

    End Sub 
```

它使用“帮助”列，我假设它可能是与最后一个数据列相邻的列（即：如果数据列是“A：B”，那么帮助列是“C”）

是否需要不同的“帮助”列然后查看有关其位置的评论并相应地更改代码

# http - 即使安装了 ext，也找不到“HttpRequest”

> ID：10112608
> 
> 赞同：1
> 
> 时间：2012-04-11T19:27:44.867
> 
> 标签：http, request, php

所以，我已经搜索和搜索。我终于能够得到下面的图像：

显示 php_http 已安装！我已经添加

```
extension = php_http.dll 
```

到我的 php.ini 文件并下载 php_http.dll，它位于 C:\wamp\bin\php\php5.3.10\ext

正如我的 WAMP 所示，php_http 已启用。为什么我仍然得到：

```
Fatal error: Class 'HttpRequest' not found in C:\wamp\www\q\xxxx.php on line 17 
```

![在此处输入图像描述](../Images/53ba14138af5d68d3ae944df25f687db.png)

我的代码是：（我在 "$r = new HttpRequest('http:/......"

```
// phpinfo();

class Xxx {

function __construct() {
}

function generate(){
    $r = new HttpRequest('http://www.whatever.com', HttpRequest::METH_GET);
    try {
        echo $r->send()->getBody();
    } catch (HttpException $ex) {
        echo $ex;
    }
}

}

$x= new Xxx();
$x->generate();

?> 
```

# php - 如何知道你是否在 PHP/MySQL mysql_fetch_array() 中的第一条记录

> ID：10112612
> 
> 赞同：4
> 
> 时间：2012-04-11T19:27:56.193
> 
> 标签：php, mysql

是否有任何功能或方法可以判断您所在的行是否是来自 a 的查询结果中的第一行`mysql_fetch_array()`？

我知道如何通过设置开关变量来做到这一点，但我只是想知道是否有更简化的方法来做到这一点。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:56:02.187

不，那里没有。至少不是常规的 mysql_。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:36:20.053

您可以使用[mysqli_field_tell()](http://www.php.net/manual/en/mysqli-result.current-field.php)来获取结果集的内部指针（但只能使用 mysqli* 函数）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:33:32.953

```
$i = 0;
while ($row = mysql_fetch_array($result, MYSQL_NUM)) {
    if (!$i) {
        echo "1st row";
    }
    $i++;
} 
```

# python - 如何使用内联变量创建多行 Python 字符串？

> ID：10112614
> 
> 赞同：140
> 
> 时间：2012-04-11T19:28:04.190
> 
> 标签：python, string, variables, multiline

我正在寻找一种在多行 Python 字符串中使用变量的干净方法。假设我想做以下事情：

```
string1 = go
string2 = now
string3 = great

"""
I will $string1 there
I will go $string2
$string3
""" 
```

我正在寻找是否有类似于`$`Perl 的东西来指示 Python 语法中的变量。

如果不是 - 用变量创建多行字符串的最简洁方法是什么？

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2012-04-11T19:32:23.383

常用的方式是`format()`函数：

```
>>> s = "This is an {example} with {vars}".format(vars="variables", example="example")
>>> s
'This is an example with variables' 
```

它适用于多行格式字符串：

```
>>> s = '''\
... This is a {length} example.
... Here is a {ordinal} line.\
... '''.format(length='multi-line', ordinal='second')
>>> print(s)
This is a multi-line example.
Here is a second line. 
```

您还可以传递带有变量的字典：

```
>>> d = { 'vars': "variables", 'example': "example" }
>>> s = "This is an {example} with {vars}"
>>> s.format(**d)
'This is an example with variables' 
```

最接近您所要求的内容（就语法而言）是[模板字符串](http://docs.python.org/library/string.html#template-strings)。例如：

```
>>> from string import Template
>>> t = Template("This is an $example with $vars")
>>> t.substitute({ 'example': "example", 'vars': "variables"})
'This is an example with variables' 
```

我应该补充一点，该`format()`功能更常见，因为它很容易获得并且不需要导入行。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-04-11T19:32:09.927

**注意**：在 Python 中进行字符串格式化的推荐方法是使用`format()`，如[已接受的答案中所述](https://stackoverflow.com/a/10112665/815632)。我将此答案保留为也受支持的 C 样式语法的示例。

```
# NOTE: format() is a better choice!
string1 = "go"
string2 = "now"
string3 = "great"

s = """
I will %s there
I will go %s
%s
""" % (string1, string2, string3)

print(s) 
```

一些阅读：

*   [字符串格式](https://docs.python.org/3.4/library/string.html#string-formatting)
*   [PEP 3101 -- 高级字符串格式化](http://www.python.org/dev/peps/pep-3101/)

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2017-10-30T20:15:35.760

您可以将[Python 3.6 的 f 字符串用于](https://stackoverflow.com/a/44205190/3357935)[多行](https://stackoverflow.com/q/10660435/3357935)或冗长的单行字符串中的变量。您可以使用 手动指定换行符`\n`。

# 多行字符串中的变量

```
string1 = "go"
string2 = "now"
string3 = "great"

multiline_string = (f"I will {string1} there\n"
                    f"I will go {string2}.\n"
                    f"{string3}.")

print(multiline_string) 
```

> 我会去那里
> 我现在去
> 很棒

# 冗长的单行字符串中的变量

```
string1 = "go"
string2 = "now"
string3 = "great"

singleline_string = (f"I will {string1} there. "
                     f"I will go {string2}. "
                     f"{string3}.")

print(singleline_string) 
```

> 我将会去那里。我要走了。伟大的。

* * *

或者，您也可以创建带有三引号的多行 f 字符串。

```
multiline_string = f"""I will {string1} there.
I will go {string2}.
{string3}.""" 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2020-06-28T08:39:22.677

**f-strings**，也称为“格式化字符串文字”，是`f`开头有 a 的字符串文字；和花括号，其中包含将被其值替换的表达式。

f 字符串在运行时进行评估。

所以你的代码可以重写为：

```
string1="go"
string2="now"
string3="great"
print(f"""
I will {string1} there
I will go {string2}
{string3}
""") 
```

这将评估为：

```
I will go there
I will go now
great 
```

您可以[在此处](https://www.python.org/dev/peps/pep-0498/#triple-quoted-f-strings)了解更多信息。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-04-11T19:43:55.593

这就是你想要的：

```
>>> string1 = "go"
>>> string2 = "now"
>>> string3 = "great"
>>> mystring = """
... I will {string1} there
... I will go {string2}
... {string3}
... """
>>> locals()
{'__builtins__': <module '__builtin__' (built-in)>, 'string3': 'great', '__package__': None, 'mystring': "\nI will {string1} there\nI will go {string2}\n{string3}\n", '__name__': '__main__', 'string2': 'now', '__doc__': None, 'string1': 'go'}
>>> print(mystring.format(**locals()))

I will go there
I will go now
great 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-09-18T07:52:56.820

可以将字典传递给[`format()`](https://docs.python.org/2/library/stdtypes.html#str.format)，每个键名将成为每个关联值的变量。

```
dict = {'string1': 'go',
        'string2': 'now',
        'string3': 'great'}

multiline_string = '''I'm will {string1} there
I will go {string2}
{string3}'''.format(**dict)

print(multiline_string) 
```

也可以将列表传递给[`format()`](https://docs.python.org/2/library/stdtypes.html#str.format)，在这种情况下，每个值的索引号将用作变量。

```
list = ['go',
        'now',
        'great']

multiline_string = '''I'm will {0} there
I will go {1}
{2}'''.format(*list)

print(multiline_string) 
```

上述两种解决方案都将输出相同的结果：

> 我会去那里
> 我现在去
> 很棒

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-06-28T04:28:54.997

如果有人从 python-graphql 客户端来到这里寻找将对象作为变量传递的解决方案，这就是我使用的：

```
query = """
{{
  pairs(block: {block} first: 200, orderBy: trackedReserveETH, orderDirection: desc) {{
    id
    txCount
    reserveUSD
    trackedReserveETH
    volumeUSD
  }}
}}
""".format(block=''.join(['{number: ', str(block), '}']))

 query = gql(query) 
```

确保像我一样转义所有花括号：“{{”，“}}”

# c# - 环境变量作为 app.config 中的部分路径

> ID：10112616
> 
> 赞同：2
> 
> 时间：2012-04-11T19:28:08.597
> 
> 标签：c#, environment-variables, app-config

我有一个环境变量指向开发代码所在的文件夹。在我的机器上是 C:\SOME_NAME\CODE。此环境变量在代码中被引用，因为使用相同代码的其他计算机具有相同环境变量的不同路径。我无法确定目录或驱动器名称，甚至无法确定级别数。我试图在 app.config 中使用相对路径，但我无法让它工作。

```
<setting name="manifestpath" serializeAs="String">
   <value>$(CODE_BASE)\PROJECT\manifest\manifest.xml</value>
</setting> 
```

当我运行它时，我得到一个错误`"Could not find a part of the path C:\SOME_NAME\CODE\PROJECT\output\x64\Debug\$(CODE_BASE)\PROJECT\manifest\manifest.xml".`

我知道这里已经提出了确切的问题： [App.config settings, environment variable as partial path](https://stackoverflow.com/questions/5303113/app-config-settings-environment-variable-as-partial-path)。
不幸的是，我找不到有效的答案，我尝试使用 % （但我的环境变量名称中没有 % ，我无法更改它，因为更改会影响许多其他项目和人员） . 帮助 ？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:05:08.980

我认为您误读了另一个问题的答案。您的环境变量的名称中永远不会有 % 。用 % 将变量名括起来表示它是一个环境变量。因此，如果您的变量被称为 CODE_BASE，那么以下应该可以工作：

```
 <value>%CODE_BASE%\PROJECT\manifest\manifest.xml</value> 
```

# android - 如何使用新的 GPU 加速 avd？

> ID：10112618
> 
> 赞同：12
> 
> 时间：2012-04-11T19:28:31.077
> 
> 标签：android, emulation, gpu, avd, hardware-acceleration

Google 宣布 Android 模拟器最终使用 GPU，如此[处所写](http://android-developers.blogspot.com/2012/04/faster-emulator-with-better-hardware.html)

但是，我找不到如何使用它的教程。我试图做一些事情，但它一直在崩溃。

到目前为止，我已经尝试过：

1.  在“...\extras\intel\Hardware_Accelerated_Execution_Manager\IntelHaxm.exe”上安装应用程序。

    2.  启用/禁用 avd 的 GPU 仿真标志。

    3.  重启 eclipse 和操作系统。

有没有人成功使用新功能？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T21:06:31.473

GPU 仿真目前不能很好地工作： http://code.google.com/p/android/issues/detail? [id =](http://code.google.com/p/android/issues/detail?id=28529)
[28531 http://code.google.com/p/android/issues/](http://code.google.com/p/android/issues/detail?id=28531)
[detail?id=28529](http://code.google.com/p/android/issues/detail?id=28529)
[http://code.google.com/p/android/issues/detail?id=28563](http://code.google.com/p/android/issues/detail?id=28563)

由于崩溃，我也没有设法运行它。

可以在此处找到有关如何打开它的简单说明：https: [//plus.google.com/108967384991768947849/posts/DSi3oAuNnS7](https://plus.google.com/108967384991768947849/posts/DSi3oAuNnS7)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T20:56:12.057

有几种不同的方法可以打开此处描​​述的 GPU 加速：http: [//developer.android.com/guide/developing/devices/emulator.html#acceleration](http://developer.android.com/guide/developing/devices/emulator.html#acceleration)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T10:58:03.337

你应该看看 Android VM，它是获得硬件加速模拟器的一个很好的选择：http: [//androvm.org/blog/](http://androvm.org/blog/)。

# asp.net-mvc - 如何在常规控制器方法（从客户端调用）中更新视图？

> ID：10112632
> 
> 赞同：0
> 
> 时间：2012-04-11T19:29:42.067
> 
> 标签：asp.net-mvc, asp.net-mvc-3

如何从控制器中定义的标准方法中更新视图？该方法是从我连接的 jquery 插件中调用的。

看法：

```
 @model ViewModel

    @Html.EditorFor(model => model.First)
    @Html.EditorFor(model => model.Last)

    @Html.EditorFor(model => model.Junk) 
```

控制器方法：

```
 // Called from third party jquery plugin
    public string DoSomeWorkAndUpdateMyView(string Id)
    {
        // Get persisted View from dbcontext...
        // Create a new Junk object with the new id and add it to the db context
        // Update the view with the newly added junk object
        ViewModel model = dbContext.GetViewStuff();
        model.Junk.Add(new junk);

        return View("JunkView", model);
    } 
```

用法：

```
 ...
   onComplete: function (event, queueID, fileObj, response, data) 
                {
                    $.ajax(
                { url: '@Url.Action("ProcessForm","Home")',
                    data: { first: $("#fname").val() },
                    success: function (data) {
                        $("#fname").val(data);
                    }
                })
                }
   ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:46:49.237

我认为没有一种简单的方法可以在 Ajax 调用中返回您的模型并按照您的想法更新视图。因此，您可以进行常规的 POST/GET，或者做一些工作：

```
 public JsonResult DoSomeWorkAndUpdateMyView(string Id)
    {
        Dictionary<string, string> result = new Dictionary<string, string>();

        if (DoSomeWork())
        {
            result.Add( "status", "success" );
            result.Add( "id", Id ); // any info the client will need to reload the page
        }
        else
        {
            result.Add("status", "error");
            result.Add( "error", "Some Error Message"); 
        }

        return Json(result);
    } 
```

然后在接收端检查响应状态。如果“成功”，则用于`document.location=`重新加载整个页面。

如果您必须在一次通话中完成此操作，则需要执行类似的操作

```
return Json(model); 
```

然后在客户端手动设置每个元素的值。

# windows-phone-7 - 如何在 Windows Phone 上使用 Efix 获取元数据

> ID：10112634
> 
> 赞同：0
> 
> 时间：2012-04-11T19:30:03.047
> 
> 标签：windows-phone-7, metadata

从[豪雅团队](http://igrali.wordpress.com/2011/11/01/reading-and-displaying-exif-photo-data-on-windows-phone/)我找到了这些代码，

```
void task_Completed(object sender, PhotoResult e)
        {
            if (e.TaskResult == TaskResult.OK)
            {
                photoLoaded = true;
                JpegInfo info = ExifLib.ExifReader.ReadJpeg(e.ChosenPhoto, e.OriginalFileName);
                var img = new BitmapImage();
                img.SetSource(e.ChosenPhoto);
                loadedImg.Source = img;
                ReadExif(info);
            }
        } 
```

但是，当我运行这段代码时，出现了 System.Debugging.Break 。我该如何修复它？

# html - 子菜单超出页面的可用高度，可能的解决方案？

> ID：10112635
> 
> 赞同：0
> 
> 时间：2012-04-11T19:30:13.390
> 
> 标签：html, css, drop-down-menu

我只使用 HTML 和 CSS 创建了一个简单的垂直导航栏，并添加了子菜单。现在的问题是，下部导航菜单的子菜单有很多链接，导致子菜单超过页面的高度。屏幕截图解释得更好 -

![在此处输入图像描述](../Images/26d5d7b18253e9ef216cb229aa8db2cb.png)

如您所见，子菜单超出了网页的高度，并且页脚（带有 © 符号的深灰色条带）最终漂浮在半空中。最大的问题是`"outerwear"`子菜单更长，我最终向下滚动以查看其余隐藏链接。

是否有**仅**使用HTML 和 CSS 的解决方案？可以将子菜单的下边距（不是技术意义上的）与主菜单的下边距对齐吗？

**编辑**：这是代码 - [http://jsfiddle.net/nWxpj/2/](http://jsfiddle.net/nWxpj/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:43:58.857

子菜单列表项各不相同，所以我认为如果不定义单独的类就不可能实现，所以你必须为底部菜单定义单独的类并根据设置上边距，

这是我所做的，[小提琴](http://jsfiddle.net/nWxpj/4/)

# java - 使用异步 servlet 的休眠 getCurrentSession 行为

> ID：10112639
> 
> 赞同：0
> 
> 时间：2012-04-11T19:30:37.747
> 
> 标签：java, hibernate, servlets

Servlet 3.0 异步 api 的内部指定 servlet 由多路复用器池处理。getCurrentSession 的行为是什么？它会保持会话打开，直到多路复用器线程由于空闲而被破坏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:54:03.797

Servlet 请求一直由线程池处理，因此 Servlet 3.0 在这里没有引入任何新内容。`Session`在事务提交后从 get close （默认情况下）获得的Thread-bound `getCurrentSession()`，因此只要您正确实现事务管理，您应该不会对线程池有任何问题。

Servlet 3.0 中的新功能是异步请求处理的不同阶段可以由不同的线程处理，因此您不能`Session`在这些阶段使用线程绑定。但是，您仍然可以`Session`在单个处理阶段内使用线程绑定。

异步处理也给 View 模式中的 Open Session 带来了问题。

但是，只要您不使用异步 API，所有这些问题都无关紧要。

# php - RSS 提要不显示 PHP 变量

> ID：10112643
> 
> 赞同：0
> 
> 时间：2012-04-11T19:30:55.407
> 
> 标签：php, mysql, html, sql, rss

我有一个 RSS 提要，由于某种原因没有显示我的 PHP 变量。返回提要时，它会返回原始标签，例如标题将是 Timetable $yesterdayd 而不是 Timetable - 4 月 10 日星期二

```
<?PHP
 include("../config.php");
 #// Timetable Clearup Variabls
$yesterday = strtotime('yesterday');
$yesterdow = date('l',$yesterday);
$order = "SELECT * FROM timetable WHERE day = '$yesterdow' ORDER BY time";
$result = mysql_query($order);
$yesterdayd = date('F jS, Y', time()-86400);

    //SET XML HEADER
    header('Content-type: text/xml');

    //CONSTRUCT RSS FEED HEADERS
    $output = '<rss version="2.0">';
    $output .= '<channel>';
    $output .= '<title>Timetable - $yesterdayd </title>';
    $output .= '<description>Timetable.</description>';
    $output .= '<link>http://site.com/</link>';
 ###   $output .= '<copyright>Your copyright details</copyright>';

    //BODY OF RSS FEED
   $output .= '<item>';
        $output .= '<title>Timetable for $yesterdayd</title>';
        $output .= '<description>" . htmlspecialchars($row['username']) . "</td><td>" . htmlspecialchars($row['time']) . "</description>';
        $output .= '<link>Link to Item</link>';
        $output .= '<pubDate>Date Published</pubDate>';
   $output .= '</item> ';

    //CLOSE RSS FEED
   $output .= '</channel>';
   $output .= '</rss>';

    //SEND COMPLETE RSS FEED TO BROWSER
    echo($output);

?> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:33:49.757

对输出字符串使用双引号。我认为变量不会插入单引号。

所以喜欢

```
$output .= "<title>Timetable for $yesterdayd</title>"; 
```

那应该这样做。该页面确实有一个 php 扩展名，对吗？

编辑：

当你插入数组或对象时，使用像 {$row['username']} 或 {$object->property} 这样的语法，但是当你调用一个函数时，你不能插入，你必须连接：

```
"<description>" . htmlspecialchars($row['username']) . "</td>"; 
```

此外，请确保您现在没有混合单引号和双引号 - 看起来您作为响应粘贴的代码混合了它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:34:07.173

单引号字符串不会计算 php 变量。

IE

```
'<title>Timetable - $yesterdayd </title>'; 
```

应该

```
"<title>Timetable - {$yesterdayd} </title>"; 
```

# git - 是否有一个 git 命令可以输出索引中的文件内容？

> ID：10112644
> 
> 赞同：0
> 
> 时间：2012-04-11T19:30:56.233
> 
> 标签：git

是否有一个 git 命令可以输出索引中的文件内容？换句话说，在`git diff`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:36:04.253

你要：

```
git show :<filename> 
```

请参阅[gitrevisions 手册页](http://schacon.github.com/git/gitrevisions.html)中[指定修订](http://schacon.github.com/git/gitrevisions.html#_specifying_revisions)`<rev>:<path>`下的条目。

# click - 在 AS2 中，阻止外部 SWF 中的点击

> ID：10112649
> 
> 赞同：0
> 
> 时间：2012-04-11T19:31:17.650
> 
> 标签：click, flash, actionscript-2, external

我正在使用 Flash CS4、AS2。

我有第一个 SWF，即通过 attachMovie 加载外部 SWF、页面的界面。页面本身包含可点击的按钮。我要做的是启用和禁用页面上的按钮，而不更改页面的代码。我只能更改界面的内容。

我试过使用一个拦截器，一个带有以下内容的电影剪辑：

```
onrelease = function() {};
onpress = function() {};
useHandCursor = false; 
```

然而，这只会阻止界面内的点击，并且外部页面似乎仍然会获得鼠标事件。

有没有办法启用和禁用页面获得点击？我不想停止它的执行（没有停止（））。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T23:28:22.820

将加载的内容放在特定深度（通过 MovieClipLoader 的 loadClip）和顶部的“阻塞器”透明 MovieClip（getNextHighestDepth()）以及一个空的按下/释放处理程序，您可以在不需要时将其 _visible 属性设置为 false 怎么样？

这是一个基本示例：

```
var loadedContent:MovieClip = createEmptyMovieClip("loadedContent",getNextHighestDepth());
var loader:MovieClipLoader = new MovieClipLoader();
loader.loadClip("as2loadee.swf",loadedContent);//loads content on _level0, unlike loadMovieNum

var blocker:MovieClip = createEmptyMovieClip("blocker",getNextHighestDepth());
blocker.beginFill(0,0);//transparent fill
drawRect(blocker,0,0,100,100);//these values might change
blocker.endFill();
blocker.onPress = function():Void{
    trace("nuh-uh!");
}

function drawRect(target:MovieClip,x:Number,y:Number,w:Number,h:Number):Void{
    target.lineTo(x  ,y  );
    target.lineTo(x+w,y  );
    target.lineTo(x+w,y+h);
    target.lineTo(x  ,y+h);
    target.lineTo(x  ,y  );
} 
```

# html - 输入时清晰的样式

> ID：10112651
> 
> 赞同：0
> 
> 时间：2012-04-11T19:31:20.637
> 
> 标签：html, ruby-on-rails, css

我已经用 CSS 格式化了输入字段，但我的提交按钮现在是 400px 宽度，我不知道如何使它更小。

**@post 表格：**

```
 <% create_url = {:url=>{:action=>"create"}} if @post.new_record? %>
      <% form_for @post, :html => { :multipart => true } do |t| %>
        <b><%= t.label :title, 'Virsraksts:' %></b><br />
        <%= t.text_field :title %><br /><br />
        <b><%= t.label :content, 'Teksts:' %></b><br />
        <%= t.text_area :content %><br /><br />
        <b><%= t.label :bildes, 'Pievienot bildes:' %></b><br />
        <%= f.file_field :bildes %><br /><br /><br />
        <%= t.submit %>
<% end %>
        <%end%> 
```

**CSS：**

```
input {
  width: 400px;
  float: left;
  font-size: 15px;
  font-weight: bold;
}

textarea {
  width: 400px;
} 
```

请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:34:50.053

您的`input`选择器还会选择您的提交按钮，如果您只希望文本字段`input[type=text]`在您的 css 中执行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:34:54.677

使用 CSS`input[type="text"]`指定`<input type="text" />`

# php - 如果 count(data) 低于或等于 4，则打印一个或打印两个 - 不工作

> ID：10112657
> 
> 赞同：1
> 
> 时间：2012-04-11T19:31:38.340
> 
> 标签：php, if-statement

我需要一些帮助才能在这里直接思考。我有这个代码来计算正确的数量`forecast_conditions`是 4；`(count($condition) -1) <= 4 ? ', ' : ', eller '`.

`count($condition)`打印`5`所以我必须在那里有减号。`$condition`是在一个`foreach`所以我可以循环的内容`forecast_conditions`; `foreach($whome_answer[weather][forecast_conditions] AS $condition) {`.

上面的代码打印`onsdag, torsdag, fredag, lördag,`出了错误。这就是我想要的方式：`onsdag, torsdag, fredag, eller lördag`但我无法在代码中正确使用它！我已经测试了各种解决方案（== 4、>= 4、!= 4、< 4 等等）。

我怎样才能让它正常工作？

提前致谢！

**编辑**

这是循环：

```
foreach($whome_answer[weather][forecast_conditions] AS $condition) {

    # KONTROLL
    if(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'mån') {
        $day = 'måndag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'tis') {
        $day = 'tisdag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'ons') {
        $day = 'onsdag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'tors') {
        $day = 'torsdag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'fre') {
        $day = 'fredag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'lör') {
        $day = 'lördag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'sön') {
        $day = 'söndag';
    }

    echo '<a href="javascript:void(0)" class="forecast-link">';
        echo $day;
    echo '</a>';

    echo (count($condition) -1) <= 4 ? ', ' : ', eller ';

} 
```

这是我从中获取内容的链接：[http ://www.google.com/ig/api?weather=,,,59378217,13504219&hl=en](http://www.google.com/ig/api?weather=,,,59378217,13504219&hl=en)

**编辑（解决方案但还有一个问题）** 下面的代码是解决方案，但它现在正在打印`onsdag, torsdag, fredag, eller lördag,`而不是我正在寻找的内容。如何删除“lördag”之后的最后一个逗号？如果我`$i`在 "if 标签" 之后包含以下内容，则如下所示：`onsdag, 2torsdag, 3fredag, eller 4lördag, 5`。

我该如何解决这个问题？

```
$i = 1;
foreach($whome_answer[weather][forecast_conditions] AS $condition) {
    $i++;

    # KONTROLL
    if(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'mån') {
        $day = 'måndag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'tis') {
        $day = 'tisdag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'ons') {
        $day = 'onsdag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'tors') {
        $day = 'torsdag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'fre') {
        $day = 'fredag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'lör') {
        $day = 'lördag';

    # KONTROLL
    } elseif(utf8_decode($condition['day_of_week']['@attributes']['data']) == 'sön') {
        $day = 'söndag';
    }

    echo '<a href="javascript:void(0)" class="forecast-link">';
        echo $day;
    echo '</a>';

    echo $i != 4 ? ', ' : ', eller ';

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:54:48.803

在 foreach 之外实例化一个名为 $i 的变量并将其设置为 0，并为每个循环将其递增 1，然后检查该变量。

由于它是 php，我不认为 count 返回 dom 对象的位置，它正在计算其他东西，可能是你在 $conditions 中有多少值。

请考虑这段代码，程序员对程序员，更容易阅读:)

```
$i = 0;
foreach($whome_answer[weather][forecast_conditions] AS $condition) {
    $i++;
    switch($condition['day_of_week']['@attributes']['data']) {
        case 'mån':
            $day = 'måndag';
        break;
        case 'tis':
            $day = 'tisdag';
        break;
        case 'ons':
            $day = 'onsdag';
        break;
        case 'tors':
            $day = 'torsdag';
        break;
        case 'fre':
            $day = 'fredag';
        break;
        case 'lör':
            $day = 'lördag';
        break;
        case 'sön':
            $day = 'söndag';
        break;
    }

echo '<a href="javascript:void(0)" class="forecast-link">';
    echo $day;
echo '</a>';

if($i == 4)
    echo ', eller';
 else {
        if($i < 4)
        echo ',';
    }

} 
```

问候托拜厄斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:39:08.850

您在 count() 条件语句前面缺少 echo ，无论 count() 的结果是什么，这基本上都会使整个语句什么都不做。如果这是复制/粘贴错误，您能否提供更多源代码？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:13:44.917

我正在查看代码...然后在您打印的示例中，我注意到...您在每个 $condition*之后打印 ','|', eller '。*这会使事情复杂化，因为您要在要检查的条件出现之前打印到屏幕上。

逗号对于正确可读的语法是必不可少的，所以无论如何都要保留它。

另一方面，“eller”可以在打印到屏幕之前进行检查。

所以我对你的代码的解释会更像这样......

```
$counter = 1;
$amount = count($whome_answer[weather][forecast_conditions]);
foreach($whome_answer[weather][forecast_conditions] AS $condition) {
    if ($counter == 4) echo 'eller ';
    echo $condition['day'];
    if ($counter != $amount) echo ', ';
    $counter++;
} 
```

我假设您可以从已有的数据中确定日期，并为每个 $condition 组成“day”键。

同样，我注意到您的逻辑，`(count($condition) -1) <= 4 ? ', ' : ', eller '`如果`count($condition)`等于 5，将始终测试为真，因此只会返回一个逗号。

编辑：进行更改以响应新问题。

# java - 计算字符串中逗号的数量，双引号之间的逗号除外

> ID：10112659
> 
> 赞同：3
> 
> 时间：2012-04-11T19:32:05.613
> 
> 标签：java, string, performance, counter

我有以下函数来计算字符串中逗号（或任何其他字符）的数量，而不计算双引号内的逗号。我想知道是否有更好的方法来实现这一点，或者即使你能找到这个函数可能崩溃的情况。

```
public int countCharOfString(char c, String s) {
    int numberOfC = 0;
    boolean doubleQuotesFound = false;
    for(int i = 0; i < s.length(); i++){
        if(s.charAt(i) == c && !doubleQuotesFound){
            numberOfC++;
        }else if(s.charAt(i) == c && doubleQuotesFound){
            continue;
        }else if(s.charAt(i) == '\"'){
            doubleQuotesFound = !doubleQuotesFound;
        }
    }
    return numberOfC;
} 
```

感谢您的任何建议

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T20:04:50.043

此实现有两个不同之处：

*   使用`CharSequence`而不是字符串
*   `boolean`如果我们在引用的子序列中，则不需要跟踪值。

功能：

```
public static int countCharOfString(char quote, CharSequence sequence) {

    int total = 0, length = sequence.length();

    for(int i = 0; i < length; i++){
        char c = sequence.charAt(i);
        if (c == '"') {
            // Skip quoted sequence
            for (i++; i < length && sequence.charAt(i)!='"'; i++) {}
        } else if (c == quote) {
            total++;
        }
    }

    return total;
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:38:03.220

```
public static int countCharOfString(char c, String s)
{
    int numberOfC = 0;
    int innerC = 0;
    boolean holdDoubleQuotes = false;
    for(int i = 0; i < s.length(); i++)
    {
        char r = s.charAt(i);
        if(i == s.length() - 1 && r != '\"')
        {
            numberOfC += innerC;
            if(r == c) numberOfC++;
        }
        else if(r == c && !holdDoubleQuotes) numberOfC++;
        else if(r == c && holdDoubleQuotes) innerC++;
        else if(r == '\"' && holdDoubleQuotes)
        {
            holdDoubleQuotes = false;
            innerC = 0;
        }
        else if(r == '\"' && !holdDoubleQuotes) holdDoubleQuotes = true;
    }
    return numberOfC;
} 
```

```
System.out.println(countCharOfString(',', "Hello, BRabbit27, how\",,,\" are, you?")); 
```

**输出：**

```
3 
```

* * *

另一种方法是使用正则表达式：

```
public static int countCharOfString(char c, String s)
{
   s = " " + s + " "; // To make the first and last commas to be counted
   return s.split("[^\"" + c + "*\"][" + c + "]").length - 1;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T19:39:02.063

*   你不应该`charAt()`在循环内多次调用。使用`char`变量。
*   您不应该`length()`为每次迭代调用。`int`在循环之前使用。
*   你应该避免重复比较`c`- 使用嵌套的 if/else。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T20:07:46.883

需要很大的字符串才能产生很大的不同。

这段代码更快的原因是它平均每个循环包含 1.5 个检查，而不是每个循环 3 个检查。它通过使用两个循环来做到这一点，一个用于引用状态，一个用于未引用状态。

```
public static void main(String... args) {
    String s = generateString(20 * 1024 * 1024);
    for (int i = 0; i < 15; i++) {
        long start = System.nanoTime();
        countCharOfString(',', s);
        long mid = System.nanoTime();
        countCharOfString2(',', s);
        long end = System.nanoTime();
        System.out.printf("countCharOfString() took %.3f ms, countCharOfString2() took %.3f ms%n",
                (mid - start) / 1e6, (end - mid) / 1e6);
    }
}

private static String generateString(int length) {
    StringBuilder sb = new StringBuilder(length);
    Random rand = new Random(1);
    while (sb.length() < length)
        sb.append((char) (rand.nextInt(96) + 32)); // includes , and "
    return sb.toString();
}

public static int countCharOfString2(char c, String s) {
    int numberOfC = 0, i = 0;
    while (i < s.length()) {
        // not quoted
        while (i < s.length()) {
            char ch = s.charAt(i++);
            if (ch == c)
                numberOfC++;
            else if (ch == '"')
                break;
        }
        // quoted
        while (i < s.length()) {
            char ch = s.charAt(i++);
            if (ch == '"')
                break;
        }
    }
    return numberOfC;
}

public static int countCharOfString(char c, String s) {
    int numberOfC = 0;
    boolean doubleQuotesFound = false;
    for (int i = 0; i < s.length(); i++) {
        if (s.charAt(i) == c && !doubleQuotesFound) {
            numberOfC++;
        } else if (s.charAt(i) == c && doubleQuotesFound) {
            continue;
        } else if (s.charAt(i) == '\"') {
            doubleQuotesFound = !doubleQuotesFound;
        }
    }
    return numberOfC;
} 
```

印刷

```
countCharOfString() took 33.348 ms, countCharOfString2() took 31.381 ms
countCharOfString() took 28.265 ms, countCharOfString2() took 25.801 ms
countCharOfString() took 28.142 ms, countCharOfString2() took 14.576 ms
countCharOfString() took 28.372 ms, countCharOfString2() took 14.540 ms
countCharOfString() took 28.191 ms, countCharOfString2() took 14.616 ms 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-11T19:48:56.843

也许不是最快的...

```
public int countCharOfString(char c, String s) {
    final String removedQuoted = s.replaceAll("\".*?\"", "");
    int total = 0;
    for(int i = 0; i < removedQuoted.length(); ++i)
        if(removedQuoted.charAt(i) == c)
            ++total;
    return total;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-11T20:12:08.653

更简单，更不容易出错（是的，性能低于逐个字符遍历字符串并手动跟踪所有内容）：

```
public static int countCharOfString(char c, String s) {
  s = s.replaceAll("\".*?\"", "");
  int cnt = 0;
  for (int foundAt = s.indexOf(c); foundAt > -1; foundAt = s.indexOf(c, foundAt+1)) 
    cnt++;
  return cnt;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-11T19:48:06.907

您还可以使用正则表达式和 String.split()

它可能看起来像这样：

```
public int countNonQuotedOccurrences(String inputstring, char searchChar)
{
  String regexPattern = "[^\"]" + searchChar + "[^\"]";
  return inputString.split(regexPattern).length - 1;
} 
```

免责声明：

这只是显示了基本方法。

上面的代码不会在字符串的开头或结尾检查 searchChar。

您可以手动检查或添加到 regexPattern。

# javascript - 检查数组是否包含数字（0 问题）

> ID：10112661
> 
> 赞同：1
> 
> 时间：2012-04-11T19:32:12.860
> 
> 标签：javascript, jquery

我有一个数字数组。该数组可能包含一个零。

如何检查数组是否包含数字？我目前正在这样做：

`if (Number(arr. value(pos)) != false)`

然而，这也被认为`0`是错误的。因此，如果数组中有 0，它将认为数组为空。

我该如何克服呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T19:34:33.190

试试这个：

`if (Number(arr. value(pos)) !== false)`

`!=`进行“虚假”检查。`0, undefined, false, null, '',`并且`NaN`都是假的。其他一切都是“真实的”。如果您只想测试 false （而不是所有其他虚假语句），您必须使用`===`or `!==`。尽量避免`!=`and `==`，因为大多数时候你的意思是`!==`and`===`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:47:30.100

koenp 的答案是完全正确的，但 `if (!isNaN(arr. value(pos)))`在这种情况下可能更可取。此外，它可能会更快一个档次。 [http://www.w3schools.com/jsref/jsref_isnan.asp](http://www.w3schools.com/jsref/jsref_isnan.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:37:08.367

> 可能是一个解决方案。它检查数字是否大于零。

# windows-7 - Windows 7 中的主目录和 .emacs 文件

> ID：10112663
> 
> 赞同：18
> 
> 时间：2012-04-11T19:32:16.910
> 
> 标签：windows-7, emacs, installation

我在 c:/emacs-23.3 中安装了 emacs 23.3.1。按照[此页面](http://www.pchristensen.com/blog/articles/installing-sbcl-emacs-and-slime-on-windows-xp/)中的提示，我更新了 site-start.el 以设置 HOME 环境变量。

```
(setenv "HOME" "c:/users/USER/emacs") 
```

我制作了 c:/users/USER/.emacs（就像我在 unix/mac 中所做的那样）来编写使用 slime 的代码，但它似乎没有正确启动 slime。

这是在 Windows 7 中设置 emacs 的正确方法吗？我将 .emacs 文件放在哪里？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-11T20:00:35.977

您需要`HOME`在计算机设置中设置环境变量（如果我没记错的话），或者将初始化文件放入默认目录（只需启动 Emacs，然后按`C-x C-f ~/`查看实际目录）。我记得，在 Windows 上，初始化文件可以被称为`_emacs`......

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-08-30T21:01:05.220

我将 emacs 作为便携式应用程序运行，这对我来说非常有效：

在您的 emacs 目录的根目录中创建一个批处理文件。例如，我创建了：

```
C:\Dropbox\PortableApps\emacs-24.3\run_emacs_portable.bat 
```

然后，编辑文件并将此文本放入其中：

```
set HOME=.\
bin\runemacs.exe %* 
```

现在，我只是通过`run_emacs_portable.bat`文件启动 emacs，我的 HOME 文件夹总是指向我的 emacs 安装文件夹。

%* 允许您将参数传递给 .bat 文件并将它们转发到 runemacs.exe

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T23:24:30.387

在主目录中 .emacs.d 是自动创建的，您可以将 init.el 作为启动文件。也可以参考这个[问题](https://stackoverflow.com/questions/3349172/whats-the-startup-sequence-for-emacs)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-29T16:17:01.963

要在 Windows 用户文件夹 (C:\Users\User\.emacs.d) 中设置 Emacs 主文件夹，只需将此代码添加到当前的初始化文件并重新启动 Emacs。

```
(when (eq system-type 'windows-nt)
  (unless (getenv "Home")
    (shell-command (format "setx \"%s\" \"%s\"" 'Home (getenv "UserProfile"))))) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-05T07:15:00.967

我喜欢 Роман Захаров 的回答，这似乎有助于维护跨平台配置，但它没有用。

这最终对我有用。

```
(when (eq system-type 'windows-nt)
  (setenv "Home" (getenv "UserProfile"))) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-11T23:26:51.013

您可以启动 emacs，键入`M-x pwd`，这将显示您在 Windows 文件树中的位置。你可以把你的`.emacs`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-16T13:56:19.653

如果您想使用 c:/users/USER/.emacs，您应该将 HOME 变量设置为 c:/users/USER，而不是 c:/users/USER/emacs。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-29T08:26:34.320

在 Windows 上，Emacs 启动时定义了一些属性，这些属性是在您右键单击 Windows 系统上的可执行文件时找到的。在那里你可以定义

1.  执行目录，例如“C:\Users\loggedin_user\”（在括号中）

2.  emacs 在哪里执行

3.  并查找 .xemacs (.emacs) 目录，并在其中找到它的 init.el。

4.  您可以在哪里定义启动指令（例如 (setenv "HOME" "c:/Users/Username/") ）等。

如果你配置它，下次emacs从你定义的目录开始，初始化文件

# javascript - 我可以在不使用编辑器的情况下使用 tinyMCE 清理算法吗？

> ID：10112664
> 
> 赞同：6
> 
> 时间：2012-04-11T19:32:16.933
> 
> 标签：javascript, dom, tinymce

我正在使用 tinyMCE 来编辑内容，它设置了清理规则，用于在将数据发回之前进行清理。但在我的应用程序的其他区域，我需要显示相同的内容......而且我不想指望它在放入数据库之前被正确清理（它可能已被另一个应用程序编辑）。

所以为了一致性起见（并且不必重复努力）有没有办法让我直接在 javascript 中使用 tinyMCE 清理/洗涤器，以便我可以在将其他内容放入 DOM 之前清理其他内容以供查看？就像是：

```
var data = getDataViaAjax(); 
var content = tinymce.scrubber.cleanup(data); 
$("someElement").append(content); 
```

* * *

## 更新 - 如何做到这一点的例子

```
function parse(html) {
    var settings = { 
       invalid_elements : "script,object,embed,link,style,form,input,iframe",
       valid_elements:"a[href],img[src],li,ul,ol,span,div,p,br,blockquote,h1,h2,h3,h4,h5,h6,strong/b,em/i,li,ul,ol"
    };

    var schema = new tinymce.html.Schema(settings);
    var parser = new tinymce.html.DomParser({}, schema);
    var serializer = new tinymce.html.Serializer({}, schema);

    return serializer.serialize(parser.parse(html));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T08:19:43.670

没有预定义的方式来使用此功能。为了让 mceCleanup-Action 在没有 tinymce 的情况下工作，您必须自己编写它，但您应该能够使用预定义的 javascript 类进行一些更改。查看开发人员 tinymce 版本（未压缩）。`serialize`在那里，您可以从目录中的文件`Serializer.js`中的函数开始`classes/dom`。

# javascript - JavaScript 对象何时被销毁？

> ID：10112670
> 
> 赞同：27
> 
> 时间：2012-04-11T19:32:38.993
> 
> 标签：javascript

在 C++ 中，我可以显式定义构造函数和析构函数，然后在构造函数/析构函数中使用 cout << "C or D Called" 来确切知道在哪里。

但是在 JavaScript 中，我如何知道对象何时被破坏。下面的例子是我关心的情况。

我在超时时调用了一个内部函数，我想知道只要计时器运行，对象是否还活着，等待再次调用下一个。

**用户点击调用控件**

```
// Calls  Control 
```

**控制调用消息**

```
var message_object = new Message( response_element ); 
```

**消息调用效果**

```
new Effects().fade( this.element, 'down', 4000 );
message_object.display( 'empty' ); 
```

**效果**

```
/**
 *Effects - build out as needed
 *  element - holds the element to fade
 *  direction - determines which way to fade the element
 *  max_time - length of the fade
 */

var Effects = function(  ) 
{
    this.fade = function( element, direction, max_time ) 
    {
        element.elapsed = 0;
        clearTimeout( element.timeout_id );
        function next() 
        {
            element.elapsed += 10;
            if ( direction === 'up' )
            {
                element.style.opacity = element.elapsed / max_time;
            }
            else if ( direction === 'down' )
            {
                element.style.opacity = ( max_time - element.elapsed ) / max_time;
            }
            if ( element.elapsed <= max_time ) 
            {
                element.timeout_id = setTimeout( next, 10 );
            }
        }
        next();
    }
}; 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-11T19:39:54.517

**2020 年编辑：[@BuffyG](https://stackoverflow.com/a/44090633/922470)的这个答案比我下面的旧答案更准确、更有用。对象销毁不仅仅是内存泄漏，现代 JavaScript 没有我提到的模式。**

JS 对象本身没有析构函数。

JavaScript 对象（和原语）在它们变得**不可访问**时被垃圾回收，这意味着在当前执行上下文中没有可能引用它们。JavaScript 运行时必须为此持续监控。因此，除非您使用`delete`关键字来删除某些东西，否则它的破坏就在幕后。有些浏览器不擅长检测留在闭包范围内的引用（我在看着你，Redmond），这就是为什么你经常看到在函数结束时将对象设置为 null 的原因——以确保在 IE 中释放内存。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-05-20T20:42:43.990

对象破坏可以简化为内存垃圾收集的想法让我觉得很危险，因为这个问题不能简化为释放内存。

析构函数负责释放其他资源，例如文件描述符或事件侦听器，垃圾回收不会自动处理这些资源。在这种情况下，析构函数绝对需要在释放内存之前展开状态，否则您将泄漏资源。

在这种情况下，析构函数不是一流的概念是一个问题，无论它们是需要显式调用还是可以在对象无法访问后隐式调用。

处理这个问题的最好方法是在需要使用析构函数时适当地记录你的模块，并强调资源泄漏场景无法使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-11T19:40:48.667

ECMAscript 中根本没有动态内存管理。垃圾收集器将处理脚本中需要内存的任何内容。所以实际上这个问题应该更像是，

> “垃圾收集器如何知道它何时可以为对象释放内存”

简单地说，大多数 GC 会查看是否有任何活动引用。这可能是由于父上下文对象、原型链或对给定对象的任何直接访问。在您的特定实例中，无论何时`setTimeout`执行，它都会调用`next()`关闭`.fade()`父上下文的`.face()`函数，而函数又持有函数的闭包`Effects`（上下文）。

这意味着，只要有对 的调用`setTimeout`，整个构造就会保存在内存中。

您有时可以帮助老式的 GC 实现，通过`null`ing 变量/对它的引用能够更早或根本收集一些东西，但是现代实现对这些东西非常聪明。您实际上不必关心诸如“对象/参考生存时间”之类的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-23T15:15:31.903

有一个实验性的 Firefox 和 Chrome 函数 window.requestIdleCallback() 在浏览器空闲时回调。这可以用来模拟类实例析构函数。

从下面的代码可以得到几乎相同的效果：

```
setTimeout(function()
    {
    // Simulate destructor here
    },0); 
```

这会设置一个自动关闭的超时，该超时会在当前 JavaScript 脚本完成（并且主事件循环恢复）时完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-19T15:29:23.773

另一个重要的考虑因素是数据结构中的*循环*引用：“A 引用 B，B 引用 A，不再有人引用它们中的任何一个。” 从理论上讲，这可能会导致 A 和 B 都被视为无法收集，从而导致内存泄漏。

该主题已在此处进行了讨论，并提供了一些相当近期的更新：

> [是否可以在 javascript 中创建“弱引用”？](https://stackoverflow.com/questions/266704/is-it-possible-to-create-a-weak-reference-in-javascript)

其中讨论的策略是“弱化” A 和 B 之间的引用之一，以便垃圾收集器知道它可以被破坏，从而导致它们最终被收割......或者可能在内存不足的情况下*被盗*.

当然，也可以从纪律中受益。如果你知道你不会再使用某些东西了，那么`Null`在你把它交给垃圾收集器之前，编写一个例程来设置它的各种引用字段…… *“保持整洁。”*

* * *

自从 JavaScript 变得如此重要以来，JavaScript 中的垃圾收集策略自从它们最早的实现以来已经有了很大的进步。当您学习有关此主题的文本时，请确保它们是*最近的。*

# assembly - DCPU-16 DIV 指令

> ID：10112671
> 
> 赞同：4
> 
> 时间：2012-04-11T19:32:39.757
> 
> 标签：assembly, dcpu-16

我正在查看 DCPU-16 的[规范](http://0x10c.com/doc/dcpu-16.txt)，但我无法理解使用 DIV 指令的溢出值的目的：

> DIV a, b - 将 a 设置为 a/b，将 O 设置为 ((a<<16)/b)&0xffff。

任何人都可以在这里解释 O 的语义含义，它有什么用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T19:48:19.640

看起来 O 给出了结果的小数部分（作为定点数）。例如，考虑 5 / 2：

```
a = 5 / 2 = 2 (integer part)
O = ((5 << 16) / 2) & 0xffff = (327680 / 2) & 0xffff = 32768 
```

如果您将 O 视为 16 个二进制小数位，则这表示结果的 0.5 小数部分。

另一种看待它的方式是以位为单位的二进制结果是：

```
aaaaaaaaaaaaaaaa.OOOOOOOOOOOOOOOO 
```

5 / 2 是

```
0000000000000010.1000000000000000 
```

通过检查可以看出，该结果是 5（101 二进制）右移一位进入小数位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:49:46.517

`((a<<16)/b)`将为您提供除法的 16 位小数部分。

以 10 为底更容易看出：如果我们想找到 5/3 的前三个小数位，我们可以将 5 移到 (5000) 上的三个位置，然后除以 3，然后取最后三个整数位数。5000/3 是 1666，所以 5/3 小数点后的前三位是 0.666。

* * *

这是有效的，因为“将 5 移动一位数”与“乘以 10”相同，并且乘法/除法是可交换的（可以交换顺序），所以`(5 * 1000) / 3`= `(5 / 3) * 1000`= `1.6666... * 1000`= `1666.666...`。

换句话说，将 5 移动几位并除以 3 与将 (5/3) 移动几位相同。

# java - Java中的重力弹跳球

> ID：10112676
> 
> 赞同：1
> 
> 时间：2012-04-11T19:33:20.677
> 
> 标签：java, gravity

> **可能重复：**
> [我如何将重力应用到我的弹跳球应用程序？](https://stackoverflow.com/questions/342189/how-do-i-apply-gravity-to-my-bouncing-ball-application)

我有一个从地面反弹的球类。

这是我的代码的一部分：

```
public void update(){
  yPos += ySpeed;
  ySpeed += gravity;

  if(yPos > BOTTOM_OF_SCREEN){
    ySpeed *= -1;
  }
} 
```

这段代码的问题是，当我在半空中有一个球时，它的弹跳比开始时高，并且弹跳得越来越高，但我希望它弹跳到与开始时相同的高度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:40:10.073

不要增加触底的速度（仅在它自由落体时）：

```
 void update() {
        yPos += ySpeed;

        if (yPos > BOTTOM_OF_SCREEN) {
            ySpeed *= -1;
        } else ySpeed += gravity;
    } 
```

# r - R中RandomForest包中的RandomForest函数中的参数'classwt'代表什么？

> ID：10112678
> 
> 赞同：21
> 
> 时间：2012-04-11T19:33:22.613
> 
> 标签：r, random-forest

帮助页面`randomforest::randomforest()`说：

> “classwt - 类的先验。不需要加起来。忽略回归。”

当您有大量不平衡数据时，可以设置`classwt`参数帮助，即。类的先验差异很大？

`classwt`在具有 3 个类且先验向量等于 (p1,p2,p3) 且在测试集中先验为 (q1,q2,q3) 的数据集上训练模型时，我应该如何设置？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-12T05:24:31.980

> 当您有大量不平衡数据时，设置 classwt 参数是否有帮助 - 类的先验差异很大？

是的，设置 classwt 的值对于不平衡的数据集可能很有​​用。我同意 joran 的观点，即这些值在采样训练数据的概率中进行了转换（根据 Breiman 在其原始文章中的论点）。

> 在具有 3 个类的训练数据集中，您的先验向量等于 (p1,p2,p3) 并且在测试集中的先验是 (q1,q2,q3)，如何设置 classwt？

对于培训，您可以简单地指定

```
rf <- randomForest(x=x, y=y, classwt=c(p1,p2,p3)) 
```

对于测试集，不能使用先验：1）`predict`randomForest包的方法中没有这样的选项；2）权重只对模型的训练有意义，对预测没有意义。

# python - PyArg_ParseTuple 默认参数

> ID：10112680
> 
> 赞同：5
> 
> 时间：2012-04-11T19:33:25.450
> 
> 标签：python, c, python-c-api, python-c-extension

如果我有以下函数并且`myobj`未传递可选参数，是`myobj`保留`NULL`还是设置为`Py_None`？

```
static PyObject * myfunc(PyObject * self, PyObject * args) {
    PyObject * myobj = NULL;
    if (!PyArg_ParseTuple(args, "|O", &myobj)) {
        return NULL;
    }
    // ...
} 
```

根据[解析参数和构建值](http://docs.python.org/c-api/arg.html#parsing-arguments-and-building-values)，

> `|`指示 Python 参数列表中的其余参数是可选的。与可选参数对应的 C 变量应初始化为其默认值——当未指定可选参数时，PyArg_ParseTuple() 不会触及相应 C 变量的内容。

这适用于`PyObject *`s 吗？它显然是一个存在于 C 中的指针，因此可以说它是 C 变量，但它是指向 python 对象的指针，因此也可以说它不算作 C 变量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T19:34:19.303

它将保持为 NULL。当然，指向结构的指针是 C 对象。

# visual-studio - 在VS2010部署项目中成功卸载后显示消息？

> ID：10112682
> 
> 赞同：1
> 
> 时间：2012-04-11T19:33:28.983
> 
> 标签：visual-studio, visual-studio-2010, uninstallation, setup-deployment

我的 VS2010 安装项目工作正常，但卸载过程完全是非交互式的。它会显示一个如下图所示的进度窗口，然后它会消失，而不会向用户提供任何反馈。VS2010 中的用户界面编辑器只有“安装”和“管理安装”树，没有“卸载”树。

![在此处输入图像描述](../Images/3cff8f71c026534fd0eb6b86dc5e72a6.png)

卸载完成后如何显示“[产品]已成功卸载”的MsgBox？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:15:25.777

一个简单的解决方案是添加一个 Commit[自定义操作](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368066%28v=vs.85%29.aspx)并使用：

```
REMOVE = "ALL" 
```

另一种方法是在您的 MSI 中设置[ARPNOREMOVE](http://msdn.microsoft.com/en-us/library/windows/desktop/aa367591%28v=vs.85%29.aspx)属性。在这种情况下，控制面板程序和功能小程序将仅显示使用完整 UI 的更改选项。使用基本 UI 的卸载选项将不可见。

# .net - 观察应用程序之间的.NET Remoting 通信的工具？

> ID：10112688
> 
> 赞同：4
> 
> 时间：2012-04-11T19:33:49.227
> 
> 标签：.net, windows, communication, .net-remoting, communication-protocol

我们在两个应用程序之间的通信存在问题。根据软件提供商的说法，这种通信是一种 .NET Remoting。我们只是想验证哪个程序首先关闭了通信，希望它可以为进一步的调试提供帮助。有什么工具可以方便观察.NET Remoting 通信吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T15:05:18.667

第一：最终用户没有责任弄清楚这一点：您的软件供应商应该共同努力，找出这两个应用程序无法正常通信的原因。

我的回答：您可以使用 Ethereal 或 Wireshark 来监控网络连接并找出哪个应用程序首先关闭了网络连接。

# wcf - TransactionFlowAttribute 属性设置为 Mandatory 但通道的绑定未配置 TransactionFlowBindingElement

> ID：10112690
> 
> 赞同：2
> 
> 时间：2012-04-11T19:33:53.940
> 
> 标签：wcf, distributed-transactions

我有一个大问题。我正在尝试创建一个可用于分布式事务的 Web 服务。
下面的所有代码都在 Web 服务的服务器端（从客户端调用的 Web 服务）。
我在我的界面中写了这个：

```
[ServiceContract]
public interface IClientOperations
{

    [OperationContract]
    [ServiceKnownType(typeof(TriggerExecInput))]
    [ServiceKnownType(typeof(TriggerExecOutput))]
    [TransactionFlow(TransactionFlowOption.Mandatory)]
    TriggerExecOutput TriggeredProfileDataUpdate(TriggerExecInput triggerInputData, bool isST3StatusActive); 
```

这在 web.config 文件中：

```
<services>
  <service name="ClientOperationsService" behaviorConfiguration="ServiceBehavior">
    <endpoint address="" binding="wsHttpBinding" 
              bindingConfiguration="wsHttpBinding_Common" contract="SL.STAdmin.Applications.WebAPI.IClientOperations"/>
    <endpoint contract="IMetadataExchange" binding="mexHttpBinding" address="mex"/>
  </service>
</services>

<bindings>
  <wsHttpBinding>
    <binding name="wsHttpBinding_Common" transactionFlow="true">
    </binding>
  </wsHttpBinding>
</bindings>
<behaviors>
  <serviceBehaviors>
    <behavior name="ServiceBehavior">
      <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
      <serviceMetadata httpGetEnabled="true"/>
      <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
      <serviceDebug includeExceptionDetailInFaults="false"/>
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

如果我右键单击 .svc 文件并单击“在浏览器中查看”，我会收到以下错误

```
Exception Details: System.InvalidOperationException: At least one operation on the 'ClientOperations' contract is configured with the TransactionFlowAttribute attribute set to Mandatory but the channel's binding 'BasicHttpBinding' is not configured with a TransactionFlowBindingElement. The TransactionFlowAttribute attribute set to Mandatory cannot be used without a TransactionFlowBindingElement. 
```

我还有其他不使用事务的 .svc 文件。他们都运作良好。我不明白为什么当我指示它使用其他绑定类型时它仍然尝试使用 BasicHttpTransaction。

有人知道我做错了什么吗？先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T01:54:22.007

将此添加到`<system.serviceModel>`web.config 的元素中：

```
<protocolMapping>
  <add scheme="http" binding="wsHttpBinding" bindingConfiguration="wsHttpBinding_Common"/>
</protocolMapping> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-08T09:27:22.957

您需要做一些事情才能使交易正常进行。将交易流添加到您的操作中

```
[OperationContract]
[TransactionFlow(TransactionFlowOption.Mandatory)]
void TransactionSupported(int id, string name); 
```

之后，您将操作行为添加到您的实现中

```
[OperationBehavior(TransactionScopeRequired = true)]
public void TransactionSupported(int id, string name)
{
    ...
} 
```

在您的配置文件中，您需要将事务流添加到您的主机绑定

```
<system.serviceModel>
    ...
    <bindings>
      <netNamedPipeBinding> --> Your binding (don't use basicHttpBinding)
        <binding transactionFlow="true"/>
      </netNamedPipeBinding>
    </bindings>
  </system.serviceModel> 
```

最后但并非最不重要的一点是，您需要设置客户端的事务流以使其正常工作。在我的示例中，我在单元测试的代码中执行此操作，我认为您也可以在您的客户端配置中执行此操作，在您的配置文件中。

```
var factory = new ChannelFactory<IService>(callback,
              new NetNamedPipeBinding() { TransactionFlow = true },
              new EndpointAddress("net.pipe://localhost/ping")); 
```

# c++ - 在 C++ 中使用两个输入来记忆一个函数

> ID：10112693
> 
> 赞同：3
> 
> 时间：2012-04-11T19:33:59.077
> 
> 标签：c++

我有一个函数，`f(a,b)`它接受两个输入。我不知道将使用`a`和的哪些值。`b`我可以在内存上有点浪费（我关心速度）。我希望能够检查 的输出`f(a,b)`是否已经交付，如果是，则再次交付该输出，而无需重新运行该`f(a,b)`流程。

在 Python 中使用装饰器很容易做到这一点，但 C++ 在我这里是遥不可及的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T19:37:34.567

我会使用一个[std::map](http://www.cplusplus.com/reference/stl/map/)（或者可能是一个`std::unordered_map`），它的键是一个[std::pair](http://www.cplusplus.com/reference/std/utility/pair/)，或者可能使用一个地图的地图。

在这种情况下，C++11 的改进可能会有所帮助。或者也许是一些 Boost 的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T20:14:45.930

海报问：

> 我希望能够检查 f(a,b) 的输出是否已经交付，如果是，则再次交付该输出，而无需重新运行 f(a,b) 流程。

在 C++ 中使用`std::map`. 函数恰好有两个参数这一事实意味着我们可以`std::pair`用来描述它们。

```
#include <map>
#include <iostream>

uint64_t real_f(int a, int b) {
  std::cout << "*";
  // Do something tough:
  return (uint64_t)a*b;
}

uint64_t memo_f(int a, int b) {
  typedef std::pair<int, int> key;
  typedef std::map<key, uint64_t> map;
  static map m;
  key k(a,b);
  map::iterator it = m.find(k);
  if(it == m.end()) {
    return m[k] = real_f(a, b);
  }
  return it->second;
}

int main () {
  std::cout << memo_f(1, 2) << "\n";
  std::cout << memo_f(3, 4) << "\n";
  std::cout << memo_f(1, 2) << "\n";
  std::cout << memo_f(3, 4) << "\n";
  std::cout << memo_f(5, 6) << "\n";
} 
```

上述程序的输出是：

```
*2
*12
2
12
*30 
```

没有星号的行代表缓存的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T19:55:29.950

使用 C++11，您可以使用任务和期货。让`f`成为你的功能：

```
int f(int a, int b)
{
    // Do hard work.
} 
```

然后你会安排函数执行，它会返回一个返回值的句柄。这个句柄被称为*未来*：

```
template <typename F>
std::future<typename std::result_of<F()>::type>
schedule(F f)
{
    typedef typename std::result_of<F()>::type result_type;
    std::packaged_task<result_type> task(f);
    auto future = task.get_future();

    tasks_.push_back(std::move(task)); // Queue the task, execute later.
    return std::move(future);
} 
```

然后，您可以按如下方式使用此机制：

```
auto future = schedule(std::bind(&f, 42, 43)); // Via std::bind.
auto future = schedule([&] { f(42, 43); });    // Lambda alternative.

if (future.has_value())
{
    auto x = future.get();  // Blocks if the result of f(a,b) is not yet availble.
    g(x);
} 
```

免责声明：我的编译器不支持任务/期货，所以代码可能有一些粗糙的边缘。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T20:21:38.460

关于这个问题的要点是计算 f(a,b) 和保留某种查找表以缓存结果之间的 CPU 和 RAM 的相对开销。

由于 128 位索引长度的详尽表（还）不可行，我们需要将查找空间减少到可管理的大小 - 如果在您的应用程序内部没有一些考虑，这是无法完成的：

*   **函数输入的实际使用**空间有多大？里面有图案吗？
*   时间成分呢？您是否希望重复计算彼此接近或沿时间线分布？
*   分布情况如何？您是否假设索引空间的一小部分会消耗大部分函数调用？

我会简单地从一个固定大小的元组数组`(a,b, f(a,b))`和线性搜索开始。根据上面询问的模式，您可能想要

*   窗口滑动它（在缓存未命中时删除最旧的）：这对本地化重复有好处
*   具有`(a,b,f(a,b),count)`最小计数的元组被驱逐的元组 - 这对非本地化事件有好处
*   有一些关键功能确定缓存中的位置（这有利于小索引空间的使用）
*   高德纳或谷歌可能想到的任何其他东西

如果查找机制变得越来越复杂，您可能还希望根据查找机制对重复计算进行基准测试：`std::map`并且朋友不是免费的，即使他们是高质量的实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-04T02:17:51.920

唯一简单的方法是使用`std::map`. `std::unordered_map`不起作用。我们不能`std::pair`在无序映射中用作键。您可以执行以下操作，

```
std::map<pair<int, int>, int> mp; 

int func(int a, int b)
{
  if (mp.find({a, b}) != mp.end()) return mp[{a, b}];
  // compute f(a, b)...
  mp[{a, b}] = // computed value;
  return mp[{a, b}];
} 
```

# c# - 如何实现 IAsyncOperationWithProgress

> ID：10112696
> 
> 赞同：6
> 
> 时间：2012-04-11T19:34:08.460
> 
> 标签：c#, asynchronous, stream, windows-runtime

我正在将一些自定义 .NET 流移植到 WINRT。语言是 C#。

是否有一些 IAsyncOperationWithProgress 的示例实现？由于方法 ReadAsync，Windows.Storage.Streams 中的 WriteAsync 需要它们。也欢迎自定义 WinRT 流实现。

我找到了一些使用 create_async 的 C 示例，但我希望在 C# 中执行此操作，但在 Metro 框架中找不到 create_async。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T22:14:07.120

下面是使用 IAsyncOperationWithProgress 以编程方式显示安装 XAP 文件的进度的示例。我对 Win8 开发还很陌生，所以不确定它是否完全惯用。

请注意 Dispatcher.BeginInvoke 将进度编组回 UI 线程。希望能帮助到你：

```
private async void InstallApp(string name, Uri uri)
{
    try
    {
        StatusTextBlock.Text = "Installing app";
        var installTask = InstallationManager.AddPackageAsync(name, uri);

        installTask.Progress = (installResult, progress) => Dispatcher.BeginInvoke(() =>
        {
            StatusTextBlock.Text = "Progress: " + progress;
        });

        var result = await installTask;
        StatusTextBlock.Text = "Done: " + result.InstallState.ToString();
    }
    catch (Exception ex)
    {
        StatusTextBlock.Text = "Failed to install: " + ex.Message;
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-12T15:05:42.093

对于 C#，您应该查看[//build talk on async programming](http://channel9.msdn.com/events/BUILD/BUILD2011/TOOL-810T)。

如果您使用的是高级 C++，您应该查看[这篇](http://blogs.msdn.com/b/nativeconcurrency/archive/2011/09/22/windows-8-asynchrony-with-ppl.aspx)关于如何在 PPL 中执行异步操作的文章。

如果您需要从低级 C++ 实现自己的异步操作，您应该查看[WRL::AsyncBase](http://msdn.microsoft.com/en-us/library/br244878%28v=vs.110%29.aspx)类。

# mysql - MySQL 输出屏蔽（即电话号码、SSN 等显示格式）

> ID：10112718
> 
> 赞同：6
> 
> 时间：2012-04-11T19:36:15.637
> 
> 标签：mysql

是否有内置的 SQL 函数可以屏蔽输出数据？

假设我有一个整数列，它代表一个电话号码（对于任何国家）。有没有比将它们分开、加载散列、破折号和点，然后将它们重新连接在一起更好的方法来显示数字？

我知道几种语言都有一个功能，可以在显示数据时简单地屏蔽数据，而不是对其进行重组。MySQL有类似的东西吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-11T22:49:59.320

这是我想出的，如果您有任何修改或改进，请留下评论，我会更新代码。否则，如果您喜欢它，请不要碰它。享受！

```
DELIMITER //

CREATE FUNCTION mask (unformatted_value BIGINT, format_string CHAR(32))
RETURNS CHAR(32) DETERMINISTIC

BEGIN
# Declare variables
DECLARE input_len TINYINT;
DECLARE output_len TINYINT;
DECLARE temp_char CHAR;

# Initialize variables
SET input_len = LENGTH(unformatted_value);
SET output_len = LENGTH(format_string);

# Construct formated string
WHILE ( output_len > 0 ) DO

SET temp_char = SUBSTR(format_string, output_len, 1);
IF ( temp_char = '#' ) THEN
IF ( input_len > 0 ) THEN
SET format_string = INSERT(format_string, output_len, 1, SUBSTR(unformatted_value, input_len, 1));
SET input_len = input_len - 1;
ELSE
SET format_string = INSERT(format_string, output_len, 1, '0');
END IF;
END IF;

SET output_len = output_len - 1;
END WHILE;

RETURN format_string;
END //

DELIMITER ; 
```

以下是如何使用它...它仅适用于整数（即 SSN Ph# 等）

```
mysql> select mask(123456789,'###-##-####');
+-------------------------------+
| mask(123456789,'###-##-####') |
+-------------------------------+
| 123-45-6789                   |
+-------------------------------+
1 row in set (0.00 sec)

mysql> select mask(123456789,'(###) ###-####');
+----------------------------------+
| mask(123456789,'(###) ###-####') |
+----------------------------------+
| (012) 345-6789                   |
+----------------------------------+
1 row in set (0.00 sec)

mysql> select mask(123456789,'###-#!##@(###)');
+----------------------------------+
| mask(123456789,'###-#!##@(###)') |
+----------------------------------+
| 123-4!56@(789)                   |
+----------------------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-29T17:27:49.507

假设您的`People`表有`namelast`、`namefirst`和`phone`字段。

```
SELECT p.namelast, p.namefirst,     
  CONCAT(SUBSTR(p.phone,1,3), '-', SUBSTR(p.phone,4,3), '-', SUBSTR(p.phone,7,4)) AS Telephone, 
FROM People p 
```

第`CONCAT(SUBSTR())`一个位置使用字段名称，第二个位置使用字符位置，第三个位置使用数字位数。使用“AS Telephone”可以使查询输出中的列标题保持整洁。

*需要注意的一点：我建议不要对电话号码、社会保险号码等使用整数。原因是您可能永远不会使用这些数字进行数值计算。虽然您有可能将它们用作主键，但总是有可能丢失带有前导零的数字的数字。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:43:41.170

是的，mySQL 确实具有格式化功能： [http ://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_format](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_format)

但你也几乎回答了你自己的问题。MySQL 没有相同的能力来轻松编写基于其他标准的格式化程序。它可以，使用 if 语句，但逻辑最多使 SQL 难以阅读。因此，例如，如果您尝试使用基于国家/地区代码的格式化程序，则必须在 SQL 语句中写入大量逻辑，如果您可以选择另一种语言解析结果。

# python - 合并两个列表并在 python 中使用分隔符将它们相应地连接起来

> ID：10112725
> 
> 赞同：1
> 
> 时间：2012-04-11T19:36:41.103
> 
> 标签：python, list

我对python有点陌生。

我如何合并两个列表（两个字符串）并在 python 中相应地加入它们？

给定以下输入：

```
lista=['1','2','3']
listb=['a','b','c'] 
```

我想要以下输出：

```
['1|a','2|b','3|c'] 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T19:39:46.897

假设您实际上打算使用字符串，这应该有效：

```
>>> lista=[1,2,3]
>>> listb=['a','b','c']
>>> ["%s|%s" % (a,b) for a,b in zip(lista, listb)]
['1|a', '2|b', '3|c'] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T19:45:30.383

这仅在您的两个列表都包含字符串时才有效。否则，请使用其中一种格式化字符串解决方案（例如`%s|%s`）。

```
map('|'.join, zip(lista, listb)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T20:15:41.473

列表推导通常更具可读性，但连接操作是让这个比例适合任意数量的列表的最好方法，并且读起来很好，所以我也会提出其他答案的合并：

```
>>>lista=['1','2','3']
>>>listb=['a','b','c']
>>>["|".join(items) for items in zip(lista, listb)]
['1|a', '2|b', '3|c'] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T19:40:20.567

可能有比这更优雅的东西

```
map(lambda(x,y): "%s|%s" % (x,y), zip(lista, listb)) 
```

# php - Codeigniter -> 图像上传第 3 部分 -> 图像验证

> ID：10112728
> 
> 赞同：0
> 
> 时间：2012-04-11T19:36:46.260
> 
> 标签：php, image, codeigniter

我有下面的代码，但由于有多个，我不确定如何处理上传错误`$this->do_upload`

```
 $location = $_SERVER['DOCUMENT_ROOT'].'/_assets/quote/uploads/';

        $folderName = $this->quote->getCompanyDetails()->companyName;
        $folderName = str_replace(" ", "_", $folderName);
        $folderName = strtolower($folderName);

        $concepts = array('conceptOne','conceptTwo');
        $logo = $folderName.'_logo';

        if(!is_dir($location.$folderName))
        {   
            mkdir($location.$folderName);
            chmod($location.$folderName, 0777);
        }

        //Set File Settings 
          $config['upload_path'] = $location.$folderName; 
          $config['allowed_types'] = 'jpg|png|pdf'; 
          $config['remove_spaces'] = TRUE;
          $config['overwrite'] = TRUE;
          $config['max_size'] = '1024'; 
          $config['max_width'] = '1024'; 
          $config['max_height'] = '768'; 

          $this->load->library('upload', $config);

        // Upload Concepts

        foreach($concepts as $concept)
        {
             $config['file_name'] = $concept;
             $this->upload->initialize($config);
             $this->upload->do_upload($concept);
        }

        //Upload Logo

            $config['file_name'] = $logo;
             $this->upload->initialize($config);
             $this->upload->do_upload('logo'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:58:36.580

```
 // Upload Concepts
    foreach($concepts as $concept)
    {
         $config['file_name'] = $concept;
         $this->upload->initialize($config);
         if ( ! $this->upload->do_upload($concept))
         {
           $error = array('error' => $this->upload->display_errors());
           break;
         }
    } 
```

# tcpdump - 在 TCP 级别收到数据包但无法读取

> ID：10112729
> 
> 赞同：0
> 
> 时间：2012-04-11T19:36:45.893
> 
> 标签：tcpdump, smpp

我们使用 SMPP 协议向 SMSC 发送消息。当 SMSC 重新启动会话时，客户端再次成功绑定它但客户端无法获取/读取进一步的 pdu，如 SMSC 已发送的 submit_resp、enquire_resp。我们使用wireshark检查了tcp转储，发现客户端在tcp转储中接收到tcp数据包，应用程序无法读取任何内容，在应用程序中，我们使用了Logica smpp lib。我们通过在logica lib中放置更多日志进行检查，然后发现Logica lib没有从socket中读取任何内容。请发表评论，可以提供更详细的指导！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:16:45.487

您提到当 SMSC 重新启动时，

1.  客户端再次绑定。
2.  客户端无法读取后续 PDU。

由于该问题没有提供任何具体信息，因此我将不得不猜测问题所在。我建议检查陈旧的 com.logica.smpp.Session 对象的代码。

# node.js - 从表单中获取发布的数据

> ID：10112730
> 
> 赞同：4
> 
> 时间：2012-04-11T19:36:48.053
> 
> 标签：node.js

这是一个发布的html表单：

```
<html>
<body>
<h1>Home Html Page</h1>
<a href="/Product/Index">Go To Product</a>
<hr/>
<form action="/Home/Index" method="POST" name="form1">
    Enter Text:
    <input type="text" id="txtInput"/>
    <button id="btnPost">Post Data</button>
</form>
</body>
</html> 
```

这是应该获取发布数据的 JavaScript 代码：

```
function Server(req, resp) {
    if (req.method == 'POST') {
        var chunk = '';
        req.on('data', function (data) {
            chunk += data;
        });
        req.on('end', function () {
            console.log(chunk + "<-Posted Data Test");
        });
    }'

    ...

    resp.write(...);
    resp.end();
} 
```

你能帮助我吗？我是nodejs的新手，你能给我举个例子吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T20:02:38.323

`name`您必须像这样在`<input>`元素上指定 a ：

```
<input name="txtInput" type="text" id="txtInput"> 
```

只有那些有`name`设置的人才能发布。

例子：

```
var http=require('http');
var util=require('util');
var querystring=require('querystring');

var server=http.createServer(function(req,res){
    if (req.method=='GET'){
        res.end('<form action="/Home/Index" method="POST" name="form1">Enter Text:<input name="txtInput" type="text" id="txtInput"/><button type="submit" id="btnPost">Post Data</button></form></body></html>');
    }else{

        var chunk = '';
        req.on('data', function (data) {
            chunk += data;
        });
        req.on('end', function () {
            console.log(chunk + "<-Posted Data Test");

            res.end(util.inspect(querystring.parse(chunk)));
        });

    }
}).listen(8080); 
```

要解析表单数据，只需使用[querystring.parse(str, [sep], [eq])](http://nodejs.org/api/querystring.html#querystring_querystring_parse_str_sep_eq)（如上面的示例）

例子：

```
querystring.parse('foo=bar&baz=qux&baz=quux&corge')
// returns
{ foo: 'bar', baz: ['qux', 'quux'], corge: '' } 
```

# python - 使用 Python 压缩、加密、Gziped 文件

> ID：10112732
> 
> 赞同：4
> 
> 时间：2012-04-11T19:36:50.243
> 
> 标签：python

我必须处理一种“专有”文件格式，它只不过是一堆文本文件，每个文件都经过 gzip 压缩，然后加密，最后全部捆绑在一个 zip 文件中。我正在使用 python 来自动提取这些文件。因此使用 ZipFile 可以轻松解压。然后我有一个 xyz_001.gz.rc4 文件列表，我可以使用 RC4 + 密钥对其进行解密。但是，这给我留下了一个 gz 流，并且无法使用 gzip 标准库模块打开该流。我想我可以将该流存储到磁盘然后打开该 gz 文件，但我想知道是否有更优雅的方式来处理它。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T19:44:32.963

您可以使用该`zlib`模块解压缩 gzip 流，例如：

```
zlib.decompress(inf, 16+zlib.MAX_WBITS) 
```

`inf`你的 gzip 流在哪里。这`16 + zlib.MAX_WBITS`是一个使 zlib 跳过 gzip 标头的神奇值。

# haskell - Haskell - 简单的构造函数比较（？）函数

> ID：10112733
> 
> 赞同：26
> 
> 时间：2012-04-11T19:36:56.807
> 
> 标签：haskell

在我的项目中，我创建了一个数据类型，它可以保存以下几种类型的值之一：

```
data PhpValue = VoidValue | IntValue Integer | BoolValue Bool 
```

我现在想做的是有一种简单的方法来检查`PhpValue`类型的两个值是否属于同一个构造函数（如果我对这里的术语感到困惑，请纠正我，但基本上我想检查两者是否都是，例如， are `IntValue`，而不关心特定值）。

这是我为此编写的一个函数：

```
sameConstructor :: PhpValue -> PhpValue -> Bool
sameConstructor VoidValue VoidValue = True
sameConstructor (IntValue _) (IntValue _) = True
sameConstructor (BoolValue _) (BoolValue _) = True
sameConstructor _ _ = False 
```

这可以正常工作，但我不太喜欢它：如果我添加更多构造函数（如`FloatValue Float`），我将不得不重写该函数，并且随着我的数据定义变得更大，它会变得更大。

**问题：**有没有办法编写这样一个函数，这样当我添加更多构造函数时它的实现不会改变？

作为记录：我不想更改`data`定义，我的其余代码中有足够的 Monads ;)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-11T19:44:33.933

看看`Data.Data`它的`toConstr`功能。这将返回构造函数的表示形式，可以比较其是否相等。

通过扩展（您可以放在`{-# LANGUAGE DeriveDataTypeable #-}`模块的顶部），您可以`Data`自动为您派生一个实例：

```
data PhpValue = VoidValue | IntValue Integer | BoolValue Bool 
              deriving (Typeable, Data) 
```

然后，您应该能够使用该`toConstr`函数通过构造函数进行比较。

现在以下将是正确的：

```
toConstr (BoolValue True) == toConstr (BoolValue False) 
```

使用`on`from`Data.Function`你现在可以重写`sameConstructor`为：

```
sameConstructor = (==) `on` toConstr 
```

这与

```
sameConstructor l r = toConstr l == toConstr r 
```

我认为使用的版本`on`一目了然。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-11T19:52:36.960

这被称为 Haskell 和 ML 系列语言中的[表达问题](http://journal.stuffwithstuff.com/2010/10/01/solving-the-expression-problem/)；有许多不令人满意的解决方案（包括`Data.Typeable`在 Haskell 中使用和滥用类型类），但没有好的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-01T17:29:43.603

一种流行的替代方法`Data`是`Generic`. 我认为`Data`在这种情况下可能更有意义，但我认为为了完整性而添加它是有意义的。

```
{-# LANGUAGE DefaultSignatures, TypeOperators, FlexibleContexts #-}
module SameConstr where

import GHC.Generics
import Data.Function (on)

class EqC a where
    eqConstr :: a -> a -> Bool
    default eqConstr :: (Generic a, GEqC (Rep a)) => a -> a -> Bool
    eqConstr = geqConstr `on` from

class GEqC f where
  geqConstr :: f p -> f p -> Bool
  {-# INLINE geqConstr #-}
  geqConstr _ _ = True

instance GEqC f => GEqC (M1 i c f) where
  {-# INLINE geqConstr #-}
  geqConstr (M1 x) (M1 y) = geqConstr x y

instance GEqC (K1 i c)
instance GEqC (f :*: g)
instance GEqC U1
instance GEqC V1

instance (GEqC f, GEqC g) => GEqC (f :+: g) where
  {-# INLINE geqConstr #-}
  geqConstr (L1 x) (L1 y) = geqConstr x y
  geqConstr (R1 x) (R1 y) = geqConstr x y
  geqConstr _ _ = False 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-30T04:51:56.803

由于定义遵循常规格式，您可以使用 Template Haskell 为任何数据类型自动派生此类函数。我继续为此编写了一个[简单的包](https://github.com/daig/data-constructors)，因为我对现有的解决方案并不完全满意。

首先，我们定义一个类

```
class EqC a where
    eqConstr :: a -> a -> Bool
    default eqConstr :: Data a => a -> a -> Bool
    eqConstr = (==) `on` toConstr 
```

然后是一个`deriveEqC :: Name -> DecsQ`会自动为我们生成实例的函数。

是[默认签名](https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html?highlight=defaultsignatures#ghc-flag--XDefaultSignatures)，意味着当类型是 的实例时，`default`我们可以省略 的定义，并回退到 Tikhon 的实现。`Data``eqConstr`

模板 Haskell 的好处是它产生了更有效的函数。我们可以编写`$(deriveEqC ''PhpValue)`并获得一个与我们手动编写的完全相同的实例。看一下生成的核心：

```
$fEqCPhpValue_$ceqConstr =
  \ ds ds1 ->
    case ds of _ { 
      VoidValue ->
        case ds1 of _ { 
          __DEFAULT -> False;
          VoidValue -> True
        };  
      IntValue ds2 ->
        case ds1 of _ { 
          __DEFAULT -> False;
          IntValue ds3 -> True
        };  
      BoolValue ds2 ->
        case ds1 of _ { 
          __DEFAULT -> False;
          BoolValue ds3 -> True
        }   
    } 
```

相比之下， using在比较它们是否相等之前通过具体化每个参数`Data`的显式来引入大量额外的间接：`Constr`

```
eqConstrDefault =
  \ @ a $dData eta eta1 ->
    let {
      f
      f = toConstr $dData } in
    case f eta of _ { Constr ds ds1 ds2 ds3 ds4 ->
    case f eta1 of _ { Constr ds5 ds6 ds7 ds8 ds9 ->
    $fEqConstr_$c==1 ds ds5
    }
    } 
```

（计算中还有很多其他的膨胀`toConstr`，不值得展示）

在实践中，这导致 Template Haskell 实现的速度大约是两倍：

```
benchmarking EqC/TH
time                 6.906 ns   (6.896 ns .. 6.915 ns)
                     1.000 R²   (1.000 R² .. 1.000 R²)
mean                 6.903 ns   (6.891 ns .. 6.919 ns)
std dev              45.20 ps   (32.80 ps .. 63.00 ps)

benchmarking EqC/Data
time                 14.80 ns   (14.77 ns .. 14.82 ns)
                     1.000 R²   (1.000 R² .. 1.000 R²)
mean                 14.79 ns   (14.77 ns .. 14.81 ns)
std dev              60.17 ps   (43.12 ps .. 93.73 ps) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T21:50:07.503

在您的特殊情况下，您可以使用`Show`编译器的魔力：

```
data PhpValue = VoidValue | IntValue Integer | BoolValue Bool deriving Show

sameConstructor v1 v2 = cs v1 == cs v2 where 
   cs = takeWhile (/= ' ') . show 
```

当然取决于编译器生成的字符串表示非常接近黑客......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-01T23:39:27.120

如果您不想在其他答案中使用任何合理的方式，则可以使用完全不受支持的方式，这种方式可以保证快速，但实际上不能保证给出正确的结果，甚至不会崩溃。请注意，这甚至会很乐意尝试比较函数，因为它会给出完全虚假的结果。

```
{-# language MagicHash, BangPatterns #-}

module DangerZone where

import GHC.Exts (Int (..), dataToTag#)
import Data.Function (on)

{-# INLINE getTag #-}
getTag :: a -> Int
getTag !a = I# (dataToTag a)

sameConstr :: a -> a -> Bool
sameConstr = (==) `on` getTag 
```

另一个问题（可以说）是它通过新类型对等。所以如果你有

```
newtype Foo a = Foo (Maybe a) 
```

然后

```
sameConstr (Foo (Just 3)) (Foo Nothing) == False 
```

即使它们是使用`Foo`构造函数构建的。您可以通过使用 中的一些机制来解决此问题`GHC.Generics`，但没有与使用未优化的泛型相关的运行时成本。这变得很毛茸茸！

```
{-# language MagicHash, BangPatterns, TypeFamilies, DataKinds,
             ScopedTypeVariables, DefaultSignatures #-}

import Data.Proxy (Proxy (..))
import GHC.Generics
import Data.Function (on)
import GHC.Exts (Int (..), dataToTag#)

--Define getTag as above

class EqC a where
  eqConstr :: a -> a -> Bool
  default eqConstr :: forall i q r s nt f.
                      ( Generic a
                      , Rep a ~ M1 i ('MetaData q r s nt) f
                      , GNT nt)
                   => a -> a -> Bool
  eqConstr = genEqConstr

-- This is separated out to work around a bug in GHC 8.0
genEqConstr :: forall a i q r s nt f.
                      ( Generic a
                      , Rep a ~ M1 i ('MetaData q r s nt) f
                      , GNT nt)
                   => a -> a -> Bool
genEqConstr = (==) `on` modGetTag (Proxy :: Proxy nt)

class GNT (x :: Bool) where
  modGetTag :: proxy x -> a -> Int

instance GNT 'True where
  modGetTag _ _ = 0

instance GNT 'False where
  modGetTag _ a = getTag a 
```

这里的关键思想是我们查看与类型的通用表示相关联的类型级元数据，以确定它是否是新类型。如果是，我们将其“标签”报告为`0`; 否则我们使用它的实际标签。

# php - 软件更新后 Apache 配置损坏

> ID：10112743
> 
> 赞同：-1
> 
> 时间：2012-04-11T19:37:34.933
> 
> 标签：php, apache, configuration, indexing, rewrite

我刚刚更新了我的 Ubuntu 过时的开发服务器，它破坏了一些配置。现在 apache/php 不能正确处理 url 之类`index.php/profile`的，但只会正确处理`index.php`.

基本上如果后面有一些路径`index.php`，那么它将返回 404 错误：在此服务器上找不到请求的 URL /index.php/profile。

什么配置选项可能会解决此问题？我需要紧急解决这个问题。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:46:31.017

检查[AcceptPathInfo](http://httpd.apache.org/docs/2.2/mod/core.html#acceptpathinfo)的设置：

> 该指令控制是否接受或拒绝包含跟随实际文件名（或现有目录中不存在的文件）的尾随路径名信息的请求。PATH_INFO 环境变量中的脚本可以使用尾随路径名信息。
> 
> 例如，假设位置 /test/ 指向仅包含单个文件 here.html 的目录。然后对 /test/here.html/more 和 /test/nothere.html/more 的请求都将 /more 收集为 PATH_INFO。

# python - Python：多维数组的迭代是不是超级慢？

> ID：10112745
> 
> 赞同：6
> 
> 时间：2012-04-11T19:37:37.217
> 
> 标签：python, performance, numpy

我必须迭代二维整数数组中的所有项目并更改值（根据某些规则，不重要）。

我很惊讶 python 运行时和 C# 或 java 运行时之间的性能差异有多大。我是否写了完全错误的python代码（v2.7.2）？

```
import numpy
a = numpy.ndarray((5000,5000), dtype = numpy.int32)
for x in numpy.nditer(a.T):
    x = 123 
```

```
>python -m timeit -n 2 -r 2 -s "import numpy; a = numpy.ndarray((5000,5000), dtype=numpy.int32)" "for x in numpy.nditer(a.T):" "  x = 123"
2 loops, best of 2: 4.34 sec per loop 
```

例如，C# 代码只执行 50 毫秒，即 python 几乎**慢了 100 倍**！（假设`matrix`变量已经初始化）

```
for (y = 0; y < 5000; y++)
for (x = 0; x < 5000; x++)
    matrix[y][x] = 123; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-11T19:45:07.840

是的！在 python 中遍历 numpy 数组很慢。（也比遍历 python 列表要慢。）

通常，您会避免直接遍历它们。

如果你能给我们一个例子来说明你改变事物所基于的规则，那么它很可能很容易矢量化。

作为一个玩具示例：

```
import numpy as np

x = np.linspace(0, 8*np.pi, 100)
y = np.cos(x)

x[y > 0] = 100 
```

然而，在许多情况下，您必须进行迭代，要么是由于算法（例如有限差分方法），要么是为了减少临时数组的内存成本。

在这种情况下，请查看[Cython](http://cython.org/)、[Weave](http://www.scipy.org/Weave/)或类似的东西。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-11T19:50:31.560

您给出的示例可能是要将二维 NumPy 数组的所有项设置为 123。这可以像这样有效地完成：

```
a.fill(123) 
```

或者

```
a[:] = 123 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-11T21:37:39.277

Python 是一种比 C 或 C# 更具动态性的语言。循环如此缓慢的主要原因是，在每次通过时，CPython 解释器都在做一些浪费时间的额外工作：具体来说，它将名称`x`与迭代器中的下一个对象绑定，然后在评估它的赋值时再次查找名称`x`。

正如@Sven Marnach 指出的那样，您可以调用方法函数`numpy.fill()`并且速度很快。该函数是用 C 或 Fortran 编译的，它会简单地遍历`numpy.array`数据结构的地址并填写值。比 Python 动态性要低得多，这对于这种简单的情况很有用。

但现在考虑 PyPy。在 PyPy 下运行程序后，JIT 会分析代码实际在做什么。在此示例中，它注意到名称`x`仅用于分配，它可以优化绑定名称。这个例子应该是 PyPy 加速的一个例子；PyPy 可能会比普通的 Python 快十倍（所以只有 C 的十分之一，而不是 1/100）。

[http://pypy.org](http://pypy.org)

据我了解，PyPy 暂时不会使用 Numpy，所以你不能只在 PyPy 下运行现有的 Numpy 代码。但这一天即将到来。

我对 PyPy 很兴奋。它为我们提供了一种希望，即我们可以用一种非常高级的语言（Python）编写代码，同时获得几乎可以用“可移植汇编语言”（C）编写东西的性能。对于像这样的示例，Numpy 甚至可能通过使用来自 CPU（SSE2、NEON 或其他）的 SIMD 指令来击败幼稚 C 代码的性能。对于此示例，使用 SIMD，您可以在每个循环中将四个整数设置为 123，这将比普通 C 循环更快。（除非 C 编译器也使用 SIMD 优化！想一想，这很可能适用于这种情况。所以我们回到“接近 C 的速度”而不是在这个例子中更快。但我们可以想象更棘手的情况C 编译器不够聪明，无法优化，未来的 PyPy 可能会。）

但暂时不要介意 PyPy。如果您将使用 Numpy，最好学习所有类似的函数`numpy.fill()`来加速您的代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-11T23:00:54.290

C++ 强调机器时间而不是程序员时间。

Python 强调程序员时间而不是机器时间。

Pypy是用python写的python，它们有numpy的开头；你可以试试。Pypy 有一个很好的 JIT，它使事情变得非常快。

您也可以尝试 cython，它允许您将 Python 方言翻译成 C，并将 C 编译为 Python C 扩展模块；这允许您继续使用 CPython 处理您的大部分代码，同时仍然获得一点加速。但是，在我尝试比较 Pypy 和 Cython 的一个微基准测试中，Pypy 比 Cython 快很多。

Cython 使用高度 Python 的语法，但它允许您非常自由地将 Python 数据类型与 C 数据类型混合。如果你用 C 数据类型重做你的热点，它应该很快。Cython 也加快了继续使用 Python 数据类型的速度，但速度没有那么快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-03T19:49:35.527

代码没有为的`nditer`元素赋值`a`。这不会影响时间问题，但我提到它是因为它不应该被视为对`nditer`.

正确的版本是：

```
for i in np.nditer(a, op_flags=[["readwrite"]]):
    i[...] = 123 
```

`[...]`需要保留对循环值的引用，它是一个 shape数组`()`。

使用 没有意义`A.T`，因为它的基数`A`会发生变化。

我同意完成这项任务的正确方法是`a[:]=123`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-24T14:55:17.517

如果您需要对依赖于数组值但不依赖于数组内部位置的多维数组进行操作，那么`.itemset`它比我快 5 倍`nditer`。

所以而不是做类似的事情

```
image = np.random.random_sample((200, 200,3));
with np.nditer(image, op_flags=['readwrite']) as it:
    for x in it:
        x[...] = x*4.5 if x<0.2 else x 
```

你可以这样做

```
image2 = np.random.random_sample((200, 200,3));
for i in range(0,image2.size):
    x = image2.item(i)
    image2.itemset(i, x*4.5 if x<0.2 else x); 
```

# google-maps - 包含 CONTAINS 的 Google Maps API 和 Fusion Tables 查询

> ID：10112746
> 
> 赞同：2
> 
> 时间：2012-04-11T19:37:38.653
> 
> 标签：google-maps, google-maps-api-3, google-fusion-tables

我正在尝试使以下 Google Maps JS API v3.7 Fusion Tables 查询正常工作。我没有成功。我不断获得比我应该的更多的位置；那些有位置数据的（目前是两个位置）。我应该回去的唯一地点是“洛克菲勒教堂”。就好像 API 完全忽略了查询。

```
this.buildingsLayer = new google.maps.FusionTablesLayer(3418043);
this.buildingsLayer.setQuery("SELECT LatLng FROM 3418043 WHERE PropertyName CONTAINS 'Rockefeller'");
this.buildingsLayer.setMap(this.map); 
```

谁能帮我看看我做错了什么？任何人都可以让它工作吗？

融合表在这里： [https ://www.google.com/fusiontables/DataSource?docid=19HYOu84Oi8Id-dskNyRZxVAjE01CLm8cfNg8dAI](https://www.google.com/fusiontables/DataSource?docid=19HYOu84Oi8Id-dskNyRZxVAjE01CLm8cfNg8dAI)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:49:07.903

尝试：

```
var layer = new google.maps.FusionTablesLayer({
  query: {
    select: 'LatLng',
    from: '3418043',
    where: "PropertyName CONTAINS 'Rockefeller'"
  }
});
layer.setMap(map); 
```

[来自这里的代码](https://developers.google.com/maps/documentation/javascript/layers#FusionTables)

在此处查看完整页面 [http://jsfiddle.net/99jVg/](http://jsfiddle.net/99jVg/)

# html - 响应式设计：允许用户还查看完整站点

> ID：10112747
> 
> 赞同：7
> 
> 时间：2012-04-11T19:37:42.273
> 
> 标签：html, css, responsive-design

使用响应式设计时，是否有办法仍然允许用户查看整个网站？

例如，他们正在 iPhone 上查看，但想查看完整的站点。他们单击“完整站点”链接，它会向他们显示 1024 像素版本。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T19:41:08.770

如果您使用媒体查询，请仅在具有“响应”类的主体元素下应用规则。

```
@media screen and (max-width: 320px) {
  body.responsive {
    color: blue;
  }
} 
```

如果用户不想查看响应式布局，只需从 body 元素中删除“响应式”类，使所有规则无效。您也可以通过 cookie 或其他方法保留用户偏好。

演示：http: [//jsbin.com/obaquq/edit#javascript,html](http://jsbin.com/obaquq/edit#javascript,html)

将窗口缩小到不超过 500 像素将使文本变为白色，背景变为蓝色。这取决于具有“响应”类的身体。单击第一段将切换此类，从而切换媒体查询本身的效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T19:36:50.240

我一直在想这个。我使用 jQuery 成功地修改了视口标签，从我目前所知道的情况来看似乎工作得相当好。不需要多个样式表或大量额外的 CSS。

[http://creativeandcode.com/responsive-view-full-site/](http://creativeandcode.com/responsive-view-full-site/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T19:42:32.917

没有尝试过，但我自己考虑过这个问题。我想您可以使用样式表切换器来停用核心响应式样式表，让用户获得完整版本

切换样式表当然不是一个新概念。这是 ALA 大约 2001 年解决切换样式表的文章：[http ://www.alistapart.com/articles/alternate/](http://www.alistapart.com/articles/alternate/)

# database - 用外键插入表？

> ID：10112751
> 
> 赞同：0
> 
> 时间：2012-04-11T19:38:15.877
> 
> 标签：database, asp.net-mvc, entity-framework

在我`Addcar`看来，我有表单允许我将数据插入到我的数据库中（插入到表中`Car`）。

在表中`Car`，我有与表`colonne (Idcat)`相关的外键`Categorie`。

所以在我的添加表单中，我应该有一个下拉列表，允许用户选择他想要添加的汽车类别。

这是我观点的一部分：

```
 <div class="editor-label">
    <p>
        <%: Html.LabelFor(model => model.Idcat) %>
    </p>
    </div>
    <div class="editor-field">
    <p>
    <!-- in this dropDownList i want to show the all Name Of Marque in my forgien table and user when he select value wil be set at id of selected marque -->
        <%: Html.DropDownListFor(model => model.Idcat, ViewBag.cat as SelectList)%>
        <%: Html.ValidationMessageFor(model => model.Idcat) %>
    </p>
    </div> 
```

这是我的控制器动作：

```
 public ActionResult addcar()
    {

        ViewBag.cat = new SelectList(entity.categorie, "Idcat", "Nom"); 

        return View();
    } 
```

这工作正常，直到我点击创建他`There is no ViewData item of type 'IEnumerable <SelectListItem>' with key 'Idcat'.`在这条线上向我展示了这个错误`<%: Html.DropDownListFor(model => model.Idcat, ViewBag.cat as SelectList)%>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:29:23.413

模型绑定实际上只绑定单个元素。所以它很好地绑定了 Idmarque。显示可能值的下拉列表无济于事。对我来说，这似乎是框架中缺少的东西，因为它会让你停止使用 EditorForModel。您必须决定如何处理获取下拉列表。您是否可以使用 Html Helper 来查询数据库并绘制选项列表？或者您更愿意让您的控制器调用模型方法来获取选项列表，并将其作为视图模型的一部分传递到视图中？可能希望避免传递数据读取器，因为如果这样做，您可能会遇到打开的连接问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T19:46:03.540

在 ASP.Net MusicStore 教程中有一个示例，您可以从给定的流派列表中进行选择。流派列表通过控制器填充的 viewbag 传递给视图：

[音乐商店教程](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-5)

这可能正是您正在寻找的。

# c - 在循环中一起使用 getline 和 strtok

> ID：10112752
> 
> 赞同：1
> 
> 时间：2012-04-11T19:38:19.980
> 
> 标签：c, pointers, getline, strtok

我是 C 的新手，并试图实现 whoami，作为对自己的练习。我有以下代码：

```
#define _POSIX_SOURCE
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <string.h> // strtok

int str_to_int(const char *str)
{
    int acc = 0;
    int i;
    for (i = 0; str[i] != '\0'; ++i) {
        acc = (10 * acc) + (str[i] - 48); // 48 -> 0 in ascii
    }
    return acc;
}

int main()
{
    FILE *passwd;
    char *line = NULL;
    size_t line_size;

    passwd = fopen("/etc/passwd","r");

    uid_t uid = getuid();

    while (getline(&line, &line_size,passwd) != -1) {
        char *name = strtok(line,":");
        strtok(line,":"); // passwd
        char *user_id = strtok(line,":");
        if (str_to_int(user_id) == uid) {
            printf("%s\n",name);
            break;
        }
    }

    fclose(passwd);
    return 0;
} 
```

我是否需要将行指针保存在 while 循环内。因为我认为strtok会以某种方式对其进行修改，但是我不确定在将其与strtok一起使用之前是否需要复制该行或该行的起始地址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:44:45.110

`strtok`是一个可怕的功能。我不知道您阅读了哪些文档（如果有的话？），但它既修改了传递的缓冲区，又保留了指向缓冲区的内部指针；您应该只在*第*一次在给定行上使用缓冲区时传递缓冲区，然后再传递，`NULL`以便它知道从中断的地方开始而不是从头开始（实际上它不会很好地工作，因为它踩到了缓冲区...）。

更好的是，找到一些其他的方式来解析并远离`strtok`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:12:50.550

使用它可能更安全`strtok_r`。在多线程情况下更安全。这可能不适用于这种情况，但有时最好假设您编写的任何片段都可能最终出现在多线程应用程序中。以下是修改后使用的 OP 代码`strtok_r`。

```
 char *pos;
  char *name = strtok_r(line,":",&pos);
  strtok_r(NULL,":",&pos); // passwd
  char *user_id = strtok_r(NULL,":",&pos); 
```

而且，是的，`strtok`（和`strtok_r`）确实修改了给定的输入缓冲区（第一个参数）。但如果使用得当，它是安全的。由于`strtok`返回一个指向给定字符串内的缓冲区的指针，因此您需要注意如何使用它。在您的情况下，当它跳出循环时，`name`将`user_id`指向`line`缓冲区内的一个值。

您也许应该阅读[`getline`](http://linux.die.net/man/3/getline). 您使用它的方式，它返回一个分配的缓冲区，您的应用程序负责释放该缓冲区。这可能是您的目标，但我提到它是因为我在发布的代码中没有看到`free`对它的调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-30T21:38:09.900

我完全同意 geekosaur（和 Mark）的观点。套用他的评论，你可以修改上面的代码如下：

```
while (getline(&line, &line_size, passwd) != -1) {
    char *name = strtok(line,":");
    strtok(NULL,":"); // passwd
    char *user_id = strtok(NULL,":");
    if (str_to_int(user_id) == uid) {
        printf("%s\n",name);
        break;
    }
} 
```

`strtok`您应该为除第一个以外的调用传递 NULL 。

# android - Android 填充颜色

> ID：10112756
> 
> 赞同：2
> 
> 时间：2012-04-11T19:38:36.827
> 
> 标签：android, colors, padding

问题是：我有一个 Imageview，我想在 imageview 周围创建一个宽度为 2 dp 的白色边框/填充。imageview 在 java 中被清除，我想在 java 中进行填充，而不是 xml。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:22:30.207

ImageView 支持两件事：背景和前景中的位图。两者都可以从您的 XML 中设置为 Drawables、Bitmaps 或 Resources。

所以在Java中，你应该能够做到这一点：

```
ImageView view = new ImageView(this);
view.setImageResource(R.drawable.splash);   // Adds the foreground Bitmap
view.setScaleType(ScaleType.CENTER_INSIDE); // Sets how the bitmap is scaled in it's container
view.setBackgroundColor(Color.WHITE);       // Define the border color
view.setPadding(2,2,2,2);                   // Define the border size
view.setLayoutParams(new FrameLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT)); 
```

这应该可以解决问题。

# c++ - double boost::bind 导致编译时错误

> ID：10112761
> 
> 赞同：0
> 
> 时间：2012-04-11T19:38:51.100
> 
> 标签：c++, boost, bind, functor, boost-bind

以下代码给出了由第 17 行引起的编译错误：

```
#include <boost/bind.hpp>
#include <boost/function.hpp>

void func()
{}

class A{
public:

    template <typename T>
    static void foo(T const& arg){}

    template <typename T>
    void bar(T const& arg){
        boost::bind(&A::foo<T>, arg);  //OK
        boost::function<T> functor1 = boost::bind(func); //OK
        boost::function<T> functor2 = boost::bind(&A::foo<T>, arg); //ERROR, LINE 17
    }
};

int main()
{
    A obj1;
    obj1.bar(func);
} 
```

问题是，第 17 行的 functor2 原型应该是什么？
如果我真的想保持 functor2 的原型为“boost::function<void()>”，如何让 boost::bind 返回这样的类型？

编译错误是：`usr/include/boost/bind/bind.hpp:253: error: invalid initialization of reference of type 'void (&)()' from expression of type 'void (*)()'`
什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T19:09:00.243

`foo(T const& arg)`接受一个参考参数。为了通过 传递引用参数`boost::bind`，您需要用`boost::ref`.

```
boost::function<T> functor2 = boost::bind(&A::foo<T>, boost::ref(arg)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:05:57.727

看看[boost::bind 的返回类型是什么？](https://stackoverflow.com/questions/6412065/what-is-the-return-type-of-boostbind)

简而言之，我只想写

```
auto functor2 = boost::bind(&A::foo<T>, arg); 
```

并使用 gcc 4.6+ 或带有`--std=gnu++0x`选项的 gcc 4.4 编译它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T22:12:54.107

我对绑定没有经验，但是您通常不需要调用成员函数的类的实例吗？如果您不将其包含在绑定中，则需要将其包含在调用站点中。使用`auto`我的例子（我在上面读到你不能使用它，但我会为了简洁起见），我将重新实现你的 A::bar() 方法：

```
void bar(T const& arg){
    auto barebones = boost::bind(&A::foo<T>, arg);
    // OR
    auto barebones = boost::bind(&A::foo<T>, _1, arg);
    barebones(this); // Need an instance, or a pointer to an instance of A
    boost::function<T> functor1 = boost::bind(func); // OK because func is a bare function with no arguments
    boost::function<T> functor2 = boost::bind(&A::foo<T>, this, arg); // betting that would work
    functor2(); // with my modification, I think that'll work.
} 
```

您可能需要 _1 语法来说明第一个参数占据了那个位置，或者没有它也可以工作。我不是 100% 确定（还没有编译它），但是根据 boost 站点上的文档（boost [bind doc](http://www.boost.org/doc/libs/1_49_0/libs/bind/bind.html#with_member_pointers)，boost [mem_fn doc](http://www.boost.org/doc/libs/1_49_0/libs/bind/mem_fn.html)），这就是我认为正在发生的事情。

为什么编译第一部分，我不知道。这让我怀疑原来的语法没问题，但是你需要传递类实例。如果您正在寻找不需要额外参数的“裸”可调用对象，则需要在绑定时传递一个实例（或指向一个的指针，或指向一个的智能指针）。

如果您在推断类型时遇到问题，请尝试使用 BOOST_AUTO() 宏。 [文档链接](http://www.boost.org/doc/libs/1_40_0/doc/html/typeof/refe.html)。

# ipad - 我可以将日期选择器限制为 3 天吗？

> ID：10112766
> 
> 赞同：0
> 
> 时间：2012-04-11T19:39:04.660
> 
> 标签：ipad, uidatepicker

在我的 iPad 应用程序中，要求日期选择器仅显示 3 天/日期，即今天、明天和后天。是否可以？如果是，那我该怎么做？

任何帮助将不胜感激。

最好的祝福

个人电脑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:43:43.753

maximumDate 日期选择器可以显示的最大日期。

```
@property(nonatomic, retain) NSDate *maximumDate 
```

minimumDate 日期选择器可以显示的最小日期。

```
@property(nonatomic, retain) NSDate *minimumDate 
```

# java - Converting and OPC (Open Packaging Convention) file to and flat XML file in JAVA

> ID：10112775
> 
> 赞同：2
> 
> 时间：2012-04-11T19:39:52.257
> 
> 标签：java, openxml, docx4j, open-packaging-convention

So I am trying to get an flat file XML version of an OPC document.

I am using OPCPackage from org.apache.poi.openxml4j

In C++ you there is a call that creates flat XML file from this zipped file.

Anyone knows how to do that in Java?

Also any good read related to OPC and Java would be awesome.

Thanks a lot

Cheers

UPDATE: related to the comment i made to only answer...

code

```
 // imports
    import org.docx4j.convert.out.flatOpcXml.FlatOpcXmlCreator;
    import org.docx4j.openpackaging.packages.WordprocessingMLPackage;

    // code snippet
    WordprocessingMLPackage wmlPkg = null;
    try 
    {
        wmlPkg = WordprocessingMLPackage.load(inFile);
    } 
    catch (Docx4JException ex) 
    {
        //...
    }

    FlatOpcXmlCreator flatOpcWorker = new FlatOpcXmlCreator((wmlPkg));

    flatOpcWorker.marshal(new FileOutputStream(tmpFlatFile.getAbsolutePath())); 
```

So thats code snippet and it results in compile error:

***cannot find symbol symbol: method marshal(java.io.FileOutputStream) location: variable flatOpcWorker of type org.docx4j.convert.out.flatOpcXml.FlatOpcXmlCreator***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T22:51:08.573

My project docx4j has a FlatOpcXmlCreator which does this; see the [ConvertOutFlatOpenPackage sample](https://github.com/plutext/docx4j/blob/master/src/samples/docx4j/org/docx4j/samples/ConvertOutFlatOpenPackage.java)

If you want to use it with POI (which uses XML Beans, not JAXB), I guess you could port it. Both projects are ASL, and both do the OPC part based on OpenXML4J.

# android - Android 最小按钮高度：48dp = 9mm？

> ID：10112780
> 
> 赞同：18
> 
> 时间：2012-04-11T19:40:12.997
> 
> 标签：android, mobile

我目前正在为移动应用程序制作线框，但我似乎忘记了一些事情：在[Android Design Guidelines](http://developer.android.com/design/style/metrics-grids.html)中，他们陈述了以下内容：

> 平均而言，48dp 转换为大约 9mm 的物理尺寸（有一些可变性）。

但是，根据[Android Developers Dev Guide](http://developer.android.com/guide/practices/screens_support.html)，他们`dp`使用以下公式计算 a：

> 与密度无关的像素相当于 160 dpi 屏幕上的一个物理像素，这是系统为“中等”密度屏幕假定的基线密度。在运行时，系统会根据使用中屏幕的实际密度，根据需要透明地处理 dp 单位的任何缩放。dp 单位到屏幕像素的转换很简单：px = dp * (dpi / 160)。例如，在 240 dpi 的屏幕上，1 dp 等于 1.5 个物理像素。在定义应用程序的 UI 时，您应该始终使用 dp 单位，以确保您的 UI 在不同密度的屏幕上正确显示。

因此，为了简单起见，我以 160dpi 进行设计，因此我的图形具有符合推荐标准的正确尺寸。打印时，我将文档缩小 2.22（160dpi/72dpi），因此打印结果给出了纸上的实际物理尺寸。

我希望我的按钮高 48dp。但是，如果我按照我阅读的所有内容进行数学计算，通过将 48 指定为我的按钮高度，我离 9mm 尺寸还很远。

> 48dp / 160dpi = 0.3 英寸，所以 7.62 毫米...

我显然错过了什么/做错了什么？那个 9mm 是从哪里来的？

谢谢！

**更新**

以下是帮助我理解我在接受的答案中遗漏的内容。

以 200 的屏幕密度为例。Android 将使用 240 来进行计算。所以：

*   240dpi / 160dpi = 1,5 比例
*   48dp * 1,5 比例 = 78 个物理像素
*   78 px / 240dpi = 0,3 英寸（与 48dp / 160dpi 完全相同）

现在的诀窍是实际的设备密度是 200。所以像素会显得比 240dpi 屏幕上的要大。要获得 200dpi 设备上的物理尺寸，我们必须获得两种分辨率之间的差异并将其应用于 0,3 英寸：

*   240dpi / 200dpi = 1,2
*   0,3 英寸 * 1,2 的差异 = 0,36 英寸，即 9,144 毫米

我知道这与@kabuko 所说的完全相同：

> (48dp / 200ppi) * 1.5 * 25.4 毫米/英寸 = 9.14400

但一步一步的帮助我弄清楚引擎盖下发生了什么。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T21:00:03.370

您引用的确切声明是：

> 平均而言，48dp 转换为大约 9 毫米的物理尺寸

[如果您从Supporting Multiple Screens 文档](http://developer.android.com/guide/practices/screens_support.html)中查看此图像：

![Android 密度](../Images/bb62273d6fde6754dba5b06ee751e93e.png)

您会看到有密度桶（ldpi、mdpi、hdpi、xhdpi）。这些中的每一个都不是固定的密度，而是一系列密度，最终映射到用于各种密度计算的固定数字（分别为 120、160、240、320）。160 很少是 mdpi 设备的实际每英寸像素数，它只是为了简单起见而使用的抽象值。

您的计算是正确的，但您假设 160ppi 是平均密度（假设 mdpi 设备），因为 160dpi 是 mdpi 的抽象值。显然不是，如果您引用的陈述确实是真的。我怀疑有很多设备的平均分辨率约为 200ppi，最终被归类为 hdpi。那将是：(48dp / 200ppi) * 1.5 * 25.4 毫米/英寸 = 9.14400 毫米。只是一个猜测，但我当然认为根本原因是平均值不是 160ppi。

**更新：**

这是设计网站文档中的另一句话：

> 如果您将元素设计为至少 48dp 高和宽，则可以保证 [...] 您的目标永远不会小于建议的最小目标尺寸 7mm，无论它们显示在什么屏幕上。

所以尺寸从 > 7 毫米到至少 9 毫米不等（假设 9 毫米应该是平均的，我认为顶部范围应该 < 11 毫米）。是的，48dp 在所有屏幕上应该是“大约”相同的尺寸，但是“大约”的真正含义并没有真正指定。您的 7.62 毫米在范围内。它们的 9mm 值仅用于未指定 ppi 的“平均值”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-12T21:11:29.573

如果**严格说 Android 手机和平板电脑**（没有电视、没有 Wear、没有台式机、没有 iOS）：根据 google 的设备列表[https://design.google.com/devices/](https://design.google.com/devices/) 48dp 到 9mm 的建议*与实际不符世界价值观似乎*。

我需要找到要使用的最低 DP 值，它可以在任何地方安全地以或高于给定物理尺寸进行渲染。原来有些设备配置不当（Sony Experia C4 是这个列表中最差的，为 200 dp/in，其次是 Dell Venue 8，为 180dp/in，然后是 LG G3，为 178dp/in）（这里说的是逻辑 DP，而不是*物理*DPI）。在这些设备中，一切看起来都比平均水平要小。其他一切都接近 170..144 dp/in。

如果可以在其他地方找到此信息以支持数据并且还拥有更多设备，那么如果我们看到那里有更多的流氓设备，那就太好了。

这是我从页面中提取的一些数字：（仅限安卓手机和平板电脑）

```
Max: 200 dp/in  (smallest)
Min: 141 dp/in  (biggest) 
```

有了这些数字，这里有一个表格，其中列出了可供选择的各种离散 dp 值的最小/最大 mm 尺寸（四舍五入到最接近的 1/10 mm）：

```
dp  min  max mm
36  4.6   6.5
37  4.7   6.7
38  4.8   6.8
39  5.0   7.0
40  5.1   7.2
41  5.2   7.4
42  5.3   7.6
43  5.5   7.7
44  5.6   7.9
45  5.7   8.1
46  5.8   8.3
47  6.0   8.5
48  6.1   8.6
49  6.2   8.8
50  6.4   9.0
51  6.5   9.2
52  6.6   9.4
53  6.7   9.5
54  6.9   9.7
55  7.0   9.9
56  7.1  10.1
57  7.2  10.3
58  7.4  10.4
59  7.5  10.6 
```

## 公式

`mm = <dp> * 25.4 / <dp/in>` 我可以在此设备列表中找到`<dp/in>`的最大密度 dp/in (200) 或低密度 (141) 在哪里。

## 例子

`48dp * 25.4 / 200 = 6.096mm`

四舍五入：6.1 毫米——低于他们声称的“安全”7 毫米。

另请注意，在任何手机/平板电脑屏幕上，48dp 从未完全达到“9mm”。最大值为 8.6（接近但肯定不是平均值）。

# c++ - 动态结构错误，指针转换

> ID：10112787
> 
> 赞同：0
> 
> 时间：2012-04-11T19:40:46.853
> 
> 标签：c++, arrays, pointers, dynamic-allocation

我在结构的构造函数中收到此错误。为什么我会得到它，因为我只能使用 * 指针而不是 **。

错误：

```
\ListStruc.cpp:26:25: error: cannot convert 'int**' to 'int*' in assignment 
```

结构体.h

```
struct Arr{

    int days;
    int *M;
};
typedef Arr* Array; 
```

结构体.cpp

```
void constr(Array &o){
    //Construct of 1*31 Matrix
    o=new Arr;
    o->days = days;
    o->M = new int*[o->days]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:42:18.033

由于`M`是`int*`，正确的初始化将是：

```
o->M = new int[o->days]; 
```

# java - maven 从 pom 内部运行 maven install

> ID：10112791
> 
> 赞同：1
> 
> 时间：2012-04-11T19:40:53.170
> 
> 标签：java, maven

我有一些不在存储库中的 3rd 方 jars，我需要在构建时安装它们。我正在尝试使用 ant 插件将生成的 jar 和 pom 从我的项目/lib 文件夹复制到本地存储库

我的 src/main/lib 目录包含以下文件夹结构 com/oracle/ojdbc14/10.2/ojdbc.jar、ojdbc.pom

```
<plugin> 
            <groupId>org.apache.maven.plugins</groupId> 
            <artifactId>maven-antrun-plugin</artifactId> 
            <version>1.7</version> 
            <executions> 
                <execution> 
                    <phase>validate</phase> 
                    <goals> 
                        <goal>run</goal> 
                    </goals> 
                    <configuration> 
                        <tasks> 
                            <copy todir="${settings.localRepository}" >  
                                <fileset dir="${basedir}/src/main/lib/" includes="**"/>  
                            </copy>
                        </tasks> 
                    </configuration> 
                </execution> 
            </executions> 
        </plugin> 
```

但是当我运行 mvn install 时，它会失败并显示以下消息

```
Failure to find com.oracle:ojdbc14:jar:10.2.0.3.0 
```

为什么在对依赖项进行任何检查之前运行来自 ant（验证阶段）的复制命令

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:05:25.387

对不起，但这完全糟透了。如果你**真的**不能将这个第 3 方的东西部署到某种内部或私有 Maven 存储库，那么到目前为止我发现做这种事情的最好方法是对`install:install-file`所有这些 jar 使用目标。我们为此创建了 2 个 shell 脚本（用于 Windows 和 Linux），并通过 SCM 在`bootstrap`目录中共享它们（或类似的东西）。请注意，每个新开发人员都必须这样做一次，因为这些工件随后可以在本地 Maven 存储库中解析。

查看有关`install:install-file`目标的详细信息：[http ://maven.apache.org/plugins/maven-install-plugin/install-file-mojo.html](http://maven.apache.org/plugins/maven-install-plugin/install-file-mojo.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:49:32.847

获取存储库管理器并在那里安装工件。其他一切都是丑陋的黑客，比安装和使用存储库管理器更具侵入性和麻烦。查看 Nexus、Artifactory 或 Archiva，并从使用它中获得所有好处，例如改进的构建性能、易于使用第三方库以及能够在内部共享工件。

# c# - 在 C# 中处理 char*（strlen 函数？）

> ID：10112794
> 
> 赞同：3
> 
> 时间：2012-04-11T19:41:02.157
> 
> 标签：c#, c++, character-encoding, strlen, arrays

我正在处理 C# 代码中的 char* （在不安全的部分）。有什么方法可以从 C# 调用 strlen 函数。必须编写自定义 strlen 函数来搜索空终止符，这违反了所有常识。没有办法从 C# 或我可以访问的类似方法调用 strlen 吗？

在大图中，我试图将 char* 转换为字符串对象，但字符是 ANSCII 格式，所以我将使用 .NET Encoding.Convert 命名空间来转换它。但在我这样做之前我需要知道字符串的长度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T19:50:17.180

[`Marshal.PtrToStringAnsi()`](http://msdn.microsoft.com/en-us/library/7b620dhe.aspx)完全满足您的需要：

> 分配一个托管字符串，并将存储在非托管内存中的字符串中的所有字符复制到其中，直到第一个空字符为止。

顺便说一句，该方法调用`lstrlenA`了指针，它实际上只是一个 import from `kernel32.dll`。换句话说，似乎*没有*可用的托管“让我知道这个非托管字符串的长度”方法。

# collections - 使用流利的 nhibernate 映射自定义对象数组

> ID：10112796
> 
> 赞同：0
> 
> 时间：2012-04-11T19:41:16.523
> 
> 标签：collections, fluent-nhibernate, nhibernate-mapping

我有两个类，文件和搜索结果。ShearchResults 有一个文件数组。它们之间的关系是ManyToMany。这就是我映射关系的方式：

```
HasManyToMany<File>(x => x.Files).Table("refSearchResultsFiles").ParentKeyColumn("[SearchResult]").ChildKeyColumn("[File]"); 
```

当我尝试保存 SearchResult 对象时，出现此异常：

> 无法将“NHibernate.Collection.PersistentBag”类型的对象转换为“TankusFileSharingClassLibrary.Entities.File[]”类型。

为什么是这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T07:12:07.080

你`.AsArray(...)`在hasmanytomany中失踪了

# lisp - 使用 asdf:defsystem 和 quickproject 定义包的正确方法

> ID：10112797
> 
> 赞同：9
> 
> 时间：2012-04-11T19:41:19.940
> 
> 标签：lisp, common-lisp, sbcl, asdf, quicklisp

我是一名 Lisp 初学者，试图了解如何正确使用 Lisp 包系统，同时学习 LTK 进行 GUI 编程，使用 SBCL 1.0.55.0.debian 和 Limp 0.3.4（如果重要的话，还有 Debian Wheezy）。我已经使用 aptitude 包管理器（包 cl-asdf 和 cl-common-lisp-controller）安装了 ASDF，然后我使用 Quicklisp 网站（[http://www.quicklisp.org/beta/index.html](http://www.quicklisp.org/beta/index.html)）上的说明安装了 Quicklisp （不是来自 Debian 存储库），然后我`(ql:quickload 'ltk)`在 SBCL 控制台中安装了 LTK 。

hello-1.lisp（直接来自 LTK 教程）：

```
(defun hello-1()
    (with-ltk ()
              (let ((b (make-instance ’button
                                      :master nil
                                      :text "Press Me"
                                      :command (lambda ()
                                                       (format t "Hello World!~&")))))
                   (pack b)))) 
```

如果我在一个新的 SBCL Lisp 映像中直接编译它，我会收到消息，`WITH-LTK`并且`PACK`是未定义的函数并且`'BUTTON`是未定义的变量。

所以，我发现我需要先加载`'ltk`然后使用`in-package`.I 才能运行它，我首先必须在 SBCL 控制台中使用`(ql:quickload 'ltk)`和。但是，我仍然有一个未定义变量`(in-package :ltk)`的错误消息。`'BUTTON`

```
* (ql:quickload 'ltk)
To load "ltk":
  Load 1 ASDF system:
    ltk
; Loading "ltk"

(LTK)
* (in-package :ltk)

#<PACKAGE "LTK">
* (compile-file "/home/user/code/lisp/hello-1.lisp")

; caught WARNING:
;   undefined variable: ’BUTTON
; 
; compilation unit finished
;   Undefined variable:
;     ’BUTTON
;   caught 1 WARNING condition

; /home/user/code/lisp/hello-1.fasl written
; compilation finished in 0:00:00.009
#P"/home/user/code/lisp/hello-1.fasl"
T
T
* 
```

然后，由于这没有达到我想要的效果，我还尝试根据另一个问题（[ltk (common lisp)](https://stackoverflow.com/questions/2443068/problems-with-ltk-common-lisp)的问题），Xach 的博客文章“使用 quickproject 制作一个小型 Lisp 项目”的答案来定义我自己的包定义和 Quicklisp” [http://xach.livejournal.com/278047.html?thread=674335](http://xach.livejournal.com/278047.html?thread=674335)和 ASDF 手册 ( [http://common-lisp.net/project/asdf/asdf/The-defsystem-form.html](http://common-lisp.net/project/asdf/asdf/The-defsystem-form.html) ) 使用`quickproject:make-project`,但没有成功。目前我有以下文件：

`(ql:quickload 'ltk)`package.lisp （如果我第一个SBCL REPL编译干净）：

```
(defpackage :hello-world-ltk-system 
  (:use :cl :asdf :ltk)) 
```

hello-world-ltk.asd（在我第一次编译 package.lisp 后编译干净）：

```
(in-package :hello-world-ltk-system)
(asdf:defsystem :hello-world-ltk
  :serial t
  :description "Describe hello-world-ltk here"
  :author "Your Name <your.name@example.com>"
  :license "Specify license here"
  :depends-on (:cl :asdf :ltk)
  :components ((:file "package")
            (:file "hello-world-ltk"))) 
```

hello-world-ltk.lisp（我得到编译错误`The name "HELLO-WORLD-LTK" does not designate any package`）。

```
(require 'hello-world-ltk)
(in-package :hello-world-ltk)
(defun hello-world-1 () 
  (with-ltk () 
            (let ((b (make-instance 'button 
                                    :master nil 
                                    :text "Press me!" 
                                    :command (lambda () 
                                                     (format t "Hello world!~&"))))) 
                 (pack b)))) 
```

当我在成功编译 package.lisp 和 hello-world-ltk.asd （它们都位于同一目录中）后尝试编译这个 hello-world-ltk.lisp 时，我收到以下错误：

```
; compiling (IN-PACKAGE :HELLO-WORLD-LTK)
debugger invoked on a SB-KERNEL:SIMPLE-PACKAGE-ERROR in thread
#<THREAD "initial thread" RUNNING {10029A0FA3}>:
  The name "HELLO-WORLD-LTK" does not designate any package.

Type HELP for debugger help, or (SB-EXT:QUIT) to exit from SBCL.

restarts (invokable by number or by possibly-abbreviated name):
  0: [ABORT] Exit debugger, returning to top level.

(SB-INT:%FIND-PACKAGE-OR-LOSE "HELLO-WORLD-LTK")
0]
(load "/home/user/code/lisp/hello-world-ltk/hello-world-ltk")

debugger invoked on a SIMPLE-ERROR in thread
#<THREAD "initial thread" RUNNING {10029A0FA3}>:
  attempt to load an empty FASL file:
  "/home/user/code/lisp/hello-world-ltk/hello-world-ltk.fasl"

Type HELP for debugger help, or (SB-EXT:QUIT) to exit from SBCL.

restarts (invokable by number or by possibly-abbreviated name):
  0: [ABORT] Reduce debugger level (to debug level 1).
  1:         Exit debugger, returning to top level.

(SB-FASL::LOAD-AS-FASL
 #<SB-SYS:FD-STREAM
   for "file /home/user/code/lisp/hello-world-ltk/hello-world-ltk.fasl"
   {1005291233}>
 NIL
 #<unavailable argument>)
0[2] 
```

所以，我对定义包的所有不同方法感到很迷茫，ASDF、Quicklisp、package.lisp、、、和`quickproject`......看起来很有希望，但我真的不知道我的源文件还有什么问题。我正在寻找一种解决方案，它应该在一个命令中优先处理整个项目的所有编译和包加载，并且应该可以扩展用于更大的项目。`asdf:defsystem``require``ql:quickload``quickproject:make-project`

感谢您的任何帮助 ：）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T20:24:14.123

# wpf - 资源 1 有效，2 无效

> ID：10112798
> 
> 赞同：0
> 
> 时间：2012-04-11T19:41:28.340
> 
> 标签：wpf

```
<ToggleButton Command="{Binding Path=Command}" Content="{Binding Path=DisplayName}" Template="{Utilities:BindableResource {Binding Path=TemplateResource}}">
    <ToggleButton.Style>
        <Style TargetType="ToggleButton">
            <Style.Triggers>
                <Trigger Property="IsChecked" Value="True">
                    <Setter Property="Template" Value="{Utilities:BindableResource {Binding Path=SelectedTemplateResource}}" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </ToggleButton.Style>
</ToggleButton> 
```

第一个可绑定资源适用于切换按钮模板属性上的“TemplateResource”，但是“SelectedTemplateResource”在跳跳虎设置器中不起作用。此代码位于资源字典中，而实际资源位于主题资源字典中。

我收到一条错误消息，说 setter 值的 xamlparseexception 的 key 为 null。我一直在这几个小时，但无法弄清楚为什么它不起作用......如果我取出样式并用第二个资源替换第一个绑定它确实显示正确但是样式中的绑定将不起作用.

有人知道为什么吗？

**编辑** 我刚刚尝试过，但没有运气。

```
 <ToggleButton Command="{Binding Path=Command}" Content="{Binding Path=DisplayName}">
                    <ToggleButton.Style>
                        <Style TargetType="ToggleButton">
                            <Style.Triggers>
                                <Trigger Property="IsChecked" Value="False">
                                    <Setter Property="Template" Value="{Utilities:BindableResource {Binding Path=TemplateResource}}" />
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter Property="Template" Value="{Utilities:BindableResource {Binding Path=SelectedTemplateResource}}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ToggleButton.Style>
                </ToggleButton> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T13:27:26.333

在发现在纯 xaml 中确实不可能做到这一点后，我拿出了 c# 并创建了一个自定义控件...这是非常基本的，可以改进，我将对其进行一些更改，但最终自定义控件可以解决这个问题，以便您可以从资源字典中点击点击事件并即时更改模板。

```
public class TabButton : Button
{
    public static readonly DependencyProperty SelectedTemplateProperty = 
        DependencyProperty.Register("SelectedTemplate", typeof(ControlTemplate), typeof(TabButton));

    public ControlTemplate SelectedTemplate
    {
        get { return base.GetValue(SelectedTemplateProperty) as ControlTemplate; }
        set { base.SetValue(SelectedTemplateProperty, value); }
    }

    public TabButton()
    {
        this.Click += new RoutedEventHandler(TabButton_Click);
    }

    ~TabButton()
    {

    }

    public void TabButton_Click(object sender, RoutedEventArgs e)
    {
        ControlTemplate template = (ControlTemplate)this.FindResource("Environmental Template Selected");
        (sender as TabButton).Template = template;
    }
} 
```

干杯。

# c# - WCF服务构造函数抛出的日志异常？

> ID：10112803
> 
> 赞同：2
> 
> 时间：2012-04-11T19:41:47.247
> 
> 标签：c#, wcf

有什么方法可以捕获和记录 WCF 服务的构造函数抛出的异常？

使用自定义创建自`IEndpointBehavior`定义`IErrorHandler`似乎可以捕获所有异常，*除了*在服务构建期间抛出的异常。（如果我错了，请纠正我。）

我可以从 HTTP 响应中看到，这种情况最终会生成一个`System.ServiceModel.ServiceActivationException`，但如果我可以从原始异常中注销详细信息会很有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:57:49.130

您可以使用 WCF 跟踪

[http://msdn.microsoft.com/en-us/library/ms733025.aspx](http://msdn.microsoft.com/en-us/library/ms733025.aspx)

您可以在服务配置中打开它，因此无需检测您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-01T20:42:12.357

您需要创建一个类来记录异常，在构造函数中对其进行初始化，并在捕获到异常时调用它。下面是一个非常简单的例子：

```
public class MyWcfService : IMyWcfService
{
    private readonly IExceptionLogger_ exceptionLogger;

    public MyWcfService()
    {
        // Initialize dependencies
        _exceptionLogger = new ExceptionLogger();

        try
        {           
            // Code here that throws an exception
        }
        catch (Exception ex)
        {
            _exceptionLogger.LogException(ex);
        }

    } // end constructor

    // Other methods here

} // end class 
```

# jquery - jQuery 和 Internet Explorer

> ID：10112805
> 
> 赞同：0
> 
> 时间：2012-04-11T19:41:59.037
> 
> 标签：jquery, internet-explorer

我在为页面构建的过程中遇到了模态窗口类型应用程序的问题。该小程序在除 IE 之外的所有浏览器中都能完美运行（如我所愿）。我不确定它是否与尾随标签有关，或者正在发生什么。

如果您在 Chrome、Safari 或 FF 中在[http://jsfiddle.net/Qm6Rn/中查看它，您将看到它应该表现的方式。](http://jsfiddle.net/Qm6Rn/)但是，在 IE 中加载时，只要单击 X 关闭窗口，然后单击右侧的固定导航元素之一，模态动画就会返回到视图中而没有任何内容。

HTML：

```
<!DOCTYPE HTML>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta description="#">
        <meta keywords="#">
        <title>TITLE</title>
        <meta name="viewport" content="width=1020" />
        <!-- <link rel="stylesheet" href="style.css" type="text/css" media="screen" charset="utf-8" />-->
        <link rel="stylesheet" href="assets/css/global.css" type="text/css" media="screen" charset="utf-8" />
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script type="text/javascript" src="assets/js/jquery.ba-hashchange.min.js"></script>
        <script type="text/javascript" src="assets/js/global.js"></script>
        <!--[if IE]>
            <link rel="stylesheet" href="assets/css/ie.css" type="text/css" media="screen" charset="utf-8" />
        <![endif]-->
    </head>

    <body>
        <div id="fb-root"></div>
        <script>
            (function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s);
                js.id = id;
                js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=209710702470757";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <div id="video_box"> <a href="#" class="close-button">X</a>

            <div class="box-navigation">
                <ul>
                    <li><a href="#videos" class="sidebar-videos"><img src="http://www.gowithcea.com/uploadedImages/js/images/video-icon.png" alt="" />Video</a>
                    </li>
                    <li><a href="#reviews"><img src="http://www.gowithcea.com/uploadedImages/js/images/review-icon.png" alt="" />Reviews</a>
                    </li>
                    <li><a href="#facebook"><img src="http://www.gowithcea.com/uploadedImages/js/images/facebook-icon.png" width="18" alt="" />Facebook</a>
                    </li>
                </ul>
            </div>
            <div class="section video" data-title="videos">
                <object width="640" height="480">
                    <param name="movie" value="http://www.youtube.com/v/R9cNtrrCP0E?version=3&amp;hl=en_US"></param>
                    <param name="allowFullScreen" value="true"></param>
                    <param name="allowscriptaccess" value="always"></param>
                    <embed src="http://www.youtube.com/v/R9cNtrrCP0E?version=3&amp;hl=en_US" type="application/x-shockwave-flash" width="640" height="480" allowscriptaccess="always" allowfullscreen="true"></embed>
                </object>
            </div>
            <div class="section active reviews" data-title="reviews">This is a block, and it needs to swap out. Will it work? That is the question...</div>
            <div class="section facebook" data-title="facebook">
                <div class="contentFeedLeft" style="height:480px;">
                    <fb:like-box href="http://www.facebook.com/ceastudyabroad" width="640" height="480" show_faces="false" stream="true" header="false"></fb:like-box>
                </div>
            </div>
        </div>
        <div>
            <p>Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Sed posuere consectetur est at lobortis. Vestibulum id ligula porta felis euismod semper. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.</p>
            <p>Cras mattis consectetur purus sit amet fermentum. Maecenas faucibus mollis interdum. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla vitae elit libero, a pharetra augue.</p>
            <p>Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Curabitur blandit tempus porttitor. Donec ullamcorper nulla non metus auctor fringilla.</p>
            <p>Donec sed odio dui. Nulla vitae elit libero, a pharetra augue. Donec sed odio dui. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
        </div>
        <ul class="fixed-navi">
            <li><a href="#videos" class="activator video-button"><img src="http://www.gowithcea.com/uploadedImages/js/images/video-dark-icon.png" alt="watch a video" />Video</a>
            </li>
            <li><a href="#reviews" class="activator review-button"><img src="http://www.gowithcea.com/uploadedImages/js/images/review-dark-icon.png" alt="read our reviews" />Reviews</a>
            </li>
            <li><a href="#facebook" class="activator facebook-button"><img src="http://www.gowithcea.com/uploadedImages/js/images/facebook-icon.png" alt="visit us on facebook" class="fb" /></a>
            </li>
        </ul>
    </body>

</html> 
```

JavaScript：

```
jQuery(document).ready(function ($) {

    $.slidingBox = function (event) {

        $('.fixed-navi li a.activator').live('click', function (event) {

            $('#video_box').animate({
                top: '50%',
                opacity: 1
            }, {
                queue: false,
                duration: 450
            });

            $('.fixed-navi').fadeOut('slow');

        });

        $('.close-button').click(function (event) {
            $('#video_box').animate({
                top: '-50%',
                opacity: 0
            }, {
                queue: false,
                duration: 450
            });

            $('.fixed-navi').fadeIn('slow');

        });

    }

    $.slidingBox();

    $.slidingBoxContent = function (event) {

        $(window).hashchange(function () {

            var hash = window.location.hash;

            if (hash) {

                var $el = $(".box-navigation ul li a[href='" + hash + "']"),
                    $panel = $("#video_box .section[data-title='" + hash.replace('#', '') + "']");

                $(".box-navigation ul li a.active").removeClass('active');
                $el.addClass('active');

                $("#video_box .section.active").fadeOut(function () {

                    $("#video_box .section.active")
                        .removeClass('active');

                    $panel.fadeIn()
                        .addClass('active');

                });

            }

        });

        $(window).hashchange();

    }

    $.slidingBoxContent();

}); 
```

CSS：

```
img {
    border: 0 !important;
}
#video_box {
    width: 820px;
    height: 520px;
    background: #FFF;
    color: #000;
    border: 1px solid #999999;
    top: -90%;
    left: 50%;
    margin-top: -260px;
    margin-left: -410px;
    position: fixed;
    -webkit-box-shadow: 0px 0px 5px 5px #cecece;
    -moz-box-shadow: 0px 0px 5px 5px #cecece;
    box-shadow: 0px 0px 5px 5px #cecece;
    z-index: 4000;
}
.video {
    position: absolute;
    left: 20px;
    top: 20px;
}
.reviews {
    position: absolute;
    left: 20px;
    top: 20px;
}
.facebook {
    position: absolute;
    left: 20px;
    top: 20px;
}
#video_box .section {
    display: none;
}
#video_box .section.active {
    display: block;
}
.fixed-navi {
    position: fixed;
    top: 213px;
    right: 0;
    color: FFF;
    list-style: none;
    padding: 0;
    width: 50px;
}
.fixed-navi li {
    padding: 0;
    margin: 0 10px 0 0;
    width: 48px;
    height: 48px;
}
.fixed-navi li a {
    background: url(http://www.gowithcea.com/uploadedImages/js/images/fixed-button.jpg) no-repeat;
    display: block;
    width: 48px;
    height: 16px;
    font: 10px Arial, sans-serif;
    text-align: center;
    text-decoration: none;
    color: #FFF;
    font-weight: bold;
    border-bottom: 1px solid #061123;
    border-left: 1px solid #006588;
    border-right: 1px solid #006588;
    border-top: 1px solid #006588;
    padding-top: 30px;
    position: relative;
}
.fixed-navi li a img {
    position: absolute;
    bottom: 21px;
    left: 17px;
    width: 17px;
}
.fixed-navi li a img.fb {
    position: absolute;
    bottom: 50%;
    left: 50%;
    width: 22px;
    margin-left: -11px;
    margin-bottom: -11px;
}
.fixed-navi li a:hover {
    background-position: 0 -48px;
}
.fixed-navi li a:active {
    background-position: 0 -96px;
}
.close-button, .close-button a {
    position: absolute;
    top: -8px;
    right: -8px;
    width: 30px;
    height: 24px;
    background: url(http://www.gowithcea.com/uploadedImages/js/images/close-button.png) no-repeat;
    color: #FFF !Important;
    text-decoration: none !important;
    text-align: center;
    -webkit-box-shadow: 0px 0px 1px 1px #cecece;
    -moz-box-shadow: 0px 0px 1px 1px #cecece;
    box-shadow: 0px 0px 1px 1px #cecece;
    font: bold 26px/20px Arial, sans-serif;
    padding-top: 6px;
}
.box-navigation {
    width: 140px;
    height: 520px;
    background: #123451;
    float: right;
}
.box-navigation ul {
    background: url(http://www.gowithcea.com/uploadedImages/js/images/sidebar-button.png) repeat;
    list-style: none;
    margin-top: 0;
    padding-top: 36px;
    padding-bottom: 0;
}
.box-navigation ul li {
    float: right;
    width: 140px;
    height: 38px;
}
.box-navigation ul li a img {
    position: relative;
    margin-right: 10px;
    top: 4px;
}
.box-navigation ul li a {
    padding: 5px 6px 6px 14px;
    background: url(http://www.gowithcea.com/uploadedImages/js/images/sidebar-button.png) repeat-x;
    height: 25px;
    float: left;
    width: 120px !Important;
    color: #FFF;
    text-decoration: none;
    text-transform: uppercase;
    font-family: Arial, Verdana, sans-serif;
    font-weight: bold;
    font-size: 14px;
}
.box-navigation ul li a:hover {
    background: url(http://www.gowithcea.com/uploadedImages/js/images/sidebar-button.png) 0 -36px;
}
.box-navigation ul li a.active {
    background: url(http://www.gowithcea.com/uploadedImages/js/images/sidebar-button.png) 0 -72px;
    border-top: 1px solid #00638A;
    border-bottom: 1px solid #0a223a;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:54:30.443

你用的是什么版本的IE？我在 IE9 中尝试过，第二次内容仍然存在（就像在 Chrome 和 Opera 中一样）。

# java - 我将如何配置 REST uri 来响应这个 uri

> ID：10112807
> 
> 赞同：0
> 
> 时间：2012-04-11T19:42:09.953
> 
> 标签：java, rest, uri, jersey

以下 GET 由以下 uri 触发

/PathA/SomePathA

```
@Path("/PathA")
public class SubscriptionEntry 
{
  @Path("{PathA}") 
  public SomeType SomeMethod(@PathParam("parA") String userip) 
  {
            //This is called!!! with  /PathA/SomePathA 
           return new SomeResource(uriInfo,request,userip,httpreq);
  }
} 
```

SomeResource 是这样的

```
public class SomeResource 
{
  @GET 
  public Type AnotherMethod
  {
        .....
        .....
  }

      @Path({"What is suppose to be here???? since this class has no name??}") 
      public MyType MyMethod()
      {.... 

      }

} 
```

我的问题是我如何调整上面的类（路径中需要什么），以便 MyMethod 被 uris 触发

/PathA/SomePathA/Test

或者

/PathA/SomePathA/SomePathB/Test

我尝试做类似以下的事情，但它不起作用

```
@Path("/Test") 
      public MyType MyMethod() {} 
```

关于如何使这项工作或我缺少什么的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T06:34:01.397

首先，从另一个资源调用一个资源是 RESTful 架构的错误方法。第二，你问的不可能。

相反，您应该确定资源之间的关系。示例：

*   班级有很多学生。
*   学生属于一个班级。

然后相应地形成您的 URL。喜欢

*   **GET /class** --> 获取所有类
*   **GET /class/{id}** --> 获取特定的类
*   **GET /class/{id}/students** --> 获取特定班级的学生
*   **GET /student** --> 获取所有学生
*   **GET /student/{id}** --> 获取一个特定的学生

[这是关于 URL 设计的好文章](http://redrata.com/restful-uri-design/)

# javascript - 在没有上下文的情况下通过 JavaScript 访问周围的 HTML 元素

> ID：10112809
> 
> 赞同：1
> 
> 时间：2012-04-11T19:42:12.217
> 
> 标签：javascript, dom, element

我想要的是能够**使用 JavaScript 处理围绕“入口点”（如标签或事件）****的无上下文 HTML 元素`<script>`**。我对我能做什么有一些严格的限制。

## 概括

1.  我有多个用户生成的 HTML 块，需要在加载时自行处理。
2.  这些块的内容可以包含相似的块，具有相似的行为。
3.  内容也需要复制一次，可能会重新执行 2 中提到的脚本。
4.  这些块是从静态模板生成的，不能（最初）包含唯一的标识数据，如 ID 或随机属性值。
5.  这些块也可以通过 AJAX 生成，这是我无法控制的。他们需要在出现时照顾好自己，而不依赖于任何执行顺序。

## 背景

这是一个论坛软件，其中某些 BBCode 标记，比如说`[tag]content[/tag]`被固定的 HTML 替换。我无权访问任何服务器端脚本，因此替换与上下文无关，即始终相同。例如，`[tag]{content}[/tag]`会变成类似：

```
<span ...>
  ...
  {content}
  ...
  <!-- script entry point -->
</span> 
```

我需要在加载数据时进行一些客户端处理。

我无法更改问题的要求。最终产品是用于生成选项卡的代码，例如：

```
[tabspace]
  [tab]content 1[/tab]
  [tab]
    content 2, and
    nested tabs:
    [tabspace]...[/tabspace]
  [/tab]
[/tabspace] 
```

脚本输出的内容包含在“选项卡按钮”本身中，它们将链接到它们各自的`content`.

## 限制

1.  我不能使用 ID。一切都必须是或开始作为模板的无上下文替换。
2.  `[tag]`s 可以嵌套。
3.  脚本需要复制一些内容，部分内容可以是类似的脚本等等。这会弄乱已经在外部标签对上运行的脚本。我有一个自下而上的解决方案来解决这个问题，但它依赖于在任何深度启动脚本，而不用担心类似的环境。（另一种表达方式）
4.  这些标签可以随时使用 AJAX 在页面上的任何帖子中动态加载。

5.  模板中的任何位置都可以有脚本，以使问题更容易。

## 我试过的

1.  使用 JS 在`<span id='something random'></span>`加载时动态输出 a，搜索给定的 ID 并使用它的位置来查找周围的元素。当我动态加载页面和嵌套标签时，它不起作用。
2.  给周围的元素一个类并找到它的最后一个元素。这不起作用，因为我们可能在页面中间有更新，在它加载之后。

## 我宁愿*避免的解决方案*

1.  使用`<img src='bogus' onerror='script entry point'/>`，我可以运行脚本并使用`this`. 但我宁愿不使用断开的链接和错误来解决一个简单而相关的问题。

# java - 是否可以使用“asterisk java”创建两个“asterisk”实例？

> ID：10112815
> 
> 赞同：0
> 
> 时间：2012-04-11T19:42:25.023
> 
> 标签：java, testing, asterisk, suite

我正在使用星号测试套件并创建自定义测试。但我正在尝试用 java 替换一些 python 脚本。

问题是我不知道如何使用“asterisk java”为每个使用自定义拨号计划创建两个星号实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T21:38:33.563

好消息是，除了最上面的 run-tests.py 脚本之外，Asterisk 测试套件与语言无关。您会发现用 python、lua 甚至 bash 编写的测试。Java 将是一个新的补充。我不建议尝试重写 runtests.py - 你不会得到很多回报，尽管我想你可以这样做。

至于对 Asterisk 实例进行“沙盒化”，使其不会与其他 Asterisk 实例发生冲突，并且您可以同时运行任意数量，您必须采取许多步骤才能使其正常工作。幸运的是，如果您查看 asterisk.py 模块（在 lib/python/asterisk 中） - 或 asttest/lib/lua 中的 astlib.lua - 您将有一些工作示例，说明必须完成的所有工作发生。

至少，您需要执行以下操作：

*   创建将托管您的测试的目录结构。按照惯例，执行的每个测试都在 /tmp/asterisk-testsuite/[test_directory] ​​下运行，其中 [test_directory] ​​可能包含多个子目录，并且反映了该测试在测试套件中的位置。请注意，在测试失败的情况下，最顶部的脚本中有很多东西希望事物位于该相对位置，所以我不会从那里移动它。
*   在您的测试目录中创建与您要运行的 Asterisk 实例相对应的子文件夹。这些通常命名为 astn，其中 n 是该目录中的下一个可用数字。例如，假设您有两个在测试期间运行的 Asterisk 实例。第一次运行测试时，您将创建子目录 ast1 和 ast2。下一次; ast3 和 ast4。
*   对于要生成的每个 Asterisk 实例，创建一个 asterisk.conf 配置文件，该文件指定相对于前两个步骤中提到的位置，所有 Asterisk 配置目录的位置。然后您将创建的asterisk.conf '安装'到/tmp/asterisk-testsuite/[test_directory]/ast[n]/etc/asterisk/asterisk.conf。
*   安装其余所需的配置文件。如果测试不提供配置文件，python/lua 库所做的是硬链接到主机系统上检测到的配置文件；否则他们会将配置文件复制到这些目录中。
*   硬链接到系统上安装的模块。如果每个测试都有自定义模块，则可以将它们放在测试运行目录中。
*   当你生成 Asterisk 时，你指定一个不同的配置位置，而不是使用 -C 选项的默认位置。

例如，让我们以 confbridge python 测试为例。它生成了三个 Asterisk 实例。第一次运行时，它会退出并查看 /tmp/asterisk-testsuite 是否存在。可以说不是。所以我们创建了那个目录。

```
/tmp/asterisk-testsuite/ 
```

We then see that the test being run lives in tests/apps/confbridge - so we make our test directory, since we haven't run yet either.

```
/tmp/asterisk-testsuite/apps/confbridge 
```

Now it gets interesting. We haven't run before, so when we check to see if any astn directories exist in our test directory, we determine that there aren't. So we create three of those directories.

```
/tmp/asterisk-testsuite/apps/confbridge
                                       /ast1
                                       /ast2
                                       /ast3 
```

Taking only ast1 as an example, we create an asterisk.conf file containing locations to our paths:

```
[directories](!)
astetcdir => /tmp/asterisk-testsuite/apps/confbridge/ast1/etc/asterisk
astmoddir => /tmp/asterisk-testsuite/apps/confbridge/ast1/usr/lib/asterisk/modules
astvarlibdir => /tmp/asterisk-testsuite/apps/confbridge/ast1/var/lib/asterisk
astdbdir => /tmp/asterisk-testsuite/apps/confbridge/ast1/var/lib/asterisk
astkeydir => /tmp/asterisk-testsuite/apps/confbridge/ast1/var/lib/asterisk
astdatadir => /tmp/asterisk-testsuite/apps/confbridge/ast1/var/lib/asterisk
astagidir => /tmp/asterisk-testsuite/apps/confbridge/ast1/var/lib/asterisk/agi-bin
astspooldir => /tmp/asterisk-testsuite/apps/confbridge/ast1/var/spool/asterisk
astrundir => /tmp/asterisk-testsuite/apps/confbridge/ast1/var/run/asterisk
astlogdir => /tmp/asterisk-testsuite/apps/confbridge/ast1/var/log/asterisk

[options]
verbose = 5
debug = 5
defaultlanguage = en           ; Default language
documentation_language = en_US  ; Set the language you want documentation
                ; displayed in. Value is in the same format as
                ; locale names.   
[compat]
pbx_realtime=1.6
res_agi=1.6
app_set=1.6 
```

We now copy our asterisk.conf into our test directory.

```
/tmp/asterisk-testsuite/apps/confbridge/ast1/etc/asterisk/asterisk.conf 
```

We would then hardlink the necessary installed module shared objects to the /var/lib/asterisk/modules subdirectory, and hardlink the installed configuration files to the /etc/asterisk subdirectory. Alternatively, for /var/lib/asterisk/modules, we could have just let that use the standard installed modules and not done the hardlinking, if you so desire.

Finally, when we spawn Asterisk, we use the following syntax:

```
asterisk -f -g -q -m -n -C /tmp/asterisk-testsuite/apps/confbridge/ast1/etc/asterisk/asterisk.conf 
```

*Addendum to what I wrote above*

There's nothing wrong with Java, but there's also a lot of re-inventing of the wheel you're going to have to do if you decide to go with a new language in the Test Suite - and not just in getting Asterisk spawned. We've written a lot of other stuff into the lua/python libraries that makes your life easier in addition to everything I've described here. Things like common test classes for CDR parsing and manipulation, voicemail manipulation, complex state machine interactions with SIPp, tests that harness multiple SIPp instances and orchestrate them in conjunction with the Test Suite - and we've been particularly focusing on the python libraries as of late. You may want to consider just going with Python - but, if you really love Java, by all means feel free to use that.

# asp.net - 是否可以为出生日期创建一个不一定覆盖日期的自定义编辑器？

> ID：10112818
> 
> 赞同：1
> 
> 时间：2012-04-11T19:42:46.560
> 
> 标签：asp.net, asp.net-mvc-3, data-annotations

我想为我们的视图模型上对应于 a 的属性创建一个自定义编辑器内容模板`Birthdate`，它实际上是数据库中的一个简单`smalldatetime`对象。我对简单地覆盖标准`Date`或犹豫不决`DateTime`，因为这是一个大型项目，我不想在任何地方强制这种行为。

是否可以将新的 DataType 添加到 DataAnnotations 的集合中`Birthdate`，或者是否有一些我尚未找到的标签，以便我可以指示该属性使用指定的编辑器和显示内容模板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:57:23.530

```
public class MyModel
{
    [UIHint("BirthDate")]
    public DateTime BornOn { get; set; }
} 
```

然后，在 Views/Shared/EditorTemplates 中，创建 BirthDate.cshtml。EditorFor 将使用该编辑器模板而不是 DateTime.cshtml 编辑器模板。

# android - Android 操作栏选项卡与 2.2 的兼容性

> ID：10112819
> 
> 赞同：0
> 
> 时间：2012-04-11T19:42:56.273
> 
> 标签：android, tabs, compatibility, android-actionbar

嗨，我已经开始使用 android 4.0 的操作栏和选项卡，但是当我尝试在 2.2 上打开应用程序时它崩溃了。我想知道我应该怎么做才能与 2.2+ 兼容它是否类似于不同版本的布局，例如您命名的 foler v8-layout 或类似的东西？

感谢和抱歉我的英语语法:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T19:47:22.900

Android 2.x 上不存在操作栏。任何引用该类的尝试`ActionBar`都将导致`VerifyError`.

如果您想在 Android 2.x 以及您的 Android 3.0+ 应用程序上拥有一个操作栏，您将需要使用一些额外的代码，例如[ActionBarSherlock](http://actionbarsherlock.com)。

# c#-3.0 - webclient.download 从 url 下载不完整的 tiff 图像

> ID：10112821
> 
> 赞同：0
> 
> 时间：2012-04-11T19:43:12.863
> 
> 标签：c#-3.0, lotus-domino

我正在使用以下代码从 Lotus domino 服务器下载 tiff 文件。

```
string url
    = "http://10.1.1.23\\Domino\\ImageDb.nsf\\500-99-9o9\\$File\\abc.tif";

// Create an instance of WebClient
WebClient client = new WebClient();

string filename 
    = "c:\\test.tif";

client.DownloadFile(url,filename); 
```

但是下载的文件是 4kb 而不是 22kb，当我尝试打开它时，它说它的格式不正确/无效。任何猜测出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T05:22:30.153

使用[Fiddler](http://www.fiddler2.com/fiddler2/)，您将看到 4kb 文件是当通过 HTTP 发出未经身份验证的内容请求并且无法匿名访问所请求的特定资源时，Domino 自动呈现的身份验证 HTML 页面。

在这种情况下，听起来当您在 Domino 中请求此文件资源时，您需要进行身份验证。

您可以通过在请求标头中提供一个有效的 LTPToken 来做到这一点，该标头在您通过身份验证后由 Domino 服务器发出。或者，如果无法进行身份验证，您可以使数据库 ACL 和文档可供“匿名”用户访问。虽然不是专门的 C# 代码，但这些链接将帮助您了解 Domino 上的 LTPA，[此处](http://www.dominoexperts.com/articles/Creating-a-session-for-a-user)、[此处](http://en.wikipedia.org/wiki/IBM_Lightweight_Third-Party_Authentication)和[此处](http://www-01.ibm.com/support/docview.wss?uid=swg21306272)

# php - CakePHP中与一张表的多个关系

> ID：10112825
> 
> 赞同：1
> 
> 时间：2012-04-11T19:43:25.157
> 
> 标签：php, cakephp

在我的应用程序中，用户可以与另一个用户成为朋友。因此，它们在两个表之间具有多对多关系。以这种方式：`Users > Friends < Users`

表格如下所示：

```
Users:
id
username
password

Friends:
id
user_id_from
user_id_to 
```

我已经像这样设置了模型：

```
class User extends AppModel
{
    public $name = 'User';

    public $hasOne = 'Profile';

    public $hasMany = array(
        'Post',
        'Answer',
    'Friend'
    );

    public $actsAs = array('Containable');
}

class Friend extends AppModel
{
    var $name = 'Friend';

    var $belongsTo = array(
        'Sender' => array(
            'className' => 'User',
            'foreignKey' => 'user_id_from'
        ),
        'Recipient' => array(
            'className' => 'User',
            'foreignKey' => 'user_id_to'
        )
    );

    public $actsAs = array('Containable');
} 
```

但是它似乎没有正确链接它们？

我在用户模型中使用此代码：

```
public function getFriends($username)
    {
        return $this->find('all', array('conditions' => array('User.username' => $username, 'Friend.status'=>1)

        ));
    } 
```

然后在访问类似的网址时`/users/USERNAME/friends`，应列出该人的朋友。调用它的方法是：

```
public function index( $username )
{   
    $friends = $this->User->getFriends($username);

    $this->set('friends', $this->paginate());
} 
```

有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T23:32:27.130

对于朋友关系，您应该使用 HABTM 而不是 hasMany。

```
class User extends AppModel
{
    public $name = 'User';

    public $hasOne = 'Profile';

    public $hasMany = array(
        'Post',
        'Answer',
    );

    public $hasAndBelongsToMany = array(
      'Friend' => array(
        'className' => 'User',
        'joinTable' => 'friends',
        'foreignKey' => 'user_id_to',
        'associationForeignKey' => 'user_id_from',
      )
    );

    public $actsAs = array('Containable');
} 
```

删除您当前的 Friend 模型，因为它不需要并且可能会混淆 Cake。

您的`getFriends()`方法将如下所示：

```
public function getFriends($username) {
   return $this->find('all', array(
     'conditions' => array(
       'User.username' => $username, 
       'User.status'=>1
      ),
      'contain' => array(
        'Friend'
      )
   ));
} 
```

在这里，我们搜索 User 模型并包含该用户的所有 Friend 记录。Cake 会自动获取连接表数据并包含用户数据。`$this->User->getFriends('Jeremy');`将返回如下所示的数据：

```
Array
(
    [User] => Array
        (
            [id] => 1
            [username] => Jeremy
        )
    [Friend] => Array
        (
           [0] => Array
                (
                    [id] => 2
                    [username] => Cameron
                )
           [1] => Array
                (
                    [id] => 3
                    [name] => Mark
                )
           [2] => Array
                (
                    [id] => 4
                    [name] => Bob
                )
        )
) 
```

这里的每个 Friend 键实际上是一个 User 模型结果。

您可以在此处阅读有关 HABTM 的更多信息：http: [//book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasandbelongstomany-habtm](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasandbelongstomany-habtm)

# javascript - 通过 nodejs 重新附加到生成的进程

> ID：10112827
> 
> 赞同：9
> 
> 时间：2012-04-11T19:43:39.230
> 
> 标签：javascript, node.js, process, stdio, child-process

我正在 Node.js 中创建一个小型专有游戏服务器管理器；目前它通过生成通过以下方式运行游戏`child_process`：

```
var server = spawn(cmd, args, { cwd: 'something' }); 
```

只要经理继续运行，我就可以管道命令并按照我的意愿处理孩子。但是，请考虑我的经理崩溃或关闭的可能性。然后我将如何*重新连接* 到先前生成的子进程（在管理器关闭时仍在运行）？我可以存储 pidfiles 以尝试基于 pid 重新连接；但我不确定如何获取可以`child_process`访问孩子对象的`stdio`对象。

我真的希望这是可以恢复的；任何帮助表示赞赏，谢谢！

* * *

**请注意**：游戏服务器是专有的，例如 Minecraft、Source DS 等。假设我无权访问服务器源。

* * *

**编辑**

从节点读取一些源代码后`child_process`，看起来如果您在名为`stdinStream`,的选项中指定了一个属性`stdoutStream`，或者`stderrStream`它应该只打开一个套接字。（见第[428](https://github.com/joyent/node/blob/master/lib/child_process.js#L428) - [496](https://github.com/joyent/node/blob/master/lib/child_process.js#L496)行）。所以问题是，我如何阻止 spawn*实际*执行 spawn，而只是根据指定的 pid 和我传递的流设置其值。（由于 fd 是作为管道创建的，所以我会`stdinStream`通过这样做来获得我的结果。）`fs.createWriteStream('/proc/PID/fd/0');`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T22:43:39.180

为了扩展上面评论中的内容，您可以使用[http://nodejs.org/api/net.html](http://nodejs.org/api/net.html)每个子进程创建一个服务器（`net.createServer()`端口，然后当您的主服务器重新启动时，它会查找该子列表并连接到每个服务器。`Sockets`您从中获得的替换`net.createConnection()`您`child_process`的主人中的对象。

`net`服务器和套接字实现与 相同的 Readable 和 Writable [Stream](http://nodejs.org/api/stream.html)接口`stdio`，因此在设置和连接之后，您应该能够像您一直在做的那样处理事件`write(...)`。`pipe()`

这可能不是最好的解决方案，但我相信它会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T12:37:42.693

在与 node 项目中的一些人交谈之后，看起来我能做到这一点的唯一方法是处理 proc fs 中的原始文件描述符。我可能会模拟类似于`child_process`对象的东西并创建它的流，例如：

```
var child = {};
child.stdin = fs.createWriteStream('/proc/PID/fd/0');
child.stdout = fs.createReadStream('/proc/PID/fd/1');
child.stderr = fs.createReadStream('/proc/PID/fd/2'); 
```

# html - 难以置信的 CSS div 跳转

> ID：10112831
> 
> 赞同：-4
> 
> 时间：2012-04-11T19:43:50.837
> 
> 标签：html, css

看它或你自己！food-category-box div 从标题到其余内容有莫名的跳转。我们搞不定？

[我的代码](http://jsfiddle.net/2Lc5y/)也显示在这里：

```
/* Begin Base */

body {
    color: #245a03;
    background-color: #e7f5df;
    font-family: "Helvetica Neue Light", "HelveticaNeue-Light",
    "HelveticaNeue", Helvetica, Arial;
    font-size: 17px;
    margin: 0;
    padding: 0;
    height: 100%;
}
```

```
<!doctype html>

<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>MealMarket</title>
    <meta name="description" content="">
    <meta name="author" content="" >
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" >

    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.css"/>
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap-responsive.css"/>        
    <link rel="stylesheet" href="/static/css/style.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='http://fonts.googleapis.com/css?family=Voces' rel='stylesheet' type='text/css'>

    <script src="/static/bootstrap/js/bootstrap-alert.js"></script>
    <script src="/static/js/libs/modernizr-2.5.3.min.js"></script>
</head>

<body class="">

    <div id="container">

        <div id="header">
         <a href="/"><h1>Meal Market</h1>
            <span>Share food, get food, more merry mealtimes</span></a>
        </div>

        <div id="main" role="main" class="container">

<div id="user-info">

        <img src="/static/images/pics/profile-default.jpg">

    <div id="user-column-options">
        <h3 style="word-wrap:break-word;">
            Matt</h3>

        <p>Credits: 10</p>
        <ul>
            <li><a href="/meals/new/">Make meal</a></li>
            <li><a href="/meals">Find meal</a></li>
            <!--<li><a href="">Past meals</a></li>-->
        </ul>
    </div>

</div> 

<!-- End user info column -->
<div id="stream">

<!-- Start user's coming hosted meals div -->
    <div class="meal-category-box">
        <h4>Coming Meals that You&#39;re Cooking</h4><br />

            <div class="meal-box-small">
                <div class="meal-details">
                    <p><h5><a href="/meals/matt/22/Apr/2012/05:30">
                        Fungus food</a></h5>
                        &nbsp;&nbsp;April 22, 2012, 5:30 a.m.
                    </p>
                    <p>&nbsp;&nbsp;(View map)</p>
                    <p style="margin-top: 10px;">

                            <div style="margin-top: 20px;" class="emphasis-box"><a href="/meals/matt/22/Apr/2012/05:30?mealsignup=true" class="btn">Click to attend this meal</a></div>

                    </p>
                </div>
            </div>

            <div class="clearer">&nbsp;</div>

            <div class="meal-box-small">
                <div class="meal-details">
                    <p><h5><a href="/meals/matt/21/Apr/2012/19:00">
                        Lentil stew</a></h5>
                        &nbsp;&nbsp;April 21, 2012, 7 p.m.
                    </p>
                    <p>&nbsp;&nbsp;(View map)</p>
                    <p style="margin-top: 10px;">

                            <div style="margin-top: 20px;" class="emphasis-box"><a href="/meals/matt/21/Apr/2012/19:00?mealsignup=true" class="btn">Click to attend this meal</a></div>

                    </p>
                </div>
            </div>

            <div class="clearer">&nbsp;</div>

    </div>    
    <!-- End user's coming hosted meals div -->

    <div class="clearer">&nbsp;</div>
    <div class="clearer">&nbsp;</div>

    <!-- Start other coming meals div -->

    <div class="meal-category-box">
        <h4>Other Upcoming Meal Invites</h4>

        <div class="meal-box">
            <img src="">
            <div class="meal-details">
                <p><h5><a href="/meals/jervin/13/Apr/2012/00:30">
                    Great flippin&#39; food</a></h5>
                </p>
                <p>April 13, 2012, 12:30 a.m.<p>
                <p> (View map)</p>
                <p>Cooked by 
                    <a href="/users/jervin/">
                    jervin</a>
                </p>

                <div style="margin-top: 20px;" class="emphasis-box"><a href="/meals/jervin/13/Apr/2012/00:30?mealsignup=true" class="btn">Click to attend this meal</a></div>
            </div>    
        </div>                            

        <div class="meal-box">
            <img src="">
            <div class="meal-details">
                <p><h5><a href="/meals/jervin/29/Apr/2012/04:30">
                    Veggie curry</a></h5>
                </p>
                <p>April 29, 2012, 4:30 a.m.<p>
                <p> (View map)</p>
                <p>Cooked by 
                    <a href="/users/jervin/">
                    jervin</a>
                </p>

                <div style="margin-top: 20px;" class="emphasis-box"><a href="/meals/jervin/29/Apr/2012/04:30?mealsignup=true" class="btn">Click to attend this meal</a></div>
            </div>    
        </div>                            

    </div>
    <!-- End other coming meals div -->

</div>    

<div class="clearer">&nbsp;</div>

        </div>

        <div id="clearer">&nbsp;</div>

            <footer class="footer">
            <hr>
            <ul id="footer-links">
                <li><a href="/about">About / FAQ</a></li>
                <li><a href="/legal">Privacy / Legal</a></li>
                <li><a href="/media">Media</a></li>
                <li><a href="/contact">Contact</a></li>
                </ul>    
            </footer>
        </div>
    </div> <!-- end of #container -->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/static/js/libs/jquery-1.6.2.min.js"><\/script>')</script>
    <!--<script defer src="/static/js/plugins.js"></script>
    <script defer src="/static/js/script.js"></script>-->

    <script src="/static/bootstrap/js/bootstrap-collapse.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    $(".collapse").collapse({toggle: false});
});
</script>

<script type="text/javascript">

    // On click...
    $("#cross-icon").click(function() {
    $('#new-user-box p').slideUp("slow")
      $('#new-user-box').slideUp("slow");

    });
    </script>

    <script> // Change UA-XXXXX-X to be your site's ID
        window._gaq = [['_setAccount','UAXXXXXXXX1'],['_trackPageview'],['_trackPageLoadTime']];
        Modernizr.load({
            load: ('https:' == location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js'
        });
    </script>

    <!--[if lt IE 7 ]>
        <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
        <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
    <![endif]-->

</body>
</html>
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:49:10.510

你的 70px 底部边距怎么样`#header`？（开发者工具：使用它们。）

![在此处输入图像描述](../Images/831732f97a51adc74ad45124207b0072.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:49:46.510

从. `clear: both;`_`.meal-box-small`

`#user-column-options`设置为`float: left;`，因此`clear: both;`原因`.meal-box-small`会低于该值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:49:39.470

`div#header`有一个`margin-bottom`70px。减少它以减少标题和内容之间的空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T19:54:41.273

在您的 HTML 中进行此更改：

```
<!-- Start user's coming hosted meals div -->
    <div class="meal-category-box">
        <h4>Coming Meals that You&#39;re Cooking</h4>
            <div class="meal-box">
                <div class="meal-details"> 
```

只需将带有饭盒小类的 div 更改为饭盒类，一切都很好。

# entity-framework - 如何仅插入新关系并删除现有关系 - 多对多实体框架 4.0

> ID：10112834
> 
> 赞同：0
> 
> 时间：2012-04-11T19:44:02.513
> 
> 标签：entity-framework, many-to-many

我有 3 个具有多对多关系的表

问题 -（QuestionId，问题）

标签 - (TagId, TagName)

QuestionTag - (QuestionId, TagId)

我有一个场景，用户提出问题，他们可以向其中添加相关标签。

以后如果他们需要为现有的任务添加一些新的标签（已经在数据库中），怎么做？我只需要将 questionId 和 TagId 添加到“QuestionTag”表中，而不需要添加新的问题或标签，因为它们已经添加到表中。怎么做？

[我在链接Insert/Update Many to Many Entity Framework](https://stackoverflow.com/q/4253165/1223184)发现了一个类似的问题。[我该怎么做？](https://stackoverflow.com/q/4253165/1223184) 它具有类似的场景，其中添加了新问题并映射了已经在数据库中的标签。

```
using (var context = new MyContext())
{
    var question= new Question { Question = "I have a question" };    
    Tag tag1 = context.Tags.FirstOrDefault(s => s.Name == "C#");    
    Tag tag2 = context.Tags.FirstOrDefault(s => s.Name == ".net");    
    question.Tags.Add(tag1);    
    question.Tags.Add(tag2);    
    context.AddToQuestiones(question);    
    context.SaveChanges();
} 
```

因此，为了处理我的场景，我将上面的代码修改为

```
var question= context.Question.FirstOrDefault(q => q.QuestionId == 1); 
```

但我得到了以下异常。

> “无法定义两个对象之间的关系，因为它们附加到不同的 ObjectContext 对象。”

此外，假设是否错误地添加了不匹配的标签名称，如何从“QuestionTag”中删除任何问题的问题标签。

帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T23:33:38.670

不要将问题添加到上下文中（使用`context.AddToQuestiones(question)`），您只是在*更改*关系并且不想在数据库中创建新实体：

```
using (var context = new MyContext())
{
    Question question = context.Question.FirstOrDefault(q => q.QuestionId == 1);
    Tag tag1 = context.Tags.FirstOrDefault(s => s.Name == "C#");
    Tag tag2 = context.Tags.FirstOrDefault(s => s.Name == ".net");

    question.Tags.Add(tag1);
    question.Tags.Add(tag2);

    context.SaveChanges();
} 
```

如果要删除标签，请从数据库中加载*包含*标签的问题，然后从加载的集合中删除标签：

```
using (var context = new MyContext())
{
    Question question = context.Question.Include("Tags")
        .FirstOrDefault(q => q.QuestionId == 1);

    // Retrieve the tag from the already loaded collection,
    // you don't need to query the DB again for the tag
    Tag tagToRemove = question.Tags.FirstOrDefault(s => s.Name == "C#");
    if (tagToRemove != null)
        question.Tags.Remove(tagToRemove);

    context.SaveChanges();
} 
```

确保您使用相同的`context`实例来加载问题和标签。您遇到的异常表明您正在使用多个不同的上下文。

# blogs - sitefinity 5：如何链接到另一篇博客文章

> ID：10112841
> 
> 赞同：1
> 
> 时间：2012-04-11T19:44:31.450
> 
> 标签：blogs, sitefinity, sitefinity-5

在博客文章 A 中，我想引用同一博客中的前一篇文章。“有关这方面的更多信息，请参阅[另一篇文章](http://#)。”

我有没有办法让“this other article”成为同一个博客中另一个现有帖子的链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T15:37:28.780

不幸的是没有你想象的那么容易。当您在“新”博客文章中创建链接时，您必须将“旧”文章的绝对 URL 粘贴到链接创建者中。

我确实听说在 SF6 中他们将能够选择页面之类的帖子。

# java - NullPointerException 与 while 循环使用 compareTo

> ID：10112844
> 
> 赞同：1
> 
> 时间：2012-04-11T19:44:36.200
> 
> 标签：java, nullpointerexception, compareto, doubly-linked-list

对于我们的作业，我必须接受`Chair`对象并将它们添加到`DoublyLinkedList`我们制作的东西中；它必须按字母顺序排序，如果样式按字母顺序相同，我们按颜色排序

当我尝试通过循环时，我不断得到一个`NullPointerException`.

```
public void add(Chair element){
    if(isEmpty() || first.object.style.compareTo(element.style) > 0 || (first.object.style.compareTo(element.style) == 0 && first.object.color.compareTo(element.color) >= 0){
        addFirst(element);
    }else if(first.object.style.compareTo(element.style) <= 0){
        Node temp = first;
        Node insert = new Node(); insert.object = element;
        while(temp.object.style.compareTo(element.style) <= 0) //This is where the nullPointerException occurs
            if(temp.hasNext())
                temp = temp.next;
        while(temp.object.style.compareTo(element.style) == 0 && temp.object.color.compareTo(element.color) <= 0)
            if(temp.hasNext())
                temp = temp.next;
        insert.prev = temp.prev;
        insert.next = temp;
        temp.prev.next = insert;
        temp.prev = insert;
    }
} 
```

这是我将信息放入 DoublyLinkedList 的代码

```
try{
        FileReader fr = new FileReader(filename);
        Scanner sc = new Scanner(fr);
        String[] temp;

        while(sc.hasNext()){
            temp = sc.nextLine().split(" ");
            if(temp[0].equals("Bed")){}
            else if(temp[0].equals("Table")){
            //  tables.add(new Table(Integer.parseInt(temp[1]), Integer.parseInt(temp[2]), Integer.parseInt(temp[3]), temp[4]));
            }else if(temp[0].equals("Desk")){}
            else if(temp[0].equals("Chair")){
                chairs.add(new Chair(temp[1], temp[2]));
            }else if(temp[0].equals("Bookshelves")){}
            else{
                color = temp[0];
            }
        }
        while(!chairs.isEmpty())
            System.out.println(chairs.removeFirst().info());
        System.out.println();
        //while(!tables.isEmpty())
        //  System.out.println(tables.removeFirst().info());
    }catch(Exception e){e.printStackTrace();} 
```

这是我创建的 DoublyLinkedList 类： class CDoublyLinkedList{ Node first, last;

```
public CDoublyLinkedList(){
    first = new Node(); last = new Node();
    first.prev = last.next = null;
    first.object = last.object = null;
    first.next = last;
    last.prev = first;
}

public boolean isEmpty(){
    return first.object == null;
}

public void addFirst(Chair element){
    Node insert = new Node();
    insert.object = element;
    insert.prev = null;
    insert.next = first;
    first.prev = insert;
    first = insert;
}

public void add(Chair element){
    if(isEmpty() || first.object.style.compareTo(element.style) > 0 || (first.object.style.compareTo(element.style) == 0 && first.object.color.compareTo(element.color) >= 0){
        addFirst(element);
    }else if(first.object.style.compareTo(element.style) <= 0){
        Node temp = first;
        Node insert = new Node(); insert.object = element;
        while(first.object.style.compareTo(element.style) <= 0)
            if(temp.hasNext())
                temp = temp.next;
        while(first.object.style.compareTo(element.style) == 0 && first.object.color.compareTo(element.color) <= 0)
            if(temp.hasNext())
                temp = temp.next;
        insert.prev = temp.prev;
        insert.next = temp;
        temp.prev.next = insert;
        temp.prev = insert;
    }
}

public Chair removeFirst(){
    Chair tobedeleted = first.object;
    Node temp = first.next;
    first = temp;
    first.prev = null;
    return tobedeleted;
}

private class Node{
    Node next, prev;
    Chair object;
    public boolean hasNext(){
        return next != null;
    }
} 
```

}

主席班：

```
class Chair extends Furniture{
public String style, color;
public Chair(String s, String c){
    style = s; color = c;
}
public String toString(){
    return color;
}
public String getType(){
    return "Chair";
}
public String info(){
    return (color+", "+style);
}
 } 
```

有人可以向我解释为什么我不断收到此错误吗？谢谢！

编辑：

```
while(temp.object.style.compareTo(element.style) <= 0) //This is where the nullPointerException occurs

chairs.add(new Chair(temp[1], temp[2]));

java.lang.NullPointerException
at CDoublyLinkedList.add(Furnish2SS.java:119)
at Furnish2SS.main(Furnish2SS.java:23)
java.lang.NullPointerException
at CDoublyLinkedList.add(Furnish2SS.java:119)
at Furnish2SS.main(Furnish2SS.java:23) 
```

EDIT2：解决了！

我将while循环更改为：

```
while(temp.object != null && element != null && (temp.object.compareTo(element) == 0 || temp.object.compareTo(element) == -1)) 
```

我收到错误的原因是因为我没有检查`null`每次迭代。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T22:13:22.730

看看`addFirst(Chair element)`。那个方法真的太坑了。它创建一个`Node`包含正确`Chair`. 然后将其设置`prev`为`null`。然后它设置`next`为`first`。这就是造成你所有麻烦的原因。因为`first`指向一个空`Node`。你最终得到这个：

`first`指向你的新`Node`. 那 一个 指向`Node`不 持有的`Chair`。那又是一指`last`。

e:

您的整个代码看起来至少有两种不同的方法来实现您的列表并将它们放在一起。还有一些错误，但是由于这是家庭作业，我想如果您先尝试修复它，那还不错。

如果您不知道如何纠正，请在此处询问。

PS：很抱歉所有的编辑和（取消）删除我的答案（如果你注意到的话）。我有点累了，不断地通过修复旧错误来制造新的错误，直到我终于弄清楚这一切的真正原因是什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:28:30.800

你说这是导致异常的代码行：

```
while(temp.object.style.compareTo(element.style) <= 0) 
```

您可能应该在该行上设置一个调试器断点并使用调试器来确定哪些值为空。但是我很难在这里解释如何设置和使用调试器的完整说明（这并不意味着你不应该学习！你应该学习。有很多教程。谷歌它。）所以而不是写一个关于调试器，我将发布代码来告诉您哪个变量为空：

```
if (temp == null) {
    System.out.println("temp is null");
} else if (temp.object == null) {
    System.out.println("temp.object is null");
} else if (temp.object.style == null) {
    System.out.println("temp.object.style is null");
} 

if (element == null) {
    System.out.println("element is null");
} else if (element.style == null) {
    System.out.println("element.style is null");
}

while(temp.object.style.compareTo(element.style) <= 0) //This is where the nullPointerException occurs
{
    if(temp.hasNext())
        temp = temp.next;

    if (temp == null) {
        System.out.println("loop: temp is null");
    } else if (temp.object == null) {
        System.out.println("loop: temp.object is null");
    } else if (temp.object.style == null) {
        System.out.println("loop: temp.object.style is null");
    } 

    if (element == null) {
        System.out.println("loop: element is null");
    } else if (element.style == null) {
        System.out.println("loop: element.style is null");
    }

} 
```

如果您使用上面的代码语句来替换这三行代码：

```
 while(temp.object.style.compareTo(element.style) <= 0) //This is where the nullPointerException occurs
        if(temp.hasNext())
            temp = temp.next; 
```

您将根据打印的语句知道哪个变量为空。希望你能从那里拿走它。（修复 NullPointerException 的常用方法是采取必要的步骤，以确保在程序到达 NullPointerException 行时，有问题的 null 变量实际上具有有效的非 null 值）。

# database - 用于自然语言查询处理的数据库

> ID：10112845
> 
> 赞同：5
> 
> 时间：2012-04-11T19:44:43.220
> 
> 标签：database, yahoo

我只是想知道 Google、Yahoo 或 Bing 使用哪些数据库进行自然语言查询处理。我的意思是他们可以用自然语言处理如此复杂的查询。他们是否以编程方式处理我们的查询并分解为某种散列，然后映射到结果。请不要介意这个问题是否愚蠢。我只是一个新手。我只是想知道用于此类目的的所有类型的数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:01:33.627

在 Google 或 Bing 上输入 Lucene 或输入 Solr 或输入 Sphinx。

然后，除了索引数据结构之外，您还将了解有关词干、同义词库、同义词、搜索引擎中的查询扩展、变位等方面的知识。所有这些都将帮助您获得问题的答案。

完成上述操作后，您可以阅读更多关于在关键字、集体智慧、群体智慧之间建立语义关系的信息，这将帮助您建立例如 java 和 jee 以及 jsp 和 servlet 等关键字之间的相似性。

# c++ - 你如何在 makefile 中只编译一个 .h 文件？

> ID：10112851
> 
> 赞同：5
> 
> 时间：2012-04-11T19:45:15.013
> 
> 标签：c++, makefile, g++

我有一个为两个类（和主类）创建目标文件的生成文件，其中一个类只是在 .h 文件中定义。在我的makefile中，我有一行说

```
FileName.o: FileName.h
  g++ -c FileName.h 
```

但是当我尝试编译它说它找不到 FileName.o

我是否必须创建 FileName.cpp 才能编译它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T19:58:34.227

您正在某个地方使用 FileName.h 中的类，不是吗？因此，您的 .cpp 文件中至少应包含`#include "FileName.h"`.h 的代码，并且 .h 的代码将使用此 .cpp 进行编译，您无需单独编译 .h 的代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-11T19:48:15.520

您通常不会尝试自行编译头文件 (.h)。将它包含到一个空的 .cpp 文件中可以让你编译它并生成一个 .o 文件，但它可能不会做太多（如果有的话）真正的好处，除非你把东西放在不真正属于的标题中在标题中。

# visualization - 如何在 d3.js 中创建“斜率图”

> ID：10112866
> 
> 赞同：9
> 
> 时间：2012-04-11T19:46:40.890
> 
> 标签：visualization, d3.js

在*量化信息的可视化显示中*，Edward Tufte 创造了一个术语“斜率图”来表示一种非常简单的图表（[更多信息](http://charliepark.org/slopegraphs/)）。权威的例子是这样的：

![斜率图示例](../Images/ff87aac82a5d7523f50e403579d9808a.png)

[在d3.js](http://mbostock.github.com/d3/)中至少有两种斜坡图的实现：

*   [http://markmarkoh.com/tuftes-slope-graphs-in-svg-using-d3js/](http://markmarkoh.com/tuftes-slope-graphs-in-svg-using-d3js/)
*   [http://skedasis.com/d3/slopegraph/](http://skedasis.com/d3/slopegraph/)

我尝试了一个更具声明性的实现，并在两列中的值之间保持 100% 的对应关系，但被卡住了。正如预期的那样，当数据集中出现具有相似或相同值的项目时，图形重叠，图表不可读。

[朴素版本](http://data.karmi.cz/d3/life-expectancy-slopegraph/)( [source](https://gist.github.com/2339918) ) 使用比例尺`linear`计算水平位置，而[尝试“标准化”位置](http://data.karmi.cz/d3/life-expectancy-slopegraph-normalized/)( [source](https://gist.github.com/2339918/499ce3758141516e09396674b277ae3e6f140a2b) ) 使用`ordinal`比例尺。

我相信使用序数比例可以实现更好的结果，根据重叠项目的坐标计算偏移量。是否应该为两列分别计算偏移量，是否应该根据数据提前计算，还是在设置属性期间即时计算？如何扩展代码库，使具有相同值的项目位于彼此下方，其他项目相应调整并且两列中的值保持在相同的水平位置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T02:45:57.620

写得很好的问题和带有调试语句的漂亮起始代码，道具！

没有完成我想到的所有事情的编码，但至少为了讨论，这里是。（编码很容易；想出要编码的内容/应该是什么样子更难。）

1.  使用线性比例作为指导的 [非优化] 版本，但通过将所有后续条目向下移动来分隔重叠条目。（我想这实际上只是拉伸了 Y 轴；不幸的是，这使它成为一个非常高的图像。尝试比较更近的年份，例如 2008 年和 2009 年——图像没有被拉伸。） [http://bl.ocks.org/2547496](http://bl.ocks.org/2547496)（[要点](https://gist.github.com/2547496)）

2.  相同的方法适用于序数尺度。我更喜欢`linear`比例版本，因为`ordinal`比例版本不会尝试通过斜坡传达任何绝对信息。然而，这使得图像更紧凑。[http://bl.ocks.org/2573074](http://bl.ocks.org/2573074)（[要点](https://gist.github.com/2573074)）

3.  将附近的值组合在一起。（如果有兴趣将实施。）

请注意，示例 1 和示例 2 都是不完美的实现，但您明白了。如果您正在寻找其中任何一个，我可以修复它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T21:22:23.383

只是想分享杰夫克拉克的另一个例子：

[http://neoformix.com/Projects/ObesitySlope/](http://neoformix.com/Projects/ObesitySlope/)

![在此处输入图像描述](../Images/eff532e684f5e928e0c86b32714f0a44.png)

他使用了处理，但非常优雅地处理了上面的一些问题（有人可以说它也使用标准化变量变得更简单一些）

1.  使用扩展聚合来简化可视化并减少数据点的初始数量。
2.  主要为每个点标记斜坡的一侧
3.  隐藏关闭/重叠点上的标签，直到它们悬停（此时，初始标签暂时消失）

总的来说，杰夫在这方面做得非常出色。我认为他非常注重细节。很想在 D3 中看到类似的例子！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T02:22:11.187

我正在玩弄你的第一个例子，试图解决混乱的文本标签问题，我不确定它会有多大用处，但如果它增加了讨论，我想我会分享..

我的第一个努力是淡化悬停在数据点的文本标签周围的文本，这只是选择与当前选定标签的边界框重叠的文本标签，并将它们转换为接近零的不透明度： [http://bl.ocks .org/2554902](http://bl.ocks.org/2554902)

然后我尝试了一种以紧凑方式排列文本标签的方法，以便它们中的每一个都是可见的，我没有完成它的实现，因为它似乎过多地扩展了可视化的边界（它目前也没有更改年份时效果很好..），但在稍微不那么“紧凑”的数据上寻找类似的东西可能是值得的：http: [//bl.ocks.org/2554910](http://bl.ocks.org/2554910)

编辑：似乎这些在 Firefox 中无法按预期工作，似乎是 getBBox() 的问题。

# android - Example of Director, Stage, Group, Actor, Box2D and GestureDector LibGdx

> ID：10112868
> 
> 赞同：1
> 
> 时间：2012-04-11T19:46:48.393
> 
> 标签：android, libgdx

Im curious to know, cant seem to find on Google or Wiki and solid examples so my quest is to drum up a decent example..using Director, Stage, Group, Actor, Box2D and GestureDector in LibGdx. (Using Textures, Images, TextureRegions etc)

Would any genius out there have any reference material - example source code so I can learn.

I've looked at dozens of sites, wiki, blogs etc and need some guidance.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T05:33:32.833

[http://code.google.com/p/codejie](http://code.google.com/p/codejie) - this was down and finally found it online again....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T12:32:38.460

I have an example of Scene2D elements with Box2d here:

[http://www.netthreads.co.uk/2012/04/23/libgdx-box2d-scene2d-bumpers-demo/](http://www.netthreads.co.uk/2012/04/23/libgdx-box2d-scene2d-bumpers-demo/)

# android - 读取嵌套 Parcelable 时崩溃

> ID：10112870
> 
> 赞同：2
> 
> 时间：2012-04-11T19:46:52.417
> 
> 标签：android, parcelable

我有一个扩展 Parcelable 的类。它有一个成员变量，它是另一个类的 ArrayList，它也扩展了 Parcelable。

我将 Intent 中的 MyClass1 对象传递回 Activity 并将其读入。当构造函数到达 in.readTypedList 时，应用程序崩溃并出现以下错误：

```
04-11 14:19:11.223: E/AndroidRuntime(502): Uncaught handler: thread main exiting due to uncaught exception
04-11 14:19:11.234: E/AndroidRuntime(502): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=0, result=-1, data=Intent { (has extras) }} to activity {com.mypackage.app/com.mypackage.app.activity.MyActivity}: java.lang.NullPointerException
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.app.ActivityThread.deliverResults(ActivityThread.java:3329)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.app.ActivityThread.handleSendResult(ActivityThread.java:3371)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.app.ActivityThread.access$2700(ActivityThread.java:119)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1893)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.os.Looper.loop(Looper.java:123)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.app.ActivityThread.main(ActivityThread.java:4363)
04-11 14:19:11.234: E/AndroidRuntime(502):  at java.lang.reflect.Method.invokeNative(Native Method)
04-11 14:19:11.234: E/AndroidRuntime(502):  at java.lang.reflect.Method.invoke(Method.java:521)
04-11 14:19:11.234: E/AndroidRuntime(502):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-11 14:19:11.234: E/AndroidRuntime(502):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-11 14:19:11.234: E/AndroidRuntime(502):  at dalvik.system.NativeStart.main(Native Method)
04-11 14:19:11.234: E/AndroidRuntime(502): Caused by: java.lang.NullPointerException
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.os.Parcel.readTypedList(Parcel.java:1497)
04-11 14:19:11.234: E/AndroidRuntime(502):  at com.mypackage.app.utils.Strength.<init>(Strength.java:44)
04-11 14:19:11.234: E/AndroidRuntime(502):  at com.mypackage.app.utils.Strength$1.createFromParcel(Strength.java:171)
04-11 14:19:11.234: E/AndroidRuntime(502):  at com.mypackage.app.utils.Strength$1.createFromParcel(Strength.java:1)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.os.Parcel.readParcelable(Parcel.java:1845)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.os.Parcel.readValue(Parcel.java:1713)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.os.Parcel.readMapInternal(Parcel.java:1947)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.os.Bundle.unparcel(Bundle.java:169)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.os.Bundle.containsKey(Bundle.java:210)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.content.Intent.hasExtra(Intent.java:3067)
04-11 14:19:11.234: E/AndroidRuntime(502):  at com.mypackage.app.activity.MyActivity.onActivityResult(MyActivity.java:306)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.app.Activity.dispatchActivityResult(Activity.java:3828)
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.app.ActivityThread.deliverResults(ActivityThread.java:3325)
04-11 14:19:11.234: E/AndroidRuntime(502):  ... 11 more 
```

* * *

```
public class MyClass1 implements Parcelable {

    private int mVar1;
    private int mVar2;
    private int mVar3;
    private long mVar5;
    private long mVar6;
    private String mVar7;
    private String mVar8;
    private String mVar9;
    private String mVar10;
    private ArrayList<MyClass2> mVar11;

    public MyClass1() {
        mVar1 = -1;
        mVar2 = -1;
        mVar3 = -1;
        mVar5 = 0;
        mVar6 = 0;
        mVar7 = null;
        mVar8 = null;
        mVar9 = null;
        mVar10 = null;
        mVar11 = new ArrayList<MyClass2>();
    }

    public MyClass1(Parcel in) {
        mVar1 = in.readInt();
        mVar2 = in.readInt();
        mVar3 = in.readInt();
        mVar5 = in.readLong();
        mVar6 = in.readLong();
        mVar8 = in.readString();
        mVar9 = in.readString();
        mVar10 = in.readString();
        in.readTypedList(mVar11, MyClass2.CREATOR);
        mVar7 = in.readString();
    }

    public int getVar1() {
        return mVar1;
    }

    public void setVar1(int intVar1) {
        this.mVar1 = intVar1;
    }

    public int getVar2() {
        return mVar2;
    }

    public void setVar2(int intVar2) {
        this.mVar2 = intVar2;
    }

    public int getVar3() {
        return mVar3;
    }

    public void setVar3(int intVar3) {
        this.mVar3 = intVar3;
    }

    public long getVar5() {
        return mVar5;
    }

    public void setVar5(long lngVar5) {
        this.mVar5 = lngVar5;
    }

    public long getVar6() {
        return mVar6;
    }

    public void setVar6(long lngVar6) {
        this.mVar6 = lngVar6;
    }

    public String getVar7() {
        return mVar7;
    }

    public void setVar7(String strVar7) {
        this.mVar7 = strVar7;
    }

    public String getVar8() {
        return mVar8;
    }

    public void setVar8(String strVar8) {
        this.mVar8 = strVar8;
    }

    public String getVar9() {
        return mVar9;
    }

    public void setVar9(String strVar9) {
        this.mVar9 = strVar9;
    }

    public String getVar10() {
        return mVar10;
    }

    public void setVar10(String strVar10) {
        this.mVar10 = strVar10;
    }

    public ArrayList<MyClass2> getVar11() {
        return mVar11;
    }

    public void setVar11(ArrayList<MyClass2> aryVar11) {
        this.mVar11 = aryVar11;
    }

    public void addVar11(MyClass2 mc2) {
        this.mVar11.add(mc2);
    }

    public MyClass2 removeVar11(int index) {
        if (index < this.mVar11.size()) {
            return this.mVar11.remove(index);
        }

        return null;
    }

    public static final Parcelable.Creator<MyClass1> CREATOR = new Parcelable.Creator<MyClass1>()
    {
        public MyClass1 createFromParcel(Parcel in) {
            return new MyClass1(in);
        }

        public MyClass1[] newArray (int size) {
            return new MyClass1[size];
        }
    };

    public int describeContents() {
        return 0;
    }

    public void writeToParcel (Parcel dest, int flags) {
        dest.writeInt(mVar1);
        dest.writeInt(mVar2);
        dest.writeInt(mVar3);
        dest.writeLong(mVar5);
        dest.writeLong(mVar6);
        dest.writeString(mVar8);
        dest.writeString(mVar9);
        dest.writeString(mVar10);
        if (mVar11 == null) {
            mVar11 = new ArrayList<MyClass2>();
        }
        dest.writeTypedList(mVar11);
        dest.writeString(mVar7);
    }
}

public class MyClass2 implements Parcelable {

    private int mVar1;
    private int mVar2;
    private String mVar3;
    private String mVar4;

    public MyClass2() {
        mVar1 = -1;
        mVar2 = -1;
        mVar3 = null;
        mVar4 = null;
    }

    public MyClass2(Parcel in) {
        mVar1 = in.readInt();
        mVar2 = in.readInt();
        mVar3 = in.readString();
        mVar4 = in.readString();
    }

    public int getVar1() {
        return mVar1;
    }

    public void setVar1(int intVar1) {
        this.mVar1 = intVar1;
    }

    public int getVar2() {
        return mVar2;
    }

    public void setVar2(int intVar2) {
        this.mVar2 = intVar2;
    }

    public String getVar3() {
        return mVar3;
    }

    public void setVar3(String strVar3) {
        this.mVar3 = strVar3;
    }

    public String getVar4() {
        return mVar4;
    }

    public void setVar4(String strVar4) {
        this.mVar4 = strVar4;
    }

    public static final Parcelable.Creator<MyClass2> CREATOR = new Parcelable.Creator<MyClass2>()
    {
        public MyClass2 createFromParcel(Parcel in) {
            return new MyClass2(in);
        }

        public MyClass2[] newArray (int size) {
            return new MyClass2[size];
        }
    };

    public int describeContents() {
        return 0;
    }

    public void writeToParcel (Parcel dest, int flags) {
        dest.writeInt(mVar1);
        dest.writeInt(mVar2);
        dest.writeString(mVar3);
        dest.writeString(mVar4);
    }
} 
```

我已经梳理过了，看不到任何东西，这意味着这可能是我没有注意到的非常愚蠢的事情。

想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T21:39:22.387

```
04-11 14:19:11.234: E/AndroidRuntime(502): Caused by: java.lang.NullPointerException
04-11 14:19:11.234: E/AndroidRuntime(502):  at android.os.Parcel.readTypedList(Parcel.java:1497) 
```

查看源代码（[Parcel.java:1497](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.1_r2/android/os/Parcel.java#1497)）：

```
public final <T> void readTypedList(List<T> list, Parcelable.Creator<T> c) {
  int M = list.size();  // line 1497
  ... ... 
```

ArrayList<MyClass2> mVar11 在调用 Parcel.readTypedList() 之前没有被正确初始化；

```
public MyClass1(Parcel in) {
  mVar1 = in.readInt();
  mVar2 = in.readInt();
  mVar3 = in.readInt();
  mVar5 = in.readLong();
  mVar6 = in.readLong();
  mVar8 = in.readString();
  mVar9 = in.readString();
  mVar10 = in.readString();
  mVar11 = new ArrayList<MyClass2>();
  in.readTypedList(mVar11, MyClass2.CREATOR);
  mVar7 = in.readString();
} 
```

这应该可以修复您的 NullPointerException 错误。

# emacs - 将 kill-line 更改为 delete-line 功能

> ID：10112871
> 
> 赞同：2
> 
> 时间：2012-04-11T19:46:57.130
> 
> 标签：emacs

标准`C-k`是 kill-line function-> delete line 并将其放入 kill-ring 中，我只想使用“delete-line”之类的东西。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:45:27.380

这可能是你想要的。将此行放入您的 .emacs 中。

```
(global-set-key "\C-k" 'delete-line) 
```

您也可以在当前会话中使用 M-: 进行尝试，然后输入它，看看这是否是您真正想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T07:25:04.337

你可以像这样定义一个`delete-line`函数：

```
(defun delete-line ()
  (interactive)
  (delete-region (point) (line-end-position))) 
```

上面的函数模仿了`kill-line`在点后剩余非空白字符的行上不带参数调用的函数的行为。如果您想要`kill-line`.

# android - ksoap2 崩溃的应用程序

> ID：10112873
> 
> 赞同：1
> 
> 时间：2012-04-11T19:47:17.423
> 
> 标签：android, ksoap2, android-ksoap2

嗨，我正在尝试从使用 ksoap2 for android 的网站读取信息，但每当我尝试我的应用程序强制关闭时。我已将站点的方法从教程更改为站点，因此该站点应该不是问题，下面是我拥有的代码。这是我的第一篇文章，如果我犯了任何错误，非常抱歉谢谢

```
public class SharepointappActivity extends Activity {

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
Button gobutton = (Button)findViewById(R.id.button1);
  gobutton.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {
        // TODO Auto-generated method stub
        boom();
    }
});

}
public void boom(){
      final TextView text1 = (TextView)findViewById(R.id.textView1);
String NAMESPACE = "http://footballpool.dataaccess.eu";
String METHOD_NAME = "StadiumInfo";
String SOAP_ACTION = "http://footballpool.dataaccess.eu/data/";
String URL = "http://footballpool.dataaccess.eu/data/info.wso?WSDL";

SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME);

Request.addProperty("sStadiumName", "Free State Stadium"); 

SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
envelope.dotNet = true;
envelope.setOutputSoapObject(Request);

HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

try
{
   androidHttpTransport.call(SOAP_ACTION, envelope);
   SoapObject response = (SoapObject)envelope.getResponse();
 int result =  Integer.parseInt(response.getProperty(0).toString());
//    Object result2 = envelope.getResponse();
 text1.setText(result);
}
  catch(Exception e)
 {
     e.printStackTrace();
 }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T20:22:59.110

您需要将“”添加到 SOAP_ACTION。

```
String.format( "\"http://yournamespace/%s\"", method ); 
```

# jquery - 如何通过 id 改进“获取”DOM 元素？

> ID：10112876
> 
> 赞同：4
> 
> 时间：2012-04-11T19:47:25.803
> 
> 标签：jquery, html, dom

有人告诉我，通过 getElementbyid 或 jQuery("#tagname") 获取元素被认为是“hack”。

争论是没有编译的，因此可能需要很长时间才能找到一个愚蠢的错字。

或者一个更好的论点：当某个元素 id 发生变化时，重构所有内容需要很长时间。

反对这种“黑客”论点的论据是什么？有没有很好的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T19:54:50.137

嗯。首先我要说`getElementById`的是一个标准的 DOM 函数。另外，我认为这比然后循环找到你想要的`getElementById`要快得多。`getElementsByClassName`也许他们指的是对 id 进行硬编码，比如如果你的脚本有很多地方说`$("#element-id")`，那么你可以用一个名为 eid 的变量替换“element-id”，并动态设置它。

当然，我必须说这不是黑客攻击，我不确定是谁认为的。考虑一个简单的例子：

```
<form id='my-form-name'>
  <input id='input-text' ... />
  ...
</form> 
```

我会说`document.forms[0]`比说更糟糕`$('#my-form-name')`。并且能够说`$('#my-form-name #input-text')`比`document.forms[0].children[0]`或任何它会更好。

最后，您可以随时执行以下操作：

```
var $someElement = $('#el-id'); 
```

这样，您只需将 id 硬编码在一个地方，并且“重构”您的代码涉及更改一个字符串......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:50:52.317

除非您个人对此有问题，否则我不会担心。

每个人都使用 ID 来识别元素。在查找 ID 时，编写代码和执行都很快。如果您担心拼写错误/重构，您可以始终将元素存储在一个对象中并在整个脚本中使用它：

```
var tagname = $("#tagname"); 
```

但实际上，我不会担心它。如果您要重命名它们，您总是可以使用自动搜索和替换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T20:04:09.513

> 我被告知通过 getElementbyid [sic] 或 jQuery("#tagname") 获取元素被认为是“hack”。

谁告诉你那是错的。`getElementById`不是“黑客”，它是内置的 JavaScript 函数。这是您通过 ID 获取元素的方式。在内部，jQuery 将在执行`jQuery("#tagname")`. 原生 DOM 函数比 jQuery 内置的 CSS 引擎 (sizzle) 快得多，通过 ID 获取元素是获取元素的*最快**方式*。

> 争论是没有编译的，因此可能需要很长时间才能找到一个愚蠢的错字。

我完全不明白这个论点。编译与否，如果你在一个地方改变了一些东西，你将不得不在其他地方改变它。考虑这个 PHP 代码：

```
<?php
$name = "Joe";

echo $name; 
```

如果我决定更改`$name`为`$customerName`怎么办？现在，我将不得不在我的代码中找出一个“愚蠢的错字”。

> 或者一个更好的论点：当某个元素 id 发生变化时，重构所有内容需要很长时间。

事实上，这是一个更好的论点。您可以进行一次 DOM 查找，然后在其他地方使用该变量。例如：

```
var $content = $('#content');

$content.attr('rel', 'test'); // Use $content to edit the element 
```

因此，如果 ID 更改，您可以更改`$('#content')`为其他内容，它会起作用。

# mmap - mmap地址提示的合理有效起始地址，以保证一切正常

> ID：10112877
> 
> 赞同：1
> 
> 时间：2012-04-11T19:47:27.203
> 
> 标签：mmap, virtual-address-space

在我们的一项任务中，我们需要在两台机器之间构建一个分布式共享内存，我使用了一种基于分页的技术，这样两台机器上的基地址都不同。但是有这个链表测试用例几乎要求两个地址范围相同。mmap 使用 MAP_FIXED 的固定地址会导致从机崩溃（因为回复服务器线程的堆栈被覆盖），我认为在两个进程的初始化期间创建一个保证在开始时免费的地址是合理的。但是，经过数小时的网络搜索后，我仍然很不幸地找到了该默认地址。我们的要求是 10000 页。如果有人可以指出 sbrk 保证不会增长的堆地址基址，我可以使用它。

最好的，Subramanian

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T22:37:34.147

我认为没有人能够保证任何地址将始终有效。虚拟地址的选择总是由内核决定，并且`MAP_FIXED`总是会踩到它的脚趾。

我可以建议不要使用`-m32`来编译您的应用程序吗？有了这么多可用地址，如果您选择随机地址，发生冲突的可能性将降低 4294967296 倍。

我会建议以下黑客之一：

*   由于您在 Linux 上，请阅读并解析`/proc/self/maps`. 找到任意两个映射之间的最大间隙，并在该间隙的中点选择一个地址。万一之前的映射向上爬行或下一个映射在后续运行中向下爬行，您应该是相当安全的。将此地址传达给其他进程，以便它可以尝试在同一地址进行映射。希望其他进程的内存映射足够相似，并且在同一个地方或多或少会有这么大的差距。
*   临时分配大量匿名内存而不使用`MAP_FIXED`. 对于您的固定映射，请尝试紧跟此映射的地址。将此地址传达给其他进程，以便它可以尝试在同一地址进行映射，然后摆脱临时映射。希望另一个进程的内存映射足够相似，并且您在选择的地址之前为自己留下了大量的备用地址，这样如果第二个进程占用了其中的一些地址，您仍然可以。

请记住，这些都是黑客行为。

# perl - 发送已编辑错误时的 bugzilla 邮件格式

> ID：10112880
> 
> 赞同：4
> 
> 时间：2012-04-11T19:47:46.597
> 
> 标签：perl, bugzilla

我正在处理一些与邮件格式相关的事情。我们最后安装了 bugzilla。问题是当我们尝试编辑错误详细信息并提交相同的邮件格式时，在 Outlook 上发送给用户的邮件格式非常混乱。

任何人都可以提供任何提示我们可以尝试更改邮件格式的文件吗

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T23:32:01.863

对于 Bugzilla 4.2+，您需要查看 \template\en\default\email\bugmail*.tmpl 文件

对于以前的版本，请查看 \template\en\default\email\newchangedmail.txt.tmpl

在所有情况下，Bugzilla 都使用[http://www.template-toolkit.org/](http://www.template-toolkit.org/)作为模板引擎。

另见：[http ://www.bugzilla.org/docs/4.2/en/html/cust-templates.html](http://www.bugzilla.org/docs/4.2/en/html/cust-templates.html)

# mongodb - 会发生什么，当 mongodb db size 是 times > then RAM 时会发生什么？

> ID：10112881
> 
> 赞同：14
> 
> 时间：2012-04-11T19:47:53.593
> 
> 标签：mongodb, memory, memory-management, ram

会变慢吗？只会为适合 RAM 的数据找到工作吗？如果 mongodb 索引大于 RAM，会发生什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-12T21:44:58.563

编辑：此答案不再适用（MongoDB 有一个不以这种方式运行的新存储引擎），答案非常陈旧，并且不推荐使用 mmapv1 存储引擎。

**关于蒙哥**

MongoDB 使用内存映射文件。

这意味着操作系统本质上控制着什么在内存中调入和调出（进出磁盘）。

**规则**

如果您的索引 + 工作集超出内存，则最近使用的页面（内存部分）将被刷新到磁盘。这只留下了最近使用的数据，这些数据仍然适合内存，随时可用。

您的操作系统对此进行控制。

如果您的真实工作集和索引不适合内存，您将体验到糟糕的性能，但实际上，一个工作集（热数据）的大小远小于其总数据集。

如果您不违反此规则，即使您的索引 + 总数据可能超过总可用内存，您也应该在大多数情况下拥有出色的性能。

**这个怎么运作**

如果执行的查询需要不在内存中的数据，它将被分页到内存中（从磁盘中检索），并且会影响性​​能。

*注意：这本质上是数据库首次启动（冷）时的情况。*

开始时内存中没有任何内容，需要数据时会发生页面错误，并根据需要将数据分页到内存中。当内存不足时，最近使用的页面（块）将从内存中刷新，以支持更热（最近访问）的数据。

另外值得一提的是，由于索引经常使用，因此总是最近使用，它们实际上永远不会被分页。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-13T02:37:36.213

如果您的索引大于可用 RAM，则性能会***迅速***下降。MongoDB 站点特别建议您“确保您的索引可以放入 RAM”。

> 如果您的查询看起来很缓慢，您应该验证您的索引是否足够小以适合 RAM。例如，如果您在 4GB RAM 上运行并且有 3GB 索引，那么您的索引可能不适合 RAM。您可能需要添加 RAM 和/或验证您创建的所有索引是否都在实际使用中。

# google-chrome - 是否可以在控制台中手动挂钩 Chrome DOM 断点事件？

> ID：10112885
> 
> 赞同：0
> 
> 时间：2012-04-11T19:48:09.167
> 
> 标签：google-chrome, google-chrome-devtools

目前，您可以在元素检查器窗口中右键单击 DOM 元素，然后选择“子树修改时中断”。断点很有用，但我也想收集一些实时统计数据，并希望从 JS 控制台中挂钩事件，即触发我的回调函数而不是实际中断执行。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:50:37.563

绑定事件如下：

```
// DOMNodeInserted may be more interesting
document.addEventListener('DOMSubtreeModified', function(event) {
    console.log(event.target);  // Logs the element
}); 
```

记录的元素是“活动的”，因此在记录时它不会显示该元素。对于该`DOMNodeInserted`事件，使用以下内容可能很有用：`console.log(event.target.outerHTML);`

# php - 使用 PropelORM 在 toArray() 调用中包含虚拟列

> ID：10112895
> 
> 赞同：0
> 
> 时间：2012-04-11T19:49:00.993
> 
> 标签：php, orm, propel

在从带有来自连接的虚拟列的查询中检索到的 PropelORM 对象中，有没有办法/方法在 toArray() 调用中包含虚拟列？

例如：

```
$book = BookQuery::create()
  ->join('Book.Author')
  ->with('Author')
  ->where('Author.Name = ?', 'Jane Austen')
  ->findOne();

$aBook = $book->toArray(); 
```

在上面的代码中，我希望在 toArray() 调用中生成的数组也包含来自 Authors 表的字段，而不仅仅是 Books 表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T21:31:02.987

如果查看*toArray()*方法定义，您会发现它接受*$includeForeignObjects*参数。我认为这或多或少是您正在寻找的。

```
$book = BookQuery::create()
  ->join('Book.Author')
  ->with('Author')
  ->where('Author.Name = ?', 'Jane Austen')
  ->findOne();

$aBook = $book->toArray($keyType = BasePeer::TYPE_PHPNAME, $includeLazyLoadColumns = true, $alreadyDumpedObjects = array(), $includeForeignObjects = true); 
```

参数列表并不漂亮，但它应该可以工作。

# c# - C# 图像在转换为 bin 期间丢失

> ID：10112896
> 
> 赞同：0
> 
> 时间：2012-04-11T19:49:06.463
> 
> 标签：c#, image

所以，我有以下脚本将图像转换为二进制文件（所以我可以把它放在一个 blob 上）：

```
public static byte[] ImagemBin(string imagePath, int imagem_comp)
    {

        FileStream fileStream = new FileStream(imagePath, FileMode.Open, FileAccess.Read);
        byte[] buffer = new byte[imagem_comp];

        int numBytesToRead = imagem_comp;
        int numBytesRead = 0;
        while (numBytesToRead > 0)
        {
            // Read may return anything from 0 to numBytesToRead.
            int n = fileStream.Read(buffer, numBytesRead, numBytesToRead);

            // Break when the end of the file is reached.
            if (n == 0)
                break;

            numBytesRead += n;
            numBytesToRead -= n;
        }
        numBytesToRead = buffer.Length;

       fileStream.Read(buffer, 0, numBytesToRead);

        fileStream.Close();
        return buffer;
    } 
```

其中imagePath是图片在电脑中的位置，imagem_comp是图片的大小。但是，图像转换不完整，几个字节后，它返回唯一的0...

那么，对此有什么帮助吗？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:58:26.860

你应该解释你想要完成的事情。`imagem_comp`应该是什么？我发现您的逻辑有以下错误。

1.  您在每次迭代中覆盖缓冲区而不用它做任何事情。
2.  您从这一行要读取的字节数中减去读取的字节数`numBytesToRead -= n;`。一次读取后，您将只要求读取 0 个字节。
3.  您使用与循环外第一次迭代基本相同的数据再次覆盖缓冲区。
4.  假设上述所有内容都已修复，如果文件包含的字节数多于`imagem_comp`.

正如上面评论中的@bmm6o 所述，您应该可以将其替换为[File.ReadAllBytes](http://msdn.microsoft.com/en-us/library/system.io.file.readallbytes.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:08:41.977

它似乎适用于这个版本：

```
public static byte[] ImagemBin(string imagePath, int imagem_comp)
{

    FileStream fileStream = new FileStream(imagePath, FileMode.Open, FileAccess.Read);
    byte[] buffer = new byte[imagem_comp];

    int numBytesToRead = imagem_comp;
    int numBytesRead = 0;
    while (numBytesToRead > 0)
    {
        // Read may return anything from 0 to numBytesToRead.
        int n = fileStream.Read(buffer, numBytesRead, numBytesToRead);

        // Break when the end of the file is reached.
        if (n == 0)
            break;

        numBytesRead += n;
        numBytesToRead -= n;
    }

    fileStream.Close();
    return buffer;
} 
```

即删除行：

```
numBytesToRead = buffer.Length; 
```

和

```
fileStream.Read(buffer, 0, numBytesToRead); 
```

也就是说，我同意其他人提到的；考虑使用 ReadAllBytes。:-)

# javascript - 如何将动态 ID 传递给 JQuery 中的函数

> ID：10112907
> 
> 赞同：1
> 
> 时间：2012-04-11T19:49:53.567
> 
> 标签：javascript, jquery, asp.net

更新：

在我的代码隐藏代码中，我有这样的公共变量和 assing

```
public string Id { get { return Request.QueryString["id"].ToString(); } }` 
```

在 .aspx 页面中我试图访问

```
$(this).attr("EmployeeId", Id); 
```

得到错误名称

```
'Id' does not exist in the current context 
```

**结束更新**

我有两个 aspx 页面：

```
1) employee.aspx
2) employee_detail.aspx 
```

如何将动态 id 从一个页面传递到另一个页面

以下代码在`employee.aspx`页面中

```
//more code here..
//but to relvant to my question is here...

var submitButton = function()  {             
  //more code here...         
  if(employeeId != ""){   //redirecting here...
    window.location.href = "employee_detail.aspx"; 
 }    
} 
```

所以在`employee_detail.aspx`页面中我有一个 jquery 函数，目前我正在对 id 进行硬编码，如下所示：

```
<script type="text/javascript"> 

$(document).ready(function () { 

 var id = 'A42345'; //hardcoded.... 

$(this).attr("EmployeeId", id);  

</script> 
```

所以我的问题是，我正在寻找一种方法来传递`employee.aspx`和接收id`employee_detail.aspx`

我想过这样做，但出于安全原因，我不想在 url 中公开 id：

```
window.location.href = "mypage.aspx?id = " + id; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T21:26:52.987

我过去喜欢使用的一个选项是向正在加载的页面提交表单。该表单有一个隐藏字段，其中包含 javascript 想要传递给页面的 JSON 数据。然后，服务器查找 JSON 数据，对其进行解析并使用它包含的值。

这有点类似于 ASP 的视图状态和/或会话，但无需打开视图状态或会话即可工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:52:14.613

好吧，如果您只是想传递一个变量，cookie 就可以完成这项工作。显然，这不是一种安全的数据存储方式，而是为普通用户提供了一个不可见的层。

[https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

这个插件非常小而且简单...

在第一页设置 cookie：

```
$.cookie('the_cookie', 'the_value'); 
```

或者

```
$.cookie('the_cookie', 'the_value', { expires: 7 }); 
```

并在下一页上获取值：

```
$.cookie('the_cookie'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:52:52.113

您应该认真考虑实现会话并将用户 ID 存储在会话变量中，而不是像这样手动传递它。阅读：http: [//msdn.microsoft.com/en-us/library/ms178581.aspx](http://msdn.microsoft.com/en-us/library/ms178581.aspx)

但如果您坚持，您可以使用 jQuery 将数据 POST 到第二页，而不是使用 GET，然后在服务器 (ASP) 端将 POST 变量值回显到 Javascript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T19:52:58.427

你可以在javascript中组合你的动态代码（顺序应该是这样的）请注意我使用的是ASP经典。

```
<% 
Dim ID
ID = Request.QueryString("id") 'Or any other request
%>

<script type="text/javascript"> 
var id = '<%=id%>'//OR any dynamic request
$(this).attr("EmployeeId", id); 
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T19:54:21.947

试试这个方法：

```
$.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            url: "employee_detail.aspx",
            dataType: "json",
            data: { id: 1 }, // or the string: 'id=1'
            complete:
            function () {
                window.location = "employee_detail.aspx";
            }

    }); 
```

来自[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-11T20:02:50.193

您可以在服务器代码中将 ajax 与 webmethod 一起使用。在 web 方法中，您可以使用 HttpContext.Current 访问 Sessions

```
$.ajax({
    type: "POST",
    url: "mypage.aspx/ServerMethodName",    
    data: '{"id":"' + $("#divID").text() + '"}',        
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (returnValueFromServerMethod) {
        if(returnValueFromServerMethod.d != "")
            //do something great

    }
});

[WebMethod]
public static string ServerMethodName(string id)
{
    HttpContext.Current.Session["ID"] = id;            
} 
```

您需要在 page.aspx 中添加一个以启用页面方法。

```
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true">                    
</asp:ScriptManager> 
```

您可以将页面方法的内容替换为更清洁的服务 .svc。

# php - PHP数据无限加载，jquery，phonegap

> ID：10112908
> 
> 赞同：0
> 
> 时间：2012-04-11T19:49:58.627
> 
> 标签：php, jquery, ajax, cordova

我正在开发一个带有 phonegap 和 jQuery mobile 的 iOS 应用程序。

当我向仅包含一个简单的 1 到 10 计数器（并回显这些数字）的 PHP 文件发出 AJAX 请求时，一切都很好，并在应用程序启动时显示出来。

但是，当我请求一个稍微复杂一点的 PHP 文件时，应用程序正在加载、加载和加载，但没有任何反应。

这是PHP文件

```
<?php           
    include 'connect.php';

    $data = mysql_query('SELECT * FROM pics ORDER BY `date` DESC') or die(mysql_error()); 

    while($info = mysql_fetch_array( $data )) 
    {
        <div id='thumbwrapper'>";
        Echo "<img src=../images/".$info['thumb']." class='thumb'></a>";
        Echo "</div></a>";
    }
?> 
```

这是ajax请求

```
<script typ="text/javascript">
    $(document).ready(function(){
        $("#randomdiv").load("http://localhost/test.php");
    });
</script>

<div id="randomdiv"></div> 
```

PS：是的，我在 cordova.plist 的 ExternalHosts 中添加了“*”

编辑1：我想我知道问题出在哪里。今天我想让我通过另一个浏览器（firefox）显示 test.php 文件，这个浏览器在向我显示 php 文件之前要求我输入用户名和密码。

也许应用程序正在加载和加载和加载，因为没有人输入用户名和密码。我的问题是，我在哪里可以解释用户名和密码是什么？！（在应用程序中）。或者我在哪里可以在 xampp 中关闭这个东西？（用户名（xampp）和密码（空）是标准的东西）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:39:30.440

好的，谢谢你的帮助。问题是 xampp 文件夹中的一个文件夹（php 文件所在的位置）需要用户名和密码（也可以通过浏览器）。我不明白如何解释用户名和密码的 jquery 语法，所以我将 php 文件复制到 xampp 文件夹中的另一个文件夹。现在一切正常（不需要用户名和密码）。顺便说一句，我也不明白为什么我只需要一个文件夹的用户名和密码。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:00:03.213

代替

```
while($info = mysql_fetch_array( $data )) 
{
    <div id='thumbwrapper'>";
    Echo "<img src=../images/".$info['thumb']." class='thumb'></a>";
    Echo "</div></a>";
} 
```

和

```
while($info = mysql_fetch_array( $data )) 
{
    echo '<div id="thumbwrapper">';
    echo '<img src="../images/'.$info['thumb'].' class="thumb">';
    echo '</div>';
} 
```

和

```
<script typ="text/javascript"> 
```

和

```
<script type="text/javascript"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:44:06.957

尝试给出这样的路径

```
$('#result').load('ajax/test.html'); 
```

而不是 loaclhost .. 因为它是在浏览器中工作的。

# java - 是否应该始终在 EDT 中启动 JFrame

> ID：10112913
> 
> 赞同：3
> 
> 时间：2012-04-11T19:50:20.760
> 
> 标签：java, swing, event-dispatch-thread

我的摇摆应用程序有一个带有服务器按钮的主窗口。这个 JFrame 在 EDT 中启动...

```
 EventQueue.invokeLater(new Runnable() {
        public void run() {
            JFrame server = new JFrame();
            server.setVisible(true);
            server.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

                            //Do other stuff here
        }
    }); 
```

每个按钮都可以启动一个单独的 JFrame。

我不确定是否必须启动一个新的 EDT 线程来启动每个新窗口？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T19:56:41.180

通常，当您在按钮处理程序（即动作侦听器）中时，调用它的是 EDT。您可以使用 SwingUtilities.isEventDispatchThread 进行检查

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T19:56:48.110

没有问题 - 每个动作处理程序都在`EDT`. 所以如果你`JFrame`从这样的地方打开新的就没有问题了。

如果你在不同的线程中做一些工作（例如计算），那很好，但所有涉及 UI 的工作都必须在`EDT`. 这就是为什么我们有`SwingWorker`和`invokeLater`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T20:00:02.787

我的答案是

*   是的，所有更改、更新修改等都应该在[EventDispathThread上完成](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)

*   是的，用于创建新容器应该在[InitialThread中创建](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)

但

*   不是，你可以先准备好`JFrame`它的内容，但是`EDT`有两个最重要的方法，

    1.  `JFrame#pack() // finalize & calculate used LayoutManager`

    2.  `JFrame#setVisible(true) // display Container on the screen`

*   `Each button can launch a separate JFrame.`不要那样做，使用[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)代替，在视图之间切换，如果你需要弹出窗口，那么只创建一个 JFrame 而另一个容器可能只是[JDialog](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)

# php - PHP 3s 回合

> ID：10112914
> 
> 赞同：0
> 
> 时间：2012-04-11T19:50:23.810
> 
> 标签：php, rounding

我正在通过 php 获得时间

```
$current_hour = date("G"); 
```

现在假设`$current_hour`等于 20。我如何将其四舍五入为 19？或者如果`$current_hour`等于 00，我将如何将其四舍五入为 22？我不知道我是否解释得很好，但基本上我想以 3 的间隔向下舍入每个数字，所以我得到以下信息：

```
1
4
7
10
13
16
19
22
[back to begining] 
```

两者之间的任何数字都应该四舍五入到其中的最小值，因此 11 将是 10，15 将是 13，依此类推......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:54:50.500

简单的方法是使用整数运算。首先除以 3，然后转换为 int，然后再次乘以 3，并进行一些移位以保留所需的序列。

例子：

```
$current_hour = 20;
echo (intval(($current_hour + 23) / 3) * 3 + 1) % 24; // Outputs 19 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:55:33.730

```
$round = intval(($current_hour - 1) / 3) * 3 + 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T19:57:19.157

```
$round = (intval(($currentHour + 24) / 3) * 3) % 24 + 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T19:59:33.150

我想这是：

```
($current_hour - ($current_hour % 3)) + 1 
```

# iphone - NSMutableArray replaceObjectAtIndex：withObject：不工作

> ID：10112918
> 
> 赞同：1
> 
> 时间：2012-04-11T19:50:51.563
> 
> 标签：iphone, objective-c, ios, arrays, nsmutablearray

我有一个可变数组，最初我在使用范围时遇到了问题。我得到了一些关于如何解决这个问题的建议（这很有效），但现在数组不会替换给定索引处的对象。

这是代码：

.h 文件：

```
@interface myViewController: UIViewController {
  NSMutableArray *myArray;
} 
```

.m 文件：

```
-(id)init {
  self = [super init];
  if (self){
    myArray = [[NSMutableArray alloc] init];
  }
  return self;
}

-(void)viewDidLoad {
  for (int x=0; x<6; x++) {
    [myArray addObject:[NSNumber numberWithInt:0]]; //This adds the numbers just fine
  }
  [myArray insertObject:[NSNumber numberWithInt:1] atIndex:0]; //This does not insert the number 1 into index 0
} 
```

我尝试了其他插入方式，例如：

```
replaceObjectAtIndex: withObject 
```

还有一些其他的，但没有一个起作用....

我将不胜感激任何帮助，因为这是我和完成我的第一个应用程序之间唯一的事情。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:25:32.703

首先，类名应该大写。我说“第一”是因为这表明你没有遵循约定，如果不是完全错误的话，可能会导致理解上的问题。

其次，您确定该`init`方法正在被调用吗？如果您的对象是由接口文件加载实例化的，那么它可能不是并且数组可能为零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:44:26.077

`UIViewController`为is指定的初始值设定项`-initWithNibName:bundle:`。您应该覆盖它而不是`-init`. 你`-init`没有被调用，所以你从来没有分配任何东西给`myArray`; 它仍然存在`nil`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T22:02:45.970

确保您之前调用了当前视图方法的 addSubview。

```
YouViewNewController *youViewNewController=[[YouViewNewController alloc]init];

[self.view addSubview:youViewNewController.view]; // Calls viewDidLoad. 
```

这项工作对我来说，

```
-(id)init {
self = [super init];
if (self){
    myArray = [[NSMutableArray alloc] init];
    NSLog(@"Lancement...");
}
return self; 
```

}

```
-(void)viewDidLoad 
{
   NSLog(@"Calcul...");

   for (int x=0; x<6; x++) 
    {
          [myArray addObject:[NSNumber numberWithInt:0]]; //This adds the numbers just fine
    }
    [myArray insertObject:[NSNumber numberWithInt:1] atIndex:0]; //This does not insert the number 1 into index 0

    NSLog(@"%i", [[myArray objectAtIndex:0]intValue]);
} 
```

有用 ！

# php - 使用 JavaScript（或 AJAX？）动态添加 PHP/MySQL 代码

> ID：10112922
> 
> 赞同：1
> 
> 时间：2012-04-11T19:51:06.690
> 
> 标签：php, javascript, mysql, ajax

我不得不问这个问题，因为我被卡住了，我认为这是因为我对 PHP 和 JavaScript 的理解还没有完全形成。我认为我开始尝试这样做的方式可能非常非常错误，但没有其他人的问题对我有意义。

Basicaly：我正在尝试在表单上添加一个 JavaScript 按钮，该按钮将添加额外的表单输入框，同时在 PHP 中添加额外的 SQL 代码，用于将新表单中的数据插入到我的数据库中。

我的 JavaScript 看起来像这样..

```
 function addElement2() {

var ni = document.getElementById('SQLphoneDiv'); 
    var numi = document.getElementById('theValue2'); 
    var num = (document.getElementById('theValue2').value -1 + 2); 
    numi.value = num; 
    var newdiv = document.createElement('div'); 
    var divIdName = 'SQLphoneDiv'+num+''; 
    newdiv.setAttribute('id',divIdName); 
    newdiv.innerHTML = ' <input type=hidden id=' +num+ ' value=' +num+ '> <?php      $insert_phone = "INSERT INTO phone (Phone_Cust_ID,Phone_Numb,Ext) VALUES    (\'$cust_ID[0]\',\'".$_POST[\'phone' +num+ '\']."\',\'".$_POST[\'ext' +num+ '\']."\')";    $add_phone = mysql_query($insert_phone); ?>'; 
    ni.appendChild(newdiv); 
    } 
```

“newdiv.innerHTML”是所有代码所在的位置，当我的 JavaScript 运行时，它会将其发送到我的 PHP 页面上的 DIV。

```
 <?php
    if (isset($_POST['submit'])) { 

         //add aditional phone numbers

         echo    '<input type="hidden"  value="0" id="theValue2" />';
         echo    '<div id="SQLphoneDiv"></div>';
     ?> 
```

我发现将回显部分放在“if”部分之外会使代码在我点击添加按钮时实际显示出来（至少显示了 DIV，当然它在 Dreamweaver 上的实时模式下没有显示 PHP）。

所以无论如何，如果我明白我刚刚弄清楚这是完全错误的，因为 PHP 是在页面运行后设置的，所以在事后尝试添加更多代码是没有意义的。我想对了吗？你会怎么做呢？AJAX 的东西？

非常感谢任何提示。

弥敦道

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:55:46.087

PHP 在页面发送到客户端之前在服务器上运行。JavaScript 在客户端上运行。AJAX 将是要走的路。

# java - 响应来自 Java Socket 的 AJAX 请求

> ID：10112926
> 
> 赞同：1
> 
> 时间：2012-04-11T19:51:31.247
> 
> 标签：java, javascript, ajax, sockets, xmlhttprequest

我试图让一个简单的 java 服务器响应 XmlHttpRequest，但我不确定如何。至此，服务器上的socket得到了浏览器的请求。获得套接字输出流后，服务器对其进行写入，然后关闭所有连接。还有更多的东西吗？我假设您需要一个标头来正确响应请求，如果是这样，该标头是什么。谢谢！

这就是我现在正在做的事情。但是，我似乎无法让浏览器接受该消息。

编辑：Java 服务器代码：

```
private String HEADER = "HTTP/1.1 200 OK\n" +
"Cache-Control: private\n" +
"Content-Type: text/html; charset=utf-8\n" +
"Expires: Sun, 21 Feb 2100 20:39:08 GMT\n" +
"Server: Microsoft-IIS/7.5\n" +
"Date: Sun, 21 Apr 2012 20:39:07 GMT\n" +
"Connection: close\n" +
"Content-Length: 10\n";

         browserWriter =
                new PrintWriter(
                        browser.getOutputStream(),true);

            while((data = browserReader.readLine()) != null) {
                if (data.indexOf("POST") != -1) {

                    /* TODO TEST - TAKE OUT */
                    browserWriter.println(HEADER + "APPLESAUSE");
                    browserWriter.close();
                    browserReader.close();
                    browser.close();
                    return; 
```

Javascript：

```
 xmlhttp.open("POST","http://10.0.2.15:1024/password?url=" + site, false);
  xmlhttp.send(null); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T19:53:40.327

所有 XmlHTTPRequest 都需要 HTTP 响应，因此需要 HTTP 标头。一旦给出响应，就可以关闭连接。这基本上只是充当 Web 服务器。

一些 HTTP 标头字段：[http ://en.wikipedia.org/wiki/List_of_HTTP_header_fields](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields)

有关官方规范，请参见此处：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec14.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)

这里有一个不错的教程：http: [//net.tutsplus.com/tutorials/other/http-headers-for-dummies/](http://net.tutsplus.com/tutorials/other/http-headers-for-dummies/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:06:53.207

为了让浏览器理解服务器的响应，它应该根据[HTTP 协议](http://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html)`Response`中指定的格式有效。除了实际的响应正文之外，唯一需要的是状态行，通常是在请求成功的情况下。`HTTP/1.1 200 OK`

额外的[HTTP 标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14)，例如`Content-Length`or`Content-Type`可以帮助浏览器更有效地处理响应，但是如果您开始设置很多这些，您基本上是在实现自己的 HTTP 服务器，我建议在使用[Jetty](http://www.eclipse.org/jetty/)或其他现成的东西之前使用它路线。

# javascript - 在流星中设置简单事件

> ID：10112930
> 
> 赞同：9
> 
> 时间：2012-04-11T19:51:55.690
> 
> 标签：javascript, meteor

我在 Meteor 中尝试排行榜的示例，但我在设置点击事件时做错了。在此示例中，我有三个按钮，一个用于更改按列排序，另一个用于为每个人添加 5 个奖励积分。

这是html：

```
 <div id="outer">
    {{> sorter}}
    {{> leaderboard}}
  </div>
   <template name="sorter">
   <span>Sorted by {{sortedBy}}</span>
   {{#if sortByName}}
    <input type="button" id="sortScore" value="sort by score" />
  {{else}}
    <input type="button" id="sortName" value="sort by name" />
  {{/if}}

    <input type="button" class="incAll" value="5 bonus points to all" />

</template> 
```

这是js：

```
Template.sorter.events = {
'click #sortName': function(){
    Session.set('orderby', 'name');
},
'click #sortScore': function(){
    Session.set('orderby', 'score');
},
'click input.incAll': function(){
  Players.find().forEach(function(player){
      Players.update(player._id, {$inc: {score: 5}});
  });
} 
```

}

调用 Session.set('orderby', 'name'); 在控制台中工作并相应地更新 html，但单击按钮不会。那么我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-11T20:08:34.457

带有选择器的事件映射不会匹配模板中的顶级元素。这是我们将尽快解决的问题。

不过有一个简单的解决方法。将排序器模板包装在`<div>`.

[http://docs.meteor.com/#eventmaps](http://docs.meteor.com/#eventmaps)

# iis - 带有参数的 url 的 IIS URL 重写 301 重定向不起作用

> ID：10112933
> 
> 赞同：0
> 
> 时间：2012-04-11T19:52:17.633
> 
> 标签：iis, parameters, query-string, url-rewrite-module

我对 301 重定向有以下规则：

```
<rule name="301RedirectsRule" enabled="true" stopProcessing="true">
  <match url=".*" />
    <conditions logicalGrouping="MatchAll">
       <add input="{301Redirects:{URL}}" pattern="(.+)" />
    </conditions>
    <action type="Redirect" url="{C:1}" redirectType="Permanent" />
</rule> 
```

在重写映射中有规则：

```
<add key="/di/web/home/Glossary/index.aspx" value="/resources/dental-terminology" />
<add key="/di/web/knowledge-base/article.aspx?id=62" value="/resources/oral-pathology/oral-conditions-and-diseases/periodontal-disease" /> 
```

第一个完美运行，但任何带有参数的 URL（如第二个）都不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:09:20.167

我并不完全了解 IIS 重写模块，但您可以尝试`{301Redirects:{URL}}`用`{301Redirects:{REQUEST_URI}}`.

我相信第一个不包含查询字符串。

# swig - 使用 SWIG %native 函数返回 java.lang.Object

> ID：10112934
> 
> 赞同：1
> 
> 时间：2012-04-11T19:52:31.193
> 
> 标签：swig

我声明了一个内联本机 JNI 函数 getId。我不确定如何在下面的 %native 片段中告诉 SWIG 如何只返回 java.lang.Object。我现在有待定。我相信类型映射是正确的方法，但我不确定如何使用 %native 函数为原生 JNI 方法声明它。有任何想法吗？

```
%module Sample
%{
JNIEXPORT jobject JNICALL Java_com_test_SampleJNI_getID(JNIEnv *env, jclass cls) 
{
    jmethodID cnstrctr;
    jvalue args[2];
    jobject obj;
    jbyteArray bArray;

    bArray = (*env)->NewByteArray(env, 32);

   (*env)->SetByteArrayRegion(env, bArray, 0, 32, (jbyte *)foo);

   cls = (*env)->FindClass(env, "com/test/jni/DeviceId");
   cnstrctr = (*env)->GetMethodID(env, cls, "<init>", "(ILjava/lang/String;[B)V");

   args[0].i = (*env)->NewStringUTF(env, "id");
   args[1].i = bArray;

   obj = (*env)->NewObjectA(env, cls, cnstrctr, args);

   return obj;
}
%}
%native(getID) TBD getID(); 
```

**设备ID.java：**

```
package com.test.jni;

public class DeviceId {
    private String id;
    private byte[] cache;

    public DeviceId(String id, byte[] cache){
        this.id=id;
        this.cache=cache;
    }

    public byte[] getCache() {
        return cache;
    }

    public void setCache(byte[] cache) {
        this.cache = cache;
    }

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:23:15.877

您可以将类型映射（例如最有可能的 jtype 和 jstype）与 一起使用`%native`，但您也可以简单地说`jobject`如果您有一个`Object`被返回并为您处理它，例如：

```
%module Sample
%{
JNIEXPORT jobject JNICALL Java_com_test_SampleJNI_getID(JNIEnv *env, jclass cls) 
{
  jclass c = (*jenv)->FindClass(env, "java/lang/Object");
  jmethodID m = (*jenv)->GetMethodID(env, c, "<init>", "()V");
  return (*env)->NewObject(env, c, m);
}
%}
%native(getID) jobject getID(); 
```

如果您想返回其他内容（例如 java.lang.Integer），您可以执行以下操作：

```
%module Sample
%{
JNIEXPORT jobject JNICALL Java_com_test_SampleJNI_getID(JNIEnv *env, jclass cls) 
{
  jclass c = (*jenv)->FindClass(env, "java/lang/Integer");
  jmethodID m = (*jenv)->GetMethodID(env, c, "<init>", "()V");
  return (*env)->NewObject(env, c, m);
}
%}

%typemap(jstype) int getID "Integer"
%typemap(jtype) int getID "Integer"
%native(getID) int getID(); 
```

我在该类型映射中明确指定了 getID 以避免将其应用于所有`int`s。

（我测试了 SWIG 部分正在生成合理的代码，但我没有验证 JNI，它显然需要检查返回值）

* * *

对于您的具体示例，您可以执行以下操作：

```
%typemap(jstype) DeviceID getID "com.test.jni.DeviceId"
%typemap(jtype) DeviceID getID "com.test.jni.DeviceId"
%typemap(javaout) DeviceID getID { return $jnicall; }
%native(getID) DeviceID getID(); 
```

即，您可以写出任何尚未用于其他用途的名称，只需应用类型映射即可。

但是最好使用`jobject`返回类型，因为你可以写：

```
%typemap(jstype) jobject getID "com.test.jni.DeviceId"
%typemap(jtype) jobject getID "com.test.jni.DeviceId"
%native(getID) jobject getID(); 
```

# algorithm - 如何计算平面分布的重心？

> ID：10112935
> 
> 赞同：0
> 
> 时间：2012-04-11T19:52:32.907
> 
> 标签：algorithm

我有一个数据集的二维分布，我想找到这些点的重心。

我想做的就像下面的代码，

```
#include <stdio.h>

#define SIZE 4

struct point {
 short x;
 short y;
};

point find_gravitation(struct point set[], unsigned char size)
{
  point ret;
  .
  .
  .
  ?
  .
  .
  .
  return ret;
}

int
main(int argc, char **argv)
{
 struct point dataset[SIZE];
 struct point ret;

 dataset[0].x = 12;
 dataset[0].y = 24;

 dataset[1].x = 3;
 dataset[1].y = 5;

 dataset[2].x = 71;
 dataset[2].y = -6;

 dataset[3].x = -185;
 dataset[3].y = -26;

 ret = find_gravitation(dataset, SIZE);

 printf("gravitation center is: %d, %d\n", ret.x, ret.y);

 return 0;
} 
```

我如何计算这个集合的重心？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T19:59:29.593

如果我正确解释这一点：

因为您的点未加权，所以中心点将是：(avg(x), avg(y))。

要计算平均 x 点，请将所有 x 值相加并除以点数。要计算平均 y 点，请将所有 y 值相加并除以点数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:09:02.757

To find the gravitation center, you need the weight as well. assuming weight to be set[i].w, your function must be modified to return the **point** structure with **x=average of all set[i].x**, **y=average of all set[i].y** and **w=sum of all set[i].w**.

# oauth-2.0 - 使用服务帐户通过 OAuth 2.0 调用 v3 Google 日历 API 时出现“需要登录”401 未经授权的消息

> ID：10112939
> 
> 赞同：19
> 
> 时间：2012-04-11T19:52:46.813
> 
> 标签：oauth-2.0, google-calendar-api, google-oauth, google-api-java-client

首先，让我解释一下我要做什么，因为这是一个两部分的问题。

我正在构建一个 JAX-RS 服务，该服务通过 OAuth2 在内部使用 Google 帐户进行身份验证，因此它可以访问和操作 Google 日历。该服务将由一个网站 (Joomla) 调用，该网站将允许登录该网站的用户在日历活动中注册他们的电子邮件地址，这样他们就可以在活动临近时收到电子邮件通知。这些用户不知道底层的 Google 帐户。

所以我的第一个问题是，使用服务帐户身份验证是否正确？查看 Google 文档，它是满足非人工身份验证的唯一用例（因此服务器到服务器身份验证）。

第二个问题是我已经编写了一些代码来执行此操作，但是当我调用日历提要的执行方法时，我得到了 401/未经授权的响应，返回了以下错误。此代码取自 Google 示例。

我正在使用 Google Calendar API 的 v3-rev3-1.5.0-beta。我已经在帐户中打开了日历 API，并创建并下载了一个私钥，该私钥在下面的代码中使用。

我在 Eclipse 中本地调用下面的代码，而不是从 Web 服务器调用。

所以我做的第一个调用是取回一个凭证对象（Id 被 X 混淆了）：

```
private static final HttpTransport HTTP_TRANSPORT = new NetHttpTransport();
private static final JsonFactory JSON_FACTORY = new JacksonFactory();
.
.
.
GoogleCredential credential = new GoogleCredential.Builder().setTransport(HTTP_TRANSPORT)
            .setJsonFactory(JSON_FACTORY)
            .setServiceAccountId("284XXXXXXXX@developer.gserviceaccount.com")
            .setServiceAccountScopes(CalendarScopes.CALENDAR)
            .setServiceAccountPrivateKeyFromP12File(new File("D:/3cd8XXXXXXXXXXXXXXXXXXXXXXXXXXXXXd635e-privatekey.p12"))
            .build(); 
```

下一步是调用 Calendar API，如下所示（中间没有调用其他代码）：

```
 Calendar calendar = Calendar.builder(HTTP_TRANSPORT, JSON_FACTORY)
        .setApplicationName("TestApp-Calendar/1.0").setHttpRequestInitializer(credential)
        .build();

 CalendarList feed = calendar.calendarList().list().execute(); 
```

调用 list().execute() 会导致以下错误：

> com.google.api.client.googleapis.json.GoogleJsonResponseException: 401 Unauthorized { "code" : 401, "errors" : [ { "domain" : "global", "location" : "Authorization", "locationType" : " header", "message" : "需要登录", "reason" : "需要" } ], "message" : "需要登录" } 在 com.google.api.client.googleapis.json.GoogleJsonResponseException.from(GoogleJsonResponseException. java:159) 在 com.google.api.client.googleapis.json.GoogleJsonResponseException.execute(GoogleJsonResponseException.java:187) 在 com.google.api.client.googleapis.services.GoogleClient.executeUnparsed(GoogleClient.java:115)在 com.google.api.client.http.json。JsonHttpRequest.executeUnparsed(JsonHttpRequest.java:112) at com.google.api.services.calendar.Calendar$CalendarList$List.execute(Calendar.java:510) at uk.org.reigatepriorybowmen.Service.registerEmailForAllCalendarEvents(Service.java: 55) 在 uk.org.reigatepriorybowmen.Service.main(Service.java:74)

服务帐户设置如下：

![在此处输入图像描述](../Images/9e6405c1f75e1fee2824137b9a9b984d.png)

那么，我做错了什么？！我花了几个小时在谷歌上搜索寻找解决方案，所以这是我最后的希望。

非常感谢您的帮助。

贾斯汀

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T05:41:36.523

至于 401，谷歌的 API 似乎有些奇怪。我发现我在一段时间内第一次运行我的应用程序，然后每隔几个小时看似随机的时间间隔，我总是得到 401。在第二轮或第三轮它实际登录。

[甚至在 Google 的 Task API 示例代码中也考虑了](http://code.google.com/p/google-api-java-client/source/browse/tasks-android-sample/src/main/java/com/google/api/services/samples/tasks/android/TasksSample.java?repo=samples)这种行为。

注意这段代码：

```
void onRequestCompleted() {
received401 = false;
}

void handleGoogleException(IOException e) {
if (e instanceof GoogleJsonResponseException) {
  GoogleJsonResponseException exception = (GoogleJsonResponseException) e;
  if (exception.getStatusCode() == 401 && !received401) {
    received401 = true;
    accountManager.invalidateAuthToken(credential.getAccessToken());
    credential.setAccessToken(null);
    SharedPreferences.Editor editor2 = settings.edit();
    editor2.remove(PREF_AUTH_TOKEN);
    editor2.commit();
    gotAccount();
    return;
  }
}
Log.e(TAG, e.getMessage(), e); 
```

}

在 Google 自己的代码示例中，他们首次提供了 401。这可能是一些需要在代码中处理的特殊安全问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:16:57.613

如果您没有在管理面板中添加 api 用户（我猜在您的情况下是文档面板），则可能会发生这种行为，例如，在谷歌分析中，您必须添加新用户，其中电子邮件地址与您从 api 获得的电子邮件地址相同（由Google API 服务帐户，创建私钥后）。在分析中，它看起来像这样：

![谷歌分析中的例子](../Images/cdc2a27c75e09dd54601354cbfeae218.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T11:14:17.417

我是一名 Android 移动应用程序开发人员。我正在使用 Google Calendar API (OAuth 2.0) 制作应用程序。我也遇到了同样的错误。但是现在，我已经解决了这个错误。我正在编写场景和解决方案。
获取特定日历的日历事件的网址（移动应用 API）：

```
https://www.googleapis.com/calendar/v3/calendars/en.indian%23holiday%40group.v.calendar.google.com/events?access_token=ya29.AHES6ZQyP3iDZM8PF-7ZqZE8oKmWAgUX55sPGPTjGbM5A 
```

在这个 url 中，我们必须添加 calendarId。网址的格式是；

```
https://www.googleapis.com/calendar/v3/calendars/<calendarId>/events 
```

在添加到 url 之前，我没有对 calendarId 进行编码。我对 calendarId 进行了编码，然后发出了 Http 请求。那时一切顺利。

```
final String accessToken=dataStore.getAccessToken();

    List<NameValuePair> params = new LinkedList<NameValuePair>();
    params.add(new BasicNameValuePair("access_token", accessToken));
    String paramString = URLEncodedUtils.format(params, "utf-8");

    final String url = String.format(AuthConstants.CALENDAR_EVENTS_URI,URLEncoder.encode(calendarId))+"?"+ paramString; 
```

现在日历事件以 JSON 格式返回。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-05T00:32:32.310

我认为您需要指定您要模拟的用户。

您现在使用 ServiceAccount 的方式仅适用于访问与您的应用程序或您的服务帐户本身相关的数据。由于您希望访问 Google 日历数据，因此您必须是有权访问您的任何域用户数据的 Google Apps 域管理员 - 如果我不正确，请告诉我。Google 日历数据属于用户，因此您需要指定您要模拟的用户。

要使用 Java 执行此操作，您似乎需要使用[GoogleCredential.Builder#setServiceAccountUser(String)](http://javadoc.google-api-java-client.googlecode.com/hg/1.8.0-beta/com/google/api/client/googleapis/auth/oauth2/GoogleCredential.Builder.html#setServiceAccountUser%28java.lang.String%29)

请试试：

```
GoogleCredential credential = new GoogleCredential.Builder().setTransport(HTTP_TRANSPORT)
        .setJsonFactory(JSON_FACTORY)
        .setServiceAccountId("284XXXXXXXX@developer.gserviceaccount.com")
        .setServiceAccountScopes(CalendarScopes.CALENDAR)
        .setServiceAccountPrivateKeyFromP12File(new File("/path/to/privatekey.p12"))
        .setServiceAccountUser("user@domain.com")
        .build(); 
```

此外，一旦您在 API 项目中创建了服务帐户密钥（从 API 控制台），您必须将此项目添加到 cPanel 中的授权第三方应用程序列表中。可以在[此处](http://support.google.com/a/bin/answer.py?hl=en&answer=162106)找到有关此的更多信息。您需要使用的“客户 ID”是绑定到服务帐户密钥的，看起来像`<APP_ID>-<OTHER_KEY>.apps.googleusercontent.com`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T13:05:19.277

好的，所以我一直在玩这个并且已经克服了 401 错误，但是我现在遇到了 403。但是，我将详细说明我编写的至少可以解决 401 问题的代码。

我没有更改任何服务帐户设置或重新生成任何密钥等，都是一样的。

改变的是一些代码，我升级到日历 API 的*v3r20lv1.12.0-beta*。

下面的代码，如上面在 OP 中详述的，保持不变，即：

```
private static final HttpTransport HTTP_TRANSPORT = new NetHttpTransport();
private static final JsonFactory JSON_FACTORY = new JacksonFactory();
.
.
.
GoogleCredential credential = new GoogleCredential.Builder().setTransport(HTTP_TRANSPORT)
        .setJsonFactory(JSON_FACTORY)
        .setServiceAccountId("284XXXXXXXX@developer.gserviceaccount.com")
        .setServiceAccountScopes(CalendarScopes.CALENDAR)
        .setServiceAccountPrivateKeyFromP12File(new File("D:/3cd8XXXXXXXXXXXXXXXXXXXXXXXXXXXXXd635e-privatekey.p12"))
        .build(); 
```

获取日历句柄的代码已更改，但这是由 API 更改强制执行的：

```
Calendar calendar = new Calendar(HTTP_TRANSPORT, JSON_FACTORY, credential); 
```

此时，我可以通过运行以下代码遍历我的日历并查看事件（这会打印事件摘要）：

```
Events events = calendar.events().list(CALENDAR_ID).execute();

for (Event event : events.getItems())
{
    System.out.println(event.getSummary());
} 
```

但是，如果我尝试更新事件，则会收到 403 Forbidden 错误。我将为此提出一个单独的线程，并将两个线程连接在一起。

感谢大家的帮助！

编辑：[这](https://stackoverflow.com/questions/14003203/403-forbidden-message-when-calling-the-v3-google-calendar-api-using-a-service-ac)是新线程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-02T09:06:08.107

您是否请求了适当范围的许可？您应该始终包括`https://www.googleapis.com/auth/userinfo.profile`

# java - 计算“机器”中“硬币”硬币的数量

> ID：10112945
> 
> 赞同：-1
> 
> 时间：2012-04-11T19:53:13.577
> 
> 标签：java

对于我最近的任务，我的任务是创建一个售票机，它可以接受付款并允许您取消付款。最近对该任务的扩展是计算添加的便士中有多少是某种类型的便士，例如 10 便士、20 便士、50 便士。

我设法让程序准确计算机器内 10p 的数量，但是当我尝试使用 20 时遇到了麻烦。

例如，当我运行该程序时，它在 10ps 上完美运行，但是当我运行它 20ps 时，我得到了这些结果：

测试：数硬币

错误：预期 4 - 20p 硬币发现 5 - 20p 硬币

下面是计算机器中有多少个 10/20/50ps 的代码：

```
class ProcessMoney
{
int ticket;
int cost = 0;
int machine;
int pence = 0;
int calc = 0;

public void setTicketPrice( int amount ) {

   ticket = amount;

}

public int getTicketPrice() { 

   return ticket;

    }

public void add( int coin ) {

    cost = cost + coin;

    if ( coin == 10 ){
        calc = calc + 1;
    }

    } 

public boolean enough() { return true; }

public int getPaidSoFar() { return cost; }

  public void cancel() {

      cost = 0;

} 

public void bought() {

      machine = machine + cost;
      cost = 0;

    }

  public int moneyInMachine() { 

      return machine;

}

public int getCoins( int coin ) {

     if ( coin == 10 ){
     pence = machine * 100;
     calc = pence / 1000;
     }
     else if ( coin == 20 ){
         pence = machine * 100;
         calc = pence / 2000;
        }

     return calc;
    }
} 
```

下面是测试它的代码：

```
class Main
{ 
  private static ProcessMoney pm = new ProcessMoney();

  public static void main( String args[] )
  {
    int res = 0, expected = 100;

    test( "setTicketPrice() & getTicketPrice() ");

    pm.setTicketPrice( expected );
    res = pm.getTicketPrice();
    check( res == expected, 
          "Ticket price is %d should be %d", res, expected );

    expected = 200;
    pm.setTicketPrice( expected );
    res = pm.getTicketPrice();
    check( res == expected, 
          "Ticket price is %d should be %d", res, expected );

    test( "add() & getPaidSoFar()");

    pm.add( 10 ); pm.add( 20 ); pm.add( 30 );
    expected = 60;
    res = pm.getPaidSoFar();
    check( res == expected, 
          "Money entered into machine is %d should be %d", res, expected );
    pm.add( 20 ); pm.add( 40 ); pm.add( 40 );
    expected = 160;
    res = pm.getPaidSoFar();
    check( res == expected, 
          "Money entered into machine is %d should be %d", res, expected );

    test( "add() & cancel()");

    pm.add( 10 ); pm.add( 20 ); pm.add( 30 );
    expected = 0;
    pm.cancel();
    res = pm.getPaidSoFar();
    check( res == expected, 
          "money entered into machine is now %d should be 0", res );

    pm.add( 100 ); pm.add( 200 ); pm.add( 300 );
    expected = 0;
    pm.cancel();
    res = pm.getPaidSoFar();
    check( res == expected, 
          "money entered into machine is now %d should be 0", res );

    test( "enough()");

    pm.setTicketPrice( 200 );
    pm.add( 100 ); pm.add( 100 ); pm.add( 0 );
    expected = 200;
    check( pm.enough(), 
          "Enough money entered into machine 200 for 200 ticket" );
    pm.cancel();

    pm.setTicketPrice( 210 );
    pm.add( 100 ); pm.add( 100 ); pm.add( 20 );
    expected = 200;
    check( pm.enough(), 
          "Enough money entered into machine 220 for 210 ticket" );
    pm.cancel();

    test( "bought() & moneyInMachine()");

    pm.setTicketPrice( 200 );
    pm.add( 100 ); pm.add( 100 ); pm.add( 0 );
    if ( pm.enough() )
    {
      pm.bought();
    }

    expected = 200;
    res = pm.moneyInMachine();
    check( expected == res,
          "Total money in machine %d should be %d", res, expected );
    res = pm.getPaidSoFar();
    check( res == 0, 
          "Money for ticket in machine is %d should be 0", res );
    pm.cancel();

    pm.setTicketPrice( 200 );
    pm.add( 100 ); pm.add( 100 ); pm.add( 10 );
    if ( pm.enough() )
    {
      pm.bought();
    }

    expected = 410;
    res = pm.moneyInMachine();
    check( expected == res,
          "Total money in machine %d should be %d", res, expected );
    res = pm.getPaidSoFar();
    check( res == 0, 
          "Money for ticket in machine is %d should be 0", res );

    test("Count coins");
    pm = new ProcessMoney();
    checkRecord( 10, 2 );
    checkRecord( 20, 4 );
    checkRecord( 50, 3 );
    checkRecord( 100, 3 );
    checkRecord( 200, 2 );

    System.out.println( "Success" );
  }

  private static void checkRecord( int coin, int howMany )
  {
     pm.setTicketPrice( howMany * coin );

     for ( int i=1; i<=howMany*2; i++ )
     {
       pm.add( coin );
     }
     pm.cancel();

     for ( int i=1; i<=howMany; i++ )
     {
       pm.add( coin );
     }

     pm.bought();
     int actual = pm.getCoins( coin );
     check( howMany == actual,
            "Expected %d - %dp coins found %d - %dp coins", 
             howMany, coin, actual, coin  );
  }

  private static String what = "";

  public static void check( boolean ok, String fmt, Object... params )
  {
    if ( ! ok )
    {
      System.out.println( what );
      System.out.print("ERROR: " );
      System.out.printf( fmt, params );
      System.out.println();
      System.exit(-1);
    }
  }

  public static void test( String str )
  {
    what = "Test: "  + str;
  }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:11:48.737

问题是你的机器钱没有从一个支票电话到下一个支票电话中清除。这是我测试您的代码的方法：

```
private static void checkRecord( int coin, int howMany )  {

 pm.setTicketPrice( howMany * coin );

 System.out.println("Before, Machine has"+pm.moneyInMachine());<---added print
 for ( int i=1; i<=howMany*2; i++ )
 {
   pm.add( coin );
 }
 pm.cancel();

 for ( int i=1; i<=howMany; i++ )
 {
   pm.add( coin );
 }

 pm.bought();
 System.out.println("After, Machine has"+pm.moneyInMachine());<---added print
 int actual = pm.getCoins( coin );
 check( howMany == actual,
        "Expected %d - %dp coins found %d - %dp coins", 
         howMany, coin, actual, coin  );} 
```

这是它为我打印的内容（我也停止了您的系统退出并始终打印出来）：

```
Before, Machine has0
After, Machine has20
Test: Count coins
ERROR: Expected 2 - 10p coins found 2 - 10p coins
Before, Machine has20
After, Machine has100
Test: Count coins
ERROR: Expected 4 - 20p coins found 5 - 20p coins
Before, Machine has100
After, Machine has250
Test: Count coins
ERROR: Expected 3 - 50p coins found 5 - 50p coins
Before, Machine has250
After, Machine has550
Test: Count coins
ERROR: Expected 3 - 100p coins found 5 - 100p coins
Before, Machine has550
After, Machine has950
Test: Count coins
ERROR: Expected 2 - 200p coins found 5 - 200p coins 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:29:35.337

看看你的`add(int coin)`方法。这就是你的问题~~开始~~的地方。

@Msonic 使用调试器的建议也很棒。

# ruby - 在两个 ActiveRecord 类之间合并/复制属性的好方法？

> ID：10112946
> 
> 赞同：5
> 
> 时间：2012-04-11T19:53:18.763
> 
> 标签：ruby, ruby-on-rails-3

之前已经部分询问过这个问题，我发现了以下关于如何一次设置类对象属性的[剪辑](http://snipplr.com/view/29561/)，但由于批量分配保护，Rails 不可能。（例如你不能 Object.attributes={}）

有没有一种将属性从一个类合并到另一个类的好方法？

```
object1.attributes = object2.attributes.inject({}){ |h,(k,v)|
  h[k]=v if ObjectModel.column_names.include?(k); h
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-11T20:00:36.887

将assign_attributes与选项[一起使用。](http://apidock.com/rails/ActiveRecord/Base/assign_attributes)`:without_protection`

```
attributes = object2.attributes.select do |attr, value|
  ObjectModel.column_names.include?(attr.to_s)
end
object1.assign_attributes(attributes, :without_protection => true) 
```

# java - 配置 Commons Logging 以使用特定的 Log4J 属性文件

> ID：10112948
> 
> 赞同：1
> 
> 时间：2012-04-11T19:53:27.920
> 
> 标签：java, logging, log4j, apache-commons-logging

我正在尝试通过在 commons-logging.properties 中指定文件的名称来配置 Commons Logging 以使用特定的 Log4J 属性文件，但是 Log4J 继续查找名为 log4j.properties 的文件。

看来，如果 Log4J jar 在类路径中，则 commons-logging.properties 的内容将被忽略，但是如果我从类路径中删除 jar，则处理 commons-logging.properties 文件并正确地抛出一个错误说“用户指定的日志类 'org.apache.commons.logging.impl.Log4JLogger' 找不到或不可用。” 因此实际上正在读取公共日志记录属性文件。

Commons Logging 和 Log4J 属性文件都在类路径目录中。

我遇到了与[commons-logging 和 log4j 属性文件](https://stackoverflow.com/questions/1524109/commons-logging-and-log4j-properties-file)中描述的相同的问题，但我不明白它所说的答案......

> 文件 commons-logging.properties 仅从 commons 日志中读取，而 log4j 将在系统属性中查找 log4j.configuration。

此外，这个答案似乎与 Commons Logging 用户指南中的信息相矛盾。用户指南说....

> **log4j.configuration= *log4j.properties***使用此系统属性来指定 Log4J 配置文件的名称。如果未指定，则默认配置文件为 log4j.properties。

即使我指定了 Log4J 配置文件的名称，它仍然使用默认值。

是否可以从 commons-logging.properties 文件中指定 log4j 属性文件的名称（例如 log4j-MyApp.properties），还是我误解了这两个组件如何相互交互？

# ruby-on-rails - 您如何在控制器中定义一个用于部分视图的函数以在所有视图中工作？Ruby on Rails

> ID：10112949
> 
> 赞同：1
> 
> 时间：2012-04-11T19:53:34.507
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller, partial-views

例如，我将部分内容`<%= render "layouts/location" %>`放在整个站点的视图中。我需要一个布局控制器（我试过 layouts_controller.rb ）所以我可以做

```
def _location
    @city = request.location.city
    @state = request.location.state
  end 
```

部分包含代码`<%= @city %>, <%= @state %>`

这一切都有效，应该在呈现部分的任何页面上显示访问者的城市和状态。

但是，当我这样做并推送到 heroku 并迁移数据库时，我收到错误消息：应用程序中发生错误，无法提供您的页面。请稍后重试。

如果您是应用程序所有者，请查看您的日志以获取详细信息。

所以问题是，如何为部分定义函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T20:11:23.193

您可以在应用程序控制器的前置过滤器中执行此操作，如下所示：

```
...
before_filter :location

def location
    @city = request.location.city
    @state = request.location.state
end 
```

方法的名称需要与`before_filter`调用中的符号匹配，但除此之外，您可以随意调用该方法。该方法必须在 ApplicationController 类中。

**澄清：**这将在您的应用程序中的每个请求之前被调用并为您设置这两个实例变量，因此在每个视图中，您将始终自动访问@city 和@state。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T20:18:46.707

我觉得您可以从其他解决方案中进行一些改进。

在应用程序控制器中

```
class ApplicationController < ActionController::Base
    before_filter :set_location, only: [:index, :show, :edit]

    def set_location
      @city = request.location.city
      @state = request.location.state
    end
end 
```

创建、更新和销毁操作可能不需要这些变量，因此使用`only: [...]`似乎是个好主意。您可以在其中添加其他自定义方法。主要问题是您的`create`操作何时失败，并且您需要呈现“编辑”页面。如果您不需要编辑页面上的这些变量，那么一切都很好。否则，您需要调用`set_location`自己：

```
def create
    @lala = Lala.new(...)
    @lala.save
    set_location if @lala.errors.any?
    respond_with @lala
end 
```

此外，在不需要这些变量的 30% 页面中，您可以使用`skip_before_filter`：

```
 class BlogsController < ApplicationController
    #assume you dont need those variables in your blog

    skip_before_filter :set_location # you can also use only: [:index, ...] here
 end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T20:25:46.430

你应该看看[细胞](http://cells.rubyforge.org/)。它是一个很棒但相当未知的宝石，它允许您在“单元”中构建您的应用程序。这可能正是您所需要的。

# asp.net - Apppool 不断停止（使用服务帐户的用户“NT Authority\anonymous login”登录失败）

> ID：10112950
> 
> 赞同：0
> 
> 时间：2012-04-11T19:53:37.760
> 
> 标签：asp.net, connection-string

我看到很多其他人和我有同样的问题，但每个问题都有点不同，就像我的一样。

我创建了一个将运行 Web 应用程序的服务帐户。此帐户在数据库中并且具有正确的权限。

我认为问题可能出在我的连接字符串中。当涉及到正确的语法时，我不是很了解，这就是为什么我认为这就是问题所在。

```
<add name="1AWebApp_Prod" connectionString="server=serverName;Initial Catalog=databaseName; Integrated Security=true; uid=nanw\svc_fawebprod_ria" providerName="System.Data.SqlClient"/> 
```

* * *

**更新：**

我删除了用户名，现在收到 HTTP 错误 500.3 - 服务不可用我进入应用程序池并注意到每次我从浏览器访问该站点时，它都会停止应用程序池

我将*Rapid-Fail Protection: Enable*设置为*False*，这并没有解决问题

当我运行时，`aspnet_regiis -ga nanw\svc_fawebprod_ria`我收到错误*“用户不存在*”

* * *

**更新 2：**

创建了服务帐户的镜像版本，[Resource](http://msdn.microsoft.com/en-us/library/ff649309.aspx) Ran 'aspnet_regiis -ga svc_fawebprod_ria'，工作应用程序池没有运行并且每秒都没有停止

现在我得到“*登录失败。登录来自不受信任的域，不能用于 Windows 身份验证*”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:59:34.820

使用集成安全性时不需要提供用户名（它使用当前登录的用户或运行相关服务的帐户）。

运行 Web 应用程序的应用程序池是什么帐户？我猜它还没有设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T20:12:57.423

由于应用程序和数据库未加入同一个域，因此这是不可能的。

# iphone - 不同的库，如支持 ARC 的 ASIHTTPRequest

> ID：10112951
> 
> 赞同：0
> 
> 时间：2012-04-11T19:53:40.330
> 
> 标签：iphone, ios, automatic-ref-counting

有没有像 ASIHTTPRequest 这样支持 ARC 的开源库？我不想在我的项目中更多地使用 ASIHTTPRequest，我也不想为任何其他库禁用 -fno-objc-arc 标志。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T22:29:30.277

几周前我遇到了同样的问题，最后我使用了 NSURLConnection。Apple Developer's Reference 中的本[指南有所帮助。](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html#//apple_ref/doc/uid/20001836-BAJEAIEE)

如果您有兴趣，我可以发布一些示例代码。

# flash - 不使用 Flash 发布到 RTMP 服务器

> ID：10112955
> 
> 赞同：0
> 
> 时间：2012-04-11T19:54:00.750
> 
> 标签：flash, rtmp

类似于[使用不带 Flash 的 rtmp 与 Flash 服务器](https://stackoverflow.com/questions/154749/communicating-with-a-flash-server-using-rtmp-without-flash)通信我想与不带 Flash 的 RTMP 服务器通信。不同之处在于我想发布视频流而不是播放它。

1.  发布视频流和播放它们有区别吗？
2.  在高层次上，如何实现从本地网络摄像头录制并发布到 RTMP 服务器的实时视频聊天客户端？是否像从网络摄像头抓取视频帧，将它们包装在 RTMP 中并将它们发送到服务器一样简单？还是在此过程中发生了其他事情？

# c# - CollectionViewSource.Source 的调度程序更新在同一线程上引发错误的线程异常

> ID：10112957
> 
> 赞同：2
> 
> 时间：2012-04-11T19:54:12.413
> 
> 标签：c#, mvvm, dispatcher, collectionviewsource

我的模型视图中的代码摘录。

```
 private ObservableCollection<MessageAbstract> _messages;

    /// <summary>
    /// Gets the Messages property.
    /// Changes to that property's value raise the PropertyChanged event. 
    /// </summary>
    public ObservableCollection<MessageAbstract> Messages
    {
        get
        {
            return _messages;
        }

        set
        {
            if (_messages == value)
            {
                return;
            }

            _messages = value;
            RaisePropertyChanged(() => Messages);
        }
    }

    private CollectionViewSource _messageView;

    public CollectionViewSource MessageView
    {
        get { return _messageView; }
        set
        {
            if (_messageView == value) return;
             _messageView = value;
            RaisePropertyChanged(() => MessageView);
        }
    }

private void MessageArrived(Message message){
   Application.Current.Dispatcher.Invoke(DispatcherPriority.Send, 
         new Action(() =>Messages.Add(message));
}

public ModelView(){
    MessageView = new CollectionViewSource{Source = Messages};
} 
```

当我从另一个服务回调时，我仍然在 Messages.Add(message) 上收到此异常。异常消息如下。“这种类型的 CollectionView 不支持从不同于 Dispatcher 线程的线程更改其 SourceCollection。”

我认为的代码摘录。

```
<ListBox x:Name="MessageList" ItemsSource="{Binding MessagesView}"> 
```

我检查了 Application.Current.Dispatcher 是否与 MessageList.Dispatcher 相同，所以现在我不知道为什么我不能添加到我的视图中。我的主要目标是我有一个搜索框，它使用集合视图源过滤器来过滤消息列表。

得到了答案

我发现我的答案错误与下面答案中的#2 点相同。我只是将我的集合的所有创建封装在 App 调度程序中。

```
Application.Current.Dispatcher.Invoke(DispatcherPriority.Send,new Action(
      () => { Messages = new ObservableCollection<MessageAbstract>();
              MessageView = new CollectionViewSource { Source = Messages };
                                      )); 
```

[WPF：尽管使用了 Dispatcher.BeginInvoke，但访问绑定的 ObservableCollection 失败](https://stackoverflow.com/questions/4527152/wpf-accessing-bound-observablecollection-fails-althouth-dispatcher-begininvoke)

> 我们之前遇到过这个问题。这个问题是双重的：
> 
> 1-确保对 SourceCollection 的任何更改都在主线程上（您已经完成了）。
> 
> 2- 确保 CollectionView 的创建也在主线程上（如果它是在不同的线程上创建的，比如响应事件处理程序，通常不会是这种情况）。CollectionView 期望修改在“它的”线程上，并且“它的”>线程是“UI”线程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:17:00.760

在直接绑定到`CollectionViewSource`. 我通过将我的列表框绑定到一个`CollectionView`对象来解决了这个问题。

在您的情况下，您只需将列表框声明更改为：

```
<ListBox x:Name="MessageList" ItemsSource="{Binding MessagesView.View}"> 
```

希望这对您有所帮助。

# c++ - 从服务器下载图像（cUrl，但接受建议）C++

> ID：10112959
> 
> 赞同：3
> 
> 时间：2012-04-11T19:54:22.440
> 
> 标签：c++, c, image, curl, download

我正在尝试通过从服务器（网站）下载图像来设置旋转背景图像，并尝试使用 curl 执行此操作，但是在执行此操作时成功为 0。我的代码的（缩短的）版本如下。我没有收到错误，但是，我将如何“临时”保存此图像以将其显示为我的背景？是否有图像（类型变量）或其他东西？

**这只是一个学习经验，所以任何图书馆或建议将不胜感激。**

```
#include <curl/curl.h>
CURL *curlCtx = curl_easy_init();
curl_easy_setopt(curlCtx, CURLOPT_URL, "http://www.examplesite.com/testimage.jpeg");
curl_easy_setopt(curlCtx, CURLOPT_WRITEDATA, this);
curl_easy_setopt(curlCtx, CURLOPT_WRITEFUNCTION, callbackfunction);
const CURLcode rc = curl_easy_perform(curlCtx);
if(rc == CURLE_OK){
    //it worked
}

size_t callbackfunction(char *data, size_t size, size_t nmemb, void *stream){
    //do something here with image...?
} 
```

谢谢，詹姆斯

编辑：对不起，我错误地将 () 添加到回调函数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T20:33:41.330

**您的代码甚至无法编译！**急！

`callbackfunction()`应该实施以处理传入的数据流。在这种情况下，我猜您希望将数据写入文件，对吧？

检查调用的返回始终是一种好习惯，因此请使用我分享的源代码并仔细研究它。下面的程序完成了你想要做的事情。

**dw.cpp**：

```
#include <stdio.h>
#include <curl/curl.h>

size_t callbackfunction(void *ptr, size_t size, size_t nmemb, void* userdata)
{
    FILE* stream = (FILE*)userdata;
    if (!stream)
    {
        printf("!!! No stream\n");
        return 0;
    }

    size_t written = fwrite((FILE*)ptr, size, nmemb, stream);
    return written;
}

bool download_jpeg(char* url)
{
    FILE* fp = fopen("out.jpg", "wb");
    if (!fp)
    {
        printf("!!! Failed to create file on the disk\n");
        return false;
    }

    CURL* curlCtx = curl_easy_init();
    curl_easy_setopt(curlCtx, CURLOPT_URL, url);
    curl_easy_setopt(curlCtx, CURLOPT_WRITEDATA, fp);
    curl_easy_setopt(curlCtx, CURLOPT_WRITEFUNCTION, callbackfunction);
    curl_easy_setopt(curlCtx, CURLOPT_FOLLOWLOCATION, 1);

    CURLcode rc = curl_easy_perform(curlCtx);
    if (rc)
    {
        printf("!!! Failed to download: %s\n", url);
        return false;
    }

    long res_code = 0;
    curl_easy_getinfo(curlCtx, CURLINFO_RESPONSE_CODE, &res_code);
    if (!((res_code == 200 || res_code == 201) && rc != CURLE_ABORTED_BY_CALLBACK))
    {
        printf("!!! Response code: %d\n", res_code);
        return false;
    }

    curl_easy_cleanup(curlCtx);

    fclose(fp);

    return true;
}

int main(int argc, char** argv)
{
    if (argc < 2)
    {
       printf("Usage: %s <url>\n", argv[0]);
       return -1;
    }

    if (!download_jpeg(argv[1]))
    {
        printf("!! Failed to download file: %s\n", argv[1]);
        return -1;
    }

    return 0;
} 
```

编译：`g++ dw.cpp -o dw -lcurl`并测试：

```
./dw http://unicornify.appspot.com/avatar/51d623f33f8b83095db84ff35e15dbe8?s=128 
```

此应用程序在磁盘中创建一个文件，该文件以其`out.jpg`下载的数据命名。

# ruby-on-rails - 活动记录迁移可以用于现有数据库吗？

> ID：10112972
> 
> 赞同：0
> 
> 时间：2012-04-11T19:54:56.883
> 
> 标签：ruby-on-rails, ruby, activerecord

我有一个非 Rails 应用程序，我想使用 Rails 活动记录迁移。

在没有任何问题之前我已经这样做了，但是这次**我希望我能以某种方式获得 AR 迁移以生成现有数据库的迁移脚本，以便我可以从中构建**。

这可能吗？

（对我来说，唯一的其他解决方案是在迁移中重新创建整个数据库，如果有某种内置方式，我不想这样做）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T20:00:45.287

您希望`rake schema:dump`它将为现有数据库模式创建本质上是迁移文件的内容。使用 rails 迁移生成器创建一个新的迁移并将转储的内容复制到其中。那应该引导您的迁移。

**更新**

要访问必要的 rake 任务，您可以初始化一个空的 rails 应用程序，设置 gemfile 以使用数据库的适当驱动程序 gem，并将 database.yml 设置为指向您的非 rails 数据库。您的迁移将存在于 rails 应用程序中，仅此而已。

# ios - 检查 CMenu 中的当前 CGPoint

> ID：10112973
> 
> 赞同：1
> 
> 时间：2012-04-11T19:55:00.900
> 
> 标签：ios, cocos2d-iphone

我们可以检查CGPoint是否已经触及CMenu项目吗？如果点在按钮中，我需要返回 YES，如果点不在按钮中，我需要返回 NO。

```
 -(BOOL)isButton:(CGPoint)point
    {
        if(controlMode == 1)
        {

            for (CCMenu *menu in self.children)
            {

                    // If point in button
                    return YES;
                    // else
                    return NO;

                }
            }

        }
        return NO;
    } 
```

菜单按钮：

```
CCMenuItem *pauseItem = [CCMenuItemImage itemFromNormalImage:@"pause.png" selectedImage:@"pause_.png" target:self selector:@selector(pauseGame:)]; 
CCMenuItem *resetItem = [CCMenuItemImage itemFromNormalImage:@"reset.png" selectedImage:@"reset_.png" target:self selector:@selector(resetClicked:)]; 
CCMenu *Menu = [CCMenu menuWithItems:pauseItem,resetItem, nil];
Menu.position = ccp(450, 40); 
[Menu alignItemsVerticallyWithPadding:5]; 
[self addChild:Menu]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T10:28:54.797

由于您所指的点是触摸（来自评论），因此如果您正在触摸菜单上的按钮，则会选择该项目。

```
-(BOOL) isAButtonSelected
{
    for(CCMenuItem* item in menu.children)
    {
        if(item.isSelected) return YES;
    }
    return NO;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T22:20:12.423

你可以这样尝试

```
for(CCMenuItem* item in yourMenu.children)
{
    CCPoint localPoint = [item convertToNodeSpace:point];
    if( (localPoint.x <= item.contentSize.width) && (localPoint.y <= item.contentSize.height) )
    {
        // in that case your point is in this item of your CCMenu
    }
} 
```

# selenium-ide - 单击命令对元素不起作用

> ID：10112975
> 
> 赞同：2
> 
> 时间：2012-04-11T19:55:10.010
> 
> 标签：selenium-ide

我们在我们的[Web 应用程序](http://www.dhtmlx.com/docs/products/dhtmlxToolbar/samples/01_init/08_events.html)中使用这些组件。

在页面上，您可以看到一个包含一些按钮的工具栏。如果您单击任何按钮，则会将日志写入日志栏中。

问题是我无法使用 Selenium IDE 记录此行为。IDE 创建一个命令，但是当我执行该命令时没有任何反应。甚至没有记录错误。

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T05:31:09.517

以慢速执行你的脚本

使用 xpath 来识别元素

```
clickAt  | //div[text()='New'] 
```

单击新建按钮

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T09:58:58.583

我访问了该网站[http://www.dhtmlx.com/docs/products/dhtmlxToolbar/samples/01_init/08_events.html](http://www.dhtmlx.com/docs/products/dhtmlxToolbar/samples/01_init/08_events.html)

我通过使用 xpath 检查器获得了 xpath，如下所示：

切 -`id('toolbarObj')/x:div[5]/x:div[11]/x:div`

复制 -`id('toolbarObj')/x:div[5]/x:div[12]/x:div`

粘贴 -`id('toolbarObj')/x:div[5]/x:div[13]/x:div`

您可以将修改后的 xpath 用作：

```
selenium.click("//div[@id='toolbarObj']/div[5]/div[11]/div");//Cut
selenium.click("//div[@id='toolbarObj']/div[5]/div[12]/div");//Copy
selenium.click("//div[@id='toolbarObj']/div[5]/div[13]/div");//Paste 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-14T06:04:12.513

我不知道这会有所帮助，但肯定对我有所帮助

如果您必须输入任何文本，然后单击任何元素或按钮

有两种方法首先使用“ `sendKeys`”键入然后“单击”所需的元素将起作用。例如，在`flipkart.com`“类型”中不起作用，但在“ `sendKeys`”中起作用

其次是使用“类型”然后按回车而不是单击使用“sendKeys”在目标中具有您正在输入的字段并且值必须具有“ `${KEY_ENTER}`”

例如将帮助您更好的 **第一种方法：** ![第一种方法](../Images/db5156db4128075f7d39914fdd99ac18.png)

**第二种方法：** ![第二种方法](../Images/bd50f8b5812ad72d67e2e594b4347a2d.png)

幸运的是，两者都为我工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T19:58:08.770

可能是硒脚本启动得太快了。我猜您使用的组件会为所有按钮生成一堆 HTML。如果脚本启动得太早，可能还没有生成 html。尝试更慢地运行 selenium 脚本。

另外：我认为 selenium 使用 XPath 来获取页面中的 HTML 元素。您确定 selenium 脚本指的是正确的 HTML 节点吗？您可以通过查看 selenium 脚本（它是 XML）并查看它用于按钮的 XPath 选择器来检查这一点。

也可能是 selenium 可能无法在不可点击的目标上触发点击事件（按钮是 div），但我认为情况并非如此。不过你可以试试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T09:30:17.950

如果您单击 img 本身而不是 div 会怎样？例如：

```
//img[contains(@src, 'paste')] 
```

当您单击 Selenium IDE 上的“查找”时，它实际上是否突出显示了页面上的某些内容？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-27T09:01:15.410

这是执行此操作的完整代码：

```
package riponalwasim.selenium.webdriver.stackoverflow;

import java.util.concurrent.TimeUnit;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

public class CutCopyPaste {
    WebDriver driver;
    String baseUrl;
    @BeforeClass
    public void setUp() throws Exception {
        baseUrl = "http://www.dhtmlx.com/docs/products/dhtmlxToolbar/samples/01_init/08_events.html";
        driver = new FirefoxDriver();
        driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
        driver.get(baseUrl);
    }

    @Test
    public void testCutCopyPaste() throws Exception {
        driver.findElement(By.xpath("//div[text()='New']")).click();
        driver.findElement(By.xpath("//div[@id='toolbarObj']/div[5]/div[11]/div")).click();
        driver.findElement(By.xpath("//div[@id='toolbarObj']/div[5]/div[12]/div")).click();
        driver.findElement(By.xpath("//div[@id='toolbarObj']/div[5]/div[13]/div")).click();
    }

    @AfterClass
    public void tearDown() throws Exception {
        driver.quit();
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-02T01:04:40.207

IDE 在记录 javascript 已将项目加载到页面时并不完美，因此可能需要手动帮助。

您是否尝试过等待元素加载后再尝试单击它？我可能会建议插入一个 waitForElementPresent 命令，例如 waitForElementPresent | #toolbarObj 在尝试点击之前。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2017-09-05T08:43:08.877

javascript 工作需要超过 1ms 的时间。所以只需添加“暂停 1000”

# java - BluetoothChat 示例中的 StringOutOfBoundException

> ID：10112976
> 
> 赞同：0
> 
> 时间：2012-04-11T19:55:21.120
> 
> 标签：java, android

在我的应用程序中，我使用了来自 BluetoothChat 示例的 DeviceListActivity 类的略微修改版本。该代码在我测试的所有设备上运行良好，但是当我发布应用程序时，我开始收到如下报告：

```
java.lang.StringIndexOutOfBoundsException: String index out of range: -1
at java.lang.String.substring(String.java:1555)
at sword.games.highnoonf.activities.DeviceListActivity$1.onItemClick(DeviceListActivity.java:18    0)
at android.widget.AdapterView.performItemClick(AdapterView.java:284)
at android.widget.ListView.performItemClick(ListView.java:3388)
at android.widget.AbsListView$PerformClick.run(AbsListView.java:1738)
at android.os.Handler.handleCallback(Handler.java:587)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:143)
at android.app.ActivityThread.main(ActivityThread.java:5097)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:521)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
at dalvik.system.NativeStart.main(Native Method) 
```

导致异常的函数是这样的：

```
private OnItemClickListener mDeviceClickListener = new OnItemClickListener() {
    public void onItemClick(AdapterView<?> av, View v, int arg2, long arg3)       {         
        // Cancel discovery because it's costly and we're about to connect
        mBtAdapter.cancelDiscovery();

        // Get the device MAC address, which is the last 17 chars in the View
        String info = ((TextView) v).getText().toString();
        String address = info.substring(info.length() - 17);
        String devName = info.substring(0, info.length() - 17);

        // Create the result Intent and include the MAC address
        Intent intent = new Intent();
        intent.putExtra(EXTRA_DEVICE_ADDRESS, address);
        intent.putExtra("DEVICE_NAME", devName);

        // Set result and finish this Activity
        setResult(Activity.RESULT_OK, intent);
        finish();
    }
}; 
```

其余代码几乎与 DeviceListActivity 示例相同...我希望有人可以解决此问题或给我解释为什么会发生这种情况...谢谢...

编辑：代码已经在检查名称是否存在并且 MAC 地址的长度与这些行是否正确（如果出现问题，则不会添加电话并且用户无法单击它）：

```
String name = device.getName();
String address = device.getAddress();

if(name == null) name = "Unknown";
else if (name.length() == 0) name = "Unknown";

if (address.length() == 17){
    mNewDevicesArrayAdapter.add(name + "\n" + address);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:58:46.503

好像你`info.length()`的尺寸小于**17**。确保*子字符串*方法没有将任何负值作为参数。将代码的关键部分放在*try/catch*块中以避免异常。

# ruby - IV的编码和存储

> ID：10112978
> 
> 赞同：0
> 
> 时间：2012-04-11T19:55:27.273
> 
> 标签：ruby, ruby-on-rails-3, string, character-encoding

我正在使用 Ruby 的标准 OpenSSL 库。它有一个名为的方法，可以在（二进制）编码`random_iv`中生成具有适当长度的 IV 。`ASCII-8BIT`但是，我的 Rails 应用程序和数据库配置为 UTF-8。我无法将其转换为 UTF-8 来存储它（因为它是二进制的，而不是 ASCII 文本）。那么，我该怎么做呢？我必须进行base64转换吗？使用`SecureRandom`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:21:15.793

为什么不将数据存储在`:binary`or`:blob`列中？这些旨在存储任意二进制数据。

# api - Foursquare checkins api - 尝试在日期之间进行签到

> ID：10112981
> 
> 赞同：1
> 
> 时间：2012-04-11T19:55:33.293
> 
> 标签：api, foursquare, checkin, date-range

我正在使用此处引用的 api @ api.foursquare.com/v2/users/USER_ID/checkins developer.foursquare.com/docs/users/checkins 我正在使用 vb.net 创建请求，但这可能无关紧要。我遇到的问题是我收到的响应似乎忽略了 beforeTimeStamp 值。

例如，我创建了一个请求 url；（oauth_token 被屏蔽 - 但正确且有效） [https://api.foursquare.com/v2/users/self/checkins?oauth_token=####&v=20120214&limit=250&offset=0&afterTimestamp=1332720000&beforeTimestamp=1333238400](https://api.foursquare.com/v2/users/self/checkins?oauth_token=####&v=20120214&limit=250&offset=0&afterTimestamp=1332720000&beforeTimestamp=1333238400) 1332720000 是纪元日期26-03-2012 和 1333238400 是 01-04-2012 我希望这会返回这些日期之间的所有签到。然而，它总是返回最近一次的所有签到，即今天 2012 年 11 月 4 日。我昨晚花了很多时间寻找这个问题的答案，我没有进一步前进。

我可以继续编写一个分页方法来移动历史日志，直到我拥有我需要的那些。不过，这会创建多个请求。我什至编写了一个简单的函数，用于在我取回对象后删除超出范围的签入。然而，这似乎很浪费，尤其是当我正在编写的应用程序有可能在用户历史中追溯到几年前。这将意味着返回比所需更多的数据，从而产生不必要的开销。[经过所有搜索后，当我偶然发现https://apigee.com/](https://apigee.com/)上的 Foursquare API 控制台时，我正要接受上述两种解决方法之一
如果您已经读到这里，这就是这个问题的主旨（除非有人知道我做错了什么……）需要，即指定日期之间的那些！如果我使用我的应用程序，它会全部返回！我的 URL /v2/users/self/checkins?oauth_token=####&v=20120214&limit=250&offset=0&afterTimestamp=1332720000&beforeTimestamp=1333238400 Apigee 的 URL（在执行后的请求框中） /v2/users/self/checkins?oauth_token=# ###&v=20120214&limit=250&offset=0&afterTimestamp=1332720000&beforeTimeStamp=1333238400

指出不同？我也不行！有人有想法么？非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:45:24.223

我认为您的网址中有错字。`beforeTimeStamp`应该是`beforeTimestamp`。这就是为什么您的第二个 URL 不起作用的原因。进一步看来，您在帖子中混淆了 Apigee 的 URL 和您的 URL。

按预期检索昨天的签到对我有用：

[https://api.foursquare.com/v2/users/self/checkins?oauth_token=###&v=20120321&afterTimestamp=1334120400&beforeTimestamp=1334206799](https://api.foursquare.com/v2/users/self/checkins?oauth_token=###&v=20120321&afterTimestamp=1334120400&beforeTimestamp=1334206799)

从 20120214 开始的 API 版本也没有问题。您的 URL 也为我工作。

# c - 使用 snprintf 的缓冲区溢出

> ID：10112984
> 
> 赞同：5
> 
> 时间：2012-04-11T19:55:43.617
> 
> 标签：c, buffer

这是一项任务，但我在基本理解方面遇到了问题。

易受攻击的代码：

```
int choc(char *arg)
{
  char buf[400];
  snprintf(buf, sizeof buf, arg);
  return 0;
} 
```

我知道 arg 需要是一个格式字符串，它将用我要执行的代码的地址覆盖返回地址。但是我在创建格式字符串时遇到了麻烦。

所以，格式字符串需要具备的东西：

1.  返回指令的地址，我需要覆盖
2.  %x 的列表
3.  我将在返回地址上写的值。这将是我要执行的代码的地址。

为了得到返回地址，我只需要查看gdb中'ret'指令的地址，对吗？%x 的目的到底是什么？以及如何在格式字符串中对要执行的代码的地址进行编码？

我做了一个测试：使用gdb我发现我的buf的地址是0xbffffba0。我生成 arg 为 "\xa0\xfb\xff\xbf_%x.%x.%n"; 这不应该在地址 0xbffffba0 的缓冲区的开头写入一些值吗？但是我得到一个段错误。我究竟做错了什么？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:53:03.267

不应该是 buf的`"\xa0\xfb\xff\xbf"`地址，而是堆栈上的返回地址的位置（这是您希望覆盖的值）。您必须使用 gdb 找到该值。

然后，您需要在格式字符串中放入足够的 %x ，以便您的 %n 将从堆栈中读取该值并写入您指定的地址。您还需要使用正确的字段大小，以便 %n 实际上写入正确的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T20:07:22.910

您尝试利用的漏洞称为格式字符串漏洞。为了进一步研究这个话题，我会推荐[这个](http://www.google.si/url?sa=t&rct=j&q=format%20string%20vulnerability&source=web&cd=2&ved=0CD4QFjAB&url=http://crypto.stanford.edu/cs155old/cs155-spring08/papers/formatstring-1.2.pdf&ei=mOOFT4GxFsHzsgb-gpHUBg&usg=AFQjCNG3QiG2k0n39PsNfLIcyjkiZJjuow&cad=rja)链接或名为“黑客：剥削的艺术”的书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T20:13:09.680

从调试器中读取值通常是不够的。一些平台具有地址空间随机化安全功能，这将导致特定对象的地址在程序调用之间有所不同。相反，您需要找出返回地址在堆栈上的存储位置（相对于`snprintf`调用）并在那里覆盖它。这是非常特定于 CPU 的。你在开发什么平台？

`return`使用调试器，在汇编级别单步执行该函数的代码，并在遇到命令之前检查堆栈。确保堆栈和返回地址看起来像您认为的那样。这应该会给你一个关于问题出在哪里的线索。此外，您可以尝试在 之前使用调试器手动修改堆栈，`return`以验证您定位的位置实际上是返回地址。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-11T20:50:46.427

答案是否定的，您不仅需要“ret”指令的地址。您实际需要的是“ret”指令加载的内存位置。看看这张图：

[http://post.queensu.ca/~trd/377/tut5/stack.html](http://post.queensu.ca/~trd/377/tut5/stack.html)

您的目标是覆盖“退货地址”。

我将继续尝试编写一个简短的程序来显示这个指针（即将到来）。

**更新：**我有坏消息。我也想不通。我写过：

```
#include <stdio.h>
#include <stdlib.h>

void bar()
{
    printf("Bar function\n");
}

void foo()
{
    void (**p)(void);
    asm volatile("movl %%ebp, %0\n\t" : "=r"(p) : : "%0");
    p += 1;
    *p = bar;
}

int main()
{
    foo();
    return 0;
} 
```

这会导致分段错误，而不会在`bar()`. 我希望它能够工作......所以现在我和你一样困惑。谁能解释为什么`bar()`不在我的代码中执行？

# c# - 多个模型进入一个视图

> ID：10112985
> 
> 赞同：1
> 
> 时间：2012-04-11T19:55:45.290
> 
> 标签：c#, asp.net, asp.net-mvc-3

我在这里看到过这个问题，但它似乎与我的情况不同。我可能错了，但我们会看到的。

现在我正在用 MVC3 (C#) 创建一个博客类型的网站，我目前可以创建、编辑、删除等博客，一切正常。我正在使用 Code First EF，所以我不知道这有多重要。

我有一个 BlogPost 模型如下：

```
public class BlogPost
{
    public int id { get; set; }
    public string Title { get; set; }
    public DateTime DateCreated { get; set; }
    public ICollection<Topic> Topics { get; set; }
    public string Content { get; set; }
    public ICollection<Comment> Comments { get; set; }
} 
```

和一个主题模型（每篇博文可以有多个主题）

```
public class Topic
{
    public int id { get; set; }
    public string Name { get; set; }
    public int PostId { get; set; }

    // navigation back to parent
    public BlogPost Post { get; set; }
} 
```

然后是我的 DbContext 继承模型，其中包含我的所有模型：

```
public class MyModel : DbContext
{
    public DbSet<BlogPost> Posts { get; set; }
    public DbSet<Comment> Comments { get; set; }
    public DbSet<Topic> Topics { get; set; }

    public DbSet<AdminComment> AdminComments { get; set; }
    public DbSet<Bug> Bugs { get; set; }
} 
```

目前 BlogController 使用默认的脚手架来创建/编辑/删除/细节

```
private MyModel db = new MyModel();

//
// GET: /Admin/Blog/

public ViewResult Index()
{
    return View(db.Posts.ToList());
} 
```

我可以做些什么来传递另一个模型，所以在这个列表上说，它将显示与帖子相关的所有主题，并添加一个创建以将主题添加到您当前正在创建的帖子中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T19:59:40.293

创建一个具有您希望视图能够看到的属性的外部对象，并将新对象用作您的模型。你几乎已经做到了这一点。只需将您的控制器更改为：

```
public ViewResult Index()
{
    return View(db);
} 
```

现在视图可以访问所有内容。

# opengl-es - 在 OpenGL ES 2.0 中独立变换对象

> ID：10112996
> 
> 赞同：8
> 
> 时间：2012-04-11T19:57:06.087
> 
> 标签：opengl-es, opengl-es-2.0

我见过的所有教程都使用单个对象，例如三角形或立方体。但我不清楚如何独立操作单独的对象。我看过一些参考固定函数管道并使用 pushmatrix 和 popmatrix 的教程，但是使用可编程管道，这些函数就消失了。下面是一个 init 函数和一个 draw 函数，它们在屏幕上绘制一个三角形并围绕 Z 轴旋转它。有人可以给我看代码，甚至是伪代码来添加第二个三角形并独立于另一个三角形旋转它吗？说围绕不同的轴或相反的方向？

他们来了：

```
int Init(ESContext* esContext)
{
    UserData* userData = (UserData *)esContext->userData;
    const char *vShaderStr =
        "attribute vec4 vPosition;  \n"
        "uniform mat4 MVPMatrix;"
        "void main()                \n"
        "{                          \n"
        "   gl_Position = MVPMatrix * vPosition;\n"
        "}                          \n";

    const char *fShaderStr =
        "precision mediump float;   \n"
        "void main()                \n"
        "{                          \n"
        "   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0); \n"
        "}                          \n";

    GLuint vertexShader;
    GLuint fragmentShader;
    GLuint programObject;
    GLint linked;
    GLfloat ratio = 320.0f/240.0f;

    vertexShader = LoadShader(GL_VERTEX_SHADER, vShaderStr);
    fragmentShader = LoadShader(GL_FRAGMENT_SHADER, fShaderStr);

    programObject = glCreateProgram();

    if (programObject == 0)
        return 0;

    glAttachShader(programObject, vertexShader);
    glAttachShader(programObject, fragmentShader);

    glBindAttribLocation(programObject, 0, "vPosition");
    glLinkProgram(programObject);
    glGetProgramiv(programObject, GL_INFO_LOG_LENGTH, &linked);

    if (!linked)
    {
        GLint infoLen = 0;
        glGetProgramiv(programObject, GL_INFO_LOG_LENGTH, &infoLen);

        if (infoLen > 1)
        {
            char* infoLog = (char *)malloc(sizeof(char) * infoLen);
            glGetProgramInfoLog(programObject, infoLen, NULL, infoLog);

            free(infoLog);
        }

        glDeleteProgram(programObject);
        return FALSE;
    }

    userData->programObject = programObject;

    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);

    glViewport(0, 0, esContext->width, esContext->height);
    glClear(GL_COLOR_BUFFER_BIT);

    glUseProgram(userData->programObject);

    userData->angle = 0.0f;
    userData->start = time(NULL);
    userData->ProjMatrix = PVRTMat4::Perspective(ratio*2.0f, 2.0f, 3.0f, 7.0f, PVRTMat4::eClipspace::OGL, false, false);
    userData->ViewMatrix = PVRTMat4::LookAtLH(PVRTVec3(0.0f, 0.0f, -3.0f), PVRTVec3(0.0f, 0.0f, 0.0f), PVRTVec3(0.0f, 1.0f, 0.0f));
    return TRUE;
}

void Draw(ESContext *esContext)
{
    GLfloat vVertices[] = {0.0f, 0.5f, 0.0f,
                          -0.5f, -0.5f, 0.0f,
                           0.5f, -0.5f, 0.0f};

    GLint MVPHandle;
    double timelapse;

    PVRTMat4 MVPMatrix = PVRTMat4::Identity();
    UserData* userData = (UserData *)esContext->userData;

    timelapse = difftime(time(NULL), userData->start) * 1000;
    if(timelapse > 16.0f) //Maintain approx 60FPS
    {
        if (userData->angle > 360.0f)
        {
            userData->angle = 0.0f;
        }
        else
        {
            userData->angle += 0.1f;
        }
    }

    userData->ModelMatrix = PVRTMat4::RotationZ(userData->angle);

    MVPMatrix = userData->ViewMatrix * userData->ModelMatrix;
    MVPMatrix = userData->ProjMatrix * MVPMatrix;

    MVPHandle = glGetUniformLocation(userData->programObject, "MVPMatrix");
    glUniformMatrix4fv(MVPHandle, 1, FALSE, MVPMatrix.ptr());

    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, vVertices);
    glEnableVertexAttribArray(0);

    glClear(GL_COLOR_BUFFER_BIT);
    glDrawArrays(GL_TRIANGLES, 0, 3);
    eglSwapBuffers(esContext->eglDisplay, esContext->eglSurface);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T20:11:19.133

绘制第一个三角形后，使用新的所需旋转/位置生成一个新的 MVP 矩阵，上传它，然后再次绘制三角形。在场景中，您可以根据需要多次更换制服。

这类似于 push 和 pop 所做的，它们只是在绘制给定对象之前更改活动矩阵。

示例伪代码：

```
MMatrix = identity;
MVPMatrix = VPMatrix * MMatrix;
glUniformMatrix4fv(MVPHandle, 1, FALSE, MVPMatrix.ptr());
glDrawArrays(GL_TRIANGLES, 0, 3); //draw triangle at 0,0,0

MMatrix.translate(1,0,0);
MVPMatrix = VPMatrix * MMatrix;
glUniformMatrix4fv(MVPHandle, 1, FALSE, MVPMatrix.ptr());
glDrawArrays(GL_TRIANGLES, 0, 3); //draw triangle at 1,0,0

MMatrix.translate(1,0,0);
MVPMatrix = VPMatrix * MMatrix;
glUniformMatrix4fv(MVPHandle, 1, FALSE, MVPMatrix.ptr());
glDrawArrays(GL_TRIANGLES, 0, 3); //draw triangle at 2,0,0

..repeat for as many objects as you want.. 
```

这将为您留下三个三角形，分别位于 (0,0,0)、(1,0,0) 和 (2,0,0)。

# java - 如何使用 !.equals 和字符串？

> ID：10112997
> 
> 赞同：3
> 
> 时间：2012-04-11T19:57:07.537
> 
> 标签：java, string, if-statement, equals

我们正在做一个小组作业。该程序的一部分是供用户输入“支付”，然后输入学生的 SIN（社会保险号码）和从他们的帐户中扣除的金额。例如，`pay,193678187,900`。

SIN 与文件中的 SIN 列表进行比较，生成到数组中并进行比较`curSin.equals(stuSin))`。 `curSin`并且`stuSin`都是字符串。

如果找到 SIN，它将从学生的余额中减少金额（未显示）并将其写入文件`write(student,inrec)`。

如果未找到 SIN，则应返回“未找到 SIN”。
我们的问题是，即使找到了 SIN，它仍然返回“SIN not found”。我们认为它与 if 语句和不等于比较有关，但我们已经尝试了所有我们能想到的方法，但无法让它正常工作。

任何帮助将不胜感激。谢谢。

下面的代码片段。

```
 if (cmd.equals("pay") && p.length == 3)
    { // first word is "pay";three terms (cmd, sin, $)
        System.out.println("pay");
        // Pay: decreases student payment, notifies of overpayment
        String stuSin = p[1];
        double stupay = Double.parseDouble(p[2]);
        for (int i = 0; i < student.length; i++)
        {
            Student x1 = student[i];
            String curSin = x1.getSin();
            if (curSin.equals(stuSin))
            {
                double curpay = x1.getBal();
                double newBal = curpay - stupay;
                if (stupay > curpay)
                {
                    JOptionPane.showMessageDialog(null, "Overpayment");
                    System.exit(0);
                }
                x1.setBal(newBal);
                System.out.println(x1.getBal());

                write(student, inrec);
            }
            else if (!curSin.equals(stuSin))
            {
                JOptionPane.showMessageDialog(null, "SIN not found"); // sin not found
                System.exit(0);
            }

        }// end of for loop
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T20:01:22.527

如果列表中的第一个匹配正确，您的程序似乎可以正常工作。

但第一个不是正确的匹配。所以它没有看第二个就退出了。

您可能希望遍历所有学生，并在第一次匹配时跳出循环。

当且仅当您遍历所有学生而不匹配运行`JOptionPane.showMessageDialog(null,"SIN not found"); //sin not found`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T20:01:51.903

您使用 equals 方法似乎没有任何问题。

您应该添加几个调试语句（或实际使用调试器）以确保您确实在比较所需的字符串。

```
System.out.println("stuSin: '" + stuSin + "'");
System.out.println("curSin: '" + curSin + "'"); 
```