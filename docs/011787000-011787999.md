# StackOverflow 问答 11787000-11787999

# php - 使用 UTF-8 在 DB 中存储 HTML / 特殊字符

> ID：11787003
> 
> 赞同：1
> 
> 时间：2012-08-02T22:56:47.597
> 
> 标签：php, mysql

我正在修改我的网站以使用 UTF-8 编码，这被证明有点痛苦。这是我到目前为止所做的：

1)`<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />`

2)`mysql_set_charset("utf8");`

3）设置数据库、表、列的字符集为`utf8`

现在我在一个字段中有一些数据，其内容是（确切的形式）：

`<p>Tom & Jerry £5</p>`

将此数据输出到页面后，一切看起来都是正确的。但是，在进行 HTML 验证检查时，它在`&`符号上失败，因为它没有被更改为`&amp;`.

现在我尝试通过使用来解决这个问题，`htmlentities()`但这会编码所有内容，包括 HTML`P`标记的尖括号。所以它没有正确显示。此外，英镑符号出现在其前面有一个奇怪的字符。

我的问题是，我是否将数据正确存储在数据库表中？如果是这样，我需要做些什么来确保所有内容都显示并验证正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T23:08:41.767

在网页中输出 UTF-8 文本时使用[htmlspecialchars](http://php.net/htmlspecialchars)而不是[htmlentities 。](http://php.net/htmlentities)

# c# - 非阻塞键/值存储

> ID：11787004
> 
> 赞同：1
> 
> 时间：2012-08-02T22:57:02.243
> 
> 标签：c#, multithreading, dictionary, thread-safety

我目前正在编写一些对性能至关重要的代码，这些代码需要一种无需使用锁即可从键值存储中检索值的方法。

我曾尝试使用 ConcurrentDictionary，但在这种情况下，它的性能不足以满足我的需求。

所以我在这里追求的是类似于 ConcurrentDictionary 中的 GetOrAdd 方法，但我需要它超级快（没有锁）并且仍然是线程安全的:)

这里应该注意的是，假设我们将主要检索现有值而很少添加新值。还假设此列表不会很大。

我不是线程专家，所以如果有人可以评论我的想法，那就太好了。

```
public class Registry<TKey, TValue>
{
    private Dictionary<TKey, TValue> dictionary = new Dictionary<TKey, TValue>();

    public TValue GetOrAdd(TKey key, Func<TKey, TValue> valueFactory)
    {
        TValue value;            
        if (!dictionary.TryGetValue(key, out value))
        {
            var snapshot = new Dictionary<TKey, TValue>(dictionary);
            if (!snapshot.TryGetValue(key, out value))
            {
                value = valueFactory(key);
                snapshot.Add(key, value);
                dictionary = snapshot;
            }                
        }
        return value;
    }
} 
```

这里的“技巧”是创建实际字典的快照，如果我们确实需要向它添加新值。最后，我们交换引用，以便字典变量现在指向快照。请记住，我真的不在乎我是否在这里和那里丢失一两个更新。我需要的是真正快速检索现有值。

我对交换引用的代码有点不确定。

字典=快照；

如果另一个线程在交换引用的同时尝试访问字典变量会发生什么。这甚至是一个问题吗？

问候

伯恩哈德·里希特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T23:11:40.783

您的第一次拍摄几乎是正确的。交换引用是线程安全的，因为地址是原子更新的。但是当您想要更新字典时仍然需要锁定，因为您不想丢失任何并发更改。实现这一点的唯一方法是采取某种锁。

如果不这样做，您有时会使用较旧版本的字典，尽管在两者之间更新了引用，并且您的线程确实将引用与包含旧数据的更新字典交换。

MS Threading 手册还提到，当您很少更新字典时，ConcurrentDictionary 无法很好地扩展。在这种情况下，经典词典仍然更好。

我不知道您进入了哪个问题域，但可能是更改您正在处理的数据结构可能会给您带来比优化并发字典访问更多的性能。字典非常快，但 CPU 数据缓存不友好。如果您想获得更快的速度，可能需要摆脱字典，或者您需要不同的数据结构才能在内存中获得更多线性读取，这对缓存更加友好。

```
public class Registry<TKey, TValue>
{
    private Dictionary<TKey, TValue> dictionary = new Dictionary<TKey, TValue>();
    private object Lock = new object();

    public TValue GetOrAdd(TKey key, Func<TKey, TValue> valueFactory)
    {
        TValue value;            
        if (!dictionary.TryGetValue(key, out value))
        {
            lock(Lock)
            {
              var snapshot = new Dictionary<TKey, TValue>(dictionary);
              if (!snapshot.TryGetValue(key, out value))
              {
                  value = valueFactory(key);
                  snapshot.Add(key, value);
                  dictionary = snapshot;
              }
            }   
        }
        return value;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T19:29:34.997

由于您的字典大小不大并且您不经常更新它，您可以使用双缓冲方法：

创建两个相同的字典，并从第一个开始阅读。将更新应用到第二个字典并交换引用，以便您现在从第二个字典中阅读。然后返回并将相同的更新应用于第一个字典。

将下一个更新应用到第一个字典，交换引用，然后更新第二个字典。等等，每次更新时在字典之间切换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T23:02:26.143

这是不正确的！字典的构造函数将在创建快照之前遍历整个字典。这可能导致不正确的快照状态。

如果 ConcurrentDictionary 对您没有帮助，您可以尝试使用不可变数据结构，例如前缀树（又名基数树或 trie）。这些是线程安全的。

# php - 如何使用 PHP DBA 功能搜索关键字

> ID：11787005
> 
> 赞同：2
> 
> 时间：2012-08-02T22:57:03.820
> 
> 标签：php, mysql

我正在尝试使用 PHP DBA 函数来搜索带有关键字的数据库文件，就像使用 mysql`like`语句进行搜索一样。

我查阅了 php 手册，但找不到任何功能。有人有一个好主意吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:07:49.670

DBA 函数中没有`like`，但您可以使用`dba_fetch()`. 只需使用此函数传递整个数据库并使用正则表达式`preg_match`来允许通配符匹配

# optimization - 范围编码器：如何摆脱分裂？

> ID：11787006
> 
> 赞同：2
> 
> 时间：2012-08-02T22:57:16.237
> 
> 标签：optimization, arm, integer-division, raspberry-pi, range-encoding

我正在尝试优化[QTC](http://goo.gl/9lZsd)视频编解码器以在 Raspberry Pi 上以良好的性能工作。一个重要的瓶颈是在范围解码器中完成的 32 位整数除法，它占用了 18% 的解码时间。由于该设备的 ARM 处理器显然缺少整数除法指令，我认为可以轻松优化这一点。划分必须准确。

每次调用该特定除法中的被除数和除数都不同，但众所周知，除数总是小于 65536。我考虑过建立一个除数反值的查找表。使用该表，我可以使用乘法而不是除法。查找表的大小为 256 kibibytes。

## 问题

1.  执行该优化是个好主意吗？
2.  有没有更好的方法来摆脱软件部门？
3.  有没有不同的方法来实现算法，使得没有除法？
4.  其他想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T01:08:14.160

人们还可以利用这样一个事实，即 Raspberry Pi 包含一个能够执行双精度 FP 除法的 FP 单元，这比整数除法的软件模拟要快。`a = b / c`用`a = (double)b / (double)c`对我有用的替换所有整数除法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T00:32:15.520

如果你想使用魔法乘法 + LUT，这里有一些代码。

简单的测试器测试随机除数 i。没有详尽地测试所有我的，但在我运行它的短时间内工作。似乎适用于我测试的 i 的所有 32 位状态的股息 (j=0..2^32-1)。

实际上，您会预先计算 i=2..64k-1 或类似范围的查找表（i=0 不起作用，因为 value/0 未定义，而 i=1 不起作用，因为它的魔法乘数就在外面32 位数字的范围）。然后使用使用 i 作为查找索引的方程来获得魔法乘数“m”。根据需要进行更改，不要讨厌我的风格。:P

```
#include <stdio.h>

int main() {
  unsigned int i,j,k,m,c;

  // compute j/i,
  // compute k = 2^32/i
  // instead of j/i, use m = ~(j*k)>>32
  srand(time(0));
  for(c=0;c<64;c++) {
    // generate random divisor i's for testing, then fully test every j
    i = rand()&0x7fff;      
    // precompute these and put into a lookup table, index on [i]
    k = (((__int64)1)<<32)/i;  
    for(j=0;j!=-1;j++) {
      // status updater so we know it's working...
      if(!(j&0xfffff)) { printf("%d : %d     \r", i, j); fflush(0); }    
      // multiply instead of divide!
      m = (((__int64)j*k)+k/2)>>32; 
      // rare fixup
      if(j - m*i >= i) m++;                          
      if(m != j/i) {
        // as long as this line doesn't print, we're ok
        printf("wrong : %d %d %d   got: %d  should be: %d\n", 
            i, j, k, m, j/i);    
      }
    }
  }
} 
```

# android - 菊花链式 Android 加载器是不是一个坏主意？

> ID：11787008
> 
> 赞同：1
> 
> 时间：2012-08-02T22:57:59.420
> 
> 标签：android, android-progressbar, android-loadermanager, android-loader

我需要从 2 个在线来源获取数据，并希望在我这样做时显示每个来源的进度。收集数据后，我可以填充列表视图。

我当前的实现是 MyActivity 实现了 LoaderCallbacks，后者又创建了 MyDataLoader 的一个实例（一个扩展 AsyncTaskLoader 的类）。在 MyDataLoader 的 loadInBackground 方法中，它从所有来源获取数据并填充 Sqlite 数据库。然后可以在整个过程中使用此数据库。

问题是我没有给用户任何关于我们在这个过程中的位置的反馈。

所以我想以某种方式使用 getLoaderManager().initLoader 以菊花链方式连接加载器来创建我的加载器，然后一次遍历加载器管理器中的加载器。当每个加载器完成并返回到 onLoadFinished 时，我有机会设置 progressDialog 的文本以指示进度。

这是一个坏主意吗？有没有更简单更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:12:50.370

这是不可能的，因为`Loader`s 在不同线程的后台加载数据......数据不是“按顺序”加载的，因此显示进度`onLoadFinished`不会让您准确了解实际取得了多少进展。

所有用户需要知道的是数据正在后台加载。在我看来，即使启动整个对话也有点矫枉过正，并且会破坏用户体验。我想到的两个选择是：

1.  在布局或操作栏中显示不确定的进度图标。

2.  `TextView`显示在布局中心显示的灰色`Loading...`。当`TextView`数据已从网络检索并准备好显示在屏幕上时，最终隐藏。一些 Google 制造的应用程序选择此选项，例如 Google Analytics。

# python - How to install MySQLdb on Mountain Lion

> ID：11787012
> 
> 赞同：10
> 
> 时间：2012-08-02T22:59:10.697
> 
> 标签：python, mysql, installation

I'm new to Python and I'm having trouble building MySQLdb, in an attempt to get Google AppEngine SDK running. I have just upgraded from Snow Leopard to Mountain Lion and have installed the latest XCode (4.4)

I've downloaded [http://sourceforge.net/projects/mysql-python/](http://sourceforge.net/projects/mysql-python/)

```
python setup.py build 
```

i get the following output in terminal

```
running build
running build_py
creating build
creating build/lib.macosx-10.8-intel-2.7
copying _mysql_exceptions.py -> build/lib.macosx-10.8-intel-2.7
creating build/lib.macosx-10.8-intel-2.7/MySQLdb
copying MySQLdb/__init__.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb
copying MySQLdb/converters.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb
copying MySQLdb/connections.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb
copying MySQLdb/cursors.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb
copying MySQLdb/release.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb
copying MySQLdb/times.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb
creating build/lib.macosx-10.8-intel-2.7/MySQLdb/constants
copying MySQLdb/constants/__init__.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb/constants
copying MySQLdb/constants/CR.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb/constants
copying MySQLdb/constants/FIELD_TYPE.py -> build/lib.macosx-10.8-intel-    2.7/MySQLdb/constants
copying MySQLdb/constants/ER.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb/constants
copying MySQLdb/constants/FLAG.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb/constants
copying MySQLdb/constants/REFRESH.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb/constants
copying MySQLdb/constants/CLIENT.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb/constants
running build_ext
building '_mysql' extension
creating build/temp.macosx-10.8-intel-2.7
clang -fno-strict-aliasing -fno-common -dynamic -g -Os -pipe -fno-common -fno-strict-aliasing -fwrapv -mno-fused-madd -DENABLE_DTRACE -DMACOSX -DNDEBUG -Wall -Wstrict-prototypes -Wshorten-64-to-32 -DNDEBUG -g -Os -Wall -Wstrict-prototypes -DENABLE_DTRACE -pipe -Dversion_info=(1,2,3,'final',0) -D__version__=1.2.3 -I/usr/local/mysql/include -I/System/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c _mysql.c -o build/temp.macosx-10.8-intel-2.7/_mysql.o -Os -g -fno-common -fno-strict-aliasing -arch x86_64
unable to execute clang: No such file or directory
error: command 'clang' failed with exit status 1 
```

both of the following directories exist, i have no idea how to resolve the issue with clang not being able to execute...

```
/System/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7
/usr/local/mysql/include 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-03T02:11:16.953

It seems that the system is complaining about not be able to find `clang`, which is included in `Command Line Tools` of `Xcode`. Did you installed the tool as well?

Can be installed via

*   Open `Xcode`
*   Preference (`Command` + `,`)
*   `Components` under the `Download` tab

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-12T01:55:46.670

If someone is interested in a quick and easy way for Mac OS X 10.8:

I assume you have XCode, it's command line tool, Python and MySQL installed.

1.  Install PIP:

    ```
    sudo easy_install pip 
    ```

2.  Edit ~/.profile:

    ```
    nano ~/.profile 
    ```

    Copy and paste the following two line

    ```
    export PATH=/usr/local/mysql/bin:$PATH
    export DYLD_LIBRARY_PATH=/usr/local/mysql/lib/ 
    ```

    Save and exit. Afterwords execute the following command

    ```
    source  ~/.profile 
    ```

3.  Install MySQLdb

    ```
    sudo pip install MySQL-python 
    ```

    To test if everything works fine just try

    ```
    python -c "import MySQLdb" 
    ```

It worked like a charm for me. I hope it helps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T17:09:56.930

It seems that is not the only thing that you need to do, i check about the cc compiler that is not recognizing, and is not directing to the right file, googling i found that i need to change some files to found it before building, does not stop there, now that its recognizing is not charging the DYDL Libraries... it has been really hard to find a real answer just to start working with python.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-25T10:34:11.380

I finally found it says in the ReadMe to edit site.cfg and put the location of mysql_config in there.

# css - *, html 选择器是多余的吗？

> ID：11787013
> 
> 赞同：-1
> 
> 时间：2012-08-02T22:59:11.947
> 
> 标签：css, css-selectors, wildcard

我经常看到 Web 开发人员使用以下内容：

```
*, html {
    margin: 0;
    padding:0;
} 
```

但我会认为这将是多余的，因为`*`匹配所有元素。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T23:01:02.833

如果您需要更多的特殊性来保护`html`选择器上的覆盖默认样式（例如在更改字体样式的情况下），这并不是多余的。

但是，`*`将匹配一个`html`标签。

您可以在此处阅读有关[CSS 特异性](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)的更多信息。

**编辑：**

案例用法示例：

如果您在每个页面上都包含一组默认样式以覆盖包含以下内容的浏览器默认设置：

```
*,html {
   margin: 0;
   padding: 0;
} 
```

然后稍后一个不同的 css 文件碰巧在不同的情况下具有相同的选择器：

```
* {
   margin: 10px;
   padding: 0;
} 
```

然后你的`html`将不受影响，因为 a`*`对初学者没有特殊性，这意味着该规则被先前的 css 规则推翻。

我在`body`标签上添加了一个字体更改示例来演示这个概念 - [http://jsfiddle.net/M89Tn/1/](http://jsfiddle.net/M89Tn/1/)

# node.js - NodeJS 文件统计

> ID：11787016
> 
> 赞同：15
> 
> 时间：2012-08-02T22:59:17.017
> 
> 标签：node.js, fs

我不知道这是否是一个有效的问题，但是是否有文档描述了`fs.stat()`nodejs 中结果的每个属性。因为我试图找到每个属性的含义，但没有运气。

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-02T23:31:28.053

构建对象（函数）的[node_file.cc 源代码](https://github.com/joyent/node/blob/f0ce98441ff7315e6a6c268dabcec58fc37da926/src/node_file.cc#L304-L343)中的注释可以方便地帮助您解决这个问题。总结一下供参考：`stat``BuildsStatsObject`

*   `dev`: 包含文件的设备 ID
*   `ino`: 索引节点号
*   `mode`： 保护
*   `nlink`: 硬链接数
*   `uid`：所有者的用户ID
*   `gid`：所有者的组ID
*   `rdev`：设备ID（如果是特殊文件）
*   `size`: 总大小，以字节为单位
*   `atime`- 上次访问时间
*   `mtime`- 最后修改时间
*   `ctime`- 上次状态更改的时间

如果 POSIX

*   `blksize`: 文件系统 I/O 的块大小
*   `blocks`: 分配的块数

# c - 在 exec 调用中共享内存

> ID：11787017
> 
> 赞同：0
> 
> 时间：2012-08-02T22:59:16.850
> 
> 标签：c, memory, fork, shared-memory, system-calls

我知道 execve 会丢弃任何退出的动态分配的内存。我的工作是有一个 C 程序调用二进制文件，然后使用共享缓冲区与其通信。这里的关键是效率，因为缓冲区的大小相对较小，所以我想尽可能避免使用 rpc/系统调用（如 shmat 等）。

以前，我一直在 C 程序中创建缓冲区，然后使用克隆（设置了 CLONE_VM 标志），然后是对二进制文件的 exec 调用。显然这不起作用，因为 exec 替换了图像。

我不担心设置的效率如何，我的目标是一旦设置好就拥有最有效的通信系统。

除非有人有办法在同一地址空间内执行二进制文件以便他们可以共享分配的内存区域，否则我将使用 shmget 和 shmat（从已执行的二进制文件中附加共享内存）。

有没有更有效的方法来实现共享内存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:10:18.383

您问题中的问题陈述格式不正确。由于`shmat`每个 只会调用一次`exec`，因此它的成本将在整个过程的生命周期中摊销。由于在您的评论中您声明您必须`exec`使用不同的程序（目前尚不清楚为什么），因此线程已经结束。

您担心使用与`shmat`传递消息相关联的共享内存会比通过其他方式共享的某些内存产生更大的损失。这种恐惧在很大程度上是没有根据的。您可以像使用任何其他动态分配的内存一样使用共享内存，但需要注意的是，附加到它的每个进程的地址偏移量可能不同。

您没有明确说明您的要求或问题的参数，但在您的评论中您声明您希望在两个进程之间传递消息而不引起上下文切换。如果消息队列为空，这可以通过让消费者旋转等待来实现。但是，这只有在消费者和生产者在不同的处理器上运行时才有成效。

无论如何，我会考虑所有这些问题的后期优化。首先关注正确传递信息。如果性能不在可接受的水平，则找出瓶颈在哪里。

# java - 关于 A* 寻路的问题

> ID：11787021
> 
> 赞同：0
> 
> 时间：2012-08-02T22:59:46.570
> 
> 标签：java, path-finding, a-star

好吧，我正在尝试将 A* Pathfinding 实现到一个简单的 tilemap 数组中，我有几个问题。

对于打开/关闭列表，我应该只使用 arrayList 来存储它找到的所有点，还是有更好的方法来存储它们？

其次，我该如何检查邻居？我是否拿走开始牌，检查上、下、左、右，哪个成本最低？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:06:45.653

只要您没有为游戏实现此功能，即高 fps 视频游戏，我怀疑您的性能会因用作 ArrayList 而受到重大影响，那应该没问题。

至于问题的第二部分，假设每个节点只有 4 个连接方向，那么是的，对每个邻居进行简单的顺序检查就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T23:23:04.240

我在过去使用`PriorityQueue`开放列表实现了这一点。比较器对 A* 启发式值起作用。这是非常干净的，每次插入和轮询最坏的情况下，您将获得 O(log n) 性能。优于标准实现可以将轮询改进为 O(1) 摊销。对于`visited`列表，使用磁贴中的标志或单独的`HashSet`. 后者的优点是没有初始化成本，并且插入和成员资格的渐近成本相同。但是哈希的常数因子大于检查布尔映射值的常数因子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T23:16:54.817

我不知道“tilemap 数组”是什么，但我假设“找到的点”是指搜索树中的节点。存储尚未探索的节点的数据结构需要满足两个重要属性，继承自 Dijkstra 算法：

1.  获取成本最低的节点应该很快，至少 O( *n* )
2.  一旦找到更短的路径，您将希望降低节点的成本

前者可以使用*堆来实现。*二进制堆相当容易实现。斐波那契堆提供更好的渐近性能，但在大多数应用程序中不应该是必需的。到目前为止，我看到的大多数库中的堆都不支持后一个要求，通常称为*减少键。*为了实现这一点，您的节点应该保存有关它们在堆中的当前位置的信息。这样，当一个节点改变它的成本时，你可以获得它在 O(1) 中的当前位置并在 O(log *n* ) 中调整位置。您可以使用相同的变量来确定项目是否在堆中。

现在回答你的第二个问题。通常，您通过从堆中*删除*最小元素来检查成本。换句话说，对于每个邻居，您要么*将*其插入堆中，要么如果它已经在堆中，则如果新成本更好，则*调整*其成本（以及它的堆位置）。

# iphone - NSManagedObject 的 managedObjectContext 属性为 nil

> ID：11787025
> 
> 赞同：7
> 
> 时间：2012-08-02T23:00:07.050
> 
> 标签：iphone, core-data, nsmanagedobjectcontext

我正在尝试创建一个临时托管对象上下文，并且在用户输入信息的几个屏幕之后，我将该上下文与主上下文合并（以确保没有插入“不完整”的对象）。这就是我创建临时上下文以及在其中插入对象的方式：

```
if (!self.someManagedObject) {

    NSManagedObjectModel *model = [NSManagedObjectModel mergedModelFromBundles:@[[NSBundle mainBundle]]];
    NSPersistentStoreCoordinator *storeCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:model];
    [storeCoordinator addPersistentStoreWithType:NSInMemoryStoreType configuration:nil URL:nil options:nil error:nil];

    NSManagedObjectContext *managedObjectContext = [[NSManagedObjectContext alloc] init];
    [managedObjectContext setPersistentStoreCoordinator:storeCoordinator];

    self.someManagedObject = [NSEntityDescription insertNewObjectForEntityForName:@"SomeObject" inManagedObjectContext:managedObjectContext];
    NSLog(@"%@", self.someManagedObject.managedObjectContext);
} 
```

这是 的一部分`viewDidLoad`。在控制台中，它显示托管对象上下文有一个值。

但是，在这个 if 语句之后（即使在`viewDidLoad`,内`self.someManagedObject.managedObjectContext`也是 nil。我可以看到为什么局部变量不再可用（它只是超出了范围），但仍应设置托管对象的属性，对吗？

我知道我可以创建一个属性来存储托管对象上下文，但我宁愿让它以这种方式工作。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-10-19T19:16:32.773

我最近又遇到了同样的问题，尽管情况不同。我需要一个临时托管对象上下文，与主对象上下文完全分开，但我再次遇到了它在超出范围后消失的问题。这一次我决定进一步研究，我最终意识到这`managedObjectContext`不是一个属性`NSManagedObject`，而是一个方法。这意味着两件事之一：

1.  如果它在底层实现中使用一个属性，该属性[将不会持有](https://developer.apple.com/library/mac/documentation/cocoa/conceptual/coredata/articles/cdMemory.html)对上下文的强引用
2.  如果托管对象上下文是以其他方式派生的，它也不会持有对该上下文的强引用。

在任何一种情况下，上下文都没有强引用，超出范围，并且`NSManagedObject`s 有一个`nil` `managedObjectContext`.

解决方案是通过为其创建强大的属性来简单地保留上下文。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-04T11:18:12.903

我不明白为什么您需要第二个托管对象上下文。恕我直言，您正在将复杂性引入您的应用程序中，而这并不适用于任何特定目的。

将新对象插入主上下文。让用户输入他的数据。如果他中断，只需调用

```
[managedObjectContext rollback]; 
```

或者，如果用户完成并验证了所有数据，则调用

```
[managedObjectContext save:nil]; 
```

# iphone - 使用两个谓词过滤数组

> ID：11787026
> 
> 赞同：0
> 
> 时间：2012-08-02T23:00:21.680
> 
> 标签：iphone, ios, nsarray, nsdictionary, nspredicate

我想知道是否有一种方法可以使用两个filteredArrayUsingPredicates 来优化数组，目前我正在使用数组中的一个值来优化它，但是还有其他几个值......我想知道怎么做，所以我可以由两个 varaibales 精炼。

目前我正在这样做

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%K like %@",@"ISCHARGER",@"T"]; // I have another 
NSArray *filteredArray = [parsedDataArrayOfDictionaries filteredArrayUsingPredicate:predicate]; 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:54:21.447

您可以执行以下操作：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"userID == %d AND messageID == %d", currentUser, currentMessage]; 
```

希望这可以帮助，

汤姆

# c# - 在 JQuery UI 选项卡中提交/回发导致重定向

> ID：11787029
> 
> 赞同：2
> 
> 时间：2012-08-02T23:00:44.147
> 
> 标签：c#, asp.net, ajax, jquery-ui-tabs

我在 Web 应用程序菜单中使用 jQuery 选项卡。

选项卡适用于预生成的内容，但是任何触发回发/提交的内容都会离开菜单页面并重定向到内容页面。

例如 account.aspx 在 Default.aspx 页面上的选项卡中动态加载。提交更改后，它会自动将我重定向到 account.aspx。

我似乎遗漏了一些重要的东西 - 任何帮助将不胜感激。

```
The Script:
    <script type="text/javascript">
        $(document).ready(function() {
        $("#tab_Menu > ul").tabs({ remote: true, cache: true, ajaxOptions: { async: true} });

        });
    </script>

_____________________________________
The list:

<div id="tab_Menu" >
            <ul>
                <li><a href="character_menu.aspx"><span>Characters</span></a></li>
                <li><a href="account_menu.aspx"><span>Account</span></a></li>
                <li><a href="group_menu.aspx"><span>Group</span></a></li>
                <li><a href="party_menu.aspx"><span>Party</span></a></li>
                <li><a href="gm_menu.aspx"><span>GM Tools</span></a></li>
                <li><a href="Admin_menu.aspx"><span>Admin Tools</span></a></li>
            </ul>
            </div> 
```

# android - AsyncTaskLoader 如何缓存数据？

> ID：11787031
> 
> 赞同：2
> 
> 时间：2012-08-02T23:00:46.140
> 
> 标签：android, android-fragments, asynctaskloader

我有一个活动，它实现了所有这些代码所在的片段。这最好通过一个示例来解释，因为代码是机密的。这个例子反映了正在尝试做的事情以及我通过测试观察到的事情

例如）我有一个 rss 阅读器片段，它从两个具有加载器 ID（加载器 1、加载器 2）的唯一加载器中获取两个唯一对象（A、B）

```
Object A: 

int[] fullArticleIdList;
List<ArticlePreview> partialArcticlePreviewList;

Object B:

List<ArticlePreview> partialArcticlePreviewList; 
```

在创建时，我在加载器 1 上调用“initloader”来获取对象 A。滚动浏览可用文章后，它会到达从对象 A 返回的 partialArcticlePreviewList 的底部，并使用“加载器 2 上的重新启动加载器”获取更多文章，该加载器获取对象 B 并允许用户阅读它们并继续为所有文章执行此操作。

这工作正常，直到用户旋转设备从而调用 onCreate。现在当在 Loader 1 上调用 initloader 时，它在连接到 loader 1 后立即跳转到 onLoadFinished 并返回一个 Loader 1。虽然 articleIds 正确返回，但返回的 partialArcticlePreviewList 是从 Loader 2 获取对象 B 的那个。

加载器管理器是否只在缓存中保留一个对象实例并在多个加载器之间共享它？从广泛的测试（5 多个小时试图找到问题并查看 Eclipse 调试器中的加载程序 ID/缓存/地址）看来，它用加载程序 2 的部分内容预览列表中收到的数据覆盖了加载程序 1 的部分内容预览列表。虽然这种情况对于单个加载器来说是理想的，但我原以为每个加载器的缓存都是独立的。显然，加载程序的优点之一是它们易于使用，并且通过屏幕旋转和数据缓存实现持久性，但它似乎并没有像暗示的那样工作。我们'

编辑：忘了补充，我们使用的是兼容性库 v4。此外，查看加载程序的 android 源代码似乎并没有说明加载程序为何返回错误数据的“mId”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T18:34:21.520

用来规避这个问题的最终解决方案是简单地自己管理数据，而不是依赖加载器。

当加载器只为一个屏幕加载一个东西时，它们可以很好地保留数据，但是对于分页，它们创造了所有这些麻烦，并且它们的操作方式仍然没有被很好地理解；结论是它们没有按预期运行，或者我们的实现有缺陷，这只会在更高级的用例中变得明显。

为了自己管理数据，我们使用了捆绑包/保留片段的组合，同时小心地在 onDestroyView 中正确清理所有内容。我们还让加载器在旋转后执行回调时检查我们的数据集是否已经包含数据，因此我们不会将分页数据两次添加到数据集中。另一种选择是使用单例对象。

希望这对将来的其他人有所帮助。

# java - 在云中每隔几分钟运行一次 Java 应用程序的最佳方式是什么？

> ID：11787033
> 
> 赞同：1
> 
> 时间：2012-08-02T23:00:53.317
> 
> 标签：java, android, google-app-engine, amazon-ec2

我有一个 Java 应用程序，它检查数据库，从 php 文件中获取数据，并向安卓手机发送通知。在这种情况下使用什么服务最好？

我正在考虑使用 Google App Engine 并每隔几分钟运行一次 cron 作业。不知道我是否会错误地处理这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T03:18:37.397

Google App Engine 是完成这项工作的不错选择。为了做你想做的事，你需要做以下事情：

*   了解 Google App Engine Java 的基础知识和部署简单的应用程序。把它作为第一步。App Engine Java 入门指南是一个好的开始：[https ://developers.google.com/appengine/docs/java/gettingstarted/](https://developers.google.com/appengine/docs/java/gettingstarted/)

*   下一步是了解如何从 App Engine 进行网络调用（URL Fetch）。这意味着调用您的 PHP Server API。详细信息可以在这里找到：[https ://developers.google.com/appengine/docs/java/urlfetch/overview](https://developers.google.com/appengine/docs/java/urlfetch/overview)

*   现在您可以安排您的 URL Fetching 代码每隔 XX 小时运行一次，等等，或者根据 CRON 表达式在您想要的任何时间安排运行。此处介绍了编写任务：[https](https://developers.google.com/appengine/docs/java/taskqueue/) ://developers.google.com/appengine/docs/java/taskqueue/ ，您可以查看推送队列。App Engine 还为复杂的后台处理作业提供后端，但此时您可能不需要它

*   您最好接下来了解如何在 App Engine 数据存储区中存储数据。这很重要，因为您可能希望从 PHP 服务器获取数据，然后不同步发送通知，而是将它们放在数据存储中，以便它们可以由另一个任务发送/重试。通过这种方式，您可以将 Fetching 逻辑与 Notification Logic 分开，并为您提供灵活性和调试帮助。对于数据存储区指南：[https ://developers.google.com/appengine/docs/java/datastore/](https://developers.google.com/appengine/docs/java/datastore/)

*   最后，将通知推送到 Android 手机将意味着 Google Cloud Messaging。[http://developer.android.com/guide/google/gcm/index.html](http://developer.android.com/guide/google/gcm/index.html)

希望这能提供一个好的路线图。祝一切顺利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T23:06:12.440

Google App Engine 是 IMO 的有效选择，它们本机支持类似 cron 的作业，并且在大量使用配额下保持免费。Cloudbees 也是一个不错的云平台，有免费帐户，但我认为他们不提供调度选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T23:13:23.760

很难说出您要就设置的哪一部分寻求建议-尽管我认为您的意思是向 android 手机发送通知的最佳方式。答案是[Google Cloud Messaging](http://developer.android.com/guide/google/gcm/index.html)，这是 Google 提供的免费推送消息服务。

# javascript - 在 https 网站上创建 iframe

> ID：11787038
> 
> 赞同：0
> 
> 时间：2012-08-02T23:01:41.007
> 
> 标签：javascript, http, iframe, https, bookmarklet

我正在创建一个书签。基本上，它从服务器获取一段 javascript 代码，并在来自不同域的站点中创建一个 iframe。

它在http站点上运行良好，但似乎被https站点阻止，有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T12:08:28.470

只需通过 https 获取 Javascript 代码：

`https://server.com/file.js`

只需确保您在该服务器上有一个有效的 SSL 证书。

# android - GestureDetector 在 Android 2.1+ 上可用吗

> ID：11787041
> 
> 赞同：0
> 
> 时间：2012-08-02T23:02:05.690
> 
> 标签：android

我需要知道 GestureDetector 是否向后兼容 2.1 设备？在支持滑动手势方面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:10:13.400

是的。您可以看出，因为在[Gesture Detector 的 API Docs 中](http://developer.android.com/reference/android/view/GestureDetector.html)，它声明“自：API 级别 1”。

记录的每个方法还包含一行，说明它们被添加到哪个 API 级别。

# c# - 使用索引像素格式旋转图像？

> ID：11787042
> 
> 赞同：1
> 
> 时间：2012-08-02T23:02:13.570
> 
> 标签：c#, .net, image, image-processing, bitmap

我试图弄清楚如何将我的位图图像旋转任意度数，类似于[此处发布的解决方案](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/a1e62e03-d732-444d-bb3d-6e7907fd5e16/ "MSDN")。但是，当我尝试使用此解决方案（将位图转换为图形对象）以及我搜索过的其他解决方案时，我不断收到异常：

```
A Graphics object cannot be created from an image that has an indexed pixel format. 
```

我需要索引像素，以便我可以访问每个像素并在我的程序中获取颜色信息，但我还需要能够以 90 度以外的度数增量动态旋转。

我想知道 A）是否有对索引像素位图友好的解决方案，或者 B）是否有办法临时更改位图以允许将其转换为图形对象，然后将其更改回索引像素应用了旋转的位图？

提前非常感谢！

**编辑：我正在使用的位图的 PixelFormat 是“1bppIndexed”。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:23:41.073

我想您在这里使用的是 Windows 窗体和 GDI+？我已经为此做了很多工作，并且可以非常自信地告诉您您想要使用 24 位或 32 位图像（我不记得哪个对不起）。性能大大提高了大约 10 到 100 倍。在我的应用程序中，用户在文本框中指定旋转与能够用鼠标抓取图像并动态平滑旋转、动态缩放等有所不同。

假设您遵循该建议，只留下能够访问每个像素的问题。为什么您认为无法获得 24 或 32 位图像的每个像素？

编辑：在我的应用程序中，我只对所有内容使用了 32 位位图。如果我得到另一种格式的位图（例如从文件打开），我会立即转换它。实际上，即使我得到 32 位格式，我也会立即克隆它，然后处理原始位图，因为我发现它在文件上保留了一些锁。内置克隆产生了奇怪的结果，所以我最终在下面编写了这段代码。请注意，这是我大概 8 年前写的东西，所以没有使用任何最新功能：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;
using System.Drawing;
using System.Drawing.Imaging;
using System.Runtime.InteropServices;

namespace ImageCloneTest
{
    static class Program
    {
        [DllImport("kernel32", EntryPoint = "RtlMoveMemory")]
        public unsafe static extern void CopyMemory(byte* Destination, byte* Source, int Length);

        [DllImport("kernel32", EntryPoint = "RtlMoveMemory")]
        public static extern void CopyMemory(IntPtr Destination, IntPtr Source, int Length);

        public static Bitmap Clone(Bitmap SourceBitmap, PixelFormat Format)
        {
            // copy image if pixel format is the same
            if (SourceBitmap.PixelFormat == Format) return Clone(SourceBitmap);

            int width = SourceBitmap.Width;
            int height = SourceBitmap.Height;

            // create new image with desired pixel format
            Bitmap bitmap = new Bitmap(width, height, Format);

            // draw source image on the new one using Graphics
            Graphics g = Graphics.FromImage(bitmap);
            //fill background in case orig bitmap contains transparent regions.
            g.FillRectangle(Brushes.White, 0, 0, bitmap.Width, bitmap.Height);
            g.DrawImage(SourceBitmap, 0, 0, width, height);
            g.Dispose();

            return bitmap;
        }

        // and with unspecified PixelFormat it works strange too
        public static Bitmap Clone(Bitmap SourceBitmap)
        {
            // get source image size
            int width = SourceBitmap.Width;
            int height = SourceBitmap.Height;
            Rectangle rect = new Rectangle(0, 0, width, height);

            // lock source bitmap data
            BitmapData srcData = SourceBitmap.LockBits(rect, ImageLockMode.ReadOnly, SourceBitmap.PixelFormat);

            // create new image
            Bitmap dstBitmap = new Bitmap(width, height, SourceBitmap.PixelFormat);

            // lock destination bitmap data
            BitmapData dstData = dstBitmap.LockBits(rect, ImageLockMode.WriteOnly, dstBitmap.PixelFormat);

            CopyMemory(dstData.Scan0, srcData.Scan0, height * srcData.Stride);

            // unlock both images
            dstBitmap.UnlockBits(dstData);
            SourceBitmap.UnlockBits(srcData);

            // copy pallete
            if (BitmapHasPalette(SourceBitmap) && BitmapHasPalette(dstBitmap))
            {
                ColorPalette srcPalette = SourceBitmap.Palette;
                ColorPalette dstPalette = dstBitmap.Palette;
                int n = srcPalette.Entries.Length;
                for (int i = 0; i < n; i++)
                {
                    dstPalette.Entries[i] = srcPalette.Entries[i];
                }
                dstBitmap.Palette = dstPalette;
            }
            return dstBitmap;
        }

        public static bool BitmapHasPalette(Bitmap SourceBitmap)
        {
            if (SourceBitmap == null) return false;
            switch (SourceBitmap.PixelFormat)
            {
                case PixelFormat.Format1bppIndexed:
                case PixelFormat.Format4bppIndexed:
                case PixelFormat.Format8bppIndexed:
                case PixelFormat.Indexed:
                    return true;
            }
            return false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T16:25:51.930

我在这里使用了 Hans 的解决方案：[https ://stackoverflow.com/a/2016509/1464630](https://stackoverflow.com/a/2016509/1464630)

看来我仍然可以使用相同的程序逻辑，但它不再采用索引像素格式，因此 Graphics 类不会抱怨。

# ruby-on-rails-3 - 日期字段未使用 rails 3.0 保存？

> ID：11787043
> 
> 赞同：0
> 
> 时间：2012-08-02T23:02:16.830
> 
> 标签：ruby-on-rails-3

我有一个 ActiveRecord，当我点击保存时，所有记录都被保存，日期除外。

我的控制器

```
class UsersController < ApplicationController

def create
  puts params[:user]
   @user1 = User.new(params[:user])
   if @user1.save
    saveduser = User.where("fbid = ?",params[:user][:fbid])
    unless saveduser.first.nil?
    session[:user] = saveduser.first
   end
   puts "user saved "
  redirect_to "/users/dashboard"
  else
    puts "error while saving user"
  end  
 end 
```

风景

```
<h3>User Details</h3>
 <%= form_for(@user) do |f| %>
<table>
  --some columns
<tr>
  <td><%= f.label :state %></td>
  <td> <%= f.text_field :state %></td>
</tr>
<tr>
  <td><%= f.label :dob %></td>
  <td> <%= f.text_field :dob %></td>
</tr>
  <%= f.hidden_field :fbid  %>
 </table> 
  <%= f.submit %>
<% end %>
<table> 
```

在 UserController 中调用 create 方法时，在控制台中。我可以看到

```
{"username"=>"xxxx.xx.94", "firstname"=>"xxxx", "lastname"=>"Raxxstogi", "emaild"=>"xx.xxx@gmail.com", "city"=>"Los Angeles", "country"=>"USA", "state"=>"CA", "dob"=>"08/13/1983", "fbid"=>"xxx"} 
```

我的数据库表列是

`dob | date | YES | | NULL |`

它哪里出错了？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:10:05.940

您在表单中使用 a`text_field`保存到`Date`数据库中的类型字段中。尝试使用此处描述的日期助手方法：http: [//guides.rubyonrails.org/form_helpers.html#using-date-and-time-form-helpers](http://guides.rubyonrails.org/form_helpers.html#using-date-and-time-form-helpers)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T23:24:22.760

Ruby 不理解您的日期格式。您可以通过使用 显式解析日期来解决此问题[`Date::strptime`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/date/rdoc/Date.html#method-c-strptime)，也许在模型中作为 setter 方法：

```
class User < ActiveRecord::Base
  def dob=(date)
    date = Date.strptime(date, '%m/%d/%Y') if date.is_a?(String)
    write_attribute(:dob, date)
  end
end 
```

但是，我会第二次 jordanpg 建议在 Rails 中使用日期助手，除非您知道格式每次都相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T23:06:25.997

这可能是您的日期格式的问题。您可以配置活动记录以接受这种格式，也可以使用 strftime 或类似的东西将您的日期参数转换为日期对象

# php - 功能测试和外部api

> ID：11787051
> 
> 赞同：1
> 
> 时间：2012-08-02T23:03:41.417
> 
> 标签：php, testing, phpunit

我正在使用遵循 MVC 模式的框架编写一个 facebook 应用程序 - Kohna 3.2。我想测试我的服务器端代码。我决定为模型编写单元测试，并为检查控制器/视图编写功能测试。决定两者都使用 PHPUnit。

所以我很快就遇到了问题。如何在请求处理期间为使用外部 api 的控制器编写功能测试？

我不想使用真正的 api 调用。它们的执行需要很长时间，并且需要会话中的身份验证令牌，该令牌很快就会到期。还测试诸如“在墙上写帖子”之类的东西会产生大量垃圾邮件。

我真的看不出如何嘲笑这个。当然，我可以为外部 api 包装库创建一个模拟对象，但我认为应该通过创建请求并检查其响应来进行功能测试。所以我看不到可以注入模拟对象的地方..

你会怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T15:23:08.017

1）当测试**与 API 包装器一起工作的东西时**，您应该模拟整个 API 包装器类并模拟抛出异常作为错误状态并测试应用程序本身将如何对这些异常做出反应。

它可能应该停止执行一些依赖于 API 响应的操作，并且它可能应该显示一些用户友好的错误。

更重要的是，您可以（并且可能应该）测试 API 包装器上的哪些方法被调用 + 多少次以及传递了哪些参数。

```
<?php

public function testShowUser() {
    $fb = $this->getMock( 'Facebook\Api' );
    $fb->expects( $this->once() ) // if your library will call getUserInfo() more than once or never, the test will fail
        ->method( 'getUserInfo' )
        ->with( $this->equalTo( 'johndoe' ) ) // if the method will be called with different parameter, the test will fail
        ->will( $this->throwException( 'Facebook\NonExistingUser' ) );

    $myApp = new MyApp( $fb );
    $myApp->renderUser( 'johndoe' ); // if this will throw uncaught exception, the test will fail

    $this->assertEquals(
        array( 'The user you requested does not exist' ),
        $myApp->getFlashMessages()
    );
} 
```

2) 在测试**API 包装器本身**时，您可以模拟来自 API 的原始响应。

您应该将围绕 HTTP 通信的所有内容分离到某个特定的类（Curl 包装器/带有自己的单元测试/），并假设服务器返回了一些特定的 HTTP 代码和响应。

您可以将所有可能类型的响应保存在文件中，以便将它们作为响应加载到测试中。

我建议这样做：

```
<?php

/**
 * @expectedException Facebook\NonExistingUser
 */
public function testUnavailableApi() {
    $curl = $this->getMock( 'CurlWrapper' );
    $curl->expects( $this->once() )
        ->method( 'getBody' )
        ->will( $this->returnValue( file_get_contents( 'fb_404_response.json' ) ) );
    $curl->expects( $this->once() )
        ->method( 'getStatusCode' )
        ->will( $this->returnValue( 404 ) );

    $api = new Facebook\Api( $curl );
    $api->getUserInfo( 'johndoe' );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T16:39:12.460

在回顾自己未回答的问题时，我可以回答自己，使用 DIC（依赖注入容器）就是答案。它允许对测试环境进行不同的配置，或者在测试期间使用单个 PHP 进程时，甚至可以在执行测试之前设置模拟。

# php - 消除服务器端视图 | 优点缺点

> ID：11787052
> 
> 赞同：4
> 
> 时间：2012-08-02T23:03:43.173
> 
> 标签：php, javascript

我的服务器用 PHP 实现，现在只是一个数据泵。我使用 JavaScript 在客户端上编写 HTML。

**优点**

*   减少网络负载（没有 HTML，只有原始数据）
*   减少服务器负载（服务器不必编写）

**缺点**

*   增加客户端负载

鉴于这些优点/缺点，只要客户端没有负载问题，将 HTML 编写移至客户端似乎是个好主意。

有没有我没看过的角度？

**来自评论/答案**

**可能的缺点**

*   机器人可能会失败
*   屏幕阅读器可能会失败

**其他优点**

*   纯数据可随时用于新设备上的新应用程序

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T23:09:09.493

这里有一些你应该在“缺点”下列出的用户故事——还有更多。

*   我关闭了javascript，因为我有安全意识。你的网站不适合我。

*   当我使用后退按钮时，我会离开您的网站*（绕过这在技术上非常困难）* -***查看评论-这是有争议的***

*   在使用您的网站很长一段时间后，我的网络浏览器会消耗大量内存，因为它在回收由范围外对象腾出的内存方面很松懈，或者因为您的代码效率不高*（IE 特别容易出现这种情况)*

*   我使用的移动设备的 JavaScript 性能比台式机差 - 你的网站对我来说似乎很慢。

*   我使用屏幕阅读器 - 我无法理解您的网站。

*   我的名字是 GoogleBot - 您的网站不可索引。

如果这些都不打扰你 - 继续前进。

**作为旁白**

我应该补充一点——我完全*不*反对这种应用程序。如果做得好，客户体验可以超越传统的点击、GET、点击、POST、点击、GET等网站。事实上，在我目前的项目中，我一直在开发纯 JavaScript 应用程序，作为我组织网站的 QA 助手和原型。

但我们肯定不会使用我们唯一的网络存在这样的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T23:10:19.703

请定义“客户端负载”

另外，请记住，除非您设置要从同一域提供的数据，否则 JS 无法实际使用它，除非您通过 JSONP 规避 XSS

除非您在 JS 中使用模板系统，否则在 javascript 中创建 html 可能会在一段时间后进行管理，这本质上只是客户端上的 MVC。

性能：JS 比 PHP 快得多，所以我不认为 JS 的缓慢是个问题，但是，DOM 本身在与它交互时很慢，所以与 DOM 的交互越少越好。

您的想法最好的一点是，根据爬虫的说法，“页面加载”将“更快”，因为页面的同步加载才是最重要的。

但是你必须考虑到如果数据是异步填充到 dom 中的，你可能会遇到抓取内容的问题

# active-directory - SSAS 角色 - OR 而不是 AND

> ID：11787055
> 
> 赞同：2
> 
> 时间：2012-08-02T23:03:55.410
> 
> 标签：active-directory, ssas, roles, dimensions

我们使用的是 SSAS 2008。我们有一个与数据相关的权限问题。我们成功地将 SSAS 角色应用到传入用户 (Active Directory [AD]) 的上下文中。即返回的结果是基于用户的SSAS角色，并限制从基于角色的维度返回的数据。

据我所知，您可以将多个角色应用于用户，以便维度承担相关角色并限制其结果 - 但是此条件作为交集应用（即 AND） - 是否能够作为联合应用（即 OR）

有几点需要注意。
- 我们正在通过 Excel 访问我们的多维数据集，因此在某些 MDX 中依赖上述智能不一定可以实现，因为用户可以在任何维度上查询（有些可能受角色限制，而另一些则不受）
-我们玩弄了拥有的想法两个多维数据集加上每个用户两个不同的 userId（在不同的 AD 组中）；用户将根据他们想要查看的数据（以及他们将要查询的多维数据集）从 Excel 中提取数据；这很混乱，因为我们希望用户结果全部包含在一个结果集中而不是两个单独的结果集中

有没有人经历和/或解决上述问题 - 是否有可能 - 是否有替代方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T20:08:50.630

If you need a OR condition on 2 dimensions, you can add another dimension with 2 levels being the same level of the 2 initial dimension:

For instance, you want to limit the role to [Country].[France] or [Currency].[USD], then you can add a [CountryThenCurrency] dimension and allow the 2 following paths: [CountryThenCurrency].[France].[*] and [CountryThenCurrency].[*].[USD]

In other words: add dimensions in order to be able all your OR conditions in a single dimension.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T09:41:53.197

您可以将该`Roles`属性添加到 SSAS 连接字符串，该字符串包含要评估的数据库角色的逗号分隔列表。只有在该列表中应用的角色才会被服务器应用。

```
Data Source=localhost;Initial Catalog=MySSASDb;Roles=RoleA,RoleB 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-25T20:16:43.537

我一直在寻找解决这个问题的方法，并找到了 Chris Webb 的一篇很棒的文章。

[http://cwebbbi.wordpress.com/2011/12/22/replacing-cell-security-with-dimension-security/](http://cwebbbi.wordpress.com/2011/12/22/replacing-cell-security-with-dimension-security/)

这个想法是创建一个名为 DIM_Security 的垃圾维度，并将两个维度的所有不同组合放入其中。现在通过 MDX 表达式，您可以获得具有维度 1 = 'allowedvalue' 或维度 2 = 'allowedvalue' 的所有成员的 UNION，因此您具有 OR 权限。

此外，Webb 解释了如何使用动态安全性来做到这一点。

不复制所有的 MDX，因为原始帖子有好几页，有很多屏幕截图，并且在整个网络上链接了很多次。

# jquery - jquery onmouseover 和 onmouseout 不适用于 IE

> ID：11787056
> 
> 赞同：0
> 
> 时间：2012-08-02T23:04:02.943
> 
> 标签：jquery

以下代码适用于 Opera 但不适用于 IE 8

我在页面上有 dtest2 div 元素，出于测试目的，我试图在图像的 mouseover 和 mouseout 事件上更改 div 元素的内容。

html:

```
 <a ><img  title='' class='imgclass' src='images/image1.jpg'  onmouseover="f1('1')"  onmouseout="f2('1');"    ></a> 
```

查询：

```
function f1(id)
{   

 $('#dtest2').html("Test "+id);
}
    function f2(id)
{   
        $('#dtest2').html("Test 2 "+id);
} 
```

使用 Opera 它可以正常工作。使用 IE 它可以工作 1 次或几次，然后停止工作。IE的任何特定命令？

这些图像来自数据库，id 是数据库中的唯一编号。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:09:29.703

你在这里混合了你的习语。它应该仍然可以工作，但您可能会通过“jQuery 方式”处理事情获得更好的结果（并且绝对是更整洁的代码），这涉及将代码与 HTML 分离。

所以，首先是 HTML：

```
<a>
    <img title='' class='imgclass' src='images/image1.jpg'>
</a> 
```

它与您拥有的相同，没有`onMouseOver`and`onMouseOut`属性。

现在，jQuery，最好放在一个单独的文件中，您可以使用它`<script src="url.js" type="text/javascript"></script>`来加载。

```
$('img.imgclass').hover(function() {
    $('#dtest2').html('Test');
}, function() {
    $('#dtest2').html('Test2');
}); 
```

jQuery 的主要优点之一是它旨在平滑所有浏览器的不兼容性，因此您只需要为所有浏览器编写一个代码。

至于`id`你想要传递给你的函数的，这有点棘手。这个数字是从哪里来的，它是什么意思？这将影响如何处理。

如果不出意外，您可以使用 HTML5`data-`属性将其包含在 HTML 中，如下所示：

```
<a>
    <img title='' class='imgclass' src='images/image1.jpg' data-hover-id="1">
</a> 
```

然后，您可以通过对 jQuery 进行以下更改来检索它：

```
$('img.imgclass').hover(function() {
    var id = $(this).data('hover-id');
    $('#dtest2').html('Test ' + id);
}, function() {
    var id = $(this).data('hover-id');
    $('#dtest2').html('Test2 ' + id);
}); 
```

编辑已编辑的问题：由于它们是来自数据库的唯一 ID，因此将它们用作`id`. `img`但是，您不应该使用纯数字`id`s。因此，无论您使用什么从数据库中提取 ID，都应该在前面加上一些东西，也许只是`i`或`img`.

然后你的 HTML 看起来像

```
<img id="i1" title="" src="images/image1.jpg"> 
```

并且您的 jQuery 可以使用`$(this).attr('id')`而不是`$(this).data('hover-id')`.

# java - AutoCompleteTextView 背景/前景色

> ID：11787057
> 
> 赞同：12
> 
> 时间：2012-08-02T23:04:05.583
> 
> 标签：java, android, xml

我正在研究 AutoCompleteTextView。它工作正常，但下拉文本始终是白色背景上的白色文本。这张照片解释了我的问题

图片解释我的问题

![在此处输入图像描述](../Images/93061ce696de6cdb677506123c37ddc2.png)

XML:

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#000"
    >
    <!-- <AutoCompleteTextView  -->
    <AutoCompleteTextView
        android:id="@+id/text"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"
        android:hint="Tapez votre 1texte"
        android:textColor="#000"        
        />
</LinearLayout> 
```

爪哇：

```
view = (AutoCompleteTextView)findViewById(R.id.text);        
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_dropdown_item_1line,data);
adapter.setDropDownViewResource(R.drawable.ic_action_search);//dd
view.setAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-03T01:09:40.217

如果您想更改下拉项的外观，请更改您传递给 ArrayAdapter 的 XML 布局（在您的情况下是`android.R.layout.simple_dropdown_item_1line`）。

让我们创建一个名为`my_list_item.xml`in的新布局`res/layout`：

```
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/text1"
    style="?android:attr/dropDownItemStyle"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:padding="5dp"
    android:textAppearance="?android:attr/textAppearanceMediumInverse"
    android:textColor="#00f" /> 
```

此文本较小、呈蓝色且居中。我不推荐使用这种布局，更多的是为了证明你可以自定义它。

现在改用这个：

```
view = (AutoCompleteTextView)findViewById(R.id.text);        
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.my_list_item, data);
view.setAdapter(adapter); 
```

当您在此处设置属性时（如文本颜色）：

```
<AutoCompleteTextView
    android:id="@+id/text"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"
    android:hint="Tapez votre 1texte"
    android:textColor="#000"        
    /> 
```

您只是更改下拉列表上方的框（您在与 AutoCompleteTextView 交互之前看到的框）。希望有帮助！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-05-31T10:39:14.643

这个问题可能很老，但我相信这对我来说非常重要。我遇到了与 OP 相同的问题，但这是因为我使用 'getApplicationContext()' 代替了 'this'

**错误的**

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>
                (getApplicationContext(), android.R.layout.simple_list_item_1, PLACES); 
```

**正确的**

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>
                (this, android.R.layout.simple_list_item_1, PLACES); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-14T16:17:55.710

I tried setting up the theme before setcontext, tried different resources parameter in arrayAdapter and tried different theme ,but nothing helped.

Then I changed the context from 'this' to 'getApplicationContext' but the problem was persistent.

Finally I changed the context parameter to "getBaseContext()" and the problem was solved.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T10:02:32.587

一个棘手的解决方案是：添加这一行 **setTheme(android.R.style.Theme);** 之前`setContentView()`在您的自动完成文本视图所在的活动文件中。让我知道这个是否奏效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-03T13:11:24.513

由 didldum 回答[https://code.google.com/p/android/issues/detail?id=5237](https://code.google.com/p/android/issues/detail?id=5237)

通过扩展主题并覆盖键入文本和建议文本的 2 种样式的解决方法：

1.  在清单中使用扩展主题： ... ...

2.  创建使用固定样式的新主题 (res/values/themes.xml)： ... @style/AutoCompleteTextViewLight @style/Widget.DropDownItemLight ...

3.  创建固定颜色的样式（res/values/styles.xml）： ... @android:color/primary_text_light @android:color/primary_text_light

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-11T06:35:01.427

我在选择“select_dialog_singlechoice `ArrayAdapter<String > s1= new ArrayAdapter<String> (this,android.R.layout.select_dialog_singlechoice,state);`[enter image description here ”的布局中得到了我的解决方案](http://i.stack.imgur.com/Q9O2f.png)

而不是获取应用程序上下文在 ArrayAdapter<> 中写入“this”；

尝试使用不同的布局你肯定会解决你的查询

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-13T14:01:37.853

我通过一个简单的棘手方式解决了这个问题，

**只需将您在 AndroidManifest.xml 中声明的活动主题更改为**，

```
 <activity
   android:name=".YourActivity"
            android:configChanges="keyboardHidden|orientation|screenSize"
            android:theme="@style/Theme.AppCompat.Light.NoActionBar"
            android:windowSoftInputMode="stateHidden"></activity> 
```

**并在活动中如下**，

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>
                (getActivity(), android.R.layout.select_dialog_item, arraylist); 
```

# ios - UISplitViewController 和 OpenGLES

> ID：11787067
> 
> 赞同：0
> 
> 时间：2012-08-02T23:05:13.477
> 
> 标签：ios, ipad, opengl-es, uisplitviewcontroller

如何在 iPad 的 UISplitViewController 应用程序的详细视图控制器内呈现 OpenGLES 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T03:34:23.123

这没有真正的技巧，您只需要创建一个由 CAEAGLLayer 支持的 UIView，就像您对任何其他 OpenGL ES 渲染所做的那样，并将该视图放置在您的详细视图控制器中。然后，在这种情况下，您可以像对待其他任何情况一样对待细节视图控制器，命令控制器根据左侧列表的选择更改替换 3-D 模型。

如果你想要一个这样的例子，你可以从[这里](http://www.sunsetlakesoftware.com/molecules)下载我的 Molecules 应用程序的源代码，我在拆分视图控制器的详细信息部分的 OpenGL ES 托管视图中显示分子模型，然后更改显示的模型作为响应从拆分视图的其他部分进行选择。

# objective-c - 将一个 UItableView 连接到另一个 UITableView

> ID：11787075
> 
> 赞同：0
> 
> 时间：2012-08-02T23:06:36.437
> 
> 标签：objective-c, xcode, model-view-controller, segue

我不确定当你有多个 MVC 项目时你必须分开什么。假设我有两个表格视图控制器，第一个显示一个表格，当我单击一个单元格时，它会连接到第二个表格视图控制器。表的信息是使用名为 FlickrFetcher 的第三个单独文件中的方法创建的。第一个表 View 有一个 FlickrFetcher 创建的实例，允许它调用方法。我是否也可以将 FlickrFetcher 导入到第二个表视图控制器中，还是应该将这些控制器分开并仅通过 segue 传递所需的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:47:07.897

就语言允许的内容而言，您当然可以在第二个表视图控制器中拥有 FlickrFetcher 类的实例，或者当您继续时，您可以将对同一类实例的引用从您的第一个视图控制器传递给您的第二。否则，最好的办法是仅通过 segue 从 FlickrFetcher 传递第二个视图控制器所需的特定信息（这取决于您在第二个视图控制器中需要多少）。这主要取决于您，但通过 segue 传递可能更有效，并且在语义上更有意义。希望这能回答你的问题

# php - 相对模板中的 PHP 微秒

> ID：11787077
> 
> 赞同：0
> 
> 时间：2012-08-02T23:06:47.110
> 
> 标签：php, reference, seconds, datetime

我有一个日期时间对象，我想修改微秒。我正在使用以下代码。

```
 $datesArray[$alreadyDoneIndices+$countIndices]->modify("+$microsecondIncrementAmount mseconds"); 
```

我收到以下错误消息。

```
DateTime::modify() [datetime.modify]: Failed to parse time string (+38462 microseconds) at position 3 (4): Unexpected character in C:\xampp\htdocs\DynamicUpdating\timelineUpdater.php on line 147 
```

什么不工作？如果这是问题，是否有关于我在 php 中工作的相对时间戳的参考？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:12:50.527

只需在 modify("+$microsecondIncrementAmount mseconds") 中查看 mseconds 错误信息告诉你时间字符串错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:14:27.890

```
$datesArray[$alreadyDoneIndices+$countIndices]->modify("+{$microsecondIncrementAmount} mseconds"); 
```

注意 {}

# javascript - 具有特定给定 URL 的 Java 脚本 window.print()

> ID：11787087
> 
> 赞同：0
> 
> 时间：2012-08-02T23:08:12.990
> 
> 标签：javascript, asp.net-mvc

我在我的 asp.net mvc 2.0 视图中创建了报告，然后我想使用链接或按钮打印出该视图。但在视图中包括页眉、页脚以及搜索每条记录的结果的内容。我想让用户在我的视图中看到他们想要打印的内容，然后他们可以单击打印。

我正在使用这个：

```
function printChart() {
  var URL = "EvaluatingReport";
  var W = window.open(URL);
  W.window.print();
} 
```

但它再次打开 URL。谁能告诉我如何指定网址`window.print()`？

先谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:29:25.290

添加一个打印样式表来隐藏您不想打印的元素。

这个和其他建议也可以在[MDN](https://developer.mozilla.org/en-US/docs/Printing)上找到。

# java - 来自另一个 java 项目的 toString 打印类型名称

> ID：11787093
> 
> 赞同：0
> 
> 时间：2012-08-02T23:08:24.337
> 
> 标签：java, project, tostring

所以我知道关于覆盖“toString”来查看你想要什么而不是类型的事情，但在我的情况下，整体情况是：

`Project1:ClassA`使用`Project2:ClassB`我包含`Project2`在`Project1`类路径中的地方，编译工作正常。但是，`Project2:ClassB.toString()`打印`project2.package.classC`而不是classB的classC元素。

请注意，一旦我将 classB 复制到 project1 中，打印工作正常并且我看到了元素。

这是我在当前 project1 中使用的 project2 中的 classB 的快照：

```
package edu.cs;
public class FeatureWeightArrayWritable implements Writable {//classB

    public int vectorSize;
    public FeatureWeight[] vector; //classC = FeatureWeight

    @Override
    public String toString() {
        StringBuilder buffer = new StringBuilder();
        for (int i = 0; i < this.vectorSize; i++)
            buffer.append(vector[i].feature + " " + vector[i].weight);
        // return buffer.toString();
        return "Can't see this !!! I see edu.cs.FeatureWeight@32829 ";
    }
} 
```

如果你怀疑`FeatureWeight`类，我也会覆盖它的 toString，但如果我有上面的返回消息，它甚至不应该被使用。有什么线索吗？

这是我的阅读方式：

```
Reader reader = new SequenceFile.Reader(fs, inputPath, conf);

Writable key = (Writable) reader.getKeyClass().newInstance();
FeatureWeightArrayWritable value = new FeatureWeightArrayWritable();

while (reader.next(key, value))     
    System.out.println("key:" + key.toString() + ", value:" + value.toString()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:56:25.410

检查您的类路径，并确保您没有另一个副本（旧的类文件、jar 文件、第三个项目等）`FeatureWeightArrayWritable`放置在某个地方。

# security - 限制向连接到 TFS 的用户显示的集合

> ID：11787095
> 
> 赞同：0
> 
> 时间：2012-08-02T23:08:50.153
> 
> 标签：security, tfs

当用户通过 Visual Studio Team Explorer 连接到 TFS 地址时，他们输入 TFS 地址，登录后他们可以看到所有集合以及这些集合下的所有团队项目。

有没有办法告诉 TFS 哪些用户在连接到服务器时可以看到哪些集合，这样不是每个人都可以看到所有内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:15:36.007

如果用户不是集合中任何项目中任何组的成员，则他们不应看到列出的集合。

尝试从您不希望他们看到的集合中的所有项目中删除用户，并且不应将其列出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T18:19:03.337

您需要从您授予的任何集合访问权限中删除 VALIDUSERS，并将项目级别的每个用户添加为贡献者

# arrays - 堆栈溢出和种子

> ID：11787096
> 
> 赞同：0
> 
> 时间：2012-08-02T23:08:53.010
> 
> 标签：arrays, stack-overflow, seed

我有一个程序程序，可以从种子中创建一个谜题。像往常一样，这个种子是从系统时间派生的，如果我想重新访问它，我会用它来调试一个特定的谜题。不过最近经常出现错误“IceMaze.exe 中发生了'System.StackOverflowException' 类型的未处理异常。程序中的索引大大超出了它所绑定的数组的边界。然后我检查了跟踪点我放入VC++并从中得出种子编号。奇怪的是，在我输入种子并运行程序后，它没有任何缺陷并且索引在范围内。虽然我无法给出任何代码，但是否有任何一般性问题在这种情况下可能会发生这种情况？

# knockout.js - 淘汰制映射插件提供什么

> ID：11787103
> 
> 赞同：1
> 
> 时间：2012-08-02T23:09:40.197
> 
> 标签：knockout.js

如果我在使用敲除映射插件时有一个看起来像这样的视图模型。该插件是否还连接了添加/删除方法（或任何其他功能）或者它是纯粹的可观察的

```
var viewModel = {

    var self = this;

    foos: ko.mapping.fromJS([]),
    loadInitialData: function() {
        ko.mapping.fromJS(serverData, dataMappingOptions, viewModel.foos);        
    },
    loadUpdatedData: function() {
        ko.mapping.fromJS(serverData, dataMappingOptions, viewModel.foos);        
    }        
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T02:24:41.680

映射插件没有专门为结果视图模型添加任何附加功能。它确实增加了映射插件创建的 observableArrays，增加了一些与“键”（[http://knockoutjs.com/documentation/plugins-mapping.html#mapped_observable_array](http://knockoutjs.com/documentation/plugins-mapping.html#mapped_observable_array)）一起使用的附加功能。

此外，映射插件允许您指定映射选项来控制对象的创建方式 ( [http://knockoutjs.com/documentation/plugins-mapping.html#customizing_object_construction_using_create](http://knockoutjs.com/documentation/plugins-mapping.html#customizing_object_construction_using_create) )，您可以使用它来添加额外的函数或计算的 observables。

# jquery - 为什么 $(' ').text(value).text(); 不转义 HTML？

> ID：11787106
> 
> 赞同：1
> 
> 时间：2012-08-02T23:09:53.483
> 
> 标签：jquery, html, encoding, escaping

我试图了解 html 编码和解码如何在浏览器和 jQuery 中工作。我知道该`$('<div/>').text(myString)`函数会将任何 < 和 > 以及其他一些字符编码为相应的 html 实体。因此

```
"<a>" =>"&le,a&gt;" 
```

但是如果我再次调用 text() 会怎样，如下所示：

```
$('<div/>').text(myString).text() 
```

这似乎再次解码了字符串，与此相反：

```
$('<div/>').text(myString).html() 
```

这是为什么？为什么第二次调用 text() 会破坏 html 编码？也许我关于如何逃避哪个上下文的心理模型是错误的。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:40:54.397

使用 jQuery 检索元素或节点的文本在 jQuery 内部`.text()`使用 DOM 属性`.textContent`或`.innerText`（取决于浏览器/版本）并返回浏览器为此返回的任何内容。

`.text()`是，根据定义不应该返回 HTML。它应该只返回元素或节点的文本内容。如果有子节点（例如 HTML），则`.text()`返回文本节点的串联并忽略 HTML 节点。

如果你调用`.text(someText)`并传递一些文本，那么 jQuery 会这样做：

```
return this.empty().append( (this[0] && this[0].ownerDocument || document).createTextNode( text ) ); 
```

在这里，您可以看到它接受文本并将其作为参数传递给 createTextNode，因此文本直接传递给浏览器以进入单个文本节点，而不是被解释为 HTML。

# java - Java 的代码覆盖率：死的还是付费的？

> ID：11787110
> 
> 赞同：4
> 
> 时间：2012-08-02T23:10:18.643
> 
> 标签：java, code-coverage, cobertura, emma, clover

我正在寻找有关代码覆盖率工具的答案。我知道之前有人问过这个问题的变化：

*   [https://stackoverflow.com/questions/3904571/code-coverage-tools-in-java](https://stackoverflow.com/questions/3904571/code-coverage-tools-in-java)
*   [https://stackoverflow.com/questions/39329/what-is-your-favourite-code-coverage-tools-free-and-non-free](https://stackoverflow.com/questions/39329/what-is-your-favourite-code-coverage-tools-free-and-non-free)
*   [Java中的代码覆盖工具](https://stackoverflow.com/questions/1518362/code-coverage-tools-in-java)
*   [是否有任何方便的代码覆盖工具可与 JUnit 一起使用？](https://stackoverflow.com/questions/5269636/is-there-any-handy-code-coverage-tool-to-be-used-with-junit)

所以这可能是一个可怕的问题。但在大多数情况下，这些问题已经存在*多年*了，我正在寻找是否有任何新工具出现。

我知道：

*   [科贝图拉](http://cobertura.sourceforge.net/)
*   [艾玛](http://emma.sourceforge.net/)/ [EclEmma](http://www.eclemma.org/)
*   [三叶草](http://www.atlassian.com/software/clover/overview)
*   [语义设计](http://www.semanticdesigns.com/Products/TestCoverage/)。

但据我所知（见下文），这两个开源项目基本上已经死了。付费解决方案是一种选择，但如果可能的话，我更喜欢开源。

开源是否基本上放弃了创新代码覆盖软件，或者是否将精力投入到一些我不知道的新库中？

**科贝图拉**

```
Latest version: 1.9.4.1, released 3/3/2010
Last commit: 1/7/2011 
```

**艾玛**

```
Latest version: 2.1.5320, released 6/22/2005
Last commit: (uses CVS, so there are no changesets, but commits are 6-8 years old)
Developer forums have only a handful of posts 
```

**三叶草**

```
Latest version: 3.1.5, released 4/25/2012 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-03T01:57:09.813

有一个开源代码覆盖工具，最近一直在积极更新。

JaCoCo [http://www.eclemma.org/jacoco/](http://www.eclemma.org/jacoco/)

它是由 EclEmma 团队开发的，而 SONAR 是近几年来支持它的。对我来说听起来很有希望。

# html - 位置：绝对和自动宽度槽内容

> ID：11787112
> 
> 赞同：0
> 
> 时间：2012-08-02T23:10:33.857
> 
> 标签：html, css

我在容器中创建了一个小工具提示。所以有两个 div 都带有`position: absolute;`. 它们必须是绝对位置，否则会弄乱整个设计。

```
.container_1 {
     position: absolute;
     top: 20px;
     left: 20px;
}

.container_2 {
     position: absolute;
}

<div class="container_1"><div class="container_2">Full Name-Name</div></div> 
```

我在第一个容器中也有一个 CSS 三角形，所以这就是为什么有两个容器。

在工具提示中显示了用户的全名。但是现在我遇到的问题是 div 没有内容那么宽。所以我通过用替换空间来修复它，`&nbsp;`但现在破折号也存在同样的问题。但问题并不能通过将破折号替换为`&ndash;`. 有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T23:15:09.547

CSS：

```
.container_1 {
    position: absolute;
    top: 20px;
    left: 20px;
}

.container_2 {
    position: absolute;
    width: 95px;
    overflow: hidden;
    white-space: nowrap;
} 
```

[http://jsfiddle.net/yG5eF/](http://jsfiddle.net/yG5eF/)

**编辑**：对不起，第一次完全看错了。

# ubuntu - Python 3，Scrypt 模块，哈希不匹配

> ID：11787120
> 
> 赞同：2
> 
> 时间：2012-08-02T23:11:19.587
> 
> 标签：ubuntu, python-3.x, scrypt

使用：Python 3.2.3、scrypt 0.5.5 模块、Ubuntu 12.04

我很好地安装了 scrypt 模块。我很好地在页面上运行了示例代码。我还找到了[示例代码的扩展版本](http://aleccolocco.blogspot.com/2011/09/how-to-protect-passwords-with-python.html)，它也做得很好。但是我想测试它是否会两次对同一个单词进行哈希处理，所以我添加了对 Encrypt() 的部分调用，以模拟对数据库进行一次哈希处理，然后在用户登录时再次进行哈希处理的概念，所以我的完整代码看起来像这样：

```
import random,scrypt

class Encrypt(object):

    def __init__(self):
        pass

    def randSTR(self,length):
        return ''.join(chr(random.randint(0,255)) for i in range(length))

    def hashPWD(self,pwd, maxtime=0.5, datalength=64):
        return scrypt.encrypt(self.randSTR(datalength), pwd, maxtime=maxtime)

    def verifyPWD(self,hashed_password, guessed_password, maxtime=0.5):
        try:
            scrypt.decrypt(hashed_password, guessed_password, maxtime)
            return True
        except scrypt.error:
            return False

if __name__ == '__main__':
    e = Encrypt()
    user_pw = 'theansweris42'
    user_salt = 't9'
    pw_salt = user_pw + user_salt
    hashed_pw = e.hashPWD(pw_salt) # To be stored len()==192
    y = e.verifyPWD(hashed_pw, pw_salt)              # True
    n = e.verifyPWD(hashed_pw, 'guessing'+ pw_salt)  # False
    print(y)
    print(n)
    #print("Hash: %s" % (hashed_pw))

    x = Encrypt()
    user_pw2 = 'theansweris42'
    user_salt2 = 't9'
    pw_salt2 = user_pw2 + user_salt2
    hashed_pw2 = x.hashPWD(pw_salt2) # To be stored len()==192
    y2 = x.verifyPWD(hashed_pw, hashed_pw2)              # True
    print(y2)
    print(pw_salt)
    print(pw_salt2)
    print(hashed_pw)
    print(hashed_pw2) 
```

...如您所见，我还对盐进行了硬编码（用于测试）。奇怪的是，每次我运行它时， hashed_pw 和 hashed_pw2 总是不同的。为什么每次对相同的密码进行不同的哈希处理？每次我给它完全相同的输入时，它不应该输出相同的哈希吗？我一直在尝试解决这个问题一个小时，所以我想我最好问一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T04:04:35.297

您使用相同的密码（加上盐）加密两个不同的随机字符串。这将导致两个不同的输出。

这里使用的技巧是密码+盐可用于解密该随机字符串，而错误的密码会引发错误。因此，您不需要存储原始随机字符串以确保密码正确，并且由于使用的字符串是随机的（在随机数生成器的范围内），因此破解密码将非常困难。

# wcf - 通过 WCF 调用第三方安全 Web 服务 - 身份验证问题

> ID：11787124
> 
> 赞同：2
> 
> 时间：2012-08-02T23:11:46.617
> 
> 标签：wcf, https

我正在使用 Visual Studio 2010 中的 WCF 针对供应商的 Web 服务编写客户端。我无法更改它们的实现或配置。

在他们的测试服务器上运行安装，我没有问题。我从他们的 wsdl 添加了一个服务引用，在代码中设置了 url，然后进行了调用：

```
var client = new TheirWebservicePortTypeClient();
client.Endpoint.Address = new System.ServiceModel.EndpointAddress(webServiceUrl);

if (webServiceUsername != "")
{
    client.ClientCredentials.UserName.UserName = webServiceUsername;
    client.ClientCredentials.UserName.Password = webServicePassword;
}

TheirWebserviceResponse response = client.TheirOperation(myRequest); 
```

简单明了。直到他们将其移至生产服务器并将其配置为使用 https。然后我得到了这个错误：

```
The HTTP request is unauthorized with client authentication scheme 'Anonymous'. The authentication header received from the server was 'Basic realm='. 
```

所以我去寻求帮助。我发现了这个：[Can not call web service with basic authentication using wcf](https://stackoverflow.com/questions/1365163/can-not-call-web-service-with-basic-authentication-using-wcf)。

批准的答案建议这样做：

```
BasicHttpBinding binding = new BasicHttpBinding();

binding.SendTimeout = TimeSpan.FromSeconds(25);

binding.Security.Mode = BasicHttpSecurityMode.Transport;
binding.Security.Transport.ClientCredentialType = 
                              HttpClientCredentialType.Basic;

EndpointAddress address = new EndpointAddress(your-url-here);

ChannelFactory<MyService> factory = 
             new ChannelFactory<MyService>(binding, address);

MyService proxy = factory.CreateChannel();

proxy.ClientCredentials.UserName.UserName = "username";
proxy.ClientCredentials.UserName.Password = "password"; 
```

这似乎也很简单。除了我试图找出从 wsdl 生成的众多类和接口中的哪一个来进行服务引用之外，我应该使用上面的“MyService”来代替。

我的第一次尝试是使用“TheirWebservicePortTypeClient”——我在之前的版本中实例化的类。这给了我一个运行时错误：

```
The type argument passed to the generic ChannelFactory class must be an interface type. 
```

所以我深入研究了生成的代码。我看到了这个：

```
public partial class TheirWebservicePortTypeClient
:
    System.ServiceModel.ClientBase<TheirWebservicePortType>, 
    TheirWebservicePortType
{
    ...
} 
```

所以我尝试用他们的WebservicePortType 实例化ChannelFactory<>。

这给了我编译时错误。生成的代理没有 ClientCredentials 成员或 TheyOperation() 方法。

所以我尝试了“System.ServiceModel.ClientBase”。

实例化 ChannelFactory<> 仍然给我编译时错误。生成的代理确实有一个 ClientCredentials 成员，但它仍然没有 TheyOperation() 方法。

那么，什么给了？如何从 WCF 客户端将用户名/密码传递给 HTTPS Web 服务？

==================== 编辑解释解决方案====================

首先，按照建议，使用TheyWebservicePortType 实例化工厂，将用户名和密码添加到factory.Credentials，而不是proxy.ClientCredentials 工作正常。除了一点混乱。

也许这与编写 wsdl 的奇怪方式有关，但是客户端类TheyWebservicePortTypeClient 将TheyOperation 定义为接受一个请求参数并返回一个响应结果。他们的WebservicePortType 接口将他们的操作定义为接受一个他们的操作输入参数并返回一个他们的操作输出结果，其中他们的操作输入包含一个请求成员，他们的操作输出包含一个响应成员。

在任何情况下，如果我从传递的 Request 构造了TheyOperation_Input 对象，则对代理的调用成功，然后我可以从返回的 TheyOperation_Output 对象中提取包含的 Response 对象：

```
TheirOperation_Output output = client.TheirOperation(new TheirOperation_Input(request));
TheirWebserviceResponse response = output.TheirWebserviceResponse; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T07:24:06.617

您将凭据添加到 ChannelFactory Credentials 属性

# objective-c - 加载需要凭据的 stringWithContentsofURL

> ID：11787130
> 
> 赞同：0
> 
> 时间：2012-08-02T23:12:24.593
> 
> 标签：objective-c, ios, xcode, login, nsdata

我正在尝试解析 HTML 页面，但该页面需要用户名/密码才能访问数据。如何将凭据传递给服务器，以便将网页加载到我的 NSData 对象中？

*更新下面的评论*

通常，如果您使用的是网络浏览器，它会弹出一个登录窗口供您输入凭据。当我在 iOS 中执行它时，它没有给我任何东西。

非常感谢！艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:41:09.040

您可以使用`ASIFormDataRequest`. 看看[这里](http://allseeing-i.com/ASIHTTPRequest/How-to-use)

```
 NSURL *tempUrl = [NSURL URLWithString:@"http://www.yoursitetoparse.com"];

    ASIFormDataRequest *request = [[ASIFormDataRequest alloc] init];

    request = [ASIFormDataRequest requestWithURL:tempUrl];

    [request setDelegate:self];
    [request setRequestMethod:@"POST"];
    [request setUsername:@"username"]; //Username
    [request setPassword:@"password"]; //Password

    [request startAsynchronous]; 
```

它是委托方法：

```
-(void)requestFailed:(ASIHTTPRequest *)request
{
    NSError *error = [request error];
    NSLog(@"Failed %@ with code %d and with userInfo %@",[error domain],[error code],[error userInfo]);

}

-(void)requestFinished:(ASIHTTPRequest *)request

{

    NSLog(@"Finished : %@",[theRequest responseString]);     

} 
```

# jquery - 使用jQuery隐藏基于包含文本的按钮

> ID：11787131
> 
> 赞同：1
> 
> 时间：2012-08-02T23:12:30.450
> 
> 标签：jquery

我正在寻找使用 jQuery 隐藏包含文本“立即购买”的按钮。此按钮位于包含 div 中。

基本上是这样的：

```
$("button contains('Buy Now').parent('div').hide(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T23:14:11.497

你是这个意思：

API：[http ://api.jquery.com/contains-selector/](http://api.jquery.com/contains-selector/)

希望它符合原因，`:)` **或者** [http://jsfiddle.net/DDv8a/](http://jsfiddle.net/DDv8a/)试试这个**演示**

**代码**

```
$("button:contains('Buy Now')").parent('div').hide(); 
```

**或者**

```
$(document).ready(function () {
   $("input[value='Buy Now']").closest('div').hide();
}); 
```

​</p>

# perl - 从 Google 洞察下载 .csv 文件以使用 Perl 进行搜索时出现问题

> ID：11787132
> 
> 赞同：0
> 
> 时间：2012-08-02T23:12:42.110
> 
> 标签：perl

我正在尝试使用**perl**从**谷歌洞察力下载 .csv 文件进行搜索**。但是我遇到了两个问题：

1.  下载 URL 似乎是重定向 URL，所以我无法使用 LWP 模块下载它。该网址是“ *http://www.google.com/insights/search/overviewReport?q=dizzy&date=1%2F2012%205m&cmpt=date&content=1&export=1* ”。您可以尝试一下，可能应该先登录。

2.  看来我必须在下载之前存储会话。如果不这样做，我会收到警告——比如“达到配额限制”。

如何使用**PERL**自动下载此 .csv 文件？谢谢您的帮助。

这是我的代码：

```
#create userAgent object
my $ua = LWP::UserAgent->new;
$ua->agent("MyApp/0.1 ");

#create a request
my $req = HTTP::Request->new(GET => 'http://www.google.com/insights/search/overviewReport?q=dizzy&date=1%2F2012%205m&cmpt=date&content=1&export=1');

my $res = $ua->request($req);

#check the outcome of the response
if($res->is_success) {
    print $res->content;
}
else {
    print $res->status_line, "\n";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:07:27.297

我强烈建议您使用 WWW::Mechanize 进行网络自动化（这是高级 LWP::UserAgent）：

```
#!/usr/bin/perl

use strict;
use warnings;
use WWW::Mechanize;

my $mech = WWW::Mechanize->new();
$mech->agent_alias("Windows IE 6");

$mech->get("https://accounts.google.com/serviceLogin");
$mech->submit_form(

    form_id => "gaia_loginform",
    fields => {

        Email => 'gangabass@gmail.com',
        Passwd => 'password',
    },
    button => "signIn",
);

$mech->get("http://www.google.com/insights/search/overviewReport?q=dizzy&date=1%2F2012%205m&cmpt=date&content=1&export=1");
open my $fh, ">:encoding(utf8)", "report.csv" or die $!;
print {$fh} $mech->content();
close $fh; 
```

# objective-c - 不明白出了什么问题，得到EXC_BAD_ACCESS，有什么提示吗？

> ID：11787133
> 
> 赞同：0
> 
> 时间：2012-08-02T23:12:44.320
> 
> 标签：objective-c, memory-management, cocos2d-iphone

我在它的 init 方法中有这个精灵

```
lineDrawer = [[LineDrawer alloc]initWithLineColor:ccc3(color.r, color.g, color.b)];
lineDrawer.position = ccp(0,0);
lineDrawer.anchorPoint = ccp(1,1);

[self addChild:lineDrawer];
[self addChild:head];

[lineDrawer release]; 
```

这里没有错吧？我可以在 addchild 保留对象时释放它。（自动释放也可以）

虽然当我发布后，我会得到 EXC_BAD_ACCESS(code=1) 。我也尝试将发布移动到 dealloc 方法，但它给了我同样的错误。

唯一引用 lineDrawer 的对象是它*定义*的 spriteobject (Player : CCSprite) ，它没有 getter，所以它甚至不能被另一个对象访问，所以我不明白这是怎么发生的。什么时候可以调用 lineDrawer 当只有所有者引用它时它被释放了？

它发生在 CCLayer 的 draw 方法中的 CC_NODE_DRAW_SETUP() 行。

有什么提示吗？我知道这些问题总是因为缺少代码而很难解决，但是很难知道要向您展示什么代码。如果我知道我可能会自己解决它。我也尝试在仪器中调试它，但我不知道在哪里看。

**更新**，我尝试在启用僵尸的情况下进行调试

![这是结果](../Images/3ba3732f96209560ab35e448416b2451.png)

这对你有什么影响吗？这是 LineDrawer 类。这是我稍微修改过的其他人的课程。

[http://pastebin.com/7Uv4GULy](http://pastebin.com/7Uv4GULy)
[http://pastebin.com/08NHeVt9](http://pastebin.com/08NHeVt9)

我有一种感觉，它是某种预定的方法或其他东西..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:25:06.963

由于您将`lineDrawer`对象添加到 的子集合中，因此可以通过 中定义的属性`CCSprite`获得对它的公共引用。`.children``CCNode`

但是，您发布的代码中似乎没有任何错误，除了`LineDrawer`继承自`CCLayer`并且我不认为它`CCLayer`被设计为用作`CCSprite`...的子对象...它真的需要成为您的 Player 对象的子对象吗? （例如，当它移动和旋转时它是否应该跟随您的玩家精灵？）通常，一个层是您的活动`CCScene`节点或另一个层的子层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:21:47.843

当您[使用 ARC](https://github.com/LearnCocos2D/cocos2d-iphone-arc-templates)时，这些问题中的大多数都不会再发生了。

很可能你已经过度释放了一个对象。它不一定是lineDrawer。也许它是 lineDrawer 类中的一个对象。

解决这个问题的最好方法是在构建方案中启用 NSZombieObjects 并找出访问了哪个对象。

# php - PHP 无法将 JSON 数组传递给 jQuery

> ID：11787136
> 
> 赞同：1
> 
> 时间：2012-08-02T23:12:50.730
> 
> 标签：php, mysql, jquery

如果我在这里犯了一个愚蠢的错误，请原谅我......但我对 PHP 并不陌生......我已经坚持了很长时间。我尝试了几种方法，但我只能传递一个表行，而不是多行

我什至尝试过以下方法，但我遇到了同样的错误。 [http://www.electrictoolbox.com/json-data-jquery-php-mysql/](http://www.electrictoolbox.com/json-data-jquery-php-mysql/)

**这就是我想要做的：**

1) 使用 JQuery 进行 Ajax 调用，从服务器获取数据。

```
 $.ajax({                                      
  url: 'test.php',                  //the script to call to get data          
  data: "",                        
  dataType: 'json',                //data format      
  success: function(data)          //on recieve of reply
  {
    //use "data"
  } 
```

2) 使用 PHP 从 MySql 数据库中获取表数据。

```
$result = mysql_query("SELECT username,characterType FROM usertable"); 
```

3) 将所有行作为 JSON 数据传递回调用函数。

```
//This works , Returns one row and I am able to get the result back at AJAX end
$array = mysql_fetch_row($result);                          
echo json_encode($array); 
```

`mysql_fetch_assoc($result)`失败并出现以下错误：

```
XML Parsing Error: no element found Location: moz-nullprincipal:{6b1***-****somecrap numbers****-***86} Line Number 17, Column 3:

$array = mysql_fetch_assoc($result);                          
echo json_encode($array); 
```

我什至尝试`mysql_fetch_array($result, MYSQL_NUM)`按照其他相关问题中的建议使用，但我无法解决该问题。

任何帮助是极大的赞赏。

=============

# **更新：**

我可能是错的，但只是想知道，这是否可能......这可能是与本地设置相关的问题吗？配置错误..？

我已经使用“XAMPP 安装”[Apache / MySQL / Tomcat ...捆绑在一个包中]完成了我的本地主机设置...当我将文件作为“PHP应用程序”运行时它运行得很好...我能够得到“所有行”但是当我在我的 apache 服务器上部署代码时它没有运行......整个 php 文件作为响应出现，带有“XML 解析错误”[我正在使用 firebug 来跟踪响应]

谢谢普拉纳夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:57:37.420

这里有几点需要注意：

正如 Rup 提到`$array = mysql_fetch_row($result);`的，只返回一行。

另一件事是 test.php 当前不返回 JSON 对象；要查看发生了什么，它有助于注释掉`dataType: 'json'`，并用于`console.log(data);`查看返回的内容。您的回复可能如下所示：

```
["someUsername","someChartype"] 
```

您期望的对象的格式可能更像是：

```
[{"username":"foo","chartype":"admin"},
 {"username":"bar","chartype":"user"},
 {"username":"fum","chartype":"guest"}] 
```

要获取关联数组的格式，请`mysql_fetch_assoc($result)`改用；那会给

```
{"username":"someUsername","chracterType":"someChartype"} 
```

总而言之，将您的 php 代码更新为：

*   循环遍历您的结果，将它们推送到数组中。
*   最后对整个数组进行编码

    ```
    $outputArray = array();
    while( $row = mysql_fetch_assoc( $result ) ){
        array_push($outputArray, $row);
    }
    echo json_encode($outputArray); 
    ```

查看[如何从 mysql 数据库构建 JSON 数组](https://stackoverflow.com/questions/6281963/how-to-build-a-json-array-from-mysql-database)以获取更多信息。此外，正如其中一个答案所提到的，它值得使用`PDO`而不是`mysql_*`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:07:51.770

不要像@Tuanderful 指示的那样开始手动编写 JSON 字符串。让我们`json_encode()`来处理——只要给它正确的数据。尝试这样的事情：

```
$records = array();

while ( $record = mysql_fetch_assoc( $result ) ) {

  $records[] = $record;

}

echo json_encode( $records ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T19:55:38.663

好吧，我会喜欢这个：

```
$.ajax({                                      
  url: 'test.php',                  //the script to call to get data          
  //data: "",                        
  dataType: 'json',                //data format      
  success: somevar
})

var somevar = function(data)          //on recieve of reply
  {
    //use "data"
    somevar2 = jQuery.parseJSON(data)
    //now You can enter each row/cell from db(/php) like this
    // somevar2[0] would be the first row from php
    //if You want to do something with every line You can use:
    //$.each(somevar2, function(key,value){
    //$('#divname').html(value.cellnameoftable)
  } 
```

我希望它会有所帮助；）

# javascript - 我想通过下拉选择在文本框中输入文本

> ID：11787137
> 
> 赞同：1
> 
> 时间：2012-08-02T23:13:05.420
> 
> 标签：javascript, html

我有一个下拉列表，其中有一个项目列表。如果我在下拉列表中选择一个项目，它的相应值应该填充在下拉列表下方的文本框中。我试着这样想

下拉 id = "StandardComment" textarea id = areaComments

areaComments.text = StandardComment.selectedindex.value

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:22:54.707

```
function transfereValue(){
ob = document.getElementById('StandardComment');
val = ob.value
document.getElementById('areaComments').value = val
} 
```

在您的下拉列表中

```
<select id="StandardComment" onchange="transfereValue()">
<option value="blahh">Blah</option>
<option value="blahh2">Blah2</option>
<option value="blahh3">Blah3</option>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:23:20.980

我创建的这个jsfiddle之类的东西？它会自动插入您输入的值，然后选择到文本框中。

[http://jsfiddle.net/wigster/u9cSr/](http://jsfiddle.net/wigster/u9cSr/)

# java - 如何为 ListView 行制作 XML 布局，其中 TextView 左对齐和 TextView 右对齐？

> ID：11787144
> 
> 赞同：0
> 
> 时间：2012-08-02T23:13:58.313
> 
> 标签：java, android, eclipse, android-layout, android-xml

基本上我正在寻找的是我在 ListView 中的行看起来像这样：

```
Title:               Harry Potter
Hardcover:                    Yes
Own:                           No
Country:            United States 
```

有人可以发布这些行之一的 XML 布局吗？我似乎无法正确使用我的代码。

这是我所拥有的完全错误且无法正常工作的内容：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content">

  <TableLayout
        android:id="@+id/tableLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:stretchColumns="0"
         >

        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" >

            <TextView
      android:id="@+id/txtKey"
      android:layout_height="fill_parent"
      android:layout_gravity="left" 
      android:textSize="18dip" 
      android:layout_marginLeft="8dip"
      android:textStyle="bold"
      android:layout_marginTop="2dp"
      android:layout_marginBottom="2dp"
      android:text="test"
      />

            <TextView
      android:id="@+id/txtValue"
      android:layout_height="fill_parent"
      android:layout_gravity="right" 
      android:textSize="18dip" 
      android:layout_marginRight="8dip"
      android:layout_marginTop="2dp"
      android:layout_marginBottom="2dp"
      android:text="test2"
      />

        </TableRow>

        </TableLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:49:22.397

知道了。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content">

  <TableLayout
        android:id="@+id/tableLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:stretchColumns="0"
         >

        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" >

            <TextView
                android:id="@+id/txtKey"
                android:text="Some text"
                android:textSize="18dip"
                android:textStyle="bold"
                android:layout_marginLeft="8dip"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="left"
                android:layout_weight="1.0"
                android:layout_marginTop="2dp"
                android:layout_marginBottom="2dp"
            />

            <TextView
                android:id="@+id/txtValue"
                android:text="Some text"
                android:textSize="18dip"
                android:layout_marginRight="8dip"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="right"
                android:layout_weight="1.0"
                android:layout_marginTop="2dp"
                android:layout_marginBottom="2dp"
            />

        </TableRow>

        </TableLayout>

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:58:49.477

资源/布局/listitem.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <TextView 
        android:id="@+id/textLeft"
        android:layout_weight="1"
        android:gravity="left"
        android:layout_gravity="left"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>

    <TextView 
        android:id="@+id/textRight"
        android:layout_weight="1"
        android:gravity="right"
        android:layout_gravity="right"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
</LinearLayout> 
```

然后在您的活动中：

```
 ListView listView = (ListView) findViewById(R.id.list);
    listView.setAdapter(new BaseAdapter() {

        final String[][] keysAndValues = {
                {"key1", "value1"},
                {"key2", "value2"},
                {"key3", "value3"}
        };

        @Override
        public int getCount() {
            return keysAndValues.length;
        }

        @Override
        public String[] getItem(int position) {
            return keysAndValues[position];
        }

        @Override
        public long getItemId(int position) {
            return position;
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {

            TextView[] foundTextFields;

            if(convertView == null) {
                convertView = LayoutInflater.from(parent.getContext()).inflate(
                        R.layout.listitem, parent, false);
                foundTextFields = new TextView[] {
                        (TextView) convertView.findViewById(R.id.textLeft),
                        (TextView) convertView.findViewById(R.id.textRight)                     
                };
                convertView.setTag(foundTextFields);
            }
            else {
                foundTextFields = (TextView[]) convertView.getTag();
            }

            String[] item = getItem(position);
            foundTextFields[0].setText(item[0]);
            foundTextFields[1].setText(item[1]);

            return convertView;
        }
    }); 
```

# java - 如何从 hbase 扫描结果中获取行键

> ID：11787145
> 
> 赞同：15
> 
> 时间：2012-08-02T23:14:06.130
> 
> 标签：java, hbase

逐行扫描hbase表时，如何获取行键？这是我的代码：

```
for (Result rr : scanner) {
   System.out.println(rr);
} 
```

我可以使用像 getKey() 这样的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-03T01:30:21.910

如果您想要字符串格式的行键，请使用`getRow`和`Bytes.toString`方法：

```
for (Result rr : scanner) {
   String key = Bytes.toString(rr.getRow())
} 
```

[HBase API - 结果对象](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Result.html)

`getRow()`用于检索与创建此 Result 的行相对应的行键的方法。

# php - 列出自定义帖子类型的分类术语

> ID：11787151
> 
> 赞同：1
> 
> 时间：2012-08-02T23:14:41.457
> 
> 标签：php, wordpress, taxonomy, custom-post-type

我创建了一个自定义帖子类型，其中包含一个名为“sp_casestudy_category”的自定义分类，如下所示：

```
function zen_create_casestudy_taxonomies()
{
$labels = array(
    ...
);

register_taxonomy("sp_casestudy_category", array("zen_casestudy"), array(
    'hierarchical' => true,
    'public' => true,
    'show_in_nav_menus' => true,
    'labels' => $labels,
    'rewrite' => true,
    'query_var' => true,
    'rewrite' => array('slug' => 'casestudy/category')
));
}
add_action( 'init', 'sp_create_casestudy_taxonomies', 0 ); 
```

这似乎工作正常，我可以将帖子分配给这些类别。但是，在另一个自定义帖子类型中，我试图在复选框中列出这些术语，这样我就可以让用户选择在哪个类别上显示帖子。例如，代码如下所示：

```
foreach ($meta_fields_category_sbteaser as $field) {

    $options = $field['options'];
    $meta = get_terms($options['taxonomy']);

    switch ($field['type']) {

    case 'checkbox':
        foreach ($terms as $term) {
            echo '<input type="checkbox" name="'.$field['id'].'" value="" /><br/>';
        }
    break;

    } //end switch

} // end foreach 
```

但是我不能让它工作。我将如何在自定义元框中列出这些类别？

谢谢罗伯特

# java - 如何在 Wicket 6.0 中从 javascript 调用 java

> ID：11787152
> 
> 赞同：0
> 
> 时间：2012-08-02T23:14:45.683
> 
> 标签：java, wicket

在 Wicket 1.5 及更早版本中有许多解决方案如何做到这一点，但如何在 Wicket 6.0 中做到这一点？有人知道任何完整的教程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T12:17:31.867

与 1.5 相同，只需将 wicketAjaxGet() 替换为 Wicket.Ajax.get({...})。查看 Wicket 在您页面的最终标记中生成的内容，查找 Wicket.Ajax.ajax()。查看[https://cwiki.apache.org/confluence/display/WICKET/Wicket+Ajax](https://cwiki.apache.org/confluence/display/WICKET/Wicket+Ajax)了解更多信息。

# java - Android 删除文件 MediaScannerConnection

> ID：11787155
> 
> 赞同：2
> 
> 时间：2012-08-02T23:15:05.137
> 
> 标签：java, android, file, delete-file, android-mediascanner

我正在尝试使用命令 File.delete() 从内部存储器 (ASUS TF101) 中删除一些文件或目录。但是，使用 Android 文件资源管理器我可以看到文件是如何被删除的，但使用 Windows 资源管理器它们仍然显示在那里。

在添加文件时，我解决了一个类似的问题，只是创建了一个 MediaScannerConection（并使用了方法 scanFile）。

有谁知道如何解决这个问题？当然，重新启动设备是不可接受的，因为最终用户不会喜欢这种“解决方案”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T17:27:18.030

在此线程中查看**manisha**的答案： [Android 文件删除在图库中留下空占位符](https://stackoverflow.com/questions/4430888/android-file-delete-leaves-empty-placeholder-in-gallery)

就我而言，它工作得很好，因为我正在保存一张照片，然后使用 MediaScannerConnection 扫描它，所以当扫描完成时，我有该文件的 URI，然后我可以使用以下代码来解决问题。

```
getContentResolver().delete(imageUri, null, null); 
```

希望这对你有用。这似乎比通过向 android 系统发送意图来强制重新安装 SD 卡更合适。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T12:57:36.247

我有同样的问题，但我找到了答案：

Android 使用媒体表来处理文件。当您对文件进行更改时，您必须更新此表。

尝试这个：

```
sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri.parse("file://" + Environment.getExternalStorageDirectory()))); 
```

谷歌文档：http: [//developer.android.com/reference/android/content/Intent.html#ACTION_MEDIA_MOUNTED](http://developer.android.com/reference/android/content/Intent.html#ACTION_MEDIA_MOUNTED)

# javascript - 如何在严格模式下实现以下 JavaScript 闭包？

> ID：11787157
> 
> 赞同：1
> 
> 时间：2012-08-02T23:15:18.020
> 
> 标签：javascript, closures

以下代码

```
'use strict';

function blah() {

    if (1 ==21) {
    }
    else {
        var i = 10;
        function inner() {
            console.log(i);
        }
    }
} 
```

产生以下错误：

> SyntaxError：在严格模式代码中，函数只能在顶层或立即在另一个函数中声明。

如何在内部编写函数以便它可以访问我的变量“i”？根据严格模式，我需要将函数移到顶部，但此时尚未声明“i”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T23:20:08.733

由于无论如何`var i`都会被提升到`function blah`' 范围的顶部，您可以这样做：

```
'use strict';

function blah() {
    var i;
    function inner() {
        console.log(i);
    }

    if (1 ==21) {
    }
    else {
        i = 10;
    }
}​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T00:01:45.127

`inner()`需要从哪里访问？这对您的目的有用吗？：

```
var inner = function () { ... }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T00:15:37.893

内部函数必须声明为函数表达式，如下所示：

```
var inner = function () {
    console.log(i);
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T23:19:29.753

它已被声明，因为`var`声明了整个函数的变量，而不是块。

# nunit - Watin 测试在 Jenkins 中失败

> ID：11787170
> 
> 赞同：0
> 
> 时间：2012-08-02T23:16:30.403
> 
> 标签：nunit, jenkins, watin

我想将功能测试纳入我的 Jenkins 工作中。当我使用 nUnit 手动运行测试时，从 Jenkins 运行时一切正常：

```
"C:\Program Files (x86)\NUnit 2.6\bin\nunit-console.exe" /framework:net-4.0 /xml:functional-tests.xml c:\IISRoot\ALAS-QA\ALAS.Web.Test.dll /apartment=STA /process=Separate 
```

我在每一次测试中都遇到了这个异常

```
Test Error : ALAS.Web.Test.TestAddLead.TestAddSingleLead
WatiN.Core.Exceptions.BrowserNotFoundException : Could not find an IE window matching constraint: Timeout while waiting to attach to newly created instance of IE.. Search expired after '30' seconds.
at WatiN.Core.IE.CreateIEPartiallyInitializedInNewProcess()
at WatiN.Core.IE.CreateNewIEAndGoToUri(Uri uri, IDialogHandler logonDialogHandler,  oolean createInNewProcess)
at FluentAutomation.WatiN.AutomationProvider.getCurrentBrowser()
at FluentAutomation.WatiN.AutomationProvider.Navigate(Uri pageUri)
at ALAS.Web.Test.TestExtensionMethods.Login(CommandManager I, String username, String password) in c:\java\jenkins\workspace\SCI-ALAS\ALAS.Web.Test\TestExtensionMethods.cs:line 40
at ALAS.Web.Test.TestAddLead.TestAddSingleLead() in c:\java\jenkins\workspace\SCI-ALAS\ALAS.Web.Test\TestAddLead.cs:line 33 
```

我收到此错误的行尝试附加到 IE 窗口。

我在 Windows 2008 服务器上，使用 IE9

*添加于 2012 年 8 月 3 日星期五*

我读过这可能是

*   默认情况下，对“localhost”的请求将解析为 ::1 的 IPv6 地址，而不是 127.0.0.1 的 IPv4 地址，WatiN 测试将失败。

情况并非如此，因为我正在针对不在本地计算机上的公共 URL 进行测试。

*   IE 增强安全配置已打开

我已将其关闭，但没有任何结果。

*   缺少文件 Microsoft.mshtml.dll、Interop.shdocvw.dll 或 Watin.Core.dll

    我在运行测试的输出目录中有那些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T14:58:55.610

我正在[通过 Windows 2008 服务器上的 tfs 尝试来自这个 SO 帖子 Watin](https://stackoverflow.com/questions/1674888/watin-through-tfs-on-windows-2008-server)的信息， 这基本上是说

> 自动化 UI 测试不能在作为 Windows 服务运行的构建代理中运行，因为它不是交互式的，这意味着它不能与桌面交互

所以我计划通过拥有一个包含 nunit 调用的 bach 文件并在 Jenkins 中运行它来创建我自己的“交互式代理”：

```
cmd /interactive /c C:\workfolder\nunit-test.bat 
```

# mongodb - 如何访问 MapReduce MongoDB 中的嵌入对象？

> ID：11787171
> 
> 赞同：0
> 
> 时间：2012-08-02T23:16:40.980
> 
> 标签：mongodb, mapreduce

我在 mongo 中有以下文档：

```
{
        "_id" : ObjectId("501535acd729190bd62e3a58"),
        "o_orderkey" : NumberLong(1),
        "o_custkey" : {
                "$ref" : "customer",
                "$id" : ObjectId("5012e490cabc8baea9a541dd")
        },
        "o_orderstatus" : "O",
        "o_totalprice" : 173665.47,
        "o_orderdate" : ISODate("1996-01-02T02:00:00Z"),
        "o_orderpriority" : "5-LOW",
        "o_clerk" : "Clerk#000000951",
        "o_shippriority" : 0,
        "o_comment" : "blithely final dolphins solve-- blithely blithe packages nag blith",
        "o_lineitem" : [
                {
                        "_id" : ObjectId("501535abd729190bd62e38c7"),
                        "orderKey" : NumberLong(1),
                        "l_partkey" : {
                                "$ref" : "part",
                                "$id" : ObjectId("500f3a03d7292535356b839c")
                        },
                        "l_supplierkey" : {
                                "$ref" : "supplier",
                                "$id" : ObjectId("4ffed5dd125ee93ca6f3b294")
                        },
                        "l_linenumber" : 1,
                        "l_quantity" : 17,
                        "l_extendedprice" : 21168.23,
                        "l_discount" : 0.04,
                        "l_tax" : 0.02,
                        "l_returnflag" : "N"
                },
                {
                        "_id" : ObjectId("501535abd729190bd62e38c8"),
                        "orderKey" : NumberLong(1),
                        "l_partkey" : {
                                "$ref" : "part",
                                "$id" : ObjectId("500f398ed7292535356a2c54")
                        },
                        "l_supplierkey" : {
                                "$ref" : "supplier",
                                "$id" : ObjectId("4ffed5dd125ee93ca6f3b109")
                        },
                        "l_linenumber" : 2,
                        "l_quantity" : 36,
                        "l_extendedprice" : 45983.16,
                        "l_discount" : 0.09,
                        "l_tax" : 0.06,
                        "l_returnflag" : "N"
                }
        ]
} 
```

当“o_shippriority”=0 和“l_linenumber”=1 时，我需要对“l_quantity”求和，我试过这个：

```
db.runCommand({ 
    mapreduce: "orders", 
    query: {
        o_shippriority: 0,
        "l_lineitem.l_linenumber": 1
    },
    map : function Map() {
        emit("sum",{this.o_lineitem}); 
    },
    reduce : function Reduce(key, values) {
        var sum = 0;
        for (var i = 0; i < values.length; i++) {
            var lineitem = values[i];
            for (var j=0; j<lineitem.length; j++) {
                sum += lineitem.l_quantity;
            }
        }
        return sum;
    },  
    out: 'query'
}); 
```

不起作用我收到“SyntaxError: missing : after property id (shell):8” 怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T03:12:43.503

您遇到的语法错误问题是由于以下行：

```
emit("sum",{this.o_lineitem}); 
```

哪个应该是正确的文档：`emit("sum", {line:this.o_lineitem})`或者根本不是文档：`emit("sum", this.o_lineitem")`取决于您要在 reduce 中执行的操作。

您必须首先解决的另一个问题`query`是 不会返回任何东西，您将需要`"o_lineitem.l_linenumber": 1`而不是`"l_lineitem.l_linenumber": 1`因为您的文档没有`l_lineitem`.

但是，您将在此查询中遇到更多问题，因为当您找到时，`o_lineitem.l_linenumber:1`您将返回整个文档 - 包括`l_linenumber`不是 1 的。您将需要遍历您正在发出的数组并仅在`l_linenumber`= 1。

# css - CSS 问题：页脚与上述内容重叠

> ID：11787172
> 
> 赞同：0
> 
> 时间：2012-08-02T23:16:48.170
> 
> 标签：css, overlap

请看这里[http://sources.freehosting.bg/1st-level.html](http://sources.freehosting.bg/1st-level.html)

当页面在窗口中“最小化”时，页脚与上述内容重叠。我试图解决这个问题几个小时，但没有运气。

最大化：[http](http://store.picbg.net/pubpic/99/2A/db640a6f9063992a.PNG) ://store.picbg.net/pubpic/99/2A/db640a6f9063992a.PNG 最小化：[http://store.picbg.net/pubpic/E4/96/2c1e86018b7be496.PNG](http://store.picbg.net/pubpic/E4/96/2c1e86018b7be496.PNG)

花车被清除了，我不知道可能是什么原因造成的。请帮我解决它...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:41:48.993

你`setHeights`导致了这个问题，它设置的高度`#content`和 main`.main`小于它们的内容，所以它溢出，如果你取出`-20`它似乎工作，但为什么要设置高度，因为它会随着它的内容扩展。

```
function setHeights() {
    var newHeight=$(document).height() - 290;
    $('#content').height(newHeight);
    $('.main').height(newHeight/*-20*/);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:20:33.900

您需要`margin-top: -30px`从`#footer`CSS 中删除。

# c# - 在 DataContext 中查找依赖于其他实体的实体（通过 DB ForeignKeys）

> ID：11787173
> 
> 赞同：0
> 
> 时间：2012-08-02T23:16:51.093
> 
> 标签：c#, sql-server, entity-framework, linq-to-sql

我正在编写一些非常通用的数据库代码，并且我想找到一种方法来查询与另一个实体相关的实体集中的一组类型（使用 LINQ to SQL EntityFramework，数据库优先）。

因此，例如，我可能有一个属于某个类别的产品；

```
SELECT * FROM Products p INNER JOIN Categories c ON p.CategoryId = c.Id 
```

在我的数据库中，p.CategoryId 是一个外键约束为非空。（即；产品必须属于一个类别）。

现在，如果我尝试从类别中删除，我会收到错误，因为仍有产品与类别相关，并且我没有（或不想要）应用于关系的 CASCADE DELETE。

我要做的是检查我的 DataContext 库，并动态确定类别是由 Products 键入的，因此如果我想从类别中删除，我首先需要从产品中删除。

通过“动态”，我的意思是我的代码不会预先知道类型或关系（它不知道具体的产品或类别实体），但我愿意使用反射来评估 DLL 以解决这些关系。

我查看了与 DataContext 相关的代码，并且可以看到某些实体上的 EntityRef 属性（这是解决了一半的问题），但我似乎找不到任何方法来判断这些关系是强制性的还是可选的（即；NON -NULL 或 NULLABLE）在基础数据库中。

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:11:17.327

您知道可以通过将删除规则设置为“级联”来自动在实体框架中级联删除吗？这可能会使事情变得更容易（虽然不一定为 LINQ to SQL 提供通用解决方案）。

在这里查看更多信息：http: [//msdn.microsoft.com/en-us/library/bb738695.aspx](http://msdn.microsoft.com/en-us/library/bb738695.aspx)

# ajax - 动态加载选项卡时重置 ui-tabs id 号

> ID：11787175
> 
> 赞同：0
> 
> 时间：2012-08-02T23:17:14.613
> 
> 标签：ajax, jquery-ui, tabs

我的代码

```
function get_projects() {
 $.ajax ({
   url: "get_projects.php",
   type: "post",
   dataType: "json",
   data: {value : $("#search_term").val()},
   success: function(store) {   
     var a = 0;
     var b = 0;

     $("#testdiv").empty();             
     var content = '';                                      
     $.each(store, function(i, data) {
       a = a + 1;
       content += '<div id="tabs'+[i]+'">';
       content += '<ul>';       
       content += //.... a bunch of tab headings    
       content += '</ul>';
       content += '<div id="ui-tabs-'+(a+b)+'">';
       // ... some tab content 

       content += '</div>';
       content += '<div id="ui-tabs-'+(a+1+b)+'">';
       // ... some tab content for each tab up to 

       content += '<div id="ui-tabs-'+(a+5+b)+'">';
       // ... some tab content 
       content += '</div>'; 
       content += '</div>';
       b = b + 5;       
       });

     $("#testdiv").append(content);

     $("#tabs0").tabs(); 
     $("#tabs1").tabs(); 
     $("#tabs2").tabs(); 
     .... same thing for a bunch of other possible tabs up to #tabs20 
```

简短的解释

a`search_term`可以导致多个`projects`，每个项目有 6 个选项卡。所以每次提交搜索词时，页面都会重新绘制新项目及其信息选项卡

问题

第一次将 html 注入页面时，一切都很好。

生成的 div id`ui-tabs-#`与我用`(a+...+b)`计数器创建的 div id 匹配。

但是，在每个后续请求中，自动生成的 div id 编号正在累积，而不是从零开始。所以我的`(a+...+b)`柜台正在生产不匹配的 div id。因此标签内容位于标签容器之外

我已经尝试过`.tabs("destroy")`，`.tabs("remove")`对于循环内外的`$("#testdiv")`个人和个人`$("#tabs0")``$.each()`

我似乎无法解决

任何帮助和建议都会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T01:39:48.783

通过移动变量`a`并`b`在 ajax 函数之外解决它，因此它们不会在每个循环中重置为 0

```
 var a = 0;
 var b = 0;

function get_projects() {
 $.ajax ({
    url: "get_projects.php",
    type: "post",
    dataType: "json",
    data: {value : $("#search_term").val()},
    success: function(store) {   

 $("#testdiv").empty();             
 var content = '';                                      
 $.each(store, function(i, data) {
   a = a + 1;
   content += '<div id="tabs'+[i]+'">';
   content += '<ul>';       
   content += //.... a bunch of tab headings    
   content += '</ul>';
   content += '<div id="ui-tabs-'+(a+b)+'">';
   // ... some tab content 

   content += '</div>';
   content += '<div id="ui-tabs-'+(a+1+b)+'">';
   // ... some tab content for each tab up to 

   content += '<div id="ui-tabs-'+(a+5+b)+'">';
   // ... some tab content 
   content += '</div>'; 
   content += '</div>';
   b = b + 5;       
   });

 $("#testdiv").append(content);

 $("#tabs0").tabs(); 
 $("#tabs1").tabs(); 
 $("#tabs2").tabs(); 
 .... same thing for a bunch of other possible tabs up to #tabs20 
```

# php - 在自己的 php 框架中管理 URL 路由

> ID：11787176
> 
> 赞同：14
> 
> 时间：2012-08-02T23:17:38.163
> 
> 标签：php, url, frameworks, routes

我正在创建一个 PHP 框架，但我有一些疑问......

框架以这种方式获取 url： `http:/web.com/site/index`

它采用第一个参数来加载控制器 ( `site`)，然后加载特定的操作 ( `index`)。

如果您已将框架安装在基本 URL 中，则可以正常工作，但如果您将其安装在这样的子文件夹中： `http://web.com/mysubfolder/controller/action`

我的脚本将其解析为 controller =`mysubfolder`和 action = `controller`。

如果您有更多子文件夹，结果将是最差的。

这是我的路线代码：

```
Class Route
{
    private $_htaccess = TRUE;
    private $_suffix = ".jsp";

    public function params()
    {
        $url='';

        //nombre del directorio actual del script ejecutandose.
        //basename(dirname($_SERVER['SCRIPT_FILENAME']));

        if($this->_htaccess !== FALSE):
            //no está funcionando bien si está en un subdirectorio web, por ej stynat.dyndns.org/subdir/
            // muestra el "subdir" como primer parámetro
            $url = $_SERVER['REQUEST_URI'];
            if(isset($_SERVER['QUERY_STRING']) && !empty($_SERVER['QUERY_STRING'])):
                $url = str_replace("?" . $_SERVER['QUERY_STRING'], '',$url);
            endif;
        else:
            if(isset($_SERVER['PATH_INFO'])):
                $url = $_SERVER['PATH_INFO'];
            endif;
        endif;

        $url = explode('/',preg_replace('/^(\/)/','',$url));
        var_dump($url);

        var_dump($_GET);

    }
} 
```

谢谢你提供的所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T10:47:45.197

您缺少基本路径。当检测到检测到的模式或路由时，路由脚本现在必须从哪里开始。

伪代码：

```
 //set the base URI
$base_uri = '/base';
//remove the base URI from the original uri. You can also REGEX or string match against it if you want
$route_uri = str_replace($base_uri,'',$uri);
//perform route matching $route_uri, in your code a simple explode

$url = explode('/',preg_replace('/^(\/)/','',$route_uri)); 
```

您可以在 .htaccess 中使用或不使用 RewriteBase，只要它们使用相同的工具 - index.php。

此外，您可以使用 preg_match 和 preg_match_all 等正则表达式函数改进路由匹配过程。它们允许您定义一个匹配的模式并生成匹配字符串数组 - 请参阅[http://php.net/manual/en/function.preg-match.php](http://php.net/manual/en/function.preg-match.php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-06T19:47:17.230

是的，我想我知道如何解决这个问题。

（免责声明：我知道您知道其中的大部分内容，但我将为可能不知道某些问题的其他人解释一切）

## 使用 PATH_INFO 和 .htaccess

php中有一个技巧，如果你去这样的路径：

[http://web.com/mysubfolder/index.php/controller/action](http://web.com/mysubfolder/index.php/controller/action)

`$_SERVER['PATH_INFO']`您将在变量中获得“/controller/action”

现在您需要做的是获取一个 .htaccess 文件（或等效文件）并让它告诉您的 php 脚本当前文件夹的深度。

为此，请将 .htaccess 文件放入“mysubfolder”

```
mysubfolder
    .htaccess
    index.php 
```

.htaccess 应包含：

```
RewriteEngine on

# if a directory or a file exists, use it directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# otherwise forward it to index.php
RewriteRule (.*) index.php/$1 
```

（我使用了[yii 框架手册](http://www.yiiframework.com/wiki/214/url-hide-index-php/)作为参考，我也推荐使用[html5 样板](http://html5boilerplate.com/)）

基本上，您将其设置为将所有内容重定向到 url 中特定点的 index.php。

现在，如果您访问：[http ://web.com/mysubfolder/index.php/controller/action](http://web.com/mysubfolder/index.php/controller/action)

现在您可以从中获得正确的路径“/controller/action”`$_SERVER['PATH_INFO']`

除非您访问[http://web.com/mysubfolder/](http://web.com/mysubfolder/)它将没有任何价值，因为 .htaccess 文件将忽略重写，因为[http://web.com/mysubfolder/](http://web.com/mysubfolder/)路径请求 mysubfolder/index.php这实际上存在并被拒绝谢谢`RewriteCond %{REQUEST_FILENAME} !-f`。

## [ifsetor](https://wiki.php.net/rfc/ifsetor)函数

为此，您可以使用这个超级方便的函数`ifsetor`（我不记得我在哪里得到它）

```
function ifsetor(&$variable, $default = null) {
    return isset($variable)? $variable: $default;
} 
```

它的作用是引用可能存在或可能不存在的变量，并在它不存在时提供默认值而不抛出任何通知或错误

现在您可以像这样使用它来安全地获取 PATH_INFO 变量

在你的 index.php

```
function ifsetor(&$variable, $default = null) {
    return isset($variable)? $variable: $default;
}
$path = ifsetor($_SERVER['PATH_INFO'],'/');
var_dump($path); 
```

php 5.4 也有这个新的更短的三元格式，如果你不关心通知，你可以使用它（我愿意）

```
$path = $_SERVER['PATH_INFO']?:'/'; 
```

## 处理 QUERY_STRING

现在技术上你没有得到一个 URL，它只是它的[路径](http://en.wikipedia.org/wiki/Uniform_resource_locator)部分，不会包含 query_string，例如在访问时

[http://web.com/mysubfolder/index.php/test?param=val](http://web.com/mysubfolder/index.php/test?param=val)

您只会在 $path 变量中获得 '/test'，要获取查询字符串，请使用该`$_SERVER['QUERY_STRING']`变量

索引.php

```
function ifsetor(&$variable, $default = null) {
    return isset($variable)? $variable: $default;
}
$path = ifsetor($_SERVER['PATH_INFO'],'/');
$fullpath = ($_SERVER['QUERY_STRING'])? $path.'?'.$_SERVER['QUERY_STRING']:$path;
var_dump($fullpath); 
```

但这可能取决于您的需求

## $_SERVER['QUERY_STRING'] 与 $_GET

另请记住，该变量与and变量`$_SERVER['QUERY_STRING']`不同，因为它保留了查询字符串中的重复参数，例如：`$_GET``$_REQUEST`

访问此页面

[http://web.com/mysubfolder/controller/action?foo=1&foo=2&foo=3](http://web.com/mysubfolder/controller/action?foo=1&foo=2&foo=3)

如果要给你一个`$_SERVER['QUERY_STRING']`看起来像

```
?foo=1&foo=2&foo=3 
```

虽然`$_GET`变量将是这样的数组：

```
array(
    'foo'=>'3'
); 
```

## 如果您没有 .htaccess

您可以尝试使用 SCRIPT_NAME 来发挥您的优势

```
list($url) = explode('?',$_SERVER['REQUEST_URI']);
list($basepath) = explode('index.php',$_SERVER['SCRIPT_NAME']);
$url = substr($url,strlen($basepath)); 
```

如果你喜欢炸毁像我这样的东西:)

## 你的情况

```
Class Route
{
private $_htaccess = TRUE;
private $_suffix = ".jsp";

public function params()
{
    $url='';

    //nombre del directorio actual del script ejecutandose.
    //basename(dirname($_SERVER['SCRIPT_FILENAME']));

    if($this->_htaccess !== FALSE):
        //no está funcionando bien si está en un subdirectorio web, por ej stynat.dyndns.org/subdir/
        // muestra el "subdir" como primer parámetro
        list($url) = explode('?',$_SERVER['REQUEST_URI']);
        $basepath = dirname($_SERVER['SCRIPT_NAME']);
        $basepath = ($basepath==='/')? $basepath: $basepath.'/';
        $url = substr($url,strlen($basepath));
    else:
        if(isset($_SERVER['PATH_INFO'])):
            $url = $_SERVER['PATH_INFO'];
            $url = preg_replace('|^/|','',$url);
        endif;
    endif;

    $url = explode('/',$url);
    var_dump($url);

    var_dump($_GET);

}
} 
```

我希望这有帮助

PS抱歉回复晚了:(

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-17T16:18:42.497

即使您正在创建自己的框架，也没有理由不重用健壮、经过良好测试和记录的[组件](http://symfony.com/doc/current/components/index.html)，例如这个[Routing](http://symfony.com/doc/current/components/routing.html)组件。

只需使用[Composer](http://getcomposer.org/)，它已经成为 PHP 中依赖管理的标准，你会没事的。将任意数量的组件添加到堆栈中。

在这里，您有一本关于如何制作自己的框架的***必读*** [指南。](http://fabien.potencier.org/article/50/create-your-own-framework-on-top-of-the-symfony2-components-part-1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T23:06:14.553

我不使用 OOP，但可以向您展示我如何动态检测我是否在子目录中的一些片段。太简短了，我只会描述其中的一部分，而不是发布所有代码。

因此，我从`.htaccess`将每个请求发送到 redirect.php 开始，在其中拼接`$_SERVER['REQUEST_URI']`变量。我使用正则表达式来决定哪些部分应该是键，哪些应该是值（我通过分配以 0-9 开头的任何内容作为值，以及以 az 开头的任何内容作为键）并构建数组`$GET[]`。

然后，我检查 redirect.php 的路径并将其与我的`$GET`数组进行比较，以确定实际 URL 的开始位置 - 或者在您的情况下，哪个键是控制器。对你来说看起来像这样：

```
$controller = keyname($GET, count(explode('/', dirname($_SERVER['SCRIPT_NAME'])))); 
```

就是这样，我有 URL 的第一部分。该`keyname()`函数如下所示：

```
/*************************************
 *  get key name from array position
 *************************************/
function keyname ($arr, $pos)
{
    $pos--;
    if ( ($pos < 0) || ( $pos >= count($arr) ) )
          return "";  // set this any way you like

    reset($arr);
    for($i = 0;$i < $pos; $i++) next($arr);

    return key($arr);
} 
```

为了让链接指向正确，我使用了一个`fixpath()`这样的函数：

```
print '<a href="'.fixpath('/admin/logout').'">link</a>'; 
```

这就是该函数的外观：

```
/*************************************
 *   relative to absolute path
 *************************************/
function fixpath ($path)
{
    $root = dirname($_SERVER['SCRIPT_NAME']);
    if ($root == "\\" || $root == ".") {
        $root = "";
    }
    $newpath = explode('/', $path);
    $newpath[0] .= $root;
    return implode('/', $newpath);    
} 
```

我希望这对您有所帮助并能给您一些启发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T08:20:24.193

这就是我实现 loader.php 的方式

```
 <?php
/*@author arun ak
auto load controller class and function from url*/
class loader
{
    private $request;
    private $className;
    private $funcName;

    function __construct($folder    = array())
    {   
        $parse_res  = parse_url($this->createUrl());
        if(!empty($folder) && trim($folder['path'],DIRECTORY_SEPARATOR)!='')
         {
            $temp_path  = explode(DIRECTORY_SEPARATOR,trim($parse_res['path'],DIRECTORY_SEPARATOR));
            $folder_path    = explode(DIRECTORY_SEPARATOR,trim($folder['path'],DIRECTORY_SEPARATOR));
            $temp_path      = array_diff($temp_path,$folder_path);

                if(empty($temp_path))
                {
                    $temp_path =    '';
                }
         }else
         {
            if(trim($parse_res['path'],DIRECTORY_SEPARATOR)!='')
            {
             $temp_path = explode(DIRECTORY_SEPARATOR,trim($parse_res['path'],DIRECTORY_SEPARATOR));
            }
                 else
             $temp_path ='';
         }
        if(is_array($temp_path))
        {   
            if(count($temp_path) ==1)
            {
                array_push($temp_path,'index');
            }
            foreach($temp_path as $pathname)
            {   
                $this->request .= $pathname.':';
            }
        }
        else $this->request = 'index'.':'.'index';

    }

 private function createUrl()
 {  
    $pageURL  = (@$_SERVER["HTTPS"] == "on") ? "https://" : "http://";
    $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
    return $pageURL;
 }
 public function autolLoad()
 {
    if($this->request) 
    {   
        $parsedPath = explode(':',rtrim($this->request,':'));
        if(is_file(APPLICATION_PATH.DIRECTORY_SEPARATOR.'controllers'.DIRECTORY_SEPARATOR.$parsedPath[0].'_controller'.'.php'))
        {
            include_once(APPLICATION_PATH.DIRECTORY_SEPARATOR.'controllers'.DIRECTORY_SEPARATOR.$parsedPath[0].'_controller'.'.php');
            if(class_exists($parsedPath[0].'_controller'))
            {
                $class  = $parsedPath[0].'_controller';
                $obj    = new $class();
                //$config       = new config('localhost','Winkstore','nCdyQyEdqDbBFpay','mawinkcms');
                //$connect  =  connectdb::getinstance();
                //$connect->setConfig($config);
                //$connection_obj = $connect->connect();
                //$db               = $connect->getconnection();//mysql link object
                //$obj->setDb($db);
                $method = $parsedPath[1];
                if(method_exists ($obj ,$parsedPath[1] ))
                {
                    $obj->$method();
                }else die('class method '.$method.' not defined');

            }else die('class '.$parsedPath[0]. ' has not been defined' );

        } else die('controller not found plz define one b4 u proceed'.APPLICATION_PATH.DIRECTORY_SEPARATOR.'controllers'.DIRECTORY_SEPARATOR.$parsedPath[0].'.php');

     }else{ die('oops request not set,i know tis is not the correct way to error :)'); }
 }

} 
```

现在在我的索引文件中

```
//include_once('config.php');
include_once('connectdb.php');
require_once('../../../includes/db_connect.php');
include_once('view.php');
include_once('abstractController.php');
include_once('controller.php');
include_once('loader.php');
$loader = new loader(array('path'=>DIRECTORY_SEPARATOR.'magsonwink'.DIRECTORY_SEPARATOR.'modules'.DIRECTORY_SEPARATOR.'admin'.DIRECTORY_SEPARATOR.'atom'.DIRECTORY_SEPARATOR));
$loader->autolLoad(); 
```

我没有使用模块的概念。只有控制器动作和视图被渲染。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-22T22:43:03.763

如果我正确理解了您的需求，那么一种解决方案可能是继续做您正在做的事情，但还要获取主路由脚本的路径（例如使用 realpath() ）。

如果最后一个文件夹（或之前的文件夹等）与开始的 URL 项目（或其他部分）匹配，则忽略它并转到下一个。

只是我的 2 美分 :-)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-02T09:05:31.090

你确定你的`htaccess`正确吗？

我想如果你将你的框架放在 上`subfolder`，那么你必须将你的`RewriteBase`in`htaccess`文件从更改`/`为`/subfolder/`. 它会是这样的：

```
# on root
RewriteBase /

#on subfolder
RewriteBase /subfolder/ 
```

在您的情况下，这是我唯一想知道的...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-24T01:19:33.043

忘记“重新发明轮子是错误的”的说法。他们不必使用我们的轮子。不久前我走在同一条路上，我非常感激我所得到的......我希望你也会

当涉及到您的具体问题的答案时——如果也面临这个问题——有一个非常简单的解决方案。这是根文件夹中 .htaccess 中的新行...

只需将下面的行添加到您的根 .htaccess 文件中；（如果您的子文件夹是“子文件夹”）

```
RewriteRule subfolder/ - [L] 
```

这将使该文件夹与重写指令分开

通过使用这种方式，您可以安装任意数量的框架实例。但是，如果您希望这是框架驱动的，那么您必须在您的框架内创建/更改 .htaccess。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-25T13:10:52.030

在应用程序配置脚本中放置一个变量，该变量将设置为应用程序运行的路径。

另一种方法是动态设置该路径。

部分前

```
$url = explode('/',preg_replace('/^(\/)/','',$url)); 
```

`$url`使用预定义的应用程序路径从字符串中去除位置（子文件夹）路径。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-14T14:51:20.937

在某些时候，您必须检查 $_SERVER ['HTTP_HOST'] 和程序员/用户定义的配置变量，它指示应用程序所在的子文件夹，并从URL 的其余部分。

您可以在 codeigniter 表单上查看[此论坛帖子以获取一些提示。](http://codeigniter.com/forums/viewthread/60181/)

CodeIgniter 使用另一种不同的方式在内部路由控制器/方法。您按`$_SERVER['PATH_INFO']`值进行路由。您使用这样的网址：`myapp.com/index.php/controller/method`.

为了避免在 uri 上显示 index.php，您必须依赖 Apache 重写规则，但即便如此，我认为 CI 是一个不错的解决方案，一旦您有了索引文件的位置，就可以避免解析的所有麻烦网址。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-12-23T12:33:41.360

创建`/myBaseDirectory/public`目录并将您的文件放在那里 - 像`index.php`.
这是有效的，因为 Apache 将此目录视为基本目录。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-08-02T23:21:24.043

基本上在你的第一个斜杠之后抓取 url 字符串，然后将它分解成一个数组（我使用 '/' 作为分隔符）。

然后小心地 array_shift 关闭你的元素并将它们存储为变量

```
item 0: controller
item 1: the action / method in that controller
item 2 thru n: the remaining array is your params 
```

# python - 如何处理元组的某些模式

> ID：11787181
> 
> 赞同：0
> 
> 时间：2012-08-02T23:18:04.957
> 
> 标签：python

如果

```
list_1 = [(1, 1), (1, 3), (1, 4), (2, 2), (2, 3)] 
```

将元组的一个元素视为 (i, j) 现在我们知道如果我们知道如果 (1, 3) 存在，那么 (1,1) 和 (1,2) 应该存在，如果其中任何一个是漏报错误。错误检测应该首先对 (1,1) 进行，然后对 (1, 2) 进行。类似地，如果我们知道对于另一个序列，如果 (2,3) 存在，那么 (2,1) 和 (2, 2) 将同样存在。

这也是一个示例列表。这个例子也可以是：

list_1 = [(1, 3), (1, 4), (2, 2), (2, 3), (3,1) (3,4)] 现在在这种情况下如果 (3, 4) 存在则(3,1),(3,2) 和 (3,3) 应该存在。这种模式可以由每个“i”的第 j 个元素的最大值来确定我的代码是 gi

```
for i, e in enumerate(list_1):
              i1 = (1,1)
              if i1 not in list_1:
                 raise ValueError, '%s is missing in %s' %(i1, production)

              if (e[0] == e[1]) and ((e[0],e[1]) not in list_1):
                 #if i1 not in list_1:
                 raise ValueError, '%s is missing in %s' %((e[0], e[1]), production)

              print e, e[0], e[1], (e[0], e[1])
              if i!=len(list_1)-1:

                 if e[0]==list_1[i+1][0] and e[1]!=list_1[i+1][1]-1:

                    raise ValueError, '(%s,%s) is missing in %s ' %(e[0], e[1]+1, production) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:41:05.737

基于迭代工具的方法

```
>>> from itertools import groupby, izip, count
>>> from operator import itemgetter
>>> z = [(1, 3), (1, 4), (2, 1), (2, 2), (2, 3), (3,1), (3,4)]
>>> z = sorted(z, key=itemgetter(0))
>>> z = groupby(z, key=itemgetter(0))
>>> bad = []
>>> for key, group in z:
...     z1 = izip((y for (x, y) in group), count(1))
...     for (a, b) in z1:
...             if a != b:
...                    bad.append(key) 
... 
>>> print(set(bad))
set([1, 3]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:26:47.697

```
>>> list_1 = [(1, 1), (1, 3), (1, 4), (2, 2), (2, 3)]
>>> check_list = zip(list_1, list_1[1:])
>>> check_list
[((1, 1), (1, 3)), ((1, 3), (1, 4)), ((1, 4), (2, 2)), ((2, 2), (2, 3))]
>>> ok = True
>>> for (i1, j1), (i2, j2) in check_list:
...     if i1 == i2 and j1 + 1 != j2:
...         ok = False
...         break
...     elif i1 + 1 != i2: #you may also want to check j2 == 1:
...         ok = False
...         break
...
>>> ok
False 
```

# python - mac osx 10.8上的初学者python

> ID：11787182
> 
> 赞同：5
> 
> 时间：2012-08-02T23:18:12.507
> 
> 标签：python, macos, osx-mountain-lion

我正在学习编程并且一直在使用 Ruby 和 ROR，但我觉得我更喜欢 Python 的语言来学习编程。虽然我看到了 Ruby 和 Rails 的美妙之处，但我觉得我需要一种更容易学习编程概念的语言，因此需要 Python。但是，我似乎无法找到适用于 Apple osx 的在线或离线社区；大多数似乎是 Python 的 PC 人。我喜欢 Ruby 的地方在于它有很多书籍、社区等，而且它们往往拥有大量的 Mac 资源。有人可以将我指向可能有教程的初学者 Python 编程的谷歌群组、论坛等，或者帮助在 Mountain Lion 上运行的人吗？我感到有点沮丧，夹在 Ruby Vs 之间。Python范式，

感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-02T23:57:32.073

Mac OS X 10.8 与 Python 2.7.2 捆绑在一起，位于`/usr/bin/python`. 通常在 Python 世界中，您的操作系统是抽象出来的，因此没有那么多特定于操作系统的社区。然而，Apple 完全接受 Python，您甚至可以使用 Python 编写完全原生的应用程序。

我的建议是：

*   安装[homebrew](https://brew.sh/) - 这是 Mac OS X 的开源软件包安装程序，灵感来自 Debian 的[apt-get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool)或 RedHat 的[yum](http://yum.baseurl.org/)。这将允许您轻松安装许多系统级依赖项，如数据库服务器、NoSQL 服务器、系统库等。随着时间的推移，您将不可避免地需要安装这些东西，所以最好有合适的工具来完成这项工作！

*   安装[pip](https://pip.pypa.io/en/stable/) - Python 包安装程序。你不会后悔的。这将允许您轻松管理外部 Python 包。

*   查看[官方 Python 教程](https://docs.python.org/3/tutorial/)。这很好，但也假设您至少对编程有基本的了解。

*   查看[Learn Python the Hard Way](https://learnpythonthehardway.org/)，这是一本 Zed Shaw 的免费电子书，假设您没有任何编程经验，并且非常非常容易理解。

这些应该让你忙一阵子！！

# vba - 从每个 Excel 选项卡中提取表格数据，并将数据粘贴到单个工作表上

> ID：11787183
> 
> 赞同：1
> 
> 时间：2012-08-02T23:18:16.880
> 
> 标签：vba, excel

我有一个包含 75 个选项卡的 excel 电子表格——每个选项卡的格式相同，包含两列单词。我希望所有这些数据都在一个页面上，但我不知道如何以编程方式从每个选项卡中提取表格并将其粘贴到单个选项卡上。

有没有办法在 Excel 中做到这一点？

* * *

好的，这是我尝试过的代码：

```
Sub Macro5()

    Range("A1:B30").Select
    Selection.Copy
    Sheets("Table 1").Select
    Selection.End(xlDown).Select
    Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _
        , SkipBlanks:=False, Transpose:=False
End Sub 
```

所有选项卡的格式都相同，所有单元格中的数据都来自 A1:B30。我在想 Selection.End 命令将转到下一个可用的打开单元格，并将后续选项卡中的数据粘贴到该单元格中。

截至目前，我需要转到每个选项卡并单独运行此宏，但它不起作用，因为它说粘贴的数据与现有数据的类型/格式不同。

有任何想法吗？

* * *

编码尝试#2-成功！！！

```
 Sub Macro5()

    Dim ws As Worksheet
        For Each ws In ActiveWorkbook.Worksheets
            ws.activate
            Range("A1:B30").Select
            Selection.Copy
            Sheets("Table 1").Select
            Selection.End(xlDown).Select
            Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _
                , SkipBlanks:=False, Transpose:=False

            On Error Resume Next 'Will continue if an error results

            Next ws
End Sub 
```

好吧，我不想承认我很高兴你不只是用勺子喂给我答案。看好你，先生。

* * *

编码尝试#3-避免选择

```
Sub Macro5()

    Dim ws As Worksheet
        For Each ws In ActiveWorkbook.Worksheets
            Set Rng = ws.Range("A1:B30")
            Rng.Copy

            Dim ws1 As Worksheet
            Set ws1 = Worksheets("Table 1")
            ws1.Select
            Selection.End(xlDown).Select
            Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _
                , SkipBlanks:=False, Transpose:=False

            On Error Resume Next 'Will continue if an error results
            Next ws
End Sub 
```

不太正确——它仍然有效，但我不确定当我进入第一个工作簿时如何避免使用“选择”。有没有办法引用最接近的没有内容的单元格？我知道“结束”键可以做到这一点，但有没有基于非选择的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T04:52:31.610

请参阅此代码。

1.  我修改了您的代码，使其不使用`.Select`或根本不使用`.Activate`。
2.  我已经对代码进行了注释，因此您理解它应该没有问题。:)
3.  该代码不使用`On Error Resume Next`. 除非有必要，否则您应该始终避免这种情况。改为使用适当的错误处理。考虑`On Error Resume Next`告诉您的应用程序简单地关闭。:)

这是基本错误处理的示例

```
Sub Sample()
    On Error GoTo Whoa

    '
    '~~> Rest of Code
    '

    Exit Sub
Whoa:
    MsgBox Err.Description
End Sub 
```

所以这就是你的最终代码的样子。它避免使用`.Select`or `.Activate`。它还避免使用`Selection`并找到需要复制的确切范围和需要复制的**确切****范围**。它还进行适当的错误处理。

 **```
Option Explicit

Sub Sample()
    Dim wsInput As Worksheet, wsOutput As Worksheet
    Dim rng As Range
    Dim LRowO As Long, LRowI As Long

    On Error GoTo Whoa

    '~~> Set your Output Sheet
    Set wsOutput = ThisWorkbook.Sheets("Table 1")

    '~~> Loop through all sheets
    For Each wsInput In ThisWorkbook.Worksheets
        '~~> Ensure that we ignore the output sheet
        If wsInput.Name <> wsOutput.Name Then
            '~~> Working with the input sheet
            With wsInput
                '~~> Get the last row of input sheet
                LRowI = .Range("A" & .Rows.Count).End(xlUp).Row
                '~~> Set your range for copying
                Set rng = .Range("A1:B" & LRowI)
                '~~> Copy your range
                rng.Copy
                '~~> Pasting data in the output sheet
                With wsOutput
                    '~~> Get the next available row in output sheet for pasting
                    LRowO = .Range("A" & .Rows.Count).End(xlUp).Row + 1

                    '~~> Finally paste
                    .Range("A" & LRowO).PasteSpecial Paste:=xlPasteAllUsingSourceTheme, _
                    Operation:=xlNone, SkipBlanks:=False, Transpose:=False
                End With
            End With
        End If
    Next wsInput

    Exit Sub
Whoa:
    MsgBox Err.Description
End Sub 
```**

# android - 有没有人成功地用 Lion 构建了 Android 模拟器？

> ID：11787184
> 
> 赞同：1
> 
> 时间：2012-08-02T23:18:42.047
> 
> 标签：android, android-source

我有一台运行 OSX 10.7 的视网膜 Macbook Pro，我正在尝试从源代码构建 Android。但是，我不断收到错误消息“gcc 已链接到 llvm-gcc，它不会创建可用的模拟器。”

我尝试下载和使用 gcc，但出现其他错误。

有没有人成功用 OSX 10.7 构建 Android 模拟器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T19:00:05.737

我在 OS X 10.6 上，但同样我在构建 ICS 和更早版本时遇到了麻烦。看来，诀窍是获取 10.6（JB 及以上）或 10.5（ICS 及以下）的 SDK。

这是一个说明[如何在 10.6 机器上获取 10.5 SDK](https://stackoverflow.com/a/6293605/154306)的答案。

# node.js - 使用 Azure 表存储 Node.js 接口一次删除多个实体

> ID：11787186
> 
> 赞同：0
> 
> 时间：2012-08-02T23:18:56.393
> 
> 标签：node.js, rest, azure, azure-storage, azure-table-storage

我得到的唯一删除操作一次删除一个：[https ://www.windowsazure.com/en-us/develop/nodejs/how-to-guides/table-services/#delete-entity](https://www.windowsazure.com/en-us/develop/nodejs/how-to-guides/table-services/#delete-entity)

我想要的相当于SQL语句

```
DELETE FROM MyTable WHERE PartitionKey = 'something' 
```

该页面上还有一种发送批次的方法（尽管我无法使用删除，但有人知道为什么吗？）。但是，我首先必须进行选择以获取要删除的实体列表，以便获取它们的 RowKey。我想知道是否可以仅在对 Azure 的一个请求中执行此操作。

提前致谢。

更新：这是我尝试过的代码，但它不起作用。我已经确认调用函数时所有参数都是正确的。

```
// subAccts all have PartitionKey = pKey
function deleteAccount(pKey, rKey, subAccts, callback) {
  var tasks = subAccts; // rename for readability
  tasks.push({ PartitionKey: pKey, RowKey: rKey });
  tableService.beginBatch();
  async.forEach(tasks, function(task, callback) {
    tableService.deleteEntity(myTable, task, function(error) {
      if (!error) {
        callback(null);
      }
      else {
        console.log(error);
        callback(error);
      }
    });
  }, function(error) {
    if (error) {
      console.log(error);
      callback(error);
      return;
    }
    tableService.commitBatch(callback);
  });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T05:17:01.090

如果您事先不知道要删除的实体列表，则必须先查询才能找到它们。

不过，您可能会考虑重组您的表格。如果不只是将这些实体放在同一个分区中，而是将它们全部放在同一个表中（单独），则可以删除该表。这通常用于删除旧日志...创建像 log_january、log_february 这样的表，然后您可以使用单个命令一次删除整个月。

**编辑**

库中似乎存在错误。尝试此编辑作为解决方法：

```
BatchServiceClient.prototype.addOperation = function (webResource, outputData) {
    if (azureutil.objectIsNull(outputData)) {
        outputData = '';
    }

    if (webResource.httpVerb !== 'GET') {
        webResource.headers[HeaderConstants.CONTENT_ID] = this.operations.length + 1;

        if (webResource.httpVerb !== 'DELETE') {
            webResource.headers[HeaderConstants.CONTENT_TYPE] = 'application/atom+xml;type=entry';
        } else {
            delete webResource.headers[HeaderConstants.CONTENT_TYPE];
        }
... 
```

我在开发分支中创建了一个拉取请求来解决这个问题：[https](https://github.com/WindowsAzure/azure-sdk-for-node/pull/300) ://github.com/WindowsAzure/azure-sdk-for-node/pull/300 。

在解决此问题之前，您始终可以克隆我的 fork ( [https://github.com/smarx/azure-sdk-for-node](https://github.com/smarx/azure-sdk-for-node) )、签出`dev`分支等等`npm install`，而不是手动编辑代码。

# c# - 使用 WIQL 从 TFS 获取分配给用户的 AccountName

> ID：11787188
> 
> 赞同：0
> 
> 时间：2012-08-02T23:19:07.397
> 
> 标签：c#, tfs, wiql

我有这样的 wiql 从 TFS 获取工作项目：

```
SELECT [System.Id], [System.Title], [Area Path], [Iteration Path], [Priority], [Test Owner], [Assigned To],[System.State], [System.Reason]
FROM WorkItems
WHERE [System.WorkItemType] = 'Feature' and
      [Iteration Path] != '' and
      [Area Path] Under 'MyProject' 
```

字段`[Assigned To]`返回用户的显示名称。是否可以获取该用户的 AccountName？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T16:42:35.167

可以获取 AccountName *。*但这并不简单。具有用户名值的字段（如 AssignedTo 字段）存储在 TFS 数据库中作为对身份的引用，而不仅仅是作为显示名称，因此您会认为有一些简单的方法可以检索与该身份关联的任何字段，但那是只是不是 TFS 设计的一部分——反正还不是。

甚至不支持按显示名称查询帐户列表。相反，我发现您唯一的选择是深入帐户列表并将显示名称与身份匹配。该身份具有您的 AccountName。当然，此搜索的时间和资源使用会随着您的用户列表的增长而增长。我不知道这对你来说是否值得这么麻烦，但这个网站展示了如何从一个显示名称（在 VB 中）中提取一个 AccountName：http: [//www.developerfusion.com/community/blog-entry/8389748 /retrieving-an-identity-from-team-foundation-server-using-only-the-display-name/](http://www.developerfusion.com/community/blog-entry/8389748/retrieving-an-identity-from-team-foundation-server-using-only-the-display-name/)

# javascript - 将数据从 js 发送到 servlet 并取回响应

> ID：11787193
> 
> 赞同：1
> 
> 时间：2012-08-02T23:19:21.400
> 
> 标签：javascript, jquery, ajax, json, jsp

我是 ajax 和 js 的新手。

我有一个简单的jsp页面，里面有一个html。我有一个随附的 javascript 文件，其中定义了我的所有函数。我有一个这样的函数可以将一些 json 数据发送到 servlet。 **我需要帮助才能将来自 servlet 的响应仅检索到调用 js 文件中。**

我让 servlet 启动并使用 post 方法运行，因为它接收到 ajax 调用。

假设 js 文件名为：First.js，servlet 为 FirstServlet.java

**将数据从 js 发送到 servlet 的 Javascript 部分：**

```
 var fullpath="contextpath/FirstServlet";

    //Sending the tradedata using ajax to the FirstServlet
    $.ajax({
        dataType: 'json',
        url: fullpath,
        type: 'POST',
        data: {jsonText:jsonText}

  }); 
```

**在 servlet 方面**，我对数据进行了一些修改并构建了一个动态 html。servlet 的输出将类似于添加到字符串变量中的内容。

```
 <div>
   <table>
     <tbody>
        <tr>
           <td>
            <input name="hi" value="hello" />
            </td>
           <td>
            <input name="bye" value="goodbye" />
            </td>
        </tr>
     </tbody>
   </table>
  </div> 
```

我想将此标记返回到调用它的同一 javascript 文件**//这部分需要解决方案。**

**最终目标：** 然后我想将它附加到我在 jsp 文件上的 div 标签中//我将使用 jquery 来添加它。这样我就可以在不使用 iframe 的情况下刷新 div 容器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:39:51.457

如果您使用的是 Java Servlet，则需要构建一个自定义 HttpServlet，该 HttpServlet 必须实现功能`doGet(HttpServletRequest req, HttpServletResponse resp)`和`doPost(HttpRequest req, HttpResponse resp)`. 一旦您将特定域名（`contextpath/FirstServlet`在您的示例中）映射到您的自定义 servlet 类（在您的 web.xml 文件中），servlet 将自动将任何`get`或`post`请求路由到您的 doGet 或 doPost 函数。

然后您可以使用 HttpServletRequest ([参考](http://docs.oracle.com/javaee/5/api/javax/servlet/http/HttpServletRequest.html)) 可用的函数来处理接收到的数据。然后，您将要发送回客户端的任何内容放入 HttpServletResponse（参见下面的示例链接），servlet 会自动将 HttpServletResponse 发送回客户端。

为了从客户端接收响应数据，您只需添加一个回调函数（接受两个参数，请参阅[此处](http://api.jquery.com/jQuery.ajax/)的参考）作为 ajax 请求的最后一个参数，如下所示：

```
$.ajax({
    dataType: 'json',
    url: fullpath,
    type: 'POST',
    data: {jsonText:jsonText}

}, function(responseData, textStatus) {
    console.log(responseData);
    //do something with responseData
}); 
```

[这是一个简单的示例 servlet](http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/Servlet-Tutorial-First-Servlets.html)

# python - Python按增量修改csv列

> ID：11787195
> 
> 赞同：2
> 
> 时间：2012-08-02T23:19:29.753
> 
> 标签：python, csv, time

首先，我为糟糕的标题道歉；我不知道如何总结我的问题。好的，这是我的 .csv 文件的前几行。第一列是时间戳。我每秒从样本中获取此数据的程序 24 次，因此有 24 行以 15:40:15 开头，24 行以 15:40:16 开头，依此类推。我希望时间戳增加 1/24 秒或 0.042 秒的增量，而不是具有相同时间戳的 24 行。所以 15:40:15.042、15:40:15.084 等等。

另一个问题是第一秒没有 24 行，因为我们从第二秒的中间开始。例如，只有 13 个 15:40:14 行。对于那些它最好从 15:40:15.000 倒数并为每一行减去 0.042 秒。

我怎样才能在 Python 中做到这一点？提前致谢！

```
CPUtime,Displacement Into Surface,Load On Sample,Time On Sample,Raw Load,Raw Displacement
15:40:14,-990.210561,-0.000025,1.7977E+308,-115.999137,-989.210000
15:40:14,-989.810561,-0.000025,1.7977E+308,-115.999105,-988.810000
15:40:14,-989.410561,-0.000025,1.7977E+308,-115.999073,-988.410000
15:40:14,-989.010561,-0.000025,1.7977E+308,-115.999041,-988.010000
15:40:14,-988.590561,-0.000025,1.7977E+308,-115.999007,-987.590000
15:40:14,-988.170561,-0.000025,1.7977E+308,-115.998974,-987.170000
15:40:14,-987.770561,-0.000025,1.7977E+308,-115.998942,-986.770000
15:40:14,-987.310561,-0.000025,1.7977E+308,-115.998905,-986.310000
15:40:14,-986.870561,-0.000025,1.7977E+308,-115.998870,-985.870000
15:40:14,-986.430561,-0.000025,1.7977E+308,-115.998834,-985.430000
15:40:14,-985.990561,-0.000025,1.7977E+308,-115.998799,-984.990000
15:40:14,-985.570561,-0.000025,1.7977E+308,-115.998766,-984.570000
15:40:14,-985.170561,-0.000025,1.7977E+308,-115.998734,-984.170000
15:40:15,-984.730561,-0.000025,1.7977E+308,-115.998698,-983.730000
15:40:15,-984.310561,-0.000025,1.7977E+308,-115.998665,-983.310000
15:40:15,-983.890561,-0.000025,1.7977E+308,-115.998631,-982.890000
15:40:15,-983.490561,-0.000025,1.7977E+308,-115.998599,-982.490000
15:40:15,-983.090561,-0.000025,1.7977E+308,-115.998567,-982.090000 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:02:35.240

我将添加到[@robert king 的答案](https://stackoverflow.com/a/11787324/4279)中，您可以使用它[`itertools.groupby()`](http://docs.python.org/library/itertools.html#itertools.groupby)来对具有相同时间戳的行进行分组：

```
import csv
import shutil
from itertools import groupby

n = 24
time_increment = 1./n
fractions = [("%.3f" % (i*time_increment,)).lstrip('0') for i in xrange(n)]

with open('input.csv', 'rb') as f, open('output.csv', 'wb') as fout:
     writer = csv.writer(fout)
     # assume the file is sorted by timestamp
     for timestamp, group in groupby(csv.reader(f), key=lambda row: row[0]):
         sametime = list(group) # all rows that have the same timestamp
         assert n >= len(sametime)
         for i, row in enumerate(sametime, start=n-len(sametime)):
             row[0] += fractions[i] # append fractions of a second
         writer.writerows(sametime)

shutil.move('output.csv', 'input.csv') # update input file 
```

*   'b' 文件模式对于 Python 2 中的 csv 是必需的，否则可能跨越多个物理行的条目将不起作用
*   如果少于`n`具有相同时间戳的条目，则代码假定它们是一秒结束后的连续值

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T23:35:21.240

打开 csv 文件并按照[http://docs.python.org/library/csv.html创建一个 csv 阅读器](http://docs.python.org/library/csv.html)

还根据[http://docs.python.org/library/csv.html创建一个 csv 编写器](http://docs.python.org/library/csv.html)

现在循环遍历文件的每一行。在每一行上，修改时间戳，然后将其写入新的 csv 文件。

如果您希望新的 csv 文件替换旧的 csv 文件，最后使用 shutil [http://docs.python.org/library/shutil.html](http://docs.python.org/library/shutil.html)替换它。

我建议在你的循环中你有一个名为“current_timestamp”的变量和一个名为“current_increment”的变量。如果行中的时间戳等于 current_timestamp，只需添加增量，否则适当更改它们。

# android - 构建基于网站的 Android shell 应用程序的最佳方法是什么？

> ID：11787196
> 
> 赞同：0
> 
> 时间：2012-08-02T23:19:32.857
> 
> 标签：android, shell, video-streaming, image

主题：为像 YouTube 这样的网站构建基于网站的 Android shell 应用程序的最佳方式是什么？有什么限制或缺点？

我们有一个网站，允许用户上传和查看视频和图片。现在我们正计划构建一个 Android shell 应用程序。基本功能是查看视频和图片，拍摄视频和图片，上传视频和图片。

您能否向我们推荐一个快速开发此类应用程序的好方法或任何有趣的方法？

谢谢

# php - 当文件 io 打开的流被阻塞时会发生什么？

> ID：11787197
> 
> 赞同：1
> 
> 时间：2012-08-02T23:19:46.407
> 
> 标签：php, file-io, stream, popen

考虑这里的代码片段：

```
$handle = popen("some command that generates an infinite stream of output to stdout", "r");

while ($line = fgets($handle)) {
     echo $line;
     sleep(3);
} 
```

我的问题是：在 sleep(3) 期间实际发生了什么，传递给 popen() 的命令仍在喷出输出？这是缓冲到 PHP 的内存吗？

输出是否有可能被丢弃？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:31:12.143

它取决于操作系统。数据可能会被缓冲，其他程序的输出调用可能会阻塞，或者它们的某种组合。

# objective-c - 在指定的初始化程序中初始化实例对象？

> ID：11787198
> 
> 赞同：0
> 
> 时间：2012-08-02T23:19:55.563
> 
> 标签：objective-c, object, inheritance, designated-initializer

我有一个具有宽度和高度属性的 Rectangle 类。它还有一个名为*origin* (-(XYPoint *) origin ) 的实例属性/对象。下面是我指定初始化程序的代码，其中我将 XYPoint 对象作为参数传递。如果我将 XYPoint 类的属性作为此方法中的参数，然后初始化 XYPoint 对象并在方法内为其分配内存，有没有办法（或者可以）？否则，我必须在我的主程序中创建一个 XYPoint 对象并将其作为参数传递，这需要输入更多代码。

```
-(id) initWithWidth:(int)w andHeight:(int)h andOrigin:(XYPoint *)o
{
    self = [super init];
    if (self) {
        [self setWidth: w andHeight: h];
        self.origin = o;
    }
    return self;
} 
```

PS-我是编程和Objective C的新手，所以如果我在我的问题中陈述了技术上的错误，请原谅我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:29:47.370

就个人而言——我尽量避免使用带参数的初始化程序。我认为这会导致编写更多代码和不灵活。我只为两件事使用指定的初始化程序：

*   使用在对象初始化后不得更改的属性初始化对象
*   用构造它绝对需要的属性初始化一个对象，以后不能指定

一般来说，对于 Rectangle 类，我会这样使用：

```
Rectangle * r = [ [ Rectangle alloc ] init ] ;
r.x = x ;
r.y = y ;
r.origin = o ;

// use r 
```

并且除了上面列出的条件外，根本不使用指定的初始化模式。（例如，创建不可变的 Rectangle 实例）

最后，可能不需要创建一个 Rectangle 类——只需使用 CGRect/NSRect 原始结构。

# java - 获取对象数组数据

> ID：11787202
> 
> 赞同：0
> 
> 时间：2012-08-02T23:20:49.817
> 
> 标签：java

所以我首先声明一个类的这个对象：

```
static enterprise[] en = new enterprise[10]; 
```

然后，在主要内部：

```
for(int i=0;i<=9;i++){
    System.out.println("Insert name of the " + (i+1) + "ª enterprise");
    en[i] = new enterprise(i);
    Scanner scanner = new Scanner(System.in);
    en[i].setName(scanner.next());
    System.out.println(en[i].Name);
    } 
```

然后，在同一类的另一个方法中：

```
for(int i = 0; i<=9;i++){
    System.out.println(en[i].index + "- " + en[i].Name);
} 
```

因此，如果一开始我插入第一个企业 A，第二个 B，C，D，E，F，G，H，I，J.. 我应该得到输出 1 A 2 B 等，但我得到 9 J 10次。为什么会这样？

编辑：这里是企业类： http: [//pastebin.com/gUCWRRgK](http://pastebin.com/gUCWRRgK)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:22:05.963

这是因为您的字段被声明为静态的。

```
public class enterprise {
    static String Name;
    static int index; 
```

当一个字段是静态的时，这意味着该变量与该类相关联。每个实例的静态变量不能有不同的值。

应该是这样的：

```
public class enterprise {
    String Name;
    int index; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:25:03.087

那是因为您将变量设为静态。删除静态关键字，它会工作。`static`不像在 C 中那样在 Java 中工作。

# twitter - 将 Twitter 帐户链接到 FB 上的新公司页面返回错误消息

> ID：11787205
> 
> 赞同：0
> 
> 时间：2012-08-02T23:21:12.593
> 
> 标签：twitter

几天前，我在 FB 上创建了一个链接到我的个人帐户的公司页面，但是当我试图将我的 Twitter 帐户链接到公司页面时，我收到了这个错误。Twitter 帐户可以很好地链接到我的个人帐户页面，但是当我尝试链接到公司页面时出现以下错误...

“错误：此端点已被弃用。要暂时重新启用它，您可以禁用“august_2012”平台迁移。它将在 2012 年 8 月 1 日永久禁用。

我在链接时在 Facebook 错误的 Stack Overflow 上看到了一篇关于此问题的帖子[：如何修复？](https://stackoverflow.com/questions/11769449/facebook-error-while-linking-how-to-fix)

但我不明白 Igy 建议的修复方法：

“您可以通过 facebook.com/help/?page=220217228006012 从 Facebook 获得有关用户/帐户/站点问题的帮助 - 这不是解决这些问题的正确论坛（有关更多信息，请参阅 facebook.stackoverflow.com/faq#questions） – 伊吉 13 小时前”

我访问了 Igy 提供的两个链接，但找不到与此问题有关的任何内容。

对不起，我不是编码员。在下辈子。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:25:38.180

回复说您可以通过提供的链接为您的 Facebook 用户、Facebook 帐户或 Facebook 网站获得帮助。本网站不适用于您拥有的一般 Facebook 帮助。请访问链接，您可以通过搜索找到您正在寻找的答案。

# xml - XQuery 查询计数

> ID：11787206
> 
> 赞同：2
> 
> 时间：2012-08-02T23:21:16.523
> 
> 标签：xml, xquery

我是第一次学习 XQuery，但在使用特定查询时遇到了麻烦。

找出生产至少两台速度至少为 2.00 的 PC 的 Maker 的名字。

我已经得到了查询的 Speed<=2.00 部分，但我不太清楚如何按出现次数对其进行分组。

尝试：（不输出任何内容）

```
let $doc := doc("PC.xml")
for $x in $doc/Products/Maker/PC
where $x/Speed>=2.00 and count($x)>=2
return $x/../@name 
```

PC.xml：

```
<Products>
    <Maker name = "A">
        <PC model = "1001" price = "2114">
            <Speed>2.66</Speed>
            <RAM>1024</RAM>
            <HardDisk>250</HardDisk>
        </PC>
        <PC model = "1002" price = "995">
            <Speed>2.10</Speed>
            <RAM>512</RAM>
            <HardDisk>250</HardDisk>
        </PC>
        <Laptop model = "2004" price = "1150">
            <Speed>2.00</Speed>
            <RAM>512</RAM>
            <HardDisk>60</HardDisk>
            <Screen>13.3</Screen>
        </Laptop>
        <Laptop model = "2005" price = "2500">
            <Speed>2.16</Speed>
            <RAM>1024</RAM>
            <HardDisk>120</HardDisk>
            <Screen>17.0</Screen>
        </Laptop>
    </Maker>
    <Maker name = "E">
        <PC model = "1011" price = "959">
            <Speed>1.86</Speed>
            <RAM>2048</RAM>
            <HardDisk>160</HardDisk>
        </PC>
        <PC model = "1012" price = "649">
            <Speed>2.80</Speed>
            <RAM>1024</RAM>
            <HardDisk>160</HardDisk>
        </PC>
        <Laptop model = "2001" price = "3673">
            <Speed>2.00</Speed>
            <RAM>2048</RAM>
            <HardDisk>240</HardDisk>
            <Screen>20.1</Screen>
        </Laptop>
        <Printer model = "3002" price = "239">
            <Color>false</Color>
            <Type>laser</Type>
        </Printer>
    </Maker>
    <Maker name = "H">
        <Printer model = "3006" price = "100">
            <Color>true</Color>
            <Type>ink-­-jet</Type>
        </Printer>
        <Printer model = "3007" price = "200">
            <Color>true</Color>
            <Type>laser</Type>
        </Printer>
    </Maker>
</Products> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:13:06.837

egads，我想通了！

```
let $doc := doc("PC.xml")/Products
for $maker in $doc//Maker
where count($maker/PC[Speed >= 3.00]) >= 2
return data($maker/@name) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T04:44:29.547

**使用这个更简单的表达式：**

```
/*/Maker[PC[number(Speed) ge 2.00][2]]/@name/string() 
```

# rvm - 捆绑程序安装的权限问题

> ID：11787207
> 
> 赞同：0
> 
> 时间：2012-08-02T23:21:21.483
> 
> 标签：rvm, capistrano, webistrano

我正在为我的 rails 应用程序编写 cap/deploy 脚本。在我的服务器上，我使用 RVM 来管理我的 ruby​​ 安装。

我看到的问题是，即使我已将 runner/user/group 设置为正确的用户，我在尝试安装 gems 时却遇到权限错误。

这是我看到的错误：

```
** loading stage recipe 'deploy'
** loading stage recipe 'init_config'
** loading stage recipe 'nginx'
executing locally: "git ls-remote ############################### ec2"
command finished in 1113ms
* executing `deploy:setup'
triggering before callbacks for `deploy:setup'
* executing `init_config'
* executing "whoami"
servers: ["ec2-23-23-24-42.compute-1.amazonaws.com"]
[ec2-23-23-24-42.compute-1.amazonaws.com] executing command
** [out :: ec2-23-23-24-42.compute-1.amazonaws.com] ubuntu
command finished in 529ms
* executing "gem install bundler"
servers: ["ec2-23-23-24-42.compute-1.amazonaws.com"]
[ec2-23-23-24-42.compute-1.amazonaws.com] executing command
** [out :: ec2-23-23-24-42.compute-1.amazonaws.com] ERROR:  While executing gem ... (Gem::FilePermissionError)
** [out :: ec2-23-23-24-42.compute-1.amazonaws.com] You don't have write permissions into the /home/ubuntu/.rvm/gems/ruby-1.9.2-p290 directory.
command finished in 1026ms
*** failed: "bash --login -c 'gem install bundler'" on ec2-23-23-24-42.compute-1.amazonaws.com 
```

这是我的出口上限文件：

```
load 'deploy'

# ================================================================
# ROLES
# ================================================================

role :app, "ec2-23-23-24-42.compute-1.amazonaws.com"

# ================================================================
# VARIABLES
# ================================================================

# Webistrano defaults
    set :webistrano_project, "sweet_high"
    set :webistrano_stage, "staging"

    set :application, ""

    set :branch, "ec2"

    set :bundle_disable_shared_gems, "\"1\""

    set :bundle_path, "vendor/bundler_gems"

    set :default_shell, "bash --login"

    set :deploy_to, "/data/\#{application}"

    set :deploy_via, :remote_cache

    set :domain, ""

    set :environment, "staging"

    set :group, "ubuntu"

    set :nginx_conf_path, "/etc/nginx/sites-enabled"

    set :password, "deployment_user(SSH user) password"

    set :rails_env, "staging"

    set :repository, "t"

    set :runner, "ubuntu"

    set :rvm_bin_path, "/home/#{user}/.rvm/bin/rvm"

    set :rvm_type, :user

    set :scm, :git

    set :scm_password, "your_SVN_password"

    set :scm_username, "your_SVN_user"

    set :ssh_options, {:forward_agent => true,:paranoid => false,:keys => ["/home/#{user}/.ssh/rails_app_server.pem"]}

    set :use_sudo, true

    set :user, "ubuntu"

# ================================================================
# TEMPLATE TASKS
# ================================================================

    # allocate a pty by default as some systems have problems without
    default_run_options[:pty] = true

    # set Net::SSH ssh options through normal variables
    # at the moment only one SSH key is supported as arrays are not
    # parsed correctly by Webistrano::Deployer.type_cast (they end up as strings)
    [:ssh_port, :ssh_keys].each do |ssh_opt|
      if exists? ssh_opt
        logger.important("SSH options: setting #{ssh_opt} to: #{fetch(ssh_opt)}")
        ssh_options[ssh_opt.to_s.gsub(/ssh_/, '').to_sym] = fetch(ssh_opt)
      end
    end

# ================================================================
# CUSTOM RECIPES
# ================================================================

before "deploy:setup", :init_config
after "deploy:setup", :setup_cleanup
namespace :init_config do
    desc <<-DESC
       Created directory structure, changes ownership, etc...
    DESC

    task :default do
        run "gem install bundler"
        run "sudo mkdir -p #{deploy_to}"
        run "sudo chown -R #{user}:#{group} #{deploy_to}"
        run "mkdir -p #{shared_path}/config"
        run "mkdir -p #{shared_path}/config"
        File.open("/home/#{user}/.ssh/id_rsa", "rb").each_line{ |line|
            run "echo #{line} >> ~/.ssh/id_rsa"
        }
        run "chown #{user}:#{group} ~/.ssh/id_rsa"
       run "chmod 600 ~/.ssh/id_rsa"    
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:34:55.477

您的任务`init_config:default`需要少量补充：

```
 run "sudo chown -R #{user}:#{group} /home/#{user}/.rvm"
    run "gem install bundler" 
```

# php - 如何撤销插入的最后一个 id？

> ID：11787209
> 
> 赞同：0
> 
> 时间：2012-08-02T23:21:24.943
> 
> 标签：php, mysqli

我认为我没有正确执行此操作，问题是因为我使用 ajax 在后台的 php 脚本中执行此代码，所以我无法检查我可能遇到的任何错误。

变量`$lastID`实际上是从上次插入的“ImageId”字段中检索 id 还是根本不这样做？如果它没有检索最后一个 ID，那么我实际上需要做什么才能检索最后一个 ImageId id？

ImageId 是一个自动增量字段：

下面是代码：

```
$imagesql = "INSERT INTO Image (ImageFile) VALUES (?)";

if (!$insert = $mysqli->prepare($imagesql)) {
    // Handle errors with prepare operation here
}

//Dont pass data directly to bind_param store it in a variable
$insert->bind_param("s", $img);

//Assign the variable
$img = 'ImageFiles/' . $_FILES['fileImage']['name'];

$insert->execute();

//RETRIEVE IMAGEID FROM IMAGE TABLE

$lastID = $mysqli->insert_id; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:28:57.400

你应该使用

```
$mysqli->insert_id; 
```

获取最后插入的 id。官方 PHP 文档页面在[这里](http://php.net/manual/en/mysqli.insert-id.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:30:28.420

echo $lastID 它将被发送回启动对 PHP 的 ajax 调用的 JavaScript 代码。将其传递给回调函数并检查它是否正确

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T23:30:56.943

`$mysqli->insert_id`应该返回自动递增的字段 ( `ImageId`)。见[Mysqli.insert-id](http://php.net/manual/en/mysqli.insert-id.php)

您还可以将 PHP 错误记录到文件中，打开终端`tail -f <log file>`，然后可以查看发生了什么。（这假设您具有相关访问权限）。

# java - Jsoup 选择器“不”

> ID：11787214
> 
> 赞同：0
> 
> 时间：2012-08-02T23:22:06.960
> 
> 标签：java, html, html-parsing, wiki, jsoup

这段代码在这里：

```
Document doc = Jsoup.connect("http://wikitravel.org/en/San_Francisco").get();
System.out.println(doc.select("h2:contains(Get around) ~ *:not(h2:contains(See) ~ *)")); 
```

输出[http://pastebin.com/gkcCfr1F](http://pastebin.com/gkcCfr1F)。是否有一个选择器可以使“非”选择器包含在内？现在它正在删除“see”之后的所有内容，当我想删除最后一个带有 id="see" 的 h2 标记以及其他所有内容时，因为我正在尝试解析 wiki 的各个部分。

我想获得的最终输出是： http: [//pastebin.com/ntpVrgui](http://pastebin.com/ntpVrgui)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:13:03.360

我会做这样的事情：

获取内容 div ：

```
 StringBuilder sb = new StringBuilder();
    boolean start = false;
    Document doc = Jsoup.connect("http://wikitravel.org/en/San_Francisco").get();
            Elements content = doc.select("#content");
            for (Element element : content) {
                /*Pseudo code
                   if element is h3 and it contains span with id Navigating and if start is  
false append it to stringbuilder, set start to true, else append everything in between until you reach h2 with span id See
                  */                
    } 
```

# sas - SAS：没有找到有效的观察错误 - 简单回归

> ID：11787219
> 
> 赞同：0
> 
> 时间：2012-08-02T23:23:00.580
> 
> 标签：sas, regression

我有大面板时间序列数据集。我希望做这个基本的 SAS 回归代码：

```
proc sort data=dataset;
by time_id;
run;

ods output parameterestimates=pe;
proc reg data=dataset;
by time_id;
model y=x1 x2 x3....x15;
quit;
run; 
```

运行代码时出现此错误：

```
ERROR: No valid observations are found.
NOTE: The above message was for the following BY group:
      time_id=1
ERROR: No valid observations are found.
NOTE: The above message was for the following BY group:
      time_id=2.... 
```

为什么？我的 time_id 变量存在...是因为我有太多 time_id 变量吗？如果我选择firm_id，它可以工作，但我想要time_id。

这是我的数据示例（面板时间序列）：

```
y     x  firm_id time_id
3.4   100   1   1
2.3   200   1   2
6.5   653   1   3
3     50    2   1
4.34  23    2   2
4.8   55    2   3
1.311 400   3   1
1.23  200   3   2
5.63  50    3   3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T08:01:35.570

如果给定 time_id 的特定 x 变量的所有值都缺失，您将收到此错误消息。请看下面的示例，其中 time_id 1 的 x2 的所有值都缺失，当您运行代码时，结果输出窗口会详细说明问题（缺失观察的数量与观察的数量相同）。它适用于firm_id，因为您的值少于time_id，因此并非每个firm_id 都缺少特定x 变量的所有值。

```
data have;
input y x1 x2 firm_id time_id;
cards;
3.4   100   .   1   1
2.3   200   200 1   2
6.5   653   653 1   3
3     50    .   2   1
4.34  23    23  2   2
4.8   55    55  2   3
1.311 400   .   3   1
1.23  200   200 3   2
5.63  50    50  3   3
;
run;

proc sort data=have;
by time_id;
run;

ods output parameterestimates=pe;
proc reg data=have;
by time_id;
model y=x1-x2;
quit;
run; 
```

# iphone - 如何在 iOS 5 中将导航栏颜色更改为纯色

> ID：11787220
> 
> 赞同：0
> 
> 时间：2012-08-02T23:23:01.267
> 
> 标签：iphone, xcode

嗨，我想将 uinaviagtion 栏颜色更改为没有渐变或色调的纯色，按钮也是。如何使用 iOS 5 做到这一点？

另外，当我设置 uinaviagtion 栏的标题时，文本会收到一个小阴影，如何删除文本阴影/边框？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:56:28.497

您必须使用自定义图像来实现这一点：

```
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"myImage.png"] forBarMetrics:UIBarMetricsDefault]; 
```

对于条形按钮项目图像：

```
 UIBarButtonItem *barButton = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"myImage.png"] style:UIBarButtonItemStylePlain target:self action:@selector(mySelector)];

  self.navigationItem.rightBarButtonItem = barButton; 
```

或者

```
 self.navigationItem.backBarButtonItem = barButton; 
```

# iphone - 按下 UIAlert 时在 TweetSheet 中添加文本

> ID：11787222
> 
> 赞同：0
> 
> 时间：2012-08-02T23:23:05.557
> 
> 标签：iphone, ios, ios5, twitter

谁能告诉我当按下 UIAlert 标题按钮时如何在 TweetSheet 中添加文本？

目前我正在使用此代码来实现它，但到目前为止失败了。

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {
    NSString *title = [alertView buttonTitleAtIndex:buttonIndex];

    TWTweetComposeViewController *tweetSheet = [[TWTweetComposeViewController alloc] init];

    if ([title isEqualToString:@"Add custom text"]) {
        UIAlertView *alert= [[UIAlertView alloc] initWithTitle:@"Add a template" message:nil delegate:self cancelButtonTitle:@"Hi it was nice meeting you" otherButtonTitles:nil, nil];
        [alert show];
        [alert release];
    }

    if ([title isEqualToString:@"Hi it was nice meeting you"]) {
        [tweetSheet setInitialText:@"hey it was nice meeting you"];
    }

} 
```

谁能告诉我这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T22:44:27.150

你不是在展示你的`TWTweetComposeViewController`，你可以通过添加来做到这一点：

```
[self presentModalViewController:tweetSheet animated:YES]; 
```

我猜这段代码只用于一个简单的测试推文。对于一个严肃的项目，您应该始终：

*   `+(BOOL)canSendTweet`在尝试显示之前检查用户是否可以通过调用来发送推文`TWTweetComposeViewController`

*   如果不确定要设置的属性（文本、图像、网址），则需要检查添加它们是否成功 : `-(BOOL)addImage:(UIImage *)image`，如果成功`-(BOOL)addURL:(NSURL *)url`则`-(BOOL)setInitialText:(NSString *)text`全部返回，否则返回。`YES``NO`

*   您可以设置完成处理程序以根据用户的决定执行不同的操作（发送推文/取消）

从 2011 年开始的关于 Twitter 集成的 WWDC 会议非常简单和详细，如果您需要更多信息，请观看并阅读[文档。](http://developer.apple.com/library/ios/#DOCUMENTATION/Twitter/Reference/TWTweetSheetViewControllerClassRef/Reference/Reference.html)

# ajax - dajax成功后如何调用函数？

> ID：11787225
> 
> 赞同：1
> 
> 时间：2012-08-02T23:23:22.913
> 
> 标签：ajax, django, callback, dajaxice

这是我的电话：

```
<a href="#" onclick="Dajaxice.news.newspages(Dajax.process, {'p': {{ items.previous_page_number }},})" >prev</a> 
```

ajax调用成功后如何调用javascript函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T14:13:23.513

[我在这里](https://stackoverflow.com/questions/11786717/making-jquery-plugins-work-after-an-ajax-call/11787862#11787862)找到了答案。干杯。

**JAVASCRIPT**

```
function my_callback(data){
    Dajax.process(data);
    // call my functions...
} 
```

**HTML**

```
<a href="#" onclick="Dajaxice.news.newspages(my_callback, {'p': {{ items.previous_page_number }},})" >prev</a> 
```

# android - 如何在android中交换具有不同布局的片段？

> ID：11787229
> 
> 赞同：6
> 
> 时间：2012-08-02T23:23:39.560
> 
> 标签：android, android-fragments

我正在开发一个使用片段的 android 应用程序，它更像是主/详细信息表单。我希望主要活动由左侧的列表片段组成，基于左侧选择的项目我想在右侧显示具有不同布局的片段。（注意：右边的每个片段需要不同的布局/视图）

我遇到的所有示例都通过更改其中的一些值或交换/替换具有相同布局的新片段来仅使用右侧的一个公共片段。

如果有人可以阐明这个问题，那么它将极大地帮助我。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-03T00:41:56.133

如果您使用框架布局来保存您的片段，那么它与您提到的其他那些相同。您只需实例化您的片段（无论布局如何）并将其交换到框架布局中代替另一个。

如果您已将片段硬编码到 XML 中，您将无法做到这一点（据我所知）。

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/frames"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_above="@id/hline1"
    android:layout_below="@id/horizontalline"
    android:orientation="horizontal" >
    <FrameLayout
        android:id="@+id/leftpane"
        android:layout_width="0px"
        android:layout_height="match_parent"
        android:layout_weight=".4" />
    <TextView
        android:id="@+id/verticalline"
        android:layout_width="2dp"
        android:layout_height="match_parent"
        android:background="@color/bar_background"
        android:gravity="center_horizontal"
        android:paddingLeft="5dip"
        android:paddingRight="5dip" />
    <FrameLayout
        android:id="@+id/rightpane"
        android:layout_width="0px"
        android:layout_height="match_parent"
        android:layout_weight="1" >
    </FrameLayout>
</LinearLayout> 
```

然后使用框架布局的 id 和实例化片段的名称将片段放入框架布局中。

```
EventListFragment eventlist = new EventListFragment();
getFragmentManager().beginTransaction().replace(R.id.leftpane, eventlist).commit();

EventDetailFragment eventadd = new EventDetailFragment();
getFragmentManager().beginTransaction().replace(R.id.rightpane, eventadd).commit(); 
```

当您想更改内容时，请再次执行相同的操作（以下将用新的/不同的片段替换右窗格中的片段，该片段可以拥有自己的、不同的布局与之关联）：

```
EventSuperDetailFragment eventsuper = new EventSuperDetailFragment();
getFragmentManager().beginTransaction().replace(R.id.rightpane, eventsuper).commit(); 
```

# sql - sql查询将某些记录推到顶部

> ID：11787232
> 
> 赞同：1
> 
> 时间：2012-08-02T23:24:03.147
> 
> 标签：sql

我用 mySQL 查询循环浏览论坛主题，但 id 喜欢记录，该字段总是`sticky`被推`1`到顶部，或者首先，然后循环其余部分。

我怎么能这样做？

目前它们的顺序是`ORDER BY last_post DESC`（`last_post`作为日期时间）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:27:02.243

我认为`ORDER BY sticky DESC, last_post DESC`应该工作。

# algorithm - 为什么插入2-3-4树时节点分裂？

> ID：11787233
> 
> 赞同：5
> 
> 时间：2012-08-02T23:24:09.133
> 
> 标签：algorithm, 2-3-4-tree

在下面描绘的[2-3-4 树](http://en.wikipedia.org/wiki/2-3-4_tree)中（来自[Java 中的数据结构和算法，第 2 版](https://rads.stackoverflow.com/amzn/click/com/0672324539)），为什么插入`99`会导致节点分裂，`83/92/104`因为它似乎`99`可以插入到正确的孩子（`C`孩子，进入紧接在`97`) 之后没有任何拆分？

![在此处输入图像描述](../Images/d4fffb1a3d007b3984a0413e6720c948.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T15:32:19.887

将 99 插入 C 是可以的，因为它将保持所有不变量，但如果插入总是在向下的过程中扩展 4 个节点，则算法通常更简单。然后总会有空间进行任何需要的提升和旋转。比较 C 本身已经是 4 节点的情况可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:28:16.067

保持树平衡，保证性能。插入是递归的，它会命中一个 4 节点（具有 3 个值和 4 个子节点的节点），这将导致拆分完成。

# ruby-on-rails - 回形针：不是创建拇指文件夹吗？

> ID：11787235
> 
> 赞同：0
> 
> 时间：2012-08-02T23:24:16.983
> 
> 标签：ruby-on-rails, paperclip

我正在使用回形针 gem (3.0.4)，它突然停止工作，因为它不再创建拇指文件夹，只有原始文件夹。因此，我的代码找不到上传的图像并出错。

在我的模型中，我有：

```
has_attached_file :image,
    :whiny => false,
      :path => ":rails_root/public/system/:attachment/:id/:style/:filename",
      :url => "/system/:attachment/:id/:style/:filename",
      :styles => { :thumb => "150x100#" } 
```

此代码没有更改，当我尝试渲染视图时，出现以下错误：

```
/public/system/images/52/thumb/2011-03-16_07-49-52_412.jpg not found 
```

查看我的文件系统，`/public/system/images/52/original/2011-03-16_07-49-52_412.jpg`

这可能是 ImageMagick 的问题吗？

知道是什么原因造成的以及如何解决它以确保正在创建拇指文件夹吗？感谢您的时间和帮助。

# entity-framework - Base Entity class for the sake of ID in EF Code First

> ID：11787240
> 
> 赞同：1
> 
> 时间：2012-08-02T23:24:31.603
> 
> 标签：entity-framework, ef-code-first

Does it makes sense to introduce an abstract `IdableEntity` base class, that has a `public Guid Id { get; set;}` property, and then derive all my entities from it, so I don't have to add key field to each one of them? Will I face any pitfalls if I do in theory?

I used to never do this since my DbContext model was rather simple and consisted of a few classes. Now I am designing a large entity number model that may benefit from it.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:28:43.640

Speaking from experience of this exact thing - yes it makes sense. Note that this EF base class doesn't have to be the heirarchical root though - it could inherit from a base class that implements things like [INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/ms229614.aspx), [IChangeTracking](http://msdn.microsoft.com/en-us/library/system.componentmodel.ichangetracking.aspx), etc. So your inheritance chain would look like this:

> *BaseDataClass* <- *BaseEFDataObject* <- [actual EF entities]

# jquery - jQeditRangeSlider 值

> ID：11787246
> 
> 赞同：0
> 
> 时间：2012-08-02T23:25:34.107
> 
> 标签：jquery, uislider

我正在使用 JQeditRangeSlider [jQRangeSlider 项目站点](http://ghusse.github.com/jQRangeSlider)

我正在尝试通过 ajax 将值发布回服务器，但不知道如何访问这些值（最小值和最大值）。

我试过 $("#elname").values(), .max() .... 它似乎不起作用。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:50:32.713

[在github 上 README](https://github.com/ghusse/jQRangeSlider/blob/master/Readme.md)的“使用”部分中，它显示：

```
// Get the value
var max = $("#slider").rangeSlider("max"); 
```

它还列出了这些方法：

```
min(value): gets or sets the minimum value
max(value): gets or sets the maximum value 
```

它还提到了一个`valuesChanged`事件，您可以在事件发生时侦听并运行一个方法。

# asp.net-mvc - MVC 自定义授权属性

> ID：11787252
> 
> 赞同：1
> 
> 时间：2012-08-02T23:26:10.797
> 
> 标签：asp.net-mvc, authorization, authorize-attribute

我们在这里工作的 Web 应用程序上使用 Windows 身份验证。

我扩展了 MVC 的`AuthorizeAttribute`，以便它从 web.config 文件中读取授权用户和角色。我覆盖`AuthorizeCore()`以确保当前用户是配置文件中的一个。

我和我的同事在这里进行了一些辩论。他认为如果恶意个人获得对服务器的访问权，很容易将自己添加到 web.config 中，他认为应该使用硬编码的用户和角色的标准访问属性，因此必须有人重新编译以让自己访问...或拥有一个十六进制编辑器。

好奇我将授权角色放入 web.config 的方法是否被认为是不好的做法？SO社区的集体意见是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:51:04.057

在 web.config 中存储敏感信息通常被认为是一种合理的做法。该文件不是由 IIS 提供的，通常，如果某个具有恶意意图的人设法破坏您的站点，以至于他们可以读取您的 web.config，那么您通常有比仅仅能够操纵该文件更大的安全问题. 如果您仍然担心能够读取 web.config，您可以随时加密它的内容。我个人没有这样做，但我的理解是这很容易做到。

# javascript - 在 d3.js 中将数据传递给 .call

> ID：11787254
> 
> 赞同：3
> 
> 时间：2012-08-02T23:26:13.473
> 
> 标签：javascript, d3.js

该实验基于“国家[健康与财富”](http://bost.ocks.org/mike/nations/)示例。当鼠标悬停在每个点上时，我试图显示一个工具提示样式的标签并漂浮在每个点上方。每个数据元素都有一个名为“名称”的属性，我想在工具提示中显示它。为了简洁起见，我省略了大部分不相关的代码。

```
// Create all the dots, one for each data point.
var dot = svg.append("g")
    .attr("class", "dots")
  .selectAll(".dot")
    .data(myData)
  .enter().append("circle")
    .attr("class", "dot")
    .call(position)
    .call(enableInteraction)
    .sort(order);

// Create a tooltip element.
var tooltip = svg.append("text")
    .attr("class", "tooltip");

// Assign each of the dots the various mouse events.
function enableInteraction(dot) {
  dot.on("mouseover", mouseover)
     .on("mouseout", mouseout)
     .on("mousemove", mousemove);

  function mouseover() {
    tooltip.text(???); // How do I get the name into here?
  }

  function mouseout() {
    tooltip.text("");
  }

  function mousemove() {
    var cursor = d3.mouse(this);
    tooltip.attr("x", cursor[0] + 5)
           .attr("y", cursor[1] + 5);
  }
} 
```

我尝试使用一个函数来检索名称并将其传递给 enableInteraction()，如下所示：

```
.call(enableInteraction, function(d) { return d.name; } ) 
```

但是传递的是函数对象而不是它的返回值。

那么如何让每个数据元素的名称显示在工具提示中呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:20:44.717

您可以使用柯里化技术将该信息放入您的*鼠标悬停*事件处理程序中。我不确定获取名称的语法，但这是我的想法：

```
// this function returns a function
function moveoverHandler(dot) {
    return function mouseover() {

        // I'm not sure if this is how you get the "name" property from the "dot" object 
        // Please update this as needed
        var name = dot.data("name");  

        tooltip.text(name);  
    }
} 
```

然后像这样连接处理程序：

```
dot.on("mouseover", mouseover(dot)); 
```

# android - Gstreamer 到安卓

> ID：11787256
> 
> 赞同：0
> 
> 时间：2012-08-02T23:26:38.490
> 
> 标签：android, stream, gstreamer

我正在尝试从网络摄像头获取流并将其流式传输到 android 设备。我使用 Gstreamer 抓取视频并通过 TCP 服务器将其流式传输。它的那部分工作正常。我遇到的问题是我需要制作一个自定义应用程序来接收 android 上的流并且我无法编译 gst-android（由于我不知道的原因，adb 不是可运行的，因此我无法设置flingersinks。）有什么建议吗？我可以为此使用其他东西和 gst-android 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T19:55:30.120

你的目标是哪个安卓版本？据我所知，gstreamer 的 ndk 版本在渲染视频时仍然存在问题，因为没有人提供工作视频接收器。surfaceflinger api 不适用于 ndk 应用程序：/

# delphi - 退出后程序继续运行

> ID：11787258
> 
> 赞同：0
> 
> 时间：2012-08-02T23:26:42.850
> 
> 标签：delphi, delphi-4

如果我单击表单右上角的 X，我的程序将继续运行。这也发生在 Delphi 4 中，然后我被迫进行程序重置，因为如果我不这样做，它将不会重新编译。主窗体代码：

```
unit Unit3;

interface

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  StdCtrls, ExtCtrls;

type
  TMainForm = class(TForm)
    NewButton: TButton;
    Button2: TButton;
    Button3: TButton;
    Button4: TButton;
    Button5: TButton;
    Button6: TButton;
    ExitButton: TButton;
    LockButton: TButton;
    SettingsButton: TButton;
    Label1: TLabel;
    TimeLabel: TLabel;
    Timer1: TTimer;
    procedure ExitButtonClick(Sender: TObject);
    procedure LockButtonClick(Sender: TObject);
    procedure SettingsButtonClick(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure NewButtonClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  MainForm: TMainForm;

implementation

uses Unit2, Unit1, Unit4;

{$R *.DFM}

procedure TMainForm.ExitButtonClick(Sender: TObject);
begin
if MessageBox(0, 'Are you sure you want to quit?', 'Exit Program?', +mb_YesNo +mb_ICONWARNING) = 6 then
Application.Terminate
else
end;

procedure TMainForm.LockButtonClick(Sender: TObject);
begin
MainForm.Hide;
Login.Show;
Login.LockLabel.Visible := true;
end;

procedure TMainForm.SettingsButtonClick(Sender: TObject);
begin
MainForm.Hide;
Settings.Show;
end;

procedure TMainForm.Timer1Timer(Sender: TObject);
begin
TimeLabel.Caption := TimeToStr(time);
end;

procedure TMainForm.NewButtonClick(Sender: TObject);
begin
TransForm.Show;
MainForm.Hide;
end;

end. 
```

登录表格代码：

```
unit Unit2;

interface

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  StdCtrls, Mask, inifiles, Unit1;

type
  TLogin = class(TForm)
    PassEdit: TMaskEdit;
    LoginButton: TButton;
    PassLabel: TLabel;
    InvisiButton: TButton;
    LockLabel: TLabel;
    procedure PassEditClick(Sender: TObject);
    procedure LoginButtonClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Login: TLogin;
  IniFile : TIniFile;
  appINI : TIniFile;
  Password : string;

implementation

uses Unit3;

{$R *.DFM}

procedure TLogin.PassEditClick(Sender: TObject);
begin
PassEdit.Text := '';
end;

procedure TLogin.LoginButtonClick(Sender: TObject);
begin
if Password = PassEdit.Text then begin
Login.Hide;
MainForm.Show;
LockLabel.Visible := false;
end
else
showmessage('Incorrect Password!')
end;
procedure TLogin.FormCreate(Sender: TObject);
begin
appINI := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini'));
Password := appINI.ReadString('Login','Password','');
appINI.Free;
end;

end. 
```

设置表格代码

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  StdCtrls, inifiles;

type

  TSettings = class(TForm)
    SaveButton: TButton;
    AEditA: TEdit;
    AEditB: TEdit;
    SEditB: TEdit;
    PEditB: TEdit;
    PLabelA: TLabel;
    SLabelA: TLabel;
    ALabelA: TLabel;
    PEditA: TEdit;
    SEditA: TEdit;
    BackButton: TButton;
    SettingsLabel: TLabel;
    ALabelB: TLabel;
    SLabelB: TLabel;
    PLabelB: TLabel;
    AReserveLabel: TLabel;
    BReserveLabel: TLabel;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Label8: TLabel;
    Label7: TLabel;
    procedure SaveButtonClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure BackButtonClick(Sender: TObject);
    procedure AEditAKeyPress(Sender: TObject; var Key: Char);
    procedure AEditBKeyPress(Sender: TObject; var Key: Char);
    procedure SEditAKeyPress(Sender: TObject; var Key: Char);
    procedure SEditBKeyPress(Sender: TObject; var Key: Char);
    procedure PEditAKeyPress(Sender: TObject; var Key: Char);
    procedure PEditBKeyPress(Sender: TObject; var Key: Char);
    procedure Button1Click(Sender: TObject);

  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Settings: TSettings;
  IniFile : TIniFile;
  appINI : TIniFile;
  APriceA : String;
  SPriceA : String;
  PPriceA : String;
  APriceB : String;
  SPriceB : String;
  PPriceB : String;
  change : boolean;

implementation

uses Unit3, Unit2;

{$R *.DFM}

procedure TSettings.SaveButtonClick(Sender: TObject);
//Save Button
 begin
  appINI := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini'));
  APriceA := (AEditA.Text);
  SPriceA := (SEditA.Text);
  PPriceA := (PEditA.Text);
  APriceB := (AEditB.Text);
  SPriceB := (SEditB.Text);
  PPriceB := (PEditB.Text);
  appINI.WriteString('PricesA','Adult',APriceA);
  appINI.WriteString('PricesA','Student',SPriceA);
  appINI.WriteString('PricesA','Pensioner',PPriceA);
  appINI.WriteString('PricesB','Adult',APriceB);
  appINI.WriteString('PricesB','Student',SPriceB);
  appINI.WriteString('PricesB','Pensioner',PPriceB);
  appINI.Free;
  ShowMessage('Settings Saved Successfully!');
  change := false;
 end;

procedure TSettings.FormCreate(Sender: TObject);
//Displays values as the form is created
begin
appINI := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini'));
APriceA := appINI.ReadString('PricesA','Adult','');
SPriceA := appINI.ReadString('PricesA','Student','');
PPriceA := appINI.ReadString('PricesA','Pensioner','');
APriceB := appINI.ReadString('PricesB','Adult','');
SPriceB := appINI.ReadString('PricesB','Student','');
PPriceB := appINI.ReadString('PricesB','Pensioner','');
appINI.Free;
AEditA.Text := (APriceA);
SEditA.Text := (SPriceA);
PEditA.Text := (PPriceA);
AEditB.Text := (APriceB);
SEditB.Text := (SPriceB);
PEditB.Text := (PPriceB);
end;

procedure TSettings.BackButtonClick(Sender: TObject);
//Exit Button
begin
if MessageBox(0, 'Are you sure you want to quit?', 'Exit Program?', +mb_YesNo +mb_ICONWARNING) = 6 then begin
if Change = (true) then
begin
if MessageBox(0, 'Save Changes?', 'Save Changes?', +mb_YesNo +mb_ICONWARNING) = 6 then
  begin
  appINI := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini'));
  APriceA := (AEditA.Text);
  SPriceA := (SEditA.Text);
  PPriceA := (PEditA.Text);
  APriceB := (AEditB.Text);
  SPriceB := (SEditB.Text);
  PPriceB := (PEditB.Text);
  appINI.WriteString('PricesA','Adult',APriceA);
  appINI.WriteString('PricesA','Student',SPriceA);
  appINI.WriteString('PricesA','Pensioner',PPriceA);
  appINI.WriteString('PricesB','Adult',APriceB);
  appINI.WriteString('PricesB','Student',SPriceB);
  appINI.WriteString('PricesB','Pensioner',PPriceB);
  appINI.Free;
  ShowMessage('Settings Saved Successfully!');
  Settings.Hide;
  MainForm.Show;
  change := false;
  end
else
change := false;
MainForm.Show;
Settings.Hide;
end
else
MainForm.Show;
Settings.Hide;
end
else
end;

procedure TSettings.AEditAKeyPress(Sender: TObject; var Key: Char);
var s:string;
begin
  change := true;
  s := ('1234567890.'#8); //Add chars you want to allow
  if pos(key,s) =0 then begin
    Key:=#0;
    showmessage('Only Numbers are allowed. Include cents!');
  end;
end;

procedure TSettings.AEditBKeyPress(Sender: TObject; var Key: Char);
var s:string;
begin
change := true;
  s := ('1234567890.'#8); //Add chars you want to allow
  if pos(key,s) =0 then begin
    Key:=#0;
    showmessage('Only Numbers are allowed. Include cents!');
  end;
end;

procedure TSettings.SEditAKeyPress(Sender: TObject; var Key: Char);
var s:string;
begin
change := true;
  s := ('1234567890.'#8); //Add chars you want to allow
  if pos(key,s) =0 then begin
    Key:=#0;
    showmessage('Only Numbers are allowed. Include cents!');
  end;
end;

procedure TSettings.SEditBKeyPress(Sender: TObject; var Key: Char);
var s:string;
begin
change := true;
  s := ('1234567890.'#8); //Add chars you want to allow
  if pos(key,s) =0 then begin
    Key:=#0;
    showmessage('Only Numbers are allowed. Include cents!');
  end;
end;

procedure TSettings.PEditAKeyPress(Sender: TObject; var Key: Char);
var s:string;
begin
change := true;
  s := ('1234567890.'#8); //Add chars you want to allow
  if pos(key,s) =0 then begin
    Key:=#0;
    showmessage('Only Numbers are allowed. Include cents!');
  end;
end;

procedure TSettings.PEditBKeyPress(Sender: TObject; var Key: Char);
var s:string;
begin
change := true;
  s := ('1234567890.'#8); //Add chars you want to allow
  if pos(key,s) =0 then begin
    Key:=#0;
    showmessage('Only Numbers are allowed. Include cents!');
  end;
end;
//End of Settings
procedure TSettings.Button1Click(Sender: TObject);
begin

Settings.hide;
end;

end. 
```

项目数据：

```
program Project1;

uses
  Forms,
  Unit1 in 'Unit1.pas' {Settings},
  Unit2 in 'Unit2.pas' {Login},
  Unit3 in 'Unit3.pas' {MainForm},
  Unit4 in '..\Write to ini\Unit4.pas' {TransForm};

{$R *.RES}

begin
  Application.Initialize;
  Application.CreateForm(TLogin, Login);
  Application.CreateForm(TMainForm, MainForm);
  Application.CreateForm(TSettings, Settings);
  Application.Run;
end. 
```

当我关闭它仍然运行的应用程序时，你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-03T02:46:11.023

正如大卫所说，您的`TLogin`表单被设置为`Application.MainForm`因为它是由`Application.CreateForm()`. 您只是隐藏`TLogin`表单，而不是关闭它，这就是您的应用程序没有完全退出的原因。当您关闭`TMainForm`窗体时，`TLogin`窗体仍在运行。

鉴于您显示的代码，您的`TMainForm`表单应该是唯一使用`Application.CreateForm()`. 您的所有其他表单都应根据需要创建。

您还将 Unit1、Unit2 和 Unit3（什么是 Unit4？）编码为在不需要时相互依赖，因此您也应该删除这种依赖关系。和`TLogin`单元`TSettings`应该是独立单元。

尝试更多类似的东西：

主要形式：

```
unit Unit3; 

interface 

uses 
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs, 
  StdCtrls, ExtCtrls; 

type 
  TMainForm = class(TForm) 
    NewButton: TButton; 
    Button2: TButton; 
    Button3: TButton; 
    Button4: TButton; 
    Button5: TButton; 
    Button6: TButton; 
    ExitButton: TButton; 
    LockButton: TButton; 
    SettingsButton: TButton; 
    Label1: TLabel; 
    TimeLabel: TLabel; 
    Timer1: TTimer; 
    procedure FormCreate(Sender: TObject);
    procedure FormCloseQuery(Sender: TObject; var CanClose: Boolean); 
    procedure ExitButtonClick(Sender: TObject); 
    procedure LockButtonClick(Sender: TObject); 
    procedure SettingsButtonClick(Sender: TObject); 
    procedure Timer1Timer(Sender: TObject); 
    procedure NewButtonClick(Sender: TObject); 
  protected
    procedure WndProc(var Message: TMessage); override;
  private 
    { Private declarations } 
  public 
    { Public declarations } 
  end; 

var 
  MainForm: TMainForm; 

implementation 

uses
  Unit2, Unit1, Unit4; 

{$R *.DFM} 

const
  WM_LOCK = WM_USER + 100;

procedure TMainForm.FormCreate(Sender: TObject);
begin 
  PostMessage(Handle, WM_LOCK, 0, 0);
end;

procedure TMainForm.FormCloseQuery(Sender: TObject; var CanClose: Boolean); 
begin
  if Application.MessageBox('Are you sure you want to quit?', 'Exit Program?', MB_YESNO or MB_ICONWARNING) <> IDYES then
    CanClose := False;
end;

procedure TMainForm.WndProc(var Message: TMessage);
begin
  if Message.Msg = WM_LOCK then
    LockButtonClick(nil)
  else
    inherited; 
end;

procedure TMainForm.ExitButtonClick(Sender: TObject); 
begin 
  Close;
end; 

procedure TMainForm.LockButtonClick(Sender: TObject); 
var
  Login: TLogin;
begin 
  Login := TLogin.Create(nil);
  try
    Hide; 
    Login.LockLabel.Visible := True; 
    if Login.ShowModal = mrOk then 
      Show
    else
      Application.Terminate; 
  finally
    Login.Free; 
  end;
end; 

procedure TMainForm.SettingsButtonClick(Sender: TObject); 
var
  Settings: TSettings;
begin 
  Settings := TSettings.Create(nil);
  try 
    Settings.ShowModal; 
  finally
    Settings.Free; 
  end;
end; 

procedure TMainForm.Timer1Timer(Sender: TObject); 
begin 
  TimeLabel.Caption := TimeToStr(time); 
end; 

procedure TMainForm.NewButtonClick(Sender: TObject); 
begin 
  TransForm.Show; 
  Hide; 
end; 

end. 
```

登录表格：

```
unit Unit2; 

interface 

uses 
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs, 
  StdCtrls, Mask; 

type 
  TLogin = class(TForm) 
    PassEdit: TMaskEdit; 
    LoginButton: TButton; 
    PassLabel: TLabel; 
    InvisiButton: TButton; 
    LockLabel: TLabel; 
    procedure PassEditClick(Sender: TObject); 
    procedure LoginButtonClick(Sender: TObject); 
    procedure FormCreate(Sender: TObject); 
  private 
    { Private declarations } 
  public 
    { Public declarations } 
  end; 

implementation 

uses
  inifiles; 

var 
  Password : string; 

{$R *.DFM} 

procedure TLogin.FormCreate(Sender: TObject); 
var
  appINI : TIniFile; 
begin 
  appINI := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini')); 
  try
    Password := appINI.ReadString('Login','Password',''); 
  finally
    appINI.Free; 
  end;
end; 

procedure TLogin.PassEditClick(Sender: TObject); 
begin 
  PassEdit.Text := ''; 
end; 

procedure TLogin.LoginButtonClick(Sender: TObject); 
begin 
  if Password <> PassEdit.Text then
  begin 
    ShowMessage('Incorrect Password!') 
    Exit;
  end;
  LockLabel.Visible := False; 
  ModalResult = mrOk;
end; 

end. 
```

设置表格：

```
unit Unit1; 

interface 

uses 
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs, 
  StdCtrls; 

type 
  TSettings = class(TForm) 
    SaveButton: TButton; 
    AEditA: TEdit; 
    AEditB: TEdit; 
    SEditB: TEdit; 
    PEditB: TEdit; 
    PLabelA: TLabel; 
    SLabelA: TLabel; 
    ALabelA: TLabel; 
    PEditA: TEdit; 
    SEditA: TEdit; 
    BackButton: TButton; 
    SettingsLabel: TLabel; 
    ALabelB: TLabel; 
    SLabelB: TLabel; 
    PLabelB: TLabel; 
    AReserveLabel: TLabel; 
    BReserveLabel: TLabel; 
    Label1: TLabel; 
    Label2: TLabel; 
    Label3: TLabel; 
    Label4: TLabel; 
    Label5: TLabel; 
    Label6: TLabel; 
    Label8: TLabel; 
    Label7: TLabel; 
    procedure SaveButtonClick(Sender: TObject); 
    procedure FormCreate(Sender: TObject); 
    procedure BackButtonClick(Sender: TObject); 
    procedure Button1Click(Sender: TObject); 
  private 
    { Private declarations } 
    function Changed: Boolean;
    function SaveSettings: Boolean;
  public 
    { Public declarations } 
  end; 

var 
  APriceA : String; 
  SPriceA : String; 
  PPriceA : String; 
  APriceB : String; 
  SPriceB : String; 
  PPriceB : String; 

implementation 

uses
  inifiles; 

{$R *.DFM} 

procedure LoadSettings;
var
  appINI: TIniFile; 
begin
  appINI := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini')); 
  try
    APriceA := appINI.ReadString('PricesA','Adult',''); 
    SPriceA := appINI.ReadString('PricesA','Student',''); 
    PPriceA := appINI.ReadString('PricesA','Pensioner',''); 
    APriceB := appINI.ReadString('PricesB','Adult',''); 
    SPriceB := appINI.ReadString('PricesB','Student',''); 
    PPriceB := appINI.ReadString('PricesB','Pensioner',''); 
  finally
    appINI.Free; 
  end;
end;

procedure TSettings.FormCreate(Sender: TObject); 
begin 
  AEditA.Text := APriceA; 
  AEditA.Modified := False; 
  SEditA.Text := SPriceA; 
  SEditA.Modified := False; 
  PEditA.Text := PPriceA; 
  PEditA.Modified := False; 
  AEditB.Text := APriceB; 
  AEditB.Modified := False; 
  SEditB.Text := SPriceB; 
  SEditB.Modified := False; 
  PEditB.Text := PPriceB; 
  PEditB.Modified := False; 
end; 

function TSettings.Changed: Boolean;
begin
  Result := AEditA.Modified or 
            SEditA.Modified or
            PEditA.Modified or
            AEditB.Modified or
            SEditB.Modified or
            PEditB.Modified; 
end;

function TSettings.SaveSettings: Boolean;
var
  dbl: Double;
begin
  Result := TryStrToFloat(AEditA.Text, dbl) and
            TryStrToFloat(SEditA.Text, dbl) and
            TryStrToFloat(PEditA.Text, dbl) and 
            TryStrToFloat(AEditB.Text, dbl) and 
            TryStrToFloat(SEditB.Text, dbl) and 
            TryStrToFloat(PEditB.Text, dbl);

  if not Result then
  begin
    ShowMessage('Only Numbers are allowed. Include cents!'); 
    Exit;
  end;

  APriceA := AEditA.Text; 
  SPriceA := SEditA.Text;
  PPriceA := PEditA.Text; 
  APriceB := AEditB.Text; 
  SPriceB := SEditB.Text; 
  PPriceB := PEditB.Text; 

  appINI := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini')); 
  try
    appINI.WriteString('PricesA','Adult',APriceA); 
    appINI.WriteString('PricesA','Student',SPriceA); 
    appINI.WriteString('PricesA','Pensioner',PPriceA); 
    appINI.WriteString('PricesB','Adult',APriceB); 
    appINI.WriteString('PricesB','Student',SPriceB); 
    appINI.WriteString('PricesB','Pensioner',PPriceB); 
  finally
    appINI.Free; 
  end;

  AEditA.Modified := False; 
  SEditA.Modified := False;
  PEditA.Modified := False; 
  AEditB.Modified := False; 
  SEditB.Modified := False; 
  PEditB.Modified := False; 

  ShowMessage('Settings Saved Successfully!');
  Result := True;
end;

procedure TSettings.SaveButtonClick(Sender: TObject); 
begin 
  SaveSettings;
end; 

procedure TSettings.BackButtonClick(Sender: TObject); 
begin 
  if Changed then 
  begin 
    if Application.MessageBox('Save Changes?', 'Save Changes?', MB_YESNO or MB_ICONWARNING) = IDYES then
    begin
      if not SaveSettings then
        Exit;
    end;
  end;
  ModalResult = mrOk; 
end; 

procedure TSettings.Button1Click(Sender: TObject); 
begin 
  Close; 
end; 

initialization
  LoadSettings;

end. 
```

项目：

```
program Project1; 

uses 
  Forms, 
  Unit1 in 'Unit1.pas' {Settings}, 
  Unit2 in 'Unit2.pas' {Login}, 
  Unit3 in 'Unit3.pas' {MainForm}, 
  Unit4 in '..\Write to ini\Unit4.pas' {TransForm}; 

{$R *.RES} 

begin 
  Application.Initialize; 
  Application.CreateForm(TMainForm, MainForm); 
  Application.ShowMainForm := False;
  Application.Run; 
end. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T19:51:24.720

最简单的方法是使用仅一行代码的关闭按钮：

```
BtnClose.click
Begin
  Application.terminate;
End; 
```

希望有帮助

# c++ - 关闭 MFC 对话框时的多线程对象破坏

> ID：11787263
> 
> 赞同：0
> 
> 时间：2012-08-02T23:27:12.573
> 
> 标签：c++, multithreading, boost, mfc, modal-dialog

所以，这就是问题所在：

我编写了一个包装类，为 libtorrent c++ 库提供了简化的 API。它（包装器）有一个堆栈分配的成员，它是 libtorrent 的主要会话对象。该库本身使用 boost 框架，以及它的线程特性——它是多线程的。（我必须说我对 boost 不是很熟悉。）

现在，我想创建一个简单的基于 MFC 对话框的应用程序，它有几个按钮用于管理会话、进度条等。

libtorrent 会话的析构函数可能需要一段时间才能完成（因为它需要通知跟踪器它正在关闭）。退出时会提示用户使用 MessageBox 确认下载终止，因此我认为将包装器对象作为应用程序类的成员而不是 CDialog （包装器析构函数，因此会话将启动）是个好主意在对话框关闭后）。Libtorrent 文档还指出，在调用析构函数之前关闭诸如窗口之类的 UI 是个好主意。

有趣的部分来了——一切正常，直到我关闭对话框。该过程继续存在几秒钟，然后因一些与提升相关的锁/关键部分的东西而崩溃（这是调试器指向的地方，在提升的标头之一中进行了一些锁定/释放调用）......

**编辑**
似乎在关闭时，从主窗口执行了一些线程检查，并且它进入了一些“不规则”状态，在这种状态下它做了一些导致提升失败的事情。我在想gui线程需要某种“加入”，以等待其他线程终止......

如果有人理解我在这里试图解释的内容，并且知道我做错了什么，或者有这个概念的替代解决方案，我将非常感激。
谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:32:20.863

您可以在退出之前等待 Boost 线程加入。我有一个使用 Boost 线程的 Output_Processor 类。我通过队列与它交互。一旦我想关闭应用程序，我就会在其队列中放置一个关闭命令。Output_Processor 线程在处理完该命令后返回。然后我的加入块返回，应用程序的其余部分可以正常关闭。

```
...
_output_processor_queue->write(shutdown_command);

// Wait for output processor thread to join.
_output_processor_thread->join();

_output_processor_initialized = false;
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T08:40:33.143

好的，问题解决了。
我所做的只是我最初创建了一个动态包装对象，并在 doModal() 返回后将其删除。此时主线程阻塞，等待删除操作结束，这基本上是直到 libtorrent 会话被破坏。然而，非动态对象的特殊行为仍然存在。

# ios - 我如何从facebook IOS SDK邀请的朋友那里获得ID？

> ID：11787265
> 
> 赞同：0
> 
> 时间：2012-08-02T23:28:03.460
> 
> 标签：ios, facebook, facebook-ios-sdk

我想知道谁接受了我的应用请求或邀请加入我的应用。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:59:17.577

如果您使用 GraphPath 请求您的朋友列表`/me/friends?fields=installed`，您将返回一个字典，其中包含名为“已安装”的键和值“True”，如果该朋友拥有您的应用程序。如果他们没有您的应用程序，那么“已安装”密钥甚至都不存在，您只会获得朋友的常规信息。

所以基本上，发出 GraphPath 请求，然后检查它返回的字典中是否存在“已安装”键。如果有，他们就有了。

# javascript - 如何创建基于另一个下拉菜单的答案出现的下拉菜单

> ID：11787272
> 
> 赞同：7
> 
> 时间：2012-08-02T23:28:54.530
> 
> 标签：javascript, python, html, css

我正在尝试创建一个页面，您的用户必须在其中做出基于彼此的多项选择。如何创建一个表单，以便根据用户在下拉菜单 #1 中的选择显示特定类型的下拉菜单 #2。

例如，假设用户必须选择“产品类别”和“产品子类别”。如果用户从第一个下拉菜单中选择“床上用品”，则会自动出现第二个下拉菜单，其中包含“床、床垫、枕头”等选项。

为了进一步说明这个例子，假设用户选择了“电子产品”而不是“床上用品”。然后第二个下拉菜单将具有“电视、mp3 播放器、计算机”之类的选项。

一个人将如何去做这样的事情？您会以 HTML/CSS 或其他形式执行此操作吗？

谢谢您的帮助！

编辑 - 我正在使用 Django / Python 以及 HTML、CSS 和 Javascript 来构建这个网站。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T23:35:44.027

您可以结合使用 HTML 和 JavaScript **( [JSFIDDLE](http://jsfiddle.net/7Shsy/117/) )**：

```
<select id="opts" onchange="showForm()">
    <option value="0">Select Option</option>
    <option value="1">Option 1</option>
    <option value="2">Option 2</option>
</select>

<div id="f1" style="display:none">
    <form name="form1">
        <select id="opts" onchange="showForm()">
            <option value="0">Select Option</option>
            <option value="1">Option 1A</option>
            <option value="2">Option 1B</option>
        </select>
    </form>
</div>

<div id="f2" style="display:none">
    <form name="form2">
        <select id="opts" onchange="showForm()">
            <option value="0">Select Option</option>
            <option value="1">Option 2A</option>
            <option value="2">Option 2B</option>
        </select>
    </form>
</div>

<script type="text/javascript">
    function showForm() {
        var selopt = document.getElementById("opts").value;
        if (selopt == 1) {
            document.getElementById("f1").style.display = "block";
            document.getElementById("f2").style.display = "none";
        }
        if (selopt == 2) {
            document.getElementById("f2").style.display = "block";
            document.getElementById("f1").style.display = "none";
        }
        if (selopt == 0) {
            document.getElementById("f2").style.display = "none";
            document.getElementById("f1").style.display = "none";
        }
    }
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T23:36:14.407

像这样？创建了一个 js 小提琴。 [http://jsfiddle.net/wigster/MeTQQ/](http://jsfiddle.net/wigster/MeTQQ/)

它抓取下拉框的值，然后如果它匹配规则，它将设置另一个下拉框显示，如果不，则隐藏另一个下拉框。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T23:42:28.510

如果你想使用 jQuery，你可以使用这个测试用例：http: [//jsfiddle.net/exXmJ/](http://jsfiddle.net/exXmJ/)

在我看来，有两条路可以走。删除下拉菜单并将其换成新的，或隐藏/显示两个不同的下拉菜单。亚历山大介绍了第二种方法，所以我不会深入讨论。

# php - 使用 PHP 模板输出带有数据库值的网页（变量 URL）

> ID：11787280
> 
> 赞同：0
> 
> 时间：2012-08-02T23:30:13.240
> 
> 标签：php, mysql, templates, design-patterns

*我做了一些搜索，但我在 PHP 方面不是很有经验，所以我不知道我正在寻找的正确术语/单词。不过，我确实很清楚自己想做什么。*

1.  我有一个包含许多图像的网站，每个图像都有一个数据库条目（MySQL）。
2.  我希望每个图像都有自己的登录页面，基于其数据库值。( `Title`, `Category`, `Tags`, 等等...)
3.  我不想在我的服务器上为每个图像创建一个单独的 .php 文件。（例如：`pinkflowers.php`, `redroses.php`, 等等...）
4.  应该有 1 个 PHP 模板文件，根据用户访问的 URL（变量）输出所有图像的网页。

因此，如果有人访问“mysite.com/pinkflowers.php”，该页面应该输出`pinkflowers`我数据库中的变量。

但是，该文件`pinkflowers.php`实际上并不存在，仅`template.php`存在，这将是我数据库中所有图像的“蓝图”。

1.  我希望`.php`从浏览器的 URL 中删除。

    "mysite.com/pinkflowers.php" => "mysite.com/pinkflowers"

    我已经有了对现有页面执行此操作的代码*（如下）*；我不确定它是否也适用于这些“虚构”页面。

    ```
    (.htaccess)    
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}\.php -f
    RewriteRule ^(.*)$ $1.php 
    ```

2.  如果用户试图访问一个没有相关数据库条目的页面（例如：“mysite.com/430jfif0ij”），他们应该被重定向到主页。

*我不希望任何人给我所有的答案，但请至少引导我朝着正确的方向开始制作这样的模板。谢谢！*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:08:03.563

我最终能够解决我自己的问题，同时没有给出任何答案。

我在这里遵循了本教程：http: [//net.tutsplus.com/tutorials/other/using-htaccess-files-for-pretty-urls/](http://net.tutsplus.com/tutorials/other/using-htaccess-files-for-pretty-urls/)

我的`.htaccess`包含：

```
RewriteEngine on    
Options +FollowSymLinks

RewriteCond %{SCRIPT_FILENAME} !-d  
RewriteCond %{SCRIPT_FILENAME} !-f  

RewriteRule ^category1/(.*)$ ./template.php?image=$1
RewriteRule ^category2/(.*)$ ./template.php?image=$1
RewriteRule ^category3/(.*)$ ./template.php?image=$1
etc... 
```

`category#`- 作为我的图像分类的“文件夹”。

我这样做是`template.php`为了从 URL 中提取变量：

```
$result = mysql_query('SELECT * FROM image_list WHERE image_name="' . mysql_real_escape_string($_GET['image']) . '"'); 
```

对于`redirect`主页的访问者，如果他们输入了无效的 URL/ID，我使用了这个：

```
if (mysql_num_rows($result)==0) {
echo "<script>window.location = 'http://mysite.com/'</script>";
} 
```

所以所有这些方法的组合完全达到了我想要的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T15:18:41.863

让您的 .htaccess 类似于：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ template.php/$1 
```

然后 (on `template.php`) 用于`$_SERVER["path_info"]`确定用户输入的路径 (ie `/pinkflowers`) 并相应地查询数据库。

我喜欢的原因`$_SERVER["path_info"]`是因为它不使用（或污染）GET 变量空间。

# php - PHP/JavaScript - 检测当前打开页面的用户

> ID：11787281
> 
> 赞同：0
> 
> 时间：2012-08-02T23:30:15.067
> 
> 标签：php, javascript, websocket

我想制作一个页面，显示所有正在查看该页面的用户。理想情况下，数据库将存储页面上的用户，并且当用户进入和离开时，websockets 将用于更新。

问题是我不知道如何判断用户何时查看该页面。我在想我能够知道他们何时到达以及何时退出并相应地添加/删除。他们什么时候到达很容易判断；然而，很难判断他们什么时候离开——尤其是因为用户可能会做一些事情，比如打开多个标签，关闭一个但保持另一个打开。

做这个的最好方式是什么？我使用 PHP 作为我的服务器端语言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:29:28.313

您可以使用窗口上的[`blur`和`focus`事件](http://www.quirksmode.org/dom/events/blurfocus.html)来切换变量。然而， IE 有一些你需要解决的[怪癖。](https://stackoverflow.com/q/1408699/1048572)

作为不工作`focus`事件的后备，您可以`mousemove`向文档添加处理程序。这也可能会限制自动超时，该超时仅通过在特定时间段内没有用户交互的事实来检测焦点丢失。但是，您将永远无法检测到一个分心的用户，该用户打开了站点，但正在查看其他内容……

要检测窗口关闭，您可以挂钩[`unload`事件](https://developer.mozilla.org/en/DOM/window.onunload)。这[可能不可靠](https://stackoverflow.com/q/3584288/1048572)，但是当您使用 Websockets 时，您的服务器可以轻松检测到关闭的连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T23:47:58.823

好吧，你可以做的一件事，特别是如果你使用 websockets，如果你真的想要的话，每隔几秒就对服务器进行一次心跳/ping。如果你没有得到那个心跳，你知道他们不再在页面上......但是，得到响应并不意味着他们正在查看页面，它只是意味着它是打开的，可能在另一个页面上标签。如果此人失去对页面的关注并打开另一个选项卡/窗口，我不知道它会向服务器发送响应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T00:13:00.207

正如蒂姆所提到的，Firefox 和 IE 将在后台选项卡中运行 javascript，因此无法通过简单的轮询来判断用户是否真的在“查看”页面，或者只是在某个地方打开了它。尽管我不知道用户是否真的在查看您的页面，但一个潜在的解决方案可能是将轮询绑定到操作。所以你可能有一些变量

```
var timesincelastaction=0;
var threshhold = 20; 
```

然后

```
setInterval("timesincelastaction++",100); 
```

然后

```
function keepAlive() {
  if(timesincelastaction > threshhold) {
    $.ajax(...tell the server you are alive...);
    timesincelastaction = 0;
  }
} 
```

然后开始考虑像这样的行动

```
$('a').mouseover(keepAlive);
$('div').mouseover(keepAlive);
$(window).scroll(keepAlive);
$(video).play(keepAlive); // okay this isn't a real one but you get the picture 
```

因此，您只需对用户可能在页面上执行的所有需要​​他们注意的事情进行头脑风暴，并将其用作您的基准。

我知道这似乎有点激烈，可能有一些很好的方法来优化它。只是大声思考。好奇地想看看其他人的想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T23:43:44.340

每次您的一个 PHP 脚本运行时，某些用户或实体都会请求查看您网站上的页面（这通常会在每次您的脚本运行时发生）。

检测用户何时离开您的页面更具挑战性，这就是为什么大多数在线指标只是超时，即如果您在过去 5 分钟内没有在网站上活动，则不再被视为在线。

您可以使用 $_SERVER['REMOTE_ADDR'] 之类的变量获取有关请求页面的用户的信息，或者如果您已经拥有身份验证系统，您应该能够提取用户用户名，将此信息与用户名/ip 一起存储在数据库中作为具有时间戳的唯一键，如果它们的时间戳超过 5 分钟，则根本不将它们视为在线。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T23:50:08.173

您可能可以使用jQuery-[`ajax`](http://api.jquery.com/jQuery.ajax/)和. 该请求将在告诉您他们正在查看时触发，并在告诉您他们不再查看时触发。剩下的就留给你自己去弄清楚，因为听起来你已经掌握了它。[`unload`](http://api.jquery.com/unload/)[`load`](http://api.jquery.com/load/)`ajax``load``unload`

笔记。在普通 JS 中应该可以实现相同的结果。比如，[`onunload`](http://www.w3schools.com/jsref/event_onunload.asp)。谷歌会帮你找到剩下的。

# c# - 使用 WriteImageToSavedPhotosAlbum 时未保存 Gps exif 数据

> ID：11787282
> 
> 赞同：2
> 
> 时间：2012-08-02T23:30:16.090
> 
> 标签：c#, xamarin.ios, gps, exif

基本上我正在使用来自[http://docs.xamarin.com/ios/recipes/Media/Video_and_Photos/Save_Photo_to_Album_with_Metadata的示例代码](http://docs.xamarin.com/ios/recipes/Media/Video_and_Photos/Save_Photo_to_Album_with_Metadata)

当我拍照并检查文件 exif 数据时（通过[http://exifdata.com/](http://exifdata.com/)或设备上的 Exif-Wizard），我注意到 exif 数据不包含 GPS 信息，所以我手动收集位置信息，对其进行格式化，并将其添加到字典中，并将其包含在元字典中，如下所示。

```
btnCamera.Clicked += delegate {
TweetStation.Camera.TakePicture (this, (obj) => {
var photo = obj.ValueForKey (new NSString ("UIImagePickerControllerOriginalImage")) as    UIImage;
var meta = obj.ValueForKey (new NSString ("UIImagePickerControllerMediaMetadata")) as NSMutableDictionary;

var gpsDict = new NSMutableDictionary ();

...

gpsDict.SetValueForKey (NSObject.FromObject (GpsLong), new NSString ("GPSLongitude"));
gpsDict.SetValueForKey (NSObject.FromObject (GpsLongRef), new NSString ("GPSLongitudeRef"));
gpsDict.SetValueForKey (NSObject.FromObject (GpsLat), new NSString ("GPSLatitude"));
gpsDict.SetValueForKey (NSObject.FromObject (GpsLatRef), new NSString ("GPSLatitudeRef"));
gpsDict.SetValueForKey (NSObject.FromObject (DateTime.UtcNow.ToString ("HH:MM:ss.ff")),    new NSString ("GPSTimeStamp"));

meta.SetValueForKey (gpsDict, new NSString ("{GPS}"));

Console.WriteLine (meta.Description);

ALAssetsLibrary library = new ALAssetsLibrary ();
library.WriteImageToSavedPhotosAlbum (photo.CGImage, meta, (assetUrl, error) => {

if (error != null) {
Console.WriteLine ("error: "+ error.ToString ());
}
): 
```

问题是，这似乎不起作用，`if (error != null) {Console.WriteLine (error.ToString ());}`没有打印任何问题，`Console.WriteLine (meta.Description);` 输出如下

```
{
    DPIHeight = 72;
    DPIWidth = 72;
    Orientation = 6;
    "{Exif}" =     {
        ApertureValue = "2.970853654340484";
        BrightnessValue = "1.87496238139573";
        ColorSpace = 1;
        DateTimeDigitized = "2012:08:02 17:12:42";
        DateTimeOriginal = "2012:08:02 17:12:42";
        ExposureMode = 0;
        ExposureProgram = 2;
        ExposureTime = "0.06666666666666667";
        FNumber = "2.8";
        Flash = 24;
        FocalLength = "3.85";
        ISOSpeedRatings =         (
            160
        );
        MeteringMode = 5;
        PixelXDimension = 2592;
        PixelYDimension = 1936;
        SceneType = 1;
        SensingMethod = 2;
        Sharpness = 2;
        ShutterSpeedValue = "3.911199862602335";
        SubjectArea =         (
            1295,
            967,
            699,
            696
        );
        WhiteBalance = 0;
    };
    "{GPS}" =     {
        GPSLatitude = "30.35974270979283";
        GPSLatitudeRef = N;
        GPSLongitude = "91.13930279830274";
        GPSLongitudeRef = W;
        GPSTimeStamp = "22:08:44.66";
    };
    "{TIFF}" =     {
        DateTime = "2012:08:02 17:12:42";
        Make = Apple;
        Model = "iPhone 4";
        Software = "5.0.1";
        XResolution = 72;
        YResolution = 72;
    };
} 
```

显示 gps 数据。

所以，我很好奇我做错了什么，我对monotouch（mac也是）很陌生，所以你会原谅一般的WTF'ery。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T15:36:38.200

**问题解决了：**

似乎问题是我的 Exif Gps 数据块不正确，我使用了错误的名称，并且块不完整，正在更改

```
gpsDict.SetValueForKey (NSObject.FromObject (GpsLong), new NSString ("GPSLongitude"));
gpsDict.SetValueForKey (NSObject.FromObject (GpsLongRef), new NSString ("GPSLongitudeRef"));
gpsDict.SetValueForKey (NSObject.FromObject (GpsLat), new NSString ("GPSLatitude"));
gpsDict.SetValueForKey (NSObject.FromObject (GpsLatRef), new NSString ("GPSLatitudeRef"));
gpsDict.SetValueForKey (NSObject.FromObject (DateTime.UtcNow.ToString ("HH:MM:ss.ff")),    new NSString ("GPSTimeStamp")); 
```

到

```
gpsDict.SetValueForKey(NSObject.FromObject(GpsAltitude),new NSString("Altitude"));
gpsDict.SetValueForKey(NSObject.FromObject(GpsAltitudeRef),new NSString("AltitudeRef"));

gpsDict.SetValueForKey(NSObject.FromObject(GpsImgDirection),new NSString("ImgDirection"));
gpsDict.SetValueForKey(NSObject.FromObject(GpsImgDirectionRef),new NSString("ImgDirectionRef"));

gpsDict.SetValueForKey (NSObject.FromObject (GpsLong), new NSString ("Longitude"));
gpsDict.SetValueForKey (NSObject.FromObject (GpsLongRef), new NSString ("LongitudeRef"));

gpsDict.SetValueForKey (NSObject.FromObject (GpsLat), new NSString ("Latitude"));
gpsDict.SetValueForKey (NSObject.FromObject (GpsLatRef), new NSString ("LatitudeRef"));

gpsDict.SetValueForKey (NSObject.FromObject (DateTime.UtcNow.ToString ("HH:MM:ss.ff")), new NSString ("TimeStamp")); 
```

主要变化是 GPS 前缀已从所有标签名称中删除，并添加了海拔标签。

GPS exif 块应如下所示

```
"{GPS}" =     {
    Altitude = "14.9281";
    AltitudeRef = 0;
    ImgDirection = "107.4554";
    ImgDirectionRef = T;
    Latitude = "30.35514548114219";
    LatitudeRef = N;
    Longitude = "91.13394105024713";
    LongitudeRef = W;
    TimeStamp = "15:08:57.93";
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T00:37:50.833

`CGImageProperties`另外，仅供参考，为了防止拼写错误，这些字符串在 MonoTouch中暴露为枚举

```
// Add GPS metadata, using data in local variables GpsAltitude, GpsLat, GpsLong, etc
gpsDict.SetValueForKey(NSObject.FromObject(GpsAltitude), CGImageProperties.GPSAltitude);
gpsDict.SetValueForKey(NSObject.FromObject(GpsAltitudeRef), CGImageProperties.GPSAltitudeRef);

gpsDict.SetValueForKey(NSObject.FromObject(GpsImgDirection), CGImageProperties.GPSImgDirection);
gpsDict.SetValueForKey(NSObject.FromObject(GpsImgDirectionRef), CGImageProperties.GPSImgDirectionRef);

gpsDict.SetValueForKey (NSObject.FromObject (GpsLong), CGImageProperties.GPSLongitude);
gpsDict.SetValueForKey (NSObject.FromObject (GpsLongRef), CGImageProperties.GPSLongitudeRef);

gpsDict.SetValueForKey (NSObject.FromObject (GpsLat), CGImageProperties.GPSLatitude);
gpsDict.SetValueForKey (NSObject.FromObject (GpsLatRef),CGImageProperties.GPSLatitudeRef);

gpsDict.SetValueForKey (NSObject.FromObject (DateTime.UtcNow.ToString ("HH:MM:ss.ff")), CGImageProperties.GPSTimeStamp);

// Add the GPS data to the metadata
meta.SetValueForKey (gpsDict, CGImageProperties.GPSDictionary); 
```

# c - 复制多维数组（指针）

> ID：11787286
> 
> 赞同：0
> 
> 时间：2012-08-02T23:30:29.880
> 
> 标签：c, arrays, pointers

我有两个指向指针的结构指针

```
typedef struct Square {
...
...
}Square;

Square **s1; //Representing 2D array of say, 100*100
Square **s2; //Representing 2D array of say, 200*200 
```

两者都使用`malloc()`. 我已经`s1`使用某些值进行`s2`了初始化，并使用默认值完全初始化。基本上我需要在保持其 ( ) 值`s1`的同时调整其大小，并且“添加”的值将与它们原来的值一样- 默认值。`s2``s1``s2`

[我从较小的数组到较大的数组](https://stackoverflow.com/questions/11786970/memcpy-from-smaller-array-to-larger-one/11786985)写了这个问题memcpy()但显然我在数组和指针之间感到困惑/

我的问题是，如何将这种大小调整`s1`为`s2`. 我不必保留原始指针。`s1`如果这是一种更好的方式，我可以复制`s2`并返回`s2`，我希望我能正确解释我所追求的。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:33:30.443

二维数组在内存中按顺序排列：row1 row2 row3 等。

memcpy 执行从一个内存位置到另一个内存位置的线性复制。

所以要实现你所需要的：

a) 创建一个新数组

```
Square **s3 = malloc(sizeof(s2)); 
```

b) 将 s2 复制到其中

c) 将 s1 中的内容逐行复制到新的

```
for(r = 0; r < NROWS_S1; r++)
    memcpy(s3[r], s1[r], sizeof(Square) * NCOLS_S1); 
```

[http://www.fredosaurus.com/notes-cpp/arrayptr/23two-dim-array-memory-layout.html](http://www.fredosaurus.com/notes-cpp/arrayptr/23two-dim-array-memory-layout.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T23:37:44.160

你可以尝试这样的事情：

```
typedef struct {
    //
} Square;

Square** s1; // 100x100, needs to resize and be like s2.
Square** s2; // 200x200

void resize_s1()
{
    // resize the outer array
    s1 = realloc(s1, sizeof(Square*)*200);
    memset(s1 + 100, 0, 100*sizeof(Square*)); // we initialize the newly allocated pointers to NULL

    for(int i = 0; i < 200; ++i)
    {
        // resize the inner array. Since we initialized the last
        // 100 pointers to null, realloc will just behave like
        // malloc for them.
        s1[i] = realloc(s1[i], 200*sizeof(Square));

        // ... and copy the new values in! You can omit this step,
        // but anything outside of the original bounds of s1 will
        // be uninitialized. All your pointers will be valid though.
        if(i >= 100)
            memcpy(s1[i] + 100, s2[i] + 100, 100*sizeof(Square));
    }
} 
```

作为警告 - 我在这里使用 realloc 玩得非常快速和松散。阅读其手册页以了解更多详细信息，但如果您遇到内存不足的情况，可能会发生不好的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T02:30:34.880

您已经在堆上分配了二维矩阵，并且您正在使用 a`Square**`来访问它。这意味着您已经：（1）在一次或多次调用中为每个元素分配空间`malloc`，以及（2）在调用中为所有行指针分配空间`malloc`。如何进行很大程度上取决于您分配数组的方式。

下面，我`assert`用来强调每个 malloc/realloc 都可以返回 NULL（表示它无法完成请求）。您可能希望正确处理这些情况。

## 选项 1：您分别分配每一行

您像这样分配`s1`矩阵：

```
Square** s1 = malloc(M1*sizeof(s1[0]));
for (size_t i=0; i < M1; i++)
  s1[i] = malloc(N1*sizeof(s1[i][0])); 
```

在这种情况下，您必须分别处理每一行：

```
/* M1 and N1 set to size of s1 (M1 x N1) */
/* M2 and N2 set to size of s2 (M2 x N2) */

/* First, reallocate the pointers to each row */
Square** tmpRows = realloc(s1, M2*sizeof(*tmpRows));
assert( (tmpRows != NULL) && "Out of memory reallocating rows" );

s1 = tmpRows;

/* Now, reallocate each row */
for (size_t i=0; i < M1; i++) {
  Square* tmpVals = realloc(s1[i], N2*sizeof(tmpVals[0]));
  assert( (tmpVals != NULL) && "Out of memory reallocating row" );

  /* copy elements of s2 into new column */
  memcpy(tmpVals+N1, s2[i]+N1, (N2-N1)*sizeof(s1[i][0]));
  s1[i] = tmpVals;
}

/* Now, allocate each new row of s1 and copy the additional rows of s2 into s1 */
for (size_t i=M1; i < M2; i++) {
  s1[i] = malloc( N2 * sizeof(s1[i][0]) );
  assert( (s1[i] != NULL) && "Out of memory allocating new row" );
  memcpy(s1[i], s2[i], N2*sizeof(s1[i][0]));
} 
```

## 选项 2：您一次分配所有行

在这种情况下，您将所有行分配在一个大块中，然后将指针分配到每一行的开头。像这样：

```
Square** s1 = malloc(M1*sizeof(s1[0]));
s1[0] = malloc( M1*N1*sizeof(s1[0][0]) );
for(size_t i=1; i < M1; i++) 
  s1[i] = s1[i-1] + N1; 
```

要调整数组的大小（并使用 s2 的元素初始化其新元素），您应该执行以下操作：

```
/* M1 and N1 set to size of s1 (M1 x N1) */
/* M2 and N2 set to size of s2 (M2 x N2) */

/* Make a new copy of the elements of s1\.  Linear layout of a 200x200 
 * matrix will be different than the linear layout of a 100x100 matrix.
 * Making a new copy makes it easier to initialize its values.
 */
Square* new_mat = malloc( M2*N2*sizeof(new_mat[0]) );
assert( (new_mat != NULL) && "Out of memory allocating new matrix" );

/* Initialize with values of s2\.  Assumption: s2 is also allocated
 * as a contiguous array...
 */
memcpy(new_mat, s2[0], M2*N2*sizeof(s2[0][0]));

/* Now, reallocate the rows */
Square** tmpRows = realloc(s1, M2*sizeof(s1[0]));
assert( (tmpRows != NULL) && "Out of memory reallocating rows" );

s1 = tmpRows;
/* Copy data from old rows into new rows... */
for (size_t i=0; i < M1; i++) {
  /* rows of s1 still point to old_mat data, copy it into new_mat.
   * Each row in new_mat starts at (new_mat + N2*i)
   */
  memcpy( new_mat + N2*i, s1[i], N1*sizeof(s1[i][0]) );
}

/* Free old memory and assign new row pointers... */
free(s1[0]);
s1[0] = new_mat;
for (size_t i=1; i < M2; i++)
  s1[i] = s1[i-1] + N2; 
```

# jquery - 拦截表单提交的默认行为

> ID：11787288
> 
> 赞同：0
> 
> 时间：2012-08-02T23:30:44.830
> 
> 标签：jquery

执行以下代码时，参数出现在 url 中，并且表格内的内部 HTML 没有变化。文档说，提供数据时，默认请求方法是 POST。

```
$('form').submit(function() {
    var data = $(this).serializeArray();
    $('#items-table').load("drawer.php", data)
}); 
```

`data`正确输出为`MM=01&dd=01&yyyy=2001&HH=12&mm=00&ss=00&entername=Dr.+Clock&optionsRadios=option3&enteritemid=`，但它显示为当前页面的参数，而不是 load() 函数中标识的页面，`drawer.php`。

**编辑**：即使我`serializeArray()`用来确保将对象作为第二个参数传递给 load() 而不是字符串，我仍然发现调用了 GET 请求，并且当前页面的 URL 获得了这些参数。“drawer.php”的响应没有出现在 div 中。

**第二次编辑**：事实证明我未能拦截表单的操作，因为我没有`return false;`在提交函数的末尾包含这一行：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:03:15.537

我未能拦截表单的操作，因为我没有`return false;`在提交函数的末尾包含这一行：包括这条线解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:38:34.657

> 如果数据作为对象提供，则使用 POST 方法；否则，假定为 GET。

```
$('#items-table').load("drawer.php", {form_data:data}) 
```

所以传递一个`object/{}`而不是`string`因为`serialize()`方法创建一个文本字符串，`&`并且你已经使用`$data`了而不是`data`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T23:39:07.190

您正在使用`var data = $(this).serialize();`

医生说：

> .serialize() 方法以标准 URL 编码表示法创建文本字符串。

[http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

您需要提供一个对象作为 load 的第二个参数才能使用 POST。

# php - PHP 多个 If 条件为真

> ID：11787289
> 
> 赞同：0
> 
> 时间：2012-08-02T23:30:45.053
> 
> 标签：php

我有这个 PHP 代码：

```
$supplier = $line[2];
if ($supplier == "supplier")
{
} else {
Header("Location: premium.php");
} 
```

现在我希望将 $supplier == "demo" 包含到 PHP 代码中，如下所示：

```
$supplier = $line[2];
if ($supplier == "supplier" && $supplier == "demo")
{
} else {
Header("Location: premium.php");
} 
```

但后一个代码对任何一个都不起作用......我的意思是如果 $supplier 等于“供应商”或“演示”之外的其他东西，它仍然会绕过它。它只适用于第一个。

请问如何安排？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:34:06.873

线 `if ($supplier == "supplier" && $supplier == "demo")`

没有意义。`$supplier`在条件语句的中间不可能改变，因此这永远不会是真的。您可能正在寻找`||`（或）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T23:43:33.937

一定要借此机会理解和的含义，`&&`正如`||`其他人所提到的，但如果“或”确实是您正在寻找的逻辑，在这种情况下，我建议这样做：

```
if ( in_array( $supplier, array( "supplier", "demo" ) ) ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T23:35:24.177

```
if ($supplier == "supplier" && $supplier == "demo") 
```

永远不可能是真的，因为 $supplier 不可能同时是两者。你需要一个 OR 像这样：

```
if ($supplier == "supplier" || $supplier == "demo") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T23:34:46.013

“&&”表示：两个连接语句都必须为真！“||” 意思是：其中一个陈述必须是真实的！

您的构造没有意义，因为您说 $supplier 必须是“演示”和“供应商”，这永远不会是真的，因为 $var 只能有一个值。

错误的：

```
if ($supplier == "supplier" && $supplier == "demo") // AND would also work 
```

正确的：

```
if ($supplier == "supplier" || $supplier == "demo") // OR would also work 
```

# c++ - epoll：丢失一些 EPOLLOUT 事件？

> ID：11787297
> 
> 赞同：3
> 
> 时间：2012-08-02T23:31:31.007
> 
> 标签：c++, c, asyncsocket, epoll, epollet

这是我的服务器的样子：

-WorkerThread(s):

*   调用 epoll_wait，接受连接，设置 fd 非阻塞（EPOLLIN | EPOLLOUT | EPOLLET | EPOLLRDHUP）
*   在 EPOLLIN 事件上调用 recv 直到 EAGAIN 并将所有数据推送到全局 RecvBuffer（pthread_mutex 同步）
*   在 EPOLLOUT 事件上：访问全局 SendBuffer，如果当前准备好的 fd 有数据要发送，则执行此操作（在 while 循环中，直到 EAGAIN 或直到发送所有数据；发送整个数据包时，从 SendBuffer 中弹出）

-IOThread(s)

*   从全局 RecvBuffer 获取数据，处理它们
*   通过首先尝试立即调用 send 来发送响应。如果没有发送所有数据，则将其余数据推送到全局 SendBuffer 以从 WorkerThread 发送）

问题是，该服务器没有发送所有排队的数据（它们留在 SendBuffer 中），并且“未发送”数据的数量随着客户端数量的增加而增长。为了测试我只使用 1 个工作线程和 1 个 iothread，但如果我使用更多似乎没有任何区别。访问全局缓冲区受 pthread_mutex 保护。此外，我的响应数据大小为 130k 字节（至少需要 3 个发送调用才能发送这么多数据）。另一方面是使用阻塞套接字的 Windows 客户端。

非常感谢！乔丹

编辑：

是的，默认情况下我正在等待 EPOLLOUT 事件，即使我没有要发送的内容。为了实现简单和手册页指南，我这样做了。另外，我对它的理解是这样的：

即使我当时“错过” EPOLLOUT 事件我不想发送任何东西也没问题，因为当我想发送数据时，我会调用 send 直到 EAGAIN 和 EPOLLOUT 应该在未来被触发（而且大部分时间）

现在我修改了代码以在 IN/OUT 事件之间切换：

接受时：

```
event.events = EPOLLIN | EPOLLET | EPOLLRDHUP;
epoll_ctl (pNetServer->m_EventFD, EPOLL_CTL_ADD, infd, &event); 
```

发送完所有数据后：

```
event.events = EPOLLIN | EPOLLET | EPOLLRDHUP;
epoll_ctl (pNetServer->m_EventFD, EPOLL_CTL_MOD, events[i].data.fd, &event); 
```

当我通过在 IOThread 中调用 send 到达 EAGAIN 时：

```
event.events = EPOLLOUT | EPOLLET | EPOLLRDHUP;
epoll_ctl (pNetServer->m_EventFD, EPOLL_CTL_MOD, events[i].data.fd, &event); 
```

..我得到同样的行为。另外，我尝试删除 EPOLLET 标志，但没有任何改变

一个问题：带有 EPOLL_CTL_MOD 标志的 epoll_ctl 是替换事件成员还是只是用给定的参数对它进行 OR 运算？

EDIT3：更新了 IOThread 函数以连续发送，直到所有数据都发送完毕，或者直到 EAGAIN。即使我发送了所有数据，我也尝试发送，但大多数时候我在非套接字上得到 errno 88 套接字操作

EDIT4：我修复了“发送代码”中的一些错误，因此我现在没有收到任何未发送的排队数据。但是，我没有收到应有的数据:)) 最多的“错过”（未收到）数据我发送完成后客户端立即调用recv时获取，并且随着客户端数量的增加而增长。当我在客户端的发送和接收调用之间设置 2 秒延迟（阻塞调用）时，我不会丢失服务器上的少量数据，具体取决于正在运行的客户端数量（客户端测试代码包括简单的 for 循环，其中包含 1 个发送和 1 个接收调用）再次尝试使用和不使用 ET 模式。下面是更新的 WorkerThread 函数，它负责接收数据。@Admins/Mods 也许我现在应该打开新主题，因为问题有点不同？

```
void CNetServer::WorkerThread(void* param)
{
    CNetServer* pNetServer =(CNetServer*)param;
    struct epoll_event event;
    struct epoll_event *events;
    int s = 0;

//  events = (epoll_event*)calloc (MAXEVENTS, sizeof event);

    while (1)
    {
        int n, i;

//      printf ("BLOCKING NOW! epoll_wait thread %d\n",pthread_self());
        n = pNetServer->m_epollCtrl.Wait(-1);
//      printf ("epoll_wait thread %d\n",pthread_self());
        pthread_mutex_lock(&g_mtx_WorkerThd);
        for (i = 0; i < n; i++)
        {
            if ((pNetServer->m_epollCtrl.Event(i)->events & EPOLLERR))
            {
                // An error has occured on this fd, or the socket is not ready for reading (why were we notified then?)

            //  g_SendBufferArray.RemoveAll( 0 );

                char szFileName[30] = {0};
                sprintf( (char*)szFileName,"fd_%d.txt",pNetServer->m_epollCtrl.Event(i)->data.fd );
                remove(szFileName);

            /*  printf( "\n\n\n");
                printf( "\tDATA LEFT COUNT:%d\n",g_SendBufferArray.size());
                for (int k=0;k<g_SendBufferArray.size();k++)
                    printf( "\tSD: %d DATA LEFT:%d\n",g_SendBufferArray[i]->sd,g_SendBufferArray[i]->nBytesSent );
*/

            //  fprintf (stderr, "epoll error\n");
            //  fflush(stdout);
                close (pNetServer->m_epollCtrl.Event(i)->data.fd);
                continue;
            }
            else if (pNetServer->m_ListenSocket == pNetServer->m_epollCtrl.Event(i)->data.fd)
            {
                // We have a notification on the listening socket, which   means one or more incoming connections. 
                while (1)
                {
                    struct sockaddr in_addr;
                    socklen_t in_len;
                    int infd;
                    char hbuf[NI_MAXHOST], sbuf[NI_MAXSERV];

                    in_len = sizeof in_addr;
                    infd = accept (pNetServer->m_ListenSocket, &in_addr, &in_len);
                    if (infd == -1)
                    {
                        if ((errno == EAGAIN) ||
                            (errno == EWOULDBLOCK))
                        {
                            // We have processed all incoming connections.
                            break;
                        }
                        else
                        {
                            perror ("accept");
                            break;
                        }
                    }

                    s = getnameinfo (&in_addr, in_len,
                        hbuf, sizeof hbuf,
                        sbuf, sizeof sbuf,
                        NI_NUMERICHOST | NI_NUMERICSERV);
                    if (s == 0)
                    {
                        printf("Accepted connection on descriptor %d "
                            "(host=%s, port=%s) thread %d\n", infd, hbuf, sbuf,pthread_self());
                    }

                    // Make the incoming socket non-blocking and add it to the list of fds to monitor.
                    CEpollCtrl::SetNonBlock(infd,true);
                    if ( !pNetServer->m_epollCtrl.Add( infd, EPOLLIN, NULL ))
                    {
                        perror ("epoll_ctl");
                        abort ();
                    }

                }
                continue;
            }
            if( (pNetServer->m_epollCtrl.Event(i)->events & EPOLLOUT) )
            {

                pNetServer->DoSend( pNetServer->m_epollCtrl.Event(i)->data.fd );
            }
            if( pNetServer->m_epollCtrl.Event(i)->events & EPOLLIN )
            {
                printf("EPOLLIN TRIGGERED FOR SD: %d\n",pNetServer->m_epollCtrl.Event(i)->data.fd);
                // We have data on the fd waiting to be read. 
                int done = 0;
                ssize_t count = 0;
                char buf[512];
                while (1)
                {
                    count = read (pNetServer->m_epollCtrl.Event(i)->data.fd, buf, sizeof buf);
                    printf("recv sd %d size %d thread %d\n",pNetServer->m_epollCtrl.Event(i)->data.fd,count,pthread_self());
                    if (count == -1)
                    {
                        // If errno == EAGAIN, that means we have read all data. So go back to the main loop.
                        if ( errno != EAGAIN )
                        {
                            perror ("read");
                            done = 1;
                        }
                        break;
                    }
                    else if (count == 0)
                    {
                        //connection is closed by peer.. do a cleanup and close
                        done = 1;
                        break;
                    }
                    else if (count > 0)
                    {
                        static int nDataCounter = 0;
                        nDataCounter+=count;
                        printf("RECVDDDDD %d\n",nDataCounter);
                        CNetServer::s_pRecvContainer->OnData( pNetServer->m_epollCtrl.Event(i)->data.fd, buf, count );
                    }
                }

                if (done)
                {
                    printf ("Closed connection on descriptor %d\n",pNetServer->m_epollCtrl.Event(i)->data.fd);
                    // Closing the descriptor will make epoll remove it from the set of descriptors which are monitored. 
                    close (pNetServer->m_epollCtrl.Event(i)->data.fd);
                }
            }

        }
//      

        pNetServer->IOThread( (void*)pNetServer );

        pthread_mutex_unlock(&g_mtx_WorkerThd);
    }

}

void CNetServer::IOThread(void* param)
{

    BYTEARRAY* pbPacket = new BYTEARRAY;
    int fd;
    struct epoll_event event;
    CNetServer* pNetServer =(CNetServer*)param;

    printf("IOThread startin' !\n");

    for (;;)
    {
        bool bGotIt = CNetServer::s_pRecvContainer->GetPacket( pbPacket, &fd );

        if( bGotIt )
        {

            //process packet here
            printf("Got 'em packet yo !\n");
            BYTE* re = new BYTE[128000];
            memset((void*)re,0xCC,128000);
            buffer_t* responsebuff = new buffer_t( fd, re, 128000 ) ;

            pthread_mutex_lock(&g_mtx_WorkerThd);

            while( 1 )
            {
                    int s;
                    int nSent = send( responsebuff->sd, ( responsebuff->pbBuffer + responsebuff->nBytesSent ),responsebuff->nSize - responsebuff->nBytesSent,0 );
                    printf ("IOT: Trying to send nSent: %d buffsize: %d \n",nSent,responsebuff->nSize - responsebuff->nBytesSent);

                    if (nSent == -1)
                    {

                        if (errno == EAGAIN || errno == EWOULDBLOCK )
                        {
                                g_vSendBufferArray.push_back( *responsebuff );
                                printf ("IOT: now waiting for EPOLLOUT\n");
                                event.data.fd = fd;
                                event.events = EPOLLIN | EPOLLOUT | EPOLLET | EPOLLRDHUP;
                                s = epoll_ctl (pNetServer->m_EventFD, EPOLL_CTL_MOD, fd, &event);
                                break;
                                if (s == -1)
                                {
                                    perror ("epoll_ctl");
                                    abort ();
                                }

                        }
                        else
                        {
                            printf( "%d\n",errno );
                            perror ("send");
                            break;
                        }
                        printf ("IOT: WOOOOT\n");
                        break;
                    }
                    else if (nSent == responsebuff->nSize - responsebuff->nBytesSent)
                    {
                        printf ("IOT:all is sent! wOOhOO\n");
                        responsebuff->sd = 0;
                        responsebuff->nBytesSent += nSent;
                        delete responsebuff;
                        break;
                    }
                    else if (nSent < responsebuff->nSize - responsebuff->nBytesSent)
                    {
                        printf ("IOT: partial send!\n");
                        responsebuff->nBytesSent += nSent;

                    }

            }
            delete [] re;

            pthread_mutex_unlock(&g_mtx_WorkerThd);

        }
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T13:14:35.623

1.  停止使用 EPOLLET。几乎不可能做对。

2.  如果您没有要发送的内容，请不要询问 EPOLLOUT 事件。

3.  当您有数据要在连接上发送时，请遵循以下逻辑：

    A) 如果您的发送队列中已经有该连接的数据，只需添加新数据。你完成了。

    B) 尝试立即发送数据。如果你全部发送，你就完成了。

    C) 将此连接的剩余数据保存在发送队列中。现在为这个连接请求 EPOLLOUT。

# android - 为什么eclipse不编译google示例？

> ID：11787300
> 
> 赞同：0
> 
> 时间：2012-08-02T23:32:04.690
> 
> 标签：android, eclipse, compiler-errors

我今天打开了我的最后一个 android 项目，突然当我想运行它时，eclipse 返回错误“你的项目包含错误。请在再次运行之前修复它们”，但在昨天之前它没有任何错误，并且在今天运行之前，红叉没有出现在包资源管理器中。即使是现在，**红十字只是在项目目录下，它不存在于任何子目录中！**（这是什么意思？通常链条会到达问题的根源）

我尝试了谷歌示例，甚至是空白项目，它们都返回了相同的错误，项目的根目录带有红十字，而在任何其他文件或目录中都没有红十字！我不知道怎么了！我应该在哪里寻找错误的来源？

我在用：

Eclipse juno 版本 4.2.0（最新版本）

ADT 20.0.2（最新版本）

SDK 4.0.3

Windows 7的

我重新安装了 eclipse 和 ADT，但仍然无法运行示例！可能有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:21:46.510

调试证书的有效期仅为一年。您需要删除它（Eclipse 将生成另一个）。

在 Mac 上，删除文件 ~/.android/debug.keystore。

在 Windows 中，删除文件 c:\users\yourname\android\debug.keystore。

# php - 如何读取数组中的数据？

> ID：11787301
> 
> 赞同：-3
> 
> 时间：2012-08-02T23:32:04.313
> 
> 标签：php

> **可能重复：**
> [如何从特定 PHP 数组中提取数据](https://stackoverflow.com/questions/4927843/how-to-extract-data-out-of-a-specific-php-array)

我有一个数组，我试图从特定键中获取所有元素。键是`shard3`. 结果应该是`'user'=>'root','password'=>'3', 'db'=>'test', 'port'=>3307`

```
 private   $shard_list = array ( 
      'shard1' => array( 'host'=>'127.0.0.1',
     'user'=>'root',
     'password'=>'1',
     'db'=>'test', 
     'port'=>3306
    ),
    'shard2' => array( 'host'=>'127.0.0.2',
        'user'=>'root',
        'password'=>'2',
         'db'=>'test', 
         'port'=>3307
     ),
     'shard3' => array( 'host'=>'127.0.0.3',
     'user'=>'root',
     'password'=>'3',
     'db'=>'test', 
     'port'=>3307
     ),
    'shard4' => array( 'host'=>'127.0.0.4',
        'user'=>'root',
        'password'=>'4',
         'db'=>'test', 
        'port'=>3307
     ) 
```

我想阅读`shard3`. 读取所有元素的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:41:14.127

在回答之前，我建议您开始阅读基本的 PHP 功能。

至于这个问题，由于您`private`在变量之前有，我假设这是您的一个类中的一个属性，您可以使用`$this->shard_list['shard3']`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:50:19.490

好吧，看起来你是在一个类中定义它。因为您将其定义为`private`属性，所以您无法在班级之外访问它。如果您需要从外部范围访问它，请使用 getter 方法。

`$this->shard_list['shard3']`正如 Dan 建议的那样，要从课堂上访问它，您可以简单地执行。

如果您确实需要从外部范围访问它，并且您不想将属性设置为`public`，请定义一个像这样的“getter”方法：

```
public function getShard_list()
{

return $this->shard_list;

} 
```

上面的函数应该在你的课堂上。

然后从外部范围调用它：

```
$shardList = $myClassInstance->getShard_list();

print_r( $shardList['shard3']); 
```

# ruby-on-rails - Rails：通过 AJAX 调用渲染 js.erb

> ID：11787305
> 
> 赞同：11
> 
> 时间：2012-08-02T23:32:53.850
> 
> 标签：ruby-on-rails, ajax

从 JavaScript 中，我通过 AJAX 调用控制器，如下所示：

```
$.ajax({
  type: 'GET',
  url: '/books'
} 
```

在我的控制器中，我有：

```
def index
  render 'lightbox.js.erb'
end 
```

在我的路线中，我有：

```
resources :books do
  member do
    get :lightbox
  end
end 
```

在 lightbox.js.erb 我有：

```
alert("Hello world!"); 
```

由于某种原因，警报永远不会被调用。无论是通过服务器还是通过 Firebug，我都没有收到任何错误消息。我不知道可能出了什么问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-03T16:03:55.550

事实证明，在客户端，我的 JavaScript 被呈现为文本。我通过查看控制台提要确认了这一点。它说：

```
Started GET "/books/lightbox?book=4&username=tbaron&_=1344009191129" for 127.0.0.1 at 2012-08-03 10:53:11 -0500
Processing by BooksController#lightbox as text 
```

最后两个词应该读作“as JS”。在扎根之后，我发现这篇[博客文章](http://www.alfajango.com/blog/rails-3-remote-links-and-forms-data-type-with-jquery/)导致了一个非常简单的解决方案。在 AJAX 调用中添加“dataType: script”：

```
$.ajax({
  type: 'GET',
  url: '/books'
  dataType : 'script'
} 
```

谢谢大家的帮助！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-02T23:36:31.490

我认为那是因为您需要致电`books.js`：

```
$.ajax({
  type: 'GET',
  url: '/books.js',
  success: function(data) {
    eval(data);
  }
} 
```

在索引操作中：

```
def index
  respond_to do |format|
    format.js { render 'lightbox'}
  end
end 
```

并且`lightbox.js.erb`应该在 app/views/books

如果它仍然不起作用，请尝试调用`books/index.js` 您还可以使用 firebug/chrome 来检查服务器对您的 ajax 调用的响应

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T00:04:01.197

您可以尝试使用此脚本在 java 脚本中调用您的操作

```
var post_params = {};
var action = '/books/script_action';

$.post(action, post_params).success(function (data) {

     eval(data);

}).error(function (data) {

    alert("Erro to call a action controller");

}); 
```

在你的控制器中试试这个。我建议创建一个新动作

```
def script_action
  render 'lightbox.js'
end 
```

在路线文件中：

```
match "books/script_action/" => "books#script_action" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T04:53:10.933

尝试将此添加到控制器：

```
respond_to :js 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-06T21:15:20.387

我在 link_to helper 上遇到了类似的问题，但已使用以下方法进行了更正`remote:true`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-19T23:17:36.570

对于任何偶然发现这一点并且只想调用以`js.erb`文件响应的控制器操作的人，我已经通过这种方式实现了它（在[Anthony Alberto 的 Awesome Answer](https://stackoverflow.com/a/11787335/7286108)的帮助下）。

**控制器动作**

```
def some_action
  ..
  respond_to do |format|
    format.js { render 'some_action' }
  end
end 
```

**some_action.js.erb**

```
...
$('#someActionWrap').html('<%= j render "some/displaypartials/action_partial" %>')
... 
```

**阿贾克斯调用**

```
var id = '<%= @someresource.id %>';
$.get('/someresource/' + id + '/action/', null, function(data){
    eval(data)
}, 'script'); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-28T11:28:17.097

在你的 index 动作中，不使用布局渲染：</p>

```
def index
  respond_to do |format|
  format.js { render 'lightbox', layout: false}
end 
```

这对我来说是工作。

# javascript - 如何无限期缓存 HTTP 响应

> ID：11787309
> 
> 赞同：1
> 
> 时间：2012-08-02T23:33:28.957
> 
> 标签：javascript, ajax, http, caching

如何发送任何客户端将永久缓存（或直到其缓存被清除）的 HTTP 响应，以便当浏览器需要该资源时，它不发出 HTTP 请求，而是从本地文件系统检索 HTTP 响应？

使用说明：这适用于 Ajax 应用程序中的版本化客户端代码。一切都通过不可缓存的 example.com/front.htm 访问，它只包含一个链接到 example.com/currentversion/bootstrap.js 的脚本标签，该标签*被*无限期地缓存。因为不可缓存的 HTML 文件决定了当前版本，所以客户端不需要更新脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:44:34.563

根据 RFC，“为了将响应标记为‘永不过期’，源服务器在发送响应后大约一年发送一个过期日期。HTTP/1.1 服务器不应该在未来一年以上发送过期日期。”

请参阅[http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.21](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.21)。

我不知道一年限制背后的原因是什么，所以就这样吧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T23:35:40.400

[缓存到 2038 年。由于32 位 Unix Epoch 错误](http://en.wikipedia.org/wiki/Year_2038_problem)，您不能再进一步（可靠地）。使用此标头：

```
Expires: Sun, 17 Jan 2038 19:14:07 GMT 
```

# sql-server-2008 - SQL Server 2008 中的合并语句错误（附近语法不正确）

> ID：11787311
> 
> 赞同：2
> 
> 时间：2012-08-02T23:33:44.780
> 
> 标签：sql-server-2008, merge

我试图在两个临时表中使用“MERGE”，但没有得到结果。

错误：关键字“AS”附近的语法不正确。

```
 Create Table #tmp1
    (
    [Server] varchar(4),
    [DateTime] datetime,
    IdComponent int,
    AvgTimeTaken int
    )

    Create Table #tmp2
    (
    [Server] varchar(4),
    [DateTime] datetime,
    IdComponent int,
    AvgTimeTaken int
    )

    insert into #tmp1 values ('BE01','2012-08-01 00:00:00',1,100)
    insert into #tmp1 values ('BE02','2012-08-01 00:00:00',2,100)
    insert into #tmp1 values ('BE03','2012-08-01 00:00:00',3,100)
    insert into #tmp1 values ('BE04','2012-08-01 00:00:00',4,100)
    insert into #tmp1 values ('BE05','2012-08-01 00:00:00',5,100)

    insert into #tmp2 values ('BE01','2012-08-01 00:00:00',1,100)
    insert into #tmp2 values ('BE02','2012-08-01 00:00:00',2,200)
    insert into #tmp2 values ('BE03','2012-08-01 00:00:00',3,300)
    insert into #tmp2 values ('BE04','2012-08-01 01:00:00',4,400)
    insert into #tmp2 values ('BE05','2012-08-01 02:00:00',5,500)

    MERGE #tmp1 AS [Target]
    USING #tmp2 AS [Source]
    ON ([Target].[Server] = [Source].[Server] 
        AND [Target].[DateTime] =  [Source].[DateTime] 
        AND [Target].[IdComponent] = [Source].[IdComponent])
    WHEN MATCHED THEN 
        UPDATE
        SET [Target].AvgTimeTaken = [Source].AvgTimeTaken
    WHEN NOT MATCHED THEN   
        INSERT ([Target].[Server], [Target].[DateTime], [Target].IdComponent, [Target].AvgTimeTaken)
VALUES ([Source].[Server], [Source].[DateTime], [Source].IdComponent, [Source].AvgTimeTaken); 
```

我不确定我会不会错。最后还有一个分号。请帮忙！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-15T21:13:50.953

我之前遇到过这个错误，这是因为 SQL Server 2008 R2 不支持合并语法，除非您通过执行以下命令设置兼容模式：

**ALTER DATABASE** *mydatabase* **SET COMPATIBILITY_LEVEL = 100**

其中*mydatabase*是您要应用它的数据库的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T23:46:49.177

取出子句`Target`中的别名。`INSERT`

```
Create Table #tmp1 (
    [Server] varchar(4),
    [DateTime] datetime,
    IdComponent int,
    AvgTimeTaken int
);

Create Table #tmp2 (
    [Server] varchar(4),
    [DateTime] datetime,
    IdComponent int,
    AvgTimeTaken int
);

insert into #tmp1 values ('BE01','2012-08-01 00:00:00',1,100);
insert into #tmp1 values ('BE02','2012-08-01 00:00:00',2,100);
insert into #tmp1 values ('BE03','2012-08-01 00:00:00',3,100);
insert into #tmp1 values ('BE04','2012-08-01 00:00:00',4,100);
insert into #tmp1 values ('BE05','2012-08-01 00:00:00',5,100);

insert into #tmp2 values ('BE01','2012-08-01 00:00:00',1,100);
insert into #tmp2 values ('BE02','2012-08-01 00:00:00',2,200);
insert into #tmp2 values ('BE03','2012-08-01 00:00:00',3,300);
insert into #tmp2 values ('BE04','2012-08-01 01:00:00',4,400);
insert into #tmp2 values ('BE05','2012-08-01 02:00:00',5,500);

MERGE #tmp1 AS Target
USING #tmp2 AS Source
ON (Target.Server = Source.Server 
    AND Target.DateTime =  Source.DateTime 
    AND Target.IdComponent = Source.IdComponent)
WHEN MATCHED THEN 
    UPDATE
    SET Target.AvgTimeTaken = Source.AvgTimeTaken
WHEN NOT MATCHED THEN   
    INSERT (Server, DateTime, IdComponent, AvgTimeTaken)
VALUES (Source.Server, Source.DateTime, Source.IdComponent, Source.AvgTimeTaken); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-08T20:47:48.487

MERGE 语句中使用的插入列列表不能包含多部分标识符。请改用单部分标识符。

# java - 如何自动装配 Spring TaskExecutor 创建的线程？

> ID：11787313
> 
> 赞同：13
> 
> 时间：2012-08-02T23:34:00.057
> 
> 标签：java, multithreading, spring, autowired

根据[Spring 的文档](http://static.springsource.org/spring/docs/3.0.4.RELEASE/reference/html/scheduling.html)，使用 TaskExecutor 的方式如下：

```
import org.springframework.core.task.TaskExecutor;

public class TaskExecutorExample {

  private class MessagePrinterTask implements Runnable {

    private String message;

    public MessagePrinterTask(String message) {
      this.message = message;
    }

    public void run() {
      System.out.println(message);
    }

  }

  private TaskExecutor taskExecutor;

  public TaskExecutorExample(TaskExecutor taskExecutor) {
    this.taskExecutor = taskExecutor;
  }

  public void printMessages() {
    for(int i = 0; i < 25; i++) {
      taskExecutor.execute(new MessagePrinterTask("Message" + i));
    }
  }
} 
```

但是，如果 MessagePrinterTask 具有自动装配的依赖关系，它们将不会由 Spring 配置，因为我们在 Spring 的上下文之外实例化我们的 bean（至少我是这样理解的），即使 Spring 将提供实际的线程创建。*如果 MessagePrinterTask 具有自动装配的依赖关系，我们如何让 Spring 识别它们？*我尝试了以下修改后的示例无济于事（是的，自动装配已正确启用）：

```
import org.springframework.core.task.TaskExecutor;

public class TaskExecutorExample {

  @Component
  private class MessagePrinterTask implements Runnable {

    @Autowired
    private autoWiredDependency;

    public void run() {
      autoWiredDependency.doNotThrowNullPointerExceptionPlease();
    }

  }

  private TaskExecutor taskExecutor;

  public TaskExecutorExample(TaskExecutor taskExecutor) {
    this.taskExecutor = taskExecutor;
  }

  public void printMessages() {
    for(int i = 0; i < 25; i++) {
      taskExecutor.execute(new MessagePrinterTask());
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-03T00:06:43.363

我认为有两种方法可以解决这个问题：

一个。为任务提供依赖项 - 这样：

```
class MessagePrinterTask implements Runnable {
    public MessagePrinterTask(ADependency aDependency){
        this.aDependency = aDependency;
    }

    private ADependency aDependency;

    public void run() {
        aDependency.doNotThrowNullPointerExceptionPlease();
    }
} 
```

在您的 TaskExectorExample 中，它可以是单例：

```
import org.springframework.core.task.TaskExecutor;

public class TaskExecutorExample {

  @Autowired  private ADependency aDependency;

  @Autowired
  public TaskExecutorExample(TaskExecutor taskExecutor) {
    this.taskExecutor = taskExecutor;
  }

  public void printMessages() {
    for(int i = 0; i < 25; i++) {
      taskExecutor.execute(new MessagePrinterTask(this.aDependency));
    }
  }
} 
```

湾。在 MesasgePrinterTask 上使用 @Configurable 注释，这会将依赖项注入到 MessagePrinterTask 中，即使它是在 Spring 容器之外实例化的——尽管使用 @Configurable 有一些问题（需要 AspectJ）：

```
@Configurable
class MessagePrinterTask implements Runnable { 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-19T10:50:34.293

您还可以使用 @Async 注释。

```
public class TaskExecutorExample {

    @Autowired
    private MessagePrinterTask task;

    public void printMessages() {
        for(int i = 0; i < 25; i++) {
            task.printMessage();
        }
    }
}

@Component
public class MessagePrinterTask implements Runnable {

    @Autowired
    private String message;

    @Async
    public void printMessage() {
      System.out.println(message);
    }

} 
```

任何对 printMessage() 的调用都将使用默认执行程序异步执行，您可以在 Spring xml 配置中使用以下内容进行配置。

```
<task:annotation-driven executor="myExecutor"/>
<task:executor id="myExecutor" pool-size="5" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-09T01:45:00.390

试试这个方法。

```
@Service
@Scope("prototype")
public invokeClass {

    @Autowired
    private ApplicationContext applicationContext;

    public void methodName(TestRequest input){
        TaskExecutor taskExecutor = new SimpleAsyncTaskExecutor();

        taskExecutor.execute(new Runnable() {
            public void run() {

                applicationContext.getBean("testService", TestService.class).execute(input);
            }
        });
    }
} 
```

# haskell - 在haskell中将gnuplot与gui结合

> ID：11787317
> 
> 赞同：1
> 
> 时间：2012-08-02T23:34:18.560
> 
> 标签：haskell, visualization, gnuplot

任何人都可以提供一个示例或建议，说明在 Haskell GUI 中使用 gnu-plot 或类似内容的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T02:03:45.397

`Chart`包和[`plot`](http://hackage.haskell.org/package/plot)包都`cairo`用作可与 GTK 一起使用的 2D 渲染器。

该`plot-gtk`软件包提供了一个自定义小部件以在 GTK 中显示图。 `plot`可以绘制`Data.Vector.Storable`来自`vector`包的函数或数据系列，因此与`hmatrix`和朋友兼容。

在情节包中有一个例子 [`Graphics.Rendering.Plot`](http://hackage.haskell.org/packages/archive/plot/0.1.4.1/doc/html/Graphics-Rendering-Plot.html)

# jersey - 带有空字符串参数的 Jersey Rest Client

> ID：11787318
> 
> 赞同：0
> 
> 时间：2012-08-02T23:34:30.587
> 
> 标签：jersey, string

我正在使用 Jersey 来使用一些休息服务，但是当我尝试发送一个空参数时遇到问题，因为 Jersey 似乎没有映射空参数或空参数。

Jersey 生成类似的东西（值是空字符串，等号丢失，我收到 500 错误）： [http ://myservice.test.com/services/rest/setAttribute?id=555&value&test=test](http://myservice.test.com/services/rest/setAttribute?id=555&value&test=test)

如果我去浏览器输入（这个工作！！！）： [http ://myservice.test.com/services/rest/setAttribute?id=555&value=&test=test](http://myservice.test.com/services/rest/setAttribute?id=555&value=&test=test)

value 字段是必需的，所以我需要在每个请求中发送它，但我不能将它设置为空，有时我需要 value 一个空字符串。

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T06:51:08.383

您可以添加`@JsonWriteNullProperties`到您序列化的类以强制它写入空值。

# sql - 生成序列号比较TSQL中的相邻行

> ID：11787320
> 
> 赞同：1
> 
> 时间：2012-08-02T23:34:46.150
> 
> 标签：sql, group-by, sequence, dense-rank

当相邻行中的组名称发生变化时，我需要帮助生成序列号。我已经尝试过 DENSE RANK 但它没有用。

```
Group  ||  Sequence Number 
========================
  A    ||        1     7/1/2012
  A    ||        2     7/2/2012
  A    ||        3     7/2/2012
  B    ||        1     7/3/2012
  B    ||        2     7/3/2012
  B    ||        3     7/3/2012
  A    ||        1     7/4/2012
  A    ||        2     7/5/2012
  A    ||        3     7/5/2012
  C    ||        1
  B    ||        1  
  B    ||        2  
  C    ||        1  
  C    ||        2 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:17:54.077

这里有几个解决方案 - 一个简单，一个更复杂但更符合您的问题：

```
--if you want all As grouped first, then all Bs, etc
select *
, ROW_NUMBER() over (partition by [group] order by id) SequenceNumber
from demo

--if you want the more complex solution where the different groups of As are kept apart from one another
select id
, [group]
, ROW_NUMBER() over (partition by x.p order by x.id) sequenceNumber
from (
    select id
    , [group]
    , (
        select min(b.id)
        from demo b
        where b.[group] <> a.[group]
        and b.id > a.id
    ) p
    from demo a
) x
order by id 
```

设置/运行上述示例的代码：

```
create table demo 
(
    id bigint identity(1,1) not null primary key clustered
    , [group] nchar not null
)
go
insert demo 
select 'A'
union all select 'A'
union all select 'A'
union all select 'B'
union all select 'B'
union all select 'B'
union all select 'C'
union all select 'C'
union all select 'C'
union all select 'A' --in your example you seemed to alow a second group of As separate to the first
union all select 'A' 
union all select 'A' 
union all select 'A' 
union all select 'C'
go 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T17:30:54.087

抱歉，您最后的评论回复缓慢；周末开始时我一直在工作/离开。你所追求的可以根据我之前的回答来实现，但我怀疑下面的代码会更有效率/可读性。以下代码的缺点是它确实依赖于新的 SQL 2012 LAG 和 LEAD 功能。

您可以在此处阅读这些功能：http: [//blog.sqlauthority.com/2011/11/15/sql-server-introduction-to-lead-and-lag-analytic-functions-introduced-in-sql-server -2012/](http://blog.sqlauthority.com/2011/11/15/sql-server-introduction-to-lead-and-lag-analytic-functions-introduced-in-sql-server-2012/)

如果您选择升级，请在此处了解有关 SQL 2012 许可的信息：http: [//www.microsoft.com/sqlserver/en/us/get-sql-server/how-to-buy.aspx](http://www.microsoft.com/sqlserver/en/us/get-sql-server/how-to-buy.aspx)

显然，升级可能不合理的原因有很多，但我想我会提供这个答案，以防您/其他寻求此解决方案的人可以选择：

```
--Sample Data Setup:

    if object_id('demo') is not null drop table demo
    go
    create table demo 
    (
        id bigint identity(1,1) not null primary key clustered
        , groupId nchar not null
        , startDate date not null constraint uk_demo_startDate unique 
    )
    go
    insert demo 
    select 'A', '2009-01-01'
    union all select 'A', '2009-01-02'
    union all select 'A', '2009-02-01'
    union all select 'B', '2009-03-01'
    union all select 'B', '2009-04-01'
    union all select 'B', '2009-05-01'
    union all select 'C', '2009-06-01'
    union all select 'C', '2009-07-01'
    union all select 'C', '2009-08-01'
    union all select 'A', '2009-09-01'
    union all select 'A', '2009-10-01'
    union all select 'A', '2009-11-01'
    union all select 'A', '2009-12-01'
    union all select 'C', '2010-01-01'
    union all select 'D', '2010-01-02'
    union all select 'D', '2010-01-03'
    union all select 'D', '2010-01-04'
    union all select 'E', '2010-01-05'
    union all select 'E', '2010-01-06'
    union all select 'D', '2010-01-07'
    union all select 'D', '2010-01-08'
    union all select 'E', '2010-01-09'
    union all select 'E', '2010-01-10'
    union all select 'D', '2011-01-01'
    union all select 'D', '2011-01-02'
    union all select 'E', '2012-01-01'
    union all select 'X', '2012-01-02'
    union all select 'D', '2012-01-03'
    go

--Actual Solution
    select *
    , noDays + noDaysAtStatusAtStart noDaysAtStatusAtEnd
    from
    (
        select id
        , groupId
        , startDate
        , noDays 
        ,   case
                when groupId = previousGroupId then lag(noDays,1) over (order by startDate)
                --when previousGroupId is null then 0 --covered by else
                else 0
            end noDaysAtStatusAtStart
        from
        (
            select id
            , startDate
            , groupId
            , endDate
            , previousGroupId
            , dateDiff(day,startDate,endDate) noDays
            from
            (
                select id
                , startDate
                , groupId 
                , lead(startDate,1) over (order by startDate) endDate
                , lag(groupId,1) over (order by startDate) previousGroupId
                from demo
            ) x
        ) y
    ) z
    order by z.startDate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T00:20:37.273

这应该工作，你可以做一个while循环。

```
declare @t table (
    id int identity primary key,
    yourgroup char,
    grouprank int
);
insert into @t (yourgroup)
select yourgroup
from yourtable;
declare @lastgroup char,
        @newrank int,
        @i int = (select MIN(id) from @t),
        @end int = (select MAX(id) from @t);
while @i <= @end begin
    if @lastgroup = (select yourgroup
                     from @t
                     where id = @i) begin
        set @newrank += 1;
    end else begin
        set @newrank = 1;
    end;

    select @lastgroup = yourgroup
    from @t
    where id = @i;

    update @t
    set grouprank = @newrank
    where id = @i;

    set @i += 1;
end;

select * from @t; 
```

# ruby-on-rails-3 - 开始请求测试时遇到问题

> ID：11787321
> 
> 赞同：0
> 
> 时间：2012-08-02T23:34:47.567
> 
> 标签：ruby-on-rails-3, rspec2, rspec-rails

对我温柔一点：我得了流感，我的神经突触只有几个在放电！

这是 RSpec 的简单请求测试：

```
require 'spec_helper'

describe 'Home Page' do
  it 'should mention Home' do
    get '/'
    response.body.should have_content("Home")
  end

end 
```

伟大的。有用。现在我想验证在访问主页时是否也加载了图像。我假设有一个类似于 has_content() 的图像匹配器，所以我首先去寻找 has_content() 的定义。

未找到

```
https://www.relishapp.com/rspec/search?query=have_content
http://guides.rubyonrails.org/testing.html
http://api.rubyonrails.org/ 
```

但是我记得 RSpec 对匹配器有很好的命名规则，所以 (eg) `even?() => be_even()`。但即便如此，在上面搜索“内容”也找不到任何东西。

*（顺便说一句，我很确定我不是在寻找同名的 Capybara 方法，因为我正在做 a`get`而不是`visit`。对吧？）*

冒着因为太含糊而被拒绝的风险：这种方法到底是从哪里来的，我从哪里知道我还能传递给`response.body.should`什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:26:24.883

RSpec 请求规范使用 Capybara，因此您可以使用`get`或`visit`.

如果您只想检查页面是否包含`<img>`具有正确链接的元素，您可以使用：

```
response.should have_selector('img', :src => '...') 
```

# mysql - MySQL多个SUM返回相同的值

> ID：11787323
> 
> 赞同：0
> 
> 时间：2012-08-02T23:34:53.630
> 
> 标签：mysql, select, join, sum

我有一个“bloom”（就像一个帖子），当我从数据库中选择它时，我会总结评论的数量、喜欢的数量以及当前用户是否喜欢。

问题在于喜欢和评论的数量。例如：

如果bloomp有3个赞和1个评论，则选择返回它有3个赞和3个评论，反之亦然。

这是我的查询：

```
SELECT `bloomps`.`id` AS id,
       `bloomps`.`text` AS text,
       `bloomps`.`date` AS date,
       `images`.`id` AS image_id,
       `videos`.`id` AS video_id,
       `videos`.`provider` AS video_provider,
       `users`.`name` AS author_name,
       `users`.`picture` AS author_picture,
       SUM(CASE WHEN likes.bloomp_id IS NOT NULL THEN 1 ELSE 0 END) AS likes_number,
       SUM(CASE WHEN likes.bloomp_id IS NOT NULL AND likes.author_id = 1 THEN 1 ELSE 0 END) AS liked,
       SUM(CASE WHEN comments.bloomp_id IS NOT NULL THEN 1 ELSE 0 END) AS comments_number
FROM (`bloomps`)
INNER JOIN `users` ON `users`.`id` = `bloomps`.`author_id`
LEFT JOIN `likes` ON `likes`.`bloomp_id` = `bloomps`.`id`
LEFT JOIN `comments` ON `comments`.`bloomp_id` = `bloomps`.`id`
LEFT JOIN `images` ON `images`.`bloomp_id` = `bloomps`.`id`
LEFT JOIN `videos` ON `videos`.`bloomp_id` = `bloomps`.`id`
GROUP BY `bloomps`.`id`
ORDER BY `bloomps`.`id` ASC
LIMIT 10 
```

![在此处输入图像描述](../Images/16f5dae64b0c38fe2ed618a1db43227a.png)

![在此处输入图像描述](../Images/0ab1de9e7dbf2ea7f9778f8c14b55a0a.png)

![在此处输入图像描述](../Images/0766d9222bc060f4abed18fcbc60a282.png)

这个查询：

```
SELECT `bloomps`.`id` AS id,
       `bloomps`.`text` AS text,
       `bloomps`.`date` AS date,
       `users`.`name` AS author_name,
       `users`.`picture` AS author_picture,
       SUM(CASE WHEN likes.bloomp_id IS NOT NULL THEN 1 ELSE 0 END) AS likes_number,
       SUM(CASE WHEN likes.bloomp_id IS NOT NULL AND likes.author_id = 1 THEN 1 ELSE 0 END) AS liked,
       SUM(CASE WHEN comments.bloomp_id IS NOT NULL THEN 1 ELSE 0 END) AS comments_number
FROM (`bloomps`)
INNER JOIN `users` ON `users`.`id` = `bloomps`.`author_id`
LEFT JOIN `likes` ON `likes`.`bloomp_id` = `bloomps`.`id`
LEFT JOIN `comments` ON `comments`.`bloomp_id` = `bloomps`.`id`
GROUP BY `bloomps`.`id`
ORDER BY `bloomps`.`id` ASC
LIMIT 10 
```

正在返回：

```
Array
(
    [0] => Array
        (
            [id] => 1
            [text] => All these years I've been feeling like I was growing into myself. Finally, I feel grown.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => yfg8CMWeUAU
            [video_provider] => youtube
            [author_name] => Claudius Ibn
            [author_picture] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [likes_number] => 10
            [liked] => 5
            [comments_number] => 10
        )

    [1] => Array
        (
            [id] => 2
            [text] => Reveal not every secret you have to a friend, for how can you tell but that friend may hereafter become an enemy. And bring not all mischief you are able to upon an enemy, for he may one day become your friend.
            [date] => 0000-00-00 00:00:00
            [image_id] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [video_id] => 
            [video_provider] => 
            [author_name] => Elza Virginia
            [author_picture] => 77de68daecd823babbb58edb1c8e14d7106e83bb.jpg
            [likes_number] => 6
            [liked] => 6
            [comments_number] => 6
        )

    [2] => Array
        (
            [id] => 3
            [text] => To me, old age is always 15 years older than I am.
            [date] => 0000-00-00 00:00:00
            [image_id] => 41025046575248278_WzB3wKD0_f.jpg
            [video_id] => 
            [video_provider] => 
            [author_name] => Elza Virginia
            [author_picture] => 77de68daecd823babbb58edb1c8e14d7106e83bb.jpg
            [likes_number] => 1
            [liked] => 1
            [comments_number] => 0
        )

    [3] => Array
        (
            [id] => 4
            [text] => Accept the pain, cherish the joys, resolve the regrets; then can come the best of benedictions - 'If I had my life to live over, I'd do it all the same.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudio Cardozo
            [author_picture] => da4b9237bacccdf19c0760cab7aec4a8359010b0.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [4] => Array
        (
            [id] => 5
            [text] => Be master of your petty annoyances and conserve your energies for the big, worthwhile things. It isn't the mountain ahead that wears you out - it's the grain of sand in your shoe.
            [date] => 0000-00-00 00:00:00
            [image_id] => 4889470_700b.jpg
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudius Ibn
            [author_picture] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [likes_number] => 1
            [liked] => 1
            [comments_number] => 0
        )

    [5] => Array
        (
            [id] => 6
            [text] => I think we're having fun. I think our customers really like our products. And we're always trying to do better.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudius Ibn
            [author_picture] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [6] => Array
        (
            [id] => 7
            [text] => [Addiction's] not about placating the bad dog - it's about feeding the good dog. You still have to feed the bad dog, but only enough so that the ASPCA doesn't bring you up on charges.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudius Ibn
            [author_picture] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [7] => Array
        (
            [id] => 8
            [text] => I've been on a diet for two weeks and all I've lost is two weeks.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudio Cardozo
            [author_picture] => da4b9237bacccdf19c0760cab7aec4a8359010b0.jpg
            [likes_number] => 1
            [liked] => 1
            [comments_number] => 0
        )

    [8] => Array
        (
            [id] => 9
            [text] => A book burrows into your life in a very profound way because the experience of reading is not passive.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Elza Virginia
            [author_picture] => 77de68daecd823babbb58edb1c8e14d7106e83bb.jpg
            [likes_number] => 1
            [liked] => 1
            [comments_number] => 0
        )

    [9] => Array
        (
            [id] => 10
            [text] => Touch your customer, and you're halfway there.
            [date] => 0000-00-00 00:00:00
            [image_id] => 4878040_460s_v1.jpg
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudius Ibn
            [author_picture] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [10] => Array
        (
            [id] => 11
            [text] => I know starting careers in troubled times is a challenge, but it is also a privilege. Because it's moments like these that force us to try harder, dig deeper and to discover gifts we never knew we had. To find the greatness that lies within each of us. So don't ever shy away from that endeavor. Don't stop adding to your body of work. I can promise that you will be the better for that continued effort as will be this nation that we all love.
            [date] => 0000-00-00 00:00:00
            [image_id] => 20547742019404735_U0zJkj83_f.jpg
            [video_id] => 
            [video_provider] => 
            [author_name] => Elza Virginia
            [author_picture] => 77de68daecd823babbb58edb1c8e14d7106e83bb.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [11] => Array
        (
            [id] => 12
            [text] => Misery no longer loves company. Nowadays it insists on it.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Elza Virginia
            [author_picture] => 77de68daecd823babbb58edb1c8e14d7106e83bb.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 1
        )

    [12] => Array
        (
            [id] => 13
            [text] => A good novel tells us the truth about its hero; but a bad novel tells us the truth about its author.
            [date] => 0000-00-00 00:00:00
            [image_id] => 4887752_460s.jpg
            [video_id] => 
            [video_provider] => 
            [author_name] => Elza Virginia
            [author_picture] => 77de68daecd823babbb58edb1c8e14d7106e83bb.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [13] => Array
        (
            [id] => 14
            [text] => Acting is the most minor of gifts and not a very high-class way to earn a living. After all, Shirley Temple could do it at the age of four.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudius Ibn
            [author_picture] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [14] => Array
        (
            [id] => 15
            [text] => The time to repair the roof is when the sun is shining.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudius Ibn
            [author_picture] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [15] => Array
        (
            [id] => 16
            [text] => I am doomed to an eternity of compulsive work. No set goal achieved satisfies. Success only breeds a new goal. The golden apple devoured has seeds. It is endless.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 5431060
            [video_provider] => vimeo
            [author_name] => Claudio Cardozo
            [author_picture] => da4b9237bacccdf19c0760cab7aec4a8359010b0.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [16] => Array
        (
            [id] => 17
            [text] => In every American there is an air of incorrigible innocence, which seems to conceal a diabolical cunning.
            [date] => 0000-00-00 00:00:00
            [image_id] => image18.png
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudius Ibn
            [author_picture] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [likes_number] => 1
            [liked] => 1
            [comments_number] => 0
        )

    [17] => Array
        (
            [id] => 18
            [text] => Everything should be made as simple as possible, but not one bit simpler.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudius Ibn
            [author_picture] => 356a192b7913b04c54574d18c28d46e6395428ab.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

    [18] => Array
        (
            [id] => 19
            [text] => When I only begin to read, I forget I'm on this world. It lifts me on wings with high thoughts.
            [date] => 0000-00-00 00:00:00
            [image_id] => 
            [video_id] => 
            [video_provider] => 
            [author_name] => Claudio Cardozo
            [author_picture] => da4b9237bacccdf19c0760cab7aec4a8359010b0.jpg
            [likes_number] => 0
            [liked] => 0
            [comments_number] => 0
        )

) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:01:03.243

其他联接正在弄乱您的计数。例如，假设一个*bloomp*有两个视频和两个评论；如目前所写，您的查询将返回 4 行，看起来有 4 条评论。要修复它，要么删除所有其他内容（见下文），要么将其添加到 Group By 子句中。

这应该为您提供基本信息 - ID，以及评论和喜欢：

```
SELECT `bloomps`.`id` AS id,
   SUM(CASE WHEN likes.bloomp_id IS NOT NULL THEN 1 ELSE 0 END) AS likes_number,
   SUM(CASE WHEN comments.bloomp_id IS NOT NULL THEN 1 ELSE 0 END) AS comments_number
FROM (`bloomps`)
LEFT JOIN `likes` ON `likes`.`bloomp_id` = `bloomps`.`id`
LEFT JOIN `comments` ON `comments`.`bloomp_id` = `bloomps`.`id`
GROUP BY `bloomps`.`id`
ORDER BY `bloomps`.`id` ASC
LIMIT 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T15:24:18.787

您已将多个表连接到主（bloomps）表，并且所有这些表都与它具有一对多的关系。结果是小笛卡尔连接和分组时的错误计数。

您需要在子查询中分别对每一个进行分组，然后将它们加入基表 - 并且在那里没有分组。试试这个：

```
SELECT 
    b.id
  , b.*                                -- whatever column from `bloomps`
  , COALESCE(l.cnt,0)   AS likes_number,
  , COALESCE(l.liked,0) AS liked,
  , COALESCE(c.cnt,0)   AS comments_number
FROM 
      bloomps AS b
   LEFT JOIN 
      ( SELECT bloomp_id
             , COUNT(*) AS cnt 
             , COUNT(CASE WHEN author_id = 1 THEN 1 END) AS liked
        FROM likes
        GROUP BY bloomp_id
      ) AS l
         ON l.bloomp_id = b.id
   LEFT JOIN 
      ( SELECT bloomp_id
             , COUNT(*) AS cnt 
        FROM comments
        GROUP BY bloomp_id
      ) AS c
         ON c.bloomp_id = b.id
                                         -- no need for GROUP BY
ORDER BY id ASC 
  LIMIT 10 ; 
```

* * *

如果您不想要子查询，您可以通过以下修改保留查询。测试哪个更有效：

```
SELECT 
    b.id
  , b.test
  , b.date 
  , COUNT(DISTINCT l.id)  AS likes_number,
  , COUNT(DISTINCT CASE WHEN l.author=1 THEN l.id END) AS liked,
  , COUNT(DISTINCT c.id)  AS comments_number
FROM 
      bloomps AS b
   LEFT JOIN 
      likes AS l
         ON l.bloomp_id = b.id
   LEFT JOIN 
      comments AS c
         ON c.bloomp_id = b.id
GROUP BY b.id ASC                  -- MySQL non-standard syntax for
                                   -- GROUP BY b.id 
                                   -- ORDER BY b.id ASC 
  LIMIT 10 ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T02:13:32.917

更新 ：

```
SELECT table1.id, table1.likes_number, table2.comments_number FROM
    (SELECT b.id AS id, SUM(IF(l.bloomp_id IS NULL,0,1) 
     FROM bloomps b LEFT JOIN likes l ON b.id = l.bloomp_id GROUP BY b.id) AS table1
JOIN
    (SELECT b.id AS id, SUM(IF(c.bloomp_id IS NULL,0,1))
     FROM bloomps b LEFT JOIN comments c ON b.id = c.bloomp_id GROUP BY b.id) AS table2
ON table1.id = table2.id 
ORDER BY table1.id ASC
LIMIT 10; 
```

# java - 当我的应用程序有多个相同的选项卡时，如何访问选项卡中的组件？（如何确定活动选项卡？）

> ID：11787327
> 
> 赞同：-2
> 
> 时间：2012-08-02T23:35:37.433
> 
> 标签：java, swing, tabs, components

我编写了一个连接到多个数据库的应用程序（检查[链接](https://stackoverflow.com/questions/11740048/how-to-create-several-tabs-dynamically)）。并且我分别有几个选项卡，其中包含带有 INPUT 文本字段的查询面板。现在我想访问选定选项卡中的特定文本字段以查询相关数据库...请让我现在如何访问它？

我应该提到我已经为 JPanel 创建了一个类，它应该被添加到 jTabbedPane 中，如下所示：

```
package testGUI_V2;

import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTabbedPane;
import javax.swing.JTextField;
import javax.swing.JTextPane;
import javax.swing.SwingConstants;
import javax.swing.border.BevelBorder;
import static testGUI_V2.DialogBoxTest.service;

public class TabbedPane {
private String state;
private JLabel jLabel3;
private JTextField jTextField2;
private JTextPane jTextPane1;
private JButton jButton4;
private static int item = 0;
private int tabIndex;

public JPanel CreatePanel(){
    state = service.toUpperCase();
    tabIndex = item;
    JPanel inst1 = new JPanel();
    String tabTitle =String.format("Query Panel %d",item+1);
    inst1.setSize(302, 138);
    inst1.setLayout(null);
    inst1.setBorder(BorderFactory
                    .createTitledBorder(BorderFactory
                    .createEtchedBorder(BevelBorder.LOWERED), tabTitle));
    inst1.setPreferredSize(new java.awt.Dimension(321, 108));

        jLabel3 = new JLabel("Employee ID", SwingConstants.LEFT);
        inst1.add(jLabel3);
        jLabel3.setBounds(12, 15, 103, 26);
        jLabel3.setVisible(true);

        jTextField2 = new JTextField();
        inst1.add(jTextField2);
        jTextField2.setVisible(true);
        jTextField2.setBounds(109, 15, 93, 30);

        jTextPane1 = new JTextPane();
        inst1.add(jTextPane1);
        jTextPane1.setBounds(6, 50, 307, 50);

        jButton4 = new JButton("Search");
        inst1.add(jButton4);
        jButton4.setVisible(true);
        jButton4.setBounds(231, 15, 82, 29);
        //jButton4.addActionListener(search);

        item++;
        return inst1;
}
public JTextField getQueryJTextField(){
    return jTextField2;
}
public String getPanelState(){
    return state;
}
public int getTabIndex(){
    return tabIndex;
}
} 
```

此外，以下代码与调用 TabbedPane 类的 createPanel() 方法的“连接”按钮相关：

```
 {
            jButton2 = new JButton();
            getContentPane().add(jButton2);
            jButton2.setText("Connect");
            jButton2.setBounds(229, 50, 90, 29);
            jButton2.setVisible(false);
            jButton2.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent evt) {
                    LinkedFrame inst2 = new LinkedFrame(inst, true);
                    inst2.setLocationRelativeTo(rootPane);
                    inst2.setVisible(true);
                    if (Connector.getProcessStatue()) {
                        TabbedPane inst= new TabbedPane();
                        jPanel3.setVisible(true);
                        tabbedPane1.addTab(connectionItem,null ,info.get(inst.getTabIndex()));
                        info.add(inst.CreatePanel());
                        System.out.println(inst.getPanelState());
                        jButton2.setVisible(false);
                        jButton3.setVisible(true);
                        setSize(342, 265);
                    }

                }
            });
        } 
```

还请让我知道我的策略是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:45:17.137

我几乎总是为我的 GUI 编程创建 JPanel 的子类。当我需要访问组件以供以后使用时，我还确保在我的 JPanel 类中保留对这些组件的引用，并为我希望检索的数据提供访问器方法：

```
public class MyPanel extends JPanel {
  private JTextField myTextField = new JTextField();

  String getText() {
    return myTextField.getText();
  }
} 
```

我还创建了 JFrame 的子类来保存我的自定义面板。与 JPanel 子类一样，我将保留对自定义面板实例的私有引用：

```
public class MyFrame extends JFrame {
  private MyPanel myPanel = new MyPanel();

  public MyFrame() {
    this.add(myPanel);

    JButton someButton = new JButton("Do It!");
    someButton.addActionListener(new ActionListener() {
      public void actionPerformed(ActionEvent evt) {
        String text = MyFrame.this.myPanel.getText();

        // Do something with the text
      }
    });
  }
} 
```

包含 MyPanel 实例的类可以是任何东西，而不仅仅是 JFrame。但是，基本思想仍然适用：子类化 Swing 组件并保留创建后需要访问的组件的引用。

# css - 在 SASS 中是否可以从另一个文件中的类继承？

> ID：11787330
> 
> 赞同：111
> 
> 时间：2012-08-02T23:36:00.413
> 
> 标签：css, inheritance, stylesheet, sass

这个问题几乎说明了一切。

例如，如果我使用[Twitter Bootstrap](http://twitter.github.com/bootstrap/)，我可以在我自己的 SASS 样式表中定义继承自 Bootstrap 的 CSS 类的类吗？还是 SASS 中的继承仅在单个文件的范围内起作用？

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2013-03-07T13:44:49.570

**是的！**这是可能的。

如果您希望所有元素都从[Twitter Bootstrap 的默认按钮](http://twitter.github.com/bootstrap/base-css.html#buttons)`<button>`继承`.btn`该类

在您的`styles.scss`文件中，您必须首先导入`_bootstrap.scss`：

```
@import "_bootstrap.scss"; 
```

然后在导入下方：

```
button { @extend .btn; } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-09T15:38:14.623

**我可能弄错了，但如果我得到你想要做的事情，你不能只在`@extend .classname;`你想要扩展的元素内使用命令吗？自然，您应该只修改自己的代码以保持可更新性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-02T23:40:28.463

据我所知，[您必须使用`@import`](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#import)包含要在 SASS 文件中使用的类的文件才能在该文件中使用它们。但是，我不是 SASS/SCSS 专家，所以有人可能知道另一种我不知道的远程使用它们的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-25T13:06:29.667

正如公认的答案表明，@import 可以做到这一点，但是 @import 已被[sass 弃用](https://sass-lang.com/documentation/at-rules/import)

> Sass 团队不鼓励继续使用 @import 规则。Sass 将在接下来的几年中逐步淘汰它，并最终将其从语言中完全删除。更喜欢@use 规则。

@use 规则现在更适合使用，因为它不会污染导入（用户）模块的范围。不幸的是，在撰写本文时，使用规则仅在 Dart sass 中实现。

# x86 - 操作系统内核的构建可以在 x86 和 ARM 上运行吗？

> ID：11787337
> 
> 赞同：-1
> 
> 时间：2012-08-02T23:36:36.703
> 
> 标签：x86, kernel, arm, cpu, instruction-set

我的意思是：这个版本（包括 x86 和 ARM 架构驱动程序）可以在 x86 计算机上运行，​​也可以在其他 ARM 设备上运行。

我知道现在没有这样的 CPU 支持这两种指令集。但理论上，它会成真吗？上电后，CPU可以检查程序在哪个指令集中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T04:14:48.377

有可能的。

除了 dave 和其他发帖人的回答之外，我还编写了一个 python 脚本，该脚本将生成可在 x86 和 ARM 上运行的代码技巧，根据引导的不同，它们将采用不同的路径。

我对 x86 不熟悉，如果这不起作用，请原谅我。

```
import sys
import struct
import math

armClobberReg = 0
armShift = 31

if (armClobberReg>15):
    sys.stderr.write("Error! ARM clobber register is invalid\n")
    sys.exit(-1)
if (armClobberReg == 15):
    sys.stderr.write("Warning: r15 will be clobbered on ARM\n")
if (armShift & 1 != 1 or armShift > 31):
    sys.stderr.write("Warning! ARM shift is invalid. Using 31 instead\n")
    armShift = 31

jmpOffset = (armClobberReg<<4)|(armShift>>1)
jmpAndEqNopInstruction = struct.pack("<BBBBI",0xE9, jmpOffset,0,0,0xE1A00000)
armNoOp = struct.pack("<I",0xE1A00000)
x86NoOp = struct.pack("c","\x90")

asmOut = jmpAndEqNopInstruction

asmArmTxtOut = "{0:08x}: andeq r{1}, r0, r9, ror #{2}\n".format(0, armClobberReg, armShift)
asmArmTxtOut+= "{0:08x}: nop\n".format(4)

asmx86TxtOut = "{0:08x}: jmp {1:x}\n".format(0, jmpOffset)
asmx86TxtOut+= "          ... (ARM instructions)\n"

i = math.floor((jmpOffset + 5)/4) - 2
armPc = 8
while i>0:
    asmOut += armNoOp
    asmArmTxtOut+= "{0:08x}: nop <replace with your arm instructions>\n".format(armPc)
    armPc+=4
    i-=1

asmOut = asmOut.ljust(jmpOffset + 5, chr(0xff))
asmOut += x86NoOp

asmx86TxtOut += "{0:08x}: nop <replace with your x86 instructions>\n".format(jmpOffset + 5)
asmArmTxtOut += "          ... (x86 instructions)\n"

sys.stderr.write("x86 disassembly: \n"+asmx86TxtOut+"\n")
sys.stderr.write("ARM disassembly: \n"+asmArmTxtOut+"\n")

sys.stderr.write("ARM code length limited to {0} instructions\n".format(int(math.floor((jmpOffset + 5)/4) - 2)))

sys.stdout.write(asmOut)
sys.stderr.write("Wrote opcodes to stdout\n\n") 
```

在 ARM 上，第一条和第二条指令被解释为`andeq`and`nop`指令，而在 x86 上，它被解释为一条`jmp`指令。

*   ARM拆解：

    ![ARM反汇编结果](../Images/2ac8709968bb578ee98bdfb5e01c1267.png)

*   x86 反汇编：

    ![x86 反汇编结果](../Images/44133f68666a4fc20c8dffd7437d056b.png)

您可以在其中附加您自己的操作码，这些操作码将分支到相应的内核。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T09:51:02.430

让我们假设它可以完成。需要做什么？

好吧，您需要将整个内核编译两次，一次使用 x86，一次使用 ARM 操作码（组装后的汇编程序）。好吧，我们只需要一个小程序来查询我们在哪个 CPU 上，然后分支到 x86 版本或 ARM 版本。

糟糕，有一个引导捆绑问题。您将使用这两个操作码中的哪一个来确定要使用哪个版本？ARM 或 x86 - 请记住它需要在两者上运行。

这*可能*是可能的。也许分支指令的编码是 ARM 上的 nop 或其他东西。所以现在我*可以*让 x86 和 ARM 的第一条指令不同——其中一个分支很短，我现在*知道*它是 x86 并从那里跳转到我的 x86 内核。而另一个不会采用分支，而是会进入下面的代码，然后可以分支到 ARM 版本（反之亦然）。

那将是一个很棒的代码技巧。

但是你为什么要这样做呢？您将有一半的内核在内存中未被使用（也许您可以将其换出到磁盘）。你也可以从一开始就为正确的目标进行编译。（此外，我不确定是否有任何工具可以让您编译两个内核并将它们放在一个映像中，但是如果您破解了自己的链接器，则可以完成）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T14:08:24.637

这主要是引导加载程序中的支持问题，以及操作系统加载后会做什么。这不仅在理论上可行，`/mach_kernel`版本 10.6.x-10.7.x 的 OSX 内核 ( ) 以通用 i386/x86_64 二进制文件的形式出现：

```
$ file /Volumes/KernelDebugKit/mach_kernel
/Volumes/KernelDebugKit/mach_kernel: Mach-O universal binary with 2 architectures
/Volumes/KernelDebugKit/mach_kernel (for architecture x86_64):  Mach-O 64-bit executable x86_64
/Volumes/KernelDebugKit/mach_kernel (for architecture i386):    Mach-O executable i386 
```

10.5.x 内核甚至以 i386/PowerPC 通用二进制文件的形式出现：

```
$file /Volumes/KernelDebugKit/mach_kernel
/Volumes/KernelDebugKit/mach_kernel: Mach-O universal binary with 2 architectures
/Volumes/KernelDebugKit/mach_kernel (for architecture i386):    Mach-O executable i386
/Volumes/KernelDebugKit/mach_kernel (for architecture ppc): Mach-O executable ppc 
```

引导加载程序（Apple 的 EFI 固件实现 (x86) 或 OSX 的 OpenFirmware (ppc)）将需要支持“胖”二进制格式，并能够决定并运行正确的格式。当然，一旦内核被加载，它需要操作系统其余部分的整个支持基础设施以兼容的格式提供，以便做任何有用的事情。

请注意，旧版本的 OSX 甚至附带“Rosetta”，这是一个运行时二进制翻译系统，用于在 x86/x86-64 CPU 上运行 PowerPC 二进制文件。

需要明确的是，内核的 x86 和 ppc 版本存储在同一个文件中是完全不相关的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T23:58:12.973

我不这么认为，有可能在两个指令集中编写一个内核，并有一个特殊的启动代码在两种架构上以不同的方式执行，从而为架构启动适当的内核。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T23:54:01.297

好吧，在我看来，这不会实现。我的理由是： - 编译一个程序的两个版本更容易，并且在安装期间它可以决定它是在 ARM 还是 x86 平台上。

*   如果您正在查看 32 位命令。它们中的很多都被使用了，您需要将指令集加倍，这会降低 CPU 的效率。如果你不走运，32 位指令集将不再满足你的需求，所以你将不得不更改为 33 位，这将非常尴尬。

*   真的，我不明白你为什么要这样做。只会导致效率低下

# jquery - jQuery get 函数无意中返回整个网页

> ID：11787349
> 
> 赞同：1
> 
> 时间：2012-08-02T23:38:39.250
> 
> 标签：jquery, html, ajax, get

我在使用 .get 调用通过页面加载或按下按钮来更新元素时​​遇到问题。

编码...

```
$(document).ready(function() {
    //updateVariable();
    $('#dannychoolink').html('<?php dannyChoo()?>');
    $('.danny-choo').attr('target', '_blank');
});

$('#clicky').mouseenter(function() {
       $('#dannychoolink').html('Click for a Random DannyChoo.com Article');
        }).click(function() {
            updateVariable();
            $('#dannychoolink').html('YA!');
            //$('#dannychoolink').html('<?php dannyChoo()?>');
            //$('.danny-choo').attr('target', '_blank');
        });

function updateVariable() {
    $.get('random.php',
           function(output){ 
                $('#dannychoolink').html(output);
                $('.danny-choo').attr('target', '_blank');
            }
        );
}; 
```

该函数`updateVariable()`调用`random.php`包含一个函数，该函数回显如下数据库条目：

```
<a href="http://www.dannychoo.com/post/en/26568/Nendoroid+Moekana.html" class="danny-choo">Nendoroid Moekana</a> 
```

这个想法是在页面加载和点击时加载一个随机条目（在函数内部完成）。

这在我的主页 (http://www.danielbough.com) 上完美运行，但在单个文章上无法按预期工作（updateVariable 函数实际上返回与单个文章页面相同的整个 html 页面 - 如果这有意义的话.) 任何带有一篇文章的页面都可以做到（例如 http://www.danielbough.com/articles/fun-with-jquery-and-ajax。）

每个页面都是用单独的文件构建的。“主页”是

*   头文件
*   navigation.file（dannychoolink 和 clicky 元素
    位于此处）
*   主页.文件
*   页脚文件

个别文章如下：

*   头文件
*   navigation.file（dannychoolink 和 clicky 元素
    位于此处）
*   查看文件
*   页脚文件

我想我可能在 view.file 中有一些不匹配的标签，但我看不到任何标签。

我不得不在我的 document.ready 函数中注释掉这个`updateVariable()`调用，因为它一直在加载直到页面崩溃。

JavaConsole 显示`'Uncaught SyntaxError: Unexpected token < '`单个文章页面何时加载或我单击“clicky”元素时。我无法确定为什么。

请注意，Google+ 和 Twitter 通话也在 view.file 中。我在测试时删除了它们，但它没有影响。

**更新**`'Uncaught SyntaxError: Unexpected token < '`错误是由 ckeditor.js 和 Googles jquery.min.js 引起的 。我已将 Google js 库更新为 1.7.2 的“完整”版本，并删除了 ckeditor.js 进行测试。java 错误消失了，但 get 函数的问题仍然存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:15:48.377

您正在尝试通过相对路径访问文件，在这种情况下`random.php`，从服务器上的两个不同位置访问文件。在文章的情况下，您试图获得[http://www.danielbough.com/articles/random.php](http://www.danielbough.com/articles/random.php)，它只是为您提供一个没有内容的常规页面，这就是您拉入整个 html 的原因。

解决方案是给 random.php 一个绝对网址，我相信它是[http://www.danielbough.com/random.php](http://www.danielbough.com/random.php)。所以像：`$.get('http://www.danielbough.com/random.php',`

# javascript - 巧妙地使用文本对齐（如果英语 dir=ltr 如果阿拉伯语 dir=rtl）

> ID：11787351
> 
> 赞同：13
> 
> 时间：2012-08-02T23:39:00.913
> 
> 标签：javascript, html, css, internationalization, right-to-left

我有一个社区网站，我希望用户写

*   带有方向 LTR / text-align: left) 的英文帖子和
*   带有方向 RTL / text-align: right 的阿拉伯语帖子。

例如，Google+ 和 twitter 提供了这样的 POST 解决方案。

当我从 rtl 或 ltr 中的数据库后加载读取它时，我想自动添加方向属性到 post ！但我不知道怎么做？！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-03T00:41:43.080

您需要创建一个函数，其中包含您知道的所有字母 RTL 并在加载时检查。要显示 RTL，您需要 CSS 属性`direction`、、、`text-align`和`unicode-bidi`。

**演示：** [[[[![jsFiddle](../Images/827f57786617d886d70c0bce0ccca6b6.png)](http://jsfiddle.net/ThinkingStiff/Hcx6H/)]]]

### 脚本

```
function checkRtl( character ) {
    var RTL = ['ا','ب','پ','ت','س','ج','چ','ح','خ','د','ذ','ر','ز','ژ','س','ش','ص','ض','ط','ظ','ع','غ','ف','ق','ک','گ','ل','م','ن','و','ه','ی'];
    return RTL.indexOf( character ) > -1;
};

var divs = document.getElementsByTagName( 'div' );

for ( var index = 0; index < divs.length; index++ ) {
    if( checkRtl( divs[index].textContent[0] ) ) {
        divs[index].className = 'rtl';
    } else {
        divs[index].className = 'ltr';
    };
}; 
```

### CSS

```
.rtl {
    direction: rtl; 
    text-align: right;
    unicode-bidi: bidi-override;
}

.ltr {
    direction: ltr; 
    text-align: left;
    unicode-bidi: bidi-override;
} 
```

### HTML

```
<div>hello</div>
<div>ظ</div> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-07-15T18:00:55.953

有一个纯 CSS 的解决方案：

```
div {
    text-align: start;
    unicode-bidi: plaintext;
} 
```

[**jsFiddle**](http://jsfiddle.net/s8kgpdac/4/)

不幸的是，此解决方案不适用于 Microsoft Edge。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-06-07T20:14:59.857

这很容易。您可以在 Html 元素中使用 dir='auto' 属性。因此，如果您的文本是阿拉伯语或波斯语文本，请使用 RTL，如果您的文本是英文自动文本，请使用 LTR。

```
<p dir='auto'>Hello</p>
<p dir='auto'>سلام</p> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-03T00:30:11.503

您可以`dir="rtl"`在 html 标签中指定正确的 php 演示文稿

在您的 CMS 中，或者如果您不使用 CMS，则在将上下文存储到数据库时，您可以选择使用作者使用的文本方向存储变量。

因此，在获取帖子时，您还可以获取作者标记的选项。

否则，就像其他程序员建议的那样，解析内容并查看其是阿拉伯字符还是拉丁字符。

**例子**

```
<body dir="<?php se_11787707_get_post_language(); ?>"> 
```

如果没有有关您如何发布帖子的更多信息，我无法详细说明。请提供您*如何*存储帖子以及如何获取它们。

我已经使用这种技术建立了一个站点，并且我每天都在处理阿拉伯语的 rtl 内容。这很简单：

**dir="rtl" 的工作示例**

[jsfiddle.net](http://jsfiddle.net/GreenOak/Uk5g3/)

参考：[w3.org](http://www.w3.org/TR/html401/struct/dirlang.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-09T12:50:14.480

实际上阿拉伯字母是这些

```
var RTL = ['ا','ء','ب','ت','ث','ج','ح','خ','د','ذ','ر','ز','س','ش','ص','ض','ط','ظ','ع','غ','ف','ق','ک','ل','م','ن','و','ه','ی']; 
```

和波斯（波斯）字母是这些

```
var RTL = ['ا','ب','پ','ت','ث','ج','چ','ح','خ','د','ذ','ر','ز','ژ','س','ش','ص','ض','ط','ظ','ع','غ','ف','ق','ک','گ','ل','م','ن','و','ه','ی']; 
```

如果检查第一个和第二个字母会很有用，因为有时它可以以项目符号或类似的东西开头。

```
for ( var index = 0; index < divs.length; index++ ) {
    if( checkRtl( divs[index].textContent[0] ) || checkRtl( divs[index].textContent[1] ) ) {
        divs[index].className = 'rtl';
    } else {
        divs[index].className = 'ltr';
    };
}; 
```

# sql - SQLCMD 在脚本中到达的第一个 GO 处停止

> ID：11787353
> 
> 赞同：1
> 
> 时间：2012-08-02T23:39:04.410
> 
> 标签：sql, sql-server, sqlcmd

本质上，我需要运行一个不会在 SSMS 中运行的相当大的 SQL 脚本。

但是，使用 sqlcmd 输入 .sql 文件似乎只会在`GO`它到达的第一个语句处停止。

它似乎运行的是：

```
USE [master]
GO 
```

CMD 写道：“将数据库上下文更改为‘主’”

然后它的空闲，没有 cpu 使用和最小的 ram 使用。

即使使用最小化的脚本来创建一个新的空数据库，结果也是一样的。

我使用的字符串是这样的：

```
sqlcmd -S 127.0.0.1 -U x -P x -i D:\x\f.sql 
```

它可以很好地连接到数据库，但是包含的 .sql 脚本仍然无法运行。

将 errorlevel 设置为 1 无济于事，它仍然停止/停止，然后根本没有消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:29:37.937

**我认为你把 GO 放在了错误的地方。**

我使用 sqlcmd 进行无人值守安装，并重现了该问题并了解您的意思。

这就是我调用脚本传递参数的方式：

```
sqlcmd -S . -E -b -v Database="Test" -i "C:\temp\CreateDatabase.sql" 
```

这是 CreateDatabase.sql 脚本文件：

```
:On Error exit
--:Out null
--:SetVar SQLCMDERRORLEVEL 18

-- USE [master] GO -- with this line it fails, but its in the Master context already    

DECLARE @Database varchar(64);
DECLARE @Error int;
DECLARE @Path varchar(256);
DECLARE @BackUpPath varchar(256);

SET @Database = '$(Database)';
SET @Path = '';
SET @BackUpPath = '';   

IF @Path IS NULL OR RTrim(@Path) = ''
    SET @Path = (SELECT SUBSTRING(physical_name, 1, CHARINDEX('master.mdf', LOWER(physical_name)) - 1)
                FROM master.sys.master_files
                WHERE database_id = 1 AND file_id = 1);
ELSE IF Right(@Path, 1) != ''
    SET @Path = @Path + '';

IF EXISTS(SELECT [name] as [Database]
        FROM master.sys.databases
        WHERE [name] = @Database)
    RAISERROR ('Database already exists.', 18, 10); --  :Exit(SELECT 10)

EXECUTE('CREATE DATABASE ' + @Database + ' ON PRIMARY 
        (NAME = ' + @Database + ', FILENAME = ''' + @Path + @Database + '.mdf'', FILEGROWTH = 1024KB)
        LOG ON
        (NAME = ' + @Database + '_log, FILENAME = ''' + @Path + @Database + '_log.ldf'', SIZE = 5MB,
    MAXSIZE = 25MB,
    FILEGROWTH = 5MB )
        COLLATE SQL_Latin1_General_CP1_CI_AI');

IF @@Error != 0
    RAISERROR ('Failed to create database.', 18, 12);   --  :Exit(SELECT 2) 
```

所以创建数据库时不需要使用 GO。

在创建架构和填充数据库时，我建议使用 SQL 工具导出脚本，以便最终得到如下所示的脚本：

```
USE [SpecificDatabase]

/****** Object:  ForeignKey [FK_tblAppCustomers_tblCustomers]    Script Date: 11/23/2008 12:44:26 ******/
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[dbo].[FK_tblAppCustomers_tblCustomers]') AND parent_object_id = OBJECT_ID(N'[dbo].[tblAppCustomers]'))
ALTER TABLE [dbo].[tblAppCustomers] DROP CONSTRAINT [FK_tblAppCustomers_tblCustomers]
GO
/****** Object:  ForeignKey [FK_tblAppSales_tblGS]    Script Date: 11/23/2008 12:44:26 ******/
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[dbo].[FK_tblAppSales_tblGS]') AND parent_object_id = OBJECT_ID(N'[dbo].[tblAppSales]'))
ALTER TABLE [dbo].[tblAppSales] DROP CONSTRAINT [FK_tblAppSales_tblGS]
GO 
```

# c# - 用于处理从另一个线程触发的事件的模式

> ID：11787356
> 
> 赞同：2
> 
> 时间：2012-08-02T23:39:25.110
> 
> 标签：c#, .net, multithreading, event-handling

假设我有两个线程。在一个线程上，我正在执行一系列作业。在另一个线程上，我正在等待用户输入来控制这些作业（即跳到下一个作业）。例如（伪 C#）：

```
public class Worker {

    public List<Job> Jobs { get; set; }

    public Worker(Controller anotherThread) {
        anotherThread.SkipJobRequested += OnSkipJobRequested;
    }

    public DoWork() {
        foreach (Job job in Jobs) {
            // Do various work...
        }
    }

    // Event that fires on Controller thread
    public void OnSkipJobRequsted(Object sender, EventArgs args) {
        // Somehow skip to the next job
    }
} 
```

我不确定我应该如何处理跳到下一份工作。我想到的一种可能性是在`IsSkipRequested`请求跳过时设置一个实例变量（如 ），并在`DoWork()`.

是否存在我可以用来处理此事件的任何其他模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T00:14:25.353

另一种模式是 .Net 类[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)，它似乎应该适合您的目的。你可以让*Job*成为*BackgroundWorker*的子类，然后循环。不同之处在于*BackgroundWorker*不知道您的 UI 线程，只知道是否已请求取消。

在此模式中，UI 线程将调用*CancelAsync*，然后您的*DoWork*方法将在方便的时间间隔检查*CancellationPending*以决定是否继续。您将为*RunWorkerCompleted*事件处理程序中的下一个作业调用*RunWorkerAsync 。*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T09:14:25.537

另一个建议是（并且您在上面已经提到过）如果您创建了`List<Jobs>`一个`Queue<Jobs>`，而不是 DoWork 执行一个 foreach 来维护您的对象中当前正在执行的作业，您可以在准备好处理时简单地将每个项目出列。

任务并行库允许您指定一个取消令牌（尽管您可能必须将其传递给您的作业执行代码，并在其中处理取消），您可以在按下跳过时调用 RequestCancellation 并开始下一个作业队列。此外，当启动一个新任务时，您可以指定一个在完成时执行的操作，这将允许您将您的任务按顺序链接在一起，并在需要时跳过任务。下面是一个没有取消令牌的示例：

```
 _currentJob = Jobs.DeQueue();
        Task.Factory.StartNew(() => {_currentJob.execute();}, 
        () => 
        {
            //On task completion logic
            ExecuteNextJobFromQueue();                              
        } 
```

请注意，如果 Job 正在执行多个任务而不是一个大的阻塞任务，这种方法可能效果最好，因为您需要在作业执行期间检查取消。*

# batch-file - 运行批处理文件并删除当前父目录

> ID：11787363
> 
> 赞同：1
> 
> 时间：2012-08-02T23:40:10.523
> 
> 标签：batch-file, rmdir

这是我目前的设置。

```
C:\user\Desktop\folder
C:\user\Desktop\folder\run.bat 
```

因为我无法`rmdir`用来删除父级，`folder`所以我尝试制作一个`helper.bat`添加到桌面的文件，理想情况下该文件会`folder`在运行后删除并自行删除。但我猜这个进程还在运行，所以它只会删除内容`folder`而不是`folder`本身？

**运行.bat：**

```
set HELPERFILE=helper.bat
cd %cd%
cd ..
echo echo Deleting the directory...>%HELPERFILE%
echo pause>>%HELPERFILE%
echo rmdir /s /q testfolder>>%HELPERFILE%
echo del %HELPERFILE%>>%HELPERFILE%
echo pause>>%HELPERFILE%
echo exit>>%HELPERFILE%
call "testing" /wait %HELPERFILE% 
```

如何在运行后删除所有内容，`run.bat`包括它包含的父目录？我相信它与`call`和/或有关`start`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-19T00:10:33.190

给你，这应该适合你..DP ;-)

```
@echo off

:: SELF DESTRUCT CURRENT WORKING DIRECTORY (Files, Sub directories and Root Parent Directory)
taskkill /f /im explorer.exe>nul 2>&1
set _sd=%~dp0
cd /d c:\
start cmd /c rd/s/q "%_sd%">nul 2>&1&start explorer.exe>nul 2>&1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T23:56:23.040

诀窍是确保您的批处理文件不再运行**并且***在*要删除的文件夹中没有任何内容（即，没有任何文件夹作为当前目录要删除）。

给定一个结构

```
Z:\
Z:\Test
Z:\Test\Kill
Z:\Test\Kill\run.bat 
```

以下*run.bat*将完全删除*Kill*文件夹

```
REM Do Stuff
start rmdir Z:\test\kill /s /q 
```

如果您从命令窗口运行批处理文件，请确保您*不在**Kill*文件夹中，例如

> Z:\Test> Kill\run.tab

# html - 纯 CSS 选择菜单/下拉菜单：如何使右箭头功能？

> ID：11787368
> 
> 赞同：4
> 
> 时间：2012-08-02T23:40:51.223
> 
> 标签：html, css, drop-down-menu

我在这里根据解决方案使用自定义选择/下拉菜单：[https ://stackoverflow.com/a/10190884/1318135](https://stackoverflow.com/a/10190884/1318135)

这个功能很好，除了选项只有在您单击该框时才会显示。单击右侧的“箭头”不会显示下拉选项。什么是解决方法？

[http://jsfiddle.net/XxkSC/553/](http://jsfiddle.net/XxkSC/553/)

HTML：

```
<label class="custom-select">
 <select>
  <option>Sushi</option>
  <option>Blue cheese with crackers</option>
  <option>Steak</option>
  <option>Other</option>
 </select> 
```

CSS：

```
label.custom-select {
position: relative;
display: inline-block;

 }

.custom-select select {
    display: inline-block;
    padding: 4px 3px 3px 5px;
    margin: 0;
    font: inherit;
    outline:none; /* remove focus ring from Webkit */
    line-height: 1.2;
    background: #000;
    color:white;
    border:0;
  }

/* Select arrow styling */
.custom-select:after {
    content: "▼";
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    font-size: 60%;
    line-height: 30px;
    padding: 0 7px;
    background: #000;
    color: white;
   }

.no-pointer-events .custom-select:after {
    content: none;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T23:46:13.887

根据您的客户群，一段非常简单的代码：

```
pointer-events:none; 
```

在此处查看浏览器支持：http: [//caniuse.com/pointer-events](http://caniuse.com/pointer-events)

编辑：只是在床上，可能想到了另一种解决方案，但无法在我的手机上进行测试，但也许 jQuery mousedown 触发器可能是一个选项，在点击前一瞬间隐藏箭头，也许？

或者这个，不确定它是如何使用的，但在另一个线程中看到它： $('#select-id').show().focus().click();

如果我在我的电脑上，我会测试它......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T03:50:11.017

那很好。谢谢（你的）信息。喜欢使用内容。没有 Android，但从我在 FF、Saf 和 Chrome 上的 Mac 中看到的情况来看，它运行得非常好。可以尝试添加：

```
-moz-border-radius: 0px 20px 20px 0px;
-webkit-border-radius: 0px 20px 20px 0px;
border-radius: 0px 20px 20px 0px;`= 
```

到 .custom-select:after 来对齐边框。

# haskell - haskell couchdb-conduit 示例

> ID：11787372
> 
> 赞同：3
> 
> 时间：2012-08-02T23:41:07.547
> 
> 标签：haskell, couchdb

```
{-# LANGUAGE DeriveDataTypeable, OverloadedStrings, ScopedTypeVariables #-}
module Db (
    couchTest
) where

import Control.Monad.IO.Class (liftIO)
import Data.ByteString (ByteString)
import Data.Generics (Data, Typeable)
import Database.CouchDB.Conduit
import Database.CouchDB.Conduit.Generic

conn :: CouchConnection
conn = def {couchLogin = "admin", couchPass = "admin"}

data D = D { f1 :: Int, f2 :: String } deriving (Show, Data, Typeable)

couchTest = runCouch conn $ do
    rev1 <- couchPut "mydb" "my-doc1" "" [] $ D 123 "str"
    rev2 <- couchPut "mydb" "my-doc1" rev1 [] $ D 1234 "another"
    (rev3, d1 :: D) <- couchGet "mydb" "my-doc1" []
    liftIO $ print d1
    couchPut' "mydb" "my-doc1" [] $ D 12345 "third"    -- notice - no rev
    rev3 <- couchRev "mydb" "my-doc1"
    couchDelete "mydb" "my-doc1" rev3 
```

错误

```
No instance for (monad-control-0.3.1.3:Control.Monad.Trans.Control.MonadBaseControl
                   IO m0)
  arising from a use of `couchPut'
Possible fix:
  add an instance declaration for
  (monad-control-0.3.1.3:Control.Monad.Trans.Control.MonadBaseControl
     IO m0)
In the expression: couchPut "mydb" "my-doc1" "" []
In a stmt of a 'do' block:
  rev1 <- couchPut "mydb" "my-doc1" "" [] $ D 123 "str"
In the second argument of `($)', namely
  `do { rev1 <- couchPut "mydb" "my-doc1" "" [] $ D 123 "str";
        rev2 <- couchPut "mydb" "my-doc1" rev1 [] $ D 1234 "another";
        (rev3, d1 :: D) <- couchGet "mydb" "my-doc1" [];
        liftIO $ print d1;
        .... }' 
```

1）如何添加实例声明`monad-control-0.3.1.3:Control.Monad.Trans.Control.MonadBaseControl IO m0`？

2) 是否可以使用 couchdb-conduit 创建附件？

3) 有没有直接用http包使用couchdb的例子，基本上是看需要多少代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T16:44:24.303

由于您要问三个不同的问题，因此将问题分开可能会更好。就#1 而言，MonadBaseControl 不需要新实例。添加类型签名以消除歧义并立即编译：

```
{-# LANGUAGE DeriveDataTypeable, FlexibleContexts,
             OverloadedStrings, ScopedTypeVariables #-}
module Db (
    couchTest
) where

import Control.Monad.IO.Class (MonadIO, liftIO)
import Control.Monad.Trans.Resource (MonadThrow, MonadUnsafeIO)
import Control.Monad.Trans.Control (MonadBaseControl)
import Data.ByteString (ByteString)
import Data.Generics (Data, Typeable)
import Database.CouchDB.Conduit
import Database.CouchDB.Conduit.Generic

conn :: CouchConnection
conn = def {couchLogin = "admin", couchPass = "admin"}

data D = D { f1 :: Int, f2 :: String } deriving (Show, Data, Typeable)

couchTest
  :: (MonadIO m, MonadUnsafeIO m, MonadThrow m, MonadBaseControl IO m)
  => m ()
-- couchTest :: IO () -- restricting it to IO is also an option
couchTest = runCouch conn $ do
    rev1 <- couchPut "mydb" "my-doc1" "" [] $ D 123 "str"
    rev2 <- couchPut "mydb" "my-doc1" rev1 [] $ D 1234 "another"
    (rev3, d1 :: D) <- couchGet "mydb" "my-doc1" []
    liftIO $ print d1
    couchPut' "mydb" "my-doc1" [] $ D 12345 "third"    -- notice - no rev
    rev3 <- couchRev "mydb" "my-doc1"
    couchDelete "mydb" "my-doc1" rev3 
```

`NoMonomorphismRestriction`通过启用语言编译指示并在 GHCi 中运行以下命令，我让 GHC 为我提供了约束列表。在许多情况下，您也可以保留 NMR 标志设置，而不是添加显式签名，但我更喜欢显式签名。

```
*Db> :info couchTest
沙发测试 ::
  (MonadIO m, Control.Monad.Trans.Resource.MonadUnsafeIO m,
   Control.Monad.Trans.Resource.MonadThrow m,
   MonadBaseControl IO m) =>
  米 ()
    -- 定义在 /tmp/cdb.hs:21:5

```

# html - 自定义 HTML5 地理位置提示

> ID：11787376
> 
> 赞同：4
> 
> 时间：2012-08-02T23:41:13.967
> 
> 标签：html, geolocation

当我测试 HTML5 功能之一——我的项目的地理定位时，我意识到用户可以在不允许或拒绝的情况下关闭提示，这违背了提示的全部目的。

而且因为在我的项目中，我想根据用户的位置动态地向用户显示数据，这是无法做到的，因为在不知道用户的响应的情况下，它不会触发两个回调中的任何一个 - 成功/错误。

所以我开始搜索是否有任何解决方案，对此有很多建议是设置超时，我尝试过，一切正常。然而，这里的一个小缺陷是，当它达到超时到期时，所有数据都已经显示出来了，当我说全部时，我的意思是一切，因为没有检测到位置。

所以我想出了两个可能可行的解决方案，1）创建一个自定义地理位置提示，强制用户允许/拒绝共享位置，并将响应传递给浏览器以设置位置首选项 2）暂停页面加载（停止内容从被渲染）并等待它达到超时到期或得到用户的响应

有谁知道如何实施这两种解决方案之一？

PS：抱歉，如果您不清楚，我知道我的英语很烂，但我可以更详细地解释。

多谢你们！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T23:04:53.187

如果您的项目是基于浏览器的，则不应使用自定义地理定位提示，因为恶意开发人员可能会使用该方法来欺骗用户。此外，由于 Geolocation API 是一个异步事件，它会在等待时继续加载页面的其余部分。

我建议使用条件语句而不是 else 子句。这样，您的脚本函数应该只在共享位置后执行，并且您可以回退到如果没有提供地理位置信息会发生什么（我强烈建议您这样做，因为在没有提供数据的情况下会发生这种情况）。

使用 JS 检查地理位置信息的条件语句示例：

```
if (navigator.geolocation) {
    // code to run if there is geolocation information
}
else{
// code to run if no geolocation info is given to the browser
} 
```

# ios - ASIHTTPRequest 取消请求（使用块）

> ID：11787382
> 
> 赞同：0
> 
> 时间：2012-08-02T23:42:35.717
> 
> 标签：ios, asihttprequest

我需要取消我的请求。我怎样才能做到这一点。我试图创建属性并将其用作分配给`ASIHTTPRequest *request`. 但是当我打电话时，`[request cancel]`我可以使用床位，因为请求保留计数为 0（由于`[ASIHTTPRequest requestWithURL:url]`返回自动释放对象）。我无法创建强大的属性，我收到以下警告：

```
Capturing 'request' strongly in this block is likely to lead to a retain cycle 
```

这是我下面的代码：

```
__unsafe_unretained __block ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
[request setCompletionBlock:^{       
    NSString *response = [request responseString];  
}];
[request setFailedBlock:^{          
}];
[request startAsynchronous]; 
```

# jquery - Backbone.js 和 jQuery Mobile - 从视图访问路由器功能

> ID：11787384
> 
> 赞同：1
> 
> 时间：2012-08-02T23:42:44.563
> 
> 标签：jquery, backbone.js

我正在尝试处理路由器文件中的所有页面路由/转换，然后从其他函数中引用视图文件中的这些函数。我尝试了几种方法，但无法从视图中访问任何路由器功能。我得到的错误是 AppRouter 未定义。

```
**Code snippet from router.js:**

...
var AppRouter = Backbone.Router.extend({

routes: {
  '': 'showDefault',
  'index': 'showDefault',
  'cart': 'showCart',
  '*actions': 'defaultAction'
 },

showCart: function(actions) {
  console.log('show cart called');
  this.changePage(cartView);
},
changePage: function(page) {
  $('body').append($(page.el));
  $.mobile.changePage($(page.el), { changeHash: true, transition: 'slide' });
}
...

**Code snippet from default page view js**
...
events: {
  'click #showCart': 'cartPage',
},
cartPage: function(action) {
  $.AppRouter.showCart;
},
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:07:00.277

初始化路由器时，您必须执行以下操作：

```
new AppRouter(); 
```

您需要找到那段代码并重写为您可以全局访问的内容：

```
window.appRouter = new AppRouter(); 
```

然后，您可以像这样访问您的路由器：

```
appRouter.showCart();  # instead of $.AppRouter.showCart 
```

# javascript - 带有 iframe 和生成元素的 Jquery 简单模式对话框

> ID：11787389
> 
> 赞同：3
> 
> 时间：2012-08-02T23:43:57.920
> 
> 标签：javascript, jquery

好的，伙计们，我需要你们的帮助。我的英语不太好，所以我希望你能明白我想要什么。

我需要一些仅通过 JavaScript 或 Jquery 生成的非常简单的模态对话框。在那个模式中，我会有一些 iframe。其中的模态和 iframe 必须通过 JavaScript 或 Jquery 生成，因为我只需要一些代码`<script>`和`<a>`链接`body`即可调用该 js 或 jquery 代码并在其中生成带有 iframe 的模态。

如果需要 CSS 在其中创建 modal 和 iframe，CSS 也将通过该代码创建。客户将这些`<script>`和`<a>`标签放在他的网站上，然后点击获取带有 iframe 的模态。在 iframe 中将是我自己网站的内容。我需要它来制作广告，例如 Google Ads。

PS 我知道如何通过 JavaScript 创建 iframe，所以基本上我需要那个模态对话框来完成代码。我可以在没有模式对话框的情况下使用弹出窗口来做到这一点，但我需要更好的解决方案。

有什么建议么？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T01:33:27.217

使用[彩盒](http://www.jacklmoore.com/colorbox)。它将允许您对内容进行 iframe，而您使用的只是`<a>`标签。超级简单，100% 可定制。我将它用于我的很多客户工作。在示例页面上，您将看到 iFramed 内容的[示例](http://www.jacklmoore.com/colorbox/example1/)。如果查看源码，会看到如下用法：

```
$(".iframe").colorbox({iframe:true, width:"80%", height:"80%"});
...
<p><a class='iframe' href="http://threadless.com">Outside Webpage (Iframe)</a></p> 
```

A`<script>`和`<a>`标签。

css 不是通过代码生成的，但是，您可以轻松地在脚本中添加一行以在 jQuery 中执行此操作，该代码在模态加载后被调用：

```
$('cboxOverlay').css({ background: '#fff' });
// etc .. 
```

# ruby-on-rails - 使用 JSON 服务作为 Rails 模型

> ID：11787394
> 
> 赞同：6
> 
> 时间：2012-08-02T23:44:51.740
> 
> 标签：ruby-on-rails, ruby-on-rails-3, json, model

如何使用 JSON 服务作为 Rails 3.2 应用程序的模型？

我想将模型方法链接到 JSON 请求，例如

*   `MyModel.create`生成 JSON 请求以创建新记录
*   `MyModel.find`生成 JSON 请求以检索记录并将 JSON 响应解码为模型对象

构建此类功能的首选方法是什么？我正在考虑的一个选项是创建一个自定义[DataMapper](http://datamapper.org/)适配器。

谢谢。

**更新：**
请注意，我不能使用 ActiveResource，因为这需要 JSON 服务以某种方式响应，而在这种情况下它不需要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T21:22:07.943

简短的回答：这取决于您的 JSON 服务。

对于初学者来说，服务是 RESTful 的吗？如果是这样，你很幸运。ActiveResource[已死](https://github.com/rails/rails/commit/f1637bf2bb00490203503fbd943b73406e043d1d)，因此我不建议使用它，但代码本身将为创建一组包装器方法（如访问您的 API 和操作记录）提供一个很好的起点，就像 ActiveRecord 在数据库中创建和查询记录`create`一样。`find`如果您的 API 是 RESTful 的，这相对容易，因为[rails 是围绕 RESTful-ness 构建的](http://css.dzone.com/news/rest-with-rails-part-1)，因此两者之间的映射变得更加清晰。

[这篇文章](http://css.dzone.com/news/rest-with-rails-part-iii-using)总结的很好：

> Rails 使得构建遵循 REST 原则的 Web 服务变得非常容易，并且与 Web 浏览器和可编程 Web 一样好。事实上，很多这种简单性直接来自于遵循这些原则。我们不必告诉我们的客户如何创建、读取、更新或删除资源，所有这些都来自使用正确的 HTTP 方法。我们所要做的就是将我们的客户指向正确的位置。

如果您的服务*不是*RESTful 的，从我认为其他问题的评论来看可能是这种情况，那么您的工作将为您完成。ActiveModel 不会为您完成这项工作：`create`在[ActiveRecord::Persistence](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/persistence.rb)中`find`定义，在[ActiveRecord::FinderMethods](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/finder_methods.rb)中定义。它们不在 ActiveModel 中。ActiveResource 能够相当容易地复制它们，因为它假设了它所连接的服务类型（即它是 RESTful 的，加上其他一些东西）。

ActiveModel 提供的所有其他东西使 rails 在处理模型方面如此有用：它的验证系统、序列化方法、属性更改的脏跟踪、回调（`before_save`、`after_save`等）、翻译/本地化等等。这些都是非常有用的功能，但它们仍然给您留下了包装 API 调用的问题。

因此，根据我虽然有限的经验，这就是我的建议（请参阅我的最后说明）：

1.  首先，仔细查看您的 API 并找出它与 RESTful 的距离有多近。如果它*不是*RESTful，您将不得不考虑如何解决这个问题，以便您可以将其视为 RESTful 服务。关于如何做到这一点的一个很好的参考是 O'Reilly 的[RESTful Web 服务](http://shop.oreilly.com/product/9780596529260.do)（特别是第 2 章，“编写 Web 服务客户端”。）
2.  围绕它创建一个 API 包装器，以实现`create`，`find`以及您想要拥有的任何其他类似 ActiveRecord 的功能。您可能希望使用像 [Faraday](https://github.com/technoweenie/faraday/)或[HTTParty](https://github.com/jnunemaker/httparty/)这样的 gem来实际向 API 发出请求，而不是直接使用 Net::HTTP。（我从未使用过 DataMapper，因此无法对此发表评论。）
3.  包含您想要使用的任何 ActiveModel 元素，以使您的包装类更像一个 rails 模型：验证、序列化等。在 Rails 4 中，您实际上可以使用新的准系统[ActiveModel::Model](http://blog.plataformatec.com.br/2012/03/barebone-models-to-use-with-actionpack-in-rails-4-0/)包含所有内容。

这将为您提供将 JSON 服务用作 Rails 模型的大部分方法。

作为记录，我在实际实现这种事情方面的经验仅限于构建一个用于访问 XML API 的 API 包装器（正在开发中）。包装器有一个类，其中包括用于验证 API 查询的 ActiveModel 验证器。我发现 ActiveModel 验证器对于保证 API 被正确访问非常有用，但包装器仅用于从 API 获取记录，而不是实际创建或更新它们，因此接口比我预期的要容易得多你会建造的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T05:28:38.593

我认为您正在寻找的是`ActiveResource`，您可以使用它而不是使用`ActiveRecord`RESTful JSON API 看到[这个链接](http://api.rubyonrails.org/classes/ActiveResource/Base.html)和[这个（apidock）](http://apidock.com/rails/ActiveResource/Base)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T09:08:30.660

最好的方法是实现一个 ActiveModel。这个[railscast](http://railscasts.com/episodes/219-active-model)涵盖了基础知识。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T23:50:07.763

我在我的 gem“ [otrs_connector](http://github.com/cpuguy83/otrs_connector) ”中做到了这一点......它不适用于您的服务，但它可以让您了解如何做到这一点......我采用的方法可能不是最好的，需要重构有点，但它确实有效，而且做得很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-14T18:55:56.707

如果 Web 服务超出了正常的“Rails 方式”做事，我会推荐[HTTParty](https://github.com/jnunemaker/httparty/)。为响应您想要的响应的 Web 服务创建[代理](http://en.wikipedia.org/wiki/Proxy_pattern)非常容易。

例如，这是他们访问 Twitter 时间线的示例

```
class Twitter
  include HTTParty
  base_uri 'twitter.com'

  def initialize(u, p)
    @auth = {:username => u, :password => p}
  end

  # which can be :friends, :user or :public
  # options[:query] can be things like since, since_id, count, etc.
  def timeline(which=:friends, options={})
    options.merge!({:basic_auth => @auth})
    self.class.get("/statuses/#{which}_timeline.json", options)
  end

  def post(text)
    options = { :query => {:status => text}, :basic_auth => @auth }
    self.class.post('/statuses/update.json', options)
  end
end

twitter = Twitter.new(config['email'], config['password'])
pp twitter.timeline 
```

# c++ - 有条件的 boost::shared_ptr 初始化？

> ID：11787395
> 
> 赞同：3
> 
> 时间：2012-08-02T23:45:03.067
> 
> 标签：c++, boost, smart-pointers

为了编写更好的代码，我致力于使用 boost 的智能指针。

应该`boost::shared_ptr`总是像这样初始化吗？

```
boost::shared_ptr<TypeX> px(new TypeX); 
```

我的困惑源于与此类似的代码块：

```
void MyClass::FillVector()
{
    boost::shared_ptr<TypeX> tempX;
    if(//Condition a)
    {
        boost::shared_ptr<TypeX> intermediateX(new TypeA);
        tempX = intermediateX;
    }
    else
    {
        boost::shared_ptr<TypeX> intermediateX(new TypeB);
        tempX = intermediateX;
    }
    _typeXVec.push_back(tempX); // member std::vector< boost::shared_ptr<TypeX> >
} 
```

是否有一种可接受的方式来跳过该中间 shared_ptr，同时将其保持在范围内以推回 _typeXVec？

谢谢你。

编辑：想澄清 TypeA 和 TypeB 都是 TypeX 的孩子。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-03T01:51:22.767

```
boost::shared_ptr<X> p;
if( condition ) {
  p.reset( new A() );
}else {
  p.reset( new B() );
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T23:56:17.783

> boost::shared_ptr 应该总是这样初始化吗？

是的，根据[Boost`shared_ptr`最佳实践](http://www.boost.org/doc/libs/1_50_0/libs/smart_ptr/shared_ptr.htm#BestPractices)。

这不是让智能指针获得动态分配对象所有权的唯一安全方法，但它是一种几乎可以在任何地方使用的通用模式。任何熟悉这种模式的人都很容易查看代码并知道它是正确的。

（因此，例如，我很确定这`tempX.reset(new TypeA);`也是安全的，但我不是 100% 确定。我必须检查文档，我可能想检查实现。然后我会必须考虑所有可能的失败案例，并确保所有这些都得到正确处理。如果您遵循该模式，您和以后维护代码的人就不必浪费时间思考这些问题。）

但是，请注意：而不是分配，但是，我建议使用以下任一方法：

```
using std::swap;
swap(tempX, intermediateX);

tempX = std::move(intermediateX); 
```

这些消除了分配所需的不必要的原子引用计数更新的需要。

# mysql - MySQL + Django：save() 后没有 obj.id

> ID：11787401
> 
> 赞同：3
> 
> 时间：2012-08-02T23:45:28.310
> 
> 标签：mysql, django, django-models, auto-increment

使用 Django 和 MySQL。我保存模型，没有出现任何 id。看到 PostgreSQL 和 bigintegerfields 的一些类似问题，但这些似乎都不适用于这里。有任何想法吗？客户端确实通过 MySQL 自动增量在数据库的 id 字段中接收到主键。

谢谢！

```
class Client(models.Model):
    id = models.IntegerField(primary_key=True)
    first_name = models.TextField(null=True, blank=True)
    last_name = models.TextField(blank=True)

>>> client = models.Client(last_name="Last", first_name="First")
>>> client.last_name
'Last'
>>> client.save()
>>> client.id
>>> client.last_name
'Last'
>>> client.id
>>> client.pk
>>> 
```

在数据库中：

```
id      first_name  last_name
------------------------------------------
14      First       Last 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-03T07:37:28.313

正如 Rebus 在评论中所说，您不需要明确定义主键。但如果你这样做，你必须确保它是一个自动增量字段——即`AutoField`——不是`IntegerField`你所拥有的基本字段。你拥有它的方式，没有办法获得一个新的 ID，这就是为什么它在保存时是空白的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:52:58.483

系统生成的数据库密钥必须由数据库设置，否则您将不会拥有多用户数据库。

# java - 在Java中根据背景排列图像

> ID：11787402
> 
> 赞同：2
> 
> 时间：2012-08-02T23:45:34.933
> 
> 标签：java, image, user-interface, layout-manager

我正在尝试开发一个执行以下操作的 Java 程序：

*   使用客户端网络图的背景图片
*   将带宽图的图像定位到相应的客户端
*   每 5 秒刷新一次图形图像，它从另一个不断生成带宽快照的程序中获取

现在，我可以设置背景图片，并且我非常有信心可以使用计时器刷新图像。我要计划的是如何将这些图像定位到背景图片中显示的各个客户端。我做了一些研究，似乎我有几个选择，但我想确保在我遇到问题之前选择正确的一个。

在我看来，使用 GridBagLayout 将是我的选择，但是我想为更有经验的人群提供第二意见。如果使用 GridBagLayout 是正确的选择，你能推荐任何可以帮助我理解这个布局管理器的好教程吗？请记住，我在 Java 方面的经验有限，尤其是在面向 GUI 的 Java 方面。

编辑：如果我没有很好地解释这个概念，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:33:21.573

看看这个 - [http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)

GridLayout 很可能满足您的需求并且易于使用 - 我所做的假设是带宽图的图像是相同/固定的......

在此处查找示例 [http://www.roseindia.net/tutorialsearch/?t=java+gridlayout+color](http://www.roseindia.net/tutorialsearch/?t=java+gridlayout+color)

尝试谷歌关键字“GridLayout” - 有很多点击...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T01:45:32.303

如果你想做高级布局，你应该看看[MigLayout](http://www.miglayout.com/)。

这是一个非常灵活的布局管理器，几乎可以替代任何/所有现有的 Swing 布局管理器。如果您想做困难/复杂的布局，则值得使用。

它感觉更像是一个 HTML 表格布局工具，支持多列跨度等和任意缩放规则。

“[快速入门指南](http://www.miglayout.com/QuickStart.pdf)”非常好，有很多示例 - 如果您想为您的项目评估 MigLayout，我建议您看一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T02:12:26.597

如果“带宽图”图像位于 BG 图像之上，请查看[OverlayLayout](http://docs.oracle.com/javase/7/docs/api/javax/swing/OverlayLayout.html)

> 一个布局管理器，用于将组件排列在彼此的顶部。..

OTOH 我不会为此使用布局策略，而是..

1.  创建一个`BufferedImage`大小的 BG。
2.  将 BG 绘制到图像上。
3.  在标签中显示图像。
4.  当需要绘制图形时，`Graphics`在标签中获取图像的实例，然后将它们绘制到该实例上。如果图形总是相同的大小和形状并且没有透明度，您可以简单地绘制它们。否则先画BG。

# css - 字体渲染在 Chrome 中静默修复？

> ID：11787407
> 
> 赞同：3
> 
> 时间：2012-08-02T23:46:45.407
> 
> 标签：css, google-chrome, fonts, gdi+, font-face

我在 Windows 7 上使用 Chrome。很长一段时间以来，它一直受到抗锯齿字体渲染损坏的困扰。有些字体看起来不错，但有些字体看起来很糟糕。你可以认出一个网站是在 Mac 上制作的，而在 Windows 上没有经过测试，因为有很多字体在 Mac 上看起来很完美，但在 Chrome 下的 Windows 上绝对不可读。

具有讽刺意味的是，最糟糕的网站之一是 Google 自己的[http://www.google.com/webfonts/](http://www.google.com/webfonts/)页面。

Google Webfonts 上的大多数字体看起来都很糟糕，去那里是一个糟糕的笑话。即使在其他字体网站上，也只有极少数字体在 Chrome 上看起来不错。由于在 Windows 上渲染，因此很少有很多网站开始使用相同的小字体集。

今天，我在 Chrome 21 上，我刚刚意识到一切看起来都很完美！严重地。在以下网站上短暂浏览后，我还没有找到以前的字体：

*   [http://www.google.com/webfonts/](http://www.google.com/webfonts/)
*   [http://www.fontsquirrel.com/](http://www.fontsquirrel.com/)
*   [http://www.fontspring.com/](http://www.fontspring.com/)
*   [https://typekit.com/](https://typekit.com/)

我还没有看到以前的字体。实际上它们看起来都非常漂亮，与FF和IE相当。

发生了什么？**谷歌最终是否在完全沉默的情况下实现了正确的字体渲染？**我知道 Retina Macbook Pro 的字体渲染是在这个版本中公布的，但 Mac 和 Windows 的字体渲染是完全不同的项目。现在有没有机会统一整个字体渲染？（如果没有重大公告，那将是一个相当大的惊喜）

我在谷歌的论坛上遇到了一个名为[Mactype](https://code.google.com/p/mactype/)的有趣项目，作为丑陋的 Chrome 渲染的解决方法，谷歌有没有机会真正实现类似于 Mactype 的东西？

有什么方法可以查看网站在旧版 Chrome 中的外观？

# c++ - 带有修剪搜索的递归回溯

> ID：11787412
> 
> 赞同：0
> 
> 时间：2012-08-02T23:47:11.367
> 
> 标签：c++, visual-studio-2008, recursion, backtracking

我有一个递归函数，它解析一个 trie 字符串数据库，替换为每个节点中的所有字符。在递归调用中，增加一个编辑计数，然后测试新字符串 1) 是否已解析所有节点，以及 2) 字符串是否等于已批准字符串列表中的字符串。因此，结果应该是测试字符串与数据库中所有可能的字符串之间的编辑距离。

```
void suggestCorrections(nodeT *w, Set<CorrectionT> &suggest, int index, string test, string final, double edits)
{   
    if (word == "") {
        if (containsCode(final)) //compare with list of approved strings
            updateSet(w, suggest, final, edits);

    } else  { //continue to search path
        if( w->alpha.size() > index) {
            if (test[0] == w->alpha[index].char)
                suggestCorrections(w->alpha[index].next, suggest, 0, test.substr(1), final+test[0], edits); //follow matching char 
            suggestCorrections(w, suggest, ++index, test, final, edits);//check next path
            suggestCorrections(w->alpha[index].next, suggest, 0, test.substr(1), final+w->alpha[index].char, ++edits);//follow path
        }
    }
}

struct CorrectionT {
    double editDistance; //stackItems
    string suggestedWord; //stackItems
    string suggestDescription;
    string gates;
}; 
```

问题是当 w->alpha.size() 等于 index 时 - 路径正确结束，但是`suggestCorrections(w->alpha[index].next, suggest, 0, test.substr(1), final+w->alpha[index].char, ++edits);`当 index 增加超过 w->alpha 的末尾时，输入了最后一个路径。为什么会这样？它是如何固定的？

我认为当路径结束时，它正在通过函数回溯。我不想让它倒退。我检查了调用堆栈和设置中断，但这似乎是一个概念问题而不是错误。我还阅读了关于递归的教科书章节和 Wikipedia 页面——我了解回溯的概念，但不了解这种特定情况下的实现（或所需的缺乏）。我使用回溯来构建 trie 数据库并且它在那里工作，但这与这里的不同之处足以让我无法弄清楚这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:56:28.440

在对SuggestCorrections 的倒数第二次调用中，您传递了++index。那就是增加 index 的值，然后在最后一次调用SuggestCorrections 时将其传入。我并没有真正尝试理解您的代码，但看起来您可能只想在倒数第二个调用中传递 index+1，而不是 ++index。

通常，将增量操作隐藏在函数调用参数中并不是好的编码习惯（至少在我看来）。它使阅读和调试代码变得困难。

# php - 使用 php 和整数值格式化 printf

> ID：11787413
> 
> 赞同：2
> 
> 时间：2012-08-02T23:47:37.653
> 
> 标签：php, printf

我试图使用 printf 进行格式化，但我意识到当我使用 时`%d`，我不能使用对齐`0`的填充说明符。`-`这是我正在尝试做的事情：

```
 $a = sprintf("%04d",5);
    $b = sprintf("%'1-4d",5); 
    $c = sprintf("%0-4d",5); 
    $d = sprintf("%0-4s",5); 

    var_dump($a);//outputs 0005

    var_dump($b);//outputs 5111

    var_dump($c);//outputs 5(and 4 spaces) why not 5000?

    var_dump($d);//outputs 5000 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:04:51.070

我认为 PHP 正在尝试为您考虑。

`5`如果你用四个字符右填充`0`，你怎么能分辨出和之间的区别`50000`？或者在`5`右边填充四个`0`字符和`50`右边填充三个`0`字符之间？

我没有方便测试的 PHP，但是如果您尝试使用该格式`"%'0-4d"`来说服它执行您想要的操作怎么办？

# node.js - 可以通过 for 循环使用 express.js 创建许多 app.get 调用吗？

> ID：11787416
> 
> 赞同：2
> 
> 时间：2012-08-02T23:48:18.277
> 
> 标签：node.js, express

这是我的第一篇文章，所以提前感谢您的帮助:)

我正在尝试制作我的 main.js 文件并使事情变得更容易，我想做这样的事情：

```
var pages = {
"/profile":{"page":"My Profile","loc":"./contentPages/profile"},
...
...
...
};

for (var item in pages) {
    app.get(item, function(req, res){
        if(req.session.user_id == null){
            res.redirect('/');
            return;
        }

        res.render(pages[item].loc, {
        title:pages[item].page,
        thisPage:pages[item].page
        });
    });
} 
```

现在无论发生什么，我在字典中的最后一个都是始终呈现的页面。有没有办法做这样的事情，或者我必须写出我想要创建的每个页面？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T04:10:18.557

问题是所有通过`function(req, res)`引用同一个变量（`item`）创建的闭包，所以它们都使用调用它们时的任何值，而不是创建它们时的值，这将是最后一个。

最直接的解决方法是使用辅助函数创建闭包：

```
function makeHandler(item) {
  return function(req, res) {
     // copy body of handler function here
  };
} 
```

然后将循环体替换为：

```
app.get(item, makeHandler(item)); 
```

现在每个处理程序都有自己的私有副本，`item`该副本始终保留其创建时的值。

您还可以使用立即函数调用来创建闭包，但这会使代码看起来更加混乱。

# c# - 为 EF 实体创建 Id 生成基类的正确方法

> ID：11787418
> 
> 赞同：0
> 
> 时间：2012-08-02T23:48:43.143
> 
> 标签：c#, entity-framework, inheritance, ef-code-first

我想为我的实体实现一个基类，所以我不必在每个实体中定义一个 Guid Id 字段。我创建了以下基类：

```
public abstract class IdableEntity
    {
        [Key]
        public Guid Id { get; set; }

        protected IdableEntity()
        {
            Id = Guid.NewGuid();
        }
    } 
```

这样做是因为据我所知，在这种情况下我只能使用 [DatabaseGenerated...] 属性，因为我必须转到数据库并更改所有表的 ID 字段才能将 (newid()) 调用作为“初始化器”。如果一个人有很多实体类——因此有很多表，这是非常不方便的。

但是现在，我将不得不通过调用每个子类中的基本构造函数来清除构造函数，对吗？如果是这样，它甚至值得吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:54:56.613

如果您按原样使用代码，您需要做的就是：

```
public class ChildEntity : IdableEntity
{
    // ...
} 
```

当您创建 ChildEntity 类的实例时，将自动调用受保护的基本 IdableEntity 构造函数，因为它不带参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:54:56.987

解决问题的另一种方法是使用代码自动遍历所有表并设置默认约束。其他人已经在这里回答了如何做到这一点：[SQL Server - 向所有表添加默认约束](https://stackoverflow.com/questions/4481397/sql-server-add-default-constraints-to-all-tables)

# java - 在 java 中解析“伪”XML（即格式不正确）？

> ID：11787424
> 
> 赞同：0
> 
> 时间：2012-08-02T23:49:08.397
> 
> 标签：java, xml

我有一些看起来像这样的 xml：

```
<xml><name>oscar</name><race>puppet</race><class>grouch</class></xml> 
```

标签会发生变化并且是可变的，因此不会总是有“名称”标签。

我已经尝试了 3 或 4 次解析，但它们似乎都被它扼住了。有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T23:54:52.670

这*是*有效的 xml；尝试添加允许可选元素的 XML 模式。如果您可以编写 xml 模式，则可以使用[JAXB](http://www.oracle.com/technetwork/articles/javase/index-140168.html)对其进行解析。XML 允许有可选元素；它并不太“严格”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:59:29.907

仅仅因为它没有定义的[schema](http://en.wikipedia.org/wiki/XML_schema)，并不意味着它不是“有效的” XML - 您的示例 XML*是*“格式正确的”。

[dom4j 库](http://dom4j.sourceforge.net/dom4j-1.6.1/)将为您完成。一旦解析（您的 XML 将解析 OK），您就可以遍历子元素，无论它们的标签名称是什么，并使用您的数据。

以下是如何使用它的示例：

```
import org.dom4j.*;

String text = "<xml><name>oscar</name><race>puppet</race><class>grouch</class></xml>";
Document document = DocumentHelper.parseText(text);
Element root = document.getRootElement();

for ( Iterator i = root.elementIterator(); i.hasNext(); ) {
    Element element = (Element) i.next();
    String tagName = element.getQName();
    String contents = element.getText();
    // do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T09:07:41.700

您的 XML 样本是格式良好的 XML，如果有任何东西“阻塞”它，那么我们可以准确地知道“阻塞”的症状是什么。

# objective-c - Objective C 播放视频

> ID：11787426
> 
> 赞同：0
> 
> 时间：2012-08-02T23:49:17.257
> 
> 标签：objective-c

这是我的实现文件：

```
-(IBAction)playvideo {

NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle]
                                     pathForResource:@"Intro" ofType:@"mp4"]];

MPMoviePlayerViewController *playercontroller = [[MPMoviePlayerViewController alloc] 
                                                 initWithContentURL:url];

[self presentMoviePlayerViewControllerAnimated:playercontroller];

playercontroller.moviePlayer.movieSourceType = MPMovieSourceTypeFile;

[playercontroller.moviePlayer play];

playercontroller = nil;

} 
```

这是一个奇怪的错误：

```
2012-08-03 01:48:40.085 Assaultive[5569:16a03] An instance 0x9b5ad50 of class AVPlayerItem was deallocated while key value observers were still registered with it. Observation info was leaked, and may even become mistakenly attached to some other object. Set a breakpoint on NSKVODeallocateBreak to stop here in the debugger. Here's the current observation info:
<NSKeyValueObservationInfo 0x8549f10> (
<NSKeyValueObservance 0x9b5cde0: Observer: 0x9b58690, Key path: nonForcedSubtitleDisplayEnabled, Options: <New: YES, Old: NO, Prior: NO> Context: 0x0, Property: 0x9b5ce60>
<NSKeyValueObservance 0x9b5cfa0: Observer: 0x9b54b90, Key path: presentationSize, Options: <New: NO, Old: NO, Prior: NO> Context: 0x0, Property: 0x9957780>
) 
```

它加载播放器视图并直接关闭子播放器视图。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:01:25.770

阅读错误。在您的代码（或苹果代码）的某处，有一个 KVO Observer 未被删除。我不认为你可以设置`playercontroller`为 nil 并期望它保留自己。尝试坚持对它的引用并成为它的代表。

# perl - mytop 安装和 term::readkey

> ID：11787429
> 
> 赞同：0
> 
> 时间：2012-08-02T23:49:44.573
> 
> 标签：perl, rpm

```
[host]# rpm -Uvh mytop-1.6-4.el5.noarch.rpm 
error: Failed dependencies:
        perl(Term::ReadKey) >= 2.1 is needed by mytop-1.6-4.el5.noarch
[host]# ./perlmodver Term::ReadKey
Term::ReadKey: 2.30 
```

当这个 perl 模块版本大于 2.1 时，为什么 rpm 无法安装 mytop？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:00:43.603

因为您从 CPAN 安装了 Term::ReadKey，而这些文件未在 RPM 数据库中注册。

补救措施，安装 perl-TermReadKey 包：

```
# yum install perl-TermReadKey 
```

让包管理器工具为您解决 RPM 依赖关系：[http ://www.centos.org/docs/5/html/yum/](http://www.centos.org/docs/5/html/yum/)

# image - 使用 Migrate 2.4 将 Wordpress 图像迁移到 Drupal

> ID：11787437
> 
> 赞同：1
> 
> 时间：2012-08-02T23:50:36.997
> 
> 标签：image, wordpress, drupal, migrate

我正在使用 Migrate 2.4 模块将图像从 Wordpress 迁移到 Drupal。这是我的映射：

```
$this->addFieldMapping('field_image','images');
$this->addFieldMapping('destination_file', 'images');
$this->addFieldMapping('field_image:source_dir')
 ->defaultValue('/Users/grafa/htdocs/wordpress/wp-content/uploads');
$this->addFieldMapping('field_image:file_class')
  ->defaultValue('MigrateFileUri'); 
```

图像来自查询 wp_postmeta 表的函数，然后将结果返回给 prepareRow() 函数。

```
function getImages($row) {
$post_id = $row->id;
$results = db_query("
  SELECT pm.post_id, pm.meta_key, pm.meta_value FROM streetroots_wp.wp_postmeta AS pm LEFT JOIN streetroots_wp.wp_posts AS p ON pm.post_id=p.id WHERE p.post_parent = $post_id AND pm.meta_key='_wp_attached_file';");

$images = array();
foreach($results as $result) {
  $images[] = $result->meta_value;
}
return !empty($images) ? $images : NULL;
} 
```

这基本上从 wp_postmeta 表中返回图像名称和相对路径，例如“2012/05/figure1.jpg”。然后我像这样使用 prepareRow() ：

```
 function prepareRow($row) {
$row->images = $this->getImages($row);
} 
```

我猜我使用处理文件字段的新迁移模块的方式有些奇怪。sql 正确输出文件名，但图像似乎没有被复制。这是使用 Migrate 2.4 的 Drupal 7。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T12:21:47.653

您可能想查看 migrate_example 文件夹中的 beer.inc 行 377 - 383 以及关联的内容类型 *migrate_example_beer*，其中定义了图像字段而不是文件字段，这是我的错误并导致我的图像未被填充.

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:47:54.103

Migrate 2.5 大大简化了文件的处理，您应该检查一下！

# sql-server-2008 - SQL Server 2008（兼容级别 90）中的备份数据库恢复到 2005

> ID：11787438
> 
> 赞同：1
> 
> 时间：2012-08-02T23:50:38.553
> 
> 标签：sql-server-2008, sql-server-2005, backup, restore

我有一个来自 SQL Server 2005 的客户端提供的数据库。当我在 SQL Server 2008 R2 上恢复它时，我确保将兼容性级别设置为 90。

现在我需要备份它并把它还给他们，他们会得到可怕的格式错误的标题错误。

我知道我以前做过这个，但不记得需要做什么才能让它工作。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:00:30.843

好的，我猜它无法完成并且与兼容性级别无关。

我将使用脚本。

# xml - xml文件中看不到超链接

> ID：11787440
> 
> 赞同：0
> 
> 时间：2012-08-02T23:51:00.237
> 
> 标签：xml, xml-parsing

我的简单 xml 文档中有以下代码

```
<?xml version="1.0"?>
<sample>
<link xml:link="simple" href="http://www.google.com"> Google page </link>
</sample> 
```

但这只是在浏览器中显示为标签，无论它是什么浏览器

这是我的浏览器上显示的内容：

```
<sample><link xml:link="simple" href="http://www.google.com"> Google page </link></sample> 
```

请让我知道为什么超链接没有出现在浏览器上而不是标签上。我尝试了很多选择，但似乎我在这里错过了一些非常基本的东西谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T05:28:10.093

您不能使用 HTML 类型的行为打开 XML 文件。为此，您需要使用 XSLT 将 XML 文件转换为 HTML 文件。以下代码快照将帮助您使用 XSLT 将 XML 文件转换为 HTML 文件：

应用以下 XSLT：

```
<?xml version="1.0" encoding="iso-8859-1"?>

<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns="http://www.w3.org/TR/REC-html40">

  <xsl:output method="html"/>

  <xsl:template match="/">
    <HTML>
      <HEAD>
        <TITLE>Sample HTML</TITLE>
      </HEAD>
      <BODY>
        <xsl:apply-templates/>
      </BODY>
    </HTML>
  </xsl:template>

  <xsl:template match="sample/link">
    <A TARGET="_blank">
      <xsl:attribute name="HREF">
        <xsl:value-of select="@href"/>
      </xsl:attribute>
      <xsl:apply-templates/>
    </A>
  </xsl:template> 
```

XML文件是这样的：

```
<sample>
  <link xml:link="simple" href="http://www.google.com"> Google page </link>
</sample> 
```

将 XML 文件转换为 .HTML 文件的 C# 函数是：

```
public void transformToHtml()
    {
        XslCompiledTransform transform = new XslCompiledTransform();
        transform.Load("html.xslt");
        transform.Transform("htmlArtical.xml", "toHTML.html");
    } 
```

输出的 .HTML 文件是这样的：

```
<HTML xmlns="http://www.w3.org/TR/REC-html40">
<HEAD>
<TITLE>Sample HTML</TITLE>
</HEAD>
<BODY>
<A TARGET="_blank" HREF="http://www.google.com"> Google page </A>
</BODY>
</HTML> 
```

在浏览器中打开此 .HTML 文件，您将获得“Google 页面”文本上的链接。

我希望这能帮到您。

# wcf - 限制对区域的 WCF 服务调用

> ID：11787443
> 
> 赞同：0
> 
> 时间：2012-08-02T23:51:16.413
> 
> 标签：wcf, web-services, security, web, soa

我工作的公司没有很好的基础设施，它被视为一个大网络，没有网络隔离。因此，在开发应用程序时，我们有一个 TEST/UAT/PROD/DR 设置。我一直在开发一套已部署在上述所有地区的服务。我如何确保开发人员不会意外调用生产 Web 服务？反正有没有通过调用者限制服务（即：服务器名称？）。

顺便说一句，所有这些服务都是内部的，而不是外部可用的。

再次感谢你的帮助。

乔什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T09:09:20.523

您可以使用基于角色的授权

[基于 WCF 的服务中的授权](http://msdn.microsoft.com/en-us/magazine/cc948343.aspx)

# c# - 在 C# 中使用 maskedtextctrl 作为 IP 地址

> ID：11787446
> 
> 赞同：2
> 
> 时间：2012-08-02T23:52:02.047
> 
> 标签：c#, winforms, mask

全部，
我有一个非常简单的带有 C#.NET 的 WinForms 应用程序。
在那里我需要输入 IP 地址的控件，所以我使用了 MaskedTextCtrl。
这个控件需要有一个默认值localhost，即程序启动时该值应该在那里，所以我使用控件的“Text”属性。

我将掩码设置为“999.999.999.999”，将文本设置为“127.0.0.1”，它转换为“127001”，它在 GUI 设计器和程序启动时显示不正确。

我该怎么做才能让它发挥作用？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:16:34.387

我最终使用带有验证的文本控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T00:35:56.270

我听从了你的评论：

> 这不是重复的。它正在谈论用户输入IP地址。我所说的是预先填充和显示的 IP 地址。事实上，我认为“MaskedTextBox”不适合那个。你能证明别的吗？

但是[副本](https://stackoverflow.com/questions/7924000/ip-address-in-a-maskedtextbox)是用代码和 UI 来问同样的事情。

![在此处输入图像描述](../Images/fb1089d3fd6805a314ac2238adc73654.png)

*编辑：在发表评论之前，我确实搜索了一个控件，Telerik 似乎有一些类似的[东西](https://www.google.com.au/search?q=Telerik+masked+textbox+ipaddress&sugexp=chrome,mod=12&sourceid=chrome&ie=UTF-8)。我也看到了一些问题*

# jquery - 如果未选中所有复选框，则警告用户

> ID：11787455
> 
> 赞同：8
> 
> 时间：2012-08-02T23:53:29.930
> 
> 标签：jquery, jquery-selectors, javascript

我有一个带有一系列复选框的表单。如果未选中所有复选框，我想在用户点击提交后警告用户。我正在使用以下代码报告复选框的所有值：

```
$('[id^=leg_rider]').filter(':checked'); 
```

这似乎有效。但是，当我尝试检查返回的对象是否为空时，它似乎不起作用。这就是我正在尝试的：

```
 $("#set_pref_submit").click(function() {
        var legchecked = $('[id^=leg_rider]').filter(':checked');
        if (!legchecked){ alert("no riders")};
    }); 
```

任何建议表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-02T23:56:24.740

您可以使用 jQuery 对象的[`length`](http://api.jquery.com/length/)属性：

```
$("#set_pref_submit").click(function() {
    var legchecked = $('input[id^=leg_rider]:checked').length;
    if (legchecked){ alert("no riders")};
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-02T23:56:16.030

**工作演示**：http: [//jsfiddle.net/MrkfW/](http://jsfiddle.net/MrkfW/)

试试这个：也使用 .change api，这样它就可以跟踪`:)`

接口：[http ://api.jquery.com/change/](http://api.jquery.com/change/)

```
$("input[type='checkbox'][id^=leg_rider]").change(function(){
    var a = $("input[type='checkbox'][id^=leg_rider]");
    if(a.length == a.filter(":checked").length){
        alert('all checked');
    } else {
        alert('not all checked');
    }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T00:11:29.410

试试这个：

我的html：

```
<input id="chkbx_0" type="checkbox" class="checkbox" name="c_n_0" checked="checked" />Option 1
<br/><input id="chkbx_1" type="checkbox" class="checkbox" name="c_n_1" />Option 2
<br/><input id="chkbx_2" type="checkbox" class="checkbox" name="c_n_2" />Option 3
<br/><input id="chkbx_3" type="checkbox" class="checkbox" name="c_n_3" checked="checked" />Option 4
<br/><br/>
<input type="button" value="Click me" class="testall"/>​ 
```

我的 jQuery 代码：

```
jQuery(".testall").click(function () {
    if (jQuery(".checkbox:checked").length == 0) { alert("no riders"); }
}); 
```

现场示例：http: [//jsfiddle.net/webwarrior/NJwv4/9/](http://jsfiddle.net/webwarrior/NJwv4/9/)

这将使您可以选择仅选中某些复选框。

hth，肖恩

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T23:56:01.793

```
if (legchecked.size() == 0){ alert("no riders")}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T23:59:03.220

在线上

```
if (!legchecked){ alert("no riders")}; 
```

您实际上是在检查对象的存在，而不是检查对象是否为空。由于您使用的是 jQuery，因此您可以使用 .isEmptyObject() 函数来检查对象是否为空。

```
if($.isEmptyObject(legchecked)) {alert ("no riders")}; 
```

# opencv - 使用 NSIS 创建 OpenCV 安装程序

> ID：11787458
> 
> 赞同：2
> 
> 时间：2012-08-02T23:53:55.113
> 
> 标签：opencv, installation, inno-setup, nsis, cpack

我正在为我们的项目使用特定的构建选项（例如 64 位、QT 和 OpenNI）编译 OpenCV。我能够按照此处给出的说明进行操作：http: [//opencv.itseez.com/doc/tutorials/introduction/windows_install/windows_install.html](http://opencv.itseez.com/doc/tutorials/introduction/windows_install/windows_install.html)

在 2-3 小时的构建过程结束时，我最终`\install\build\`在各自的文件夹中收集了 bin、dll 和 lib。我想将 .exe 安装程序分发给研究组的其他成员。但我不能，因为`_CPack_Packages/win32/NSIS`无处可寻。

> 注意：要创建安装程序，您需要安装 NSIS。然后只需构建 Package 项目以将安装程序构建到 `Build/_CPack_Packages/win32/NSIS`文件夹中。然后，您可以使用它在其他系统上分发带有构建设置的 OpenCV。

在 cmake-gui 屏幕中，我勾选了“Build Package”，希望它能让我看到`Build/_CPack_Packages/win32/NSIS`文件夹。在构建过程之后，找不到这个。

有人可以提出建议，说明为什么我没有看到`_CPack_Packages/win32/NSIS`描述的这个文件夹吗？我可以改用 [Inno 设置](http://www.jrsoftware.org/isinfo.php)吗？如果是这样，我是否只需打包所有`\build\install`文件夹并在系统中设置路径以包含`\build\install\bin`？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T14:08:54.650

坚持 KISS 原则（保持简单，愚蠢！）：

*您是否在构建Package*项目之前安装了 NSIS ？

```
INSTRUCTIONS TO BUILD WIN32 PACKAGES WITH CMAKE+CPACK
------------------------------------------------------

- Install NSIS.
- Generate OpenCV solutions for MSVC using CMake as usual.
- In cmake-gui: 
    - Mark BUILD_PACKAGE
    - Mark BUILD_EXAMPLES (If examples are desired to be shipped as binaries...)
    - Unmark ENABLE_OPENMP, since this feature seems to have some issues yet...
- Mark INSTALL_*_EXAMPLES
- Open the OpenCV solution and build ALL in Debug and Release.
- Build PACKAGE, from the Release configuration. An NSIS installer package will be 
  created with both release and debug LIBs and DLLs.

Jose Luis Blanco, 2009/JUL/29 
```

我建议不要使用 Visual Studio 来构建，而应该尝试使用 CMake。

[http://www.cmake.org/](http://www.cmake.org/)

让我知道这是否有帮助。

# jquery - 谷歌地图叠加成pdf

> ID：11787465
> 
> 赞同：0
> 
> 时间：2012-08-02T23:54:55.817
> 
> 标签：jquery, asp.net-mvc-3, google-maps, pdf, pdf-generation

我目前的项目是使用带有叠加层的谷歌地图。我需要能够将此地图转换为 pdf。我目前能想到的唯一方法是在应用叠加层后制作地图图像。我知道这不是最好的问题类型，因为它不是代码 q 和 a。

有没有更好的方法将地图/叠加层转换为 pdf？

如果这是最好的方法，我应该怎么做（创建图像）？

我不是要求编写代码，只是要求最好的方式或达到最终目标的一些指针。

我也在使用 javascript/jquery 在后端处理 gmaps 和 MVC3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T07:58:25.277

您需要获得 Google 的许可才能执行此操作。看：

[https://developers.google.com/maps/faq#tos_screenshots](https://developers.google.com/maps/faq#tos_screenshots)

除此之外，javascript 无法访问文件系统来保存 pdf，因此您需要使用相关地图信息向服务器发送 AJAX 调用并创建 pdf 服务器端。

# java - Java 服务器 SSL 套接字和 Python 客户端 SSL 套接字 - 服务器发送消息时的问题

> ID：11787467
> 
> 赞同：1
> 
> 时间：2012-08-02T23:55:08.080
> 
> 标签：java, python, ssl, client

我正在尝试通信服务器 SSL 套接字 Java 和客户端 SSL 套接字 Python。发送的第一条消息是可以的，但是当服务器发送另一条消息时，客户端会收到分成两部分的消息。例如：如果服务器发送消息“abcdefghij”，客户端首先收到“a”，然后是“bcdefghij”。

有人知道为什么在第一次收到消息后分为两部分？问候。

客户端代码：

```
import socket, ssl, pprint
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
ssl_sock = ssl.wrap_socket(s, ssl_version=ssl.PROTOCOL_TLSv1, cert_reqs=ssl.CERT_NONE)
ssl_sock.connect(('localhost', 7000))
pprint.pprint(ssl_sock.getpeercert())

while(1):
    print "Waiting"
    data = ssl_sock.recv()  
    print "Received:", data
    data = ""

ssl_sock.close() 
```

服务器代码：

```
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.security.KeyStore;

import javax.net.ssl.KeyManagerFactory;
import javax.net.ssl.SSLContext;
import javax.net.ssl.SSLServerSocket;
import javax.net.ssl.SSLServerSocketFactory;
import javax.net.ssl.SSLSession;
import javax.net.ssl.SSLSocket;

public class SslReverseEchoer {

    public static void main(String[] args) {
        char ksPass[] = "123456".toCharArray();
        char ctPass[] = "123456".toCharArray();

        try {
            KeyStore ks = KeyStore.getInstance("JKS");
            ks.load(new FileInputStream("keystore.jks"), ksPass);
            KeyManagerFactory kmf = KeyManagerFactory.getInstance("SunX509");
            kmf.init(ks, ctPass);
            SSLContext sc = SSLContext.getInstance("TLS");
            sc.init(kmf.getKeyManagers(), null, null);
            SSLServerSocketFactory ssf = sc.getServerSocketFactory();
            SSLServerSocket s = (SSLServerSocket) ssf.createServerSocket(7000);
            printServerSocketInfo(s);
            SSLSocket c = (SSLSocket) s.accept();
            printSocketInfo(c);
            BufferedWriter w = new BufferedWriter(new OutputStreamWriter(c.getOutputStream()));
            BufferedReader r = new BufferedReader(new InputStreamReader(c.getInputStream()));
            //1th time
            String m = "abcdefghj1234567890";
            w.write(m, 0, m.length());
            w.newLine();
            w.flush();
            //2th time
            String m2 = "#abcdefghj1234567890";
            w.write(m2, 0, m2.length());
            w.newLine();
            w.flush();
            //3th time
            String m3 = "?abcdefghj1234567890";
            w.write(m3, 0, m3.length());
            w.newLine();
            w.flush();
            while ((m = r.readLine()) != null) {
                if (m.equals("."))
                    break;
                char[] a = m.toCharArray();
                int n = a.length;
                for (int i = 0; i < n / 2; i++) {
                    char t = a[i];
                    a[i] = a[n - 1 - i];
                    a[n - i - 1] = t;
                }
                w.write(a, 0, n);
                w.newLine();
                w.flush();
            }
            w.close();
            r.close();
            c.close();
            s.close();
        } catch (Exception e) {
            System.err.println(e.toString());
        }
    }

    private static void printSocketInfo(SSLSocket s) {
        System.out.println("Socket class: " + s.getClass());
        System.out.println("   Remote address = " + s.getInetAddress().toString());
        System.out.println("   Remote port = " + s.getPort());
        System.out.println("   Local socket address = " + s.getLocalSocketAddress().toString());
        System.out.println("   Local address = " + s.getLocalAddress().toString());
        System.out.println("   Local port = " + s.getLocalPort());
        System.out.println("   Need client authentication = " + s.getNeedClientAuth());
        SSLSession ss = s.getSession();
        System.out.println("   Cipher suite = " + ss.getCipherSuite());
        System.out.println("   Protocol = " + ss.getProtocol());
    }

    private static void printServerSocketInfo(SSLServerSocket s) {
        System.out.println("Server socket class: " + s.getClass());
        System.out.println("   Socker address = " + s.getInetAddress().toString());
        System.out.println("   Socker port = " + s.getLocalPort());
        System.out.println("   Need client authentication = " + s.getNeedClientAuth());
        System.out.println("   Want client authentication = " + s.getWantClientAuth());
        System.out.println("   Use client mode = " + s.getUseClientMode());
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:19:20.600

似乎您希望始终能够从另一侧读取您在一个块中发送的任何数量的数据。

这是一个常见错误，并非特定于 SSL/TLS，也与普通 TCP 通信有关。

您应该始终循环并阅读您打算阅读的任何内容。您还应该定义您的协议（或使用现有协议）以考虑命令和请求/响应终止符。

例如，HTTP 使用空行来告诉标头的结尾，而标`Content-Length`头或分块传输编码来告诉接收者何时停止读取正文。

SMTP 使用以行分隔的命令和一个`.`用于消息结尾的命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T00:07:33.800

它是服务器端的 Naggle 算法和客户端 TCP 堆栈中的延迟 ACK 的组合。您还会发现两个数据包之间的延迟约为 40 毫秒。

在服务器端禁用 Naggle 算法以进行补救：

```
SSLSocket c = (SSLSocket) s.accept();
c.setTcpNoDelay(true); 
```

关于为什么会在这里发生的更多信息：http: [//www.stuartcheshire.org/papers/NagleDelayedAck/](http://www.stuartcheshire.org/papers/NagleDelayedAck/)

**编辑添加：**注意下面布鲁诺的回答。虽然这描述了您在此处看到的具体原因，但不能保证您期望来自服务器的数据的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T01:23:46.477

我尝试通过两种方式解决我的问题，消息总是在第一个字符处中断，所以我决定在每条消息的开头和结尾添加三个空格。因此，当客户收到它们时，请对消息进行修剪。我发现的另一种方法是使用 DataOutputStream，该方法逐字节传递 writeBytes，在服务器上使用它，客户端在接收数据时发生 q 变化，消息必须构建客户端处理才能最终完成我想要的内容消息的结尾。感谢您的讨论！

# exec - java.io.IOException：无法运行程序错误=2，没有这样的文件或目录

> ID：11787479
> 
> 赞同：9
> 
> 时间：2012-08-02T23:56:30.517
> 
> 标签：exec, csh

我有一个 java 类，我在其中调用一个 runshellscript 方法来执行脚本。它适用于 mysql，但我似乎无法找出为什么它不适用于 psql。这是我的 runshell 方法的摘录：

```
public class RunShellScript {

public static void runShellScript (String unixCommand) 
{
 try {
     Runtime runtime=Runtime.getRuntime();
     //Process process=runtime.exec(new String [] { "/bin/csh", "-c", unixCommand});
     Process process=runtime.exec(new String [] {unixCommand});
     InputStream stderr=process.getErrorStream();
     InputStreamReader isr=new InputStreamReader (stderr);
     BufferedReader br=new BufferedReader (isr);
     String line=null;
     System.out.println("<ERROR>");

     while((line=br.readLine())!=null)
         System.out.println(line);

     System.out.println(line);
     int exitVal=process.waitFor();
     System.out.println("Process exitValue:" + exitVal);
 }
 catch (Throwable t)
 {
     t.printStackTrace();
 } 
```

问题是当我把它放在鼠标点击事件后面时，它说找不到命令。这是mous事件的代码

```
private void jMenuItem13MousePressed(java.awt.event.MouseEvent evt)    {                                         

    String shellCommand="vobs/tools/Scripts/DataValidation/mysqlconnection.csh";
    RunShellScript.runShellScript(shellCommand);
    // TODO add your handling code here:
} 
```

奇怪的是，当我直接进入脚本所在的目录并键入 ./mysqlconnection 时，脚本可以工作。但是当我只输入 mysqlconnection 时说找不到命令。不知何故，它没有将我的脚本名称识别为命令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-03-24T12:53:00.783

看起来它类似于我面临的问题，当从 autosys [autosys -> shell -> Java -> ProcessBuilder] 调用 shell 脚本（包含系统和用户创建的命令）时，将从
`ProcessBuilder`命令中执行并在 Linux 机器中执行。
这在我登录 Linux 机器并执行脚本时有效，但是当我从 autosys 调用时它不起作用。
实际问题是`$PATH`可变的，它不是用用户创建的命令的目录设置的。
我在 shell 脚本中从 Linux 机器和 Autosys 执行时回显 $PATH 变量，从 Autosys 执行时 $PATH 变量未正确设置，在将用户命令路径附加到它起作用的 $PATH 变量之后。
`which (cmd)`将返回命令的目录，将此目录附加到 $PATH 然后它将起作用。

尝试将您的脚本路径添加到 $PATH 并从您的应用程序执行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:03:07.673

在类 unix 系统上，如果给定一个明确的路径，shell 只会执行驻留在当前目录中的程序。这是为了防止攻击者将一个名为的程序`ls`放在您的主目录中，该程序将执行而不是`ls`驻留在`/bin/ls`. 因此，当前目录被排除在 PATH 之外。

另外，尝试移动

```
int exitVal=process.waitFor(); 
```

到`while`循环上方。

# git - 撤消 Git 跟踪命令

> ID：11787482
> 
> 赞同：3
> 
> 时间：2012-08-02T23:56:54.853
> 
> 标签：git, branch

我试图跟踪一个远程分支并最终执行了以下操作：

```
$ git branch --track origin/branch1
Branch origin/branch1 set up to track local branch branch1. 
```

这显然不是我打算做的。我将如何撤消此设置？我尝试自己纠正它：

```
$ git branch --track origin branch1
error: there are still refs under 'refs/heads/origin'
fatal: Failed to lock ref for update: Is a directory
$ git branch --track branch1 origin/branch1
fatal: A branch named 'branch1' already exists.
$ git branch --no-track origin/branch1
fatal: A branch named 'origin/branch1' already exists. 
```

……无济于事。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T23:59:53.453

只需删除分支。

```
git branch -d origin/branch1 
```

# jsf - 数据表 例外

> ID：11787483
> 
> 赞同：0
> 
> 时间：2012-08-02T23:57:12.930
> 
> 标签：jsf, jsf-2, primefaces

尝试做一些简单的 primefaces 数据表 ajax 工作并得到以下异常：

javax.servlet.ServletException：/default.xhtml @17,76 父级不是 ClientBehaviorHolder 的实例：org.primefaces.component.datatable.DataTable@5fdb7adc

我正在使用 primefaces 3.3.1。我的 .xhtml 代码在这里（我从 primefaces 网站复制了一些代码，看看我能不能让它工作），有人有什么想法吗？

```
 <html xmlns="http://www.w3c.org/1999/xhtml"
 xmlns:f="http://java.sun.com/jsf/core"
 xmlns:h="http://java.sun.com/jsf/html"
 xmlns:p="http://primefaces.org/ui" >    

 <h:head>

 </h:head>
 <h:body>
 <center>
 <h:form id="form">

 <p:dataTable id="personTable" var="client" value="#{tableBean.persons}" 
             selection="#{tableBean.person}" selectionMode="single">

            <p:ajax event="rowSelect" listener="#{tableBean.onUserSelect}"   
                update=":form:displayf" oncomplete="carDialog.show()" />  

            <p:ajax event="rowUnselect" 
                listener="#{tableBean.onUserUnselect}" 
                update=":form:displayf" />

    <f:facet name="header">
        Click "View" button after selecting a row to see details
    </f:facet>

    <p:column headerText="Name">
        #{client.name}
    </p:column>

    <p:column headerText="Address">
        #{client.address}
    </p:column>

    <p:column headerText="Phone" >
        #{client.phone}
    </p:column>
</p:dataTable>

<p:dialog id="dialog" header="Car Detail" widgetVar="carDialog" resizable="false"  
            showEffect="explode" hideEffect="explode">  

<h:panelGrid id="displayf" columns="2" cellpadding="4">

        <h:outputText value="Name:" />
        <h:outputText value="#{tableBean.person.name}" />

        <h:outputText value="Address:" />
        <h:outputText value="#{tableBean.person.address}" />

        <h:outputText value="Phone:" />
        <h:outputText value="#{tableBean.person.phone}" />

</h:panelGrid>
</p:dialog>

</h:form>

</center>
</h:body>
</html> 
```

# repository - 邮政编码/地址存储库

> ID：11787488
> 
> 赞同：1
> 
> 时间：2012-08-02T23:57:52.240
> 
> 标签：repository, metadata, street-address, zipcode, country-codes

我在哪里可以找到邮政编码/地址或国家/地区存储库？我需要它来与我现有的数据进行一些比较。有没有免费的或者你有任何意见如何实现这一目标？

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T23:53:04.943

有一个很棒的服务有大量的免费数据。你可以在这里找到它：

基于邮政编码数据的 GEO 信息链接 [http://download.geonames.org/export/zip/](http://download.geonames.org/export/zip/)

家长链接：http: [//download.geonames.org/](http://download.geonames.org/)

# actionscript-3 - 为弹性单元测试重新创建一堆组件（flexunit）

> ID：11787489
> 
> 赞同：0
> 
> 时间：2012-08-02T23:58:02.373
> 
> 标签：actionscript-3, apache-flex, flexunit

我有一堆 NumericSteppers（开始周、开始年、结束周、结束年），它们深入 ViewStacks、NavigatorContents 等。我想对我的日期步进器进行单元测试，并且想知道我该怎么做？当我初始化顶级父组件时，不会创建子组件。我是否必须通过向下迭代树来手动添加所有这些组件（请说不:)）？我可以使用 UIImpersonator 吗？

对不起，如果问题是基本的，Flex 对我来说很新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:39:29.430

在 Flash 中，为 GUI 组件创建单元测试是有问题的。我通常为控制器、表示模型、中介（等）编写单元测试——即：包含业务逻辑的非 GUI 类。

为 GUI 对象编写测试成为一个失败的提议，原因有很多：

*   视图的逻辑往往需要由用户交互触发
*   视图可能取决于在测试中难以模拟/模拟的低级 Flash API（NetStream、Camera 等））
*   自动运行测试（即：由您的持续集成或构建系统启动）时，无法运行具有 GUI 元素（使用阶段或添加到阶段的东西）的测试
*   测试往往运行速度较慢

我通常避免为诸如日期步进器之类的组件编写单元测试，我们将它们组合在一起以形成更大的“视图”。我通常使用[表示模型](http://martinfowler.com/eaaDev/PresentationModel.html)，如果组件具有应测试的特定业务逻辑，则为非 gui 表示模型类（或控制器、中介或其他）编写测试。

```
public class MyViewPM
{
   // write a unit test for this method
   public function onSubmitButtonClick():void
   {
   }
}

public class MyView extends Sprite
{
    // this is injected by your MVC framework
    // or set when the the view is created, or added to stage, etc.
    public var pm:MyViewPM;

    public function MyView()
    {
        submitButton.addEventListener(MouseEvent.Click, onMouseClick);
    }

    private function onMouseClick(event:Event):void
    {
        pm.onSubmitButtonClick();
    }
} 
```

# c# - 如何在其他组合框值更改时动态更改组合框

> ID：11787493
> 
> 赞同：0
> 
> 时间：2012-08-02T23:58:58.387
> 
> 标签：c#, winforms, linq-to-sql, combobox

使用 linq to sql 模型运行项目，并将我的组合绑定到 bindingsource 控件，我有两个组合框，第一个显示一个显示数据库表名称（ID、TableName）的表，第二个应该绑定到第一个组合中的选定表，我试过这段代码：

```
 private void ComboBox1_TextChanged(object sender, EventArgs e)
    {
        if (ComboBox1.Text == "Customers")
        {
            var qry = (from u in dc.Customers
                       select u).ToList();
            comboBox2.ValueMember = "CustomerID";
            comboBox2.DisplayMember = "CompanyName";
            comboBox2.DataSource = qry;
        }
        if (ComboBox1.Text == "Suppliers")
        {
            var qry = (from u in dc.Suppliers
                       select u).ToList();
            comboBox2.ValueMember = "SupplierID";
            comboBox2.DisplayMember = "CompanyName";
            comboBox2.DataSource = qry;
        }
    } 
```

使用上面的代码，我可以显示第一个组合项，默认情况下我也可以显示第二个组合项，但是当我更改第一个组合内容时，comboBox2.ValueMember = "SupplierID"; : System.ArgumentException 未处理 Message=不可能链接到新的 Value 成员。请问如何将 combobox2.ValueMember 重置为新的字段名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:42:10.650

您只需要返回 ValueMember 和 DisplayMember 的列

```
var qry = (from u in dc.Suppliers
            select new { a.SupplierID, a.CompanyName}).ToList();
            comboBox2.ValueMember = "SupplierID";
            comboBox2.DisplayMember = "CompanyName";
            comboBox2.DataSource = qry; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T01:28:13.103

在更改其 ValueMember 之前，有必要初始化组合框属性，如下所示：

```
 **comboBox2.DataSource = null;**
        if (ComboBox1.Text == "Customers")
        {
            var qry = (from u in dc.Customers
                       select new { u.CustomerID, u.CompanyName }).ToList();
            comboBox2.ValueMember = "CustomerID";
            comboBox2.DisplayMember = "CompanyName";
            comboBox2.DataSource = qry;
        }
        if (ComboBox1.Text == "Suppliers")
        {
            var qry = (from u in dc.Suppliers
                       select new { u.SupplierID, u.CompanyName }).ToList();
            comboBox2.ValueMember = "SupplierID";
            comboBox2.DisplayMember = "CompanyName";
            comboBox2.DataSource = qry;
        } 
```

# html - 如何关闭图像表中的空间？

> ID：11787498
> 
> 赞同：0
> 
> 时间：2012-08-02T23:59:17.033
> 
> 标签：html

这是为了密集显示状态信息。最好我想让图像相互对接。多余的空白从何而来？

生成的表格元素如下所示：

```
<table>
<tr>
<td><small>anim-dept</small></td>
<td>
  <a href="http://foo/bar">
    <img height="24" width="32" src="http://foo/bar.jpg">
  </a>
</td>
.... 
```

![在此处输入图像描述](../Images/8ba03b8aba5357507abe1edb483eba96.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T00:13:16.103

在表格的css中使用`border-collapse:collapse`如下

```
table{
    border-collapse:collapse;
} 
```

或仅适用于具有 id 的特定表`images`

```
table#images{
    border-collapse:collapse;
} 
```

或者（如果你没有 CSS）

```
<table cellspacing="0"> 
```

**演示：** [**没有边框折叠**](http://jsfiddle.net/heera/Ate6D/1/)和[**边框折叠**](http://jsfiddle.net/heera/Ate6D)，[**没有 css 但单元格间距**](http://jsfiddle.net/heera/Ate6D/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T00:22:59.703

这可能不是最佳解决方案，但我可以通过添加以下内容来解决此问题：

```
tr {
    display:inline-block;
    height:24px;
} 
```

css`border-collapse: collapse`似乎只适用于列，行仍然有间距。将行设置为 inline-blocks 而不是 table-rows 似乎可以解决它，尽管正如我所说的那样，它可能不是最好的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T02:02:36.343

将`TABLE`'`CELLSPACING`和`CELLPADDING`设置为零。
请注意，您可能需要为第一个表格行单元格添加填充样式。

```
<table cellspacing="0" cellpadding="0">
<tr>
<td><small>anim-dept</small></td>
<td>
  <a href="http://foo/bar">
    <img height="24" width="32" src="http://foo/bar.jpg">
  </a>
</td>
.... 
```

# objective-c - 推送到上一个视图 ios 的后退按钮

> ID：11787505
> 
> 赞同：0
> 
> 时间：2012-08-03T00:00:00.590
> 
> 标签：objective-c, ios, xcode, uiview, uitabbar

我有一个“设置”类型的视图，我希望标签导航中的每个视图都可以访问它。我能够进入设置视图，但我如何编写一个按钮，让您回到将您带到那里的视图？例如，如果我从视图 1 访问设置视图，我希望后退按钮将您带回视图 1。然后，如果我从视图 2 访问它，我希望相同的后退按钮将您带回视图 2。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-03T00:02:49.150

您的视图在导航控制器中吗？如果是这样，请使用：

```
[self.navigationController popViewControllerAnimated:YES]; 
```

如果它是模态视图控制器，请使用：

```
[self dismissModalViewControllerAnimated:YES]; 
```

# javascript - 使用变量的值作为另一个变量的名称

> ID：11787506
> 
> 赞同：0
> 
> 时间：2012-08-03T00:00:21.893
> 
> 标签：javascript, string, node.js, variables

我有一个使用数组为不同事物设置名称的函数

```
var settings = {
    slug: "foo"
} 
```

现在，我想创建一个变量，名称是 的值`settings.slug`，在这种情况下`foo`

这显然不起作用：

```
var settings.slug = new Schema({
  title : String
, content   : String
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:04:45.130

```
this[settings.slug] = ... 
```

这应该有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T00:06:57.743

做到这一点的唯一方法是使用括号表示法并将其附加到现有对象。例如，您可以通过将其附加到`global`对象来使其成为全局变量：

```
global[settings.slug] = new Schema({
  title   : String
, content : String
});

global['foo'];  // your Schema object
foo;  // automatically will cascade to the global window variable global['foo'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T00:07:32.160

使用[括号表示法](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Member_Operators#Bracket_notation)：

```
someObj[settings.slug] = new Schema(...);

// equivalent to 
someObj["foo"] = ...
// or
someObj.foo = ... 
```

但是，您不应该设置`global`对象恕我直言的属性。如果您需要变量属性名称，请使用额外的命名空间对象，但在全局对象上，您冒着覆盖一些重要全局变量的风险。

# php - 使用变量时，MySQL查询不起作用在查询内部

> ID：11787507
> 
> 赞同：1
> 
> 时间：2012-08-03T00:00:24.000
> 
> 标签：php, sql, wordpress

我遇到了一个奇怪的问题，我的 MySQL 查询适用于除一个特定数据条目之外的所有情况。

这是我的查询：

```
SELECT * FROM wp_songs WHERE album_name = '{$current_album}' 
```

这个查询被输入到 Wordpress 的 $wpdb->get_results() 函数中。由于某种原因，它永远找不到这个特定的数据条目：“Raw & Uncut: The Mixtape”

但是，如果查询改为：

```
 SELECT * FROM wp_songs WHERE album_name = 'Raw & Uncut: The Mixtape' 
```

发现数据没有问题。

运行 $wpdb->last_query 函数在两种情况下都会返回完全相同的行。

该问题仅针对一个数据输入。我无法用其他数据条目复制问题。所有其他条目都适用于我的原始查询。

更多代码：

这不起作用：

```
 $current_album = "Raw & Uncut: The Mixtape";
 $songs = $wpdb->get_results("SELECT * FROM wp_songs WHERE album_name = '{$current_album}'")
if ( $songs ) { echo "Works"; } 
```

这有效：

```
 $songs = $wpdb->get_results("SELECT * FROM wp_songs WHERE album_name = 'Raw & Uncut: The Mixtape'");
  if ( $songs ) { echo "Works"; } 
```

同样，它仅适用于特定的数据输入。每个其他条目都适用于这两个查询。

运行 var_dump($current_album) 返回：

```
string(28) "Raw & Uncut: The Mixtape" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T00:57:45.070

您发布了 var_dumping $current 专辑的结果：

> string(28) “原始与未剪辑：混音带”

“Raw & Uncut: The Mixtape”只有 24 个字符 - 这告诉我你的变量实际上包含以下内容：

`Raw &amp; Uncut: The Mixtape`

这与您在数据库中的内容不匹配。您可以通过在专辑变量上运行 html_entity_decode() 来纠正它。

# javascript - 如何在两个div之间垂直居中div？jQuery？

> ID：11787509
> 
> 赞同：1
> 
> 时间：2012-08-03T00:00:26.130
> 
> 标签：javascript, jquery, html, center, vertical-alignment

我会说我很擅长 HTML 和 CSS，当我开始接触 JavaScript 时，我会感到很挣扎；我可以理解其中一些，但我无法为我的生活写下它！我正在努力学习，无论如何；我将这个 jQuery 脚本放在一起**，目标是在相对定位的顶部 div 和绝对定位的底部 div 之间垂直居中 div。**不适合我，哈哈。

因为我正在尝试学习如何使用 jQuery 并创建自己的脚本，所以我想尝试让它工作。但是，如果有更好的方法来实现我的目标，我也将非常感谢您以这种方式提供的意见！

```
<script type="text/javascript">
$(document).ready(function() {
$(window).ready(function(){
vertical_height()
});
$(window).resize(function(){
vertical_height()
});
function vertical_height(){
var doc_height = $(document).height();
var head_height = $(".headcontent").height();
var mid_height = $(".midcontent").height();
var foot_height = $(".footer").height();
var pos_height = Math.round(head_height+foot_height);
var neg_height = Math.round((head_height-foot_height)/2);
var fin_height = Math.round(doc_height-(pos_height-neg_height));
$('.midcontent').css({
"marginTop","-"+fin_height+"px",
"marginBottom","-"+fin_height+"px"
}
}
});
</script> 
```

**.headcontent**是顶部的 div。

**.midcontent**是我想要居中的中间 div。

**.footer**是底部的 div。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:39:21.037

这是你的代码，整理成可以运行的东西：

```
$(function() {
    function vertical_height() {
        var doc_height = $(document).height();
        var head_height = $(".headcontent").height();
        //var mid_height = $(".midcontent").height();//not used
        var foot_height = $(".footer").height();
        var pos_height = head_height + foot_height;
        var neg_height = (head_height - foot_height) / 2;
        var fin_height = doc_height - (pos_height - neg_height);
        $('.midcontent').css({
            "marginTop": "-" + fin_height + "px",
            "marginBottom": "-" + fin_height + "px"
        });
    }
    $(window).resize(vertical_height).trigger('resize');
}); 
```

现在您可以专注于让算法正确。

就目前而言，组合和简化表达式，我得到：

```
var fin_height = doc_height - head_height*3/2 - foot_height*3/2; 
```

这对我来说看起来不对，但我可能是错的。

## 编辑

为避免重叠，请尝试此版本：

```
var $$ = {}; //jQuery object cache.
$$.w = $(window);
$$.h = $(".headcontent");
$$.m = $(".midcontent");
$$.f = $(".footer");
function vertical_height() {
    var w = $$.w.height(),
        h = $$.h.outerHeight(true),
        m = $$.m.outerHeight(),
        f = $$.f.outerHeight(true),
        fin_height = Math.max(0, (w - h - m - f) / 2);
    $$.m.css('marginTop', Math.floor(fin_height)).css('marginBottom', Math.ceil(fin_height));
    $$.h.text(fin_height);
};
$(window).on('resize', vertical_height).trigger('resize'); 
```

**[演示](http://jsfiddle.net/nBUnt/25/)**

笔记

*   `position:absolute`从页脚的 CSS 中删除
*   现在缓存了 jQuery 对象，`$$`以减少调整大小处理程序的工作量。
*   现在计算基于窗口高度而不是文档高度。
*   现在测量的三个 div`.outerHeight(false)`包括垂直填充和边框。
*   防止重叠`Math.max(0, ...)`，确保鳍高度不会为负值。
*   该语句`$$.h.text(fin_height);`用于调试，可以删除。

## 编辑 2

以下代码将“消除”调整大小事件。

代替 ：

```
$(window).on('resize', vertical_height).trigger('resize'); 
```

和 ：

```
var do_resize;
$(window).on('resize', function(){
  clearTimeout(do_resize);
  do_resize = setTimeout(vertical_height, 100);
}).trigger('resize'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T00:17:17.930

计算时只是一个小提示，在得到最终数字之前不要四舍五入。

`h = Header Height`

`f = Footer Height`

`m = Middle Height`

`d = Document Height`

`s = Height of the space above or below the div`

这里我们假设文档的高度等于所有其他元素组合的高度。由于中间 div 的上方和下方有一个相等的空格，因此我们有两个空格。

`d = h + f + m + 2s`

`d - h - m -f = 2s`

`(d - h - m - f) / 2 = s`

让我们把它放到一些 javascript 中

```
$(document).ready(function() {

    $(window).resize(vertical_height());

function vertical_height() {
    var doc_height = $(document).height();
    var head_height = $(".headcontent").height();
    var mid_height = $(".midcontent").height();
    var foot_height = $(".footer").height();
    var fin_height = Math.round((doc_height - head_height - mid_height - foot_height) / 2);
    $('.midcontent').css("margin-top", fin_height)
  }
}); 
```

对于 css，我们只需要添加一个上边距，因为这会将其推离页眉，因为我假设绝对定位的页脚将被卡在底部。

这是一个工作小提琴：http: [//jsfiddle.net/nBUnt/14/](http://jsfiddle.net/nBUnt/14/)

# sql - 评估数字一次 在一个语句中比较两次

> ID：11787511
> 
> 赞同：1
> 
> 时间：2012-08-03T00:00:29.907
> 
> 标签：sql, oracle, where-clause

简单的问题......有没有办法在一个语句中将一个数字与两个数字进行比较？像这样的东西：

```
where 1000 > 500 > 300 
```

原因是，如果我需要评估 500 并且价格昂贵，这将比替代方案节省大量时间：

```
where 1000 > 500
  and 500 > 300 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T00:04:05.453

你可以写

```
where 500 between 301 and 999 
```

或者

```
select a,b,c from (
   select a,b,c, 500 as d from ....
) where 1000 > d and d > 300 
```

但也希望数据库足够聪明，能够计算出它只需要进行一次计算。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-03T00:07:28.673

如果计算 500 很昂贵，只需评估一次并存储它的值。然后将此值与 1000 和 100 进行比较。

# eclipse - 缺少 Eclipse JRE 或 JDK

> ID：11787513
> 
> 赞同：7
> 
> 时间：2012-08-03T00:00:48.580
> 
> 标签：eclipse, java

我正在尝试在朋友的计算机上使用 Eclipse，但是当我们运行 Eclipse 时我们不断得到这个

![在此处输入图像描述](../Images/94bc1fcf1d4c4c0411cb8eddb48bc2c3.png)

我们也设置了环境变量。

![在此处输入图像描述](../Images/7bbbe4c35c5635e2a8610999696de7bb.png)

* * *

编辑

在他安装黑莓插件之前它正在工作。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-03T01:09:29.457

`JAVA_HOME`Eclipse 不需要该变量。如果您的 Java 安装没有将 Java 可执行文件放入 . `PATH`，您应该手动添加它们。

让您的 Eclipse 启动并运行的一种更快的方法是修改`eclipse.ini`和使用该`-vm`选项。

[http://wiki.eclipse.org/Eclipse.ini#-vm_value:_Windows_Example](http://wiki.eclipse.org/Eclipse.ini#-vm_value:_Windows_Example)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-21T17:38:51.813

我有同样的问题。对我来说，我需要**JDK**。所以我不得不安装JDK。它应该匹配构建平台，即**64 位**与 32 位窗口。之后，我从**eclipse.ini**文件中删除了 -vm 行（建议的修复）。它给了我“无法创建虚拟机”错误。JDK 的当前版本是版本 7，而 Eclipse 的 Android Developers Toolkit 版本目前基于 JDK 6。但它似乎可以工作。Eclipse 出现并且可以正常工作。还没有真正写过程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T01:17:00.257

转到 eclipse 文件夹（安装 eclipse）并在编辑器中打开 eclipse.ini 文件，并在 openFile 标记后添加以下代码。

> -vm C:\Program Files\JDK6\bin\javaw.exe

就这样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-16T18:43:49.883

我遇到了类似的问题，因为我们的服务台不断更新我们的 Java 和 JDK，包括卸载旧的 JDK。他们为我们处理了 PATH，但后来 Eclipse 用来“看到”的 JRE 消失了。因此，对我来说最有效的方法是修改快捷方式的“目标”：

```
"C:\Program Files\Eclipse\Eclipse IDE for Java EE Developers\eclipse.exe" 
```

至

```
"C:\Program Files\Eclipse\Eclipse IDE for Java EE Developers\eclipse.exe" -vm "C:\Program Files\Java\<jdkver>\jre\bin\javaw.exe" 
```

这会将 Eclipse 指向您希望它使用的 JDK 中的 JRE，然后您可以在 JDK 更新时更新该快捷方式。

显然，这是在 Windows 64 位上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-04T12:42:09.190

它也可能发生在**JAVA 和 Eclipse 位版本****不匹配**的情况下。

 **例如：

如果在您的系统中 java 是 32 位的，而您正在尝试安装 64 位的 Eclipse，那么可能会发生同样的情况。因为 Eclipse 会在 Program Files 中查找 Java，而同时 Java 可能出现在 Program Files (x86) 中。

所以在这种情况下，eclipse 不会得到 java 并抛出同样的错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-22T13:46:36.823

安装 Eclipse 时，缺少 Jre：

我解决了我的错误如下： -

如果您的系统中有 2 个程序文件夹，则可能会出现此错误。“程序文件”和“程序文件 x86”。

请在“程序文件”文件夹中安装 JDK&JRE。希望您的 jre 缺失错误得到解决。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-08-26T14:38:29.730

这对我有用：

1.  在编辑器中打开 eclipse.ini 文件并添加以下行：-vm C:\Program Files\JDK11\bin\javaw.exe
2.  使用正确的 JDK 路径更新系统 PATH。**

# java - Maven 问题 - 依赖项（类未找到异常）

> ID：11787517
> 
> 赞同：0
> 
> 时间：2012-08-03T00:01:04.210
> 
> 标签：java, maven, classnotfoundexception, autowired

我开始一个新项目，它似乎有一些与 Maven 相关的问题。当我尝试启动我的网络应用程序时，它给出了与 bean 工厂创建相关的错误，因为找不到其他项目中引用的类。在这种情况下，我需要停止服务器，为其他项目运行 pom.xml，为我的项目运行 pom.xml，然后重新启动服务器。我觉得很奇怪，如果它们是相关的，maven 不应该自动运行那个依赖吗？

请参阅下面的错误消息：

```
2012-08-03 08:55:01,374 [domain-service:main][ERROR] org.springframework.web.context.ContextLoader  - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'assetService' defined in URL [file:/C:/Springsource/tc-server-6.0.20.domain.service/wtpwebapps/pumpkin-domain-service/WEB-INF/classes/applicationContext.xml]: Instantiation of bean failed; nested exception is java.lang.NoClassDefFoundError: com/pumpkin/service/exception/ServiceException
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:965)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:293)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:290)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:192)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)
    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:282)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:204)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3934)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4429)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:741)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
    at org.apache.catalina.core.StandardService.start(StandardService.java:516)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:587)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:290)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)
Caused by: java.lang.NoClassDefFoundError: com/pumpkin/service/exception/ServiceException
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1890)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:887)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1351)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1230)
    at java.lang.Class.getDeclaredConstructors0(Native Method)
    at java.lang.Class.privateGetDeclaredConstructors(Class.java:2389)
    at java.lang.Class.getConstructor0(Class.java:2699)
    at java.lang.Class.getDeclaredConstructor(Class.java:1985)
    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:65)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:958)
    ... 28 more 
```

非常感谢任何帮助！先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T06:06:44.363

我总是喜欢在得到答案时给出答案，这样我就可以帮助来到页面寻找解决方案的人......我在互联网上查看了更多内容，最后在其他[stackoverflow 帖子](http://stackoverflow.com/questions/2822958/maven-spring-java-classnotfoundexception-but-i-know-class-is-there)上找到了解决方案：

> Maven 依赖项并不总是可传递的。如果 taac-backend-gui 使用 scope="test" 或 optional="true" 声明其对 com.wuntee.rsaAuthenticationManager 的依赖项，则 com.wuntee.rsaAuthenticationManager 不会自动成为 com.wuntee.taac 的依赖项与您描述的症状一致。

干杯!

# c++ - 如何更改要反转的 std::map 的顺序？

> ID：11787521
> 
> 赞同：4
> 
> 时间：2012-08-03T00:02:12.730
> 
> 标签：c++, map

有谁知道有没有办法可以将地图顺序从更少更改为“更多”？

例如：

有一个`map<string, int>`叫`test`. 我在其中插入了一些条目：

```
test["b"] = 1;
test["a"] = 3;
test["c"] = 2; 
```

在地图内，顺序为`(a, 3)(b, 1)(c, 2)`。

我希望它是`(c, 2)(b, 1)(a, 3)`。

我怎样才能以简单的方式做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-03T00:05:58.493

通过`std::greater`用作您的密钥而不是`std::less`.

例如

```
std::map< std::string, int, std::greater<std::string> > my_map; 
```

请参阅[参考资料](http://en.cppreference.com/w/cpp/container/map)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-03T01:09:18.627

如果您有一个现有的地图，并且您只想反向循环地图的元素，请使用反向迭代器：

```
// This loop will print (c, 2)(b, 1)(a, 3)

for(map< string, int >::reverse_iterator i = test.rbegin(); i != test.rend(); ++i)
{
    cout << '(' << i->first << ',' << i->second << ')';
} 
```

# winforms - 错误 LNK 2028 和 2001

> ID：11787522
> 
> 赞同：1
> 
> 时间：2012-08-03T00:02:16.967
> 
> 标签：winforms, visual-studio-2010, linker, c++-cli, lnk2001

我正在使用 Visual C++ 2010 中的 Windows 窗体进行项目。我正在使用[BasicExcel](http://www.codeproject.com/Articles/13852/BasicExcel-A-Class-to-Read-and-Write-to-Microsoft)类。以下是相关代码：

我包括头文件：

```
#include "BasicExcel.hpp"
using namespace YExcel; 
```

然后，当我按下按钮时，我让软件在单元格 1,4 处写入“Test str1”：

```
private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) {
         //Code for Writing to Excel
            BasicExcel x;
        // Load a workbook with one sheet, write some test data at (1,4)
            x.Load("TestFile.xlsx");
            BasicExcelWorksheet* sheet = x.GetWorksheet("Sheet1");
            BasicExcelCell* cell;
            sheet->Cell(1,4)->SetString("Test str1");
     } 
```

当我这样做时，我收到以下错误：

```
1>Enter Loads.obj : error LNK2028: unresolved token (0A000020) "public: class    YExcel::BasicExcelCell * __clrcall YExcel::BasicExcelWorksheet::Cell(unsigned int,unsigned     int)" (?Cell@BasicExcelWorksheet@YExcel@@$$FQAMPAVBasicExcelCell@2@II@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Agricultural_Software.obj : error LNK2028: unresolved token (0A00005A) "public: class YExcel::BasicExcelCell * __clrcall YExcel::BasicExcelWorksheet::Cell(unsigned int,unsigned int)" (?Cell@BasicExcelWorksheet@YExcel@@$$FQAMPAVBasicExcelCell@2@II@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2028: unresolved token (0A000021) "public: void __clrcall YExcel::BasicExcelCell::SetString(char const *)" (?SetString@BasicExcelCell@YExcel@@$$FQAMXPBD@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Agricultural_Software.obj : error LNK2028: unresolved token (0A00005B) "public: void __clrcall YExcel::BasicExcelCell::SetString(char const *)" (?SetString@BasicExcelCell@YExcel@@$$FQAMXPBD@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2028: unresolved token (0A000022) "public: class YExcel::BasicExcelWorksheet * __clrcall YExcel::BasicExcel::GetWorksheet(char const *)" (?GetWorksheet@BasicExcel@YExcel@@$$FQAMPAVBasicExcelWorksheet@2@PBD@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Agricultural_Software.obj : error LNK2028: unresolved token (0A00005C) "public: class YExcel::BasicExcelWorksheet * __clrcall YExcel::BasicExcel::GetWorksheet(char const *)" (?GetWorksheet@BasicExcel@YExcel@@$$FQAMPAVBasicExcelWorksheet@2@PBD@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2028: unresolved token (0A000023) "public: bool __clrcall YExcel::BasicExcel::Load(char const *)" (?Load@BasicExcel@YExcel@@$$FQAM_NPBD@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Agricultural_Software.obj : error LNK2028: unresolved token (0A00005D) "public: bool __clrcall YExcel::BasicExcel::Load(char const *)" (?Load@BasicExcel@YExcel@@$$FQAM_NPBD@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2028: unresolved token (0A000024) "public: __clrcall YExcel::BasicExcel::~BasicExcel(void)" (??1BasicExcel@YExcel@@$$FQAM@XZ) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Agricultural_Software.obj : error LNK2028: unresolved token (0A00005E) "public: __clrcall YExcel::BasicExcel::~BasicExcel(void)" (??1BasicExcel@YExcel@@$$FQAM@XZ) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2028: unresolved token (0A000025) "public: __clrcall YExcel::BasicExcel::BasicExcel(void)" (??0BasicExcel@YExcel@@$$FQAM@XZ) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Agricultural_Software.obj : error LNK2028: unresolved token (0A00005F) "public: __clrcall YExcel::BasicExcel::BasicExcel(void)" (??0BasicExcel@YExcel@@$$FQAM@XZ) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Agricultural_Software.obj : error LNK2019: unresolved external symbol "public: __clrcall YExcel::BasicExcel::~BasicExcel(void)" (??1BasicExcel@YExcel@@$$FQAM@XZ) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2001: unresolved external symbol "public: __clrcall YExcel::BasicExcel::~BasicExcel(void)" (??1BasicExcel@YExcel@@$$FQAM@XZ)
1>Agricultural_Software.obj : error LNK2019: unresolved external symbol "public: void __clrcall YExcel::BasicExcelCell::SetString(char const *)" (?SetString@BasicExcelCell@YExcel@@$$FQAMXPBD@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2001: unresolved external symbol "public: void __clrcall YExcel::BasicExcelCell::SetString(char const *)" (?SetString@BasicExcelCell@YExcel@@$$FQAMXPBD@Z)
1>Agricultural_Software.obj : error LNK2019: unresolved external symbol "public: class YExcel::BasicExcelCell * __clrcall YExcel::BasicExcelWorksheet::Cell(unsigned int,unsigned int)" (?Cell@BasicExcelWorksheet@YExcel@@$$FQAMPAVBasicExcelCell@2@II@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2001: unresolved external symbol "public: class YExcel::BasicExcelCell * __clrcall YExcel::BasicExcelWorksheet::Cell(unsigned int,unsigned int)" (?Cell@BasicExcelWorksheet@YExcel@@$$FQAMPAVBasicExcelCell@2@II@Z)
1>Agricultural_Software.obj : error LNK2019: unresolved external symbol "public: class YExcel::BasicExcelWorksheet * __clrcall YExcel::BasicExcel::GetWorksheet(char const *)" (?GetWorksheet@BasicExcel@YExcel@@$$FQAMPAVBasicExcelWorksheet@2@PBD@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2001: unresolved external symbol "public: class YExcel::BasicExcelWorksheet * __clrcall YExcel::BasicExcel::GetWorksheet(char const *)" (?GetWorksheet@BasicExcel@YExcel@@$$FQAMPAVBasicExcelWorksheet@2@PBD@Z)
1>Agricultural_Software.obj : error LNK2019: unresolved external symbol "public: bool __clrcall YExcel::BasicExcel::Load(char const *)" (?Load@BasicExcel@YExcel@@$$FQAM_NPBD@Z) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2001: unresolved external symbol "public: bool __clrcall YExcel::BasicExcel::Load(char const *)" (?Load@BasicExcel@YExcel@@$$FQAM_NPBD@Z)
1>Agricultural_Software.obj : error LNK2019: unresolved external symbol "public: __clrcall YExcel::BasicExcel::BasicExcel(void)" (??0BasicExcel@YExcel@@$$FQAM@XZ) referenced in function "private: void __clrcall Agricultural_Software::EnterLoads::button1_Click(class System::Object ^,class System::EventArgs ^)" (?button1_Click@EnterLoads@Agricultural_Software@@$$FA$AAMXP$AAVObject@System@@P$AAVEventArgs@4@@Z)
1>Enter Loads.obj : error LNK2001: unresolved external symbol "public: __clrcall YExcel::BasicExcel::BasicExcel(void)" (??0BasicExcel@YExcel@@$$FQAM@XZ)
1>C:\Users\Jake\Documents\Agricultural Software\Agricultural_Software\Release\Agricultural_Software.exe : fatal error LNK1120: 18 unresolved externals
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

我试图修复它，但我对链接知之甚少。如果有人能启发我，我将不胜感激。谢谢！

# android - 处理程序/可运行的延迟有时会产生不同步的事件

> ID：11787523
> 
> 赞同：3
> 
> 时间：2012-08-03T00:02:18.360
> 
> 标签：android, multithreading, handler, delay, runnable

在尝试学习如何创建延迟时，我研究并发现主要的答案是使用 Handler/Runnable/postDelayed。

```
 Handler handler=new Handler();
                        final Runnable r = new Runnable()
                        {
                            public void run() 
                            {
                                delayedMethod();
                            }
                        };
                        handler.postDelayed(r, 1000); 
```

这在一段时间内工作正常，但我添加了更多正在发生的事情，现在它们有时会以错误的顺序发生。

这组事件：

paintScreen1()
...
延迟PaintScreen2()
...
paintScreen3()

正在搞砸（有时）并这样做：

paintScreen1()
...
paintScreen3()
...
delayedPaintScreen2() （最后运行并被paintScreen3 的操作弄乱了）

似乎没有另一种创建延迟的好方法 - 一种不创建线程的方法。

我尝试过的解决方案以确保代码事件以正确的顺序运行：

0 将主进程放在一个大的同步块中。

1 在主进程中涉及的每个方法的方法名中加上 synchronized 关键字。

2 仅将同步关键字放在 Runnable 中的方法上。

3 拿走 Handler/Runnable/postdelayed 并替换为 handler.sendEmptyMessageDelayed(0,1000)

4 制作一个 Handler 实例变量，供每个 Handler/Runnable 块使用（与 Handler handler1、handler2、handler3 等相反）

5

```
 Handler handler=new Handler();
                        final Runnable r = new Runnable()
                        {
                            public void run() 
                            {
                                waitOver = true;
                            }
                        };
                        handler.postDelayed(r, 1000);

                        while (waitOver == false) {

                        }
                        delayedMethod();
                        waitOver = false; 
```

我的下一个尝试可能是尝试以某种方式使用 Thread 类，这样我就可以调用 thread.join()。我担心，如果失败了，接下来的事情将会非常漫长和复杂。

有什么建议么？

任何简单的解决方案示例？

谢谢

编辑：我可能对 Handler/Runnable 是否导致文字线程感到困惑。

编辑：这是一个游戏。用户移动，屏幕更新以显示移动，计算告诉他们得分，重新着色屏幕上的框，添加延迟以允许用户看到他们的点，然后调用方法以删除彩色方块，当该方法完成时我们返回调用它的方法（包含 Handler/runnable），代码继续向下调用另一个方法，导致棋盘的随机正方形变为紫色。所以它应该发生用户移动，重新绘制以显示得分，延迟以便用户可以看到得分，重新绘制以擦除方块，然后随机出现紫色方块。有时会发生什么（据我所知）是随机的紫色方块会在它应该执行之前执行，选择得分点的方块之一，干扰，

mainmethod() {
...
if (pointscored) {
squaresglow();
...
//延迟，以便用户可以在清理发生之前看到发光
Handler-runnable
cleanup(); 延迟} ...
PurpleSquare (); }

我希望这不会更加混乱。PurpleSquare 在清理之前运行，事情就搞砸了。

编辑：试过这个：6

```
 CountDownLatch doneSignal = new CountDownLatch(1);
                        Handler handler=new Handler();
                        final LatchedRunnable lr = new LatchedRunnable(doneSignal);
                        handler.postDelayed(lr, COMPUTER_MOVE_DELAY);
                        try {
                            doneSignal.await();
                        } catch (InterruptedException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }

                        class LatchedRunnable implements Runnable {
                            private final CountDownLatch doneSignal;

                            LatchedRunnable(CountDownLatch doneSignal) {
                                this.doneSignal = doneSignal;
                            }

                            public void run() {
                                 delayedProcess();
                                 doneSignal.countDown();                                                                                                                                                               
                            }
                        } 
```

7

```
 ExecutorService executorService = Executors.newFixedThreadPool(5);
                        final CountDownLatch latch = new CountDownLatch(1);
                        executorService.execute(new Runnable() {
                            public void run() {
                                try {
                                    Looper.prepare();
                                    Handler handler=new Handler();
                                    final Runnable r = new Runnable()
                                    {
                                        public void run() 
                                        {
                                            delayedMethodCleanupCalc();
                                        }
                                    };
                                    handler.postDelayed(r, 4000);
                                } finally {
                                    latch.countDown();
                                }  
                            }
                        });
                        try {
                            latch.await();
                            delayedMethodPaintScreen();
                        } catch (InterruptedException e) {
                            // todo >> handle exception
                        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T17:46:47.753

> PurpleSquare 在清理之前运行，事情搞砸了
> 
> ```
> mainmethod() {
> ...
> if (pointscored) {
>     squaresglow();
>     ...
>     //delay so user can see the glow before the cleanup happens
>     Handler-runnable
>         cleanup();
>     postdelayed
> }
> ...
> purpleSquare();
> } 
> ```

你这里有一个设计缺陷。将处理程序视为消息队列，每当处理器决定处理消息时“稍后”将执行代码，并将 postDelayed 视为将该消息填充到队列底部的不精确方式。如果您调用 postDelayed 并且在当前方法中仍有几行代码要执行，那么这些行很有可能会在 postDelayed 消息被接收之前执行。

您要做的是确保在积分例程完成工作后调用purpleSquare()，这可能需要等待它完成。在这种情况下，您不应该对消息队列进行 PostDelaying。您应该使用的是信号量和 pointScored 线程。

考虑以下代码设计：

```
final Runnable pointScoredTask = new Runnable() {
    public synchronized void run() {
        try {
            squaresglow();
            //...
            Thread.sleep(2500); //2.5 sec before cleanup occurs
            cleanup();
        } catch (InterruptedException e) {
        }
        notify(); //make sure we call notify even if interrupted
    }
};
void mainmethod() {
    //...
    if (bPointWasScored) {
        synchronized (pointScoredTask) {
            try {
                Thread psThread = new Thread(pointScoredTask,"pointscored");
                psThread.start(); //thread will start to call run(), but we get control back to avoid race condition
                pointScoredTask.wait(6000); //wait no more than 6 sec for the notify() call
            } catch (InterruptedException e) {
            } 
        }
        //if a point was scored, nothing past this line will execute until scoreglow has been cleaned up 
    }
    //...
    purpleSquare();
    //...
} 
```

我知道你宁愿避免使用线程，但是当你使用它们时，有些东西会更好地工作。试试上面的设计，看看是否能解决你看到的同步问题。

# java - 序列化 RowMutation

> ID：11787527
> 
> 赞同：3
> 
> 时间：2012-08-03T00:02:29.470
> 
> 标签：java, cassandra

在 Github ( [https://github.com/apache/cassandra](https://github.com/apache/cassandra) ) 上的 Cassandra 源主干中，有一个将数据写入的示例`examples/client_only/src/ClientOnlyExample.java`：

```
private static void testWriting() throws Exception
    {
        // do some writing.
        for (int i = 0; i < 100; i++)
        {
            RowMutation change = new RowMutation(KEYSPACE, ByteBufferUtil.bytes(("key" + i)));
            ColumnPath cp = new ColumnPath(COLUMN_FAMILY).setColumn(("colb").getBytes());
            change.add(new QueryPath(cp), ByteBufferUtil.bytes(("value" + i)), 0);

            // don't call change.apply().  The reason is that is makes a static call into Table, which will perform
            // local storage initialization, which creates local directories.
            // change.apply();

            StorageProxy.mutate(Arrays.asList(change), ConsistencyLevel.ONE);
            System.out.println("wrote key" + i);
        }
        System.out.println("Done writing.");
    } 
```

我正在寻找将数据序列化为可读格式（JSON），其中写入似乎发生`org.apache.cassandra.service.StorageProxy`在方法内部`performWrite`：

```
public static IWriteResponseHandler performWrite(IMutation mutation,
            ConsistencyLevel consistency_level,
            String localDataCenter,
            WritePerformer performer)
            throws UnavailableException, IOException
    {
... 
```

该`IMutation`参数似乎是我想要的，因为它`RowMutation`实现了该类。我可以获取表（键空间）和列族，但似乎无法获取列名/值。如果我在上述方法中，我如何从中获取该信息`IMutation mutation`？

```
// keyspace
String table = mutation.getTable();

// TODO won't work with batch?
UUID cfId = mutation.getColumnFamilyIds().iterator().next();

// column family name cfMetadata.cfName
CFMetaData cfMetadata = Schema.instance.getCFMetaData(cfId);

// row key 
RowMutation data = new RowMutation(table, mutation.key());
String row = ByteBufferUtil.bytesToHex(data.key());

// column name/values ??
// data. .... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T08:00:25.093

我查看了[行突变源代码](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.cassandra/cassandra-all/0.8.0-beta1/org/apache/cassandra/db/RowMutation.java)，其中在同一个包上有一个具有方法的 RowMutationSerializer

```
 serialize(RowMutation, DataOutputStream, int) 
```

这能起到什么作用吗？

# unit-testing - EasyMock 新手：如何重写方法以使其行为不同，而不仅仅是返回不同的值

> ID：11787530
> 
> 赞同：1
> 
> 时间：2012-08-03T00:02:59.017
> 
> 标签：unit-testing, junit, easymock

我正在学习单元测试和模拟。我有 JUnit 运行，而不是使用模拟框架，我通过扩展现有的类和接口手动创建了模拟类。我想学习模拟框架 EasyMock，因为这就是我工作中可用的所有内容。虽然您可能会建议一些其他模拟框架，但它们对我不可用。

设置：

我有一个 View 和一个 Presenter 以及一个 API 后端。当用户单击一个按钮：“检查更新”时，视图会调用`presenter.checkForUpdates()`执行调用`api.checkForUpdates()`并期望回调的 。如果发生异常，api会通过回调通知presenter，controller会调用view方法`view.showUserError()`。回调用于不返回参数，因为我们的 API 后端具有异步性质。

被测对象是`Presenter`. 具体来说，我想测试`View.showUserError()`在 Api 中发生异常时是否调用了该方法。我相信我可以模拟`Api.checkForUpdates()`立即调用异常回调，而不是进行实际的网络调用。

问题是，我只看到 EasyMock 模拟返回值。例如：

`EasyMock.expect(api.checkForUpdates()).andReturn(xxxx)`

不会为我工作，因为`api.checkForUpdates()`不返回任何东西，而是进行回调。我真正想做的是：

`EasyMock.expect(api.checkForUpdates()).andExecute(exceptionCallback(NetworkError));`

但我不知道该怎么做。有什么东西可以做我想做的事，还是我缺少一些基本的东西？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T08:41:10.030

我认为您可以使用“Expect().andDelegateTo()”API 制作存根。

[http://devlearnings.wordpress.com/2010/07/10/easymock-assert-arguments-of-method-call/](http://devlearnings.wordpress.com/2010/07/10/easymock-assert-arguments-of-method-call/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T22:26:38.840

EasyMock 是一个不错的选择 :-) 查看[文档](http://easymock.org/EasyMock3_1_Documentation.htm)以获取更多信息。

您可以调用 do andThrow(exceptionCallback(NetworkError) 可能适合您的需求。

如果你需要更强大的东西，andAnswer 会让你做任何你想做的事情来创建答案。andDelegateTo 也可能是一个不错的选择，但您必须实现一个实现与模拟相同接口的类。在您的情况下，这可能比其他两个选项更复杂。

# java - java中的计时器有多准确？

> ID：11787532
> 
> 赞同：1
> 
> 时间：2012-08-03T00:03:08.107
> 
> 标签：java, android, timer

我基本上是安排一个任务每十秒运行一次，但它似乎每 8 或 9 秒运行一次。我使用函数 schedule (task, 0 , 10000);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:35:04.083

尝试使用警报服务来安排任务。

希望这个链接会有所帮助[http://android-er.blogspot.com/2010/10/simple-example-of-alarm-service-using.html](http://android-er.blogspot.com/2010/10/simple-example-of-alarm-service-using.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:20:23.670

我会说它非常准确。在我的应用程序（Tap Counter）中，我使用计时器来启动任务，并使用单独的计时系统来显示倒计时，并且它们完美同步。

随时查看我的应用程序 =)

# jquery - jQuery：链接动画是一个问题，改进我的代码

> ID：11787533
> 
> 赞同：1
> 
> 时间：2012-08-03T00:03:32.723
> 
> 标签：jquery, jquery-animate, fadein, fadeout

```
$(".info-graphic-data-box").fadeOut(200);
$(".info-graphic-content").fadeOut(200);
$("#" + currentContentId).parent().fadeIn(500);
$("#" + currentContentId).fadeIn(500); 
```

所以，在这种情况下，我必须淡出两个元素，然后淡入不同的两个元素。

这里的问题是动画是链式的……这意味着，如果你一个接一个地翻转多个元素，动画就会继续进行下去。

帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:11:11.710

1-首先，创建对您的 DOM 对象的引用：

```
var $idgb = $(".info-graphic-data-box"),
    $igc = $(".info-graphic-content"),
    $cc = $("#" + currentContentId); 
```

2-使用回调和链接来确保正确的动画执行：

```
$idgb.fadeOut(200, function(){
    $igc.fadeOut(200, function(){
        $cc.parent().fadeIn(500).end().fadeIn(500);
    });
}); 
```

3- 每当您认为可能与执行重叠时，请使用 stop() 方法取消任何当前正在运行的动画：

```
$cc.stop().parent().stop().fadeIn(500, function(){ $cc.fadeIn(500); }); 
```

以上是伪代码......不确定您希望动画如何真正在页面上工作（基于用户输入）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:49:14.793

如果它按原样为您工作，除了动画没有停止，我猜问题不是动画的顺序，您需要的只是`stop()`：

```
$(".info-graphic-data-box, .info-graphic-content").stop(true, false).fadeOut(200);
$("#" + currentContentId).fadeIn(500).parent().stop(true, false).fadeIn(500); 
```

也稍微合并了这些选择器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T00:06:44.193

*只有应用于相同元素的*动画才会被链接。

要在添加新动画之前停止任何正在进行的动画，请使用该[`.stop()`](http://api.jquery.com/stop/)方法。

# ruby-on-rails - 最推荐的开发丰富但易于部署的 web 应用程序的框架

> ID：11787537
> 
> 赞同：0
> 
> 时间：2012-08-03T00:04:20.430
> 
> 标签：ruby-on-rails, django, spring, gwt, web-applications

我正在进入 webapp 的 programmin 我对许多可用的框架感到非常困惑，每个框架都基于不同的语言。我发现了很多（并且只是试驾了其中一些）我有使用 Java、PHP、Javascript、CSS、HTML、Python（但从未尝试过 django）、C/C++ 语言的经验

到目前为止，我使用的最好的是 Ruby On Rails。我对 ruby​​ 语言了解不多，但它看起来确实与 python 非常相似，我的意思是，它看起来像是一种简单的语言。那么，学习 Ruby 以将其与 rails 一起使用是合理的吗？

我找到了以下框架：

Spring (Java) Django (Python) GWT (Java) Rails (Ruby) 这些看起来是更高级和成熟的框架，那么，您对使用不同框架开发 webapps 有什么经验？每种方法的优点/缺点是什么？（或您想提及的任何其他内容。）以及您会推荐的好资源或书籍。

我读过基于 java 的更复杂和乏味，Rails 似乎是复杂性和有效性之间的一个很好的中间地带。此外，GWT（Google Web Toolkit）似乎很适合开发 UI，因为它为您提供了一组可供使用的小部件。

我正在寻找一个具有丰富用户界面的框架，为网络开发类似桌面的应用程序......

任何意见，想法，建议将不胜感激！

原谅我的英语不好！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:41:48.503

如果您想使用标准的“服务器端”java，我可以推荐 JSF with [primefaces](http://www.primefaces.org)。首先获得它有点困难，但社区很广泛，书籍/文档非常容易获得。Primefaces 作为一组丰富的小部件（看一下展示）并且非常活跃。

无论您选择什么框架，我强烈建议您学习和使用[JQuery](http://jquery.com/)来满足您的 javascript 需求。现在，我所有的 Web 应用程序都必须使用 Personnaly jquery。您总能找到基于 jquery 的可随时使用的插件和小部件。

你应该看看[jquery-ui](http://jqueryui.com/)。它是一组基于 jquery 的 javascript 小部件和实用程序。

祝你学习顺利，希望这会有所帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:26:35.463

> 我正在寻找一个具有丰富用户界面的框架，为网络开发类似桌面的应用程序......

如果是这样的话，[GWT](https://developers.google.com/web-toolkit/)将是一个不错的选择。

您提到的其余框架（以及大多数标记为“Web 框架”的框架）更多地关注后端，并且没有为您想要的前端开发提供很多工具。您需要将它们与其他前端框架结合起来才能实现这一目标。

# ruby - 在缓存中找不到元素 - 页面可能在查找后已更改 (Selenium::WebDriver::Error::StaleElementReferenceError)

> ID：11787539
> 
> 赞同：9
> 
> 时间：2012-08-03T00:04:39.297
> 
> 标签：ruby, watir-webdriver

我正在尝试单击 stackoveflow 水平菜单上的所有链接（问题、标签、用户、徽章、未回答）。我有这个代码，但是点击第一个链接（这个链接是问题），然后打印 1，然后引发错误。这可能有什么问题？

```
require 'watir-webdriver'

class Stackoverflow
  def click_all_nav_links
    b = Watir::Browser.new
    b.goto "http://stackoverflow.com"

    counter = 0
    b.div(:id => 'hmenus').div(:class => 'nav mainnavs').ul.lis.each do |li|
      li.a.click
      puts counter += 1
    end
  end
end

stackoverflow = Stackoverflow.new
stackoverflow.click_all_nav_links 
```

错误信息是： [https ://gist.github.com/3242300](https://gist.github.com/3242300)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-03T01:28:53.983

StaleElementReferenceError 通常发生在存储元素并在转到另一个页面后尝试访问它们时。在这种情况下，在您单击链接并导航到新页面后，对 lis 的引用将变得陈旧。

您必须首先存储属性或 lis 的索引。这将允许您在单击链接后获得对每个 li 的新引用。

尝试这个：

```
class Stackoverflow
    def click_all_nav_links
        b = Watir::Browser.new
        b.goto "http://stackoverflow.com"

        #Store the text of each locate so that it can be located later
        tabs = b.div(:id => 'hmenus').div(:class => 'nav mainnavs').ul.lis.collect{ |x| x.text }

        #Iterate through the tabs, using a fresh reference each time
        tabs.each do |x|
            b.div(:id => 'hmenus').div(:class => 'nav mainnavs').ul.li(:text, x).a.click
        end
    end
end

stackoverflow = Stackoverflow.new
stackoverflow.click_all_nav_links 
```

# magento - Magento：在 CMS 页面中按 ID 显示类别图像

> ID：11787545
> 
> 赞同：2
> 
> 时间：2012-08-03T00:05:41.577
> 
> 标签：magento, magento-1.5

有没有办法通过 CMS 页面中的类别 ID 显示类别图像？

您可以通过 id 显示类别链接：

```
{{widget type="catalog/category_widget_link" anchor_text="Displayed Text" title="Title attribute text" template="catalog/category/widget/link/link_block.phtml" id_path="category/22"}} 
```

或按其 id 显示类别产品。

```
{{block type="catalog/product_list" category_id="14" template="catalog/product/list.phtml"}} 
```

但我无法弄清楚如何通过调用它的 id 在 CMS 页面中显示特定类别的图像。

任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T07:28:11.493

Magento 有货，你不能。

基本上有 3 种方法可以实现这一点，按优先顺序排列（从好到坏 imo）：

1.  创建和使用小部件
2.  直接嵌入 cms 页面并使用自定义块类型来初始化类别
3.  直接嵌入到cms页面，使用core/template块类型，直接在模板内初始化category

* * *

**1.使用小部件**

我之前回答过一个类似的问题，并提供了一个完整的例子来说明如何构建一个特定于某个类别的小部件：

[magento - 静态块中的类别名称和图像？](https://stackoverflow.com/questions/10889747/magento-category-name-and-image-in-static-block/10894043#10894043)

* * *

**2.自定义模块**

您需要创建一个带有块的模块来支持这一点。然后，您可以使用以下语法将块包含在 cms 页面中：

```
{{block type="yourmodule/category_image" category_id="14" template="yourmodule/category/image.phtml"}} 
```

您的块类将如下所示：

```
<?php

    class Yourcompany_Yourmodule_Block_Category_Image extends Mage_Core_Block_Template
    {
        public function getCategory()
        {
            if (! $this->hasData('category')) {
                $category = Mage::getModel('catalog/category')->load($this->getData('category_id'));
                $this->setData('category', $category);
            }
            return $this->getData('category');
        }
    } 
```

您的模板类将如下所示：

```
<?php

$_helper    = $this->helper('catalog/output');
$_category  = $this->getCategory();
$_imgHtml   = '';
if ($_imgUrl = $_category->getImageUrl()) {
    $_imgHtml = '<p class="category-image"><img src="'.$_imgUrl.'" alt="'.$this->htmlEscape($_category->getName()).'" title="'.$this->htmlEscape($_category->getName()).'" /></p>';
    $_imgHtml = $_helper->categoryAttribute($_category, $_imgHtml, 'image');
}

?>

<?php if($_imgUrl): ?>
    <?php echo $_imgHtml ?>
<?php endif; ?> 
```

* * *

**3.使用核心/模板块类型**

像这样包含在cms页面上..

```
{{block type="core/template" category_id="14" template="category/image.phtml"}} 
```

创建您的模板 - 目录/类别/image.phtml

```
<?php
$_helper   = $this->helper('catalog/output');
$category  =  Mage::getModel('catalog/category')->load($this->getData('category_id'));
$_imgHtml  = '';
if ($_imgUrl = $_category->getImageUrl()) {
    $_imgHtml = '<p class="category-image"><img src="'.$_imgUrl.'" alt="'.$this->htmlEscape($_category->getName()).'" title="'.$this->htmlEscape($_category->getName()).'" /></p>';
    $_imgHtml = $_helper->categoryAttribute($_category, $_imgHtml, 'image');
}

?>

<?php if($_imgUrl): ?>
    <?php echo $_imgHtml ?>
<?php endif; ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T01:52:45.120

我认为您不能只调用图像，因为它不是块。在 /design/base/default/template/category/view.phtml 中，它只是调用图像 url 作为块的属性，然后在模板文件中构建输出 HTML。块中没有任何特定元素可以使用 magento 的简码调用它。

最好的办法是构建一个新的小部件。有很多指南，一旦您更好地了解它们，它们就会非常棒。

# javascript - 使用 CSS3 / Javascript 的真实世界 3D 模型

> ID：11787548
> 
> 赞同：0
> 
> 时间：2012-08-03T00:05:52.293
> 
> 标签：javascript, html, css, html5-animation

我需要旋转/动画 360 度。来自智能手机浏览器的真实世界 3D 对象。当用户在屏幕上滚动时，现实世界的对象（例如汽车）需要旋转或设置动画。一种选择是一个接一个地替换图像。

任何人都可以使用 CSS3/Javascript 提供更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:09:44.007

有一个名为 Three.js 的 Javascript 3d 库 - [https://github.com/mrdoob/three.js/](https://github.com/mrdoob/three.js/) 或者如果你正在寻找更简单的东西，比如矢量，你可能想查看 Raphael.js - [http:// raphaeljs.com](http://raphaeljs.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T06:28:23.503

Three.js 不会是移动浏览器的最佳选择，考虑到 WebGL 实现仍然是 iOS Safari 的愿望，即使 Android 并非如此。CSS3 无法处理高度复杂的 3D 对象操作，因此从这个角度来看，它受到了某种限制。它具有所有 3D（旋转、缩放和变换）功能，但后期处理效果（可以通过着色器获得）超出了范围。

但是有一个不错的小库，它结合了 Javascript 和 CSS3 来创建一些 3dish 效果：[http ://www.edankwan.com/lab/css3dEarth](http://www.edankwan.com/lab/css3dEarth)

我想这就是你需要的！

# node.js - 如何使用 node-gyp 根据节点版本有条件地为 node.js 编译本机代码？

> ID：11787553
> 
> 赞同：2
> 
> 时间：2012-08-03T00:06:28.663
> 
> 标签：node.js, libuv, node-gyp

我有一些针对 node.js 模块的 C++ 代码，它是为 node 0.8 及其增强的 libuv 编写的。具体来说，我正在使用 uv_mutex_* 函数，这些函数在节点 0.6 中包含的 libuv 中不存在。我想有条件地嵌入这些函数的 pthreads 等价物，但仅限于在旧版本上构建时。

在节点 0.8 上构建时，这应该给我一个跨平台构建（Windows 和 Linux），如果节点版本是 0.6，它应该给我一个正常运行的 Linux 版本。

节点版本是否有预处理器#define？我找不到一个。我能想到的最好的办法是在 binding.gyp 中做一些笨拙的事情，以尝试根据 <@(node_root) 猜测版本，并​​以某种方式将其按摩为“定义”值。肯定有更好的办法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T08:30:40.403

Memwatch 模块的[binding.gyp](https://github.com/lloyd/node-memwatch/blob/master/binding.gyp)文件可以满足您的需求。

它定义了一个变量来捕获节点版本：

```
'variables': {
  'node_ver': '<!(node --version | sed -e "s/^v\([0-9]*\\.[0-9]*\).*$/\\1/")'
}, 
```

然后在一个条件下使用它：

```
'target_conditions': [
  ['node_ver=="0.8"', { 'defines': ['NEW_COMPACTION_BEHAVIOR'] } ]
] 
```

不是最优雅的解决方案，但显然，目前没有更好的解决方案。

# mysql - SQL 注入攻击 - 这是做什么的？

> ID：11787558
> 
> 赞同：14
> 
> 时间：2012-08-03T00:07:03.287
> 
> 标签：mysql, security, sql-injection

我在我的网站上检测到一些失败的 SQL 注入攻击。失败的查询具有以下形式：

> `SELECT 6106 FROM(SELECT COUNT(*),':sjw:1:ukt:1'x FROM information_schema.tables GROUP BY x)`

该`':sjw:1:ukt:1'`部分是特殊构造的，变量连接在一起以给出随机的 0 或 1 等。

我想知道这些查询是做什么的？

数据库是 MySQL。

**更新：**这是原始注入的 SQL：

```
(SELECT 6106
 FROM  (SELECT COUNT(*),
               CONCAT(
                        CHAR(58, 115, 106, 119, 58), 
                        (SELECT ( CASE WHEN ( 6106 = 6106 ) THEN 1 ELSE 0 END )), 
                        CHAR(58, 117, 107, 116, 58), 
                        FLOOR(RAND(0) * 2)
                      ) x
        FROM   INFORMATION_SCHEMA.TABLES
        GROUP  BY x)a) 
```

它失败并显示消息

> 键 'group_key' 的重复条目 ':sjw:1:ukt:1'

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-10-27T16:04:32.323

## 攻击的真正作用

其他回答者错过了有关此攻击的一个微妙但巧妙的细节。注意错误消息`Duplicate entry ':sjw:1:ukt:1' for key 'group_key'`。该字符串`:sjw:1:ukt:1`实际上是您的 MySQL 服务器评估的表达式的结果。如果您的应用程序将 MySQL 错误字符串发送回浏览器，则错误消息可能会从您的数据库**中泄漏数据。**

这种攻击用于查询结果没有以其他方式发送回浏览器（盲 SQL 注入）的情况，或者经典的 UNION SELECT 攻击难以实施的情况。它也适用于 INSERT/UPDATE/DELETE 查询。

正如 Hawili 所指出的，最初的特定查询不应该泄漏任何信息，它只是一个测试，看看您的应用程序是否容易受到这种注入的攻击。

攻击*并没有*像 MvG 建议的那样失败，导致此错误是查询的目的。

一个更好的例子来说明如何使用它：

```
> SELECT COUNT(*),CONCAT((SELECT CONCAT(user,password) FROM mysql.user LIMIT 1),
>                        0x20, FLOOR(RAND(0)*2)) x
> FROM information_schema.tables GROUP BY x;
ERROR 1062 (23000): Duplicate entry 'root*309B17546BD34849D627A4DE183D3E35CD939E68 1' for key 'group_key' 
```

## 为什么会引发错误

为什么查询会在 MySQL 中导致这个错误对我来说有点神秘。它看起来像一个 MySQL 错误，因为 GROUP BY 应该通过聚合它们来处理重复的条目。Hawili 对查询的简化实际上并不会导致错误！

该表达式`FLOOR(RAND(0)*2)`基于随机种子参数 0 按顺序给出以下结果：

```
> SELECT FLOOR(RAND(0)*2)x FROM information_schema.tables;
+---+
| x |
+---+
| 0 |
| 1 |
| 1 | <-- error happens here
| 0 |
| 1 |
| 1 |
 ... 
```

因为第 3 个值与第 2 个重复，所以会抛出此错误。任何至少有 3 行的 FROM 表都可以使用，但 information_schema.tables 是常见的。COUNT(*) 和 GROUP BY 部分是在 MySQL 中引发错误所必需的：

```
> SELECT COUNT(*),FLOOR(RAND(0)*2)x FROM information_schema.tables GROUP BY x;
ERROR 1062 (23000): Duplicate entry '1' for key 'group_key' 
```

在 PostgreSQL 等效查询中不会发生此错误：

```
# SELECT SETSEED(0);
# SELECT COUNT(*),FLOOR(RANDOM()*2)x FROM information_schema.tables GROUP BY x;
 count | x 
-------+---
    83 | 0
    90 | 1 
```

（很抱歉迟到了 1 年，但我今天偶然发现了这个问题。这个问题对我来说很有趣，因为我不知道有办法通过 MySQL 的错误消息泄漏数据）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:52:06.217

执行带括号的子查询将为您提供系统中的表数。我想主要目的可能是创建查询并查看生成的 HTML 中输出出现的位置。因此随机字符串。外部`SELECT`无效，因为它的子查询没有别名。所以我认为这个错误是这次攻击失败的原因。他们可能一直在尝试查看可以注入哪些句法结构以及哪些会破坏查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T00:54:49.537

Select 只会输出数字，所以在你的情况下答案总是 6106

```
SELECT COUNT(*),':sjw:1:ukt:1'x FROM information_schema.tables GROUP BY x 
```

应该给出一个不同的答案，它将给出系统中的表数加上在名称 x 下插入的随机文本，仅此而已

简而言之，它是一个毫无意义的查询，内部查询的结果永远不会显示，整个查询的结果是预先确定的，似乎注入以某种方式自动以这种奇怪的方式记录攻击

# linux - 大量进程的缓存锁定？

> ID：11787567
> 
> 赞同：1
> 
> 时间：2012-08-03T00:08:18.037
> 
> 标签：linux, caching, locking, flock

我有一个脚本 1) 经常运行 2) 由许多不同的进程运行并且 3) 需要很长时间。

更新：需要很长时间的东西是测试谁的结果对于每个过程都是一样的。完全多余。

我认为是时候做一些缓存了，但我担心种族、冲突、腐败、时间漩涡不稳定和鸡的可能性。

复杂性是因为任何进程都可以更新缓存以及读取缓存，所以我必须知道如何处理所有这些组合。

在我看来，这闻起来像是比我更聪明、受过更多教育的人可能已经想出来的东西。

无论如何，为了使这个问题更具体，这就是我到目前为止的想法。我在脑海中使用羊群，不确定这是否是个好主意。

*   如果缓存是新鲜的，请阅读并离开
*   如果缓存过时
    *   尝试获得写锁
        *   如果我得到锁，请进行测试并更新缓存
        *   如果我没有得到锁，其他人有写锁还是读锁？
        *   如果它是共享的，为什么他们要读取陈旧的缓存？我是否忽略它们，进行测试并更新缓存（或者这可能导致它们读取一半写入的缓存......呃......）
        *   如果是独占的，请给他们一点时间来完成测试并更新缓存。

希望这是有道理的...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T11:08:10.570

这是一个使用[**flock(2)**](http://linux.die.net/man/2/flock)在并发环境中进行文件锁定的方案。它解释了“[安全缓存](https://github.com/mpapec/simple-cache)”是如何工作的。

每个缓存文件都有两个伴随文件（WLock 和 RLock）。除了第一个（NB WLock）之外，所有群请求都被阻塞。

*   拥有 WLock 可确保可能生成新缓存的机会
*   拥有共享 RLock 确保从缓存文件中安全读取
*   并且拥有独占 RLock 确保安全写入缓存文件

有两个伴随文件只有一个原因，那就是在生成新缓存时，并且旧缓存不太旧（缓存时间+N未过期）客户端仍然可以使用旧缓存而不是等待缓存生成。

请对此方案发表评论，并尽可能使其更简单。

![缓存锁定图](../Images/bef1e6993bb932419fe4fa1a0c9fcec3.png)

# php - 输入代码以转到特定页面

> ID：11787568
> 
> 赞同：1
> 
> 时间：2012-08-03T00:09:06.497
> 
> 标签：php, html, forms, keyword, passphrase

我想使用我在另一个网站上看到的想法，我在其中输入“关键字”，按 Enter，然后它将客户带到特定页面或网站。

[我在http://qldgov.remserv.com.au](http://qldgov.remserv.com.au)上看到过这样的内容，右侧有一个名为“我的雇主”的字段，例如输入“健康”，您将获得相关内容。

本质上，我有客户品牌的迷你网站，我们希望为每个客户品牌分配一个“关键字”，这样他们的所有员工都可以进入他们的网站输入这个关键字，而无需所有人都单独登录。我希望能够链接到我可以以某种方式定义的 URL。

我查看了上面提到的网站的源代码，发现他们正在使用一个表单，但我不确定他们是如何分配关键字的，或者是否有可能在没有数据库或类似的东西的情况下做到这一点。尽量保持简单，因为我无论如何都不是 PHP/Java 专家。

任何帮助都将不胜感激，即使它不是代码，而是我需要进入的方向来完成这项工作的想法。提前致谢！！:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:29:31.993

在我看来，最简单的方法是定义一个包含所有关键字和相应 url 客户端（在 JS 中）的数组。例如：

```
​var array = { 'health' : '/health.php', 'sport' : '/swimming.php' }; 
```

然后，您将获得用户输入[`onSubmit`](http://www.w3schools.com/jsref/event_form_onsubmit.asp)，如果存在，则进行`window.location`适当的修改。

```
if ( array[user_input] !== undefined ) {
     window.location = array[user_input];
}
else {
     alert ( 'not found' );
} 
```

如果用户提供`health`，他们将被重定向到`/health.php`，如果他们提供`sport`，他们将被重定向到`/swimming.php`（[JSFiddle](http://jsfiddle.net/MKwa7/)）。或者，您可以使用服务器端（PHP、JAVA）来处理请求，但这可能不值得。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:45:39.027

通过使用 php（而不是 javascript），您不依赖 javascript + 使其对 seo 友好。

首先，您将需要某种数据库或关键字/网址列表

```
$keywords = array('keyword1' => 'path/to/load.php', 'another keyword' => 'another/path'); 
```

然后你需要一个基本的表格

```
<form action="loadkeyword.php">
  <input name="query">
  <button type="submit">Go</button>
</form> 
```

然后在 loadkeyword.php

```
$keywords = array('keyword1' => 'path/to/load.php', 'another keyword' => 'another/path');
$query = $_GET['query'];
if (isset($keywords[$query])) {
   $url = $keywords[$query];
   header("HTTP/1.0 301 Moved Permanently");
   header('location: '.$url);
   exit;
} else {
   header("HTTP/1.1 404 Not Found");
   die('unable to locate keyword');
} 
```

如果您有大量关键字，我建议您使用数据库而不是数组来跟踪您的关键字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T00:49:40.130

您链接到的站点在服务器端进行，通过匹配内容的关键字列表或搜索功能（我怀疑后者）。

有几种不同的方法可以实现您的目标，所有这些方法都是将关键字与内容匹配，然后使用数组、列表或数据库进行重定向 - 原理是相同的。

但是，我会恭敬地建议这可能不是最好的解决方案。我的理由是（根据您提供的示例）您实际上是在让您的用户猜测哪个关键字与哪个迷你站点匹配（即使每个站点都有很多关键字）。为什么不只是有某种菜单可供选择（即带有迷你站点列表的选择器）？

# java - 扫描正在输入的字符串

> ID：11787570
> 
> 赞同：0
> 
> 时间：2012-08-03T00:09:54.703
> 
> 标签：java

这段代码从不打印我是赢还是输，或者是平局，我无法弄清楚。我知道 hischoice 和 whichpick 都设置正确，但 ifs 似乎不起作用。我是在错误地使用字符串还是在比较它们错误？我是 Java 新手，所以我不确定我做错了什么。

```
import java.util.Scanner;
import java.util.Random;
public class rps {

public static void main(String[] args) {
    int oppchoice;
    String hischoice = "";
    String whichpick;
    String rock = "rock";
    String paper = "paper";
    String scissors = "scissors";
    Scanner mS = new Scanner(System.in);
    Random mR = new Random();

    System.out.print("Type your choice (rock/paper/scissors): ");
    whichpick = mS.nextLine();

    oppchoice = mR.nextInt(3) + 1;
    if (oppchoice == 1) {
        hischoice = rock;
    }
    if (oppchoice == 2) {
        hischoice = paper;
    }
    if (oppchoice == 3) {
        hischoice = scissors;
    }
    System.out.println(hischoice);

    if ((hischoice == rock) && (whichpick == paper)) {
        System.out.println("You win! :)");
    }
    if ((hischoice == paper) && (whichpick == scissors)) {
        System.out.println("You win! :)");
    }
    if ((hischoice == scissors) && (whichpick == rock)) {
        System.out.println("You win! :)");
    }
    if ((hischoice == rock) && (whichpick == scissors)) {
        System.out.println("You lose! :(");
    }
    if ((hischoice == paper) && (whichpick == rock)) {
        System.out.println("You lose! :(");
    }
    if ((hischoice == scissors) && (whichpick == paper)) {
        System.out.println("You lose! :(");
    }
    if ((hischoice == rock) && (whichpick == rock)) {
        System.out.println("It's a tie! :|");
    }
    if ((hischoice == scissors) && (whichpick == scissors)) {
        System.out.println("It's a tie! :|");
    }
    if ((hischoice == paper) && (whichpick == paper)) {
        System.out.println("It's a tie! :|");
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:20:28.637

操作员检查两个`==`对象是否完全相同。两个字符串是不同的对象，但具有相同的值（其中包含完全相同的字符）。因此，使用任`.equals()`一方法来比较字符串是否相等或使用该`.compareTo()`方法来测试不相等的比较。在这种情况下，使用`.equals()`.

所以这是应该怎么做的

```
if ((hischoice.equals(rock)) && (whichpick.equals(rock))) {
        System.out.println("It's a tie! :|");
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T01:33:57.223

其余答案都是正确的，您需要使用 equals 方法来比较两个 String 对象或任何其他对象。

我还建议您将这些 if 语句压缩为 1 从它应该如下所示：

```
if ((hischoice.equals(rock)) && (whichpick.equals(rock))) {
        System.out.println("It's a tie! :|");
    }
    if ((hischoice.equals(scissors)) && (whichpick.equals(scissors))) {
        System.out.println("It's a tie! :|");
    }
    if((hischoice.equals(paper)) && (whichpick.equals(paper))){
        System.out.println("It's a tie! :|");
    } 
```

到以下：

```
if (hischoice.equals(whichpick )) {
    System.out.println("It's a tie! :|");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T00:12:26.577

您应该使用 .equals() 进行字符串比较

# java - 如何读取 .pem 文件以获取私钥和 公钥

> ID：11787571
> 
> 赞同：89
> 
> 时间：2012-08-03T00:09:55.423
> 
> 标签：java, openssl, x509, pem, pkcs#8

我正在编写一小段代码，它读取存储在 .pem 文件中的公钥和私钥。我正在使用以下命令来生成密钥。

下面的命令生成一对密钥。

```
 $openssl genrsa -out mykey.pem 2048 
```

此命令生成私钥

```
$openssl pkcs8 -topk8 -inform PEM -outform PEM -in mykey.pem \
    -out private_key.pem -nocrypt 
```

和这个命令来获取公钥。

```
$ openssl rsa -in mykey.pem -pubout -outform DER -out public_key.der 
```

我写了两种分别读取私钥和公钥的方法。

```
 public  PrivateKey getPemPrivateKey(String filename, String algorithm) throws Exception {
      File f = new File(filename);
      FileInputStream fis = new FileInputStream(f);
      DataInputStream dis = new DataInputStream(fis);
      byte[] keyBytes = new byte[(int) f.length()];
      dis.readFully(keyBytes);
      dis.close();

      String temp = new String(keyBytes);
      String privKeyPEM = temp.replace("-----BEGIN PRIVATE KEY-----\n", "");
      privKeyPEM = privKeyPEM.replace("-----END PRIVATE KEY-----", "");
      //System.out.println("Private key\n"+privKeyPEM);

      Base64 b64 = new Base64();
      byte [] decoded = b64.decode(privKeyPEM);

      PKCS8EncodedKeySpec spec = new PKCS8EncodedKeySpec(decoded);
      KeyFactory kf = KeyFactory.getInstance(algorithm);
      return kf.generatePrivate(spec);
      }

   public  PublicKey getPemPublicKey(String filename, String algorithm) throws Exception {
      File f = new File(filename);
      FileInputStream fis = new FileInputStream(f);
      DataInputStream dis = new DataInputStream(fis);
      byte[] keyBytes = new byte[(int) f.length()];
      dis.readFully(keyBytes);
      dis.close();

      String temp = new String(keyBytes);
      String publicKeyPEM = temp.replace("-----BEGIN PUBLIC KEY-----\n", "");
      publicKeyPEM = publicKeyPEM.replace("-----END PUBLIC KEY-----", "");

      Base64 b64 = new Base64();
      byte [] decoded = b64.decode(publicKeyPEM);

      X509EncodedKeySpec spec =
            new X509EncodedKeySpec(decoded);
      KeyFactory kf = KeyFactory.getInstance(algorithm);
      return kf.generatePublic(spec);
      } 
```

我觉得这是一种幼稚的做法。我无法通过互联网获得更好的方法。谁能建议我编写相同代码来处理通用案例的最佳方法是什么。我不想使用任何类型的第三方库。
我对唱歌/加密有非常基本的了解，几乎不使用任何 Java 安全 API。因此，如果我在某处没有意义，请指出。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-12-23T13:49:05.277

**试试这门课。**

```
package groovy;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.io.UnsupportedEncodingException;
import java.security.GeneralSecurityException;
import java.security.InvalidKeyException;
import java.security.KeyFactory;
import java.security.NoSuchAlgorithmException;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.Signature;
import java.security.SignatureException;
import java.security.interfaces.RSAPrivateKey;
import java.security.interfaces.RSAPublicKey;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;

import javax.crypto.Cipher;

import org.apache.commons.codec.binary.Base64;

public class RSA {

private static String getKey(String filename) throws IOException {
    // Read key from file
    String strKeyPEM = "";
    BufferedReader br = new BufferedReader(new FileReader(filename));
    String line;
    while ((line = br.readLine()) != null) {
        strKeyPEM += line + "\n";
    }
    br.close();
    return strKeyPEM;
}
public static RSAPrivateKey getPrivateKey(String filename) throws IOException, GeneralSecurityException {
    String privateKeyPEM = getKey(filename);
    return getPrivateKeyFromString(privateKeyPEM);
}

public static RSAPrivateKey getPrivateKeyFromString(String key) throws IOException, GeneralSecurityException {
    String privateKeyPEM = key;
    privateKeyPEM = privateKeyPEM.replace("-----BEGIN PRIVATE KEY-----\n", "");
    privateKeyPEM = privateKeyPEM.replace("-----END PRIVATE KEY-----", "");
    byte[] encoded = Base64.decodeBase64(privateKeyPEM);
    KeyFactory kf = KeyFactory.getInstance("RSA");
    PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(encoded);
    RSAPrivateKey privKey = (RSAPrivateKey) kf.generatePrivate(keySpec);
    return privKey;
}

public static RSAPublicKey getPublicKey(String filename) throws IOException, GeneralSecurityException {
    String publicKeyPEM = getKey(filename);
    return getPublicKeyFromString(publicKeyPEM);
}

public static RSAPublicKey getPublicKeyFromString(String key) throws IOException, GeneralSecurityException {
    String publicKeyPEM = key;
    publicKeyPEM = publicKeyPEM.replace("-----BEGIN PUBLIC KEY-----\n", "");
    publicKeyPEM = publicKeyPEM.replace("-----END PUBLIC KEY-----", "");
    byte[] encoded = Base64.decodeBase64(publicKeyPEM);
    KeyFactory kf = KeyFactory.getInstance("RSA");
    RSAPublicKey pubKey = (RSAPublicKey) kf.generatePublic(new X509EncodedKeySpec(encoded));
    return pubKey;
}

public static String sign(PrivateKey privateKey, String message) throws NoSuchAlgorithmException, InvalidKeyException, SignatureException, UnsupportedEncodingException {
    Signature sign = Signature.getInstance("SHA1withRSA");
    sign.initSign(privateKey);
    sign.update(message.getBytes("UTF-8"));
    return new String(Base64.encodeBase64(sign.sign()), "UTF-8");
}

public static boolean verify(PublicKey publicKey, String message, String signature) throws SignatureException, NoSuchAlgorithmException, UnsupportedEncodingException, InvalidKeyException {
    Signature sign = Signature.getInstance("SHA1withRSA");
    sign.initVerify(publicKey);
    sign.update(message.getBytes("UTF-8"));
    return sign.verify(Base64.decodeBase64(signature.getBytes("UTF-8")));
}

public static String encrypt(String rawText, PublicKey publicKey) throws IOException, GeneralSecurityException {
    Cipher cipher = Cipher.getInstance("RSA");
    cipher.init(Cipher.ENCRYPT_MODE, publicKey);
    return Base64.encodeBase64String(cipher.doFinal(rawText.getBytes("UTF-8")));
}

public static String decrypt(String cipherText, PrivateKey privateKey) throws IOException, GeneralSecurityException {
    Cipher cipher = Cipher.getInstance("RSA");
    cipher.init(Cipher.DECRYPT_MODE, privateKey);
    return new String(cipher.doFinal(Base64.decodeBase64(cipherText)), "UTF-8");
}
}

Required jar library "common-codec-1.6" 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2018-04-10T12:04:17.370

Java 9+：

```
private byte[] loadPEM(String resource) throws IOException {
    URL url = getClass().getResource(resource);
    InputStream in = url.openStream();
    String pem = new String(in.readAllBytes(), StandardCharsets.ISO_8859_1);
    Pattern parse = Pattern.compile("(?m)(?s)^---*BEGIN.*---*$(.*)^---*END.*---*$.*");
    String encoded = parse.matcher(pem).replaceFirst("$1");
    return Base64.getMimeDecoder().decode(encoded);
}

@Test
public void test() throws Exception {
    KeyFactory kf = KeyFactory.getInstance("RSA");
    CertificateFactory cf = CertificateFactory.getInstance("X.509");
    PrivateKey key = kf.generatePrivate(new PKCS8EncodedKeySpec(loadPEM("test.key")));
    PublicKey pub = kf.generatePublic(new X509EncodedKeySpec(loadPEM("test.pub")));
    Certificate crt = cf.generateCertificate(getClass().getResourceAsStream("test.crt"));
} 
```

爪哇 8：

将`in.readAllBytes()`调用替换为对此的调用：

```
byte[] readAllBytes(InputStream in) throws IOException {
    ByteArrayOutputStream baos= new ByteArrayOutputStream();
    byte[] buf = new byte[1024];
    for (int read=0; read != -1; read = in.read(buf)) { baos.write(buf, 0, read); }
    return baos.toByteArray();
} 
```

感谢 Daniel 注意到 API 兼容性问题

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-10-03T18:19:27.420

一种选择是使用 bouncycastle 的[PEMParser](http://www.bouncycastle.org/docs/pkixdocs1.5on/org/bouncycastle/openssl/PEMParser.html)：

> 用于解析包含 X509 证书、PKCS8 编码密钥和 PKCS7 对象的 OpenSSL PEM 编码流的类。
> 
> 对于 PKCS7 对象，阅读器将返回一个 CMS ContentInfo 对象。公钥将作为格式正确的 SubjectPublicKeyInfo 对象返回，私钥将作为格式正确的 PrivateKeyInfo 对象返回。在私钥的情况下，如果编码同时包含私钥和公钥定义，则通常会返回 PEMKeyPair。CRL、证书、PKCS#10 请求和属性证书将生成适当的 BC 持有者类。

以下是使用[Parser 测试代码](https://github.com/bcgit/bc-java/blob/53d17ef99e30c6bd49e6eec9235e3eefca6a222d/pkix/src/test/java/org/bouncycastle/openssl/test/ParserTest.java)的示例：

```
package org.bouncycastle.openssl.test;

import java.io.BufferedReader;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.io.Reader;
import java.math.BigInteger;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.SecureRandom;
import java.security.Security;
import java.security.Signature;
import java.security.interfaces.DSAPrivateKey;
import java.security.interfaces.RSAPrivateCrtKey;
import java.security.interfaces.RSAPrivateKey;

import org.bouncycastle.asn1.ASN1ObjectIdentifier;
import org.bouncycastle.asn1.cms.CMSObjectIdentifiers;
import org.bouncycastle.asn1.cms.ContentInfo;
import org.bouncycastle.asn1.pkcs.PrivateKeyInfo;
import org.bouncycastle.asn1.x509.SubjectPublicKeyInfo;
import org.bouncycastle.asn1.x9.ECNamedCurveTable;
import org.bouncycastle.asn1.x9.X9ECParameters;
import org.bouncycastle.cert.X509CertificateHolder;
import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.bouncycastle.openssl.PEMDecryptorProvider;
import org.bouncycastle.openssl.PEMEncryptedKeyPair;
import org.bouncycastle.openssl.PEMKeyPair;
import org.bouncycastle.openssl.PEMParser;
import org.bouncycastle.openssl.PEMWriter;
import org.bouncycastle.openssl.PasswordFinder;
import org.bouncycastle.openssl.jcajce.JcaPEMKeyConverter;
import org.bouncycastle.openssl.jcajce.JceOpenSSLPKCS8DecryptorProviderBuilder;
import org.bouncycastle.openssl.jcajce.JcePEMDecryptorProviderBuilder;
import org.bouncycastle.operator.InputDecryptorProvider;
import org.bouncycastle.pkcs.PKCS8EncryptedPrivateKeyInfo;
import org.bouncycastle.util.test.SimpleTest;

/**
 * basic class for reading test.pem - the password is "secret"
 */
public class ParserTest
    extends SimpleTest
{
    private static class Password
        implements PasswordFinder
    {
        char[]  password;

        Password(
            char[] word)
        {
            this.password = word;
        }

        public char[] getPassword()
        {
            return password;
        }
    }

    public String getName()
    {
        return "PEMParserTest";
    }

    private PEMParser openPEMResource(
        String          fileName)
    {
        InputStream res = this.getClass().getResourceAsStream(fileName);
        Reader fRd = new BufferedReader(new InputStreamReader(res));
        return new PEMParser(fRd);
    }

    public void performTest()
        throws Exception
    {
        PEMParser       pemRd = openPEMResource("test.pem");
        Object          o;
        PEMKeyPair      pemPair;
        KeyPair         pair;

        while ((o = pemRd.readObject()) != null)
        {
            if (o instanceof KeyPair)
            {
                //pair = (KeyPair)o;

                //System.out.println(pair.getPublic());
                //System.out.println(pair.getPrivate());
            }
            else
            {
                //System.out.println(o.toString());
            }
        }

        // test bogus lines before begin are ignored.
        pemRd = openPEMResource("extratest.pem");

        while ((o = pemRd.readObject()) != null)
        {
            if (!(o instanceof X509CertificateHolder))
            {
                fail("wrong object found");
            }
        }

        //
        // pkcs 7 data
        //
        pemRd = openPEMResource("pkcs7.pem");
        ContentInfo d = (ContentInfo)pemRd.readObject();

        if (!d.getContentType().equals(CMSObjectIdentifiers.envelopedData))
        {
            fail("failed envelopedData check");
        }

        //
        // ECKey
        //
        pemRd = openPEMResource("eckey.pem");
        ASN1ObjectIdentifier ecOID = (ASN1ObjectIdentifier)pemRd.readObject();
        X9ECParameters ecSpec = ECNamedCurveTable.getByOID(ecOID);

        if (ecSpec == null)
        {
            fail("ecSpec not found for named curve");
        }

        pemPair = (PEMKeyPair)pemRd.readObject();

        pair = new JcaPEMKeyConverter().setProvider("BC").getKeyPair(pemPair);

        Signature sgr = Signature.getInstance("ECDSA", "BC");

        sgr.initSign(pair.getPrivate());

        byte[] message = new byte[] { (byte)'a', (byte)'b', (byte)'c' };

        sgr.update(message);

        byte[]  sigBytes = sgr.sign();

        sgr.initVerify(pair.getPublic());

        sgr.update(message);

        if (!sgr.verify(sigBytes))
        {
            fail("EC verification failed");
        }

        if (!pair.getPublic().getAlgorithm().equals("ECDSA"))
        {
            fail("wrong algorithm name on public got: " + pair.getPublic().getAlgorithm());
        }

        if (!pair.getPrivate().getAlgorithm().equals("ECDSA"))
        {
            fail("wrong algorithm name on private");
        }

        //
        // ECKey -- explicit parameters
        //
        pemRd = openPEMResource("ecexpparam.pem");
        ecSpec = (X9ECParameters)pemRd.readObject();

        pemPair = (PEMKeyPair)pemRd.readObject();

        pair = new JcaPEMKeyConverter().setProvider("BC").getKeyPair(pemPair);

        sgr = Signature.getInstance("ECDSA", "BC");

        sgr.initSign(pair.getPrivate());

        message = new byte[] { (byte)'a', (byte)'b', (byte)'c' };

        sgr.update(message);

        sigBytes = sgr.sign();

        sgr.initVerify(pair.getPublic());

        sgr.update(message);

        if (!sgr.verify(sigBytes))
        {
            fail("EC verification failed");
        }

        if (!pair.getPublic().getAlgorithm().equals("ECDSA"))
        {
            fail("wrong algorithm name on public got: " + pair.getPublic().getAlgorithm());
        }

        if (!pair.getPrivate().getAlgorithm().equals("ECDSA"))
        {
            fail("wrong algorithm name on private");
        }

        //
        // writer/parser test
        //
        KeyPairGenerator      kpGen = KeyPairGenerator.getInstance("RSA", "BC");

        pair = kpGen.generateKeyPair();

        keyPairTest("RSA", pair);

        kpGen = KeyPairGenerator.getInstance("DSA", "BC");
        kpGen.initialize(512, new SecureRandom());
        pair = kpGen.generateKeyPair();

        keyPairTest("DSA", pair);

        //
        // PKCS7
        //
        ByteArrayOutputStream bOut = new ByteArrayOutputStream();
        PEMWriter             pWrt = new PEMWriter(new OutputStreamWriter(bOut));

        pWrt.writeObject(d);

        pWrt.close();

        pemRd = new PEMParser(new InputStreamReader(new ByteArrayInputStream(bOut.toByteArray())));
        d = (ContentInfo)pemRd.readObject();

        if (!d.getContentType().equals(CMSObjectIdentifiers.envelopedData))
        {
            fail("failed envelopedData recode check");
        }

        // OpenSSL test cases (as embedded resources)
        doOpenSslDsaTest("unencrypted");
        doOpenSslRsaTest("unencrypted");

        doOpenSslTests("aes128");
        doOpenSslTests("aes192");
        doOpenSslTests("aes256");
        doOpenSslTests("blowfish");
        doOpenSslTests("des1");
        doOpenSslTests("des2");
        doOpenSslTests("des3");
        doOpenSslTests("rc2_128");

        doOpenSslDsaTest("rc2_40_cbc");
        doOpenSslRsaTest("rc2_40_cbc");
        doOpenSslDsaTest("rc2_64_cbc");
        doOpenSslRsaTest("rc2_64_cbc");

        doDudPasswordTest("7fd98", 0, "corrupted stream - out of bounds length found");
        doDudPasswordTest("ef677", 1, "corrupted stream - out of bounds length found");
        doDudPasswordTest("800ce", 2, "unknown tag 26 encountered");
        doDudPasswordTest("b6cd8", 3, "DEF length 81 object truncated by 56");
        doDudPasswordTest("28ce09", 4, "DEF length 110 object truncated by 28");
        doDudPasswordTest("2ac3b9", 5, "DER length more than 4 bytes: 11");
        doDudPasswordTest("2cba96", 6, "DEF length 100 object truncated by 35");
        doDudPasswordTest("2e3354", 7, "DEF length 42 object truncated by 9");
        doDudPasswordTest("2f4142", 8, "DER length more than 4 bytes: 14");
        doDudPasswordTest("2fe9bb", 9, "DER length more than 4 bytes: 65");
        doDudPasswordTest("3ee7a8", 10, "DER length more than 4 bytes: 57");
        doDudPasswordTest("41af75", 11, "unknown tag 16 encountered");
        doDudPasswordTest("1704a5", 12, "corrupted stream detected");
        doDudPasswordTest("1c5822", 13, "unknown object in getInstance: org.bouncycastle.asn1.DERUTF8String");
        doDudPasswordTest("5a3d16", 14, "corrupted stream detected");
        doDudPasswordTest("8d0c97", 15, "corrupted stream detected");
        doDudPasswordTest("bc0daf", 16, "corrupted stream detected");
        doDudPasswordTest("aaf9c4d",17, "corrupted stream - out of bounds length found");

        doNoPasswordTest();

        // encrypted private key test
        InputDecryptorProvider pkcs8Prov = new JceOpenSSLPKCS8DecryptorProviderBuilder().build("password".toCharArray());
        pemRd = openPEMResource("enckey.pem");

        PKCS8EncryptedPrivateKeyInfo encPrivKeyInfo = (PKCS8EncryptedPrivateKeyInfo)pemRd.readObject();
        JcaPEMKeyConverter   converter = new JcaPEMKeyConverter().setProvider("BC");

        RSAPrivateCrtKey privKey = (RSAPrivateCrtKey)converter.getPrivateKey(encPrivKeyInfo.decryptPrivateKeyInfo(pkcs8Prov));

        if (!privKey.getPublicExponent().equals(new BigInteger("10001", 16)))
        {
            fail("decryption of private key data check failed");
        }

        // general PKCS8 test

        pemRd = openPEMResource("pkcs8test.pem");

        Object privInfo;

        while ((privInfo = pemRd.readObject()) != null)
        {
            if (privInfo instanceof PrivateKeyInfo)
            {
                privKey = (RSAPrivateCrtKey)converter.getPrivateKey(PrivateKeyInfo.getInstance(privInfo));
            }
            else
            {
                privKey = (RSAPrivateCrtKey)converter.getPrivateKey(((PKCS8EncryptedPrivateKeyInfo)privInfo).decryptPrivateKeyInfo(pkcs8Prov));
            }
            if (!privKey.getPublicExponent().equals(new BigInteger("10001", 16)))
            {
                fail("decryption of private key data check failed");
            }
        }
    }

    private void keyPairTest(
        String   name,
        KeyPair pair) 
        throws IOException
    {
        PEMParser pemRd;
        ByteArrayOutputStream bOut = new ByteArrayOutputStream();
        PEMWriter             pWrt = new PEMWriter(new OutputStreamWriter(bOut));

        pWrt.writeObject(pair.getPublic());

        pWrt.close();

        pemRd = new PEMParser(new InputStreamReader(new ByteArrayInputStream(bOut.toByteArray())));

        SubjectPublicKeyInfo pub = SubjectPublicKeyInfo.getInstance(pemRd.readObject());
        JcaPEMKeyConverter   converter = new JcaPEMKeyConverter().setProvider("BC");

        PublicKey k = converter.getPublicKey(pub);

        if (!k.equals(pair.getPublic()))
        {
            fail("Failed public key read: " + name);
        }

        bOut = new ByteArrayOutputStream();
        pWrt = new PEMWriter(new OutputStreamWriter(bOut));

        pWrt.writeObject(pair.getPrivate());

        pWrt.close();

        pemRd = new PEMParser(new InputStreamReader(new ByteArrayInputStream(bOut.toByteArray())));

        KeyPair kPair = converter.getKeyPair((PEMKeyPair)pemRd.readObject());
        if (!kPair.getPrivate().equals(pair.getPrivate()))
        {
            fail("Failed private key read: " + name);
        }

        if (!kPair.getPublic().equals(pair.getPublic()))
        {
            fail("Failed private key public read: " + name);
        }
    }

    private void doOpenSslTests(
        String baseName)
        throws IOException
    {
        doOpenSslDsaModesTest(baseName);
        doOpenSslRsaModesTest(baseName);
    }

    private void doOpenSslDsaModesTest(
        String baseName)
        throws IOException
    {
        doOpenSslDsaTest(baseName + "_cbc");
        doOpenSslDsaTest(baseName + "_cfb");
        doOpenSslDsaTest(baseName + "_ecb");
        doOpenSslDsaTest(baseName + "_ofb");
    }

    private void doOpenSslRsaModesTest(
        String baseName)
        throws IOException
    {
        doOpenSslRsaTest(baseName + "_cbc");
        doOpenSslRsaTest(baseName + "_cfb");
        doOpenSslRsaTest(baseName + "_ecb");
        doOpenSslRsaTest(baseName + "_ofb");
    }

    private void doOpenSslDsaTest(
        String name)
        throws IOException
    {
        String fileName = "dsa/openssl_dsa_" + name + ".pem";

        doOpenSslTestFile(fileName, DSAPrivateKey.class);
    }

    private void doOpenSslRsaTest(
        String name)
        throws IOException
    {
        String fileName = "rsa/openssl_rsa_" + name + ".pem";

        doOpenSslTestFile(fileName, RSAPrivateKey.class);
    }

    private void doOpenSslTestFile(
        String  fileName,
        Class   expectedPrivKeyClass)
        throws IOException
    {
        JcaPEMKeyConverter   converter = new JcaPEMKeyConverter().setProvider("BC");
        PEMDecryptorProvider decProv = new JcePEMDecryptorProviderBuilder().setProvider("BC").build("changeit".toCharArray());
        PEMParser pr = openPEMResource("data/" + fileName);
        Object o = pr.readObject();

        if (o == null || !((o instanceof PEMKeyPair) || (o instanceof PEMEncryptedKeyPair)))
        {
            fail("Didn't find OpenSSL key");
        }

        KeyPair kp = (o instanceof PEMEncryptedKeyPair) ?
            converter.getKeyPair(((PEMEncryptedKeyPair)o).decryptKeyPair(decProv)) : converter.getKeyPair((PEMKeyPair)o);

        PrivateKey privKey = kp.getPrivate();

        if (!expectedPrivKeyClass.isInstance(privKey))
        {
            fail("Returned key not of correct type");
        }
    }

    private void doDudPasswordTest(String password, int index, String message)
    {
        // illegal state exception check - in this case the wrong password will
        // cause an underlying class cast exception.
        try
        {
            PEMDecryptorProvider decProv = new JcePEMDecryptorProviderBuilder().setProvider("BC").build(password.toCharArray());

            PEMParser pemRd = openPEMResource("test.pem");
            Object o;

            while ((o = pemRd.readObject()) != null)
            {
                if (o instanceof PEMEncryptedKeyPair)
                {
                    ((PEMEncryptedKeyPair)o).decryptKeyPair(decProv);
                }
            }

            fail("issue not detected: " + index);
        }
        catch (IOException e)
        {
            if (e.getCause() != null && !e.getCause().getMessage().endsWith(message))
            {
               fail("issue " + index + " exception thrown, but wrong message");
            }
            else if (e.getCause() == null && !e.getMessage().equals(message))
            {
                               e.printStackTrace();
               fail("issue " + index + " exception thrown, but wrong message");
            }
        }
    }

    private void doNoPasswordTest()
        throws IOException
    {
        PEMDecryptorProvider decProv = new JcePEMDecryptorProviderBuilder().setProvider("BC").build("".toCharArray());

        PEMParser pemRd = openPEMResource("smimenopw.pem");
        Object o;
        PrivateKeyInfo key = null;

        while ((o = pemRd.readObject()) != null)
        {
             key = (PrivateKeyInfo)o;
        }

        if (key == null)
        {
            fail("private key not detected");
        }
    }

    public static void main(
        String[]    args)
    {
        Security.addProvider(new BouncyCastleProvider());

        runTest(new ParserTest());
    }
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-01-05T22:57:36.640

嗯，我的代码和你的一样，差别不大......

```
public static X509Certificate loadPublicX509(String fileName) 
        throws GeneralSecurityException {
    InputStream is = null;
    X509Certificate crt = null;
    try {
        is = fileName.getClass().getResourceAsStream("/" + fileName);
        CertificateFactory cf = CertificateFactory.getInstance("X.509");
        crt = (X509Certificate)cf.generateCertificate(is);
    } finally {
        closeSilent(is);
    }
    return crt;
}

public static PrivateKey loadPrivateKey(String fileName) 
        throws IOException, GeneralSecurityException {
    PrivateKey key = null;
    InputStream is = null;
    try {
        is = fileName.getClass().getResourceAsStream("/" + fileName);
        BufferedReader br = new BufferedReader(new InputStreamReader(is));
        StringBuilder builder = new StringBuilder();
        boolean inKey = false;
        for (String line = br.readLine(); line != null; line = br.readLine()) {
            if (!inKey) {
                if (line.startsWith("-----BEGIN ") && 
                        line.endsWith(" PRIVATE KEY-----")) {
                    inKey = true;
                }
                continue;
            }
            else {
                if (line.startsWith("-----END ") && 
                        line.endsWith(" PRIVATE KEY-----")) {
                    inKey = false;
                    break;
                }
                builder.append(line);
            }
        }
        //
        byte[] encoded = DatatypeConverter.parseBase64Binary(builder.toString());
        PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(encoded);
        KeyFactory kf = KeyFactory.getInstance("RSA");
        key = kf.generatePrivate(keySpec);
    } finally {
        closeSilent(is);
    }
    return key;
}

public static void closeSilent(final InputStream is) {
    if (is == null) return;
    try { is.close(); } catch (Exception ign) {}
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-10-22T14:31:15.283

Java 支持将 DER 用于开箱即用的公钥和私钥（这与 OP 要求的 PEM 基本相同，除了 PEM 文件包含 base 64 数据以及页眉和页脚行）。

如果您使用的是 Java 8+（假设您的密钥文件在类路径中可用），则可以在没有任何外部库的情况下依赖此代码（模异常处理）：

```
class Signer {
    private KeyFactory keyFactory;

    public Signer() {
        this.keyFactory = KeyFactory.getInstance("RSA");
    }

    public PublicKey getPublicKey() {
        byte[] publicKey = readFileAsBytes("public-key.der");

        X509EncodedKeySpec keySpec = new X509EncodedKeySpec(publicKey);

        return keyFactory.generatePublic(keySpec);
    }

    public PrivateKey getPrivateKey() {
        byte[] privateKey = readFileAsBytes("private-key.der");

        PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(privateKey);

        return keyFactory.generatePrivate(keySpec);
    }

    private URI readFileAsBytes(String name) {
        URI fileUri = getClass().getClassLoader().getResource(name).toURI();

        return Files.readAllBytes(Paths.get(fileUri));
    }
} 
```

作为记录，您可以使用以下命令将 PEM 密钥转换为 DER 密钥：

```
$ openssl pkcs8 -topk8 -inform PEM -outform DER -in private-key.pem -out private-key.der -nocrypt 
```

并通过以下方式获取 DER 中的公钥：

```
$ openssl rsa -in private-key.pem -pubout -outform DER -out public-key.der 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-12-02T20:34:19.293

我认为在您的私钥定义中，您应该替换：

```
X509EncodedKeySpec spec = new X509EncodedKeySpec(decoded); 
```

和：

```
PKCS8EncodedKeySpec spec = new PKCS8EncodedKeySpec(decoded); 
```

看看你的`openssl`命令：

```
$openssl **pkcs8** -topk8 -inform PEM -outform PEM -in mykey.pem \ -out private_key.pem -nocrypt 
```

还有java异常：

```
Only PCKS8 codification 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-01-27T17:07:36.713

Java libs 使它几乎成为读取由 openssl 生成的公共证书的单行程序：

```
val certificate: X509Certificate = ByteArrayInputStream(
        publicKeyCert.toByteArray(Charsets.US_ASCII))
        .use {
            CertificateFactory.getInstance("X.509")
                    .generateCertificate(it) as X509Certificate
        } 
```

但是，天哪，读取私钥是有问题的：

1.  首先必须删除开始和结束标签，这在读取公钥时不是必需的。
2.  然后我必须删除所有新行，否则它会发出嘶哑的声音！
3.  然后我不得不使用字节 64 解码回字节
4.  然后我能够制作一个`RSAPrivateKey`.

看到这个：[kotlin 中的最终解决方案](https://gist.github.com/darkstone/5fe9867b7fff499bed37c39467ba8a62)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-02-07T08:24:27.787

从 pem（PK 或 Cert）读取公钥。取决于 Bouncycastle。

```
private static PublicKey getPublicKeyFromPEM(Reader reader) throws IOException {

    PublicKey key;

    try (PEMParser pem = new PEMParser(reader)) {
        JcaPEMKeyConverter jcaPEMKeyConverter = new JcaPEMKeyConverter();
        Object pemContent = pem.readObject();
        if (pemContent instanceof PEMKeyPair) {
            PEMKeyPair pemKeyPair = (PEMKeyPair) pemContent;
            KeyPair keyPair = jcaPEMKeyConverter.getKeyPair(pemKeyPair);
            key = keyPair.getPublic();
        } else if (pemContent instanceof SubjectPublicKeyInfo) {
            SubjectPublicKeyInfo keyInfo = (SubjectPublicKeyInfo) pemContent;
            key = jcaPEMKeyConverter.getPublicKey(keyInfo);
        } else if (pemContent instanceof X509CertificateHolder) {
            X509CertificateHolder cert = (X509CertificateHolder) pemContent;
            key = jcaPEMKeyConverter.getPublicKey(cert.getSubjectPublicKeyInfo());
        } else {
            throw new IllegalArgumentException("Unsupported public key format '" +
                pemContent.getClass().getSimpleName() + '"');
        }
    }

    return key;
} 
```

从 PEM 读取私钥：

```
private static PrivateKey getPrivateKeyFromPEM(Reader reader) throws IOException {

    PrivateKey key;

    try (PEMParser pem = new PEMParser(reader)) {
        JcaPEMKeyConverter jcaPEMKeyConverter = new JcaPEMKeyConverter();
        Object pemContent = pem.readObject();
        if (pemContent instanceof PEMKeyPair) {
            PEMKeyPair pemKeyPair = (PEMKeyPair) pemContent;
            KeyPair keyPair = jcaPEMKeyConverter.getKeyPair(pemKeyPair);
            key = keyPair.getPrivate();
        } else if (pemContent instanceof PrivateKeyInfo) {
            PrivateKeyInfo privateKeyInfo = (PrivateKeyInfo) pemContent;
            key = jcaPEMKeyConverter.getPrivateKey(privateKeyInfo);
        } else {
            throw new IllegalArgumentException("Unsupported private key format '" +
                pemContent.getClass().getSimpleName() + '"');
        }
    }

    return key;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-08T10:39:43.147

要获取公钥，您可以简单地执行以下操作：

```
public static PublicKey getPublicKeyFromCertFile(final String certfile){

     return new X509CertImpl(new FileInputStream(new File(certfile))).getPublicKey(); 
```

要获取私钥比较棘手，您可以：

```
public static PrivateKey getPrivateKeyFromKeyFile(final String keyfile){
    try {
        Process p;
        p = Runtime.getRuntime().exec("openssl pkcs8 -nocrypt -topk8 -inform PEM " +
                "-in " + keyfile + " -outform DER -out " + keyfile + ".der");

        p.waitFor();
        System.out.println("Command executed" + (p.exitValue() == 0 ? " successfully" : " with error" ));
    } catch ( IOException | InterruptedException e) {
        e.printStackTrace();
        System.exit(1);
    }

    PrivateKey myPrivKey = null;
    try {
        byte[] keyArray = Files.readAllBytes(Paths.get(keyfile + ".der"));
        PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(keyArray);
        KeyFactory keyFactory = KeyFactory.getInstance("RSA");
        myPrivKey = keyFactory.generatePrivate(keySpec);
    } catch (IOException | NoSuchAlgorithmException | InvalidKeySpecException e){
        e.printStackTrace();
        System.exit(1);
    }

    return myPrivKey;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-11-05T01:33:16.303

如果 PEM 仅包含一个未加密的 RSA 私钥，则它必须是包含 9 个数字的 ASN.1 序列结构才能呈现*中国剩余定理*（CRT）密钥：

1.  版本（始终为 0）
2.  模数 (n)
3.  公共指数（e，始终为 65537）
4.  私人指数 (d)
5.  素数 p
6.  素数
7.  d mod (p - 1) (dp)
8.  d mod (q - 1) (dq)
9.  q^-1 mod p (qinv)

我们可以实现一个`RSAPrivateCrtKey`：

```
class RSAPrivateCrtKeyImpl implements RSAPrivateCrtKey {
    private static final long serialVersionUID = 1L;

    BigInteger n, e, d, p, q, dp, dq, qinv;

    @Override
    public BigInteger getModulus() {
        return n;
    }

    @Override
    public BigInteger getPublicExponent() {
        return e;
    }

    @Override
    public BigInteger getPrivateExponent() {
        return d;
    }

    @Override
    public BigInteger getPrimeP() {
        return p;
    }

    @Override
    public BigInteger getPrimeQ() {
        return q;
    }

    @Override
    public BigInteger getPrimeExponentP() {
        return dp;
    }

    @Override
    public BigInteger getPrimeExponentQ() {
        return dq;
    }

    @Override
    public BigInteger getCrtCoefficient() {
        return qinv;
    }

    @Override
    public String getAlgorithm() {
        return "RSA";
    }

    @Override
    public String getFormat() {
        throw new UnsupportedOperationException();
    }

    @Override
    public byte[] getEncoded() {
        throw new UnsupportedOperationException();
    }
} 
```

然后从 PEM 文件中读取私钥：

```
import sun.security.util.DerInputStream;
import sun.security.util.DerValue;

static RSAPrivateCrtKey getRSAPrivateKey(String keyFile) {
    RSAPrivateCrtKeyImpl prvKey = new RSAPrivateCrtKeyImpl();
    try (BufferedReader in = new BufferedReader(new FileReader(keyFile))) {
        StringBuilder sb = new StringBuilder();
        String line;
        while ((line = in.readLine()) != null) {
            // skip "-----BEGIN/END RSA PRIVATE KEY-----"
            if (!line.startsWith("--") || !line.endsWith("--")) {
                sb.append(line);
            }
        }
        DerInputStream der = new DerValue(Base64.
                getDecoder().decode(sb.toString())).getData();
        der.getBigInteger(); // 0
        prvKey.n = der.getBigInteger();
        prvKey.e = der.getBigInteger(); // 65537
        prvKey.d = der.getBigInteger();
        prvKey.p = der.getBigInteger();
        prvKey.q = der.getBigInteger();
        prvKey.dp = der.getBigInteger();
        prvKey.dq = der.getBigInteger();
        prvKey.qinv = der.getBigInteger();
    } catch (IllegalArgumentException | IOException e) {
        logger.warn(keyFile + ": " + e.getMessage());
        return null;
    }
} 
```

# azure - 如何检测或计算 Azure blob 下载量？

> ID：11787579
> 
> 赞同：11
> 
> 时间：2012-08-03T00:11:16.693
> 
> 标签：azure, blob

我有一个作为 Azure blob 发布的软件安装程序，我需要计算它被下载了多少次。

问题是它可以被外部引用（从许多下载站点），因此我无法通过网站控制它。

那么... Windows Azure 是否有一种机制来检测 blob 下载或注册它们的计数？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-03T06:08:02.170

您是否考虑过将您的容器设为私有？这将阻止人们直接下载 blob。通过这样做，您可以完全控制谁可以下载文件以及他们可以下载多长时间。

假设只有注册用户可以下载文件并且您使用的是 ASP.NET MVC。然后你可以有一个类似于这个的动作：

```
 [Authorize]
    public ActionResult Download(string blobName)
    {
        CountDownload(blobName);

        var blobClient = storageAccount.CreateCloudBlobClient();
        var container = blobClient.GetContainerReference(containerName);
        var blob = container.GetBlobReference(blobname);

        var sas = blob.GetSharedAccessSignature
        (
          new SharedAccessPolicy
          {
              Permissions = SharedAccessPermissions.Read,
              SharedAccessStartTime = DateTime.Now.ToUniversalTime(),
              SharedAccessExpiryTime = DateTime.Now.ToUniversalTime().AddHours(1)
          }
        );

        return Content(blob.Uri.AbsoluteUri + sas);
    } 
```

它的作用如下：

*   Authorize 属性确保只有登录的用户才能访问此操作。
*   您增加该 blob 的下载次数
*   您可以根据名称获得 blob 的引用
*   您生成的签名允许下载 blob 1 小时
*   您返回带有签名的 blob 的 url（您也可以将其重定向到 blob url）

通过您的应用程序分发带有签名的 URL，您可以完全控制，您甚至可以查看其他场景，例如验证码、付费下载、应用程序中的高级权限......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-03T08:20:22.223

您可以使用 [存储分析](http://msdn.microsoft.com/en-us/library/windowsazure/hh343258.aspx)来确定您的 blob 有多少下载：

Blob 使用情况也可在新管理门户中以图表形式提供：

![在此处输入图像描述](../Images/00f688a290b851a3a63574fc6db6efdf.png)

# eclipse - Juno (eclipse) 打开窗口行为与以前的版本相比有所改变。有谁知道如何恢复旧的行为？

> ID：11787583
> 
> 赞同：2
> 
> 时间：2012-08-03T00:11:45.587
> 
> 标签：eclipse

在 Linux、Windows 和 Mac 版本的 Eclipse 中，我将并排编辑器窗口作为我的默认开发视角的一部分。在所有三个平台上，打开新类、xml 或其他可编辑文件时的默认行为是在当前活动编辑器之上打开它。（即，如果我在右手编辑器中编辑文件并打开一个类型，它将在右侧打开）。自从升级（？！）我（和我的同事）发现文件总是在左侧打开，无论您是在右侧窗口中还是在左侧窗口中都处于活动状态。

除了降级我的日食之外，有谁知道如何恢复旧行为？已经有这么长时间的原始行为，有一个必须习惯的全新行为是非常烦人的。

我尝试将我的外观设置为经典但没有任何效果。还有其他建议吗？

# php - PHP MYSQL 命令按流行度列出

> ID：11787584
> 
> 赞同：-2
> 
> 时间：2012-08-03T00:12:01.800
> 
> 标签：php, mysql, html, css

我想知道如何对使用 html 设置的有序列表中的内容进行排序。我需要使用 PHP 和 mySQL，所以这个方向的任何提示都会被认真对待。

列表的**html**

```
<div id="right-column-sidebar">
<ol>
<li><a href="#">Title 1</a></li>
<li><a href="#">Title 2</a></li>
<li><a href="#">Title 3</a></li>
<li><a href="#">Title 4</a></li>
<li><a href="#">Title 5</a></li>
<li><a href="#">Title 6</a></li>
<li><a href="#">Title 7</a></li>
<li><a href="#">Title 8</a></li>
<li><a href="#">Title 9</a></li>
<li><a href="#">Title 10</a></li>
<li><a href="#">Title 11</a></li>
<li><a href="#">Title 12</a></li>
<li><a href="#">Title 13</a></li>
<li><a href="#">Title 14</a></li>
<li><a href="#">Title 15</a></li>
<li><a href="#">Title 16</a></li>
<li><a href="#">Title 17</a></li>
<li><a href="#">Title 18</a></li>
<li><a href="#">Title 19</a></li>
<li><a href="#">Title 20</a></li>
</ol>
</div> 
```

所有这些标题都属于同一个类别。欢迎所有提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:29:43.820

```
<div id="right-column-sidebar">
<ol>
<?php
    $link = mysql_connect("localhost", "root", "password");
    mysql_select_db("db", $link);

    $query = "SELECT * FROM table";

    $result = mysql_query($query);

    while ($row = mysql_fetch_array($results)) :
        ?>
        <li> <a href="#"> <?php echo $row['title']; ?> </a></li>
    <?php endwhile; 
?>
</ol>
</div> 
```

这一切都假设您在数据库中有一些数据，`db`并且在表中`table`有一个名为的列`title`，其中包含一堆带有标题的条目。这将遍历结果并显示它们。

当然，对信息进行排序只需要查询中的一些额外信息。

# c# - 在xml文件中搜索数据c#

> ID：11787591
> 
> 赞同：2
> 
> 时间：2012-08-03T00:12:27.913
> 
> 标签：c#, xml, search

我正在尝试在 xml 文件中搜索数据。如果找到，它将弹出`MessageBox`并显示找到的所有数据。

这是我的代码。

```
DataView dv;
        DataSet ds = new DataSet();
        ds.ReadXml("C:\\Users\\HDAdmin\\Documents\\SliceEngine\\SliceEngine\\bin\\Debug\\saya.xml");
        dv = new DataView(ds.Tables[0]);
        dv.Sort = "Name";
        int index = dv.Find("Name");
        if (index == -1)
        {
            MessageBox.Show("Item Not Found");
        }
        else
        {
            MessageBox.Show(dv[index]["Name"].ToString()); 
        } 
```

但它总是说找不到该项目。

然后我试着这样做。

```
 XmlDocument xml = new XmlDocument();            
            xml.Load("C:\\Users\\HDAdmin\\Documents\\SliceEngine\\SliceEngine\\bin\\Debug\\saya.xml");
            XmlNodeList xnList = xml.SelectNodes("/Patient/Patient/Name");
            foreach (XmlNode xn in xnList)
            {
                string name = xn["Name"].InnerText;
                listBox21.Items.Add(name);
} 
```

对于此代码，我尝试将其放入列表框中。通过这样做，它说它是一个空对象。

下面是我的 xml 文件。

```
 <Patient>
       <Patient>
         <Level>0</Level>
         <Name>w</Name>
         <Gender>0</Gender>
      </Patient>
   </Patient> 
```

任何人都可以帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:32:31.840

我个人更喜欢像这样使用 LINQ to XML：

```
// using System.Xml.Linq;

var doc = XDocument.Load(@"C:\path\to\file.xml");
foreach (var child in doc.Descendants("Name"))
{
    MessageBox.Show(child.Value);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T00:30:01.233

您是否尝试过从**XMLDocument**获取子节点？

例如：

```
 // Load up the document
    XmlDocument formXml = new XmlDocument();
    formXml.LoadXml(@"<Patient> 
                      <Patient> 
                        <Level>0</Level> 
                        <Name>w</Name> 
                        <Gender>0</Gender> 
                      </Patient> 
                      </Patient>");

  // get the children nodes from the root
  var children = formXml.ChildNodes;
  // get the first or you can loop through if your xml has more children nodes

  foreach (var child in children)
  {
       listBox21.Items.Add(child.Name); // or something similar
  } 
```

看一下：

*   [http://www.hookdonlinq.com/LINQtoXML5MinuteOverview.ashx](http://www.hookedonlinq.com/LINQtoXML5MinuteOverview.ashx)
*   [http://www.joe-stevens.com/2010/01/08/linq-to-xml-tutorial/](http://www.joe-stevens.com/2010/01/08/linq-to-xml-tutorial/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T00:58:37.700

你必须考虑你的代码是好的！但问题是：

```
xn["Name"].InnerText 
```

因为 xn 代表`/Patient/Patient/Name`，你只需要这样做：

```
xn.InnerText 
```

来获得它的价值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-27T15:06:17.057

除非 xml 文件中有一个叫“名字”的人，

'int index = dv.Find("Name");'

应该

'int index = dv.Find("Joe"); //或其他名称'

# javascript - 让许多元素平滑淡入

> ID：11787592
> 
> 赞同：1
> 
> 时间：2012-08-03T00:12:51.187
> 
> 标签：javascript, css

我有一个画廊页面，其中显示了一大堆照片缩略图（> 50），我希望每张图片在加载时都会淡入。我已经设法让它工作了，但是一旦我试图同时淡入 20 多张左右的图像，淡入效果就会变得非常生涩。有没有更好的方法可以平滑地淡入大量元素？

现在我正在做的是使用 css 转换，所以每个元素最初都有

```
.aThumbnail {
  opacity: 0;
  -webkit-transition: opacity 1s ease-in-out;
} 
```

然后在代码中我做

```
aThumbnail.onload = function(){
  this.style.opacity = 1;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:23:37.930

三种可能：

1.  如果这些是加载时间不长的小图像，那么我建议只淡化前二十个左右。如果您正在谈论可能同时运行数百个动画（因为每个动画都完全取决于加载时间），那么我可以理解为什么这会降低速度。
2.  另一种选择是将您的时间减少到半秒甚至四分之一秒的淡入淡出，以便在其他过渡开始时更快地完成过渡。
3.  最后，为它们的“组”设置不同的类，其中一些组在开始加载之前“暂停”。这样，第 1 组首先加载，完成后，再加载第 2 组，依此类推。

# asp.net-mvc - Linq 和 EF：查询以获取一对多关系的结果：使用外键选择表

> ID：11787594
> 
> 赞同：0
> 
> 时间：2012-08-03T00:13:01.220
> 
> 标签：asp.net-mvc, linq, entity-framework

我盯着 Linq，不知道如何处理这个查询。

我有一个 UserProfile 表。每个 UserProfile 可以有许多图像（UserImages 表）

我的模型（简化）：

```
 public class UserProfile
{
    [Key]
    public int Id { get; set; }
    public string Name  { get; set; }
    public ICollection<Image> UsrImages { get; set; }
}

[Table("ImagesLocation")]
public class UserImages
{   //This is just an Id (and I don't even need it) It is not, from 
    public int Id { get; set; } what I can see, the UserProfile Id foreign key
    public string ImgPath { get; set; }
    public bool? ImgDefault { get; set; }
}

     public class UserProfileDBContext : DbContext
{
public DbSet<UserProfile> UserProfiles { get; set; }
public DbSet<UserImages> userImages { get; set; }
 } 
```

我想要一个类似于以下内容的 linq 查询：

```
select * from dbo.imgLocation where userProfile_id = 1 (or any user id) 
```

这将为特定用户带来一个包含所有“图像”（或图像数据/路径）的列表。我看到 EF 自动在 UserImages 表上创建了一个名为 userProfile_id 的列，但我无法使用 linq 查询它，因为它不存在！

我一直在谷歌上搜索它，但我什么也找不到（添加我尝试过的东西没有意义！..最终，我可以改变我的模型来完成这项工作。我的主要问题是我找不到钥匙/与我的 UserImages 模型上的 UserProfile 相关的外键

关于如何做到这一点的任何提示？谢谢！... PnP

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:36:44.263

为了访问该列，您需要声明一个标量属性和一个匹配的导航属性，以便 EF 可以按照约定检测关系的两端。

```
[Table("ImagesLocation")]
public class UserImages
{   
    public int Id { get; set; }

    public int UserProfileId { get; set; }
    public virtual UserProfile UserProfile { get; set; }

    public string ImgPath { get; set; }
    public bool? ImgDefault { get; set; }
} 
```

然后您可以通过以下方式查询图像

```
var images = db.userImages.Where(i => i.UserProfileId == 1); 
```

# objective-c - Coreplot/Xcode 帮助：在保持可见 X 轴的同时放大网格区域

> ID：11787596
> 
> 赞同：0
> 
> 时间：2012-08-03T00:13:12.860
> 
> 标签：objective-c, xcode, core-plot

我将提供我的核心绘图图的屏幕截图以供参考，但我还不允许（新用户），所以我可以根据要求通过电子邮件发送它。

我有一组数据点，x 值从 1 到 ~150，y 值从 ~300 到 ~450。我想做的是绘制这些点，使用干净的网格覆盖，放大 y 轴（图形 y 轴应该从 y min 开始，而不是 0，然后到 y max），同时仍然保留可见的 x -轴用于参考目的。

我已经非常接近实现我想要的了，但我仍然在为一些事情苦苦挣扎。

首先，我想在y轴和x轴的交点处，以及y轴的顶部，在y轴上打一个标签，以便给用户一个参考点。

为了实现这一点，我开始使用主要的刻度间隔，并对我的数据集运行一些操作来确定最大值和最小值。然而，当我尝试放大（即关注 y-min 和 y max 之间的范围）时，x 轴不再可见。

为了解决这个问题，在网上搜索了一番后，我发现：

axisSet.xAxis.axisConstraints = [CPTConstraints constraintWithLowerOffset:0];

虽然这似乎迫使 x 轴出现，但它似乎也让我的图表有点偏离......在我的第一个 y 轴主要刻度和原点之间只有 3 个次要刻度，没有 y 轴原产地标签。

有谁知道如何实现此偏移，同时强制原点成为第一个主要刻度，并在原点和 y-Max 处显示 y 轴的标签？

作为一个附带问题，有谁知道如何将 x 轴标签显示为整数而不是浮点数（希望截断小数点）？

我将在下面给出我迄今为止所取得的成果的源代码。

谢谢，

布兰登

初始化绘图的源代码：

-(void)initialisePlot {

```
[self setDataMaxAndMins];

// Create a graph object which we will use to host just one scatter plot.
CGRect frame = [self.hostingView bounds];
self.graph = [[CPTXYGraph alloc] initWithFrame:frame];

// Add some padding to the graph, with more at the bottom for axis labels.
self.graph.plotAreaFrame.paddingTop = 50.0f;
self.graph.plotAreaFrame.paddingRight = 50.0f;
self.graph.plotAreaFrame.paddingBottom = 100.0f;
self.graph.plotAreaFrame.paddingLeft = 120.0f;

// Tie the graph we've created with the hosting view.
self.hostingView.hostedGraph = self.graph;

self.hostingView.backgroundColor = [UIColor blackColor];

// Create a line style that we will apply to the axis
CPTMutableLineStyle *axisStyle = [CPTMutableLineStyle lineStyle];
axisStyle.lineColor = [CPTColor grayColor];
axisStyle.lineWidth = 2.0f;

CPTColor * customGray = [CPTColor colorWithComponentRed:0.6f green: 0.6f blue: 0.6f alpha: 1.0f];
CPTMutableLineStyle *gridStyle = [CPTMutableLineStyle lineStyle];
gridStyle.lineColor = customGray;
gridStyle.lineWidth = 2.0f;

//Create plot symbol style
CPTMutableLineStyle * plotStyle = [CPTMutableLineStyle lineStyle];
plotStyle.lineColor = [CPTColor whiteColor];
plotStyle.lineWidth = 2.0f;

// Create a text style that we will use for the axis labels.
CPTMutableTextStyle *textStyle = [CPTMutableTextStyle textStyle];
textStyle.fontName = @"Helvetica";
textStyle.fontSize = 20;
textStyle.color = [CPTColor whiteColor];

// Create the plot symbol we're going to use.
CPTPlotSymbol *plotSymbol = [CPTPlotSymbol ellipsePlotSymbol];
plotSymbol.lineStyle = plotStyle;
plotSymbol.size = CGSizeMake(3.0, 3.0);
//plotSymbol.

// Setup some floats that represent the min/max values on our axis.
float xAxisMin = xMin;
float xAxisMax = xMax + 5;
float yAxisMin = yMin;
float yAxisMax = yMax + 5;

// We modify the graph's plot space to setup the axis' min / max values.
CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)self.graph.defaultPlotSpace;
plotSpace.xRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(xAxisMin) length:CPTDecimalFromFloat(xAxisMax - xAxisMin)];
plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(yAxisMin) length:CPTDecimalFromFloat(yAxisMax - yAxisMin)];

// Modify the graph's axis with a label, line style, etc.
CPTXYAxisSet *axisSet = (CPTXYAxisSet *)self.graph.axisSet;

axisSet.xAxis.title = xAxisTitle;
axisSet.xAxis.titleTextStyle = textStyle;
axisSet.xAxis.titleOffset = 50.0f;
axisSet.xAxis.axisLineStyle = axisStyle;
axisSet.xAxis.majorTickLineStyle = axisStyle;
axisSet.xAxis.minorTickLineStyle = axisStyle;
axisSet.xAxis.labelTextStyle = textStyle;
axisSet.xAxis.labelOffset = 3.0f;
axisSet.xAxis.majorIntervalLength = CPTDecimalFromFloat((xAxisMax - xAxisMin) / 4);//CPTDecimalFromFloat(25.0f);
axisSet.xAxis.minorTicksPerInterval = 4;
axisSet.xAxis.minorTickLength = 5.0f;
axisSet.xAxis.majorTickLength = 7.0f;

axisSet.yAxis.title = [yAxisTitle stringByAppendingString: @" ($M)"];

axisSet.yAxis.titleTextStyle = textStyle;
axisSet.yAxis.titleOffset = 80.0f;
axisSet.yAxis.axisLineStyle = axisStyle;
axisSet.yAxis.majorTickLineStyle = axisStyle;
axisSet.yAxis.minorTickLineStyle = axisStyle;
axisSet.yAxis.labelTextStyle = textStyle;
axisSet.yAxis.labelOffset = 3.0f;
axisSet.yAxis.majorIntervalLength = CPTDecimalFromFloat((yAxisMax - yAxisMin) / 4);
axisSet.yAxis.minorTicksPerInterval = 4;
axisSet.yAxis.minorTickLength = 5.0f;
axisSet.yAxis.majorTickLength = 7.0f;

CPTColor * customLighterBlue = [CPTColor colorWithComponentRed:0.0f green: 0.0f blue: 0.4f alpha: 1.0f];
CPTColor * customDarkBlue = [CPTColor colorWithComponentRed:0.0f green: 0.0f blue: 0.3f alpha: 1.0f];
axisSet.xAxis.alternatingBandFills = [NSArray arrayWithObjects:customLighterBlue, customDarkBlue, nil];

axisSet.xAxis.majorGridLineStyle = gridStyle;

axisSet.yAxis.majorGridLineStyle = gridStyle;

axisSet.xAxis.axisConstraints = [CPTConstraints constraintWithLowerOffset:0];

// Add a plot to our graph and axis. We give it an identifier so that we
// could add multiple plots (data lines) to the same graph if necessary.
CPTScatterPlot *plot = [[CPTScatterPlot alloc] init];
plot.dataSource = self;
plot.identifier = @"mainplot";
plot.dataLineStyle = nil;
plot.plotSymbol = plotSymbol;
[self.graph addPlot:plot];

//[_graph.defaultPlotSpace scaleToFitPlots:[_graph allPlots]]; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:02:02.680

1.  更改标签政策。我想`CPTAxisLabelingPolicyEqualDivisions`会做你想做的。Plot Gallery 示例应用程序中有一个演示，它显示了所有可用的标签策略。

2.  `labelFormatter`在 x 轴上设置。它是一个标准的[NSNumberFormatter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html)。

# php - 将文件存储在服务器中

> ID：11787598
> 
> 赞同：1
> 
> 时间：2012-08-03T00:13:17.850
> 
> 标签：php, database, file, upload, storage

> **可能重复：**
> [成千上万的图像，我应该如何组织目录结构？(Linux)](https://stackoverflow.com/questions/900512/thousands-of-images-how-should-i-organize-the-directory-structure-linux)

我正在构建一个自定义电子商务，它的功能之一是将用户文件存储在网络上。

我读到在数据库上存储文件很糟糕，正确的是只放置文件的路径。

但是，存储这些文件的最佳方式是什么？我的意思是，我不能只上传文件，然后按原样保存它们......

*   我坚持这样的事情：
*   我将从一个名为 0001 的文件夹开始，在将文件复制到该文件夹​​之前，我会检查：“是我想要的最大大小的文件夹吗？”，如果是，那么它将创建一个新文件夹 (0002) {和我不知道最好的方法是，在上传之前，知道什么是最大的文件夹}。
*   上传后，我将设置的名称将基于两件事：
    *   带有下划线 _ 的用户的散列 ID（具有随机安全性）
    *   另外，带有下划线 _ 的大小的随机散列
    *   加上一个随机散列，基于一个随机数
    *   加上相同的文件扩展名（这对吗？如果用户上传一个 .php 文件，它会是！@#！我的服务器吗？）

够好吗？还是我忘记了什么？

我从来没有处理过大量需要限制（“非顺序”）的文件上传，我会感谢任何提示！

谢谢

# c++ - 一个大世界还是许多小细胞？

> ID：11787599
> 
> 赞同：0
> 
> 时间：2012-08-03T00:13:45.880
> 
> 标签：c++, directx

我认为使用许多“小”单元比渲染一个大世界是一个更好的主意，因为我尝试过它并且它滞后并且显卡从太多顶点崩溃。因此，我将高度图拆分为单元格并以这种方式加载它，当您远离单元格而不再看到它时，它将被卸载。使用这种方法以后会有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:24:21.220

是的，这就是这样做的方法。无论“世界”有多大，如果它是有限的，它就可以让你拥有尽可能大的“区域”。但是，您需要考虑的额外簿记是确保始终在查看器周围加载周围的块，并确保有景深或“雾”效果，这样人们就无法越过最远的加载区域并看到卸载的边界。除此之外，我看不到任何陷阱。

# ios - 如何制作圆形按钮覆盖？

> ID：11787600
> 
> 赞同：0
> 
> 时间：2012-08-03T00:13:50.827
> 
> 标签：ios, uibutton

每次加载我的相机预览屏幕时，都会出现下面的叠加层。我想在覆盖层上创建一个圆形矩形按钮，以编程方式命名为“完成”。我该怎么做？

```
- (UIView*)CommomOverlay {

    UIView* view = [[UIView alloc] initWithFrame:CGRectMake(0,0,320,430)];
    UIImageView *FrameImg = [[UIImageView alloc] initWithFrame:CGRectMake(0,0,320,430)];

    [FrameImg setImage:[UIImage imageNamed:@"newGraphicOverlay.png"]];
    FrameImg.userInteractionEnabled = YES;

    [view addSubview:FrameImg];

    return view;
} 
```

另外，我会在我的`finishButtonPressed`方法中添加什么来显示一个名为 nib 的视图`testviewcontroller`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-24T16:28:44.540

1.) 这是一个添加到视图中心的蓝色按钮：

```
UIView* view = [[UIView alloc] initWithFrame:CGRectMake(0,0,320,430)];
UIImageView *FrameImg = [[UIImageView alloc] initWithFrame:CGRectMake(0,0,320,430)];

[FrameImg setImage:[UIImage imageNamed:@"newGraphicOverlay.png"]];
FrameImg.userInteractionEnabled = YES;

[view addSubview:FrameImg];

UIButton *button = [[UIButton alloc]initWithFrame:CGRectMake(0, 0, 150, 50)];
button.center = view.center;
button.backgroundColor = [UIColor blueColor];
button.layer.cornerRadius = 10.0;
button.titleLabel.text = @"Finished";

[view addSubview:button]; 
```

2.) 你应该：

*   在情节提要中附加一个转场
*   命名segue标识符
*   调用 performSegueWithIdentifier
*   （一定要实现prepareForSegue，如果你想在segue之前做额外的工作）

# regression - 生成多组 n 维点

> ID：11787602
> 
> 赞同：2
> 
> 时间：2012-08-03T00:14:33.557
> 
> 标签：regression, mathematical-optimization

我正在尝试获取点集并将它们分成较小的集。约束是每个集合的每个维度都有一些最小值和一些最大值。我想生成这些集合的所有可能组合（我们称之为一组集合。）当我完成后，每个点都出现在每个集合中的一个集合中。

例如，假设我只有具有两个自变量 i 和 j 的数据点。他们是：

```
(1,1) (1,2) (2,2) (3,1),(2,1),(2,3) 
```

这些分裂中的任何一个都很好：

```
(1,1)(1,2) and (2,2)(3,2)(2,1)(2,3)
First set has i < 2, second set has i >= 2.

(1,1)(3,1)(2,1) and (1,2)(2,2)(2,3)
First set has j < 2, second set has j >= 2.

(1,1)(1,2) and (2,2)(3,1)(2,1) and empty and (2,3)
First set has (i < 2, j < 3), second set has (i >= 2, j < 3)
Third set has (i < 2, j >= 3), fourth set has (i >= 2, j >= 3) 
```

如何在不手动迭代每个点（不同的数字）的情况下生成整组拆分！次？

这不是家庭作业，只是我试图作为数据拟合器的一部分编写的程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T17:36:26.420

假设意图是在每个维度中最多有一个分割点（因此相对于该维度将点划分为最多两组），那么：

对于每个维度，让 V 是该维度中的坐标集。例如，给定点 (4, 10), (4, 20), (6, 10), (6, 18), (7, 3)，那么对于第一个维度，V 是 {4, 6, 7 }。通过集合中的每个值迭代 v。

嵌套这些迭代，每个维度一个，这样，在最内层循环的主体中，每个维度都有 av 。我们将它们编号为 v0、v1、v2、...

每个 v 形成一个标准：x < v 或 v <= x。对于 n 个维度，这些标准有 2 ^n种组合。每个组合指定原始点的一个子集。例如，一个这样的子集是 { p | x0 < v0 and v1 <= x1 and v2 <= x2 and... }，其中点 p 的坐标为 (x0, x1, x2,...)。因此，遍历 2 ^(n 个)潜在子集（有些相同，因为它们是空的），并将它们收集到一个集合中。那是原始点集的一个分区。

当您完成通过它们的值迭代 v 时，您将构建符合您的条件的每个分区。

# ios - 截图方法：跳过状态栏

> ID：11787603
> 
> 赞同：2
> 
> 时间：2012-08-03T00:14:42.333
> 
> 标签：ios, ios4, screenshot, ios5

我从 Apple 的网站上得到了这个截图方法：

```
- (UIImage*)screenshot 
{
    // Create a graphics context with the target size
    // On iOS 4 and later, use UIGraphicsBeginImageContextWithOptions to take the scale into consideration
    // On iOS prior to 4, fall back to use UIGraphicsBeginImageContext
    CGSize imageSize = [[UIScreen mainScreen] bounds].size;
    if (NULL != UIGraphicsBeginImageContextWithOptions)
        UIGraphicsBeginImageContextWithOptions(imageSize, NO, 0);
    else
        UIGraphicsBeginImageContext(imageSize);

    CGContextRef context = UIGraphicsGetCurrentContext();

    // Iterate over every window from back to front
    for (UIWindow *window in [[UIApplication sharedApplication] windows]) 
    {
        if (![window respondsToSelector:@selector(screen)] || [window screen] == [UIScreen mainScreen])
        {
            // -renderInContext: renders in the coordinate space of the layer,
            // so we must first apply the layer's geometry to the graphics context
            CGContextSaveGState(context);
            // Center the context around the window's anchor point
            CGContextTranslateCTM(context, [window center].x, [window center].y);
            // Apply the window's transform about the anchor point
            CGContextConcatCTM(context, [window transform]);
            // Offset by the portion of the bounds left of and above the anchor point
            CGContextTranslateCTM(context,
                                  -[window bounds].size.width * [[window layer] anchorPoint].x,
                                  -[window bounds].size.height * [[window layer] anchorPoint].y);

            // Render the layer hierarchy to the current context
            [[window layer] renderInContext:context];

            // Restore the context
            CGContextRestoreGState(context);
        }
    }

    // Retrieve the screenshot image
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();

    return image;
} 
```

它就像一个魅力，但我有一个小问题：我不希望状态栏在我的屏幕截图中显示应用程序。我应该修改什么？老实说，我不知道我应该在这里修改什么，因为我从来没有过多地使用 CG 框架。我正在考虑从获得“y”属性的东西中减去 20（状态栏高度），但我不想破坏这种方法。那么我应该修改什么来截取除状态栏以外的所有内容？再次，如果这是一个真正愚蠢的问题，我深表歉意，但我真的不知道我会做什么，我应该自己尝试修改它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T00:39:42.940

我刚刚想通了。事实上，我只是从“y”属性中减去了 20：

所以代替这个：

```
CGContextTranslateCTM(context, [window center].x, [window center].y); 
```

我这样做了：

```
CGContextTranslateCTM(context, [window center].x, [window center].y - 20); 
```

可能有更好的方法来做到这一点，但这对我很有帮助。

# bash - 延迟 bash 中的通配符扩展，同时引用特殊字符

> ID：11787604
> 
> 赞同：5
> 
> 时间：2012-08-03T00:15:16.157
> 
> 标签：bash, wildcard-expansion

我写了一个 bash 脚本，稍后需要做一些事情。它被称为这样的东西：

```
later mv *.log /somewhere/else 
```

但是，当这样`*.log`调用时，在调用时会扩展，并且调用脚本就像我写的一样

```
later mv 1.log 2.log 3.log /somewhere/else 
```

我试图让我的脚本稍后扩展通配符。我试着这样称呼它

```
later mv '*.log' /somewhere/else 
```

还有`\*`, 但这些都导致通配符根本没有得到扩展。

如何在命令行中扩展通配符？有没有办法在调用脚本时防止扩展，即在输入时获取原始参数？

这是我的脚本的一部分，用于为以后的调用做准备：

```
tmpfile=$(mktemp)

### Get a quoted commandline
line=
while (( "$#" > 0 )); do
        line="$line\"$1\" "
        shift
done

### Prepare a script to be run
echo '#!/bin/bash' > "$tmpfile"
echo "cd $(pwd)" >> "$tmpfile"
echo "trap 'rm \"$tmpfile\"' EXIT" >> "$tmpfile"
echo "$line" >> "$tmpfile"
chmod 777 "$tmpfile" 
```

请注意，我必须引用命令行，因为我的一些文件和文件夹的名称中有空格；如果我删除引用位，即使没有通配符的位也会停止工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T00:34:38.903

有趣的问题。我怀疑可能有比我更好的答案。尽管如此，鉴于

```
A='foo.*' 
```

这似乎做你想做的事：

```
echo $(eval echo "$A") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T00:29:50.937

最简单的方法可能是简单地将通配符（glob）传回shell进行扩展，

例如：

```
 #!/bin/bash
 echo "For the wildcard $1"
 echo "I find these match(es): $(eval echo "$1")" 
```

`$( … )`操作员调用一个子shell，并对结果进行插值；该`echo`命令只是返回它们。

*   正如@thb 在他们的回答中所说的那样，`eval`在 shell 脚本中是必需的（但在交互式 shell 上键入它时不需要，在这种情况下`$(echo $1)`有效。

请注意，您仍然必须转义间距等，但似乎您已经考虑到了这一点。自然，调用脚本时需要引用 glob ——这就是为什么大多数 Unix 命令只在第一个或最后一个位置使用一个列表的原因，尽管`find`确实存在这样的例子，它们本身需要转义的 fileglob。

PS：至于强制外壳*不*执行扩展的程序：不，没有内置的方法可以这样做。shell 会在之前（好吧，如果不一定按时间顺序的话，逻辑上是“之前”）扩展 glob，甚至可以识别您的程序所在的文件，并且普遍不知道它运行的程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-04T14:01:18.793

# 解决方案

在 shell 脚本中有一堆棘手的字符。空格和两个引号是最难处理的。这个建议的解决方案将通过应用适当的引用来解决棘手字符的问题。

## 后来的脚本：

```
#!/bin/bash

if [ $# -lt 1 ]; then
        echo "Need argument!"
        exit 1
fi

### Get a quoted commandline
line=
files=($(echo "$1"))
for file in "${files[@]}"; do
        echo "Debug: Processing file [$file]"
        quoted_filename=$(printf '%q' "$file")
        if [ -n "$line" ]; then
                line="$line "
        fi
        line="$line$quoted_filename"
done
echo -e "Result:\n$line" 
```

# 测试解决方案

## 准备：

使用具有潜在缺陷的四个匹配条目准备测试环境：

```
mkdir 'foo.bar.*'
date > 'foo.bar test.dat'
touch 'foo."nickname".bar'
touch "foo.'single'.bar" 
```

## 跑：

使用问题中建议的通配符。

```
./later.sh 'foo*' 
```

## 示例输出：

```
Debug: Processing file [foo.bar.*]
Debug: Processing file [foo.bar test.dat]
Debug: Processing file [foo."nickname".bar]
Debug: Processing file [foo.'single'.bar]
Result:
foo.bar.\* foo.bar\ test.dat foo.\"nickname\".bar foo.\'single\'.bar 
```

# youtube - 从嵌入式 youtube 视频中获取当前时间戳

> ID：11787606
> 
> 赞同：2
> 
> 时间：2012-08-03T00:15:37.647
> 
> 标签：youtube, timestamp, video-streaming, flowplayer

有谁知道用于流式播放 youtube 视频的免费插件？

或者

如果我只是将 youtube 视频嵌入到我的网页中，是否可以获得 youtube 视频的当前时间戳。我希望用户能够单击记录正在播放的视频的当前时间戳的按钮。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:09:30.807

老问题，但我一直在寻找同样的问题，并找到了我相信的答案。

看起来 YouTube 有一个用于框架的 api：

> [https://developers.google.com/youtube/iframe_api_reference](https://developers.google.com/youtube/iframe_api_reference)

并且有一种方法可以获取当前时间戳：

> player.getCurrentTime():Number 返回自视频开始播放以来经过的时间（以秒为单位）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-26T21:34:14.397

[https://developers.google.com/youtube/iframe_api_reference#Playback_status](https://developers.google.com/youtube/iframe_api_reference#Playback_status)

看一下这个。`player.getCurrentTime():Number`可能是您正在寻找的。

# javascript - 注释嵌套参数

> ID：11787609
> 
> 赞同：1
> 
> 时间：2012-08-03T00:15:45.153
> 
> 标签：javascript, node.js, coding-style, comments, styles

在 javascript 中很常见的是：

```
function A (options, aaa, bbb) {
  var ccc = options.ccc;
  var ddd = options.ddd;
} 
```

目前我这样评论它：

```
/**
 * a completely useless function
 *
 * @param {Object} options where options.ccc is {Number} ccc and options.ddd is {String} ddd
 * @param {Boolean} aaa
 * @param {String} bbb
 */ 
```

我对在 options 参数中描述属性的方式不满意

有没有一种干净的方法可以将它们放入“{Type} 描述”模式中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:19:07.057

我通常在变量名之后放一两个制表符……在描述之前。不过我同意……我也不是超级粉丝。但是，这就是 jsdocs 处理它的方式。如果您对格式过于纠结，您可能无法解析出正确的文档。

```
/**
 * SLP.Modules.Codes extends the SLP.Modules object on DOM-ready.
 * @module Codes
 */
SLP.Modules.Codes = {
    /**
     * First validate for empty fields, then check the campaign codes,
     * making sure that they begin with T(oyota), L(exus), or S(cion).
     * @param  {object} event   jQuery Event object (form submit)
     * @return {boolean}        true if all validation passes.
     */
    validateCampaignCodes: function(event){
        var $input, isValid = SLP.validateFormInputsNotEmpty(event);
        if (isValid) {// Continue validation if all fields are non-empty.
            $input = $("input").filter("[name=campaign_code]").each(function(){
                if (!(isValid = /^[TLS]/i.test(this.value))) {
                    return !SLP.DOM.$modalPrompt.find(".modal-body").html( // Error msg.
                        "Campaign Codes must begin with T(oyota), S(cion), or L(exus)."
                    ).end().modal("show");// On error, immediately exit (the each method).
                }
            });
        }
        // Convert campaign codes to uppercase for submission.
        $input.val(function(i,v){ return v.toUpperCase(); });
        // Enable all checkboxes to submit values with form.
        $("input[type=checkbox]").attr("disabled", false);
        return isValid;
    }, 
```

# iphone - UIWebView 加载本地 html 文件无法在咖啡厅显示“é”

> ID：11787611
> 
> 赞同：0
> 
> 时间：2012-08-03T00:15:56.543
> 
> 标签：iphone, html, ios, uiwebview

我正在使用 UIWebView 在 app bundle 中加载一个 html 文件，其中有一些文本，并且有一个咖啡厅的 'é'，但它在模拟器中显示为：cafA©，并且 A 上方有一个波浪号，我该如何显示那个角色？有没有类似空间的东西？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T00:13:23.917

感谢 bitmapdata.com 和 iBlue，我添加了这一行：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
```

并直接使用é它起作用了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-03T00:18:40.023

```
&#233; or &eacute; 
```

[http://www.fileformat.info/info/unicode/char/00e9/index.htm](http://www.fileformat.info/info/unicode/char/00e9/index.htm)

# iphone - 如何 ABRecordRef + 图像大于 320x320 像素？

> ID：11787612
> 
> 赞同：0
> 
> 时间：2012-08-03T00:16:02.983
> 
> 标签：iphone, ios, addressbook, contact, abrecordref

我在内部使用地址簿框架，我想知道是否可以在`ABRecordRef`不透明类型中使用大于 320x320 像素的图像。

我试图从 mainBundle 设置一个图像，但我并不幸运，因为当再次读取图像时，该`ABPersonCopyImageDataWithFormat`函数总是向我发送一个大小相同 (320x320) 的图像。

**有没有办法在 ABRecordRef 中保留更大的图像？**

# firefox - Selenium 2.0 悬停在 Firefox v.14.0 中不起作用

> ID：11787613
> 
> 赞同：1
> 
> 时间：2012-08-03T00:16:13.970
> 
> 标签：firefox, testing, selenium

我正在使用 Firefox WebDriver 来测试 Web 应用程序。Web 应用程序有一个顶部导航栏，当您将鼠标悬停在它上面时，一些元素会下拉到菜单中。

我想在悬停后单击下拉菜单中的按钮。我正在执行以下代码：

```
 WebElement dropDown = driver.findElement(By
            .xpath("html/body/header/div/ul/li[6]/span[2]/a"));
    WebElement logoutButton = driver.findElement(By
            .xpath("html/body/header/div/ul/li[6]/ul/li[2]/a"));

    //build and perform the mouseOver with Advanced User Interactions API
    Actions builder = new Actions(driver);    
    builder.moveToElement(dropDown).perform();

    Thread.sleep(1000);

    logoutButton.click(); 
```

但我收到以下错误：

```
Element is not currently visible and so may not be interacted with 
```

你知道我怎样才能让这个下拉按钮可见吗？我可以做些什么来完成这项工作吗？

- - - 更多细节 - - -

但是，在睡眠期间，浏览器在屏幕左下角显示 URL 信息，表明 Web 驱动程序实际上是悬停的，但按钮不可见。

# objective-c - Objective-C ARC 属性重新声明混淆

> ID：11787615
> 
> 赞同：4
> 
> 时间：2012-08-03T00:16:35.213
> 
> 标签：objective-c, automatic-ref-counting

我有以下代码：

```
// MyObject.h
#import <Foundation/Foundation.h>

@interface MyObject : NSObject
@property (nonatomic, readonly) id property;
@end

// MyObject.m
#import "MyObject.h"

@interface MyObject ()
@property (nonatomic, copy, readwrite) id property;
@end

@implementation MyObject
@synthesize property = _property;
@end 
```

这会生成以下编译器警告和错误：

```
warning: property attribute in continuation class does not match the primary class
@property (nonatomic, copy, readwrite) id property;
^
note: property declared here
@property (nonatomic, readonly) id property;
                                   ^
error: ARC forbids synthesizing a property of an Objective-C object with unspecified ownership or storage attribute 
```

但是，如果我将类延续的属性重新声明更改为具有存储限定符`weak`，则不会生成警告或错误。但是，（令人震惊？）为`-[MyObject setProperty:]`调用生成的代码`objc_storeStrong`而不是我预期`objc_storeWeak`的 .

我知道从 LLVM 3.1 开始，合成 ivars 的默认存储是`strong`. 我想我的问题是这样的：为什么代码生成器偏爱标题中的声明而不是我在实现中的重新声明？其次，为什么当我重新声明为时它会抱怨`copy`，而不是`weak`or `assign`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T00:37:18.760

我明白你下面的问题...

*   您想在 MyObject 类成员方法中读写 myproperty。
*   但是，想从其他类中读取 myproperty。

* * *

// MyObject.h

```
@interface MyObject : NSObject
{
@private
    id _myproperty;
}
@property (nonatomic, copy, readonly) id myproperty;
@end 
```

* * *

// 我的对象.m

```
#import "MyObject.h"

@interface MyObject ()
// @property (nonatomic, copy, readwrite) id myproperty; // No needs
@end

@implementation MyObject
@synthesize myproperty = _myproperty;

- (void)aMethod
{
    _myproperty = [NSString new]; // You can read & write in this class.
}

@end 
```

* * *

// Ohter.m

```
#import "MyObject.h"

void main()
{
   MyObject *o = [MyObject new];
   o.myproperty = [NSString new]; // Error!! Can't write.
   o._myproperty = [NSString new]; // Error!! Can't acsess by objective c rule.
   NSString *tmp = o.myproperty; // Success readonly. (but myproperty value is nil).
} 
```

# windows-phone-7 - 如何在 wp7 的网络浏览器中禁用捏合/缩放

> ID：11787616
> 
> 赞同：0
> 
> 时间：2012-08-03T00:16:47.163
> 
> 标签：windows-phone-7

对于所有其他浏览器，您添加元标记：

```
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no;"> 
```

禁用捏缩放，但这不适用于wp7。

有谁知道如何禁用捏放大wp7？

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T05:16:01.700

长话短说，检查这个[链接](http://blogs.msdn.com/b/iemobile/archive/2010/11/22/the-ie-mobile-viewport-on-windows-phone-7.aspx)

注意小字体？

> *注意：在初始版本中，IE Mobile for Windows Phone 7 不支持初始缩放、最大缩放或最小缩放。

还要检查[来自 StackOverflow 的另一个问题](https://stackoverflow.com/questions/10972466/prevent-ie-mobile-from-scaling-web-pages-automatically)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T09:05:18.567

我想你需要这个。其中显示了在 windows phone 中使用 webbrowser 的提示。这是链接：http: [//msdn.microsoft.com/zh-cn/library/3031e22a-e7ac-4d1e-b9e5-a627ac63f307](http://msdn.microsoft.com/zh-cn/library/3031e22a-e7ac-4d1e-b9e5-a627ac63f307)

# php - CodeIgniter Form_Validation 没有实际表单

> ID：11787619
> 
> 赞同：4
> 
> 时间：2012-08-03T00:17:26.980
> 
> 标签：php, ajax, codeigniter, validation

我正在尝试做的事情非常简单（我希望）：
我正在尝试使用 Form_Validation验证 POST 数据（或通过**变量提供的任何数据）。**
问题是要运行实际验证我/我们需要做

```
if ($this->form_validation->run() == FALSE){
 //validation did not pass
}else{
 //validation did pass
} 
```

我的一套规则是这样的：

```
$this->form_validation->set_rules('key', '', 'trim|required'); //simplified 
```

所以，我显然是通过 AJAX 向这个脚本发送数据

```
echo $_POST['key']; //prints valid value that is sent from AJAX 
```

如何使用 form_validation 验证 $_POST['key']？

AJAX 代码

```
$("#key-inputs .short, #key-inputs .long").change(function () {
        var key = $(this).val();
        var id = $(this).attr('name');
        var table = $(this).attr('class');
        var file = $('span .file').val();
        var data = 'NULL';
        $.post(file + "/edit",{
                        id:id,
                        key:key,
                        file:file,
                        table:table},
                        function(code, textStatus) {
                        data = code;
        });
        $(this).ajaxStop(function(){
            if (data == 3) $(this).parent().fadeOut('slow', function() {}); //delete
            if (data == 2) $(this).fadeOut(200).fadeIn(200); //update
            if (data == 5) alert('not valid'); //update parameter is not valid input (depends on set_value rules)
            //writeConsole(previous.val().outerHTML);
        });
    }); 
```

PHP代码//简化

```
if (!$this->input->is_ajax_request()) redirect('lang/translate/keys/'.$param);
          //do work here
         if ($key == "") {
          //delete key
            $this->lang_translate_model->DeleteKey($id, $table);
            echo 3;
            return TRUE;
         }
         $this->form_validation->set_rules('key', 'key', 'trim|required|max_length[56]|xss_clean|unique_file[lang_key:'.$param.']');
         if ($this->form_validation->run() == FALSE){
          //validation did not pass
          echo 5;
        } 
```

所以我有一些（生成的）输入，只有在 ..set_rules 通过时，我才想在数据库中进行更新。
如果输入为空，它会自行删除（这工作正常）

**解决方案**
TRUE/FALSE 表在[这里](http://codeigniter.com/user_guide/libraries/form_validation.html#rulereference)

```
if ($this->form_validation->required($key)){
          //validation did not pass
          echo 5;
} 
```

例如，如果有参数要传递`min_length[2]`；

```
$this->form_validation->min_length($key,'2'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-26T10:01:21.970

这取决于您使用的 codeigniter 版本

**代码点火器 3.0：**

您可以使用*set_data*方法来验证您的自定义数据

```
$data = array(
        'username' => 'johndoe',
        'password' => 'mypassword',
        'passconf' => 'mypassword'
);

$this->form_validation->set_data($data); 
```

**代码点火器 2.X：**

`$_POST`手动设置值

```
 $_POST'username']  = 'johndoe';
   $_POST['password'] ='mypassword';
   $_POST['passconf'] = 'mypassword'; 
```

**常见的 ：**

对于共同的部分，谢天谢地，他们仍然使用 `form_validation->run()`和 `form_validation->set_rules(<SPECIFIC ATTRIBUTE RULES>)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T09:15:35.657

看到[这个](http://codeigniter.com/user_guide/libraries/form_validation.html#rulereference)。另请查看该页面上的以下注释。

# eiffel - 为什么在常量赋值中使用等号？

> ID：11787621
> 
> 赞同：2
> 
> 时间：2012-08-03T00:18:02.127
> 
> 标签：eiffel

我有一个关于埃菲尔常数的问题。嗯，这只是一个语义问题，但它已经困扰我一段时间了，我只是不明白这个专业的概念。

对于您使用的正常作业，`:=`这在数学思维中完全有意义，因为它是作业的数学符号

但是如果我们看一下常量的定义：

```
feature
    some_constant: INTEGER = 5 
```

我只是不明白为什么我们在那里使用等号。有一定的原因吗？我会这样理解：我们将值 5 分配给常量，但为什么是布尔表达式？

我希望有人可以解释这背后的概念

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T13:24:20.497

您必须将`=`标志视为恒定功能的快速合同。

```
foo: INTEGER = 5 
```

将等同于

```
foo: INTEGER
  ensure
    Result = 5 
```

请注意，这是最近的语法更改，之前是

```
foo: INTEGER is 5 
```

但是 Eiffel 规范`is`完全删除了该关键字。

# mysql - MySQL：分组计数后得到总查询数

> ID：11787622
> 
> 赞同：1
> 
> 时间：2012-08-03T00:18:02.737
> 
> 标签：mysql, count

我有以下查询：

```
select count(*) c , id 
from hr 
where  time >= '2011-11-8 00:00:00' and 
       time <= '2011-12-9 23:59:59' 
group by id 
having c>3; 
```

结果列表可能非常庞大（有时多达 10,000 项），我不想列出所有内容，因为我只想获取总数。除了“select found_rows()”之外，我还试图找到一个 sql 语句来完成工作而不打印列表。（我没有使用 Perl、PHP 或任何其他 API，只是使用 sql）

任何想法？

提前致谢。

杨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:27:44.447

将其包装在子查询中并再次计算记录

```
SELECT COUNT(*) totalCount
FROM
(
    select count(*) c , id 
    from hr 
    where  time >= '2011-11-8 00:00:00' and 
           time <= '2011-12-9 23:59:59' 
    group by id 
    having COUNT(*) > 3
) x 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:28:50.183

```
SELECT COUNT(*) FROM (SELECT id, COUNT(*) c FROM hr WHERE time >= '2011-11-8 00:00:00' AND time <= '2011-12-9 23:59:59' GROUP BY id) counts WHERE counts.c > 3; 
```

# jquery - 在图像点击和播放时更改 html5-audio 源

> ID：11787627
> 
> 赞同：1
> 
> 时间：2012-08-03T00:18:42.553
> 
> 标签：jquery, html5-audio

这是我播放 html5 音频的代码（不起作用）

```
$('img.play_media').bind('click',function(){
src=$(this).attr("id");                     $('audio[id=resource_audio]').children('source').attr("src","testuser/resources/"+src);
var audio= document.getElementById('resource_audio');
audio.play();
return false;
});

<audio id="resource_audio" >
<source src="" type="audio/mp3" />
</audio> 
```

如您所见，我正在尝试获取`src`on img click ，它设置为图像 ID，在歌剧中我可以看到播放开始。但是，音频不播放。任何帮助表示赞赏。
谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:55:32.010

我可以让它工作，除非源标签已经有它绑定的声音：http: [//jsfiddle.net/webwarrior/b2cUz/22/](http://jsfiddle.net/webwarrior/b2cUz/22/)

您需要更新音频上的源属性，而不是源。

重要的一点是：`jQuery('#resource_audio').attr("src",srclink)[0].play();`

但是这个家伙似乎让它工作了：[http ://css-tricks.com/play-sound-on-hover/](http://css-tricks.com/play-sound-on-hover/)

希望这能为您指明正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:25:58.833

请提供 img 的 HTML。我已经清理了你的代码，但可能对你的问题没有帮助：

```
$('img.play_media').click(function(event){
  $("#resource_audio")
    .attr("src","testuser/resources/"+this.id)
    .get(0).play();
});

<audio id="resource_audio">
  Your browser does not support the <code>audio</code> element.
</audio> 
```

*   注意：确保两件事：a）音频文件实际上位于正确的位置，b）Web 服务器配置为使用正确的 MIME 类型提供（响应）服务。

您可能还想查看[https://developer.mozilla.org/en/HTML/Element/audio](https://developer.mozilla.org/en/HTML/Element/audio)。

```
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
</head>
<body>
    <h1>Heading</h1>
    <div id="doc">
        <img class="play_media" id="test.mp3" src="status-on.png" style="width:15px;margin-right:0%;" > 
        <audio id="resource_audio">
          Your browser does not support the <code>audio</code> element.
        </audio>
    </div>
    <script>
    $('img.play_media').click(function(event){
      $("#resource_audio")
        .attr("src",this.id)
        .get(0).play();
    });
    </script>
</body>
</html> 
```

# c++ - 防止多个控制台在其进程完成时消失

> ID：11787629
> 
> 赞同：0
> 
> 时间：2012-08-03T00:18:47.110
> 
> 标签：c++, xcode, macos

我正在 Xcode 4.3.2 中构建一个 C++ 项目。在 Xcode 中编辑时，我想同时运行具有不同参数的程序的多个实例。我 cout<< 我的输出，这是我现在程序中最重要的部分，到控制台（Xcode 控制台，而不是终端），当我坐在通过选择控制台上方具有不同进程号的下拉菜单，我的计算机。但是，如果我设置 3 个进程运行然后离开我的计算机，当这些进程完成时，只有最后一个要完成的程序的控制台仍然存在。

有谁知道 Xcode Preferences 设置，我可以让所有控制台在完成后保持打开状态？除此之外，还有其他关于保持我的控制台输出的建议吗？我想避免将我的输出写入日志文件，或者至少必须将其硬编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:31:18.227

我猜你是通过 Finder 启动你的应用程序的。如果您打开一个带有不同选项卡的终端窗口并在每个选项卡中分别运行程序的不同实例会怎样？

或者另一种解决方案是将“std::cin>>”放在主要功能的末尾，从而迫使您的应用程序等待键盘输入。

# python - django：解析自定义模板中的变量

> ID：11787630
> 
> 赞同：2
> 
> 时间：2012-08-03T00:18:57.963
> 
> 标签：python, django, interpreter, django-templates

我正在制作一个自定义模板标签，我希望能够以任何类型的值传递它。用例是这样的：

```
{% include_with_args "path_to_template.html" simple_var an_object.foo.bar "A String" %} 
```

在评估我的自定义模板代码时，我想以与 Django 通常相同的方式评估`simple_var`、`an_object.foo.bar`和。`"A String"`目前我有

```
these_args = [context[arg_name] for arg_name in self.arg_names] 
```

但是，这只适用于变量名 ( `simple_var`)。

如何让我的模板像 Django 一样评估这些字符串？也就是说，如果`.foo`是一个返回带有`"bar"`键的 dict 的函数，它应该按预期评估它`an_object.foo()["bar"]`：

简单来说：我想将表达式评估为一个值。如何从自定义模板中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T02:08:35.953

其实很简单。代替：

```
these_args = [context[arg_name] for arg_name in self.arg_names] 
```

做：

```
these_args = [template.Variable(arg_name).resolve(context) for arg_name in self.arg_names] 
```

当然，现在`arg_name`是用词不当，所以我改变了它，但只是这样写以阐明差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T01:44:24.050

包含标签已经做了你想要的：[https ://docs.djangoproject.com/en/1.4/howto/custom-template-tags/#inclusion-tags](https://docs.djangoproject.com/en/1.4/howto/custom-template-tags/#inclusion-tags)

唯一需要做的就是改变调用 an_object.foo.bar 的位置。您可以在标签的 Python 代码中执行此操作，而不是在模板层的标签的 args 中执行此操作。

# plone - 删除新内容类型的描述字段

> ID：11787636
> 
> 赞同：2
> 
> 时间：2012-08-03T00:19:32.987
> 
> 标签：plone

我基于 ATFolder 创建了一个新的内容类型，但注意到其中包含一个描述字段。有没有办法删除它，或者至少只是从编辑页面中删除它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T00:46:23.920

如[如何从新内容类型中删除继承字段中所述](https://stackoverflow.com/questions/7459045/how-to-remove-an-inherited-field-from-a-new-content-type)：您可以将小部件设置为不可见以进行编辑和查看。

```
YourSchema['FieldName'].widget.visible = {'view': 'hidden', 'edit':'hidden' } 
```

如果原始模式中需要该字段，您还需要

```
YourSchema['FieldName'].required = False 
```

# java - Spring：外部和内部属性文件

> ID：11787638
> 
> 赞同：3
> 
> 时间：2012-08-03T00:19:52.497
> 
> 标签：java, spring, properties

我有两个使用 Spring 的 Java 应用程序（一个使用 v 2.5.4，另一个使用 v 3.1.1。）并部署到 Weblogic 上。

对于每个应用程序，我希望 Spring 能够使用两个单独的属性文件——一个在服务器的文件系统中，如果由于任何原因不存在，一个包含在应用程序的 ear 文件中作为一组“默认”值.

我可以在应用程序的 applicationContext.xml 文件中使用“context:property-placeholder”条目来指定这样的东西吗？

我在网上看了看，但找不到任何确定的东西……但我可以做这样的事情吗？例如？

```
<!-- Default values loaded first -->
<context:property-placeholder location="classpath:myEarPropertiesFile.properties" />
<!-- Overridden values loaded next -->
<context:property-override location="file:myExternalPropertiesFile.properties" /> 
```

提前感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T04:12:22.247

我设法用我的 PropertyPlaceholderConfigurer 引用的 PropertiesFactoryBean 解决了这个问题。

# knockout.js - 如何使用淘汰映射插件添加新项目

> ID：11787640
> 
> 赞同：5
> 
> 时间：2012-08-03T00:20:15.137
> 
> 标签：knockout.js, knockout-mapping-plugin

我正在尝试一个淘汰赛映射样本，并认为我快到了。我似乎无法向 viewModel.foos 添加新的 Foo - 任何人都可以看到我在这里错过了什么吗？

```
var Foo = function (data) {

    var self = this;
    self.id = data.id;
    self.Name = ko.observable(data.Name);

}

var dataMappingOptions = {
    key: function(data) {
        return data.id;        
    },
    create: function (options) {

        return new Foo(options.data);
    }
};

var viewModel = {

    foos: ko.mapping.fromJS([]),
    loadInitialData: function () {
        ko.mapping.fromJS(serverData, dataMappingOptions, viewModel.foos);
    },
    loadUpdatedData: function () {
        ko.mapping.fromJS(serverData, dataMappingOptions, viewModel.foos);
    }
};

viewModel.addFoo = function () {
    viewModel.foos.push(ko.mapping.fromJS(new Foo()));
    viewModel.loadUpdatedData();
}

    <ul data-bind="template: {name: 'TopTemplate'}"></ul>
<script type="text/html" id="TopTemplate">
    <li><span>Result</span>
        <ul data-bind=" template: {name:  'FooTemplate' , foreach: foos} " style="list-style-type:circle;margin-left:15px">
        </ul>
    </li>
    <button data-bind='click: addFoo'>Add Foo</button>
</script>       
<script type="text/html" id="FooTemplate">     
    <li><span data-bind='text: Name'></span>

    </li>

</script> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-13T05:05:01.370

由于原始海报在 Foo 类成员中应用 observables，因此无需将 ko.mapping.fromJS 应用到它。但是我发现，当您有一个需要添加到可观察数组的“原始”json 对象（没有映射）时（即您之前已应用 ko.mapping.fromJS()），您确实需要执行ko.mapping.fromJS 例如

```
myArray.push(ko.mapping.fromJS(myNewRawJsonItem)); 
```

否则，您的模板绑定（如果有的话）将抱怨“TypeError xxxx 不是函数”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-03T02:34:39.653

您可以直接将一个新的 Foo 推送到您的 observableArray。

这是加载一些初始数据，然后加载一些更新数据以及在客户端添加新项目的按钮的示例。 [http://jsfiddle.net/rniemeyer/wRwc4/](http://jsfiddle.net/rniemeyer/wRwc4/)

```
var viewModel = {
    foos: ko.mapping.fromJS([]),
    loadInitialData: function() {
        ko.mapping.fromJS(initialData, dataMappingOptions, viewModel.foos);
    },
    loadUpdatedData: function() {
        ko.mapping.fromJS(updatedData, viewModel.foos);
    }
};

viewModel.addFoo = function() {
    viewModel.foos.push(new Foo({ id: 0, Name: "New" }));
}; 
```

# c++ - C++ - 检查指针是否指向有效内存（此处不能使用 NULL 检查）

> ID：11787650
> 
> 赞同：2
> 
> 时间：2012-08-03T00:22:28.930
> 
> 标签：c++, pointers, null, interpreter

我正在创建脚本语言。当我分配东西时，它是分配东西并返回地址，然后我用它做任何事情然后删除它。我无法控制其中的变量，例如在我的 lang 中创建结构（带有指针和 bool 的结构以检查指针是否指向有效数据）等，因为它会使我的 lang 在 RAM 中变慢和变大。

例如：（我的脚本语言很容易理解。我怀疑你不会理解，但我还是会在里面放一些评论）

```
MyStruct = { //Function. For create object with it use 'new' before it.
    TestAliveVar=0
}
Func = { //I'll explain what exactly this function does every place it runs.
    if (!exists(arg0)) //C++: ???
        exit;
    arg0.TestAliveVar=1
    println "Still alive!";
}
var MyVar=new MyStruct(); //Returns address of the new object in the heap
                          //and runs on it the `MyStruct` function.
Func(MyVar);              //Sets his 'TestAliveVar' to 1
                          //and prints 'Still Alive!' with new line
delete(MyVar);            //C++: free(MyVar);
Func(MyVar);              //Does nothing 
```

问题是如何创建`exists`您在此代码中看到的函数。顺便说一句，我可以在这个语言中运行 C++ 代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-03T00:47:42.577

您可以使用`shared_ptr<>`来保存您的指针，并使用`weak_ptr<>`将您的指针传递给对象的消费者。你`delete`通过销毁`shared_ptr<>`对象来创建对象，然后所有的`weak_ptr<>`s 都将过期。

```
std::weak_ptr<int> wptr;
assert(wptr.expired());
{
    std::shared_ptr<int> intptr(new int);
    wptr = intptr;
    assert(!wptr.expired());
}
assert(wptr.expired()); 
```

因此，您的`exists`检查将是检查是否`weak_ptr<>`已过期。

为了使构造的使用更加具体：

```
Script code                 Hypothetical C++ code that gets executed
----                        ----
var MyVar=new MyStruct();   var_map["MyVar"]
                                = std::shared_ptr<Obj>(new Obj("MyStruct"));
Func(MyVar);                invoke("Func", std::weak_ptr<Obj>(var_map["MyVar"]));
exists(arg0)                !args[0].expired()
delete(MyVar);              var_map.erase("MyVar"); 
```

如果脚本要在多线程环境中运行，那么`weak_ptr<>`状态就是临界区。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-03T00:43:11.887

检测内存是否不再活动可以通过维护一组已知的死指针来完成。您创建的任何指针都会添加到*活动*集中，当您删除对象时，您会将指针移动到*死*集中。

真正棘手的部分将是重用内存。当您想为不同的对象重复使用相同的地址时，您会怎么做？你不能通过看指针来判断，因为指针看起来是一样的。因此，除非您永远不想重用内存，否则您将不得不更改您的要求。

1.  一种可能的方法是在结构中添加一个字段。我知道您说过您不希望这样，但许多评论已经表明这是最佳解决方案，我倾向于同意。
2.  另一种可能的方法是增加一个间接层，这样您就不会真正传递指向对象的指针，而是将索引传递到活动对象列表或其他内容中。
3.  您还可以考虑引用计数和垃圾收集。这样，对象只会在没有人再引用它们时被删除。相当多的工作，但作为脚本语言的用户，我希望它能够提供垃圾收集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T14:36:11.653

This is a really bad idea. Whether a pointer is safe to use is based on more than just the value of the pointer, it's based on the entire history of the pointer. For instance, let's say that you allocate some memory, then deallocate it but you keep the pointer to it. This pointer is now invalid. Now something else gets allocated to the memory where the previous pointer is. Now if you try to detect if the old pointer is valid, it appears that it is, because the memory it points to is allocated, but if you try to use it, you get undefined behavior. If you read from it, you'll get garbage. If you try to write to it you'll probably corrupt the heap.

If all you want to do is detect is whether your process can access the memory that the pointer points to, that is possible but not portable, and definitely not a good idea (it will also be very slow). You basically have try to read from or write to it, and then catch the OS exception or signal that results. As I said, even this is a really bad idea. All it tells you is whether the OS will kill your process if you try to access it; not whether it's actually safe to use.

For more on why this is a bad idea, check out these blog posts from Raymond Chen, who works on some low-level stuff Windows stuff:

[IsBadXxxPtr should really be called CrashProgramRandomly](http://blogs.msdn.com/b/oldnewthing/archive/2006/09/27/773741.aspx)

[There's no point improving the implementation of a bad idea](http://blogs.msdn.com/b/oldnewthing/archive/2007/06/25/3507294.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T01:34:59.553

您可以做的一件事是使用自己的分配器，您可以在其中分配所有对象。您的`exists`函数将简单地查询分配器以查看对象是否仍被分配。哟可以使用类似于 SMR 的东西来确保您的参考在仍在使用时不会指向其他东西......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-03T14:25:21.660

最简单的解决方案是使用地图。映射应该由一个指向对象的指针来索引，可能是一个`void *`. 地图项的内容应该是所创建对象的类型。

每当脚本创建一个对象时，就向地图添加一个条目。每当脚本删除对象时，请删除映射条目。当脚本访问对象时，在映射中找到指针，从而确认它存在并且类型正确。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-03T13:54:06.617

此有效检查仅在 Windows (VS) 中检查，功能如下：

```
#pragma once
//ptrvalid.h
__inline bool isValid(void* ptr) {
    if (((uint)ptr)&7==7)
        return false; //Not valid address at all (Maybe random pointer?)
    char _prefix;
    __try {
        _prefix=*(((char*)ptr)-1); //Get the prefix of this data
    } __except (true) { //Catch all unique exceptions (Windows exceptions) 
        return false; //Can't reach this memory
    }
    switch (_prefix) {
    case 0:    //Running release mode with debugger
    case -128: //Running release mode without debugger
    case -2:   //Running debug mode with debugger
    case -35:  //Running debug mode without debugger
        return false; //Deleted :(
        break;
    }
    return true; //Still alive!
} 
```

用法：

```
#include <stdio.h>
#include "ptrvalid.h"

void PrintValid(void* ptr) {
    if (isValid(ptr))
        printf("%d is valid.\n",ptr);
    else
        printf("%d is not valid.\n",ptr);
}

int main() {
    int* my_array=(int*)malloc(4);
    PrintValid(my_array);
    PrintValid((void*)99);
    free(my_array);
    PrintValid(my_array);
    my_array=new int[4];
    PrintValid(my_array);
    delete my_array;
    PrintValid(my_array);
    getchar();
} 
```

输出：

```
764776 is valid.
99 is not valid.
764776 is not valid.
774648 is valid.
774648 is not valid. 
```

函数说明：（它的作用）

函数在真正检查之前检查，如果地址有效\起点指向内存。之后，他检查这个进程是否可以到达这个内存的前缀（如果不能捕获异常），最后一个检查是检查这个内存的前缀是否在任何模式下被删除。(Debugging\Without Debug Mode\Release Mode) 如果函数通过了所有这些检查，则返回 true。

# javascript - HTML中多个表中同一列的相同[不固定]宽度

> ID：11787651
> 
> 赞同：3
> 
> 时间：2012-08-03T00:22:29.773
> 
> 标签：javascript, html, css, xhtml

我在同一页面上有几个表格，每个表格都有相同的列数。我希望所有表格中的第一列具有相同的宽度，第二列也是如此，等等。我不想指定固定宽度（例如，100px），而是让浏览器计算它。如何在 HTML/XHTML/CSS/js 中完成此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:47:39.433

您可以将宽度指定为 CSS 中总页面宽度的百分比。将相同的类分配给所有表中的第一列并设置`width: 15%;`这并不理想，因为布局会根据客户的分辨率而有所不同。你最好使用固定宽度`position: fixed;`

查看[CSS 类位置](http://www.w3schools.com/cssref/pr_class_position.asp)

# spring - 自定义 Spring 参数解析器

> ID：11787656
> 
> 赞同：0
> 
> 时间：2012-08-03T00:23:19.567
> 
> 标签：spring, spring-security

我希望为我的基于 Spring 的应用程序添加一些严格的跨脚本规则。我将推荐的 html 'defaultHtmlEscape' 添加为 true 并使用了标签，但仍有一些我们想要阻止的事情。我决定使用[https://www.owasp.org/index.php/OWASP_Java_HTML_Sanitizer_Project](https://www.owasp.org/index.php/OWASP_Java_HTML_Sanitizer_Project)中的 java html sanitizer 。这将要求我在每个读取参数的地方调用清理函数，这在很多地方都会发生变化。有一个中心地方我可以做到这一点吗？也许，一个类通过它解析所有参数？我看到Spring内部使用NamedParameterUtils来解析参数。有没有办法扩展它？

在 Spring 框架中还有其他方法可以做到这一点吗？

非常感谢任何指针。

谢谢，

阿莎

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:40:10.403

讨厌回答我自己的问题。您可以在 Spring 中添加一个过滤器类并让参数通过它们。更多信息位于： http: [//jeevanpatil.wordpress.com/2011/07/22/prevention_of_xss/](http://jeevanpatil.wordpress.com/2011/07/22/prevention_of_xss/) “过滤方法”部分。

# python - 假设自动线程化的 scipy 和 numpy 函数没有使用多核

> ID：11787657
> 
> 赞同：7
> 
> 时间：2012-08-03T00:23:22.267
> 
> 标签：python, multithreading, numpy, scipy, intel-mkl

我正在运行 Mac OS X 10.6.8 并且正在使用 Enthought Python Distribution。我希望 numpy 函数能够利用我的两个核心。我遇到了与这篇文章类似的问题：[python/numpy 中的多线程 blas，](https://stackoverflow.com/questions/5260068/multithreaded-blas-in-python-numpy)但是在完成了该海报的步骤之后，我仍然遇到了同样的问题。这是我的 numpy.show_config()：

```
lapack_opt_info:
    libraries = ['mkl_lapack95_lp64', 'mkl_intel_lp64', 'mkl_intel_thread', 'mkl_core', 'mkl_mc', 'mkl_mc3', 'pthread']
    library_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/lib']
    define_macros = [('SCIPY_MKL_H', None)]
    include_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/include']
blas_opt_info:
    libraries = ['mkl_intel_lp64', 'mkl_intel_thread', 'mkl_core', 'mkl_mc', 'mkl_mc3', 'pthread']
    library_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/lib']
    define_macros = [('SCIPY_MKL_H', None)]
    include_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/include']
lapack_mkl_info:
    libraries = ['mkl_lapack95_lp64', 'mkl_intel_lp64', 'mkl_intel_thread', 'mkl_core', 'mkl_mc', 'mkl_mc3', 'pthread']
    library_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/lib']
    define_macros = [('SCIPY_MKL_H', None)]
    include_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/include']
blas_mkl_info:
    libraries = ['mkl_intel_lp64', 'mkl_intel_thread', 'mkl_core', 'mkl_mc', 'mkl_mc3', 'pthread']
    library_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/lib']
    define_macros = [('SCIPY_MKL_H', None)]
    include_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/include']
mkl_info:
    libraries = ['mkl_intel_lp64', 'mkl_intel_thread', 'mkl_core', 'mkl_mc', 'mkl_mc3', 'pthread']
    library_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/lib']
    define_macros = [('SCIPY_MKL_H', None)]
    include_dirs = ['/Library/Frameworks/EPD64.framework/Versions/1.4.2/include'] 
```

与原始帖子的评论一样，我删除了设置变量的行`MKL_NUM_THREADS=1`。但即便如此，应该利用多线程的 numpy 和 scipy 函数一次也只使用我的一个内核。还有什么我应该改变的吗？

编辑：为了澄清，我试图让一个单一的计算，如 numpy.dot() 根据 MKL 实现自行使用多线程，我不想利用 numpy 计算释放控制的事实GIL，因此使多线程与其他功能更容易。

这是一个应该使用多线程但不在我的机器上的小脚本：

```
import numpy as np

a = np.random.randn(1000, 10000)
b = np.random.randn(10000, 1000)

np.dot(a, b) #this line should be multi-threaded 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T20:02:34.107

[This article](http://wiki.scipy.org/ParallelProgramming)似乎暗示numpy智能地使某些操作并行，这取决于操作的预测加速：

*   “如果你的 numpy/scipy 是使用其中之一编译的，那么 dot() 将在你不做任何事情的情况下并行计算（如果这更快的话）。”

根据 numpy 确定何时并行化特定 dot() 调用的启发式方法，您的小型（-ish）测试用例可能不会显示出显着的加速？也许尝试一个可笑的大操作，看看是否使用了两个核心？

附带说明一下，您的处理器/机器配置是否真的支持 BLAS？

# ruby-on-rails-3 - Rails 事务没有输入正确的数据

> ID：11787658
> 
> 赞同：0
> 
> 时间：2012-08-03T00:23:34.030
> 
> 标签：ruby-on-rails-3, transactions

我的应用程序中的注册表单允许用户创建一个帐户 - 它还创建他们的用户记录和一个 accounts_users (has_many :through) 记录。一旦他们单击提交，我将调用“setup_account”方法为用户的新帐户输入几个默认值。话虽如此，该方法已接近工作，但为我手动分配值的三个记录输入了不正确的值（即：user_id => @user 或：account_id => @account）。account_id 和 user_id 的错误值总是最终为 1。有没有人知道为什么这不起作用？

这是我的帐户模型：

```
 def self.setup_account(p)
    Account.transaction do
      @account = Account.new(p)
      @account.save!
      @user = @account.users.first
      @user.create_profile!
      @group = @account.groups.create!( :user_id => @user.id, :name => 'Default' )
      @group.members.create!( :account_id => @account.id, :user_id => @user.id )
      Role.all.each do |role|
        @account.roles_users.create!( :user_id => @user.id, :role_id => role.id )
      end
    end
    return @account
  end 
```

这是我的 AccountsController：

```
 def new
    @account = Account.new
    @user = @account.users.build()
    @account.accounts_users.build()
    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @account }
    end
  end

  def create
    @account = Account.setup_account(params[:account])
    respond_to do |format|
      if !@account.nil?
        flash[:domain] = @account.subdomain
        format.html { redirect_to thanks_url }
        format.json { render json: @account, status: :created, location: @account }
      else
        format.html { render action: "new" }
        format.json { render json: @account.errors, status: :unprocessable_entity }
      end
    end
  end 
```

我的模型协会是：

*   帐户（has_many：用户；：通过 account_users；has_many：accounts_users；has_many：groups；has_many：members；has_many：roles_users）
*   用户（has_one :profile; has_many :accounts_users; has_many :accounts, :through => :accounts_users; has_many :members; has_many :groups; has_many :roles_users; has_many :roles, :through => :roles_users）
*   Accounts_User（belongs_to :account；belongs_to :user）
*   组（has_many：members，as：membership；belongs_to：user；belongs_to：account）
*   成员（belongs_to :membership, :polymorphic => true；belongs_to :account；belongs_to :user）
*   个人资料（belongs_to :user）
*   角色（has_many :roles_users; has_many :users :through => :roles_users; has_many :accounts, :through => :roles_users）
*   RolesUser（belongs_to :user；belongs_to :account；belongs_to :role）

编辑：编辑 setup_account 方法并创建操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T05:24:33.160

在您的模型方法中检查我的评论，

```
def self.setup_account(p)
  Account.transaction do
    @account = Account.new(p)
    # Account is not created yet so @account.users won't be retrieved properly, I guess
    # You need to save account first.
    @user = @account.users.first
    @user.build_profile
    @group = @account.groups.build( :user_id => @user, :name => 'Default' ) #Error
    @group.members.build( :account_id => @account, :user_id => @user ) #Error
    Role.all.each do |role| #Error
      @account.roles_users.build( :user_id => @user, :role_id => role.id )
    end
    # Try moving this above my comment.
    @account.save!
  end
end 
```

由于您使用的是事务块，因此您可以在构建它们后立即开始保存它们。如果出现任何错误，它将自动回滚。

# c# - 用于嵌入到 Microsoft Office 和 Powerpoint 中的用户定义的 c# 控件

> ID：11787661
> 
> 赞同：1
> 
> 时间：2012-08-03T00:23:54.420
> 
> 标签：c#, wpf-controls, ms-word, custom-controls, ms-office

我想创建一个自己的图表控件，可以嵌入到办公文档中使用。如果用户不与之交互，该控件应该是被动的。当用户点击它时，新的功能区控件等也应该是可能的。

建立这样的东西的最佳解决方案是什么？几年前，这可以通过 ole 对象实现。这仍然是一个好的解决方案，还是 OLE 控制元素死路一条？以下是哪些技术？

有没有好的 WPF 或 winforms 解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T10:54:44.567

Carter & Lippert “Visual Studio Tools for Office 2007”的第 13 章介绍了在 VSTO 中使用 Windows 窗体和 WPF。

简短的回答，VSTO 支持 Windows 窗体控件，包括一个名为 ElementHost 的控件，它允许您使用 WPF 控件。

例如，谷歌搜索“vsto elementhost”会产生[这个](http://xamlcoder.com/cs/blogs/joe/archive/2007/07/17/using-wpf-with-vsto-office-2007.aspx)。

# java - 在 Java 中如何更改或设置默认打印机

> ID：11787662
> 
> 赞同：2
> 
> 时间：2012-08-03T00:23:57.197
> 
> 标签：java, printing

我知道如何获取可用打印机的列表，我希望用户能够从列表中进行选择并将其设置为会话的默认值

使用 Windows 7

我知道这很容易做到我只想创建一个简单的java程序a：增加我的知识b：这里的老师非常不喜欢玩打印属性

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-09T05:24:18.693

您知道如何获取所有打印机的列表，然后您想设置默认打印机。

## 好的，此代码将帮助您将要设置为默认打印机的打印机名称传递给“MYPRINTER”。将其替换为打印机名称。

```
PrinterJob pj = PrinterJob.getPrinterJob();
    PrintService[] printServices = PrintServiceLookup.lookupPrintServices(null, null);
    System.out.println("Number of printers configured: " + printServices.length);
    for (PrintService printer : printServices) {
        System.out.println("Printer: " + printer.getName());
        if (printer.getName().equals("***MYPRINTER***")) {
            try {
                pj.setPrintService(printer);
            } catch (PrinterException ex) {
            }
        }
    } 
```

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T00:49:26.460

该程序在 Eclipse 中运行。

```
import java.awt.print.PageFormat;

import java.awt.print.PrinterJob;

public class PrinterSetup 
{

    public static void main(String[] args) throws Exception
    {
        PrinterJob pjob = PrinterJob.getPrinterJob();
        PageFormat pf = pjob.defaultPage();
        pjob.setPrintable(null, pf);

        if (pjob.printDialog()) {
          pjob.print();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-08T18:47:35.547

我做了一个解决方法来设置操作系统默认打印机。这个适用于windows，它基本上执行一个cmd命令，在执行打印代码之前设置默认打印机：

```
Desktop desktop = null
if (Desktop.isDesktopSupported()) {
desktop = Desktop.getDesktop()
    desktop.print(file)
 } 
```

这是我的功能：

```
public static boolean setDefaultPrinter(String printerName) {
    String defaultPrinterSetter = "wmic printer where name='"+ printerName +"' call setdefaultprinter";
    try {
        setDefaultPrinterProcess = Runtime.getRuntime().exec("cmd /c start cmd.exe /C " + defaultPrinterSetter);
        return true;
    } catch (Exception e) {
        e.printStackTrace();
        return false;
    }
} 
```

您需要做的就是将打印机名称传递给此函数，它将使其成为默认打印机。

这是一个获取所有可用打印机服务列表的函数：

```
public static ArrayList<PrintService> availablePrinters() {
    PrintService[] services = PrinterJob.lookupPrintServices();
    ArrayList<PrintService> allServices = new ArrayList<>();

    for (PrintService myService : services) {
        allServices.add(myService);
    }
    return allServices;
} 
```

而且我假设您想在组合框中添加一个列表或供用户选择的东西。它应该是这样的

```
 ArrayList<PrintService> availableServices = availablePrinters();
    System.out.println("All printers list:");
    for (PrintService myService : availableServices) {
        myCombo.getItems().add(myService.getName());
        System.out.println(myService.getName());
    } 
```

# c# - 从字符串中删除特定单词（不区分大小写）

> ID：11787663
> 
> 赞同：1
> 
> 时间：2012-08-03T00:24:09.437
> 
> 标签：c#, .net, regex, winforms, replace

我得到包含许多我想从内容中“删除/替换”的单词的工作内容。例子：

```
postcodes,Thank you , Click here 
```

**问题**

我有一个要从内容中删除的单词列表，但我不确定这些单词将如何出现在内容中（大写/小写）...

那么，我该如何替换它们呢？

示例 - 我想替换：

```
associate degree in electronics or applicable equivalent 
```

但在内容中它可以是：

```
associate Degree in electronics or applicable equivalent
Associate DEGREE in electronics or applicable equivalent
ASSOCIATE DEGREE IN ELECTRONICS or applicable equivalent 
```

我该如何替换它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:27:59.967

尝试这个：

```
(?i)(associate DEGREE in ELECtronics) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T02:29:25.193

如果您想使用正则表达式，一种可能的解决方案是：

```
Regex.Replace(input, @"(?i)(associate\s+degree\s+in\s+electronics\s+or\s+applicable\s+equivalent)", String.Empty); 
```

您可以使用相同的模式但创建一个 Regex 对象，因此您可以提供 RegexOptions ，例如：

```
Regex r = new Regex(@"(?i)(associate\s+degree\s+in\s+electronics\s+or\s+applicable\s+equivalent)", RegexOptions.Compiled); 
```

稍后您可以将其用作：

```
r.Replace(input, String.Empty); 
```

注意：使用具体的 Regex 对象为您提供更灵活的替换策略的优势，例如 MatchEvaluator、替换次数作为计数等......

# javascript - 如何从 src 加载调整大小或拉伸的图像

> ID：11787664
> 
> 赞同：0
> 
> 时间：2012-08-03T00:24:15.227
> 
> 标签：javascript, image, canvas, onload

我在画布中绘制此图像时使用了 fill()。我使用以下代码加载图像：

```
var cerceve = new Image();
if ($(".cerceve.accessory-selected").length) {
    cerceve.onload = function () {
        cerceveDeferred.resolve();
    };
    cerceve.src = $(".cerceve.accessory-selected:first img").attr("src"); 
```

基本上，我定义了`src`对象，`Image`然后当它加载时，我开始在屏幕上绘制它。但我希望图像以自定义尺寸加载，我该怎么做？我不能使用调整大小`drawImage()`，因为我需要使用`fill()`方法并且它没有指定任何调整大小选项。

例如，如果我`cerceve.height = 40;`在`cerceve`加载后设置，它会绘制高度为 40 的图像（40 比原始高度大），但源图像不会被拉伸，而是重复，绘制许多相同的图像。我给它一个自定义高度，并且图像的行为与重复选项一起使用。我想让它伸展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:05:07.670

好，我知道了。与其在加载后尝试调整源图像的大小，不如在画布上绘制图像时使用上下文缩放。`context.scale(x,y);`可能是要走的路。

# javascript - 确保至少选中一个复选框

> ID：11787665
> 
> 赞同：30
> 
> 时间：2012-08-03T00:24:41.473
> 
> 标签：javascript, html, checkbox

我有一个带有多个复选框的表单，我想使用 JavaScript 来确保至少选中一个。这就是我现在所拥有的，但无论选择什么，都会弹出警报。

> JS（错误）

```
function valthis(){
 if (document.FC.c1.checked) {
   alert ("thank you for checking a checkbox")
  } else  {
   alert ("please check a checkbox")
  }
} 
```

> HTML

```
<p>Please select at least one Checkbox</p>
<br>
<br>
<form name = "FC">
<input type = "checkbox" name = "c1" value = "c1"/> C1 
<br>
<input type = "checkbox" name = "c1" value = "c2"/> C2
<br>
<input type = "checkbox" name = "c1" value = "c3"/> C3
<br> 
<input type = "checkbox" name = "c1" value = "c4"/> C4 
<br>
</form>
<br>
<br>

<input type = "button" value = "Edit and Report" onClick = "valthisform();"> 
```

> 所以我最终在 JS 中做的是：

```
function valthisform(){
 var chkd = document.FC.c1.checked || document.FC.c2.checked||document.FC.c3.checked|| document.FC.c4.checked

 if (chkd == true){

 } else {
    alert ("please check a checkbox")
 }

} 
```

我决定放弃“谢谢”部分以适应其余的作业。非常感谢，每个人的建议真的很有帮助。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-03T00:40:53.940

如果您打算引用它们，则应避免使用两个具有相同名称的复选框`document.FC.c1`。如果您有多个名为的复选框`c1`，浏览器将如何知道您指的是哪个？

这是一个非 jQuery 解决方案，用于检查页面上是否有任何复选框被选中。

```
var checkboxes = document.querySelectorAll('input[type="checkbox"]');
var checkedOne = Array.prototype.slice.call(checkboxes).some(x => x.checked); 
```

您需要将返回的`Array.prototype.slice.call`部分转换为可以调用的数组。`NodeList``document.querySelectorAll``some`

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-08-03T00:48:47.503

这应该有效：

```
function valthisform()
{
    var checkboxs=document.getElementsByName("c1");
    var okay=false;
    for(var i=0,l=checkboxs.length;i<l;i++)
    {
        if(checkboxs[i].checked)
        {
            okay=true;
            break;
        }
    }
    if(okay)alert("Thank you for checking a checkbox");
    else alert("Please check a checkbox");
} 
```

如果您对代码有任何疑问，请发表评论。

* * *

^(我`l=checkboxs.length`用来提高性能。请参阅[http://www.erichynds.com/javascript/javascript-loop-performance-caching-the-length-property-of-an-array/](http://www.erichynds.com/javascript/javascript-loop-performance-caching-the-length-property-of-an-array/))

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-01-01T21:00:20.497

我会选择更实用的方法。自从 ES6 以来，我们得到了解决问题的好工具，所以为什么不使用它们呢。让我们从给复选框一个类开始，这样我们就可以很好地将它们四舍五入。我更喜欢使用类而不是 input[type="checkbox"] 因为现在解决方案更通用，并且当您的文档中有更多复选框组时也可以使用。

HTML

```
 <input type="checkbox" class="checkbox" value=ck1 /> ck1<br />
    <input type="checkbox" class="checkbox" value=ck2 /> ck2<br /> 
```

JavaScript

```
function atLeastOneCheckboxIsChecked(){
    const checkboxes = Array.from(document.querySelectorAll(".checkbox"));
    return checkboxes.reduce((acc, curr) => acc || curr.checked, false);
} 
```

调用时，如果未选中任何复选框，则该函数将返回 false，如果选中一个或两个，则返回 true。

它的工作原理如下，reducer 函数有两个参数，累加器 (acc) 和当前值 (curr)。对于数组的每次迭代，如果累加器或当前值为 true，reducer 将返回 true。前一次迭代的返回值是当前迭代的累加器，因此，如果它曾经为真，它将保持真直到结束。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-03T01:19:33.707

[检查这个。](http://jsfiddle.net/qyE97/)

您不能通过他们的名字访问表单输入。改用`document.getElements`方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-02-25T06:35:15.350

**香草JS：**

```
var checkboxes = document.getElementsByClassName('activityCheckbox'); // puts all your checkboxes in a variable

function activitiesReset() {
    var checkboxesChecked = function () { // if a checkbox is checked, function ends and returns true. If all checkboxes have been iterated through (which means they are all unchecked), returns false.
        for (var i = 0; i < checkboxes.length; i++) {
            if (checkboxes[i].checked) {
                return true;
            }
        }
        return false;
    }
    error[2].style.display = 'none'; // an array item specific to my project - it's a red label which says 'Please check a checkbox!'. Here its display is set to none, so the initial non-error label is visible instead. 
        if (submitCounter > 0 && checkboxesChecked() === false) { // if a form submit has been attempted, and if all checkboxes are unchecked
            error[2].style.display = 'block'; // red error label is now visible.
        }
}

for (var i=0; i<checkboxes.length; i++) {  // whenever a checkbox is checked or unchecked, activitiesReset runs.
    checkboxes[i].addEventListener('change', activitiesReset);
} 
```

**说明：**
一旦尝试提交表单，这将更新您的复选框部分的标签，以通知用户如果他/她还没有选中复选框。如果未选中复选框，则会显示隐藏的“错误”标签，提示用户“请选中复选框！”。如果用户选中至少一个复选框，红色标签会立即再次隐藏，露出原始标签。如果用户再次取消选中所有复选框，红色标签会实时返回。这可以通过 JavaScript 的`onchange`事件（写成`.addEventListener('change', function(){});`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-10T21:27:41.933

防止用户取消选择最后选中的复选框。
jQuery（原始答案）。

```
$('input[type="checkbox"][name="chkBx"]').on('change',function(){
    var getArrVal = $('input[type="checkbox"][name="chkBx"]:checked').map(function(){
        return this.value;
    }).toArray();

    if(getArrVal.length){
        //execute the code
        $('#msg').html(getArrVal.toString());

    } else {
        $(this).prop("checked",true);
        $('#msg').html("At least one value must be checked!");
        return false;

    }
}); 
```

**更新的答案 2019-05-31 纯**
JS

```
let i,
    el = document.querySelectorAll('input[type="checkbox"][name="chkBx"]'),
    msg = document.getElementById('msg'),
    onChange = function(ev){
        ev.preventDefault();
        let _this = this,
            arrVal = Array.prototype.slice.call(
                document.querySelectorAll('input[type="checkbox"][name="chkBx"]:checked'))
                    .map(function(cur){return cur.value});

        if(arrVal.length){
            msg.innerHTML = JSON.stringify(arrVal);
        } else {
            _this.checked=true;
            msg.innerHTML = "At least one value must be checked!";
        }
    };

for(i=el.length;i--;){el[i].addEventListener('change',onChange,false);}
```

```
<label><input type="checkbox" name="chkBx" value="value1" checked> Value1</label>
<label><input type="checkbox" name="chkBx" value="value2"> Value2</label>
<label><input type="checkbox" name="chkBx" value="value3"> Value3</label>
<div id="msg"></div>
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-20T12:16:44.487

您可以使用这个简单的代码检查是否选中了至少一个复选框。您也可以删除您的消息。

参考[链接](http://34codefactory.blogspot.in/2017/12/at-least-one-checkbox-is-checked-from.html)

```
<label class="control-label col-sm-4">Check Box 2</label>
    <input type="checkbox" name="checkbox2" id="checkbox2" value=ck1 /> ck1<br />
    <input type="checkbox" name="checkbox2" id="checkbox2" value=ck2 /> ck2<br />

<script>
function checkFormData() {
    if (!$('input[name=checkbox2]:checked').length > 0) {
        document.getElementById("errMessage").innerHTML = "Check Box 2 can not be null";
        return false;
    }
    alert("Success");
    return true;
}
</script> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-10T14:25:22.530

```
< script type = "text/javascript" src = "js/jquery-1.6.4.min.js" >  <  / script >
     < script type = "text/javascript" >

function checkSelectedAtleastOne(clsName) {
    if (selectedValue == "select")
        return false;

    var i = 0;
    $("." + clsName).each(function () {

        if ($(this).is(':checked')) {
            i = 1;
        }

    });

    if (i == 0) {
        alert("Please select atleast one users");
        return false;
    } else if (i == 1) {
        return true;
    }

    return true;

}

$(document).ready(function () {
    $('#chkSearchAll').click(function () {

        var checked = $(this).is(':checked');
        $('.clsChkSearch').each(function () {
            var checkBox = $(this);
            if (checked) {
                checkBox.prop('checked', true);
            } else {
                checkBox.prop('checked', false);
            }
        });

    });

    //for select and deselect 'select all' check box when clicking individual check boxes
    $(".clsChkSearch").click(function () {

        var i = 0;
        $(".clsChkSearch").each(function () {

            if ($(this).is(':checked')) {}
            else {

                i = 1; //unchecked
            }

        });

        if (i == 0) {
            $("#chkSearchAll").attr("checked", true)
        } else if (i == 1) {

            $("#chkSearchAll").attr("checked", false)
        }

    });

});

<  / script > 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-06-05T10:40:48.400

```
if(($("#checkboxid1").is(":checked")) || ($("#checkboxid2").is(":checked"))
            || ($("#checkboxid3").is(":checked"))) {
 //Your Code here
} 
```

您可以使用此代码来验证复选框是否至少被选中一个。

谢谢！！

# emacs - 如何跳转到当前文件中的标签？

> ID：11787666
> 
> 赞同：1
> 
> 时间：2012-08-03T00:24:43.793
> 
> 标签：emacs

我正在从 vim 切换到 emacs。并试图找到一种方法来跳转到当前 java 文件中的标记，就像 vim 一样。例如，我有两个类都有一个名为的方法`foo`，但是当我`find-tag foo`在类中时`B`，它可能会跳转到`foo`类中的方法`A`。

# c - 使用 Delphi 使用 C dll

> ID：11787669
> 
> 赞同：4
> 
> 时间：2012-08-03T00:24:53.920
> 
> 标签：c, delphi, dll, freepascal, lazarus

我有一个带有这个签名的 Dll 函数：

```
UInt32 Authenticate(uint8 *Key); 
```

我在 Delphi 上这样做：

```
function Authenticate(Key:string) : UInt32; external 'mylib.dll' name 'Authenticate'; 
```

但总是，函数返回 10（错误代码）并且应用程序刹车：\

有办法做到这一点吗？

**更新：** *谢谢大家！你是最好的！*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T01:12:32.280

您的代码存在一些问题。

1)`uint8`是`Byte`Delphi 中的等价物，而不是`String`.

2) C 代码使用编译器的默认调用约定，通常是`__cdecl`. 另一方面，Delphi 的默认调用约定是`register`。它们彼此不兼容。如果调用约定不匹配，则在运行时的函数调用期间将无法正确管理堆栈和 CPU 寄存器。

C 代码的直译是这样的：

```
function Authenticate(Key: PByte) : UInt32; cdecl; external 'mylib.dll'; 
```

但是，假设该函数实际上需要一个以空字符结尾的字符串，则改为执行以下操作：

```
// the function is expecting a pointer to 8-bit data,
// so DO NOT use `PChar`, which is 16-bit in Delphi 2009+...
function Authenticate(Key: PAnsiChar) : UInt32; cdecl; external 'mylib.dll'; 
```

我会坚持第一个声明，因为它与原始 C 代码相匹配。即使该函数期望一个以 null 结尾的字符串作为输入，您仍然可以`PByte`通过类型转换将其传递给 using：

```
var
  S: AnsiString;
begin
  Authenticate(PByte(PAnsiChar(S)));
end; 
```

或者，如果函数允许空字符串输入 NULL：

```
var
  S: AnsiString;
begin
  Authenticate(PByte(Pointer(S)));
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T11:01:44.080

我不会在伟大的 Remy 的回答中添加任何内容，但我想提供一个可以帮助将 C DLL 头文件转换为 Pascal 的工具列表（无特殊顺序）：

*   [http://sourceforge.net/projects/c2pas](http://sourceforge.net/projects/c2pas)
*   [http://www.astonshell.com/freeware/c2pas32](http://www.astonshell.com/freeware/c2pas32)
*   [http://cc.embarcadero.com/item/26951](http://cc.embarcadero.com/item/26951)
*   [http://rvelthuis.de/programs/convertpack.html](http://rvelthuis.de/programs/convertpack.html)
*   [http://www.drbob42.com/delphi/headconv.htm](http://www.drbob42.com/delphi/headconv.htm)
*   [http://wiki.lazarus.freepascal.org/H2Pas](http://wiki.lazarus.freepascal.org/H2Pas)
*   [http://wiki.freepascal.org/Chelper](http://wiki.freepascal.org/Chelper)

请注意，这些转换器只能转换 60-80% 的代码，因此需要手动操作。

我可以给出的最大的节省时间的提示是尝试找到适用于您的 DLL 的 Visual Basic 头文件翻译，并使用[http://www.marcocantu.com/tools/vb2delphi.htm](http://www.marcocantu.com/tools/vb2delphi.htm)上的 Marco Cantu 的 VB 转换器。这可能会为您提供几乎 100% 的自动转换（当然，如果您只是转换 DLL 标头）。还有一个商业 VBTO 转换器，但试用演示足以将 VB DLL 头文件转换为 Pascal。在这里下载：[http ://www.vbto.net](http://www.vbto.net)

从 C--/C++ 转换的其他提示：

*   [http://rvelthuis.de/articles/articles-convert.html](http://rvelthuis.de/articles/articles-convert.html)
*   [http://rvelthuis.de/articles/articles-pchars.html](http://rvelthuis.de/articles/articles-pchars.html)
*   [http://rvelthuis.de/articles/articles-cobjs.html](http://rvelthuis.de/articles/articles-cobjs.html)
*   [http://rvelthuis.de/articles/articles-cppobjs.html](http://rvelthuis.de/articles/articles-cppobjs.html)
*   [http://www.awitness.org/delphi_pascal_tutorial/c++_delphi](http://www.awitness.org/delphi_pascal_tutorial/c++_delphi)

稍微偏离主题，但我认为这可能对某人有用......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T00:39:20.853

对于初学者，将“string”更改为“pchar”。

除此之外可能还有其他问题。

# php - 如何使用mysql检索最后插入的id？

> ID：11787671
> 
> 赞同：0
> 
> 时间：2012-08-03T00:25:06.933
> 
> 标签：php, mysql

```
 SELECT event.event_name, restaurants.res_name 
 FROM event_choices
 INNER JOIN restaurants
 ON event_choices.res_id = restaurants.res_id
 INNER JOIN event
 ON event_choices.event_id = event.event_id 
```

我正在尝试根据`event_id`此查询获取最后插入的记录，从而带回所有记录。

类似于`mysql_insert_id()`会做什么。

是否可以修改查询以仅返回最后插入的记录？

我的数据看起来像这样我需要返回最后一个`event_id`及其匹配`res_id`

```
event_id  | res_id
116       | 1
116       | 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:28:13.423

```
SELECT event.event_name, restaurants.res_name 
FROM event_choices
INNER JOIN restaurants ON event_choices.res_id = restaurants.res_id
INNER JOIN event ON event_choices.event_id = event.event_id 
WHERE event.event_id = (SELECT MAX(event_id) FROM event) 
```

# oracle - 从选择中删除下划线

> ID：11787676
> 
> 赞同：0
> 
> 时间：2012-08-03T00:25:55.273
> 
> 标签：oracle, select

在我的 select 语句中，有一列包含下划线字符`_`。我想用空格替换下划线。例如，如果结果集列包含`CLOSING_COMPANY`，则结果应为`CLOSING COMPANY`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T02:20:55.160

如果要更改结果集中列的名称

```
SELECT closing_company AS "CLOSING COMPANY"
  FROM your_table_name 
```

如果要更改列中的数据

```
SELECT REPLACE( column_name, '_', ' ' ) 
  FROM your_table_name 
```

# javascript - 评论回调函数

> ID：11787678
> 
> 赞同：7
> 
> 时间：2012-08-03T00:26:18.563
> 
> 标签：javascript, coding-style, documentation, comments

只是好奇什么是注释将传递给回调函数的参数的好方法。

假设我们有以下代码和*不完整*的注释

```
/**
 * an utterly useless function
 *
 * @param {String} an useless string
 * @param {Boolean} an useless boolean
 * @param {Function} ???
 */

function Useless (str, bool, callback) {
  callback(str, bool);
} 
```

用 str 和 bool 参数调用回调的好方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T00:53:33.480

通常你只需要用说话的名字写一个函数的调用：

```
/* 
 * @param {String} input: the text
 * @param {Function} callback(output, hasChanged): called after calculation
 */ 
```

或者，如果参数需要解释，您可以使用多行描述：

```
/* 
 * @param {String} input: the text
 * @param {Function} callback(result, change)
 *         the function that is called after calculation
 *         result {String}: the output of the computation
 *         change {Boolean}: whether a change has occurred
 */ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T00:34:27.440

我不知道这方面的任何约定。我只会使用：

```
@param {Function} Called on success with the response (string) as the first param and the status code (int) as the second 
```

我知道这很冗长。

另一种选择是这样做（类似于 jQuery 的做法，不是在我知道的代码中，而是在他们的文档中）

```
@param {Function} onSuccess(response, statusCode) 
```

这是一个示例[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/) 当然是不同的，因为这是一个选项对象，并且文档具有与内联文档不同的结构。但看看回调，你会看到相似之处。

为了清楚起见，使用 callback(response, statusCode) 比使用 callback(string, int) 也是一个更好的主意。如果你必须选择一个，那就是。类型前的含义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-08T13:24:12.643

好吧，有很多方法可以在 javascript 中添加注释；这是我的**建议/最佳实践**。

using`//`比使用更好，`/* */`因为您可以使用后者取出包含其他注释的整个块。但是，如果要使用自动文档生成工具，则必须使用类似于 javaDoc 样式的注释。

这是一个适用于 YUI DOC 的示例（最好的一个）[http://developer.yahoo.com/yui/yuidoc/#start](http://developer.yahoo.com/yui/yuidoc/#start)

```
/**
* This is a description
* @namespace My.Namespace
* @method myMethodName
* @param {String} str - some string
* @param {Object} obj - some object
* @param {requestCallback} callback - The callback that handles the response.
* @return {bool} some bool
*/
    function SampleFunction (str, obj, callback) {
         var isTrue = callback(str, obj); // do some process and returns true/false.
         return isTrue ;
    } 
```

其他参数示例：- [http://usejsdoc.org/tags-param.html](http://usejsdoc.org/tags-param.html)

**希望这会帮助你:)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-17T09:14:43.850

```
/**
 * an utterly useless function
 *
 * @param {String} an useless string
 * @param {Boolean} an useless boolean
 * @param {(param1:Number, param2:String ...)=>{}} callback
 */

function Useless (str, bool, callback) {
  callback(str, bool);
} 
```

# facebook - 在登录后的页面中添加 FB 分享按钮

> ID：11787684
> 
> 赞同：0
> 
> 时间：2012-08-03T00:27:24.920
> 
> 标签：facebook, facebook-like

我有需要用户登录的网页（虽然不是 FB 登录），并且需要向其添加共享按钮。问题是当我分享那个页面时，它只发布到墙上的链接。og 图像和 og:description 标记被忽略。

顺便说一句，我正在使用 iframe 来显示 fb:like

你能告诉我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:13:44.977

即使用户未登录，您也需要生成开放图形标签。

# php - PHP SQL 注册表单

> ID：11787685
> 
> 赞同：0
> 
> 时间：2012-08-03T00:27:27.910
> 
> 标签：php, html, sql, registration

我正在尝试将数据保存到 sql 数据库中的注册表单。我还没有进行表单验证，因为最困扰我的是将这些东西放到 sql 中。我将不胜感激任何建议！

我有一个 form.php 文件，应该做艰苦的工作。当我提交表单时，此时，我得到一个空白屏幕，并且没有任何内容加载到数据库中。

```
<?php
$fname = $_POST['fname'];
$lname = $_POST['lname'];
$password = $_POST['password'];
$email = $_POST['email'];
$cell = $_POST['cell'];
$experience = $_POST['experience'];
$ip = $_POST['ip'];

$password = md5($_POST['password']);

$connection = msql_connect(localhost, USERNAME, PASSWORD);
$db = mysql_select_db(registration,$connection);    

mysql_query("INSERT INTO userTable (fname,lname,password,email,cell,experience,ip) VALUES ('$fname', '$lname', '$password', '$email', '$cell', '$experience', '$ip')")
    or die (mysql_error());

echo "Thank you for your registration";

?> 
```

我有一个包含以下内容的 html 文件：

```
 <form method = "post" action = "form.php">
            <h2>User Information</h2>

            <div><label>First Name:</label>
                <input type = "text" name = "fname"></div>
            <div><label>Last Name:</label>
                <input type = "text" name = "lname"></div>
            <div><label>Password:</label>
                <input type = "password" name = "password"></div>
            <div><label>Email:</label>
                <input type="text" name="email"></div>
            <div><label>Cellphone:</label>
                <input type="text" name="cell"></div>
                <input type="hidden" name="ip" value='<?php echo $IP ?>'/>
            <h2>What Is Your Experience Mountain Biking?</h2>
            <p><input type="radio" name="experience" value="n00b"
                checked>n00b
                <input type="radio" name="experience" value="intermediate">Intermediate
                <input type="radio" name="experience" value="extreme">Extreme                   
                </p>
            <p><input type="submit" name="submit" value="Register"></p>
        </form> 
```

最后，我有一个名为“registration”的 sql 数据库（我在本地运行 xampp）我创建的表名为“userTable”，它包含 8 个字段，包括 ID（自动递增）和我包含的 7 个其他值在上面。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:45:54.443

问题是什么？

1）问题是每次加载此页面时它都会进行 INSERT 查询 - 意味着每次插入空值时。为什么？

仅仅因为没有条件检查是否所有字段都已发布，所以而不是：

```
<?php

$fname = $_POST['fname'];
$lname = $_POST['lname'];
$password = $_POST['password'];
$email = $_POST['email'];
$cell = $_POST['cell'];
$experience = $_POST['experience'];
$ip = $_POST['ip']; 
```

您应该检查`$_POST`super-global 是否有一些键。所以在做任何查询之前 - 首先检查是否`$_POST`不为空

```
<?php

//This means that user did submit the form
if ( !empty($_POST) ){

  //all your stuff goes here
}

?>
<html>
.....
</html> 
```

2）您确定您可以控制您的代码吗？显然不是。

您必须检查是否返回了某个函数`TRUE`，然后根据它执行以下操作。

例如，你确定那`mysql_query("your sql query")`是成功的吗？

3) 为 E_ALL 启用 error_reporting，所以只需放在`error_reporting(E_ALL)`页面顶部，如下所示：

```
<?php

error_reporting(E_ALL); 
```

这样您就可以随时“即时”调试脚本

4）您正在尽一切努力使此代码难以维护，为什么？看这个：

```
<?php

//Debug mode:
error_reporting(E_ALL);

//Sure you want to show some error if smth went wrong:
$errors = array(); 

/**
 * 
 * @return TRUE if connection established 
 * FALSE on error
 */
function connect(){

 $connection = mysql_connect(localhost, USERNAME, PASSWORD);
 $db = mysql_select_db(registration,$connection);    

 if (!$connection || !$db ){
   return false; 
 } else {
   return true;
 }
}

//So this code will run if user did submit the form:
if (!empty($_POST)){

 //Connect sql server:
 if ( !connect() ){
   $errors[] = "Can't establish link to MySQL server";
 }

 $fname = $_POST['fname'];
 $lname = $_POST['lname'];
 $password = $_POST['password'];
 $email = $_POST['email'];
 $cell = $_POST['cell'];
 $experience = $_POST['experience'];
 //Why post ip? not smth like $_SERVER['REMOTE_ADDR']...
 $ip = $_POST['ip'];

 $password = md5($_POST['password']);

 //No error at this point - means that it successfully connected to SQL server: 
 if ( empty($errors) ){

  //let's prevent sql injection:

  $fname = mysql_real_escape_string($fname);
  //Please do this for all of them..
 }

//Now we should try to INSERT the vals:

$query = "INSERT INTO `userTable` (`fname`,`lname`,`password`,`email`,`cell`,`experience`,`ip`) VALUES ('$fname', '$lname', '$password', '$email', '$cell', '$experience', '$ip')";

//So try it:
if ( !mysql_query($query) ){
   // 
   //die (mysql_error());
   $errors[] = "Can't insert the vals";
} else {
   //Or on success:
   print ("Thank you for your registration");
   //or you can do redirect to some page, like this:

  //header('location: /thanks.php');
}

}

?>

<form method="post">
            <h2>User Information</h2>

            <div><label>First Name:</label>
                <input type = "text" name = "fname"></div>
            <div><label>Last Name:</label>
                <input type = "text" name = "lname"></div>
            <div><label>Password:</label>
                <input type = "password" name = "password"></div>
            <div><label>Email:</label>
                <input type="text" name="email"></div>
            <div><label>Cellphone:</label>
                <input type="text" name="cell"></div>
                <input type="hidden" name="ip" value='<?php echo $IP ?>'/>
            <h2>What Is Your Experience Mountain Biking?</h2>
            <p><input type="radio" name="experience" value="n00b"
                checked>n00b
                <input type="radio" name="experience" value="intermediate">Intermediate
                <input type="radio" name="experience" value="extreme">Extreme                   
                </p>

            <?php if ( !empty($errors) ) : ?>

            <?php foreach($errors as $error): ?> 
             <p><b><?php echo $error; ?></b></p>
            <?php endforeach; ?> 
             <?php endif; ?>

            <p><input type="submit" name="submit" value="Register"></p>
        </form> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-03T01:59:11.723

```
Solved my own problem

<?php
$fname = $_POST['fname'];
$lname = $_POST['lname'];
$password = $_POST['password'];
$email = $_POST['email'];
$cell = $_POST['cell'];
$experience = $_POST['experience'];
$ip = $_POST['ip'];

$fname = mysql_real_escape_string($fname);
$lname = mysql_real_escape_string($lname);
$email = mysql_real_escape_string($email);
$password = md5($_POST['password']);

$servername="localhost";
$username="user";
$conn=  mysql_connect($servername,$username, password)or die(mysql_error());
mysql_select_db("registration",$conn);
$sql="insert into userTable (fname,lname,password,email,cell,experience,ip) VALUES ('$fname', '$lname', '$password', '$email', '$cell', '$experience', '$ip')";

$result=mysql_query($sql,$conn) or die(mysql_error());          
print "<h1>you have registered sucessfully</h1>";

echo "Thank you for your registration to the ";

mysql_close($connection); 
```

?>

# ruby-on-rails - 如何从 Rails 活动记录中返回查询，以便将它们传递回客户端日志控制台

> ID：11787691
> 
> 赞同：2
> 
> 时间：2012-08-03T00:28:01.000
> 
> 标签：ruby-on-rails, activerecord, logging, client

当客户端点击我的 Rails 应用程序的数据 API 时，我想传回使用数据生成数据的查询。我正在使用 Rails 2。

现在我已经编辑了 Rails mysql_adapter 以将所有查询放在一个全局哈希中，其中用户会话作为键，查询作为值。

这是非常hacky并且可能不是线程安全的。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T01:02:15.570

不知道它是否有帮助，但您可以随时调用`to_sql`ActiveRecord 对象：

```
user = User.where(:id => 1)
user.to_sql # Outputs "SELECT \"users\".* FROM \"users\"  WHERE \"users\".\"id\" = 1" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T11:19:45.353

您可以使用[fake_arel](https://github.com/gammons/fake_arel) gem 将`.to_sql`功能放入 rails 2。

# php - 系统 str_replace

> ID：11787692
> 
> 赞同：-3
> 
> 时间：2012-08-03T00:28:08.440
> 
> 标签：php, str-replace

我有以下字符串由`system("last")`.

```
user1 ftpd11967  89-23-224-162.d Fri Aug  3 01:42   still logged in 
```

怎么用`str_replace`才能代替...

```
still logged in 
```

和...

```
<span style='color:green'>still logged in</span> 
```

试过了

```
system("last", $rawOutput); 
$output = str_replace ( "still logged in" , "<span style='color:green'>still logged in</span>" ,$rawOutput );

echo $output; 
```

除了系统之外，我也尝试过：

```
$rawOutput = shell_exec("last"); 
$output = str_replace( "still logged in" , "<span style='color:green'>still logged in</span>" ,$rawOutput );

echo $output; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:33:43.893

尝试这个

```
// "user1 ftpd11967 89-23-224-162.d Fri Aug 3 01:42 still logged in"

system("last", $rawOutput); 
$output = str_replace ( "still logged in" , "<span style='color:green'>still logged in</span>" ,$rawOutput );

echo $output; 
```

# css - 奇怪的问题/错误，html5 导航元素影响另一个项目的绝对定位

> ID：11787697
> 
> 赞同：1
> 
> 时间：2012-08-03T00:29:08.843
> 
> 标签：css, html, html5boilerplate

好的，遇到了这个奇怪的问题，我在标题内有一个绝对定位的 div。然后是一个带有边距的导航标签，对于某些绝对定位的 div，而不是位于标题的左上角，它位于导航开始的位置。因此，如果导航有 100 像素的上边距，则 div 开始向下 100 像素。

但奇怪的是，如果我对标题应用边框，那么绝对定位的 div 就像我所期望的那样。我正在使用 html5 样板样式，我想这可能是问题所在。

如果您查看示例，则更容易解释。下面的链接是精简版，除了一个标题有边框而另一个没有边框外，它具有相同的标记。

问题示例：http: [//bennyb.co.uk/test/no-border.html](http://bennyb.co.uk/test/no-border.html)

应用边框时解决问题的示例 [http://bennyb.co.uk/test/border.html](http://bennyb.co.uk/test/border.html)

谢谢

乙

编辑：好的，认为这实际上只是与导航有关，但如果 div 似乎是一样的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:53:05.920

申请

```
overflow: hidden; 
```

到标题。

# iphone - 在 2 个不同的视图控制器之间共享数据，将数据发送到第一个调用第二个的视图控制器：S

> ID：11787702
> 
> 赞同：0
> 
> 时间：2012-08-03T00:29:41.003
> 
> 标签：iphone, objective-c, xcode, uiviewcontroller

我有一个调用一个 TableViewController 的 viewController ...用户选择表中的一个元素，我想关闭 tableviewcontroller 并与第一个控制器共享用户选择的内容。

哪种方法最简单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T06:11:03.597

协议和委托仅用于这些目的，即在发生事件时在某个地方做某事.. 休息取决于您和您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:37:48.153

请检查这个答案

[在视图控制器之间进行通信的最佳方式是什么？](https://stackoverflow.com/questions/569940/whats-the-best-way-to-communicate-between-view-controllers)

[如何在 iPhone 上的 UIViewController 之间共享对象？](https://stackoverflow.com/questions/1123920/how-do-i-shared-an-object-between-uiviewcontrollers-on-iphone)

如果您使用情节提要

[iOS故事板传递数据navigationViewController](https://stackoverflow.com/questions/8429088/ios-storyboard-passing-data-navigationviewcontroller)

# ios - UITableViewCell 错误加载 UIWebView

> ID：11787704
> 
> 赞同：0
> 
> 时间：2012-08-03T00:29:49.127
> 
> 标签：ios, xcode, uitableview, uiwebview

![屏幕截图](../Images/a4c8ae85cea519b9b90bf96360f24be7.png)

![屏幕截图](../Images/10c6804a31cb06b5dd2c8ecec5b077be.png)

如您所见，有一个错误。我在每个 UITableViewCell 上加载一个 UIWebView。问题是当它加载大量数据时 UITableViewCell 消失并且当我滚动文本覆盖本身时。

也许 UITableViewCell 有一个最大高度？

这是另一个错误？

我能做些什么？

**编辑：**这是管理 API 响应并将每个“帖子”存储为 UIWebView 的 viewController 代码，它被加载到主视图和 UITableViewCell contentView 中。问题是：大型 webView 的问题在哪里？代码？最大高度？记忆？

```
#import "TopicViewController.h"
#import "HTMLController.h"

NSString *_topicID;

@implementation TopicViewController

@synthesize heightForView = _heightForView;
@synthesize tableView = _tableView;
@synthesize htmlController = _htmlController;
@synthesize pageCounter = _pageCounter;

+ (void)setTopicID:(NSString *)topicID {
    _topicID = topicID;
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {

    }
    return self;
}

- (void)didReceiveMemoryWarning
{    
    [super didReceiveMemoryWarning];
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.heightForView = [[NSMutableDictionary alloc] init];

    self.htmlController = [[HTMLController alloc] init];
    [self.htmlController requestTopicWithID:_topicID];

    NSInteger viewTag = 117;
    for (NSString *html in self.htmlController.postsContent) {
        NSString *formattedHTML = [NSString stringWithFormat:@"<div style='overflow: hidden; max-width: device-width;'>%@</div>", html];
        NSLog(@"%@", formattedHTML);
        UIWebView *content = [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, 300, 1)];
        content.tag = viewTag;
        content.alpha = 0;
        content.opaque = NO;
        content.backgroundColor = [UIColor clearColor];
        content.scrollView.scrollEnabled = NO;
        content.scalesPageToFit = NO;
        content.delegate = self;
        [self.view addSubview:content];
        [content loadHTMLString:formattedHTML baseURL:[NSURL    URLWithString:@"http://www.elotrolado.net"]]; 
        NSLog(@"loading wv %i", viewTag);
        viewTag++;
    }
}

- (void)viewDidUnload
{
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark -  TableViewDelegate & DataSource

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return [self.heightForView count]>0 ? [self.heightForView count] : 0;
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
    return nil;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return 1;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return [self.heightForView count]>0 ? [[self.heightForView objectForKey:[NSString    stringWithFormat:@"%i", indexPath.section+117]] floatValue]+20.0 : 0;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    NSString *cellIdentifier = [NSString stringWithFormat:@"%i", indexPath.section];

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
        UIView *content = [self.view viewWithTag:(indexPath.section+117)];
        content.alpha = 1;
        [cell.contentView addSubview:content];
    }

    return cell;
}

- (void)webViewDidFinishLoad:(UIWebView *)webView {
    CGRect frame = webView.frame;
    frame.size = [webView sizeThatFits:CGSizeZero];
    frame.size.width = 300;
    webView.frame = frame;

    [self.heightForView setObject:[NSString stringWithFormat:@"%f", frame.size.height] forKey:[NSString stringWithFormat:@"%i", webView.tag]];

    if ([self.heightForView count]==[self.htmlController.postsContent count]) {
        NSLog(@"All wv loaded");
        [self.tableView reloadData];
    } else NSLog(@"wv %i loaded", webView.tag);
} 

@end 
```

此代码适用于大多数 webView，但不适用于大型 webView

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T02:22:55.523

我在[这里](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView%3aheightForRowAtIndexPath%3a)找到了答案（tableView：heightForRowAtIndexPaths：文档）

> **重要**由于底层实现细节，您不应返回大于 2009 的值。

所以我的解决方案：

```
CGFloat height = 0;
if ([self.heightForView count]>0) {
    if (([[self.heightForView objectForKey:[NSString stringWithFormat:@"%i", indexPath.section+117]] floatValue]+20.0)>2009) {
        height = 2009;
        UIWebView *content = (UIWebView *)[self.view viewWithTag:(indexPath.section+117)];
        content.scrollView.scrollEnabled = YES;
    } else height = [[self.heightForView objectForKey:[NSString stringWithFormat:@"%i", indexPath.section+117]] floatValue]+20.0;
}
return height; 
```

# objective-c - OpenGL ES - 如何批量渲染 500 多个具有不同 alpha、旋转和缩放的粒子？

> ID：11787709
> 
> 赞同：3
> 
> 时间：2012-08-03T00:30:28.837
> 
> 标签：objective-c, ios, opengl-es, opengl-es-1.1, vertex-array

我正在开发一个需要一次渲染 500-800 个粒子的 iOS 游戏。我了解到，在 OpenGL ES 中批量渲染许多精灵是一个好主意，而不是调用`glDrawArrays(..)`游戏中的每个精灵，以便能够在不大幅降低帧速率的情况下渲染更多精灵。

*我的问题是*：如何**批量**渲染 500 多个具有不同 alpha、旋转和比例但共享相同纹理图集的粒子？这个问题的重点是每个粒子的**不同** *alphas*、*rotations*和*scales*。

我意识到这个问题与[How do I draw 1000+particles (w/unique rotation, scale, and alpha) in iPhone OpenGL ESparticle system without slowing the game非常相似？](https://stackoverflow.com/questions/7435123/how-do-i-draw-1000-particles-w-unique-rotation-scale-and-alpha-in-iphone-o)，但是，该问题并未涉及批量渲染。在我利用顶点缓冲区对象之前，我想了解 OpenGL ES 中的批处理渲染，带有唯一的 alpha、旋转和缩放（但具有相同的纹理）。因此，虽然我最终计划使用 VBO，但我想首先采用这种方法。

代码示例将不胜感激，如果您像某些示例一样使用索引数组，请解释索引数组的结构和用途。

**编辑**我正在使用 OpenGL ES 1.1。

**编辑**下面是我如何渲染场景中每个粒子的代码示例。假设它们共享相同的纹理，并且在此代码执行之前，纹理已经绑定在 OpenGL ES 1.1 中。

```
- (void) render {

    glPushMatrix();

    glTranslatef(translation.x, translation.y, translation.z);

    glRotatef(rotation.x, 1, 0, 0);
    glRotatef(rotation.y, 0, 1, 0);
    glRotatef(rotation.z, 0, 0, 1);

    glScalef(scale.x, scale.y, scale.z);

    // change alpha
    glColor4f(1.0, 1.0, 1.0, alpha);

    // glBindTexture(GL_TEXTURE_2D, texture[0]);

    glVertexPointer(2, GL_FLOAT, 0, texturedQuad.vertices);
    glEnableClientState(GL_VERTEX_ARRAY);

    glTexCoordPointer(2, GL_FLOAT, 0, texturedQuad.textureCoords);
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);

    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

    glDisableClientState(GL_VERTEX_ARRAY);
    glDisableClientState(GL_TEXTURE_COORD_ARRAY);
    glPopMatrix();
} 
```

非常感谢此方法的替代代码！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T00:52:06.810

一种可能性是将这些值包含在顶点属性数组中——我认为这是最好的选择。如果您使用的是 OpenGL ES 1.1 而不是 2.0，那么您将无法使用这种方法。顶点属性数组允许您在每个顶点存储值，在这种情况下，您可以将 alpha 和旋转分别存储在它们自己的属性数组中，并使用`glVertexAttribArray`. 然后着色器将使用 alpha 进行旋转变换和颜色处理。

另一种选择是在 CPU 上进行旋转变换，然后将具有相似 alpha 值的粒子批处理到几个绘制调用中。这个版本需要更多的工作，它不会是一个单一的绘制调用，但如果着色器不是一个选项，它仍然有助于优化。

**注意：您链接到的问题也推荐了阵列解决方案**

**编辑：**鉴于您的代码是 OpenGL ES 1.0，这里是使用的解决方案`glColorPointer`：

```
// allocate buffers to store an array of all particle data
verticesBuffer = ... 
texCoordBuffer = ...
colorBuffer = ...

for (particle in allParticles)
{
  // Create matrix from rotation
  rotMatrix = matrix(particle.rotation.x, particle.rotation.y, particle.rotation.z)
  // Transform particle by matrix
  verticesBuffer[i] = particle.vertices * rotMatrix

  // copy other data
  texCoordBuffer[i] = particle.texCoords;
  colorBuffer[i] = color(1.0, 1.0, 1.0, particle.alpha);
}

glVertexPointer(verticesBuffer, ...)
glTexCoordPointer(texCoodBuffer, ...)
glColorPointer(colorBuffer, ...)

glDrawArrays(particleCount * 4, ...); 
```

此解决方案的一个很好的优化是为每个渲染共享缓冲区，这样您就不必在每一帧都重新分配它们。

# c# - 从 aspx 页面解析到文本文档

> ID：11787710
> 
> 赞同：0
> 
> 时间：2012-08-03T00:30:30.610
> 
> 标签：c#, vb.net

使用 C# 或 VB.Net 代码从链接 (http://24.173.220.131/carter/currentinmates.aspx) 下载。然后将页面中的属性解析为文本文档。

输出 ：

姓名|出书日期|收费|保释|发行|机构 ANDERSON, JAYME RAMONE|05/04/2012|判刑|$0.00|5/2/2022|在 ANDERSON, JEFFERY CONARD 转身|02/06/2012|判刑|$0.00| 2/5/2022|卡特县治安官部门

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T04:11:20.610

添加对 的引用`CsQuery`，将其安装在 NuGet 中或在此处找到它[https://github.com/jamietre/CsQuery](https://github.com/jamietre/CsQuery)

```
using System;
using System.Collections.Generic;
using System.Collections.Concurrent;
using System.Diagnostics;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;
using System.Text;
using CsQuery;

class Program
{
    static void Main(string[] args)
    {

        var stringBuilder = new StringBuilder();
        var url = "http://24.173.220.131/carter/currentinmates.aspx";
        CQ.CreateFromUrlAsync(url)
           .Then(response =>
           {
               var dom = response.Dom;
               var trs = dom.Select("#dgrdLandRecords tr").Elements;
               foreach (var row in trs)
               {
                   stringBuilder.AppendLine();
                   var tds = row.ChildElements.ToList();

                   for (int i = 1; i < tds.Count; i++)
                   {
                       stringBuilder.Append(tds[i].Cq().Text());
                       stringBuilder.Append("|");
                   }
               }
               var result = stringBuilder.ToString();
               Console.Write(result);
           });

        Console.WriteLine("Press any key to exit.");
        Console.ReadKey();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:34:19.430

使用[WebClient 类](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)正是您正在寻找的。

```
Public Class Test

Public Shared Sub Main(args() As String)
    Dim sURL as String
    If args Is Nothing OrElse args.Length = 0 Then
        'Throw New ApplicationException("Specify the URI of the resource to retrieve.")
         sURL = http://24.173.220.131/carter/currentinmates.aspx"
    Else
        sURL = args(0)
    End If
    Dim client As New WebClient()

    ' Add a user agent header in case the 
    ' requested URI contains a query.
    client.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)")

    Dim data As Stream = client.OpenRead(sURL)
    Dim reader As New StreamReader(data)
    Dim s As String = reader.ReadToEnd()
    Console.WriteLine(s)

    'Here write the variable `s` to a Text file, eg My.File.Create(s)

    data.Close()
    reader.Close()
End Sub 'Main
End Class 'Test 
```

# jquery - 在链接触发之前单击更改按钮属性

> ID：11787711
> 
> 赞同：3
> 
> 时间：2012-08-03T00:30:53.360
> 
> 标签：jquery, html, dwolla

我在我的网站上使用 Dwolla 平台。我想在单击时将按钮的数据量属性更改为另一个文本字段中的值。但是，当 Dwolla 网站加载时，它提示我支付原始的默认金额，所以我认为我的属性修改没有发生。

```
<script type='text/javascript'>
$('.dwolla_button').click(function(){
alert($('#id_support_amount').val());
$('.dwolla_button').attr('data-amount', $('#id_support_amount').val());
});
</script> 
```

我正在使用来自 Dwolla 的压缩 javascript，它会在单击按钮时触发请求，所以我最终可能不得不问他们/在其中挖掘。

在链接触发之前，我通常如何更改属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:35:00.650

要在实际点击之前做一些事情，你应该使用`mousedown`处理程序。

尝试这样的事情：

`$(document).on("mousedown",".dwolla_button", function(){ $(this).attr('data-amount', $('#id_support_amount').val());
});`

或查看我的工作示例[http://jsfiddle.net/ZMb3E/1/](http://jsfiddle.net/ZMb3E/1/)

# ruby-on-rails-3 - 如何解决损坏的 Rails 记录器（不接受 log_tags）？

> ID：11787716
> 
> 赞同：5
> 
> 时间：2012-08-03T00:31:44.267
> 
> 标签：ruby-on-rails-3

我已将 Rails 3.2.5 应用程序从 Heroku 移至 VPS，虽然该应用程序在 Heroku 上的日志输出输出方面运行良好，但不幸的是，VPS 上的所有日志输出甚至在本地运行都缺少时间戳或任何其他标签我'想预先。

在尝试创建一个新的测试应用程序并包含以下其中一个之后，`config/envrionments`我`config/application.rb`发现它预先添加了指示的标签：

```
config.log_tags = [:uuid, :remote_ip, lambda { |req| Time.now }] 
```

尽管如此，到目前为止，我已经尝试了所有我能想到的一切，从梳理应用程序 gem 到在 config 和 lib 文件夹和子文件夹（例如初始化程序）中查找任何“日志”出现的所有内容。

我不知道，如果 Rails 记录器可能以某种方式被禁用，我怎样才能找到它？或者这里还会发生什么？或者我应该精确寻找什么？...或者我应该尝试强制 Rails 记录器，如果是这样，我应该在哪里和什么插入 Rails 记录器重置代码以找出在系统初始化期间问题发生的位置?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-28T16:07:01.603

我有同样的问题，你可能需要使用`ActiveSupport::TaggedLogging`.

```
 config.logger = ActiveSupport::TaggedLogging.new(Logger.new($stdout)) 
```

# node.js - 我如何制作“节点”。工作？

> ID：11787717
> 
> 赞同：0
> 
> 时间：2012-08-03T00:31:54.130
> 
> 标签：node.js, default

我过去`node .`在各种 NodeJS 应用程序中运行过，它似乎知道运行`index.js`,`server.js`等。是否有`package.json`我可以配置的设置（或类似的东西）以便 NodeJS 知道应该运行哪个文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T00:34:30.623

npm 确实有一个配置：

```
"main": "app.js" 
```

# prolog - 在 prolog 中实现 Dijkstra 的最佳结构图

> ID：11787719
> 
> 赞同：5
> 
> 时间：2012-08-03T00:32:17.873
> 
> 标签：prolog, dijkstra

问题很简单。如何在 SWI prolog 中构造我的 Graph 以实现 Dijkstra 算法？

我找到[了这个](http://colin.barker.pagesperso-orange.fr/lpa/dijkstra.htm)，但它对我的工作来说太慢了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T08:13:24.223

这个实现还不错：

```
?- time(dijkstra(penzance, Ss)).
% 3,778 inferences, 0,003 CPU in 0,003 seconds (99% CPU, 1102647 Lips)
Ss = [s(aberdeen, 682, [penzance, exeter, bristol, birmingham, manchester, carlisle, edinburgh|...]), s(aberystwyth, 352, [penzance, exeter, bristol, swansea, aberystwyth]), s(birmingham, 274, [penzance, exeter, bristol, birmingham]), s(brighton, 287, [penzance, exeter, portsmouth, brighton]), s(bristol, 188, [penzance, exeter, bristol]), s(cambridge, 339, [penzance, exeter|...]), s(cardiff, 322, [penzance|...]), s(carlisle, 474, [...|...]), s(..., ..., ...)|...]. 
```

SWI-Prolog 提供属性变量，那么[这个答案](https://stackoverflow.com/a/10101483/874024)可能与您相关。我希望我今天晚些时候会发布一个使用属性变量的 dijkstra/2 实现。

**编辑**得好，我必须说第一次用属性变量编程并不容易。

我正在使用上面链接的@Mat 的答案中的建议，滥用属性变量以根据算法的要求获得对附加到数据的属性的*持续时间访问。*我（盲目地）实现了[维基百科算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)，这是我的努力：

```
/*  File:    dijkstra_av.pl
    Author:  Carlo,,,
    Created: Aug  3 2012
    Purpose: learn graph programming with attribute variables
*/

:- module(dijkstra_av, [dijkstra_av/3]).

dijkstra_av(Graph, Start, Solution) :-
    setof(X, Y^D^(member(d(X,Y,D), Graph)
             ;member(d(Y,X,D), Graph)), Xs),
    length(Xs, L),
    length(Vs, L),
    aggregate_all(sum(D), member(d(_, _, D), Graph), Infinity),
    catch((algo(Graph, Infinity, Xs, Vs, Start, Solution),
           throw(sol(Solution))
          ), sol(Solution), true).

algo(Graph, Infinity, Xs, Vs, Start, Solution) :-
    pairs_keys_values(Ps, Xs, Vs),
    maplist(init_adjs(Ps), Graph),
    maplist(init_dist(Infinity), Ps),
    ord_memberchk(Start-Sv, Ps),
    put_attr(Sv, dist, 0),
    time(main_loop(Vs)),
    maplist(solution(Start), Vs, Solution).

solution(Start, V, s(N, D, [Start|P])) :-
    get_attr(V, name, N),
    get_attr(V, dist, D),
    rpath(V, [], P).

rpath(V, X, P) :-
    get_attr(V, name, N),
    (   get_attr(V, previous, Q)
    ->  rpath(Q, [N|X], P)
    ;   P = X
    ).

init_dist(Infinity, N-V) :-
    put_attr(V, name, N),
    put_attr(V, dist, Infinity).

init_adjs(Ps, d(X, Y, D)) :-
    ord_memberchk(X-Xv, Ps),
    ord_memberchk(Y-Yv, Ps),
    adj_add(Xv, Yv, D),
    adj_add(Yv, Xv, D).

adj_add(X, Y, D) :-
    (   get_attr(X, adjs, L)
    ->  put_attr(X, adjs, [Y-D|L])
    ;   put_attr(X, adjs, [Y-D])
    ).

main_loop([]).
main_loop([Q|Qs]) :-
    smallest_distance(Qs, Q, U, Qn),
    put_attr(U, assigned, true),
    get_attr(U, adjs, As),
    update_neighbours(As, U),
    main_loop(Qn).

smallest_distance([A|Qs], C, M, [T|Qn]) :-
    get_attr(A, dist, Av),
    get_attr(C, dist, Cv),
    (   Av < Cv
    ->  (N,T) = (A,C)
    ;   (N,T) = (C,A)
    ),
    !, smallest_distance(Qs, N, M, Qn).
smallest_distance([], U, U, []).

update_neighbours([V-Duv|Vs], U) :-
    (   get_attr(V, assigned, true)
    ->  true
    ;   get_attr(U, dist, Du),
        get_attr(V, dist, Dv),
        Alt is Du + Duv,
        (   Alt < Dv
        ->  put_attr(V, dist, Alt),
        put_attr(V, previous, U)
        ;   true
        )
    ),
    update_neighbours(Vs, U).
update_neighbours([], _).

:- begin_tests(dijkstra_av).

test(1) :-
    nl,
    time(dijkstra_av([d(a,b,1),d(b,c,1),d(c,d,1),d(a,d,2)], a, L)),
    maplist(writeln, L).

test(2) :-
    open('salesman.pl', read, F),
    readf(F, L),
    close(F),
    nl,
    dijkstra_av(L, penzance, R),
    maplist(writeln, R).

readf(F, [d(X,Y,D)|R]) :-
    read(F, dist(X,Y,D)), !, readf(F, R).
readf(_, []).

:- end_tests(dijkstra_av). 
```

说实话，我更喜欢您在问题中链接的代码。有一个明显的优化点，smallest_distance/4 现在使用哑线性扫描，使用 rbtree 运行时应该更好。但是必须小心处理属性变量。

time/1 显然显示出改进

```
% 2,278 inferences, 0,003 CPU in 0,003 seconds (97% CPU, 747050 Lips)
s(aberdeen,682,[penzance,exeter,bristol,birmingham,manchester,carlisle,edinburgh,aberdeen])
.... 
```

但该图太小，无法做出任何明确的断言。让我们知道此代码段是否会减少您的程序所需的时间。

文件*salesman.pl*包含 dist/3 事实，它是从问题中的链接中逐字提取的。

# node.js - 你能从 Stud > HAProxy > nginx 获得 X-forwarded-for 吗？

> ID：11787722
> 
> 赞同：2
> 
> 时间：2012-08-03T00:32:32.963
> 
> 标签：node.js, nginx, websocket, haproxy, stunnel

我正在使用 Stud 终止 SSL 并将请求转发到 HAProxy，HAProxy 确定它是否是 WebSocket 连接并将请求转发到 Node.js 或 nginx。我遇到的问题是我似乎无法从 Stud 获得 X-forwarded-for。当我在 stud conf 中设置 write-ip 时，我的请求失败。

这样的堆栈可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T10:23:10.460

Stud 是一个“哑”代理，因此它不能以任何方式更改标题。HAProxy -> Nginx 当然可以做你想做的事。

一个选项是磅而不是螺柱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-04T20:45:39.997

另一种选择是搭便车：[https ://github.com/varnish/hitch](https://github.com/varnish/hitch)

具有 PROXY 支持，可与 Varnish 和 haproxy 一起使用。

# sql - 我可以将这两个几乎相同的 MERGE 语句合并为一个吗？

> ID：11787726
> 
> 赞同：0
> 
> 时间：2012-08-03T00:33:23.940
> 
> 标签：sql, sql-server, sql-server-2008

我有一种感觉，我在这个问题上花了太多时间并且被蒙蔽了......希望一双新鲜的眼睛可以帮助指出一个简单的错误！

这是我*认为*应该起作用的`MERGE`陈述：

 ***不工作：**

```
MERGE assignment_tbl AS target
USING (SELECT 1 s) AS source
ON target.id = @id
   AND target.id1 = @id1
   AND target.id2 = @id2
WHEN matched AND NOT (target.iFeeScope = @iFeeScope OR target.nFeeAmount = @nFeeAmount) AND (target.bActive = 1) THEN
  UPDATE SET target.dLastUpdated = @dNow,
             target.dDisabled = @dNow,
             target.bActive = 0; 
```

问题出在我的`WHEN matched AND NOT`声明中：`(target.iFeeScope = @iFeeScope OR target.nFeeAmount = @nFeeAmount)`，我发现解决这个问题的唯一方法是将声明分成两个单独的（并且几乎相同的）块：

**工作（但效率低下）：**

```
MERGE assignment_tbl AS target
USING (SELECT 1 s) AS source
ON target.id = @id
   AND target.id1 = @id1
   AND target.id2 = @id2
WHEN matched AND NOT (target.iFeeScope = @iFeeScope) AND (target.bActive = 1) THEN
  UPDATE SET target.dLastUpdated = @dNow,
             target.dDisabled = @dNow,
             target.bActive = 0;

MERGE assignment_tbl AS target
USING (SELECT 1 s) AS source
ON target.id = @id
   AND target.id1 = @id1
   AND target.id2 = @id2
WHEN matched AND NOT (target.nFeeAmount = @nFeeAmount) AND (target.bActive = 1) THEN
  UPDATE SET target.dLastUpdated = @dNow,
             target.dDisabled = @dNow,
             target.bActive = 0; 
```

我需要在我的原始语句中进行哪些更改才能达到以下两个语句的结果？

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:29:13.057

关于什么：

```
WHEN matched AND target.iFeeScope != @iFeeScope AND target.nFeeAmount != @nFeeAmount AND (target.bActive = 1) THEN 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T01:56:08.300

我自己解决了...认为这是 AND/NOT 逻辑的问题！

```
MERGE assignment_tbl AS target
USING (SELECT 1 s) AS source
ON target.id = @id
   AND target.id1 = @id1
   AND target.id2 = @id2
   AND target.bActive = 1
WHEN matched AND (NOT (target.iFeeScope = @iFeeScope)) 
             OR (NOT (target.nFeeAmount = @nFeeAmount)) THEN
  UPDATE SET target.dLastUpdated = @dNow,
             target.dDisabled = @dNow,
             target.bActive = 0; 
```*

# ruby - 调用 Enumerable#reduce 时我实际上在做什么？

> ID：11787729
> 
> 赞同：4
> 
> 时间：2012-08-03T00:33:45.070
> 
> 标签：ruby, coding-style, whitespace, irb

为什么我不能[`Enumerable#reduce(sym)`](http://www.ruby-doc.org/core-1.9.3/Enumerable.html#method-i-reduce)在没有括号的情况下调用，如下所示？

```
>> [1, 2, 3].reduce :+
?> 
```

使用括号会导致：

```
>> [1, 2, 3].reduce(:+)
=> 6 
```

我是`Enumerable#reduce {| memo, obj | block }`不是不小心打电话了？

此外，为什么会发生这种情况？

```
>> [1, 2, 3].reduce &:+
?> ^C
>> [1, 2, 3].reduce(&:+)
=> 6 
```

非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T00:38:32.053

这似乎是 IRb 解析器中的错误。如果您在 Pry、命令行或文件中尝试它，它工作得很好：

```
ruby -e"res = [1, 2, 3].reduce :+
p res"
# 6 
```

基本上， IRb 会感到困惑，认为`+`是二元运算符并正在等待第二个操作数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:37:27.883

Ruby 解析器似乎无法处理该特定组合。符号有限制，但`:+`等是某种特殊情况，显然需要正确解释括号。

请注意，如果您尝试自行评估`:+`，它不会解析。其他运营商`:*`也是`:/`如此，所以这里发生了一些“神奇”的事情。

# android - android ontouchevent opengl

> ID：11787730
> 
> 赞同：0
> 
> 时间：2012-08-03T00:34:01.630
> 
> 标签：android, opengl-es, touch-event

我正在为我的 android 游戏使用 opengl es。我想抓住 x 和 y 的位置。我遵循了一堆不同的教程，一切都导致了相同的结果：我无法从中得到任何东西。该方法甚至没有被调用，我觉得很奇怪。所以，这是我的 GLSurfaceView 类

```
class OpenGLES10SurfaceView extends GLSurfaceView {

    //private final float TOUCH_SCALE_FACTOR = 180.0f / 320;
    public OpenGLES10Renderer mRenderer;
    //static private float mPreviousX;
    //static private float mPreviousY;
    private static float _x;
    private static float _y;

    public OpenGLES10SurfaceView(Context context){
        super(context);

        // set the mRenderer member
        mRenderer = new OpenGLES10Renderer(context);
        setRenderer(mRenderer);

        // Render the view only when there is a change
        setRenderMode(GLSurfaceView.RENDERMODE_WHEN_DIRTY);
    }
    @Override
        public boolean onTouchEvent(MotionEvent e) {
            // MotionEvent reports input details from the touch screen
            // and other input controls. In this case, you are only
            // interested in events where the touch position changed.

            float x = e.getX();
            float y = e.getY();

            switch (e.getAction()) {
            case MotionEvent.ACTION_DOWN:
                                         mRenderer.setX(x);
                                         return true;

            }

    }
    } 
```

我找不到这到底有什么问题，所以如果你能提供帮助，那将是非常感激的。如果您需要她的部分代码，请说出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:37:51.040

尝试这个：

```
@Override
public boolean onTouchEvent(MotionEvent event) {

        float x = e.getX();
        float y = e.getY();

    switch (event.getAction() & MotionEvent.ACTION_MASK) {
        case MotionEvent.ACTION_DOWN:
            mRenderer.setX(x);
            requestRender();
            break;
        case MotionEvent.ACTION_UP:         
            break;
        case MotionEvent.ACTION_POINTER_DOWN:               
            break;
        case MotionEvent.ACTION_POINTER_UP:
            break;
        case MotionEvent.ACTION_MOVE:       
            break;
    }   

    return true;
  } 
```

如果您需要，我添加了其他操作。希望有帮助。

# cloud-foundry - Cloudfoundry - 使用 vmc rails-console 时无法访问数据库

> ID：11787735
> 
> 赞同：0
> 
> 时间：2012-08-03T00:34:31.427
> 
> 标签：cloud-foundry, rails-console

我已经部署了一个 rails 应用程序（使用 rails 3.2.3\. ruby​​ 1.9.2），它已启动并运行，一切正常。然后我尝试使用 rails 控制台管理它，如`vmc rails-console myapp`. 可以连接控制台，但是当我发出类似的命令时`User.count`，出现以下错误：

```
User.count(0.3ms)  SELECT COUNT(*) FROM `users` 
ActiveRecord::StatementInvalid: Mysql2::Error:
 MySQL server has gone away: SELECT COUNT(*) FROM `users` 
```

控制台似乎无法访问数据库，但 caldecott 已启动并正在运行，并根据 绑定到 mysql 服务`vmc apps`。

有人对此有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T07:31:46.147

这是我们目前正在寻求解决的问题。在此期间，您可以通过调用 Base 类的建立连接让 ActiveRecord 重新建立连接；

```
ActiveRecord::Base.establish_connection 
```

担

# sql - SQL Server 在更新的字段上触发

> ID：11787742
> 
> 赞同：0
> 
> 时间：2012-08-03T00:35:32.833
> 
> 标签：sql, sql-server, sql-server-2005, triggers

我有以下触发器：

```
BEGIN
DECLARE @email varchar(200)
DECLARE @jobcode int
DECLARE @status char(1)

DECLARE @emaild varchar(200)
DECLARE @jobcoded int
DECLARE @statusd char(1)

SET @statusd = NULL

SELECT @status = z.status, @email = p.EMail, @jobcode = z.jobID
    FROM zipoutfiles z
    INNER JOIN inserted AS i ON z.jobID = i.jobID
    INNER JOIN PS_LoginUser AS p ON z.UserID = p.UserID

SELECT @statusd = z.status, @emaild = p.EMail, @jobcoded = z.jobID
    FROM zipoutfiles z
    INNER JOIN deleted AS d ON z.jobID = d.jobID
    INNER JOIN PS_LoginUser AS p ON z.UserID = p.UserID
    WHERE d.jobID = @jobcode

IF ((@status = 'D' AND @statusd = 'R') OR (@status = 'D' AND @statusd = 'E'))
BEGIN
    EXEC SendMail @email, @jobcode
END
END 
```

我希望能够在状态从 E 到 D 或 R 到 D 时运行 SendMail，但不是从 D 到 D（如果它再次更新）以及当它作为 D 插入时。我在这里做错了什么：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:27:17.660

不确定您的表架构是什么，但这可能会为您提供所有适当的电子邮件：

```
select p.EMail as Email, z.JobId as JobCode
  from ZipOutFiles as ZOF inner join
    inserted as i on i.JobId = ZOF.JobId inner join
    PS_LoginUser as PLU on PLU.UserId = ZOF.UserId left outer join
    deleted as d on d.JobId = ZOF.JobId
    where
      ( d.Status = 'E' and i.Status = 'D' ) or -- E -> D.
      ( d.Status = 'R' and i.Status = 'D' ) or -- R -> D.
      ( d.Status is NULL and i.Status = 'D' ) -- Inserted D. 
```

我假设您并没有真正更新`JobId`. 如果是这样，你如何匹配前后行？

还假设`Status`不能`NULL`。如果是这样，则需要修改最后一个条件以正确检测在`deleted`表中没有找到相应的行。

# jquery - 替换/附加第一个内容 使用jquery在字符串中标记

> ID：11787746
> 
> 赞同：0
> 
> 时间：2012-08-03T00:36:50.993
> 
> 标签：jquery, html

我需要使用 Jquery 将一些字符串附加到“初始消息”。我试着找到

标记并附加到内容，但它不起作用。我怎样才能使用 Jquery 做到这一点？

```
var stringHtml = '<p>Initial Message</p>'+'<p align="center" style="margin-top: 30px;">'+'<input type="button" id="okPopupButton" name="ok" value="ok"/>';

    I am trying this

    var con = $(stringHtml);
    con.find('<p>').append('<p>Test</p>'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:06:36.127

不确定我是否理解正确，但我相信你想要的是 :first 选择器。像这样的东西：

```
var stringHtml = '<p>Initial Message</p>'+'<p  align="center" style="margin-top:30px;">'+'<input type="button" id="okPopupButton" name="ok" value="ok"></p>';
var con = $('<div/>').html(stringHtml);

con.find('p:first').append('Test'); 
```

# javascript - 为什么要将函数分配给变量而不是声明命名函数？

> ID：11787747
> 
> 赞同：4
> 
> 时间：2012-08-03T00:36:52.803
> 
> 标签：javascript, function, variables

我为什么要这样做：

```
var myfunc = function() { /* code */ };

...

myfunc(); 
```

而不是这个：

```
function myfunc() { /* code */ }

...

myfunc(); 
```

使用其中一个有什么好处吗？我在不同的地方看到了这两个例子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T00:46:27.307

据我所知，唯一的区别是匿名函数不能递归调用自己，而命名函数可以。第三种结构结合了这两种结构，即你可以有一个命名函数表达式：

```
var myfunc = function myfunc() { /* code */ }; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-03T01:33:00.873

如果函数被正常声明，即使重新声明了标识符，函数名（它的标识符）也不会被删除。标识符仅在其范围结束时才会被删除。

```
function myfunc() { /* code */ };

if (delete myfunc) { //will fail
  alert('myfunc deleted');
} else {
  alert('can not delete myfunc');
}

myfunc = null;

if (delete myfunc) { //will still fail
  alert('myfunc deleted');
} else {
  alert('can not delete myfunc');
}

var myfunc = null;

if (delete myfunc) { //will still fail
  alert('myfunc deleted');
} else {
  alert('can not delete myfunc');
} 
```

但是如果将函数声明分配给变量，则可以删除其标识符。当您需要创建一个全局函数但只是临时使用它时，这尤其有用，以便在不再需要它时可以将其删除，或者避免标识符与第三方脚本的可能冲突。

```
var myfunc = function() { /* code */ };

if (delete myfunc) { //will succeed
  alert('myfunc deleted');
} else {
  alert('can not delete myfunc');
}

//or...
var myfunc = function myrealfunc() { /* code */ };

if (delete myfunc) { //will succeed
  alert('myfunc deleted');
} else {
  alert('can not delete myfunc');
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-03T00:43:21.267

有一些差异，主要是务实的。当你“var”一个函数时，通常的假设是某种“本地”范围的函数（想想嵌套函数）。当您这样做时 `function myFunction() {}`，该函数通常被假定为全局范围的（尽管您也可以将其包装在匿名函数中）。

在 javascript 'class' 的情况下，如果你想创建一个本地范围的函数，你必须使用 'var' 来声明它。

```
var myClass = function() {
 var test = function() {
  //This function has local scope
  }
}; 
```

除了上面的注释，这是一个简单的例子。

```
 var myVariable = resultFunction();

  function resultFunction() {
  return 1;
  } 
```

上面的代码将起作用。但是您不能执行以下操作

```
 var myVariable = resultFunction();

 var resultFunction = function() {
    return 1;
 }; 
```

但你可以做

```
 var resultFunction = function() {
    return 1;
 };

 var myVariable = resultFunction(); 
```

# java - 弹簧 - @Autowired 和 @Service 不起作用

> ID：11787749
> 
> 赞同：1
> 
> 时间：2012-08-03T00:37:15.423
> 
> 标签：java, spring, spring-mvc, annotations

我知道存在很多这样的问题，我读了很多，没有人能帮助我。谢谢你帮助我。

我不喜欢在 xml 中定义每个 bean 的 spring 方式，所以我在我的应用程序上下文中使用了一个扫描仪，但我认为只有 @Component（我的托管 bean），但它不想捕获 @Service 和 @Repository，我说过因为我的服务为空。

那是 web.xml 中的春天的东西

```
<!-- Archivo de configuraciones de Spring y JSF -->
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath*:WEB-INF/context/applicationContext*.xml</param-value>
    </context-param>

    <!-- Línea especial para la integración con un Java-based web framework (JSF) -->    
    <listener>
        <listener-lass>org.springframework.web.context.ContextLoaderListener 
```

那是我的 application-context.xml

```
 <context:spring-configured/>     

    <!-- Escanear todos los componentes y beans en vez de instanciar 1 por 1 -->
    <context:component-scan base-package="paquete" />

    <mvc:annotation-driven />

     <!-- Identificar todos los beans por las anotaciones -->
    <tx:annotation-driven transaction-manager="transactionManager"/>

    <!-- Archivo de propiedades configurables (database, messages, etc) -->
    <context:property-placeholder  location="classpath*:META-INF/*.properties"/>

    <!-- Gestor de transacciones de SPRING -->
    <tx:annotation-driven transaction-manager="transactionManager"/>

    <bean class="org.springframework.orm.jpa.JpaTransactionManager"     id="transactionManager">
        <property name="entityManagerFactory" ref="entityManagerFactory"/>
    </bean>

    <!-- El conversador entre nuestras entidades y las tablas de BD -->
    <bean id="entityManagerFactory"
          class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="persistenceUnitName" value="persistenceUnit" />
        <property name="persistenceXmlLocation" value="classpath:/WEB-INF/persistence.xml" />
        <property name="dataSource" ref="dataSource" />
        <property name="loadTimeWeaver">
            <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver" />
        </property>
        <property name="jpaVendorAdapter" ref="vendorAdapter" />
    </bean>

    <!-- Integración de Spring e Hibernate, no es obligatorio -->
    <bean id="vendorAdapter"
          class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
        <property name="databasePlatform" value="${hibernate.dialect}" />
        <property name="showSql" value="${hibernate.show_sql}" />
        <property name="generateDdl" value="true" />
    </bean>

    <!-- Formalidad de dataSource de SPRING -->
    <bean class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" id="dataSource">
        <property name="driverClassName" value="${database.driverClassName}"/>
        <property name="url" value="${database.url}"/>
        <property name="username" value="${database.username}"/>
        <property name="password" value="${database.password}"/>
        <property name="testOnBorrow" value="true"/>
        <property name="testOnReturn" value="true"/>
        <property name="testWhileIdle" value="true"/>
        <property name="timeBetweenEvictionRunsMillis" value="1800000"/>
        <property name="numTestsPerEvictionRun" value="3"/>
        <property name="minEvictableIdleTimeMillis" value="1800000"/>
    </bean> 
```

在我的包“paquete”（西班牙语包，我来自秘鲁，对不起我的英语不好）我有 3 个子包，所以在 netbeans 中我看到 3 个包，如“paquete.beans”、“paquete.service”和“paquete.repositorios” . 我用“paquete”包中的组件扫描器调用

我使用 primefaces 所以你有一个 helloJSFBean 是..

```
 @ManagedBean
    @Scope("session")
    @Component
    public class helloPageJSFBean {

        private String nombre;
        private String nombre2;

        public String getNombre2() {
            return nombre2;
        }

        public void setNombre2(String nombre2) {
            this.nombre2 = nombre2;
        }

        @Autowired
        HelloService helloService;

        @PostConstruct
        public void init(){
            nombre="hi";
        }

        public void saludar(ActionEvent actionEvent){
            nombre2=helloService.saludar(nombre);
        }

        /* 
         *Getters and Setters
         */
        public String getNombre() {
            return nombre;
        }

        public void setNombre(String nombre) {
            this.nombre = nombre;
        }

    } 
```

所以我打电话给我的 helloService 并且是......

```
 @Service
public class HelloServiceImpl implements HelloService{

    @Autowired
    protected HelloRepository helloRepository;

    @Override
    public String saludar(String nombre) {
        return helloRepository.saludar(nombre);
    }

} 
```

我的存储库是

```
 @Repository
    public class HelloRepositoryImpl implements HelloRepository {

        @Override
        public String saludar(String nombre) {
            return "Hola "+nombre+", estás haciendo un excelente trabajo";
        }

    } 
```

* * *

问题是我`NullPointerException`在我的“saludar”方法中得到了，在调试中我的服务是空的并且不是helloServiceImpl的实例，所以我猜@Autowired它不起作用。

我收到的所有帮助都会很棒，我已经失去了 2 周的时间，什么也没有。谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T22:35:28.513

好吧，我不知道为什么在文件位置的定义中使用类路径，所以，我想到了类路径，当有人把“classpath *：directory/file.ext”强制IDE在SRC路径中搜索该文件时java类放在上面。并且显然那里没有文件夹（在我的配置项目中），因此您删除定义中的类路径并且它可以工作。

因此，如果这对任何我感到高兴的人有用。我要感谢你们所有人的时间和考虑回答。谢谢 ！！

那是我的项目结构，。我正在使用netbeans，这个页面说我不能发布图片，让你链接

[http://img17.imageshack.us/img17/6338/sinttulofwk.png](http://img17.imageshack.us/img17/6338/sinttulofwk.png)

还有我的配置文件...

Web.xml

```
 <!-- Archivo de configuraciones de Spring y JSF -->
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>WEB-INF/context/applicationContext*.xml</param-value>
</context-param> 
```

应用程序上下文.xml

```
...
...  
<!-- Archivo de propiedades configurables (database, messages, etc) -->
<context:property-placeholder  location="META-INF/database.properties"/>
...
...
 <!-- El conversador entre nuestras entidades y las tablas de BD -->
<bean id="entityManagerFactory"
      class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceUnitName" value="persistenceUnit" />
    <property name="persistenceXmlLocation" value="WEB-INF/persistence.xml" />
    <property name="dataSource" ref="dataSource" />
    <property name="loadTimeWeaver">
        <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver" />
    </property>
    <property name="jpaVendorAdapter" ref="vendorAdapter" />
</bean> 
```

如果有人能告诉我类路径的想法是对还是错，我会感激不尽。问候

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T13:17:33.337

阅读[此](http://www.javacodegeeks.com/2012/04/jsf-2-primefaces-3-spring-3-hibernate-4.html)页面，您需要设置：

```
 <!-- JSF and Spring are integrated -->
   <application>
     <el-resolver>
      org.springframework.web.jsf.el.SpringBeanFacesELResolver
     </el-resolver>
   </application> 
```

在您的**faces-config.xml**`@ManagedProperty(value="#{name of your service}")`中，并使用而不是引用 Spring bean `@Autowired`。

# xcode - 向 IKImageBrowserView 添加背景图像

> ID：11787752
> 
> 赞同：0
> 
> 时间：2012-08-03T00:37:32.720
> 
> 标签：xcode, cocoa, ikimagebrowserview

我在 NSScrollView 中有一个 IKImageBrowserView ，其中填充了一堆图像。如何添加将与 IKImageBrowserView 中的图像一起滚动的背景图像？

基本上我想要做的是创建一个类似于 iPhone 上的 iBooks 应用程序的视图，其中的项目位于书架上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T05:50:56.433

`IKImageBrowserView`有一个背景层，可以用`- (void) setBackgroundLayer:(CALayer*)aLayer`. 您可以在此图层中执行任何您想要的绘图。

请参阅[https://developer.apple.com/library/mac/#documentation/graphicsimaging/Reference/IKImageBrowserView/IKImageBrowserView_Reference.html中的](https://developer.apple.com/library/mac/#documentation/graphicsimaging/Reference/IKImageBrowserView/IKImageBrowserView_Reference.html)**核心动画层集成**部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T21:06:35.107

通过在此处的示例项目中实现自定义 ImageBrowserView 和 ImageBrowserBackgroundLayer 类，我能够实现我想要的效果：http: [//developer.apple.com/library/mac/#/legacy/mac/library/samplecode/ImageKitDemo /Introduction/Intro.html](http://developer.apple.com/library/mac/#/legacy/mac/library/samplecode/ImageKitDemo/Introduction/Intro.html)

我所做的是将自定义 ImageBrowserView 和 ImageBrowserBackgroundLayer 类移动到我的项目中，然后将 browserView 的背景层设置为自定义类，如下所示：

```
ImageBrowserBackgroundLayer *backgroundLayer = [[ImageBrowserBackgroundLayer alloc] init];
[browserView setBackgroundLayer:backgroundLayer];
backgroundLayer.owner = browserView; 
```

然后在界面生成器中，我必须将滚动视图的 View 类更改为自定义 ImageBrowserView 类。

# php - PDO 有问题，但没有错误

> ID：11787753
> 
> 赞同：1
> 
> 时间：2012-08-03T00:37:45.343
> 
> 标签：php, mysql, pdo, php-5.3

我正在玩 PDO，但发生了一些我似乎无法弄清楚的奇怪事情。没有产生错误。只是没有任何东西被插入到数据库中。

**索引.php**

```
<?php
error_reporting(E_ALL); 
require('includes/classes.php');
require_once('includes/config.php');

$db = new DatabaseCon();
$db->dbConnect($config);

$stmt = $db->prepare("INSERT INTO images (filename) VALUES (?)");
$stmt->bindParam(1, "hello world!");
$stmt->execute();
?> 
```

**类.php**

```
<?php
error_reporting(E_ALL);
require('config.php');

// Connect to database
// Does not handle anything else
class DatabaseCon {
    public $dbh;

    // Method to connect to database
    function dbConnect($config) {
        try {
            $dbh = new PDO("mysql:host=" . $config['host'] . ";dbname=" . $config['dbname'], $config['dbuser'], $config['dbpass']);
            //$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_SILENT);
        } catch (PDOException $e) {
            echo $e->getMessage();
        }
    }
} 
```

**配置文件**

```
<?php
error_reporting(E_ALL);

$config = array(
    'host' => 'localhost',  // Database hostname (usually localhost)
    'dbuser' => 'admin_mp', // Database username
    'dbpass' => 'mypassword here', // Database password
    'dbname' => 'mpdb' // Database name
); 
```

当我导航到 index.php 时，应该将“hello world”插入到数据库中，但事实并非如此。谁能在这里找到我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:43:12.960

改变

```
$dbh = new PDO("mysql:host=" . $config['host'] . ";dbname=" . $config['dbname'], $config['dbuser'], $config['dbpass']); 
```

到

```
$this->dbh = new PDO("mysql:host=" . $config['host'] . ";dbname=" . $config['dbname'], $config['dbuser'], $config['dbpass']); 
```

改变

```
$stmt = $db->execute("INSERT INTO images (filename) VALUES (?)");
$stmt->bindParam(1, "hello world!");
$stmt->execute(); 
```

到

```
error_reporting(E_ALL);
$stmt = $db->dbh->prepare("INSERT INTO images (filename) VALUES (?)");
if (!$stmt) die ('prepare() failed!');
$h = "hello world!";
$rv = $stmt->bindParam(1, $h);
if (!$rv) die ('bindParam() failed!');
$rv = $stmt->execute();
if (!$rv) die ('execute() failed!'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T01:02:42.090

试试这个：

**索引.php**

```
<?php
error_reporting(E_ALL); 
ini_set('display_errors', 1);
require('includes/classes.php');
require_once('includes/config.php');

$db = new DatabaseCon();
$db = $db->dbConnect($config);

$stmt = $db->prepare("INSERT INTO images (filename) VALUES (?)");
$stmt->bindParam(1, "hello world!");
$stmt->execute();
?> 
```

**类.php**

```
<?php
error_reporting(E_ALL);
ini_set('display_errors', 1);
require('config.php');

// Connect to database
// Does not handle anything else
class DatabaseCon {

    // Method to connect to database
    function dbConnect($config) {
        try {
            $dbh = new PDO("mysql:host=" . $config['host'] . ";dbname=" . $config['dbname'], $config['dbuser'], $config['dbpass']);
            //$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_SILENT);
            return $dbh;
        } catch (PDOException $e) {
            echo $e->getMessage();
                    return false;
        }

    }
} 
```

DatabaseCon 应该充当创建连接对象的工厂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T01:05:43.553

感谢@BenRowe 的帮助，我发现了这个问题，现在已经解决了。使用 $this 关键字和删除“hello world！”的组合。调用 bindParam() 的部分修复了它。似乎 bindParam() 方法仅采用基于引用的值。所以我将随机变量 $h 设置为“hello world！”，并将 bindParam(1, "hello world") 更改为 bindParam(1, $h)。

谢谢大家 ：）

# algorithm - 棘手的面试难题

> ID：11787756
> 
> 赞同：11
> 
> 时间：2012-08-03T00:37:48.777
> 
> 标签：algorithm, math, time-complexity, calculus

您在 Javascript 中有此代码（即使语言选择无关紧要）：

```
var arr = new Array(101);
for (skip = 1; skip <= 100; skip++) {
    for (i = 0; i <= 100; i+= skip) {
        arr[i] = !arr[i];
    }
} 
```

显然，这段代码运行后，数组中会有一堆真假值。如果 arr[i] 被触摸了偶数次，则为假，否则为真。

问题是这些价值形成了什么样的模式？你能快速判断 arr[15] 是真还是假？arr[81] 呢？

我知道答案（当 x 是某个整数的平方时，arr[x] 为真），但我不明白我应该如何在面试中快速得出答案？

额外的问题是这段代码的时间复杂度是多少，假设您对 N 个数组元素执行此操作（我将在下面回答）？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-03T00:44:56.760

所有完美的方形项目都是真的，所有其他的都是假的。

[http://thedailywtf.com/Articles/Nerds,-Jocks,-and-Lockers.aspx](http://thedailywtf.com/Articles/Nerds,-Jocks,-and-Lockers.aspx)

这可以通过以下事实来解释：完美正方形具有奇数个唯一因子，而所有其他正方形具有偶数个。这是因为完美平方的平方根仅计为一个因素。

一个数字会针对它所具有的每个因素切换一次，例如：

```
12 -> 1, 2, 3, 4, 6, 12 -> an even number, so still false
16 -> 1, 2, 4, 8, 16 -> an odd number, so true 
```

奖励：该算法执行 n + n/2 + n/3 ...切换导致 O(n log n) 时间（在另一个答案中解释得更好）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-03T00:37:48.777

如果对 N 个元素执行此操作，则将有 N + N/2 + N/3 + ... 操作。是调和级数，级数的部分和呈对数增长。因此，时间复杂度为 O(n*log n)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-03T09:31:16.240

所有带有整数平方的数字都为真，其他数字为假。

证明：

我们将看到，只有将它们除以奇数的数字才会为真：

表示数字 N > 0。

根据代数中的一句话，有 k 个不同的素数 p1,p2,...pk 和非零整数 m1 m2,...,mk

例如：N = p1^m1 * p2^m2 *...* pk^mk。

因此，除 N 的数 =

(m1 + 1) *(m2 + 1)* ...*(mk + 1)。那是来自组合学。

这个数字是奇数 <=> 对于每个 1 <= j <= k , mj + 1 是奇数 <=> 对于每个 1<= j <= k, mj 是偶数 <=> 存在 n1,n2,..., nk 个非零元素，例如 mj = 2nj，每个 1 <= j <= k。

所以我们得到：

N = p1^2n1 * p2^2n2 *..* pk^2nk => N = (p1^n1 * p2^n2 *...* pk^nk)^2，如我们所愿。

这是一个数学证明。

# iphone - 如何在ios上正确格式化货币

> ID：11787759
> 
> 赞同：36
> 
> 时间：2012-08-03T00:37:56.963
> 
> 标签：iphone, ios, numbers, currency, formatter

我正在寻找一种在不使用 TextField hack 的情况下将字符串格式化为货币的方法。

例如，我想将数字“521242”转换为“5,212.42”或者如果我有一个低于 1 美元的数字，我希望它看起来像这样：“52”->“0.52”

谢谢

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-08-03T00:44:20.667

你可能想要这样的东西（假设货币是浮动的）：

```
NSNumberFormatter *numberFormatter = [[NSNumberFormatter alloc] init];
[numberFormatter setNumberStyle: NSNumberFormatterCurrencyStyle];
NSString *numberAsString = [numberFormatter stringFromNumber:[NSNumber numberWithFloat:currency]]; 
```

根据您将 52 视为 0.52 的要求，您可能需要除以 100.0。

这种方法的好处是它将尊重当前的语言环境。因此，它会在适当的情况下将您的示例格式化为“5.212,42”。

**更新：** 我发布示例的速度可能有点快。正如下面康拉德舒尔茨所指出的，在处理货币金额时，最好将数量存储为`NSDecimalNumber`s。这将大大减少舍入错误带来的麻烦。如果你这样做，上面的代码片段变成（假设货币是 a `NSDecimalNumber*`）：

```
NSNumberFormatter *numberFormatter = [[NSNumberFormatter alloc] init];
[numberFormatter setNumberStyle: NSNumberFormatterCurrencyStyle];
NSString *numberAsString = [numberFormatter stringFromNumber:currency]; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-03T00:46:29.550

我使用此代码。这对我有用

1) 将 UITextField 委托添加到头文件

2）添加此代码（启用ARC）

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

NSString *cleanCentString = [[textField.text
                              componentsSeparatedByCharactersInSet:
                              [[NSCharacterSet decimalDigitCharacterSet] invertedSet]]
                             componentsJoinedByString:@""];
// Parse final integer value
NSInteger centAmount = cleanCentString.integerValue;
// Check the user input
if (string.length > 0)
{
    // Digit added
    centAmount = centAmount * 10 + string.integerValue;
}
else
{
    // Digit deleted
    centAmount = centAmount / 10;
}
// Update call amount value
NSNumber *amount = [[NSNumber alloc] initWithFloat:(float)centAmount / 100.0f];
// Write amount with currency symbols to the textfield
NSNumberFormatter *_currencyFormatter = [[NSNumberFormatter alloc] init];
[_currencyFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];
[_currencyFormatter setCurrencyCode:@"USD"];
[_currencyFormatter setNegativeFormat:@"-¤#,##0.00"];
textField.text = [_currencyFormatter stringFromNumber:amount];
return NO; } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-09-10T12:17:19.440

迅捷2.0版本：

```
 let _currencyFormatter : NSNumberFormatter = NSNumberFormatter()
    _currencyFormatter.numberStyle = NSNumberFormatterStyle.CurrencyStyle
    _currencyFormatter.currencyCode = "EUR"
    textField.text = _currencyFormatter.stringFromNumber(amount); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-07T11:03:38.633

使用以下代码，它将解决您的所有问题....

```
NSNumberFormatter *numberFormatter = [[NSNumberFormatter alloc] init];
[numberFormatter setNumberStyle: NSNumberFormatterCurrencyStyle];
NSString *numberAsString = [numberFormatter stringFromNumber:[NSNumber numberWithDouble:[currency doubleValue]]]; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-18T06:42:03.177

这就是我发现使用 NSDecimalNumbers 修改 AAV 答案的结果。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

NSString *cleanCentString = [[textField.text
                              componentsSeparatedByCharactersInSet:
                              [[NSCharacterSet decimalDigitCharacterSet] invertedSet]]
                             componentsJoinedByString:@""];

// Parse final integer value
NSDecimalNumber *price = [NSDecimalNumber decimalNumberWithMantissa:[cleanCentString integerValue]
                                                           exponent:-2
                                                         isNegative:NO];

NSDecimalNumber *entry = [NSDecimalNumber decimalNumberWithMantissa:[string integerValue]
                                                           exponent:-2
                                                         isNegative:NO];

NSDecimalNumber *multiplier = [NSDecimalNumber decimalNumberWithMantissa:1
                                                            exponent:1
                                                          isNegative:NO];

NSDecimalNumberHandler *handler = [NSDecimalNumberHandler decimalNumberHandlerWithRoundingMode:NSRoundPlain
                                                                                         scale:2
                                                                              raiseOnExactness:NO
                                                                               raiseOnOverflow:NO
                                                                              raiseOnUnderflow:NO
                                                                           raiseOnDivideByZero:NO];
NSDecimalNumber *result;

// Check the user input
if (string.length > 0)
{
    // Digit added
    result = [price decimalNumberByMultiplyingBy:multiplier withBehavior:handler];
    result = [result decimalNumberByAdding:entry];
}
else
{
    // Digit deleted
    result = [price decimalNumberByDividingBy:multiplier withBehavior:handler];
}

// Write amount with currency symbols to the textfield
NSNumberFormatter *_currencyFormatter = [[NSNumberFormatter alloc] init];
[_currencyFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];
[_currencyFormatter setCurrencyCode:@"USD"];
textField.text = [_currencyFormatter stringFromNumber:result];

return NO;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-11-02T03:44:14.817

```
func getCurrencyFormat(price:String)->String{
    let convertPrice = NSNumber(double: Double(price)!)
    let formatter = NSNumberFormatter()
    formatter.numberStyle = .CurrencyStyle
    formatter.currencyCode = "USD"        

    let convertedPrice = formatter.stringFromNumber(convertPrice)       
    return convertedPrice!
} 
```

注意：- 货币代码是三个字母的代码，在大多数情况下，由一个国家的两个字符的互联网国家代码加上一个额外的字符组成，以表示货币单位。例如，澳元的货币代码是“AUD”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-09-22T09:05:19.930

**对于 Swift 测试代码（参考 AAV 的代码）**

```
func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool{

    let strMain : NSString = string

    let arrTemp : NSArray = (textField.text?.componentsSeparatedByCharactersInSet(NSCharacterSet.decimalDigitCharacterSet().invertedSet))!
    let str: NSString = arrTemp.componentsJoinedByString("")

    //NSInteger centAmount = cleanCentString.integerValue;
    var centAmount : NSInteger = str.integerValue

    if (string.length > 0)
    {
        // Digit added
        centAmount = centAmount * 10 + strMain.integerValue;
    }
    else {
        // Digit deleted
        centAmount = centAmount / 10;
    }

    let amount = (Double(centAmount) / 100.0)

    let currencyFormatter = NSNumberFormatter()
    currencyFormatter.numberStyle = .CurrencyStyle
    currencyFormatter.currencyCode = "USD"
    currencyFormatter.negativeFormat = "-¤#,##0.00"
    let convertedPrice = currencyFormatter.stringFromNumber(amount)

    print(convertedPrice)

    txtAmount.text = convertedPrice! //set text to your textfiled
    return false //return false for exact out put
} 
```

注意：如果您想从输入中删除默认货币符号，您可以使用 currencySymbol 来空白，如下所示

```
currencyFormatter.currencyCode = nil
currencyFormatter.currencySymbol = "" 
```

快乐编码！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-01T16:02:46.983

使用格式化程序的一件事是创建它们的成本很高。最好为每个视图或视图控制器创建一次。Using`lazy`是避免这种开销的完美解决方案。这也将许多样板代码移到了主代码之外。

```
class MyViewController: UIViewController {
    @IBOutlet var priceLabel: UILabel!

    private lazy var currencyFormatter: NumberFormatter = {
        let formatter = NumberFormatter()
        formatter.currencySymbol = "$"
        formatter.numberStyle = .currency
        return formatter
    }()

     // rest of class
 } 
```

使用它，如其他地方所述，最好`Decimal`用于货币，`Double`是一个近似值。

```
priceLabel.text = currencyFormatter.string(for: Decimal(9.48)) 
```

输出：

```
$9.48 
```

# linux - gs:0x10 分段错误

> ID：11787760
> 
> 赞同：0
> 
> 时间：2012-08-03T00:38:04.923
> 
> 标签：linux, x86, segmentation-fault

由于某种原因，我的程序在这一行收到 SIGSEV 错误：

```
 mov edi, DWORD PTR gs:[eax-0x71] 
```

在哪里：

```
 eax - 0x71 = 0x9881668
    [0x9881668] = 0x00000010
    gs = 0x33 
```

edi 应该包含 __kernel_vsyscall 的地址，但是……出了点问题。怎么了？这是在 Ubuntu 11.10 BTW 上。

# python - Python将列表和元组列表解析为csv

> ID：11787765
> 
> 赞同：1
> 
> 时间：2012-08-03T00:38:41.210
> 
> 标签：python

这真的很令人沮丧：我只是在一个 csv 文件中存储了一些包含列表的数据行，这些数据行经过长时间的计算。我无法将 csv 数据恢复为变量。它更精确的一行

> 皮特; [1,2,3,4,5]; [(1,2),(3,4),(5,6),...]

当然，Python csv 解析为一个字符串：/，因此，如果我尝试使用 list()-casting，它就像：

```
list("[(1,2),(3,4)]") = ['[','(','1',',',...] 
```

你有什么想法来解决这个问题吗？

以为我可以使用：

对于 csvfile 中的名称、列表、lTuples：

...

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T00:51:27.507

您可以使用[ast.literal_eval](http://docs.python.org/library/ast.html)（只要字符串仅包含字符串、数字、元组、列表、字典、布尔值和无）。

```
>>> import ast
>>> ast.literal_eval("[(1,2),(3,4)]")
[(1, 2), (3, 4)] 
```

# android - 如何在单击视频帧中的任何位置时重定向页面，网址链接页面应打开

> ID：11787767
> 
> 赞同：1
> 
> 时间：2012-08-03T00:39:03.160
> 
> 标签：android, html, cordova

如何在单击视频帧中的任何位置时重定向页面，网址链接页面应打开

代码：

```
$(document).ready(function(){

                $("#ytplayer").attr('src', 'http://www.youtube.com/embed/' + getValue("id") +'?autoplay=1&origin=http://example.com');
    $("#back").click(function(){

                if(getValue("Animat")==1 || getValue("Animat")==2 || getValue("Animat")==3 || getValue("Animat")==4)
                {
        window.location.href = "Week-Animations.html?Animat=" + getValue("Animat") + "&week=" + getValue("week") + "&tier=" + getValue("tier");
                }});});

<iframe  id="f" width="300" height="320" src=" "  frameborder="0" allowfullscreen></iframe>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-16T14:02:07.180

尝试使用“开始”参数作为嵌入视频的 url，这应该可以解决问题。

[https://developers.google.com/youtube/player_parameters#start](https://developers.google.com/youtube/player_parameters#start)

因此，您需要做的是，当用户单击按钮时，更改视频 url 添加一个“开始 = 时间”，其中时间是一个数字（您可以使用 34 分 10 秒转到 34 分 10 秒）。让我知道这是否有帮助。

队友的欢呼声，

鲍勃

# lisp - (= 1/5 0.2) 是假的？

> ID：11787772
> 
> 赞同：3
> 
> 时间：2012-08-03T00:40:03.180
> 
> 标签：lisp, scheme, common-lisp

这在常见的 lisp（clisp 和 sbcl）和方案（guile）中都有。虽然这些都是真的：

```
(= 1/2 0.5)
(= 1/4 0.25) 
```

事实证明这是错误的：

```
(= 1/5 0.2) 
```

我检查了超规范，它说“=”应该检查数学等价性，尽管参数的类型。到底他妈发生了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-03T01:03:53.917

问题是 0.2 真的*不*等于 1/5。浮点数不能正确表示 0.2，因此文字 0.2 实际上四舍五入到最接近的可表示浮点数（0.200000001 或类似的东西）。发生此舍入后，计算机无法知道您的数字最初是 0.2 而不是附近的另一个不可表示的数字（例如 0.20000000002）。

至于 1/2 和 1/4 之所以起作用，是因为浮点是基数为 2 的编码，可以准确地表示 2 的幂。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-03T09:52:25.153

请阅读[每个计算机科学家应该了解的关于浮点数的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T09:13:54.057

这实际上取决于什么被强制到什么。如果您考虑一下，那么理性更精确，因此强制比较理性而不是浮动是有意义的，但是，如果您有意识地将数字作为浮动进行比较，您可以通过执行以下操作来强制它：

```
(declaim (inline float=))
(defun float= (a b)
  (= (coerce a 'float) (coerce b 'float)))
(float= 0.2 1/5) ; T 
```

实际上......还有更多，因为浮点数为您提供了诸如非数字、正无穷大和负无穷大之类的东西。例如，对于 64 位浮点数，无穷大是 10e200 iirc，因此，没有什么可以阻止您创建一个大于无穷大（或小于负无穷大！）的理性，所以，也许，如果你想要超级精确，你也需要考虑这些情况。同样，与非数字的比较必须始终给您零……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-03T12:11:55.617

但是，在方案中你有确切的数字，所以你可能会问（注意 #e 前缀，这意味着后面的数字要被准确对待）：

```
> (= 1/5 #e0.2)
#t 
```

# iphone - 打开一个 UIButton .mobileconfig

> ID：11787773
> 
> 赞同：0
> 
> 时间：2012-08-03T00:40:16.733
> 
> 标签：iphone, ios, xcode

如何让 UIButton 打开 .mobileconfig 文件？我试过 UIWebView 但它不起作用，我宁愿不使用 UIWebView。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:28:18.763

.mobileconfigue 不能被除邮件和 safari 之外的任何应用程序打开。

# objective-c - 如何在作为 iPad 的 Xcode 4.3.3 Objective-C 项目的一部分的 C 文件中进行 C 指针运算？

> ID：11787776
> 
> 赞同：0
> 
> 时间：2012-08-03T00:40:46.063
> 
> 标签：objective-c, xcode, automatic-ref-counting

在我看来，我有一个无辜的循环，它迭代在编译时类型未知的数组元素；我的数组名为mesh->vertices，是一个指向void的指针。根据网格->纹理的真值，我需要以不同的方式考虑数组。顺便说一句，下面代码段中的 if 和 else 中的代码是相似的，但我确实需要区分两种情况。

```
void TransformMesh(struct Mesh *mesh, struct Matrix4 *t)
{
    for (int i = 0; i < mesh->nVertices; ++i)
    {
        if (mesh->textured)
        {
            struct TexturedVertex *ptr = ((struct TexturedVertex *)mesh->vertices) + i;

            ptr[i].position = MatrixPointMultiply3(t, &ptr->position);
            ptr[i].normal = MatrixPointMultiply3(t, &ptr->normal);
        }
        else
        {
            struct Vertex *ptr = ((struct Vertex *)mesh->vertices) + i;

            ptr[i].position = MatrixPointMultiply3(t, &ptr->position);
            ptr[i].normal = MatrixPointMultiply3(t, &ptr->normal);
        }
    }
} 
```

我想我使用自动引用计数选项创建了项目，认为它不会影响 C 代码，但现在我觉得我错了（顺便说一句，我如何检查我选择的选项？）。

好吧，看起来这个函数对另一个名为 mesh->triangles 的数组做错了，可能会释放它。当我尝试使用向量时，出现 EXC_BAD_ACCESS 错误：

```
glDrawElements(GL_TRIANGLES, mesh->nTriangles * 3, GL_UNSIGNED_INT, mesh->triangles); 
```

看起来像迭代网格->顶点元素，铸造它们并进行指针运算，正在破坏内存。我认为我的问题是 ARC，所以我尝试执行[此处](https://stackoverflow.com/questions/6646052/how-can-i-disable-arc-for-a-single-file-in-a-project)描述的操作，但没有运气。

编辑：

正如 Conrad Shultz 所指出的，上面的代码是错误的；以下是正确的：

```
 ptr->position = MatrixPointMultiply3(t, &ptr->position);
            ptr->normal = MatrixPointMultiply3(t, &ptr->normal); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:52:54.900

我严重怀疑 ARC 与此有关 - ARC 只管理 Objective-C 对象。（它甚至不知道如何处理 Core Foundation 类型，这导致需要使用`__bridge...`关键字。）

我很难理解你的代码。诚然，我没有做很多直接的 C 编程，但我没有得到你想要通过添加`i`to来做的事情`ptr`，这大概是你所说的指针算法。

您是否只想访问`i`th `struct TexturedVertex`in `mesh->vertices`？如果是这样，只需使用您`ptr[i]`所写的构造。

在我看来，您正在做算术运算，`ptr`最终指向`i`th `struct TexturedVertex`，然后通过访问`ptr[i]`您正在读取th之后的`i`元素。如果指的是（看起来合乎逻辑，给定名称和 C 数组约定）的计数，那么您正在阅读的结尾是一个经典的缓冲区溢出错误，这毫不奇怪会导致 EXC_BAD_ACCESS 和各种其他有趣的错误。`i``struct TexturedVertex``nVertices``vertices``vertices`

# java - 如何在apache poi中动态生成多个工作表

> ID：11787785
> 
> 赞同：1
> 
> 时间：2012-08-03T00:42:03.897
> 
> 标签：java, apache-poi, openxml

我想在 Apache poi 中为工作簿/excel 动态生成多个工作表。我想知道如何以高效且线程安全/并发的方式进行操作。

1.  因此，可以选择动态命名多个工作表。
2.  每个工作表都有自己的一组列等（或样式）。
3.  将它们写回 servlet 等。

请帮忙。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:02:06.880

像这样？

```
public static void createExcel(String excelFilePath, String sheetName)
        throws IOException {
    FileOutputStream fos = null;
    try {
        HSSFWorkbook workbook = null;
        if (new File(excelFilePath).createNewFile()) {
            workbook = new HSSFWorkbook();
        } else {
            POIFSFileSystem pfs = new POIFSFileSystem(new FileInputStream(
                    new File(excelFilePath)));
            workbook = new HSSFWorkbook(pfs);
        }
        if (workbook.getSheet(sheetName) == null) {
            fos = new FileOutputStream(excelFilePath);
            workbook.createSheet(sheetName);
            workbook.write(fos);
        }

    } catch (IOException e) {
        throw e;
    } finally {
        if (fos != null) {
            fos.close();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-16T05:14:50.663

请找到示例代码。

```
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.Date;
import java.util.List;
import java.util.Map;

import org.apache.poi.hssf.usermodel.HSSFCellStyle;
import org.apache.poi.hssf.usermodel.HSSFFont;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.hssf.util.HSSFColor;
import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;

public class ExcelUtility {

    public static boolean writeDataSheetWise(final String excelFileName, final List<String> headers,
            Map<String, List<Object[]>> sheetRowDataList) throws IOException, InvalidFormatException {

        boolean isWritten = false;
        HSSFWorkbook workbook = new HSSFWorkbook();
        for(String sheetName: sheetRowDataList.keySet()) {
            createSheet(workbook, sheetName, headers, sheetRowDataList.get(sheetName));
        }

        try {
            System.out.println("\nWritting data to excel file <" + excelFileName + ">");

            FileOutputStream outputStream = new FileOutputStream(new File(excelFileName));
            workbook.write(outputStream);
            outputStream.flush();
            outputStream.close();
            isWritten = true;

            System.out.println("\nData is successfully written to excel file <"+excelFileName+">.");

        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return isWritten;
    }

    public static boolean writeData(final String excelFileName, final String sheetName, final List<String> headers,
            List<Object[]> rowDataList) throws IOException, InvalidFormatException {

        boolean isWritten = false;
        HSSFWorkbook workbook = new HSSFWorkbook();
        createSheet(workbook, sheetName, headers, rowDataList);

        try {
            System.out.println("\nWritting data to excel file <" + excelFileName + ">");

            FileOutputStream outputStream = new FileOutputStream(new File(excelFileName));
            workbook.write(outputStream);
            outputStream.flush();
            outputStream.close();
            isWritten = true;

            System.out.println("\nData is successfully written to excel file <"+excelFileName+">.");

        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return isWritten;

    }

    @SuppressWarnings("deprecation")
    private static void createSheet(final HSSFWorkbook workbook, final String sheetName, final List<String> headers,
            final List<Object[]> rowDataList) {

        HSSFSheet sheet = workbook.createSheet(sheetName);

        int rowCount = 0;

        HSSFCellStyle style = workbook.createCellStyle();
        HSSFFont headersFont = workbook.createFont();
        headersFont.setFontName(HSSFFont.FONT_ARIAL);
        headersFont.setFontHeightInPoints((short) 16);
        headersFont.setColor(HSSFColor.GREEN.index);
        headersFont.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);
        style.setFont(headersFont);

        // Creating header row
        Row headerRow = sheet.createRow(rowCount++);
        for (int i = 0; i < headers.size(); i++) {
            Cell cell = headerRow.createCell(i);
            cell.setCellStyle(style);
            cell.setCellValue(headers.get(i));
            sheet.autoSizeColumn(i);
        }

        for (Object rowDataObject[] : rowDataList) {
            Row row = sheet.createRow(rowCount++);
            int cellnum = 0;
            for (Object rowData : rowDataObject) {
                Cell cell = row.createCell(cellnum++);
                if (rowData instanceof Date)
                    cell.setCellValue((Date) rowData);
                else if (rowData instanceof Boolean)
                    cell.setCellValue((Boolean) rowData);
                else if (rowData instanceof String)
                    cell.setCellValue((String) rowData);
                else if (rowData instanceof Integer)
                    cell.setCellValue((Integer) rowData);
                else if (rowData instanceof Long)
                    cell.setCellValue((Long) rowData);
                else if (rowData instanceof Double)
                    cell.setCellValue((Double) rowData);

            }
        }
    }
} 
```

# javascript - Ember - 在不同页面上启动应用程序时验证不起作用

> ID：11787788
> 
> 赞同：0
> 
> 时间：2012-08-03T00:42:18.363
> 
> 标签：javascript, jquery-validate, ember.js

我的 Ember 应用程序中有几个视图。我在注册视图中的观点之一。我用模板定义它。
我也在使用 jquery validate 插件，这样我就可以轻松地验证注册表单等表单。
为了让注册视图与验证一起工作，我在注册表单上添加了一个初始化验证的 js 脚本。
当我将应用程序直接加载到注册视图 ( `myapp/index.html#/registration`) 时，验证已初始化并且工作正常。
问题是当我将应用程序加载到不同的页面（`myapp/index.html#/list`例如）然后按下按钮将状态更改为注册时，验证不起作用并且可以提交一个空表单。
由于某些原因，当加载的第一个视图不是注册视图时，注册验证初始化不起作用。
知道为什么吗？我该如何解决这个问题？

**编辑：这是一些代码**
这是视图：

```
<script type="text/x-handlebars" data-template-name="registration">
        <form class="form-horizontal" id="registerForm">
            <fieldset>
                <legend>registration</legend>
                <div class="control-group">
                    <label class="control-label" for="user_name">User Name</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="user_name" name="user_name"/>
                    </div>
                </div>  
                <div class="control-group">
                    <label class="control-label" for="user_email">Email</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="user_email" name="user_email" title="Tooltip text"/>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="password">Password</label>
                    <div class="controls">
                        <input type="password" class="input-xlarge" id="password" name="password" title="Password tooltip"/>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="password_confirm">Password Confirmation</label>
                    <div class="controls">
                        <input type="password" class="input-xlarge" id="password_confirm" name="password_confirm" title="Confirmation tooltip">
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label"></label>
                    <div class="controls">
                        <button type="submit" class="btn btn-success">Create Account</button>
                    </div>
                </div>
            </fieldset>
        </form>
    </script> 
```

这是注册视图的初始化脚本：

```
$(document).ready(function() {

    $("#registerForm input").tipsy({gravity: 'e'});

    // Validation
    $("#registerForm").validate({
        rules : {
            user_name : "required",
            user_email : {
                required : true,
                email : true
            },
            password : {
                required : true,
                minlength : 6
            },
            password_confirm : {
                required : true,
                equalTo : "#password"
            }
        },

        errorClass : "help-inline",
        errorElement : "span",
        highlight : function(element, errorClass, validClass) {
            $(element).parents('.control-group').removeClass('success');
            $(element).parents('.control-group').addClass('error');
        },
        unhighlight : function(element, errorClass, validClass) {
            $(element).parents('.control-group').removeClass('error');
            $(element).parents('.control-group').addClass('success');
        }
    });
}); 
```

这是与注册相关的应用代码：

```
App.RegistrationController = Em.Controller.extend();
App.RegistrationView = Em.View.extend({
    templateName: 'registration'
});
App.Router = Em.Router.extend({
    enableLogging: true,
    location: 'hash',

    root: Em.Route.extend({
        // EVENTS
        gotoList: Ember.Route.transitionTo('list'),
        gotoAbout: Ember.Route.transitionTo('about'),
        gotoPost: Ember.Route.transitionTo('post'),
        gotoRegistration: Ember.Route.transitionTo('registration'),

        // STATES
        index: Em.Route.extend({
            route: '/',
            redirectsTo: 'list'
        }),
        list: Em.Route.extend({
            route: '/list',
            connectOutlets: function(router, context) {
                router.get('applicationController').connectOutlet('list');
            }
        }),
        about: Em.Route.extend({
            route: '/about',
            connectOutlets: function(router, context) {
                router.get('applicationController').connectOutlet('about');
            }
        }),
        post: Em.Route.extend({
            route: '/post',
            connectOutlets: function(router, context) {
                router.get('applicationController').connectOutlet('post');
            }
        }),
        registration: Em.Route.extend({
            route: '/registration',
            connectOutlets: function(router, context) {
                router.get('applicationController').connectOutlet('registration');
            }
        })
    })
}); 
```

问题是当我浏览“#\list”然后去注册时，看起来注册初始化脚本没有执行，尽管我在我的html中添加了对这个脚本的引用。知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T23:37:30.900

乍一看，您的验证脚本似乎是在 dom 准备好时执行的。

因此，如果您先使用 /registration，则会显示表单，准备就绪后，脚本可以正常工作，因为所有表单元素都存在于 Dom 中。

但是当你第一次输入 /list 时，它会显示列表，然后 dom 准备就绪，并且你的脚本被执行。但是所有验证内容都会搜索不在页面上的#registration，并且什么都不做。然后当你切换到/registration时，脚本不会再次被评估（基本上路由到一个状态不像刷新页面，只是更新dom）。

我认为如果您`didInsertElement`在 RegistrationView 的函数中编写验证代码，那么它应该可以工作。

```
App.RegistrationView = Em.View.extend({
  templateName: 'registration',

  didInsertElement: function () {
    this.$("#registerForm input").tipsy({gravity: 'e'});
    // Validation
    this.$("#registerForm").validate({
      rules : {
        user_name : "required",
        user_email : {
           required : true,
           email : true
        },
        password : {
           required : true,
           minlength : 6
        },
        password_confirm : {
           required : true,
           equalTo : "#password"
        }
      },

      errorClass : "help-inline",
      errorElement : "span",
      highlight : function(element, errorClass, validClass) {
        $(element).parents('.control-group').removeClass('success');
        $(element).parents('.control-group').addClass('error');
      },
      unhighlight : function(element, errorClass, validClass) {
        $(element).parents('.control-group').removeClass('error');
        $(element).parents('.control-group').addClass('success');
      }
    });
  }
}); 
```

**更新**：这是一个几乎可以工作的 jsfiddle。几乎可以工作，因为我不确切知道 jquery-validation 是如何工作的。但是验证码被执行了。[http://jsfiddle.net/Sly7/3JhzM/](http://jsfiddle.net/Sly7/3JhzM/)

# asp.net - AngularJS 和 ASP.Net 中的单页应用程序运行良好，但是当我在浏览器中刷新页面时出现 404 错误

> ID：11787795
> 
> 赞同：12
> 
> 时间：2012-08-03T00:43:29.607
> 
> 标签：asp.net, redirect, asp.net-mvc-4, angularjs, pushstate

所以我设置了一个 HTML5 单页应用程序，它运行良好。该页面位于`/App/`，当有人进入内容时，它看起来像`/App/Content/1234`.

一个问题：如果用户刷新页面，服务器将找不到该 URL，因为它实际上并不存在。如果我将它们发送到`/App/#/Content/1234`，它们是金色的，但是最好的方法是什么？我在 /App 下有很多不同风格的 URL。

全局捕获任何请求`~/App/(.*)`并将其重定向到的最佳方法是什么`~/App/#/$1`？

在 MVC 中注册的唯一路由是标准的 OOTB 路由。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T02:30:11.453

听起来您的服务器没有将 url 重写为应用程序的基本 URL。

Web 服务器上所需的 URL 重写取决于服务器。对于 Apache，您将使用 mod_rewrite。

相反，将 Angular 切换到“Hashbang 模式”（默认），这样 url 将全部存储在 url 中 # 之后的本地状态。

我不希望我的应用程序需要更改服务器配置，所以我推荐 hashbang 模式。

请参阅[AngularJS 文档](http://docs.angularjs.org/guide/dev_guide.services.%24location)。请参阅“Hashbang 和 HTML5 模式”部分 HTML5 模式部分描述了支持 URL 的 HTML5 模式所需的所有配置问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-27T14:19:14.640

这个了不起的家伙在这里描述了如何解决这个[问题](http://tarkus.me/post/32121691785/angularjs-with-asp-net-mvc-4)。

简单来说：

1.  删除 MVC nuget（除非您将 MVC 控制器用于任何事情） - 您可以保留 Web API nuget。保留网页和 Razor 包。同时删除 MVC 控制器和视图。
2.  您可以继续使用带有一些 web.config 修改的 .cshtml 文件。你需要这个来捆绑。
3.  最后，在 web.config 上添加一个重写规则，将所有 url（不包括内容、图像、脚本等）指向 index.html

# sql-server - 每个用户表都应该有一个聚集索引吗？

> ID：11787797
> 
> 赞同：25
> 
> 时间：2012-08-03T00:44:11.403
> 
> 标签：sql-server, sql-server-2008, indexing, sql-server-2008-r2, sqlperformance

最近我在数据库中发现了几个没有定义聚集索引的表。但是定义了非聚集索引，所以它们在 HEAP 上。

在分析中，我发现 select 语句正在对非聚集索引中定义的列使用过滤器。

这些表上没有聚集索引会影响性能吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-08-06T20:51:41.563

很难比 SQL Server MVP [Brad McGehee](http://www.sql-server-performance.com/author/bradmcgehee/)更简洁地说明这一点：

> **[根据经验，每个表都应该有一个聚集索引。](http://www.sql-server-performance.com/2007/clustered-indexes/)**通常，但并非总是如此，聚集索引应该位于单调增加的列上——例如标识列，或值增加的其他列——并且是唯一的。在许多情况下，主键是聚集索引的理想列。

[BOL](http://msdn.microsoft.com/en-us/library/ms186342.aspx)回应了这种观点：

> 除了少数例外，每个表都应该有一个聚集索引。

这样做的原因有很多，主要是基于**聚集索引对存储中的数据进行物理排序**这一事实。

*   如果您的聚集索引在单个列上单调增加，则插入会在您的存储设备上按顺序发生，并且不会发生页面拆分。

*   当索引值唯一时，聚集索引对于查找特定行非常有效，例如基于主键选择行的常见模式。

*   聚集索引[通常](http://sqlinthewild.co.za/index.php/2011/02/01/is-a-clustered-index-best-for-range-queries/)允许对经常搜索值范围（ 、 等）的列进行有效`between`查询`>`。

*   聚类可以加快数据通常按特定列或列排序的查询。

*   可以根据需要重建或重组聚集索引以控制表碎片。

*   这些好处甚至可以[应用于视图](http://msdn.microsoft.com/en-us/library/ms191432.aspx)。

您可能不希望在以下位置创建聚集索引：

*   具有频繁数据更改的列，因为 SQL Server 必须随后对存储中的数据进行物理重新排序。

*   已被其他索引覆盖的列。

*   宽键，因为聚集索引也用于非聚集索引查找。

*   GUID 列，它们大于标识，并且还有效地随机值（不太可能被排序），但[`newsequentialid()`](http://msdn.microsoft.com/en-us/library/ms189786.aspx)可用于帮助减轻插入期间的物理重新排序。

*   使用[堆](http://msdn.microsoft.com/en-us/library/hh213609)（没有聚集索引的表）的一个罕见原因是，如果始终通过非聚集索引访问数据，并且已知 RID（SQL Server 内部行标识符）小于聚集索引键。

由于这些和其他考虑因素，例如您的特定应用程序工作负载，您应该仔细选择聚集索引，以便为您的查询获得最大收益。

另请注意，**当您在 SQL Server 中的表上创建主键时，默认情况下它将创建一个唯一的聚集索引**（如果它还没有）。这意味着，如果您发现一个没有聚集索引但有主键的表（所有表都应该），则开发人员之前已决定以这种方式创建它。您可能希望有一个令人信服的理由来改变这一点（正如我们所见，其中有很多）。**添加、更改或删除聚集索引需要重写整个表**和任何非聚集索引，因此在大型表上这可能需要一些时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T16:38:04.157

我不会说“每个表都应该有一个聚集索引”，我会说“仔细查看每个表以及它们是如何被访问的，*如果有意义*的话，尝试在它上面定义一个聚集索引”。这是一个加号，就像小丑一样，每张桌子只有一个小丑，但你不必*使用*它。其他数据库系统没有这个，至少在这种形式下，顺便说一句。

Putting clustered indices everywhere without understanding what you're doing can also kill your performance (in general, the INSERT performance because a clustered index means physical re-ordering on the disk, or at least it's a good way to understand it), for example with GUID primary keys as we see more and more.

So, read Tim Lehner's exceptions and reason.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T01:45:40.153

是的，您应该在表上拥有聚集索引。这样所有非聚集索引都会以更好的方式执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T20:13:30.950

性能是一个毛茸茸的大问题。确保您正在针对正确的事情进行优化。

免费的建议总是物有所值，并且没有什么可以替代实际的实验。

索引的目的是找到匹配的行并在找到时帮助检索数据。

搜索条件上的非聚集索引将有助于查找行，但需要进行额外的操作才能获取行的数据。

如果没有聚集索引，SQL 使用内部 rowId 来指向数据的位置。

但是，如果表上有聚集索引，则该 rowId 将替换为聚集索引中的数据值。

因此不需要读取行数据的步骤，并且会被索引中的值覆盖。

即使聚集索引的选择性不是很好，如果这些键经常是请求的大部分或全部结果 - 将它们作为非聚集索引的叶子可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-03T09:48:46.923

考虑使用`clustered index`包含大量不同值的 when 列，**以避免 SQL Server 需要添加“唯一符”来重复键值**

**缺点**：如果只在聚簇索引中的字段发生变化时，更新记录需要更长的时间。

**避免**在几乎相同的聚簇索引值上发生许多并发插入的风险的聚簇索引构造

如果聚集索引没有正确构建，或者它不包括将数据返回给调用应用程序所需的所有列，则针对非聚集索引的搜索会显得较慢。如果非聚集索引不包含所有需要的数据，则 SQL Server 将转到聚集索引以获取丢失的数据（通过查找），这将使查询运行速度变慢，因为查找完成行按行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-06T21:15:00.143

是的，每个表都应该有一个聚集索引。聚集索引设置表中数据的物理顺序。您可以将此与商店中按乐队名称和/或按姓氏排序的黄页的音乐排序进行比较。由于这涉及物理订单，因此您只能拥有一个，它可以由许多列组成，但您只能拥有一个。

最好将聚集索引放在经常搜索一系列值的列上。示例是日期范围。当索引值唯一时，聚集索引对于查找特定行也很有效。**如果未定义聚簇索引，Microsoft SQL 将自动将聚簇索引放置在 PRIMARY KEY 约束上。**

聚集索引不是一个好的选择：

**频繁更改的列**

*   这会导致整行移动（因为 SQL Server 必须按物理顺序保持行的数据值）。在数据往往不稳定的大容量事务处理系统中，这是一个重要的考虑因素。

**宽键**

*   来自聚集索引的键值被所有非聚集索引用作查找键，因此存储在每个非聚集索引叶条目中。

# ios - 在 MKMapView 上设置多个引脚，并让标注视图显示正确的信息？

> ID：11787798
> 
> 赞同：2
> 
> 时间：2012-08-03T00:44:11.580
> 
> 标签：ios, mkmapview, mkannotation

我有一个对象数组，其中包含我地图上每个图钉的信息。我可以使用它们将具有各自坐标的那些添加到地图上`[mapView addAnnotions:array];`。但是当谈到选择一个引脚，然后显示该特定引脚的标注视图（使用正确的引脚位置和我的阵列中的正确信息）时，我迷路了。我也不完全知道标注视图如何为多个引脚工作。我试过查看 Apple 示例代码，但没有太大帮助，谷歌搜索问题也无济于事。

简单版本：您应该如何在地图上拥有许多图钉，并在它们被选中和被调用以获取标注视图时区分它们？

编辑：例如，iPhone 上的地图应用程序如何显示企业的多个位置，当您点击它们时，会出现正确的名称和指向所述企业的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:56:50.820

试试这个代码

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {

static NSString *identifier = @"MyLocation";   
if ([annotation isKindOfClass:[MNMyLocation class]]) {

    MKPinAnnotationView *annotationView = (MKPinAnnotationView *) [atmLocatorMap dequeueReusableAnnotationViewWithIdentifier:identifier];
    if (annotationView == nil) {
        annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:identifier];
    } else {
        annotationView.annotation = annotation;
    }

    annotationView.enabled = YES;
    annotationView.canShowCallout = YES;
    //annotationView.image=[UIImage imageNamed:@"arrest.png"];

    return annotationView;
}

return nil; 
```

}

# objective-c - -[__NSArrayI replaceObjectAtIndex:withObject:]: 无法识别的选择器发送到实例

> ID：11787802
> 
> 赞同：3
> 
> 时间：2012-08-03T00:44:53.650
> 
> 标签：objective-c, ios5, nsarray, nsdictionary

我有一个 Mutable NSArray 存储对象类型（ids - NSNumber，NSString），它将存储数字（1、2、3、4 等）、操作（+、-、/、* 等）和变量（ x、y、z 等）。我将变量和相关值存储在 NSDictionary 中，键是等于 x、y、z 的 NSString，NSNumber 值分别为 5、5、2。我想用存储在我的 NSDictionary 中的实际值替换我的 NSArray 中的变量。尝试替换对象时，我不断收到以下错误。请帮忙。

-[__NSArrayI replaceObjectAtIndex:withObject:]: 无法识别的选择器发送到实例

```
 NSDictionary *dict = [[NSDictionary alloc] initWithObjectsAndKeys:
                              [NSNumber numberWithDouble:5],@"x",  
                              [NSNumber numberWithDouble:5],@"y", 
                              [NSNumber numberWithDouble:2],@"z", 
                              nil];

+ (double)runProgram:(id)program
 usingVariableValues:(NSDictionary *)variableValues;
{
    // introspection - ensure program is NSArray and variableValues is NSDictionary
    if ([program isKindOfClass:[NSArray class]] && [variableValues isKindOfClass:    [NSDictionary class]])
    {
        // array for program stack
        NSMutableArray *stack = [program copy];

        // Loop to replace variables with actual values in NSDictionary
        for (NSUInteger i = 0; i < [stack count]; i++)
        {
            NSLog(@"object at index = %@", [stack objectAtIndex:i]);
        if ([[stack objectAtIndex:i] isKindOfClass:[NSString class]] && [[stack     objectAtIndex:i] isEqualToString: @"x"])
            {
                 // replace variable with value in corresponding value in dictionary
                NSNumber *numberKeyValue = [variableValues objectForKey:@"x"];
                [stack replaceObjectAtIndex:i withObject:numberKeyValue];
            }
        }
return 0
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-03T00:46:53.523

NSArray 的`copy`方法总是返回一个不可变数组，不管原始数组是可变的还是不可变的。如果你想要一个可变副本，你需要使用`mutableCopy`. （这是一个 Cocoa 约定。NSString、NSDictionary 以及通常具有可变和不可变变体的任何类都将以相同的方式工作。）

# java - Java SSL 套接字不工作

> ID：11787805
> 
> 赞同：2
> 
> 时间：2012-08-03T00:44:59.567
> 
> 标签：java, sockets, netbeans, ssl, applet

我正在使用 TCP/IP 套接字来创建客户端和服务器应用程序。最初我使用的是常规套接字，但现在我决定使用 SSL 进行连接。我创建了一个密钥库并尝试运行我的应用程序，但尚未成功。

这是我的服务器代码

```
public class ArFileServer {

public static void main(String[] args) 
{
    boolean listening = true;
    ServerSocketFactory serversocketfactory;
    ServerSocket serverSocket;  

    try
    {
        //serverSocket = new ServerSocket(4445);

        serversocketfactory = SSLServerSocketFactory.getDefault();
        serverSocket = serversocketfactory.createServerSocket(4445);

        String keystore = System.getProperty("javax.net.ssl.trustStore");
        System.out.println(keystore);

        // infinite loop to continually listen for connection requests made by clients
        while (listening)
        {
            new ClientConnection(serverSocket.accept()).start();

            if (serverSocket != null)
            {
                System.out.println("Connection to client established");
            }
        }

        serverSocket.close();
    }
    catch (IOException e)
    {
        System.out.println("Error could not create socket connection to port, check that port is not busy");
    }
}
} 
```

这是客户端代码：

```
public class ClientSocket 
{
SocketFactory socketfactory = null;
Socket clientSocket = null;
PrintWriter out = null;
BufferedReader in = null;

// establish a connection to All Care's server application through socket 4444 (adjust localhost to reflect the IP address that the server
// is being run from)
public ClientSocket()
{
    try
    {
        //clientSocket = new Socket("localhost", 4445);

        //SocketFactory socketfactory = SSLSocketFactory.getDefault();
        clientSocket = socketfactory.createSocket("192.168.1.8", 4445);
        out = new PrintWriter(clientSocket.getOutputStream(), true);
        in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));

        String truststore = System.getProperty("javax.net.ssl.trustStore");
        System.out.println(truststore);
    }
    catch (IOException e)
    {
        System.out.println("Could not connect to All Care Server Application : " + e.getMessage());
    }
}
} 
```

我也在使用这些运行时参数：

```
-Djavax.net.ssl.keyStore=C:\Users\Chris\Documents\NetBeansProjects\ArFile\keystore.jks -Djavax.net.ssl.keyStorePassword=password 
```

当我尝试打印出信任库时，它总是返回 null，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T05:15:44.270

> 当我尝试打印出信任库时，它总是返回 null

因为你从来没有设置它。您所做的只是打印出系统属性的值。如果你没有设置它，它是空的。

> 我究竟做错了什么？

什么都没有，除了打印出无意义的信息。但是你的大部分代码没有意义：

```
if (serverSocket != null)
{
    System.out.println("Connection to client established");
} 
```

`serverSocket`非空 (a) 在这一点上是不可避免的，并且 (b) 与正在建立的客户端套接字没有任何关系，这在这一点上是不可避免的。

```
catch (IOException e)
{
    System.out.println("Error could not create socket connection to port, check that port is not busy");
} 
```

在`IOException`这一点上可能意味着很多事情，但它并不意味着“无法创建与端口的套接字连接”。进行连接的是*客户端*：服务器*接受*连接。当你捕捉到一个异常时，总是打印*它的*信息，不要只是自己编造。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T07:48:19.687

您需要在运行时参数中定义 trustStore 和 keyStore ：

```
-Djavax.net.ssl.keyStore=xxx.ks 
-Djavax.net.ssl.keyStorePassword=yyy 
-Djavax.net.ssl.trustStore=xxx.ks 
-Djavax.net.ssl.trustStorePassword=yyy 
```

两者可以是同一个文件。

trustStore 包含其他人的公钥。keyStore 包含自己的密钥和证书。

# linux - 如何在启动期间设置 gsettings？

> ID：11787807
> 
> 赞同：4
> 
> 时间：2012-08-03T00:45:19.317
> 
> 标签：linux, ubuntu, gnome, init, ubuntu-12.04

我有一个托管 Ubuntu 12.04 实时映像的 pxe 服务器，我想在其上启用 VNC。

通常我会使用以下命令执行此操作：

$ gsettings 设置 org.gnome.Vino 启用 true

但是，由于此实时操作系统位于 RAM 中，因此每次启动时都需要执行此操作。问题是由于某种原因它不适用于 /etc/init.d/ 中的脚本...对于我的一生，我无法弄清楚为什么 gsettings 在这种情况下不起作用..

作为参考，这是我在 /etc/init.d 中使用的脚本：

```
#!/bin/bash

log=/var/log/gsettings.log

#Needed for some reason.. received info from http://stackoverflow.com/questions/10374520/gsettings-with-cron
sessionfile=`find "${HOME}/.dbus/session-bus/" -type f`
export $(grep "DBUS_SESSION_BUS_ADDRESS" "${sessionfile}" | sed '/^#/d')

set_gsettings()
{
    echo "Inside set_gsettings" >> $log

    #Enable vino
    gsettings set org.gnome.Vino enabled true 2>&1 >> $log
    gsettings set org.gnome.Vino prompt-enabled false 2>&1 >> $log
}

case "$1" in
  start)
    echo "Inside IT-gsettings" >> $log
    set_gsettings
  ;;

  restart|reload|force-reload)
    /etc/init.d/IT-gsettings start
  ;;

  stop)
   :
  ;;

  *)
    log_success_msg "Usage: /etc/init.d/IT-gsettings {start|stop|restart|reload|force-reload}"
    exit 1
    ;;
esac

exit 0 
```

简而言之，如何在启动时设置 gsettings？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T20:44:56.343

当仍然没有可用的会话时，脚本可能会运行。

鉴于它是一张 live CD 并且您可以控制它，您可能想要更改架构中的默认值。对于 vino，您应该更改`/usr/share/glib-2.0/schemas/org.gnome.Vino.gschema.xml`.

# c++ - C++ 应用程序中的非永久性大量外部数据存储

> ID：11787808
> 
> 赞同：1
> 
> 时间：2012-08-03T00:45:28.157
> 
> 标签：c++, data-structures, shared-libraries

我正在重写一个处理大量数据（大约 100 GB）的应用程序，该应用程序被设计为关系模型。

应用非常复杂；它是某种转换工具，用于开放海量（全球）街道地图数据，并将其转换为我们自己的路线规划软件的地图文件。例如，转换器应用程序保存开放街道地图中的节点及其坐标及其所有标签（远不止这些，但这应该作为这个问题的一个例子）。

**现在的情况：**

因为这个数据非常庞大，所以我把它拆分成几个文件：每个文件都是从一个ID到一个原子值的映射（假设一个节点的标签列表是一个原子值；它不是但数据存储可以照此处理）。因此，对于节点，我有一个保存节点坐标的文件，一个保存节点名称，一个保存节点标签，其中节点由（非连续）ID 标识。

该应用程序曾经被拆分为多个应用程序。每个应用程序处理一个转换步骤。因此，这样的应用程序只需要处理存储在文件中的部分数据。例如，并非所有应用程序都需要节点的标签，但其中很多都需要节点的坐标。这就是我将关系拆分为文件的原因，每个“列”一个文件。

每个处理步骤可以一次将整个文件读入 RAM 中的数据结构。这确保了查找可以非常有效（如果数据结构是哈希映射）。

我目前正在重写转换器。它现在应该是一个单一的应用程序。它现在不应该为每个“列”使用单独的文件。它应该使用一些众所周知的架构以***关系方式保存外部数据***，例如数据库，但速度要快得多。

=>***哪个库可以提供以下功能？***

**要求：**

*   它需要非常快速地**迭代**现有数据（同时不修改行集，而是修改当前行中的一些值）。

*   它需要提供恒定或接近恒定的查找，类似于哈希映射（同时根本不修改整个关系）。

*   大多数类型的列都是固定大小的，但通常不是。

*   它需要能够以每行的常数或对数时间将新行附加到关系中。不需要实时更新某种搜索索引。更新（重建）索引可以在整个处理步骤完成后进行。

*   一些关系是基于键值的，而另一些关系是（连续索引的）数组。它们都应该提供快速查找。

*   它不应该是一个单独的进程，就像 MySQL 这样的 DBMS。查询的数量将是巨大的（大约 100 亿），并且将完全成为性能的瓶颈。但是，缓存查询将是一种可能的解决方法：迭代整个表可以在单个查询中完成，而写入表（在同一处理步骤中不会从该表读取数据）可以在批处理查询中发生。但仍然：我猜想序列化、进程间传输和反序列化 SQL 查询将成为瓶颈。

*   锦上添花：易于使用。如果可以以与 C++ 标准和 Qt 容器类类似的方式使用关系，那就太好了。

**非要求** *（为什么我不需要 DBMS）*：

*   从/到相同的关系同步写入和读取。应用程序分为多个处理步骤；每个步骤都有一组它读取的“输入关系”和它写入的“输出关系”。但是，某些步骤需要读取关系的某些列，同时写入同一关系的其他列。

*   加盟关系。不同关系之间有一些交叉引用，但是，如果查找速度足够快，它们可以在我的应用程序中解决。

*   持久存储。转换完成后，将不再需要所有数据。

*   基于键值的关系永远不会被重新键入；基于数组的关系永远不会被重新索引。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:57:52.643

根据您在问题中未量化的许多因素，我可以想到几种可能的解决方案。

如果您想要一个简单的存储来查找内容并且您有足够的磁盘，那么[SQLite](http://sqlite.org "SQLite")作为数据库非常有效。请注意，没有 SQLite 服务器，“服务器”链接到您的应用程序。

就个人而言，这份工作[有点尴尬地平行](http://en.wikipedia.org/wiki/Embarrassingly_parallel)。我认为一个小型[Hadoop 集群](http://hadoop.apache.org/)可以快速完成整个工作。您可以在[AWS](http://aws.amazon.com "亚马逊网络服务")中启动它，处理您的数据，然后以相当便宜的方式关闭它。

# c - strlen 性能实现

> ID：11787810
> 
> 赞同：9
> 
> 时间：2012-08-03T00:45:32.733
> 
> 标签：c, string, performance, strlen

这是一个多用途的问题：

*   这与[glibc strlen](http://www.stdlib.net/%7Ecolmmacc/strlen.c.html)实现相比如何？
*   一般来说，有没有更好的方法来解决这个问题和自动矢量化。

```
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <limits.h>
#include <stdbool.h>
#include <stdlib.h>

/* Todo: Document */
#define WORD_ONES_LOW   ((size_t)-1 / UCHAR_MAX)
#define WORD_ONES_HIGH  (((size_t)-1 / UCHAR_MAX) << (CHAR_BIT - 1))

/*@doc
 * @desc: see if an arch word has a zero
 * #param: w - string aligned to word size
 */
static inline bool word_has_zero(const size_t *w)
{
    return ((*w - WORD_ONES_LOW) & ~*w & WORD_ONES_HIGH);
}

/*@doc
 * @desc: see POSIX strlen()
 * @param: s - string
 */
size_t strlen(const char *s)
{
    const char *z = s;

    /* Align to word size */
    for (; ((uintptr_t)s & (sizeof(size_t) - 1)) && *s != '\0'; s++);

    if (*s != '\0') {
        const size_t *w;

        for (w = (const size_t *)s; !word_has_zero(w); w++);
        for (s = (const char *)w; *s != '\0'; s++);
    }

    return (s - z);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T00:52:14.923

好吧，此实现基于与您链接的 glibc 实现几乎相同的技巧（[确定一个单词是否具有零字节）。](http://graphics.stanford.edu/~seander/bithacks.html#ZeroInWord)他们做的事情几乎相同，除了在 glibc 版本中，一些循环被展开并且位掩码被明确地拼写出来。您发布的代码中的 and 完全是glibc`ONES`版本。`HIGHS``himagic = 0x80808080L``lomagic = 0x01010101L`

我看到的唯一区别是 glibs 版本使用稍微不同的标准来检测零字节

```
if ((longword - lomagic) & himagic) 
```

不做`... & ~longword`（与`HASZERO(x)`您的示例中的宏相比，它与 做同样的事情`x`，但也包括`~(x)`成员）。显然 glibc 作者认为这个更短的公式更有效。然而，它可能导致误报。因此，他们检查了该之下的误报`if`。

这确实是一个有趣的问题，什么更有效：单阶段精确测试（您的代码）或从粗略的不精确检查开始的两阶段测试，如果需要，然后进行精确的第二次检查（glibc 代码）。

如果您想查看它们在实际性能方面的比较 - 在​​您的平台和数据上计时。没有别的办法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T02:05:33.560

另外，请注意此实现可以在此处读取 char 数组的末尾：

```
for (w = (const void *)s; !HASZERO(*w); w++); 
```

因此依赖于未定义的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T01:21:25.437

为了回答您的第二个问题，我认为基于字节的天真`strlen`实现将导致编译器更好地自动矢量化，如果它很智能并且已启用对矢量指令集扩展（例如 SSE）的支持（例如使用`-msse`或适当的`-march`）。不幸的是，即使编译器*可以*像问题中引用的 C 代码那样生成 32 位或 64 位伪向量化代码，如果它足够聪明的话，它也不会导致任何具有基线 cpus 缺乏这些功能的向量化。 .

# openssl - 将 OpenSSL 密钥转换为 CryptoAPI

> ID：11787811
> 
> 赞同：1
> 
> 时间：2012-08-03T00:45:33.703
> 
> 标签：openssl, rsa, cryptoapi

我花了很多时间在谷歌上寻找这个问题的答案。我发现了几段描述解决方案的代码，但大多数都是用 C、.NET 或 Java 编写的。我的情况是VB6。

我有一个非常简单的 RSA1 应用程序：签署一些数据（在“appA”中使用私钥），然后验证签名（在“appB”中使用公钥，这是 VB6 应用程序）。现在一切都通过 CryptoAPI 库运行良好。

“appA”签名部分需要移动到 unix 服务器并由 OpenSSL 执行（最好）。问题是将密钥格式从 PEM 转换为 CryptoAPI 期望的 PublicKeyBlob。

我试图[将此 C 代码](https://stackoverflow.com/questions/1231178/load-an-x509-pem-file-into-windows-cryptoapi)移植到 VB。CryptStringToBinary 成功但 CryptDecodeObjectEx 只是挂起然后崩溃 VB。

我还没有找到任何在 VB 中显示这种用法的文档。我不确定这是否可能。我希望有人能够对此有所了解。我还尝试了 CryptDecodeObject (sans "Ex") 函数，希望缺少所有需要的结构可以解决问题......但同样的问题。

我的测试密钥是由 OpenSSL 使用 openssl_pkey_new 生成的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T03:31:31.503

我唯一能想到的就是检查以确保您的声明是正确的，并调试/打印出您传递的参数并验证它们是否正确。

```
Declare Function CryptDecodeObject lib "crypt32" (ByVal dwCertEncodingType As Long, ByVal lpszStructType As String, ByVal pbEncoded As String, ByVal cbEncoded As Long, ByVal dwFlags As Long, pvStructInfo As Any, ByRef pcbStructInfo As Long) As Long`

Declare Function CryptDecodeObjectEx lib "crypt32" (ByVal dwCertEncodingType As Long, ByVal lpszStructType As String, ByVal pbEncoded As String, ByVal cbEncoded As Long, ByVal dwFlags As Long, ByRef pDecodePara As PCRYPT_DECODE_PARA, pvStructInfo As Any, ByRef pcbStructInfo As Long) As Long 
```

总有办法或者变通办法，vb6验证后还在咳血，写个c++ stub dll确实能用，从vb6调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T16:29:29.910

好吧，我发现我的一个结构有问题（没有将字节数组成员声明为数组）并且我不再遇到崩溃问题。但是，我仍然没有使用 CryptDecodeObject 取得任何成功。下面的代码是我正在使用的。GetLastErr 只返回 0（帮助不大）。如果有人对我可能出错的地方有想法，请告诉我！

```
Dim iFile As Integer
Dim sPEM As String, sDER As String
Dim lenPEM As Long, lenDER As Long
Dim publicKeyInfo As CERT_PUBLIC_KEY_INFO
Dim publicKeyInfoLen As Long

iFile = FreeFile
Open app.Path & "\publickey.txt" For Binary As iFile
sPEM = Space(LOF(iFile))
Get #iFile, , sPEM
Close iFile

lenPEM = Len(sPEM)

' Determine buffer length required for the DER string
CryptStringToBinary sPEM, lenPEM, CRYPT_STRING_BASE64HEADER, 0, lenDER, 0, 0
sDER = Space(lenDER)

' Do conversion to binary
If Not CryptStringToBinary(sPEM, lenPEM, CRYPT_STRING_BASE64HEADER, sDER, lenDER, 0, 0) Then
    Debug.Print sDER
Else
    MsgBox "CryptStringToBinary Error " & GetLastError
    Exit Sub
End If

' Do conversion to blob
If Not CryptDecodeObject(X509_ASN_ENCODING, X509_PUBLIC_KEY_INFO, sDER, lenDER, 0, publicKeyInfo, publicKeyInfoLen) Then
    MsgBox "CryptDecodeObject Error: " & GetLastError
    Exit Sub
End If 
```

如果有人认为这会有所帮助，我可以发布所有函数和类型声明，我相信它们是正确的。

这是 OpenSSL 生成的公钥：

-----开始公钥----- MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBANWhFRxt/ZF56uGO7GsbvevmX42//thm JdseUwQNot/ihXCPRadf0SPYbtHS6/JA92pCX7NxfgYNoYlOFb0IYYcCAwEAAQ== -----结束公钥-----

# java - Java 接口和类型

> ID：11787812
> 
> 赞同：1
> 
> 时间：2012-08-03T00:45:34.430
> 
> 标签：java

假设您有一些 Java 代码，如下所示：

```
 public class Base{
    public void m(int x){
    // code
    }
 } 
```

然后是一个子类 Derived，它扩展 Base 如下：

```
 public class Derived extends Base{
    public void m(int x){ //this is overriding
      // code
    }

    public void m(double x){ //this is overloading
      // code
    }
 } 
```

然后你有一些声明如下：

```
Base b = new Base();
Base d = new Derived();
Derived e = new Derived();

b.m(5); //works
d.m(6); //works
d.m(7.0); //does not compile
e.m(8.0); //works 
```

对于无法编译的那个，我知道您正在将一个 double 传递给 Base 的 m 方法版本，但我不明白的是......拥有像“Base b = new”这样的声明有什么意义衍生的（）;” ?

这似乎是解决各种类型转换问题的好方法，如果你想使用 Derived 对象，为什么不直接使用像“e”这样的声明呢？

另外，我对Java中使用的“类型”一词的含义有些困惑。今年夏天早些时候我学到的方法是，**每个对象都有一个类**，它对应于实例化对象时“new”后面的类的名称，但是**一个对象可以有任意多的类型**。例如，“e”的类型为 Base、Derived（和 Object ;)），但它的类是 Derived。这个对吗？

此外，如果 Derived 实现了一个名为 CanDoMath 的接口（同时仍在扩展 Base），那么说它具有“CanDoMath”类型以及 Base、Derived 和 Object 是否正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T00:58:11.590

我经常以以下形式编写函数：

```
public Collection<MyObject> foo()  {}  

public void bar(Collection<MyObject> stuff){} 
```

在这两种情况下我都可以很容易地做到这一点`ArrayList`，但是如果我后来决定将表示设为 a 会发生什么`Set`？答案是自从我更改了方法合同以来，我有很多重构工作要做​​。但是，如果我离开它，`Collection`我可以随意无缝地从`ArrayList`到`HashSet`。使用`ArrayList`它的例子有以下类型：

```
 Serializable, Cloneable, Iterable<E>, Collection<E>, List<E>, RandomAccess 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-03T01:00:56.340

在许多情况下，不希望将自己限制在特定的（子）类中，例如您有 where 的情况`e.m(8.0);`。例如，假设您有一个调用的方法`move`在程序的坐标图中移动一个对象。但是，在您编写该方法时，您可能同时拥有由不同类处理的笛卡尔图和径向图。

如果你依赖于知道子类是什么，你就会强迫自己进入一个更高级别的代码必须知道更低级别的代码的位置，而实际上他们只是想依赖于存在具有特定签名的特定方法这一事实. 有很多很好的例子：

*   希望将查询应用于数据库，同时不知道如何建立连接。
*   想要对用户进行身份验证，而不必提前知道正在使用的策略。
*   想要加密信息，而不需要在更好的加密技术出现时撕掉一堆代码。

在这些情况下，您只想确保对象具有特定类型，从而保证特定方法签名可用。这样，您的示例就是人为的；您在问为什么不只使用具有双精度作为签名参数的方法的类，而不是不可用的类。（简单地说，你不能使用没有可用方法的类。）

还有另一个原因。考虑：

```
class Base {
   public void Blah() {
     //code
   }
}

class Extended extends Base {
   private int SuperSensitiveVariable;

   public setSuperSensistiveVariable(int value) {
     this.SuperSensistiveVariable = value;
   }

   public void Blah() {
     //code
   }
}

//elsewhere
Base b = new Extended();
Extended e = new Extended(); 
```

请注意，在这种`b`情况下，我无权访问该方法`set()`，因此无法意外弄乱超敏感变量。我只能在这种`e`情况下这样做。这有助于确保这些事情只在正确的地方完成。

您对类型的定义很好，您对特定对象的类型的理解也很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T01:19:40.457

> 拥有的意义`Base b = new Derived();`何在？

这一点是使用多态性来改变你的实现。例如，有人可能会这样做：

```
List<String> strings = new LinkedList<String>(); 
```

如果他们进行一些分析并发现此列表上最常见的操作对于列表类型效率低下，他们可以将其换成 ArrayList。通过这种方式，您可以获得灵活性。

> 如果你想使用 Derived 对象

如果您需要派生对象上的方法，那么您将使用派生对象。看看 BufferedInputStream 类——你使用它不是因为它的内部实现，而是因为它包装了一个 InputStream 并提供了方便的方法。

> 另外，我对Java中使用的“类型”一词的含义有些困惑。

听起来您的老师将接口和类称为“类型”。这是一个合理的抽象，作为实现接口并扩展类的类可以通过3种方式引用，即

```
public class Foo extends AbstractFoo implements Comparable<Foo>

// Usage
Comparable<Foo> comparable = new Foo();
AbstractFoo abstractFoo = new Foo();
Foo foo = new Foo(); 
```

在不同上下文中使用的类型示例：

```
new ArrayList<Comparable>().Add(new Foo()); // Foo can be in a collection of Comparable
new ArrayList<AbstractFoo>().Add(new Foo()); // Also in an AbstractFoo collection 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-03T00:49:09.570

这是面向对象设计的经典问题之一。当这种情况发生时，通常意味着设计可以改进；对于这些问题，几乎总有一些优雅的解决方案......

例如，你为什么不把`m`需要加倍的东西拉到基类中呢？

关于你的第二个问题，一个对象可以有多个类型，因为接口也是类型，类可以实现多个接口。

# mysql - 在mysql中选择具有唯一字段值的行

> ID：11787814
> 
> 赞同：0
> 
> 时间：2012-08-03T00:45:54.113
> 
> 标签：mysql

我有这些表的列`comments`：

```
id
content
add_date
uid
school_id 
```

行可以具有相同的 school_id。

我想根据add_date选择最新的数据，但**每个school_id只有1行**（不重复`school_id`），限制为10。

我已经尝试了很多代码，但它对我不起作用。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:54:39.117

这就是我们所说`Greatest N per Group`的。您可以通过放入子查询来实现这一点，这样它就可以与非分组表 ( `comments`) 连接起来。尝试这个：

```
SELECT  c.*
FROM
        (
            SELECT school_id, MAX(add_date) maxDate
            FROM comments
            GROUP BY school_id
        ) x INNER JOIN comments c
            ON  x.school_id = c.school_ID AND
                x.maxDate = c.add_date
ORDER BY x.maxDate desc
LIMIT 10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:57:32.427

```
select c1.*
  from comments c1
 where add_date = (select max(add_date) from comments c2 where c2.school_id =c1.school_id)
 order by add_date desc
 limit 10 
```

在评论（add_date）和评论（school_id，add_date）上创建索引

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T00:53:00.153

```
select C.ID, C.Content, t1.MaxDate as [add_date], C.uid, t1.school_id
from (selet school_id, max(add_Date) as 'MaxDate'
from comments
group by school_id) T1
inner join comments C on T1.school_id = C.school_id and C.add_Date= T1.MaxDate
LIMIT 10 
```

如果要选择`rows`返回哪 10 个，添加一个`order by`, 或一个`Where`子句

# xml - ODT 和 OpenOffice.org：使用 text:class-names 属性将格式应用于 text:span 下的文本？

> ID：11787816
> 
> 赞同：1
> 
> 时间：2012-08-03T00:46:13.093
> 
> 标签：xml, formatting, openoffice.org, odt

我正在尝试对文本应用一些简单的格式，但它不起作用。下面的示例通过了一个 RNG 验证器。我正在使用 Apache OpenOffice3.4 和 ODT1.2 平面文档。

[ODT 规范说](http://docs.oasis-open.org/office/v1.2/OpenDocument-v1.2.pdf)一个`<text:span>`元素可以有一个 text:class-names 属性；并且该属性指定以空格分隔的文本样式名称列表。

它看起来对我来说......这样做的正确方法是什么？

```
<?xml version="1.0" encoding="UTF-8"?>
<office:document xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" office:version="1.2" office:mimetype="application/vnd.oasis.opendocument.text">
    <office:styles>
        <style:style style:family="text" style:name="BOLD">
            <style:text-properties fo:font-weight="bold"/>
        </style:style>
    </office:styles>
    <office:body>
        <office:text>
            <text:p>Plain text here; <text:span text:class-names="BOLD">this is supposed to be bold text;</text:span></text:p>
        </office:text>
    </office:body>
</office:document> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T04:51:33.320

这是一个 OOo/Libre 错误[，这是与该问题相关的链接。](http://lists.freedesktop.org/archives/libreoffice/2011-November/021279.html)不在bugzilla中？

最初我尝试使用嵌套`<text:span>`元素，但是参考上面的链接，我的样式定义在`<office:styles>`而不是`<office:automatic-styles>`.

# c# - WebSocket 服务器的现代解决方案？

> ID：11787823
> 
> 赞同：5
> 
> 时间：2012-08-03T00:46:55.890
> 
> 标签：c#, php, hosting, websocket, web-hosting

对于我的网站，我用 C#（最喜欢的编码语言）编写了一个使用[Fleck](https://github.com/statianzo/Fleck/tree/fc037f49362bb41a2bc753a5ff51cc9da40ad824)的 WebSockets 服务器，它大约有 600 行代码。一切似乎都运行良好（虽然有时有点不稳定。不确定这是我的代码还是 Fleck 的问题）。

但是，我想将它从我的计算机移动到一个实际的域，我不确定是否有任何托管服务提供商可以支持这样的 .NET 控制台应用程序。

我在想也许我必须用另一种语言（如 PHP）重写它，但我对整个想法有点不确定。是否有任何流行的托管服务提供商可以支持我正在寻找的内容？即使他们是，这是个好主意吗？我想它可能不如使用 Perl、PHP 或 Python 作为服务器的典型解决方案安全或慢。（很多P）

最后，如果重写是个好主意，我不确定我会用哪种语言编写它。已经有一段时间了，我不确定每个人还在使用什么。PHP 是否仍然被认为是 Web 服务器最受支持和最安全的？

哪种 WebSockets 实现最适合？我花了一段时间才找到 Fleck，而且 PHP 衍生产品的数量似乎是原来的两倍，我再次感到有点不知所措。此外，Stackoverflow 上很多关于 WebSocket 的帖子都是两年前没有得到支持的。

对不起，我的问题很天真，缺乏重点，但正如你所见，我对我在这里的行动方案应该是什么感到有点困惑，我正在寻找一些见解。谢谢阅读。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T17:39:31.590

可能最流行的 WebSocket 服务器是[Socket.IO](http://socket.io)。它是在[Node](http://nodejs.org) (Javascript) 中实现的，当 WebSockets 支持不可用时，它会回退到长轮询/AJAX。

WebSockets 最受支持的实现是 python [pywebsocket](http://code.google.com/p/pywebsocket/)项目，Mozilla 和 Google 都使用它来开发和测试他们的客户端浏览器实现。此外，pywebsocket 旨在轻松与 Apache 集成，允许您在同一端口上运行 Web 服务器和 websocket 服务。

如果您的应用程序只需要基于 WebSocket 的消息传递服务并且主要是点对点的，那么您可以考虑使用像[Pusher](http://pusher.com/)这样的商业 WebSocket 服务。这可以使您不必为此托管和管理自己的服务器。

我不建议将 PHP 用于 WebSocket 服务器。直到最近，还没有一个 PHP 实现同时支持旧的和新的 WebSocket 协议变体。当前的 iOS 设备仍在使用旧版本的协议，Chrome、Firefox、IE10 和基于 Flash 的 WebSocket polyfill [web-socket-js](https://github.com/gimite/web-socket-js)使用较新的 IETF 6455 版本的协议。

此外，您问 PHP 是否仍被认为是 Web 服务器最受支持和最安全的。当然，PHP 一直都有很好的文档和示例以及非常广泛的部署，因此您可以说它得到了很好的支持。然而，PHP 在安全性方面落在列表的底部附近。我当然不会用 PHP 从头开始​​重写您的应用程序。

如果您偏爱 C 类语言，您可以考虑使用[libwebsockets](http://git.warmcat.com/cgi-bin/cgit/libwebsockets/)来构建 C 或 C++ WebSocket 服务器。Andy Green 开发和维护 libwebsockets，并参与了制定标准的 IETF 工作组。

Ruby 是另一种语言/社区，它已经看到了大量的 WebSockets（可能仅次于 Node）。Ruby 最流行的 websocket 库是[em-weboskcet](https://github.com/igrigorik/em-websocket)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-03T00:51:14.750

你可以试试 node.js，它是“新的”，看起来不错。问候

# c# - 使用 c# 更改 win 7 注册表

> ID：11787827
> 
> 赞同：0
> 
> 时间：2012-08-03T00:47:21.727
> 
> 标签：c#, windows-7, registry

应该就是这么简单。这段代码看起来不错。它不会崩溃。那么为什么它不按它说的去做呢？我不能像这样更改注册表中的任何内容，但所有谷歌搜索都说这是应该的。任何帮助是极大的赞赏。

```
 private void button2_Click(object sender, EventArgs e)
    {
        RegistryKey myKey = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\",true);
        myKey.SetValue("AutoAdminLogon", "1");   

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:21:12.827

您可能正在处理 Win7 的“影子注册表”问题，其中某些注册表更改不是对“实际”注册表进行的，而是在恶意访问时保护原始注册表的“影子”副本。注册表更改被重定向到注册表的用户特定区域，但呈现为好像它们在 HKLM 中一样（如您的示例中所示）。

我相信，注册表虚拟化是在 Vista 中引入的，但至少可以很好地解释您的问题。

[http://msdn.microsoft.com/en-us/library/bb530198.aspx](http://msdn.microsoft.com/en-us/library/bb530198.aspx) 如果不​​这样做，您可能正在对注册表的 Wow64 节点进行更改。检查您在 HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Winlogon 下的更改，并查看您的更改是否正在那里进行。在 64 位版本的 Windows 上，32 位代码在 WOW 子系统下运行，来自此类应用程序的注册表调用被路由到注册表中的 Wow6432 节点 - 所有调用 32 位应用程序都不知道。

# ios - Ipad 照片选择器

> ID：11787828
> 
> 赞同：1
> 
> 时间：2012-08-03T00:47:30.143
> 
> 标签：ios, xcode, ipad

我正在尝试让 IPAD 从相册中选择一张照片

```
 pickerController = [ [ UIImagePickerController alloc ] init ] ;
            pickerController.delegate   = self ;
            pickerController.editing    = NO ;
            pickerController.sourceType = UIImagePickerControllerSourceTypeSavedPhotosAlbum;

            [ self presentViewController : pickerController animated : YES completion : nil ] ; 
```

当我在 iPad 上使用时，该应用程序不断崩溃，但在 iPhone 上运行良好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-03T00:58:33.767

这个以前也有过我。在 iPad 上，如果您指定源类型`UIImagePickerControllerSourceTypePhotoLibrary`或者`UIImagePickerControllerSourceTypeSavedPhotoAlbum`您需要使用弹出框控制器呈现图像选择器控制器。如果你尝试以模态方式呈现它，就像你正在做的那样，你会得到一个例外。

不是 100% 需要，但使用测试查看可用的源类型也是一个好主意。

```
[UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary] 
```

源类型有：

*   `UIImagePickerControllerSourceTypePhotoLibrary`
*   `UIImagePickerControllerSourceTypeSavedPhotosAlbum`
*   `UIImagePickerControllerSourceTypeCamera`

这就是我解决这个问题以测试它是否是 iPad 的方法。

```
if( UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad){

    UIPopoverController* popOverController = [[UIPopoverController alloc] initWithContentViewController:imagePickerController];
    [popOverController presentPopoverFromRect:selectVideoToViewButton.bounds inView:self.view permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];

}else {
    [self presentModalViewController:self.imagePickerController animated:YES];
} 
```

# c# - 在对象初始化器中重用属性值

> ID：11787832
> 
> 赞同：1
> 
> 时间：2012-08-03T00:48:11.937
> 
> 标签：c#

首先对我的问题的有趣标题感到抱歉，希望暴露我的问题的代码示例能够澄清事情。

您将在下面找到一个无法编译的代码示例（我完全明白为什么，无需解释），但它揭示了我想要实现的目标：

```
public class Cmd
{
    public Byte MyByte { get; set; }
    public Byte MyOtherByte { get; set; }
    public String MyString { get; set; }

    public static Cmd FromStream(Stream stream)
    {
        return new Cmd
        {
            MyByte = (Byte)stream.ReadByte(),
            MyOtherByte = (Byte)stream.ReadByte(),
            MyString = SomeMethodBasedOnMyOtherByte(MyOtherByte) // Here
        };
    }
} 
```

我希望你能明白。当然，如果流是可查找的，我可以只查找一个字节并重新读取它以将其作为我正在调用的方法的参数传递。但是，如果流是不可搜索的，那就没办法了。

当然，这是一个非常基本的示例，在我的真实场景中，我想实现 FromStream 的类具有许多不同的属性。

是否有任何关键字可以做我想做的事情，基本上是在对象初始化块中重用受影响的属性值？

如果不是，我想对我来说唯一的方法是不在这种情况下使用对象初始化程序，而是构造一个一个一个影响它的属性的新对象（以便我可以在需要时重用受影响的属性）。在对象初始化器中为这个特定场景使用（或重用）关键字不是很好吗？如果不是，为什么？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:50:39.043

我认为拥有一个临时变量将使您的代码更加清晰。

```
 Byte myByte = (Byte)stream.ReadByte();
    return new Cmd
    {
        MyByte = myByte,
        MyString = SomeMethodBasedOnMyFirstByte(myByte)
    }; 
```

或者，您可以将 a`Byte`作为（私有）构造函数。

# playframework - playframework - 如何自动增加进化

> ID：11787833
> 
> 赞同：1
> 
> 时间：2012-08-03T00:48:15.597
> 
> 标签：playframework, playframework-2.0

所以我正在使用 playframework 2.0 并且我的应用程序已准备好发布。正如我一直在开发的那样，我注意到： conf\evolutions\default\1.sql 每次添加/修改模型层时都会自动更改。当我即将发布我的应用程序时，我想知道如何设置它以开始将其添加到 2.sql 而不是 1？我想标记/分支修订，以便将来如果我需要升级我的版本，系统会注意到它安装了 1.sql，因此它只需要运行 2.sql。

我目前正在使用 JDBC 数据库，并注意到在开发过程中，如果我进行任何更改，它将更新 1.sql，然后下次运行应用程序时，它会将我的所有数据清除干净。

那么我怎样才能让它进化1完成呢？

我目前有配置选项：applyEvolutions.default=true

这是发布的坏主意吗？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T07:48:51.847

## 这绝对是个坏主意

Ebean 不会创建 ALTER，而是创建 DDL 的版本，因此如果您修改任何模型并将其发送到生产环境，它将**删除**所有表并重新创建它们。当然，所有数据都会丢失。

因此，您需要从 中删除前两行`1.sql`以禁用 Ebean 修改文件。

从现在开始，您需要`2.sql`手动创建类似和下一个文件。在这些新文件中，您只需添加修改语句。

# php - 使用php获取xml主元素的属性

> ID：11787842
> 
> 赞同：0
> 
> 时间：2012-08-03T00:49:31.097
> 
> 标签：php, xml, simplexml

这是代码

费率.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<main>
     <unittype id="24944">
          <date value="2020-10-10">
               <baserate>45.50</baserate>
               <closed>0</closed>
               <unitsavailable>2</unitsavailable>
          </date>
     </unittype>
     <unittype id="24944">
          <date value="2020-10-11" value2="2020-10-13">
               <baserate>99</baserate>
               <minimumstay>2</minimumstay>
               <unitsavailable>9</unitsavailable>
          </date>
          <date from="2020-10-15" to="2020-10-20">
                <closed>1</closed>
          </date>
     </unittype>
     <unittype id="24946">
          <date value="2020-10-10">
               <unitsavailable>0</unitsavailable>
               <closed>1</closed>
          </date>
     </unittype>
</main> 
```

这是 index.php

```
<?php
$xml = simplexml_load_file("xml_files/rates.xml");
//$xml = new SimpleXMLElement($xml);
$room_id = 24944;
$date = "2020101";
$hotel = $xml -> xpath('/main/unittype[@id = "'.$room_id.'"]/date[number(translate(@value,\'-\',\'\')) >"' .$date.'" ]');
var_dump($hotel);

foreach($hotel as $room) {
    //var_dump($room);
    echo "<br /><br />";
    echo "The room with the ID: {$room->unittype} <br />";
    echo "Date: {$room[0]->attributes()['value']}<br />";
    echo "Room Price: {$room->baserate}<br />
    Room min stay: {$room->unitsavailable}<br />";
}
?> 
```

现在我正在尝试使用所选房间获取单元类型中的 ID，如 $room->unittype 但当然它不起作用所以有人知道如何解决这个问题吗？

var_dump($hotel) 的输出是

```
array (size=2)
  0 => 
    object(SimpleXMLElement)[2]
      public '@attributes' => 
        array (size=1)
          'value' => string '2020-10-10' (length=10)
      public 'baserate' => string '45.50' (length=5)
      public 'closed' => string '0' (length=1)
      public 'unitsavailable' => string '2' (length=1)
  1 => 
    object(SimpleXMLElement)[3]
      public '@attributes' => 
        array (size=2)
          'value' => string '2020-10-11' (length=10)
          'value2' => string '2020-10-13' (length=10)
      public 'baserate' => string '99' (length=2)
      public 'minimumstay' => string '2' (length=1)
      public 'unitsavailable' => string '9' (length=1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:56:48.973

```
$room->unittype->attributes()->id; 
```

[参考](http://www.electrictoolbox.com/php-simplexml-element-attributes/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T01:27:39.143

我明白了，伙计们。非常感谢，对不起，如果我打扰了任何人，这是解决方案以防万一其他人需要它

```
<?php
$xml = simplexml_load_file("xml_files/rates.xml");
//$xml = new SimpleXMLElement($xml);
$room_id = 24944;
$date = "2020101";
$hotel = $xml -> xpath('/main/unittype[@id = "'.$room_id.'"]/date[number(translate(@value,\'-\',\'\')) >"' .$date.'" ]');
var_dump($hotel);

foreach($hotel as $room) {
    //var_dump($room);
    echo "<br /><br />";
    $node_name = $room->getName();
    //echo $node_name."<br/><br/>";
    $parent = $room->xpath("parent::*");
    //print_r($parent);
    echo "The room with the ID: {$parent[0]->attributes()['id']} <br />";
    echo "Date: {$room[0]->attributes()['value']}<br />";
    echo "Room Price: {$room->baserate}<br />
    Room min stay: {$room->unitsavailable}<br />";
}
?> 
```

# sql - 操作数数据类型时间对于 avg 运算符无效...？

> ID：11787845
> 
> 赞同：10
> 
> 时间：2012-08-03T00:50:17.010
> 
> 标签：sql, sql-server

如何在以下查询中进行 avg(time(4)) ：

```
 select top 10 avg(e.Duration) from TimeTable e 
```

我收到以下错误：

> 操作数数据类型 time 对 avg 运算符无效。

持续时间是类型 time(4) 例如：

```
Duration
-------------
00:00:10.0000 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-03T01:42:56.583

您可以使用`DateDiff( ms, '00:00:00', e.Duration )`将时间转换为整数毫秒数。将其用于您的聚合，然后将结果转换回来，例如`Cast( DateAdd( ms, 1234, '00:00:00' ) as Time )`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-30T14:39:43.753

改进HABO答案：

```
select top 10
Cast(DateAdd( ms,avg(DateDiff( ms, '00:00:00', e.Duration)), '00:00:00' )  as time) as 'avg duration' 
from TimeTable e 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-02T20:24:05.753

除了 HABO 和 Rafi 的答案。

对于我的情况，我不得不将 DATEDIFF 的值转换为 bigint，因为我的值变得太大并导致算术溢出错误。

```
CAST(DATEADD( ms,AVG(CAST(DATEDIFF( ms, '00:00:00', ISNULL(e.Duration, '00:00:00')) as bigint)), '00:00:00' )  as TIME) as 'avg_time' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-03T00:57:36.243

好吧，这似乎`time`是该方法的无效类型`avg()`。请参阅[此处](http://msdn.microsoft.com/en-us/library/ms177677.aspx)以获取有效数据类型的列表。

此外，您似乎需要一组值，这将否定`top 10`您当前查询的需要。

# c# - 从 javaScript 执行服务器端代码

> ID：11787849
> 
> 赞同：5
> 
> 时间：2012-08-03T00:50:46.397
> 
> 标签：c#, javascript, asp.net

不确定这是否可能，但这是我的场景：

在我们的大约 10 个 aspx 文件中，我们有相同的 javaScript 函数，我想从所有这些页面中删除它，并将其放在对所有页面都是全局的主 javaScript 文件 (main.js) 中，因此更容易维护。当前 aspx 页面中的 javaScript 代码如下所示：

```
var regEx_gaid = <%= regEx["regEx_gaid"] %>; 
var regEx_wCard = <%= regEx["regEx_wildCard"] %>; 
var regEx_fCss = <%= regEx["regEx_flattenCss"] %>; 
var regEx_iCss = <%= regEx["regEx_inlineCss"] %>;
...

function doSomething() {
   // do something with those variables declared above.
} 
```

不确定如何在 main.js 中获取这些变量的服务器端值。

这也可能是相关的：

里面的“regEx”`<%= regEx["regEx_gaid"] %>`是服务器端的字典集合，“regEx_gain”是访问regEx字典值的关键。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T00:56:13.110

在您的页面中，您可以使用[RegisterStartupScript](http://msdn.microsoft.com/en-us/library/z9h4dk8y.aspx)在每个页面中动态创建这些 javascript 变量：

```
this.ClientScript.RegisterStartupScript(this.GetType(), "MainVars", "var regEx_gaid = '" + regex_gaid.ClientID + "';", true); 
```

我们广泛使用这种机制：在代码隐藏中注册控制变量（它们被发送到每个页面），然后在中央脚本中使用它们（类似于您的 main.js）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T01:08:13.287

您可以有一个单独的 ASP 页面，它只输出变量的内容。然后，您可以从 javascript 向该页面发出 AJAX 请求。

使用 JQuery 进行速记：

```
var regEx_gaid = "";

$.get('regex_gaid.aspx', function(data) {
  regEx_gaid = data;
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T01:58:50.550

您可以添加一个`main.js.aspx`然后将脚本移动`main.js`到中`main.js.aspx`，并将 main.js.aspx 用作 javascript 文件吗？

main.js.aspx：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="main.aspx.cs" Inherits="TempProject.js.main" %>
var regEx_gaid = <%= regEx["regEx_gaid"] %>; 
var regEx_wCard = <%= regEx["regEx_wildCard"] %>; 
var regEx_fCss = <%= regEx["regEx_flattenCss"] %>; 
var regEx_iCss = <%= regEx["regEx_inlineCss"] %>; 
```

代码隐藏：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        Response.ContentType = "application/javascript";
    } 
```

其他文件：

```
<script type="text/javascript" src="js/main.js.aspx"></script> 
```

# r - ubuntu 上的 OpenCPU 出现 403 错误

> ID：11787856
> 
> 赞同：1
> 
> 时间：2012-08-03T00:51:35.827
> 
> 标签：r, opencpu

Firefox 在 /R/call/base/identity/json 找不到该文件。我正在运行 openCPU 我可以去

127.0.0.1

它转到 127.0.0.1/pages/

然后我转到示例 API 并尝试运行示例代码的按钮，它告诉我您无权访问 /r/pub/ggplot2/qplot/pdf

还

```
Request failed: <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>403 Forbidden</title>
</head><body>
<h1>Forbidden</h1>
<p>You don't have permission to access /R/call/opencpu.demo/nabel/save
on this server.</p>
<hr>
<address>Apache/2.2.22 (Ubuntu) Server at 127.0.0.1 Port 80</address>
</body></html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T01:32:25.620

我在 virtualbox 上重新安装了 ubuntu，并在 opencpu 上仔细按照说明进行操作，它开箱即用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T03:05:28.150

有几件事可能导致此问题，您的操作系统设置可能过于安全，例如您是 SELinux ，您可能必须 chown 或 chmod 文件系统的权限，或者您可能必须重新配置 apache 本身。

以下是一些有助于解决问题的资源：

如果您需要检查文件权限： [http](http://wiki.apache.org/httpd/13PermissionDenied) ://wiki.apache.org/httpd/13PermissionDenied 并且演示了如何使用 namei：

```
namei -m /usr/local/apache2/htdocs/foo/bar.html 
```

看看发生了什么。

* * *

这讨论了 SELinux 导致 apaceh 权限问题的解决方案：

[Apache 403 错误，(13)Permission denied: access to / denied, Fedora 16](https://stackoverflow.com/questions/8816836/apache-403-error-13permission-denied-access-to-denied-fedora-16)

本质上，您适用`chcon -t httpd_sys_content_t`于文档根路径中的每个目录。

* * *

由于您似乎没有运行 cgi 或 php，因此失去这些权限可能不是问题，但如果是这样，您应该使 apache 的 http.conf 允许执行脚本并且它们位于适当的目录中。

# doctrine-orm - Symfony2 不一致的表单绑定和持久化行为，实体关联不一致

> ID：11787868
> 
> 赞同：1
> 
> 时间：2012-08-03T00:52:28.663
> 
> 标签：doctrine-orm, symfony-forms, symfony-2.1

我有一个属于一个或多个类别的实体，每个实体（Boom）都有许多属性或子元素（Boomelement），在这种情况下它们应该是 7。

当我尝试根据执行顺序保留实体时，我得到不同的结果：

1.  如果我创建一个空实体，绑定请求，然后坚持：

    *   生成实体
    *   类别被正确分配
    *   子元素被持久化，但它们没有与实体关联，具有外键的列显示为 null
2.  如果我制作一个没有空实体的表单，则绑定请求并保持：

    *   生成实体
    *   该类别没有得到分配
    *   子元素被持久化并与实体相关联
3.  如果我使用空实体创建表单并分配 1 个空子元素，则绑定请求然后持久化：

    *   生成实体
    *   类别被分配
    *   只有 1 个子元素与实体关联，其余子元素被持久化但未将列与外键关联显示为 null
4.  如果我使用空实体创建表单并分配 7 个空子元素，则绑定请求然后持久化：

    *   生成实体
    *   类别被分配
    *   7 个子元素与实体相关联
    *   如果我动态添加更多子元素怎么办，它们将不会被关联

我认为这种行为是不一致和奇怪的，除此之外没有记录。

有没有办法正确地做到这一点？

**控制器动作：**

```
public function createAction() {
    $entityEmpty = new Boom();
    //for ($i = 0; $i <= 6; $i++) {
        $element = new Boomelement();
        $entityEmpty->addElement($element);
        //$element->setPosition($i);
    //}

    $form = $this->createForm(new BoomType(),$entityEmpty);
    $request = $this->getRequest();
    $form->bind($request);
    $entity = $form->getData();
    var_dump($entityEmpty);
    var_dump($entity);
    //exit;
    if ($form->isValid()) {
        $em = $this->getDoctrine()->getManager();
        $em->persist($entity);
        $em->flush();

        //return $this->redirect($this->generateUrl('boom_show', array('id' => $entity->getId())));
    }else{
        //var_dump($form->getErrors());
        //var_dump(get_class_methods($form));
    }

    return $this->render('BoomBackBundle:Boom:new.html.php', array(
                'entity' => $entity,
                'form' => $form->createView(),
            ));
} 
```

**实体=繁荣；**

```
/**
 * @ORM\Entity(repositoryClass="Boom\Bundle\LibraryBundle\Repository\BoomRepository")
 * @ORM\Table(name="boom")
 * @ORM\HasLifecycleCallbacks
 */
class Boom extends DomainObject
{

/**
 * @ORM\Id
 * @ORM\Column(type="integer")
 * @ORM\GeneratedValue(strategy="AUTO")
 */
protected $id;

/**
 * @Gedmo\Slug(fields={"title"})
 * @ORM\Column(type="string", length=140, unique=true)
 */
protected $slug;

/**
 * @ORM\Column(type="string", length=140)
 */
protected $title;

/**
 * @ORM\Column(type="text")
 */
protected $summary;

/**
 * @ORM\Column(type="datetime")
 */
protected $date_created;

/**
 * @ORM\Column(type="datetime", nullable=true)
 * @ORM\Version
 */
protected $date_published;

/**
 * @ORM\Column(type="boolean")
 */
protected $nsfw;

/**
 * @ORM\ManyToOne(targetEntity="Image")
 * @ORM\JoinColumn(name="image_id", referencedColumnName="id", nullable=true)
 **/
protected $image;

/**
 * @ORM\ManyToOne(targetEntity="User", fetch="LAZY")
 * @ORM\JoinColumn(name="user_id", referencedColumnName="id", nullable=true)
 **/
protected $user;

/**
 * @ORM\ManyToOne(targetEntity="Boom", inversedBy="children")
 * @ORM\JoinColumn(name="parent_id", referencedColumnName="id", nullable=true)
 **/
protected $parent;

/**
 * @ORM\OneToMany(targetEntity="Boom", mappedBy="parent")
 **/
protected $children;

/**
 * @ORM\ManyToMany(targetEntity="Category", inversedBy="categories")
 * @ORM\JoinTable(name="booms_categories",
 *      joinColumns={@ORM\JoinColumn(name="boom_id", referencedColumnName="id")},
 *      inverseJoinColumns={@ORM\JoinColumn(name="category_id", referencedColumnName="id")}
 *      )
 */
protected $categories;

/**
 * @ORM\ManyToMany(targetEntity="Tag", inversedBy="booms")
 * @ORM\JoinTable(name="booms_tags")
 **/
protected $tags;

/**
 * @ORM\OneToMany(targetEntity="Boomelement", mappedBy="boom", cascade={"persist","remove"}, orphanRemoval=true)
 * @ORM\OrderBy({"position" = "ASC"})
 **/
protected $elements;

public function __construct()
{
    $this->children = new ArrayCollection();
    $this->categories = new ArrayCollection();
    $this->tags = new ArrayCollection();
    $this->elements = new ArrayCollection();
    $this->nsfw = false;
}

/**
 * Get id
 *
 * @return integer
 */
public function getId()
{
    return $this->id;
}

/**
 * Set slug
 *
 * @param string $slug
 * @return Boom
 */
public function setSlug($slug)
{
    $this->slug = $slug;
    return $this;
}

/**
 * Get slug
 *
 * @return string
 */
public function getSlug()
{
    return $this->slug;
}

/**
 * Set title
 *
 * @param string $title
 * @return Boom
 */
public function setTitle($title)
{
    $this->title = $title;
    return $this;
}

/**
 * Get title
 *
 * @return string
 */
public function getTitle()
{
    return $this->title;
}

/**
 * Set summary
 *
 * @param text $summary
 * @return Boom
 */
public function setSummary($summary)
{
    $this->summary = $summary;
    return $this;
}

/**
 * Get summary
 *
 * @return text
 */
public function getSummary()
{
    return $this->summary;
}

/**
 * Set date_created
 *
 * @param datetime $dateCreated
 * @return Boom
 */
public function setDateCreated($dateCreated)
{
    $this->date_created = $dateCreated;
    return $this;
}

/**
 * Get date_created
 *
 * @return datetime
 */
public function getDateCreated()
{
    return $this->date_created;
}

/**
 * Set date_published
 *
 * @param datetime $datePublished
 * @return Boom
 */
public function setDatePublished($datePublished)
{
    $this->date_published = $datePublished;
    return $this;
}

/**
 * Get date_published
 *
 * @return datetime
 */
public function getDatePublished()
{
    return $this->date_published;
}

/**
 * Set nsfw
 *
 * @param boolean $nsfw
 * @return Boom
 */
public function setNsfw($nsfw)
{
    $this->nsfw = $nsfw;
    return $this;
}

/**
 * Get nsfw
 *
 * @return boolean
 */
public function getNsfw()
{
    return $this->nsfw;
}

/**
 * Set image
 *
 * @param Boom\Bundle\LibraryBundle\Entity\Image $image
 * @return Boom
 */
public function setImage(\Boom\Bundle\LibraryBundle\Entity\Image $image = null)
{
    $this->image = $image;
    return $this;
}

/**
 * Get image
 *
 * @return Boom\Bundle\LibraryBundle\Entity\Image
 */
public function getImage()
{
    return $this->image;
}

/**
 * Set user
 *
 * @param Boom\Bundle\LibraryBundle\Entity\User $user
 * @return Boom
 */
public function setUser(\Boom\Bundle\LibraryBundle\Entity\User $user = null)
{
    $this->user = $user;
    return $this;
}

/**
 * Get user
 *
 * @return Boom\Bundle\LibraryBundle\Entity\User
 */
public function getUser()
{
    return $this->user;
}

/**
 * Set parent
 *
 * @param Boom\Bundle\LibraryBundle\Entity\Boom $parent
 * @return Boom
 */
public function setParent(Boom $parent = null)
{
    $this->parent = $parent;
    return $this;
}

/**
 * Get parent
 *
 * @return Boom\Bundle\LibraryBundle\Entity\Boom
 */
public function getParent()
{
    return $this->parent;
}

/**
 * Add children
 *
 * @param Boom\Bundle\LibraryBundle\Entity\Boom $children
 * @return Boom
 */
public function addChildren(\Boom\Bundle\LibraryBundle\Entity\Boom $children)
{
    $this->children[] = $children;
    return $this;
}

/**
 * Remove children
 *
 * @param <variableType$children
 */
public function removeChildren(\Boom\Bundle\LibraryBundle\Entity\Boom $children)
{
    $this->children->removeElement($children);
}

/**
 * Get children
 *
 * @return Doctrine\Common\Collections\Collection
 */
public function getChildren()
{
    return $this->children;
}

/**
 * Add categories
 *
 * @param Boom\Bundle\LibraryBundle\Entity\Category $categories
 * @return Boom
 */
public function addCategorie(\Boom\Bundle\LibraryBundle\Entity\Category $categories)
{
    $this->categories[] = $categories;
    return $this;
}

/**
 * Remove categories
 *
 * @param <variableType$categories
 */
public function removeCategorie(\Boom\Bundle\LibraryBundle\Entity\Category $categories)
{
    $this->categories->removeElement($categories);
}

/**
 * Get categories
 *
 * @return Doctrine\Common\Collections\Collection
 */
public function getCategories()
{
    return $this->categories;
}

/**
 * Set categories
 *
 * @return Boom
 */

public function setCategories(\Doctrine\Common\Collections\Collection $categories)
{
    return $this;
}

/**
 * Add elements
 *
 * @param Boom\Bundle\LibraryBundle\Entity\Boomelement $elements
 * @return Boom
 */
public function addElement(\Boom\Bundle\LibraryBundle\Entity\Boomelement $elements)
{

    $this->elements[] = $elements;
    if($elements->getBoom() == null || $elements->getBoom() !== $this){
        $elements->setBoom($this);
    }
    return $this;
}

/**
 * Remove elements
 *
 * @param <variableType$elements
 */
public function removeElement(\Boom\Bundle\LibraryBundle\Entity\Boomelement $elements)
{
    $this->elements->removeElement($elements);
    $elements->setBoom();
}

/**
 * Get elements
 *
 * @return Doctrine\Common\Collections\Collection
 */
public function getElements()
{
    return $this->elements;
}

/**
 * Add tags
 *
 * @param Boom\Bundle\LibraryBundle\Entity\Tag $tags
 * @return Boom
 */
public function addTag(\Boom\Bundle\LibraryBundle\Entity\Tag $tags)
{
    $this->tags[] = $tags;
    return $this;
}

/**
 * Remove tags
 *
 * @param <variableType$tags
 */
public function removeTag(\Boom\Bundle\LibraryBundle\Entity\Tag $tags)
{
    $this->tags->removeElement($tags);
}

/**
 * Get tags
 *
 * @return Doctrine\Common\Collections\Collection
 */
public function getTags()
{
    return $this->tags;
}

/**
 * @ORM\PrePersist()
 *
 */
public function prePersist(){
    $this->setDateCreated(new \DateTime());
}

public function hasCategories(ExecutionContext $context){
    if($this->getCategories()->count() == 0){
        $context->addViolationAtSubPath('categories','No categories selected');
    }

}

} 
```

**子元素= Boomelement**

```
/**
 * @ORM\Entity
 * @ORM\Table(name="boomelement")
 */
class Boomelement extends DomainObject{

/**
 * @ORM\Id
 * @ORM\Column(type="integer")
 * @ORM\GeneratedValue(strategy="AUTO")
 */
protected $id;

/**
 * @ORM\Column(type="string", length=140, nullable=true)
 */
public $title;

/**
 * @ORM\Column(type="text", nullable=true)
 */
protected $content;

/**
 * @Gedmo\SortablePosition
 * @ORM\Column(type="integer")
 */
protected $position;

/**
 * @Gedmo\SortableGroup
 * @ORM\ManyToOne(targetEntity="Boom", inversedBy="elements")
 * @ORM\JoinColumn(name="parent_id", referencedColumnName="id")
 **/
protected $boom;

/**
 * @ORM\ManyToOne(targetEntity="Image", inversedBy="image")
 * @ORM\JoinColumn(name="image_id", referencedColumnName="id")
 **/
protected $image;

/**
 * Get id
 *
 * @return integer
 */
public function getId()
{
    return $this->id;
}

/**
 * Set title
 *
 * @param string $title
 * @return Boomelement
 */
public function setTitle($title)
{
    $this->title = $title;
    return $this;
}

/**
 * Get title
 *
 * @return string
 */
public function getTitle()
{
    return $this->title;
}

/**
 * Set content
 *
 * @param text $content
 * @return Boomelement
 */
public function setContent($content)
{
    $this->content = $content;
    return $this;
}

/**
 * Get content
 *
 * @return text
 */
public function getContent()
{
    return $this->content;
}

/**
 * Set position
 *
 * @param integer $position
 * @return Boomelement
 */
public function setPosition($position)
{
    $this->position = $position;
    return $this;
}

/**
 * Get position
 *
 * @return integer
 */
public function getPosition()
{
    return $this->position;
}

/**
 * Set boom
 *
 * @param Boom\Bundle\LibraryBundle\Entity\Boom $boom
 * @return Boomelement
 */
public function setBoom(\Boom\Bundle\LibraryBundle\Entity\Boom $boom = null)
{
    $this->boom = $boom;
    //var_dump($boom);
    if($boom !== $this->boom){
        $boom->addElement($this);
    }

    return $this;
}

/**
 * Get boom
 *
 * @return Boom\Bundle\LibraryBundle\Entity\Boom
 */
public function getBoom()
{
    return $this->boom;
}

/**
 * Set image
 *
 * @param Boom\Bundle\LibraryBundle\Entity\Image $image
 * @return Boomelement
 */
public function setImage(\Boom\Bundle\LibraryBundle\Entity\Image $image = null)
{
    $this->image = $image;
    return $this;
}

/**
 * Get image
 *
 * @return Boom\Bundle\LibraryBundle\Entity\Image
 */
public function getImage()
{
    return $this->image;
}
} 
```

当我使用空实体创建表单时，相关记录

```
public function createAction() {
    $entityEmpty = new Boom();
    $form = $this->createForm(new BoomType(),$entityEmpty);
    $request = $this->getRequest();
    $form->bind($request);
    if ($form->isValid()) {
        $em = $this->getDoctrine()->getManager();
        $em->persist($entityEmpty);
        $em->flush();

        return $this->redirect($this->generateUrl('boom_show', array('id' => $entity->getId())));
    }else{
        //var_dump($form->getErrors());
        //var_dump(get_class_methods($form));
    }

    return $this->render('BoomBackBundle:Boom:new.html.php', array(
                'entity' => $entity,
                'form' => $form->createView(),
            ));
} 
```

# android - 我的 Android 程序在模拟器上运行，但不在 Galaxy S3 上

> ID：11787872
> 
> 赞同：0
> 
> 时间：2012-08-03T00:53:10.760
> 
> 标签：android

当我在 Android 模拟器上运行我的程序时，它会运行，但在三星 Galaxy S3 上，它不会。我的意思是，当我在模拟器上安装 .apk 时，它是成功的。当我的模拟器重新启动时，应用程序就会运行。但是当我在galaxy s3上安装它时，它安装成功，我可以毫无问题地打开它，但是当我重新启动我的galaxy s3时，它不会自动打开。

我认为这是因为我的 android 模拟器使用的是 Android 2.2 版，而我的 S3 使用的是 Android 4.0.4 版

我的应用很简单；每次手机启动时，我的程序都会启动。

此应用的 SDK 版本为“4.1 API 16”。

这是我的代码。

**清单.xml**

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.onboot"
    android:versionCode="1"
    android:versionName="1.0" >
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >

        <receiver android:name=".LaunchAppBroadcast"
            android:permission="android.permission.RECEIVE_BOOT_COMPLETED">
            <intent-filter>
                <action android:name="android.intent.action.BOOT_COMPLETED"/>
            </intent-filter>
        </receiver>
        <activity
            android:name=".OnBoot"
            android:label="@string/title_activity_on_boot" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

我有一个java文件。

**OnBoot.java**

```
public class OnBoot extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_on_boot);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_on_boot, menu);
    return true;
} 
```

}

和**LaunchAppBroadcast.java**

```
public class LaunchAppBroadcast extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    // TODO Auto-generated method stub
    Intent intent2 = new Intent(context, OnBoot.class);
    intent2.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    context.startActivity(intent2);

}

 } 
```

而已。再一次，这已经在 android 模拟器上工作了。

我现在再次使用BUILD SDK“4.0 API 14”创建了一个新项目，它仍然适用于模拟器但不适用于我的银河系

# jquery - 使用 safari 的 CSS / JavaScript 滑块动画问题

> ID：11787879
> 
> 赞同：0
> 
> 时间：2012-08-03T00:54:52.517
> 
> 标签：jquery, css, animation, safari, slider

我目前正在为客户建立一个网站，我正在使用[本教程中的代码](http://tympanus.net/codrops/2010/10/07/slider-gallery/)

不幸的是，我的客户不允许我发布我当前工作的链接，因为它包含敏感信息。然而，上面是我正在使用的一个清晰的例子。

问题：

我在滑块上的图像旁边使用文本作为描述。他们目前使用边距坐在每个图像旁边，并且有自己的 div。在 Safari 中，此文本会扭曲并超出文本的顶部，并且似乎忽略了我制定的规则，要么坐在图像顶部，要么向右移动。我不知道它为什么这样做并且在其他浏览器中根本不会发生。我已经更改了 java 变量，因此整个容器更大，但这似乎没有什么区别。奇怪的是，在某些情况下刷新页面时它显示得很好，但似乎没有任何模式，而且我在时间轴上也没有看到任何奇怪的东西。如果有人能解释为什么会发生这种情况，或者可能为我指明方向，那就太好了。

[链接到没有敏感信息但仍然存在问题的作品副本](https://dl.dropbox.com/u/73729974/web5/products.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T04:28:39.873

1.  使用 div#photo
2.  使用 css`div#photo div {float:left}`
3.  #photo 本身必须向左浮动才能以这种水平方式堆叠它们

HTML：

```
div#album                      {min-width:1000px,min-height:200px}
div#album div                  {float:left,min-width:100px}
div#album div#photo            {min-height:200px}
div#album div#photo div        {float:left}
div#album div#photo div#image  {min-height:200px,min-width:100px}
div#album div#photo div#text   {min-height:50px,min-width:75px} 
```

我给出了一个格式，如果您仔细查看尺寸，它显示的是“确保您的文本 div 的高度不超过父级或兄弟级”

我所展示的是孩子应该比父母有更小的宽度和高度，因为当使用“浮动”时它们会溢出

# asp.net - 使用 Response.RedirectToRoute() 重写 ASP.NET Url

> ID：11787880
> 
> 赞同：1
> 
> 时间：2012-08-03T00:54:54.507
> 
> 标签：asp.net, url-routing

我写了一个 Global.asax 文件

routeCollection.MapPageRoute("GotoPage", "Default.aspx/{*Id}", "~/Default.aspx");

从我调用的aspx页面喜欢

Response.RedirectToRoute("GotoPage", new { Id = Request.QueryString["Id"].ToString() });

它重定向到[http://mysite.com/GotoPage/2](http://mysite.com/GotoPage/2)。

现在的问题是。该 URL aspx 页面无法加载 JQuery、CSS、Javascript 文件。它说无效的文件路径（在运行时）

可以帮助将是可观的..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:53:14.133

在您的 masterPage 中，确保文件的路径如下所示

```
<script src="<%# ResolveUrl ("~/Scripts/jquery-1.6.2.min.js") %>" type="text/javascript"></script>
<link id="stMain" href="~/css/style.css" rel="stylesheet" type="text/css" media="screen" /> 
```

# ruby - Github API v3 的简单 Ruby 身份验证

> ID：11787882
> 
> 赞同：1
> 
> 时间：2012-08-03T00:55:09.683
> 
> 标签：ruby, api, github-api

我正在寻找一个简单的红宝石脚本：

1.  插入 *.rb 文件。
2.  填写我的身份验证信息。
3.  指定 API URL。
4.  取回数据。

与 Githubs API 的文档一样漂亮……没有简单的“一击即走”示例来在 ruby​​ 脚本中取回数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T14:36:36.457

在[GitHub 开发人员库页面上](http://developer.github.com/v3/libraries/#ruby)，有一些指向 ruby​​ 库的链接。阅读例如[GitHub API Gem](https://github.com/peter-murach/github)上的文档（将自己描述为“GitHub REST API v3 的 Ruby 包装器”），使用[文档](http://peter-murach.github.com/github/)。

# python - pandas - 计算两个具有循环依赖关系的系列的更有效方法

> ID：11787883
> 
> 赞同：3
> 
> 时间：2012-08-03T00:55:14.023
> 
> 标签：python, pandas

我有一个`DataFrame`代表股票收益的。要拆分调整收盘价，我有以下方法：

```
def returns(ticker, start=None, end=None):
    p = historical_prices(ticker, start, end, data='d', convert=True)
    d = historical_prices(ticker, start, end, data='v', convert=True)

    p['Dividends'] = d['Dividends']
    p['Dividends'].fillna(value=0, inplace=True)
    p['DivFactor'] = 1.
    p['SAClose'] = p['Close']

    records, fields = p.shape
    for t in range(1, records):
        p['SAClose'][t] = p['Adj Close'][t] / p['DivFactor'][t-1] + \
                          p['Dividends'][t-1]
        p['DivFactor'][t] = p['DivFactor'][t-1] * \
                            (1 - p['Dividends'][t-1] / p['SAClose'][t])

    p['Lagged SAClose'] = p['SAClose'].shift(periods=-1)
    p['Cash Return'] = p['Dividends'] / p['Lagged SAClose']
    p['Price Return'] = p['SAClose'] / p['Lagged SAClose'] - 1
    return p.sort_index() 
```

请注意`SAClose`（即拆分调整关闭）如何取决于滞后`DivFactor`值。反过来，`DivFactor`取决于滞后`DivFactor`值和当前`SAClose`值。

上面的方法有效，但在循环部分速度非常慢。有没有更有效的方法让我在熊猫中做到这一点？鉴于“循环”依赖（考虑到滞后并不是真正的循环），我不确定如何进行常规系列数学或使用正常的移位操作（例如，我使用`Cash Return`）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T02:47:01.060

您可以尝试一次性创建累积调整因子系列，然后您不需要循环：

```
(p['Dividends'].fillna(1.) + 1.).cumprod() 
```

# c# - 从接收者发送类的解耦命令（模式）？

> ID：11787886
> 
> 赞同：1
> 
> 时间：2012-08-03T00:56:13.810
> 
> 标签：c#, design-patterns

因此，为了在任何类中创建命令（基于模式），该类必须知道接收者类，以便将其传递给命令的构造函数，然后将类耦合在一起。有没有办法使用命令模式并保持两个类之间的间接度量？

我能想到的唯一解决方案是：

*   使用调解器，但我不知道究竟如何，因为至少命令仍然需要传递给类，即使它只是它的接口
*   使用外观，但这会将任何命令调用类耦合到外观
*   使用事件系统而不是命令，但这在执行和编写代码本身方面有太多开销
*   使用创建模式以某种方式创建命令，但将所有内容与该对象耦合

我对事件系统最大的担忧是，根据我在事件系统方面的经验，您必须编写大量代码才能让发送者和接收者在彼此不知情的情况下进行交互，这很疯狂而且根本不实用——我希望通过一个event 要求我修改至少一个其他类，通常更多，这会产生与紧密耦合的 spegetti 代码一样糟糕的问题。此外，我通常需要类来发送对事件的响应，这也很麻烦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T01:29:52.607

命令模式并不意味着将创建者和接收者解耦。这些类通常已经耦合，甚至可能是同一个类。

命令模式所做的是将实现与*执行命令*的类分离。一旦创建了命令，就可以将它传递给 UI 层或通过网络传递给远程客户端，并且执行类不需要任何关于如何实现命令的知识。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T01:45:46.317

首先，不要使用外观。如果您从一开始就在设计中添加外观，您可能需要重新考虑您的设计。外观的主要目的是隐藏您想要简化交互的代码——通常是遗留代码。理想情况下，新代码应该从一开始就使用更简单的界面来设计。

在不了解您的具体问题的情况下，我有一些建议：

1.  **继续使用事件系统。**C# 有一个很棒的事件系统，您可以利用它而无需编写太多自己的代码；只需定义一些委托并添加事件处理程序，您就大功告成了。发送事件的机制被抽象出来，因此您的大部分工作就是将它们连接在一起。如果您以前没有经常使用事件，那么一些快速搜索应该会为您提供大量有用的信息。

2.  **在执行时指定接收者：**

    ```
    public interface ICommand {
        public void Execute(IReceiver receiver);
    } 
    ```

    这允许接收器在`Execute()`被调用时动态更改，这使得这种模式的使用可以作为在系统中传递行为的一种方式。但是，在这一点上，有一种更好的方法可以达到相同的结果......

3.  **传递函数，而不是对象。** C# 再次发挥作用，允许函数像任何其他数据类型一样在系统中传递。将您的命令指定为委托：

    ```
    class MyThing {
        public delegate void Command(IReceiver receiver);

        public static void PrintReceiver(IReceiver receiver){
             // print the receiver
        }

        public static void ChangeReceiver(IReceiver receiver){
             // change something about the receiver
        }
    } 
    ```

    稍后允许您执行以下操作：

    ```
    IReceiver receiver = someReceiverThatAlreadyExists;
    Command action = someCondition ? MyThing.PrintReceiver : MyThing.ChangeReceiver;
    action(receiver); 
    ```

    这是一个过于简单的示例，但说明了如何拥有类似于命令的行为，但不需要完整的对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T02:45:55.063

你可以有

```
public interface ICommandHandler<T> where T : ICommand 
{
    void Execute(T command);
} 
```

当然，这将需要一些路由代码来将您的命令从发布者传输到接收者。但是，如果您将此路由基于约定，那么编写一次的代码应该不会那么难。

（我的想法是命令应该有一个单一的、定义明确的消费者。如果不是这种情况，那么这可能是一个事件，这有点不同，因为有兴趣的各方正在订阅事件他们自己）。

# python - 推送到heroku时编译器超时-python，django

> ID：11787890
> 
> 赞同：2
> 
> 时间：2012-08-03T00:57:29.690
> 
> 标签：python, django, heroku

我在推送到 heroku 时遇到编译器超时

我使用 APP：python + django。操作系统：Mac Lion

INSTALLED_APPS 是

```
INSTALLED_APPS = (
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.staticfiles',
'django.contrib.humanize',   # 4000 -> 4,000
'django.contrib.admin',
'gunicorn',
'kombu.transport.django',
'djcelery',
'django_facebook',
'google_analytics',
'tagging',
'registration',
'social_auth',
'cms',
'mptt',
'menus',
'south',
'sekizai', 
'social_auth',
's3_folder_storage',
'krstyle',   # my app
'template_debug',
) 
```

这似乎与我的 django 文件有关，因为如果我运行 git push heroku master

这是日志：

```
 Cleaning up...
 -----> Collecting static files
/app/slug-compiler/lib/utils.rb:65:in `block (2 levels) in spawn': command='/app/slug-compiler/lib/../buildpacks/python/bin/compile /tmp/build_24on8vwgty6ka /app/tmp/repo.git/.cache' exit_status=0 out='' at=timeout elapsed=195.8211374282837 (Utils::TimeoutError)
from /app/slug-compiler/lib/utils.rb:51:in `loop'
....
from /usr/local/lib/ruby/1.9.1/timeout.rb:58:in `timeout'
from /app/slug-compiler/lib/utils.rb:101:in `rescue in timeout'
...
from /app/slug-compiler/bin/slugc:66:in `<main>'
!     Heroku push rejected, failed to compile Python/django app

To git@heroku.com:cryptic-wave-9874.git
! [remote rejected] master -> master (pre-receive hook declined) 
```

# jquery - 从 Rails 视图动态/在运行时设置 jquery 变量？

> ID：11787894
> 
> 赞同：0
> 
> 时间：2012-08-03T00:57:40.020
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3.2, ruby-on-rails-plugins

我正在查看 Sharre social mediq jquery 插件[http://sharrre.com/#](http://sharrre.com/#) 下面是如何使用它的示例。

simple_jquery_social.js 示例：

```
$('#sharrre').sharrre({
share: {
  googlePlus: true,
   facebook: true,
  twitter: true
 },
url: 'http://sharrre.com' 
```

})

所以在正常的rails使用中，我会在我的资产目录中添加上面的内容（连同sharrre jquery lib的东西），在我的视图中放置一个'div id = sharrre'标签，我就完成了。但是我想在我的 .html.erb 视图模板中创建一个 rails 辅助函数，并动态决定是否显示 google plus，例如。所以我想要类似的东西：

```
<%= my_helper :googlePlus=>false %> 
```

然后我的环境应该知道上面 jquery 代码中的 googlePlus 变量现在为 false，因此不会显示 googlePlus 按钮。**重点是通过 Rails 动态控制 jquery 插件中可用的更多选项。但要做到这一点，我需要能够通过 Rails 动态设置 jquery 变量。我意识到上面的示例很简单，因为我可以手动更改 jquery 变量，但是通过 Rails 进行更改，我还可以动态设置 url 参数，这是我希望能够做到的，以便人们可以推荐特定页面.

什么是实现这一目标的好机制，或者甚至可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T02:21:37.840

创建一个将 ID、URL 和选项哈希作为参数的帮助程序。

然后helper生成js和html的混合，输出js代码和需要的div

```
def sharrre_tag(div_id, url, options = {})
  div_str = "<div id='#{div_id}'></div>".html_safe
  js_str = "<script>".html_safe
  #Add code to append specific js code and test all option existence and append time to js_str
  js_str += "</script>".html_safe
  return js_str + div_str
end 
```

在视图中，只需使用正确的参数调用您的助手

**选项 2\. 将 JS 与 HTML 分开**

如果你想实现这一点，你可以在你单独的 JS 文件中编写一个 JS 代码，它将每个元素与一个 class 结合起来`sharrre_div`。对于每一个，它都会检查是否存在特定的 html 数据属性 : `data-sharrre-googlePlus`, `data-sharrre-twitter`,`data-sharrre-url`等等……这个选项在很大程度上依赖于 JS

JS : 将其封装在 body onload 事件中

```
var sharrre_attr_array = ['data-sharrre-googlePlus', 'data-sharrre-facebook', 'data-sharrre-twitter'];
$('.sharrre_div').each(function(index){
    var share_hash = {};
        var current_div = $(this);
        $.each(sharrre_attr_array, function(index, element){

          if(current_div.attr(element)){
                share_hash[element.split('data-sharrre-')[1]] = true;
            }
      });
    $(this).sharrre({
          share: share_hash
            ,url: $(this).attr('data-sharrre-url')
        });

}); 
```

您的助手所要做的就是创建一个像这样的 div：

```
<div class='sharrre_div' data-sharrre-googlePlus='1' data-sharrre-twitter='1' data-sharrre-url='<%=request.url%>' data-sharrre-facebook='1'></div> 
```

写起来应该不会太难:)

# sql-server - 将字符添加到内部连接语句

> ID：11787899
> 
> 赞同：0
> 
> 时间：2012-08-03T00:58:05.117
> 
> 标签：sql-server, concatenation, inner-join

我正在处理`db1.dbo.batches.id`存储为`1234`但`db2.dbo.activity.batch_id`存储为`B1234`.

我正在尝试加入这两个表，就像这样......

```
SELECT column1, column2
FROM db1.dbo.batches AS b
INNER JOIN db2.dbo.activity AS a
ON ('B' + b.id) = a.batch_id 
```

问题是`('B' + b.id)`. 我试过`CONCAT('B' + b.id)`, `CAST('B' + b.id)`，`CONVERT(varchar(10),'B' + b.id)`但都没有奏效。

我可以运行第二个选择查询，但我希望得到更优雅的东西。

有任何想法吗？干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:04:26.523

尝试将“B”放在 CONVERT 函数之外：

```
SELECT column1, column2
FROM db1.dbo.batches AS b
INNER JOIN db2.dbo.activity AS a
ON 'B' + CONVERT(varchar(10), b.id) = a.batch_id 
```

# ruby - 在其中创建一个 html 页面 ruby 代码

> ID：11787900
> 
> 赞同：0
> 
> 时间：2012-08-03T00:58:09.690
> 
> 标签：ruby

我想创建 .html 静态页面，在里面我放了像这样的 ruby​​ 代码

放“你好鲁比！”

Ruby 已安装，我只是暂时不想使用任何框架，因为我需要先了解底层语言。

除了 .html 页面，我还需要将它上传到我的服务器并进行测试吗？

在 php 我简单的类型：

```
<h1><?php echo "Hello PHP!"; ?></h1> 
```

有什么简单的解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:35:59.370

你需要用 ruby​​ 生成整个东西，但我认为你可以做类似的事情

```
require 'erb'
my_page = <<EOS
<html>
  <body>
    <p><%= 'Hello ERB!' %></p>
  </body>
</html>
EOS
ERB.new(my_page).result(binding) 
```

# php - Facebook SDK for PHP 主动访问令牌错误

> ID：11787902
> 
> 赞同：1
> 
> 时间：2012-08-03T00:58:16.380
> 
> 标签：php, facebook

在这里使用这个简单的代码：

[http://pastebin.com/Rfa2F9Db](http://pastebin.com/Rfa2F9Db)

我得到 loginUrl 很好，当我单击链接时，我会看到 facebook 上的身份验证页面。然后我允许访问并被重定向回我的页面。

我注意到它添加的 URL 参数（包括“代码”）。

但是，一旦我通过带有错误的应用程序进行身份验证，我就会不断触发 FacebookApiException：

```
[error] => Array
(
    [message] => An active access token must be used to query information about the current user.
    [type] => OAuthException
    [code] => 2500
) 
```

我已经尝试转储 $facebook->getAccessToken() 并且我可以看到它正在使用的令牌，那么为什么我不断收到上面的活动访问令牌错误消息？

编辑：

这是异常跟踪：

[http://pastebin.com/1at6zgKC](http://pastebin.com/1at6zgKC)

一个有趣的部分是 [trace:Exception:private][2][args][0][0][accessToken:protected] 是空的！

# javascript - 按下按钮时执行操作

> ID：11787904
> 
> 赞同：-1
> 
> 时间：2012-08-03T00:58:20.267
> 
> 标签：javascript, jquery, click

我想拥有它，以便仅在单击另一个按钮后单击某个位置时才调用一个函数（可以说当我单击其他位置时该按钮处于“向下”状态）。

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:00:47.443

在第一个按钮的`click`事件处理程序中，将标志设置为`true`。在第二个按钮的`click`事件处理程序中检查标志是否为`true`，然后执行您的逻辑。

```
var button1Clicked = false; // what you call "down"
$('#button1').click(function() { button1Clicked = true });
$('#button2').click(function() { if (button1Clicked) { /* magic */ }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T01:02:02.400

要检查之前是否发生过其他点击，只需将其存储在变量中：

```
var firstButtonClicked = false;
firstButton.on("click", function() { firstButtonClicked = true; });
secondButton.on("click", function() {
    if (firstButtonClicked) {
        // do something
    } else {
        alert("You need to click the other button first");
    }
}); 
```

在每种情况下，您都应该给用户一些反馈，即他需要先单击一个按钮。最好的解决方案是将第二个设置为`disabled`，并从具有描述性标签的第一个按钮激活它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T01:19:59.120

您可以使用一个类来确定按钮的状态，例如

```
$('button').on('click', function(e){
    $(this).toggleClass('long');
    return false;
});
$(document).on('click', function(){
    $('.long').removeClass('long');
}); 
```

[小提琴](http://jsfiddle.net/mowglisanu/YdqJX/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T01:16:37.450

只需在第一次单击第一个按钮时绑定第二个按钮的单击处理程序。这样，在单击第一个按钮之前，该功能不存在：

```
$('#button1').one('click', function() {
    // Do stuff for first button's click

    // Create second click handler to be called when second button clicked
    $('#button2').click(function() {
        // Do stuff for second button's click
    });
}); 
```

# python - Python：从一个类继承，子类给 TypeError

> ID：11787907
> 
> 赞同：4
> 
> 时间：2012-08-03T00:59:04.297
> 
> 标签：python, inheritance

我有两个类继承自同一个基类但不想互相玩，确实是年轻人。

```
class A() : 
  ...

class B(A) : 
  ...

class C(A) : 
  ...

b=B()
c=C()
c.method(b) 
```

给我一个 c 和 b 不一样的 TypeError，python 需要什么认为它们是一样的？是否应该实施一些 __SpecialThingIDontKnowAbout__ 属性/方法？还是有一些我缺少的类设计技巧

具体来说，我继承 TreeDict() 如下：

```
class TNode(TreeDict):
 def __init__(self,*args,**kwargs) : 
  super(TNode, self).__init__(*args, **kwargs)

class LNode(TreeDict):
 def __init__(self,*args,**kwargs) : 
  super(LNode, self).__init__(*args, **kwargs)

TN = TNode(); TN.A = 1
LN = LNode(); LN.A = 1
LN.attach('TN',TN) 
```

给

```
Traceback (most recent call last):
  File "JSONE.py", line 430, in <module>
  LN.attach(TN)
TypeError: descriptor 'attach' requires a 'treedict.treedict.TreeDict' ...
object but received a 'type' 
```

我确实知道孩子们属于“类型”并且需要“treedict^3”，但我如何让孩子们模仿这种行为？

编辑 ：

嗯......它现在开始工作，并不是说我做了任何与我在撤消/重做历史中看到的不同的事情（谢谢大家）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:45:29.430

问题是 TreeDict 类型不允许子类化。我在[treedict](http://pypi.python.org/pypi/treedict)包中找到了它。TreeDict 类型本身是用 Cython 编写的。罪魁祸首是`attach()`方法中的这段代码（在treedict.pyx的第1910行附近）：

```
 if type(tree_or_key) is str:
        key = <str>tree_or_key
    elif type(tree_or_key) is TreeDict:
        if tree is not None:
            raise TypeError("Only one TreeDict instance can be given to attach.")

        tree = <TreeDict>tree_or_key
        key = None
    else:
        raise TypeError("`tree_or_key` must be either a string or TreeDict instance.") 
```

`elif type(tree_or_key) is TreeDict:`将行更改为`elif isinstance(tree_or_key, TreeDict):`并向项目提交补丁。您可能需要检查 treedict.pyx 的其余部分是否存在相同错误的其他情况。

# c++ - cout << 棘手的运算符重载 - 转储结构的字节

> ID：11787912
> 
> 赞同：-2
> 
> 时间：2012-08-03T01:00:16.817
> 
> 标签：c++, printf, cout

> **可能重复：**
> [char 指针与 C++ 中的 cout 混淆](https://stackoverflow.com/questions/10869459/char-pointer-confusing-with-cout-in-c)

给定您想要转储字节的任何结构，一种方法是在 C++ 中实现它，如下所示：

```
void print_bytes(myst *my_struct)
{
    char *ptr = (char *)my_struct;
    cout << std::hex;
    for (size_t i = 0; i < sizeof(*my_struct); i++) {
        cout << ptr + i << ": " << ptr[i];
        // similar to printf("%p: 0x%x", ptr + i, ptr[i]) right?
    }
} 
```

但上面打印的地址和值都是垃圾。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:34:36.233

实际上，您的代码存在一些问题。正如 Omair 指出的那样，一个是 ptr 是一个 char 指针，因此 cout 假定它指向一个以空值结尾的字符串。

正如 Omair 已经指出的，第二个问题是 ptr[i] 是一个字符，并且将打印为 ASCII 字形而不是字符的值。解决方案是将其转换为 int。

另一个问题是数据的类型。由于您声明 ptr 指向 char 而不是 unsigned char，因此这些值将被符号扩展。任何大于 7F 的值都将显示为 FFFFFFxx（进行中的 FF 的数量取决于编译器/环境中“int”的大小），因为它在打印时从有符号字符转换为无符号整数。

最后一个问题（使用 Omair 的解决方案）是现代编译器（例如 g++ -Wall）会抱怨在 void 指针上进行数学运算。因此，您必须在将 ptr 转换为 void 指针之前进行数学运算，方法是将 ptr + i 括在括号中。

完整的校正例程如下所示。

```
void print_bytes(myst *my_struct)
{
    unsigned char *ptr = (unsigned char *)my_struct;
    cout << std::hex;
    for (size_t i = 0; i < sizeof(*my_struct); i++) {
        cout << (const void *) (ptr + i) << ": " << (unsigned int) ptr[i] << "\n";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T01:00:16.817

`cout`在功能上与 printf 并不完全相同。要了解这里的陷阱，您需要了解`<<`运算符的不同重载函数。

我们有：

```
ostream& operator<< (short val);
ostream& operator<< (const void* val); // prints address given a pointer

ostream& operator<< (ostream& out, const char* s ); // prints a null-terminated string
ostream& operator<< (ostream& out, const signed char* s );
ostream& operator<< (ostream& out, const unsigned char* s ); 
```

现在，我们已经进行了类型转换`my_struct`，`char *`以便我们可以逐字节打印它。但这改变了 for 的含义`cout`，它现在需要一个以 null 结尾的字符串并打印垃圾*字符。*因此需要显式类型转换。此外，`ptr[i]`is a `char`，因此它只为该值打印一个字符。

修复它：

```
 cout << (const void *) ptr + i << ": " << (unsigned int) ptr[i]; 
```

# c++ - libtool：安装：错误：在安装之前使用上述命令重新链接“libmyprog.la”

> ID：11787917
> 
> 赞同：1
> 
> 时间：2012-08-03T01:01:02.903
> 
> 标签：c++, linker, dependencies, autotools, libtool

`make distcheck`我在我正在创作的项目中运行时遇到了名义上的链接错误：

```
$ uname -a
Linux vbox 3.2.0-26-generic #41-Ubuntu SMP Thu Jun 14 17:49:24 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux
$ cat /etc/issue
Ubuntu 12.04 LTS \n \l

$ libtool --version
libtool (GNU libtool) 2.4.2
Written by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996

Copyright (C) 2011 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
$ g++ --version
g++ (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3
Copyright (C) 2011 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

$ automake --version
automake (GNU automake) 1.11.3
Copyright (C) 2011 Free Software Foundation, Inc.
License GPLv2+: GNU GPL version 2 or later <http://gnu.org/licenses/gpl-2.0.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by Tom Tromey <tromey@redhat.com>
       and Alexandre Duret-Lutz <adl@gnu.org>. 
```

如您所见，它使用 g++ 4.6 和 libtool 2.4.2 在 Ubuntu 12.04 上出现。在使用 g++ 4.2.1 和 libtool 2.4.2（均通过自制软件安装）的 OS X 10.7.4 上，不会出现错误。它也没有出现在`make check`.

这是相关的片段`Makefile.am`：

```
# -- myprog --
#

lib_LTLIBRARIES += myproj/myprog/libmyprog.la
myproj_myprog_libmyprog_la_SOURCES = # ...
myproj_myprog_libmyprog_la_LIBADD = myproj/mylib/libmylib.la

sbin_PROGRAMS += myproj/myprog/myprog
myproj_myprog_myprog_SOURCES = myproj/myprog/main.cc
myproj_myprog_myprog_LDADD = myproj/myprog/libmyprog.la

# -- mylib --
#

lib_LTLIBRARIES += myprog/mylib/libmylib.la
myproj_mylib_libmylib_la_SOURCES = # ... 
```

和错误本身：

```
/usr/bin/ld: cannot find -lmylib
collect2: ld returned 1 exit status
libtool: install: error: relink `myproj/myprog/libmyprog.la' with the above command before installing it 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T01:01:02.903

简而言之，顺序（显然）很重要：

```
# -- mylib --
#

lib_LTLIBRARIES += myprog/mylib/libmylib.la
myproj_mylib_libmylib_la_SOURCES = # ...

# -- myprog --
#

lib_LTLIBRARIES += myproj/myprog/libmyprog.la
myproj_myprog_libmyprog_la_SOURCES = # ...
myproj_myprog_libmyprog_la_LIBADD = myproj/mylib/libmylib.la

sbin_PROGRAMS += myproj/myprog/myprog
myproj_myprog_myprog_SOURCES = myproj/myprog/main.cc
myproj_myprog_myprog_LDADD = myproj/myprog/libmyprog.la 
```

现在我的项目在所有提到的平台上构建（`check`和）。`distcheck`

# python - 用自定义类型替换 Pythons 内置类型

> ID：11787922
> 
> 赞同：4
> 
> 时间：2012-08-03T01:01:33.540
> 
> 标签：python, object, types, built-in

是否可以用自定义类型替换一些内置的 python 类型？

我想创建类似的东西：

```
class MyInt(object):
   ...
__builtin__.int = MyInt
x = 5 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T01:50:54.603

您似乎在询问是否可以覆盖输入时创建的类型*literals*。答案是不。您不能使它`x = 5`使用内置类型以外的`int`类型。

您可以覆盖`__builtin__.int`，但这只会影响名称的显式使用`int`，例如，当您这样做时`int("5")`。这样做没有什么意义。最好只使用您的常规课程并执行`MyInt("5")`.

更重要的是，您*可以*在类上提供运算符重载，以便例如`MyInt(5) + 5`工作并返回另一个 MyInt。您可以通过 `__add__`为 MyInt 类（以及`__sub__`减法等）编写一个方法来做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T01:22:51.547

我不知道*替换*内置插件，但你当然可以创建一个继承自它们的对象，和/或表现得像它们。查找类似的`inherit from immutable`内容，您应该找到显示覆盖的答案`__new__`，或者对于后一个选项，请参阅“[模拟数字类型](http://docs.python.org/reference/datamodel.html?highlight=__iadd__#emulating-numeric-types)”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T19:03:30.657

由于您想编写 Pythonesque DSL，您有两种选择：

1.  将代码编译为 AST 并根据需要遍历 AST 替换节点。
2.  手动构建自己的 AST。

一旦你有了 AST，你就可以直接执行它。无论哪种情况，请查看[Python 的语言服务](http://docs.python.org/library/language.html)以生成和操作 AST。

# html - 纯 CSS 选择菜单/下拉菜单：如何制作自定义右箭头？

> ID：11787924
> 
> 赞同：12
> 
> 时间：2012-08-03T01:02:00.997
> 
> 标签：html, css, drop-down-menu

我在这里根据解决方案使用自定义选择/下拉菜单：[https ://stackoverflow.com/a/10190884/1318135](https://stackoverflow.com/a/10190884/1318135)

这个功能很好，只是右边的“箭头”看起来不太好。我希望它更宽，在外观上类似于本网站上的向上/向下投票箭头（向左看）。

尝试了以下，使用这些或其他选项中的任何一个打开解决方案：
- 将图像集成到 HTML 中（无法使其在前景 v. 下拉列表中显示）
- 使用更宽的字符箭头定位字体（找不到一）
- 在 CSS 中设置 background-image 属性（改为显示默认向下箭头）

[http://jsfiddle.net/XxkSC/553/](http://jsfiddle.net/XxkSC/553/)

HTML：

```
<label class="custom-select">
<select>
<option>Sushi</option>
<option>Blue cheese with crackers</option>
<option>Steak</option>
<option>Other</option>
</select>
</label> 
```

CSS：

```
label.custom-select {
position: relative;
display: inline-block;

  }

.custom-select select {
display: inline-block;
padding: 4px 3px 3px 5px;
margin: 0;
font: inherit;
outline:none; /* remove focus ring from Webkit */
line-height: 1.2;
background: #000;
color:white;
border:0;
 }

/* Select arrow styling */
.custom-select:after {
content: "▼";  /* Current arrow I would like to change */
position: absolute;
top: 0;
right: 0;
bottom: 0;
font-size: 60%;
line-height: 30px;
padding: 0 7px;
background: #000;
color: white;
}

.no-pointer-events .custom-select:after {
content: none;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T01:21:53.873

你对图像有正确的想法，你只需要调整内容。这有效：

```
content: url('some_path.png'); 
```

或者，如果你真的想在 CSS 中全部使用，你可以像这样对图像进行编码：

```
content: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAANCAYAAAC3mX7tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAUtJREFUeNq8089KAlEUx/HvaIRCIbRyCsLxCcYZokcInWkRCCHMSgn68xQueoA2RRC0kdoIFcxoPUGrUZeurJWtozKJ4LTJEM1/pJ3lPdz7uT/uPUo+fyj8QwVUNTpzRFWjBBwnk9W02MwQTYuJ42SOFBEJAJuuW7quVGpTRQxDF9tO5QBPEREFEGDDdUu308IMQ8e2U1ngHJgLdPXubDu1bhh6a0rI/jcC8NmdqFNrrlu6r1RqwT8iJ93rv0FB4Mz3q9ueVw5PglhWEtNM7AKnvT1FZOAYLfp+9dHzyksTIH1JfuYIiAzY+2KaiVXLSr6OiRwMQjrQ+5Az3kwzoVtW8mMEsgccD7uMIiLhERiA1mg81IvFq/l2uw1AKBQind5qx+NaDrgYlVoRkQjwPMYzrDSbT/VC4XIBwHEyreVldQe4AVo9H6qvvgYAd7R15OvpfHEAAAAASUVORK5CYII=); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-17T10:57:03.803

您也可以使用`content:"\25BC";`Unicode 中转义的黑色向下箭头。如此处所示：http: [//unicode-table.com/en/25BC/](http://unicode-table.com/en/25BC/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-01T21:55:17.950

有同样的问题，并找到了一个有`linear-gradient`背景的解决方案。

[Codepen 示例](http://codepen.io/vkjgr/pen/VYMeXp)

```
select {
  background:
    linear-gradient(45deg, transparent 50%, blue 50%),
    linear-gradient(135deg, blue 50%, transparent 50%);
  background-position:
    calc(100% - 21px) 18px,
    calc(100% - 16px) 18px;
  background-size: 5px 5px;
  background-repeat: no-repeat;
  ... 
```

..和焦点

```
select:focus {
  background:
    linear-gradient(45deg, green 50%, transparent 50%),
    linear-gradient(135deg, transparent 50%, green 50%);
  background-position:
    calc(100% - 16px) 16px,
    calc(100% - 21px) 16px;
  background-size: 5px 5px;
  background-repeat: no-repeat;
  ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-08T13:24:30.050

也许是**“有点短，感谢 SVG 在 Retina 上也不错”**版本！

```
 select:not([multiple]){
    border-radius: 0;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='8' height='8' fill='silver'><polygon points='0,0 8,0 4,4'/></svg>") no-repeat scroll 95% 60% transparent;
    padding:.5em 1.5em .5em .5em;
  } 
```

> **示例预览** [https://jsfiddle.net/4mwL03uz/](https://jsfiddle.net/4mwL03uz/)

想法来自：[从引导程序 3 中的选择标签中删除边框半径](https://stackoverflow.com/q/24210132)

# mysql - 从本地测试站点更新实时 mysql 数据库的最佳实践

> ID：11787933
> 
> 赞同：1
> 
> 时间：2012-08-03T01:02:27.723
> 
> 标签：mysql, drupal, local, production

嗨，我有一个活跃的实时网站。我正在使用 Drupal 7 和 MySQL。

当该网站上线并收集用户信息和其他更新时，我正在努力在我的本地网站副本上建立一个 Ubercart 商店（使用 MAMP）。

我首先将实时站点复制到本地站点，因此我正在处理最新的更新。这可能需要一段时间，当我在本地工作时，实时站点上可能会发生变化，我想知道：

在不破坏我在本地工作时所做的任何实时更改（新用户/文章）的情况下，将本地数据库（使用 ubercart）带到实时数据库的最佳方法是什么？

哦，让我补充一下，我只知道如何使用 phpMyAdmin ......现在没有时间学习 ssh，但它在某个时候在我的待办事项列表上......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T05:18:33.070

使用 phpMyAdmin 的数据库同步功能。它不仅同步整个数据库，而且同步选择性表。

来自[phpMyAdmin 的文档](http://www.phpmyadmin.net/documentation/#faq9_1)：

> 您现在可以使用同步功能在 phpMyAdmin 中同步数据库/表。它允许您连接到本地和远程服务器 [...] 您现在可以同步放置在同一服务器或某个远程服务器上的数据库 [...] 除了完整的数据库，数据库的某些表也可以被同步。

因此，找出您想要保持同步的表格和方向，然后使用您的 Google-fu 获取有关 phpMyAdmin 同步功能的教程（如果您从未使用过它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T01:05:43.823

根据您正在处理的应用程序的类型，一种可能危险或非常酷的方法是使用`ssh`隧道连接到远程数据库并通过它连接您的本地应用程序。

尝试击中这样的移动目标可能会很棘手，所以要非常小心。

请记住，无论何时在生产数据库上工作，您都应该在尝试此类操作之前进行多次**备份。**

# django - Google App Engine 上的 Django 夹具加载速度非常慢

> ID：11787939
> 
> 赞同：0
> 
> 时间：2012-08-03T01:03:20.060
> 
> 标签：django, google-app-engine, google-cloud-datastore, django-nonrel

我已经使用 Google App Engine 部署了一个 Django 网站，并且正在使用命令

```
python manage.py remote loaddata my_data.yaml 
```

使用来自 yaml 格式的夹具文件的初始数据填充数据存储。这是我的 yaml 文件的示例：

```
- fields: {team: 10, first_name: Jeff, last_name: Adrien, age: 25, pos: SF, gp: 8, mp: 63, 
fg: 7, fga: 16, ft: 7, fta: 12, three_pointers: 0, threes_attempted: 0, orb: 5, drb: 17, 
ast: 1, stl: 0, blk: 2, tov: 2, pf: 13, pts: 21
}
  model: players.player
  pk: 1
- fields: {team: 7, first_name: Arron, last_name: Afflalo, age: 26, pos: SG, gp: 62, mp: 2086, 
fg: 329, fga: 699, ft: 197, fta: 247, three_pointers: 88, threes_attempted: 221, orb: 40, 
drb: 157, ast: 149, stl: 36, blk: 13, tov: 85, pf: 134, pts: 943
}
  model: players.player
  pk: 2 
```

总的 yaml 文件大约是这个大小的 20 倍（达到 pk:478）。我不认为这有那么大，但是即使我有一个非常快的网络连接（1 Mbps），加载到数据存储区也需要非常长的时间（几分钟）。

最重要的是，在加载它之后，我检查了 Google App Engine 上的仪表板，它说我已经对数据存储执行了 04 万次写入操作。根据我的计算，鉴于上面有 21 个字段，加上 1 个用于 pk，乘以 478 个模型实例，我应该只执行大约 10K 写入，而不是 40K。

是否因为我使用 django-dbindexer 为 first_name 和 last_name 字段添加索引而发生了额外的写入？如果是这样，这就是为什么加载我的数据需要这么长时间吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T05:19:16.717

远程 API 真的很慢。如果您阅读旧的 google-appengine-python 邮件列表（您可以在 Google Groups 中找到它），就会发现它对于大量数据传输没有用处。API 最终会为每个读取或写入请求发出 HTTP 请求。所以这是众所周知的。bulkloader 似乎是加载海量数据的方式（我没有亲自尝试过）。

您的写入取决于您拥有的索引属性的数量，而这又取决于您拥有的索引数量。dbindexer 可能正在添加其他索引字段。您应该能够使用 Datastore Admin 查看数据存储中的实际实体，以查看它们是否具有 dbindexer 生成的字段。如果是 dbindexer 的错，您会看到像“idxf_first_name_iexact”这样的额外字段。

更有可能的是，您正在执行一些复杂的查询，需要为每个实体编写额外的索引。您应该能够查看管理员中的 Datastore Indexes 页面，以查看您为每个实体编写的额外索引的数量。

索引增长速度比您预期快的另一种方式是，如果您有一个索引列表属性，但它看起来不像您拥有它。

我建议您对 dbindexer 持怀疑态度。我没有广泛使用它，但是它可以为你做的 JOIN 操作不会很好地扩展，所以在我看来，它只是一个玩具而不是一个可用的功能。您可能仍然可以使用它来做一些事情。例如，如果您想进行不区分大小写的搜索，它会自动为您添加一个“iexact”字段，而不必手动执行此操作。

# python - 使用 Python 获取设备的物理位置？

> ID：11787941
> 
> 赞同：3
> 
> 时间：2012-08-03T01:03:31.733
> 
> 标签：python, geolocation

有没有办法使用 Python 获取计算机的物理位置，最好没有 API，或者使用免费的 API？我搜索了一下，发现唯一的免费 API 非常非常不准确。我只需要这个有点准确，因为它是为了获得当地的天气。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T02:35:29.873

您可以尝试将[MaxMind 的 GeoIP Python API](http://www.maxmind.com/app/python)与他们的免费[G​​eoLite City 数据库](http://www.maxmind.com/app/geolite)一起使用。准确性可能会有所不同，更多[详细信息请点击此处](http://www.maxmind.com/app/geolite_city_accuracy)。

另请查看[此问题](https://stackoverflow.com/q/2543018/222758)以获取其他选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-01T18:44:37.710

```
import urllib2
import json

# Automatically geolocate the connecting IP
f = urllib2.urlopen('http://freegeoip.net/json/')
json_string = f.read()
f.close()
location = json.loads(json_string)
print(location)
location_city = location['city']
location_state = location['region_name']
location_country = location['country_name']
location_zip = location['zipcode'] 
```

将 HTTP GET 请求发送到：freegeoip.net/{format}/{ip_or_hostname} 以接收 Python 可以解析的 JSON 输出。

我得到以下 JSON 密钥，这应该足以满足您的需要：

*   ip
*   国家代码
*   国家的名字
*   区域代码
*   区域名称
*   城市
*   邮政编码
*   纬度
*   经度
*   地铁代码
*   区号

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T01:07:00.330

例如，您可以从[http://www.geoiptool.com/](http://www.geoiptool.com/)之类的网页上抓取它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T01:39:55.980

我重新发现了另一个我不太喜欢的天气 API（Weather Underground），但可以选择确定位置。如果我无法使用 geoiptool 刮板之类的东西，可以使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-15T08:29:11.287

如果您知道设备的公共 IP，那么您可以使用[freegeip](https://freegeoip.net/)来做到这一点。下面是获取位置和时区的 Python 3.4.2 代码。

```
>>> import requests
>>> ip = '141.70.111.66'
>>> url = 'http://freegeoip.net/json/'+ip
>>> r = requests.get(url)
>>> js = r.json()
>>> js['country_code']
'DE'
>>> js['country_name']
'Germany'
>>> js['time_zone']
'Europe/Berlin'
>>> js['city']
'Stuttgart'
>>> js.items()
dict_items([('latitude', 48.7667), ('ip', '141.70.111.66'), ('region_code', 'BW'), ('country_code', 'DE'), ('city', 'Stuttgart'), ('zip_code', '70173'), ('country_name', 'Germany'), ('longitude', 9.1833), ('region_name', 'Baden-Württemberg Region'), ('time_zone', 'Europe/Berlin'), ('metro_code', 0)]) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-19T04:02:03.530

进入 [https://python-visualization.github.io/folium/plugins.html](https://python-visualization.github.io/folium/plugins.html) 找到，我的朋友 folium.plugins.LocateControl 非常容易

# php - 我可以使用 img 标记的来源使用 PHP 从 URL 捕获图像吗？

> ID：11787944
> 
> 赞同：0
> 
> 时间：2012-08-03T01:03:57.207
> 
> 标签：php, xml, image, rss

假设我可以从任意 URL 获取图像的图像源。也就是说，如果 URL 有一个标签，例如

```
<img src="image.jpeg" /> 
```

我可以`image.jpeg`将它与 URL 结合起来，以便生成该图像的副本并将其存储在我的服务器上吗？我想做的是从不同的网页抓取文章，但我希望每篇文章都有一张相关的照片。我已经看到了一些可以做到这一点的网络服务（Digg），但是有没有办法用 PHP 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:13:14.433

如果你有 src 那么你可以做一个简单的

```
$image = file_get_contents('http://www.someplace.com/image.jpg');

file_put_contents('/images/image.jpg', $image); 
```

# ruby-on-rails - 邮件程序类的 Resque_mailer 未定义方法“执行”

> ID：11787945
> 
> 赞同：1
> 
> 时间：2012-08-03T01:04:00.190
> 
> 标签：ruby-on-rails, resque

我正在尝试使用 Resque 和[Resque_mailer](https://github.com/zapnap/resque_mailer/) gem 发送电子邮件，但发送电子邮件作业在排队后失败。我已经用谷歌搜索、stackoverflowed 并测试了许多不同的代码实现，但到目前为止没有任何效果。

我有以下实现：

版本：rails (3.2.6) resque (1.21.0) resque_mailer (2.1.0)

控制器代码：

```
def send_newsletter 
  User.find_in_batches(:batch_size => 1000) do |users| 
     users.each { |user| AdminMailer.newsletter(user.email).deliver } 
  end 
end 
```

邮寄代码：

```
class AdminMailer < ActionMailer::Base 
     include Resque::Mailer 

  def newsletter(user_email) 
   mail(:to => user_email, :subject => "New Feature", :from => "noreply@example.com") 
  end

end 
```

作业正在排队（我可以在邮件队列的 Web 界面中看到它们），但是失败了。这是失败的错误消息：

```
Exception: NoMethodError 
Error: undefined method `perform' for AdminMailer:Class 
```

这很奇怪，因为在我的本地开发机器中，这些工作正在顺利完成。我有什么东西不能让它在engineyard的生产中工作吗？

我已经运行了其他不包括发送电子邮件或使用 resque_email 的 resque 作业。

我真的很感激任何帮助，在此先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:02:02.637

修复了问题：

问题是在生产中，当我将应用程序部署到 EngineYard 时，Resque 进程没有正确重新启动。

EngineYard 具有部署挂钩，您可以在部署过程中的特定时间点运行代码。

在`after_symlink`部署挂钩中，要运行的正确代码是：`sudo "monit restart all -g app_name_resque"`. `app_name`您的应用程序的名称在哪里。此外，在`before_restart`部署挂钩中，您需要运行：`run "sudo monit start all -g fractalresque_resque"`

这为我解决了这个问题！

# android - 我的活动没有显示线

> ID：11787952
> 
> 赞同：2
> 
> 时间：2012-08-03T01:05:36.267
> 
> 标签：android, android-activity, line, draw

我编写了以下代码，但输出什么也没显示。没有任何异常抛出，也没有使用此代码绘制线条。请帮助我哪里错了？？？

**主班**

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    View custom_view = (View) findViewById(R.id.custom_view);

    Paint p = new Paint();
    p.setColor(Color.BLACK);
    p.setStyle(Paint.Style.STROKE);
    p.setStrokeWidth((float)5);
    Canvas canvas = new Canvas();
    canvas.drawColor(Color.BLUE);

    canvas.drawLine((float)0, (float)0, (float)100, (float)100, p);
    custom_view.draw(canvas);

} 
```

**activity_main.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#00000010" >

<View
    android:id="@+id/custom_view"
    android:background="#cccccc"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true" /></RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:14:43.843

我认为问题在于您需要为您的`View`

尝试类似：

```
public class CustomView extends View{

private Paint p;

public CustomView(Context context, AttributeSet attrs) {
    super(context, attrs); 

    init();        
}

public CustomView(Context context){
    super(context);     

    init();
}

private void init() {       

    p = new Paint();
    p.setColor(Color.WHITE);
    p.setStyle(Paint.Style.STROKE);
    p.setStrokeWidth(5);
    p.setAntiAlias(true);
}

@Override
protected void onDraw(Canvas canvas) {

    super.onDraw(canvas);

    canvas.drawLine(0, 0, 100, 100, p);
}
} 
```

在你的活动课上：

```
RelativeLayout mLayout;
CustomView mView;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);      

    mLayout = (RelativeLayout)findViewById(R.id.rootLayout);
    mView = new CustomView(this);
    mLayout.addView(mView);
} 
```

并将一个 Id 放到`rootLayout`.

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout     
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/rootLayout"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<View
    android:id="@+id/custom_view"
    android:background="#000000"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"    
/>
</RelativeLayout> 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T12:49:18.013

**布局**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >

    <RelativeLayout
        android:id="@+id/camera_preview"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <com.example.drawingapp.CameraView
            android:id="@+id/cameraView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true" />

    </RelativeLayout>

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="20dp"
        android:layout_marginTop="152dp"
        android:contentDescription="@string/app_name"
        android:src="@drawable/ic_launcher" />

    <Button
        android:id="@+id/button_capture"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:text="@string/capture" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginTop="152dp"
        android:text="@string/app_name" />

</RelativeLayout> 
```

**自定义视图类**

```
public class CameraView extends View {

    private Paint p;
    int width = 0;
    int height = 0;
    int pass = 0;
    int xpos = 0;
    int ypos = 0;

    public CameraView(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
        p = new Paint();
        p.setColor(Color.WHITE);
        p.setStyle(Paint.Style.STROKE);
        p.setStrokeWidth(1);
        p.setAntiAlias(true);
    }

    public CameraView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        p = new Paint();
        p.setColor(Color.WHITE);
        p.setStyle(Paint.Style.STROKE);
        p.setStrokeWidth(1);
        p.setAntiAlias(true);
    }

    public CameraView(Context context, AttributeSet attrs) {
        super(context, attrs);
        p = new Paint();
        p.setColor(Color.WHITE);
        p.setStyle(Paint.Style.STROKE);
        p.setStrokeWidth(1);
        p.setAntiAlias(true);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        // TODO Auto-generated method stub
        super.onDraw(canvas);
        width = getWidth();
        height = getHeight();
        xpos = width / 5;
        ypos = height / 5;
        for (int i = 0; i < 5; i++) {

            p.setColor(Color.argb(100, 255, 255, 255));
            canvas.drawLine(xpos + (xpos * i), 0, xpos + (xpos * i),
                    height, p);
            // canvas.drawLine(startX, startY, stopX, stopY, paint)

        }
        p.setStyle(Style.STROKE);
        for (int i = 0; i < 5; i++) {
            p.setColor(Color.argb(100, 255, 255, 255));
            canvas.drawLine(0, (ypos * pass) + 5, width, (ypos * pass) + 5,
                    p);
            pass++;

        }
    }
    public void hide(){
        Visibility visibility = new Visibility();
        visibility.

    }

} 
```

**活动课**

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);

} 
```

# java - 动作侦听器出错，不确定是什么问题

> ID：11787956
> 
> 赞同：-4
> 
> 时间：2012-08-03T01:05:55.760
> 
> 标签：java

有任何想法吗 ？第 66 行是一个大括号，你会在下面看到它，我在下面用 // 显示它。在 Eclipse 中，它不断出现错误，并且不知道如何摆脱它。有任何想法吗？谢谢！它是在动作监听器之后写的，我忘了关闭它吗？

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class operation extends JFrame{
    private JTextField monday;
    private JTextField tuesday;
    private JTextField wednesday;
    private JTextField thursday;
    private JTextField friday;
    private JTextField saturday;
    private JTextField sunday;
    private JButton finalize;

    public operation(){
        super("Weekly Total Calculator");
        setLayout(new FlowLayout());

        monday = new JTextField("How much you spent Monday", 20);
        monday.setFont(new Font("Ariel", Font.PLAIN, 14));
        add(monday);

        tuesday = new JTextField("How much you spent Tuesday", 20);
        tuesday.setFont(new Font("Ariel", Font.PLAIN, 14));
        add(tuesday);

        wednesday = new JTextField("How much you spent Wednesday", 20);
        wednesday.setFont(new Font("Ariel", Font.PLAIN, 14));
        add(wednesday);

        thursday = new JTextField("How much you spent Thursday", 20);
        thursday.setFont(new Font("Ariel", Font.PLAIN, 14));
        add(thursday);

        friday = new JTextField("How much you spent Friday", 20);
        friday.setFont(new Font("Ariel", Font.PLAIN, 14));
        add(friday);

        saturday = new JTextField("How much you spent Saturday", 20);
        saturday.setFont(new Font("Ariel", Font.PLAIN, 14));
        add(saturday);

        sunday = new JTextField("How much you spent Sunday", 20);
        sunday.setFont(new Font("Ariel", Font.PLAIN, 14));
        add(sunday);

        finalize = new JButton("Calculate!");
        add(finalize);

        finalize.addActionListener(new ActionListener(){
               public void actionPerformed(ActionEvent ae){

                    double mon = Double.parseDouble(monday.getText());
                    double tues = Double.parseDouble(tuesday.getText());
                    double wed = Double.parseDouble(wednesday.getText());
                    double thurs = Double.parseDouble(thursday.getText());
                    double fri = Double.parseDouble(friday.getText());
                    double sat = Double.parseDouble(saturday.getText());
                    double sun = Double.parseDouble(sunday.getText());

                    private double sum = mon + tues + wed + thurs + fri + sat + sun;

                    JOptionPane.showMessageDialog(null, "Your total is " + sum + "!", "Total", JOptionPane.PLAIN_MESSAGE);

               }
        }
        //THIS IS THE ERROR^

    }

} 
```

请帮忙！任何想法都会奏效。我真的不知道这笔交易是什么:(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T01:09:13.680

您正在方法调用中创建一个匿名对象 - 确保在最后关闭方法调用：

```
finalize.addActionListener(new ActionListener(){
       public void actionPerformed(ActionEvent ae){
           // all your stuff
       }
}); // you were missing the ");" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-03T01:09:19.183

我认为问题在于您需要`);`在第 66 行的括号之后添加。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-03T01:10:26.173

失踪”）;”

```
finalize.addActionListener(new ActionListener(){
           public void actionPerformed(ActionEvent ae){

                double mon = Double.parseDouble(monday.getText());
                double tues = Double.parseDouble(tuesday.getText());
                double wed = Double.parseDouble(wednesday.getText());
                double thurs = Double.parseDouble(thursday.getText());
                double fri = Double.parseDouble(friday.getText());
                double sat = Double.parseDouble(saturday.getText());
                double sun = Double.parseDouble(sunday.getText());

                private double sum = mon + tues + wed + thurs + fri + sat + sun;

                JOptionPane.showMessageDialog(null, "Your total is " + sum + "!", "Total", JOptionPane.PLAIN_MESSAGE);

           }
    }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-03T01:09:38.907

您没有关闭用 . 打开的括号`finalize.addActionListener(`，并且缺少分号。

# android - 从数据库填充 AlertDialog，返回数据库值（不是位置）

> ID：11787959
> 
> 赞同：0
> 
> 时间：2012-08-03T01:06:44.510
> 
> 标签：android, listview, android-sqlite, android-alertdialog

我有一个“加载团队”按钮，单击该按钮时，我希望在数据库中弹出一个团队列表。我的问题有三个：

1.  目前我有一个 AlertDialog 在单击按钮时弹出，但我找不到如何从数据库中填充 AlertDialog 的行。（目前为静态列表）
2.  这个问题的第二部分是，一旦我可以填充列表，我想显示两个连接在一起的返回列，如下所示：“团队名称（城市）”或“团队 ID - 团队名称（城市）”。
3.  第三，当他们单击该项目时，我希望它从查询中返回“team_id”列值，而不是列表位置或列表字符串值。

这可能吗？这是我用静态值填充列表的代码：

```
final CharSequence[] team_list = {"Team 1", "Team 2", "Team 3"};

final AlertDialog.Builder load_builder = new AlertDialog.Builder(this);
load_builder.setTitle("@string/pick_team");
load_builder.setItems(team_list, new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int item) {
        Toast.makeText(getApplicationContext(), team_list[item], Toast.LENGTH_SHORT).show();
        // I will sent team_id as parameter to query, to get all data for that team
    }
}); 
```

我进行了广泛的搜索，但似乎找不到正确的答案。如果这作为弹出式 ListView 和/或带有自己的 layout.xml 更好，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T02:51:27.927

我的问题已经解决了。我在对话框中使用了 ListView。我使用了 2 个 ArrayList，一个存储 ListView 的字符串，另一个存储相应的 ID（具有匹配的数组索引）。

team_list.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent">

  <ListView
    android:id="@+id/listview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    />
</LinearLayout> 
```

ManageTeams.java：

```
ArrayList<String> team_results = new ArrayList<String>();
ArrayList<String> team_results_id = new ArrayList<String>();
ListView team_listView;
Dialog listDialog;
...
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.manage_teams);
...
    Button load_btn=(Button)findViewById(R.id.load_team_btn);
    load_btn.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            getTeams();
        }
    });
...
}

public void getTeam(String selected_team_id)
{
    Team team;

    DatabaseHelper db = new DatabaseHelper(this);
    team = db.getTeam(selected_team_id);
    ...
}

public void getTeams()
{
    final String colTeamID="team_id";
    final String colTeamName="team_name";
    final String colCity="city";
    final String colState="state";

    team_results.clear();
    team_results_id.clear();

    DatabaseHelper db = new DatabaseHelper(this);
    Cursor team_list = db.getTeams();

    if (team_list != null )
    {
        if (team_list.moveToFirst())
        {
            int counter = -1;
            do {
                counter = counter + 1;
                // assign strings to array for ListView
            } while (team_list.moveToNext());
        }
    }

    listDialog = new Dialog(this);
    listDialog.setTitle("Select Team");
    LayoutInflater li = (LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View v = li.inflate(R.layout.team_list, null, false);
    listDialog.setContentView(v);
    listDialog.setCancelable(true);

    team_listView = (ListView) listDialog.findViewById(R.id.listview);
    team_listView.setOnItemClickListener(this);
    team_listView.setAdapter(new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1, team_results));
    //now that the dialog is set up, it's time to show it
    listDialog.show();

    db.close();
}
...
public void onItemClick(AdapterView<?> arg0, View arg1, int pos, long arg3)
{
    Log.i("ManageTeams", "onItemSelected");
    getTeam(team_results_id.get(pos));
    listDialog.dismiss();
} 
```

# node.js - 在 Nodejs 中使用 setInterval() 发出 post 请求

> ID：11787960
> 
> 赞同：1
> 
> 时间：2012-08-03T01:06:52.497
> 
> 标签：node.js

所以我想每 5 秒调用一次网络服务（通过 POST 请求）。但是，当我运行下面的代码时，它只提取一次数据，并且不会再次调用请求。知道有什么问题吗？

```
var http = require('http');
var querystring = require('querystring');
var url = require('url')

/*
* web service info
*/
var postData = querystring.stringify({  
    'index' : '-1',
    'status' : '-1',
    'format' :'-1',
}); 

var options = {
    host: 'localhost',
    path: '/WebApp/WebService.asmx/WebMethod',
    method: 'POST',
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded',  
        'Content-Length': postData.length 
    }
};

/*
* Web Service Request Obj
*/
var webServiceReq = http.request(options, function(res) {  

  res.setEncoding('utf8');  

  res.on('data', function (chunk) {  
    console.log('Response: ' + chunk + '\n');  
  });  

});  

var getData= function(){
    webServiceReq.write(postData);
}

// grab the info every 5 seconds
setInterval(getData, 5000); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T03:31:05.317

两个问题：你永远不会通过调用`end()`它来完成你的请求，并且你试图多次重用同一个请求对象。您需要将请求对象的创建移入`getData`，并且需要`end()`在调用`write()`.

您可能会发现 mikeal 的[请求](https://github.com/mikeal/request)库很有用，因为它处理了这样的细节。

# mysql - Apple Search API 返回 JSON 的字符集是什么？

> ID：11787963
> 
> 赞同：1
> 
> 时间：2012-08-03T01:07:16.000
> 
> 标签：mysql, special-characters, itunes-search-api

我正在使用[Apple Search API](http://www.apple.com/itunes/affiliates/resources/documentation/itunes-store-web-service-search-api.html)

并获得一个 JSON，例如[这个链接中的那个](http://itunes.apple.com/search?term=yelp&country=us&entity=software&limit=1)

描述字符串在什么字符集中？如果我想将它存储在 mysql 表中，mysql 必须使用什么字符集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T01:33:45.537

从您链接到的文档中：

> 所有 JSON 结果都编码为 UTF-8。

# java - 将游戏从其类名添加到小程序

> ID：11787965
> 
> 赞同：-1
> 
> 时间：2012-08-03T01:07:34.237
> 
> 标签：java, security, reflection, applet, initialization

我想制作一个小程序，以便它可以用来显示扩展 JPanel 的游戏。此类将成为库的一部分。所以我不知道班级的名字。我不得不动态加载它。这是我当前的实现。

```
package com.gej.core;

import javax.swing.JApplet;
import javax.swing.JOptionPane;

/**
 * Runs a game as an Applet by loading the class dynamically at runtime. The
 * name of the class should be specified as a parameter named game-class.
 * 
 * @author Sri Harsha Chilakapati
 */
public class GApplet extends JApplet {

    private static final long serialVersionUID = 1994280929713148311L;

    String gmname = "";

    public GApplet(String gmname) {
        this.gmname = gmname;
    }

    public GApplet() {
        gmname = "";
    }

    public void init(){
        if (gmname == null || gmname == "") {
            gmname = JOptionPane.showInputDialog("Enter game class name");
        }
        try {
            Class<?> gameClass = getClass().getClassLoader().loadClass(gmname);
            add((Game) gameClass.newInstance());
        } catch (ClassNotFoundException e) {
            System.err.println("Error finding class : " + gmname);
        } catch (InstantiationException e) {
            System.err.println("Error loading class : " + gmname);
        } catch (IllegalAccessException e) {
            System.err.println("Error loading class : " + gmname);
        }
    }
} 
```

我遇到的问题是这在 Applet Viewer 中运行良好，但在任何其他浏览器中都不起作用（在 Firefox、Opera、Epiphany、Internet Explorer、Chrome 上测试）。错误是它说`Applet not initialized`。

## 控制台输出

```
java version "1.6.0_23"
OpenJDK Runtime Environment (IcedTea6 1.11pre) (6b23~pre11-0ubuntu1.11.10.2)
OpenJDK Client VM (build 20.0-b11, mixed mode, sharing)
/build/buildd/icedtea-web-1.1.3/build/../plugin/icedteanp/IcedTeaNPPlugin.cc:631: thread
0xb75368e0: Error: Unknown plugin value requested.
/build/buildd/icedtea-web-1.1.3/build/../plugin/icedteanp/IcedTeaNPPlugin.cc:631: thread 
0xb75368e0: Error: Unknown plugin value requested.
java.util.zip.ZipException: error in opening zip file
    at java.util.zip.ZipFile.open(Native Method)
at java.util.zip.ZipFile.<init>(ZipFile.java:131)
at java.util.jar.JarFile.<init>(JarFile.java:150)
at java.util.jar.JarFile.<init>(JarFile.java:101)
at net.sourceforge.jnlp.tools.JarSigner.verifyJar(JarSigner.java:241)
at net.sourceforge.jnlp.tools.JarSigner.verifyJars(JarSigner.java:201)
at net.sourceforge.jnlp.runtime.JNLPClassLoader$4.run(JNLPClassLoader.java:1145)
at net.sourceforge.jnlp.runtime.JNLPClassLoader$4.run(JNLPClassLoader.java:1143)
at java.security.AccessController.doPrivileged(Native Method)
at net.sourceforge.jnlp.runtime.JNLPClassLoader.addNewJar(JNLPClassLoader.java:1143)
at net.sourceforge.jnlp.runtime.JNLPClassLoader.loadClass(JNLPClassLoader.java:1043)
at net.sourceforge.jnlp.Launcher.createApplet(Launcher.java:712)
at net.sourceforge.jnlp.Launcher.getApplet(Launcher.java:672)
at net.sourceforge.jnlp.Launcher$TgThread.run(Launcher.java:884)
java.security.PrivilegedActionException: java.util.zip.ZipException: error in opening zip file
at java.security.AccessController.doPrivileged(Native Method)
at net.sourceforge.jnlp.runtime.JNLPClassLoader.addNewJar(JNLPClassLoader.java:1143)
at net.sourceforge.jnlp.runtime.JNLPClassLoader.loadClass(JNLPClassLoader.java:1043)
at net.sourceforge.jnlp.Launcher.createApplet(Launcher.java:712)
at net.sourceforge.jnlp.Launcher.getApplet(Launcher.java:672)
at net.sourceforge.jnlp.Launcher$TgThread.run(Launcher.java:884)
Caused by: java.util.zip.ZipException: error in opening zip file
at java.util.zip.ZipFile.open(Native Method)
at java.util.zip.ZipFile.<init>(ZipFile.java:131)
at java.util.jar.JarFile.<init>(JarFile.java:150)
at java.util.jar.JarFile.<init>(JarFile.java:101)
at net.sourceforge.jnlp.tools.JarSigner.verifyJar(JarSigner.java:241)
at net.sourceforge.jnlp.tools.JarSigner.verifyJars(JarSigner.java:201)
at net.sourceforge.jnlp.runtime.JNLPClassLoader$4.run(JNLPClassLoader.java:1145)
at net.sourceforge.jnlp.runtime.JNLPClassLoader$4.run(JNLPClassLoader.java:1143)
... 6 more
net.sourceforge.jnlp.LaunchException: Fatal: Initialization Error: Could not initialize applet.
at net.sourceforge.jnlp.Launcher.createApplet(Launcher.java:728)
at net.sourceforge.jnlp.Launcher.getApplet(Launcher.java:672)
at net.sourceforge.jnlp.Launcher$TgThread.run(Launcher.java:884)
Caused by: java.lang.ClassNotFoundException: com.gej.GApplet
at net.sourceforge.jnlp.runtime.JNLPClassLoader.loadClass(JNLPClassLoader.java:1089)
at net.sourceforge.jnlp.Launcher.createApplet(Launcher.java:712)
... 2 more
Caused by: 
java.lang.ClassNotFoundException: com.gej.GApplet
at net.sourceforge.jnlp.runtime.JNLPClassLoader.loadClass(JNLPClassLoader.java:1089)
at net.sourceforge.jnlp.Launcher.createApplet(Launcher.java:712)
at net.sourceforge.jnlp.Launcher.getApplet(Launcher.java:672)
at net.sourceforge.jnlp.Launcher$TgThread.run(Launcher.java:884)
java.lang.NullPointerException
at net.sourceforge.jnlp.NetxPanel.runLoader(NetxPanel.java:109)
at sun.applet.AppletPanel.run(AppletPanel.java:380)
at net.sourceforge.jnlp.NetxPanel.run(NetxPanel.java:69)
at java.lang.Thread.run(Thread.java:679)
java.lang.NullPointerException
at sun.applet.AppletPanel.run(AppletPanel.java:430)
at net.sourceforge.jnlp.NetxPanel.run(NetxPanel.java:69)
at java.lang.Thread.run(Thread.java:679) 
```

## 更新

我已经通过更新插件设法摆脱了这种情况。这是新的日志。

```
java.security.AccessControlException: access denied (java.util.PropertyPermission sun.java2d.opengl write)
at java.security.AccessControlContext.checkPermission(AccessControlContext.java:393)
at java.security.AccessController.checkPermission(AccessController.java:553)
at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
at net.sourceforge.jnlp.runtime.JNLPSecurityManager.checkPermission(JNLPSecurityManager.java:284)
at java.lang.System.setProperty(System.java:744)
at com.gej.core.Game.init(Game.java:83)
at com.gej.core.Game.<init>(Game.java:69)
at com.breakout.Breakout.<init>(Breakout.java:55)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
at java.lang.Class.newInstance0(Class.java:372)
at java.lang.Class.newInstance(Class.java:325)
at com.gej.core.GApplet.init(GApplet.java:38)
at sun.applet.AppletPanel.run(AppletPanel.java:436)
at net.sourceforge.jnlp.NetxPanel.run(NetxPanel.java:69)
at java.lang.Thread.run(Thread.java:679) 
```

## 解决了

这就是我改变的，它解决了

```
try {
    System.setProperty("sun.java2d.opengl", "true");
} catch (Exception e) {
    // System doesn't support opengl
} 
```

我已经修改了代码，以便仅在窗口或全屏模式下设置属性

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:54:02.250

```
java.security.AccessControlException: access denied 
    (java.util.PropertyPermission sun.java2d.opengl write) 
```

只有受信任的小程序才能设置该属性。对代码进行数字签名。

# sql-order-by - 按价格排序 ASC / DESC 问题

> ID：11787966
> 
> 赞同：0
> 
> 时间：2012-08-03T01:07:49.510
> 
> 标签：sql-order-by, limit

我似乎无法弄清楚为什么我的 ASC / DESC ORDER BY 没有按照我的意愿去做。

如果我单击价格列标题，它会继续订购整个表格数据，甚至超出页面上的限制？我该如何解决？

```
<?php
$c=$_GET['c'];
$s=$_GET['s'];
$d=$_GET['d'];
$l=$_GET['l'];
if($d==1) { $DIRECTION='ASC'; } elseif($d==0) { $DIRECTION='DESC'; } else { $DIRECTION='DESC'; }
if($l>51) { $l=50; } else { $l=$_GET['l']; }
$sql=mysql_query("SELECT id,title,price FROM listings WHERE status IN(0,1,4,5) ORDER BY $s $DIRECTION LIMIT $c,$l"); 
?> 
```

这是网址的样子

```
c=10&s=price&d=1&l=25 
```

所以上面的 url 显示了上升数据中第 10 行的 25 个条目，但是如果我单击价格列标题链接，我会将 ASC 更改为 DESC 并且它可以工作，但它会从最末端获得最低价格或最高价格表数据并忽略 LIMIT 10,25？

它是如何工作的？

提前感谢任何可以帮助强尼的人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:33:14.130

他们确实工作。这就是方式`LIMIT`，`ORDER BY`旨在发挥作用。

也就是说，数据库总是在应用`LIMIT`子句之前对数据进行排序。如果要在`LIMIT`应用后对数据进行排序，有两种选择：

*   使用 PHP 对其进行排序。这可能是一个相对简单的解决方案，如果您想避免数据库做这么多不必要的工作，可能会更好。但是，如果您将结果用作数据流，而不是在使用之前将所有内容读入数组，则可能会有点繁琐。

*   使用子查询。`LIMIT`在这种情况下，您在排序之前强制应用该子句：

    `SELECT * FROM (SELECT id,title,price FROM listings WHERE status IN(0,1,4,5) LIMIT $c,$l) ORDER BY $s $DIRECTION`

# c# - 使用 Mock IDbSet 对实体框架进行单元测试

> ID：11787968
> 
> 赞同：10
> 
> 时间：2012-08-03T01:07:52.787
> 
> 标签：c#, asp.net, unit-testing, mocking, repository

我以前从未真正做过单元测试，而且我在第一次测试时绊倒了。问题是`_repository.Golfers.Count();`总是表明`DbSet`是空的。

我的测试很简单，我只是想添加一个新的高尔夫球手

```
[TestClass]
public class GolferUnitTest //: GolferTestBase
{
    public MockGolfEntities _repository;

    [TestMethod]
    public void ShouldAddNewGolferToRepository()
    {
        _repository = new MockGolfEntities();

        _repository.Golfers = new InMemoryDbSet<Golfer>(CreateFakeGolfers());

        int count = _repository.Golfers.Count();
        _repository.Golfers.Add(_newGolfer);

        Assert.IsTrue(_repository.Golfers.Count() == count + 1);
    }

    private Golfer _newGolfer = new Golfer()
    {
        Index = 8,
        Guid = System.Guid.NewGuid(),
        FirstName = "Jonas",
        LastName = "Persson"
    };
    public static IEnumerable<Golfer> CreateFakeGolfers()
    {
        yield return new Golfer()
        {
            Index = 1,
            FirstName = "Bill",
            LastName = "Clinton",
            Guid = System.Guid.NewGuid()
        };
        yield return new Golfer()
        {
            Index = 2,
            FirstName = "Lee",
            LastName = "Westwood",
            Guid = System.Guid.NewGuid()
        };
        yield return new Golfer()
        {
            Index = 3,
            FirstName = "Justin",
            LastName = "Rose",
            Guid = System.Guid.NewGuid()
        };
    } 
```

我使用实体框架和代码优先构建了一个数据模型。我已经模拟了 IDbSet 的派生类以测试我的上下文（对网上的人行屈膝礼，我记不清了）

```
public class InMemoryDbSet<T> : IDbSet<T> where T : class
{
    readonly HashSet<T> _set;
    readonly IQueryable<T> _queryableSet;

    public InMemoryDbSet() : this(Enumerable.Empty<T>()) { }

    public InMemoryDbSet(IEnumerable<T> entities)
    {
        _set = new HashSet<T>();

        foreach (var entity in entities)
        {
            _set.Add(entity);
        }

        _queryableSet = _set.AsQueryable();
    }

    public T Add(T entity)
    {
        _set.Add(entity);
        return entity;

    }

    public int Count(T entity)
    {
        return _set.Count();
    }

    // bunch of other methods that I don't want to burden you with
} 
```

当我调试并单步执行代码时，我可以看到我实例化了`_repository`并用三个伪造的高尔夫球手填充它，但是当我退出 add 函数时，`_respoistory.Golfers`又是空的。当我添加一个新的高尔夫球手时，`_set.Add(entity)`跑步和高尔夫球手被添加，但又`_respoistory.Golfers`是空的。我在这里想念什么？

**更新**

我很抱歉我是个白痴，但我没有`set`在我的`MockGolfEntities`上下文中实现。我没有的原因是我之前尝试过，但不知道如何，继续前进，然后忘记了。那么，我该如何设置`IDbSet`？这是我尝试过的，但它给了我一个堆栈溢出错误。我觉得自己像个白痴，但我不知道如何编写 set 函数。

```
public class MockGolfEntities : DbContext, IContext
{
    public MockGolfEntities() {}

    public IDbSet<Golfer> Golfers { 
        get {
            return new InMemoryDbSet<Golfer>();
        }
        set {
            this.Golfers = this.Set<Golfer>();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T01:27:52.317

您不需要实现 get/set，以下代码应该足以为您生成上下文。

```
public class MockGolfEntities : DbContext, IContext
{
    public MockGolfEntities() {}

    public IDbSet<Golfer> Golfers { get; set;}

} 
```

我已经实现了您在原始帖子中的代码，一切似乎对我来说都很好——您从哪里获得 InMemoryDbSet 的源代码？我正在使用[NuGet 包 1.3](http://nuget.org/packages/FakeDbSet/1.3)，也许你应该试试那个版本？

# c# - 如何使用反射将未知属性正确转换为从公共基础派生的通用列表？

> ID：11787972
> 
> 赞同：1
> 
> 时间：2012-08-03T01:08:25.890
> 
> 标签：c#, list, generics, reflection, casting

说我有以下内容：

```
public class MyContainer
{
    public string ContainerName { get; set; }
    public IList<Square> MySquares { get; set; }
    public IList<Circle> MyCircles { get; set; }
    public MyContainer()
    {
        MySquares = new List<Square>();
        MyCircles = new List<Circle>();
    }
}

public class Shape
{
    public int Area { get; set; }
}

public class Square : Shape
{
}

public class Circle : Shape
{
} 
```

现在我有一个这样的功能：

```
private static void Collect(MyContainer container)
{
    var properties = container.GetType().GetProperties();
    foreach (var property in properties)
    {
        if (property.PropertyType.IsGenericType &&
            property.PropertyType.GetGenericTypeDefinition() == typeof(IList<>) &&
            typeof(Shape).IsAssignableFrom(property.PropertyType.GetGenericArguments()[0]))
        {
            var t = property.GetValue(container, null) as List<Square>;
            if (t != null)
            {
                foreach (Shape shape in t)
                {
                    Console.WriteLine(shape.Area);
                }
            }
        }
    } 
```

当我到达该`MySquares`物业时，这按我想要的方式工作，但是我希望改用以下方式：

```
var t = property.GetValue(container, null) as List<Shape>; 
```

我希望它会循环遍历具有类似列表的所有 MyContainer 属性。我有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:21:04.467

如果将`GetValue`行更改为以下内容，则可以：

```
var t = property.GetValue(container, null) as IEnumerable<Shape>; 
```

我使用以下代码对其进行了测试：

```
var c = new MyContainer();
c.MySquares.Add(new Square() { Area = 5, });
c.MySquares.Add(new Square() { Area = 7, });
c.MySquares.Add(new Square() { Area = 11, });
c.MyCircles.Add(new Circle() { Area = 1, });
c.MyCircles.Add(new Circle() { Area = 2, });
c.MyCircles.Add(new Circle() { Area = 3, });
Collect(c); 
```

并得到了这些结果：

```
5
7
11
1
2
3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T01:23:12.000

正如我在评论中建议的那样，使用协变接口可以实现这一点。

协方差/逆变：http: [//msdn.microsoft.com/en-us/library/ee207183.aspx](http://msdn.microsoft.com/en-us/library/ee207183.aspx)
另见：[协方差和 IList](https://stackoverflow.com/questions/5832094/covariance-and-ilist)

## 工作样本

```
namespace Covariance
{
    public class MyContainer
    {
        public string ContainerName { get; set; }
        public IList<Square> MySquares { get; set; }
        public IList<Circle> MyCircles { get; set; }
        public MyContainer() {
            MySquares = new List<Square>();
            MyCircles = new List<Circle>();
        }
    }

    public class Shape
    {
        public int Area { get; set; }
    }

    public class Square : Shape
    {
    }

    public class Circle : Shape
    {
    }   

    class Program
    {
        static void Main( string[] args ) {

            MyContainer mc = new MyContainer();
            mc.MyCircles.Add( new Circle { Area = 60 } );

            Collect( mc );
            Console.ReadLine();
        }

        private static void Collect( MyContainer container ) {
            var properties = container.GetType().GetProperties();
            foreach( var property in properties ) {
                if( property.PropertyType.IsGenericType &&
                    property.PropertyType.GetGenericTypeDefinition() == typeof( IList<> ) &&
                    typeof( Shape ).IsAssignableFrom( property.PropertyType.GetGenericArguments()[0] ) ) {
                    var t = property.GetValue( container, null ) as IEnumerable<Shape>;
                    if( t != null ) {
                        foreach( Shape shape in t ) {
                            Console.WriteLine( shape.Area );
                        }
                    }
                }
            }
        }
    }
} 
```

# jsf - primefaces NoClassDefFoundError:SelectEvent 错误

> ID：11787977
> 
> 赞同：0
> 
> 时间：2012-08-03T01:09:15.397
> 
> 标签：jsf, jsf-2, primefaces

好的，新的 primefaces 错误（对我来说，无论如何）。在启动时我得到：

```
java.lang.NoClassDefFoundError: org/primefaces/event/SelectEvent 
```

我正在使用 primefaces 3.3.1 并且刚刚验证与旧的 primefaces 版本没有冲突。有任何想法吗？下面是导致错误的 .xhtml。

```
<html xmlns="http://www.w3c.org/1999/xhtml"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:p="http://primefaces.org/ui" >    

<h:head>

</h:head>
<h:body>
<center>
<h:form id="form">

<p:dataTable id="personTable" var="client" value="#{tableBean.persons}" paginator="true" rows="5"
             selection="#{tableBean.person}" selectionMode="single">

    <p:ajax event="rowSelect" listener="#{tableBean.onUserSelect}" update=":form:displayf" oncomplete="carDialog.show()" />  

    <p:ajax event="rowUnselect" listener="#{tableBean.onUserUnselect}" update=":form:displayf" />

    <f:facet name="header">
        Click "View" button after selecting a row to see details
    </f:facet>

    <p:column headerText="Name">
        #{client.name}
    </p:column>

    <p:column headerText="Address">
        #{client.address}
    </p:column>

    <p:column headerText="Phone" >
        #{client.phone}
    </p:column>

</p:dataTable>

<p:dialog id="dialog" header="Person Detail" widgetVar="personDialog" resizable="false"  
            showEffect="explode" hideEffect="explode">  

    <h:panelGrid id="displayf" columns="2" cellpadding="4">

        <h:outputText value="Name:" />
        <h:outputText value="#{tableBean.person.name}" />

        <h:outputText value="Address:" />
        <h:outputText value="#{tableBean.person.address}" />

        <h:outputText value="Phone:" />
        <h:outputText value="#{tableBean.person.phone}" />

    </h:panelGrid>
</p:dialog>

</h:form>

</center>
</h:body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T21:04:09.160

好的，答案显然找到了。处理primefaces时：

1.  不要使用 IE9/8 进行测试（或至少不是专门）。我发现一些代码根本无法与 microsoft 一起使用，但可以在 Firefox 中完美运行。

2.  确保您使用的是兼容版本的 primefaces 和 jsf。我正在使用 primefaces 3.3.1 和 mojarra 2.1.1.，但要小心混合和匹配。

3.  此外，primefaces 显然不完全向后兼容。一些较旧的教程可能不适用于较新版本的 primefaces。我注意到当前的用户手册/展示应用程序不能完全适用于旧的 2.2 primefaces 版本。

4.  小心primefaces，它有一些好东西，但它是错误的，版本之间的差异可能导致各种问题。

# c# - XNA 4.0 内容管理器问题

> ID：11787983
> 
> 赞同：0
> 
> 时间：2012-08-03T01:09:58.667
> 
> 标签：c#, visual-studio-2010, xna-4.0

这究竟是做什么的？

```
Content.RootDirectory = "Content"; 
```

以及它与以下内容有何关系：

```
player.Initialize(Content.Load<Texture2D>("player"), playerPosition); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:20:12.470

我将假设您的`Content`对象实际上是一个`ContentManager`用于加载资产的对象。

第一行设置加载内容项目中资产的默认目录。

```
Content.RootDirectory = "Content"; 
```

如果您的内容位于项目结构中的其他位置，这可以避免总是必须指定包含文件夹的完整路径。

开始了解如何使用这些的一个好地方可能是阅读一些[文档](http://msdn.microsoft.com/en-us/library/bb203887)。ContentManager 使[加载内容](http://msdn.microsoft.com/en-us/library/bb203875)变得非常简单。让您的代码更容易阅读的一个好主意是指定您正在加载的内容的类型，例如，

```
player.Initialize(Content.Load<Texture2D>("player"), playerPosition); 
```

这使得更容易理解实际加载的内容，因为在加载资产时省略了文件扩展名。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T01:15:13.153

```
Content.RootDirectory = "Content"; 
```

“内容”是物理存储图像和模型资产的文件夹/目录。您的解决方案中应该有一个使用新 XNA 解决方案自动创建的目录。

```
player.Initialize(Content.Load("player"), playerPosition); 
```

在这里，一个播放器（我假设是自定义类）正在使用要显示的资产名称（“播放器”）进行初始化，并且它在 2D/3D 空间中的位置。

本质上，第一段代码告诉编译器所有内容都在哪里，而第二段代码为播放器类加载资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T01:20:05.943

```
Content.RootDirectory = "Content"; 
```

它为`ContentMaganer`. 在您的 XNA 解决方案中，您通常有 2 个项目。一个是您的所有逻辑所在的项目，第二个是您放置所有纹理、字体、声音等的内容项目。如果您设置该内容管理器，它将在那里查看以加载资产。

```
player.Initialize(Content.Load("player"), playerPosition); 
```

这里`ContentManager`的游戏正在加载播放器以进行播放器初始化。如果您设置 RootDirectory 然后`ContentManager`将加载`Content.Load("Content/player")`

# android - 在 ListView 中放置 GestureDetector 的位置

> ID：11787993
> 
> 赞同：1
> 
> 时间：2012-08-03T01:12:24.693
> 
> 标签：android

我有一个 ListView，我想检测手势。基本上是对列表项的水平滑动。现在我只是膨胀列表视图并拥有一个 ViewHolder。我应该将 GestureDetector 放在哪里？它应该是 ViewHolder 的变量吗？没有单独的视图类。应该实现什么回调方法？活动？我的 ListItems 所拥有的只是适配器中的 ViewHolder。是否还通过 onFling() 检测到滑动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T02:13:57.493

将您的手势检测器放在 ListActivity/ListFragment 中，并使用它来确定哪个列表项被抛出。当您实现 GestureDetector 时，它可能会干扰正常的触摸事件，因此最好为点击事件覆盖 onSingleTapUp。

编辑：这已在别处得到[回答](https://stackoverflow.com/questions/3921138/gesture-in-listview-android)

# asp.net - 获取错误请求实体太大

> ID：11787997
> 
> 赞同：1
> 
> 时间：2012-08-03T01:13:22.873
> 
> 标签：asp.net, ajax

我正在使用此命令从一个页面重定向到另一个页面。

```
Response.Redirect("~/Viewer/ViewerTest.aspx"); 
```

有时，我被重定向到此页面，有时，我没有。实际上很少，我被重定向到这个页面。如果我没有被重定向，我会收到一个错误

> 由于请求实体太大，页面未显示

我试图通过放置实际项目名称而不是波浪号来使用此命令，但有时它有时会起作用，但它不会。

```
Response.Redirect("~/Viewer/ViewerTest.aspx"); 
```

与上面的命令一起，我传递了一个查询字符串，查询字符串的值很小，它是`Id=<the calculated value>`不超过 100 的整数值。

此外，此错误不会出现在开发计算机上，仅出现在我的生产计算机上。我的开发计算机工作正常。生产计算机有 Windows Server 2008，我的开发计算机有 XP。Internet Explorer 版本为 7.0

任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T05:22:35.897

有时会，有时不会？

请求实体主体变大

1.  当您从网页上传大文件时

2.  当您提交包含大量内容的网页时

在 IIS7.5 上的 applicationHost.config 文件中设置`uploadReadAheadSize`可以解决这两种情况下的问题。您可以直接在 applicationhost.config 中修改此值或使用此命令：

```
appcmd.exe set config -section:system.webserver/serverruntime/uploadreadaheadsize: 1048576 /commit:apphost 
```

# delphi - 用数据库查询中的列填充 TListBox

> ID：11787998
> 
> 赞同：2
> 
> 时间：2012-08-03T01:13:23.537
> 
> 标签：delphi, mydac

我在我的数据库中创建了一个带有**MYDAC**组件的表并添加了数据。我如何从该表中提取这些列中的值？

我试过这些，但没有用；

```
 MyQuery1.Close;
 MyQuery1.SQL.Text :='SELECT * FROM uyeler ORDER BY site';
 Listbox1.Items.Add(MyQuery1.ParamByName('site').AsString);
 MyQuery1.Execute; 
```

uyeler = 表

站点 = 列

编者注：根据对已接受答案的评论，此问题是询问如何`TListBox`使用查询列中返回的数据填充 a 。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T01:22:28.567

你的问题有点不清楚。您询问如何将列数据添加到 a `TListBox`，但您的代码示例显示了一些关于 的内容`ParamByName`，看起来您正在尝试为`ListBox`SQL 参数分配一个值。

**注意**：根据对此回复的评论澄清了问题。第一个代码回答了这个问题；我将把第二个作为示例留给未来的读者，因为它已经写好了。

如果您尝试`TListBox`从数据库列填充 a，则需要运行查询，然后循环遍历数据以将列数据添加到您的`TListBox`. `SELECT *`（当您只打算使用该列时也不应该这样做`site`；这意味着当数据永远不会被使用并最终被丢弃时，额外的数据会从数据库发送到应用程序。）

这应该可以帮助您入门：

```
MyQuery1.Close;
MyQuery1.SQL.Text := 'SELECT site FROM uyeler ORDER BY site';
try
  MyQuery1.Open;
  ListBox1.Items.Clear;
  while not MyQuery1.Eof do
  begin
    ListBox1.Items.Add(MyQuery1.Fields[0].AsString);
    MyQuery1.Next;
  end;
finally
  MyQuery1.Close;
end; 
```

如果您尝试执行第二个操作（使用 a 中的值填充参数`TListBox`），这应该会有所帮助：

```
// to shorten typing of long lines
var
  Site: string;
begin
  if ListBox1.ItemIndex <> -1 then
  begin
    MyQuery1.Close;
    MyQuery1.SQL.Clear;
    MyQuery1.SQL.Add('SELECT Column1, Column2, site FROM uyeler');
    MyQuery1.SQL.Add('WHERE site = :siteval ORDER BY site');
    Site := ListBox1.Items[ListBox1.ItemIndex];
    MyQuery1.ParamByName('siteval').AsString := Site;
    MyQuery1.Open;
    try
      // Use the database rows here
    finally
      MyQuery1.Close;
    end;
  end;
end; 
```