# StackOverflow 问答 12173000-12173999

# mysql - Mysql - 范围查询和排序

> ID：12173000
> 
> 赞同：0
> 
> 时间：2012-08-29T07:38:55.147
> 
> 标签：mysql

对于下一个查询：

```
SELECT m.id, m.body, m.poster, m.added 
   FROM messages m
   WHERE  ((m.poster_id = '11' OR m.poster_id = '22') AND (m.to = '11' OR m.to = '22'))
   ORDER BY m.id DESC
   LIMIT 10 
```

什么是最好的索引？

我试过 (poster_id, to, id) - 大约 1.5s 试过 (poster_id, to) - 大约 0,10s

如果我删除订单，我会得到 0.00s

问题是即使在空结果上，使用 ORDER BY，我仍然得到 0,09s。

解释：

```
+----+-------------+-------+-------+------------------------------+-----------------+---------+------+------+-----------------------------+
| id | select_type | table | type  | possible_keys                | key             | key_len | ref  | rows | Extra                       |
+----+-------------+-------+-------+------------------------------+-----------------+---------+------+------+-----------------------------+
|  1 | SIMPLE      | m     | range | posterid_to_idx,to,poster_id | posterid_to_idx | 8       | NULL |    4 | Using where; Using filesort |
+----+-------------+-------+-------+------------------------------+-----------------+---------+------+------+-----------------------------+ 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T07:43:41.387

尝试简化您的查询，

```
SELECT m.id, m.body, m.poster, m.added 
FROM messages m
WHERE  m.poster_id IN ('11', '22') AND 
       m.to = IN ('11', '22')
ORDER BY m.id DESC
LIMIT 10 
```

`m.id`在(*单独*)、`m.poster_id`和上添加索引`m.to`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T07:44:14.847

`IN`您可能需要使用子句重新编写查询：

```
SELECT m.id, m.body, m.poster, m.added 
FROM messages m
WHERE  m.poster_id IN(11, 22) AND 
        m.to IN(11, 22)
ORDER BY m.id DESC
LIMIT 10; 
```

添加以下[覆盖指数](https://stackoverflow.com/questions/11578241/is-there-any-way-to-check-the-performance-of-mysql-indexing/11578264#11578264)以获得最佳性能：

```
ALTER TABLE messages  ADD KEY ix1(poster_id, to, id, body, poster, added) 
```

对于快速插入，您可以尝试正常索引：

```
ALTER TABLE messages  ADD KEY ix1(poster_id, to, id); 
```

# xcode - 当函数具有@try @catch 时，xcode4 分析不起作用

> ID：12173001
> 
> 赞同：0
> 
> 时间：2012-08-29T07:38:55.547
> 
> 标签：xcode, analyzer

我有一个关于 XCODE 分析命令的问题。

当一个函数有@try @catch 时，即使@try @catch 中没有代码，analyze 也不会检查这个函数。

```
// ok
- (void) testAnalyze {
    // has tip for leak
    Actor *rb = [[Actor alloc] init];
}

// wrong
- (void) testAnalyze {
    // no tip for leak
    Actor *rb = [[Actor alloc] init];

    @try {
    }
    @catch (NSException *exception) {

    }
} 
```

是我设置错误的 Xcode 设置吗？

太感谢了！

ps：我的XCODE版本是4.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:13:53.390

`@try {...} @catch {...} @finally {...}`块还没有在*Clang 静态分析器*中实现：http : [//lists.cs.uiuc.edu/pipermail/cfe-dev/2009-May/005173.html](http://lists.cs.uiuc.edu/pipermail/cfe-dev/2009-May/005173.html)

# objective-c - 在 Objective-C 中将 id 转换为 sockaddr 结构

> ID：12173006
> 
> 赞同：0
> 
> 时间：2012-08-29T07:39:42.080
> 
> 标签：objective-c, macos, sockets, networking

我正在使用`NSNetService`，当我尝试解析服务时，我得到一个`NSNetService`对象，其中包含一个 NSArray 的`ID`描述`struct sockaddr`。

如何将 中`id`包含的对象转换`NSArray`为 struct `sockaddr`。这是我卡住的代码。

```
- (void)netServiceDidResolveAddress:(NSNetService *)sender{

    //Obviously this row return an error...
    struct sockaddr sk = (struct sockaddr)[sender.addresses objectAtIndex:0];
    ....
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:51:04.383

该数组包含 NSData 对象，您可以将其转换为以下结构：

```
struct sockaddr *sk = (struct sockaddr *)[[sender.addresses objectAtIndex:0] bytes]; 
```

# c# - 多次使用时存储 O(1) 哈希查找的结果是一种好习惯吗？

> ID：12173007
> 
> 赞同：2
> 
> 时间：2012-08-29T07:39:44.153
> 
> 标签：c#, .net, performance, design-patterns, dictionary

我正在使用哈希集结构进行映射：`Dictionary<string, string>`.

如果我需要在连续语句中多次读取 myHashset["key1"] 的值，那么使用局部变量存储第一次查找是否是一种好习惯？

**编辑**：没有其他线程会修改字典，所以它不是一个重要的标准。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T07:41:10.987

是的。

`O(1)`简单地说，无论有多少项目，操作都需要相同的时间。
这*并不*意味着它所花费的时间与简单地访问局部变量一样快。

此外，请考虑以下事项：

1.  访问局部变量更具可读性
2.  `TryGetValue`通常，您希望在通过键访问字典中的值时进行错误处理甚至使用。使用局部变量时，您可以将此代码保存在一个地方，而不必将其涂抹在整个方法中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T07:41:44.357

是的：

*   它避免了耗时的多次 O(1) 查找
*   它比`dictionary["key"]`每次写都更具可读性

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T07:43:07.830

这是一个很好的做法，至少有两个原因：

*   字典并不是真正的 O(1)。数据在内部被划分为小集合，字典通过哈希码知道要在哪个集合中搜索。尽管如此，还是涉及到一个内部集合枚举，因此该操作不是免费的（虽然不贵）

*   该值可以从另一个线程修改。保留引用有助于使您的代码线程安全并防止意外结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T08:13:29.663

执行 n 次 O(1) 操作是 O(n)！

这是一个小优化，但并非每个小优化都是过早的。确实会节省时间。

> 编辑：没有其他线程会修改字典，所以它不是一个重要的标准。

也许不是手头的案例，但就什么是良好实践而言，我们必须考虑比手头的案例更广泛的案例——使某些东西成为“良好实践”的部分原因在于它涵盖了大量具有类似只有当我们知道我们为什么这样做时，我们才会离开的代码。

没有线程，我们的原因是：

1.  我们以相同的结果重复使用相同的代码。
2.  编译器不太可能意识到这一点并为我们重写一次调用。
3.  它可以增加可读性。

最后一点值得考虑。变量的每次命名都是使代码自我记录的机会。发生了什么更清楚：

```
CheckUpdated(dict[passedValue.split('\t')[1].Trim().ToUpperInvariant()]);
MarkLastCheckTime(dict[passedValue.split('\t')[1].Trim().ToUpperInvariant()]);
return GetStatus(dict[passedValue.split('\t')[1].Trim().ToUpperInvariant()]; 
```

或者：

```
var purchaseOrderCode = dict[passedValue.split('\t')[1].Trim().ToUpperInvariant()];
CheckUpdated(purchaseOrderCode);
MarkLastCheckTime(purchaseOrderCode);
return GetStatus(purchaseOrderCode); 
```

在第一种情况下，我有点刻意神秘，即使我一直在使用同一个字典，我也应该只做一次这样的工作，但是实际代码中较小的影响更大，因为它是一个充满真实的源文件代码而不是四行示例。

使用线程，它变成了一个问题：

1.  如果我们需要与可能的变化交错，我们不能这样做。
2.  否则，它消除了来自线程的许多风险，因为我们正在处理本地并且知道它将始终是相同的本地。

因此，虽然一些线程案例缓解了这种方法，而且很多人坚持使用它，它不再是一种优化，而是正确性所必需的。

知道我们所处的情况并考虑其他线程确实变得更加复杂 - 因为在某些情况下，如果另一个线程更新了字典，我们确实希望允许相关对象发生变化。但大多数情况下，我们真的想确保在面对来自其他线程的更改时继续处理同一个对象。

所以，虽然在这里并不重要，但它仍然是它通常是良好实践的一个原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T07:43:36.970

是的...

你自己有答案。它将帮助并节省微秒和 CPU 周期。:)

# c++ - 使用 Eclipse 可执行文件随机使用 c++11 的核心转储

> ID：12173010
> 
> 赞同：0
> 
> 时间：2012-08-29T07:39:58.743
> 
> 标签：c++, eclipse, bash, c++11

我一直在试验 c++11 随机库，遇到了一个奇怪的问题。我的代码编译良好并在 Eclipse 中运行，但是一旦我尝试在 shell 中运行可执行文件（在本例中为 linux 上的 bash），我就会得到一个核心转储。我检查了 Eclipse 中是否有任何特殊的环境变量，但似乎不是这样。

我不起眼的代码：

```
std::mt19937 eng(time(NULL));
std::uniform_int_distribution<int> uniformEnergy(0,E.size()-1);
std::uniform_real_distribution<double> uniformProb(0,0.1);
for (int i = 0; i < 10; i++) {
    int E_r = uniformEnergy(eng);
    float p_r = uniformProb(eng);
    ... 
```

还有 seg 错误，在 random.h 中有一个看似无限的（我在 4000 之后放弃了）堆栈：

```
#0  0x0000000000403af4 in std::uniform_int_distribution<int>::param_type::b (
this=<error reading variable: Cannot access memory at address 0x7fffc1381ff8>) 
at /usr/include/c++/4.6/bits/random.h:1636 
1636        b() const 
```

在我的终端中可能有什么问题，但在 Eclipse 中却可以很好地工作？

**编辑：** 我尝试自己编译代码，它工作正常，让我相信 eclipse 制作的可执行文件出于某种原因是不好的。有任何想法吗？ **编辑 2**这对我来说当然是一个愚蠢的错误： E.size() 根据我运行的目录而有所不同，导致（可能）它为零。

捂脸..

# java - 将图标和分隔符添加到 Windows XP 右键单击 上下文菜单

> ID：12173011
> 
> 赞同：1
> 
> 时间：2012-08-29T07:40:08.603
> 
> 标签：java, windows, registry, contextmenu

我需要在我添加到 Windows XP 的右键菜单的菜单项之前和之后添加一个图标到自定义右键单击上下文菜单和一个分隔符，

我找到了一些适用于 windows 7 的解决方案，但我正在搜索 windows XP，请帮助。

例如，我们可以看到 Tortoise SVN 的图像也是菜单项前后的分隔符。

![在此处输入图像描述](../Images/7b3f29e6344c901d3a1e62ae27aeb7af.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:15:23.957

尝试[将自定义条目添加到 Windows XP 资源管理器上下文菜单](http://www.tek-tips.com/viewthread.cfm?qid=1674913)

[这](http://www.askvg.com/a-complete-tutorial-to-customize-desktop-context-menu-in-windows-xp-using-resource-hacker/)也可能对您有所帮助。

您可以使用[Ultimate Windows 上下文菜单定制器自定义上下文菜单](http://www.door2windows.com/ultimate-windows-context-menu-customizer-customize-context-menu-in-windows-xp-vista-7/)

# maven - 如何使用命令在 ubuntu 中更新 maven

> ID：12173013
> 
> 赞同：10
> 
> 时间：2012-08-29T07:40:16.473
> 
> 标签：maven, ubuntu

我使用的是 Ubuntu 11.10，并且安装了 Maven 3.0.3。现在我想将它更新到 Maven 3.0.4 由于一些万无一失的插件问题。但我不知道如何从命令行执行此操作。

有人知道吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-03-21T16:03:34.723

我刚刚完成了......我现在交换了 Maven 3.0.3 Maven 3.2.1 我做了以下步骤：

1.  删除旧的 Maven 版本：

    ```
    > sudo apt-get remove maven
    > sudo apt-get update 
    ```

2.  安装新版本：现在我提高了对 linux 的了解，我更喜欢手动安装软件；）所以...我按照[http://maven.apache.org/download.cgi](http://maven.apache.org/download.cgi)
    上的 Apache 安装说明进行操作 ，然后我有了在文件 .baschrc 中添加了这些行：

    ```
     export M2_HOME=/usr/local/apache-maven/apache-maven-3.2.1
         export M2=$M2_HOME/bin
         export MAVEN_OPTS="-Xmx512m -XX:MaxPermSize=256m"
         export PATH=$PATH:$M2 
    ```

我希望对某人有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T08:37:04.677

您可以在 pom 的 pluginManagement 部分中简单地定义[maven-surefire-plugin](http://maven.apache.org/plugins/maven-surefire-plugin/)版本，或者在公司 pom 中更好地定义。

```
<build>
  <pluginManagement>
    <plugins>
       <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-surefire-plugin</artifactId>
         <version>2.12.3</version>
       </plugin>
       ...
    </plugin>
  </pluginManagmenet>
</build> 
```

如果您还没有公司范围的 pom，那么您的构建是不可重现的，这意味着如果您更改 maven 版本，您的构建将使用不同的插件版本，这对所有插件都是如此。此外，最好在构建中定义插件的版本。无需更新 Maven 本身。如果您遇到 Maven 问题但不是插件问题，您可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T07:46:52.630

Why do you need to do it from the command line? Even if your distribution doesn't provide the update you need, installing Maven only requires downloading an archive, uncompressing it in a suitable folder and setting a couple of environment variables.

You can find the official installation instructions [here](http://maven.apache.org/download.html#Installation)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-01T07:51:42.530

你是正确的效果，你可以同时拥有或更多，并在.profile中切换设置M2_HOME，但我不需要旧的，我认为只有一个更清楚。无论如何，谢谢，也许有人需要一个以上的版本，并且可能会发现这篇文章很有趣。

# jquery - Jquery waypoint 事件不会在页面底部的元素上触发

> ID：12173014
> 
> 赞同：2
> 
> 时间：2012-08-29T07:40:18.010
> 
> 标签：jquery, jquery-plugins, sticky-footer, jquery-waypoints

我正在尝试使用 jquery-waypoint 插件在页脚进入/离开视口时触发事件。

我在[jsfiddle](http://jsfiddle.net/martinffx/whUxB/3/)上创建了一个示例，但该事件不会在页脚元素上触发。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T08:18:27.787

该事件不会被触发，因为航点仅在滚动窗口顶部到达航点时触发。在您的情况下，永远无法到达航点，因为您的 HR 元素永远无法滚动到窗口顶部。

解决此问题的一种方法是为航路点提供偏移参数

```
$(document).ready(function() {
  $('hr').waypoint(function(event, direction) {
    alert(direction);
  }, {offset: 900});
});​ 
```

这将告诉航点在事件实际到达滚动窗口顶部之前 900 像素触发事件。但是该解决方案并不是最佳的，因为它将取决于用户的屏幕分辨率。您可以通过调整浏览器窗口大小来测试它并查看它的性能。

不过有更好的解决方案。不知道你想实现什么，我建议在上一篇文章中设置航点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-01T00:27:43.143

将百分比从顶部传递到`offset:`而不是显式像素从顶部传递。

```
$('containerDiv').waypoint(function() {
        $('targetElem').fadeIn();
    }, { offset: '50%' }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-23T16:04:04.557

如果您希望航点在从底部进入屏幕的元素上触发，请设置`offset: '100%'`

```
 $('hr').waypoint(function(event, direction) {
    // Do something
  }, {offset: "100%"}); 
```

# php - 带有 PGSQL_CONNECT_FORCE_NEW 标志的 pg_connect

> ID：12173015
> 
> 赞同：1
> 
> 时间：2012-08-29T07:40:31.307
> 
> 标签：php, postgresql

我继承了一个用 PHP 编写的 Web 应用程序，它使用 PostgresSQL 作为数据库服务器。我对 PHP 和 PostgresSQL 没有任何经验，我来自 Java / C# 背景。我正在研究它是如何工作的，当我对其进行分析时，我注意到老程序员在每次页面请求期间都会实例化一个名为 Database 的类，在该类中他使用以下方式打开与数据库的连接：

```
$this->connection = pg_connect($qs, PGSQL_CONNECT_FORCE_NEW) 
```

探查器告诉我这是一个非常昂贵的调用（页面在 2.7 秒内加载......），我想知道是否以及何时真正需要标志 PGSQL_CONNECT_FORCE_NEW。由于连接字符串始终相同，因此我尝试使用 pg_pconnect 代替（甚至没有该标志的 pg_connect），并且页面加载时间仅为 741 毫秒。现在一切似乎都很好，但我有点担心这可能会在某个地方破坏应用程序，而且由于我没有 PHP 经验，所以我想知道使用该标志的做法是否有某种意义我需要检查的场景。显然，没有可依赖的单元测试。作为旁注，你知道关于这个 pg_(p)connect 如何真正工作的好资源吗？官方文档似乎不够深入。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:32:21.173

使用时，此常量告诉 pg_connect 每次都创建一个新连接，而不是使用已经打开的连接。这可能表明程序使用了一些与会话相关的功能，例如：

*   postgres 会话变量（[search_path](http://www.postgresql.org/docs/9.1/static/ddl-schemas.html)？）
*   实例化连接时不应存在的临时表
*   （坏）手动使用[序列函数](http://www.postgresql.org/docs/9.1/static/functions-sequence.html)

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T10:48:10.070

警告：pg_pconnect 将在每个 Apache 后端的生命周期内维护一个连接，因此如果您最终获得大量连接，请不要感到惊讶。如果它们最终同时发出查询，则会阻塞数据库服务器。

不过，我从未听说过连接数据库需要 2 秒。我可以在 0.2 秒内启动 psql、连接、发出查询并获得响应，这在我的旧上网本上。检查您的网络设置或类似的设置 - 这里发生了一些奇怪的事情。

# c - 如何在代码中使用白色

> ID：12173016
> 
> 赞同：0
> 
> 时间：2012-08-29T07:40:30.533
> 
> 标签：c, opencv, detect

如何检测 RGB 颜色中的白色？

我的意思是如何更改代码中的颜色或者我应该在代码中更改什么？

此代码检测红色：

```
#include"math.h"
#include"conio.h"
#include"cv.h"
#include"highgui.h"
#include"stdio.h"
int main() {
    int i,j,k;
    int height,width,step,channels;
    int stepr, channelsr;
    int temp=0;
    uchar *data,*datar;
    i=j=k=0;
    IplImage *frame=cvLoadImage("red.jpg",1);
    IplImage *result=cvCreateImage( cvGetSize(frame), 8, 1 );
    if(frame==NULL ) {
        puts("unable to load the frame");exit(0);
    }
    printf("frame loaded");
    cvNamedWindow("original",CV_WINDOW_AUTOSIZE);
    cvNamedWindow("Result",CV_WINDOW_AUTOSIZE);
    height = frame->height;
    width = frame->width;
    step =frame->widthStep;
    channels = frame->nChannels;
    data = (uchar *)frame->imageData;
    stepr=result->widthStep;
    channelsr=result->nChannels;
    datar = (uchar *)result->imageData;
    for(i=0;i < (height);i++) for(j=0;j <(width);j++)
    if(((data[i*step+j*channels+2]) > (29+data[i*step+j*channels])) && 
            ((data[i*step+j*channels+2]) > (29+data[i*step+j*channels+1])))
        datar[i*stepr+j*channelsr]=255;
    else
        datar[i*stepr+j*channelsr]=0;
    cvShowImage("original",frame);
    cvShowImage("Result",result);
    cvSaveImage("result.jpg",result);
    cvWaitKey(0);
    cvDestroyWindow("original");
    cvDestroyWindow("Result");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:23:57.743

如果您检测到 3 个 rgb 通道几乎相等，这将检测从黑色到灰色到白色的颜色。为了检查白色，您可能会检查每个像素

1) 明亮

r > 250 , g > 250, b > 250

2) 颜色几乎相等 abs(r - b) < 2, abs(g - b) < 2, abs(r - g) < 2 *

值 250 和 2 只是一个示例，您应该尝试直到获得满意的结果。

您应该使用与上述等效的代码更改条件

```
if(((data[i*step+j*channels+2]) > (29+data[i*step+j*channels])) && 
        ((data[i*step+j*channels+2]) > (29+data[i*step+j*channels+1])))
    datar[i*stepr+j*channelsr]=255;
else
    datar[i*stepr+j*channelsr]=0; 
```

*笔记; 如果值 r,g,b 是无符号的（在这种情况下它们是），您应该将数字转换为有符号的

绝对（（int）r - g）< 2

# ruby-on-rails - 使用 Carrierwave 上传文件时没有路由匹配错误

> ID：12173020
> 
> 赞同：3
> 
> 时间：2012-08-29T07:40:50.677
> 
> 标签：ruby-on-rails, carrierwave

我有一个简单的文件上传表单，用户应该能够从他们的机器中选择一个 csv 文件，然后将其保存到文件夹中。我正在尝试使用 Carrierwave，而我的应用程序是在 Ruby on Rails 中构建的。

当我尝试保存文件时，我收到错误“没有路由匹配 [POST]”/customers/new”。

这是各种组件。

*/new.html.erb*

```
<%= form_for :dataload, :html => {:multipart => true}  do |f| %>

 <p>
   <%= f.file_field :file %>
 </p>
 <p><%= f.submit %></p>
<% end %> 
```

*/models/dataload.rb*

```
class Dataload < ActiveRecord::Base
    attr_accessible :file_name, :request_user, :source
    mount_uploader :file, CustomerWarrantyUploader
end 
```

*/uploaders/customer_warranty_uploader.rb*

```
class CustomerWarrantyUploader < CarrierWave::Uploader::Base
  storage :file
  def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end
  def extension_white_list
   %w(csv)
  end 
```

*customers_controller.rb（新方法；我没有对此做任何事情）*

```
 def new
    @customer = Customer.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @customer }
    end
  end 
```

这是客户的当前路线

```
 resources :customers 
```

我不确定问题是什么，尝试了各种类似的方法。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T07:26:02.847

原因是因为这条路线真的不存在。资源创建以下路线（[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)）：

```
GET     /customers          index   display a list of all photos
GET     /customers/new      new     return an HTML form for creating a new photo
POST    /customers          create  create a new photo
GET     /customers/:id      show    display a specific photo
GET     /customers/:id/edit edit    return an HTML form for editing a photo
PUT     /customers/:id      update  update a specific photo
DELETE  /customers/:id      destroy delete a specific photo 
```

如您所见，唯一的 POST 路径是 /customers。对您的表格进行简单的调整就可以解决问题。像下面这样的东西应该可以工作：

```
<%= form_for :dataload, { :url => customers_path , :html => {:multipart => true} }  do |f| %> 
```

**编辑：**根据用户评论添加附加信息。

您还需要向控制器添加一些逻辑，以处理上传的文件。基本上，在 Railscast 中，他说*“网站的一部分已经建成：有一个列出画廊的页面，一个指向每个画廊的链接，以及一个显示画廊图片的页面。”* . 这显然也包括一个新的和编辑页面。他的控制器的代码（来自项目源代码 - [http://media.railscasts.com/assets/episodes/sources/253-carrierwave-file-uploads.z​​ip](http://media.railscasts.com/assets/episodes/sources/253-carrierwave-file-uploads.zip)）是：

```
@gallery = Gallery.new(params[:gallery]) 
```

因此，当他添加他的文件时，他将其作为模型上的一个属性，所以他所`attr_accessible :image`要做的就是向模型添加一点，以使控制器自动开始处理图像（因为它通过相同的参数来实现）。由于您的参数来自不同的参数（：dataload），而不是作为模型上的属性，因此您可能需要使用当前技术添加比他更多的代码。也许是这样的：

```
@dataload = Dataload.create(params[:dataload]) 
```

甚至：

```
@dataload = Dataload.process_uploaded_file(params[:dataload]) 
```

然后，您将添加一个`process_uploaded_file`方法来`Dataload`启动您的相关客户创建逻辑......

另一件尚未真正处理的事情是，当数据出现错误时会发生什么。例如，如果上传文件中的 10 个条目中有 2 个创建了无效记录，您会怎么做（以及如何显示错误）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:22:35.033

我很确定它`redirect_to :back`在您的`Dataload`模型中，它必须重定向到`/customer/new`但保持相同的 HTTP 操作，即 a`POST`而不是 a `GET`，因此会出现路由错误。

我不认为你应该在那里有一个重定向（重定向是控制器的领域），但无论你把它放在哪里，你可能需要一个 303 状态代码来强制`GET`：

```
redirect_to :back, :status => 303, alert: "your file is being processed" 
```

从[文档](http://api.rubyonrails.org/classes/ActionController/Redirecting.html#method-i-redirect_to)：

> 如果您使用 GET 或 POST 以外的 XHR 请求并在请求之后进行重定向，则某些浏览器将使用原始请求方法跟随重定向。这可能会导致不良行为，例如双重删除。要解决此问题，您可以返回 303 See Other 状态代码，随后将使用 GET 请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T05:19:30.877

您通过其他控制器创建文件，并且必须 在您的表单中使用
`accepts_nested_attributes_for :dataload, allow_destroy: true`
和使用。`field_for`你也可以使用[nested_form](https://github.com/ryanb/nested_form) gem

# blackberry - 如何在 Blackberry 5.0 中自动滚动图像，如标记文本？

> ID：12173025
> 
> 赞同：0
> 
> 时间：2012-08-29T07:41:18.487
> 
> 标签：blackberry, java-me, blackberry-simulator, blackberry-eclipse-plugin, blackberry-jde

我在 HFM 的 3 个 BitmapFields 中添加 3 个图像。它使用拨轮水平滚动，但我希望图像像字幕文本一样自动滚动。我得到了线程来 [显示像选框这样的滚动文本，](https://stackoverflow.com/questions/2613062/how-can-i-display-scroll-text-like-marque-in-blackberry-using-j2me) 但是如何用图像替换它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:29:09.557

说你的 TimerTask 增加名为**int currentScroll的 scrollAmount**

您必须在自定义字段的绘制方法中处理图像。这是一个图像滚动的示例（如果图像大于您的屏幕）：

```
Bitmap bmp = this.getBitmap1();
int width = bmp .getWidth();
graphics.drawBitmap(0, 0, width , bmp.getHeight(), bmp, currentScroll, 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T10:29:31.497

```
BitmapField imageField = new BitmapField(Bitmap.getBitmapResource("sync.png"),
                Field.FOCUSABLE);

Border imageFieldBorder = BorderFactory.createBevelBorder(edges, new XYEdges(Color.BLACK, Color.BLACK, Color.BLACK,Color.BLACK), new XYEdges(Color.WHITESMOKE, Color.WHITESMOKE,Color.WHITESMOKE, Color.WHITESMOKE));

imageField.setBorder(imageFieldBorder); 
```

您也可以更改边框的颜色

# android - Android：寻找复制/粘贴复杂对象的有效策略

> ID：12173036
> 
> 赞同：3
> 
> 时间：2012-08-29T07:41:47.803
> 
> 标签：android, copy-paste, clipboardmanager

我正在设计一个适用于复杂对象列表的 Android 应用程序。一个对象包括带有一组属性（例如，重要性级别和上次查看时间）的文本或图形数据。我想通过遵循 3 条规则的复制和粘贴功能来帮助我的应用程序：

*   当用户复制对象然后将其粘贴到我的应用程序时，将添加具有相同属性的对象的完整副本。
*   当用户复制一个对象，然后将其粘贴到使用新的复制/粘贴 API (android.content.ClipboardManager) 的其他应用程序时，该应用程序将接收文本或图像，具体取决于对象表示的文本数据还是图形数据。如果是图像，该应用程序将接收文件路径或媒体库内容 URI 形式的图像。
*   当用户复制一个对象，然后将其粘贴到使用老式已弃用 API (android.text.ClipboardManager) 的其他应用程序时，该应用程序将只接收由该对象表示的文本。如果对象表示图像，则该应用程序将接收文本表示形式的 URI，甚至是空文本。

到目前为止，我已经研究了 Google 文档并浏览了各种编程论坛，但没有找到任何关于如何执行此操作的答案或解释它不可行的解释。目前我有两个弊端可供选择：
1）创建一个与对象一起使用的内容提供者，并将内容URI复制到剪贴板。不幸的是，这意味着第 3 方应用程序，为了检索文本或图像，必须知道我的内容提供者的内部组织，我当然不能假设。
2) 仅将文本数据（类型为 ClipDescription.MIMETYPE_TEXT_PLAIN）或仅复制到图像的 URI（类型为 ClipDescription.MIMETYPE_TEXT_URILIST）复制到剪贴板。在这种情况下，粘贴到我自己的应用程序时，我无法保留对象的属性。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T13:13:02.023

使用 a`ContentProvider`是正确的做法。其他应用不需要了解内容的结构或组织：内容 URI 可以用作不透明的标识符，并且（在 API 11 及更高版本中）一个 URI 可以有多种类型。

# 粘贴为文本

如果您实施[`ContentProvider.openTypedAssetFile`](https://developer.android.com/reference/android/content/ContentProvider.html#openTypedAssetFile%28android.net.Uri,%20java.lang.String,%20android.os.Bundle%29)，您的提供商可以将图像提供给请求图像的客户端，并将您的内部数据格式提供给请求您的供应商特定 MIME 类型的客户端。这是`ClipData.Item.coerceToText`用于从任意内容 URI 获取文本的机制：它请求 type `text/*`，并将返回的流读入字符串。（不要尝试复制无限的文本流！）如果此调用失败，它只会放置 URI 本身的文本。旧版`getText`API`coerceToText`也使用此功能。这会整理出您的旧版和纯文本客户端。

# 粘贴为图像

只需要图像的客户端*应该*使用与上述相同的机制，这意味着您`ContentProvider.openTypedAssetFile`将用作文本，但请求类型为`image/*`. 但我不认为您可以依赖每个客户端都这样做，所以我建议您实现[`ContentProvider.getType`](https://developer.android.com/reference/android/content/ContentProvider.html#getType%28android.net.Uri%29)并[`ContentProvider.getStreamTypes`](https://developer.android.com/reference/android/content/ContentProvider.html#getStreamTypes%28android.net.Uri,%20java.lang.String%29)返回该 URI 的图像类型（而不是您的供应商特定类型）。

实现`query`以返回带有名为 (the value of) 的列的游标`MediaStore.Images.ImageColumns.DATA`。`MediaStore.Images.ImageColumns`如果您想将元数据提供给这些客户端，您还可以包含其他列。

然后你只需要实现`openFile`为图像返回一个文件描述符。请务必检查`mode`参数以避免让其他应用程序能够写入您的文件。您可以调用[`ParcelFileDescriptor.open`](https://developer.android.com/reference/android/os/ParcelFileDescriptor.html#open%28java.io.File,%20int%29)以创建`ParcelFileDescriptor`您需要从您拥有的路径返回的内容。

# 粘贴为特定于供应商的对象

这就是处理您服务的所有第三方客户。现在粘贴到您自己的应用程序中怎么样？你可以在这里做两件事。正如我在上一节中提到的，您可以使用[`ContentResolver.openTypedAssetDescriptorFile`](https://developer.android.com/reference/android/content/ContentResolver.html#openTypedAssetFileDescriptor%28android.net.Uri,%20java.lang.String,%20android.os.Bundle%29)来请求您的供应商特定类型，并实现`ContentProvider.openTypedAssetFile`返回该类型的流。如果您的应用程序特定数据是包含序列化数据等的特殊类型的文件，则这是合适的。如果您的特定于应用程序的内容是数据库行，那么您可以使用`query`: 它可以将您喜欢的任何特定于应用程序的数据放入返回的游标中，以及`MediaStore`上面讨论的列。

这些方法中的任何一种都提供了一种方便的方法，可以`ContentProvider`用来从存储机制中抽象出前端。我在一个应用程序中实现共享时这样做了，这是一个非常积极的变化，强加了一个清晰的边界，并迫使我清理我对数据库的所有偷偷摸摸的、违反封装的访问，从而使代码库更易于维护. `Loader`它还使在s、`Adapter`s 和s中使用内置支持变得更容易，`ContentObserver`以减少我的前端代码的大小。

但也许这个强制封装边界对您的应用程序来说是错误的，或者您的粘贴目标需要访问相同的 Java 对象，而不仅仅是游标或序列化数据。在这种情况下，粘贴目标中的代码很容易解析粘贴的 URI 并从中读取标识符。然后它可以直接与您的后端代码对话（使用您拥有的任何现有机制）以获取对相关数据对象的引用：它根本不需要使用`ContentResolver`。

# 结论

所有这一切似乎都像是一大罐要打开的蠕虫，在某种程度上确实如此。但`ContentProvider`如果你只想做一件事，实际上很容易实现，一旦你开始使用它，你可能会发现它可以帮助你解决的其他问题。

# xslt - 检查字符串长度并附加一个字符以使其长度恒定

> ID：12173041
> 
> 赞同：3
> 
> 时间：2012-08-29T07:42:00.097
> 
> 标签：xslt, xslt-1.0

```
<Data>
<AA>123</AA>
  <AA>45658</AA>
  <AA>123456789</AA> 
</Data> 
```

需要的输出：

```
<info>
  <Numbers id="000000123" />
  <Numbers id="000045658" />
  <Numbers id="123456789" />
</info> 
```

健康）状况：

我需要检查元素 AA 的值的字符串长度。如果长度小于 9，我需要附加 '0' 以使其长度为 9 位。

XSLT 写道：

```
<xsl:template match="Data">   
  <info>
       <xsl:for-each select="AA">
              <Numbers>
                <xsl:attribute name="id">
                  <xsl:variable name="numlenght">
                  <xsl:value-of select="string-length(.)" />
                    </xsl:variable>
                  <xsl:choose>
                    <xsl:when test="$numlenght&lt;9">
                      <xsl:variable name="balance">
                        <xsl:value-of select="9-$numlenght"/>
                      </xsl:variable>
                      <xsl:for-each select="//*[position() &lt;$balance]">
                        <xsl:value-of select="'0'"/>
                      </xsl:for-each>

                    </xsl:when>
                                      </xsl:choose>
                  <xsl:value-of select="."/>

                </xsl:attribute>
              </Numbers>
            </xsl:for-each>
  </info>
        </xsl:template> 
```

我没有得到确切的输出。

任何人都可以建议如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T12:15:21.867

**这需要更少的内存**：

```
concat(substring('000000000', string-length() +1), .) 
```

**这是一个完整的转换**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
     <info><xsl:apply-templates/></info>
 </xsl:template>

 <xsl:template match="AA">
  <Numbers id="{concat(substring('000000000', string-length() +1), .)}"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<Data>
    <AA>123</AA>
    <AA>45658</AA>
    <AA>123456789</AA>
</Data> 
```

**产生了想要的正确结果**：

```
<info>
   <Numbers id="000000123"/>
   <Numbers id="000045658"/>
   <Numbers id="123456789"/>
</info> 
```

**说明**：

表达方式：

```
concat(substring('000000000', string-length() +1), .) 
```

**不构造长度大于 9 的字符串**（如在另一个答案中，在此之后提取长度超过 9 个字符的字符串的子字符串）。

相反，它只提取必要的填充`0`字符数，然后将它们连接到当前节点的字符串值。

**请注意**：

**这**：

```
 <Numbers id="{concat(substring('000000000', string-length() +1), .)}"/> 
```

**可以进一步简化为**：

```
 <Numbers id="{substring('000000000', string-length() +1)}{.}"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T07:51:04.053

尝试使用 Concat 和 substring 使其如下所示：

```
susbstring(concat('000000000',yourstring),string-length()-9,9) 
```

# java - 接受输入并匹配相应的文件

> ID：12173044
> 
> 赞同：4
> 
> 时间：2012-08-29T07:42:35.177
> 
> 标签：java, file, input

我有 100 个名为“1.exe”、“2.exe”、“3.exe”、...、“100.exe”的文件我想将用户输入为 1,2,3,... 或100并运行对应的exe文件。例如，如果用户输入 45 ，我将运行文件“45.exe”，我不想使用 ifs 或开关。谁能帮帮我吗。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-29T07:46:23.383

如果输入总是等于你的 exes 的文件名，你可以这样做：

```
if( isInputNumberBetween1And100() )
    Runtime.getRuntime().exec( input + ".exe" ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T07:59:59.713

如果它们在同一个文件夹中，您还可以使用 java.nio.file.Paths 来解决它们：

```
Runtime.getRuntime().exec(Paths.get(getNumberInput() + ".exe").toString()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T12:11:36.463

```
Runtime.getRuntime().exec( input + ".exe" ).waitFor(); 
```

如果您想等待它，它将起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T07:47:56.987

我的 java 有点生锈，请原谅我，但这应该给你一个想法：

通过执行以下操作形成一个字符串：

```
String number = "45"; // or whatever user inputs
String suffix = ".exe";
String file = number + suffix; 
```

然后，一旦你有了字符串，就用它来运行一个进程：

```
Runtime rt = Runtime.getRuntime();
Process p = rt.exec(file); 
```

完成该过程后，将其销毁：

```
p.destroy(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T07:55:15.910

```
// getInputFromUser() is your function with validation 
String processName = getInputFromUser()+".exe";  
Runtime.getRuntime().exec( processName ); 
```

# c# - 键入相同文本时不会触发 TextChanged 事件

> ID：12173050
> 
> 赞同：0
> 
> 时间：2012-08-29T07:43:01.917
> 
> 标签：c#, asp.net, ajax, web-services

我正在研究 ajax 自动扩展器，有一个下拉列表和文本框，一切正常，但是当我要输入文本框“X”时它会产生结果，但是当我更改下拉选择的索引并输入相同的文本“X”时' 在文本框中文本更改事件未触发，任何人知道原因请告诉我，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:18:08.447

TextChanged 事件仅在控件中的文本发生更改并且焦点移出控件时触发。当获得焦点以控制触发 TextChanged 事件时，您可以将控制文本设置为空。

# spring-security - 如何获得由创建的 ExceptionTranslationFilter 的 BeanDefinition

> ID：12173051
> 
> 赞同：4
> 
> 时间：2012-08-29T07:43:05.333
> 
> 标签：spring-security

每个人：

如何在 3.0.x 和 3.1.x 中创建`ExceptionTranslationFilter`'s ？`BeanDefinition`我想重用它`PropertyValue`的`BeanDefinition`（**accessDeniedHandler**和**authenticationEntryPoint**）。我发现我无法`DefaultListableBeanFactory`通过bean名称或类获取它，似乎ExceptionTranslationFilter的BeanDefinition没有注册。

像其他过滤器一样`UsernamePasswordAuthenticationFilter`，它有一个 bean 名称：**org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter#0**。但是`ExceptionTranslationFilter`一个都没有。

我发现的唯一方法是迭代地搜索filterChainProxy的属性，有没有更好的方法？

我在伪代码中做了什么：

```
BeanDefinitionBuilder builder = 
    BeanDefinitionBuilder.rootBeanDefinition(MyExceptionFilter.class);
RootBeanDefinition exceptionTranslationFilter = getExceptionTranslationFilterBeanDefinition();     
PropertyValue accessDeniedHandler = exceptionTranslationFilter.getPropertyValues().getPropertyValue("accessDeniedHandler");
Object handler = (RootBeanDefinition) accessDeniedHandler.getValue();
builder.addPropertyValue("accessDeniedHandler", handler);
beanDefinitionRegistry.registerBeanDefinition("myFilter", builder.getBeanDefinition()); 
```

所以，真正的问题是**获得核心过滤器 ExceptionTranslation 的 accesDeniedHandler 的最佳方法是什么`BeanDefinition`**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T10:22:58.907

因为[您无法更改`ExceptionTranslationFilter`实现或访问它](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-http)：

> 每个`<http>`命名空间块总是创建一个 `SecurityContextPersistenceFilter`、一个`ExceptionTranslationFilter` 和一个`FilterSecurityInterceptor`。这些是固定的，不能用替代品代替。

您应该使用“传统”bean （使用命名空间代理的名称“springSecurityFilterChain”）或通过显式定义它们并在中引用它们来`FilterChainProxy`访问的属性：`ExceptionTranslationFilter``<http>`

```
<http entry-point-ref="authenticationEntryPoint">
  <access-denied-handler ref="accessDeniedHandler" />
  <!-- other options -->
</http>

<bean:bean id="authenticationEntryPoint" 
    class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">
  <bean:property name="loginFormUrl" value="/login.htm"/>
</bean:bean>

<bean:bean id="accessDeniedHandler"
    class="org.springframework.security.web.access.AccessDeniedHandlerImpl">
  <bean:property name="errorPage" value="/accessDenied.htm" />
</bean:bean> 
```

`AuthenticationEntryPoint`根据文档，实现是*根据已配置的身份验证机制设置的*，因此请选择您需要的一个。

# php - PHP XML RPC - 如何处理返回的数组

> ID：12173056
> 
> 赞同：0
> 
> 时间：2012-08-29T07:43:14.833
> 
> 标签：php, xml, xml-rpc, rpc

我正在使用来自[http://phpxmlrpc.sourceforge.net](http://phpxmlrpc.sourceforge.net)的 PHP XML RPC 类。我创建了一个客户端并将带有结构/数组的方法发送到服务器，我得到了一些响应，但我不知道如何处理响应以使用 foreach() 或直接获取响应值。

也许你们中的一些人可以帮助我？

我的代码：

```
include("../../lib/xmlrpc.inc");
$GLOBALS['xmlrpc_internalencoding'] = 'UTF-8';
$client=new xmlrpc_client("/xmlrpc.php", "www.domain.de", 443);
$client->setDebug(0);
$auth= new xmlrpcval(
    array(
    "username" => new xmlrpcval("user"),
    "password" => new xmlrpcval('pw'),
), "struct");

$search = new xmlrpcval(
    array(
    'EMAIL'=> new xmlrpcval('info@domain.de')
),'struct');

$message=new xmlrpcmsg('doProfileFindBy',
    array(
        $auth,
        new xmlrpcval(964296, "int"),
        $search

    ),'struct'
);

$r = $client->send($message, 0, 'https');
echo '<pre>';
var_dump($r);
echo '</pre>'; 
```

我确实收到了我正在寻找的数据的响应，但它没有格式化为将其用作数组左右。

希望有人可以帮助我。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T07:55:49.117

您可以像这样遍历响应数组（用于测试）：

```
foreach($r as $key => $value)
{
  echo $key." : ".$value."<br>" ;
} 
```

或者您需要任何特定的键值对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T10:46:24.423

根据您的 var_dump 和 XML RPC 类的文档[http://phpxmlrpc.sourceforge.net/doc-2/ch07s04.html](http://phpxmlrpc.sourceforge.net/doc-2/ch07s04.html)您应该执行以下操作：

```
$r = $client->send($message, 0, 'https');
$value = $r->value(); 
```

然后关于[http://phpxmlrpc.sourceforge.net/doc-2/ch07.html](http://phpxmlrpc.sourceforge.net/doc-2/ch07.html)和响应的结构你应该能够解析出你需要的值。您的响应的结构有点复杂，包含具有数组类型属性的对象，该属性包含另一个具有数组属性的对象，一次又一次，直到有值数组您可能想要解析出来......

# ruby-on-rails - ROR ：从另一个方法分配一个方法的变量而不传递任何东西

> ID：12173057
> 
> 赞同：-1
> 
> 时间：2012-08-29T07:43:22.193
> 
> 标签：ruby-on-rails, ruby, methods, parameters

我有一个方法，说

```
def method1
  method2
end 
```

这将调用另一种方法，比如说

```
def method2
  @variable
end 
```

如何在不传递任何参数的情况下从 method1 为这个 @variable 赋值？可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:52:27.217

由于它是一个实例变量，是的，它是可能的：

```
class Foo
  def method1
    b = Baz.new
    b.variable = 'bar'
    b.method2
  end
end

class Baz
  attr_accessor :variable

  def method2
    @variable
  end
end

f = Foo.new
f.method1 # => "bar" 
```

# oracle-apex - 如何使用动态操作根据选择列表更改事件设置文本项

> ID：12173074
> 
> 赞同：1
> 
> 时间：2012-08-29T07:44:44.393
> 
> 标签：oracle-apex

我有以下选择语句，但不确定当用户从 LOV 中选择选项时如何设置动态操作以分配当前 sysdate。当通过动态操作进行 LOV 选择时，我基本上想自动将“DATE_CALLED”字段填充到 sysdate。

尝试从该线程中使用与复选框相反但似乎无法解决的相同处理 - 请参阅：

[Oracle ApEx 复选框以在选中/未选中时操作其他值](https://stackoverflow.com/questions/12038392/oracle-apex-checkbox-to-manipulate-other-values-when-checked-unchecked)

```
select  APEX_ITEM.HIDDEN(1,change_id) ||
        APEX_ITEM.HIDDEN(2,contact_id) ||
        APEX_ITEM.SELECT_LIST_FROM_LOV(p_idx => 10,
                                       p_value => reason_id,
                                       p_lov => 'LOV_REASONS',
                                       p_attributes => 'class="lov_select"',
                                       p_show_null => 'YES',
                                       p_null_value => NULL,
                                       p_null_text => '--- Please select a reason ---') reas,
        APEX_ITEM.TEXT(p_idx => 20, 
                       p_value => TO_CHAR(date_contacted,'DD/MM/YYYY HH24:MI'),
                       p_size => 14,
                       p_attributes => 'class="date_val" readonly="readonly" style="background-color:#B0C4DE;border:1px solid #999999;"') "DATE_CALLED",
        APEX_ITEM.TEXTAREA(p_idx => 30,
                       p_value => comments,
                       p_rows => 2, 
                       p_cols => 30 ) "MPA_COMMENT"
from  MY_TABLE 
```

对于动态行动，我有以下内容：

```
Dynamic action: "lov selection"
Event: Change
Selection Type: jQuery Selector
jQuery Selector: .lov_select (this is the class I added to the select list from lov in the sql)
Condition: JavaScript Expression
Value: ****** Unsure what I need to put here ****** 
```

对于真正的行动，我有以下几点：

```
True Action:
Sequence: 10
Action: Execute PL/SQl Code
Fire On Page Load: No
Code: :P1_DEF_DATE := TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI'); and have Page Item Submitted and Returned

Sequence: 20
Action: Execute JavaScript Code
Fire On Page Load: No
Code: $(this.triggeringElement).closest("tr").find("td[headers='DATE_CALLED'] input").val($v('P1_DEF_DATE')); 
```

此代码不起作用，因为`$(this.triggeringElement)`对于选择列表不正确。

如何根据 select_list_from_lov 场景而不是复选框来实现我所需要的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T12:02:49.930

我使用复选框上的条件来区分选中/未选中状态，并能够定义真假动作。您实际上并不需要在复选框上这样做：只要值更改（即：用户选择另一个选项），就会触发更改。

但是，如果您想捕获无效/空选项，您可以使用条件，但不是使用 javascript 表达式，而是使用运算符之一来测试值（例如：“=”和“1”）

要进一步详细说明您的选择列表上的操作：
这是我用来设置示例的查询：

```
select 
apex_item.checkbox2(p_idx => 1, p_value => empno, p_attributes => 'class="check_select"') empselection,
apex_item.text(2, :P14_DEF_TEXT) empname,
APEX_ITEM.SELECT_LIST_FROM_LOV(p_idx => 3,
                                       p_value => NULL,
                                       p_lov => 'LOV_REASONS',
                                       p_attributes => 'class="lov_select"',
                                       p_show_null => 'YES',
                                       p_null_value => NULL,
                                       p_null_text => '--- Please select a reason ---') reas,
apex_item.text(4, null) some_text,
empno,
ename,
comm
from emp 
```

我使用了一个带有静态值的 lov `LOV_REASONS`。

![对 lov 选择的动态操作](../Images/86c463fc7bc4c328a79b9c865aa6f22d.png)

真实行动中的代码：

```
$(this.triggeringElement).closest("tr").find("td[headers='SOME_TEXT'] input").val("THIS IS A TEST"); 
```

这对我来说似乎很好。

# c# - 如何使用 C# 以编程方式定位我的 Google Drive 文件夹？

> ID：12173077
> 
> 赞同：22
> 
> 时间：2012-08-29T07:44:47.330
> 
> 标签：c#, .net, google-drive-api

[与此处](https://stackoverflow.com/questions/9660280/how-do-i-programmatically-locate-my-dropbox-folder-using-c?rq=1)类似的问题。只是为了`Google Drive`代替`Dropbox`：

如何`Google Drive`使用 C# 以编程方式定位我的文件夹？

*   注册表？
*   环境变量？
*   ETC...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-09T15:14:24.793

我个人认为，最好的方法是通过 SQLite3 访问同一个文件。

```
string dbFilePath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), "Google\\Drive\\sync_config.db");
if (!File.Exists(dbFilePath))
    dbFilePath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), "Google\\Drive\\user_default\\sync_config.db");

string csGdrive = @"Data Source="+ dbFilePath + ";Version=3;New=False;Compress=True;";                
SQLiteConnection con = new SQLiteConnection(csGdrive);
con.Open();
SQLiteCommand sqLitecmd = new SQLiteCommand(con);

//To retrieve the folder use the following command text
sqLitecmd.CommandText = "select * from data where entry_key='local_sync_root_path'";

SQLiteDataReader reader = sqLitecmd.ExecuteReader();
reader.Read();
//String retrieved is in the format "\\?\<path>" that's why I have used Substring function to extract the path alone.
Console.WriteLine("Google Drive Folder: " + reader["data_value"].ToString().Substring(4));
con.Dispose(); 
```

[您可以从此处](http://system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki)获取 .Net 的 SQLite 库。还要添加引用**`System.Data.SQLite`**并将其包含在您的项目中以运行上述代码。

要检索用户，请**`entry_key='user_email'`**从上面的代码中替换

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-06-30T18:08:43.940

我接受了 Sarath 的回答，将其改写为更具弹性（围绕数据源路径的引号、以读者索引为条件的 null、额外的错误检查、“使用”以便适当地处理对象、添加了一堆注释，并添加了一些 LINQ（因为，linq :-) ）。

这个特定的实现捕获并记录异常，然后在任何错误时返回 string.Empty ......因为这就是我当前的应用程序需要它的方式。如果您的应用需要异常，请删除 try/catch。

```
/// <summary>
/// Retrieves the local Google Drive directory, if any.
/// </summary>
/// <returns>Directory, or string.Empty if it can't be found</returns>
public static string GetGoogleDriveDirectory()
{
    try
    {
        // Google Drive's sync database can be in a couple different locations. Go find it. 
        string appDataPath = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData);
        string dbName = "sync_config.db";
        var pathsToTry = new[] { @"Google\Drive\" + dbName, @"Google\Drive\user_default\"+ dbName };

        string syncDbPath = (from p in pathsToTry
                            where File.Exists(Path.Combine(appDataPath, p))
                            select Path.Combine(appDataPath, p))
                            .FirstOrDefault();
        if (syncDbPath == null)
            throw new FileNotFoundException("Cannot find Google Drive sync database", dbName);

        // Build the connection and sql command
        string conString = string.Format(@"Data Source='{0}';Version=3;New=False;Compress=True;", syncDbPath);
        using (var con = new SQLiteConnection(conString))
        using (var cmd = new SQLiteCommand("select * from data where entry_key='local_sync_root_path'", con))
        {
            // Open the connection and execute the command
            con.Open();
            var reader = cmd.ExecuteReader();
            reader.Read();

            // Extract the data from the reader
            string path = reader["data_value"]?.ToString();
            if (string.IsNullOrWhiteSpace(path))
                throw new InvalidDataException("Cannot read 'local_sync_root_path' from Google Drive configuration db");

            // By default, the path will be prefixed with "\\?\" (unless another app has explicitly changed it).
            // \\?\ indicates to Win32 that the filename may be longer than MAX_PATH (see MSDN). 
            // Parts of .NET (e.g. the File class) don't handle this very well, so remove this prefix.
            if (path.StartsWith(@"\\?\"))
                path = path.Substring(@"\\?\".Length);

            return path;
        }
    }
    catch (Exception ex)
    {
        Trace.TraceError("Cannot determine Google Drive location. Error {0} - {1}", ex.Message, ex.StackTrace);
        return string.Empty;
    }
} 
```

# android - 如何在 Android NDK 中指定静态文件路径？

> ID：12173082
> 
> 赞同：-1
> 
> 时间：2012-08-29T07:45:24.790
> 
> 标签：android, dynamic, android-ndk, static-libraries

我需要在`Android.mk`.

说我有以下文件

```
/home/name/android/Android.mk
/home/name/android/lib/share/libfile.so 
```

我应该如何修改`Android.mk`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:10:50.217

它似乎

```
LOCAL_LDLIBS = -L$(LOCAL_PATH)lib/share -lfile 
```

你可以试试看

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:11:15.243

我不太明白你的问题，但我希望这是你所要求的，这个 Android make 文件包括静态预建库。

```
include $(CLEAR_VARS)
LOCAL_MODULE    := mylib
LOCAL_SRC_FILES := mylib.a
LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH)

include $(PREBUILT_STATIC_LIBRARY)

include $(CLEAR_VARS)
LOCAL_MODULE    := NativeLib
LOCAL_SRC_FILES := myfile.c

LOCAL_C_INCLUDES := myfile.h

LOCAL_LDLIBS := -llog
LOCAL_STATIC_LIBRARIES := mylib

include $(BUILD_SHARED_LIBRARY) 
```

要包含动态库，您可以修改为 PREBUILT_DYNAMIC_LIBRARY

# javascript - asp中的Javascript函数：Multiview + asp.Wizard

> ID：12173084
> 
> 赞同：0
> 
> 时间：2012-08-29T07:45:34.867
> 
> 标签：javascript, asp.net

我有一个 asp.net 页面
，其中包含 asp:MultiView
，其中包含 asp:View 和一个 asp:Wizard ID="wizardIscrizione
，其中包含 20 个文本框。（ID= txtNome1、txtCognome1、txtNome2、txtCognome2 等等）。
一半的文本框在向导 Step1 中，另一半在向导 Step2 中。我的 javascript 函数设置为 onchange 文本框事件。

```
<script type="text/javascript">
       function CalcolaJs() {
           var contaIscritti = 0;

           for (var i = 1; i < 11; i++) {
               var conta = (i).toString();

               var nome = document.getElementById('wizardIscrizione_' + 'txtNome' + conta).value;
               var cognome = document.getElementById('wizardIscrizione_' + 'txtCognome' + conta).value;

               if (((nome != "") && (nome !== null) && (nome !== undefined)) &&
                 ((cognome != "") && (cognome !== null) && (cognome !== undefined)))

                   contaIscritti = contaIscritti + 1;
               else contaIscritti = contaIscritti;

               document.getElementById('hidNumPartecipanti').value = contaIscritti;
               document.getElementById('lblNumPartecipanti').innerHTML = contaIscritti;}
           }        
       } 
</script> 
```

Javascript 函数适用于向导第 1 步中的文本框，但在第 2 步中却不行。我真的不知道为什么！编辑：asp.net 来源：

```
<asp:MultiView ID="MultiView1" runat="server" ActiveViewIndex="0">
  <asp:View ID="VistaIscrizione" runat="server">
    <asp:Wizard ID="wizardIscrizione" runat="server" ActiveStepIndex="0" CancelButtonStyle-CssClass="button" FinishCompleteButtonStyle-CssClass="button" FinishPreviousButtonStyle-CssClass="button" NavigationButtonStyle-CssClass="button" FinishCompleteButtonText="Conferma" StartNextButtonText="Avanti &gt;&gt;" StepNextButtonText="Avanti &gt;&gt;" StepPreviousButtonText="&lt;&lt; Indietro" OnFinishButtonClick="wizardIscrizione_FinishButtonClick" DisplaySideBar="False" Width="100%" OnActiveStepChanged="wizardIscrizione_ActiveStepChanged">
        <WizardSteps>
          <asp:WizardStep ID="StepPartecipanti1" runat="server" Title="Step 1 di 3 - Inserisci il nominativo dei partecipanti">
              <fieldset class="gradientCoolBlack">
                  <legend></legend>
                  <p class="titoloStep">Nominativo dei Partecipanti</p>
                  <p><asp:Label ID="Label14" runat="server" CssClass="label">?&nbsp;Nome e Cognome:</asp:Label></p>
                  <p>
                      <asp:Label ID="Label15" runat="server" CssClass="label" Width="20px" Text=" 1\. " />
                      <asp:RequiredFieldValidator ID="r001" runat="server" ControlToValidate="txtNome1" />
                      <asp:RequiredFieldValidator ID="r002" runat="server" ControlToValidate="txtCognome1" />
                      <asp:TextBox ID="txtNome1" runat="server" CssClass="input" Width="250px" MaxLength="15"/>
                      <asp:TextBox ID="txtCognome1" runat="server" CssClass="input" Width="250px" MaxLength="15"/>
                  </p>
                  <p>
                      <asp:Label ID="Label16" runat="server" CssClass="label" Width="20px" Text=" 2\. " />
                      <asp:RequiredFieldValidator ID="r18" runat="server" ControlToValidate="txtNome2" />
                      <asp:RequiredFieldValidator ID="r19" runat="server" ControlToValidate="txtCognome2" />
                      <asp:TextBox ID="txtNome2" runat="server" CssClass="input" Width="250px" MaxLength="15" />
                      <asp:TextBox ID="txtCognome2" runat="server" CssClass="input" Width="250px" MaxLength="15" />
                  </p>
                  <p>
                      <asp:Label ID="Label17" runat="server" CssClass="label" Width="20px" Text=" 3\. " />
                      <asp:RequiredFieldValidator ID="r16" runat="server" ControlToValidate="txtNome3" />
                      <asp:RequiredFieldValidator ID="r17" runat="server" ControlToValidate="txtCognome3" />
                      <asp:TextBox ID="txtNome3" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                      <asp:TextBox ID="txtCognome3" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                  </p>
                  <p>
                      <asp:Label ID="Label181" runat="server" CssClass="label" Width="20px" Text=" 4\. " />
                      <asp:RequiredFieldValidator ID="r22" runat="server" ControlToValidate="txtNome4" />
                      <asp:RequiredFieldValidator ID="r23" runat="server" ControlToValidate="txtCognome4" />
                      <asp:TextBox ID="txtNome4" runat="server" CssClass="input" Width="250px" MaxLength="15" ></asp:TextBox>
                      <asp:TextBox ID="txtCognome4" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                  </p>
                  <p>
                      <asp:Label ID="Label19" runat="server" CssClass="label" Width="20px" Text=" 5\. " />
                      <asp:RequiredFieldValidator ID="r20" runat="server" ControlToValidate="txtNome5" />
                      <asp:RequiredFieldValidator ID="r21" runat="server" ControlToValidate="txtCognome5" />
                      <asp:TextBox ID="txtNome5" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                      <asp:TextBox ID="txtCognome5" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                  </p>
                  <p>
                      <span style="color: White">Altri Partecipanti</span>
                      <asp:CheckBox ID="chkAltri" runat="server" AutoPostBack="True" OnCheckedChanged="chkAltri_CheckedChanged" />
                      <asp:TextBox ID="txtCounter" runat="server" Height="16px" Width="40px"></asp:TextBox>
                      </p>
                  <p>
                      &nbsp;</p>
              </fieldset>

          </asp:WizardStep>
          <asp:WizardStep ID="StepPartecipanti2" runat="server" Title="Step 1 di 3 - Inserisci il nominativo dei partecipanti">
              <fieldset class="gradientCoolBlack">
                  <legend></legend>
                  <p style="text-align: right; font-size: 18px; font-family: Candara; color: #17ef1f">
                      Nominativo dei Partecipanti</p>
                  <p>
                      <asp:Label ID="Label10" runat="server" CssClass="label">?&nbsp;Nome e Cognome:</asp:Label>
                  </p>
                  <p>
                      <asp:Label ID="Label21" runat="server" CssClass="label" Width="20px" Text=" 6\. " />
                      <asp:RequiredFieldValidator ID="r24" runat="server" ControlToValidate="txtNome6"/>
                      <asp:RequiredFieldValidator ID="r25" runat="server" ControlToValidate="txtCognome6"/>
                      <asp:TextBox ID="txtNome6" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                      <asp:TextBox ID="txtCognome6" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                  </p>
                  <p>
                      <asp:Label ID="Label121" runat="server" CssClass="label" Width="20px" Text=" 7\. " />
                      <asp:TextBox ID="txtNome7" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                      <asp:TextBox ID="txtCognome7" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                  </p>
                  <p>
                      <asp:Label ID="Label12" runat="server" CssClass="label" Width="20px" Text=" 8\. " />
                      <asp:TextBox ID="txtNome8" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                      <asp:TextBox ID="txtCognome8" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                  </p>
                  <p>
                      <asp:Label ID="Label11" runat="server" CssClass="label" Width="20px" Text=" 9\. " />
                      <asp:TextBox ID="txtNome9" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                      <asp:TextBox ID="txtCognome9" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                  </p>
                  <p>
                      <asp:Label ID="Label13" runat="server" CssClass="label" Width="20px" Text="10\. " />
                      <asp:TextBox ID="txtNome10" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                      <asp:TextBox ID="txtCognome10" runat="server" CssClass="input" Width="250px" MaxLength="15"></asp:TextBox>
                  </p>
                  <p>
                      &nbsp;</p>
              </fieldset>
          </asp:WizardStep>
</asp:MultiView> 
```

代码隐藏：

```
protected void Page_Load(object sender,EventArgs e)
{
  AddOnChangeAttribute(Page);//Add .Attributes.Add("onchange","CalcolaIscrittiJs()") to txtNome(i) and txtCognome(i);

  numeroPartecipanti = Convert.ToInt16(HttpUtility.HtmlEncode(Page.Request.Form["hidNumPartecipanti"]));

  hidNumPartecipanti.Value = numeroPartecipanti.ToString();//valore pagina 2
  lblNumPartecipanti.Text = hidNumPartecipanti.Value;
} 
```

# apache - Apache URL 重写分页

> ID：12173088
> 
> 赞同：0
> 
> 时间：2012-08-29T07:46:03.520
> 
> 标签：apache, .htaccess, rewrite

我不擅长 Apache URL 重写。我想在这里做一些重写。

`http://www.mydomain.com/item/search?words=something&number=1`

=>

`http://www.mydomain.com/item/search/something/1`

并且也应该避免`http://www.mydomain.com/search/something/1`=> `http://www.mydomain.com/item/search/something/1`（如果没有`/item/`添加它）

这是我的重写代码。

```
RewriteRule ^search/(.*)/(.*)/?$ /item/search/$1/$2 [L,R=301]
RewriteRule ^(item/search)/([^/]+)/(\d+)/?$ item/search?words=$2&number=$3 
```

它显示`404`:(

**更新：**这是我所有的 .htaccess 文件：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]

RewriteRule ^comment/(\d+)/?$ /post/comment/$1 [L,R=301]
RewriteRule ^(post/comment)/(\d+)/?$ post/comment?comment=$2

RewriteRule ^rss/(.*)/?$ /item/rss/$1 [L,R=301]
RewriteRule ^(item/rss)/(.*).xml/?$ item/rss.php?rss=$2

RewriteRule ^search/(.*)/(.*)/?$ /item/search/$1/$2 [L,R=301]
RewriteRule ^(item/search)/([^/]+)/(\d+)/?$ item/search?words=$2&number=$3

RewriteCond %{http_host} ^mydomain.com [NC]
RewriteRule ^(.*)$ http://www.mydomain.com/$1 [L,R=301]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T15:17:46.953

你不能这样做`htaccess`，你应该在你的 wordpress 主题中添加一些代码`function.php`。

```
function add_my_rewrite() {
    add_rewrite_rule('^item/search/(.+)/(\d+)?$', 'index.php?pagename=item/search&words=$matches[1]&number=$matches[2]', 'top');
}
add_action( 'init', 'add_my_rewrite' ); 
```

有关 WordPress 重写规则的更多信息：

[http://codex.wordpress.org/Rewrite_API](http://codex.wordpress.org/Rewrite_API)

[http://codex.wordpress.org/Rewrite_API/add_rewrite_tag](http://codex.wordpress.org/Rewrite_API/add_rewrite_tag)

[http://codex.wordpress.org/Rewrite_API/add_rewrite_rule](http://codex.wordpress.org/Rewrite_API/add_rewrite_rule)

# mysql - Mysql动态查询以获取所有表名，如自定义

> ID：12173089
> 
> 赞同：1
> 
> 时间：2012-08-29T07:46:04.377
> 
> 标签：mysql

> **可能重复：**
> [mysql - 使用多个表的结果查询数据库？](https://stackoverflow.com/questions/11935023/mysql-query-a-database-with-results-from-multiple-tables)

你好朋友我在 Sql 中有这个查询，但 ui 想在 MYSQL 中执行。

```
DECLARE @sql AS nvarchar(max)
    set @sql=''
    set @sql='Select * From('
    SELECT @sql = @sql + N'
    SELECT name  FROM ['+ SCHEMA_NAME(schema_id) +'].[' + name + ']
    UNION ALL '
    FROM information_schema.`TABLES` T where table_name like 'Custom%'
    SELECT @sql = SUBSTRING(@sql, 0, len(@sql)-9)
    print @sql 
```

我的要求是合并数据库中以自定义开头的所有表

请给我解决方案来执行。我在 MYSQL 中使用了这个。但很难找到结果。

```
DECLARE @sql AS nvarchar(max)
    set @sql=''
    SELECT @sql = @sql + N'
    SELECT name  FROM ['+ SCHEMA_NAME(schema_id) +'].[' + name + ']
    UNION ALL '
    FROM information_schema.`TABLES` T where table_name like 'Custom%'
    SELECT @sql = SUBSTRING(@sql, 0, len(@sql)-9)
    print @sql 
```

# nservicebus - nservicebus：确保所有事件都得到处理的标准方法是什么？

> ID：12173090
> 
> 赞同：1
> 
> 时间：2012-08-29T07:46:05.210
> 
> 标签：nservicebus, publish-subscribe

抱歉这个挑剔的问题，我会尝试通过向您展示一个用例来详细说明（这不是我的真实案例，所以请不要记下事件/服务名称或职责）：

考虑一个具有服务（除其他外）的系统：“商店”和“经济”。商店服务处理商品购买并发布三个事件：“CustomerBoughtItem”、“CustomerReturnedItem”和“StoreIsClosed”。现在，经济服务会收集这些事件并每天创建一份财务报告。该报告应在商店关闭后立即创建。至关重要的是，来自商店服务的所有事件都包含在每日报告中，这意味着经济服务在处理来自商店的所有事件之前无法创建其财务报告。在开始处理“StoreIsClosed”事件之前，如何确定性地确保所有“CustomerBoughtItem”和“CustomerReturnedItem”事件都已在终点处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:00:25.603

您可以使用以下模式：

打开一个 saga 并接收这三个消息。每条消息都有一个连续的 id（例如 int）。保存所有顺序 ID 并确定收到的每条消息：

*   在某个时间点收到 StoreIsClosed 消息
*   所有 id（从 0 或 1 到 StoreIsClosed-SequentialId 的 id）都是连续的，没有 id 丢失

如果满足这两个条件，则通过 .SendLocal (CreateDailyReportMessage) 将最后一条消息发送到您的 saga。

**编辑以获得更好的格式并回答评论：**

我假设另一个服务发布的“StoreIsClosed”事件是指：另一个服务现在不知道，最后一个 SequentialId 是什么或更一般的负责该事件的服务，StoreIsClosed 对客户交易一无所知。

所以商店服务必须隐式或显式地向您发送更多上下文信息，以便经济服务

例子：

*   （隐式）在您的 storeservice 中订阅 StoreIsClosed 事件并发布在您的 saga 中订阅的 CustomersHaveBoughtOrReturnedToday 消息。在这里，您可以包含一个交易 ID 列表，您可以在您的 saga 或其他某种校验和中交叉检查，例如交易总数或该商店的第一个顺序 ID 和最后一个顺序 ID。
*   （明确）在您的 sage 准备好完成之前明确询问您的商店服务是否已处理所有交易。（在你的传奇中发送/回复）

# sql - TSQL - 查询 XML

> ID：12173091
> 
> 赞同：0
> 
> 时间：2012-08-29T07:46:14.103
> 
> 标签：sql, sql-server, xml, tsql

也许有人可以帮助我，我有一个带有 XML 列的 nRows 的 sql 表。XML 结构如下所示：

```
<DynamicResults>
  <RegQuery xmlns:xsi="http://www.w3.o....." xmlns:xsd="http://....." REGServer="localhost" REGHive="HKEY_LOCAL_MACHINE" REGSubKey="SOFTWARE\Microsoft\Windows\BlaBla" />
</DynamicResults> 
```

我的问题：我如何查询 xml，我想知道在属性“REGSubKey”中具有指定值的 /DynamicResults/RegQuery 是否具有子节点...

多谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:03:56.677

我通常这样做的方式是使用内置的 XML 函数（如果您使用的是 SQL Server 2005 或更高版本）。

查看此 MSDN 页面：http: [//msdn.microsoft.com/en-us/library/ms178030](http://msdn.microsoft.com/en-us/library/ms178030)

这是一个返回特定 reg 键的子节点数的示例`SOFTWARE\Microsoft\Windows\BlaBla`...

```
DECLARE @x xml 
SET @x='<DynamicResults>
  <RegQuery xmlns:xsi="http://www.w3.o....." xmlns:xsd="http://....." REGServer="localhost" REGHive="HKEY_LOCAL_MACHINE" REGSubKey="SOFTWARE\Microsoft\Windows\BlaBla">
    <SubNode />
    <SubNode />
  </RegQuery>
  <RegQuery xmlns:xsi="http://www.w3.o....." xmlns:xsd="http://....." REGServer="localhost" REGHive="HKEY_LOCAL_MACHINE" REGSubKey="SOFTWARE\Microsoft\Windows\BlaBla2" />
  <RegQuery xmlns:xsi="http://www.w3.o....." xmlns:xsd="http://....." REGServer="localhost" REGHive="HKEY_LOCAL_MACHINE" REGSubKey="SOFTWARE\Microsoft\Windows\BlaBla3" />
</DynamicResults>'
SELECT @x.value('count(/DynamicResults/RegQuery[@REGSubKey="SOFTWARE\Microsoft\Windows\BlaBla"]/*)','INT')
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:01:52.960

```
select *
from table
where XmlField.value('count(/DynamicResults/RegQuery[@REGSubKey="SOFTWARE\Microsoft\Windows\BlaBla"]/*)','int')>0 
```

# php - php: 打印 javascript/jquery dom-ready

> ID：12173100
> 
> 赞同：0
> 
> 时间：2012-08-29T07:46:34.690
> 
> 标签：php, javascript, jquery

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T07:50:47.047

你使用`"`所以 $ 被解释，切换引号，你会没事的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T10:21:45.493

这不是我的答案，我只是在这里复制了[JQuery - $ 未定义](https://stackoverflow.com/questions/2194992/jquery-is-not-defined)

归功于@Mike Trpcic

该错误只能由以下三件事之一引起：

您的 JavaScript 文件未正确加载到您的页面中 您的 jQuery 版本不完善。这可能是因为有人编辑了核心文件，或者插件可能覆盖了 $ 变量。您在页面完全加载之前运行 JavaScript，因此，在 jQuery 完全加载之前。您应该检查 Firebug 网络面板以查看文件是否实际加载正确。如果没有，它将以红色突出显示，并在其旁边显示“404”。如果文件加载正确，则意味着问题是 2。

确保所有 javascript 代码都在代码块内运行，例如：

$(document).ready(function () { //你的代码在这里 }); 这将确保在初始化 jQuery 之后加载您的代码。

最后要检查的一件事是确保在加载 jQuery 之前没有加载任何插件。插件扩展了“$”对象，因此如果您在加载 jQuery 核心之前加载插件，那么您将收到您描述的错误。

# javascript - Moving a Mega Menu Over

> ID：12173103
> 
> 赞同：0
> 
> 时间：2012-08-29T07:46:45.287
> 
> 标签：javascript, jquery, css

I am new to jquery and css. I created a jquery mega menu but I am having problems with the Link menu item. It runs off the right side of the scren and I want to bring it over to match the right edge of the site. Can someone please explain how I can do this? I normally would post the code or put up a jsfiddle link but there are different css and js files to run this and I don't know of another way then to link you directly to the site.

This style I have linked to the UL of the list for Links

Located in the menu.css file.

```
/* Style the 3rd level links */
.dcjq-mega-menu ul.menu li .sub li ul li#links-layout {

} 
```

I have tried float left and also margin-right:300px; and neither seem to effect moving it.

This is on the main page.

```
<li id="links-layout"><a href="#">LINKS</a> 
```

Instruction: Roll your mouse over the "LINKS" menu bar item and notice how it runs off the right browser screen I want to fix this.

Here is the link: [http://gdisinc.com/barker/default.php](http://gdisinc.com/barker/default.php)

# gwt - GWT Datagrid does not show data , but contains it

> ID：12173108
> 
> 赞同：11
> 
> 时间：2012-08-29T07:47:03.117
> 
> 标签：gwt, datagrid, tabpanel, celltable

I'm trying to convert a `cellTable` into a`datagrid`, because I want to add a search handler later and therefor I need fixed column headers. At the moment I extend the `celltable`/`datagrid` class and put the widget into a `simplelayoutpanel` and add this to my `tabpanel`.

If I use the `celltable`, all works fine and the data shows up. If I change the type of the class to `datagrid`, the data shows sometimes up (The column names are always there). To add something to the table I used `setRowData` or a `dataProvider`. If I set breakpoints to delay the loading of the table content, the table does sometimes contain data. If I later call the redraw method for the table, the table shows the correct information. But the table should load automatically the content. At other "positions" of my project I used the datagrid also and it worked in `Dialogboxes`.

I think there must be a bug with the drawing of the items, because if I call `.getRowCount` on the table or the deprecated `.getDisplayedItems`, it returns me the correct number of items which should be in the table. Also if I add a selection model to the table and select a item, the item contains valid data.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-30T05:15:50.973

DataGrid 需要放在实现 ProvidesResize 接口的 LayoutPanel 或 Panel 中才可见。ScrollPanel 实现了该接口。

此外，从 DataGrid 到根元素/面板的这一系列 LayoutPanel 必须不间断。在您的面板层次结构中似乎就是这种情况。

最后，您必须使用 RootLayoutPanel 而不是 RootPanel 来添加您的 LayoutPanel。那么您是否确保将您的 SimpleLayoutPanel 添加到 RootLayoutPanel ？

另请参阅此 [GWT：DataGrid - 设置高度 100% 未正确呈现](https://stackoverflow.com/questions/11845196/gwt-datagrid-set-height-100-not-rendering-properly)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-21T20:44:52.237

这是我的 2 美分。

当在正确形成的“LayoutPanel 或实现 ProvidesResize”树结构的面板之外渲染 DataGrid 时，我发现我始终需要牢记以下几点：

1.  正如[这个问题](https://stackoverflow.com/questions/11845196)所解释的，高度 DataGrid 属性需要一个明确的值，例如“123px”。没有这个，DataGrid 不会显示它的数据行（即使它们在 DOM 中）。

2.  如果将 DataGrid 放在**未聚焦**的DecoratedTabPanel 选项卡中，则需要在此类选项卡获得焦点时调用 DataGrid.redraw() 。同样，没有这个，DataGrid 不会显示它的数据行（即使它们在 DOM 中）。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-27T08:38:03.770

就我而言，这是由以下原因引起的： [DataGrid rows not visible in second tab of TabLayoutPanel](http://code.google.com/p/google-web-toolkit/issues/detail?id=6889)

# jquery - jQuery droppable 在动态输入字段上

> ID：12173111
> 
> 赞同：1
> 
> 时间：2012-08-29T07:47:05.520
> 
> 标签：jquery, jquery-ui, jquery-ui-droppable

我一直在研究如何让 jquery droppable 函数与动态生成的输入字段一起工作，但到目前为止我还没有成功。我已经阅读了一些建议使用 .live() 函数的文章，但我不确定如何让它工作。

我对 JavaScript 比较陌生，任何帮助都将不胜感激。

你可以在这里看到代码：http: [//jsfiddle.net/kWAtJ/151/](http://jsfiddle.net/kWAtJ/151/)

我想要做的是将 <li>iPad</li> 文本拖放到动态创建的文本区域中。它在第一个 textarea 上工作正常，但在动态生成的一个上却不行。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:50:49.967

这是您更新的 FIDDLE

[http://jsfiddle.net/5rpQt/](http://jsfiddle.net/5rpQt/)

# php - PHP下载大文件问题

> ID：12173112
> 
> 赞同：1
> 
> 时间：2012-08-29T07:47:06.863
> 
> 标签：php, download, large-files

我使用以下代码下载一个大文件，如 250mb：

```
if(file_exists($leadon)) 
    {
        set_time_limit(0);
        header('Content-Description: File Transfer');
        header('Content-Type: application/octet-stream');
        header('Content-Disposition: attachment; filename='.$file_name);
        header('Content-Transfer-Encoding: binary');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Pragma: public');
        header('Content-Length: ' . filesize($leadon));
        header('Content-Description: File Transfer');
        ob_clean();
        flush();
        readfile($leadon);
        exit;
    }
    die(); 
```

但是根据互联网的速度，文件被部分下载，如 18mb 到 75mb。服务器管理员告诉我，我触发了 500 错误代码（内部错误）并且服务器安全认为它受到攻击并阻止我的 IP，请帮助我，什么可能导致触发内部错误或安全漏洞？

我将它复制到一个临时目录并让用户通过标题（重定向）下载并删除超过 24 小时的文件，然后重新加载页面并请求任何其他文件下载。我已经给出了下面的代码，如果有更好的解决方案，请告诉我。

```
if(file_exists($leadon)) 
        {
            $temp_folder    =   time();
            $olderTime      =   $temp_folder-(24*60*60);
            $temp_dir   =   $tempdir.$temp_folder;
            create_dir($temp_dir, 0775);
            $dirs   =   glob($tempdir.'*'); // get all file names
            foreach($dirs as $dir)
                { // iterate files
                if(is_dir($dir)) 
                    {
                    $temp_dir_name  =   explode('/',$dir);
                    $dir_name       =   $temp_dir_name['1'];
                    if(intval($dir_name) < intval($olderTime))
                        {
                        deleteDir($dir);
                        }
                    }
                }
            set_time_limit(0); //Set the execution time to infinite.
            $file_name  =   str_replace(' ', '_',  basename($leadon));
            // 
            $temp_file  =   $temp_dir."/".$file_name;
            copy($leadon, $temp_file);
            header('Location: '.$doman_name.'/'.$temp_file);
            exit();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:03:50.997

为什么要使用 PHP 编写文件作为输出？如何将文件保存在 Web 服务器目录中的某个位置并将用户重定向到相同的位置？让您的网络服务器完成提供文件的任务，不是吗？

# iphone - OHAttributedLabel 警告

> ID：12173117
> 
> 赞同：1
> 
> 时间：2012-08-29T07:47:28.360
> 
> 标签：iphone, xcode, uilabel

我在我的 iPhone 应用程序中使用 OHAttributedLabel，但我收到了警告。

```
Warning: the numberOfLines property is not yet supported by CoreText and OHAttributedLabel. (this property is ignored right now)
 This is a known issue (Help to solve this would be greatly appreciated).
 See https://github.com/AliSoftware/OHAttributedLabel/issues/34 
```

另外，我对此没有任何解决方案，任何人都可以建议我如何解决它，如果我在不删除此警告的情况下上传我的应用程序，我的应用程序将被苹果拒绝。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:08:55.953

好吧，正如警告所说，*OHAttributedLabel*`numberOfLines`不支持。删除警告的唯一方法是在*OHAttributedLabel*支持之前不设置属性。*`numberOfLines`*

 **如果你的应用程序使用`NSLog()`它不会被 Apple 拒绝，但你应该避免它，因为这是一个坏习惯。日志信息对您和您的用户将毫无用处，如果发送了许多日志消息，则会降低性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:11:07.810

由于这些错误，因为它不支持 NSAtributedString 的大多数功能。

最好使用[TTTAttributedLabel](https://github.com/mattt/TTTAttributedLabel/downloads)。**

# magento - 在 Magento 中设置状态、税类的默认值

> ID：12173122
> 
> 赞同：13
> 
> 时间：2012-08-29T07:47:45.533
> 
> 标签：magento, adminhtml

如何在管理员中将“已启用”、“无”设置为“状态”、“税类”字段的默认值？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-29T10:00:22.030

以下是一些示例，说明您可以如何合理地设置默认值。我包括了一些额外的东西来预示你的下一个问题：

```
UPDATE `eav_attribute` SET `default_value` = 'container1' WHERE `eav_attribute`.`attribute_code`='options_container';
UPDATE `eav_attribute` SET `default_value` = '1' WHERE `eav_attribute`.`attribute_code`='is_active';
UPDATE `eav_attribute` SET `default_value` = '1' WHERE `eav_attribute`.`attribute_code`='is_anchor';
UPDATE `eav_attribute` SET `default_value` = '1' WHERE `eav_attribute`.`attribute_code`='status';
UPDATE `eav_attribute` SET `default_value` = '0' WHERE `eav_attribute`.`attribute_code`='weight';
UPDATE `eav_attribute` SET `default_value` = '2' WHERE `eav_attribute`.`attribute_code`='tax_class_id';
insert into core_config_data values ( null, 'default', 0, 'cataloginventory/item_options/is_in_stock', 1 );
insert into core_config_data values ( null, 'default', 0, 'cataloginventory/item_options/qty', 10 ); 
```

# google-chrome - 浏览器中的 Web Worker 支持

> ID：12173125
> 
> 赞同：1
> 
> 时间：2012-08-29T07:48:08.797
> 
> 标签：google-chrome, browser, cross-browser, web-worker

全部，

我们很高兴与 web worker 一起工作，满足于在没有 web worker 支持的情况下支持任何浏览器，直到今天我们意识到 Chrome 不支持嵌套 web worker 和脚本导入。[关联](https://bugs.webkit.org/show_bug.cgi?id=22723)

有没有人详细了解哪个浏览器（特别是 IE10、FF、Chrome、Safari 和 Opera）具有什么级别的 Web Worker 支持，我对以下内容特别感兴趣：

*   嵌套网络工作者支持
*   导入脚本支持
*   XMLHTTPRequest 支持

非常感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:32:58.003

Chrome 的错误链接（我希望将来会修复）是[http://code.google.com/p/chromium/issues/detail?id=31666](http://code.google.com/p/chromium/issues/detail?id=31666)

至于 importScripts，XHR - 它应该可以在 Chrome/FF/Safari 上运行，但我还没有在 Opera 和 IE10 上检查它。

# c# - 自定义光标在 IE9 中不起作用？

> ID：12173126
> 
> 赞同：0
> 
> 时间：2012-08-29T07:48:10.900
> 
> 标签：c#, css, winforms, cursor, webbrowser-control

我的表单中有一个 Web 浏览器控件。我在我的代码中使用了一个自定义光标。`CSS`一切都很好`IE8`

**CSS代码**

```
cursor: url(AppDirectiry\Classes\QClasses\ClsDesignHtml\Cursors\arrow.ani); 
```

但它似乎不起作用`IE9`。任何想法？

**编辑：**

我也使用`.cur`了游标类型，但它似乎也不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T07:53:03.037

[http://beradrian.wordpress.com/2008/01/08/cross-browser-custom-css-cursors/](http://beradrian.wordpress.com/2008/01/08/cross-browser-custom-css-cursors/)

[http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/2f3b25ea-bbc3-487b-8a0c-9850ae9f12ce/](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/2f3b25ea-bbc3-487b-8a0c-9850ae9f12ce/)

[http://jquery.kidsil.net/custom-cursor/](http://jquery.kidsil.net/custom-cursor/)

这三个链接应该有助于解决您的问题，也很确定大多数浏览器不支持动画光标，使用静态光标可以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:55:48.517

[http://jsfiddle.net/TMjvY/](http://jsfiddle.net/TMjvY/)

现在可以在 IE 9 中使用，只是将 ,auto 添加到 CSS 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T09:00:05.187

I think you have to be in Quirks Mode

# php - 带有 TinyMCE 的 KCFinder Web 文件管理器，Php 脚本不起作用

> ID：12173129
> 
> 赞同：0
> 
> 时间：2012-08-29T07:48:23.660
> 
> 标签：php, asp.net-mvc-3, tinymce, file-browser

我在我的 MVC3 应用程序中使用 KCFinder 和 TinyMCE。我的配置如下

```
tinyMCE.init({
    file_browser_callback: 'openKCFinder',
    ...........
    ...........
});

function openKCFinder(field_name, url, type, win) {
    tinyMCE.activeEditor.windowManager.open({
        file: '/kcfinder/browse.php?opener=tinymce&type=' + type,
        title: 'KCFinder',
        width: 700,
        height: 500,
        resizable: "yes",
        inline: true,
        close_previous: "no",
        popup_css: false
    }, {
        window: win,
        input: field_name
    });
    return false;
} 
```

在这里，当我在 TinyMCE 窗口中单击图像浏览器时，它会调用 URL`'/kcfinder/browse.php?opener=tinymce&type=' + type'`

但是，问题是，它不是执行这个`browse.php`文件，而是下载同一个文件......

如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:53:37.340

这看起来好像您的网络服务器配置不正确。确保它能够解释`php`文件。您是否使用任何其他可访问的 php 脚本？

# html - CSS 过滤器在 Firefox 中不起作用

> ID：12173130
> 
> 赞同：29
> 
> 时间：2012-08-29T07:48:34.733
> 
> 标签：html, css

我正在尝试 CSS 过滤器，但它在我的 Firefox (15.0) 浏览器中不起作用。

HTML：

```
<div class="google">
     <img src="https://www.google.com/images/srpr/logo3w.png">
</div> 
```

CSS：

```
.google{   
    -moz-filter: grayscale(100%);
    filter: grayscale(100%);
} 
```

演示：http: [//jsfiddle.net/xDJzU/](http://jsfiddle.net/xDJzU/)

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-29T07:59:40.857

GrayScale 在使用 -moz-filter 的 Firefox 中存在限制。

要使其正常工作，请使用以下代码段：

```
filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); /* Firefox 3.5+ */ 
```

[**演示**](http://jsfiddle.net/xDJzU/7/)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-29T07:52:48.117

假设您正在尝试获得灰度图像，请使用此代码重写您的 css 代码：

```
.google{
    filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); /* Firefox 3.5+ */
    filter: gray; /* IE6-9 */
    -webkit-filter: grayscale(100%); /* Chrome 19+ & Safari 6+ */
}
​ 
```

**更新了 jsfiddle：** [jsfiddle 链接](http://jsfiddle.net/xDJzU/8/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-04T07:00:31.347

我还遇到了在 Firefox 39.0 中使用时图像完全消失的问题

```
 filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); /* Firefox 3.5+ */ 
```

为我解决的问题是添加“过滤器：灰度（1）” - 就像这样：

```
filter: url("data:image/svg+xml;utf8,&lt;svg xmlns=\'http://www.w3.org/2000/svg\'&gt;&lt;filter id=\'grayscale\'&gt;&lt;feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/&gt;&lt;/filter&gt;&lt;/svg&gt;#grayscale"); /* Firefox 10+, Firefox on Android */
filter: gray; /* IE6-9 */
filter: grayscale(1); /* Firefox 39 (and above? Don´t know) */
-webkit-filter: grayscale(100%); /* Chrome 19+, Safari 6+, Safari 6+ iOS */ 
```

这使它对我有用。不知道 IE 10+ 怎么样，还没有测试它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:26:15.937

此代码将 100% 为您工作。

```
.google{
    filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); 
    filter: gray;
    -webkit-filter: grayscale(100%)
} 
```

# php - 想要在使用 php 从 mysql 中删除行之前放置一个警告触发器

> ID：12173133
> 
> 赞同：1
> 
> 时间：2012-08-29T07:48:51.883
> 
> 标签：php, mysql, html

我想在使用 php 从 mysql 中删除特定行之前发出警告，这是我的代码，请建议我该怎么做？删除脚本运行良好。

这是我的**users-delete.php**

```
<?php include("../includes/config.php"); ?>
<?php

 if ($_SESSION["isadmin"])
{

$con=mysql_connect($dbserver,$dbusername,$dbpassword);
if (!$con) { die('Could not connect: ' . mysql_error()); }

mysql_select_db($dbname, $con);
$accountid=$_GET["id"];
$result = mysql_query("SELECT * FROM accounts WHERE (id='".$accountid."')");
while($row = mysql_fetch_array($result))
{
   $id=$row['id'];
   $firstname = $row['firstname'];
   $lastname = $row['lastname'];
   $password = $row['password'];
   $email=$row['email'];
   $type=$row['type'];
}
mysql_close($con);
?>
<!DOCTYPE HTML>
<html>
<head>
<title>Delete User</title>
<link rel="StyleSheet" href="../admin/css/style.css" type="text/css" media="screen">
</head>
<body>
<?php include("../admin/includes/header.php"); ?>
<?php include("../admin/includes/nav.php"); ?>
<?php include("../admin/includes/manage-users-aside.php"); ?>
<div id="maincontent">

<div id="breadcrumbs">
    <a href="">Home</a> >
     <a href="">Manage Users</a> >
     <a href="">List Users</a> >
     Delete User
</div>
<h2>Delete User</h2>

<form method="post" action="users-delete-action.php">
<input type="hidden" value="<?php echo $accountid; ?>" name="id" />
<label>Email/Username:</label><input type="text" name="email" value="<?php echo $email;     ?>" /><br /><br />
<label>Password:</label><input type="password" name="password" value="<?php echo   $password;?>" /><br /><br />
<label>First Name:</label><input type="text" name="firstname" value="<?php echo   $firstname; ?>" /><br /><br />
<label>Last Name:</label><input type="text" name="lastname" value="<?php echo  $lastname; ?>" /><br /><br />
<label>Type:</label><br />
<input type="radio" name="type" value="S" <?php if ($type == 'S') echo   'checked="checked"'; ?> />Student<br />
<input type="radio" name="type" value="T" <?php if ($type == 'T') echo  'checked="checked"'; ?> /> Teacher<br />

    <input type="submit" value="Delete" />
</form>

</div>

</body>
<?php include("../admin/includes/footer.php"); ?>
</html>
<?php
}
else
{
    header("Location: ".$fullpath."login/unauthorized.php");

}
?> 
```

这是用户删除action.php

```
<?php include("../includes/config.php");?>
<?php

$id=$_POST["id"];
$con=mysql_connect($dbserver,$dbusername,$dbpassword);
if (!$con) { die('Could not connect: ' . mysql_error()); }
mysql_select_db("ombts", $con);
$query=("DELETE FROM accounts WHERE id='".$id."'");
$result=mysql_query($query);
 if($result){
echo "User has been Deleted Successfully!!";
}mysql_close($con);
?> 
```

请帮助，我将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:57:17.983

提交时附上确认

```
<form method="post" action="users-delete-action.php" 
 onsubmit="return confirm("Are you sure you wish to delete?");"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T07:54:59.200

在提交按钮上使用它：

```
<input type="submit" value="Delete" onclick="return confirmSubmit()" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T07:58:18.327

1解决方案只是修改表格：

```
 <form name="form" method="post" action="users-delete-action.php">
<input type="hidden" value="<?php echo $accountid; ?>" name="id" />
<label>Email/Username:</label><input type="text" name="email" value="<?php echo $email;     ?>" /><br /><br />
<label>Password:</label><input type="password" name="password" value="<?php echo   $password;?>" /><br /><br />
<label>First Name:</label><input type="text" name="firstname" value="<?php echo   $firstname; ?>" /><br /><br />
<label>Last Name:</label><input type="text" name="lastname" value="<?php echo  $lastname; ?>" /><br /><br />
<label>Type:</label><br />
<input type="radio" name="type" value="S" <?php if ($type == 'S') echo   'checked="checked"'; ?> />Student<br />
<input type="radio" name="type" value="T" <?php if ($type == 'T') echo  'checked="checked"'; ?> /> Teacher<br />

    <input type="button" value="Delete" onClick="if (confirm('Are you sure you want to delete ?')) document.form.submit(); return false;">" /> </form>​ 
```

注意力 ：

您用来删除的方法非常不安全。如果有人起诉萤火虫编辑隐藏的输入，他可以删除任何人！

编辑：小提琴链接 - [http://jsfiddle.net/M7fG2/](http://jsfiddle.net/M7fG2/)

# android - 计算android屏幕大小？

> ID：12173143
> 
> 赞同：4
> 
> 时间：2012-08-29T07:49:25.763
> 
> 标签：android, android-layout, mobile

是否可以以英寸为单位计算 android 屏幕对角线尺寸。

我尝试了以下两种方法，都不适合我的情况。

方法一：

```
DisplayMetrics displayMetrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
int absoluteHeightInPx = displayMetrics.heightPixels;
int absoluteWidthInPx = displayMetrics.widthPixels;     
double diagonalPixels = Math.sqrt((absoluteHeightInPx * absoluteHeightInPx) + (absoluteWidthInPx * absoluteWidthInPx));
double diagonalInInches = diagonalPixels / displayMetrics.densityDpi; 
```

方法二：

```
float actualHeight = absoluteHeightInPx * deviceDensity;
float actualWidth = absoluteWidthInPx * deviceDensity;
float deviceDensity = displayMetrics.density;
float physicalPixelPerInchX = displayMetrics.xdpi;
float physicalPixelPerInchY = displayMetrics.ydpi;
float heightInInches = actualHeight / physicalPixelPerInchY;
float widhtInInches = actualWidth / physicalPixelPerInchX;
double diagonalInInches = Math.sqrt((heightInInches * heightInInches) + (widhtInInches * widhtInInches)); 
```

如果我错了，你能纠正吗？

谢谢，伊斯瓦尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T12:17:43.353

我使用下面的代码，它适用于我的 Moto Dey。

```
 DisplayMetrics metrics=new DisplayMetrics();
    getWindowManager().getDefaultDisplay().getMetrics(metrics);

    float height=metrics.heightPixels/metrics.xdpi;
    float width=metrics.widthPixels/metrics.ydpi;

    TextView tv=(TextView) findViewById(R.id.textview);
    tv.setText("The screen size is:"+FloatMath.sqrt(height*height+width*width)); 
```

实际对角线长度为3.7"，代码给出3.6979072，足够精确。根据SDK中的描述，我认为我的方法应该适用于其他设备。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-31T09:30:36.533

我已经在 8 个 android 设备上测试了我的两种方法。第二个几乎是准确的。

但对于少数设备，这并没有给出正确的答案。所以我总结了第二种方法。

# c# - 更新功能（包括 AddWithValue 参数）将不起作用

> ID：12173144
> 
> 赞同：0
> 
> 时间：2012-08-29T07:49:31.057
> 
> 标签：c#, ado.net

我试图循环一些数组，并通过它，用新参数更新..

这是我的代码：

```
for (int i = 0; i < wholeArr.Length - 1; i++)
    {
        string[] temp = wholeArr[i].Split('-');
        UpdateQuery(int.Parse(temp[1]), int.Parse(temp[0]));

    } 
```

这是我的更新功能：

```
public void UpdateQuery(int id, int newOrder)
{
    string sql = "update Tama38News set [OrderingNumber] = @OrderingNumber where [ID] = @ID";

    con = new SqlConnection(connection);
    con.Open();
    adapter = new SqlDataAdapter();
    command = new SqlCommand(sql, con);
    command.Parameters.AddWithValue("@ID", id);
    command.Parameters.AddWithValue("@OrderingNumber", newOrder);

    command.ExecuteNonQuery();
    con.Close();
} 
```

问题是，我没有得到任何异常，但由于某种原因，数据库没有受到影响..

知道为什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T07:52:15.270

您确定要省略数组中的最后一项吗？

更改`wholeArr.Length - 1`为`wholeArr.Length`

```
for (int i = 0; i < wholeArr.Length; i++)
{
    string[] temp = wholeArr[i].Split('-');
    UpdateQuery(int.Parse(temp[1]), int.Parse(temp[0]));
} 
```

也许只有一项，因此从未调用过 UpdateQuery 方法。您可以使用调试器来检查发生了什么。在循环中设置断点并按 F10 转到下一行。检查快速观察窗口中的值。

除此之外，您应该始终处置任何`IDisposable`与`using-statement`.

```
public void UpdateQuery(int id, int newOrder)
{
    string sql = "update Tama38News set [OrderingNumber] = @OrderingNumber where [ID] = @ID";
    using(var con = new SqlConnection(connection))
    {
        using(var command = new SqlCommand(sql, con))
        {
            con.Open();
            command.Parameters.AddWithValue("@ID", id);
            command.Parameters.AddWithValue("@OrderingNumber", newOrder);
            command.ExecuteNonQuery();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:27:09.557

确保 temp[1] 实际上是您想要的 ID，而 temp[0] 是 newOrder id，并且您没有混淆它们。

# objective-c - Objective C 中的 C++ 模板替换

> ID：12173145
> 
> 赞同：2
> 
> 时间：2012-08-29T07:49:31.603
> 
> 标签：objective-c, templates

如果我想支持从 C++ 中的数据库查询中检索几种类型，我可以创建一个基于模板的方法定义，例如

```
template<typename T>
T getDBValue(int col){
    throw "not implemented";
}

template<>
int getDBValue<int>(int col){
    return 43;
}

template<>
char* getDBValue<char*>(int col){
    return "foo";
} 
```

我知道在objective-c中没有真正的模板对应物，那么你会用什么来支持很少的返回值而不是像这样实现呢

```
- (type1) getType1FromCol: (int) col;
- (type2) getType2FromCol: (int) col;
- (type3) getType3FromCol: (int) col; 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:54:59.050

实际上只有两个选项，具体取决于用户更方便的选择：

*   按照你的建议做，给不同的方法起不同的名字
*   只使用一种方法来返回适合该项目的任何类型（基本上将所有单一类型的方法合并为一个，返回一个泛型类型，例如 NSObject* 甚至 id）。显然只适用于“真实”对象返回类型，并且基本上要求调用者要么知道正确的结果类型，要么从结果中查询它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:01:54.710

如果你想混合使用这两种语言，或者你发现一种语言更适合特定任务，你总是可以使用 Objective-C++。通常，您可以通过将文件扩展名更改为`.mm`.

对于 ObjC 接口，您可以考虑这样一个简单的包装器接口，它使用您现有的程序：

```
template<typename T>
T getDBValue(int col); // << not defined

template<>
int getDBValue<int>(int col){
    return 43;
}

template<>
const char* getDBValue<const char*>(int col){
    return "foo";
} 
```

你可以这样处理它：

```
@implementation MONDBEntry
{
    int col;
}
...

- (int)intValue
{
    return getDBValue<int>(self.col);
}

- (NSString *)stringValue
{
    return [NSString stringWithUTF8String:getDBValue<const char*>(self.col)];
}
... 
```

# c - 使用 malloc 创建 2D 和 1D 数组时出错

> ID：12173149
> 
> 赞同：0
> 
> 时间：2012-08-29T07:49:58.837
> 
> 标签：c, arrays, matrix, malloc

我正在创建 n 大小的 1d 数组 B 和 T 以及 nxn 大小的 2D 数组 A，其中 n 已在前面计算。但是程序在暂停后崩溃了，我可能做错了什么？

```
float *B = malloc(sizeof(int) * (n));
float *T = malloc(sizeof(int) * (n));
system("PAUSE");
float **A;                                                    
A = malloc(sizeof(int) * (n));
for(j = 0; j < n; j++)
{ 
    A[j] = malloc(sizeof(int) * (j));
} 
```

i、j 和 n 是整数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T07:52:07.853

> 一个 nxn 大小的二维数组 A

您将错误的类型传递给`sizeof`. 您应该使用`sizeof(float)`and `sizeof(float *)`。但更严重（和阴险）的问题是：

```
A[j]=(float*)malloc(sizeof(int)*(j));
                                 ^ 
```

你想要`n`而不是`j`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T07:55:11.197

`malloc()`永远不要在;的参数中重复类型名称 这样做很容易说出错误的类型，从而产生错误。

你应该`sizeof`像这样使用：

```
float *B = malloc(n * sizeof *B);
float **A = malloc(n * sizeof *A);
for(j = 0; j < n; ++j)
  A[j] = malloc(n * sizeof *A[j]); 
```

此外，在 C 中，[您不应强制转换`malloc()`](https://stackoverflow.com/a/605858/28169).

# assembly - 将 PIC 汇编指令转换为机器代码

> ID：12173150
> 
> 赞同：4
> 
> 时间：2012-08-29T07:50:05.690
> 
> 标签：assembly, pic, machine-code

我已经看到有特定的格式可以将 MIPS 汇编指令转换为机器代码。应该有类似的过程来手动将 PIC 程序集转换为机器代码。任何人都可以向我提供与此相关的文档吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T08:54:46.583

Microchip 数据表都有指令集参考，包括指令的编码方式。请注意，大多数系列完全不同（即 16 和 18 系列并不相似），因此请确保您获得正确的数据表。

这是 16F627A 的示例，取自[PIC16F627A 数据表](http://ww1.microchip.com/downloads/en/DeviceDoc/40044G.pdf)的第 118 页： ![PIC16指令集参考](../Images/cd53151aa3ba20b3bd310b0d037bd78d.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:08:57.817

像[本手册](http://ww1.microchip.com/downloads/en/devicedoc/prog_ref_manual.pdf)这样的东西应该做。

但无法抗拒：为什么要手动操作？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:28:38.757

您可能正在寻找 MIPS32® M4K® 核心指令集。[如果是这样，您可以在MIPS 主页](http://www.mips.com/products/processor-cores/mips32-m4k/)上找到所有相关信息。

# android - 有没有办法知道哪个应用程序提供 GPS 时间，以便我可以处理 16 秒闰秒校正？

> ID：12173151
> 
> 赞同：1
> 
> 时间：2012-08-29T07:50:07.747
> 
> 标签：android, gps, gps-time

我有一个应用程序，它使用 GPS 来显示开始比赛的时间。它必须与大多数 GPS 设备（Garmin 等）上显示的内容一致。我使用一个外部 GPS 蓝牙模块和一个应用程序连接到 Android 系统来代替内部 GPS。问题在于，一些应用程序（蓝牙 GPS）提供更正的时间（实时），而一些应用程序（蓝牙 GPS 提供程序）没有对自 GPS 启动以来累积的 16 个闰秒进行校正。

如果我知道哪个应用程序在提供数据，那么添加 16 秒对我来说是微不足道的。我想我可以编写自己的蓝牙界面，但如果我知道用户正在使用哪个蓝牙界面就容易多了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:59:46.150

我联系了蓝牙 GPS 提供商的开发人员，他将他的应用程序更改为使用 GPS 时间。问题解决了

# qt - Qt：动态小部件信号和槽连接

> ID：12173153
> 
> 赞同：2
> 
> 时间：2012-08-29T07:50:13.167
> 
> 标签：qt, dynamic, signals-slots

在我的 Qt 应用程序中，我动态地创建了一些小部件。其中包括需要具有类似行为的 QToolButton。

以下是小部件的创建方式：

```
QMap<QString, QToolButton*> unselectButtonMap;
foreach(QString instance, ...) {
  unselectButtonMap[instance] = new QToolButton;
  myLayout->addWidget(unselectButtonMap[instance]);
  QObject::connect(unselectButtonMap[instance],SIGNAL(clicked()),this,SLOT(unselectInstance()));
} 
```

现在我想让`unselectInstence`插槽知道涉及哪个实例。

我首先考虑将实例名称作为参数提供给插槽，但插槽仅从信号中获取参数。这个想法是这样的：

```
QObject::connect(unselectButtonMap[instance],SIGNAL(clicked()),this,SLOT(unselectInstance(instance))); 
```

关于如何做到这一点的任何其他想法？

注意：我使用的是 Qt4.8

**编辑：**基于**shan**的回答，因为我需要实例名称而不是 QToolButton 本身，这就是我想出的

```
void MyWindow::unselectInstance() {
  foreach(QString instance, unselectButtonMap.keys()) {
    if(unselectButtonMap[instance] == QObject::sender()) {
      //do stuff here...
    }
  }
} 
```

指针比较似乎工作得很好。

**重新编辑：**根据**user1313312**的回答，我们将声明一个 QSignalMapper：

```
QSignalMapper *signalMapper = new QSignalMapper(this);
QObject::connect(signalMapper, SIGNAL(mapped(QString)), this, SLOT(unselectInstance(QString))); 
```

然后将 QToolButton 连接到映射器

```
signalMapper->setMapping(unselectButtonMap[instance], instance);
QObject::connect(unselectButtonMap[instance],SIGNAL(clicked()),signalMapper,SLOT(map())); 
```

并且插槽会简单得多：

```
void MyWindow::unselectinstance(QString instance) {
  //do stuff here...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:00:17.500

在您的插槽内使用`QObject::sender()`以获取发件人。它将返回发出信号的对象。希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:35:25.880

虽然使用`QObject::sender()`非常好，但理想的方法是[QSignalMapper](http://qt-project.org/doc/qt-4.8/qsignalmapper.html "QSignalMapper")

# opencv - 使用 OpenCV cvProjectPoints2 函数

> ID：12173155
> 
> 赞同：1
> 
> 时间：2012-08-29T07:50:32.520
> 
> 标签：opencv, computer-vision

我只是想测试一下这个功能。[然而，它在开始](https://stackoverflow.com/questions/7624293/opencv-homogeneous-coordinates-are-not-supported-when-using-cvprojectpoints2)时出现了一些不全面的错误，我终于找到了解决方案。也就是说：必须将两者`objectPoints`&分别`imagePoints`更改为`CV_32FC3`& `CV_32FC2`，代码工作正常。为此，OpenCV 的文档非常错误，这表明所有矩阵表示都可以工作

克服这个错误，我的输出不正确：

![在此处输入图像描述](../Images/7dcb61f7c9a8792e3b7f70329dac7007.png)

投影的图像点是不合理的（当然，我已经检查了我的输入数据）。

有没有人体验过OpenCV的这个功能，给出正确的投影？

编辑01：输出（2,2）= -1.#QNAN000

=> 这可以成为了解错误原因的线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T07:39:59.273

原因是我缺乏使用 OpenCV 矩阵的经验。工作 2 天后，使用 CvMat 和 Mat 进行测试。我学到了几个要点：

*   创建一个好的矩阵显示功能，这样它就不会显示尴尬的数字，我从这篇文章中找到了很好的建议[Multi channel Mat display function](https://stackoverflow.com/questions/12179059/multi-channel-mat-display-function/12179129#12179129)

*   使用预定义数据输入/初始化 OpenCV 矩阵时要小心，小心使用 1 通道或多通道矩阵。在您了解 OpenCV 如何理解您的输入数据之前，先进行一些试验

*   承认 cvProjectPoints2 没有得到单通道矩阵作为输入/输出

经过调试，我的输出是这样的：

![在此处输入图像描述](../Images/6353861aa23692e9ad4418a0d8202cba.png)

这与我的真实对象点和图像点以及校准的相机矩阵非常接近

# c# - 如何通过脚本访问用户控件值

> ID：12173162
> 
> 赞同：-1
> 
> 时间：2012-08-29T07:50:50.933
> 
> 标签：c#, javascript, user-controls

我有一个用户控件，其中包含一个由复选框组成的数据列表。由于我无法通过脚本传递用户控件，我试图用选定的值形成一个标签，我该怎么做

```
<asp:DataList id="checkedDataList" runat="server" RepeatLayout="Flow" BorderStyle="Inset" BorderWidth="1px"
            Width="100%" style="OVERFLOW: auto" BackColor="White" Height="150px" CssClass="bodytext">
            <ItemTemplate>
                <asp:CheckBox id=chkBxItems CssClass="bodytext" Text='<%# DataBinder.Eval(Container.DataItem, "Name") %>' runat="server" BackColor="White" ToolTip='<%# DataBinder.Eval(Container.DataItem, "Name") %>'>
                </asp:CheckBox>
                <asp:Label id=lblID Text='<%# DataBinder.Eval(Container.DataItem, "ID") %>' runat="server" Visible="False">
                </asp:Label>
            </ItemTemplate>
        </asp:DataList> 
```

这是我正在使用的用户控件。如果我将 autopostback='true' 赋予复选框，我将获得选中的值，但会从调用服务器返回错误。如果没有自动回发调用服务器调用服务器端方法，但无法获取检查值

```
 currentPageStatus = document.getElementById("lblStatus").innerText;
    var iv='<%= ucchkLst.funcGetcheckedIDString() %>';
    document.getElementById("lblChkdids").innerText = iv;
    CallServer(currentPageStatus,''); 
```

如果复选框的 autopostback=true 我得到了我想要的 iv，但在调用服务器返回错误。如果 autopostback not set iv 为空且 callserver 成功

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T07:57:16.657

您可以在用户控件中使用公共属性并传递选定的值

```
public StringBuilder YourValues
{
   get;
   set; 
} 
```

如果你想得到这个属性，只需尝试你的 aspx

```
UserControl uc = (UserControl)this.FindControl("yourId"); 
```

var 结果 = uc.YourValues.ToString();

您可以获得复选框值

```
YourValues = new StringBuilder();
foreach (DataListItem item in myDataList.Items)
{
   var myCheckBox = (CheckBox)item.FindControl ("myCheckBoxId");
   if(myCheckBox.Selected)
   {
     YourValues.Append(myCheckBox.Text);
   }
} 
```

# java - 更改希伯来字母 iText 的书面文本方向

> ID：12173167
> 
> 赞同：2
> 
> 时间：2012-08-29T07:51:15.750
> 
> 标签：java, itext

当我在 PDF 上写希伯来字母时，它们从左到右出现。

我怎样才能改变方向？

我正在使用`Paragraph`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:17:17.670

看看这个[例子](http://itextpdf.com/examples/iia.php?id=204)：

```
Document document = new Document(PageSize.A4);
String filename = ""; // Set the relative path and name for the output file
PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(filename));
document.open();
// Fix the path to the font if needed
BaseFont bf = BaseFont.createFont("c:/windows/fonts/arial.ttf", BaseFont.IDENTITY_H, true);
Font font = new Font(bf, 14);
ColumnText column = new ColumnText(writer.getDirectContent());
column.setSimpleColumn(36, 770, 569, 36);
column.setRunDirection(PdfWriter.RUN_DIRECTION_RTL);
String text = "הטקסט שלך בעברית"; // Your text in hebrew
column.addElement(new Paragraph(text, font));
column.go();
document.close(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-20T11:55:44.793

我做了一些简单的函数来处理这个问题。它只是将文本翻转到另一侧并将其作为一个短语返回，您可以将其添加到文档中。列的问题是您需要有关您要写的地方的精确信息。我还建议使用 PdfContentByte 在更精确的位置书写。

```
public Phrase makingPhrases(string toPhrase, bool toReverse,int SF)
{

    BaseFont unicode = BaseFont.CreateFont(Server.MapPath("font/mriam.ttf"), BaseFont.IDENTITY_H, BaseFont.EMBEDDED);
    Font bold = new Font(unicode, SF);
    if (toReverse)
        return new Phrase(revertText(toPhrase), bold);
    else
        return new Phrase(toPhrase, bold);
}
public string revertText(string revertTo)
{
    string toret = "";
    for (int i = 0; i < revertTo.Length; i++)
    {
        toret += revertTo[revertTo.Length - i - 1];
    }
    return toret.ToString();
} 
```

# width - 图像滑块宽度比包装器宽，当它到达站点的适当宽度时不会溢出和居中

> ID：12173172
> 
> 赞同：0
> 
> 时间：2012-08-29T07:51:44.227
> 
> 标签：width, overflow, css

我目前正在构建一个 WordPress 网站，但有一个滑块问题。

幻灯片图像宽 1200 像素，但网站宽 945 像素。我需要图像始终保持居中。当浏览器拉伸到超过 1200 像素宽时很好，但是一旦您将大小调整到 1100 像素左右并且更小，滑块图像不会溢出页面的左侧，它会碰到左侧浏览器的边缘并且不会不再居中并向右推，所以我的图像的额外部分应该溢出浏览器，但这不是出于某种原因。

这是页面向下滚动时的外观图像，文字应始终在左侧与其余内容对齐，例如其下方的图像，两侧大约有 100px，但在右侧淡出，所以它需要走得更远，然后是 945px 宽度：

![](../Images/a7a861e1542e2b412755d377f67fd17f.png)

这是我的 CSS 及其缓动滑块 WordPress 插件：

```
section#slider-wrapper {
width:100%;
height:330px;
margin-bottom: 32px;
position: relative;
overflow: visible;
z-index: 1;
-webkit-box-shadow: 0px 0px 11px #eee;
   -moz-box-shadow: 0px 0px 11px #eee;
        box-shadow: 0px 0px 11px #eee;      
background: url(images/slider-bg.jpg) #fff center repeat;       
}

#slider-wrapper #slides {
z-index:100;
height:330px;
width: 1200px;
margin: 0 auto;
position: relative;
 }
 #slider-wrapper .slides_container {
width:100%;
overflow:hidden;
position:absolute;
 }
 #slider-wrapper .slides_container div.slide, #slider-wrapper .slides_container div.slide img {
width:100%;
height:330px;
display:block;
  }
  #slider-wrapper .slides_container div.slide img {
width:1200px;
height:330px;
display:block;
  } 
```

这是HTML：

```
<section id="slider-wrapper">
<div id="slides">
        <div class="slides_container">
         <!-- Easing Slider -->
             <div class="lof-container" style="height:330px;padding-right:0px;padding-top:0px;padding-left:0px;padding-bottom:0px;">
             <div class="lof-slidecontent" id="lofslidecontent45" style="border:0px solid #ccc;width:1200px;height:330px;">
             <div class="preload" style="padding-top:1px\9;background:url(wp-content/plugins/easing-slider/images/indicator.gif) no-repeat center center #;">

       </div>
        <div class="lof-main-outer" style="background: #;width:1200px;height:330px;">
            <ul class="lof-main-wapper">
               <li><img src="wp-content/uploads/2012/08/slide_1.jpg" style="width:1200px;" alt="" /></li>       
               <li><img src="wp-content/uploads/2012/08/slide_2.jpg" style="width:1200px;" alt="" /></li>
           </ul>
         </div>
        </div>
      </div><!-- End of Easing Slider -->       
     </div>
</div>  
<div class="clear"></div>
  </section><!-- END OF SECTION#SLIDER-WRAPPER --> 
```

我已经尝试过溢出，最小宽度似乎无法让它工作/

这是它在我的浏览器中如何工作的 jFiddle 版本，红线永远不会溢出。

[http://jsfiddle.net/strohy85/8dQ96/](http://jsfiddle.net/strohy85/8dQ96/)

# excel - 如何通过标签模仿旋转按钮？

> ID：12173175
> 
> 赞同：1
> 
> 时间：2012-08-29T07:51:48.760
> 
> 标签：excel, vba

我的表格上有两个标签

```
lab01_Click:
lab02.Caption = lab02.Caption + 1 
```

有没有办法将 lab01 用作旋转按钮？
如果我一直按下它 - 那么 lab02.Caption 应该不断变化吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:33:34.940

您也可以将数据存储在 Tag 属性中

例如

```
Private Sub Label1_Click()
If Label1.Tag = "" Then Label1.Tag = 0
 Label1.Tag = CLng(Label1.Tag) + 1
 Label1.Caption = "Increment: " & Label1.Tag
End Sub

Private Sub Label2_Click()
If Label1.Tag = "" Then Label1.Tag = 0
 Label1.Tag = CLng(Label1.Tag) - 1
 Label1.Caption = "Increment: " & Label1.Tag
End Sub 
```

更新：好的，我看到如果单击被按下，您希望保持递增。我能想到的唯一方法是重新触发计时器事件的令人讨厌的“黑客”。您将需要更新对象名称`Userform1`，`Label1`并且`Label2`可能需要`Private Declare Function`针对`Private Declare PtrSafe Function`64 位进行调整

试试这个`MODULE`

```
Option Explicit

Private Declare Function SetTimer Lib "user32" _
(ByVal hWnd As Long, _
ByVal nIDEvent As Long, _
ByVal uElapse As Long, _
ByVal lpTimerFunc As Long) As Long

Private Declare Function KillTimer Lib "user32" _
(ByVal hWnd As Long, _
ByVal nIDEvent As Long) As Long

Private m_TimerID As Long

 'Note:  The duration is measured in milliseconds.
 '         1,000 milliseconds = 1 second
Public Sub StartTimer(ByVal Duration As Long)
     'If the timer isn't already running, start it.
    If m_TimerID = 0 Then
        If Duration > 0 Then
            m_TimerID = SetTimer(0, 0, Duration, AddressOf TimerEvent)
            If m_TimerID = 0 Then
                MsgBox "Timer initialization failed!"
            End If
        Else
            MsgBox "The duration must be greater than zero."
        End If
    Else
        MsgBox "Timer already started."
    End If
End Sub

Public Sub StopTimer()
     'If the timer is already running, shut it off.
    If m_TimerID <> 0 Then
        KillTimer 0, m_TimerID
        m_TimerID = 0
    Else
        MsgBox "Timer is not active."
    End If
End Sub

Public Property Get TimerIsActive() As Boolean
     'A non-zero timer ID indicates that it's turned on.
    TimerIsActive = (m_TimerID <> 0)
End Property

Private Sub TimerEvent()
    If UserForm1.Label2.Tag = "" Then UserForm1.Label2.Tag = 0
    UserForm1.Label2.Tag = CLng(UserForm1.Label2.Tag) + 1
    UserForm1.Label2.Caption = "Increment : " & UserForm1.Label2.Tag
End Sub 
```

而这在`USERFORM`

```
Option Explicit

Private Sub Label1_MouseDown(ByVal Button As Integer, _
    ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    StartTimer 200 'millisecond update
End Sub

Private Sub Label1_MouseUp(ByVal Button As Integer, _
    ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    StopTimer
End Sub 
```

# python - 如何通过列表更改 Turtle 中形状的颜色

> ID：12173176
> 
> 赞同：0
> 
> 时间：2012-08-29T07:51:52.307
> 
> 标签：python, turtle-graphics

我想知道是否有一种方法可以制作颜色列表，例如`shape_color = ['red', 'blue', 'green']`，并将该列表分配给单个`onkey()`键盘键，以便每当我按下该键时，它会在颜色列表中循环，改变海龟的颜色？我的程序是 Python 海龟图形，您可以在其中移动光标，将不同的形状印入屏幕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T03:46:21.567

```
shape_color = ['red', 'blue', 'green'] # list of colors
idx = 0 # index for color list

# Callback for changing color
def changecolor():
    idx = (idx+1) % len(shape_color) # Increment the index within the list bounds
    fillcolor(shape_color[idx]) # Change the fill color

# Register the callback with a keypress.
screen.onkey(changecolor, "c") 
```

现在，每次您按下该`c`键时，您的**填充颜色**都会改变，在您定义的列表中循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-09T00:41:57.273

@jfs 对 @Aesthete 示例的修复的完整版本：

```
from turtle import Screen, Turtle
from itertools import cycle

shape_colors = ['red', 'blue', 'green', 'cyan', 'magenta', 'yellow', 'black']

def change_color(colors=cycle(shape_colors)):
    turtle.color(next(colors))

turtle = Turtle('turtle')
turtle.shapesize(5)  # large turtle for demonstration purposes

screen = Screen()
screen.onkey(change_color, 'c')
screen.listen()
screen.mainloop() 
```

# android - 在 html5 中开发和使用 phonegap 是否有（以及有什么区别）？

> ID：12173182
> 
> 赞同：0
> 
> 时间：2012-08-29T07:52:11.077
> 
> 标签：android, html, cordova

如果我们在不使用 phonegap 库的情况下使用纯 html5 开发 android 应用程序和使用 Phonegap 有什么区别？这可能听起来很菜鸟，但我真的没有得到这两者之间的联系？

为什么我需要phonegap？为什么不只创建 html5 文件并提供它的路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T07:55:09.013

PhoneGap 为您提供了一个抽象层，以便您的应用程序可以访问非 browserView 可访问的功能，例如相机。这些在所有移动平台上都是相同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:02:44.783

您可以使用带有 webview 的纯 html5 和用于处理移动事件（如呼叫、消息传递、传感器等）的 java 方法创建应用程序。

当您使用 phonegap 库时，无需对 java 方法做太多工作。phonegap 库将处理 java，您只能在 jquery 移动框架的一点帮助下使用 html5 和 java 脚本。您可以直接在 html 页面的 javascript 中调用的所有移动事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T08:04:14.890

使用 HTML5 和 PhoneGap，您可以实现不同类型的应用程序：

*   使用 HTML5 的移动应用程序。您将需要一个服务器来备份您的应用程序，用户将通过设备的浏览器运行它。
*   使用 HTML5 和 WebView 的本机应用程序。不需要使用服务器。在这种情况下，您编写 HTML5 代码（HTML、CSS、Javascript）并使用 WebView 来显示它。您可以使用特殊接口与 Java 进行交互。
*   PhoneGap 使上述情况更容易。您不需要知道 WebView 的详细信息。您需要 PhoneGap API 来与手机的资源进行交互。作为额外的奖励，您可以轻松地将应用程序移植到其他平台。PhoneGap 还创建本地应用程序。

# c# - .net 客户端使用 X509 证书和用户名/密码身份验证调用 JAX-WS Web 服务

> ID：12173190
> 
> 赞同：2
> 
> 时间：2012-08-29T07:52:43.877
> 
> 标签：c#, web-services, app-config, x509certificate, webservice-client

我从 .net 客户端使用 JAX-WS Webservice 时遇到问题。我能够打开到 WS 的连接，但是当我尝试使用任何方法时，我得到了这个错误：

我得到的第一个错误是：

`Identity check failed for outgoing message. The expected DNS identity of the remote endpoint was 'amms.someDomain.com' but the remote endpoint provided DNS claim '*.someDomain.com'. If this is a legitimate remote endpoint, you can fix the problem by explicitly specifying DNS identity '*.someDomain.com' as the Identity property of EndpointAddress when creating channel proxy.`

我的 app.config 看起来像：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<system.serviceModel>
        <customBinding>
            <binding name="SrvPortBinding">
                <security defaultAlgorithmSuite="Basic128" authenticationMode="UserNameForCertificate"
                    requireDerivedKeys="false" securityHeaderLayout="Strict" includeTimestamp="true"
                    keyEntropyMode="CombinedEntropy" messageProtectionOrder="SignBeforeEncrypt"
                    messageSecurityVersion="WSSecurity11WSTrust13WSSecureConversation13WSSecurityPolicy12BasicSecurityProfile10"
                    requireSignatureConfirmation="false">
                    <localClientSettings cacheCookies="true" detectReplays="true"
                        replayCacheSize="900000" maxClockSkew="00:05:00" maxCookieCachingTime="Infinite"
                        replayWindow="00:05:00" sessionKeyRenewalInterval="10:00:00"
                        sessionKeyRolloverInterval="00:05:00" reconnectTransportOnFailure="true"
                        timestampValidityDuration="00:05:00" cookieRenewalThresholdPercentage="60" />
                    <localServiceSettings detectReplays="true" issuedCookieLifetime="10:00:00"
                        maxStatefulNegotiations="128" replayCacheSize="900000" maxClockSkew="00:05:00"
                        negotiationTimeout="00:01:00" replayWindow="00:05:00" inactivityTimeout="00:02:00"
                        sessionKeyRenewalInterval="15:00:00" sessionKeyRolloverInterval="00:05:00"
                        reconnectTransportOnFailure="true" maxPendingSessions="128"
                        maxCachedCookies="1000" timestampValidityDuration="00:05:00" />
                    <secureConversationBootstrap />
                </security>
                <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
                    messageVersion="Soap11WSAddressing10" writeEncoding="utf-8">
                    <readerQuotas maxDepth="32" maxStringContentLength="98192" maxArrayLength="916384"
                        maxBytesPerRead="94096" maxNameTableCharCount="916384" />
                </textMessageEncoding>
                <httpsTransport manualAddressing="false" maxBufferPoolSize="9524288"
                    maxReceivedMessageSize="965536" allowCookies="false" authenticationScheme="Anonymous"
                    bypassProxyOnLocal="false" decompressionEnabled="true" hostNameComparisonMode="StrongWildcard"
                    keepAliveEnabled="true" maxBufferSize="965536" proxyAuthenticationScheme="Anonymous"
                    realm="" transferMode="Buffered" unsafeConnectionNtlmAuthentication="false"
                    useDefaultWebProxy="true" requireClientCertificate="false" />
            </binding>
        </customBinding>
    </bindings>
    <client>
      <endpoint address="https://amms.someDomain.com:443/mmew1/Srv"
          binding="customBinding" bindingConfiguration="SrvPortBinding"
          contract="InfoMedica1.Srv" name="SrvPort" >

      </endpoint>            
    </client>
</system.serviceModel> 
```

`

然后我改变了这个：

```
<client>
      <endpoint address="https://amms.someDomain.com:443/mmew1/Srv"
          binding="customBinding" bindingConfiguration="SrvPortBinding"
          contract="InfoMedica1.Srv" name="SrvPort" >

      </endpoint>            
    </client> 
```

到：

```
<client>
      <endpoint address="https://amms.someDomain.com:443/mmew1/Srv"
          binding="customBinding" bindingConfiguration="SrvPortBinding"
          contract="InfoMedica1.Srv" name="SrvPort" >
        <identity>
          <dns value="*.someDomain.com"/>
        </identity>
      </endpoint>            
    </client> 
```

现在我有异常： `An unsecured or incorrectly secured fault was received from the other party. See the inner FaultException for the fault code and detail.` **内部异常：**`Invalid Security Header`

有没有人遇到这种错误并让它工作？这个错误会因为这个`*`字符而发生`*.someDomain.com`吗？

我检查了服务器和客户端的时间是一样的。在添加此 X509 和用户名/密码身份验证之前，Web 服务工作正常。

如果需要任何进一步的信息，请在评论中询问:)

**编辑：**

当我尝试像这样禁用服务证书验证时：

```
<client>
      <endpoint address="https://amms.someDomain.com:443/mmew1/Srv"
          binding="customBinding" bindingConfiguration="SrvPortBinding"
          contract="InfoMedica1.Srv" name="SrvPort" behaviorConfiguration="DisableServiceCertificateValidation">
        <identity>
          <dns value="*.someDomain.com"/>
        </identity>
      </endpoint>            
    </client> 
```

出现异常：

```
There is no endpoint behavior named 'DisableServiceCertificateValidation' 
```

感谢提前:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T09:12:05.500

这是网络服务的问题。写它的人改变了一些东西，不确定到底是什么，但它开始起作用了:)

也许有人有类似的问题，所以在这里;）

感谢所有感兴趣的人的帮助；）

# ruby-on-rails - 是否可以将 :git 源添加到 .gemspec 作为依赖项？

> ID：12173202
> 
> 赞同：1
> 
> 时间：2012-08-29T07:53:41.470
> 
> 标签：ruby-on-rails, rubygems, bundler

我有多个相互依赖的宝石，比如：

```
core - base stuff
module 1 - uses core
module 2 - uses core 
```

我想在应用程序 1、2 和 3 中使用它们。

```
application 1 - uses module 1
application 2 - uses module 2
application 3 - also uses module 2 
```

现在我想在模块 1 和 2 的 .gemspec 中做的事情是：

```
Gem::Specification.new do |s|
  s.add_dependency "core", :git => "git@mygit.com/core.git"
end 
```

这在某种程度上可能吗？上面的代码让我得到“不正确的要求”错误。

让它工作的解决方案是添加`gem "core", :git => "localpath/core.git"`应用程序 1、2、3 的每个 Gemfile。这显然是我想避免的，我需要 gem 从 gem 本身给定的源中检索它们的依赖关系。

# javascript - javascript页面加载发生在按钮单击

> ID：12173204
> 
> 赞同：1
> 
> 时间：2012-08-29T07:53:52.467
> 
> 标签：javascript, asp.net

我的问题是当我单击带有 id="cmdAddATM" 整个 .aspx 页面重新加载的按钮时。即使我没有编写任何与之关联的单击功能。问题是什么？因为这个问题在我的项目中引起了一些与 ajax/jquery 相关的新问题

文件名：AddEditATM.aspx.cs

```
namespace Monitoring_Tool
{
    public partial class AddEditATM : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            Generix.fillDropDown(ref litRegion, Generix.getData("dbo.Region", "REGION, Code", "", "", "Code", 1));
        }
    }
} 
```

文件：AddEditATM.aspx

```
<script language="javascript" type="text/javascript">
    $(document).ready(function() {
        showAddEditATMLoad();
    });
</script>
<body>
// I an not writing full syntax here but i have one button with id "cmdAddATM"
</body> 
```

外部 JS 文件：

```
function showAddEditATMLoad() { 
    //Its Blank
} 
```

我的 HTML 代码：-

```
<table style="margin: 0px auto; width: 90%" runat="server">
  <thead>
      <tr>
          <th colspan="4" align="center" class="ui-widget-header PageHeader">
              ADD/EDIT ATM
          </th>
      </tr>
  </thead>
  <tbody style="vertical-align: bottom; border-style: solid; border-width: thick;">
      <tr>
          <td style="padding-left: 5px" colspan="2">
              Enter ATM ID &nbsp;<input id="txtEditATM" name="txtEditATM" type="text" />
              &nbsp;&nbsp;
              <button id="cmdEditATM">
                  EDIT ATM</button>
          </td>
          <td align="left" style="font-weight: bold" colspan="1">
              OR
          </td>
          <td align="center" colspan="2">
              <button id="cmdAddATM">
                  ADD ATM</button>
          </td>
      </tr>
  </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:57:37.987

如果您的按钮是一个`<asp:Button runat="server" />`将`<input type="submit" />`在浏览器上呈现的按钮。因此，它将回发您的页面。

**已编辑**：添加带有标签的`type="button"`属性，`<button>`标签的类型属性`<button>`具有三个值，并且在您的案例中获得的标签的默认值是提交，这就是提交表单的原因。

```
1\. Submit - For Submitting a Form
2\. Reset - For Resetting the Form
3\. button - A Simple Button 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:04:34.097

将类型属性添加到`<button>`标签。

```
<button id="cmdEditATM" type='button'>EDIT ATM</button> 
```

SO线程

1.  [与.. 使用哪个？](https://stackoverflow.com/questions/469059/button-vs-input-type-button-which-to-use)
2.  [输入类型=“提交”与按钮标签它们可以互换吗？](https://stackoverflow.com/questions/7117639/input-type-submit-vs-button-tag-are-they-interchangeable)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T08:04:46.233

如果您使用的是`asp:Button`对象，则可以使用该[`OnClientClick`](http://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.button.onclientclick%28v=vs.110%29)属性或仅使用 jQuery 来运行一些客户端代码。您可以`false`退出 javascript click 事件处理程序（或使用 jQuery 的`event.preventDefault()`方法）来停止回发。

如果您不希望此按钮发生回发，只需使用普通的 HTML 按钮 ( `<input type="button" ... />`)。如果您需要在服务器端访问此按钮，只需为其添加 normal`runat="server"`属性即可。

请注意，HTML`<input type="submit"/>`按钮将导致回发，因为它将在页面上提交表单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T08:04:50.810

为您的按钮添加`type="button"`属性。`button`不同的浏览器可能对元素使用不同的默认类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T08:01:51.867

在 asp.net 中，如果您添加任何 asp 按钮，它会自动将 asp 按钮转换为提交按钮，因此用 HTML 按钮替换 asp 按钮

```
<input type="button" id='cmdAddATM' value="Button" /> 
```

# c# - 使用 C# 研究目录及其子目录中文本的有效搜索

> ID：12173205
> 
> 赞同：1
> 
> 时间：2012-08-29T07:53:53.047
> 
> 标签：c#, .net, windows, batch-file

我正在尝试在属于某个目录的某些文件中搜索特定出现的字符串。（搜索也在子目录中进行。目前，我想出了一个类似这样的解决方案。

1.  获取目录及其子目录中的所有文件名。
2.  一个一个地打开文件。
3.  搜索特定字符串
4.  如果包含，则将文件名存储在数组中。
5.  继续这个直到最后一个文件。

    ```
    string[] fileNames = Directory.GetFiles(@"d:\test", "*.txt", SearchOption.AllDirectories);
    foreach (string sTem in fileNames)
    {
        foreach (string line in File.ReadAllLines(sTem))
        {
            if (line.Contains(SearchString))
            {
                MessageBox.Show("Found search string!");
                break;
            }
        }
    } 
    ```

我认为还有其他方法/方法比这更有效和更快吗？使用批处理文件？好的。另一种解决方案是使用 findstr （但是如何在没有批处理文件的情况下直接与 C# 程序一起使用它？什么是最有效的（或者比我做的更有效？）非常感谢代码示例！

找到了另一个解决方案。

```
Process myproc = new Process();
myproc.StartInfo.FileName = "findstr";
myproc.StartInfo.Arguments = "/m /s /d:\"c:\\REQs\" \"madhuresh\" *.req";
myproc.StartInfo.RedirectStandardOutput = true;
myproc.StartInfo.UseShellExecute = false;

myproc.Start();
string output = myproc.StandardOutput.ReadToEnd();
myproc.WaitForExit(); 
```

这种流程的执行好不好？也欢迎对此发表评论！

根据@AbitChev 的方法，圆滑的（不知道有没有效率！）。不管怎样，事情就这样继续下去。这个搜索所有目录以及子目录！

```
IEnumerable<string> s = from file in Directory.EnumerateFiles("c:\\directorypath", "*.req", SearchOption.AllDirectories)
                   from str in File.ReadLines(file)
                   //where str.Contains("Text@tosearched2")
                   where str.IndexOf(sSearchItem, StringComparison.OrdinalIgnoreCase) >= 0
                   select file;

        foreach (string sa in s)
            MessageBox.Show(sa); 
```

（用于不区分大小写的搜索。也许这可以帮助某人。）请评论！谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:20:44.503

使用`Directory.EnumerateFiles()`and `File.ReadLines()`- 两者都提供数据的延迟加载：

```
from file in Directory.EnumerateFiles(path)
from arr in File.ReadLines(file)
from str in arr
where str.Contains(pattern)
select new 
{
    FileName = file, // file containing matched string
    Line = str // matched string
}; 
```

或者

```
foreach (var file in Directory.EnumerateFiles(path).AsParallel())
{
    try
    {
        foreach (var arr in File.ReadLines(file).AsParallel())
        {
            // one more try here?
            foreach (var str in arr)
            {
                if (str.Contains(pattern))
                {
                    yield return new 
                    {
                        FileName = file, // file containing matched string
                        Line = str // matched string
                    };
                }
            }
        }
    }
    catch (SecurityException)
    {
        // swallow or log
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:18:30.563

这样的事情怎么样

```
var found = false;
string file;

foreach (file in Directory.EnumerateFiles(
            "d:\\tes\\",
            "*.txt",
            SearchOption.AllDirectories))
{
    foreach(var line in File.ReadLines(file))
    {
        if (line.Contains(searchString))
        {
            found = ture;
            break;
        }
    }

    if (found)
    {
            break;
    }
}

if (found)
{
    var message = string.Format("Search string found in \"{0}\".", file)
    MessageBox.Show(file);
} 
```

这样做的好处是只将需要的内容加载到内存中，而不是所有文件的名称，然后是每个文件的内容。

* * *

我注意到你正在使用[`String.Contains`](http://msdn.microsoft.com/en-us/library/dy85x1sa.aspx)哪个

> 执行序数（区分大小写和不区分区域性）比较

这将使我们能够进行简单的字符比较。

我将从一个小辅助功能开始

```
private static bool CompareCharBuffers(
    char[] buffer,
    int headPosition,
    char[] stringChars)
{
    // null checking and length comparison ommitted

    var same = true;
    var bufferPos = headPosition;
    for (var i = 0; i < stringChars.Length; i++)
    {
        if (!stringChars[i].Equals(buffer[bufferPos]))
        {
            same = false;
            break;
        }

        bufferPos = ++bufferPos % (buffer.Length - 1);
    }

    return same;
} 
```

然后我会改变以前的算法来使用这样的函数。

```
var stringChars = searchString.ToCharArray();
var found = false;
string file;

foreach (file in Directory.EnumerateFiles(
            "d:\\tes\\",
            "*.txt",
            SearchOption.AllDirectories))
{
    using (var reader = File.OpenText(file))
    {
        var buffer = new char[stringChars.Length];
        if (reader.ReadBlock(buffer, 0, buffer.Length - 1) 
                < stringChars.Length - 1)
        {
            continue;
        }

        var head = 0;
        var nextPos = buffer.Length - 1;
        var nextChar = reader.Read();
        while (nextChar != -1)
        {
            buffer[nextPos] = (char)nextChar;

            if (CompareCharBuffers(buffer, head, stringChars))
            {
               found = ture;
               break;
            }

            head = ++head % (buffer.Length - 1);
            if (head == 0)
            {
                nextPos = buffer.Length - 1;
            }
            else
            {
                nextPos = head - 1;
            } 

            nextChar = reader.Read();
        }

        if (found)
        {
            break;
        }
    }
}

if (found)
{
    var message = string.Format("Search string found in \"{0}\".", file)
    MessageBox.Show(file);
} 
```

这仅`char`包含与搜索字符串在内存中包含的一样多的 s，并在每个文件中使用滚动缓冲区。从理论上讲，该文件可能不包含新行并占用您的整个磁盘，或者您的搜索字符串可能包含一个新行。

* * *

作为进一步的工作，我会将算法的每个文件部分转换为函数并研究多线程方法。

所以这将是内部函数，

```
static bool FileContains(string file, char[] stringChars)
{
    using (var reader = File.OpenText(file))
    {
        var buffer = new char[stringChars.Length];
        if (reader.ReadBlock(buffer, 0, buffer.Length - 1) 
                < stringChars.Length - 1)
        {
            return false;
        }

        var head = 0;
        var nextPos = buffer.Length - 1;
        var nextChar = reader.Read();
        while (nextChar != -1)
        {
            buffer[nextPos] = (char)nextChar;

            if (CompareCharBuffers(buffer, head, stringChars))
            {
               return true;
            }

            head = ++head % (buffer.Length - 1);
            if (head == 0)
            {
                nextPos = buffer.Length - 1;
            }
            else
            {
                nextPos = head - 1;
            } 

            nextChar = reader.Read();
        }

        return false;
    }
} 
```

然后你可以像这样并行处理文件

```
var stringChars = searchString.ToCharArray();

if (Directory.EnumerateFiles(
            "d:\\tes\\",
            "*.txt",
            SearchOption.AllDirectories)
    .AsParallel()
    .Any(file => FileContains(file, stringChars)))
{
    MessageBox.Show("Found search string!");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-30T17:29:39.963

这很好用。我在 0.5 毫秒内搜索了 230 个文件中的大约 500 个术语。这是非常占用内存的；它将每个文件加载到内存中

```
public class FindInDirectory
{
    public class Match
    {
        public string Pattern { get; set; }
        public string Directory { get; set; }
        public MatchCollection Matches { get; set; }
    }

    public static List<FindInDirectory.Match> Search(string directory, string searchPattern, List<string> patterns)
    {
        //find all file locations
        IEnumerable<string> files = System.IO.Directory.EnumerateFiles(directory, searchPattern, System.IO.SearchOption.AllDirectories);

        //load all text into memory for MULTI-PATERN
        //this greatly increases speed, but it requires a ton of memory!
        Dictionary<string, string> contents = files.ToDictionary(f => f, f => System.IO.File.ReadAllText(f));

        List<FindInDirectory.Match> directoryMatches = new List<Match>();

        foreach (string pattern in patterns)
        {
            directoryMatches.AddRange
            (
                contents.Select(c => new Match
                {
                    Pattern = pattern,
                    Directory = c.Key,
                    Matches = Regex.Matches(c.Value, pattern, RegexOptions.IgnoreCase | RegexOptions.Multiline)
                })
                .Where(c => c.Matches.Count > 0)//switch to > 1 when program directory is same or child of search
            );
        };

        return directoryMatches;
    }

} 
```

采用：

```
 static void Main(string[] args)
    {
        List<string> patterns = new List<string>
        {
            "class",
            "foreach",
            "main",
        };
        string searchPattern = "*.cs";
        string directory = "C:\\SearchDirectory";

        DateTime start = DateTime.UtcNow;

        FindInDirectory.Search(directory, searchPattern, patterns);

        Console.WriteLine((DateTime.UtcNow - start).TotalMilliseconds);
        Console.ReadLine();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:45:22.783

`Tasks.Dataflow`您可以使用（此 .dll 当前不是 .NET 4.5 的一部分，但您可以从[此处](http://msdn.microsoft.com/en-us/devlabs/gg585582.aspx)下载它）创建一个“管道”来使用所有文件并搜索显式字符串。看看这个[参考实现](http://msdn.microsoft.com/en-us/library/hh228604.aspx)。

# apache - Apache + url 重写

> ID：12173212
> 
> 赞同：0
> 
> 时间：2012-08-29T07:54:21.653
> 
> 标签：apache, url-rewriting

我遇到了“我的网站上的重定向太多”的 Apache 问题。我一直在尝试以不同的方式修复它，但我找不到解决方案。

```
referer = http://www.mysite.com/
lang = en | es | fr
page = page1, page2, page3

eg: referer/lang, referer/lang/
eg: referer/lang/page, referer/lang/page/
eg: referer/lang/something/apage, referer/lang/something/apage/ 
```

这是我的规则：

```
//Rewrite my ajax page location to avoid problems due to /lang/
RewriteRule ^(?:en|es|fr)/{0,1}ajax/ajax.php$ ajax/ajax.php [L]

//Rewrite /lang without page
RewriteRule ^(en|es|fr)/{0,1}$ /?lang=$1 [L]

//Rewrite referer/lang/something/unepage
RewriteRule ^(en|es|fr)/(somethinges|somethingfr|somethingen)/(apage1|apage2|apage3)$ /?lang=$1&page=$3 [L]

//Rewrite /lang/page
RewriteRule ^(en|es|fr)/(.*)$ /?lang=$1&page=$2 [L] 
```

我试图用 %{HTTP_REFERER}?... 替换 /?...

# oracle - 在不删除数据的情况下更改 oracle 中的数据类型

> ID：12173214
> 
> 赞同：2
> 
> 时间：2012-08-29T07:54:39.430
> 
> 标签：oracle, oracle10g

```
Product Version Oracle 10g 
```

我在 oracle 中有一个表，里面有一些数据。有一列类型为 Number(10,0)。现在我想将其更改为 Number(10,2) 以允许小数。但要改变的是，oracle是不允许不删除现有数据的。我知道我可以进行数据备份-> 删除数据-> 更改类型-> 插入数据。但问题是有一个从序列中获取值的自动插入列。因此，当我将其插入回去时，这些 id 会改变....我不确定是否有人使用该 id 作为获取数据的键。那么如何在不更改ID的情况下更改它..

请帮忙..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T03:38:16.753

1.  添加新的 NUMBER(12,2) 列，但名称不同。
2.  更新新列，转换旧列中的所有值。
3.  删除旧列。
4.  用所需的名称重命名新列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T08:33:54.480

可能您希望 number(12,2) 保持精度。例如，number(7,2) 是一个小数点前 5 位和小数点后 2 位的数字。

或者，您可以禁用触发器/执行工作/启用触发器。

# javascript - Javascript - 逗号分隔的字母数字的正则表达式

> ID：12173215
> 
> 赞同：0
> 
> 时间：2012-08-29T07:54:40.900
> 
> 标签：javascript, regex, alphanumeric

我需要正则表达式

> 验证逗号分隔的字母数字字符串，长度为 3-5 个字符。
> 
> 字符串可能包含也可能不包含逗号。
> 
> 每个字符串必须有 3 到 6 个数字，最后一个 M。

例子-

```
12345M
1234M,12345M,11111M 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T07:57:26.037

试试这个

```
var re = /^(\d{3,6}M\,)*\d{3,6}M$/ 
```

示例代码

```
console.log(re.test("1234M,12345M,11111M"));  // true
console.log(re.test("12345M"));               // true
console.log(re.test("12345M,"));              // false 
```

# php - 如何更改 symfony2 中所有文本框的文本框默认大小

> ID：12173218
> 
> 赞同：1
> 
> 时间：2012-08-29T07:54:49.597
> 
> 标签：php, symfony, twig

我知道我可以在树枝上做到这一点

`{{ form_widget(form.age, { 'attr': {'size': '5'} }) }}`

但是，如果我想在我的表单和所有文本框中执行此操作怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:21:08.737

看看这个文档，它解释了关于在 symfony 中自定义表单渲染的所有内容：

[http://symfony.com/doc/current/cookbook/form/form_customization.html](http://symfony.com/doc/current/cookbook/form/form_customization.html)

例如，要自定义“整数”字段（用于“整数”属性的文本框）的呈现，请执行以下操作：

```
{% form_theme form _self %}

{% block integer_widget %}
    {% spaceless %}
        {% set type = type|default('number') %}
        {% set attr = attr|merge({'size': '5' }) %}
        {{ block('form_widget_simple') }}
    {% endspaceless %}
{% endblock %} 
```

[您可以在https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Twig/Resources/views/Form/form_div_layout.html.twig](https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Twig/Resources/views/Form/form_div_layout.html.twig)中查看每个字段的默认呈现方式

这适用于该特定模板中的所有表单。如果您想在多个模板中使用此自定义，则需要将其放在单独的模板中，文档中对此进行了全部说明

# ruby - 在哪里为 sidekiq 调度程序初始化 schedule.yml 文件

> ID：12173219
> 
> 赞同：3
> 
> 时间：2012-08-29T07:54:50.760
> 
> 标签：ruby, ruby-on-rails-3, scheduled-tasks, sidekiq

我有一个 config/schedule.yml 文件，其中包含用于在我的应用程序中重复作业的 cron。但我不确定在哪里/如何初始化该文件？在 Resque 中，我们曾经在 resque.rake 文件中对其进行初始化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T13:15:16.357

Sidekiq 并不是真正为重复性工作而设计的。引用[sidekiq github wiki 页面](https://github.com/mperham/sidekiq/wiki/Scheduled-Jobs)：

> 对于重复性任务，我建议使用与系统的 cron 集成的发条或任何时候的 gem 来安排任务。

我没有使用过sidekiq（但其他类似的工具，如delayed_job 和纯ruby 调度程序，如rufus_scheduler），但非基于cron 的工具的一个主要问题是保证重复作业将实际执行，并且只执行您想要的次数。在有乘客的典型生产环境中，很容易发生所有 ruby​​ 进程停止（因此根本不执行）或 20 个进程都试图执行相同的作业。

我们长期以来一直切换到编写重复性工作很有趣的地方，并且可以解决在您的系统中添加 cronjobs 的所有麻烦[。](https://github.com/javan/whenever)

如果你真的想要一个更简单的解决方案并且不需要可靠的执行[rufus_scheduler](https://github.com/jmettraux/rufus-scheduler)是一个选项

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-12-20T23:14:23.620

在 2018 年末，Sidekiq 提供了类似 cron（又名“定期”）作业调度的选项。

最简单的选择是购买 Sidekiq Enterprise，它为此功能提供官方支持。更便宜的选择是安装[https://github.com/ondrejbartas/sidekiq-cron](https://github.com/ondrejbartas/sidekiq-cron)，它（如写作）得到积极维护，下载量超过 400 万次。

# facebook - Facebook like - 删除提要显示中的域名

> ID：12173220
> 
> 赞同：1
> 
> 时间：2012-08-29T07:54:52.440
> 
> 标签：facebook, facebook-like

我正在为用户上传到我的应用的每个视频添加点赞按钮。点赞按钮href指向“http://mydomain.com/redirector.aspx?id=[uniqueId]”。当用户喜欢一个视频时，一切都按计划进行，但在提要中有一行显示“mydomain.com”域。
客户不想看到那条线，我找不到删除它的方法。
这与使用 fb.ui 提要发布时可以通过“caption”属性删除的行相同（我喜欢将其设置为“&-nbsp;”。
我尝试将“og:site_name”属性放在redirector.aspx，但这里没有运气。
有没有人有任何运气让这条线消失？
我想指出，问题不在于重定向后的 facebook scraper，它不是。问题是不知道使用什么 og 标签来使域行消失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T13:34:24.773

你可以试试这个：

在重定向 URL 上，查找 useragent `facebookexternalhit/1.1`。如果您看到这一点，请禁用重定向并改为显示 OG 标签。对于所有其他用户代理，请保持 URL 重定向不变。这将诱使 Facebook 在不关注 URL 的情况下抓取重定向页面上的 OG 标签，并且所有其他用户将看到重定向的 URL。

[我在我的网站](https://www.webniraj.com/2011/06/30/let-facebook-scrape-password-protected-pages-for-like-buttons/)上描述了这个过程，我过去曾为客户使用过它。实施后，使用调试工具测试重定向 URL 以确认其有效。

# iphone - 匹配的字典数组 - 其中一个数组不完全等于另一个

> ID：12173224
> 
> 赞同：0
> 
> 时间：2012-08-29T07:54:57.320
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我必须解决这个难题，过去几天我一直在努力。所以我有2个数组。

这是第一个：

```
 {
        categories =         (
                        {
                id = "user/06617213952393255174/label/Main Folder";
                label = "Main Folder";
            }
        );
        firstitemmsec = 1297785485208;
        htmlUrl = "http://awebslife.tumblr.com/";
        id = "feed/http://awebslife.tumblr.com/rss";
        sortid = D5DB1FE2;
        title = "awebslife.tumblr.com/rss";
    },
        {
        categories =         (
                        {
                id = "user/06617213952393255174/label/Main Folder";
                label = "Main Folder";
            }
        );
        firstitemmsec = 1344454207448;
        htmlUrl = "http://awholelotofnothing.net";
        id = "feed/http://awholelotofnothing.net/feed/";
        sortid = 7098B8F7;
        title = "awholelotofnothing.net/feed/";
    }, 
```

如您所见，有 2 个对象，字典。在我的真实应用程序中，它们是更多的对象，但这只是一个例子。另一个数组：

```
 {
    count = 4;
    id = "feed/http://awebslife.tumblr.com/rss";
    newestItemTimestampUsec = 1346087733278957;
     }, 
```

所以这是实际的问题。我正在尝试将第二个数组与第一个数组匹配并将它们组合，但正如您所见，第二个数组只有计数大于 0 的对象。在我的情况下，在第一个数组中，我的第二个对象的计数为 0。所以如果我匹配它们，在组合到一个数组后，我只剩下一个对象，而另一个我不知道如何为它放置类似 count = 0 的东西。这是我匹配它们的方法：

```
-(void)gotUnreadCount:(NSDictionary *)unreadCount
{
    NSMutableArray *mutableArr = [NSMutableArray array];

    for (NSDictionary *unreadCountDict in unreadCount) {
        for (NSDictionary *feedDict in self.subcriptionsNC) {
            NSMutableDictionary *feedDictMutable = [feedDict mutableCopy];
            if ([[unreadCountDict objectForKey:@"id"] isEqualToString:[feedDict objectForKey:@"id"]]) {

                [feedDictMutable setObject:[unreadCountDict objectForKey:@"count"] forKey:@"count"];
                [mutableArr addObject:feedDictMutable];
            }
        }
    }
} 
```

`self.subscriptionsNC`是第一个数组，`unreadCount`是第二个。

我留下了来自 self.subscriptionsNC 的第一个对象，它的计数 > 0。另一个计数等于 0 的对象不会添加到我的组合数组中，因为它不存在于第二个数组中。（这只是覆盖 self.subscriptionsNC）

如果第一个数组中的一个项目没有计数（注意：除了第二个数组，它不显示计数等于 0 之外，没有指定计数）分配计数为 0。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:38:43.007

当您检查两个数组之间的 ID 是否匹配时，您永远不会处理不匹配的情况。尽管在这种情况下，使用循环会变得很棘手，因为您必须不断检查您之前是否还没有添加过该项目，依此类推。希望这是有道理的，这里已经很晚了:)

这是一些似乎可以解决示例集中数据问题的代码：

```
NSDictionary *firstNoCount = @{@"id" : @"feed/http://awebslife.tumblr.com/rss"};
NSDictionary *firstWithCount = @{ @"id" : @"feed/http://awebslife.tumblr.com/rss", @"count" : @4 };
NSDictionary *secondNoCount = @{ @"id" : @"feed/http://awholelotofnothing.net/feed/" };
NSArray *subscriptionsWithoutCount = @[ firstNoCount, secondNoCount ];
NSArray *subscriptionsWithUnreadCount = @[ firstWithCount ];
NSArray *allIds = [subscriptionsWithoutCount valueForKey:@"id"];
NSArray *idsWithUnreadCount = [subscriptionsWithUnreadCount valueForKey:@"id"];

NSIndexSet *indexesWithZeroCount = [allIds indexesOfObjectsPassingTest:^BOOL(id obj, NSUInteger idx, BOOL *stop) {
    return ![idsWithUnreadCount containsObject:obj];
}];

NSMutableArray *combined = [NSMutableArray array];

[subscriptionsWithoutCount enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    NSMutableDictionary *mutableItemDictionary = [(NSDictionary *)obj mutableCopy];
    NSNumber *unreadCountNumber = nil;
    if ([indexesWithZeroCount containsIndex:idx])
    {
        unreadCountNumber = @0;
    }
    else
    {
        NSInteger indexInCountArray = [idsWithUnreadCount indexOfObject:[mutableItemDictionary objectForKey:@"id"]];
        NSDictionary *countDictionary = [subscriptionsWithUnreadCount objectAtIndex:indexInCountArray];
        unreadCountNumber = [countDictionary objectForKey:@"count"];
    }
    [mutableItemDictionary setObject:unreadCountNumber forKey:@"count"];
    [combined addObject:mutableItemDictionary];
}];

NSLog(@"combined = %@",combined); 
```

# ios - 在 ios 中从亚马逊 s3 下载文件

> ID：12173228
> 
> 赞同：1
> 
> 时间：2012-08-29T07:55:04.153
> 
> 标签：ios, amazon-s3, asihttprequest

大家好，我在从 amazon s3 url 下载文件时遇到问题，其格式为：

https://s3.amazonaws.com:443/[Something]/[filename].mp3?Signature=[signature]&Expires=[Expiry]&AWSAccessKeyId=[AccessID]

上面的网址只是一种格式并且是保密的，所以我不能发布实际的网址。

我正在使用 ASIHTTPRequest 下载文件，但获取 http 状态代码 403（禁止）和响应字符串为空。

当我将链接粘贴到网络浏览器的地址栏中时，浏览器会播放歌曲。

这是代码：

```
if (!networkQueue) {
    networkQueue = [ASINetworkQueue queue];
}
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
ASIHTTPRequest *downloadRequest = [ASIHTTPRequest requestWithURL:[NSURL URLWithString:[mediaUrlString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding] ]];
[downloadRequest setRequestMethod:@"GET"];    
[downloadRequest setShouldRedirect:YES];    
NSString *fileName = [NSString stringWithFormat:@"%@.mp3",[dict valueForKey:@"ID"]];
fileName = [fileName stringByReplacingOccurrencesOfString:@" " withString:@""];
NSString *filePath = [NSString stringWithFormat:@"%@/%@",documentsDirectory,fileName];
NSLog(@"File Path: %@",filePath);

[downloadRequest setDownloadDestinationPath:filePath];
[downloadRequest setDownloadProgressDelegate:[downloadView viewWithTag:2]];
[downloadRequest setDelegate:self];
[downloadRequest setDidFinishSelector:@selector(downloadFinished:)];
[downloadRequest setDidFailSelector:@selector(downloadFailed:)];
[networkQueue addOperation:downloadRequest];
[networkQueue go]; 
```

是否可以使用 amazon s3 url 下载具有上述格式的文件。如果是，如何？提前感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T09:15:39.303

可能不是直接回答您的问题，而是使用 ASIHTTPRequest（去年停止了积极的开发），使用亚马逊提供的[适用于 iOS 的 AWS开发工具包不是更容易吗？](http://aws.amazon.com/sdkforios/)

# orm - symfony 1.4：如何从关系表中获取记录

> ID：12173229
> 
> 赞同：0
> 
> 时间：2012-08-29T07:55:05.877
> 
> 标签：orm, symfony1, doctrine, symfony-1.4

如何从“许多”表记录中获取对象？

我有列表，`rsObjectComments`我需要获取`rsObjects`.

例如：

架构.yml：

```
rsObject:
  actAs:
    Timestampable: ~ 
    Sluggable:
      fields: [name]
  columns:
    name: { type: string(255), notnull: true, unique: true }
    description:  { type: string(6000), notnull: true }
  relations:
    rsObjectComments:
     class:        rsObjectComments
     local:        id
     foreign:      rsobject_id
     type:         many
     foreignAlias: Comments

rsObjectComments:
  actAs:
    Timestampable: ~
  columns:
    rsobject_id: { type: integer, notnull: true }
    fromname: { type: string(100), notnull:true }
    fromemail: { type: string(100), notnull:true }
    comments: { type: string(1000), notnull:true }    
    is_public: { type: boolean, notnull: true, default: 1 }
  relations:
    rsObject: { onDelete: CASCADE, local: rsobject_id, foreign: id, foreignAlias: rsObjectCommentsAlias } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:52:00.737

我鼓励您阅读整个文档页面，名为：[Inside The Model Layer (Doctrine)](http://www.symfony-project.org/gentle-introduction/1_4/en/08-Inside-the-Model-Layer-Doctrine)（特别是*检索相关记录*部分）。

您将看到一个带有许多评论的文章的基本示例（与您的几乎相同）。

对于您的示例，如果您有一个，`rsObject`您可以使用以下方法获取相关`rsObjectComments`信息：

```
// will return a Doctrine_Collection
$rsObjectComments = $rsObject->getComments(); 
```

我正在使用`getComments`，因为您定义了`foreignAlias`with `Comments`。

如果你想在他们身上工作

```
foreach ($rsObject->getComments() as $comment)
{
  // $comment is a rsObjectComments object
} 
```

并且以相反的顺序，如果您有评论并想要检索其文章。

```
$rsObject = $comment->getRsObject(); 
```

# c# - 使用 webclient (C#) 上传文件不一致

> ID：12173234
> 
> 赞同：0
> 
> 时间：2012-08-29T07:55:19.943
> 
> 标签：c#

我正在使用 WebClient 上传文件（大小为 100MB 的 Zip），但有时效果很好，有时会失败

这是我的代码请让我知道您的观点以及需要做些什么才能使其保持一致

```
public bool UploadFirmware(string srcPath, string destPath)
    {
        bool status = false;
        List<Unisys.sPar.FirmwareInfo> orgFwList = new List<Unisys.sPar.FirmwareInfo>();
        List<Unisys.sPar.FirmwareInfo> upFwList = new List<Unisys.sPar.FirmwareInfo>();
        try
        {
            orgFwList = EnumerateFirmware();
            Uri fwuri = new Uri(destPath);
            string myStringWebResource = null;
            WebClient myWebClient = new WebClient();
            myStringWebResource = fwuri.ToString();
            myWebClient.Encoding = Encoding.UTF8;
            myWebClient.Credentials = new NetworkCredential(userName, password);
            myWebClient.Headers[HttpRequestHeader.ContentType] = "application/zip";
            bool gExecuteOnce = true;
            ServicePointManager.ServerCertificateValidationCallback = new System.Net.Security.RemoteCertificateValidationCallback(AcceptAllCertifications);
            myWebClient.UploadFileCompleted += new UploadFileCompletedEventHandler(myWebClientUploadloadFileCompleted);
            myWebClient.UploadFileAsync(new System.Uri(myStringWebResource), "POST", srcPath);//upload method 
            while (myWebClient.IsBusy)
            {
                System.Threading.Thread.Sleep(10000);
                if (gExecuteOnce == true)
                {
                    SPARTestToolInit.logger.Log(NLog.LogLevel.Info, "Please Wait Uploading firmware.....");
                    gExecuteOnce = false;
                }

            }
            upFwList = EnumerateFirmware();
            if (upFwList.Count == orgFwList.Count + 1)
            {
                status = true;
                SPARTestToolInit.logger.Log(NLog.LogLevel.Info, "Firmware Uploaded sucessfuly .....");
            }

        }
        catch (Exception ex)
        {
            status = false;
            SPARTestToolInit.logger.Log(NLog.LogLevel.Error, "Unable to upload firmware due to " + ex.ToString());
        }

        return status;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:32:38.040

```
 1\. don't pool if webclient busy, you have a callback   myWebClientUploadloadFileCompleted
     2\. set successfull status in you completed callback not in your method

     static ManualResetEvent done = new ManualResetEvent(false);

          public bool UploadFirmware(string srcPath, string destPath)
                {
                    bool status = false;
                    List<Unisys.sPar.FirmwareInfo> orgFwList = new List<Unisys.sPar.FirmwareInfo>();
                    List<Unisys.sPar.FirmwareInfo> upFwList = new List<Unisys.sPar.FirmwareInfo>();
                    try
                    {
                        orgFwList = EnumerateFirmware();
                        Uri fwuri = new Uri(destPath);
                        string myStringWebResource = null;
                        WebClient myWebClient = new WebClient();
                        myStringWebResource = fwuri.ToString();
                        myWebClient.Encoding = Encoding.UTF8;
                        myWebClient.Credentials = new NetworkCredential(userName, password);
                        myWebClient.Headers[HttpRequestHeader.ContentType] = "application/zip";
                        bool gExecuteOnce = true;
                        ServicePointManager.ServerCertificateValidationCallback = new System.Net.Security.RemoteCertificateValidationCallback(AcceptAllCertifications);
                        myWebClient.UploadFileCompleted += new UploadFileCompletedEventHandler(myWebClientUploadloadFileCompleted);
                        myWebClient.UploadFileAsync(new System.Uri(myStringWebResource), "POST", srcPath);//upload method 

                      done.WaitOne();//wait signal from completed callback

                    }
                    catch (Exception ex)
                    {
                        status = false;
                        SPARTestToolInit.logger.Log(NLog.LogLevel.Error, "Unable to upload firmware due to " + ex.ToString());
                    }

                    return status;
                }

static void client_UploadFileCompleted(object sender, UploadFileCompletedEventArgs e)
    {
        done.Set();
    }

static void client_UploadProgressChanged(object sender, UploadProgressChangedEventArgs e)
    {
        //set your progress log
    } 
```

# javascript - 如何为给定数组创建跨度列表

> ID：12173240
> 
> 赞同：3
> 
> 时间：2012-08-29T07:55:53.403
> 
> 标签：javascript, jquery

假设我有一个看起来像这样的对象：

```
var users = ['user1', 'user2']; 
```

对于这个对象，我想创建一个像这样的跨度列表：

```
"<span>user1</span><span>user2</span>" 
```

我确实尝试了以下代码

```
$('<span/>').text(users); 
```

但它不能正常工作，有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T07:58:09.480

这会起作用：

```
var users = ['user1', 'user2'];

$.each(users, function() {
    $("<span>", { text : this }).appendTo("body");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:01:49.247

您也可以使用以下`Array.map`方法：

```
['user1', 'user2'].map(
    function(a){
        $('<span/>').html(a).appendTo($('body')); return a;
    }
); 
```

甚至更短：

```
$(['user1','user2'].map(function(a){return '<span>'+a+'</span>'}).join(''))
 .appendTo('body'); 
```

甚至`Array.filter`;)

```
['user1', 'user2'].filter(
    function(a){
        $('<span/>').html(a).appendTo($('body')); return true;
    }
); 
```

或者`jQuery.each`在从 Array 派生的 jQuery 对象上

```
$(['user1', 'user2']).each(
    function(i,a){
        $('<span/>').html(a).appendTo($('body')); return true;
    }
); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T07:58:50.060

假设`users`应该只包含字符串，试试这个：

```
var users = ['user1', 'user2'];
for (var i = 0; i < users.length; i++) {
    $("<span />").text(users[i]).appendTo("body");
}; 
```

[**示例小提琴**](http://jsfiddle.net/p3EBy/)

# django-orm - select_for_update 是否在第一次 save() 或视图结束时释放锁定？

> ID：12173241
> 
> 赞同：8
> 
> 时间：2012-08-29T07:56:04.443
> 
> 标签：django-orm

我有类似的东西：

```
newsletter = Newsletter.select_for_update().latest()
newsletter.started_sending = timezone.now()
newsletter.save()

newsletter.send() 
```

然后它遇到了我发送重复的竞争条件，大概是因为 send() 被两个 cron 作业击中。这让我认为锁在第一次保存时被释放，因为我认为它直到视图结束才会释放。

第一次存档就放出来了吧？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-29T08:11:32.813

来自[https://docs.djangoproject.com/en/dev/topics/db/transactions/#topics-db-transactions-requirements](https://docs.djangoproject.com/en/dev/topics/db/transactions/#topics-db-transactions-requirements)

> # Django 的默认事务行为
> 
> Django 的默认行为是使用打开的事务运行，当调用任何内置的数据更改模型函数时，它会自动提交该事务。例如，如果您调用 model.save() 或 model.delete()，更改将立即提交。

# python - 为什么这个双循环不起作用？

> ID：12173242
> 
> 赞同：1
> 
> 时间：2012-08-29T07:56:10.270
> 
> 标签：python

首先，这是代码：

```
def check_sudoku(n):
    d=len(n)
    i=0
    s=1
    while i<d:
        print "i=",i
        while s<d:
            print "s=",s
            if n[0][i]==n[s][i]:
                return False
            s=s+1
            i=i+1
         return True 
```

我想要做的是，在`s`从`1`to的值更改`d`之后，它会再次循环并`i`更改的值。但在我的代码中，值`i`根本没有改变。

只是为了清楚我想做什么，说

```
n =[[1,2,3,4],
    [2,3,1,3],
    [3,1,2,3],
    [4,4,4,4]] 
```

我希望发生以下情况：

*   首先它应该检查

    ```
    n[0][0]==n[1][0]
    n[0][0]==n[2][0]
    n[0][0]==n[3][0] 
    ```

    之后的值`i`应该增加 1

*   那么它应该是这样的：

    ```
    n[0][1]==n[1][1]
    n[0][1]==n[2][1]
    n[0][1]==n[3][1] 
    ```

在这个值`i`将再次增加之后，这个相同的循环将运行。

这没有发生，我不知道为什么。请告诉我应该进行哪些更改以使其按我想要的方式运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T07:57:58.797

您不会`s`在外循环中重置，因此内循环只会执行一次。在那之后，`s < d`再也不会是真的了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:05:01.527

您的内部循环递增`s`，直到大于`d`，但您从未将其设置回`1`. 此外，使用您当前的缩进，您还增加`i`了内部循环，因此它将到达`d`内部循环内部，导致*外部*循环也只运行一次。

因此，如果`d`是 4，您的值将变为：

```
i = 0, s = 1
i = 1, s = 2
i = 2, s = 3
# exit inner loop
return True 
```

你最好使用`for`循环 using [`range()`](http://docs.python.org/library/functions.html#range)，完全避免你的错误：

```
def check_sudoku(n):
    for i in range(len(n)):
        for s in range(1, len(n)):
            if n[0][i]==n[s][i]:
                return False
    return True 
```

内部循环将`range`始终从`1`, 范围开始，直到`len(n)`每次都不需要显式重置。

如果您使用该[`any()`功能](http://docs.python.org/library/functions.html#any)，您可以将整个测试折叠成一行：

```
def check_sudoku(n):
    return not any(n[0][i] == n[s][i] for i in range(len(n)) for s in range(1, len(n))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T08:13:40.240

除了 unwind 的答案，这是修改后的代码，应该可以工作。我以大多数 Python 程序员认为更传统的方式更改了代码中的空格和运算符。

```
def check_sudoku(n):
    d = len(n)
    i = 0
    s = 1

    while i < d:
        print "i=",i
        while s < d:
            print "s=",s
            if n[0][i] == n[s][i]:
                return False
            s += 1
        i += 1
        s = 1
    return True 

n =[[1,2,3,4],
    [2,3,1,3],
    [3,1,2,3],
    [4,4,4,4]]

check_sudoku(n) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-29T08:03:02.680

我认为您应该将语句 i=i+1 移到第二个循环中，如下所示：

```
def check_sudoku(n):
d=len(n)
i=0
s=1
while i<d:
    print "i=",i
    while s<d:
        print "s=",s
        if n[0][i]==n[s][i]:
            return False
        s=s+1
    i=i+1
    return True 
```

# ruby-on-rails-3 - 如何在 Rails 中使用 Sendgrid Parse API

> ID：12173243
> 
> 赞同：3
> 
> 时间：2012-08-29T07:56:13.820
> 
> 标签：ruby-on-rails-3, api, parsing, post, sendgrid

如何配置应用程序以接收到达服务器的电子邮件。

我有一个 Rails 应用程序，它很容易将电子邮件发送到我分配的电子邮件 ID，但我不知道在我的控制器中写什么来从解析 api 获取电子邮件对象（页眉、页脚、正文等）。

我是 Rails 新手，所以我希望创建一个基本主题，让有经验的人聚集并回复，以使 sendgrid api 变得越来越有用......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:14:05.320

我将假设您已经配置了 MX 记录，并且您已经[在 SendGrid 后端设置了解析设置](http://sendgrid.com/developer/reply)。从代码的角度来看，这就是它的样子：

### 1\. 添加一条路线到您的`config/routes.rb`

您需要定义一个接受消息的路由。

```
# /inbound
match '/inbound' => 'messages#inbound', :via => :post 
```

### 2\. 配置您的方法以返回 200 响应码

在我的示例中，这是文件将是`app/controllers/messages_controller.rb`. 我要做的就是记录参数，但你应该用你自己的逻辑替换那个位。重要的是我正在返回一个`200`响应代码。

```
class MessagesController < ApplicationController
  def inbound
    puts "*"
    puts params
    puts "*"

    render :json => { "message" => "OK" }, :status => 200
  end
end 
```

* * *

上述代码的结果将按照这些行将一些内容记录到您的 Rails 服务器输出中：

```
**************************************************
{
        "headers" => "Received: by 127.0.0.1 with SMTP ..."
    "attachments" => "0",
           "dkim" => "{@sendgrid.com : pass}",
        "subject" => "Hello world",
             "to" => "foo@snailgrid.com",
           "html" => "<div>... </div>",
           "from" => "Swift <swift@sendgrid.com>",
           "text" => "Some text body",
       "envelope" => "{\"to\":[\"foo@snailgrid.com\"],\"from\":\"mike.swift@sendgrid.com\"}",
            "SPF" => "pass",
     "controller" => "messages",
         "action" => "inbound"
}
************************************************** 
```

# django - 在 Django 模板中打印字典值

> ID：12173245
> 
> 赞同：8
> 
> 时间：2012-08-29T07:56:34.753
> 
> 标签：django

我将两个名为`student_ids`和的字典传递`rows`给 Django 模板。字典`student_ids`有一个名为的键`student_id`，`invite_id`我想打印`student_ids[student_id]`出`invite_id`.

rows 字典中 row 的第 4 个元素与`student_id`. 当我尝试下面的代码时，它不起作用……</p>

Django模板：

```
{% for row in rows %}
    <a href="#invite"
     data-invite="{{ invite_ids.row.4 }}">
     {{ row.2 }}
    </a>
{% endfor %} 
```

我应该怎么做才能在 Django 模板中获取正确的数据？我基本上需要`student.ids[row[4]]`被打印出来，而且要简单……</p>

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T07:59:42.857

> 字典`student_ids`有一个名为的键`student_id`，`invite_id`我想打印`student_ids[student_id]`出`invite_id`.

尝试这个：

```
{% for sid, iid in student.ids.items %}
    {{ sid }} -- {{ iid }}
{% endfor %} 
```

顺便说一句：由于那个点，您的字典名称很奇怪且令人困惑。我会把它改成`studentIds`什么的......

* * *

根据您的编辑更新：

首先检查这个：[https ://docs.djangoproject.com/en/dev/ref/templates/builtins/#for](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#for)

我真的不明白你到底在追求什么，但如果你想根据一个等于 a 的键从行 dict 中访问一个值，`student_id`你可以试试这个，看看它是如何为你工作的，并根据你的需要进行调整：

```
{% for student_id, student_id_value in student.ids.items %}
     {{ student_id }}
     {{ rows.student_id }}
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T08:51:54.623

以这种方式解决它：

```
{% for t_id, i_id in teacher_invite_ids.items %}
 {% if t_id == row.4 %}
  {{ i_id }}
 {% endif %}
{% endfor %} 
```

# sql - sybase中m:n表中的sql搜索

> ID：12173246
> 
> 赞同：0
> 
> 时间：2012-08-29T07:56:46.230
> 
> 标签：sql, select, sybase

我有一个表学生班级女巫包含学生ID和班级ID

```
CREATE TABLE [StudentClass]
([StudentId] varchar(20), [ClassId] varchar(20)); 
```

我想做的是找到一个学生的所有同学。例如：

```
student 1 in class 1 
student 1 in class 2
student 2 in class 2 
```

如果我搜索 student1，我想得到结果：
student1 | student2
我实际得到的是：

```
student1 | null
student1 | student2 
```

如果我只有第一行：

```
student 1 in class 1 
```

预期的结果是：

```
student1 | null

select distinct s1.StudentId, s2.StudentId 
from StudentClass s1
             left join StudentClass s2 
                     on s1.ClassId = s2.ClassId and 
                        s1.StudentId != s2.StudentId
where s1.StudentId = 'Student1' 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:03:13.510

尝试使用`group by`而不是`distinct`：

```
select s1.StudentId as std1, s2.StudentId as std2
from StudentClass s1
             inner join StudentClass s2 
                     on s1.ClassId = s2.ClassId and 
                        s1.StudentId != s2.StudentId
where s1.StudentId = '1'
group by s1.StudentId, s2.StudentId 
```

你可以[**在这里查看**](http://sqlfiddle.com/#!2/63d47/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:00:39.060

在您的查询中添加这个

```
SELECT...
FROM..
WHERE...
      AND s2.StudentId IS NOT NULL    -- <== this condition 
```

# mysql - 根据条件计算MYSQL查询中的百分比

> ID：12173248
> 
> 赞同：1
> 
> 时间：2012-08-29T07:56:57.910
> 
> 标签：mysql, subquery

希望你能帮忙，这把我逼疯了

我需要计算一个问题失败的百分比，但这需要按地理区域缩小范围，并针对这些问题提出的产品。

我有 ：

```
$CA002 = "( SELECT ROUND(100 *  (SELECT count(CA002Result) from Data_Table where (CA002Result='Fail'))/count(CA002Result),2) from Data_Table) AS 'CA002 %'"; 
```

哪个“有效”，但只是针对整个记录集作为“整体”进行计算

我正在努力 ：

```
$CA001 = "( SELECT ROUND(100 *  (SELECT count(CA001Result) from Data_Table where (CA001Result='Fail' AND Area ='$Area'))/count(CA001Result) from Data_Table WHERE (Area='$Area'),2) AS 'CA001 %'"; 
```

并且 ：

```
$CA001 = "( SELECT ROUND(100 * (SELECT count(CA001Result ) from Data_Table where (CA001Result='Fail' AND Product='$product' AND Area='$Area'))      
    /     count(CA001Result WHERE Product = '$product' AND Area='$Area'),2) from Data_Table) AS 'CA001 %'"; 
```

也在尝试这个，但得到一个 MYSQL 语法错误。

```
$CA001 = "( SELECT ROUND(100 *  (SELECT count(CA001Result) from Data_Table where (CA001Result='Fail'))/ (SELECT (count(CA001Result) from Data_Table WHERE (Area='$Area')),2) AS 'CA001 %')"; 
```

并且无论我尝试什么都会出错，我似乎无法弄清楚我需要把什么放在哪里。

尝试了以下答案：

```
$CA001 = "(SELECT 100 * SUM(IF(CA001Result='Fail', 1, 0)) / COUNT(CA001Result) as 'CA001 %' WHERE  Area='$Area')";

$CA002 = "( SELECT ROUND(100 *  (SELECT count(CA002Result) from Data_Table where (CA002Result='Fail'))/count(CA002Result),2) from Data_Table) AS 'CA002 %'"; 
```

但我得到以下错误：

MySQL 错误：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 ' ( SELECT ROUND(100 * (SELECT count(CA002Result) from Data_Table where (CA002Re' at line 1) 附近使用的正确语法)

非常感谢任何帮助，谢谢。

编辑 - 使用以下方法破解它：

```
$CA001 ="ROUND ((SELECT 100 * SUM(IF(CA001Result='Fail', 1, 0)) / COUNT(CA001Result) 
FROM Data_Table
WHERE  Area='$Area'),2) as 'CA001 %'"; 
```

非常感谢你的帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:03:40.993

尝试这个

```
SELECT 100 * SUM(IF(CA001Result='Fail', 1, 0)) / COUNT(CA001Result) as 'CA002 %'
FROM Data_Table
WHERE '$product' AND Area='$Area' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:04:05.070

我只是在猜测您的模型，但您应该尝试这种模式：

```
SELECT
    Area,
    Product,
    COUNT(*) as total,
    SUM(CA002Result='Fail') as total_fail,
    SUM(CA002Result='Fail') / COUNT(*) as 'CA002 %'
FROM Data_Table
GROUP BY Area, Product; 
```

# android - 如何使用查询在sqlite中使用多个列中的多个值？

> ID：12173249
> 
> 赞同：0
> 
> 时间：2012-08-29T07:56:59.427
> 
> 标签：android, sqlite

我有五列，我想从五列中搜索数据，但列值可以超过 5，它不固定。

例子

列名

名字，姓氏，主题，结果，等级。

我想使用 sqlite 搜索多个值。（名字可以是 a、b、c、d）

如何做到这一点？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:04:10.943

在 SQLite 中使用`IN`关键字将允许您使用一组多个值执行搜索。例如：

```
SELECT * FROM table WHERE first-name IN ('a', 'b', 'c', 'd'); 
```

现在您可以做的是使用任何循环构建输入（可搜索词）参数并将其替换在`IN`括号中。

例如：

```
String names = "'a', 'b', 'c', 'd'";      /* build it through loop */

Cursor c = db.rawQuery("SELECT * FROM table WHERE first-name IN (?)",
              new String[]{names}); 
```

* * *

**多列：**

```
String names = "'a', 'b', 'c', 'd'";      /* build it through loop */

Cursor c = db.rawQuery("SELECT * FROM table WHERE first-name IN (?)
         OR last-name IN (?) OR subject IN (?) OR result IN (?) OR grade IN (?)",
         new String[]{names, names, names, names, names}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-18T13:49:28.190

```
String[] names = new String[3];
String QueryArgs ="";   
for(int index=0;index < 3;index++)
{
      QueryArgs = QueryArgs.concat(",?");
      names [index] = "xyz";
}
QueryArgs = QueryArgs.substring(1);

Cursor dataset = db.rawquery("select * from table where name in(" +QueryArgs+ ")",names); 
```

# python - “utf8”编解码器无法解码位置 0 中的字节 0xd0：无效的继续字节

> ID：12173255
> 
> 赞同：0
> 
> 时间：2012-08-29T07:57:24.413
> 
> 标签：python, xpath, elementtree

我在 html 文档中有以下文本：

```
<a href="#">�'ам интересна информация</a> 
```

我正在使用以下表达式来提取文本：

```
row.xpath("string(./td[@class='col2 td-tags']/h3/a/text())") 
```

这个表达式适用于简单的英语，但对于上面的字符串，它会抛出这个错误：

```
'utf8' codec can't decode byte 0xd0 in position 0: invalid continuation byte 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T07:59:42.400

在 HTML 中，&#xxx 不指定文档编码中的字节；它总是一个 unicode 代码点。

因此，您不能将 UTF-8 放入这样的 HTML 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:11:24.280

文档是什么编码的？中的文本以什么字符开头`<a>`？它可能是无效的 UTF-8。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T14:03:35.157

我首先解码了页面内容（其中包括 string `<a href="#">�'ам интересна информация</a>`）以将任何不可转换的字符串替换为问号，它起作用了！

IE`page_contents_string = page_contents_string.decode("utf-8", "replace")`

# xml - 取消选择第一个文件夹会导致所有地标消失

> ID：12173262
> 
> 赞同：0
> 
> 时间：2012-08-29T07:57:49.357
> 
> 标签：xml, google-maps, kml

我对以下行为感到困惑。

当我在这里取消选择第一个文件夹时，所有地标都消失了：

[http://goo.gl/maps/htwQA](http://goo.gl/maps/htwQA)

完整的 KML 文件在这里：

[https://dl.dropbox.com/u/94943007/cfe28a5dd35d9c7ff2f55de152917c6fc868688f1ef39e2ea71b3043.kml](https://dl.dropbox.com/u/94943007/cfe28a5dd35d9c7ff2f55de152917c6fc868688f1ef39e2ea71b3043.kml)

有没有人有类似的经历？我专门对 KML 文件中的地标进行分段。我希望用户能够选择可见的地标文件夹。

出于某种原因，当用户选中/取消选中第一个文件夹时，所有地标都会消失。

我已经在我创建的其他类似 KML 文件上进行了尝试，并且行为与此一致。

**为什么所有地标都消失了？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:57:11.763

您的 KML 文件在第一个文件夹之前有一个 '，我认为这可能会使解析器感到困惑。

```
 </Style>'<Folder><name>SuboxonePrescribers</name> 
```

但是删除它仍然有问题：

[https://maps.google.com/maps?q=http:%2F%2Fwww.geocodezip.com%2Fgeoxml3_test%2Fdisappearing_placemark_test_kml.xml&hl=en&sll=44.460291,-89.724498&sspn=12.526662,19.533691&t=h&z=6](https://maps.google.com/maps?q=http:%2F%2Fwww.geocodezip.com%2Fgeoxml3_test%2Fdisappearing_placemark_test_kml.xml&hl=en&sll=44.460291,-89.724498&sspn=12.526662,19.533691&t=h&z=6)

我目前的理论是这是 KML 解析器中的一个错误。KML[有效](http://www.feedvalidator.org/check.cgi?url=http%3A%2F%2Fwww.geocodezip.com%2Fgeoxml3_test%2Fdisappearing_placemark_test_kml.xml)

# domain-driven-design - 从 saga 访问不同的有界上下文数据

> ID：12173263
> 
> 赞同：0
> 
> 时间：2012-08-29T07:57:50.310
> 
> 标签：domain-driven-design, nservicebus, saga, bounded-contexts

我使用 NServiceBus 创建了一个传奇，它请求外部服务以获取客户信息并超时。超时后，传奇检查外部服务是否有响应。作为回应，我有相应客户的数据，现在我必须检查相应客户是否存在于我们的系统中（如果他不存在 - 我必须创建他），然后我必须创建一些额外的审计实体来引用那个客户（如果我有创建它们所需的所有信息）。

我想知道我应该如何检查特定客户是否存在以及何时不存在如何创建他。

到目前为止，我有几个想法：

*   从消息处理程序内部调用 WCF 服务（检查、创建）

*   通过 NSB 向客户有界上下文发送消息并等待带有 ID 的响应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T07:09:35.190

您可以为此利用 NServiceBus 消息处理管道。将“客户服务”中的处理程序配置为首先运行，该处理程序检查客户的存在并在必要时创建它们，最后在正在处理的原始消息上设置 CustomerID 属性，以便下一个处理程序知道它是什么。

这为您提供了围绕整个过程的事务一致性的好处。

您描述的发布/订阅模型也可以工作。我不太喜欢它，因为您要对事件进行一种请求/响应，并且不清楚谁真正对客户信息负责（因为所需的数据来自不负责的发布者）顾客）。

如果不深入您的领域，就很难更有规范性。

# linux - 使用 rsync 排除包含特定文件类型的目录

> ID：12173276
> 
> 赞同：1
> 
> 时间：2012-08-29T07:58:35.787
> 
> 标签：linux, rsync

如果它们包含某种文件类型，我希望 rsync 跳过整个目录。

我知道如何排除某种类型的文件。但是由于我不知道要排除的所有文件类型，因此如果存在一种类型，则应该排除整个目录，这对我没有多大帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:23:15.813

我会这样：

*   构建一个列出所有文件的文件： `find . > allfiles`

*   获取不被 rsynced 的目录列表。由于您没有指定您的标准，我们假设它是一个文件后缀，如`fop`

    `find . -path '*fop' | xargs -r -n1 dirname`

会给你“禁止目录”的列表。在这里，您必须适应您的情况。

*   然后`grep -v`是整个文件列表中的禁止目录，构建过滤后的文件列表

*   `--files-from=`然后使用过滤后的文件列表与开关进行 rsync

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:20:19.830

好吧，这有点难看，但是您总是可以添加反引号并运行带有一些 sed 工作的 find 命令。例如，如果我想忽略所有具有扩展名的文件的目录`.dist`，那么我可以这样做：

```
rsync -vvaR `find /etc -name '*.dist' | sed -e 's:/[^/]*$:/:' | sort | uniq | sed -e 's:^/:--exclude /:'` /etc rsync://hostname.com/ 
```

我得到一些如下所示的输出：

```
[client] add_rule(- /etc/config-archive/etc/)
[client] add_rule(- /etc/config-archive/etc/bash/)
[client] add_rule(- /etc/config-archive/etc/bind/)
[client] add_rule(- /etc/config-archive/etc/conf.d/)
[client] add_rule(- /etc/config-archive/etc/cron.daily/)
[client] add_rule(- /etc/config-archive/etc/eclean/)
[client] add_rule(- /etc/config-archive/etc/init.d/)
[client] add_rule(- /etc/config-archive/etc/logrotate.d/)
[client] add_rule(- /etc/config-archive/etc/modprobe.d/)
[client] add_rule(- /etc/config-archive/etc/mysql/)
[client] add_rule(- /etc/config-archive/etc/pam.d/)
[client] add_rule(- /etc/config-archive/etc/portage/bin/)
[client] add_rule(- /etc/config-archive/etc/portage/postsync.d/)
[client] add_rule(- /etc/config-archive/etc/portage/savedconfig/sys-apps/)
[client] add_rule(- /etc/config-archive/etc/profile.d/)
[client] add_rule(- /etc/config-archive/etc/security/)
[client] add_rule(- /etc/config-archive/etc/ssh/)
[client] add_rule(- /etc/config-archive/etc/ssl/)
[client] add_rule(- /etc/config-archive/etc/ssl/certs/)
[client] add_rule(- /etc/config-archive/etc/ssl/misc/)
[client] add_rule(- /etc/config-archive/etc/ssmtp/)
[client] add_rule(- /etc/config-archive/etc/syslog-ng/)
[client] add_rule(- /etc/config-archive/etc/udev/)
[client] add_rule(- /etc/config-archive/etc/udev/rules.d/)
[client] add_rule(- /etc/config-archive/etc/vim/)
opening tcp connection to hostname.com port 873 
```

# c# - 在本地 HTML 中加载图像

> ID：12173277
> 
> 赞同：0
> 
> 时间：2012-08-29T07:58:40.297
> 
> 标签：c#, silverlight, windows-phone-7, windows-phone-7.1, isolatedstorage

在我的 Windows Phone 7 应用程序中，我正在 Web 浏览器上加载 HTML 文件。HTML 文件包含必须从隔离存储（已存储）加载图像的照片。任何人都可以指导我（是否有任何示例或教程在线呈现）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:12:41.063

您始终可以将图像转换为 base64 并将 base64 作为文本包含在文档中。

我快速创建的一个例子可以在这里查看：http: [//jsfiddle.net/NLxdB/](http://jsfiddle.net/NLxdB/)

将图像设置为 base64 后，您可以将其添加到 html 中，如下所示：`<img src="data:image/png;base64, BASE64IMAGE" />`将 BASE64IMAGE 替换为 base64 字符串。

（**编辑：** `data:image/png`需要替换为 jpg/gif 或任何图像类型。）

要获取图像的 base64，您可以使用以下代码：

```
string base64 = null;
using (var iso = IsolatedStorageFile.GetUserStoreForApplication())
using (var isf = iso.OpenFile(imageName, FileMode.Open, FileAccess.Read))
using (var ms = new MemoryStream())
{
    isf.CopyTo(ms);
    base64 = Convert.ToBase64String(ms.ToArray());
} 
```

# iphone - iOS 配置门户 – 应用 ID

> ID：12173283
> 
> 赞同：3
> 
> 时间：2012-08-29T07:59:30.113
> 
> 标签：iphone, ios, in-app-purchase, provisioning, app-id

我在 App Store 中有一个应用程序，最近更新了。我在其中添加了一个应用内购买。在 iOS Provisioning Portal 中创建的 App ID 显示应用内购买不可用： ![在此处输入图像描述](../Images/36cb8f5a80e54f13bbaccdc8a8bd7a60.png)

但是，它工作得很好......所以我的问题是什么是 App ID 以及我需要它在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:57:42.657

你必须为这些服务打造独一无二的`AppID`。`AppID`包含星号的`*` **不是唯一的** `AppID`。

**独特** 的例子`AppID`：

# ABCDEFGHIJK.com.applicationid.veryunique

* * *

以下 ID**不能使用**相关服务，因为**它们不是唯一**ID *（因此您无法使用带有星号的类似 ID 的服务）*：

**ABCDEFGHIJK.com.applicationid.***或

**ABCDEFGHIJK.com.***或

**ABCDEFGHIJK.***

* * *

在此处查看实时图片，并`*`在第一个位置找到星号`AppID`，您会看到大部分服务不可用。

第二个**不包含**任何星号，并且所有服务都可用于它。

![在此处输入图像描述](../Images/7de0a6e43fcbe1fa7262462c11c28314.png)

我希望这个简单的解释足以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:22:38.590

在没有应用内购买的情况下将应用程序提交到应用程序商店后您无法将应用程序购买添加到该应用程序这是应用程序 ID 而非您的应用程序的问题

您需要创建一个新的应用 ID，然后通过应用内购买提交应用

# jquery - jQuery展开独特的子菜单

> ID：12173284
> 
> 赞同：0
> 
> 时间：2012-08-29T07:59:37.610
> 
> 标签：jquery

我的项目有一些类名相同的 li 元素（.expanded）

我的目标是当用户按 Tab 键时，显示 li.expaned 下的隐藏子菜单。

现在的问题是当我按下tab键时，所有的子菜单都会显示出来。如何一一显示？

```
$(document).ready(function () {
    $('.expanded').keyup(function (e) {
        $('.expanded').each(function () {
            console.log('keyup called');
            var code = e.keyCode || e.which;

            if (code == '9') {
                //jQuery(this).children('.side_menu_sub li ul').css("display", "block");
                $(this).children('.side_menu_sub li ul').css("display", "block");
            }
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:02:42.460

尝试这个：

```
$(this).find('> .side_menu_sub > li > ul').css("display", "block"); 
```

您可以随时检查您选择了哪些元素`console.log`。只需使用 css 选择器即可。

此外，将重用的 jQuery 对象存储在变量中也是一个好习惯。您应该使用`on`而不是特定功能。结果将是：

```
$(document).ready(function () {
    expanded = $('.expanded');
    expanded.on('keyup', function (e) {
        expanded.each(function () {
            console.log('keyup called');
            var code = e.keyCode || e.which;

            if (code == '9') {
                //jQuery(this).children('.side_menu_sub li ul').css("display", "block");
                $(this).find('> .side_menu_sub > li > ul').css("display", "block");
            }
        });
    });
}); 
```

# css - 在 JavaFX CSS 中指定外部字体

> ID：12173288
> 
> 赞同：20
> 
> 时间：2012-08-29T07:59:50.213
> 
> 标签：css, fonts, javafx

是否可以在 JavaFX 应用程序中使用 CSS 指定字体？我有一个 FXML 场景和相应的 CSS 文件。在 Java 代码中，可以使用以下`setFont`方法指定字体：

```
text.setFont(Font.loadFont("file:resources/fonts/SourceSansPro-Bold.ttf", 12)); 
```

我尝试了不同的结构，例如：

```
-fx-font-family: url("../fonts/SourceSansPro-Bold.ttf"); 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-29T15:56:59.087

我使用应用程序代码和 CSS 的组合来通过外部字体设置样式。

我将`loadFont`调用放在重写的 Application init 方法中，以确保在应用程序发生任何事情之前调用它。

```
Font.loadFont(CustomFontTest.class.getResource("TRON.TTF").toExternalForm(), 10); 
```

要使用字体，我在 CSS 中按字体系列引用字体：

```
.menu-bar {
    -fx-background-color: transparent;
    -fx-font-family: TRON;
    -fx-font-size: 40px;
}

.context-menu {
    -fx-font-family: TRON;
    -fx-background-color: transparent;
    -fx-font-size: 12px;
} 
```

很高兴CSS可以很好地调整字体大小。即使以 10 号字体加载字体，字体也已正确调整为 CSS`-fx-font-size`规范中指定的大小。

通过 CSS 使用`Font`在应用程序初始化期间加载的标签的内联样式也可以正常工作：

```
Label testControl = new Label("TRON");
testControl.setStyle("-fx-font-family: TRON; -fx-font-size: 120;"); 
```

[TRON 字体](http://www.dafont.com/tron.font)是从 dafont 下载的，放在与 CustomFontTest 类相同的目录中，并由构建系统复制到构建输出目录。

[从我对“使用自定义字体”](https://forums.oracle.com/forums/thread.jspa?messageID=10210565)的论坛帖子的回答中复制的答案。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-29T08:09:03.083

您已经接近解决方案：

```
-fx-font-family: 'Helvetica', Arial, sans-serif; 
```

试试这个，它应该可以正常工作。

* * *

也许这会有所帮助？（我不是 JavaFX 专家）

[https://forums.oracle.com/forums/thread.jspa?messageID=10107625](https://forums.oracle.com/forums/thread.jspa?messageID=10107625)

* * *

**编辑**：

加载你的字体：

```
@font-face {
    font-family: Delicious;
    src: url('Delicious-Roman.otf');
} 
```

使用你的字体`-fx-`：

```
-fx-font-family: 'Delicious'; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-08T06:42:29.753

刚刚发现了一个细节：在 JavaFX-8 中，如果你想拥有相同字体的常规和粗体变体，你可以使用 @font-face 的两个实例来指定它们。然后你可以使用 -fx-font-weight: bold;

```
@font-face {
    font-family: 'Droid Sans';
    src: url('DroidSans.ttf');
}

@font-face {
    font-family: 'Droid Sans Bold';
    src: url('DroidSans-Bold.ttf');
}

.root {
    -fx-font-family: 'Droid Sans'; 
}

.table-row-cell:focused .text {
    -fx-font-weight: bold;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-11T09:41:27.147

另一种方法是使用 FileIUnputStream 加载字体，因此您不需要使用 css：

```
 @FXML
    private Label myLabel;

@Override
    public void initialize(URL arg0, ResourceBundle arg1){

Font myFont = null;

        try {
            myFont = Font.loadFont(new FileInputStream(new File("patch_to_font.ttf")), 10);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }

        myLabel.setFont(myFont);

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-08T20:35:54.857

**JavaFx CSS 字体（导入 .ttf）：**

```
/* import fonts */
@font-face {
    font-family: "Open Sans";
    font-style: normal;
    font-weight: 400;
    src: url("/fonts/OpenSans-Regular.ttf");
}
@font-face {
    font-family: "Open Sans Light";
    font-style: normal;
    font-weight: 300;
    src: url("/fonts/OpenSans-Light.ttf");
}
@font-face {
    font-family: "Open Sans Bold";
    font-style: normal;
    font-weight: 700;
    src: url("/fonts/OpenSans-Bold.ttf");
}
@font-face {
    font-family: "Open Sans ExtraBold";
    font-style: normal;
    font-weight: 900;
    src: url("/fonts/OpenSans-ExtraBold.ttf");
}

/* Set fonts */

.settings-name{
    -fx-font-size: 33px;
    -fx-font-family: "Open Sans Light";
    -fx-font-weight: 300;
    -fx-text-fill: #09f;
}

.settings-username{
    -fx-font-size: 19px;
    -fx-font-family: "Open Sans ExtraBold";
    -fx-font-weight: 900;
    -fx-text-fill: #09f;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-12T15:16:03.480

您需要将`Font.ttf`文件放在我们的`bin/<main application> folder`中，其中包含`.class`您的应用程序[示例](https://i.stack.imgur.com/sv11s.png)

# c# - 文件详细信息选项卡中的“语言中性”属性

> ID：12173293
> 
> 赞同：3
> 
> 时间：2012-08-29T08:00:09.217
> 
> 标签：c#, dll, localization, assemblies

如何更改用 C# 编写的 DLL 的语言属性？

我试图进入`Project Properties -> Assembly Information -> Neutral Language`ComboBox 并将其设置为`English (United States)`.

在我构建/重建项目/解决方案后，当我右键单击 DLL 并转到详细信息选项卡时，语言属性总是说`Language Neutral.`

**编辑：** 我找到的解决方案是使用外部 *.res 文件（仅由 Visual Studio 生成），然后在对话框中选择它`Project Propertie->Application Tab-> Resource File`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T11:15:42.153

此属性设置 AssemblyInfo.cs 文件中的 [AssemblyCulture] 属性。MSDN 库文章的备注部分中有此重要说明：

> 编译器使用该属性来区分主程序集和附属程序集。主程序集包含代码和中立文化的资源。附属程序集仅包含特定文化的资源，如 [assembly:AssemblyCultureAttribute("de")]。将此属性放在程序集上并使用空字符串 ("") 以外的其他内容作为区域性名称将使该程序集看起来像附属程序集，而不是包含可执行代码的主程序集。使用此属性标记传统代码库会破坏它，因为在运行时没有其他代码能够找到库的入口点。

另一个重要限制是 GAC 可以通过程序集名称、版本、体系结构和公钥令牌来区分程序集，但不能通过文化来区分。附属程序集必须始终存储在本地。

长话短说，在包含代码的项目中，除了 Neutral 之外*永远不要选择任何东西。*附属程序集几乎总是从项目中的资源自动生成，并自动获得正确的 [AssemblyCulture] 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-13T21:20:28.427

*（添加此答案作为[@Hans Passant 答案](https://stackoverflow.com/a/12176658/1497596)的补充。）*

在您的程序集信息（通过项目属性访问）中，当您将中性语言更改为“英语（美国）”时，会导致此行添加到`AssemblyInfo.cs`：

```
[assembly: NeutralResourcesLanguageAttribute("en-US")] 
```

但是，请注意以下行`AssemblyInfo.cs`保持不变：

```
[assembly: AssemblyCulture("")] 
```

由此可见，中性语言设置与汇编文化设置不同。

如果您正在本地化您的应用程序，您应该设置`NeutralResourcesLanguageAttribute`您在中性资源文件中使用的文化。（有关更多信息，请参阅[此答案](https://stackoverflow.com/a/11411104/1497596)。）

# java - 使用 javax.tools.JavaCompiler 在内存中完全编译代码

> ID：12173294
> 
> 赞同：45
> 
> 时间：2012-08-29T08:00:10.463
> 
> 标签：java, compilation, javac, java-compiler-api

我正在使用 javax.tools 包（JDK 1.7）中的 JavaCompiler 即时编译一些东西，如下所示：

```
compiler.run(null, null, "-cp", paths, "path/to/my/file.java"); 
```

它可以工作，但我想在内存中完成所有操作（例如，使用代码传递一个字符串，而不是源文件，并获取字节码而不是 .class 文件）。我发现扩展`InputStream`and`OutputStream`参数没有用，因为它可能与控制台中的相同。你知道一种让 run 方法像这样工作的方法吗？或者您知道使用该方法执行此操作的确认`getTask()`方法吗？（扩展 FileManager 看起来很容易，但不是那么容易 :)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2015-03-06T00:22:54.293

我已经在 Mac OS Java 7 中运行了上述代码。它们都不起作用。所以我写了一个 [https://github.com/trung/InMemoryJavaCompiler](https://github.com/trung/InMemoryJavaCompiler)

```
StringBuffer sourceCode = new StringBuffer();
sourceCode.append("package org.mdkt;\n");
sourceCode.append("public class HelloClass {\n");
sourceCode.append("   public String hello() { return \"hello\"; }");
sourceCode.append("}");

Class<?> helloClass = InMemoryJavaCompiler.compile("org.mdkt.HelloClass", sourceCode.toString()); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-08-29T08:03:43.643

我认为这在这里可能会有所帮助，它基本上展示了如何从内存中编译 Java 源代码（字符串位于类中）。

它使用`PrinterWriter`and`StringWriter`将源代码写入`String`/in 内存，然后使用`JavaCompiler`类（从 JDK 6 开始）编译和运行程序：

```
import javax.tools.Diagnostic;
import javax.tools.DiagnosticCollector;
import javax.tools.JavaCompiler;
import javax.tools.JavaCompiler.CompilationTask;
import javax.tools.JavaFileObject;
import javax.tools.SimpleJavaFileObject;
import javax.tools.ToolProvider;
import java.io.File;
import java.io.IOException;
import java.io.PrintWriter;
import java.io.StringWriter;
import java.lang.reflect.InvocationTargetException;
import java.net.URI;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.Arrays;

public class CompileSourceInMemory {
  public static void main(String args[]) throws IOException {
    JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
    DiagnosticCollector<JavaFileObject> diagnostics = new DiagnosticCollector<JavaFileObject>();

    StringWriter writer = new StringWriter();
    PrintWriter out = new PrintWriter(writer);
    out.println("public class HelloWorld {");
    out.println("  public static void main(String args[]) {");
    out.println("    System.out.println(\"This is in another java file\");");    
    out.println("  }");
    out.println("}");
    out.close();
    JavaFileObject file = new JavaSourceFromString("HelloWorld", writer.toString());

    Iterable<? extends JavaFileObject> compilationUnits = Arrays.asList(file);
    CompilationTask task = compiler.getTask(null, null, diagnostics, null, null, compilationUnits);

    boolean success = task.call();
    for (Diagnostic diagnostic : diagnostics.getDiagnostics()) {
      System.out.println(diagnostic.getCode());
      System.out.println(diagnostic.getKind());
      System.out.println(diagnostic.getPosition());
      System.out.println(diagnostic.getStartPosition());
      System.out.println(diagnostic.getEndPosition());
      System.out.println(diagnostic.getSource());
      System.out.println(diagnostic.getMessage(null));

    }
    System.out.println("Success: " + success);

    if (success) {
      try {

          URLClassLoader classLoader = URLClassLoader.newInstance(new URL[] { new File("").toURI().toURL() });
          Class.forName("HelloWorld", true, classLoader).getDeclaredMethod("main", new Class[] { String[].class }).invoke(null, new Object[] { null });

      } catch (ClassNotFoundException e) {
        System.err.println("Class not found: " + e);
      } catch (NoSuchMethodException e) {
        System.err.println("No such method: " + e);
      } catch (IllegalAccessException e) {
        System.err.println("Illegal access: " + e);
      } catch (InvocationTargetException e) {
        System.err.println("Invocation target: " + e);
      }
    }
  }
}

class JavaSourceFromString extends SimpleJavaFileObject {
  final String code;

  JavaSourceFromString(String name, String code) {
    super(URI.create("string:///" + name.replace('.','/') + Kind.SOURCE.extension),Kind.SOURCE);
    this.code = code;
  }

  @Override
  public CharSequence getCharContent(boolean ignoreEncodingErrors) {
    return code;
  }
} 
```

如果您查看参考链接，您还会发现更多其他示例

**参考：**

*   [从内存编译](http://www.java2s.com/Code/Java/JDK-6/CompilingfromMemory.htm)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-11-27T19:47:33.400

*这是一个完全*在内存中编译的类。

我已经（几乎）从Rekha Kumari（2011 年 6 月）的[http://javapracs.blogspot.de/2011/06/dynamic-in-memory-compilation-using.html中获取了全部内容。](http://javapracs.blogspot.de/2011/06/dynamic-in-memory-compilation-using.html)虽然这个版本短了 100 多行，并且具有更多的功能（但没有文档：P）。

它可以一次编译多个类，这是编译相互依赖的类的唯一方法。如果您想知道“CompilerFeedback”类：我正在开发一个小型 Java [IDE](https://i.imgur.com/NoXxgvn.png)，用于我需要的编码游戏。我将它包含在这里是因为我假设您想用这个编译器*做*一些事情，而预消化可能会对此有所帮助。（我意识到 CompilerFeedback 类中的一些代码完全是废话。它是从多年的尝试中回收的。

还有一个实用方法，编译不需要，它从类的源代码（包括包名，如果提供的话）派生完整的类名。对于调用编译器非常有用，它确实需要这些信息。

演示课：

```
import java.util.ArrayList;
import java.util.List;

public class Demo {

    public static void main(final String[] args) {

        final InMemoryCompiler.IMCSourceCode cls1source;
        final InMemoryCompiler.IMCSourceCode cls2source;

        final StringBuilder sb = new StringBuilder();
        sb.append("package toast;\n");
        sb.append("public class DynaClass {\n");
        sb.append("    public static void main(final String[] args) {");
        sb.append("        System.out.println(\"Based massively on the work of Rekha Kumari, http://javapracs.blogspot.de/2011/06/dynamic-in-memory-compilation-using.html\");\n");
        sb.append("        System.out.println(\"This is the main method speaking.\");\n");
        sb.append("        System.out.println(\"Args: \" + java.util.Arrays.toString(args));\n");
        sb.append("        final Test test = new Test();\n");
        sb.append("    }\n");
        sb.append("    public String toString() {\n");
        sb.append("        return \"Hello, I am \" + ");
        sb.append("this.getClass().getSimpleName();\n");
        sb.append("    }\n");
        sb.append("}\n");
        cls1source = new InMemoryCompiler.IMCSourceCode("toast.DynaClass", sb.toString());

        sb.setLength(0);
        sb.append("package toast;\n");
        sb.append("public class Test {\n");
        sb.append("    public Test() {\n");
        sb.append("        System.out.println(\"class Test constructor reporting in.\");\n");
        sb.append("        System.out.println(new DynaClass());\n");
        sb.append("    }\n");
        sb.append("}\n");
        cls2source = new InMemoryCompiler.IMCSourceCode("toast.Test", sb.toString());

        final List<InMemoryCompiler.IMCSourceCode> classSources = new ArrayList<>();
        classSources.add(cls1source);
        classSources.add(cls2source);

        final InMemoryCompiler uCompiler = new InMemoryCompiler(classSources);
        final CompilerFeedback compilerFeedback = uCompiler.compile();
        System.out.println("\n\nCOMPILER FEEDBACK: " + compilerFeedback);

        if (compilerFeedback != null && compilerFeedback.success) {

            try {
                System.out.println("\nTOSTRING DEMO:");
                uCompiler.runToString(cls1source.fullClassName);
            } catch (Exception e) {
                e.printStackTrace();
            }

            try {
                System.out.println("\nMAIN DEMO:");
                uCompiler.runMain(cls1source.fullClassName, new String[] { "test1", "test2" });
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        System.exit(0);
    }
} 
```

编译器类：

```
import javax.tools.*;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.net.URI;
import java.security.SecureClassLoader;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * MASSIVELY based on http://javapracs.blogspot.de/2011/06/dynamic-in-memory-compilation-using.html by Rekha Kumari
 * (June 2011)
 */
final public class InMemoryCompiler {

    final public static class IMCSourceCode {

        final public String fullClassName;
        final public String sourceCode;

        /**
         * @param fullClassName Full name of the class that will be compiled. If the class should be in some package,
         *                      fullName should contain it too, for example: "testpackage.DynaClass"
         * @param sourceCode    the source code
         */
        public IMCSourceCode(final String fullClassName, final String sourceCode) {

            this.fullClassName = fullClassName;
            this.sourceCode = sourceCode;
        }
    }

    final public boolean valid;

    final private List<IMCSourceCode> classSourceCodes;
    final private JavaFileManager fileManager;

    public InMemoryCompiler(final List<IMCSourceCode> classSourceCodes) {

        this.classSourceCodes = classSourceCodes;

        final JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
        if (compiler == null) {
            fileManager = null;
            valid = false;
            System.err.println("ToolProvider.getSystemJavaCompiler() returned null! This program needs to be run on a system with an installed JDK.");
            return;
        }
        valid = true;

        fileManager = new ForwardingJavaFileManager<JavaFileManager>(compiler.getStandardFileManager(null, null, null)) {

            final private Map<String, ByteArrayOutputStream> byteStreams = new HashMap<>();

            @Override
            public ClassLoader getClassLoader(final Location location) {

                return new SecureClassLoader() {

                    @Override
                    protected Class<?> findClass(final String className) throws ClassNotFoundException {

                        final ByteArrayOutputStream bos = byteStreams.get(className);
                        if (bos == null) {
                            return null;
                        }
                        final byte[] b = bos.toByteArray();
                        return super.defineClass(className, b, 0, b.length);
                    }
                };
            }

            @Override
            public JavaFileObject getJavaFileForOutput(final Location location, final String className, final JavaFileObject.Kind kind, final FileObject sibling) throws IOException {

                return new SimpleJavaFileObject(URI.create("string:///" + className.replace('.', '/') + kind.extension), kind) {

                    @Override
                    public OutputStream openOutputStream() throws IOException {

                        ByteArrayOutputStream bos = byteStreams.get(className);
                        if (bos == null) {
                            bos = new ByteArrayOutputStream();
                            byteStreams.put(className, bos);
                        }
                        return bos;
                    }
                };
            }
        };
    }

    public CompilerFeedback compile() {

        if (!valid) {
            return null;
        }
        final List<JavaFileObject> files = new ArrayList<>();
        for (IMCSourceCode classSourceCode : classSourceCodes) {
            URI uri = null;
            try {
                uri = URI.create("string:///" + classSourceCode.fullClassName.replace('.', '/') + JavaFileObject.Kind.SOURCE.extension);
            } catch (Exception e) {
                //                e.printStackTrace();
            }
            if (uri != null) {
                final SimpleJavaFileObject sjfo = new SimpleJavaFileObject(uri, JavaFileObject.Kind.SOURCE) {

                    @Override
                    public CharSequence getCharContent(final boolean ignoreEncodingErrors) {

                        return classSourceCode.sourceCode;
                    }
                };
                files.add(sjfo);
            }
        }

        final DiagnosticCollector<JavaFileObject> diagnostics = new DiagnosticCollector<>();

        final JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();

        if (files.size() > 0) {
            final JavaCompiler.CompilationTask task = compiler.getTask(null, fileManager, diagnostics, null, null, files);
            return new CompilerFeedback(task.call(), diagnostics);
        } else {
            return null;
        }
    }

    public void runToString(final String className) throws InstantiationException, IllegalAccessException, ClassNotFoundException {

        if (!valid) {
            return;
        }
        final Class<?> theClass = getCompiledClass(className);
        final Object instance = theClass.newInstance();
        System.out.println(instance);
    }

    public void runMain(final String className, final String[] args) throws IllegalAccessException, ClassNotFoundException, NoSuchMethodException, InvocationTargetException {

        if (!valid) {
            return;
        }
        final Class<?> theClass = getCompiledClass(className);
        final Method mainMethod = theClass.getDeclaredMethod("main", String[].class);
        mainMethod.invoke(null, new Object[] { args });
    }

    public Class<?> getCompiledClass(final String className) throws ClassNotFoundException {

        if (!valid) {
            throw new IllegalStateException("InMemoryCompiler instance not usable because ToolProvider.getSystemJavaCompiler() returned null: No JDK installed.");
        }
        final ClassLoader classLoader = fileManager.getClassLoader(null);
        final Class<?> ret = classLoader.loadClass(className);
        if (ret == null) {
            throw new ClassNotFoundException("Class returned by ClassLoader was null!");
        }
        return ret;
    }
} 
```

编译器反馈类：

```
import javax.tools.Diagnostic;
import javax.tools.DiagnosticCollector;
import javax.tools.JavaFileObject;
import javax.tools.SimpleJavaFileObject;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.Locale;

final public class CompilerFeedback {

    final public boolean success;
    final public List<CompilerMessage> messages = new ArrayList<>();

    public CompilerFeedback(final Boolean success, final DiagnosticCollector<JavaFileObject> diagnostics) {

        this.success = success != null && success;
        for (Diagnostic<? extends JavaFileObject> diagnostic : diagnostics.getDiagnostics()) {
            messages.add(new CompilerMessage(diagnostic));
        }
    }

    public String toString() {

        final StringBuilder sb = new StringBuilder();

        sb.append("SUCCESS: ").append(success).append('\n');
        final int iTop = messages.size();
        for (int i = 0; i < iTop; i++) {
            sb.append("\n[MESSAGE ").append(i + 1).append(" OF ").append(iTop).append("]\n\n");
            // sb.append(messages.get(i).toString()).append("\n");
            // sb.append(messages.get(i).toStringForList()).append("\n");
            sb.append(messages.get(i).toStringForDebugging()).append("\n");
        }
        return sb.toString();
    }

    final public static class CompilerMessage {

        final public Diagnostic<? extends JavaFileObject> compilerInfo;

        final public String typeOfProblem;
        final public String typeOfProblem_forDebugging;

        final public String multiLineMessage;

        final public int lineNumber;
        final public int columnNumber;

        final public int textHighlightPos_lineStart;
        final public int textHighlightPos_problemStart;
        final public int textHighlightPos_problemEnd;

        final public String sourceCode;
        final public String codeOfConcern;
        final public String codeOfConcernLong;

        CompilerMessage(final Diagnostic<? extends JavaFileObject> diagnostic) {

            final JavaFileObject sourceFileObject = diagnostic.getSource();
            String sourceCodePreliminary = null;
            if (sourceFileObject instanceof SimpleJavaFileObject) {
                final SimpleJavaFileObject simpleSourceFileObject = (SimpleJavaFileObject) sourceFileObject;

                try {
                    final CharSequence charSequence = simpleSourceFileObject.getCharContent(false);
                    sourceCodePreliminary = charSequence.toString();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
            if (sourceCodePreliminary == null) {
                sourceCode = "[SOURCE CODE UNAVAILABLE]";
            } else {
                sourceCode = sourceCodePreliminary;
            }

            compilerInfo = diagnostic;

            typeOfProblem = diagnostic.getKind().name();
            typeOfProblem_forDebugging = "toString() = " + diagnostic.getKind().toString() + "; name() = " + typeOfProblem;

            lineNumber = (int) compilerInfo.getLineNumber();
            columnNumber = (int) compilerInfo.getColumnNumber();

            final int sourceLen = sourceCode.length();
            textHighlightPos_lineStart = (int) Math.min(Math.max(0, diagnostic.getStartPosition()), sourceLen);
            textHighlightPos_problemStart = (int) Math.min(Math.max(0, diagnostic.getPosition()), sourceLen);
            textHighlightPos_problemEnd = (int) Math.min(Math.max(0, diagnostic.getEndPosition()), sourceLen);

            final StringBuilder reformattedMessage = new StringBuilder();
            final String message = diagnostic.getMessage(Locale.US);
            final int messageCutOffPosition = message.indexOf("location:");
            final String[] messageParts;
            if (messageCutOffPosition >= 0) {
                messageParts = message.substring(0, messageCutOffPosition).split("\n");
            } else {
                messageParts = message.split("\n");
            }
            for (String s : messageParts) {
                String s2 = s.trim();
                if (s2.length() > 0) {
                    boolean lengthChanged;
                    do {
                        final int lBeforeReplace = s2.length();
                        s2 = s2.replace("  ", " ");
                        lengthChanged = (s2.length() != lBeforeReplace);
                    } while (lengthChanged);
                    reformattedMessage.append(s2).append("\n");
                }
            }

            codeOfConcern = sourceCode.substring(textHighlightPos_problemStart, textHighlightPos_problemEnd);
            codeOfConcernLong = sourceCode.substring(textHighlightPos_lineStart, textHighlightPos_problemEnd);
            if (!codeOfConcern.isEmpty()) {
                reformattedMessage.append("Code of concern: \"").append(codeOfConcern).append('\"');
            }
            multiLineMessage = reformattedMessage.toString();
        }

        public String toStringForList() {

            if (compilerInfo == null) {
                return "No compiler!";
            } else {
                return compilerInfo.getCode();
            }
        }

        public String toStringForDebugging() {

            final StringBuilder ret = new StringBuilder();

            ret.append("Type of problem: ").append(typeOfProblem_forDebugging).append("\n\n");
            ret.append("Message:\n").append(multiLineMessage).append("\n\n");

            ret.append(compilerInfo.getCode()).append("\n\n");

            ret.append("line number: ").append(lineNumber).append("\n");
            ret.append("column number: ").append(columnNumber).append("\n");

            ret.append("textHighlightPos_lineStart: ").append(textHighlightPos_lineStart).append("\n");
            ret.append("textHighlightPos_problemStart: ").append(textHighlightPos_problemStart).append("\n");
            ret.append("textHighlightPos_problemEnd: ").append(textHighlightPos_problemEnd).append("\n");

            return ret.toString();
        }

        @Override
        public String toString() {

            //            return compilerInfo.getMessage(Locale.US);
            return typeOfProblem + ": " + multiLineMessage + "\n";
        }
    }
} 
```

实用方法（后面的三个类不需要。）：

```
final public static String PREFIX_CLASSNAME = "class ";
final public static String PREFIX_PACKAGENAME = "package ";
final public static String CHARSET_JAVAKEYWORDENDERS = " \n[](){}<>;,\"\\/*+-=%!&?@:";

/**
 * @return e.g. "com.dreamspacepresident.TestClass" if the source's first root level "class" (I'm talking about {}
 * hierarchy.) is named "TestClass", and if the "package" name is "com.dreamspacepresident". Null is returned if
 * sourceCode is null or does not provide a class name. (Mind that the parsing is done in a quite crappy way.)
 */
public static String deriveFullClassNameFromSource(final String sourceCode) {

    if (sourceCode == null) {
        return null;
    }
    final int firstBr = sourceCode.indexOf('{');
    if (firstBr >= 0) {
        // DETERMINE CLASS NAME
        final int firstClass = sourceCode.indexOf(PREFIX_CLASSNAME);
        if (firstClass < firstBr) {
            String className = sourceCode.substring(firstClass + PREFIX_CLASSNAME.length(), firstBr).trim();
            final int classNameEnd = indexOfAnyOfThese(className, CHARSET_JAVAKEYWORDENDERS);
            if (classNameEnd >= 0) {
                className = className.substring(0, classNameEnd);
            }
            if (!className.isEmpty()) {
                // DETERMINE PACKAGE NAME
                String packageName = null;
                final int firstPackage = sourceCode.indexOf(PREFIX_PACKAGENAME);
                if (firstPackage >= 0 && firstPackage < firstBr && firstPackage < firstClass) {
                    packageName = sourceCode.substring(firstPackage + PREFIX_PACKAGENAME.length(), firstBr).trim();
                    final int packageNameEnd = indexOfAnyOfThese(packageName, CHARSET_JAVAKEYWORDENDERS);
                    if (packageNameEnd >= 0) {
                        packageName = packageName.substring(0, packageNameEnd);
                    }
                }
                return (packageName != null && !packageName.isEmpty() ? packageName + "." : "") + className;
            }
        }
    }
    return null;
}

/**
 * Looks for the first occurrence of ANY of the given characters, which is easier than using a bunch of
 * String.indexOf() calls.
 *
 * @return -1 if not found, otherwise the String index of the first hit
 */
public static int indexOfAnyOfThese(final String text, final String characters) {

    if (text != null && !text.isEmpty() && characters != null && !characters.isEmpty()) {
        final int lenT = text.length();
        final int lenC = characters.length();
        for (int i = 0; i < lenT; i++) {
            final char c = text.charAt(i);
            for (int ii = 0; ii < lenC; ii++) {
                if (c == characters.charAt(ii)) {
                    return i;
                }
            }
        }
    }
    return -1;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-08-29T08:15:57.493

几年前我写了一个库来做到这一点。它需要一个可以包含嵌套类的字符串，编译它们并可选地将它们加载到当前的类加载器中（所以你不需要额外的类加载器）如果 JVM 在调试模式下运行，它会将生成的代码写入文件这样您就可以逐步完成生成的代码。

[http://vanillajava.blogspot.co.uk/2010_11_01_archive.html](http://vanillajava.blogspot.co.uk/2010_11_01_archive.html)

* * *

`erolagnab`用你可以做的例子来解释

```
StringBuilder sourceCode = new StringBuilder();
sourceCode.append("package org.mdkt;\n")
          .append("public class HelloClass {\n")
          .append("   public String hello() { return \"hello\"; }")
          .append("}");

Class<?> helloClass = CACHED_COMPILER.compile("org.mdkt.HelloClass",
                                              sourceCode.toString()); 
```

更新，源代码在这里[https://github.com/OpenHFT/Java-Runtime-Compiler](https://github.com/OpenHFT/Java-Runtime-Compiler)

您可以通过 maven [http://search.maven.org/#browse%7C842970587获取最新版本](http://search.maven.org/#browse%7C842970587)

* * *

一个更长的例子。

```
// this writes the file to disk only when debugging is enabled.
CachedCompiler cc = CompilerUtils.DEBUGGING ?
        new CachedCompiler(new File(parent, "src/test/java"), new File(parent, "target/compiled")) :
        CompilerUtils.CACHED_COMPILER;

String text = "generated test " + new Date();
Class fooBarTeeClass = cc.loadFromJava("eg.FooBarTee", "package eg;\n" +
    '\n' +
    "import eg.components.BarImpl;\n" +
    "import eg.components.TeeImpl;\n" +
    "import eg.components.Foo;\n" +
    '\n' +
    "public class FooBarTee{\n" +
    "    public final String name;\n" +
    "    public final TeeImpl tee;\n" +
    "    public final BarImpl bar;\n" +
    "    public final BarImpl copy;\n" +
    "    public final Foo foo;\n" +
    '\n' +
    "    public FooBarTee(String name) {\n" +
    "        // when viewing this file, ensure it is synchronised with the copy on disk.\n" +
    "        System.out.println(\"" + text + "\");\n" +
    "        this.name = name;\n" +
    '\n' +
    "        tee = new TeeImpl(\"test\");\n" +
    '\n' +
    "        bar = new BarImpl(tee, 55);\n" +
    '\n' +
    "        copy = new BarImpl(tee, 555);\n" +
    '\n' +
    "        // you should see the current date here after synchronisation.\n" +
    "        foo = new Foo(bar, copy, \"" + text + "\", 5);\n" +
    "    }\n" +
    '\n' +
    "    public void start() {\n" +
    "    }\n" +
    '\n' +
    "    public void stop() {\n" +
    "    }\n" +
    '\n' +
    "    public void close() {\n" +
    "        stop();\n" +
    '\n' +
    "    }\n" +
    "}\n");

// add a debug break point here and step into this method.
FooBarTee fooBarTee = new FooBarTee("test foo bar tee");
Foo foo = fooBarTee.foo;
assertNotNull(foo);
assertEquals(text, foo.s); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-02-05T11:55:54.973

我想了：

*   **java 文件的内存编译**（对于作为脚本语言的 Java 很有用）
*   没有额外的依赖（易于设置）
*   在尽可能少的文件中实现（易于合并到项目中）

您可以先在这里尝试：http: [//ideone.com/cu1GhE#view_edit_box](http://ideone.com/cu1GhE#view_edit_box)

以下代码基于[Rekha Kumari](http://javapracs.blogspot.de/2011/06/dynamic-in-memory-compilation-using.html)代码：

**主.java**

```
package com.mycompany.java;

//import org.slf4j.Logger;
//import org.slf4j.LoggerFactory;

import java.io.PrintWriter;
import java.io.StringWriter;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class Main {

    //private static final Logger logger = LoggerFactory.getLogger(Main.class);

    public static void main(String[] args) {    
        try {
            StringWriter writer = new StringWriter();
            PrintWriter out = new PrintWriter(writer);
            out.println("package com.mycompany.script;");
            out.println("");
            out.println("public class HelloWorld {");
            out.println("  public static void main(String args[]) {");
            out.println("    System.out.println(\"This is in another java file\");");
            out.println("  }");
            out.println("}");
            out.close();

            String fullName = "com.mycompany.script.HelloWorld";
            String src = writer.toString();

            DynamicCompiler uCompiler = new DynamicCompiler(fullName, src);
            uCompiler.compile();
            uCompiler.run();

        } catch (Exception e) {
            //logger.error("Exception:", e);
            System.out.print("Exception");
        }
    }    
} 
```

**动态编译器.java**

```
package com.mycompany.java;

//import org.slf4j.Logger;
//import org.slf4j.LoggerFactory;

import javax.tools.*;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.lang.reflect.InvocationTargetException;
import java.net.URI;
import java.security.SecureClassLoader;
import java.util.ArrayList;
import java.util.List;

// Based on: http://javapracs.blogspot.cz/2011/06/dynamic-in-memory-compilation-using.html
public class DynamicCompiler {
    //private static final Logger logger = LoggerFactory.getLogger(DynamicCompiler.class);

    private JavaFileManager fileManager;
    private String fullName;
    private String sourceCode;

    public DynamicCompiler(String fullName, String srcCode) {
        this.fullName = fullName;
        this.sourceCode = srcCode;
        this.fileManager = initFileManager();
    }

    public JavaFileManager initFileManager() {
        if (fileManager != null)
            return fileManager;
        else {
            JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
            fileManager = new
                    ClassFileManager(compiler
                    .getStandardFileManager(null, null, null));
            return fileManager;
        }
    }

    public void compile() {
        JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();    
        List<JavaFileObject> files = new ArrayList<>();
        files.add(new CharSequenceJavaFileObject(fullName, sourceCode));

        compiler.getTask(
                null,
                fileManager,
                null,
                null,
                null,
                files
        ).call();
    }

    public void run() throws InstantiationException, IllegalAccessException, ClassNotFoundException {
        try {
            fileManager
                    .getClassLoader(null)
                    .loadClass(fullName)
                    .getDeclaredMethod("main", new Class[]{String[].class})
                    .invoke(null, new Object[]{null});
        } catch (InvocationTargetException e) {
            System.out.print("InvocationTargetException");
            //logger.error("InvocationTargetException:", e);
        } catch (NoSuchMethodException e) {
            System.out.print("NoSuchMethodException ");
            //logger.error("NoSuchMethodException:", e);
        }
    }

    public class CharSequenceJavaFileObject extends SimpleJavaFileObject {

        /**
         * CharSequence representing the source code to be compiled
         */
        private CharSequence content;

        public CharSequenceJavaFileObject(String className, CharSequence content) {
            super(URI.create("string:///" + className.replace('.', '/') + Kind.SOURCE.extension), Kind.SOURCE);
            this.content = content;
        }

        public CharSequence getCharContent(boolean ignoreEncodingErrors) {
            return content;
        }
    }

    public class ClassFileManager extends ForwardingJavaFileManager {
        private JavaClassObject javaClassObject;

        public ClassFileManager(StandardJavaFileManager standardManager) {
            super(standardManager);
        }

        @Override
        public ClassLoader getClassLoader(Location location) {
            return new SecureClassLoader() {
                @Override
                protected Class<?> findClass(String name) throws ClassNotFoundException {
                    byte[] b = javaClassObject.getBytes();
                    return super.defineClass(name, javaClassObject.getBytes(), 0, b.length);
                }
            };
        }

        public JavaFileObject getJavaFileForOutput(Location location, String className, JavaFileObject.Kind kind, FileObject sibling) throws IOException {
            this.javaClassObject = new JavaClassObject(className, kind);
            return this.javaClassObject;
        }
    }

    public class JavaClassObject extends SimpleJavaFileObject {
        protected final ByteArrayOutputStream bos =
                new ByteArrayOutputStream();

        public JavaClassObject(String name, Kind kind) {
            super(URI.create("string:///" + name.replace('.', '/')
                    + kind.extension), kind);
        }

        public byte[] getBytes() {
            return bos.toByteArray();
        }

        @Override
        public OutputStream openOutputStream() throws IOException {
            return bos;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-09T23:56:12.713

我想介绍我在生产中运行良好的解决方案。

这是三个源代码文件。

MemoryJavaCompiler.java

```
package me.soulmachine.compiler;

import java.io.IOException;
import java.io.PrintWriter;
import java.io.Writer;
import java.lang.reflect.Method;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import javax.tools.*;

/**
 * Simple interface to Java compiler using JSR 199 Compiler API.
 */
public class MemoryJavaCompiler {
    private javax.tools.JavaCompiler tool;
    private StandardJavaFileManager stdManager;

    public MemoryJavaCompiler() {
        tool = ToolProvider.getSystemJavaCompiler();
        if (tool == null) {
            throw new RuntimeException("Could not get Java compiler. Please, ensure that JDK is used instead of JRE.");
        }
        stdManager = tool.getStandardFileManager(null, null, null);
    }

    /**
     * Compile a single static method.
     */
    public Method compileStaticMethod(final String methodName, final String className,
        final String source)
        throws ClassNotFoundException {
        final Map<String, byte[]> classBytes = compile(className + ".java", source);
        final MemoryClassLoader classLoader = new MemoryClassLoader(classBytes);
        final Class clazz = classLoader.loadClass(className);
        final Method[] methods = clazz.getDeclaredMethods();
        for (final Method method : methods) {
            if (method.getName().equals(methodName)) {
                if (!method.isAccessible()) method.setAccessible(true);
                return method;
            }
        }
        throw new NoSuchMethodError(methodName);
    }

    public Map<String, byte[]> compile(String fileName, String source) {
        return compile(fileName, source, new PrintWriter(System.err), null, null);
    }

    /**
     * compile given String source and return bytecodes as a Map.
     *
     * @param fileName source fileName to be used for error messages etc.
     * @param source Java source as String
     * @param err error writer where diagnostic messages are written
     * @param sourcePath location of additional .java source files
     * @param classPath location of additional .class files
     */
    private Map<String, byte[]> compile(String fileName, String source,
        Writer err, String sourcePath, String classPath) {
        // to collect errors, warnings etc.
        DiagnosticCollector<JavaFileObject> diagnostics =
            new DiagnosticCollector<JavaFileObject>();

        // create a new memory JavaFileManager
        MemoryJavaFileManager fileManager = new MemoryJavaFileManager(stdManager);

        // prepare the compilation unit
        List<JavaFileObject> compUnits = new ArrayList<JavaFileObject>(1);
        compUnits.add(fileManager.makeStringSource(fileName, source));

        return compile(compUnits, fileManager, err, sourcePath, classPath);
    }

    private Map<String, byte[]> compile(final List<JavaFileObject> compUnits, 
        final MemoryJavaFileManager fileManager,
        Writer err, String sourcePath, String classPath) {
        // to collect errors, warnings etc.
        DiagnosticCollector<JavaFileObject> diagnostics =
            new DiagnosticCollector<JavaFileObject>();

        // javac options
        List<String> options = new ArrayList<String>();
        options.add("-Xlint:all");
        //      options.add("-g:none");
        options.add("-deprecation");
        if (sourcePath != null) {
            options.add("-sourcepath");
            options.add(sourcePath);
        }

        if (classPath != null) {
            options.add("-classpath");
            options.add(classPath);
        }

        // create a compilation task
        javax.tools.JavaCompiler.CompilationTask task =
            tool.getTask(err, fileManager, diagnostics,
                options, null, compUnits);

        if (task.call() == false) {
            PrintWriter perr = new PrintWriter(err);
            for (Diagnostic diagnostic : diagnostics.getDiagnostics()) {
                perr.println(diagnostic);
            }
            perr.flush();
            return null;
        }

        Map<String, byte[]> classBytes = fileManager.getClassBytes();
        try {
            fileManager.close();
        } catch (IOException exp) {
        }

        return classBytes;
    }
} 
```

MemoryJavaFileManager.java

```
package me.soulmachine.compiler;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FilterOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.net.URI;
import java.nio.CharBuffer;
import java.util.HashMap;
import java.util.Map;

import javax.tools.FileObject;
import javax.tools.ForwardingJavaFileManager;
import javax.tools.JavaFileManager;
import javax.tools.JavaFileObject;
import javax.tools.JavaFileObject.Kind;
import javax.tools.SimpleJavaFileObject;

/**
 * JavaFileManager that keeps compiled .class bytes in memory.
 */
@SuppressWarnings("unchecked")
final class MemoryJavaFileManager extends ForwardingJavaFileManager {

    /** Java source file extension. */
    private final static String EXT = ".java";

    private Map<String, byte[]> classBytes;

    public MemoryJavaFileManager(JavaFileManager fileManager) {
        super(fileManager);
        classBytes = new HashMap<>();
    }

    public Map<String, byte[]> getClassBytes() {
        return classBytes;
    }

    public void close() throws IOException {
        classBytes = null;
    }

    public void flush() throws IOException {
    }

    /**
     * A file object used to represent Java source coming from a string.
     */
    private static class StringInputBuffer extends SimpleJavaFileObject {
        final String code;

        StringInputBuffer(String fileName, String code) {
            super(toURI(fileName), Kind.SOURCE);
            this.code = code;
        }

        public CharBuffer getCharContent(boolean ignoreEncodingErrors) {
            return CharBuffer.wrap(code);
        }
    }

    /**
     * A file object that stores Java bytecode into the classBytes map.
     */
    private class ClassOutputBuffer extends SimpleJavaFileObject {
        private String name;

        ClassOutputBuffer(String name) {
            super(toURI(name), Kind.CLASS);
            this.name = name;
        }

        public OutputStream openOutputStream() {
            return new FilterOutputStream(new ByteArrayOutputStream()) {
                public void close() throws IOException {
                    out.close();
                    ByteArrayOutputStream bos = (ByteArrayOutputStream)out;
                    classBytes.put(name, bos.toByteArray());
                }
            };
        }
    }

    public JavaFileObject getJavaFileForOutput(JavaFileManager.Location location,
        String className,
        Kind kind,
        FileObject sibling) throws IOException {
        if (kind == Kind.CLASS) {
            return new ClassOutputBuffer(className);
        } else {
            return super.getJavaFileForOutput(location, className, kind, sibling);
        }
    }

    static JavaFileObject makeStringSource(String fileName, String code) {
        return new StringInputBuffer(fileName, code);
    }

    static URI toURI(String name) {
        File file = new File(name);
        if (file.exists()) {
            return file.toURI();
        } else {
            try {
                final StringBuilder newUri = new StringBuilder();
                newUri.append("mfm:///");
                newUri.append(name.replace('.', '/'));
                if(name.endsWith(EXT)) newUri.replace(newUri.length() - EXT.length(), newUri.length(), EXT);
                return URI.create(newUri.toString());
            } catch (Exception exp) {
                return URI.create("mfm:///com/sun/script/java/java_source");
            }
        }
    }
} 
```

MemoryClassLoader.java

```
package me.soulmachine.compiler;

import java.io.File;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.StringTokenizer;

/**
 * ClassLoader that loads .class bytes from memory.
 */
final class MemoryClassLoader extends URLClassLoader {
    private Map<String, byte[]> classBytes;

    public MemoryClassLoader(Map<String, byte[]> classBytes,
        String classPath, ClassLoader parent) {
        super(toURLs(classPath), parent);
        this.classBytes = classBytes;
    }

    public MemoryClassLoader(Map<String, byte[]> classBytes, String classPath) {
        this(classBytes, classPath, ClassLoader.getSystemClassLoader());
    }

    public MemoryClassLoader(Map<String, byte[]> classBytes) {
        this(classBytes, null, ClassLoader.getSystemClassLoader());
    }

    public Class load(String className) throws ClassNotFoundException {
        return loadClass(className);
    }

    public Iterable<Class> loadAll() throws ClassNotFoundException {
        List<Class> classes = new ArrayList<Class>(classBytes.size());
        for (String name : classBytes.keySet()) {
            classes.add(loadClass(name));
        }
        return classes;
    }

    protected Class findClass(String className) throws ClassNotFoundException {
        byte[] buf = classBytes.get(className);
        if (buf != null) {
            // clear the bytes in map -- we don't need it anymore
            classBytes.put(className, null);
            return defineClass(className, buf, 0, buf.length);
        } else {
            return super.findClass(className);
        }
    }

    private static URL[] toURLs(String classPath) {
        if (classPath == null) {
            return new URL[0];
        }

        List<URL> list = new ArrayList<URL>();
        StringTokenizer st = new StringTokenizer(classPath, File.pathSeparator);
        while (st.hasMoreTokens()) {
            String token = st.nextToken();
            File file = new File(token);
            if (file.exists()) {
                try {
                    list.add(file.toURI().toURL());
                } catch (MalformedURLException mue) {}
            } else {
                try {
                    list.add(new URL(token));
                } catch (MalformedURLException mue) {}
            }
        }
        URL[] res = new URL[list.size()];
        list.toArray(res);
        return res;
    }
} 
```

**说明**：

1.  为了在内存而不是磁盘中表示 Java 源文件，我`StringInputBuffer`在`MemoryJavaFileManager.java`.
2.  为了将编译后的`.class`文件保存在内存中，我实现了一个类`MemoryJavaFileManager`。主要思想是重写函数`getJavaFileForOutput()`以将字节码存储到地图中。
3.  要将字节码加载到内存中，我必须实现一个自定义的类加载器`MemoryClassLoader`，它读取映射中的字节码并将它们转换为类。

这是一个单元测试。

```
package me.soulmachine.compiler;

import org.junit.Test;

import java.io.IOException;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.ArrayList;

import static org.junit.Assert.assertEquals;

public class MemoryJavaCompilerTest {
    private final static MemoryJavaCompiler compiler = new MemoryJavaCompiler();

    @Test public void compileStaticMethodTest()
        throws ClassNotFoundException, InvocationTargetException, IllegalAccessException {
        final String source = "public final class Solution {\n"
            + "public static String greeting(String name) {\n"
            + "\treturn \"Hello \" + name;\n" + "}\n}\n";
        final Method greeting = compiler.compileStaticMethod("greeting", "Solution", source);
        final Object result = greeting.invoke(null, "soulmachine");
        assertEquals("Hello soulmachine", result.toString());
    }
} 
```

## 参考

1.  [来自 Cloudera Morphlines 的 JavaCompiler.java](https://github.com/kite-sdk/kite/tree/master/kite-morphlines/kite-morphlines-core/src/main/java/org/kitesdk/morphline/scriptengine/java)
2.  [如何从 Java 中的字符串创建对象（如何评估字符串）？](https://stackoverflow.com/questions/1168931/how-to-create-an-object-from-a-string-in-java-how-to-eval-a-string)
3.  [InMemoryJava编译器](https://github.com/trung/InMemoryJavaCompiler)
4.  [Java 运行时编译器](https://github.com/OpenHFT/Java-Runtime-Compiler)
5.  [动态的Java - 无废话JavaCompilerAPI]
6.  [在内存中编译和运行 Java 源代码](http://www.soulmachine.me/blog/2015/07/22/compile-and-run-java-source-code-in-memory/)。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2015-06-22T15:36:14.777

```
String fileToCompile = ;
JavaCompile compiler = ToolProvider.getSystemJavaCompiler();
if(
    compiler.run(null, null, null, "PACKAGE_NAME" + java.io.File.separator +"CLASS_NAME.java") == 0
)
    System.out.println("Compilation is successful");
else
    System.out.println("Compilation Failed"); 
```

# android - 通过 MoSync 进行 android c++ 软件开发是否值得？

> ID：12173295
> 
> 赞同：1
> 
> 时间：2012-08-29T08:00:13.790
> 
> 标签：android, c++, mobile, mosync

我有几个我使用的移动项目`MoSync`。在这些项目中，我主要使用用于*Java ME*平台的 c++。我发现这个工具包很好而且健壮。结果很完美，我在手机上运行应用程序。
现在我想到了android平台。我想知道`MoSync`对于这个平台的 c++ 开发是否是正确的工具包。开发过程和结果会像*Java ME*平台一样顺利吗？
谢谢！

***补充***
我听说过android NDK，但据我所知，据说

> 您应该了解 NDK 不会使大多数应用程序受益

这是我避免使用它的主要原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T04:49:04.703

我正在使用 mosync 在 android 中开发应用程序。在此之前，我有使用其他 sdk 的经验，例如 phonegap 和 sencha，它们的性能很糟糕！您应该使用 javascript（在 phonegap 和 Titan 中）或 ruby​​（在 rhodes 中）编写应用程序的控制器。并使用 html & css & js 设计 UI，而不是实际的原生 UI。

如果性能是您的应用程序最重要的功能，恕我直言，您可以将 mosync 用于 android 和 iphone。但是如果你需要编写另一个 twitter 插件，phonegap & sencha 是最好的选择。

# c++ - C 样式数组的 C++ 等效项

> ID：12173299
> 
> 赞同：11
> 
> 时间：2012-08-29T08:00:26.757
> 
> 标签：c++, c, performance, optimization

我在这里听到很多人说 C++ 在所有方面都与 C 一样快或*更快*，但更干净、更好。

虽然我并不反对 C++ 非常优雅且速度非常快的事实，但我没有找到任何替代关键内存访问或受处理器限制的应用程序的方法。

**问题**：就性能而言，C 风格的数组在 C++ 中是否存在等价物？

下面的例子是人为的，但我对现实问题的解决方案很感兴趣：我开发图像处理应用程序，那里的像素处理量很大。

```
double t;

// C++ 
std::vector<int> v;
v.resize(1000000,1);
int i, j, count = 0, size = v.size();

t = (double)getTickCount();

for(j=0;j<1000;j++)
{
    count = 0;
    for(i=0;i<size;i++)
         count += v[i];     
}

t = ((double)getTickCount() - t)/getTickFrequency();
std::cout << "(C++) For loop time [s]: " << t/1.0 << std::endl;
std::cout << count << std::endl;

// C-style

#define ARR_SIZE 1000000

int* arr = (int*)malloc( ARR_SIZE * sizeof(int) );

int ci, cj, ccount = 0, csize = ARR_SIZE;

for(ci=0;ci<csize;ci++)
    arr[ci] = 1;

t = (double)getTickCount();

for(cj=0;cj<1000;cj++)
{
    ccount = 0;
    for(ci=0;ci<csize;ci++)
        ccount += arr[ci];      
}

free(arr);

t = ((double)getTickCount() - t)/getTickFrequency();
std::cout << "(C) For loop time [s]: " << t/1.0 << std::endl;
std::cout << ccount << std::endl; 
```

结果如下：

```
(C++) For loop time [s]: 0.329069

(C) For loop time [s]: 0.229961 
```

注意：`getTickCount()`来自第三方库。如果您想测试，只需替换为您最喜欢的时钟测量

**更新：**

我正在使用 VS 2010，发布模式，其他一切默认

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-29T08:19:34.043

简单的回答：您的基准测试存在缺陷。

更长的答案：您需要打开完全优化才能获得 C++ 性能优势。然而，您的基准仍然存在缺陷。

一些观察：

1.  如果您打开完全优化，则会删除大量的 for 循环。这使您的基准测试毫无意义。
2.  `std::vector`有动态重新分配的开销，请尝试`std::array`.
    具体来说，微软的stl默认[检查了迭代器。](http://msdn.microsoft.com/en-us/library/aa985896%28v=vs.80%29.aspx)
3.  您没有任何障碍可以防止 C/C++ 代码/基准代码之间的交叉重新排序。
4.  （不是真正相关的）`cout << ccount`是区域设置感知的，`printf`不是； `std::endl`冲洗输出，`printf("\n")`不要。

显示 c++ 优势的“传统”代码是 C `qsort()`vs C++ `std::sort()`。这就是代码内联大放异彩的地方。

如果您想要一些“现实生活”的应用程序示例。搜索一些光线追踪器或矩阵乘法的东西。选择一个进行自动矢量化的编译器。

**更新** 使用[LLVM 在线演示](http://llvm.org/demo/index.cgi)，我们可以看到整个循环被重新排序。基准代码移动到开始，并跳转到第一个循环中的循环结束点，以便更好地进行分支预测：

（这是 C++ 代码）

```
######### jump to the loop end
    jg  .LBB0_11
.LBB0_3:                                # %..split_crit_edge
.Ltmp2:
# print the benchmark result
    movl    $0, 12(%esp)
    movl    $25, 8(%esp)
    movl    $.L.str, 4(%esp)
    movl    std::cout, (%esp)
    calll   std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long)
.Ltmp3:
# BB#4:                                 # %_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc.exit
.Ltmp4:
    movl    std::cout, (%esp)
    calll   std::basic_ostream<char, std::char_traits<char> >& std::basic_ostream<char, std::char_traits<char> >::_M_insert<double>(double)
.Ltmp5:
# BB#5:                                 # %_ZNSolsEd.exit
    movl    %eax, %ecx
    movl    %ecx, 28(%esp)          # 4-byte Spill
    movl    (%ecx), %eax
    movl    -24(%eax), %eax
    movl    240(%eax,%ecx), %ebp
    testl   %ebp, %ebp
    jne .LBB0_7
# BB#6:
.Ltmp52:
    calll   std::__throw_bad_cast()
.Ltmp53:
.LBB0_7:                                # %.noexc41
    cmpb    $0, 28(%ebp)
    je  .LBB0_15
# BB#8:
    movb    39(%ebp), %al
    jmp .LBB0_21
    .align  16, 0x90
.LBB0_9:                                #   Parent Loop BB0_11 Depth=1
                                        # =>  This Inner Loop Header: Depth=2
    addl    (%edi,%edx,4), %ebx
    addl    $1, %edx
    adcl    $0, %esi
    cmpl    %ecx, %edx
    jne .LBB0_9
# BB#10:                                #   in Loop: Header=BB0_11 Depth=1
    incl    %eax
    cmpl    $1000, %eax             # imm = 0x3E8
######### jump back to the print benchmark code
    je  .LBB0_3 
```

我的测试代码：

```
std::vector<int> v;
v.resize(1000000,1);
int i, j, count = 0, size = v.size();

for(j=0;j<1000;j++)
{
    count = 0;
    for(i=0;i<size;i++)
         count += v[i];     
}

std::cout << "(C++) For loop time [s]: " << t/1.0 << std::endl;
std::cout << count << std::endl; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-29T08:35:26.067

> 问题：就性能而言，C++ 中是否存在与 C 样式数组等效的功能？

答：写C++代码！了解您的语言，了解您的标准库并使用它。标准算法是正确的、可读的和快速的（他们知道如何在当前编译器上快速实现它）。

```
void testC()
{
    // unchanged
}

void testCpp()
{
    // unchanged initialization

    for(j=0;j<1000;j++)
    {
        // how a C++ programmer accumulates:
        count = std::accumulate(begin(v), end(v), 0);    
    }

    // unchanged output
}

int main()
{
    testC();
    testCpp();
} 
```

输出：

```
(C) For loop time [ms]: 434.373
1000000
(C++) For loop time [ms]: 419.79
1000000 
```

`g++ -O3 -std=c++0x`在 Ubuntu 上使用 4.6.3 版编译。

对于您的代码，我的输出与您的相似。user1202136 对差异给出了很好的答案......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-29T08:23:50.123

这似乎是一个编译器问题。对于 C 数组，编译器检测模式，使用自动矢量化并发出 SSE 指令。对于vector来说，它似乎缺乏必要的智能。

如果我强制编译器不使用 SSE，结果非常相似（用 测试`g++ -mno-mmx -mno-sse -msoft-float -O3`）：

```
(C++) For loop time [us]: 604610
1000000
(C) For loop time [us]: 601493
1000000 
```

这是生成此输出的代码。它基本上是您问题中的代码，但没有任何浮点。

```
#include <iostream>
#include <vector>
#include <sys/time.h>

using namespace std;

long getTickCount()
{
    struct timeval tv;
    gettimeofday(&tv, NULL);
    return tv.tv_sec * 1000000 + tv.tv_usec;
}

int main() {
long t;

// C++ 
std::vector<int> v;
v.resize(1000000,1);
int i, j, count = 0, size = v.size();

t = getTickCount();

for(j=0;j<1000;j++)
{
    count = 0;
    for(i=0;i<size;i++)
         count += v[i];     
}

t = getTickCount() - t;
std::cout << "(C++) For loop time [us]: " << t << std::endl;
std::cout << count << std::endl;

// C-style

#define ARR_SIZE 1000000

int* arr = new int[ARR_SIZE];

int ci, cj, ccount = 0, csize = ARR_SIZE;

for(ci=0;ci<csize;ci++)
    arr[ci] = 1;

t = getTickCount();

for(cj=0;cj<1000;cj++)
{
    ccount = 0;
    for(ci=0;ci<csize;ci++)
        ccount += arr[ci];      
}

delete arr;

t = getTickCount() - t;
std::cout << "(C) For loop time [us]: " << t << std::endl;
std::cout << ccount << std::endl;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-29T08:05:25.907

动态大小数组的 C++ 等效项是`std::vector`. `std::array`固定大小数组的 C++ 等价物将是`std::tr1::array`C++11 之前的版本。

如果您的向量代码没有重新调整大小，那么如果您在编译时启用了一些优化，那么很难看出它比使用动态分配的 C 数组要慢得多。

注意：运行发布的代码，在 x86 上的 gcc 4.4.3 上编译，编译器选项

> g++ -Wall -Wextra -pedantic-errors -O2 -std=c++0x

结果可重复地接近

> (C++) For 循环时间 [us]: 507888
> 
> 1000000
> 
> (C) 循环时间 [us]：496659
> 
> 1000000

`std::vector`因此，经过少量试验后，变体的速度似乎慢了约 2% 。我会考虑这种兼容的性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T08:09:26.740

您指出的是，访问对象总是会带来一些开销，因此访问 a`vector`不会比访问一个好的旧数组更快。

但即使使用数组是“C 风格的”，它仍然是 C++，所以不会有问题。

然后，正如@juanchopanza 所说，`std::array`在 C++11 中有可能比 更有效`std::vector`，但专门用于固定大小的数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-29T08:21:04.630

通常编译器会做所有的优化......你只需要选择一个好的编译器

# java - 短信库。Service.getInstance().stopService() 不起作用

> ID：12173301
> 
> 赞同：0
> 
> 时间：2012-08-29T08:00:38.437
> 
> 标签：java, smslib

我使用 SMSlib 库从 USB 3G 调制解调器 ZTE MF180 发送短信。我尝试使用 SendMessage.java 类来测试我的调制解调器，所以我复制了 sms 发送代码 - 所以理论上我期望得到 2 个 sms。

```
OutboundNotification outboundNotification = new OutboundNotification();
    SerialModemGateway gateway = new SerialModemGateway("modem.com1", "COM6", 115200, "ZTE", "MF180");        
    gateway.setInbound(true);
    gateway.setOutbound(true);
    gateway.setSimPin("");
    gateway.setSmscNumber("+79037011111");
    Service.getInstance().setOutboundMessageNotification(outboundNotification);
    Service.getInstance().addGateway(gateway);
    Service.getInstance().startService();
    OutboundMessage msg = new OutboundMessage("79213533296", "Hello world!");
    Service.getInstance().sendMessage(msg);
    Service.getInstance().removeGateway(gateway);
    Service.getInstance().stopService(); 
```

OutboundNotification outboundNotification2 = new OutboundNotification();

```
 SerialModemGateway gateway2 = new SerialModemGateway("modem.com1", "COM6", 115200, "ZTE", "MF180");
    gateway2.setInbound(true);
    gateway2.setOutbound(true);
    gateway2.setSimPin("");
    gateway2.setSmscNumber("+79037011111");
    Service.getInstance().setOutboundMessageNotification(outboundNotification2);
    Service.getInstance().addGateway(gateway2);
    Service.getInstance().startService();
    OutboundMessage msg2 = new OutboundMessage("79213533296", "Оповещение о событии ");
    Service.getInstance().sendMessage(msg2);
    Service.getInstance().stopService(); 
```

我收到第一条短信，然后出现异常：

org.smslib.GatewayException: Comm library exception: java.lang.RuntimeException: gnu.io.PortInUseException: org.smslib 好像 Service.getInstance().stopService() 方法不起作用。但我不知道该怎么办。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:26:55.397

您正在尝试为同一个 COM 端口创建一个新的 SerialModemGateway，这是不可行的 - 只有一个进程/服务可以同时打开一个 COM 端口。

确保在创建另一个之前停止第一个`gateway.stopGateway()`

虽然您不需要每次都设置和拆除 SerialModemGateway 并停止/启动服务，但只需创建一条新消息并使用您打开的现有网关和服务发送它。

# android - 如何为我的自定义导航配置清单文件（任务相关性？）

> ID：12173305
> 
> 赞同：1
> 
> 时间：2012-08-29T08:00:43.363
> 
> 标签：android, navigation, android-manifest, task

我的应用程序中有一个特殊的导航，我想知道如何正确设置它。

活动 H 是我的应用程序的主屏幕。从这个活动中，我们可以启动活动 A、B、C 和 D。从活动 A 我们可以启动 A'，然后启动 A''，从活动 B 我们可以启动 B'，启动 B''，等等。

问题是，从任何活动，我们可以转到活动 H、A、B、C 或 D。但是，当用户启动 A->A'->A''->C，然后返回 A ，他必须被重定向到A''。此外，仍然在这个例子中，如果用户按回 A''，他必须被重定向到 A' 而不是 C。如果他再次按回，他必须被重定向到 A，并且再次返回应该将他重定向到H（主屏幕）活动，而不是 C ！

最后，当用户从 H 按下返回时，并且仅在此时，应用程序（以及所有任务，如果选择的解决方案是创建单独的任务）应该关闭。

其他例子：H -> A -> B -> H -> back -> end of application

我怎样才能做到这一点？我曾想过使用这样的任务：

```
<!-- A-->
<activity
    android:name=".A"
    android:excludeFromRecents="true"
    android:taskAffinity=".A"
    android:label="@string/my_A_label">
</activity>
<activity
    android:name=".A'"
    android:taskAffinity=".A"
    android:label="@string/my_A'_label">
</activity>
<activity
    android:name=".A''"
    android:taskAffinity=".A"
    android:label="@string/my_A''_label">
</activity>

<!-- B-->
<activity
    android:name=".B"
    android:excludeFromRecents="true"
    android:taskAffinity=".B"
    android:label="@string/my_B_label">
</activity>
<activity
    android:name=".B'"
    android:taskAffinity=".B"
    android:label="@string/my_B'_label">
</activity>
<activity
    android:name=".B''"
    android:taskAffinity=".B"
    android:label="@string/my_B''_label">
</activity>

... 
```

如您所见，我为每个主页创建了任务：A、B、C、D。我不知道这是否是一件好事，因为例如，通过任务，用户可以看到所有这些活动用“最后一个任务”选项长按他的主页按钮，我不想有这种行为。为此，活动 A、B、C、D（每个任务的根屏幕）具有属性 android:excludeFromRecents="true"。但是现在，另一个问题：当用户单击他的主页按钮并返回我的应用程序时，他返回主屏幕，而不是最后启动的活动......

此外，我的第二个例子没有得到尊重。

你有解决所有这些问题的想法吗？

PS：请不要告诉我改变我的导航系统:-)

编辑：这里有一个流程图，代表需要的后备箱。这种行为似乎很正常。我的情况有什么不同没有出现在这个图表上。实际上，仅表示后退按钮。每个上下文 - 由不同的颜色表示 - 可以切换到另一个上下文，而不会覆盖此处描述的 back comportment。

![背评](../Images/8cee1eebd0f4d88e9e213814699b9e07.png)

EDIT2：感谢 David Wasser 的建议，我已经实现了两个完全符合我所描述的行为的类，而不使用 android 任务。也感谢 JoxTraex 的帮助 :-) 这是我所做的：我的活动 A、B、C、D 扩展了 RootActivity，除 H 之外的其他活动扩展了 CustomNavigationActivity。

根活动：

```
import android.content.Intent;

public abstract class RootActivity extends CustomNavigationActivity{

@Override
public void onBackPressed(){

    Intent intent = new Intent(this, HomeScreen.class);
    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    startActivity(intent);

}

} 
```

自定义导航活动：

```
import android.content.Intent;

public abstract class CustomNavigationActivity extends Activity{

private int actualRequestCode;
private int menuRequestCode = -1;

@Override
protected void onResume(){

    if (getIntent().hasExtra("childLaunched")){

        Intent intent = new Intent(this, (Class<?>) getIntent().getExtras().get("childLaunched"));
        intent.addFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
        startActivity(intent);

    }

    super.onResume();       

}

@Override
public void startActivity (Intent intent) {

    this.startActivityForResult(intent, 0);

}

@Override
public void startActivityForResult(Intent intent, int requestCode){

    Class<?> targetClass = null;
    this.actualRequestCode = requestCode;

    if (this.actualRequestCode == this.menuRequestCode){
        this.menuRequestCode -= 1;
    }

    try {
        if (intent.getComponent() != null){
            targetClass = Class.forName(intent.getComponent().getClassName());
        }
    }
    catch (ClassNotFoundException e) {
        e.printStackTrace();
    }

    if (targetClass == null){
        super.startActivityForResult(intent, this.actualRequestCode);
    }
    else if (!targetClass.equals(Menu.class)){
        getIntent().putExtra("childLaunched", targetClass);
        super.startActivityForResult(intent, this.actualRequestCode);
    }
    else{
        super.startActivityForResult(intent, this.menuRequestCode);     
    }

}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data){

    if (requestCode == this.actualRequestCode){
        getIntent().removeExtra("childLaunched");
    }

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T12:42:44.090

您绝对**不**希望为此执行不同的任务。如果用户离开应用程序（按 HOME、接听电话等）并想回来，它将完全打乱您的导航。如果每个任务的根目录下的活动都有唯一的图标和/或名称，并且这些任务都可以并行运行，则只能使用单独的任务。只有这样，您才不会混淆用户。看来你不想想要。

看看我对[活动堆栈问题的回答](https://stackoverflow.com/questions/11430993/activities-stack-issue/11435380#11435380)

这不完全是您想要的，但您可能会从这个答案中得到一些想法。如果您在查看此内容后仍有疑问，请添加评论，我可以为您提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:34:23.880

您可以通过 startActivity(new Intent(MainActivity.this, MenuActivity.class)); 提示该活动运行另一个活动；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:05:21.947

不要这样控制。只需使用 Intents 的控制，它就更直接了。通过这种方式，您可以防止那些出现故障的悬空活动。

此外，在标记您的活动时，**请勿**使用 ACTION_MAIN 将它们全部标记

请参阅文档以找出原因。

```
A -> B -> C

A -> B

Intent intent = new Intent((context), MyClassB.class);

B -> C

Intent intent = new Intent((context), MyClassC.class);

C -> A

Intent intent = new Intent((context), MyClassA.class); 
```

但是要正确处理这个问题，**你**必须对你想要的流程有一个很好的了解。流程图可能会使您受益或解释您当前的问题。如果我可以说，您当前的实施/流程是一团糟。我建议使用上述流程图来清理这个想法。

此外，如果您只希望**ONE** Activity 成为您的主根，那么您的 Main Activity 应该具有`ACTION_MAIN`其他不应**的**IntentFilter 。

# java - JFreeChart - Timeseries 和 CandleStick 在同一张图表上

> ID：12173306
> 
> 赞同：7
> 
> 时间：2012-08-29T08:00:53.413
> 
> 标签：java, overlay, jfreechart, candlestick-chart, timeserieschart

我正在尝试在 JFreeChart 中生成一个图表，其中包含一个叠加的烛台图和时间序列图。（有点像这样）

[![烛台趋势叠加](../Images/2d909abc76f439fa5f7c49021b3ffeed.png)](https://i.stack.imgur.com/M8Klh.jpg)
[（来源：[prices-oil.org](http://www.prices-oil.org/wp-content/uploads/2009/04/oil1stapril.jpg)）]

我尝试创建烛台图表，然后添加一个额外的 XY 系列和它的渲染器，但这会导致运行时错误 `org.jfree.data.xy.XYSeriesCollection cannot be cast to org.jfree.data.xy.OHLCDataset`

我的代码片段如下

 `````
private XYPlot plot;
private XYSeriesCollection dataTrend;
private XYItemRenderer renderer;

public OhlcChart(BarCollection bars)
{

JFreeChart jfreechart = ChartFactory.createCandlestickChart("FX Trader Prototype", "Time", "Value", getDataset(bars), true);
plot = (XYPlot)jfreechart.getPlot();
plot.setDomainPannable(true);

NumberAxis numberAxis = (NumberAxis)plot.getRangeAxis();
numberAxis.setAutoRangeIncludesZero(false);
    numberAxis.setAutoRangeStickyZero(false);
numberAxis.setUpperMargin(0.0D);
numberAxis.setLowerMargin(0.0D);

DateAxis dateAxis = (DateAxis) plot.getDomainAxis();
    SimpleDateFormat formatter  = new SimpleDateFormat("dd MMM HH:mm.ss");
    dateAxis.setDateFormatOverride(formatter);

    this.renderer = plot.getRenderer();
    Stroke myStroke = new BasicStroke((float) 1.0);

    this.renderer = new XYLineAndShapeRenderer();
    this.renderer.setSeriesPaint(0, Color.blue);
    this.renderer.setSeriesStroke(0, myStroke);

}

public OhlcChart update(Timeseries<Double> ts)
{
    Stroke myStroke = new BasicStroke((float) 1.0);
    XYLineAndShapeRenderer timeSeriesRenderer = new XYLineAndShapeRenderer();
    timeSeriesRenderer.setBaseShapesVisible(false);
    timeSeriesRenderer.setSeriesPaint(0, Color.blue);
    timeSeriesRenderer.setSeriesStroke(0, myStroke);

    UiTimeseries series = new UiTimeseries(ts);
    dataTrend.addSeries(series);
    plot.setDataset(plot.getDatasetCount()+1, dataTrend);
    plot.setRenderer(plot.getDatasetCount()+1, timeSeriesRenderer);

    return this;
} 
````  `任何建议将不胜感激

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T09:17:52.530

这可以使用 JFreeChart，关键是创建一个额外的数据集和渲染器

您将需要创建一个新`TimeSeriesCollection`的来保存三个附加系列的数据

```
TimeSeriesCollection otherDataSet = new TimeSeriesCollection();
TimeSeries ts1 = new TimeSeries("Series 1");
otherDataSet.addSeries(ts1);
TimeSeries ts2 = new TimeSeries("Series 2");
otherDataSet.addSeries(ts2);
TimeSeries ts3 = new TimeSeries("Series 2");
otherDataSet.addSeries(ts3); 
```

然后`TimeSeries`像往常一样添加数据。

然后，您需要将其添加`otherDataSet`到`Plot`in`OhlcChart`地图中，并将其添加到原始绘图 ( ) 的同一轴上`mapDatasetToRangeAxis`并提供`Renderer`

```
//Add the otherDataSet to the plot and map it to the same axis at the original plot 
int index = 1;
plot.setDataset(index, otherDataSet);
plot.mapDatasetToRangeAxis(index, 0);

XYItemRenderer renderer2 = new XYLineAndShapeRenderer();
plot.setRenderer(1, renderer2);
plot.setDatasetRenderingOrder(DatasetRenderingOrder.FORWARD); 
```

这是一个使用 a`OHLCDataset`而不是 a的示例`BoxAndWhiskerXYDataset`

![在此处输入图像描述](../Images/4e9ed2a59fa4eb77feb7b54a25ad2705.png)``

# c# - 你能给我一个在.NET中导致内存碎片的例子吗

> ID：12173308
> 
> 赞同：5
> 
> 时间：2012-08-29T08:00:58.980
> 
> 标签：c#, .net, memory

我正在努力通过在内存中缓存更多内容来提高我们的应用程序的性能。不过，让我担心的是，我正在阅读有关大型对象堆在垃圾收集期间如何没有真正压缩的所有内容，这可能会导致内存碎片。

我一直在做一些小测试，但似乎我无法引发这个问题。所以这是我的问题：你能给我看一个 C# 中的代码片段，它在某些时候会由于内存碎片而导致失败吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:52:05.880

尝试查看本文[大对象堆的危险中](http://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/)的代码片段，并在 Fill 函数的 catch 块之后执行此代码以分割 LOH，如 cfneese 于 2011 年 11 月 4 日在评论中发布的所述对于 bug[大对象堆碎片导致 OutOfmemoryException](http://connect.microsoft.com/VisualStudio/feedback/details/521147/large-object-heap-fragmentation-causes-outofmemoryexception)：

```
 unsafe
        {
            var w = new StreamWriter(@".\test.txt");
            for (int i = 0; i < count; i++)
            {
                var handle = GCHandle.Alloc(smallBlocks[i], GCHandleType.Pinned);
                w.WriteLine(String.Format("{0,10}\t{1,10}", i, handle.AddrOfPinnedObject()));
                handle.Free();
            }
            w.Close();
        } 
```

# .net - SAP .NET 连接器 3.0 错误：“应用程序标头版本错误的客户端被拒绝”

> ID：12173311
> 
> 赞同：1
> 
> 时间：2012-08-29T08:01:05.987
> 
> 标签：.net, connector, sap-dotnet-connector

我正在升级我们的软件以使用 SAP .NET 连接器 3.0（来自 .NET 连接器 1.0）。所有的函数调用都成功执行，但是，我们会定期收到以下重复 4 次的错误：

> 未处理的异常：SAP.Middleware.Connector.RfcCommunicationException：
> 
> LOCATION CPIC (TCP/IP) 在本地主机上使用 Unicode
> 
> 错误应用程序标头版本错误的客户端被拒绝
> 
> 时间 2012 年 8 月 17 日星期五 09:40:35
> 
> 发布 720
> 
> 带有 Unicode 的组件 CPIC (TCP/IP)
> 
> 版本 3
> 
> 钢筋混凝土 246
> 
> 模块 r3cpic.c
> 
> 线 8554
> 
> DETAIL 客户端版本 6，网关版本 120 (xxx.xx.x.xx/3301)
> 
> 计数器 2

此错误的堆栈跟踪是：

> 在 SAP.Middleware.Connector.CpicConnection.CpicReceive（Int32 超时）

在该错误之后立即抛出另一个错误 4 次：

> 调用 RFC_METADATA_GET 时目标 x 失败 - 请参阅日志了解详细信息

此错误的堆栈跟踪是：

> 在 SAP.Middleware.Connector.RfcRepository.Execute（RfcFunction 函数）

该错误似乎与任何特定的函数调用无关，而是定期发生（目前大约 20-30 分钟）。

我使用的 DLL 版本如下：

> sapnco.dll 3.0.2.0
> 
> sapnco_utils.dll 3.0.2.0

恐怕我还不太了解新的 .NET 连接器，如果有人有任何想法、线索或建议，我将不胜感激。

你的，

大卫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T13:35:44.463

我在使用 .NET 连接器的 3.0.2.0 版本时也遇到了问题（尽管不是同一个问题）。

我相信现在有 3.0.6.0 或更高版本，所以试着抓住它。在 3.0.2.0 版本中有许多已确认的错误，我相信其中一个与连接池有关。这可能会间接导致您的问题。

我打算将您指向[SCN](http://scn.sap.com/community/interoperability/microsoft-net)的方向，但我看到您已经找到它 - 请参阅您对我的问题的最后一个[回复](http://scn.sap.com/message/13490610#13490610)，略低于您的问题，表明上述内容。

# facebook - Facebook Like 按钮 Frontpage 作为 FacebookPage

> ID：12173322
> 
> 赞同：0
> 
> 时间：2012-08-29T08:01:53.357
> 
> 标签：facebook

我们的 Facebook 页面（在 facebook.com 本身上）有很多赞。我们的网站索引页面有另外一个点赞数。

我想在索引页面上创建点赞按钮，显示我们 facebook 页面的点赞数。

这可能吗，我找不到任何关于此的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:07:22.040

喜欢框插件[https://developers.facebook.com/docs/reference/plugins/like-box/](https://developers.facebook.com/docs/reference/plugins/like-box/)可能是你想要的

# mysql - 使用 MYSQL 从结果中获取报告

> ID：12173324
> 
> 赞同：0
> 
> 时间：2012-08-29T08:01:55.063
> 
> 标签：mysql

我想从桌子上休息一周。具有字段 tblweekoff 的表

```
fldid   flddept     fldemployee         fldintime   fldouttime  fldlateafter    fldearlybefore  fldweekoff  fldshiftname    fldassigndate   fldfromdate fldtodate   fldrefid
1       Corporate   00625267-Karthick S 09:30 am    06:15 pm    09:30 am        06:15 pm         Sat,Sun,   COR-General Shift 07-25-2012    07-01-2012  07-31-2012 
```

我想得到这样的报告。

```
fldemployee           flddate       fldweekoff 
00625267-Karthick S   07-25-2012    
00625267-Karthick S   07-27-2012    
00625267-Karthick S   07-28-2012    weekoff
00625267-Karthick S   07-29-2012    weekoff
00625267-Karthick S   07-30-2012    
00625267-Karthick S   07-31-2012    
00625267-Karthick S   08-01-2012    weekoff
00625267-Karthick S   08-02-2012    weekoff
00625267-Karthick S   08-03-2012    
00625267-Karthick S   08-04-2012   
...... 
```

我想从 2012 年 7 月 25 日到 2012 年 8 月 10 日获取报告意味着上面的结果显示是这样的..

请帮我这样做..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:09:07.843

不就是这样吗？

```
SELECT fldemployee, flddate, fldweekoff FROM yourtablename WHERE fldweekoff = `weekoff` AND flddate > `07-25-2012` AND flddate < `08-10-2012`; 
```

此查询中可能有一个小错误，但它应该接近您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:09:53.093

您首先要创建一个日历表。

见[Mysql：选择两个日期之间的所有数据](https://stackoverflow.com/questions/1080207/mysql-select-all-data-between-two-dates)

从那里您可以将日历表中的结果连接到员工。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:11:34.193

我假设您使用 mySql 工作台？

使用这个命令

```
SELECT * FROM `a_database`.`a_table` where `flddate` >= '07-25-2012' and `flddate` <= '08-10-2012' and `fldweekoff` = 'weekoff'; 
```

# class - ABAP：如何为本地异常类发送短信......而不是完全手动？

> ID：12173331
> 
> 赞同：1
> 
> 时间：2012-08-29T08:02:49.027
> 
> 标签：class, exception, local, abap

我想引发一个本地类型的异常，并在构造函数中传递一个 *text。

这个 *text 是我想通过调用 get_longtext 方法返回的，稍后，当我捕获异常时。

当然，我可以为我的类添加一个属性，然后重新定义方法。然而，在我看来，应该有一种更简单的方法（就像在类似 java 的语言中，你只是“拥有”它）。

异常的继承构造函数中有 TEXTID 参数。然而，这指向定义为类属性的“文本”......但这是针对全局类的。

那么有什么方法可以让我以一种优雅的方式利用已经存在的构造函数吗？还是我必须手动完成所有操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T08:26:04.823

如果您不想使用全局类（如推荐的那样），您可以尝试`IF_T100_MESSAGE`在本地类中实现接口。首先通过 维护任何消息类中的错误消息`SE91`，然后在类型的本地异常类中定义文本 ID `SCX_T100KEY`。实现异常类方法以在消息文本中使用占位符的附加属性（如有必要）。

检查`IF_T100_MESSAGE`和`CL_MESSAGE_HELPER`了解详情。要获取示例代码，请创建一个全局异常类并添加接口`IF_T100_MESSAGE`并检查方法是如何实现的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-13T09:44:06.003

可以定义自己的本地异常类，该类将具有`IF_T100_MESSAGE`接口的所有优点。

如果您对示例代码感兴趣，请参阅我的博客文章（代码很长，放在这里）[http://oprsteny.com/?p=1346](http://oprsteny.com/?p=1346)

# php - 如何在codeigniter中显示消息？

> ID：12173343
> 
> 赞同：3
> 
> 时间：2012-08-29T08:03:23.083
> 
> 标签：php, codeigniter, message

我想在重定向链接上显示内容更新的成功消息。这是我的控制器代码：-

```
public function add_content()
        {
        $this->load->helper('url');
    $id=$this->input->post('id');
        $content=$this->input->post('content');
        $title=$this->input->post('title');
        $this->load->model('admin/contentmodel');
    $status=$this->contentmodel->addcontent($id,$title,$content);
        if($status==1)
           {
            $this->session->set_flashdata("message","<font class='success'>Content Successfully Updated..!!</font>");
            redirect('admin/login/dash');
            }
        else
          {
           $this->session->set_flashdata("message","<font class='success'>Content Not Updated..!!</font>");
           redirect('admin/content/home');
          }
        } 
```

我的内容已成功更新，现在我想在特定的重定向链接上向用户显示消息。为此，我在上面的代码中设置了消息：

```
$this->session->set_flashdata("message","<font class='success'>Content Successfully Updated..!!</font>"); 
```

那么你们能否让我知道我哪里出错了，我如何在视图上显示错误消息？而我的重定向转到控制器->而不是视图。所以我如何从控制器->查看我的错误消息。提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T08:06:26.353

打开`application/config/config.php`并编辑该行：

```
$config['encryption_key'] = ''; 
```

通过向字符串添加一些随机值

```
$config['encryption_key'] = 'q0231sz!!1@asd'; 
```

之后，当您设置消息时

```
$this->session->set_flashdata('key', 'value'); 
```

在您的视图文件中简单地回显

```
echo $this->session->flashdata('key'); 
```

请注意，这**不会**在此负载上回显您`'value'`，但会在您刷新页面后回显

```
$this->session->set_flashdata('mykey', 'testing');
echo $this->session->flashdata('mykey'); // will echo '' (nothing) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-29T07:43:24.470

您可以将控制器设置为，

```
$this->data['errormsg'] = "message"; 
```

然后将视图设置为

```
 echo isset($errormsg)?$errormsg:"" ; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T08:07:36.533

您的问题中指出了您的错误的解决方案：

> 为了使用 Session 类，您需要在配置文件中设置加密密钥。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:13:01.767

```
/* Do this in controller */

//This should have message you needed. Try logging in file for testing
$message = $this->session->flashdata("message");

$data["message"] = $message;

$this->load->view("yourview",$data);

/* Do this in your view */

echo $message; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-27T17:03:13.927

将以下代码添加到您的控制器/模型中：-

```
if($status==1)
{
     $data=array(
         'class' => 'success',
         'message' => 'Content Successfully Updated..!!'
     );
     $this->session->set_flashdata("dash",$data);
     redirect('admin/login/dash');
}
else
{
     $data=array(
         'class' => 'danger',
         'message' => 'Content Not Updated..!!'
     );
     $this->session->set_flashdata("dash",$data);
     redirect('admin/content/home');
} 
```

将以下代码添加到您的视图中：-

```
if($this->session->has_userdata('dash'))
{
   echo '<div class="alert alert-'.$this->session->dash['class'].'">'.$this->session->dash['message'].'</div>';
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-27T11:18:54.380

```
**Set flash data in controller**

message - flash data session name. 

$this->session->set_flashdata('message', 'Sucessfully updated.');

Read flash data(Pass in view with bootstrap alert)

 <?php if($this->session->flashdata('message')){?>
   <div class="alert alert-success">      
    <?php echo $this->session->flashdata('message')?>
 </div>
 <?php } ?> 
```

# ios - 在 iOS 中检查蓝牙状态

> ID：12173344
> 
> 赞同：1
> 
> 时间：2012-08-29T08:03:24.117
> 
> 标签：ios, bluetooth, ios6, iphone-privateapi

我有一个应用程序（我不会将此应用程序提交到苹果应用商店），我想使用它来检查蓝牙是否打开。如果它已打开，那么我必须显示警报。

```
 - (void)centralManagerDidUpdateState:(CBCentralManager *)central{
  switch (central.state) {
    case CBCentralManagerStatePoweredOn:{
      //alert view
      break;
    }
  } 
```

在`viewdidload`我确实喜欢这个

```
 CBCentralManager * manager = [[CBCentralManager alloc] initWithDelegate:self queue:nil]; 
```

但这不适用于带有 ios 5.1 的 ipad2。

> 问题`central.state`总是空的。

我希望从 ios 3.0 到 ios 6 beta 的情况相同。是否有任何用于检查蓝牙状态的通用代码。

欢迎任何可能的代码，甚至是带有私有 api 的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:10:52.880

`CBCentralManager`用于使用蓝牙智能（蓝牙 4.0 中的低功耗部分）。这是一项最近才在 iOS / OS X 设备中引入的新技术。当前支持在 iPhone 4s 和新 iPad 中。iPad 2 不支持该技术。此外，`CBCentralManager`仅适用于 iOS 5 及更高版本。

如果你想检查传统的蓝牙状态，你将不得不找到另一种方法来做到这一点。

在您的情况下`central.state`，实际上应该等于`CBCentralManagerStateUnsupported`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-22T08:23:55.390

您想查看`BluetoothManager`API。**BluetoothManager.framework**是此 API 所在的私有*框架*。您可以从 Xcode 项目中链接到它，或使用`dlopen`它来动态打开它 ( `"/System/Library/PrivateFrameworks/BluetoothManager.framework/BluetoothManager"`)。

重要的电话是

```
- (BOOL)powered;
- (BOOL)enabled;
- (BOOL)setPowered:(BOOL)arg1;
- (BOOL)setEnabled:(BOOL)arg1; 
```

要获取 的实例`BluetoothManager`，请使用以下命令：

```
BluetoothManager* mgr = [BluetoothManager sharedInstance]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-02T15:28:19.110

我也没有在运行 iOS7 的 iPhone 4 上获得 CBCentralManagerStateUnsupported。我向 Apple 开了一张 bug 票。

[http://openradar.appspot.com/15564675](http://openradar.appspot.com/15564675)是雷达

和[https://github.com/deadfalkon/btLeState](https://github.com/deadfalkon/btLeState)存储库

# javascript - JavaScript 的属性访问表达式

> ID：12173347
> 
> 赞同：0
> 
> 时间：2012-08-29T08:03:43.117
> 
> 标签：javascript, arrays, object, properties, expression

我正在阅读 JavaScript 权威指南，并且有代码：

```
var o = {x:1,y:{z:3}}; // An example object
var a = [o,4,[5,6]]; // An example array that contains the object
o.x // => 1: property x of expression o
o.y.z // => 3: property z of expression o.y
o["x"] // => 1: property x of object o
a[1] // => 4: element at index 1 of expression a
a[2]["1"] // => 6: element at index 1 of expression a[2]
a[0].x // => 1: property x of expression a[0] 
```

除了最后一行之外，这一切对我来说都没有问题。a[0].x 如何计算为 1？不存在属于多维数组“a”的属性 x。我不明白这一点。是否在“o”中找到属性 a[0].x？这让我很困惑......

提前感谢您的任何评论或答案...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:05:56.010

第一行定义`o`，第二行定义`a[0]`为`o`，所以我们有...

```
a[0] === {x:1,y:{z:3}}; 
```

所以：

```
a[0].x === 1; 
```

这也意味着以下情况为真：

```
a[0].y.z === 3; 
```

所以你说`a[0].x`在`o`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:07:09.620

`a[0]`等于 object`o`并且您了解第 3 行，问题出在哪里？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T08:20:34.167

'a' 是一个数组，因此 'a' 可以存储多个值，并且每个值都存储在唯一的位置。要从数组中获取值，您必须知道它的存储位置（在什么地方）。要了解您的示例，您有一个名为 a 的数组：

var a = [o,4,[5,6]];

向数组添加值时，默认情况下，它们存储在从 0 开始的位置。因此，在数组 a 的 0 位置有一个对象 o（在此语句之前定义了一行），在位置 1 有一个值 4，然后在位置 2 有另一个数组 [5, 6]。

要从数组中获取值，您需要知道它的位置，因此要从数组 a 中获取对象 o，您只需编写：

一个[0]

所以这与使用对象 o 相同（因为 o 在此数组中的位置为 0）。

对象具有属性。要从对象获取属性，您必须使用 . （点）运算符（还有其他方法）。所以要从对象 o 中获取属性 x，你需要这样写：

牛

总结一下，写 a[0].x 你只是说给我牛，这是一回事。

# vba - VBA检查不同列中的范围

> ID：12173349
> 
> 赞同：1
> 
> 时间：2012-08-29T08:03:45.063
> 
> 标签：vba, loops, excel

我有 xls 文件，其中包含多张工作表和多列数据（以 6 列为一组）。我必须将这些数据复制到最后一张，每张都在最后一张下。

换句话说，它现在看起来像这样：

A B C D

A B C D

A B C D

我希望它在最后一张表中看起来像这样：

一个

一个

一个

b

b

b

C

C

C

d

d

d

我设法创建了从每张表中复制前 6 列的宏，但我无法创建一个循环来遍历每张表中的列：

```
Sub kopiuj_wszystko()

Dim kolumna As Integer
For Each oWBK In ThisWorkbook.Worksheets
For j = 1 To 1000
If oWBK.Name <> "podsumowanie" Then
' Kopiuj

oWBK.Select

x = Range(j & "1000").End(xlUp).Row 'sprawdź ilość wypełnionych wierszy
y = 6 'ogranicz do kolumny F
oWBK.Cells(x, y).Select
Z = ActiveCell.Address
Range("A9", Z).Select
'Application.CutCopyMode = False
Selection.Copy

'Wklej
Sheets("podsumowanie").Select
E = Range("c10000").End(xlUp).Row
R = 3
Sheets("podsumowanie").Cells(E, R).Select

ActiveSheet.Paste

'Kopiuj kategorię
oWBK.Select
T = Range("A1").Value
Application.CutCopyMode = False
Selection.Copy

'Wklej kategorię
w = 1
Sheets("podsumowanie").Select
Sheets("podsumowanie").Cells(E, w).Select
L = ActiveCell.Address
Range(L).Value = T

'Kopiuj index
oWBK.Select
T = Range("C3").Value
Application.CutCopyMode = False
Selection.Copy

'Wklej index
w = 2
Sheets("podsumowanie").Select
Sheets("podsumowanie").Cells(E, w).Select
L = ActiveCell.Address
Range(L).Value = T

End If
Next j

Next oWBK

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:36:10.423

这里的代码非常简单，无论有多少列都可以工作：（循环通过每个单元格（数据量大时速度慢）

```
Sub ColumnsToOne()

Dim wsT As Worksheet: Set wsT = ThisWorkbook.Sheets("Sheet2")
Dim x As Long
Dim y As Long
Dim z As Long

z = 1
For Each wsF In ThisWorkbook.Sheets
x = 1
y = 1
If wsF.Name <> wsT.Name Then
    Do While Len(wsF.Cells(x, y)) <> 0
        Do While Len(wsF.Cells(x, y)) <> 0
            wsF.Cells(x, y).Copy wsT.Cells(z, 1): z = z + 1: x = x + 1
        Loop
        x = 1: y = y + 1
    Loop
End If
Next

End Sub 
```

下面的代码复制每个范围并将其添加到工作表中：（使用大数据集更快）

```
Sub CopyColumnsToOne()
Dim wsT As Worksheet: Set wsT = ThisWorkbook.Sheets("Sheet2")
Dim y As Long
For Each wsF In ThisWorkbook.Sheets
    If wsF.Name <> wsT.Name Then
        For y = 1 To 6
            wsF.Range(wsF.Cells(1, y), wsF.Cells(wsF.Cells(wsF.Rows.Count, y).End(xlUp).Row, y)).Copy wsT.Cells(wsT.Range("A65536").End(xlUp).Row + 1, 1)
        Next
    End If
Next
End Sub 
```

# python - 稍微烦躁的数据是相等的

> ID：12173350
> 
> 赞同：2
> 
> 时间：2012-08-29T08:03:47.903
> 
> 标签：python

我正在逐行阅读 csv。CSV 如下所示：

```
29.781646
29.781646
42.698079
43.346914
44.369203
45.006459
45.006459
39.316758 
```

当两个数字完全相同时，我想稍微改变一个。

例如，有两个值是`29.781646`，我想将一个更改为`29.781645`

如果 csv 包含：

```
29.781646
29.781646
29.781646 
```

然后我想将其更改为：

```
29.781646
29.781645
29.781644 
```

我非常感谢您的指导，以有效地实施这一点。

请注意，我想以倍数执行此操作`0.000001`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T08:09:08.653

您可以逐行遍历文件，并使用 a 跟踪看到[`set`](http://docs.python.org/library/stdtypes.html#set)的值，如果它已经在[`set`](http://docs.python.org/library/stdtypes.html#set).

粗略的例子：

```
seen = set()
with open('test.csv') as input, open('test_out.csv', 'w') as output:
    for line in input:
        value = float(line)
        while value in seen:
            value -= 0.000001
        seen.add(value)
        output.write(str(value) + '\n') 
```

这是有效的，因为 a`set`提供 O(1) 查找

* * *

如果您要将值写回同一个文件，则可以使用 fileinput 模块：

```
import fileinput

seen = set()
for line in fileinput.FileInput('test.csv', inplace=True):
    value = float(line)
    while value in seen:
        value -= 0.000001
    seen.add(value)
    print str(value).strip() 
```

**编辑**

为了解决 eumiro 关于浮点问题的评论：

您可以使用[`decimal`](http://docs.python.org/library/decimal.html)模块`Decimal`或只是将值与/除相乘/除以使用`1000000`，`int`而不是使用`float`. 正如我所写，这只是一个粗略的例子:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:15:52.723

```
>>> s = """29.781646
29.781646
42.698079
43.346914
44.369203
45.006459
45.006459
39.316758
"""
>>> d = {}
>>> for nb in [float(l) for l in s.split('\n') if l]:
    # Create a dict of repetitions, to decrease by the number of times already seen
    if nb not in d:
        d[nb] = 0
        print nb
    else:
        rep = d[nb]
        d[nb] = rep + 1
        print nb - d[nb] * 0.000001

29.781646
29.781645
42.698079
43.346914
44.369203
45.006459
45.006458
39.316758
>>> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T08:25:58.180

基于 BigYellowCactus 但解决了 eumiro 关于错误如何在多次修改的浮点数中累积的评论：

```
seen = set() with open('test.csv') as input, open('test_out.csv', 'w') as output:
    for line in input:
        value = float(line)
        modifier = 1

        while True
            new_value = value - (modifier * 0.000001)
            modifier += 1
            if not new_value in seen:
                break

        seen.add(new_value)
        output.write(str(value) + '\n') 
```

# python - Python：scipy.spsolve 崩溃而没有错误

> ID：12173353
> 
> 赞同：0
> 
> 时间：2012-08-29T08:03:55.343
> 
> 标签：python, opencv, matrix, numpy, scipy

我对矩阵不是很好，而且在大多数情况下我不知道自己在做什么，因为我正在尝试修复别人的代码。

有问题的代码是`new_vals = scipy.sparse.linalg.spsolve(A,b)`其中 A 是具有以下维度的稀疏矩阵：(1146880, 1146880)，并且`b`是 (1146880, 1)。当 python 崩溃时，没有错误，我很确定它没有内存不足。一些搜索表明它是堆栈溢出的一种形式，因此我尝试使用 bicg 制定不同的解决方案，但`new_vals,check = scipy.sparse.linalg.bicg(A,b)`似乎并不总是有效。

他们有什么方法可以让 spsolve 工作吗？还是有其他方法可以做到这一点？

**编辑：**我之前说过两个矩阵的大小相同，但是`b`是 (1146880, 1)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T14:03:13.523

1）“似乎并不总是有效”是什么意思？`bicg`失败了吗`info!=0`？这不足为奇，而且它可能发生，因为它`A`是不可逆的。输入，特别是 matrix`A`是否有可能是错误的？

2）`spsolve`在相同的情况下会失败`bicg`吗？

编辑：在回复评论时，我不相信 spsolve。这是一个失败的例子：

```
import scipy.sparse
import scipy.sparse.linalg

A=scipy.sparse.csc_matrix(linspace(1,15,16).reshape((4,4)))
b=ones((4))
res_spsolve=scipy.sparse.linalg.spsolve(A,b)
res_bicg,info=scipy.sparse.linalg.bicg(A,b)

b_bicg = A*res_bicg
b_spsolve = A*res_spsolve 
```

你会看到 b_spsolve 是错误的

# c# - 替换xml文档中的字符串

> ID：12173356
> 
> 赞同：0
> 
> 时间：2012-08-29T08:03:59.713
> 
> 标签：c#, xml, xpath

如何为以下内容编写 xpath 表达式：

```
 <script src="../../Scripts/ex.js"></script> 
```

这将匹配 src 值 ( `../../Scripts/ex.js`)。因为我想`../../Scripts`用其他字符串替换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:19:37.390

您可以使用以下代码。

```
 TextReader tr = new StringReader(response);
    XElement xelement = XElement.Load(tr);
    var Script = xelement.Descendants("script").ToList();
    if (Script.Count() > 0)
    {
     Script.First().Attribute("src").Value = "../../Scripts/NewEXWithReplace.js";

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:18:59.767

您还可以使用 HtmlAgilityPack，它允许您访问有用的属性[codeplex 工具](http://htmlagilitypack.codeplex.com/)。

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(@"<script src="../../Scripts/ex.js"></script>" />");

foreach (var script in doc.DocumentNode.Descendants("script"))
{

    script.Attributes["src"].Value = "loading.gif";
} 
```

另一种方法是使用 linq to xml

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T08:20:15.517

LINQ 转 XML

```
var xdocument = XDocument.Load("XMLFile1.xml"); // you can use Parse or whatever
var elements = xdocument.XPathSelectElements("//script[@src='../../Scripts/ex.js']");
foreach (var element in elements)
{
  element.Attribute("src").SetValue("foo");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:12:05.030

我知道你说过你想要一个 XPath 表达式，但是一个简单的字符串替换呢？

例如

```
string s = "<script src=\"../../Scripts/ex.js\"></script>";
string newS = s.Replace("../../Scripts", "../../Scripts2"); // Or whatever you want to replace it with 
```

# hive - 在 Hive 上将最大映射器数设置为 1

> ID：12173373
> 
> 赞同：0
> 
> 时间：2012-08-29T08:05:36.707
> 
> 标签：hive, mappers

我需要做一些从字符串到整数 id 的映射，我正在考虑做一个 UDF 函数并将这个字符串传递给它。为此，我需要一个映射器。

如何将映射器阻止为 1？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T20:06:41.127

我了解您要做什么，但是您的基于 UDF 的方法无法很好地扩展，因为该字符串到 id 表必须驻留在内存中。通过使用 map-reduce 作业将字符串从 mapper 传递到单个 reducer，您可能会更轻松。reducer 实例只保留一个递增计数器，用于将传入 reduce 方法的所有字符串（所有相同的字符串）与计数器的下一个整数值相关联。

也许其他人知道如何将输入格式限制为产生简单的拆分（以获得单个映射器）。

# java - 使用 DynamicJasper API 创建图表

> ID：12173377
> 
> 赞同：1
> 
> 时间：2012-08-29T08:06:09.617
> 
> 标签：java, jasper-reports, dynamic-jasper

我正在尝试使用*JasperReports*和*DynamicJasper API*创建图表，查看[Bar3DChartBuilderTest](http://dynamicjasper.com/docs/current/xref-test/ar/com/fdvs/dj/test/domain/chart/builder/Bar3DChartBuilderTest.html)站点。

但是我的代码抛出异常：

```
java.lang.ClassNotFoundException: Integer.class.getName()
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
java.lang.Class.forName0(Native Method)
java.lang.Class.forName(Unknown Source)
ar.com.fdvs.dj.core.layout.AbstractLayoutManager.registerChartVariable(AbstractLayoutManager.java:1181)
ar.com.fdvs.dj.core.layout.AbstractLayoutManager.createChart(AbstractLayoutManager.java:1143)
ar.com.fdvs.dj.core.layout.AbstractLayoutManager.layoutCharts(AbstractLayoutManager.java:917)
ar.com.fdvs.dj.core.layout.AbstractLayoutManager.endLayout(AbstractLayoutManager.java:159)
ar.com.fdvs.dj.core.layout.ClassicLayoutManager.endLayout(ClassicLayoutManager.java:160)
ar.com.fdvs.dj.core.layout.AbstractLayoutManager.applyLayout(AbstractLayoutManager.java:106)
ar.com.fdvs.dj.core.DynamicJasperHelper.generateJasperReport(DynamicJasperHelper.java:555)
ar.com.fdvs.dj.core.DynamicJasperHelper.generateJasperReport(DynamicJasperHelper.java:533)
com.ay.ireport.DynamicJasperTemplate.buildReport(DynamicJasperTemplate.java:62)
org.apache.jsp.checkboxes_jsp._jspService(checkboxes_jsp.java:124)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

请帮我解决这个问题。

我尝试根据用户选择动态创建图表。

```
public void buildReport(String a[]) throws Exception{
    int i=0;
    List<Object> dt=getDataType(a,tname);
    for(int k= 0;k<dt.size();k++)
        System.out.println(dt.get(k));
    String query = createQuery(a,this.tname);
    //Create report layout
    DynamicReport dr = buildReportLayout(a,dt);

    JRDataSource ds = getDataSource(a, query);
    //Exception line
    JasperReport jr = DynamicJasperHelper.generateJasperReport(dr, new ClassicLayoutManager(), null);
    JasperPrint jp = JasperFillManager.fillReport(jr, null, ds);

    //JasperDesignViewer.viewReportDesign(DynamicJasperHelper.generateJasperReport(dr, new ClassicLayoutManager(),null));

    JasperExportManager.exportReportToPdfFile(jp,"C:/report-out.pdf");

}

private DynamicReport buildReportLayout(String[] a,List dtt) {
    DynamicReportBuilder  drb = new DynamicReportBuilder ();

    Font font = new Font(10,"Serif",true);
    Style headerStyle = new Style();
    headerStyle.setFont(font);
    headerStyle.setHorizontalAlign(HorizontalAlign.LEFT);
    headerStyle.setVerticalAlign(VerticalAlign.MIDDLE);

    font = new Font(8,"Serif",false);
    Style detailStyle = new Style();
    detailStyle.setFont(font);
    detailStyle.setHorizontalAlign(HorizontalAlign.LEFT);
    detailStyle.setVerticalAlign(VerticalAlign.MIDDLE);

    Object obj="NUMBER";
    Object obj1="VARCHAR2";
    String type = null;
    for(i=0; i<a.length; i++) {

        if(dtt.get(i).equals(obj)){
            type="Integer.class.getName()";
        }
        else if(dtt.get(i).equals(obj1)){
            type="String.class.getName()";
        }

        AbstractColumn col = ColumnBuilder.getNew()
                .setColumnProperty(a[i],type)
                .setTitle(a[i]).setWidth(200)
                .setStyle(detailStyle)
                .setHeaderStyle(headerStyle)
                .build();
                drb.addColumn(col); 
    }       
    drb.setUseFullPageWidth(true);

    DJAxisFormat categoryAxisFormat = new DJAxisFormat("category");
            categoryAxisFormat.setLabelFont(Font.ARIAL_SMALL);
            categoryAxisFormat.setLabelColor(Color.DARK_GRAY);
            categoryAxisFormat.setTickLabelFont(Font.ARIAL_SMALL);
            categoryAxisFormat.setTickLabelColor(Color.DARK_GRAY);
            categoryAxisFormat.setTickLabelMask("");
            categoryAxisFormat.setLineColor(Color.DARK_GRAY);

            DJAxisFormat valueAxisFormat = new DJAxisFormat("value");
            valueAxisFormat.setLabelFont(Font.ARIAL_SMALL);
            valueAxisFormat.setLabelColor(Color.DARK_GRAY);
            valueAxisFormat.setTickLabelFont(Font.ARIAL_SMALL);
            valueAxisFormat.setTickLabelColor(Color.DARK_GRAY);
            valueAxisFormat.setTickLabelMask("#,##0.0");
            valueAxisFormat.setLineColor(Color.DARK_GRAY);

            DJChart djChart = new DJBar3DChartBuilder()
                //chart     
                .setX(20)
                .setY(10)
                .setWidth(500)
                .setHeight(250)
                .setCentered(false)
                .setBackColor(Color.LIGHT_GRAY)
                .setShowLegend(true)
                .setPosition(DJChartOptions.POSITION_FOOTER)
                .setTitle("Bosum")
                .setTitleColor(Color.DARK_GRAY)
                .setTitleFont(Font.ARIAL_BIG_BOLD)
                .setSubtitle("subtitle")
                .setSubtitleColor(Color.DARK_GRAY)
                .setSubtitleFont(Font.COURIER_NEW_BIG_BOLD)
                .setLegendColor(Color.DARK_GRAY)
                .setLegendFont(Font.COURIER_NEW_MEDIUM_BOLD)
                .setLegendBackgroundColor(Color.WHITE)
                .setLegendPosition(DJChartOptions.EDGE_BOTTOM)
                .setTitlePosition(DJChartOptions.EDGE_TOP)
                .setLineStyle(DJChartOptions.LINE_STYLE_DOTTED)
                .setLineWidth(1)
                .setLineColor(Color.DARK_GRAY)
                .setPadding(5)
                //dataset
                .setOrientation(PlotOrientation.VERTICAL)
                .setCategory((PropertyColumn)drb.getColumn(2))
                .addSerie(drb.getColumn(0))
                //plot
                .setXOffset(10)
                .setyOffset(10)
                .setShowLabels(false)
                .setCategoryAxisFormat(categoryAxisFormat)
                .setValueAxisFormat(valueAxisFormat)
                .build();
            drb.addChart(djChart);

            System.out.println("vvvvvvvvvvvvvvvvv0");
            DynamicReport dr = drb.build();
    return dr;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:25:25.610

> DJchart.getColumn().getValueClassNameForExpression()

以 NULL 值传递。你需要检查你的 DJReport。它在内部创建 DJChart。

# php - 带参数的 PHP Windows Bat 文件

> ID：12173378
> 
> 赞同：0
> 
> 时间：2012-08-29T08:06:16.620
> 
> 标签：php, windows, batch-file, filepath

我们目前必须将大约 200 名学生导入我们的活动目录。我们有一个 BAT 文件，它在服务器上创建用户和文件夹。

我编写了一个脚本，它扫描我们的 MSSQL 数据库中的新学生，将它们保存到一个数组中，然后使用 system() 调用 cmd.exe 并运行 BAT 文件来创建学生。

BAT 文件位于我的 Y 驱动器上（位于另一台服务器上）。我们目前还使用 DFS 路径，因此我也可以通过这种方式访问​​ bat 文件。

值得注意的是：1）BAT文件的两个路径中都有空格2）我还需要将参数传递给BAT文件

目前，这是我在 PHP 中的 system() 参数的状态：

```
$bat = escapeshellcmd("cmd /c Y:\SharedRes\Path To Createstudent\createstudent.bat {$stuArray['forename']} {$stuArray['surname']} {$stuArray['username']} {$stuArray['year']} {$stuArray['sf']}");
system($bat); 
```

并使用 DFS 路径：

```
$bat = escapeshellcmd("cmd /c '\\organisation.local\Path To Createstudent\createstudent.bat {$stuArray['forename']} {$stuArray['surname']} {$stuArray['username']} {$stuArray['year']} {$stuArray['sf']}'");
system($bat); 
```

每次我尝试运行它时，都会收到以下错误：

```
The filename, directory name, or volume label syntax is incorrect 
```

任何想法如何让 PHP 实际运行 BAT 文件？我目前很难过。

非常感谢

菲尔

PS我正在通过命令行运行PHP脚本：

```
php.exe -f "C:\import.php" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:09:53.673

如果批处理文件位于带有空格的路径中，则需要引用参数：

```
cmd /c "Y:\SharedRes\Path To Createstudent\createstudent.cmd" ... 
```

此外，如果参数包含空格，您也需要引用它们。单引号不能识别`cmd`，必须是双引号。

# c# - 如何“附加”有效数字以从浮点值加倍

> ID：12173381
> 
> 赞同：0
> 
> 时间：2012-08-29T08:06:26.677
> 
> 标签：c#, double, rounding, floating-point-precision

目前我正在尝试匹配 C# 和 C++ 应用程序。在 C++ 方面，当有一个值时，说：

```
const char* svalue = "554.1327"; 
```

当我使用`sscanf`：

```
float x;
sscanf(svalue, "%f", &x); 
```

`x`将等于`554.13269`，即它具有“附加”有效数字，即使它们可能四舍五入到相同的值。（我认为这个应用程序使用了一种不同的`float`类型，它可以容纳超过 7 个有效数字。）

我不想改变 C++ 方面。我希望我单独的 C# 应用程序也能这样做。

例如，如果我有 float `23423.29`，我想将其转换为`23423.289`，这是 a `double`（因为在 C# 中，标准`float`的有效数字不超过 7 个），然后将其`double`转换为字符串。

我似乎找不到一种方法来做到这一点。有任何想法吗？还是我必须创建自己的函数或从 C# 端调用相同的 C++ 函数……？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:59:41.800

Hi there is a temprary solution for your problem like

```
 Double d = 23423.29f;
        int a = 23423.29.ToString().Length;
        Console.WriteLine(d.ToString().Remove(++a)); 
```

which gives result

```
23423.289 
```

# java - android 处理程序 .postdelay() 每次时钟的分钟变化？

> ID：12173383
> 
> 赞同：4
> 
> 时间：2012-08-29T08:06:59.357
> 
> 标签：java, android, handler

我想推迟发布，直到时钟的分钟变化。目前我正在使用这个

```
handler.postDelayed(drawRunner, 60000); 
```

但是这个延迟是从现在开始的 60 秒。我想要做的是将帖子延迟到时钟上的分钟变化。

**例如：**假设我手机上的时间`4:15:29`比我想延迟到时间`4:16:00`然后下一个是`4:17:00`等等。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T09:09:40.737

您可以通过以下方式访问当前时间：

```
long time = System.currentTimeMillis(); 
```

之后，您可以通过以下方式获得它的第二部分：

```
int seconds = new Date(time).getSeconds(); 
```

然后你可以从 60 中减去它，得到睡眠时间。

```
int sleepSecs = 60 - seconds; 
```

然后将其设置为睡眠时间`handler.postDelayed()`

```
handler.postDelayed(drawRunner, sleepSecs*1000); 
```

第一次使用后，您可以使用恒定的 60000 毫秒睡眠时间。

**请注意，getSeconds() 可以返回 60 或 61 作为第二个值！[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Date.html#getSeconds%28%29)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:10:23.787

是的，您可以使用[此](https://stackoverflow.com/questions/3617453/best-way-to-) Timer 类来安排定期任务，这样您就可以根据需要在任何时间段内更改时钟时间。

# iphone - 想在圆圈中显示图像是可能的以及如何

> ID：12173386
> 
> 赞同：0
> 
> 时间：2012-08-29T08:07:11.490
> 
> 标签：iphone, objective-c, ios, uiimageview

嗨，我想在圆圈中而不是在矩形中显示图像，所有这些都将显示在表格视图中 ![在 tableview 单元格中显示类似的图像](../Images/01b1cc20e6fcf835fa24a31b3fb6b657.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T08:10:27.977

您必须在`#import <QuartzCore/QuartzCore.h>`imageView 中添加一个cornerRadius， `[yourImageView.layer setCornerRadius:yourImageView.frame.size.width/2]`也许您必须添加`[yourImageView setClipsToBounds:YES]`，但我不确定这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:18:50.103

一种方法是创建 NSView 的子类。

然后在你覆盖 drawrect: 方法来做你的自定义绘图。您首先在定义的框架中绘制图像。之后，您可以在同一帧中绘制一个中间有一个透明圆圈的矩形图像，或者使用 NSBezierPath 构造一个类似的矩形。

这个矩形的颜色，除了中间的透明圆圈外，与封闭视图的背景颜色相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:21:47.397

或者你可以使用`-drawRect`方法：

```
- (void)drawRect:(CGRect)rect
{
    CGRect aRectangle = CGRectMake(0.0f, 0.0f, 40.0f, 40.0f); //size of image frame
    UIBezierPath *path = [UIBezierPath bezierPathWithOvalInRect:aRectangle];
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);
    UIColor *imageColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"yourImage.png"]];
    [imageColor setFill];
    [path fill];
} 
```

首先，您需要创建自己的继承自 UIView 的类（例如）并将此代码放入您的`drawRect`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:23:23.847

将图像创建为 PNG 并添加透明层。选择圆圈周围的区域并使其透明。然后在 UIImageView 中加载图像时，它会显示为一个圆圈。

例如：

![具有两行和圆形图像的表格视图](../Images/d90d6afc84c7884fc5aa6fcc69dae958.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T09:30:23.263

另一种方法是使用[CICircularWrap](https://developer.apple.com/library/mac/#DOCUMENTATION/GraphicsImaging/Reference/CoreImageFilterReference/Reference/reference.html#//apple_ref/doc/filter/ci/CICircularWrap)。它将图像包裹在一个透明的圆圈周围。

例如像这样：

![在此处输入图像描述](../Images/a80d4b0214546fce82edc9ce4abe6796.png)

然后你可以使用**UIImageView 的图层 setCornerRadius**来完善圆形图像

# ios - 怎么知道 ASIFormDataRequest 完成了？

> ID：12173387
> 
> 赞同：0
> 
> 时间：2012-08-29T08:07:18.243
> 
> 标签：ios, asihttprequest

我正在为 ios 使用 ASIFormDataRequest，我想使用 POST 方法将数据发送到服务器，以便响应它，服务器将向我发送 Json 文件。我使用 NSURLConnection 使用 GET 方法进行请求，但现在必须使用 POST，并且不知道，所以正在学习使用 ASIFormDataRequest，但失败了。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:21:33.567

ASIFormDataRequest 有一个方法叫做

```
- (void) requestFinished : (AsiFormDataRequest*) request {
    NSString *myResponse = [request responseString]; // or do something else.
} 
```

此外，您可以设置自己的方法以在完成时调用；

```
ASIFormDataRequest *request = [ASIFormDataRequest requestWithUrl:yourUrl];
[request setDidFinishSelector:@selector(yourMethod:)];
[request setDelegate:self];
[request startAsynchronous]; 
```

话虽如此，更有用的是，您在搜索“asiformdatarequest”时获得的第一个 googlehit 显示[http://allseeing-i.com/ASIHTTPRequest/How-to-use](http://allseeing-i.com/ASIHTTPRequest/How-to-use)

# java - java web应用程序无法访问linux文件系统

> ID：12173391
> 
> 赞同：0
> 
> 时间：2012-08-29T08:07:30.777
> 
> 标签：java, linux, filesystems

尝试从 java web 应用程序访问文件系统，情况是用户上传图像，然后图像被 ftped 到另一个地方进行存储。我被困在上传后如何访问文件，我正在使用 tomahawk 库上传后给我留下一个 byte[] 对象，所以我需要将字节转换为图像文件，然后 ftp ..这就是我卡住的地方。我无法让（新文件..）的部分工作。

在 Windows 中，我只是输入 (C:\darksouls.jpg) 并且工作正常。在 linux 上不断收到此错误：

```
 javax.imageio.IIOException 
```

无法读取输入文件？我什至尝试在网络应用程序中创建一个图像文件夹，当我炸开我的罐子时，文件夹就在那里，......

```
 byte[] imageInByte;
    BufferedImage originalImage = ImageIO.read(new File("/images/darksouls.jpg")); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:17:36.797

OpenJDK 没有本地 JPEG 编码器，我希望这应该是问题，尝试使用 sun 的 jdk，如果错了请纠正我

# android - 联系人更改时接收 Intent

> ID：12173392
> 
> 赞同：1
> 
> 时间：2012-08-29T08:07:34.660
> 
> 标签：android, android-intent, contacts

我的应用程序使用 android 设备的联系人。为了获得更好的性能，联系人被放入缓存中。目前我在 X 分钟后刷新缓存，在我看来没有完美的解决方案。当联系人数据库有任何更改（创建更新删除）时，是否有任何方法可以通过 BroadcastReceiver 接收 Intent？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-29T08:35:49.627

更改联系人后，您无法收到意向。这是不可能的，因为框架没有为这些事件发送任何意图。您可以了解用户何时请求添加联系人；例如，当用户单击联系人应用程序中的“+”按钮时。但据我了解，这不是您所需要的。

我知道在添加新联系人时收到通知的唯一方法是[注册一个内容观察者](http://developer.android.com/reference/android/content/ContentResolver.html#registerContentObserver(android.net.Uri,%20boolean,%20android.database.ContentObserver))。您可能希望创建一个将自身注册为内容观察者的后台服务。

[这](https://stackoverflow.com/questions/1401280/how-to-listen-for-changes-in-contact-database)是一个讨论内容观察者的有用问题。

# java - 我可以在一行上投射和使用对象吗？

> ID：12173393
> 
> 赞同：2
> 
> 时间：2012-08-29T08:07:35.073
> 
> 标签：java, syntax

通常，我会这样做：

```
public showDialog(final Object caller) {
    JDialog dialog = [ ... ]

    if (caller instanceof Window) {
        Window w = (Window) caller;
        dialog.setLocationRelativeTo(w);
        w.dispose();
    }
} 
```

但是，有没有一种方法可以做到这一点？基本上，类似于：`(Window) parent.dispose();`或者我是否总是需要创建一个窗口来存储我的演员表？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-29T08:09:10.613

是的：

```
dialog.setLocationRelativeTo((Window) caller); 
```

如果你想调用一个被转换的值的方法，你必须把它括在一组括号中：

```
((Window) caller).dispose(); 
```

就我个人而言，如果这是我唯一要做的*事情*，我只会这样做。如果有两个或多个语句需要使用强制转换的值，那么我将使用一个显式变量，就像您在原始代码中所做的那样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T08:10:07.700

是的，只需将演员表包裹在另一组括号中：

```
((Window) parent).dispose(); 
```

虽然不是特别漂亮。

> 还是我总是需要创建一个窗口来存储我的演员表？

请记住，您不是在创建`Window`- 您是在创建对`Window`已有的引用（这很便宜）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-29T08:10:08.243

你可以写

```
if (caller instanceof Window) {
    dialog.setLocationRelativeTo((Window) caller);
    ((Window) caller).dispose();
} 
```

我建议你做更清楚的事情，不要太担心行数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T08:09:19.180

当然可以。您的 3 行将变为：

```
dialog.setLocationRelativeTo((Window) caller);
((Window) caller).dispose(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T08:48:58.257

为了清楚起见，我经常以稍微不同的方式投射

```
dialog.setLocationRelativeTo(Window.class.cast(caller));
Window.class.cast(caller).dispose(); 
```

我认为这明确地告诉读者你在做什么。虽然 () 强制转换语法是众所周知的，但我认为成语依赖于特定的 Java 知识。

# android - Android WebView：通过身份验证从站点保存图像

> ID：12173397
> 
> 赞同：2
> 
> 时间：2012-08-29T08:07:46.107
> 
> 标签：android, image, authentication, webview, save

感谢stackoverflow，我设法实现了一个webview，我可以通过长按上下文菜单/HitTestResult 保存图像。因此，当我获得图像的 URL 时，我会执行以下操作：

```
 URL url = new URL(yourImageUrl);
      InputStream is = (InputStream) url.getContent();
      byte[] buffer = new byte[8192];
      int bytesRead;
      ByteArrayOutputStream output = new ByteArrayOutputStream();
      while ((bytesRead = is.read(buffer)) != -1) {
        output.write(buffer, 0, bytesRead);
      }

then put the output.toByteArray() into a FileOutputStream; 
```

对于“普通”站点，这可以正常工作，图像存储在 sdcard 上。

但我仍然不知道（我对此进行了广泛的搜索:-( 如何下载需要某种身份验证的站点图像。例如，我进入站点并将用户名/密码输入表单（一些服务器端语言（如 PHP），这给我带来了一些图片。webview 在登录和显示所有内容方面没有问题。但我无法保存图像，因为身份验证 - 存在于 webview 中 -**不**存在于我的图像保存机制。

使用上面的代码，我只是在 URL.getContent() 上获得了 FileNotFoundException。然后我尝试使用 HttpClient 和 HttpGet/HttpResponse，其中响应总是代码 403。

我的问题：如何访问/下载/验证以获取受保护区域的图像（可能是通过服务器端语言或基本验证）。

我的意思是......它都在那里，正确显示并在 WebView 中进行了身份验证:-( 但是 WebView 的内容和我的 URL/Http 请求下载工作之间没有联系。webview 可以以某种方式共享它的身份验证状态吗？

我什至考虑过从 WebView 缓存中获取图像，因为它就在那里。（但我也不知道如何做到这一点......）。是否没有机制可以以某种方式直接从 WebView 中获取图像？

我会感谢任何形式的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T09:10:43.200

如果身份验证方法使用 cookie，则以下方法可能有效：

首先，在加载 url 之前在 webview 上同步 cookie：

```
CookieSyncManager cookieSyncManager = 
                    CookieSyncManager.createInstance(webView.getContext());
CookieManager cookieManager = CookieManager.getInstance();
cookieManager.setAcceptCookie(true);
cookieSyncManager.sync(); 
```

接下来，在请求您的图像时，您可以将域上的 cookie 放入您的 http 请求标头并从 HttpResponse 获取内容：

```
String cookies = CookieManager.getInstance().getCookie(yourImageUrl);
HttpClient httpClient    = new DefaultHttpClient();
HttpContext localContext = new BasicHttpContext();
HttpGet httpGet          = new HttpGet(yourImageUrl);
httpGet.setHeader("Cookie", cookies);

HttpResponse httpResponse = httpClient.execute(httpGet, localContext);
HttpEntity httpEntity     = httpResponse.getEntity();
InputStream is            = httpEntity.getContent(); 
```

# c# - nopCommerce：插件需要为每个产品配置选项卡/页面

> ID：12173398
> 
> 赞同：0
> 
> 时间：2012-08-29T08:07:49.093
> 
> 标签：c#, nopcommerce

我正在为我的客户开发一个 nopCommerce 插件。它将在 UI 上显示每个产品的额外详细信息。到目前为止我一直在工作，但现在我需要添加一种方法来从管理页面编辑每个产品的这些信息......我正在考虑一个单独的标签页。我该怎么办？

我按照这个插件的例子： [http ://www.nopcommerce.com/docs/75/plugin-with-data-access.aspx](http://www.nopcommerce.com/docs/75/plugin-with-data-access.aspx)

但是那里没有关于在管理页面中设置小部件或任何内容来编辑每个产品的新信息的内容。有什么想法/例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T01:51:19.537

这帮助我得到了我需要的东西：[http ://www.nopcommerce.com/boards/t/18721/admintabstribcreated.aspx](http://www.nopcommerce.com/boards/t/18721/admintabstribcreated.aspx)

基本上，您需要`IConsumer<AdminTabStripCreated>`在方法中添加一个和`HandleEvent`，您可以添加一个新选项卡。

# c# - 仅在外部字符串中替换 C# 字符串

> ID：12173399
> 
> 赞同：0
> 
> 时间：2012-08-29T08:07:52.913
> 
> 标签：c#, string, replace, newline

有没有办法在这样的字符串中进行替换？（这是简化的例子）

```
string input = "INSERT INTO blah VALUES \" blah blah \r\n \" \r\n (here can be anything like several new lines and \t tabs) INSERT INTO blah VALUES \" blah blah \r\n \" \r\n";

input.Replace("\r\n", "\n"); // this is just example, it doesn't work the way I need it

// and the output would look like this:
string output= "INSERT INTO blah VALUES \" blah blah \r\n \" \n INSERT INTO blah VALUES \" blah blah \r\n \" \n"; 
```

所以它只会在 SQL 命令之外替换新行？这可以使用正则表达式安全地实现吗？

编辑：替换必须可能通过 \r\n 来实现，到 \n 在 SQL 命令之间可能会有更多。命令没有精确地分开。

编辑：所以基本问题是 - 我如何只替换外部字符串？

```
string = "outer string \"inner string\" outer string \"inner string\" outer string" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:02:43.280

你想要这样的东西吗......

```
/// <summary>
///  Regular expression built for C# on: Wed, Aug 29, 2012, 09:56:25 AM
///  Using Expresso Version: 3.0.4334, http://www.ultrapico.com
///  
///  A description of the regular expression:
///  
///  [1]: A numbered capture group. [(?<counter>").*?(?<-counter>").*?(?(counter)(?!))]
///      (?<counter>").*?(?<-counter>").*?(?(counter)(?!))
///          [counter]: A named capture group. ["]
///              "
///          Any character, any number of repetitions, as few as possible
///          Balancing group. Remove the most recent [counter] capture from the stack. ["]
///              "
///          Any character, any number of repetitions, as few as possible
///          Conditional Expression with "Yes" clause only
///              Did the capture named [counter] match?
///              If yes, search for [(?!)]
///                  Match if suffix is absent. []
///                      NULL
///  \r\n
///      Carriage return
///      New line
///  
///
/// </summary>
Regex regex = new Regex(
      "((?<counter>\").*?(?<-counter>\").*?(?(counter)(?!)))\\r\\n",
    RegexOptions.CultureInvariant
    | RegexOptions.Compiled
    | RegexOptions.Singleline
    );

string input = "INSERT INTO blah VALUES \" blah blah \r\n \" \r\n (here can be anything like several new lines and \t tabs) INSERT INTO blah VALUES \" blah blah \r\n \" \r\n";

string output output=regex.Replace(input,"$1\n"); 
```

的效果`(?<counter>").*?(?<-counter>").*?(?(counter)(?!))`是仅匹配平衡`"`字符，因此仅在引号之外找到 \r\n

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:16:28.787

你*听起来像*你想`\r\n \" \r\n`用`\r\n \" \n`

```
input = input.Replace("\r\n \" \r\n", "\r\n \" \n"); 
```

# sql - 根据客户端时区在sqlServer中存储当前日期时间

> ID：12173408
> 
> 赞同：1
> 
> 时间：2012-08-29T08:08:55.357
> 
> 标签：sql, sql-server, time, timezone

我在数据类型 datetime 的 sql 表中有 dateTimeAuth 列，它的默认值是 (getdate()) 如果我在离线模式下运行我的项目，它会返回我当前时间。当我将它上传到实时服务器时，它会存储默认时区 GMT 的当前时间。我希望根据 IST 存储值。如何做呢 ？

根据 GMT 存储的值：2010 年 8 月 26 日下午 1:02:28 根据 IST 的实际时间：2010 年 8 月 26 日下午 7:02:28

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:31:14.893

getdate() 将始终返回服务器所在的日期和时间。如果您想要用户时区的日期和时间，则需要从应用程序发送日期并将其作为常规 dateTime 变量插入

但如果您使用的是 SQL 2008，则可以使用

```
SELECT SYSDATETIMEOFFSET() 
```

获取您所在时区的日期。您还可以为其添加日期（从 UTC = IST +5:30）

```
SELECT SWITCHOFFSET(SYSDATETIMEOFFSET(), '+05:30') 
```

# java - 如何获得打印精美的 JSON 代码的紧凑形式？

> ID：12173416
> 
> 赞同：24
> 
> 时间：2012-08-29T08:09:07.837
> 
> 标签：java, json, jackson, pretty-print

[如何使 Jackson 的 build() 方法漂亮地打印其 JSON 输出？](https://stackoverflow.com/questions/6176881/how-do-i-make-jackson-pretty-print-the-json-content-it-generates)这是一个漂亮地打印 JSON 代码的丑陋形式的示例。我需要采用漂亮的 JSON 代码版本，然后将其转换为丑陋的形式。如何做呢？我需要转换这个：

```
 {
   "one" : "AAA",
   "two" : [ "BBB", "CCC" ],
   "three" : {
     "four" : "DDD",
     "five" : [ "EEE", "FFF" ]
   }
 } 
```

对此：

```
{"one":"AAA","two":["BBB","CCC"],"three":{"four":"DDD","five":["EEE","FFF"]}} 
```

我试图删除 '\n'、'\t' 和 ' ' 字符；但值中可能有一些这些字符，所以我不能这样做。还有什么可以做的？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-29T08:57:25.393

Jackson 允许您从 JSON 字符串中读取，因此将漂亮打印的字符串读回 Jackson，然后在禁用漂亮打印的情况下再次输出。

请参阅[将字符串转换为 JSON](https://stackoverflow.com/questions/6591388/converting-a-string-to-json-in-java)

**简单示例**

```
 String prettyJsonString = "{ \"Hello\" : \"world\"}";
    ObjectMapper objectMapper = new ObjectMapper();
    JsonNode jsonNode = objectMapper.readValue(prettyJsonString, JsonNode.class);
    System.out.println(jsonNode.toString()); 
```

**需要**

```
<dependency>
    <groupId>com.fasterxml.jackson.core</groupId>
    <artifactId>jackson-core</artifactId>
    <version>2.5.3</version>
</dependency>
<dependency>
    <groupId>com.fasterxml.jackson.core</groupId>
    <artifactId>jackson-databind</artifactId>
    <version>2.5.3</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-09-13T02:05:36.787

使用流 API，您可以使用[`JsonGenerator.copyCurrentEvent()`](http://fasterxml.github.io/jackson-core/javadoc/2.1.0/com/fasterxml/jackson/core/JsonGenerator.html#copyCurrentEvent%28com.fasterxml.jackson.core.JsonParser%29)您想要的任何漂亮打印轻松地重新输出令牌流，包括默认的无空格；这避免了在内存中缓冲整个文档并为文档构建树。

```
// source and out can be streams, readers/writers, etc.
String source = "   { \"hello\" : \" world \"  }  ";
StringWriter out = new StringWriter();

JsonFactory factory = new JsonFactory();
JsonParser parser = factory.createParser(source);
try (JsonGenerator gen = factory.createGenerator(out)) {
    while (parser.nextToken() != null) {
        gen.copyCurrentEvent(parser);
    }
}

System.out.println(out.getBuffer().toString()); // {"hello":" world "} 
```

您可以使用相同的方法以流方式漂亮地打印 JSON 文档：

```
// reindent
gen.setPrettyPrinter(new DefaultPrettyPrinter()); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-29T08:35:59.047

安全的方法是使用[“原始”数据绑定](http://wiki.fasterxml.com/JacksonInFiveMinutes#A.22Raw.22_Data_Binding_Example)读取数据，然后在不启用漂亮打印机的情况下再次将其写出。[Streaming API](http://wiki.fasterxml.com/JacksonStreamingApi)可能是你的朋友。

如果您使用此模式，也可以使用正则表达式：`\s*\n\s*`

这不会创建最紧凑的形式（即元素之间仍然会有一些空格），但如果您已经将 JSON 作为字符串，它是一个便宜的解决方案。这种模式安全的原因是新行在 String 值中无效（必须使用 转义`\n`），因此您可以安全地删除它们周围的空格。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-02-10T23:48:50.613

[Jackosn-core](https://github.com/FasterXML/jackson-core)是漂亮打印 json 的一种方式。您可以在此处阅读答案[https://stackoverflow.com/a/12174201/432903](https://stackoverflow.com/a/12174201/432903)

您还可以使用`org.json`库，这是一个非常简单但标准的 java json 库。在此处开放源代码 -> [stleary/JSON-java](https://github.com/stleary/JSON-java)。

## [maven依赖](https://mvnrepository.com/artifact/org.json/json)

```
<dependency>
    <groupId>org.json</groupId>
    <artifactId>json</artifactId>
    <version>20160810</version>
</dependency> 
```

## 用法

```
 String payload = "{\n" +
            "  \"fact1\": \"Java is verbose.\", \n" +
            "  \"fact2\" : \"C has pointers\"\n" +
            "}";
        System.out.println(new JSONObject(payload)); 
```

您将`{"fact2":"C has pointers","fact1":"Java is verbose."}`在一行中获得紧凑的 json。

# eclipse - 带有 emma 和 junit 的 Java 7 导致 java.lang.VerifyError 和非法局部变量错误

> ID：12173420
> 
> 赞同：13
> 
> 时间：2012-08-29T08:09:20.313
> 
> 标签：eclipse, ant, java-7, emma

所以我收到了这些错误

> [junit] 方法 test.nz.ac.massey.cs.sdc.log4jassignment.s06005586.AppenderLayoutTest.()V 中的非法局部变量表长度 17
> 
> [junit] java.lang.VerifyError：在方法 test.nz.ac.massey.cs.sdc.log4jassignment.s06005586.StressTest.()V 在偏移量 4 中的分支目标 11 处期望堆栈图帧
> 
> [junit] java.lang.ClassFormatError: Illegal local variable table length 17 in method test.nz.ac.massey.cs.sdc.log4jassignment.s06005586.AppenderLayoutTest.()V

我想知道我该如何解决它......

**我读过的：**

*   [Eclipse 中的 Java 7 JVM 验证错误](https://stackoverflow.com/questions/7970622/java-7-jvm-verifyerror-in-eclipse)
*   [Testng、Emma、Cobertura、coverage 和 JDK 7 导致 ClassFormatError 和 VerifyError](https://stackoverflow.com/questions/7010665/testng-emma-cobertura-coverage-and-jdk-7-result-in-classformaterror-and-verif)
*   [EMMA 代码覆盖率](https://sourceforge.net/p/emma/discussion/373867/thread/963f0d6f/)
*   [使用 EMMA 和 ANT 进行 JUnit 测试覆盖率报告](http://wiki.metawerx.net/wiki/UsingEMMAWithANTForJUnitTestCoverageReporting)
*   [错误 141252 - 1.6 编译器 ClassFormatError：类文件中的非法类名“”（已修复）](https://bugs.eclipse.org/bugs/show_bug.cgi?id=141252)
*   [3.2\. : 即时检测 Java 类](http://emma.sourceforge.net/userguide_single/userguide.html#N101C4)

**我做了什么：**

资源：

*   [build.xml](http://pastebin.com/arxhiFey)（将在 24 小时后过期）
*   [build.xml 输出](http://pastebin.com/raw.php?i=3ZfAFXpN)（将在 24 小时后过期）
*   [蚂蚁诊断报告](http://pastebin.com/ytj6sa9f)（24小时后过期）
*   [上一个问题](https://stackoverflow.com/questions/12171438/emma-with-junit-should-i-be-testing-with-the-instrumented-classes-or-java-class/12171942#comment16292650_12171942)
*   [maven-emma-plugin-0.6.jar](http://hivelocity.dl.sourceforge.net/project/emma/plugins-testing/maven-1.0-plugin-0.6/maven-emma-plugin-0.6.jar)
*   [emma.jar 和 emma_ant.jar](https://sourceforge.net/projects/emma/files/emma-release/2.0.5312/emma-2.0.5312.zip/download)

由于某些非常疯狂的原因，JUnit 传递`target="test"`但失败了`target="emmatest"`。

这是命令提示符下的输出`java -version`

```
java version "1.7.0_03"
Java(TM) SE Runtime Environment (build 1.7.0_03-b05)
Java HotSpot(TM) 64-Bit Server VM (build 22.1-b02, mixed mode) 
```

我尝试从这里为我`java7 JRE`设置`-XX:-UseSplitVerifier`默认[参数](https://vikashazrati.wordpress.com/2011/10/09/quicktip-verifyerror-with-jdk-7/)

[![论据](../Images/a781a213aa94ad6fb9c0f311e85ed6b2.png)](https://i.stack.imgur.com/KZWl7.png)
[（来源：[iforce.co.nz](http://iforce.co.nz/i/dvsh1eoc.n0m.png)）]

我也试图让它`JDK 1.6`在`Project Properties`.

[![抱怨](../Images/0ac58096440ca5edb94218f7a0ecce47.png)](https://i.stack.imgur.com/9Z4Nr.png)
[（来源：[iforce.co.nz](http://iforce.co.nz/i/4jxuj4eb.rae.png)）]

JUnit 直接测试结果（trace 上没有错误）

[![朱尼特](../Images/47b2ba57cdd50ead94badf073879fd78.png)](https://i.stack.imgur.com/YJfa8.png)
[（来源：[iforce.co.nz](http://iforce.co.nz/i/wicrvpsi.5gw.png)）]

我没有选择，请帮助！:(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T02:58:06.850

听起来很奇怪。

首先，检查您的代码，看看您是否使用了 JDK 1.7 中引入的新语法功能，例如`try-with-resource`或`diamond operator`.

我之前在使用 cobertura 时遇到过这个 VerifyError。但是，当我设置`-XX:-UseSplitVerifier`任务`junit`时，它就解决了。我通过为任务指定一个`<jvmarg>` 嵌套元素来设置它。`junit`

此外，大多数覆盖库似乎对 JDK1.7 的支持很差。但是，**Jacoco**与 JDK1.7 配合得很好，所以我现在正在使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T10:51:35.310

`-XX:-UseSplitVerifier`

对我有用，我不必将**JRE**从**1.7**降级到**1.6**

# .net - 在属性网格中添加编辑文本下拉列表

> ID：12173421
> 
> 赞同：2
> 
> 时间：2012-08-29T08:09:22.443
> 
> 标签：.net, winforms, propertygrid

我正在编写一个类，其属性可通过属性面板访问，其中一个属性是多行文本。

我希望在此属性面板的设计器中显示一个下拉列表，以便用户填写多行文本，就像 Visual Studio 中的 Label 或 TextBox 一样。

![这就是我在属性面板中想要的](../Images/f13d277bd6bc692362a4cbd4ff569314.png)

我应该将哪个属性放在我的属性定义之上以允许这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T19:03:13.127

您想用[System.ComponentModel.Design.MultilineStringEditor](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.multilinestringeditor.aspx)装饰“Text”属性。

例如

```
[Editor("System.ComponentModel.Design.MultilineStringEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", typeof(UITypeEditor))]
public string Text { .... } 
```

# python - 在 python 列表中附加 unicode 项

> ID：12173424
> 
> 赞同：0
> 
> 时间：2012-08-29T08:09:29.477
> 
> 标签：python

我想测试传递给函数的 Unicode 单词是否不在列表中，函数对这个单词进行一些操作。像这样的东西：

```
def my_function(word):
    if not word in [u'تست']:
    ... 
```

好吧，它完美无缺。但我的列表比这更大，我将它的单词保存到一个单独的文件中。现在我正在尝试将此文件行读取为单词，但我不知道如何将主题附加为 Unicode 之类的`[u'تست']`. 我尝试使用`unicode()`，但即使在这种`if`情况下也找不到文件中已经存在的单词。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T08:12:27.160

[`codecs.open`](http://docs.python.org/library/codecs.html#codecs.open)使用而不是打开文件`open`，那么您从文件中读取的所有内容都将是`unicode`而不是`str`。

# android - 如何判断android rawQuery更新成功？

> ID：12173425
> 
> 赞同：1
> 
> 时间：2012-08-29T08:09:33.457
> 
> 标签：android, sqlite

```
 Cursor cursor = sqliteDatabase.rawQuery("update "
            + DbMetaData.CART_TABLE_NAME + " set " + DbMetaData.PRODUCT_NUM
            + "=" + DbMetaData.PRODUCT_NUM + "+" + num + " where "
            + DbMetaData.ID + "=?", new String[]{id}); 
```

cursor.getCount() 总是返回 0；那么如何判断我更新成功呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:19:25.497

`rawQuery`最好**用于**执行`SELECT`操作。它不会让您知道更改的行数。

您应该使用它`sqliteDatabase.update`来执行更新操作并获取受影响的行数。

# asp.net - 双重输入

> ID：12173426
> 
> 赞同：0
> 
> 时间：2012-08-29T08:09:39.863
> 
> 标签：asp.net, entity-framework

为什么以下会为 Strategy & Segment 生成重复条目？任何指导将不胜感激。

```
public ActionResult Create(Program program)
{
    db.Programs.Add(program);

    Strategy strategy = db.Strategies.Where(s => s.Name == program.Strategy.Name).SingleOrDefault();
    Segment segment = db.Segments.Where(m => m.Name == program.Segment.Name).SingleOrDefault();

    // Make sure not to save duplicate entries of segment & strategy
    if (strategy != null)
    {
        program.Strategy = strategy;
        db.Entry(strategy).State = EntityState.Unchanged;
    }

    if (segment != null)
    {
        program.Segment = segment;
        db.Entry(segment).State = EntityState.Unchanged;
    }

    db.SaveChanges();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:14:36.380

尝试

```
 db.Entry(strategy).State = EntityState.Unchanged; 
```

和

```
 db.Entry(segment).State = EntityState.Unchanged; 
```

# sed - awk/sed：在第二场比赛后删除剩余的行

> ID：12173427
> 
> 赞同：1
> 
> 时间：2012-08-29T08:09:42.183
> 
> 标签：sed, awk

我需要一些帮助来删除某些文件中第 1 行（并且只有第 1 行）的第二次匹配之后（包括）该行的其余部分。例如，如果模式是星号`*`：

输入：

```
asd*asd*asd*asd*asd*
asdasdasd*asdasdasd*asdasdasd*asdasdasd 
```

预期输出：

```
asd*asd
asdasdasd*asdasdasd*asdasdasd*asdasdasd 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T09:42:07.403

这可能对您有用（GNU sed）：

```
sed '1s/\*[^*]*//2g' file 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:13:44.810

要将操作限制为一行，请使用“地址”：

```
sed '1s/\([^*]\*[^*]*\).*/\1/' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T08:21:52.250

一种`awk`解决方案：

```
awk '
    BEGIN { FS = OFS = "*" } 
    FNR == 1 { 
        print $1, $2 
    } 
    FNR > 1 { 
        print 
    }
' infile 
```

这会产生：

```
asd*asd
asdasdasd*asdasdasd*asdasdasd*asdasdasd 
```

# android - 接近警报和电池耗尽

> ID：12173428
> 
> 赞同：2
> 
> 时间：2012-08-29T08:09:46.563
> 
> 标签：android, performance, gps, proximity, battery

我正在做一个项目，我使用 requestSingleUpdate 方法每 5 分钟跟踪一次手机的位置。这样做手机的电池可以持续一整天。

我想检查手机是否靠近我已地理编码的特殊位置。我曾考虑使用接近警报，但我不知道它是如何工作的。它会只使用我之前的 requestSingleUpdate 提供的位置，还是会设置自己的 requestLocationUpdates ？

那么电池消耗呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:21:09.323

从 Android[文档](http://developer.android.com/reference/android/location/LocationManager.html#addProximityAlert%28double,%20double,%20float,%20long,%20android.app.PendingIntent%29)中，它将使用自己的位置检查方法，并且在屏幕关闭时每 4 分钟执行一次。

因此，如果您确实想通过其他方式获取用户位置，则不需要使用自己的 locationListener。以这种方式使用[PASSIVE_PROVIDER](http://developer.android.com/reference/android/location/LocationManager.html#PASSIVE_PROVIDER)（从 API8 开始），当proximityAlert 执行位置请求或任何其他使用LocationManager 的应用程序触发请求时，PASSIVE_PROVIDER 也将被触发。

# javascript - 为什么启动多个阶段时，第一帧动画的时间如此之大？

> ID：12173435
> 
> 赞同：0
> 
> 时间：2012-08-29T08:10:08.557
> 
> 标签：javascript, html, canvas, kineticjs

我正在网页上启动三个（或更多） Kinetic.Stages。当我独自开始我的第一阶段时，它正常工作。

但是，当我之后开始任何阶段时，第一次调用 onFrame() 中的 frame.timeDiff 会返回一个巨大的值（一百万，百万）。

这可能是什么原因造成的？

```
window.onload = function() {
    var stage1 = new Kinetic.Stage({
        container: "widget1",
        width: 10,
        height: 10
    });

    stage1.onFrame(function(frame) {
        console.log(frame.timeDiff);
    }

    stage1.start();

    var stage2 = new Kinetic.Stage({
        container: "widget2",
        width: 10,
        height: 10
    });

    stage2.onFrame(function(frame) {
        // empty
    });

    stage2.start();

    var stage3 = new Kinetic.Stage({
        container: "widget3",
        width: 10,
        height: 10
    });

    stage3.onFrame(function(frame) {
        // empty
    });

    stage3.start(); 
}; 
```

只要只启动一个阶段，它就可以正常工作，但是一旦启动任何其他阶段，帧时间就会变得巨大。重新安排开始和初始化不会改变任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T10:06:22.950

你在用 Chrome 吗？在 chrome 中的选项卡之间切换时遇到问题。（frame.timeDiff 变得很大。由于 Chrome 确实暂停了 javascript（我认为）。

我通过添加解决了这个问题： var timeDiff = Math.min(frame.timeDiff, 50);

希望这对您有帮助

# objective-c - ObjC 使用在另一个类中触发的块中的变量

> ID：12173445
> 
> 赞同：0
> 
> 时间：2012-08-29T08:10:59.693
> 
> 标签：objective-c, variables, block

我正在使用 Facebook SDK 3，它使用 Blocks 作为 CompletionHandlers。我想在传递块中使用局部范围变量（参数）到 FBRequestConnection

```
-(void)     shareStoryWithHandle:(const int)HID parameters:(NSString*)jsonparams
{
    if (FBSession.activeSession.isOpen)
    {
         FBRequestHandler my_handler = ^(FBRequestConnection *connection, id result, NSError *error)
        {
            // do somthing with HID
            // but HID is 0 in this scope while is correct in shareStoryWithHandle scope!
        }
        [FBRequestConnection startWithGraphPath:@"me/feed"
                                 parameters:[jsonparams objectFromJSONString]
                                 HTTPMethod:@"POST"
                          completionHandler:my_handler];
    }
} 
```

我如何在 Block 范围内使用 HID，但我无法将它存储在类中！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:14:17.573

您在块中为 0 的断言`HID`是错误的。当您创建块时，它会获取任何捕获变量的 const 副本，因此如果您在块中引用`HID`，那么块中的变量将具有在`HID`创建块时所做的值。

# android - 有没有办法从视图后面显示对话框？

> ID：12173449
> 
> 赞同：0
> 
> 时间：2012-08-29T08:11:18.487
> 
> 标签：android, android-layout, android-dialog

我做了一个很好的对话框，在我的应用程序中出现了动画。但是有一个小问题：我需要将它从一个简单的标题栏滑到屏幕后面。标题栏包含一个简单的图形和一个带有我的应用程序名称的 textView，所以如果你知道我的意思，这个对话框必须在下面或后面滑动。

问题：

是否有掩蔽选项不显示布局的该部分中的对话框或其他东西来实现这种效果？

谢谢大家，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T09:32:44.717

不，你不能。对话框是模态的，因此它们始终位于顶部并阻止焦点。

您可能能够重新定位窗口本身，请参阅[在屏幕上定位对话框，](https://stackoverflow.com/q/4518995/808940) 但您将无法将其屏蔽。

至于动画对话框，请参阅[https://stackoverflow.com/a/5591827/808940](https://stackoverflow.com/a/5591827/808940)

# ruby-on-rails - Rails 中的变量和方法命名约定

> ID：12173451
> 
> 赞同：4
> 
> 时间：2012-08-29T08:11:24.037
> 
> 标签：ruby-on-rails

我知道有一个 Rails 命名约定，用于编写变量和方法，如`this_is_my_variable`和`this_is_my_method`。

但是，我目前更经常看到使用 like `thisIsMyVariable`or的 Python 和 Objective C 方法`thisIsMyMethod`，而且我认为这样的代码看起来更漂亮。

我的问题是这种 Python 风格的命名约定在 Rails 上也可以接受，因为它可能是一种更新的命名方法，还是我应该严格遵守当前的 Rails 命名约定？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T08:29:17.887

我想这取决于你问的是谁。据我所知，没有官方的 ruby​​ 样式指南，但基本上每个人都使用`snake_case`变量和方法名称、`CamelCase`类和模块以及`SCREAMING_SNAKE_CASE`其他常量。

一些谷歌搜索给了我[这个关于 ruby​​ 风格指南](https://stackoverflow.com/questions/616037/ruby-coding-style-guidelines)的问题，它列出了一大堆不同（非官方）风格指南的链接。

我个人的看法是，这`mixedCase`只是令人困惑，并且在 ruby​​ 中看起来不合适。我已经看过了，但我总是至少要仔细阅读才能真正阅读它（并确保我实际上不是在阅读 Java 代码）。

老实说，我也会`snake_case`在 Python 中使用方法和变量名称（这似乎符合[PEP8 - 命名约定](http://www.python.org/dev/peps/pep-0008/#naming-conventions)），并且只`mixedCase`在 Java 或 JavaScript 中使用。

回到你的问题。我知道有人会接受`mixedCase`ruby​​ 代码，但我认识的大多数 ruby​​ 开发人员肯定不会接受，有些人可能会为此尖叫并向你扔东西。

# jquery - json 跨源不适用于回调 =？

> ID：12173461
> 
> 赞同：0
> 
> 时间：2012-08-29T08:11:47.930
> 
> 标签：jquery, json, callback, getjson

我在 mangaeden.com 上获取 JSON 数据时遇到问题。让我解释：

如果我使用这个脚本

```
$.getJSON('http://www.mangaeden.com/api/list/1/', function(data) {

            $.each(data.manga, function(key, val) {
                something();
            });
        }); 
```

我收到“访问控制允许来源错误”。所以我使用回调：

```
$.getJSON('http://www.mangaeden.com/api/list/1/?&callback=?', function(data) {

            $.each(data.manga, function(key, val) {
                something();
            });
        }); 
```

现在服务器向我发送 json 数据，但它被评估为脚本，所以我得到“Uncaught SyntaxError: Unexpected token :”错误

我该死的怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:29:00.170

我用 YQL 做了一个解决方案

YQL 查询[点击](http://developer.yahoo.com/yql/console/#h=select%20%2a%20from%20json%20where%20url=%22http://www.mangaeden.com/api/list/1/%22)

工作示例[http://jsfiddle.net/gJCk3/](http://jsfiddle.net/gJCk3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:34:50.220

你应该改变这个api [http://www.mangaeden.com/api/list/1/?callback=jsonpcb](http://www.mangaeden.com/api/list/1/?callback=jsonpcb) ..结果必须是这样的

```
jsonpcb({
  "manga": [
    {
      "i": "4e70ea93c092255ef70074f3",
      "a": "dragonball-af",
      "im": null,
      "t": "DragonBall AF"
    },
..
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:20:08.863

您需要在“回调”之前删除“&”符号。

# java - vaadin Web 应用程序的文件选择器

> ID：12173462
> 
> 赞同：3
> 
> 时间：2012-08-29T08:11:49.043
> 
> 标签：java, swing, vaadin

我正在开发一个 vaadin Web 应用程序。我想在我的应用程序中有一个 JFileChooser 类型的东西，通过使用它我可以获得所选文件的路径。我最初使用过 JFileChooser，但它只在服务器计算机上提示，而不是在客户端上。所以我想在浏览器上为我的客户端做同样的事情。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T09:45:24.417

您想使用[上传组件](https://vaadin.com/book/-/page/components.upload.html)-有关示例，请参见[https://demo.vaadin.com/sampler/#ui/data-input/other/upload 。](https://demo.vaadin.com/sampler/#ui/data-input/other/upload)Vaadin 目录中还有单独的组件（例如[https://vaadin.com/directory#addon/easyuploads](https://vaadin.com/directory#addon/easyuploads)）可能更适合您的用例。

请务必注意，您根本无法控制文件浏览器的外观——例如，您不能将其指向特定目录，或限制过滤器（例如指定 *.doc）。“FileChooser”完全由浏览器控制。

可以*将*第三方文件上传小部件合并到 Vaadin 组件中，例如[SWFUpload](http://code.google.com/p/swfupload/)或[JUpload](http://jupload.sourceforge.net/)，但我没有看到任何示例，也没有任何这样做的经验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-19T13:18:22.417

你没有提到 Vaadin 版本。我正在使用 Vaadin 8，可以限制文件类型/mimetype。

```
Upload upload = new Upload();
upload.setAcceptMimeTypes("application/json"); 
```

# jquery-mobile - 我尝试在 jquery mobile 中更改活动页面，但它不起作用？

> ID：12173463
> 
> 赞同：0
> 
> 时间：2012-08-29T08:11:50.923
> 
> 标签：jquery-mobile

我有我的起始页“index.html”。我转到另一个页面“notepad.html”，但我在为“index.html”工作的标签中所做的所有事情。我尝试像这样更改活动页面

```
data-rel="external" onclick="$.mobile.changePage('notepad.html', { transition: 'slide'} );" 

```

，但一切都不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:51:55.377

您可能想阅读此主题：http: [//forum.jquery.com/topic/mobile-changepage-and-rel-external](http://forum.jquery.com/topic/mobile-changepage-and-rel-external)

# javascript - window.location.href 时无法从 javascript 获取帖子值

> ID：12173464
> 
> 赞同：0
> 
> 时间：2012-08-29T08:11:55.780
> 
> 标签：javascript, django, post

`{% url org_select_book_list %}`在我使用该功能进入新页面之前`reload_books`，我需要发布一些值，并且需要将数据存储在`{% url org_store_select_book_list %}`.

但我无法接收数据。

但是当我评论时`reload_books();`，我可以收到它。为什么？

在这里我添加视图，我不知道它是否可以工作。注意：这`HttpResponse`仅用于测试目的。

```
function reload_books() {  
        var new_url = '{% url org_select_book_list %}?type=' + type  
                + '&order_by=' + order_by + '&page=' + page  
                + '&per_page=' + per_page + '&q=' + q;  
        for (var i = 0; i < search_param_stack.length; i ++) {  
            new_url += '&' + search_param_stack[i] + '=' + eval(search_param_stack[i]);  
        }  

        window.location.href = new_url;
    }

function change_page(new_page) {
        if (new_page < 1) {
          strong textpage = 1;
        } else if (new_page > {{ book_list.paginator.num_pages }}) {
            page = {{ book_list.paginator.num_pages }};
        } else {
            page = new_page;
        }

        var form = document.createElement("form");
        form.innerHTML = "{% csrf_token %}";
        form.setAttribute("method", "POST");
        form.setAttribute("action", "{% url org_store_select_book_list %}");
        form.setAttribute("enctype", "multipart/form-data");
        //form.setAttribute("Content-Type", "application/x-www-urlencoded");

        var page_from = document.createElement("input");
        page_from.setAttribute("type", "hidden");
        page_from.setAttribute("name", "page_from");
        page_from.setAttribute("value", "{{ book_list.number }}");
        form.appendChild(page_from);

        var bookId = document.getElementsByClassName("batch_cb");
        var page_length = {{ book_list.end_index }} - {{ book_list.start_index }};
        for(var i = 0; i < page_length; i++) {
            var YAhiddenField = document.createElement("input");
            YAhiddenField.setAttribute("type", "hidden");
            YAhiddenField.setAttribute("name", "bookId[" + i + "]");
            if(bookId[i].checked == true) {
                YAhiddenField.setAttribute("value", bookId[i].getAttribute("value"));
            }
            form.appendChild(YAhiddenField);
        }

        document.body.appendChild(form);
        form.submit();
        document.body.removeChild(form);

        reload_books();
        return false;
    }

views.py
@user_type_required(['organizationuser'])
def org_store_select_book_list(request):
    """
    when select a list of books from one page,
    the session will store the books' id from that page
    """

    # initialize the session
    request.session.select_books = []
    # if pass the books' id to this page
    if request.POST:
        # if books' id not in the id list
        for i in request.POST:
            if i.startswith("bookId"):
                if request.POST[i] not in booksId:
                # the list append the book's id
                    booksId.append(request.POST[i])
        # delete the data of the session
        del request.session.select_books
        # store the list to the session
        request.session.select_books = booksId

        from django.http import HttpResponse
        return HttpResponse(booksId) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:30:35.383

你应该做

```
if request.method == 'POST': 
```

代替

```
if request.POST: 
```

# android - 在安装 android 应用程序时将图像从 assest 复制到 sd 卡

> ID：12173468
> 
> 赞同：0
> 
> 时间：2012-08-29T08:12:12.370
> 
> 标签：android, android-sdcard, android-image, android-assets

我有一些图像应该显示在应用程序中，Q.是如何将我放在代码中assets文件夹中的图像复制到用户SC卡下的文件夹中，以便在手机上安装应用程序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:18:49.280

试试这个，

```
private void copyAssets() {
    AssetManager assetManager = getAssets();
    String[] files = null;
    try {
        files = assetManager.list("");
    } catch (IOException e) {
        Log.e("tag", e.getMessage());
    }
    for(String filename : files) {
        InputStream in = null;
        OutputStream out = null;
        try {
          in = assetManager.open(filename);
          out = new FileOutputStream("/sdcard/" + filename);
          copyFile(in, out);
          in.close();
          in = null;
          out.flush();
          out.close();
          out = null;
        } catch(Exception e) {
            Log.e("tag", e.getMessage());
        }       
    }
}
private void copyFile(InputStream in, OutputStream out) throws IOException {
    byte[] buffer = new byte[1024];
    int read;
    while((read = in.read(buffer)) != -1){
      out.write(buffer, 0, read);
    }
} 
```

不要忘记在您的清单中添加此权限

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-03T22:12:54.360

所以我需要做一些类似的事情，除了所有文件，并且在启动时为 AOSP 包。如果有人感兴趣，这里是包的链接（参见 AssetCopyReceiver.java）。

[https://github.com/Paradopolis/AssetCopier/blob/master/src/com/paradopolis/assetcopier/AssetCopyReceiver.java](https://github.com/Paradopolis/AssetCopier/blob/master/src/com/paradopolis/assetcopier/AssetCopyReceiver.java)

这会将 sdcard 下的所有文件复制到它们各自的位置，并且它也应该与子目录一起使用。它用作启动接收器，不适用于常规应用程序，因此需要对其进行修改，但代码是相同的。它很大程度上基于我从那里开始的第一个答案，并纠正了我发现的一些问题，因为我需要扩展它。

# database - 如何在mongoengine中切换数据库名称

> ID：12173469
> 
> 赞同：1
> 
> 时间：2012-08-29T08:12:15.297
> 
> 标签：database, pymongo, mongoengine

我有多个具有相同集合名称、文档类型等的数据库。

在 Github 的源代码中，文档使用 get_db 方法来选择要处理的数据库，并且在该方法中还有另一个调用来获取服务器连接。这两个过程都使用称为“别名”的相同参数。

假设我用相同的服务器详细信息和不同的数据库、别名定义了所有数据库连接。这样，将有多个连接到同一服务器。但是如果我可以在单个连接上更改数据库会更好。例如;

```
 import pymongo
    con = pymongo.connection(/* ... */)
    def dummyDBSwitch(db):
            global con
            return con[db] 
```

查询前可以切换数据库吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:08:31.783

我们在 mongoengine 源代码中添加了一些方法并通过这种方式解决了这个需求，详情：[https ://github.com/cool-shark/mongoengine](https://github.com/cool-shark/mongoengine)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T12:48:28.457

这目前是不可能的，但将在 0.8 中进行查看。关注@metoikos 的票：[https ://github.com/MongoEngine/mongoengine/issues/106](https://github.com/MongoEngine/mongoengine/issues/106)

# sql - 如何在sybase中获取该列位于其他查询内部的查询中的部分列值？

> ID：12173470
> 
> 赞同：1
> 
> 时间：2012-08-29T08:12:20.267
> 
> 标签：sql, sap-ase

我在名为 Conses 的表中有一个名为 Cons 的列，因为`Order::Resource(PPP32#BB300320LQ00J#AAAR05504)` 我有第二个表，它依赖于第一个表。我想从秒表中获取所有数据，我如下手动完成，结果还可以

```
select * from so_db..item   where  id =('PPP32' )
                            and    sub_id =('BB300320LQ00J')
                            and    tem_id =('AAAR05504'); 
```

但我想用另一个查询替换括号内的内容，该查询必须获取上述列的一部分，如下所示：

id = '#' 字符之前的列的第一部分

sun_id = '#' 字符之间的列中间部分

tem_id = 列的最后一部分

```
select * from so_db..item   where  id =( select Cons from er_db..Conses where UsedBy_ = 'mmmf8c713f490f8133c00e16ffdea136add')
                            and    sub_id =(select Cons from er_db..Conses where UsedBy_ = 'mmmf8c713f490f8133c00e16ffdea136add')
                            and    tem_id =(select Cons from er_db..Conses where UsedBy_ = 'mmmf8c713f490f8133c00e16ffdea136add'); 
```

**有人知道怎么做这个吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:13:43.413

您只需要进行字符串操作。

使用[substring](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.blocks/html/blocks/blocks215.htm)、[charindex](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.blocks/html/blocks/blocks120.htm)、[char_length](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.blocks/html/blocks/blocks119.htm)、[right](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.blocks/html/blocks/blocks194.htm)和[left](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.blocks/html/blocks/blocks164.htm)函数:)

* * *

```
declare @string varchar(50)
select @string = 'Order::Resource(PPP32#BB300320LQ00J#AAAR05504)'
declare @start int, @end int, @secondstring varchar(100)

select @start = charindex('#',@string)
select @secondstring = substring(@string, @start+1, len(@string))

select @end = charindex('#',@secondstring)

select substring(@string,charindex('(', @string)+1, @start-1-charindex('(', @string)),
       substring(@string,@start+1,@end-1), 
       substring(@string, @start+@end+1, len(@string)-(@start+@end+1)) 
```

# python - for 语句不适用于 pygame

> ID：12173475
> 
> 赞同：0
> 
> 时间：2012-08-29T08:12:41.130
> 
> 标签：python, for-loop, pygame

我想做一些进化模拟的工作。第一部分是在 pygame 上制作独立移动的方块。这似乎工作，除了一个轻微的障碍！当使用 for 语句第 43 行时，它似乎并未将其应用于仅生成第一个方块的所有方块。所以一格按预期移动，其余的只是坐在那里无所事事..请帮助：D

```
import pygame, sys
from pygame.locals import *
import time
import random

pygame.init()

# set up the window
DISPLAYSURF = pygame.display.set_mode((500, 500), 0, 32)
pygame.display.set_caption('Drawing')

# set up the colors
BLACK = (  0,   0,   0)
WHITE = (255, 255, 255)
RED   = (255,   0,   0)
GREEN = (  0, 255,   0)
BLUE  = (  0,   0, 255)

# draw on the surface object
DISPLAYSURF.fill(BLACK)
robot_list=[]
counter =0
while counter < 26:
    x=random.randrange(1,500)
    x2 = x +6
    y= random.randrange(1,500)
    y2 = y +6
    robot_file=pygame.draw.polygon(DISPLAYSURF, WHITE, ((x, y), (x2, y), (x2, y2), (x, y2)))

    robot_list.append(robot_file)
    counter +=1

# run the game loop
while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    for r in robot_list:
        time.sleep(0.1)
        pygame.draw.polygon(DISPLAYSURF, BLACK, ((x, y), (x2, y), (x2, y2), (x, y2)))
        rand2=random.randrange(1,6)
        rand1=random.randrange(-6,6)
        x += rand1
        x2+= rand1
        y+=rand2
        y2+=rand2

        pygame.draw.polygon(DISPLAYSURF, WHITE, ((x, y), (x2, y), (x2, y2), (x, y2)))
        pygame.display.update()

    pygame.display.update() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:27:31.737

很简单：您的代码中只有一个多边形。我不确定`pygame.draw.polygon()`返回的是什么；[根据文档](http://www.pygame.org/docs/ref/draw.html#pygame.draw.polygon)，它不会返回任何有用的东西。

您需要做的是将多边形的坐标放入列表中`robot_file`（顺便说一句，这是一个非常糟糕的列表名称），然后更新这些坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T09:34:34.587

> 它似乎并未将其应用于仅生成第一个正方形的所有正方形。

这里的问题是你没有任何类型的*square*。您只需使用绘图功能绘制一些东西。为了更好地理解这一点，也许只需创建一个从主循环中抽象出*游戏对象的类。*

**例子：**

```
class Polygon(object):
    def __init__(self):
       self.x = random.randrange(1,500)
       self.x2 = self.x + 6
       self.y = random.randrange(1,500)
       self.y2 = self.y + 6

    def move(self):
        rand2 = random.randrange(1,6)
        rand1 = random.randrange(-6,6)
        self.x += rand1
        self.x2 += rand1
        self.y += rand2
        self.y2 += rand2

    def draw(self, surface):
        pygame.draw.polygon(surface, WHITE, ((self.x, self.y), (self.x2, self.y), (self.x2, self.y2), (self.x, self.y2)))

for _ in xrange(26):
    robot_list.append(Polygon())

# run the game loop
while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    for r in robot_list:
        r.move()
        r.draw(DISPLAYSURF)

    time.sleep(0.1)
    pygame.display.update() 
```

# mysql - 向数据库中的表和字段添加小注释

> ID：12173476
> 
> 赞同：0
> 
> 时间：2012-08-29T08:12:41.540
> 
> 标签：mysql, sybase, database-schema

我正在开发一个项目并创建数据模型。随着时间和请求，数据模型变得越来越大，在几个表中有很多外键和很多列，它们具有特定的含义。

我想知道，如果**我们可以在表格创建中添加注释/小文本到表格/字段**中，以便我可以轻松地将有用的信息存储在数据库本身中。这样它就可以与我所做的导出和导入一起使用，以保留备份和其他原因。

此外，这可以帮助其他开发人员方便地获取少量信息并减少学习曲线。

我确实赞成该项目的完整文档，这是不可或缺的部分，但这种功能会有所帮助。

请让我知道，如果可能的话，这已经存在于 Mysql/Sybase 和任何其他数据库中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:35:02.240

到这里：

[http://dev.mysql.com/doc/refman/5.1/en/create-table.html](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)

并寻找关键字“评论”。您可以使用该关键字指定表和列的简短注释（分别为 60 和 255 个字符）

# java - 在 Apache Karaf 上的 OSGi 包中设置 Spring AOP 日志记录

> ID：12173477
> 
> 赞同：2
> 
> 时间：2012-08-29T08:12:41.890
> 
> 标签：java, spring, osgi, spring-aop, apache-karaf

我正在尝试设置`Spring AOP`部署`OSGi`在`Apache Karaf`. 这与我在[这里](https://stackoverflow.com/questions/12077274/use-spring-aop-in-osgi-bundle)的帖子有关。那里提供的答案对我没有帮助。如果我添加 Maven 依赖项：

```
<dependency>
    <groupId>org.aspectj</groupId>
    <artifactId>com.springsource.org.aspectj.weaver</artifactId>
    <version>1.6.2.RELEASE</version>
    <scope>provided</scope>
</dependency> 
```

我必须导出一堆包：

```
org.aspectj.lang.*,
org.aspectj.internal.lang.reflect.*,
org.aspectj.internal.lang.annotation.*,
org.aspectj.runtime.internal.*,
org.aspectj.runtime.*,
org.aspectj.weaver.reflect.*,
org.aspectj.apache.bcel.classfile.*,
org.aspectj.apache.bcel.*,
org.aspectj.bridge.*,
org.aspectj.util.*,
org.aspectj.weaver.*,
com.bea.jvm.*, 
```

而最后一个`(com.bea.jvm.*)`正在打破一切。当我尝试启动我的包时，它给了我缺少需求的错误，并说这个包丢失了。`(package=com.bea.jvm)`. 但它是出口的。除了上面的 maven 依赖，我还尝试了不同的其他但同样的问题。

我在这里缺少什么？`OSGi`互联网上与和相关的信息并不多`AOP`。有人能帮我吗？我被困在这里...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T09:23:29.193

最后我找到了解决方案。我需要安装这些包：

```
install http://repository.springsource.com/ivy/bundles/external/org.aspectj/com.springsource.org.aspectj.runtime/1.6.2.RELEASE/com.springsource.org.aspectj.runtime-1.6.2.RELEASE.jar
install http://repository.springsource.com/ivy/bundles/external/org.aspectj/com.springsource.org.aspectj.weaver/1.6.2.RELEASE/com.springsource.org.aspectj.weaver-1.6.2.RELEASE.jar 
```

并将`org.aopalliance.aop,`包导入我的包中，一切正常。也没有必要导出这堆`(org.aspectj)`包。

# java - Java 自定义协议客户端-服务器

> ID：12173484
> 
> 赞同：1
> 
> 时间：2012-08-29T08:13:10.773
> 
> 标签：java

我正在尝试用 Java 创建一个客户端-服务器应用程序。此应用程序将图像从客户端传输到服务器。要求是应用程序需要按网络字节顺序排列。（下图）

这将帮助我学习如何在未来部署其他协议，因此寻找一些如何实现这一点的技巧。目前我的服务器-客户端正在工作和传输图像，但不确定如何实现该协议。

谢谢

这是我当前的服务器/客户端代码：

```
公共类网络服务器 {

public static void main(String[] args) {

    NetworkServer servidor = new NetworkServer();
    System.out.println("Server started()");
    BufferedInputStream bis;
    BufferedOutputStream bos;
    int num;
    File file = new File("/images");
    if (!(file.exists())){
      file.mkdir();
    }

    try {
      ServerSocket socket = new ServerSocket(15000);
      Socket incoming = socket.accept();

      try {
        try{
          if (!(file.exists())){
            file.mkdir();
          }
          InputStream inStream = incoming.getInputStream();
          OutputStream outStream = incoming.getOutputStream();

          BufferedReader inm = new BufferedReader(new InputStreamReader(inStream));
          PrintWriter out = new PrintWriter(outStream, true /* autoFlush */);
          String filelength = inm.readLine();
          String filename = inm.readLine();
          System.out.println("Server() Filename = " + filename);
          System.out.println("Server() File lenght: " + filelength + " bytes");
          System.out.println("Server() ACK: Filename received = " + filename);

          //RECIEVE and WRITE FILE
          byte[] receivedData = new byte[1000000];
          bis = new BufferedInputStream (incoming.getInputStream());
          bos = new BufferedOutputStream (new FileOutputStream("/images" + "/" + "image.jpg"));

          while ( (num = bis.read(receivedData)) > 0){
            bos.write(receivedData,0,num);
          }
          bos.close();
          bis.close();

          File receivedFile = new File(filename);
          long receivedLen = receivedFile.length();
          System.out.println("Server() ACK: Length of received file = " + receivedLen);

        } finally {
          incoming.close();
       }
      } catch (IOException e){
        e.printStackTrace();
      }
    } catch (IOException e1){
      e1.printStackTrace();
    }
            }
    } 
```

![协议](../Images/639a2844fb34e667e808cbf5101b3bed.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:23:11.257

“网络字节顺序”的另一个名称是“大端”（参见[Wikipedia](http://en.wikipedia.org/wiki/Endianness#Endianness_in_networking)）。

现在您需要在 Java 中找到一个支持整数大端编码的类。这并不像应有的那么简单，因为文档避免了诸如“网络字节顺序”或“大端”之类的标准术语。您的经验教训：当您可以通过使用标准搜索词找到所需内容时，文档会更加有用。

也就是说，您要查找的类是[DataInputStream](http://docs.oracle.com/javase/7/docs/api/java/io/DataInputStream.html#readInt%28%29)：

> 读取四个输入字节并返回一个 int 值。让 ad 成为读取的第一个到第四个字节。返回的值为：

```
 (((a & 0xff) << 24) | ((b & 0xff) << 16) |
     ((c & 0xff) << 8) | (d & 0xff)) 
```

（[readInt()](http://docs.oracle.com/javase/7/docs/api/java/io/DataInput.html#readInt%28%29)的文档）。

# c# - 向 DevExpress 菜单栏添加用户控件

> ID：12173487
> 
> 赞同：0
> 
> 时间：2012-08-29T08:13:19.007
> 
> 标签：c#, .net, winforms, user-controls, devexpress

我使用 C# .Net DevExpress 创建自己的用户控件。现在我可以在我所有的项目中使用这个控件，但我需要在 DexExpress.XtraBars.Bar 中使用它。我怎么能接受这个？我只能使用像Button，Check usw之类的baritems。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T04:35:24.043

您**不能**在 BarItem （[工具栏上的自定义控件](http://www.devexpress.com/Support/Center/p/S20141.aspx)）中使用 UserControl。但是您可以实现自定义编辑器并将其放入[BarEditItem](http://documentation.devexpress.com/#WindowsForms/clsDevExpressXtraBarsBarEditItemtopic)中。[您可以在自定义编辑器](http://documentation.devexpress.com/#WindowsForms/CustomDocument4716)帮助主题中找到附加信息。例如，您可以子类化现有编辑器之一（例如，ButtonEdit），并覆盖 Painter 和 ViewInfo 类。

另请查看以下知识库文章：[如何在 DevExpress 容器中以就地模式使用自定义控件](http://www.devexpress.com/Support/Center/p/A128.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:27:12.260

如果不知道你做了什么样的用户控制，很难说如何实现它。但我认为您不能将自定义用户控件添加到栏，但您可以创建自定义栏项。[这](http://www.devexpress.com/Support/Center/p/E2460.aspx)是一个例子。或者您可以尝试继承`BarItem`类，然后尝试添加到 bar。

# regex - 组合正则表达式

> ID：12173490
> 
> 赞同：0
> 
> 时间：2012-08-29T08:13:35.020
> 
> 标签：regex

我需要帮助来组合以下两个正则表达式：

```
1.ValidationExpression="[^\s]{5,12}" : (5-12 non-blank characters)
2.ValidationExpression="^[0-9]+$"    : (Only integers) 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T08:20:39.847

您只能允许 5-12 个这样的数字：

```
ValidationExpression="^\d{5,12}$" 
```

\d 代表 [0-9]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:21:25.743

我担心我可能会遗漏一些东西，但不会这样做

```
^[0-9]{5,12}$ 
```

# ldap - Shiro JndiLdapRealm 针对 LDAP 的授权

> ID：12173492
> 
> 赞同：5
> 
> 时间：2012-08-29T08:13:39.207
> 
> 标签：ldap, shiro

[Shiro 类 JndiLdapRealm](http://shiro.apache.org/static/current/apidocs/org/apache/shiro/realm/ldap/JndiLdapRealm.html)的JavaDoc明确指出默认情况下禁用授权，并且用户应通过子类化和覆盖该**[`JndiLdapRealm#doGetAuthorizationInfo`](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.shiro/shiro-core/1.2.2/org/apache/shiro/realm/ldap/JndiLdapRealm.java#JndiLdapRealm.doGetAuthorizationInfo%28org.apache.shiro.subject.PrincipalCollection%29)**方法来实现对 LDAP 服务器的授权。是否有关于如何做到这一点的示例代码，包括处理与任何地方可用的 LDAP 服务器的通信/协议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T20:57:31.643

您应该实现自己的 LdapRealm 扩展 JndiLdapRealm。在此实现中，您将覆盖 queryForAuthorizationInfo() ；这是一个简单的例子：

```
protected AuthorizationInfo queryForAuthorizationInfo(PrincipalCollection principals, LdapContextFactory ldapContextFactory) throws NamingException {

String username = (String) getAvailablePrincipal(principals);

// Perform context search
LdapContext ldapContext = ldapContextFactory.getSystemLdapContext();

Set<String> roleNames;

try {
  roleNames = getRoleNamesForUser(username, ldapContext);
} finally {
  LdapUtils.closeContext(ldapContext);
}

return buildAuthorizationInfo(roleNames);
}

protected AuthorizationInfo buildAuthorizationInfo(Set<String> roleNames) {
return new SimpleAuthorizationInfo(roleNames);
}

protected Set<String> getRoleNamesForUser(String username, LdapContext ldapContext) throws NamingException {
Set<String> roleNames;
roleNames = new LinkedHashSet<String>();

SearchControls searchCtls = new SearchControls();
searchCtls.setSearchScope(SearchControls.SUBTREE_SCOPE);

//SHIRO-115 - prevent potential code injection:
String searchFilter = "(&(objectClass=*)(CN={0}))";
Object[] searchArguments = new Object[]{ username };

NamingEnumeration answer = ldapContext.search(searchBase, searchFilter, searchArguments, searchCtls);

while (answer.hasMoreElements()) {
  SearchResult sr = (SearchResult) answer.next();

  if (log.isDebugEnabled()) {
    log.debug("Retrieving group names for user [" + sr.getName() + "]");
  }

  Attributes attrs = sr.getAttributes();

  if (attrs != null) {
    NamingEnumeration ae = attrs.getAll();
    while (ae.hasMore()) {
      Attribute attr = (Attribute) ae.next();

      if (attr.getID().equals("memberOf")) {

        Collection<String> groupNames = LdapUtils.getAllAttributeValues(attr);

        if (log.isDebugEnabled()) {
          log.debug("Groups found for user [" + username + "]: " + groupNames);
        }

        Collection<String> rolesForGroups = getRoleNamesForGroups(groupNames);
        roleNames.addAll(rolesForGroups);
      }
    }
  }
} 
```

# ios - MKAnnotation 在点击时没有响应

> ID：12173496
> 
> 赞同：2
> 
> 时间：2012-08-29T08:13:45.773
> 
> 标签：ios, ipad, ios5, mkmapview, mkannotationview

我在地图上显示几个图钉，如下所示：

```
for (int i = 0; i < points.count; i++) {
    if([[[points objectAtIndex:i] objectForKey:@"lat"] class] != [NSNull class]) {
        southWest.latitude = MAX(southWest.latitude , [[[points objectAtIndex:i] objectForKey:@"lat"] doubleValue]);
        southWest.longitude = MIN(southWest.longitude, [[[points objectAtIndex:i] objectForKey:@"lon"] doubleValue]);
        northEast.latitude = MIN(northEast.latitude, [[[points objectAtIndex:i] objectForKey:@"lat"] doubleValue]);
        northEast.longitude = MAX(northEast.longitude, [[[points objectAtIndex:i] objectForKey:@"lon"] doubleValue]);

        pin.latitude = [[[points objectAtIndex:i] objectForKey:@"lat"] doubleValue];
        pin.longitude = [[[points objectAtIndex:i] objectForKey:@"lon"] doubleValue];
        CarPin *cPin = [[CarPin alloc] initWithName:[[self.brain.cars objectAtIndex:i] objectForKey:@"name"] state:[self getStateStringFor:[[[points objectAtIndex:i] objectForKey:@"state"] intValue]] coordinate:pin];
        cPin.state = [[[points objectAtIndex:i] objectForKey:@"state"] intValue];
        cPin.carID = [[points objectAtIndex:i] objectForKey:@"objekt_id"];
        [self.mapView addAnnotation:cPin];
    }
}

CLLocation *locSouthWest = [[CLLocation alloc] initWithLatitude:southWest.latitude longitude:southWest.longitude];
CLLocation *locNorthEast = [[CLLocation alloc] initWithLatitude:northEast.latitude longitude:northEast.longitude];
CLLocationDistance meters = [locSouthWest distanceFromLocation:locNorthEast];

MKCoordinateRegion region;
region.center.latitude = (southWest.latitude + northEast.latitude) / 2.0;
region.center.longitude = (southWest.longitude + northEast.longitude) / 2.0;
region.span.latitudeDelta = meters / 111319.5;
region.span.longitudeDelta = 0.0;

[self.mapView setRegion:[self.mapView regionThatFits:region] animated:YES]; 
```

然后我像这样选择每个引脚的“外观”：

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {
static NSString *identifier = @"CarPin";
if ([annotation isKindOfClass:[CarPin class]]) {
    MKPinAnnotationView *annotationView = (MKPinAnnotationView *) [self.mapView dequeueReusableAnnotationViewWithIdentifier:identifier];
    if (annotationView == nil) {
        annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:identifier];
    } else {
        annotationView.annotation = annotation;
    }
    annotationView.enabled = YES;
    annotationView.canShowCallout = YES;
    annotationView.rightCalloutAccessoryView = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
    if (((CarPin *)annotation).state == 1) {
        annotationView.pinColor = MKPinAnnotationColorGreen;
    } else {
        annotationView.pinColor = MKPinAnnotationColorRed;
    }
    return annotationView;
}
return nil;
} 
```

我还设置了委托

```
[self.mapView setDelegate:self]; 
```

但是，当我点击每个图钉时，屏幕上没有显示带有详细信息的气泡！有没有人有同样的经历？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T02:30:06.110

仅仅实现`title`属性是不够的。
您必须确保它`title`没有返回`nil`或空白。
如果是，即使`canShowCallout`设置为，注释视图也不会显示标注`YES`。

与您的问题无关，但与此行有关：

```
region.span.latitudeDelta = meters / 111319.5; 
```

至少出于三个原因，不建议这样做，也没有必要这样做：

*   计算两个角之间的米距（您有纬度和经度的*度数*，然后将这些米转换回*度数*）是不必要的，因为`latitudeDelta`这`longitudeDelta`只是顶部/底部或左/右之间的度数差异。所以你所要做的就是：

    ```
    region.span.latitudeDelta = fabs(southWest.latitude - northEast.latitude); 
    ```

    这是我在您的情况下建议的更改。

*   将米转换为度 ( ) 所除以的值`111319.5`仅在赤道处准确。

*   如果要根据米指定区域，而不是手动计算跨度，使用内置[`MKCoordinateRegionMakeWithDistance`](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MapKitFunctionsReference/Reference/reference.html#//apple_ref/doc/uid/TP40008209-CH2-SW5)函数会更好、更容易：

    ```
    CLLocationCoordinate2D center = CLLocationCoordinate2DMake (lat, long);
    CLLocationDistance latMeters = 5000;  //5 km
    CLLocationDistance lonMeters = 5000;  //5 km
    MKCoordinateRegion region 
        = MKCoordinateRegionMakeWithDistance (center, latMeters, lonMeters); 
    ```

此外，在您的情况下，调用`regionThatFits`是不必要的，因为`setRegion`无论您通过什么区域，它都会自行执行此操作。`regionThatFits`当您想知道（而不实际更改区域）地图视图会将区域调整为给定特定区域时，使用该方法。

# jsp - 如何理解和分析网站源代码

> ID：12173497
> 
> 赞同：0
> 
> 时间：2012-08-29T08:13:47.697
> 
> 标签：jsp, jakarta-ee, web

我必须进行维护并向客户网站添加一些代码（jsp、js 等中的数百个源文件），但首先我有两周的时间来了解它是如何工作的。源代码不包含注释，但它是有组织的。但是，有很多文件要经过。

总的来说，我和一些中型网站合作过，我理解源代码的方法是：

1.  理解接口（vue）
2.  从首页开始分析源代码并发表评论

但是这个网站真的很大，不知道有没有更好的方法或技术来理解它，或者有没有可以帮助的软件（报告？），或者在线教程。

我正在寻找任何可以帮助我提高效率和快速分析源代码的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T13:38:16.893

你很幸运——有一[本书](http://www.amazon.co.uk/Working-Effectively-Legacy-Robert-Martin/dp/0131177052)你可以买！

以我的经验，一旦你进入大型项目，你需要得到一些帮助......

首先，安装[Sonar](http://www.sonarsource.org/)并对其进行配置以检查项目。它提供了代码库的高级概述，并突出显示了看起来有风险的区域 - 在接管代码库时，重要的是要知道你是在看一个设计良好的应用程序，还是一堆獾粪便。尽管静态分析是一种非常生硬的工具，并且在许多情况下可能会出错，但这是一个很好的开始。如果您看到“规则合规性”低于 75% 左右，请奔向山坡。

我会花大量时间查看声纳分析，并可能根据您的发现使用插件添加一些额外的报告。

接下来，我将确保我完全了解构建和部署过程。大多数时候，您可以弄清楚代码的作用，即使它有点疯狂 - 但部署通常是巫术，有许多令人兴奋的失败模式。获得一个测试环境，并确保您可以从头开始编译和部署应用程序——这确实是了解移动部件的最佳方式。

当你这样做的时候，建立你自己的版本控制系统、持续集成环境等是有意义的。

最后，你能找到的任何类型的测试信息都是一个巨大的帮助——无论是自动化的（Junit、Selenium 等），甚至是测试脚本的形式。毕竟，如果您不知道会发生什么，您如何知道应用程序是否按预期工作？如果您没有任何测试，我强烈建议您从编写自己的单元测试开始。这是掌握其他人代码的绝妙方法——如果你因为某种原因不能编写单元测试，这通常是寻找新工作的另一个迹象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:19:37.553

您可以利用 web 开发工具，如 firebug、F12 开发者工具等，来检查、编辑和监控 CSS、HTML、JavaScript 等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:20:23.763

给自己买一个 IDE，Dreamweaver 需要花钱，但其他的像 aptana 是免费的。它们将允许您查看文件夹结构并使代码更具可读性。不要认为有其他方法，只需要继续浏览网站，看看以前的开发人员是如何做事的，希望他们有某种标准的做事方式

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T13:30:46.587

你应该记住，你不需要知道每段代码是如何工作的，你只需要知道你需要知道什么——可以这么说。

我的意思是，例如，如果您的客户要求您在他的网站上添加公告板，那么您无需花费数天时间挖掘他的 JavaScript 文件来“弄清楚它们在做什么”。您只需要充分了解他的环境，就可以知道如何设置公告板，然后继续前进。

同样，如果他想让你创建一个联系我们的表单并且他的页面是用 PHP 完成的，那么你不需要知道今天每段 PHP 代码是如何在网站上运行的，你只需要知道如何创建一个邮件表单在 PHP 中并将其包含到站点中。

作为更高级的说明，如果您要在此站点上进行维护，我强烈建议将文件置于[Revision Control](http://en.wikipedia.org/wiki/Revision_control)之下。基本上，这些系统可以帮助您管理对代码所做的更改。几天、几周、几个月或（希望对你来说）几年，发生了很多变化，很高兴能够看到你如何以及为什么改变了事情。

就软件而言，这完全取决于偏好，但我使用[NetBeans IDE](http://netbeans.org/)作为我的 IDE，使用[TortoiseHg](http://tortoisehg.bitbucket.io/)进行修订控制。

# javascript - 如何为给定对象附加标签列表

> ID：12173502
> 
> 赞同：0
> 
> 时间：2012-08-29T08:14:01.313
> 
> 标签：javascript, jquery, underscore.js

我有以下用例

HTML 输入：

```
<div class='controls'>
</div> 
```

* * *

我的 javascript 代码不起作用

```
var errors = ['error1', 'error2'];
inputElement.closest('.controls')
    .append($('<span/>').text(errors).addClass('error-message')); 
```

* * *

输出应该是：

```
<div class='controls'>
     <span class='error-message'>error1</span>
     <span class='error-message'>error</span>
</div> 
```

* * *

任何想法如何完成这项任务？
PS：我可以使用下划线和jquery

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:17:43.927

这会起作用：

```
var errors = ['errors1', 'errors2'];

$.each(errors, function() {
    $("<span>", { text : this, class : "error-message" }).appendTo("div.controls);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:18:13.467

```
_.each(errors, function(e){
  inputElement.closest('.controls')
    .append($('<span>').text(e).addClass('error-message'));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:18:18.303

```
$('.controls')
  .append( $('<span>').addClass('error-message').text(errors[0]) )
  .append( $('<span>').addClass('error-message').text(errors[1]) ); 
```

# machine-learning - 如何在 Giza++ 中进行训练和测试步骤？

> ID：12173503
> 
> 赞同：31
> 
> 时间：2012-08-29T08:14:01.253
> 
> 标签：machine-learning, nlp, giza++

在人工智能方法中，我们有两个训练阶段。这些阶段是数据和测试。

在训练阶段，我们向系统提供大量数据，我们通常用较小的数据量对其进行测试。然后我们评估输出。

现在的问题是这种培训可以通过嵌入在 GIZA++ 中的内置功能来完成，还是我们应该为此编写一个单独的应用程序？

如果我们应该编写一个单独的应用程序，任何人都可以通过建议一个已经编写的应用程序来帮助我吗？还是说明书？注意：我想要一个对齐程序而不是统计机器翻译

我更愿意在 Giza++ 中训练，这样我就可以使用未观察到的数据进行测试。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-09T11:21:16.830

[这应该是使用Moses](http://www.statmt.org/moses/?n=Moses.Baseline)训练基线 mt 系统的一个很好的起点。
通常 GIZA++ 用于对平行语料库进行字对齐。
您将需要一些其他工具，例如 IRSTLM、SRILM 或 KenLM 来进行语言模型估计。

# sql - 从字符串到类型“Double”的转换无效

> ID：12173505
> 
> 赞同：-1
> 
> 时间：2012-08-29T08:14:05.837
> 
> 标签：sql, vb.net

我正在尝试以下代码，但出现以下错误：

`ex = {"Conversion from string "INSERT INTO d009040 (LBRCODE,ENT" to type 'Double' is not valid."}`.

请帮忙。到目前为止，我可以处理更长的 SQL 查询。:(

```
Dim cmd3 As New OracleCommand
                cmd3.Connection = conn
                Dim timepara As String = Now.Hour & Now.Minute & Now.Second & Now.Millisecond
                cmd3.CommandText = "INSERT INTO d009040 (LBRCODE,ENTRYDATE,BATCHCD,SETNO,SCROLLNO,MAINSCROLLNO,POSTDATE,FEFFDATE,ACTIVITYTYPE,CASHFLOWTYPE,VALUEDATE,BOOKTYPE,DRCR,VCRACCTID,MAINACCTID,MAINMODTYPE,VCRMODTYPE,TRNCURCD,FCYTRNAMT,LCYCONVRATE,LCYTRNAMT,INSTRBANKCD,INSTRBRANCHCD,INSTRTYPE,INSTRNO,INSTRDATE,TOKENNO,PARTICULARS,SYSGENVCR,SHTOTFLAG,SHCLRFLAG,ACTOTFLAG,ACCLRFLAG,MAKER,MAKERDATE,MAKERTIME,CHECKER1,CHECKER2,CHECKER3,CHECKER4,CHECKERDATE,CHECKERTIME,NOAUTHPENDING,NOAUTHOVER,POSTFLAG,AUTHFLAG,FEFFFLAG,CANCELEDFLAG,POSTAUTHFEFFCNCL,UPDTCHKID,PARTCLEARAMT,POSTTIME) VALUES ('" + lbr + "','" + datepara + "','TR-MOBDS','" + k + "','" + k + "','" + k + "','" + datepara + "','" + datepara + "','CR','CR','" + datepara + "','ZZ','C','" + internalaccount + "','" + internalaccount + "','47','47','INR','" + amount + "','1','" + amount + "','0','0','99','000000000000','" + datepara + "','0','DDS CR. From Agent','1','Y','Y','Y','Y','0','" + datepara + "','" + timepara + "','0','0','0','0','" + datepara + "','" + timepara + "','0','1','P','A','F','0','0','0','0','" + timepara + "')"
                cmd3.CommandType = CommandType.Text
                cmd3.ExecuteNonQuery() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:17:16.957

这意味着您在 SQL 中提供的值之一不能转换为相应字段所需的双精度类型。

在不知道 a) 您的输入和 b) 您的数据结构的情况下，我们无法告诉您是哪一个。

您还应该使用参数化查询进行研究。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:24:51.393

您传递的所有值都包含在单引号内 - 因此 sql server 将它们视为字符串。例如：'string','23' = 都是字符串。

如果表需要一个字符串和 23 作为双精度值，那么您的 VALUES 将是 VALUES('string',23)

因此，您需要正确匹配您的许多列类型要求。

正如其他张贴者所说 - 使用参数化查询重写它可能更容易，当然也更易于维护。

编辑：哦-您正在使用oracle。我的错。values-as-strings 的问题可能是相同的，所以我将保留这篇文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T08:26:14.067

您应该真正使用[`Parameters`](http://msdn.microsoft.com/en-us/library/system.data.oracleclient.oracleparameter.aspx)以避免 SQL-Injection 和此类错误。

例如：

```
Using con = New OracleConnection(connectionString)
    Dim sql = "INSERT INTO d009040 (LBRCODE,ENTRYDATE,BATCHCD,SETNO,SCROLLNO,MAINSCROLLNO,POSTDATE,FEFFDATE,ACTIVITYTYPE,CASHFLOWTYPE,VALUEDATE,BOOKTYPE,DRCR,VCRACCTID,MAINACCTID,MAINMODTYPE,VCRMODTYPE,TRNCURCD,FCYTRNAMT,LCYCONVRATE,LCYTRNAMT,INSTRBANKCD,INSTRBRANCHCD,INSTRTYPE,INSTRNO,INSTRDATE,TOKENNO,PARTICULARS,SYSGENVCR,SHTOTFLAG,SHCLRFLAG,ACTOTFLAG,ACCLRFLAG,MAKER,MAKERDATE,MAKERTIME,CHECKER1,CHECKER2,CHECKER3,CHECKER4,CHECKERDATE,CHECKERTIME,NOAUTHPENDING,NOAUTHOVER,POSTFLAG,AUTHFLAG,FEFFFLAG,CANCELEDFLAG,POSTAUTHFEFFCNCL,UPDTCHKID,PARTCLEARAMT,POSTTIME) VALUES (:LBRCODE,:ENTRYDATE,:BATCHCD,:SETNO,:SCROLLNO,:MAINSCROLLNO,:POSTDATE,:FEFFDATE,:ACTIVITYTYPE,:CASHFLOWTYPE,:VALUEDATE,:BOOKTYPE,DRCR,:VCRACCTID,:MAINACCTID,:MAINMODTYPE,:VCRMODTYPE,:TRNCURCD,:FCYTRNAMT,:LCYCONVRATE,:LCYTRNAMT,:INSTRBANKCD,:INSTRBRANCHCD,:INSTRTYPE,:INSTRNO,:INSTRDATE,:TOKENNO,:PARTICULARS,:SYSGENVCR,:SHTOTFLAG,:SHCLRFLAG,:ACTOTFLAG,:ACCLRFLAG,:MAKER,:MAKERDATE,:MAKERTIME,:CHECKER1,:CHECKER2,:CHECKER3,:CHECKER4,:CHECKERDATE,:CHECKERTIME,:NOAUTHPENDING,:NOAUTHOVER,:POSTFLAG,:AUTHFLAG,:FEFFFLAG,:CANCELEDFLAG,:POSTAUTHFEFFCNCL,:UPDTCHKID,:PARTCLEARAMT,:POSTTIME)"
    Using cmd = New OracleCommand(sql, con)
        con.Open()
        cmd.Parameters.AddWithValue(":LBRCODE", LBRCODE)
        ' add the other parameters as well ... '
        dim result = cmd.ExecuteNonQuery()
    End Using
End Using 
```

请注意，我已经很久没有使用 oracle 了，所以可能有问题，但我希望你能理解它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:16:22.770

既然你正在使用`VBNET`，你可以使用这个类`CONVERT`

前任。

```
Dim x AS Double = Convert.ToDouble(45) 
```

或者

```
Dim x AS Double = CDBL(45) 
```

# google-maps - 谷歌地图 v3：如何强制重新加载瓷砖

> ID：12173508
> 
> 赞同：2
> 
> 时间：2012-08-29T08:14:18.903
> 
> 标签：google-maps, google-maps-api-3

我遇到了非常烦人的问题。我开始用较慢的互联网连接测试我的谷歌地图代码，它不再像想象的那样工作了。

问题是我`"tilesloaded"`在地图上做动画时正在监听事件，但是因为连接速度很慢，一些图块可能会挂起并且不加载。地图中间会有灰色图块，我的程序不会继续，因为它等待它被加载。

我用萤火虫控制台捕捉错误，它说：

图片损坏或截断：[https ://mts0.googleapis.com/vt?lyrs=m@183000000&src=apiv3&hl=fi-FI&x=18706&y=8527&z=15&s=Galil&style=api%7Csmartmaps](https://mts0.googleapis.com/vt?lyrs=m@183000000&src=apiv3&hl=fi-FI&x=18706&y=8527&z=15&s=Galil&style=api%7Csmartmaps)

我将其粘贴到浏览器并从那里找到丢失的平铺图像。该死！它存在但有时不加载:)

所以问题是**我如何**在一段时间后强制重新加载丢失的图块或所有图块，据我所知，如果某些图块无法加载，则不会触发此类事件？似乎并不总是给出控制台出现的错误。我也尝试使用`"idle"`谷歌地图的事件，但它不会等待加载瓷砖，并且会使程序继续滞后。（不是我想要的。）

我也在使用`google.maps.event.trigger(my_map, 'resize');`，但它似乎没有帮助。

**编辑：**

刷新整页不是一个选项，因为我会丢失我的变量值等。而且这种缓慢的加载很难测试，但是当平移到地图上的某个特定点时会发生，到目前为止需要重新加载图块。

有任何想法吗？提前谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-28T22:25:53.323

在 javascript 地图中响应浏览器调整大小，并加载丢失的图块，所以您需要的只是触发浏览器事件“调整大小”

```
var evt = document.createEvent('UIEvents');
evt.initUIEvent('resize', true, false,window,0);
window.dispatchEvent(evt); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T09:48:40.357

There is no access to the base maps in the V3 API, so all you can do is to destroy your map object (`map = null`) and create a new identical one. The tiles that were successfully downloaded should still be in the browser's cache.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T04:04:39.683

首先，这听起来像是一个错误（如果它们超时，API 应该重试获取磁贴）。[请在问题跟踪器](http://code.google.com/p/gmaps-api-issues)上归档。

您可能可以通过通知地图对 mapTypeId 属性的更改来触发刷新。

`google.maps.event.notify(map, 'mapTypeId')`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-16T08:20:25.297

是的，您绝对可以使用`map.setZoom(0)`. 当我适应新的界限时，我使用这个函数来强制我的图块重绘：

`export function setBounds(bounds) { map.setZoom(0); // forces tiles to invalidate google.maps.event.addListenerOnce(map, 'idle', () => map.fitBounds(bounds)); }`

我这样做是因为我不喜欢库默认使用的平滑缩放效果。

# ruby - 在 Amazon Linux 上安装 ruby 时出错

> ID：12173511
> 
> 赞同：1
> 
> 时间：2012-08-29T08:14:40.093
> 
> 标签：ruby, rvm, yaml

早上好，我在 Amazon EC2 实例上使用 rvm 安装 ruby​​ 时遇到问题。我正在使用 capistrano 进行安装，但我可以通过 ssh 登录并手动执行这些步骤来重现它：

```
export CURL_HOME=${TMPDIR:-${HOME}}/.rvm-curl-config; mkdir ${CURL_HOME}/; { [[ -r ${HOME}/.curlrc ]] && cat ${HOME}/.curlrc; echo \"silent\"; echo \"show-error\"; } > $CURL_HOME/.curlrc ; curl -L get.rvm.io | bash -s stable --path $HOME/.rvm/; rm -rf $CURL_HOME
$HOME/.rvm/bin/rvm pkg install openssl
$HOME/.rvm/bin/rvm install ruby-1.9.3-p194 -j $(cat /proc/cpuinfo | grep vendor_id | wc -l) --with-opensll-dir=$HOME/.rvm/usr 
```

安装 RVM，安装 ruby​​ 包的 openssl，安装 ruby​​。第三步的结果是：

```
Fetching yaml-0.1.4.tar.gz to /home/ec2-user/.rvm/archivesExtracting yaml-0.1.4.tar.gz to /home/ec2-user/.rvm/src
Prepare yaml in /home/ec2-user/.rvm/src/yaml-0.1.4.
Error running 'autoreconf -is --force', please read /home/ec2-user/.rvm/log/ruby-1.9.3-p194/yaml/autoreconf.log 
```

日志文件的内容是：

```
configure.ac:56: error: possibly undefined macro: AC_PROG_LIBTOOL
      If this token and others are legitimate, please use m4_pattern_allow.
      See the Autoconf documentation.
autoreconf: /usr/bin/autoconf failed with exit status: 1 
```

libtool 已安装：

```
sudo yum install libtool
...
Package libtool-2.2.10-1.8.amzn1.x86_64 already installed and latest version 
```

更新：也安装了 m4 autoconf automake：

```
sudo yum install m4 autoconf automake
... 
Package m4-1.4.13-5.8.amzn1.x86_64 already installed and latest version
Package autoconf-2.63-5.1.7.amzn1.noarch already installed and latest version
Package automake-1.11.1-2.9.amzn1.noarch already installed and latest version
Nothing to do 
```

我该如何解决这个问题？为什么上周同样的安装工作？任何指针高度赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:34:37.420

这是亚马逊实例的问题。安装 gcc，拍摄该实例的映像并重新启动后，该实例以某种方式损坏。`gcc -v`导致没有输出，并且 yaml 配置脚本抱怨编译器无法生成可执行文件。当我手动设置服务器时，红宝石安装。

# java - 使图像适合打印区域

> ID：12173515
> 
> 赞同：1
> 
> 时间：2012-08-29T08:15:06.713
> 
> 标签：java, printing, jpanel

我需要用 Java 打印图像。所以我实现`print()`了`Printable`接口的方法。但是打印机总是只打印一些原始图像。如何使图像适合打印区域（A4），以便打印机能够打印整个图像，而不是其中的一部分？现在我的代码如下所示：

```
public int print(Graphics graphics, PageFormat pageFormat, int pageIndex) throws PrinterException {

    if (pageIndex >= images.size()) {
        return Printable.NO_SUCH_PAGE;
    }
    RenderedImage image;

    Graphics2D graphics2D = (Graphics2D) graphics;

    image = new NullOpImage((RenderedImage) images.get(pageIndex), null, null, OpImage.OP_IO_BOUND);

    double x = (pageFormat.getImageableWidth() - image.getWidth())/2 + pageFormat.getImageableX();
    double y = (pageFormat.getImageableHeight() - image.getHeight())/2 + pageFormat.getImageableY();

    graphics2D.drawRenderedImage(image, AffineTransform.getTranslateInstance(x, y));

    return PAGE_EXISTS;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T09:07:19.087

您需要缩小图像以适合可用区域。

```
private int currentPage = -1;
private Image cachedScaledImage = null;

public double getScaleFactor(int iMasterSize, int iTargetSize) {
    double dScale = 1;
    if (iMasterSize > iTargetSize) {
        dScale = (double) iTargetSize / (double) iMasterSize;
    } else {
        dScale = (double) iTargetSize / (double) iMasterSize;
    }
    return dScale;
}

public double getScaleFactorToFit(BufferedImage img, Dimension size) {
    double dScale = 1;
    if (img != null) {
        int imageWidth = img.getWidth();
        int imageHeight = img.getHeight();
        dScale = getScaleFactorToFit(new Dimension(imageWidth, imageHeight), size);
    }
    return dScale;
}

public double getScaleFactorToFit(Dimension original, Dimension toFit) {
    double dScale = 1d;
    if (original != null && toFit != null) {
        double dScaleWidth = getScaleFactor(original.width, toFit.width);
        double dScaleHeight = getScaleFactor(original.height, toFit.height);

        dScale = Math.min(dScaleHeight, dScaleWidth);
    }
    return dScale;
}

public int print(Graphics graphics, PageFormat pageFormat, int pageIndex) throws PrinterException {

    if (pageIndex >= images.size()) {
        return Printable.NO_SUCH_PAGE;
    }
    RenderedImage image;

    Graphics2D graphics2D = (Graphics2D) graphics;

    int width = (int)Math.round(pageFormat.getImageableWidth());
    int height = (int)Math.round(pageFormat.getImageableHeight());

    if (currentPage != pageIndex || cachedScaledImage == null) {
        currentPage = pageIndx;    

        image = new NullOpImage((RenderedImage) images.get(pageIndex), null, null, OpImage.OP_IO_BOUND);

        BufferedImage imageCopy = new BufferedImage(image.getWidth(), image.getHeight(), BufferedImage.TYPE_INT_ARGB);
        Graphics2D g2d = imageCopy.createGraphics();
        g2d.drawImage(imageCopy, 0, 0, null);
        g2d.dispose();

        double scaleFactor = getScaleFactorToFit(new Dimension(image.getWidth(), image.getHeight()), new Dimension(width, height));

        int imageWidth = (int)Math.round(image.getWidth() * scaleFactor);
        int imageHeight = (int)Math.round(image.getHeight() * scaleFactor);

        double x = ((pageFormat.getImageableWidth() - imageWidth) / 2) + pageFormat.getImageableX();
        double y = ((pageFormat.getImageableHeight() - imageHeight) / 2) + pageFormat.getImageableY();

        cachedScaledImage = imageCopy.getScaledInstance(imageWidth, imageHeight, Image.SCALE_SMOOTH);

    }

    graphics2D.drawRenderedImage(cachedScaledImage, AffineTransform.getTranslateInstance(x, y));

    return PAGE_EXISTS;
} 
```

# iphone - 在静态 UITableView 中添加新部分

> ID：12173516
> 
> 赞同：2
> 
> 时间：2012-08-29T08:15:06.817
> 
> 标签：iphone, ios, uitableview

我有一个表格视图，它是在情节提要中创建的。包含在里面的单元格被称为“静态单元格”。

现在，我想在 tableview 的末尾引入一个新部分（即添加一些动态单元格），我不知道该怎么做。

你们中有人知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T07:41:29.930

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return actualSection+1;
} 
```

每当您添加带有更新的新部分`actualSection`或在数组中添加对象（您用于表）时，请重新加载您的表

# entity-framework - EntityFramework 创建额外的列

> ID：12173517
> 
> 赞同：1
> 
> 时间：2012-08-29T08:15:11.953
> 
> 标签：entity-framework

我有以下课程：

```
public partial class User
{
    [Key]
    public int UserId { get; set; }
    public string Username { get; set; }
    [ScriptIgnore]
    public virtual ICollection<Subscription> Followers { get; set; }
    [ScriptIgnore]
    public virtual ICollection<Subscription> Following { get; set; }
}

public partial class Subscription
{
    [Key]
    public int SubscriptionId { get; set; }
    public virtual User Follower { get; set; }
    public virtual User Followed { get; set; }
    public int status { get; set; }
} 
```

users 表生成正常，但 Subscriptions 表如下所示：

```
Subscriptions( SubscriptionId, status, Follower_UserId, Followed_UserId, 
User_UserId, User_UserId1 ) 
```

这最后两列不是必需的，它们实际上是 NULL 值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:19:52.100

尝试使用这个：

```
public partial class Subscription
{
    [Key]
    public int SubscriptionId { get; set; }
    [InverseProperty("Followers")]
    public virtual User Follower { get; set; }
    [InverseProperty("Following")]
    public virtual User Followed { get; set; }
    public int status { get; set; }
} 
```

# ios - 使用 Trigger.io 检测 iOS 状态栏上的点击

> ID：12173518
> 
> 赞同：1
> 
> 时间：2012-08-29T08:15:14.530
> 
> 标签：ios, trigger.io

我想为使用自定义滚动的 Trigger.io 应用程序实现“点击状态栏以滚动到顶部”。是否有任何方法（例如事件）来检测此水龙头是否是未来计划的类似功能？

![iPod 状态栏](../Images/522888434730d5903b14efe9b01d806d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:21:18.157

根据 trigger.io [api 文档](http://docs.trigger.io/en/v1.4/index.html)-**没有**。希望有一天我们能够编写插件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-06-15T07:50:00.860

你可以尝试模仿这个cordova的插件： [https ://github.com/welldone-software/cordova-statusTap](https://github.com/welldone-software/cordova-statusTap)

# driver - 我可以在不安装额外驱动程序的情况下使用 pyusb 与我的 USB 设备通信吗

> ID：12173519
> 
> 赞同：1
> 
> 时间：2012-08-29T08:15:14.923
> 
> 标签：driver, libusb, pyusb

我想开发一个便携式 USB 设备。现在我想使用 Pyusb 与这个设备进行通信。我在 Windows 7 下使用 python 2.7，并安装了一个后端（我选择 libusb-win32），它将安装自己的驱动程序。我是USB和pyusb的新手，所以我想知道是否没有驱动程序，我可以与这个设备通信，这个设备可以与干净的PC通信。

非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T22:43:18.677

您可能已经想到了这一点，但答案是“是”：使用 libusb / PyUSB 您可以与 USB 设备进行交互，而无需专用驱动程序。但是，您必须在用户空间中执行任何协议处理。

# java - FilenameFilter，搜索文件夹

> ID：12173521
> 
> 赞同：4
> 
> 时间：2012-08-29T08:15:27.060
> 
> 标签：java, android

我有这个实现的类`FilenameFilter`

```
package Logic;

 import java.io.File;
 import java.io.FilenameFilter;

public class Filter implements FilenameFilter {

 String name; 

 public Filter(String name) {
    this.name = name; 

 }
 @Override
 public boolean accept(File dir, String filename) {
    return name.contains("bluetooth");
 }
} 
```

我在这个方法中使用这个类：

```
public String searchForBluetoothFolder() {

    String folderNameToSearchFor = "bluetooth";
    File root = sdCard; 
    FilenameFilter filter = new Filter(folderNameToSearchFor);  

    String[] bluetoothFolder = root.list(filter);

    for(int i = 0; i < bluetoothFolder.length; i++) {
        Log.i("Bluetooth: ", bluetoothFolder[i]); 
    }

    return "";
} 
```

在 for 循环中，输出只是根目录中的**所有**文件，而不是那些以蓝牙为名称的文件。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T08:22:15.580

这是因为您正在检查是否`name`包含“蓝牙”而不是是否包含“蓝牙”`fileName`这个词

`return name.contains("bluetooth");`应该改为 `return filename.contains("bluetooth");`

但是，通过您尝试实现的方式，将其更改为，`return filename.contains(name);`以便您确实检查您是否`fileName`包含`name`您指定的内容。

另请记住，“蓝牙”的评估可能与`contains()`“蓝牙”或“蓝牙”不同。如果你想要不区分大小写的搜索，那么我会建议`standardize`你的名字。设置`name`为小写并使用`filename.toLowerCase().contains(name.toLowerCase())`. 就像是：

```
public class Filter implements FilenameFilter {
 String name; 

 public Filter(String name) {
    this.name = name; 

 }
 @Override
 public boolean accept(File dir, String filename) {
    //If you want to perform a case-insensitive search
    return filename.toLowerCase().contains(name.toLowerCase());
 }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:20:35.663

您正在调用包含在属性名称中的方法，而是在参数文件名中调用它。您还应该从方法中删除文字字符串，如下所示：

```
filename.contains(name) 
```

这样您就可以使用为它创建的属性，并且可以在其他情况下重用该类。这同样适用于 searchForBluetoothFolder 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T08:23:40.217

```
FileFilter folderFilter = new FileFilter() {
    @Override
    public boolean accept(File file) {
        return file.isDirectory() && file.getName().contains("bluetooth");
    }
};

File[] files = f.listFiles(folderFilter); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T08:24:54.223

```
package Logic;

 import java.io.File;
 import java.io.FilenameFilter;

public class Filter implements FilenameFilter {

 String name; 

 public Filter(String name) {
    this.name = name; 

 }
 @Override
 public boolean accept(File dir, String filename) {
    return filename.contains("bluetooth");
 }
} 
```

# javascript - 添加破坏 html 的字符以输入

> ID：12173522
> 
> 赞同：1
> 
> 时间：2012-08-29T08:15:35.107
> 
> 标签：javascript, jquery

如何将其添加到 html 文本输入中。

```
var s = '>>>>>>>  """""""""""""'; 
```

如何转义这些字符，以免破坏 HTML

```
var addMe = '<input type="text" value="' + s + '" />'; 
```

这是用jquery动态添加时的样子

```
<input type="text" ??="" value=""/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T08:29:11.723

用于`.attr('value', ...)`将任意文本添加到元素的值，而无需对其进行转义。

# javascript - 传递信息虽然另一个按钮onclick？

> ID：12173524
> 
> 赞同：1
> 
> 时间：2012-08-29T08:15:37.183
> 
> 标签：javascript, html, asp.net-mvc

我对 MVC 和 Web 开发非常陌生。我需要传递一个我已经拥有的令牌，然后是我试图下车的文件名和文件，`<input type="file" id="theFile"/>`然后还需要日期。一旦我可以将这些信息输入 Home 控制器，我就可以使用 C#，然后我就知道发生了什么。但目前我不确定我是否走在正确的道路上。

我如何通过按钮将这些值传递给控制器​​？

在我看来：

```
<input type="file" id="theFile"/>
<br>
<button type="button" onclick="Upload(token = Model.Token, fileName = theFile.Value.tostring(), modDate = date.now, file = theFile.value);" >Upload file to the website</button> 
```

在 HomeControler 中：

```
 public ActionResult Upload(string token, string filename, string moddate, object file)
            {

            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:27:20.600

您不会直接从 HTML 调用控制器的操作方法。如果您要上传数据，执行此操作的标准方法是将表单发布到服务器。

因此，您的视图中有一个文件输入，看起来您可能需要一个包含令牌的隐藏字段，或者从 cookie 中获取它，这取决于您的实现。

你要确保你有一个`<form>`在你的视野中；在 MVC 中你会做类似的事情

```
@using (Html.BeginForm("yourControllerName", "Upload"))
{
   all your form elements here
} 
```

最后为您的操作方法添加一个`[HttpPost]`属性。`Upload`MVC 将负责将您的表单元素映射到`Upload`的参数。

# c# - 无法引用以恒定大小封送为非托管的数组

> ID：12173525
> 
> 赞同：0
> 
> 时间：2012-08-29T08:15:39.377
> 
> 标签：c#, arrays, ref

当我创建一个具有恒定大小的数组时，我试图了解幕后发生的事情，如下所示：

```
[MarshalAs(UnmanagedType.ByValArray, SizeConst = 10)]
public float[] constArray; 
```

我知道我可以使用`fixed`关键字，但`ref`不再是选项，并且所有指针操作都必须在固定表达式内。

我要做的是解析一个 XML 文件并存储在数组中的给定索引处。因此，如果文件中有 10 个元素，我可能会设置以下内容：

```
for (int i = 0; i < 10; i++)
{
    readElement("element", ref constArray[i]);
} 
```

然而，`constArray[i]`是`null`。

也许需要进一步的实例化，但是编组的意义何在。我认为编组创建了`ref`用于创建引用的对象。

我通读了[引用类型](http://msdn.microsoft.com/en-us/library/490f96s2.aspx)和[值类型](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)，但没有找到太多信息。我还阅读了其他一些内容，例如[ref](http://msdn.microsoft.com/en-us/library/14akc2c7.aspx)和[引用数组](http://msdn.microsoft.com/en-us/library/szasx730.aspx)，但进展不大。

我似乎可以找到一个提供良好概念理解的资源。因此，我们将不胜感激任何资源以及答案。

谢谢你，布莱克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:32:24.533

首先 -`float`不能为空（如果你想要可以为空的浮点数然后使用`float?`），所以你的问题可能出在未初始化的数组中？

总括[`MarshalAs`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)

> 指示如何在托管代码和非托管代码之间封送数据。

那是你要的吗？或者您的目标是否简单如下

```
float [] constArray = new float[10]; 
```

你确定你需要简单的数组 - 为什么不使用`List<float>`？

# javascript - 当onclick事件正在执行后面的代码时，如何在ImageButton上设置加载gif

> ID：12173526
> 
> 赞同：0
> 
> 时间：2012-08-29T08:15:44.080
> 
> 标签：javascript, onclick, loading, code-behind

我对 web 开发相当陌生，我似乎无法显示加载 gif，而我正在执行导出后面的代码。

我的 onclick 事件位于 gridview 内的 Imagebutton 上。你能帮我么？在这里，我有 ImageButtons：

```
<HeaderTemplate>
      <asp:ImageButton ID="btnExport"  OnClick="btnExport_Click" runat="server" ImageUrl="~/Images/excel.gif"  AlternateText="Export top records!"/>
      <asp:ImageButton ID="btnExportRed"   OnClick="btnExportRed_Click" runat="server" ImageUrl="~/Images/excel_red.gif"  AlternateText="Export all records!"/>
 </HeaderTemplate> 
```

这是我背后的代码：

```
protected void btnExport_Click(object sender, EventArgs e)
 {
    try
    {
        LoadWaitImage();

          [functional code]

      UnloadWaitImage();
    }
    catch (Exception ex)
    {
        lblMessage.Text = ex.Message;
        upnlMsg.Update();
       UnloadWaitImage();
    }
}

private void LoadWaitImage()
 {
    ScriptManager.RegisterClientScriptBlock(this.Page, this.GetType(), "showMyImage", "hideLoading()", true);
 }

private void UnloadWaitImage()
{
    ScriptManager.RegisterClientScriptBlock(this.Page, this.GetType(), "showMyImage", "hideLoading()", true);
} 
```

和要触发的js：

```
function showLoading() 
{
   document.getElementById('lblMessage').value = "";
   document.getElementById('ucMarketing_btnSearch').disabled = true;
   document.getElementById('btnClearFilters').disabled = true;
   document.getElementById('imgSaveToSegments').disabled = true;
   document.getElementById('divLoadingImg2').style.display = "";
 }
function hideLoading()
{
  document.getElementById('ucMarketing_btnSearch').disabled = false;
  document.getElementById('btnClearFilters').disabled = false;
  document.getElementById('imgSaveToSegments').disabled = false;
  document.getElementById('divLoadingImg2').style.display = "none";
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:46:49.507

我认为你目前的想法不会奏效。呈现 HTML 的客户端浏览器与运行代码隐藏的服务器完全分离。单击 ImageButton 时，浏览器会将您的 HTML 表单同步发布到服务器，并等待响应。此响应将在您的事件处理程序方法结束后的某个时间发送。

如果你想在客户端做一些事情（比如显示和隐藏图像），你将需要使用 AJAX 异步做一些事情。ASP.Net WebForms 通过控件使这变得非常容易[`UpdatePanel`](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.aspx)。

要使其正常工作，您将使用 UpdatePanel 控件包围要*更改的页面区域。*然后添加一个或多个要引起更新的触发器。最后使用[`UpdateProgress`](http://msdn.microsoft.com/en-us/library/system.web.ui.updateprogress.aspx)控件显示您的加载图像。像这样的东西：

```
<asp:GridView runat="server">
   ...
   <HeaderTemplate>
      <asp:ImageButton ID="btnExport" OnClick="btnExport_Click" runat="server" 
            ImageUrl="~/Images/excel.gif"  AlternateText="Export top records!"/>
      <asp:ImageButton ID="btnExportRed" OnClick="btnExportRed_Click" runat="server"
            ImageUrl="~/Images/excel_red.gif"  AlternateText="Export all records!"/>
   </HeaderTemplate>
</asp:GridView>

<asp:UpdatePanel ID="Update" runat="server">
   <asp:UpdateProgress ID="Progress" runat="server">
      <ProgressTemplate>
         <!-- HTML/ASP for your image -->
      </ProgressTemplate>
   </asp:UpdateProgress>
   <Triggers>
      <asp:AsyncPostBackTrigger ControlID="btnExport" EventName="Click" />
   </Triggers>
</asp:UpdatePanel> 
```

如果您想做更多客户端的事情，请参阅[此答案](https://stackoverflow.com/a/339114/77090)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T08:11:42.673

最后，我使用了一个 OnClientClick 事件来启动我的 Js。OnClick 事件为导出执行我的服务器端功能。在我的导出函数中，我添加了一个唯一的 cookie 令牌。我将该令​​牌存储在一个隐藏字段中，并每秒更改一次。在 Js 函数中，我启动计时器并检查 cookie 是否与令牌匹配。如果是这样，我会隐藏我的加载图像。

我在这里找到了这个解决方案： [Detect when browser received file download](https://stackoverflow.com/questions/1106377/detect-when-browser-receives-file-download)。

这是一个示例： http: [//geekswithblogs.net/GruffCode/archive/2010/10/28/detecting-the-file-download-dialog-in-the-browser.aspx](http://geekswithblogs.net/GruffCode/archive/2010/10/28/detecting-the-file-download-dialog-in-the-browser.aspx)。

# jsf - 如何将 Activiti 工作流与 JSF 应用程序集成

> ID：12173533
> 
> 赞同：2
> 
> 时间：2012-08-29T08:16:19.780
> 
> 标签：jsf, jpa, workflow, activiti

我是 Activiti 工作流程的新手。我只是想用没有 maven 依赖的 activiti 工作流来实现一个 JSF 应用程序。我正在使用 JPA 进行数据库连接。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T05:41:41.587

*activiti-cdi*可能是您要查找的关键字。它使与（以及其他）JSF 的集成非常容易，例如参见本教程：[http ://www.bpm-guide.de/2011/09/17/build-your-own-activiti-task-explorer-with -cdi-和-jsf-2/](http://www.bpm-guide.de/2011/09/17/build-your-own-activiti-task-explorer-with-cdi-and-jsf-2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:20:20.297

在 JSF 中实现工作流有不同的工具。

很简单：[http ://www.imixs.org/jee/examples/jsf_example.html](http://www.imixs.org/jee/examples/jsf_example.html)

我最推荐的是“Spring Web Flow”——简单的例子：[http ://www.springbyexample.org/examples/simple-spring-web-flow-webapp.html](http://www.springbyexample.org/examples/simple-spring-web-flow-webapp.html)

问候，

# azure - Azure 服务总线可伸缩性

> ID：12173536
> 
> 赞同：15
> 
> 时间：2012-08-29T08:16:28.373
> 
> 标签：azure, scalability, servicebus

我试图了解如何使 Azure 服务总线主题可扩展以处理来自 50 多个不同客户端的 >10,000 个请求/秒。我在 Microsoft 找到了这篇文章 - [http://msdn.microsoft.com/en-us/library/windowsazure/hh528527.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh528527.aspx)。这为扩展 Azure 服务总线提供了很多良好的输入，例如创建多个消息工厂、异步发送和接收、批量发送/接收。

但所有这些输入都来自发布者和订阅者客户端的角度。如果运行 Topic 的节点无法处理大量事务怎么办？我如何监控它？如何让主题在多个节点上运行？对此的任何意见都会有所帮助。

还想知道是否有人对主题/队列进行了任何容量测试，我很想看到这些结果......

谢谢，普拉萨纳

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-30T00:19:07.017

如果您每秒需要 10K 或 100K 或 1M 或更多请求，请查看高速公路上正在执行的操作。更多的交通，更多的车道。

通过在多个实体之间划分流量，您可以有效地从服务总线中获得任意流量。服务总线提供了许多关于可靠性的保证，例如，一旦我们从您那里获取消息，我们就不会丢失消息，或者我们分配无间隙序列号，并且这会对单个实体（如单个主题）产生吞吐量影响。这就像高速公路只能每小时处理 X 辆汽车。创造更多的车道。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-17T02:44:59.973

自从这些回复以来，微软已经发布了大量的新功能。

1.  Azure**自动缩放**可以监视队列中的消息（或 CPU 负载）并启动或停止实例以维护该目标。
2.  服务总线引入了**分区队列**（和主题）。这使您可以通过多个队列发送消息，但对于您的 API，它们看起来就像一个队列。显着增加队列的吞吐量。

在你这样做之前，我建议你尝试： -

*   异步和批量写入队列。
*   更改 Reads 上的 Prefetch 参数。
*   还要查看 Receive.OnMessage() 以确保您在可用的毫秒内收到消息。

这会将您的性能从每秒约 5 条消息提高到每秒 100 条或 1,000 条。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-29T09:18:57.983

服务总线有其限制“容量和配额”，请查看这篇文章以获得对这些的非常好的概述：[https ://docs.microsoft.com/en-gb/azure/service-bus-messaging/service-bus-天蓝色和服务总线队列比较对比](https://docs.microsoft.com/en-gb/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted)

如果你有一个可以突破 Azure 服务总线边界的用例，我建议你联系当地的 MSFT 专家，MSFT 在雷德蒙德（世界各地）有专门的团队可以帮助你大规模设计和突破这些边界，这是 Windows Azure CAT（客户咨询团队）。他们的目标是解决现实世界的客户问题，听起来你可能有一个......

您需要进行性能和负载测试，以根据您的具体情况获得上述问题的所有答案。

Azure CAT 团队有大量关于使用服务总线（通常是 Azure）进行容量和负载测试的指标，这些指标并不总是公开可用的，所以如果可以的话，请再次联系...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T21:35:29.063

如果它可以处理这么多请求，那么您要确保以不会达到主题最大大小的方式接收消息。您可以在 Azure 中使用辅助角色的多个实例来侦听特定订阅，这样您就能够更快地处理消息，而不会接近最大大小。

# testing - 如何在同一测试中使用 JMeter 测试组件（即采样器或断言）两次？

> ID：12173538
> 
> 赞同：3
> 
> 时间：2012-08-29T08:16:31.983
> 
> 标签：testing, jmeter

GUI 模式很有趣。此时我创建了一个组件（即断言），然后将其复制并粘贴到每个需要它的地方。但是，如果我在某个地方更改断言，我必须手动更改所有其他使用它的地方的所有相同断言。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T10:38:04.060

Jmeter 中的可重用性可以通过 4 种方式完成：

*   当您想重用测试的子集（登录、注销）时包含控制器
*   模块控制器在现有计划中重用控制器
*   您可以在任何地方重用的用户定义变量
*   某些采样器的 xxx 默认值（Ftp、Http...）

但是在您的特定情况下，您可以按如下方式进行。

将您的表达式定义为用户定义变量中的 var，然后在您的断言中使用它：

*   [http://jmeter.apache.org/usermanual/component_reference.html#User_Defined_Variables](http://jmeter.apache.org/usermanual/component_reference.html#User_Defined_Variables)

对于采样器，使用 Http Request Defaults 来考虑它们之间的共同点。

*   [http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Request_Defaults](http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Request_Defaults)

请注意，要查找具有相同正则表达式 yoy 的元素，可以使用突出显示搜索结果的搜索功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T14:50:03.153

恕我直言，重用组件的最简洁方法是将[ModuleController](http://jmeter.apache.org/usermanual/component_reference.html#Module_Controller)与 jMeter 插件的[ParametrizedController](http://jmeter-plugins.org/wiki/ParameterizedController/)一起使用。

上面的 ParametrizedController 链接将向您解释它是如何完成的。

# python - 在 OSX 上使用 Sublime Text 2 的 MatPlotLib

> ID：12173541
> 
> 赞同：3
> 
> 时间：2012-08-29T08:16:34.980
> 
> 标签：python, matplotlib, sublimetext2, sublimetext

我想通过 build 命令直接使用我的 Sublime Text 2 中的 matplotlib。

有人知道我是怎么做到的吗？我真的对整个多个 python 安装/环境感到困惑。谷歌没有帮助。

我的 python 是通过 homebrew 安装的，在我的终端（使用 brew python）中，我从那里导入 matplotlib 没有问题。但是 Sublime Text 向我显示了一个导入错误（没有名为 matplotlib.pyplot 的模块）。我已经通过 EPD 免费安装了 Matplotlib。主 matplotlib .dmg 安装程序拒绝在我的磁盘上安装它，因为没有找到系统版本 2.7。我已经放弃了解整个事情。我只是想让它工作。

而且，我不得不说，对于 python 带来的每一点乐趣，安装、版本和路径的整个事情，环境都是一个真正的麻烦。

在此特定问题的帮助下，我将不胜感激任何有用的链接来理解和这种环境混乱。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T20:48:59.623

我遇到了同样的问题，以下修复对我有用：

**1 -** `Open Sublime Text 2` -> `Preferences`->`Browse Packages`

**2 -**转到 Python 文件夹，选择文件`Python.sublime-build`

**3 -**替换现有`cmd`的这一行：

> "cmd": ["/Library/Frameworks/Python.framework/Versions/Current/bin/python", "$file"],

然后单击`CMD`+ `B`，您的脚本`matplotlib`将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T08:39:49.827

好吧，这个关于如何在 brew world 中安装 matplotlib 的教程帮助了我：

[http://penandpants.com/2012/02/24/install-python/](http://penandpants.com/2012/02/24/install-python/)

虽然在 Mountain Lion 上安装 scipy 时遇到问题，但这还有助于：

[Scipy 安装到 Mountain Lion 上的错误位置？](https://stackoverflow.com/questions/11921275/scipy-installing-to-wrong-place-on-mountain-lion)

# iphone - 目前模型视图控制器方向？

> ID：12173544
> 
> 赞同：1
> 
> 时间：2012-08-29T08:16:43.660
> 
> 标签：iphone

加载我的设备时处于横向模式。我的父视图控制器也处于横向模式，但`presentModelViewController:`我从**nib**文件加载的视图控制器处于 potrait 模式。

```
 [self performSelectorInBackground:@selector(loginIn) withObject:nil];
    loadingAlert = [[LoadingAlert alloc] initWithNibName:@"LoadingAlert" bundle:nil];
    UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:loadingAlert];
    [navigationController setModalPresentationStyle:UIModalPresentationFormSheet];
    [navigationController.navigationBar setBarStyle:UIBarStyleBlack];
    [navigationController.navigationBar setOpaque:NO];

    [navigationController.navigationBar applyCustomColor];

    UIWindow* keyWindow = [[UIApplication sharedApplication] keyWindow];
    [self presentModalViewController:navigationController animated:NO]; 
```

它仅在应用程序第一次运行时发生，除了第一次运行正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:55:08.487

检查类中`shouldAutorotateToInterfaceOrientation`的方法，`LoadingAlert`如果您支持所有方向，应该是这样的

-

```
 (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {

// Return YES for supported orientations

return ((interfaceOrientation == UIInterfaceOrientationPortrait) || (interfaceOrientation == UIInterfaceOrientationLandscapeLeft) || (interfaceOrientation == UIInterfaceOrientationLandscapeRight));

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T11:45:41.587

我用这种方法调用模态视图控制器

```
[self performSelector:SEL withObject:id afterInterval:time]; 
```

然后我的问题就解决了。不知道怎么做，但我认为主线程有循环使 GUI 正确。

# php - 输出文本未以正确格式显示

> ID：12173546
> 
> 赞同：0
> 
> 时间：2012-08-29T08:17:05.263
> 
> 标签：php, javascript, jquery, html

这是我用来为从数据库读取的内容的滑块（淡入淡出效果）设置动画的 JavaScript：

```
<script language="javascript">
jQuery(document).ready(function ()
{
    var terms = ["span_1","span_2"];
    var i = 0;

    function rotateTerm() {
        jQuery("#text-content").fadeOut(200, function() {
          jQuery(this).text(jQuery('#text-slider .'+terms[i]).html()+i).fadeIn(200);
        });
        jQuery("#title-content").fadeOut(200, function() {
          jQuery(this).text(jQuery('#title-slider .'+terms[i]).html()+i).fadeIn(200);
           i == terms.length - 1 ? i=0 : i++;
        });
    }
    rotateTerm();
    setInterval(rotateTerm, 1000);   
});
</script> 
```

这是我使用的 PHP 代码：

```
<?php
    if (!empty($testLst)) :     
        $num=1; 
        foreach($testLst as $key=>$item):
             $item->slug = $item->id;
             $item->catslug = $item->catid ;

?><div id="hidden-content" style="display:none;">       
    <div id="title-slider"> 
        <span class="<?php echo 'span_'.$num; ?>">
            <h4><a href="<?php echo JRoute::_(ContentHelperRoute::getArticleRoute($item->id, $item->catid)); ?>">
                <?php echo $item->title; ?></a>
            </h4>
        </span>
    </div>
<div id="text-slider">
    <span class="<?php echo 'span_'.$num; ?>">
        <p>
            <?php
                $concat=array_slice(explode(' ',$item->introtext),0,20);
                $concat=implode(' ',$concat);
                echo $concat."...";
            ?>
        </p>
    </span>
</div></div>
<a href="<?php echo JRoute::_(ContentHelperRoute::getArticleRoute($item->id, $item->catid)); ?>" title="Learn more" class="learnMore">Learn more &gt;&gt;</a></p>
<?php
    $num++;
    endforeach;
    endif;
?>

<div id="title-content">
</div>
<div id="text-content">
</div> 
```

这[是一个 JSFiddle 页面](http://jsfiddle.net/A5smV/)，再现了我想做的事情。

我的问题是我得到的数据仍然有 HTML 标签，但是我希望输出有我的 CSS 样式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:53:06.667

You could clone the node, and set that to be the new content of the target elements, to keep everything in jQuery objects, but personally, I'd use the `.outerHTML` property.

I've [updated your fiddle](http://jsfiddle.net/A5smV/2/) to show you what I mean: I've changed the `.text(...set content here)` to `.html()`, because we're injecting HTML content. Then, I added `[0]` at the end of your selector, to return the *raw* element reference, which gives access to all standard JS properties and methods an element has, and just went ahead and fetched the `outerHTML`... easy-peasy

# javascript - 使用 SVG api 的矩阵数学

> ID：12173549
> 
> 赞同：1
> 
> 时间：2012-08-29T08:17:16.320
> 
> 标签：javascript, html, svg

对于我目前的项目，我需要矩阵数学，二维转换的所有基本内容。我知道有 sylvester 等框架，但我也在 SVG DOM api 中找到了我需要的所有功能。所以有一个SVGMatrix，一个SVGPoint，一个SVGRect等等。

所以这是我的问题：如果我创建一个内存 SVG，只是为了成为矩阵、点和矩形的工厂，这会给我带来性能优势吗？我可以在不同 SVG 的上下文中使用使用 memory-svg 创建的 SVGMatrix（即将其应用于元素变换）吗？

问候菲利普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-01-31T16:23:15.620

> 如果我创建一个内存 SVG，只是为了成为矩阵、点和矩形的工厂，这是否为我提供了性能优势？

使用 SVG 引擎进行坐标转换比 Javascript 循环中的手动乘法要快，尤其是当有数千个点需要转换时。因此，尽可能使用转换而不是在 Javascript 中重新计算坐标是一个明确的优势，您可以轻松地进行基准测试。`path` `d`像属性变化这样的 DOM 操作也像海龟一样慢。

> 我可以在不同 SVG 的上下文中使用使用 memory-svg 创建的 SVGMatrix（即将其应用于元素变换）吗？

是的，你可以，我每天午餐前都会这样做十次。`SVGMatrix`对象是自由浮动的，不会以`SVGSVGElement`任何方式附加到它们的工厂（它本身就是所谓的分离 DOM 对象）。

# java - 使用双引号在 postgresql 中创建表

> ID：12173552
> 
> 赞同：2
> 
> 时间：2012-08-29T08:17:31.687
> 
> 标签：java, database, postgresql

每当我们创建一个表时，我们`CREATE TABLE table_name`在任何数据库系统中都被指定为。当我们在 postgre 中创建表时，我们使用 `CREATE TABLE "tabl_name"`. `" "`当我们在 postgreSql 中使用双引号创建表时有什么区别吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:33:38.160

如果您在表名周围使用双引号，那么您使名称区分大小写。默认情况下，未引用的表名称（和一般标识符）不区分大小写。

因此，例如使用以下不带引号的 create 语句： `CREATE TABLE TestTable...`

表示可以使用以下所有内容来引用该表：TESTTABLE、testtable、TestTTabLe

而如果您在 create 语句中使用引号： `CREATE TABLE "TestTable"...`

那么只有“TestTable”可以用来引用这个表，其他的都行不通。

该手册包含一个关于这个主题的部分，更详细地解释了它： [http ://www.postgresql.org/docs/current/static/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS](http://www.postgresql.org/docs/current/static/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T10:38:28.113

实际上有一些区别。

双引号告诉解析器包含的是区分大小写的标识符，要按字面意思阅读。

这导致了许多差异。您可以执行以下操作：

```
CREATE TABLE "table" ( ... ); 
```

但不是

```
CREATE TABLE table (...); 
```

它不仅区分大小写（PostgreSQL 将不带引号的标识符折叠为小写），而且它可以包含其他禁止的关键字。

但是，这意味着之后您必须使用以下内容：

```
SELECT * FROM "table" 
```

但你不能

```
SELECT * FROM table 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:30:29.403

如果您只使用小写字母（与 SQL 标准相反，它应该是大写字母），则没有区别。

如果您使用任何不带引号的大写字母，它将被转换为小写。

如果您使用带引号的任何大写字母，则它不会被转换，并且您必须一直使用它来访问此表（或列或任何其他标识符）。

最好不要在标识符中使用引号。

# batch-file - 如何启动批处理服务进程？

> ID：12173553
> 
> 赞同：1
> 
> 时间：2012-08-29T08:17:33.510
> 
> 标签：batch-file, axapta, dynamics-ax-2012

在 Dynamics AX 2012 中，如何自动执行批处理作业以定期执行？

我创建了一个新的批处理作业，为我的作业创建了重复，以便我的作业以 5 分钟的定时间隔添加到批处理队列（批处理列表）中。

但它处于等待状态，并没有进入执行状态。我的批处理没有执行。

他们是 AX 2012 中的任何错误还是我这边的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T10:33:35.490

（要完成 Jan B 的答案，因为我无法发表评论）

您现在需要的是一个批处理服务器来处理您的工作。
您可以在 TechNet 上找到文档：

*   [批处理服务器概述](http://technet.microsoft.com/en-us/library/dd309586.aspx)
*   [将 AOS 实例配置为 Batch Server](http://technet.microsoft.com/en-us/library/gg731831.aspx)

您还可以使用客户端实例：[运行客户端和私人批处理任务](http://technet.microsoft.com/EN-US/library/aa551632)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T22:15:29.700

有用！

检查您的服务器配置（在系统管理\设置\系统中）是否有任何 AOS 正在接受批处理，检查批处理时间段并检查您的批处理组设置。

# c# - 如何在 MVC 3 中使用 LabelFor

> ID：12173558
> 
> 赞同：3
> 
> 时间：2012-08-29T08:18:01.503
> 
> 标签：c#, .net, asp.net-mvc-3, html-helper

```
@Html.LabelFor(model => model.updateDate) 
```

但这被转换为`<label for="updateDate">updateDate</label>`并且值不只是显示 updateDate。如何显示值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T08:19:27.533

尝试`DisplayFor`代替`LabelFor`

```
@Html.DisplayFor(model => model.updateDate) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T13:56:10.077

DisplayFor 的一个小问题。
如果你从 JS 操作中加载值，你需要添加一个带有 id 的 span 来修改它的 value 。

# c# - 如何从 Android 应用程序中调用 Mono for Android 类？

> ID：12173568
> 
> 赞同：6
> 
> 时间：2012-08-29T08:18:45.790
> 
> 标签：c#, java, android, interop, xamarin.android

我在 Mono for Android 项目中创建了一个相当简单的 Activity：

```
[Activity(Label = "AndroidApplication1", MainLauncher = true, Icon = "@drawable/icon")]
public class Activity1 : Activity
{
    private string value = "intitial";

    [Export]
    public string GetString()
    {
        return value;
    }

    [Export]
    public void SetString(string newValue)
    {
        value = newValue;
    }
} 
```

该活动应仅用作概念验证，因此很简单。现在，我希望能够从“普通”、基于 Java 的 Android 应用程序中调用方法 GetString()。

在[Xamarin 的文档](http://docs.xamarin.com/android/advanced_topics/Java_Integration)中，我已经阅读了有关 Java 到托管互操作的信息，这似乎正是我正在寻找的。如果我理解正确的话，当 Mono for Android 应用程序编译时，它会生成称为 Android 可调用包装器 (ACW) 的 Java 类。然后我应该能够从基于 Java 的 Android 应用程序调用这些 ACW 上的方法。

问题是，我究竟如何从基于 Java 的 Android 应用程序中引用已编译的 Mono for Android 应用程序（ *apk文件）？*

这就是我现在陷入困境并且无法找到任何具体示例的地方。[SO（这个](https://stackoverflow.com/questions/7279012/how-to-call-a-net-class-from-a-java-class-in-mono-from-android)和[这个](https://stackoverflow.com/questions/7467469/monodroid-interop-betwen-java-and-c-sharp)）和一些博文也有类似的问题，但它们只是归结为“使用 ACW”。**但具体如何？**也许我在这里遗漏了一些明显的东西，因为我不是 Android 人。

我尝试的是动态加载我从 Mono for Android *apk中提取的**dex*文件。我只是将它放在存储卡上，然后尝试使用基于 Java 的 Android 应用程序来加载它（我已经关注了这篇[博文](http://android-developers.blogspot.sk/2011/07/custom-class-loading-in-dalvik.html)）。找到了 ACW 类，但是当我尝试创建它的实例时，出现以下错误：*`DexClassLoader`*

 *> 未找到本机 Lmno/android/Runtime;.register (Ljava/lang/String;Ljava/lang/Class;Ljava/lang/String;) 的实现

我想我必须以某种方式将 Mono for Android 运行时包含到基于 Java 的应用程序中，但我不知道如何。

**编辑：** 这是我试图加载*dex*的代码：

```
DexClassLoader cl = new DexClassLoader(dexInternalStoragePath.getAbsolutePath(),
    optimizedDexOutputPath.getAbsolutePath(),
    null,
    getClassLoader());

try {
    Class<?> classActivity1 = cl.loadClass("androidapplication1.Activity1");

    // the following line throws the exception
    Object a = classActivity1.newInstance();

    Method getStringMethod = classActivity1.getMethod("GetString");
    Object result = getStringMethod.invoke(angel);

    result = null;
} catch (Exception e) {
    e.printStackTrace();
} 
```

**EDIT2：** 我现在[在这里](https://stackoverflow.com/questions/6814478/using-c-sharp-library-with-mono-for-android-from-java-code)读到，应该可以从 Java 直接启动用 Mono for Android 编写的活动。我仍然不清楚如何从 Java 和谷歌搜索中引用 Mono for Android 并没有产生相关的命中。现在真的难住了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T18:35:59.790

如果我正确理解您要执行的操作，那么这实际上是不可能的。正如您收到的错误消息所暗示的那样，Mono for Android 应用程序中的 Activity 依赖于 Mono 运行时才能正常运行。在这种情况下，可调用包装器本身没有用，因为它只是一个调用 Mono 运行时的薄 Java 包装器类。如果您在构建项目后查看 obj/Debug/android/src 文件夹，您实际上可以自己查看生成的可调用包装器。例如：

```
package androidapplication9;

public class Activity1
    extends android.app.Activity
    implements
        mono.android.IGCUserPeer
{
    static final String __md_methods;
    static {
        __md_methods = 
            "n_onCreate:(Landroid/os/Bundle;)V:GetOnCreate_Landroid_os_Bundle_Handler\n" +
            "";
        mono.android.Runtime.register ("AndroidApplication9.Activity1, AndroidApplication9, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null", Activity1.class, __md_methods);
    }

    public Activity1 ()
    {
        super ();
        if (getClass () == Activity1.class)
            mono.android.TypeManager.Activate ("AndroidApplication9.Activity1, AndroidApplication9, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null", "", this, new java.lang.Object[] {  });
    }

    public void onCreate (android.os.Bundle p0)
    {
        n_onCreate (p0);
    }

    private native void n_onCreate (android.os.Bundle p0);

    java.util.ArrayList refList;
    public void monodroidAddReference (java.lang.Object obj)
    {
        if (refList == null)
            refList = new java.util.ArrayList ();
        refList.add (obj);
    }

    public void monodroidClearReferences ()
    {
        if (refList != null)
            refList.clear ();
    }
} 
```

也就是说，由于 Android 的工作方式，您可以让 Java 应用程序启动在 Mono for Android 应用程序中定义的活动，就像启动外部 Java 活动一样。当然，这依赖于安装的两个应用程序，但会导致 Mono for Android 应用程序和 Mono 运行时实际启动以运行该活动。

**编辑**

更新以回答您在评论中提出的问题。[`ExportAttribute`](http://androidapi.xamarin.com/?link=T:Java.Interop.ExportAttribute)基本上只是让您更多地控制 ACW 的生成方式，允许您指定特定方法或字段应该出现在 ACW 中以及它应该具有的名称。当您想在布局中使用诸如 android:onClick 属性之类的东西时，这可能很有用，例如，默认情况下 ACW 不包含您要引用的方法。

在 Mono for Android 应用程序的上下文之外，您无法充分利用 ACW，因为 Mono 运行时将不存在。用 C# 编写的代码在 Mono 运行时之上执行，而不是在编译或类似的过程中在后台转换为 Java。在运行时，有两个运行时并排运行，Dalvik（Android 的运行时）和 Mono，可调用的包装器允许两者来回通信。因此，即使是 Android 的 Mono 类库仍然依赖于 Mono 运行时，因此您不能独立于该运行时使用它。

此图显示了架构的外观，以及运行时如何相互关联：

![适用于 Android 架构的 Mono](../Images/44dfe6d4772cad2f58cd0572ae0c8712.png)

希望这有助于澄清事情！*

# android - 在 DatePickerDialog 之后，AlertDialog 崩溃

> ID：12173573
> 
> 赞同：0
> 
> 时间：2012-08-29T08:18:59.760
> 
> 标签：android, android-alertdialog, datepickerdialog

大家好！

如果我显示 DatePickerDialog 并单击否定按钮，接下来我想显示 AlertDialog 但他崩溃了。如果我显示 DatePickerDialog 并单击 button_positive - 那么一切都很好（AlertDialog 可以显示）。

```
protected Dialog onCreateDialog(int id) {
        if (id == DIALOG_DATE) {
            final DatePickerDialog tpd = new DatePickerDialog(this, myCallBack, 2000, 02, 02);
            tpd.setOnShowListener(new DialogInterface.OnShowListener() {
                public void onShow(final DialogInterface dialog) {
                    Button d = tpd.getButton(DatePickerDialog.BUTTON_NEGATIVE);
                    d.setOnClickListener(new View.OnClickListener() {
                        public void onClick(View view) {
                            tpd.dismiss();
                        }
                    });
                }
            });
            return tpd;
        }
        if (id == DIALOG_ABOUT) {
            final LinearLayout view = (LinearLayout) getLayoutInflater()
                    .inflate(R.layout.dialog_about, null);
            final AlertDialog adb = new AlertDialog.Builder(this)
                    .setView(view)
                    .setTitle("О программе")
                    .setIcon(android.R.drawable.ic_dialog_info)
                    .setPositiveButton(R.string.next,
                            new Dialog.OnClickListener() {
                                public void onClick(DialogInterface d, int which) {
                                    // Do nothing here. We override the onclick
                                }
                            }).create();

            adb.setOnShowListener(new DialogInterface.OnShowListener() {

                public void onShow(final DialogInterface dialog) {

                    Button b = adb.getButton(AlertDialog.BUTTON_POSITIVE);
                    b.setOnClickListener(new View.OnClickListener() {
                        public void onClick(View view) {
                            adb.dismiss();
                        }
                    });
                }
            });
            return adb;

        }
        return super.onCreateDialog(id);
    } 
```

> 08-29 08:18:12.080：E/AndroidRuntime(454)：致命异常：主要 08-29 08:18:12.080：E/AndroidRuntime(454)：java.lang.ClassCastException：android.app.AlertDialog 08-29 08:18:12.080: E/AndroidRuntime(454): 在 ru.pososhok.app.stp1.onPrepareDialog(stp1.java:421) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.app .Activity.onPrepareDialog(Activity.java:2515) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.app.Activity.showDialog(Activity.java:2565) 08-29 08:18:12.080 : E/AndroidRuntime(454): 在 android.app.Activity.showDialog(Activity.java:2524) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 ru.pososhok.app.menu.onOptionsItemSelected( menu.java:36) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.app.Activity.onMenuItemSelected(Activity.java:2205) 08-29 08:18:12.080: E/AndroidRuntime( 454）：在com。android.internal.policy.impl.PhoneWindow.onMenuItemSelected(PhoneWindow.java:748) 08-29 08:18:12.080: E/AndroidRuntime(454): at com.android.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl .java:143) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:855) 08-29 08:18:12.080 : E/AndroidRuntime(454): 在 com.android.internal.view.menu.IconMenuView.invokeItem(IconMenuView.java:532) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android。 internal.view.menu.IconMenuItemView.performClick(IconMenuItemView.java:122) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.view.View$PerformClick.run(View.java:9080) 08 -29 08:18:12.080: E/AndroidRuntime(454): 在 android.os.Handler.handleCallback(Handler.java:587) 08-29 08:18:12.080:E/AndroidRuntime(454): 在 android.os.Handler.dispatchMessage(Handler.java:92) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.os.Looper.loop(Looper.java :123) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.app.ActivityThread.main(ActivityThread.java:3683) 08-29 08:18:12.080: E/AndroidRuntime(454):在 java.lang.reflect.Method.invokeNative(Native Method) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 java.lang.reflect.Method.invoke(Method.java:507) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 08-29 08:18:12.080: E/AndroidRuntime(454):在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 dalvik.system.NativeStart.main(Native Method)Handler.dispatchMessage(Handler.java:92) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.os.Looper.loop(Looper.java:123) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.app.ActivityThread.main(ActivityThread.java:3683) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 java.lang.reflect.Method.invokeNative(Native方法) 08-29 08:18:12.080: E/AndroidRuntime(454): at java.lang.reflect.Method.invoke(Method.java:507) 08-29 08:18:12.080: E/AndroidRuntime(454) : 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal.os.ZygoteInit.main (ZygoteInit.java:597) 08-29 08:18:12.080: E/AndroidRuntime(454): at dalvik.system.NativeStart.main(Native Method)Handler.dispatchMessage(Handler.java:92) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.os.Looper.loop(Looper.java:123) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.app.ActivityThread.main(ActivityThread.java:3683) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 java.lang.reflect.Method.invokeNative(Native方法) 08-29 08:18:12.080: E/AndroidRuntime(454): at java.lang.reflect.Method.invoke(Method.java:507) 08-29 08:18:12.080: E/AndroidRuntime(454) : 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal.os.ZygoteInit.main (ZygoteInit.java:597) 08-29 08:18:12.080: E/AndroidRuntime(454): at dalvik.system.NativeStart.main(Native Method)E/AndroidRuntime(454): 在 android.os.Looper.loop(Looper.java:123) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.app.ActivityThread.main(ActivityThread.java :3683) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 java.lang.reflect.Method.invokeNative(Native Method) 08-29 08:18:12.080: E/AndroidRuntime(454): 在java.lang.reflect.Method.invoke(Method.java:507) 08-29 08:18:12.080: E/AndroidRuntime(454): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java :839) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 08-29 08:18:12.080: E/AndroidRuntime （454）：在 dalvik.system.NativeStart.main（本机方法）E/AndroidRuntime(454): 在 android.os.Looper.loop(Looper.java:123) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 android.app.ActivityThread.main(ActivityThread.java :3683) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 java.lang.reflect.Method.invokeNative(Native Method) 08-29 08:18:12.080: E/AndroidRuntime(454): 在java.lang.reflect.Method.invoke(Method.java:507) 08-29 08:18:12.080: E/AndroidRuntime(454): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java :839) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 08-29 08:18:12.080: E/AndroidRuntime （454）：在 dalvik.system.NativeStart.main（本机方法）ActivityThread.main(ActivityThread.java:3683) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 java.lang.reflect.Method.invokeNative(Native Method) 08-29 08:18:12.080: E /AndroidRuntime(454): 在 java.lang.reflect.Method.invoke(Method.java:507) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal.os.ZygoteInit$ MethodAndArgsCaller.run(ZygoteInit.java:839) 08-29 08:18:12.080: E/AndroidRuntime(454): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 08-29 08: 18:12.080：E/AndroidRuntime（454）：在 dalvik.system.NativeStart.main（本机方法）ActivityThread.main(ActivityThread.java:3683) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 java.lang.reflect.Method.invokeNative(Native Method) 08-29 08:18:12.080: E /AndroidRuntime(454): 在 java.lang.reflect.Method.invoke(Method.java:507) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal.os.ZygoteInit$ MethodAndArgsCaller.run(ZygoteInit.java:839) 08-29 08:18:12.080: E/AndroidRuntime(454): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 08-29 08: 18:12.080：E/AndroidRuntime（454）：在 dalvik.system.NativeStart.main（本机方法）E/AndroidRuntime(454): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal .os.ZygoteInit.main(ZygoteInit.java:597) 08-29 08:18:12.080: E/AndroidRuntime(454): at dalvik.system.NativeStart.main(Native Method)E/AndroidRuntime(454): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 08-29 08:18:12.080: E/AndroidRuntime(454): 在 com.android.internal .os.ZygoteInit.main(ZygoteInit.java:597) 08-29 08:18:12.080: E/AndroidRuntime(454): at dalvik.system.NativeStart.main(Native Method)

# c# - 在 Windows 中单击任务栏时，在 C# 中的“主程序”顶部显示“保存对话框”

> ID：12173574
> 
> 赞同：0
> 
> 时间：2012-08-29T08:19:04.767
> 
> 标签：c#, savefiledialog

问题：模拟完成后会弹出“保存对话框”。单击 Windows 任务栏中的“主程序”时，“主程序”和“保存对话框”都应位于其他打开的窗口之上。现在只显示“主程序”，而“保存对话框”隐藏在后台，必须最小化所有窗口才能看到它。如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:25:51.977

调用 ShowDialog 方法使您将 FileDialog 保存为模态对话框

```
saveFileDialog1.ShowDialog(); 
```

# javascript - Target=带有 OnClick JavaScript 的空白链接

> ID：12173576
> 
> 赞同：0
> 
> 时间：2012-08-29T08:19:09.877
> 
> 标签：javascript, html, events, dom

为什么有 onClick 参数时 TARGET _BLANK 参数不起作用？onlick 是谷歌事件脚本。当我将 onclick 添加到此链接时，它会在框架集中打开。

```
<a target=_blank href="externalwwwlink" onClick="recordOutboundLink(this, 'Link', 'aaa');return false;">OPEN </a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:21:14.643

你回到`false`这里：

```
onClick="recordOutboundLink(this, 'Link', 'aaa'); return false;" 
```

所以它可以防止通常的行为（点击事件的冒泡）。这是防止标准操作（通过引用重定向或提交表单）的非常常见的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:21:00.580

您的`onClick`处理程序`return false`末尾有 a，这是一种[告诉浏览器**停止处理**click](https://stackoverflow.com/questions/128923/whats-the-effect-of-adding-return-false-to-an-onclick-event)的旧方法。浏览器不会打开链接，在您的情况下，不会在新（空白）窗口/选项卡中打开 href。

删除`return false;`onClick 末尾的 ，以便浏览器知道它可以继续。

# java - 使用 GCM 读取更新的注册 ID

> ID：12173577
> 
> 赞同：1
> 
> 时间：2012-08-29T08:19:15.710
> 
> 标签：java, android, google-cloud-messaging

我正在使用 android 文档中给出的 GCM API 和 gcm.jar。它的工作很好。但是随着***GCM 刷新注册 ID*** ，我如何以及在哪里可以收听更新`registration id`？

`onRegistered(Context context, String registrationId)`类中有一个方法，`GCMIntentService`这是可以侦听的方法`registration id`吗（该ID已被GCM刷新）？或者有没有其他方法可以收听更新的注册ID？和另一个困惑是否有任何测试用例可以使用更新的注册 ID 进行测试？

我目前的实现`onRegistered()`是

```
@Override
    protected void onRegistered(Context context, String registrationId) {
        Log.i(TAG, "Device registered: regId = " + registrationId);

        dataStore = new DataPrefStore(context);
        //Store registration Id
        dataStore.setRegistrationId(registrationId);
        //Notify GCM registration
        displayMessage(context, Constants.GCM_REGISTER_MESSAGE);

    } 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:41:27.237

是的，你有正确的实施。每当刷新注册 ID 时，它都会调用您的 GCMINtentService 类的 onRegistered() 方法。

```
Note that Google may periodically refresh the registration ID, so you should design your    
Android application with the understanding that the com.google.android.c2dm.intent.REGISTRATION intent may be called multiple times. 
```

# asp.net - 以编程方式为 VB.NET 中的 DropDownList 设置 OnSelectedIndexChanged

> ID：12173578
> 
> 赞同：3
> 
> 时间：2012-08-29T08:19:16.320
> 
> 标签：asp.net, vb.net, webforms

我试过下面的代码，但没有用：

```
 DropDownList1.SelectedIndexChanged += new EventHandler ( doSub ); 
```

1.  它在 C# 而不是 VB 中
2.  当我键入 DropDownList1。智能感知没有带来 SelectedIndexChanged 方法
3.  最后它抱怨 SelectedIndexChanged 是一个事件，必须由 RaiseEvent 调用

我正在尝试根据彼此的 SelectedValue 动态制作 ddls，因此我需要以编程方式设置 OnSelectedIndexChanged 值，而不是像这样声明：

```
 <asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="true" OnSelectedIndexChanged="DoSub">
    </asp:DropDownList> 
```

提前致谢。

**提示：**删除 @Page 部分中的 AutoEventWireup="false" 以使解决方案正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:20:33.787

使用[AddHandler](http://msdn.microsoft.com/en-us/library/7taxzxka%28v=vs.80%29.aspx)附加事件处理程序。

句法：

```
AddHandler obj.EventName, AddressOf HandlerName 
```

例子：

```
<script runat="server">
    Protected Sub Page_Load(sender As Object, e As System.EventArgs)
        AddHandler DropDownList1.SelectedIndexChanged, AddressOf DoSub
    End Sub
    Sub DoSub(sender As Object, e As System.EventArgs)
        Response.Write(DropDownList1.SelectedValue)
    End Sub
</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

        <asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True">
            <asp:ListItem>Foo</asp:ListItem>
            <asp:ListItem>Bar</asp:ListItem>
        </asp:DropDownList>

    </div>
    </form>
</body> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:54:22.120

```
AddHandler DropDownList1.SelectedIndexChanged, AddressOf FunctionName 
```

# asp.net - ASP.Net 1.1 到 ASP.Net 4.0 的迁移

> ID：12173579
> 
> 赞同：2
> 
> 时间：2012-08-29T08:19:18.390
> 
> 标签：asp.net

我们正在将用 ASP.Net 1.1 编写的现有代码迁移到 ASP.Net 4.0。我们还需要迁移我们的 Web 控件。

我们有 50% 或更多的页面使用了 DataGrid，从 ASP.Net 2.0 开始，我们有 GridView，我发现唯一的区别是

1.  ASP.Net 1.1 DataGrid 具有基于“Item”的属性、事件和方法，而在 GridView 中它是基于“RowItem”的
2.  ASP.Net 4.0 和 4.5 - 都支持 DataGrid

如果我们没有像这样做那样更改为 GridView，我们还需要更改代码和事件并重新测试更改。因为我们有 400 多页，每次更改页面大约需要 1 小时来更改和测试

我的问题是什么是缺点

如果我们继续使用 DataGrid，在性能方面是否有任何缺点或任何其他考虑改变这是更好的方法。

谢谢

# java - JFrame 标题中的错误字符

> ID：12173588
> 
> 赞同：2
> 
> 时间：2012-08-29T08:19:51.603
> 
> 标签：java, swing, utf-8, character-encoding, jframe

当我写这样的东西时：

```
...
JFrame myFrame = new JFrame();
...
myFrame.setTitle("\t\t myApp"); 
```

我在 JFrame 标题中得到以下结果：

![在此处输入图像描述](../Images/82f4984090a8f6e6be7f703799f7363e.png)

它只发生在 Windows XP 中，并且在 Leopard OS 中运行良好。有什么办法可以解决吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T09:12:01.607

正如安德鲁已经指出的那样，您不应该这样做。本质上，Windows 去字体的字符字典找出如何最好地呈现“\t”并为您打印那个美妙的正方形，因为这就是它知道如何做的全部。

标题不是“文本组件”，它是一个渲染元素，因此不处理这种性质的格式......

听从安德鲁的建议

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T08:43:07.867

> 当我做这样的事情时：

解决方法是不要那样做。你的应用程序。并没有那么特别，以至于它应该具有“缩进”的名称。

# php - 我为每个系统获得相同的 IP - 如何通过 PHP 编码获取 IP 地址

> ID：12173596
> 
> 赞同：0
> 
> 时间：2012-08-29T08:20:17.577
> 
> 标签：php, ip

您好，我正在使用此功能获取不同系统的 IP 地址..但每次它返回相同的值：117.239.82.182

```
function getRealIpAddr()
{
   if (!empty($_SERVER['HTTP_CLIENT_IP']))   //check ip from share internet
   {
     $ip=$_SERVER['HTTP_CLIENT_IP'];
   }
   elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR']))   //to check ip is pass from proxy
   {
     $ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
   }
   else
   {
      $ip=$_SERVER['REMOTE_ADDR'];
   }
   return $ip;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:28:16.653

117.239.82.182 是外部 IP 地址。如果连接到 PHP 服务器的所有系统都位于相同的外部 IP 地址后面，则它们都将被记录为相同的 IP 地址。

您的脚本不采用本地 IP。不要认为这甚至是可能的。您看到的 IP 是您公司防火墙的 IP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:44:02.270

**编辑：（**在评论中进行了一些澄清后，答案发生了根本变化）

您可以编辑用户浏览器的**User-Agent**设置。要查看如何更改各种浏览器中的设置，请[点击此链接](http://www.howtogeek.com/113439/how-to-change-your-browsers-user-agent-without-installing-any-extensions/)。然后你应该修改你的 PHP 脚本来读取浏览器的 User-Agent。在 PHP 中，`$_SERVER['HTTP_USER_AGENT']`返回浏览器的**用户代理**设置。例如。您可以将诸如**Company/System/1.02 Bla bla bla定义为****User-Agent**。然后，当您收到相同的字符串时，您可以假设它来自已知主机。

 **注意**User-Agent**很容易被欺骗。所以这种方法并不安全。安全的解决方案是实施**VPN**解决方案。**

# java - 将数据保存到 SharedPreferences Android

> ID：12173599
> 
> 赞同：-1
> 
> 时间：2012-08-29T08:20:21.040
> 
> 标签：java, android, spinner, sharedpreferences

我在android中做了一个微调器

```
 public SiriusRadioPlayerActivity(){
    String[] arrayOfString = new String[4];
    arrayOfString[0] = "Kiskunfélegyháza HQ [160kbps MP3]";
    arrayOfString[1] = "Kiskunfélegyháza MQ [64kbps AAC]";
    arrayOfString[2] = "Kiskunmajsa HQ [160kbps MP3]";
    arrayOfString[3] = "Kiskunmajsa MQ [64kbps AAC]";
    this.items = arrayOfString;

     } 
```

这些是我要显示的字符串！

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    initializeUIElements();

this.savszelesseg_port = localSharedPreferences.getString("savszelesseg_mentes",      "savszelesseg_port");
    this.savszelesseg_saved = this.savszelesseg_port; 
```

在这里，我从我的偏好加载数据！

```
 final Spinner localSpinner = (Spinner)findViewById(R.id.savszelesseg);
    ArrayAdapter localArrayAdapter = new ArrayAdapter(this,android.R.layout.simple_spinner_dropdown_item, this.items);
    localArrayAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    localSpinner.setAdapter(localArrayAdapter); 
```

创建了微调器。并具有 en setOnItemSelectedListener 功能。

```
 localSpinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() 
    {
        public void onItemSelected(AdapterView parentView, View childView, int position, long id) 
        {
            if (!savszelesseg_port_modositva)
            {
              savszelesseg_beallitas = "Kiskunfélegyháza HQ [160kbps MP3]";
              savszelesseg_port_modositva = true;
            }
 if (savszelesseg_beallitas == "Kiskunfélegyháza HQ [160kbps MP3]")
            {
              savszelesseg_port = "8500/relay_911";

            }

        }
        public void onNothingSelected(AdapterView parentView) 
        {
        }
    }); 
```

问题是：如何将 savszelesseg_port 存储到我的 SharedPreferencies savszelesseg_mentes 默认值？因为我有一个计时器来定期检查网页，这取决于我从共享偏好中获得的值：

```
this.mWebView = ((WebView)findViewById(0x7f070035));
    this.mWebView.getSettings().setJavaScriptEnabled(true);
    new Timer().scheduleAtFixedRate(new TimerTask()
    {
      public void run()
      {
        if (SiriusRadioPlayerActivity.isOnline()){

            if (SiriusRadioPlayerActivity.this.mWebView_enabled == false){
                SiriusRadioPlayerActivity.this.mWebView.loadUrl("about:blank"); 
            }
            else
            {

                if(savszelesseg_port.contains("911")){
                 SiriusRadioPlayerActivity.this.mWebView.loadUrl("http://xxxx");    
                }
                if(savszelesseg_port.contains("882")){
                 SiriusRadioPlayerActivity.this.mWebView.loadUrl("http://xxx"); 
                }

                }

        }

      }}
    , this.delay, this.period);
    this.mWebView.setBackgroundColor(0); 
```

本地共享首选项：

```
PreferenceManager.setDefaultValues(this, 0x7f040000, false);
    final SharedPreferences localSharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);
    this.mWebView_enabled = localSharedPreferences.getBoolean("mWebView_enabled", true);
    this.savszelesseg_port = localSharedPreferences.getString("savszelesseg_mentes", "savszelesseg_port"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:38:19.230

行后：

```
 savszelesseg_port = "8500/relay_911"; 
```

你应该做 ：

```
SharedPreferences.Editor editor = localSharedPreferences.edit();
editor.putString("savszelesseg_mentes", savszelesseg_port);
editor.commit(); 
```

# javascript - Safari 浏览器上的“强制另存为”对话框

> ID：12173602
> 
> 赞同：0
> 
> 时间：2012-08-29T08:20:24.487
> 
> 标签：javascript, asp.net, html

我有一个在`<img>`标签中显示图像的网页。我的客户现在希望在有人单击“另存为”按钮时有一个“另存为”对话框，以便用户可以避免右键单击。我需要它在 Safari 浏览器上工作。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:24:40.803

您正在寻找 Content-Disposition HTTP 标头[（可在此处找到）](http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html)。

具体你需要：

```
Content-Disposition: attachment; filename="fname.ext" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:25:04.080

您应该在服务器上实施更改。使用标题：`Content-Disposition`.

```
Content-Disposition: attachment; filename=MyFileName.png 
```

在 ASP.NET 中

```
Response.AddHeader("Content-Disposition", "attachment; filename=MyFileName.png"); 
```

# iphone - 在iphone中的button_Click事件上动态创建按钮

> ID：12173610
> 
> 赞同：0
> 
> 时间：2012-08-29T08:20:55.610
> 
> 标签：iphone, button, dynamic, view

我有 1 个主视图。

在那我有3个子视图。

在第一个视图中，我有按钮。

现在在该按钮的单击事件上，我抛出 1 个查询。

并且根据该获取的项目数，我想在按钮上显示产品。

所以基本上我想动态创建按钮..

有谁能够帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:33:45.007

```
-(IBAction) yourbuttonclickevent:(UIButton *)button{
    for(int i=0;i<count_of_items;i++)
    {
         UIButton *btn=[UIButton buttonWithType:UIButtonTypeCustom];
         [btn setFrame:CGRectMake(i*100,0,100,200)];//setframe as per your requirement 
         btn.tag=i;
         [yoursubview addSubview:btn];
    }
} 
```

# mapreduce - 使用 RavenDb 索引查找完整序列

> ID：12173627
> 
> 赞同：0
> 
> 时间：2012-08-29T08:21:44.820
> 
> 标签：mapreduce, ravendb

我在 RavenDb 中有可能看起来像这样的文档：

```
{ "Id": "obj/1", "Version": 1 },
{ "Id": "obj/1", "Version": 2 },
{ "Id": "obj/1", "Version": 3 },
{ "Id": "obj/1", "Version": 4 },
{ "Id": "obj/2", "Version": 1 },
{ "Id": "obj/2", "Version": 2 },
{ "Id": "obj/2", "Version": 3 },
{ "Id": "obj/3", "Version": 1 },
{ "Id": "obj/3", "Version": 3 } 
```

我正在尝试创建一个可以给我的索引：

*   序列“obj/1”和“obj/2”，最好按Id分组。
*   不是序列“obj/3”，因为它还没有完成

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T11:18:06.547

我设法解决了它。我不确定它是否是最佳解决方案，但它似乎有效。

```
class SequenceIndex : AbstractIndexCreationTask<MyObject>
{
    public EventSequenceIndex()
    {
        Map = objects => from d in docs
                         orderby d.Version
                         select new
                         {
                             Id = d.Id,
                             Version = d.Version
                         };

        TransformResults = (database, results) => 
            from result in results
            group result by result.Id into g
            where g.Select(d => d.Version + 1)
               .Except(g.Select(d => d.Version))
               .Count() == 1
            select new
            {
                Id = g.Key,
                Objects = g
            };
    }
} 
```

带查询：

```
var events = session.Query<MyObject, SequenceIndex>()
    .As<MySequenceObjectView>()
    .ToArray(); 
```

我按 Id 对文档进行分组，然后取除 all`version + 1`之外的所有文件`version`，对于`1, 2, 3`will的原始序列`2, 3, 4 except 1, 2, 3`，这给了我`4`（这就是我使用`Count() == 1`. 但如果序列中有洞，则计数将大于 1 ，因此从结果中排除。

# java - abstractlist protobuf java

> ID：12173630
> 
> 赞同：1
> 
> 时间：2012-08-29T08:21:50.000
> 
> 标签：java, list, protocol-buffers

我有一个对象，其中包含从 C# 客户端发送到 Java 服务器的列表。使用 protobuf 的序列化工作完美，并且在 Java 中完美地接收了对象。但是使用 protoc.exe 生成的类（我们可以称它为 proto 类吗？）有一个我无法修改的列表。基本上，在将其返回到 C# 之前，我必须在其中添加一些值，但是当我尝试添加一个值时，我有一个例外：

```
Exception in thread "main" java.lang.UnsupportedOperationException
    at java.util.AbstractList.add(AbstractList.java:148)
    at java.util.AbstractList.add(AbstractList.java:108)
    ... 
```

这是我添加值的方式：

```
MyProtoObject.MyResult result = MyProtoObject.MyResut.NewBuilder()
        .setId(1)
        .setValue(9.135)
        .build();
MyObject.getResultList().add(result); 
```

如何在其中插入值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:12:12.573

也许这是一种解决方法，但你可以试试这个：

```
List<MyResult> l = new ArrayList<MyResult>(MyObject.getResultList());
l.add(result);
MyObject.setResultList(l); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T10:27:04.647

好的，在重新生成 proto 类之后，似乎缺少一些方法（我可能在第一代中犯了错误）。所以现在我可以在列表中添加值：

```
MyObjectProto.MyObject o = MyObjectProto.MyObject.newBuilder()
    .addAllResults(listOfCalculations)
    .build(); 
```

listOfCalculation 是结果对象的列表

要不就 ：

```
MyObjectProto.MyObject o = MyObjectProto.MyObject.newBuilder()
    .addResult(calculationResult)
    .build(); 
```

CalculationResult 是单个结果对象

感谢弗拉维奥

# testing - 加载测试命名空间

> ID：12173633
> 
> 赞同：1
> 
> 时间：2012-08-29T08:21:56.193
> 
> 标签：testing, clojure, namespaces

我有一个 Clojure 项目，我想以编程方式检查所有命名空间以查看它们是否包含测试（由 定义`clojure.test/deftest`）

如果测试已加载（通过`:test`vars 上的元数据标记），我可以成功识别测试，但许多测试是项目不会自动加载的 ini .clj 文件，并且不会被检测到。

有没有办法加载当前项目中的所有命名空间来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:52:21.913

为什么不只看源码`lein test`呢？IIRC 它使用 builditude 来查找和加载类路径上的所有命名空间。

# android - ActionBar，来自带有 Fragments 的 Android 2.3.3 Layout XML

> ID：12173634
> 
> 赞同：1
> 
> 时间：2012-08-29T08:21:59.353
> 
> 标签：android, android-layout, android-actionbar

嗨，我需要在我的应用程序中实现 ActionBar，但我不明白从哪里开始。

我希望得到这个例子
![关联](../Images/6f6e2ce8ecfb5eb27e478bc524ecfa4f.png)

我已经测试了 ShareLock 和其他东西，但我无法成功实现这些示例，我需要使用 Fragments 来获得这个结果，并且应该有 4 个选项卡。

我用过`android-support-v4.jar`。

这是我使用的 Fragment Utils。

```
public class TabManager implements TabHost.OnTabChangeListener {
    private final FragmentActivity mActivity;
    private final TabHost mTabHost;
    private final int mContainerId;
    private final HashMap<String, TabInfo> mTabs = new HashMap<String, TabInfo>();
    TabInfo mLastTab;

    static final class TabInfo {
    private final String tag;
    private final Class<?> clss;
    private final Bundle args;
    private Fragment fragment;

    TabInfo(String _tag, Class<?> _class, Bundle _args) {
        tag = _tag;
        clss = _class;
        args = _args;
    }
}

static class DummyTabFactory implements TabHost.TabContentFactory {
    private final Context mContext;

    public DummyTabFactory(Context context) {
        mContext = context;
    }

    @Override
    public View createTabContent(String tag) {
        View v = new View(mContext);
        v.setMinimumWidth(0);
        v.setMinimumHeight(0);
        return v;
    }
}

public TabManager(FragmentActivity activity, TabHost tabHost, int containerId) {
    mActivity = activity;
    mTabHost = tabHost;
    mContainerId = containerId;
    mTabHost.setOnTabChangedListener(this);
}

public void addTab(TabHost.TabSpec tabSpec, Class<?> clss, Bundle args) {
    tabSpec.setContent(new DummyTabFactory(mActivity));
    String tag = tabSpec.getTag();

    TabInfo info = new TabInfo(tag, clss, args);

    // Check to see if we already have a fragment for this tab, probably
    // from a previously saved state.  If so, deactivate it, because our
    // initial state is that a tab isn't shown.
    info.fragment = mActivity.getSupportFragmentManager().findFragmentByTag(tag);
    if (info.fragment != null && !info.fragment.isDetached()) {
        FragmentTransaction ft = mActivity.getSupportFragmentManager().beginTransaction();
        ft.detach(info.fragment);
        ft.commit();
    }

    mTabs.put(tag, info);
    mTabHost.addTab(tabSpec);
}

@Override
public void onTabChanged(String tabId) {

    TabInfo newTab = mTabs.get(tabId);
    FragmentManager fragmentManager = mActivity.getSupportFragmentManager();
    if (mLastTab != newTab) {
        FragmentTransaction ft = fragmentManager.beginTransaction();
        if (mLastTab != null) {
            if (mLastTab.fragment != null) {
                ft.detach(mLastTab.fragment);
            }
        }
        fragmentManager.popBackStack(null, FragmentManager.POP_BACK_STACK_INCLUSIVE);
        if (newTab != null) {
            if (newTab.fragment == null) {
                newTab.fragment = Fragment.instantiate(mActivity,
                        newTab.clss.getName(), newTab.args);
                ft.add(mContainerId, newTab.fragment, newTab.tag);
            } else {
                ft.attach(newTab.fragment);
            }
        }
        mLastTab = newTab;
        ft.commit();
        mActivity.getSupportFragmentManager().executePendingTransactions();
    }
} 
```

}

还有一些......

```
public class FragmentsUtils {
private static String DIALOG_TAG = "dialog_tag";

/*public static MyAlertDialogFragment showDialog(FragmentManager fragmentManager, int id) {
    // DialogFragment.show() will take care of adding the fragment
    // in a transaction.  We also want to remove any currently showing
    // dialog, so make our own transaction and take care of that here.
    FragmentTransaction ft = fragmentManager.beginTransaction();
    Fragment prev = fragmentManager.findFragmentByTag(DIALOG_TAG);
    if (prev != null) {
        ft.remove(prev);
    }

    //      ft.addToBackStack(null);

    // Create and show the dialog.
    MyAlertDialogFragment newFragment = MyAlertDialogFragment.newInstance(id);
    newFragment.show(ft, DIALOG_TAG);
    return newFragment;
}*/

public static void swapFragments(FragmentManager fragmentManager, int containerViewId, Fragment newFragment, String fragmentTag) {

    if (fragmentManager == null)
        return;
    View newFragmentMainView = newFragment.getView();
    FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
    //      fragmentTransaction.replace(containerViewId, fragment);

    if (fragmentTag == null || fragmentTag.length() < 1)
        fragmentTransaction.add(containerViewId, newFragment);
    else
        fragmentTransaction.add(containerViewId, newFragment, fragmentTag);

    fragmentTransaction.addToBackStack(null);
    fragmentTransaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
    fragmentTransaction.commit();
}

public static void swapFragments(FragmentManager fragmentManager, int containerViewId, Fragment newFragment) {
    swapFragments(fragmentManager, containerViewId, newFragment, null);
}

} 
```

提前谢谢了...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T23:20:57.467

`ActionBar`仅从 API 11 (3) 开始可用。如果您尝试`ActionBar`在 API 10 (2.3.3 - 2.3.7) 上的设备上运行使用 的应用程序，它将不可见。

如果您`ActionBar`在应用程序中需要一个（本质上是对 Tabs 的强大产品）并计划针对 API 10 或更早的设备，您可以查看[android-actionbar](https://github.com/johannilsson/android-actionbar)或[ActionBarSherlock](http://actionbarsherlock.com/)。

# c# - 无法投射 Combobox.SelectedValue

> ID：12173637
> 
> 赞同：2
> 
> 时间：2012-08-29T08:22:30.930
> 
> 标签：c#, .net, winforms, exception-handling, casting

对于我正在尝试构建的简单练习问题，我的代码是这样的。我遇到

> 无效的演员表例外。指定的演员表无效。

```
public Form1()
{
      Combobox1.Datasource = foo.bar.dataset.tables[0];
      Combobox1.DisplayMember = "Name";
      Combobox1.ValueMember = "ID";
 }

 private void ComboBox1_SelectedIndexChanged(object sender, EventArgs e)
 {
      NewClass P2 = new NewClass;
      P2.Filter.Id = (long)Combobox1.SelectedValue;
 } 
```

谁能告诉我为什么会发生这种情况以及如何解决它，即使我已经对 Combobox1.SelectedValue 对象进行了类型转换？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T08:25:32.527

也许这会有所帮助：

```
P2.Filter.Id = Convert.ToInt64(Combobox1.SelectedValue); 
```

根据您的评论，这可能会有所帮助：

```
P2.Filter.Id = Convert.ToInt64((Combobox1.SelectedValue as DataRowView).Item[0]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:24:33.367

我不确定为什么会发生这种情况，也许有人可以帮助我，但我更愿意去。

```
 P2.Filter.Id = Convert.ToInt64(Combobox1.SelectedValue); 
```

当我遇到这个问题时，这总是对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T08:24:59.880

`ComboBox.SelectedValue`显然不是一个`long`。你应该做任何需要改变它的类型；这很可能是

```
P2.Filter.Id = Convert.ToInt64(ComboBox1.SelectedValue); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T08:31:51.453

*在转换SelectedValue*之前检查对象引用。

```
long value=0l;
if (comboBox1.SelectedValue != null)
 {
 value=long.Parse(comboBox1.SelectedValue.ToString());
 } 
```

您可以使用*SelectedItem*属性，该属性将返回`DataRowView`（行）的引用。

```
 DataRowView row = comboBox1.SelectedItem as DataRowView ;
 if (row != null){
     MessageBox.Show("value " + row[0] + " " + row[1]);
 } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T08:24:44.897

将字符串转换为 long 是错误转换。SelectedValue 应该返回一个需要 Convert.ToLong 操作的字符串

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-29T08:25:29.093

```
Convert.ToInt64(Combobox1.SelectedValue) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-29T08:25:45.677

而是尝试类似的东西

[转换.ToInt64](http://msdn.microsoft.com/en-us/library/system.convert.toint64%28v=vs.100%29.aspx)

> 将指定值转换为 64 位有符号整数。

在稍后的某个阶段，您可能还想看看使用

[Int64.TryParse 方法](http://msdn.microsoft.com/en-us/library/system.int64.tryparse.aspx)

> 将数字的字符串表示形式转换为其等效的 64 位有符号整数。返回值指示转换是成功还是失败。

或[Int64.Parse 方法](http://msdn.microsoft.com/en-us/library/system.int64.parse.aspx)

> 将数字的字符串表示形式转换为其等效的 64 位有符号整数。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-08-26T14:23:03.413

```
Thickness t = new Thickness(0);
if (value != null)
{ 
    t= new Thickness(System.Convert.ToInt64(((System.Windows.Controls.ComboBoxItem)value).GetValue(System.Windows.Controls.ComboBoxItem.ContentProperty)));

}
return t; 
```

# c++ - 带有法线贴图的副法线和切线

> ID：12173643
> 
> 赞同：2
> 
> 时间：2012-08-29T08:23:02.963
> 
> 标签：c++, directx

我正在尝试为我的 DirectX 网格制作法线贴图着色器，并且在遵循我学校的一些笔记时，它告诉我我的顶点结构需要包含用于 Pos 的 Vec3 和用于法线、副法线和切线，但我不知道如何获得副法线和切线。我参考了我的书，它告诉我使用 D3DXComputeTangentFrameEx 函数，但是我所有的网格都是 D3DXFRAME 对象，而不是 ID3DXMesh*..

谁能帮我吗？

我还想补充一点，我已经有了 pos 和法线向量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:46:20.023

如果你看[D3DXFRAME](http://msdn.microsoft.com/en-us/library/windows/desktop/bb172845)，你会发现`pMeshContainer`成员，它是[D3DXMESHCONTAINER*](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205371)类型，它有[D3DXMESHDATA](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205372)类型的`MeshData`成员，它有类型的成员，但它只有在.`pMesh``ID3DXMesh*``Type == D3DXMESHTYPE_MESH`

例子：

```
{
    D3DXFRAME Frame;

    ID3DXMesh* pMesh;

    if( Frame.pMeshContainer->MeshData.Type == D3DXMESHTYPE_MESH )
        pMesh = Frame.pMeshContainer->MeshData.pMesh;
    else
        pMesh = 0;  // model is ID3DXPatchMesh type
} 
```

# android - 如何在列表视图中显示文本和图像？

> ID：12173644
> 
> 赞同：0
> 
> 时间：2012-08-29T08:23:02.010
> 
> 标签：android, listview, bitmapimage

我有一个列表视图，我希望它用于显示文本和 corrs 图像。我已经为此使用了arrayadapter。我能够获得一个包含文本值和图像 url 的哈希图数组列表。

```
<Arraylist<Hashmap<String,string>> testdata  :  "name" and "image_url" 
```

现在我正在尝试绑定它。但是没有显示图像，并且 logcat 显示 resolveuri 在错误的位图上失败。（我的网址是“/com.example.vocab.MainActivity/res/drawable-hdpi/right_icon.png”）。我究竟做错了什么？提前感谢您的帮助。

```
 // Binding resources Array to ListAdapter
        this.setListAdapter(new SimpleAdapter(Grammar_tab_all.this, testdata ,
                R.layout.list_item, new String[] { "name","img_url"},
                new int[] { R.id.module_name_item, R.id.img_recom}));
        final ListView lv = getListView(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:30:04.490

您必须使用自定义列表视图：查看此网站 [http://blog.sptechnolab.com/2011/02/01/android/android-custom-listview-items-and-adapters/](http://blog.sptechnolab.com/2011/02/01/android/android-custom-listview-items-and-adapters/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T09:12:48.020

如果你想拥有不同的图像，你需要一个自定义的列表适配器，这是我在互联网上找到的关于这个主题的最好的[教程:)](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:27:47.633

如果您需要更多信息，请不要`<Arraylist<Hashmap<String,string>> testdata`尝试此链接[http://developerboards.att.lithium.com/t5/AT-T-Developer-Program-Blogs/Developing-Apps-for-Android-Beyond-quot-Hello -World-quot-Part-I/ba-p/28983/page/2](http://developerboards.att.lithium.com/t5/AT-T-Developer-Program-Blogs/Developing-Apps-for-Android-Beyond-quot-Hello-World-quot-Part-I/ba-p/28983/page/2)`<Arraylist<Hashmap<String,Object>> testdata`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:28:21.897

要在列表视图中显示可绘制图像，最好的方法是仅存储可绘制图像的 int id。

尝试这个。

```
listItems = new ArrayList<HashMap<String,Integer>>();
String fieldName = "image_id";

HashMap<String, Integer> listData1 = new HashMap<String, Integer>();
HashMap<String, Integer> listData2 = new HashMap<String, Integer>();

listData1.put(fieldName, R.drawable.camera_icon_focus_dim);
listData2.put(fieldName, R.drawable.camera_icon_scene_mode);

listItems.add(listData1);
listItems.add(listData2);

SimpleAdapter listItemAdapter = new SimpleAdapter(
    this,
    listItems,
    R.layout.image_list_item,
    new String[] { fieldName },
    new int[] { R.id.listitem_img }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T08:39:23.610

如果您使用 android 资源文件夹中的图像，那么您可以使用

```
// get Drawable from resources folder
Resources res = context.getResources();
Drawable drawable = res.getDrawable( R.drawable.myImage );

ImageView mImageView.setImageDrawable( mDrawable );
// or
ImageView mImageView.setImageBitmap( mBitmap ); 
```

ImageView 是您的 ListItems 布局中的一个。我为每个 ListView 编写了一个自己的 ListAdapter，我在其中扩展了特殊布局并将数据设置为布局。

# c++ - libevent：如何覆盖标头包含

> ID：12173646
> 
> 赞同：0
> 
> 时间：2012-08-29T08:23:04.290
> 
> 标签：c++, header, overriding, libevent

我的代码中包含了这个

```
#include<event.h> 
```

它应该包含 libevent 的头文件 event.h。但是当我看到包含文件的列表时，它包含了这个头文件

```
Note: including file: C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\event.h 
```

如何告诉 msvc 编译器加载 libevents event.h 头文件？. 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:25:30.820

尝试使用`#include "event.h"`. 它用于用户头文件，并告诉编译器首先在用户定义的路径中查找头文件。

使用`<>`编译器时会先在系统文件夹中搜索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:49:01.110

如果您使用的是 libevent 版本 2，最好[更新包含](http://www.wangafu.net/~nickm/libevent-book/Ref0_meta.html#_if_you_have_to_work_with_an_old_version_of_libevent)（查看表格）。新的包含文件不受此特定问题的影响。

# c# - 水晶报表查看器显示的报表布局与水晶报表中打开的报表不同

> ID：12173647
> 
> 赞同：2
> 
> 时间：2012-08-29T08:23:07.253
> 
> 标签：c#, crystal-reports, crystal-reports-2008, crystal-reports-xi

**水晶报表查看器版本**

```
<%@ Register Assembly="CrystalDecisions.Web, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304"
Namespace="CrystalDecisions.Web" TagPrefix="CR" %> 
```

Crystal Reports 2008版CR开发者，版本：12.0.0.549

**水晶报表中的报表**

![在此处输入图像描述](../Images/e385b377089f182f54ab2e9eec05901a.png)

**在 Crystal Report Viewer 中打开的报表**

![在此处输入图像描述](../Images/5ca074a40755e6e219a73ca16c49dabc.png)

为什么在水晶报表查看器 v13 中打开的报表与在水晶报表 2008 v 12 中打开的报表显示的布局不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T05:40:26.907

这是水晶报告 13.0.0.4 中的一个错误，我卸载了最新版本 13.0.4 并安装了旧版本 13.0.0.1，现在它显示了正确的格式。

# ipad - 在 iPad 的触摸事件上显示元素

> ID：12173651
> 
> 赞同：0
> 
> 时间：2012-08-29T08:23:13.507
> 
> 标签：ipad, touch

当用户点击/触摸行时，我需要一个函数来在网格的每一行中显示一些操作项。如附图所示。一次只能看到一行操作项。

任何帮助，将不胜感激。

问候，时代 ![在此处输入图像描述](../Images/0a2d741563f6d6ab0be20329e6a773d8.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T16:59:11.553

您仅正确使用 UITableView 。然后，您可以简单地获取该行的索引，并可以更改该索引的单元格。

# android - sendKeyDownUpSync 无法正常工作

> ID：12173653
> 
> 赞同：0
> 
> 时间：2012-08-29T08:23:21.320
> 
> 标签：android, instrumentation, keyevent

我对**sendKeyDownUpSync**有一些问题。我想在我的小部件中使用它来控制内置的音乐播放器。它几乎可以正常工作。几乎是因为当我调用函数时：

```
public void previousTruck()
    {
        final Instrumentation inst = new Instrumentation();
        new Thread(new Runnable() {         
            public void run() { 
                   new Instrumentation().sendKeyDownUpSync(KeyEvent.KEYCODE_MEDIA_PREVIOUS);

        }).start();     
    } 
```

它开始从我的播放列表中更改音乐，但是很多时间，为什么？我只想从播放列表中向下一首歌曲迈出一个“步骤”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:36:46.967

Somewhere in the *OnCreate*

```
myThread = new Thread()
{
    public void run()
    {
        Instrumentation m_Instrumentation = new Instrumentation();
        m_Instrumentation.sendKeyDownUpSync(KeyEvent.KEYCODE_MEDIA_PREVIOUS);
    }
}; 
```

Somewhere in your *previousTruck*

```
myThread.start(); 
```

**P.S. Be attentive!!** Creating Thread object without the *run()* invoking causes the memory leak - [see](http://code.google.com/p/android/issues/detail?id=7979). It happens during changing of screen orientation if you create a thread object inside the *OnCreate* and there is not the *run()* invoking till the next changing of screen orientation. That is why the best approach is to create Thread object immediately before it's *start()* invoking.

# javascript - 如何折叠页面加载时风格的手风琴的特定部分

> ID：12173658
> 
> 赞同：1
> 
> 时间：2012-08-29T08:23:44.757
> 
> 标签：javascript, jquery, html, jquery-ui, accordion

我有几个页面链接到我的手风琴网格所在的特定页面。在页面加载时，我希望手风琴网格的目标部分为用户自动折叠。

举个例子：页面 A 和页面 B。页面 A 是用户从页面 B 上查看内容的地方。页面 B 有一个带有 4 个（例如 1、2、3 和 4）部分的手风琴。如果用户单击从页面 A 到页面 B 的链接 2，则手风琴的数字 2 部分应折叠以供用户查看。

在下面找到代码：

**HTML：**

```
<div id="accord_bar">
<ul id="accordion">
<li><a href="#recent" class="heading">Number 1 Header</a>
<ul id="recent"><li>Number 1</li></ul>
</li>
<li><a href="#popular" class="heading">Number 2 Header</a>
<ul id="recent"><li>Number 2</li></ul>
</li>
<li><a href="#categories" class="heading">Number 3 Header</a>
<ul id="recent"><li>Number 3</li></ul>
</li>
<li><a href="#archive" class="heading">Number 4 Header</a>
<ul id="recent"><li>Number 4</li></ul>
</li></ul></div> 
```

**HEAD 标签中的 Javascipt：**

```
<script type="text/javascript">
$(document).ready(function() {
    $('#accordion').accordion(
    {active: "a.default", header: "a.heading"}
    );
}); 
```

**链接手风琴 Jquery 文件：**

```
<script type="text/javascript" src="js/jquery-ui-accordion.js"></script> 
```

我真的需要尽快解决这个问题，如果有人能提供帮助，我将非常感激......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:34:53.510

您可以使用 jQuery 构建自己的简单手风琴，无需 ui。

[`eq()`](http://api.jquery.com/eq/)用这种简单的手风琴结构折叠手风琴的特定部分。

[**这是带有悬停触发器的 jsFiddle。**](http://jsfiddle.net/gWcFD/68/)

**jQuery：**

```
$('.content').slideUp(100);
$('.content').eq(1).slideDown(600);
//for collapsing second part of an accordion

$('.panel').hover(function() {//open
    var takeID = $(this).attr('id');//takes id from clicked ele
    $('.content').stop(false,true).slideUp(600);
    //used stop for prevent conflict
    $('#'+takeID+'C').stop(false,true).slideDown(600);
    ///show's hovered ele's id macthed div
});​ 
```

**html:**

```
<div class="panel" id="panel1">panel1</div>
<div class="content" id="panel1C">content1</div>

<div class="panel" id="panel2">panel2</div>
<div class="content" id="panel2C">content2</div>

<div class="panel" id="panel3">panel3</div>
<div class="content" id="panel3C">content3</div> 
```

## ----------

[**这是带有单击触发器和关闭按钮的 jsFiddle。**](http://jsfiddle.net/gWcFD/69/)

**jQuery：**

```
$('.content').slideUp(100);
$('.content').eq(1).slideDown(600);
//for collapsing second part of an accordion

$('.panel').click(function() {//open
   var takeID = $(this).attr('id');//takes id from clicked ele
   $('#'+takeID+'C').slideDown(600);//show's clicked ele's id macthed div
});
$('span').click(function() {//close
   var takeID = $(this).attr('id').replace('Close','');//strip close from id
   $('#'+takeID+'C').slideUp(600);//hide clicked close button's panel
});​ 
```

**html:**

```
<div class="panel" id="panel1">panel1</div>
<div class="content" id="panel1C">content1<span id="panel1Close">X</span></div>

<div class="panel" id="panel2">panel2</div>
<div class="content" id="panel2C">content2<span id="panel2Close">X</span></div>

<div class="panel" id="panel3">panel3</div>
<div class="content" id="panel3C">content3<span id="panel3Close">X</span></div> 
```

注意：我之前回答过与此答案相关的手风琴： [折叠和展开标签 jquery / 简单手风琴](https://stackoverflow.com/questions/11504193/collapse-and-expand-tabs-jquery-simple-accordion/11504398#11504398)

# maven-3 - 如何在 WEB-INF/lib of war 中复制 3rd 方 jars

> ID：12173659
> 
> 赞同：1
> 
> 时间：2012-08-29T08:23:48.867
> 
> 标签：maven-3

我在 eclipse 中创建了动态 web 项目。我开发了一些需要的代码

POM 中提到的依赖 jar 以及一些 3rd 方 jar；所以我在

项目的构建路径。当我们编译和运行代码时需要这些 jars

部署在tomcat中。

下面的 pom.xml 用于构建战争。我想在 WEB 中包含这些 3rd 方 jars-

战争中的 INF/lib 文件夹。我需要在 pom 中进行哪些更改，以便这些 jar 将进入 WEB-INF/lib 文件夹？

有没有办法像在项目构建路径中添加的任何 jar 一样进入 WEB-

INF/lib 文件夹。

要不然

将所有 3rd 方 jars 放在 temp 文件夹中。然后使用复制命令我们可以从中复制这些 jars

这个临时文件夹到 WEB-INF/lib 文件夹。什么是最好的方法？

```
<project xmlns="http://maven.apache.org/POM/4.0.0" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion> 
  <groupId>com.sample</groupId> 
  <artifactId>SampleWS</artifactId> 
  <version>0.0.1-SNAPSHOT</version> 
  <packaging>war</packaging> 
  <name>Simple CXF project using spring configuration</name>
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId> 
        <artifactId>maven-compiler-plugin</artifactId> 
        <configuration>
          <source>1.5</source> 
          <target>1.5</target>
        </configuration>
      </plugin>
    </plugins>
  </build>
  <dependencies>
    <dependency>
      <groupId>org.apache.cxf</groupId> 
      <artifactId>cxf-rt-frontend-jaxws</artifactId> 
      <version>${cxf.version}</version> 
    </dependency>
  </dependencies> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T17:29:10.387

如果您只想在 WEB-INF/lib 文件夹中添加 3rd 方 jar，则无需对 POM.xml 进行任何更改。只需执行以下**项目 > 属性 > Java 构建路径 > 库 > 单击添加 JAR** ....在您的项目的 lib 文件夹中找到 JAR。现在这些 JAR 将与 POM.xml 中的 JAR 一起添加到战争中。

PS：我个人不建议部分从 POM 和部分从 lib 文件夹添加 jars。

# iphone - iPhone本地化卡在俄语上

> ID：12173663
> 
> 赞同：1
> 
> 时间：2012-08-29T08:24:01.160
> 
> 标签：iphone, localization, default

我目前正在为客户本地化一个应用程序，我们已经有 EFIGS，现在正在添加葡萄牙语和俄语。葡萄牙语一切正常，但是一旦我将 ru.lproj 添加到项目中，无论设备语言设置如何，该应用程序都将始终以俄语运行......有人经历过吗？有任何想法吗？提示？

# iphone - 动态按钮文字iphone

> ID：12173664
> 
> 赞同：0
> 
> 时间：2012-08-29T08:24:04.033
> 
> 标签：iphone, css, uibutton

如果你想在原生 iPhone 应用程序上制作多语言按钮，默认情况下它可以是一种语言，但根据你的设置，在同一个按钮上显示不同的文本，你会怎么做？

是否也可以为按钮上的文本设置样式（例如使用文本阴影和自定义字体）？

我不是 iOS 开发人员，但我正在尝试为 iOS 开发人员提供设计，但我还不了解从 CSS3 到 iOS UI 元素的限制。

到目前为止，iOS 开发似乎就像创建图像映射一样，其中没有任何 CSS 逻辑适用于 Web 开发，并且几乎所有 UI 元素似乎都需要所有状态作为平面图像。我认为控件更具动态性，但还没有找到正确的术语来让 google 的结果在该主题上非常及时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:37:25.670

你可以使用 NSLocalizedString 按钮上的多语言文本。

```
Configuring Button Title

  titleLabel  property
  reversesTitleShadowWhenHighlighted  property
– setTitle:forState:
– setTitleColor:forState:
– setTitleShadowColor:forState:
– titleColorForState:
– titleForState:
– titleShadowColorForState: 
```

还可以像这样设置自定义字体：

```
yourButton.titleLabel.font = [UIFont fontWithName:@"Courier" size:22.0]; 
```

如果你想为按钮添加渐变，那么你将不得不像这样使用[CALayer](http://developer.apple.com/library/ios/#DOCUMENTATION/GraphicsImaging/Reference/CALayer_class/Introduction/Introduction.html)：

```
yourButton.layer = //any modification in button's layer here 
```

有关更多信息，请参阅[UIButton](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIButton_Class/UIButton/UIButton.html)类参考

# mysql - MySQL外键用常数连接到两个表？

> ID：12173665
> 
> 赞同：2
> 
> 时间：2012-08-29T08:24:06.170
> 
> 标签：mysql, entity-framework, foreign-keys

我们有一个带有`employees`,`companies`和`addresses`表的 MySQL 数据库。设置是这样工作的：*员工和公司都有一个 id*。由于它们位于两个不同的表中，因此员工可以有 id = 1，而公司可以有 id = 1。两者都可以有多个地址。

现在地址表有两列将其链接到公司或员工：

```
element_id  
element_type_id 
```

element_type_id 为 1 = 个人或 2 = 公司

整个事情有点复杂，还有更多的表格，但这有点解释了这个概念。现在的问题是我们想开始使用实体框架，为此我们需要定义与外键的关系。
但是，对于我们目前的设置来说，这听起来几乎是不可能的，不是吗？由于地址表需要以某种方式与个人和公司相结合......

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:49:17.497

您已经说过这个概念不适合关系数据库。没错，MySQL 和所有其他的只是不支持它。而且它不是规范化的布局，因此可能会被数据库工程师视为不好的做法。

您应该考虑通过创建两个附加表来将地址与关系分开：employee_adresses 和 company_addresses，每个表都包含与公司和地址或员工和地址的关系。这样，您可能会获得一个用于公司和许多员工的地址，这可能是一件好事（标准化结构）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T12:56:33.833

这个概念被称为*多态关联*。我曾经问过一个关于它的[问题](https://stackoverflow.com/questions/8895806/how-to-implement-polymorphic-associations-in-an-existing-database)，因为我有一个类似的数据结构，我想让它具有参考意义。就这个问题而言，您`Address`对应于 Comment 表和`Employee`Person`Company`等。

答案非常好。如果您可以更改架构，我当然会选择并使用该方法。

如果您无法更改架构，您始终可以`Address`在 EF 模型中对您的类进行子类型化并`element_type_id`用作鉴别器列。您将创建子类型`EmployeeAddress`和`CompanyAddress`，其中`Employee`指的是前者和`Company` 后者。但是由于“整个事情有点复杂”，我不确定这在您的情况下是否可行。

# asp.net-mvc - 快捷键在 Visual Studio 2012 中不起作用

> ID：12173666
> 
> 赞同：6
> 
> 时间：2012-08-29T08:24:31.010
> 
> 标签：asp.net-mvc, keyboard-shortcuts, visual-studio-2012

特别是在 VS2012 中的 MVC 快捷方式有问题。

> 组合键（CTRL+M、CTRL+G）绑定到当前不可用的命令（Go To View）。

但例如 Refactor->Rename 工作。

*   禁用 ReSharper 没有帮助。
*   它适用于 VS2010，但不适用于 VS2012。

我查看了相关问题：[快捷键不起作用（Visual Studio 2010 with ASP.NET MVC 3 RC1）](https://stackoverflow.com/questions/4342501/shortcut-keys-not-working-visual-studio-2010-with-asp-net-mvc-3-rc1)

以前在 VS2010 中遇到过这个问题，并且接受的答案解决了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T06:56:36.983

我也有这个问题。问题出在项目文件上，这对我有用：

1.  创建一个新的 MVC 项目（可以使用 Basic 模板）
2.  打开新创建的项目文件并复制 <ProjectTypeGuids> 元素
3.  打开给出问题的项目文件并替换其 <ProjectTypeGuids> 元素
4.  重新加载项目，它应该可以工作。

# php - 大型数组的 PHP QuickHash 经验

> ID：12173669
> 
> 赞同：9
> 
> 时间：2012-08-29T08:24:34.927
> 
> 标签：php, arrays, performance, memory

有没有人有 PHP QuickHash ( [http://php.net/manual/en/book.quickhash.php](http://php.net/manual/en/book.quickhash.php) ) 的经验？

一些早期测试表明，大型阵列的内存使用量有了很大的改善。一个包含 1M 项的数组使用普通数组需要 226mb，而使用 QuickHash 只需要 41mb，速度大致相同。

但是，我几乎找不到实际在生产环境中使用它的人的故事，所以我很想知道是否有任何理由不在生产环境中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T09:22:07.350

它是为了低内存消耗和快速序列化和反序列化，从您的帖子中我可以理解实现了低内存消耗，您必须了解数据结构序列化的实际含义，并且它会改变体系结构和实现。我从未使用过它，但我已经对此进行了测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T11:10:06.270

它已更新到 1.0 稳定版，据开发人员称，它已经投入生产数年并且运行良好。

我们现在在一个项目中使用它，效果很好。它比默认数组具有更好的内存使用率。一个小问题（对我们来说）是它只适用于 int32 而不是 int64，但是我们已经能够解决这个问题。

# c++ - 在 /dev/input/event* 中动态查找鼠标事件 id

> ID：12173670
> 
> 赞同：2
> 
> 时间：2012-08-29T08:24:35.537
> 
> 标签：c++, linux, mouse

我正在使用此代码来读取 linux 中的鼠标输入事件。

```
 #define MOUSEFILE "/dev/input/event13"

      if((fd = open(MOUSEFILE, O_RDONLY)) == -1) {
        perror("opening device");
        exit(EXIT_FAILURE);
      }

      while(read(fd, &ie, sizeof(struct input_event)))
      {

      } 
```

我在终端中手动使用`cat /proc/bus/input/devices`来查找我连接的鼠标的事件 id，每次我重新启动 linux 时它都是不同的。有没有一种方法可以让我动态找到我连接的鼠标的事件 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:58:18.630

您可以使用自定义 udev 规则保持相同的设备名称。参见[这个](https://bbs.archlinux.org/viewtopic.php?id=18942)例子。

基本上，只需在下面创建一个文件`/etc/udev/rule.d`，如下所示：

```
 KERNEL=="event*", SYSFS{manufacturer}=="Microsoft", SYSFS{idProduct}=="0023", NAME="input/mstrackball" 
```

您可以在 sysfs 中找到产品 ID 和其他内容。

# java - 如何检查字符串是否包含从 20 .. 或 19 开始的年份

> ID：12173685
> 
> 赞同：-4
> 
> 时间：2012-08-29T08:25:31.940
> 
> 标签：java, string, pattern-matching

我有一个字符串，我想检查该字符串是否包含如下字符串，如果存在则获取该字符串 no（例如：2012）。（我正在尝试获得多年的字符串）

```
"from 20##" , "From 20##" , "from 19##" or "From 19##" 
```

和

```
 "to 20##" , "To 20##" , "to 19##" or "To 19##"    # can be any one digit no 
```

请告诉我该怎么做

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:37:55.430

使用**正则表达式**搜索模式。

`[/d]`您可以在正则表达式中用“”替换任何数字。

因此，如果您正在搜索`20##`，您的搜索模式将是`20[\d][\d]`。

看看[这个教程](http://www.vogella.com/articles/JavaRegularExpressions/article.html)是不是你还有疑惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T13:13:54.207

你真正需要的是

```
int year = Integer.parseInt(str.substring(str.length()-4) 
```

你可以自由检查`year >= 1900 && year < 2100`。

如果您需要断言字符串与您的模式匹配，您可以测试

```
str.matches("([Ff]rom|[Tt]o)\\s+\\d{4}") 
```

# xcode - 如何在 Xcode 中隐藏自动布局指南？

> ID：12173697
> 
> 赞同：3
> 
> 时间：2012-08-29T08:25:58.803
> 
> 标签：xcode, interface-builder, autolayout

我发现 Xcode 中新的自动布局功能非常有用。但是 Xcode 总是将自动布局约束显示为蓝色引导线。这有时很烦人，因为这些指南显示在视图的中心和边缘，也就是调整大小手柄所在的位置。

![在此处输入图像描述](../Images/8371e30b2285247dfd88e5a81516992e.png)

所以有时我无法通过拖动手柄来调整视图的大小，因为我无法抓住它们。单击将始终选择蓝色约束引导线。（而且我必须使用尺寸检查器调整大小）。

有没有办法（暂时）隐藏这些约束指南？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-06-24T11:20:46.613

在主菜单中转到：

**编辑器 > 画布 > 显示约束**（将其切换为未选中）

从此菜单中，您还可以显示/隐藏布局和边界矩形、选择 hgihlight 和调整旋钮大​​小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T10:37:21.613

这在 Xcode 4.5.2 中已修复

要完全关闭新的布局系统，只需在文件检查器中取消选中“使用自动布局”：

![在此处输入图像描述](../Images/10d85989387e80b4953b4c5d0d7f8624.png)

# java - Stripes UrlBinding - 参数在提交时消失

> ID：12173702
> 
> 赞同：1
> 
> 时间：2012-08-29T08:26:25.967
> 
> 标签：java, stripes

我在我的所有actionbeans 上使用URL 绑定，其中一些需要一个参数，例如/admin/users/123。

以这个 URL 为例，在我的 actionbean 中，我可以获取参数 123 并很好地显示用户信息。同一页面允许更改用户信息，这就是问题所在。

提交更新的用户信息后，URL 变为 /admin/users。

这是一个问题，因为调用 context.getRequest().getRequestURL() 会返回 /admin/users 而不是 /admin/users/123。

我认为这是由于标签在jsp中的写入方式：

```
<stripes:form beanclass="com.name.ui.web.stripes.action.admin.UserActionBean">...</stripes:form> 
```

解决为

```
<form action="/admin/users" method="post">...</form> 
```

相应的 actionbean 编码和注释如下：

```
@UrlBinding("/admin/users/{userId}")
public class UserActionBean{ 
  private long userId;
  public long getUserId(){return userId;}
  public void setUserId(long userId){this.userId=userId;}
} 
```

有没有人遇到过同样的问题并设法解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T12:20:48.940

正如Martin Walsh 在 Stripes 邮件列表中所[回答](http://sourceforge.net/mailarchive/message.php?msg_id=29742440)`<stripes:param>`的那样，您可以使用内部的标签`<stripes:form>`。我要补充一点，做一个 redirect-after-post （或[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)）也可以让你返回到你的 /admin/users/123 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T21:54:58.567

即使您没有使用 JSP（在我的情况下，我使用的是 Velocity），您仍然可以明确地将 id (123) 放入请求中并转发，或者您可以按照 Frank 的指示在发布后重定向。

# grails - 可以从另一个插件覆盖插件的控制器吗？

> ID：12173708
> 
> 赞同：3
> 
> 时间：2012-08-29T08:26:54.143
> 
> 标签：grails, plugins, grails-plugin

我正在开发一个插件（MyPlugin），它结合了一些安全功能，将其用作我下一个 Grails 应用程序的标准插件。它集成了`Spring-Security-Core`和`Spring-Security-UI`插件，并且通过它的安装，所有依赖项都应该通过添加依赖项来自动安装`BuildConfig`：`plugins { compile: ...}`

到目前为止一切正常，但在 MyPlugin 中，我正在更改`Spring-Security-UI`插件的行为（用户域中的密码编码），方法是覆盖`UserController`. 执行 MyPlugin 会导致预期的行为，并使用正确的控制器创建新用户。

`UserController`但是，当在另一个 Grails 应用程序中安装 MyPlugin 时，此行为会失败并使用`Spring-Security-Ui`插件的原始版本。

我试图通过配置文件中的`dependsOn`and`loadAfter`属性来解决这个问题`GrailsPlugin`，但没有成功。

有可能解决这个问题吗？还是只能覆盖主应用程序中的行为/控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T00:08:37.000

Grails 2.2 具有控制器命名空间 [http://grails.org/doc/2.2.0.RC1/guide/introduction.html#whatsNew22](http://grails.org/doc/2.2.0.RC1/guide/introduction.html#whatsNew22)

所以你可以放入类似的东西

```
def index() {
        redirect controller: 'user', action: 'list', plugin: 'springSecurity'
    } 
```

# objective-c - Objective-C 理解 isKindOfClass

> ID：12173711
> 
> 赞同：2
> 
> 时间：2012-08-29T08:27:00.057
> 
> 标签：objective-c, casting, nsnumber

最新版本的 Objective-C 和 XCode (4.4)。

我有一个代码片段，但我不明白为什么我可以使用某些行，让我解释一下：

```
// For understanding purpose : (NSMutableArray*)_programStack

id l_topItemOnStack = [_programStack lastObject];
if([l_topItemOnStack isKindOfClass:[NSNumber class]])
{
    return [l_topItemOnStack doubleValue];
} 
```

我的问题：由于 my`l_topItemOnStack`是 type`id`并且我没有将其转换为 a `NSNumber`，我怎么能使用`[l_topItemOnStack doubleValue]`.

我猜我必须先将它转换为 NSNumber 才能访问 NSNumber 方法......

我在这里想念什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T08:33:40.970

因为 Objective-C 是一种动态语言，消息名称和它们的声明只是编译器的提示——实际的消息查找和发送发生在运行时。因此，即使编译器不知道您的对象响应了`doubleValue`消息，它仍然能够让您调用

```
return objc_msgSend(l_topItemOnStack, @selector(doubleValue)); 
```

和往常一样。

此外，编译器查找在包含的标头中任何位置声明的所有选择器，并尝试使用实际上下文找到最佳匹配 - 这里 doubleValue 是一个唯一名称 - 它仅在 NSNumber 上声明，因此编译器*假定*您的对象确实是一个 NSNumber。

如果你真的想避免这种情况，要么在调用方法时强制转换对象，要么最初将其声明为 NSNumber。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T08:32:20.880

`id`代表任何 Objective-C 类。它与 不同`NSObject *`，因为在这种情况下，如果不将其转换为第一个，您将无法使用该`-doubleValue`方法`NSNumber`。

`id`您可以向( `nil`is of type )发送任何消息`id`，而无需将其强制转换为特定类。但是，您应该小心，因为无法识别的选择器会导致崩溃。

**编辑：**
`id`意思是：一个指向未知类的Objective-C对象的指针

如果您想了解更多关于 之间的区别`id`，您应该阅读这篇博文： http: [//unixjunkie.blogspot.de/2008/03/id-vs-nsobject-vs-id.html](http://unixjunkie.blogspot.de/2008/03/id-vs-nsobject-vs-id.html)`void *``NSObject *`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-29T08:33:31.630

编译器只是将对象与翻译可见的选择器匹配（通过`#import`）。

如果在查找要匹配的选择器时存在歧义，或者如果签名不匹配并且声明了多个选择器，它可能会抱怨消息。在这种情况下，您要么必须强制转换对象：

```
return [(NSNumber*)l_topItemOnStack doubleValue]; 
```

或将其分配给一个新变量：

```
NSNumber * number = l_topItemOnStack;
return [number doubleValue]; 
```

为了消除类型的歧义，让编译器知道正确的选择器签名（例如，它可以正确设置堆栈）。

在 MRC 中，编译器实际上可以“假定”参数和返回类型（默认为`id`）——但这在 ARC 中是被禁止的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-29T08:35:01.303

首先你检查**topItemOnStack 是否是 NSNumber 的类型，**因为**NSNumber 继承 NSValue**

**NSValue 对象是单个 C 或 Objective-C 数据项的简单容器。它可以保存任何标量类型，例如 int、float 和 char，以及指针、结构和对象 ID**

```
topItemOnStack can now be of any type floatValue, intValue or doubleValue as per our requirement 
```

通过使用 isKindOfClass 不是将 topItemOnStack 转换为 NSNumber，而是检查它是否属于 NSNumber 类型。

**isKindOfClass**指示接收者是给定类的实例还是从该类继承的任何类的实例

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T08:35:22.317

Objective-C 对象具有捆绑的运行时类型信息（著名的`isa`指针）。

您可以向任何对象发送任何消息；如果编译器找不到编译时类型信息来决定对象是否响应选择器（在这种情况下），编译器会抱怨（警告）`doubleValue`，但我相信类型的对象`id`，是通用的，不受此规则的约束，任何事情都会发生在编译时（**请更有知识的人确认这一点**）。

当然，如果id类型的变量指向的对象没有实现相应的方法（即无法响应发送的消息），就会抛出异常。在 iOS 中，这意味着应用程序崩溃（除非有问题的对象已覆盖此默认行为）。在 OS X 上，并非总是如此（**再次，请更有知识的人确认这一点**）。

# google-drive-api - Google 驱动器和授权的 HTTP GET 用于下载文件

> ID：12173712
> 
> 赞同：1
> 
> 时间：2012-08-29T08:27:00.977
> 
> 标签：google-drive-api

我为 Google Drive 开发应用程序。我在下载文件时遇到问题。官方文档用下面的话描述了这个过程：“要下载文件的内容，请向文件的 downloadUrl 发送授权的 HTTP GET 请求。”。主要问题在于“授权的 HTTP GET 请求”。我用过：

*   登录：密码@downloadUrl
*   downloadUrl&access_token={my_token}
*   downloadUrl&access_key={my_token}
*   downloadUrl&key={my_token}

这些都没有帮助我。如果我尝试下载文件，它会在第一时间打开浏览器进行授权。你能帮我下载没有用户授权的文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T16:11:53.007

要下载文件的内容，您需要在授权的 HTTP 请求中使用 OAuth 2.0 访问令牌，例如：

```
GET <dowloadUrl>
Authorization: Bearer <ACCESS_TOKEN> 
```

`curl`您可以使用以下命令尝试此操作：

```
curl <downloadUrl> -H 'Authorization: Bearer <ACCESS_TOKEN>' 
```

如果您希望能够使用 cookie 身份验证（使用当前登录用户的 cookie）从 Web 浏览器下载文件，则应使用 cookie 来`webContentLink`代替。

# ruby-on-rails - 多态或 has_many :through 用于记录现金流

> ID：12173713
> 
> 赞同：0
> 
> 时间：2012-08-29T08:27:01.820
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, has-many-through, polymorphic-associations

到目前为止，我已经花了一天时间尝试对以下内容进行建模，我认为这应该很简单，我已经看太多了，可能有一个明显的解决方案在盯着我看..

目标：在其上`Users`记账，用户访问区域以记录那些（入款）、（入款）但仅与客户相关的付款，并记录与事件或客户无关的一般（出款）。`clients``events``cashbox``chargeable events``other_charges``expenses`

到目前为止：使用正确关联创建的用户、客户端和事件模型。典型场景；用户将客户端预订到事件中，该事件可以收费（布尔值）。

```
# == Associations so far

class User < ActiveRecord::Base
  has_many :clients
  has_many :events
end

class Client < ActiveRecord::Base
  has_one :user, through: :events
  has_many :events
end

class Event < ActiveRecord::Base
  belongs_to :user
  belongs_to :client
end 
```

问题：关联应该`cashbox`是多态的还是 has_many :through？

他们让我使用多态来理解它；事件、其他费用和费用可能是`cashboxable`. 这样做的缺点是我知道我不能`sum`过度多态关联？

通过 has_many，我很困惑如何将其关联起来，这似乎很复杂。但我可能会遗漏一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T20:08:17.637

```
class User < ActiveRecord::Base
  has_many :clients
  has_many :events
end

class Client < ActiveRecord::Base
  belongs_to :user, through: :events
  has_many :events
end

class Event < ActiveRecord::Base
  belongs_to :user
  belongs_to :client
end 
```

# hadoop - 从 HDFS 传出文件

> ID：12173715
> 
> 赞同：18
> 
> 时间：2012-08-29T08:27:01.973
> 
> 标签：hadoop, hdfs, data-transfer

我想将文件从 HDFS 传输到不在 hadoop 集群中而是在网络中的不同服务器的本地文件系统。

我本可以这样做：

```
hadoop fs -copyToLocal <src> <dest>
and then scp/ftp <toMyFileServer>. 
```

由于数据很大，并且由于 hadoop 网关机器的本地文件系统空间有限，我想避免这种情况并将数据直接发送到我的文件服务器。

请提供有关如何处理此问题的一些指示。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-06-05T14:25:45.980

这是最简单的方法：

```
ssh <YOUR_HADOOP_GATEWAY> "hdfs dfs -cat <src_in_HDFS> " > <local_dst> 
```

它也适用于二进制文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T20:17:54.340

因此，您可能有一个包含一堆部分的文件作为 hadoop 程序的输出。

```
part-r-00000
part-r-00001
part-r-00002
part-r-00003
part-r-00004 
```

所以让我们一次做一个部分？

```
for i in `seq 0 4`;
do
hadoop fs -copyToLocal output/part-r-0000$i ./
scp ./part-r-0000$i you@somewhere:/home/you/
rm ./part-r-0000$i
done 
```

您可能需要查找 scp 的密码修饰符

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-05T16:39:01.590

您可以使用 webHDFS REST API 来做到这一点。`curl`从要下载文件的机器上执行。

```
curl -i -L "http://namenode:50075/webhdfs/v1/path_of_the_file?op=OPEN" -o ~/destination 
```

另一种方法可能是使用`DataNode API`through`wget`来做到这一点：

```
wget http://$datanode:50075/streamFile/path_of_the_file 
```

但是，恕我直言，最方便的方法是使用 NameNOde webUI。由于这台机器是网络的一部分，您只需将网络浏览器指向`NameNode_Machine:50070`. 之后浏览 HDFS，打开要下载的文件并单击`Download this file`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-29T08:44:29.570

我认为最简单的解决方案是网络挂载或 SSHFS 在本地模拟本地文件服务器目录。
您还可以将 FTP 挂载为本地目录： [http ://www.linuxnix.com/2011/03/mount-ftp-server-linux.html](http://www.linuxnix.com/2011/03/mount-ftp-server-linux.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-06T15:05:39.863

我也在尝试这样做（我使用的是 Kerberos 安全性）。这在小更新后帮助了我：[https ://hadoop.apache.org/docs/r1.0.4/webhdfs.html#OPEN](https://hadoop.apache.org/docs/r1.0.4/webhdfs.html#OPEN)

直接运行`curl -L -i --negotiate "http://<HOST>:<PORT>/webhdfs/v1/<PATH>?op=OPEN"`对我不起作用，我会解释原因。

该命令将执行两个步骤：

1.  找到您要下载的文件并创建一个临时链接 - 返回`307 Temporary Redirect`

2.  他将从这个链接下载一个数据返回`HTTP 200 OK`。

切换器`-L`说他拿了一个文件，直接继续锯。如果您添加到 curl 命令`-v`，它将记录到输出；如果是这样，正如我所说，您将在命令行中看到描述的两个步骤。但是 - 因为由于旧版本 curl （我无法更新）它不会工作。

解决方案（在外壳中）：

```
LOCATION=`curl -i --negotiate -u : "${FILE_PATH_FOR_DOWNLOAD}?op=OPEN" | /usr/bin/perl -n -e '/^Location: (.*)$/ && print "$1\n"'` 
```

这将获得临时链接并将其保存到`$LOCATION`变量。

```
RESULT=`curl -v -L --negotiate -u : "${LOCATION}" -o ${LOCAL_FILE_PATH_FOR_DOWNLOAD}` 
```

如果您添加`-o <file-path>`.

我希望它有所帮助。

J。

# xslt - XSLT 循环 - 一次四个节点

> ID：12173722
> 
> 赞同：0
> 
> 时间：2012-08-29T08:27:21.430
> 
> 标签：xslt, loops, muenchian-grouping

首先我知道这个问题：[XSLT: Loop selections two elements at time](https://stackoverflow.com/questions/1131866/xslt-loop-selecting-two-elements-at-a-time)

但是，由于元素结构，我没有发现它可以工作，或者我只是使用 mod 失败了，两者之一。

```
<input>
  <node>
    <id>1</id>
    <value>3</value>
  </node>
  <node>
    <id>1</id>
    <value>3</value>
  </node>
  <node>
    <id>1</id>
    <value>3</value>
  </node>
  <node>
    <id>1</id>
    <value>3</value>
  </node>
  <node>
    <id>2</id>
    <value>4</value>
  </node>
  <node>
    <id>2</id>
    <value>4</value>
  </node>
  <node>
    <id>2</id>
    <value>4</value>
  </node>
  <node>
    <id>2</id>
    <value>4</value>
  </node>
</input> 
```

我有以下 XML 布局，其结构如下： - 相同 ID 的节点总是被分组在一起 - 一个 ID 总是有四个节点

我希望能够一次选择一个 ID 的四个节点并循环遍历每组四个节点，以便我可以将数据操作到一个输出行中。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:42:49.570

这个 XSLT：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

<xsl:key name="keyByID" match="node" use="id"/>

<xsl:template match="/">
    <output>
        <xsl:apply-templates/>
    </output>
</xsl:template>

<xsl:template match="input">
    <xsl:for-each select="node[generate-id()=generate-id(key('keyByID',id)[1])]">
        <block>
            <id>
                <xsl:value-of select="id"/>
            </id>
            <value>
                <xsl:value-of select="value"/>
            </value>
        </block>
    </xsl:for-each>
</xsl:template>

</xsl:stylesheet> 
```

应用于您的输入 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<input>
<node>
    <id>1</id>
    <value>3</value>
</node>
<node>
    <id>1</id>
    <value>3</value>
</node>
<node>
    <id>1</id>
    <value>3</value>
</node>
<node>
    <id>1</id>
    <value>3</value>
</node>
<node>
    <id>2</id>
    <value>4</value>
</node>
<node>
    <id>2</id>
    <value>4</value>
</node>
<node>
    <id>2</id>
    <value>4</value>
</node>
<node>
    <id>2</id>
    <value>4</value>
</node>
</input> 
```

给出这个分组的输出 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<output>
<block>
    <id>1</id>
    <value>3</value>
</block>
<block>
    <id>2</id>
    <value>4</value>
</block>
</output> 
```

输出按 分组`<id>`。那是你要找的吗？我不确定。这个 Muenchian Grouping 只是简化了您的结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T11:53:52.157

**由于*保证*`node`元素始终以 4 个为一组，因此可以通过不使用任何分组方法***（例如 Muenchian 或兄弟比较）的非常简单的转换来产生所需的输出**，并且可能更有效**：*

 *```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*" name="identity">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="node">
  <sample>
   <xsl:call-template name="identity"/>
  </sample>
 </xsl:template>
 <xsl:template match="node[not(position() mod 4 = 1)]"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<input>
  <node>
    <id>1</id>
    <value>3</value>
  </node>
  <node>
    <id>1</id>
    <value>3</value>
  </node>
  <node>
    <id>1</id>
    <value>3</value>
  </node>
  <node>
    <id>1</id>
    <value>3</value>
  </node>
  <node>
    <id>2</id>
    <value>4</value>
  </node>
  <node>
    <id>2</id>
    <value>4</value>
  </node>
  <node>
    <id>2</id>
    <value>4</value>
  </node>
  <node>
    <id>2</id>
    <value>4</value>
  </node>
</input> 
```

**产生了想要的正确结果**：

```
<input>
   <sample>
      <node>
         <id>1</id>
         <value>3</value>
      </node>
   </sample>
   <sample>
      <node>
         <id>2</id>
         <value>4</value>
      </node>
   </sample>
</input> 
```

**说明**：

1.  **[身份规则](http://dpawson.co.uk/xsl/sect2/identity.html)**“按原样”复制选择执行它的每个节点。

2.  另一个模板覆盖作为其父级的第 st子级的每个`node`元素的标识模板。此模板生成一个包装器元素 ( )，然后*按名称*调用标识模板以将其自身复制到输出。`4k+1``node``sample`

**   还有一个模板覆盖了每个`node`元素的标识模板。此模板匹配每个`node`元素，但将被选中执行（优先于前一个模板），仅适用于与前一个模板不匹配的节点 - 即任何`node`不是其父级的`4k+1`st 子级的元素。`node`之所以如此，是因为这个模板没有前一个模板*那么具体。*

    *   上面 3\. 中讨论的模板没有正文，这有效地`node`从输出中“删除”匹配的元素。* 

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:38:45.467

如果您可以保证相同 id 的节点将始终像这样相邻，那么

```
<xsl:template match="node[not(preceding-sibling::node[1]/id = id])"> 
```

将匹配每个 id 的*第一个*节点（从技术上讲，任何 id 与其之前的节点不同的节点，如果有的话），并且在该模板中您可以使用它`following-sibling::`来查找其他节点，或者简单地在顶部定义一个键level 然后使用它来提取具有相同 id 的所有节点。**

# c# - 向 C# 结构添加功能

> ID：12173723
> 
> 赞同：0
> 
> 时间：2012-08-29T08:27:23.860
> 
> 标签：c#, events, design-patterns, data-structures, extension-methods

我试图找到如何向 C# 结构添加功能，并且以一种比将它们包装在全新类中更优雅的方式。扩展方法没有覆盖那么强大，而且绝对不能提供结构事件触发/处理能力。

然而，我目前面临的具体问题是检测 Vector2 结构成员的变化并做出反应。不过，这只是一个内部要求，因此我的库的用户在与它交互时应该能够使用/感知 Vector2 结构（同时仍会触发内部事件）。

* * *

**通常，除了扩展方法或封装之外，我如何扩展 C# 结构？**

**具体来说，如何扩展 Vector2 结构以支持事件触发/处理？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T09:10:59.517

> 通常，除了扩展方法或封装之外，我如何扩展 C# 结构？

唯一的方法是创建扩展方法或使用封装。

> 具体来说，如何扩展 Vector2 结构以支持事件触发/处理？

正如我之前所说，您可以使用封装并**创建一个类**。所以使用这个代码：

```
public class ExtendedVector2 {
    public Vector2 Vector{
        get;
        private set;
    }

    public ExtendedVector2(float value){
        Vector = new Vector2(value);
    }   

    public ExtendedVector2(float x, float y){
        Vector = new Vector2(x, y);
    }
} 
```

然后你可以添加接口、方法和事件。

**编辑 ：**

> 但是我如何检测 X 或 Y 是否发生变化？假设用户“获取”了 Vector，然后设置其成员之一（X 或 Y）。我可以在设置整个向量时添加事件触发，但不能在“获取”之后设置其中一个成员时添加事件触发。请记住，我不想强​​迫用户使用新的矢量类来与我的库进行交互。我什至不希望他/她知道内部正在使用一个新的向量类。

首先，如果您想完全掩盖内部使用的类型结构，`Vector2`您应该以这种方式重写所有方法：

```
public class ExtendedVector2 {
    //...
    private Vector2 _vector2;  

    //mask X and Y values of Vector2 structure 
    public float X{
        set{ _vector2.X = value; }
        get{ return _vector2.X; }
    }

    public float Y{
        set{ _vector2.Y = value; }
        get{ return _vector2.Y; }
    } 

    //example to mask a method of Vector2 structure 
    public static float Dot(ExtendedVector2 value1, ExtendedVector2 value2){
        return Vector.Dot(value1, value2);
    }

    //override the cast to Vector2
    public static implicit operator Vector2(ExtendedVector2 value) //I'd make it implicit because I'd think to it like an upcast
    {
        return new Vector2(value.X, value.Y);
    }
} 
```

更多信息[请看这里](http://msdn.microsoft.com/en-us/library/bb196385.aspx)。

现在，如果您想创建一个在成员更改时触发的事件，这很简单。我会创建一个定制的 EventArgs。让我们写一些代码：

```
//use the convention of eventName+EventArgs
class MemberChangedEventArgs : EventArgs
{
    public readonly float LastValue{
        get;
        set;
    }
    public readonly float NewValue{
        get;
        set;
    }

    public MemberChangedEventArgs(float LastValue, float NewValue)
    {
        this.LastValue = LastValue;
        this.NewValue = NewValue;
    }
} 
```

然后你可以编写自己的事件：

```
public class ExtendedVector2 {
    private Vector2 _vector2;  

    public float X{
         set{                  
             if(_vector2.X != value)           
               OnMemberXChanged(new MemberChangedEventArgs(_vector2.X, value));

             _vector2.X = value;   
         }
         get{ return _vector2.X; }
    }

    public float Y{
         set{ 
             if(_vector2.Y != value)
               OnMemberYChanged(new MemberChangedEventArgs(_vector2.Y, value));

             _vector2.Y = value;                    
         }
         get{ return _vector2.Y; }
    }        

    public event EventHandler<MemberChangedEventArgs> MemberXChanged;
    public event EventHandler<MemberChangedEventArgs> MemberYChanged;

    public ExtendedVector2(float value){
        Vector = new Vector2(value);
    }   

    public ExtendedVector2(float x, float y){
        Vector = new Vector2(x, y);
    }

    private virtual void OnMemberXChanged(MemberChangedEventArgs e){
        if(MemberXChanged != null)
           MemberXChanged(this, e);
    }

    private virtual void OnMemberYChanged(MemberChangedEventArgs e){
        if(MemberYChanged != null)
           MemberYChanged(this, e);
    }
    //... 

    //here mask the Vector2 structure using the previous solution
} 
```

# java - 用于从现有代码创建大型 Java 类图的 Eclipse 插件

> ID：12173724
> 
> 赞同：4
> 
> 时间：2012-08-29T08:27:30.263
> 
> 标签：java, eclipse, eclipse-plugin, uml, class-diagram

我正在寻找一个 Eclipse 插件来从现有的 Java 代码（免费/开源）创建大型类图。我发现了一些从 java 代码创建图表的插件，反之亦然，但是该项目有大量的包（大约 80 个）和类/接口（大约 1000-1500），我想为整个代码创建一个图表，具有不同的选项（例如，不在生成的图表中包含接口或为某些包创建图表）。我知道该图会非常大，但这正是我真正想要在单个图中表示项目的内容（并且省略了不重要的类、接口、包等以及成员和方法名称）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T09:11:08.253

试试[ObjectAid UML Explorer](http://www.objectaid.com/home)。你也应该试试[JUPE](http://jupe.binaervarianz.de/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T17:17:40.680

项目规模令人印象深刻。在开始使用图表之前，请尝试回答以下问题：

*   您将创建多少个图表（大约）？
*   你在一张图上花了多少时间（平均）？
*   什么是总估计和允许的时间努力？
*   结果值得努力吗？
*   结构在改变吗？
*   在将模型与更改的代码同步后，需要在图表审查+修复中投入多少时间？
*   维护图表需要花费多少时间？

对于上述规模的项目，最有可能的结果是不值得付出努力，并且很可能模型和图表将不断过时。

即使是小得多的项目（< 100 个班级单位），我也面临着类似的情况。我尝试了一些独立的工具——最好的是[Enterprise Architect](http://www.sparxsystems.com/products/ea/index.html)（商业），其次是 JUDE（目前[是 astah*](http://astah.net/editions/community)，但它们切断了社区版的导入功能）。但是，它们和其他工具没有发现依赖关系，没有显示参数化类型 (List<Something>)，也没有显示注释。

所以最后我开始使用免费的 UML browser/navigator - [Class Visualizer](http://www.class-visualizer.net/)。这就像使用交互式地图与扫描的纸质地图一样。它允许查看选定的类及其所有关系：超类、实现的接口、子类、引用的类（关联、依赖关系）、用法（关联、依赖关系）。它处理并显示参数化类型和注释。我可以通过关系导航到其他类。所选课程显示所有详细信息，关系 - 没有。我在您大小的项目上尝试过 - 立即生成包含数百个关系的图表。并且它的存储库是编译的java项目，所以模型与代码的同步没有问题。

# c# - 从不同的数据库中检索行

> ID：12173726
> 
> 赞同：0
> 
> 时间：2012-08-29T08:27:33.503
> 
> 标签：c#, asp.net, database

我需要从不同的数据库中检索一行。如何从差异数据库中检索数据并合并到一个数据表中？

我需要检索这些行并将它们导出到 Excel

请帮我找到解决方案。

这是我的代码：

```
 public void Execute(IJobExecutionContext context)
  {
        try
        {
            logger.InfoFormat("....blcExportExcel start run....  ");
            SqlCommand com1 = null;
            //SqlCommand comCount = null;
            SqlConnection con1 = null;

            //--for microsoft 2003--
            string strDownloadFileName = "E://lewre/excel/color/delete_" + DateTime.Now.ToString("yyyyMMddHHmm") + ".xls";
            string oleDbConnection = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + strDownloadFileName + ";Extended Properties='Excel 8.0;HDR=Yes'";
            //**for microsoft 2003**

            //--for microsoft 2007--
            //string strDownloadFileName = "E://lewre/excel/" + DateTime.Now.ToString("yyyyMMddHHmmss") + ".xlsx";
            //string oleDbConnection = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + strDownloadFileName + ";Extended Properties='Excel 12.0 Xml;HDR=Yes'";
            //**for microsoft 2007**

            //--Export product for icenter 25/7/2012--
            string query = @"

                   select lewre_article.SKU_CODE,icenter_acStockCompany.AcStockID
                from 
                [LEWREDB].[dbo].[LEWRE.PRODUCT] as lewre_article
                left join  [iCenter].[dbo].[AcStockCompany] as icenter_acStockCompany
                on (lewre_article.SKU_CODE = icenter_acStockCompany.AcStockID )
                where icenter_acStockCompany.AcStockID is  null
            ";

            //**Export product for icenter 25/7/2012**
            con1 = new SqlConnection(ConfigurationManager.ConnectionStrings["iCenterConnectionString"].ConnectionString);
            con1.Open();

            com1 = new SqlCommand(query, con1);
            DataTable dt = new DataTable();
            SqlDataAdapter ada = new SqlDataAdapter(com1);
            ada.Fill(dt);

            //--If no record then return--
            if (dt.Rows.Count == 0)
            {
                return;
            }
            //**If no record then return**

            using (OleDbConnection conn = new OleDbConnection(oleDbConnection))
            {
                // Create a new sheet in the Excel spreadsheet.
                string createTable = " ";
                createTable += " create table Query( SKU_CODE varchar(50) , AcStockID varchar(50))";
                // Create a new sheet in the Excel spreadsheet.
                OleDbCommand cmd = new OleDbCommand(createTable, conn);

                // Open the connection.
                conn.Open();

                // Execute the OleDbCommand.
                cmd.ExecuteNonQuery();

                cmd.CommandText = @"INSERT INTO Query (
                 SKU_CODE, AcStockID ) 

                values (?,?) ";
                // Add the parameters.
                cmd.Parameters.Add("SKU_CODE", OleDbType.VarChar, 50, "SKU_CODE");
                cmd.Parameters.Add("AcStockID", OleDbType.VarChar, 50, "AcStockID");

                // Initialize an OleDBDataAdapter object.
                OleDbDataAdapter da = new OleDbDataAdapter("select * from Query ", conn);

                // Set the InsertCommand of OleDbDataAdapter, 
                // which is used to insert data.
                da.InsertCommand = cmd;
                // Changes the Rowstate()of each DataRow to Added,
                // so that OleDbDataAdapter will insert the rows.

                foreach (DataRow dr in dt.Rows)
                {
                    dr.SetAdded();
                }

                // Insert the data into the Excel spreadsheet.
                da.Update(dt);
            }

            JobKey jobKey = context.JobDetail.Key;
            logger.InfoFormat("blcPosExcel : {0} executing at {1}", jobKey, DateTime.Now.ToString("r"));
            logger.InfoFormat("excel post run finnish ");

        }
        catch (Exception ex)
        {
            logger.Error(ex.Message);
            throw;

        }
    }
} 
```

我的连接字符串

```
 <!--Koo Testing Server-->
    <add name="LEWREDBConnectionString" connectionString="Data Source=NATE-PC\SQLEXPRESS2008R2;Initial Catalog=LEWREDB_WEB_TEST;User ID=user1;Password=user" providerName="System.Data.SqlClient" />
    <add name="LEWREDBEntities" connectionString="metadata=res://*/ClassModel.LinQLewre.csdl|res://*/ClassModel.LinQLewre.ssdl|res://*/ClassModel.LinQLewre.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=NATE-PC\SQLEXPRESS2008R2;Initial Catalog=LEWREDB_WEB_TEST;Persist Security Info=True;User ID=user1;Password=user;MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient" />
    <add name="iCenterConnectionString" connectionString="Data Source= NATE-PC\SQLEXPRESS2008R2;Initial Catalog=iCenter_Testing;User ID=user2;Password=user" providerName="System.Data.SqlClient" />
    <!--Koo Testing Server--> 
```

我得到的错误：

> 无法打开登录请求的数据库“iCenter_Testing”。登录失败。用户“user2”登录失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:28:34.280

检查数据库`user2`中是否存在`iCenter_Testing`以及用户是否具有正确的权限。如果连接数据库，可以运行以下代码查看用户是否存在：

`SELECT name FROM master.dbo.syslogins WHERE name = 'user2'`

但是，如果您能够使用 登录到数据库`user2`，则可能是没有必要的`iCenter_Testing`数据库权限。

`SELECT HAS_DBACCESS('iCenter_Testing');`

上面的 SQL 将返回一个`1`or `0`。`1`表示用户有权访问数据库。

要找出用户也可以访问哪些数据库，您可以运行以下代码：

```
SELECT [Name] as DatabaseName 
FROM master.dbo.sysdatabases
WHERE ISNULL(HAS_DBACCESS([Name]),0)=1
ORDER BY [Name] 
```

# wpf - 子抗锯齿字体

> ID：12173729
> 
> 赞同：4
> 
> 时间：2012-08-29T08:27:44.470
> 
> 标签：wpf, fonts, antialiasing

在某些地方，我启用了 sub antialiasing，而在其他地方，我没有。我使用结合 ClearType 的“显示”渲染模式。

但是，它确实是随机的，它使用灰度抗锯齿，而不是彩色抗锯齿。而且看起来很糟糕。我怎么能强迫它？

根据我猜的操作系统，它的工作方式不同。但奇怪的是，有些地方我有 SubAA，而另一些地方我没有。

当在不同的窗户上时，有些地方我整体上都有 subAA。您知道为什么会存在这种不一致吗？我要苏巴！！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T09:59:19.190

There are certain situations when ClearType will get disabled in the rendering path which means it will then revert to grey scale anti-aliasing:

*   When you use `AllowsTransparency="True"` on a `Window`

*   When ClearType is disabled in Windows Settings (and you haven't used TextOptions.TextRenderingMode="ClearType" to force the use of ClearType)

*   ClearType text does not display correctly on a background that is not fully opaque i.e you introduce some transparency.

*   If Text is rendered to an intermediate target due to the use of a:

    *   VisualBrush
    *   DrawingBrush
    *   OpacityMask
    *   Viewport2DVisual3D
    *   Effect
    *   BitmapEffect

Are you using `TextOptions.TextFormattingMode="Display"` on your top level element i.e. Window? (the property is inherited so you if you put it there it should apply to everything in your Window).

You can use `RenderOptions.ClearTypeHint="Enabled"` to re-enable ClearType in the rendering path but you may have artifacts because there was usually a good reason to disable it.

You can use `TextOptions.TextHintingMode="Fixed"` when you have animations and you don't want to have lower-quality text rendering (i.e. ClearType disabled) while the animation is in effect.

You can use `TextOptions.TextRenderingMode="ClearType"` to force ClearType to be used even then the Windows System Settings have not enabled it (this won't do anything special for you in this case, it's here for reference).

*   [http://windowsclient.net/wpf/white-papers/wpftextclarity.aspx](http://windowsclient.net/wpf/white-papers/wpftextclarity.aspx)

*   [http://arbel.net/2007/02/03/give-me-back-my-cleartype/](http://arbel.net/2007/02/03/give-me-back-my-cleartype/)

*   [http://msdn.microsoft.com/en-us/library/system.windows.media.renderoptions.cleartypehint.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.renderoptions.cleartypehint.aspx)

# android - Android：地图上的指南针太远

> ID：12173733
> 
> 赞同：1
> 
> 时间：2012-08-29T08:28:09.343
> 
> 标签：android, compass-geolocation, mylocationoverlay

在 Android 中，我使用[MyLocationOverlay](https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/MyLocationOverlay)来启用指南针，但问题是，在 HTC Wildfire 上，指南针离屏幕太远（见截图）。

![在此处输入图像描述](../Images/fb33b6dcae58c122d02fa081d867bc10.png)

在更大的屏幕上，例如 Galaxy S3，指南针正好在左上角。

问题：我怎样才能把这个指南针放在地图的左上角？谢谢！

# python - 如何从 Python 函数将对象作为 JSON 对象返回？

> ID：12173736
> 
> 赞同：0
> 
> 时间：2012-08-29T08:28:17.060
> 
> 标签：python, json, rpy2

这是我的python模块：

```
#!/usr/bin/python

import rpy2.robjects as robjects
import MySQLdb as mdb
import json
import rpy2.robjects.vectors as ro
r= robjects.r

class Deviation:
    def __init__(self):
        print("Standard Deviation")

    def s_deviation(self):
        con = mdb.connect('localhost', 'root', 'devil', 'data')        
        cursor = con.cursor()
        cursor.execute("SELECT * FROM traffic")
        rows = cursor.fetchall()
        rows = list(rows)
        a = [x[1] for x in rows]
        result = ro.IntVector(a)
        a = r.sd(result)
        print a

def deviation():
    dev = Deviation()
    deviation = dev.s_deviation() 
```

调用此模块的函数 deviation() 将结果作为 R 向量返回。如何使它返回 Json 对象的结果？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:47:14.900

使用`json.dumps`或`simplejson.dumps`（取决于您的 python 版本）。你像这样使用它：

```
>> print( simplejson.dumps( { "dev": dev.s_deviation() } ) )
'{"dev":1.456}' 
```

# android - 安装 .apk 仅适用于某些手机 oO

> ID：12173741
> 
> 赞同：0
> 
> 时间：2012-08-29T08:28:41.240
> 
> 标签：android, installation

我确定这个问题已经解决了 100 次，但我找不到适合我的解决方案。

我开发了一个应用程序并在 htc Sensation 上对其进行了测试（USB 调试）。现在我想释放。所以我使用 Eclipse 的导出向导来创建签名的应用程序 .apk。

我在 htc-sensation 上卸载了该应用程序并重新启动了手机。将apk复制到sdcard，安装应用程序，（重启手机以防万一）并运行应用程序。作品。

然后我拿起我的三星 Galaxy s3，检查“未知来源”，将 apk 复制到 scdard，安装（以防万一，重启手机）。如果我想启动应用程序，我会得到 Toast“应用程序未安装”。它被列为已安装，我可以卸载并重新安装它（对错误没有影响）。

另外，如果我想在我的 s3 中进行调试：（启用 USB 调试，我可以从 eclipse 的列表中选择它作为调试目标）

控制台说：

```
Android Launch!
adb is running normally.
Performing com.myapp.main.MainActivity activity launch
Uploading myapp.apk onto device '4df1fee466246ffd'
Installing myapp.apk...
Success! 
```

但是该应用程序既没有开始运行，我也不能手动启动它（同样的 Toast 消息“应用程序未安装”）

已经尝试过：

当然，多个手机重新启动并重新安装重新导出 apk

删除并重新应用 sd 卡

使用 adb install 命令安装

s3 运行 android 4.0.4，htc 4.0.3，应用程序要求最低 4.0.3。

我错过了什么？

编辑：清单：XML

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.myapp"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="15" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" android:permission="android.permission.INTERNET">
        <activity 
            android:name="com.myapp.main.MainActivity" 
            android:launchMode="standard" 
            android:clearTaskOnLaunch="true"
            android:label="@string/app_name" 
            android:screenOrientation="portrait" android:immersive="false" android:stateNotNeeded="false" android:finishOnTaskLaunch="true" android:finishOnCloseSystemDialogs="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity 
            android:name="com.myapp.main.ContentListActivity" 
            android:finishOnTaskLaunch="true" 
            android:screenOrientation="portrait" 
            android:label="@string/app_name" android:launchMode="standard" android:immersive="false" android:stateNotNeeded="false" android:clearTaskOnLaunch="true" android:finishOnCloseSystemDialogs="true">

        </activity>

        <activity 
            android:name="com.myapp.main.LoadPreferencesActivity" 
            android:finishOnTaskLaunch="true" 
            android:label="@string/app_name"
            android:screenOrientation="portrait" android:launchMode="standard" android:immersive="false" android:stateNotNeeded="false" android:clearTaskOnLaunch="true" android:finishOnCloseSystemDialogs="true">

        </activity>

        <activity 
            android:name="com.myapp.main.DownloadDialogActivity" 
            android:finishOnTaskLaunch="true" 
            android:label="@string/app_name" 
            android:screenOrientation="portrait" android:launchMode="standard" android:stateNotNeeded="false" android:clearTaskOnLaunch="true" android:immersive="false" android:finishOnCloseSystemDialogs="true">

        </activity>

    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:44:20.753

从应用程序标签中删除您的 Internet 权限。它声明了两次。所以你的应用程序声明现在看起来像这样：

```
<application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"> 
```

# objective-c - AFNetworking + 暂停/继续下载大文件

> ID：12173744
> 
> 赞同：6
> 
> 时间：2012-08-29T08:28:51.133
> 
> 标签：objective-c, ipad, download, afnetworking, resume

我需要使用我的 iPad 应用程序下载大型 .zip 文件（最大 800 MB）。如果下载被取消或应用程序在后台，我想再次恢复下载。

```
operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];
operation.outputStream = [NSOutputStream outputStreamToFileAtPath:filePath append:YES];

[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject){

// unzip the .zip

}failure:^(AFHTTPRequestOperation *operation, NSError *error){

//Handle the error

}];

[operation setDownloadProgressBlock:^(NSInteger bytesWritten, long long totalBytesWritten,long long totalBytesExpectedToWrite) {

//update the progressView

}];

[operation setShouldExecuteAsBackgroundTaskWithExpirationHandler:^{

// What I have to do here?

}];

[operation start];
[operation waitUntilFinished];

-(void)applicationWillResignActive:(UIApplication *)application{

// What I have to do here?

} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-31T05:53:21.793

您可以使用 AFDownloadRequestOperation 来执行此操作。

```
 NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:@"....zip"]];
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *path = [[paths objectAtIndex:0] stringByAppendingPathComponent:@"....zip"];
    AFDownloadRequestOperation *operation = [[AFDownloadRequestOperation alloc] initWithRequest:request targetPath:path shouldResume:YES];
    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
        NSLog(@"Successfully downloaded file to %@", path);
    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
        NSLog(@"Error: %@", error);
    }];
    [operation setProgressiveDownloadProgressBlock:^(NSInteger bytesRead, long long totalBytesRead, long long totalBytesExpected, long long totalBytesReadForFile, long long totalBytesExpectedToReadForFile) {
        NSLog(@"Operation%i: bytesRead: %d", 1, bytesRead);
        NSLog(@"Operation%i: totalBytesRead: %lld", 1, totalBytesRead);
        NSLog(@"Operation%i: totalBytesExpected: %lld", 1, totalBytesExpected);
        NSLog(@"Operation%i: totalBytesReadForFile: %lld", 1, totalBytesReadForFile);
        NSLog(@"Operation%i: totalBytesExpectedToReadForFile: %lld", 1, totalBytesExpectedToReadForFile);
    }];
    [operations addObject:operation]; 
```

重新启动应用程序并生成具有相同 url 的请求后，它将继续下载。"shouldResume:YES" 有效

# android - 带有意图的Android ViewPageIndication

> ID：12173747
> 
> 赞同：1
> 
> 时间：2012-08-29T08:29:05.967
> 
> 标签：android, android-intent

今天我找到了[pageflipper](http://www.viewpagerindicator.com)的新库。但到目前为止我还不知道如何增强这个库以使用 Intent。

我的意思是这些示例仅提及正文中的显示文本，而不包括其他有意图的页面。因此我需要知道如何在这个库中包含另一个页面（java）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T12:33:42.177

> 今天我找到了 pageflipper 的新库。

ViewPagerIndicator 用于`ViewPager`. Android 中没有任何东西叫做“pageflipper”。

> 因此我需要知道如何在这个库中包含另一个页面（java）。

你没有。将活动放在其他活动中是平台官方弃用的，与此无关`ViewPager`，更不用说`ViewPagerIndicator`。您`ViewPager`可以拥有属于视图的页面（即，膨胀的布局），也可以选择由片段管理这些页面。

# plone - 是否有任何 Plone 插件来控制用户名限制？

> ID：12173749
> 
> 赞同：0
> 
> 时间：2012-08-29T08:29:13.890
> 
> 标签：plone

我正在寻找一个插件来控制用户名约束的注册过程。

例如，我想在用户名中强制小写。

如果它也可以对密码应用这种约束，那应该是完美的。

（我在开始开发之前问）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:45:56.260

Products.LoginLockout 包含一些（粗略的）代码和检查。LoginLockout 作为 PAS 插件实现。

# sql - 在两列的值之间选择记录

> ID：12173751
> 
> 赞同：3
> 
> 时间：2012-08-29T08:29:38.950
> 
> 标签：sql, ruby-on-rails, postgresql

我有下表，它保存了一年中特定周的销售数据。

**销售量**

```
week | year | value
50   | 2011 | 150
51   | 2011 | 151
52   | 2011 | 152
1    | 2012 | 170
2    | 2012 | 190
3    | 2012 | 180
4    | 2012 | 160
5    | 2012 | 170
6    | 2012 | 290 
```

我想查找位于第 1 年第 1 周和第 2 年第 2 周之间的记录。

例如

1.  2011 年第 50 周至 2012 年第 5 周之间
2.  2012 年第 1 周至 2012 年第 6 周之间

由于在 SQL 方面的经验很少，我尝试了以下查询，该查询适用于案例 2，但不适用于案例 1。

```
SELECT * from sales WHERE (week >= 1 AND year >= 2012) AND (week <= 6 AND year <= 2012 ) 
```

据我了解，条件分组似乎不起作用。就好像没有条件分组一样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T08:34:00.327

```
select *
from
(
   Select *, year*100 + week as yearweek
   from table
) v
where yearweek between 201150 and 201205 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T23:52:20.457

通过比较临时记录更简单、更快、更优雅：

```
SELECT *
FROM   tbl
WHERE (year, week) BETWEEN (2011, 50) AND (2012, 5); 
```

[这个密切相关的答案](https://stackoverflow.com/a/12023062/939860)有更多详细信息，包括基准测试和一些更多可能的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:32:53.080

此查询适用于案例 1：

```
SELECT * from sales WHERE (week >= 50 AND year = 2011) OR (week <= 5 AND year = 2012 ) 
```

而这应该适用于大多数相邻年份的情况（例如 2011 年和 2012 年或其他，但不是 2001 年至 2010 年）。这种情况有点复杂，但仍然相当简单。

```
DECLARE @week1 INT
DECLARE @week2 INT
DECLARE @year1 INT
DECLARE @year2 INT

SELECT * from sales WHERE (week >= @week1 AND year = @year1) OR (week <= @week2 AND year = @year2 ) 
```

好的，这是更大范围的示例。

```
DECLARE @week1 INT
DECLARE @week2 INT
DECLARE @year1 INT
DECLARE @year2 INT

SELECT * from sales WHERE (week >= @week1 AND year = @year1) OR (week <= @week2 AND year = @year2 ) OR (year > @year1 AND year < @year2)
-- This last one gives ALL weeks for the full years between year1 and year2 (e.g. all weeks for 2002-2009 if we choose dates between 2001 and 2010) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:33:49.013

试试这个作为第一个例子

```
 SELECT * 
    FROM sales 
    WHERE (year = 2011 AND week > 50) 
       OR (year = 2012 AND week < 5) 
```

一般来说

```
 SELECT * 
    FROM sales 
    WHERE (year = 'year1' AND week > 'week1') 
       OR  (year > 'year1' AND year < 'year2' ) 
       OR (year = 'year2' AND week < 'week2' ) 
```

# apache-camel - Spring xml中带有自定义bean的骆驼拆分器

> ID：12173753
> 
> 赞同：2
> 
> 时间：2012-08-29T08:29:44.080
> 
> 标签：apache-camel

我正在使用以下 xml 配置来定义拆分器的自定义 bean。

```
 <camel:split stopOnException="true">
      <camel:method bean="splitterBean" method="split" /> 
       <camel:to ref="sodSQLEndPoint"/>
    </camel:split>

 <bean id="splitterBean" class="com.processor.SodFundListSplitter" /> 
```

它不运行并给出错误：

12：31：28.770 [main] 警告 org.apache.camel.util.ObjectHelper - 找不到类：splitterBean。

如果我使用 body 而不是 custome bean，它可以正常工作。任何人都可以告诉我是否有任何额外的工作来允许自定义 bean 与拆分器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T14:00:12.483

尝试使用 ref 代替 bean

```
<camel:split stopOnException="true">
   <camel:method ref="splitterBean" method="split" /> 
   <camel:to ref="sodSQLEndPoint"/>
</camel:split> 
```

# ruby-on-rails - POST期间的Rails路由问题

> ID：12173757
> 
> 赞同：0
> 
> 时间：2012-08-29T08:30:11.707
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.1, routes

我是铁轨新手，卡在奇怪的路口。问题与路线有关。下面是我的代码

**路线**$

```
resources :users do
 resources :requests 
end 
```

***用户.rb***

```
class User < ActiveRecord::Base
 attr_accessor :password
 attr_accessible :email, :firstname, :lastname, :state, :city, :password
 has_many :requests ,:foreign_key => :user_id,:autosave => :true 
```

***请求.rb***

```
class Request < ActiveRecord::Base
attr_accessible :email, :status, :user_id,:token
belongs_to :user 
```

***请求表单html***

```
 <%= form_for (user_requests_path) do |f| %>
<div class="field">

<%= f.label "Email" %><br />
<div class="fieldgroup">

<%= f.text_field :email  , :class=>"textfield"%>

</div>
<div id="spacer">

</div>
<div class="fieldgroup">
<%= f.submit "Invite", :class=>"custombutton" %>
  </div>
   <% end %>
</div> 
```

当我单击请求表单下的邀请按钮时，我遇到了以下错误，而不是调用 request#create。

路由错误

`No route matches [POST] "/users/9/requests/new"`

***请求控制器***

```
def create
@user = User.find(params[:user_id])
@request = @user.requests.create(params[:request])
redirect_to user_path(@user)
 end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:52:35.730

For nested resources, you need to pass both parameters to some helpers, so, e.g.,

```
user_request_path(@user, @request) 
```

And so on. The Rails Resources Guide is a big help.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T10:08:52.110

您需要传递用户对象，以便跟踪您引用的用户实例：

```
<%= form_for (user_requests_path(@user)) do |f| %> 
```

也在：

```
has_many :requests ,:foreign_key => :user_id,:autosave => :true 
```

不需要通过`:foreign_key => :user_id`，即默认外键，即“model_id”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T09:09:15.587

为此，您[应该](http://guides.rubyonrails.org/routing.html#nested-resources "嵌套资源")在`routes.rb`.

另请参阅：[在 Rails 3 中路由嵌套资源](https://stackoverflow.com/questions/5025050/routing-nested-resources-in-rails-3)

# php - 总和列表（不在数据库中）

> ID：12173759
> 
> 赞同：0
> 
> 时间：2012-08-29T08:30:17.573
> 
> 标签：php

我的表格从含税总额计算不含税总额 我的页面片段在下面可用 SUM(column) 查询获取包含列的总额很容易但是我想计算不在的总额（不含税）我正在使用的此列的数据库

```
<?php
$inclusive=$row_returns['Total'];
$total=$inclusive*0.86;
echo $total;
?> 
```

对于我使用的总含税总额`{returns.Inclusive}` ，其总额显然是

```
<?php     
$result = mysql_query('SELECT SUM(Inclusive) AS tot FROM returns');
$row = mysql_fetch_assoc($result); 
$sum = $row['tot'];
echo $sum;
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:00:19.553

首先; 你用公式计算净值`total_included / rate`。

现在展示您计算总数的网络；

```
SELECT SUM(Included) AS gross, SUM(Included / 1.16) AS net 
```

希望我能得到你的问题。

# ios - 如果 [nsInputStream close] 被另一个线程调用，是否应该返回 [nsInputStream read:...]？

> ID：12173765
> 
> 赞同：1
> 
> 时间：2012-08-29T08:30:53.887
> 
> 标签：ios, nsinputstream

在我看来，如果流被另一个线程关闭，无论套接字连接的另一端如何，任何 NSInputStream 对象都应该从它的 read: 方法中弹出。但在某些情况下，这似乎不是真的。似乎除非对方首先在连接上至少发送一次，否则 read: 方法将不会响应流关闭。

打开连接的代码：

```
 // Open the socket...
    CFStreamCreatePairWithSocketToHost(NULL, Host, Port, &readStream, &writeStream);

    // Create NSStream objects for our use...
    inputStream = (NSInputStream *)readStream;
    outputStream = (NSOutputStream *)writeStream;

    // take ownership of the NSStream objects...
    [inputStream retain];
    [outputStream retain];

    // open the streams....
    [inputStream open];
    [outputStream open]; 
```

关闭连接的代码：

```
 // Close the streams...
    [inputStream close];
    [outputStream close];

    // Release ownership...
    [outputStream release];
    [inputStream release];

    // clear reference values...
    outputStream = nil;
    inputStream = nil; 
```

在接收线程中：

```
-(uint8_t) GetByte
{
    uint8_t c;
    int N = [inputStream read:&c maxLength:1];
    if ( N < 1 )
        @throw [[TcpClientException alloc] init];
    return c;
} 
```

当我从主线程关闭流时，接收线程仍保留在读取方法中。最终它超时并崩溃。即使崩溃也不会导致任何类型的对象被抛出（我试图包围代码以捕获任何东西（id）并且什么也没有得到）。

每次要关闭流时，如何可靠地强制读取弹出？

此外：

我在 ML 上使用 XCODE 4.4.1 和 5.1 iPad 模拟器。

如果我只关闭 inputStream 而没有释放或设置为 nil，那么也会出现问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:05:22.980

经过大量调查后，我在 SO 遇到了另一个线程，它暗示了答案，由于本地设备正在断开连接，因此通过 read 方法传递的连接（来自远程端点）不会发生任何事件。这个想法是，由于本地设备负责断开连接，它会知道它不应该进入读取方法（不会有任何东西要读取）。这有点出乎意料，因为当接收器线程已经在读取方法中时，用户可能会断开连接。但是... iOS 的设计显然不依赖于接收器线程，而是运行循环中的事件（这是另一个问题，但我不想在这里讨论）。具体来说，给定来自运行循环的事件表明有可用数据，您输入 read 方法。因此，您永远不会进入读取并挂起等待第一个字节。这与我过去在 Windows 平台上完成的套接字编程非常不同。但到目前为止我所做的所有实验都表明这是问题所在。我有一个现在可以工作的解决方案，它依赖于来自工作线程中运行循环的流中的事件，这样网络流量就不会干扰 GUI（主）线程。

# esb - 用于调用 C 程序的 mule 端点

> ID：12173766
> 
> 赞同：1
> 
> 时间：2012-08-29T08:31:04.900
> 
> 标签：esb, mule

我是 mule 新手，我需要通过 http 连接器调用**c 程序。**
不幸的是，我找不到可以帮助我调用 C 程序的**端点。**
有人可以告诉骡子是否可以做到这一点？如果是这样，怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T15:49:35.997

假设**c-program**您的意思是编译为本机可执行文件的程序，我建议您使用an`expression-component`通过.`exec()``java.lang.Runtime`

# sql - Hibernate HQL 等效于 Oracle 并行关键字

> ID：12173770
> 
> 赞同：3
> 
> 时间：2012-08-29T08:31:31.833
> 
> 标签：sql, oracle, hibernate, hql

您知道在 HQL Hibernate 查询中使用 Oracle 特殊关键字“/*+ parallel(n) */”的可能性吗？

您可以在此处查看此功能的示例：[http ://searchsystemschannel.techtarget.com/feature/Using-Parallel-SQL-to-improve-Oracle-database-performance](http://searchsystemschannel.techtarget.com/feature/Using-Parallel-SQL-to-improve-Oracle-database-performance)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:36:22.753

不，因为在 HQL 中不支持本机 SQL 提示。针对此问题的[HHH-2736多年来一直处于开放状态。](https://hibernate.onjira.com/browse/HHH-2736)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T03:29:43.543

如果您知道 SQL 是什么，则可以使用存储的大纲来检测查询并在运行时添加提示。但是，要正确处理可能会很棘手 - 如果查询稍有变化，可能会中断。

更多信息：[http ://www.oracle-base.com/articles/misc/outlines.php](http://www.oracle-base.com/articles/misc/outlines.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T04:50:16.610

如果为表设置并行度，则不需要提示：

```
alter table your_table parallel; 
```

尽管这将影响对您的表执行全表扫描的所有查询，这可能有益也可能无益。

# android - 仅在移动或缩放后*在地图视图上重绘叠加层

> ID：12173771
> 
> 赞同：1
> 
> 时间：2012-08-29T08:31:36.110
> 
> 标签：android, android-mapview

## 我想要的是

与谷歌地图中的交通图层相同的行为。它显示一个叠加层，如果您移动地图，您仍然可以在移动时看到叠加层（与缩放相同）只有当您释放屏幕时才会加载图层的其余部分

我怎样才能做到这一点？

# javascript - 谷歌地图，标记下的集群？

> ID：12173772
> 
> 赞同：1
> 
> 时间：2012-08-29T08:31:42.113
> 
> 标签：javascript, google-maps, markerclusterer

有任何提示，如何在下面放置一个集群并将 StyledMarker 放在 chluster 上，如图所示： ![在此处输入图像描述](../Images/1f2cc022a45cbfcd162b366d64c4e222.png)。

我使用 markerClustererPlusV3.js 和 StyledMarker.js。

谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-29T08:56:49.873

似乎谷歌地图中的很多叠加层都有一个`zIndex`选项（和一个`setIndex()`方法）： [https ://developers.google.com/maps/documentation/javascript/reference#MarkerOptions](https://developers.google.com/maps/documentation/javascript/reference#MarkerOptions)

> 所有标记都按其 zIndex 的顺序显示在地图上，较高的值显示在具有较低值的标记前面。默认情况下，标记根据它们在屏幕上的垂直位置显示，较低的标记出现在屏幕上方的标记前面。

:)

# python - 如何修改整数中的位？

> ID：12173774
> 
> 赞同：33
> 
> 时间：2012-08-29T08:31:52.227
> 
> 标签：python, binary, bit

我有一个带有值`7`（`0b00000111`）的整数，我想用一个函数替换它`13`（`0b00001101`）。替换整数中的位的最佳算法是什么？

例如：

```
set_bits(somevalue, 3, 1) # What makes the 3rd bit to 1 in somevalue? 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-08-29T08:54:01.220

这些适用于任何大小的整数，甚至大于 32 位：

```
def set_bit(value, bit):
    return value | (1<<bit)

def clear_bit(value, bit):
    return value & ~(1<<bit) 
```

如果你喜欢简短的东西，你可以使用：

```
>>> val = 0b111
>>> val |= (1<<3)
>>> '{:b}'.format(val)
'1111'
>>> val &=~ (1<<1)
'1101' 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-08-29T08:49:01.417

您只需要：

```
def set_bit(v, index, x):
  """Set the index:th bit of v to 1 if x is truthy, else to 0, and return the new value."""
  mask = 1 << index   # Compute mask, an integer with just bit 'index' set.
  v &= ~mask          # Clear the bit indicated by the mask (if x is False)
  if x:
    v |= mask         # If x was True, set the bit indicated by the mask.
  return v            # Return the result, we're done.

>>> set_bit(7, 3, 1)
15
>>> set_bit(set_bit(7, 1, 0), 3, 1)
13 
```

请注意，位号 ( `index`) 从 0 开始，其中 0 是最低有效位。

*另请注意，返回*新值，无法像您显示的那样“就地”修改整数（至少我不这么认为）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-29T08:39:38.120

您可以使用按位操作。 [http://wiki.python.org/moin/BitwiseOperators](http://wiki.python.org/moin/BitwiseOperators)

如果要将给定位设置为 1，则可以在给定位置使用按位“或”和 1：

***0b00000111** | **0b00001000** = **0b00001111***

要将给定位设置为 0，您可以使用按位“和”

***0b00001111** & **0b11111011** = **0b00001011***

请注意，0b 前缀用于二进制数，0x 用于十六进制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-25T11:25:30.637

通过提供的示例，听起来您正在寻找以整数交换位。例如，在 7 中 `(0b00000111)`，如果您交换第 3 和第 1 位的位，您将获得 13 `(0b00001101)`。

我将以下内容作为函数签名`swap_bits(val, i, j)`

什么是最好的算法？好吧，下面的算法需要恒定的时间，O(1)。

```
def swap_bits(val, i, j):
    """
    Given an integer val, swap bits in positions i and j if they differ
    by flipping their values, i.e, select the bits to flip with a mask.
    Since v ^ 1 = 0 when v = 1 and 1 when v = 0, perform the flip using an XOR.
    """
    if not (val >> i) & 1 == (val >> j) & 1:
        mask = (1 << i) | (1 << j)
        val ^= mask
    return val 
```

例子：

```
 >>> swap_bits(7, 3, 1)
 13 
```

代码利用了一些小技巧，这里是 Sean Anderson 的一个[很好的资源](https://graphics.stanford.edu/~seander/bithacks.html)。我正在努力在[此处](https://github.com/ianbrayoni/bithacks)提供 Python 中的代码片段。

# android - 来自服务器的 Android 通知

> ID：12173776
> 
> 赞同：3
> 
> 时间：2012-08-29T08:31:55.130
> 
> 标签：android, notifications, push-notification, android-service

我的问题陈述如下：-

我开发了基于 Client-Server 模型的 Application 。现在通知客户事件可能有两种情况：-

1.  如果客户端连接到服务器，则通过连接的 Socket 发送数据来发送通知。

2.  如果客户端未连接，那么我将使用 Android 的 android.telephony.SmsMessage 向客户端发送一条消息，并在客户端发送一个广播接收器来接收此消息。

现在我想知道是否有其他方法可以使用 Internet 连接（数据连接）发送通知。我有一个解决方案，只要用户打开数据连接并监听通知，就可以创建一个连接到服务器的服务，但我认为它会消耗额外的资源。

我想知道 facebook 或 whatsApp 如何向他们的用户发送通知

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:48:34.140

当我第一次开始为 android 编程时。我也想过做客户端-服务器模型，但它是一个在 android 中实现的非常复杂的模型。还有一种叫做 GCM（谷歌云消息传递）服务的东西，所有这些大巨头和我（小巨头）都在使用它。这是[链接](http://developer.android.com/guide/google/gcm/index.html)。使用 GCM，您无需一直连接到客户端。您可以只向客户端发送消息，只要客户端可以访问互联网，客户端就会收到它。

# android - 媒体记录器异常问题

> ID：12173780
> 
> 赞同：0
> 
> 时间：2012-08-29T08:32:14.807
> 
> 标签：android, media, android-mediarecorder

我对 Android 媒体记录器有一个奇怪的问题。在**一些**设备上，以下代码以我不理解的方式失败：

```
 if (mRecorder != null)
    {
      try
      {
          mRecorder.stop();
          mRecorder.release();
          camera.lock();
          mRecorder = null;
      }
      catch (Exception e)
      {
          ; // ignore
      }
    } 
```

似乎发生的情况是，try 块中的某些方法失败了，没有捕获到异常，并且该方法永远不会完成。有人对可能发生的事情有任何想法吗？由于我无法访问相关设备，因此无法调试此问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:45:05.393

上面的代码片段是正确的，但在这样做之前，您必须确保以下几点：

*   MediaRecorder 已停止，您再次尝试停止它：异常

*   如果 MediaRecorder 已经发布并且您正在尝试再次发布它：异常

*   相机已释放，您正尝试再次锁定它：异常

# codeigniter - 设计用户权限检查的方法

> ID：12173782
> 
> 赞同：0
> 
> 时间：2012-08-29T08:32:18.240
> 
> 标签：codeigniter

我是这个codeigniter的新手。我正在构建一个应用程序，其中用户角色扮演重要角色。在控制器中，我想检查用户是否具有特定的角色或权限，然后授予对功能的访问权限。我想知道我是否可以创建一个流程，这样我就不需要检查每个控制器的权限或角色，只有在扩展时才能做到这一点。我可以这样做吗？

/** 更新 **/

如果我想为控制器中的每个方法或控制器中的某些方法设置权限，我该怎么办。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T09:55:48.447

```
 <?php
class Secure_area extends CI_Controller 
{

    function __construct($module_id=null)
    {
        parent::__construct();  
        $this->load->model('Employee');
        if(!$this->Employee->is_logged_in())
        {
            redirect('login');
        }

        if(!$this->Employee->has_permission($module_id,$this->Employee->get_logged_in_employee_info()->person_id))
        {
            redirect('no_access/'.$module_id);
        }

        //load up global data
        $logged_in_employee_info=$this->Employee->get_logged_in_employee_info();
        $data['allowed_modules']=$this->Module->get_allowed_modules($logged_in_employee_info->person_id);
        $data['user_info']=$logged_in_employee_info;
        $this->load->vars($data);
    }
}
?> 
```

把你想做的每一件事都放在 __construct....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:51:15.553

嗨，我开发了一个系统，我遇到了同样的问题......以下是我的问题的解决方案

1.  一张存储所有控制器名称（或我的问题中的模块）的表。例如 mod1 mod2 mod3 。.
2.  一个存储所有控制器的用户访问权限的表，例如 user1 mod1 0 user1 mod2 1 user1 mod3 1 。. 用户 2 模块 1 1 用户 2 模块 2 0 用户 2 模块 3 1

3.  在文件（secure_area.php EXTENDS CI_Controller）上创建，检查 is_logged_in(){yes:has_permission(){yes:do things....continue, no:redirect(permission denied)}, no:(redirect(login)) }

4.  我所有的控制器都扩展了secure_area.php。

5.  在管理区域中，您可以使用简单的复选框创建向用户授予权限的功能或表单。

# android - Android 以编程方式创建 ViewPager

> ID：12173792
> 
> 赞同：4
> 
> 时间：2012-08-29T08:32:43.100
> 
> 标签：android, android-viewpager

我以编程方式创建了一个视图寻呼机，并将这个视图寻呼机添加到布局中，但它没有运行。

```
ViewPager viewPager = new ViewPager(this);
viewPager.setAdapter(new MyPagerAdapter());
addView(viewPager); 
```

视图寻呼机不工作；但是当我从 XML 中使用它时，它工作正常。我想动态使用它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-30T12:13:40.857

请同时发布“addView”方法的代码。现在我只建议在 viewPager 中添加一些布局属性，如宽度和高度。

**更新：** 好的，我刚刚在我的项目中遇到了这个问题。您必须为 viewPager 设置的唯一属性是 id。如何在没有在 xml 文件中定义的组件的情况下获取唯一 id（在 R 类中生成）写在这里：[Android: View.setID(int id) programmatically - how to Avoid ID conflict？](https://stackoverflow.com/questions/1714297/android-view-setidint-id-programmatically-how-to-avoid-id-conflicts)（res/values 答案中带有 ids.xml 的帖子）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:53:59.253

使用 FragmentActivity 创建 viewPager 和

```
 new MyPagerAdapter(
                getSupportFragmentManager()); 
```

# javascript - 访问 iframe 函数

> ID：12173793
> 
> 赞同：3
> 
> 时间：2012-08-29T08:32:44.447
> 
> 标签：javascript, jquery, html, web

这个问题似乎只发生在 chrome 这是 iframe 代码

```
<!DOCTYPE html>
<html>
<head>
    <script>
    function blahblah() { alert("test"); }
    </script>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>Test Page</title>
</head>
<body>

    <p> lalalalallalala!!! </p>

</body>
</html> 
```

这就是我创建 iframe 的方式

```
<iframe src="iframetest.html" id="iframetest"></iframe> 
```

然后我尝试调用 iframe 的 blahblah() 函数：

```
$('#iframetest')[0].contentWindow.blahblah() 
```

但这不起作用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T08:38:24.690

这有效：

```
 <iframe id=iframetest src=iframetest.html></iframe>
  <script>
      $(window).load(function(){
         document.getElementById('iframetest').contentWindow.blahblah();
      });
  </script> 
```

请注意，我曾经`$(window).load`确保 iframe 已加载。使用[load](http://api.jquery.com/load/) on`document`并不能确保 iframe 已加载。

当然，您的 iframe 必须与父文档具有相同的来源（这也意味着您必须`http://`在浏览器中打开文件而不是`file://`）。

编辑：[工作演示](http://dystroy.org/stackoverflow/)

# widget - 在 Dojo 中创建基于模板的 iwidget。？

> ID：12173794
> 
> 赞同：0
> 
> 时间：2012-08-29T08:32:48.357
> 
> 标签：widget, rad, dojo

我正在学习 Dojo 并尝试在 WebShere 应用程序服务器上创建一个 iWidget。

我首先尝试创建`Helloworld`小部件。哪个被部署了。

现在我想添加模板。

我在模板文件夹中创建了一个`LoginCmis.html`这个模板是用于询问用户名和密码的 gui。

**在`CustomerInteraction.js`我创建了一个模板 String 。如何在`onLoad`.**

```
 <div class = LoginCmis>
        <div dojotype="dijit.layout.BorderContainer" id="BorderContainer"
        design="headline" style="height: 250px; width: 400px" align="center">

            <div preload="true" dojotype="dijit.layout.ContentPane" 
                region="top">Login CMIS
            </div>
            <div preload="true" dojotype="dijit.layout.ContentPane" region="centre">

                <table class="form">
                    <tr>
                        <td>UserName</td>
                        <td><input type="text" dojotype="dijit.form.ValidationTextBox"
                            name="username" required="true" maxLength=64 trim="true"
                            style="width: 200px; text-align: left" 
                            dojoattachpoint="username"/>
                        </td>
                    </tr>
                    <tr>
                        <td>Password</td>
                        <td><input type="password" name="password" value=""
                            dojotype="dijit.form.ValidationTextBox" 
                            style="width: 200px; text-align: left"
                            dojoattachpoint="password"/>
                        </td>
                    </tr>
            </table>
        </div>
        </div>
    </div> 
```

在我的`CustomerInteraction.xml`（这是为了你好世界，我必须在这里做任何改变）的内容

```
<iw:content mode="view">
        <![CDATA[
              <div id ="helloWorld" > Hello World ! </div>
       ]]>
 </iw:content> 
```

在`customerInteraction.js`

```
 dojo.provide("helloWorldScope");
    dojo.require("dijit._Widget");
    dojo.require("dijit._Templated");
    dojo.declare("",[ dijit._Widget, dijit._Templated ],{

        templateString : dojo["cache"]("iWidget/widgets/CustomerInteraction", "Template/LoginCmis.html");

        msg1: "Hello World Class Loaded",
        msg2: "Hello World, again",

    onLoad:function() {
            alert(this.msg1);
        }
}); 
```

**要查看此模板，我必须进行哪些更改？**

文件夹设计看这个

![](../Images/e8bc4748fdd4fdd4974cc0718ca4e18b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:05:24.610

将此 mixin 添加`_WidgetsInTemplateMixin`到您的声明中。

小部件没有`onLoad`调用/绑定的默认函数。然而，它将作为构建自身的最后阶段，调用`startup`

确保 dojo 知道在哪里寻找你的模块并创建一个带有类型的 div，以便 dojo.parser 可以将它识别为一个小部件。

### 客户交互.xml：

```
 <script>
      dojo.registerModulePath("iWidgets", "/iWidget");
      dojo.require("iWidget.widgets.customerInteraction");
 </script>
 <div dojoType="iWidget.widgets.customerInteraction"></div> ... </body> 
```

### WebContent/iWidget/widgets/customerInteraction.js

```
dojo.declare("iWidget.widgets.customerInteraction",[ dijit._Widget, dijit._Templated, dijit._WidgetsInTemplateMixin ],{
     ....
     buildRendering: function() {
          // pre-parser point in flow of construction
          // add you code here
          this.inherited(arguments);
     },
     startup: function() {
          // 'post create' point in flow of construction
          // add you code here
          this.inherited(arguments);
     }
}); 
```

# performance - Backbone.js - 更新视图与渲染新视图

> ID：12173797
> 
> 赞同：2
> 
> 时间：2012-08-29T08:32:57.810
> 
> 标签：performance, backbone.js, backbone-views

我正在为 iPad 构建一个 webapp，最近我遇到了一些性能问题。我在左侧有一个新闻列表，在右侧有一个新闻视图。当您点击新闻时，它会在右侧显示完整的新闻。

目前，每次点击新闻时，我都会生成一个新视图。现在我的视图模板对于每个新闻都保持不变，我想知道我是否会通过使用所选新闻内容更新右侧的视图来获得更好的性能，而不是每次都生成一个新视图。

如果是这样，是否有一种用新模型数据或简单的 jQuery 更新视图的主干方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T14:34:51.980

就性能而言，仅更新部分内容是否值得，可能取决于您的视图有多复杂，以及其中有多少变化。

也就是说，您可以为右侧的新项目提供一个视图，然后只需交换它的模型和or 调用视图上`trigger`的方法。就像是`change event``refresh`

```
var NewsItemView = BackBone.View.extend({

   initialize: function() {
     this.model.bind('change', this.refresh, this);
   },

   refresh: function () {
     this.$el.find('#partIWantToUpdate').html(this.model.get('someField'));
   }
}) 
```

然后而不是创建一个新视图，您只需交换它的模型

```
newItemView.model = newsModel;
newsModel.trigger('change'); 
```

或者只是忘记绑定到更改事件而直接调用该方法

```
newItemView.refresh(); 
```

另一种选择是您可以为每个新闻项目创建一个视图并将该视图缓存在您的集合视图中，然后每次点击一个新闻项目时`detach`（重要的是您`detach`而不是`remove`删除也会删除任何绑定事件）当前视图（`DOM`实际上是当前视图`el`）并附加新选择的模型的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T10:07:14.397

可能很简单：

```
// code no tested
var NewsView = Backbone.View.extend({
  changeCollection: function( collection ){
    this.collection = collection;
    this.render();
  }
}); 
```

# ruby-on-rails - Ruby on Rails：具有不同实现的模型

> ID：12173798
> 
> 赞同：0
> 
> 时间：2012-08-29T08:33:00.137
> 
> 标签：ruby-on-rails, ruby, inheritance

我的 Rails 应用程序中有一堆不同的提供程序，每个提供程序都有一个自定义实现。

提供者都存储在数据库中，在从数据库加载对象时应根据其数据决定选择的实现。

这是我想出的解决方案。

/app/models/provider.rb

```
class Provider < ActiveRecord::Base
  attr_accessible :name

  validates :name, :presence => true

  after_find :load_implementation

  # Loads the correct implementation for the provider
  def load_implementation
    case self.name
    when "FirstProvider"
      extend FirstProvider
    when "SecondProvider"
      extend SecondProvider
    else
      raise "No implementation for provider #{self.name}"
    end
  end
end 
```

/lib/first_provider.rb

```
module FirstProvider
  def foo
    puts "foo"
  end
end 
```

/lib/second_provider.rb

```
module SecondProvider
  def foo
    puts "bar"
  end
end 
```

这是我使用它的方式：

```
Providers.all.each do |p|
  p.foo
end 
```

您发现使用此解决方案有什么问题吗？你能想出更合适的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:14:04.007

我建议看看 Rails 的[单一继承表](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#label-Single+table+inheritance)机制。

您仍然需要创建*x*类（其中*x*是您在其`foo`实现中拥有的提供者的数量）。这些类都将继承自一个主`Provider`ActiveRecord 类。

但是，您不必编写诸如`load_implementation`. 提供者的类型将存储在数据库表“*提供者”的数据库列“**类型*”中。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T09:03:24.443

有什么理由你不想使用 ActiveRecord 单表继承？

```
class FirstProvider < Provider
  def foo
    puts 'foo'
  end
end 
```*

# jquery - asp.net mvc4 jquery 不工作

> ID：12173799
> 
> 赞同：20
> 
> 时间：2012-08-29T08:33:01.507
> 
> 标签：jquery, asp.net-mvc, razor

我正在尝试运行放在我的**_Layout.cshtml**中的 jquery 代码，如下所示：

```
...............
<script type='text/javascript'>
$(document).ready(function () {
   alert('Test');

});
</script>
  @Scripts.Render("~/bundles/jquery")
  @RenderSection("Scripts", required: false) 
</body>
</html> 
```

上面的代码没有被触发，当我用 Chrome Dev 检查时，它显示**$ 没有定义**（我可以看到我所有的 jquery，jquery ui 文件都已加载）

**如果我将此代码放在外部 js 文件中，**它会起作用****

 **我不介意将我所有的 jquery 代码放在外部文件中，但我真的想澄清我做错了什么。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-29T08:41:56.560

您需要在脚本之前引入 jquery。

```
@Scripts.Render("~/bundles/jquery")

<script type='text/javascript'>
$(document).ready(function () {
   alert('Test');

});
</script>

  @RenderSection("Scripts", required: false) 
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-08T19:57:54.390

安德烈亚斯，我有同样的问题..默认情况下，“_layout.cshtml”在文档末尾有“@Scripts.Render("~/bundles/jquery")”，但它不起作用..我删掉了并将其粘贴到头部，现在它正在工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-12-29T16:03:49.263

为了让 jQuery 工作，你的脚本应该在后面`<script src="/Scripts/jquery-2.0.3.js"></script>`

在 _Layout.cshtml 中，就在`</body>`标签之前，您可以找到类似这样的内容

```
@Scripts.Render("~/bundles/jquery")
@RenderSection("scripts", required: false) 
```

首先你有 jQuery 库。然后你有任何脚本。这就是这个意思。所以在你看来，做这样的事情。

```
@section scripts{
 //your script
} 
```

这将确保所有脚本都在 jQuery 参考之下。**

# jquery - 设置超时函数调用后刷新当前页面

> ID：12173800
> 
> 赞同：6
> 
> 时间：2012-08-29T08:33:02.833
> 
> 标签：jquery, settimeout

`setTimeout()`执行函数调用后有没有办法刷新页面？

这是 setTimeout 函数调用的代码：

```
setTimeout(function(){
     $('#alert-success').slideUp('slow').fadeOut();
}, 5000); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-29T08:34:47.253

尝试

```
setTimeout(function(){
     $('#alert-success').slideUp('slow').fadeOut(function() {
         window.location.reload();
         /* or window.location = window.location.href; */
     });
}, 5000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:35:52.167

您可以这样做：（当您使用 时`.slideUp`，无需使用`.fadeOut`）

```
setTimeout(function() {
   $('#alert-success').slideUp('slow', window.location.reload);
}, 5000); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T08:37:03.287

在下面试试这个

```
<html>
<head>
<script type="text/JavaScript">
<!--
    function timedRefresh(timeoutPeriod) {
    setTimeout("location.reload(true);",timeoutPeriod);
}
//   -->
</script>
</head>

<body onload="JavaScript:timedRefresh(5000);">
    <p>This page will refresh every 5 seconds. This is because we're using the 'onload' event to call our function. We are passing in the value '5000', which equals 5 seconds.</p>
    <p>But hey, try not to annoy your users too much with unnecessary page refreshes every  few seconds!</p>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T08:44:51.017

您还可以使用

```
window.location.href = window.location.href 
```

脚本改写为

```
setTimeout(function()
{

    $('#alert-success').slideUp('slow').fadeOut();
    window.location.href = window.location.href

},5000) 
```

# ios - 试图找到哪个文本字段是活动的ios

> ID：12173802
> 
> 赞同：27
> 
> 时间：2012-08-29T08:33:11.160
> 
> 标签：ios

当我在键盘上升时移动视图时，我试图找到哪个文本字段处于活动状态。我正在尝试从滚动视图的子视图在我的视图控制器中设置一个属性。

这是我用来在滚动视图中显示视图的代码

```
-(void)displayView:(UIViewController *)viewController{

[[viewFrame subviews] makeObjectsPerformSelector:@selector(removeFromSuperview)]; 
[viewFrame scrollRectToVisible:CGRectMake(0, 0, 1, 1)
                        animated:NO];

[viewFrame addSubview: viewController.view];

_currentViewController = viewController;
} 
```

- 编辑 -

我已经改变了对这个问题的思考方式。抱歉，当我发布它时，这个问题模棱两可。我当时筋疲力尽，这在我脑海中是有道理的。

一个不同但相似的问题： UITextArea 和 UITextView 是否有一个共同的子类，它会给我 firstResponder 的起源？还是我必须先检查 firstResponder 的类，然后才能找到原点？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-29T08:48:41.457

您需要搜索已成为第一响应者的对象。第一响应者对象是使用键盘的对象（实际上，他是专注于用户输入的对象）。要检查哪个文本字段使用键盘，请遍历您的文本字段（或仅遍历所有子视图）并使用该`isFirstResponder`方法。

编辑：根据要求，示例代码，假设所有文本字段都是视图控制器视图的子视图：

```
for (UIView *view in self.view.subviews) {
    if (view.isFirstResponder) {
        [self doSomethingCleverWithView:view];
    }
} 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2016-11-01T00:29:24.657

我为此做了一个扩展。

```
public extension UIResponder {

    private struct Static {
        static weak var responder: UIResponder?
    }

    public static func currentFirst() -> UIResponder? {
        Static.responder = nil
        UIApplication.shared.sendAction(#selector(UIResponder._trap), to: nil, from: nil, for: nil)
        return Static.responder
    }

    @objc private func _trap() {
        Static.responder = self
    }
} 
```

利用：

```
if let activeTextField = UIResponder.currentFirst() as? UITextField {
    // ...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-12-11T14:26:38.710

假设您的文本字段都相同（即所有货币或文本）并且不需要任何特殊格式，我会建议以下内容：

首先，有一个可选的 textField 变量。例如：

```
var currentTextField: UITextField? 
```

然后添加以下内容：

```
func textFieldDidBeginEditing(textField: UITextField) {

        currentTextField = textField

} 
```

现在您可以使用“活动”文本字段做任何您想做的事情，并且您不需要跟踪任何标签，除非您需要一些特定的格式化操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-29T09:41:50.533

为什么不给所有 UITextfields 单独的标签 textfield.tag = 1

然后您响应委托 DidBeginEditing。并检查哪个 textfield.tag 处于活动状态？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-23T17:56:47.940

我第一次使用 Xilexio 的解决方案，但速度很慢。我最终使用了标签。这是我的代码并设置为示例。

```
@property (nonatomic) NSInteger currentFormField;

typedef NS_ENUM(NSInteger, IOUFormField) {
    IOUFormFieldName,
    IOUFormFieldAmount,
    IOUFormFieldDescription,
    IOUFormFieldDate
}; 
```

...

```
self.nameField.tag = IOUFormFieldName;
self.amountField.tag = IOUFormFieldAmount;
self.descriptionField.tag = IOUFormFieldDescription;
self.dateField.tag = IOUFormFieldDate;

-(void)keyboardWillShow:(NSNotification *)notification {
    // Move the scroll view to a position where the user can see the top and bottom form fields
    // For example, if the user is on the description field, they should be able to see the date field and the amount field.

    // The keyboard rect value comes as a NSValue * (a wrapped NSRect) with origin and size.
    // The origin is using screen coordinates which is pixel based so don't use it.
    // Use the size. Seems like it is density based.
    CGFloat viewableScreenHeight = self.view.frame.size.height - keyboardFrameBeginRect.size.height;

    // When the user is on a form field, get the current form field y position to where the scroll view should move to
    CGFloat currentFormFieldYPosition = 0;
    switch (self.currentFormField) {
        case IOUFormFieldName:
        {
            currentFormFieldYPosition = self.nameField.frame.origin.y;

            // If the scroll view is at the bottom and the user taps on the name field, move the scroll view to the top.
            // This is so that users can see the give/get segments.
            [self.scrollView setContentOffset:CGPointMake(0, 0) animated:YES];

            break;
        }
        case IOUFormFieldAmount:
        {
            currentFormFieldYPosition = self.amountField.frame.origin.y;
            break;
        }
        case IOUFormFieldDescription:
        {
            currentFormFieldYPosition = self.descriptionField.frame.origin.y;
            break;
        }
        case IOUFormFieldDate:
        {
            currentFormFieldYPosition = self.dateField.frame.origin.y;
            break;
        }
        default:
            break;
    }

    // I want the current form field y position to be 100dp from the keyboard y position.
    // 50dp for the current form field to be visible and another 50dp for the next form field so users can see it.
    CGFloat leftoverTopHeight = viewableScreenHeight - 100;

    // If the current form field y position is greater than the left over top height, that means that the current form field is hidden
    // We make the calculations and then move the scroll view to the right position
    if (currentFormFieldYPosition > leftoverTopHeight) {
        CGFloat movedScreenPosition = currentFormFieldYPosition - leftoverTopHeight;
        [self.scrollView setContentOffset:CGPointMake(0, movedScreenPosition) animated:YES];
    }   
}

#pragma mark - UITextFieldDelegate

- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField {
    switch (textField.tag) {
        case IOUFormFieldName:
            self.currentFormField = IOUFormFieldName;
            break;
        case IOUFormFieldAmount:
            self.currentFormField = IOUFormFieldAmount;
            break;
        case IOUFormFieldDescription:
            self.currentFormField = IOUFormFieldDescription;
            break;
        case IOUFormFieldDate:
            self.currentFormField = IOUFormFieldDate;
        default:
            break;
    }

    return true;
} 
```

如果您有任何问题，请告诉我，我会澄清。请注意，评论是给我的。另请注意，为简洁起见，有些代码或省略了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-06-29T17:47:52.283

在 swift 3 中，在 if else 语句中使用以下函数：

```
 if (textField.isEditing) 
```

[iOS] [swift3]

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-01T01:20:07.193

基于[Xilexio 的回答](https://stackoverflow.com/questions/12173802/trying-to-find-which-text-field-is-active-ios#answer-12174042)，但遍历所有视图以找到请求的`FirstResponder`视图

```
-(UIView*)getFirstResponderInView:(UIView*)parentView{
    UIView* requestedView = nil;
    for (UIView *view in parentView.subviews) {
        if (view.isFirstResponder) {
            [view resignFirstResponder];
        } else if (view.subviews.count > 0) {
            requestedView = [self getFirstResponderInView:view];
        }
        if (requestedView != nil) {
            return requestedView;
        }
    }
    return nil;
} 
```

像这样使用：

```
UIView *view = [self getFirstResponderInView:self.view];
if(view != nil){
    [self doSomethingCleverWithView:view];
} 
```

# c# - 在 C# 中执行基于存储过程的查询后，如何为 CommandText 重用 SqlCommand 对象？

> ID：12173803
> 
> 赞同：4
> 
> 时间：2012-08-29T08:33:11.773
> 
> 标签：c#, .net, sql-server, asp.net-mvc-3, tsql

我有一个示例代码

```
aCommand.CommandType = CommandType.StoredProcedure;
aCommand.Parameters.AddWithValue("@book_id", bookID);
aCommand.Parameters.AddWithValue("@user_id", userID); 
```

之后我想使用以下命令执行一个简单的查询`CommandText`：

```
aCommand.CommandText = "SELECT * FROM aTABLE";
aCommand.ExecuteNonQuery(); 
```

但发生错误：

> 异常：找不到存储过程“SELECT * FROM aTABLE”

在这种情况下，我必须创建一个新的`SqlCommand`object 实例？

这是一种使用相同`SqlCommand`对象来避免创建对象的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-29T08:34:31.287

它应该是

```
aCommand.CommandType = CommandType.Text 
```

`CommandType`实际上，默认值为`CommandType.Text`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-29T08:44:24.547

问题是你重用了一个`SqlCommand`that `CommandType`is`StoredProcedure`但你想用`CommandType.Text`.

> *“在这种情况下，我必须创建一个新的 SqlCommand 对象实例吗？”*

我建议这样做以避免这种混淆。创建一个`SqlCommand`并不昂贵，以至于您需要重用它。实际上构造函数不只是设置属性。

来自`ILSpy`：

```
// System.Data.SqlClient.SqlCommand
// this() does only call _SuppressFinalize
public SqlCommand(string cmdText, SqlConnection connection) : this()
{
    this.CommandText = cmdText;
    this.Connection = connection;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-29T08:41:32.493

```
aCommand.CommandType = CommandType.StoredProcedure;
aCommand.Parameters.AddWithValue("@book_id", bookID);
aCommand.Parameters.AddWithValue("@user_id", userID); 
```

1.  指定您调用的存储过程名称

    ```
    aCommand.CommandText=yourstoredprocedurename;
    aCommand.ExecuteNonQuery(); 
    ```

2.  然后调用您的 select 和 sqlreader 以获取结果

    ```
    bCommand.CommandType = CommandType.Text
    bCommand.CommandText = "SELECT * FROM aTABLE";
    SqlDataReader rdr = bCommand.ExecuteReader(); 
    ```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-29T08:39:09.263

您必须构造新`Command`对象以擦除先前设置的参数和值。

```
aCommand=new SqlCommand();
aCommand.Connection=cn;
aCommand.CommandText = "SELECT * FROM aTABLE";
SqlDataReader reader=aCommand.ExecuteReader(); 
```

调用`ExecuteReader()`方法而不是`ExecuteNonQuery`获取数据库结果。

# latex - 带有 subcaption 包的 LaTeX subfloat：缺少数字，视为零

> ID：12173804
> 
> 赞同：5
> 
> 时间：2012-08-29T08:33:17.990
> 
> 标签：latex, package, figures

我想制作一个由两个子图组成的图。在阅读了关于[subfloats](http://en.wikibooks.org/wiki/LaTeX/Floats,_Figures_and_Captions#Subfloats)的 Wikipedia 子条目后，我尝试完全遵循它，所以我没有使用`subfig`or`subfigure`包，只使用了`caption`and`subcaption`包。尽管如此，我收到一个`Missing number, treated as zero`错误，指向带有`\begin{subfigure}`.

我究竟做错了什么？

下面是我的代码：

```
% In preamble:
\usepackage{url}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{rotating}
\usepackage[table]{xcolor}
\usepackage{multirow}
\usepackage{amsfonts}

% In document:
\begin{figure}[htpb]
\begin{subfigure}[b]{width=0.45\textwidth}
\centering
\includegraphics[width=\textwidth]{img_a}
\end{subfigure}
\begin{subfigure}[b]{width=0.45\textwidth}
\centering
\includegraphics[width=\textwidth]{img_b}
\end{subfigure}
\caption{A caption.}
\label{fig:my-figure}
\end{figure} 
```

# linux-kernel - 内核模块编程：将 C++ 程序移植到内核模块

> ID：12173809
> 
> 赞同：1
> 
> 时间：2012-08-29T08:33:31.083
> 
> 标签：linux-kernel, kernel, kernel-module

我正在做一个项目，旨在控制一个应该踢足球的双板机器人。所有程序都是用简单的 C++ 编写的，链接到各种共享库（例如 OpenCV、伺服电机控制器等）

该系统对性能至关重要，应该是 95% 的硬实时，因此 Xenomai 补丁已应用于内核。不幸的是，关于线程切换延迟的基准测试表明，系统在所有情况下都不能满足硬实时需求。朵朵为了[这个作品](https://www.osadl.org/fileadmin/dam/rtlws/12/Brown.pdf)。我们可以通过将所有东西移植到内核空间来提高性能。

我从未开发过内核模块......只是阅读一些文档。似乎与常规用户空间程序不同。甚至构建系统也不同。

我的问题：这是否可以将完全用 C++ 编写、广泛使用共享库和 POSIX 线程的常规用户空间应用程序转换为内核模块？

如果答案是否定的，我将静态重新编译所有库并改用 C ......这将是有害且耗时的过程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T01:36:16.923

首先，如果你想要硬实时，你应该使用硬实时系统，而不是 Linux。Linux 可以做一些实时的，但不能推断出最后期限的硬性保证。

但是要回答您的问题，不，不可能将 C++ 应用程序转换为内核模块，因为内核缺少使之成为可能的 C++ 运行时。在内核空间中你甚至不能使用 libc，更不用说 libstdc++了。

静态重新编译所有库不会更好。首先，这意味着您最终必须将 libc 移植到内核空间，这是不可行的（因为 libc 通过系统调用调用内核本身）。此外，您通常希望将进入内核的代码量（并在它失败时连同它一起关闭整个系统）尽可能少。

如果听起来更像您的应用程序需要重新设计以限制线程延迟（通过使用更轻的线程库，或者通过减少线程切换的数量）。无论如何，如果您在内核中使用线程，您仍然会有延迟——您可能获得的唯一好处就是没有系统调用。

所以我的猜测是你需要考虑设计而不是把东西移到内核中。

# dynamics-crm-2011 - 如何在多对多相交表上添加 CRM 插件步骤？

> ID：12173818
> 
> 赞同：4
> 
> 时间：2012-08-29T08:33:50.650
> 
> 标签：dynamics-crm-2011, dynamics-crm

我在 Opportunity 和自定义实体之间创建了**（多对多**）关系。**CRM 自动打破与称为“相交表**”的内置表的关系。

在插件注册工具中，我想在这个特定的表上添加创建/更新/删除消息。但问题是它在那里不存在——甚至多对多的系统关系也不存在在那里。

人们可能会建议我手动断开关系以便在注册工具中显示。但是有什么解决方案可以访问这个内置表吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T15:43:54.267

不幸的是，答案是否定的。CRM 中关于多对多表/关系的范例是它们可用于`Association`和`Disassociation`请求，但*不能*用于`Create`、`Update`或`Delete`请求。（事实上​​，`Update`在交集表上没有实数 - 新的关联只会产生（`Create`=> `Associate`）或解散（`Delete`=> `Disassociate`）。）

您可以通过查看交集实体以某种方式验证这一点`AttributeMetadata`，您会看到实体中的所有属性都具有字段`ValidForUpdateAPI`并`ValidForCreateAPI`设置为 false。这与常规实体不同，常规实体具有对 update 和 create 调用有效的混合属性。

为了解决您的问题，您的选择是有限的：

`Association`1) 根据消息注册您的步骤。不幸的是，此消息无法过滤到特定实体，因此您必须过滤通过此插件在 CRM 中发出的**所有**关联请求。在属性包`IPluginExecutionContext`中有一个名为“Relationship”的`InputParameters`属性，您可以使用它来过滤出要为其开发代码的关系。

```
Relationship entityRelationship = 
    (Relationship)context.InputParameters["Relationship"];
if (entityRelationship.SchemaName = customIntersectTable.EntityLogicalName)
{
    EntityReference targetEntity =
        (EntityReference)context.InputParameters["Target"];
     EntityReferenceCollection relatedEntities = 
        (EntityReferenceCollection)context.InputParameters["RelatedEntities"];
    //do stuff
} 
```

2) 制作一个与您的自定义实体具有一对多关系的自定义相交实体`Opportunity`（类似于`OpporunityProduct`将机会与产品联系起来的东西）。这里的缺点是这种东西的 GUI 并不像简单的交叉实体那样好。

Gonzalo Ruiz在 MSDN上也有[关于这个主题的博客。](http://community.dynamics.com/product/crm/crmtechnical/b/gonzaloruiz/archive/2012/07/09/triggering-plugins-workflows-when-associating-entities-n-n.aspx "关联实体时触发插件/工作流 (N:N)")他几乎说同样的话。

# html - chrome 可以播放 html5 mp4 视频，但 html5test 说 chrome 不支持 mp4 视频编解码器

> ID：12173822
> 
> 赞同：10
> 
> 时间：2012-08-29T08:34:01.007
> 
> 标签：html, google-chrome, html5-video, html5test

根据`html5test.com`，chrome 不支持 html5`mp4`视频（请参阅以下链接）。 [http://html5test.com/compare/feature/video-mpeg4.html](http://html5test.com/compare/feature/video-mpeg4.html)

但是，在[这个](http://www.w3schools.com/html5/tryit.asp?filename=tryhtml5_video_all)测试页面中，通过将 body 设置如下，可以成功播放 mp4 视频：

```
<!DOCTYPE html>
<html>
<body>

<video width="320" height="240" controls="controls">
  <source src="movie.mp4" type="video/mp4" />
  Your browser does not support the video tag.
</video>

</body>
</html> 
```

我怎样才能正确解释这一点？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-29T08:55:20.980

`.mp4`只是一种容器格式（[MPEG-4 Part 14](http://en.wikipedia.org/wiki/MPEG-4_Part_14)），file下的视频和音频格式`.mp4`是可以变化的。对于视频，H-264（MPEG-4 Part 10）和 MPEG-4 Visual（MPEG-4 Part 2）很常见。

在 HTML5Test 中，“MPEG-4 support”会进行测试`video.canPlayType("video/mp4; codecs="mp4v.20.8")`，测试是否支持 MPEG-4 Visual。

Chrome 支持的格式有 H-264、VP8（WebM 视频部分）、Theora 用于视频和 MP3、AAC、Vorbis 用于音频。不支持 MPEG-4 Visual（[Chromium 问题 54036](http://code.google.com/p/chromium/issues/detail?id=54036)）。

因此，Chrome 可以播放`.mp4`H-264 视频，但不能播放 MPEG-4 Visual 视频。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T15:51:47.100

一般来说，谷歌已经承诺在 Chrome 中删除 H264 支持，所以它并不值得信任。

无论如何...该测试页面在 Windows 7 上的 Chrome 版本 24.0.1312.57 m 中不起作用 - 它仅播放音频和空白视频流。

我做了一个快速调查，在这个测试团队的 22 人中，7 人无法播放视频，15 人可以。大部分是相同版本的 Chrome，一些在 26 版的开发通道上，相同的 Windows 补丁级别，甚至一些使用相同的视频卡和驱动程序得到不同的结果。

测试的视频是 mp4 容器，其中一个视频流采用 H264 格式（不是 mpeg-4）。

我一直无法确定原因，但它开始成为一个令人沮丧的问题，因为对于所有播放有问题的人来说，没有流行的 HTML5 后备解决方案有效。甚至 ME.js、videojs、jwplayer 等的主页示例视频也无法在 Chrome 中播放视频。

Chrome 在 H264 支持方面存在一些问题，或者我们都使用的其他一些软件中存在未知错误......我将在公司网络之外进行测试，看看是否有内容过滤器搞砸了。

# java - Java中“库”的设计模式？

> ID：12173823
> 
> 赞同：-1
> 
> 时间：2012-08-29T08:34:02.720
> 
> 标签：java, design-patterns

我正在为一组将在多个项目中使用的方法寻找一种设计模式，所以我正在用它们制作一个“库”。

起初我想把它们都设为静态，这样它们就可以被 Library.methodName() 调用，就是这样。我做到了，并意识到我为每个可以设置一次然后在类中使用的方法传递了几个常量值。（这个常数值在项目之间变化）

现在我想到了一个必须用这个值实例化的类，并通过对象访问方法而不是每次都传递值，但是我想防止每次都创建“库”类的对象，所以我想到了辛格尔顿。

我确实用所有这些做了一个单例，但是我`set`首先需要为类变量做一个显式的，但是这种方法要求程序员现在必须在使用方法之前设置值，这将使它失败最终肯定会，即使是我自己。

一直在做`Singleton.getInsance(value1, value2).method(...)`是不可能的，我更喜欢我最初的方法。另外，我不能为这个变量定义一个“默认”值，它们必须被设置。

**是否有一种设计模式可以帮助我拥有一个可以用给定值初始化而不必一直传递它们的单例？**

还是我应该坚持我最初的方法并让程序员一直传递这些值？

或任何其他选项，任何适合的设计模式或其他任何东西也可以工作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:37:18.683

> 我应该坚持我最初的方法并让程序员一直传递这些值吗？

我能看到的唯一替代方法是为包含和设置所有强制值的上下文提供一个构造函数。如果可以的话，我会避免使用有状态的单例。

如果调用者想避免多次创建对象，他们可以根据需要将其设为单例，但您不应强迫他们使用单例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T12:52:37.110

您尝试创建的库**完全违反了面向对象设计的原则**。您不应该创建函数/方法库。相反，您应该创建一个包含状态和行为的类库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T09:11:18.800

这种方式对你来说舒服吗？

```
public class AreaCalculator {
  private int length = 10;
  private int width = 10;
  private static final AreaCalculator areaCalculator = new AreaCalculator();

  private AreaCalculator() {
    // TODO Auto-generated constructor stub
  }

  public static AreaCalculator getInstance() {
    return areaCalculator;
  }

  public AreaCalculator fillLength(int length) {
    this.length = length;
    return getInstance();
  }

  public AreaCalculator fillWidth(int width) {
    this.width = width;
    return getInstance();
  }

  public AreaCalculator fillAll(int length, int width) {
    this.length = length;
    this.width = width;
    return getInstance();
  }

public int calculateArea() {
    if (!isInit()) {
        throw new RuntimeException("Should Init first!");
    }
    return length * width;
}

public boolean isInit() {
    // add something
    return true;
} 
```

测试代码

```
public class TestMain {

  public static void main(String[] args) {
    int result = AreaCalculator.getInstance().fillWidth(20).calculateArea();
    System.out.println("10*20=" + result);
    result = AreaCalculator.getInstance().fillWidth(10).fillLength(10).calculateArea();
    System.out.println("10*10=" + result);
    result = AreaCalculator.getInstance().fillAll(10, 30).calculateArea();
    System.out.println("10*30=" + result);
  } 
```

**

> 使用配置界面。

**

ConfigInf（库端）

```
public interface ConfigInf {

    public static String F_LENGTH = "length";
    public static String F_WIDTH = "width";

    public String getProperty(String key);

} 
```

ConfigFactory（库端）

```
public class ConfigFactory {

    private static ConfigInf config = null;

    public static void init(ConfigInf config) {
        ConfigFactory.config = config;
    }

    public static ConfigInf getConfig() {
        if (config == null) {
            throw new NullPointerException("Config should be init first");
        }
        return config;
    }
} 
```

ClientConfig（客户端）

```
public class ClientConfig implements ConfigInf {

    String value = "10";

    @Override
    public String getProperty(String key) {
        // read configFile
        if (ConfigInf.F_LENGTH == key) {
            return value;
        } else {
            return "100";
        }

    }

    public void update() {
        value = "100";
    }

} 
```

AreaCalculatorWithConfig(lib 端)

```
public class AreaCalculatorWithConfig {
    private int length = 10;
    private int width = 10;
    //
    private static final AreaCalculatorWithConfig areaCalculator = new AreaCalculatorWithConfig();

    private AreaCalculatorWithConfig() {
        // TODO Auto-generated constructor stub
    }

    public static AreaCalculatorWithConfig getInstance() {
        return areaCalculator;
    }

    public int calculateArea() {
        ConfigInf config = ConfigFactory.getConfig();
        length = getInt(config.getProperty(ConfigInf.F_LENGTH));
        width = getInt(config.getProperty(ConfigInf.F_WIDTH));
        return length * width;
    }

    public static int getInt(String value) {
        return Integer.parseInt(value);
    }
} 
```

TestMainWithConfig（客户端）

```
public class TestMainWithConfig {
    public static void main(String[] args) {
        // init;
        ClientConfig config = new ClientConfig();
        ConfigFactory.init(config);
        //
        System.out.println("Before update:"
                + AreaCalculatorWithConfig.getInstance().calculateArea());
        config.update();
        System.out.println("After update:"
                + AreaCalculatorWithConfig.getInstance().calculateArea());
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T09:11:20.290

根据您的要求，您可以使用`Factory pattern`基于传递的常量创建库实例然后 `Singleton`创建实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T10:11:00.853

我只需将初始化添加到 Config 类，在那里它可以可靠地初始化一次。然后应用程序的其余部分依赖于正确完成初始化。也许您可能希望避免因异常而重复初始化。诀窍是确保只有一个点负责填充单例，无论是通过设计还是通过异常的蛮力。日志记录的配置非常相似。不过，也不算太奇怪。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-29T08:40:48.900

或者，由于这些值在项目之间而不是在项目内部发生变化，因此您的“库”可以读取一个配置文件，为您提供这些值`value1, value2`，这样调用代码就不需要每次都提供它们。

这将是一种懒惰的阅读（在第一次调用时进行），因此您还可以确保该库在使用之前已初始化。如果该文件当然不存在，那么您可能希望抛出未经检查的异常。

# r - 在R中向树状图叶添加符号

> ID：12173838
> 
> 赞同：2
> 
> 时间：2012-08-29T08:35:02.863
> 
> 标签：r, plot, key, symbols, dendrogram

我想为树状图上的站点添加符号到树状图反映变量的叶子，类似于以下内容：

```
require(graphics)

hc <- hclust(dist(USArrests[1:5,]), "ave")
plot(hc)
plot(hc, hang = -1)

USArrests[1:5,]

           Murder Assault UrbanPop Rape
Alabama      13.2     236       58 21.2
Alaska       10.0     263       48 44.5
Arizona       8.1     294       80 31.0
Arkansas      8.8     190       50 19.5
California    9.0     276       91 40.6 
```

![在此处输入图像描述](../Images/4ca7726896854f14b6c776df15b2a67b.png)

感谢您提供有关如何解决此问题的任何建议

解决方案按照 Backlin 的有用建议，我使用以下解决方案

```
require(graphics)

hc <- hclust(dist(USArrests[1:5,]), "ave")

plot(hc, hang = -1, xlab="", sub="")

col.circle=c("yellow", "red")[cut(USArrests$Murder[hc$order], c(8,10,15))]

symbols(1:5, rep(-25, 5), circles=rep(1, 5), add=TRUE, inches=.2,bg=col.circle, xpd=TRUE)

col.square=c("blue", "green")[cut(USArrests$Assault[hc$order], c(100,200,300))]

symbols(1:5, rep(-35, 5), squares=rep(1, 5), add=TRUE, inches=.4,bg=col.square, xpd=TRUE)

legend(3.7,85,legend=c("Murder 8-10","Murder 10-15","Assualt 100-200","Assualt 200-300"),fill=c("yellow","red","blue","green")) 
```

![在此处输入图像描述](../Images/86522c596421a339fddf65d0af236672.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T10:54:52.670

该`symbols`功能可用于以某种迂回但仍然有效的方式完成此操作。它不支持三角形，但有一些其他形状可供选择。在下面的演示中，请注意`xpd=TRUE`允许您在绘图区域之外绘制的参数，即在边距中。

```
plot(hc, hang = -1, xlab="", sub="")
symbols(1:5, rep(-25, 5), circles=rep(1, 5), add=TRUE, inches=.2,
        bg=rep(c("grey", "red"), c(3,2)), xpd=TRUE)
symbols(1:5, rep(-35, 5), squares=rep(1, 5), add=TRUE, inches=.4,
        bg=rep(c("grey", "red"), c(1,4)), xpd=TRUE) 
```

![在此处输入图像描述](../Images/dfef1bb2146247b2da12f3da89074574.png)

为了示例的可读性，符号的 y 坐标设置为绝对值。如果要使它们相对于绘图的坐标，请使用以下内容，其中`par("usr")`是绘图区域的 (x-left, x-right, y-bottom, y-top) 的向量。

```
y = par("usr")[3] - .04 * diff(par("usr")[3:4]) 
```

图例也可以用`symbol`和绘制`text`。这个想法是一样的，你可能会自己弄清楚，即使它很繁琐。

# php - 构建不猜测和拦截链接并使用它来改变页面

> ID：12173843
> 
> 赞同：1
> 
> 时间：2012-08-29T08:35:10.483
> 
> 标签：php, https, security

我正在开发一个带有广告的网站，用户可以为他们的产品放置广告。当然，他们必须能够更改他的广告，所以我制作了一个更改广告的页面。我想将用户电子邮件地址的链接发送到更改页面，我不想使用密码，因为要记住的密码已经太多了。用户还可以为链接添加书签，以便他可以快速访问更改页面。当然，除了用户之外，没有人必须能够通过链接访问更改页面，也可以通过其他计算机/平板电脑访问，因此无法选择使用 IP 地址。如何创建一个独特的链接，女巫不会被黑客猜测或拦截？我确实有 SSL/HTTPS 的可能性……。

# c - 保存二进制文件是标准吗？它仅限于一种类型吗？

> ID：12173850
> 
> 赞同：0
> 
> 时间：2012-08-29T08:35:38.303
> 
> 标签：c, memory-management, binaryfiles

程序员什么时候应该使用`.bin`文件？（实际例子）。

在一个文件中保存不同的数据类型是否流行（或被接受）？

当迭代文件中的数据（具有多种数据类型）时，程序必须知道每种数据类型的确切长度，我发现这是有限制的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:37:09.103

如果您的意思是一些理想化的通用应用程序数据，通常首选文本文件，因为它们为用户提供透明度，并且还可能更容易（例如）将数据移动到不同的应用程序并避免锁定。

二进制文件主要用于性能和紧凑性的原因，将事物编码为文本在这两个部门（今天，可能主要是大小）中都有不小的开销，这有时是令人望而却步的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:47:00.197

每当需要紧凑性或读/写速度时，都会使用二进制文件。

这两个要求密切相关，显然读写小文件速度很快，但二进制 I/O 速度快还有另一个重要原因：当记录具有固定长度时，会[随机访问](https://en.wikipedia.org/wiki/Random_access)文件中的记录更容易和更快。

例如，假设您想在文件的记录中进行[二进制搜索](https://en.wikipedia.org/wiki/Binary_search_algorithm)（当然，它们必须进行排序），而不是将整个文件加载到内存中（可能是因为文件太大以至于它没有） t 适合 RAM）。只有当您知道如何计算两条记录之间“中点”的偏移量时，才能有效地完成此操作，而不必解析文件的任意大部分来找出记录的开始或结束位置。

（如评论中所述，随机访问也可以通过文本文件实现；只是通常更难实现且速度较慢。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T09:21:25.967

我认为当嵌入式开发人员看到“.bin”文件时，它通常是 ELF 等的扁平版本，旨在作为处理器的固件进行编程。例如，将 Linux 内核放入闪存（取决于您的引导加载程序）。

作为是否使用二进制文件的一般做法，您会看到这样做的原因有很多。文本需要解析，这可能是一个很大的开销。但是，如果它打算供用户使用，那么二进制是一种糟糕的格式，而文本确实很出色。

二进制最好的地方是性能。您可以将其映射到内存中，并利用该结构来加快访问速度。有时，您会有两个二进制文件，一个包含数据，一个包含元数据，可用于帮助搜索大量数据。例如，Git 就是这样做的。它定义了一种[索引格式](https://github.com/git/git/blob/master/Documentation/technical/index-format.txt)、一种[包格式](https://github.com/git/git/blob/master/Documentation/technical/pack-format.txt)和一种[对象格式](http://www.kernel.org/pub/software/scm/git/docs/user-manual.html#object-details)，它们一起工作以保存项目的历史记录，这是一种易于访问但紧凑的方式。

# spring - spring mvc3中的请求映射url模式

> ID：12173854
> 
> 赞同：2
> 
> 时间：2012-08-29T08:35:52.843
> 
> 标签：spring, spring-mvc

我在我的项目中使用spring mvc3，我对请求映射模式（url中的最后一个斜杠）感到困惑

以下面的控制器方法为例：

```
@RequestMapping(value = "/{id}/edit", method = RequestMethod.GET)
public String edit(@PathVariable int id, Model model) {
    model.addAttribute(postDao.query(id));
    return "posts/edit";
} 
```

获取url“ `http://localhsot/app/posts/3/edit`”时有效，但获取url“”时无法使用该方法`http://localhsot/app/posts/3/edit/`。

我知道我可以像这样设置请求映射值：

```
@RequestMapping(value = {"/{id}/edit","/{id}/edit/"}) 
```

但我想知道是否有其他解决方案？Rails 似乎会忽略 url 中的最后一个斜杠。

更新：

servlet-context.xml：

```
<mvc:annotation-driven />
<mvc:view-controller path="/" view-name="home" />
<context:component-scan base-package="com.king.controller" />
<mvc:resources mapping="/res/**" location="/res/" />
<bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
    <property name="prefix" value="/WEB-INF/jsp/" />
    <property name="suffix" value=".jsp" />
</bean> 
```

web.xml

```
<filter>
    <filter-name>httpMethodFilter</filter-name>
    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>httpMethodFilter</filter-name>
    <servlet-name>modelServlet</servlet-name>
</filter-mapping>
<servlet>
    <servlet-name>modelServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/servlet-context.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>modelServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T09:02:47.243

我认为您正在尝试解决错误的问题。

如果你匹配一个带有和不带斜杠的 URL，你会因为[重复的内容](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=66359 "关于重复内容的 Google 文章")而从搜索引擎中得到一个糟糕的评级。

我要做的是添加一个过滤器，它使用状态码发送所有请求而不使用斜杠重定向带有斜杠（反之亦然）[`HttpServletResponse.SC_MOVED_PERMANENTLY`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html#SC_MOVED_PERMANENTLY)

这是这种过滤器的最小实现：

```
public class CanonicalUrlFilter implements Filter {
    @Override
    public void init(final FilterConfig filterConfig) throws ServletException { }

    @Override
    public void doFilter(final ServletRequest servletRequest, final ServletResponse servletResponse,
            final FilterChain filterChain) throws IOException, ServletException {
        if (servletRequest instanceof HttpServletRequest) {
            HttpServletRequest hsr = (HttpServletRequest) servletRequest;
            if (hsr.getMethod().equals("GET") && !hsr.getRequestURI().endsWith("/") && (hsr.getQueryString() == null)) {
                HttpServletResponse response = (HttpServletResponse) servletResponse;
                response.setStatus(HttpServletResponse.SC_MOVED_PERMANENTLY);
                response.sendRedirect(hsr.getRequestURI() + "/");
                return;
            }
        }

        filterChain.doFilter(servletRequest, servletResponse);
    }

    @Override
    public void destroy() { }
} 
```

# episerver - EpiServer CMS - 获取所有更改的属性

> ID：12173855
> 
> 赞同：1
> 
> 时间：2012-08-29T08:35:54.647
> 
> 标签：episerver

我有一个 EPIServer CMS。我有一个登台实例和一个生产实例。我希望能够在暂存实例中编辑属性/文本，然后在一个操作中将所有新值迁移到生产环境。最简单的方法是什么？

我想我应该做一些事情，比如以编程方式枚举自给定时间戳以来所有更改的属性，然后将键/值保存到文件中，然后在生产中从文件中更新。os 有没有更好的内置方法来实现相同的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:28:49.967

未内置。如果您的舞台数据库在您开始时是生产的副本，您可以从舞台导出页面并包含页面类型，然后将它们导入生产，但它们将获得新的 ID，您必须删除原件。您还将丢失在开发过程中对生产所做的所有更新。我认为您最好编写那个 xml 导出器/导入器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-04T10:24:48.750

看起来[Episerver Mirroring](http://world.episerver.com/documentation/Items/Tech-Notes/EPiServer-CMS-6/EPiServer-CMS-6-RC1/EPiServer-CMS-Mirroring-20/)可以解决您的问题。您可以借助计划作业或手动运行作业，使用镜像将内容从暂存转移到生产。

# php - 实现python切片表示法

> ID：12173856
> 
> 赞同：18
> 
> 时间：2012-08-29T08:35:57.970
> 
> 标签：php, python, arrays, algorithm, language-comparisons

我正在尝试用另一种语言（php）重新实现 python[切片表示法](https://stackoverflow.com/questions/509211/good-primer-for-python-slice-notation)，并寻找一个可以模仿 python 逻辑的片段（任何语言或伪代码）。也就是说，给定一个列表和一个三元组`(start, stop, step)`或其一部分，确定所有参数的正确值或默认值，并返回一个切片作为新列表。

我试着调查[源头](http://hg.python.org/cpython/file/3d4d52e47431/Objects/sliceobject.c)。该代码远远超出了我的 c 技能，但我不禁同意以下评论：

```
/* this is harder to get right than you might think */ 
```

此外，如果这样的事情已经完成，指针将不胜感激。

这是我的测试台（确保您的代码在发布之前通过）：

```
#place your code below
code = """
def mySlice(L, start=None, stop=None, step=None):
or 
<?php function mySlice($L, $start=NULL, $stop=NULL, $step=NULL) ...
or 
function mySlice(L, start, stop, step) ...
"""

import itertools

L = [0,1,2,3,4,5,6,7,8,9]

if code.strip().startswith('<?php'):
     mode = 'php'

if code.strip().startswith('def'):
     mode = 'python'

if code.strip().startswith('function'):
     mode = 'js'

if mode == 'php':
    var, none = '$L', 'NULL'
    print code, '\n'
    print '$L=array(%s);' % ','.join(str(x) for x in L)
    print "function _c($s,$a,$e){if($a!==$e)echo $s,' should be [',implode(',',$e),'] got [',implode(',',$a),']',PHP_EOL;}"

if mode == 'python':
    var, none = 'L', 'None'
    print code, '\n'
    print 'L=%r' % L
    print "def _c(s,a,e):\n\tif a!=e:\n\t\tprint s,'should be',e,'got',a"

if mode == 'js':
    var, none = 'L', 'undefined'
    print code, '\n'
    print 'L=%r' % L
    print "function _c(s,a,e){if(a.join()!==e.join())console.log(s+' should be ['+e.join()+'] got ['+a.join()+']');}"

print

n = len(L) + 3
start = range(-n, n) + [None, 100, -100]
stop  = range(-n, n) + [None, 100, -100]
step  = range(-n, n) + [100, -100]

for q in itertools.product(start, stop, step): 

    if not q[2]: q = q[:-1]

    actual = 'mySlice(%s,%s)' % (var, ','.join(none if x is None else str(x) for x in q))
    slice_ = 'L[%s]' % ':'.join('' if x is None else str(x) for x in q)
    expect = eval(slice_)

    if mode == 'php':
        expect = 'array(%s)' % ','.join(str(x) for x in expect)
        print "_c(%r,%s,%s);" % (slice_, actual, expect)

    if mode == 'python':
        print "_c(%r,%s,%s);" % (slice_, actual, expect)

    if mode == 'js':
        print "_c(%r,%s,%s);" % (slice_, actual, expect) 
```

如何使用它：

*   保存到文件 ( `test.py`)
*   将你的 python、php 或 javascript 代码放在`"""`s之间
*   运行`python test.py | python`或`python test.py | php`或`python test.py | node`

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-31T13:23:32.443

这是 C 代码的直接端口：

```
def adjust_endpoint(length, endpoint, step):
     if endpoint < 0:
         endpoint += length
         if endpoint < 0:
             endpoint = -1 if step < 0 else 0
     elif endpoint >= length:
         endpoint = length - 1 if step < 0 else length
     return endpoint

def adjust_slice(length, start, stop, step):
     if step is None:
         step = 1
     elif step == 0:
         raise ValueError("step cannot be 0")

     if start is None:
         start = length - 1 if step < 0 else 0
     else:
         start = adjust_endpoint(length, start, step)

     if stop is None:
         stop = -1 if step < 0 else length
     else:
         stop = adjust_endpoint(length, stop, step)

     return start, stop, step

def slice_indices(length, start, stop, step):
     start, stop, step = adjust_slice(length, start, stop, step)
     i = start
     while (i > stop) if step < 0 else (i < stop):
         yield i
         i += step

def mySlice(L, start=None, stop=None, step=None):
     return [L[i] for i in slice_indices(len(L), start, stop, step)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T08:46:54.110

这就是我想出的（python）

```
def mySlice(L, start=None, stop=None, step=None):
    answer = []
    if not start:
        start = 0
    if start < 0:
        start += len(L)

    if not stop:
        stop = len(L)
    if stop < 0:
        stop += len(L)

    if not step:
        step = 1

    if stop == start or (stop<=start and step>0) or (stop>=start and step<0):
        return []

    i = start
    while i != stop:
        try:
            answer.append(L[i])
            i += step
        except:
            break
    return answer 
```

似乎有效 - 让我知道你的想法

希望能帮助到你

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T13:17:41.623

这是我在 C# .NET 中提出的解决方案，可能不是最漂亮的，但它确实有效。

```
private object[] Slice(object[] list, int start = 0, int stop = 0, int step = 0)
{
    List<object> result = new List<object>();

    if (step == 0) step = 1;
    if (start < 0)
    {
        for (int i = list.Length + start; i < list.Length - (list.Length + start); i++)
        {
            result.Add(list[i]);
        }
    }
    if (start >= 0 && stop == 0) stop = list.Length - (start >= 0 ? start : 0);
    else if (start >= 0 && stop < 0) stop = list.Length + stop;

    int loopStart = (start < 0 ? 0 : start);
    int loopEnd = (start > 0 ? start + stop : stop);

    if (step > 0)
    {
        for (int i = loopStart; i < loopEnd; i += step)
            result.Add(list[i]);
    }
    else if (step < 0)
    {
        for (int i = loopEnd - 1; i >= loopStart; i += step)
            result.Add(list[i]);
    }

    return result.ToArray();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T07:53:36.423

我编写了一个基于 C 代码的 PHP 端口，针对步长 -1 和 1 进行了优化：

```
function get_indices($length, $step, &$start, &$end, &$size)
{
        if (is_null($start)) {
                $start = $step < 0 ? $length - 1 : 0;
        } else {
                if ($start < 0) {
                        $start += $length;
                        if ($start < 0) {
                                $start = $step < 0 ? -1 : 0;
                        }
                } elseif ($start >= $length) {
                        $start = $step < 0 ? $length - 1 : $length;
                }
        }

        if (is_null($end)) {
                $end = $step < 0 ? -1 : $length;
        } else {
                if ($end < 0) {
                        $end += $length;
                        if ($end < 0) {
                                $end = $step < 0 ? - 1 : 0;
                        }
                } elseif ($end >= $length) {
                        $end = $step < 0 ? $length - 1 : $length;
                }
        }

        if (($step < 0 && $end >= $start) || ($step > 0 && $start >= $end)) {
                $size = 0;
        } elseif ($step < 0) {
                $size = ($end - $start + 1) / $step + 1;
        } else {
                $size = ($end - $start - 1) / $step + 1;
        }
}

function mySlice($L, $start = NULL, $end = NULL, $step = 1)
{
        if (!$step) {
                return false; // could throw exception too
        }
        $length = count($L);
        get_indices($length, $step, $start, $end, $size);

        // optimize default step
        if ($step == 1) {
                // apply native array_slice()
                return array_slice($L, $start, $size);
        } elseif ($step == -1) {
                // negative step needs an array reversal first
                // with range translation
                return array_slice(array_reverse($L), $length - $start - 1, $size);
        } else {
                // standard fallback
                $r = array();
                for ($i = $start; $step < 0 ? $i > $end : $i < $end; $i += $step) {
                        $r[] = $L[$i];
                }
                return $r;
        }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-06T20:19:12.727

这是基于@ecatmur 的 Python 代码再次移植到 PHP。

```
<?php
function adjust_endpoint($length, $endpoint, $step) {
    if ($endpoint < 0) {
        $endpoint += $length;
        if ($endpoint < 0) {
            $endpoint = $step < 0 ? -1 : 0;
        }
    }
    elseif ($endpoint >= $length) {
        $endpoint = $step < 0 ? $length - 1 : $length;
    }
    return $endpoint;
}

function mySlice($L, $start = null, $stop = null, $step = null) {
    $sliced = array();
    $length = count($L);

    // adjust_slice()
    if ($step === null) {
        $step = 1;
    }
    elseif ($step == 0) {
        throw new Exception('step cannot be 0');
    }

    if ($start === null) {
        $start = $step < 0 ? $length - 1 : 0;
    }
    else {
        $start = adjust_endpoint($length, $start, $step);
    }

    if ($stop === null) {
        $stop = $step < 0 ? -1 : $length;
    }
    else {
        $stop = adjust_endpoint($length, $stop, $step);
    }

    // slice_indices()
    $i = $start;
    $result = array();
    while ($step < 0 ? ($i > $stop) : ($i < $stop)) {
        $sliced []= $L[$i];
        $i += $step;
    }
    return $sliced;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-06T06:24:21.643

我不能说代码中没有错误，但它已经通过了您的测试程序:)

```
def mySlice(L, start=None, stop=None, step=None):
    ret = []
    le = len(L)
    if step is None: step = 1

    if step > 0: #this situation might be easier
        if start is None: 
            start = 0
        else:
            if start < 0: start += le
            if start < 0: start = 0
            if start > le: start = le

        if stop is None: 
            stop = le
        else:
            if stop < 0: stop += le
            if stop < 0: stop = 0
            if stop > le: stop = le
    else:
        if start is None:
            start = le-1
        else:
            if start < 0: start += le
            if start < 0: start = -1
            if start >= le: start = le-1

        if stop is None: 
            stop = -1 #stop is not 0 because we need L[0]
        else:
            if stop < 0: stop += le
            if stop < 0: stop = -1
            if stop >= le: stop = le

    #(stop-start)*step>0 to make sure 2 things: 
    #1: step != 0
    #2: iteration will end
    while start != stop and (stop-start)*step > 0 and start >=0 and start < le:
        ret.append( L[start] )
        start += step

    return ret 
```

# android - 自定义部分 Android Manifest

> ID：12173860
> 
> 赞同：5
> 
> 时间：2012-08-29T08:36:05.203
> 
> 标签：android, ant, android-manifest

我正在开发 Android 应用程序，我想为市场上的不同语言提供几个不同的 apk（每种语言都包含大量文件，我想避免使用所有语言包创建一个巨大的 apk）。

所以我需要为每种语言定制一点清单文件：例如应用程序的包和可能的应用程序版本等。我知道如何模板化清单，以便我可以手动将我的值插入到某些点文件（见[这篇文章](https://stackoverflow.com/questions/10569760/android-how-do-i-dynamically-set-the-package-name-at-build-time-for-an-open-so)）。问题是我使用 ant 来准备我的生产 apk，但否则我使用 Eclipse 进行开发，所以我的项目也需要在 IDE 中工作。Eclipse 需要完整的清单文件，并且据我所知，我不会理解我将用于 ant 构建的模板（请有人证明我错了）。

我的问题是我想避免维护两个大部分相同的清单文件（一个是模板文件，一个是完整的 Eclipse）。目前我可以想到两种可能的方法，但我不知道如何实现它们：

*   在清单文件中使用某种定义注入：如果我能够在 AndroidManifest 文件的主体中注入某些 xml 文件，我可以将相同的部分保留在一个 xml 部分中并仅自定义差异点
*   如果可以将 Eclipse 配置为使用一些 ant 任务序列来构建 Android 项目而不是预构建例程，我可能能够集成我在 IDE 中构建生产 apk 的方式。

请如果有人知道如何完成上述两个中的任何一个，或者有任何其他想法我该如何解决我的问题：帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T11:05:31.990

看一下 ant replace 任务：

```
<replace file="${build.out}/src/config.prop" token="@@@" value="${build.version}-${build.type}"/> 
```

但是，您应该再次注意它们是唯一的值。

[您还可以用echoxml](http://ant.apache.org/manual/Tasks/echoxml.html)任务生成的清单替换您的 Eclipse 清单。

或者你可以重用这个关于 xml 操作的好[任务。](http://today.java.net/pub/a/today/2006/11/01/xml-manipulation-using-xmltask.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T07:01:39.790

在我工作的公司，我们几乎使用 Eugen 给出的方法来自动化应用程序的构建过程，例如应该通过交换某些资产、样式、字符串和配置来简单地进行不同的品牌化。我们倾向于按如下方式设置项目和构建过程：

1.  创建 Android 项目并将其设置为适用于特定品牌。这将确保您仍然可以从 Eclipse 构建和运行。假设代码库在不同品牌的版本之间没有变化，那应该没问题。
2.  创建一个 ant 构建配置：
    1.  将要更改的所有文件复制到备份目录
    2.  根据配置文件修改项目文件（见下文）
    3.  编译项目源代码并使用发布密钥对其进行签名（如果进行发布构建）
    4.  复制步骤 1 中的文件，覆盖所有更改并将项目恢复到原始状态
3.  为场景中的每个“品牌”或特定语言版本创建配置文件。

基本上，这些步骤将允许您通过简单地使用 ant build 命令提供适当的配置来创建品牌/合作伙伴/语言特定的构建。在我们的例子中，它看起来有点像这样：

```
ant partner-release -Dpartner=stackoverflow 
```

其中“stackoverflow”将指向同名的配置。在我们的例子中，这些配置文件是小的 xml 文件，其中包含要为该特定构建替换的所有参数。它可以包含字符串，但也可以指向应该复制到资产/资源中的其他文件（例如徽标图像）。例如：

```
<config>
    <version_name>1.00</version_name>
    <version_code>1</version_code>
    ...
</config> 
```

更多指针：

*   我们`xmltask`用来修改项目中的任何xml文件；例如清单和资源。
*   由于上述任务非常易于使用，因此我们的构建配置文件也设置为 xml 文件，如上图所示。它非常易于阅读，并且易于更改。
*   您还可以使用[`replace`](http://ant.apache.org/manual/Tasks/replace.html)和[`ReplaceRegExp`](http://ant.apache.org/manual/Tasks/replaceregexp.html)任务来更改几乎任何文件中的配置相关变量。后者可以特别方便地对源代码进行构建时更改。

# ios - xcode 中的框架导入问题

> ID：12173863
> 
> 赞同：1
> 
> 时间：2012-08-29T08:36:21.687
> 
> 标签：ios, xcode, frameworks

这里的问题是：对于工作中的项目，我们需要包含一个外部 API：来自 HasOffers 的 mobileAppTrackeriOS。

它为我们提供了一个包含在项目中的框架和输入代码的指令。所以我把项目目录下的框架复制下来，拖到xcode中包含进去。但是当我想使用它时：

```
#import <framework/mainheader.h> 
```

构建给我一个错误：

```
Lexical or Processor issue 'MobileAppTrackeriOS_arc/MobileAppTracker.h' file not found 
```

我在我的目标构建设置中检查了框架搜索路径，我的主目录框架在哪里。

我用 "" 而不是 <> 测试同样的问题......

我清理并重建，尝试直接包含标题......许多荒谬的事情......没有变化。

那么我忘记了什么？

我在 Xcode 4.5 上并为 iOS 6.0 开发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:58:54.760

A question, can you see if the framework is in Build Phases -> Link binary with Libraries?

If answer is not, you must add in this section.

# php - php is_file 总是返回 false

> ID：12173865
> 
> 赞同：5
> 
> 时间：2012-08-29T08:36:22.893
> 
> 标签：php

php is_file 总是返回 false

```
[apache@h185 default]$ ls -l /home/www/default/p.php
-rwxr-xr-x. 1 zhouhh zhouhh 50837 Aug 28 19:02 /home/www/default/p.php
[apache@h185 default]$ ls -l /usr/bin/rrdtool
-rwxr-xr-x. 1 root root 24688 Aug 21  2010 /usr/bin/rrdtool
[apache@h185 default]$ ls -l /root/my.cnf
ls: cannot access /root/my.cnf: Permission denied
[apache@h185 default]$ ls -l /usr/bin/ld
-rwxr-xr-x. 1 root root 594968 Jun 22 22:06 /usr/bin/ld
[apache@h185 default]$ ls -l /usr/bin/php
-rwxr-xr-x. 1 root root 3224944 Jul  4 00:57 /usr/bin/php
[apache@h185 default]$ vi test.php
[apache@h185 default]$ cat test.php
<?php
#if(is_file('/home/www/default/p.php'))

#if(is_file('/usr/bin/rrdtool'))
#if(is_file('/root/my.cnf'))
#if(is_file('/usr/bin/ld'))
#if(file_exists('/usr/bin/ld'))
if(is_file('/usr/bin/php'))
{
print 'ok';
}
else
{
print 'no ok';
}
?>
[apache@h185 default]$ 
```

除了第一行返回 true，其他行总是返回 false。但是这个文件都存在。/root/my.cnf 不能访问，其他文件可以执行和读取。

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-29T08:40:57.730

请注意，如果父目录没有为运行 php 文件的用户设置（运行权限） ，则`is_file()`返回*false 。*`+x`

这是有道理的，但其他功能如`readdir()`似乎没有这个限制。最终结果是您可以遍历目录的文件，但`is_file()`总是会失败。

[从这里](http://il1.php.net/manual/en/function.is-file.php)引用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-08T23:42:38.050

请注意，www-data 或 web 服务器用户必须有权访问目录，而文件是，以 webserver 用户身份登录（linux 中的 su www-data）并检查您是否可以通过您用来访问的所有路径进行访问文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-20T11:58:21.213

您还可以使用不受运行权限问题影响的 !is_dir 。

```
if(!is_dir($filename)) {
  //remove a file
  unlink($filename);
} else {
  //remove a directory
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T08:43:33.767

`is_file()`如果文件是[**常规文件则**](http://en.wikipedia.org/wiki/Unix_file_types#Regular_file)返回。

> 当您执行 ls -l 如果文件权限的第一列是 - 时，则该文件是常规文件。

所以使用[`file_exists()`](http://php.net/manual/en/function.file-exists.php)功能。如果文件/目录存在，则返回。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-24T08:14:29.170

我有同样的问题。问题是文件路径不正确。

始终确保 eg`is_file($dir.$file)`指向正确的位置。

通过以下方式输出您最近的位置：`var_dump($dir.$file);`

如果设置了正确的文件路径（必须为真），则输出：`var_dump(is_file($dir.$file));`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-28T23:16:11.487

作为一般规则，请根据先前的答案检查您的文件权限。

在 Docker 构建环境中，由于 host:container 目录映射而复制的文件可能没有正确复制。如果您查看`-??????????`文件的权限，请使用 . 手动复制文件`docker cp`。

# c# - 在 MC++ 代码中从 C# DLL 调用函数

> ID：12173869
> 
> 赞同：0
> 
> 时间：2012-08-29T08:36:41.380
> 
> 标签：c#, managed-c++

我有 ac# dll，其中包含用于与财务设备通信的类。问题是我必须从 MC++ 程序访问这些类。

谁能给我一些提示或指导我如何做到这一点。感谢您提前提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:54:37.177

如 codeteq 评论中所述，您需要添加对 c# 程序集的引用。

同样在您的代码中，您需要引用它 - 这个例子：

```
//hello.cpp
#using <mscorlib.dll>
using namespace System;

int main()  {
  Console::WriteLine("Hello, world!");
  return 0;
} 
```

来自[http://en.wikipedia.org/wiki/Managed_Extensions_for_C%2B%2B](http://en.wikipedia.org/wiki/Managed_Extensions_for_C%2B%2B)

本文提供了更多信息：http: [//support.microsoft.com/kb/310674](http://support.microsoft.com/kb/310674)

# wcf - WCF 捕获自定义 FaultException

> ID：12173870
> 
> 赞同：1
> 
> 时间：2012-08-29T08:36:49.680
> 
> 标签：wcf, faultexception

我想像这样使用custome FaultException

```
 [DataContract]
public class Fault
{
    [DataMember]
    public string Message { get; set; }
}

public class MyFault<T>:FaultException<T> where T : Fault
{
     public MyFault(T faultClass)
        : base(faultClass, new FaultReason(faultClass.Message))
    {

    }
} 
```

...

```
throw new MyFault<Fault>(new Fault {Message = "hello"}); 
```

...

界面

```
[OperationContract]
[FaultContract(typeof(Fault))]
string GetData2(int value); 
```

但是当它到达客户端时，它会转换为 FaultException

```
 try
        {
            var res = serv.GetData2(1);
        }
        catch (MyFault<WcfService1Sample.Fault> ex)
        {
            label1.Text = ex.Reason.ToString(); //-> i want here
        }
        catch (FaultException<ServiceReference1.Fault> ex)
        {
            label1.Text = ex.Reason.ToString(); //-> catch here
        }
        catch (Exception)
        {

            throw;
        } 
```

我可以在 clint 上发现自定义错误吗？或 WCF 自动将其转换为 FaultException 我如何解决此问题

谢谢 kfir

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:57:16.343

There are two issues, I think. First:

*   What [shambulator](https://stackoverflow.com/users/351301/shambulator) said: Your custom `Fault` class must be
    *   a `DataContract`, and use
    *   `DataMember` to mark all properties that shall be serialized.

If this is done, then WCF will

*   translate a service-side `throw new FaultException<MyFault>(new MyFault { ... });` into a message which contains your fault, including the data; and
*   translate this fault on the client-side to a `FaultException<MyFault>`.

Second:

This client-side `FaultException<>` is generated by WCF. Maybe one can register a custom Exception-Translator, but I have never used it, never needed it, and not found such a thing after a one-minute Google search. I'd recommend just going with the `FaultException` plus custom Fault-type.

# android - 显示来自 url android 的视频

> ID：12173872
> 
> 赞同：3
> 
> 时间：2012-08-29T08:36:56.030
> 
> 标签：android, video, android-videoview

我有这个视频：[http](http://www.youtube.com/v/oyB5QWcPSRo?version=3&f=user_uploads&app=youtube_gdata) ://www.youtube.com/v/oyB5QWcPSRo? version=3&f=user_uploads&app=youtube_gdata，我需要它在我的应用程序中播放，我用 videoView 测试失败。：有错误消息“无法播放视频”

```
MediaController mc = new MediaController(this);
mc.setAnchorView(vidYout);
mc.setMediaPlayer(vidYout);
Log.v("TAG","URL: "+YoutubeVO.url_video);
Uri video = Uri.parse("devimages.apple.com/iphone/samples/bipbop/gear1/prog_index.m3u8");
//Uri video = Uri.parse(YoutubeVO.url_video);
vidYout.setMediaController(mc);
vidYout.setVideoURI(video);
vidYout.requestFocus();
vidYout.start(); 
```

如果问题出在视频中，我尝试更改 URL，但不是。我也尝试过使用 webView 失败

```
wvComunicado.getSettings().setLoadWithOverviewMode(true);
wvComunicado.getSettings().setUseWideViewPort(true);
wvComunicado.loadData(YoutubeVO.url_video, "text/html" , "UTF-8"); 
```

关于如何玩它的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T08:42:34.063

添加`requestFocus()`方法：

```
MediaController mc = new MediaController(this);
mc.setAnchorView(vidYout);
mc.setMediaPlayer(vidYout);
Log.v("TAG","URL: "+YoutubeVO.url_video);
Uri video = Uri.parse("http://devimages.apple.com/iphone/samples/bipbop/gear1/prog_index.m3u8");
// Uri video = Uri.parse(YoutubeVO.url_video);
vidYout.setMediaController(mc);
vidYout.setVideoURI(video);
vidYout.requestFocus();
vidYout.start(); 
```

这对我有用：

```
String path = "http://devimages.apple.com/iphone/samples/bipbop/gear1/prog_index.m3u8";
video.setVideoURI(Uri.parse(path));

mediaController = new MediaController(this);
mediaController.setMediaPlayer(video);
video.setMediaController(mediaController);
video.requestFocus();
video.start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T10:26:51.210

如 android 文档中所述，您只能从各种来源（例如**资源**或**内容提供者**）加载图像或视频。

如果您使用资源文件夹或 sdcard 中的视频文件（使用它们的路径）以及您的内容提供商使用它们的 uri，则您的代码将起作用。

以下代码对我有用：

```
try
        {

    this.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
                LinearLayout ll = (LinearLayout) findViewById(R.id.mLinearLayout);
                ll.setVisibility(View.VISIBLE);
                getWindow().setFormat(PixelFormat.TRANSLUCENT);
                VideoView vv = new VideoView(this);
                ll.addView(vv);
                vv.setMediaController(new MediaController(this));
                vv.setVideoURI(Uri.parse(Environment.getExternalStorageDirectory() + "/Movies/story.mp4"));

                vv.setSoundEffectsEnabled(true);
                vv.requestFocus();
                vv.start();
            }
            catch (Exception e)
            {
                Toast.makeText(this, "Exception :: "+e.getMessage(), Toast.LENGTH_SHORT).show();
                e.printStackTrace();
            } 
```

注意：您也可以使用 vv.setVideoPath(String path); 用于提供资源的路径。

# php - 设置常数前检查？

> ID：12173873
> 
> 赞同：1
> 
> 时间：2012-08-29T08:36:56.923
> 
> 标签：php, constants

在设置之前检查常量是否存在更好？还是直接设置就可以了？我正在创建一个 WordPress 插件并设置一些常量，我已经看到一些插件直接设置它们，而其他插件则通过 if !(defined) 检查

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:41:05.267

这取决于。如果您可以合理地预期该常量已经存在，那么您应该检查一下。如果您确定该常量此时一定不存在，因为您需要定义它，那么如果您的期望没有得到满足，您不应该检查并让 PHP 严重失败。错误有助于查明问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:42:50.710

如果整个项目都在您的控制之下，那么您可以只定义常量而不检查它（因为您应该知道它是否存在）。

但是开发一个wordpress插件，需要防止这个常量与其他插件中定义的其他常量冲突，需要先检查一下。

# ruby-on-rails - 使用自定义 foreign_key 将数据库结果作为对象包含在内

> ID：12173875
> 
> 赞同：0
> 
> 时间：2012-08-29T08:37:01.623
> 
> 标签：ruby-on-rails, ruby

我有一个论坛表，其中有一个“last_post_id”列，它指向论坛中的最后一个帖子。如何将其包含在我的主论坛查询中，以便最后一个主题是我可以访问的对象？

这不起作用，但它有助于传达我所追求的

```
 Forum.all(
    :include    => {:posts => {:foreign_key => "last_post_id"}},
    :order      => "ancestry ASC, display_order ASC", 
  ) 
```

我希望能够使用“forum.last_post.date”之类的内容访问最后一个帖子对象。这可能吗，最干净的解决方案是什么？

RAW sql 应该如下所示：

```
 SELECT forums.*, last_post.*
         FROM forums as forums
    LEFT JOIN posts  as last_post on last_post.id = forums.last_post_id
     ORDER BY ancestry asc, display_order asc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:07:35.110

```
class Forum < ActiveRecord::Base
  has_many :posts
  has_one :last_post, :class_name => 'Post', :primary_key => :last_post_id
end

Forum.all(:include => [:last_post]) 
```

# spring - Spring MVC 3 中的模型对象验证

> ID：12173876
> 
> 赞同：1
> 
> 时间：2012-08-29T08:37:02.467
> 
> 标签：spring, validation, spring-mvc

我正在使用 Spring MVC 3，并尝试对模型对象使用验证注释。

但是我发现这个验证只有在没有抛出异常的情况下才有效。

以这个 pojo 为例：

```
public class Person{
    private String name;
    @Min(30)
    private int age;
} 
```

现在，我将通过 html 表单创建新的 Person 实例，如果年龄的类型是 int，则验证工作。

但如果不是（例如，用户输入了一个年龄字符串），它将抛出异常。

我想知道在哪里捕获这个异常并将它的消息放在错误表单字段中？

* * *

更新：

servlet-context.xml

```
<mvc:annotation-driven />
<mvc:view-controller path="/" view-name="home" />
<context:component-scan base-package="com.king.controller" />
<mvc:resources mapping="/res/**" location="/res/" />
<bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
    <property name="prefix" value="/WEB-INF/jsp/" />
    <property name="suffix" value=".jsp" />
</bean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:29:38.043

尝试在您的资源消息属性文件中添加一个带有`typeMismatch`键的属性。

以通用方式处理任何 typeMismatch 错误：

```
typeMismatch=This is a not valid type 
```

或更具体地，对于具体属性：

```
typeMismatch.person.age=This is a not valid a type 
```

这将防止 Spring 抛出异常，并将相应的消息添加到您的错误中。

希望这可以帮助。

**更新：**

您必须在*servlet-context.xml*中添加此 bean ：

```
<bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource"
        p:basename="/WEB-INF/messages/validation" /> 
```

并在*/WEB-INF/messages*文件夹中添加文件*validation.properties* ，并使用上面提到的值（）。*`typeMismatch...`*

# windows-phone-7 - 在 WP7 中播放 mp3 音频文件

> ID：12173881
> 
> 赞同：0
> 
> 时间：2012-08-29T08:37:14.963
> 
> 标签：windows-phone-7, audio, streaming, mp3

我想使用 windows phone 7 从服务器流式传输音频

音频扩展名是 mp3。我尝试过 Mp3MediaStreamSource 类，但问题是它下载了所有音频然后开始播放。

我想知道在 WP7 平台 7.0 中播放音频的最佳方式是什么（使用缓冲 -> 不等到整个音频文件下载完毕。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:01:14.243

我使用后台音频代理做流 mp3 无线电广播。看看这个教程[http://msdn.microsoft.com/en-us/library/hh202978(v=VS.92).aspx](http://msdn.microsoft.com/en-us/library/hh202978(v=VS.92).aspx)

# java - Java找不到主类

> ID：12173886
> 
> 赞同：-1
> 
> 时间：2012-08-29T08:37:52.803
> 
> 标签：java, cmd

我的 java 找不到主类`why.helloworld`。我不知道为什么。这是我的代码：

```
package why;
public class Helloworld {
    public static void main(String[] args) {
        System.out.println("viva");
    }
} 
```

环境变量：

> 类路径：.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;
> JAVA_HOME:C:\Program Files\Java\jdk1.7.0
> 路径：%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:42:31.710

不幸的是，您还没有发送命令行，但我猜您在运行应用程序时忘记写包名。使用命令行：

`java -cp YOUR_CLASSPATH why.Helloworld`

从您的项目目录运行它。`YOUR_CLASSPATH`应该是您的 jar 文件的`.`名称或您的类所在目录的路径。可能是`classes`或`bin`取决于您的项目结构。

# javascript - 嵌入谷歌地图后的 CSS 错误

> ID：12173887
> 
> 赞同：-1
> 
> 时间：2012-08-29T08:38:01.380
> 
> 标签：javascript, html, css, google-maps

我有一个问题，我的页面格式在只有一个嵌入了谷歌地图的页面上变得混乱。

错误在不同的浏览器上发生变化，但包括字体大小（FF）、移动框（FF）、下拉菜单不起作用（IE）。

我能做些什么来解决这个问题。

谢谢

编辑：我的问题的截图.. [http://i.imgur.com/h79rz.png](http://i.imgur.com/h79rz.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T10:41:22.587

结果发现文件头不一致并且没有调用所需的xml文件，这不是我做的。此外，某些 CSS 表格未按应有的方式继承，从而导致某些字体大小和对齐方式混乱。

# android - 如何以预设的时间间隔（例如 5 分钟）在 android 中刷新我们的应用程序或活动

> ID：12173894
> 
> 赞同：-3
> 
> 时间：2012-08-29T08:38:48.057
> 
> 标签：android

我想每隔 5 分钟重新加载一次活动的数据，我的活动将自动重新加载。但我无法做到这一点。请帮助我如何做到这一点。？

请提供一些示例代码的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:43:31.413

如果您想要更新数据，那么您可以为您想要的时间段创建一个 TimerTask。在此任务中，您可以更改数据。

[http://android.okhelp.cz/timer-simple-timertask-java-android-example/](http://android.okhelp.cz/timer-simple-timertask-java-android-example/)

```
package cz.okhelp.timer;

import java.util.Timer;
import java.util.TimerTask;

import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

 public class TimerActivity extends Activity {
 TextView hTextView;
 @Override
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    hTextView = (TextView)findViewById(R.id.idTextView);
    MyTimerTask myTask = new MyTimerTask();
    Timer myTimer = new Timer();
    //        public void schedule (TimerTask task, long delay, long period) 
    //        Schedule a task for repeated fixed-delay execution after a specific delay.
    //
     //        Parameters
    //        task  the task to schedule. 
   //        delay  amount of time in milliseconds before first execution. 
   //        period  amount of time in milliseconds between subsequent executions. 

    myTimer.schedule(myTask, 3000, 1500);        

}
       class MyTimerTask extends TimerTask {
  public void run() {
      // ERROR
     hTextView.setText("Impossible");
     // how update TextView in link below  
             // http://android.okhelp.cz/timer-task-timertask-run-cancel-android-    example/
    System.out.println("");
  }
} 
```

}

# c# - 如何使用 C# 将矩阵复制到 Ms Word 表中而无需循环

> ID：12173898
> 
> 赞同：1
> 
> 时间：2012-08-29T08:39:08.767
> 
> 标签：c#, excel, string, ms-word

我确实将整个字符串 [4273,11] 复制到 Word 中，但是每次循环和插入每个单元格都需要很长时间。我想要做的是将整个字符串 [4273,11] 直接复制到**MS Word** **表中**。如果还有一种方法可以将 Excel 工作表的内容复制到 MS Word，我将不胜感激，因为它将以任何方式解决问题。

```
public void WriteContent(string[,] array, Word.Table oDoc)
{
// This is where I fill the Excel worksheet with the string [4273,11] array

Range range = (Range)m_worksheet.Cells[1, 1];
range = range.get_Resize(4273, 11);
// Assign the 2-d array to the Excel Range
range.set_Value(Microsoft.Office.Interop.Excel.XlRangeValueDataType.xlRangeValueDefault, array);

//This is Where I want to Paste the Excel "range" into the word document
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T11:33:41.810

您可以在办公应用程序之间复制和粘贴，但复制范围非常大，因此您需要一些延迟或检查。此回复来自 Office 知识，而不是 c#。

```
range.Copy();
_wordApp.Selection.Paste(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:49:59.360

比你 。我已经这样做了，问题是如何选择特定范围，所以我这样做了

`m_Worksheet.get_Range("A1", "K5000").Copy();`

`This range = range.get_Resize(4273, 11);`

下一行表示您的范围已被选中。

# air - 在资源管理器中的文件图标上添加状态图标，例如 Air 中的 Dropbox 或 SVN

> ID：12173902
> 
> 赞同：0
> 
> 时间：2012-08-29T08:39:24.193
> 
> 标签：air, icons, overlay

我是 Adob​​e AIR 的新手。请帮忙

我想在资源管理器中的文件图标上添加状态图标，例如 Dropbox 或 SVN。我正在为 Mac 和 Windows 开发 Adob​​e AIR 中的 Dropbox 之类的应用程序。

我认为 OS Mac 和 Windows 都支持 AIR 是很常见的，所以我可以选择这个工具。

我有两个疑问。

1.  在资源管理器中的文件图标上添加状态图标，例如 Dropbox 或 SVN。
2.  您拥有的文件夹观察器和对此的想法以及任何类和实用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T07:40:23.923

就个人而言，我不认为 AIR 是解决此问题的正确解决方案。尽管可以轮询一个目录并将其最后一个已知结构与其当前结构进行比较，但我想这在 Actionscript 3 和 Javascript 中都非常低效。

诸如 Java 之类的语言在其最新的主要版本中具有“开箱即用”的[目录监视实用程序，并且具有能够将这些任务委托给不同线程的好处。](http://docs.oracle.com/javase/tutorial/essential/io/notification.html#overview)

再举一个例子，比如[TortoiseSVN](http://en.wikipedia.org/wiki/TortoiseSVN)，它监视目录并动态更改图标是用 C++ 编写的。

# iphone - 如何在目标C中相交两个数组？

> ID：12173903
> 
> 赞同：21
> 
> 时间：2012-08-29T08:39:23.877
> 
> 标签：iphone, objective-c, nsmutablearray, intersection, nsmutableset

我有两个数组。Array1 包含 15 个对象，Array2 包含 4 个对象。两个数组都有 2 个公共对象，我只想得到这 2 个对象的结果数组。

它应该像两个 Set 的交集，但是如何在 Objective C 中为数组..？请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-08-29T08:50:47.637

使用 NSMutableSet

```
NSMutableSet *set1 = [NSMutableSet setWithArray: array1];
NSSet *set2 = [NSSet setWithArray: array2];
[set1 intersectSet: set2];
NSArray *resultArray = [set1 allObjects]; 
```

# c# - 将 DataGridComboBoxColumn 绑定到静态源

> ID：12173909
> 
> 赞同：0
> 
> 时间：2012-08-29T08:39:46.420
> 
> 标签：c#, wpf, xaml, datagridcomboboxcolumn

我有一个`DataGrid`，`DataGridComboBoxColumn`我想将它绑定到一个只包含选项“A”，“B”，“C”的静态源

当前的xml：

```
<DataGridComboBoxColumn x:Name="ControlOption" Header ="ControlOption" Width="100"
    SelectedValueBinding="{Binding Operation}"
    SelectedItemBinding="{Binding Choices}"
    ScrollViewer.CanContentScroll="True"
    ScrollViewer.VerticalScrollBarVisibility="Auto"
    IsReadOnly="True"
    CanUserResize="True">

    <DataGridComboBoxColumn.ElementStyle>
        <Style TargetType="ComboBox">
            <Setter Property="ItemsSource" Value="{Binding Choices}" />
        </Style>
    </DataGridComboBoxColumn.ElementStyle>
    <DataGridComboBoxColumn.EditingElementStyle>
        <Style TargetType="ComboBox">
            <Setter Property="ItemsSource" Value="{Binding Choices}" />
        </Style>
    </DataGridComboBoxColumn.EditingElementStyle>
    <DataGridComboBoxColumn.ItemsSource>
        <col:ArrayList>
            <sys:String>AVS</sys:String>
            <sys:String>DB</sys:String>
            <sys:String>AVS_DB</sys:String>
        </col:ArrayList>
    </DataGridComboBoxColumn.ItemsSource>

</DataGridComboBoxColumn> 
```

请让我知道代码隐藏的样子：实现`DataGridComboBox`我目前使用的代码隐藏：

```
_ds = new DataSet();
DataTable table = new DataTable();
_ds.Tables.Add(table);
DataColumn c1 = new DataColumn("IsActive", typeof(bool));
table.Columns.Add(c1);
DataColumn c2 = new DataColumn("DataGridTextBox_QCList1", typeof(string));
table.Columns.Add(c2);
DataColumn c3 = new DataColumn("DataGridTextBox_QCSummary", typeof(string));
table.Columns.Add(c3);
DataColumn c4 = new DataColumn("Choices", typeof(string));
table.Columns.Add(c4);
datagrid.ItemsSource = _ds.Tables[0].DefaultView; 
```

我需要进行哪些更改才能对填充 datagridcombobox 产生必要的影响（基本问题是，我什至没有看到下拉菜单）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:20:15.920

如果您使用 a`DataTable`作为，`ItemsSource`则无法`DataGrid`知道给定列只能有有限数量的值，因此它只会`DataGridTextColumns`为字符串列生成。

您可以挂钩事件[`AutoGeneratingColumn`](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.autogeneratingcolumn.aspx)，通过事件参数检查是否正在生成感兴趣的列，并使用相应的绑定和设置`Column`将事件参数更改为 a 。`DataGridComboBoxColumn``ItemsSource`

# asp.net - AutoPostBack=True 和 AutoPostBack=False 之间的区别？

> ID：12173914
> 
> 赞同：44
> 
> 时间：2012-08-29T08:40:23.723
> 
> 标签：asp.net, autopostback

`AutoPostBack=True`和有什么区别`AutoPostBack=False`？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-29T08:48:24.250

取自[http://www.dotnetspider.com/resources/189-AutoPostBack-What-How-works.aspx](http://www.dotnetspider.com/resources/189-AutoPostBack-What-How-works.aspx)：

> `Autopostback`是根据 Web 控件中的某些事件自动将页面回传到服务器的机制。在某些 Web 控件中，名为 auto post back 的属性如果设置为 true，则会在控件中发生事件时将请求发送到服务器。
> 
> 每当我们在任何控件上将 autopostback 属性设置为 true 时，.NET 框架都会自动在生成的 HTML 中插入几行代码来实现此功能。
> 
> 1.  一个名为 __doPostBack (eventtarget, eventargument) 的 JavaScript 方法
> 2.  两个名为 __EVENTTARGET 和 __EVENTARGUMENT 的隐藏变量
> 3.  控件的 OnChange JavaScript 事件

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-29T08:42:10.083

`AutoPostBack = true`允许控制回发到服务器。它与一个事件相关联。

例子：

```
<asp:DropDownList id="id" runat="server" AutoPostBack="true" OnSelectIndexChanged="..."/> 
```

带有上述下拉列表的 aspx 页面不需要`asp:button`回发。当您更改下拉列表中的选项时，页面将被发送回服务器。

on control 的默认值为`AutoPostBack`false。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-29T08:47:54.067

AutopostBack 是您分配给 Web 控件的属性，如果您想在它们发生任何事件时回发页面。

您可能会看到这篇文章：[什么是 AutoPostBack？](http://www.dotnetspider.com/resources/189-AutoPostBack-What-How-works.aspx)

> Autopostback 是一种机制，通过该机制，页面将根据 Web 控件中的某些事件自动回发到服务器。在某些 web 控件中，称为 auto post back 的属性，如果设置为 true，将在控件中发生事件时将请求发送到服务器

例如，TextBox 具有[AutoPostBack](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.autopostback.aspx)属性

> 使用 AutoPostBack 属性指定当 TextBox 控件失去焦点时是否自动回发到服务器。在 TextBox 控件中按 ENTER 或 TAB 键是更改焦点的最常用方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-11T10:49:47.320

该`AutoPostBack`属性用于设置或返回当用户在控件中按下“ENTER”或“TAB”时是否发生自动回发`TextBox`。

如果此属性设置`TRUE`为启用自动回发，否则`FALSE`。默认值为`FALSE`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-29T09:31:37.383

有一个事件默认与任何 web 控件关联。例如，在按钮单击事件的情况下，如果存在复选框 CheckChangedEvent。因此，如果 AutoPostBack 为 true，则默认调用这些事件，并在服务器端处理事件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-10-05T09:32:29.210

**自动回邮：**

AutopostBack 是控件的一个属性，它**启用**对 Web 控件更改的回发。

**AutopostBack=True 和 AutoPostBack=False 的区别：**

如果 **AutopostBack 属性设置为 true**，则回发会立即发送到服务器

如果 **AutopostBack 属性设置为 false**，则不会发生回发。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-01-08T21:35:09.897

AutoPostBack 属性：

无法自行提交表单（回发）的 Asp.net 控件，因此 ASP.Net 提供了使用

```
 AutoPostBack = "true" 
```

：DropDownList、CheckBoxList、RadioButtonList 等哪些控件可以执行 PostBack（单击时）。

和

```
AutoPostBack = "false" 
```

它是可以在按钮提交时执行回发的控件的默认状态。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-09T02:38:48.310

**海先生**

> 有一个事件默认与任何 web 控件关联。例如，在按钮单击事件的情况下，如果存在复选框 CheckChangedEvent。因此，在 AutoPostBack 为 true 的情况下，默认情况下会调用这些事件，并在服务器 sid 处进行事件句柄

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-21T08:02:05.797

如果您希望控件在引发事件时自动回发，则需要将控件的*AutoPostBack*属性设置为*True*。

# asp.net-mvc-3 - T-SQL 查询的 LINQ 等效项

> ID：12173917
> 
> 赞同：0
> 
> 时间：2012-08-29T08:40:31.977
> 
> 标签：asp.net-mvc-3, sql-server-2008, entity-framework-4

我有列的表：

```
ID(int), Ano(varchar), Bno(varchar), StartTime(DateTime), EndTime(DateTime) 
```

此 SQL 查询的等效 LINQ 语句是什么：

```
 SELECT 
    StartTime, EndTime, Ano, Bno,  
    datediff(s, StartTime, EndTime) as duration 
 FROM 
    TABLENAME 
 where 
    StartTime >= 'value Input by user' 
    and StartTime <= 'value INPUT by user' 
 order by 
    StartTime desc 
```

在这里，我如何选择将值转换为分钟的持续时间。以分钟和秒为单位计算所有记录的总持续时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:51:26.837

```
DateTime startTime = <Startime given by user>;
DateTime endTime = <Endtime given by user>;

var result = 
yourSource
  .Where (m => m.StartTime >= startTime && m.StartTime<= endTime)
  .OrderByDescending(m => m.StartTime)
  .Select(m => new {
     startTime = m.StartTime,
     endTime = m.EndTime,
     ano = m.Ano,
     bno = m.Bno,
     duration = SqlFunctions.DateDiff("mi", m.StartTime, m.EndTime)
}); 
```

顺便说一句，你也可以得到没有持续时间的结果，并在检索结果后计算它（避免匿名）

就像是 ：

```
var duration = (EndTime - StartTime).Minutes; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:49:11.047

匹配以下代码：

```
var result = from Entityname in EntityListName
    where Entityname.StartTime >= 'value Input by user' etc ...
    orderby Entityname.StartTime descending 
    select Entityname; 
```

# iphone - iOS：在特定时间在后台播放/停止音乐

> ID：12173920
> 
> 赞同：0
> 
> 时间：2012-08-29T08:40:48.447
> 
> 标签：iphone, ios, audio, background, ipod

我正在开发一个应用程序，即使在后台，它也可以在特定时间停止或播放来自 iPod 或其他音频的音乐。可能吗？

我知道使用本地通知可以在 30 秒内播放音频，但我需要更多时间。有像 TuneIn Radio 这样的应用程序可以做到这一点。

非常感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:54:30.127

除非是您的应用在后台播放音乐，否则我认为这是不可能的。最困难的部分是您无法在后台运行应用程序，除非它是播放声音、跟踪用户位置或 voip 客户端。

您可以使用本地通知，但警报声音限制为 30 秒，并且您只能在应用启动时停止任何音频会话。

# java - 仅在不存在时将 cookie 添加到响应中

> ID：12173923
> 
> 赞同：1
> 
> 时间：2012-08-29T08:40:57.980
> 
> 标签：java, cookies, response, session-cookies

我需要检查是否已将 cookie 添加到响应中。

我有一个奇怪的问题，我的回复收到了`Set-Cookie`两次标头。

`Set-Cookie:foo=bar; Domain=dev.mysite.com; Expires=Fri, 05-May-2062 04:05:43 GMT; Path=/`

`Set-Cookie:foo=bar; Domain=dev.mysite.com; Expires=Fri, 05-May-2062 04:05:43 GMT; Path=/`

2个标题完全相同。当我调试堆栈时调用此代码两次。这段代码的加倍是由于我正在使用的 Web 堆栈，我无法更改。

我不关心请求中发送了哪些 cookie，但我不希望此标头发送两次。

似乎没有一种简单的方法可以找到通过该`addHeader`方法添加的 cookie。

在调试期间，奇怪的是，如果我在调用后检查响应对象中的标头，`response.addCookie(myCookie);`我看不到`Set-Cookie`标头。

如果响应中尚未发送同名 cookie，有没有办法只能将 cookie 添加到响应中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T10:17:38.080

家是正确的。

我已经创建了一个包装器`HttpServletResponseWrapper`并将 cookie 存储在`addCookie`方法中。

然后我在添加另一个之前检查列表中是否存在 cookie。

谢谢你的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-22T13:01:56.317

如果已经包含此类 cookie，您可以检查“Set-Cookie”标头。

```
public static void addCookieIfNotExists(Cookie cookie, HttpServletResponse response) {
    boolean exists = response.getHeaders("Set-Cookie").stream()
            .noneMatch(cookieValue -> cookieValue.startsWith(cookie.getName() + "="));

    if (!exists) {
        response.addCookie(cookie);
    }
} 
```

# php - 使用 php odbc 从访问中检索数据在参数行中引发错误

> ID：12173927
> 
> 赞同：0
> 
> 时间：2012-08-29T08:41:07.353
> 
> 标签：php

我正在尝试使用 odbc 连接和 php 从访问数据库中的表中提取数据。我已经编写了下面的代码，但它给出了错误**“未捕获的异常 'com_exception' 和消息 '**来源：** Microsoft OLE DB Provider for ODBC Drivers
**描述：** [Microsoft] [ODBC Microsoft Access Driver] 查询表达式中的语法错误（缺少运算符）'table1 .col_date"**

```
<?php $cn = new com("ADODB.Connection");
 $rs = new com("ADODB.Recordset");

$cn->open("dsn=odbcconnection");
?>
<form action = "thispage.php" method = "post">
Enter Date : <input type = "text" name = "datadate" />
<input type = "submit" name = "submit" value = "submit" /> 
</form>
<?php
$datadate = isset($_REQUEST['datadate']) ? $_REQUEST['datadate'] : null; ?>

<?php $sql = "select col_date, sum(qty1), sum(qty2) from table1
              where  table1.col_date = '".$datadate."'
              group by col_date
              order by col_date";

// Execute query
$rs = $cn->execute($sql); 
```

我认为只有参数行 table1.col_date = $datadate 存在问题，因为当我将 $datadate 替换为像 table1.col_date = #05/08/2012# 这样的静态日期时，它会正确显示日期的输出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:49:32.437

问题是您正在使用发布到当前页面的查询字符串参数是空的，或者您对 POST 感到困惑。尝试以下

如果您要发布到页面本身，请执行以下操作

```
<form action = "<?php echo $PHP_SELF; ?>" method = "post"> 
```

然后将其更改为以下内容：

```
$datadate = isset($_POST['datadate']) ? $_POST['datadate'] : null; ?> 
```

最后如前所述进行更改

完全替换或删除括号`[table1.col_date]`并`[table1].[col_date]`尝试以下操作

```
<?php $sql = "select col_date, qty1, qty2 from table1 where  [table].[col_date]= '".$datadate."' group by col_date order by col_date"; 
```

# variables - Maven 系统变量

> ID：12173931
> 
> 赞同：0
> 
> 时间：2012-08-29T08:41:21.383
> 
> 标签：variables, maven, command-line, command, system

当我想让 Maven 从命令行运行时，我做了以下事情：

安装目录：

```
C:\Software\maven221 
```

系统变量（不是用户变量）：

```
M2_HOME: C:\Software\maven221

M2: %M2_HOME%\bin
Path: ......;%M2% 
```

JDK 的位置也在 Path 变量中。

当我执行：`java -version`从 cmd 时，它会给我正确的响应。

当我执行时：`mvn --version`它说它找不到 mvn 作为命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:48:48.973

我不是 Maven 专家，但在我的配置中，我有`M2`用户`M2_HOME`变量，而不是系统变量。

这是我在用户变量中的内容：

```
M2 : %M2_HOME%\bin

M2_HOME : C:\Program Files\Apache Software Foundation\apache-maven-3.0.4

JAVA_HOME : C:\Program Files\Java\jdk1.6.0_31

PATH : %JAVA_HOME%\bin;%M2% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T09:17:22.157

我认为`M2`环境变量对 Maven 没有任何用处。

只需创建此环境变量：

```
set M2_HOME = C:\Software\maven221 
```

并像这样添加到PATH：

```
set PATH = %M2_HOME%\bin;%PATH% 
```

# asp.net-mvc - 3.5 或 2.0 应用程序上的 ASP.NET Web API HttpClient？

> ID：12173932
> 
> 赞同：1
> 
> 时间：2012-08-29T08:41:22.210
> 
> 标签：asp.net-mvc, httpclient, asp.net-web-api

我喜欢 ASP.NET Web API 中的 HttpClient。我可以在 3.5 或 2.0 中使用它吗？我的意思是在 4.0 之前的任何 .NET Framework 应用程序版本中。实际上，我在 ASP.NET 4.0 中有一个 ASP.NET Web API 应用程序。我需要从内置 3.5 框架的设备中使用此应用程序。我知道我可以使用 WebClient/WebRequest，但是如果我可以使用 HttpClient 东西那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T10:50:42.620

据此，[_](https://stackoverflow.com/q/9643714/985284)

> WebAPI 需要 .net 4。您不能在 .net 3.5（sp1 或非 sp1）上使用它。
> 
> 您也不能将预览版本用于生产代码，因为您没有“上线”许可证，因此即使您可以让它工作，它也不合法。您至少需要使用 ASP.NET WebAPI Beta 才能获得上线许可证。

而[据此](https://stackoverflow.com/q/8257652/985284)，

> HttpClient 库最初是在“ [WCF REST Starter Kit](http://www.asp.net/downloads/starter-kits/wcf-rest) ”项目中引入的，因此您可以从那里下载它。这个项目不再受支持（它的大部分功能要么已进入框架，要么现在是 Web API 项目的一部分），但那里的 HttpClient 运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T10:53:25.517

理想情况下，您的 HttpClient 项目应该与您的服务项目完全分开。我会将服务项目保持在 2.0 或 3.5 中，并使用 HttpClient 创建一个 4.0 项目并进行 HTTP 调用。

这里唯一的小问题是隐式模型绑定。在这里，您可以使用模型 dll 或使用 4.0 客户端项目中的 3.5 模型类。但是 JsonObject 绑定也应该无缝地用于 json 共振。

# php - Fuelphp在同一页面逻辑上获取评论

> ID：12173938
> 
> 赞同：1
> 
> 时间：2012-08-29T08:41:35.437
> 
> 标签：php, join, fuelphp

首先，我对fuelphp 真的很陌生，如果需要，您可以否决这个问题。我的问题是我做了一个类似 facebook 的墙，我不太了解评论的逻辑。

所以我试着以这种方式加入我的桌子

```
static function get_stream()
    {
        $query = DB::select()->from('stream_post');
        $query->join('users_metadata');
        $query->on('stream_post.user_id', '=', 'users_metadata.user_id');
        $query->join('stream_comment');
        $query->on('stream_post.stream_id', '=', 'stream_comment.stream_id');
        $query->order_by('stream_post.stream_id', 'DESC');
        $result = $query->execute();
        if(count($result) > 0) {    
            foreach($result as $row)
            {
                $data[] = $row;
            }

            return $data;
        }

    } 
```

这样做的问题是，这仅显示流发布有评论的内容，而不显示其他内容。

那么请有人给我一个逻辑，如何加入表格以将这些帖子显示给没有评论的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:50:57.797

试试看：

```
static function get_stream()
    {
        $query = DB::select()->from('stream_post');
        $query->join('users_metadata');
        $query->on('stream_post.user_id', '=', 'users_metadata.user_id');
        $query->join('stream_comment', 'RIGHT'); // The RIGHT JOIN keyword returns all rows from the right table, even if there are no matches in the left table.
        $query->on('stream_post.user_id', '=', 'stream_comment.user_id');
        $query->order_by('stream_post.stream_id', 'DESC');
        $result = $query->execute();
        if(count($result) > 0) {    
            foreach($result as $row)
            {
                $data[] = $row;
            }

            return $data;
        }
} 
```

**编辑：** 该查询应该可以工作（当每个`user_id`from`stream_post`都具有相同`user_id`的`users_metadata`. 只需将此查询转移到fuelphp （我之前没有使用它）。

```
SELECT *
FROM stream_post
RIGHT JOIN stream_comment
ON stream_post.stream_id = stream_comment.stream_id
JOIN users_metadata
ON stream_post.user_id = users_metadata.user_id
ORDER BY stream_post.stream_id DESC 
```

# wordpress - 如何将“example.com”重定向到“localhost/example.com”

> ID：12173939
> 
> 赞同：0
> 
> 时间：2012-08-29T08:41:38.107
> 
> 标签：wordpress, redirect, url-rewriting, localhost, mamp

我正在使用 MAMP 在本地开发一个 Wordpress 站点。我已经成功地将域“example.com”映射到我的主机文件中的本地主机（127.0.0.1），如下所示：

```
127.0.0.1    example.com 
```

因此，“example.com”重定向到我的文档根目录：

```
example.com --> /Applications/MAMP/htdocs 
```

如果我在单个站点上工作，这很好；我所有的项目文件都放在“htdocs”中。问题是我同时在多个站点上工作，因此我需要更具体的重定向，如下所示：

```
example1.com --> /Applications/MAMP/htdocs/example1.com
example2.com --> /Applications/MAMP/htdocs/example2.com
example3.com --> /Applications/MAMP/htdocs/example3.com 
```

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:47:01.680

可以进行细微的更改：
您可以在根路径下为每个域创建目录：

```
/Applications/MAMP/htdocs/example1
/Applications/MAMP/htdocs/example2
/Applications/MAMP/htdocs/example3 
```

然后，您可以在`.htaccess`文件中为 301 重定向添加规则：

```
RewriteCond %{HTTP_HOST} ^(www.)?example1.com$
RewriteRule ^(/)?$ example1 [L]
RewriteCond %{HTTP_HOST} ^(www.)?example2.com$
RewriteRule ^(/)?$ example2 [L]
RewriteCond %{HTTP_HOST} ^(www.)?example3.com$
RewriteRule ^(/)?$ example3 [L] 
```

如果所有 3 个域都指向同一个服务器 - 它会起作用（我过去用两个域做过）。

# css - 多少 CSS 是多少 CSS？

> ID：12173944
> 
> 赞同：10
> 
> 时间：2012-08-29T08:42:17.917
> 
> 标签：css

我目前正在开发一个专业网站，我已经达到了大约 750 行 CSS 大约 4 页，大部分进入主页。我在不同的行中有花括号。我可能会通过再次检查来减少它。

但我只是想知道，你会认为什么是太多的 css？

问候，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T08:45:33.813

我认为根本没有限制。只需编写您需要的代码，并在完成后尝试对其[进行优化](http://coding.smashingmagazine.com/2008/08/18/7-principles-of-clean-and-optimized-css-code/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-29T14:24:58.860

对此有一个问题（与OP没有直接关系，但对于可能来这里的其他人）......

IE9 及更低版本仅识别 CSS 文件中的前 4096 个选择器。之后的一切都只是默默地忽略。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-29T08:47:57.400

你的 CSS 文件有多大？当然，您必须担心浏览器在解释 CSS 时必须在负载方面工作。它是否有效，您是否过度工作？

保持你的尺寸尽可能小是给定的，但有很多因素需要考虑。完成后，您总是可以缩小、gzip 压缩以节省一些时间。看看一个测试工具[http://tools.pingdom.com/](http://tools.pingdom.com/)

有很多关于这方面的文章，所以我不会费心发表我的个人意见，所以看看这些

1.  [http://css-tricks.com/efficiently-rendering-css/](http://css-tricks.com/efficiently-rendering-css/)

2.  [https://developer.mozilla.org/en-US/docs/CSS/Writing_Efficient_CSS?redirectlocale=en-US&redirectslug=Writing_Efficient_CSS](https://developer.mozilla.org/en-US/docs/CSS/Writing_Efficient_CSS?redirectlocale=en-US&redirectslug=Writing_Efficient_CSS)

3.  [http://speckyboy.com/2011/03/08/website-speed-part-1-write-more-efficient-css/](http://speckyboy.com/2011/03/08/website-speed-part-1-write-more-efficient-css/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-29T08:52:01.977

假设您的主页没有数十个具有不同角色/外观的嵌套组件，您的 CSS 可能有点不聪明。这里有两件事需要担心：

*   **带宽：**如果您的 CSS 文件大小超过 50KB 左右，您的一些连接速度/带宽较低的客户端可能会遇到一些明显的延迟。

*   **渲染：**您的 CSS 文件可能足够复杂，以迫使客户端的[布局/渲染引擎](https://en.wikipedia.org/wiki/Web_browser_engine)在渲染时做出一些额外的努力。

这两个问题都会降低您网站的时间效率。该怎么办？

关于如何优化 CSS 文件的最简单示例是收集用于一个类中的多个元素的规则。还有**许多**其他技巧可以帮助减小 CSS 文件的大小；其他答案已经将您链接到一些带有有用提示的文章，但是如果您想尝试自动化该过程的程序，请查看[CSS Tidy](http://csstidy.sourceforge.net/)（以及[基于 CSS Tidy 的在线工具](http://www.codebeautifier.com/)）。

我希望这有帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-29T08:51:38.273

这取决于您的网站应该做什么。如果它是一个小型博客，并且您需要 3000 行 CSS，那可能太多了。如果它是一个有多个部分和复杂布局的在线商店，那可能还不够。这取决于您的需求。

# jquery - 在提交到mysql之前验证多个文本区域

> ID：12173945
> 
> 赞同：0
> 
> 时间：2012-08-29T08:42:22.987
> 
> 标签：jquery, validation

我需要检查多个文本区域是否为空，然后才能在 mysql 数据库中写入任何数据。表单是动态生成的，我不知道文本区域的 ID/名称。

具有多个动态生成的文本区域、id 和动态生成的名称的表单：

```
<form action=\"$self\" method=\"POST\" id=\"daily_frm\"  enctype=\"multipart/form-data\">   
 <table border=\"1\" cellspacing=\"2\" cellpadding=\"2\" id=\"tb_daily\" class=\"tb_daily\" width=\"100%\">
  <tr>
  <th scope=\"col\" id=\"col_stn\">Station</th>
  <th scope=\"col\" id=\"col_comm\">Comment</th>
  <th scope=\"col\" id=\"qcif\">QCIF</th>
  <th scope=\"col\" id=\"attach\">Attachment</th>
 </tr>"; 

while ($stn_b = mysql_fetch_array($station_b)){
  print "<tr>
           <td>$stn_b[station]</td>
           <td><textarea id=\"$stn_b[station]_comment\" cols=\"60\" rows=\"5\" value=\"\"></textarea></td>
           <td><input type=\"checkbox\" id=\"$stn_b[station]_qcif\" value=\"1\"/></td>
          <td><input id=\"$stn_b[station]_attach\" type=\"file\" />
        </tr>       
        ";
}

print"
<tr><td colspan=\"4\"><input type=\"submit\" value=\"Submit\" name=\"submit_daily\" id=\"submit_daily\"><input type=\"reset\" name=\"clear_daily\" value=\"Clear\"></td></tr>
</table>
</form> 
```

单击提交按钮时，我检查文本区域是否为空的方法：

```
<script type='application/javascript'>

$(document).ready(function(){

    $('#daily_frm').submit( function () {
     $('#daily_frm textarea').each(function(){
     if ($(this).val()==='') {

    alert($(this).attr('id') + ' field is empty');
    $(this).focus();
    return false;

   }
 });
    });
}); 
```

我得到带有相应文本区域名称的警报框。

我的 php 代码将所有内容写入数据库：

```
if (isset($_POST['submit_daily'])){

while ($stn_b = mysql_fetch_array($station_b)){
    $s = $stn_b['station'];
    $sid = $stn_b['idtb_station'];

    $daily_comment = addslashes($_POST[$s."_comment"]);

    if(!empty($_POST[$s."_qcif"])) {
        $qcif = $_POST[$s."_qcif"];
        echo "$qcif<br />"; 
    }   else {
        $qcif = "0";
    }

    $post_daily_sql = "INSERT INTO tb_daily tb_station_idtb_station,date,author,comment,upload) VALUES ('$sid','$today','$user','$daily_comment','$qcif')"; 
}   
} 
```

我现在的问题是，如果文本区域为空，我会收到警报框，但我的脚本仍然继续尝试写入数据库（我知道 php/mysql 部分不完整）。有什么提示吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:09:27.837

尝试类似：

```
$(document).ready(function(){
    $('#daily_frm').submit( function (evt) {
        evt.preventDefault();
        var errCount = 0;
        $('#daily_frm textarea').each(function(){
            if ($(this).val()==='') {
                alert($(this).attr('id') + ' field is empty');
                $(this).focus();
                errCount++;
            }
        });
        if( errCount > 0 ) {
            reutrn false;
        }
        else {
            return true;
        }
    });
}); 
```

# asp.net - 在两个物理文件的一个部分类中定义相同的方法。哪些将被优先考虑，为什么？

> ID：12173946
> 
> 赞同：0
> 
> 时间：2012-08-29T08:42:23.847
> 
> 标签：asp.net, oop, partial

我通过代码（由其他人编写）。在这里，他所做的是。

这是一个网站。我在理解部分类在以下情况下如何工作时遇到问题：

有两个页面： 1\. A.aspx（它有 CodeFile A.aspx.cs，它继承了 B 类） 2\. B.aspx（它有 CodeFile B.aspx.cs，它也继承了 B 类）

下面是这两个文件的代码结构：

文件 A.aspx.cs 的代码

```
public partial class B
{
    protected void Page_PreRender(object sender, EventArgs e)
     {
        //Some Code Here
     }
} 
```

文件 B.aspx.cs 的代码

```
public partial class B
{
    protected void Page_PreRender(object sender, EventArgs e)
     {
        //Some Code Here (but this code is different than that defined in A.aspx.cs)
     }
} 
```

在上述情况下，当我们加载页面 A.aspx 时，哪些代码会被优先考虑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:47:01.820

当您尝试编译此代码时会出现编译时错误，因为您不能定义两次相同的方法

在您的情况下，它会引发一个错误，指出您已经定义了一个同名的方法。

# c# - 将大型二维数组写入 Excel

> ID：12173948
> 
> 赞同：5
> 
> 时间：2012-08-29T08:42:30.370
> 
> 标签：c#, excel

我正在寻找使用 C# 将大型二维数组写入 Excel 工作表。如果数组是 500 x 500，我将用来编写它的代码如下：

```
 var startCell = Worksheet.Cells[1, 1];
 var endCell = Worksheet.Cells[500, 500];
 var writeRange = (Excel.Range)Worksheet.Cells[startCell, endCell;
 writeRange.Value = myArray; 
```

我在这条线上遇到了一个例外：

```
var endCell = Worksheet.Cells[500, 500]; 
```

任何通过 COM 使用过 C# 和 Excel 的人都可以证明，收到的错误消息几乎没有用。我认为问题在于，当我第一次创建工作表时，用于工作表的基础数据结构的大小不足以索引单元格 500,500。

有谁知道如何达到预期的结果？我希望有一种简单的方法可以在创建 Range 之前重新调整底层数据结构的大小。

谢谢。

编辑：错误消息是：

```
{"Exception from HRESULT: 0x800A03EC"} 
```

使用和excel错误代码-2146827284。

更新：下面评论中提供的链接暗示了在兼容模式下打开 Excel 工作表的问题。这似乎是问题所在。如果我在运行代码之前将文档保存为 .xlsx 或 .xlsm 格式，这似乎可行。我的问题是我不能期望我的用户每次都这样做。有没有一种程序化的方式来实现这一点？是否只是打开文件，检查扩展名，然后在需要时将其保存为新格式的情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T10:27:10.180

找到了解决方案。

不要使用 Worksheet.Cells[x, x]，而是使用 Worksheet.get_range(x, x)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T09:19:26.423

我刚刚写了一个对我有用的小例子。最初在[**SO 这个答案**](https://stackoverflow.com/questions/536636/write-array-to-excel-range)中找到。我不得不调整这个答案，因为在我的互操作程序集（*Excel 14 对象库*）中**没有更多的方法** `Worksheet.get_Range(.., ..)`

```
var startCell = ws.Cells[1, 1];
int row = 500, col = 500;
var endCell = ws.Cells[row, col];
try
{
    // access range by Property and cells indicating start and end           
    var writeRange = ws.Range[startCell, endCell];
    writeRange.Value = myArray;
}
catch (COMException ex)
{
    Debug.WriteLine(ex.Message);
    Debugger.Break();
} 
```

# javascript - 如何优化 AJAX 驱动的应用程序中的元素绑定？

> ID：12173952
> 
> 赞同：0
> 
> 时间：2012-08-29T08:42:39.540
> 
> 标签：javascript, jquery, ajax, events, binding

我有一个主要在 Ajax 上运行的应用程序。每当我更新内容时，我都会运行一个特定`binder`于为可能已被替换的元素启动/重新启动功能的页面。

目前我正在这样做：

```
 // pagebinder
 var bindResults = function( page ){
    // element
    var swipesOnPage = page.find('.photoswipeable');

    if ( swipesOnPage.length > 0 && swipesOnPage.jqmData('bound') != true) {
        swipesOnPage
            .jqmData('bound', true )
            .on('click', '.singleLoader', function(e){
                // do somethinbg
            })
            .on('click', '.selector', function(e){
                // do something else
            });
       }
    } 
```

所以我正在检查页面上是否有一个元素（可能已被删除/添加），如果找到一个元素但不是`jqmData(bound)`，我正在设置绑定。

这工作正常。但我想知道这是否是最好的方法，所以

**问题：**
在使用 Ajax 驱动的应用程序时，如何最好地管理多个元素的元素绑定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T09:13:25.103

看到你已经准备好使用*selector-parameter* for 了[`on`](http://api.jquery.com/on/)，为什么不把整个事情提升到`body`then 的水平。这样你就不必重新绑定任何东西。

这可能会导致更多的 dom 遍历，但如果结构不是嵌套太深，那应该不是什么大问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:45:05.107

您可以使用 jQuery 的[`.delegate()`](http://api.jquery.com/delegate/)，尽管对于大型应用程序来说它可能会变得过于混乱。

# java - NioSocketChannel$WriteRequestQueue 导致 OutOfMemory

> ID：12173963
> 
> 赞同：4
> 
> 时间：2012-08-29T08:43:13.330
> 
> 标签：java, netty

我正在使用**Netty**执行大**文件上传**。它工作正常，但客户端使用的 RAM 似乎随着文件的大小而增加。这不是预期的行为，因为一切都是从读取源文件到写入目标文件的管道。

起初，我想到了一种自适应缓冲区，直到达到 Xmx，但将 Xmx 设置为合理的值（50M）会在开始上传后很快**导致 OutOfMemoryError 。**在使用 Eclipse Memory Analyzer 进行一些研究后，似乎保留堆内存的对象是：

```
org.jboss.netty.channel.socket.nio.NioSocketChannel$WriteRequestQueue 
```

是否有任何选项可以设置此队列的限制，或者我是否必须使用 ChannelFutures 编写自己的队列来控制字节数并在达到限制时阻塞管道？

谢谢你的帮助，

问候，

雷诺

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T13:11:59.957

Netty Github 上@normanmaurer 的回答

你应该使用

```
Channel.isWritable() 
```

检查“队列”是否已满。如果是这样，您将需要检查是否有足够的空间来写更多。因此，如果您将数据快速写入以将其发送给客户端，则可能会发生您看到的效果。尝试通过 DefaultFileRegion 或 ChunkedFile 写入文件时，您可以解决此类问题。

* * *

@normanmaurer 谢谢我错过了频道的这种方法！我想我需要阅读里面发生的事情：

```
org.jboss.netty.handler.stream.ChunkedWriteHandler 
```

* * *

更新：2012/08/30 这是我为解决我的问题而编写的代码：

```
public class LimitedChannelSpeaker{
    Channel channel;
    final Object lock = new Object();
    long maxMemorySizeB;
    long size = 0;
    Map<ChannelBufferRef, Integer> buffer2readablebytes = new HashMap<ChannelBufferRef, Integer>();

    public LimitedChannelSpeaker(Channel channel, long maxMemorySizeB) {
        this.channel= channel;
        this.maxMemorySizeB = maxMemorySizeB;
    }

    public ChannelFuture speak(ChannelBuffer buff) {
        if (buff.readableBytes() > maxMemorySizeB) {
            throw new IndexOutOfBoundsException("The buffer is larger than the maximum allowed size of " + maxMemorySizeB + "B.");
        }
        synchronized (lock) {
            while (size + buff.readableBytes() > maxMemorySizeB) {
                try {
                    lock.wait();
                } catch (InterruptedException ex) {
                    throw new RuntimeException(ex);
                }
            }
            ChannelBufferRef ref = new ChannelBufferRef(buff);
            ref.register();
            ChannelFuture future = channel.write(buff);
            future.addListener(new ChannelBufferRef(buff));
            return future;
        }
    }

    private void spoken(ChannelBufferRef ref) {
        synchronized (lock) {
            ref.unregister();
            lock.notifyAll();
        }
    }

    private class ChannelBufferRef implements ChannelFutureListener {

        int readableBytes;

        public ChannelBufferRef(ChannelBuffer buff) {
            readableBytes = buff.readableBytes();
        }

        public void unregister() {
            buffer2readablebytes.remove(this);
            size -= readableBytes;
        }

        public void register() {
            buffer2readablebytes.put(this, readableBytes);
            size += readableBytes;
        }

        @Override
        public void operationComplete(ChannelFuture future) throws Exception {
            spoken(this);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T09:08:07.950

> 对于桌面后台应用程序

Netty 专为高度可扩展的服务器而设计，例如大约 10,000 个连接。对于少于几百个连接的桌面应用程序，我会使用普通 IO。您可能会发现代码要简单得多，并且应该使用不到 1 MB。

# ios - 如何使键盘与滚动视图一起移动？

> ID：12173965
> 
> 赞同：0
> 
> 时间：2012-08-29T08:43:17.213
> 
> 标签：ios, scroll, searchbar

我在控制器中有一个滚动视图和一个搜索栏。当滚动视图被拖动时，我希望键盘与滚动视图一起移动。就像在 iphone 上编辑消息一样。

那么我该怎么做，如果你能给我一些代码，我将不胜感激。

我的意思是当搜索栏是第一响应者时，会有一个键盘哈？

如果我滚动滚动视图，键盘将随之移动。

有人说我应该听一些通知。这样对吗？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:41:17.590

您不能将键盘与视图一起移动。您只能更改其下方视图的位置。因此，如果您希望将键盘与滚动一起移动....您需要做的就是制作自己的自定义键盘！！！！！！

# python - 在 Windows Server 2003 上使用 python 密钥环时出现错误 1312

> ID：12173969
> 
> 赞同：6
> 
> 时间：2012-08-29T08:43:34.670
> 
> 标签：python, windows-services, python-keyring

我正在用 python 编写一个 Windows 服务，并且我正在使用密钥环模块来安全地存储我需要定期和持久使用的凭据。这意味着密钥环使用本地系统用户凭据存储密码。

我所做的只是使用 2 个基本的密钥环功能：`get_password(SERVICE_NAME, username, password)`和 `set_password(SERVICE_NAME, username)`. 我没有按照我的理解预先配置密钥环，并且看到它会自动配置其后端。

当我在 Windows Server 2008 及更高版本上运行它时，一切正常。但是当我在 Windows Server 2003 上运行它时，我得到了这个讨厌的错误：

`error: (1312, 'CredWrite', 'A specified logon session does not exist. It may already have been terminated.')`

我认为它与用于运行我的服务的本地系统用户的登录会话有关，尽管它很奇怪，因为我知道它是一种超级管理员超级用户的形式，应该有权做任何事情它想在系统中。但是当我将用户的登录凭据更改为本地管理员时，一切正常。

我需要更改我的服务配置以使其正常工作吗？或者更改本地系统用户的安全策略？还是我应该要求用户使用本地管理员凭据运行此服务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T11:48:22.457

Windows Server 2003 中的本地系统用户似乎有一个限制，即它无法访问 Windows 保存凭据的机制，也称为 Credentials Vault。

Windows 的密钥环默认后端是使用这个内置的 Windows Vault 机制，这就是创建它的原因，这就是从 Windows 触发这个异常的原因。

这个问题的解决方案是使用不同的密钥环后端，称为`Win32CryptoKeyring`likes：

```
keyring.set_keyring(keyring.backend.Win32CryptoKeyring()) 
```

此后端使用 Win32 Cryptographic API 安全地保存凭据，因此在安全方面它与使用 Windows Vault 机制一样安全。不同之处仅在于凭据保存到的位置。我不确定凭据保存在哪里，但事实证明这与我的情况无关。

再次需要注意的是，此错误仅在 Windows Server 2003 下的本地系统用户使用 Windows Vault 时才会发生。在较新的 Windows 版本上，这可以正常工作，并且与 Windows Server 2003 上的其他用户一起使用也可以正常工作.

`Win32CryptoKeyring`如果您想在不使用多个安全机制在代码中保存凭据的情况下跨平台使用，则在较新版本的 Windows 上使用后端也可以很好地工作。

# python - mod_wsgi 中的 Hello World

> ID：12173971
> 
> 赞同：16
> 
> 时间：2012-08-29T08:43:41.517
> 
> 标签：python, apache, mod-wsgi, wsgi

在我试图让我的烧瓶应用程序在 Apache 上运行时反复失败后，`mod_wsgi`我决定尝试运行[hello world 示例](http://code.google.com/p/modwsgi/wiki/QuickConfigurationGuide)。这是我所拥有的 -

目录结构（我将 apache 默认更改`/var/www`为`~/public_html`）

```
- public_html    
   - wsgi-scripts
      - test_wsgi.wsgi
   - test_wsgi
      - test_wsgi.wsgi 
```

test_wsgi.wsgi 文件

```
def application(environ, start_response):
    status = '200 OK'
    output = 'Hello World!'

    response_headers = [('Content-type', 'text/plain'),
                        ('Content-Length', str(len(output)))]

    start_response(status, response_headers)

    return [output] 
```

VirtualHost 配置文件（称为 testwsgi）——位于`/etc/apache2/sites-enabled/`

```
<VirtualHost *:80>
    DocumentRoot ~/public_html/test_wsgi

    <Directory ~/public_html/test_wsgi>
        Order allow,deny
        Allow from all
    </Directory>

    WSGIScriptAlias /wsgi ~/public_html/wsgi-scripts/test_wsgi.wsgi

    <Directory ~/public_html/wsgi-scripts>
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost> 
```

当我尝试`localhost/wsgi`在浏览器上访问时，我收到 404 Not Found 错误。我究竟做错了什么？这是我第一次尝试在生产服务器上部署应用程序。到目前为止，我采用了使用 Google App Engine 的简单方法。在启动并运行之前，我无法继续部署我的烧瓶应用程序。非常感谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-29T10:51:13.547

您需要使用绝对路径，即不要使用`~`. 这对我来说很好......

```
[mpenning@tsunami public_html]$ sudo cat /etc/apache2/sites-available/wsgi_test
<VirtualHost *:80>
    ServerName wsgihost
    DocumentRoot /home/mpenning/public_html
    WSGIScriptAlias / /home/mpenning/public_html/test.wsgi
</VirtualHost>
[mpenning@tsunami public_html]$ 
```

首先我在 中设置了一个主机名`/etc/hosts`，所以我可以确保我可以在查询中对主机名进行复用...

```
[mpenning@tsunami public_html]$ grep wsgihost /etc/hosts
127.0.1.1       tsunami.foo.net  tsunami wsgihost
[mpenning@tsunami public_html]$ 
```

重启apache，然后发出wget ...

```
[mpenning@tsunami public_html]$ wget http://wsgihost/
--2012-08-29 05:50:26--  http://wsgihost/
Resolving wsgihost... 127.0.1.1
Connecting to wsgihost|127.0.1.1|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 12 [text/plain]
Saving to: âindex.html.3â

100%[======================================>] 12          --.-K/s   in 0s

2012-08-29 05:50:26 (1.48 MB/s) - âindex.html.3â

[mpenning@tsunami public_html]$ cat index.html
Hello World![mpenning@tsunami public_html]$ #  <------ 
```

# php - 强制作曲家下载 git repo 而不是 zip

> ID：12173973
> 
> 赞同：9
> 
> 时间：2012-08-29T08:43:49.833
> 
> 标签：php, github, composer-php

我对作曲家有一些问题。

```
 "require": {
        "php":                ">=5.3.2",
        "kriswallsmith/buzz": "0.7"
    }, 
```

回购[https://github.com/kriswallsmith/Buzz/tree/v0.7](https://github.com/kriswallsmith/Buzz/tree/v0.7)

不幸的是，github为此请求返回502 [https://github.com/kriswallsmith/Buzz/zipball/v0.7](https://github.com/kriswallsmith/Buzz/zipball/v0.7)

请求网址：https://nodeload.github.com/kriswallsmith/Buzz/zipball/v0.7
状态码：502 Bad Gateway

幸运的是 git clone 仍然有效；）

是否可以告诉/询问作曲家用户 git clone 而不是为这个依赖项下载 zipball？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-29T13:14:16.620

最快的解决方案是运行`install`或`update`使用选项`--prefer-source`

```
php composer.phar install --prefer-source 
```

这样 git clone 将用于**所有**依赖项，我不知道是否有限制为仅一个依赖项的设置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-05-16T08:35:43.167

如[首选安装](https://getcomposer.org/doc/06-config.md#preferred-install)顺序中所述。我已经测试过`Composer version 1.8.3 2019-01-30 08:31:33`

```
"config": {
    "preferred-install": {
        "drupal/external_entities": "source",
        "*": "dist"
    }
} 
```

接下来跑

```
composer require drupal/external_entities 
```

并且出现了 git repo。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-16T13:18:22.127

除了首选源之外，还有另一种方法，您可以使用“VCS”类型设置存储库，这意味着该包将在您的 VCS 中搜索，例如 GIT 而不是 packagist

你的**composer.json**

```
{
    "repositories": [
        {
            "type": "vcs",
            "url": "https://github.com/kriswallsmith/Buzz"
        }
    ],
    "require": {
        "kriswallsmith/buzz": "dev-0.17.x"
    }
} 
```

[更多信息在这里](https://getcomposer.org/doc/05-repositories.md#vcs)

# javascript - Using jquery.append() method

> ID：12173982
> 
> 赞同：0
> 
> 时间：2012-08-29T08:44:23.157
> 
> 标签：javascript, jquery, append

What's wrong in my code that the append method dont work? I do get the alert but the actual method that will append is not working. Please see the code below:

```
jQuery(document).ready(function()
{
    if (!document.getElementById('my_options').value)
    {
        alert('here');
        jQuery('#my_options').append('<span id="option_id_error" class="errors">Error</span>');
    }

}); 
```

HTML:

```
<select id="my_options" name="my_options">
       <option value="">--Select--</option>
       <option value="1">Option 1</option>
       <option value="2">Option 2</option>
       <option value="3">Option 3</option>
       <option value="4">Option 4</option>
</select>
<br/>
<select id="my_options2" name="my_options2">
       <option value="">--Select--</option>
       <option value="1">Option 1</option>
       <option value="2">Option 2</option>
       <option value="3">Option 3</option>
       <option value="4">Option 4</option>
</select>
<br/>
<select id="my_options3" name="my_options3">
       <option value="">--Select--</option>
       <option value="1">Option 1</option>
       <option value="2">Option 2</option>
       <option value="3">Option 3</option>
       <option value="4">Option 4</option>
</select> 
```

The select in the form is dynamically generated. If none is selected on the dropdown box, it will display the span error message. So my expected result is this:

```
<select id="my_options" name="my_options">
       <option value="">--Select--</option>
       <option value="1">Option 1</option>
       <option value="2">Option 2</option>
       <option value="3">Option 3</option>
       <option value="4">Option 4</option>
</select> <span>Error</span> 
```

I don't need to add something on the options.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:46:29.990

What you are doing is not correct as a SPAN item is not valid within an SELECT item.

If you try to add a new option for example it will work

```
$('#my_options').append('<option value="5">item</option>'); 
```

what you can do is to wrap the select item inside a DIV as showed below

```
<div id="option1">
    <select id="my_options" name="my_options">
           <option value="">--Select--</option>
           <option value="1">Option 1</option>
           <option value="2">Option 2</option>
           <option value="3">Option 3</option>
           <option value="4">Option 4</option>
    </select>
</div> 
```

than you can do:

```
$('#option1').append('<span id="option_id_error" class="errors">Error</span>'); 
```

you can see it working at the below link

[http://jsfiddle.net/LGkWp/](http://jsfiddle.net/LGkWp/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T10:32:32.107

if you need to add this `<span>` element just next to `<select>` you may use .after(..) method:

```
jQuery('#my_options').after('<span id="option_id_error" class="errors">Error</span>'); 
```

# php - 让系统根据php中的日期计算要添加到计数器的数量

> ID：12173989
> 
> 赞同：0
> 
> 时间：2012-08-29T08:44:42.347
> 
> 标签：php

这是一个 cronjob 脚本。cronjob 每分钟都在运行。

cronjob 是更新数据库中的实时计数器字段。

我有两次和一个计数限制器：

```
start: 2012-08-29 09:55:00
end: 2012-08-29 19:00:00
limit: 5000 
```

如何从给定的开始日期、结束日期和限制中计算出一个数字以添加到此执行的计数器中？

所以当结束日期结束时，计数器应该与输入的限制一样大

例如，现在我得到了这个：

```
if ( $setting['limit'] > $setting['counter'] )
{
        $rand = rand(5, 300);

        DB::update('settings')
        ->set(array('counter' => DB::expr('counter+ '.$rand)))
        ->where('id', '=', $setting['id'])
            ->execute();
} 
```

这只是给了我一个介于 5 到 300 之间的数字，并在每次刷新/执行脚本时添加到计数器中。

有了这个，计数器没有达到限制的可能性很大，例如，如果开始日期和结束日期彼此接近并且随机值低于 100，那么它就不可能达到限制 5000。

那么如何让系统根据开始和结束日期、限制和当前计数计算出正确的比率数以添加到计数器中呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:56:17.410

```
Counter Limit * (Current time in minutes - Start time in minutes)/(End time in minutes - Start time in minutes) = Current counter number 
```

基本比率，虽然这更像是一个数学问题而不是编程问题......

此外，如果您不使用支持小数的 MySQL 类型，您可能需要对结果进行四舍五入。

所以在你的 cronjob 中：

```
$start=strtotime($setting["starttime"]);//Or whatever your local copy of the start time is
$end=strtotime($setting["endtime"]);//Or whatever your local copy of the end time is
$current=time();

$counter = $current>=$end?$setting["limit"]:round($setting['limit'] * ($current-$start)/($end-$start));

DB::update('settings')
    ->set(array('counter' => $counter))
    ->where('id', '=', $setting['id'])
        ->execute(); 
```

# curl - 如何使用 cURL 调试 CORS 请求？

> ID：12173990
> 
> 赞同：395
> 
> 时间：2012-08-29T08:44:43.127
> 
> 标签：curl, cors

如何使用 cURL 调试 CORS 请求？到目前为止，我找不到任何方法来“模拟”预检请求。

* * *

## 回答 #1

> 赞同：622
> 
> 时间：2012-08-29T13:42:42.270

以下是使用 curl 调试 CORS 请求的方法。

**使用 cUrl 发送常规 CORS 请求：**

```
curl -H "Origin: http://example.com" --verbose \
  https://www.googleapis.com/discovery/v1/apis?fields= 
```

该`-H "Origin: http://example.com"`标志是发出请求的第三方域。替换您的域。

该`--verbose`标志打印出整个响应，因此您可以看到请求和响应标头。

我在上面使用的 url 是对支持 CORS 的 Google API 的示例请求，但您可以替换您正在测试的任何 url。

响应应包括`Access-Control-Allow-Origin`标题。

**使用 cUrl 发送预检请求：**

```
curl -H "Origin: http://example.com" \
  -H "Access-Control-Request-Method: POST" \
  -H "Access-Control-Request-Headers: X-Requested-With" \
  -X OPTIONS --verbose \
  https://www.googleapis.com/discovery/v1/apis?fields= 
```

这看起来类似于常规的 CORS 请求，但添加了一些内容：

`-H`标志向服务器发送额外的预检请求标头

该`-X OPTIONS`标志表明这是一个 HTTP OPTIONS 请求。

如果预检请求成功，则响应应包含`Access-Control-Allow-Origin`、`Access-Control-Allow-Methods`和 `Access-Control-Allow-Headers`响应标头。如果预检请求不成功，则不应出现这些标头，否则 HTTP 响应不会为 200。

`User-Agent`您还可以使用`-H`标志指定其他标头，例如。

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2017-12-02T16:22:14.203

## 涵盖大多数情况的更新答案

```
curl -H "Access-Control-Request-Method: GET" -H "Origin: http://localhost" --head http://www.example.com/ 
```

1.  将[http://www.example.com/](http://www.example.com/)替换为您要测试的 URL。
2.  如果响应包括`Access-Control-Allow-*`，则您的资源支持 CORS。

**替代答案的理由**

我时不时地用谷歌搜索这个问题，而接受的答案从来都不是我需要的。首先它打印响应正文，其中包含大量文本。仅添加`--head`输出标题。其次，在测试 S3 URL 时，我们需要提供额外的 header `-H "Access-Control-Request-Method: GET"`。

希望这会节省时间。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-01-09T00:41:06.793

好像这行得通：

`curl -I http://example.com`

**`Access-Control-Allow-Origin: *`**在返回的标头中查找

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-09-20T15:51:42.913

下面的 bash 脚本“corstest”对我有用。它基于[Jun的](https://stackoverflow.com/users/5042169/jun)上述评论。

**用法**

corstest [-v] 网址

**例子**

```
./corstest https://api.coindesk.com/v1/bpi/currentprice.json
https://api.coindesk.com/v1/bpi/currentprice.json Access-Control-Allow-Origin: * 
```

阳性结果显示为绿色

```
./corstest https://github.com/IonicaBizau/jsonrequest
https://github.com/IonicaBizau/jsonrequest does not support CORS
you might want to visit https://enable-cors.org/ to find out how to enable CORS 
```

否定结果显示为红色和蓝色

-v 选项将显示完整的 curl 标头

**最好的**

```
#!/bin/bash
# WF 2018-09-20
# https://stackoverflow.com/a/47609921/1497139

#ansi colors
#http://www.csc.uvic.ca/~sae/seng265/fall04/tips/s265s047-tips/bash-using-colors.html
blue='\033[0;34m'  
red='\033[0;31m'  
green='\033[0;32m' # '\e[1;32m' is too bright for white bg.
endColor='\033[0m'

#
# a colored message 
#   params:
#     1: l_color - the color of the message
#     2: l_msg - the message to display
#
color_msg() {
  local l_color="$1"
  local l_msg="$2"
  echo -e "${l_color}$l_msg${endColor}"
}

#
# show the usage
#
usage() {
  echo "usage: [-v] $0 url"
  echo "  -v |--verbose: show curl result" 
  exit 1 
}

if [ $# -lt 1 ]
then
  usage
fi

# commandline option
while [  "$1" != ""  ]
do
  url=$1
  shift

  # optionally show usage
  case $url in      
    -v|--verbose)
       verbose=true;
       ;;          
  esac
done  

if [ "$verbose" = "true" ]
then
  curl -s -X GET $url -H 'Cache-Control: no-cache' --head 
fi
origin=$(curl -s -X GET $url -H 'Cache-Control: no-cache' --head | grep -i access-control)

if [ $? -eq 0 ]
then
  color_msg $green "$url $origin"
else
  color_msg $red "$url does not support CORS"
  color_msg $blue "you might want to visit https://enable-cors.org/ to find out how to enable CORS"
fi 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2021-07-26T15:12:27.933

预检请求是使用[`OPTIONS`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/OPTIONS#preflighted_requests_in_cors)HTTP 方法完成的。

假设您想在 to 的请求上测试 CORS ，`POST`命令应该是：`http://mysite.example.com``https://myapi.example.com/foo`

```
curl -XOPTIONS \
  -H "Access-Control-Request-Method: POST" \
  -H "Origin: http://mysite.example.com" \
  https://myapi.example.com/foo 
```

响应要么是，要么`OK`是错误消息，例如`Disallowed CORS origin`. `-i`如果您愿意，您仍然可以使用包含标题。

这比其他一些发出`GET`或`HEAD`请求并要求您解释标头的响应要简单得多。

# objective-c - 未调用 Dropbox 委托方法

> ID：12173992
> 
> 赞同：1
> 
> 时间：2012-08-29T08:44:56.107
> 
> 标签：objective-c, ios, delegates, dropbox-api

我对 Dropbox API 有疑问。我正在开发由另一位开发人员启动的大型应用程序。现在我要清理代码。所有的委托方法（loadedMetadata & Co.）都直接在视图中。现在我想将它们提取到自己的类中。所以我创建了一个包含所有方法的 DropboxService 类。所以我有视图并从 DropboxService 调用方法 loadMetadata。该方法被调用并且工作正常。但是从不调用Delegate 方法loadedMetadata。

我做错了什么/我必须改变什么才能让它正常工作？

Dropbox 服务将 DBRESTClientDelegate 作为“超类”（不知道我到底是如何称呼它的）

```
@interface DropboxService : CloudProviderService <DBRestClientDelegate> {
} 
```

编辑：

该服务在 AppDelegate 中实例化，并且在那里是一个变量：

```
- (DropboxService *)getDropboxService {
    if (self.dropboxService == nil) {
        self.dropboxService = [[DropboxService alloc] init];
    }
    return self.dropboxService;
} 
```

来自德国的问候

亚历山大

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:55:30.233

您还需要在初始化后设置委托

```
DBRestClient.delegate = self; 
```

从这个界面

```
@interface DBRestClient : NSObject { ... id<DBRestClientDelegate> delegate; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T09:06:58.617

那个标题没有说这`DropboxService`是一个子类`DBRestClientDelegate`

它说`DropboxService`符合协议 `DBRestClientDelegate`

Dropbox 示例项目解释了所有这些，但您想查找您设置的位置`DBRestClient`并确保`DropboxService`成为该实例的委托。

这就是我的代码中的样子，它符合`DBRestClientDelegate`

```
- (DBRestClient*)restClient {
    if (restClient == nil) {
        restClient = [((DBRestClient *)[DBRestClient alloc]) initWithSession:[DBSession sharedSession]];
        restClient.delegate = self;
    }
    return restClient;
} 
```