# StackOverflow 问答 000920000-000920999

# php - 是否可以使用 php 在 RSS 提要中使用身份验证？

> ID：920003
> 
> 赞同：7
> 
> 时间：2009-05-28T09:35:30.500
> 
> 标签：php, feed, syndication-feed

我正在尝试为 Intranet 文档管理系统开发一个提要，以便员工可以收到新文档的通知。我实际上已经完成了编码，但是没有办法对用户进行身份验证。

此外，我没有成功地将提要添加到新闻阅读器，但可以使用 Firefox Live Bookmark。

有任何想法吗

更新：

由于我无法很好地解释，我将具体说明我希望它在 OutLook RSS 提要中工作。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T09:39:11.850

嗯，这不是很常见，但我前段时间读过一篇关于它的文章

[http://labs.silverorange.com/archive/2003/july/privaterss](http://labs.silverorange.com/archive/2003/july/privaterss)

这可能会帮助你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T09:38:38.483

您可以尝试[HTTP 身份验证](http://ru.php.net/features.http-auth)（基本或摘要）。

至于新闻阅读器，请澄清您在做什么以及出了什么问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T09:44:54.100

提要阅读器必须能够访问提要的 URL，因此如果它仅对您网络上的人可用，Google 阅读器（例如）将无法解析地址并找到提要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T09:45:17.517

有这么多的提要阅读器，并且身份验证技术如此流行，以至于我认为传统的身份验证可能是一个阻塞问题。

这是用于内联网的，对吧？你使用静态IP吗？

也许有一个身份验证页面（他们使用公司凭据登录的地方），从那时起，他们就可以从该 IP 访问他们的 RSS 提要。如果他们移动到另一个 IP，他们只需要重新认证。

您甚至可以通过 RSS 提要发送身份验证消息。

如果 IP 在很多地方移动，那会很痛苦，但这是一种可能的选择。

* * *

如果做不到这一点，则强制执行哪些阅读器可以使用。[NewsGator](http://www.newsgator.com/)支持完全身份验证，因此肯定是最简单的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T09:51:03.543

Outlook 2007 及更高版本[可以订阅经过身份验证的提要作为一种解决方法](http://support.microsoft.com/kb/917125)。这并不理想，但有可能。

在您的 PHP 端，您只需要使用一些基本的 HTTP 身份验证。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T10:59:45.277

为什么不为该特定用户创建一个身份验证令牌，以便令牌/提要 ID 组合对用户进行身份验证？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T12:31:39.477

您还可以使用 Web 服务来做到这一点，例如 REST/SOAP。

# wcf - “添加服务引用”reference.svcmap 和 ServiceReference.ClientConfig 为空

> ID：920005
> 
> 赞同：0
> 
> 时间：2009-05-28T09:36:15.337
> 
> 标签：wcf, silverlight, web-services

我有一个 ASMX 服务，我不想添加到我的 Silverlight 项目中（在不久的将来这将转换为 WCF 服务）。

使用“添加（或更新）服务参考”时，似乎并非所有文件都已创建，Reference.svcmap 下的文件也未创建，并且 ServiceReferences.ClientConfig 为空。

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T11:58:53.987

不确定我对此有一个很好的答案。我经常看到这个。通常可以通过查看在尝试代理生成期间发生的输出窗口整体来跟踪问题。

有时这是因为 Wsdl 无效或不受支持，或者只是其中一种类型的序列化出现了一些愚蠢的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-01T10:15:11.280

在添加服务引用时，尝试为您的客户端 (Silverlight) 应用程序提供 WSDL，而不仅仅是 ASMX。例如[http://myserver.com/services/mywebservice.asmx?wsdl](http://myserver.com/services/mywebservice.asmx?wsdl)

从您的客户端项目中完全删除服务引用，并尝试使用 WSDL 再次添加它。

# c# - 在表单 2 上单击按钮时触发表单 1 中的方法

> ID：920006
> 
> 赞同：3
> 
> 时间：2009-05-28T09:36:24.367
> 
> 标签：c#, winforms, .net-2.0

我对 Windows 窗体很陌生。我想知道是否可以通过单击表单 2 中的按钮来触发表单 1 中的方法？我的表格 1 有一个组合框。我的表格 2 有一个保存按钮。我想要实现的是：当用户点击表单 2 中的保存时，我需要检查表单 1 是否打开。如果它是打开的，我想获取实例并调用将重新填充表单 1 上的组合的方法。

如果我能得到一些关于如何解决这个问题的指示，我将不胜感激。如果有比这更好的方法，请告诉我。

谢谢 ：）

**补充：** 表格1和表格2是相互独立的，用户可以按任意顺序打开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T09:48:24.110

您可以通过[Application.OpenForms](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.openforms.aspx)属性获取应用程序中所有当前打开的表单的列表。您可以遍历该列表以找到 Form1。请注意，（理论上）可以有多个 Form1 实例（如果您的应用程序可以并且已经创建了多个实例）。

样本：

```
foreach (Form form in Application.OpenForms)
{
    if (form.GetType() == typeof(Form1))
    {
        ((Form1)form).Close();
    }
} 
```

此代码将调用`YourMethod`Form1 的所有打开实例。

（将代码示例编辑为与 2.0 兼容）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T09:41:40.113

当然这是可能的，您所需要的只是对 Form1 的引用和该类的公共方法。

我的建议是在 Form2 的构造函数中传递 Form1 引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T09:47:14.470

您可以做的是在另一个类中创建静态事件，然后让 Form 1 订阅该事件。然后，当在表单 2 中单击按钮时，然后引发表单 1 的事件以继续进行。

如果您愿意，您可以在表格 1 中声明该事件。

```
public class Form1 : Form
{
    public static event EventHandler MyEvent;

    public Form1()
    {
        Form1.MyEvent += new EventHandler(MyEventMethod);
    }

    private void MyEventMethod(object sender, EventArgs e)
    {
        //do something here
    }

    public static void OnMyEvent(Form frm)
    {
        if (MyEvent != null)
            MyEvent(frm, new EventArgs());

    }
}

public class Form2 : Form
{
    private void SaveButton(object sender, EventArgs e)
    {
        Form1.OnMyEvent(this); 
    }
} 
```

# deployment - 制作安装文件

> ID：920007
> 
> 赞同：0
> 
> 时间：2009-05-28T09:36:31.857
> 
> 标签：deployment, installation

我需要制作安装文件（.exe），但是可以使用批处理脚本吗？如何制作？我使用一些软件（部署...）进行了安装，但我需要使用脚本进行安装。我有安装所需的所有文件。

那可能吗？

马尔科

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T09:56:25.060

几乎每个用于构建安装包的工具都提供了在安装过程中包含任意脚本的能力。只需检查您的工具是否具有此功能...

在这里，我们经常在[WIX](http://wix.sourceforge.net/)安装中包含 sripts。当然，当您在本地构建安装包时，用户体验会更好，但在某些情况下这是可以接受的做法（主要是在没有计划非技术用户的情况下）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T09:44:49.500

使用批处理脚本，您将无法制作 .exe（除非您从批处理脚本中调用 .exe 创建者！）。为什么不试试[Inno Setup](http://www.innosetup.com "创新设置")或[NSIS](http://nsis.sourceforge.net "国家安全情报局")呢？[ISTool](http://www.istool.org "工具")有助于轻松快速地创建 Inno Setup 脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T09:49:22.470

您不能只使用批处理脚本来制作 .exe。但是，您可以使用批处理脚本来创建安装规范文件，然后通过安装程序创建程序运行该文件，就像此处其他答案中提到的那样。也许您可以更清楚地了解您实际需要做什么？

# sharepoint - 创建非冲突工作流的指南

> ID：920011
> 
> 赞同：1
> 
> 时间：2009-05-28T09:36:54.197
> 
> 标签：sharepoint, workflow

我们有一个显示日历和管理约会等的 SharePoint 网站。

我们正在尝试通过工作流程自动化该系统的几个方面。

个别地，每个工作流程都可以正常工作。

问题是我们希望它们在项目被修改时自动运行。但有时工作流程本身会修改另一个项目 - 这反过来又会触发工作流程......

你如何避免这些竞争条件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-11T11:34:42.227

**注意：我没有专门用工作流测试过这个**

对于 SP 事件，您可以通过列表项事件接收器以编程方式执行此操作。

当您将事件接收器附加到列表时，您可以显式禁用特定序列的事件触发。这会阻止后续事件因初始事件而触发。

只要您从事件接收器启动工作流，此行为就应该延续到工作流。

```
public class ListItemEventReceiver : SPItemEventReceiver
{
    #region SPItemEventReceiver Interface
    public override void ItemAdded(SPItemEventProperties properties)
    {
        this.DisableEventFiring();

        // trigger your workflow here

        this.EnableEventFiring();
    }
 } 
```

# vb.net - VB.NET 中的 Linq 语法

> ID：920028
> 
> 赞同：1
> 
> 时间：2009-05-28T09:42:21.173
> 
> 标签：vb.net, linq, anonymous-types

我真正想要的是在 Scott Gu 的博客中将这两个表选择为匿名类型：[这里](http://weblogs.asp.net/scottgu/archive/2007/05/15/new-orcas-language-feature-anonymous-types.aspx?CommentPosted=true)但是，我会满足于这种创建的类型“ActiveLots” 我将两个表连接在一起，并希望能够引用每个表中的列在我的结果集中。

我似乎没有正确理解语法。

```
 Dim pi = From p In dc.Inventories Join i In dc.InventoryItems On p.InventoryItemID _
                     Equals i.InventoryItemID Where p.LotNumber <> "" _
                     Select New ActiveLots LotNumber = p.LotNumber, Quantity = p.Quantity, Item = i.Item, Uom = i.UnitofMeasure, Description = i.Description 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T09:55:44.080

看看[Daniel Moth 的博客条目](http://www.danielmoth.com/Blog/2007/02/anonymous-types-in-c-30-and-vb9.html)。我怀疑你想要：

```
Dim pi = From p In dc.Inventories _
         Join i In dc.InventoryItems
              On p.InventoryItemID Equals i.InventoryItemID _
         Where p.LotNumber <> "" _
         Select New With { .LotNumber = p.LotNumber, .Quantity = p.Quantity, _
                           .Item = i.Item, .Uom = i.UnitofMeasure, _
                           .Description = i.Description } 
```

那是使用匿名类型 - 要使用具体类型，您将使用`New ActiveLots With { ...`（其中`ActiveLots`必须有一个无参数构造函数）。

# c++ - 如何检查组合框是下拉列表还是下拉列表？

> ID：920033
> 
> 赞同：3
> 
> 时间：2009-05-28T09:44:38.783
> 
> 标签：c++, mfc, combobox

有没有办法检索 CComboBox 的类型？

我需要知道它是“下拉列表”还是“下拉列表”。

我尝试了以下方法：

```
if (m_MyComboBox.GetStyle() & CBS_DROPDOWN)
   // do some stuff 
```

和

```
if (m_MyComboBox.GetStyle() & CBS_DROPDOWNLIST)
   // do some stuff 
```

但无论 CComboBox 是下拉列表还是下拉列表，这两个表达式的计算结果似乎都为 TRUE。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T09:57:04.840

使用以下代码

```
if ((m_MyComboBox.GetStyle() & 3) == CBS_SIMPLE)
{
    //SIMPLE
}
if ((m_MyComboBox.GetStyle() & 3) == CBS_DROPDOWN)
{
    //DROPDOWN
}
if ((m_MyComboBox.GetStyle() & 3) == CBS_DROPDOWNLIST)
{
    //DROPDOWNLIST
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T09:47:59.337

来自 winuser.h：

```
#define CBS_DROPDOWN          0x0002L
#define CBS_DROPDOWNLIST      0x0003L 
```

你需要：

```
switch(m_MyComboBox.GetStyle() & CBS_DROPDOWNLIST)
{
  case CBS_SIMPLE:
    // do stuff
    break;

  case CBS_DROPDOWN:
    // do stuff
    break;

  case CBS_DROPDOWNLIST:
    // do stuff
    break;
} 
```

# c# - C#中私有构造函数的需要是什么？

> ID：920045
> 
> 赞同：14
> 
> 时间：2009-05-28T09:46:57.983
> 
> 标签：c#

C#中私有构造函数的需要是什么？我把它作为一个 C# 测试的问题。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-28T09:51:10.203

例如，如果您有一个只能通过工厂方法创建的类。或者，如果您有构造函数的重载，并且其中一些只能由其他构造函数使用。可能还有其他原因=)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-28T09:53:45.893

如果你知道一些设计模式，那很明显：一个类可以在内部创建一个自己的新实例，而不是让其他人这样做。一个带有单例类的 Java 示例（我不太了解 C#，抱歉）：

```
class Meh 
{
  private Meh() { }
  private static Meh theMeh = new Meh();
  public static Meh getInstance() { return theMeh; }
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-28T09:50:23.887

每当您想阻止从外部直接实例化一个类时，您将使用`private`构造函数。例如，在引入`static`类的 C# 2.0 之前，您使用`private`构造函数来完成大致相同的事情：

```
sealed class StaticClass {
     private StaticClass() {
     }
     public static void DoSomething() {
     }
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-28T09:52:25.910

当您想阻止您的类的用户直接实例化该类时。一些常见的情况是：

*   仅包含静态方法的类
*   单身人士

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-28T09:53:37.843

我可以回忆起它的一些用法：

*   您可以从同一类中的静态工厂方法中使用它
*   您可以在其中做一些常见的工作，然后从其他结构中调用它
*   您可以使用它来防止运行时自动添加空结构
*   它可以从一些模拟和 ORM 工具（如 nhibernate）中使用（尽管是私有的）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T09:51:53.480

例如，当您提供工厂方法来控制实例化时......

```
public class Test(){

  private Test(){
  }

  void DoSomething(){
    // instance method
  }

  public static Test CreateCoolTest(){
    return new Test();
  }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-08-15T05:09:36.923

私有构造函数用于防止在没有实例字段或方法（例如 Math 类）时创建类的实例，或者在调用方法来获取类的实例时。如果类中的所有方法都是静态的，请考虑将整个类设为静态。有关详细信息，请参阅静态类和静态类成员。

```
class NLog
{
    // Private Constructor:
    private NLog() { }

    public static double e = System.Math.E;  //2.71828...
} 
```

以下是使用私有构造函数的类的示例。

```
public class Counter
{
    private Counter() { }
    public static int currentCount;
    public static int IncrementCount()
    {
        return ++currentCount;
    }
}

class TestCounter
{
    static void Main()
    {
        // If you uncomment the following statement, it will generate
        // an error because the constructor is inaccessible:
        // Counter aCounter = new Counter();   // Error

        Counter.currentCount = 100;
        Counter.IncrementCount();
        System.Console.WriteLine("New count: {0}", Counter.currentCount);
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T09:51:20.720

虽然[此链接与 java 相关](http://www.javapractices.com/topic/TopicAction.do?Id=40)，但我认为它应该可以帮助您理解原因，因为这个想法几乎相同。

> 私有构造函数防止调用者显式实例化一个类。在一些常见情况下，私有构造函数可能很有用：
> 
> *   仅包含静态实用程序方法的类
> *   只包含常量的类
> *   类型安全枚举
> *   单身人士

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-28T10:16:04.523

如果基类的构造函数的参数与子类构造函数的参数类型不同，但您仍然需要子类中基类的功能，例如，您可以将其与继承一起使用。受保护的方法。

一般来说，应该尽可能避免这种情况，因为这是一种不好的继承形式。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-11-02T03:15:38.483

我玩游戏迟到了，但通读所有其他答案，我没有看到提到这种用法：

我在有多个（公共）构造函数的场景中使用私有构造函数，并且它们都有一些共同的代码。使用构造函数链接，代码变得非常整洁和干燥。

请记住，私有只读变量只能在构造函数中设置，所以我不能使用常规方法。

例子：

```
public class MyClass
{
    private readonly int _a;
    private readonly int _b;
    private readonly string _x;

    public MyClass(int a, int b, string x)
        : this(x)
    {
        _a = a;
        _b = b;
    }

    public MyClass()
        : this("(not set)")
    {
        // Nothing set here...
    }

    private MyClass(string x)
    {
        _x = x;
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-10-10T18:28:12.477

基本上，当您遵循单例设计模式时，您会使用私有构造函数。在这种情况下，您在内部调用私有构造函数的类中定义了一个静态方法。

所以第一次创建类的实例，用户调用classname.static_method_name。在这个方法中，由于类的对象还不存在，静态方法在内部调用私有构造函数并返回类的实例。

如果类的实例已经存在，那么静态方法只是将实例返回给调用方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-28T15:34:49.813

当然，您可以使用私有构造函数来防止子类化。

# javascript - 使用 JavaScript 和/或 CSS 禁用文本选择

> ID：920049
> 
> 赞同：1
> 
> 时间：2009-05-28T09:47:43.283
> 
> 标签：javascript, css

我正在尝试使用简单的 span 和格式化文本并提供 onclick 行为来创建一个文本按钮。问题是当用户单击按钮时，有时会突出显示按钮的文本。

我想避免这种行为，因为选择文本时它看起来非常丑陋。我可以使用任何 CSS/JavaScript/(jQuery) 内容来避免这种情况吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T09:53:21.447

```
spanid.onselectstart = function() {return false;} // ie
spanid.onmousedown = function() {return false;} // mozilla 
```

顺便说一下，谷歌上的第一个结果......

**额外的**

```
$('#spanid').selectstart(function(event) {
  event.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-04-03T02:00:28.793

对于 CSS 解决方案：

```
.unselectable {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none; /* Isn't Konquerour dead? */
    -moz-user-select: -moz-none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
} 
```

但是，[看这里](https://developer.mozilla.org/en-US/docs/Web/CSS/user-select)，CSS 解决方案在 2013 年末还不够，所以你应该添加一些 javascript。周围有很好的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-30T17:58:28.557

你可以写：

```
$('#spanid').disableSelection(); 
```

# javascript - 我可以安全地使用哪些键码来使我的网站可以访问？

> ID：920063
> 
> 赞同：4
> 
> 时间：2009-05-28T09:51:27.363
> 
> 标签：javascript, keyboard-shortcuts, usability, accessibility

**更新：得到了一个漂亮的应用程序，每个视图都有专属的快捷方式，所有的 javascript。我要研究 Fogbugz，我喜欢悬停的快捷方式代码，感谢您的参考。**

* * *

我想让我的网站更容易被访问者访问和使用。**我可以安全地使用哪些键码来处理某些 javascript 操作？**

我的意思是安全地：

*   不会因默认浏览器操作而中断的键码
    *   没有直接的功能（比如按下`F1`帮助）
    *   没有间接功能（例如按`Ctrl`+`C`复制）

**或者我应该阻止执行默认操作？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T09:57:27.133

我个人避免将这些键码或 AccessKeys 用于面向公众的网站，因为无法知道您是否与用户软件（如屏幕阅读软件等）中的某些预定义快捷方式发生冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T09:55:47.620

也许你应该看看这些问题：

[Web 应用程序中的关键快捷方式](https://stackoverflow.com/questions/912018/key-shortcuts-in-web-application) [构建可通过键盘访问的 Web 应用程序](https://stackoverflow.com/questions/362727/building-a-keyboard-accessible-web-application)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T09:56:51.473

您想要实现什么可访问性？

无障碍软件之类的将有自己的按键操作。

不同的浏览器有自己的按键操作。

有些甚至是可定制的。

我觉得你做什么都是自找麻烦。

**编辑：**好的，所以不知何故这不清楚。这就是我想说的：

浏览器和可访问性软件对于可能使用的组合键具有无限的可能性。如果你试图捕捉组合键，你会在沿线的某个地方干扰那些组合。

叹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T09:56:43.750

只要坚持字母和数字。

这是 gmail 使用的快捷方式的链接，例如：- [http://mail.google.com/support/bin/answer.py?hl=en-uk&answer=6594](http://mail.google.com/support/bin/answer.py?hl=en-uk&answer=6594)

只要确保您不会干扰人们在表单字段中输入内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T16:00:52.127

从长远来看，这可能是一个难以解决的问题，因为浏览器有时会在较新的版本中引入新的键盘快捷键，这可能与您在应用程序中分配的快捷键冲突。我知道的几个这样的例子：

*   在 Firefox 1 中运行的旧版[Google 工具栏](http://toolbar.google.com/)使用按键 Alt+s 将焦点设置到工具栏上的“搜索”字段。然而，当 Firefox 2 推出时，历史菜单添加了一个 Alt+s 访问键，这破坏了 Google 工具栏 Alt+s 键盘快捷键。（[更多信息](http://blog.jonschneider.com/2006/10/workaround-cant-focus-google-toolbar.html)）

*   旧版本的 Firefox 扩展[复制选项卡](https://addons.mozilla.org/en-US/firefox/addon/28)使用键盘快捷键`Ctrl`++`Shift`复制`T`当前选项卡。但是，Firefox 2引入了一个新功能，“重新打开最近关闭的标签页”，并将其分配给`Ctrl`++ ，从而破坏了重复标签页。复制标签的作者最终将“复制标签”快捷键更改为+ + 。（[更多信息](https://www.mozdev.org/bugs/show_bug.cgi?id=16032)）`Shift``T``Ctrl``Shift``U`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T16:00:30.733

您还将很高兴了解 W3 的 WCAG 和 WCAG 2.0 的存在，以帮助您完成可访问性任务。

# jquery - 如何使用 POST 方法和使用 jquery ajax 将 xml 作为参数传递

> ID：920066
> 
> 赞同：13
> 
> 时间：2009-05-28T09:52:47.703
> 
> 标签：jquery

我正在使用 jQuery + ajax 将数据发布到服务器并在传递 xml 字符串时遇到问题。我想`<test></test>`使用 POST 方法将 xml 字符串例如“”作为参数传递给 ajax 函数。我能够传递所有其他类型，但不能传递 xml 字符串。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-05T17:50:41.090

为了将 xml 或 html 发布到服务器，您首先必须对其进行**转义**，然后在服务器上进行**解码**。

```
$.ajax({
    type: "POST",
    url: "Home/GetResults",
    data: { 
        inputxml: escape('<test></test>')
    },
    success: function(msg) {
        var data = JSON.parse(msg);
        alert(data.Message);
    },
}); 
```

在服务器上，您将通过以下方式对其进行解码：

```
HttpUtility.UrlDecode(inputxml); 
```

# recursion - 什么是递归可枚举集？

> ID：920074
> 
> 赞同：3
> 
> 时间：2009-05-28T09:54:17.187
> 
> 标签：recursion, computer-science, set

[关于该主题的维基百科文章](http://en.wikipedia.org/wiki/Recursively_enumerable)似乎有很多[讨论](http://en.wikipedia.org/wiki/Talk:Recursively_enumerable_set)（和混淆）。谷歌抛出的其他结果不可免费供公众使用。

我会对你们说的话很感兴趣。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-28T10:05:35.917

这是一个定义：递归可枚举集合是一个集合，您可以在其中编写一个程序，该程序将输出集合中的每个元素：E1、E2、E3……如果这个程序永远不会停止也没关系。

人们通常在语言的背景下谈论这个。递归可枚举语言是一种语言，您可以在其中编写一个程序，以该语言写出每个有效字符串。语言只是一组字符串，因此“以 10 为底的所有素数的集合”是有效的语言。

然而，想象一下，您不想生成语言中的所有字符串或集合中的所有元素。您只想检查给定的字符串是否使用该语言。问题是您永远无法确定该字符串不是您的语言。如果你需要为这种语言编写编译器，你的编译器可以在有效输入上正常工作，但无效输入会使你的编译器永远挂起，因为它会在无限列表中搜索不存在的东西。

“递归语言”或“递归集”的集合是您可以编写程序告诉您给定输入是否在集合中的集合。所有递归语言也是递归可枚举的，因为您可以枚举每个字符串，然后在您的集合中输出它。递归语言也被称为可判定的，因为你可以确定一个元素是否在其中。对于更一般的递归可枚举集，情况并非如此。

一般来说，更容易证明一个集合或语言是递归可枚举的或递归的，但更难证明它不是递归的而是递归可枚举的。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-12-01T20:01:48.580

这个概念最好通过示例和与递归集的比较以及不同定义的比较来说明。所以我会这样做：我先给你例子，然后给你不同的（但等价的）定义。

首先，请注意，从技术上讲，我们将形容词“递归可枚举”（也称为“半可枚举”）应用于自然数集。但是这个形容词也可以应用于一组整数，一组整数对，一组 Unicode 字符串。请注意，任何这些东西（整数、整数对、Unicode 字符串）都可以存储在计算机内存中。（不能存储在计算机内存中的东西包括任意（无限精度）实数和 0 或 1 的无限序列）

示例 1：所有素数的集合

您可以编写一个算法，将自然数作为输入并返回是或否的答案（yes 表示“是，该输入是素数”，no 表示“不，该输入不是素数。”）。这个算法很容易写。如果您不费心优化以获得更好的性能，这非常容易。因为您可以编写一个始终完成并给出是或否答案的算法，所以所有素数的集合称为**可判定集合**（也称为**递归集合**）。它被称为可决定的，因为你**可以决定**自然数是否是素数。请注意，如果您想证明一个集合是一个可判定集合，您只需要提出一个始终完成并给出正确答案的算法，您不需要优化性能。让我们不要讨论为什么它被称为递归。

示例 2.**素数间隙**是两个连续素数之间的差。例如，13 是素数，下一个素数是 17，因此它们的差 4 是素数间隙。我们的第二个例子是所有素数缺口的集合。

你能写一个算法来检查一个数字是否是质数间隙吗？下面的伪代码怎么样？

```
input: x

set i to 1
loop
  check primeness of i, i+1, ..., i+x
  if only i and i+x among them are primes, return yes.
  otherwise, increment i by 1 and go to start of loop 
```

伪代码中的算法有好有坏。

坏处：如果输入不是主要间隙，它将永远不会完成。它永远不会返回否定的答案。

好处：如果它返回“是”的答案，您肯定知道输入是质数间隙，反之亦然。

该集合是半可**判定集合**（也称为**递归可枚举集合**）的示例。如果您输入一个质数间隙并等待足够长的时间，该算法将始终给您一个肯定的确认，但如果您输入一个不是质数间隙的数字，该算法永远不会给您一个否定的确认。

定义：一个集合是一个半可判定集合，如果有一个算法接受一个输入并且返回是或返回否或从不返回（由于无限循环或错误）并且如果该算法在给定集合中的输入时返回是，并且如果该算法在给定不在集合中的输入时永远不会返回“是”。

所有的圆都是椭圆，所有可判定的集合都是半可判定的集合。

经过一番思考，您可能会意识到算法是否允许有时正确返回 no 对于最终的定义并不重要。通过更多的思考，您可能还会意识到是否允许错误对于定义也无关紧要。这些实现使我们能够提出一个等价的、更简单但不太直观的定义：

不太直观的定义：一个集合是一个半可判定集合，如果有一个算法接受一个输入，并且如果该算法返回（即程序终止）当且仅当给定集合中的一个输入。

现在让我们谈谈可列表集。如果有一种算法可以打印集合中的所有元素（仅此而已），则集合是可**列出的集合。**当然，如果必须打印无限多的元素，该算法永远不会完成。有了一些想法，您可能会意识到，每当您有一个算法来打印集合中的所有数字时，有时会多次打印相同的数字，您可以修改算法，使其只打印一次所有数字。请注意，定义并没有说算法必须首先打印最小的元素，然后是第二小的元素，依此类推。为什么我在谈论可列出的集合？

定理：一个集合是一个可列集当且仅当它是一个半可判定集合。

让我们不讨论为什么这是真的（也许为此提出一个 SO 问题？），但让我提一下，这就是“递归可枚举”这个短语的原因：您可以枚举集合，因为您可以列出所有元素一个一个，“递归”只是意味着“使用算法”。

一个不涉及数字的例子怎么样？

示例 3\. 所有 ASCII 字符串的集合，它是一个不带参数且保证返回的 Python 函数定义。（为简单起见，我们还排除了调用库的 Python 函数，这些库执行一些特定于硬件的操作）

这个集合是一个半可判定集合，因为你可以制定一个半判定算法。该算法只需要模拟 Python 来运行 Python 函数，然后等待它完成。如果 Python 函数曾经在您的仿真中返回，那么您的算法将返回 yes。这就是算法。我们能比那个算法做得更好吗？是的，制作一个在某些情况下检测无限循环并返回否的算法。你能想出一个永远不会检测到无限循环的算法吗？如果你能想出这样一个算法，这个集合将是一个可判定集合。可悲的是，没有这样的算法，我们可以证明这一点。

示例结局。当斯大林掌权时，苏联政府的一套**好的**政策就像一个半决定性的一套。有人是政府的顾问之一。斯大林会问他，“我有一个新政策的想法。这个想法是胡说八道。这是一个好政策吗？” 一个简单的是或否的问题。经过几天的分析，他的回答是肯定的，政策确实是好的。如果政策不好怎么办？他有“永远不撒谎”的原则，但他也知道那些对斯大林说不的人会怎么样。每当斯大林说“你决定好政策好不好了吗？我已经好几个月没有征求你的意见了。” 他会说：“给我更多的时间思考，斯大林同志。”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T10:00:58.623

递归可枚举集合是一个集合，其中有一个部分可计算的算法来决定一个元素是否包含在集合中（它可以被计算但它不一定会终止）

例如，确定一个项目**是否不在**mandlebrot 集中是递归可枚举的。

# msbuild - MSBuild 中的可为空的参数值

> ID：920077
> 
> 赞同：3
> 
> 时间：2009-05-28T09:54:53.537
> 
> 标签：msbuild, nullable

我正在编写一个 MSBuild 任务来升级数据库（[此处](http://code.google.com/p/octalforty-wizardby/source/browse/trunk/src/octalforty.Wizardby.Ci.MSBuild/UpgradeDatabase.cs)为完整源代码），但遇到了一个错误/设计功能，我不知道如何处理。基本上，如果我声明：

```
public int? TargetVersion
{
    [DebuggerStepThrough]
    get { return targetVersion; }
    [DebuggerStepThrough]
    set { targetVersion = value; }
} 
```

然后尝试在`.msbuild`文件中分配一个值：

```
<Target Name="Upgrade">
    <UpgradeDatabase ... TargetVersion="10" />
</Target> 
```

MSBuild 吓坏了，说

> 错误 MSB4030：“10”是“UpgradeDatabase”任务的“TargetVersion”参数的无效值。“TargetVersion”参数的类型为“System.Nullable`1[System.Int32]”。

如何为可为空的属性赋值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T10:02:03.177

MSBuild 似乎不支持可为空的值。一种解决方法是在内部使用可为空的属性，但提供公共的不可为空的属性。这样，对公共属性的第一次分配会将内部值从 null 设置为实际值，因此您在新初始化的实例中有 null，但 MSBuild 可以愉快地分配它的值。

也就是说，除非有某种方法可以欺骗 MSBuild 直接支持 nullables :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T17:13:20.240

我建议您多看看 [Required] 标签。这就是 MSBuild 处理可选参数和必需参数的方式。

# c# - 要在 CD 上分发的数据库

> ID：920078
> 
> 赞同：0
> 
> 时间：2009-05-28T09:55:07.187
> 
> 标签：c#, database, cd

在 CD-ROM 上分发小型数据库的好方法是什么？

数据库必须加密。它必须在 WinXP 和 Vista 上运行。该应用程序是用 C# 编写的，并且也在 CD 上分发。记录只能读取，不能写入。

可以运行安装程序，但我们不想这样做。

数据库有 100000 条记录，性能不是主要目标。

编辑：是的，用户必须输入密码才能解密数据库。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T09:58:07.833

我会为此使用[SQLite](http://sqlite.org)。

实际上重新阅读您的问题，您甚至可以使用平面文件或 XML 文件，因为不需要性能或更新/添加。

但是，如果您有任何机会在您的应用程序成熟时需要添加/更新此数据源，请使用 SQLite。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T10:00:19.110

老实说......如果你能做到，我会使用加密的 XML 文件。无需安装，可在任何地方运行（文本文件没有依赖项），速度快，并且由于不需要更新，这将使其变得更加容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T10:05:57.773

MS-SQL (Express) 具有只读数据库的显式设置。我不确定加密。

我很确定 Sql Server Compact (SSCE) 也将允许只读，并且它支持加密。但是您必须将密码存储在某个地方...

SSCE 可能允许您运行 w/oa 设置。

鉴于数据的大小，也可以使用已填充并保存到磁盘的数据集。您可以使用标准库进行加密和压缩。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T10:08:24.943

[SQL Server CE](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)是支持加密的 SqlServer（CE 代表 Compact Edition）的精简版。数据库包含在一个文件中。

该软件包含一组 DLL，您可以将其与 exe 并排复制。

（不要被 CE 所迷惑：除了 Windows Mobile 版本之外，还有一个 Desktop Windows 版本。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T10:08:32.230

如果您在英国的政府机构工作，请尽量不要将 CD 留在火车上或邮寄... :)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T10:38:49.703

> 数据库必须加密

快速提问：你如何解密它？正确地，通过让用户输入解密密码，或者不正确地将解密密钥添加到您的应用程序，这意味着它可以很容易地提取？

因为如果是解决方案 2，那么您可以通过完全放弃加密要求来扩大可能的数据库选项。

我也在寻找一个嵌入式数据库，[根据](https://stackoverflow.com/questions/705)我收到的答案，我选择了[易于实现](http://www.mikeduncan.com/sqlite-on-dotnet-in-3-mins/)的 SQLite 。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T14:24:07.393

正如其他人指出的那样，存在支持只读访问的数据库。

至于加密，SQLite 至少有一个[扩展支持加密](http://www.hwaci.com/sw/sqlite/cerod.html)

您也可以选择任何只读 dbms 并保留 pk 和 fk，但手动加密内容字段（即通过代码）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-04T21:10:54.850

SQLite 也是我的第一个想法，但尽管我普遍不喜欢 XML 并且考虑到只读方面，但我认为 XML 的自定义加密可能是最好的选择。逆向工程会更难。

# wsdl - 从 XSD 文件生成 WSDL

> ID：920086
> 
> 赞同：42
> 
> 时间：2009-05-28T09:56:47.167
> 
> 标签：wsdl, xsd

我需要生成一个给定 XSD 文件的 WSDL 文件。我该怎么做呢？我可以在 VS2005 中执行此操作吗？最简单的方法是什么？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-05-28T10:01:06.503

您不能 - XSD 描述了 Web 服务的 DATA 方面 - WSDL 描述了 Web 服务的功能（方法调用）。您通常无法仅从数据中找出方法调用。

这些实际上是等式中两个独立的、独特的部分。为简单起见，您通常会将 XSD 定义导入`<wsdl:types>`标记中的 WSDL。

（感谢 Cheeso 指出我对术语的不准确使用）

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-28T10:49:34.690

我想在这方面与 marc_s 有所不同，他写道：

> XSD 描述了 Web 服务的 DATA 方面 - WSDL 描述了 Web 服务的功能（方法调用）。您通常无法仅从数据中找出方法调用。

[WSDL](http://www.w3.org/TR/wsdl)不描述函数。WSDL 定义了一个网络接口，它本身由端点组成，这些端点获取消息，然后有时会回复消息。WSDL 描述端点以及请求和回复消息。它非常面向消息。

我们经常将 WSDL 视为一组函数，但这是因为 Web 服务工具通常会生成客户端代理，将 WSDL 操作公开为方法或函数调用。但 WSDL 并不要求这样做。这是工具的副作用。

**编辑**：此外，在一般情况下，XSD 不定义 Web 服务的数据方面。XSD 定义了兼容的 XML 文档中可能存在的元素。这样的文档可以作为消息通过 Web 服务端点进行交换，但并非必须如此。

* * *

回到这个问题，我会以不同的方式回答最初的问题。我会说是的，可以 **在给定 xsd 文件的情况下生成 WSDL 文件，** 就像可以使用鸡蛋生成煎蛋一样。

**编辑**：我最初的反应还不清楚。让我再试一次。我不建议 XSD 等同于 WSDL，也不建议 XSD 足以生成 WSDL。我确实说过*，给定一个 XSD 文件*，如果您的意思是“使用 XSD 文件生成一个 WSDL”，则可以生成一个 WSDL。这样做，您将扩充 XSD 文件中的信息以生成 WSDL。您将需要定义额外的东西——消息部分、操作、端口类型——这些都不存在于 XSD 中。但是，通过一些创造性的努力，“在给定 XSD 的情况下生成 WSDL”是可能的。

如果短语“在给定 XSD 的情况下生成 WSDL”被认为暗示“将 XSD 机械地转换为 WSDL”，那么答案是否定的，您不能这样做。鉴于我对上面 WSDL 的描述，这一点应该很清楚。

使用 XSD 文件生成 WSDL 时，您通常会执行以下操作（请注意此过程中的创意步骤）：

1.  将 XML 模式导入 WSDL（wsdl:types 元素）
2.  根据需要添加到类型或元素的集合中，或者添加其他类型或包装器（比如数组或包含基本类型的结构）。#1 和#2 的结果包含 WSDL 将使用的所有类型。
3.  根据先前定义的类型定义一组输入和输出消息（可能还有故障）。
4.  定义一个端口类型，它是成对的 in.out 消息的集合。您可能会将 port-type 视为 Java 接口的 WSDL 模拟。
5.  指定一个绑定，它实现端口类型并定义如何序列化消息。
6.  指定实现绑定的服务。

大多数 WSDL 或多或少都是样板文件。它可能看起来令人生畏，但这主要是因为我发现那些可怕而丰富的尖括号。

有人认为这是一个冗长的手动过程。也许。但这就是构建可互操作服务的方式。您还可以使用工具来定义 WSDL。从代码动态生成 W​​SDL 将导致互操作陷阱。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-09-23T09:57:08.747

我知道这个问题很老，但值得回答。我个人更喜欢手动创建 WSDL 并使用 SoapUI 测试合规性。但有时（特别是对于复杂的 WSDL），您可以通过三种方式从 XSD 中生成一种：

1.  [使用 Eclipse 从模式生成 WSDL（可能是最用户友好的）](https://helloworldpoc.wordpress.com/web-services/92-2/)
2.  [通过 CXF 生成 WSDL（我的最爱）](http://cxf.apache.org/docs/xsd-to-wsdl.html)
3.  [使用 Spring WS 通过约定生成 WSDL（我最不喜欢的）](http://docs.spring.io/spring-ws/site/reference/html/tutorial.html#tutorial-publishing-wsdl)

我更喜欢 CXF 方法，因为我是 CLI 专家。如果它有 CLI，你可以自动化（这是我的座右铭）。我最不喜欢 Spring WS 方法，因为它使用了很多特定于框架的约定。

知道 CXF 的人（我相信）比 Spring WS 还多。因此，任何可以为新工程师带来学习曲线的东西（没有任何明显的优势或投资回报率）都是我不赞成的。

它还应该不说应该测试任何生成的 WSDL 的有效性和合规性（并进行调整直到它符合），并且您的应用程序发布一个静态 wsdl（而不是返回一个自动生成的）。

根据我的经验，您从一个符合 WS-I 的 wsdl 开始，然后您的应用程序会自动生成（并返回给消费者）一个不符合标准的 wsdl。

换句话说，当心自动魔法。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-12-13T15:27:22.380

这个工具[xsd2wsdl](http://cxf.apache.org/docs/xsd-to-wsdl.html)是 Apache CXF 项目的一部分，它将生成一个极简的 WSDL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T10:12:58.553

就我个人而言（考虑到我所知道的，即 Java 和轴），我会从 .xsd 文件生成一个 Java 数据模型（Axis 2 可以做到这一点），然后添加一个接口来描述我使用该模型的 Web 服务，然后从该接口生成一个 WSDL。

因为 .NET 也具有所有这些功能，所以在该生态系统中也必须能够做到这一切。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-13T10:54:39.643

我们可以从 xsd 生成 wsdl 文件，但您必须使用 eclipse (OEPE) 的 oracle 企业包。只需创建xsd，然后右键单击->新建->wsdl ...

# version-control - 如何停止在 TFS 中意外签入文件

> ID：920096
> 
> 赞同：10
> 
> 时间：2009-05-28T09:58:20.347
> 
> 标签：version-control, tfs

我有一个 web.config，偶尔我会检查并修改它以使用硬编码密码，而不是从注册表中读取它。

我怎样才能防止自己心不在焉地重新检查并惹恼我的同事？

过去，我可以通过创建一个单独的待处理更改列表来使用 Perforce 实现这一点。

编辑 - 我宁愿不让它可写，我想知道 TFS 中是否有任何东西或 TFS 计划支持这个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T10:43:19.960

选项 1：您可以`web.config`在不签出的情况下仅在本地进行可写操作（通过将 VS 设置为提示签出会有所帮助）。

选项 2：将密码移出 web.config。使用 [`configSource`属性](http://msdn.microsoft.com/en-us/library/ms228167.aspx)将该配置放入本地文件，而不是 TFS 文件。然后每个开发人员维护自己的副本。

例如在`web.config`：

```
<configuration>
  ...
  <connectionStrings configSource="LocalConnectionStrings.config"/>
</configuration> 
```

并在`LocalConnectionStrings.config`：

```
<connectionStrings>
  <add name="MyConnectionString"
    connectionString="Data Source=.;Initial Catalog=Test1;Integrated Security=True"
    providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

注意。`configSource`由 ASP.NET 的配置运行时实现，并且在 ASP.NET 的所有配置元素上都受支持（因此，不适用于任意（包括自定义）配置元素）。

（另请注意，[`<linkedConfiguration> Element`](http://msdn.microsoft.com/library/ms404300)提供了另一种包含机制，但仅限于[`assemblyBinding`element](http://msdn.microsoft.com/en-us/library/ms404289.aspx)。）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-28T15:32:36.303

这是一个解决方案：

1) 右键单击​​文件（在源代码管理资源管理器中）并选择属性。

2）然后转到安全并添加您自己（确保选择用户单选按钮）

3）然后拒绝自己的签入权。（点击签入下的拒绝复选框）

这将阻止您签入文件。为了能够稍后签入，只需再次执行这些步骤，但选中允许复选框。

注意：您可能需要让您的管理员为您提供该文件的“操纵安全设置”（与上述相同，但在第 3 步中选择“操纵安全设置”下的允许。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-04T12:35:16.523

TFS 的源代码控制项目使用文件的“只读”属性来评估文件状态。您可以通过资源管理器转到计算机中存在 web.config 的物理文件夹。确保在开始之前检查您的 web.config。然后 ：

1.  右键单击 web.config 文件并选择“属性”
2.  取消选中“只读”复选框。单击确定/应用
3.  在记事本或其他文本编辑器中编辑您的 web.config 并保存更改
4.  右键单击 web.config 文件并选择“属性”
5.  选中“只读”复选框。单击确定/应用

之后，您必须对文件执行特定操作才能从 TFS 获取任何更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T10:43:38.040

不签出文件而只更改本地文件怎么样？

# c# - 为 Windows Mobile 编写视频播放器的建议

> ID：920098
> 
> 赞同：0
> 
> 时间：2009-05-28T09:58:49.800
> 
> 标签：c#, windows-mobile, compact-framework, mobile

我想用 C# 为 Windows mobile 开发一个视频播放器；谁能指导我正确的方向来寻找我在这个主题中需要的所有帮助。请向我发送此方向的链接和您的评论。先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T10:01:15.817

为自己省去很多麻烦，并使用来自 [http://www.opennetcf.com/Products/Controls/MediaPlayerControls/tabid/264/Default.aspx的 OpenNetCF 媒体播放器控件](http://www.opennetcf.com/Products/Controls/MediaPlayerControls/tabid/264/Default.aspx)

另一种选择是大量的 pInvoke。

如果您真的，真的必须自己执行此操作并且不能使用任何第三方库，您可能希望将媒体播放器托管为 activeX 控件。有关如何执行此操作的详细信息，请访问[http://msdn.microsoft.com/en-us/library/aa446515.aspx](http://msdn.microsoft.com/en-us/library/aa446515.aspx)。
被警告。这[不是](http://social.msdn.microsoft.com/forums/en-US/vssmartdevicesvbcs/thread/4e35bad0-9eae-4ed8-ada5-bd249411fa1f/) [直截了当](http://social.msdn.microsoft.com/Forums/en-US/vssmartdevicesvbcs/thread/6d218e96-5a25-4b21-9ddb-d3a82acee1c9)[的](http://social.msdn.microsoft.com/Forums/en-US/vssmartdevicesvbcs/thread/3b57e45f-153e-4340-b5a9-a9b08c192b4d)。[_](http://social.msdn.microsoft.com/forums/en-US/netfxcompact/thread/e2b1780d-7841-462f-9cfe-0a72d7781d5f/) 如果可能，请使用内置媒体播放器或第三方控件。

# c# - 数据绑定 DataGridView - IDataError

> ID：920102
> 
> 赞同：1
> 
> 时间：2009-05-28T10:00:45.957
> 
> 标签：c#, .net, c#-2.0

我有一个带有数据绑定 DataGridView 的表单。我使用 IDataError 接口来处理错误，它运行良好，在有错误的行的行标题中显示红色标记..

但是如何让光标跳转到有错误的第一行。

提前致谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T10:21:11.453

据推测，通过迭代它们？

```
 foreach(DataGridViewRow row in view.Rows)
    {
        IDataErrorInfo dei = row.DataBoundItem as IDataErrorInfo;
        if (dei != null && !string.IsNullOrEmpty(dei.Error))
        {
            if(row.Cells.Count > 0) view.CurrentCell = row.Cells[0];
            view.FirstDisplayedScrollingRowIndex = row.Index;
            break;
        }
    } 
```

# c - 在 c 中使用 FILE 流读取/写入套接字

> ID：920106
> 
> 赞同：2
> 
> 时间：2009-05-28T10:01:18.577
> 
> 标签：c, sockets

我发现了一个很好的抽象，我可以使用 FILE 从 UDP 读取数据。这非常适合读取数据，但我无法让它通过 UDP 吐出数据。以下是通过 FILE 流读取 UDP 数据的代码：

```
u_int8 *buf;
int sockfd = socket(AF_INET, SOCK_DGRAM, 0);
struct sockaddr_in serverAddr;
if (sockfd < 0) {
  printf("Could not open socket\n");
  exit(1);
}
buf = malloc(BUF_SIZE * sizeof(u_int8));
serverAddr.sin_family = AF_INET;
serverAddr.sin_addr.s_addr = htonl(INADDR_ANY);
serverAddr.sin_port = htons(port);
int rc = bind(sockfd, (struct sockaddr *)&serverAddr, sizeof(serverAddr));
if (rc<0) {
  printf("Could not bind to port %d\n", port);
  exit(1);
}
/* Make sockfd blocking */
int flags = fcntl(sockfd, F_GETFL, 0);
fcntl(sockfd, F_SETFL, flags & ~O_NONBLOCK);

FILE *sockfile;
sockfile = (FILE*)fdopen(sockfd, "r"); 
```

现在一些其他代码可以调用：

```
fread(data, sizeof(u_int8), frame_payload_size, sockfile); 
```

这工作正常。但是，相反的情况似乎并非如此：

```
u_int8 *buf;
int sockfd = socket(AF_INET, SOCK_DGRAM, 0);
struct sockaddr_in clientAddr;
if (sockfd < 0) {
  printf("Could not open socket\n");
  exit(1);
}
memset((char *)&clientAddr, 0, sizeof(clientAddr));
buf = malloc(BUF_SIZE * sizeof(u_int8));
clientAddr.sin_family = AF_INET;
clientAddr.sin_port = htons(port);
if (inet_aton("127.0.0.1", &clientAddr.sin_addr)==0) {
  printf("inet_aton()\n");
  abort();
}
int rc = bind(sockfd, (struct sockaddr *)&clientAddr, sizeof(clientAddr));
FILE *sockfile;
sockfile = (FILE*)fdopen(sockfd, "w"); 
```

其他一些代码将调用：

```
written = fwrite(fm->frame, sizeof(u_int8), fm->frame_length, data_out_stream); 
```

'written' 将返回写入的正数元素，但似乎没有生成 UDP 数据包。

我正在尝试做的事情可能吗？关于为什么它可能不起作用的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T10:12:18.867

您没有隐藏信息，这可能很酷，但是您向另一段代码提供了虚假信息，即您的套接字的行为就像一个流。我认为你应该坚持读/写调用，否则你会发现自己有一个[泄漏的抽象](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T10:12:50.567

刷新文件。仅当网络数据包已满或强制刷新时才会生成网络数据包。因此，除非您写入超过 1500 字节（默认值，包括标题字段），否则计算机将等待交付。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T10:16:54.693

这实际上很奇怪。使用 fflush()，或者更好的是，使用 send() 而不是 fwrite() 并丢弃 FILE。由于 FILE 对象如何缓冲的语义以及数据报如何无法保证按顺序到达/到达，您将遇到意外行为，这可能导致消息乱码。除非您使用的是 UNIX 套接字。

# jquery - JQuery - 在 Javascript 中硬编码 HTML - 有没有更好的方法来动态创建 dom 元素？

> ID：920114
> 
> 赞同：2
> 
> 时间：2009-05-28T10:04:48.587
> 
> 标签：jquery, html, dom, hardcode

我有很多消息，以及我在 javascript 代码中硬编码的原始 HTML，例如：

```
 var subjectId = $(subject).attr('subjectId'); 
    var subjectName = $(subject).attr('subjectName'); 
    var html = "<table id='invitations' class='invitations' width='100%'><tbody>";
    $(subject).find('group').each( function() {     
        var groupId = $(this).attr('groupId');
        var groupName = $(this).attr('groupName');
        var ownerId = $(this).attr('ownerId');
        var owner = findStudentNameById( subjectId, ownerId );
        html += "<tr>" +
                    "<td width='55px'><img src='images/gplg.png' /></td>" +
                    "<td>" + subjectId + " <span class='subjectName'>" + subjectName + '</span> <br /> '  + groupId + 
                    " - <span class='group'>" + groupName + "</span><br /> Created By "  + owner + "</td>" +
                "</tr>" +
                "<tr>" +
                    "<td width='55px'></td>" +
                    "<td><img class='accept' src='images/accept.png' />" +
                        "<img class='decline' src='images/decline.png' /> " +
                    "</td>" +
                "</tr>";                    
    });
    html += "</tbody></table>";
    return html; 
```

或者 ...

```
$('#inviteform').submit( function (){
            var invitesSent = false;
            var html = '<h3>Invitations have been sent to the following people</h3><br /><ul>';
            $('#inviteform').find('input:checkbox').each( function() {
                if ( $(this).is(':checked')){
                    html += '<li>+ <a href="#">' + $(this).val() +'</a></li>';
                    invitesSent = true;
                }
            });
            html += '</ul>';

            if ( !invitesSent ){
                html = '<h3>You did not select any invitees, no invitations have been sent.</h3>';
            }

            $('#content').hide().fadeOut(2000);
            $('#content').html(html).slideDown("slow");
            $('#slogan').html('Congratulations! Your group is now complete. ').fadeIn(2000);

            return false;
        }); 
```

这是因为我有 2 个主要的页面区域（即标题 div 和内容 div），我需要动态更改其中的内容。不幸的是，我无法将此内容分成不同的文件。

那么，在为这些 div 创建文本和 DOM 元素而不是硬编码这么多东西之后，是否有最佳实践。

我正在寻找最优雅的解决方案，所以我没有太多的硬编码。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T10:21:09.660

您应该查看模板库。[jQuery 模板引擎](https://stackoverflow.com/questions/170168/jquery-templating-engines)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T10:28:35.823

它鼓励您对 HTML 字符串进行硬编码的方式是我对 jQuery 最讨厌的地方之一。

我通常只是最终使用标准的 Javascript ：`document.createElement('TD')`

如果您要创建许多相同类型的节点，最好/更快地缓存它们并用于`cloneNode(true)`创建新节点：

```
var nodeCache;
    nodeCache.td = document.createElement('TD')

var newTD = nodeCache.td.cloneNode(true); 
```

我知道这并没有过多地使用 jQuery，但我认为 jQuery 的处理方式是不优雅的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T10:14:20.733

您可以使用 jQuery 的选择器来创建 DOM 元素。例如，

```
$('<table>') 
```

将创建一个表格元素，然后您可以在其上设置属性，然后附加到 DOM。

```
$('<table id="invitations" class="invitations" width="100%">')
    .append('<tbody>')
    .appendTo(selector);
    // etc 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T10:22:23.603

一种替代方法是使用 append()、addClass()、css()、attrib() 和其他 jQuery 方法来构造 DOM。链接将使代码更优雅。这会很好地工作，尤其是对于小型 DOM 树。

如果您需要更大的 DOM 树，那么最好使用 AJAX 方法从服务器获取它们。您需要调整代码以传递动态生成的数据。

此外，您可以考虑重新设计您的 html 和 javascript 代码。例如，您可以将 DOM 树放在 html 中并将其隐藏（使用 CSS 或 javascript）。然后您可以在添加动态生成的数据后显示它。从关注点分离的角度来看，这要好得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T10:43:30.643

尝试通过 ajax 获取 html。

这将分离 javascript 和 html，打破依赖关系。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T10:45:32.700

使用 Ajax 调用用户控件会更好。

这样您就可以在 html 用户控件中完成所有标记。

在我的愚见。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T13:37:29.123

在您的情况下，我会将消息与标记分开。您可以在页面中有一个空的 html 脚手架，例如

```
...<div id="feedback" style="display:none;"><h3 class="headline"></h3><p class="message"></p>... 
```

然后使用 jQuery 填充它。这样，您可以将所有用户消息重构为一个外部 .js 文件，这极大地简化了 i18n。

顺便说一句，我不能推荐 JQuery 模板引擎。它们要么迫使您使用非常笨拙的语法（例如 jTemplates），要么将您限制为简单的元素克隆。恕我直言，使用 .clone() 方法几乎总是更好。

# .net - 标准 Windows Mobile 6 中图片框的事件

> ID：920115
> 
> 赞同：0
> 
> 时间：2009-05-28T10:05:24.607
> 
> 标签：.net, windows-mobile

我是 windows mobile 开发的新手。如何重定向到另一个页面。当我单击标准 windows mobile 6 中的图片框时。标准 windows mobile 6 没有点击事件。它不是触摸屏手机。任何人都可以帮助我吗？

添加 - 如果主屏幕 9 图标/图片框。那么如何从一个图标转到另一个。任何事件。如果有任何链接或任何代码。请给我？

提前谢谢...问候pankaj

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T02:25:07.603

One approach would be to hook up your form's key press event handlers and handle the left/right/up/down key press events manually.

Your custom logic would then be responsible for displaying the change in focus somehow (perhaps a border around the active picture box etc).

A "click" could then be replaced with a press of the action (center d-pad) button.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T10:13:26.493

是的，Windows Mobile Standard 没有触摸屏，因此您无法“点击”图片。

您将需要使用其他东西在页面（表单？）之间导航。使用标准控件，您需要使用 LinkLabel 或菜单项来进行导航。

# wpf - WPF：将 UIElements 添加到 ItemsPanelTemplate 是画布的 ListBox？

> ID：920117
> 
> 赞同：1
> 
> 时间：2009-05-28T10:05:41.237
> 
> 标签：wpf, data-binding, listbox, uielement

我正在研究 a`ListBox`覆盖它`ItemsPanelTemplate`以使用 a`Canvas`而不是 a `StackPanel`。 `ListBoxItems`有一个`DataTemplate`使用转换器来定义每个`ListBoxItem`在画布上的外观和位置。当我将一个项目添加到绑定到的集合中`ListBox`时，我希望能够将其他`UIElement`s 添加到画布中。我可以在`ListBoxItem`'s 转换器之外完成此操作吗？

我的资源部分是这样的：

```
 <Style TargetType="ListBox">
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <Canvas x:Key="cnvAwesome">

                    </Canvas>
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="ListBoxItem">
        <Setter Property="Canvas.Left" Value="{Binding Path=Position.X}" />
        <Setter Property="Canvas.Top" Value="{Binding Path=Position.Y}" />
    </Style> 
```

和一个列表框：

```
 <ListBox x:Name="lstAwesome" ItemsSource="{Binding Source={StaticResource someCollection}}"/> 
```

ListBox 绑定到的集合：

```
public ObservableCollection<SomeType> someCollection {get; set; } 
```

因此，如果我有一种方法可以将项目添加到 ListBox lstAwesome 绑定到的集合 someCollection 中：

```
private void AddItemToDataboundCollection(SomeType someItem)
{
    someCollection.Add(someItem)
    // I'd like to add a UIElement to the canvas that the ListBox uses to layout items here.
} 
```

那么，我可以将 UIElements 添加到数据绑定列表框用于 ItemsPanel 的画布中吗？以编程方式，当我将项目添加到 ListBox 绑定到的集合中时？

我将不胜感激任何输入！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:48:03.297

我认为您在问题中已准备好将项目添加`Canvas`到`ListBox`. 我只是使用您问题中的代码组合了一个简单的 WPF 测试应用程序，它就可以正常工作。每当我将项目添加到`ObservableCollection`绑定到 的`ItemsSource`时`ListBox`，WPF 都会为该对象创建一个`ListBoxItem`，并且基于 的样式`ListBoxItem`，该项目将由`Canvas`.

您是否无法使您的代码正常工作？如果是这种情况，您得到了什么错误，或者什么没有按您的预期工作？

**编辑**：再次阅读问题后，我认为混淆是由于对 WPF 绑定如何工作的误解。当您将集合绑定到`ListBox`'s`ItemsSource`时，您需要做的就是将项目添加到该集合（假设集合实现了`INotifyCollectionChanged`）`ObservableCollection`。WPF 订阅该接口提供的事件，并`ListBoxItems`根据对列表所做的更改创建/销毁。

**编辑2**：虽然最好为此使用 a `DataTemplate`，以便在将项目添加到集合时自动添加该行，但我不确定如何获得先前添加的项目的位置，以便线将从正确的位置开始。

一种可行的选择是子类`Canvas`化，并将其设置`ItemsPanelTemplate`为`ListBox`. 我相信它有一个你可以重写的函数，只要添加一个控件就会调用它。在该函数中，您可以获得先前添加的控件的位置（将缓存在您的`Canvas`子类中），然后将线控件添加到`Canvas`直接的控件中。这确实假设控件中的位置`Canvas`不能改变。如果可以，您可能必须订阅对象的`PropertyChanged`事件并相应地更新行。

**编辑 3**：由于您的要求，绑定似乎不是一个选项，因此最不坏的选择是直接添加孩子。您可以通过使用[VisualTreeHelper.GetChild()](http://msdn.microsoft.com/en-us/library/system.windows.media.visualtreehelper.getchild.aspx)搜索可视化树来做到这一点：

```
private T FindChild<T>(FrameworkElement parent, string name)
    where T : FrameworkElement
{
    FrameworkElement curObject = null;
    T obj = default(T);
    int count = VisualTreeHelper.GetChildrenCount(parent);
    for(int i = 0; i < count; i++)
    {
        curObject = VisualTreeHelper.GetChild(parent, i) as FrameworkElement;
        obj = curObject as T;
        if(null != obj && obj.Name.Equals(name))
        {
            break;
        }

        obj = FindChild<T>(curObject, name);
        if(null != obj)
        {
            break;
        }
    }

    return obj;
} 
```

像这样使用它：

```
Canvas canvas = FindChild<Canvas>(lstAwesome, "cnvAwesome"); 
```

此代码递归地在可视树中搜索`parent`指定类型和名称的控件。最好`DependencyObject`在`FrameworkElement`此处使用（因为这是由 . 返回的内容`VisualTreeHelper.GetChild()`），但`Name`仅在`FrameworkElement`.

如果你想变得花哨，你甚至可以把它作为一个扩展方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:23:34.910

您可以通过设置 来指定项目的显示方式`ItemTemplate`，例如：

```
<ListBox.ItemTemplate>
    <DataTemplate>
        <Rectangle Width="{Binding Width}" Height="{Binding Height}" />
    </DataTemplate>
</ListBox.ItemTemplate> 
```

如果您希望`ItemTemplate`根据您的项目进行更改，那么您可以设置`ItemTemplateSelector`并决定`ItemTemplate`以编程方式使用哪个。

# java - 从 Swings 组件中删除不必要的空格

> ID：920140
> 
> 赞同：1
> 
> 时间：2009-05-28T10:11:02.550
> 
> 标签：java, swing, jpanel

我有 3 个 JPanel，第一个是基本面板，另外两个添加到第一个。我已经意识到有很多空间没有使用，由组件周围的黑色和白色显示。

你如何删除这个空间？

[![替代文字](https://i.stack.imgur.com/osUGz.png)](https://i.stack.imgur.com/osUGz.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T10:20:44.777

如果您使用的是 GridLayout 或 BorderLayout ，它们都具有更改组件之间空间的方法。

在 GridLayout 中，这可以在 4 个 int 参数构造函数中完成，而在 BorderLayout 中，可以在 2 个 int 参数构造函数中完成。两个 LayoutManager 都有方法 setHgap 和 setVgap。

如果您使用的是 GridBagLayout，您需要确保将 GridBagConstraints 上的插图更改为您需要的任何内容。不过，猜测您正在使用其他经理之一。

# c# - Windows CE 文本框焦点问题

> ID：920142
> 
> 赞同：0
> 
> 时间：2009-05-28T10:11:31.473
> 
> 标签：c#, compact-framework, focus, windows-ce

我在将焦点设置回文本框时遇到问题。我在 Windows Ce 和 Windows Mobile 5 上都运行相同的应用程序，但问题仅在 WinCE 上。在表单上，​​我有一个自定义控件（假设是自定义 DropDown）和一个文本框，在自定义控件中选择了一个项目后，我想将焦点传递回文本框。

代码如下所示：

```
private void ddlCurrencyList_SelectedItemChanged(object sender, SelectedItemArgs e)
{
    _selectedCurrency = CurrencyCollection.Find(ddlCurrencyList.SelectedValue);
    txtTabValue.Focus(); //does not work on Win CE. 
} 
```

我不知道是什么偷走了对 WinCe 的关注。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T14:25:35.530

我猜想该列表在调用事件后重新获得焦点。也许在一个单独的线程中调用对*txtTabValue.Focus()*的调用会有所帮助，该线程只等待几毫秒，然后在表单的线程上下文中调用*txtTabValue.Focus() ？*似乎有点过头但可能会起作用 - 使用 Compact Framework 时会发生奇怪的事情;-)

# asp.net - 在 Gridview 中标记 ItemTemplate

> ID：920143
> 
> 赞同：0
> 
> 时间：2009-05-28T10:12:15.887
> 
> 标签：asp.net

我想在 Gridviews ItemTemplate 上只显示 100 个字符。当我单击编辑按钮时，我想使用 EditItemTemplate 显示所有绑定值。

```
<ItemTemplate>

<asp:Label ID="Label2" runat="server" Text='<%# Bind("Address") %>'> </asp:Label>

</ItemTemplate> 
```

如何将标签文本限制为 100 个字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T10:21:02.483

由于您在 ItemTemplate 中工作，因此您实际上并不需要使用 Bind()。您可以改用 Eval() 并进行以下操作：

```
<%# Eval("Address").ToString().Substring(0, 100) %> 
```

这种简单的解决方案有两个问题：

第一个是地址字段为空时，您必须对其进行检查。第二个是如果字符串短于 100 个字符，它也会失败，因为 .NETs Substring() 试图确保您始终获得正好 100 个字符，并且如果字符串较短则抛出异常。因此，您应该添加代码以确保您确实需要剪切字符串。

到现在为止，感觉也许我们应该做一个小辅助方法：

```
public static class Extensions
{
    public static String Limit(this String s, int length)
    {
        if (s == null)
            return String.Empty;

        return s.Substring(0, Math.Min(s.Length, length));
    }
} 
```

然后 Eval 语句将如下所示：

```
<%# ((string)Eval("Address")).Limit(100) %> 
```

（这假设 Address 真的是一个字符串）

# c# - UserControl 中的二维文本框数组

> ID：920149
> 
> 赞同：0
> 
> 时间：2009-05-28T10:14:11.407
> 
> 标签：c#, user-controls

我试图编写一个用户控件，它有一个 10 x 10 网格的文本框、它们之间的键盘导航和键盘增量/减量，然后自定义突出显示取决于我的 coms 模块上的变量。

我的想法是将文本框存储在二维数组中以便于引用。我会以正确的方式解决这个问题吗？还有其他指针吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T10:18:55.547

距离我上一次使用 C# 编写的 GUI 应用程序已经有很长时间了，但如果它与我记忆中的 Java 如此相似，我不会创建 100 个网格框，而是为不同的数据重用相同的显示/编辑器组件的表。 ..

我认为在 Windows 窗体中使用的 MVC 模式与在 Swing 中几乎相同，因此它应该以类似的方式工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T10:28:42.343

它可以工作。

您还应该看看 TableLayoutPanel，它可能会提供很多您需要的布局和导航。您可以使用 GetControlFromPosition(row, col) 从 Tablelayout 中找到一个 Control，但如果您想维护一个不会受到伤害的并行数组。

# xml - 在使用 java 创建 xml 时添加命名空间值

> ID：920153
> 
> 赞同：1
> 
> 时间：2009-05-28T10:15:31.840
> 
> 标签：xml, namespaces

我必须创建类似的xml：

```
<xml version="1.0" encoding="UTF-8"?>
<tns:Message>
  <tns:Header>
    <tns:to>CCM</tns:to>
    <tns:from>CPM</tns:from>
    <tns:type>New</tns:type>
  </tns:Header>
</tns:Message> 
```

从我的java对象。

我正在尝试做这样的事情

```
 DocumentBuilderFactory factory 
               = DocumentBuilderFactory.newInstance();
              factory.setNamespaceAware(true);
              DocumentBuilder builder = factory.newDocumentBuilder();
              DOMImplementation impl = builder.getDOMImplementation();
              Document doc = impl.createDocument(null,"tns:Message", null); 
```

但在最后一行它给了我错误

> “NAMESPACE_ERR：试图以不正确的命名空间方式创建或更改对象。”

但如果我通过“消息”而不是“tns：消息”它工作正常。由于 tns 是我需要使用它的命名空间前缀，我怎样才能使它成为可能。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T10:44:48.770

[http://java.sun.com/j2se/1.4.2/docs/api/org/w3c/dom/DOMImplementation.html#createDocumentType%28java.lang.String,%20java.lang.String,%20java.lang。字符串%29](http://java.sun.com/j2se/1.4.2/docs/api/org/w3c/dom/DOMImplementation.html#createDocumentType%28java.lang.String,%20java.lang.String,%20java.lang.String%29)

查看为 createDocument 提供的第二种方法。

```
public Document createDocument(String namespaceURI,
                           String qualifiedName,
                           DocumentType doctype)
                    throws DOMException 
```

您需要提供一个 uri 来唯一标识命名空间作为第一个参数

# c# - 避免域模型中的循环引用

> ID：920158
> 
> 赞同：7
> 
> 时间：2009-05-28T10:17:07.780
> 
> 标签：c#, .net, design-patterns, domain-driven-design

这一定是一个常见的场景，已经有很多关于它的文章，希望甚至是一个非常好的模式。我有一个域模型，其中自定义容器包含实体。例如（为简洁起见，排除了属性和接口）：

```
class Entity
{
    public int Id;
    public EntityContainer ParentContainer;
}

class EntityContainer
{
    public int Id;
    public IList<Entity> Entities = new List<Entity>();

    public void AddEntity(Entity entity)
    {
        entity.ParentContainer = this;
        Entities.Add(entity);
    }
}

class Main
{
    public Main()
    {
        Entity entity1 = new Entity();
        Entity entity2 = new Entity();
        EntityContainer entityContainer = new EntityContainer();
        entityContainer.AddEntity(entity1);
        entityContainer.AddEntity(entity2);

        // Can now traverse graph easily, e.g.
        Console.WriteLine("entity1's parent container ID = " + entity1.ParentContainer.Id);
        Console.WriteLine("Container contains at least this entity ID: " + entityContainer.Entities[0].Id);

    }
} 
```

我现在可以轻松地以两种方式遍历我的对象图，但创建了一个循环引用。你会创建第三种类型来分离依赖关系吗？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T10:37:30.517

循环引用本身并没有什么问题，它们在 .NET Framework 中被广泛使用，例如 XmlNode.OwnerDocument、Control.Parent。

如果您需要向上遍历树，则可以使用反向引用。

在 COM 中，循环引用很棘手，因为如果您将容器及其所有子项设置为空，那么对象将无法正确清理，因为子项仍持有对父项的引用。然而，.NET 垃圾回收的实现方式对此没有任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T10:30:18.143

容器是否需要知道内容的*类型*？如果没有，泛型可以避免这种情况——即`Container<T>`，你*碰巧*使用`Container<Entity>`. 除此之外; 将必要的细节推送到程序集中的接口（或基类）中，两者都可以引用是一种常见的方法。

就个人而言，我会尽量避免让孩子了解父母的需要。

还; 请注意，如果您*确实*走抽象（接口等）路线；如果您使用（例如）xml 序列化，这可能会产生很大的影响。

* * *

（编辑重新评论）好的；第一：循环引用（在程序集中）导致了什么问题；如果没有，不要管它。如果有问题，那么您将需要一个额外的类型；大概是一些表示具体类型的接口 - 即 where `Entity : IEntity`，并且`EntityContainer`只知道`IEntity`（或 vv 与`IEntityContainer`，或两者），

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T11:44:04.983

因此，我认为您的班级模型没有问题，但您可以轻松做出清晰的剪裁。使 Entity 实现一个接口 IEntity 并使 EntityContainer 持有一个 IList，除非您有使用 IList 的非常具体的原因，否则您应该考虑 IEnumerable，这将使您使用的 EntityClass 的使用者更容易。由于传递任何 IEntity 数组或 linq 表达式选择 IEntities 都是可能的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-03T10:54:35.703

如果您在设计这些对象时使用某种延迟加载模式，那么在我的书中使用循环引用对象是可以的。

例如

您要访问：***Company.Employee*** 在另一种情况下：***Employee.Company***

这使得循环引用即***Company.Employee.Company.Employee***等。

如果这些属性不是延迟加载的，例如，Company 对象总是加载它的 Employee 属性，而 Employee 对象总是加载它的 Company 属性，那么当你引入数据源时它就不会工作得很好。

# c# - 菜单合并引用（.dll 和 .exe）

> ID：920162
> 
> 赞同：0
> 
> 时间：2009-05-28T10:17:32.927
> 
> 标签：c#, merge, mdi

在尝试与 Mdi 合并菜单时，我偶然发现了一个不寻常的问题。基本上，我有一个我在一个解决方案中创建的 MdiParent 表单，它将是我在其他项目和解决方案中创建的各种 MdiChild 表单的父级，这也将在 MdiParent 项目中引用，参考将是每个 mdi 子窗体类型的 .exe。

我已经测试了我正在使用但在同一个项目中的属性，并且菜单合并在 MdiChild 和 Parent 之间完美运行。但是，当我使用相同的合并代码但在我引用了包含我的 MdiChild 的项目的 .exe 的实例中时，我没有成功。我想知道是否有解决方法？或者一个解决方案。

我引用 .exe 的原因是因为它们是可以独立的项目，并且不仅由我创建的 MdiParent 表单使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-29T07:51:50.230

我有一个类似的问题，我相信它与加载到单独的应用程序域的对象类型有关，然后使它们成为不同的类型（这里可能是错误的......）

你有没有想过让父母/孩子在一个单一的类库中，让你的其他项目引用它？

# c# - 如何知道表单的消息框何时显示？

> ID：920164
> 
> 赞同：2
> 
> 时间：2009-05-28T10:17:56.843
> 
> 标签：c#, forms

在我的应用程序中，我有一个在后台线程上运行的任务。当 UI 线程中显示 MessageBox 或任何模式对话框时，我需要在后台线程中发出通知。

虽然我可以通过在显示 MessageBox 之前调用一些函数来手动完成，但如果我不必这样做会很棒。

例如：

```
backgroundThread.MessageShown(); // I do not want to call this explicitly every time!
MessageBox.Show("Task halted!"); 
```

我猜可能有一些信息可以吸引我。即使在主 GUI 线程中，是否有任何消息/事件在显示模式对话框之前被触发？

好的，这里是要求。我有一些在 UI 线程上完成的任务，我必须在单独的对话框上显示进度，该对话框显示在工作线程上。我知道应该是必须在工作线程上完成的任务，但目前的情况暂时无法改变。

一切正常，除了一个小故障 - 如果 UI 线程中显示消息框，它会隐藏在进度对话框下方。所以用户永远不会知道 UI 正在等待输入。我需要一种方法来获取已显示模式对话框的通知，并且我应该隐藏进度对话框。

现在，我必须在每次调用 MessageBox 之前明确隐藏它。

我希望这能解释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T06:19:00.393

设置[CBT 挂钩](http://msdn.microsoft.com/en-us/library/ms644977(VS.85).aspx)。然后您将收到所有创建、激活、停用和销毁的窗口的通知。然后使用 GetWindowClass 检查创建/激活的 hWnd 是否实际上是 MessageBox。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T10:22:59.173

创建自己的消息框，在调用 Show 时触发事件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T06:22:07.160

如果您的 MessageBox 的父级是 TopMost，那么您的 MessageBox 将是 TopMost。所以，像...

```
MessageBox.Show( new Form() { TopMost = true }, "Message and so forth ..." ); 
```

这也可能对你有用......

```
DllImport("user32.dll")]
public static extern int MessageBox(int hWnd, String text, String caption, uint type); 
```

并将[MB_TOPMOST](http://msdn.microsoft.com/en-us/library/ms645505(VS.85).aspx)作为类型传递。

# git - 如何提取 git 子目录并从中制作子模块？

> ID：920165
> 
> 赞同：123
> 
> 时间：2009-05-28T10:18:41.927
> 
> 标签：git, git-submodules

几个月前我开始了一个项目，并将所有内容都存储在一个主目录中。在我的主目录“Project”中有几个包含不同内容的子目录： Project/paper 包含用 LaTeX 编写的文档 Project/sourcecode/RailsApp 包含我的 rails 应用程序。

“项目”是 GITified，并且在“paper”和“RailsApp”目录中都有很多提交。现在，由于我想为我的“RailsApp”使用 Cruisecontrol.rb，我想知道是否有一种方法可以在不丢失历史记录的情况下从“RailsApp”中创建一个子模块。

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2009-08-20T18:22:10.333

现在有一种比手动使用 git filter-branch 更简单的方法：[git subtree](http://github.com/apenwarr/git-subtree)

# 安装

**NOTE** `git-subtree`现在是 1.7.11 的一部分`git`（如果你安装了 contrib），所以你可能已经安装了它。您可以通过执行来检查`git subtree`。

* * *

从源代码安装 git-subtree（对于旧版本的 git）：

```
git clone https://github.com/apenwarr/git-subtree.git

cd git-subtree
sudo rsync -a ./git-subtree.sh /usr/local/bin/git-subtree 
```

或者，如果您想要手册页和所有

```
make doc
make install 
```

# 用法

将较大的块拆分为较小的块：

```
# Go into the project root
cd ~/my-project

# Create a branch which only contains commits for the children of 'foo'
git subtree split --prefix=foo --branch=foo-only

# Remove 'foo' from the project
git rm -rf ./foo

# Create a git repo for 'foo' (assuming we already created it on github)
mkdir foo
pushd foo
git init
git remote add origin git@github.com:my-user/new-project.git
git pull ../ foo-only
git push origin -u master
popd

# Add 'foo' as a git submodule to `my-project`
git submodule add git@github.com:my-user/new-project.git foo 
```

有关详细文档（手册页），请阅读`git-subtree.txt`.

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-05-30T17:28:55.003

结帐[git filter-branch](http://git-scm.com/docs/git-filter-branch)。

手册页的[`Examples`部分](http://git-scm.com/docs/git-filter-branch#_examples)显示了如何将子目录提取到它自己的项目中，同时保留它的所有历史记录并丢弃其他文件/目录的历史记录（正是您要查找的内容）。

> 要重写存储库，使其看起来好像`foodir/`是其项目根目录，并丢弃所有其他历史记录：
> 
> ```
>  git filter-branch --subdirectory-filter foodir -- --all 
> ```
> 
> 因此，例如，您可以将库子目录转换为它自己的存储库。
> 请注意将选项与修订选项分开，以及`--`重写所有分支和标签。`filter-branch``--all`

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-30T18:29:23.333

这样做的一种方法是相反的 - 删除除您要保留的文件之外的所有内容。

基本上，**制作存储库的副本**，然后用于[`git filter-branch`](http://git-scm.com/docs/git-filter-branch)删除除要保留的文件/文件夹之外的所有内容。

例如，我有一个项目，我希望从中提取文件`tvnamer.py`到一个新的存储库：

```
git filter-branch --tree-filter 'for f in *; do if [ $f != "tvnamer.py" ]; then rm -rf $f; fi; done' HEAD 
```

这用于`git filter-branch --tree-filter`完成每个提交，运行命令并重新提交生成的目录内容。这是极具破坏性的（因此您应该只在存储库的副本上执行此操作！），并且可能需要一段时间（在具有 300 个提交和大约 20 个文件的存储库上大约需要 1 分钟）

上面的命令只是在每个修订版上运行以下 shell 脚本，您当然必须修改它（使其排除您的子目录而不是`tvnamer.py`）：

```
for f in *; do
    if [ $f != "tvnamer.py" ]; then
        rm -rf $f;
    fi;
done 
```

最大的明显问题是它会留下所有提交消息，即使它们与剩余文件无关。脚本[git-remove-empty-commits](http://github.com/jwiegley/git-scripts/blob/master/git-remove-empty-commits)修复了这个..

```
git filter-branch --commit-filter 'if [ z$1 = z`git rev-parse $3^{tree}` ]; then skip_commit "$@"; else git commit-tree "$@"; fi' 
```

您需要使用`-f`force 参数`filter-branch`再次运行任何内容`refs/original/`（基本上是备份）

当然，这永远不会是完美的，例如，如果您的提交消息提到其他文件，但它大约是 git 当前允许的（据我所知）。

**同样，只在您的存储库的副本上运行它！**- 但总而言之，要删除除“thisismyfilename.txt”以外的所有文件：

```
git filter-branch --tree-filter 'for f in *; do if [ $f != "thisismyfilename.txt" ]; then rm -rf $f; fi; done' HEAD
git filter-branch -f --commit-filter 'if [ z$1 = z`git rev-parse $3^{tree}` ]; then skip_commit "$@"; else git commit-tree "$@"; fi' 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-02-18T20:28:42.147

CoolAJ86和[apenwarr](https://stackoverflow.com/a/17864475/228738)[的](http://stackoverflow.com/a/1307969/2227298)答案都非常相似。我在两者之间来回走动，试图理解其中任何一个都缺少的部分。下面是它们的组合。

首先将 Git Bash 导航到要拆分的 git repo 的根目录。在我的例子中`~/Documents/OriginalRepo (master)`

```
# move the folder at prefix to a new branch
git subtree split --prefix=SubFolderName/FolderToBeNewRepo --branch=to-be-new-repo

# create a new repository out of the newly made branch
mkdir ~/Documents/NewRepo
pushd ~/Documents/NewRepo
git init
git pull ~/Documents/OriginalRepo to-be-new-repo

# upload the new repository to a place that should be referenced for submodules
git remote add origin git@github.com:myUsername/newRepo.git
git push -u origin master
popd

# replace the folder with a submodule
git rm -rf ./SubFolderName/FolderToBeNewRepo
git submodule add git@github.com:myUsername/newRepo.git SubFolderName/FolderToBeNewRepo
git branch --delete --force to-be-new-repo 
```

下面是上面的副本，其中替换了可自定义的名称并使用 https 代替。根文件夹现在是`~/Documents/_Shawn/UnityProjects/SoProject (master)`

```
# move the folder at prefix to a new branch
git subtree split --prefix=Assets/SoArchitecture --branch=so-package

# create a new repository out of the newly made branch
mkdir ~/Documents/_Shawn/UnityProjects/SoArchitecture
pushd ~/Documents/_Shawn/UnityProjects/SoArchitecture
git init
git pull ~/Documents/_Shawn/UnityProjects/SoProject so-package

# upload the new repository to a place that should be referenced for submodules
git remote add origin https://github.com/Feddas/SoArchitecture.git
git push -u origin master
popd

# replace the folder with a submodule
git rm -rf ./Assets/SoArchitecture
git submodule add https://github.com/Feddas/SoArchitecture.git
git branch --delete --force so-package 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-28T10:29:55.603

如果您想将某些文件子集传输到新的存储库但保留历史记录，那么您基本上会得到一个全新的历史记录。这将工作的方式基本上如下：

1.  创建新的存储库。
2.  对于旧存储库的每个修订，将对模块的更改合并到新存储库中。这将创建您现有项目历史的“副本”。

如果您不介意编写一个小而多毛的脚本，那么自动化它应该有点简单。直截了当，是的，但也很痛苦。人们过去在 Git 中做过历史重写，你可以搜索一下。

**或者：**克隆存储库，并删除克隆中的论文，删除原始中的应用程序。这将需要一分钟，它可以保证工作，而且你可以回到比试图净化你的 git 历史更重要的事情上。并且不用担心冗余历史副本占用的硬盘空间。

# c# - ASP.NET 的标签框中不显示标签内文

> ID：920166
> 
> 赞同：0
> 
> 时间：2009-05-28T10:18:42.880
> 
> 标签：c#, .net

```
protected void Button1_Click(object sender, EventArgs e)
{
string a;
a = "vimal < kumar>";        
Label1.Text = a;
} 
```

输出：

```
vimal 
```

`Tag( <ABCDE> )`内部文本为什么不显示在标签框（ASP.NET）中，

实际结果是`vimal <kumar>` 唯一`vimal`显示的，标签内部文本不显示

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T10:26:18.777

您必须使用字符串的 html 编码变体。HtmlEncode 可以解决问题。

（还有用于编码 Url 的 UrlEncode）

```
 Dim test = "This is an <little>test</little>"
 test = HttpUtility.HtmlEncode(test) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T10:19:59.647

因为 < 和 > 一起是 HTML 标签。如果您不想隐藏它们，则需要使用它们的 ascii 表示。

# wpf - 如何使用 DelegateCommand 将信息从 View 传递到 ViewModel？

> ID：920172
> 
> 赞同：13
> 
> 时间：2009-05-28T10:21:01.173
> 
> 标签：wpf, mvvm, delegatecommand

在我看来，我有一个按钮。

当用户单击此按钮时，我希望 ViewModel 将 TextBlock 的上下文保存在数据库中。

```
<StackPanel HorizontalAlignment="Left" VerticalAlignment="Top">
    <TextBlock Text="{Binding FirstName}"/>
    <TextBox Text="Save this text to the database."/>
    <Button Content="Save" Command="{Binding SaveCommand}"/>
</StackPanel> 
```

但是，在我的 ViewModel 中的 DelegateCommand 中，“Save()”方法不传递任何参数，那么我该如何从视图中获取数据呢？

```
#region DelegateCommand: Save
private DelegateCommand saveCommand;

public ICommand SaveCommand
{
    get
    {
        if (saveCommand == null)
        {
            saveCommand = new DelegateCommand(Save, CanSave);
        }
        return saveCommand;
    }
}

private void Save()
{
    TextBox textBox = ......how do I get the value of the view's textbox from here?....
}

private bool CanSave()
{
    return true;
}
#endregion 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-28T10:28:15.433

查看[Josh Smith 的这篇 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)。在其中，他展示了他称为 RelayCommand 的 DelegateCommand 的变体，并且 RelayCommand 上的 Execute 和 CanExecute 委托接受对象类型的单个参数。

使用 RelayCommand，您可以通过 CommandParameter 将信息传递给代表：

```
<Button Command="{Binding SaveCommand}" 
        CommandParameter="{Binding SelectedItem,Element=listBox1}" /> 
```

**更新**

查看[这篇文章](http://msdn.microsoft.com/en-au/library/ff921102.aspx)，似乎有一个通用版本的 DelegateCommand 以类似的方式接受参数。您可能想尝试将 SaveCommand 更改为 a`DelegateCommand<MyObject>`并更改 Save 和 CanSave 方法，以便它们采用 MyObject 参数。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-09-03T15:13:46.833

这是优雅的方式。

为您的文本框命名，然后将按钮中的 CommandParameter 绑定到它的 Text 属性：

```
<StackPanel HorizontalAlignment="Left" VerticalAlignment="Top">
    <TextBlock Text="{Binding FirstName}"/>
    <TextBox x:Name="ParameterText" Text="Save this text to the database."/>
    <Button Content="Save" Command="{Binding SaveCommand}"
            CommandParameter="{Binding Text, ElementName=ParameterText}"/>
</StackPanel> 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-28T17:41:14.170

在您的虚拟机中：

```
private DelegateCommand<string> _saveCmd = new DelegateCommand<string>(Save);

public ICommand SaveCmd{ get{ return _saveCmd } }

public void Save(string s) {...} 
```

在你的视图中，像马特的例子一样使用 CommandParameter。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-28T17:59:25.710

您正在询问通过按钮命令传递数据。

我认为，您真正想要的是将文本框的文本**绑定**到ViewModel 中的**公共属性：**

```
<!-- View: TextBox's text is bound to the FirstName property in your ViewModel -->
<TextBox Text="{Binding Path=FirstName}" />
<Button Command="{Binding SaveCommand}"/>

<!-- ViewModel: Expose a property for the TextBox to bind to -->
public string FirstName{ get; set; }
...
private void Save()
{
    //textBox's text is bound to --> this.FirstName;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-14T14:28:19.133

我想我还不允许发表评论。我正在回应 Carlos 的建议，因为我已经尝试过了。虽然这是一个好主意，但 DelegateCommand 需要以某种方式进行修改，否则您将收到此错误：字段初始值设定项无法引用非静态字段、方法或属性“MyViewModel.Save(string)”。

# version-control - 使用 Sourcesafe 2005 强制其他人的文件签入

> ID：920176
> 
> 赞同：5
> 
> 时间：2009-05-28T10:21:57.473
> 
> 标签：version-control, visual-sourcesafe

我的一位同事离开了公司并带走了他的电脑！

他的一些工作已经签出。

有没有办法在不访问他的电脑的情况下签入他的工作？

这是使用 Sourcesafe 2005。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T10:35:48.477

您无法取回他的更新 - 它们已随他的 PC* 而消失。

您可以使用 VSS admin 撤消他的签出，以便您可以继续处理文件。

*除非你有备份。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T10:29:27.863

您可以从 VSS 管理员那里重置他的密码。之后，您可以使用帐户登录并“签入”或撤消签出文件。但请理解，这并不意味着 VSS 会自动从他的 PC 上获取他所做的工作......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T10:27:41.550

不，您唯一能做的就是恢复到最新的签入文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T10:30:42.497

不，因为修改后的文件只存在于他的 PC 上——您无权访问。

您可以恢复编辑的唯一方法（除了要求您的同事返回可能是公司财产的东西）是如果您也将编辑备份到服务器。

我们在我们工作的一家公司这样做是为了防止盗窃。

同样，正如其他人指出的那样，您可以通过管理选项取消结帐。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-01T10:28:42.890

您可以通过访问 VSS 服务器很好地做到这一点。在 VSS 服务器中打开 VSS 管理控制台。在那里你可以重置那个人的密码。然后打开 VSS 客户端并使用他的用户名和密码登录。然后你就可以做任何事了！！！

# struts2 - 在struts2中不传递对象的情况下，getter值可以从动作流到dao类吗

> ID：920196
> 
> 赞同：0
> 
> 时间：2009-05-28T10:30:42.433
> 
> 标签：struts2

我正在研究 struts2 应用程序。我的动作课中有getter/setter。现在，我将我的动作类（比如 Action.java）的对象作为某个方法的参数发送到 DAO 类（比如 Dao.java）。一切都很好，我在我的 Dao.java 中获得了所有吸气剂的价值。现在，我想在不创建 Action.java 的对象并将其发送到 Dao.java 的情况下完成这一切。 **简单地问一下，是否可以在不传递 Action.java 的对象的情况下在 Dao.java 中获取 action class-getter 方法的值？**

请建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T11:59:37.997

你为什么想做那样的事情？

我想您正在从 html 表单填充操作字段，而不是将此操作用作 DAO 的数据传输对象。这不是很好的设计恕我直言。

如果您正在寻找更清洁的解决方案，那么使用**`ModelDriven`**行动会更好。您的操作将实现`ModelDriven<YourModel>`包含`YourModel`所有数据字段的接口。Struts2 会自动将字段从 html 表单填充到`YourModel`. 然后你可以传递`YourModel`给 DAO。

# windows - 为什么 ruby 在 Windows 上这么慢？

> ID：920201
> 
> 赞同：41
> 
> 时间：2009-05-28T10:32:31.523
> 
> 标签：windows, ruby

Ruby 在 Windows 上运行如此缓慢的具体技术原因是什么？人们报告说 Linux/OSX 速度下降了 3 倍，并且有一些关于 Ruby 使用 Windows 版本的编译器产生缓慢代码的模糊讨论，但我找不到任何具体细节。

有人知道具体情况吗？我对 hurf durf Windoze 糟透了不感兴趣。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-02T10:21:25.183

我想有几个可能的选择，它们可能都加起来：

1.  Ruby 主要在 Linux 上开发，最终为它进行了机械优化。该代码定期针对 Windows 进行测试，一切正常，但结果仍然是开发人员将花费更多时间针对 Linux 进行优化而不是 Windows。
2.  根据我的经验，最新版本的 gcc（4.3 和更高版本）生成的代码比最新版本的 Visual Studio（至少 2005 年）更有效。我的测试包括在这两种情况下花费大约一天的时间来寻找代码优化的最佳选择。
3.  与第 1 点相关，如果您使用 gcc for Windows 或 Linux 编译相同的项目，我通常观察到与 Linux 相比，Windows 上的性能下降约 20%。再说一次，我想这是因为 Linux（或一般的 Unices）是 gcc 的主要目标，Windows 是一个端口。与 Linux 相比，为 Windows 优化所花费的时间更少。

最后，如果想要为 Windows 优化 Ruby，则必须花费大量时间（和金钱，据我所知，Windows 上的分析器不是免费提供的）将不得不花费在使用分析器和优化瓶颈上. 一切都必须在 Linux 上进行测试，以确保没有性能损失。

当然，所有这些都应该用他们的新解释器 [YARV](http://wikipedia.org/wiki/YARV)再次测试。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-05T23:09:37.157

I've not done much work with the source code of the YARV interpreter, so the following comments pertain only to the 1.8.6 MIR interpreter.

In the course of trying to write a C extension for Ruby in Visual Studio, I discovered to my horror that the downloadable Windows binaries of Ruby 1.8.6 are compiled using Visual C++ 6.0, which was released shortly after the end of the Second World War. Since then compilers (and the processors they target) have advanced considerably. While the Linux builds get the latest gcc goodness, the Windows build limps along with last century's compiler technology. That's one reason. (Disclaimer: supposedly 1.9 is to be built with mingw, of which I am not a fan, but which also must be better than VC6)

Without knowing what ops in particular you find slower on Windows it's hard to comment further, but I will note that I found the I/O implementation on Ruby to be considerably less performant with both network and local file I/O. I never delved into the implementation of the I/O primitives enough to see why, but I assume the implementations assume the fast IO constructs on Linux are the fast IO constructs on Windows, which is almost always not the case.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-04T22:05:26.737

不完全是你的问题，但在[Deep Fried Bytes 播客](http://deepfriedbytes.com/)上有一个很好的讨论，在 IronPython 上下文中讨论了同样的问题。我了解您的问题与 Ruby 有关，但可能存在也会影响 Ruby 的相关问题。

此外，该讨论做得比“Windows 糟透了”更深入一些，因此值得一试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-31T14:54:08.100

首先，您需要区分较旧的[MRI 解释器](http://en.wikipedia.org/wiki/Ruby_MRI)（最高 1.8 版本）和较新的[YARV](http://en.wikipedia.org/wiki/YARV)，它是 Ruby 1.9 的官方解释器。Ruby 1.9 有很大的性能改进和不同的设计，所以你需要知道你在谈论哪个版本。我猜你看到的应该是 1.8.x 版本，它是目前唯一一个一键安装的版本。

此外，很高兴知道您是在谈论 Ruby on Rails 性能还是一般的 Ruby。我知道这两者之间应该有明显的区别，但是因为 Ruby on Rails 是 Ruby 的主要用途，所以人们经常谈论它的性能，就好像他们在谈论 Ruby 的性能一样。

至于编译器，可以使用任何最新版本的 Visual Studio 构建 Ruby，这非常好。我想如果确实存在这样的性能差异，那么应该查看解释器的实现，看看是否有什么东西会在 POSIX 和 Windows 系统之间产生差异。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T10:30:22.593

性能提升不是 300%，一般来说，它更接近 50%-100%。随意 Jim 的解释是与 Unix 变体和 Linux 相比，Windows 上的数据处理脚本速度较慢的原因之一。

在更一般的情况下，我唯一能想到的是 Ruby 开发是以 Linux 为中心的，这导致了 Ruby 构建方式中的许多 Unix 主义。此外，由于大多数活跃的开发人员都不是 Windows 用户，因此团队中几乎没有 Windows 优化专业知识，并且大多数性能优化决策都集中在 Unix 系统上使事情变得更快。

一个具体的例子是 Ruby 使用写时复制参数传递，根据我的阅读，这在 Windows 上无法正确完成，导致方法调用的大量开销。

不过，我似乎无法弄清楚，Casual Jim 做了什么值得-8 票。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-12T17:00:22.803

Windows 上的 ntfs 自动文件压缩对我来说减慢了一切。当您的高清空间不足时，它会自动开始工作......然后它需要在您访问文件时即时解压缩和重新压缩文件，浪费 cpu 周期......

运行以下命令从根目录（即“C:\”）解压缩整个 ntfs 驱动器，看看是否有任何差异，对我来说，它产生了巨大的差异，并使 ruby​​/rails 速度恢复到我以前习惯的速度！

命令是：

```
compact /u /s /i 
```

# javascript - 为什么这个函数总是返回'undefined'

> ID：920206
> 
> 赞同：1
> 
> 时间：2009-05-28T10:36:19.333
> 
> 标签：javascript, google-maps

```
function getLongLat(address)
{
geocoder = new GClientGeocoder();
if (geocoder) {
       geocoder.getLatLng(address,
         function(point) {
           if (!point) {
             return "null";
           } else {          
         return point;
           }
         }
       );
     }
} 
```

如果我把 alert(point) 放进去，我会得到经度和纬度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T10:39:06.147

试试这个：D

```
function getLongLat(address)
{
        geocoder = new GClientGeocoder();
        if (geocoder) {
           return geocoder.getLatLng(address,
             function(point) {
               if (!point) {
                return "null";
               } else {          
                    return point;
               }
             }
           );
        }
        return false;
 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T10:46:51.217

这是因为您的函数没有返回语句。

作为参数调用的内部函数`geocoder.getLatLng`确实有一个返回语句，这让你感到困惑。我建议您提取内部​​函数以减少令人困惑的方面。

尝试这个：

```
function convert_to_null_if_falsy(value) {
    return value || "null";
}    

function getLongLat(address) {
    geocoder = new GClientGeocoder();
    return geocoder.getLatLng(address, convert_to_null_if_falsy);
} 
```

我不确定为什么要返回字符串`"null"`而不是`undefined`在回调函数中，但这段代码的作用相同，而且麻烦少了很多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T15:08:02.157

请记住，getLatLng() 是异步的：您传入一个匿名函数，以便它在完成时执行。

在这种情况下，您的 getLongLat() 函数将无法返回 point，因为该匿名函数在完全不同的上下文中异步运行：您的函数将在 Google 的意愿之前执行并返回，并且 point 甚至不在外功能。

您需要调用您想要对该匿名函数内的点进行操作的任何代码：

```
function getLongLat(address)
{
    geocoder = new GClientGeocoder();
    if (geocoder) {
       return geocoder.getLatLng(address,
         function(point) {
           // point is only in scope for this anonymous inner function
           // which is called when your request to Google's service completes
           if (!point) {
              // your error condition if a point isn't found
              // omgMissingPoint(point);
           } else {          
              // your function to process points here.
              // processPoint(point);
           }
         }
       );
    } 
```

}

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T10:38:51.527

如果`geocoder`不是*真的*呢？并且`geocoder.getLatLng`也不返回任何值。

所以让两者都返回一些东西，也许：

```
function getLongLat(address) {
    geocoder = new GClientGeocoder();
    if (geocoder) {
        return geocoder.getLatLng(address, function(point) {
            if (!point) {
                return "null";
            } else {
                return point;
            }
        });
    }
    return "null";
} 
```

# informix - Informix 定义带参数的 INTERVAL

> ID：920207
> 
> 赞同：2
> 
> 时间：2009-05-28T10:37:09.783
> 
> 标签：informix

我在 Informix 中执行以下操作以删除超过 20 秒的行。

```
delete from sometable
where someDateColumn < (current - interval (20) second to second); 
```

但是，我想在存储过程中使间隔可配置，但我做不到

```
CREATE PROCEDURE i_hate_informix (prm_timeframe int)
    DELETE   sometable
    WHERE    someDateColumn < (current - interval (prm_timeframe) second to second);
END PROCEDURE; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T10:46:56.240

我自己找到了答案。

间隔不能用变量动态定义。但是您可以使用“单位秒”，因此我的程序变为

```
CREATE PROCEDURE i_hate_informix (prm_timeframe int)
   DELETE   sometable
   WHERE    someDateColumn < (current - prm_timeframe units second);
END PROCEDURE; 
```

# asp.net - 如何让 SelectedValue 麻烦返回实际选定的值

> ID：920211
> 
> 赞同：1
> 
> 时间：2009-05-28T10:37:56.460
> 
> 标签：asp.net, asp.net-2.0, c#-2.0

我正在使用以下代码块从 xml 文件中的内容填充页面加载的下拉框...

```
foreach (System.Xml.XmlNode item in root.SelectNodes(@"/markers/marker"))
            {
                string tmpValue = item.Attributes["location"].Value + "#" + item.Attributes["lat"].Value + "#" + item.Attributes["lng"].Value;
                destination.Items.Add(new ListItem(item.Attributes["location"].Value, tmpValue));
                tmpNCount++;
            } 
```

然后我有一个按钮，我打算用它来执行搜索。

受保护的无效qsearch_Click（对象发送者，EventArgs e）{

```
try
{
    string httpPath = Convert.ToString(UrlMaker.httpURL());
    //sysmessage.Text = "TEST" + destination.SelectedValue.ToString();
    string[] Split = destination.SelectedValue.ToString().Split(new Char[] { '#' });
    string tmpLocation = Convert.ToString(Split[0]);
    string tmpLat = Convert.ToString(Split[1]);
    string tmpLon = Convert.ToString(Split[2]);
    string tmpRad = radius.SelectedValue.ToString();

    Response.Redirect(httpPath + "search.aspx?func=longlat&country=gbr&lng="+tmpLon+"&lat="+tmpLat+"&rad="+tmpRad+"&txt="+tmpLocation+"&test=1");
}
catch(Exception ex) { Response.Write("Error on Redirect"); } 
```

}

搜索运行，但该死的东西返回下拉菜单中第一项的值，而不是我选择的那个。

我希望在这里遗漏一些非常明显的东西。

谢谢

* * *

## 解决了

消除了单击功能毫无意义并使用了以下内容。

```
if (IsPostBack)
        {

            try
            {
                string fdata = Request.Form["dest"];
                string[] Split = fdata.ToString().Split(new Char[] { '#' });
                    string tmpLocation = Convert.ToString(Split[0]);
                    string tmpLat = Convert.ToString(Split[1]);
                    string tmpLon = Convert.ToString(Split[2]);
                    string tmpRad = radius.SelectedValue.ToString();                
                Response.Redirect(httpPath + "search.aspx?func=longlat&country=gbr&lng=" + tmpLon + "&lat=" + tmpLat + "&rad=" + tmpRad + "&txt=" + tmpLocation + "&test=1");
            }
            catch(Exception ex) { Response.Write("Error on Redirect" + ex.ToString()); }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T10:40:22.773

猜测您正在清除下拉列表并调用您的代码以在每个页面加载时填充它，这将导致第一个项目被选中。

您应该确保此代码在`if(!IsPostBack){ ... }`

# php - 将来自两个不同 wordpress 的帖子合并到一个按日期排序的帖子页面

> ID：920222
> 
> 赞同：1
> 
> 时间：2009-05-28T10:42:50.210
> 
> 标签：php, sql, mysql

拥有对两个 db 的完全访问权限，从两个不同的 wordpress 博客中订购最后十篇文章，按发布日期排序。以本地方式，不使用外部服务（例如使用 sql 和 php）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-20T02:57:56.663

[http://magpierss.sourceforge.net/](http://magpierss.sourceforge.net/)

```
<?php
require_once 'rss_fetch.inc';

$url1 = 'http://yoursite.com/feed/';
$rss1 = fetch_rss($url1);

$url2 = 'http://yourothersite.com/feed/';
$rss2 = fetch_rss($url2);

$rss_items=array_merge($rss1->items,$rss2->items);

// sort / filter items

foreach ($rss as $item ) {
    $title = $item[title];
    $url   = $item[link];
    echo "<a href=$url>$title</a></li><br>
";
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T12:34:21.280

Graeme Lawton上周一在[他的博客上发布了一些模糊的相关内容。](http://graeme.per.ly/perl-to-the-resuce/256)它与在 WordPress MU 安装上创建所有博客的统一视图特别相关，但是，鉴于我对 WordPress MU 的理解，我怀疑用两个完全独立的 WordPress 安装做同样的事情应该非常相似。

（并不是说他真的很详细地说明了他是如何做到的，但我相信如果你问的话，他会愿意分享他的解决方案。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T11:49:32.663

您可以获取两个博客的提要，将它们转换为 PHP 数组，然后按发布日期对该数组进行排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T12:18:42.467

//建立与两个数据库的连接为 $link1 和 $link2

//使用 $link1 执行这个查询 SELECT post_title FROM wp_posts WHERE post_status="publish" ORDER BY Post_Date DESC LIMIT 10

//使用 $link2 在不同的服务器上执行与上面相同的查询

这是数据库模式的链接[http://www.dijksterhuis.org/wp-content/uploads/2008/09/wp_db_schemics_v1_0.png](http://www.dijksterhuis.org/wp-content/uploads/2008/09/wp_db_schematics_v1_0.png)

# java - 如何返回java中最后添加的项目的最后一个主键？

> ID：920225
> 
> 赞同：1
> 
> 时间：2009-05-28T10:43:32.190
> 
> 标签：java, database, methods, primary-key, return

有一个具有双主键的链接（或参考）表。需要返回从选定表中的当前连接自动生成的最后一个主键。这是在java中。如果这有所作为，则该数据库位于 MS Access 中。很抱歉描述得太仓促了，但我们的团队正在紧锣密鼓地工作。

任何链接或建议将不胜感激。

编辑：

使用 SQL 填充数据库。我们为一个表格输入数据，但我们不知道自动生成的数字。需要找出这是什么，以便可以将其输入到 ref 表中。我们只知道一半的复合键，这就是为什么我们需要第二个。

编辑：

迄今为止最好的答案（似乎无法评论）。我收到以下错误...“线程中的异常“AWT-EventQueue-0”java.lang.UnsupportedOperationException”

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T11:06:36.557

Statement.getGeneratedKeys() 应该可以解决问题...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T11:23:30.393

你需要做两件事。首先，在准备语句或执行语句时，您必须传入一个额外的参数。如果您使用准备好的语句，请执行以下操作：

```
stmt = connection.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS); 
```

如果您没有使用准备好的语句，请在调用 executeUpdate() 时执行以下操作：

```
stmt.executeUpdate(sql, Statement.RETURN_GENERATED_KEYS); 
```

执行语句后，您可以调用

```
ResultSet rs = stmt.getGeneratedKeys() 
```

这将为您提供一个包含任何已生成键的结果集。

我没有在 Access 中尝试过这种方法，但它适用于 SQL Server 标识列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T10:46:02.463

将复合键的两个值放入具有两个元素的 Object 数组中并返回。

或者，将新的复合键放入您刚刚保存的实例中并返回它。

# c# - NHibernate 代理导致数据绑定问题

> ID：920227
> 
> 赞同：3
> 
> 时间：2009-05-28T10:43:45.637
> 
> 标签：c#, asp.net, nhibernate, proxy, data-binding

我有一个绑定到 nhibernate 查询结果的 gridview。如果编辑列表中的第一项，则会引发以下异常：

`System.Reflection.TargetException: Object does not match target type`

看来问题是由于数据绑定无法处理列表中的第一项是列表中其他项的子类型这一事实引起的。

解决此问题的好方法/正确方法是什么？目前我不得不关闭 nhibernates 代理。

**编辑：**我还有另外几个解决方案：

*   克隆列表中的所有内容（[http://steve-fair-dev.blogspot.com/2007/08/databind-object-does-not-match-target.html](http://steve-fair-dev.blogspot.com/2007/08/databind-object-does-not-match-target.html)） - 这对我不起作用，因为对象没有'不实现 ICloneable
*   更改列表中项目的顺序，以便代理不是第一个（[http://community.devexpress.com/forums/t/30797.aspx](http://community.devexpress.com/forums/t/30797.aspx)） - 这太老套了，我想我不能弯腰低的！

但是这些都感觉不对……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-08T00:01:22.280

也许为时已晚，但我只想把它扔进戒指，这是我用过的解决方案。

与上面的其他建议一样，它也被称为“SafeBindingList”，但是它不会“克隆”对象来解决问题。它查看列表中的对象，然后如果没有代理，则返回未修改的列表。如果一个或多个对象被代理，它会为非代理对象添加一个空代理，从而使它们都具有相同的类型。

因此，与其返回要绑定的 List[T]，不如使用 SafeBindingList[T] 来确保所有对象都具有相同的类型。

这是针对与 NH2.0.1 一起使用的 Castle 版本的更新： [http ://code.google.com/p/systembusinessobjects/source/browse/trunk/System.BusinessObjects.Framework/Data/SafeBindingLists.cs](http://code.google.com/p/systembusinessobjects/source/browse/trunk/System.BusinessObjects.Framework/Data/SafeBindingLists.cs)

此外，归功于原始代码和海报： [https ://forum.hibernate.org/viewtopic.php?t=959464&start=0&postdays=0&postorder=asc&highlight=](https://forum.hibernate.org/viewtopic.php?t=959464&start=0&postdays=0&postorder=asc&highlight=)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T11:59:58.620

根本原因是由于列表中的代理对象（来自延迟加载）还是因为列表不是同质的（即使它们属于同一类层次结构也包含多种类型）？非同质数据集的问题是一个已知的限制。看到[这个](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=104485)和[这个](https://stackoverflow.com/questions/333163/how-to-bind-a-gridview-to-a-list-of-multiple-types)。

除了不使用数据绑定来填充网格之外，我认为没有其他解决方案。如果它是只读的，那就很容易了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-04T16:35:00.840

Very late, but should help others with the same problem. The solution I used is to wrap a custom list (in this case a NotificationList) around the field in the getter.

```
private IList<IParameter> _parameters = new List<IParameter>();  
get  
{  
    return new NotificationList<IParameter>(_parameters);  
} 
```

This list is a wrapper around the list, so that databinding will be forwarded to the original list.

```
public class NotificationList<T> : IList, IList<T>    
{
    IList<T> myList;
    public NotificationList(IList<T> list)
    {
        myList = list;
    }
    int IList.Add(object item)
    {
        myList.Add ((T) item);
    } 
    // implement both IList<T> and IList
    // ...
} 
```

For me this fixed the issue with the databinding, but created a side effect where every time the session was flushed all the items in the collection get updated in the DB, wether they changed or not. To resolve that, I changed the mapping to access the field directly. See [this](https://forum.hibernate.org/viewtopic.php?f=7&t=998119) on Hibernate, which applies to NHibernate as well.
This is the new (Fluent) mapping:

```
HasMany(x => x.Parameters)
       .Cascade.All()
       .Access.CamelCaseField(Prefix.Underscore); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T10:54:04.570

我不直接在视图中使用我的域对象。相反，我使用 MVVM 模式并创建合适的视图模型来保存非代理对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-04T21:37:33.210

如果您知道您将要对它进行数据绑定，则另一个解决方案是加入获取关系。例如添加 .SetFetchMode("People", FetchMode.Join)。NHibernate 应该只返回域对象，因为它们都不应该被延迟加载。

# winforms - 具有多个滚动条的 .NET WinForms 网格？

> ID：920229
> 
> 赞同：0
> 
> 时间：2009-05-28T10:44:49.970
> 
> 标签：winforms, grid, scrollbars

是否有一个支持多个滚动条的 .NET WinForms 网格，通过将网格分成 N 个部分，水平方向，并且每个部分都有一个滚动条？

例子：

```
|---- Part 1 ---|---- Part 2 ---|---- Part 3 ---|
| Col 1 | Col 2 | Col 1 | Col 2 | Col 1 | Col 2 |
|<****=========>|<****=========>|<****=========>| 
```

这些部分中的每一个都有更多的列，例如 3-6。

那么有人知道这样的网格吗？无需在表单上放置 3 个网格并使用事件处理来同步垂直滚动和行高更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T17:03:58.090

查看[ComponentOne 的 TrueDBGrid](http://www.componentone.com/SuperProducts/TrueDBGridWinForms/)。他们的网格支持水平和垂直拆分，以完全按照您的意图进行。我相信[10Tec 的 iGrid.NET](http://www.10tec.com/home/Products/dotNET/iGrid.NET/index.aspx)也有类似的支持。

# jquery - 如何检测选择器是否返回 null？

> ID：920236
> 
> 赞同：289
> 
> 时间：2009-05-28T10:46:47.813
> 
> 标签：jquery, jquery-selectors

检测 jQuery 选择器是否返回空对象的最佳方法是什么。如果你这样做：

```
alert($('#notAnElement')); 
```

你得到[object Object]，所以我现在的做法是：

```
alert($('#notAnElement').get(0)); 
```

这将写“未定义”，因此您可以检查一下。但这似乎非常糟糕。还有什么其他方法？

* * *

## 回答 #1

> 赞同：512
> 
> 时间：2009-05-28T11:10:02.103

我最喜欢的是用这个小小的便利来扩展 jQuery：

```
$.fn.exists = function () {
    return this.length !== 0;
} 
```

像这样使用：

```
$("#notAnElement").exists(); 
```

比使用长度更明确。

* * *

## 回答 #2

> 赞同：205
> 
> 时间：2009-05-28T10:51:45.480

```
if ( $("#anid").length ) {
  alert("element(s) found")
} 
else {
  alert("nothing found")
} 
```

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2009-05-28T11:06:59.897

选择器返回一个 jQuery 对象数组。如果没有找到匹配的元素，则返回一个空数组。您可以检查`.length`选择器返回的集合或检查第一个数组元素是否为“未定义”。

您可以在 IF 语句中使用以下*任何示例，它们都会产生相同的结果。*如果选择器找到匹配的元素，则为真，否则为假。

```
$('#notAnElement').length > 0
$('#notAnElement').get(0) !== undefined
$('#notAnElement')[0] !== undefined 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2012-06-02T10:21:56.970

我喜欢做这样的事情：

```
$.fn.exists = function(){
    return this.length > 0 ? this : false;
} 
```

那么你可以做这样的事情：

```
var firstExistingElement = 
    $('#iDontExist').exists() ||      //<-returns false;
    $('#iExist').exists() ||          //<-gets assigned to the variable 
    $('#iExistAsWell').exists();      //<-never runs

firstExistingElement.doSomething();   //<-executes on #iExist 
```

[http://jsfiddle.net/vhbSG/](http://jsfiddle.net/vhbSG/)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-02-21T22:44:22.710

我喜欢使用`presence`，灵感来自[Ruby on Rails](http://api.rubyonrails.org/classes/Object.html#method-i-presence)：

```
$.fn.presence = function () {
    return this.length !== 0 && this;
} 
```

您的示例变为：

```
alert($('#notAnElement').presence() || "No object found"); 
```

我发现它优于建议的`$.fn.exists`，因为您仍然可以使用布尔运算符 or `if`，但真实的结果更有用。另一个例子：

```
$ul = $elem.find('ul').presence() || $('<ul class="foo">').appendTo($elem)
$ul.append('...') 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-08-06T20:10:26.183

我的偏好，我不知道为什么这在 jQuery 中还没有：

```
$.fn.orElse = function(elseFunction) {
  if (!this.length) {
    elseFunction();
  }
}; 
```

像这样使用：

```
$('#notAnElement').each(function () {
  alert("Wrong, it is an element")
}).orElse(function() {
  alert("Yup, it's not an element")
}); 
```

或者，正如它在 CoffeeScript 中的样子：

```
$('#notAnElement').each ->
  alert "Wrong, it is an element"; return
.orElse ->
  alert "Yup, it's not an element" 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-05-13T21:29:54.113

这是在 JQuery 文档中：

[http://learn.jquery.com/using-jquery-core/faq/how-do-i-test-whether-an-element-exists/](http://learn.jquery.com/using-jquery-core/faq/how-do-i-test-whether-an-element-exists/)

```
 alert( $( "#notAnElement" ).length ? 'Not null' : 'Null' ); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-29T01:27:01.480

默认情况下，您可能希望一直这样做。我一直在努力包装 jquery 函数或 jquery.fn.init 方法来做到这一点而不会出错，但是您可以对 jquery 源进行简单的更改来做到这一点。包括一些您可以搜索的周边线路。我建议搜索 jquery 源`The jQuery object is actually just the init constructor 'enhanced'`

```
var
  version = "3.3.1",

  // Define a local copy of jQuery
  jQuery = function( selector, context ) {

    // The jQuery object is actually just the init constructor 'enhanced'
    // Need init if jQuery is called (just allow error to be thrown if not included)
    var result = new jQuery.fn.init( selector, context );
    if ( result.length === 0 ) {
      if (window.console && console.warn && context !== 'failsafe') {
        if (selector != null) {
          console.warn(
            new Error('$(\''+selector+'\') selected nothing. Do $(sel, "failsafe") to silence warning. Context:'+context)
          );
        }
      }
    }
    return result;
  },

  // Support: Android <=4.0 only
  // Make sure we trim BOM and NBSP
  rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;

jQuery.fn = jQuery.prototype = { 
```

最后但同样重要的是，您可以在此处获取未压缩的 jquery 源代码：http: [//code.jquery.com/](http://code.jquery.com/)

# .net - Gridview点网布局

> ID：920242
> 
> 赞同：0
> 
> 时间：2009-05-28T10:49:26.017
> 
> 标签：.net, visual-studio-2008, gridview, directshow

我在网格视图中有 7 列。第 7 列包含其他 6 个 50 字的描述。我在哪里可以找到帮助查看如何布置行以便出现 6 个字段，然后第 7 个字段位于其下方。我正在努力寻找模板示例、数据列表视图或网格视图，以显示如何正确布局的示例。Intellisense 对我来说太神秘了。Visual Studio 2008 新手链接到具有 7 列的数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T22:10:02.363

不知道您正在使用什么数据，为什么不尝试使用中继器控件？我在下面为您提供了一个示例：

```
<asp:Repeater ID="R_Data" runat="server">
    <HeaderTemplate>
        <table>
    </HeaderTemplate>
    <ItemTemplate>
        <tr>
            <td><%# Eval("Item 1") %></td>
            <td><%# Eval("Item 2") %></td>
            <td><%# Eval("Item 3") %></td>
            <td><%# Eval("Item 4") %></td>
            <td><%# Eval("Item 5") %></td>
            <td><%# Eval("Item 6") %></td>
        </tr>
        <tr>
            <td colspan="6"><%# Eval("Item 7") %></td>
        </tr>
    </ItemTemplate>
    <FooterTemplate>
        </table>
    </FooterTemplate>
</asp:Repeater> 
```

这将创建类似于以下内容的代码：

```
<table>
    <tr>
        <td>Item 1</td>
        <td>Item 2</td>
        <td>Item 3</td>
        <td>Item 4</td>
        <td>Item 5</td>
        <td>Item 6</td>
    </tr>
    <tr>
        <td colspan="6">Item 7</td>
    </tr>
</table> 
```

这两行将针对您提供给 Repeater 控件的 DataSource 的每一行重复。

```
-------------------------------------------------- -----
| 项目 1 | 项目 2 | 项目 3 | 项目 4 | 项目 5 | 项目 6 |
-------------------------------------------------- -----
| 项目 7 |
-------------------------------------------------- -----
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:05:18.537

不幸的是，我不相信有一种简单的方法可以向每个 GridView 记录添加第二行。

如果您不需要 GridView 提供的内置排序/编辑/删除功能，我可以推荐 ListView 控件吗？这将允许您为每个数据项编写非常具体的 HTML 代码，使您能够为每个数据项创建额外的第二行。

希望这可以帮助！——杰里米

# c# - 你如何处理本地化/CultureInfo

> ID：920244
> 
> 赞同：5
> 
> 时间：2009-05-28T10:49:47.683
> 
> 标签：c#, localization

某些方法（如 string.Format() 或 .Parse()）需要 IFormatProvider。你如何提供它？

*   在封闭环境应用程序中（您知道永远不需要本地化），您是否只是跳过它并调用没有 IFormatProvider 的方法？

*   在可能会本地化的应用程序中，您是否考虑了每个方法调用的正确值并直接设置它？那可能是“CultureInfo.CurrentCulture”或“CultureInfo.CurrentUiCulture”。

*   或者您是否使用诸如“MyUiCultureInfo”和“MyCultureInfo”之类的全局变量来通过更改它们的值来切换本地化？你如何以及在哪里存储这些变量？

*   当我开发库或框架时有什么需要考虑的 - 在这种情况下如何处理本地化？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T10:57:52.737

我总是在我们的 (ASP.NET) 应用程序中将 CurrentThread.Current(Ui)Culture 设置为正确的值。这通常在每个请求开始时完成，基于用户的首选项或存储在配置文件中的默认值（如果用户尚未定义首选项）。

在设置了当前线程的这些属性之后，你就可以停止思考——数字、日期等将被正确格式化/解析，即使没有为这些方法提供 IFormatProvider。否则，您必须确保在任何地方都传递了正确的 IFormatProvider。

我是一个库的情况，我认为它应该只依赖应用程序来处理这些事情，而不必担心这些事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T11:02:57.517

我将当前的文化设置为美国英语，因为在我的国家，很少有“聪明”的人认为小数分隔符是逗号。有时十进制数带有“，”，有时带有“。”。并非所有计算机都正确配置了区域设置，**您不应依赖它**。

要设置该应用程序范围的设置：

```
Application.CurrentCulture = new CultureInfo("en-US");
Application.CurrentCulture.NumberFormat.NumberDecimalSeparator = "."; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T11:14:11.083

正如您所说，您可以在封闭的环境中调用这些方法，而无需提供任何 IFormatProvider。

正如您还写的那样，您可以提供一个 CultureInfo 对象，如下所示：

```
 Console.WriteLine(String.Format(CultureInfo.CurrentCulture, "{0}", DateTime.Now));
        Console.WriteLine(String.Format(new CultureInfo("en-US"), "{0}", DateTime.Now)); 
```

因为我的 CurrentCulture 是这样的瑞典语，所以这对我来说会以两种不同的方式显示日期：

2009-05-28 13:12:43

2009 年 5 月 28 日下午 1:12:43

CultureInfo.CurrentCulture 处理日期等的格式，并由您当前机器上的设置提供。

CurrentCulture.CurrentUiCulture 与本地化有关，即翻译。意思是在窗口中的菜单等上显示的内容。

我的猜测是，如果没有提供这些方法的默认行为，则使用 CurrentCulture。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-24T06:15:24.190

我总是将 Culture 属性放在 ASPX 或母版页的开头，它会为我完成所有转换。我永远不需要进行任何硬编码或将日期/时间转换为我自己所需的文化......

```
.
<%@ Page Language="C#" ..etc... Culture="en-AU" %>
. 
```

简单的

# vba - 我需要代码在两行之间复制并粘贴到另一张表中并给出任何值？

> ID：920245
> 
> 赞同：0
> 
> 时间：2009-05-28T10:50:10.430
> 
> 标签：vba, excel

例如：我有 50 行数据。在第一行有学生的名字。我需要将数据从 RAM 复制到 RAMESH 的代码。在这之间我有 20 行。我需要代码来复制行并将其粘贴到另一个工作表中。它不应该问我名字。默认情况下，它必须采用 RAM 和 RAMESH 的名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T20:17:21.313

好的，以下假设您有一个工作表 StartSheet，并且您要复制到的工作表称为 TargetSheet。它从第 1 行第 1 列开始，然后遍历每一行。如果名称匹配，它将将该 rownum 分配给一个变量。然后，使用两个 rownums 选择、复制和粘贴行。此代码不关心名称之间的行数，它只是检查名称本身。我假设第一列有名字，而不是你描述的第一行。

```
Sub MoveRows()
   Dim rownum As Integer
   Dim colnum As Integer
   Dim startrow As Integer
   Dim endrow As Integer

    rownum = 1
    colnum = 1

     With ActiveWorkbook.Worksheets("StartSheet")
        Do
           If .Cells(rownum, 1).Value = "RAM" Then
              startrow = rownum
           End If
           rownum = rownum + 1
        Loop Until .Cells(rownum, 1).Value = "RAMESH"
        endrow = rownum
        ActiveWorkbook.Worksheets("StartSheet").Range(startrow & ":" & endrow).Copy

     End With
     ActiveWorkbook.Worksheets("TargetSheet").Paste

End Sub 
```

# linux - 32 位 RHEL 机器上的内存使用

> ID：920247
> 
> 赞同：1
> 
> 时间：2009-05-28T10:50:48.197
> 
> 标签：linux, memory, 32-bit

我在基于 AMD64 的硬件上使用 32 位 RHEL 4.4。这是 uname -a 的输出

```
$ uname -a
Linux zulu 2.6.9-42.0.10.ELsmp #1 SMP Fri Feb 16 17:17:21 EST 2007 i686 athlon i386 GNU/Linux 
```

我在这个系统上安装了 8G 内存，操作系统是 32 位，我认为我的系统将无法使用完整的 8GB 内存。但是当我运行**top**时，我看到以下内容 -

```
Mem:   8309168k total,  8292028k used,    17140k free,     7096k buffers 
```

因此，**top** 能够查看所有 8GB 内存。

如果我在同一台机器上安装 32 位 WinXP，任务管理器只会显示 3 GB 可用。

我的问题是 - 32 位操作系统如何能够看到 8GB 内存？这是否意味着我的应用程序将能够使用更大的地址空间？为什么 32 位 Linux 和 32 位 WinXP 之间有区别？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T11:03:53.990

您的 Linux 系统支持[物理地址扩展](http://en.wikipedia.org/wiki/Physical_Address_Extension)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T11:06:13.017

内存有不同的“级别”。无论操作系统如何，在一个进程中处理超过 4Gb 的地址都是不可能的，因为您的指针太小而不能超过 - 这是 32 位内存的基本限制。在 linux 和 windows 以及大多数“传统”操作系统上，我猜想，32 位虚拟地址空间被分成内核的一部分和进程的一部分，因此每个进程的可寻址内容少于 4 Gb。

但是，操作系统仍然可以使用超过 4 Gb - 例如，有 2-3 个进程，每个进程消耗 2 Gb 的内存。即使是 32 位 CPU 也可以寻址超过 4 Gb 的内存（在硬件级别），但是在虚拟地址空间中，您总是受到 32 位指针的限制。

老新东西对物理地址空间、虚拟地址空间和co的区别有很好的解释：http: [//blogs.msdn.com/oldnewthing/archive/2004/08/18/216492.aspx](http://blogs.msdn.com/oldnewthing/archive/2004/08/18/216492.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T11:04:34.253

启用此功能的方法称为“PAE”（物理地址扩展）。您的 CPU 能够在内部使用 36 位地址，并且您的操作系统支持它。不幸的是，Windows XP 仅使用 PAE 来支持 NX 位（无执行位，当处理器尝试从标有该位的页面执行代码时会导致异常发生）。32 位 Linux 内核支持 PAE。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T11:11:42.523

较新的 i386 兼容 CPU 可以使用 PAE 模式寻址超过 4 GB。Windows XP 人为地将地址空间限制为 4GB，因为有太多编写不佳的硬件驱动程序假设所有 DMA 都将在 4 GB 以下的内存中完成。因此，4 GB 地址空间中的大约 1 GB 映射到硬件，其余映射到物理 RAM。Windows 服务器版本没有此限制。支持 PAE 的 Linux 内核也不限制内存。如果我没记错的话，这两个都支持高达 32GB。

您的应用程序的地址空间限制在 2-3 GB 之间，具体取决于操作系统选项。例如，一个应用程序可以有效地使用更多的物理 RAM，而不是通过在地址空间内外开窗部分内存、使用地址开窗扩展或内存映射文件。

# .net - 比较整数和整数？结果是布尔值？不是布尔值

> ID：920249
> 
> 赞同：4
> 
> 时间：2009-05-28T10:51:10.240
> 
> 标签：.net, vb.net, compiler-construction

我只是在编写一些代码来比较整数 id 和整数 id？例如：

```
Dim id As Integer = 1
Dim nullId As Integer? = Nothing
Dim areEqual As Boolean
areEqual = nullId = id 
```

当我尝试编译代码时，出现编译器错误：

```
Option Strict On disallows implicit conversions from 'Boolean?' to 'Boolean'. 
```

虽然解决这个问题对我来说非常简单，但我希望有人能够解释编译器中发生了什么来发出这个警告。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T10:58:52.843

这是可为空类型的怪癖之一。NULL（一般而言）表示“不知道”。**将已知**结果与**未知**结果进行比较（因为您不知道它们是否相同）**。**

.NET 中的可为空类型也是如此。将 a`Integer?`与 a`Integer`结果进行比较`Boolean?`，因为您可能会得到`True`，`False`或“不知道”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T10:53:13.620

这是编译器为可空类型生成运算符的方式的不幸结果。您可以使用以下代码解决它：

```
Dim AreEqual As Boolean = If(nullId, 0) = id 
```

这里`If`对应于 C# 的[null coalesce 运算符](http://msdn.microsoft.com/en-us/library/bb513985.aspx)，是以下操作的快捷方式：

```
Dim AreEqual As Boolean = If(nullId.HasValue, nullId.Value, 0) = id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T10:55:11.247

您正在尝试将类型（整数）与可为空的类型（整数？）进行比较。

您需要检查 nullID 的实际值，但不要忘记您需要检查 nullId 是否为 null。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T10:57:25.953

发生编译器错误是因为 Option Strict On 不允许从 'Boolean?' 进行隐式转换 为“布尔”。你正在尝试分配一个“布尔值”？（'Integer?'='Integer' 的结果）转换为 'Boolean'。

在语言标准中，隐式转换通常被禁用，以避免意外错误。添加显式转换很容易；在不知道的情况下找到您在代码中放入的隐式转换可能很困难。

可空类型和普通类型的区别足以避免它们之间的隐式转换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T12:54:35.077

Null 的值是“我不知道值是什么”，根据定义，任何操作数之一为 null 的操作都会导致 null。例如 2 = null 结果为 null，因此 int = int? 必须有 null 作为可能的值，而不仅仅是值 true 和 false。布尔？是仅具有该组值的类型，因此这是操作的返回类型。

唯一允许的隐式转换是那些总是有效的。您可以将 int 隐式转换为 long。但对于 int 来说不是很长（您可以明确地这样做），因为后者可能会导致信息丢失，例如，如果数字大于 int.MaxValue。在这种情况下，您将尝试拆箱会导致运行时异常的空值。

# bash - 即使设置了 VAR，也会评估形式的 Bash 条件 - [ -n "${VAR:-x}" ]

> ID：920250
> 
> 赞同：0
> 
> 时间：2009-05-28T10:51:14.687
> 
> 标签：bash, syntax, shell, environment-variables

我写了一个if语句的形式：

```
if [ -n "${VAR:-x}" ]; then
   #do something
   export VAR=#something
fi 
```

我的 shell 脚本两次调用此语句，并且**令人惊讶地**通过了两次条件。

[提示（也许......）：这个确切的代码在包含文件的函数中重复。if 语句在函数调用之前首先被评估。当函数被调用时，它“再次”被评估。]

这是怎么回事？我是否错误地理解了 -x 标志？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T10:56:49.400

`${VAR:-x}`表示如果`VAR`未设置替换字符串，`x`否则替换 的值`VAR`。

类似地，如果未[按照此处所述](http://www.network-theory.co.uk/docs/bashref/ShellParameterExpansion.html)`${FOO:-bar}`设置，则表示替换的值`FOO`或字符串。`bar``FOO`

这意味着`-n "${VAR:-x}"`将始终为真，因为`-n`意味着检查是否不为空并且`"${VAR:-x}"`永远不会为空。

# asp.net - VbScript ASP：选中复选框

> ID：920251
> 
> 赞同：2
> 
> 时间：2009-05-28T10:51:41.987
> 
> 标签：asp.net, vbscript, webforms

我有一个带有一些复选框的表单的 html 页面。我需要使用 VbScript ASP 确保选中一个复选框。我怎么做？这是复选框本身：

```
Dim terms
terms = Request.Form("terms") 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T11:14:01.783

如果复选框被选中，它的值将在表单数据中发送，否则不会在表单数据中发送该字段的项目。如果您没有为 checkox 指定值，则使用默认值“on”。

因此，要确定是否选中了复选框，请与值进行比较：

```
If terms = "on" Then
   ...
End If 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-11T18:05:17.047

*最好*的方法是明确地给你的复选框一个值：

```
<input type="checkbox" name="terms" value="Yes"> 
```

然后您可以检查该字段是否包含您设置的值：

```
<%
Dim terms
terms = Request.Form("terms")
If terms = "Yes" Then
    '...your code here
End If
%> 
```

如果您不知道复选框有什么值（或者如果您无法控制它的值），您可以检查一个空字符串。是的，从理论上讲，表单为未选中（或不存在）的字段返回特殊值“空”，而不是零长度字符串；但在实践中，Request.Form 无论如何都会将 Empty 转换为空白字符串。

```
<input type="checkbox" name="terms">
<%
Dim terms
terms = Request.Form("terms")
If terms <> "" Then
   '...checkbox was checked
End If
%> 
```

# coding-style - 断言与返回错误？

> ID：920255
> 
> 赞同：5
> 
> 时间：2009-05-28T10:51:55.260
> 
> 标签：coding-style

```
bool fn()
{
  if(something bad happen)
     return false;
  ..
}

void gn()
{
  assert(something == true);
  ..

} 
```

当我在生产代码中编写函数时，我应该选择哪种方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T10:57:02.817

`Assert`，至少在 .NET 中，*主要*用于测试. 它的具体用途[在这里](http://www.csharp-station.com/Articles/Assertions.aspx)简明扼要：

> 只有当以下所有条件都成立时，断言才最好用于测试条件：

```
* the condition should never be false if the code is correct,
* the condition is not so trivial so as to obviously be always true, and
* the condition is in some sense internal to a body of software. 
```

在生产代码中，我推荐第一种方法；或者`try/catch`如果永远不会发生“坏事”；如果是特殊情况。

如果您有一个应该始终存在或永远不存在的不变量（无论系统的状态如何），那么这对于`Assert`测试用例的外部来说是一个很好的候选者。

我在生产代码中看到了断言；通常[采用按合同设计风格的代码](http://en.wikipedia.org/wiki/Design_by_contract)。我在单元测试中经常看到它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T10:57:08.777

当“发生了一些不好的事情”=一些特殊的事情时，甚至考虑使用异常......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T10:59:01.270

使用 assert 来记录并确认程序不变量（你知道它总是正确的）成立。在任何不仅仅是一个简单的程序中，您对问题的理解将随着您编写代码而发展，因此较旧的代码可能具有不同的模型，并且断言将有助于解决这个问题。

对于可以改变的东西（特别是在程序控制之外），您需要能够报告错误（例如传递给库函数的无效参数值，文件不存在），使用平台/语言首选机制（异常，返回值， ...）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T01:21:29.827

您的“return false”也称为**[GuardClause](http://c2.com/cgi/wiki?GuardClause)** - 正如 Ward Cunningham 所解释的：

> ...[G]uards 类似于断言，因为它们都保护后续代码免受特殊情况的影响。守卫与断言的不同之处在于它们对方法的逻辑做出了切实的贡献，因此不能作为优化的一部分安全地省略。在命名此模式时，我从 EwDijkstra 借用了术语守卫。

如果您的保护子句有任何复杂性，使用[BouncerPattern](http://c2.com/cgi/wiki?BouncerPattern)进行封装通常会很有帮助。

正如 Ward 所指出的，当可以*安全地省略*代码时，您应该使用断言。如果您的语言中有`assert`关键字，编译器通常会从生产代码中删除断言。

今天我们认识到，在大多数情况下，在代码中放置断言并不是一个好主意。经典的关注点分离。 将断言与代码*分开并将它们**封装*在单元测试中。这消除了必须重新编译代码而不分发断言的复杂性（您不会分发测试......），并且还为您提供了一套可以连续运行以捕获回归和驱动重构的测试。

其他答案提到*了按合同设计，*它将这些问题完全排除在您的代码之外，并纳入围绕相关代码强制执行的声明的前置条件、后置条件和不变量中。如果您经常这样做，您可能会考虑为您的语言研究按合同设计的框架。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T10:55:46.703

恕我直言，`assert`是在调试环境中断言开发人员正在发生意外（错误）。并非所有断言都必须是关键的，由开发人员决定是否为真正的失败设置断言。

在发布模式下，只有当错误很严重并且没有继续执行的意义时才需要返回 false。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T10:56:13.443

如果代码正常工作，则在永远不会发生不好的事情时使用断言。一个例子：

```
int div( int a, int b ) {
  assert( b != 0 );
  return a / b;
} 
```

在这里，调用代码有责任确保 div() 永远不会在第二个参数为零的情况下被调用。如果是这样，您的代码处于未知状态，应该终止。

当可能发生可以处理的错误时使用 if() ... return。例如，打开文件可能会失败，应该由程序检测和处理 - 失败不会使程序进入未知状态。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T11:03:06.610

断言仅用于质量控制目的。删除它们不能改变你的程序的行为（即你的程序不能依赖断言来处理任何事情）。如果发生了不应该发生但在糟糕的情况下可能发生的事情 - 例如网络连接丢失，请使用异常。当失败也是一种选择时，使用返回值来指示成功。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T10:56:40.447

简单的答案是两者兼而有之，但第二个更重要。断言检查设计假设，因此在调用 fn() 之前我会有先决条件，例如给定资源可能可用。断言通常不会在发布代码中执行任何操作，但不一定。如果重要的是您的函数 gn 需要某些东西为真才能正常工作，它要么使用 if 语句并返回和错误代码，要么抛出异常。Assert 通常不会在发布代码中执行任何操作，因此您的函数可能会在这种情况下崩溃。

[另请参阅对此问题](https://stackoverflow.com/questions/419406/are-assertions-always-bad/419553#419553)的更详细答案

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T10:56:41.273

这实际上取决于语言/运行时环境以及错误的性质。

一般来说，程序无法从断言失败中恢复（即它会崩溃）。这可能是也可能不是你想要的。

如果您的环境支持异常，您也可以使用这些，如果您愿意，可以处理错误，如果您不处理错误，则会中止并显示有用的消息。

“return false”这个东西很容易出错（b/c 人们忘记检查返回值），所以我只会在断言和异常都不可用的情况下使用它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T10:57:11.913

取决于您要检查的内容。在第一种情况下，如果发生的坏事违反了您班级的合同，则抛出一个对客户有意义的异常。返回 false 不会让任何人知道状态不正确。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-28T11:05:09.150

每当诸如合同之类的东西被破坏时，我都会使用断言。这是什么意思：在数学中，除以零是没有定义的。因此，与除法功能的合同被打破。有关合同的更多信息，请参阅编程语言 Eiffel。

在某些情况下，我会实现第二个函数，该函数具有带有默认值的附加参数并处理异常，例如 StrinToIntegerDef(string, default)，当字符串未转换为整数时返回默认值。

在程序的正常执行没有受到威胁的情况下，可以返回 false。

如果语言允许的话，我更喜欢有意义的例外，至少是 assert(condition, message) 的形式。

此外，如果有多种可能失败，请返回一些枚举值而不是 false。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-28T11:13:22.487

使用断言来强制函数的[先决条件](http://c2.com/cgi/wiki?PreCondition)（如果函数要具有任何意义，则必须满足的条件）。

# java - 获取文件的最后访问时间

> ID：920259
> 
> 赞同：15
> 
> 时间：2009-05-28T10:53:40.827
> 
> 标签：java, file, lastaccesstime

我知道使用`File`对象我们可以获得最后修改时间`File`（即[File.lastModified()](https://docs.oracle.com/javase/8/docs/api/java/io/File.html#lastModified--)）。但是，我的要求是在 Java 中获取a的*最后访问时间。*`File`我如何得到它？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-28T11:02:22.587

您将需要使用Java 7 附带[的新文件 I/O API (NIO2)](http://docs.oracle.com/javase/tutorial/essential/io/fileio.html)。它有一个方法[lastAccessTime()](http://docs.oracle.com/javase/7/docs/api/java/nio/file/attribute/BasicFileAttributes.html#lastAccessTime())用于读取上次访问时间。

这是一个使用示例：

```
Path file = ...
BasicFileAttributes attrs = Files.readAttributes(file, BasicFileAttributes.class);
FileTime time = attrs.lastAccessTime(); 
```

有关更多信息，请参阅Java 教程中的[管理元数据。](http://docs.oracle.com/javase/tutorial/essential/io/fileAttr.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T10:56:58.310

你不能用纯 Java 来做到这一点，你需要使用 JNI 来访问平台特定的数据，比如这个，或者使用[核心 Java 库](http://www.javaxt.com/)的扩展，如下所示：

```
javaxt.io.File file = new javaxt.io.File("path");
file.getLastAccessTime(); 
```

或者，如果您有 Java 7，请使用 Esko 的答案并使用 NIO。

# django - 具有两个通用（content_type）外键的 Django 模型？

> ID：920271
> 
> 赞同：7
> 
> 时间：2009-05-28T10:56:50.307
> 
> 标签：django, django-models, generics

我正在尝试在两个通用（content_type）引用之间创建一个映射表，一个用于“代理”，一个用于“资源”。

所以我采用通常的方式制作通用外键：

```
content_type = models.ForeignKey(ContentType)
object_id = models.PositiveIntegerField()
resource = generic.GenericForeignKey('content_type', 'object_id') 
```

我试着用两个做一个模型。

```
agent_content_type = models.ForeignKey(ContentType)
agent_object_id = models.PositiveIntegerField()
agent = generic.GenericForeignKey('agent_content_type', 'agent_object_id')

resource_content_type = models.ForeignKey(ContentType)
resource_object_id = models.PositiveIntegerField()
resource = generic.GenericForeignKey('resource_content_type', 'resource_object_id') 
```

但这现在会引发以下错误：

> myapp.mymodel：字段“resource_content_type”的访问器与相关字段“ContentType.mymodel_set”发生冲突。将related_name 参数添加到“resource_content_type”的定义中。

和代理类似。

这里发生了什么？我该怎么办？

干杯

菲尔

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T11:04:11.320

您是否尝试过按照错误消息告诉您的操作 - 添加 related_name 参数？

```
agent_content_type = models.ForeignKey(ContentType, related_name='mymodel_agent') 
```

编辑：发生这种情况的原因是每次定义外键时，Django 都会自动为目标模型提供一个属性来进行反向查找。默认情况下，它给出了相关表的名称 + `'_set'`- 所以如果你的`article`表有一个 FK to `section`，`section`将获得一个`article_set`用于反向查找的属性。

现在，如果您在同一个模型中有两个 FK 指向同一个目标模型，Django 将尝试同时赋予它们*两个*属性，从而`foo_set`导致冲突。因此，错误消息告诉您手动设置related_name 属性。

# python - 使用 cookie 和 python 来存储搜索

> ID：920278
> 
> 赞同：0
> 
> 时间：2009-05-28T10:57:27.903
> 
> 标签：python, cookies

嘿，我有一个用于搜索数据库的网页。我希望能够使用 python 实现 cookie 来存储用户搜索的内容，并在他们返回时为他们提供最近搜索的字段。有没有办法使用 python Cookie 库来实现这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T13:04:36.133

通常，我们会执行以下操作。

1.  使用框架。

2.  建立会话。理想情况下，要求提供某种用户名。如果您不想询问姓名或任何内容，可以尝试将浏览器的 IP 地址作为会话的密钥（这可能会变成一场噩梦，但您可以尝试一下。）

3.  使用会话标识（用户名或 IP 地址），将搜索保存在服务器上的数据库中。

4.  当此人再次登录时，从您的本地数据库中检索他们的查询信息。

故事的道德启示。不要相信 cookie 除了会话标识之外有任何东西。即便如此，它也会被故意或意外劫持。

*   故意劫持是一个人冒充另一个人的方式。

*   当多人共享相同的 IP 地址（因为他们共享同一台计算机）时，就会发生意外劫持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T16:11:37.143

要使用 cookie，您可以使用框架使用的任何 cookie API。

这是一个[CherryPy](http://cherrypy.org/)完整的工作示例，用于执行您想要的操作、存储搜索并稍后提供它们。

```
import cherrypy
import json

class Root(object):
    def index(self):
        last_search = cherrypy.request.cookie.get('terms', None)
        if last_search: 
            last_search = ','.join(json.loads(last_search.value))
        else:
            last_search = 'None'
        return """
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>Search</title>
</head>
<body>
    <h1>Search</h1>
    <form action="do_search" method="get">
        <p>Please type your search terms: 
        <input type="text" name="query" /></p>
        <p>Hint: Last 5 used terms: %s</p>
        <p><input type="submit" value="Search &rarr;" /></p>
    </form>
</body>
""" % (last_search,)
    index.exposed = True

    def do_search(self, query):
        results = ['some', 'results', 'here', 'simulating', 'a', 'search']
        print cherrypy.request.cookie
        last_search = cherrypy.request.cookie.get('terms', None)
        if last_search:
            last_search = json.loads(last_search.value)[-4:] # get last 4
        else:
            last_search = []
        last_search.append(query) # append new term
        cherrypy.response.cookie['terms'] = json.dumps(last_search)
        return """
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>Search</title>
</head>
<body>
    <h1>Search Results for %r</h1>
    <p>%s</p>
    <p><a href="%s">click here to search again</a>
    </p>
</body>
""" % (query, ', '.join(results), cherrypy.url('/'))
    do_search.exposed = True

application = cherrypy.tree.mount(Root(), '/')

if __name__ == '__main__':
    cherrypy.quickstart() 
```

笔记：

它用于[`json`](http://docs.python.org/library/json.html)序列化列表并将其作为字符串存储在 cookie 中。Python`json`是在 python 2.6 中引入的，所以如果你在 2.6 之前需要它，那么如果你没有 2.6，你可以使用它[`simplejson`](http://pypi.python.org/pypi/simplejson)来代替运行示例。

对代码中的 HTML 感到抱歉。理想情况下，这将在代码之外，在模板文件中，使用 jinja2 之类的模板引擎。

# django - Django 中的文件上传：防止 FileField 将完整路径写入数据库

> ID：920279
> 
> 赞同：2
> 
> 时间：2009-05-28T10:57:36.293
> 
> 标签：django

我正在 Django 框架之上构建一个软件存储库。因为它会包含很多文件，所以我希望它在通过文件管理器查看它时有意义。因此，我首先按它们所属程序的 URL 对文件进行分组，然后按该 URL 的前两个字母对文件进行分组。这是它的外观：

![我的目录结构截图](https://imgur.com/BPdEd.png)

架构如下所示：

```
class File(models.Model):
    # If called like upload_to, don't put a slash in front of the result
    # because we already have one in settings.MEDIA_ROOT
    def get_absolute_url(self, filename=None):
        return '%sfiles/%s/%s/%s' % ('' if filename else '/',
                                     self.download.url[:2],
                                     self.download.url,
                                     filename or self.name)
    name = models.FileField(upload_to=get_absolute_url, max_length=255)
    size = models.IntegerField()
    title = models.CharField(blank=True, max_length=255)
    download = models.ForeignKey('Download', related_name='files')

class Download(models.Model):
    url = models.SlugField(unique=True, max_length=255)
    title = models.CharField(max_length=255) 
```

然而，有一个小问题：FileField 将存储整个生成的路径，而不仅仅是名称，我宁愿避免这种情况。有没有办法覆盖（可能在我自己的字段类中）FileField 写入数据库的内容以及在加载原始字段后它如何重建路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T15:20:45.703

```
name = models.FileField(upload_to=get_absolute_url, max_length=255) 
```

upload_to 通常看起来像这样

```
upload_to ='./files' 
```

它将作为 ./files/your.file 存储在数据库和`<MEDIA_ROOT>/files/your.file`磁盘中

您可以以编程方式将`upload_to`-String 更改为最适合您的

```
upload_to ='./files'+'/subdir' 
```

但它应该以'./'开头

[文件字段参考](http://docs.djangoproject.com/en/dev/ref/models/fields/#filefield)

`get_absolute_url()`应该返回一个类似[http://domain.com/sitemedia/files/your.file的 url](http://domain.com/sitemedia/files/your.file)

**编辑：**

要从文件名中删除路径，您可以在 File.save() 中执行字符串操作，例如

```
def save(self, force_insert=False, force_update=False):
    self.name = self.name[self.name.rfind('/')+1:]
    super(File, self).save(force_insert, force_update) 
```

# unit-testing - 使用 Spring 注入 EasyMock 模拟导致 ClassCastException

> ID：920281
> 
> 赞同：3
> 
> 时间：2009-05-28T10:58:26.183
> 
> 标签：unit-testing, spring, dependency-injection, mocking, easymock

我试图让 Spring 在我的单元测试中注入 EasyMock 模拟。

在我的 applicationContext.xml 中，我有这个：

```
<bean id="mockService"  class="org.easymock.EasyMock" factory-method="createMock"  name="MockService">
    <constructor-arg index="0" value="my.project.Service"/>
</bean> 
```

在我的单元测试中，我有这个：

```
@Autowired
@Qualifier("mockService")
private Service service;

public void testGetFoo() {
    Foo foo = new Foo();

    expect(service.findFoo()).andReturn(foo);
    replay(service); // <-- This is line 45, which causes the exception

    // Assertions go here...
} 
```

当我尝试运行我的测试时，我得到了这个堆栈跟踪：

```
java.lang.ClassCastException: org.springframework.aop.framework.JdkDynamicAopProxy
at org.easymock.EasyMock.getControl(EasyMock.java:1330)
at org.easymock.EasyMock.replay(EasyMock.java:1279)
at TestFooBar.testGetFoo(TestVodServiceLocator.java:45) 
```

我对 Spring 和 EasyMock 都很陌生，但在我看来，错误是由 EasyMock 试图调用它假定为 EasyMock 实例的方法引起的，但实际上是由 Spring 创建的动态代理。据我了解，动态代理仅实现接口中定义的方法，在本例中为 Service 接口。

我不明白的是，[从我读到的](http://javadevelopmentforthemasses.blogspot.com/2008/07/mocking-spring-tests.html)（也在[这里](http://satukubik.com/2007/12/21/spring-tips-initializing-bean-using-easymock-for-unit-test/)），我试图实现的目标至少似乎是可能的。

所以我的问题是：我没有做什么或者我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T13:05:36.040

您还可以创建一个辅助方法来从 Spring 代理中解开 EasyMock 代理以定义预期的行为，然后：

```
public static <T> T unwrap(T proxiedInstance) {
  if (proxiedInstance instanceof Advised) {
    return unwrap((T) ((Advised) proxiedInstance).getTargetSource().getTarget());
  }

  return proxiedInstance;
} 
```

注意 recusive 调用，因为在最坏的情况下，您在实际目标周围有多个代理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T14:49:50.647

解决了！

我在 applicationContext.xml 中忽略了这一点：

```
<bean id="txProxyAutoCreator" class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator">
    <property name="beanNames">
        <list>

            <value>*Service</value>
            <!--   ^^^^^^^^    
               This is the problem!
            -->
        </list>
    </property>
    <property name="interceptorNames">
        <list>
            <value>txAdvisor</value>
        </list>
    </property>
</bean> 
```

...这会导致 Spring 自动为所有名称以“Service”结尾的 bean 创建代理对象。

我的解决方案是明确列出 bean 而不是使用通配符。然而，这对我来说似乎有点脆弱，所以如果有人知道如何指定*除*FooService 之外的所有 *Service bean，我将不胜感激。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T15:30:27.930

这里有些奇怪。您显然很快掌握了 Spring 和 EasyMock。自动代理、工厂方法，所有这些都表明您正在深入了解 Spring 的功能。

尽管如此，您将模拟 bean 注入到一个类中还是有点奇怪。你可能有一个很好的理由，但对我来说这是一种代码味道。我建议您只考虑将真实服务连接到您的测试类中，然后根据需要初始化模拟对象。为什么要在 java 中花费 3 行，在 XML 中花费另外 3 行（加上 1 行来重置它们）来创建一个没有依赖关系的模拟对象？只需说服务服务 = (Service)createMock(Service.class)。我建议以您需要的方法创建它们，设定期望，注入，使用它们，然后丢弃它们。在您的模型中，您必须记住每次使用模拟对象时都要重置它，这比创建一个新对象要清晰。

当然，这是一个风格问题，而不是正确性问题，因此请根据需要忽略。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-29T11:47:45.937

*我知道这个问题很老，但我只是偶然发现它正在寻找类似的问题。*

问题是 Spring 不知道模拟对象的类型。您使用的方法如下所示：

```
public static <T> T createMock(final Class<T> toMock) {
    return createControl().createMock(toMock);
} 
```

Spring 不够聪明，无法从构造函数参数派生 T （至少我上次检查过），所以它认为返回的对象是 type `java.lang.Object`。结果，创建的代理没有实现`my.project.Service`，因此无法注入。

因此，答案是告诉 Spring 所需的类型。

# .net - 检测是否支持 SSL

> ID：920284
> 
> 赞同：0
> 
> 时间：2009-05-28T10:59:26.277
> 
> 标签：.net, ssl

我正在使用选定页面的 HttpModule 将用户重定向到 https，如果由于某种原因浏览器、代理等不支持它，我不想要强制用户使用 SSL。是否可以检测客户端是否支持使用 .NET 的 SSL 连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T11:03:34.723

[http://bytes.com/groups/net-asp/347085-detect-https](http://bytes.com/groups/net-asp/347085-detect-https)

希望这会有所帮助。一定要仔细阅读。

编辑：...忽略。重新阅读Q，这回答有点不同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T11:17:20.030

使用服务器端 .NET - 不。您可以尝试在第一页加载时通过 Javascript 对 HTTPS 页面进行隐形调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T11:17:52.620

好吧，您可以尝试使用 WebClient 执行 SSL 连接，但这是否能证明浏览器也支持它？

更新：哦，您希望**服务器端**.NET 对其进行测试。不能那样做。

此外，为什么浏览器或代理不支持它？如今，HTTPS 非常普遍（就像过去十年一样）。

# windows - .Net 中是否有一个简单的事件来检测 cd、dvd（或 USB）插入？

> ID：920285
> 
> 赞同：0
> 
> 时间：2009-05-28T10:59:30.863
> 
> 标签：windows, vb.net

我知道您可以使用 WMI 事件或覆盖 WndProc 并寻找正确的消息来完成它，但我想知道网络框架中是否没有隐藏的东西使这项任务更容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T11:09:09.673

这个免费[的 DriveDetector](http://www.codeproject.com/KB/system/DriveDetector.aspx)类提供了这个功能（至少对于我使用它的 USB 驱动器而言）。它使用您描述的 WndProc 方法。

我不知道标准.NET 库中有任何类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-15T14:39:29.683

在以下代码中，moDiskDetector 将在检测到新驱动器时引发 EventArrived 事件。

要检测驱动器的移除，请使用“__InstanceDeletionEvent”。

```
Private WithEvents moDiskAddWatcher As ManagementEventWatcher

Private Sub StartWatcher()

    If moDiskAddWatcher Is Nothing Then
        moDiskAddWatcher = CreateWatcher("__InstanceCreationEvent", "(TargetInstance ISA 'Win32_DiskDrive')")
    End If
    moDiskAddWatcher.Start()

End Sub

Private Sub StopWatcher()

    If moDiskAddWatcher IsNot Nothing Then
        moDiskAddWatcher.Stop()
        moDiskAddWatcher.Dispose()
    End If

End Sub

Private Function CreateWatcher(ByVal sClassName As String, ByVal sCondition As String) As ManagementEventWatcher

    Dim oQuery As New WqlEventQuery()

    oQuery.EventClassName = sClassName
    oQuery.WithinInterval = New TimeSpan(0, 0, 5)
    oQuery.Condition = sCondition
    Return New ManagementEventWatcher(oQuery)

End Function 
```

# xml - setNodeValue() 方法不起作用

> ID：920287
> 
> 赞同：0
> 
> 时间：2009-05-28T11:00:39.660
> 
> 标签：xml, blackberry, java-me

我已经为 Blackberry 应用程序创建了 XML 文件，并且我使用过

```
root.getFirstChild().setNodeValue("ABCDE"); 
```

设置节点值。

添加节点值时抛出异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T11:23:20.800

我怀疑（在没有任何信息的情况下）该`getFirstChild()`方法没有返回您认为的内容（文本节点？），而是其他内容。我会检查返回的节点（适当地转换）并从那里开始工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T11:39:59.300

```
 DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory
                    .newInstance();
            DocumentBuilder documentBuilder = documentBuilderFactory
                    .newDocumentBuilder();
            document = documentBuilder.newDocument();
            root = document.createElement("START");
            document.appendChild(root); 
//After this,I am trying to set the node value:
root.getFirstChild().setNodeValue("ABCDE"); 
```

# visual-studio - 在 Visual Studio 2005 中使用 WatiN

> ID：920288
> 
> 赞同：2
> 
> 时间：2009-05-28T11:00:50.767
> 
> 标签：visual-studio, watin

我在 Visual Studio 2005 中使用 WatiN。我想使用 watin 比较网页上的文本，该怎么做？Assert.Istrue 方法不起作用，它会给出错误。还是我错过了使用 Assert 方法的 using 指令？

请提出解决方案并让我知道支持 assert 方法的 using 指令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T11:05:46.357

您需要在项目中添加对它的引用。然后使用正确的 using 语句。如果我记得 Assert 需要“使用 WatiN.Core;”

编辑：查看此页面。它应该有帮助。[http]watin.sourceforge.net/gettingstarted.html

# xcode - 在调试窗口中运行时避免 asm__dyld__dyld_start

> ID：920289
> 
> 赞同：1
> 
> 时间：2009-05-28T11:02:12.603
> 
> 标签：xcode

每当我启动我的应用程序并设置视图以在调试视图中查看代码和控制台（在多合一设置中）时，我的源视图都会切换到 asm__dyld__dyld_start 的 asm 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T16:37:33.287

尝试将 Run->Debugger Display 中的设置更改为“Source Only”而不是“Disssembly Only”。

# php - jquery 序列化和 $.post

> ID：920294
> 
> 赞同：22
> 
> 时间：2009-05-28T11:03:23.490
> 
> 标签：php, jquery, serialization, post, get

我正在尝试使用 jQuery 中的 $.post 方法从表单发送大量数据。我首先使用 serialize() 函数将所有表单数据变成一个长字符串，然后我将在服务器端展开。奇怪的是，当我尝试使用 $.post 发送它时，它会将 serialize() 的结果附加到 URL，就好像我使用 GET 发送它一样。有人知道为什么会这样吗？

这是jQuery：

```
$("#addShowFormSubmit").click(function(){
  var perfTimes = $("#addShowForm").serialize();
  $.post("includes/add_show.php", {name: $("#showTitle").val(), results: perfTimes }, function(data) {
    $("#addShowSuccess").empty().slideDown("slow").append(data);
  });
}); 
```

这是php：

```
$show = $_POST['name'];
$results = $_POST['results'];
$perfs = explode("&", $results);
foreach($perfs as $perf) {
    $perf_key_values = explode("=", $perf);
    $key = urldecode($perf_key_values[0]);
    $values = urldecode($perf_key_values[1]);
}
echo $key, $values; 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-10-16T05:21:15.570

如果您正在使用一个`<button>`元素来激活序列化和 ajax，并且如果该`<button>`元素在该`form`元素内`button`，那么无论您使用 jQuery 为它分配什么其他 .click 分配，它都会自动充当表单提交。

## 类型='提交'

`<button></button>`并且`<button type='submit'></button>`是一回事。如果放置在`<form>`元素中，他们将提交表单。

## 类型='按钮'

`<button type='button'></button>`是不同的。它只是一个普通的按钮，不会提交表单（除非你故意让它通过 JavaScript 提交表单）。

在**表单**元素没有指定动作属性的情况下，此提交只是将数据发送回同一页面。因此，您最终会看到页面刷新，以及出现在 URL 中的序列化数据，就好像您在 ajax 中使用了 GET 一样。

## 可能的解决方案

1-制作`<button>`类型`button`。如上所述，这将阻止按钮提交表单。

前：

```
<form id='myForm'>
    <!--Some inputs, selects, textareas, etc here-->
    <button id='mySubmitButton'>Submit</button>
</form> 
```

后：

```
<form id='myForm'>
    <!--Some inputs, selects, textareas, etc here-->
<button type='button' id='mySubmitButton'>Submit</button>
</form> 
```

2 - 将元素移到`<button>`元素外`<form>`。这将阻止按钮提交表单。

前：

```
<form id='myForm'>
    <!--Some inputs, selects, textareas, etc here-->
    <button id='mySubmitButton'>Submit</button>
</form> 
```

后：

```
<form id='myForm'>
    <!--Some inputs, selects, textareas, etc here-->
</form>
<button id='mySubmitButton'>Submit</button> 
```

3 - 添加`preventDefault()`到按钮单击处理程序中以防止提交表单（这是默认操作）：

```
$("#addShowFormSubmit").click(function(event){
  event.preventDefault();
  var perfTimes = $("#addShowForm").serialize();
  $.post("includes/add_show.php", {name: $("#showTitle").val(), results: perfTimes },      function(data) {
    $("#addShowSuccess").empty().slideDown("slow").append(data);
  });
}); 
```

显然没有看到你所有的代码，我不知道你的问题是否属于这种情况，但我见过你描述的行为的唯一原因是因为提交按钮`<button>`没有指定类型。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T11:36:48.337

尝试使用 serializeArray() 而不是 serialize()。serialize() 将产生一个 url 编码的查询字符串，而 serializeArray() 产生一个 JSON 数据结构。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T11:45:13.953

是什么让您相信数据已附加到 URL 中？

无论如何，在表单数据本身中传递表单值不是更有意义吗？它将允许您跳过“爆炸”步骤：

```
$("#addShowFormSubmit")
  .click(function() { 
      var perfTimes = $("#addShowForm").serialize(); 
      $.post("includes/add_show.php", 
         $.param({name: $("#showTitle").val()}) + "&" + perfTimes, 
         function(data) {...}); 
  }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T17:25:53.780

所以这可能有点迟钝，但我做了一个函数来帮助我做这件事，因为我厌倦了每次都做一堆修复。serializeArray 有点烦人，因为它提供了一个对象集合，而我只想让 PhP 重建一个关联数组。下面的函数将遍历序列化数组，并仅在值存在时构建具有适当属性的新对象。

首先，函数（它采用相关表单的 ID）：

```
function wrapFormValues(form) { 
    form = "#" + form.attr("id") + " :input";
    form = $(form).serializeArray();
    var dataArray = new Object();

    for( index in form)
    {   
        if(form[index].value)   {
            dataArray[form[index].name] = form[index].value;    
        }
    }       

    return dataArray; 
} 
```

在构建我的帖子时，我通常也使用一个对象，因为我通常在表单数据之前标记两个或三个其他值，我认为它看起来比内联定义它更干净，所以最后一步看起来像这样：

```
var payload = new Object(); 
//stringify requires json2.js from http://www.json.org/js.html
payload.data = JSON.stringify(data);

$.post("page.php", payload,  
    function(reply) {
        //deal with reply.
    }); 
```

在服务器端，您所要做的就是`$payload = json_decode($_POST['data'], true)`拥有一个关联数组，其中键是表单字段的名称。

完全免责声明，多选在这里可能不起作用，你可能只会得到列表中最后一个值。这也是专门为适合我的一个项目而创建的，因此您可能需要对其进行调整以适合您。例如，我对来自服务器的所有回复都使用 json。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-06T14:40:07.127

在 php 方面，您可能需要查看[parse_str](http://us2.php.net/parse_str)。如果您使用第二个可选参数，它将将该 url 字符串解析为变量或数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T18:02:28.473

试试这个语法。我使用它来序列化表单并通过 ajax 调用对 WCF 服务进行 POST。此外，您可以将其发送回单个 JSON 对象，而不是按照您的方式构建对象。尝试这个：

```
var serializedForm = serializedForm = $("#addShowForm").serializeArray();

$.post("includes/add_show.php", 
    {
        "myObjectName": ("#showTitle").val(), results: perfTimes 
    }, function(data) 
        {
            $("#addShowSuccess").empty()
            .slideDown("slow")
            .append(JSON.stringify(serializedForm)); 
        }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-18T03:15:41.130

此问题的另一个可能原因：如果您的表单没有分配任何类型的提交操作，则每当您在填写表单时按“ENTER”键时，表单将被提交到当前 URL，因此您将看到序列化的数据出现在 URL 中，就好像您正在使用 GET ajax 事务一样。这个问题的一个简单解决方案，只是阻止 ENTER 在按下时提交表单：

```
//Prevent Form Submission when Pressing Enter
$("form").bind("keypress", function(e) {
if (e.keyCode == 13)
    return false;
}); 
```

# javascript - 使用 Firebug 调试基本 URL 元素

> ID：920298
> 
> 赞同：0
> 
> 时间：2009-05-28T11:04:00.620
> 
> 标签：javascript, firefox, firebug, base-url

我正在使用 JS 将[基本 URL](http://reference.sitepoint.com/html/base)标记添加到文档头，因此页面上的相对链接有效。但它没有生效，并且[Firebug](http://getfirebug.com/)（Firefox 的调试插件）显示该`<BASE />`元素变灰..为什么？这是否意味着 Firefox 无法理解或语法不正确？

[图片 http://www.freeimagehosting.net/uploads/a3122c1ddd.png](http://www.freeimagehosting.net/uploads/a3122c1ddd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T11:14:51.627

[http://www.w3schools.com/TAGS/tag_base.asp](http://www.w3schools.com/TAGS/tag_base.asp)

基本标签有两个组件 href 和 target。你的好像没问题。冷静你举一些它失败的链接的例子？

请参阅[http://ashita.org/StackOverflow/base_test.html](http://ashita.org/StackOverflow/base_test.html)进行演示。（我的测试）

编辑：见评论

```
function addBase(url) {
    var regex = /^(https?|ftp):\/\//;

    var a = Array.prototype.slice.call(document.getElementsByTagName('a'),0);
    var link = Array.prototype.slice.call(document.getElementsByTagName('link'),0);
    var script = Array.prototype.slice.call(document.getElementsByTagName('script'),0);
    var img = Array.prototype.slice.call(document.getElementsByTagName('img'),0);

    var hrefs = a.concat(link);
    var srcs = img.concat(script);

    var element,href,src;
    for (var i=0,len=hrefs.length;i<len;++i) {
        element = hrefs[i];
        href = element.getAttribute("href");
        if (href) {
            if (!regex.test(href)) {
                href = (url + "/" + href).replace("//","/"); //to handle double slash     collision
                element.setAttribute("href",href);
            }
        }
    }
    for (var i=0,len=srcs.length;i<len;++i) {
        element = srcs[i];
        src = element.getAttribute("src");
        if (src) {
            if (!regex.test(src)) {
                src = (url + "/" + src).replace("//","/"); //to handle double slash     collision
                element.setAttribute("src",src);
            }
        }
    }
} 
```

在 Firefox 中测试和工作

# objective-c - UITableView+UINavigationBar+UITabbar 在基于windows的应用程序模板中使用interface Builder？

> ID：920299
> 
> 赞同：3
> 
> 时间：2009-05-28T11:04:11.150
> 
> 标签：objective-c, iphone, xcode, interface-builder

我想要一个底部带有 UITabBAr 的视图，每个视图上有一些按钮+导航控制器，并且使用界面构建器和基于 Windows 的应用程序模板在视图内有一个表格视图。我想要一个分步指南来做到这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-04T20:45:27.250

这很简单。只需使用此功能创建您的 appdelegate：

```
- (void)applicationDidFinishLaunching {

  TableSubclass *tvc = [[TableSubclass alloc] init];  //subclass of UITableView you declare

  UINavigationController *navBar = [[UINavigationController alloc] initWithRootViewController:tvc];
  navBar.tabBarItem.title = @"Foo";

  NSArray *tabViewControllerArray = [NSArray arrayWithObjects:navBar, nil];
  self.tabBarController.viewControllers = tabViewControllerArray;
  self.tabBarController.delegate = self;

  [tvc release];

} 
```

现在，只需创建您的 UITableView 子类就可以了。

如果你想要多个视图，而不仅仅是一个表，你可以声明更多的视图控制器并将它们添加到 tabViewControllerArray。

# blackberry - Blackberry - 更改设备上的纬度和经度以测试应用程序

> ID：920303
> 
> 赞同：1
> 
> 时间：2009-05-28T11:05:24.267
> 
> 标签：blackberry, java-me, gps, jsr179

我想在设备上测试我的应用程序。是否可以在设备设置中的某处硬编码纬度和经度值，以便应用程序读取这些值而不是当前位置？

我想针对当前位置以外的不同位置测试我的应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-08T16:36:04.970

在 BB 模拟器中，您可以转到 Simulate > GPS Location。单击添加按钮并输入名称、纬度和经度。单击保存，模拟器将开始将您的新位置提供给应用程序。请注意，下拉菜单中显示的任何位置都是模拟器将报告的位置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T06:15:36.853

## GPS模型内部

如果您有权访问您的应用程序代码，您始终可以为[LocationProvider](http://www-users.cs.umn.edu/~czhou/docs/jsr179/lapi/javax/microedition/location/LocationProvider.html)创建一个模型实现，以便它从文件或 RecordStore 读取位置和速度数据并将其作为[Location](http://www-users.cs.umn.edu/~czhou/docs/jsr179/lapi/javax/microedition/location/Location.html)返回，例如

```
public class MockupLocationProvider extends LocationProvider {

    public MockupLocationProvider() {
        //prepare a file or RecordStore with locations here
    }

    public Location getLocation(int arg0) throws LocationException,
            InterruptedException {      
        //read data from file or RecordStore
        double latitude = 321;
        double longitude = 34;
        float altitude = 21;
        //create and return location
        Location result = new GPSLocation(latitude, 
            longitude, altitude);       
        return result;
    }

    public int getState() {
        // mockup location provider always available 
        return LocationProvider.AVAILABLE;
    }

    public void reset() {
        // your code        
    }

    public void setLocationListener(LocationListener listener, 
            int interval, int timeout, int maxAge) {
        // your code        
    }
} 
```

和您的位置模型

```
public class GPSLocation extends Location {    
    double _latitude, _longitude;
    float _altitude, _horAcc = 0, _verAcc = 0, _speed;
    public GPSLocation(double lat, double lon, float alt) {
        init(lat, lon, alt);
    }    
    public GPSLocation(double lat, double lon, float alt, float spd) {
        init(lat, lon, alt);
        _speed = spd;
    }    
    private void init(double lat, double lon, float alt) {
        _latitude = lat;
        _longitude = lon;
        _altitude = alt;
    }    
    public QualifiedCoordinates getQualifiedCoordinates() {
        QualifiedCoordinates c = new QualifiedCoordinates(_latitude,
                _longitude, _altitude, _horAcc, _verAcc);
        return c;
    }    
    public float getSpeed() {
        return _speed;
    }    
    public String toString() {
        String result = "Lat:" + String.valueOf(_latitude) + "|Lon:"
                + String.valueOf(_longitude) + "|Alt:"
                + String.valueOf(_altitude);
        return result;
    }
} 
```

然后在屏幕上的某个地方

```
 MockupLocationProvider gpsProvider = new MockupLocationProvider();
    GPSLocation loc = (GPSLocation)gpsProvider.getLocation(0);
    add(new RichTextField(loc.toString())); 
```

## 外部 GPS 样机

另一种选择是通常模拟 GPS 信号。
步骤是：

*   为蓝牙配置设备 GPS 接收器（例如）
*   在您的桌面上设置一些开源 gps 服务器以通过蓝牙生成位置数据
*   更改 gps 服务器的配置/代码以模拟位置数据

## 其他选项

通过用一些无线电材料（如铝箔等）屏蔽 gps 接收器，有可能不受控制地改变位置 gps 数据:)

# android - 将数据发送回 Android 中的主 Activity

> ID：920306
> 
> 赞同：322
> 
> 时间：2009-05-28T11:06:11.130
> 
> 标签：android, android-intent

我有两个活动：主要活动和子活动。
当我在主活动中按下按钮时，将启动子活动。

现在我想将一些数据发送回主屏幕。我使用了 Bundle 类，但它不起作用。它会引发一些运行时异常。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：508
> 
> 时间：2009-06-03T22:14:57.293

根据具体情况，有几种方法可以实现您想要的。

最常见的场景（听起来就是这样）是子 Activity 用于获取用户输入 - 例如从列表中选择联系人或在对话框中输入数据。在这种情况下，您应该使用[`startActivityForResult`](http://developer.android.com/reference/android/app/Activity.html#startActivityForResult%28android.content.Intent,%20int%29)来启动您的子活动。

这提供了一个管道，用于使用[`setResult`](http://developer.android.com/reference/android/app/Activity.html#setResult%28int%29). setResult 方法接受一个 int 结果值和一个 Intent，该 Intent 被传回调用的 Activity。

```
Intent resultIntent = new Intent();
// TODO Add extras or a data URI to this intent as appropriate.
resultIntent.putExtra("some_key", "String data"); 
setResult(Activity.RESULT_OK, resultIntent);
finish(); 
```

在调用 Activity override 中访问返回的数据`onActivityResult`。requestCode对应`startActivityForResult`调用中传入的整数，而resultCode和data Intent是从子Activity返回的。

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
  super.onActivityResult(requestCode, resultCode, data);
  switch(requestCode) {
    case (MY_CHILD_ACTIVITY) : {
      if (resultCode == Activity.RESULT_OK) {
        // TODO Extract the data returned from the child Activity.
        String returnValue = data.getStringExtra("some_key");
      }
      break;
    } 
  }
} 
```

* * *

## 回答 #2

> 赞同：195
> 
> 时间：2012-11-13T14:41:58.400

活动 1 使用[startActivityForResult](http://developer.android.com/reference/android/app/Activity.html#startActivityForResult%28android.content.Intent,%20int%29)：

```
startActivityForResult(ActivityTwo, ActivityTwoRequestCode); 
```

Activity 2 已启动，您可以执行操作，要关闭 Activity，请执行以下操作：

```
Intent output = new Intent();
output.putExtra(ActivityOne.Number1Code, num1);
output.putExtra(ActivityOne.Number2Code, num2);
setResult(RESULT_OK, output);
finish(); 
```

活动 1 - 从上一个活动返回将调用[onActivityResult](http://developer.android.com/reference/android/app/Activity.html#onActivityResult%28int,%20int,%20android.content.Intent%29)：

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == ActivityTwoRequestCode && resultCode == RESULT_OK && data != null) {
        num1 = data.getIntExtra(Number1Code);
        num2 = data.getIntExtra(Number2Code);
    }
} 
```

更新：回答 Seenu69 的评论，在活动二中，

```
int result = Integer.parse(EditText1.getText().toString()) 
           + Integer.parse(EditText2.getText().toString());
output.putExtra(ActivityOne.KEY_RESULT, result); 
```

然后在活动一中，

```
int result = data.getExtra(KEY_RESULT); 
```

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2016-12-05T08:19:47.197

# 发回数据

它帮助我在上下文中看待事物。这是一个用于发回数据的完整简单项目。这里没有提供 xml 布局文件，而是提供图像。

[![在此处输入图像描述](https://i.stack.imgur.com/Tyhf8.png)](https://i.stack.imgur.com/Tyhf8.png)

# 主要活动

*   使用 启动第二个活动`startActivityForResult`，为其提供任意结果代码。
*   覆盖`onActivityResult`。当第二个活动完成时调用它。您可以通过检查请求代码确保它实际上是第二个活动。（当您从同一个主要活动开始多个不同活动时，这很有用。）
*   提取从 return 中获得的数据`Intent`。使用键值对提取数据。

*MainActivity.java*

```
public class MainActivity extends AppCompatActivity {

    private static final int SECOND_ACTIVITY_REQUEST_CODE = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    // "Go to Second Activity" button click
    public void onButtonClick(View view) {

        // Start the SecondActivity
        Intent intent = new Intent(this, SecondActivity.class);
        startActivityForResult(intent, SECOND_ACTIVITY_REQUEST_CODE);
    }

    // This method is called when the second activity finishes
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        // Check that it is the SecondActivity with an OK result
        if (requestCode == SECOND_ACTIVITY_REQUEST_CODE) {
            if (resultCode == RESULT_OK) {

                // Get String data from Intent
                String returnString = data.getStringExtra("keyName");

                // Set text view with string
                TextView textView = (TextView) findViewById(R.id.textView);
                textView.setText(returnString);
            }
        }
    }
} 
```

# 第二次活动

*   将要发送回上一个活动的数据放入`Intent`. 数据存储在`Intent`使用键值对中。
*   将结果设置为`RESULT_OK`并添加保存数据的意图。
*   调用`finish()`以关闭第二个活动。

*SecondActivity.java*

```
public class SecondActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_second);
    }

    // "Send text back" button click
    public void onButtonClick(View view) {

        // Get the text from the EditText
        EditText editText = (EditText) findViewById(R.id.editText);
        String stringToPassBack = editText.getText().toString();

        // Put the String to pass back into an Intent and close this activity
        Intent intent = new Intent();
        intent.putExtra("keyName", stringToPassBack);
        setResult(RESULT_OK, intent);
        finish();
    }
} 
```

# 其他注意事项

*   如果您在 Fragment 中，它将不知道`RESULT_OK`. 只需使用全名：`Activity.RESULT_OK`.

# 也可以看看

*   [更完整的答案](https://stackoverflow.com/a/45979367/3681880)，包括向前传递数据
*   [密钥字符串的命名约定](https://stackoverflow.com/a/40569184/3681880)

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2015-12-10T11:31:54.853

FirstActivity 使用 startActivityForResult：

```
Intent intent = new Intent(MainActivity.this,SecondActivity.class);
startActivityForResult(intent, int requestCode); // suppose requestCode == 2

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data)
{
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == 2)
    {
        String message=data.getStringExtra("MESSAGE");
    }
} 
```

在 SecondActivity 调用 setResult() onClick 事件或 onBackPressed()

```
Intent intent=new Intent();
intent.putExtra("MESSAGE",message);
setResult(Activity.RESULT_OK, intent); 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-05-28T12:47:46.400

使用 startActivityForResult() 方法调用来调用子活动 Intent

这里有一个例子：http: [//developer.android.com/training/notepad/notepad-ex2.html](http://developer.android.com/training/notepad/notepad-ex2.html)

并在“从屏幕返回结果”中：http: [//developer.android.com/guide/faq/commontasks.html#opennewscreen](http://developer.android.com/guide/faq/commontasks.html#opennewscreen)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2021-03-09T17:38:23.997

**2021 年 3 月更新**

与[Activity v1.2.0](https://developer.android.com/jetpack/androidx/releases/activity#1.2.0)和[Fragment v1.3.0](https://developer.android.com/jetpack/androidx/releases/fragment#version_130_3)`Activity Result APIs`一样，已经引入了新功能。

> 活动结果 API 提供了用于注册结果、启动结果以及在系统分派结果后处理结果的组件。

所以没有必要再使用`startActivityForResult`and`onActivityResult`了。

为了使用新的 API，您需要在源 Activity 中创建一个 ActivityResultLauncher，指定目标 Activity 完成并返回所需数据时将运行的回调：

```
private val intentLauncher =
    registerForActivityResult(ActivityResultContracts.StartActivityForResult()) { result ->

        if (result.resultCode == Activity.RESULT_OK) {
            result.data?.getStringExtra("key1")
            result.data?.getStringExtra("key2")
            result.data?.getStringExtra("key3")
        }
    } 
```

然后，在您需要时启动您的意图：

```
intentLauncher.launch(Intent(this, YourActivity::class.java)) 
```

要从目标 Activity 返回数据，您只需添加一个带有返回值的意图即可`setResult()`：

```
val data = Intent()
data.putExtra("key1", "value1")
data.putExtra("key2", "value2")
data.putExtra("key3", "value3")

setResult(Activity.RESULT_OK, data)
finish() 
```

有关任何其他信息，请参阅[Android 文档](https://developer.android.com/training/basics/intents/result)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2017-09-19T10:21:57.870

我创建了简单的演示类供您更好地参考。

> 第一活动.java

```
 public class FirstActivity extends AppCompatActivity {

    private static final String TAG = FirstActivity.class.getSimpleName();
    private static final int REQUEST_CODE = 101;
    private Button btnMoveToNextScreen;

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        btnMoveToNextScreen = (Button) findViewById(R.id.btnMoveToNext);
        btnMoveToNextScreen.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent mIntent = new Intent(FirstActivity.this, SecondActivity.class);
                startActivityForResult(mIntent, REQUEST_CODE);
            }
        });
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        if(resultCode == RESULT_OK){
            if(requestCode == REQUEST_CODE && data !=null) {
                String strMessage = data.getStringExtra("keyName");
                Log.i(TAG, "onActivityResult: message >>" + strMessage);
            }
        }

    }
} 
```

> 这是 SecondActivity.java

```
public class SecondActivity extends AppCompatActivity {

    private static final String TAG = SecondActivity.class.getSimpleName();
    private Button btnMoveToPrevious;
    private EditText editText;

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_second);

        editText = (EditText) findViewById(R.id.editText);

        btnMoveToPrevious = (Button) findViewById(R.id.btnMoveToPrevious);
        btnMoveToPrevious.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {

                String message = editText.getEditableText().toString();

                Intent mIntent = new Intent();
                mIntent.putExtra("keyName", message);
                setResult(RESULT_OK, mIntent);
                finish();

            }
        });

    }
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-08-05T10:32:53.993

在第一个活动中，您可以使用发送意图 `startActivityForResult()`，然后在完成使用后从第二个活动中获取结果`setResult`。

MainActivity.class

```
public class MainActivity extends AppCompatActivity {

    private static final int SECOND_ACTIVITY_RESULT_CODE = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    // "Go to Second Activity" button click
    public void onButtonClick(View view) {

        // Start the SecondActivity
        Intent intent = new Intent(this, SecondActivity.class);
        // send intent for result 
        startActivityForResult(intent, SECOND_ACTIVITY_RESULT_CODE);
    }

    // This method is called when the second activity finishes
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        // check that it is the SecondActivity with an OK result
        if (requestCode == SECOND_ACTIVITY_RESULT_CODE) {
            if (resultCode == RESULT_OK) {

                // get String data from Intent
                String returnString = data.getStringExtra("keyName");

                // set text view with string
                TextView textView = (TextView) findViewById(R.id.textView);
                textView.setText(returnString);
            }
        }
    }
} 
```

SecondActivity.class

```
public class SecondActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_second);
    }

    // "Send text back" button click
    public void onButtonClick(View view) {

        // get the text from the EditText
        EditText editText = (EditText) findViewById(R.id.editText);
        String stringToPassBack = editText.getText().toString();

        // put the String to pass back into an Intent and close this activity
        Intent intent = new Intent();
        intent.putExtra("keyName", stringToPassBack);
        setResult(RESULT_OK, intent);
        finish();
    }
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-02-19T09:36:32.943

所有这些答案都在解释您的第二个活动的场景需要在发送数据后完成。

但是，如果您不想完成第二个活动并希望将数据发送回第一个活动，那么您可以使用 BroadCastReceiver。

在第二个活动中 -

```
Intent intent = new Intent("data");
intent.putExtra("some_data", true);
LocalBroadcastManager.getInstance(this).sendBroadcast(intent); 
```

在第一个活动中-

```
private BroadcastReceiver tempReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        // do some action
    }
}; 
```

在 onCreate() 中注册接收者——

```
 LocalBroadcastManager.getInstance(this).registerReceiver(tempReceiver,new IntentFilter("data")); 
```

在 onDestroy() 中取消注册

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-18T15:53:13.187

根据您的情况，实现所需结果的另一种方法是创建一个侦听器接口。

通过让父活动侦听由子活动触发的接口，同时将所需数据作为参数传递，可以创建一组类似的情况

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-04-26T07:17:20.270

只是我认为上述答案中缺少的一个小细节。

如果您的子活动可以从多个父活动中打开，那么您可以`setResult`根据您的活动是否由`startActivity`或打开来检查您是否需要这样做`startActivityForResult`。您可以通过使用`getCallingActivity()`. 更多信息[在这里](https://stackoverflow.com/a/16753747/1973663)。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2016-12-16T06:07:51.250

有一些方法可以做到这一点。1.通过使用上面答案中很好解释的 startActivityForResult() 。

2.  通过在您的“Utils”类或您自己的任何其他类中创建静态变量。例如，我想将 ActivityB 中的 studentId 传递给 ActivityA。首先我的 ActivityA 正在调用 ActivityB。然后在 ActivityB 中设置 studentId（它是 Utils.class 中的静态字段）。像这样 Utils.STUDENT_ID="1234"; 然后在返回 ActivityA 时使用存储在 Utils.STUDENT_ID 中的 studentId。

3.  通过在应用程序类中创建 getter 和 setter 方法。

像这样：

```
public class MyApplication extends Application {

    private static MyApplication instance = null;
    private String studentId="";

    public static MyApplication getInstance() {
        return instance;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        instance = this;
    }

    public void setStudentId(String studentID){
        this.studentId=studentID;
    }

    public String getStudentId(){
        return this.studentId;
    }
} 
```

这样你就完成了。当你在 ActivityB 中时，只需在里面设置数据，然后回到 ActivityA ，获取数据。

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2013-07-08T06:43:59.343

使用**sharedPreferences**并保存您的数据并从应用程序的任何位置访问它

像这样保存日期

```
SharedPreferences sharedPreferences = getPreferences(MODE_PRIVATE);
    SharedPreferences.Editor editor = sharedPreferences.edit();
    editor.putString(key, value);
    editor.commit(); 
```

并接收这样的数据

```
SharedPreferences sharedPreferences = getPreferences(MODE_PRIVATE);
    String savedPref = sharedPreferences.getString(key, "");
    mOutputView.setText(savedPref); 
```

# hibernate - 左外连接提取未正确填充地图集合（HQL）

> ID：920309
> 
> 赞同：2
> 
> 时间：2009-05-28T11:06:55.123
> 
> 标签：hibernate, join, map, one-to-many

我有这样的映射类：

```
@Entity
public class CurrencyTable {
    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE)
    private Long id;

    @Version
    @Column(nullable=false)
    private Timestamp version;

    @Column(length=32, unique=true)
    private String refCode;

   @OneToMany(mappedBy="currencyTable", fetch=FetchType.LAZY, cascade =  {CascadeType.ALL})
   @MapKey(name="currency")
   private Map<String, CurrencyTableRate> rateMap = new HashMap<String, CurrencyTableRate>();
}

@Entity
public class CurrencyTableRate{
    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE)
    private Long id;

    @Version
    @Column(nullable=false)
    private Timestamp version;

    @Column(length=3)
    private String currency;

    @Basic
    private BigDecimal rateValue;

    @ManyToOne(optional=false,fetch=FetchType.LAZY)
    private CurrencyTable currencyTable;
} 
```

CurrencyTable 中有 1 行，CurrencyTableRate 中有 3 行引用数据库中的 CurrencyTable。

当我使用 HQL 加载 CurrencyTable 时：

```
from CurrencyTable where refCode = :refCode 
```

我在 rateMap 中得到一个包含三个条目的实体，但如果我尝试这个：

```
from CurrencyTable table left outer join fetch table.rateMap where refCode = :refCode 
```

rateMap 中只有一个条目。

我查看了 Hibernate 生成的查询并手动运行它——它返回了三行，正如预期的那样，所以在获取后映射它们似乎是一个问题。有没有人遇到过这样的问题？我使用 Hibernate 版本 3.2.6.ga 和 Oracle 10g

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T14:30:41.653

首先，我建议您为 refCode 添加一个别名。我认为这不会对结果产生影响，但以防万一。

```
from CurrencyTable table left outer join fetch table.rateMap where table.refCode = :refCode 
```

其次，打开您的 SQL 代码并分析 SQL 级别的实际情况。在这种情况下，我对 HQL 有类似的问题

```
from CurrencyTable table left outer join fetch table.rateMap map where map.id = :id 
```

我必须重写

```
from CurrencyTable table left outer join fetch table.rateMap map where EXISTS (SELECT a.id from CurrencyTable table a INNER JOIN a.rateMap m WHERE m.id = :id and table.id=a.id) 
```

希望我的提示会有所帮助。

# c++ - std::multimap 编译错误

> ID：920312
> 
> 赞同：1
> 
> 时间：2009-05-28T11:07:27.850
> 
> 标签：c++, visual-studio-2008, mfc

我第一次尝试使用 multimap，但我的应用程序无法编译。蒂亚保罗..

```
// file dept.h

typedef std::multimap <CString, std::map< CString, CString> > _DeparmentRecord;  // also tryied replacing CString with LPCWSTR

_DeparmentRecord DeparmentRecord;

// file dept.cpp

DWORD CIni::AddNameValue(LPCWSTR Section, LPCWSTR Name, LPCWSTR Value)
{

DeparmentRecord.insert(std::make_pair ( Section, std::make_pair(Name, Value)) );  <-- error here

} 
```

c:\program files\microsoft visual studio 9.0\vc\include\utility(57)：错误 C2664：'std::map<_Kty,_Ty>::map(const std::less<_Ty> &)'：不能将参数 1 从 'const std::pair<_Ty1,_Ty2>' 转换为 'const std::less<_Ty> &'

1> 与 1> [ 1> _Kty=CString, 1> _Ty=CString 1> ] 1> 和 1> [ 1> _Ty1=LPCWSTR, 1> _Ty2=LPCWSTR 1> ] 1> 和 1> [ 1> _Ty= CString 1> ] 1> 原因：无法从 'const std::pair<_Ty1,_Ty2>' 转换为 'const std::less<_Ty>' 1> with 1> [ 1> _Ty1=LPCWSTR, 1> _Ty2= LPCWSTR 1> ] 1> and 1> [ 1> _Ty=CString 1> ] 1> 没有可以执行此转换的用户定义转换运算符，或者无法调用该运算符 1> c:\dev\projects\migrator \jobbuilder\jobbuilder\ini.cpp(55) ：参见对函数模板实例化 'std:: 的引用pair<_Ty1,_Ty2>::pair>(const std::pair> &)' 正在编译 1> 与 1> [ 1> _Ty1=const CString, 1> _Ty2=std::map 1> ]

========== 构建：0 成功，1 失败，0 最新，0 跳过 ==========

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T11:11:53.893

您正在尝试将 a 插入`pair< section, pair<...> >`到需要`pair< section, map<...> >`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T11:23:02.517

更改功能如下。

```
DWORD AddNameValue(LPCWSTR  Section, LPCWSTR  Name, LPCWSTR  Value)
{
    std::map<CString, CString> aTemp;
    aTemp.insert(std::make_pair (Name, Value));
    DeparmentRecord.insert(std::make_pair (Section, aTemp)) ;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T11:12:29.027

std::make_pair(Name, Value) 是一对......但它应该是一张地图。

STL 错误可能是一个真正的痛苦。使用最新版本的 GCC 会有所帮助，它的错误消息得到了很大改进，但我看到你正在使用 MSVC，所以这对你没有多大帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T11:13:09.087

除了其他答案之外，std::make_pair 将返回一个 std::pair。不要指望编译器会为您执行从 LPCWSTR 到 CString 的转换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T11:37:01.753

除了其他正确答案之外，如果您使用`_DeparmentRecord`'s `value_type`typedef 而不是`make_pair`.

```
DWORD AddNameValue(LPCWSTR Section, LPCWSTR Name, LPCWSTR Value)
{
  _DeparmentRecord::iterator i =
      DeparmentRecord.insert(_DeparmentRecord::value_type(Section, v)).first;
  i->second[Name] = Value;
} 
```

And a small point: don't use leading underscores for non-local names - they're reserved for the standard library.

# javascript - 动态添加行 javascript 函数在 Firefox 中有效，但在 IE 中无效

> ID：920324
> 
> 赞同：0
> 
> 时间：2009-05-28T11:10:49.403
> 
> 标签：javascript

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>  
 <head>  
     <title>:: Gharsansar Spices Order Form ::</title>

<script language="javascript" type="text/javascript">

         function addRow(tableID) 
         {  
            var rowCount;
            var rowno;
            var table = document.getElementById(tableID);  
            rowCount = table.rows.length;  
            var row = table.insertRow(rowCount);
            row.id = "row"+rowCount;            

            rowno = row.id; 

            var cell1 = row.insertCell(0);  
            var element1 = document.createElement("input");  
            element1.type = "checkbox";  
            cell1.appendChild(element1);  

            var cell2 = row.insertCell(1);  
            cell2.innerHTML = rowCount + 1;  
            cell2.className ="style2";  

            var cell3 = row.insertCell(2);
            var e1 = document.createElement('select');
            e1.name = 'Category['+rowCount+']';
            e1.id = 'Category['+rowCount+']';
            e1.setAttribute("onclick","javascript:SelectSubCat(this);");

            choice = document.createElement('option');
            choice.value = ':: Select A Product ::';
            choice.appendChild(document.createTextNode(':: Select A Product ::'));
            e1.appendChild(choice);

            var choice = document.createElement('option');
            choice.value = 'Jalani Jaljira';
            choice.appendChild(document.createTextNode('Jalani Jaljira'));
            e1.appendChild(choice);

            choice = document.createElement('option');
            choice.value = 'Pav Bhaji Masala';
            choice.appendChild(document.createTextNode('Pav Bhaji Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Sambhar Masala';
            choice.appendChild(document.createTextNode('Sambhar Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Sabji Masala';
            choice.appendChild(document.createTextNode('Sabji Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Kitchen King Masala';
            choice.appendChild(document.createTextNode('Kitchen King Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Garam Masala';
            choice.appendChild(document.createTextNode('Garam Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Meat Masala';
            choice.appendChild(document.createTextNode('Meat Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Chat Masala';
            choice.appendChild(document.createTextNode('Chat Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Chicken Masala';
            choice.appendChild(document.createTextNode('Chicken Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Ghar Sansar Jaljira';
            choice.appendChild(document.createTextNode('Ghar Sansar Jaljira'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Dry Ginger Powder';
            choice.appendChild(document.createTextNode('Dry Ginger Powder'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Dry Mango Powder';
            choice.appendChild(document.createTextNode('Dry Mango Powder'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Pudina Powder';
            choice.appendChild(document.createTextNode('Pudina Powder'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Jeera Powder';
            choice.appendChild(document.createTextNode('Jeera Powder'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Black Pepper';
            choice.appendChild(document.createTextNode('Black Pepper'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'White Pepper Powder';
            choice.appendChild(document.createTextNode('White Pepper Powder'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Fennel Powder (Saunf)';
            choice.appendChild(document.createTextNode('Fennel Powder (Saunf)'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Kashmiri Mirch';
            choice.appendChild(document.createTextNode('Kashmiri Mirch'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Kasuri Methi';
            choice.appendChild(document.createTextNode('Kasuri Methi'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Jaljira';
            choice.appendChild(document.createTextNode('Jaljira'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Chana Chole Masala';
            choice.appendChild(document.createTextNode('Chana Chole Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Super Garam Masala';
            choice.appendChild(document.createTextNode('Super Garam Masala'));
            e1.appendChild(choice);
            choice = document.createElement('option');
            choice.value = 'Haldi Powder';
            choice.appendChild(document.createTextNode('Haldi Powder'));
            e1.appendChild(choice);

            choice = document.createElement('option');
            choice.value = 'Dhaniya Powder';
            choice.appendChild(document.createTextNode('Dhaniya Powder'));
            e1.appendChild(choice);

            choice = document.createElement('option');
            choice.value = 'Red Chilli Powder';
            choice.appendChild(document.createTextNode('Red Chilli Powder'));
            e1.appendChild(choice);         
            cell3.appendChild(e1);

            var cell4 = row.insertCell(3);
            e_sub_cat = document.createElement('select');
            e_sub_cat.name = 'SubCat['+rowCount+']';
            e_sub_cat.id = 'SubCat['+rowCount+']';
            cell4.appendChild(e_sub_cat);                   

          var cell5 = row.insertCell(4);
          var el = document.createElement('input');
          el.type = 'text';
          el.name = 'quantity[]';
          el.size = 20;
          el.setAttribute("onblur","javascript:check_numeric(this)");  
          cell5.appendChild(el); 

}  

function deleteRow(tableID)
{  
        try {  
        var table = document.getElementById(tableID);  
        var rowCount = table.rows.length;  
        for(var i=0; i<rowCount; i++) 
        {  
        var row = table.rows[i];  
        var chkbox = row.cells[0].childNodes[0];  
        if(null != chkbox && true == chkbox.checked) {  
            table.deleteRow(i);  
                rowCount--;  
              i--;  
             }  
        }  
  }catch(e) {  
     alert(e);  
}  
}  

function check_numeric(control)
{
    var val=control.value;
    var first=val.substring(0,1);
    if(isNaN(val))
    {
        alert("Enter a numeric value only!");
        control.value="";
        control.focus();
    }
    if(first=="-")
    {
        alert("Enter a numeric value only!");
        control.value="";
        control.focus();
    }

    return true;
}

function SelectSubCat(control_value)
{
    // ON selection of category this function will work
    //var sub_cat_id = document.getElementById('SubCat['+rowCount+']').id;
    var sub_cat_id = control_value.id;

    var mySplitResult   = sub_cat_id.split("[");
    var control_no      = mySplitResult[1]; 
    var control_row_no  = control_no.split("]");
    var row_num         = control_row_no[0];

    var i;

    for(i=document.getElementById('SubCat['+row_num+']').options.length-1;i>=0;i--)
    {
        document.getElementById('SubCat['+row_num+']').remove(i);
    }

    if(control_value.value == 'Jalani Jaljira')
    {
        addOption("2.5 gm", "2.5 gm",row_num);
        addOption("5 gm", "5 gm",row_num);
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);
        addOption("150 gm", "150 gm",row_num);
        addOption("300 gm", "300 gm",row_num);
        addOption("500 gm", "500 gm",row_num);
    }

    if(control_value.value == 'Pav Bhaji Masala')
    {
        addOption("15 gm", "15 gm",row_num);
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);
    }

    if(control_value.value == 'Sambhar Masala')
    {
        addOption("50gm", "50gm",row_num);
        addOption("100gm", "100gm",row_num);

    }   

    if(control_value.value == 'Sabji Masala')
    {
        addOption("15 gm", "15 gm",row_num);
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);
    }

    if(control_value.value == 'Kitchen King Masala')
    {
        addOption("15 gm", "15 gm",row_num);
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);
        addOption("1 Kg", "1 Kg",row_num);
    }

    if(control_value.value == 'Garam Masala')
    {
        addOption("50gm", "50gm",row_num);
        addOption("100gm", "100gm",row_num);

    }   

    if(control_value.value == 'Meat Masala')
    {
        addOption("15 gm", "15 gm",row_num);
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);
    }

    if(control_value.value == 'Chat Masala')
    {
        addOption("15 gm", "15 gm",row_num);
        addOption("50 gm", "50 gm",row_num);
        addOption("200 gm", "200 gm",row_num);
    }

    if(control_value.value == 'Chana Masala')
    {
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'Chicken Masala')
    {
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'Ghar Sansar Jaljira')
    {
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'Dry Ginger Powder')
    {
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'Dry Mango Powder')
    {
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'Pudina Powder')
    {
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'Jeera Powder')
    {
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'Black Pepper')
    {
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'White Pepper Powder')
    {
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'Fennel Powder (Saunf)')
    {
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);

    }

    if(control_value.value == 'Kashmiri Mirch')
    {
        addOption("100 gm", "100 gm",row_num);
        addOption("1 Kg", "1 Kg",row_num);

    }

    if(control_value.value == 'Kasuri Methi')
    {
        addOption("25 gm", "25 gm",row_num);
        addOption("50 gm", "50 gm",row_num);
        addOption("100 gm", "100 gm",row_num);
        addOption("500 gm", "500 gm",row_num);

    }

    if(control_value.value == 'Jaljira')
    {
        addOption("15 gm", "15 gm",row_num);

    }

    if(control_value.value == 'Chana Chole Masala')
    {
        addOption("15 gm", "15 gm",row_num);

    }

    if(control_value.value == 'Super Garam Masala')
    {
        addOption("100 gm", "100 gm",row_num);
        addOption("200 gm", "200 gm",row_num);
        addOption("1 Kg", "1 Kg",row_num);

    }

    if(control_value.value == 'Haldi Powder')
    {
        addOption("100 gm", "100 gm",row_num);
        addOption("200 gm", "200 gm",row_num);
        addOption("500 gm", "500 gm",row_num);
        addOption("1 Kg", "1 Kg",row_num);
    }

    if(control_value.value == 'Dhaniya Powder')
    {
        addOption("100 gm", "100 gm",row_num);
        addOption("200 gm", "200 gm",row_num);
        addOption("500 gm", "500 gm",row_num);
        addOption("1 Kg", "1 Kg",row_num);
    }

    if(control_value.value == 'Red Chilli Powder')
    {
        addOption("100 gm", "100 gm",row_num);
        addOption("200 gm", "200 gm",row_num);
        addOption("500 gm", "500 gm",row_num);
        addOption("1 Kg", "1 Kg",row_num);
    }
}////////////////// 

function addOption(value, text, rno)
{
    var optn = document.createElement("OPTION");
    optn.text = text;
    optn.value = value;

    //if(rowCount==undefined)
    //  rowCount=0; 

    document.getElementById('SubCat['+rno+']').options.add(optn);

}
     </script> 
<style type="text/css">
<!--
.style1 {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; color: #0066FF;}
.style2 {border:0px; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; color:#0066FF; font-weight:bold;}
.style3 {
    font-size: 14px;
    font-weight: bold;
}
.table{border: 2px solid #CCCCCC;}
.button{background-color:#0099FF; font-family:Verdana, Arial, Helvetica, sans-serif; font-weight: bold; color:#FFFFFF; font-size:12px; }
.table_cell_new {
    font-size:11px;
    font-family:Verdana, sans-serif, serif, Arial, Helvetica;
    color: #555859;
    font-weight: 300;
    width: 180px;
}
.line {
 color:#CCCCCC; size:inherit; border-bottom:solid;
}
.style4 {font-family: Verdana, Arial, Helvetica, sans-serif;}
.style5 {font-size: 12px;}

-->
     </style> 
 </head>  
<body>
<table width="583" border="0" align="center">
  <tr>
    <td width="596" height="298">
    <form name="drop_list" method="post" action="submitorder.php" enctype="multipart/form-data" >
      <table width="581" border="0" align="center" class="table">
        <tbody>
        <tr>
          <td height="149" valign="top"><table width="476" border="0" align="left">
              <tr>
                <td height="34" colspan="3" class="style1 style3">Submit Order Details</td>
              </tr>
              <tr>
                <td width="138" class="txtLabel style4 style5">Company Name</td>
                <td width="328" colspan="2"><label>
                  <input name="companyname" type="text" class="table_cell_new" id="companyname" maxlength="50" />
                </label></td>
              </tr>
              <tr>
                <td class="txtLabel style4 style5">Address</td>
                <td colspan="2"><input name="address" type="text" class="table_cell_new" id="address" maxlength="50" /></td>
              </tr>
              <tr>
                <td class="txtLabel style4 style5">Contact No.</td>
                <td colspan="2"><input name="contactno" type="text" class="table_cell_new" id="contactno" maxlength="15" /></td>
              </tr>
              <tr>
                <td class="txtLabel style4 style5">Email Add.</td>
                <td colspan="2"><input name="email" type="text" class="table_cell_new" id="email" maxlength="15" /></td>
              </tr>
              <tr>
                <td height="11" colspan="3" valign="top"></td>
              </tr>
          </table></td>
        </tr>
        <tr>
          <td height="10" valign="top" class="line">&nbsp;</td>
        </tr>
        <tr>
          <td width="571" height="56" valign="top"><table width="570" border="0">
              <tr>
                <td width="52" class="style2">Select </td>
                <td width="51" align="left" class="style2"><div align="left">S. No.</div></td>
                <td width="197" align="left" class="style2"><div align="left">Product Name</div></td>
                <td width="103" align="left" class="style2"><div align="left">Variation</div></td>
                <td width="145" align="left" class="style2"><div align="left">Quantity</div></td>
              </tr>
            </table>
              <table id="dataTable" width="571" border="0">
                <tr>
                  <td width="60">&nbsp;</td>
                  <td width="56" class="style2"> 1 </td>
                  <td width="204" align="left"><div align="left">
                      <select name="Category[0]" id="Category[0]" onChange="SelectSubCat(this);">
                        <option value="0" selected="true">:: Select A Product ::</option>
                        <option value="Jalani Jaljira">Jalani Jaljira</option>
                        <option value="Pav Bhaji Masala">Pav Bhaji Masala</option>
                        <option value="Sambhar Masala">Sambhar Masala</option>
                        <option value="Sabji Masala">Sabji Masala</option>
                        <option value="Kitchen King Masala">Kitchen King Masala</option>
                        <option value="Garam Masala">Garam Masala</option>
                        <option value="Meat Masala">Meat Masala</option>
                        <option value="Chat Masala">Chat Masala</option>
                        <option value="Chicken Masala">Chicken Masala </option>
                        <option value="Ghar Sansar Jaljira">Ghar Sansar Jaljira</option>
                        <option value="Dry Ginger Powder">Dry Ginger Powder</option>
                        <option value="Dry Mango Powder">Dry Mango Powder</option>
                        <option value="Pudina Powder">Pudina Powder</option>
                        <option value="Jeera Powder">Jeera Powder</option>
                        <option value="Black Pepper">Black Pepper</option>
                        <option value="White Pepper Powder">White Pepper Powder</option>
                        <option value="Fennel Powder (Saunf)">Fennel Powder (Saunf) </option>
                        <option value="Kashmiri Mirch">Kashmiri Mirch </option>
                        <option value="Kasuri Methi">Kasuri Methi </option>
                        <option value="Jaljira">Jaljira </option>
                        <option value="Chana Chole Masala">Chana Chole Masala </option>
                        <option value="Super Garam Masala">Super Garam Masala</option>
                        <option value="Haldi Powder">Haldi Powder </option>
                        <option value="Dhaniya Powder">Dhaniya Powder</option>
                        <option value="Red Chilli Powder">Red Chilli Powder</option>
                      </select>
                  </div></td>
                  <td width="109" align="left"><div align="left">
                      <select name="SubCat[0]" id="SubCat[0]">
                      </select>
                  </div></td>
                  <td width="120"><input name="quantity[]" type="text" size="20" maxlength="25" onblur="return check_numeric(this);"/></td>
                </tr>
              </table>
            <br>
              <input type="button" class="button" onClick="addRow('dataTable')" value="Add More" />
              <input type="button" class="button" onClick="deleteRow('dataTable')" value="Delete Row" />
              <input name="Submit" type="submit" class="button" value="Submit Details" />
          </td>
        </tr>
        </tbody>
      </table>
        </form>
    </td>
  </tr>
</table>
</body>  
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T15:45:19.983

```
e1.setAttribute("onclick","javascript:SelectSubCat(this);"); 
```

我认为这条线可能是原因。看下面（第一行用`"onchange"`，但是用 JS 添加的行用`"onclick"`...）：

```
document.getElementById("Category[0]").onchange // the first row
>> function() 
```

但，

```
document.getElementById("Category[1]").onclick // the second row
>> "SelectSubCat(this);" 
```

即 Internet Explorer 设置`onclick`为字符串！（顺便说一句，添加侦听器的推荐方法是使用[`addEventListener`](https://developer.mozilla.org/En/DOM:element.addEventListener)（但 IE 忽略它并使用它自己的[`attachEvent`](http://msdn.microsoft.com/en-us/library/ms536343(VS.85,loband).aspx)！）。）无论如何，有一种 DOM 0 方法可以在 IE 和 Fx 中工作（afaic）`element.onevent`。使用此方法时不必传递`this`给函数，只需将上一行替换为（`this`=单击的元素，调用函数时）：

```
e1.onchange = SelectSubCat; 
```

但是，您必须更改第一行调用`SelectSubCat`和使用的方式，`this`而不是`control_value`在函数中。

最后一件事，类似的行：

```
el.setAttribute("onblur","javascript:check_numeric(this)"); 
```

你必须在这里做同样的事情。

你可能应该听听所有人[对你大喊大叫你](https://stackoverflow.com/questions/920324/dynamic-add-row-javascript-function-works-in-firefox-but-not-in-ie/920368#920368)的函数有多糟糕（也许一些数组可能有助于清理代码的某些部分）。并且（最后一个“和”:)，如果没有 JS，此页面将无法工作，因此已损坏。

（有关 JS 中事件的更多信息，请参阅事件[简介](http://www.quirksmode.org/js/introevents.html)。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T11:22:58.053

尝试将大量函数重构为更小的部分（您可以使用标准函数来添加选项元素），这将意味着更少的复制/粘贴代码。

然后，您可以通过这些函数添加简单的调试语句以查看发生了什么。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-28T11:29:15.967

没有阅读全文-您粘贴了*太多*代码-但我会猜测问题所在。

IE 有一个众所周知的问题，它无法使用 DOM 方法动态添加表格单元格。改用innerHTML，这是可行的。

# php - php脚本无法发送标头，因为标头已经发送，但是是脚本之外的字符

> ID：920330
> 
> 赞同：1
> 
> 时间：2009-05-28T11:12:17.000
> 
> 标签：php, header

这是我的前两行：

```
<?php
header('Content-Type: application/x-javascript'); 
```

它给了我已经在第 1 行发送的标题。

它旨在生成一个从 HTML 页面加载的 JavaScript 文件，当从 Firebug 检查 JavaScript 文件时，我得到以下文件：

```
1  ï»¿<br />
2  <b>Warning</b>: Cannot modify header information - headers already sent by (output started at C:\Program Files\Apache Group\Apache2\htdocs\totoro\Js\libs.php:1) in <b>C:\Program Files\Apache Group\Apache2\htdocs\totoro\Js\libs.php</b> on line <b>1</b><br />
3  var Totoro = {}, $t = Totoro; 
```

如您所见，它吐出一个看起来像垃圾字符的字符，但什么也没发送，第一行是一个`header`函数调用。可能是什么问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-28T11:14:04.420

您很可能已将文件保存为带有[BOM](http://en.wikipedia.org/wiki/Byte-order_mark)（字节顺序标记）的 UTF-8，将其重新保存为 UTF-8 而无需提及。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T11:13:38.947

这个字符序列是[UTF-8 BOM](http://en.wikipedia.org/wiki/Byte-order_mark#Representations_of_byte_order_marks_by_encoding)。使用 UTF-8 时，无需 BOM（有时也称为签名）保存文件。

此外，您应该声明您正在使用的编码。因为 UTF-8 BOM 显示为您命名的字符，所以您的数据可能会使用 ISO 8859-1 解释，因为 UTF-8 BOM 字节序列 0xEFBBBF 代表字符`ï`(0xEF)、`»`(0xBB) 和`¿`(0xBF) ISO 8859-1。

因此，删除 BOM 并使用此`Content-Type`标头字段以及正确的 MIME 类型`application/javascript`和`charset`参数：

```
Content-Type: application/javascript;charset=utf-8 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T11:30:48.460

我在维基百科上找到了这个： [http ://en.wikipedia.org/wiki/Byte-order_mark#Representations_of_byte_order_marks_by_encoding](http://en.wikipedia.org/wiki/Byte-order_mark#Representations_of_byte_order_marks_by_encoding)

这让我更改了我的 Komodo 编辑器的首选项，并且选中了“编码：使用签名 (BOM)”。一旦取消选中，问题就解决了。

# c# - 如何运行多线程应用程序？

> ID：920333
> 
> 赞同：0
> 
> 时间：2009-05-28T11:12:29.137
> 
> 标签：c#, .net, winforms

这些代码给我们带来了这个错误：

**跨线程操作无效：控件“progressBar2”从创建它的线程以外的线程访问。**

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using System.Threading;

namespace ThreadingTest1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        ThreadStart ts1;
        ThreadStart ts2;
        Thread t1;
        Thread t2;

        private void btnStart_Click(object sender, EventArgs e)
        {
            ts1 = new ThreadStart(z1);
            ts2 = new ThreadStart(z2);

            t1 = new Thread(ts1);
            t2 = new Thread(ts2);

            t1.Start(); 
            t2.Start();

            btnStart.Enabled = false;
        }

        public void z1()
        {

            for (int i = 1; i < 60; ++i)
            {
                progressBar1.Value += 1;
                for (int j = 1; j < 10000000; ++j)
                {
                    j += 1;
                }
            }
        }

        public void z2()
        {
            for (int k = 1; k < 100; ++k)
            {
                progressBar2.Value += 1;
                for (int j = 1; j < 25000000; ++j)
                {
                    j += 1;
                }
            }
        }

        private void btnstop_Click(object sender, EventArgs e)
        {
            t1.Suspend(); 
            t2.Suspend();
        }

        private void btnContinue_Click(object sender, EventArgs e)
        {
            t1.Resume(); 
            t2.Resume();

        }

        private void btnClose_Click(object sender, EventArgs e)
        {
            if (t1.IsAlive)
            {
                MessageBox.Show("Çalışan threadler var program sonlanamaz.");
            }
            else
            {
                this.Close();
            } 

        }
    }
}
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T11:16:17.443

您不能在负责该控件的 UI 线程以外的线程中访问 UI 控件。

请参阅我的线程教程中的[WinForms](http://pobox.com/~skeet/csharp/threads/winforms.shtml)页面，并搜索有关`BackgroundWorker`.NET 2.0 中引入的组件的教程，该组件使生活变得更加轻松（尤其是进度条）。

此外，我会尽量避免使用`Thread.Suspend`/ `Resume`，而是更喜欢更合作的方法（例如使用`Monitor.Wait`/ `Pulse`）。这使您可以避免在线程持有锁时挂起线程等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T11:19:37.733

对于 z1 和 z2，请执行以下操作：在 InvokeRequired 检查之后在 z() 中添加 zSafe() 调用 zSafe()。

```
public void z1Safe()
        {

            for (int i = 1; i < 60; ++i)
            {
                progressBar1.Value += 1;
                for (int j = 1; j < 10000000; ++j)
                {
                    j += 1;
                }
            }
        }

        public void z1()
        {

            if (this.InvokeRequired)
            {
                this.Invoke((MethodInvoker)delegate { z1Safe(); });
            }
            else
                z1Safe();
        } 
```

我刚刚在我的 Windows 表单中为 asyn del 调用实现了一个类似的解决方案，它工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:46:27.457

当您在多线程应用程序上工作时，跨线程异常非常常见，并且当您尝试在其自己的线程之外的线程中调用控件的成员时会发生这种情况。为避免这种情况，您可以检查该控件的 InvokeRequired 属性并调用在自己的线程中委托或使用 BackgroundWorker 在后台（另一个线程）运行进程并处理其事件，当您处理 BackgroundWorker 事件时，事件处理程序方法将在主线程上运行，因此无需调用委托。

[在这里](http://www.google.com/search?q=BackgroundWorker&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)您可以找到有关 BackgroundWorker 的一些信息

# asp.net - 如何不使用 ASP.Net Membership Security Question and Answer 进行自定义密码恢复？

> ID：920334
> 
> 赞同：2
> 
> 时间：2009-05-28T11:12:56.920
> 
> 标签：asp.net, asp.net-membership, forgot-password, change-password

我不想拥有 ASP.Net Membership Provider 提供的安全问答功能，但我确实想启用丢失/忘记的密码页面。

此页面将是用户输入他/她的电子邮件地址的地方，如果用户已注册，则电子邮件将发送到该地址，以便他们通过发送到该注册电子邮件地址的链接重置密码

我创建了自定义表来跟踪此类请求、分配给请求的随机键以及请求的到期日期。然而，在编写代码以实际重置密码时，我意识到似乎没有一种方法可以在不需要使用安全问答位（我没有）的情况下执行 ResetPassword(email, newPassword) 之类的操作。

有没有办法通过内置的会员功能简单地重置用户的密码？

如果没有，我将如何完成这项工作？

提前感谢您提供的任何帮助。-日产

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T11:36:37.463

我最终做的是以下

```
public string ResetPassword(string email)
        {
            var m_userName = Membership.GetUserNameByEmail(email);
            var m_user = Membership.GetUser(m_userName);
            return m_user.ResetPassword();
        } 
```

然后我添加了一个新方法来使用这个值来更改密码

```
public bool ChangeLostPassword(string email, string newPassword)
    {
        var resetPassword = ResetPassword(email);
        var currentUser = Membership.GetUser(Membership.GetUserNameByEmail(email), true);
        return currentUser.ChangePassword(resetPassword, newPassword);

    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T14:32:54.067

为什么不在 web.config 中更改此选项？

```
 enablePasswordRetrieval="false"
         enablePasswordReset="true"
         requiresQuestionAndAnswer="false" 
```

在

```
<membership>
   <providers>
      <clear/>
      <add name="AspNetSqlMembershipProvider" ...
      .......... 
```

# java - 如何在 Java 中解析格式错误的 XML？

> ID：920344
> 
> 赞同：10
> 
> 时间：2009-05-28T11:15:00.910
> 
> 标签：java, xml, parsing, entities

我有需要解析但无法控制创建的 XML。不幸的是，它不是非常严格的 XML，并且包含以下内容：

```
<mytag>This won't parse & contains an ampersand.</mytag> 
```

javax.xml.stream 类根本不喜欢这样，并且正确地错误：

```
javax.xml.stream.XMLStreamException: ParseError at [row,col]:[149,50]
Message: The entity name must immediately follow the '&' in the entity reference. 
```

我该如何解决这个问题？我无法更改 XML，所以我想我需要一个容错解析器。

我的偏好是不需要对现有解析器代码造成太多破坏的修复。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-28T11:16:33.340

使用诸如`tidy`或之类的库`tagsoup`。

[TagSoup 是一个用 Java 编写的符合 SAX 的解析器，它不是解析格式良好或有效的 XML，而是解析在野外发现的 HTML：糟糕、肮脏和野蛮，尽管通常很不短。](http://home.ccil.org/~cowan/XML/tagsoup/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T11:19:52.677

如果它不是有效的 XML（如上），则没有 XML 解析器会处理它（正如您所确定的）。如果您知道错误的范围（例如上述实体问题），那么最简单的解决方案可能是对其运行更正过程（修复实体，例如插入实体），然后将其提供给现有的解析器。

否则，您必须自己编写一个内置支持此类异常的代码。我无法相信这只是一项乏味且容易出错的任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-16T21:39:33.330

我相信 JSoup 可以处理格式错误的 XML

# .net - 在 Intranet、ASP.NET、单服务器应用程序中设置 CultureInfo 是否浪费时间？

> ID：920345
> 
> 赞同：0
> 
> 时间：2009-05-28T11:15:58.910
> 
> 标签：.net, asp.net, cultureinfo

我正在查看为 ToString 和数字转换和日期使用设置 CultureInfo 的 1000 段代码。该应用程序仅由一个单语办公室在一个城镇的一台服务器上使用，并且永远不会转移到另一个国家。

我认为这些是从 FxCop 关于国际化的错误建议中得到的。

在这种情况下有什么理由设置 CultureInfo 吗？我想念任何不寻常的原因吗？

更新：
如果有这个原因，新代码应该复制这种使用 CultureInfo 引用向代码发送垃圾邮件的约定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T11:30:38.570

[YAGNI](http://en.wikipedia.org/wiki/You_Ain't_Gonna_Need_It)原则说：“总是在你真正需要的时候实现它们，而不是在你预见到你需要它们的时候。”

在您的情况下，您不是在推测是否需要国际化*，*而是说**不需要**它。在这种情况下不用担心，您可以控制服务器上的设置，所以不要在上面浪费时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T11:19:49.590

古老的格言，永远不要说在这里可能有用。

如果它已经完成，那么就把它留在那里，但显然如果它还没有完成，那么应该将一个商业案例放在一起，以确定它是否值得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T12:04:32.183

我在使用 FxCop 时遇到了与您相同的问题。我最终被国际化警告淹没了。我只担心在处理用户输入的数据时设置 CultureInfo，但我在美国为一家德国公司工作。我们有一些用户临时来到美国，他们为德国日期、数字格式等设置了机器。

在这一点上，我不会改变任何东西。如果该应用程序曾经在国际上移动或使用过，我相信你会在它之前做其他工作。我会等到那时再担心国际化。就我的两分钱...

# sql-server - 限制 SQLServer 中的 NVARCHAR 大小？

> ID：920347
> 
> 赞同：11
> 
> 时间：2009-05-28T11:16:25.867
> 
> 标签：sql-server, nvarchar

我想知道将 NVARCHAR 字段设置为 MAX 而不是 SQL Server 2008 中的特定大小会产生什么后果，并限制应用程序逻辑的输入。另外，这些会是一个糟糕的设计实践吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T11:27:04.177

NVARCHAR(MAX) 在处理较小数据方面比旧的 NTEXT 数据类型要好得多，但是，NVARCHAR(n) 在某些领域总是更有效。

作为一般规则，使用最能代表您存储的数据的数据类型几乎总是最佳实践。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T11:21:52.300

有很多[性能影响](http://www.google.com/search?q=varchar(max)+performance)。特别是，在通用字符串填充标量 UDF 中，我注意到在将输出声明为 VARCHAR(MAX) 时存在巨大的性能差异，即使输入从未超过 40 个字符。更改为 VARCHAR(50) 取得了巨大的进步。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T11:18:28.157

如果您知道由于 SQL 存储此类数据的方式，它们永远不会包含超过有限数量的字符，则不应将所有字段设置为 NVARCHAR(MAX) - 足够小以适合页面的数据将存储在页面，但是当它变得太大时，它将被移出页面并单独存储。

另外，您确定需要 NVARCHAR，因为它存储占用两倍于标准 VARCHAR 空间的 unicode 数据？如果您**知道**您将使用标准字符，请改用 VARCHAR。

慢慢地，想想你的应用程序的用途。如果您的地址字段在理论上没有大小限制，您将如何将其打印在信封上？你说你会在前端应用中实现逻辑，但是为什么还要让数据库有太大的数据呢？如果数据进入破坏了前端逻辑的数据库会发生什么？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T12:30:11.257

只是为了补充所有其他答案：还要注意数据可能来自其他来源的情况，例如 - 仅作为示例 - 从应用程序外部导入的文本文件；这可以绕过任何应用程序逻辑，除非您在导入例程中复制它......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T11:24:16.867

主要缺点是`NVARCHAR(MAX)`无法使用普通索引进行索引。

`NVARCHAR(MAX)`此外，类型变量和解析这些变量的函数的性能也存在一些问题。

如果您只想按原样存储和检索数据，而不是在`SQL Server`' 端解析它，那`NVARCHAR(MAX)`很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T11:36:46.810

设置限制对最大长度有一些验证的副作用

# php - 我可以将数组绑定到 IN() 条件吗？

> ID：920353
> 
> 赞同：605
> 
> 时间：2009-05-28T11:17:57.673
> 
> 标签：php, arrays, pdo, prepared-statement, where-in

我很想知道是否可以使用 PDO 将值数组绑定到占位符。这里的用例是尝试传递一个值数组以用于`IN()`条件。

我希望能够做这样的事情：

```
<?php
$ids=array(1,2,3,7,8,9);
$db = new PDO(...);
$stmt = $db->prepare(
    'SELECT *
     FROM table
     WHERE id IN(:an_array)'
);
$stmt->bindParam('an_array',$ids);
$stmt->execute();
?> 
```

并让 PDO 绑定并引用数组中的所有值。

目前我正在做：

```
<?php
$ids = array(1,2,3,7,8,9);
$db = new PDO(...);
foreach($ids as &$val)
    $val=$db->quote($val); //iterate through array and quote
$in = implode(',',$ids); //create comma separated list
$stmt = $db->prepare(
    'SELECT *
     FROM table
     WHERE id IN('.$in.')'
);
$stmt->execute();
?> 
```

哪个确实可以完成这项工作，但只是想知道我是否缺少内置的解决方案？

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2009-05-28T12:02:04.840

您必须构造查询字符串。

```
<?php
$ids     = array(1, 2, 3, 7, 8, 9);
$inQuery = implode(',', array_fill(0, count($ids), '?'));

$db = new PDO(...);
$stmt = $db->prepare(
    'SELECT *
     FROM table
     WHERE id IN(' . $inQuery . ')'
);

// bindvalue is 1-indexed, so $k+1
foreach ($ids as $k => $id)
    $stmt->bindValue(($k+1), $id);

$stmt->execute();
?> 
```

chris（评论）和someoneisintrouble都建议foreach循环......

```
(...)
// bindvalue is 1-indexed, so $k+1
foreach ($ids as $k => $id)
    $stmt->bindValue(($k+1), $id);

$stmt->execute(); 
```

... 可能是多余的，因此`foreach`循环和 the`$stmt->execute`可以替换为 ...

```
<?php 
  (...)
  $stmt->execute($ids); 
```

* * *

## 回答 #2

> 赞同：186
> 
> 时间：2012-05-23T15:10:49.870

对于一些快速的东西：

```
//$db = new PDO(...);
//$ids = array(...);

$qMarks = str_repeat('?,', count($ids) - 1) . '?';
$sth = $db->prepare("SELECT * FROM myTable WHERE id IN ($qMarks)");
$sth->execute($ids); 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2013-10-02T23:22:49.933

`IN`使用语句有那么重要吗？尝试使用`FIND_IN_SET`op。

例如，在 PDO 中有一个这样的查询

```
SELECT * FROM table WHERE FIND_IN_SET(id, :array) 
```

然后你只需要绑定一个值数组，用逗号内爆，就像这个

```
$ids_string = implode(',', $array_of_smth); // WITHOUT WHITESPACES BEFORE AND AFTER THE COMMA
$stmt->bindParam('array', $ids_string); 
```

它完成了。

UPD：正如一些人在对此答案的评论中指出的那样，有一些问题应该明确说明。

1.  `FIND_IN_SET`不在表中使用索引，它还没有实现 - 请参阅[MYSQL 错误跟踪器中的这条记录](http://bugs.mysql.com/bug.php?id=37564)。感谢@BillKarwin 的通知。
2.  您不能使用带有逗号的字符串作为数组的值进行搜索。`implode`由于您使用逗号作为分隔符，因此无法以正确的方式解析此类字符串。感谢@Val 的说明。

好吧，如果您不严重依赖索引并且不使用带逗号的字符串进行搜索，那么我的解决方案将比上面列出的解决方案更容易、更简单和更快。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2014-03-26T14:10:24.750

由于我做了很多动态查询，这是我做的一个超级简单的辅助函数。

```
public static function bindParamArray($prefix, $values, &$bindArray)
{
    $str = "";
    foreach($values as $index => $value){
        $str .= ":".$prefix.$index.",";
        $bindArray[$prefix.$index] = $value;
    }
    return rtrim($str,",");     
} 
```

像这样使用它：

```
$bindString = helper::bindParamArray("id", $_GET['ids'], $bindArray);
$userConditions .= " AND users.id IN($bindString)"; 
```

返回一个字符串`:id1,:id2,:id3`，并更新您`$bindArray`在运行查询时需要的绑定。简单的！

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2014-04-15T13:07:04.423

postgres 非常干净的方法是使用 postgres 数组（“{}”）：

```
$ids = array(1,4,7,9,45);
$param = "{".implode(', ',$ids)."}";
$cmd = $db->prepare("SELECT * FROM table WHERE id = ANY (?)");
$result = $cmd->execute(array($param)); 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2010-08-18T07:14:05.313

EvilRygy 的解决方案对我不起作用。在 Postgres 中，您可以执行另一种解决方法：

```
 $ids = array(1,2,3,7,8,9);
$db = new PDO(...);
$stmt = $db->prepare(
    'SELECT *
     FROM table
     WHERE id = ANY (string_to_array(:an_array, ','))'
);
$stmt->bindParam(':an_array', implode(',', $ids));
$stmt->execute(); 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2015-01-21T12:15:25.550

这是我的解决方案：

```
$total_items = count($array_of_items);
$question_marks = array_fill(0, $total_items, '?');
$sql = 'SELECT * FROM foo WHERE bar IN (' . implode(',', $question_marks ). ')';

$stmt = $dbh->prepare($sql);
$stmt->execute(array_values($array_of_items)); 
```

注意array_values 的使用。这可以解决关键排序问题。

我正在合并 id 数组，然后删除重复的项目。我有类似的东西：

```
$ids = array(0 => 23, 1 => 47, 3 => 17); 
```

那是失败的。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2012-02-18T22:00:59.107

我扩展了 PDO 来做一些类似于 stefs 建议的事情，从长远来看，这对我来说更容易：

```
class Array_Capable_PDO extends PDO {
    /**
     * Both prepare a statement and bind array values to it
     * @param string $statement mysql query with colon-prefixed tokens
     * @param array $arrays associatve array with string tokens as keys and integer-indexed data arrays as values 
     * @param array $driver_options see php documention
     * @return PDOStatement with given array values already bound 
     */
    public function prepare_with_arrays($statement, array $arrays, $driver_options = array()) {

        $replace_strings = array();
        $x = 0;
        foreach($arrays as $token => $data) {
            // just for testing...
            //// tokens should be legit
            //assert('is_string($token)');
            //assert('$token !== ""');
            //// a given token shouldn't appear more than once in the query
            //assert('substr_count($statement, $token) === 1');
            //// there should be an array of values for each token
            //assert('is_array($data)');
            //// empty data arrays aren't okay, they're a SQL syntax error
            //assert('count($data) > 0');

            // replace array tokens with a list of value tokens
            $replace_string_pieces = array();
            foreach($data as $y => $value) {
                //// the data arrays have to be integer-indexed
                //assert('is_int($y)');
                $replace_string_pieces[] = ":{$x}_{$y}";
            }
            $replace_strings[] = '('.implode(', ', $replace_string_pieces).')';
            $x++;
        }
        $statement = str_replace(array_keys($arrays), $replace_strings, $statement);
        $prepared_statement = $this->prepare($statement, $driver_options);

        // bind values to the value tokens
        $x = 0;
        foreach($arrays as $token => $data) {
            foreach($data as $y => $value) {
                $prepared_statement->bindValue(":{$x}_{$y}", $value);
            }
            $x++;
        }

        return $prepared_statement;
    }
} 
```

你可以像这样使用它：

```
$db_link = new Array_Capable_PDO($dsn, $username, $password);

$query = '
    SELECT     *
    FROM       test
    WHERE      field1 IN :array1
     OR        field2 IN :array2
     OR        field3 = :value
';

$pdo_query = $db_link->prepare_with_arrays(
    $query,
    array(
        ':array1' => array(1,2,3),
        ':array2' => array(7,8,9)
    )
);

$pdo_query->bindValue(':value', '10');

$pdo_query->execute(); 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2017-09-13T15:31:35.767

对我来说，更性感的解决方案是构建一个动态关联数组并使用它

```
// A dirty array sent by user
$dirtyArray = ['Cecile', 'Gilles', 'Andre', 'Claude'];

// we construct an associative array like this
// [ ':name_0' => 'Cecile', ... , ':name_3' => 'Claude' ]
$params = array_combine(
    array_map(
        // construct param name according to array index
        function ($v) {return ":name_{$v}";},
        // get values of users
        array_keys($dirtyArray)
    ),
    $dirtyArray
);

// construct the query like `.. WHERE name IN ( :name_1, .. , :name_3 )`
$query = "SELECT * FROM user WHERE name IN( " . implode(",", array_keys($params)) . " )";
// here we go
$stmt  = $db->prepare($query);
$stmt->execute($params); 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2015-03-18T19:16:52.560

当你有其他参数时，你可以这样做：

```
$ids = array(1,2,3,7,8,9);
$db = new PDO(...);
$query = 'SELECT *
            FROM table
           WHERE X = :x
             AND id IN(';
$comma = '';
for($i=0; $i<count($ids); $i++){
  $query .= $comma.':p'.$i;       // :p0, :p1, ...
  $comma = ',';
}
$query .= ')';

$stmt = $db->prepare($query);
$stmt->bindValue(':x', 123);  // some value
for($i=0; $i<count($ids); $i++){
  $stmt->bindValue(':p'.$i, $ids[$i]);
}
$stmt->execute(); 
```

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2009-05-28T11:48:06.943

查看 [PDO :Predefined Constants](http://uk.php.net/manual/en/pdo.constants.php)没有您需要的 PDO::PARAM_ARRAY ，如[PDOStatement->bindParam中所列](http://uk.php.net/manual/en/pdostatement.bindparam.php)

> bool PDOStatement::bindParam ( 混合 $parameter , 混合 &$variable [, **int $data_type** [, int $length [, mixed $driver_options ]]] )

所以我认为这是不可能实现的。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2012-07-12T14:44:44.970

我也意识到这个线程很旧，但我有一个独特的问题，在将即将被弃用的 mysql 驱动程序转换为 PDO 驱动程序时，我必须创建一个可以动态构建普通参数和 IN 的函数。参数数组。所以我很快建立了这个：

```
/**
 * mysql::pdo_query('SELECT * FROM TBL_WHOOP WHERE type_of_whoop IN :param AND siz_of_whoop = :size', array(':param' => array(1,2,3), ':size' => 3))
 *
 * @param $query
 * @param $params
 */
function pdo_query($query, $params = array()){

    if(!$query)
        trigger_error('Could not query nothing');

    // Lets get our IN fields first
    $in_fields = array();
    foreach($params as $field => $value){
        if(is_array($value)){
            for($i=0,$size=sizeof($value);$i<$size;$i++)
                $in_array[] = $field.$i;

            $query = str_replace($field, "(".implode(',', $in_array).")", $query); // Lets replace the position in the query string with the full version
            $in_fields[$field] = $value; // Lets add this field to an array for use later
            unset($params[$field]); // Lets unset so we don't bind the param later down the line
        }
    }

    $query_obj = $this->pdo_link->prepare($query);
    $query_obj->setFetchMode(PDO::FETCH_ASSOC);

    // Now lets bind normal params.
    foreach($params as $field => $value) $query_obj->bindValue($field, $value);

    // Now lets bind the IN params
    foreach($in_fields as $field => $value){
        for($i=0,$size=sizeof($value);$i<$size;$i++)
            $query_obj->bindValue($field.$i, $value[$i]); // Both the named param index and this index are based off the array index which has not changed...hopefully
    }

    $query_obj->execute();

    if($query_obj->rowCount() <= 0)
        return null;

    return $query_obj;
} 
```

它仍然未经测试，但逻辑似乎在那里。

希望对处于相同位置的人有所帮助，

编辑：经过一些测试，我发现：

*   PDO 不喜欢 '.' 以他们的名义（如果你问我，这有点愚蠢）
*   bindParam 是错误的函数，bindValue 是正确的函数。

代码编辑为工作版本。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2010-02-18T15:18:29.380

关于 Schnalle 代码的一点编辑

```
<?php
$ids     = array(1, 2, 3, 7, 8, 9);
$inQuery = implode(',', array_fill(0, count($ids)-1, '?'));

$db   = new PDO(...);
$stmt = $db->prepare(
    'SELECT *
     FROM table
     WHERE id IN(' . $inQuery . ')'
);

foreach ($ids as $k => $id)
    $stmt->bindValue(($k+1), $id);

$stmt->execute();
?>

//implode(',', array_fill(0, count($ids)-1), '?')); 
//'?' this should be inside the array_fill
//$stmt->bindValue(($k+1), $in); 
// instead of $in, it should be $id 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2009-05-28T12:08:51.127

你用的是什么数据库？在 PostgreSQL 中，我喜欢使用 ANY(array)。所以要重用你的例子：

```
<?php
$ids=array(1,2,3,7,8,9);
$db = new PDO(...);
$stmt = $db->prepare(
    'SELECT *
     FROM table
     WHERE id = ANY (:an_array)'
);
$stmt->bindParam('an_array',$ids);
$stmt->execute();
?> 
```

不幸的是，这是非常不便携的。

在其他数据库上，您需要像其他人提到的那样创造自己的魔法。当然，您需要将该逻辑放入类/函数中，以使其在整个程序中可重用。查看 PHP.NET 页面上的评论，`mysql_query`了解有关此场景的主题和示例的更多想法。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2017-03-14T00:22:55.717

如果该列只能包含整数，您可以不使用占位符来执行此操作，只需将 id 直接放入查询中。您只需要将数组的所有值转换为整数。像这样：

```
$listOfIds = implode(',',array_map('intval', $ids));
$stmt = $db->prepare(
    "SELECT *
     FROM table
     WHERE id IN($listOfIds)"
);
$stmt->execute(); 
```

这不应该容易受到任何 SQL 注入的影响。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2014-06-20T08:41:42.427

据我所知，不可能将数组绑定到 PDO 语句中。

但是存在两种常见的解决方案：

1.  使用位置占位符 (?,?,?,?) 或命名占位符 (:id1, :id2, :id3)

    $whereIn = implode(',', array_fill(0, count($ids), '?'));

2.  早先引用数组

    $whereIn = array_map(array($db, 'quote'), $ids);

这两种选择都是好的和安全的。我更喜欢第二个，因为它更短，如果需要，我可以 var_dump 参数。使用占位符，您必须绑定值，最终您的 SQL 代码将是相同的。

```
$sql = "SELECT * FROM table WHERE id IN ($whereIn)"; 
```

最后对我来说重要的是避免错误“绑定变量的数量与标记的数量不匹配”

Doctrine 它是使用位置占位符的一个很好的例子，只是因为它对传入参数有内部控制。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2013-04-04T20:32:00.573

在经历了同样的问题之后，我找到了一个更简单的解决方案（虽然仍然没有那么优雅`PDO::PARAM_ARRAY`）：

给定数组`$ids = array(2, 4, 32)`：

```
$newparams = array();
foreach ($ids as $n => $val){ $newparams[] = ":id_$n"; }

try {
    $stmt = $conn->prepare("DELETE FROM $table WHERE ($table.id IN (" . implode(", ",$newparams). "))");
    foreach ($ids as $n => $val){
        $stmt->bindParam(":id_$n", intval($val), PDO::PARAM_INT);
    }
    $stmt->execute(); 
```

... 等等

因此，如果您使用的是混合值数组，您将需要更多代码来测试您的值，然后再分配类型参数：

```
// inside second foreach..

$valuevar = (is_float($val) ? floatval($val) : is_int($val) ? intval($val) :  is_string($val) ? strval($val) : $val );
$stmt->bindParam(":id_$n", $valuevar, (is_int($val) ? PDO::PARAM_INT :  is_string($val) ? PDO::PARAM_STR : NULL )); 
```

但我没有测试过这个。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2018-03-22T13:29:00.350

不可能在 PDO 中使用这样的数组。

您需要为每个值构建一个带有参数（或使用？）的字符串，例如：

`:an_array_0, :an_array_1, :an_array_2, :an_array_3, :an_array_4, :an_array_5`

这是一个例子：

```
<?php
$ids = array(1,2,3,7,8,9);
$sqlAnArray = join(
    ', ',
    array_map(
        function($index) {
            return ":an_array_$index";
        },
        array_keys($ids)
    )
);
$db = new PDO(
    'mysql:dbname=mydb;host=localhost',
    'user',
    'passwd'
);
$stmt = $db->prepare(
    'SELECT *
     FROM table
     WHERE id IN('.$sqlAnArray.')'
);
foreach ($ids as $index => $id) {
    $stmt->bindValue("an_array_$index", $id);
} 
```

如果你想继续使用`bindParam`，你可以这样做：

```
foreach ($ids as $index => $id) {
    $stmt->bindParam("an_array_$index", $ids[$id]);
} 
```

如果你想使用`?`占位符，你可以这样做：

```
<?php
$ids = array(1,2,3,7,8,9);
$sqlAnArray = '?' . str_repeat(', ?', count($ids)-1);
$db = new PDO(
    'mysql:dbname=dbname;host=localhost',
    'user',
    'passwd'
);
$stmt = $db->prepare(
    'SELECT *
     FROM phone_number_lookup
     WHERE country_code IN('.$sqlAnArray.')'
);
$stmt->execute($ids); 
```

如果您不知道是否`$ids`为空，则应对其进行测试并相应地处理该情况（返回空数组，或返回 Null 对象，或抛出异常，...）。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2013-05-30T13:18:13.100

这是我的解决方案。我还扩展了 PDO 类：

```
class Db extends PDO
{

    /**
     * SELECT ... WHERE fieldName IN (:paramName) workaround
     *
     * @param array  $array
     * @param string $prefix
     *
     * @return string
     */
    public function CreateArrayBindParamNames(array $array, $prefix = 'id_')
    {
        $newparams = [];
        foreach ($array as $n => $val)
        {
            $newparams[] = ":".$prefix.$n;
        }
        return implode(", ", $newparams);
    }

    /**
     * Bind every array element to the proper named parameter
     *
     * @param PDOStatement $stmt
     * @param array        $array
     * @param string       $prefix
     */
    public function BindArrayParam(PDOStatement &$stmt, array $array, $prefix = 'id_')
    {
        foreach($array as $n => $val)
        {
            $val = intval($val);
            $stmt -> bindParam(":".$prefix.$n, $val, PDO::PARAM_INT);
        }
    }
} 
```

以下是上述代码的示例用法：

```
$idList = [1, 2, 3, 4];
$stmt = $this -> db -> prepare("
  SELECT
    `Name`
  FROM
    `User`
  WHERE
    (`ID` IN (".$this -> db -> CreateArrayBindParamNames($idList)."))");
$this -> db -> BindArrayParam($stmt, $idList);
$stmt -> execute();
foreach($stmt as $row)
{
    echo $row['Name'];
} 
```

让我知道你的想法

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2021-04-08T22:16:25.977

使用 MySQL 和 PDO，我们可以使用 JSON 数组和`JSON_CONTAINS()`( [https://dev.mysql.com/doc/refman/8.0/en/json-search-functions.html#function_json-contains](https://dev.mysql.com/doc/refman/8.0/en/json-search-functions.html#function_json-contains) ) 进行搜索。

```
$ids = [123, 234, 345, 456]; // Array of users I search
$ids = json_encode($ids); // JSON conversion

$sql = <<<SQL
    SELECT ALL user_id, user_login
    FROM users
    -- Cast is mandatory beaucause JSON_CONTAINS() waits JSON doc candidate
    WHERE JSON_CONTAINS(:ids, CAST(user_id AS JSON))
    SQL;

$search = $pdo->prepare($sql);
$search->execute([':ids' => $ids]);
$users = $search->fetchAll(); 
```

也可以使用`JSON_TABLE()`( [https://dev.mysql.com/doc/refman/8.0/en/json-table-functions.html#function_json-table](https://dev.mysql.com/doc/refman/8.0/en/json-table-functions.html#function_json-table) ) 进行更复杂的案例和 JSON 数据探索：

```
$users = [
    ['id' => 123, 'bday' => ..., 'address' => ...],
    ['id' => 234, 'bday' => ..., 'address' => ...],
    ['id' => 345, 'bday' => ..., 'address' => ...],
]; // I'd like to know their login

$users = json_encode($users);

$sql = <<<SQL
    SELECT ALL user_id, user_login
    FROM users
    WHERE user_id IN (
        SELECT ALL user_id
        FROM JSON_TABLE(:users, '$[*]' COLUMNS (
            -- Data exploration...
            -- (if needed I can explore really deeply with NESTED kword)
            user_id INT PATH '$.id',
            -- I could skip these :
            user_bday DATE PATH '$.bday',
            user_address TINYTEXT PATH '$.address'
        )) AS _
    )
    SQL;

$search = $pdo->prepare($sql);
$search->execute([':users' => $users]);
... 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-06-26T11:12:17.270

我更进一步，让答案更接近使用占位符绑定参数的原始问题。

这个答案必须通过要在查询中使用的数组进行两次循环。但它确实解决了使用其他列占位符进行更有选择性的查询的问题。

```
//builds placeholders to insert in IN()
foreach($array as $key=>$value) {
    $in_query = $in_query . ' :val_' . $key . ', ';
}

//gets rid of trailing comma and space
$in_query = substr($in_query, 0, -2);

$stmt = $db->prepare(
    "SELECT *
     WHERE id IN($in_query)";

//pind params for your placeholders.
foreach ($array as $key=>$value) {
    $stmt->bindParam(":val_" . $key, $array[$key])
}

$stmt->execute(); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-08-24T07:13:08.557

你先设置多少“？” 在查询中，然后通过“for”发送参数，如下所示：

```
require 'dbConnect.php';
$db=new dbConnect();
$array=[];
array_push($array,'value1');
array_push($array,'value2');
$query="SELECT * FROM sites WHERE kind IN (";

foreach ($array as $field){
    $query.="?,";
}
$query=substr($query,0,strlen($query)-1);
$query.=")";
$tbl=$db->connection->prepare($query);
for($i=1;$i<=count($array);$i++)
    $tbl->bindParam($i,$array[$i-1],PDO::PARAM_STR);
$tbl->execute();
$row=$tbl->fetchAll(PDO::FETCH_OBJ);
var_dump($row); 
```

# mercurial - 如何在 Mercurial 中克隆存储库的子文件夹？

> ID：920355
> 
> 赞同：62
> 
> 时间：2009-05-28T11:18:47.360
> 
> 标签：mercurial, clone, dvcs

我有一个 Mercurial 存储库，其中包含一些相关项目。我只想将这些项目中的一个分支到其他地方。

克隆是否可能只是存储库的一部分，这是实现这一目标的正确方法吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-28T15:33:19.983

你想要的是一个[**窄**的或**部分**的克隆](https://www.mercurial-scm.org/wiki/PartialClone)，但不幸的是这还不被支持。

如果您已经有一个大存储库并且您意识到将其拆分为几个较小的存储库是有意义的，那么您可以使用[convert 扩展](https://www.mercurial-scm.org/wiki/ConvertExtension#Converting_from_Mercurial)来执行**Mercurial 到 Mercurial 的转换**。请注意，这会创建一个**新**的存储库`foo`，您不能在`your-big-repo`和之间推/拉`foo`。

默认情况下`convert extension`未启用，因此将以下内容添加到您的 repo`hgrc`文件或您的`mercurial.ini`文件中：

```
[extensions]
hgext.convert= 
```

然后创建一个`map.txt`文件

```
include "libs/foo"
rename "libs/foo" . 
```

（请注意，即使在 Windows 上也可以使用正斜杠）并运行

```
$ hg convert --filemap map.txt your-big-repo foo 
```

这将创建`foo`一个存储库，其中包含`libs/foo`来自`your-big-repo`.

如果你想删除所有的证据，`foo`你`your-big-repo`可以在你`exclude libs/foo`用来摆脱目录的地方进行另一次转换。

当您有多个这样的存储库并且您想将它们作为一个整体使用时，您应该查看[subrepositories](https://www.mercurial-scm.org/wiki/Subrepository)。此功能允许您在结帐中包含其他存储库 - 类似于`svn:externals`工作方式。请遵循该wiki 页面上的[建议。](https://www.mercurial-scm.org/wiki/Subrepository#Recommendations)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-06T03:51:33.383

您可以使用[Convert Extension](https://www.mercurial-scm.org/wiki/ConvertExtension)将您的存储库按子存储库拆分为多个存储库，而不是进行部分克隆。

具体来说，请参阅[从 Mercurial 转换](https://www.mercurial-scm.org/wiki/ConvertExtension#Converting_from_Mercurial)部分：

> 过滤 Mercurial 存储库以获取现有存储库的子集也很有用。例如，要将存储库 foo 的子目录 subfoo 转换为具有自己生命的存储库（同时保留其完整历史记录），请执行以下操作：
> 
> ```
> $ echo include subfoo > /tmp/myfilemap
> $ echo rename subfoo . >> /tmp/myfilemap
> $ hg convert --filemap /tmp/myfilemap /path/to/repo/foo /tmp/mysubfoo-repo 
> ```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-01-31T03:13:16.590

我偶然发现了这个问题并找到了一种方法：使用符号链接（不幸的是Linux）

例如，如果您只需要`/project`在存储库中，则在您的计算机上将存储库克隆到另一个文件夹中，然后使用`ln -s /repo/location/ project`. Mercurial会处理它

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-11-01T07:21:45.873

（2016 年末）Mainline Mercurial 仍然不打包对“窄克隆”的支持，但是有第三方扩展可以以不同的方式解决这个问题。

如果您只能处理狭窄的*结帐（也称为“稀疏结帐”或“按文件路径的部分结帐”），那么来自*[hg-experimental 存储库](https://bitbucket.org/facebook/hg-experimental)的Facebook`sparse.py`扩展（查看目录内部）可能是可行的。在这种情况下，您仍然克隆完整的历史记录（因此 .hg 目录不会更小），但您的工作目录仅显示/作用于完整存储库的子集。`hgext3rd/`

或者，谷歌创建了一个[NarrowHG 扩展](https://bitbucket.org/Google/narrowhg)来进行窄*克隆*（又名“通过文件路径进行部分克隆”）。您将需要控制服务器、客户端并愿意使用实验性功能，但它确实将克隆在 .hg 中的复制历史限制为原始存储库中的一个子集。

(2019) 该[`sparse`扩展被合并到 Mercurial 4.3](https://www.mercurial-scm.org/wiki/WhatsNew/Archive#Mercurial_4.3_.2F_4.3.1_.282017-08-10.29)作为实验[`sparse`扩展](https://www.mercurial-scm.org/doc/hg.1.html#sparse)。NarrowHG 扩展作为[扩展被合并到 Mercurial 4.6](https://www.mercurial-scm.org/wiki/WhatsNew/Archive#Mercurial_4.6_.282018-05-06.29)中`hgext.narrow`。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-28T11:58:36.703

这是不可能的，`hg clone`将克隆整个存储库。

您可以查看子存储库扩展，它允许您在存储库中拥有存储库，这可能符合您的需求。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-30T02:48:04.093

[这对于Convert 扩展](https://www.mercurial-scm.org/wiki/ConvertExtension#Converting_from_Mercurial)来说是直截了当的。

# jquery - 如何使用 JQuery 遍历从 Web 服务返回的字符串列表

> ID：920362
> 
> 赞同：4
> 
> 时间：2009-05-28T11:20:46.950
> 
> 标签：jquery, web-services

这是我的第一次 JQuery 体验，而且我的截止日期非常紧迫。这是一个有点尴尬的问题，但这里有。我正在调用一个返回字符串列表的 Web 服务（它工作并返回 OK）。代码如下

```
$(document).ready(
    function() 
    {
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            url: "CatList.asmx/GetCatergoies",
            data: "{}",
            dataType: "json",
            success: onActionCompleted
        });
    }
)

function onActionCompleted(data) {

    var resultData = data['d'];
    alert(resultData);
 } 
```

警报会生成来自 Web 服务的结果的逗号分隔字符串。我一生都无法弄清楚如何迭代结果。当我做这样的事情时：

```
resultData.each(
   alert(this)
) 
```

我在 Firebug 中得到的只是这个错误：

```
resultData.each is not a function 
```

任何指针？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T11:24:07.473

使用**[Array.split()](http://www.w3schools.com/jsref/jsref_split.asp)**将产生一个数组：

```
var string = "red,blue,green,orange"

$.each(string.split(','), function(){
  alert(this)
}) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T11:23:30.737

考虑[`string.split()`](http://www.quirksmode.org/js/strings.html#split)代替 jQuery：

```
var items = results.split(',');

for( var i = 0; i < items.length; i++ ) {
  alert( items[i] );
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T11:25:53.617

听起来您的网络服务给了您一个 csv 字符串。将其拆分为一个数组，将 jQuery 包裹在它周围，并为每个元素添加一个回调函数，如下所示：

```
$(resultData.split(",")).each(function () {
    alert(this);
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T11:36:27.167

谢谢！如果没有反馈，我将无法解决它。我仍然不完全确定 resultData 是什么格式。我在代码上做了一些复制和粘贴，所以不确定什么 data['d'] 将列表转换为 json 术语。

当我尝试对 resultdata 进行拆分时，我在 Firebug 中遇到了这个错误：

resultData.split 不是函数

最后，我只是在没有拆分的情况下在 resultdata 上使用了 $.each() 并且它起作用了。

```
function onActionCompleted(data) {

    var resultData = data['d'];
    $.each(resultData, function() {
        alert(this)
    })
} 
```

# hibernate - HQL 查询等价性：为什么它们不同

> ID：920365
> 
> 赞同：0
> 
> 时间：2009-05-28T11:22:12.347
> 
> 标签：hibernate, hql

我有一个要优化的工作 HQL 查询。如下：

```
select distinct A.id from Import as A, Place D 
where (A.place=D or A.placeBOK=D) and D.country=? 

I tried to replcae the query from above by the following:

select distinct A.id from Import as A
where A.place.country=? or A.placeBOK.country=? 
```

除了性能之外，我认为这两个查询是等效的。但他们不是。第一个是交付一组 20 个对象，而第二个是仅交付 14 个对象。

我究竟做错了什么？

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T14:19:38.400

**[更新]**

您必须将查询重写为

```
select distinct A.id from Import as A LEFT JOIN A.place b LEFT JOIN A.placeBOK c
where b.country=? or c.country=? 
```

您的第二个查询相当于：

```
select distinct A.id from Import as A INNER JOIN A.place b INNER JOIN A.placeBOK c
where b.country=? or c.country=? 
```

也可以看看：

[14.4\. 连接语法的形式](http://docs.jboss.org/hibernate/stable/core/reference/en/html_single/#queryhql-joins-forms)

HQL 支持两种形式的关联连接：隐式和显式。

上一节中显示的查询都使用显式形式，其中 join 关键字在 from 子句中显式使用。这是推荐的形式。

隐式形式不使用 join 关键字。相反，使用点符号“取消引用”关联。隐式连接可以出现在任何 HQL 子句中。隐式连接导致生成的 SQL 语句中的内部连接。

```
from Cat as cat where cat.mate.name like '%s%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:14:52.297

我不明白上面的答案，但也许你可以尝试调查查询 A 而不是查询 B 产生的 6 个结果......

# iphone - UIPickerView 直到发生触摸才出现

> ID：920378
> 
> 赞同：1
> 
> 时间：2009-05-28T11:24:29.423
> 
> 标签：iphone, cocoa-touch, uiview, touch, uipickerview

我以编程方式将两个自定义 UIPickerViews 添加到另一个视图（MainView）。它们工作得很好，但在 MainView 的任何部分发生触摸事件之前它们是不可见的。我已经检查了 UIPickerView 和 UIView 的类引用，但没有找到任何可以“刷新”视图的东西，除非我遗漏了一些明显的东西？

这是我在 MainView.m 中的 drawRect 方法。我尝试在 viewDidLoad 中做同样的事情，但没有成功。自定义旋转/变换等是否与它有关？

```
- (void)drawRect:(CGRect)rect { 
    CGRect pickerFrame = CGRectMake(50, -32, 30, 180);
    m_picker1 = [[UIPickerView alloc] initWithFrame:pickerFrame];
    m_picker1.delegate = self;  
    m_picker1.tag = k_ptag1;
    m_picker1.showsSelectionIndicator =YES;  
    m_picker1.backgroundColor = [UIColor clearColor]; 
    CGAffineTransform rotate = CGAffineTransformMakeRotation(3.14/2);  
    rotate = CGAffineTransformScale(rotate, 0.075, 0.85);  
    [m_picker1 setTransform:rotate];  
    [self addSubview:m_picker1]; 

    pickerFrame = CGRectMake(50, 67, 30, 180);
    m_picker2 = [[UIPickerView alloc] initWithFrame:pickerFrame];
    m_picker2.delegate = self;  
    m_picker2.tag = k_ptag2;
    m_picker2.showsSelectionIndicator =YES;  
    m_picker2.backgroundColor = [UIColor clearColor]; 
    rotate = CGAffineTransformMakeRotation(3.14/2);  
    rotate = CGAffineTransformScale(rotate, 0.075, 0.85);  
    [m_picker2 setTransform:rotate];  
    [self addSubview:m_picker2];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T13:02:00.320

您在视图的控制器中添加子视图，而不是视图本身。我建议您熟悉 MVC 设计模式。

drawRect 应该只用于视图本身的实际绘制，而不是子视图。

# iphone - UINavigationController拦截——popViewControllerAnimated：

> ID：920379
> 
> 赞同：4
> 
> 时间：2009-05-28T11:24:59.953
> 
> 标签：iphone, objective-c, uikit

所以问题是当有人触摸 UINavigationControler 上的后退按钮时，我想运行一些代码来更新数据源。

问题是我似乎找不到合适的代表来做这件事。只有这些在导航控制器委托上可用，我想要“didfinishshowing”类型的方法。

```
– navigationController:willShowViewController:animated:  optional method  
– navigationController:didShowViewController:animated:  optional method 
```

我认为下一个最好的地方是导航栏，但是当我尝试时。

> 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“无法在控制器管理的 UINavigationBar 上手动设置委托

回想起来，这是有道理的，因为您不希望一些黑客弄乱导航控制器的内部并阻止它工作。

这一定是一个常见问题，我错过了一些简单的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T18:24:04.227

我们很清楚：视图 A 是起点。用户点击某物，您向右滑动以查看 B。用户点击后退按钮，您将从 B 返回到 A，并且由于“后退”操作而想要做某事。

有三种方法可以做到这一点（你也不必靠近导航控制器——这些适用于底层视图控制器本身）：

*   正如 dmercredi 建议`viewWillAppear`在视图控制器 A 上覆盖，因此当您返回它时，它会自行刷新。问题是`viewWillAppear`在第一次调用 A 时也会调用它。因此，从 B 返回时，您必须设置某种标志来区分第一个`viewWillAppear`和任何后续标志。

*   覆盖`viewWillDisappear`视图控制器 B 并在那里进行刷新。这只会在 B 即将离开时被调用。如果 B 上的某些内容更深一层或在顶部显示模式对话框，`viewWillDisappear`则会再次被调用，因此您必须区分来与去。

*   解耦各种视图并使用委托模式。视图控制器 A 将自己设置为 B 的委托，当 B 更新某些内容时，它会调用委托方法，因此 A 会收到更改通知并可以更新它需要的任何内容。每当用户在 B 内部进行更改或覆盖时，您都可以调用委托方法，`viewWillDisappear`并且只需在退出时执行一次。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T13:15:52.303

将刷新代码添加到即将显示的视图控制器上的 viewWillAppear:(BOOL)animated 方法。在您的情况下，这就是导航堆栈上已经存在的视图控制器。

# c# - 如何将值传递给 c# 中的图像按钮单击事件？

> ID：920381
> 
> 赞同：8
> 
> 时间：2009-05-28T11:26:38.857
> 
> 标签：c#, asp.net

尝试将一些值传递给 imagebutton 点击​​事件，如下所示：

```
<asp:ImageButton id="imagebutton1" runat="server" AlternateText="5 Star Luxury Villas in North Cyprus" ImageUrl="/download/1/luxury_villas.jpg" OnClick="ImageButton_Click('value1', 'value2')"/> 
```

然后在后面的代码中：

```
 protected void ImageButton_Click(object sender, ImageClickEventArgs e, string value1, string value2)
    {
       Response.Write(Value2);
    } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-28T11:29:11.113

尝试使用`OnCommand`而不是`OnClick`

然后您可以在`CommandName`&`CommandArgument`属性中指定值

```
<asp:ImageButton ID="blah" runat="server" OnCommand="blah_command" CommandName="val1" CommandArgument="val2,val3,val4" /> 
```

和

```
protected void blah_Command(object sender, CommandEventArgs e)
{
    string val1 = e.CommandName.ToString();

    string [] othervals = e.CommandArgument.ToString().Split(',');

} 
```

# c# - 显示/隐藏 div

> ID：920384
> 
> 赞同：0
> 
> 时间：2009-05-28T11:27:09.497
> 
> 标签：c#, asp.net, html

我在 vs 2005 上使用 asp.net ajax 控件工具包 1.0。我正在使用 collapseablePanel 和 AlwaysVisibleControlExtender 控件。当我使用这些时，我注意到它在隐藏之前我的面板闪烁了几秒钟。

为了避免这种情况，我决定将它放在一个 div 中以使其隐藏。我希望在使用控件时显示它。

这是我所拥有的：

```
<div id="menuContent" style="display:none">

 <asp:Panel ID="pnlAddNewContent" runat="server" Width="300px">
   ....//the panel stuff here
 </asp>
</div> 
```

标题中的javascript是：

```
 function showdiv() { 
    if (document.getElementbyId) {
        document.getElementbyId('menuContent').style.visibility = 'visible'; 
    } 

    } 
```

（它适用于 IE 6，因为我不关心兼容性）

和正文 onload=onLoad="showdiv();"

它在加载时正确隐藏，但我无法让它再次显示。有没有人有解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T11:30:03.327

您试图通过设置可见性来显示它，但您使用显示隐藏了它。

你实际上想要这样的东西：

document.getElementbyId('menuContent').style.display = 'block';

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T11:47:56.473

也许这就是你要找的

Javascript函数：

```
function showHide(descriptor) 
{    
    var layer = document.getElementById(descriptor);
    if (layer != null) {
        if (layer.style.display != 'none') {
            layer.style.display = 'none'; //hide layer              
        } else {
            layer.style.display = 'block';//show layer
        }       
    }
} 
```

HTML：

```
<a href="javascript:showHide('divInfo');"><img id="imgInfo" src="info.gif" border="0" /></a>
<div style="display: none;" id="divInfo">some info</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:18:51.083

基本上必须使用 Visibility 隐藏和可见属性，因为这些在 collapsePanel 上效果最好

# programming-languages - 如果每件可计算的事情都可以在 1 秒内完成，那么编程语言会是什么样子？

> ID：920385
> 
> 赞同：2
> 
> 时间：2009-05-28T11:27:51.927
> 
> 标签：programming-languages, computer-science, halting-problem

> 受[这个问题的启发](https://stackoverflow.com/questions/910935/how-will-quantum-computing-affect-us)

假设我们有一个神奇的图灵机，它拥有无限的内存和无限的 CPU 能力。

发挥你的想象力，看看这怎么可能，例如它使用某种超空间连续体来自动并行化任何需要的东西，这样它就可以计算出任何可计算问题的答案，无论它的时间复杂度和数量是多少在一秒钟内完成实际的“逻辑步骤”。

但是，它只能在一秒钟内回答可计算的问题……所以我不是在假设一台“不可能”的机器（至少我不这么认为）……例如，这台机器仍然无法解决停机问题。

这种机器的编程语言会是什么样子？我目前所知道的所有编程语言都必须对“算法复杂性”做出一些让步……尽管消除了这种限制，但我希望我们所关心的只是编程语言的“表达能力”。即它能够简洁地表达“可计算的问题”......

无论如何，为了希望有趣的讨论，将其作为社区 wiki 开放......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T11:38:58.567

```
SendMessage travelingSalesman "Just buy a ticket to the same city twice already. You'll spend much more money trying to solve this than you'll save by visiting Austin twice."
SendMessage travelingSalesman "Wait, they built what kind of computer? Nevermind." 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T11:39:34.073

这真的不合逻辑。如果一件事需要 O(1) 时间，那么做 n 次将需要 O(n) 时间，即使在量子计算机上也是如此。“一切”不可能花费 O(1) 时间。

例如：[Grover 算法](http://en.wikipedia.org/wiki/Grover%27s_algorithm)，即您所链接问题的已接受答案中提到的算法，需要 O(n^1/2) 时间才能在包含 n 个项目的数据库中找到一个元素。那不是 O(1)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T11:51:04.907

内存量或内存速度或处理器速度并不能定义算法的时间和空间复杂度。基础数学就是这样做的。问如果一切都可以在 O(1) 中计算，编程语言会是什么样子，就像问如果 pi 是 3 并且所有平方根的结果都是整数，我们的计算器会是什么样子。这真的是不可能的，如果不是，它不太可能很有用。

现在，问问我们自己，我们将用无限的处理能力和无限的记忆来做什么可能是一个有用的练习。我们仍然必须处理算法的复杂性，但我们可能会以某种不同的方式工作。为此，我推荐[《百年语言》](http://www.paulgraham.com/hundred.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T21:29:22.680

请注意，即使停止问题是不可计算的，“在所有可能小于 M 的输入上，是否会在 N 步内停止”！

因此，任何编程语言都将成为纯粹的规范。您需要做的就是准确地指定函数的前置条件和后置条件，编译器可以实现最快的代码来实现您的规范。

此外，这将很快触发奇点。如果你可以进行近乎无限的计算，那么构建一个人工智能会容易得多——一旦你有了一个，*任何*效率的，它都会问一个可计算的问题：“如果我花了十亿年的时间思考它，我将如何改进我的程序？ “……

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T11:36:40.040

它可能是一种类似haskell的语言。老实说，编写代码是一个梦想。您编写类型、类和函数的“法则”，然后放开它们。它非常有趣，功能强​​大，您可以编写一些非常简洁和优雅的代码。这就像一门艺术。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T11:33:45.613

也许它看起来更像是伪代码而不是“真实”代码。毕竟，您不必再担心任何实现细节，因为无论您采用哪种方式，它都足够快。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T11:36:56.997

您低估了 O(1)。这意味着存在一个常数 C>0，因此计算问题的时间仅限于该 C。

您忽略的是 C 的实际值可能很大，并且对于不同的算法它可能（并且大部分情况下）不同。您可能有两种算法（或计算机 - 没关系），两者都使用 O(1)，但在一个中，这个 C 可能是另一个中的十亿倍 - 然后后者会慢得多，并且在时间方面可能非常慢。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T11:39:23.450

可扩展性将不再是问题。我们会拥有比我们更聪明的人工智能。我们不再需要编程，而是人工智能会在我们自己意识到之前弄清楚我们的意图。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-28T11:49:16.143

SQL 就是这样一种语言——你要求一些数据，然后你就得到了。如果您不必担心 db 的微小实现细节，这甚至可能会很有趣。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-24T22:18:01.247

如果这一切都在一秒钟内完成，那么大多数语言最终都会是这样的，我称之为 DWIM 理论（Do what I mean theory）：

```
Just do what I said (without any bugs this time) 
```

因为如果我们曾经开发出一台可以在一秒钟内计算出所有事情的机器，那么我们可能会在那个阶段拥有精神控制，至少是人工智能。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-12-16T06:57:34.933

我不知道会出现什么新语言（我是物理学家，而不是计算机科学家），但我仍然会用 Python 为它编写程序。

# java - 如何允许一次只运行一个 Java 程序的实例？

> ID：920386
> 
> 赞同：29
> 
> 时间：2009-05-28T11:28:24.377
> 
> 标签：java, java-web-start, jnlp

我需要防止用户多次启动我的 Java 应用程序（WebStart Swing 应用程序）。因此，如果应用程序已经在运行，则不应再次启动它或显示警告/再次关闭。

有没有一些方便的方法来实现这一点？我想过阻塞一个端口或将某事写入文件。但是希望您可以访问一些系统属性或 JVM？

顺便提一句。目标平台是带有 Java 1.5 的 Windows XP

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-28T11:32:15.243

我认为您在启动应用程序时打开端口进行侦听的建议是最好的主意。

这很容易做到，您无需担心在关闭应用程序时清理它。例如，如果您写入文件但有人随后使用任务管理器终止进程，则该文件不会被删除。

另外，如果我没记错的话，没有简单的方法可以从 JVM 内部获取 Java 进程的 PID，所以不要尝试使用 PID 制定解决方案。

这样的事情应该可以解决问题：

```
private static final int PORT = 9999;
private static ServerSocket socket;    

private static void checkIfRunning() {
  try {
    //Bind to localhost adapter with a zero connection queue 
    socket = new ServerSocket(PORT,0,InetAddress.getByAddress(new byte[] {127,0,0,1}));
  }
  catch (BindException e) {
    System.err.println("Already running.");
    System.exit(1);
  }
  catch (IOException e) {
    System.err.println("Unexpected error.");
    e.printStackTrace();
    System.exit(2);
  }
} 
```

此示例代码明确绑定到`127.0.0.1`应避免任何防火墙警告的地址，因为此地址上的任何流量都必须来自本地系统。

选择端口时，请尝试避免[著名端口列表中提到的端口](http://www.iana.org/assignments/port-numbers)。理想情况下，您应该在文件中或通过命令行开关配置使用的端口，以防发生冲突。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-28T12:33:58.863

由于问题表明正在使用 WebStart，显而易见的解决方案是使用[`javax.jnlp.SingleInstanceService`](http://java.sun.com/javase/6/docs/jre/api/javaws/jnlp/javax/jnlp/SingleInstanceService.html).

该服务在 1.5 中可用。请注意，目前 1.5 已经过了其服务生命周期的大部分时间。使用 Java SE 6！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T12:35:06.800

我认为更好的主意是使用文件锁（很老的想法:)）。从 Java 1.4 开始引入了一个新的 I/O 库，它允许文件锁定。

一旦应用程序启动，它就会尝试获取文件上的锁（或者如果不存在则创建它），当应用程序退出时，锁会被释放。如果应用程序无法获得锁，它就会退出。

如何进行文件锁定的示例在[Java Developers Almanac](http://www.exampledepot.com/egs/java.nio/SetFileLock.html)中。

如果要在 Java Web Start 应用程序或小程序中使用文件锁定，则需要对应用程序或小程序进行调用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-23T11:32:57.610

您可以使用 JUnique 库。它提供对运行单实例 java 应用程序的支持，并且是开源的。

[http://www.sauronsoftware.it/projects/junique/](http://www.sauronsoftware.it/projects/junique/)

另请参阅[如何实现单实例 Java 应用程序？](https://stackoverflow.com/questions/177189/how-to-implement-a-single-instance-java-application/40763340#40763340)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T11:08:25.710

我已经创建了跨平台 AppLock 类。

[http://mixeddev.info/articles/2015/02/01/run-single-jvm-app-instance.html](http://mixeddev.info/articles/2015/02/01/run-single-jvm-app-instance.html)

它使用文件锁定技术。

更新。在 2016 年 10 月 14 日，我创建了与 maven/gradle 兼容的包[https://github.com/jneat/jneat](https://github.com/jneat/jneat)并在此处进行了解释[http://mixeddev.info/articles/2015/06/01/synchronize-different -jvm-instances.html](http://mixeddev.info/articles/2015/06/01/synchronize-different-jvm-instances.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T12:06:46.890

我们在 C++ 中通过创建内核互斥对象并在启动时查找它来执行相同的操作。优点与使用套接字相同，即当进程死亡/崩溃/退出/被杀死时，互斥对象被内核清除。

我不是 Java 程序员，所以我不确定你是否可以在 Java 中做同样的事情？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T11:31:39.300

您可以使用注册表，尽管这会半心半意地违背使用像 java 这样的高级语言的目的。至少你的目标平台是 windows =D

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-12T14:21:47.370

试试 JUnique：

```
String appId = "com.example.win.run.main";
boolean alreadyRunning;
try {
    JUnique.acquireLock(appId);
    alreadyRunning = false;
} catch (AlreadyLockedException e) {
    alreadyRunning = true;
}
if (alreadyRunning) {
    Sysout("An Instance of this app is already running");
    System.exit(1);
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-03-06T12:56:06.773

我已经看到了很多这样的问题，我希望以一种独立于平台的方式来解决同样的问题，这种方式不会有机会与防火墙发生冲突或进入套接字的东西。

所以，这就是我所做的：

```
import java.io.File;
import java.io.IOException;

/**
 * This static class is in charge of file-locking the program
 * so no more than one instance can be run at the same time.
 * @author nirei
 */
public class SingleInstanceLock {

    private static final String LOCK_FILEPATH = System.getProperty("java.io.tmpdir") + File.separator + "lector.lock";
    private static final File lock = new File(LOCK_FILEPATH);
    private static boolean locked = false;

    private SingleInstanceLock() {}

    /**
     * Creates the lock file if it's not present and requests its deletion on
     * program termination or informs that the program is already running if
     * that's the case.
     * @return true - if the operation was succesful or if the program already has the lock.<br>
     * false - if the program is already running
     * @throws IOException if the lock file cannot be created.
     */
    public static boolean lock() throws IOException {
        if(locked) return true;

        if(lock.exists()) return false;

        lock.createNewFile();
        lock.deleteOnExit();
        locked = true;
        return true;
    }
} 
```

使用 System.getProperty("java.io.tmpdir") 作为锁文件路径可确保您始终在同一个位置创建锁。

然后，从您的程序中，您只需调用以下内容：

```
blah blah main(blah blah blah) {
    try() {
        if(!SingleInstanceLock.lock()) {
            System.out.println("The program is already running");
            System.exit(0);
        }
    } catch (IOException e) {
        System.err.println("Couldn't create lock file or w/e");
        System.exit(1);
    }
} 
```

这对我有用。现在，如果您终止程序，它不会删除锁定文件，但您可以通过将程序的 PID 写入锁定文件并使用 lock() 方法检查该进程是否已在运行来解决此问题。这留给任何有兴趣的人作为评估。:)

# vb6 - Realbasic 项目中的非 realbasic ActiveX 控件

> ID：920397
> 
> 赞同：2
> 
> 时间：2009-05-28T11:30:40.707
> 
> 标签：vb6, activex, redistributable, realbasic

Realbasic 允许您在您的Realbasic 项目中包含例如MS Flexgrid 控件并像使用本机控件一样使用它。最终用户是否需要已经安装此控件，如果不需要并且 realbasic 将其包含在构建中，是否存在许可问题？我有 vb6 并且可以通过 vb6 应用程序合法地分发此控件，这会改变事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T11:51:16.500

MS Controls 的可再分发许可证是 AFAIK，不限于一个特定的开发平台，尽管您需要查看 DEV 许可协议以了解详细信息。

由于 MSFlexgrid 是一个 ActiveX 控件，它仍然需要并且需要使用 regsvr32 进行注册。

# vb.net - 温索克程序

> ID：920398
> 
> 赞同：0
> 
> 时间：2009-05-28T11:30:44.667
> 
> 标签：vb.net, winsock

hai先生如何通过互联网使用win sock控制与远程系统通信。这是 possiple 在 vb.net 2005 中给出示例或任何想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T14:55:47.583

VB.NET 有一些比 Winsock 更好的东西——它有一组简单而有用的网络功能。

如果您真的需要“套接字”，请尝试[MSDN System.Net.Sockets](http://msdn.microsoft.com/en-us/library/system.net.sockets.aspx)文档

许多使用套接字的人确实需要连接到 HTTP 服务器；为此，请使用[System.Net](http://msdn.microsoft.com/en-us/library/system.net.aspx)文档并查找 Http 类——从 WebRequest 开始

[注：我在微软工作]

# asp.net - 通过 IIS SMTP 向外部地址发送电子邮件

> ID：920402
> 
> 赞同：1
> 
> 时间：2009-05-28T11:32:04.290
> 
> 标签：asp.net, iis, smtp

当使用以下代码通过 IIS6 SMTP 向外部电子邮件地址发送电子邮件时，我收到一条消息，指出该消息已发送，但它从未到达目的地。我正在使用 System.Net.Mail 命名空间和以下代码：

```
MailMessage msg = new MailMessage();
msg.From = new MailAddress(from);

foreach (string strTo in to.Split(';'))
{
  if (strTo.Replace(";", "") != string.Empty)
    msgMailSummary.To.Add(new MailAddress(strTo.Replace(";", "")));
}
msg.Subject = subject;
msg.Body = body;

SmtpClient sm = new SmtpClient();
sm.DeliveryMethod = SmtpDeliveryMethod.PickupDirectoryFromIis;
sm.Credentials = new NetworkCredential(tbUsername.Text, tbPassword.Text);
sm.Host = host;
sm.Port = port;
sm.Send(msg); 
```

我在 IIS6 中没有 SmartHost 设置，是否有任何明显或任何提示，我可以查看以使其正常工作的提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T11:40:05.990

嗯，你好像少了一条关键线……

```
msg.To = new MailAddress(to); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:52:02.753

我不确定我是否记错了，但我曾经遇到过无法发送电子邮件的问题，因为我的发件人地址不是我的主机允许的地址。基本上我最终只能设置ReplyTo并离开未定义的From（smtp服务器将自行定义它）。试试看，它可能会奏效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T07:36:17.903

原来是服务器上的设置没有正确配置。

# .net - 如何通过 Windows 应用程序发送短信

> ID：920407
> 
> 赞同：5
> 
> 时间：2009-05-28T11:33:39.077
> 
> 标签：.net, vb.net, sms, serial-port

我想通过 Windows 应用程序发送短信。我运行了代码，但出现错误。这是

```
AT

OK AT+CMGF=1

OK AT+CSCA="+9460921985"

OK AT+CMGS="+9660775564"

    this is new message

+CMS ERROR: 500 
```

我正在使用此代码。

```
Public Class Form2 
  Dim number As String = "+9660775564"
  ''# Dim message As String = TextBox1.Text 
  Dim serialport As New IO.Ports.SerialPort 

  Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click 
    Try With serialport 
      .PortName = "COM5" ''# "COM24" 
      .BaudRate = "9600" 
      .Parity = IO.Ports.Parity.None 
      .DataBits = 8 
      .StopBits = IO.Ports.StopBits.One
      .Handshake = IO.Ports.Handshake.RequestToSend 
      .DtrEnable = True .RtsEnable = True 
    End With

    serialport.Open()
    ''# checks phone status
    serialport.WriteLine("AT" & vbCrLf)
    ''# Configures message as SMS
    serialport.WriteLine("AT+CMGF=1" & vbCrLf)
    ''# Sets message center number
    ''# serialport.WriteLine("AT+CSCA=""+447785016005""" & vbCrLf)
    serialport.WriteLine("AT+CSCA=""+9460921985""" & vbCrLf)
    ''# Sets destination number
    serialport.WriteLine("AT+CMGS=""" & number & """" & vbCrLf)
    ''# Specifies message and sends Ctrl+z
    serialport.WriteLine(TextBox1.Text & Chr(26))
    ''# Displays buffer containing output messages
    System.Threading.Thread.Sleep(2000) ''# CurrentThread.Sleep(2000)
    MsgBox(serialport.ReadExisting)
    serialport.Close()
    MessageBox.Show("OK")

  Catch ex As Exception
    MessageBox.Show(ex.Message)
  End Try
End Sub 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T11:44:17.293

我根本没有编写 SMS 的经验，但您似乎正在调用 serialPort.WriteLine 以及在行尾附加 vbCrLf。

其次，你确定它是你想要的 vbCrLf - 我看到的一些东西只是指'回车' - 这将是 vbCr。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T14:03:02.740

不久前我偶然发现了[Microsoft SMS Sender](http://www.microsoft.com/downloads/details.aspx?familyid=06A4F997-7F69-4891-8929-37B9041924A2&displaylang=en)，它可能会对您有所帮助。虽然我从来没有使用过它......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:17:51.120

+CMS ERROR 500（通常）扩展为“未知错误”。来自 GSM 调制解调器 AT 命令文档：

* * *

> 如果发送失败，例如消息过长，结果码取决于 AT^SM20 命令的当前设置：
> 
> 如果 AT^SM20 等于 1（出厂默认值），任何发送消息的失败都会以“OK”响应。用户应该知道，尽管“OK”响应，消息不会被发送给订阅者。
> 
> 如果 AT^SM20 等于 0，则任何发送消息的失败都会以“ERROR”响应。• 如果超时发送失败，则AT^SM20 =1 导致返回“+CMS ERROR: Unknown error”；
> AT^SM20 =0 导致返回“+CMS ERROR: timer expired”。

* * *

您可能遇到超时/连接问题。也许检查您的调制解调器/电话是否已成功注册服务，即检查对 AT+COPS 的响应？和 AT+CREG？命令。

# linq-to-sql - LINQ to SQL：在提交更改之前删除新添加的子实体 - 失败

> ID：920408
> 
> 赞同：2
> 
> 时间：2009-05-28T11:33:39.967
> 
> 标签：linq-to-sql

我有一个与 Northwind Customer/Orders 非常相似的父子关系，但有一个区别，Orders 表中的 CustomerID 不能接受 NULL，它是一个 FK，孩子有一个名为 OrderID 的列 PKey

我在windows表单数据绑定中使用这个模型，上部区域在文本框中有客户信息，下部区域有一个列出订单的网格

我使用 LINQ 从 DB 检索客户以允许用户编辑客户信息或订单详细信息，当我从订单网格中删除一行然后提交更改时，我收到错误“尝试删除客户和订单之间的关系, 但是，关系的外键之一 (CustomerID) 不能设置为 Null”

在互联网上进行了长时间搜索后，我使用了 DeleteOnNull=True 属性，它现在可以工作了

然而，什么不起作用并且仍然给出相同的确切错误是当我向网格添加新订单然后在 SubmitChanges 之前将其删除

我知道当我在网格中删除一个新订单行时，我只删除了与客户的关联，因此它为该实体设置了 CustomerID=NULL，很好，现在如何在提交更改之前将其完全从实体集中删除以避免错误，我不能使用 DeleteOnSubmit，因为它是一个不是来自 db 的新实体，如果我尝试过，我会收到一个异常，所以使用网格手动删除行不起作用，我猜这正在调用“删除”方法，我不能使用 DeleteOnSubmit ，我该怎么办？

为什么一定要那么难？在 ADO.NET 数据表中要容易得多，如果我删除一行并且它恰好来自 db，那么它会将其标记为删除，如果它是一个新行，那么它将它从集合中删除，完成！在投入大量精力学习 LINQ to SQL 之后，我不想回到数据集

非常感谢任何帮助

谢谢巴萨姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-29T10:06:21.583

我发现了问题所在并解决了它。如果其他人有同样的问题，我想在这里分享信息

首先我想提一个重要的事实：如果在 DB 中启用了 Cascade Delete，那么

```
DeleteOnNull:=True , DeleteRule:="CASCADE" 
```

将自动插入到 .dbml 文件后面的代码中，无需手动添加`DeleteOnNull=True`特定关联。

问题是，`FKey`在子实体中还有另一个`OrderType`，即`OrderTypeID`。我这样设置这个值：

```
Dim NormalOrderType = (From ot in db.OrderTypes Where ot.OrderTypeID=1 Select ot).Single
NewOrder.OrderType = NormalOrderType          
OrdersBindingSource.Add(NewOrder) 
```

当用户从网格中删除特定客户的订单时，LINQ to SQL 将 CustomerID 设置`FKey`为 NOTHING，从而中断与父实体的关联。但是，它**没有**设置`OrderTypeID`为 NOTHING，使其他关联对`OrderTypes`实体保持活动状态。如果`OrderType`实体已经加载到内存中，LINQ to SQL 会认为我仍然想插入子实体，但是使用`CustomerID=Nothing`, 并且由于这是不允许的（从 dbml 文件中，`Nullable=False`），它会在尝试保存之前引发异常首先到DB。

这样做可以解决这个问题：

```
NewOrder.OrderType = NOTHING 
```

这会手动删除 other 的关联`FKey`。然后，简单地删除子实体将导致 LINQ to SQL 在`submitChanges`调用时忽略它。

谢谢巴萨姆
·穆罕默德。

# apache-flex - Flex/Flash TextArea 在每一行都有一个复选框

> ID：920411
> 
> 赞同：1
> 
> 时间：2009-05-28T11:34:16.423
> 
> 标签：apache-flex, actionscript-3

我想知道如何在 textArea 中的每一行的开头添加一个复选框。有点创建一个清单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T00:05:53.800

实际上，这是非常可能的。

改用`<mx:List>`并使用`itemRenderer`属性指向 Flex 组件。

怎么做？如果您有 Flex Builder，只需右键单击您的源文件夹，然后选择 New > Flex Component。将您的组件命名为 myComponent 之类的名称。如果不是，则组件只是一个 .mxml 文件，其中包含一些内容，例如：

```
<mx:HBox>
    <mx:Text text="Some Component" />
</mx:HBox> 
```

就这样。将列表的 itemRenderer 属性指向 myComponent（或它所在的任何位置）。不要包含“.mxml”。该列表现在将显示您的自定义组件而不是一些文本。只需将一些条目添加到列表的 dataProvider 或其他内容以使其显示您的组件。

在您的情况下，您希望在组件中添加一个 mx:CheckBox 和一个 mx:TextInput 以使其具有“待办事项列表”外观。

[在这里](http://cid-8ba446d967d66fd9.skydrive.live.com/self.aspx/Public/Dev/Flex.zip)找到源

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T11:40:27.580

MXML 中的结构如下所示：

```
<mx:VBox>
    <mx:HBox>
        <mx:CheckBox/><mx:TextArea/>
    </mx:HBox>
    <mx:HBox>
        <mx:CheckBox/><mx:TextArea/>
    </mx:HBox>
    <mx:HBox>
        <mx:CheckBox/><mx:TextArea/>
    </mx:HBox>
</mx:VBox> 
```

您可以使用中继器来布置上面的 HBoxes

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:47:24.610

您必须使用 Flex 和 ActionScript 设计自己的组件。沿线的东西：

```
<mx:Panel> <mx:VBox> <mx:HBox><mx:CheckBox><mx:TextArea>... 
```

和一些 ActionScript 函数，它们响应 ENTER 和 BACKSPACE 以创建或销毁 HBox-CheckBox-pairs。

也许，你想要的是一个有两列的 DataGrid，一个是 CheckBox，另一个是 TextField 或 TextArea，两者都是可编辑的（查找 ItemRenderer 和 ItemEditor 的概念）和下一行功能

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-28T16:12:46.753

对不起，你不能。

我从未看过 TextArea 源代码，但我想您可以以某种方式扩展它以在每一行上显示复选框

# .net - 测试项目和配置文件

> ID：920412
> 
> 赞同：2
> 
> 时间：2009-05-28T11:35:02.460
> 
> 标签：.net, wcf, unit-testing

我在我的 Visual Studio 2008 解决方案中有这种设置：一个使用库（Lib1，需要 app.config 文件中的一些配置条目）的 WCF 服务项目 (WCFService)。我有一个单元测试项目 (MSTest)，其中包含与 Lib1 相关的测试。为了运行这些测试，我需要一个测试项目中的配置文件。有没有办法从 WCFService 自动加载它，所以我不需要在两个地方更改配置条目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T11:56:38.860

让您的库在整个代码中直接从 app.config 文件中读取属性将使您的代码变得脆弱且难以测试。最好有一个类负责读取配置并以强类型方式存储配置值。让此类实现定义配置中的属性的接口或使属性虚拟化。然后你可以模拟出这个类（使用像 RhinoMocks 这样的框架或手工制作一个也实现了接口的假类）。将类的一个实例注入到需要通过构造函数访问配置值的每个类中。对其进行设置，以便如果注入的值为 null，则它会创建正确类的实例。

```
 public interface IMyConfig
 {
      string MyProperty { get; }
      int MyIntProperty { get; }
 }

 public class MyConfig : IMyConfig
 {
      public string MyProperty
      {
         get { ...lazy load from the actual config... }
      }

      public int MyIntProperty
      {
         get { ... }
      }
  }

 public class MyLibClass
 {
      private IMyConfig config;

      public MyLibClass() : this(null) {}

      public MyLibClass( IMyConfig config )
      {
           this.config = config ?? new MyConfig();
      }

      public void MyMethod()
      {
          string property = this.config.MyProperty;

          ...
      }
 } 
```

测试

```
 public void TestMethod()
 {
      IMyConfig config = MockRepository.GenerateMock<IMyConfig>();
      config.Expect( c => c.MyProperty ).Return( "stringValue" );

      var cls = new MyLib( config );

      cls.MyMethod();

      config.VerifyAllExpectations();
 } 
```

# makefile - 出错：缺少分隔符

> ID：920413
> 
> 赞同：295
> 
> 时间：2009-05-28T11:35:16.407
> 
> 标签：makefile

我正在运行以下错误`make`：

```
Makefile:168: *** missing separator.  Stop. 
```

这是什么原因造成的？

* * *

## 回答 #1

> 赞同：447
> 
> 时间：2009-05-28T11:38:06.650

如[在线手册](http://www.gnu.org/software/make/manual/html_node/Error-Messages.html)中所述，该错误的最常见原因是当`make`需要制表符时，行会缩进空格。

## 正确的

```
target: 
\tcmd 
```

`\t`TAB ( `U+0009`)在哪里

## 错误的

```
target:
....cmd 
```

其中每个`.`代表一个 SPACE ( `U+0020`)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-11-24T22:14:20.070

只是为了笑，以防其他人遇到类似的错误：

我得到了臭名昭著的“缺少分隔符”错误，因为我调用了一个将函数定义为的规则

```
($eval $(call function,args)) 
```

而不是

```
$(eval $(call function,args)) 
```

即**`($`**而不是**`$(`**。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-28T11:38:20.160

这是您的 Makefile 中的语法错误。如果不查看文件本身或其相关部分，很难比这更具体。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-05-09T23:07:16.880

对我来说，问题是我在多行变量定义中`# ...`嵌入了一些行尾注释。`define ... endef`删除评论使问题消失。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-03-28T20:45:34.347

我的错误出现在具有多行扩展名的变量声明行上。我在“\”之后有一个尾随空格，这使得该行无效。

```
MY_VAR = \
   val1 \ <-- 0x20 there caused the error.
   val2 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-11-03T09:57:29.873

在我的情况下，接下来会导致错误。我试图在全球范围内执行命令，即在任何目标之外。

UPD。要在全局范围内运行命令，必须正确形成一个。例如命令

```
ln -sf ../../user/curl/$SRC_NAME ./$SRC_NAME 
```

会成为：

```
$(shell ln -sf ../../user/curl/$(SRC_NAME) ./$(SRC_NAME)) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-11-28T22:17:43.057

就我而言，我实际上**缺少**介于两者之间的选项卡`ifeq`和下一行的命令。一开始就没有空格。

```
ifeq ($(wildcard $DIR_FILE), )
cd $FOLDER; cp -f $DIR_FILE.tpl $DIR_FILE.xs;
endif 
```

本来应该：

```
ifeq ($(wildcard $DIR_FILE), )
<tab>cd $FOLDER; cp -f $DIR_FILE.tpl $DIR_FILE.xs;
endif 
```

注意这**`<tab>`**是一个实际的制表符

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-02-03T02:10:48.230

就我而言，此错误是由于缺少空间引起的。我的 makefile 中有这个 if 块：

```
if($(METHOD),opt)
CFLAGS=
endif 
```

应该是：

```
if ($(METHOD),opt)
CFLAGS=
endif 
```

if 后面有一个空格。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-11-11T02:54:06.347

我在 qmake 生成的 Makefile 中缺少分隔符文件。我正在将 Qt 代码移植到不同的平台。我没有设置 QMAKESPEC 或 MAKE。这是我找到答案的链接：

[https://forum.qt.io/topic/3783/missing-separator-error-in-makefile/5](https://forum.qt.io/topic/3783/missing-separator-error-in-makefile/5)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-01-22T10:05:16.057

只是添加另一个可以显示的原因：

```
$(eval VALUE) 
```

无效并且会产生“缺少分隔符”错误。

```
$(eval IDENTIFIER=VALUE) 
```

是可以接受的。`define`当我定义了一个宏并尝试执行时，这种错误出现在我身上

```
define SOME_MACRO
... some expression ...
endef

VAR=$(eval $(call SOME_MACRO,arg)) 
```

其中宏没有评估为赋值。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-12-06T06:18:20.457

在我的例子中，同样的错误是因为`:`在结尾缺少冒号而导致的`staging.deploy:`。所以请注意，它可能很容易出现语法错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-28T00:10:54.083

我有这个是因为我之后没有冒号`PHONY`

不是这个，

```
.PHONY install
install:
    install -m0755 bin/ytdl-clean /usr/local/bin 
```

但是这个（注意冒号）

```
.PHONY: install
... 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2015-08-10T11:24:01.243

以下 Makefile 代码有效：

```
obj-m = hello.o

all:
    $(MAKE) -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules 

clean:
    $(MAKE) -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2018-08-19T17:37:52.687

显然，我所需要的只是“build-essential”包，然后首先运行`autoconf`，这使得 . `Makefile.pre.in`，然后是`./configure`完美的`make`工作......

# c# - 如何调查 Session() 过期的原因并让用户知道

> ID：920414
> 
> 赞同：0
> 
> 时间：2009-05-28T11:35:47.903
> 
> 标签：c#, asp.net

如何调查导致会话过期的原因？我想给对我们的网站有以下问题的最终用户一些建议：

```
If Session("xxxx") Is Nothing Then say something.. WHY?? 
```

我可以在 web.config 中添加一些内容以使会话持续更长时间，还是应该阅读 IIS 日志文件以了解为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T13:15:50.167

您可以在 Global.asax 文件的 Session_End 方法中添加一些代码，以帮助确定发生了什么问题，假设您将会话作为 InProc 运行。

要增加 IIS6 中的会话长度，请执行以下操作：

1.  打开 IIS
2.  右键单击您的网站并选择属性
3.  选择主目录选项卡
4.  单击“应用程序设置”部分中的“配置”按钮
5.  选择选项选项卡
6.  将会话超时值增加到您想要的任何值。
7.  关闭所有内容并执行 IISReset

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:11:31.220

我认为通常如果用户在一段时间内什么都不做（没有页面刷新等），那么会话将过期，否则它只会消耗服务器上的大量资源。

在经典的 asp 中，您可以设置一个超时，不确定它是否仍然存在于 asp.net 中。

如果您不希望会话在用户查看您的网站时过期，您可以在您的页面中进行元刷新，或者更聪明一点并使用某种 ajax 计时器来触发并对某些内容进行部分刷新

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T11:43:23.770

第一个会话在`web.config`'s [`<sessionState>`element](http://msdn.microsoft.com/library/h6bb9cz9)中配置。

您也可以获取会话结束事件[`SessionStateModule.End`](http://msdn.microsoft.com/library/system.web.sessionstate.sessionstatemodule.end)（超时或其他原因。

# c# - C# 把通用方法放在哪里？

> ID：920426
> 
> 赞同：2
> 
> 时间：2009-05-28T11:37:31.720
> 
> 标签：c#, methods

在我的应用程序中，我有一种检查变量是否为数字的方法。这个方法在我的代码中被多次调用。从代码隐藏页面调用该方法。像这种方法一样，我有更多的方法不能放在一个类中（比如 Staff）。我应该把这种方法放在哪里？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T11:39:10.143

在实用程序类文件中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T11:43:50.197

在 C# 3.0 中，我可能会将此作为字符串类的扩展方法。我会将我所有的字符串扩展分组到一个静态类中以提高可读性。

```
 public static class StringExtensions
 {
      public static bool IsNumeric( this string source )
      {
          if (string.IsNullOrEmpty( source ))
          { 
               return false;
          }
          ...
      }

      public static bool IsMoney( this string source )
      {
          ...
      }

      ...
 } 
```

用法：

```
 if (amountLabel.Text.IsNumeric())
 {
    ...
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T11:42:25.173

我假设您指的是一个字符串变量。如果是这种情况，我会建议两件事之一

1.  如果您使用的是 PRE .NET 3.0，您可以将它放在 StringHelper 类中，如下所示：

    ```
    public static class StringHelper
    {
      public static bool StringIsNumber(String value)
      {
        //do your test here
      }
    } 
    ```

2.  如果您使用的是 POST .NET 3.0，您可以将它们重构为扩展方法并执行类似的操作

    ```
    public static class StringExtensions
    {
        public bool IsNumber(this String value)
        {
        //do your test here
        }
    } 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T11:42:42.523

听起来您可能可以使用内置函数`int.TryParse(string, out int)`，或者`double.TryParse(string, out double)`两者都返回布尔值，但无论如何都要听 ck 的建议。

# asp.net - 通过不同的 Web 应用程序共享相同的 dll 而无需复制

> ID：920431
> 
> 赞同：6
> 
> 时间：2009-05-28T11:38:31.580
> 
> 标签：asp.net, dll, web-config

我有两个不同的 asp.net Web 应用程序都引用相同的 dll，例如`SharedLibrary.dll`.

我想知道是否有一种方法可以将一些 web.config 设置添加到应用程序的一个配置文件中，以避免需要放置两个 dll 副本。

我的[简化]目录结构如下：

```
\root
     \Admin
           \web.config 
           \Addins
                  \AdminWebAppPage.aspx
                  \bin
                      \AdminWebApp.dll
                      \SharedLibrary.dll  <- this is the duplicated dll (I'd like to remove it from here ideally)
     \Websites
              \MyWebsite
                        \webroot
                                \web.config
                                \MainWebPage.aspx
                                \bin
                                    \MainWebsite.dll
                                    \SharedLibrary.dll 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T11:48:32.697

如果您在[全局程序集缓存 (GAC)](http://msdn.microsoft.com/en-us/library/yf1d93sz(VS.71).aspx)中注册程序集，您的所有应用程序都可以访问它而无需复制。但是，从版本控制和部署的角度来看，我会说保留每个站点的副本是可取的。

澄清：当站点不相关时，最好保留每个站点的副本。显然，如果共享库发生更改，您希望主网站和管理站点都获得更新的副本。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T11:43:28.700

我过去曾这样做过，网站下的虚拟 ROOTS 共享一个 DLL。也就是说，我有一个网站，其中包含一些 DLL 和它下面的管理虚拟根。由于它是主网站的子网站，因此它继承了网站的 DLL。但是我不确定单独的网站...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T11:49:19.310

如果您使用的是 Vista 机器，您可以查看使用[NTFS 符号链接](http://en.wikipedia.org/wiki/NTFS_symbolic_link)

如果您是 Vista 之前但在 Win2k 或更高版本上，[NTFS 连接点](http://en.wikipedia.org/wiki/NTFS_junction_point)可能会有所帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:01:17.607

您可以将该 DLL 放在您希望共享此 DLL 的所有 Web 应用程序具有读取权限的目录中。

在 Application_OnStart 事件中，您可以使用此代码动态加载程序集。

```
Assembly SampleAssembly;
SampleAssembly = Assembly.LoadFrom("c:\\Sample.Assembly.dll"); 
```

您还可以尝试使用 Assembly_Resolve 事件来解析引用。

# java - 调用服务器的 Applet（或 WebStart 应用程序）：最佳实践？

> ID：920442
> 
> 赞同：1
> 
> 时间：2009-05-28T11:41:56.033
> 
> 标签：java, applet, java-web-start

我想编写一个小程序（或 java Web 启动应用程序）调用它的服务器（servlet？）来调用一些方法并发送/检索数据。发送和检索这些消息的最佳方式/技术是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T11:43:25.063

HTTP 请求？参数输入，xml 输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T11:59:21.117

XML 仍然是我进行数据交换的首选。

将 XML 与[xstream](http://xstream.codehaus.org/)之类的东西一起使用，可以消除 XML Java 库的大部分麻烦。您可以以非常简单的方式[序列化和反序列化对象](http://xstream.codehaus.org/tutorial.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T12:16:02.377

协议：

如果您不关心与其他语言的互操作性，我会选择 RMI over HTTP。它得到了 JRE 的支持，一旦你有了框架，它就很容易设置并且很容易使用。

对于应用逻辑，我会使用：

1.  命令模式，传递对象，当被调用时，调用服务器上的方法。这对小型项目很有用，但随着时间的推移和添加更多命令，往往会变得过于复杂。此外，它要求客户端与服务器逻辑耦合。
2.  按名称请求 + DTO 方法。这具有将服务器逻辑与客户端完全分离的好处，使服务器端可以根据需要自由更改。构建支持框架的开销比第一个选项要大一些，但是在我看来，客户端与服务器的分离是值得的。

执行：

如果您还没有开始，或者您已经并且正在使用 Spring，那么 Spring 远程处理是一个很棒的工具。即使您不使用 IOC 容器，它也适用于任何地方（包括小程序）。
如果您不想使用 Spring，基本的 RMI 也很容易使用，并且在 Web 上有大量示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-25T22:50:51.553

一个轻量级的解决方案也可以是[Hessian](http://hessian.caucho.com/)。

一个简单的例子是[here](http://karussell.wordpress.com/2009/04/10/hessian-web-service-protocol-hello-world-example/)。

如果您需要针对这种情况的 ORM：请尝试[Cayenne](http://cayenne.apache.org/)。

# java - orm.xml中的休眠二级缓存？

> ID：920443
> 
> 赞同：4
> 
> 时间：2009-05-28T11:42:15.503
> 
> 标签：java, xml, hibernate, orm, second-level-cache

经过几个小时的谷歌搜索，我意识到用户可以使用 xml 文件（orm.xml，我想？）或 JPA 中的注释，或同时使用两者。我说的对吗？所以，我的项目使用了二级缓存，这在JPA规范中是没有的。我使用如下注释： **@org.hibernate.annotations.Cache(usage = org.hibernate.annotations.CacheConcurrencyStrategy.READ_WRITE)**

对于每个实体。但是，我猜上面的注解不属于JPA注解，因此，我不知道orm.xml中是否有任何等价的东西？我已经查看了 orm.xml 的 xml 架构，并且架构中不允许这样的休眠元素。

如果我不能在orm.xml中做二级缓存配置，除了注解还有什么办法吗？我不想做注释的原因是因为我有两个应用程序，一个使用 READ_WRITE 并发策略，另一个使用 READ_ONLY 并发策略。

提前致谢！！！

科威

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T11:54:50.657

您可以使用 hibernate.cfg.xml、hibernate.properties 或 *.hbm.xml 文件来打开具有不同缓存策略的特定对象的缓存

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T12:11:50.950

如果您不想使用注释，请查看您的休眠二级缓存实现（又名“缓存提供程序”，例如[ehcache](http://ehcache.sourceforge.net/)）的文档如何配置它。

请注意，Hibernate 允许使用不同的缓存提供程序，因此您的问题没有通用答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T11:29:27.323

因此，我认为当前解决我的问题的方法是用 Hibernate 映射文件替换每个实体的所有注释，以便对于不同的部署（也包括应用程序），我们可以使用不同的 Hibernate 映射文件。

# wpf - ViewModel 操作 View 的最佳方式是什么？

> ID：920446
> 
> 赞同：1
> 
> 时间：2009-05-28T11:42:31.133
> 
> 标签：wpf, mvvm

我知道在 MVVM 模式中，**ViewModel 应该对 View 一无所知**。

因此，ViewModel 似乎有**两种方式**可以**导致 UI 上发生特定的事情**，考虑一下这个常见的事件流：

*   用户在文本框中输入内容
*   用户点击按钮
*   按钮调用视图模型上称为“保存”的 DelegateCommand
*   视图模型保存文本框中的文本
*   如果在保存过程中一切顺利，视图模型会将其名为**SaveStatus**的 INotifyPropertyChanged 属性更改为“Succeeded”

现在在视图中，我有两种方法可以让这种更改对**UI 产生影响**：

*   在视图中可能有一个文本块，上面有一个**转换器**，它将**SaveStatus**的文本转换为诸如“保存成功”之类的短语。
*   在视图中可能有一个**触发器**来检查是否**SaveStatus** = "Succeeded"，如果是，那么一系列 Setter 会适当地更改 UI（隐藏元素、更改文本、更改颜色等）

这是您在应用程序中使用的**从 ModelView 到 View 的基本信息流吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T23:02:17.127

您还可以在视图模型上创建自定义事件，并让视图订阅它们并做出相应的反应。您不需要经常这样做，但它比检查每个 INotifyPropertyChanged 事件的特定属性名称更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T11:59:27.277

我们使用的是模型视图控制器模式，所以它是这样的：

*   用户在文本框中输入内容
*   用户点击保存按钮
*   视图告诉控制器保存数据
*   控制器告诉视图获取数据
*   控制器将数据保存到模型中
*   控制器向视图发出保存成功的信号
*   视图显示“保存成功”

我认为您可以使用几乎相同的方法（唯一的区别是控制器和模型都是您示例中的视图模型）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T15:32:16.403

> 这是您在应用程序中使用的从 ModelView 到 View 的基本信息流吗？

是的。我们使用 INotifyPropertyChanged 几乎专门用于从 ViewModel 到视图的更改。在交互更复杂的地方，我们使用 View 连接的其他事件。

我们在 EditableAdapter 上有一个 HasChanges 布尔值，而不是 SaveStatus 消息属性，它包装了我们的 POCO 并提供更改的提交/回滚，以及其他计算的属性。然后我们可以将我们的视图绑定到这个 HasChanges，例如，我们可以显示带有 * 的文档名称以显示它有更改，或者使用 HasChanges 禁用/启用保存按钮。

# jboss - JBoss AS 4.2.3 热部署 爆炸文件

> ID：920451
> 
> 赞同：2
> 
> 时间：2009-05-28T11:43:38.573
> 
> 标签：jboss, jboss-4.2.x

我在 JBoss Application Server 4.2.3.GA 上热部署时遇到问题。`web.xml`当我更新文件时，服务器不会重新部署应用程序。是否只有更改的类会使服务器重新部署应用程序？如果是这种情况，我该如何重新部署非类文件？

请指教。

谢谢，萨奎布

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T12:03:15.273

当 JBoss 检测到 web.xml 发生更改时，它会重新部署 Web 应用程序。确保无论您使用什么来修改它都会更改文件上的时间戳。所以

```
 touch web.xml 
```

应该是重新部署的魅力

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T12:07:19.180

如果您的应用程序是从 EAR 扩展而来的，作为 WAR 的一部分，请尝试更新 META-INF/application.xml 文件。

# c# - 调试语句中包含字符串操作的最佳实践是什么？

> ID：920458
> 
> 赞同：2
> 
> 时间：2009-05-28T11:45:53.997
> 
> 标签：c#, java, debugging, log4net, log4j

我经常发现自己在 log4net 和 log4j 的调试语句中添加连接字符串或使用字符串格式化程序，我应该用“if debug”块包围这些调试语句，以防止自己通过处理这些参数来浪费资源，即使调试语句会不打印出来？

我会假设检查 (isDebug) 是否比发生字符串操作更快更有效，但是当调试级别设置为高于调试时，它会导致程序运行不同（更快），这可能意味着同步问题当我写日志时，生产中发生的事情不会发生。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T11:49:30.807

对于 Java，您可以尝试[log5j](http://code.google.com/p/log5j/)。

日志4j：

```
log.debug("This thing broke: " + foo + " due to bar: " + bar + " on this thing: " + car); 
```

日志5j：

```
log.debug("This thing broke: %s due to bar: %s on this thing: %s", foo, bar, car);
log.debug("Exception #%d", aThrowable, exceptionsCount++); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T11:48:21.403

我想说这取决于调用调试语句的频率以及性能的重要性。提防过早的优化等等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-29T12:34:24.447

[SLF4J FAQ](http://www.slf4j.org/faq.html#logging_performance)中详细回答了这个问题。简而言之，使用参数化消息。比如`entry`是一个对象，可以这样写：

```
 Object entry = new SomeObject(); 
 logger.debug("The entry is {}.", entry); 
```

在评估是否记录之后，并且只有在决定是肯定的情况下，记录器实现才会格式化消息并将“{}”对替换为条目的字符串值。换句话说，这种形式不会在日志语句被禁用的情况下产生参数构造的成本。

以下两行将产生完全相同的输出。但是，在禁用日志记录语句的情况下，第二种形式的性能至少比第一种形式高出 30 倍。

```
 logger.debug("The new entry is "+entry+"."); 
  logger.debug("The new entry is {}.", entry); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T11:55:24.603

您是否测量过连接这些字符串所花费的额外时间？鉴于日志基础设施将获取结果消息，检查是否需要将它们分派到（可能）多个接收器，然后可能使用一些 I/O 进行写入，那么您可能什么也得不到。我的感觉是，除非你的 toString() 机制很慢，否则这可能是一个太过分的优化。

我也对这种方法持谨慎态度，以防有人写这样的东西（我们知道他们不应该这样做，但我以前见过）

```
if (Log.isDebugEnabled()) {
   Log.debug("Received " + (items++) + " items");
} 
```

然后这将根据您的日志记录级别工作/失败。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T12:13:51.727

试试 slf4j ( [http://www.slf4j.org/](http://www.slf4j.org/) )。你写的语句如下：

```
log.fine("Foo completed operation {} on widget {}", operation, widget); 
```

在确定日志级别足够高之前，不会在库内组装日志消息。我觉得这是最好的答案。

（这很像上面的 log5j 解决方案。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T12:46:44.483

在 log4j 中，以下是推荐的最佳实践：

```
if ( log.isDebugEnabled() )
{
 log.debug("my " + var + " message";
} 
```

这从字符串连接等中节省了系统资源。您的假设是正确的，即在启用调试级别时程序可能执行得更慢，但这是可以预料的：被观察的系统被改变，因为它正在被观察。同步问题（主要）处理线程之间不幸的时间或可变可见性，这两者都不会直接受到调试级别更改的影响。您仍然需要“玩”系统来重现多线程问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-29T12:49:37.863

我们采用了在每个类中定义私有静态只读布尔调试变量的做法。

```
private static readonly log4net.ILogger LOG = log4net.LogManager.GetLogger();
private static readonly bool DEBUG = LOG.IsDebugEnabled; 
```

每个实际的调试日志行看起来像这样

```
if (DEBUG) LOG.Debug(...); 
```

其中 ... 可以具有任意复杂性，并且仅在需要调试时进行评估。

请参阅：[http](http://logging.apache.org/log4net/release/faq.html) ://logging.apache.org/log4net/release/faq.html ，“什么是（非）记录的最快方式？”的答案。

这对我们有用，因为我们只在启动时读取日志配置。

由于每个函数调用至少有一个调试语句，我们认为必须编写 if (DEBUG) 是值得的，以在关闭调试的情况下获得最大性能。我们在打开和关闭调试的情况下进行了一些测量，发现性能提高了 10% 到 20%。我们还没有测量 if (DEBUG) 的效果是什么。

顺便说一句：我们只对调试消息执行此操作。警告、信息和错误直接通过 LOG.Warn 等产生。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T14:20:42.313

在 C# 中，我们已经开始使用委托来处理昂贵的日志语句。只有在日志级别足够高时才会调用它：

```
log.Debug(()=> "Getting the value " + SomeValue() " is expensive!"); 
```

这可以防止在检查的级别与记录的级别不同的情况下记录错误，即：

```
if(log.Level == Level.Info)
    log.Debug("Getting the value " + SomeValue() " is expensive!"); 
```

我发现它更具可读性。

[编辑] 如果因为不适用于 Log4Net 而被否决 -在 Log4Net 周围编写一个包装器来做到这一点是**微不足道的。**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T11:52:48.260

条件编译使用 final 常量，它们是静态的 final 变量。一个类可能会像这样定义常量：

```
private static final boolean DEBUG = false; 
```

定义了这样一个常量后，以下代码中的任何代码：

```
if (DEBUG) {
    // code
} 
```

**实际上并没有编译到类文件**中。要激活该类的调试，只需将常量的值更改为 true 并重新编译该类（您可以有两个版本的二进制文件，一个用于开发，一个用于生产）。

**然而，由于几个原因，这个解决方案不是最理想的。**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T11:53:33.077

我倾向于将所有对调试的调用包装在 isDebug 语句中。我不认为这是过早的优化，这只是一种好的做法。

担心应用程序以不同的速度运行是不明智的，因为处理器上的负载可能/将影响您的应用程序，而不是调试代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-28T16:12:18.593

从 log4j 配置文件中查找外部化日志级别。这样您就可以根据您的环境选择打开或关闭日志（并避免所有这些字符串连接）。

```
if(log.isDebugEnabled())
{
    log.debug("Debug message");
} 
```

# c# - rdlc 报告中的分页

> ID：920463
> 
> 赞同：1
> 
> 时间：2009-05-28T11:47:49.657
> 
> 标签：c#

如何设置分页或单页显示的项目数？假设有 1000 个项目，我想在每一页显示 100 个并使用下一个按钮导航到下一页。我怎么能做到这一点，请在 c# context 中讨论。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T12:00:28.930

您可以使用 PageBreaks 来做到这一点。

来自 MSDN：

分页符

> 在某些报表中，您可能希望在指定行数的末尾放置一个分页符，而不是在组或报表项上，或除此之外。为此，请在数据区域中创建一个组（通常是紧接在详细信息之外的组），向该组添加一个分页符，然后添加一个组表达式以按指定的行数进行分组。
> 
> 以下表达式放在组表达式中时，为每组 25 行分配一个数字。当为组定义分页符时，这将导致每 25 行分页符。

```
 =Int((RowNumber(Nothing)-1)/25) 
```

取自[http://msdn.microsoft.com/en-us/library/ms251668(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms251668(VS.80).aspx)

# javascript - Javascript 函数在 Mozilla 中不起作用

> ID：920466
> 
> 赞同：1
> 
> 时间：2009-05-28T11:48:09.703
> 
> 标签：javascript, javascript-events

以下功能适用于 IE，但不适用于 Mozilla 和其他浏览器

```
 function CloseSession() {        
     alert("Inside Close");  
      if ((window.event.clientX < 0) || (window.event.clientY<0)) {  
        alert("Inside Events");  
        location.href = '/forms/sessionkill.aspx';  
      }    
   } 
```

我想做的是，单击该按钮后，我在页面上有一个按钮，在新窗口中打开的页面具有会话，会话将一直保持到用户关闭浏览器为止。在新页面上有正确的导航，不同的页面有不同的链接。如果我直接调用我的 sessionkill.aspx，它会在单击窗口卸载功能上的链接时终止会话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T11:52:48.540

Mozilla 不设置全局`window.event`属性。

我建议使用 AJAX 框架，例如 JQuery（甚至是 Microsoft AJAX）。

```
function CloseSession(event) {   
  // use Mozilla event parameter, or window.event if that was not passed     
  event = event || window.event; 
  alert("Inside Close");  
  if ((event.clientX < 0) || (event.clientY<0)) {  
    alert("Inside Events");  
    location.href = '/forms/sessionkill.aspx';  
  }    
} 
```

更新：如果您使用的是 JQuery：

```
function CloseSession(e) {   
  alert("Inside Close");  
  if ((e.pageX < 0) || (e.pageX < 0)) {  
    alert("Inside Events");  
    location.href = '/forms/sessionkill.aspx';  
  }    
} 
```

# python - Python Cookie 问题

> ID：920472
> 
> 赞同：2
> 
> 时间：2009-05-28T11:49:15.177
> 
> 标签：python, cookies, cgi

```
import cgitb
import Cookie, urllib2
from cookielib import FileCookieJar
cgitb.enable()
c = Cookie.SmartCookie()
c['ini'] = 1
savedc = FileCookieJar()
savedc.add_cookie_header(c.output())
savedc.save() 
```

这不应该保存cookie吗？...

我已经阅读了 100 万次 python 文档，我只是不明白:(

请帮助某人:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T12:57:47.580

**Raf**，我只能说，Egads！文档当然*不清楚*！我已经使用 Python 多年了，这个简单的 Stack Overflow 问题，我认为在开始一天的实际工作之前我会很快解决这个问题，但我花了 20 多分钟来回答。:-)

第一：原来“Cookie”库和“cookielib”库是完全独立的，彼此没有任何关系。这在文档中有所说明，但您必须向下滚动到每个文档页面的“另请参阅”部分才能找到它。如果它位于每个页面的顶部，那将会很有帮助。

因此，当您将“Cookie”库中的对象传递给“cookielib”时，您会混淆“cookielib”内部结构，因为它将 cookie 存储在字典中，并且“Cookie”cookie 看起来像 - 你猜怎么着！— 一个字典，因此“cookielib”将其混淆为它自己的内部数据结构之一，并将其​​他 cookie 保存在其中。结果我得到的错误是：

```
<type 'exceptions.AttributeError'>: 'str' object has no attribute 'discard'
  args = ("'str' object has no attribute 'discard'",)
  message = "'str' object has no attribute 'discard'" 
```

实际上，这是我在 Cookie.Cookie 对象上粘贴了一堆不属于那里的属性*后*得到的错误，但是我在意识到我正在从事试图获取 Cookie.Cookie 的无望任务之前添加了表现得像 cookielib.Cookie。:-) 早期的错误都是缺少属性的错误，例如：

```
<class 'Cookie.CookieError'>: Invalid Attribute name
  args = ('Invalid Attribute name',)
  message = 'Invalid Attribute name' 
```

（并且我将错误放在这里，以防将来一些可怜的灵魂混淆了 Cookie 类并进行了我刚刚所做的 Google 搜索，但没有一个结果显示我遇到的错误！）

所以在我们继续之前，我必须知道：你是否试图像一个 web*服务器*一样，向客户端发送 cookie 并试图在客户端发送下一个请求时让它们完整地返回，在这种情况下，我应该向你展示如何“ Cookie”模块有效吗？或者您正在编写一个 Web 客户端，用于测试或娱乐，它与它通过 Web 请求发送到网站的 cookie 混淆，在这种情况下我们应该讨论“cookielib”？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T12:32:34.293

确保将文件命名为将 cookie 存储在：

```
savedc = FileCookieJar('cookies.txt') 
```

`add_cookie_header`接受一个请求对象；`set_cookie`需要一个 Cookie。正如它在文档中所说，`FileCookieJar.save`“引发 NotImplementedError。子类可能使此方法未实现。” 猜猜你应该尝试阅读文档 1E6+1 次。

# tfs - 如何获取 TFS 构建状态通知？

> ID：920477
> 
> 赞同：51
> 
> 时间：2009-05-28T11:49:40.013
> 
> 标签：tfs, build, notifications, status

我想在 TFS 中获取构建状态（无论是成功还是失败）。哪些类和方法可以用于此目的？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2010-09-15T16:58:01.013

您可以运行 Build Notifications，它类似于 CC Tray，因为它会不断地为您提供您有兴趣关注的所有构建的状态。要启动该工具，请转到...

所有程序-->Microsoft Visual Studio 2010-->Team Foundation Server Tools-->构建通知

单击“选项”按钮以订阅服务器上的任何构建。这现在将显示在您的系统托盘中，带有绿色复选框或红色 X 以指示您选择的构建的状态。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2014-10-05T10:04:06.123

在带有 TFS 2013 的 Visual Studio 2013 中，您会收到来自 TFS 的电子邮件警报和构建通知系统托盘工具：http: [//msdn.microsoft.com/en-us/library/ms181725.aspx](http://msdn.microsoft.com/en-us/library/ms181725.aspx)

但是，它通常不会出现在 Windows 8 的“开始”屏幕中，即使通过搜索也是如此。因此，在大多数安装中从这里手动运行它：

C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\IDE\BuildNotificationApp.exe

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-28T11:53:12.003

TFS API 主要记录在 MSDN 上的 Visual Studio SDK 下：http: [//msdn.microsoft.com/library/bb130146](http://msdn.microsoft.com/library/bb130146)，但是构建 API 位于不同的位置（在 TFS 文档中）：[http://msdn。 microsoft.com/library/cc339575](http://msdn.microsoft.com/library/cc339575)。

这些是 tf.exe 和 Team Explorer（等）使用的相同程序集。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-28T12:12:37.003

如果您只想要警报（不是以编程方式）：您可以右键单击*团队资源管理器*中的项目并选择*Project Alerts*。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-04-04T10:17:18.443

您可以使用[AnyStatus](http://www.anystat.us)监控 XAML 和 vNext 构建以及许多其他监控器，例如 Windows 服务、HTTP、TCP/IP、Ping、GitHub、其他 CI/CD 工具、性能计数器等。

免责声明：我是 AnyStatus 的作者

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T11:53:35.980

查看[MSBuildCommunityTasks](http://msbuildtasks.tigris.org/)库。它有一个邮件任务。

将其导入您的构建项目以发送邮件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-01-19T16:37:57.473

要启用构建通知电子邮件警报，请在团队资源管理器中：

如果您尚未连接到要工作的团队项目，请连接到团队项目。

选择**主页**，然后选择**设置**。

在**Settings 页面**的**Team Project**下，选择**Project Alerts**。选择一个或多个警报事件。

在“**将我的警报发送至**”框中，选择“**编辑**”并输入应接收警报的每个人的电子邮件地址。使用分号分隔多个电子邮件地址。

更多详细信息，请参阅：[https ://msdn.microsoft.com/en-us/library/ms181725.aspx](https://msdn.microsoft.com/en-us/library/ms181725.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T22:57:52.393

在 TFS 2008 下，您可以右键单击 TFS 项目名称（在团队资源管理器中）并选择项目警报。

然后选择 A Build Completes 警报并将您的电子邮件地址放入 Send To 字段。

我*认为*TFS 2005 也有这个功能，但我不记得了。有一阵子了。;)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-04-21T15:34:57.547

我刚刚发现了[CatLight](https://catlight.io/downloads)，它可以毫不费力地工作。AnyStatus 从未取得过任何成功。CatLight 位于您的托盘中，并在构建成功或失败时通知您。

# javascript - JavaScript - 使用 childNodes 遍历 HTML DOM 会导致非 IE 浏览器中的错误

> ID：920478
> 
> 赞同：2
> 
> 时间：2009-05-28T11:49:49.543
> 
> 标签：javascript, html, dom

我的浏览器中呈现了下表。它是从服务器端生成的。

```
<table id="tblQuestions" class="tblQuestionsContainer" border="0">
    <tr>
        <td id="1" class="tdQuestion">Are u an indian citizen ?</td>
    </tr><tr>
        <td><table id="answer-1" border="0">
            <tr>
                <td><input id="answer-1_0" type="radio" name="answer-1" value="1" /><label for="answer-1_0">Yes</label></td><td><input id="answer-1_1" type="radio" name="answer-1" value="0" /><label for="answer-1_1">No</label></td>
            </tr>
        </table></td>
    </tr><tr>
        <td id="2" class="tdQuestion">Do you have a passport ?</td>
    </tr><tr>
        <td><table id="answer-2" border="0">
            <tr>
                <td><input id="answer-2_0" type="radio" name="answer-2" value="1" /><label for="answer-2_0">Yes</label></td><td><input id="answer-2_1" type="radio" name="answer-2" value="0" /><label for="answer-2_1">No</label></td>
            </tr>
        </table></td>
    </tr>
</table> 
```

现在我在我的 JavaScript 中使用以下代码来验证单选按钮的选中状态。

```
 var tblQuestionBoard=document.getElementById("tblQuestions");
  tblAnswer = tblQuestionBoard.rows[1].childNodes[0].childNodes[0] 
```

现在 tblAnswer 应该是一个对象，其表的 ID 为“answer-1”

在 IE 中，我明白了。但在 Mozilla 和其他浏览器中，我将其视为未定义。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T11:55:11.797

这是因为您正在使用`childNodes`DOM 中的空格被 Firefox et 视为文本节点。al 但不是 IE

请参阅[此答案](https://stackoverflow.com/questions/868407/hide-an-elements-next-sibling-with-javascript/868418#868418)以获取解释

我的建议

1.设置一些忽略[`nodeType`](http://www.javascriptkit.com/domref/nodetype.shtml)除 1 ( `ELEMENT_NODE`) 之外的任何包装函数来进行 DOM 遍历。就像是

```
function child(elem, index) {
    // if index is not supplied, default is 1 
    // you might be more comfortable making this 0-based
    // in which case change i initial assignment value to 0 too
    index = index || 1; 
    // get first child element node of elem
    elem = (elem.firstChild && elem.firstChild.nodeType != 1) ?
               next(elem.firstChild) :
               elem.firstChild; 
    // use the index to move to nth-child element node             
    for(var i=1; i < index;i++) {
        (function() {     
            return elem = next(elem);         
        })();        
    }
    return elem;
}

function next(elem) {
    do {
        elem = elem.nextSibling;
    } while (elem && elem.nodeType != 1);
return elem;                
} 
```

并像这样使用 -[**工作演示**](http://jsbin.com/ajafi)- （答案底部的代码供参考）

```
<table id="myTable">
    <thead>
        ...
    </thead>
    <tbody>
        ...
    </tbody>
</table>

<script type="text/javascript">
    child(document.getElementById('myTable'), 2); // will get the tbody
</script> 
```

2.使用`getElementbyId()`, `getElementsByTagName()`or`getElementsByName()`代替依赖 DOM 中的位置

3.使用抽象浏览器差异的JavaScript库（强烈推荐[jQuery ）](http://www.jquery.com)

**演示代码**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script type="text/javascript">
    window.onload = function() {    
       document.getElementById('getCellContents').onclick = getCellContents;    
    }

    function child(elem, index) {
        index = index || 1; 
        elem = (elem.firstChild && elem.firstChild.nodeType != 1) ?
                   next(elem.firstChild) :
                   elem.firstChild;            
        for(var i=1; i < index;i++) {
            (function() {    
                return elem = next(elem);         
            })();        
        }
        return elem;
    }

    function next(elem) {
        do {
            elem = elem.nextSibling;
        } while (elem && elem.nodeType != 1);
    return elem;                
    }

    function getCellContents() {
        var row = parseInt(document.getElementById('row').value, 10);
        var column = parseInt(document.getElementById('column').value, 10);
        var result;
        var color;
        var table = document.getElementById('table');
        var cells = table.getElementsByTagName('td');
        for (var i= 0; i < cells.length; i++) {
            (function() {
                cells[i].bgColor = '#ffffff';
            })();
        }

        if (row && column) {
            var tbody = child(table , 2);
            var selectedRow = (row <= tbody.getElementsByTagName("tr").length)? child(tbody, row): null;
            var selectedCell = (selectedRow && column <= selectedRow.getElementsByTagName("td").length)? child(selectedRow, column): null;  

            if (selectedRow && selectedCell) {
                selectedCell.bgColor = '#00ff00';
                result = selectedCell.innerHTML;
                color = '#b7b7b7';
            }
            else {
                result = 'Cell does not exist';
                color = '#ff0000';
            }                                           
        }
        else {
            result = 'You must provide numeric arguments for Row and Column Number';
            color = '#ff0000';
        }       
        var results = document.getElementById('results');
        results.innerHTML = result;
        results.style.color = color;
    }

</script>
<title>DOM Traversal</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<style type="text/css">
body {
    font-family: Verdana, Helvetica, Arial;
    font-size: 0.8em;
}
h2 {
    text-align:center;
}
table { 
    border: 1px solid #000;
    border-collapse: collapse;
}   
th, td { 
    border: 1px solid #000; 
    padding: 2px; 
}
fieldset {
    border: 0;
}
label {
    display: block;
    width: 120px;
    text-align: right;
    float: left;
    padding-right: 10px;
    margin: 5px 0;
}
input {
    margin: 5px 0;
}

input.text {
    padding: 0 0 0 3px;
    width: 172px;
}

input.button {
    margin: 15px 0 0 130px;
}
span {
    font-weight: bold;
    color: #b7b7b7;
}
</style>
</head>
<body>

<h2>Example to demonstrate use of JavaScript DOM traversing wrapper functions</h2>
<div style="margin: 0 auto; width: 600px;">
<fieldset>
    <label for="row">Row Number:</label><input id="row" class="text" type="text" /><br/>
    <label for="column">Column Number:</label><input id="column" class="text" type="text" /><br/>
    <input id="getCellContents" type="button" class="button" value="Get Cell Contents" />
</fieldset> 

<p>Results: <span id="results"></span></p>

  <table id="table">
  <thead>
    <tr>
            <th>Column 1</th>
            <th>Column 2</th>   
        <th>Column 3</th>
        <th>Column 4</th>
        <th>Column 5</th>   
    </tr>   
  </thead>
  <tbody>
      <tr>
        <td>Banana</td>
        <td>Apple</td>
        <td>Orange</td>
        <td>Pineapple</td>
        <td>Cranberry</td>
      </tr>
      <tr>
        <td>Monkey</td>
        <td>Giraffe</td>
        <td>Elephant</td>
        <td>Tiger</td>
        <td>Snake</td>
      </tr>
      <tr>
        <td>C#</td>
        <td>Java</td>
        <td>Python</td>
        <td>Ruby</td>
        <td>Haskell</td>
      </tr>
      <tr>
        <td>France</td>
        <td>Spain</td>
        <td>Italy</td>
        <td>Germany</td>
        <td>Netherlands</td>
      </tr>
  </tbody>
  </table>
<p style="font-weight:bold;">The Code:
<pre><code>
&lt;script type="text/javascript"&gt;
window.onload = function() {    
   document.getElementById('getCellContents').onclick = getCellContents;    
}

function child(elem, index) {
    index = index || 1; 
    elem = (elem.firstChild && elem.firstChild.nodeType != 1) ?
               next(elem.firstChild) :
               elem.firstChild;                
    for(var i=1; i < index;i++) {
        (function() {   
            if(elem)  
            return elem = next(elem);         
        })();        
    }
    return elem;
}

function next(elem) {
    do {
        elem = elem.nextSibling;
    } while (elem && elem.nodeType != 1);
return elem;                
}

function getCellContents() {
    var row = parseInt(document.getElementById('row').value, 10);
    var column = parseInt(document.getElementById('column').value, 10);
    var result;
    var color;
    var table = document.getElementById('table');
    var cells = table.getElementsByTagName('td');
    for (var i= 0; i < cells.length; i++) {
        (function() {
            cells[i].bgColor = '#ffffff';
        })();
    }

    if (row && column) {
        var tbody = child(table , 2);
        var selectedRow = (row <= tbody.getElementsByTagName("tr").length)? 
                            child(tbody, row): null;
        var selectedCell = (selectedRow && column <= selectedRow.getElementsByTagName("td").length)? 
                                child(selectedRow, column): null;   

        if (selectedRow && selectedCell) {
            selectedCell.bgColor = '#00ff00';
            result = selectedCell.innerHTML;
            color = '#b7b7b7';
        }
        else {
            result = 'Cell does not exist';
            color = '#ff0000';
        }                                           
    }
    else {
        result = 'You must provide numeric arguments for Row and Column Number';
        color = '#ff0000';
    }       
    var results = document.getElementById('results');
    results.innerHTML = result;
    results.style.color = color;
}
&lt;/script&gt;
</code>
</pre>
</p>
  </div>
</body>
</html> 
```

# c# - 箭头键和更改控件的焦点会挂起应用程序

> ID：920481
> 
> 赞同：0
> 
> 时间：2009-05-28T11:50:01.837
> 
> 标签：c#, winforms, keyboard

我有一个用户控件，其中包含一个`FlowLayoutPanel`（自上而下的流程）和一堆单选按钮。该控件公开一个`CheckedChanged`事件，只要其中一个单选按钮的检查发生更改，就会触发该事件。

我的表单包含用户控件和一个文本框。我订阅了用户控件的`CheckedChanged`事件，根据选中的单选按钮，我要么禁用文本框，要么将焦点放在文本框内。

当更改单选按钮的检查状态时，所有这些都可以通过鼠标单击正常工作。但是，当使用箭头键时，这将无限期挂起。我不明白为什么会有差异。

以下是重现我所看到的行为的步骤：

1.  创建一个用户控件并删除一个`FlowLayoutPanel`控件并设置其`FlowDirection = TopDown`. 然后将两个单选按钮添加到`FlowLayoutPanel`.

2.  在用户控件中提供事件处理程序

    ```
    public event EventHandler CheckedChanged
    {
        add { radioButton2.CheckedChanged += value; }
        remove { radioButton2.CheckedChanged -= value; }
    } 
    ```

3.  创建一个 windows 窗体并删除上面的用户控件。添加一个文本框并设置`Enabled`为 False。订阅用户控件的`CheckedChanged`事件如下

    ```
    private void userControl11_CheckedChanged(object sender, EventArgs e)
    {
        textBox1.Select();
    } 
    ```

4.  跑。请注意，如果您使用鼠标在单选按钮之间单击，则一切正常；但如果您使用向上/向下箭头键，它会崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T02:06:49.487

```
public event EventHandler CheckedChanged
{
    add {
         radioButton2.CheckedChanged += value;
        }
    remove {
         radioButton2.CheckedChanged -= value;
        }
} 
```

嗯，`value`是未初始化吗？还是我错过了什么？

# c++ - 在 VC++ 中从网络摄像头捕获视频

> ID：920483
> 
> 赞同：2
> 
> 时间：2009-05-28T11:51:08.120
> 
> 标签：c++, visual-c++

除了 DirectShow，还有哪些其他选择？我想在当前正在开发的即时消息应用程序中使用它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T11:54:36.273

看看opencv。它支持从网络摄像头捕获实时流。

[http://opencv.willowgarage.com/wiki/](http://opencv.willowgarage.com/wiki/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T11:55:09.360

DirectShow 之前的 API 是[Video for Windows](http://msdn.microsoft.com/en-us/library/ms713492%28VS.85%29.aspx)，我想它仍然可以工作，Windows 倾向于非常支持向后兼容性。不过，驱动程序支持可能存在问题，有时硬件制造商不喜欢支持多个 API：s 太多。不过，我不确定不同的 API:s 是否需要不同的驱动程序。

# c++ - 如何修复“/lib/tls/libc.so.6：找不到版本‘GLIBC_2.4’”？

> ID：920485
> 
> 赞同：2
> 
> 时间：2009-05-28T11:52:04.187
> 
> 标签：c++, linker

我编译了一个二进制文件并复制到另一台机器上执行。但我收到上述错误。在第二台机器上，我无法安装新库。我尝试将第一台机器上的 libc 放入第二台机器上二进制文件的目录中，但链接器（正如我使用 ldd 发现的那样）仍然从标准路径 /lib/tls/libc.so.6 加载）。请让我知道对此的最小更改修复。

更新：

用于编译/链接的命令：

> g++ -O2 -DNDEBUG -o CountStrings -I../../../../../tbb/tbb20_20080408oss_src/include/../src/CountStrings.cpp -L../../../ ../../tbb/tbb20_20080408oss_src/build/linux_ia32_gcc_cc4.3.2_libc2.8.90_kernel2.6.27_release/ -ltbb

libtbb.so 依赖于 libc.so.6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-27T12:59:13.623

事实上，更简单的解决问题的方法是**升级您的操作系统版本**。

例如，Java 1.7 不能在 RedHat 4 上运行，但在 RedHat 5 上运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T12:17:20.783

`LD_LIBRARY_PATH=<location_of_your_lib>`尝试为您的进程导出，
例如将在其他任何地方之前`$ LD_LIBRARY_PATH=/home/kumar ./a.out`
查找库`/home/kumar/`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T12:14:47.107

Have you checked to see if there is a static version of the library on the compilation machine? If there is you could explicitly link against it, using /lib/tls/libc.a instead of -L/lib/tls -lc (or whatever your dialect is).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T00:16:49.473

我不确定使用系统提供的其他 libc 可能会产生什么（不良）副作用，但您可以尝试强制使用带有[LD_PRELOAD的特殊 libc 副本](http://en.wikipedia.org/wiki/Dynamic_linker)

```
LD_PRELOAD=<location_of_your_lib> <yourprogram> 
```

# google-calendar-api - 生成与 Google 日历兼容的供稿

> ID：920486
> 
> 赞同：0
> 
> 时间：2009-05-28T11:52:11.067
> 
> 标签：google-calendar-api, atom-feed

我正在尝试构建一个与谷歌日历兼容的提要（原子），用户可以订阅并使用它来接收更新，但到目前为止我所阅读的所有内容都涉及使用 GData API 与谷歌通信。如果用户选择这样做，我只想提供一个可以添加到 Google 日历的提要 url。

当我尝试将`<gd:where>`and`<gd:who>`元素添加到“普通”原子提要时，它在我的提要阅读器中中断了。

我会以错误的方式解决这个问题吗？还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T14:24:26.020

我可能很密集，但如果您尝试为用户提供日历信息，使用 ICS 格式不是更好的主意吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:26:28.493

不是真正的答案，但罗马 API 可能有用

[https://rome.dev.java.net/](https://rome.dev.java.net/)

卡尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-08T07:36:03.447

如果您使用 Firefox 并查看 Google 日历提要的来源，然后将其发送到服务器，它将无法正常工作。为什么不？

你自己试试吧。

查看源：http://www.google.com/calendar/feeds/usa__en@holiday.calendar.google.com/public/basic

# c++ - __cxa_pure_virtual 的目的是什么？

> ID：920500
> 
> 赞同：64
> 
> 时间：2009-05-28T11:55:10.000
> 
> 标签：c++, avr-gcc, pure-virtual

在使用 avr-gcc 进行编译时，我遇到了如下链接器错误：

```
undefined reference to `__cxa_pure_virtual' 
```

我发现[这个文件](http://ccgi.rowley.co.uk/support/faq.php?do=article&articleid=127)说：

> 该`__cxa_pure_virtual`函数是在调用纯虚函数时调用的错误处理程序。
> 
> 如果您正在编写具有纯虚函数的 C++ 应用程序，则必须提供自己的`__cxa_pure_virtual`错误处理函数。例如：
> 
> `extern "C" void __cxa_pure_virtual() { while (1); }`

按照建议定义此函数可修复错误，但我想知道：

*   这个函数的目的是什么，
*   为什么我需要自己定义它和
*   为什么将其编码为无限循环是可以接受的？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-28T12:02:23.963

如果在程序运行时的任何地方创建了一个未填充虚函数指针的对象，并且当调用相应的函数时，您将调用一个“纯虚函数”。

您描述的处理程序应该在您的开发环境附带的默认库中定义。如果您碰巧省略了默认库，您会发现这个处理程序未定义：链接器看到一个声明，但没有定义。那时您需要提供自己的版本。

无限循环是可以接受的，因为它是一个“响亮”的错误：您的软件的用户会立即注意到它。任何其他“响亮”的实现也是可以接受的。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-02-20T02:38:25.270

1) __cxa_pure_virtual() 函数的目的是什么？

在对象构造/销毁期间可以调用纯虚函数。如果发生这种情况，会调用 __cxa_pure_virtual() 来报告错误。请参阅[“纯虚函数调用”崩溃从何而来？](https://stackoverflow.com/questions/99552/where-do-pure-virtual-function-call-crashes-come-from)

2）为什么你需要自己定义它？

通常这个函数由 libstdc++ 提供（例如在 Linux 上），但 avr-gcc 和 Arduino 工具链不提供 libstdc++。

Arduino IDE 在构建某些程序时设法避免链接器错误，因为它使用选项“-ffunction-sections -fdata-sections”进行编译并使用“-Wl,--gc-sections”链接，这会删除对未使用符号的一些引用.

3) 为什么将 __cxa_pure_virtual() 编码为无限循环是可以接受的？

好吧，这至少是安全的；它做了一些可预测的事情。中止程序并报告错误会更有用。但是，无限循环很难调试，除非您有一个可以中断执行并提供堆栈回溯的调试器。

# c# - 如何在 C# 中“联合”2 个或更多数据表？

> ID：920505
> 
> 赞同：13
> 
> 时间：2009-05-28T11:56:18.393
> 
> 标签：c#, datatable

如何在 C# 中“联合”2 个或更多数据表？

两个表具有相同的结构。

是否有任何内置功能或者我们应该手动执行？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-28T12:01:51.453

您最有可能寻找[DataTable.Merge](http://msdn.microsoft.com/en-us/library/system.data.datatable.merge.aspx)方法。

**示例**：

```
private static void DemonstrateMergeTable()
{
    DataTable table1 = new DataTable("Items");

    // Add columns
    DataColumn idColumn = new DataColumn("id", typeof(System.Int32));
    DataColumn itemColumn = new DataColumn("item", typeof(System.Int32));
    table1.Columns.Add(idColumn);
    table1.Columns.Add(itemColumn);

    // Set the primary key column.
    table1.PrimaryKey = new DataColumn[] { idColumn };

    // Add RowChanged event handler for the table.
    table1.RowChanged += new 
        System.Data.DataRowChangeEventHandler(Row_Changed);

    // Add ten rows.
    DataRow row;
    for (int i = 0; i <= 9; i++)
    {
        row = table1.NewRow();
        row["id"] = i;
        row["item"] = i;
        table1.Rows.Add(row);
    }

    // Accept changes.
    table1.AcceptChanges();
    PrintValues(table1, "Original values");

    // Create a second DataTable identical to the first.
    DataTable table2 = table1.Clone();

    // Add column to the second column, so that the 
    // schemas no longer match.
    table2.Columns.Add("newColumn", typeof(System.String));

    // Add three rows. Note that the id column can't be the 
    // same as existing rows in the original table.
    row = table2.NewRow();
    row["id"] = 14;
    row["item"] = 774;
    row["newColumn"] = "new column 1";
    table2.Rows.Add(row);

    row = table2.NewRow();
    row["id"] = 12;
    row["item"] = 555;
    row["newColumn"] = "new column 2";
    table2.Rows.Add(row);

    row = table2.NewRow();
    row["id"] = 13;
    row["item"] = 665;
    row["newColumn"] = "new column 3";
    table2.Rows.Add(row);

    // Merge table2 into the table1.
    Console.WriteLine("Merging");
    table1.Merge(table2, false, MissingSchemaAction.Add);
    PrintValues(table1, "Merged With table1, schema added");

}

private static void Row_Changed(object sender, 
    DataRowChangeEventArgs e)
{
    Console.WriteLine("Row changed {0}\t{1}", e.Action, 
        e.Row.ItemArray[0]);
}

private static void PrintValues(DataTable table, string label)
{
    // Display the values in the supplied DataTable:
    Console.WriteLine(label);
    foreach (DataRow row in table.Rows)
    {
        foreach (DataColumn col in table.Columns)
        {
            Console.Write("\t " + row[col].ToString());
        }
        Console.WriteLine();
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T12:02:25.073

你可以试试这个：

```
public static DataTable Union (DataTable First, DataTable Second)
{

      //Result table
      DataTable table = new DataTable("Union");

      //Build new columns
      DataColumn[] newcolumns = new DataColumn[First.Columns.Count];

      for(int i=0; i < First.Columns.Count; i++)
      {
          newcolumns[i] = new DataColumn(
          First.Columns[i].ColumnName, First.Columns[i].DataType);
      }

      table.Columns.AddRange(newcolumns);
      table.BeginLoadData();

      foreach(DataRow row in First.Rows)
      {
           table.LoadDataRow(row.ItemArray,true);
      }

      foreach(DataRow row in Second.Rows)
      {
          table.LoadDataRow(row.ItemArray,true);
      }

      table.EndLoadData();
      return table;
} 
```

从[这里](http://weblogs.sqlteam.com/davidm/archive/2004/01/15/724.aspx)（未测试）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T12:02:31.467

您可以使用来自 Linq 的 Concat 到数据集（获取 LINQ in Action 的免费章节）来加入它们，然后使用 .AsDataTable 创建表（假设您实际上希望它们作为 DataTable）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-16T17:19:24.497

偶然发现了这个问题，Ruben Bartelink 给出了一个很好的答案，但没有代码。所以我不得不在其他地方查找它，这违背了 StackOverflow 的观点。现在是 2010 年，给出的其他答案不太可行。作为参考，这里是演示 CopyToDataTable() 扩展方法的代码。如果他想重温过去并发布更完整的答案，它就在 VB 中，以免从鲁本那里窃取信用:)

```
Public Function GetSchema(ByVal dbNames As IEnumerable(Of String)) As DataTable
   Dim schemaTables As New List(Of DataTable)()
   For Each dbName As String In dbNames
      Dim cnnStr = GetConnectionString(dbName)
      Dim cnn As New SqlConnection(cnnStr)
      cnn.Open()
      Dim dt = cnn.GetSchema("Columns")
      cnn.Close()
      schemaTables.Add(dt)
   Next

   Dim dtResult As DataTable = Nothing
   For Each dt As DataTable In schemaTables
      If dtResult Is Nothing Then
         dtResult = dt
      Else
         dt.AsEnumerable().CopyToDataTable(dtResult, LoadOption.PreserveChanges)
      End If
   Next

   Return dtResult
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-18T08:46:02.123

尝试使用 Linq to DataSet，必须添加 System.Data.DataSetExtensions.dll 的引用，另一种方法，DataTable.Merge 方法的替代方法）。

```
static void Main(string[] args)
{
    DoUnion();
}

private static void DoUnion()
{
    DataTable table1 = GetProducts();
    DataTable table2 = NewProducts();
    var tbUnion = table1.AsEnumerable()
        .Union(table2.AsEnumerable());
    DataTable unionTable = table1.Clone();
    foreach (DataRow fruit in tbUnion)
    {
        var fruitValue = fruit.Field<string>(0);
        Console.WriteLine("{0}->{1}", fruit.Table, fruitValue);
        DataRow row = unionTable.NewRow();
        row.SetField<string>(0, fruitValue);
        unionTable.Rows.Add(row);
    }
}

private static DataTable NewProducts()
{
    DataTable table = new DataTable("CitricusTable");
    DataColumn col = new DataColumn("product", typeof(string));
    table.Columns.Add(col);
    string[] citricusFruits = { "Orange", "Grapefruit", "Lemon", "Lime", "Tangerine" };
    foreach (string fruit in citricusFruits)
    {
        DataRow row = table.NewRow();
        row.SetField<string>(col, fruit);
        table.Rows.Add(row);
    }
    return table;
}

private static DataTable GetProducts()
{
    DataTable table = new DataTable("MultipleFruitsTable");
    DataColumn col = new DataColumn("product", typeof(string));
    table.Columns.Add(col);
    string[] multipleFruits = { "Breadfruit", "Custardfruit", "Jackfruit", "Osage-orange", "Pineapple" };
    foreach (string fruit in multipleFruits)
    {
        DataRow row = table.NewRow();
        row.SetField<string>(col, fruit);
        table.Rows.Add(row);
    }
    return table;
} 
```

安东尼奥

# c++ - 如何使用 C/C++ 可视化字节

> ID：920511
> 
> 赞同：11
> 
> 时间：2009-05-28T11:58:45.877
> 
> 标签：c++, c

我正在通过一些 C++ 培训。到目前为止一切顺利，但我需要一些帮助来加强我正在学习的一些概念。我的问题是如何可视化我创建的对象的字节模式。例如，我将如何打印出结构、长整数、整数等的字节模式？

我在脑海中理解它并且可以理解我的学习材料中的图表，我只是希望能够在我的一些学习程序中以编程方式显示字节模式。

我意识到这是非常微不足道的，但任何答案都会极大地帮助我锤炼这些概念。

谢谢。

编辑：我主要将 XCode 用于我的其他开发项目，但有用于 Windows7 和 Fedora 核心的 VM。在工作中，我将 XP 与 Visual Studio 2005 一起使用。（我无法发表评论，因为我在这里仍然是 n00b :D）

我使用了 unwind 的解决方案，这与我正在寻找的东西有关。我也在想，也许我可以只使用 dos DEBUG 命令，因为我也想查看内存块。同样，这只是为了帮助我加强我正在学习的内容。再次感谢人们！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-28T12:05:09.153

您可以使用这样的函数来打印字节：

```
static void print_bytes(const void *object, size_t size)
{
#ifdef __cplusplus
  const unsigned char * const bytes = static_cast<const unsigned char *>(object);
#else // __cplusplus
  const unsigned char * const bytes = object;
#endif // __cplusplus

  size_t i;

  printf("[ ");
  for(i = 0; i < size; i++)
  {
    printf("%02x ", bytes[i]);
  }
  printf("]\n");
} 
```

用法如下所示，例如：

```
int x = 37;
float y = 3.14;

print_bytes(&x, sizeof x);
print_bytes(&y, sizeof y); 
```

这将字节显示为原始数值，以十六进制表示，通常用于此类“内存转储”。

在运行“Intel(R) Xeon(R)”CPU 的随机（甚至可能是虚拟的）Linux 机器上，打印：

```
[ 25 00 00 00 ]
[c3 f5 48 40]

```

这也方便地证明了 Intel 系列 CPU:s 确实是[little endian](http://en.wikipedia.org/wiki/Endianness)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T12:34:54.757

如果您使用 gcc 和 X，您可以使用[DDD 调试器](http://www.gnu.org/software/ddd/)为您绘制漂亮的数据结构图片。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-17T15:10:57.290

为了完整起见，一个 C++ 示例：

```
#include <iostream>

template <typename T>
void print_bytes(const T& input, std::ostream& os = std::cout)
{
  const unsigned char* p = reinterpret_cast<const unsigned char*>(&input);
  os << std::hex << std::showbase;
  os << "[";
  for (unsigned int i=0; i<sizeof(T); ++i)
    os << static_cast<int>(*(p++)) << " ";
  os << "]" << std::endl;;
}

int main()
{
  int i = 12345678;
  print_bytes(i);
  float x = 3.14f;
  print_bytes(x);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T13:35:17.817

或者，如果你有 boost lib 并想使用 lambda 评估，你可以这样做......

```
template<class T>
void bytePattern( const T& object )
{
    typedef unsigned char byte_type;
    typedef const byte_type* iterator;

    std::cout << "Object type:" << typeid( T ).name() << std::hex;
    std::for_each( 
        reinterpret_cast<iterator>(&object), 
        reinterpret_cast<iterator>(&object) + sizeof(T), 
        std::cout << constant(' ') << ll_static_cast<int>(_1 )&&0xFF );   
    std::cout << "\n";
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T14:31:56.330

大多数（可视）调试器都有“查看内存”选项。Xcode 中的 IIRC 非常基本，仅以 HEX 和 ASCII 显示字节，行长可变。Visual Studio（Vs2008 中的 Debug->Windows->Memory）可以将十六进制部分格式化为不同的整数长度或浮点数，更改字节顺序，并显示 ANSI 或 UNICODE 文本。您还可以为窗口的宽度设置几乎任何数字（我认为 xcode 只允许您转到 64 字节宽) 我在这里工作的另一个 IDE 有很多选择，虽然没有 VS 那么多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-03T15:18:06.770

一点一点的控制台程序我掀起了，希望它可以帮助别人

```
#include <iostream>
#include <inttypes.h>
#include <vector>
using namespace std;
typedef  vector<uint8_t> ByteVector;
///////////////////////////////////////////////////////////////
uint8_t Flags[8] = { 0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
void print_bytes(ByteVector Bv){
    for (unsigned i = 0; i < Bv.size(); i++){
        printf("Byte %d [ ",i);
        for (int j  = 0;j < 8;++j){
            Bv[i] & Flags[j] ? printf("1") : printf("0");
        }
        printf("]\n");
    }
}
int main(){
    ByteVector Bv;
    for (int i = 0; i < 4; ++i) { Bv.push_back(i); }
    print_bytes(Bv);
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-28T12:05:48.437

试试这个：

```
MyClass* myObj = new MyClass();
int size=sizeof(*myObj);
int i;
char* ptr = obj; // closest approximation to byte
for( i=0; i<size; i++ )
    std::cout << *ptr << endl; 
```

干杯，

jrh

# wpf - 将 ImageSource 转换为 BitmapImage - WPF

> ID：920517
> 
> 赞同：15
> 
> 时间：2009-05-28T12:00:48.820
> 
> 标签：wpf, bitmapimage

我正在使用一个生成大型 ImageSource 的类库，> 3000x3750 像素。我想将此 ImageSource 转换为 BitmapImage 以便我可以利用 DecodePixelWidth 或 DecodePixelHeight 而不是每次生成此图像时都调整它的大小。

我需要首先为用户显示此图像，并且大多数用户的屏幕分辨率为 1024x768，为此我将此 ImageSource 绑定到 Image 控件，但可以注意到它有多么“沉重”。

我怎样才能做到这一点？或者这种情况的最佳解决方案是什么？

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-20T08:33:01.420

我知道这是一个旧帖子，但尝试这样做：

```
myBitmapImage = myImageSource as BitmapImage; 
```

效果很好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T12:09:25.837

[`BitmapImage`](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.aspx)类型继承[`BitmapSource`](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapsource.aspx)并最终（两者[`ImageSource`](http://msdn.microsoft.com/en-us/library/system.windows.media.imagesource.aspx)都是抽象类）。您需要检查对象的实际类型是什么，即检查`object.GetType().Name`. 如果幸运的话，它实际上可能会返回一个`BitmapSource`对象，您只需将其转换为该类型，然后就可以使用它。

# macos - 我需要 AIR 应用程序的 Mac 屏幕截图

> ID：920527
> 
> 赞同：1
> 
> 时间：2009-05-28T12:02:56.040
> 
> 标签：macos, air

好心的 mac 用户可以花点时间为我的第一个 adobe air 应用程序截屏并发布吗？这是链接[http://www.webdigi.co.uk/blog/apps/dreamhost-controller-using-api/](http://www.webdigi.co.uk/blog/apps/dreamhost-controller-using-api/)。我没有在 Mac 上测试过我的应用程序，但 Adob​​e 说它应该可以工作！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T13:32:24.860

干得好

[1](https://imgur.com/5jv7h.png) [2](https://imgur.com/icWYL.png) [3](https://imgur.com/SWk2G.png) [4](https://imgur.com/q4fnJ.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T12:13:21.103

我不确定这是否是一个编程问题，但在这里：

我相信您可以使用此站点获取所需的屏幕截图。

[http://browsershots.org/](http://browsershots.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T12:24:59.053

我相信这不是病毒……但它适用于 OS X 10.5.7。如果你想要一个看起来像 OSX 的屏幕截图，那么有很多 Ubuntu 主题看起来与 Aqua 完全一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:39:44.813

我会去 Freenode (irc.freenode.org) 上的 MacOSX 频道 (##macosx) 询问它。

# sharepoint - 在 SharePoint 2007 中，如何在列表中包含一些常见项目，并为列表的每个实例包含一些唯一项目？

> ID：920530
> 
> 赞同：0
> 
> 时间：2009-05-28T12:04:12.230
> 
> 标签：sharepoint, moss, sharepoint-2007

我在 SharePoint 2007 中创建了一系列会议。所有会议都有一个共同的“基本”议程，但每个会议都有自己独特的议程项目。

有没有办法在 SharePoint 中实现它？如果我将议程项目设置为“系列项目”，我将无法为个别会议偏离该列表。那就是问题所在

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:22:32.677

是的，使用包含多种内容类型的列表。您可以在站点级别定义自定义内容类型，它们将在该站点和所有子站点中可用。您可以在列表或库上启用内容类型，并为该列表或库包含多种内容类型。您还可以在多个列表和库中拥有内容类型。

内容类型也可以相互继承。因此，您可以拥有一个“基本议程”内容类型，并让其他内容类型继承自该内容类型。内容类型不仅限于元数据，还处理行为。您可以将工作流分配给内容类型，并且在 MOSS 中您可以将策略（例如，过期策略）分配给内容类型。

[http://msdn.microsoft.com/en-us/library/ms472236.aspx](http://msdn.microsoft.com/en-us/library/ms472236.aspx)

# asp.net - 如何从会员提供者获取用户/个人资料列表？

> ID：920533
> 
> 赞同：4
> 
> 时间：2009-05-28T12:04:47.003
> 
> 标签：asp.net, asp.net-membership

我正在使用此会员资格提供商。我一直在获取用户列表 + 个人资料（名字、姓氏、头衔等）

我知道有一个 Membership.GetAllUsers() 方法，但我不知道如何将它与存储在 Profile Provider 中的 FirstName、LastName 结合起来。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T15:36:57.277

Membership.GetAllUsers() 返回一个 MembershipUserCollection，您可以使用它来访问单个 MembershipUser。例子：

```
MembershipUserCollection users = Membership.GetAllUsers();
string email = users["some_username"].Email; 
```

您还可以通过类似的方式检索 ProfileInfo：

```
ProfileInfoCollection profiles = ProfileManager.GetAllProfiles(ProfileAuthenticationOption.All);
DateTime lastActivity = profiles["some_username"].LastActivityDate; 
```

但是，默认情况下没有 FirstName 和 LastName 属性，除非您在配置文件提供程序中手动指定它们。

查看[MembershipUser 类](http://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx)和[ProfileInfo 类](http://msdn.microsoft.com/en-us/library/system.web.profile.profileinfo.aspx)以获取更多详细信息。您可能还想查看[SqlProfileProvider 类](http://msdn.microsoft.com/en-us/library/system.web.profile.sqlprofileprovider.aspx)作为配置文件提供程序的示例，除非您已经实现了一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T12:50:41.527

首先，当您创建用户时，使用相同的用户名创建配置文件：

```
// Create an empty Profile for the new User
ProfileCommon p = (ProfileCommon) ProfileCommon.Create("username", true); 
```

然后下次找回来。。

```
// Retrieve a particular profile
ProfileCommon userProfile = Profile.GetProfile("username"); 
```

谢谢。

# git - 无法更改 Git 在 Mac 中的加载位置

> ID：920535
> 
> 赞同：1
> 
> 时间：2009-05-28T12:05:40.353
> 
> 标签：git, macos, path, startup

我在 /opt/local/bin/git 有 MacPorts 的 Git，而在 /opt/local/git 有最新的 Git。

**我的路径命令**

```
export PATH=/usr/local/git:/opt/local/bin:/opt/local/sbin:/Users/Masi/.cabal/bin:/Users/Masi/.cabal/bin/xmonad:$PATH 
```

命令

```
echo $PATH 
```

给我

```
/usr/local/git:/opt/local/bin:/opt/local/sbin:Users/Masi/.cabal/bin:/Users/Sam/.cabal/bin/xmonad:/sw/bin:/sw/sbin:$PATH:/opt/local/bin:/usr/local/bin:/usr/bin:/bin:/sbin:/usr/bin/perl::/usr/X11R6/bin 
```

我运行以下命令并获取 MacPorts 的 Git

```
which git
/opt/local/bin/git 
```

亚伦 说

> 添加 /opt/local/git 作为路径中的第一个元素，然后添加 /opt/local/bin/。这样，首先会找到您的 git，然后 `/opt/local/bin/ 中的所有其他内容也将可用。

尽管我首先在我的 PATH 中拥有了最新的 Git，但我没有运行它。

**如何将 Git 更改为从第二个 PATH 加载？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T12:21:42.897

您不应该将二进制文件放入`/opt/local`. 除非有特殊原因需要旧版本的 git，否则不应安装两个副本。保留`/opt`macports 的层次结构。如果您想自己构建软件包，请将其安装到`/usr/local`. 这会将`git`二进制文件放入`/usr/local/bin`. $PATH中的`/usr/local/bin`和`/opt/local/bin`中的第一个，该目录中的文件将优先。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T12:20:34.460

两种解决方案：

1.  添加`/opt/local/git`为路径中的第一个元素，然后`/opt/local/bin/`. 这样，首先会找到您的 git，并且 /opt/local/bin/ 中的所有其他内容也将可用。

2.  `bin/`在某处创建一个新目录，`ln -s`为您需要的所有程序创建软链接 ()，然后将其`bin/`作为您路径中的第一件事。

# c# - 我的 .net 应用程序在本地计算机上工作，但在从网络位置使用时失败

> ID：920542
> 
> 赞同：3
> 
> 时间：2009-05-28T12:10:20.033
> 
> 标签：c#, .net, security

我有一个 C# 应用程序需要列出一个目录 ( Directory.GetFiles() ) 并访问返回的文件之一。如果我在本地运行应用程序，则访问网络位置或本地位置没有问题，如果我从网络共享运行它，则在访问共享时会引发安全异常。

我发现了为什么会这样：http: [//blogs.msdn.com/shawnfa/archive/2003/06/20/57023.aspx](http://blogs.msdn.com/shawnfa/archive/2003/06/20/57023.aspx)

然而，解决方案似乎......不切实际，除非我误解了它。

1) 我不能使用代码（几乎没有选择） 2) 签署程序集，然后让要使用它的人配置 .NET 策略以允许它？（这取决于将要使用它来更改他们的一项政策的人，我对此没有发言权？？） 3）更改政策以允许对 localintranet 上的所有内容完全信任（在我的情况下不推荐甚至可能）

我是否在这里遗漏了什么，对于将独立应用程序推送到我没有发言权的网络上，这些选择似乎都不是最佳选择。我本以为做一些相对简单的事情，例如从网络共享运行应用程序以列出文件目录不需要如此疯狂的箍来使其工作。

有人对我在这种情况下可以做什么有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T12:15:31.660

这些线程会回答你的问题，我认为：

*   [为什么我的 .NET 应用程序从网络驱动器运行时会崩溃？](https://stackoverflow.com/questions/148879/why-does-my-net-application-crash-when-run-from-a-network-drive)
*   [运行 C# exe 文件](https://stackoverflow.com/questions/804132/running-a-c-exe-file/)

此行为在 .NET Framework 3.5 SP1 中有所更改，默认情况下允许程序在网络共享之外运行。

是的，它感觉不是很实用，但不幸的是没有太多可做的......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T12:18:37.753

我会将其部署为 ClickOnce 应用程序（VS2008 中的“发布”等）。ClickOnce 可以位于网络共享上 - 您只需运行 .application 而不是 .exe；这样就可以解决直接运行它的任何安全问题，并且可以一直运行到 .NET 2.0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T12:18:54.273

当您要求您的用户升级到 .NET Framework 3.5 SP1 时，此问题应该不再存在。请参阅以下有关该主题的博客文章：

> [**.NET Framework 3.5 SP1 允许从网络共享启动托管代码！**](http://blogs.msdn.com/brada/archive/2008/08/13/net-framework-3-5-sp1-allows-managed-code-to-be-launched-from-a-network-share.aspx)

# regex - 用正则表达式替换查询字符串中的单词

> ID：920548
> 
> 赞同：2
> 
> 时间：2009-05-28T12:12:59.653
> 
> 标签：regex, asp-classic

字符串 = "Reg.asp?q=RG_Price=5000*8000,Activated=1"

我想用“Price BETWEEN 5000 AND 8000”替换“RG_Price=5000*8000”。

这可能与 ASP 中的正则表达式有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T12:38:30.507

当然（现在使用 VBScript 而不是 C#）：

```
Dim queryString, replacedString
Set regEx = New RegExp
regEx.Pattern = ".+RG_Price=(\d+)\*(\d+).*"

replacedString = regEx.Replace(queryString, "Price BETWEEN $1 AND $2") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T11:42:51.027

我会使用这个正则表达式：

```
^[^?]*\?(?:[^&]*&)*q=RG_Price=(\d+)\*(\d+) 
```

并将匹配替换为`"Price BETWEEN $1 AND $2"`.

但是我不知道 ASP.NET，所以我不能给你一个可行的例子。

# c# - 从 .Net 逐帧创建视频

> ID：920554
> 
> 赞同：1
> 
> 时间：2009-05-28T12:14:31.913
> 
> 标签：c#, .net, video

我有一个使用 GDI+ 和/或 XNA 渲染图形的 .Net 应用程序，我想将帧直接录制到视频中（最好是 AVI，我可以在其中包含 xvid 等编解码器）。我已经尝试了许多解决方案，但都遇到了阻碍。

所有基于 FFMPeg 的库似乎都致力于对现有流进行转码，而不是从帧中生成新流。

在 codeplex 上有一个名为 Splicer 的 .Net 库，但据我所知，它更适合构建“幻灯片”，因为它需要每一帧并将其存储在 HD 上。directshow 解决方案的行为方式相同。

然后是 AVIFile 包装器，这几乎正是我所需要的。唯一的问题是，当你开始一个新的编码时，它会弹出（有时是 UNDER！？）一个对话框。该对话框对于正常使用来说不是问题，但我还需要它作为服务运行，因此强制 UI 显然是一个显示停止器。

任何人都知道相对.Net友好的另一种选择，还是我要求太多？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T12:56:57.410

我不知道您使用的是哪个 AVIFile 包装器，但我相信 AviFile 可能正在调用 AVISaveOptions 来获取初始化的 AVICOMPRESSOPTIONS 结构。您可以自己初始化 AVICOMPRESSOPTIONS。AVICOMPRESSOPTIONS 中的大多数成员都很容易。lpParms 和 cbParms 包含一个二进制编解码器配置数据块（cbParms = 块长度）。您可以调用 ICGetState 获取此数据。

它应该是对您的本机 AVIFile 的一个相当简单的更改，并且您的包装器应该仍然可以工作。

查看此[示例](http://cgs.hpi.uni-potsdam.de/trac/vrs/browser/trunk/src/image/avimaker.cpp?rev=6115&format=txt)以了解如何初始化 AVICOMPRESSOPTIONS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:01:49.383

如果您想在 XNA 中执行此操作，请查看XNA 论坛上的[此问题以获得一些见解和注意事项。](http://forums.xna.com/forums/p/29668/166902.aspx)特别是 ZMan 的回答：

> “在 XNA 中没有什么可以帮助您 - 您需要查看其他 Windows API。您将使用 XNA 捕获后台缓冲区，然后将每个帧保存出来，但有很多事情需要关注。从后面拉出每一帧缓冲区会立即产生一些延迟，压缩图像（如果您选择即时压缩）会占用大量 CPU，保存到文件会增加延迟。
> 
> DirectShow 是一种可用于进行压缩的 API - 还有很多其他 API。Off/MP4 等声音录制有DSound，我认为DShow 也可以使用DSound 来抓取音频输出。它们是相当专业的 API，因此您可能想寻找其他论坛。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-15T21:12:11.760

实际上，Splicer 可以从多个静止帧中生成流畅的视频，您只需要确保在调用 ITrack.AddFrame 时设置了适当的剪辑偏移和剪辑结束参数即可。在我的程序中，我使用：

```
videoTrack.AddImage(buffer, 0, 1f / FramesPerSecond); 
```

`videoTrack`来自哪里：

```
timeline = new DefaultTimeline(framesPerSecond);
videoGroup = timeline.AddVideoGroup("main", framesPerSecond, 24, width, height);
videoTrack = videoGroup.AddTrack(); 
```

在我正在处理的模拟程序的视频导出器的构造函数中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-15T21:54:11.317

如果您仍想使用 ffmpeg，则将帧写入磁盘并使用类似

ffmpeg -f image2 -i foo-%03d.jpeg -r 12 -s WxH foo.avi

语法 foo-%03d.jpeg 指定使用由用零填充的三位数字组成的十进制数来表示序列号。它与 C printf 函数支持的语法相同，但仅适用于接受普通整数的格式。

-r 12 指定每秒 12 帧

-s WxH 应该指定宽度和高度

这是来自[ffmpeg 文档](http://ffmpeg.org/ffmpeg-doc.html#SEC5)。

# c# - 使用 ADO.NET 读取内存中的 Excel 文件（字节数组）？

> ID：920556
> 
> 赞同：5
> 
> 时间：2009-05-28T12:14:55.017
> 
> 标签：c#, excel, ado.net, connection-string

我想使用 ADO.net 从 Excel 文件中提取一些数据。这个过程在互联网上有很好的记录。我的问题是我的文件已由用户上传，因此仅作为字节数组存在于内存中。出于安全和性能原因，我宁愿不将此文件写入磁盘。

有没有办法构造一个连接到字节数组的连接字符串？或者也许将该数组公开为实际存储在内存中的文件（我猜像 RAM 磁盘）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T12:33:33.433

如果它只存在于内存中，则无法连接。OLE 也被排除在外（尽管一开始就将 Office 自动化用于服务器应用程序的设计很糟糕）。

我能想到的唯一方法是自己读取二进制 Excel 数据 - 例如使用 SpreadSheetGear.Net 与类似的东西：

```
SpreadsheetGear.Factory.GetWorkbookSet().Workbooks.OpenFromStream(*stream*); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T12:28:46.547

就像 Rich B 在他的回答中所说的那样，我认为不可能以标准的 ado.net 方式连接到仅在内存中徘徊的 excel 文件。最简单的解决方法可能是将 excel 文件实际保存到磁盘，使用 Jet 引擎与您的连接字符串连接到它，然后当您完成执行所有任务时，删除该文件。就性能而言，这可能不是理想的，但它缺乏一定的 WTFiness 会导致你把头发拉出来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T12:23:15.623

我认为仅通过连接字符串不可能做到这一点。

如果您需要有关磁盘上 Excel 文件的帮助：[http ://connectionstrings.com/excel-2007](http://connectionstrings.com/excel-2007)

一般来说：[http ://connectionstrings.com/](http://connectionstrings.com/)

# delphi - Delphi：如何组织源代码以提高编译器性能？

> ID：920560
> 
> 赞同：32
> 
> 时间：2009-05-28T12:17:08.817
> 
> 标签：delphi, optimization, compiler-construction

我正在开发一个有很多依赖项的大型 delphi 6 项目。编译整个项目需要几分钟。一些更改后的重新编译有时会更长，因此可以更快地终止 Delphi，擦除所有 dcu 文件并重新编译所有内容。

有谁知道一种识别方法，是什么让编译器越来越慢？任何提示如何组织代码以提高编译器性能？

我已经尝试过以下事情：

*   明确包括 dpr 中的大多数单元，而不是依赖搜索路径：它没有任何改进。
*   使用命令行编译器 dcc32：它并不快。
*   试着看看编译器做了什么（使用 SysInternals 的 ProcessExplorer）：显然它大部分时间都运行一个名为“KibitzGetOverloads”的函数。但我对这些信息无能为力...

**编辑，到目前为止的答案摘要：**

对我来说效果最好的答案：

*   [cnpack](http://www.cnpack.org/index.php?lang=en)中的“清理未使用的单元引用”功能。它几乎自动清理了 1000 多个引用，使“冷”编译快了两倍。（“冷”编译 = 在编译前擦除所有 dcu 文件）。*它从编译器获取参考列表。所以如果你有一些 {$IFDEF } 检查你的所有配置是否仍然编译。*

接下来我想尝试：

*   手动重构单元引用（最终使用抽象类）但工作量更大，因为我首先需要确定问题出在哪里。一些可能有帮助的工具：
    *   [GExperts](http://www.gexperts.org/)在delphi IDE中添加了项目依赖浏览器（可惜不能显示每个分支的大小）
    *   [Delphi Unit Dependency Viewer V1.0](http://cc.embarcadero.com/Item/19441)做同样的事情，但没有 Delphi。它可以计算一些简单的统计数据（哪些单位被引用最多，...）
    *   答案之一的[链接](http://blog.fredrikhaglund.se/blog/2006/07/03/optimized-pascal-compilation-time/)中引用了[伊卡洛斯。](http://www.peganza.com/products.htm)

在我的情况下没有改变任何事情的事情：

*   将我的程序中的每个文件和所有组件放在一个文件夹中，没有子文件夹。
*   对磁盘进行碎片整理（我尝试使用 ramdisk）
*   对代码源和输出文件夹使用 ramdisk。
*   关闭实时扫描防病毒软件
*   列出 dpr 文件中的所有单元，而不是依赖搜索路径。
*   使用命令行编译器 dcc32 或 ecc32。

不适用于我的情况的事情：

*   避免依赖网络共享。
*   使用[DelphiSpeedUp](http://andy.jgknet.de/blog/?page%5Fid=8)，因为我已经有了它。
*   对所有 dcu 使用单个文件夹（我总是这样做）

我没有尝试的事情：

*   升级到另一个 Delphi 版本。
*   使用 dcc32speed.exe
*   使用固态驱动器（我没有尝试过，但我尝试使用 ramdisk 放置所有源代码。但也许我也应该在 ramdisk 上安装 delphi）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T12:21:30.633

一些可能会降低编译器速度的事情

*   **您的`uses`子句中的**冗余单位。**请参阅[此问题](https://stackoverflow.com/questions/881778/how-can-i-identify-and-get-rid-of-unused-units-in-the-uses-clause-in-delphi-7)以获取`CnPack`.**
***   没有明确地将单位添加到您的项目文件中。你似乎已经涵盖了这一点。*   更改了编译器设置，最明显的是`include TDD32 info`.**

 **尝试在你的 uses 子句中去掉未使用的单位，看看它是否有所作为。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-28T17:12:30.703

使用 Delphi 7 和 2009，上周我从将近 2 分钟的编译时间和另外 45 秒的时间从按下 f9 并获得我的应用程序的主要形式到 20 秒的编译和运行时间。这件事让我发疯了大约 6 个月，但我尝试的任何方法似乎都不起作用。使用来自 SysInternals 的 filemon，我意识到编译器需要的每个单元（主要是组件）都在搜索路径中的每个文件夹中进行了搜索，是的，这会产生很多 FileOpen、FileExists 和 FileNotFound 等。我所做的是，把每个来自组件的 DCU、DFM、RES 等都在一个文件夹中，并且在搜索路径中只有这个文件夹，以及项目所需的其他几个文件夹；结果是惊人的。修复之前的其他问题是调试。调试时每次F7、F8键大约需要40秒，这个也已经修复了。希望这些信息可以帮助你。来自委内瑞拉玛格丽塔岛的问候。如果有任何错误，请原谅我的英语；）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-28T12:23:05.157

检查搜索路径中是否有任何不在本地计算机上的路径。

即不要链接到网络共享上的二进制文件，并检查搜索路径是否没有检查任何网络共享。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-28T12:34:07.223

我没有看到编译器随着时间的推移而变慢，但是自从我们使用 Delphi 6 以来已经有很长时间了。

1.  Delphi 社区似乎普遍认为，如果您不想升级到最新最好的（Delphi 2007 或 2009），那么 Delphi 7 是最好/最快/最稳定的。你可以考虑升级。
2.  KibitzGetOverloads 听起来像是来自 kibitz 编译器的东西——“后台”编译器为您提供代码完成、后台错误突出显示、代码工具提示等。听起来您最好检查命令行编译器的调用堆栈，不是IDE；你会得到一些更有帮助的东西。
3.  删除 DCU 后，我从未发现编译速度更快。DCU 可以使构建增量，因此更快。如果您在删除所有 DCU 后看到更快的编译，请检查您的硬件。你最近对硬盘进行碎片整理了吗？驱动器上有多少可用空间？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-28T19:39:15.447

1.  您是否设置了一个文件夹来获取 DCU。如果没有，它们将分散在各处。
2.  将所有单元及其隐式调用的单元（从库路径安装的组件除外）放入 dpr。为了确保你没有错过一些，清空你的搜索路径，它仍然应该编译。
3.  减少搜索路径后，您可以尝试通过将组件安装到更少的文件夹中来减少库路径。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-28T13:25:38.743

尽管仅与您的确切问题部分相关，但我听说固态驱动器的使用大大增加了 Delphi 的编译时间 - Nick Hodges 自己在几周前的 Delphi Podcast 上说。布赖恩

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-28T21:29:57.393

*   [U 可以自动摆脱不必要的单元引用，这对编译速度是非常有效的优化。](http://blog.fredrikhaglund.se/blog/2006/07/03/optimized-pascal-compilation-time/)

*   在您的情况下，将项目分成包可以提高编译速度。通过这种方式，它只生成修改过的包，而不是为每次重新编译生成单个海量二进制文件。使用包还有助于轻松部署项目更新。

*   关闭实时扫描防病毒软件

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-29T11:31:30.627

我们有相同（或相似）的问题。我们包的我有编译时间大约 12 分钟。更改后，现在我们已移至 32 sg。

经过多次测试，我们发现“问题情况”如下： 在单个包中：

*   **A 单元**在同一封装中使用大量单元：U1、U2、U3、U4、... U100（接口使用）。这是集中所有初始化工作的重要单元。

*   封装的所有单元，U1、U2、U3、..、U100 使用**单元 A**（使用实现）

这种“循环引用”并没有因为用途不同而产生编译错误，而是造成了很大的编译时间。

**解决方案：消除对A 单元**中每个单元 U1、U2、U3 ......、U100 的引用。

现在，**A 单元**使用了大量的单元：U1、U2 、....、U100，但是单元 U1、U2 、...、U100，不使用单元 A。

在此更改之后，编译时间急剧下降。

如果你有类似的情况，你可以试试这个。

原谅我的英语不好。

问候。

* * *

Neftalí -Germán Estévez-

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-30T10:49:27.180

我有同样的问题，我可以想出（2）它影响我的原因。

1.  循环引用。这位先生说一个是正确的。我会有某些编译速度快的大型项目，以及编译速度慢的小型项目。直到我重组代码然后我获得了更快的编译速度才弄清楚。很多小单位。构建整体单元很容易。但是，它有很多惩罚。

2.  我已经听过 1000 次了，在您的用户可能正在使用的慢速机器上开发。嘿，那是给测试部门的。我不能在编译、Delphi 加载速度、软件包等方面浪费时间。我出去买了一台带有固态驱动器（如前所述）、12GB RAM、超频“i7”英特尔芯片的“GAMERS”计算机（WOW） ，三块视频卡（链接），全部在 Vista64 上（一旦它最终与所有已安装的部件一起运行，Vista 还不错）。把它全部设置好真的很痛苦。但是，我不再在我的电脑上等待。纯粹的编译速度、加载速度，加上一台全新的机器，没有过去 2 年安装在最后一台机器上的所有废话。我什至卸载了 DelphiSpeedUp。不需要它。而且我不需要关闭防病毒软件，因为我也这样做了，并受到互联网垃圾的惩罚。所以防病毒软件会继续运行。纯粹和简单，得到一个 BALLS OUT 机器。你的时间比你花在一台新电脑上的时间更有价值。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-28T20:17:24.760

尝试安装一个 ram 磁盘并将您的 dcu 输出路径设置为指向那里。这使我在 DelphiSpeedUp 之上使用 Delphi 2007 的编译时间减少了一半以上。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-29T10:14:14.060

编译器只会编译已更改的单元。如果您更改了接口部分中的代码，所有依赖于更改单元的单元都会被编译。如果仅更改了实现部分中的代码，则编译将只更改该单元，但可能会链接所有模块。意味着预先设计好的接口，但如果您重组代码以限制对实现的更改，编译时间可能会减少。我不知道多少。这一事实在 Delphi 7“使用 Delphi”中的 Multiple and indirect unit references 下的 Delphi 帮助文件中有所提及。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-31T16:49:16.700

*   不要在网络驱动器上编译。寻道时间明显更糟。
*   考虑将您的 dcu（“单元输出”目录）指向 ramdrive。
*   限制包含/单元目录的数量。
*   尽量避免编译器仍然接受的次要循环引用，特别是对于大型单元（例如，为您的 OPF 生成的 ORM 单元）。它可能会导致大型单元被编译两次。（Delphi 是否允许较小的相互循环，或者这是 FPC 唯一的功能？）

我从未尝试过，但是在中央 .dpr 中对所有具有完整/相对路径的文件进行硬编码也可能会有所帮助（重新生成/更新的脚本？）。（您在上面提到过，但它是否使用 '\path\yyy' 表示法中的路径 xx？）。

其他长镜头：

*   使用 Kylix（根据我的经验，Linux 下的文件/目录 I/O 明显更好（尽管这是来自 FPC 的经验））。也许我们需要一个反向的交叉 kylix :-)
*   使用单独的（Windows）构建机器，并通过注册表调整 NTFS 以降低“安全性”。（你不关心，因为一切都是一个修订系统开始）。Afaik 这些选项只能对所有文件系统全局执行，因此是单独的系统。也加入一个突袭阵列或猛禽。
*   忘记固态。不错的嗡嗡声atm，但是高写入率最终会杀死它（当它变得更满并且无法再进行最佳分配时，寿命和性能都会受到影响），并且您需要昂贵的英特尔才能在RAID中击败两个75美元的HD。

Ps 对不起 FPC 参考。我两者都做，有时我不知道什么属于什么。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-08-06T10:14:35.910

我所做的是始终确保库路径中的目录非常少，以及大多数组件和静态代码。我还确保库路径中没有可用的源代码，只有.dcu/.res 等。只有browsepath 有源代码，特殊情况通过项目的searchpath 处理。

只需限制在任何情况下编译的内容。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-11-23T16:55:07.487

几年后，我再次为编译时间的增加而苦苦挣扎。我目前正在使用 Delphi XE4，我正处于绝对需要重构单位引用的地步。我想到了一种新的方法来确定问题出在哪里：

我正在使用[Microsoft/SysInternals 的 Process Monitor](https://technet.microsoft.com/de-de/sysinternals/bb896645)来监视编译器：

1.  我使用过滤器启动进程监视器以​​仅显示 dcc32.exe（或从 IDE 工作时的 bds.exe）。
2.  我从命令行构建我的项目。
3.  最后，我查看了 Process Monitor 日志中的 CreateFile 操作。

对于每个单元，都有一个 .PAS 文件条目（当编译器开始处理该单元时）和一个 .DCU 文件条目（当编译器对该单元进行复杂处理时）。通过使用文本编辑器和/或 Excel 处理日志，我可以提取此类信息：

*   一种“树”，您可以在其中递归地查看单元的编译顺序。
*   对于每个单元，“.PAS 文件打开”和“.DCU 文件写入”之间的延迟。

然后我尝试解释结果以找到进行一些重构会加快编译时间的地方。这并不容易，但我得到了一些令人鼓舞的结果。

# .net - EnterpriseServicesInteropOption 用于 .NET 到 COM+ 调用

> ID：920568
> 
> 赞同：1
> 
> 时间：2009-05-28T12:19:45.240
> 
> 标签：.net, transactions, com+

我需要执行一些数据库更新，其中一部分将通过 COM+ 组件（将为事务启用），而其他通过标准 LINQ to SQL，我希望对一个事务的一部分进行更新。

我打算使用 TransactionScope 来允许 .NET 和 COM+ 事务同步。但是，在阅读了有关 EnterpriseServicesInteropOption 的文档后，我仍然不确定 Automatic 和 Full 之间的区别。

我可以在我的情况下使用自动吗？

我可以感觉到我可能会收到 RTFM 响应，但我发现这篇文章不清楚：http: [//msdn.microsoft.com/en-us/library/ms229974 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms229974(VS.80).aspx)

人们拥有的任何更清晰的资源也将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T14:22:48.533

不同之处在于**Full**将始终创建一个 COM+ 事务上下文，而**Automatic**将在需要时创建一个。
因此，在需要 COM+ Transac 的情况下，主要区别在于应用程序何时受到性能影响，在 Transac 开始时（使用 Full），或者在需要时（使用 Automatic）

如果您确定需要 COM+ 事务，请选择 Full，但是……不要相信我：
**测试！很多！！**

# asp.net-mvc - 使用 Ajax.BeginForm() 追加行 我有一个 HTML <TABLE> 显示表格行中的项目列表。要将新项目添加到项目列表中，我有一个表单，该表单使用 Ajax.BeginForm 通过 AJAX 将数据提交给我的控制器。控制器上的操作完成后，它会返回一个局部视图，其中包含要附加到我的表的新行的标记（例如，<TR><TD>.......</TD></TR>） . 我的问题是如何在现有表中添加新行？ 问问题 问问题 2009-05-28T12:20:35.240 3142 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我有一个 HTML <TABLE> 显示表格行中的项目列表。要将新项目添加到项目列表中，我有一个表单，该表单使用 Ajax.BeginForm 通过 AJAX 将数据提交给我的控制器。控制器上的操作完成后，它会返回一个局部视图，其中包含要附加到我的表的新行的标记（例如，<TR><TD>.......</TD></TR>） . 我的问题是如何在现有表中添加新行？ 我在顶部创建了一个 ID 为“userrightsgridheader”的标题，并指定了我的 Ajax.BeginForm，如下所示： <% using (Ajax.BeginForm( "CreateUserRight", new { workstationId = Model.Id }, new AjaxOptions { HttpMethod = "POST", InsertionMode = InsertionMode.InsertAfter, UpdateTargetId = "userrightsgridheader" } )) { %> 问题是这不起作用。有没有人对如何实现这一目标有任何想法？ 谢谢！ 您可以添加以下 AjaxOption，当 Ajax 功能成功执行时，它会执行“jsfunction”： new AjaxOptions { OnSuccess = "jsfunction" }; 您可以在 jsfunction 中添加 tablerow。 更新 你可以定义jsfunction如下： function jsfunction(ajaxContext) { //ajaxContext contains the responseText } AjaxContext 定义如下： AjaxContext ajaxContext = new AjaxContext(request, updateElement, loadingElement, ajaxOptions.InsertionMode); asp.net-mvcasp.net-ajax 4 1 回答 1 This answer is useful 2 您可以添加以下 AjaxOption，当 Ajax 功能成功执行时，它会执行“jsfunction”： new AjaxOptions { OnSuccess = "jsfunction" }; 您可以在 jsfunction 中添加 tablerow。 更新 你可以定义jsfunction如下： function jsfunction(ajaxContext) { //ajaxContext contains the responseText } AjaxContext 定义如下： AjaxContext ajaxContext = new AjaxContext(request, updateElement, loadingElement, ajaxOptions.InsertionMode); 于 2009-05-28T12:24:19.193 回答 Related 2 objective-c - 醒来后 NSDate 日期不返回当前日期和时间 1 sql - oracle 触发错误 ORA-01427 和错误 ORA-04091 1 iphone - Availability.h 类宏 1 c# - 相互干扰的两个 MDI 子窗体 2 c# - ViewBag 作为会话模型的持有者 1 java - 如何使用 JndiPropertySource？ 1 java - Netbeans 更新，项目不再打开索引页面 2 forms - 我可以在输入表单中有一个文件字段吗？ 2 iphone - iOS 游戏玩家 ID 1 java - Android CookieManager Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：920571
> 
> 赞同：0
> 
> 时间：
> 
> 标签：asp.net-mvc, asp.net-ajax

我有一个 HTML <TABLE> 显示表格行中的项目列表。要将新项目添加到项目列表中，我有一个表单，该表单使用 Ajax.BeginForm 通过 AJAX 将数据提交给我的控制器。控制器上的操作完成后，它会返回一个局部视图，其中包含要附加到我的表的新行的标记（例如，<TR><TD>.......</TD></TR>） . 我的问题是如何在现有表中添加新行？

我在顶部创建了一个 ID 为“userrightsgridheader”的标题，并指定了我的 Ajax.BeginForm，如下所示：

```
<% using (Ajax.BeginForm(
                   "CreateUserRight",
                    new { workstationId = Model.Id },
                    new AjaxOptions
                    {
                        HttpMethod = "POST",
                        InsertionMode = InsertionMode.InsertAfter,
                        UpdateTargetId = "userrightsgridheader"
                    }
                ))
               {  %> 
```

问题是这不起作用。有没有人对如何实现这一目标有任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T12:24:19.193

您可以添加以下 AjaxOption，当 Ajax 功能成功执行时，它会执行“jsfunction”：

```
new AjaxOptions { OnSuccess = "jsfunction" }; 
```

您可以在 jsfunction 中添加 tablerow。

**更新** 你可以定义jsfunction如下：

```
function jsfunction(ajaxContext) {
    //ajaxContext contains the responseText
} 
```

AjaxContext 定义如下：

```
AjaxContext ajaxContext = new AjaxContext(request, updateElement, loadingElement, ajaxOptions.InsertionMode); 
```

# groovy - 如何在元类中使用该方法更改 groovy 中方法的行为

> ID：920582
> 
> 赞同：5
> 
> 时间：2009-05-28T12:24:37.117
> 
> 标签：groovy, metaprogramming

我想通过以下方式“破坏”Groovy 中的 plus 方法：

```
Integer.metaClass.plus {Integer n -> delegate + n + 1}
assert 2+2 == 5 
```

我收到 StackOverflowException （这并不奇怪）。

有没有办法在元类的闭包中使用“原始”加法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-29T05:04:54.903

常规的惯用方法是保存对旧方法的引用并在新方法中调用它。

```
def oldPlus = Integer.metaClass.getMetaMethod("plus", [Integer] as Class[])

Integer.metaClass.plus = { Integer n ->
    return oldPlus.invoke(oldPlus.invoke(delegate, n), 1)        
}

assert 5 == 2 + 2 
```

这实际上并没有那么好记录，我打算在今晚或明天发表一篇关于这个确切主题的博客文章:)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:37:42.783

用这个来“宠”加法：

```
Integer.metaClass.plus {Integer n -> delegate - (-n) - (-1)}
assert 2+2 == 5 
```

毫不奇怪，在重载 plus 方法中使用 '+' 运算符会导致 StackOverflow，它需要使用除 '+' 运算符之外的其他东西。

其他机制：使用 XOR 或一些位运算符魔术。

问候， 和平之火

# visual-studio-2010 - F#：柯里化重载/元组重载问题

> ID：920584
> 
> 赞同：5
> 
> 时间：2009-05-28T12:25:09.333
> 
> 标签：visual-studio-2010, f#, currying

在将一些代码迁移到最新版本的 F#（包含在 VS2010 b1 中）时，我遇到了一个问题，我想知道是否有可用的解决方法以及 - 如果没有 - 为什么 F# 编译器的行为被修改为不支持剧情。

```
 type Foo(a) =
    [<OverloadID("CurriedAbc")>]
    member public x.Abc (p:(oneType * anotherType) seq) otherParm = method impl...

    //this overload exists for better compatibility with other languages
    [<OverloadID("TupledAbc")>]
    member public x.Abc (p:Dictionary<oneType, anotherType>, otherParm) =
        x.Abc(p |> Seq.map(fun kvp -> (kvp.Key, kvp.Value))) otherParm 
```

此代码产生以下编译时错误：

> 错误 FS0191：此方法的一个或多个重载具有 curried 参数。考虑重新设计这些成员以采用元组形式的参数

请注意，这曾经在 F# 1.9.6.2（9 月 CTP）上完美运行

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T13:03:48.910

更改的原因在[详细的发行说明中](http://blogs.msdn.com/dsyme/archive/2009/05/20/detailed-release-notes-for-the-f-may-2009-ctp-update-and-visual-studio-2010-beta1-releases.aspx)：

> Curried 方法的优化
> 
> 咖喱成员如下所示：
> 
> 类型 C() =
> 
> ```
> static member Sum a b = a + b 
> ```
> 
> 在以前的 F# 实现中，curried 成员的编译效率低于非 curried 成员。现在已经改变了。但是，现在对 curried 成员的定义有一些小的限制：
> 
> *   咖喱成员不能超载
> *   可能需要调整 curried 成员的某些定义，以在定义中添加正确数量的参数

由于您的重载只能在第一个参数上解决，您应该能够通过将 curried 版本更改为：

```
 [<OverloadID("CurriedAbc")>]
    member public x.Abc (p:(oneType * anotherType) seq)
       = fun otherParm -> method impl... 
```

# .net - 如何向 .NET 项目添加或处理帮助文件？

> ID：920585
> 
> 赞同：6
> 
> 时间：2009-05-28T12:25:47.023
> 
> 标签：.net, winforms

我的任务是向 Windows 应用程序添加在线帮助文​​件。所以我心中有几个问题：

*   如何创建帮助文件以及如何将它们添加到 Windows 窗体项目？

*   有没有在 VS 解决方案中处理它们的好方法？

*   有没有关于如何做到这一点的教程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T12:31:07.387

[以下](http://discuss.joelonsoftware.com/default.asp?dotnet.12.472709.4)是有关如何创建帮助文件的一些资源的指示：

> 现在最好的选择是在此处下载 Visual Studio 2005 SDK：
> 
> [http://msdn2.microsoft.com/en-us/vstudio/aa700819.aspx](http://msdn2.microsoft.com/en-us/vstudio/aa700819.aspx)
> 
> HelpStudio Lite 随附，可让您立即开始使用。以下是付费版本的一些信息：
> 
> [http://www.innovasys.com/products/hs2/overview.asp](http://www.innovasys.com/products/hs2/overview.asp)
> 
> * * *
> 
> +1 解释博士。
> 
> 他们的最新版本在创建 HTML 帮助文件 (CHM) 方面做得很好。它创建了很好的视觉帮助文件，这对我的用户来说非常有用，因为他们似乎想要阅读任何东西。

您也可以进行[谷歌搜索](http://www.google.com.ar/search?hl=es&q=create+help+files+.net)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T13:53:33.163

.NET 中内置了对 CHM 文件的支持。创建这些最便宜的方法是使用免费提供的[HTMLHelp Workshop](http://www.microsoft.com/downloads/details.aspx?FamilyID=00535334-c8a6-452f-9aa0-d597d16580cc&DisplayLang=en)，尽管有一些商业产品做得更好，例如[Flare](http://www.madcapsoftware.com/products/flare/overview.aspx)或[RoboHelp](http://www.adobe.com/products/robohelp/)。

拥有 CHM 后，您可以使用[`System.Windows.Forms.Help`](http://msdn.microsoft.com/en-us/library/system.windows.forms.help.aspx)静态方法随时随地显示帮助。

您不需要 Visual Studio SDK 来提供此功能。HelpStudio Lite 主要用于提供 MSDN 样式的帮助，可与 Visual Studio 帮助集合集成以部署新框架或 SDK。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:57:08.773

[帮助和手册](http://www.ec-software.com/)是创建帮助文件和文档的绝佳工具。

我已经用了很长时间了，物有所值。

# debugging - 在哪里可以找到有关在 AIX 上使用 dbx 进行高级调试的信息？

> ID：920586
> 
> 赞同：0
> 
> 时间：2009-05-28T12:26:52.230
> 
> 标签：debugging

在哪里可以找到有关在 AIX 上使用 dbx 进行高级调试的信息，我的意思是提前调试调用共享库的线程应用程序。而且我不拥有线程应用程序..但是你从共享库中调用我的函数（它就像一个插件）..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T12:38:54.093

试试这些：

[http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.genprogc/doc/genprogc/dbx_symbolic_debug.htm](http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.genprogc/doc/genprogc/dbx_symbolic_debug.htm)

[http://delphiwww.cern.ch/~dellib/tutorial/node22.html](http://delphiwww.cern.ch/~dellib/tutorial/node22.html)

# html - mailto：链接和网络邮件

> ID：920587
> 
> 赞同：13
> 
> 时间：2009-05-28T12:27:00.733
> 
> 标签：html

有没有办法实现 mailto: 与 webmail 客户端一起使用的链接？

编辑 - 所以传统的 mailto 链接（正如我所怀疑的那样）不起作用。那么，有没有人看到与您在各种最受欢迎​​的网站上看到的那些 rss 按钮类似的东西？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-28T12:32:48.973

链接由用户的浏览器处理。GMail 有一个客户端安装（GMail Notifier），它允许您指定您希望 GMail 处理所有 mailto 链接。

但是网页没有办法指定它的 mailto 链接应该由 webmail 应用程序处理（即使可以，你怎么知道是哪一个？）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T12:37:39.307

这实际上更像是一个 Web 客户端问题，它已经可用于 Firefox：

[http://starkravingfinkle.org/blog/2008/04/firefox-3-web-protocol-handlers/](http://starkravingfinkle.org/blog/2008/04/firefox-3-web-protocol-handlers/)

但最终由用户决定他们的浏览器如何处理 mailto 链接。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-03T13:18:55.640

**使用以下内容创建一个名为 MailtoWebMail.reg 的文本文件...**

> Windows 注册表编辑器版本 5.00
> 
> [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\mailto\shell\open\command]
> 
> @="\"(BrowserExecutable)\"(参数)"

**其中 (BrowserExecutable) 替换为浏览器的完整路径（即 C:\Program Files\Internet Explorer\iexplore.exe），并且 (Parameters) 替换为邮件服务的相应行，如下所述...**

**GMail** “http://mail.google.com/mail/?view=cm&fs=1&to=%1”

**Hotmail** "http://hotmail.msn.com/cgi-bin/compose?To=%1&mailto=1"

**雅虎邮箱** “http://compose.mail.yahoo.com/?To=%1”

**网景邮件** “http://webmail.netscape.com/compose.adp?mailto=%1”

**Mail.com** "http://mail01.mail.com/scripts/mail/Outblaze.mail?composeto=%1&compose=1"

**Opera 网络邮件** “http://mymail.operamail.com/scripts/mail/Outblaze.mail?compose=1&did=1&a=1&to=%1”

注意：[HKEY_LOCAL_MACHINE] 行后面不能有空行

迈克B

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T12:35:22.540

我只是在这里集思广益。您可以将 Javascript 处理程序附加到询问用户是否要登录网络邮件帐户的链接（以及提供者列表）。如果您有正确的网络邮件提供商 URL，那么您就可以根据用户的选择调用它们。如果用户回答“否”，则从处理程序返回 true，并且推测该链接将正常工作。

例如，参见[http://toric.blogspot.com/2005/07/gmail-compose-link.html](http://toric.blogspot.com/2005/07/gmail-compose-link.html)和[http://blog.monstuff.com/archives/000238.html](http://blog.monstuff.com/archives/000238.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T11:26:56.923

这里有 2 个 Opera UserJS 示例，您可以检查这些示例，让您了解如何在常规页面上执行此操作。（显然，特定于 UserJS 的函数在常规页面中不起作用，但您可以使用常规事件。）

例如，这个捕获邮件链接上的左键单击并在 Gmail 中打开它们。它还可以处理表单。

[http://shadow2531.com/opera/userjs/BeforeMailtoURL.js](http://shadow2531.com/opera/userjs/BeforeMailtoURL.js)

这个捕获所有 mailto 操作，具有更通用的解析器（支持任何 hname 而不仅仅是 to、cc、bcc、subject 和 body）并且具有更好的格式字符串语法：

[http://shadow2531.com/opera/userjs/BeforeMailtoURL.zip](http://shadow2531.com/opera/userjs/BeforeMailtoURL.zip)

基本上，您必须找到一种方法来拦截 mailto 链接操作。您可以使用链接上的单击事件侦听器并在表单上提交侦听器来执行此操作（如果您真的想支持表单）。（在整个窗口上使用 click 事件侦听器并对其进行过滤以查找 mailto 操作更容易。这样，您可以捕获在任意时间动态添加的 mailto 链接。）

或者，您可以只浏览页面并处理所有 mailto 链接。

但是，如果您想通过 window.open 或 document.location 等在地址字段中拦截 mailto 操作，您将需要 HTML5 的 registerProtocolHandler 或 Opera 的 webmailprovider.ini 支持之类的东西。您可以在 Firefox 中使用 registerProtocolHandler，但默认情况下，它仅限于您设置的域。

因此，基本上，您可以预先将 mailto 链接转换为 http(s) webmail 组合 URI，或者在调用 mailto 操作时。后者效果更好。

将 mailto 链接转换为 webmail compose URI 涉及一些事情。首先，您需要知道 webmail 接受哪些查询字符串变量。然后，您需要解析 mailto URI 以将其拆分为您想要的部分。然后，您需要对这些部分进行解码和重新编码（以规范化）。然后，您需要将多次出现的 hvalue 连接在一起。而且，您需要以不区分大小写的方式处理事情，并检查和转义不安全字符和 %HH 等。

对于解析，您可以执行快速而肮脏的正则表达式，但使用完整的 mailto URI 解析器和规范化功能可以获得更好的结果。

因此，如果您只想处理左键单击链接，则可以跨浏览器进行操作。除此之外，您必须使用特定浏览器为您提供的任何挂钩。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T12:49:03.230

假设，假设 webmail 客户端通过身份验证过程传递参数（或者用户已经通过身份验证），我不明白为什么这是不可能的。它不能以简单的 mailto: 方式完成，但可以提供一些流行的网络邮件服务的链接，并使用 Javascript 拦截对 mailto: 链接的点击，这样用户就会看到一个下拉列表可能的网络邮件服务（或其本地电子邮件客户端）列表。链接将带有 To:/Subject: 地址，但以 webmail 服务所需的任何结构形成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-13T13:56:59.450

如果您使用的是 Google Apps 电子邮件帐户（托管电子邮件），则 Gmail 通知程序将不起作用。不过，您可以使用小书签来更改所有邮件地址：指向您网络邮件的链接的链接。

这是我为此编写的一个小书签，它将以红色突出显示所有固定链接。

```
javascript:for(var i=0;i<document.links.length;i++){var a=document.links[i];if(a.href.indexOf('mailto:')==0){a.href='http://mail.google.com/a/sample.com/mail?extsrc=mailto&url='+a.href;a.style.backgroundColor='red';a.style.color='white'}};return true; 
```

请务必将[http://mail.google.com/a/sample.com](http://mail.google.com/a/sample.com)更改为适合您的任何适当托管地址。

我想如果您只是更改该链接，这将适用于许多其他电子邮件客户端。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-25T22:54:48.527

有点老线程，但还没有人回答它，所以这里。

正如上面 blesh 几乎所说，虽然没有办法让“mailto：”进入 Gmail，但还有另一种方法可以让这只猫在许多情况下都可以正常工作。只需更改网址。删除“mailto:”前缀并插入“https://mail.google.com/mail/?view=cm&fs=1&tf=1&to="。

无论用户是否通过 Google Apps 进入，这似乎都是一种魅力。如果用户未登录，他将完成该步骤，然后 Gmail 仍会启动新邮件。我注意到的唯一缺点是，如果（何时？）谷歌决定改变他们的书签方案，这可能需要一些调整。

根据您的情况，在 URL 位于 DOM 之前或之后执行此转换可能是有意义的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-03T13:23:46.873

哦，双击 MailtoWebMail.reg 将命令插入注册表。

迈克B

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-07T06:35:54.850

有没有人看到**数字**表明有多少百分比的网络邮件用户使用插件等配置他们的系统以正确地将`mailto:`链接发送到他们的浏览器/网络邮件系统而不是桌面应用程序？这对于决定是否使用`mailto:`网站上的链接或联系表格似乎至关重要，但我无法提供数字来指导决定。

# asp.net - 使用 asp.net 向导控件时如何验证字段？

> ID：920588
> 
> 赞同：0
> 
> 时间：2009-05-28T12:27:19.390
> 
> 标签：asp.net, validation

我的 asp.net 2.0 项目中有一个向导控件，它包含几个步骤。第二步有一个带有标准 requiredfieldvalidator 控件的文本框。当用户点击 Next 并且该框为空时，验证器抱怨，一切正常。

但是，当用户使用侧边栏步骤跳到倒数第二个步骤并单击完成时，不会触发验证器，并且文本框为空。在我的后端，我有这个：

```
 Protected Sub wizard_FinishButtonClick(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.WizardNavigationEventArgs) Handles wizard.FinishButtonClick
        If Page.IsValid Then
            ...
        Else
            lblError.Text = "You missed some fields, please return and enter them"
            e.Cancel = True
        End If
    End Sub 
```

（lblError 是完整页面上的标签，但这不是真正的问题）

此代码不起作用...

这个问题有什么好的解决方案？删除侧边栏而不使用它？几乎不是最好的解决方案......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T13:13:13.400

它远非完美，但我现在用这个作为答案：

```
 Protected Sub wzrdAddEvent_SideBarButtonClick(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.WizardNavigationEventArgs) Handles wzrdAddEvent.SideBarButtonClick
        If e.NextStepIndex > (e.CurrentStepIndex + 1) Then
            e.Cancel = True
        End If
    End Sub 
```

“如果使用侧边栏步骤，最多只允许向前一步”

# android - Android - 轨迹球活动结束了吗？

> ID：920597
> 
> 赞同：3
> 
> 时间：2009-05-28T12:30:59.303
> 
> 标签：android

我想根据轨迹球的运动在屏幕上移动图像。我可以使用 onTrackballEvent 方法捕捉动作。但这要求轨迹球的浮点值非常小（我相信每次旋转？）。

现在，当使用 LayoutParams 指定时，视图的 X 和 Y 位置应该是整数，因此每次旋转都移动视图是没有意义的。相反，我只想在用户停止旋转轨迹球后移动视图。

有什么方法可以得到用户是否停止使用轨迹球？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T12:38:21.350

如果没有（我不知道 Android），经典的方法是在每个事件中启动一个计时器，并跟踪其中报告的增量（通过将它们添加到运行总和中，一个用于 X，一个用于是）。在任何后续事件中，在计时器触发之前，只需重新启动同一个计时器，将其触发推向未来。

当用户停止生成事件时，计时器最终会触发，然后您可以应用所有动作的总和，并清除总和。

必须选择合适的超时时间，以便用户交互不会被认为太迟缓。也许大约 200-300 毫秒，或者更多。这很容易调整，直到感觉“正确”为止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T18:45:48.550

我还从设置阈值中获得了很多价值。因此，如果特定方向的总移动量达到给定数量，则触发导航事件。

# c# - 是否建议为所有 C# 枚举添加“Enum”后缀以避免命名冲突？

> ID：920603
> 
> 赞同：16
> 
> 时间：2009-05-28T12:32:41.500
> 
> 标签：c#, enums, naming-conventions

[这个stackoverflow问题](https://stackoverflow.com/questions/495051/c-naming-convention-for-enum-and-matching-property)有一个有趣的讨论，关于如何避免给枚举和属性赋予相同的名称，这样你就没有这样的代码：

```
public SaveStatus SaveStatus { get; set; } 
```

似乎已接受的答案建议对枚举使用“状态”，对属性使用“状态”：

```
public SaveStatus SaveState { get; set; } 
```

但我认为这很难阅读，并且不能立即清楚什么是什么。

由于这个枚举命名问题是一个持续存在的问题，我正在考虑总是用“Enum”作为我的枚举后缀，所以我会这样：

```
public SaveStatusEnum SaveStatus { get; set; }

SaveStatus = SaveStatusEnum.Succeeded; 
```

有人这样做吗？满意吗？用另一种方式解决了这个问题？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-28T12:37:53.783

从[MSDN 页面的属性命名指南](http://msdn.microsoft.com/en-us/library/fzcth91k(VS.71).aspx)：

> *考虑创建一个与其基础类型同名的属性。例如，如果您声明一个名为 Color 的属性，则该属性的类型也应为 Color。*

我认为这是“不”:)

**编辑：**

如果你不喜欢在声明属性的类中使用完全限定名，你可以解决它：

```
using SaveStatusEnum = MyNamespace.SaveStatus;
...
SaveStatus = SaveStatusEnum.SomeValue; 
```

这样，您可以保留不带后缀的枚举名称，并将命名怪异限制在一个类中。:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T12:36:20.620

.net 框架是否使用枚举作为后缀？[不](http://msdn.microsoft.com/en-us/library/system.stringsplitoptions.aspx)，这也是我不使用它的原因。

相反，我使用选项（或选项，如果它是标志枚举）、模式或类似的词。

```
public SaveStatusMode SaveStatus { get; set; }
public SaveStatusOption SaveStatus { get; set; }
public SaveStatusVariant SaveStatus { get; set; } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-28T12:37:30.803

Microsoft 的 .NET 命名指南没有给出任何此类建议。

为什么要避免给枚举和属性赋予相同的名称？这：

```
public SaveStatus SaveStatus { get; set; } 
```

工作得很好，可读，并且非常容易被发现和使用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-28T12:45:29.900

一种后缀用于某些类型的类，例如`xxxException`和`xxxAttribute`类，但后缀没有被广泛使用。例如，实现 IEnumerable 的类没有命名`MyListEnumerableClass`，而只是`MyList`.

与其发明一个使名称混乱的标准后缀，不如尝试编造在特定情况下有意义的名称。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-09-07T20:27:31.370

我知道我的建议违反了 .NET 命名约定，但我个人在枚举前加上“E”前缀，在枚举标志前加上“F”（类似于我们在接口前加上“I”前缀的方式）。我真的不明白为什么这不是惯例。枚举/标志是一种特殊情况，例如永远不会改变其类型的接口。它不仅清楚地说明了它是什么，而且很容易输入智能感知，因为前缀将过滤大多数其他类型/变量/等，并且您不会遇到这些命名冲突。

这也将解决另一个问题，对于 WPF 中的示例，它们使用静态类，例如具有预定义类型实例的枚举（例如 FontWeights），但如果不搜索它，您将不知道。如果他们只是在它们前面加上'E'，那么你所要做的就是在字符上键入以找到这些特殊的静态类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T12:46:05.780

如果以您拥有的方式定义属性，那么名称是否相同肯定没有区别。我会说以这种方式使用可能更清楚。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-22T08:26:48.130

我推荐MS指南。在代码中读取类似“FooEnum”的内容总是很丑陋的编码；）

# groovy - Groovy for 循环执行时间

> ID：920606
> 
> 赞同：12
> 
> 时间：2009-05-28T12:33:51.453
> 
> 标签：groovy

哦，时髦的大师们，

此代码段运行时间约为 1 秒

```
 for (int i in (1..10000000)) {
         j = i;
    } 
```

而这个需要将近 9 秒

```
 for (int i = 1; i < 10000000; i++) {
         j = i;
    } 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-29T15:01:20.767

行。这是我的看法为什么？

如果您将两个脚本都转换为字节码，您会注意到

1.  ForInLoop 使用范围。迭代器用于在每个循环期间前进。比较（<）直接与int（或Integer）进行比较，判断是否满足退出条件
2.  ForLoop 使用传统的增量、检查条件和执行操作。检查条件 i < 10000000 它使用 Groovy 的[ScriptBytecodeAdapter](http://svn.codehaus.org/groovy/trunk/groovy/groovy-core/src/main/org/codehaus/groovy/runtime/ScriptBytecodeAdapter.java) .compareLessThan。如果您深入研究该方法的代码，您会发现比较的双方都被视为对象，并且发生了很多事情，转换，将它们作为对象进行比较等。

[ScriptBytecodeAdapter](http://svn.codehaus.org/groovy/trunk/groovy/groovy-core/src/main/org/codehaus/groovy/runtime/ScriptBytecodeAdapter.java) .compareLessThan --> [ScriptBytecodeAdapter](http://svn.codehaus.org/groovy/trunk/groovy/groovy-core/src/main/org/codehaus/groovy/runtime/ScriptBytecodeAdapter.java) .compareTo --> [DefaultTypeTransformation](http://svn.codehaus.org/groovy/trunk/groovy/groovy-core/src/main/org/codehaus/groovy/runtime/typehandling/DefaultTypeTransformation.java) .compareTo

typehandling 包中还有其他类专门为数学数据类型实现 compareTo 方法，不确定为什么不使用它们，（如果不使用它们）

我怀疑这是第二个循环需要更长的时间的原因。再次，如果我错了或遗漏了什么，请纠正我......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T12:52:46.203

在您的测试中，请务必在采取措施之前“预热”JVM，否则您可能最终会触发平台中的各种启动操作（类加载、JIT 编译）。也可以连续多次运行测试。此外，如果您在进行垃圾收集时进行了第二次测试，这可能会产生影响。尝试将每个测试运行 100 次，并在每次测试后打印出时间，看看会告诉你什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:24:25.233

如果您可以按照 Jim 的建议从启动时消除潜在的工件，那么我会冒险猜测 Groovy 中的 Java 样式 for 循环的实现不如原始 Groovy 样式的 for 循环那么好。它只是在用户请求后从 v1.5 开始添加的，所以它的实现可能是事后才想到的。

您是否查看了为您的两个示例生成的字节码，看看是否有任何差异？[这里](http://www.juliesoft.com/blog/jon/index.php/2008/03/12/groovy-micro-benchmark-revisited-groovy-is-fast/)有一个关于 Groovy 性能的讨论，其中一条评论（来自一个“johnchase”）说：

> 我想知道您看到的差异是否与 Groovy 如何使用数字（基元）有关 - 因为它将所有基元包装在其等效的 Java 包装类（int -> Integer）中，我想这会减慢很多速度。我有兴趣查看使用包装类而不是整数循环 10,000,000 次的 Java 代码的性能。

那么也许原始的 Groovy for 循环不会受到这种影响？不过，这只是我的猜测。

# asp.net-mvc - ASP.NET MVC：如果视图有错误，如何发出编译错误信号？

> ID：920613
> 
> 赞同：6
> 
> 时间：2009-05-28T12:35:36.863
> 
> 标签：asp.net-mvc, compiler-construction

我的观点有错误。只有在 Visual Studio 中打开视图时，我才会看到这些错误。

我想查看编译时的错误，而不是执行时的错误。

是否存在获得这种行为的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T12:44:02.743

您可以手动更新 .csproj 文件并添加一个可以随时`<MvcBuildViews>true</MvcBuildViews>`编译视图的文件。

这是我用谷歌搜索的链接[，](http://webdevdotnet.blogspot.com/2009/02/aspnet-mvc-rc-compiler-post-build-step.html)您也会找到其他链接。

**编辑：**如果太慢，请尝试仅为 Release 设置构建，编辑 csproj 文件，执行以下操作；有关详细信息，请参阅[AspNetCompiler的文档。](http://msdn.microsoft.com/en-us/library/ms164291.aspx)

```
<!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
   Other similar extension points exist, see Microsoft.Common.targets.
   -->
<Target Name="BeforeBuild">
</Target>
<Target Name="AfterBuild">
    <AspNetCompiler VirtualPath="Temp" PhysicalPath="$(ProjectDir)\..\$(ProjectName)" />
</Target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T12:38:51.397

我假设您在谈论 C# 编译错误，而不是 CSS 验证错误之类的问题。

您可以做的一件事是将[Web 部署项目](http://www.microsoft.com/downloads/details.aspx?familyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)添加到您的解决方案中。当它构建时，它将在您的项目上运行 aspnet_compiler.exe，这将暴露 .aspx 文件中的任何这些 C# 编译错误，否则在运行时动态编译 .aspx 文件之前不会显示这些错误。

# c++ - 为什么引用一些导出的 const 变量的一些 const 变量的值是 0？

> ID：920615
> 
> 赞同：2
> 
> 时间：2009-05-28T12:35:53.023
> 
> 标签：c++, initialization, constants, double, extern

考虑以下。我有两个导出的常量，如下所示：

```
// somefile.h
extern const double cMyConstDouble;
extern const double cMyConstDouble2; 
```

和

```
// somefile.cpp
const double cMyConstDouble = 3.14;
const double cMyConstDouble2 = 2.5*cMyConstDouble; 
```

这些常量现在在其他地方引用以定义两个静态（本地可见）常量：

```
// someotherfile.cpp
#include "somefile.h"
static const double cAnotherDouble = 1.1*cMyConstDouble;
static const double cAnotherDouble2 = 1.1*cMyConstDouble2;
printf("cAnotherDouble = %g, cAnotherDouble2 = %g\n",
       cAnotherDouble, cAnotherDouble2); 
```

产生以下输出：

```
cAnotherDouble = 3.454, cAnotherDouble2 = 0 
```

为什么第二个双0？我正在使用 .NET 2003 C++ 编译器（13.10.3077）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T12:42:05.570

我不打算在这里深入探讨 extern 的问题，但是为什么您不将 const 放在适当的头文件中而忘记使用 extern“导出”它们呢？这就是 const 应该在 C++ 中使用的方式，以及它们具有内部链接的原因。

换句话说：

```
// someheader.h
const double cMyConstDouble = 3.14;
const double cMyConstDouble2 = 2.5*cMyConstDouble; 
```

和#include 该文件，无论您需要它们。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T12:42:51.730

因为 cMyConstDouble 被声明为 extern，所以编译器不能采用它的值并且不会为 cMyConstDouble2 生成编译时初始化。由于 cMyConstDouble2 未在编译时初始化，因此其相对于 cAnotherDouble2 的初始化顺序是随机的（未定义）。有关更多信息，请参阅[静态初始化惨败](http://www.parashift.com/c%2B%2B-faq-lite/ctors.html#faq-10.12)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T12:44:08.950

这是危险的事情，因为一个源文件中的一个静态变量依赖于另一个 cpp 文件中的另一个静态变量。查看[静态初始化惨败](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.12)以获取更多信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T16:00:20.037

如果您在`cMyConstDouble2`此处将初始化更改为：

```
const double cMyConstDouble2 = 2.5*3.14; 
```

那么你的程序应该表现正确。原因是这些变量

*   有POD类型
*   用常量表达式初始化*(1)*

在静态初始化时初始化。这些初始化包括

*   *对所有*具有静态存储持续时间的对象进行零初始化
*   使用常量表达式初始化的 POD 的初始化

在您显示的变量中，仅`cMyConstDouble`满足在静态初始化时完全初始化的两个条件。但是，`cMyConstDouble2`没有，因为它的初始化器不满足常量表达式的要求。特别是，它包括一个不具有整数类型的变量（这里，它具有浮点类型）。但是，算术常量表达式*中*允许使用浮点*文字。* 这就是为什么是算术常数表达式。这就是为什么将初始化程序更改为需要静态初始化的原因。*`2.5*3.14`*

 ** * *

`cMyConstDouble2`如果你继续使用非常数表达式会发生什么？答案是，你不知道。该标准允许对该变量进行静态初始化，但不要求它这样做。在您的情况下，它是动态初始化的 - 因此它在静态初始化时间之后的值仍然为零。为了感受这有多*复杂*，这里有一个例子：

```
inline double fd() { return 1.0; }
extern double d1;
double d2 = d1; // unspecified:
                // may be statically initialized to 0.0 or
                // dynamically initialized to 1.0
double d1 = fd(); // may be initialized statically to 1.0 
```

如果动态初始化不更改任何其他静态存储变量（在*您的*代码中满足），并且当静态初始化将产生与动态初始化产生的值相同的值时，当所有不需要静态初始化的对象都将被动态初始化时（在*您的*代码中也很满意） - 然后允许静态初始化变量。这两个条件在上面的代码中对于变量`d2`和也都满足`d1`：

分析`d2`

*   `= d1`不更改任何其他静态存储变量
*   当`d2`和`d1`都被动态初始化时，`d2`则将被初始化为`0.0`，因为`d2`在 之前定义`d1`，并且动态初始化`d2`将`d1`在静态初始化之后获取状态的 as 值（仅`d1`发生零初始化）。

分析`d1`

*   `= fd()`不更改任何其他静态存储变量
*   当`d2`和`d1`都被动态初始化时，`= fd()`则将初始化`d1`为`1.0`。

因此，编译器可能会`d1`静态初始化为`1.0`，因为可选静态初始化的两个条件都满足。

*   *如果*编译器决定动态初始化，`d1`则将**初始化为**，因为它将在零初始化之后获取 的值。`d2`**`d2``0.0`**`d1`

*   *但是*，*如果*编译器决定`d1`静态和`d2`动态初始化，**`d2`则将被初始化为`1.0`**，因为 的动态初始化`d2`将在静态初始化之后获取完全初始化的值`d1`。

不过，我不确定什么`d2`时候`d1` *和* `d2`静态初始化的值是什么。也就是说，是否`d2`应该抓取`0.0`或`1.0`，因为没有为静态初始化定义顺序。

* * *

*(1)*在考虑具有静态存储持续时间的对象的初始化顺序时，常量表达式也包括算术常量表达式（不仅是整型常量表达式）。

# c# - 如何在 Visual Studio 2008 Express Edition 中生成 Make File

> ID：920617
> 
> 赞同：2
> 
> 时间：2009-05-28T12:36:32.007
> 
> 标签：c#, visual-studio-2008, makefile

有人知道如何在 Visual Studio C# 2008 Express Edition 中生成 Make File 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T12:39:38.930

Make 文件在 .NET 世界中几乎没有用处。相反，请考虑使用[MSBuild](http://msdn.microsoft.com/en-us/library/wea2sca5.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-04T13:13:38.090

尝试这个：

1.  下载 MonoDevelop 2.0
2.  打开解决方案。
3.  右键单击解决方案名称 -> 生成生成文件...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T12:48:27.727

Makefile 真正用于跨平台编译或与其他构建系统一起使用。当您使用 C# 时，您实际上只会使用 Microsoft 的工具进行编译或在另一个平台上使用 Mono，所以我认为您不能。另一种选择可能是 NAnt，但取决于您想要使用 Makefile 的目的。

# c# - 我应该在哪个接口公开一个列表 通过？

> ID：920625
> 
> 赞同：4
> 
> 时间：2009-05-28T12:38:23.143
> 
> 标签：c#, .net, c#-3.0, interface, ilist

在回答这个[问题时，](https://stackoverflow.com/questions/920158/avoid-circular-reference-in-domain-model) [runefs](https://stackoverflow.com/users/112407/runefs)建议“除非您有非常具体的原因使用 IList，否则您应该考虑使用 IEnumerable”。你使用哪个，为什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T12:44:26.330

`IEnumberable<T>`是只读的，您必须重建集合才能对其进行更改。另一方面，`IList<T>`是读写。因此，如果您期望对集合进行大量更改，请公开，`IList<T>`但如果可以安全地假设您不会修改它，请使用`IEnumerable<T>`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T12:44:15.097

始终使用提供您需要的功能的最严格的接口，因为这为您提供了以后更改实现的最大灵活性。所以，如果`IEnumerable<T>`足够了，那就使用它……如果你需要列表功能，使用`IList<T>`.

并且最好使用强类型的泛型版本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T12:50:36.630

我遵循的原则是我不久前读到的：

> “消费最简单，暴露最复杂”

（我敢肯定这真的很常见，而且我引用错误，如果有人知道出处，请您发表评论或编辑...）

（编辑添加 - 好吧，几周后我在这里，我刚刚在完全不同的背景下遇到了这句话，它看起来像是从[鲁棒性原则](http://en.wikipedia.org/wiki/Postel%27s_law)或 Postel 定律开始的 -

> 做事要保守；对你从别人那里接受的东西要自由。

最初的定义是用于互联网上的网络通信，但我确信我已经看到它重新用于在 OO 中定义类合同。）

基本上，如果您正在定义一种用于外部消费的方法，那么参数应该是最基本的类型，可以为您提供所需的功能 - 在您的示例中，这可能意味着采用 IEnumerable 而不是 IList。这使客户端代码在可以传递的内容方面具有最大的灵活性。另一方面，如果您要公开一个属性以供外部使用，那么请使用最复杂的类型（IList 或 ICollection 而不是 IEnumerable）这样做，因为这为客户端提供了最他们使用对象的方式的灵活性。

* * *

我在评论中发现我和 DrJokepu 之间的对话很有趣，但我也很欣赏这不应该是一个讨论论坛，所以我将编辑我的答案以进一步概述我选择逆势而上的原因建议您将其公开为 IList（实际上是一个 List，如您所见）。假设这是我们正在谈论的课程：

```
public class Example
{
    private List<int> _internal = new List<int>();

    public /*To be decided*/ External
    {
        get { return _internal; }
    }
} 
```

所以首先让我们假设我们将External 暴露为一个IEnumerable。我在其他答案和评论中看到这样做的原因目前是：

*   IEnumerable 是只读的
*   IEnumerable 是事实上的标准
*   它减少了耦合，因此您可以更改实现
*   您不会公开实现细节

虽然 IEnumerable 只公开了不会使其成为只读的只读功能。您返回的真实类型很容易通过反射或简单地暂停调试器并查看，因此将其转换回 List<> 是微不足道的，这同样适用于下面评论中的 FileStream 示例。如果您试图保护该成员，那么假装它是其他东西不是这样做的方法。

我不相信这是事实上的标准。我在 .NET 3.5 库中找不到任何代码，Microsoft 可以选择返回具体集合并改为返回接口。由于 LINQ， IEnumerable在 3.5*中*更常见，但那是因为它们不能公开更多派生类型，而不是因为他们不想这样做。

现在，减少耦合我同意 - 在一定程度上 - 基本上这个论点似乎是你告诉客户，虽然你返回的对象*是*一个列表，但我希望你对待它是一个 IEnumerable，以防你决定更改内部代码稍后。忽略这个问题以及无论如何都会暴露真实类型的事实，它仍然留下“为什么停止在 IEnumerable？”的问题。如果您将其作为对象类型返回，那么您将有完全的自由将实现更改为任何东西！这意味着您必须已决定客户端代码需要多少功能，因此您要么正在编写客户端代码，要么该决定基于任意指标。

最后，如前所述，您可以假设实现细节*始终*在 .NET 中公开，尤其是在公开公开对象时。

所以，经过这么长时间的谩骂之后，还有一个问题——为什么要将它公开为 List<>？那么，为什么不呢？将其公开为 IEnumerable 并没有获得任何好处，那么为什么人为地限制客户端代码使用该对象的能力呢？想象一下，如果 Microsoft 决定 Winforms 控件的 Controls 集合应该显示为 IEnumerable 而不是 ControlCollection - 您将不再能够将其传递给需要 IList 的方法，处理任意索引处的项目，或者查看它是否包含特定控件，除非您强制转换它。Microsoft 不会真正获得任何收益，只会给您带来不便。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T12:43:58.593

当我只需要枚举孩子时，我使用 IEnumerable。如果我碰巧需要 Count，我会使用 ICollection。不过，我尽量避免这种情况，因为它暴露了实现细节。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T12:45:48.963

`IList<T>`确实是一个非常强大的界面。我更喜欢公开 -`Collection<T>`派生类型。这与 Jeffrey Richter 建议的做法非常一致（附近没有书，所以不能指定页码/章节号）：方法应该接受最常见的类型作为参数，并返回最“派生”的类型为返回值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-07T11:05:45.120

如果只读集合通过属性公开，那么执行此操作的常规方法是将其公开为 ReadOnlyCollection（或其派生类），包装您拥有的任何内容。它向客户端公开了 IList 的全部功能，但它非常清楚地表明它是只读的。

# html - 为投票结果创建彩条

> ID：920635
> 
> 赞同：3
> 
> 时间：2009-05-28T12:42:25.430
> 
> 标签：html, css

在我的网络应用程序中，我想用彩色条显示投票结果，其长度与投票百分比成正比。如何使用 HTML/CSS 实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T12:48:27.477

这个网站包含一些很好的例子：

[http://apples-to-oranges.com/blog/post/css-for-bar-graphs/?id=55](http://apples-to-oranges.com/blog/post/css-for-bar-graphs/?id=55)

这是 16 种不同类型的条形图的集合：

[http://speckyboy.com/2009/02/04/16-usable-css-graph-and-bar-chart-tutorials-and-techniques/](http://speckyboy.com/2009/02/04/16-usable-css-graph-and-bar-chart-tutorials-and-techniques/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T12:49:24.853

这是一些示例代码：

```
 <style>
        .GraphWrapper {
            width:300px;
            border:1px solid #DDDDDD;
        }

        .BlueBar {
            height:30px;
            margin:10px 0px 10px 0px;
            background-color:#FFCCCC;
        }

        .RedBar {
            height:30px;
            margin:10px 0px 10px 0px;
            background-color:#CCCCFF;
        }
    </style>

    <div class='GraphWrapper'>
        <div class='BlueBar' style='width:50%;'></div>
        <div class='RedBar' style='width:75%;'></div>
    </div> 
```

然后，您可以编辑图表条的**宽度样式以实现图表百分比。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T12:48:36.133

这实际上很容易实现。您希望每个条形图由单个 . 将 div 设置为所需的宽度（与结果成比例）。例如，如果您希望 200px 成为“100%”的投票，那么如果一个选项有 23% 的投票，您希望 .23 * 200 成为 div 的像素宽度。

然后设置背景颜色和边框以根据需要设置栏的样式。您还可以花哨并使用图像（背景图像 css 属性）来获得更好看的条形图。

我希望这能为您指明正确的方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-06T20:26:13.960

我知道这是一个老问题，但新技术提供了新的解决方案。此外，没有一个答案被接受......

在 HTML5 中，您可以使用[画布元素](https://en.wikipedia.org/wiki/Canvas_element)来实际绘制图形。使用 canvas 元素可能非常复杂，因此我不会在这里详细介绍如何将它用于您的特定场景。

然而，这里有一个简单的例子（从[diveintohtml5.info](http://diveintohtml5.info/canvas.html)复制）：

**HTML**

```
<canvas id="graph" width="300" height="225"></canvas> 
```

**JavaScript**

```
var canvas = document.getElementById("graph");
var context = canvas.getContext("2d");
context.fillRect(50, 24, 150, 100); 
```

# python - 何时在 Python 中使用“while”或“for”

> ID：920645
> 
> 赞同：42
> 
> 时间：2009-05-28T12:44:27.920
> 
> 标签：python, loops

我在何时应该在 Python 中使用`while`循环或循环时发现问题。`for`看起来人们更喜欢使用`for`循环*（更少的代码行？）*。有没有我应该使用其中一种的具体情况？这是个人喜好问题吗？到目前为止我读过的代码让我觉得它们之间有很大的不同。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-28T12:55:59.207

是的，while 和 for 之间有很大的不同。

**for**语句遍历集合或可迭代对象或生成器函数。

**while**语句简单地循环，直到条件为 False 。

这不是偏好。这是您的数据结构是什么的问题。

通常，我们将要处理的值表示为`range`（实际列表）或`xrange`（生成值）（**编辑**：在 Python 3 中，`range`现在是一个生成器，行为类似于旧`xrange`函数。`xrange`已从 Python 3 中删除） . **这为我们提供了为for**语句量身定制的数据结构。

然而，一般来说，我们有一个现成的集合：一个集合、元组、列表、映射甚至一个字符串已经是一个可迭代的集合，所以我们只需使用一个**for**循环。

在少数情况下，我们可能希望为我们完成一些函数式编程处理，在这种情况下，我们可以将该转换应用为迭代的一部分。`sorted`and函数对与**for**语句`enumerate`自然匹配的迭代应用转换。

 **如果你没有一个整洁的数据结构来迭代，或者你没有一个生成器函数来驱动你的处理，你必须使用**while**。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-28T12:55:01.550

`while`在中断条件在逻辑上不依赖于任何类型的序列的情况下很有用。例如，考虑不可预测的交互：

```
 while user_is_sleeping():
     wait() 
```

当然，您*可以*编写一个适当的迭代器来封装该操作并使其可通过`for`- 但这将如何提供可读性？¹

在 Python 中的所有其他情况下，使用`for`（或封装循环的适当高阶函数）。

¹ 假设`user_is_sleeping`函数`False`在 false 时返回，示例代码可以重写为以下`for`循环：

```
for _ in iter(user_is_sleeping, False):
    wait() 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-28T12:46:14.157

是迭代列表的`for`更 Pythonic 选择，因为它更简单且更易于阅读。

例如这个：

```
for i in range(11):
    print i 
```

比这更简单，更容易阅读：

```
i = 0
while i <= 10:
    print i
    i = i + 1 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-10-16T09:42:24.340

> **当您有**明确**的迭代（迭代次数已知）时，使用**for循环。****

 **使用示例：

*   遍历具有确定范围的循环：`for i in range(23):`.
*   遍历集合（字符串、列表、集合、元组、字典）`for book in books:`：。

> **while**循环是一种**无限迭代**，当循环重复未知次数并在满足某些**条件**时结束时使用。

请注意，在 while 循环的情况下，循环的缩进主体应修改测试条件中的至少一个变量，否则结果为无限循环。

使用示例：

*   代码块的执行需要用户输入指定的输入：`while input == specified_input:`.

*   当您有带有比较运算符的条件时：`while count < limit and stop != False:`.

参考：[For Loops Vs。While 循环，Udacity 数据科学](https://classroom.udacity.com/nanodegrees/nd104-ent/parts/ca3c4c01-1432-4599-8b76-3191fe7b94a6/modules/3c5137f9-0620-41c4-b575-283ab5f45482/lessons/dddb0644-584b-48c2-889f-f06f15720f34/concepts/a654965a-8d6a-426c-a106-b0b87695ff8b)， [Python.org](https://wiki.python.org/moin/WhileLoop)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-28T13:32:43.190

首先，python 和其他语言中的 for 循环之间存在差异。在 python 中，它迭代一个值列表（例如：for value in [4,3,2,7]），在大多数其他语言（C/C++，Java，PHP 等）中，它充当一个 while 循环，但更容易读书。

当迭代次数已知时（例如数组的长度），通常使用 for 循环，而当您不知道需要多长时间时使用 while 循环（例如，[冒泡排序](http://en.wikipedia.org/wiki/Bubble_sort)算法循环只要值未排序）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-28T19:56:04.943

考虑处理迭代。你可以用一个`for`循环来做到这一点：

```
for i in mylist:
   print i 
```

或者，您可以使用`while`循环来执行此操作：

```
it = mylist.__iter__()
while True:
   try:
      print it.next()
   except StopIteration:
      break 
```

这两个代码块以基本相同的方式完成基本相同的事情。但是`for`循环隐藏了迭代器的创建和`StopIteration`异常的处理，因此您不需要自己处理它们。

我能想到的唯一一次使用`while`循环来处理可迭代对象的情况是，如果出于某种原因需要直接访问迭代器，例如在某些情况下需要跳过列表中的项目。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-28T13:17:54.810

For 循环通常可以更清楚地说明迭代在做什么。您不能总是直接使用它们，但大多数时候，带有 while 循环的迭代逻辑可以包装在生成器 func 中。例如：

```
def path_to_root(node):
    while node is not None:
        yield node
        node = node.parent

for parent in path_to_root(node):
    ... 
```

代替

```
parent = node
while parent is not None:
    ...
    parent = parent.parent 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-16T20:41:44.800

如果您的数据很脏并且无法使用 for 循环，则您需要清理数据。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2020-08-27T20:51:30.520

while 循环更适合普通循环 for 循环在处理字符串（如列表、字符串等）时比 while 循环好得多。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-08-13T19:04:12.423

对我来说，如果您的问题需要使用多个指针来跟踪某个边界，我总是更喜欢 While 循环。
在其他情况下，它只是 for 循环。

# php - 未捕获的 SoapFault 异常：[HTTP] 获取 http 标头时出错

> ID：920646
> 
> 赞同：26
> 
> 时间：2009-05-28T12:44:52.833
> 
> 标签：php, soap, magento, wsdl

我正在尝试创建到 Magento 的 Web 服务的肥皂连接，但是当我尝试创建肥皂客户端类的实例时出现错误。我可以毫无问题地在 Firefox 中查看 wsdl 文件，并且可以看到 php 在 apaches 日志中发出对 wsdl 的请求，但它仍然失败。Nusoap 可以连接。

```
$proxy = new SoapClient('someaddress?wsdl'); 
```

错误是

```
<b>Fatal error</b>:  Uncaught SoapFault exception: [HTTP] Error Fetching http headers in /home/sites/xxx/xxx_main/system/application/views/contentpage_templates/gift_service.php:29
Stack trace:
[internal function]: SoapClient-&gt;__doRequest('&lt;?xml version=&quot;...',    'http://cornishw...', 'urn:Mage_Api_Mo...', 1, 0)
[internal function]: SoapClient-&gt;__call('call', Array)
/home/sites/xxx/xxx_main/system/application/views/contentpage_templates/gift_service.php(29): SoapClient-&gt;call(NULL, 'catalog_categor...', 5, 'giftshop')
/home/sites/xxx/xxx_main/system/application/libraries/MY_Loader.php(586): include('/home/sites/cor...')
/home/sites/xxx/xxx_main/system/application/libraries/MY_Loader.php(228): MY_Loader-&gt;_ci_load(Array, '')
/home/sites/xxx/xxx_main/system/application/modules/contentpage/controllers/contentpage.php(44): MY_Loader-&gt;view('contentpage_tem...', false, true)
[internal function]: Contentpage-&gt;index()
/home/sites/xxx in <b>/home/sites/xxx/xxx_main/system/application/views/contentpage_templates/gift_service.php</b> on line <b>29</b> 
```

谢谢

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-07-20T09:31:41.687

尝试设置：

```
default_socket_timeout = 120 
```

在你的`php.ini`文件中。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-29T05:55:47.950

您是否尝试添加

```
'trace'=>1, 
```

到 SoapClient 创建参数，然后：

```
var_dump($client->__getLastRequest());
var_dump($client->__getLastResponse()); 
```

看看发生了什么？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-11-19T17:21:34.170

如果服务器端出现问题，则客户端可能会出现此错误。例如，如果 SOAP 服务器是一个带有解析错误的 PHP 脚本，则客户端将失败并显示此消息。

如果您可以控制服务器，请在托管 SOAP 服务器的机器上跟踪您的 Apache error_log。在 CentOS 上，你会在 /var/log/httpd/error_log 中找到它，所以命令是：

tail -f /var/log/httpd/error_log

现在刷新客户端并注意错误消息。将显示服务器脚本的任何 PHP 错误。

希望对某人有所帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-05-30T13:20:07.273

我遇到了同样的问题。
我将它作为 CLI 运行。所以 PHP 一直在运行，它必须在一段时间后一次又一次地进行肥皂调用。
我犯的错误是为此使用单例模式。我认为使用单例会导致性能提升，但反过来我得到了

```
Error Fetching http headers in ... 
```

我通过为每个调用创建新的 saop 对象来修复它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T14:20:04.483

我不是关于您的 PHP 配置，但在 PHP 5.2.6 之前，PHP 的 SOAP 客户端确实存在一些问题：

[错误 #41983 - 获取 http 标头时出错](https://bugs.php.net/bug.php?id=41983)

![错误 #41983](https://i.stack.imgur.com/u5gor.jpg)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-02T13:08:10.110

如果这是与 Magento 相关的问题，您应该关闭自动重新索引，因为这可能会导致套接字超时（或过期）。脚本完成其任务后，您可以重新打开它。增加 php.ini 中的默认套接字超时也是一个好主意。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-05-26T10:21:01.190

我遇到了同样的问题并尝试了上述所有解决方案。可悲的是没有任何工作。

1.  套接字超时（无效）
2.  用户代理（未工作）
3.  SoapClient 配置，**cache_wsdl**和**Keep-Alive**等。

我们正在传递的整个头球比赛。**我通过添加压缩**头属性解决了我的问题。当您期望**gzip**压缩格式的响应时，这实际上需要。

```
//set the Headers of Soap Client. 
$client = new SoapClient($wsdlUrl, array(
    'trace' => true, 
    'keep_alive' => true,
    'connection_timeout' => 5000,
    'cache_wsdl' => WSDL_CACHE_NONE,
    'compression'   => SOAP_COMPRESSION_ACCEPT | SOAP_COMPRESSION_GZIP | SOAP_COMPRESSION_DEFLATE,
)); 
```

希望能帮助到你。

祝你好运。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-16T20:44:13.807

在我的 apache 错误日志中，我看到：

```
[Tue Feb 16 14:55:02 2010] [notice] child pid 9985 exit signal File size limit exceeded (25) 
```

所以我，删除了我最大的日志文件 2.1GB /var/log/system.log 的所有内容。现在一切正常。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-14T18:06:52.767

php 版本低于 5.2.6 存在问题。您可能需要升级 php.ini 的版本。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-12-05T13:46:52.427

请更新您的 php.ini

```
default_socket_timeout = 120 
```

如果 php 安装的是 CGI 而不是 Apache 模块，您可以创建自己的 php.ini

# java - Java Logger 仅用于文件，无屏幕输出

> ID：920654
> 
> 赞同：13
> 
> 时间：2009-05-28T12:46:18.510
> 
> 标签：java, logging

我有一个非常简单的问题，但找不到解决方案。我有一个添加了文件处理程序的记录器，但它仍然从我的控制台中发送垃圾邮件。我怎样才能让记录器将所有输出单独路由到一个文件，没有控制台输出？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-06-14T18:48:43.550

老问题，但要帮助其他开发人员：

您也可以只`logger.setUseParentHandlers(false)`在记录器上使用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T12:52:06.563

保证不会将任何内容写入控制台的最简单方法是放置：

```
java.util.logging.ConsoleHandler.level = NONE 
```

在您的日志记录配置文件中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-28T12:48:14.123

在添加文件处理程序之前，从根记录器中删除所有处理程序（使用[Logger.getHandlers()](http://java.sun.com/j2se/1.5.0/docs/api/java/util/logging/Logger.html#getHandlers())并为每个处理程序调用[Logger.removeHandler() ）。](http://java.sun.com/j2se/1.5.0/docs/api/java/util/logging/Logger.html#removeHandler(java.util.logging.Handler))

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-16T10:54:06.093

将 log4j 与

```
import org.apache.log4j.Logger;

Logger logger = Logger.getLogger("com.whatever");
PropertyConfigurator.configure("file-log4j.properties"); 
```

并在 file-log4j.properties 中设置显示级别：

```
# Root logger option
log4j.rootLogger=INFO, file

# Direct log messages to a log file
log4j.appender.file=org.apache.log4j.RollingFileAppender
log4j.appender.file.File=index-service.log
log4j.appender.file.MaxFileSize=1MB
log4j.appender.file.MaxBackupIndex=1
log4j.appender.file.layout=org.apache.log4j.PatternLayout
log4j.appender.file.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n
log4j.appender.file.Append=false 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-02T18:07:21.257

我用：

```
Logger logger = Logger.getLogger("MyLog");
    Logger parentLog= logger.getParent();
    if (parentLog!=null&&parentLog.getHandlers().length>0) parentLog.removeHandler(parentLog.getHandlers()[0]); 
```

# function - 何时检查函数/方法参数？

> ID：920668
> 
> 赞同：3
> 
> 时间：2009-05-28T12:49:28.223
> 
> 标签：function, methods

在编写小函数时，我经常遇到这样的情况，即某些参数被赋予一个函数，该函数本身仅将它们传递给不同的小函数以达到其目的。

例如（C#-ish 语法）：

```
public void FunctionA(object param)
{
    DoA(param);
    DoB(param);
    DoC(param);
    // etc.
}

private void DoA(object param)
{
    DoD(param);
}

private void DoD(object param)
{
    // Error if param == null
    param.DoX();
} 
```

因此，参数不是在被调用函数内部使用，而是在完成这项工作的小函数的深处“某处”使用。

那么何时最好检查我的 param-Object 是否为空？

签入 FunctionA 时：

优点： - 通过使用其他方法没有任何开销，因为对象为空，这些方法最终什么都不做。

缺点：-我的语法很棒的 FunctionA 被丑陋的验证代码弄脏了。

仅在使用 param-object 时检查：

优点：-我的语法很棒的 FunctionA 让我很高兴阅读 :)

缺点：-调用方法会产生开销，因为参数对象为空，所以什么都不做。-我目前没有考虑其他缺点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T12:58:16.940

始终将它放在尽可能远的调用堆栈中，这样如果您稍后重构代码并且其他调用 DoD 而非 DoA 时，您可以进行检查，而不必重新进行参数检查。在大多数情况下，一个小的空值检查和可能的一些额外方法调用的开销将是微不足道的，并且多做几次检查不是你应该担心的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T12:53:24.300

除非您认为该值在绝大多数情况下可能为空，否则我会将验证放在 DoD() 中。如果你把它放在 FunctionA() 中，当你决定 FunctionB() 也需要使用 DoD() 时，你将不得不重复验证代码。对我来说，额外的开销是值得不必重复自己的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:03:29.427

作为指导，我养成了**检查**方法使用的每个参数的习惯，甚至包括我自己的私有变量。因此，我只会在您的 DoD 方法中检查 nil 。

您可能想查看 Bertrand Meyers [Design By Contract](http://www.artima.com/intv/contracts.html)口头禅。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T13:36:17.300

早点失败。除非部分结果比没有结果更可取，否则一旦代码检测到存在问题，就应该停止执行。当下游结果将是无效或缺少参数时，为什么代码要运行多种方法？

如果可以单独调用下游方法，则可以通过调用 ca common validation methed 来处理验证，正如已经建议的那样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T13:14:39.047

始终检查一切 :) 来自嵌入式系统编码库的深层内容，这是我将使用的方法：

```
public void FunctionA(object param)
{
    assert(param != null && param.canDoX());
    DoA(param);
    DoB(param);
    DoC(param);
    // etc.
}

private void DoA(object param)
{
    assert(param != null && param.canDoX());
    DoD(param);
}

private void DoD(object param)
{
    assert(param != null && param.canDoX());
    if ( param != null )
        param.DoX();
    else
        // Signal error, for instance by throwing a runtime exception
        // This error-handling is then verified by a unit test that 
        // uses a release build of the code.
} 
```

为了解决这个问题，显而易见的解决方案是将验证分解为单独的验证器函数。使用 C 风格的预处理器，或者只是坚持断言，从发布版本中排除这种“偏执”验证应该是微不足道的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-04T10:46:22.387

传递有效参数是调用者的责任。在这种情况下：

```
if(param != null)
{
  FunctionA(param);
} 
```

# javascript - 使用 Javascript 读取会话 ID

> ID：920670
> 
> 赞同：31
> 
> 时间：2009-05-28T12:49:34.773
> 
> 标签：javascript, session

是否可以使用javascript读取浏览器会话ID？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-28T12:53:31.350

是的。由于会话 ID 是通过 URL ( `document.location.href`) 或通过 cookie ( `document.cookie`) 传输的，因此您可以检查两者是否存在会话 ID。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-07T15:17:57.007

以下可用于检索 JSESSIONID：

```
function getJSessionId(){
    var jsId = document.cookie.match(/JSESSIONID=[^;]+/);
    if(jsId != null) {
        if (jsId instanceof Array)
            jsId = jsId[0].substring(11);
        else
            jsId = jsId.substring(11);
    }
    return jsId;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-01-11T16:18:25.410

您可以通过在 document.cookie 上发出以下正则表达式来接收会话 ID：

```
alert(document.cookie.match(/PHPSESSID=[^;]+/)); 
```

在我的示例中，用于存储会话 id 的 cookie 名称是 PHPSESSID（php 服务器），只需将 PHPSESSID 替换为包含会话 id 的 cookie 名称。（可由网络服务器配置）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-28T12:55:50.317

据我所知，浏览器会话没有 id。

如果您指的是服务器会话，那通常存储在 cookie 中。例如，ASP.NET 存储的 cookie 名为“ASP.NET_SessionId”。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-10-30T16:16:54.603

下面是一个简短的 JavaScript 函数来获取会话 ID：

```
function session_id() {
    return /SESS\w*ID=([^;]+)/i.test(document.cookie) ? RegExp.$1 : false;
} 
```

或者，如果您更喜欢变量，这里有一个简单的单行：

```
var session_id = /SESS\w*ID=([^;]+)/i.test(document.cookie) ? RegExp.$1 : false; 
```

应该与 PHP、JSP、.NET 的会话 ID cookie 匹配，我想其他各种服务器端处理器也是如此。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-16T23:34:32.533

对于 PHP 的 PHPSESSID 变量，此函数有效：

```
function getPHPSessId() {
    var phpSessionId = document.cookie.match(/PHPSESSID=[A-Za-z0-9]+\;/i);

    if(phpSessionId == null) 
        return '';

    if(typeof(phpSessionId) == 'undefined')
        return '';

    if(phpSessionId.length <= 0)
        return '';

    phpSessionId = phpSessionId[0];

    var end = phpSessionId.lastIndexOf(';');
    if(end == -1) end = phpSessionId.length;

    return phpSessionId.substring(10, end);
} 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2012-01-09T06:30:58.380

您可能可以通过 javascript 中的 ajax ping 服务器。php 文件可能类似于：

```
<?php
session_start();
$id = session_id();
echo $id;
?> 
```

这将返回您当前的会话 ID。这就是你要找的东西。

# ios - 如何将方法调用延迟 1 秒？

> ID：920675
> 
> 赞同：167
> 
> 时间：2009-05-28T12:51:46.033
> 
> 标签：ios, objective-c, iphone, cocoa-touch, uikit

有没有一种简单的方法可以将方法调用延迟 1 秒？

我有一个`UIImageView`对触摸事件作出反应的。当检测到触摸时，应用程序中会出现一些动画。一秒钟后，我想调用另一个方法。在这种情况下，我不能使用`animationDidStop`选择器。

* * *

## 回答 #1

> 赞同：256
> 
> 时间：2009-05-28T12:58:13.493

```
performSelector:withObject:afterDelay: 
```

[文件参考](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/#//apple_ref/occ/instm/NSObject/performSelector:withObject:afterDelay:)

* * *

## 回答 #2

> 赞同：197
> 
> 时间：2012-03-22T10:29:09.253

你也可以使用块

```
dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 1 * NSEC_PER_SEC), dispatch_get_main_queue(), ^{
    [object method]; 
}); 
```

大多数时候你会想要使用dispatch_get_main_queue，尽管如果方法中没有UI，你可以使用[全局队列](https://developer.apple.com/library/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/c/func/dispatch_get_global_queue)。

**编辑：**

斯威夫特 3 版本：

```
DispatchQueue.main.asyncAfter(deadline: .now() + 1) {
    object.method()
} 
```

同样，`DispatchQueue.global().asyncAfter(...`也可能是一个不错的选择。

* * *

## 回答 #3

> 赞同：131
> 
> 时间：2011-10-03T08:11:43.073

最好的方法是：

```
[self performSelector:@selector(YourFunctionName) 
           withObject:(can be Self or Object from other Classes) 
           afterDelay:(Time Of Delay)]; 
```

您也可以将 nil 作为 withObject 参数传递。

例子 ：

```
[self performSelector:@selector(subscribe) withObject:self afterDelay:3.0 ]; 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2015-04-02T15:40:57.637

已经有很多答案，而且都是正确的。如果您想使用 ，`dispatch_after`您应该寻找包含在`Code Snippet Library`右下角的片段（您可以在其中选择`UI`元素）。

![在此处输入图像描述](https://i.stack.imgur.com/OSIvz.png)

所以你只需要通过在代码中编写**dispatch**来调用这个片段：

![在此处输入图像描述](https://i.stack.imgur.com/UP6gM.png)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2011-10-03T12:10:53.363

您可以在调用 0.1 秒延迟方法之后使用执行选择器来执行此操作。

```
[self performSelector:@selector(InsertView)  withObject:nil afterDelay:0.1]; 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-03-02T19:03:44.207

你也可以：

```
[UIView animateWithDuration:1.0
                 animations:^{ self.view.alpha = 1.1; /* Some fake chages */ }
                 completion:^(BOOL finished)
{
    NSLog(@"A second lapsed.");
}]; 
```

在这种情况下，您必须对某些视图进行一些更改才能使动画正常工作。它确实很hacky，但我喜欢基于块的东西。或者在下面总结@mcfedr 的答案。

* * *

```
waitFor(1.0, ^
{
    NSLog(@"A second lapsed");
}); 
```

* * *

```
typedef void (^WaitCompletionBlock)();
void waitFor(NSTimeInterval duration, WaitCompletionBlock completion)
{
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, duration * NSEC_PER_SEC),
                   dispatch_get_main_queue(), ^
    { completion(); });
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-03-25T11:48:43.520

你可以这样做

```
[self performSelector:@selector(MethodToExecute) withObject:nil afterDelay:1.0 ]; 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-12-20T08:08:34.523

**斯威夫特 2.x**

```
let delayTime = dispatch_time(DISPATCH_TIME_NOW, Int64(1 * Double(NSEC_PER_SEC)))
 dispatch_after(delayTime, dispatch_get_main_queue()) {
 print("do some work")
} 
```

**斯威夫特 3.x --&-- 斯威夫特 4**

```
DispatchQueue.main.asyncAfter(deadline: .now() + 1.0) {
    print("do some work")
} 
```

或通过`escaping closure`

```
func delay(seconds: Double, completion: @escaping()-> Void) {
    DispatchQueue.main.asyncAfter(deadline: .now() + seconds, execute: completion)
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-10-04T06:32:38.453

已检查的解决方案中有一个 Swift 3 解决方案：

```
self.perform(#selector(self.targetMethod), with: self, afterDelay: 1.0) 
```

还有方法

```
@objc fileprivate func targetMethod(){

} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-08-29T13:09:22.423

在 Swift 3 中使用

```
perform(<Selector>, with: <object>, afterDelay: <Time in Seconds>) 
```

* * *

## 回答 #11

> 赞同：-35
> 
> 时间：2009-05-28T12:57:05.553

**注意：这将暂停您的整个线程，而不仅仅是一种方法。**
在调用您的方法之前调用 sleep/wait/halt 1000 ms？

```
Sleep(1000); // does nothing the next 1000 mSek

Methodcall(params); // now do the real thing 
```

编辑：上述答案适用于一般问题“如何将方法调用延迟 1 秒？”，这是在回答时提出的问题（实际上答案是在原始问题的 7 分钟内给出的：- ））。当时没有提供有关该语言的信息，所以请不要再抱怨使用睡眠 i XCode og 缺少类的正确方法...

# asp.net - 如何在客户端计算 RadGrid 单元格值？

> ID：920682
> 
> 赞同：1
> 
> 时间：2009-05-28T12:54:23.563
> 
> 标签：asp.net, javascript, jquery, telerik, radgrid

我有 Telerik RadGrid，它处于编辑模式。每个单元格都包含 NumericTextBox。是否可以根据同一行中的其他单元格计算一个单元格（在客户端）。例如，如果我有一行包含价格和项目等单元格，我希望在每次更改时计算总价，但在客户端，而不是在服务器端。RadGrid 可以做到这一点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T09:05:57.640

感谢您的所有回答，但我在[Telerik forum](http://www.telerik.com/community/forums/aspnet/grid/i-have-telerik-radgrid-which-is-in-edit-mode-each-cell-contains-numerictextbox-is-it-possible-to-calculate-one-cell-based-on-other-cells-in-the-same-r.aspx)找到了解决方案。我将在此处粘贴解决方案，以防有人遇到同样的问题。

ASPX：

```
<Columns> 
    <rad:GridTemplateColumn UniqueName="Price" HeaderText="Price">
    <EditItemTemplate> 
        <radI:RadNumericTextBox ID="txtPrice" runat="server">  
        </radI:RadNumericTextBox> 
    </EditItemTemplate> 
    </rad:GridTemplateColumn> 
    <rad:GridTemplateColumn UniqueName="Quantity" HeaderText=" Number of Items">  
    <EditItemTemplate> 
        <radI:RadNumericTextBox ID="txtQuantity" runat="server">  
        </radI:RadNumericTextBox> 
    </EditItemTemplate> 
    </rad:GridTemplateColumn> 
    <rad:GridTemplateColumn UniqueName="TotalAmount" HeaderText="Total">
    <EditItemTemplate> 
        <radI:RadNumericTextBox ID="txtTotalAmount" runat="server">  
        </radI:RadNumericTextBox> 
    </EditItemTemplate> 
    </rad:GridTemplateColumn> 
</Columns> 
```

C＃

```
 protected void RadGrid1_ItemDataBound(object sender, GridItemEventArgs e)  
    {  

    if (e.Item is GridDataItem && e.Item.IsInEditMode)  
    {  
        GridDataItem item = (GridDataItem)e.Item;  
        RadNumericTextBox txtPrice= item.FindControl("txtPrice") as RadNumericTextBox;       // Get the textbox for column Price   
        RadNumericTextBox txtQuantity= item.FindControl("txtQuantity") as RadNumericTextBox;    // Get the textbox for column Quantity     
        RadNumericTextBox txtTotalAmount= item.FindControl("txtTotalAmount") as RadNumericTextBox; // Get the textbox for column "TotalAmount", if it is template as shown in aspx    

        txtPrice.Attributes.Add("onFocusout", "return calculate('" + txtPrice.ClientID + "','" + txtQuantity.ClientID + "','" + txtTotalAmount.ClientID + "')");  
        txtQuantity.Attributes.Add("onFocusout", "return calculate('" + txtPrice.ClientID + "','" + txtQuantity.ClientID + "','" + txtTotalAmount.ClientID + "')");  
        txtTotalAmount.Attributes.Add("onfocus", "return calculate('" + txtPrice.ClientID + "','" + txtQuantity.ClientID + "','" + txtTotalAmount.ClientID + "')");  
    }  
} 
```

JavaScript：

```
<script type="text/javascript">  
function calculate(price, quantity, totalAmount)   
{  
    var text1 = $find(price); //I used Asp.net Ajax find method
    var text2 = $find(quantity);  
    var text3 = $find(totalAmount);  
    var total = text1.GetValue() * text2.GetValue();  
    text3.SetValue(total);  
}  
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T12:58:22.010

如果您也通过客户端绑定（最有可能通过 AJAX）获取数据，则有可能。如果是这样，您应该能够从网格的数据源属性中获取所有值。如果绑定数据服务器端，它会变得更难，因为在这种情况下，当前网格不会构建客户端数据源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:32:51.660

从 RadGrid -> 应用程序场景部分查看 Telerik 网站上的演示，该部分使用数字文本框并说明您正在寻找什么，伙计。

迪克

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T00:23:10.973

因为每个项目都在一个表格行中，您可以使用 javascript 来查找父项目，然后遍历所有输入以找到您正在寻找的那些？如果您打算使用 jQuery，这应该是可能的，并且如果您想轻松区分文本框，您可以将 CssClass 应用于每个 TextBox？

# language-agnostic - 点相对于贝塞尔曲线的位置

> ID：920687
> 
> 赞同：10
> 
> 时间：2009-05-28T12:55:36.417
> 
> 标签：language-agnostic, geometry, bezier

我有一条由 4 个点指定的贝塞尔曲线。我需要知道一个点是在贝塞尔曲线的左侧还是右侧。你能给我推荐一个算法吗？

*编辑：*我确信*我生成*贝塞尔曲线的方式不会形成循环。

*后来编辑*我意识到我最初的问题可以在不使用相对位置的情况下解决。当我发布这个问题时，我在想有一个相对位置的数学公式，类似于检查一个点是否在圆的内部。似乎这是不可能的。所以我会接受答案，这将提出一个省时的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T08:14:45.750

您可以使用非常简单的算法（与 k 细分相关。DeCastleju 算法）确定贝塞尔曲线上的最近点。如果您需要详细信息，请查看图形宝石。

此时，即使使用循环，您也可以通过确定从最近点到测试点的向量是否位于沿曲线的向量的左侧（速度？ - 不确定此处的正确术语...）您确定的最近点的贝塞尔曲线。

您可以通过两个向量的叉积来获得 -that-。消极或积极将决定你的左手习惯和你在哪一边。

当然，在一个循环中，侧向性将被定义为好像你是一辆沿着线路行驶的汽车，当你经过时你是在看右边还是左边的窗户……如果你在右边或右边整个贝塞尔曲线的左侧。所以这取决于你如何定义“侧向”

抱歉，如果我的条款不适用。自从我不得不对 Bezier 做任何事情以来已经有一段时间了

画图会更容易；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:28:22.480

如果您只是希望您的对象遵循曲线（正如您在评论中所说），为什么不使用参数方程移动您的对象？[看这篇文章](http://en.wikipedia.org/wiki/B%C3%A9zier_curve#Linear_B.C3.A9zier_curves)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-20T13:16:15.737

[这是三次和二次贝塞尔曲线隐式化的数学](http://research.microsoft.com/en-us/um/people/cloop/loopblinn05.pdf)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:05:04.353

我不记得这么晚的数学了，但是您可能希望对曲线使用细分算法来逐步细化它，直到线段“直”到可以将它们视为线段以供您确定.

您可以通过使用曲线细化的边界多面体来确定您的“点”在所有多面体之外的哪个点，然后立即展平为线段，从而获得更快的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T07:57:14.117

假设点约束到曲线，你必须定义一个锚点作为起点，另一个作为终点，然后计算一个属于曲线并且在中间（长度的一半）的点......这样你就可以说点是在开始和中间还是中间和结束之间。

这是你想要的还是我完全迷路了？

# ios - 圆形滚动视图

> ID：920694
> 
> 赞同：1
> 
> 时间：2009-05-28T12:56:40.393
> 
> 标签：ios, objective-c, scroll, treeview, carousel

我已经实现了一个圆形滚动视图。

它工作正常，但有时滚动视图代表没有被调用。

我已经附上了代码，其中的错误是什么......

```
//
//  MyScrollViewViewController.h
//  MyScrollView
//
//  Created by Biranchi on 26/05/09.
//  Copyright PurpleTalk 2009\. All rights reserved.
//

#import <UIKit/UIKit.h>

@interface MyScrollViewViewController : UIViewController <UIScrollViewDelegate> {

    IBOutlet UIScrollView *scrollView;
    IBOutlet UIView *view1;
    IBOutlet UIView *view2;
    IBOutlet UIView *view3;

    IBOutlet UILabel *label1;
    IBOutlet UILabel *label2;
    IBOutlet UILabel *label3;

    int viewAtIndex;
    int currentOffset;
    int firstOffset, lastOffset;
    int currentContentInset;
    int tempOffset;

    NSMutableArray *arr;
}

@end

//
//  MyScrollViewViewController.m
//  MyScrollView
//
//  Created by Biranchi on 26/05/09.
//  Copyright PurpleTalk 2009\. All rights reserved.
//

#import "MyScrollViewViewController.h"

@implementation MyScrollViewViewController

// The designated initializer. Override to perform setup that is required before the view is loaded.
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
    if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {
        // Custom initialization
    }

    return self;
}

/*
// Implement loadView to create a view hierarchy programmatically, without using a nib.
- (void)loadView {
}
*/

//static int j = 0;

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {

    arr = [[NSMutableArray alloc] init];

    [arr addObject:view1];
    [arr addObject:view2];
    [arr addObject:view3];

    //NSLog(@"arr : %@", arr);

    scrollView.minimumZoomScale = 1.0f;
    scrollView.maximumZoomScale = 2.0f;
    scrollView.delegate = self;
    //scrollView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;

    firstOffset = 0;
    currentOffset = 320;
    lastOffset = 640;
    currentContentInset = 320;

    CGRect frame;

    //Scroll View

    frame = [view1 frame];
    [view1 setBackgroundColor:[UIColor redColor]];
    frame.origin.x = 0;
    [view1 setFrame:frame];

    frame = [view2 frame];
    [view2 setBackgroundColor:[UIColor greenColor]];
    frame.origin.x = 320;
    [view2 setFrame:frame];

    frame = [view3 frame];
    [view3 setBackgroundColor:[UIColor blueColor]];
    frame.origin.x = 640;
    [view3 setFrame:frame];

    [scrollView addSubview:view1];
    [scrollView addSubview:view2];
    [scrollView addSubview:view3];

    [scrollView setContentSize:CGSizeMake(3*320, 480)];
    [scrollView setContentOffset: CGPointMake(currentOffset,0) animated:NO];

    [self.view addSubview:scrollView];

    //NSLog(@"Self.view Subviews : %@", [self.view subviews]);
}

#pragma mark -
#pragma mark ScrollView Delegate 

- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView1
{
    NSLog(@"Will begin dragging ===");

    CGPoint offset = [scrollView1 contentOffset];
    tempOffset = offset.x;
    NSLog(@"Offset : %@", NSStringFromCGPoint(offset));

}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView1
{
    NSLog(@"ScrollView did end decelerating ");

    int i, result;

    CGPoint offset = [scrollView1 contentOffset];
    currentOffset = offset.x;
    NSLog(@"Offset : %@", NSStringFromCGPoint(offset));

    if( ( (currentOffset - tempOffset) > 0 ) || ( (currentOffset == tempOffset) && (currentOffset == lastOffset) ) )
    {
        NSLog(@"Show next page , current : %d, temp : %d", currentOffset, tempOffset);  

        for(i=0; i<[arr count]; i++)
        {
            if( [[arr objectAtIndex:i] frame].origin.x == currentOffset )
            {
                NSLog(@"Current view on screen : %d", i);
                break;
            }
        }

        NSLog(@"Before Current offset : %d, last offset : %d", currentOffset, lastOffset);

        if( currentOffset == lastOffset )
        {
            result = i-2;

            if(result < 0)
            {
                result += 3;    
            }

            NSLog(@"Change the frame of object at index : %d", result);

            [[arr objectAtIndex:result] setFrame:CGRectMake(currentOffset + 320, 0, 320, 480)];
            [scrollView1 setContentSize:CGSizeMake(currentOffset+640,480) ];
            lastOffset += 320;
            firstOffset += 320;
        }

        NSLog(@"Current offset : %d, first offset : %d , last offset : %d", currentOffset, firstOffset,  lastOffset);

    }
    else if(  ( (currentOffset - tempOffset) < 0 ) || ( (currentOffset == tempOffset) && (currentOffset == firstOffset) ) ) 
    {
        //NSLog(@"Show prev page"); 

        for(i=0; i<[arr count]; i++)
        {
            if( [[arr objectAtIndex:i] frame].origin.x == currentOffset )
            {
                NSLog(@"==Current view on screen : %d", i);
                break;
            }
        }

        NSLog(@"==Before Current offset : %d, First offset : %d", currentOffset, firstOffset);

        if( currentOffset == firstOffset )
        {
            result = i+2;

            if(result >= 3)
            {
                result -= 3;    
            }

            NSLog(@"==Change the frame of object at index : %d", result);

            [[arr objectAtIndex:result] setFrame:CGRectMake(currentOffset - 320, 0, 320, 480)];

            UIEdgeInsets contentInset = {0,currentContentInset,0,0};
            [scrollView1 setContentInset:contentInset ];

            firstOffset -= 320;
            currentContentInset += 320;
            lastOffset -= 320;
        }

        NSLog(@"==Current offset : %d, first offset : %d, Last Offset : %d", currentOffset, firstOffset, lastOffset);

    }
    else 
    {
        NSLog(@"Error in offset");
    }

}

- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView1
{
    return [[scrollView1 subviews] objectAtIndex:viewAtIndex];  
}

- (void)scrollViewDidEndZooming:(UIScrollView *)scrollView1 withView:(UIView *)view atScale:(float)scale
{
    //NSLog(@"View Zoomed : %@, scale : %f", view, scale);
}

#pragma mark -

/*
// Override to allow orientations other than the default portrait orientation.
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    // Return YES for supported orientations
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}
*/

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning]; // Releases the view if it doesn't have a superview
    // Release anything that's not essential, such as cached data
}

- (void)dealloc {
    [arr release];
    [super dealloc];
}

@end 
```

# actionscript-3 - actionscript 3中基本声音功能的一些帮助

> ID：920704
> 
> 赞同：0
> 
> 时间：2009-05-28T12:59:43.320
> 
> 标签：actionscript-3, audio

我正在开发一个 mp3 播放器，而且我对所有闪存都非常陌生，所以有很多问题。目前我被困在轨道变化上。我的变量声明如下所示：

```
var index:int = -1;  
var music:Sound = new Sound(new URLRequest("moe2008-05-24d02t02_vbr.mp3"));  
var sc:SoundChannel;  
var isPlaying:Boolean = false; 
```

我的更改跟踪功能如下所示：

```
function changeTrack(newTrack){  
    sc.stop();
    isPlaying = false;
    music = new Sound(new URLRequest(newTrack));
    sc = music.play();
    isPlaying = true;
    index++; 
} 
```

有没有人看到任何明显的错误？？？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-27T06:28:57.280

在我看来，您缺少将外部声音实际*加载*到新声音对象中的部分。您的示例似乎正在重用相同的声音对象。应该是这样的：

```
var sound:Sound = new Sound();
var request:URLRequest = new URLRequest("path/to/your/sound");

sound.load(request);

sc = sound.play(); 
```

您需要本地声音变量来创建新声音，因为无法将另一个声音实例加载到现有实例中：

> 在 Sound 对象上调用 load() 后，您以后不能将不同的声音文件加载到该 Sound 对象中。要加载不同的声音文件，请创建一个新的 Sound 对象。

您可能希望使用字典来跟踪已加载的声音。因此，当调用此方法时，您检查是否在字典中注册了声音对象，如果是，则播放该对象而不是加载文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-26T12:33:01.110

我认为您应该在创建新连接之前尝试关闭声音连接（Sound.close()）。另外，我会使用相同的 Sound 对象来加载新文件（Sound.load()）以避免可能的 GC 问题（除非您需要在声音之间淡入）...

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-07-01T08:54:54.437

> 正如 Flash Gordon 所说：“当你重置它的属性时，你实际上是在重新定义局部变量。” [http://www.actionscript.org/forums/archive/index.php3/t-181659.html](http://www.actionscript.org/forums/archive/index.php3/t-181659.html)

这条线看起来有点可疑。

```
sc = music.play(); 
```

那不应该是：

```
var musicPlay = music.play();
sc = musicPlay; 
```

# erlang - Erlang 作为后端进程

> ID：920706
> 
> 赞同：3
> 
> 时间：2009-05-28T12:59:51.743
> 
> 标签：erlang

我想使用 Erlang 进行一些后台处理和网络应用程序的东西。我阅读了它的并发处理和东西，我已经开始学习它。我特别想做的是使用 COMET 与客户端建立持久连接——Erlang 进程协调 HTTP 客户端连接。

1.  我需要一个基于 Erlang 的网络服务器吗？
2.  对于实际的实现，Erlang 中的“spawn”是如何工作的。我下载了 erlang 电子书并阅读了有关产卵的信息。对于我的基于 Web 的脚本，当两个客户端通过发出 HTTP 请求连接到同一个 Erlang 脚本时——我可以为每个客户端自动“生成”新线程并进行消息传递吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T13:37:35.223

1.  不，你没有，但这是最简单的方法。你可以结合 Erlang`libevent`来实现更多[http://www.metabrew.com/article/a-million-user-comet-application-with-mochiweb-part-3/](http://www.metabrew.com/article/a-million-user-comet-application-with-mochiweb-part-3/)
2.  是的，spawn new client 很便宜，如果您想更便宜，请参见上文。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T19:47:32.510

我强烈建议使用基于 erlang 的网络服务器来处理彗星连接。erlang 中的轻量级进程是将它用于此类事情的一半好处。

大多数 erlang 网络服务器框架将为您处理生成。无需自己重新实现。有关非常简单的彗星实现的示例，请参见[氮](http://github.com/rklophaus/nitrogen/tree/master)和[mochiweb 。](http://github.com/toddlipcon/mochiweb/tree/master)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-03T15:43:52.467

您看到页面[http://beebole.com/erlang](http://beebole.com/erlang)了吗？

它包含：

*   如何在 Ubuntu 上设置 Erlang 环境（使用 Mochiweb）

*   如何安装 Nginx 网络服务器

*   使用 Erlang 构建小型 Web 应用程序的视频教程

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-10T14:51:19.040

您应该研究“YAWS”（高性能 HTTP 服务器）模块：易于编写，完全灵活。YAWS 很容易安装：*apt-get install yaws* （至少在 Ubuntu 上）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-11T23:37:40.510

另一种选择是使用[Nitrogen](http://nitrogenproject.com/) - 这允许在网页中轻松集成 Erlang 代码，包括成熟的网络服务器和彗星。

# oracle - 将 3954275 插入语句导入 Oracle 10g

> ID：920707
> 
> 赞同：3
> 
> 时间：2009-05-28T12:59:57.873
> 
> 标签：oracle, sqlplus

如何将具有 3954275 行插入语句的脚本导入 Oracle 10g。我可以这样做，`sqlplus user/pass @ script.sql`但这太慢了（更糟糕的是，提交是在这个 900MB 文件的末尾。我不知道我的 Oracle 配置是否可以处理这个问题）。有没有更好（更快）的方式来导入数据？顺便提一句。导入前数据库为空。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T13:02:22.033

使用[`SQL*Loader`](http://download.oracle.com/docs/cd/B14117_01/server.101/b10825/part_ldr.htm).

`INSERT`如果您没有其他格式的数据，它甚至可以解析您的命令。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T20:04:30.060

如果您的 900MB 文件包含对同一个表的插入语句，SQL*Loader 是一个不错的选择。如果它包含许多表会很麻烦。然而，这是最快的选择。

如果由于某种原因稍微改进就足够了，那么请确保您的会话 CURSOR SHARING 参数设置为 FORCE 或 SIMILAR。除了值之外，文件中的每个插入语句都可能相同。如果 CURSOR_SHARING 设置为 EXACT，那么每个插入语句都需要进行硬解析，因为它是唯一的。FORCE 和 SIMILAR 会自动将 VALUES 子句中的文字转换为绑定变量，从而无需一遍又一遍地进行硬解析。

您可以使用以下脚本对此进行测试：

```
set echo on
alter system flush shared_pool
/
create table t
( id   int
, name varchar2(30)
)
/
set echo off
set feedback off
set heading off
set termout off
spool sof11.txt
prompt begin
 select 'insert into t (id,name) values (' || to_char(level) || ', ''name' || to_char(level) || ''');'
   from dual
connect by level <= 10000
/
prompt end;;
prompt /
spool off
set termout on
set heading on
set feedback on
set timing on
@sof11.txt
set timing off
alter session set cursor_sharing = force
/
set timing on
@sof11.txt
set timing off
alter session set cursor_sharing = exact
/
set echo off
drop table t purge
/ 
```

该示例执行 10,000 条语句，例如“insert into t (id,name) values (1, 'name1');”。我的笔记本电脑上的输出：

```
SQL> alter system flush shared_pool
  2  /

Systeem is gewijzigd.

SQL> create table t
  2  ( id   int
  3  , name varchar2(30)
  4  )
  5  /

Tabel is aangemaakt.

SQL> set echo off

PL/SQL-procedure is geslaagd.

Verstreken: 00:00:17.10

Sessie is gewijzigd.

PL/SQL-procedure is geslaagd.

Verstreken: 00:00:05.50 
```

将 CURSOR_SHARING 设置为 FORCE 时速度提高 3 倍以上。

希望这可以帮助。

问候，罗布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:09:14.687

同意上述观点：**使用 SQL*Loader**。

但是，如果这不是一个选项，您可以通过放置语句来调整 SQL Plus 引入的块的大小

```
SET arraysize 1000; 
```

在脚本的开头。这只是我自己的脚本中的一个示例，考虑到延迟等，您可能需要根据您的需要对其进行微调。我认为它默认为 15，因此您的脚本会产生很多开销。

# standards - PHP/C/C++ - 您的初始注释块在您的程序中的外观如何？

> ID：920712
> 
> 赞同：3
> 
> 时间：2009-05-28T13:01:32.223
> 
> 标签：standards, coding-style, comments

我正在进行一个大型项目，还没有在我的程序中真正发表任何评论“标题”。前几天我刚开始在项目中使用 SVN。我想添加 SVN 标签 $id$，但尚未决定任何标准评论。

所以，我对这里的每个人的问题是，您的初始评论块在您的所有程序中看起来如何？

IE：

```
/***************************************
* myProgram.c 
* revision: $id$
***************************************/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T13:02:49.490

我一个都不用。我不需要一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T13:12:30.203

[我个人使用与javadoc](http://java.sun.com/j2se/javadoc/writingdoccomments/)相同的注释

```
/**
 * Your comment here 
 */ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:09:25.263

这取决于，但我不喜欢他们太花哨。这样的事情对我来说就足够了：

```
/*
 * 文件.c
 *
 * 描述：
 *
 * 历史：
 *
 *
 */

```

任何更复杂的事情都只是烦人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:07:32.103

公司样板版权+文件作者/所有者和相关的小目的部分（例如：当文件包含具有自己标题的小型相关类的集合时）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T13:08:23.940

如果我正在编写一些开源程序，我通常会添加 BSD 许可证，否则没有标准的标题注释。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T13:12:17.537

看看这些问题：

*   [您是否将信息添加到每个 .hpp/.cpp 文件的顶部？](https://stackoverflow.com/questions/318835/do-you-add-information-to-the-top-of-each-hpp-cpp-file)
*   [代码中的注释页眉和页脚真的有必要吗？](https://stackoverflow.com/questions/718783/are-comment-headers-and-footers-in-your-code-really-necessary)
*   [Java源文件中注释的最佳实践？](https://stackoverflow.com/questions/921050/best-practice-for-comments-in-java-source-files)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T13:16:43.877

如果您有版本跟踪软件，任何初始评论块都是浪费空间。

# jquery - jQuery：动画后div弹回全尺寸

> ID：920718
> 
> 赞同：2
> 
> 时间：2009-05-28T13:02:32.580
> 
> 标签：jquery, animation, resize, width

在下面的 jQuery 示例中，我在另一个 div 中有一个 div。当我将内部 div 设置为宽度为 0 时，外部 div（具有绝对定位）的宽度会随之减小。

这是所希望的。

麻烦的是动画完成后，外层div弹回原来的大小。这是预期的吗？我怎样才能防止这种情况发生？

谢谢！

**例子**

*html:*

```
<div class="outer"><div class="inner">innerContent</div></div> 
```

* * *

*CSS：*

```
div.outer {
    position: absolute;
    padding: 10px;
    background: purple;
}

div.inner {
    position: relative;
    padding-left: 5px;
    padding-right: 5px;
    background: orange;
    clip: auto; overflow: hidden;
} 
```

* * *

*javascript:*

```
$('.outer').click(function() { 
    $('.inner').animate({width: 0, paddingLeft: 0, paddingRight: 0}, 'slow');
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T13:46:21.807

看起来如果我抓住“外部”div的宽度和“内部”div的outerWidth，然后从“内部”div的outerWidth中减去“外部”div的宽度，并将“外部”宽度设置为动画结果同时将“内部”设置为 0，它可以工作。

关于这是否应该是 jquery 或 webkit 或两者的错误修复请求的任何意见。

```
$('.outer').click(function() { 
    var innerWidth = $('.inner').outerWidth();
    var outerWidth = $('.outer').width();
    var theWidth = outerWidth - innerWidth;
    $('.inner').animate({width: 0, paddingLeft: 0, paddingRight: 0}, 'slow' );
    $('.outer').animate({width: theWidth}, 'slow');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:15:32.647

动画完成后是否尝试将外框宽度设置为 0？

```
$('.inner').animate({width: 0, paddingLeft: 0, paddingRight: 0}, 'slow', function() {
  $('.outer').css("width", 0);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:18:44.513

对于我在 Firefox 3.0.10 中使用 Ubuntu 9.04 中的 jQuery 1.3.2 来说，这非常有效。可能是与页面中其他 html 元素的某种交互？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:23:09.903

在我的测试中，这在 IE、FF 和 Opera 中运行良好，但会产生您在 Chrome 和 Safari 中提到的错误。

# ruby - 如何仅将 Rack 中间件用于某些路径？

> ID：920719
> 
> 赞同：19
> 
> 时间：2009-05-28T13:02:37.010
> 
> 标签：ruby, rack, middleware

我想`MyMiddleware`在我的 Rack 应用程序中运行，但仅限于某些路径。我希望使用`Rack::Builder`or 至少`Rack::URLMap`，但我不太清楚如何使用。

这是我认为可行的，但没有：

```
# in my rackup file or Rails environment.rb:
map '/foo' do
  use MyMiddleware, { :some => 'options' }
end 
```

或者，更好的是，使用正则表达式：

```
map /^foo/ do
  use MyMiddleware, { :some => 'options' }
end 
```

但`map`似乎最后需要一个应用程序；它不会仅仅依靠将控制权传回其父级。`undefined method 'each' for nil:NilClass`（当 Rack 试图将该`do...end`块的末尾变成. 时，实际的错误是“ ” `app`。）

是否有一个中间件接受一组中间件和一个路径，并且只有在路径匹配时才运行它们？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-07-28T16:55:07.973

您可以让 MyMiddleware 检查路径，如果匹配，则不将控制权传递给下一个中间件。

```
class MyMiddleware
  def initialize app
    @app = app
  end
  def call env
    middlewary_stuff if env['PATH_INFO'] == '/foo'
    @app.call env
  end

  def middlewary_stuff
    #...
  end
end 
```

或者，您可以使用不带 dslness 的 URLMap。它看起来像这样：

```
main_app = MainApp.new
Rack::URLMap.new '/'=>main_app, /^(foo|bar)/ => MyMiddleWare.new(main_app) 
```

URLMap 实际上[很容易理解](http://github.com/rack/rack/blob/1785a44d3a97cb38b4b197b5cb66bd86093bf438/lib/rack/urlmap.rb)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-28T16:58:45.457

这不起作用，因为`@app`不存在于正确的范围内：

```
# in my_app.ru or any Rack::Builder context:
@app = self
map '/foo' do
  use MyMiddleware
  run lambda { |env| @app.call(env) }
end 
```

但这将：

```
# in my_app.ru or any Rack::Builder context:
::MAIN_RACK_APP = self
map '/foo' do
  use MyMiddleware
  run lambda { |env| ::MAIN_RACK_APP.call(env) }
end 
```

`Rack::Builder`将第一个参数`map`从路径的前面剥离，因此它不会无休止地递归。不幸的是，这意味着在去除该路径前缀之后，路径的其余部分不太可能正确匹配其他映射。

这是一个例子：

```
::MAIN_APP = self
use Rack::ShowExceptions
use Rack::Lint
use Rack::Reloader, 0
use Rack::ContentLength

map '/html' do
  use MyContentTypeSettingMiddleware, 'text/html'
  run lambda { |env| puts 'HTML!'; ::MAIN_APP.call(env) }
end

map '/xml' do
  use MyContentTypeSettingMiddleware, 'application/xml'
  run lambda { |env| puts 'XML!'; ::MAIN_APP.call(env) }
end

map '/' do
  use ContentType, 'text/plain'
  run lambda { |env| [ 200, {}, "<p>Hello!</p>" ] }
end 
```

转到`/html/xml`会导致以下内容进入日志：

```
HTML!
XML!
127.0.0.1 - - [28/May/2009 17:41:42] "GET /html/xml HTTP/1.1" 200 13 0.3626 
```

也就是说，映射到前缀`'/html'`条的应用程序现在与映射到的应用程序匹配。`'/html'``'/xml'`

# python - 自动过滤 SQLAlchemy 查询的正确方法？

> ID：920724
> 
> 赞同：8
> 
> 时间：2009-05-28T13:03:37.757
> 
> 标签：python, sqlalchemy, sugarcrm

我刚刚用 sqlalchemy 从 CRM 应用程序中反省了一个非常讨厌的模式。所有表都有一个已删除的列，我想自动过滤所有标记为已删除的实体和关系。这是我想出的：

* * *

```
class CustomizableQuery(Query):
    """An overridden sqlalchemy.orm.query.Query to filter entities

    Filters itself by BinaryExpressions
    found in :attr:`CONDITIONS`
    """

    CONDITIONS = []

    def __init__(self, mapper, session=None):
        super(CustomizableQuery, self).__init__(mapper, session)
        for cond in self.CONDITIONS:
            self._add_criterion(cond)

    def _add_criterion(self, criterion):
        criterion = self._adapt_clause(criterion, False, True)
        if self._criterion is not None:
            self._criterion = self._criterion & criterion
        else:
            self._criterion = criterion 
```

它是这样使用的：

```
class UndeletedContactQuery(CustomizableQuery):
    CONDITIONS = [contacts.c.deleted != True]

    def by_email(self, email_address):
        return EmailInfo.query.by_module_and_address('Contacts', email_address).contact

    def by_username(self, uname):
        return self.filter_by(twod_username_c=uname).one()

class Contact(object):
    query = session.query_property(UndeletedContactQuery)

Contact.query.by_email('someone@some.com') 
```

EmailInfo 是映射到电子邮件与其相关的其他模块之间的连接表的类。

这是一个映射器的例子：

```
contacts_map = mapper(Contact, join(contacts, contacts_cstm), {
    '_emails': dynamic_loader(EmailInfo,
                              foreign_keys=[email_join.c.bean_id],
                              primaryjoin=contacts.c.id==email_join.c.bean_id,
                              query_class=EmailInfoQuery),
    })

class EmailInfoQuery(CustomizableQuery):

    CONDITIONS = [email_join.c.deleted != True]
    # More methods here 
```

* * *

这给了我我想要的，因为我已经过滤掉了所有已删除的联系人。我也可以在我的映射器中将它用作 dynamic_loader 的 query_class 参数 - 但是......

1.  有没有更好的方法来做到这一点，我并不喜欢像我一样探索像 Query 这样的复杂类的内部结构。
2.  有没有人以不同的方式解决了这个问题，他们可以分享？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T13:11:18.677

您可以映射到一个选择。像这样：

```
mapper(EmailInfo, select([email_join], email_join.c.deleted == False)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T11:22:27.307

我会考虑看看是否可以为这些表创建过滤掉已删除元素的视图，然后您可以直接映射到该视图而不是基础表，至少对于查询操作。但是我自己从来没有试过这个！

# java - Liferay 集群

> ID：920725
> 
> 赞同：2
> 
> 时间：2009-05-28T13:03:38.273
> 
> 标签：java, glassfish, liferay

您知道有关在 Glassfish 中安装 Liferay 集群的分步教程吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T13:27:54.760

谷歌为我找到了这篇名为[how-to-install-and-configure-a-liferay-cluster 的文章](http://www.randombugs.com/java/glassfish/how-to-install-and-configure-a-liferay-cluster.html)

享受！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-25T17:14:10.247

我正在解决同样的问题，或者非常相似的问题——将 Liferay WAR 文件部署到具有两个节点的 glassfish 集群。我还没有完全正确地配置它，但我确实成功部署了它。也许这也会对您有所帮助，我们可以比较笔记。

这是我必须做的。

第一，基础。GlassFish 部署 WAR 的方式对我来说有点奇怪。据我了解，WAR 文件是由节点代理在某处爆炸的，但是一旦它们被部署，您就无法访问这些文件。这意味着当您调整配置文件（portal-ext.properties）时，您每次都需要重新部署——Liferay 相当大，约为 73MB。这将定期导致 PermGen 空间不足异常，并要求您重新启动集群。因此，明智的做法是设置 JVM 选项以增加 glassfish 中 PermGen 空间的大小。这里有一个很好的问题解释：

[http://www.freshblurbs.com/explaining-java-lang-outofmemoryerror-permgen-space](http://www.freshblurbs.com/explaining-java-lang-outofmemoryerror-permgen-space)

该 JVM 选项不会解决问题，但会增加集群重新启动之间的延迟（glassfish 控制台无法重新启动，顺便说一句；我们必须通过命令行来完成）。

下一个问题是：依赖 JAR 文件在哪里？我们在运行其他服务的共享集群中运行，因此将其放在 domain/domain1/lib 文件夹中是行不通的。我们将依赖项 JAR 文件放在 liferay war 文件中，在 WEB-INF/lib 中，它似乎对此很满意。

下一篇：portal-ext.properties 覆盖文件到哪里去了？答案再次在 WEB-INF/classes 中的 liferay 战争文件中。这也是我们每次修改属性时都需要重新部署的一个重要原因，如上所述。

下一个：上下文。默认情况下，liferay 尝试部署到根上下文“/”。我们处于共享环境中，因此我们将 WAR 部署到上下文 /lr1。在 portal-ext.properties 我们必须设置属性

> 门户网站.ctx=/lr1

下一篇：在集群环境中使用嵌入式HSQL没有多大意义；我们使用 GlassFish 为我们的数据库连接池设置了一个 JNDI 名称。Liferay 文档指南中有关于如何执行此操作的说明。在 portal-ext.properties 文件中，我们可以将

> jdbc.default.jndi.name=jdbc/LiferayPool

我们也不想在文件系统上存储 Lucene 索引。我们在 portal-ext.properties 文件中覆盖了这些属性来解决这个问题：

> lucene.store.type=jdbc
> 
> lucene.store.jdbc.auto.clean.up=true
> 
> lucene.store.jdbc.dialect.oracle=org.apache.lucene.store.jdbc.dialect.OracleDialect

类似的逻辑适用于 JackRabbit 存储库；我目前有以下属性设置（我不知道这是否正确，但文档库正在工作）：

> jcr.jackrabbit.repository.root=WEB-INF/classes/

我也必须将 jackrabbit 的 repository.xml 文件放入 WEB-INF/classes 中。该 xml 文件告诉 jackrabbit 使用哪些数据库连接参数（有关更多详细信息，请参阅 Apache 的 Jackrabbit 配置页面）。同样，我不确定将它放在 WEB-INF/classes 中是否正确，但它可能必须放在 WAR 文件中的某个位置，或者位于某个共享文件系统上，以便集群中的所有节点共享相同的数据.

我还没有弄乱 EHcache，但我确实放入了 hibernate 属性：

> hibernate.dialect=org.hibernate.dialect.Oracle10gDialect

对于我们的 oracle 数据库。我相信它使用上面的默认 JDBC 属性来引用我们的 JNDI 数据库连接。

“Liferay 主目录”变量是“服务器主目录上方的一个文件夹”的概念是我仍在努力解决的问题，它导致我每次发送与 /opt/ee/license 相关的 HTTP 请求时都会出错.

liferay 运行的用户没有修改/opt 的权限，在任何情况下，这在集群环境中都是一个坏主意。我不确定设置在哪里，因为当我查看时，我看到的只是

> liferay.home=${resource.repositories.root}

和

> resource.repositories.root=${default.liferay.home}

我还不知道 default.liferay.home 是在哪里定义的；仍在努力。

不幸的是，将 liferay 部署到集群环境还没有很好的文档记录，但我希望分享这些对您有所帮助。

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T13:19:14.200

Liferay 是一个与服务器无关的 Spring / Hibernate 应用程序，您的大部分集群配置应该是您的门户（-ext）.properties 文件的集群部分：Hibernate、EHCache 和 JGroup 配置。唯一的应用服务器特定配置应该是会话故障转移，就像在部署的任何 Web 应用中一样。

# sql - 纠正数据层的错误处理实践

> ID：920728
> 
> 赞同：0
> 
> 时间：2009-05-28T13:04:56.367
> 
> 标签：sql, vb.net, stored-procedures

在处理数据访问层时，关于错误处理，有哪些好东西需要检查？例如，假设我有这个功能..

```
 Public Function UserExists(ByVal userName As String) As DataTable
        Dim dt As Object = Nothing
        Dim arSqlParameters(0) As SqlParameter
        arSqlParameters(0) = New SqlParameter("@UserName", SqlDbType.NVarChar, 50)
        arSqlParameters(0).value = userName
        dt = ABC.APP.DAL.DALHelper.ExecuteDatatable(ConnectionString, CommandType.StoredProcedure, "dbo.aspnet_sprGetUserByUsername", arSqlParameters)
        Return dt
    End Function 
```

这似乎是非常懒惰和不安全的编码。在这种情况下，您将如何确保您的代码优雅地处理任何意外情况？

我是 vb.net 的新手，我正在开发的应用程序没有错误处理，所以我认为这将是寻求建议的最佳场所。提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T13:14:44.147

对于这样的话题，意见可能会大相径庭，但这是我的看法。仅尝试处理与该区域相关的异常。这是一个模糊的陈述，但我的意思是，用户传递的字符串是否比数据库中的列多。或者他们是否违反了其他一些商业规则。

我*不会*在这里捕获暗示数据库已关闭的错误。在代码中，您可以捕获可以处理的错误，并且您的应用程序需要它的数据库。声明一个更全局的异常处理程序来记录问题，通知某人，无论如何......并向用户呈现“优雅”的退出。

我认为在每种方法中发现数据库问题没有任何价值。您只是在为可能会炸毁数据层任何部分的场景重复代码。话虽这么说，如果您选择在此方法中捕获 db 错误（或其他一般错误），则至少在抛出新异常时将 innerexception 设置为捕获的异常。或者更好的是，记录你想要的，然后只是“扔”，而不是“扔前”。它将保留原始堆栈跟踪。

同样，您会对此有很多不同的想法，并且没有明确的对错，只是偏好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:17:18.760

查看开源 ORM 解决方案的代码（[Subsonic](http://www.subsonicproject.com)、[nHibernate](https://www.hibernate.org/343.html)）将对您有所帮助。

以我有限的知识，我认为与连接、连接超时等相关的错误应该这样传递，因为 DAL 对此无能为力。与验证相关的错误（如字段长度、数据类型）等应返回适当的详细信息。您可以提供验证方法（Subsonic 包含它）来验证字段值并返回适当的错误详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:18:08.790

不确定为什么不将 dt 声明为数据表 - “dim dt as object = nothing”的动机是什么？

真正可以合理失败的唯一行是“dt=ABC.APP.DAL....”调用。

在该行中，您可能会遇到一些错误：

*   存储过程或参数名称错误。这应该在设计时捕获（不是通过内置检查机制，而是在您第一次尝试运行代码时）
*   存储过程发生错误。Sproc 使用延迟名称解析，如果（例如）在调用 sproc 时对象不存在，这可能会导致运行时错误。同样，这很可能会在测试中脱颖而出。
*   一个僵局。在这种情况下，您应该捕获并重新提交该批次。 [这](http://technet.microsoft.com/en-us/library/ms189583.aspx)是关于处理应用程序代码中的 SQL 错误的介绍和链接集。
*   传递的参数无效（太长、错误的数据类型等）。这应该 在调用存储过程*之前进行检查。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T13:09:57.463

这可能对你有用...

[.NET Framework 开发人员指南 - 异常设计指南](http://msdn.microsoft.com/en-us/library/ms229014(VS.80).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T13:25:13.330

在这方面我也考虑了很多。很大程度上取决于特定的数据库，因此取决于您使用的是 SQL2000 还是 SQL2005+，您将在存储过程中执行返回码、RAISERROR 或 TRY-CATCH。

RAISERROR 最好是返回代码，因为使用存储过程的开发人员可以获得更多信息。最好选择 50000 及以上的数字并注册相应的消息，但这需要大量工作来传达 RAISERROR 调用文本中可以传达的内容

如果不阅读存储过程的源代码，则返回代码是不可互操作的。返回值 0 可能是成功、失败、受影响的 0 行、刚刚生成的主键，或者没有设置返回码，具体取决于当天存储过程编写者的突发奇想。此外，ADO.NET 从 ExecuteNonQuery 返回行数，因此一些开发人员会发现很难快速发现返回代码。

临时解决方案也很糟糕，例如。

```
IF @@Error>0 
   SELECT 'Something bad happened' 
```

如果您可以选择使用 CLR 存储过程，那么 C# 风格的错误处理就会发挥作用。

因此，将 RAISERROR 添加到您的存储过程中，然后捕获 SqlException，向用户报告任何真正属于用户数据条目验证的内容，记录开发人员滥用 API 的任何内容，并可能尝试重试连接或执行超时。

```
IF @Foo =42
        BEGIN
            RAISERROR ( 'Paramater @foo can''t be 42',
                16, -- Severity = Misc. User Error.
                1 -- State. == ad hoc way of finding line of code that raised error
               ) ;  
            RETURN -1; --Just because some developers are looking for this by habit
        END 
```

# c++ - C++，删除#include 或#include 在类头

> ID：920731
> 
> 赞同：4
> 
> 时间：2009-05-28T13:05:22.090
> 
> 标签：c++, templates, include

如果可能，我想从我的类头文件中删除 <vector> 和 <string> 的包含。字符串和向量都是头文件中声明的函数的返回类型。

我希望我可以做类似的事情：

```
namespace std {
    template <class T>
    class vector;
} 
```

并且，在标头中声明向量并将其包含在源文件中。

是否有参考涵盖必须包含在标头中的情况以及可以将包含内容拉入源文件的情况？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-28T13:46:54.957

您不能安全地转发声明 STL 模板，至少如果您想以便携和安全的方式进行。该标准明确了每个 STL 元素的最低要求，但为实现扩展留出了空间，这些扩展可能会添加额外的模板参数*，只要这些参数具有默认值即可*。也就是说：标准规定 std::vector 是一个模板，它至少需要 2 个参数（类型和分配器），但在符合标准的实现中可以有任意数量的额外参数。

不包括字符串和向量标头有什么意义？当然，要使用您的类的人必须已经包含它，因为它在您的界面上。

当您询问参考以决定何时包含以及何时转发声明时，我的建议是：包含属于您接口的所有内容，转发声明内部详细信息。

这里还有更多简单的编译性能问题。如果您将公共（或受保护）接口中的类型的包含推送到标头之外，您将根据包含的顺序创建依赖关系。用户必须知道他们必须在包含您的标头之前包含*字符串*，因此您要让他们担心一件事。

实现文件中应该包含哪些内容：实现细节、记录器、不影响接口的元素（数据库连接器、文件头）、内部实现细节（即在实现中使用 STL 算法不会影响接口、仿函数为简单目的而创建的实用程序...）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-28T13:07:48.310

除了极少数例外，您不得向 std:; 添加内容。命名空间。因此对于向量和字符串等类，您别无选择，只能#include 相关的标准头文件。

另外，请注意 string 不是一个类，而是`basic_string<char>`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-28T13:18:40.130

这对向量或字符串没有帮助，但值得一提的是，iostream 有一个前向引用标头，称为 iosfwd。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-28T13:10:01.113

标准容器通常有额外的默认模板参数（分配器等），所以这不起作用。例如，下面是 GNU 实现的一个片段：

```
 template<typename _Tp, typename _Alloc = std::allocator<_Tp> >
    class vector : protected _Vector_base<_Tp, _Alloc>
    { ... }; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-28T13:10:01.147

这也是我之前尝试做的事情，但由于模板，这是不可能的。

请看我的问题：[基类的前向声明](https://stackoverflow.com/questions/389957/forward-declaration-of-a-base-class)

由于此类标头在您的开发过程中不会更改，因此无论如何都不值得优化...

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-28T14:05:13.920

没有简单明显的方法来做到这一点（正如其他人已经很好解释的那样）。

然而，这些标题应该被视为语言的一部分（真的！），因此您可以毫无问题地将它们放在您自己的标题中，没有人会抱怨。

如果您关心的是编译速度，我鼓励您改用预编译头文件并将这些标准头文件放入其中（除其他外）。它将显着提高您的编译速度。

抱歉，对于“真正的赢家是避免战斗的人”这样的答案。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-28T13:30:52.680

如果 string 和 vector 仅用于类的非公共成员的签名，则可以使用 PImpl 习惯用法：

```
// MyClass.h
class MyClassImpl;
class MyClass{
public:
    MyClass();
    void MyMethod();
private:
    MyClassImpl* m_impl;
};

// MyClassImpl.h
#include <vector>
#include <string>
#include <MyClass.h>
class MyClassImpl{
public:
    MyClassImpl();
    void MyMethod();
protected:
    std::vector<std::string> StdMethod();
};

// MyClass.cpp
#include <MyClass.h>
#include <MyClassImpl.h>

void MyClass::MyMethod(){
    m_impl->MyMethod();
} 
```

您总是在头文件中包含向量和字符串，但仅在类的实现部分中；仅包含 MyClass.h 的文件不会拉入字符串和向量。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-28T13:42:53.933

只需在您引用 STL 集合的任何文件中包含标头即可。

正如其他人所提到的，没有一种方法可以可靠地转发声明 STL 类，即使您为您的特定实现找到了一个，如果您使用不同的 STL 实现，它也可能会中断。

如果编译单元不实例化类，它不会使您的目标文件变得更大。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-28T13:33:05.030

# **警告**

# **预计这样做会引起轩然大波。**

该语言允许您派生自己的类：

```
// MyKludges.h
#include <vector>
#include <string>
class KludgeIntVector : public std::vector<int> { 
  // ... 
};
class KludgeDoubleVector : public std::vector<double> {
  // ...
};

class KludgeString : public std::string {
  // ...
}; 
```

更改您的函数以返回 KludgeString 和 KludgeIntVector。由于这些不再是模板，您可以在头文件中转发声明它们，并将 MyKludges.h 包含在您的实现文件中。

严格来说，派生类不继承基类的构造函数、析构函数、赋值运算符和友元。您将需要提供您正在使用的任何东西的（简单的）实现。

* * *

```
// LotsOfFunctions.h
// Look, no includes!  All forward declared!
class KludgeString;
// 10,000 functions that use neither strings nor vectors
// ...
void someFunction(KludgeString &);
// ... 
// Another 10,000 functions that use neither strings nor vectors

// someFunction.cpp
// Implement someFunction in its own compilation unit
// <string> and <vector> arrive on the next line
#include "MyKludges.h"
#include "LotsOfFunctions.h"
void someFunction(KludgeString &k) { k.clear(); } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-28T14:40:53.800

我假设您的目标是加快编译时间？否则，我不确定您为什么要删除它们。

另一种方法（不漂亮但实用）是在包含本身周围使用宏保护。

例如

```
#ifndef STDLIB_STRING
#include <string>
#define STDLIB_STRING
#endif 
```

尽管这看起来很混乱，但在大型代码库上确实会增加编译时间。我们所做的是创建一个将自动生成警卫的 Visual Studio 宏。我们将宏绑定到一个键以便于编码。然后它就变成了公司的编码标准（或习惯）。

我们也为我们自己的包含做这件事。

例如

```
#ifndef UTILITY_DATE_TIME_H
#include "Utility/DateTime.h"
#endif 
```

因为当我们创建自己的头文件时，我们有 Visual Studio 助手来自动生成保护，所以我们不需要#define。宏知道它是一个内部包含，因为我们总是使用

`#include ""`

我们自己的格式包括和

`#include <>`

对于外部包括。

我知道它看起来并不漂亮，但它确实将我们在大型代码库上的编译时间加快了 1/2 多小时（从内存中）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-28T13:34:37.460

也许您最好使用 pimpl 习惯用法：在我看来，您不想将类的实现暴露给客户端代码。如果向量和字符串对象按值聚合，编译器需要查看它们的完整声明。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-28T14:22:23.433

除了添加重载`std::swap`（我现在能想到的唯一例外）之外，通常不允许您向`std`命名空间添加任何内容。即使允许，实际声明`std::vector`也比 OP 中的代码复杂得多。有关示例，请参见[Nikolai N Fetissov 的答案](https://stackoverflow.com/questions/920731/c-removing-includevector-or-includestring-in-class-header/920748#920748)。

除此之外，您还有一个额外的问题，即您的类用户将如何处理返回 a`std::vector`或的函数`std::string`。[C++ 标准第 3.10 节](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2798.pdf)说返回此类对象的函数正在返回*rvalues*，并且 rvalues 必须是完整类型。在英语中，如果您的用户想要对这些功能做任何事情，他们将不得不`#include <vector>`或`<string`> 无论如何。`#include`我认为在您的文件中为它们添加标题并完成它会更容易`.h`。

# iphone - UIKit SDK 3.0 错误

> ID：920734
> 
> 赞同：3
> 
> 时间：2009-05-28T13:06:33.493
> 
> 标签：iphone, uikit

我正在使用 iphone_sdk_3.0_beta_5__9m2735 SDK。当我尝试使用模拟器 3.0 选项编译我的代码时，出现以下错误。代码编译其余所有模拟器选项，即 2.0、2.1、2.2、2.2.1 在编译我的代码时出现以下错误

```
来自 /Users/videomac/manish/EXPLab/2009-05-27-11-20 myApp_LL_2/myApp_Prefix.pch:7：
在 /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator3.0.sdk/System/Library/Frameworks/UIKit.framework/Headers/UIKit.h:30 包含的文件中，
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator3.0.sdk/System/Library/Frameworks/UIKit.framework/Headers/UILocalizedIndexedCollat​​ion.h:11：错误：'AT_NAME'标记之前的语法错误
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator3.0.sdk/System/Library/Frameworks/UIKit.framework/Headers/UILocalizedIndexedCollat​​ion.h:19：错误：'}'标记之前的语法错误
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator3.0.sdk/System/Library/Frameworks/UIKit.framework/Headers/UILocalizedIndexedCollat​​ion.h:21：致命错误：方法定义不在@implementation上下文中

```

错误位于作为 SDK 文件的 UILocalizedIndexedCollat​​ion.h 文件中。我使用的是 SDK 3.0 的 UIKit 框架。谁能告诉我该怎么做才能消除此错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-12T15:47:08.413

我已经追踪到这个问题是正在使用的编译器版本。据我所知，[已编辑] 需要 GCC 4.2，而 iPhone SDK 2.x 仅适用于 GCC 4.0。

这是解决此问题的方法。

在您的`Target Info`中，选择`Build`分隔符并查找该部分`Compiler Version`。然后：

1.  选择`C/C++ Compiler Version`行
2.  将默认设置为`GCC 4.0`
3.  在左下角的控件中，点击`Add Build Setting Condition`
4.  在左侧，选择`Device - iPhone OS 3.0`
5.  在右边，选择`GCC 4.2`
6.  重复步骤 3 到 5，现在重复步骤`Simulator - iPhone OS 3.0`4。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-22T23:51:31.147

Apple 的工程师已经确认他们在 UIKit 框架中存在错误：

对于这个 UIKit 错误，我们确实有一个简单的解决方法。在 UILocalizedIndexedCollat​​ion.h 中改变这个：

```
UIKIT_EXTERN @interface UILocalizedIndexedCollation : NSObject
to
UIKIT_EXTERN_CLASS @interface UILocalizedIndexedCollation : NSObject 
```

丹尼斯2342

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:15:15.027

首先，您应该在这里讨论测试版产品。

但是，这与测试版无关。您自己的一个头文件中有错误，可能缺少“@end”语句。

顺便说一句，谷歌本可以为你解决这个问题，而不是在这里问。

# database - 通过 JDBC/ODBC 访问数据库时，您应该为每个请求创建和关闭连接吗？

> ID：920735
> 
> 赞同：0
> 
> 时间：2009-05-28T13:07:16.050
> 
> 标签：database, jdbc, odbc, connectivity

如果您有一个类为其他类对数据库数据的请求提供服务，那么您应该何时保持数据库连接，何时应关闭它并在下一个请求时重新打开它？

如果它是一个响应来自外部应用程序的连接的服务呢？（Web 服务、Ajax、rpc）

保持与始终打开的数据库的单例连接并在失败时重新打开它是一个好主意吗？还是应该为每个请求打开一个新的数据库连接？

如果维护一个始终打开与数据库的连接的单例数据库对象是一个坏主意，那么在任何情况下这是一个好主意吗？我经常看到它被引用为单例模式的理由？

我不是在谈论每个数据库查询的新连接，那太愚蠢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T13:18:23.610

您可能想看看[连接池](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/conpool.html)。

在这种情况下，N 个连接被打开并可供客户端使用。当您“关闭”连接时，连接本身不会关闭，而是返回到池以供另一个客户端使用。

[Apache DBCP](http://commons.apache.org/dbcp/)是一个有用的库来管理它。

# c++ - 应用验证程序报告“线程不能拥有关键部分”。

> ID：920740
> 
> 赞同：1
> 
> 时间：2009-05-28T13:08:26.593
> 
> 标签：c++, multithreading, critical-section

所以 App Verifier 抛出了这个异常。据我所知，这条消息的文字有点误导。问题似乎是临界区是由在临界区被销毁之前被销毁的线程创建的。

这是一个相对简单的修复，但有谁知道除了创建线程之外的线程破坏关键部分的后果是什么？有多危险？只是担心临界区句柄会“泄漏”还是有更隐蔽的副作用？

其他一些信息：

*   用 C++ 编写的应用程序（当然是在 Windows 上）
*   使用 InitializeCriticalSelection 创建的临界区
*   最终使用 DeleteCriticalSection 删除临界区

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T13:55:02.130

我相信您对消息的解释是正确的。我能找到的唯一参考如下。正如作者建议的那样，堆栈跟踪是一个很好的线索

*   [http://jpassing.wordpress.com/2008/02/18/application-verifier-thread-cannot-own-a-critical-section/](http://jpassing.wordpress.com/2008/02/18/application-verifier-thread-cannot-own-a-critical-section/)

我挖了一会儿，找不到任何具体原因为什么您不能在不同线程上创建和删除关键部分。但是我确实想知道您为什么要这样做？可以这么说，让一个线程拥有一个关键部分似乎是最佳实践。在线程之间切换临界区引入了另一种通信方式和潜在的错误（可以做到，只是更有趣）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-15T08:09:20.557

Seems accepted answer talks about creation of critical section, which is not what this message is about. Eran's answer covered the real cause of the message, but here it is in *TL;DR* terms:

**Application verifier detected a thread, that acquired a critical section lock, is attempting to exit while the section is still locked**

It is not complaining that thread *created* critical section and is now terminating. This has nothing to do with who creates and destroys the section. It is complaining, and very legitimately, that the thread *owns the lock* on that critical section and terminating. They could've made the wording of that message so much clearer.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-05T21:23:26.060

与诸如 COM 对象之类的野兽相反，临界区生命周期并不绑定到某个线程。关键部分的构建分为两个阶段：在创建时，它们仅由几个结构组成。在两个或多个线程争用时，会创建一个内核互斥锁以正确处理同步。任何线程都可以创建、访问和破坏结构和互斥锁，无论它是否创建了临界区。

要回答您的问题，以上意味着您在一个线程中创建 CS 并在另一个线程中销毁它应该没有问题。然而，这可能意味着设计存在一些问题。如果您还没有这样做，请考虑用一个类包装 CS，该类将在其构造函数中初始化 CS，并在其析构函数中销毁它（MFC 的 CCriticalSection 会这样做）。然后，在比使用它的范围更高的范围内创建包装器（全局、静态类成员等）。应该使创建和清理更容易。

最后，关于错误消息本身 - 被删除的线程是否有可能进入 CS 而没有机会离开它（由于异常等）？如果是这种情况，您会收到一条看起来很奇怪的消息，指出一个真正的问题。

# android - 始终在 MapView 上显示缩放控件

> ID：920741
> 
> 赞同：17
> 
> 时间：2009-05-28T13:08:33.253
> 
> 标签：android, android-mapview

有没有办法始终在 MapView 上显示缩放控件？我已经使用添加了缩放控件

```
map=(MapView)findViewById(R.id.map);
map.setBuiltInZoomControls(true); 
```

但缩放控件淡入淡出。我希望它们始终可见。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-05T12:49:21.443

通过将我自己的 ZoomControls 放在我的布局 xml 中解决了这个问题：

```
<ZoomControls android:id="@+id/zoomcontrols"
android:layout_width="wrap_content"
android:layout_height="wrap_content" /> 
```

然后设置 onClickListeners 来处理缩放：

```
 zoomControls = (ZoomControls) findViewById(R.id.zoomcontrols);
    zoomControls.setOnZoomInClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            mapController.zoomIn();
        }
    });
    zoomControls.setOnZoomOutClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            mapController.zoomOut();
        }
    }); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-08-28T17:11:29.573

Intrications 的解决方案确实有效，但您失去了内置功能，当您一直放大或缩小时，按钮会禁用。您可以改用以下内容来保留此功能：

```
localMapView.getZoomButtonsController().setAutoDismissed(false); 
```

但是，这不会让您将控件放置在面板中您想要的任何位置，虽然它不会消失，但它不会在第一次出现之前，直到用户触摸屏幕一次。我尝试调用`setVisible(true)`控制器，但由于某种原因这似乎不起作用。

# c# - 干这个方法

> ID：920742
> 
> 赞同：1
> 
> 时间：2009-05-28T13:08:37.123
> 
> 标签：c#, dry

我需要帮助使这种方法通用。重复大约十次以获得不同 Web 列表控件的列表（将“MyType”替换为特定控件中使用的类型）。

```
 private static IList<MyType> GetList(RequestForm form)
    {
        // get base list
        IMyTypeRepository myTypeRepository = new MyTypeRepository(new HybridSessionBuilder());
        IList<MyType> myTypes = myTypeRepository.GetAll();

        // create results list
        IList<MyType> result = new List<MyType>();

        // iterate for active + used list items
        foreach (MyType myType in myTypes)
        {
            if (myType.Active || form.SolutionType.Contains(myType.Value))
            {
                result.Add(myType);
            }
        }

        // return sorted results
        result.OrderBy(o => o.DisplayOrder);
        return result;
    } 
```

如果这还不够信息，请告诉我。我认为这需要我刚刚熟悉的更高级的语言功能。也许我应该让他们都使用同一个存储库？

谢谢你的帮助。

编辑：感谢您的帮助。我没有任何同行支持，所以这个董事会很棒，我从你们每个人身上都学到了一些东西。我希望我能接受所有的答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T13:19:22.577

您可以首先使您的函数更简洁，如下所示：

```
private static IList<MyType> GetList(RequestForm form)
{
    // get base list
    IMyTypeRepository myTypeRepository =
        new MyTypeRepository(new HybridSessionBuilder());

    IList<MyType> myTypes = myTypeRepository.GetAll();

    return myTypes.Where(x => x.Active || form.SolutionType.Contains(x.Value))
                  .OrderBy(x => x.DisplayOrder).ToList();
} 
```

此时，该功能的大部分内容都与 直接相关`MyType`，因此如何进一步改进它在很大程度上取决于`MyType`与所涉及的其他类型的相关性。例如，如果您的其他类型遵循（对我而言）看起来合理的合同，您可以编写一个假设版本：

```
private static IList<T> GetList(RequestForm form) where T : OrderedValueContainer
{
    // we'll want to somehow genericize the idea of a TypeRepository that can
    // produce these types; if that can't be done, we're probably better off
    // passing a repository into this function rather than creating it here

    var repository = new TypeRepository<T>(new HybridSessionBuilder());
    IList<T> myTypes = repository.GetAll();

    // the hypothetical OrderedValueContainer class/interface
    // contains definitions for Active, Value, and DisplayOrder

    return myTypes.Where(x => x.Active || form.SolutionType.Contains(x.Value))
                  .OrderBy(x => x.DisplayOrder).ToList();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T13:14:09.717

如果所有类型都实现了相同的接口（如果它们没有实现它们，并确保将所有属性添加到此方法所需的接口），那么您可以执行以下操作：

```
private static IList<T> GetList(RequestForm form)
       where T: IMyInterface
    {
        // get base list
        IMyTypeRepository myTypeRepository = new MyTypeRepository(new HybridSessionBuilder());
        IList<T> myTypes = myTypeRepository.GetAll();

        // create results list
        IList<T> result = new List<T>();

        // iterate for active + used list items
        foreach (T myType in myTypes)
        {
            if (myType.Active || form.SolutionType.Contains(myType.Value))
            {
                result.Add(myType);
            }
        }

        // return sorted results

        return result.OrderBy(o => o.DisplayOrder).ToList();
    } 
```

我所做的另一项更改是最后一行，您将 orderby 放在单独的行上，并且从未真正捕获 Ordered 列表。

**编辑：**为了解决存储库问题，您可以拥有一个存储库工厂，它根据 T 的类型返回正确的存储库：

```
public static IMyTypeRepository  GetRepository(Type t)
{
   if(t == typeof(Type1))
   {
      return Type1Repository();
   }

   if(t == typeof(Type2))
   {
      return Type2Repository();
   }
   .......
} 
```

当然，假设您的所有存储库都实现了 IMyRepository 接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T13:42:09.363

首先，您的所有类型都必须实现一个通用`interface`的定义属性，例如`Active`，`Value`...

另外，据我所知，必须有一个独立于所有存储库的存储库接口，`MyType`以便您可以使用这样的通用方法。该`GetAll()`方法应在`IRepository`.

```
public interface IRepository<T> where T : IMyType
{
    IList<T> GetAll();
}

public class RepositoryFactory
{
    public static IRepository<T> createRepository<T>(ISessionBuilder sb) where T : IMyType
    {
        // create repository
    }
}

public interface IMyType
{
    bool Active { get; }
    string Value { get; }
}

private static IList<T> GetList(RequestForm form) where T : IMyType
{
    // get base list
    IRepository<T> repository = RepositoryFactory.createRepository<T>(new HybridSessionBuilder());
    IList<T> myTypes = repository.GetAll();

    // create results list
    IList<T> result = new List<T>();

    // iterate for active + used list items
    foreach (T myType in myTypes)
    {
        if (myType.Active || form.SolutionType.Contains(myType.Value))
        {
            result.Add(myType);
        }
    }

    // return sorted results
    return result.OrderBy(o => o.DisplayOrder).ToList();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T13:17:17.963

假设存储库共享一个通用接口，存储库的问题应该很容易解决：添加一个静态函数，例如

```
 public static IRepository RepositoryForType(Type t)
{
    if(t == typeof(SomeClass))
       return new SomeClassRepository(new HybridSession());
    else if ...
    else throw new InvalidOperationException("No repository for type " + t.Name);
} 
```

这应该要求您对现有代码进行最少的更改，但请注意，将来当您在项目中添加新存储库时，您必须在此函数中添加对新存储库的类支持（如果您正在使用单元测试你会很容易弄清楚你是否忘记了这个助手）。

# javascript - 销售 Javascript 代码

> ID：920745
> 
> 赞同：11
> 
> 时间：2009-05-28T13:09:25.157
> 
> 标签：javascript

我打算出售我编写的 javascript 代码。鉴于浏览器的当前状态，编写复杂代码是完全可能的。我想我会面临几个问题/有几个问题：

1.  只要我向某人展示演示，就可以轻松**复制作为客户端的 Javascript**
2.  是否有任何公司出售 javascript 代码？不像 ExtJS 那样获得双重许可。
3.  我应该混淆我的代码吗？我应该硬编码它将在其上运行和打包的网站等吗？
4.  我该怎么做？

感谢您的时间。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-28T13:24:30.243

老实说，对于任何软件，没有一种保护方法是 100% 不被滥用的。例如，即使是大规模的商业软件，如 Photoshop、Windows 或 OS X。都有适当的方法来防止人们滥用或盗版他们的软件，对于普通用户来说，这很好，并防止人们简单地复制他们的软件并非法分发。

但是，如果人们*真的*想非法使用软件，他们会找到一种方法——例如，他们可能会对其进行逆向工程，然后创建注册机或完全删除盗版机制。

当然，作为一种脚本语言，使用 JavaScript 编写的应用程序更容易被滥用，因为正如您所指出的，当 JavaScript 在客户端运行时，任何人都可以很容易地查看您的 JavaScript。但是，对于您的许多客户来说，这应该不是问题，而且现在公司将这种性质的软件用于商业化是很常见的，这些软件使用 JavaScript 作为其实现的主要方法。

可能会有一些人试图滥用您的软件，但正如我上面指出的，这种情况发生在软件开发的各个领域，您所能做的就是尽最大努力防止这种情况发生。正如您所建议的，JavaScript 混淆是降低源代码可读性的好方法，（但有一些限制，例如剥离一些混淆器认为不必要的合法代码行），但归根结底，您只需要记住，*大多数*人可能会以正确的方式合法地使用您的软件，而过度保护您的软件只会引起您的合法用户的烦恼，以试图阻止一小部分可能提供无论如何，任何机制的解决方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T14:10:19.183

通常销售 JavaScript 组件的公司实际上是在销售对这些组件的支持。保证错误修复，及时回答问题等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T13:21:34.040

混淆它最简单的方法是使用[Online YUI minifier](http://www.refresh-sf.com/yui/)。

基本上，去混淆它所需的工作与重写它非常相似。这不一定会阻止某人窃取它，但同样，这取决于您所处的市场类型。大多数人都是诚实的。

几乎所有的 JavaScript 在设计上都是开源的。似乎很多人都在开源中赚钱。我不会出汗太多。出售价值或服务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T13:21:04.383

有许多公司销售 Javascript '组件'，我知道至少其中一些公司混淆了他们的代码。许多混淆器和压缩器使用 eval 和编码字符串做一些可怕的事情......我建议不要走这条路。

以我的经验，所有混淆代码都会让你的诚实客户感到沮丧。在许多方面，它归结为您的目标对象。如果您正在制作嵌入式组件，那么混淆事物不会成为一个大问题。如果您的目标是开发人员，您将需要保持代码开放 imo。

如果您选择混淆，性能和可靠性的最佳方法是使用 javascript 压缩器

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T13:17:50.803

[Milonic](http://www.milonic.com/)销售一些 JavaScript 组件。

不知道他们如何保护他们，但他们已经经营了很长时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T13:57:48.990

请记住，“窃取”代码不仅仅是混淆，而是直接将其复制粘贴到另一个站点并按原样使用它。为脚本包含某种类型的许可请求并不是不合理的，可能会检查从中央服务器发送请求的域。当然，那么你需要混淆只是为了防止人们删除许可检查......

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-05-28T13:12:14.870

有一些公司出售js代码。他们做得如何——不知道。

保护代码唯一能做的就是对其进行混淆处理。

# sql-server - 如何保护从 Perl DBI 到 SQL Server 的连接？

> ID：920751
> 
> 赞同：1
> 
> 时间：2009-05-28T13:10:52.237
> 
> 标签：sql-server, perl, security, odbc, dbi

我需要使用 Perl DBI 连接到安全的 SQL Server 数据库。我需要找到一种方法来安全地验证用户身份（不用担心被窃听，也不需要在客户端存储密码）。我`SQL Server 2008`在`Windows Server 2008, and Perl 5.10`XP上使用。

SQL Server 通过称为“SQL Server Native Access Client API”的东西支持加密连接，但我不知道这是否被任何 DBD 驱动程序支持，或者如果它是如何使用它。

我不愿意将`DBD::ODBC`驱动程序与 SQL Server 身份验证一起使用，因为 ODBC 以明文形式传输用户 ID 和密码。

我不能将 DBD::ODBC 驱动程序与 Windows 身份验证（可信连接）一起使用，因为服务器不在任何可从客户端网络访问的 Active Directory 域中。

如何保护与数据库的连接？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-15T13:07:37.310

> 我不愿意使用带有 SQL Server 身份验证的 DBD::ODBC 驱动程序，因为 ODBC 以明文形式传输用户 ID 和密码。

严格来说，这并不正确。如果您使用的是最近的 SQL Server 并且没有在其中禁用加密，则用户名/密码和连接字符串加密如下：

客户端联系服务器并告诉它它可以做什么（例如，它可以做 SSL）。如果服务器随后支持 SSL，它需要客户端加密连接信息，然后回退到未加密。您还应该在 DSN 中看到“对数据使用强加密”复选框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:56:45.293

我建议您使用某种安全连接系统。它可能是 IPSec，但它通常被认为是复杂的，所以你可能会更好（或更快）使用我使用的 OpenVPN，并且通常对此感到满意。

它几乎可以在任何操作系统上使用，速度快，而且免费。你可以在这里查看：http: [//openvpn.net/](http://openvpn.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:22:31.417

两种选择：

1.  在两个位置之间创建 IPSec 隧道。这里有一些信息：technet.microsoft.com/en-us/library/cc737154(WS.10).aspx technet.microsoft.com/en-us/library/cc786385(WS.10).aspx

2.  启用 SSL。我不确定它会受到怎样的保护。technet.microsoft.com/en-us/library/ms189067.aspx

# c# - 构建 MVVM 3D 编辑器应用程序 -> 获取鼠标位置？

> ID：920753
> 
> 赞同：2
> 
> 时间：2009-05-28T13:11:23.297
> 
> 标签：c#, wpf, xaml, mvvm, direct3d

在我的 3d 编辑器应用程序中，我希望能够单击并移动场景的实体（网格、灯光、相机等）。为此，我想我需要获取相对于我的 Direct3d 视图的当前鼠标位置，并以某种方式将其提供给我的 ViewModel。考虑到我的应用程序是使用 MVVM 模式构建的，我该怎么做呢？

附加信息：Direct3d 渲染器来自 C++ DLL，我们使用 HwndHost 将其放置在我们的 WPF 应用程序中。它有一个 WndProc，我想我可以用它在那里处理鼠标消息，但如果可能的话，我宁愿避免它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-15T12:57:40.557

我发现的最佳解决方案是使用附加行为。在用作 HwndHost 占位符的控件中，我设置了一个附加属性，例如

```
b:MouseBehavior.LeftClick="{Binding DoSomeActionCommand}" 
```

其中 MouseBehavior 接收控件并在其上设置鼠标事件。

这对我来说很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T14:20:13.017

[InputManager.Current.PrimaryMouseDevice 可能是您最好的选择。](http://msdn.microsoft.com/en-us/library/system.windows.input.mousedevice_members.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-28T13:49:03.360

你可以得到鼠标位置

```
Mouse.Position( RelativeToObject ); // get the mouse pos relative to an object
Mouse.Position( null ); // get the mouse pos relative to the whole screen 
```

如果这还不够好，您可以使用 Win32 调用。

# linux - 通过符号链接调用时如何获取脚本本身内部的脚本文件路径

> ID：920755
> 
> 赞同：10
> 
> 时间：2009-05-28T13:12:14.683
> 
> 标签：linux, bash, scripting

当我需要在脚本本身中获取脚本文件的路径时，我使用如下内容：

```
`dirname $0` 
```

在我通过符号链接调用脚本之前，该文件有效。在这种情况下，上面的代码打印链接的位置而不是原始文件。

有没有办法获取原始脚本文件的路径，而不是链接？

谢谢，迈克

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-28T13:25:37.387

```
if [ -L $0 ] ; then
    DIR=$(dirname $(readlink -f $0)) ;
else
    DIR=$(dirname $0) ;
fi ; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-28T14:16:40.747

您**确实**需要阅读以下 BashFAQ 文章：

*   [BashFAQ/028 - 如何确定脚本的位置？我想从同一个地方读取一些配置文件。](http://mywiki.wooledge.org/BashFAQ/028)

事实是，`$0`黑客并不可靠，只要应用程序以不是应用程序路径的第零个参数启动，它们就会失败。例如，`login(1)`将 a`-`放在您的应用程序名称前面`$0`，导致损坏，并且每当您调用应用程序时，该应用程序`PATH` `$0`将不包含应用程序的路径，而仅包含文件名，这意味着您无法提取任何位置信息其中。失败的方式还有很多。

底线：不要依赖黑客，事实是你**无法**弄清楚你的脚本在哪里，所以使用配置选项来设置你的配置文件的目录或任何你需要的脚本路径。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-28T13:15:26.283

用于[`readlink`](http://unixhelp.ed.ac.uk/CGI/man-cgi?readlink)：

```
readlink -f "$0" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T19:53:01.437

```
Dir=$(dirname $(readlink -f "$0")) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-15T15:12:06.557

我建议这个：

```
dirname $(realpath $0) 
```

例子：

```
skaerst@test01-centos7:~/Documents> ../test/path.sh 
dirname realpath: /home/skaerst/test

skaerst@test01-centos7:~/Documents> cat ../test/path.sh
#!/bin/bash

echo "dirname realpath: $(dirname $(realpath $0))" 
```

也适用于符号链接，因为 realpath 默认使用 -P ：

```
skaerst@test01-centos7:~/Documents> ln -s ../test/path.sh p
skaerst@test01-centos7:~/Documents> ./p
dirname realpath: /home/skaerst/test 
```

我猜 realpath 适用于 coreutils >8.5

```
skaerst@test01-centos7:~/Documents> rpm -qf $(which realpath) $(which dirname)
coreutils-8.22-15.el7_2.1.x86_64
coreutils-8.22-15.el7_2.1.x86_64 
```

hth

问候

斯特凡

# sql - 在 Select 语句中的 CONVERT 上尝试 CATCH

> ID：920760
> 
> 赞同：18
> 
> 时间：2009-05-28T13:13:04.073
> 
> 标签：sql, tsql, datetime, try-catch

是否可以在 SQL Selects 中使用 TRY CATCH 块？

对于与此类似的东西，例如：

```
select 
   order, 
   CONVERT(DATETIME, orderDate)
from orders 
```

处理这种情况的最佳方法是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-28T13:18:45.153

我不知道 try-catch，但是在 SQL Server 中你有 ISDATE 函数并且可以在那里做类似的事情

```
CASE WHEN ISDATE(orderDate) = 1 THEN CONVERT(DateTime, orderDate) ELSE GETDATE() END 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-16T13:50:33.260

在 MS SQL Server 2012 中，有一个新结构可以完全满足要求：

```
 SELECT 
    CASE WHEN TRY_CONVERT(float, 'test') IS NULL 
    THEN 'Cast failed'
    ELSE 'Cast succeeded'
END AS Result;
    GO 
```

另请参阅[http://msdn.microsoft.com/en-us/library/hh230993.aspx](http://msdn.microsoft.com/en-us/library/hh230993.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T13:19:51.563

在 SELECT 子句本身中，没有。

[您可以使用ISDATE](http://msdn.microsoft.com/en-us/library/ms187347.aspx) ()测试日期

```
select 
   order, 
   CASE WHEN ISDATE(orderDate) = 1 THEN CONVERT(DATETIME, orderDate) ELSE NULL END
from orders 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T13:19:09.037

您可以使用函数 ISDATE()：

```
SELECT ISDATE('11/13/2009')
SELECT ISDATE('13/11/2009') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T13:42:23.077

我认为在 select 中不可能进行 try catch，但是在使用存储过程时可以在外部进行。

```
begin try
    select cast(strartnr as int) from table
end try
begin catch 
    select 10000 from table
end catch 
```

# ant - 通过ant将“-J-Duser.language”传递给javac，以确保编译错误以正确的语言报告

> ID：920763
> 
> 赞同：3
> 
> 时间：2009-05-28T13:13:14.493
> 
> 标签：ant, javac

我的电脑目前设置为日语以进行测试。如果我的 java 项目出现编译错误，则会以日语报告消息。

例如将 1 个源文件编译到 [...directory...] [...class...].java:172: シンボルを见つけられません。</p>

我希望看到英文的错误。

在不使用 ant 的情况下，解决方法是使用 javac -J-Duser.language=en [..java files...] 这使得 javac 给出英文错误消息（-J 告诉 javac 将其余参数传递给 java )

我的问题是：我如何将它传递给 ant [编辑删除我尝试过但不起作用的选项]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T20:45:29.400

尝试`<compilerarg>`在您的`<javac>`通话中添加一个。例如：

```
<javac srcdir="${src.dir}" destdir="${classes.dir}" fork="true">
    <compilerarg value="-J-Duser.language=en"/>
    <compilerarg value="-J-Duser.country=GB"/>
</javac> 
```

**编辑**修复了 arg 值。此外，这仅在编译器被分叉时才有效；我更新了示例以反映这一点。

# iphone - 在另一个线程中启动密集的核心动画块是否有帮助？

> ID：920766
> 
> 赞同：1
> 
> 时间：2009-05-28T13:13:53.867
> 
> 标签：iphone, cocoa-touch, uikit

我有一个滚动视图，在滚动过程中会发生一些复杂的动画。虽然经过 2 周的微调后性能现在可以接受，但在动画发生时滚动并不是 100% 平滑的。

我知道核心动画在后台线程中执行动画。但我想知道将这些动画块（几乎同时有 10 个）拆分成线程是否会有所帮助。

有一些方法看起来很有趣：

– performSelector:onThread:withObject:waitUntilDone: – performSelectorInBackground:withObject:

还是那是胡说八道？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T13:52:12.137

**不，它没有帮助**。正如您正确陈述的那样，Core Animation 已经在单独的线程中运行。Core Animation 足够聪明，可以尽可能高效地处理动画块。我不建议干涉它。

[核心动画编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/WhatisCoreAnimation.html)说：

> 一个抽象动画接口，允许动画在单独的线程上运行，独立于应用程序的运行循环。一旦动画被配置并启动，Core Animation 将承担以帧速率运行它的全部责任。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T15:00:26.227

你确定波涛汹涌的行为真的来自CA吗？你还有什么事吗？

如果您有任何后台网络访问权限，请考虑将其移至单独的线程中 - 为这些调用提供服务所花费的时间与 UI 在您滚动时更新屏幕所花费的时间相去甚远。

# java - 如何在 struts2 拦截器中获取 struts.action.extension 的值？

> ID：920768
> 
> 赞同：0
> 
> 时间：2009-05-28T13:14:00.933
> 
> 标签：java, struts2, interceptor

我需要从拦截器访问 struts.xml 文件中的 struts.action.extension 值。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:34:10.340

我意识到答案可能是针对以前版本的 struts，它在我正在使用的 struts 版本（struts v2.2）中不起作用。以下确实有效，但......

```
final ActionContext context = actionInvocation.getInvocationContext();    
com.opensymphony.xwork2.util.ValueStack vs=context.getValueStack();
((ActionMapping)vs.getContext().get("struts.actionMapping")).getExtension(); 
```

... 其中 ActionMapping 是 org.apache.struts2.dispatcher.mapper.ActionMapping。

认为它可能会帮助某人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:40:33.973

感谢 Struts 用户列表中的 Musachy Barroso，我在拦截器中添加了以下内容：

```
/**
 * @param strutsActionExtension the strutsActionExtension to set
 */
@Inject(StrutsConstants.STRUTS_ACTION_EXTENSION) //Note this isn't necessarily supported
public void setStrutsActionExtension(String strutsActionExtension) {
    this.strutsActionExtension = strutsActionExtension;
} 
```

正如 Wes Wannemacher 在同一个列表中指出的那样，这实际上并不支持，但在未来的版本中极不可能发生变化。

# c# - 带有换行符的 C# 正则表达式

> ID：920770
> 
> 赞同：0
> 
> 时间：2009-05-28T13:14:11.557
> 
> 标签：c#, regex

你好我有以下代码

```
namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {

            string searchText = "find this text, and some other text";
            string replaceText = "replace with this text";

            String query = "%SystemDrive%";
            string str = Environment.ExpandEnvironmentVariables(query);
            string filePath = (str + "mytestfile.xml"); 

            StreamReader reader = new StreamReader( filePath );
            string content = reader.ReadToEnd();
            reader.Close();

            content = Regex.Replace( content, searchText, replaceText );

            StreamWriter writer = new StreamWriter( filePath );
            writer.Write( content );
            writer.Close();
        }
    }
} 
```

替换找不到搜索文本，因为它位于单独的行上，例如

> 找到此文本
> 和其他一些文本。

我将如何编写正则表达式 epression 以便它可以找到文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T13:27:21.173

要搜索任何空格（空格、换行符、制表符等），您应该在正则表达式中使用 \s：

```
string searchText = @"find\s+this\s+text,\s+and\s+some\s+other\s+text"; 
```

当然，这是一个非常有限的例子，但你明白了......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:18:26.183

为什么要尝试使用正则表达式进行简单的搜索和替换？只需使用：

```
content.Replace(searchText,replaceText); 
```

您可能还需要在字符串中添加 '\n' 以添加换行符以使替换匹配。

尝试将搜索文本更改为：

```
string searchText = "find this text,\n" + 
                    "and some other text"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:01:56.923

这是针对您的特定问题的附注，但您正在重新发明框架为您提供的一些功能。试试这个代码：

```
static void Main(string[] args)
{
    string searchText = "find this text, and some other text";
    string replaceText = "replace with this text";

    string root = Path.GetPathRoot(Environment.SystemDirectory);
    string filePath = (root + "mytestfile.xml"); 

    string content = File.ReadAllText(filePath);
    content = content.Replace(searchText, replaceText);

    File.WriteAllText(filePath, content);  
} 
```

# php - 刷新期间的会话问题

> ID：920774
> 
> 赞同：0
> 
> 时间：2009-05-28T13:14:51.713
> 
> 标签：php, mysql, apache-flex

当我刷新我的 flex 应用程序时，页面不会保持其状态并返回登录页面。我不确定为什么会发生这种情况，这是我的代码处理会话。

公共函数 doLogin($username,$password) {

```
 include("connection.php");
        session_start();
        session_register("session");

        $query = "SELECT *
                  FROM users
                  WHERE username = '".mysql_escape_string($username)."'
                  AND password = '".mysql_escape_string($password)."'";
        $result = mysql_fetch_array(mysql_query($query));
        if(!$result) {
        session_unset();
        return 'no';
        }
        else 
            {
        $session['id']=session_id();
        $session['username']=$username;
        return 'yes';
            }
        }

    public function Logout() { 

    session_start();
    session_register("session");
    session_unset();
    session_destroy();
    return 'logout';        
    } 
```

我应该在成功登录后加载的 Flex 窗格上做些什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T13:20:00.487

成功登录后重定向回其他页面。

例如

```
if(doLogin($user,$pass) == 'yes')
{
    Header("Location: index.php");
    exit;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T13:23:58.900

刷新是指重新加载页面（F5）。如果是这样，那就是原因！重新加载/刷新将重新初始化所有内容。因此，当您重新加载/刷新时，将显示您的起始状态（登录）。

如果您希望保持应用程序状态，那么每次状态更改时，您都必须将其详细信息保存到数据库中，然后当用户点击起始页面时重新加载他们的会话。

如果浏览器被刷新/重新加载（或崩溃等），那么您无法让应用程序注销用户，因此您必须在登录页面被点击时恢复到最后知道的状态。如果用户没有正确登录，这当然会产生重大的安全问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:28:43.977

您是否在 flex 应用程序中维护会话 ID，并将其与新请求一起发送？

您能否测试并确认在 Flex 中的每个请求上，您的 PHP 脚本都返回了相同的会话 ID？

您是否将会话 ID 保存在 flex 应用程序之外的 cookie 中？如果没有，您将在页面刷新时丢失会话 ID。您需要存储在本地存储或 cookie 中，并在您的 flex 应用程序启动时访问它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T14:17:39.510

你的问题在这里

```
 else 
                    {
            $session['id']=session_id();
            $session['username']=$username;
            return 'yes';
                    }
            } 
```

$session 未定义...如果您想在会话数组中存储某些内容，请使用 $_SESSION

# sql - SQL Server 视图：如何使用插值添加缺失的行

> ID：920776
> 
> 赞同：8
> 
> 时间：2009-05-28T13:15:09.903
> 
> 标签：sql, sql-server, sql-view, linear-interpolation

遇到问题。

我定义了一个表格来保存每日国债[**收益率曲线**](http://www.treas.gov/offices/domestic-finance/debt-management/interest-rate/yield.shtml)的值。

这是一个用于历史查找值的非常简单的表。

表中的年份`4`、`6`、`8`、`9`和明显存在一些差距。`11-19``21-29`

`4`计算年份的公式非常简单`0.5*Year3Value + 0.5*Year5Value`。

问题是我怎样才能写一个`VIEW`可以返回丢失的年份？

我可能可以在存储过程中做到这一点，但最终结果需要是一个视图。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T14:29:29.347

假设*Tom H.*您真正想要的是线性插值，并且不仅缺少年，而且缺少几个月的事实，您需要将每个计算都基于 MONTH，而不是 YEAR。

对于下面的代码，我假设您有 2 个表（其中一个可以作为视图的一部分计算）：

*   Yield：包含真实数据并以月数而不是名称存储*PeriodM 。*如果您将*PeriodName*存储在那里，您只需要加入表格：
*   期间*（可以在视图中计算，如图所示）*：存储期间名称和它代表的月数

以下代码必须有效（您只需要基于它创建一个视图）：

```
WITH "Period" (PeriodM, PeriodName) AS (
    -- // I would store it as another table basically, but having it as part of the view would do
                SELECT  01, '1 mo'
    UNION ALL   SELECT  02, '2 mo' -- // data not stored
    UNION ALL   SELECT  03, '3 mo'
    UNION ALL   SELECT  06, '6 mo'
    UNION ALL   SELECT  12, '1 yr'
    UNION ALL   SELECT  24, '2 yr'
    UNION ALL   SELECT  36, '3 yr'
    UNION ALL   SELECT  48, '4 yr' -- // data not stored
    UNION ALL   SELECT  60, '5 yr'
    UNION ALL   SELECT  72, '6 yr' -- // data not stored
    UNION ALL   SELECT  84, '7 yr'
    UNION ALL   SELECT  96, '8 yr' -- // data not stored
    UNION ALL   SELECT 108, '9 yr' -- // data not stored
    UNION ALL   SELECT 120, '10 yr'
    -- ... // add more
    UNION ALL   SELECT 240, '20 yr'
    -- ... // add more
    UNION ALL   SELECT 360, '30 yr'
)
, "Yield" (ID, PeriodM, Date, Value) AS (
    -- // ** This is the TABLE your data is stored in **
    -- // 
    -- // value of ID column is not important, but it must be unique (you may have your PK)
    -- // ... it is used for a Tie-Breaker type of JOIN in the view
    -- //
    -- // This is just a test data:
                SELECT 101, 01 /* '1 mo'*/, '2009-05-01', 0.06
    UNION ALL   SELECT 102, 03 /* '3 mo'*/, '2009-05-01', 0.16
    UNION ALL   SELECT 103, 06 /* '6 mo'*/, '2009-05-01', 0.31
    UNION ALL   SELECT 104, 12 /* '1 yr'*/, '2009-05-01', 0.49
    UNION ALL   SELECT 105, 24 /* '2 yr'*/, '2009-05-01', 0.92
    UNION ALL   SELECT 346, 36 /* '3 yr'*/, '2009-05-01', 1.39
    UNION ALL   SELECT 237, 60 /* '5 yr'*/, '2009-05-01', 2.03
    UNION ALL   SELECT 238, 84 /* '7 yr'*/, '2009-05-01', 2.72
    UNION ALL   SELECT 239,120 /*'10 yr'*/, '2009-05-01', 3.21
    UNION ALL   SELECT 240,240 /*'20 yr'*/, '2009-05-01', 4.14
    UNION ALL   SELECT 250,360 /*'30 yr'*/, '2009-05-01', 4.09
)
, "ReportingDate" ("Date") AS (
    -- // this should be a part of the view (or a separate table)
    SELECT DISTINCT Date FROM "Yield"
)

-- // This is the Final VIEW that you want given the data structure as above
SELECT      d.Date, p.PeriodName, --//p.PeriodM,
            CAST(
                COALESCE(y_curr.Value,
                    (   (p.PeriodM - y_prev.PeriodM) * y_prev.Value
                    +   (y_next.PeriodM - p.PeriodM) * y_next.Value
                    ) / (y_next.PeriodM - y_prev.PeriodM)
                ) AS DECIMAL(9,4) -- // TODO: cast to your type if not FLOAT
            )  AS Value
FROM        "Period" p
CROSS JOIN  "ReportingDate" d
LEFT JOIN   "Yield" y_curr
        ON  y_curr.Date = d.Date
        AND y_curr.PeriodM = p.PeriodM
LEFT JOIN   "Yield" y_prev
        ON  y_prev.ID = (SELECT TOP 1 y.ID FROM Yield y WHERE y.Date = d.Date AND y.PeriodM <= p.PeriodM ORDER BY y.PeriodM DESC)
LEFT JOIN   "Yield" y_next
        ON  y_next.ID = (SELECT TOP 1 y.ID FROM Yield y WHERE y.Date = d.Date AND y.PeriodM >= p.PeriodM ORDER BY y.PeriodM ASC)

--//WHERE       d.Date = '2009-05-01' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:54:13.147

我将猜测如果存在差距，您希望曲线在两年之间平稳移动，因此如果缺少一年以上，您不想只平均最接近的两年。这是我可能会使用的：

```
SELECT
     NUM.number AS year,
     COALESCE(YC.val, YC_BOT.val + ((NUM.number - YC_BOT.yr) * ((YC_TOP.val - YC_BOT.val)/(YC_TOP.yr - YC_BOT.yr))))
FROM
     dbo.Numbers NUM
LEFT OUTER JOIN dbo.Yield_Curve YC ON
     YC.yr = NUM.number
LEFT OUTER JOIN dbo.Yield_Curve YC_TOP ON
     YC.yr IS NULL AND       -- Only join if we couldn't find a current year value
     YC_TOP.yr > NUM.number
LEFT OUTER JOIN dbo.Yield_Curve YC_TOP2 ON
     YC_TOP2.yr > NUM.number AND
     YC_TOP2.yr < YC_TOP.yr
LEFT OUTER JOIN dbo.Yield_Curve YC_BOT ON
     YC.yr IS NULL AND       -- Only join if we couldn't find a current year value
     YC_BOT.yr < NUM.number
LEFT OUTER JOIN dbo.Yield_Curve YC_BOT2 ON
     YC_BOT2.yr < NUM.number AND
     YC_BOT2.yr > YC_BOT.yr
WHERE
     YC_TOP2.yr IS NULL AND
     YC_BOT2.yr IS NULL AND
     NUM.number BETWEEN @low_yr AND @high_yr 
```

您可以使用 CTE 而不是 Numbers 表（只是一个连续数字表）重写它。如果你想这样做，你也可以使用 NOT EXISTS 或带有 MIN 和 MAX 的子查询，而不是 YC_BOT2 和 YC_TOP2 上的 LEFT OUTER JOIN。有些人觉得这种方法令人困惑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:30:40.277

您可以尝试 unpivot 以获取列表中的年份和值。

然后将此与缺少的年份结合起来 select YearNo ，（选择 YearValue where YearNo = YearNo-1）* 0.5 +（select YearValue where YearNo = YearNo+1）* 0.5 AS YearValue from unpivotedlist where YearNo in（我们缺少的年份列表）

然后再次将其重新旋转以获得所需的格式并将其弹出到视图中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:24:10.837

```
WITh cal(year) AS
        (
        SELECT  1 AS current_year
        UNION ALL
        SELECT  year + 1
        FROM    cal
        WHERE   year < 100
        )
SELECT  CASE WHEN yield_year IS NULL THEN
             0.5 *
             (
             SELECT  TOP 1 yield_value
             FROM    yield
             WHERE   yield_year < year
             ORDER BY
                     yield_year DESC
             ) +
             0.5 *
             (
             SELECT  TOP 1 yield_value
             FROM    yield
             WHERE   yield_year > year
             ORDER BY
                     yield_year ASC
             )
         ELSE
             yield_value
         END
FROM     cal
LEFT JOIN
         yield
ON       yield_year = year 
```

对于缺失年份，此查询采用找到的最接近年份的平均值。

# plone - plone + formlib：如何引用 form.pt

> ID：920782
> 
> 赞同：0
> 
> 时间：2009-05-28T13:16:12.443
> 
> 标签：plone, zope, zpt, plone-3.x, template-metal

我正在使用 plone 3.2.1 并且我使用自定义模板制作了一个 formlib 的表单：

```
from Products.Five.formlib import formbase
from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile
...

class MyForm(formbase.PageForm):
    ...

    template = ViewPageTemplateFile('myform.pt') 
```

我想对标准的 formlib 模板进行简单的更改。我的问题是：如何在我的模板中引用parts/zope2/lib/python/zope/formlib/pageform.pt？

```
<!-- myform.pt -->
<metal:macro metal:use-macro="WHAT GOES HERE??">
  <div metal:fill-slot="extra-info">
    I just want to put a text before the standard formlib template
  </div>
</metal:macro> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T12:28:23.763

最后，我找到了答案：

```
<html xmlns="http://www.w3.org/1999/xhtml"                                            
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master">
<body>
  <div metal:fill-slot="main">
    <div metal:use-macro="context/@@base-pageform.html/macros/form">
      <metal:block fill-slot="extra_info">
        <!-- HERE we go -->
      </metal:block>
    </div>
  </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-29T00:38:03.047

请注意那里（对于任何寻找这个的人，比如我）：这条线：

```
<divmetal:fill-slot="main"> 
```

在 div 和 metal 之间需要一个空间：

```
<div metal:fill-slot="main"> 
```

谢谢; 非常有用的解决方案。

# c# - 动态用户配置问题

> ID：920784
> 
> 赞同：0
> 
> 时间：2009-05-28T13:16:24.267
> 
> 标签：c#, app-config

我正在开发一个基于扩展名对文件进行排序的程序

我目前使用内部字典来存储扩展名/位置

```
.jpg  / c:\blab blab\my documents\my pictures
.mp3 / c:\blab blab\my documents\my music
.gno / c:\familytree 
```

ETC

我想让这个程序对我来说不那么具体，并允许用户配置哪些文件夹被监视以及什么类型的文件扩展名放在哪里

我遇到的问题是我不确定如何编写/显示将存储扩展关联的用户配置部分

理想情况下，我想将它们显示在 datagridview 或类似的东西中，但我完全不知道该怎么做

谢谢你能帮忙（或者即使你不能）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T13:36:31.840

请查看此[问题线程](https://stackoverflow.com/questions/716564/can-not-save-application-settings-in-net-3-5)或此[帖子](http://www.c-sharpcorner.com/UploadFile/yougerthen/204082008064658AM/2.aspx)。您还可以使用设置来存储所需的路径。

否则很难将它们保存在注册表中。看看这篇[文章](http://codehill.com/2009/03/a-registry-viewer-in-c/)开始。

# java - 服务器上从 SVN 到 Tomcat 的 Java 类文件：如何自动编译？

> ID：920794
> 
> 赞同：1
> 
> 时间：2009-05-28T13:18:06.120
> 
> 标签：java, svn, tomcat

我目前正在修复一个 JSP 项目，它目前在 Tomcat 的 WEB-INF 文件夹中有一个看似随机的 .class 文件集合。作为简化的一种方式，我计划从这些类中直接获取 .java 文件，从 SVN 到服务器上的 WEB-INF 文件夹，我得到了它的工作，但是编译这些最简单的方法是什么？当然，我可以创建一个 cronjob，它会在夜间编译所有类，但这似乎有点麻烦。

我知道我们的项目管理有点搞砸了，将应用程序部署到服务器上的正确方法可能是使用 WAR 文件。我正在尝试以较小的增量步骤解决此问题，因为该项目非常大并且一直在使用中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T13:25:10.570

Tomcat 仅编译 .jsp 文件，因此您必须自己编译 .java 文件，一种或另一种方式。

最强大的解决方案是创建一个 ant 任务，为整个项目构建一个 .war 文件，然后将其推送到 Tomcat（或使用 Maven2 来实现）。虽然现在这需要一些工作，但从长远来看，它将为您节省大量的精力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:46:20.323

您可能会考虑从您的构建/开发框上的 *.java 文件构建一个 jar 文件，然后将该 jar 文件推送到服务器。在 VCS 中存储类文件是一个非常糟糕的主意。

另一种方法可能是执行以下操作

假设：

> /opt/apache-tomcat/

保存您的应用服务器，创建如下内容：

> /选择/构建/

将您的文件检出到构建目录中，然后使用一个或多个脚本进行复制

> /opt/build/my-app/ --> /opt/apache-tomcat/webapps/my-app/

一旦你有了这样的工作，试着让一个可重复的（和可验证的）构建工作。理想情况下是战争文件。

# asp.net - 谁能帮我这个？在客户端部分刷新更新面板

> ID：920805
> 
> 赞同：0
> 
> 时间：2009-05-28T13:19:44.933
> 
> 标签：asp.net, vb.net, gridview, updatepanel

我有一个动态创建的 gridview 按钮，单击时会触发模式弹出窗口。我在客户端这样做是这样的：

```
function openModal(btnId, v) {
deptdata(v);
   // __doPostBack('<%=DropDownList1.ClientID %>', '');
    btn = document.getElementById(btnId);
    btn.click();
}
function deptdata(v) {
    document.getElementById('<%=vendor.ClientID%>').value = v;

} 
```

这就是代码中函数的调用方式。

```
btnedit.OnClientClick = String.Format("openModal('{0}','" & GridView1.Rows(i).Cells(0).Text & "');return false;", hidden.ClientID) 
```

我设置了隐藏字段（供应商）的值，但我需要该值用于模式弹出窗口中的内容。我有一个取决于新设置的变量的下拉列表。根据单击的行设置变量。所以我需要以某种方式重新加载该弹出窗口。我有一个更新面板，但我无法重新加载该面板。我试过 __doPostback 并没有帮助。任何想法如何使用javascript更新面板或面板中的下拉菜单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T21:00:57.233

It's not very clear from your description and the limited code you provide what it is exactly that you are trying to do and what is failing. However, the following might give you some ideas. If you provide more detail and code someone might be able to give you a better answer.

ScriptManager1.RegisterAsyncPostBackControl(Button1);

to trigger an update panel post back from js make sure you use UniqueID, not ClientID, thats a common gotcha that prevents the async postback from working.

__doPostBack("<%=Button1.UniqueID %>", "");

Personally, I have all but given up on UpdatePanels, I only use them in the most trivial cases. I prefer to have my js call an ASP.Net JSON webservice and have the on completed function render any needed changes to the html. It's more flexible, lighter and infinitely faster for pages with large grids or a lot of controls.

# java - 基于日内瓦的 STS、Java 互操作

> ID：920809
> 
> 赞同：3
> 
> 时间：2009-05-28T13:20:49.500
> 
> 标签：java, .net, wcf, web-services, geneva-framework

我想测试我的基于日内瓦的联合安全服务是否可以与 NetBeans/WSIT 一起使用。有没有类似分步指南的东西？服务器端使用“基于 HTTPS 的消息凭据”安全模式，而我看到的所有示例都依赖于消息级加密，并专注于从 Java RP 服务使用 .net STS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-07T07:38:19.577

这里有一些链接。

[mszCool：身份互操作性 - 带有 .NET 客户端和 Netbeans 6.5 / Metro 1.3 / WSIT / Java 客户端的日内瓦 Beta 1 STS。](http://blogs.msdn.com/mszcool/archive/2009/01/23/identity-interoperability-geneva-beta-1-sts-with-net-client-and-netbeans-6-5-metro-1-3-wsit-java-client-working-again.aspx).

[WSIT 教程](http://java.sun.com/webservices/reference/tutorials/wsit/doc/index.html)。

[WSIT 文档：安全机制](https://wsit-docs.dev.java.net/releases/1.1/ahicu.html#ahicx)：

> 但是，消息安全机制需要比 GlassFish 提供的更新版本的证书。[您可以按照手动更新 GlassFish 证书](https://wsit-docs.dev.java.net/releases/1.1/ahidm.html#gfrgz)中的说明为客户端和服务器下载有效的密钥库和信任库文件。
> 
> 要使用此机制，请遵循[为您的应用程序配置 SSL](https://wsit-docs.dev.java.net/releases/1.1/ahidh.html#ahidi)中的步骤。
> 
> 另请参阅：[示例：传输安全 (SSL)](https://wsit-docs.dev.java.net/releases/1.1/ahiei.html#ahiep)。

# wpf - 如何轻松地将 WPF 转换器项模板添加到 Visual Studio？

> ID：920815
> 
> 赞同：0
> 
> 时间：2009-05-28T13:21:46.333
> 
> 标签：wpf, visual-studio, converters

我发现自己经常**创建转换器**并且希望能够：

*   右键单击我的转换器文件夹
*   添加新项目...
*   选择转换器项目模板

我找到了[这些说明](http://www.switchonthecode.com/tutorials/visual-studio-how-to-create-item-templates)，但我可以想象在某处已经有**WPF 转换器等标准文件的模板**，有人知道吗？

将创建以下文件：

```
[ValueConversion(typeof(string), typeof(string))]
class SaveStatusToSaveStatusMessageConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return value;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return value;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T15:06:42.453

nerd+art 片段有一个名为 nerd_vc 的片段，它会为您生成一个 valueconverter。您可以根据自己的喜好自定义它，祝您好运！

[http://www.blendables.com/files/folders/nerd_43_art/entry387.aspx](http://www.blendables.com/files/folders/nerd_43_art/entry387.aspx)

哦。对不起，我累了。你想要的不是片段......我会在这里留下艰难的帖子:)

# .net - .NET 数据适配器超时 SP 问题

> ID：920821
> 
> 赞同：0
> 
> 时间：2009-05-28T13:23:35.347
> 
> 标签：.net, sql-server, dataadapter

我们有一个 SQL Server 存储过程，可以直接在 SQL Manager 中正常运行，进行相当大的计算，但最多只需要 50-10 秒即可运行。

但是，当我们通过数据适配器从 .NET 应用程序调用它时，它会超时。然而超时发生在超时时间之前，我们将它设置为 60 秒，它仍然会在大约 20 秒或更短的时间内超时。

我已经用谷歌搜索了这个问题，并看到其他人注意到 SP 直接工作但通过数据适配器调用很慢的问题。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T13:55:55.873

当你说它直接在SSMS中运行良好时，你的意思是执行存储过程本身运行良好，还是底层SQL运行良好？

根据您的描述，这听起来像是参数嗅探的示例。基本上，SQL Server 已经缓存了一个执行计划，该计划对于一组参数来说是最佳的，但对于大多数其他参数来说却非常糟糕。

您可以在存储过程中的查询上使用 RECOMPILE 选项来强制在每次执行时重新编译。如果不经常调用或者编译时间不长，可以利用[这个技巧](http://www.sqlmag.com/Article/ArticleID/94369/sql_server_94369.html)。

另一种解决方案是将存储过程参数复制到局部变量中并在查询中使用它们。例子：

```
CREATE PROCEDURE my_proc
  @var1 INT
AS
  DECLARE @_var1 AS INT;
  SET @_var1 = @var1;

  SELECT col1, col2, col3
    FROM t1
   WHERE t1.pk = @_var1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:17:13.287

确保您已检查所有超时。我不知道您使用的是 asp.net 还是 winforms，但至少此列表的前两个将适用：
[超时期限未过去，但仍超时（请参阅代码）？](https://stackoverflow.com/questions/848628/time-out-period-not-elapsed-but-still-timing-out-see-code/848664#848664)

要检查的另一件事是您是否正确设置了参数。做错可能会破坏索引。我看到的地方是当您在对查询至关重要的 varchar 列上有一个索引，并使用普通的“AddWithValue()”或其他未明确设置的函数为该列设置参数时类型。.Net 默认会给你一个*nvarchar*参数，因为 .Net 中的字符串是 unicode。结果是它不能使用索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T16:17:00.050

更改 SqlConnection 对象的超时属性

# c++ - 游戏逻辑的异步屏幕更新，C++

> ID：920829
> 
> 赞同：5
> 
> 时间：2009-05-28T13:24:42.347
> 
> 标签：c++, multithreading, asynchronous, ogre3d

我正在使用 Visual C++ 2008 Express 和 Ogre3D sdk 编写游戏。

我的核心游戏逻辑设计为每秒运行 100 次。为简单起见，我会说这是一个名为“gamelogic()”的方法。它不是基于时间的，这意味着如果我想“提前”游戏时间 1 秒，我必须调用 'gamelogic()' 100 次。与游戏的屏幕渲染相比，'gamelogic()' 是轻量级的。

Ogre 有一个“监听器”逻辑，当它要绘制一个框架以及它何时完成绘制一个框架时，它会通知你的代码。如果我只是在帧渲染之前调用'gamelogic()'，那么游戏玩法将受到屏幕渲染速度的极大影响，屏幕渲染速度可能从 5 fps 到 120 fps 不等。

想到的简单解决方案是：计算自上次渲染帧以来经过的时间，并在下一帧之前多次调用“gamelogic（）”：100 * timeElapsedInSeconds

但是，我认为“正确”的方法是使用多线程。有一个单独的线程运行 'gamelogic()' 100 次/秒。

问题是，我如何实现这一点以及当 2 个单独的线程之间存在冲突时可以做什么：gamelogic 更改屏幕内容（3d 对象坐标），而 Ogre 同时渲染屏幕。

提前谢谢了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T14:16:54.880

如果这是您的第一个游戏应用程序，那么使用多线程来实现您的结果可能比您在第一个游戏中真正应该处理的工作要多。在不同线程中同步游戏循环和渲染循环并不是一个容易解决的问题。

正如您正确指出的那样，渲染时间会极大地影响游戏的“速度”。我建议你不要让你的游戏逻辑依赖于设定的时间片（即 1/100 秒）。使其依赖于当前帧时间（好吧，最后一个帧时间，因为您不知道当前帧需要多长时间才能渲染）。

通常我会写如下的内容（我写的内容被**大大**简化了）：

```
float Frametime = 1.0f / 30.0f;
while(1) {
    game_loop(Frametime);      // maniuplate objects, etc.
    render_loop();             // render the frame
    calculate_new_frametime();
} 
```

其中 Frametime 是当前帧所用的计算帧时间。当您处理游戏循环时，您使用的是前一帧的帧时间（因此将初始值设置为合理的值，例如 1/30 秒或 1/15 秒）。在前一帧时间运行它足够接近以获得所需的结果。使用那个时间框架运行你的游戏循环，然后渲染你的东西。您可能必须更改游戏循环中的逻辑以不假定固定的时间间隔，但通常这些修复非常容易。

异步游戏/渲染循环可能是您最终需要的东西，但这是一个难以解决的问题。它涉及获取对象及其相关数据的快照，将这些快照放入缓冲区，然后将缓冲区传递给渲染引擎。该内存缓冲区必须围绕关键部分正确分区，以避免在渲染循环正在读取它时让游戏循环写入它。在传递给渲染循环之前，您必须注意确保将所有相关数据复制到缓冲区中。此外，您必须编写逻辑来停止游戏或渲染循环，同时等待其中一个或另一个完成。

这种复杂性是我建议首先以更连续的方式编写它的原因（除非你有经验，你可能会这样做）。原因是首先以“简单”的方式进行操作将迫使您了解代码的工作原理，渲染引擎的工作原理，渲染引擎需要什么样的数据等。复杂的游戏开发肯定需要多线程知识这些天来，但要知道如何做好它需要深入了解游戏系统如何相互交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-05T09:13:45.377

您的核心游戏逻辑运行速度快于玩家的响应速度并没有太多好处。唯一真正有用的是物理模拟，以快速、固定的时间步长运行可以使模拟的行为更加一致。

除此之外，只需每帧更新一次游戏循环，并传入可变时间增量，而不是依赖固定时间增量。与成本相比，您从多线程中获得的好处是微乎其微的，尤其是如果这是您的第一款游戏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-05T09:05:35.503

双缓冲可渲染对象是您可以探索的一种方法。意思是，渲染组件正在使用 1 个缓冲区，当所有游戏动作都更新了第 2 个缓冲区中的相关对象时，该缓冲区会更新。

但我个人不喜欢它，我会（并且经常）采用马克的方法。

# rotation - UIImage Picker自动旋转功能突然消失

> ID：920830
> 
> 赞同：1
> 
> 时间：2009-05-28T13:24:42.487
> 
> 标签：rotation, uiimagepickercontroller, orientation, preview

我使用`UIImagePickerController`没有任何问题。

在我以横向模式拍照之前，*预览*中的图片（当存在重拍和使用照片按钮时）总是自动旋转，以便在纵向模式下正确显示。

但是现在当我使用`UIImagePickerController`预览模式时不再旋转图片了。

我在哪里可以激活或停用此模式？

这是我的代码：

```
- (IBAction)getCameraPicture{

    //Create an UIImagePickerController to be able to take a picture
    UIImagePickerController *picker = [[UIImagePickerController alloc] init];
    picker.delegate = self;
    picker.sourceType = UIImagePickerControllerSourceTypeCamera;

    picker.allowsImageEditing = NO;
    [self presentModalViewController:picker animated:YES];
    [picker release]; 

- (IBAction)selectExistingPicture{

    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary]) {
        UIImagePickerController *picker = [[UIImagePickerController alloc] init];
        picker.delegate = self;
        picker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;//Here is specified the fact that the picker source is the library
        [self presentModalViewController:picker animated:YES];
        [picker release];
    }
    else {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error accessing photo library" message:@"Device does not support a photo library" delegate:nil cancelButtonTitle:@"Drat!" otherButtonTitles:nil];
        [alert show];
        [alert release];
    }
}

- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo {

    int imageCase=0;
    UIImage *imageSaved=rotateImage(image);
    UIImage* imageNormal =scaleImage(imageSaved,imageCase);

    imageView.image = imageNormal;

    [picker dismissModalViewControllerAnimated:YES];

}

- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker {

    [picker dismissModalViewControllerAnimated:YES];
} 
```

我真的需要至少了解正在发生的事情，所以即使不是解决方案，任何帮助都会非常感激！

谢谢各位！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-06T08:40:38.250

一种可能性是您需要致电

```
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications]; 
```

# java - 自定义加入 Hibernate 上的实体

> ID：920833
> 
> 赞同：1
> 
> 时间：2009-05-28T13:25:17.090
> 
> 标签：java, hibernate, join, ejb, one-to-many

我们有一个带有注释的基于 Hibernate 的系统。

我们的实体有一个自定义属性 DELETED。我们必须选择具有未删除子实体的未删除实体。我们怎么能做到呢？

描述情况的小样本：

```
GenericEntity {
    ...
    @Basic
    @Column(name = DELETED)
    protected Boolean deleted = false;

    @ManyToOne
    @JoinColumn(name = LOCATION, nullable = false)
    protected Location location;        
} 
```

Location 扩展了 GenericEntity 实体，并且还具有 DELETED 属性。

我们如何选择一些未删除的具有未删除位置的 GenericEntities？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T13:57:11.160

这个 HQL 应该可以工作

```
select * from GenericEntity g where g.deleted = false and g.location.deleted = false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:02:19.417

请注意，通过使用 Aaron 所做的别名 (g)，您可以访问实体属性。

# c# - 如何从外部程序集中访问内部类？

> ID：920844
> 
> 赞同：112
> 
> 时间：2009-05-28T13:27:57.007
> 
> 标签：c#, class

有一个我无法修改（供应商提供）的程序集，它有一个返回***对象***类型但实际上是内部类型的方法。

如何从我的程序集中访问对象的字段和/或方法？

请记住，我无法修改供应商提供的程序集。

本质上，这就是我所拥有的：

来自供应商：

```
internal class InternalClass
  public string test;
end class

public class Vendor
  private InternalClass _internal;
  public object Tag {get{return _internal;}}
end class 
```

从我的程序集中使用供应商程序集。

```
public class MyClass
{
  public void AccessTest()
  {
    Vendor vendor = new Vendor();
    object value = vendor.Tag;
    // Here I want to access InternalClass.test
  }
} 
```

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2009-06-12T00:52:31.950

我只看到一种情况，您允许您的内部成员接触另一个程序集，这是出于测试目的。

说有一种方法可以允许“朋友”程序集访问内部：

在项目的 AssemblyInfo.cs 文件中，为每个程序集添加一行。

```
[assembly: InternalsVisibleTo("name of assembly here")] 
```

此信息可[在此处获得。](http://msdn.microsoft.com/en-us/library/0tke9fxk.aspx)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2009-05-28T13:32:51.100

如果无法访问类型（并且没有“InternalsVisibleTo”等），您将不得不使用反射。但更好的问题是：您是否*应该*访问这些数据？它不是公共类型合同的一部分……在我看来，它应该被视为一个不透明的对象（出于他们的目的，而不是您的目的）。

您已将其描述为公共实例字段；通过反射得到这个：

```
object obj = ...
string value = (string)obj.GetType().GetField("test").GetValue(obj); 
```

如果它实际上是一个属性（不是一个字段）：

```
string value = (string)obj.GetType().GetProperty("test").GetValue(obj,null); 
```

如果它是非公开的，则需要使用/的`BindingFlags`重载。`GetField``GetProperty`

**重要**的是：小心这样的反射；实现可能会在下一个版本中更改（破坏您的代码），或者它可能被混淆（破坏您的代码），或者您可能没有足够的“信任”（破坏您的代码）。你发现模式了吗？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-06-02T13:03:24.737

我想争论一点——你不能增加原始程序集——使用 Mono.Cecil 你可以注入`[InternalsVisibleTo(...)]`3pty 程序集。请注意，这可能会产生法律影响——你正在搞乱 3pty 程序集和技术问题——如果程序集有强名称，你要么需要剥离它，要么用不同的密钥重新签名。

```
 Install-Package Mono.Cecil 
```

代码如下：

```
static readonly string[] s_toInject = {
  // alternatively "MyAssembly, PublicKey=0024000004800000... etc."
  "MyAssembly"
};

static void Main(string[] args) {
  const string THIRD_PARTY_ASSEMBLY_PATH = @"c:\folder\ThirdPartyAssembly.dll";

   var parameters = new ReaderParameters();
   var asm = ModuleDefinition.ReadModule(INPUT_PATH, parameters);
   foreach (var toInject in s_toInject) {
     var ca = new CustomAttribute(
       asm.Import(typeof(InternalsVisibleToAttribute).GetConstructor(new[] {
                      typeof(string)})));
     ca.ConstructorArguments.Add(new CustomAttributeArgument(asm.TypeSystem.String, toInject));
     asm.Assembly.CustomAttributes.Add(ca);
   }
   asm.Write(@"c:\folder-modified\ThirdPartyAssembly.dll");
   // note if the assembly is strongly-signed you need to resign it like
   // asm.Write(@"c:\folder-modified\ThirdPartyAssembly.dll", new WriterParameters {
   //   StrongNameKeyPair = new StrongNameKeyPair(File.ReadAllBytes(@"c:\MyKey.snk"))
   // });
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T13:34:46.367

反射。

```
using System.Reflection;

Vendor vendor = new Vendor();
object tag = vendor.Tag;

Type tagt = tag.GetType();
FieldInfo field = tagt.GetField("test");

string value = field.GetValue(tag); 
```

明智地使用权力。不要忘记错误检查。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-10-13T07:29:40.493

在 .NET 5 中，可以将 InternalsVisibleToAttribute 添加到 .csproj：

```
<ItemGroup>
    <AssemblyAttribute Include="System.Runtime.CompilerServices.InternalsVisibleToAttribute">
      <_Parameter1>Core.Tests</_Parameter1>
    </AssemblyAttribute>
</ItemGroup> 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-28T13:34:42.420

好吧，你不能。内部类在它们的程序集之外是不可见的，因此没有直接访问它的显式方法——当然是AFAIK。唯一的方法是通过反射使用运行时后期绑定，然后您可以间接从内部类调用方法和属性。

# java - Java ME 6 中的 BufferedImage 类发生了什么？

> ID：920850
> 
> 赞同：0
> 
> 时间：2009-05-28T13:28:56.600
> 
> 标签：java, netbeans, java-me, netbeans6.5

从我的 java se 小知识我想尝试一个关于 Java ME 的教程。我有 Netbeans 6.5.1（带有移动包）并在我的 windows xp sp2 上安装了 Java 6 update 13。我已经到达了一个阶段他们使用 BufferedImage 的教程似乎在 java.io、java.nio.Buffer、javax.microedition.io 或 javax.microedition.m3g.Image2D 上都找不到。

这是教程中的coce

```
ByteArrayInputStream in = new ByteArrayInputStream(getService().getDailyDilbertSoap().dailyDilbertImage());
    BufferedImage image = ImageIO.read(in);
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    ImageIO.write(image, "png", out);
    return out.toByteArray(); 
```

我如何实现这一点？BufferedImage 的替代品是什么？它是否已被弃用？它似乎在网络上没有太多信息，除非我在其他地方寻找它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T13:49:23.173

我假设您正在谈论[本](http://www.netbeans.org/kb/60/mobility/mobile-dilbert.html)教程：

您在上面粘贴的代码无法在 Java ME 设备上运行。它部署在 Java ME 客户端使用的 Web 服务实现中的 Glassfish（应用程序服务器）上。

# c# - 检查数据库是否可用？

> ID：920852
> 
> 赞同：0
> 
> 时间：2009-05-28T13:29:33.180
> 
> 标签：c#, database

我的问题涉及在从数据库读取之前检查我是否有有效的数据库连接。如果数据库已关闭，我想改为写入 xml 文件。我在运行时有数据库的位置（如果它已启动），所以如果数据库正在工作，我可以创建一个新的 sqlConnection 到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T13:33:09.633

我会使用类似的东西：

using(SqlConnection conn = new SqlConnection(c)) { conn.Open(); }

如果无效，它将抛出异常。您可以写入异常中的 xml。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T13:33:54.717

一个简单的方法是执行一个简单的查询并查看是否发生错误：

对于甲骨文：

```
SELECT * FROM DUAL 
```

对于 SQL 服务器

```
SELECT 1 
```

基本上只是某种相对“免费”的查询，它将让您知道数据库已启动并正在运行并响应请求并且您的连接没有超时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T13:46:30.230

使用典型的 try...catch...finally 结构，并根据具体的异常类型和消息，决定是否要写入 xml。

```
try
{
SqlConnection connection = new SqlConnection(DB("Your DB Name"));
connection.Open();
}
catch (Exception ex)
{
// check the exception message here, if it's telling you that the db is not available. then 
//write to xml file.
    WriteToXml();   
}
finally
{
  connection.Close();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:31:28.373

如果不实际打开与数据库的连接，您无法真正判断数据库是否已启动并运行。但是，在您使用它时连接可能会断开，因此应该考虑到这一点。

# c# - C#中的简单几何形状识别

> ID：920855
> 
> 赞同：4
> 
> 时间：2009-05-28T13:30:18.297
> 
> 标签：c#, geometry, shapes

我有一组笔触（来自墨水），并想找到那些参与几何形状的笔触，如线条、正方形、圆形、三角形......并识别它们。

到目前为止，我已经看到了许多适用于位图的算法。

我的问题*更容易*，因为我已经有了很好的点数。但仍然需要找到最接近的几何形状。谢谢约翰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T14:22:27.380

将笔画转换为矢量（例如角度）。例如：272、93、42、179 现在将这些角度与要识别的存储角度表进行比较：

例如形状：{{0,90,180,270}, {270, 90, 45, 180} }

对于每个表格条目，请执行以下操作： 对于每个角度，请执行以下操作 获取两个角度之间的绝对差，并将它们添加到运行总和存储运行总和

最小的runningtotal是它最相似的形状。

顺便提防找到两个角度之间的差异。存在环绕的问题。角度：359 和 1 相距很近……但如果你简单地将它们相减，它们看起来相距 358 度。

希望这是可以理解的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:41:59.537

你可以尝试机器学习技术来训练你感兴趣的形状的代码。这类似于很多人为 wii 遥控器识别手势所做的事情。这是一个例子：

[http://mm-werkstatt.informatik.uni-augsburg.de/project_details.php?id=46](http://mm-werkstatt.informatik.uni-augsburg.de/project_details.php?id=46)

# ruby - 对 Ruby 数组进行排序

> ID：920858
> 
> 赞同：0
> 
> 时间：2009-05-28T13:30:44.317
> 
> 标签：ruby, sorting

我正在尝试以最快的方式按升序对大型输入进行排序。代码是这样的：

```
t=gets
ti=t.to_i
r=[]
for i in(0..ti)
    k=gets
    r[i]=k.to_i
end
r.sort_by{|x| -x.last} 
```

这给了我一个错误说`undefined method 'last' for nil:nilclass <nomethoderror> from tsort.rb: in sort_by from tsort.rb in 'each' from tsort.rb in 'sort_by'`

我不知道我哪里错了。

这就是我尝试对数组进行排序的方法……其中`r[]`包含所有数字`t`！任何人都可以请帮忙。

我的输入小于 10^6！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T13:45:40.853

我无法重现您的确切错误，我明白了`undefined method 'last' for n:Fixnum (NoMethodError)`。这是有道理的，因为您正在调用`last`on 方法`x`，它将保存您的`Array` `r`, all的值`Fixnums`，它们没有`last`方法。

如果您将最后一行替换为：

```
r.sort 
```

默认情况下，该`sort`方法将按`Array`升序对您进行排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T13:57:52.920

如果要对从 STDIN 获取的整数列表进行排序，我建议如下：

```
lines = STDIN.readlines.map { |x| x.strip.to_i }.sort
puts lines.join(', ') 
```

它更干净、更*红润*、更快（阅读文档[`Enumerable.sort_by`](http://www.ruby-doc.org/core/classes/Enumerable.html#M003151)以了解为什么`sort`它是 的更好替代方案`sort_by`）。

我还看到您的代码需要一个表示要读取多少行的数字。您可以通过如下修改上面的示例来获得相同的行为：

```
line_count = gets.strip.to_i
lines = (1..line_count).collect { gets.strip.to_i }.sort
puts lines.join(', ') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:41:06.793

[尝试Array 上](http://www.ruby-doc.org/core/classes/Array.html#M002208)的排序功能，认为它可以满足您的需求。

# iphone - 有没有一种简单的方法可以在objective-c / iPhone-OS中获取对象的创建者对象？

> ID：920888
> 
> 赞同：1
> 
> 时间：2009-05-28T13:38:45.423
> 
> 标签：iphone, objective-c, cocoa-touch, uikit

例子：

我有一个继承自 UIImageView 的类。一个对象从该类创建一个实例。现在，该类需要对其父类的弱引用。我可以创建一个初始化程序，其中对象必须将“self”传递给新创建的对象。但我觉得有更好的方法。有没有？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T13:49:42.890

你可能想看看：

*   [**SO问题：如何向superview发送消息**](https://stackoverflow.com/questions/537853/how-to-message-superview-in-objective-c)
*   [**SO问题：代表和控制器的正确设计**](https://stackoverflow.com/questions/820808/objective-c-cocoa-proper-design-for-delegates-and-controllers/820995#820995)

基本上，这些问题得出的结论与此处得出的结论相同：没有内置方法。您需要参考自己，例如

```
-(id)initWithParent:(id)parent 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T13:52:53.070

不，没有。如果你需要这个，你必须在初始化期间或之后设置父级。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T13:42:50.503

我不认为有任何方法可以在本地语言中做到这一点。

即使这样的功能可用，您也会遇到的问题是，如果“父”对象已被释放，会发生什么？

# php - 开源 PHP 报告工具

> ID：920889
> 
> 赞同：14
> 
> 时间：2009-05-28T13:39:02.180
> 
> 标签：php, reporting

我正在开发基于 Web 的应用程序，我需要 php 报告库/类来简化工作。我需要 PDF/Excel 格式。基于相关数据库表（会员账单，会员信息）的报告是否有任何先进的开源解决方案？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T15:00:53.947

有大量的报告库，其中大多数创建 Xml 或 Csv。您必须提供更多关于您需要什么样的报告来获得推荐的数据。我还没有使用[PHPExcel](http://openxmldeveloper.org/articles/4606.aspx)，但这是我第一次尝试实际创建 Excel 文档，而不是创建将加载到 Excel 中的 CSV。PDF 创建是内置在 PHP 中的[PDF 函数](http://www.php.net/pdf)，并且相当容易做到。

**[更新]**

PHPExcel 已存档，现在您可以使用[PhpSpreadsheet](https://github.com/PHPOffice/PhpSpreadsheet)代替。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-10T12:38:00.027

我认为 PHP Report Maker 是最好的 php 报告工具，但它不是免费或开源的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-04-10T23:19:11.947

一个看起来很有前途的新库是[jdorn 在 github 上的 PHP Reports](http://jdorn.github.io/php-reports/)。

[这与Sourceforge 上托管的同名旧库](http://phpreports.sourceforge.net/)无关。

![基本报告图片](https://i.stack.imgur.com/quqDt.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-09-15T23:42:13.913

有点晚了，但您可能想查看 RLib - 适用于 PHP 和 MySQL 并创建多种不同的类型 - PDF、CSV、HTML 等。

[http://rlib.sicompos.com/](http://rlib.sicompos.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T14:55:28.390

不幸的是，我不知道 PHP 中有一个像样的报告类。

您需要完整的报告套件，还是只需能够将数据导出为 pdf 和 Excel 文件格式？

如果您只需要创建此类页面，最简单的解决方案是显示您需要的数据并添加可自行安装为打印机的 CutePdf 软件。然后，您可以从浏览器打印到 pdf。

如果需要在服务器端创建pdf文件，Zend Framework中有一个pdf创建库。ZendFramework-1.8.1\library\Zend\Pdf

# jquery - jQuery HTML 选择下拉需要两个值，但显示/提交一个。用于选择另一个下拉选项的第二个值

> ID：920896
> 
> 赞同：1
> 
> 时间：2009-05-28T13:41:12.067
> 
> 标签：jquery

好的，这里是：

我有一个带有美国州名的 SELECT 下拉选项

```
<select>
  <option value="ca">california</option>
  <option value="ut">utah</option>
  <option value="mi">michigan</option>
</select> 
```

但我还需要将另一个值与隐藏在页面视图中的值相关联。我不能使用 class、name 或 id 来填充第二个值，因为它们已经被使用了。并且 value 属性中只能有一个值，因为它正在被添加到数据库中。是否有另一个属性我可以将第二个值作为占位符或其他东西传递？true、false 和 undecided 值与数据库中的状态相关联，需要关联在一起。我想我也可以做一个隐藏的 SELECT 元素，但问题是如何将隐藏的 SELECT 与其他两个 SELECT 关联起来？

```
<select>
  <option value="ca">california</option> <!-- true-->
  <option value="ut">utah</option>       <!-- undecided-->
  <option value="mi">michigan</option>   <!-- false-->
  <option value="oh">ohio</option>       <!-- false-->
  <option value="az">arizona</option>    <!-- undecided-->
  <option value="dc">wash dc</option>    <!-- false-->
</select> 
```

现在，将第二个值（以某种方式）添加到第一个 SELECT 下拉列表中，我需要一种方法来根据选择的第一个 SELECT 下拉选项选择第二个 SELECT 下拉列表。

```
<select>
  <option value="t">true</option>
  <option value="f">false</option>
  <option value="u">undecided</option>
</select> 
```

因此，如果用户选择“wash dc”，则第二个 SELECT 下拉菜单应默认为 false。

如果这有帮助，我将 jQuery 用于 JavaScript，我想我可以做这个问题的第二部分，但我该如何做第一部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T13:48:48.477

您可以按如下方式使用类属性：

```
<select>
  <option class="someclass true" value="ca">california</option> <!-- true-->
  <option class="someclass undecided" value="ut">utah</option>  <!-- undecided-->
  <option class="someclass false" value="mi">michigan</option>  <!-- false-->
</select> 
```

class 属性可以包含多个由空格分隔的类。

您还可以创建自定义属性。不过，这会破坏您页面的 HTML(XHTML) 验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T13:50:29.503

在 JavaScript 中将信息作为数组加载。要么对其进行硬编码（不好），要么将其作为单独的 AJAX 查询发送（更好）。这既可以为您提供所需的数据，又可以在需要时更容易访问，因为它已经在内存中，而不是作为页面的一部分存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:26:26.530

> 不能使用类、名称或 id 来填充第二个值，因为它们已被使用。并且 value 属性中只能有一个值

好的，所以说你不能使用这些（常用）方法限制了你的选择。由于您已经在使用 jQuery，因此想到了 .data() 函数。它基本上允许您在任何给定的 DOM 对象上存储键/值对。因此，您可以浏览列表中的所有选项，然后

```
$('#selectID options').each(function(){
    $.data($(this), 'key', 'value')
}); 
```

有关 .data() 的更多信息在[这里](http://docs.jquery.com/Internals/jQuery.data)

**编辑：**

您的 HTML 结构不会有任何变化，这听起来像是在这种情况下的好处。.data() 函数只允许您为页面上任何现有的 html 元素存储“元数据”。如果您要在页面上查看源代码，则不会有此数据的踪迹。它存储在 jQuery 领域的某个地方，我无法确切说明这种机制是如何工作的，尽管我认为它只是基本 JavaScript 数组的抽象层。在这种情况下，您将为每个 <option> 元素附加一些数据。

因此，要设置数据，请使用如上所示的循环。然后要检索数据，您只需要知道当前选择了哪个选项，然后再次使用 .data() 和键来取回值。

```
var storedValue = $.data( $('#selectID option:selected'),'key' ) 
```

检索很容易，我希望您的挑战将是获取数据以便您可以设置它。一种方法是在服务器端生成 javascript，然后将其发送到页面。您最终可能不会使用循环，因为我将假设每个值都是唯一的，它可能看起来更像：

```
$.data( $('#selectID options:eq(0)'), 'key', 'value1' );
$.data( $('#selectID options:eq(1)'), 'key', 'value2' );
$.data( $('#selectID options:eq(2)'), 'key', 'value3' );
$.data( $('#selectID options:eq(3)'), 'key', 'value4' ); 
```

'value1' 可以是任何东西，包括一个 json 字符串，如果需要，它可以让您用一个键存储多个值。

最后，如果您要反复使用此功能，那么创建一个 jQuery 插件将非常容易，它可以让您用更少的工作量来完成此操作，但这是另一个问题的答案。

# string - 浮点到字符串：什么是指数部分？

> ID：920899
> 
> 赞同：0
> 
> 时间：2009-05-28T13:42:11.110
> 
> 标签：string, math, floating-point, exponent

我用 C 语言编写了一个小函数，它的工作几乎与标准函数“fcvt”相同。你可能知道，这个函数接受一个浮点数/双精度并创建一个字符串，用 ANSI 字符表示这个数字。一切正常;-)

例如，对于数字 1.33334，我的函数给了我字符串：“133334”并设置了特殊的整数变量 `decimal_part'，在这个例子中将是 1，这意味着十进制部分只有 1 个符号，其他都是分数。

现在我很好奇如何执行标准 C 函数“printf”。它可以采用 %a 或 %e 作为格式字符串。让我引用 %e （链接垃圾）：

> > "double" 参数以科学计数法输出
> > 
> > [-]m.nnnnnne+xx
> > 
> > ...指数始终包含两位数。

它说：“指数总是包含两位数”。但什么是指数？这是主要问题。还有，如何从我上面的函数或“fcvt”中获得这个“指数”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T13:51:11.373

如果我们扩展 e，这个符号可能会更好地解释：

```
[-]m.nnnnnn * (10^xx) 
```

所以你有 m 的一位数（从 0 到 9，但如果整个值为 0，它只会是 0）和 n 的几位数字。我想最好用例子来展示：

```
1 = 1.0000 * 10^0 = 1e0
10 = 1.0000 * 10^1 = 1e1
10000 = 1.0000 * 10^4 = 1e4
0.1 = 1.0000 * 10^-1 = 1e-1

1,419 = 1.419 * 10^3 = 1.419e3
0.00000123 = 1.23 * 10^-5 = 1.23e-5 
```

您可以在 Google 上查找科学记数法，但它对于表示非常大或非常小的数字很有用，例如 1232100000000000000 将是 1.2321e24（我实际上没有数过，指数可能不准确）。

在 C 语言中，我认为您实际上可以从前 12 位中提取指数（第一个是您必须忽略的符号）。请参阅：[IEEE758-1985 浮点](http://en.wikipedia.org/wiki/IEEE_754-1985)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T13:47:37.620

指数是 10 的幂次幂，然后乘以底数。

SI 在 wikipeida 上进行了解释。[http://en.wikipedia.org/wiki/Scientific_notation](http://en.wikipedia.org/wiki/Scientific_notation)

`m.nnnnnne+xx`逻辑上等于`m.nnnnnn * 10 ^ +xx`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:48:06.920

400 = 4 * 10 ^ 2

2 是指数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:49:59.613

在科学记数法中，指数是 XX 的 10 次方，因此 1234.5678 可以表示为 1.2345678E03，其中归一化形式乘以 10^3 得到“真实”答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T13:55:00.133

如果你用科学记数法写一个数字，那么指数就是该记数法的一部分。

你可以在这里看到完整的描述[http://en.wikipedia.org/wiki/Scientific_notation](http://en.wikipedia.org/wiki/Scientific_notation)，但基本上它只是另一种写数字的方式，通常用于非常大或非常小的数字。

假设您有数字 300，它等于 3 * 100，或科学计数法中的 3 * 10^2。

如果你使用 %e 它将被打印为 3.0e+02

# java - 从java中的套接字读取多个xml文档

> ID：920904
> 
> 赞同：3
> 
> 时间：2009-05-28T13:42:53.153
> 
> 标签：java, xml

我正在编写一个客户端，它需要通过套接字读取多个连续的小型 XML 文档。我可以假设编码始终是 UTF-8，并且文档之间可以选择分隔空格。文档最终应该进入 DOM 对象。实现这一目标的最佳方法是什么？

问题的本质是解析器期望流中有一个文档并考虑其余的内容垃圾。我认为我可以通过跟踪元素深度来人为地结束文档，并使用现有的输入流创建一个新的阅读器。例如：

```
// Broken 
public void parseInputStream(InputStream inputStream) throws Exception
{
    XMLInputFactory factory = XMLInputFactory.newInstance();
    XMLOutputFactory xof = XMLOutputFactory.newInstance();
    XMLEventFactory eventFactory = XMLEventFactory.newInstance();        
    DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();
    DocumentBuilder documentBuilder = documentBuilderFactory.newDocumentBuilder();
    Document doc = documentBuilder.newDocument();
    XMLEventWriter domWriter = xof.createXMLEventWriter(new DOMResult(doc));
    XMLStreamReader xmlStreamReader = factory.createXMLStreamReader(inputStream);
    XMLEventReader reader = factory.createXMLEventReader(xmlStreamReader);
    int depth = 0;

    while (reader.hasNext()) {
        XMLEvent evt = reader.nextEvent();
        domWriter.add(evt);

        switch (evt.getEventType()) {
        case XMLEvent.START_ELEMENT:
            depth++;
            break;

        case XMLEvent.END_ELEMENT:
            depth--;

            if (depth == 0) 
            {                       
                domWriter.add(eventFactory.createEndDocument());
                System.out.println(doc);
                reader.close();
                xmlStreamReader.close();

                xmlStreamReader = factory.createXMLStreamReader(inputStream);
                reader = factory.createXMLEventReader(xmlStreamReader);

                doc = documentBuilder.newDocument();
                domWriter = xof.createXMLEventWriter(new DOMResult(doc));    
                domWriter.add(eventFactory.createStartDocument());
            }
            break;                    
        }
    }
} 
```

但是，在 <a></a><b></b><c></c> 等输入上运行它会打印第一个文档并引发 XMLStreamException。这样做的正确方法是什么？

澄清：不幸的是，协议由服务器固定并且无法更改，因此添加长度或包装内容将不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T13:44:51.777

*   每个文档的长度前缀（以字节为单位）。
*   从套接字读取第一个文档的长度
*   从套接字读取那么多数据，将其转储到`ByteArrayOutputStream`
*   `ByteArrayInputStream`从结果中创建
*   解析它`ByteArrayInputStream`以获取第一个文档
*   重复第二个文件等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-06T15:10:59.667

只需更改为任何流

```
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.StringReader;

import javax.xml.namespace.QName;
import javax.xml.stream.XMLInputFactory;
import javax.xml.stream.XMLStreamConstants;
import javax.xml.stream.XMLStreamReader;

public class LogParser {

    private XMLInputFactory inputFactory = null;
    private XMLStreamReader xmlReader = null;
    InputStream is;
    private int depth;
    private QName rootElement;

    private static class XMLStream extends InputStream
    {
        InputStream delegate;
        StringReader startroot = new StringReader("<root>");
        StringReader endroot = new StringReader("</root>");

        XMLStream(InputStream delegate)
        {
            this.delegate = delegate;
        }

        public int read() throws IOException {
            int c = startroot.read();
            if(c==-1)
            {
                c = delegate.read();
            }
            if(c==-1)
            {
                c = endroot.read();
            }
            return c;
        }

    }

    public LogParser() {
        inputFactory = XMLInputFactory.newInstance();
    }

    public void read() throws Exception {
        is = new XMLStream(new FileInputStream(new File(
            "./myfile.log")));
        xmlReader = inputFactory.createXMLStreamReader(is);

        while (xmlReader.hasNext()) {
            printEvent(xmlReader);
            xmlReader.next();
        }
        xmlReader.close();

    }

    public void printEvent(XMLStreamReader xmlr) throws Exception {
        switch (xmlr.getEventType()) {
        case XMLStreamConstants.END_DOCUMENT:
            System.out.println("finished");
            break;
        case XMLStreamConstants.START_ELEMENT:
            System.out.print("<");
            printName(xmlr);
            printNamespaces(xmlr);
            printAttributes(xmlr);
            System.out.print(">");
            if(rootElement==null && depth==1)
            {
                rootElement = xmlr.getName();
            }
            depth++;
            break;
        case XMLStreamConstants.END_ELEMENT:
            System.out.print("</");
            printName(xmlr);
            System.out.print(">");
            depth--;
            if(depth==1 && rootElement.equals(xmlr.getName()))
            {
                rootElement=null;
                System.out.println("finished element");
            }
            break;
        case XMLStreamConstants.SPACE:
        case XMLStreamConstants.CHARACTERS:
            int start = xmlr.getTextStart();
            int length = xmlr.getTextLength();
            System.out
                    .print(new String(xmlr.getTextCharacters(), start, length));
            break;

        case XMLStreamConstants.PROCESSING_INSTRUCTION:
            System.out.print("<?");
            if (xmlr.hasText())
                System.out.print(xmlr.getText());
            System.out.print("?>");
            break;

        case XMLStreamConstants.CDATA:
            System.out.print("<![CDATA[");
            start = xmlr.getTextStart();
            length = xmlr.getTextLength();
            System.out
                    .print(new String(xmlr.getTextCharacters(), start, length));
            System.out.print("]]>");
            break;

        case XMLStreamConstants.COMMENT:
            System.out.print("<!--");
            if (xmlr.hasText())
                System.out.print(xmlr.getText());
            System.out.print("-->");
            break;

        case XMLStreamConstants.ENTITY_REFERENCE:
            System.out.print(xmlr.getLocalName() + "=");
            if (xmlr.hasText())
                System.out.print("[" + xmlr.getText() + "]");
            break;

        case XMLStreamConstants.START_DOCUMENT:
            System.out.print("<?xml");
            System.out.print(" version='" + xmlr.getVersion() + "'");
            System.out.print(" encoding='" + xmlr.getCharacterEncodingScheme()
                    + "'");
            if (xmlr.isStandalone())
                System.out.print(" standalone='yes'");
            else
                System.out.print(" standalone='no'");
            System.out.print("?>");
            break;

        }
    }

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub
        try {
            new LogParser().read();
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    private static void printName(XMLStreamReader xmlr) {
        if (xmlr.hasName()) {
            System.out.print(getName(xmlr));
        }
    }

    private static String getName(XMLStreamReader xmlr) {
        if (xmlr.hasName()) {
            String prefix = xmlr.getPrefix();
            String uri = xmlr.getNamespaceURI();
            String localName = xmlr.getLocalName();
            return getName(prefix, uri, localName);
        }
        return null;
    }

    private static String getName(String prefix, String uri, String localName) {
        String name = "";
        if (uri != null && !("".equals(uri)))
            name += "['" + uri + "']:";
        if (prefix != null)
            name += prefix + ":";
        if (localName != null)
            name += localName;
        return name;
    }   

    private static void printAttributes(XMLStreamReader xmlr) {
        for (int i = 0; i < xmlr.getAttributeCount(); i++) {
            printAttribute(xmlr, i);
        }
    }

    private static void printAttribute(XMLStreamReader xmlr, int index) {
        String prefix = xmlr.getAttributePrefix(index);
        String namespace = xmlr.getAttributeNamespace(index);
        String localName = xmlr.getAttributeLocalName(index);
        String value = xmlr.getAttributeValue(index);
        System.out.print(" ");
        System.out.print(getName(prefix, namespace, localName));
        System.out.print("='" + value + "'");
    }

    private static void printNamespaces(XMLStreamReader xmlr) {
        for (int i = 0; i < xmlr.getNamespaceCount(); i++) {
            printNamespace(xmlr, i);
        }
    }

    private static void printNamespace(XMLStreamReader xmlr, int index) {
        String prefix = xmlr.getNamespacePrefix(index);
        String uri = xmlr.getNamespaceURI(index);
        System.out.print(" ");
        if (prefix == null)
            System.out.print("xmlns='" + uri + "'");
        else
            System.out.print("xmlns:" + prefix + "='" + uri + "'");
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T14:13:37.163

IIRC，XML 文档末尾可以有注释和处理指令，因此没有真正的方法可以准确地告诉您何时到达文件末尾。

已经提到了几种处理这种情况的方法。另一种选择是将非法字符或字节放入流中，例如 NUL 或零。这样做的好处是您不需要更改文档并且您永远不需要缓冲整个文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:47:41.897

一个简单的解决方案是将发送端的文档包装在一个新的根元素中：

```
<?xml version="1.0"?>
<documents>
    ... document 1 ...
    ... document 2 ...
</documents> 
```

但是，您必须确保不包含 XML 标头 ( `<?xml ...?>`)。如果所有文档都使用相同的编码，这可以通过一个简单的过滤器来完成，如果每个文档的第一行以`<?xml`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-27T17:28:11.523

我不得不做这样的事情，在我研究如何处理它的过程中，我发现这个线程即使它已经很老了，我只是[在这里](https://stackoverflow.com/questions/6711766/multiple-xml-files-in-one-stream/)回答（对自己），将所有内容都包装在它自己的阅读器中以便于使用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-31T14:39:34.437

我使用 JAXB 方法从多流中解组消息：

**MultiInputStream.java**

```
public class MultiInputStream extends InputStream {
    private final Reader source;
    private final StringReader startRoot = new StringReader("<root>");
    private final StringReader endRoot = new StringReader("</root>");

    public MultiInputStream(Reader source) {
        this.source = source;
    }

    @Override
    public int read() throws IOException {
        int count = startRoot.read();
        if (count == -1) {
            count = source.read();
        }
        if (count == -1) {
            count = endRoot.read();
        }
        return count;
    }
} 
```

**MultiEventReader.java**

```
public class MultiEventReader implements XMLEventReader {

    private final XMLEventReader reader;
    private boolean isXMLEvent = false;
    private int level = 0;

    public MultiEventReader(XMLEventReader reader) throws XMLStreamException {
        this.reader = reader;
        startXML();
    }

    private void startXML() throws XMLStreamException {
        while (reader.hasNext()) {
            XMLEvent event = reader.nextEvent();
            if (event.isStartElement()) {
                return;
            }
        }
    }

    public boolean hasNextXML() {
        return reader.hasNext();
    }

    public void nextXML() throws XMLStreamException {
        while (reader.hasNext()) {
            XMLEvent event = reader.peek();
            if (event.isStartElement()) {
                isXMLEvent = true;
                return;
            }
            reader.nextEvent();
        }
    }

    @Override
    public XMLEvent nextEvent() throws XMLStreamException {
        XMLEvent event = reader.nextEvent();
        if (event.isStartElement()) {
            level++;
        }
        if (event.isEndElement()) {
            level--;
            if (level == 0) {
                isXMLEvent = false;
            }
        }
        return event;
    }

    @Override
    public boolean hasNext() {
        return isXMLEvent;
    }

    @Override
    public XMLEvent peek() throws XMLStreamException {
        XMLEvent event = reader.peek();
        if (level == 0) {
            while (event != null && !event.isStartElement() && reader.hasNext()) {
                reader.nextEvent();
                event = reader.peek();
            }
        }
        return event;
    }

    @Override
    public String getElementText() throws XMLStreamException {
        throw new NotImplementedException();
    }

    @Override
    public XMLEvent nextTag() throws XMLStreamException {
        throw new NotImplementedException();
    }

    @Override
    public Object getProperty(String name) throws IllegalArgumentException {
        throw new NotImplementedException();
    }

    @Override
    public void close() throws XMLStreamException {
        throw new NotImplementedException();
    }

    @Override
    public Object next() {
        throw new NotImplementedException();
    }

    @Override
    public void remove() {
        throw new NotImplementedException();
    }
} 
```

**消息.java**

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlRootElement(name = "Message")
public class Message {

    public Message() {
    }

    @XmlAttribute(name = "ID", required = true)
    protected long id;

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    @Override
    public String toString() {
        return "Message{id=" + id + '}';
    }
} 
```

**阅读乘法消息：**

```
public static void main(String[] args) throws Exception{

    StringReader stringReader = new StringReader(
            "<Message ID=\"123\" />\n" +
            "<Message ID=\"321\" />"
    );

    JAXBContext context = JAXBContext.newInstance(Message.class);
    Unmarshaller unmarshaller = context.createUnmarshaller();

    XMLInputFactory inputFactory = XMLInputFactory.newFactory();
    MultiInputStream multiInputStream = new MultiInputStream(stringReader);
    XMLEventReader xmlEventReader = inputFactory.createXMLEventReader(multiInputStream);
    MultiEventReader multiEventReader = new MultiEventReader(xmlEventReader);

    while (multiEventReader.hasNextXML()) {
        Object message = unmarshaller.unmarshal(multiEventReader);
        System.out.println(message);
        multiEventReader.nextXML();
    }
} 
```

**结果：**

```
Message{id=123}
Message{id=321} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-05T20:52:53.543

嗨，我在工作中也遇到了这个问题（所以不会发布代码）。我能想到的最优雅的解决方案，并且在 imo 中效果很好，如下所示

创建一个类，例如 DocumentSplittingInputStream，它扩展 InputStream 并在其构造函数中获取底层输入流（或在构造后设置......）。添加一个带有字节数组 closeTag 的字段，其中包含您要查找的关闭根节点的字节。添加一个名为 matchCount 的字段 int 或其他东西，初始化为零。添加一个名为underlyingInputStreamNotFinished的布尔字段，初始化为true

在 read() 实现上：

1.  检查 matchCount == closeTag.length，如果是，将 matchCount 设置为 -1，返回 -1
2.  如果 matchCount == -1，设置 matchCount = 0，在底层输入流上调用 read()，直到你得到 -1 或 '<'（流中下一个文档的 xml 声明）并返回它。请注意，据我所知，xml 规范允许在文档元素之后添加注释，但我知道我不会从源代码中获取它，所以没有费心处理它 - 如果你不能确定你需要更改“狼吞虎咽”。
3.  否则从底层输入流中读取一个 int（如果它等于 closeTag[matchCount] 则增加 matchCount，如果不等于则将 matchCount 重置为零）并返回新读取的字节

添加一个方法，该方法返回有关基础流是否已关闭的布尔值。对底层输入流的所有读取都应通过一个单独的方法检查读取的值是否为 -1，如果是，则将字段“underlyingInputStreamNotFinished”设置为 false。

我可能错过了一些小问题，但我相信你明白了。

然后在使用代码中执行类似的操作，如果您使用的是 xstream：

```
DocumentSplittingInputStream dsis = new DocumentSplittingInputStream(underlyingInputStream);
而（dsis.underlyingInputStreamNotFinished（））{
    MyObject mo = xstream.fromXML(dsis);
    mo.doSomething(); // 或 something.doSomething(mo);
}

```

大卫

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-23T22:37:22.300

我遇到了类似的问题。我正在使用的 Web 服务将（在某些情况下）返回多个 xml 文档以响应单个 HTTP GET 请求。我可以将整个响应读入字符串并将其拆分，但是我根据上面 user467257 的帖子实现了拆分输入流。这是代码：

```
public class AnotherSplittingInputStream extends InputStream {
    private final InputStream realStream;
    private final byte[] closeTag;

    private int matchCount;
    private boolean realStreamFinished;
    private boolean reachedCloseTag;

    public AnotherSplittingInputStream(InputStream realStream, String closeTag) {
        this.realStream = realStream;
        this.closeTag = closeTag.getBytes();
    }

    @Override
    public int read() throws IOException {
        if (reachedCloseTag) {
            return -1;
        }

        if (matchCount == closeTag.length) {
            matchCount = 0;
            reachedCloseTag = true;
            return -1;
        }

        int ch = realStream.read();
        if (ch == -1) {
            realStreamFinished = true;
        }
        else if (ch == closeTag[matchCount]) {
            matchCount++;
        } else {
            matchCount = 0;
        }
        return ch;
    }

    public boolean hasMoreData() {
        if (realStreamFinished == true) {
            return false;
        } else {
            reachedCloseTag = false;
            return true;
        }
    }
} 
```

并使用它：

```
String xml =
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>" +
        "<root>first root</root>" +
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>" +
        "<root>second root</root>";
ByteArrayInputStream is = new ByteArrayInputStream(xml.getBytes());
SplittingInputStream splitter = new SplittingInputStream(is, "</root>");
BufferedReader reader = new BufferedReader(new InputStreamReader(splitter));

while (splitter.hasMoreData()) {
    System.out.println("Starting next stream");
    String line = null;
    while ((line = reader.readLine()) != null) {
        System.out.println("line ["+line+"]");
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-20T23:24:22.923

找到了这个[论坛消息](http://marc.info/?l=xerces-j-user&m=117066258314001&w=2)（您可能已经看到了），它通过包装输入流并测试两个 ascii 字符之一来提供解决方案（参见帖子）。

您可以尝试对此进行调整，首先转换为使用阅读器（用于正确的字符编码），然后进行元素计数，直到到达结束元素，此时触发 EOM。

# python - 发送包含嵌入图像的多部分 html 电子邮件

> ID：920910
> 
> 赞同：92
> 
> 时间：2009-05-28T13:45:57.843
> 
> 标签：python, email, mime, attachment, multipart

我一直在使用 python 中的电子邮件模块，但我希望能够知道如何嵌入包含在 html 中的图像。

例如，如果身体是这样的

```
<img src="../path/image.png"></img> 
```

我想将*image.png*嵌入到电子邮件中，该`src`属性应替换为`content-id`. 有人知道怎么做这个吗？

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2009-05-28T13:48:27.260

这是我找到的一个例子。

> [**配方 473810：发送带有嵌入图像和纯文本替代的 HTML 电子邮件**](http://code.activestate.com/recipes/473810/)：
> 
> HTML 是那些希望发送具有丰富文本、布局和图形的电子邮件的首选方法。通常希望在消息中嵌入图形，以便收件人可以直接显示消息，而无需进一步下载。
> 
> 一些邮件代理不支持 HTML，或者他们的用户更喜欢接收纯文本消息。HTML 消息的发件人应包含纯文本消息作为这些用户的替代。
> 
> 此配方发送带有单个嵌入图像和备用纯文本消息的简短 HTML 消息。

```
# Send an HTML email with an embedded image and a plain text message for
# email clients that don't want to display the HTML.

from email.MIMEMultipart import MIMEMultipart
from email.MIMEText import MIMEText
from email.MIMEImage import MIMEImage

# Define these once; use them twice!
strFrom = 'from@example.com'
strTo = 'to@example.com'

# Create the root message and fill in the from, to, and subject headers
msgRoot = MIMEMultipart('related')
msgRoot['Subject'] = 'test message'
msgRoot['From'] = strFrom
msgRoot['To'] = strTo
msgRoot.preamble = 'This is a multi-part message in MIME format.'

# Encapsulate the plain and HTML versions of the message body in an
# 'alternative' part, so message agents can decide which they want to display.
msgAlternative = MIMEMultipart('alternative')
msgRoot.attach(msgAlternative)

msgText = MIMEText('This is the alternative plain text message.')
msgAlternative.attach(msgText)

# We reference the image in the IMG SRC attribute by the ID we give it below
msgText = MIMEText('<b>Some <i>HTML</i> text</b> and an image.<br><img src="cid:image1"><br>Nifty!', 'html')
msgAlternative.attach(msgText)

# This example assumes the image is in the current directory
fp = open('test.jpg', 'rb')
msgImage = MIMEImage(fp.read())
fp.close()

# Define the image's ID as referenced above
msgImage.add_header('Content-ID', '<image1>')
msgRoot.attach(msgImage)

# Send the email (this example assumes SMTP authentication is required)
import smtplib
smtp = smtplib.SMTP()
smtp.connect('smtp.example.com')
smtp.login('exampleuser', 'examplepass')
smtp.sendmail(strFrom, strTo, msgRoot.as_string())
smtp.quit() 
```

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2018-03-04T17:32:56.210

**对于 Python 3.4 及更高版本。**

公认的答案非常好，但仅适用于较旧的 Python 版本（2.x 和 3.3）。我认为它需要更新。

以下是在较新的 Python 版本（3.4 及更高版本）中执行此操作的方法：

```
from email.message import EmailMessage
from email.utils import make_msgid
import mimetypes

msg = EmailMessage()

# generic email headers
msg['Subject'] = 'Hello there'
msg['From'] = 'ABCD <abcd@xyz.com>'
msg['To'] = 'PQRS <pqrs@xyz.com>'

# set the plain text body
msg.set_content('This is a plain text body.')

# now create a Content-ID for the image
image_cid = make_msgid(domain='xyz.com')
# if `domain` argument isn't provided, it will 
# use your computer's name

# set an alternative html body
msg.add_alternative("""\
<html>
    <body>
        <p>This is an HTML body.<br>
           It also has an image.
        </p>
        <img src="cid:{image_cid}">
    </body>
</html>
""".format(image_cid=image_cid[1:-1]), subtype='html')
# image_cid looks like <long.random.number@xyz.com>
# to use it as the img src, we don't need `<` or `>`
# so we use [1:-1] to strip them off

# now open the image and attach it to the email
with open('path/to/image.jpg', 'rb') as img:

    # know the Content-Type of the image
    maintype, subtype = mimetypes.guess_type(img.name)[0].split('/')

    # attach it
    msg.get_payload()[1].add_related(img.read(), 
                                         maintype=maintype, 
                                         subtype=subtype, 
                                         cid=image_cid)

# the message is ready now
# you can write it to a file
# or send it using smtplib 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2022-01-03T19:36:44.663

我意识到 SMTP 和电子邮件库的某些事情是多么痛苦，我想我必须对它做点什么。我制作[了一个库](https://github.com/Miksus/red-mail)，可以更轻松地将图像嵌入到 HTML 中：

```
from redmail import EmailSender
email = EmailSender(host="<SMTP HOST>", port=0)

email.send(
    sender="me@example.com",
    receivers=["you@example.com"]
    subject="An email with image",
    html="""
        <h1>Look at this:</h1>
        {{ my_image }}
    """, 
    body_images={
        "my_image": "path/to/image.png"
    }
) 
```

很抱歉晋升，但我认为这非常棒。您可以将图像提供为 Matplotlib `Figure`、 Pillow`Image`或就像`bytes`您的图像采用这些格式一样。它使用 Jinja 进行模板化。

如果需要控制图片的大小，也可以这样做：

```
email.send(
    sender="me@example.com",
    receivers=["you@example.com"]
    subject="An email with image",
    html="""
        <h1>Look at this:</h1>
        <img src="{{ my_image.src }}" width=200 height=300>
    """, 
    body_images={
        "my_image": "path/to/image.png"
    }
) 
```

你可以 pip 安装它：

```
pip install redmail 
```

它（希望）是您发送电子邮件所需的一切（还有更多），并且经过了很好的测试。我还编写了大量文档：[https ://red-mail.readthedocs.io/en/latest/ 并且可以在](https://red-mail.readthedocs.io/en/latest/)[此处](https://github.com/Miksus/red-mail)找到源代码。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2020-02-03T19:23:17.113

代码工作

```
 att = MIMEImage(imgData)
    att.add_header('Content-ID', f'<image{i}.{imgType}>')
    att.add_header('X-Attachment-Id', f'image{i}.{imgType}')
    att['Content-Disposition'] = f'inline; filename=image{i}.{imgType}'
    msg.attach(att) 
```

# c - 编译错误

> ID：920917
> 
> 赞同：-1
> 
> 时间：2009-05-28T13:47:08.480
> 
> 标签：c, makefile

有谁能够帮我？

```
gcc -o uartsim.exe xtmpmain.o uartsim.o fiber_driver.o xtmp_options.o getopt.o D:\usr\xtensa\XtDevToolsDE\install\tools\RB-2008.4-win32\XtensaTools\lib\iss\xtmp.lib
gcc：xtmpmain.o：没有这样的文件或目录
make: *** [uartsim.exe] 错误 1

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T13:49:46.417

您正在尝试构建一个可执行文件 (uartsim.exe)，但构建它所需的一些东西不存在。也就是说，在尝试将它们链接到 exe 之前，您还没有构建 .o 文件。您的 makefile 可能已损坏。

# visual-sourcesafe - VSS 6.0 和 VSS 2005 之间有什么区别？

> ID：920918
> 
> 赞同：6
> 
> 时间：2009-05-28T13:47:10.947
> 
> 标签：visual-sourcesafe, visual-sourcesafe-2005

我们从一开始就一直在使用 VSS 6.0，但是昨天我从 MSDN 订阅中获得了 VSS2005，它不允许我通过 Daemon Tools 从 ISO 安装它（不知道为什么，但我向 MS 提交了错误报告。 .)。我注意到它在 ISO 上有一个程序文件目录，所以我只是将文件夹复制到我的硬盘上。好吧，我打开客户端，看到了一个迷人的 VSS 6.0 版本，连接到完全相同的数据库。

有谁知道我会不会用它来摧毁一切？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-28T14:04:23.343

一年多前，我们从 VSS6 迁移到 VSS2005。数据库结构相同。我们发现的唯一警告是，如果有些人仍然在其他人使用 VSS2005 的数据库上使用 VSS6。VSS2005 将 Unicode 文本文件视为文本文件，而 VSS6 则不然。这意味着当 VSS2005 添加 Unicode 文本文件时，VSS6 将其视为二进制文件（这会影响 csproj 文件等）。

除此之外，VSS2005 支持对数据库的正确 HTTP 访问（前提是安装了服务器扩展）、改进的 LAN 性能（同样，使用服务器扩展）和更好的文件系统对话框（讨厌的旧对话框已经消失）。但是，新的文件添加对话框会显示所有文件，而不仅仅是未包含的文件。

此外，VSS2005 允许通过文件扩展名提供自定义编辑器和差异化工具，这非常有用。例如，我们的一些 XML 文件是加密的，所以我们使用这个系统在差异工具之前运行一个解密工具，这大大提高了我们审查过程的效率。

这里和那里还有其他调整，大部分都很好，但有时很烦人。

最后，什么都没有被破坏。事实上，自过渡以来，数据库中的额外损坏似乎较少 - 但我不会将其归结为新的 VSS，因为它不是一个全面的测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T13:55:58.010

我很确定，没有比使用 VSS 6.0 更危险的破坏任何东西了。

自从我上次使用 VSS 已经很久以前了，但我们也从版本 6 更新到了 2005 版本。据我记得，客户端（VSS 资源管理器）中只有一些外观上的变化，但数据库的格式和可用的功能也与 VSS 6 中的完全相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T14:01:42.243

你应该没事。

由于 VSS 只是对所有内容使用文件共享，并且没有什么是真正基于服务器的，所以你很好。数据库的格式没有太大变化，主要是客户端的东西。

# html - 未显示嵌套的 UL/LI

> ID：920920
> 
> 赞同：0
> 
> 时间：2009-05-28T13:47:20.430
> 
> 标签：html, css, html-lists

```
<ul id="nav">
    <div id="navspacer" />
    <li class="button" style="width: 109px;"></li>
    <li class="button" style="width: 86px;">
        <img alt="Webdesign" src="images/digifolio_10.jpg"/>
        <ul>
            <li>a</li>
            <li>b</li>
            <li>c</li>
        </ul>
    </li>
</ul>
<div id="main">
    content
</div> 
```

li.button 有一个固定的高度：

```
li.button {
    height:             23px;
    float:              left;
    list-style:         none;
} 
```

**div#main**的 z-index 为 0

**li.button ul**的 z-index 为 100：

```
li.button ul {
    z-index:            100;
    background-color:   #ffffff;
    display:            block;
} 
```

但它只是没有显示在浏览器中...... Firebug 显示它在那里，但它只是没有显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T13:51:07.270

请记住，z-index 不适用于没有`position`-property 的元素，因此它对您的代码没有影响。

并且在 UL 中不允许使用 DIV。请改用边距或填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T14:04:56.010

看到你所有的 CSS 会很有帮助。你有溢出：隐藏在某处的 li 上声明吗？

您的 li.button 的高度为 23px，但其中的 ul 会更高。除非您还浮动内部 li 和 img，否则它将比 86px 宽。

# c# - Visual Studio 2008 WPF 设计器不会加载我的表单

> ID：920925
> 
> 赞同：0
> 
> 时间：2009-05-28T13:47:47.370
> 
> 标签：c#, wpf, visual-studio-2008, windows-forms-designer

我试图在 Visual Studio 2008 中查看由其他人（前雇员）开发的表单，但是当我尝试查看 MainForm.xaml（它无法在设计器视图中加载）时不断遇到以下错误：

> 错误无法创建类型为“NumericTextBox”的实例。D:\MySolution\GUI\MainForm.xaml

我的解决方案是这样组织的（为了简洁而缩短 - 这是发生错误的最后一行）：

```
\solution
    \Gui
        \App.xaml
        \MainForm.xaml
    \Utils
        \NumericTextBox.cs 
```

我的 MainForm.xaml 看起来像这样：

```
<Window x:Class="MyCompany.MyDepartment.MyProject.MainForm"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MyCompany.MyDepartment.MyProject"
        xmlns:myproject="clr-namespace:MyCompany.MyDepartment.MyProject;assembly=MyProject"
        xmlns:dsp="clr-namespace:MyCompany.MyDepartment.MyProject.DSP;assembly=MyProject"
        xmlns:filters="clr-namespace:MyCompany.MyDepartment.DSP.Filters;assembly=DSP"
        xmlns:mydepartment="clr-namespace:MyCompany.MyDepartment.Utils;assembly=Utils"
        xmlns:scope="clr-namespace:MyCompany.MyDepartment;assembly=ScopeControl"
        Title="MyProject" Height="900" Width="1024"
        Loaded="Window_Loaded"
        Closing="Window_Closing" ResizeMode="CanResize" Icon="/MyProjectGUI;component/MyProjectGUI.ico">

    <Window.Resources>
    ...
    </Window.Resources>

    <DockPanel>
        <StackPanel DockPanel.Dock="Left" CanVerticallyScroll="True" CanHorizontallyScroll="False">
            <GroupBox Name="SensorControlGroup"  Header="Sensor Control">
            ...
            </GroupBox>
            <GroupBox Header="Sensor State">
                <StackPanel Name="SensorStackPanel">
                    <Expander Name="EnvironmentExpander" Header="Environment">
                    ...
                    </Expander>
                    <Expander Name="SynthExpander" Header="Synthesiser" IsExpanded="True">
                        <Border Margin="2" Background="White" Padding="3">
                            <Grid>                                
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="60"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Label Grid.Column="0" Grid.Row="0">Frequency (MHz):</Label>

                                <mydepartment:NumericTextBox Grid.Column="1"
                                                     x:Name="SynthFrequency" DecimalPlaces="3"
                                                     Maximum="0" Minimum="0" /> 
```

什么可能导致该错误？一切都可以编译，但是[当我运行它时应用程序崩溃了](https://stackoverflow.com/questions/915881/c-wpf-app-crashes-with-system-formatexception-corrupt-resources-file)。我希望这两个问题可能是一个相关的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T13:58:30.580

你提到的两个问题几乎肯定是相关的。在这两种情况下，都将处理 XAML 文件以创建控件。一个用于设计目的，另一个用于运行时。如果在解析文件时在运行时生成异常，那么设计人员也会遇到文件问题。

我认为您需要关注原始错误，然后再回到这个错误。一个几乎可以肯定地修复另一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T08:22:26.790

好的，事实证明，虽然 Visual Studio 设置为使用 .net 框架的 v3.5，但您需要单独安装框架的 v3.5 - 看来我只安装了 v2。让这成为其他在同样问题上苦苦挣扎的人的一个教训！

# apache-flex - Flex/actionscript：在 AdvancedDataGrid 上使用 dataDescriptor

> ID：920926
> 
> 赞同：1
> 
> 时间：2009-05-28T13:47:51.723
> 
> 标签：apache-flex, advanceddatagrid

我有一个分层数据集，我想在高级数据网格中显示。我的数据是一组不使用“children”属性的组合值对象。在 Tree 控件上，您可以创建自定义 dataDescriptor 来定义哪些元素包含节点的子节点。这也可以在数据网格上完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-02-22T23:16:52.413

分层数据有一个 childrenField 属性，您可以使用它来“告诉”控件应该在哪里寻找分支。

[http://livedocs.adobe.com/flex/3/html/help.html?content=advdatagrid_07.html](http://livedocs.adobe.com/flex/3/html/help.html?content=advdatagrid_07.html)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-28T15:15:07.820

从有关 AdvancedDataGrid 示例的 Adob​​e 实时文档中，您可以看到可以将 AdvancedDataGrid 的 dataProvider 设置为 GroupingCollection 实例，以便为您的数据创建一些组。在类层次结构中，有 HierarchicalData，在 AdvancedDataGrid 上设置 dataProvider 时需要使用它。示例（抱歉使用数组而不是一个 XML）：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical">
    <mx:Array id="dianaSerfes">
        <mx:Object name="geen" surname="zod" />
    </mx:Array>
    <mx:Array id="xySerfs">
        <mx:Object name="sdf" surname="sdfsdgd" />
    </mx:Array>
    <mx:Array id="johnSerfs">
        <mx:Object name="jack" surname="the ripper" />
        <mx:Object name="diana" surname="bloom" serfs="{dianaSerfes}"/>
    </mx:Array>
    <mx:Array id="myData">
        <mx:Object name="xy" surname="zzz" serfs="{xySerfs}" />
        <mx:Object name="blue" surname="zed" />
        <mx:Object name="John" surname="smith" serfs="{johnSerfs}" />
    </mx:Array>
    <mx:AdvancedDataGrid width="100%" height="100%">
        <mx:dataProvider>
            <mx:HierarchicalData id="hd" source="{myData}" childrenField="serfs" />
        </mx:dataProvider>
        <mx:columns>
            <mx:AdvancedDataGridColumn dataField="name" />
            <mx:AdvancedDataGridColumn dataField="surname" />
        </mx:columns>
    </mx:AdvancedDataGrid>
</mx:Application> 
```

# c++ - 使用模板减少班级规模的合理方法？

> ID：920929
> 
> 赞同：0
> 
> 时间：2009-05-28T13:48:28.180
> 
> 标签：c++, optimization, templates, size

给定：（代码减少到合理的最小值）

// 成员类型

```
template
<
  typename SPEEDTYPE = float,
  typename SIZETYPE = float,
  typename ACCELERATIONTYPE = float
>
struct ParticleMemberTypes
{
  typedef typename SPEEDTYPE SpeedType;
  typedef typename SIZETYPE SizeType;
  typedef typename ACCELERATIONTYPE AccelerationType;
}; 
```

// 特性

```
template <class T>
class PSpeed
{
public:
  inline const typename T::SpeedType&   GetSpeed() const  { return v; }
  inline void SetSpeed(const typename T::SpeedType& V)  { v = V; }
  const static bool hasSpeed = true;
private:
  typename T::SpeedType v;
};

template <class T> 
class PSize
{
public:
  inline const typename T::SizeType&    GetSize() const  { return v; }
  inline void SetSize(const typename T::SizeType& V)   { v = V; }
  const static bool hasSize = true;
private:
  typename T::SizeType v;
};

template <class T>
class PAcceleration
{
public:
  inline const typename T::AccelerationType& GetAcceleration() const  { return v; }
  inline void SetAcceleration(const typename T::AccelerationType& V)   { v = V; }
  const static bool hasAcceleration = true;
private:
  typename T::AccelerationType v;
}; 
```

// 空基和特化

（每个 EmptyBase 必须是不同的类型，以避免多次从同一个基类继承）

```
template <typename P, typename T> struct EmptyBase {};
template <typename T> struct EmptyBase<PSpeed<T>, T>
{
  const static bool hasSpeed = false;
};
template <typename T> struct EmptyBase<PSize<T>, T>
{
  const static bool hasSize = false;
};
template <typename T> struct EmptyBase<PAcceleration<T>, T>
{
  const static bool hasAcceleration = false;
}; 
```

// 基础选择模板

```
template <bool ENABLE, typename P, typename T> struct EnableBase;
template <typename P, typename T> struct EnableBase<true, P, T>
{
  typedef P Type;
};
template <typename P, typename T> struct EnableBase<false, P, T>
{
  typedef EmptyBase<P, T> Type;
}; 
```

// 粒子模板类

```
template
<
  bool USE_SPEED = false,
  bool USE_SIZE = false,
  bool USE_ACCELERATION = false,
  typename T = ParticleMemberTypes<>
>
struct Particle :
  public EnableBase<USE_SPEED, PSpeed<T>, T>::Type,
  public EnableBase<USE_SIZE, PSize<T>, T>::Type,
  public EnableBase<USE_ACCELERATION, PAcceleration<T>, T>::Type
{
}; 
```

我们现在可以这样做：

```
using namespace std;

Particle<> p1;
Particle<true, true, true, ParticleMemberTypes<Vector3<double> > > p2;

cout << "p1: " << sizeof(p1) << endl;
cout << "p2: " << sizeof(p2) << endl; 
```

输出：

```
p1: 2
p1: 32 
```

所以这是我的问题：

*   这是自动减小类大小的合理方法吗？
*   如果我只从两个属性继承粒子的大小为 1，除此之外，每增加一个 EmptyBase，大小就会增加一，这是为什么呢？
*   是否有任何模式、习语等在这里有用？

该计划是编写模板以根据存在的属性自动处理粒子。

我可能应该提到我正在研究的这个粒子系统不是“实时的”，将处理大量粒子，并且我将从 C++ 配置每个渲染。此外，这几乎是我第一次使用模板。

编辑：我选择模板方法基本上有两个原因：一个是好奇心 - 只是为了了解模板并探索它们的使用。第二个原因是速度。鉴于我不需要在运行时更改任何内容，我想我可以使用模板来消除虚函数和未使用的类成员等的开销。

预期用途是创建大量粒子，所有类型完全相同，并以尽可能快的速度处理和渲染它们。:)

这个想法是拥有一个高度可配置的系统，我可以在其中插入自定义函子来处理粒子。理想情况下，粒子的属性只有在实际使用时才会启用，但我还没有弄清楚是否以及如何实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T15:42:15.067

嗯，首先，您似乎在滚动很多自己的东西。我会研究[Boost::MPL](http://www.boost.org/doc/libs/1_39_0/libs/mpl/doc/index.html)来替换，比如 Base 选择模板，并用继承来继承向量。

其次，您使用的是“const static bool hasSpeed = true;” 很多; 在我的编程中，我通常更喜欢 typedefed trait，类似于[Boost::type_traits](http://www.boost.org/doc/libs/1_39_0/libs/type_traits/doc/html/index.html)。您可以使用它们来选择要在编译时运行的函数。你可以避免这样做“EmptyBase”。

```
template <typename T>
struct has_size;

template <bool speed, bool accel, typename T>
struct has_size< Particle<true, speed, accel, T> > : public true_type
{ };

template <bool speed, bool accel, typename T>
struct has_size< Particle<false, speed, accel, T> > : public false_type
{ };

// given a particle typedef SomeParticle_t

has_size<SomeParticle_T>::value 
```

第三，你在这里所做的很多事情取决于你希望你的最终用途是什么；你希望粒子是分开的，不能相互转换的类型吗？如果你走这条路，几乎每个函数都会是一个模板，你可以使用 boost::enable_if 来禁用不适用于给定粒子的代码。它可能会非常快（因为在编译时会发生很多工作），但是您会有巨大的、难以阅读的错误语句（对于模板新手来说不太容易理解）。

另一个非模板路由是继承；您将定义一组粒子需要的虚函数，然后将它们分解为您继承的类。从您的代码中并不清楚您希望能够使用 Particle 做什么。错误会更容易理解，但代码可能会更慢（更多的工作转移到运行时，并且会使你的对象更大）

这是一个代码示例来说明差异：

```
// Using templates
template <typename particle>
typename boost::enable_if< has_accel<particle>, typename particle::speed_type >::type
calculate_future_speed(const particle& t)
{ /* do your acceleration calculation */ }

template <typename particle>
typename boost::enable_if< boost::and_< has_speed<particle>,
                                       boost::not_< has_accel<particle> >,
                         typename particle::speed_type >::type
calculate_future_speed(const particle& t)
{ /* no acceleration, so no calculation! just return the speed*/ }

template <typename particle>
typename boost::enable_if< boost::not_< has_speed<particle>,
                         typename particle::speed_type >::type
calculate_future_speed(const particle& t)
{ return 0; /* Has no speed, and no acceleration */ } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T15:15:37.773

您知道不同参数的模板类型不同吗？也就是说，在您的代码中 p1 和 p2 是不同的类型，因此不能存储在同一个集合中、相互分配等。当然，您的应用程序可能不需要这种等价性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T14:53:00.407

一件事，您在 Particle 的模板定义中使用了 USE_SIZE 两次。

您还可以考虑使用享元模式，具体取决于数据的重复性。 [http://www.boost.org/doc/libs/1_39_0/libs/flyweight/doc/tutorial/index.html](http://www.boost.org/doc/libs/1_39_0/libs/flyweight/doc/tutorial/index.html)

# javascript - 如何通过 JavaScript for 循环创建 json？

> ID：920930
> 
> 赞同：99
> 
> 时间：2009-05-28T13:48:34.703
> 
> 标签：javascript, json

我有选择标签的**数组**。

```
<select id='uniqueID' name="status">
      <option value="1">Present</option>
      <option value="2">Absent</option>
 </select> 
```

我想在 JavaScript 中创建一个具有两个字段“uniqueIDofSelect 和 optionValue”的 json 对象。

我使用 getElementsByName("status") 并对其进行迭代。

**编辑**

我需要像

```
[{"selectID":2,"OptionValue":"2"},
{"selectID":4,"optionvalue":"1"}] 
```

等等...

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2009-05-28T14:03:40.757

根据我对您的要求的理解，这应该有效：

```
<script>
//  var status  = document.getElementsByID("uniqueID"); // this works too
var status  = document.getElementsByName("status")[0];
var jsonArr = [];

for (var i = 0; i < status.options.length; i++) {
    jsonArr.push({
        id: status.options[i].text,
        optionValue: status.options[i].value
    });
}
</script> 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-05-28T14:36:38.320

```
var sels = //Here is your array of SELECTs
var json = { };

for(var i = 0, l = sels.length; i < l; i++) {
  json[sels[i].id] = sels[i].value;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-28T14:39:40.247

如果您想要一个 JavaScript 对象，如下所示：

```
{ uniqueIDofSelect: "uniqueID", optionValue: "2" } 
```

（其中选项 2，“缺席”，是当前选择）然后下面的代码应该产生它：

```
 var jsObj = null;
  var status = document.getElementsByName("status")[0];
  for (i = 0, i < status.options.length, ++i) {
     if (options[i].selected ) {
        jsObj = { uniqueIDofSelect: status.id, optionValue: options[i].value };
        break;
     }
  } 
```

如果您想要所有此类对象的数组（不仅仅是选定的对象），请使用[michael 的代码](https://stackoverflow.com/questions/920930#921012)，但换成`status.options[i].text`.`status.id`

如果您想要一个包含所选对象的 JSON 表示的*字符串*，请改用：

```
 var jsonStr = "";
  var status = document.getElementsByName("status")[0];
  for (i = 0, i < status.options.length, ++i) {
     if (options[i].selected ) {
        jsonStr = '{ '
                  + '"uniqueIDofSelect" : '
                  + '"' + status.id + '"'
                  + ", "
                  + '"optionValue" : '
                  + '"'+ options[i].value + '"'
                  + ' }';
        break;
     }
  } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-08-24T21:35:19.213

如果我想从 for 循环生成的字符串创建 JavaScript 对象，那么我会使用 JSON 到对象的方法。我将通过迭代 for 循环生成 JSON 字符串，然后使用任何流行的 JavaScript 框架将 JSON 评估为 Object。

我使用了[原型 JavaScript 框架](http://www.prototypejs.org/)。我有两个带有键和值的数组。我遍历 for 循环并生成有效的 JSON 字符串。我使用[evalJSON()](http://www.prototypejs.org/api/string/evalJSON)函数将 JSON 字符串转换为 JavaScript 对象。

这是示例代码。[在FireBug 控制台](http://getfirebug.com/logging)上试用

```
var key = ["color", "size", "fabric"];
var value = ["Black", "XL", "Cotton"];

var json = "{ ";
for(var i = 0; i < key.length; i++) {
    (i + 1) == key.length ? json += "\"" + key[i] + "\" : \"" + value[i] + "\"" : json += "\"" + key[i] + "\" : \"" + value[i] + "\",";
}
json += " }";
var obj = json.evalJSON(true);
console.log(obj); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T10:06:51.713

您的问题很难解码，但我会尝试尝试一下。

你说：

> 我想 在 javascript中创建一个具有两个字段**`uniqueIDofSelect`**的json 对象。**`optionValue`**

然后你说：

> 我需要像这样的输出
> 
> ```
> [{"selectID":2,"optionValue":"2"},
> {"selectID":4,"optionvalue":"1"}] 
> ```

好吧，这个示例输出没有名为 的字段**`uniqueIDofSelect`**，它只有**`optionValue`**.

无论如何，您要的是对象数组...

然后在对迈克尔的评论中回答你说：

> 它创建 json 对象数组。但我只需要一个 json 对象。

所以你不想要一个对象数组？

那你想要什么？

请下定决心。

# python - 使用 Python 在 OpenOffice/Microsoft Word 中格式化输出

> ID：920938
> 
> 赞同：6
> 
> 时间：2009-05-28T13:49:45.713
> 
> 标签：python, formatting, ms-word, ms-office, openoffice.org

我正在开发一个需要格式化、可编辑输出的项目（在 Python 中）。由于最终用户不会精通技术，因此输出需要采用文字处理器可编辑格式。格式很复杂（要点、段落、粗体等）。

有没有办法使用 Python 生成这样的报告？我觉得应该有一种方法可以使用 Microsoft Word/OpenOffice 模板和 Python 来做到这一点，但我找不到任何足够先进的东西来获得良好的格式。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T17:18:42.937

一个鲜为人知且略显邪恶的事实：如果您创建一个 HTML 文件，并在其上粘贴一个 .doc 扩展名，Word 会将其作为 Word 文档打开，而大多数用户都不会更聪明。

除非一个非常技术性的人会说，我这是一个小的 Word 文件！:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-27T16:53:28.110

为此使用[Python Docx](https://github.com/mikemaccana/python-docx)模块 - 100% Python、表格、图像、文档属性、标题、段落等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T15:59:54.313

" 格式复杂（要点、段落、粗体等），"

使用[RST](http://docutils.sourceforge.net/docs/user/rst/quickstart.html)。

生成起来很简单，因为它是纯文本。

编辑起来很简单，因为它是带有一些额外字符的纯文本来提供结构信息。

它使用一堆[工具](http://docutils.sourceforge.net/docs/user/tools.html)很好地格式化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T13:58:03.123

我知道 docutils 有一个[odtwriter](http://www.rexx.com/~dkuhlman/odtwriter.html)。您可以将输出生成为[reStructuredText](http://docutils.sourceforge.net/rst.html)并将其提供给 odtwriter 或查看 odtwriter 在后端使用什么来生成 ODT 并使用它。

（我可能会生成第一个输出，然后破解 odtwriter 以输出我想要的东西（并将修复贡献回项目），因为这可能比尝试将你的东西直接渲染到 ODT 要容易得多。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T13:59:56.987

我已经使用 xlwt 使用 python 创建 Excel 文档，但我还不需要编写 word 文件。我找到了这个包[OOoPy](http://pypi.python.org/pypi/OOoPy/1.4.4873)，但我没有使用它。

此外，您可能想尝试输出 html 文件并让用户在 Word 中打开它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-04T14:56:49.917

[您可以在PyQt4](http://www.riverbankcomputing.co.uk/software/pyqt/download)中使用 QTextDocument、QTextCursor 和 QTextDocumentWriter 。显示如何写入 odt 文件的简单示例：

```
>>>from pyqt4 import QtGui
# Create a document object
>>>doc = QtGui.QTextDocument()
# Create a cursor pointing to the beginning of the document
>>>cursor = QtGui.QTextCursor(doc)
# Insert some text
>>>cursor.insertText('Hello world')
# Create a writer to save the document
>>>writer = QtGui.QTextDocumentWriter()
>>>writer.supportedDocumentFormats()
[PyQt4.QtCore.QByteArray(b'HTML'), PyQt4.QtCore.QByteArray(b'ODF'), PyQt4.QtCore.QByteArray(b'plaintext')]
>>>odf_format = writer.supportedDocumentFormats()[1]
>>>writer.setFormat(odf_format)
>>>writer.setFileName('hello_world.odt')
>>>writer.write(doc) # Return True if successful
True 
```

QTextCursor 还可以插入表格、框架、块、图像。更多信息请访问：http: [//qt-project.org/doc/qt-4.8/qtextcursor.html](http://qt-project.org/doc/qt-4.8/qtextcursor.html)

作为奖励，您还可以使用 QPrinter 打印到 pdf 文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T14:12:26.027

我认为 OpenOffice 有一些 Python 绑定——你应该能够用 Python 编写 OO 宏。

但我会改用 HTML——Word 和 OO.org 非常擅长编辑它，您可以轻松地从 Python 编写它（尽管 Word 节省了很多混乱，这可能会使您的 Python 应用程序解析它变得复杂）。

# internet-explorer-6 - 我知道冗余，但 IE 6/7 问题中的 sIFR

> ID：920947
> 
> 赞同：0
> 
> 时间：2009-05-28T13:51:38.707
> 
> 标签：internet-explorer-6, internet-explorer-7, sifr

我保证，我已经阅读了数百个 Joyent 帖子和 stackoverflow 问题，我会先说我确定我没有放错逗号并安装了 flash 并且已经让其他人在 IE 中尝试了该页面。

问题是在 IE 6/7 中没有任何渲染，但 IE8、FF 和 Safari 都很好。这是代码：

```
//sIFR-config.js

var zapfino = { src: '/fonts/zapfino.swf' };

sIFR.fitExactly = true;
sIFR.useStyleCheck = true;
sIFR.useDomLoaded = true;

sIFR.activate(zapfino);

sIFR.replace(zapfino, {
  selector: 'h1, h2, h3, h4'
  ,css: '.sIFR-root { color: #1A2F35; }'
  ,forceSingleLine: true
  ,tuneWidth: 5
  ,wmode: 'transparent'
  ,filters: {
      DropShadow: {
        knockout: false
        ,distance: 3
        ,color: '#330000'
        ,strength: 1
        ,alpha: .45
      }
    }
  ,ratios: [7, 3.59, 9, 3.56, 10, 3.49, 12, 3.5, 13, 3.46, 20, 3.47, 23, 3.43, 26, 3.44, 34, 3.42, 40, 3.41, 42, 3.4, 45, 3.41, 47, 3.4, 49, 3.41, 69, 3.4, 71, 3.39, 72, 3.4, 76, 3.39, 77, 3.4, 3.39]  
});

/* sIFR.css */
@media screen {
    .sIFR-active h1, .sIFR-active h2, .sIFR-active h3, .sIFR-active h4 {
        visibility: hidden;
        font-family: Verdana;
        line-height: 1em;
        color: #ff0000;
    }
    .sIFR-dummy { 
        width: 0px;
        height: 0px;
        margin-left: 42px !important;
        z-index: 0;
    }    
}

<!-- HTML Snippet -->
<div id="header">
    <H1>H1 Example</H1>
    <h3>H3 Example</h3>
    <h2>H2 Example</h2>
    <h4>H4 Example</h4>
</div> 
```

请注意，您看到的几乎每个选项我都尝试过，有无缓存清除等。此外，主 css 绝对将 h1-4 定位在 div#header 中，我也尝试将其注释掉。

编辑：请注意 .sIFR-active 类应用于`<html>`，所以我知道脚本正在触发，但除此之外页面上没有任何内容被更改。

我也尝试过来自不同来源的不同字体，但在 IE 中仍然没有运气。

TIA,

周杰伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T23:38:33.653

有时在 IE6/7 中，当绝对值位于浮点数旁边时，绝对值会消失。

在您的 CSS 中，您`.1header`向左浮动，紧随其后`.header_text`的是绝对定位。

尝试设置`.header_text`为位置：相对。`.1header`或者在and之间放一个空的 div `.header_text`。或者将 div 包装`.header_text`在另一个 div 中。

*BTW - CSS 类名必须以下划线 (_)、破折号 (-) 或字母 (az) 开头。以数字开头的类名是无效的，但我不知道在这种情况下它是否对 IE 有影响。*

*评论后添加*

我很确定这是一个 CSS 问题。`<h1>...<h4>`用#header_text 中的sifr 删除。添加`<h1>test</h1>`. 在 CSS 中，添加 'background-color:#00c;' 在#header_text 上。

在Firefox中查看它。您应该看到蓝色背景上的红色测试。看IE，你不会。

在#header_text 上将位置：绝对更改为位置：相对。在 IE 中查看，蓝色背景的红色测试应该出现（不是你想要的，但这是另一个问题）。

# c# - 索引超出范围错误；这里而不是那里？

> ID：920950
> 
> 赞同：1
> 
> 时间：2009-05-28T13:52:04.400
> 
> 标签：c#, winforms, data-binding, controls, devexpress

我有一个 winform 应用程序，它在运行时填充了它的许多 dropdomn 字段框架维护表。每个表单都有一个`Private void FillMaintFields()` 我遇到了一个奇怪的错误，其中在一个表单上设置列可见性有效，但在另一个表单上给我一个*索引超出范围*错误！

这是*违规*表单上的简化方法-->

```
 private void FillMaintFields()
{
    var myMCPTableMaint = new TableMaint();
    // Index 27 is Diabetic Teaching Topics
    var myDataSet = myMCPTableMaint.GetMaintItem(27);
    var myDataTable = myDataSet.Tables[0];
    // Diabetic TeachingTopics dropdown
    chkcboDiabeticTeachingTopics.Properties.DataSource = myDataTable;
    chkcboDiabeticTeachingTopics.Properties.DisplayMember = "ItemDescription";
    chkcboDiabeticTeachingTopics.Properties.ValueMember = "ItemID";
    // Index 26 is Diabetic Teaching
    myDataSet = myMCPTableMaint.GetMaintItem(26);
    myDataTable = myDataSet.Tables[0];
    lkuDiabeticTeaching.Properties.DataSource = myDataTable;
    lkuDiabeticTeaching.Properties.PopulateColumns();
    lkuDiabeticTeaching.Properties.DisplayMember = "ItemDescription";
    lkuDiabeticTeaching.Properties.ValueMember = "ItemID";
    lkuDiabeticTeaching.Properties.Columns[0].Visible = false;
    lkuDiabeticTeaching.Properties.Columns[1].Visible = false;
    lkuDiabeticTeaching.Properties.Columns[3].Visible = false;
    lkuDiabeticTeaching.Properties.Columns[4].Visible = false;
} 
```

现在这是姊妹表单上的工作功能-->

```
 private void FillMaintFields()
    {
        var myMCPTableMaint = new TableMaint();
        // Index 4 is Minimum Contact Schedule
        var myDataSet = myMCPTableMaint.GetMaintItem(4);
        var myDataTable = myDataSet.Tables[0];
        lkuMinContactSchedule.Properties.DataSource = myDataTable;
        lkuMinContactSchedule.Properties.PopulateColumns();
        lkuMinContactSchedule.Properties.DisplayMember = "ItemDescription";
        lkuMinContactSchedule.Properties.ValueMember = "ItemID";
        lkuMinContactSchedule.Properties.Columns[0].Visible = false;
        lkuMinContactSchedule.Properties.Columns[1].Visible = false;
        lkuMinContactSchedule.Properties.Columns[3].Visible = false;
        lkuMinContactSchedule.Properties.Columns[4].Visible = false;

        // Index 5 is Release of Information Updated Annually
        myDataSet = myMCPTableMaint.GetMaintItem(5);
        myDataTable = myDataSet.Tables[0];
        lkuReleaseInfoUpdateAnnually.Properties.DataSource = myDataTable;
        lkuReleaseInfoUpdateAnnually.Properties.PopulateColumns();
        lkuReleaseInfoUpdateAnnually.Properties.DisplayMember = "ItemDescription";
        lkuReleaseInfoUpdateAnnually.Properties.ValueMember = "ItemID";
        lkuReleaseInfoUpdateAnnually.Properties.Columns[0].Visible = false;
        lkuReleaseInfoUpdateAnnually.Properties.Columns[1].Visible = false;
        lkuReleaseInfoUpdateAnnually.Properties.Columns[3].Visible = false;
        lkuReleaseInfoUpdateAnnually.Properties.Columns[4].Visible = false;} 
```

他们都在 DAL 中使用相同的方法并访问具有 --> 结构的完全相同的表

* * *

## |物品编号 | 类别ID | 物品描述 | 订单号 | 活跃|

我不知道为什么它会在一个地方而不是另一个地方工作。如果我注释掉违规表单中的 Columns[] 部分，它会返回正确的数据，没有错误，但当然所有列都可见。

想法？谢谢！

## 编辑 1

基于一些评论和关注：错误出现在尝试访问 Columns[] 的第一行。违规表格上可能出现的任何位置和任何列。如果我调试并查看 myDataTable 它会显示正确的列和正确的数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T13:58:28.910

错误发生在“lkuReleaseInfoUpdateAnnually”还是“lkuMinContactSchedule”上？究竟是哪个控件？似乎错误在事物的控制方面，似乎您在第二种形式中的控件没有您期望它拥有的所有列。

编辑：您似乎将 dataTable 中的列与控件上的列混淆了。我不确定您使用的是哪个控件，但正在执行以下操作：

```
lkuReleaseInfoUpdateAnnually.Properties.Columns[0] 
```

并不意味着您要索引到 DataTable。您正在索引控件的列，这些列可能存在也可能不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:58:08.223

创建一个仍然重现问题的最小代码。调试该代码；或者，如果这没有帮助，请在此处发布。上面的代码并没有真正告诉我们任何事情：它太大了，对你的问题来说太具体了。我们不知道您的数据看起来如何，我们必须相信您的表结构——尽管 C# 似乎不同意。

总而言之，任何人能提供的任何帮助都只是模糊的猜测。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:59:31.483

我对如何更好地指定错误及其来源有一些想法。您应该做的事情是观察“lkuDiabeticTeaching.Properties.Columns.Count”值，如果它小于 1 意味着您没有任何列，可能是因为没有发生人口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T14:00:29.890

我唯一能看到的是第一组代码缺少对 PopulateForms() 的调用（它包含在第二组中）。会是这样吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T16:19:08.423

嗯，我想通了。有点。出于某种原因，我需要`lkuDiabeticTeaching.Properties.ForceInitialize();`在有问题的表单上设置数据源后调用。

我只能*猜测* ，因为我有嵌套的表单，不知何故这试图在控件初始化之前触发。

现在看起来像这样 -->

```
 // Index 26 is Diabetic Teaching
        harDataSet = myHARTableMaint.GetMaintItem(26);
        harDataTable = harDataSet.Tables[0];
        lkuDiabeticTeaching.Properties.DataSource = harDataTable;
        lkuDiabeticTeaching.Properties.ForceInitialize();
        lkuDiabeticTeaching.Properties.PopulateColumns();
        lkuDiabeticTeaching.Properties.DisplayMember = "ItemDescription";
        lkuDiabeticTeaching.Properties.ValueMember = "ItemID";
        if(lkuDiabeticTeaching.Properties.Columns.Count > 0)
        {
            lkuDiabeticTeaching.Properties.Columns[0].Visible = false;
            lkuDiabeticTeaching.Properties.Columns[1].Visible = false;
            lkuDiabeticTeaching.Properties.Columns[3].Visible = false;
            lkuDiabeticTeaching.Properties.Columns[4].Visible = false; 
        } 
```

感谢所有付出时间的人。

# html - 保护纯 HTML 网站的技术

> ID：920954
> 
> 赞同：2
> 
> 时间：2009-05-28T13:53:28.263
> 
> 标签：html, security, active-directory, iis-6

我的任务是为某人保护一个纯 HTML 网站，但我不完全确定如何解决这个问题。以下是约束：

1.  所有登录都必须链接到我们当前的 Active Directory 域。
2.  （可选，但需要）该解决方案必须将来自我们 Intranet 内部的请求列入白名单 - 也就是说，如果有人试图从校园访问该站点，则立即允许他们进入。
3.  （可选，但需要）该解决方案必须将来自我们中心网站的请求列入白名单，无论它们是否在校园内。所述中心站点通过引用我们的 Active Directory 域的登录名进行保护，因此这本质上是对直通的请求。

我们的绝大多数用户群都是非常非技术性的，因此占用空间小且登录请求很少是必要的。

通常，我对此没有任何问题，但这是一个纯 HTML 网站，所以我的选择有点有限。我目前的想法：

1.  使用 IIS6 的目录安全来简单地强制 Active Directory 身份验证。我不能使用 IP 允许/拒绝，因为该检查在生命周期中的任何其他内容之前进行，并迅速拒绝拒绝列表中的任何内容。我无法改变这种行为。
2.  对驻留在我们中心网站上的 aspx 文件进行编码，该文件为用户预加载集成的 Windows 安全凭证，自动向 HTML 网站验证他们的身份。然而，就 IIS 而言，这是两个不同的网站，这听起来充其量是不好的做法，最坏的情况是模仿跨站点入侵尝试。

我不得不承认我被困住了。以前有没有人处理过这样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T16:37:05.690

假设您使用的是 Windows2003/IIS6 并且您的 Web 服务器是您域的一部分，您可以执行以下操作：

1.  将您的网站配置为使用集成和/或基本身份验证来针对 Active Directory 进行身份验证。同时禁用匿名访问。您可以通过在 IIS 管理器中您网站的“目录安全”选项卡中单击“编辑”来找到这些设置。如果您的用户将使用 Internet Explorer 以外的浏览器，您只需要启用 Basic。如果您使用 Basic，您还应该使用 SSL 来保护您的用户名和密码。访问级别由在您网站的根/子目录上的文件/目录上设置的权限决定。这些目录中的任何文件都只会提供给经过身份验证的用户。

2.  要允许您域中的用户在没有提示的情况下登录，您需要将 Internet Explorer 配置为自动登录到您的 Intranet 中的站点。您还需要在 IIS 中为您的网站启用集成身份验证。

3.  我不确定是否会满足第 3 项中的要求。如果您的中心网站使用模拟，它*可能*会将您的 Windows 凭据传递到您域中的另一台服务器，但我怀疑不会。

参考：

“如何在 Windows Server 2003 中配置 IIS 网站身份验证” [http://support.microsoft.com/kb/324274/](http://support.microsoft.com/kb/324274/)

“Internet Explorer 可能会提示您输入密码” [http://support.microsoft.com/kb/258063](http://support.microsoft.com/kb/258063)

“如何在 Internet Explorer 中使用安全区域” [http://support.microsoft.com/kb/174360/EN-US/](http://support.microsoft.com/kb/174360/EN-US/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:22:13.933

如果纯 html 站点在 IIS 上运行，则将其转换为 .Net Web 应用程序只是为了使用更丰富的 ASP.Net 安全包装器将其资源包装在您的自定义条件表单登录中，这似乎很自然。您可以从该 now-application 中提供纯 HTML 文件。

对于我可以看到的内容维护者来说，这没有任何不利之处。

# postgresql - 我如何优雅地杀死过时的服务器进程 postgres

> ID：920956
> 
> 赞同：3
> 
> 时间：2009-05-28T13:53:39.560
> 
> 标签：postgresql

偶尔在我们的实验室中，我们的 postgres 8.3 数据库会从 pid 文件中分离出来，当我们尝试关闭数据库时会收到以下消息：

`Error: pid file is invalid, please manually kill the stale server process postgres`

发生这种情况时，我们立即执行操作，`pg_dump`以便稍后恢复数据库。但是，如果我们只是杀死 -9 孤儿`postgres`进程然后启动它，那么数据库只会使用上次成功关闭的数据启动。但是，如果您`psql`在杀死它之前对其进行处理，则数据全部可用，这就是为什么`pg_dump`有效。

有没有办法优雅地关闭孤立的 postgres 进程，这样我们就不必通过 pg_dump 和恢复？或者有没有办法在杀死孤立进程后让数据库恢复？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T14:05:10.130

根据[文档](http://www.postgresql.org/docs/current/static/server-shutdown.html)，您可以发送 SIGTERM 或 SIGQUIT。SIGTERM 是首选。无论哪种方式，都不要使用 SIGKILL（正如您从个人经验中知道的那样）。

**编辑：**另一方面，您遇到的情况不正常，可能表明配置错误或错误。[请在pgsql-admin](http://archives.postgresql.org/pgsql-admin/)邮件列表上寻求帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T15:10:17.160

**永远不要**使用 kill -9。

我强烈建议您尝试弄清楚这是如何发生的。错误消息究竟来自哪里？这不是 PostgreSQL 错误消息。您是否有机会混合不同的方式来启动/停止服务器（例如，有时是 initscripts，有时是 pg_ctl）？这可能会导致事情不同步。

但要回答直接问题 - 在进程上使用常规终止（否 -9）将其关闭。如果有多个正在运行的 postgres 进程，请确保杀死所有的 postgres 进程。

数据库在关闭时总是会进行自动恢复。这也应该发生在 kill -9 上——任何提交的数据都应该在那里。这几乎听起来就像您将两个不同的数据目录安装在彼此之上或类似的东西 - 这至少是 NFS 的一个已知问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-26T06:51:10.453

我每分钟使用 cron 运行的如下脚本。

```
#!/bin/bash

DB="YOUR_DB"

# Here's a snippet to watch how long each connection to the db has been open:
#     watch -n 1 'ps -o pid,cmd,etime -C postgres | grep $DB'

# This program kills any postgres workers/connections to the specified database
# which have been running for 2 or 3 minutes. It actually kills workers which
# have an elapsed time including "02:" or "03:". That'll be anything running
# for at least 2 minutes and less than 4\. It'll also cover anything that
# managed to stay around until an hour and 2 or 3 minutes, etc.
#
# Run this once a minute via cron and it should catch any connection open
# between 2 and 3 minutes. You can temporarily disable it if if you need to run
# a long connection once in a while.
#
# The check for "03:" is in case there's a little lag starting the cron job and
# the timing is really bad and it never sees a worker in the 1 minute window
# when it's got "02:".
old=$(ps -o pid,cmd,etime -C postgres | grep "$DB" | egrep '0[23]:')
if [ -n "$old" ]; then
    echo "Killing:"
    echo "$old"
    echo "$old" | awk '{print $1}' | xargs -I {} kill {}
fi 
```

# c# - 内存带宽使用

> ID：920957
> 
> 赞同：5
> 
> 时间：2009-05-28T13:54:00.963
> 
> 标签：c#, c++, c, hardware, performancecounter

您如何计算使用的内存 (RAM) 带宽？需要哪些性能计数器？

我遇到了一个能够做到这一点的工具，“Rightmark 多线程内存测试”。但与 Rightmark 的其他测试不同，我没有找到它的源代码，只有二进制文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-30T11:13:34.943

如果您的代码可以在 Linux 上运行，请使用[Cachegrind](http://valgrind.org/info/tools.html)：

> Cachegrind 是一个缓存分析器。它对 CPU 中的 I1、D1 和 L2 缓存执行详细模拟，因此可以准确地查明代码中缓存未命中的来源。它通过每个函数、每个模块和整个程序的摘要来识别每行源代码执行的缓存未命中、内存引用和指令的数量。它对用任何语言编写的程序都很有用。Cachegrind 运行程序的速度比正常速度慢 20--100 倍。

您可能想要使用[KCacheGrind GUI](http://kcachegrind.sourceforge.net)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T14:21:24.137

“计算”内存带宽使用情况非常困难。有很多重要的缓存和 MMU 问题需要解决。唯一真正的方法是通过使用模拟或真实世界的测量。

您可以通过调试代码并计算执行的内存加载和存储操作的数量来获得一个“粗略”的想法。但是，知道它是否是缓存命中/未命中是另一个问题。

这取决于你的目的。如果要获得猜测，您可以使用经验法则，即大约 30% 的通用代码是内存加载和存储。如果您试图获得最坏的情况，您可以假设缓存一直未命中并解决问题。

您可以做的一件潜在的事情是查看虚拟化。有几个开源选项（想到 QEMU）。可以从中导出某些硬件测量值。

# jquery - 隔离 jQuery 函数

> ID：920959
> 
> 赞同：0
> 
> 时间：2009-05-28T13:54:19.433
> 
> 标签：jquery, hyperlink, this

我有一些 jQuery 代码，可以在单击时突出显示链接，并更改页面上某些链接的字体大小和颜色。我的问题是我的 jQuery 中的一些函数正在网站上的所有链接上执行，而不仅仅是我试图定位的 div 中的那些。

到目前为止，这是我的代码：

```
 $(document).ready(function() {
    slide("#sliding-navigation", 22, 17, 175, .8);
});

function slide(navigation_id, font_out, font_in, time, multiplier) {
    // Creates the target paths
    var list_elements = navigation_id + " li.sliding-element";
    var link_elements = list_elements + " a";

    // Initiates the timer used for the initial sliding animation
    var timer = 0;

    // Create the beginning slide animation
    $(list_elements).each(function(i) {
        // updates timer
        timer = (timer*multiplier + time);
        $(this).animate({ marginLeft: "0" }, timer);
        $(this).animate({ marginLeft: "15px" }, timer);
        $(this).animate({ marginLeft: "0" }, timer);
    });

    // Creates the hover effect
    $(link_elements).each(function(i) {
        $(this).mouseenter(function () {
            $(this).animate({ fontSize: font_out }, 200);
        }), 
        $(this).mouseleave(function () {
            $(this).animate({ fontSize: font_in }, 400);
        }),
        // Highlights active link   
    $('a').addClass('inactive');
    $('a').click(function() {
        $('ul#sliding-navigation a').stop().animate({ fontSize : font_in }, 500);
        $(this).stop().animate({ fontSize : font_out }, 0);
        $('a.active').mouseenter(function () {
          $(this).stop().animate({ fontSize : font_out }, 200);
        }).mouseleave(function() {
          $(this).stop().animate({ fontSize : font_in }, 400);
        }),
        $('a.active').addClass('inactive');
        $('a.active').removeClass('active');
        $(this).removeClass('inactive');
        $(this).addClass('active');
        $(this).unbind('mouseleave mouseenter');
    });
  });
} 
```

我几乎可以肯定问题出在这一行：

```
 $(this).stop().animate({ fontSize : font_out }, 0); 
```

有没有办法在这一行的开头放置一些东西，以便“ ”只有在它是“ ”列表`this`中的链接时才会被激活？`ul#sliding-navigation`

谢谢你的协助！对此，我真的非常感激...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T14:03:08.107

为什么在创建事件处理程序时不使用适当的选择器？

```
$('#sliding-navigation a').click(function() {}); 
```

此外，我发现在选择器（ul #sliding-navigation）中同时使用类和 id 令人困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:14:46.770

这个选择器

```
$('a').click(function(){
    ...
}); 
```

正在选择页面上的每个链接。如果您只想选择导航 ul 中的链接，请按照 kgiannakakis 的建议使用：

```
$('#sliding-navigation a').click(function() {}); 
```

如果您想同时选择所有链接，但只更改某些链接的字体，您可以尝试以下操作：

```
if( $(this).parent().attr('id') == 'sliding-navigation' ){ 
    $(this).stop().animate({ fontSize : font_out }, 0); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T14:53:24.010

您还可以通过使用链式编写来缩短您的代码

```
 $('a.active').addClass('inactive').removeClass('active');
 $(this).removeClass('inactive').addClass('inactive').unbind('mouseleave mouseenter'); 
```

代替

```
$('a.active').addClass('inactive');
$('a.active').removeClass('active');
$(this).removeClass('inactive');
$(this).addClass('active');
$(this).unbind('mouseleave mouseenter'); 
```

# ruby-on-rails - has_many 嵌套中的自定义 RESTful 路由

> ID：920965
> 
> 赞同：2
> 
> 时间：2009-05-28T13:55:52.487
> 
> 标签：ruby-on-rails, ruby, routing, routes

**项目**有许多**任务**，一个任务有一个称为“批准”的自定义 RESTful 操作。

我希望助手看起来像这样**approve_project_task_url**

这对我不起作用：

```
map.resources :projects,
              :has_many => :tasks,
                           :member => { :approve => :post } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T14:46:14.790

我曾经遇到过同样的问题，但我从来没有长期努力地寻找解决办法。相反，我只是选择了从那时起我一直使用的旧样式：

```
map.resources :projects do |project|
  project.resources :tasks, :member => {:approve => :post}
end 
```

这将为您提供所需的`approve_project_task_url(@project, @task)`路线/助手。

我想你可能已经知道这种方法了？如果是这样并且您不喜欢它，希望我能从您的其他回复中学到一些东西:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T13:19:32.083

```
 **This is syntax correction to above solution**

map.resources :projects do |project|
  project.resources :tasks, :member => {:approve => :post}
end 
```

# sql - Powershell and SQL parameters. If empty string, pass DBNull

> ID：920991
> 
> 赞同：7
> 
> 时间：2009-05-28T14:00:07.830
> 
> 标签：sql, powershell, dbnull

I got this parameter:

```
$objDbCmd.Parameters.Add("@telephone", [System.Data.SqlDbType]::VarChar, 18) | Out-Null;
$objDbCmd.Parameters["@telephone"].Value = $objUser.Telephone; 
```

Where the string `$objUser.Telephone` can be empty. If it's empty, how can I convert it to `[DBNull]::Value`?

I tried:

```
if ([string]:IsNullOrEmpty($objUser.Telephone)) { $objUser.Telephone = [DBNull]::Value }; 
```

But that gives me the error:

> Exception calling "ExecuteNonQuery" with "0" argument(s): "Failed to convert parameter value from a ResultPropertyValueCollection to a String."

And if I convert it to a string, it inserts an empty string `""`, and not `DBNull`.

How can this be accomplished?

Thanks.

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-29T03:55:32.960

In PowerShell, you can treat null/empty strings as a boolean.

```
$x = $null
if ($x) { 'this wont print' }

$x = ""
if ($x) { 'this wont print' }

$x = "blah"
if ($x) { 'this will' } 
```

So.... having said that you can do:

```
$Parameter.Value = $(if ($x) { $x } else { [DBNull]::Value }) 
```

But I'd much rather wrap this up in a function like:

```
function CatchNull([String]$x) {
   if ($x) { $x } else { [DBNull]::Value }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T14:41:07.403

I don't know about powershell, but in C# I would do something like this:

```
if ([string]::IsNullOrEmpty($objUser.Telephone))
{
 $objDbCmd.Parameters["@telephone"].Value = [DBNull]::Value;
}
else
{
 $objDbCmd.Parameters["@telephone"].Value = $objUser.Telephone;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-13T18:49:25.117

Always append +"" at the end of db values...

$command.Parameters["@EmployeeType"].Value= $ADResult.EmployeeType **+ ""**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-20T12:46:21.540

Many years later, let me clarify:

[Josh's answer](https://stackoverflow.com/users/81769/josh) shows a helpful simplification for testing strings for emptiness (relying on PowerShell's *implicit* to-Boolean conversion^([1])), but it is unrelated to Tommy's (the OP's) problem.

Instead, the error message

> "Failed to convert parameter value from a ResultPropertyValueCollection to a String."

implies that **it is the *non*-null case that caused the problem,** because `$objDbCmd.Parameters["@telephone"].Value` expects either a *string* value or `[DBNull]::Value`, whereas `$objUser.Telephone` is of type `[ResultPropertyValueCollection]`, i.e. a *collection* of values.

Thus, in the non-null case, a *string* value must be assigned, which must be derived from the collection; one option is to take the *first* collection element's value, another would be to join all values with a separator to form a single string, using, e.g., `[string]::Join(';', $objUser.Telephone)` or, if joining the elements with *spaces* is acceptable (not a good idea with multiple phone numbers), simply with `"$($objUser.Telephone)"`.^([2])

Detecting an empty collection via `[string]:IsNullOrEmpty()` actually worked, despite the type mismatch, due to how PowerShell implicitly stringifies collections when passing a value to a `[string]` typed method parameter.^([2])

Similarly, using *implicit* to-Boolean conversion works as expected with collections too: an empty collection evaluates to `$false`, a non-empty one to `$true` (as long as there are either at least two elements or the only element by itself would be considered `$true`^([1]))

Therefore, one solution is to use the *first* telephone number entry:

```
$objDbCmd.Parameters["@telephone"].Value = if ($objUser.Telephone) {
    $objUser.Telephone[0].ToString()  # use first entry
  } else {
    [DBNull]::Value
  } 
```

^(Note: If `$objUser.Telephone[0]` directly returns a `[string]`, you can omit the `.ToString()` call.)

In **PowerShell v7+** you can alternatively shorten the statement via a ternary conditional:

```
$objDbCmd.Parameters["@telephone"].Value =
  $objUser.Telephone ? $objUser.Telephone[0].ToString() : [DBNull]::Value 
```

* * *

^([1] For a comprehensive summary of PowerShell's automatic to-Boolean conversions, see the bottom section of [this answer](https://stackoverflow.com/a/53108138/45375).)

^([2] When *implicitly* converting a collection to a string, PowerShell joins the stringified elements of a collection with a single space as the separator by default; you can override the separator with the automatic `$OFS` variable, but that is rarely done in practice; e.g., array `'foo', 'bar'` is converted to `'foo bar'`; note that this conversion does *not* apply when you call the collection's `.ToString()` method *explicitly*, but it does apply inside expandable (interpolating) strings, e.g., `"$array"`.)

# unit-testing - 单元测试采用

> ID：920992
> 
> 赞同：70
> 
> 时间：2009-05-28T14:00:20.030
> 
> 标签：unit-testing, tdd, automated-tests, agile

我们试图在我们当前的项目中引入单元测试，但它似乎不起作用。额外的代码似乎已经成为维护方面的难题，因为当我们的内部框架发生变化时，我们必须四处走动并修复任何挂起它的单元测试。

我们有一个抽象基类用于对我们的控制器进行单元测试，它充当调用子类的抽象方法实现的模板，即框架调用 Initialize，因此我们的控制器类都有自己的 Initialize 方法。

我曾经是单元测试的倡导者，但它似乎不适用于我们当前的项目。

任何人都可以帮助确定问题以及我们如何使单元测试为我们工作而不是对我们不利？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-05-29T06:17:06.520

# 尖端：

### 避免编写程序代码

如果测试是针对严重依赖全局状态或位于丑陋方法主体中的过程式代码编写的，则测试可能难以维护。如果您使用 OO 语言编写代码，请有效地[使用 OO 结构](http://googletesting.blogspot.com/2009/07/how-to-think-about-oo.html)来减少这种情况。

*   尽可能避免全局状态。
*   避免静态，因为它们往往会波及你的代码库，并最终导致不应该是静态的东西。它们还会使您的测试上下文膨胀（见下文）。
*   有效利用多态性以防止[过多的 if 和 flags](http://misko.hevery.com/2008/08/14/procedural-language-eliminated-gotos-oo-eliminated-ifs/)

### 找出发生了哪些变化，将其封装起来，并将其与保持不变的内容区分开来。

代码中的瓶颈点比其他部分更频繁地更改。在您的代码库中执行此操作，您的测试将变得更加健康。

*   良好的封装导致良好的松散耦合设计。
*   重构和模块化。
*   保持测试小而专注。

### 围绕测试的上下文越大，维护起来就越困难。

尽你所能缩小测试和执行它们的周围环境。

*   使用组合方法重构来测试更小的代码块。
*   您是否使用更新的测试框架，如 TestNG 或 JUnit4？它们允许您通过在测试生命周期中提供更细粒度的挂钩来消除测试中的重复。
*   调查使用测试替身（模拟、伪造、存根）来减少测试上下文的大小。
*   研究[测试数据构建器](http://www.natpryce.com/articles/000714.html)模式。

### 从测试中删除重复项，但要确保它们保持焦点。

您可能无法删除所有重复项，但仍尝试在导致疼痛的地方将其删除。确保你没有删除太多的重复，以至于有人无法一目了然地告诉测试做了什么。（有关同一概念的另一种解释，请参阅 Paul Wheaton 的[“邪恶单元测试”](http://www.javaranch.com/journal/200603/EvilUnitTests.html)文章。）

*   如果他们无法弄清楚它在做什么，那么没有人会想要修复测试。
*   遵循安排、行动、断言模式。
*   每个测试只使用一个断言。

### 在正确的级别上测试您要验证的内容。

考虑一下记录和回放 Selenium 测试所涉及的复杂性，以及与测试单一方法相比，你会发生什么变化。

*   将依赖项相互隔离。
*   使用依赖注入/控制反转。
*   使用测试替身来初始化一个用于测试的对象，并确保您正在单独测试单个代码单元。
*   确保您正在编写相关测试
    *   通过故意引入错误并确保它被测试捕获来“跳出陷阱”。
*   另请参阅：[集成测试是一个骗局](http://www.infoq.com/presentations/integration-tests-scam)

### 知道何时使用基于状态和基于交互的测试

真正的单元测试需要真正的隔离。单元测试不会命中数据库或打开套接字。停止嘲笑这些交互。验证您是否正确地与您的合作者交谈，而不是此方法调用的正确结果是“42”。

### 演示试驾代码

一个给定的团队是否会测试所有代码，或者为每一行代码编写“测试优先”，这是有待商榷的。但是他们应该至少先写一些测试吗？绝对地。在某些情况下，测试优先无疑是解决问题的最佳方法。

*   试试这个练习：[TDD 就像你的意思一样](http://cumulative-hypotheses.org/2011/08/30/tdd-as-if-you-meant-it/) [（另一个描述）](http://gojko.net/2009/08/02/tdd-as-if-you-meant-it-revisited/)
*   另请参阅：[测试驱动开发和科学方法](http://agile2003.agilealliance.org/files/P6Paper.pdf)

# 资源：

*   [*Lasse Koskela*试驾**](http://my.safaribooksonline.com/9781932394856)
**   [*在Steve Freeman 和 Nat Pryce*的测试指导下不断发展的 OO 软件**](http://my.safaribooksonline.com/9780321574442)**   [*Michael Feathers*有效地使用遗留代码**](http://my.safaribooksonline.com/0131177052)**   [*Gojko Adzic*举例说明**](http://specificationbyexample.com/)**   要查看的博客：[Jay Fields](http://blog.jayfields.com/)、[Andy Glover](http://thediscoblog.com/)、[Nat Pryce](http://www.natpryce.com/)*   正如其他答案中已经提到的：
    *   XUnit 模式
    *   测试气味
    *   谷歌测试博客
    *   Miskov Hevery 的“面向可测试性的[OO 设计”](http://www.youtube.com/watch?v=acjvKJiOvXw)*   Paul Wheaton 的“[邪恶单元测试”](http://www.javaranch.com/journal/200603/EvilUnitTests.html)*   JB Rainsberger的“[集成测试是个骗局”](http://www.infoq.com/presentations/integration-tests-scam)*   JB Rainsberger的“[软件设计经济学”](https://www.youtube.com/watch?v=7HecgbghFTk)*   Rick Mugridge的“[测试驱动开发和科学方法”](http://agile2003.agilealliance.org/files/P6Paper.pdf)*   “ [TDD as if you mean it](http://cumulative-hypotheses.org/2011/08/30/tdd-as-if-you-meant-it/) ” 练习最初由 Keith Braithwaite 编写，同样由 Gojko Adzic[主持](http://gojko.net/2009/08/02/tdd-as-if-you-meant-it-revisited/)****

 *** * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-28T14:03:21.990

您是否在测试足够小的代码单元？除非您从根本上更改核心代码中的所有内容，否则您不应该看到太多更改。

一旦事情稳定下来，您将更加欣赏单元测试，但即使是现在，您的测试也突出了您的框架更改传播的程度。

这是值得的，尽你所能坚持下去。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-28T14:25:25.097

如果没有更多信息，就很难对你为什么会遇到这些问题做出正确的解释。有时，更改接口等不可避免地会破坏很多东西，有时则归结为设计问题。

尝试对您看到的故障进行分类是个好主意。你有什么样的问题？例如，它是由于 API 更改而导致的测试维护（如在重构后使它们编译！），还是归结为 API 更改的行为？如果你能看到一个模式，那么你可以尝试改变生产代码的设计，或者更好地隔离测试的变化。

如果在很多地方更改一些东西会对您的测试套件造成无法估量的破坏，那么您可以做一些事情（其中大部分只是常见的单元测试技巧）：

*   开发小单元代码并测试小单元代码。在有意义的地方提取接口或基类，以便代码单元中有“接缝”。您必须引入的依赖项越多（或者更糟糕的是，使用“new”在类中实例化），更改代码的风险就越大。如果每个代码单元都有一些依赖项（有时是几个或根本没有），那么它最好与更改隔离。

*   只断言测试需要什么。不要断言中间的、偶然的或不相关的状态。按合同设计和按合同测试（例如，如果您正在测试堆栈弹出方法，则不要在推送后测试计数属性——这应该在单独的测试中）。

    我经常看到这个问题，特别是如果每​​个测试都是一个变体。如果任何偶然状态发生变化，它会破坏所有断言它的东西（无论断言是否需要）。

*   就像使用普通代码一样，在单元测试中使用工厂和构建器。我了解到，当大约 40 个测试需要在 API 更改后更新构造函数调用时...

*   同样重要的是，首先使用前门。如果可用，您的测试应始终使用正常状态。仅在必须时使用基于交互的测试（即没有要验证的状态）。

无论如何，这一点的要点是我会尝试找出测试失败的原因/位置并从那里开始。尽最大努力使自己免受变化的影响。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-28T14:03:19.523

单元测试的好处之一是，当您进行这样的更改时，您可以证明您没有破坏您的代码。您确实必须使您的测试与您的框架保持同步，但是这项相当平凡的工作比试图找出重构时出现的问题要容易得多。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-28T14:12:31.987

**我会坚持让你坚持 TDD。**尝试检查您的单元测试框架，与您的团队一起进行一次 RCA（根本原因分析）并确定该区域。

在套件级别修复单元测试代码，不要频繁更改代码，特别是函数名称或其他模块。

如果您能很好地分享您的案例研究，我们将不胜感激，然后我们可以在问题领域进行更多挖掘？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-28T14:38:21.340

好问题！

设计好的单元测试就像设计软件本身一样困难。开发人员很少承认这一点，因此结果通常是仓促编写的单元测试，每当被测系统发生变化时就需要维护。因此，您的问题的部分解决方案可能是花费更多时间来改进单元测试的设计。

我可以推荐一本值得称道的好书[《单元测试的设计模式》](https://rads.stackoverflow.com/amzn/click/com/0131495054)

高温高压

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-28T14:54:08.267

如果问题是您的测试与实际代码过时，您可以执行以下一项或两项操作：

1.  培训所有开发人员不要通过不更新单元测试的代码审查。
2.  设置一个自动测试框，在每次签入后运行全套单元测试，并向破坏构建的人发送电子邮件。（我们曾经认为这只是为“大男孩”准备的，但我们在专用盒子上使用了开源包。）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-28T14:04:57.477

好吧，如果代码中的逻辑发生了变化，并且您已经为这些代码编写了测试，我认为需要更改测试以检查新逻辑。单元测试应该是测试代码逻辑的相当简单的代码。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-28T14:30:34.307

您的单元测试正在做他们应该做的事情。将由于框架、即时代码或其他外部资源的更改而导致的任何行为中断暴露出来。这应该做的是帮助您确定行为是否确实发生了变化并且单元测试是否需要相应地修改，或者是否引入了错误从而导致单元测试失败并需要更正。

不要放弃，虽然现在很沮丧，但好处会实现的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-28T14:58:29.553

我不确定导致难以维护代码测试的具体问题，但是当我在测试中断时遇到类似问题时，我可以分享一些我自己的经验。我最终了解到，缺乏可测试性主要是由于被测类的一些设计问题：

*   使用具体类而不是接口
*   使用单例
*   调用大量静态方法进行业务逻辑和数据访问，而不是接口方法

正因为如此，我发现我的测试通常会中断——不是因为被测类的变化——而是因为被测类正在调用的其他类的变化。一般来说，重构类以询问它们的数据依赖关系并使用模拟对象进行测试（EasyMock et al for Java）使测试更加集中和可维护。我真的很喜欢一些关于这个主题的网站：

*   [谷歌测试博客](http://googletesting.blogspot.com/)
*   [编写可测试代码的指南](http://misko.hevery.com/code-reviewers-guide/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-29T00:10:24.697

为什么每次对框架进行更改时都必须更改单元测试？*这不应该反过来吗？*

如果您使用的是 TDD，那么您应该首先确定您的测试正在测试错误的行为，并且他们应该验证所需的行为是否存在。现在你已经修复了你的测试，你的测试失败了，你必须去压缩你的框架中的错误，直到你的测试再次通过。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-28T14:09:26.203

当然，一切都伴随着价格。在开发的早期阶段，必须更改许多单元测试是正常的。

您可能想查看一些代码以进行更多封装、创建更少的依赖项等。

当你接近生产日期时，你会很高兴你有这些测试，相信我:)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-28T14:47:44.240

您的单元测试不是太面向黑盒吗？我的意思是......让我举个例子：假设您正在对某种容器进行单元测试，您是否使用容器的 get() 方法来验证新项目是否实际存储，或者您是否设法获得一个句柄实际存储以直接检索项目的存储位置？后者使测试变得脆弱：当您更改实现时，您正在破坏测试。

您应该测试接口，而不是内部实现。

当您更改框架时，您最好先尝试更改测试，然后再更改框架。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-28T14:58:07.387

我建议投资测试自动化工具。如果您正在使用持续集成，则可以使其协同工作。那里有一些工具可以扫描您的代码库并为您生成测试。然后将运行它们。这种方法的缺点是它太通用了。因为在很多情况下，单元测试的目的是破坏系统。我已经编写了许多测试，是的，如果代码库发生更改，我必须更改它们。

自动化工具有一条很好的路线，您肯定会拥有更好的代码覆盖率。

但是，通过基于开发人员的良好测试，您还将测试系统完整性。

希望这可以帮助。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-28T19:24:29.470

如果您的代码真的很难测试并且测试代码中断或需要付出很多努力才能保持同步，那么您的问题就更大了。

考虑使用 extract-method 重构来抽出一小块只做一件事且只做一件事的代码；没有依赖关系并将您的测试写入那些小方法。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-28T23:43:12.660

> 额外的代码似乎已经成为维护方面的难题，因为当我们的内部框架发生变化时，我们必须四处走动并修复任何挂起它的单元测试。

另一种选择是，当您的框架更改时，您不测试更改。或者你根本不测试框架。那是你要的吗？

您可以尝试重构您的框架，使其由可以独立测试的较小部分组成。然后，当您的框架发生变化时，您希望 (a) 更改更少的部分，或者 (b) 更改主要是在组成部分的方式上。无论哪种方式都可以让您更好地重用代码和测试。但是涉及到真正的智力努力；不要指望这很容易。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-29T00:00:22.690

我发现，除非您使用鼓励编写非常小的类的 IoC / DI 方法，并虔诚地遵循单一职责原则，否则单元测试最终会测试多个类的交互，这使得它们非常复杂，因此很脆弱。

我的观点是，许多新颖的软件开发技术只有在一起使用时才能发挥作用。特别是 MVC、ORM、IoC、单元测试和模拟。DDD（在现代原始意义上）和 TDD/BDD 更加独立，因此您可以使用或不使用它们。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-28T21:13:12.747

有时设计 TDD 测试会对应用程序本身的设计提出质疑。检查你的类是否设计得很好，你的方法一次只执行一件事……有了好的设计，编写代码来测试简单的方法和类应该很简单。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-28T21:36:36.817

我自己一直在思考这个话题。我非常看重单元测试的价值，但不是严格的 TDD。在我看来，在某种程度上，您可能正在进行探索性编程，其中将事物划分为类/接口的方式需要改变。如果您在旧类结构的单元测试上投入了大量时间，那会增加对重构的惯性，丢弃额外的代码会很痛苦，等等。

# wpf - 当 StackPanel 的内容发生变化时，如何触发触发器？

> ID：920998
> 
> 赞同：0
> 
> 时间：2009-05-28T14:01:44.973
> 
> 标签：wpf, xaml, triggers

以下代码使 StackPanel 的内容在加载时淡入 (StackPanel.Loaded)。

*当StackPanel*的内容发生变化时，我必须改变什么才能让它开始淡入淡出，例如，每当 StackPanel 中的消息发生变化时，我希望它再次淡入？

```
<Style x:Key="MessageStyle" TargetType="StackPanel">
    <Style.Triggers>
        <DataTrigger Binding="{Binding SaveStatus}" Value="Failed">
            <Setter Property="StackPanel.Background" Value="Red"/>
        </DataTrigger>
        <EventTrigger RoutedEvent="StackPanel.Loaded">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation
            Storyboard.TargetProperty="(StackPanel.Opacity)"
            From="0.0" To="1.0" Duration="0:0:5"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T19:22:58.863

在绑定 StackPanel 内容的绑定上将随附的 NotifyOnSourceUpdated/NotifyOnTargetUpdated 属性设置为 True 之后，您应该能够使用 StackPanel.SourceUpdated/StackPanel.TargetUpdated 事件执行您要查找的操作。*********